VERSION E05

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:1    
        1        1        /*M* CHECK and NOTIFY cmds.                                                     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,DFC */
        8        8        /*P*   NAME:   CPK$CHECK
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of the IBEX CHECK and NOTIFY commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPK$CHECK:
       16       16          PROC(P$PCB)    ALTRET;
       17       17                   %PLIST;
       18       18                   %INCLUDE CP_6;
       19       99                   %INCLUDE B$JIT;
       20      389                   %INCLUDE B_MACROS_C;
       21      500                   %INCLUDE CP_MACROS_C;
       22     1252                   %INCLUDE XU_MACRO_C;
       23     4358                   %INCLUDE CP_SUBS_C;
       24     5275                   %INCLUDE CP_PERR_C;
       25     5613                   %INCLUDE CP_6_SUBS;
       26     6153                   %INCLUDE B_ERRORS_C;
       27     7280                   %INCLUDE XSJ_MAC_C;
       28     7359                   %INCLUDE XSJ_SUBS_C;
       29     7386                   %INCLUDE CP_DATA_R;
       30     9949             /***** Ptr variable declarations *****/
       31     9950    1   DCL P$ PTR;
       32     9951    1   DCL BLK$ PTR;
       33     9952    1   DCL TEMP$ PTR;
       34     9953    1   DCL DCB$ PTR;
       35     9954    1   DCL FID$ PTR;
       36     9955    1   DCL TEMPBUF$ PTR;
       37     9956    1   DCL DEST$ PTR;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:2    
       38     9957    1   DCL STAT$ PTR ;
       39     9958    1   DCL RES$ PTR ;
       40     9959    1   DCL SN$ PTR ;
       41     9960    1   DCL P$TEXTC$ PTR ;
       42     9961    1   DCL BUF$ PTR ;
       43     9962
       44     9963             /***** External procedure (entry) declarations *****/
       45     9964    1   DCL X$PARSE ENTRY(1) ALTRET;
       46     9965    1   DCL CPB$OPENCS ENTRY ;
       47     9966    1   DCL CPC$GETDCB ENTRY(2) ALTRET;
       48     9967    1   DCL CPC$OPEN_LL ENTRY;
       49     9968    1   DCL CPC$RELDCB ENTRY(3);
       50     9969    1   DCL CPC$RELSEG ENTRY(1);
       51     9970    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;
       52     9971    1   DCL CPC$GETSEG ENTRY(2) ALTRET;
       53     9972    1   DCL CPC$SCREECH ENTRY(2);
       54     9973    1   DCL CPC$WRITEMSGE ENTRY(6);
       55     9974    1   DCL CPJ$READ_S ENTRY(3) ALTRET;
       56     9975    1   DCL CPJ$WRITE_S ENTRY(3) ALTRET;
       57     9976    1   DCL CPJ$READ_REC ENTRY(3) ALTRET;
       58     9977    1   DCL CPJ$WRITE_REC ENTRY(3) ALTRET;
       59     9978    1   DCL CXP$POSTERR ENTRY(5);
       60     9979    1   DCL CPR$RPTERR ENTRY(2);
       61     9980    1   DCL CPC$MFID_OPEN ENTRY(3) ALTRET ;
       62     9981    1   DCL CPC$FID_VLP ENTRY(3) ALTRET ;
       63     9982    1   DCL CPC$FID_OPEN ENTRY(3) ALTRET ;
       64     9983    1   DCL CPK$CHECK_OUTPUT ENTRY(2) ;
       65     9984
       66     9985             /***** Error codes. *****/
       67     9986
       68     9987        %ERR_CODE (NAME=E_CHKNOPRIV,MID#=CPK$IBEXMID,CODE#=E$CHKNOPRIV,STCLASS=CONSTANT) ;
       69    10007
       70    10008        /*E*    ERROR: CPK-E$CHKNOPRIV-C
       71    10009                MESSAGE: Sorry. You can only view YOUR jobs and output.
       72    10010        */
       73    10011        %ERR_CODE (NAME=E_USEFILEBUSY,MID#=CPK$IBEXMID,CODE#=E$USEFILEBUSY,STCLASS=CONSTANT)
             10011            ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:3    
       74    10031        %ERR_CODE (NAME=E_CHKBADUSEF,MID#=CPK$IBEXMID,CODE#=E$CHKBADUSEF,STCLASS=CONSTANT);
       75    10051        %ERR_CODE (NAME=E_CHKBADUSEFSPEC,MID#=CPK$IBEXMID,CODE#=E$CHKBADUSEFSPEC,STCLASS=
             10051            CONSTANT);
       76    10071
       77    10072             /***** Based STRUCTURES *****/
       78    10073        %SEG$2;
       79    10133        %TEXTC (NAME=TEXTC);
       80    10138        %B$TCB (STCLASS="BASED(B$TCB$)");
       81    10141        %B$ALT;
       82    10149        %B$NWIO ;
       83    10234        %SUB_ECCDELTA ;
       84    10271          %ERR_BLK (NAME=ERR$BLK,STCLASS=BASED);
       85    10296             /***** Character string declarations *****/
       86    10297    1   DCL BLANKS CHAR(8) CONSTANT  INIT(' ');
       87    10298    1   DCL 1 M$DO_DCB CONSTANT DALIGNED,
       88    10299    1          2 CNT UBIN(9) INIT(4) UNAL,
       89    10300    1          2 TXT CHAR(4) INIT('M$DO');
       90    10301    1   DCL TEMPBUF CHAR(256);
       91    10302    1   DCL  1  TEMP_BUF REDEF TEMPBUF,
       92    10303    1        2  COUNT UBIN BYTE UNAL,
       93    10304    1        2  TEXT CHAR(255);
       94    10305    1   DCL B$$PAGE (0:1023) UBIN WORD BASED ALIGNED ;
       95    10306
       96    10307             /***** Bit variables *****/
       97    10308    1   DCL JOBSTATS_OPEN# BIT(1) ALIGNED AUTO;
       98    10309    1   DCL USEFID_OPEN# BIT(1) ALIGNED AUTO;
       99    10310    1   DCL CMDSTRM_CLOSED# BIT(1) ALIGNED AUTO;
      100    10311    1   DCL DELUSEREC BIT(1);
      101    10312    1   DCL GET_JOBSTATS# BIT(1) ;
      102    10313    1   DCL SYSTEM_OK# BIT(1) ;
      103    10314    1   DCL NSTATUS_FLG BIT(1) ;
      104    10315    1   DCL CROSS_ACCT_BATCH_FLG BIT(1) ;
      105    10316    1   DCL HELD_LINE_NOT_PRINTED BIT(1) ;
      106    10317    1   DCL WAIT_DONE BIT(1) ;
      107    10318    1   DCL WAIT_BELL BIT(1) ;
      108    10319    1   DCL WAITING BIT(1) ;
      109    10320    1   DCL MORE_2_WAIT BIT(1) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:4    
      110    10321    1   DCL SOMETHING_CHANGED BIT(1) ;
      111    10322    1   DCL FORCE BIT(1) ;
      112    10323    1   DCL NOTIFYING BIT(1) ;
      113    10324    1   DCL FIRST_QFLAG BIT(1) ;
      114    10325    1   DCL NOTIFY_Q_FLAGS(0:2) BIT(1) UNAL ;
      115    10326    1   DCL OUTPUT_FLG BIT(1) ;
      116    10327    1   DCL JOB_COMPLETED BIT(1) ;
      117    10328             /***** Word declarations *****/
      118    10329    1   DCL I SBIN;
      119    10330    1   DCL J SBIN;
      120    10331    1   DCL K SBIN;
      121    10332    1   DCL TEMP UBIN WORD;
      122    10333    1   DCL TEMP2 UBIN WORD;
      123    10334    1   DCL TEMP3 UBIN WORD;
      124    10335    1   DCL TAB_VAL UBIN WORD;
      125    10336    1   DCL DCB# UBIN WORD;
      126    10337    1   DCL CMD_CODE UBIN WORD ;
      127    10338    1   DCL NRECS_READ SBIN WORD ;
      128    10339    1   DCL NRECS_SKIP SBIN WORD ;
      129    10340    1   DCL NRECS_DEL SBIN WORD ;
      130    10341    1   DCL BAD_USEFILE_REMEM REMEMBER ;
      131    10342    1   DCL SUBMIT_LOOP_REMEM REMEMBER ;
      132    10343    1   DCL CMD_TYPE UBIN WORD ;
      133    10344        %EQU CHECK_CMD# = 0 ;
      134    10345        %EQU NOTIFY_CMD# = 1 ;
      135    10346        %EQU SUBMIT_CMD# = 2 ;
      136    10347        %EQU CANCEL_CMD# = 3 ;
      137    10348        %EQU DFLT_HDR_CNT_SZ = 24 ;
      138    10349
      139    10350    1   DCL HDR_CNT_SZ UBIN WORD ;
      140    10351    1   DCL NLINES UBIN WORD ;
      141    10352
      142    10353             /***** Auto structures *****/
      143    10354
      144    10355        %CP_CHFLAGS                         ( FPTN = CP_CHFLAGS ,
      145    10356              STCLASS = AUTO ) ;
      146    10490        %CP_FIDVLPS                         ( NAME = CP_FIDVLPS ,
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:5    
      147    10491              STCLASS = AUTO ) ;
      148    10502        %CP_CHKEYBUF                        ( FPTN = CHKEYBUF) ;
      149    10520        %CP_CHKEYBUF                        ( FPTN = T_CHKEYBUF) ;
      150    10538        %CP_SYSIDBUF                        ( FPTN = SYSIDBUF) ;
      151    10560        %CP_SYSIDBUF                        ( FPTN = ASYSIDBUF) ;
      152    10582        %CH_XFORMAT                           ( FPTN = CH_XFORMAT,
      153    10583              STCLASS = AUTO) ;
      154    10607    1   DCL NUM_AHEAD UBIN WORD ;
      155    10608    1   DCL NUM_LISTED UBIN WORD ;
      156    10609    1   DCL HDR_CNT UBIN WORD ;
      157    10610    1   DCL WAIT_INT UBIN WORD ;
      158    10611    1   DCL BRK_CNT UBIN WORD ;
      159    10612        %PARSE$OUT (NAME=P_DUMMY, STCLASS=AUTO) ;
      160    10657
      161    10658             /***** Constant data *****/
      162    10659
      163    10660        %CP_CHKEYBUF                            ( FPTN = CP_C_CHKEYBUF,
      164    10661              STCLASS = CONSTANT) ;
      165    10679        %CP_CHFLAGS                             ( FPTN = CP_C_CHFLAGS,
      166    10680              STCLASS = CONSTANT) ;
      167    10814        %XSJ_INFOKEY                            ( FPTN = CXSJ_INFOKEY,
      168    10815              STCLASS = CONSTANT) ;
      169    10828        %XSJ_NAMEKEY                            ( FPTN = CXSJ_NAMEKEY,
      170    10829              STCLASS = CONSTANT) ;
      171    10843
      172    10844             /***** Constant FPTs *****/
      173    10845
      174    10846        %FPT_PRIV                               ( FPTN = FPT_PRIV_DISPJOB,
      175    10847              PRIV = %PR_DISPJOB#,
      176    10848              AUTH = YES,
      177    10849              STCLASS = CONSTANT) ;
      178    10864        %FPT_OPEN                               ( FPTN = CFPT_OPEN_JOBINFO,
      179    10865              STCLASS = CONSTANT,
      180    10866              ASN = FILE,
      181    10867              FUN = IN,
      182    10868              SHARE = ALL,
      183    10869              NAME = JOBSTATS_NAME,
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:6    
      184    10870              ACCT = JOBSTATS_ACCT) ;
      185    10979        %FPT_TRMPRG                                   (FPTN = CFPT_TRMPRG,
      186    10980              STCLASS = CONSTANT,
      187    10981              RSTBRK = YES) ;
      188    11010        %FPT_PFIL                                     (FPTN = CFPT_PFIL,
      189    11011              STCLASS = CONSTANT,
      190    11012              BOF = YES) ;
      191    11027        %VLP_NAME                               ( FPTN = JOBSTATS_NAME,
      192    11028              STCLASS = CONSTANT,
      193    11029              LEN = 9,
      194    11030              NAME = ':JOBSTATS') ;
      195    11057        %VLP_ACCT                               ( FPTN = JOBSTATS_ACCT,
      196    11058              STCLASS = CONSTANT,
      197    11059              ACCT = ':SYS') ;
      198    11072
      199    11073             /***** Based FPTS *****/
      200    11074        %FPT_WRITE (FPTN=FPT$WRITE,STCLASS=BASED);
      201    11105        %FPT_CLOSE (FPTN=FPT$CLOSE,STCLASS=BASED);
      202    11147        %FPT_FID (FPTN=FPT$FID,STCLASS=BASED);
      203    11170        %FPT_SETFMA (FPTN=FPT$SETFMA,STCLASS=BASED);
      204    11183        %F$DCB (DCBN=F$DCB);
      205    11240             /***** Auto FPTS *****/
      206    11241    1   DCL RESULTS_ VECTOR AUTO;
      207    11242        %FPT_OPEN (FPTN=FPT_OPEN,STCLASS=AUTO);
      208    11351        %FPT_OPEN (FPTN=FPT_OPEN_USE,STCLASS=AUTO);
      209    11460        %FPT_READ (FPTN=FPT_READ_USE,STCLASS=AUTO);
      210    11499        %FPT_READ (FPTN=FPT_READ_JOBINFO,STCLASS=AUTO);
      211    11538        %FPT_CLOSE (FPTN=FPT_CLOSE,STCLASS=AUTO);
      212    11580        %FPT_DELREC (FPTN=FPT_DELREC,STCLASS=AUTO);
      213    11599        %FPT_PFIL (FPTN=FPT_PFIL,STCLASS=AUTO) ;
      214    11614        %FPT_PRECORD (FPTN=FPT_PRECORD,STCLASS=AUTO) ;
      215    11635        %FPT_JOBSTATS (FPTN=FPT_JOBSTATS,STCLASS=AUTO);
      216    11655        %FPT_JOBSTATS (FPTN=FPT_JOBSTATS_STATUS,STCLASS=AUTO);
      217    11675        %FPT_JOBSTATS (FPTN=FPT_JOBSTATS_CANCEL,STCLASS=AUTO);
      218    11695        %XSJ_INFOKEY (FPTN=XSJ_INFOKEY,STCLASS=AUTO);
      219    11708        %XSJ_JOBINFO (FPTN=XSJ_JOBINFO,STCLASS=AUTO);
      220    11723        %XSJ_NAMEREC(FPTN=XSJ_NAMEREC,STCLASS=AUTO) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:7    
      221    11736        %XSJ_NAMEKEY(FPTN=XSJ_NAMEKEY,STCLASS=AUTO) ;
      222    11750        %FPT_WAIT (FPTN=FPT_WAIT,STCLASS=AUTO) ;
      223    11764        %FPT_TIME (FPTN = FPT_TIME,STCLASS=AUTO) ;
      224    11783
      225    11784             /***** Based VLPS *****/
      226    11785
      227    11786        %VLR_JOBSTATS_ISRCH (FPTN=VLR$INPUT,STCLASS=BASED,NJOB=0) ;
      228    11800        %VLA_JOBSTATS_ISRCH (FPTN=VLA$INPUT,STCLASS=BASED) ;
      229    11827        %VLR_JOBSTATS_OSRCH (FPTN=VLR$OUTPUT,STCLASS=BASED,NFIL=0) ;
      230    11841        %VLA_JOBSTATS_OSRCH (FPTN=VLA$OUTPUT,STCLASS=BASED) ;
      231    11858        %VLP_VECTOR(FPTN=B$$VECTOR,STCLASS=BASED) ;
      232    11873             /***** Auto VLPS *****/
      233    11874        %VLP_ACCT (FPTN=FID_ACCT,STCLASS=AUTO);
      234    11887        %VLP_CRITERIA (FPTN=Q_CRITERIA,STCLASS=AUTO) ;
      235    11915        %VLP_CRITERIA (FPTN=SYSID_CRITERIA,STCLASS=AUTO) ;
      236    11943        %VLP_JOBNAME (FPTN=VLP_JOBNAME,STCLASS=AUTO);
      237    11957        %VLR_JOBSTATS_CHECK (FPTN=VLR_JOBSTATS_CHECK,STCLASS=AUTO);
      238    11976        %VLP_NAME (FPTN=FID_NAME,LEN=31,STCLASS=AUTO);
      239    12003        %VLP_SN (FPTN=FID_SN,STCLASS=AUTO);
      240    12016        %VLR_FID (FPTN=FID$RESULTS,STCLASS=BASED);
      241    12035             /***** Error codes *****/
      242    12036                   %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:8    
      243    12037        /*         Parsing macros                        */
      244    12038        %PLIST;
      245    12039        %PARSE$OUT(NAME=P$B,STCLASS=BASED);
      246    12084        %PARSE$SYM(NAME=P$S,STCLASS=BASED);
      247    12122        %P$PCB(NAME=P$PCB,STCLASS="");
      248    12323                   %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:9    
      249    12324        /*********************************************************************/
      250    12325        /*F*   NAME:   CPK$CHECK
      251    12326               PURPOSE: To process the CHECK command
      252    12327               DESCRIPTION: The CHECK command permits a user to check a job(s)
      253    12328                       identified by a sysid(s), job names, or all jobs in a specified
      254    12329                       account.
      255    12330               REFERENCE: Programmers Reference Manual
      256    12331        */
      257    12332        /*D*   NAME:   CPK$CHECK
      258    12333               CALL:   CALL CPK$CHECK (P$PCB)
      259    12334               INTERFACE: SETUP_FID
      260    12335               INPUT:  P$PCB - parse control block framing command.
      261    12336               OUTPUT:
      262    12337               DESCRIPTION: The CHECK command is scanned and the jobstats pmme
      263    12338                       initialized with the appropriate information.
      264    12339        */
      265    12340        /*********************************************************************/
      266    12341
      267    12342    1         IF ADDR(P$PCB) = ADDR(NIL) AND
      268    12343    1             NOT B$JIT.CPFLAGS1.SOMENOTIFY
      269    12344    1             THEN RETURN ;
      270    12345                                              /* CHECK called at JOBSTEP time,
      271    12346                                                  but there is nothing to report
      272    12347                                                  about. Therefore, return.
      273    12348                                              */
      274    12349    1         CMD_TYPE = %CHECK_CMD# ;
      275    12350
      276    12351    1         GOTO COMMON_CODE ;
      277    12352
      278    12353        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:10   
      279    12354        /*********************************************************************/
      280    12355        /*F*   NAME:   CPK$CANCEL
      281    12356               PURPOSE: To process the CANCE Lcoommand
      282    12357               DESCRIPTION: The CANCEL command permits a user to cancel a job(s)
      283    12358                       identified by a sysid(s), job names, or all jobs in a specified
      284    12359                       account.
      285    12360               REFERENCE: Programmers Reference Manual
      286    12361        */
      287    12362        /*D*   NAME:   CPK$CANCEL
      288    12363               CALL:   CALL CPK$CANCEL (P$PCB)
      289    12364               INPUT:  P$PCB - parse control block framing command.
      290    12365               OUTPUT:
      291    12366               DESCRIPTION: The CANCEL command is scanned and the jobstats pmme
      292    12367                       initialized with the appropriate information.
      293    12368        */
      294    12369        /*********************************************************************/
      295    12370
      296    12371    1   CPK$CANCEL: ENTRY (P$PCB) ALTRET;
      297    12372        /**/
      298    12373    1         CMD_TYPE = %CANCEL_CMD# ;
      299    12374
      300    12375    1         GOTO COMMON_CODE ;
      301    12376
      302    12377        %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:11   
      303    12378        /*********************************************************************/
      304    12379        /*F*       NAME:    CPK$SUBMIT_CHECK
      305    12380                   PURPOSE: To process the CHECK of a BATCH job that was submitted.
      306    12381               REFERENCE: Programmers Reference Manual
      307    12382        */
      308    12383        /*D*   NAME:   CPK$SUBMIT_CHECK
      309    12384               CALL:   CALL CPK$SUBMIT_CHECK (P$PCB)
      310    12385               INPUT:  P$PCB - parse control block framing command.
      311    12386                       P$PCB.OUT$->P$B.TEMP - is the NSTATUS flag value.
      312    12387                   DESCRIPTION:   If NSTATUS is set, just output and remember
      313    12388                            the JOB SUBMITTED message.  Otherwise do a CHECK
      314    12389                            for this SYSID.  If not found, output JOB SUBMITTED
      315    12390                            message and remember in USE file.
      316    12391        */
      317    12392        /*********************************************************************/
      318    12393    1   CPK$SUBMIT_CHECK:
      319    12394    1     ENTRY(P$PCB)   ALTRET;
      320    12395        /**/
      321    12396    1         CMD_TYPE = %SUBMIT_CMD# ;
      322    12397                  /*  P$B.TEMP passes the NSTATUS_OPT# to CPK$SUBMIT_CHECK.
      323    12398                      P$B.SUBLK$(0)->P$B.TEMP indicate that this is  across
      324    12399                                account batch job.
      325    12400                  */
      326    12401    1         NSTATUS_FLG = P$PCB.OUT$->P$B.TEMP ;
      327    12402    1         CROSS_ACCT_BATCH_FLG = P$PCB.OUT$->P$B.SUBLK$(0)->P$B.TEMP ;
      328    12403    1         GOTO COMMON_CODE ;
      329    12404        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:12   
      330    12405        /*********************************************************************/
      331    12406        /*F*       NAME:    CPK$NOTIFY
      332    12407                   PURPOSE: To process the NOTIFY command
      333    12408               REFERENCE: Programmers Reference Manual
      334    12409        */
      335    12410        /*D*   NAME:   CPK$NOTIFY
      336    12411               CALL:   CALL CPK$NOTIFY (P$PCB)
      337    12412               INPUT:  P$PCB - parse control block framing command.
      338    12413                   DESCRIPTION:   Sets A bit in CPFLAGS1 so that after each
      339    12414                            JOBSTEP the user will be notified of changes in
      340    12415                            status of his BATCH jobs.
      341    12416        */
      342    12417        /*********************************************************************/
      343    12418    1   CPK$NOTIFY:
      344    12419    1     ENTRY(P$PCB)   ALTRET;
      345    12420        /**/
      346    12421    1         CMD_TYPE = %NOTIFY_CMD# ;
      347    12422    1         B$JIT.CPFLAGS1.NOTIFY = %YES# ;
      348    12423    1         B$JIT.CPFLAGS1.SOMENOTIFY = %YES# ;
      349    12424        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:13   
      350    12425    1   COMMON_CODE:
      351    12426        /*
      352    12427             ***** Init FPT_JOBSTATS for CHECK function...
      353    12428        */
      354    12429    1         FPT_JOBSTATS=CFPT_JOBSTATS;
      355    12430    1         FPT_JOBSTATS.V_=VECTOR(FPT_JOBSTATS.V);
      356    12431        /*
      357    12432             ***** Init FPT_JOBSTATS_CANCEL
      358    12433        */
      359    12434    1         FPT_JOBSTATS_CANCEL = CFPT_JOBSTATS;
      360    12435    1         FPT_JOBSTATS_CANCEL.V_ = VECTOR(FPT_JOBSTATS_CANCEL.V);
      361    12436    1         FPT_JOBSTATS_CANCEL.V.OUTPUT# = %YES#;
      362    12437        /*
      363    12438           ***** Init FPT_CLOSE for future closes.
      364    12439        */
      365    12440    1         FPT_CLOSE = CFPT_CLOSE ;
      366    12441    1         FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V) ;
      367    12442    1         FPT_CLOSE.V.DISP# = %SAVE# ;
      368    12443        /*
      369    12444           ***** Init FPT_OPEN_USE for future opens.
      370    12445        */
      371    12446    1         FPT_OPEN_USE = CFPT_OPEN ;
      372    12447    1         FPT_OPEN_USE.V_ = VECTOR(FPT_OPEN_USE.V) ;
      373    12448    1         FPT_OPEN_USE.V.DCB# = M$IBEX_NUM ;
      374    12449    1         FPT_OPEN_USE.V.ORG# = %KEYED# ;
      375    12450    1         FPT_OPEN_USE.V.ACS# = %DIRECT# ;
      376    12451    1         FPT_OPEN_USE.V.SHARE# = %ALL# ;
      377    12452        /*
      378    12453           ***** Init FPT_READ_JOBINFO for future reads.
      379    12454        */
      380    12455    1         FPT_READ_JOBINFO = CFPT_READ ;
      381    12456    1         FPT_READ_JOBINFO.V_ = VECTOR(FPT_READ_JOBINFO.V) ;
      382    12457    1         FPT_READ_JOBINFO.V.DCB# = M$IBEX1_NUM ;
      383    12458    1         FPT_READ_JOBINFO.V.KEYS# = %YES# ;
      384    12459        /*
      385    12460           ***** Init FPT_PFIL for future BOFs.
      386    12461        */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:14   
      387    12462    1         FPT_PFIL = CFPT_PFIL ;
      388    12463    1         FPT_PFIL.V_ = VECTOR(FPT_PFIL.V) ;
      389    12464    1         FPT_PFIL.V.DCB# = M$IBEX_NUM ;
      390    12465        /*
      391    12466           ***** Init FPT_PRECORD for future positioning.
      392    12467        */
      393    12468    1         FPT_PRECORD = CFPT_PRECORD ;
      394    12469    1         FPT_PRECORD.V_ = VECTOR(FPT_PRECORD.V) ;
      395    12470    1         FPT_PRECORD.V.DCB# = M$IBEX_NUM ;
      396    12471    1         FPT_PRECORD.KEY_ = VECTOR(CHKEYBUF) ;
      397    12472    1         FPT_PRECORD.V.KEYS# = %YES# ;
      398    12473    1         FPT_PRECORD.V.KEYR# = %YES# ;
      399    12474        /*
      400    12475           ***** Other inits that need to be done.
      401    12476        */
      402    12477    1         FID_ACCT.ACCT# = ' ' ;
      403    12478    1         CMDSTRM_CLOSED# = %NO# ;
      404    12479    1         REMEMBER E_DONT_POSTERR IN BAD_USEFILE_REMEM ;
      405    12480        /*
      406    12481           ***** Get rid of any errors that we know about.
      407    12482        */
      408    12483    1         ADDR(SEG$2.ERRBUF)->ERR$BLK.FIRST = 0 ;
      409    12484    1         ADDR(SEG$2.ERRBUF)->ERR$BLK.NEXT = 0 ;
      410    12485        /*
      411    12486           ***** DCBs used by CHECK.
      412    12487
      413    12488              *S        file - M$IBEX1
      414    12489              :JOBSTATS file - M$IBEX1
      415    12490              *$$JOB    file - M$IBEX
      416    12491              Output    fid  - M$LL/M$IBEX2
      417    12492         */
      418    12493        /*
      419    12494             ***** Get the NOTIFY defaults ...
      420    12495        */
      421    12496    1         CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(E_DONT_POSTERR);
      422    12497    1         CALL CPC$GETSEG (SEG4$,3072) ALTRET(E_CHKSEG);
      423    12498    1         RESULTS_ = VECTOR (PINCRW(SEG4$,2048)->B$$PAGE);
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:15   
      424    12499    1         CALL CPC$OPEN_LL ;
      425    12500    2         DO WHILE (%NO#);
      426    12501    2   E_CHKSEG:   /* Screech */
      427    12502    2             CALL CPC$SCREECH (E$SUASEG,CPB$IBEXMID);
      428    12503    2         END;
      429    12504    1         JOBSTATS_OPEN# = %NO#;
      430    12505    1         USEFID_OPEN# = %NO#;
      431    12506    1         SYSTEM_OK# = %NO# ;
      432    12507    1         SYSIDBUF = %NO# ;
      433    12508    1         CALL CPJ$READ_S (M$IBEX1_NUM,VECTOR(K_NOTIFY),VECTOR(CP_CHFLAGS))
      434    12509    1                         ALTRET(E_READ_CHECK) ;
      435    12510                                                              /* Check to see about
      436    12511                                                                   SYSTEM flag. */
      437    12512    1         IF CP_CHFLAGS.SYSTEM AND (B$JIT.PRIV.AUTH & %PR_DISPJOB#)
      438    12513    1             THEN                                             /* Check DISPJOB priv. */
      439    12514    2               CALL M$SPRIV(FPT_PRIV_DISPJOB) WHENRETURN DO;
      440    12515    2                                                 SYSTEM_OK# = %YES# ;
      441    12516    2                                               END;
      442    12517    2                                               WHENALTRETURN DO;
      443    12518    2                                               END;
      444    12519        /*
      445    12520             *****  Not the first time CHECK or NOTIFY has been called.
      446    12521        */
      447    12522
      448    12523    2         DO WHILE (%NO#);
      449    12524    2   E_READ_CHECK:
      450    12525    2            IF B$JIT.USRERR.CODE ~= %E$NOKEY
      451    12526    2                THEN   /* Trouble */
      452    12527    2                  GOTO E_CHECK;
      453    12528                            /* No NOTIFY record yet. */
      454    12529    2            CP_CHFLAGS = CP_C_CHFLAGS ;
      455    12530    2            B$JIT.USRERR = '0'B ;
      456    12531    2         END ; /* DO WHILE */
      457    12532        /*
      458    12533           ***** Init CP_FIDVLPS for future use.
      459    12534        */
      460    12535    1         CP_FIDVLPS.FID_ACCT_ = VECTOR(CP_CHFLAGS.USE_ACCT) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:16   
      461    12536    1         CP_FIDVLPS.FID_NAME_ = VECTOR(CP_CHFLAGS.USE_NAME) ;
      462    12537    1         CP_FIDVLPS.FID_PASS_ = VECTOR(CP_CHFLAGS.USE_PASS) ;
      463    12538    1         CP_FIDVLPS.FID_WSN_ = VECTOR(CP_CHFLAGS.USE_WSN) ;
      464    12539    1         CP_FIDVLPS.FID_SN_ = VECTOR(CP_CHFLAGS.USE_SN) ;
      465    12540    1         CP_FIDVLPS.FID_RES = CP_CHFLAGS.USE_RES ;
      466    12541    1         CP_FIDVLPS.FID_ASN = CP_CHFLAGS.USE_ASN ;
      467    12542    1         CP_FIDVLPS.FID_RESULTS = CP_CHFLAGS.USE_RESULTS ;
      468    12543        /*
      469    12544             ***** Code to support CHECK called because of NOTIFY ...
      470    12545        */
      471    12546    1         IF ADDR(P$PCB) = ADDR(NIL)
      472    12547    1           THEN
      473    12548    2             DO;
      474    12549    2               IF NOT B$JIT.CPFLAGS1.SOMENOTIFY
      475    12550    2                 THEN
      476    12551    2                   GOTO CHECK_CLEANUP;
      477    12552    2            NOTIFYING = %YES# ;
      478    12553    2            IF (CP_CHFLAGS.FLG.SRCHQS)
      479    12554    2               THEN
      480    12555    3                 DO ;                            /* Input, Running, or Output. */
      481    12556    3                   NOTIFY_Q_FLAGS(0) = CP_CHFLAGS.FLG.INPUT ;
      482    12557    3                   NOTIFY_Q_FLAGS(1) = CP_CHFLAGS.FLG.RUNNING ;
      483    12558    3                   NOTIFY_Q_FLAGS(2) = CP_CHFLAGS.FLG.OUTPUT ;
      484    12559
      485    12560    4                   DO I = 0 TO 2 ;
      486    12561    4                     IF NOTIFY_Q_FLAGS(I)
      487    12562    4                       THEN
      488    12563    5                         DO ;
      489    12564    6                           DO CASE(I) ;
      490    12565    6                             CASE(0) ;
      491    12566    6                               CMD_CODE = %CH_INPUT ;
      492    12567    6                               Q_CRITERIA = CP_CHFLAGS.I_CRITERIA ;
      493    12568    6                               Q_CRITERIA.RUNNING# = %NO# ;
      494    12569    6                             CASE(1) ;
      495    12570    6                               CMD_CODE = %CH_RUN ;
      496    12571    6                               Q_CRITERIA = CP_CHFLAGS.I_CRITERIA ;
      497    12572    6                               Q_CRITERIA.RUNNING# = %YES# ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:17   
      498    12573    6                             CASE(2) ;
      499    12574    6                               CMD_CODE = %CH_OUTPUT ;
      500    12575    6                               Q_CRITERIA = CP_CHFLAGS.O_CRITERIA ;
      501    12576    6                             END ; /* DO CASE */
      502    12577    5                             CALL SETUP_Q_SRCH_JOBSTATS ;
      503    12578    5                             CALL GET_JOBSTATS ALTRET(E_DONE_NOTIFYQ) ;
      504    12579    5                             CH_XFORMAT.MSG# = %CP_BLANKLINE_MESS ;
      505    12580    5                             CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
      506    12581    5   E_DONE_NOTIFYQ:
      507    12582    5                         END ; /* THEN DO */
      508    12583    4                   END ; /* DO I */
      509    12584    3                 END ; /* THEN DO */
      510    12585    2             IF (CP_CHFLAGS.FLG.TERM)
      511    12586    2               THEN
      512    12587    3                 DO ;                                         /* Do TERM. */
      513    12588    3                   P_DUMMY = '0'B ;              /* Setup dummy block with */
      514    12589    3                   P$ = ADDR(P_DUMMY) ;          /* number of sublks = 0 */
      515    12590    3                   CMD_CODE = %CH_TERM_CMD ;
      516    12591    3                   TEMP = B$JIT.SYSID ;
      517    12592    3                   CALL SETUP_SYSID_SRCH ALTRET(E_DONT_POSTERR) ;
      518    12593    3                 END ; /* Then Do */
      519    12594    2             IF (CP_CHFLAGS.FLG.SRCHID)
      520    12595    2               THEN
      521    12596    3                 DO ;                                         /* Do SYSIDs. */
      522    12597    3                   CALL CHECK_SYSIDS ALTRET(CHECK_CLEANUP) ;
      523    12598    3                 END ; /* THEN DO */
      524    12599    2             IF (CP_CHFLAGS.FLG.WAIT)
      525    12600    2               THEN
      526    12601    3                 DO ;                                    /* WAIT! */
      527    12602    3                   CALL NOTIFY_WAIT ;
      528    12603    3                 END ; /* THEN DO */
      529    12604    2           GOTO CHECK_CLEANUP;
      530    12605    2         END ; /* IF no PCB */
      531    12606        /*
      532    12607             ***** Normal CHECK ...
      533    12608        */
      534    12609    1         BLK$ = P$PCB.OUT$;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:18   
      535    12610    1         NOTIFYING = %NO# ;
      536    12611        /*
      537    12612             ***** If no arguments, then display SYSIDs ...
      538    12613        */
      539    12614    1         IF (BLK$ -> P$B.NSUBLKS = 0)
      540    12615    1             THEN
      541    12616    1               IF CMD_TYPE = %NOTIFY_CMD#
      542    12617    1                 THEN
      543    12618    2                   DO ;                                       /* Set SRCHID flag. */
      544    12619    2                     CP_CHFLAGS.FLG = %NO# ;
      545    12620    2                     CP_CHFLAGS.FLG.SRCHID = %YES# ;
      546    12621    2                   END ; /* THEN DO */
      547    12622    1                 ELSE CALL CHECK_SYSIDS ALTRET(CHECK_CLEANUP) ;
      548    12623
      549    12624    1           ELSE                                /* Options specified. */
      550    12625    2             DO ;
      551    12626    2               FIRST_QFLAG = '1'B ;
      552    12627    2               OUTPUT_FLG = '0'B ;     /* Remember output-producing commands */
      553    12628    2               K = 0;                 /* Flag for multiple ME/SYSTEM options */
      554    12629    3               DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;
      555    12630                                              /* Do the first level options. */
      556    12631    3                 P$=BLK$->P$B.SUBLK$(I);
      557    12632    3                 CMD_CODE = P$->P$B.CODE ;
      558    12633    4                   DO CASE(CMD_CODE);
      559    12634
      560    12635    4                     CASE (%CH_ME) ;
      561    12636    4                       CP_CHFLAGS.SYSTEM = %NO# ;
      562    12637    4                       K = K + 1;
      563    12638
      564    12639    4                     CASE (%CH_SYSTEM) ;
      565    12640    4                       IF (SYSTEM_OK# = %NO#)
      566    12641    4                         THEN
      567    12642    4                           IF (B$JIT.PRIV.AUTH & %PR_DISPJOB#)
      568    12643    4                             THEN
      569    12644    4                               CALL M$SPRIV(FPT_PRIV_DISPJOB) WHENRETURN
      570    12645    5                                   DO;
      571    12646    5                                     IF K = 0
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:19   
      572    12647    5                                       THEN
      573    12648    5                                         CP_CHFLAGS.SYSTEM = %YES# ;
      574    12649    5                                     K = K + 1;
      575    12650    5                                     SYSTEM_OK# = %YES# ;
      576    12651    5                                   END ; /* Whenreturn */
      577    12652    4                             ELSE
      578    12653    4   CH_NOPRIV:                  CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),P$->P$B.CPOS,
      579    12654    4                                         E_CHKNOPRIV,, M$IBEX1_NUM) ;
      580    12655
      581    12656    4                     CASE (%CH_USE);
      582    12657    4                       USEFID_OPEN# = %NO# ;
      583    12658    4                       IF (P$->P$S.NSUBLKS = 0)
      584    12659    4                         THEN
      585    12660    5                           DO ;                          /* Use *$$JOB. */
      586    12661    5                             TEMPBUF$ = ADDR(TEMPBUF) ;
      587    12662    5                             TEMPBUF$ -> P$S.COUNT = 6 ;
      588    12663    5                             TEMPBUF$ -> P$S.TEXT = '*$$JOB' ;
      589    12664    5                             TEMPBUF$ -> P$S.TEXTC$ = ADDR(TEMPBUF$->P$S.COUNT) ;
      590    12665    5                           END ; /* THEN DO */
      591    12666    4                         ELSE TEMPBUF$ = P$->P$S.TEXTC$ ;
      592    12667    4                       CALL CPC$FID_VLP(,TEMPBUF$,CP_FIDVLPS)
      593    12668    4                               ALTRET (E_WRITE_CHECK) ;
      594    12669    4                       CP_CHFLAGS.USE_RES = CP_FIDVLPS.FID_RES ;
      595    12670    4                       CP_CHFLAGS.USE_ASN = CP_FIDVLPS.FID_ASN ;
      596    12671    4                       TEMP$ = ADDR(CP_FIDVLPS.FID_RESULTS) ;
      597    12672    4                       IF NOT TEMP$ -> FID$RESULTS.ACCT AND P$->P$S.NSUBLKS ~= 0
      598    12673    4                         THEN
      599    12674    5                           DO ;
      600    12675    5                             TEMP$ -> FID$RESULTS.ACCT = %YES# ;
      601    12676    5                             CP_CHFLAGS.USE_ACCT = B$JIT.FACCN ;
      602    12677    5                             IF NOT TEMP$ -> FID$RESULTS.SN AND B$JIT.FPSN ~= ' '
      603    12678    5                               THEN
      604    12679    6                                 DO ;
      605    12680    6                                   TEMP$ -> FID$RESULTS.SN = %YES# ;
      606    12681    6                                   CP_CHFLAGS.USE_SN.N = 1 ;
      607    12682    6                                   CP_CHFLAGS.USE_SN.SN(0) = B$JIT.FPSN ;
      608    12683    6                                 END ; /*  Then Do */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:20   
      609    12684    5                           END ; /* Then Do */
      610    12685    4                       CP_CHFLAGS.USE_RESULTS = CP_FIDVLPS.FID_RESULTS ;
      611    12686    4                       IF BLK$ -> P$B.NSUBLKS = 1 AND CMD_TYPE ~= %NOTIFY_CMD#
      612    12687    4                         THEN                    /* Only USE specified. */
      613    12688    5                           DO ;
      614    12689    5                             CALL CHECK_SYSIDS ALTRET(CHECK_CLEANUP) ;
      615    12690    5                             OUTPUT_FLG = '1'B;
      616    12691    5                           END ;
      617    12692
      618    12693    4                     CASE(ELSE) ;
      619    12694    4                       OUTPUT_FLG = '1'B ; /* Got something that produces output */
      620    12695
      621    12696    4                   END ; /* DO CASE */
      622    12697    3               END ; /* DO I */
      623    12698
      624    12699    2               IF NOT OUTPUT_FLG AND K = 1
      625    12700    2                 THEN
      626    12701    3                   DO ; /* Got CHECK (ME) or CHECK (SYS) - do I,R,O */
      627    12702    3                     BLK$->P$B.NSUBLKS = 1;
      628    12703    3                     BLK$->P$B.SUBLK$(0) = BLK$; /* Point at itself */
      629    12704    3                     BLK$->P$B.CODE = %CH_INPUT;
      630    12705    3                   END ;
      631    12706
      632    12707    3               DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;
      633    12708                                              /* Do the other options. */
      634    12709    3                 IF B$JIT.CPFLAGS1.BRK
      635    12710    3                   THEN                  /* Forget the rest. */
      636    12711    4                     DO ;
      637    12712    4                       B$JIT.CPFLAGS1.BRK = %NO#;
      638    12713    4                       GOTO CHECK_CLEANUP ;
      639    12714    4                     END ; /* THEN DO */
      640    12715    3                 FPT_JOBSTATS_CANCEL.V.OUTPUT# = %YES#;
      641    12716    3                 FPT_JOBSTATS_CANCEL.V.ORDER# = %CANCEL#;
      642    12717    3                 P$=BLK$->P$B.SUBLK$(I);
      643    12718    3                 CMD_CODE = P$->P$B.CODE ;
      644    12719    4                   DO CASE(CMD_CODE);
      645    12720
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:21   
      646    12721    4                     CASE (%CH_INPUT,%CH_RUN,%CH_JOB) ;
      647    12722    4                       CALL SETUP_Q_SRCH ;
      648    12723    4                       IF CMD_TYPE = %NOTIFY_CMD#
      649    12724    4                         THEN
      650    12725    5                           DO ;                          /* Remember. */
      651    12726    5                             CP_CHFLAGS.FLG.SRCHID = %NO# ;
      652    12727    5                             CP_CHFLAGS.FLG.SRCHQS = %YES# ;
      653    12728    5                             CP_CHFLAGS.I_CRITERIA = Q_CRITERIA ;
      654    12729    5                             GET_JOBSTATS# = %NO# ;
      655    12730    5                           END ; /* THEN DO */
      656    12731    4                         ELSE
      657    12732    4                           GET_JOBSTATS# = %YES# ;
      658    12733
      659    12734    4                     CASE (%CH_OUTPUT) ;
      660    12735    4                       CALL SETUP_Q_SRCH ;
      661    12736    4                       IF CMD_TYPE = %NOTIFY_CMD#
      662    12737    4                         THEN
      663    12738    5                           DO ;                          /* Remember */
      664    12739    5                             CP_CHFLAGS.FLG.SRCHID = %NO# ;
      665    12740    5                             CP_CHFLAGS.FLG.SRCHQS = %YES# ;
      666    12741    5                             CP_CHFLAGS.O_CRITERIA = Q_CRITERIA ;
      667    12742    5                             GET_JOBSTATS# = %NO# ;
      668    12743    5                           END ; /* THEN DO */
      669    12744    4                         ELSE
      670    12745    4                           GET_JOBSTATS# = %YES# ;
      671    12746
      672    12747    4                     CASE (%CH_SYSIDCMD,%CH_JOBNAME);
      673    12748    4                       REMEMBER SUBMIT_LOOP IN SUBMIT_LOOP_REMEM;
      674    12749    4   SUBMIT_LOOP:        IF B$JIT.CPFLAGS1.BRK
      675    12750    4                         THEN                  /* Forget the rest. */
      676    12751    5                           DO ;
      677    12752    5                             B$JIT.CPFLAGS1.BRK = %NO#;
      678    12753    5                             IF CMD_TYPE = %SUBMIT_CMD#
      679    12754    5                               THEN
      680    12755    6                                 DO ;
      681    12756    6                                   CALL SETUP_DUMMY_SUBMIT_MESS ;
      682    12757    6                                   CALL PRINT_SUBMIT_MESS ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:22   
      683    12758    6                                 END;  /* Then Do */
      684    12759    5                             GOTO CHECK_CLEANUP ;
      685    12760    5                           END ; /* THEN DO */
      686    12761    4                       CALL SETUP_SYSID_SRCH ALTRET(E_DONT_POSTERR) ;
      687    12762    4                       GET_JOBSTATS# = %NO# ;
      688    12763
      689    12764    4                     CASE (%CH_LAST);
      690    12765    4                       TEMP = B$JIT.LBJID ;
      691    12766    4                       IF TEMP = 0
      692    12767    4                          THEN
      693    12768    5                             DO;
      694    12769    5                                CH_XFORMAT.MSG# = %CP_NONE_MESS ;
      695    12770    5                                CALL CPK$CHECK_OUTPUT(CH_XFORMAT);
      696    12771    5                             END;
      697    12772    4                       ELSE
      698    12773    4                          CALL SETUP_SYSID_SRCH ALTRET(E_DONT_POSTERR) ;
      699    12774    4                       GET_JOBSTATS# = %NO# ;
      700    12775
      701    12776    4                     CASE (%CH_TERM_CMD);
      702    12777    4                       IF CMD_TYPE = %NOTIFY_CMD#
      703    12778    4                         THEN
      704    12779    4                           CP_CHFLAGS.FLG.TERM = %YES# ;
      705    12780    4                         ELSE
      706    12781    5                           DO ;
      707    12782    5                             TEMP = B$JIT.SYSID ;
      708    12783    5                             CALL SETUP_SYSID_SRCH ALTRET(E_DONT_POSTERR) ;
      709    12784    5                           END ; /* Else Do */
      710    12785    4                       GET_JOBSTATS# = %NO# ;
      711    12786
      712    12787    4                     CASE(%CH_WAIT) ;
      713    12788    4                       CALL CHECK_WAIT ;
      714    12789    4                       GET_JOBSTATS# = %NO# ;
      715    12790    4                         WAITING = %NO# ;
      716    12791
      717    12792    4                     CASE(%CH_ME);
      718    12793    4                       CP_CHFLAGS.SYSTEM = %NO#;
      719    12794    4                       GET_JOBSTATS# = %NO#;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:23   
      720    12795
      721    12796    4                     CASE(%CH_SYSTEM);
      722    12797    4                       CP_CHFLAGS.SYSTEM = %YES#;
      723    12798    4                       GET_JOBSTATS# = %NO#;
      724    12799
      725    12800    4                     CASE(ELSE) ;
      726    12801    4                       GET_JOBSTATS# = %NO# ;
      727    12802
      728    12803    4                   END;   /* do case ... end */
      729    12804    3                 IF (GET_JOBSTATS#)
      730    12805    3                   THEN
      731    12806    4                     DO ;
      732    12807    4                       CALL GET_JOBSTATS ALTRET(E_DONT_POSTERR) ;
      733    12808    4                       CH_XFORMAT.MSG# = %CP_BLANKLINE_MESS ;
      734    12809    4                       CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
      735    12810    4                     END ; /* THEN DO */
      736    12811    3   DONT_GET_JOBSTATS:
      737    12812
      738    12813    3                 IF ADDR(SEG$2.ERRBUF)->ERR$BLK.FIRST ~= 0
      739    12814    3                   THEN
      740    12815    3                     GOTO E_DONT_POSTERR ;
      741    12816
      742    12817    3                 IF P$ = BLK$
      743    12818    3                   THEN
      744    12819    4                     DO;
      745    12820    4                       IF CMD_CODE = %CH_INPUT
      746    12821    4                         THEN
      747    12822    4                         BLK$->P$B.CODE = %CH_RUN;
      748    12823    4                         ELSE
      749    12824    4                           IF CMD_CODE = %CH_OUTPUT
      750    12825    4                             THEN
      751    12826    4                               EXIT;
      752    12827    4                             ELSE
      753    12828    4                             BLK$->P$B.CODE = %CH_OUTPUT;
      754    12829    4                       I = I - 1;
      755    12830    4                     END;
      756    12831
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:24   
      757    12832    3               END;   /* DO i ... end */
      758    12833    2             END ; /* THEN DO */
      759    12834        /*
      760    12835             ***** If the :JOBSTATS file is still open, close it...
      761    12836        */
      762    12837    1   CHECK_CLEANUP:
      763    12838    1         IF CMD_TYPE = %NOTIFY_CMD#
      764    12839    1             THEN
      765    12840    2               DO ;                                      /* Update *S file. */
      766    12841    2                 IF JOBSTATS_OPEN#
      767    12842    2                   THEN
      768    12843    3                     DO;
      769    12844    3                       FPT_CLOSE.V.DCB# = M$IBEX1_NUM;
      770    12845    3                       CALL M$CLOSE (FPT_CLOSE) ALTRET(E_CHECK);
      771    12846    3                       CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(E_DONT_POSTERR);
      772    12847    3                     END;
      773    12848    2                  CALL CPJ$WRITE_S (M$IBEX1_NUM,VECTOR(K_NOTIFY),VECTOR(CP_CHFLAGS))
      774    12849    2                      ALTRET(E_WRITE_CHECK) ;
      775    12850    2               END ; /* THEN DO */
      776    12851    1         CALL CPC$RELSEG (SEG4$);
      777    12852    2         DO WHILE (%NO#);
      778    12853    2   E_WRITE_CHECK:
      779    12854    2           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR,,M$IBEX1_NUM);
      780    12855    2         END;
      781    12856    1         IF DCBADDR(M$IBEX1_NUM) -> F$DCB.FCD#
      782    12857    1           THEN   /* Close it */
      783    12858    2             DO;
      784    12859    2               FPT_CLOSE.V.DCB# = M$IBEX1_NUM;
      785    12860    2               CALL M$CLOSE (FPT_CLOSE) ALTRET(E_CHECK);
      786    12861    2             END;
      787    12862    1         IF (CMDSTRM_CLOSED#)
      788    12863    1             THEN
      789    12864    2               DO ;                                      /* Open command stream */
      790    12865    2                     FPT_CLOSE.V.DCB# = M$IBEX_NUM ;
      791    12866    2                     CALL M$PFIL(FPT_PFIL) ALTRET (E_PFIL) ;
      792    12867    2                     FPT_READ_USE = CFPT_READ ;
      793    12868    2                     FPT_READ_USE.V_ = VECTOR(FPT_READ_USE.V) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:25   
      794    12869    2                     FPT_READ_USE.BUF_ = VECTOR(SYSIDBUF) ;
      795    12870    2                     FPT_READ_USE.KEY_ = VECTOR(CHKEYBUF) ;
      796    12871    2                     FPT_READ_USE.V.KEYS# = %NO# ;
      797    12872    2                     FPT_READ_USE.V.KEYR# = %YES# ;
      798    12873    2                     FPT_READ_USE.V.DCB# = M$IBEX_NUM ;
      799    12874    2                     FPT_CLOSE.V.DISP# = %SAVE# ;
      800    12875    2                     CALL M$READ(FPT_READ_USE) WHENALTRETURN
      801    12876    3                           DO ;
      802    12877    3                             IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$BADVECT1
      803    12878    3                               THEN
      804    12879    4                                 DO ;
      805    12880    4                                   CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF), 511,
      806    12881    4                                             E_CHKBADUSEF) ;
      807    12882    4                                   GOTO E_DONT_POSTERR ;
      808    12883    4                                 END ; /* Then Do */
      809    12884    3                             IF B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$EOF
      810    12885    3                               THEN
      811    12886    4                                 DO ;
      812    12887    4                                   B$JIT.CPFLAGS1.SOMENOTIFY = %NO# ;
      813    12888    4                                   FPT_CLOSE.V.DISP# = %RELEASE# ;
      814    12889    4                                 END ; /* THEN DO */
      815    12890    3                           END ; /* Do Whenaltreturn */
      816    12891    3                     DO WHILE('0'B) ;
      817    12892    3   E_PFIL:
      818    12893    3                       ADDR(SEG$2.ERRBUF) -> ERR$BLK.FIRST = 0;
      819    12894    3                       ADDR(SEG$2.ERRBUF) -> ERR$BLK.NEXT = 0;
      820    12895    3                       IF B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$FILEBUSY
      821    12896    3                         THEN
      822    12897    3                           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_USEFILEBUSY) ;
      823    12898    3                         ELSE
      824    12899    3                           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.
             12899                                    ERR) ;
      825    12900    3                     END ; /* DO WHILE */
      826    12901        /*E*       ERROR:   CPK-E$USEFILEBUSY-C
      827    12902                   MESSAGE: CHECK/NOTIFY USE file busy.
      828    12903                   DESCRIPTION: CHECK/NOTIFY try to access a USE file that was busy.
      829    12904        */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:26   
      830    12905    2                     IF DCBADDR(M$IBEX_NUM) -> F$DCB.FCD#
      831    12906    2                       THEN CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN
      832    12907    3                                   DO ;
      833    12908    3                                   END ; /* Whenaltreturn Do */
      834    12909    2                 CALL CPB$OPENCS ;
      835    12910    2               END ; /* THEN DO */
      836    12911    1         IF ADDR(SEG$2.ERRBUF)->ERR$BLK.FIRST ~= 0
      837    12912    1             THEN
      838    12913    1               GOTO CPK$CHECK_ALTRET ;
      839    12914
      840    12915    1   CPK$CHECK_RET:
      841    12916    1         IF NOTIFYING AND CP_CHFLAGS.FLG.TERM
      842    12917    1             THEN
      843    12918    1               B$JIT.CPFLAGS1.SOMENOTIFY = %YES# ;
      844    12919    1         IF SYSTEM_OK#
      845    12920    1           THEN
      846    12921    2             CALL M$RPRIV(FPT_PRIV_DISPJOB) WHENALTRETURN DO; END;
      847    12922    1         RETURN;
      848    12923    1   E_CHECK:
      849    12924    1         CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$ -> B$ALT.ERR);
      850    12925    1   E_DONT_POSTERR:
      851    12926    1         CALL CPC$RELSEG (SEG4$);
      852    12927    1         IF DCBADDR(M$IBEX1_NUM) -> F$DCB.FCD#
      853    12928    1           THEN   /* Close it */
      854    12929    2             DO;
      855    12930    2               FPT_CLOSE.V.DCB# = M$IBEX1_NUM;
      856    12931    2               CALL M$CLOSE (FPT_CLOSE) ALTRET(E_CHECK);
      857    12932    2             END;
      858    12933    1         IF (CMDSTRM_CLOSED#)
      859    12934    1             THEN
      860    12935    2               DO ;                                      /* Open command stream */
      861    12936    2                 FPT_CLOSE.V.DCB# = M$IBEX_NUM ;
      862    12937    2                 IF DCBADDR(M$IBEX_NUM) -> F$DCB.FCD#
      863    12938    2                   THEN CALL M$CLOSE(FPT_CLOSE) ;
      864    12939    2                 CALL CPB$OPENCS ;
      865    12940    2               END ; /* THEN DO */
      866    12941    1   CPK$CHECK_ALTRET:
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:27   
      867    12942    1         IF NOTIFYING AND CP_CHFLAGS.FLG.TERM
      868    12943    1             THEN
      869    12944    1               B$JIT.CPFLAGS1.SOMENOTIFY = %YES# ;
      870    12945    1         IF SYSTEM_OK#
      871    12946    1           THEN
      872    12947    2             CALL M$RPRIV(FPT_PRIV_DISPJOB) WHENALTRETURN DO; END;
      873    12948
      874    12949    1         ALTRETURN;
      875    12950        %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:28   
      876    12951    1   SETUP_Q_SRCH: PROC ;
      877    12952
      878    12953    2         IF CMD_TYPE ~= %NOTIFY_CMD#
      879    12954    2             THEN GOTO DONT_REMEMBER_Q_SRCH ;
      880    12955    3         DO WHILE(FIRST_QFLAG) ;
      881    12956    3           FIRST_QFLAG = '0'B ;
      882    12957    3           CP_CHFLAGS.FLG = '0'B ;
      883    12958    3         END ; /* DO WHILE */
      884    12959    2         IF (CMD_CODE = %CH_INPUT)
      885    12960    2             THEN                                  /* INPUT */
      886    12961    3               DO ;
      887    12962    3                 CP_CHFLAGS.FLG.INPUT = %YES# ;
      888    12963    3               END ; /* THEN DO */
      889    12964    2             ELSE IF (CMD_CODE = %CH_RUN) OR CMD_CODE = %CH_JOB
      890    12965    2                     THEN                          /* RUNNING */
      891    12966    3                       DO ;
      892    12967    3                         CP_CHFLAGS.FLG.RUNNING = %YES# ;
      893    12968    3                        END ; /* THEN DO */
      894    12969    2                     ELSE                          /* OUTPUT */
      895    12970    3                       DO ;
      896    12971    3                         CP_CHFLAGS.FLG.OUTPUT = %YES# ;
      897    12972    3                       END ; /* ELSE DO */
      898    12973    2   DONT_REMEMBER_Q_SRCH:
      899    12974
      900    12975    2         Q_CRITERIA = CVLP_CRITERIA ;
      901    12976    2         IF (CMD_CODE = %CH_RUN) OR CMD_CODE = %CH_JOB
      902    12977    2           THEN Q_CRITERIA.RUNNING# = %YES# ;
      903    12978    2         IF (CP_CHFLAGS.SYSTEM)
      904    12979    2             THEN  Q_CRITERIA.ACCT# = ' ' ;
      905    12980    2             ELSE  Q_CRITERIA.ACCT# = B$JIT$ -> B$JIT.ACCN ;
      906    12981
      907    12982    2         IF P$ -> P$B.NSUBLKS ~= 0
      908    12983    2             THEN
      909    12984    3                 DO J = 0 TO P$ -> P$B.NSUBLKS - 1 ;
      910    12985
      911    12986    4                     DO CASE(P$ ->P$B.SUBLK$(J) -> P$B.CODE) ;
      912    12987
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:29   
      913    12988    4                         CASE(%CH_NOTACCT) ;
      914    12989    4                           Q_CRITERIA.NOTACCT# = %YES# ;
      915    12990
      916    12991    4                         CASE(%CH_DOT_ACCT) ;
      917    12992    4                           IF (P$->P$B.SUBLK$(J)->P$B.NSUBLKS = 0)
      918    12993    4                               THEN Q_CRITERIA.ACCT# = B$JIT$->B$JIT.ACCN ;
      919    12994    4                               ELSE Q_CRITERIA.ACCT# = P$->P$B.SUBLK$(J)
      920    12995    4                                       ->P$B.SUBLK$(0)->P$S.TEXT ;
      921    12996
      922    12997    4                         CASE(%CH_NOTTERM) ;
      923    12998    4                           Q_CRITERIA.NOTTNAME# = %YES# ;
      924    12999    4                           Q_CRITERIA.NOTWSN# = %YES# ;
      925    13000
      926    13001    4                         CASE(%CH_AT_TERM) ;
      927    13002    4                           IF (P$->P$B.SUBLK$(J)->P$B.NSUBLKS = 0)
      928    13003    4                               THEN Q_CRITERIA.WSN# = B$JIT$->B$JIT.WOO ;
      929    13004    4                               ELSE Q_CRITERIA.WSN# = P$->P$B.SUBLK$(J)
      930    13005    4                                       ->P$B.SUBLK$(0)->P$S.TEXT ;
      931    13006
      932    13007    4                         CASE(%CH_NOTWSN) ;
      933    13008    4                           Q_CRITERIA.NOTWSN# = %YES# ;
      934    13009
      935    13010    4                         CASE(%CH_AT_WSN) ;
      936    13011    4                           IF (P$->P$B.SUBLK$(J)->P$B.NSUBLKS = 0)
      937    13012    4                               THEN Q_CRITERIA.WSN# = B$JIT$->B$JIT.WOO ;
      938    13013    4                               ELSE Q_CRITERIA.WSN# = P$->P$B.SUBLK$(J)
      939    13014    4                                       ->P$B.SUBLK$(0)->P$S.TEXT ;
      940    13015
      941    13016    4                         CASE(%CH_NOTFORM) ;
      942    13017    4                           Q_CRITERIA.NOTFORM# = %YES# ;
      943    13018
      944    13019    4                         CASE(%CH_FORM) ;
      945    13020    4                           Q_CRITERIA.FORM# = P$->P$B.SUBLK$(J)->P$S.TEXT ;
      946    13021
      947    13022    4                         CASE(%CH_DEV) ;
      948    13023    4                           Q_CRITERIA.DEVTYP# = P$->P$B.SUBLK$(J)->P$S.TEXT ;
      949    13024
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:30   
      950    13025    4                         CASE(%CH_SHORT) ;
      951    13026
      952    13027    4                         CASE(%CH_USEFID) ;
      953    13028
      954    13029    4                         CASE(%CH_INPUT_ALL_OPT) ;
      955    13030    4                           CP_CHFLAGS.INPUT_OPT = %CH_INPUT_ALL_OPT ;
      956    13031
      957    13032    4                         CASE(%CH_INPUT_READY_OPT) ;
      958    13033    4                           CP_CHFLAGS.INPUT_OPT = %CH_INPUT_READY_OPT ;
      959    13034
      960    13035    4                         CASE(%CH_INPUT_HELD_OPT) ;
      961    13036    4                           CP_CHFLAGS.INPUT_OPT = %CH_INPUT_HELD_OPT ;
      962    13037
      963    13038    4                     END ; /* DO CASE */
      964    13039    3                 END ; /* DO J */
      965    13040
      966    13041                                                /* Set up FPTs. */
      967    13042    2   SETUP_Q_SRCH_JOBSTATS:  ENTRY ;
      968    13043    2         FPT_JOBSTATS = CFPT_JOBSTATS ;
      969    13044
      970    13045    2         FPT_JOBSTATS.V_ = VECTOR(FPT_JOBSTATS.V) ;
      971    13046    2         IF (CMD_CODE = %CH_OUTPUT)
      972    13047    2             THEN FPT_JOBSTATS.V.OUTPUT# = %YES# ;
      973    13048    2             ELSE FPT_JOBSTATS.V.OUTPUT# = %NO# ;
      974    13049    2         FPT_JOBSTATS.CRITERIA_ = VECTOR(Q_CRITERIA) ;
      975    13050    2         RES$ = SEG4$ ;
      976    13051    2         SN$ = PINCRW(RES$, 1024) ;
      977    13052    2         STAT$ = PINCRW(SN$, 1024) ;
      978    13053
      979    13054    2         FPT_JOBSTATS.RESULTS_ = RESULTS_;
      980    13055    2         FPT_JOBSTATS.RESLIST_ = VECTOR(RES$->B$$PAGE) ;
      981    13056    2         FPT_JOBSTATS.SNLIST_  = VECTOR(SN$->B$$PAGE) ;
      982    13057
      983    13058    2         RETURN ;
      984    13059
      985    13060    2   END   SETUP_Q_SRCH ;
      986    13061        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:31   
      987    13062    1   SETUP_SYSID_SRCH:   PROC ALTRET ;
      988    13063
      989    13064    2         IF USEFID_OPEN# = %NO#
      990    13065    2             THEN
      991    13066    2               CALL OPEN_USEFILE ALTRET(E_SETUP_SYSID_SRCH) ;
      992    13067                                                        /* Set up JOBSTATS fpt */
      993    13068    2         IF CMD_TYPE = %SUBMIT_CMD#
      994    13069    2           THEN
      995    13070    2             IF NSTATUS_FLG OR ( NOT(B$JIT.PRIV.AUTH & %PR_DISPJOB#) AND
      996    13071    2                                 CROSS_ACCT_BATCH_FLG)
      997    13072    2               THEN
      998    13073    3                 DO ;
      999    13074    3                   CALL SETUP_DUMMY_SUBMIT_MESS ;
     1000    13075    3                   CALL PRINT_SUBMIT_MESS ;
     1001    13076    3                   GOTO SETUP_SYSID_SRCH_RETURN ;
     1002    13077    3                 END ; /* Then Do */
     1003    13078    2         FPT_JOBSTATS = CFPT_JOBSTATS ;
     1004    13079    2         FPT_JOBSTATS.V_ = VECTOR(FPT_JOBSTATS.V) ;
     1005    13080    2         FPT_JOBSTATS.V.ORDER# = %SRCH# ;
     1006    13081    2         FPT_JOBSTATS.CRITERIA_ = VECTOR(SYSID_CRITERIA) ;
     1007    13082
     1008    13083    2         RES$ = SEG4$ ;
     1009    13084    2         SN$ = PINCRW(RES$, 1024) ;
     1010    13085    2         STAT$ = PINCRW(SN$, 1024) ;
     1011    13086
     1012    13087    2         FPT_JOBSTATS.RESULTS_ = RESULTS_;
     1013    13088    2         FPT_JOBSTATS.RESLIST_ = VECTOR(RES$->B$$PAGE) ;
     1014    13089    2         FPT_JOBSTATS.SNLIST_  = VECTOR(SN$->B$$PAGE) ;
     1015    13090
     1016    13091    2         SYSID_CRITERIA = CVLP_CRITERIA ;
     1017    13092                                                /* Setup range of jobstats search. */
     1018    13093    2         IF SYSTEM_OK# = %NO#
     1019    13094    2           THEN
     1020    13095    2             IF (B$JIT.PRIV.AUTH & %PR_DISPJOB#)
     1021    13096    2               THEN                                      /* SYSTEM ok */
     1022    13097    2                 CALL M$SPRIV(FPT_PRIV_DISPJOB) WHENRETURN
     1023    13098    3                       DO;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:32   
     1024    13099    3                         SYSTEM_OK# = %YES# ;
     1025    13100    3                         SYSID_CRITERIA.ACCT# = ' ';
     1026    13101    3                       END;  /* Whenreturn */
     1027    13102    3                       WHENALTRETURN DO;
     1028    13103    3                       END;
     1029    13104    2               ELSE
     1030    13105                                                              /* User's account only */
     1031    13106    2                 SYSID_CRITERIA.ACCT# = B$JIT$->B$JIT.ACCN;
     1032    13107    2           ELSE                                          /* SYSTEM already set. */
     1033    13108    2             SYSID_CRITERIA.ACCT# = ' ';
     1034    13109                                                              /* Get comment */
     1035    13110    2         IF CMD_CODE = %CH_NOOPTIONS    /* Set default COMMENT. */
     1036    13111    2             THEN
     1037    13112    2               CH_XFORMAT.COMMENT# = SYSIDBUF.COMMENT ;
     1038    13113    2             ELSE
     1039    13114    2               IF CMD_CODE = %CH_TERM_CMD
     1040    13115    2                 THEN
     1041    13116    2                   CH_XFORMAT.COMMENT# = 'This terminal''s output.' ;
     1042    13117    2                 ELSE
     1043    13118    2                   CH_XFORMAT.COMMENT# = ' ' ;
     1044    13119    2         VLP_JOBNAME.JOBNAME# = ' ' ;
     1045    13120    2         FPT_JOBSTATS.JOBNAME_ = VECTOR(NIL) ;
     1046    13121    2         FID_ACCT.ACCT# = B$JIT.ACCN ;
     1047    13122    2         DELUSEREC = '0'B;
     1048    13123
     1049    13124    3         DO CASE (CMD_CODE) ;
     1050    13125
     1051    13126    3             CASE(%CH_LAST,%CH_TERM_CMD,%CH_NOOPTIONS) ;
     1052    13127    3               SYSID_CRITERIA.SYSID# = TEMP ;
     1053    13128    3               SYSID_CRITERIA.SYSID1# = TEMP ;
     1054    13129
     1055    13130    3         END ; /* DO CASE */
     1056    13131
     1057    13132    2         IF CMD_CODE ~= %CH_NOOPTIONS
     1058    13133    2           THEN    /* Handle the options */
     1059    13134    3             DO;
     1060    13135    4               DO J=0 TO P$->P$B.NSUBLKS-1;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:33   
     1061    13136    5                 DO CASE(P$->P$B.SUBLK$(J)->P$B.CODE);
     1062    13137
     1063    13138    5                   CASE(%CH_SYSID) ;
     1064    13139                                                                    /* SYSID check. */
     1065    13140    5                     CALL CHARBIN(TEMP,P$->P$B.SUBLK$(J)->P$S.TEXTC$->TEXTC.TEXT);
     1066    13141    5                     SYSID_CRITERIA.SYSID# = TEMP ;
     1067    13142    5                     SYSID_CRITERIA.SYSID1# = TEMP ;
     1068    13143    5                     CHKEYBUF.SYSID = TEMP ;
     1069    13144    5                     CHKEYBUF.NUM = 0;
     1070    13145    5                     IF TEMP=0
     1071    13146    5                       THEN
     1072    13147    5                         GOTO CHECK_AWAITING_PRESCAN ;
     1073    13148
     1074    13149    5                   CASE(%CH_JOBNAME) ;
     1075    13150                                                              /* JOBNAME check */
     1076    13151    5                     VLP_JOBNAME.JOBNAME# = P$->P$B.SUBLK$(J)->P$S.TEXT;
     1077    13152    5                     CHKEYBUF.NUM = 0;
     1078    13153
     1079    13154    5                   CASE(%CH_ACCT);
     1080    13155    5                     FID_ACCT.ACCT# = P$->P$B.SUBLK$(J)->P$S.TEXT;
     1081    13156
     1082    13157    5                   CASE(%CH_COMMENT);
     1083    13158    5                     CH_XFORMAT.COMMENT# = P$->P$B.SUBLK$(J)->P$S.TEXT;
     1084    13159
     1085    13160    5                   CASE(%CH_YESOUTPUT);
     1086    13161    5                     FPT_JOBSTATS_CANCEL.V.OUTPUT# = %NO#;
     1087    13162
     1088    13163    5                   CASE(%CH_DELUSEREC);
     1089    13164    5                     DELUSEREC = '1'B;
     1090    13165
     1091    13166    5                   CASE(%CH_SYSID_NUM);
     1092    13167    5                     CALL CHARBIN(P$->P$B.SUBLK$(J)->P$B.CPOS,
     1093    13168    5                       P$->P$B.SUBLK$(J)->P$S.TEXT);
     1094    13169    5                     FPT_JOBSTATS.V.NUM# = 1; /* Set a flag */
     1095    13170
     1096    13171    5                 END ; /* DO CASE */
     1097    13172    4               END; /* Do J */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:34   
     1098    13173    3               IF VLP_JOBNAME.JOBNAME# ~= ' '
     1099    13174    3                 THEN
     1100    13175    4                   DO;
     1101    13176    4                     IF JOBSTATS_OPEN# = %NO#
     1102    13177    4                       THEN
     1103    13178    4                         CALL OPEN_JOBSTATS_FILE ALTRET(E_SETUP_SYSID_SRCH) ;
     1104    13179    4                     CALL GET_JOBNAME_SYSID_REC ALTRET(E_SETUP_SYSID_SRCH) ;
     1105    13180    4                     IF (NOT SYSTEM_OK# AND B$JIT.ACCN ~= FID_ACCT.ACCT#) OR TEMP=0
     1106    13181    4                       THEN
     1107    13182                                                          /*
     1108    13183                                                            This guy is asking about someone
     1109    13184                                                            else's Job, and he does not
     1110    13185                                                            have the tools to look at it.
     1111    13186                                                            Don't let him see the SYSID.
     1112    13187                                                          */
     1113    13188    5                         DO ;                        /* No such JOBNAME exists */
     1114    13189    5                           TEMP = 0 ;
     1115    13190    5                           CH_XFORMAT.MSG# = %CP_NOTF_MESS ;
     1116    13191    5                           CH_XFORMAT.SYSID# = TEMP;
     1117    13192    5                           CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME# ;
     1118    13193    5                           CH_XFORMAT.ACCT# = FID_ACCT.ACCT# ;
     1119    13194    5                           CH_XFORMAT.NUM# = CHKEYBUF.NUM;
     1120    13195    5                           CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1121    13196    5                           RETURN ;
     1122    13197    5                         END ; /* THEN DO */
     1123    13198    4                     SYSID_CRITERIA.SYSID# = TEMP ;
     1124    13199    4                     SYSID_CRITERIA.SYSID1# = TEMP ;
     1125    13200    4                     CHKEYBUF.SYSID = TEMP ;
     1126    13201    4                   END;  /* Then Do */
     1127    13202    3               END;  /* Then Do */
     1128    13203    2         ELSE
     1129    13204    2            FPT_JOBSTATS.V.NUM# = CHKEYBUF.NUM;
     1130    13205
     1131    13206    2         OUTPUT_FLG = %NO# ;
     1132    13207    2         JOB_COMPLETED = %NO# ;
     1133    13208    2         IF FPT_JOBSTATS.V.NUM# ~= 0
     1134    13209    2             THEN  /* Asking for a specific output file */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:35   
     1135    13210    3               DO;
     1136    13211    3                 CALL DISP_SYSID_SUBFILE ALTRET(SETUP_SYSID_SRCH_RETURN);
     1137    13212    3                 GOTO SETUP_SYSID_SRCH_RETURN;
     1138    13213    3               END;  /* Then Do */
     1139    13214    2         IF (NOTIFYING OR (WAITING AND NOT FORCE)) AND CHKEYBUF.NUM > 0
     1140    13215    2             THEN GOTO CHECK_AWAITING_PRESCAN ;
     1141    13216    2         IF SYSID_CRITERIA.SYSID# = 0
     1142    13217    2           THEN
     1143    13218    3             DO;  /* Presumably, a request for all jobs in an account */
     1144    13219    3               SYSID_CRITERIA.ACCT# = FID_ACCT.ACCT#;
     1145    13220    3               CALL GET_JOBSTATS;
     1146    13221    3               FPT_JOBSTATS.V.OUTPUT# = '1'B;
     1147    13222    3               SN$ = PINCRW(RES$,1024);
     1148    13223    3               STAT$ = PINCRW(SN$,1024);
     1149    13224    3               FPT_JOBSTATS.RESLIST_ = VECTOR(RES$->B$$PAGE);
     1150    13225    3               FPT_JOBSTATS.SNLIST_ = VECTOR(SN$->B$$PAGE);
     1151    13226    3               FPT_JOBSTATS.RESULTS_ = RESULTS_;
     1152    13227    3               IF NOT B$JIT.CPFLAGS1.BRK
     1153    13228    3                 THEN
     1154    13229    3                   CALL GET_JOBSTATS;
     1155    13230    3               RETURN;
     1156    13231    3             END;
     1157    13232
     1158    13233    2         CALL COMPARE_STATUS ALTRET(NO_CHANGE) ;   /* Check if status changed. */
     1159    13234    2         SOMETHING_CHANGED = '1'B ;
     1160    13235    3         DO WHILE('0'B) ;
     1161    13236    3   NO_CHANGE:
     1162    13237    3             IF (NOT FORCE AND WAITING) OR NOTIFYING
     1163    13238    3               THEN GOTO GET_OUTPUT_SYSIDS ;
     1164    13239    3         END ; /* DO WHILE */
     1165    13240
     1166    13241    2   GET_INPUT_JOBSTATS:
     1167    13242                                                        /* Get Job Stats. */
     1168    13243    2         CALL M$JOBSTATS(FPT_JOBSTATS) ALTRET(NONE_THERE) ;
     1169    13244                                                              /* Output the one found. */
     1170    13245    2         IF SYSIDBUF.STATUS.CODE = %JS_PRT#
     1171    13246    2             THEN GOTO GET_OUTPUT_SYSIDS ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:36   
     1172    13247    2         CALL DISP_SYSID_SRCH_IRQ ;
     1173    13248
     1174    13249    3         DO WHILE ('0'B) ;
     1175    13250    3   NONE_THERE:
     1176    13251    3             SOMETHING_CHANGED = '0'B ;
     1177    13252    3             IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOTFND
     1178    13253    3               THEN
     1179    13254    4                 DO ;
     1180    13255    4                   CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR) ;
     1181    13256    4                   ALTRETURN ;
     1182    13257    4                 END ; /* THEN DO */
     1183    13258    3   CHECK_AWAITING_PRESCAN:                   /* Check to see if awaiting PRESCAN. */
     1184    13259    3             FPT_JOBSTATS.V.ORDER# = %CHECK# ;
     1185    13260    3             FPT_JOBSTATS.RESULTS_ = VECTOR(VLR_JOBSTATS_CHECK) ;
     1186    13261    3             FPT_JOBSTATS.V.SYSID# = SYSID_CRITERIA.SYSID#;
     1187    13262    3             CALL M$JOBSTATS(FPT_JOBSTATS) ALTRET(E_NOT_AWAITING_PRESCAN) ;
     1188    13263    3             IF VLR_JOBSTATS_CHECK.CODE = %JS_NOTF#
     1189    13264    3               THEN
     1190    13265    4                 DO ;
     1191    13266    4                   JOB_COMPLETED = %YES# ;
     1192    13267    4                   CALL READ_JOBSTATS_FILE ALTRET(E_SETUP_SYSID_SRCH) ;
     1193    13268    4                   SOMETHING_CHANGED = %YES# ;
     1194    13269    4                   GOTO SETUP_SYSID_SRCH_RETURN ;
     1195    13270    4                 END ; /* THEN DO */
     1196    13271    3             IF VLR_JOBSTATS_CHECK.CODE = %JS_AP#
     1197    13272    3               THEN
     1198    13273    4                 DO ;
     1199    13274    4                   CALL PRINT_SUBMIT_MESS ;
     1200    13275    4                   RETURN ;
     1201    13276    4                 END ; /* THEN DO */
     1202    13277    3   E_NOT_AWAITING_PRESCAN:
     1203    13278    3             FPT_JOBSTATS.V.ORDER# = %SRCH# ;
     1204    13279    3             FPT_JOBSTATS.RESULTS_ = RESULTS_;
     1205    13280    3             IF VLR_JOBSTATS_CHECK.CODE = %JS_WAIT# OR
     1206    13281    3                 VLR_JOBSTATS_CHECK.CODE = %JS_RUN#
     1207    13282    3               THEN
     1208    13283    3                 GOTO GET_INPUT_JOBSTATS ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:37   
     1209    13284    3         END ; /* DO WHILE */
     1210    13285                                                /* Setup Output Que search. */
     1211    13286    2   GET_OUTPUT_SYSIDS:
     1212    13287    2         FPT_JOBSTATS.V.OUTPUT# = %YES# ;
     1213    13288    2         CALL M$JOBSTATS(FPT_JOBSTATS) ALTRET(SETUP_SYSID_SRCH_RETURN) ;
     1214    13289    2         CALL DISP_SYSID_SRCH_OQ ALTRET(E_SETUP_SYSID_SRCH) ;
     1215    13290
     1216    13291    2   SETUP_SYSID_SRCH_RETURN:
     1217    13292
     1218    13293
     1219    13294    2         RETURN ;
     1220    13295
     1221    13296    2   E_SETUP_SYSID_SRCH:
     1222    13297    2         ALTRETURN ;
     1223    13298    2   END   SETUP_SYSID_SRCH ;
     1224    13299        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:38   
     1225    13300    1   CHECK_WAIT: PROC ;
     1226    13301
     1227    13302    2         WAIT_DONE = '1'B ;
     1228    13303    2         WAIT_BELL = '0'B ;
     1229    13304    2         WAIT_INT = 15 ;
     1230    13305    3         DO K = 0 TO P$ -> P$B.NSUBLKS - 1 ;
     1231    13306
     1232    13307    4           DO CASE(P$->P$B.SUBLK$(K)->P$B.CODE) ;
     1233    13308
     1234    13309    4             CASE(%CH_WAIT_DONE) ;
     1235    13310    4               WAIT_DONE = '1'B ;
     1236    13311
     1237    13312    4             CASE(%CH_WAIT_PRINT) ;
     1238    13313    4               WAIT_DONE = '0'B ;
     1239    13314    4             CASE(%CH_WAIT_BELL) ;
     1240    13315    4               WAIT_BELL = '1'B ;
     1241    13316
     1242    13317    4             CASE(%CH_INTERVAL) ;
     1243    13318    4               CALL CHARBIN(WAIT_INT,P$->P$B.SUBLK$(K) -> P$S.TEXT) ;
     1244    13319
     1245    13320    4           END ; /* DO CASE */
     1246    13321    3         END ; /* DO K */
     1247    13322
     1248    13323    2         IF CMD_TYPE = %NOTIFY_CMD#
     1249    13324    2             THEN
     1250    13325    3               DO ;                                           /* Called by NOTIFY. */
     1251    13326    3                 CP_CHFLAGS.WAIT_DONE = WAIT_DONE ;
     1252    13327    3                 CP_CHFLAGS.WAIT_INT = WAIT_INT ;
     1253    13328    3                 CP_CHFLAGS.FLG = %NO# ;
     1254    13329    3                 CP_CHFLAGS.FLG.WAIT = %YES# ;
     1255    13330    3                 RETURN ;
     1256    13331    3               END ; /* THEN DO */
     1257    13332
     1258    13333    2         GOTO PAST_NOTIFY_WAIT ;
     1259    13334
     1260    13335    2   NOTIFY_WAIT:  ENTRY ;
     1261    13336
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:39   
     1262    13337    2         WAIT_DONE = CP_CHFLAGS.WAIT_DONE ;
     1263    13338    2         WAIT_INT = CP_CHFLAGS.WAIT_INT ;
     1264    13339
     1265    13340    2   PAST_NOTIFY_WAIT:
     1266    13341
     1267    13342    2         FORCE = '1'B ;
     1268    13343    2         FPT_TIME = CFPT_TIME ;
     1269    13344    2         FPT_TIME.V_ = VECTOR(FPT_TIME.V) ;
     1270    13345    2         FPT_TIME.TSTAMP_ = VECTOR(TEMP3) ;
     1271    13346    2         FPT_WAIT = CFPT_WAIT ;
     1272    13347    2         FPT_WAIT.V_ = VECTOR(FPT_WAIT.V) ;
     1273    13348    2         FPT_WAIT.V.UNITS# = WAIT_INT ;
     1274    13349    2         WAITING = '1'B ;
     1275    13350    3         DO WHILE('1'B) ;
     1276    13351    3           MORE_2_WAIT = '0'B ;
     1277    13352    3           SOMETHING_CHANGED = '0'B ;
     1278    13353    3           IF B$JIT.CPFLAGS1.BRK OR B$JIT.JUNK2 & %JJ2_DFRBRK#
     1279    13354    3             THEN
     1280    13355    4               DO ;                                      /* BREAK detected. */
     1281    13356    4                 B$JIT.CPFLAGS1.BRK = '0'B;
     1282    13357    4                 IF B$JIT.JUNK2 & %JJ2_DFRBRK#
     1283    13358    4                 THEN B$JIT.JUNK2 = B$JIT.JUNK2 & ~%JJ2_DFRBRK#;
     1284    13359    4                 ELSE IF B$TCB$ -> B$TCB.STK$ -> B$NWIO.SUBC = %SC_BYC#
     1285    13360    4                   THEN GOTO WAIT_DONE ;                 /* Get me out. */
     1286    13361    4                 CALL M$TRMPRG( CFPT_TRMPRG ) ALTRET(TRMPRG_ERR) ;
     1287    13362    4   TRMPRG_ERR:
     1288    13363    4                 FORCE = '1'B ;
     1289    13364    4                 CALL CHECK_SYSIDS ALTRET(WAIT_DONE) ;
     1290    13365    4               END ; /* THEN DO */
     1291    13366    3             ELSE
     1292    13367    4               DO ;
     1293    13368    4                 CALL CHECK_SYSIDS ALTRET(WAIT_DONE) ;
     1294    13369    4               END ; /* ELSE DO */
     1295    13370    3           IF MORE_2_WAIT = %NO# AND WAIT_DONE = %NO#
     1296    13371    3             THEN GOTO WAIT_DONE ;
     1297    13372    3           IF SOMETHING_CHANGED OR FORCE
     1298    13373    3             THEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:40   
     1299    13374    4               DO ;
     1300    13375    4                 IF FORCE OR NOT WAIT_BELL
     1301    13376    4                   THEN
     1302    13377    4                     CH_XFORMAT.MSG# = %CP_TIME_DI_MESS ;
     1303    13378    4                   ELSE
     1304    13379    4                     CH_XFORMAT.MSG# = %CP_TIME_DI_W_BELL_MESS ;
     1305    13380    4                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1306    13381    4               END ; /* THEN DO */
     1307    13382    3           FORCE = '0'B ;
     1308    13383    3           IF NOT SOMETHING_CHANGED
     1309    13384    3             THEN
     1310    13385    3               CALL M$WAIT(FPT_WAIT) ;
     1311    13386    3         END ; /* DO WHILE */
     1312    13387    2   WAIT_DONE:
     1313    13388    2         WAITING = %NO# ;
     1314    13389    2         IF SOMETHING_CHANGED
     1315    13390    2             THEN
     1316    13391    3               DO ;
     1317    13392    3                 IF WAIT_BELL
     1318    13393    3                   THEN
     1319    13394    3                     CH_XFORMAT.MSG# = %CP_TIME_DI_W_BELL_MESS ;
     1320    13395    3                   ELSE
     1321    13396    3                     CH_XFORMAT.MSG# = %CP_TIME_DI_MESS ;
     1322    13397    3                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1323    13398    3               END ; /* THEN DO */
     1324    13399
     1325    13400    2         RETURN ;
     1326    13401    2   END   CHECK_WAIT ;
     1327    13402        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:41   
     1328    13403    1   DISP_INPUT:   PROC ;
     1329    13404
     1330    13405    2   DCL MSG# UBIN WORD ;
     1331    13406    2   DCL HDR_MSG# UBIN WORD ;
     1332    13407
     1333    13408    2         J = 0 ;
     1334    13409    2         NUM_LISTED = 0 ;
     1335    13410    2         CALL SETUP_HDR_CNT_SZ ;
     1336    13411    2         HDR_CNT = HDR_CNT_SZ ;
     1337    13412    2         HELD_LINE_NOT_PRINTED = %YES# ;
     1338    13413    2         IF CMD_CODE = %CH_RUN OR CMD_CODE = %CH_JOB
     1339    13414    2             THEN
     1340    13415    3               DO ;
     1341    13416    3                 MSG# = %CP_RUN_MESS ;
     1342    13417    3                 HDR_MSG# = %CP_RUN_HDR ;
     1343    13418    3                 GOTO FOUND_FIRST_TO_PRINT ;
     1344    13419    3               END ; /* THEN DO */
     1345    13420    2         MSG# = %CP_INPUT_MESS ;
     1346    13421    2         HDR_MSG# = %CP_INPUT_HDR ;
     1347    13422
     1348    13423    3         DO J = 0 TO STAT$ -> VLR$INPUT.FOUND - 1 ;
     1349    13424
     1350    13425    3             BUF$ = ADDR(STAT$ -> VLR$INPUT.J(J)) ;
     1351    13426    3             IF (BUF$ -> VLA$INPUT.PRIO ~= %JP_RUN#) THEN GOTO FOUND_FIRST_TO_PRINT ;
     1352    13427    3         END ; /* DO J */
     1353    13428
     1354    13429    2   FOUND_FIRST_TO_PRINT:
     1355    13430
     1356    13431    3         DO K = J TO STAT$ -> VLR$INPUT.FOUND - 1 ;
     1357    13432    3             IF B$JIT.CPFLAGS1.BRK
     1358    13433    3               THEN GOTO DONE_LISTING_INPUT ;            /* Forget the rest. */
     1359    13434    3             BUF$ = ADDR(STAT$ -> VLR$INPUT.J(K)) ;
     1360    13435
     1361    13436    4             DO CASE(CMD_CODE) ;
     1362    13437
     1363    13438    4               CASE( %CH_RUN, %CH_JOB) ;
     1364    13439    4                 IF BUF$->VLA$INPUT.PRIO ~= %JP_RUN#
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:42   
     1365    13440    4                   THEN
     1366    13441    4                     GOTO DONE_LISTING_INPUT ;
     1367    13442
     1368    13443    4               CASE(%CH_INPUT) ;
     1369    13444    5                 DO CASE(CP_CHFLAGS.INPUT_OPT) ;
     1370    13445
     1371    13446    5                   CASE(%CH_INPUT_ALL_OPT) ;
     1372    13447
     1373    13448    5                   CASE(%CH_INPUT_READY_OPT) ;
     1374    13449    5                     IF BUF$->VLA$INPUT.PRIO > %JP_RUN#
     1375    13450    5                       THEN
     1376    13451    5                         GOTO DONE_LISTING_INPUT ;
     1377    13452
     1378    13453    5                   CASE(%CH_INPUT_HELD_OPT) ;
     1379    13454    5                     IF HELD_LINE_NOT_PRINTED
     1380    13455    5                       THEN
     1381    13456    5                         HELD_LINE_NOT_PRINTED = %NO# ;
     1382    13457    5                     IF BUF$->VLA$INPUT.PRIO < %JP_RUN#
     1383    13458    5                       THEN
     1384    13459    5                         GOTO DO_NEXT_K ;
     1385    13460
     1386    13461    5                 END ;
     1387    13462    4             END ; /* Do Case */
     1388    13463
     1389    13464    3             IF BUF$->VLA$INPUT.PRIO > %JP_RUN# AND HELD_LINE_NOT_PRINTED
     1390    13465    3               THEN
     1391    13466    4                 DO ;
     1392    13467    4                   CH_XFORMAT.MSG# = %CP_HELD_LINE ;
     1393    13468    4                   CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;
     1394    13469    4                   HDR_CNT = HDR_CNT + NLINES ;
     1395    13470    4                   HELD_LINE_NOT_PRINTED = %NO# ;
     1396    13471    4                 END ; /* Then Do */
     1397    13472
     1398    13473    3             IF HDR_CNT >= HDR_CNT_SZ
     1399    13474    3               THEN
     1400    13475    4                 DO ;
     1401    13476    4                   CH_XFORMAT.MSG# = HDR_MSG#;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:43   
     1402    13477    4                   CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;
     1403    13478    4                   HDR_CNT = NLINES ;
     1404    13479    4                 END ; /* THEN DO */
     1405    13480
     1406    13481    3             CH_XFORMAT.BUF$ = BUF$ ;
     1407    13482
     1408    13483    3             CH_XFORMAT.MSG# = MSG#;
     1409    13484    3             CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;
     1410    13485    3             NUM_LISTED = NUM_LISTED + 1 ;
     1411    13486    3             HDR_CNT = HDR_CNT + NLINES ;
     1412    13487
     1413    13488    3   DO_NEXT_K:
     1414    13489    3         END ;   /* DO WHILE */
     1415    13490
     1416    13491    2   DONE_LISTING_INPUT:
     1417    13492
     1418    13493    2         IF (NUM_LISTED = 0) AND NOT NOTIFYING
     1419    13494    2             THEN
     1420    13495    3               DO ;
     1421    13496    3                 IF CMD_CODE = %CH_INPUT
     1422    13497    3                   THEN CH_XFORMAT.MSG# = %CP_NONE_IN_MESS ;
     1423    13498    3                   ELSE CH_XFORMAT.MSG# = %CP_NONE_RUN_MESS ;
     1424    13499    3                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1425    13500    3                 RETURN ;
     1426    13501    3               END ; /* THEN DO */
     1427    13502    2         IF NUM_LISTED = 1
     1428    13503    2             THEN GOTO DONT_PRINT_NUM_LISTED ;
     1429    13504    2         CH_XFORMAT.NUM# = NUM_LISTED ;
     1430    13505    2         CH_XFORMAT.MSG# = %CP_NUM_LISTED ;
     1431    13506    2         CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1432    13507
     1433    13508    2   DONT_PRINT_NUM_LISTED:
     1434    13509
     1435    13510    2         RETURN ;
     1436    13511
     1437    13512    2   END   DISP_INPUT ;
     1438    13513        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:44   
     1439    13514    1   DISP_OUTPUT:   PROC ;
     1440    13515
     1441    13516    2         CALL SETUP_HDR_CNT_SZ ;
     1442    13517    2         HDR_CNT = HDR_CNT_SZ ;
     1443    13518    2         CH_XFORMAT.NUM# = 0 ;                           /* Remember number ahead. */
     1444    13519
     1445    13520    3         DO J = 0 TO STAT$ -> VLR$OUTPUT.FOUND - 1 ;
     1446    13521    3             IF B$JIT.CPFLAGS1.BRK
     1447    13522    3               THEN GOTO DONE_LISTING_OUTPUT ;           /* Forget the rest. */
     1448    13523    3             IF HDR_CNT >= HDR_CNT_SZ
     1449    13524    3               THEN
     1450    13525    4                 DO ;
     1451    13526    4                   CH_XFORMAT.MSG# = %CP_DFLT_OUTPUT_HDR ;
     1452    13527    4                   CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;
     1453    13528    4                   CH_XFORMAT.MSG# = %CP_OUTPUT_MESS ;
     1454    13529    4                   HDR_CNT = NLINES ;
     1455    13530    4                 END ; /* Then Do */
     1456    13531    3             CH_XFORMAT.BUF$ = ADDR(STAT$ -> VLR$OUTPUT.F(J)) ;
     1457    13532
     1458    13533    3             CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;
     1459    13534    3             HDR_CNT = HDR_CNT + NLINES ;
     1460    13535
     1461    13536    3         END ;   /* DO WHILE */
     1462    13537
     1463    13538    2   DONE_LISTING_OUTPUT:
     1464    13539
     1465    13540    2         IF J = 1
     1466    13541    2             THEN GOTO DONT_PRINT_NUM_LISTED ;
     1467    13542    2         CH_XFORMAT.NUM# = J ;
     1468    13543    2         CH_XFORMAT.MSG# = %CP_NUM_LISTED ;
     1469    13544    2         CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1470    13545
     1471    13546    2   DONT_PRINT_NUM_LISTED:
     1472    13547
     1473    13548    2         RETURN ;
     1474    13549
     1475    13550    2   END   DISP_OUTPUT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:45   
     1476    13551        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:46   
     1477    13552    1   DISP_SYSID_SRCH_IRQ:    PROC ;
     1478    13553
     1479    13554    3         DO J = 0 TO STAT$ -> VLR$INPUT.FOUND - 1 ;
     1480    13555
     1481    13556    3             IF B$JIT.CPFLAGS1.BRK
     1482    13557    3               THEN RETURN ;                             /* Forget the rest. */
     1483    13558    3             CH_XFORMAT.BUF$ = ADDR(STAT$ -> VLR$INPUT.J(J)) ;
     1484    13559
     1485    13560    4             DO CASE(CH_XFORMAT.BUF$ -> VLA$INPUT.PRIO) ;
     1486    13561
     1487    13562    4               CASE(%JP_RUN#) ;
     1488    13563    4                 CH_XFORMAT.MSG# = %CP_SYSID_RUN_MESS ;
     1489    13564
     1490    13565    4               CASE(%JP_FOLL#) ;
     1491    13566    4                 CH_XFORMAT.MSG# = %CP_SYSID_FOLL_MESS ;
     1492    13567
     1493    13568    4               CASE(%JP_RUNAFTER#) ;
     1494    13569    4                 CH_XFORMAT.MSG# = %CP_SYSID_RUNAFTER_MESS ;
     1495    13570
     1496    13571    4               CASE(%JP_WPART#) ;
     1497    13572    4                 CH_XFORMAT.MSG# = %CP_SYSID_WPART_MESS ;
     1498    13573
     1499    13574    4               CASE(%JP_OTHER#) ;
     1500    13575    4                 CH_XFORMAT.MSG# = %CP_SYSID_OTHER_MESS ;
     1501    13576
     1502    13577    4               CASE(%JP_WPS#) ;
     1503    13578    4                 CH_XFORMAT.MSG# = %CP_SYSID_WPS_MESS ;
     1504    13579
     1505    13580    4               CASE(ELSE) ;
     1506    13581    4                 CH_XFORMAT.MSG# = %CP_SYSID_WAIT_MESS ;
     1507    13582
     1508    13583    4             END ; /* DO CASE */
     1509    13584
     1510    13585    3             IF CMD_TYPE = %CANCEL_CMD#
     1511    13586    3               THEN
     1512    13587    4                 DO;
     1513    13588    4                   IF CH_XFORMAT.BUF$ -> VLA$INPUT.PRIO = %JP_RUN#
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:47   
     1514    13589    4                     THEN
     1515    13590    5                       DO;
     1516    13591    5                         IF CMD_CODE = %CH_INPUT
     1517    13592    5                           THEN
     1518    13593    5                             GOTO E_WRITE_CHECK;
     1519    13594    5                       END;
     1520    13595    4                     ELSE
     1521    13596    4                       IF CH_XFORMAT.BUF$ -> VLA$INPUT.PRIO > %JP_RUN#
     1522    13597    4                         THEN
     1523    13598    5                           DO;
     1524    13599    5                             IF CMD_CODE = %CH_JOB OR CMD_CODE = %CH_RUN
     1525    13600    5                               OR CMD_CODE = %CH_INPUT
     1526    13601    5                               AND CP_CHFLAGS.INPUT_OPT ~= %CH_INPUT_ALL_OPT
     1527    13602    5                               AND CP_CHFLAGS.INPUT_OPT ~= %CH_INPUT_HELD_OPT
     1528    13603    5                               THEN
     1529    13604    5                                 GOTO E_WRITE_CHECK;
     1530    13605    5                           END;
     1531    13606    4                         ELSE  /* PRIO < RUN */
     1532    13607    4                           IF CMD_CODE = %CH_JOB OR CMD_CODE = %CH_RUN
     1533    13608    4                             OR CMD_CODE = %CH_INPUT
     1534    13609    4                             AND CP_CHFLAGS.INPUT_OPT = %CH_INPUT_HELD_OPT
     1535    13610    4                             THEN
     1536    13611    4                               GOTO E_WRITE_CHECK;
     1537    13612    4                   FPT_JOBSTATS_CANCEL.V.SYSID# = CH_XFORMAT.BUF$->VLA$INPUT.SYSID;
     1538    13613    4                   FPT_JOBSTATS_CANCEL.V.ORDER# = %CANCEL#;
     1539    13614    4                   CH_XFORMAT.COMMENT# = '> Canceled <';
     1540    13615    4                   IF NOT FPT_JOBSTATS_CANCEL.V.OUTPUT#
     1541    13616    4                     THEN
     1542    13617    4                       CH_XFORMAT.COMMENT# = '> Aborted <';
     1543    13618    5                   CALL M$JOBSTATS (FPT_JOBSTATS_CANCEL) WHENALTRETURN DO;
     1544    13619    5                       CALL CPC$WRITEMSGE(B$TCB$->B$TCB.ALT$->B$ALT.ERR,,,,,%YES#);
     1545    13620    5                       CH_XFORMAT.COMMENT# = '> Not Canceled <';
     1546    13621    5                     END;
     1547    13622    4                 END;
     1548    13623
     1549    13624    3             CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1550    13625                                                              /* Save SYSID */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:48   
     1551    13626    3             CHKEYBUF = CP_C_CHKEYBUF ;
     1552    13627                                                              /* Setup key */
     1553    13628    3             CHKEYBUF.SYSID = CH_XFORMAT.BUF$ -> VLA$INPUT.SYSID ;
     1554    13629    3             CHKEYBUF.NUM = 0 ;
     1555    13630    3             SYSIDBUF.ACCT = CH_XFORMAT.BUF$ -> VLA$INPUT.ACCT ;
     1556    13631    3             SYSIDBUF.JNAME = CH_XFORMAT.BUF$ -> VLA$INPUT.JNAME ;
     1557    13632    3             SYSIDBUF.COMMENT = CH_XFORMAT.COMMENT# ;
     1558    13633                                                              /* Write out record. */
     1559    13634    3             CALL WRITE_USEFILE_REC ALTRET(E_WRITE_CHECK) ;
     1560    13635    3   E_WRITE_CHECK:
     1561    13636
     1562    13637    3         END ; /* DO J */
     1563    13638    2         RETURN ;
     1564    13639
     1565    13640    2   END   DISP_SYSID_SRCH_IRQ ;
     1566    13641        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:49   
     1567    13642    1   DISP_SYSID_SRCH_OQ:    PROC ALTRET ;
     1568    13643
     1569    13644    2         CH_XFORMAT.MSG# = %CP_SYSID_OQ_MESS ;
     1570    13645    2         CH_XFORMAT.NUM# = 0 ;
     1571    13646    3         DO J = 0 TO STAT$ -> VLR$OUTPUT.FOUND - 1 ;
     1572    13647
     1573    13648    3             IF B$JIT.CPFLAGS1.BRK
     1574    13649    3               THEN RETURN ;                             /* Forget the rest. */
     1575    13650    3             CH_XFORMAT.BUF$ = ADDR(STAT$ -> VLR$OUTPUT.F(J)) ;
     1576    13651    3             IF CH_XFORMAT.BUF$ -> VLA$OUTPUT.NUM ~= CHKEYBUF.NUM
     1577    13652    3               THEN                                /* Not the correct stream number. */
     1578    13653    4                 DO ;                                    /* Get correct record. */
     1579    13654    4                   CHKEYBUF = CP_C_CHKEYBUF ;
     1580    13655    4                   CHKEYBUF.SYSID = CH_XFORMAT.BUF$ -> VLA$OUTPUT.SYSID ;
     1581    13656    4                   CHKEYBUF.NUM = CH_XFORMAT.BUF$ -> VLA$OUTPUT.NUM ;
     1582    13657    4                   IF WAITING OR NOTIFYING
     1583    13658    4                     THEN
     1584    13659    4                       CALL READ_OUTPUT_RECORD(CHKEYBUF)
     1585    13660    4                                   ALTRET(E_DISP_SYSID_SRCH_OQ) ;
     1586    13661    4                 END ; /* THEN DO */
     1587    13662    3             OUTPUT_FLG = %YES# ;
     1588    13663    3             CALL COMPARE_STATUS ALTRET(OUTPUT_NO_CHANGE) ;
     1589    13664    3             IF SYSIDBUF.STATUS.CODE = %FS_NOTF#
     1590    13665    3               THEN
     1591    13666    3                 GOTO E_WRITE_CHECK ;
     1592    13667
     1593    13668    3             SOMETHING_CHANGED = '1'B ;
     1594    13669    4             DO WHILE('0'B) ;
     1595    13670    4   OUTPUT_NO_CHANGE:
     1596    13671    4               IF (FORCE = %NO# AND WAITING) OR NOTIFYING
     1597    13672    4                 THEN GOTO E_WRITE_CHECK ;
     1598    13673    4             END ; /* DO WHILE */
     1599    13674    3             CALL READ_JOBSTATS_FILE ALTRET(E_DISP_SYSID_SRCH_OQ) ;
     1600    13675    3             CALL DISP_ONE_OUTPUT;
     1601    13676    3   E_WRITE_CHECK:
     1602    13677
     1603    13678    3         END ; /* DO J */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:50   
     1604    13679    2         RETURN ;
     1605    13680
     1606    13681    2   E_DISP_SYSID_SRCH_OQ:
     1607    13682    2          ALTRETURN ;
     1608    13683
     1609    13684    2   END   DISP_SYSID_SRCH_OQ ;
     1610    13685        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:51   
     1611    13686    1   DISP_ONE_OUTPUT: PROC;
     1612    13687
     1613    13688    2          CH_XFORMAT.STAT$ = ADDR(XSJ_JOBINFO) ;
     1614    13689
     1615    13690    2          IF CMD_TYPE = %CANCEL_CMD#
     1616    13691    2            THEN
     1617    13692    3              DO;
     1618    13693    3                IF NOT FPT_JOBSTATS_CANCEL.V.OUTPUT#
     1619    13694    3                  THEN
     1620    13695    3                    GOTO NO_CANCEL;
     1621    13696    3                FPT_JOBSTATS_CANCEL.V.SYSID# = CH_XFORMAT.BUF$->VLA$OUTPUT.SYSID;
     1622    13697    3                FPT_JOBSTATS_CANCEL.V.NUM# = CH_XFORMAT.BUF$->VLA$OUTPUT.NUM;
     1623    13698    3                FPT_JOBSTATS_CANCEL.V.ORDER# = %CANCELF#;
     1624    13699    3                CH_XFORMAT.COMMENT# = '> Canceled <';
     1625    13700    4                CALL M$JOBSTATS(FPT_JOBSTATS_CANCEL) WHENALTRETURN DO;
     1626    13701    4                    CALL CPC$WRITEMSGE(B$TCB$->B$TCB.ALT$->B$ALT.ERR,,,,,%YES#);
     1627    13702    4   NO_CANCEL:       CH_XFORMAT.COMMENT# = '> Not Canceled <';
     1628    13703    4                  END;
     1629    13704    3              END;
     1630    13705    2          CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1631    13706                                                                        /* Save SYSID */
     1632    13707    2          CHKEYBUF = CP_C_CHKEYBUF ;
     1633    13708                                                                        /* Setup key */
     1634    13709    2          CHKEYBUF.SYSID = CH_XFORMAT.BUF$ -> VLA$OUTPUT.SYSID ;
     1635    13710    2          CHKEYBUF.SYSID = CH_XFORMAT.BUF$ -> VLA$OUTPUT.SYSID ;
     1636    13711    2          CHKEYBUF.NUM = CH_XFORMAT.BUF$ -> VLA$OUTPUT.NUM ;
     1637    13712    2          SYSIDBUF.ACCT = CH_XFORMAT.BUF$ -> VLA$OUTPUT.ACCT ;
     1638    13713    2          SYSIDBUF.JNAME = CH_XFORMAT.BUF$ -> VLA$OUTPUT.JNAME ;
     1639    13714    2          SYSIDBUF.COMMENT = CH_XFORMAT.COMMENT# ;
     1640    13715                                                                 /* Write out record. */
     1641    13716    2          CALL WRITE_USEFILE_REC ALTRET(E_WRITE_CHECK) ;
     1642    13717    2   E_WRITE_CHECK:
     1643    13718    2          RETURN;
     1644    13719    2   END DISP_ONE_OUTPUT;
     1645    13720        %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:52   
     1646    13721    1   DISP_SYSID_SUBFILE:    PROC ALTRET ;
     1647    13722
     1648    13723    2   DCL NOT_FND BIT(1);
     1649    13724
     1650    13725    2         FPT_JOBSTATS.V.ORDER# = %SRCH#;
     1651    13726    2         FPT_JOBSTATS.V.OUTPUT# = %YES#;
     1652    13727    2         CALL M$JOBSTATS(FPT_JOBSTATS) WHENALTRETURN
     1653    13728    3                         DO;
     1654    13729    3                           IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOTFND
     1655    13730    3                             THEN
     1656    13731    4                               DO;
     1657    13732    4                                 CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$
     1658    13733    4                                                  ->B$ALT.ERR);
     1659    13734    4                                 GOTO E_DISP_SYSID_SUBFILE_ALT;
     1660    13735    4                               END;  /* Then Do */
     1661    13736    3                            STAT$ -> VLR$OUTPUT.FOUND = 0;
     1662    13737    3                         END;  /* Whenaltreturn Do */
     1663    13738
     1664    13739    2         K = 0;
     1665    13740    3   N_SRCH: DO WHILE '1'B; /* Search the nodes for subfile numbers */
     1666    13741    4               DO WHILE '1'B;
     1667    13742    4                  IF CMD_CODE = %CH_NOOPTIONS
     1668    13743    4                     THEN
     1669    13744    4                        EXIT; /* Only one subfile for CHECK_SYSIDS */
     1670    13745    4                  K = K + 1;
     1671    13746    4                  IF K >= P$->P$B.NSUBLKS
     1672    13747    4                     THEN
     1673    13748    4                        EXIT N_SRCH;
     1674    13749    4                  FPT_JOBSTATS.V.NUM# = P$->P$B.SUBLK$(K)->P$B.CPOS;
     1675    13750    4                  IF P$->P$B.SUBLK$(K)->P$B.CODE = %CH_SYSID_NUM
     1676    13751    4                     THEN
     1677    13752    4                        EXIT;
     1678    13753    4               END;
     1679    13754    3         CH_XFORMAT.MSG# = %CP_SYSID_OQ_MESS ;
     1680    13755    3         CH_XFORMAT.NUM# = FPT_JOBSTATS.V.NUM#;
     1681    13756    3         NOT_FND = %YES#;
     1682    13757    4         DO J = 0 TO STAT$ -> VLR$OUTPUT.FOUND - 1 ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:53   
     1683    13758
     1684    13759    4             IF B$JIT.CPFLAGS1.BRK
     1685    13760    4               THEN                                      /* Forget the rest. */
     1686    13761    4                 RETURN;
     1687    13762    4             CH_XFORMAT.BUF$ = ADDR(STAT$ -> VLR$OUTPUT.F(J)) ;
     1688    13763    4             IF CH_XFORMAT.BUF$ -> VLA$OUTPUT.NUM = FPT_JOBSTATS.V.NUM#
     1689    13764    4               THEN                                /* Got the correct stream number. */
     1690    13765    5                 DO ;
     1691    13766    5                   NOT_FND = %NO#;
     1692    13767    5                   CALL READ_JOBSTATS_FILE ALTRET(E_DISP_SYSID_SUBFILE_NOTF);
     1693    13768    5                   CALL DISP_ONE_OUTPUT ;
     1694    13769    5                 END;  /* Then Do */
     1695    13770    4         END ; /* DO J */
     1696    13771    3         IF NOT_FND
     1697    13772    3           THEN
     1698    13773    4             DO;
     1699    13774
     1700    13775    4   E_DISP_SYSID_SUBFILE_NOTF:
     1701    13776    4               CH_XFORMAT.MSG# = %CP_NOTF_MESS;
     1702    13777    4               CH_XFORMAT.SYSID# = SYSID_CRITERIA.SYSID#;
     1703    13778    4               CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME#;
     1704    13779    4               CH_XFORMAT.NUM# = FPT_JOBSTATS.V.NUM#;
     1705    13780    4               CH_XFORMAT.ACCT# = FID_ACCT.ACCT#;
     1706    13781    4               CALL CPK$CHECK_OUTPUT(CH_XFORMAT);
     1707    13782    4               CHKEYBUF.NUM = CH_XFORMAT.NUM#;
     1708    13783    4               CALL DELETE_USEFILE_REC;
     1709    13784    4             END;  /* Then Do */
     1710    13785    3               IF CMD_CODE = %CH_NOOPTIONS
     1711    13786    3                  THEN
     1712    13787    3                     EXIT;
     1713    13788    3            END;
     1714    13789
     1715    13790    2         RETURN ;
     1716    13791
     1717    13792    2   E_DISP_SYSID_SUBFILE_ALT:
     1718    13793    2         ALTRETURN;
     1719    13794
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:54   
     1720    13795    2   END   DISP_SYSID_SUBFILE;
     1721    13796        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:55   
     1722    13797    1   CHECK_SYSIDS: PROC ALTRET ;
     1723    13798    2   DCL RETURN_FLG BIT(1) ;
     1724    13799
     1725    13800    2         RETURN_FLG = %YES# ;
     1726    13801    2         IF NOT USEFID_OPEN#
     1727    13802    2             THEN CALL OPEN_USEFILE WHENALTRETURN
     1728    13803    3                                     DO ;
     1729    13804    3                                       RETURN_FLG = %NO# ;
     1730    13805    3                                     END ; /* Whenaltreturn */
     1731    13806    2         IF RETURN_FLG
     1732    13807    2             THEN
     1733    13808    3               CALL M$PFIL (FPT_PFIL) WHENALTRETURN DO ;
     1734    13809    3                   CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511, B$TCB$ ->
     1735    13810    3                       B$TCB.ALT$ -> B$ALT.ERR) ;
     1736    13811    3                   RETURN_FLG = %NO# ;
     1737    13812    3                   END ; /*  Whenaltreturn */
     1738    13813                                                        /* Set up FPT_READ_USE. */
     1739    13814    2           FPT_READ_USE = CFPT_READ ;
     1740    13815    2           FPT_READ_USE.V_ = VECTOR(FPT_READ_USE.V) ;
     1741    13816    2           FPT_READ_USE.BUF_ = VECTOR(SYSIDBUF) ;
     1742    13817    2           FPT_READ_USE.V.KEYS# = %NO# ;
     1743    13818    2           FPT_READ_USE.V.KEYR# = %YES# ;
     1744    13819    2           FPT_READ_USE.V.DCB# = M$IBEX_NUM ;
     1745    13820    2           CMD_CODE = %CH_NOOPTIONS ;
     1746    13821    2           NRECS_READ = 0 ;
     1747    13822    2           NRECS_SKIP = 0 ;
     1748    13823    2           NRECS_DEL = 0 ;
     1749    13824    2           TEMP = 0 ;
     1750    13825    2           TEMP2 = 0 ;
     1751    13826
     1752    13827    2           IF RETURN_FLG
     1753    13828    2             THEN
     1754    13829    3   LOOP:    DO WHILE ('1'B) ;
     1755    13830    3             FPT_READ_USE.KEY_ = VECTOR(CHKEYBUF) ;
     1756    13831    3             CALL M$READ(FPT_READ_USE) WHENRETURN
     1757    13832    4                 DO ;
     1758    13833    4                   NRECS_READ = NRECS_READ + 1 ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:56   
     1759    13834    4                   IF TEMP ~= CHKEYBUF.SYSID OR TEMP2 > 0
     1760    13835    4                     THEN                      /* This is a new Job number. */
     1761    13836    5                       DO ;
     1762    13837    5                         TEMP = CHKEYBUF.SYSID ;
     1763    13838    5                         TEMP2 = CHKEYBUF.NUM ;
     1764    13839    5                         CALL SETUP_SYSID_SRCH WHENALTRETURN
     1765    13840    6                                     DO ;
     1766    13841    6                                       RETURN_FLG = %NO# ;
     1767    13842    6                                       EXIT LOOP ;
     1768    13843    6                                     END ; /* Whenaltreturn */
     1769    13844    5                       END ; /* Then Do */
     1770    13845    4                 END ; /* Whenreturn Do */
     1771    13846    3             WHENALTRETURN
     1772    13847    4                         DO ;
     1773    13848    4                           IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE =
     1774    13849    4                               %E$BADVECT1
     1775    13850    4                             THEN
     1776    13851    5                               DO ;
     1777    13852    5                                 CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF), 511,
     1778    13853    5                                         E_CHKBADUSEF) ;
     1779    13854    5                                 RETURN_FLG = %NO# ;
     1780    13855    5                               END ; /* Then Do */
     1781    13856    4                           EXIT LOOP ;
     1782    13857    4                         END ; /* Whenaltreturn */
     1783    13858    3             IF B$JIT.CPFLAGS1.BRK
     1784    13859    3               THEN
     1785    13860    3                 EXIT LOOP ;
     1786    13861    3           END ; /* DO WHILE */
     1787    13862
     1788    13863    2         IF NRECS_READ - (NRECS_DEL + NRECS_SKIP) > 0 AND RETURN_FLG
     1789    13864    2             THEN RETURN ;
     1790    13865
     1791    13866    2         ALTRETURN ;
     1792    13867
     1793    13868        /*E*       ERROR:   CPK-E$CHKBADUSEF-C
     1794    13869                   MESSAGE: Not a CHECK/NOTIFY USE file.
     1795    13870                   MESSAGE1: The key returned was not a CHECK/NOTIFY key type.
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:57   
     1796    13871                             CHECK/NOTIFY can not use this file.
     1797    13872                   DESCRIPTION: CHECK/NOTIFY tried to access a USE file that was not
     1798    13873                                built by CHECK/NOTIFY.
     1799    13874        */
     1800    13875
     1801    13876    2   END   CHECK_SYSIDS ;
     1802    13877        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:58   
     1803    13878    1   OPEN_JOBSTATS_FILE:   PROC  ALTRET ;
     1804    13879
     1805    13880        %VLP_SN (FPTN=FID_SN,STCLASS=AUTO) ;
     1806    13893
     1807    13894    2         FID_SN.NUM# = 1 ;
     1808    13895    2         FID_SN.SN#(0) = ' ' ;
     1809    13896    2         FPT_OPEN = CFPT_OPEN ;
     1810    13897    2         FPT_OPEN.V_ = VECTOR(FPT_OPEN.V) ;
     1811    13898    2         FPT_OPEN.V.DCB# = M$IBEX1_NUM ;
     1812    13899    2         FPT_OPEN.V.FUN# = %IN# ;
     1813    13900    2         FPT_OPEN.V.SHARE# = %ALL# ;
     1814    13901                                                              /* Close DCB. */
     1815    13902    2         FPT_CLOSE.V.DCB# = M$IBEX1_NUM ;
     1816    13903    2         CALL M$CLOSE (FPT_CLOSE) ;
     1817    13904    2         JOBSTATS_OPEN# = %YES# ;
     1818    13905    2         FPT_OPEN = CFPT_OPEN_JOBINFO ;
     1819    13906    2         FPT_OPEN.V_ = VECTOR(FPT_OPEN.V) ;
     1820    13907    2         FPT_OPEN.V.DCB# = M$IBEX1_NUM ;
     1821    13908    2         FPT_OPEN.SN_ = VECTOR(FID_SN) ;
     1822    13909    2         CALL M$OPEN (FPT_OPEN) ALTRET (E_OPEN_JOBSTATS_FILE) ;
     1823    13910
     1824    13911    2         RETURN ;
     1825    13912
     1826    13913    2   E_OPEN_JOBSTATS_FILE:
     1827    13914    2         ALTRETURN ;
     1828    13915
     1829    13916    2   END   OPEN_JOBSTATS_FILE ;
     1830    13917        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:59   
     1831    13918    1   READ_JOBSTATS_FILE: PROC ALTRET ;
     1832    13919
     1833    13920    2         IF (JOBSTATS_OPEN# = %NO#)
     1834    13921    2             THEN
     1835    13922    2               CALL OPEN_JOBSTATS_FILE ALTRET(E_JOBSTATS) ;
     1836    13923                                                              /* Read :JOBSTATS */
     1837    13924    2           IF CMD_CODE = %CH_JOBNAME
     1838    13925    2             THEN
     1839    13926    2               CALL GET_JOBNAME_SYSID_REC ;
     1840    13927    2           XSJ_INFOKEY = CXSJ_INFOKEY ;
     1841    13928    2           XSJ_INFOKEY.SYSID# = TEMP ;
     1842    13929    2           FPT_READ_JOBINFO.BUF_ = VECTOR(XSJ_JOBINFO) ;
     1843    13930    2           FPT_READ_JOBINFO.KEY_ = VECTOR(XSJ_INFOKEY) ;
     1844    13931    2           CALL M$READ (FPT_READ_JOBINFO) ALTRET(E_JOBSTATS) ;
     1845    13932
     1846    13933    2         IF JOB_COMPLETED
     1847    13934    2             THEN
     1848    13935    3               DO ;
     1849    13936    3                 CH_XFORMAT.MSG# = %CP_FINAL_STAT_MESS ;
     1850    13937    3                 CH_XFORMAT.BUF$ = ADDR(XSJ_JOBINFO) ;
     1851    13938    3                 IF (CMD_CODE = %CH_NOOPTIONS)
     1852    13939    3                   THEN
     1853    13940    4                     DO ;
     1854    13941    4                       CH_XFORMAT.SYSID# = CHKEYBUF.SYSID ;
     1855    13942    4                       CH_XFORMAT.ACCT# = SYSIDBUF.ACCT ;
     1856    13943    4                       CH_XFORMAT.JOBNAME# = SYSIDBUF.JNAME ;
     1857    13944    4                       CH_XFORMAT.COMMENT# = SYSIDBUF.COMMENT ;
     1858    13945    4                       CH_XFORMAT.NUM# = CHKEYBUF.NUM ;
     1859    13946    4                     END ; /* THEN DO */
     1860    13947    3                   ELSE
     1861    13948    4                     DO ;
     1862    13949    4                       CH_XFORMAT.SYSID# = TEMP ;
     1863    13950    4                       CH_XFORMAT.ACCT# = XSJ_JOBINFO.ACCT# ;
     1864    13951    4                       CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME# ;
     1865    13952    4                       CH_XFORMAT.NUM# = 1 ;
     1866    13953    4                     END ; /* ELSE DO */
     1867    13954    3                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:60   
     1868    13955                                                        /* Delete all associated records. */
     1869    13956    3   DELETE_RECORDS:
     1870    13957    3                 TEMP2 = CHKEYBUF.NUM ;
     1871    13958    4                 DO WHILE (CHKEYBUF.SYSID = CH_XFORMAT.SYSID# AND CHKEYBUF.KSIZ ~= 0 )
             13958                          ;
     1872    13959    4                   CALL M$PRECORD(FPT_PRECORD) ALTRET(RECORD_NOT_THERE) ;
     1873    13960    4                   IF TEMP2 ~= CHKEYBUF.NUM
     1874    13961    4                     THEN                                     /* Different record. */
     1875    13962    4                       NRECS_READ = NRECS_READ + 1 ;
     1876    13963    4                   CALL DELETE_USEFILE_REC ;
     1877    13964    4   RECORD_NOT_THERE:
     1878    13965    4                   IF TEMP2 ~= 0
     1879    13966    4                     THEN
     1880    13967    4                       EXIT;
     1881    13968    4                 END ; /* DO WHILE */
     1882    13969
     1883    13970    3               END ; /* THEN DO */
     1884    13971
     1885    13972    2           RETURN ;
     1886    13973    2   E_JOBSTATS:
     1887    13974    2         IF (B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY)
     1888    13975    2             THEN
     1889    13976    3               DO ;
     1890    13977    3                 CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR,,
     1891    13978    3                                   M$IBEX1_NUM) ;
     1892    13979    3                 ALTRETURN ;
     1893    13980    3               END ; /* THEN DO */
     1894    13981    2         IF NOT JOB_COMPLETED
     1895    13982    2             THEN
     1896    13983    3               DO ;                                      /* Some form of output. */
     1897    13984    3                 XSJ_JOBINFO = %NO# ;
     1898    13985    3                 RETURN ;
     1899    13986    3               END ; /* THEN DO */
     1900    13987    3         DO CASE (CMD_CODE) ;
     1901    13988
     1902    13989    3             CASE(%CH_SYSIDCMD, %CH_JOBNAME, %CH_LAST) ;
     1903    13990    3                IF CMD_TYPE = %SUBMIT_CMD#
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:61   
     1904    13991    3                 THEN
     1905    13992    3                   IF NSTATUS_FLG
     1906    13993    3                     THEN
     1907    13994    4                       DO ;
     1908    13995    4                         CALL SETUP_DUMMY_SUBMIT_MESS ;
     1909    13996    4                         CALL PRINT_SUBMIT_MESS ;
     1910    13997    4                         RETURN ;
     1911    13998    4                       END ; /* Then Do */
     1912    13999    3                 ELSE
     1913    14000    3                   UNWIND TO SUBMIT_LOOP_REMEM;  /* Try again to find the job. */
     1914    14001    3                CH_XFORMAT.MSG# = %CP_NOTF_MESS ;
     1915    14002    3                CH_XFORMAT.SYSID# = CHKEYBUF.SYSID;
     1916    14003    3                IF NOT(CP_CHFLAGS.SYSTEM) AND
     1917    14004    3                       (B$JIT.ACCN ~= FID_ACCT.ACCT#)
     1918    14005    3                  THEN
     1919    14006                                                    /*
     1920    14007                                                      This guy is asking about someone
     1921    14008                                                      else's Job, and he does not
     1922    14009                                                      have the tools to look at it.
     1923    14010                                                      Don't let him see the JOBNAME.
     1924    14011                                                    */
     1925    14012    3                     SYSIDBUF.JNAME = ' ' ;
     1926    14013    3                CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME# ;
     1927    14014    3                CH_XFORMAT.NUM# = CHKEYBUF.NUM;
     1928    14015    3               IF FID_ACCT.ACCT# = ' '
     1929    14016    3                 THEN                                    /* No acct. specified. */
     1930    14017    3                   CH_XFORMAT.ACCT# = ' ' ;
     1931    14018    3                 ELSE                                    /* Get the acct. */
     1932    14019    3                   CH_XFORMAT.ACCT# = FID_ACCT.ACCT# ;
     1933    14020
     1934    14021    3             CASE(%CH_NOOPTIONS) ;
     1935    14022    3                CH_XFORMAT.MSG# = %CP_DOESNT_EXIST_MESS ;
     1936    14023    3                CH_XFORMAT.SYSID# = CHKEYBUF.SYSID ;
     1937    14024    3                CH_XFORMAT.ACCT# = SYSIDBUF.ACCT ;
     1938    14025    3                CH_XFORMAT.JOBNAME# = SYSIDBUF.JNAME ;
     1939    14026    3                CH_XFORMAT.COMMENT# = SYSIDBUF.COMMENT ;
     1940    14027    3                CH_XFORMAT.NUM# = CHKEYBUF.NUM ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:62   
     1941    14028    3                CH_XFORMAT.BUF$ = ADDR(XSJ_JOBINFO) ;
     1942    14029
     1943    14030    3             CASE(%CH_TERM_CMD) ;
     1944    14031    3                CH_XFORMAT.MSG# = %CP_NO_TERM_OUT_MESS ;
     1945    14032    3                CH_XFORMAT.SYSID# = TEMP ;
     1946    14033
     1947    14034    3             END ; /* DO CASE */
     1948    14035    2         CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     1949    14036    2         GOTO DELETE_RECORDS ;
     1950    14037
     1951    14038    2   END   READ_JOBSTATS_FILE ;
     1952    14039        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:63   
     1953    14040    1   GET_JOBNAME_SYSID_REC:    PROC ALTRET ;
     1954    14041
     1955    14042    2         XSJ_NAMEKEY = CXSJ_NAMEKEY ;
     1956    14043    2         XSJ_NAMEKEY.JOBNAME# = VLP_JOBNAME.JOBNAME# ;
     1957    14044    2         IF FID_ACCT.ACCT# ~= ' '
     1958    14045    2           THEN
     1959    14046    2             XSJ_NAMEKEY.ACCT# = FID_ACCT.ACCT# ;
     1960    14047    2           ELSE
     1961    14048    2             XSJ_NAMEKEY.ACCT# = B$JIT.ACCN ;
     1962    14049    2         XSJ_NAMEREC.SYSID# = 0 ;
     1963    14050    2         FPT_READ_JOBINFO.BUF_ = VECTOR(XSJ_NAMEREC) ;
     1964    14051    2         FPT_READ_JOBINFO.KEY_ = VECTOR(XSJ_NAMEKEY) ;
     1965    14052    2         CALL M$READ(FPT_READ_JOBINFO) ALTRET(E_READ_SYSID_NAME_REC) ;
     1966    14053    3         DO WHILE ('0'B) ;
     1967    14054    3   E_READ_SYSID_NAME_REC:
     1968    14055    3             IF B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$NOKEY
     1969    14056    3               THEN
     1970    14057    4                 DO ;
     1971    14058    4                   CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR) ;
     1972    14059    4                   ALTRETURN ;
     1973    14060    4                 END ; /*THEN DO */
     1974    14061    3         END ; /* DO WHILE */
     1975    14062    2         TEMP = XSJ_NAMEREC.SYSID# ;
     1976    14063
     1977    14064    2         RETURN ;
     1978    14065
     1979    14066    2   END   GET_JOBNAME_SYSID_REC ;
     1980    14067        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:64   
     1981    14068    1   GET_JOBSTATS:   PROC ALTRET ;
     1982    14069        %VLP_ERRCODE (FPTN=ERRCODE, STCLASS=AUTO);
     1983    14114
     1984    14115    2         ERRCODE = '0'B;
     1985    14116
     1986    14117    2   JOBSTATS_LOOP:
     1987    14118    2         CALL M$JOBSTATS (FPT_JOBSTATS) ALTRET(E_JOBSTATS2);
     1988    14119
     1989    14120    2   DISP_JOBSTATS: ;
     1990    14121    3         DO CASE(CMD_CODE) ;
     1991    14122
     1992    14123    3             CASE(%CH_INPUT, %CH_RUN,%CH_JOB) ;
     1993    14124    3               IF CMD_TYPE = %CANCEL_CMD#
     1994    14125    3                 THEN
     1995    14126    3                   CALL DISP_SYSID_SRCH_IRQ;
     1996    14127    3                 ELSE
     1997    14128    3                   CALL DISP_INPUT ;
     1998    14129
     1999    14130    3             CASE(%CH_OUTPUT) ;
     2000    14131    3               IF CMD_TYPE = %CANCEL_CMD#
     2001    14132    3                 THEN
     2002    14133    3                   CALL DISP_SYSID_SRCH_OQ;
     2003    14134    3                 ELSE
     2004    14135    3                   CALL DISP_OUTPUT ;
     2005    14136
     2006    14137    3             CASE(%CH_SYSIDCMD,%CH_JOBNAME,%CH_LAST,%CH_TERM_CMD,%CH_NOOPTIONS) ;
     2007    14138    3                 IF (USEFID_OPEN# = %NO#)
     2008    14139    3                   THEN CALL OPEN_USEFILE ALTRET(E_OPEN) ;
     2009    14140    3                 IF (FPT_JOBSTATS.V.OUTPUT#)
     2010    14141    3                   THEN CALL DISP_SYSID_SRCH_OQ ALTRET(E_OPEN) ;
     2011    14142    3                   ELSE CALL DISP_SYSID_SRCH_IRQ ;
     2012    14143
     2013    14144    3         END ; /* DO CASE */
     2014    14145    2         IF ERRCODE
     2015    14146    2            THEN
     2016    14147    2               CALL CPC$WRITEMSGE(ERRCODE,,,,,%YES#);
     2017    14148    2         RETURN ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:65   
     2018    14149    2   E_JOBSTATS2:
     2019    14150    2         ERRCODE = B$TCB.ALT$ -> B$ALT.ERR ;
     2020    14151    2         ERRCODE.SEV = 0;
     2021    14152    3         DO CASE(ERRCODE.ERR#) ;
     2022    14153
     2023    14154    3             CASE(%E$NOTFND) ;                     /* Not in :JOBSTATS */
     2024    14155    4                 DO CASE(CMD_CODE) ;
     2025    14156
     2026    14157    4                   CASE(%CH_INPUT) ;
     2027    14158    4                     CH_XFORMAT.MSG# = %CP_NONE_IN_MESS ;
     2028    14159
     2029    14160    4                   CASE(%CH_RUN, %CH_JOB) ;
     2030    14161    4                     CH_XFORMAT.MSG# = %CP_NONE_RUN_MESS ;
     2031    14162
     2032    14163    4                   CASE(%CH_OUTPUT) ;
     2033    14164    4                     CH_XFORMAT.MSG# = %CP_NONE_OUT_MESS ;
     2034    14165    4                   CASE(ELSE) ;
     2035    14166    4                     CH_XFORMAT.MSG# = %CP_NONE_MESS ;
     2036    14167    4                 END ; /* DO CASE */
     2037    14168    3                 IF NOTIFYING /* No message or blank line if notify */
     2038    14169    3                    THEN
     2039    14170    3                       ALTRETURN;
     2040    14171    3                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     2041    14172    3   E_SETUP:
     2042    14173
     2043    14174    3                 RETURN ;
     2044    14175
     2045    14176    3             CASE(%E$JSIRAS) ;                     /* Not enough space for STATs. */
     2046    14177    3                 ADDR(FPT_JOBSTATS.RESULTS_) -> B$$VECTOR.W1.VSIZE# =
     2047    14178    3                 ADDR(FPT_JOBSTATS.RESULTS_) -> B$$VECTOR.W1.VSIZE# +
     2048    14179    3                                                 (%CPCH_NP2G*4096) ;
     2049    14180
     2050    14181    3             CASE(%E$JSISLS) ;                     /* Not enough space for SNs. */
     2051    14182    3                 ADDR(FPT_JOBSTATS.SNLIST_) -> B$$VECTOR.W1.VSIZE# =
     2052    14183    3                 ADDR(FPT_JOBSTATS.SNLIST_) -> B$$VECTOR.W1.VSIZE# +
     2053    14184    3                                                 (%CPCH_NP2G*4096) ;
     2054    14185    3                 GOTO MOVE_STATS ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:66   
     2055    14186    3             CASE(%E$JSIRLS) ;                     /* Not enough space for RES. */
     2056    14187    3                 ADDR(FPT_JOBSTATS.RESLIST_) -> B$$VECTOR.W1.VSIZE# =
     2057    14188    3                 ADDR(FPT_JOBSTATS.RESLIST_) -> B$$VECTOR.W1.VSIZE# +
     2058    14189    3                                                 (%CPCH_NP2G*4096) ;
     2059    14190    3                 SN$ = PINCRW(SN$,%CPCH_NP2G*1024) ;
     2060    14191    3                 ADDR(FPT_JOBSTATS.SNLIST_) -> B$$VECTOR.PTR$ = SN$ ;
     2061    14192    3   MOVE_STATS:
     2062    14193    3                 STAT$ = PINCRW(STAT$,%CPCH_NP2G*1024) ;
     2063    14194    3                 ADDR(FPT_JOBSTATS.RESULTS_) -> B$$VECTOR.PTR$ = STAT$ ;
     2064    14195
     2065    14196    3             CASE(ELSE) ;                        /* More serious */
     2066    14197    3   E_OPEN:
     2067    14198    3                 ALTRETURN ;
     2068    14199
     2069    14200    3         END ; /* DO CASE */
     2070    14201
     2071    14202    2         CALL CPC$GETSEG (SEG4$,%CPCH_NP2G*1024) WHENALTRETURN
     2072    14203    3            DO;
     2073    14204    3               IF ERRCODE.ERR# ~= %E$JSIRAS
     2074    14205    3                  THEN
     2075    14206    3                     GOTO E_JOBSTATS2;
     2076    14207    3               GOTO DISP_JOBSTATS;
     2077    14208    3            END;
     2078    14209    2         ERRCODE = '0'B;
     2079    14210    2         VBOUND(RESULTS_) = VBOUND(RESULTS_)+4096*%CPCH_NP2G;
     2080    14211    2         GOTO JOBSTATS_LOOP ;
     2081    14212    2   END   GET_JOBSTATS ;
     2082    14213        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:67   
     2083    14214    1   DELETE_USEFILE_REC: PROC ;
     2084    14215
     2085    14216    2         FPT_DELREC = CFPT_DELREC ;
     2086    14217    2         FPT_DELREC.V_ = VECTOR(FPT_DELREC.V) ;
     2087    14218    2         FPT_DELREC.KEY_ = VECTOR(CHKEYBUF) ;
     2088    14219    2         FPT_DELREC.V.DCB# = M$IBEX_NUM ;
     2089    14220                                                      /* Delete this record in USE file */
     2090    14221    2         CALL M$DELREC(FPT_DELREC) ALTRET(E_DELREC) ;
     2091    14222    2         NRECS_DEL = NRECS_DEL + 1 ;
     2092    14223    2   E_DELREC:
     2093    14224    2         RETURN ;
     2094    14225    2   END   DELETE_USEFILE_REC ;
     2095    14226        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:68   
     2096    14227    1   WRITE_USEFILE_REC:  PROC  ALTRET ;
     2097    14228
     2098    14229    2         IF CMD_TYPE = %CANCEL_CMD#
     2099    14230    2           THEN
     2100    14231    2             RETURN;
     2101    14232    2         IF NOT USEFID_OPEN#
     2102    14233    2             THEN CALL OPEN_USEFILE ALTRET(E_OPEN_USE) ;
     2103    14234
     2104    14235    2         IF DELUSEREC
     2105    14236    2           THEN
     2106    14237    3             DO;
     2107    14238    3               CALL DELETE_USEFILE_REC;
     2108    14239    3               RETURN;
     2109    14240    3             END;
     2110    14241
     2111    14242    2         CALL CPJ$WRITE_REC (M$IBEX_NUM,VECTOR(CHKEYBUF),VECTOR(SYSIDBUF))
     2112    14243    2             ALTRET(E_WRITE_CHECK) ;
     2113    14244    2         B$JIT.CPFLAGS1.SOMENOTIFY = %YES# ;
     2114    14245
     2115    14246    2         RETURN ;
     2116    14247    2   E_WRITE_CHECK:
     2117    14248    2         CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR,,M$IBEX1_NUM) ;
     2118    14249
     2119    14250    2   E_OPEN_USE:
     2120    14251    2         ALTRETURN ;
     2121    14252
     2122    14253    2   END   WRITE_USEFILE_REC ;
     2123    14254        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:69   
     2124    14255    1   OPEN_USEFILE: PROC  ALTRET ;
     2125    14256
     2126    14257    2         FPT_CLOSE.V.DCB# = M$IBEX_NUM ;
     2127    14258    2         IF DCBADDR(M$IBEX_NUM) -> F$DCB.FCD#
     2128    14259    2             THEN CALL M$CLOSE (FPT_CLOSE) ;
     2129    14260    2         CMDSTRM_CLOSED# = %YES# ;
     2130    14261                                                              /* Set up OPEN. */
     2131    14262    2         FPT_OPEN_USE.V.FUN# = %CREATE# ;
     2132    14263    2         FPT_OPEN_USE.V.EXIST# = %OLDFILE# ;
     2133    14264    2         IF (CP_CHFLAGS.USE_RESULTS = '0'B)
     2134    14265    2             THEN
     2135    14266    3               DO ;
     2136    14267    3                 TEMPBUF$ = ADDR(TEMPBUF) ;
     2137    14268    3                 TEMPBUF$ -> P$S.COUNT = 6 ;
     2138    14269    3                 TEMPBUF$ -> P$S.TEXT = '*$$JOB' ;
     2139    14270    3                 TEMPBUF$ -> P$S.TEXTC$ = ADDR(TEMPBUF$->P$S.COUNT) ;
     2140    14271    3                 CALL CPC$MFID_OPEN(FPT_OPEN_USE,TEMPBUF$,CP_FIDVLPS)
     2141    14272    3                           ALTRET(E_OPEN_ALTRET) ;
     2142    14273    3               END ; /* THEN DO */
     2143    14274    2             ELSE
     2144    14275    2               CALL CPC$FID_OPEN(FPT_OPEN_USE,,CP_FIDVLPS)
     2145    14276    2                           ALTRET(E_OPEN_ALTRET) ;
     2146    14277
     2147    14278    2         CP_CHFLAGS.USE_RES = CP_FIDVLPS.FID_RES ;
     2148    14279    2         CP_CHFLAGS.USE_ASN = CP_FIDVLPS.FID_ASN ;
     2149    14280    2         CP_CHFLAGS.USE_RESULTS = CP_FIDVLPS.FID_RESULTS ;
     2150    14281    2         USEFID_OPEN# = %YES# ;
     2151    14282
     2152    14283    2         RETURN ;
     2153    14284
     2154    14285    2   E_OPEN_ALTRET:
     2155    14286    2         ADDR(SEG$2.ERRBUF) -> ERR$BLK.FIRST = 0;
     2156    14287    2         ADDR(SEG$2.ERRBUF) -> ERR$BLK.NEXT = 0;
     2157    14288    2         CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_CHKBADUSEFSPEC,,M$IBEX_NUM) ;
     2158    14289    2         CALL CPR$RPTERR (SEG$2.ERRBUF, 511) ;
     2159    14290    2         ADDR(SEG$2.ERRBUF) -> ERR$BLK.FIRST = 0;
     2160    14291    2         ADDR(SEG$2.ERRBUF) -> ERR$BLK.NEXT = 0;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:70   
     2161    14292    2         UNWIND TO BAD_USEFILE_REMEM ;
     2162    14293
     2163    14294        /*E*       ERROR:   CPK-E$CHKBADUSEFSPEC-C
     2164    14295                   MESSAGE: CHECK/NOTIFY unable to USE file% %UF%.
     2165    14296                   DESCRIPTION: CHECK/NOTIFY tried to access a USE file that the user
     2166    14297                                did not have access to.
     2167    14298        */
     2168    14299
     2169    14300    2   END OPEN_USEFILE ;
     2170    14301        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:71   
     2171    14302    1   COMPARE_STATUS: PROC    ALTRET ;
     2172    14303
     2173    14304              /* COMPARE_STATUS is a routine to see if the status of
     2174    14305                  the CHECKed job has changed since the last time it
     2175    14306                  was CHECKed.  It there is NO CHANGE, then RETURN
     2176    14307                  normally, else ALTRETURN.
     2177    14308              */
     2178    14309    2         FPT_JOBSTATS_STATUS = CFPT_JOBSTATS ;
     2179    14310    2         FPT_JOBSTATS_STATUS.V_ = VECTOR(FPT_JOBSTATS_STATUS.V) ;
     2180    14311    2         FPT_JOBSTATS_STATUS.V.SYSID# = CHKEYBUF.SYSID ;
     2181    14312    2         IF OUTPUT_FLG
     2182    14313    2             THEN
     2183    14314    3               DO ;
     2184    14315    3                 FPT_JOBSTATS_STATUS.V.ORDER# = %CHECKF# ;
     2185    14316    3                 FPT_JOBSTATS_STATUS.V.NUM# = CHKEYBUF.NUM ;
     2186    14317    3               END ; /* THEN DO */
     2187    14318    2             ELSE
     2188    14319    2               FPT_JOBSTATS_STATUS.V.ORDER# = %CHECK# ;
     2189    14320    2         FPT_JOBSTATS_STATUS.RESULTS_ = VECTOR(VLR_JOBSTATS_CHECK) ;
     2190    14321
     2191    14322    2         CALL M$JOBSTATS(FPT_JOBSTATS_STATUS) ALTRET(E_CHECKSTATUS) ;
     2192    14323
     2193    14324    2         ASYSIDBUF.STATUS = SYSIDBUF.STATUS ;
     2194    14325    2         IF OUTPUT_FLG
     2195    14326    2             THEN
     2196    14327    3               DO ;
     2197    14328    3                 ASYSIDBUF.STATUS.CODE = VLR_JOBSTATS_CHECK.FCODE ;
     2198    14329    3                 IF ASYSIDBUF.STATUS.CODE = %FS_PRT#
     2199    14330    3                   THEN ASYSIDBUF.STATUS.TORUN = 0 ;
     2200    14331    3                   ELSE ASYSIDBUF.STATUS.TORUN = VLR_JOBSTATS_CHECK.AHEAD ;
     2201    14332    3               END ; /* THEN DO */
     2202    14333    2             ELSE
     2203    14334    3               DO ;
     2204    14335    3                 ASYSIDBUF.STATUS.CODE = VLR_JOBSTATS_CHECK.CODE ;
     2205    14336    3                 IF VLR_JOBSTATS_CHECK.PRIO <= 15 AND VLR_JOBSTATS_CHECK.CODE = %
             14336                          JS_WAIT#
     2206    14337    3                   THEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:72   
     2207    14338    3                     ASYSIDBUF.STATUS.TORUN = VLR_JOBSTATS_CHECK.AHEAD ;
     2208    14339    3                 IF VLR_JOBSTATS_CHECK.PRIO = %JP_RUNAFTER#
     2209    14340    3                   THEN
     2210    14341    3                     NRECS_SKIP = NRECS_SKIP + 1 ;
     2211    14342    3               END ; /* ELSE DO */
     2212    14343                                            /* Anything not PRINTing or WAITing to PRINT? */
     2213    14344    2         IF VLR_JOBSTATS_CHECK.CODE = %JS_RUN#   OR
     2214    14345    2             VLR_JOBSTATS_CHECK.CODE= %JS_AP#   OR
     2215    14346    2               (VLR_JOBSTATS_CHECK.CODE= %JS_WAIT# AND
     2216    14347    2               VLR_JOBSTATS_CHECK.PRIO~= %JP_RUNAFTER#)
     2217    14348    2               THEN MORE_2_WAIT = %YES# ;      /* Yes! */
     2218    14349
     2219    14350    2         IF SYSIDBUF.STATUS.CODE = 0 AND
     2220    14351    2             SYSIDBUF.STATUS.PRIO = 0 AND
     2221    14352    2             SYSIDBUF.STATUS.TORUN = 0 AND
     2222    14353    2             NOT OUTPUT_FLG
     2223    14354    2             THEN SYSIDBUF.STATUS = ASYSIDBUF.STATUS ;   /* First compare. */
     2224    14355
     2225    14356    2         IF ASYSIDBUF.STATUS = SYSIDBUF.STATUS
     2226    14357    2             THEN                                        /* Status the same. */
     2227    14358    2               ALTRETURN ;
     2228    14359
     2229    14360    2   E_CHECKSTATUS:
     2230    14361    2         SYSIDBUF.STATUS = ASYSIDBUF.STATUS ;            /* Status has changed. */
     2231    14362    2         RETURN ;
     2232    14363
     2233    14364    2   END   COMPARE_STATUS ;
     2234    14365        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:73   
     2235    14366    1   SETUP_DUMMY_SUBMIT_MESS: PROC ;
     2236    14367
     2237    14368    2     VLR_JOBSTATS_CHECK = %NO# ;
     2238    14369    2     CALL CHARBIN(TEMP,P$->P$B.SUBLK$(0)->P$S.TEXTC$->TEXTC.TEXT) ;
     2239    14370    2     VLR_JOBSTATS_CHECK.SYSID = TEMP ;
     2240    14371    2     CH_XFORMAT.COMMENT# = ' ' ;
     2241    14372    2     VLP_JOBNAME.JOBNAME# = ' ' ;
     2242    14373    2     RETURN ;
     2243    14374
     2244    14375    2   END   SETUP_DUMMY_SUBMIT_MESS ;
     2245    14376        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:74   
     2246    14377    1   PRINT_SUBMIT_MESS:  PROC ;
     2247    14378
     2248    14379    2     CH_XFORMAT.MSG# = %CP_APRESCAN_MESS ;
     2249    14380    2     CH_XFORMAT.SYSID# = VLR_JOBSTATS_CHECK.SYSID ;
     2250    14381    2     CH_XFORMAT.NUM# = 0 ;
     2251    14382    2     CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME# ;
     2252    14383    2     CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     2253    14384                                                              /* Save SYSID */
     2254    14385    2     CHKEYBUF = CP_C_CHKEYBUF ;
     2255    14386                                                              /* Setup key */
     2256    14387    2     CHKEYBUF.SYSID = VLR_JOBSTATS_CHECK.SYSID ;
     2257    14388    2     CHKEYBUF.NUM = 0 ;
     2258    14389    2     SYSIDBUF.STATUS.CODE = VLR_JOBSTATS_CHECK.CODE ;
     2259    14390    2     SYSIDBUF.STATUS.PRIO = VLR_JOBSTATS_CHECK.PRIO ;
     2260    14391    2     SYSIDBUF.STATUS.TORUN = VLR_JOBSTATS_CHECK.AHEAD ;
     2261    14392    2     SYSIDBUF.ACCT = ' ' ;
     2262    14393    2     SYSIDBUF.JNAME = ' ' ;
     2263    14394    2     SYSIDBUF.COMMENT = CH_XFORMAT.COMMENT# ;
     2264    14395                                                              /* Write out record. */
     2265    14396    2     CALL WRITE_USEFILE_REC ALTRET(E_WRITE_CHECK) ;
     2266    14397    2   E_WRITE_CHECK:
     2267    14398    2     RETURN ;
     2268    14399
     2269    14400    2   END   PRINT_SUBMIT_MESS ;
     2270    14401        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:75   
     2271    14402    1   READ_OUTPUT_RECORD:  PROC (CHKEYBUF) ALTRET ;
     2272    14403
     2273    14404        %CP_CHKEYBUF                            ( FPTN = CHKEYBUF,
     2274    14405              STCLASS = PARAM) ;
     2275    14423        %CP_CHKEYBUF                            ( FPTN = TCHKEYBUF,
     2276    14424              STCLASS = AUTO) ;
     2277    14442        %FPT_PRECORD (FPTN=LFPT_PRECORD, STCLASS=AUTO) ;
     2278    14463
     2279    14464    2         TCHKEYBUF = CP_C_CHKEYBUF ;
     2280    14465    2         TCHKEYBUF.SYSID = CHKEYBUF.SYSID ;
     2281    14466    2         TCHKEYBUF.NUM = CHKEYBUF.NUM ;
     2282    14467
     2283    14468    2         LFPT_PRECORD = FPT_PRECORD ;
     2284    14469    2         LFPT_PRECORD.V_ = VECTOR(LFPT_PRECORD.V) ;
     2285    14470    2         LFPT_PRECORD.KEY_ = VECTOR(TCHKEYBUF) ;
     2286    14471
     2287    14472    3         CALL M$PRECORD(LFPT_PRECORD) WHENALTRETURN DO ;
     2288    14473    3                                     END ;
     2289    14474                                                        /* Set up FPT_READ_USE. */
     2290    14475    2         FPT_READ_USE = CFPT_READ ;
     2291    14476    2         FPT_READ_USE.V_ = VECTOR(FPT_READ_USE.V) ;
     2292    14477    2         FPT_READ_USE.BUF_ = VECTOR(SYSIDBUF) ;
     2293    14478    2         FPT_READ_USE.KEY_ = VECTOR(TCHKEYBUF) ;
     2294    14479    2         FPT_READ_USE.V.KEYS# = %NO# ;
     2295    14480    2         FPT_READ_USE.V.KEYR# = %YES# ;
     2296    14481    2         FPT_READ_USE.V.DCB# = M$IBEX_NUM ;
     2297    14482    2         CALL M$READ(FPT_READ_USE) ALTRET (READ_ERR) ;
     2298    14483
     2299    14484    2         IF TCHKEYBUF.SYSID = CHKEYBUF.SYSID AND TCHKEYBUF.NUM = CHKEYBUF.NUM
     2300    14485    2             THEN
     2301    14486    2               CHKEYBUF = TCHKEYBUF ;
     2302    14487    2             ELSE
     2303    14488    2               SYSIDBUF.STATUS = '0'B ;
     2304    14489
     2305    14490    2   READ_OUTPUT_RECORD_RET:
     2306    14491    2         B$JIT.USRERR = %NO# ;
     2307    14492    2         RETURN ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:76   
     2308    14493
     2309    14494    2   READ_ERR:
     2310    14495    2         IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY OR B$TCB.ALT$->B$ALT.ERR.CODE = %
             14495                  E$EOF
     2311    14496    2             THEN
     2312    14497    2               GOTO READ_OUTPUT_RECORD_RET ;
     2313    14498
     2314    14499    2         CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR) ;
     2315    14500    2         ALTRETURN ;
     2316    14501
     2317    14502    2   END   READ_OUTPUT_RECORD ;
     2318    14503        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:77   
     2319    14504    1   SETUP_HDR_CNT_SZ: PROC ;
     2320    14505
     2321    14506    2     IF DCBADDR(SEG$2.LLDCB#)->F$DCB.ORG# = %TERMINAL# AND
     2322    14507    2             DCBADDR(SEG$2.LLDCB#)->F$DCB.LINES# ~= 0
     2323    14508    2         THEN
     2324    14509    2             HDR_CNT_SZ = DCBADDR(SEG$2.LLDCB#)->F$DCB.LINES# ;
     2325    14510    2         ELSE
     2326    14511    2             HDR_CNT_SZ = %DFLT_HDR_CNT_SZ ;
     2327    14512
     2328    14513    2     RETURN ;
     2329    14514
     2330    14515    2   END   SETUP_HDR_CNT_SZ ;
     2331    14516    1   END CPK$CHECK;
     2332    14517                   %EOD;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:78   
--  Include file information  --

   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPK$CHECK.

   Procedure CPK$CHECK requires 4194 words for executable code.
   Procedure CPK$CHECK requires 756 words of local(AUTO) storage.

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:79   

 Object Unit name= CPK$CHECK                                  File name= CPK$CHECK.:E05TOU
 UTS= JUL 29 '97 11:55:22.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    209    321  CPK$CHECK
    2   Proc  even  none  4194  10142  CPK$CHECK
    3  RoData even  none    54     66  CPK$CHECK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  CPK$CHECK
     2     14          yes     yes      Std        1  CPK$CANCEL
     2     21          yes     yes      Std        1  CPK$SUBMIT_CHECK
     2     37          yes     yes      Std        1  CPK$NOTIFY
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:80   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 CPC$OPEN_S
         yes           Std       2 CPC$SCREECH
         yes           Std       2 CPK$CHECK_OUTPUT
         yes           Std       1 CPC$RELSEG
 yes     yes           Std       3 CPJ$WRITE_S
         yes           Std       0 CPB$OPENCS
 yes     yes           Std       2 CPC$GETSEG
         yes           Std       0 CPC$OPEN_LL
 yes     yes           Std       3 CPJ$READ_S
         yes           Std       5 CXP$POSTERR
 yes     yes           Std       3 CPC$FID_VLP
         yes           Std       6 CPC$WRITEMSGE
 yes     yes           Std       3 CPJ$WRITE_REC
 yes     yes           Std       3 CPC$MFID_OPEN
 yes     yes           Std       3 CPC$FID_OPEN
         yes           Std       2 CPR$RPTERR
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       nStd      0 X66_AUNWIND
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:81   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CFPT_TIME                             CFPT_OPEN
     CFPT_CLOSE                            CFPT_READ                             CFPT_PRECORD
     CFPT_DELREC                           CVLP_CRITERIA                         CFPT_JOBSTATS
     CFPT_WAIT                        r    SEG2$                            r    SEG4$
r    B$JIT$                           r    B$TCB$                                M$IBEX_NUM
     M$IBEX1_NUM                           K_NOTIFY                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:82   


        1        1        /*M* CHECK and NOTIFY cmds.                                                     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,DFC */
        8        8        /*P*   NAME:   CPK$CHECK
        9        9               PURPOSE: To perform all the required operations in  the execution
       10       10                       of the IBEX CHECK and NOTIFY commands.
       11       11               DESCRIPTION:
       12       12               REFERENCE: Programmers Reference Manual
       13       13        */
       14       14        /**********************************************************************/
       15       15        CPK$CHECK:
       16       16          PROC(P$PCB)    ALTRET;

     16  2 000000   000000 700200 xent  CPK$CHECK    TSX0  ! X66_AUTO_1
         2 000001   001364 000001                    ZERO    756,1

       17       17                   %PLIST;
       18       18                   %INCLUDE CP_6;
       19       99                   %INCLUDE B$JIT;
       20      389                   %INCLUDE B_MACROS_C;
       21      500                   %INCLUDE CP_MACROS_C;
       22     1252                   %INCLUDE XU_MACRO_C;
       23     4358                   %INCLUDE CP_SUBS_C;
       24     5275                   %INCLUDE CP_PERR_C;
       25     5613                   %INCLUDE CP_6_SUBS;
       26     6153                   %INCLUDE B_ERRORS_C;
       27     7280                   %INCLUDE XSJ_MAC_C;
       28     7359                   %INCLUDE XSJ_SUBS_C;
       29     7386                   %INCLUDE CP_DATA_R;
       30     9949             /***** Ptr variable declarations *****/
       31     9950    1   DCL P$ PTR;
       32     9951    1   DCL BLK$ PTR;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:83   
       33     9952    1   DCL TEMP$ PTR;
       34     9953    1   DCL DCB$ PTR;
       35     9954    1   DCL FID$ PTR;
       36     9955    1   DCL TEMPBUF$ PTR;
       37     9956    1   DCL DEST$ PTR;
       38     9957    1   DCL STAT$ PTR ;
       39     9958    1   DCL RES$ PTR ;
       40     9959    1   DCL SN$ PTR ;
       41     9960    1   DCL P$TEXTC$ PTR ;
       42     9961    1   DCL BUF$ PTR ;
       43     9962
       44     9963             /***** External procedure (entry) declarations *****/
       45     9964    1   DCL X$PARSE ENTRY(1) ALTRET;
       46     9965    1   DCL CPB$OPENCS ENTRY ;
       47     9966    1   DCL CPC$GETDCB ENTRY(2) ALTRET;
       48     9967    1   DCL CPC$OPEN_LL ENTRY;
       49     9968    1   DCL CPC$RELDCB ENTRY(3);
       50     9969    1   DCL CPC$RELSEG ENTRY(1);
       51     9970    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;
       52     9971    1   DCL CPC$GETSEG ENTRY(2) ALTRET;
       53     9972    1   DCL CPC$SCREECH ENTRY(2);
       54     9973    1   DCL CPC$WRITEMSGE ENTRY(6);
       55     9974    1   DCL CPJ$READ_S ENTRY(3) ALTRET;
       56     9975    1   DCL CPJ$WRITE_S ENTRY(3) ALTRET;
       57     9976    1   DCL CPJ$READ_REC ENTRY(3) ALTRET;
       58     9977    1   DCL CPJ$WRITE_REC ENTRY(3) ALTRET;
       59     9978    1   DCL CXP$POSTERR ENTRY(5);
       60     9979    1   DCL CPR$RPTERR ENTRY(2);
       61     9980    1   DCL CPC$MFID_OPEN ENTRY(3) ALTRET ;
       62     9981    1   DCL CPC$FID_VLP ENTRY(3) ALTRET ;
       63     9982    1   DCL CPC$FID_OPEN ENTRY(3) ALTRET ;
       64     9983    1   DCL CPK$CHECK_OUTPUT ENTRY(2) ;
       65     9984
       66     9985             /***** Error codes. *****/
       67     9986
       68     9987        %ERR_CODE (NAME=E_CHKNOPRIV,MID#=CPK$IBEXMID,CODE#=E$CHKNOPRIV,STCLASS=CONSTANT) ;
       69    10007
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:84   
       70    10008        /*E*    ERROR: CPK-E$CHKNOPRIV-C
       71    10009                MESSAGE: Sorry. You can only view YOUR jobs and output.
       72    10010        */
       73    10011       %ERR_CODE (NAME=E_USEFILEBUSY,MID#=CPK$IBEXMID,CODE#=E$USEFILEBUSY,STCLASS=CONSTANT)
             10011            ;
       74    10031        %ERR_CODE (NAME=E_CHKBADUSEF,MID#=CPK$IBEXMID,CODE#=E$CHKBADUSEF,STCLASS=CONSTANT);
       75    10051        %ERR_CODE (NAME=E_CHKBADUSEFSPEC,MID#=CPK$IBEXMID,CODE#=E$CHKBADUSEFSPEC,STCLASS=
             10051            CONSTANT);
       76    10071
       77    10072             /***** Based STRUCTURES *****/
       78    10073        %SEG$2;
       79    10133        %TEXTC (NAME=TEXTC);
       80    10138        %B$TCB (STCLASS="BASED(B$TCB$)");
       81    10141        %B$ALT;
       82    10149        %B$NWIO ;
       83    10234        %SUB_ECCDELTA ;
       84    10271          %ERR_BLK (NAME=ERR$BLK,STCLASS=BASED);
       85    10296             /***** Character string declarations *****/
       86    10297    1   DCL BLANKS CHAR(8) CONSTANT  INIT(' ');
       87    10298    1   DCL 1 M$DO_DCB CONSTANT DALIGNED,
       88    10299    1          2 CNT UBIN(9) INIT(4) UNAL,
       89    10300    1          2 TXT CHAR(4) INIT('M$DO');
       90    10301    1   DCL TEMPBUF CHAR(256);
       91    10302    1   DCL  1  TEMP_BUF REDEF TEMPBUF,
       92    10303    1        2  COUNT UBIN BYTE UNAL,
       93    10304    1        2  TEXT CHAR(255);
       94    10305    1   DCL B$$PAGE (0:1023) UBIN WORD BASED ALIGNED ;
       95    10306
       96    10307             /***** Bit variables *****/
       97    10308    1   DCL JOBSTATS_OPEN# BIT(1) ALIGNED AUTO;
       98    10309    1   DCL USEFID_OPEN# BIT(1) ALIGNED AUTO;
       99    10310    1   DCL CMDSTRM_CLOSED# BIT(1) ALIGNED AUTO;
      100    10311    1   DCL DELUSEREC BIT(1);
      101    10312    1   DCL GET_JOBSTATS# BIT(1) ;
      102    10313    1   DCL SYSTEM_OK# BIT(1) ;
      103    10314    1   DCL NSTATUS_FLG BIT(1) ;
      104    10315    1   DCL CROSS_ACCT_BATCH_FLG BIT(1) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:85   
      105    10316    1   DCL HELD_LINE_NOT_PRINTED BIT(1) ;
      106    10317    1   DCL WAIT_DONE BIT(1) ;
      107    10318    1   DCL WAIT_BELL BIT(1) ;
      108    10319    1   DCL WAITING BIT(1) ;
      109    10320    1   DCL MORE_2_WAIT BIT(1) ;
      110    10321    1   DCL SOMETHING_CHANGED BIT(1) ;
      111    10322    1   DCL FORCE BIT(1) ;
      112    10323    1   DCL NOTIFYING BIT(1) ;
      113    10324    1   DCL FIRST_QFLAG BIT(1) ;
      114    10325    1   DCL NOTIFY_Q_FLAGS(0:2) BIT(1) UNAL ;
      115    10326    1   DCL OUTPUT_FLG BIT(1) ;
      116    10327    1   DCL JOB_COMPLETED BIT(1) ;
      117    10328             /***** Word declarations *****/
      118    10329    1   DCL I SBIN;
      119    10330    1   DCL J SBIN;
      120    10331    1   DCL K SBIN;
      121    10332    1   DCL TEMP UBIN WORD;
      122    10333    1   DCL TEMP2 UBIN WORD;
      123    10334    1   DCL TEMP3 UBIN WORD;
      124    10335    1   DCL TAB_VAL UBIN WORD;
      125    10336    1   DCL DCB# UBIN WORD;
      126    10337    1   DCL CMD_CODE UBIN WORD ;
      127    10338    1   DCL NRECS_READ SBIN WORD ;
      128    10339    1   DCL NRECS_SKIP SBIN WORD ;
      129    10340    1   DCL NRECS_DEL SBIN WORD ;
      130    10341    1   DCL BAD_USEFILE_REMEM REMEMBER ;
      131    10342    1   DCL SUBMIT_LOOP_REMEM REMEMBER ;
      132    10343    1   DCL CMD_TYPE UBIN WORD ;
      133    10344        %EQU CHECK_CMD# = 0 ;
      134    10345        %EQU NOTIFY_CMD# = 1 ;
      135    10346        %EQU SUBMIT_CMD# = 2 ;
      136    10347        %EQU CANCEL_CMD# = 3 ;
      137    10348        %EQU DFLT_HDR_CNT_SZ = 24 ;
      138    10349
      139    10350    1   DCL HDR_CNT_SZ UBIN WORD ;
      140    10351    1   DCL NLINES UBIN WORD ;
      141    10352
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:86   
      142    10353             /***** Auto structures *****/
      143    10354
      144    10355        %CP_CHFLAGS                         ( FPTN = CP_CHFLAGS ,
      145    10356              STCLASS = AUTO ) ;
      146    10490        %CP_FIDVLPS                         ( NAME = CP_FIDVLPS ,
      147    10491              STCLASS = AUTO ) ;
      148    10502        %CP_CHKEYBUF                        ( FPTN = CHKEYBUF) ;
      149    10520        %CP_CHKEYBUF                        ( FPTN = T_CHKEYBUF) ;
      150    10538        %CP_SYSIDBUF                        ( FPTN = SYSIDBUF) ;
      151    10560        %CP_SYSIDBUF                        ( FPTN = ASYSIDBUF) ;
      152    10582        %CH_XFORMAT                           ( FPTN = CH_XFORMAT,
      153    10583              STCLASS = AUTO) ;
      154    10607    1   DCL NUM_AHEAD UBIN WORD ;
      155    10608    1   DCL NUM_LISTED UBIN WORD ;
      156    10609    1   DCL HDR_CNT UBIN WORD ;
      157    10610    1   DCL WAIT_INT UBIN WORD ;
      158    10611    1   DCL BRK_CNT UBIN WORD ;
      159    10612        %PARSE$OUT (NAME=P_DUMMY, STCLASS=AUTO) ;
      160    10657
      161    10658             /***** Constant data *****/
      162    10659
      163    10660        %CP_CHKEYBUF                            ( FPTN = CP_C_CHKEYBUF,
      164    10661              STCLASS = CONSTANT) ;
      165    10679        %CP_CHFLAGS                             ( FPTN = CP_C_CHFLAGS,
      166    10680              STCLASS = CONSTANT) ;
      167    10814        %XSJ_INFOKEY                            ( FPTN = CXSJ_INFOKEY,
      168    10815              STCLASS = CONSTANT) ;
      169    10828        %XSJ_NAMEKEY                            ( FPTN = CXSJ_NAMEKEY,
      170    10829              STCLASS = CONSTANT) ;
      171    10843
      172    10844             /***** Constant FPTs *****/
      173    10845
      174    10846        %FPT_PRIV                               ( FPTN = FPT_PRIV_DISPJOB,
      175    10847              PRIV = %PR_DISPJOB#,
      176    10848              AUTH = YES,
      177    10849              STCLASS = CONSTANT) ;
      178    10864        %FPT_OPEN                               ( FPTN = CFPT_OPEN_JOBINFO,
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:87   
      179    10865              STCLASS = CONSTANT,
      180    10866              ASN = FILE,
      181    10867              FUN = IN,
      182    10868              SHARE = ALL,
      183    10869              NAME = JOBSTATS_NAME,
      184    10870              ACCT = JOBSTATS_ACCT) ;
      185    10979        %FPT_TRMPRG                                   (FPTN = CFPT_TRMPRG,
      186    10980              STCLASS = CONSTANT,
      187    10981              RSTBRK = YES) ;
      188    11010        %FPT_PFIL                                     (FPTN = CFPT_PFIL,
      189    11011              STCLASS = CONSTANT,
      190    11012              BOF = YES) ;
      191    11027        %VLP_NAME                               ( FPTN = JOBSTATS_NAME,
      192    11028              STCLASS = CONSTANT,
      193    11029              LEN = 9,
      194    11030              NAME = ':JOBSTATS') ;
      195    11057        %VLP_ACCT                               ( FPTN = JOBSTATS_ACCT,
      196    11058              STCLASS = CONSTANT,
      197    11059              ACCT = ':SYS') ;
      198    11072
      199    11073             /***** Based FPTS *****/
      200    11074        %FPT_WRITE (FPTN=FPT$WRITE,STCLASS=BASED);
      201    11105        %FPT_CLOSE (FPTN=FPT$CLOSE,STCLASS=BASED);
      202    11147        %FPT_FID (FPTN=FPT$FID,STCLASS=BASED);
      203    11170        %FPT_SETFMA (FPTN=FPT$SETFMA,STCLASS=BASED);
      204    11183        %F$DCB (DCBN=F$DCB);
      205    11240             /***** Auto FPTS *****/
      206    11241    1   DCL RESULTS_ VECTOR AUTO;
      207    11242        %FPT_OPEN (FPTN=FPT_OPEN,STCLASS=AUTO);
      208    11351        %FPT_OPEN (FPTN=FPT_OPEN_USE,STCLASS=AUTO);
      209    11460        %FPT_READ (FPTN=FPT_READ_USE,STCLASS=AUTO);
      210    11499        %FPT_READ (FPTN=FPT_READ_JOBINFO,STCLASS=AUTO);
      211    11538        %FPT_CLOSE (FPTN=FPT_CLOSE,STCLASS=AUTO);
      212    11580        %FPT_DELREC (FPTN=FPT_DELREC,STCLASS=AUTO);
      213    11599        %FPT_PFIL (FPTN=FPT_PFIL,STCLASS=AUTO) ;
      214    11614        %FPT_PRECORD (FPTN=FPT_PRECORD,STCLASS=AUTO) ;
      215    11635        %FPT_JOBSTATS (FPTN=FPT_JOBSTATS,STCLASS=AUTO);
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:88   
      216    11655        %FPT_JOBSTATS (FPTN=FPT_JOBSTATS_STATUS,STCLASS=AUTO);
      217    11675        %FPT_JOBSTATS (FPTN=FPT_JOBSTATS_CANCEL,STCLASS=AUTO);
      218    11695        %XSJ_INFOKEY (FPTN=XSJ_INFOKEY,STCLASS=AUTO);
      219    11708        %XSJ_JOBINFO (FPTN=XSJ_JOBINFO,STCLASS=AUTO);
      220    11723        %XSJ_NAMEREC(FPTN=XSJ_NAMEREC,STCLASS=AUTO) ;
      221    11736        %XSJ_NAMEKEY(FPTN=XSJ_NAMEKEY,STCLASS=AUTO) ;
      222    11750        %FPT_WAIT (FPTN=FPT_WAIT,STCLASS=AUTO) ;
      223    11764        %FPT_TIME (FPTN = FPT_TIME,STCLASS=AUTO) ;
      224    11783
      225    11784             /***** Based VLPS *****/
      226    11785
      227    11786        %VLR_JOBSTATS_ISRCH (FPTN=VLR$INPUT,STCLASS=BASED,NJOB=0) ;
      228    11800        %VLA_JOBSTATS_ISRCH (FPTN=VLA$INPUT,STCLASS=BASED) ;
      229    11827        %VLR_JOBSTATS_OSRCH (FPTN=VLR$OUTPUT,STCLASS=BASED,NFIL=0) ;
      230    11841        %VLA_JOBSTATS_OSRCH (FPTN=VLA$OUTPUT,STCLASS=BASED) ;
      231    11858        %VLP_VECTOR(FPTN=B$$VECTOR,STCLASS=BASED) ;
      232    11873             /***** Auto VLPS *****/
      233    11874        %VLP_ACCT (FPTN=FID_ACCT,STCLASS=AUTO);
      234    11887        %VLP_CRITERIA (FPTN=Q_CRITERIA,STCLASS=AUTO) ;
      235    11915        %VLP_CRITERIA (FPTN=SYSID_CRITERIA,STCLASS=AUTO) ;
      236    11943        %VLP_JOBNAME (FPTN=VLP_JOBNAME,STCLASS=AUTO);
      237    11957        %VLR_JOBSTATS_CHECK (FPTN=VLR_JOBSTATS_CHECK,STCLASS=AUTO);
      238    11976        %VLP_NAME (FPTN=FID_NAME,LEN=31,STCLASS=AUTO);
      239    12003        %VLP_SN (FPTN=FID_SN,STCLASS=AUTO);
      240    12016        %VLR_FID (FPTN=FID$RESULTS,STCLASS=BASED);
      241    12035             /***** Error codes *****/
      242    12036                   %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:89   
      243    12037        /*         Parsing macros                        */
      244    12038        %PLIST;
      245    12039        %PARSE$OUT(NAME=P$B,STCLASS=BASED);
      246    12084        %PARSE$SYM(NAME=P$S,STCLASS=BASED);
      247    12122        %P$PCB(NAME=P$PCB,STCLASS="");
      248    12323                   %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:90   
      249    12324        /*********************************************************************/
      250    12325        /*F*   NAME:   CPK$CHECK
      251    12326               PURPOSE: To process the CHECK command
      252    12327               DESCRIPTION: The CHECK command permits a user to check a job(s)
      253    12328                       identified by a sysid(s), job names, or all jobs in a specified
      254    12329                       account.
      255    12330               REFERENCE: Programmers Reference Manual
      256    12331        */
      257    12332        /*D*   NAME:   CPK$CHECK
      258    12333               CALL:   CALL CPK$CHECK (P$PCB)
      259    12334               INTERFACE: SETUP_FID
      260    12335               INPUT:  P$PCB - parse control block framing command.
      261    12336               OUTPUT:
      262    12337               DESCRIPTION: The CHECK command is scanned and the jobstats pmme
      263    12338                       initialized with the appropriate information.
      264    12339        */
      265    12340        /*********************************************************************/
      266    12341
      267    12342    1         IF ADDR(P$PCB) = ADDR(NIL) AND

  12342  2 000002   200003 236100                    LDQ     @P$PCB,,AUTO
         2 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000004   000012 601000 2                  TNZ     s:12349
         2 000005   000000 470400 xsym               LDP0    B$JIT$
         2 000006   000143 236100                    LDQ     99,,PR0
         2 000007   000040 316003                    CANQ    32,DU
         2 000010   000012 601000 2                  TNZ     s:12349

      268    12343    1             NOT B$JIT.CPFLAGS1.SOMENOTIFY
      269    12344    1             THEN RETURN ;

  12344  2 000011   000000 702200 xent               TSX2  ! X66_ARET

      270    12345                                              /* CHECK called at JOBSTEP time,
      271    12346                                                  but there is nothing to report
      272    12347                                                  about. Therefore, return.
      273    12348                                              */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:91   
      274    12349    1         CMD_TYPE = %CHECK_CMD# ;

  12349  2 000012   200164 450100                    STZ     CMD_TYPE,,AUTO

      275    12350
      276    12351    1         GOTO COMMON_CODE ;

  12351  2 000013   000050 710000 2                  TRA     COMMON_CODE

      277    12352
      278    12353        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:92   
      279    12354        /*********************************************************************/
      280    12355        /*F*   NAME:   CPK$CANCEL
      281    12356               PURPOSE: To process the CANCE Lcoommand
      282    12357               DESCRIPTION: The CANCEL command permits a user to cancel a job(s)
      283    12358                       identified by a sysid(s), job names, or all jobs in a specified
      284    12359                       account.
      285    12360               REFERENCE: Programmers Reference Manual
      286    12361        */
      287    12362        /*D*   NAME:   CPK$CANCEL
      288    12363               CALL:   CALL CPK$CANCEL (P$PCB)
      289    12364               INPUT:  P$PCB - parse control block framing command.
      290    12365               OUTPUT:
      291    12366               DESCRIPTION: The CANCEL command is scanned and the jobstats pmme
      292    12367                       initialized with the appropriate information.
      293    12368        */
      294    12369        /*********************************************************************/
      295    12370
      296    12371    1   CPK$CANCEL: ENTRY (P$PCB) ALTRET;

  12371  2 000014   000000 700200 xent  CPK$CANCEL   TSX0  ! X66_AUTO_1
         2 000015   001364 000001                    ZERO    756,1

      297    12372        /**/
      298    12373    1         CMD_TYPE = %CANCEL_CMD# ;

  12373  2 000016   000003 235007                    LDA     3,DL
         2 000017   200164 755100                    STA     CMD_TYPE,,AUTO

      299    12374
      300    12375    1         GOTO COMMON_CODE ;

  12375  2 000020   000050 710000 2                  TRA     COMMON_CODE

      301    12376
      302    12377        %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:93   
      303    12378        /*********************************************************************/
      304    12379        /*F*       NAME:    CPK$SUBMIT_CHECK
      305    12380                   PURPOSE: To process the CHECK of a BATCH job that was submitted.
      306    12381               REFERENCE: Programmers Reference Manual
      307    12382        */
      308    12383        /*D*   NAME:   CPK$SUBMIT_CHECK
      309    12384               CALL:   CALL CPK$SUBMIT_CHECK (P$PCB)
      310    12385               INPUT:  P$PCB - parse control block framing command.
      311    12386                       P$PCB.OUT$->P$B.TEMP - is the NSTATUS flag value.
      312    12387                   DESCRIPTION:   If NSTATUS is set, just output and remember
      313    12388                            the JOB SUBMITTED message.  Otherwise do a CHECK
      314    12389                            for this SYSID.  If not found, output JOB SUBMITTED
      315    12390                            message and remember in USE file.
      316    12391        */
      317    12392        /*********************************************************************/
      318    12393    1   CPK$SUBMIT_CHECK:
      319    12394    1     ENTRY(P$PCB)   ALTRET;

  12394  2 000021   000000 700200 xent  CPK$SUBMIT_* TSX0  ! X66_AUTO_1
         2 000022   001364 000001                    ZERO    756,1

      320    12395        /**/
      321    12396    1         CMD_TYPE = %SUBMIT_CMD# ;

  12396  2 000023   000002 235007                    LDA     2,DL
         2 000024   200164 755100                    STA     CMD_TYPE,,AUTO

      322    12397                  /*  P$B.TEMP passes the NSTATUS_OPT# to CPK$SUBMIT_CHECK.
      323    12398                      P$B.SUBLK$(0)->P$B.TEMP indicate that this is  across
      324    12399                                account batch job.
      325    12400                  */
      326    12401    1         NSTATUS_FLG = P$PCB.OUT$->P$B.TEMP ;

  12401  2 000025   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000026   000003 471500                    LDP1    3,,PR0
         2 000027   100000 236100                    LDQ     0,,PR1
         2 000030   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:94   
         2 000031   200126 756100                    STQ     NSTATUS_FLG,,AUTO

      327    12402    1         CROSS_ACCT_BATCH_FLG = P$PCB.OUT$->P$B.SUBLK$(0)->P$B.TEMP ;

  12402  2 000032   100003 473500                    LDP3    3,,PR1
         2 000033   300000 236100                    LDQ     0,,PR3
         2 000034   400000 376003                    ANQ     -131072,DU
         2 000035   200127 756100                    STQ     CROSS_ACCT_BATCH_FLG,,AUTO

      328    12403    1         GOTO COMMON_CODE ;

  12403  2 000036   000050 710000 2                  TRA     COMMON_CODE

      329    12404        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:95   
      330    12405        /*********************************************************************/
      331    12406        /*F*       NAME:    CPK$NOTIFY
      332    12407                   PURPOSE: To process the NOTIFY command
      333    12408               REFERENCE: Programmers Reference Manual
      334    12409        */
      335    12410        /*D*   NAME:   CPK$NOTIFY
      336    12411               CALL:   CALL CPK$NOTIFY (P$PCB)
      337    12412               INPUT:  P$PCB - parse control block framing command.
      338    12413                   DESCRIPTION:   Sets A bit in CPFLAGS1 so that after each
      339    12414                            JOBSTEP the user will be notified of changes in
      340    12415                            status of his BATCH jobs.
      341    12416        */
      342    12417        /*********************************************************************/
      343    12418    1   CPK$NOTIFY:
      344    12419    1     ENTRY(P$PCB)   ALTRET;

  12419  2 000037   000000 700200 xent  CPK$NOTIFY   TSX0  ! X66_AUTO_1
         2 000040   001364 000001                    ZERO    756,1

      345    12420        /**/
      346    12421    1         CMD_TYPE = %NOTIFY_CMD# ;

  12421  2 000041   000001 235007                    LDA     1,DL
         2 000042   200164 755100                    STA     CMD_TYPE,,AUTO

      347    12422    1         B$JIT.CPFLAGS1.NOTIFY = %YES# ;

  12422  2 000043   000000 470400 xsym               LDP0    B$JIT$
         2 000044   002000 236007                    LDQ     1024,DL
         2 000045   000143 256100                    ORSQ    99,,PR0

      348    12423    1         B$JIT.CPFLAGS1.SOMENOTIFY = %YES# ;

  12423  2 000046   000040 236003                    LDQ     32,DU
         2 000047   000143 256100                    ORSQ    99,,PR0

      349    12424        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:96   
      350    12425    1   COMMON_CODE:
      351    12426        /*
      352    12427             ***** Init FPT_JOBSTATS for CHECK function...
      353    12428        */
      354    12429    1         FPT_JOBSTATS=CFPT_JOBSTATS;

  12429  2 000050   000100 100400       COMMON_CODE  MLR     fill='000'O
         2 000051   000000 000220 xsym               ADSC9   CFPT_JOBSTATS            cn=0,n=144
         2 000052   200760 000220                    ADSC9   FPT_JOBSTATS,,AUTO       cn=0,n=144

      355    12430    1         FPT_JOBSTATS.V_=VECTOR(FPT_JOBSTATS.V);

  12430  2 000053   000000 235000 3                  LDA     0
         2 000054   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000055   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000056   001010 036003                    ADLQ    520,DU
         2 000057   200760 757100                    STAQ    FPT_JOBSTATS,,AUTO

      356    12431        /*
      357    12432             ***** Init FPT_JOBSTATS_CANCEL
      358    12433        */
      359    12434    1         FPT_JOBSTATS_CANCEL = CFPT_JOBSTATS;

  12434  2 000060   000100 100400                    MLR     fill='000'O
         2 000061   000000 000220 xsym               ADSC9   CFPT_JOBSTATS            cn=0,n=144
         2 000062   201070 000220                    ADSC9   FPT_JOBSTATS_CANCEL,,AUTO cn=0,n=144

      360    12435    1         FPT_JOBSTATS_CANCEL.V_ = VECTOR(FPT_JOBSTATS_CANCEL.V);

  12435  2 000063   000000 235000 3                  LDA     0
         2 000064   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000065   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000066   001120 036003                    ADLQ    592,DU
         2 000067   201070 757100                    STAQ    FPT_JOBSTATS_CANCEL,,AUTO

      361    12436    1         FPT_JOBSTATS_CANCEL.V.OUTPUT# = %YES#;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:97   
  12436  2 000070   400000 236003                    LDQ     -131072,DU
         2 000071   201123 256100                    ORSQ    FPT_JOBSTATS_CANCEL+27,,AUTO

      362    12437        /*
      363    12438           ***** Init FPT_CLOSE for future closes.
      364    12439        */
      365    12440    1         FPT_CLOSE = CFPT_CLOSE ;

  12440  2 000072   000100 100400                    MLR     fill='000'O
         2 000073   000000 000170 xsym               ADSC9   CFPT_CLOSE               cn=0,n=120
         2 000074   200672 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

      366    12441    1         FPT_CLOSE.V_ = VECTOR(FPT_CLOSE.V) ;

  12441  2 000075   000001 235000 3                  LDA     1
         2 000076   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000077   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000100   000724 036003                    ADLQ    468,DU
         2 000101   200672 757100                    STAQ    FPT_CLOSE,,AUTO

      367    12442    1         FPT_CLOSE.V.DISP# = %SAVE# ;

  12442  2 000102   000002 236007                    LDQ     2,DL
         2 000103   200724 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      368    12443        /*
      369    12444           ***** Init FPT_OPEN_USE for future opens.
      370    12445        */
      371    12446    1         FPT_OPEN_USE = CFPT_OPEN ;

  12446  2 000104   000100 100400                    MLR     fill='000'O
         2 000105   000000 000350 xsym               ADSC9   CFPT_OPEN                cn=0,n=232
         2 000106   200544 000350                    ADSC9   FPT_OPEN_USE,,AUTO       cn=0,n=232

      372    12447    1         FPT_OPEN_USE.V_ = VECTOR(FPT_OPEN_USE.V) ;

  12447  2 000107   000002 235000 3                  LDA     2
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:98   
         2 000110   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000111   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000112   000610 036003                    ADLQ    392,DU
         2 000113   200544 757100                    STAQ    FPT_OPEN_USE,,AUTO

      373    12448    1         FPT_OPEN_USE.V.DCB# = M$IBEX_NUM ;

  12448  2 000114   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 000115   200610 740100                    STX0    FPT_OPEN_USE+36,,AUTO

      374    12449    1         FPT_OPEN_USE.V.ORG# = %KEYED# ;

  12449  2 000116   002000 236007                    LDQ     1024,DL
         2 000117   200612 552110                    STBQ    FPT_OPEN_USE+38,'10'O,AUTO

      375    12450    1         FPT_OPEN_USE.V.ACS# = %DIRECT# ;

  12450  2 000120   000002 236007                    LDQ     2,DL
         2 000121   200612 552104                    STBQ    FPT_OPEN_USE+38,'04'O,AUTO

      376    12451    1         FPT_OPEN_USE.V.SHARE# = %ALL# ;

  12451  2 000122   200610 236100                    LDQ     FPT_OPEN_USE+36,,AUTO
         2 000123   000003 376000 3                  ANQ     3
         2 000124   000010 276007                    ORQ     8,DL
         2 000125   200610 756100                    STQ     FPT_OPEN_USE+36,,AUTO

      377    12452        /*
      378    12453           ***** Init FPT_READ_JOBINFO for future reads.
      379    12454        */
      380    12455    1         FPT_READ_JOBINFO = CFPT_READ ;

  12455  2 000126   000100 100400                    MLR     fill='000'O
         2 000127   000000 000070 xsym               ADSC9   CFPT_READ                cn=0,n=56
         2 000130   200654 000070                    ADSC9   FPT_READ_JOBINFO,,AUTO   cn=0,n=56

      381    12456    1         FPT_READ_JOBINFO.V_ = VECTOR(FPT_READ_JOBINFO.V) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:99   

  12456  2 000131   000004 235000 3                  LDA     4
         2 000132   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000133   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000134   000664 036003                    ADLQ    436,DU
         2 000135   200654 757100                    STAQ    FPT_READ_JOBINFO,,AUTO

      382    12457    1         FPT_READ_JOBINFO.V.DCB# = M$IBEX1_NUM ;

  12457  2 000136   000000 721000 xsym               LXL1    M$IBEX1_NUM
         2 000137   200664 741100                    STX1    FPT_READ_JOBINFO+8,,AUTO

      383    12458    1         FPT_READ_JOBINFO.V.KEYS# = %YES# ;

  12458  2 000140   200000 236007                    LDQ     65536,DL
         2 000141   200664 256100                    ORSQ    FPT_READ_JOBINFO+8,,AUTO

      384    12459        /*
      385    12460           ***** Init FPT_PFIL for future BOFs.
      386    12461        */
      387    12462    1         FPT_PFIL = CFPT_PFIL ;

  12462  2 000142   000100 100400                    MLR     fill='000'O
         2 000143   000266 000020 1                  ADSC9   CFPT_PFIL                cn=0,n=16
         2 000144   200742 000020                    ADSC9   FPT_PFIL,,AUTO           cn=0,n=16

      388    12463    1         FPT_PFIL.V_ = VECTOR(FPT_PFIL.V) ;

  12463  2 000145   000005 235000 3                  LDA     5
         2 000146   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000147   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000150   000744 036003                    ADLQ    484,DU
         2 000151   200742 757100                    STAQ    FPT_PFIL,,AUTO

      389    12464    1         FPT_PFIL.V.DCB# = M$IBEX_NUM ;

  12464  2 000152   200744 740100                    STX0    FPT_PFIL+2,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:100  

      390    12465        /*
      391    12466           ***** Init FPT_PRECORD for future positioning.
      392    12467        */
      393    12468    1         FPT_PRECORD = CFPT_PRECORD ;

  12468  2 000153   000100 100400                    MLR     fill='000'O
         2 000154   000000 000050 xsym               ADSC9   CFPT_PRECORD             cn=0,n=40
         2 000155   200746 000050                    ADSC9   FPT_PRECORD,,AUTO        cn=0,n=40

      394    12469    1         FPT_PRECORD.V_ = VECTOR(FPT_PRECORD.V) ;

  12469  2 000156   000001 235000 3                  LDA     1
         2 000157   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000160   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000161   000754 036003                    ADLQ    492,DU
         2 000162   200746 757100                    STAQ    FPT_PRECORD,,AUTO

      395    12470    1         FPT_PRECORD.V.DCB# = M$IBEX_NUM ;

  12470  2 000163   200754 740100                    STX0    FPT_PRECORD+6,,AUTO

      396    12471    1         FPT_PRECORD.KEY_ = VECTOR(CHKEYBUF) ;

  12471  2 000164   000006 235000 3                  LDA     6
         2 000165   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000166   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000167   000336 036003                    ADLQ    222,DU
         2 000170   200750 757100                    STAQ    FPT_PRECORD+2,,AUTO

      397    12472    1         FPT_PRECORD.V.KEYS# = %YES# ;

  12472  2 000171   400000 236007                    LDQ     -131072,DL
         2 000172   200754 256100                    ORSQ    FPT_PRECORD+6,,AUTO

      398    12473    1         FPT_PRECORD.V.KEYR# = %YES# ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:101  
  12473  2 000173   200000 236007                    LDQ     65536,DL
         2 000174   200754 256100                    ORSQ    FPT_PRECORD+6,,AUTO

      399    12474        /*
      400    12475           ***** Other inits that need to be done.
      401    12476        */
      402    12477    1         FID_ACCT.ACCT# = ' ' ;

  12477  2 000175   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000176   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000177   201200 757100                    STAQ    FID_ACCT,,AUTO

      403    12478    1         CMDSTRM_CLOSED# = %NO# ;

  12478  2 000200   200122 450100                    STZ     CMDSTRM_CLOSED#,,AUTO

      404    12479    1         REMEMBER E_DONT_POSTERR IN BAD_USEFILE_REMEM ;

  12479  2 000201   001634 635000 2                  EAA     E_DONT_POSTERR
         2 000202   200160 452500                    STP2    BAD_USEFILE_REMEM,,AUTO
         2 000203   200161 755100                    STA     BAD_USEFILE_REMEM+1,,AUTO

      405    12480        /*
      406    12481           ***** Get rid of any errors that we know about.
      407    12482        */
      408    12483    1         ADDR(SEG$2.ERRBUF)->ERR$BLK.FIRST = 0 ;

  12483  2 000204   000000 470400 xsym               LDP0    SEG2$
         2 000205   000004 450100                    STZ     4,,PR0

      409    12484    1         ADDR(SEG$2.ERRBUF)->ERR$BLK.NEXT = 0 ;

  12484  2 000206   000005 450100                    STZ     5,,PR0

      410    12485        /*
      411    12486           ***** DCBs used by CHECK.
      412    12487
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:102  
      413    12488              *S        file - M$IBEX1
      414    12489              :JOBSTATS file - M$IBEX1
      415    12490              *$$JOB    file - M$IBEX
      416    12491              Output    fid  - M$LL/M$IBEX2
      417    12492         */
      418    12493        /*
      419    12494             ***** Get the NOTIFY defaults ...
      420    12495        */
      421    12496    1         CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(E_DONT_POSTERR);

  12496  2 000207   000007 630400 3                  EPPR0   7
         2 000210   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000211   000000 701000 xent               TSX1    CPC$OPEN_S
         2 000212   001634 702000 2                  TSX2    E_DONT_POSTERR

      422    12497    1         CALL CPC$GETSEG (SEG4$,3072) ALTRET(E_CHKSEG);

  12497  2 000213   000011 630400 3                  EPPR0   9
         2 000214   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000215   000000 701000 xent               TSX1    CPC$GETSEG
         2 000216   000227 702000 2                  TSX2    E_CHKSEG

      423    12498    1         RESULTS_ = VECTOR (PINCRW(SEG4$,2048)->B$$PAGE);

  12498  2 000217   000013 235000 3                  LDA     11
         2 000220   000000 236000 xsym               LDQ     SEG4$
         2 000221   004000 036003                    ADLQ    2048,DU
         2 000222   200450 757100                    STAQ    RESULTS_,,AUTO

      424    12499    1         CALL CPC$OPEN_LL ;

  12499  2 000223   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000224   000000 701000 xent               TSX1    CPC$OPEN_LL
         2 000225   000000 011000                    NOP     0

      425    12500    2         DO WHILE (%NO#);

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:103  
  12500  2 000226   000233 710000 2                  TRA     s:12504

      426    12501    2   E_CHKSEG:   /* Screech */
      427    12502    2             CALL CPC$SCREECH (E$SUASEG,CPB$IBEXMID);

  12502  2 000227   000016 630400 3     E_CHKSEG     EPPR0   14
         2 000230   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000231   000000 701000 xent               TSX1    CPC$SCREECH
         2 000232   000000 011000                    NOP     0

      428    12503    2         END;

      429    12504    1         JOBSTATS_OPEN# = %NO#;

  12504  2 000233   200120 450100                    STZ     JOBSTATS_OPEN#,,AUTO

      430    12505    1         USEFID_OPEN# = %NO#;

  12505  2 000234   200121 450100                    STZ     USEFID_OPEN#,,AUTO

      431    12506    1         SYSTEM_OK# = %NO# ;

  12506  2 000235   200125 450100                    STZ     SYSTEM_OK#,,AUTO

      432    12507    1         SYSIDBUF = %NO# ;

  12507  2 000236   000100 100400                    MLR     fill='000'O
         2 000237   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000240   200344 000113                    ADSC9   SYSIDBUF,,AUTO           cn=0,n=75

      433    12508    1         CALL CPJ$READ_S (M$IBEX1_NUM,VECTOR(K_NOTIFY),VECTOR(CP_CHFLAGS))

  12508  2 000241   000022 235000 3                  LDA     18
         2 000242   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000243   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000244   000167 036003                    ADLQ    119,DU
         2 000245   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:104  
         2 000246   201346 630500                    EPPR0   LFPT_PRECORD+12,,AUTO
         2 000247   201352 450500                    STP0    LFPT_PRECORD+16,,AUTO
         2 000250   000024 237000 3                  LDAQ    20
         2 000251   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 000252   201350 630500                    EPPR0   LFPT_PRECORD+14,,AUTO
         2 000253   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000254   000000 701000 xent               TSX1    CPJ$READ_S
         2 000255   000275 702000 2                  TSX2    E_READ_CHECK

      434    12509    1                         ALTRET(E_READ_CHECK) ;
      435    12510                                                              /* Check to see about
      436    12511                                                                   SYSTEM flag. */
      437    12512    1         IF CP_CHFLAGS.SYSTEM AND (B$JIT.PRIV.AUTH & %PR_DISPJOB#)

  12512  2 000256   200217 236100                    LDQ     CP_CHFLAGS+24,,AUTO
         2 000257   400000 316007                    CANQ    -131072,DL
         2 000260   000274 600000 2                  TZE     s:12523
         2 000261   000000 470400 xsym               LDP0    B$JIT$
         2 000262   000014 236100                    LDQ     12,,PR0
         2 000263   000026 376000 xsym               ANQ     B_VECTNIL+22
         2 000264   000274 600000 2                  TZE     s:12523

      438    12513    1             THEN                                            /* Check DISPJOB priv. */
      439    12514    2               CALL M$SPRIV(FPT_PRIV_DISPJOB) WHENRETURN DO;

  12514  2 000265   000160 630400 1                  EPPR0   FPT_PRIV_DISPJOB
         2 000266   420012 713400                    CLIMB   alt,+8202
         2 000267   400000 401760                    pmme    nvectors=1
         2 000270   000274 702000 2                  TSX2    s:12523

      440    12515    2                                                 SYSTEM_OK# = %YES# ;

  12515  2 000271   400000 236003                    LDQ     -131072,DU
         2 000272   200125 756100                    STQ     SYSTEM_OK#,,AUTO

      441    12516    2                                               END;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:105  
  12516  2 000273   000274 710000 2                  TRA     s:12523

      442    12517    2                                               WHENALTRETURN DO;

      443    12518    2                                               END;

      444    12519        /*
      445    12520             *****  Not the first time CHECK or NOTIFY has been called.
      446    12521        */
      447    12522
      448    12523    2         DO WHILE (%NO#);

  12523  2 000274   000306 710000 2                  TRA     s:12535

      449    12524    2   E_READ_CHECK:
      450    12525    2            IF B$JIT.USRERR.CODE ~= %E$NOKEY

  12525  2 000275   000000 470400 xsym  E_READ_CHECK LDP0    B$JIT$
         2 000276   000144 236100                    LDQ     100,,PR0
         2 000277   377770 376007                    ANQ     131064,DL
         2 000300   001020 116007                    CMPQ    528,DL
         2 000301   001615 601000 2                  TNZ     E_CHECK

      451    12526    2                THEN   /* Trouble */
      452    12527    2                  GOTO E_CHECK;
      453    12528                            /* No NOTIFY record yet. */
      454    12529    2            CP_CHFLAGS = CP_C_CHFLAGS ;

  12529  2 000302   000100 100400                    MLR     fill='000'O
         2 000303   000013 000540 1                  ADSC9   CP_C_CHFLAGS             cn=0,n=352
         2 000304   200167 000540                    ADSC9   CP_CHFLAGS,,AUTO         cn=0,n=352

      455    12530    2            B$JIT.USRERR = '0'B ;

  12530  2 000305   000144 450100                    STZ     100,,PR0

      456    12531    2         END ; /* DO WHILE */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:106  

      457    12532        /*
      458    12533           ***** Init CP_FIDVLPS for future use.
      459    12534        */
      460    12535    1         CP_FIDVLPS.FID_ACCT_ = VECTOR(CP_CHFLAGS.USE_ACCT) ;

  12535  2 000306   000005 235000 3                  LDA     5
         2 000307   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000310   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000311   000167 036003                    ADLQ    119,DU
         2 000312   200320 757100                    STAQ    CP_FIDVLPS,,AUTO

      461    12536    1         CP_FIDVLPS.FID_NAME_ = VECTOR(CP_CHFLAGS.USE_NAME) ;

  12536  2 000313   000023 235000 3                  LDA     19
         2 000314   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000315   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000316   000171 036003                    ADLQ    121,DU
         2 000317   200322 757100                    STAQ    CP_FIDVLPS+2,,AUTO

      462    12537    1         CP_FIDVLPS.FID_PASS_ = VECTOR(CP_CHFLAGS.USE_PASS) ;

  12537  2 000320   000005 235000 3                  LDA     5
         2 000321   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000322   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000323   000201 036003                    ADLQ    129,DU
         2 000324   200324 757100                    STAQ    CP_FIDVLPS+4,,AUTO

      463    12538    1         CP_FIDVLPS.FID_WSN_ = VECTOR(CP_CHFLAGS.USE_WSN) ;

  12538  2 000325   000005 235000 3                  LDA     5
         2 000326   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000327   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000330   000203 036003                    ADLQ    131,DU
         2 000331   200326 757100                    STAQ    CP_FIDVLPS+6,,AUTO

      464    12539    1         CP_FIDVLPS.FID_SN_ = VECTOR(CP_CHFLAGS.USE_SN) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:107  

  12539  2 000332   000026 235000 3                  LDA     22
         2 000333   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 000334   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 000335   000207 036003                    ADLQ    135,DU
         2 000336   200330 757100                    STAQ    CP_FIDVLPS+8,,AUTO

      465    12540    1         CP_FIDVLPS.FID_RES = CP_CHFLAGS.USE_RES ;

  12540  2 000337   200216 236100                    LDQ     CP_CHFLAGS+23,,AUTO
         2 000340   777777 376003                    ANQ     -1,DU
         2 000341   040040 276007                    ORQ     16416,DL
         2 000342   200334 756100                    STQ     CP_FIDVLPS+12,,AUTO

      466    12541    1         CP_FIDVLPS.FID_ASN = CP_CHFLAGS.USE_ASN ;

  12541  2 000343   200216 236100                    LDQ     CP_CHFLAGS+23,,AUTO
         2 000344   000022 736000                    QLS     18
         2 000345   200335 552140                    STBQ    CP_FIDVLPS+13,'40'O,AUTO

      467    12542    1         CP_FIDVLPS.FID_RESULTS = CP_CHFLAGS.USE_RESULTS ;

  12542  2 000346   000100 100500                    MLR     fill='000'O
         2 000347   200205 000010                    ADSC9   CP_CHFLAGS+14,,AUTO      cn=0,n=8
         2 000350   200332 000010                    ADSC9   CP_FIDVLPS+10,,AUTO      cn=0,n=8

      468    12543        /*
      469    12544             ***** Code to support CHECK called because of NOTIFY ...
      470    12545        */
      471    12546    1         IF ADDR(P$PCB) = ADDR(NIL)

  12546  2 000351   200003 236100                    LDQ     @P$PCB,,AUTO
         2 000352   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000353   000522 601000 2                  TNZ     s:12609

      472    12547    1           THEN
      473    12548    2             DO;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:108  

      474    12549    2               IF NOT B$JIT.CPFLAGS1.SOMENOTIFY

  12549  2 000354   000000 470400 xsym               LDP0    B$JIT$
         2 000355   000143 236100                    LDQ     99,,PR0
         2 000356   000040 316003                    CANQ    32,DU
         2 000357   001313 600000 2                  TZE     CHECK_CLEANUP

      475    12550    2                 THEN
      476    12551    2                   GOTO CHECK_CLEANUP;
      477    12552    2            NOTIFYING = %YES# ;

  12552  2 000360   400000 236003                    LDQ     -131072,DU
         2 000361   200137 756100                    STQ     NOTIFYING,,AUTO

      478    12553    2            IF (CP_CHFLAGS.FLG.SRCHQS)

  12553  2 000362   200220 236100                    LDQ     CP_CHFLAGS+25,,AUTO
         2 000363   400000 316007                    CANQ    -131072,DL
         2 000364   000467 600000 2                  TZE     s:12585

      479    12554    2               THEN
      480    12555    3                 DO ;                            /* Input, Running, or Output. */

      481    12556    3                   NOTIFY_Q_FLAGS(0) = CP_CHFLAGS.FLG.INPUT ;

  12556  2 000365   000026 736000                    QLS     22
         2 000366   200141 676100                    ERQ     NOTIFY_Q_FLAGS,,AUTO
         2 000367   400000 376003                    ANQ     -131072,DU
         2 000370   200141 656100                    ERSQ    NOTIFY_Q_FLAGS,,AUTO

      482    12557    3                   NOTIFY_Q_FLAGS(1) = CP_CHFLAGS.FLG.RUNNING ;

  12557  2 000371   200220 236100                    LDQ     CP_CHFLAGS+25,,AUTO
         2 000372   000027 736000                    QLS     23
         2 000373   200141 676100                    ERQ     NOTIFY_Q_FLAGS,,AUTO
         2 000374   200000 376003                    ANQ     65536,DU
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:109  
         2 000375   200141 656100                    ERSQ    NOTIFY_Q_FLAGS,,AUTO

      483    12558    3                   NOTIFY_Q_FLAGS(2) = CP_CHFLAGS.FLG.OUTPUT ;

  12558  2 000376   200220 236100                    LDQ     CP_CHFLAGS+25,,AUTO
         2 000377   000025 736000                    QLS     21
         2 000400   200141 676100                    ERQ     NOTIFY_Q_FLAGS,,AUTO
         2 000401   100000 376003                    ANQ     32768,DU
         2 000402   200141 656100                    ERSQ    NOTIFY_Q_FLAGS,,AUTO

      484    12559
      485    12560    4                   DO I = 0 TO 2 ;

  12560  2 000403   200144 450100                    STZ     I,,AUTO

      486    12561    4                     IF NOTIFY_Q_FLAGS(I)

  12561  2 000404   200144 235100                    LDA     I,,AUTO
         2 000405   000407 605000 2                  TPL     s:12561+3
         2 000406   000044 035003                    ADLA    36,DU
         2 000407   000000 066505                    CMPB    filb='0'B
         2 000410   200141 000001                    BDSC    NOTIFY_Q_FLAGS,A,AUTO    by=0,bit=0,n=1
         2 000411   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000412   000463 600000 2                  TZE     E_DONE_NOTIFYQ

      487    12562    4                       THEN
      488    12563    5                         DO ;

      489    12564    6                           DO CASE(I) ;

  12564  2 000413   200144 235100                    LDA     I,,AUTO
         2 000414   000003 115007                    CMPA    3,DL
         2 000415   000417 602005 2                  TNC     s:12564+4,AL
         2 000416   000447 710000 2                  TRA     s:12577
         2 000417   000422 710000 2                  TRA     s:12566
         2 000420   000432 710000 2                  TRA     s:12570
         2 000421   000442 710000 2                  TRA     s:12574
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:110  

      490    12565    6                             CASE(0) ;

      491    12566    6                               CMD_CODE = %CH_INPUT ;

  12566  2 000422   000007 236007                    LDQ     7,DL
         2 000423   200154 756100                    STQ     CMD_CODE,,AUTO

      492    12567    6                               Q_CRITERIA = CP_CHFLAGS.I_CRITERIA ;

  12567  2 000424   000100 100500                    MLR     fill='000'O
         2 000425   200223 000116                    ADSC9   CP_CHFLAGS+28,,AUTO      cn=0,n=78
         2 000426   201202 000116                    ADSC9   Q_CRITERIA,,AUTO         cn=0,n=78

      493    12568    6                               Q_CRITERIA.RUNNING# = %NO# ;

  12568  2 000427   000027 236000 3                  LDQ     23
         2 000430   201212 356100                    ANSQ    Q_CRITERIA+8,,AUTO
         2 000431   000447 710000 2                  TRA     s:12577

      494    12569    6                             CASE(1) ;

      495    12570    6                               CMD_CODE = %CH_RUN ;

  12570  2 000432   000012 236007                    LDQ     10,DL
         2 000433   200154 756100                    STQ     CMD_CODE,,AUTO

      496    12571    6                               Q_CRITERIA = CP_CHFLAGS.I_CRITERIA ;

  12571  2 000434   000100 100500                    MLR     fill='000'O
         2 000435   200223 000116                    ADSC9   CP_CHFLAGS+28,,AUTO      cn=0,n=78
         2 000436   201202 000116                    ADSC9   Q_CRITERIA,,AUTO         cn=0,n=78

      497    12572    6                               Q_CRITERIA.RUNNING# = %YES# ;

  12572  2 000437   010000 236003                    LDQ     4096,DU
         2 000440   201212 256100                    ORSQ    Q_CRITERIA+8,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:111  
         2 000441   000447 710000 2                  TRA     s:12577

      498    12573    6                             CASE(2) ;

      499    12574    6                               CMD_CODE = %CH_OUTPUT ;

  12574  2 000442   000011 236007                    LDQ     9,DL
         2 000443   200154 756100                    STQ     CMD_CODE,,AUTO

      500    12575    6                               Q_CRITERIA = CP_CHFLAGS.O_CRITERIA ;

  12575  2 000444   000100 100500                    MLR     fill='000'O
         2 000445   200247 000116                    ADSC9   CP_CHFLAGS+48,,AUTO      cn=0,n=78
         2 000446   201202 000116                    ADSC9   Q_CRITERIA,,AUTO         cn=0,n=78

      501    12576    6                             END ; /* DO CASE */

      502    12577    5                             CALL SETUP_Q_SRCH_JOBSTATS ;

  12577  2 000447   002216 701000 2                  TSX1    SETUP_Q_SRCH_JOBSTATS
         2 000450   000000 011000                    NOP     0

      503    12578    5                             CALL GET_JOBSTATS ALTRET(E_DONE_NOTIFYQ) ;

  12578  2 000451   006704 701000 2                  TSX1    GET_JOBSTATS
         2 000452   000463 702000 2                  TSX2    E_DONE_NOTIFYQ

      504    12579    5                             CH_XFORMAT.MSG# = %CP_BLANKLINE_MESS ;

  12579  2 000453   000032 235007                    LDA     26,DL
         2 000454   200412 755100                    STA     CH_XFORMAT,,AUTO

      505    12580    5                             CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  12580  2 000455   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 000456   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 000457   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:112  
         2 000460   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000461   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 000462   000000 011000                    NOP     0

      506    12581    5   E_DONE_NOTIFYQ:
      507    12582    5                         END ; /* THEN DO */

  12582  2 000463                       E_DONE_NOTI* null
      508    12583    4                   END ; /* DO I */

  12583  2 000463   200144 054100                    AOS     I,,AUTO
         2 000464   200144 235100                    LDA     I,,AUTO
         2 000465   000002 115007                    CMPA    2,DL
         2 000466   000404 604400 2                  TMOZ    s:12561

      509    12584    3                 END ; /* THEN DO */

      510    12585    2             IF (CP_CHFLAGS.FLG.TERM)

  12585  2 000467   200220 236100                    LDQ     CP_CHFLAGS+25,,AUTO
         2 000470   040000 316007                    CANQ    16384,DL
         2 000471   000507 600000 2                  TZE     s:12594

      511    12586    2               THEN
      512    12587    3                 DO ;                                         /* Do TERM. */

      513    12588    3                   P_DUMMY = '0'B ;              /* Setup dummy block with */

  12588  2 000472   000100 100400                    MLR     fill='000'O
         2 000473   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000474   200444 000020                    ADSC9   P_DUMMY,,AUTO            cn=0,n=16

      514    12589    3                   P$ = ADDR(P_DUMMY) ;          /* number of sublks = 0 */

  12589  2 000475   200444 630500                    EPPR0   P_DUMMY,,AUTO
         2 000476   200004 450500                    STP0    P$,,AUTO

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:113  
      515    12590    3                   CMD_CODE = %CH_TERM_CMD ;

  12590  2 000477   000003 235007                    LDA     3,DL
         2 000500   200154 755100                    STA     CMD_CODE,,AUTO

      516    12591    3                   TEMP = B$JIT.SYSID ;

  12591  2 000501   000000 471400 xsym               LDP1    B$JIT$
         2 000502   100000 236100                    LDQ     0,,PR1
         2 000503   777777 376007                    ANQ     -1,DL
         2 000504   200147 756100                    STQ     TEMP,,AUTO

      517    12592    3                   CALL SETUP_SYSID_SRCH ALTRET(E_DONT_POSTERR) ;

  12592  2 000505   002264 701000 2                  TSX1    SETUP_SYSID_SRCH
         2 000506   001634 702000 2                  TSX2    E_DONT_POSTERR

      518    12593    3                 END ; /* Then Do */

      519    12594    2             IF (CP_CHFLAGS.FLG.SRCHID)

  12594  2 000507   200220 236100                    LDQ     CP_CHFLAGS+25,,AUTO
         2 000510   200000 316007                    CANQ    65536,DL
         2 000511   000514 600000 2                  TZE     s:12599

      520    12595    2               THEN
      521    12596    3                 DO ;                                         /* Do SYSIDs. */

      522    12597    3                   CALL CHECK_SYSIDS ALTRET(CHECK_CLEANUP) ;

  12597  2 000512   005747 701000 2                  TSX1    CHECK_SYSIDS
         2 000513   001313 702000 2                  TSX2    CHECK_CLEANUP

      523    12598    3                 END ; /* THEN DO */

      524    12599    2             IF (CP_CHFLAGS.FLG.WAIT)

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:114  
  12599  2 000514   200220 236100                    LDQ     CP_CHFLAGS+25,,AUTO
         2 000515   000020 316007                    CANQ    16,DL
         2 000516   000521 600000 2                  TZE     s:12604

      525    12600    2               THEN
      526    12601    3                 DO ;                                    /* WAIT! */

      527    12602    3                   CALL NOTIFY_WAIT ;

  12602  2 000517   004323 701000 2                  TSX1    NOTIFY_WAIT
         2 000520   000000 011000                    NOP     0

      528    12603    3                 END ; /* THEN DO */

      529    12604    2           GOTO CHECK_CLEANUP;

  12604  2 000521   001313 710000 2                  TRA     CHECK_CLEANUP

      530    12605    2         END ; /* IF no PCB */
      531    12606        /*
      532    12607             ***** Normal CHECK ...
      533    12608        */
      534    12609    1         BLK$ = P$PCB.OUT$;

  12609  2 000522   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000523   000003 236100                    LDQ     3,,PR0
         2 000524   200005 756100                    STQ     BLK$,,AUTO

      535    12610    1         NOTIFYING = %NO# ;

  12610  2 000525   200137 450100                    STZ     NOTIFYING,,AUTO

      536    12611        /*
      537    12612             ***** If no arguments, then display SYSIDs ...
      538    12613        */
      539    12614    1         IF (BLK$ -> P$B.NSUBLKS = 0)

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:115  
  12614  2 000526   200005 471500                    LDP1    BLK$,,AUTO
         2 000527   100001 220100                    LDX0    1,,PR1
         2 000530   000545 601000 2                  TNZ     s:12626

      540    12615    1             THEN
      541    12616    1               IF CMD_TYPE = %NOTIFY_CMD#

  12616  2 000531   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 000532   000001 115007                    CMPA    1,DL
         2 000533   000542 601000 2                  TNZ     s:12622

      542    12617    1                 THEN
      543    12618    2                   DO ;                                       /* Set SRCHID flag. */

      544    12619    2                     CP_CHFLAGS.FLG = %NO# ;

  12619  2 000534   000100 100400                    MLR     fill='000'O
         2 000535   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000536   200220 400004                    ADSC9   CP_CHFLAGS+25,,AUTO      cn=2,n=4

      545    12620    2                     CP_CHFLAGS.FLG.SRCHID = %YES# ;

  12620  2 000537   200000 236007                    LDQ     65536,DL
         2 000540   200220 256100                    ORSQ    CP_CHFLAGS+25,,AUTO

      546    12621    2                   END ; /* THEN DO */

  12621  2 000541   001313 710000 2                  TRA     CHECK_CLEANUP

      547    12622    1                 ELSE CALL CHECK_SYSIDS ALTRET(CHECK_CLEANUP) ;

  12622  2 000542   005747 701000 2                  TSX1    CHECK_SYSIDS
         2 000543   001313 702000 2                  TSX2    CHECK_CLEANUP
         2 000544   001313 710000 2                  TRA     CHECK_CLEANUP

      548    12623
      549    12624    1           ELSE                                /* Options specified. */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:116  
      550    12625    2             DO ;

      551    12626    2               FIRST_QFLAG = '1'B ;

  12626  2 000545   400000 236003                    LDQ     -131072,DU
         2 000546   200140 756100                    STQ     FIRST_QFLAG,,AUTO

      552    12627    2               OUTPUT_FLG = '0'B ;     /* Remember output-producing commands */

  12627  2 000547   200142 450100                    STZ     OUTPUT_FLG,,AUTO

      553    12628    2               K = 0;                 /* Flag for multiple ME/SYSTEM options */

  12628  2 000550   200146 450100                    STZ     K,,AUTO

      554    12629    3               DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;

  12629  2 000551   200144 450100                    STZ     I,,AUTO
         2 000552   001004 710000 2                  TRA     s:12697+1

      555    12630                                              /* Do the first level options. */
      556    12631    3                 P$=BLK$->P$B.SUBLK$(I);

  12631  2 000553   200005 470500                    LDP0    BLK$,,AUTO
         2 000554   200144 720100                    LXL0    I,,AUTO
         2 000555   000003 236110                    LDQ     3,X0,PR0
         2 000556   200004 756100                    STQ     P$,,AUTO

      557    12632    3                 CMD_CODE = P$->P$B.CODE ;

  12632  2 000557   200004 471500                    LDP1    P$,,AUTO
         2 000560   100000 236100                    LDQ     0,,PR1
         2 000561   777777 376007                    ANQ     -1,DL
         2 000562   200154 756100                    STQ     CMD_CODE,,AUTO

      558    12633    4                   DO CASE(CMD_CODE);

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:117  
  12633  2 000563   000004 136007                    SBLQ    4,DL
         2 000564   000023 116007                    CMPQ    19,DL
         2 000565   000567 602006 2                  TNC     s:12633+4,QL
         2 000566   001001 710000 2                  TRA     s:12694
         2 000567   000616 710000 2                  TRA     s:12640
         2 000570   000612 710000 2                  TRA     s:12636
         2 000571   001001 710000 2                  TRA     s:12694
         2 000572   001001 710000 2                  TRA     s:12694
         2 000573   001001 710000 2                  TRA     s:12694
         2 000574   001001 710000 2                  TRA     s:12694
         2 000575   001001 710000 2                  TRA     s:12694
         2 000576   001001 710000 2                  TRA     s:12694
         2 000577   001001 710000 2                  TRA     s:12694
         2 000600   001001 710000 2                  TRA     s:12694
         2 000601   001001 710000 2                  TRA     s:12694
         2 000602   001001 710000 2                  TRA     s:12694
         2 000603   001001 710000 2                  TRA     s:12694
         2 000604   001001 710000 2                  TRA     s:12694
         2 000605   001001 710000 2                  TRA     s:12694
         2 000606   001001 710000 2                  TRA     s:12694
         2 000607   001001 710000 2                  TRA     s:12694
         2 000610   001001 710000 2                  TRA     s:12694
         2 000611   000662 710000 2                  TRA     s:12657

      559    12634
      560    12635    4                     CASE (%CH_ME) ;

      561    12636    4                       CP_CHFLAGS.SYSTEM = %NO# ;

  12636  2 000612   000030 236000 3                  LDQ     24
         2 000613   200217 356100                    ANSQ    CP_CHFLAGS+24,,AUTO

      562    12637    4                       K = K + 1;

  12637  2 000614   200146 054100                    AOS     K,,AUTO
         2 000615   001003 710000 2                  TRA     s:12697

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:118  
      563    12638
      564    12639    4                     CASE (%CH_SYSTEM) ;

      565    12640    4                       IF (SYSTEM_OK# = %NO#)

  12640  2 000616   200125 234100                    SZN     SYSTEM_OK#,,AUTO
         2 000617   001003 604000 2                  TMI     s:12697

      566    12641    4                         THEN
      567    12642    4                           IF (B$JIT.PRIV.AUTH & %PR_DISPJOB#)

  12642  2 000620   000000 473400 xsym               LDP3    B$JIT$
         2 000621   300014 236100                    LDQ     12,,PR3
         2 000622   000026 376000 xsym               ANQ     B_VECTNIL+22
         2 000623   000640 600000 2                  TZE     CH_NOPRIV

      568    12643    4                             THEN
      569    12644    4                               CALL M$SPRIV(FPT_PRIV_DISPJOB) WHENRETURN

  12644  2 000624   000160 630400 1                  EPPR0   FPT_PRIV_DISPJOB
         2 000625   420012 713400                    CLIMB   alt,+8202
         2 000626   400000 401760                    pmme    nvectors=1
         2 000627   000637 702000 2                  TSX2    s:12651

      570    12645    5                                   DO;

      571    12646    5                                     IF K = 0

  12646  2 000630   200146 235100                    LDA     K,,AUTO
         2 000631   000634 601000 2                  TNZ     s:12649

      572    12647    5                                       THEN
      573    12648    5                                         CP_CHFLAGS.SYSTEM = %YES# ;

  12648  2 000632   400000 236007                    LDQ     -131072,DL
         2 000633   200217 256100                    ORSQ    CP_CHFLAGS+24,,AUTO

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:119  
      574    12649    5                                     K = K + 1;

  12649  2 000634   200146 054100                    AOS     K,,AUTO

      575    12650    5                                     SYSTEM_OK# = %YES# ;

  12650  2 000635   400000 236003                    LDQ     -131072,DU
         2 000636   200125 756100                    STQ     SYSTEM_OK#,,AUTO

      576    12651    5                                   END ; /* Whenreturn */

  12651  2 000637   001003 710000 2                  TRA     s:12697

      577    12652    4                             ELSE
      578    12653    4   CH_NOPRIV:                  CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),P$->P$B.CPOS,

  12653  2 000640   000000 236000 xsym  CH_NOPRIV    LDQ     SEG2$
         2 000641   000003 036003                    ADLQ    3,DU
         2 000642   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 000643   000007 236000 3                  LDQ     7
         2 000644   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000645   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 000646   000031 236000 3                  LDQ     25
         2 000647   201347 756100                    STQ     LFPT_PRECORD+13,,AUTO
         2 000650   200004 236100                    LDQ     P$,,AUTO
         2 000651   000002 036003                    ADLQ    2,DU
         2 000652   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 000653   201344 634500                    EPPR4   LFPT_PRECORD+10,,AUTO
         2 000654   201345 454500                    STP4    LFPT_PRECORD+11,,AUTO
         2 000655   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 000656   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000657   000000 701000 xent               TSX1    CXP$POSTERR
         2 000660   000000 011000                    NOP     0
         2 000661   001003 710000 2                  TRA     s:12697

      579    12654    4                                         E_CHKNOPRIV,, M$IBEX1_NUM) ;
      580    12655
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:120  
      581    12656    4                     CASE (%CH_USE);

      582    12657    4                       USEFID_OPEN# = %NO# ;

  12657  2 000662   200121 450100                    STZ     USEFID_OPEN#,,AUTO

      583    12658    4                       IF (P$->P$S.NSUBLKS = 0)

  12658  2 000663   100001 221100                    LDX1    1,,PR1
         2 000664   000705 601000 2                  TNZ     s:12666

      584    12659    4                         THEN
      585    12660    5                           DO ;                          /* Use *$$JOB. */

      586    12661    5                             TEMPBUF$ = ADDR(TEMPBUF) ;

  12661  2 000665   200020 633500                    EPPR3   TEMPBUF,,AUTO
         2 000666   200011 453500                    STP3    TEMPBUF$,,AUTO

      587    12662    5                             TEMPBUF$ -> P$S.COUNT = 6 ;

  12662  2 000667   006000 236003                    LDQ     3072,DU
         2 000670   300004 552140                    STBQ    4,'40'O,PR3

      588    12663    5                             TEMPBUF$ -> P$S.TEXT = '*$$JOB' ;

  12663  2 000671   200011 473500                    LDP3    TEMPBUF$,,AUTO
         2 000672   300004 236100                    LDQ     4,,PR3
         2 000673   000033 772000                    QRL     27
         2 000674   000000 621006                    EAX1    0,QL
         2 000675   040140 100400                    MLR     fill='040'O
         2 000676   000277 000006 1                  ADSC9   JOBSTATS_ACCT+2          cn=0,n=6
         2 000677   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1

      589    12664    5                             TEMPBUF$ -> P$S.TEXTC$ = ADDR(TEMPBUF$->P$S.COUNT) ;

  12664  2 000700   200011 236100                    LDQ     TEMPBUF$,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:121  
         2 000701   000004 036003                    ADLQ    4,DU
         2 000702   200011 473500                    LDP3    TEMPBUF$,,AUTO
         2 000703   300003 756100                    STQ     3,,PR3

      590    12665    5                           END ; /* THEN DO */

  12665  2 000704   000707 710000 2                  TRA     s:12667

      591    12666    4                         ELSE TEMPBUF$ = P$->P$S.TEXTC$ ;

  12666  2 000705   100003 236100                    LDQ     3,,PR1
         2 000706   200011 756100                    STQ     TEMPBUF$,,AUTO

      592    12667    4                       CALL CPC$FID_VLP(,TEMPBUF$,CP_FIDVLPS)

  12667  2 000707   200320 633500                    EPPR3   CP_FIDVLPS,,AUTO
         2 000710   201346 453500                    STP3    LFPT_PRECORD+12,,AUTO
         2 000711   200011 634500                    EPPR4   TEMPBUF$,,AUTO
         2 000712   201345 454500                    STP4    LFPT_PRECORD+11,,AUTO
         2 000713   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000714   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 000715   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 000716   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000717   000000 701000 xent               TSX1    CPC$FID_VLP
         2 000720   001354 702000 2                  TSX2    E_WRITE_CHECK

      593    12668    4                               ALTRET (E_WRITE_CHECK) ;
      594    12669    4                       CP_CHFLAGS.USE_RES = CP_FIDVLPS.FID_RES ;

  12669  2 000721   200334 220100                    LDX0    CP_FIDVLPS+12,,AUTO
         2 000722   200216 740100                    STX0    CP_CHFLAGS+23,,AUTO

      595    12670    4                       CP_CHFLAGS.USE_ASN = CP_FIDVLPS.FID_ASN ;

  12670  2 000723   200335 236100                    LDQ     CP_FIDVLPS+13,,AUTO
         2 000724   000022 772000                    QRL     18
         2 000725   200216 552110                    STBQ    CP_CHFLAGS+23,'10'O,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:122  

      596    12671    4                       TEMP$ = ADDR(CP_FIDVLPS.FID_RESULTS) ;

  12671  2 000726   200332 630500                    EPPR0   CP_FIDVLPS+10,,AUTO
         2 000727   200006 450500                    STP0    TEMP$,,AUTO

      597    12672    4                       IF NOT TEMP$ -> FID$RESULTS.ACCT AND P$->P$S.NSUBLKS ~= 0

  12672  2 000730   000000 236100                    LDQ     0,,PR0
         2 000731   200000 316003                    CANQ    65536,DU
         2 000732   000762 601000 2                  TNZ     s:12685
         2 000733   200004 471500                    LDP1    P$,,AUTO
         2 000734   100001 221100                    LDX1    1,,PR1
         2 000735   000762 600000 2                  TZE     s:12685

      598    12673    4                         THEN
      599    12674    5                           DO ;

      600    12675    5                             TEMP$ -> FID$RESULTS.ACCT = %YES# ;

  12675  2 000736   200000 236003                    LDQ     65536,DU
         2 000737   000000 256100                    ORSQ    0,,PR0

      601    12676    5                             CP_CHFLAGS.USE_ACCT = B$JIT.FACCN ;

  12676  2 000740   000000 473400 xsym               LDP3    B$JIT$
         2 000741   300006 237100                    LDAQ    6,,PR3
         2 000742   200167 755100                    STA     CP_CHFLAGS,,AUTO
         2 000743   200170 756100                    STQ     CP_CHFLAGS+1,,AUTO

      602    12677    5                             IF NOT TEMP$ -> FID$RESULTS.SN AND B$JIT.FPSN ~= ' '

  12677  2 000744   000000 236100                    LDQ     0,,PR0
         2 000745   040000 316003                    CANQ    16384,DU
         2 000746   000762 601000 2                  TNZ     s:12685
         2 000747   040000 106500                    CMPC    fill='040'O
         2 000750   300021 000006                    ADSC9   17,,PR3                  cn=0,n=6
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:123  
         2 000751   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000752   000762 600000 2                  TZE     s:12685

      603    12678    5                               THEN
      604    12679    6                                 DO ;

      605    12680    6                                   TEMP$ -> FID$RESULTS.SN = %YES# ;

  12680  2 000753   040000 236003                    LDQ     16384,DU
         2 000754   000000 256100                    ORSQ    0,,PR0

      606    12681    6                                   CP_CHFLAGS.USE_SN.N = 1 ;

  12681  2 000755   000001 235007                    LDA     1,DL
         2 000756   200207 755100                    STA     CP_CHFLAGS+16,,AUTO

      607    12682    6                                   CP_CHFLAGS.USE_SN.SN(0) = B$JIT.FPSN ;

  12682  2 000757   040100 100500                    MLR     fill='040'O
         2 000760   300021 000006                    ADSC9   17,,PR3                  cn=0,n=6
         2 000761   200210 000006                    ADSC9   CP_CHFLAGS+17,,AUTO      cn=0,n=6

      608    12683    6                                 END ; /*  Then Do */

      609    12684    5                           END ; /* Then Do */

      610    12685    4                       CP_CHFLAGS.USE_RESULTS = CP_FIDVLPS.FID_RESULTS ;

  12685  2 000762   200332 237100                    LDAQ    CP_FIDVLPS+10,,AUTO
         2 000763   200205 755100                    STA     CP_CHFLAGS+14,,AUTO
         2 000764   200206 756100                    STQ     CP_CHFLAGS+15,,AUTO

      611    12686    4                       IF BLK$ -> P$B.NSUBLKS = 1 AND CMD_TYPE ~= %NOTIFY_CMD#

  12686  2 000765   200005 471500                    LDP1    BLK$,,AUTO
         2 000766   100001 220100                    LDX0    1,,PR1
         2 000767   000001 100003                    CMPX0   1,DU
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:124  
         2 000770   001003 601000 2                  TNZ     s:12697
         2 000771   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 000772   000001 115007                    CMPA    1,DL
         2 000773   001003 600000 2                  TZE     s:12697

      612    12687    4                         THEN                    /* Only USE specified. */
      613    12688    5                           DO ;

      614    12689    5                             CALL CHECK_SYSIDS ALTRET(CHECK_CLEANUP) ;

  12689  2 000774   005747 701000 2                  TSX1    CHECK_SYSIDS
         2 000775   001313 702000 2                  TSX2    CHECK_CLEANUP

      615    12690    5                             OUTPUT_FLG = '1'B;

  12690  2 000776   400000 236003                    LDQ     -131072,DU
         2 000777   200142 756100                    STQ     OUTPUT_FLG,,AUTO

      616    12691    5                           END ;

  12691  2 001000   001003 710000 2                  TRA     s:12697

      617    12692
      618    12693    4                     CASE(ELSE) ;

      619    12694    4                       OUTPUT_FLG = '1'B ; /* Got something that produces output */

  12694  2 001001   400000 236003                    LDQ     -131072,DU
         2 001002   200142 756100                    STQ     OUTPUT_FLG,,AUTO

      620    12695
      621    12696    4                   END ; /* DO CASE */

      622    12697    3               END ; /* DO I */

  12697  2 001003   200144 054100                    AOS     I,,AUTO
         2 001004   200005 470500                    LDP0    BLK$,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:125  
         2 001005   000001 236100                    LDQ     1,,PR0
         2 001006   000022 772000                    QRL     18
         2 001007   200144 116100                    CMPQ    I,,AUTO
         2 001010   000553 605400 2                  TPNZ    s:12631

      623    12698
      624    12699    2               IF NOT OUTPUT_FLG AND K = 1

  12699  2 001011   200142 234100                    SZN     OUTPUT_FLG,,AUTO
         2 001012   001024 604000 2                  TMI     s:12707
         2 001013   200146 235100                    LDA     K,,AUTO
         2 001014   000001 115007                    CMPA    1,DL
         2 001015   001024 601000 2                  TNZ     s:12707

      625    12700    2                 THEN
      626    12701    3                   DO ; /* Got CHECK (ME) or CHECK (SYS) - do I,R,O */

      627    12702    3                     BLK$->P$B.NSUBLKS = 1;

  12702  2 001016   000001 220003                    LDX0    1,DU
         2 001017   000001 740100                    STX0    1,,PR0

      628    12703    3                     BLK$->P$B.SUBLK$(0) = BLK$; /* Point at itself */

  12703  2 001020   200005 236100                    LDQ     BLK$,,AUTO
         2 001021   000003 756100                    STQ     3,,PR0

      629    12704    3                     BLK$->P$B.CODE = %CH_INPUT;

  12704  2 001022   000007 221003                    LDX1    7,DU
         2 001023   000000 441100                    SXL1    0,,PR0

      630    12705    3                   END ;

      631    12706
      632    12707    3               DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:126  
  12707  2 001024   200144 450100                    STZ     I,,AUTO
         2 001025   001306 710000 2                  TRA     s:12832+1

      633    12708                                              /* Do the other options. */
      634    12709    3                 IF B$JIT.CPFLAGS1.BRK

  12709  2 001026   000000 470400 xsym               LDP0    B$JIT$
         2 001027   000143 236100                    LDQ     99,,PR0
         2 001030   000004 316007                    CANQ    4,DL
         2 001031   001035 600000 2                  TZE     s:12715

      635    12710    3                   THEN                  /* Forget the rest. */
      636    12711    4                     DO ;

      637    12712    4                       B$JIT.CPFLAGS1.BRK = %NO#;

  12712  2 001032   000032 236000 3                  LDQ     26
         2 001033   000143 356100                    ANSQ    99,,PR0

      638    12713    4                       GOTO CHECK_CLEANUP ;

  12713  2 001034   001313 710000 2                  TRA     CHECK_CLEANUP

      639    12714    4                     END ; /* THEN DO */
      640    12715    3                 FPT_JOBSTATS_CANCEL.V.OUTPUT# = %YES#;

  12715  2 001035   400000 236003                    LDQ     -131072,DU
         2 001036   201123 256100                    ORSQ    FPT_JOBSTATS_CANCEL+27,,AUTO

      641    12716    3                 FPT_JOBSTATS_CANCEL.V.ORDER# = %CANCEL#;

  12716  2 001037   000003 235007                    LDA     3,DL
         2 001040   201120 755100                    STA     FPT_JOBSTATS_CANCEL+24,,AUTO

      642    12717    3                 P$=BLK$->P$B.SUBLK$(I);

  12717  2 001041   200005 471500                    LDP1    BLK$,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:127  
         2 001042   200144 720100                    LXL0    I,,AUTO
         2 001043   100003 236110                    LDQ     3,X0,PR1
         2 001044   200004 756100                    STQ     P$,,AUTO

      643    12718    3                 CMD_CODE = P$->P$B.CODE ;

  12718  2 001045   200004 473500                    LDP3    P$,,AUTO
         2 001046   300000 236100                    LDQ     0,,PR3
         2 001047   777777 376007                    ANQ     -1,DL
         2 001050   200154 756100                    STQ     CMD_CODE,,AUTO

      644    12719    4                   DO CASE(CMD_CODE);

  12719  2 001051   000026 116007                    CMPQ    22,DL
         2 001052   001054 602006 2                  TNC     s:12719+3,QL
         2 001053   001244 710000 2                  TRA     s:12801
         2 001054   001244 710000 2                  TRA     s:12801
         2 001055   001144 710000 2                  TRA     s:12748
         2 001056   001144 710000 2                  TRA     s:12748
         2 001057   001212 710000 2                  TRA     s:12777
         2 001060   001240 710000 2                  TRA     s:12797
         2 001061   001234 710000 2                  TRA     s:12793
         2 001062   001244 710000 2                  TRA     s:12801
         2 001063   001102 710000 2                  TRA     s:12722
         2 001064   001102 710000 2                  TRA     s:12722
         2 001065   001123 710000 2                  TRA     s:12735
         2 001066   001102 710000 2                  TRA     s:12722
         2 001067   001244 710000 2                  TRA     s:12801
         2 001070   001244 710000 2                  TRA     s:12801
         2 001071   001244 710000 2                  TRA     s:12801
         2 001072   001244 710000 2                  TRA     s:12801
         2 001073   001244 710000 2                  TRA     s:12801
         2 001074   001244 710000 2                  TRA     s:12801
         2 001075   001244 710000 2                  TRA     s:12801
         2 001076   001227 710000 2                  TRA     s:12788
         2 001077   001244 710000 2                  TRA     s:12801
         2 001100   001244 710000 2                  TRA     s:12801
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:128  
         2 001101   001171 710000 2                  TRA     s:12765

      645    12720
      646    12721    4                     CASE (%CH_INPUT,%CH_RUN,%CH_JOB) ;

      647    12722    4                       CALL SETUP_Q_SRCH ;

  12722  2 001102   001714 701000 2                  TSX1    SETUP_Q_SRCH
         2 001103   000000 011000                    NOP     0

      648    12723    4                       IF CMD_TYPE = %NOTIFY_CMD#

  12723  2 001104   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 001105   000001 115007                    CMPA    1,DL
         2 001106   001120 601000 2                  TNZ     s:12732

      649    12724    4                         THEN
      650    12725    5                           DO ;                          /* Remember. */

      651    12726    5                             CP_CHFLAGS.FLG.SRCHID = %NO# ;

  12726  2 001107   000033 236000 3                  LDQ     27
         2 001110   200220 356100                    ANSQ    CP_CHFLAGS+25,,AUTO

      652    12727    5                             CP_CHFLAGS.FLG.SRCHQS = %YES# ;

  12727  2 001111   400000 236007                    LDQ     -131072,DL
         2 001112   200220 256100                    ORSQ    CP_CHFLAGS+25,,AUTO

      653    12728    5                             CP_CHFLAGS.I_CRITERIA = Q_CRITERIA ;

  12728  2 001113   000100 100500                    MLR     fill='000'O
         2 001114   201202 000116                    ADSC9   Q_CRITERIA,,AUTO         cn=0,n=78
         2 001115   200223 000116                    ADSC9   CP_CHFLAGS+28,,AUTO      cn=0,n=78

      654    12729    5                             GET_JOBSTATS# = %NO# ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:129  
  12729  2 001116   200124 450100                    STZ     GET_JOBSTATS#,,AUTO

      655    12730    5                           END ; /* THEN DO */

  12730  2 001117   001245 710000 2                  TRA     s:12804

      656    12731    4                         ELSE
      657    12732    4                           GET_JOBSTATS# = %YES# ;

  12732  2 001120   400000 236003                    LDQ     -131072,DU
         2 001121   200124 756100                    STQ     GET_JOBSTATS#,,AUTO
         2 001122   001245 710000 2                  TRA     s:12804

      658    12733
      659    12734    4                     CASE (%CH_OUTPUT) ;

      660    12735    4                       CALL SETUP_Q_SRCH ;

  12735  2 001123   001714 701000 2                  TSX1    SETUP_Q_SRCH
         2 001124   000000 011000                    NOP     0

      661    12736    4                       IF CMD_TYPE = %NOTIFY_CMD#

  12736  2 001125   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 001126   000001 115007                    CMPA    1,DL
         2 001127   001141 601000 2                  TNZ     s:12745

      662    12737    4                         THEN
      663    12738    5                           DO ;                          /* Remember */

      664    12739    5                             CP_CHFLAGS.FLG.SRCHID = %NO# ;

  12739  2 001130   000033 236000 3                  LDQ     27
         2 001131   200220 356100                    ANSQ    CP_CHFLAGS+25,,AUTO

      665    12740    5                             CP_CHFLAGS.FLG.SRCHQS = %YES# ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:130  
  12740  2 001132   400000 236007                    LDQ     -131072,DL
         2 001133   200220 256100                    ORSQ    CP_CHFLAGS+25,,AUTO

      666    12741    5                             CP_CHFLAGS.O_CRITERIA = Q_CRITERIA ;

  12741  2 001134   000100 100500                    MLR     fill='000'O
         2 001135   201202 000116                    ADSC9   Q_CRITERIA,,AUTO         cn=0,n=78
         2 001136   200247 000116                    ADSC9   CP_CHFLAGS+48,,AUTO      cn=0,n=78

      667    12742    5                             GET_JOBSTATS# = %NO# ;

  12742  2 001137   200124 450100                    STZ     GET_JOBSTATS#,,AUTO

      668    12743    5                           END ; /* THEN DO */

  12743  2 001140   001245 710000 2                  TRA     s:12804

      669    12744    4                         ELSE
      670    12745    4                           GET_JOBSTATS# = %YES# ;

  12745  2 001141   400000 236003                    LDQ     -131072,DU
         2 001142   200124 756100                    STQ     GET_JOBSTATS#,,AUTO
         2 001143   001245 710000 2                  TRA     s:12804

      671    12746
      672    12747    4                     CASE (%CH_SYSIDCMD,%CH_JOBNAME);

      673    12748    4                       REMEMBER SUBMIT_LOOP IN SUBMIT_LOOP_REMEM;

  12748  2 001144   001147 635000 2                  EAA     SUBMIT_LOOP
         2 001145   200162 452500                    STP2    SUBMIT_LOOP_REMEM,,AUTO
         2 001146   200163 755100                    STA     SUBMIT_LOOP_REMEM+1,,AUTO

      674    12749    4   SUBMIT_LOOP:        IF B$JIT.CPFLAGS1.BRK

  12749  2 001147   000000 470400 xsym  SUBMIT_LOOP  LDP0    B$JIT$
         2 001150   000143 236100                    LDQ     99,,PR0
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:131  
         2 001151   000004 316007                    CANQ    4,DL
         2 001152   001165 600000 2                  TZE     s:12761

      675    12750    4                         THEN                  /* Forget the rest. */
      676    12751    5                           DO ;

      677    12752    5                             B$JIT.CPFLAGS1.BRK = %NO#;

  12752  2 001153   000032 236000 3                  LDQ     26
         2 001154   000143 356100                    ANSQ    99,,PR0

      678    12753    5                             IF CMD_TYPE = %SUBMIT_CMD#

  12753  2 001155   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 001156   000002 115007                    CMPA    2,DL
         2 001157   001164 601000 2                  TNZ     s:12759

      679    12754    5                               THEN
      680    12755    6                                 DO ;

      681    12756    6                                   CALL SETUP_DUMMY_SUBMIT_MESS ;

  12756  2 001160   007634 701000 2                  TSX1    SETUP_DUMMY_SUBMIT_MESS
         2 001161   000000 011000                    NOP     0

      682    12757    6                                   CALL PRINT_SUBMIT_MESS ;

  12757  2 001162   007664 701000 2                  TSX1    PRINT_SUBMIT_MESS
         2 001163   000000 011000                    NOP     0

      683    12758    6                                 END;  /* Then Do */

      684    12759    5                             GOTO CHECK_CLEANUP ;

  12759  2 001164   001313 710000 2                  TRA     CHECK_CLEANUP

      685    12760    5                           END ; /* THEN DO */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:132  
      686    12761    4                       CALL SETUP_SYSID_SRCH ALTRET(E_DONT_POSTERR) ;

  12761  2 001165   002264 701000 2                  TSX1    SETUP_SYSID_SRCH
         2 001166   001634 702000 2                  TSX2    E_DONT_POSTERR

      687    12762    4                       GET_JOBSTATS# = %NO# ;

  12762  2 001167   200124 450100                    STZ     GET_JOBSTATS#,,AUTO
         2 001170   001245 710000 2                  TRA     s:12804

      688    12763
      689    12764    4                     CASE (%CH_LAST);

      690    12765    4                       TEMP = B$JIT.LBJID ;

  12765  2 001171   000302 236100                    LDQ     194,,PR0
         2 001172   777777 376007                    ANQ     -1,DL
         2 001173   200147 756100                    STQ     TEMP,,AUTO

      691    12766    4                       IF TEMP = 0

  12766  2 001174   001206 601000 2                  TNZ     s:12773

      692    12767    4                          THEN
      693    12768    5                             DO;

      694    12769    5                                CH_XFORMAT.MSG# = %CP_NONE_MESS ;

  12769  2 001175   000004 235007                    LDA     4,DL
         2 001176   200412 755100                    STA     CH_XFORMAT,,AUTO

      695    12770    5                                CALL CPK$CHECK_OUTPUT(CH_XFORMAT);

  12770  2 001177   200412 634500                    EPPR4   CH_XFORMAT,,AUTO
         2 001200   201344 454500                    STP4    LFPT_PRECORD+10,,AUTO
         2 001201   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 001202   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:133  
         2 001203   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 001204   000000 011000                    NOP     0

      696    12771    5                             END;

  12771  2 001205   001210 710000 2                  TRA     s:12774

      697    12772    4                       ELSE
      698    12773    4                          CALL SETUP_SYSID_SRCH ALTRET(E_DONT_POSTERR) ;

  12773  2 001206   002264 701000 2                  TSX1    SETUP_SYSID_SRCH
         2 001207   001634 702000 2                  TSX2    E_DONT_POSTERR

      699    12774    4                       GET_JOBSTATS# = %NO# ;

  12774  2 001210   200124 450100                    STZ     GET_JOBSTATS#,,AUTO
         2 001211   001245 710000 2                  TRA     s:12804

      700    12775
      701    12776    4                     CASE (%CH_TERM_CMD);

      702    12777    4                       IF CMD_TYPE = %NOTIFY_CMD#

  12777  2 001212   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 001213   000001 115007                    CMPA    1,DL
         2 001214   001220 601000 2                  TNZ     s:12782

      703    12778    4                         THEN
      704    12779    4                           CP_CHFLAGS.FLG.TERM = %YES# ;

  12779  2 001215   040000 236007                    LDQ     16384,DL
         2 001216   200220 256100                    ORSQ    CP_CHFLAGS+25,,AUTO
         2 001217   001225 710000 2                  TRA     s:12785

      705    12780    4                         ELSE
      706    12781    5                           DO ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:134  
      707    12782    5                             TEMP = B$JIT.SYSID ;

  12782  2 001220   000000 236100                    LDQ     0,,PR0
         2 001221   777777 376007                    ANQ     -1,DL
         2 001222   200147 756100                    STQ     TEMP,,AUTO

      708    12783    5                             CALL SETUP_SYSID_SRCH ALTRET(E_DONT_POSTERR) ;

  12783  2 001223   002264 701000 2                  TSX1    SETUP_SYSID_SRCH
         2 001224   001634 702000 2                  TSX2    E_DONT_POSTERR

      709    12784    5                           END ; /* Else Do */

      710    12785    4                       GET_JOBSTATS# = %NO# ;

  12785  2 001225   200124 450100                    STZ     GET_JOBSTATS#,,AUTO
         2 001226   001245 710000 2                  TRA     s:12804

      711    12786
      712    12787    4                     CASE(%CH_WAIT) ;

      713    12788    4                       CALL CHECK_WAIT ;

  12788  2 001227   004153 701000 2                  TSX1    CHECK_WAIT
         2 001230   000000 011000                    NOP     0

      714    12789    4                       GET_JOBSTATS# = %NO# ;

  12789  2 001231   200124 450100                    STZ     GET_JOBSTATS#,,AUTO

      715    12790    4                         WAITING = %NO# ;

  12790  2 001232   200133 450100                    STZ     WAITING,,AUTO
         2 001233   001245 710000 2                  TRA     s:12804

      716    12791
      717    12792    4                     CASE(%CH_ME);
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:135  

      718    12793    4                       CP_CHFLAGS.SYSTEM = %NO#;

  12793  2 001234   000030 236000 3                  LDQ     24
         2 001235   200217 356100                    ANSQ    CP_CHFLAGS+24,,AUTO

      719    12794    4                       GET_JOBSTATS# = %NO#;

  12794  2 001236   200124 450100                    STZ     GET_JOBSTATS#,,AUTO
         2 001237   001245 710000 2                  TRA     s:12804

      720    12795
      721    12796    4                     CASE(%CH_SYSTEM);

      722    12797    4                       CP_CHFLAGS.SYSTEM = %YES#;

  12797  2 001240   400000 236007                    LDQ     -131072,DL
         2 001241   200217 256100                    ORSQ    CP_CHFLAGS+24,,AUTO

      723    12798    4                       GET_JOBSTATS# = %NO#;

  12798  2 001242   200124 450100                    STZ     GET_JOBSTATS#,,AUTO
         2 001243   001245 710000 2                  TRA     s:12804

      724    12799
      725    12800    4                     CASE(ELSE) ;

      726    12801    4                       GET_JOBSTATS# = %NO# ;

  12801  2 001244   200124 450100                    STZ     GET_JOBSTATS#,,AUTO

      727    12802
      728    12803    4                   END;   /* do case ... end */

      729    12804    3                 IF (GET_JOBSTATS#)

  12804  2 001245   200124 234100                    SZN     GET_JOBSTATS#,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:136  
         2 001246   001261 605000 2                  TPL     DONT_GET_JOBSTATS

      730    12805    3                   THEN
      731    12806    4                     DO ;

      732    12807    4                       CALL GET_JOBSTATS ALTRET(E_DONT_POSTERR) ;

  12807  2 001247   006704 701000 2                  TSX1    GET_JOBSTATS
         2 001250   001634 702000 2                  TSX2    E_DONT_POSTERR

      733    12808    4                       CH_XFORMAT.MSG# = %CP_BLANKLINE_MESS ;

  12808  2 001251   000032 235007                    LDA     26,DL
         2 001252   200412 755100                    STA     CH_XFORMAT,,AUTO

      734    12809    4                       CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  12809  2 001253   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 001254   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 001255   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 001256   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001257   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 001260   000000 011000                    NOP     0

      735    12810    4                     END ; /* THEN DO */

      736    12811    3   DONT_GET_JOBSTATS:
      737    12812
      738    12813    3                 IF ADDR(SEG$2.ERRBUF)->ERR$BLK.FIRST ~= 0

  12813  2 001261   000000 470400 xsym  DONT_GET_JO* LDP0    SEG2$
         2 001262   000004 235100                    LDA     4,,PR0
         2 001263   001634 601000 2                  TNZ     E_DONT_POSTERR

      739    12814    3                   THEN
      740    12815    3                     GOTO E_DONT_POSTERR ;
      741    12816
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:137  
      742    12817    3                 IF P$ = BLK$

  12817  2 001264   200004 236100                    LDQ     P$,,AUTO
         2 001265   200005 116100                    CMPQ    BLK$,,AUTO
         2 001266   001305 601000 2                  TNZ     s:12832

      743    12818    3                   THEN
      744    12819    4                     DO;

      745    12820    4                       IF CMD_CODE = %CH_INPUT

  12820  2 001267   200154 235100                    LDA     CMD_CODE,,AUTO
         2 001270   000007 115007                    CMPA    7,DL
         2 001271   001276 601000 2                  TNZ     s:12824

      746    12821    4                         THEN
      747    12822    4                         BLK$->P$B.CODE = %CH_RUN;

  12822  2 001272   000012 220003                    LDX0    10,DU
         2 001273   200005 471500                    LDP1    BLK$,,AUTO
         2 001274   100000 440100                    SXL0    0,,PR1
         2 001275   001303 710000 2                  TRA     s:12829

      748    12823    4                         ELSE
      749    12824    4                           IF CMD_CODE = %CH_OUTPUT

  12824  2 001276   000011 115007                    CMPA    9,DL
         2 001277   001305 600000 2                  TZE     s:12832

      750    12825    4                             THEN
      751    12826    4                               EXIT;
      752    12827    4                             ELSE
      753    12828    4                             BLK$->P$B.CODE = %CH_OUTPUT;

  12828  2 001300   000011 220003                    LDX0    9,DU
         2 001301   200005 471500                    LDP1    BLK$,,AUTO
         2 001302   100000 440100                    SXL0    0,,PR1
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:138  

      754    12829    4                       I = I - 1;

  12829  2 001303   000001 336007                    LCQ     1,DL
         2 001304   200144 056100                    ASQ     I,,AUTO

      755    12830    4                     END;

      756    12831
      757    12832    3               END;   /* DO i ... end */

  12832  2 001305   200144 054100                    AOS     I,,AUTO
         2 001306   200005 470500                    LDP0    BLK$,,AUTO
         2 001307   000001 236100                    LDQ     1,,PR0
         2 001310   000022 772000                    QRL     18
         2 001311   200144 116100                    CMPQ    I,,AUTO
         2 001312   001026 605400 2                  TPNZ    s:12709

      758    12833    2             END ; /* THEN DO */

      759    12834        /*
      760    12835             ***** If the :JOBSTATS file is still open, close it...
      761    12836        */
      762    12837    1   CHECK_CLEANUP:
      763    12838    1         IF CMD_TYPE = %NOTIFY_CMD#

  12838  2 001313   200164 235100       CHECK_CLEAN* LDA     CMD_TYPE,,AUTO
         2 001314   000001 115007                    CMPA    1,DL
         2 001315   001347 601000 2                  TNZ     s:12851

      764    12839    1             THEN
      765    12840    2               DO ;                                      /* Update *S file. */

      766    12841    2                 IF JOBSTATS_OPEN#

  12841  2 001316   200120 234100                    SZN     JOBSTATS_OPEN#,,AUTO
         2 001317   001332 605000 2                  TPL     s:12848
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:139  

      767    12842    2                   THEN
      768    12843    3                     DO;

      769    12844    3                       FPT_CLOSE.V.DCB# = M$IBEX1_NUM;

  12844  2 001320   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001321   200724 740100                    STX0    FPT_CLOSE+26,,AUTO

      770    12845    3                       CALL M$CLOSE (FPT_CLOSE) ALTRET(E_CHECK);

  12845  2 001322   200672 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001323   450001 713400                    CLIMB   alt,close
         2 001324   406000 401760                    pmme    nvectors=13
         2 001325   001615 702000 2                  TSX2    E_CHECK

      771    12846    3                       CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(E_DONT_POSTERR);

  12846  2 001326   000007 630400 3                  EPPR0   7
         2 001327   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001330   000000 701000 xent               TSX1    CPC$OPEN_S
         2 001331   001634 702000 2                  TSX2    E_DONT_POSTERR

      772    12847    3                     END;

      773    12848    2                  CALL CPJ$WRITE_S (M$IBEX1_NUM,VECTOR(K_NOTIFY),VECTOR(CP_CHFLAGS))

  12848  2 001332   000022 235000 3                  LDA     18
         2 001333   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 001334   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 001335   000167 036003                    ADLQ    119,DU
         2 001336   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 001337   201346 630500                    EPPR0   LFPT_PRECORD+12,,AUTO
         2 001340   201352 450500                    STP0    LFPT_PRECORD+16,,AUTO
         2 001341   000024 237000 3                  LDAQ    20
         2 001342   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 001343   201350 630500                    EPPR0   LFPT_PRECORD+14,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:140  
         2 001344   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001345   000000 701000 xent               TSX1    CPJ$WRITE_S
         2 001346   001354 702000 2                  TSX2    E_WRITE_CHECK

      774    12849    2                      ALTRET(E_WRITE_CHECK) ;
      775    12850    2               END ; /* THEN DO */

      776    12851    1         CALL CPC$RELSEG (SEG4$);

  12851  2 001347   000011 630400 3                  EPPR0   9
         2 001350   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001351   000000 701000 xent               TSX1    CPC$RELSEG
         2 001352   000000 011000                    NOP     0

      777    12852    2         DO WHILE (%NO#);

  12852  2 001353   001374 710000 2                  TRA     s:12856

      778    12853    2   E_WRITE_CHECK:
      779    12854    2           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR,,M$IBEX1_NUM);

  12854  2 001354   000000 236000 xsym  E_WRITE_CHE* LDQ     SEG2$
         2 001355   000003 036003                    ADLQ    3,DU
         2 001356   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 001357   000007 236000 3                  LDQ     7
         2 001360   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001361   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 001362   000000 236000 xsym               LDQ     B$JIT$
         2 001363   000144 036003                    ADLQ    100,DU
         2 001364   000035 235000 3                  LDA     29
         2 001365   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 001366   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 001367   201345 450500                    STP0    LFPT_PRECORD+11,,AUTO
         2 001370   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 001371   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001372   000000 701000 xent               TSX1    CXP$POSTERR
         2 001373   000000 011000                    NOP     0
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:141  

      780    12855    2         END;

      781    12856    1         IF DCBADDR(M$IBEX1_NUM) -> F$DCB.FCD#

  12856  2 001374   000036 470400 3                  LDP0    30
         2 001375   000000 471500                    LDP1    0,,PR0
         2 001376   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001377   100000 473510                    LDP3    0,X0,PR1
         2 001400   300031 236100                    LDQ     25,,PR3
         2 001401   020000 316007                    CANQ    8192,DL
         2 001402   001410 600000 2                  TZE     s:12862

      782    12857    1           THEN   /* Close it */
      783    12858    2             DO;

      784    12859    2               FPT_CLOSE.V.DCB# = M$IBEX1_NUM;

  12859  2 001403   200724 740100                    STX0    FPT_CLOSE+26,,AUTO

      785    12860    2               CALL M$CLOSE (FPT_CLOSE) ALTRET(E_CHECK);

  12860  2 001404   200672 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001405   450001 713400                    CLIMB   alt,close
         2 001406   406000 401760                    pmme    nvectors=13
         2 001407   001615 702000 2                  TSX2    E_CHECK

      786    12861    2             END;

      787    12862    1         IF (CMDSTRM_CLOSED#)

  12862  2 001410   200122 234100                    SZN     CMDSTRM_CLOSED#,,AUTO
         2 001411   001572 605000 2                  TPL     s:12911

      788    12863    1             THEN
      789    12864    2               DO ;                                      /* Open command stream */

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:142  
      790    12865    2                     FPT_CLOSE.V.DCB# = M$IBEX_NUM ;

  12865  2 001412   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 001413   200724 740100                    STX0    FPT_CLOSE+26,,AUTO

      791    12866    2                     CALL M$PFIL(FPT_PFIL) ALTRET (E_PFIL) ;

  12866  2 001414   200742 630500                    EPPR0   FPT_PFIL,,AUTO
         2 001415   440004 713400                    CLIMB   alt,+16388
         2 001416   400000 401760                    pmme    nvectors=1
         2 001417   001511 702000 2                  TSX2    E_PFIL

      792    12867    2                     FPT_READ_USE = CFPT_READ ;

  12867  2 001420   000100 100400                    MLR     fill='000'O
         2 001421   000000 000070 xsym               ADSC9   CFPT_READ                cn=0,n=56
         2 001422   200636 000070                    ADSC9   FPT_READ_USE,,AUTO       cn=0,n=56

      793    12868    2                     FPT_READ_USE.V_ = VECTOR(FPT_READ_USE.V) ;

  12868  2 001423   000004 235000 3                  LDA     4
         2 001424   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 001425   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 001426   000646 036003                    ADLQ    422,DU
         2 001427   200636 757100                    STAQ    FPT_READ_USE,,AUTO

      794    12869    2                     FPT_READ_USE.BUF_ = VECTOR(SYSIDBUF) ;

  12869  2 001430   000037 235000 3                  LDA     31
         2 001431   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 001432   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 001433   000344 036003                    ADLQ    228,DU
         2 001434   200642 757100                    STAQ    FPT_READ_USE+4,,AUTO

      795    12870    2                     FPT_READ_USE.KEY_ = VECTOR(CHKEYBUF) ;

  12870  2 001435   000006 235000 3                  LDA     6
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:143  
         2 001436   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 001437   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 001440   000336 036003                    ADLQ    222,DU
         2 001441   200640 757100                    STAQ    FPT_READ_USE+2,,AUTO

      796    12871    2                     FPT_READ_USE.V.KEYS# = %NO# ;

  12871  2 001442   000033 236000 3                  LDQ     27
         2 001443   200646 356100                    ANSQ    FPT_READ_USE+8,,AUTO

      797    12872    2                     FPT_READ_USE.V.KEYR# = %YES# ;

  12872  2 001444   100000 236007                    LDQ     32768,DL
         2 001445   200646 256100                    ORSQ    FPT_READ_USE+8,,AUTO

      798    12873    2                     FPT_READ_USE.V.DCB# = M$IBEX_NUM ;

  12873  2 001446   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 001447   200646 740100                    STX0    FPT_READ_USE+8,,AUTO

      799    12874    2                     FPT_CLOSE.V.DISP# = %SAVE# ;

  12874  2 001450   000002 236007                    LDQ     2,DL
         2 001451   200724 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      800    12875    2                     CALL M$READ(FPT_READ_USE) WHENALTRETURN

  12875  2 001452   200636 630500                    EPPR0   FPT_READ_USE,,AUTO
         2 001453   440000 713400                    CLIMB   alt,read
         2 001454   401400 401760                    pmme    nvectors=4
         2 001455   001457 702000 2                  TSX2    s:12877
         2 001456   001510 710000 2                  TRA     s:12891

      801    12876    3                           DO ;

      802    12877    3                             IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$BADVECT1

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:144  
  12877  2 001457   000000 470400 xsym               LDP0    B$TCB$
         2 001460   000000 471500                    LDP1    0,,PR0
         2 001461   100102 236100                    LDQ     66,,PR1
         2 001462   377770 376007                    ANQ     131064,DL
         2 001463   006450 116007                    CMPQ    3368,DL
         2 001464   001501 601000 2                  TNZ     s:12884

      803    12878    3                               THEN
      804    12879    4                                 DO ;

      805    12880    4                                   CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF), 511,

  12880  2 001465   000000 236000 xsym               LDQ     SEG2$
         2 001466   000003 036003                    ADLQ    3,DU
         2 001467   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 001470   000040 237000 3                  LDAQ    32
         2 001471   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 001472   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 001473   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 001474   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 001475   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001476   000000 701000 xent               TSX1    CXP$POSTERR
         2 001477   000000 011000                    NOP     0

      806    12881    4                                             E_CHKBADUSEF) ;
      807    12882    4                                   GOTO E_DONT_POSTERR ;

  12882  2 001500   001634 710000 2                  TRA     E_DONT_POSTERR

      808    12883    4                                 END ; /* Then Do */
      809    12884    3                             IF B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$EOF

  12884  2 001501   000060 116007                    CMPQ    48,DL
         2 001502   001510 601000 2                  TNZ     s:12891

      810    12885    3                               THEN
      811    12886    4                                 DO ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:145  

      812    12887    4                                   B$JIT.CPFLAGS1.SOMENOTIFY = %NO# ;

  12887  2 001503   000000 473400 xsym               LDP3    B$JIT$
         2 001504   000042 236000 3                  LDQ     34
         2 001505   300143 356100                    ANSQ    99,,PR3

      813    12888    4                                   FPT_CLOSE.V.DISP# = %RELEASE# ;

  12888  2 001506   000001 236007                    LDQ     1,DL
         2 001507   200724 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

      814    12889    4                                 END ; /* THEN DO */

      815    12890    3                           END ; /* Do Whenaltreturn */

      816    12891    3                     DO WHILE('0'B) ;

  12891  2 001510   001553 710000 2                  TRA     s:12905

      817    12892    3   E_PFIL:
      818    12893    3                       ADDR(SEG$2.ERRBUF) -> ERR$BLK.FIRST = 0;

  12893  2 001511   000000 470400 xsym  E_PFIL       LDP0    SEG2$
         2 001512   000004 450100                    STZ     4,,PR0

      819    12894    3                       ADDR(SEG$2.ERRBUF) -> ERR$BLK.NEXT = 0;

  12894  2 001513   000005 450100                    STZ     5,,PR0

      820    12895    3                       IF B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$FILEBUSY

  12895  2 001514   000000 471400 xsym               LDP1    B$TCB$
         2 001515   100000 473500                    LDP3    0,,PR1
         2 001516   300102 236100                    LDQ     66,,PR3
         2 001517   377770 376007                    ANQ     131064,DL
         2 001520   001550 116007                    CMPQ    872,DL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:146  
         2 001521   001536 601000 2                  TNZ     s:12899

      821    12896    3                         THEN
      822    12897    3                           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_USEFILEBUSY) ;

  12897  2 001522   000000 236000 xsym               LDQ     SEG2$
         2 001523   000003 036003                    ADLQ    3,DU
         2 001524   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 001525   000044 237000 3                  LDAQ    36
         2 001526   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 001527   201344 633500                    EPPR3   LFPT_PRECORD+10,,AUTO
         2 001530   201345 453500                    STP3    LFPT_PRECORD+11,,AUTO
         2 001531   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 001532   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001533   000000 701000 xent               TSX1    CXP$POSTERR
         2 001534   000000 011000                    NOP     0
         2 001535   001553 710000 2                  TRA     s:12905

      823    12898    3                         ELSE
      824    12899    3                           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.
             12899                                    ERR) ;

  12899  2 001536   000000 236000 xsym               LDQ     SEG2$
         2 001537   000003 036003                    ADLQ    3,DU
         2 001540   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 001541   300102 634500                    EPPR4   66,,PR3
         2 001542   201347 454500                    STP4    LFPT_PRECORD+13,,AUTO
         2 001543   000035 236000 3                  LDQ     29
         2 001544   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 001545   201344 633500                    EPPR3   LFPT_PRECORD+10,,AUTO
         2 001546   201345 453500                    STP3    LFPT_PRECORD+11,,AUTO
         2 001547   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 001550   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001551   000000 701000 xent               TSX1    CXP$POSTERR
         2 001552   000000 011000                    NOP     0

      825    12900    3                     END ; /* DO WHILE */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:147  

      826    12901        /*E*       ERROR:   CPK-E$USEFILEBUSY-C
      827    12902                   MESSAGE: CHECK/NOTIFY USE file busy.
      828    12903                   DESCRIPTION: CHECK/NOTIFY try to access a USE file that was busy.
      829    12904        */
      830    12905    2                     IF DCBADDR(M$IBEX_NUM) -> F$DCB.FCD#

  12905  2 001553   000036 470400 3                  LDP0    30
         2 001554   000000 471500                    LDP1    0,,PR0
         2 001555   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 001556   100000 473510                    LDP3    0,X0,PR1
         2 001557   300031 236100                    LDQ     25,,PR3
         2 001560   020000 316007                    CANQ    8192,DL
         2 001561   001567 600000 2                  TZE     s:12909

      831    12906    2                       THEN CALL M$CLOSE(FPT_CLOSE) WHENALTRETURN

  12906  2 001562   200672 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001563   450001 713400                    CLIMB   alt,close
         2 001564   406000 401760                    pmme    nvectors=13
         2 001565   001567 702000 2                  TSX2    s:12909
         2 001566   001567 710000 2                  TRA     s:12909

      832    12907    3                                   DO ;

      833    12908    3                                   END ; /* Whenaltreturn Do */

      834    12909    2                 CALL CPB$OPENCS ;

  12909  2 001567   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001570   000000 701000 xent               TSX1    CPB$OPENCS
         2 001571   000000 011000                    NOP     0

      835    12910    2               END ; /* THEN DO */

      836    12911    1         IF ADDR(SEG$2.ERRBUF)->ERR$BLK.FIRST ~= 0

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:148  
  12911  2 001572   000000 470400 xsym               LDP0    SEG2$
         2 001573   000004 235100                    LDA     4,,PR0
         2 001574   001674 601000 2                  TNZ     CPK$CHECK_ALTRET

      837    12912    1             THEN
      838    12913    1               GOTO CPK$CHECK_ALTRET ;
      839    12914
      840    12915    1   CPK$CHECK_RET:
      841    12916    1         IF NOTIFYING AND CP_CHFLAGS.FLG.TERM

  12916  2 001575   200137 234100       CPK$CHECK_R* SZN     NOTIFYING,,AUTO
         2 001576   001605 605000 2                  TPL     s:12919
         2 001577   200220 236100                    LDQ     CP_CHFLAGS+25,,AUTO
         2 001600   040000 316007                    CANQ    16384,DL
         2 001601   001605 600000 2                  TZE     s:12919

      842    12917    1             THEN
      843    12918    1               B$JIT.CPFLAGS1.SOMENOTIFY = %YES# ;

  12918  2 001602   000000 471400 xsym               LDP1    B$JIT$
         2 001603   000040 236003                    LDQ     32,DU
         2 001604   100143 256100                    ORSQ    99,,PR1

      844    12919    1         IF SYSTEM_OK#

  12919  2 001605   200125 234100                    SZN     SYSTEM_OK#,,AUTO
         2 001606   001614 605000 2                  TPL     s:12922

      845    12920    1           THEN
      846    12921    2             CALL M$RPRIV(FPT_PRIV_DISPJOB) WHENALTRETURN DO; END;

  12921  2 001607   000160 630400 1                  EPPR0   FPT_PRIV_DISPJOB
         2 001610   420013 713400                    CLIMB   alt,+8203
         2 001611   400000 401760                    pmme    nvectors=1
         2 001612   001614 702000 2                  TSX2    s:12922
         2 001613   001614 710000 2                  TRA     s:12922

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:149  
      847    12922    1         RETURN;

  12922  2 001614   000000 702200 xent               TSX2  ! X66_ARET

      848    12923    1   E_CHECK:
      849    12924    1         CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$ -> B$ALT.ERR);

  12924  2 001615   000000 470400 xsym  E_CHECK      LDP0    B$TCB$
         2 001616   000000 471500                    LDP1    0,,PR0
         2 001617   000000 236000 xsym               LDQ     SEG2$
         2 001620   000003 036003                    ADLQ    3,DU
         2 001621   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 001622   100102 633500                    EPPR3   66,,PR1
         2 001623   201347 453500                    STP3    LFPT_PRECORD+13,,AUTO
         2 001624   000035 236000 3                  LDQ     29
         2 001625   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 001626   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 001627   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 001630   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 001631   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001632   000000 701000 xent               TSX1    CXP$POSTERR
         2 001633   000000 011000                    NOP     0

      850    12925    1   E_DONT_POSTERR:
      851    12926    1         CALL CPC$RELSEG (SEG4$);

  12926  2 001634   000011 630400 3     E_DONT_POST* EPPR0   9
         2 001635   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001636   000000 701000 xent               TSX1    CPC$RELSEG
         2 001637   000000 011000                    NOP     0

      852    12927    1         IF DCBADDR(M$IBEX1_NUM) -> F$DCB.FCD#

  12927  2 001640   000036 470400 3                  LDP0    30
         2 001641   000000 471500                    LDP1    0,,PR0
         2 001642   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001643   100000 473510                    LDP3    0,X0,PR1
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:150  
         2 001644   300031 236100                    LDQ     25,,PR3
         2 001645   020000 316007                    CANQ    8192,DL
         2 001646   001654 600000 2                  TZE     s:12933

      853    12928    1           THEN   /* Close it */
      854    12929    2             DO;

      855    12930    2               FPT_CLOSE.V.DCB# = M$IBEX1_NUM;

  12930  2 001647   200724 740100                    STX0    FPT_CLOSE+26,,AUTO

      856    12931    2               CALL M$CLOSE (FPT_CLOSE) ALTRET(E_CHECK);

  12931  2 001650   200672 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001651   450001 713400                    CLIMB   alt,close
         2 001652   406000 401760                    pmme    nvectors=13
         2 001653   001615 702000 2                  TSX2    E_CHECK

      857    12932    2             END;

      858    12933    1         IF (CMDSTRM_CLOSED#)

  12933  2 001654   200122 234100                    SZN     CMDSTRM_CLOSED#,,AUTO
         2 001655   001674 605000 2                  TPL     CPK$CHECK_ALTRET

      859    12934    1             THEN
      860    12935    2               DO ;                                      /* Open command stream */

      861    12936    2                 FPT_CLOSE.V.DCB# = M$IBEX_NUM ;

  12936  2 001656   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 001657   200724 740100                    STX0    FPT_CLOSE+26,,AUTO

      862    12937    2                 IF DCBADDR(M$IBEX_NUM) -> F$DCB.FCD#

  12937  2 001660   000036 470400 3                  LDP0    30
         2 001661   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:151  
         2 001662   100000 473510                    LDP3    0,X0,PR1
         2 001663   300031 236100                    LDQ     25,,PR3
         2 001664   020000 316007                    CANQ    8192,DL
         2 001665   001671 600000 2                  TZE     s:12939

      863    12938    2                   THEN CALL M$CLOSE(FPT_CLOSE) ;

  12938  2 001666   200672 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 001667   050001 713400                    CLIMB   close
         2 001670   406000 401760                    pmme    nvectors=13

      864    12939    2                 CALL CPB$OPENCS ;

  12939  2 001671   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001672   000000 701000 xent               TSX1    CPB$OPENCS
         2 001673   000000 011000                    NOP     0

      865    12940    2               END ; /* THEN DO */

      866    12941    1   CPK$CHECK_ALTRET:
      867    12942    1         IF NOTIFYING AND CP_CHFLAGS.FLG.TERM

  12942  2 001674   200137 234100       CPK$CHECK_A* SZN     NOTIFYING,,AUTO
         2 001675   001704 605000 2                  TPL     s:12945
         2 001676   200220 236100                    LDQ     CP_CHFLAGS+25,,AUTO
         2 001677   040000 316007                    CANQ    16384,DL
         2 001700   001704 600000 2                  TZE     s:12945

      868    12943    1             THEN
      869    12944    1               B$JIT.CPFLAGS1.SOMENOTIFY = %YES# ;

  12944  2 001701   000000 470400 xsym               LDP0    B$JIT$
         2 001702   000040 236003                    LDQ     32,DU
         2 001703   000143 256100                    ORSQ    99,,PR0

      870    12945    1         IF SYSTEM_OK#

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:152  
  12945  2 001704   200125 234100                    SZN     SYSTEM_OK#,,AUTO
         2 001705   001713 605000 2                  TPL     s:12949

      871    12946    1           THEN
      872    12947    2             CALL M$RPRIV(FPT_PRIV_DISPJOB) WHENALTRETURN DO; END;

  12947  2 001706   000160 630400 1                  EPPR0   FPT_PRIV_DISPJOB
         2 001707   420013 713400                    CLIMB   alt,+8203
         2 001710   400000 401760                    pmme    nvectors=1
         2 001711   001713 702000 2                  TSX2    s:12949
         2 001712   001713 710000 2                  TRA     s:12949

      873    12948
      874    12949    1         ALTRETURN;

  12949  2 001713   000000 702200 xent               TSX2  ! X66_AALT

      875    12950        %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:153  
      876    12951    1   SETUP_Q_SRCH: PROC ;

  12951  2 001714   201312 741300       SETUP_Q_SRCH STX1  ! VLR_JOBSTATS_CHECK+24,,AUTO

      877    12952
      878    12953    2         IF CMD_TYPE ~= %NOTIFY_CMD#

  12953  2 001715   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 001716   000001 115007                    CMPA    1,DL
         2 001717   001747 601000 2                  TNZ     DONT_REMEMBER_Q_SRCH

      879    12954    2             THEN GOTO DONT_REMEMBER_Q_SRCH ;
      880    12955    3         DO WHILE(FIRST_QFLAG) ;

  12955  2 001720   200140 234100                    SZN     FIRST_QFLAG,,AUTO
         2 001721   001730 605000 2                  TPL     s:12959

      881    12956    3           FIRST_QFLAG = '0'B ;

  12956  2 001722   200140 450100                    STZ     FIRST_QFLAG,,AUTO

      882    12957    3           CP_CHFLAGS.FLG = '0'B ;

  12957  2 001723   000100 100400                    MLR     fill='000'O
         2 001724   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001725   200220 400004                    ADSC9   CP_CHFLAGS+25,,AUTO      cn=2,n=4

      883    12958    3         END ; /* DO WHILE */

  12958  2 001726   200140 234100                    SZN     FIRST_QFLAG,,AUTO
         2 001727   001722 604000 2                  TMI     s:12956

      884    12959    2         IF (CMD_CODE = %CH_INPUT)

  12959  2 001730   200154 235100                    LDA     CMD_CODE,,AUTO
         2 001731   000007 115007                    CMPA    7,DL
         2 001732   001736 601000 2                  TNZ     s:12964
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:154  

      885    12960    2             THEN                                  /* INPUT */
      886    12961    3               DO ;

      887    12962    3                 CP_CHFLAGS.FLG.INPUT = %YES# ;

  12962  2 001733   020000 236007                    LDQ     8192,DL
         2 001734   200220 256100                    ORSQ    CP_CHFLAGS+25,,AUTO

      888    12963    3               END ; /* THEN DO */

  12963  2 001735   001747 710000 2                  TRA     DONT_REMEMBER_Q_SRCH

      889    12964    2             ELSE IF (CMD_CODE = %CH_RUN) OR CMD_CODE = %CH_JOB

  12964  2 001736   000012 115007                    CMPA    10,DL
         2 001737   001742 600000 2                  TZE     s:12967
         2 001740   000010 115007                    CMPA    8,DL
         2 001741   001745 601000 2                  TNZ     s:12971

      890    12965    2                     THEN                          /* RUNNING */
      891    12966    3                       DO ;

      892    12967    3                         CP_CHFLAGS.FLG.RUNNING = %YES# ;

  12967  2 001742   004000 236007                    LDQ     2048,DL
         2 001743   200220 256100                    ORSQ    CP_CHFLAGS+25,,AUTO

      893    12968    3                        END ; /* THEN DO */

  12968  2 001744   001747 710000 2                  TRA     DONT_REMEMBER_Q_SRCH

      894    12969    2                     ELSE                          /* OUTPUT */
      895    12970    3                       DO ;

      896    12971    3                         CP_CHFLAGS.FLG.OUTPUT = %YES# ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:155  
  12971  2 001745   010000 236007                    LDQ     4096,DL
         2 001746   200220 256100                    ORSQ    CP_CHFLAGS+25,,AUTO

      897    12972    3                       END ; /* ELSE DO */

      898    12973    2   DONT_REMEMBER_Q_SRCH:
      899    12974
      900    12975    2         Q_CRITERIA = CVLP_CRITERIA ;

  12975  2 001747   000100 100400       DONT_REMEMB* MLR     fill='000'O
         2 001750   000000 000116 xsym               ADSC9   CVLP_CRITERIA            cn=0,n=78
         2 001751   201202 000116                    ADSC9   Q_CRITERIA,,AUTO         cn=0,n=78

      901    12976    2         IF (CMD_CODE = %CH_RUN) OR CMD_CODE = %CH_JOB

  12976  2 001752   200154 235100                    LDA     CMD_CODE,,AUTO
         2 001753   000012 115007                    CMPA    10,DL
         2 001754   001757 600000 2                  TZE     s:12977
         2 001755   000010 115007                    CMPA    8,DL
         2 001756   001761 601000 2                  TNZ     s:12978

      902    12977    2           THEN Q_CRITERIA.RUNNING# = %YES# ;

  12977  2 001757   010000 236003                    LDQ     4096,DU
         2 001760   201212 256100                    ORSQ    Q_CRITERIA+8,,AUTO

      903    12978    2         IF (CP_CHFLAGS.SYSTEM)

  12978  2 001761   200217 236100                    LDQ     CP_CHFLAGS+24,,AUTO
         2 001762   400000 316007                    CANQ    -131072,DL
         2 001763   001770 600000 2                  TZE     s:12980

      904    12979    2             THEN  Q_CRITERIA.ACCT# = ' ' ;

  12979  2 001764   000035 235000 xsym               LDA     B_VECTNIL+29
         2 001765   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 001766   201206 757100                    STAQ    Q_CRITERIA+4,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:156  
         2 001767   001774 710000 2                  TRA     s:12982

      905    12980    2             ELSE  Q_CRITERIA.ACCT# = B$JIT$ -> B$JIT.ACCN ;

  12980  2 001770   000000 470400 xsym               LDP0    B$JIT$
         2 001771   040100 100500                    MLR     fill='040'O
         2 001772   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 001773   201206 000010                    ADSC9   Q_CRITERIA+4,,AUTO       cn=0,n=8

      906    12981
      907    12982    2         IF P$ -> P$B.NSUBLKS ~= 0

  12982  2 001774   200004 470500                    LDP0    P$,,AUTO
         2 001775   000001 220100                    LDX0    1,,PR0
         2 001776   002215 600000 2                  TZE     s:13039+5

      908    12983    2             THEN
      909    12984    3                 DO J = 0 TO P$ -> P$B.NSUBLKS - 1 ;

  12984  2 001777   200145 450100                    STZ     J,,AUTO
         2 002000   002211 710000 2                  TRA     s:13039+1

      910    12985
      911    12986    4                     DO CASE(P$ ->P$B.SUBLK$(J) -> P$B.CODE) ;

  12986  2 002001   200004 470500                    LDP0    P$,,AUTO
         2 002002   200145 720100                    LXL0    J,,AUTO
         2 002003   000003 471510                    LDP1    3,X0,PR0
         2 002004   100000 236100                    LDQ     0,,PR1
         2 002005   777777 376007                    ANQ     -1,DL
         2 002006   000770 136007                    SBLQ    504,DL
         2 002007   000057 116007                    CMPQ    47,DL
         2 002010   002012 602006 2                  TNC     s:12986+9,QL
         2 002011   002210 710000 2                  TRA     s:13039
         2 002012   002074 710000 2                  TRA     s:12992
         2 002013   002210 710000 2                  TRA     s:13039
         2 002014   002210 710000 2                  TRA     s:13039
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:157  
         2 002015   002210 710000 2                  TRA     s:13039
         2 002016   002210 710000 2                  TRA     s:13039
         2 002017   002210 710000 2                  TRA     s:13039
         2 002020   002071 710000 2                  TRA     s:12989
         2 002021   002113 710000 2                  TRA     s:12998
         2 002022   002120 710000 2                  TRA     s:13002
         2 002023   002136 710000 2                  TRA     s:13008
         2 002024   002141 710000 2                  TRA     s:13011
         2 002025   002162 710000 2                  TRA     s:13020
         2 002026   002210 710000 2                  TRA     s:13039
         2 002027   002157 710000 2                  TRA     s:13017
         2 002030   002171 710000 2                  TRA     s:13023
         2 002031   002210 710000 2                  TRA     s:13039
         2 002032   002210 710000 2                  TRA     s:13039
         2 002033   002210 710000 2                  TRA     s:13039
         2 002034   002210 710000 2                  TRA     s:13039
         2 002035   002210 710000 2                  TRA     s:13039
         2 002036   002210 710000 2                  TRA     s:13039
         2 002037   002210 710000 2                  TRA     s:13039
         2 002040   002210 710000 2                  TRA     s:13039
         2 002041   002210 710000 2                  TRA     s:13039
         2 002042   002210 710000 2                  TRA     s:13039
         2 002043   002210 710000 2                  TRA     s:13039
         2 002044   002210 710000 2                  TRA     s:13039
         2 002045   002210 710000 2                  TRA     s:13039
         2 002046   002210 710000 2                  TRA     s:13039
         2 002047   002210 710000 2                  TRA     s:13039
         2 002050   002210 710000 2                  TRA     s:13039
         2 002051   002210 710000 2                  TRA     s:13039
         2 002052   002210 710000 2                  TRA     s:13039
         2 002053   002210 710000 2                  TRA     s:13039
         2 002054   002210 710000 2                  TRA     s:13039
         2 002055   002210 710000 2                  TRA     s:13039
         2 002056   002210 710000 2                  TRA     s:13039
         2 002057   002210 710000 2                  TRA     s:13039
         2 002060   002210 710000 2                  TRA     s:13039
         2 002061   002210 710000 2                  TRA     s:13039
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:158  
         2 002062   002210 710000 2                  TRA     s:13039
         2 002063   002210 710000 2                  TRA     s:13039
         2 002064   002210 710000 2                  TRA     s:13039
         2 002065   002210 710000 2                  TRA     s:13039
         2 002066   002200 710000 2                  TRA     s:13030
         2 002067   002203 710000 2                  TRA     s:13033
         2 002070   002206 710000 2                  TRA     s:13036

      912    12987
      913    12988    4                         CASE(%CH_NOTACCT) ;

      914    12989    4                           Q_CRITERIA.NOTACCT# = %YES# ;

  12989  2 002071   001000 236003                    LDQ     512,DU
         2 002072   201212 256100                    ORSQ    Q_CRITERIA+8,,AUTO
         2 002073   002210 710000 2                  TRA     s:13039

      915    12990
      916    12991    4                         CASE(%CH_DOT_ACCT) ;

      917    12992    4                           IF (P$->P$B.SUBLK$(J)->P$B.NSUBLKS = 0)

  12992  2 002074   100001 221100                    LDX1    1,,PR1
         2 002075   002103 601000 2                  TNZ     s:12994

      918    12993    4                               THEN Q_CRITERIA.ACCT# = B$JIT$->B$JIT.ACCN ;

  12993  2 002076   000000 473400 xsym               LDP3    B$JIT$
         2 002077   040100 100500                    MLR     fill='040'O
         2 002100   300001 000010                    ADSC9   1,,PR3                   cn=0,n=8
         2 002101   201206 000010                    ADSC9   Q_CRITERIA+4,,AUTO       cn=0,n=8
         2 002102   002210 710000 2                  TRA     s:13039

      919    12994    4                               ELSE Q_CRITERIA.ACCT# = P$->P$B.SUBLK$(J)

  12994  2 002103   100003 473500                    LDP3    3,,PR1
         2 002104   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:159  
         2 002105   000033 772000                    QRL     27
         2 002106   000000 622006                    EAX2    0,QL
         2 002107   040100 100540                    MLR     fill='040'O
         2 002110   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         2 002111   201206 000010                    ADSC9   Q_CRITERIA+4,,AUTO       cn=0,n=8
         2 002112   002210 710000 2                  TRA     s:13039

      920    12995    4                                       ->P$B.SUBLK$(0)->P$S.TEXT ;
      921    12996
      922    12997    4                         CASE(%CH_NOTTERM) ;

      923    12998    4                           Q_CRITERIA.NOTTNAME# = %YES# ;

  12998  2 002113   000200 236003                    LDQ     128,DU
         2 002114   201212 256100                    ORSQ    Q_CRITERIA+8,,AUTO

      924    12999    4                           Q_CRITERIA.NOTWSN# = %YES# ;

  12999  2 002115   000400 236003                    LDQ     256,DU
         2 002116   201212 256100                    ORSQ    Q_CRITERIA+8,,AUTO
         2 002117   002210 710000 2                  TRA     s:13039

      925    13000
      926    13001    4                         CASE(%CH_AT_TERM) ;

      927    13002    4                           IF (P$->P$B.SUBLK$(J)->P$B.NSUBLKS = 0)

  13002  2 002120   100001 221100                    LDX1    1,,PR1
         2 002121   002126 601000 2                  TNZ     s:13004

      928    13003    4                               THEN Q_CRITERIA.WSN# = B$JIT$->B$JIT.WOO ;

  13003  2 002122   000000 473400 xsym               LDP3    B$JIT$
         2 002123   300010 237100                    LDAQ    8,,PR3
         2 002124   201204 757100                    STAQ    Q_CRITERIA+2,,AUTO
         2 002125   002210 710000 2                  TRA     s:13039

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:160  
      929    13004    4                               ELSE Q_CRITERIA.WSN# = P$->P$B.SUBLK$(J)

  13004  2 002126   100003 473500                    LDP3    3,,PR1
         2 002127   300004 236100                    LDQ     4,,PR3
         2 002130   000033 772000                    QRL     27
         2 002131   000000 622006                    EAX2    0,QL
         2 002132   040100 100540                    MLR     fill='040'O
         2 002133   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         2 002134   201204 000010                    ADSC9   Q_CRITERIA+2,,AUTO       cn=0,n=8
         2 002135   002210 710000 2                  TRA     s:13039

      930    13005    4                                       ->P$B.SUBLK$(0)->P$S.TEXT ;
      931    13006
      932    13007    4                         CASE(%CH_NOTWSN) ;

      933    13008    4                           Q_CRITERIA.NOTWSN# = %YES# ;

  13008  2 002136   000400 236003                    LDQ     256,DU
         2 002137   201212 256100                    ORSQ    Q_CRITERIA+8,,AUTO
         2 002140   002210 710000 2                  TRA     s:13039

      934    13009
      935    13010    4                         CASE(%CH_AT_WSN) ;

      936    13011    4                           IF (P$->P$B.SUBLK$(J)->P$B.NSUBLKS = 0)

  13011  2 002141   100001 221100                    LDX1    1,,PR1
         2 002142   002147 601000 2                  TNZ     s:13013

      937    13012    4                               THEN Q_CRITERIA.WSN# = B$JIT$->B$JIT.WOO ;

  13012  2 002143   000000 473400 xsym               LDP3    B$JIT$
         2 002144   300010 237100                    LDAQ    8,,PR3
         2 002145   201204 757100                    STAQ    Q_CRITERIA+2,,AUTO
         2 002146   002210 710000 2                  TRA     s:13039

      938    13013    4                               ELSE Q_CRITERIA.WSN# = P$->P$B.SUBLK$(J)
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:161  

  13013  2 002147   100003 473500                    LDP3    3,,PR1
         2 002150   300004 236100                    LDQ     4,,PR3
         2 002151   000033 772000                    QRL     27
         2 002152   000000 622006                    EAX2    0,QL
         2 002153   040100 100540                    MLR     fill='040'O
         2 002154   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         2 002155   201204 000010                    ADSC9   Q_CRITERIA+2,,AUTO       cn=0,n=8
         2 002156   002210 710000 2                  TRA     s:13039

      939    13014    4                                       ->P$B.SUBLK$(0)->P$S.TEXT ;
      940    13015
      941    13016    4                         CASE(%CH_NOTFORM) ;

      942    13017    4                           Q_CRITERIA.NOTFORM# = %YES# ;

  13017  2 002157   000100 236003                    LDQ     64,DU
         2 002160   201212 256100                    ORSQ    Q_CRITERIA+8,,AUTO
         2 002161   002210 710000 2                  TRA     s:13039

      943    13018
      944    13019    4                         CASE(%CH_FORM) ;

      945    13020    4                           Q_CRITERIA.FORM# = P$->P$B.SUBLK$(J)->P$S.TEXT ;

  13020  2 002162   100004 236100                    LDQ     4,,PR1
         2 002163   000033 772000                    QRL     27
         2 002164   000000 621006                    EAX1    0,QL
         2 002165   040100 100540                    MLR     fill='040'O
         2 002166   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 002167   201217 000006                    ADSC9   Q_CRITERIA+13,,AUTO      cn=0,n=6
         2 002170   002210 710000 2                  TRA     s:13039

      946    13021
      947    13022    4                         CASE(%CH_DEV) ;

      948    13023    4                           Q_CRITERIA.DEVTYP# = P$->P$B.SUBLK$(J)->P$S.TEXT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:162  

  13023  2 002171   100004 236100                    LDQ     4,,PR1
         2 002172   000033 772000                    QRL     27
         2 002173   000000 621006                    EAX1    0,QL
         2 002174   040100 100540                    MLR     fill='040'O
         2 002175   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 002176   201215 000002                    ADSC9   Q_CRITERIA+11,,AUTO      cn=0,n=2
         2 002177   002210 710000 2                  TRA     s:13039

      949    13024
      950    13025    4                         CASE(%CH_SHORT) ;

      951    13026
      952    13027    4                         CASE(%CH_USEFID) ;

      953    13028
      954    13029    4                         CASE(%CH_INPUT_ALL_OPT) ;

      955    13030    4                           CP_CHFLAGS.INPUT_OPT = %CH_INPUT_ALL_OPT ;

  13030  2 002200   001044 221003                    LDX1    548,DU
         2 002201   200217 741100                    STX1    CP_CHFLAGS+24,,AUTO
         2 002202   002210 710000 2                  TRA     s:13039

      956    13031
      957    13032    4                         CASE(%CH_INPUT_READY_OPT) ;

      958    13033    4                           CP_CHFLAGS.INPUT_OPT = %CH_INPUT_READY_OPT ;

  13033  2 002203   001045 221003                    LDX1    549,DU
         2 002204   200217 741100                    STX1    CP_CHFLAGS+24,,AUTO
         2 002205   002210 710000 2                  TRA     s:13039

      959    13034
      960    13035    4                         CASE(%CH_INPUT_HELD_OPT) ;

      961    13036    4                           CP_CHFLAGS.INPUT_OPT = %CH_INPUT_HELD_OPT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:163  

  13036  2 002206   001046 221003                    LDX1    550,DU
         2 002207   200217 741100                    STX1    CP_CHFLAGS+24,,AUTO

      962    13037
      963    13038    4                     END ; /* DO CASE */

      964    13039    3                 END ; /* DO J */

  13039  2 002210   200145 054100                    AOS     J,,AUTO
         2 002211   000001 236100                    LDQ     1,,PR0
         2 002212   000022 772000                    QRL     18
         2 002213   200145 116100                    CMPQ    J,,AUTO
         2 002214   002001 605400 2                  TPNZ    s:12986
         2 002215   002217 710000 2                  TRA     s:13043

      965    13040
      966    13041                                                /* Set up FPTs. */
      967    13042    2   SETUP_Q_SRCH_JOBSTATS:  ENTRY ;

  13042  2 002216   201312 741300       SETUP_Q_SRC* STX1  ! VLR_JOBSTATS_CHECK+24,,AUTO

      968    13043    2         FPT_JOBSTATS = CFPT_JOBSTATS ;

  13043  2 002217   000100 100400                    MLR     fill='000'O
         2 002220   000000 000220 xsym               ADSC9   CFPT_JOBSTATS            cn=0,n=144
         2 002221   200760 000220                    ADSC9   FPT_JOBSTATS,,AUTO       cn=0,n=144

      969    13044
      970    13045    2         FPT_JOBSTATS.V_ = VECTOR(FPT_JOBSTATS.V) ;

  13045  2 002222   000000 235000 3                  LDA     0
         2 002223   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 002224   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 002225   001010 036003                    ADLQ    520,DU
         2 002226   200760 757100                    STAQ    FPT_JOBSTATS,,AUTO

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:164  
      971    13046    2         IF (CMD_CODE = %CH_OUTPUT)

  13046  2 002227   200154 235100                    LDA     CMD_CODE,,AUTO
         2 002230   000011 115007                    CMPA    9,DL
         2 002231   002235 601000 2                  TNZ     s:13048

      972    13047    2             THEN FPT_JOBSTATS.V.OUTPUT# = %YES# ;

  13047  2 002232   400000 236003                    LDQ     -131072,DU
         2 002233   201013 256100                    ORSQ    FPT_JOBSTATS+27,,AUTO
         2 002234   002237 710000 2                  TRA     s:13049

      973    13048    2             ELSE FPT_JOBSTATS.V.OUTPUT# = %NO# ;

  13048  2 002235   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 002236   201013 356100                    ANSQ    FPT_JOBSTATS+27,,AUTO

      974    13049    2         FPT_JOBSTATS.CRITERIA_ = VECTOR(Q_CRITERIA) ;

  13049  2 002237   000043 235000 3                  LDA     35
         2 002240   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 002241   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 002242   001202 036003                    ADLQ    642,DU
         2 002243   200766 757100                    STAQ    FPT_JOBSTATS+6,,AUTO

      975    13050    2         RES$ = SEG4$ ;

  13050  2 002244   000000 236000 xsym               LDQ     SEG4$
         2 002245   200014 756100                    STQ     RES$,,AUTO

      976    13051    2         SN$ = PINCRW(RES$, 1024) ;

  13051  2 002246   002000 036003                    ADLQ    1024,DU
         2 002247   200015 756100                    STQ     SN$,,AUTO

      977    13052    2         STAT$ = PINCRW(SN$, 1024) ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:165  
  13052  2 002250   002000 036003                    ADLQ    1024,DU
         2 002251   200013 756100                    STQ     STAT$,,AUTO

      978    13053
      979    13054    2         FPT_JOBSTATS.RESULTS_ = RESULTS_;

  13054  2 002252   200450 237100                    LDAQ    RESULTS_,,AUTO
         2 002253   200764 757100                    STAQ    FPT_JOBSTATS+4,,AUTO

      980    13055    2         FPT_JOBSTATS.RESLIST_ = VECTOR(RES$->B$$PAGE) ;

  13055  2 002254   000013 235000 3                  LDA     11
         2 002255   200014 236100                    LDQ     RES$,,AUTO
         2 002256   200776 757100                    STAQ    FPT_JOBSTATS+14,,AUTO

      981    13056    2         FPT_JOBSTATS.SNLIST_  = VECTOR(SN$->B$$PAGE) ;

  13056  2 002257   000013 235000 3                  LDA     11
         2 002260   200015 236100                    LDQ     SN$,,AUTO
         2 002261   200774 757100                    STAQ    FPT_JOBSTATS+12,,AUTO

      982    13057
      983    13058    2         RETURN ;

  13058  2 002262   201312 221300                    LDX1  ! VLR_JOBSTATS_CHECK+24,,AUTO
         2 002263   000001 702211                    TSX2  ! 1,X1

      984    13059
      985    13060    2   END   SETUP_Q_SRCH ;
      986    13061        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:166  
      987    13062    1   SETUP_SYSID_SRCH:   PROC ALTRET ;

  13062  2 002264   201316 741300       SETUP_SYSID* STX1  ! RETURN_FLG+1,,AUTO

      988    13063
      989    13064    2         IF USEFID_OPEN# = %NO#

  13064  2 002265   200121 234100                    SZN     USEFID_OPEN#,,AUTO
         2 002266   002271 604000 2                  TMI     s:13068

      990    13065    2             THEN
      991    13066    2               CALL OPEN_USEFILE ALTRET(E_SETUP_SYSID_SRCH) ;

  13066  2 002267   007323 701000 2                  TSX1    OPEN_USEFILE
         2 002270   004151 702000 2                  TSX2    E_SETUP_SYSID_SRCH

      992    13067                                                        /* Set up JOBSTATS fpt */
      993    13068    2         IF CMD_TYPE = %SUBMIT_CMD#

  13068  2 002271   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 002272   000002 115007                    CMPA    2,DL
         2 002273   002311 601000 2                  TNZ     s:13078

      994    13069    2           THEN
      995    13070    2             IF NSTATUS_FLG OR ( NOT(B$JIT.PRIV.AUTH & %PR_DISPJOB#) AND

  13070  2 002274   200126 234100                    SZN     NSTATUS_FLG,,AUTO
         2 002275   002304 604000 2                  TMI     s:13074
         2 002276   000000 470400 xsym               LDP0    B$JIT$
         2 002277   000014 236100                    LDQ     12,,PR0
         2 002300   000026 376000 xsym               ANQ     B_VECTNIL+22
         2 002301   002311 601000 2                  TNZ     s:13078
         2 002302   200127 234100                    SZN     CROSS_ACCT_BATCH_FLG,,AUTO
         2 002303   002311 605000 2                  TPL     s:13078

      996    13071    2                                 CROSS_ACCT_BATCH_FLG)
      997    13072    2               THEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:167  
      998    13073    3                 DO ;

      999    13074    3                   CALL SETUP_DUMMY_SUBMIT_MESS ;

  13074  2 002304   007634 701000 2                  TSX1    SETUP_DUMMY_SUBMIT_MESS
         2 002305   000000 011000                    NOP     0

     1000    13075    3                   CALL PRINT_SUBMIT_MESS ;

  13075  2 002306   007664 701000 2                  TSX1    PRINT_SUBMIT_MESS
         2 002307   000000 011000                    NOP     0

     1001    13076    3                   GOTO SETUP_SYSID_SRCH_RETURN ;

  13076  2 002310   004147 710000 2                  TRA     SETUP_SYSID_SRCH_RETURN

     1002    13077    3                 END ; /* Then Do */
     1003    13078    2         FPT_JOBSTATS = CFPT_JOBSTATS ;

  13078  2 002311   000100 100400                    MLR     fill='000'O
         2 002312   000000 000220 xsym               ADSC9   CFPT_JOBSTATS            cn=0,n=144
         2 002313   200760 000220                    ADSC9   FPT_JOBSTATS,,AUTO       cn=0,n=144

     1004    13079    2         FPT_JOBSTATS.V_ = VECTOR(FPT_JOBSTATS.V) ;

  13079  2 002314   000000 235000 3                  LDA     0
         2 002315   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 002316   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 002317   001010 036003                    ADLQ    520,DU
         2 002320   200760 757100                    STAQ    FPT_JOBSTATS,,AUTO

     1005    13080    2         FPT_JOBSTATS.V.ORDER# = %SRCH# ;

  13080  2 002321   000002 235007                    LDA     2,DL
         2 002322   201010 755100                    STA     FPT_JOBSTATS+24,,AUTO

     1006    13081    2         FPT_JOBSTATS.CRITERIA_ = VECTOR(SYSID_CRITERIA) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:168  

  13081  2 002323   000043 235000 3                  LDA     35
         2 002324   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 002325   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 002326   001226 036003                    ADLQ    662,DU
         2 002327   200766 757100                    STAQ    FPT_JOBSTATS+6,,AUTO

     1007    13082
     1008    13083    2         RES$ = SEG4$ ;

  13083  2 002330   000000 236000 xsym               LDQ     SEG4$
         2 002331   200014 756100                    STQ     RES$,,AUTO

     1009    13084    2         SN$ = PINCRW(RES$, 1024) ;

  13084  2 002332   002000 036003                    ADLQ    1024,DU
         2 002333   200015 756100                    STQ     SN$,,AUTO

     1010    13085    2         STAT$ = PINCRW(SN$, 1024) ;

  13085  2 002334   002000 036003                    ADLQ    1024,DU
         2 002335   200013 756100                    STQ     STAT$,,AUTO

     1011    13086
     1012    13087    2         FPT_JOBSTATS.RESULTS_ = RESULTS_;

  13087  2 002336   200450 237100                    LDAQ    RESULTS_,,AUTO
         2 002337   200764 757100                    STAQ    FPT_JOBSTATS+4,,AUTO

     1013    13088    2         FPT_JOBSTATS.RESLIST_ = VECTOR(RES$->B$$PAGE) ;

  13088  2 002340   000013 235000 3                  LDA     11
         2 002341   200014 236100                    LDQ     RES$,,AUTO
         2 002342   200776 757100                    STAQ    FPT_JOBSTATS+14,,AUTO

     1014    13089    2         FPT_JOBSTATS.SNLIST_  = VECTOR(SN$->B$$PAGE) ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:169  
  13089  2 002343   000013 235000 3                  LDA     11
         2 002344   200015 236100                    LDQ     SN$,,AUTO
         2 002345   200774 757100                    STAQ    FPT_JOBSTATS+12,,AUTO

     1015    13090
     1016    13091    2         SYSID_CRITERIA = CVLP_CRITERIA ;

  13091  2 002346   000100 100400                    MLR     fill='000'O
         2 002347   000000 000116 xsym               ADSC9   CVLP_CRITERIA            cn=0,n=78
         2 002350   201226 000116                    ADSC9   SYSID_CRITERIA,,AUTO     cn=0,n=78

     1017    13092                                                /* Setup range of jobstats search. */
     1018    13093    2         IF SYSTEM_OK# = %NO#

  13093  2 002351   200125 234100                    SZN     SYSTEM_OK#,,AUTO
         2 002352   002376 604000 2                  TMI     s:13108

     1019    13094    2           THEN
     1020    13095    2             IF (B$JIT.PRIV.AUTH & %PR_DISPJOB#)

  13095  2 002353   000000 470400 xsym               LDP0    B$JIT$
         2 002354   000014 236100                    LDQ     12,,PR0
         2 002355   000026 376000 xsym               ANQ     B_VECTNIL+22
         2 002356   002372 600000 2                  TZE     s:13106

     1021    13096    2               THEN                                      /* SYSTEM ok */
     1022    13097    2                 CALL M$SPRIV(FPT_PRIV_DISPJOB) WHENRETURN

  13097  2 002357   000160 630400 1                  EPPR0   FPT_PRIV_DISPJOB
         2 002360   420012 713400                    CLIMB   alt,+8202
         2 002361   400000 401760                    pmme    nvectors=1
         2 002362   002371 702000 2                  TSX2    s:13103

     1023    13098    3                       DO;

     1024    13099    3                         SYSTEM_OK# = %YES# ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:170  
  13099  2 002363   400000 236003                    LDQ     -131072,DU
         2 002364   200125 756100                    STQ     SYSTEM_OK#,,AUTO

     1025    13100    3                         SYSID_CRITERIA.ACCT# = ' ';

  13100  2 002365   000035 235000 xsym               LDA     B_VECTNIL+29
         2 002366   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 002367   201232 757100                    STAQ    SYSID_CRITERIA+4,,AUTO

     1026    13101    3                       END;  /* Whenreturn */

  13101  2 002370   002371 710000 2                  TRA     s:13103

     1027    13102    3                       WHENALTRETURN DO;

     1028    13103    3                       END;

  13103  2 002371   002401 710000 2                  TRA     s:13110

     1029    13104    2               ELSE
     1030    13105                                                              /* User's account only */
     1031    13106    2                 SYSID_CRITERIA.ACCT# = B$JIT$->B$JIT.ACCN;

  13106  2 002372   040100 100500                    MLR     fill='040'O
         2 002373   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 002374   201232 000010                    ADSC9   SYSID_CRITERIA+4,,AUTO   cn=0,n=8
         2 002375   002401 710000 2                  TRA     s:13110

     1032    13107    2           ELSE                                          /* SYSTEM already set. */
     1033    13108    2             SYSID_CRITERIA.ACCT# = ' ';

  13108  2 002376   000035 235000 xsym               LDA     B_VECTNIL+29
         2 002377   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 002400   201232 757100                    STAQ    SYSID_CRITERIA+4,,AUTO

     1034    13109                                                              /* Get comment */
     1035    13110    2         IF CMD_CODE = %CH_NOOPTIONS    /* Set default COMMENT. */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:171  

  13110  2 002401   200154 235100                    LDA     CMD_CODE,,AUTO
         2 002402   000027 115007                    CMPA    23,DL
         2 002403   002410 601000 2                  TNZ     s:13114

     1036    13111    2             THEN
     1037    13112    2               CH_XFORMAT.COMMENT# = SYSIDBUF.COMMENT ;

  13112  2 002404   040100 100500                    MLR     fill='040'O
         2 002405   200360 600030                    ADSC9   SYSIDBUF+12,,AUTO        cn=3,n=24
         2 002406   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24
         2 002407   002421 710000 2                  TRA     s:13119

     1038    13113    2             ELSE
     1039    13114    2               IF CMD_CODE = %CH_TERM_CMD

  13114  2 002410   000003 115007                    CMPA    3,DL
         2 002411   002416 601000 2                  TNZ     s:13118

     1040    13115    2                 THEN
     1041    13116    2                   CH_XFORMAT.COMMENT# = 'This terminal''s output.' ;

  13116  2 002412   040100 100400                    MLR     fill='040'O
         2 002413   000301 000027 1                  ADSC9   JOBSTATS_ACCT+4          cn=0,n=23
         2 002414   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24
         2 002415   002421 710000 2                  TRA     s:13119

     1042    13117    2                 ELSE
     1043    13118    2                   CH_XFORMAT.COMMENT# = ' ' ;

  13118  2 002416   040100 100400                    MLR     fill='040'O
         2 002417   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002420   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     1044    13119    2         VLP_JOBNAME.JOBNAME# = ' ' ;

  13119  2 002421   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:172  
         2 002422   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002423   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31

     1045    13120    2         FPT_JOBSTATS.JOBNAME_ = VECTOR(NIL) ;

  13120  2 002424   000046 237000 3                  LDAQ    38
         2 002425   200770 757100                    STAQ    FPT_JOBSTATS+8,,AUTO

     1046    13121    2         FID_ACCT.ACCT# = B$JIT.ACCN ;

  13121  2 002426   000000 470400 xsym               LDP0    B$JIT$
         2 002427   040100 100500                    MLR     fill='040'O
         2 002430   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 002431   201200 000010                    ADSC9   FID_ACCT,,AUTO           cn=0,n=8

     1047    13122    2         DELUSEREC = '0'B;

  13122  2 002432   200123 450100                    STZ     DELUSEREC,,AUTO

     1048    13123
     1049    13124    3         DO CASE (CMD_CODE) ;

  13124  2 002433   200154 235100                    LDA     CMD_CODE,,AUTO
         2 002434   000030 115007                    CMPA    24,DL
         2 002435   002437 602005 2                  TNC     s:13124+4,AL
         2 002436   002472 710000 2                  TRA     s:13132
         2 002437   002472 710000 2                  TRA     s:13132
         2 002440   002472 710000 2                  TRA     s:13132
         2 002441   002472 710000 2                  TRA     s:13132
         2 002442   002467 710000 2                  TRA     s:13127
         2 002443   002472 710000 2                  TRA     s:13132
         2 002444   002472 710000 2                  TRA     s:13132
         2 002445   002472 710000 2                  TRA     s:13132
         2 002446   002472 710000 2                  TRA     s:13132
         2 002447   002472 710000 2                  TRA     s:13132
         2 002450   002472 710000 2                  TRA     s:13132
         2 002451   002472 710000 2                  TRA     s:13132
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:173  
         2 002452   002472 710000 2                  TRA     s:13132
         2 002453   002472 710000 2                  TRA     s:13132
         2 002454   002472 710000 2                  TRA     s:13132
         2 002455   002472 710000 2                  TRA     s:13132
         2 002456   002472 710000 2                  TRA     s:13132
         2 002457   002472 710000 2                  TRA     s:13132
         2 002460   002472 710000 2                  TRA     s:13132
         2 002461   002472 710000 2                  TRA     s:13132
         2 002462   002472 710000 2                  TRA     s:13132
         2 002463   002472 710000 2                  TRA     s:13132
         2 002464   002467 710000 2                  TRA     s:13127
         2 002465   002472 710000 2                  TRA     s:13132
         2 002466   002467 710000 2                  TRA     s:13127

     1050    13125
     1051    13126    3             CASE(%CH_LAST,%CH_TERM_CMD,%CH_NOOPTIONS) ;

     1052    13127    3               SYSID_CRITERIA.SYSID# = TEMP ;

  13127  2 002467   200147 235100                    LDA     TEMP,,AUTO
         2 002470   201234 755100                    STA     SYSID_CRITERIA+6,,AUTO

     1053    13128    3               SYSID_CRITERIA.SYSID1# = TEMP ;

  13128  2 002471   201235 755100                    STA     SYSID_CRITERIA+7,,AUTO

     1054    13129
     1055    13130    3         END ; /* DO CASE */

     1056    13131
     1057    13132    2         IF CMD_CODE ~= %CH_NOOPTIONS

  13132  2 002472   200154 235100                    LDA     CMD_CODE,,AUTO
         2 002473   000027 115007                    CMPA    23,DL
         2 002474   003732 600000 2                  TZE     s:13204

     1058    13133    2           THEN    /* Handle the options */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:174  
     1059    13134    3             DO;

     1060    13135    4               DO J=0 TO P$->P$B.NSUBLKS-1;

  13135  2 002475   200145 450100                    STZ     J,,AUTO
         2 002476   003646 710000 2                  TRA     s:13172+1

     1061    13136    5                 DO CASE(P$->P$B.SUBLK$(J)->P$B.CODE);

  13136  2 002477   200004 470500                    LDP0    P$,,AUTO
         2 002500   200145 720100                    LXL0    J,,AUTO
         2 002501   000003 471510                    LDP1    3,X0,PR0
         2 002502   100000 721100                    LXL1    0,,PR1
         2 002503   001043 101003                    CMPX1   547,DU
         2 002504   002506 602011 2                  TNC     s:13136+7,X1
         2 002505   003645 710000 2                  TRA     s:13172
         2 002506   003645 710000 2                  TRA     s:13172
         2 002507   003575 710000 2                  TRA     s:13151
         2 002510   003645 710000 2                  TRA     s:13172
         2 002511   003645 710000 2                  TRA     s:13172
         2 002512   003645 710000 2                  TRA     s:13172
         2 002513   003645 710000 2                  TRA     s:13172
         2 002514   003645 710000 2                  TRA     s:13172
         2 002515   003645 710000 2                  TRA     s:13172
         2 002516   003645 710000 2                  TRA     s:13172
         2 002517   003645 710000 2                  TRA     s:13172
         2 002520   003645 710000 2                  TRA     s:13172
         2 002521   003645 710000 2                  TRA     s:13172
         2 002522   003645 710000 2                  TRA     s:13172
         2 002523   003645 710000 2                  TRA     s:13172
         2 002524   003645 710000 2                  TRA     s:13172
         2 002525   003645 710000 2                  TRA     s:13172
         2 002526   003645 710000 2                  TRA     s:13172
         2 002527   003645 710000 2                  TRA     s:13172
         2 002530   003645 710000 2                  TRA     s:13172
         2 002531   003645 710000 2                  TRA     s:13172
         2 002532   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:175  
         2 002533   003645 710000 2                  TRA     s:13172
         2 002534   003645 710000 2                  TRA     s:13172
         2 002535   003645 710000 2                  TRA     s:13172
         2 002536   003645 710000 2                  TRA     s:13172
         2 002537   003645 710000 2                  TRA     s:13172
         2 002540   003645 710000 2                  TRA     s:13172
         2 002541   003645 710000 2                  TRA     s:13172
         2 002542   003645 710000 2                  TRA     s:13172
         2 002543   003645 710000 2                  TRA     s:13172
         2 002544   003645 710000 2                  TRA     s:13172
         2 002545   003645 710000 2                  TRA     s:13172
         2 002546   003645 710000 2                  TRA     s:13172
         2 002547   003645 710000 2                  TRA     s:13172
         2 002550   003645 710000 2                  TRA     s:13172
         2 002551   003645 710000 2                  TRA     s:13172
         2 002552   003645 710000 2                  TRA     s:13172
         2 002553   003645 710000 2                  TRA     s:13172
         2 002554   003645 710000 2                  TRA     s:13172
         2 002555   003645 710000 2                  TRA     s:13172
         2 002556   003645 710000 2                  TRA     s:13172
         2 002557   003645 710000 2                  TRA     s:13172
         2 002560   003645 710000 2                  TRA     s:13172
         2 002561   003645 710000 2                  TRA     s:13172
         2 002562   003645 710000 2                  TRA     s:13172
         2 002563   003645 710000 2                  TRA     s:13172
         2 002564   003645 710000 2                  TRA     s:13172
         2 002565   003645 710000 2                  TRA     s:13172
         2 002566   003645 710000 2                  TRA     s:13172
         2 002567   003645 710000 2                  TRA     s:13172
         2 002570   003645 710000 2                  TRA     s:13172
         2 002571   003645 710000 2                  TRA     s:13172
         2 002572   003645 710000 2                  TRA     s:13172
         2 002573   003645 710000 2                  TRA     s:13172
         2 002574   003645 710000 2                  TRA     s:13172
         2 002575   003645 710000 2                  TRA     s:13172
         2 002576   003645 710000 2                  TRA     s:13172
         2 002577   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:176  
         2 002600   003645 710000 2                  TRA     s:13172
         2 002601   003645 710000 2                  TRA     s:13172
         2 002602   003645 710000 2                  TRA     s:13172
         2 002603   003645 710000 2                  TRA     s:13172
         2 002604   003645 710000 2                  TRA     s:13172
         2 002605   003645 710000 2                  TRA     s:13172
         2 002606   003645 710000 2                  TRA     s:13172
         2 002607   003645 710000 2                  TRA     s:13172
         2 002610   003645 710000 2                  TRA     s:13172
         2 002611   003645 710000 2                  TRA     s:13172
         2 002612   003645 710000 2                  TRA     s:13172
         2 002613   003645 710000 2                  TRA     s:13172
         2 002614   003645 710000 2                  TRA     s:13172
         2 002615   003645 710000 2                  TRA     s:13172
         2 002616   003645 710000 2                  TRA     s:13172
         2 002617   003645 710000 2                  TRA     s:13172
         2 002620   003645 710000 2                  TRA     s:13172
         2 002621   003645 710000 2                  TRA     s:13172
         2 002622   003645 710000 2                  TRA     s:13172
         2 002623   003645 710000 2                  TRA     s:13172
         2 002624   003645 710000 2                  TRA     s:13172
         2 002625   003645 710000 2                  TRA     s:13172
         2 002626   003645 710000 2                  TRA     s:13172
         2 002627   003645 710000 2                  TRA     s:13172
         2 002630   003645 710000 2                  TRA     s:13172
         2 002631   003645 710000 2                  TRA     s:13172
         2 002632   003645 710000 2                  TRA     s:13172
         2 002633   003645 710000 2                  TRA     s:13172
         2 002634   003645 710000 2                  TRA     s:13172
         2 002635   003645 710000 2                  TRA     s:13172
         2 002636   003645 710000 2                  TRA     s:13172
         2 002637   003645 710000 2                  TRA     s:13172
         2 002640   003645 710000 2                  TRA     s:13172
         2 002641   003645 710000 2                  TRA     s:13172
         2 002642   003645 710000 2                  TRA     s:13172
         2 002643   003645 710000 2                  TRA     s:13172
         2 002644   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:177  
         2 002645   003645 710000 2                  TRA     s:13172
         2 002646   003645 710000 2                  TRA     s:13172
         2 002647   003645 710000 2                  TRA     s:13172
         2 002650   003645 710000 2                  TRA     s:13172
         2 002651   003645 710000 2                  TRA     s:13172
         2 002652   003645 710000 2                  TRA     s:13172
         2 002653   003645 710000 2                  TRA     s:13172
         2 002654   003645 710000 2                  TRA     s:13172
         2 002655   003645 710000 2                  TRA     s:13172
         2 002656   003645 710000 2                  TRA     s:13172
         2 002657   003645 710000 2                  TRA     s:13172
         2 002660   003645 710000 2                  TRA     s:13172
         2 002661   003645 710000 2                  TRA     s:13172
         2 002662   003645 710000 2                  TRA     s:13172
         2 002663   003645 710000 2                  TRA     s:13172
         2 002664   003645 710000 2                  TRA     s:13172
         2 002665   003645 710000 2                  TRA     s:13172
         2 002666   003645 710000 2                  TRA     s:13172
         2 002667   003645 710000 2                  TRA     s:13172
         2 002670   003645 710000 2                  TRA     s:13172
         2 002671   003645 710000 2                  TRA     s:13172
         2 002672   003645 710000 2                  TRA     s:13172
         2 002673   003645 710000 2                  TRA     s:13172
         2 002674   003645 710000 2                  TRA     s:13172
         2 002675   003645 710000 2                  TRA     s:13172
         2 002676   003645 710000 2                  TRA     s:13172
         2 002677   003645 710000 2                  TRA     s:13172
         2 002700   003645 710000 2                  TRA     s:13172
         2 002701   003645 710000 2                  TRA     s:13172
         2 002702   003645 710000 2                  TRA     s:13172
         2 002703   003645 710000 2                  TRA     s:13172
         2 002704   003645 710000 2                  TRA     s:13172
         2 002705   003645 710000 2                  TRA     s:13172
         2 002706   003645 710000 2                  TRA     s:13172
         2 002707   003645 710000 2                  TRA     s:13172
         2 002710   003645 710000 2                  TRA     s:13172
         2 002711   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:178  
         2 002712   003645 710000 2                  TRA     s:13172
         2 002713   003645 710000 2                  TRA     s:13172
         2 002714   003645 710000 2                  TRA     s:13172
         2 002715   003645 710000 2                  TRA     s:13172
         2 002716   003645 710000 2                  TRA     s:13172
         2 002717   003645 710000 2                  TRA     s:13172
         2 002720   003645 710000 2                  TRA     s:13172
         2 002721   003645 710000 2                  TRA     s:13172
         2 002722   003645 710000 2                  TRA     s:13172
         2 002723   003645 710000 2                  TRA     s:13172
         2 002724   003645 710000 2                  TRA     s:13172
         2 002725   003645 710000 2                  TRA     s:13172
         2 002726   003645 710000 2                  TRA     s:13172
         2 002727   003645 710000 2                  TRA     s:13172
         2 002730   003645 710000 2                  TRA     s:13172
         2 002731   003645 710000 2                  TRA     s:13172
         2 002732   003645 710000 2                  TRA     s:13172
         2 002733   003645 710000 2                  TRA     s:13172
         2 002734   003645 710000 2                  TRA     s:13172
         2 002735   003645 710000 2                  TRA     s:13172
         2 002736   003645 710000 2                  TRA     s:13172
         2 002737   003645 710000 2                  TRA     s:13172
         2 002740   003645 710000 2                  TRA     s:13172
         2 002741   003645 710000 2                  TRA     s:13172
         2 002742   003645 710000 2                  TRA     s:13172
         2 002743   003645 710000 2                  TRA     s:13172
         2 002744   003645 710000 2                  TRA     s:13172
         2 002745   003645 710000 2                  TRA     s:13172
         2 002746   003645 710000 2                  TRA     s:13172
         2 002747   003645 710000 2                  TRA     s:13172
         2 002750   003645 710000 2                  TRA     s:13172
         2 002751   003645 710000 2                  TRA     s:13172
         2 002752   003645 710000 2                  TRA     s:13172
         2 002753   003645 710000 2                  TRA     s:13172
         2 002754   003645 710000 2                  TRA     s:13172
         2 002755   003645 710000 2                  TRA     s:13172
         2 002756   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:179  
         2 002757   003645 710000 2                  TRA     s:13172
         2 002760   003645 710000 2                  TRA     s:13172
         2 002761   003645 710000 2                  TRA     s:13172
         2 002762   003645 710000 2                  TRA     s:13172
         2 002763   003645 710000 2                  TRA     s:13172
         2 002764   003645 710000 2                  TRA     s:13172
         2 002765   003645 710000 2                  TRA     s:13172
         2 002766   003645 710000 2                  TRA     s:13172
         2 002767   003645 710000 2                  TRA     s:13172
         2 002770   003645 710000 2                  TRA     s:13172
         2 002771   003645 710000 2                  TRA     s:13172
         2 002772   003645 710000 2                  TRA     s:13172
         2 002773   003645 710000 2                  TRA     s:13172
         2 002774   003645 710000 2                  TRA     s:13172
         2 002775   003645 710000 2                  TRA     s:13172
         2 002776   003645 710000 2                  TRA     s:13172
         2 002777   003645 710000 2                  TRA     s:13172
         2 003000   003645 710000 2                  TRA     s:13172
         2 003001   003645 710000 2                  TRA     s:13172
         2 003002   003645 710000 2                  TRA     s:13172
         2 003003   003645 710000 2                  TRA     s:13172
         2 003004   003645 710000 2                  TRA     s:13172
         2 003005   003645 710000 2                  TRA     s:13172
         2 003006   003645 710000 2                  TRA     s:13172
         2 003007   003645 710000 2                  TRA     s:13172
         2 003010   003645 710000 2                  TRA     s:13172
         2 003011   003645 710000 2                  TRA     s:13172
         2 003012   003645 710000 2                  TRA     s:13172
         2 003013   003645 710000 2                  TRA     s:13172
         2 003014   003645 710000 2                  TRA     s:13172
         2 003015   003645 710000 2                  TRA     s:13172
         2 003016   003645 710000 2                  TRA     s:13172
         2 003017   003645 710000 2                  TRA     s:13172
         2 003020   003645 710000 2                  TRA     s:13172
         2 003021   003645 710000 2                  TRA     s:13172
         2 003022   003645 710000 2                  TRA     s:13172
         2 003023   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:180  
         2 003024   003645 710000 2                  TRA     s:13172
         2 003025   003645 710000 2                  TRA     s:13172
         2 003026   003645 710000 2                  TRA     s:13172
         2 003027   003645 710000 2                  TRA     s:13172
         2 003030   003645 710000 2                  TRA     s:13172
         2 003031   003645 710000 2                  TRA     s:13172
         2 003032   003645 710000 2                  TRA     s:13172
         2 003033   003645 710000 2                  TRA     s:13172
         2 003034   003645 710000 2                  TRA     s:13172
         2 003035   003645 710000 2                  TRA     s:13172
         2 003036   003645 710000 2                  TRA     s:13172
         2 003037   003645 710000 2                  TRA     s:13172
         2 003040   003645 710000 2                  TRA     s:13172
         2 003041   003645 710000 2                  TRA     s:13172
         2 003042   003645 710000 2                  TRA     s:13172
         2 003043   003645 710000 2                  TRA     s:13172
         2 003044   003645 710000 2                  TRA     s:13172
         2 003045   003645 710000 2                  TRA     s:13172
         2 003046   003645 710000 2                  TRA     s:13172
         2 003047   003645 710000 2                  TRA     s:13172
         2 003050   003645 710000 2                  TRA     s:13172
         2 003051   003645 710000 2                  TRA     s:13172
         2 003052   003645 710000 2                  TRA     s:13172
         2 003053   003645 710000 2                  TRA     s:13172
         2 003054   003645 710000 2                  TRA     s:13172
         2 003055   003645 710000 2                  TRA     s:13172
         2 003056   003645 710000 2                  TRA     s:13172
         2 003057   003645 710000 2                  TRA     s:13172
         2 003060   003645 710000 2                  TRA     s:13172
         2 003061   003645 710000 2                  TRA     s:13172
         2 003062   003645 710000 2                  TRA     s:13172
         2 003063   003645 710000 2                  TRA     s:13172
         2 003064   003645 710000 2                  TRA     s:13172
         2 003065   003645 710000 2                  TRA     s:13172
         2 003066   003645 710000 2                  TRA     s:13172
         2 003067   003645 710000 2                  TRA     s:13172
         2 003070   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:181  
         2 003071   003645 710000 2                  TRA     s:13172
         2 003072   003645 710000 2                  TRA     s:13172
         2 003073   003645 710000 2                  TRA     s:13172
         2 003074   003645 710000 2                  TRA     s:13172
         2 003075   003645 710000 2                  TRA     s:13172
         2 003076   003645 710000 2                  TRA     s:13172
         2 003077   003645 710000 2                  TRA     s:13172
         2 003100   003645 710000 2                  TRA     s:13172
         2 003101   003645 710000 2                  TRA     s:13172
         2 003102   003645 710000 2                  TRA     s:13172
         2 003103   003645 710000 2                  TRA     s:13172
         2 003104   003645 710000 2                  TRA     s:13172
         2 003105   003645 710000 2                  TRA     s:13172
         2 003106   003645 710000 2                  TRA     s:13172
         2 003107   003645 710000 2                  TRA     s:13172
         2 003110   003645 710000 2                  TRA     s:13172
         2 003111   003645 710000 2                  TRA     s:13172
         2 003112   003645 710000 2                  TRA     s:13172
         2 003113   003645 710000 2                  TRA     s:13172
         2 003114   003645 710000 2                  TRA     s:13172
         2 003115   003645 710000 2                  TRA     s:13172
         2 003116   003645 710000 2                  TRA     s:13172
         2 003117   003645 710000 2                  TRA     s:13172
         2 003120   003645 710000 2                  TRA     s:13172
         2 003121   003645 710000 2                  TRA     s:13172
         2 003122   003645 710000 2                  TRA     s:13172
         2 003123   003645 710000 2                  TRA     s:13172
         2 003124   003645 710000 2                  TRA     s:13172
         2 003125   003645 710000 2                  TRA     s:13172
         2 003126   003645 710000 2                  TRA     s:13172
         2 003127   003645 710000 2                  TRA     s:13172
         2 003130   003645 710000 2                  TRA     s:13172
         2 003131   003645 710000 2                  TRA     s:13172
         2 003132   003645 710000 2                  TRA     s:13172
         2 003133   003645 710000 2                  TRA     s:13172
         2 003134   003645 710000 2                  TRA     s:13172
         2 003135   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:182  
         2 003136   003645 710000 2                  TRA     s:13172
         2 003137   003645 710000 2                  TRA     s:13172
         2 003140   003645 710000 2                  TRA     s:13172
         2 003141   003645 710000 2                  TRA     s:13172
         2 003142   003645 710000 2                  TRA     s:13172
         2 003143   003645 710000 2                  TRA     s:13172
         2 003144   003645 710000 2                  TRA     s:13172
         2 003145   003645 710000 2                  TRA     s:13172
         2 003146   003645 710000 2                  TRA     s:13172
         2 003147   003645 710000 2                  TRA     s:13172
         2 003150   003645 710000 2                  TRA     s:13172
         2 003151   003645 710000 2                  TRA     s:13172
         2 003152   003645 710000 2                  TRA     s:13172
         2 003153   003645 710000 2                  TRA     s:13172
         2 003154   003645 710000 2                  TRA     s:13172
         2 003155   003645 710000 2                  TRA     s:13172
         2 003156   003645 710000 2                  TRA     s:13172
         2 003157   003645 710000 2                  TRA     s:13172
         2 003160   003645 710000 2                  TRA     s:13172
         2 003161   003645 710000 2                  TRA     s:13172
         2 003162   003645 710000 2                  TRA     s:13172
         2 003163   003645 710000 2                  TRA     s:13172
         2 003164   003645 710000 2                  TRA     s:13172
         2 003165   003645 710000 2                  TRA     s:13172
         2 003166   003645 710000 2                  TRA     s:13172
         2 003167   003645 710000 2                  TRA     s:13172
         2 003170   003645 710000 2                  TRA     s:13172
         2 003171   003645 710000 2                  TRA     s:13172
         2 003172   003645 710000 2                  TRA     s:13172
         2 003173   003645 710000 2                  TRA     s:13172
         2 003174   003645 710000 2                  TRA     s:13172
         2 003175   003645 710000 2                  TRA     s:13172
         2 003176   003645 710000 2                  TRA     s:13172
         2 003177   003645 710000 2                  TRA     s:13172
         2 003200   003645 710000 2                  TRA     s:13172
         2 003201   003645 710000 2                  TRA     s:13172
         2 003202   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:183  
         2 003203   003645 710000 2                  TRA     s:13172
         2 003204   003645 710000 2                  TRA     s:13172
         2 003205   003645 710000 2                  TRA     s:13172
         2 003206   003645 710000 2                  TRA     s:13172
         2 003207   003645 710000 2                  TRA     s:13172
         2 003210   003645 710000 2                  TRA     s:13172
         2 003211   003645 710000 2                  TRA     s:13172
         2 003212   003645 710000 2                  TRA     s:13172
         2 003213   003645 710000 2                  TRA     s:13172
         2 003214   003645 710000 2                  TRA     s:13172
         2 003215   003645 710000 2                  TRA     s:13172
         2 003216   003645 710000 2                  TRA     s:13172
         2 003217   003645 710000 2                  TRA     s:13172
         2 003220   003645 710000 2                  TRA     s:13172
         2 003221   003645 710000 2                  TRA     s:13172
         2 003222   003645 710000 2                  TRA     s:13172
         2 003223   003645 710000 2                  TRA     s:13172
         2 003224   003645 710000 2                  TRA     s:13172
         2 003225   003645 710000 2                  TRA     s:13172
         2 003226   003645 710000 2                  TRA     s:13172
         2 003227   003645 710000 2                  TRA     s:13172
         2 003230   003645 710000 2                  TRA     s:13172
         2 003231   003645 710000 2                  TRA     s:13172
         2 003232   003645 710000 2                  TRA     s:13172
         2 003233   003645 710000 2                  TRA     s:13172
         2 003234   003645 710000 2                  TRA     s:13172
         2 003235   003645 710000 2                  TRA     s:13172
         2 003236   003645 710000 2                  TRA     s:13172
         2 003237   003645 710000 2                  TRA     s:13172
         2 003240   003645 710000 2                  TRA     s:13172
         2 003241   003645 710000 2                  TRA     s:13172
         2 003242   003645 710000 2                  TRA     s:13172
         2 003243   003645 710000 2                  TRA     s:13172
         2 003244   003645 710000 2                  TRA     s:13172
         2 003245   003645 710000 2                  TRA     s:13172
         2 003246   003645 710000 2                  TRA     s:13172
         2 003247   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:184  
         2 003250   003645 710000 2                  TRA     s:13172
         2 003251   003645 710000 2                  TRA     s:13172
         2 003252   003645 710000 2                  TRA     s:13172
         2 003253   003645 710000 2                  TRA     s:13172
         2 003254   003645 710000 2                  TRA     s:13172
         2 003255   003645 710000 2                  TRA     s:13172
         2 003256   003645 710000 2                  TRA     s:13172
         2 003257   003645 710000 2                  TRA     s:13172
         2 003260   003645 710000 2                  TRA     s:13172
         2 003261   003645 710000 2                  TRA     s:13172
         2 003262   003645 710000 2                  TRA     s:13172
         2 003263   003645 710000 2                  TRA     s:13172
         2 003264   003645 710000 2                  TRA     s:13172
         2 003265   003645 710000 2                  TRA     s:13172
         2 003266   003645 710000 2                  TRA     s:13172
         2 003267   003645 710000 2                  TRA     s:13172
         2 003270   003645 710000 2                  TRA     s:13172
         2 003271   003645 710000 2                  TRA     s:13172
         2 003272   003645 710000 2                  TRA     s:13172
         2 003273   003645 710000 2                  TRA     s:13172
         2 003274   003645 710000 2                  TRA     s:13172
         2 003275   003645 710000 2                  TRA     s:13172
         2 003276   003645 710000 2                  TRA     s:13172
         2 003277   003645 710000 2                  TRA     s:13172
         2 003300   003645 710000 2                  TRA     s:13172
         2 003301   003645 710000 2                  TRA     s:13172
         2 003302   003645 710000 2                  TRA     s:13172
         2 003303   003645 710000 2                  TRA     s:13172
         2 003304   003645 710000 2                  TRA     s:13172
         2 003305   003645 710000 2                  TRA     s:13172
         2 003306   003645 710000 2                  TRA     s:13172
         2 003307   003645 710000 2                  TRA     s:13172
         2 003310   003645 710000 2                  TRA     s:13172
         2 003311   003645 710000 2                  TRA     s:13172
         2 003312   003645 710000 2                  TRA     s:13172
         2 003313   003645 710000 2                  TRA     s:13172
         2 003314   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:185  
         2 003315   003645 710000 2                  TRA     s:13172
         2 003316   003645 710000 2                  TRA     s:13172
         2 003317   003645 710000 2                  TRA     s:13172
         2 003320   003645 710000 2                  TRA     s:13172
         2 003321   003645 710000 2                  TRA     s:13172
         2 003322   003645 710000 2                  TRA     s:13172
         2 003323   003645 710000 2                  TRA     s:13172
         2 003324   003645 710000 2                  TRA     s:13172
         2 003325   003645 710000 2                  TRA     s:13172
         2 003326   003645 710000 2                  TRA     s:13172
         2 003327   003645 710000 2                  TRA     s:13172
         2 003330   003645 710000 2                  TRA     s:13172
         2 003331   003645 710000 2                  TRA     s:13172
         2 003332   003645 710000 2                  TRA     s:13172
         2 003333   003645 710000 2                  TRA     s:13172
         2 003334   003645 710000 2                  TRA     s:13172
         2 003335   003645 710000 2                  TRA     s:13172
         2 003336   003645 710000 2                  TRA     s:13172
         2 003337   003645 710000 2                  TRA     s:13172
         2 003340   003645 710000 2                  TRA     s:13172
         2 003341   003645 710000 2                  TRA     s:13172
         2 003342   003645 710000 2                  TRA     s:13172
         2 003343   003645 710000 2                  TRA     s:13172
         2 003344   003645 710000 2                  TRA     s:13172
         2 003345   003645 710000 2                  TRA     s:13172
         2 003346   003645 710000 2                  TRA     s:13172
         2 003347   003645 710000 2                  TRA     s:13172
         2 003350   003645 710000 2                  TRA     s:13172
         2 003351   003645 710000 2                  TRA     s:13172
         2 003352   003645 710000 2                  TRA     s:13172
         2 003353   003645 710000 2                  TRA     s:13172
         2 003354   003645 710000 2                  TRA     s:13172
         2 003355   003645 710000 2                  TRA     s:13172
         2 003356   003645 710000 2                  TRA     s:13172
         2 003357   003645 710000 2                  TRA     s:13172
         2 003360   003645 710000 2                  TRA     s:13172
         2 003361   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:186  
         2 003362   003645 710000 2                  TRA     s:13172
         2 003363   003645 710000 2                  TRA     s:13172
         2 003364   003645 710000 2                  TRA     s:13172
         2 003365   003645 710000 2                  TRA     s:13172
         2 003366   003645 710000 2                  TRA     s:13172
         2 003367   003645 710000 2                  TRA     s:13172
         2 003370   003645 710000 2                  TRA     s:13172
         2 003371   003645 710000 2                  TRA     s:13172
         2 003372   003645 710000 2                  TRA     s:13172
         2 003373   003645 710000 2                  TRA     s:13172
         2 003374   003645 710000 2                  TRA     s:13172
         2 003375   003645 710000 2                  TRA     s:13172
         2 003376   003645 710000 2                  TRA     s:13172
         2 003377   003645 710000 2                  TRA     s:13172
         2 003400   003645 710000 2                  TRA     s:13172
         2 003401   003645 710000 2                  TRA     s:13172
         2 003402   003645 710000 2                  TRA     s:13172
         2 003403   003645 710000 2                  TRA     s:13172
         2 003404   003645 710000 2                  TRA     s:13172
         2 003405   003645 710000 2                  TRA     s:13172
         2 003406   003645 710000 2                  TRA     s:13172
         2 003407   003645 710000 2                  TRA     s:13172
         2 003410   003645 710000 2                  TRA     s:13172
         2 003411   003645 710000 2                  TRA     s:13172
         2 003412   003645 710000 2                  TRA     s:13172
         2 003413   003645 710000 2                  TRA     s:13172
         2 003414   003645 710000 2                  TRA     s:13172
         2 003415   003645 710000 2                  TRA     s:13172
         2 003416   003645 710000 2                  TRA     s:13172
         2 003417   003645 710000 2                  TRA     s:13172
         2 003420   003645 710000 2                  TRA     s:13172
         2 003421   003645 710000 2                  TRA     s:13172
         2 003422   003645 710000 2                  TRA     s:13172
         2 003423   003645 710000 2                  TRA     s:13172
         2 003424   003645 710000 2                  TRA     s:13172
         2 003425   003645 710000 2                  TRA     s:13172
         2 003426   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:187  
         2 003427   003645 710000 2                  TRA     s:13172
         2 003430   003645 710000 2                  TRA     s:13172
         2 003431   003645 710000 2                  TRA     s:13172
         2 003432   003645 710000 2                  TRA     s:13172
         2 003433   003645 710000 2                  TRA     s:13172
         2 003434   003645 710000 2                  TRA     s:13172
         2 003435   003645 710000 2                  TRA     s:13172
         2 003436   003645 710000 2                  TRA     s:13172
         2 003437   003645 710000 2                  TRA     s:13172
         2 003440   003645 710000 2                  TRA     s:13172
         2 003441   003645 710000 2                  TRA     s:13172
         2 003442   003645 710000 2                  TRA     s:13172
         2 003443   003645 710000 2                  TRA     s:13172
         2 003444   003645 710000 2                  TRA     s:13172
         2 003445   003645 710000 2                  TRA     s:13172
         2 003446   003645 710000 2                  TRA     s:13172
         2 003447   003645 710000 2                  TRA     s:13172
         2 003450   003645 710000 2                  TRA     s:13172
         2 003451   003645 710000 2                  TRA     s:13172
         2 003452   003645 710000 2                  TRA     s:13172
         2 003453   003645 710000 2                  TRA     s:13172
         2 003454   003645 710000 2                  TRA     s:13172
         2 003455   003645 710000 2                  TRA     s:13172
         2 003456   003645 710000 2                  TRA     s:13172
         2 003457   003645 710000 2                  TRA     s:13172
         2 003460   003645 710000 2                  TRA     s:13172
         2 003461   003645 710000 2                  TRA     s:13172
         2 003462   003645 710000 2                  TRA     s:13172
         2 003463   003645 710000 2                  TRA     s:13172
         2 003464   003645 710000 2                  TRA     s:13172
         2 003465   003645 710000 2                  TRA     s:13172
         2 003466   003645 710000 2                  TRA     s:13172
         2 003467   003645 710000 2                  TRA     s:13172
         2 003470   003645 710000 2                  TRA     s:13172
         2 003471   003645 710000 2                  TRA     s:13172
         2 003472   003607 710000 2                  TRA     s:13155
         2 003473   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:188  
         2 003474   003645 710000 2                  TRA     s:13172
         2 003475   003645 710000 2                  TRA     s:13172
         2 003476   003645 710000 2                  TRA     s:13172
         2 003477   003645 710000 2                  TRA     s:13172
         2 003500   003551 710000 2                  TRA     s:13140
         2 003501   003633 710000 2                  TRA     s:13167
         2 003502   003625 710000 2                  TRA     s:13161
         2 003503   003630 710000 2                  TRA     s:13164
         2 003504   003645 710000 2                  TRA     s:13172
         2 003505   003645 710000 2                  TRA     s:13172
         2 003506   003645 710000 2                  TRA     s:13172
         2 003507   003645 710000 2                  TRA     s:13172
         2 003510   003645 710000 2                  TRA     s:13172
         2 003511   003645 710000 2                  TRA     s:13172
         2 003512   003645 710000 2                  TRA     s:13172
         2 003513   003645 710000 2                  TRA     s:13172
         2 003514   003645 710000 2                  TRA     s:13172
         2 003515   003645 710000 2                  TRA     s:13172
         2 003516   003645 710000 2                  TRA     s:13172
         2 003517   003645 710000 2                  TRA     s:13172
         2 003520   003645 710000 2                  TRA     s:13172
         2 003521   003645 710000 2                  TRA     s:13172
         2 003522   003645 710000 2                  TRA     s:13172
         2 003523   003645 710000 2                  TRA     s:13172
         2 003524   003645 710000 2                  TRA     s:13172
         2 003525   003645 710000 2                  TRA     s:13172
         2 003526   003645 710000 2                  TRA     s:13172
         2 003527   003645 710000 2                  TRA     s:13172
         2 003530   003645 710000 2                  TRA     s:13172
         2 003531   003645 710000 2                  TRA     s:13172
         2 003532   003645 710000 2                  TRA     s:13172
         2 003533   003645 710000 2                  TRA     s:13172
         2 003534   003645 710000 2                  TRA     s:13172
         2 003535   003645 710000 2                  TRA     s:13172
         2 003536   003645 710000 2                  TRA     s:13172
         2 003537   003645 710000 2                  TRA     s:13172
         2 003540   003645 710000 2                  TRA     s:13172
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:189  
         2 003541   003645 710000 2                  TRA     s:13172
         2 003542   003645 710000 2                  TRA     s:13172
         2 003543   003645 710000 2                  TRA     s:13172
         2 003544   003645 710000 2                  TRA     s:13172
         2 003545   003645 710000 2                  TRA     s:13172
         2 003546   003645 710000 2                  TRA     s:13172
         2 003547   003645 710000 2                  TRA     s:13172
         2 003550   003616 710000 2                  TRA     s:13158

     1062    13137
     1063    13138    5                   CASE(%CH_SYSID) ;

     1064    13139                                                                    /* SYSID check. */
     1065    13140    5                     CALL CHARBIN(TEMP,P$->P$B.SUBLK$(J)->P$S.TEXTC$->TEXTC.TEXT);

  13140  2 003551   100003 473500                    LDP3    3,,PR1
         2 003552   000100 101500                    MRL     fill='000'O
         2 003553   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 003554   201344 000002                    ADSC9   LFPT_PRECORD+10,,AUTO    cn=0,n=2
         2 003555   201344 221100                    LDX1    LFPT_PRECORD+10,,AUTO
         2 003556   000100 305540                    DTB
         2 003557   300000 230011                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         2 003560   201346 000010                    NDSC9   LFPT_PRECORD+12,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 003561   201347 235100                    LDA     LFPT_PRECORD+13,,AUTO
         2 003562   200147 755100                    STA     TEMP,,AUTO

     1066    13141    5                     SYSID_CRITERIA.SYSID# = TEMP ;

  13141  2 003563   201234 755100                    STA     SYSID_CRITERIA+6,,AUTO

     1067    13142    5                     SYSID_CRITERIA.SYSID1# = TEMP ;

  13142  2 003564   201235 755100                    STA     SYSID_CRITERIA+7,,AUTO

     1068    13143    5                     CHKEYBUF.SYSID = TEMP ;

  13143  2 003565   000100 100500                    MLR     fill='000'O
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:190  
         2 003566   200147 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4
         2 003567   200336 200004                    ADSC9   CHKEYBUF,,AUTO           cn=1,n=4

     1069    13144    5                     CHKEYBUF.NUM = 0;

  13144  2 003570   000100 100400                    MLR     fill='000'O
         2 003571   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         2 003572   200337 200004                    ADSC9   CHKEYBUF+1,,AUTO         cn=1,n=4

     1070    13145    5                     IF TEMP=0

  13145  2 003573   004071 600000 2                  TZE     CHECK_AWAITING_PRESCAN
         2 003574   003645 710000 2                  TRA     s:13172

     1071    13146    5                       THEN
     1072    13147    5                         GOTO CHECK_AWAITING_PRESCAN ;
     1073    13148
     1074    13149    5                   CASE(%CH_JOBNAME) ;

     1075    13150                                                              /* JOBNAME check */
     1076    13151    5                     VLP_JOBNAME.JOBNAME# = P$->P$B.SUBLK$(J)->P$S.TEXT;

  13151  2 003575   100004 236100                    LDQ     4,,PR1
         2 003576   000033 772000                    QRL     27
         2 003577   000000 622006                    EAX2    0,QL
         2 003600   040100 100540                    MLR     fill='040'O
         2 003601   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 003602   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31

     1077    13152    5                     CHKEYBUF.NUM = 0;

  13152  2 003603   000100 100400                    MLR     fill='000'O
         2 003604   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         2 003605   200337 200004                    ADSC9   CHKEYBUF+1,,AUTO         cn=1,n=4
         2 003606   003645 710000 2                  TRA     s:13172

     1078    13153
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:191  
     1079    13154    5                   CASE(%CH_ACCT);

     1080    13155    5                     FID_ACCT.ACCT# = P$->P$B.SUBLK$(J)->P$S.TEXT;

  13155  2 003607   100004 236100                    LDQ     4,,PR1
         2 003610   000033 772000                    QRL     27
         2 003611   000000 622006                    EAX2    0,QL
         2 003612   040100 100540                    MLR     fill='040'O
         2 003613   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 003614   201200 000010                    ADSC9   FID_ACCT,,AUTO           cn=0,n=8
         2 003615   003645 710000 2                  TRA     s:13172

     1081    13156
     1082    13157    5                   CASE(%CH_COMMENT);

     1083    13158    5                     CH_XFORMAT.COMMENT# = P$->P$B.SUBLK$(J)->P$S.TEXT;

  13158  2 003616   100004 236100                    LDQ     4,,PR1
         2 003617   000033 772000                    QRL     27
         2 003620   000000 622006                    EAX2    0,QL
         2 003621   040100 100540                    MLR     fill='040'O
         2 003622   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 003623   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24
         2 003624   003645 710000 2                  TRA     s:13172

     1084    13159
     1085    13160    5                   CASE(%CH_YESOUTPUT);

     1086    13161    5                     FPT_JOBSTATS_CANCEL.V.OUTPUT# = %NO#;

  13161  2 003625   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 003626   201123 356100                    ANSQ    FPT_JOBSTATS_CANCEL+27,,AUTO
         2 003627   003645 710000 2                  TRA     s:13172

     1087    13162
     1088    13163    5                   CASE(%CH_DELUSEREC);

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:192  
     1089    13164    5                     DELUSEREC = '1'B;

  13164  2 003630   400000 236003                    LDQ     -131072,DU
         2 003631   200123 756100                    STQ     DELUSEREC,,AUTO
         2 003632   003645 710000 2                  TRA     s:13172

     1090    13165
     1091    13166    5                   CASE(%CH_SYSID_NUM);

     1092    13167    5                     CALL CHARBIN(P$->P$B.SUBLK$(J)->P$B.CPOS,

  13167  2 003633   100004 236100                    LDQ     4,,PR1
         2 003634   000033 772000                    QRL     27
         2 003635   000000 622006                    EAX2    0,QL
         2 003636   000100 305540                    DTB
         2 003637   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
         2 003640   201344 000010                    NDSC9   LFPT_PRECORD+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 003641   201345 235100                    LDA     LFPT_PRECORD+11,,AUTO
         2 003642   100002 755100                    STA     2,,PR1

     1093    13168    5                       P$->P$B.SUBLK$(J)->P$S.TEXT);
     1094    13169    5                     FPT_JOBSTATS.V.NUM# = 1; /* Set a flag */

  13169  2 003643   000001 221003                    LDX1    1,DU
         2 003644   201014 741100                    STX1    FPT_JOBSTATS+28,,AUTO

     1095    13170
     1096    13171    5                 END ; /* DO CASE */

     1097    13172    4               END; /* Do J */

  13172  2 003645   200145 054100                    AOS     J,,AUTO
         2 003646   200004 470500                    LDP0    P$,,AUTO
         2 003647   000001 236100                    LDQ     1,,PR0
         2 003650   000022 772000                    QRL     18
         2 003651   200145 116100                    CMPQ    J,,AUTO
         2 003652   002477 605400 2                  TPNZ    s:13136
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:193  

     1098    13173    3               IF VLP_JOBNAME.JOBNAME# ~= ' '

  13173  2 003653   040000 106500                    CMPC    fill='040'O
         2 003654   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31
         2 003655   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 003656   003737 600000 2                  TZE     s:13206

     1099    13174    3                 THEN
     1100    13175    4                   DO;

     1101    13176    4                     IF JOBSTATS_OPEN# = %NO#

  13176  2 003657   200120 234100                    SZN     JOBSTATS_OPEN#,,AUTO
         2 003660   003663 604000 2                  TMI     s:13179

     1102    13177    4                       THEN
     1103    13178    4                         CALL OPEN_JOBSTATS_FILE ALTRET(E_SETUP_SYSID_SRCH) ;

  13178  2 003661   006143 701000 2                  TSX1    OPEN_JOBSTATS_FILE
         2 003662   004151 702000 2                  TSX2    E_SETUP_SYSID_SRCH

     1104    13179    4                     CALL GET_JOBNAME_SYSID_REC ALTRET(E_SETUP_SYSID_SRCH) ;

  13179  2 003663   006607 701000 2                  TSX1    GET_JOBNAME_SYSID_REC
         2 003664   004151 702000 2                  TSX2    E_SETUP_SYSID_SRCH

     1105    13180    4                     IF (NOT SYSTEM_OK# AND B$JIT.ACCN ~= FID_ACCT.ACCT#) OR TEMP=0

  13180  2 003665   200125 234100                    SZN     SYSTEM_OK#,,AUTO
         2 003666   003674 604000 2                  TMI     s:13180+7
         2 003667   000000 470400 xsym               LDP0    B$JIT$
         2 003670   040100 106500                    CMPC    fill='040'O
         2 003671   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 003672   201200 000010                    ADSC9   FID_ACCT,,AUTO           cn=0,n=8
         2 003673   003676 601000 2                  TNZ     s:13189
         2 003674   200147 235100                    LDA     TEMP,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:194  
         2 003675   003724 601000 2                  TNZ     s:13198

     1106    13181    4                       THEN
     1107    13182                                                          /*
     1108    13183                                                           This guy is asking about someone
     1109    13184                                                            else's Job, and he does not
     1110    13185                                                            have the tools to look at it.
     1111    13186                                                            Don't let him see the SYSID.
     1112    13187                                                          */
     1113    13188    5                         DO ;                        /* No such JOBNAME exists */

     1114    13189    5                           TEMP = 0 ;

  13189  2 003676   200147 450100                    STZ     TEMP,,AUTO

     1115    13190    5                           CH_XFORMAT.MSG# = %CP_NOTF_MESS ;

  13190  2 003677   000013 235007                    LDA     11,DL
         2 003700   200412 755100                    STA     CH_XFORMAT,,AUTO

     1116    13191    5                           CH_XFORMAT.SYSID# = TEMP;

  13191  2 003701   200147 236100                    LDQ     TEMP,,AUTO
         2 003702   200413 756100                    STQ     CH_XFORMAT+1,,AUTO

     1117    13192    5                           CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME# ;

  13192  2 003703   040100 100500                    MLR     fill='040'O
         2 003704   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31
         2 003705   200416 000037                    ADSC9   CH_XFORMAT+4,,AUTO       cn=0,n=31

     1118    13193    5                           CH_XFORMAT.ACCT# = FID_ACCT.ACCT# ;

  13193  2 003706   201200 237100                    LDAQ    FID_ACCT,,AUTO
         2 003707   200414 757100                    STAQ    CH_XFORMAT+2,,AUTO

     1119    13194    5                           CH_XFORMAT.NUM# = CHKEYBUF.NUM;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:195  

  13194  2 003710   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 003711   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 003712   000033 773000                    LRL     27
         2 003713   200426 756100                    STQ     CH_XFORMAT+12,,AUTO

     1120    13195    5                           CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13195  2 003714   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 003715   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 003716   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 003717   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003720   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 003721   000000 011000                    NOP     0

     1121    13196    5                           RETURN ;

  13196  2 003722   201316 221300                    LDX1  ! RETURN_FLG+1,,AUTO
         2 003723   000001 702211                    TSX2  ! 1,X1

     1122    13197    5                         END ; /* THEN DO */
     1123    13198    4                     SYSID_CRITERIA.SYSID# = TEMP ;

  13198  2 003724   201234 755100                    STA     SYSID_CRITERIA+6,,AUTO

     1124    13199    4                     SYSID_CRITERIA.SYSID1# = TEMP ;

  13199  2 003725   201235 755100                    STA     SYSID_CRITERIA+7,,AUTO

     1125    13200    4                     CHKEYBUF.SYSID = TEMP ;

  13200  2 003726   000100 100500                    MLR     fill='000'O
         2 003727   200147 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4
         2 003730   200336 200004                    ADSC9   CHKEYBUF,,AUTO           cn=1,n=4

     1126    13201    4                   END;  /* Then Do */

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:196  
     1127    13202    3               END;  /* Then Do */

  13202  2 003731   003737 710000 2                  TRA     s:13206

     1128    13203    2         ELSE
     1129    13204    2            FPT_JOBSTATS.V.NUM# = CHKEYBUF.NUM;

  13204  2 003732   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 003733   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 003734   000033 773000                    LRL     27
         2 003735   000000 620006                    EAX0    0,QL
         2 003736   201014 740100                    STX0    FPT_JOBSTATS+28,,AUTO

     1130    13205
     1131    13206    2         OUTPUT_FLG = %NO# ;

  13206  2 003737   200142 450100                    STZ     OUTPUT_FLG,,AUTO

     1132    13207    2         JOB_COMPLETED = %NO# ;

  13207  2 003740   200143 450100                    STZ     JOB_COMPLETED,,AUTO

     1133    13208    2         IF FPT_JOBSTATS.V.NUM# ~= 0

  13208  2 003741   201014 220100                    LDX0    FPT_JOBSTATS+28,,AUTO
         2 003742   003746 600000 2                  TZE     s:13214

     1134    13209    2             THEN  /* Asking for a specific output file */
     1135    13210    3               DO;

     1136    13211    3                 CALL DISP_SYSID_SUBFILE ALTRET(SETUP_SYSID_SRCH_RETURN);

  13211  2 003743   005560 701000 2                  TSX1    DISP_SYSID_SUBFILE
         2 003744   004147 702000 2                  TSX2    SETUP_SYSID_SRCH_RETURN

     1137    13212    3                 GOTO SETUP_SYSID_SRCH_RETURN;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:197  
  13212  2 003745   004147 710000 2                  TRA     SETUP_SYSID_SRCH_RETURN

     1138    13213    3               END;  /* Then Do */
     1139    13214    2         IF (NOTIFYING OR (WAITING AND NOT FORCE)) AND CHKEYBUF.NUM > 0

  13214  2 003746   200137 234100                    SZN     NOTIFYING,,AUTO
         2 003747   003754 604000 2                  TMI     s:13214+6
         2 003750   200133 234100                    SZN     WAITING,,AUTO
         2 003751   003761 605000 2                  TPL     s:13216
         2 003752   200136 234100                    SZN     FORCE,,AUTO
         2 003753   003761 604000 2                  TMI     s:13216
         2 003754   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 003755   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 003756   000033 773000                    LRL     27
         2 003757   000000 116003                    CMPQ    0,DU
         2 003760   004071 601000 2                  TNZ     CHECK_AWAITING_PRESCAN

     1140    13215    2             THEN GOTO CHECK_AWAITING_PRESCAN ;
     1141    13216    2         IF SYSID_CRITERIA.SYSID# = 0

  13216  2 003761   201234 235100                    LDA     SYSID_CRITERIA+6,,AUTO
         2 003762   004016 601000 2                  TNZ     s:13233

     1142    13217    2           THEN
     1143    13218    3             DO;  /* Presumably, a request for all jobs in an account */

     1144    13219    3               SYSID_CRITERIA.ACCT# = FID_ACCT.ACCT#;

  13219  2 003763   201200 237100                    LDAQ    FID_ACCT,,AUTO
         2 003764   201232 757100                    STAQ    SYSID_CRITERIA+4,,AUTO

     1145    13220    3               CALL GET_JOBSTATS;

  13220  2 003765   006704 701000 2                  TSX1    GET_JOBSTATS
         2 003766   000000 011000                    NOP     0

     1146    13221    3               FPT_JOBSTATS.V.OUTPUT# = '1'B;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:198  

  13221  2 003767   400000 236003                    LDQ     -131072,DU
         2 003770   201013 256100                    ORSQ    FPT_JOBSTATS+27,,AUTO

     1147    13222    3               SN$ = PINCRW(RES$,1024);

  13222  2 003771   200014 236100                    LDQ     RES$,,AUTO
         2 003772   002000 036003                    ADLQ    1024,DU
         2 003773   200015 756100                    STQ     SN$,,AUTO

     1148    13223    3               STAT$ = PINCRW(SN$,1024);

  13223  2 003774   002000 036003                    ADLQ    1024,DU
         2 003775   200013 756100                    STQ     STAT$,,AUTO

     1149    13224    3               FPT_JOBSTATS.RESLIST_ = VECTOR(RES$->B$$PAGE);

  13224  2 003776   000013 235000 3                  LDA     11
         2 003777   200014 236100                    LDQ     RES$,,AUTO
         2 004000   200776 757100                    STAQ    FPT_JOBSTATS+14,,AUTO

     1150    13225    3               FPT_JOBSTATS.SNLIST_ = VECTOR(SN$->B$$PAGE);

  13225  2 004001   000013 235000 3                  LDA     11
         2 004002   200015 236100                    LDQ     SN$,,AUTO
         2 004003   200774 757100                    STAQ    FPT_JOBSTATS+12,,AUTO

     1151    13226    3               FPT_JOBSTATS.RESULTS_ = RESULTS_;

  13226  2 004004   200450 237100                    LDAQ    RESULTS_,,AUTO
         2 004005   200764 757100                    STAQ    FPT_JOBSTATS+4,,AUTO

     1152    13227    3               IF NOT B$JIT.CPFLAGS1.BRK

  13227  2 004006   000000 470400 xsym               LDP0    B$JIT$
         2 004007   000143 236100                    LDQ     99,,PR0
         2 004010   000004 316007                    CANQ    4,DL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:199  
         2 004011   004014 601000 2                  TNZ     s:13230

     1153    13228    3                 THEN
     1154    13229    3                   CALL GET_JOBSTATS;

  13229  2 004012   006704 701000 2                  TSX1    GET_JOBSTATS
         2 004013   000000 011000                    NOP     0

     1155    13230    3               RETURN;

  13230  2 004014   201316 221300                    LDX1  ! RETURN_FLG+1,,AUTO
         2 004015   000001 702211                    TSX2  ! 1,X1

     1156    13231    3             END;
     1157    13232
     1158    13233    2         CALL COMPARE_STATUS ALTRET(NO_CHANGE) ;   /* Check if status changed. */

  13233  2 004016   007473 701000 2                  TSX1    COMPARE_STATUS
         2 004017   004023 702000 2                  TSX2    NO_CHANGE

     1159    13234    2         SOMETHING_CHANGED = '1'B ;

  13234  2 004020   400000 236003                    LDQ     -131072,DU
         2 004021   200135 756100                    STQ     SOMETHING_CHANGED,,AUTO

     1160    13235    3         DO WHILE('0'B) ;

  13235  2 004022   004031 710000 2                  TRA     GET_INPUT_JOBSTATS

     1161    13236    3   NO_CHANGE:
     1162    13237    3             IF (NOT FORCE AND WAITING) OR NOTIFYING

  13237  2 004023   200136 234100       NO_CHANGE    SZN     FORCE,,AUTO
         2 004024   004027 604000 2                  TMI     NO_CHANGE+4
         2 004025   200133 234100                    SZN     WAITING,,AUTO
         2 004026   004137 604000 2                  TMI     GET_OUTPUT_SYSIDS
         2 004027   200137 234100                    SZN     NOTIFYING,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:200  
         2 004030   004137 604000 2                  TMI     GET_OUTPUT_SYSIDS

     1163    13238    3               THEN GOTO GET_OUTPUT_SYSIDS ;
     1164    13239    3         END ; /* DO WHILE */

     1165    13240
     1166    13241    2   GET_INPUT_JOBSTATS:
     1167    13242                                                        /* Get Job Stats. */
     1168    13243    2         CALL M$JOBSTATS(FPT_JOBSTATS) ALTRET(NONE_THERE) ;

  13243  2 004031   200760 630500       GET_INPUT_J* EPPR0   FPT_JOBSTATS,,AUTO
         2 004032   570001 713400                    CLIMB   alt,+61441
         2 004033   405400 401760                    pmme    nvectors=12
         2 004034   004043 702000 2                  TSX2    NONE_THERE

     1169    13244                                                              /* Output the one found. */
     1170    13245    2         IF SYSIDBUF.STATUS.CODE = %JS_PRT#

  13245  2 004035   200344 235100                    LDA     SYSIDBUF,,AUTO
         2 004036   000004 115007                    CMPA    4,DL
         2 004037   004137 600000 2                  TZE     GET_OUTPUT_SYSIDS

     1171    13246    2             THEN GOTO GET_OUTPUT_SYSIDS ;
     1172    13247    2         CALL DISP_SYSID_SRCH_IRQ ;

  13247  2 004040   005101 701000 2                  TSX1    DISP_SYSID_SRCH_IRQ
         2 004041   000000 011000                    NOP     0

     1173    13248
     1174    13249    3         DO WHILE ('0'B) ;

  13249  2 004042   004137 710000 2                  TRA     GET_OUTPUT_SYSIDS

     1175    13250    3   NONE_THERE:
     1176    13251    3             SOMETHING_CHANGED = '0'B ;

  13251  2 004043   200135 450100       NONE_THERE   STZ     SOMETHING_CHANGED,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:201  

     1177    13252    3             IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOTFND

  13252  2 004044   000000 470400 xsym               LDP0    B$TCB$
         2 004045   000000 471500                    LDP1    0,,PR0
         2 004046   100102 236100                    LDQ     66,,PR1
         2 004047   377770 376007                    ANQ     131064,DL
         2 004050   021260 116007                    CMPQ    8880,DL
         2 004051   004071 600000 2                  TZE     CHECK_AWAITING_PRESCAN

     1178    13253    3               THEN
     1179    13254    4                 DO ;

     1180    13255    4                   CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR) ;

  13255  2 004052   000000 236000 xsym               LDQ     SEG2$
         2 004053   000003 036003                    ADLQ    3,DU
         2 004054   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 004055   100102 633500                    EPPR3   66,,PR1
         2 004056   201347 453500                    STP3    LFPT_PRECORD+13,,AUTO
         2 004057   000035 236000 3                  LDQ     29
         2 004060   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 004061   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 004062   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 004063   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 004064   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 004065   000000 701000 xent               TSX1    CXP$POSTERR
         2 004066   000000 011000                    NOP     0

     1181    13256    4                   ALTRETURN ;

  13256  2 004067   201316 221300                    LDX1  ! RETURN_FLG+1,,AUTO
         2 004070   000000 702211                    TSX2  ! 0,X1

     1182    13257    4                 END ; /* THEN DO */
     1183    13258    3   CHECK_AWAITING_PRESCAN:                   /* Check to see if awaiting PRESCAN. */
     1184    13259    3             FPT_JOBSTATS.V.ORDER# = %CHECK# ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:202  

  13259  2 004071   000001 235007       CHECK_AWAIT* LDA     1,DL
         2 004072   201010 755100                    STA     FPT_JOBSTATS+24,,AUTO

     1185    13260    3             FPT_JOBSTATS.RESULTS_ = VECTOR(VLR_JOBSTATS_CHECK) ;

  13260  2 004073   000000 235000 3                  LDA     0
         2 004074   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 004075   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 004076   001262 036003                    ADLQ    690,DU
         2 004077   200764 757100                    STAQ    FPT_JOBSTATS+4,,AUTO

     1186    13261    3             FPT_JOBSTATS.V.SYSID# = SYSID_CRITERIA.SYSID#;

  13261  2 004100   201234 235100                    LDA     SYSID_CRITERIA+6,,AUTO
         2 004101   201011 755100                    STA     FPT_JOBSTATS+25,,AUTO

     1187    13262    3             CALL M$JOBSTATS(FPT_JOBSTATS) ALTRET(E_NOT_AWAITING_PRESCAN) ;

  13262  2 004102   200760 630500                    EPPR0   FPT_JOBSTATS,,AUTO
         2 004103   570001 713400                    CLIMB   alt,+61441
         2 004104   405400 401760                    pmme    nvectors=12
         2 004105   004126 702000 2                  TSX2    E_NOT_AWAITING_PRESCAN

     1188    13263    3             IF VLR_JOBSTATS_CHECK.CODE = %JS_NOTF#

  13263  2 004106   201262 235100                    LDA     VLR_JOBSTATS_CHECK,,AUTO
         2 004107   000005 115007                    CMPA    5,DL
         2 004110   004120 601000 2                  TNZ     s:13271

     1189    13264    3               THEN
     1190    13265    4                 DO ;

     1191    13266    4                   JOB_COMPLETED = %YES# ;

  13266  2 004111   400000 236003                    LDQ     -131072,DU
         2 004112   200143 756100                    STQ     JOB_COMPLETED,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:203  

     1192    13267    4                   CALL READ_JOBSTATS_FILE ALTRET(E_SETUP_SYSID_SRCH) ;

  13267  2 004113   006226 701000 2                  TSX1    READ_JOBSTATS_FILE
         2 004114   004151 702000 2                  TSX2    E_SETUP_SYSID_SRCH

     1193    13268    4                   SOMETHING_CHANGED = %YES# ;

  13268  2 004115   400000 236003                    LDQ     -131072,DU
         2 004116   200135 756100                    STQ     SOMETHING_CHANGED,,AUTO

     1194    13269    4                   GOTO SETUP_SYSID_SRCH_RETURN ;

  13269  2 004117   004147 710000 2                  TRA     SETUP_SYSID_SRCH_RETURN

     1195    13270    4                 END ; /* THEN DO */
     1196    13271    3             IF VLR_JOBSTATS_CHECK.CODE = %JS_AP#

  13271  2 004120   000007 115007                    CMPA    7,DL
         2 004121   004126 601000 2                  TNZ     E_NOT_AWAITING_PRESCAN

     1197    13272    3               THEN
     1198    13273    4                 DO ;

     1199    13274    4                   CALL PRINT_SUBMIT_MESS ;

  13274  2 004122   007664 701000 2                  TSX1    PRINT_SUBMIT_MESS
         2 004123   000000 011000                    NOP     0

     1200    13275    4                   RETURN ;

  13275  2 004124   201316 221300                    LDX1  ! RETURN_FLG+1,,AUTO
         2 004125   000001 702211                    TSX2  ! 1,X1

     1201    13276    4                 END ; /* THEN DO */
     1202    13277    3   E_NOT_AWAITING_PRESCAN:
     1203    13278    3             FPT_JOBSTATS.V.ORDER# = %SRCH# ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:204  

  13278  2 004126   000002 235007       E_NOT_AWAIT* LDA     2,DL
         2 004127   201010 755100                    STA     FPT_JOBSTATS+24,,AUTO

     1204    13279    3             FPT_JOBSTATS.RESULTS_ = RESULTS_;

  13279  2 004130   200450 237100                    LDAQ    RESULTS_,,AUTO
         2 004131   200764 757100                    STAQ    FPT_JOBSTATS+4,,AUTO

     1205    13280    3             IF VLR_JOBSTATS_CHECK.CODE = %JS_WAIT# OR

  13280  2 004132   201262 235100                    LDA     VLR_JOBSTATS_CHECK,,AUTO
         2 004133   000001 115007                    CMPA    1,DL
         2 004134   004031 600000 2                  TZE     GET_INPUT_JOBSTATS
         2 004135   000002 115007                    CMPA    2,DL
         2 004136   004031 600000 2                  TZE     GET_INPUT_JOBSTATS

     1206    13281    3                 VLR_JOBSTATS_CHECK.CODE = %JS_RUN#
     1207    13282    3               THEN
     1208    13283    3                 GOTO GET_INPUT_JOBSTATS ;
     1209    13284    3         END ; /* DO WHILE */

     1210    13285                                                /* Setup Output Que search. */
     1211    13286    2   GET_OUTPUT_SYSIDS:
     1212    13287    2         FPT_JOBSTATS.V.OUTPUT# = %YES# ;

  13287  2 004137   400000 236003       GET_OUTPUT_* LDQ     -131072,DU
         2 004140   201013 256100                    ORSQ    FPT_JOBSTATS+27,,AUTO

     1213    13288    2         CALL M$JOBSTATS(FPT_JOBSTATS) ALTRET(SETUP_SYSID_SRCH_RETURN) ;

  13288  2 004141   200760 630500                    EPPR0   FPT_JOBSTATS,,AUTO
         2 004142   570001 713400                    CLIMB   alt,+61441
         2 004143   405400 401760                    pmme    nvectors=12
         2 004144   004147 702000 2                  TSX2    SETUP_SYSID_SRCH_RETURN

     1214    13289    2         CALL DISP_SYSID_SRCH_OQ ALTRET(E_SETUP_SYSID_SRCH) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:205  

  13289  2 004145   005334 701000 2                  TSX1    DISP_SYSID_SRCH_OQ
         2 004146   004151 702000 2                  TSX2    E_SETUP_SYSID_SRCH

     1215    13290
     1216    13291    2   SETUP_SYSID_SRCH_RETURN:
     1217    13292
     1218    13293
     1219    13294    2         RETURN ;

  13294  2 004147   201316 221300       SETUP_SYSID* LDX1  ! RETURN_FLG+1,,AUTO
         2 004150   000001 702211                    TSX2  ! 1,X1

     1220    13295
     1221    13296    2   E_SETUP_SYSID_SRCH:
     1222    13297    2         ALTRETURN ;

  13297  2 004151   201316 221300       E_SETUP_SYS* LDX1  ! RETURN_FLG+1,,AUTO
         2 004152   000000 702211                    TSX2  ! 0,X1

     1223    13298    2   END   SETUP_SYSID_SRCH ;
     1224    13299        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:206  
     1225    13300    1   CHECK_WAIT: PROC ;

  13300  2 004153   201312 741300       CHECK_WAIT   STX1  ! VLR_JOBSTATS_CHECK+24,,AUTO

     1226    13301
     1227    13302    2         WAIT_DONE = '1'B ;

  13302  2 004154   400000 236003                    LDQ     -131072,DU
         2 004155   200131 756100                    STQ     WAIT_DONE,,AUTO

     1228    13303    2         WAIT_BELL = '0'B ;

  13303  2 004156   200132 450100                    STZ     WAIT_BELL,,AUTO

     1229    13304    2         WAIT_INT = 15 ;

  13304  2 004157   000017 235007                    LDA     15,DL
         2 004160   200442 755100                    STA     WAIT_INT,,AUTO

     1230    13305    3         DO K = 0 TO P$ -> P$B.NSUBLKS - 1 ;

  13305  2 004161   200146 450100                    STZ     K,,AUTO
         2 004162   004273 710000 2                  TRA     s:13321+1

     1231    13306
     1232    13307    4           DO CASE(P$->P$B.SUBLK$(K)->P$B.CODE) ;

  13307  2 004163   200004 470500                    LDP0    P$,,AUTO
         2 004164   200146 720100                    LXL0    K,,AUTO
         2 004165   000003 471510                    LDP1    3,X0,PR0
         2 004166   100000 236100                    LDQ     0,,PR1
         2 004167   777777 376007                    ANQ     -1,DL
         2 004170   000766 136007                    SBLQ    502,DL
         2 004171   000056 116007                    CMPQ    46,DL
         2 004172   004174 602006 2                  TNC     s:13307+9,QL
         2 004173   004272 710000 2                  TRA     s:13321
         2 004174   004252 710000 2                  TRA     s:13310
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:207  
         2 004175   004255 710000 2                  TRA     s:13313
         2 004176   004272 710000 2                  TRA     s:13321
         2 004177   004272 710000 2                  TRA     s:13321
         2 004200   004272 710000 2                  TRA     s:13321
         2 004201   004272 710000 2                  TRA     s:13321
         2 004202   004272 710000 2                  TRA     s:13321
         2 004203   004272 710000 2                  TRA     s:13321
         2 004204   004272 710000 2                  TRA     s:13321
         2 004205   004272 710000 2                  TRA     s:13321
         2 004206   004272 710000 2                  TRA     s:13321
         2 004207   004272 710000 2                  TRA     s:13321
         2 004210   004272 710000 2                  TRA     s:13321
         2 004211   004272 710000 2                  TRA     s:13321
         2 004212   004272 710000 2                  TRA     s:13321
         2 004213   004272 710000 2                  TRA     s:13321
         2 004214   004272 710000 2                  TRA     s:13321
         2 004215   004272 710000 2                  TRA     s:13321
         2 004216   004272 710000 2                  TRA     s:13321
         2 004217   004262 710000 2                  TRA     s:13318
         2 004220   004272 710000 2                  TRA     s:13321
         2 004221   004272 710000 2                  TRA     s:13321
         2 004222   004272 710000 2                  TRA     s:13321
         2 004223   004272 710000 2                  TRA     s:13321
         2 004224   004272 710000 2                  TRA     s:13321
         2 004225   004272 710000 2                  TRA     s:13321
         2 004226   004272 710000 2                  TRA     s:13321
         2 004227   004272 710000 2                  TRA     s:13321
         2 004230   004272 710000 2                  TRA     s:13321
         2 004231   004272 710000 2                  TRA     s:13321
         2 004232   004272 710000 2                  TRA     s:13321
         2 004233   004272 710000 2                  TRA     s:13321
         2 004234   004272 710000 2                  TRA     s:13321
         2 004235   004272 710000 2                  TRA     s:13321
         2 004236   004272 710000 2                  TRA     s:13321
         2 004237   004272 710000 2                  TRA     s:13321
         2 004240   004272 710000 2                  TRA     s:13321
         2 004241   004272 710000 2                  TRA     s:13321
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:208  
         2 004242   004272 710000 2                  TRA     s:13321
         2 004243   004272 710000 2                  TRA     s:13321
         2 004244   004272 710000 2                  TRA     s:13321
         2 004245   004272 710000 2                  TRA     s:13321
         2 004246   004272 710000 2                  TRA     s:13321
         2 004247   004272 710000 2                  TRA     s:13321
         2 004250   004272 710000 2                  TRA     s:13321
         2 004251   004257 710000 2                  TRA     s:13315

     1233    13308
     1234    13309    4             CASE(%CH_WAIT_DONE) ;

     1235    13310    4               WAIT_DONE = '1'B ;

  13310  2 004252   400000 236003                    LDQ     -131072,DU
         2 004253   200131 756100                    STQ     WAIT_DONE,,AUTO
         2 004254   004272 710000 2                  TRA     s:13321

     1236    13311
     1237    13312    4             CASE(%CH_WAIT_PRINT) ;

     1238    13313    4               WAIT_DONE = '0'B ;

  13313  2 004255   200131 450100                    STZ     WAIT_DONE,,AUTO
         2 004256   004272 710000 2                  TRA     s:13321

     1239    13314    4             CASE(%CH_WAIT_BELL) ;

     1240    13315    4               WAIT_BELL = '1'B ;

  13315  2 004257   400000 236003                    LDQ     -131072,DU
         2 004260   200132 756100                    STQ     WAIT_BELL,,AUTO
         2 004261   004272 710000 2                  TRA     s:13321

     1241    13316
     1242    13317    4             CASE(%CH_INTERVAL) ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:209  
     1243    13318    4               CALL CHARBIN(WAIT_INT,P$->P$B.SUBLK$(K) -> P$S.TEXT) ;

  13318  2 004262   100004 236100                    LDQ     4,,PR1
         2 004263   000033 772000                    QRL     27
         2 004264   000000 621006                    EAX1    0,QL
         2 004265   000100 305540                    DTB
         2 004266   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         2 004267   201344 000010                    NDSC9   LFPT_PRECORD+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 004270   201345 235100                    LDA     LFPT_PRECORD+11,,AUTO
         2 004271   200442 755100                    STA     WAIT_INT,,AUTO

     1244    13319
     1245    13320    4           END ; /* DO CASE */

     1246    13321    3         END ; /* DO K */

  13321  2 004272   200146 054100                    AOS     K,,AUTO
         2 004273   200004 470500                    LDP0    P$,,AUTO
         2 004274   000001 236100                    LDQ     1,,PR0
         2 004275   000022 772000                    QRL     18
         2 004276   200146 116100                    CMPQ    K,,AUTO
         2 004277   004163 605400 2                  TPNZ    s:13307

     1247    13322
     1248    13323    2         IF CMD_TYPE = %NOTIFY_CMD#

  13323  2 004300   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 004301   000001 115007                    CMPA    1,DL
         2 004302   004322 601000 2                  TNZ     s:13333

     1249    13324    2             THEN
     1250    13325    3               DO ;                                           /* Called by NOTIFY. */

     1251    13326    3                 CP_CHFLAGS.WAIT_DONE = WAIT_DONE ;

  13326  2 004303   200131 236100                    LDQ     WAIT_DONE,,AUTO
         2 004304   000023 772000                    QRL     19
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:210  
         2 004305   200217 676100                    ERQ     CP_CHFLAGS+24,,AUTO
         2 004306   200000 376007                    ANQ     65536,DL
         2 004307   200217 656100                    ERSQ    CP_CHFLAGS+24,,AUTO

     1252    13327    3                 CP_CHFLAGS.WAIT_INT = WAIT_INT ;

  13327  2 004310   000100 100500                    MLR     fill='000'O
         2 004311   200442 000004                    ADSC9   WAIT_INT,,AUTO           cn=0,n=4
         2 004312   200221 400004                    ADSC9   CP_CHFLAGS+26,,AUTO      cn=2,n=4

     1253    13328    3                 CP_CHFLAGS.FLG = %NO# ;

  13328  2 004313   000100 100400                    MLR     fill='000'O
         2 004314   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 004315   200220 400004                    ADSC9   CP_CHFLAGS+25,,AUTO      cn=2,n=4

     1254    13329    3                 CP_CHFLAGS.FLG.WAIT = %YES# ;

  13329  2 004316   000020 236007                    LDQ     16,DL
         2 004317   200220 256100                    ORSQ    CP_CHFLAGS+25,,AUTO

     1255    13330    3                 RETURN ;

  13330  2 004320   201312 221300                    LDX1  ! VLR_JOBSTATS_CHECK+24,,AUTO
         2 004321   000001 702211                    TSX2  ! 1,X1

     1256    13331    3               END ; /* THEN DO */
     1257    13332
     1258    13333    2         GOTO PAST_NOTIFY_WAIT ;

  13333  2 004322   004334 710000 2                  TRA     PAST_NOTIFY_WAIT

     1259    13334
     1260    13335    2   NOTIFY_WAIT:  ENTRY ;

  13335  2 004323   201312 741300       NOTIFY_WAIT  STX1  ! VLR_JOBSTATS_CHECK+24,,AUTO

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:211  
     1261    13336
     1262    13337    2         WAIT_DONE = CP_CHFLAGS.WAIT_DONE ;

  13337  2 004324   200217 236100                    LDQ     CP_CHFLAGS+24,,AUTO
         2 004325   000023 736000                    QLS     19
         2 004326   400000 376003                    ANQ     -131072,DU
         2 004327   200131 756100                    STQ     WAIT_DONE,,AUTO

     1263    13338    2         WAIT_INT = CP_CHFLAGS.WAIT_INT ;

  13338  2 004330   200221 235100                    LDA     CP_CHFLAGS+26,,AUTO
         2 004331   200222 236100                    LDQ     CP_CHFLAGS+27,,AUTO
         2 004332   000022 773000                    LRL     18
         2 004333   200442 756100                    STQ     WAIT_INT,,AUTO

     1264    13339
     1265    13340    2   PAST_NOTIFY_WAIT:
     1266    13341
     1267    13342    2         FORCE = '1'B ;

  13342  2 004334   400000 236003       PAST_NOTIFY* LDQ     -131072,DU
         2 004335   200136 756100                    STQ     FORCE,,AUTO

     1268    13343    2         FPT_TIME = CFPT_TIME ;

  13343  2 004336   000100 100400                    MLR     fill='000'O
         2 004337   000000 000060 xsym               ADSC9   CFPT_TIME                cn=0,n=48
         2 004340   201164 000060                    ADSC9   FPT_TIME,,AUTO           cn=0,n=48

     1269    13344    2         FPT_TIME.V_ = VECTOR(FPT_TIME.V) ;

  13344  2 004341   000005 235000 3                  LDA     5
         2 004342   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 004343   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 004344   001176 036003                    ADLQ    638,DU
         2 004345   201164 757100                    STAQ    FPT_TIME,,AUTO

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:212  
     1270    13345    2         FPT_TIME.TSTAMP_ = VECTOR(TEMP3) ;

  13345  2 004346   777640 235007                    LDA     -96,DL
         2 004347   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 004350   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 004351   000151 036003                    ADLQ    105,DU
         2 004352   201174 757100                    STAQ    FPT_TIME+8,,AUTO

     1271    13346    2         FPT_WAIT = CFPT_WAIT ;

  13346  2 004353   000100 100400                    MLR     fill='000'O
         2 004354   000000 000030 xsym               ADSC9   CFPT_WAIT                cn=0,n=24
         2 004355   201156 000030                    ADSC9   FPT_WAIT,,AUTO           cn=0,n=24

     1272    13347    2         FPT_WAIT.V_ = VECTOR(FPT_WAIT.V) ;

  13347  2 004356   000005 235000 3                  LDA     5
         2 004357   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 004360   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 004361   001162 036003                    ADLQ    626,DU
         2 004362   201156 757100                    STAQ    FPT_WAIT,,AUTO

     1273    13348    2         FPT_WAIT.V.UNITS# = WAIT_INT ;

  13348  2 004363   200442 235100                    LDA     WAIT_INT,,AUTO
         2 004364   201162 755100                    STA     FPT_WAIT+4,,AUTO

     1274    13349    2         WAITING = '1'B ;

  13349  2 004365   400000 236003                    LDQ     -131072,DU
         2 004366   200133 756100                    STQ     WAITING,,AUTO

     1275    13350    3         DO WHILE('1'B) ;

     1276    13351    3           MORE_2_WAIT = '0'B ;

  13351  2 004367   200134 450100                    STZ     MORE_2_WAIT,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:213  

     1277    13352    3           SOMETHING_CHANGED = '0'B ;

  13352  2 004370   200135 450100                    STZ     SOMETHING_CHANGED,,AUTO

     1278    13353    3           IF B$JIT.CPFLAGS1.BRK OR B$JIT.JUNK2 & %JJ2_DFRBRK#

  13353  2 004371   000000 470400 xsym               LDP0    B$JIT$
         2 004372   000143 236100                    LDQ     99,,PR0
         2 004373   000004 316007                    CANQ    4,DL
         2 004374   004400 601000 2                  TNZ     s:13356
         2 004375   000321 220100                    LDX0    209,,PR0
         2 004376   000004 360003                    ANX0    4,DU
         2 004377   004427 600000 2                  TZE     s:13368

     1279    13354    3             THEN
     1280    13355    4               DO ;                                      /* BREAK detected. */

     1281    13356    4                 B$JIT.CPFLAGS1.BRK = '0'B;

  13356  2 004400   000032 236000 3                  LDQ     26
         2 004401   000143 356100                    ANSQ    99,,PR0

     1282    13357    4                 IF B$JIT.JUNK2 & %JJ2_DFRBRK#

  13357  2 004402   000321 220100                    LDX0    209,,PR0
         2 004403   000004 360003                    ANX0    4,DU
         2 004404   004411 600000 2                  TZE     s:13359

     1283    13358    4                 THEN B$JIT.JUNK2 = B$JIT.JUNK2 & ~%JJ2_DFRBRK#;

  13358  2 004405   000321 220100                    LDX0    209,,PR0
         2 004406   777773 360003                    ANX0    -5,DU
         2 004407   000321 740100                    STX0    209,,PR0
         2 004410   004416 710000 2                  TRA     s:13361

     1284    13359    4                 ELSE IF B$TCB$ -> B$TCB.STK$ -> B$NWIO.SUBC = %SC_BYC#
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:214  

  13359  2 004411   000000 471400 xsym               LDP1    B$TCB$
         2 004412   100001 473500                    LDP3    1,,PR1
         2 004413   300100 720100                    LXL0    64,,PR3
         2 004414   000001 100003                    CMPX0   1,DU
         2 004415   004467 600000 2                  TZE     WAIT_DONE

     1285    13360    4                   THEN GOTO WAIT_DONE ;                 /* Get me out. */
     1286    13361    4                 CALL M$TRMPRG( CFPT_TRMPRG ) ALTRET(TRMPRG_ERR) ;

  13361  2 004416   000256 630400 1                  EPPR0   CFPT_TRMPRG
         2 004417   560004 713400                    CLIMB   alt,+57348
         2 004420   400400 401760                    pmme    nvectors=2
         2 004421   004422 702000 2                  TSX2    TRMPRG_ERR

     1287    13362    4   TRMPRG_ERR:
     1288    13363    4                 FORCE = '1'B ;

  13363  2 004422   400000 236003       TRMPRG_ERR   LDQ     -131072,DU
         2 004423   200136 756100                    STQ     FORCE,,AUTO

     1289    13364    4                 CALL CHECK_SYSIDS ALTRET(WAIT_DONE) ;

  13364  2 004424   005747 701000 2                  TSX1    CHECK_SYSIDS
         2 004425   004467 702000 2                  TSX2    WAIT_DONE

     1290    13365    4               END ; /* THEN DO */

  13365  2 004426   004431 710000 2                  TRA     s:13370

     1291    13366    3             ELSE
     1292    13367    4               DO ;

     1293    13368    4                 CALL CHECK_SYSIDS ALTRET(WAIT_DONE) ;

  13368  2 004427   005747 701000 2                  TSX1    CHECK_SYSIDS
         2 004430   004467 702000 2                  TSX2    WAIT_DONE
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:215  

     1294    13369    4               END ; /* ELSE DO */

     1295    13370    3           IF MORE_2_WAIT = %NO# AND WAIT_DONE = %NO#

  13370  2 004431   200134 234100                    SZN     MORE_2_WAIT,,AUTO
         2 004432   004435 604000 2                  TMI     s:13372
         2 004433   200131 234100                    SZN     WAIT_DONE,,AUTO
         2 004434   004467 605000 2                  TPL     WAIT_DONE

     1296    13371    3             THEN GOTO WAIT_DONE ;
     1297    13372    3           IF SOMETHING_CHANGED OR FORCE

  13372  2 004435   200135 234100                    SZN     SOMETHING_CHANGED,,AUTO
         2 004436   004441 604000 2                  TMI     s:13375
         2 004437   200136 234100                    SZN     FORCE,,AUTO
         2 004440   004460 605000 2                  TPL     s:13382

     1298    13373    3             THEN
     1299    13374    4               DO ;

     1300    13375    4                 IF FORCE OR NOT WAIT_BELL

  13375  2 004441   200136 234100                    SZN     FORCE,,AUTO
         2 004442   004445 604000 2                  TMI     s:13377
         2 004443   200132 234100                    SZN     WAIT_BELL,,AUTO
         2 004444   004450 604000 2                  TMI     s:13379

     1301    13376    4                   THEN
     1302    13377    4                     CH_XFORMAT.MSG# = %CP_TIME_DI_MESS ;

  13377  2 004445   000011 235007                    LDA     9,DL
         2 004446   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 004447   004452 710000 2                  TRA     s:13380

     1303    13378    4                   ELSE
     1304    13379    4                     CH_XFORMAT.MSG# = %CP_TIME_DI_W_BELL_MESS ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:216  

  13379  2 004450   000034 235007                    LDA     28,DL
         2 004451   200412 755100                    STA     CH_XFORMAT,,AUTO

     1305    13380    4                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13380  2 004452   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 004453   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 004454   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 004455   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004456   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 004457   000000 011000                    NOP     0

     1306    13381    4               END ; /* THEN DO */

     1307    13382    3           FORCE = '0'B ;

  13382  2 004460   200136 450100                    STZ     FORCE,,AUTO

     1308    13383    3           IF NOT SOMETHING_CHANGED

  13383  2 004461   200135 234100                    SZN     SOMETHING_CHANGED,,AUTO
         2 004462   004367 604000 2                  TMI     s:13351

     1309    13384    3             THEN
     1310    13385    3               CALL M$WAIT(FPT_WAIT) ;

  13385  2 004463   201156 630500                    EPPR0   FPT_WAIT,,AUTO
         2 004464   020006 713400                    CLIMB   8198
         2 004465   400400 401760                    pmme    nvectors=2

     1311    13386    3         END ; /* DO WHILE */

  13386  2 004466   004367 710000 2                  TRA     s:13351

     1312    13387    2   WAIT_DONE:
     1313    13388    2         WAITING = %NO# ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:217  

  13388  2 004467   200133 450100       WAIT_DONE    STZ     WAITING,,AUTO

     1314    13389    2         IF SOMETHING_CHANGED

  13389  2 004470   200135 234100                    SZN     SOMETHING_CHANGED,,AUTO
         2 004471   004507 605000 2                  TPL     s:13400

     1315    13390    2             THEN
     1316    13391    3               DO ;

     1317    13392    3                 IF WAIT_BELL

  13392  2 004472   200132 234100                    SZN     WAIT_BELL,,AUTO
         2 004473   004477 605000 2                  TPL     s:13396

     1318    13393    3                   THEN
     1319    13394    3                     CH_XFORMAT.MSG# = %CP_TIME_DI_W_BELL_MESS ;

  13394  2 004474   000034 235007                    LDA     28,DL
         2 004475   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 004476   004501 710000 2                  TRA     s:13397

     1320    13395    3                   ELSE
     1321    13396    3                     CH_XFORMAT.MSG# = %CP_TIME_DI_MESS ;

  13396  2 004477   000011 235007                    LDA     9,DL
         2 004500   200412 755100                    STA     CH_XFORMAT,,AUTO

     1322    13397    3                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13397  2 004501   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 004502   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 004503   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 004504   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004505   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 004506   000000 011000                    NOP     0
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:218  

     1323    13398    3               END ; /* THEN DO */

     1324    13399
     1325    13400    2         RETURN ;

  13400  2 004507   201312 221300                    LDX1  ! VLR_JOBSTATS_CHECK+24,,AUTO
         2 004510   000001 702211                    TSX2  ! 1,X1

     1326    13401    2   END   CHECK_WAIT ;
     1327    13402        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:219  
     1328    13403    1   DISP_INPUT:   PROC ;

  13403  2 004511   201322 741300       DISP_INPUT   STX1  ! ERRCODE+1,,AUTO

     1329    13404
     1330    13405    2   DCL MSG# UBIN WORD ;
     1331    13406    2   DCL HDR_MSG# UBIN WORD ;
     1332    13407
     1333    13408    2         J = 0 ;

  13408  2 004512   200145 450100                    STZ     J,,AUTO

     1334    13409    2         NUM_LISTED = 0 ;

  13409  2 004513   200440 450100                    STZ     NUM_LISTED,,AUTO

     1335    13410    2         CALL SETUP_HDR_CNT_SZ ;

  13410  2 004514   010117 701000 2                  TSX1    SETUP_HDR_CNT_SZ
         2 004515   000000 011000                    NOP     0

     1336    13411    2         HDR_CNT = HDR_CNT_SZ ;

  13411  2 004516   200165 235100                    LDA     HDR_CNT_SZ,,AUTO
         2 004517   200441 755100                    STA     HDR_CNT,,AUTO

     1337    13412    2         HELD_LINE_NOT_PRINTED = %YES# ;

  13412  2 004520   400000 236003                    LDQ     -131072,DU
         2 004521   200130 756100                    STQ     HELD_LINE_NOT_PRINTED,,AUTO

     1338    13413    2         IF CMD_CODE = %CH_RUN OR CMD_CODE = %CH_JOB

  13413  2 004522   200154 235100                    LDA     CMD_CODE,,AUTO
         2 004523   000012 115007                    CMPA    10,DL
         2 004524   004527 600000 2                  TZE     s:13416
         2 004525   000010 115007                    CMPA    8,DL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:220  
         2 004526   004534 601000 2                  TNZ     s:13420

     1339    13414    2             THEN
     1340    13415    3               DO ;

     1341    13416    3                 MSG# = %CP_RUN_MESS ;

  13416  2 004527   000010 235007                    LDA     8,DL
         2 004530   201323 755100                    STA     MSG#,,AUTO

     1342    13417    3                 HDR_MSG# = %CP_RUN_HDR ;

  13417  2 004531   000007 235007                    LDA     7,DL
         2 004532   201324 755100                    STA     HDR_MSG#,,AUTO

     1343    13418    3                 GOTO FOUND_FIRST_TO_PRINT ;

  13418  2 004533   004562 710000 2                  TRA     FOUND_FIRST_TO_PRINT

     1344    13419    3               END ; /* THEN DO */
     1345    13420    2         MSG# = %CP_INPUT_MESS ;

  13420  2 004534   000002 235007                    LDA     2,DL
         2 004535   201323 755100                    STA     MSG#,,AUTO

     1346    13421    2         HDR_MSG# = %CP_INPUT_HDR ;

  13421  2 004536   000001 235007                    LDA     1,DL
         2 004537   201324 755100                    STA     HDR_MSG#,,AUTO

     1347    13422
     1348    13423    3         DO J = 0 TO STAT$ -> VLR$INPUT.FOUND - 1 ;

  13423  2 004540   200145 450100                    STZ     J,,AUTO
         2 004541   004555 710000 2                  TRA     s:13427+1

     1349    13424
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:221  
     1350    13425    3             BUF$ = ADDR(STAT$ -> VLR$INPUT.J(J)) ;

  13425  2 004542   200145 236100                    LDQ     J,,AUTO
         2 004543   000030 736000                    QLS     24
         2 004544   000002 036003                    ADLQ    2,DU
         2 004545   200013 036100                    ADLQ    STAT$,,AUTO
         2 004546   200017 756100                    STQ     BUF$,,AUTO

     1351    13426    3             IF (BUF$ -> VLA$INPUT.PRIO ~= %JP_RUN#) THEN GOTO FOUND_FIRST_TO_PRINT ;

  13426  2 004547   200017 470500                    LDP0    BUF$,,AUTO
         2 004550   000003 236100                    LDQ     3,,PR0
         2 004551   000777 376007                    ANQ     511,DL
         2 004552   000020 116007                    CMPQ    16,DL
         2 004553   004562 601000 2                  TNZ     FOUND_FIRST_TO_PRINT

     1352    13427    3         END ; /* DO J */

  13427  2 004554   200145 054100                    AOS     J,,AUTO
         2 004555   200013 470500                    LDP0    STAT$,,AUTO
         2 004556   200145 236100                    LDQ     J,,AUTO
         2 004557   004542 604000 2                  TMI     s:13425
         2 004560   000000 116100                    CMPQ    0,,PR0
         2 004561   004542 602000 2                  TNC     s:13425

     1353    13428
     1354    13429    2   FOUND_FIRST_TO_PRINT:
     1355    13430
     1356    13431    3         DO K = J TO STAT$ -> VLR$INPUT.FOUND - 1 ;

  13431  2 004562   200145 235100       FOUND_FIRST* LDA     J,,AUTO
         2 004563   200146 755100                    STA     K,,AUTO
         2 004564   004732 710000 2                  TRA     DO_NEXT_K+1

     1357    13432    3             IF B$JIT.CPFLAGS1.BRK

  13432  2 004565   000000 470400 xsym               LDP0    B$JIT$
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:222  
         2 004566   000143 236100                    LDQ     99,,PR0
         2 004567   000004 316007                    CANQ    4,DL
         2 004570   004737 601000 2                  TNZ     DONE_LISTING_INPUT

     1358    13433    3               THEN GOTO DONE_LISTING_INPUT ;            /* Forget the rest. */
     1359    13434    3             BUF$ = ADDR(STAT$ -> VLR$INPUT.J(K)) ;

  13434  2 004571   200146 236100                    LDQ     K,,AUTO
         2 004572   000030 736000                    QLS     24
         2 004573   000002 036003                    ADLQ    2,DU
         2 004574   200013 036100                    ADLQ    STAT$,,AUTO
         2 004575   200017 756100                    STQ     BUF$,,AUTO

     1360    13435
     1361    13436    4             DO CASE(CMD_CODE) ;

  13436  2 004576   200154 235100                    LDA     CMD_CODE,,AUTO
         2 004577   000007 135007                    SBLA    7,DL
         2 004600   000004 115007                    CMPA    4,DL
         2 004601   004603 602005 2                  TNC     s:13436+5,AL
         2 004602   004643 710000 2                  TRA     s:13464
         2 004603   004615 710000 2                  TRA     s:13444
         2 004604   004607 710000 2                  TRA     s:13439
         2 004605   004643 710000 2                  TRA     s:13464
         2 004606   004607 710000 2                  TRA     s:13439

     1362    13437
     1363    13438    4               CASE( %CH_RUN, %CH_JOB) ;

     1364    13439    4                 IF BUF$->VLA$INPUT.PRIO ~= %JP_RUN#

  13439  2 004607   200017 471500                    LDP1    BUF$,,AUTO
         2 004610   100003 236100                    LDQ     3,,PR1
         2 004611   000777 376007                    ANQ     511,DL
         2 004612   000020 116007                    CMPQ    16,DL
         2 004613   004737 601000 2                  TNZ     DONE_LISTING_INPUT
         2 004614   004643 710000 2                  TRA     s:13464
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:223  

     1365    13440    4                   THEN
     1366    13441    4                     GOTO DONE_LISTING_INPUT ;
     1367    13442
     1368    13443    4               CASE(%CH_INPUT) ;

     1369    13444    5                 DO CASE(CP_CHFLAGS.INPUT_OPT) ;

  13444  2 004615   200217 235100                    LDA     CP_CHFLAGS+24,,AUTO
         2 004616   000022 771000                    ARL     18
         2 004617   001045 135007                    SBLA    549,DL
         2 004620   000002 115007                    CMPA    2,DL
         2 004621   004623 602005 2                  TNC     s:13444+6,AL
         2 004622   004643 710000 2                  TRA     s:13464
         2 004623   004625 710000 2                  TRA     s:13449
         2 004624   004633 710000 2                  TRA     s:13454

     1370    13445
     1371    13446    5                   CASE(%CH_INPUT_ALL_OPT) ;

     1372    13447
     1373    13448    5                   CASE(%CH_INPUT_READY_OPT) ;

     1374    13449    5                     IF BUF$->VLA$INPUT.PRIO > %JP_RUN#

  13449  2 004625   200017 471500                    LDP1    BUF$,,AUTO
         2 004626   100003 236100                    LDQ     3,,PR1
         2 004627   000777 376007                    ANQ     511,DL
         2 004630   000021 116007                    CMPQ    17,DL
         2 004631   004737 603000 2                  TRC     DONE_LISTING_INPUT
         2 004632   004643 710000 2                  TRA     s:13464

     1375    13450    5                       THEN
     1376    13451    5                         GOTO DONE_LISTING_INPUT ;
     1377    13452
     1378    13453    5                   CASE(%CH_INPUT_HELD_OPT) ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:224  
     1379    13454    5                     IF HELD_LINE_NOT_PRINTED

  13454  2 004633   200130 234100                    SZN     HELD_LINE_NOT_PRINTED,,AUTO
         2 004634   004636 605000 2                  TPL     s:13457

     1380    13455    5                       THEN
     1381    13456    5                         HELD_LINE_NOT_PRINTED = %NO# ;

  13456  2 004635   200130 450100                    STZ     HELD_LINE_NOT_PRINTED,,AUTO

     1382    13457    5                     IF BUF$->VLA$INPUT.PRIO < %JP_RUN#

  13457  2 004636   200017 471500                    LDP1    BUF$,,AUTO
         2 004637   100003 236100                    LDQ     3,,PR1
         2 004640   000777 376007                    ANQ     511,DL
         2 004641   000020 116007                    CMPQ    16,DL
         2 004642   004731 602000 2                  TNC     DO_NEXT_K

     1383    13458    5                       THEN
     1384    13459    5                         GOTO DO_NEXT_K ;
     1385    13460
     1386    13461    5                 END ;

     1387    13462    4             END ; /* Do Case */

     1388    13463
     1389    13464    3             IF BUF$->VLA$INPUT.PRIO > %JP_RUN# AND HELD_LINE_NOT_PRINTED

  13464  2 004643   200017 471500                    LDP1    BUF$,,AUTO
         2 004644   100003 236100                    LDQ     3,,PR1
         2 004645   000777 376007                    ANQ     511,DL
         2 004646   000021 116007                    CMPQ    17,DL
         2 004647   004670 602000 2                  TNC     s:13473
         2 004650   200130 234100                    SZN     HELD_LINE_NOT_PRINTED,,AUTO
         2 004651   004670 605000 2                  TPL     s:13473

     1390    13465    3               THEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:225  
     1391    13466    4                 DO ;

     1392    13467    4                   CH_XFORMAT.MSG# = %CP_HELD_LINE ;

  13467  2 004652   000035 235007                    LDA     29,DL
         2 004653   200412 755100                    STA     CH_XFORMAT,,AUTO

     1393    13468    4                   CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;

  13468  2 004654   200166 633500                    EPPR3   NLINES,,AUTO
         2 004655   201345 453500                    STP3    LFPT_PRECORD+11,,AUTO
         2 004656   200412 634500                    EPPR4   CH_XFORMAT,,AUTO
         2 004657   201344 454500                    STP4    LFPT_PRECORD+10,,AUTO
         2 004660   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 004661   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004662   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 004663   000000 011000                    NOP     0

     1394    13469    4                   HDR_CNT = HDR_CNT + NLINES ;

  13469  2 004664   200441 236100                    LDQ     HDR_CNT,,AUTO
         2 004665   200166 036100                    ADLQ    NLINES,,AUTO
         2 004666   200441 756100                    STQ     HDR_CNT,,AUTO

     1395    13470    4                   HELD_LINE_NOT_PRINTED = %NO# ;

  13470  2 004667   200130 450100                    STZ     HELD_LINE_NOT_PRINTED,,AUTO

     1396    13471    4                 END ; /* Then Do */

     1397    13472
     1398    13473    3             IF HDR_CNT >= HDR_CNT_SZ

  13473  2 004670   200441 236100                    LDQ     HDR_CNT,,AUTO
         2 004671   200165 116100                    CMPQ    HDR_CNT_SZ,,AUTO
         2 004672   004707 602000 2                  TNC     s:13481

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:226  
     1399    13474    3               THEN
     1400    13475    4                 DO ;

     1401    13476    4                   CH_XFORMAT.MSG# = HDR_MSG#;

  13476  2 004673   201324 235100                    LDA     HDR_MSG#,,AUTO
         2 004674   200412 755100                    STA     CH_XFORMAT,,AUTO

     1402    13477    4                   CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;

  13477  2 004675   200166 630500                    EPPR0   NLINES,,AUTO
         2 004676   201345 450500                    STP0    LFPT_PRECORD+11,,AUTO
         2 004677   200412 631500                    EPPR1   CH_XFORMAT,,AUTO
         2 004700   201344 451500                    STP1    LFPT_PRECORD+10,,AUTO
         2 004701   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 004702   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004703   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 004704   000000 011000                    NOP     0

     1403    13478    4                   HDR_CNT = NLINES ;

  13478  2 004705   200166 235100                    LDA     NLINES,,AUTO
         2 004706   200441 755100                    STA     HDR_CNT,,AUTO

     1404    13479    4                 END ; /* THEN DO */

     1405    13480
     1406    13481    3             CH_XFORMAT.BUF$ = BUF$ ;

  13481  2 004707   200017 236100                    LDQ     BUF$,,AUTO
         2 004710   200427 756100                    STQ     CH_XFORMAT+13,,AUTO

     1407    13482
     1408    13483    3             CH_XFORMAT.MSG# = MSG#;

  13483  2 004711   201323 235100                    LDA     MSG#,,AUTO
         2 004712   200412 755100                    STA     CH_XFORMAT,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:227  

     1409    13484    3             CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;

  13484  2 004713   200166 630500                    EPPR0   NLINES,,AUTO
         2 004714   201345 450500                    STP0    LFPT_PRECORD+11,,AUTO
         2 004715   200412 631500                    EPPR1   CH_XFORMAT,,AUTO
         2 004716   201344 451500                    STP1    LFPT_PRECORD+10,,AUTO
         2 004717   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 004720   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004721   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 004722   000000 011000                    NOP     0

     1410    13485    3             NUM_LISTED = NUM_LISTED + 1 ;

  13485  2 004723   200440 235100                    LDA     NUM_LISTED,,AUTO
         2 004724   000001 035007                    ADLA    1,DL
         2 004725   200440 755100                    STA     NUM_LISTED,,AUTO

     1411    13486    3             HDR_CNT = HDR_CNT + NLINES ;

  13486  2 004726   200441 236100                    LDQ     HDR_CNT,,AUTO
         2 004727   200166 036100                    ADLQ    NLINES,,AUTO
         2 004730   200441 756100                    STQ     HDR_CNT,,AUTO

     1412    13487
     1413    13488    3   DO_NEXT_K:
     1414    13489    3         END ;   /* DO WHILE */

  13489  2 004731   200146 054100       DO_NEXT_K    AOS     K,,AUTO
         2 004732   200013 470500                    LDP0    STAT$,,AUTO
         2 004733   200146 236100                    LDQ     K,,AUTO
         2 004734   004565 604000 2                  TMI     s:13432
         2 004735   000000 116100                    CMPQ    0,,PR0
         2 004736   004565 602000 2                  TNC     s:13432

     1415    13490
     1416    13491    2   DONE_LISTING_INPUT:
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:228  
     1417    13492
     1418    13493    2         IF (NUM_LISTED = 0) AND NOT NOTIFYING

  13493  2 004737   200440 235100       DONE_LISTIN* LDA     NUM_LISTED,,AUTO
         2 004740   004763 601000 2                  TNZ     s:13502
         2 004741   200137 234100                    SZN     NOTIFYING,,AUTO
         2 004742   004763 604000 2                  TMI     s:13502

     1419    13494    2             THEN
     1420    13495    3               DO ;

     1421    13496    3                 IF CMD_CODE = %CH_INPUT

  13496  2 004743   200154 236100                    LDQ     CMD_CODE,,AUTO
         2 004744   000007 116007                    CMPQ    7,DL
         2 004745   004751 601000 2                  TNZ     s:13498

     1422    13497    3                   THEN CH_XFORMAT.MSG# = %CP_NONE_IN_MESS ;

  13497  2 004746   000027 235007                    LDA     23,DL
         2 004747   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 004750   004753 710000 2                  TRA     s:13499

     1423    13498    3                   ELSE CH_XFORMAT.MSG# = %CP_NONE_RUN_MESS ;

  13498  2 004751   000030 235007                    LDA     24,DL
         2 004752   200412 755100                    STA     CH_XFORMAT,,AUTO

     1424    13499    3                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13499  2 004753   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 004754   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 004755   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 004756   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004757   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 004760   000000 011000                    NOP     0

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:229  
     1425    13500    3                 RETURN ;

  13500  2 004761   201322 221300                    LDX1  ! ERRCODE+1,,AUTO
         2 004762   000001 702211                    TSX2  ! 1,X1

     1426    13501    3               END ; /* THEN DO */
     1427    13502    2         IF NUM_LISTED = 1

  13502  2 004763   000001 115007                    CMPA    1,DL
         2 004764   004776 600000 2                  TZE     DONT_PRINT_NUM_LISTED

     1428    13503    2             THEN GOTO DONT_PRINT_NUM_LISTED ;
     1429    13504    2         CH_XFORMAT.NUM# = NUM_LISTED ;

  13504  2 004765   200426 755100                    STA     CH_XFORMAT+12,,AUTO

     1430    13505    2         CH_XFORMAT.MSG# = %CP_NUM_LISTED ;

  13505  2 004766   000003 236007                    LDQ     3,DL
         2 004767   200412 756100                    STQ     CH_XFORMAT,,AUTO

     1431    13506    2         CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13506  2 004770   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 004771   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 004772   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 004773   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004774   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 004775   000000 011000                    NOP     0

     1432    13507
     1433    13508    2   DONT_PRINT_NUM_LISTED:
     1434    13509
     1435    13510    2         RETURN ;

  13510  2 004776   201322 221300       DONT_PRINT_* LDX1  ! ERRCODE+1,,AUTO
         2 004777   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:230  

     1436    13511
     1437    13512    2   END   DISP_INPUT ;
     1438    13513        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:231  
     1439    13514    1   DISP_OUTPUT:   PROC ;

  13514  2 005000   201322 741300       DISP_OUTPUT  STX1  ! ERRCODE+1,,AUTO

     1440    13515
     1441    13516    2         CALL SETUP_HDR_CNT_SZ ;

  13516  2 005001   010117 701000 2                  TSX1    SETUP_HDR_CNT_SZ
         2 005002   000000 011000                    NOP     0

     1442    13517    2         HDR_CNT = HDR_CNT_SZ ;

  13517  2 005003   200165 235100                    LDA     HDR_CNT_SZ,,AUTO
         2 005004   200441 755100                    STA     HDR_CNT,,AUTO

     1443    13518    2         CH_XFORMAT.NUM# = 0 ;                           /* Remember number ahead. */

  13518  2 005005   200426 450100                    STZ     CH_XFORMAT+12,,AUTO

     1444    13519
     1445    13520    3         DO J = 0 TO STAT$ -> VLR$OUTPUT.FOUND - 1 ;

  13520  2 005006   200145 450100                    STZ     J,,AUTO
         2 005007   005056 710000 2                  TRA     s:13536+1

     1446    13521    3             IF B$JIT.CPFLAGS1.BRK

  13521  2 005010   000000 470400 xsym               LDP0    B$JIT$
         2 005011   000143 236100                    LDQ     99,,PR0
         2 005012   000004 316007                    CANQ    4,DL
         2 005013   005063 601000 2                  TNZ     DONE_LISTING_OUTPUT

     1447    13522    3               THEN GOTO DONE_LISTING_OUTPUT ;           /* Forget the rest. */
     1448    13523    3             IF HDR_CNT >= HDR_CNT_SZ

  13523  2 005014   200441 236100                    LDQ     HDR_CNT,,AUTO
         2 005015   200165 116100                    CMPQ    HDR_CNT_SZ,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:232  
         2 005016   005035 602000 2                  TNC     s:13531

     1449    13524    3               THEN
     1450    13525    4                 DO ;

     1451    13526    4                   CH_XFORMAT.MSG# = %CP_DFLT_OUTPUT_HDR ;

  13526  2 005017   000005 235007                    LDA     5,DL
         2 005020   200412 755100                    STA     CH_XFORMAT,,AUTO

     1452    13527    4                   CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;

  13527  2 005021   200166 631500                    EPPR1   NLINES,,AUTO
         2 005022   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 005023   200412 633500                    EPPR3   CH_XFORMAT,,AUTO
         2 005024   201344 453500                    STP3    LFPT_PRECORD+10,,AUTO
         2 005025   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 005026   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005027   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 005030   000000 011000                    NOP     0

     1453    13528    4                   CH_XFORMAT.MSG# = %CP_OUTPUT_MESS ;

  13528  2 005031   000006 235007                    LDA     6,DL
         2 005032   200412 755100                    STA     CH_XFORMAT,,AUTO

     1454    13529    4                   HDR_CNT = NLINES ;

  13529  2 005033   200166 236100                    LDQ     NLINES,,AUTO
         2 005034   200441 756100                    STQ     HDR_CNT,,AUTO

     1455    13530    4                 END ; /* Then Do */

     1456    13531    3             CH_XFORMAT.BUF$ = ADDR(STAT$ -> VLR$OUTPUT.F(J)) ;

  13531  2 005035   200145 236100                    LDQ     J,,AUTO
         2 005036   000034 402003                    MPY     28,DU
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:233  
         2 005037   000002 036003                    ADLQ    2,DU
         2 005040   200013 036100                    ADLQ    STAT$,,AUTO
         2 005041   200427 756100                    STQ     CH_XFORMAT+13,,AUTO

     1457    13532
     1458    13533    3             CALL CPK$CHECK_OUTPUT(CH_XFORMAT,NLINES) ;

  13533  2 005042   200166 630500                    EPPR0   NLINES,,AUTO
         2 005043   201345 450500                    STP0    LFPT_PRECORD+11,,AUTO
         2 005044   200412 631500                    EPPR1   CH_XFORMAT,,AUTO
         2 005045   201344 451500                    STP1    LFPT_PRECORD+10,,AUTO
         2 005046   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 005047   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 005050   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 005051   000000 011000                    NOP     0

     1459    13534    3             HDR_CNT = HDR_CNT + NLINES ;

  13534  2 005052   200441 236100                    LDQ     HDR_CNT,,AUTO
         2 005053   200166 036100                    ADLQ    NLINES,,AUTO
         2 005054   200441 756100                    STQ     HDR_CNT,,AUTO

     1460    13535
     1461    13536    3         END ;   /* DO WHILE */

  13536  2 005055   200145 054100                    AOS     J,,AUTO
         2 005056   200013 470500                    LDP0    STAT$,,AUTO
         2 005057   200145 236100                    LDQ     J,,AUTO
         2 005060   005010 604000 2                  TMI     s:13521
         2 005061   000000 116100                    CMPQ    0,,PR0
         2 005062   005010 602000 2                  TNC     s:13521

     1462    13537
     1463    13538    2   DONE_LISTING_OUTPUT:
     1464    13539
     1465    13540    2         IF J = 1

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:234  
  13540  2 005063   200145 235100       DONE_LISTIN* LDA     J,,AUTO
         2 005064   000001 115007                    CMPA    1,DL
         2 005065   005077 600000 2                  TZE     DONT_PRINT_NUM_LISTED

     1466    13541    2             THEN GOTO DONT_PRINT_NUM_LISTED ;
     1467    13542    2         CH_XFORMAT.NUM# = J ;

  13542  2 005066   200426 755100                    STA     CH_XFORMAT+12,,AUTO

     1468    13543    2         CH_XFORMAT.MSG# = %CP_NUM_LISTED ;

  13543  2 005067   000003 236007                    LDQ     3,DL
         2 005070   200412 756100                    STQ     CH_XFORMAT,,AUTO

     1469    13544    2         CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13544  2 005071   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 005072   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 005073   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 005074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005075   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 005076   000000 011000                    NOP     0

     1470    13545
     1471    13546    2   DONT_PRINT_NUM_LISTED:
     1472    13547
     1473    13548    2         RETURN ;

  13548  2 005077   201322 221300       DONT_PRINT_* LDX1  ! ERRCODE+1,,AUTO
         2 005100   000001 702211                    TSX2  ! 1,X1

     1474    13549
     1475    13550    2   END   DISP_OUTPUT ;
     1476    13551        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:235  
     1477    13552    1   DISP_SYSID_SRCH_IRQ:    PROC ;

  13552  2 005101   201322 741300       DISP_SYSID_* STX1  ! ERRCODE+1,,AUTO

     1478    13553
     1479    13554    3         DO J = 0 TO STAT$ -> VLR$INPUT.FOUND - 1 ;

  13554  2 005102   200145 450100                    STZ     J,,AUTO
         2 005103   005325 710000 2                  TRA     E_WRITE_CHECK+1

     1480    13555
     1481    13556    3             IF B$JIT.CPFLAGS1.BRK

  13556  2 005104   000000 470400 xsym               LDP0    B$JIT$
         2 005105   000143 236100                    LDQ     99,,PR0
         2 005106   000004 316007                    CANQ    4,DL
         2 005107   005112 600000 2                  TZE     s:13558

     1482    13557    3               THEN RETURN ;                             /* Forget the rest. */

  13557  2 005110   201322 221300                    LDX1  ! ERRCODE+1,,AUTO
         2 005111   000001 702211                    TSX2  ! 1,X1

     1483    13558    3             CH_XFORMAT.BUF$ = ADDR(STAT$ -> VLR$INPUT.J(J)) ;

  13558  2 005112   200145 236100                    LDQ     J,,AUTO
         2 005113   000030 736000                    QLS     24
         2 005114   000002 036003                    ADLQ    2,DU
         2 005115   200013 036100                    ADLQ    STAT$,,AUTO
         2 005116   200427 756100                    STQ     CH_XFORMAT+13,,AUTO

     1484    13559
     1485    13560    4             DO CASE(CH_XFORMAT.BUF$ -> VLA$INPUT.PRIO) ;

  13560  2 005117   200427 471500                    LDP1    CH_XFORMAT+13,,AUTO
         2 005120   100003 236100                    LDQ     3,,PR1
         2 005121   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:236  
         2 005122   000020 136007                    SBLQ    16,DL
         2 005123   000006 116007                    CMPQ    6,DL
         2 005124   005126 602006 2                  TNC     s:13560+7,QL
         2 005125   005156 710000 2                  TRA     s:13581
         2 005126   005134 710000 2                  TRA     s:13563
         2 005127   005137 710000 2                  TRA     s:13566
         2 005130   005142 710000 2                  TRA     s:13569
         2 005131   005145 710000 2                  TRA     s:13572
         2 005132   005150 710000 2                  TRA     s:13575
         2 005133   005153 710000 2                  TRA     s:13578

     1486    13561
     1487    13562    4               CASE(%JP_RUN#) ;

     1488    13563    4                 CH_XFORMAT.MSG# = %CP_SYSID_RUN_MESS ;

  13563  2 005134   000020 235007                    LDA     16,DL
         2 005135   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 005136   005160 710000 2                  TRA     s:13585

     1489    13564
     1490    13565    4               CASE(%JP_FOLL#) ;

     1491    13566    4                 CH_XFORMAT.MSG# = %CP_SYSID_FOLL_MESS ;

  13566  2 005137   000021 235007                    LDA     17,DL
         2 005140   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 005141   005160 710000 2                  TRA     s:13585

     1492    13567
     1493    13568    4               CASE(%JP_RUNAFTER#) ;

     1494    13569    4                 CH_XFORMAT.MSG# = %CP_SYSID_RUNAFTER_MESS ;

  13569  2 005142   000022 235007                    LDA     18,DL
         2 005143   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 005144   005160 710000 2                  TRA     s:13585
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:237  

     1495    13570
     1496    13571    4               CASE(%JP_WPART#) ;

     1497    13572    4                 CH_XFORMAT.MSG# = %CP_SYSID_WPART_MESS ;

  13572  2 005145   000023 235007                    LDA     19,DL
         2 005146   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 005147   005160 710000 2                  TRA     s:13585

     1498    13573
     1499    13574    4               CASE(%JP_OTHER#) ;

     1500    13575    4                 CH_XFORMAT.MSG# = %CP_SYSID_OTHER_MESS ;

  13575  2 005150   000024 235007                    LDA     20,DL
         2 005151   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 005152   005160 710000 2                  TRA     s:13585

     1501    13576
     1502    13577    4               CASE(%JP_WPS#) ;

     1503    13578    4                 CH_XFORMAT.MSG# = %CP_SYSID_WPS_MESS ;

  13578  2 005153   000025 235007                    LDA     21,DL
         2 005154   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 005155   005160 710000 2                  TRA     s:13585

     1504    13579
     1505    13580    4               CASE(ELSE) ;

     1506    13581    4                 CH_XFORMAT.MSG# = %CP_SYSID_WAIT_MESS ;

  13581  2 005156   000026 235007                    LDA     22,DL
         2 005157   200412 755100                    STA     CH_XFORMAT,,AUTO

     1507    13582
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:238  
     1508    13583    4             END ; /* DO CASE */

     1509    13584
     1510    13585    3             IF CMD_TYPE = %CANCEL_CMD#

  13585  2 005160   200164 236100                    LDQ     CMD_TYPE,,AUTO
         2 005161   000003 116007                    CMPQ    3,DL
         2 005162   005271 601000 2                  TNZ     s:13624

     1511    13586    3               THEN
     1512    13587    4                 DO;

     1513    13588    4                   IF CH_XFORMAT.BUF$ -> VLA$INPUT.PRIO = %JP_RUN#

  13588  2 005163   100003 236100                    LDQ     3,,PR1
         2 005164   000777 376007                    ANQ     511,DL
         2 005165   000020 116007                    CMPQ    16,DL
         2 005166   005173 601000 2                  TNZ     s:13596

     1514    13589    4                     THEN
     1515    13590    5                       DO;

     1516    13591    5                         IF CMD_CODE = %CH_INPUT

  13591  2 005167   200154 235100                    LDA     CMD_CODE,,AUTO
         2 005170   000007 115007                    CMPA    7,DL
         2 005171   005324 600000 2                  TZE     E_WRITE_CHECK

     1517    13592    5                           THEN
     1518    13593    5                             GOTO E_WRITE_CHECK;
     1519    13594    5                       END;

  13594  2 005172   005224 710000 2                  TRA     s:13612

     1520    13595    4                     ELSE
     1521    13596    4                       IF CH_XFORMAT.BUF$ -> VLA$INPUT.PRIO > %JP_RUN#

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:239  
  13596  2 005173   000021 116007                    CMPQ    17,DL
         2 005174   005212 602000 2                  TNC     s:13607

     1522    13597    4                         THEN
     1523    13598    5                           DO;

     1524    13599    5                             IF CMD_CODE = %CH_JOB OR CMD_CODE = %CH_RUN

  13599  2 005175   200154 235100                    LDA     CMD_CODE,,AUTO
         2 005176   000010 115007                    CMPA    8,DL
         2 005177   005324 600000 2                  TZE     E_WRITE_CHECK
         2 005200   000012 115007                    CMPA    10,DL
         2 005201   005324 600000 2                  TZE     E_WRITE_CHECK
         2 005202   000007 115007                    CMPA    7,DL
         2 005203   005211 601000 2                  TNZ     s:13605
         2 005204   200217 220100                    LDX0    CP_CHFLAGS+24,,AUTO
         2 005205   001044 100003                    CMPX0   548,DU
         2 005206   005211 600000 2                  TZE     s:13605
         2 005207   001046 100003                    CMPX0   550,DU
         2 005210   005324 601000 2                  TNZ     E_WRITE_CHECK

     1525    13600    5                               OR CMD_CODE = %CH_INPUT
     1526    13601    5                               AND CP_CHFLAGS.INPUT_OPT ~= %CH_INPUT_ALL_OPT
     1527    13602    5                               AND CP_CHFLAGS.INPUT_OPT ~= %CH_INPUT_HELD_OPT
     1528    13603    5                               THEN
     1529    13604    5                                 GOTO E_WRITE_CHECK;
     1530    13605    5                           END;

  13605  2 005211   005224 710000 2                  TRA     s:13612

     1531    13606    4                         ELSE  /* PRIO < RUN */
     1532    13607    4                           IF CMD_CODE = %CH_JOB OR CMD_CODE = %CH_RUN

  13607  2 005212   200154 235100                    LDA     CMD_CODE,,AUTO
         2 005213   000010 115007                    CMPA    8,DL
         2 005214   005324 600000 2                  TZE     E_WRITE_CHECK
         2 005215   000012 115007                    CMPA    10,DL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:240  
         2 005216   005324 600000 2                  TZE     E_WRITE_CHECK
         2 005217   000007 115007                    CMPA    7,DL
         2 005220   005224 601000 2                  TNZ     s:13612
         2 005221   200217 220100                    LDX0    CP_CHFLAGS+24,,AUTO
         2 005222   001046 100003                    CMPX0   550,DU
         2 005223   005324 600000 2                  TZE     E_WRITE_CHECK

     1533    13608    4                             OR CMD_CODE = %CH_INPUT
     1534    13609    4                             AND CP_CHFLAGS.INPUT_OPT = %CH_INPUT_HELD_OPT
     1535    13610    4                             THEN
     1536    13611    4                               GOTO E_WRITE_CHECK;
     1537    13612    4                   FPT_JOBSTATS_CANCEL.V.SYSID# = CH_XFORMAT.BUF$->VLA$INPUT.SYSID;

  13612  2 005224   100006 236100                    LDQ     6,,PR1
         2 005225   777777 376007                    ANQ     -1,DL
         2 005226   201121 756100                    STQ     FPT_JOBSTATS_CANCEL+25,,AUTO

     1538    13613    4                   FPT_JOBSTATS_CANCEL.V.ORDER# = %CANCEL#;

  13613  2 005227   000003 235007                    LDA     3,DL
         2 005230   201120 755100                    STA     FPT_JOBSTATS_CANCEL+24,,AUTO

     1539    13614    4                   CH_XFORMAT.COMMENT# = '> Canceled <';

  13614  2 005231   040100 100400                    MLR     fill='040'O
         2 005232   000307 000014 1                  ADSC9   JOBSTATS_ACCT+10         cn=0,n=12
         2 005233   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     1540    13615    4                   IF NOT FPT_JOBSTATS_CANCEL.V.OUTPUT#

  13615  2 005234   201123 234100                    SZN     FPT_JOBSTATS_CANCEL+27,,AUTO
         2 005235   005241 604000 2                  TMI     s:13618

     1541    13616    4                     THEN
     1542    13617    4                       CH_XFORMAT.COMMENT# = '> Aborted <';

  13617  2 005236   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:241  
         2 005237   000312 000013 1                  ADSC9   JOBSTATS_ACCT+13         cn=0,n=11
         2 005240   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     1543    13618    5                   CALL M$JOBSTATS (FPT_JOBSTATS_CANCEL) WHENALTRETURN DO;

  13618  2 005241   201070 630500                    EPPR0   FPT_JOBSTATS_CANCEL,,AUTO
         2 005242   570001 713400                    CLIMB   alt,+61441
         2 005243   405400 401760                    pmme    nvectors=12
         2 005244   005246 702000 2                  TSX2    s:13619
         2 005245   005271 710000 2                  TRA     s:13624

     1544    13619    5                       CALL CPC$WRITEMSGE(B$TCB$->B$TCB.ALT$->B$ALT.ERR,,,,,%YES#);

  13619  2 005246   000000 470400 xsym               LDP0    B$TCB$
         2 005247   000000 471500                    LDP1    0,,PR0
         2 005250   000050 236000 3                  LDQ     40
         2 005251   000001 235000 xsym               LDA     B_VECTNIL+1
         2 005252   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 005253   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005254   000001 235000 xsym               LDA     B_VECTNIL+1
         2 005255   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 005256   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005257   201345 756100                    STQ     LFPT_PRECORD+11,,AUTO
         2 005260   100102 633500                    EPPR3   66,,PR1
         2 005261   201344 453500                    STP3    LFPT_PRECORD+10,,AUTO
         2 005262   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 005263   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 005264   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 005265   000000 011000                    NOP     0

     1545    13620    5                       CH_XFORMAT.COMMENT# = '> Not Canceled <';

  13620  2 005266   040100 100400                    MLR     fill='040'O
         2 005267   000315 000020 1                  ADSC9   JOBSTATS_ACCT+16         cn=0,n=16
         2 005270   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     1546    13621    5                     END;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:242  

     1547    13622    4                 END;

     1548    13623
     1549    13624    3             CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13624  2 005271   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 005272   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 005273   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 005274   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005275   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 005276   000000 011000                    NOP     0

     1550    13625                                                              /* Save SYSID */
     1551    13626    3             CHKEYBUF = CP_C_CHKEYBUF ;

  13626  2 005277   000100 100400                    MLR     fill='000'O
         2 005300   000010 000011 1                  ADSC9   CP_C_CHKEYBUF            cn=0,n=9
         2 005301   200336 000011                    ADSC9   CHKEYBUF,,AUTO           cn=0,n=9

     1552    13627                                                              /* Setup key */
     1553    13628    3             CHKEYBUF.SYSID = CH_XFORMAT.BUF$ -> VLA$INPUT.SYSID ;

  13628  2 005302   200427 470500                    LDP0    CH_XFORMAT+13,,AUTO
         2 005303   000100 101500                    MRL     fill='000'O
         2 005304   000006 400002                    ADSC9   6,,PR0                   cn=2,n=2
         2 005305   200336 200004                    ADSC9   CHKEYBUF,,AUTO           cn=1,n=4

     1554    13629    3             CHKEYBUF.NUM = 0 ;

  13629  2 005306   000100 100400                    MLR     fill='000'O
         2 005307   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         2 005310   200337 200004                    ADSC9   CHKEYBUF+1,,AUTO         cn=1,n=4

     1555    13630    3             SYSIDBUF.ACCT = CH_XFORMAT.BUF$ -> VLA$INPUT.ACCT ;

  13630  2 005311   040100 100500                    MLR     fill='040'O
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:243  
         2 005312   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         2 005313   200347 000010                    ADSC9   SYSIDBUF+3,,AUTO         cn=0,n=8

     1556    13631    3             SYSIDBUF.JNAME = CH_XFORMAT.BUF$ -> VLA$INPUT.JNAME ;

  13631  2 005314   040100 100500                    MLR     fill='040'O
         2 005315   000021 000037                    ADSC9   17,,PR0                  cn=0,n=31
         2 005316   200351 000037                    ADSC9   SYSIDBUF+5,,AUTO         cn=0,n=31

     1557    13632    3             SYSIDBUF.COMMENT = CH_XFORMAT.COMMENT# ;

  13632  2 005317   040100 100500                    MLR     fill='040'O
         2 005320   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24
         2 005321   200360 600030                    ADSC9   SYSIDBUF+12,,AUTO        cn=3,n=24

     1558    13633                                                              /* Write out record. */
     1559    13634    3             CALL WRITE_USEFILE_REC ALTRET(E_WRITE_CHECK) ;

  13634  2 005322   007225 701000 2                  TSX1    WRITE_USEFILE_REC
         2 005323   005324 702000 2                  TSX2    E_WRITE_CHECK

     1560    13635    3   E_WRITE_CHECK:
     1561    13636
     1562    13637    3         END ; /* DO J */

  13637  2 005324   200145 054100       E_WRITE_CHE* AOS     J,,AUTO
         2 005325   200013 470500                    LDP0    STAT$,,AUTO
         2 005326   200145 236100                    LDQ     J,,AUTO
         2 005327   005104 604000 2                  TMI     s:13556
         2 005330   000000 116100                    CMPQ    0,,PR0
         2 005331   005104 602000 2                  TNC     s:13556

     1563    13638    2         RETURN ;

  13638  2 005332   201322 221300                    LDX1  ! ERRCODE+1,,AUTO
         2 005333   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:244  
     1564    13639
     1565    13640    2   END   DISP_SYSID_SRCH_IRQ ;
     1566    13641        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:245  
     1567    13642    1   DISP_SYSID_SRCH_OQ:    PROC ALTRET ;

  13642  2 005334   201322 741300       DISP_SYSID_* STX1  ! ERRCODE+1,,AUTO

     1568    13643
     1569    13644    2         CH_XFORMAT.MSG# = %CP_SYSID_OQ_MESS ;

  13644  2 005335   000012 235007                    LDA     10,DL
         2 005336   200412 755100                    STA     CH_XFORMAT,,AUTO

     1570    13645    2         CH_XFORMAT.NUM# = 0 ;

  13645  2 005337   200426 450100                    STZ     CH_XFORMAT+12,,AUTO

     1571    13646    3         DO J = 0 TO STAT$ -> VLR$OUTPUT.FOUND - 1 ;

  13646  2 005340   200145 450100                    STZ     J,,AUTO
         2 005341   005434 710000 2                  TRA     E_WRITE_CHECK+1

     1572    13647
     1573    13648    3             IF B$JIT.CPFLAGS1.BRK

  13648  2 005342   000000 470400 xsym               LDP0    B$JIT$
         2 005343   000143 236100                    LDQ     99,,PR0
         2 005344   000004 316007                    CANQ    4,DL
         2 005345   005350 600000 2                  TZE     s:13650

     1574    13649    3               THEN RETURN ;                             /* Forget the rest. */

  13649  2 005346   201322 221300                    LDX1  ! ERRCODE+1,,AUTO
         2 005347   000001 702211                    TSX2  ! 1,X1

     1575    13650    3             CH_XFORMAT.BUF$ = ADDR(STAT$ -> VLR$OUTPUT.F(J)) ;

  13650  2 005350   200145 236100                    LDQ     J,,AUTO
         2 005351   000034 402003                    MPY     28,DU
         2 005352   000002 036003                    ADLQ    2,DU
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:246  
         2 005353   200013 036100                    ADLQ    STAT$,,AUTO
         2 005354   200427 756100                    STQ     CH_XFORMAT+13,,AUTO

     1576    13651    3             IF CH_XFORMAT.BUF$ -> VLA$OUTPUT.NUM ~= CHKEYBUF.NUM

  13651  2 005355   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 005356   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 005357   000033 773000                    LRL     27
         2 005360   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 005361   200427 471500                    LDP1    CH_XFORMAT+13,,AUTO
         2 005362   100005 236100                    LDQ     5,,PR1
         2 005363   777777 376007                    ANQ     -1,DL
         2 005364   201344 116100                    CMPQ    LFPT_PRECORD+10,,AUTO
         2 005365   005407 600000 2                  TZE     s:13662

     1577    13652    3               THEN                               /* Not the correct stream number. */
     1578    13653    4                 DO ;                                    /* Get correct record. */

     1579    13654    4                   CHKEYBUF = CP_C_CHKEYBUF ;

  13654  2 005366   000100 100400                    MLR     fill='000'O
         2 005367   000010 000011 1                  ADSC9   CP_C_CHKEYBUF            cn=0,n=9
         2 005370   200336 000011                    ADSC9   CHKEYBUF,,AUTO           cn=0,n=9

     1580    13655    4                   CHKEYBUF.SYSID = CH_XFORMAT.BUF$ -> VLA$OUTPUT.SYSID ;

  13655  2 005371   000100 101500                    MRL     fill='000'O
         2 005372   100005 000002                    ADSC9   5,,PR1                   cn=0,n=2
         2 005373   200336 200004                    ADSC9   CHKEYBUF,,AUTO           cn=1,n=4

     1581    13656    4                   CHKEYBUF.NUM = CH_XFORMAT.BUF$ -> VLA$OUTPUT.NUM ;

  13656  2 005374   000100 101500                    MRL     fill='000'O
         2 005375   100005 400002                    ADSC9   5,,PR1                   cn=2,n=2
         2 005376   200337 200004                    ADSC9   CHKEYBUF+1,,AUTO         cn=1,n=4

     1582    13657    4                   IF WAITING OR NOTIFYING
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:247  

  13657  2 005377   200133 234100                    SZN     WAITING,,AUTO
         2 005400   005403 604000 2                  TMI     s:13659
         2 005401   200137 234100                    SZN     NOTIFYING,,AUTO
         2 005402   005407 605000 2                  TPL     s:13662

     1583    13658    4                     THEN
     1584    13659    4                       CALL READ_OUTPUT_RECORD(CHKEYBUF)

  13659  2 005403   200336 633500                    EPPR3   CHKEYBUF,,AUTO
         2 005404   201325 453500                    STP3    HDR_MSG#+1,,AUTO
         2 005405   007741 701000 2                  TSX1    READ_OUTPUT_RECORD
         2 005406   005443 702000 2                  TSX2    E_DISP_SYSID_SRCH_OQ

     1585    13660    4                                   ALTRET(E_DISP_SYSID_SRCH_OQ) ;
     1586    13661    4                 END ; /* THEN DO */

     1587    13662    3             OUTPUT_FLG = %YES# ;

  13662  2 005407   400000 236003                    LDQ     -131072,DU
         2 005410   200142 756100                    STQ     OUTPUT_FLG,,AUTO

     1588    13663    3             CALL COMPARE_STATUS ALTRET(OUTPUT_NO_CHANGE) ;

  13663  2 005411   007473 701000 2                  TSX1    COMPARE_STATUS
         2 005412   005421 702000 2                  TSX2    OUTPUT_NO_CHANGE

     1589    13664    3             IF SYSIDBUF.STATUS.CODE = %FS_NOTF#

  13664  2 005413   200344 235100                    LDA     SYSIDBUF,,AUTO
         2 005414   000005 115007                    CMPA    5,DL
         2 005415   005433 600000 2                  TZE     E_WRITE_CHECK

     1590    13665    3               THEN
     1591    13666    3                 GOTO E_WRITE_CHECK ;
     1592    13667
     1593    13668    3             SOMETHING_CHANGED = '1'B ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:248  

  13668  2 005416   400000 236003                    LDQ     -131072,DU
         2 005417   200135 756100                    STQ     SOMETHING_CHANGED,,AUTO

     1594    13669    4             DO WHILE('0'B) ;

  13669  2 005420   005427 710000 2                  TRA     s:13674

     1595    13670    4   OUTPUT_NO_CHANGE:
     1596    13671    4               IF (FORCE = %NO# AND WAITING) OR NOTIFYING

  13671  2 005421   200136 234100       OUTPUT_NO_C* SZN     FORCE,,AUTO
         2 005422   005425 604000 2                  TMI     OUTPUT_NO_CHANGE+4
         2 005423   200133 234100                    SZN     WAITING,,AUTO
         2 005424   005433 604000 2                  TMI     E_WRITE_CHECK
         2 005425   200137 234100                    SZN     NOTIFYING,,AUTO
         2 005426   005433 604000 2                  TMI     E_WRITE_CHECK

     1597    13672    4                 THEN GOTO E_WRITE_CHECK ;
     1598    13673    4             END ; /* DO WHILE */

     1599    13674    3             CALL READ_JOBSTATS_FILE ALTRET(E_DISP_SYSID_SRCH_OQ) ;

  13674  2 005427   006226 701000 2                  TSX1    READ_JOBSTATS_FILE
         2 005430   005443 702000 2                  TSX2    E_DISP_SYSID_SRCH_OQ

     1600    13675    3             CALL DISP_ONE_OUTPUT;

  13675  2 005431   005445 701000 2                  TSX1    DISP_ONE_OUTPUT
         2 005432   000000 011000                    NOP     0

     1601    13676    3   E_WRITE_CHECK:
     1602    13677
     1603    13678    3         END ; /* DO J */

  13678  2 005433   200145 054100       E_WRITE_CHE* AOS     J,,AUTO
         2 005434   200013 470500                    LDP0    STAT$,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:249  
         2 005435   200145 236100                    LDQ     J,,AUTO
         2 005436   005342 604000 2                  TMI     s:13648
         2 005437   000000 116100                    CMPQ    0,,PR0
         2 005440   005342 602000 2                  TNC     s:13648

     1604    13679    2         RETURN ;

  13679  2 005441   201322 221300                    LDX1  ! ERRCODE+1,,AUTO
         2 005442   000001 702211                    TSX2  ! 1,X1

     1605    13680
     1606    13681    2   E_DISP_SYSID_SRCH_OQ:
     1607    13682    2          ALTRETURN ;

  13682  2 005443   201322 221300       E_DISP_SYSI* LDX1  ! ERRCODE+1,,AUTO
         2 005444   000000 702211                    TSX2  ! 0,X1

     1608    13683
     1609    13684    2   END   DISP_SYSID_SRCH_OQ ;
     1610    13685        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:250  
     1611    13686    1   DISP_ONE_OUTPUT: PROC;

  13686  2 005445   201324 741300       DISP_ONE_OU* STX1  ! HDR_MSG#,,AUTO

     1612    13687
     1613    13688    2          CH_XFORMAT.STAT$ = ADDR(XSJ_JOBINFO) ;

  13688  2 005446   201135 630500                    EPPR0   XSJ_JOBINFO,,AUTO
         2 005447   200430 450500                    STP0    CH_XFORMAT+14,,AUTO

     1614    13689
     1615    13690    2          IF CMD_TYPE = %CANCEL_CMD#

  13690  2 005450   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 005451   000003 115007                    CMPA    3,DL
         2 005452   005520 601000 2                  TNZ     s:13705

     1616    13691    2            THEN
     1617    13692    3              DO;

     1618    13693    3                IF NOT FPT_JOBSTATS_CANCEL.V.OUTPUT#

  13693  2 005453   201123 234100                    SZN     FPT_JOBSTATS_CANCEL+27,,AUTO
         2 005454   005515 605000 2                  TPL     NO_CANCEL

     1619    13694    3                  THEN
     1620    13695    3                    GOTO NO_CANCEL;
     1621    13696    3                FPT_JOBSTATS_CANCEL.V.SYSID# = CH_XFORMAT.BUF$->VLA$OUTPUT.SYSID;

  13696  2 005455   200427 471500                    LDP1    CH_XFORMAT+13,,AUTO
         2 005456   100005 236100                    LDQ     5,,PR1
         2 005457   000022 772000                    QRL     18
         2 005460   201121 756100                    STQ     FPT_JOBSTATS_CANCEL+25,,AUTO

     1622    13697    3                FPT_JOBSTATS_CANCEL.V.NUM# = CH_XFORMAT.BUF$->VLA$OUTPUT.NUM;

  13697  2 005461   100005 720100                    LXL0    5,,PR1
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:251  
         2 005462   201124 740100                    STX0    FPT_JOBSTATS_CANCEL+28,,AUTO

     1623    13698    3                FPT_JOBSTATS_CANCEL.V.ORDER# = %CANCELF#;

  13698  2 005463   000010 235007                    LDA     8,DL
         2 005464   201120 755100                    STA     FPT_JOBSTATS_CANCEL+24,,AUTO

     1624    13699    3                CH_XFORMAT.COMMENT# = '> Canceled <';

  13699  2 005465   040100 100400                    MLR     fill='040'O
         2 005466   000307 000014 1                  ADSC9   JOBSTATS_ACCT+10         cn=0,n=12
         2 005467   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     1625    13700    4                CALL M$JOBSTATS(FPT_JOBSTATS_CANCEL) WHENALTRETURN DO;

  13700  2 005470   201070 630500                    EPPR0   FPT_JOBSTATS_CANCEL,,AUTO
         2 005471   570001 713400                    CLIMB   alt,+61441
         2 005472   405400 401760                    pmme    nvectors=12
         2 005473   005475 702000 2                  TSX2    s:13701
         2 005474   005520 710000 2                  TRA     s:13705

     1626    13701    4                    CALL CPC$WRITEMSGE(B$TCB$->B$TCB.ALT$->B$ALT.ERR,,,,,%YES#);

  13701  2 005475   000000 470400 xsym               LDP0    B$TCB$
         2 005476   000000 471500                    LDP1    0,,PR0
         2 005477   000050 236000 3                  LDQ     40
         2 005500   000001 235000 xsym               LDA     B_VECTNIL+1
         2 005501   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 005502   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005503   000001 235000 xsym               LDA     B_VECTNIL+1
         2 005504   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 005505   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 005506   201345 756100                    STQ     LFPT_PRECORD+11,,AUTO
         2 005507   100102 633500                    EPPR3   66,,PR1
         2 005510   201344 453500                    STP3    LFPT_PRECORD+10,,AUTO
         2 005511   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 005512   000024 631400 xsym               EPPR1   B_VECTNIL+20
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:252  
         2 005513   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 005514   000000 011000                    NOP     0

     1627    13702    4   NO_CANCEL:       CH_XFORMAT.COMMENT# = '> Not Canceled <';

  13702  2 005515   040100 100400       NO_CANCEL    MLR     fill='040'O
         2 005516   000315 000020 1                  ADSC9   JOBSTATS_ACCT+16         cn=0,n=16
         2 005517   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     1628    13703    4                  END;

     1629    13704    3              END;

     1630    13705    2          CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13705  2 005520   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 005521   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 005522   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 005523   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005524   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 005525   000000 011000                    NOP     0

     1631    13706                                                                        /* Save SYSID */
     1632    13707    2          CHKEYBUF = CP_C_CHKEYBUF ;

  13707  2 005526   000100 100400                    MLR     fill='000'O
         2 005527   000010 000011 1                  ADSC9   CP_C_CHKEYBUF            cn=0,n=9
         2 005530   200336 000011                    ADSC9   CHKEYBUF,,AUTO           cn=0,n=9

     1633    13708                                                                        /* Setup key */
     1634    13709    2          CHKEYBUF.SYSID = CH_XFORMAT.BUF$ -> VLA$OUTPUT.SYSID ;

  13709  2 005531   200427 470500                    LDP0    CH_XFORMAT+13,,AUTO
         2 005532   000100 101500                    MRL     fill='000'O
         2 005533   000005 000002                    ADSC9   5,,PR0                   cn=0,n=2
         2 005534   200336 200004                    ADSC9   CHKEYBUF,,AUTO           cn=1,n=4

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:253  
     1635    13710    2          CHKEYBUF.SYSID = CH_XFORMAT.BUF$ -> VLA$OUTPUT.SYSID ;

  13710  2 005535   000100 101500                    MRL     fill='000'O
         2 005536   000005 000002                    ADSC9   5,,PR0                   cn=0,n=2
         2 005537   200336 200004                    ADSC9   CHKEYBUF,,AUTO           cn=1,n=4

     1636    13711    2          CHKEYBUF.NUM = CH_XFORMAT.BUF$ -> VLA$OUTPUT.NUM ;

  13711  2 005540   000100 101500                    MRL     fill='000'O
         2 005541   000005 400002                    ADSC9   5,,PR0                   cn=2,n=2
         2 005542   200337 200004                    ADSC9   CHKEYBUF+1,,AUTO         cn=1,n=4

     1637    13712    2          SYSIDBUF.ACCT = CH_XFORMAT.BUF$ -> VLA$OUTPUT.ACCT ;

  13712  2 005543   040100 100500                    MLR     fill='040'O
         2 005544   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         2 005545   200347 000010                    ADSC9   SYSIDBUF+3,,AUTO         cn=0,n=8

     1638    13713    2          SYSIDBUF.JNAME = CH_XFORMAT.BUF$ -> VLA$OUTPUT.JNAME ;

  13713  2 005546   040100 100500                    MLR     fill='040'O
         2 005547   000013 000037                    ADSC9   11,,PR0                  cn=0,n=31
         2 005550   200351 000037                    ADSC9   SYSIDBUF+5,,AUTO         cn=0,n=31

     1639    13714    2          SYSIDBUF.COMMENT = CH_XFORMAT.COMMENT# ;

  13714  2 005551   040100 100500                    MLR     fill='040'O
         2 005552   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24
         2 005553   200360 600030                    ADSC9   SYSIDBUF+12,,AUTO        cn=3,n=24

     1640    13715                                                                 /* Write out record. */
     1641    13716    2          CALL WRITE_USEFILE_REC ALTRET(E_WRITE_CHECK) ;

  13716  2 005554   007225 701000 2                  TSX1    WRITE_USEFILE_REC
         2 005555   005556 702000 2                  TSX2    E_WRITE_CHECK

     1642    13717    2   E_WRITE_CHECK:
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:254  
     1643    13718    2          RETURN;

  13718  2 005556   201324 221300       E_WRITE_CHE* LDX1  ! HDR_MSG#,,AUTO
         2 005557   000001 702211                    TSX2  ! 1,X1

     1644    13719    2   END DISP_ONE_OUTPUT;
     1645    13720        %EJECT;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:255  
     1646    13721    1   DISP_SYSID_SUBFILE:    PROC ALTRET ;

  13721  2 005560   201320 741300       DISP_SYSID_* STX1  ! RETURN_FLG+3,,AUTO

     1647    13722
     1648    13723    2   DCL NOT_FND BIT(1);
     1649    13724
     1650    13725    2         FPT_JOBSTATS.V.ORDER# = %SRCH#;

  13725  2 005561   000002 235007                    LDA     2,DL
         2 005562   201010 755100                    STA     FPT_JOBSTATS+24,,AUTO

     1651    13726    2         FPT_JOBSTATS.V.OUTPUT# = %YES#;

  13726  2 005563   400000 236003                    LDQ     -131072,DU
         2 005564   201013 256100                    ORSQ    FPT_JOBSTATS+27,,AUTO

     1652    13727    2         CALL M$JOBSTATS(FPT_JOBSTATS) WHENALTRETURN

  13727  2 005565   200760 630500                    EPPR0   FPT_JOBSTATS,,AUTO
         2 005566   570001 713400                    CLIMB   alt,+61441
         2 005567   405400 401760                    pmme    nvectors=12
         2 005570   005572 702000 2                  TSX2    s:13729
         2 005571   005620 710000 2                  TRA     s:13739

     1653    13728    3                         DO;

     1654    13729    3                           IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOTFND

  13729  2 005572   000000 470400 xsym               LDP0    B$TCB$
         2 005573   000000 471500                    LDP1    0,,PR0
         2 005574   100102 236100                    LDQ     66,,PR1
         2 005575   377770 376007                    ANQ     131064,DL
         2 005576   021260 116007                    CMPQ    8880,DL
         2 005577   005616 600000 2                  TZE     s:13736

     1655    13730    3                             THEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:256  
     1656    13731    4                               DO;

     1657    13732    4                                 CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$

  13732  2 005600   000000 236000 xsym               LDQ     SEG2$
         2 005601   000003 036003                    ADLQ    3,DU
         2 005602   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 005603   100102 633500                    EPPR3   66,,PR1
         2 005604   201347 453500                    STP3    LFPT_PRECORD+13,,AUTO
         2 005605   000035 236000 3                  LDQ     29
         2 005606   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 005607   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 005610   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 005611   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 005612   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 005613   000000 701000 xent               TSX1    CXP$POSTERR
         2 005614   000000 011000                    NOP     0

     1658    13733    4                                                  ->B$ALT.ERR);
     1659    13734    4                                 GOTO E_DISP_SYSID_SUBFILE_ALT;

  13734  2 005615   005745 710000 2                  TRA     E_DISP_SYSID_SUBFILE_ALT

     1660    13735    4                               END;  /* Then Do */
     1661    13736    3                            STAT$ -> VLR$OUTPUT.FOUND = 0;

  13736  2 005616   200013 473500                    LDP3    STAT$,,AUTO
         2 005617   300000 450100                    STZ     0,,PR3

     1662    13737    3                         END;  /* Whenaltreturn Do */

     1663    13738
     1664    13739    2         K = 0;

  13739  2 005620   200146 450100                    STZ     K,,AUTO

     1665    13740    3   N_SRCH: DO WHILE '1'B; /* Search the nodes for subfile numbers */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:257  

  13740  2 005621                       N_SRCH       null
     1666    13741    4               DO WHILE '1'B;

     1667    13742    4                  IF CMD_CODE = %CH_NOOPTIONS

  13742  2 005621   200154 235100                    LDA     CMD_CODE,,AUTO
         2 005622   000027 115007                    CMPA    23,DL
         2 005623   005643 600000 2                  TZE     s:13754

     1668    13743    4                     THEN
     1669    13744    4                        EXIT; /* Only one subfile for CHECK_SYSIDS */
     1670    13745    4                  K = K + 1;

  13745  2 005624   200146 054100                    AOS     K,,AUTO

     1671    13746    4                  IF K >= P$->P$B.NSUBLKS

  13746  2 005625   200004 470500                    LDP0    P$,,AUTO
         2 005626   000001 236100                    LDQ     1,,PR0
         2 005627   000022 772000                    QRL     18
         2 005630   200146 116100                    CMPQ    K,,AUTO
         2 005631   005743 604400 2                  TMOZ    s:13790

     1672    13747    4                     THEN
     1673    13748    4                        EXIT N_SRCH;
     1674    13749    4                  FPT_JOBSTATS.V.NUM# = P$->P$B.SUBLK$(K)->P$B.CPOS;

  13749  2 005632   200146 720100                    LXL0    K,,AUTO
         2 005633   000003 471510                    LDP1    3,X0,PR0
         2 005634   100002 721100                    LXL1    2,,PR1
         2 005635   201014 741100                    STX1    FPT_JOBSTATS+28,,AUTO

     1675    13750    4                  IF P$->P$B.SUBLK$(K)->P$B.CODE = %CH_SYSID_NUM

  13750  2 005636   000003 471510                    LDP1    3,X0,PR0
         2 005637   100000 722100                    LXL2    0,,PR1
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:258  
         2 005640   000773 102003                    CMPX2   507,DU
         2 005641   005643 600000 2                  TZE     s:13754

     1676    13751    4                     THEN
     1677    13752    4                        EXIT;
     1678    13753    4               END;

  13753  2 005642   005621 710000 2                  TRA     N_SRCH

     1679    13754    3         CH_XFORMAT.MSG# = %CP_SYSID_OQ_MESS ;

  13754  2 005643   000012 236007                    LDQ     10,DL
         2 005644   200412 756100                    STQ     CH_XFORMAT,,AUTO

     1680    13755    3         CH_XFORMAT.NUM# = FPT_JOBSTATS.V.NUM#;

  13755  2 005645   201014 235100                    LDA     FPT_JOBSTATS+28,,AUTO
         2 005646   000022 771000                    ARL     18
         2 005647   200426 755100                    STA     CH_XFORMAT+12,,AUTO

     1681    13756    3         NOT_FND = %YES#;

  13756  2 005650   400000 236003                    LDQ     -131072,DU
         2 005651   201321 756100                    STQ     NOT_FND,,AUTO

     1682    13757    4         DO J = 0 TO STAT$ -> VLR$OUTPUT.FOUND - 1 ;

  13757  2 005652   200145 450100                    STZ     J,,AUTO
         2 005653   005701 710000 2                  TRA     s:13770+1

     1683    13758
     1684    13759    4             IF B$JIT.CPFLAGS1.BRK

  13759  2 005654   000000 470400 xsym               LDP0    B$JIT$
         2 005655   000143 236100                    LDQ     99,,PR0
         2 005656   000004 316007                    CANQ    4,DL
         2 005657   005662 600000 2                  TZE     s:13762
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:259  

     1685    13760    4               THEN                                      /* Forget the rest. */
     1686    13761    4                 RETURN;

  13761  2 005660   201320 221300                    LDX1  ! RETURN_FLG+3,,AUTO
         2 005661   000001 702211                    TSX2  ! 1,X1

     1687    13762    4             CH_XFORMAT.BUF$ = ADDR(STAT$ -> VLR$OUTPUT.F(J)) ;

  13762  2 005662   200145 236100                    LDQ     J,,AUTO
         2 005663   000034 402003                    MPY     28,DU
         2 005664   000002 036003                    ADLQ    2,DU
         2 005665   200013 036100                    ADLQ    STAT$,,AUTO
         2 005666   200427 756100                    STQ     CH_XFORMAT+13,,AUTO

     1688    13763    4             IF CH_XFORMAT.BUF$ -> VLA$OUTPUT.NUM = FPT_JOBSTATS.V.NUM#

  13763  2 005667   200427 471500                    LDP1    CH_XFORMAT+13,,AUTO
         2 005670   100005 720100                    LXL0    5,,PR1
         2 005671   201014 100100                    CMPX0   FPT_JOBSTATS+28,,AUTO
         2 005672   005700 601000 2                  TNZ     s:13770

     1689    13764    4               THEN                               /* Got the correct stream number. */
     1690    13765    5                 DO ;

     1691    13766    5                   NOT_FND = %NO#;

  13766  2 005673   201321 450100                    STZ     NOT_FND,,AUTO

     1692    13767    5                   CALL READ_JOBSTATS_FILE ALTRET(E_DISP_SYSID_SUBFILE_NOTF);

  13767  2 005674   006226 701000 2                  TSX1    READ_JOBSTATS_FILE
         2 005675   005710 702000 2                  TSX2    E_DISP_SYSID_SUBFILE_NOTF

     1693    13768    5                   CALL DISP_ONE_OUTPUT ;

  13768  2 005676   005445 701000 2                  TSX1    DISP_ONE_OUTPUT
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:260  
         2 005677   000000 011000                    NOP     0

     1694    13769    5                 END;  /* Then Do */

     1695    13770    4         END ; /* DO J */

  13770  2 005700   200145 054100                    AOS     J,,AUTO
         2 005701   200013 470500                    LDP0    STAT$,,AUTO
         2 005702   200145 236100                    LDQ     J,,AUTO
         2 005703   005654 604000 2                  TMI     s:13759
         2 005704   000000 116100                    CMPQ    0,,PR0
         2 005705   005654 602000 2                  TNC     s:13759

     1696    13771    3         IF NOT_FND

  13771  2 005706   201321 234100                    SZN     NOT_FND,,AUTO
         2 005707   005737 605000 2                  TPL     s:13785

     1697    13772    3           THEN
     1698    13773    4             DO;

     1699    13774
     1700    13775    4   E_DISP_SYSID_SUBFILE_NOTF:
     1701    13776    4               CH_XFORMAT.MSG# = %CP_NOTF_MESS;

  13776  2 005710   000013 235007       E_DISP_SYSI* LDA     11,DL
         2 005711   200412 755100                    STA     CH_XFORMAT,,AUTO

     1702    13777    4               CH_XFORMAT.SYSID# = SYSID_CRITERIA.SYSID#;

  13777  2 005712   201234 236100                    LDQ     SYSID_CRITERIA+6,,AUTO
         2 005713   200413 756100                    STQ     CH_XFORMAT+1,,AUTO

     1703    13778    4               CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME#;

  13778  2 005714   040100 100500                    MLR     fill='040'O
         2 005715   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:261  
         2 005716   200416 000037                    ADSC9   CH_XFORMAT+4,,AUTO       cn=0,n=31

     1704    13779    4               CH_XFORMAT.NUM# = FPT_JOBSTATS.V.NUM#;

  13779  2 005717   201014 235100                    LDA     FPT_JOBSTATS+28,,AUTO
         2 005720   000022 771000                    ARL     18
         2 005721   200426 755100                    STA     CH_XFORMAT+12,,AUTO

     1705    13780    4               CH_XFORMAT.ACCT# = FID_ACCT.ACCT#;

  13780  2 005722   201200 237100                    LDAQ    FID_ACCT,,AUTO
         2 005723   200414 757100                    STAQ    CH_XFORMAT+2,,AUTO

     1706    13781    4               CALL CPK$CHECK_OUTPUT(CH_XFORMAT);

  13781  2 005724   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 005725   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 005726   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 005727   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005730   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 005731   000000 011000                    NOP     0

     1707    13782    4               CHKEYBUF.NUM = CH_XFORMAT.NUM#;

  13782  2 005732   000100 100500                    MLR     fill='000'O
         2 005733   200426 000004                    ADSC9   CH_XFORMAT+12,,AUTO      cn=0,n=4
         2 005734   200337 200004                    ADSC9   CHKEYBUF+1,,AUTO         cn=1,n=4

     1708    13783    4               CALL DELETE_USEFILE_REC;

  13783  2 005735   007176 701000 2                  TSX1    DELETE_USEFILE_REC
         2 005736   000000 011000                    NOP     0

     1709    13784    4             END;  /* Then Do */

     1710    13785    3               IF CMD_CODE = %CH_NOOPTIONS

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:262  
  13785  2 005737   200154 235100                    LDA     CMD_CODE,,AUTO
         2 005740   000027 115007                    CMPA    23,DL
         2 005741   005743 600000 2                  TZE     s:13790

     1711    13786    3                  THEN
     1712    13787    3                     EXIT;
     1713    13788    3            END;

  13788  2 005742   005621 710000 2                  TRA     N_SRCH

     1714    13789
     1715    13790    2         RETURN ;

  13790  2 005743   201320 221300                    LDX1  ! RETURN_FLG+3,,AUTO
         2 005744   000001 702211                    TSX2  ! 1,X1

     1716    13791
     1717    13792    2   E_DISP_SYSID_SUBFILE_ALT:
     1718    13793    2         ALTRETURN;

  13793  2 005745   201320 221300       E_DISP_SYSI* LDX1  ! RETURN_FLG+3,,AUTO
         2 005746   000000 702211                    TSX2  ! 0,X1

     1719    13794
     1720    13795    2   END   DISP_SYSID_SUBFILE;
     1721    13796        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:263  
     1722    13797    1   CHECK_SYSIDS: PROC ALTRET ;

  13797  2 005747   201314 741300       CHECK_SYSIDS STX1  ! VLR_JOBSTATS_CHECK+26,,AUTO

     1723    13798    2   DCL RETURN_FLG BIT(1) ;
     1724    13799
     1725    13800    2         RETURN_FLG = %YES# ;

  13800  2 005750   400000 236003                    LDQ     -131072,DU
         2 005751   201315 756100                    STQ     RETURN_FLG,,AUTO

     1726    13801    2         IF NOT USEFID_OPEN#

  13801  2 005752   200121 234100                    SZN     USEFID_OPEN#,,AUTO
         2 005753   005760 604000 2                  TMI     s:13806

     1727    13802    2             THEN CALL OPEN_USEFILE WHENALTRETURN

  13802  2 005754   007323 701000 2                  TSX1    OPEN_USEFILE
         2 005755   005757 702000 2                  TSX2    s:13804
         2 005756   005760 710000 2                  TRA     s:13806

     1728    13803    3                                     DO ;

     1729    13804    3                                       RETURN_FLG = %NO# ;

  13804  2 005757   201315 450100                    STZ     RETURN_FLG,,AUTO

     1730    13805    3                                     END ; /* Whenaltreturn */

     1731    13806    2         IF RETURN_FLG

  13806  2 005760   201315 234100                    SZN     RETURN_FLG,,AUTO
         2 005761   006007 605000 2                  TPL     s:13814

     1732    13807    2             THEN
     1733    13808    3               CALL M$PFIL (FPT_PFIL) WHENALTRETURN DO ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:264  

  13808  2 005762   200742 630500                    EPPR0   FPT_PFIL,,AUTO
         2 005763   440004 713400                    CLIMB   alt,+16388
         2 005764   400000 401760                    pmme    nvectors=1
         2 005765   005767 702000 2                  TSX2    s:13809
         2 005766   006007 710000 2                  TRA     s:13814

     1734    13809    3                   CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511, B$TCB$ ->

  13809  2 005767   000000 470400 xsym               LDP0    B$TCB$
         2 005770   000000 471500                    LDP1    0,,PR0
         2 005771   000000 236000 xsym               LDQ     SEG2$
         2 005772   000003 036003                    ADLQ    3,DU
         2 005773   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 005774   100102 633500                    EPPR3   66,,PR1
         2 005775   201347 453500                    STP3    LFPT_PRECORD+13,,AUTO
         2 005776   000035 236000 3                  LDQ     29
         2 005777   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 006000   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 006001   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 006002   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 006003   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 006004   000000 701000 xent               TSX1    CXP$POSTERR
         2 006005   000000 011000                    NOP     0

     1735    13810    3                       B$TCB.ALT$ -> B$ALT.ERR) ;
     1736    13811    3                   RETURN_FLG = %NO# ;

  13811  2 006006   201315 450100                    STZ     RETURN_FLG,,AUTO

     1737    13812    3                   END ; /*  Whenaltreturn */

     1738    13813                                                        /* Set up FPT_READ_USE. */
     1739    13814    2           FPT_READ_USE = CFPT_READ ;

  13814  2 006007   000100 100400                    MLR     fill='000'O
         2 006010   000000 000070 xsym               ADSC9   CFPT_READ                cn=0,n=56
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:265  
         2 006011   200636 000070                    ADSC9   FPT_READ_USE,,AUTO       cn=0,n=56

     1740    13815    2           FPT_READ_USE.V_ = VECTOR(FPT_READ_USE.V) ;

  13815  2 006012   000004 235000 3                  LDA     4
         2 006013   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006014   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006015   000646 036003                    ADLQ    422,DU
         2 006016   200636 757100                    STAQ    FPT_READ_USE,,AUTO

     1741    13816    2           FPT_READ_USE.BUF_ = VECTOR(SYSIDBUF) ;

  13816  2 006017   000037 235000 3                  LDA     31
         2 006020   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006021   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006022   000344 036003                    ADLQ    228,DU
         2 006023   200642 757100                    STAQ    FPT_READ_USE+4,,AUTO

     1742    13817    2           FPT_READ_USE.V.KEYS# = %NO# ;

  13817  2 006024   000033 236000 3                  LDQ     27
         2 006025   200646 356100                    ANSQ    FPT_READ_USE+8,,AUTO

     1743    13818    2           FPT_READ_USE.V.KEYR# = %YES# ;

  13818  2 006026   100000 236007                    LDQ     32768,DL
         2 006027   200646 256100                    ORSQ    FPT_READ_USE+8,,AUTO

     1744    13819    2           FPT_READ_USE.V.DCB# = M$IBEX_NUM ;

  13819  2 006030   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 006031   200646 740100                    STX0    FPT_READ_USE+8,,AUTO

     1745    13820    2           CMD_CODE = %CH_NOOPTIONS ;

  13820  2 006032   000027 235007                    LDA     23,DL
         2 006033   200154 755100                    STA     CMD_CODE,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:266  

     1746    13821    2           NRECS_READ = 0 ;

  13821  2 006034   200155 450100                    STZ     NRECS_READ,,AUTO

     1747    13822    2           NRECS_SKIP = 0 ;

  13822  2 006035   200156 450100                    STZ     NRECS_SKIP,,AUTO

     1748    13823    2           NRECS_DEL = 0 ;

  13823  2 006036   200157 450100                    STZ     NRECS_DEL,,AUTO

     1749    13824    2           TEMP = 0 ;

  13824  2 006037   200147 450100                    STZ     TEMP,,AUTO

     1750    13825    2           TEMP2 = 0 ;

  13825  2 006040   200150 450100                    STZ     TEMP2,,AUTO

     1751    13826
     1752    13827    2           IF RETURN_FLG

  13827  2 006041   201315 234100                    SZN     RETURN_FLG,,AUTO
         2 006042   006127 605000 2                  TPL     s:13863

     1753    13828    2             THEN
     1754    13829    3   LOOP:    DO WHILE ('1'B) ;

  13829  2 006043                       LOOP         null
     1755    13830    3             FPT_READ_USE.KEY_ = VECTOR(CHKEYBUF) ;

  13830  2 006043   000006 235000 3                  LDA     6
         2 006044   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006045   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006046   000336 036003                    ADLQ    222,DU
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:267  
         2 006047   200640 757100                    STAQ    FPT_READ_USE+2,,AUTO

     1756    13831    3             CALL M$READ(FPT_READ_USE) WHENRETURN

  13831  2 006050   200636 630500                    EPPR0   FPT_READ_USE,,AUTO
         2 006051   440000 713400                    CLIMB   alt,read
         2 006052   401400 401760                    pmme    nvectors=4
         2 006053   006077 702000 2                  TSX2    s:13848

     1757    13832    4                 DO ;

     1758    13833    4                   NRECS_READ = NRECS_READ + 1 ;

  13833  2 006054   200155 054100                    AOS     NRECS_READ,,AUTO

     1759    13834    4                   IF TEMP ~= CHKEYBUF.SYSID OR TEMP2 > 0

  13834  2 006055   200336 235100                    LDA     CHKEYBUF,,AUTO
         2 006056   200337 236100                    LDQ     CHKEYBUF+1,,AUTO
         2 006057   000033 773000                    LRL     27
         2 006060   200147 116100                    CMPQ    TEMP,,AUTO
         2 006061   006064 601000 2                  TNZ     s:13837
         2 006062   200150 235100                    LDA     TEMP2,,AUTO
         2 006063   006076 600000 2                  TZE     s:13845

     1760    13835    4                     THEN                      /* This is a new Job number. */
     1761    13836    5                       DO ;

     1762    13837    5                         TEMP = CHKEYBUF.SYSID ;

  13837  2 006064   200147 756100                    STQ     TEMP,,AUTO

     1763    13838    5                         TEMP2 = CHKEYBUF.NUM ;

  13838  2 006065   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 006066   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 006067   000033 773000                    LRL     27
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:268  
         2 006070   200150 756100                    STQ     TEMP2,,AUTO

     1764    13839    5                         CALL SETUP_SYSID_SRCH WHENALTRETURN

  13839  2 006071   002264 701000 2                  TSX1    SETUP_SYSID_SRCH
         2 006072   006074 702000 2                  TSX2    s:13841
         2 006073   006076 710000 2                  TRA     s:13845

     1765    13840    6                                     DO ;

     1766    13841    6                                       RETURN_FLG = %NO# ;

  13841  2 006074   201315 450100                    STZ     RETURN_FLG,,AUTO

     1767    13842    6                                       EXIT LOOP ;

  13842  2 006075   006127 710000 2                  TRA     s:13863

     1768    13843    6                                     END ; /* Whenaltreturn */
     1769    13844    5                       END ; /* Then Do */

     1770    13845    4                 END ; /* Whenreturn Do */

  13845  2 006076   006122 710000 2                  TRA     s:13858

     1771    13846    3             WHENALTRETURN
     1772    13847    4                         DO ;

     1773    13848    4                           IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE =

  13848  2 006077   000000 470400 xsym               LDP0    B$TCB$
         2 006100   000000 471500                    LDP1    0,,PR0
         2 006101   100102 236100                    LDQ     66,,PR1
         2 006102   377770 376007                    ANQ     131064,DL
         2 006103   006450 116007                    CMPQ    3368,DL
         2 006104   006121 601000 2                  TNZ     s:13856

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:269  
     1774    13849    4                               %E$BADVECT1
     1775    13850    4                             THEN
     1776    13851    5                               DO ;

     1777    13852    5                                 CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF), 511,

  13852  2 006105   000000 236000 xsym               LDQ     SEG2$
         2 006106   000003 036003                    ADLQ    3,DU
         2 006107   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 006110   000040 237000 3                  LDAQ    32
         2 006111   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 006112   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 006113   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 006114   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 006115   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 006116   000000 701000 xent               TSX1    CXP$POSTERR
         2 006117   000000 011000                    NOP     0

     1778    13853    5                                         E_CHKBADUSEF) ;
     1779    13854    5                                 RETURN_FLG = %NO# ;

  13854  2 006120   201315 450100                    STZ     RETURN_FLG,,AUTO

     1780    13855    5                               END ; /* Then Do */

     1781    13856    4                           EXIT LOOP ;

  13856  2 006121   006127 710000 2                  TRA     s:13863

     1782    13857    4                         END ; /* Whenaltreturn */
     1783    13858    3             IF B$JIT.CPFLAGS1.BRK

  13858  2 006122   000000 470400 xsym               LDP0    B$JIT$
         2 006123   000143 236100                    LDQ     99,,PR0
         2 006124   000004 316007                    CANQ    4,DL
         2 006125   006127 601000 2                  TNZ     s:13863

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:270  
     1784    13859    3               THEN
     1785    13860    3                 EXIT LOOP ;
     1786    13861    3           END ; /* DO WHILE */

  13861  2 006126   006043 710000 2                  TRA     LOOP

     1787    13862
     1788    13863    2         IF NRECS_READ - (NRECS_DEL + NRECS_SKIP) > 0 AND RETURN_FLG

  13863  2 006127   200157 236100                    LDQ     NRECS_DEL,,AUTO
         2 006130   200156 036100                    ADLQ    NRECS_SKIP,,AUTO
         2 006131   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 006132   200155 236100                    LDQ     NRECS_READ,,AUTO
         2 006133   201344 136100                    SBLQ    LFPT_PRECORD+10,,AUTO
         2 006134   006141 604400 2                  TMOZ    s:13866
         2 006135   201315 234100                    SZN     RETURN_FLG,,AUTO
         2 006136   006141 605000 2                  TPL     s:13866

     1789    13864    2             THEN RETURN ;

  13864  2 006137   201314 221300                    LDX1  ! VLR_JOBSTATS_CHECK+26,,AUTO
         2 006140   000001 702211                    TSX2  ! 1,X1

     1790    13865
     1791    13866    2         ALTRETURN ;

  13866  2 006141   201314 221300                    LDX1  ! VLR_JOBSTATS_CHECK+26,,AUTO
         2 006142   000000 702211                    TSX2  ! 0,X1

     1792    13867
     1793    13868        /*E*       ERROR:   CPK-E$CHKBADUSEF-C
     1794    13869                   MESSAGE: Not a CHECK/NOTIFY USE file.
     1795    13870                   MESSAGE1: The key returned was not a CHECK/NOTIFY key type.
     1796    13871                             CHECK/NOTIFY can not use this file.
     1797    13872                   DESCRIPTION: CHECK/NOTIFY tried to access a USE file that was not
     1798    13873                                built by CHECK/NOTIFY.
     1799    13874        */
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:271  
     1800    13875
     1801    13876    2   END   CHECK_SYSIDS ;
     1802    13877        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:272  
     1803    13878    1   OPEN_JOBSTATS_FILE:   PROC  ALTRET ;

  13878  2 006143   201326 741300       OPEN_JOBSTA* STX1  ! @CHKEYBUF+1,,AUTO

     1804    13879
     1805    13880        %VLP_SN (FPTN=FID_SN,STCLASS=AUTO) ;
     1806    13893
     1807    13894    2         FID_SN.NUM# = 1 ;

  13894  2 006144   000001 235007                    LDA     1,DL
         2 006145   201330 755100                    STA     FID_SN,,AUTO

     1808    13895    2         FID_SN.SN#(0) = ' ' ;

  13895  2 006146   040100 100400                    MLR     fill='040'O
         2 006147   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006150   201331 000006                    ADSC9   FID_SN+1,,AUTO           cn=0,n=6

     1809    13896    2         FPT_OPEN = CFPT_OPEN ;

  13896  2 006151   000100 100400                    MLR     fill='000'O
         2 006152   000000 000350 xsym               ADSC9   CFPT_OPEN                cn=0,n=232
         2 006153   200452 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

     1810    13897    2         FPT_OPEN.V_ = VECTOR(FPT_OPEN.V) ;

  13897  2 006154   000002 235000 3                  LDA     2
         2 006155   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006156   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006157   000516 036003                    ADLQ    334,DU
         2 006160   200452 757100                    STAQ    FPT_OPEN,,AUTO

     1811    13898    2         FPT_OPEN.V.DCB# = M$IBEX1_NUM ;

  13898  2 006161   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 006162   200516 740100                    STX0    FPT_OPEN+36,,AUTO

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:273  
     1812    13899    2         FPT_OPEN.V.FUN# = %IN# ;

  13899  2 006163   002000 236007                    LDQ     1024,DL
         2 006164   200517 552110                    STBQ    FPT_OPEN+37,'10'O,AUTO

     1813    13900    2         FPT_OPEN.V.SHARE# = %ALL# ;

  13900  2 006165   200516 236100                    LDQ     FPT_OPEN+36,,AUTO
         2 006166   000003 376000 3                  ANQ     3
         2 006167   000010 276007                    ORQ     8,DL
         2 006170   200516 756100                    STQ     FPT_OPEN+36,,AUTO

     1814    13901                                                              /* Close DCB. */
     1815    13902    2         FPT_CLOSE.V.DCB# = M$IBEX1_NUM ;

  13902  2 006171   200724 740100                    STX0    FPT_CLOSE+26,,AUTO

     1816    13903    2         CALL M$CLOSE (FPT_CLOSE) ;

  13903  2 006172   200672 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 006173   050001 713400                    CLIMB   close
         2 006174   406000 401760                    pmme    nvectors=13

     1817    13904    2         JOBSTATS_OPEN# = %YES# ;

  13904  2 006175   400000 236003                    LDQ     -131072,DU
         2 006176   200120 756100                    STQ     JOBSTATS_OPEN#,,AUTO

     1818    13905    2         FPT_OPEN = CFPT_OPEN_JOBINFO ;

  13905  2 006177   000100 100400                    MLR     fill='000'O
         2 006200   000164 000350 1                  ADSC9   CFPT_OPEN_JOBINFO        cn=0,n=232
         2 006201   200452 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

     1819    13906    2         FPT_OPEN.V_ = VECTOR(FPT_OPEN.V) ;

  13906  2 006202   000002 235000 3                  LDA     2
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:274  
         2 006203   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006204   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006205   000516 036003                    ADLQ    334,DU
         2 006206   200452 757100                    STAQ    FPT_OPEN,,AUTO

     1820    13907    2         FPT_OPEN.V.DCB# = M$IBEX1_NUM ;

  13907  2 006207   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 006210   200516 740100                    STX0    FPT_OPEN+36,,AUTO

     1821    13908    2         FPT_OPEN.SN_ = VECTOR(FID_SN) ;

  13908  2 006211   000001 235000 3                  LDA     1
         2 006212   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006213   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006214   001330 036003                    ADLQ    728,DU
         2 006215   200454 757100                    STAQ    FPT_OPEN+2,,AUTO

     1822    13909    2         CALL M$OPEN (FPT_OPEN) ALTRET (E_OPEN_JOBSTATS_FILE) ;

  13909  2 006216   200452 630500                    EPPR0   FPT_OPEN,,AUTO
         2 006217   450000 713400                    CLIMB   alt,open
         2 006220   410400 401760                    pmme    nvectors=18
         2 006221   006224 702000 2                  TSX2    E_OPEN_JOBSTATS_FILE

     1823    13910
     1824    13911    2         RETURN ;

  13911  2 006222   201326 221300                    LDX1  ! @CHKEYBUF+1,,AUTO
         2 006223   000001 702211                    TSX2  ! 1,X1

     1825    13912
     1826    13913    2   E_OPEN_JOBSTATS_FILE:
     1827    13914    2         ALTRETURN ;

  13914  2 006224   201326 221300       E_OPEN_JOBS* LDX1  ! @CHKEYBUF+1,,AUTO
         2 006225   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:275  

     1828    13915
     1829    13916    2   END   OPEN_JOBSTATS_FILE ;
     1830    13917        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:276  
     1831    13918    1   READ_JOBSTATS_FILE: PROC ALTRET ;

  13918  2 006226   201324 741300       READ_JOBSTA* STX1  ! HDR_MSG#,,AUTO

     1832    13919
     1833    13920    2         IF (JOBSTATS_OPEN# = %NO#)

  13920  2 006227   200120 234100                    SZN     JOBSTATS_OPEN#,,AUTO
         2 006230   006233 604000 2                  TMI     s:13924

     1834    13921    2             THEN
     1835    13922    2               CALL OPEN_JOBSTATS_FILE ALTRET(E_JOBSTATS) ;

  13922  2 006231   006143 701000 2                  TSX1    OPEN_JOBSTATS_FILE
         2 006232   006373 702000 2                  TSX2    E_JOBSTATS

     1836    13923                                                              /* Read :JOBSTATS */
     1837    13924    2           IF CMD_CODE = %CH_JOBNAME

  13924  2 006233   200154 235100                    LDA     CMD_CODE,,AUTO
         2 006234   000001 115007                    CMPA    1,DL
         2 006235   006240 601000 2                  TNZ     s:13927

     1838    13925    2             THEN
     1839    13926    2               CALL GET_JOBNAME_SYSID_REC ;

  13926  2 006236   006607 701000 2                  TSX1    GET_JOBNAME_SYSID_REC
         2 006237   000000 011000                    NOP     0

     1840    13927    2           XSJ_INFOKEY = CXSJ_INFOKEY ;

  13927  2 006240   000143 236000 1                  LDQ     CXSJ_INFOKEY
         2 006241   000051 376000 3                  ANQ     41
         2 006242   201134 756100                    STQ     XSJ_INFOKEY,,AUTO

     1841    13928    2           XSJ_INFOKEY.SYSID# = TEMP ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:277  
  13928  2 006243   200147 236100                    LDQ     TEMP,,AUTO
         2 006244   000011 736000                    QLS     9
         2 006245   201134 552130                    STBQ    XSJ_INFOKEY,'30'O,AUTO

     1842    13929    2           FPT_READ_JOBINFO.BUF_ = VECTOR(XSJ_JOBINFO) ;

  13929  2 006246   000052 235000 3                  LDA     42
         2 006247   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006250   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006251   001135 036003                    ADLQ    605,DU
         2 006252   200660 757100                    STAQ    FPT_READ_JOBINFO+4,,AUTO

     1843    13930    2           FPT_READ_JOBINFO.KEY_ = VECTOR(XSJ_INFOKEY) ;

  13930  2 006253   777640 235007                    LDA     -96,DL
         2 006254   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006255   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006256   001134 036003                    ADLQ    604,DU
         2 006257   200656 757100                    STAQ    FPT_READ_JOBINFO+2,,AUTO

     1844    13931    2           CALL M$READ (FPT_READ_JOBINFO) ALTRET(E_JOBSTATS) ;

  13931  2 006260   200654 630500                    EPPR0   FPT_READ_JOBINFO,,AUTO
         2 006261   440000 713400                    CLIMB   alt,read
         2 006262   401400 401760                    pmme    nvectors=4
         2 006263   006373 702000 2                  TSX2    E_JOBSTATS

     1845    13932
     1846    13933    2         IF JOB_COMPLETED

  13933  2 006264   200143 234100                    SZN     JOB_COMPLETED,,AUTO
         2 006265   006371 605000 2                  TPL     s:13972

     1847    13934    2             THEN
     1848    13935    3               DO ;

     1849    13936    3                 CH_XFORMAT.MSG# = %CP_FINAL_STAT_MESS ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:278  

  13936  2 006266   000017 235007                    LDA     15,DL
         2 006267   200412 755100                    STA     CH_XFORMAT,,AUTO

     1850    13937    3                 CH_XFORMAT.BUF$ = ADDR(XSJ_JOBINFO) ;

  13937  2 006270   201135 630500                    EPPR0   XSJ_JOBINFO,,AUTO
         2 006271   200427 450500                    STP0    CH_XFORMAT+13,,AUTO

     1851    13938    3                 IF (CMD_CODE = %CH_NOOPTIONS)

  13938  2 006272   200154 236100                    LDQ     CMD_CODE,,AUTO
         2 006273   000027 116007                    CMPQ    23,DL
         2 006274   006317 601000 2                  TNZ     s:13949

     1852    13939    3                   THEN
     1853    13940    4                     DO ;

     1854    13941    4                       CH_XFORMAT.SYSID# = CHKEYBUF.SYSID ;

  13941  2 006275   200336 235100                    LDA     CHKEYBUF,,AUTO
         2 006276   200337 236100                    LDQ     CHKEYBUF+1,,AUTO
         2 006277   000033 773000                    LRL     27
         2 006300   200413 756100                    STQ     CH_XFORMAT+1,,AUTO

     1855    13942    4                       CH_XFORMAT.ACCT# = SYSIDBUF.ACCT ;

  13942  2 006301   040100 100500                    MLR     fill='040'O
         2 006302   200347 000010                    ADSC9   SYSIDBUF+3,,AUTO         cn=0,n=8
         2 006303   200414 000010                    ADSC9   CH_XFORMAT+2,,AUTO       cn=0,n=8

     1856    13943    4                       CH_XFORMAT.JOBNAME# = SYSIDBUF.JNAME ;

  13943  2 006304   040100 100500                    MLR     fill='040'O
         2 006305   200351 000037                    ADSC9   SYSIDBUF+5,,AUTO         cn=0,n=31
         2 006306   200416 000037                    ADSC9   CH_XFORMAT+4,,AUTO       cn=0,n=31

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:279  
     1857    13944    4                       CH_XFORMAT.COMMENT# = SYSIDBUF.COMMENT ;

  13944  2 006307   040100 100500                    MLR     fill='040'O
         2 006310   200360 600030                    ADSC9   SYSIDBUF+12,,AUTO        cn=3,n=24
         2 006311   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     1858    13945    4                       CH_XFORMAT.NUM# = CHKEYBUF.NUM ;

  13945  2 006312   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 006313   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 006314   000033 773000                    LRL     27
         2 006315   200426 756100                    STQ     CH_XFORMAT+12,,AUTO

     1859    13946    4                     END ; /* THEN DO */

  13946  2 006316   006330 710000 2                  TRA     s:13954

     1860    13947    3                   ELSE
     1861    13948    4                     DO ;

     1862    13949    4                       CH_XFORMAT.SYSID# = TEMP ;

  13949  2 006317   200147 235100                    LDA     TEMP,,AUTO
         2 006320   200413 755100                    STA     CH_XFORMAT+1,,AUTO

     1863    13950    4                       CH_XFORMAT.ACCT# = XSJ_JOBINFO.ACCT# ;

  13950  2 006321   201140 237100                    LDAQ    XSJ_JOBINFO+3,,AUTO
         2 006322   200414 757100                    STAQ    CH_XFORMAT+2,,AUTO

     1864    13951    4                       CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME# ;

  13951  2 006323   040100 100500                    MLR     fill='040'O
         2 006324   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31
         2 006325   200416 000037                    ADSC9   CH_XFORMAT+4,,AUTO       cn=0,n=31

     1865    13952    4                       CH_XFORMAT.NUM# = 1 ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:280  

  13952  2 006326   000001 235007                    LDA     1,DL
         2 006327   200426 755100                    STA     CH_XFORMAT+12,,AUTO

     1866    13953    4                     END ; /* ELSE DO */

     1867    13954    3                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  13954  2 006330   200412 631500                    EPPR1   CH_XFORMAT,,AUTO
         2 006331   201344 451500                    STP1    LFPT_PRECORD+10,,AUTO
         2 006332   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 006333   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006334   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 006335   000000 011000                    NOP     0

     1868    13955                                                       /* Delete all associated records. */
     1869    13956    3   DELETE_RECORDS:
     1870    13957    3                 TEMP2 = CHKEYBUF.NUM ;

  13957  2 006336   200337 235100       DELETE_RECO* LDA     CHKEYBUF+1,,AUTO
         2 006337   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 006340   000033 773000                    LRL     27
         2 006341   200150 756100                    STQ     TEMP2,,AUTO

     1871    13958    4                 DO WHILE (CHKEYBUF.SYSID = CH_XFORMAT.SYSID# AND CHKEYBUF.KSIZ ~= 0 )
             13958                          ;

  13958  2 006342   006361 710000 2                  TRA     s:13968

     1872    13959    4                   CALL M$PRECORD(FPT_PRECORD) ALTRET(RECORD_NOT_THERE) ;

  13959  2 006343   200746 630500                    EPPR0   FPT_PRECORD,,AUTO
         2 006344   440003 713400                    CLIMB   alt,+16387
         2 006345   401000 401760                    pmme    nvectors=3
         2 006346   006357 702000 2                  TSX2    RECORD_NOT_THERE

     1873    13960    4                   IF TEMP2 ~= CHKEYBUF.NUM
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:281  

  13960  2 006347   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 006350   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 006351   000033 773000                    LRL     27
         2 006352   200150 116100                    CMPQ    TEMP2,,AUTO
         2 006353   006355 600000 2                  TZE     s:13963

     1874    13961    4                     THEN                                     /* Different record. */
     1875    13962    4                       NRECS_READ = NRECS_READ + 1 ;

  13962  2 006354   200155 054100                    AOS     NRECS_READ,,AUTO

     1876    13963    4                   CALL DELETE_USEFILE_REC ;

  13963  2 006355   007176 701000 2                  TSX1    DELETE_USEFILE_REC
         2 006356   000000 011000                    NOP     0

     1877    13964    4   RECORD_NOT_THERE:
     1878    13965    4                   IF TEMP2 ~= 0

  13965  2 006357   200150 235100       RECORD_NOT_* LDA     TEMP2,,AUTO
         2 006360   006371 601000 2                  TNZ     s:13972

     1879    13966    4                     THEN
     1880    13967    4                       EXIT;
     1881    13968    4                 END ; /* DO WHILE */

  13968  2 006361   200336 235100                    LDA     CHKEYBUF,,AUTO
         2 006362   200337 236100                    LDQ     CHKEYBUF+1,,AUTO
         2 006363   000033 773000                    LRL     27
         2 006364   200413 116100                    CMPQ    CH_XFORMAT+1,,AUTO
         2 006365   006371 601000 2                  TNZ     s:13972
         2 006366   200336 236100                    LDQ     CHKEYBUF,,AUTO
         2 006367   777000 316003                    CANQ    -512,DU
         2 006370   006343 601000 2                  TNZ     s:13959

     1882    13969
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:282  
     1883    13970    3               END ; /* THEN DO */

     1884    13971
     1885    13972    2           RETURN ;

  13972  2 006371   201324 221300                    LDX1  ! HDR_MSG#,,AUTO
         2 006372   000001 702211                    TSX2  ! 1,X1

     1886    13973    2   E_JOBSTATS:
     1887    13974    2         IF (B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY)

  13974  2 006373   000000 470400 xsym  E_JOBSTATS   LDP0    B$TCB$
         2 006374   000000 471500                    LDP1    0,,PR0
         2 006375   100102 236100                    LDQ     66,,PR1
         2 006376   377770 376007                    ANQ     131064,DL
         2 006377   001020 116007                    CMPQ    528,DL
         2 006400   006423 600000 2                  TZE     s:13981

     1888    13975    2             THEN
     1889    13976    3               DO ;

     1890    13977    3                 CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR,,

  13977  2 006401   000000 236000 xsym               LDQ     SEG2$
         2 006402   000003 036003                    ADLQ    3,DU
         2 006403   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 006404   000007 236000 3                  LDQ     7
         2 006405   000001 235000 xsym               LDA     B_VECTNIL+1
         2 006406   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 006407   100102 633500                    EPPR3   66,,PR1
         2 006410   201347 453500                    STP3    LFPT_PRECORD+13,,AUTO
         2 006411   000035 236000 3                  LDQ     29
         2 006412   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 006413   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 006414   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 006415   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 006416   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:283  
         2 006417   000000 701000 xent               TSX1    CXP$POSTERR
         2 006420   000000 011000                    NOP     0

     1891    13978    3                                   M$IBEX1_NUM) ;
     1892    13979    3                 ALTRETURN ;

  13979  2 006421   201324 221300                    LDX1  ! HDR_MSG#,,AUTO
         2 006422   000000 702211                    TSX2  ! 0,X1

     1893    13980    3               END ; /* THEN DO */
     1894    13981    2         IF NOT JOB_COMPLETED

  13981  2 006423   200143 234100                    SZN     JOB_COMPLETED,,AUTO
         2 006424   006432 604000 2                  TMI     s:13987

     1895    13982    2             THEN
     1896    13983    3               DO ;                                      /* Some form of output. */

     1897    13984    3                 XSJ_JOBINFO = %NO# ;

  13984  2 006425   000100 100400                    MLR     fill='000'O
         2 006426   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 006427   201135 000024                    ADSC9   XSJ_JOBINFO,,AUTO        cn=0,n=20

     1898    13985    3                 RETURN ;

  13985  2 006430   201324 221300                    LDX1  ! HDR_MSG#,,AUTO
         2 006431   000001 702211                    TSX2  ! 1,X1

     1899    13986    3               END ; /* THEN DO */
     1900    13987    3         DO CASE (CMD_CODE) ;

  13987  2 006432   200154 235100                    LDA     CMD_CODE,,AUTO
         2 006433   000030 115007                    CMPA    24,DL
         2 006434   006436 602005 2                  TNC     s:13987+4,AL
         2 006435   006600 710000 2                  TRA     s:14035
         2 006436   006600 710000 2                  TRA     s:14035
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:284  
         2 006437   006466 710000 2                  TRA     s:13990
         2 006440   006466 710000 2                  TRA     s:13990
         2 006441   006574 710000 2                  TRA     s:14031
         2 006442   006600 710000 2                  TRA     s:14035
         2 006443   006600 710000 2                  TRA     s:14035
         2 006444   006600 710000 2                  TRA     s:14035
         2 006445   006600 710000 2                  TRA     s:14035
         2 006446   006600 710000 2                  TRA     s:14035
         2 006447   006600 710000 2                  TRA     s:14035
         2 006450   006600 710000 2                  TRA     s:14035
         2 006451   006600 710000 2                  TRA     s:14035
         2 006452   006600 710000 2                  TRA     s:14035
         2 006453   006600 710000 2                  TRA     s:14035
         2 006454   006600 710000 2                  TRA     s:14035
         2 006455   006600 710000 2                  TRA     s:14035
         2 006456   006600 710000 2                  TRA     s:14035
         2 006457   006600 710000 2                  TRA     s:14035
         2 006460   006600 710000 2                  TRA     s:14035
         2 006461   006600 710000 2                  TRA     s:14035
         2 006462   006600 710000 2                  TRA     s:14035
         2 006463   006466 710000 2                  TRA     s:13990
         2 006464   006600 710000 2                  TRA     s:14035
         2 006465   006546 710000 2                  TRA     s:14022

     1901    13988
     1902    13989    3             CASE(%CH_SYSIDCMD, %CH_JOBNAME, %CH_LAST) ;

     1903    13990    3                IF CMD_TYPE = %SUBMIT_CMD#

  13990  2 006466   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 006467   000002 115007                    CMPA    2,DL
         2 006470   006504 601000 2                  TNZ     s:14001

     1904    13991    3                 THEN
     1905    13992    3                   IF NSTATUS_FLG

  13992  2 006471   200126 234100                    SZN     NSTATUS_FLG,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:285  
         2 006472   006501 605000 2                  TPL     s:14000

     1906    13993    3                     THEN
     1907    13994    4                       DO ;

     1908    13995    4                         CALL SETUP_DUMMY_SUBMIT_MESS ;

  13995  2 006473   007634 701000 2                  TSX1    SETUP_DUMMY_SUBMIT_MESS
         2 006474   000000 011000                    NOP     0

     1909    13996    4                         CALL PRINT_SUBMIT_MESS ;

  13996  2 006475   007664 701000 2                  TSX1    PRINT_SUBMIT_MESS
         2 006476   000000 011000                    NOP     0

     1910    13997    4                         RETURN ;

  13997  2 006477   201324 221300                    LDX1  ! HDR_MSG#,,AUTO
         2 006500   000001 702211                    TSX2  ! 1,X1

     1911    13998    4                       END ; /* Then Do */
     1912    13999    3                 ELSE
     1913    14000    3                   UNWIND TO SUBMIT_LOOP_REMEM;  /* Try again to find the job. */

  14000  2 006501   200162 237300                    LDAQ  ! SUBMIT_LOOP_REMEM,,AUTO
         2 006502   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 006503   000000 000200                    ZERO    0,128

     1914    14001    3                CH_XFORMAT.MSG# = %CP_NOTF_MESS ;

  14001  2 006504   000013 235007                    LDA     11,DL
         2 006505   200412 755100                    STA     CH_XFORMAT,,AUTO

     1915    14002    3                CH_XFORMAT.SYSID# = CHKEYBUF.SYSID;

  14002  2 006506   200336 235100                    LDA     CHKEYBUF,,AUTO
         2 006507   200337 236100                    LDQ     CHKEYBUF+1,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:286  
         2 006510   000033 773000                    LRL     27
         2 006511   200413 756100                    STQ     CH_XFORMAT+1,,AUTO

     1916    14003    3                IF NOT(CP_CHFLAGS.SYSTEM) AND

  14003  2 006512   200217 236100                    LDQ     CP_CHFLAGS+24,,AUTO
         2 006513   400000 316007                    CANQ    -131072,DL
         2 006514   006525 601000 2                  TNZ     s:14013
         2 006515   000000 471400 xsym               LDP1    B$JIT$
         2 006516   040100 106500                    CMPC    fill='040'O
         2 006517   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         2 006520   201200 000010                    ADSC9   FID_ACCT,,AUTO           cn=0,n=8
         2 006521   006525 600000 2                  TZE     s:14013

     1917    14004    3                       (B$JIT.ACCN ~= FID_ACCT.ACCT#)
     1918    14005    3                  THEN
     1919    14006                                                    /*
     1920    14007                                                      This guy is asking about someone
     1921    14008                                                      else's Job, and he does not
     1922    14009                                                      have the tools to look at it.
     1923    14010                                                      Don't let him see the JOBNAME.
     1924    14011                                                    */
     1925    14012    3                     SYSIDBUF.JNAME = ' ' ;

  14012  2 006522   040100 100400                    MLR     fill='040'O
         2 006523   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 006524   200351 000037                    ADSC9   SYSIDBUF+5,,AUTO         cn=0,n=31

     1926    14013    3                CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME# ;

  14013  2 006525   040100 100500                    MLR     fill='040'O
         2 006526   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31
         2 006527   200416 000037                    ADSC9   CH_XFORMAT+4,,AUTO       cn=0,n=31

     1927    14014    3                CH_XFORMAT.NUM# = CHKEYBUF.NUM;

  14014  2 006530   200337 235100                    LDA     CHKEYBUF+1,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:287  
         2 006531   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 006532   000033 773000                    LRL     27
         2 006533   200426 756100                    STQ     CH_XFORMAT+12,,AUTO

     1928    14015    3               IF FID_ACCT.ACCT# = ' '

  14015  2 006534   201200 237100                    LDAQ    FID_ACCT,,AUTO
         2 006535   000054 117000 3                  CMPAQ   44
         2 006536   006543 601000 2                  TNZ     s:14019

     1929    14016    3                 THEN                                    /* No acct. specified. */
     1930    14017    3                   CH_XFORMAT.ACCT# = ' ' ;

  14017  2 006537   000035 235000 xsym               LDA     B_VECTNIL+29
         2 006540   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 006541   200414 757100                    STAQ    CH_XFORMAT+2,,AUTO
         2 006542   006600 710000 2                  TRA     s:14035

     1931    14018    3                 ELSE                                    /* Get the acct. */
     1932    14019    3                   CH_XFORMAT.ACCT# = FID_ACCT.ACCT# ;

  14019  2 006543   201200 237100                    LDAQ    FID_ACCT,,AUTO
         2 006544   200414 757100                    STAQ    CH_XFORMAT+2,,AUTO
         2 006545   006600 710000 2                  TRA     s:14035

     1933    14020
     1934    14021    3             CASE(%CH_NOOPTIONS) ;

     1935    14022    3                CH_XFORMAT.MSG# = %CP_DOESNT_EXIST_MESS ;

  14022  2 006546   000016 235007                    LDA     14,DL
         2 006547   200412 755100                    STA     CH_XFORMAT,,AUTO

     1936    14023    3                CH_XFORMAT.SYSID# = CHKEYBUF.SYSID ;

  14023  2 006550   200336 235100                    LDA     CHKEYBUF,,AUTO
         2 006551   200337 236100                    LDQ     CHKEYBUF+1,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:288  
         2 006552   000033 773000                    LRL     27
         2 006553   200413 756100                    STQ     CH_XFORMAT+1,,AUTO

     1937    14024    3                CH_XFORMAT.ACCT# = SYSIDBUF.ACCT ;

  14024  2 006554   040100 100500                    MLR     fill='040'O
         2 006555   200347 000010                    ADSC9   SYSIDBUF+3,,AUTO         cn=0,n=8
         2 006556   200414 000010                    ADSC9   CH_XFORMAT+2,,AUTO       cn=0,n=8

     1938    14025    3                CH_XFORMAT.JOBNAME# = SYSIDBUF.JNAME ;

  14025  2 006557   040100 100500                    MLR     fill='040'O
         2 006560   200351 000037                    ADSC9   SYSIDBUF+5,,AUTO         cn=0,n=31
         2 006561   200416 000037                    ADSC9   CH_XFORMAT+4,,AUTO       cn=0,n=31

     1939    14026    3                CH_XFORMAT.COMMENT# = SYSIDBUF.COMMENT ;

  14026  2 006562   040100 100500                    MLR     fill='040'O
         2 006563   200360 600030                    ADSC9   SYSIDBUF+12,,AUTO        cn=3,n=24
         2 006564   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     1940    14027    3                CH_XFORMAT.NUM# = CHKEYBUF.NUM ;

  14027  2 006565   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 006566   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 006567   000033 773000                    LRL     27
         2 006570   200426 756100                    STQ     CH_XFORMAT+12,,AUTO

     1941    14028    3                CH_XFORMAT.BUF$ = ADDR(XSJ_JOBINFO) ;

  14028  2 006571   201135 631500                    EPPR1   XSJ_JOBINFO,,AUTO
         2 006572   200427 451500                    STP1    CH_XFORMAT+13,,AUTO
         2 006573   006600 710000 2                  TRA     s:14035

     1942    14029
     1943    14030    3             CASE(%CH_TERM_CMD) ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:289  
     1944    14031    3                CH_XFORMAT.MSG# = %CP_NO_TERM_OUT_MESS ;

  14031  2 006574   000033 235007                    LDA     27,DL
         2 006575   200412 755100                    STA     CH_XFORMAT,,AUTO

     1945    14032    3                CH_XFORMAT.SYSID# = TEMP ;

  14032  2 006576   200147 236100                    LDQ     TEMP,,AUTO
         2 006577   200413 756100                    STQ     CH_XFORMAT+1,,AUTO

     1946    14033
     1947    14034    3             END ; /* DO CASE */

     1948    14035    2         CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  14035  2 006600   200412 631500                    EPPR1   CH_XFORMAT,,AUTO
         2 006601   201344 451500                    STP1    LFPT_PRECORD+10,,AUTO
         2 006602   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 006603   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006604   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 006605   000000 011000                    NOP     0

     1949    14036    2         GOTO DELETE_RECORDS ;

  14036  2 006606   006336 710000 2                  TRA     DELETE_RECORDS

     1950    14037
     1951    14038    2   END   READ_JOBSTATS_FILE ;
     1952    14039        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:290  
     1953    14040    1   GET_JOBNAME_SYSID_REC:    PROC ALTRET ;

  14040  2 006607   201326 741300       GET_JOBNAME* STX1  ! @CHKEYBUF+1,,AUTO

     1954    14041
     1955    14042    2         XSJ_NAMEKEY = CXSJ_NAMEKEY ;

  14042  2 006610   000100 100400                    MLR     fill='000'O
         2 006611   000144 000051 1                  ADSC9   CXSJ_NAMEKEY             cn=0,n=41
         2 006612   201143 000051                    ADSC9   XSJ_NAMEKEY,,AUTO        cn=0,n=41

     1956    14043    2         XSJ_NAMEKEY.JOBNAME# = VLP_JOBNAME.JOBNAME# ;

  14043  2 006613   040100 100500                    MLR     fill='040'O
         2 006614   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31
         2 006615   201143 400037                    ADSC9   XSJ_NAMEKEY,,AUTO        cn=2,n=31

     1957    14044    2         IF FID_ACCT.ACCT# ~= ' '

  14044  2 006616   201200 237100                    LDAQ    FID_ACCT,,AUTO
         2 006617   000054 117000 3                  CMPAQ   44
         2 006620   006625 600000 2                  TZE     s:14048

     1958    14045    2           THEN
     1959    14046    2             XSJ_NAMEKEY.ACCT# = FID_ACCT.ACCT# ;

  14046  2 006621   040100 100500                    MLR     fill='040'O
         2 006622   201200 000010                    ADSC9   FID_ACCT,,AUTO           cn=0,n=8
         2 006623   201153 200010                    ADSC9   XSJ_NAMEKEY+8,,AUTO      cn=1,n=8
         2 006624   006631 710000 2                  TRA     s:14049

     1960    14047    2           ELSE
     1961    14048    2             XSJ_NAMEKEY.ACCT# = B$JIT.ACCN ;

  14048  2 006625   000000 470400 xsym               LDP0    B$JIT$
         2 006626   040100 100500                    MLR     fill='040'O
         2 006627   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:291  
         2 006630   201153 200010                    ADSC9   XSJ_NAMEKEY+8,,AUTO      cn=1,n=8

     1962    14049    2         XSJ_NAMEREC.SYSID# = 0 ;

  14049  2 006631   000000 220003                    LDX0    0,DU
         2 006632   201142 740100                    STX0    XSJ_NAMEREC,,AUTO

     1963    14050    2         FPT_READ_JOBINFO.BUF_ = VECTOR(XSJ_NAMEREC) ;

  14050  2 006633   777640 235007                    LDA     -96,DL
         2 006634   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006635   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006636   001142 036003                    ADLQ    610,DU
         2 006637   200660 757100                    STAQ    FPT_READ_JOBINFO+4,,AUTO

     1964    14051    2         FPT_READ_JOBINFO.KEY_ = VECTOR(XSJ_NAMEKEY) ;

  14051  2 006640   000053 235000 3                  LDA     43
         2 006641   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 006642   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 006643   001143 036003                    ADLQ    611,DU
         2 006644   200656 757100                    STAQ    FPT_READ_JOBINFO+2,,AUTO

     1965    14052    2         CALL M$READ(FPT_READ_JOBINFO) ALTRET(E_READ_SYSID_NAME_REC) ;

  14052  2 006645   200654 630500                    EPPR0   FPT_READ_JOBINFO,,AUTO
         2 006646   440000 713400                    CLIMB   alt,read
         2 006647   401400 401760                    pmme    nvectors=4
         2 006650   006652 702000 2                  TSX2    E_READ_SYSID_NAME_REC

     1966    14053    3         DO WHILE ('0'B) ;

  14053  2 006651   006677 710000 2                  TRA     s:14062

     1967    14054    3   E_READ_SYSID_NAME_REC:
     1968    14055    3             IF B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$NOKEY

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:292  
  14055  2 006652   000000 470400 xsym  E_READ_SYSI* LDP0    B$TCB$
         2 006653   000000 471500                    LDP1    0,,PR0
         2 006654   100102 236100                    LDQ     66,,PR1
         2 006655   377770 376007                    ANQ     131064,DL
         2 006656   001020 116007                    CMPQ    528,DL
         2 006657   006677 600000 2                  TZE     s:14062

     1969    14056    3               THEN
     1970    14057    4                 DO ;

     1971    14058    4                   CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR) ;

  14058  2 006660   000000 236000 xsym               LDQ     SEG2$
         2 006661   000003 036003                    ADLQ    3,DU
         2 006662   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 006663   100102 633500                    EPPR3   66,,PR1
         2 006664   201347 453500                    STP3    LFPT_PRECORD+13,,AUTO
         2 006665   000035 236000 3                  LDQ     29
         2 006666   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 006667   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 006670   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 006671   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 006672   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 006673   000000 701000 xent               TSX1    CXP$POSTERR
         2 006674   000000 011000                    NOP     0

     1972    14059    4                   ALTRETURN ;

  14059  2 006675   201326 221300                    LDX1  ! @CHKEYBUF+1,,AUTO
         2 006676   000000 702211                    TSX2  ! 0,X1

     1973    14060    4                 END ; /*THEN DO */
     1974    14061    3         END ; /* DO WHILE */

     1975    14062    2         TEMP = XSJ_NAMEREC.SYSID# ;

  14062  2 006677   201142 235100                    LDA     XSJ_NAMEREC,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:293  
         2 006700   000022 771000                    ARL     18
         2 006701   200147 755100                    STA     TEMP,,AUTO

     1976    14063
     1977    14064    2         RETURN ;

  14064  2 006702   201326 221300                    LDX1  ! @CHKEYBUF+1,,AUTO
         2 006703   000001 702211                    TSX2  ! 1,X1

     1978    14065
     1979    14066    2   END   GET_JOBNAME_SYSID_REC ;
     1980    14067        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:294  
     1981    14068    1   GET_JOBSTATS:   PROC ALTRET ;

  14068  2 006704   201320 741300       GET_JOBSTATS STX1  ! RETURN_FLG+3,,AUTO

     1982    14069        %VLP_ERRCODE (FPTN=ERRCODE, STCLASS=AUTO);
     1983    14114
     1984    14115    2         ERRCODE = '0'B;

  14115  2 006705   201321 450100                    STZ     ERRCODE,,AUTO

     1985    14116
     1986    14117    2   JOBSTATS_LOOP:
     1987    14118    2         CALL M$JOBSTATS (FPT_JOBSTATS) ALTRET(E_JOBSTATS2);

  14118  2 006706   200760 630500       JOBSTATS_LO* EPPR0   FPT_JOBSTATS,,AUTO
         2 006707   570001 713400                    CLIMB   alt,+61441
         2 006710   405400 401760                    pmme    nvectors=12
         2 006711   007025 702000 2                  TSX2    E_JOBSTATS2

  14115  2 006712                       DISP_JOBSTA* null
     1988    14119
     1989    14120    2   DISP_JOBSTATS: ;
     1990    14121    3         DO CASE(CMD_CODE) ;

  14121  2 006712   200154 235100                    LDA     CMD_CODE,,AUTO
         2 006713   000030 115007                    CMPA    24,DL
         2 006714   006716 602005 2                  TNC     DISP_JOBSTATS+4,AL
         2 006715   007003 710000 2                  TRA     s:14145
         2 006716   007003 710000 2                  TRA     s:14145
         2 006717   006770 710000 2                  TRA     s:14138
         2 006720   006770 710000 2                  TRA     s:14138
         2 006721   006770 710000 2                  TRA     s:14138
         2 006722   007003 710000 2                  TRA     s:14145
         2 006723   007003 710000 2                  TRA     s:14145
         2 006724   007003 710000 2                  TRA     s:14145
         2 006725   006746 710000 2                  TRA     s:14124
         2 006726   006746 710000 2                  TRA     s:14124
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:295  
         2 006727   006757 710000 2                  TRA     s:14131
         2 006730   006746 710000 2                  TRA     s:14124
         2 006731   007003 710000 2                  TRA     s:14145
         2 006732   007003 710000 2                  TRA     s:14145
         2 006733   007003 710000 2                  TRA     s:14145
         2 006734   007003 710000 2                  TRA     s:14145
         2 006735   007003 710000 2                  TRA     s:14145
         2 006736   007003 710000 2                  TRA     s:14145
         2 006737   007003 710000 2                  TRA     s:14145
         2 006740   007003 710000 2                  TRA     s:14145
         2 006741   007003 710000 2                  TRA     s:14145
         2 006742   007003 710000 2                  TRA     s:14145
         2 006743   006770 710000 2                  TRA     s:14138
         2 006744   007003 710000 2                  TRA     s:14145
         2 006745   006770 710000 2                  TRA     s:14138

     1991    14122
     1992    14123    3             CASE(%CH_INPUT, %CH_RUN,%CH_JOB) ;

     1993    14124    3               IF CMD_TYPE = %CANCEL_CMD#

  14124  2 006746   200164 236100                    LDQ     CMD_TYPE,,AUTO
         2 006747   000003 116007                    CMPQ    3,DL
         2 006750   006754 601000 2                  TNZ     s:14128

     1994    14125    3                 THEN
     1995    14126    3                   CALL DISP_SYSID_SRCH_IRQ;

  14126  2 006751   005101 701000 2                  TSX1    DISP_SYSID_SRCH_IRQ
         2 006752   000000 011000                    NOP     0
         2 006753   007003 710000 2                  TRA     s:14145

     1996    14127    3                 ELSE
     1997    14128    3                   CALL DISP_INPUT ;

  14128  2 006754   004511 701000 2                  TSX1    DISP_INPUT
         2 006755   000000 011000                    NOP     0
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:296  
         2 006756   007003 710000 2                  TRA     s:14145

     1998    14129
     1999    14130    3             CASE(%CH_OUTPUT) ;

     2000    14131    3               IF CMD_TYPE = %CANCEL_CMD#

  14131  2 006757   200164 236100                    LDQ     CMD_TYPE,,AUTO
         2 006760   000003 116007                    CMPQ    3,DL
         2 006761   006765 601000 2                  TNZ     s:14135

     2001    14132    3                 THEN
     2002    14133    3                   CALL DISP_SYSID_SRCH_OQ;

  14133  2 006762   005334 701000 2                  TSX1    DISP_SYSID_SRCH_OQ
         2 006763   000000 011000                    NOP     0
         2 006764   007003 710000 2                  TRA     s:14145

     2003    14134    3                 ELSE
     2004    14135    3                   CALL DISP_OUTPUT ;

  14135  2 006765   005000 701000 2                  TSX1    DISP_OUTPUT
         2 006766   000000 011000                    NOP     0
         2 006767   007003 710000 2                  TRA     s:14145

     2005    14136
     2006    14137    3             CASE(%CH_SYSIDCMD,%CH_JOBNAME,%CH_LAST,%CH_TERM_CMD,%CH_NOOPTIONS) ;

     2007    14138    3                 IF (USEFID_OPEN# = %NO#)

  14138  2 006770   200121 234100                    SZN     USEFID_OPEN#,,AUTO
         2 006771   006774 604000 2                  TMI     s:14140

     2008    14139    3                   THEN CALL OPEN_USEFILE ALTRET(E_OPEN) ;

  14139  2 006772   007323 701000 2                  TSX1    OPEN_USEFILE
         2 006773   007151 702000 2                  TSX2    E_OPEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:297  

     2009    14140    3                 IF (FPT_JOBSTATS.V.OUTPUT#)

  14140  2 006774   201013 234100                    SZN     FPT_JOBSTATS+27,,AUTO
         2 006775   007001 605000 2                  TPL     s:14142

     2010    14141    3                   THEN CALL DISP_SYSID_SRCH_OQ ALTRET(E_OPEN) ;

  14141  2 006776   005334 701000 2                  TSX1    DISP_SYSID_SRCH_OQ
         2 006777   007151 702000 2                  TSX2    E_OPEN
         2 007000   007003 710000 2                  TRA     s:14145

     2011    14142    3                   ELSE CALL DISP_SYSID_SRCH_IRQ ;

  14142  2 007001   005101 701000 2                  TSX1    DISP_SYSID_SRCH_IRQ
         2 007002   000000 011000                    NOP     0

     2012    14143
     2013    14144    3         END ; /* DO CASE */

     2014    14145    2         IF ERRCODE

  14145  2 007003   201321 235100                    LDA     ERRCODE,,AUTO
         2 007004   007023 600000 2                  TZE     s:14148

     2015    14146    2            THEN
     2016    14147    2               CALL CPC$WRITEMSGE(ERRCODE,,,,,%YES#);

  14147  2 007005   000050 236000 3                  LDQ     40
         2 007006   000001 235000 xsym               LDA     B_VECTNIL+1
         2 007007   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 007010   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007011   000001 235000 xsym               LDA     B_VECTNIL+1
         2 007012   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 007013   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007014   201345 756100                    STQ     LFPT_PRECORD+11,,AUTO
         2 007015   201321 630500                    EPPR0   ERRCODE,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:298  
         2 007016   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 007017   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 007020   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 007021   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 007022   000000 011000                    NOP     0

     2017    14148    2         RETURN ;

  14148  2 007023   201320 221300                    LDX1  ! RETURN_FLG+3,,AUTO
         2 007024   000001 702211                    TSX2  ! 1,X1

     2018    14149    2   E_JOBSTATS2:
     2019    14150    2         ERRCODE = B$TCB.ALT$ -> B$ALT.ERR ;

  14150  2 007025   000000 470400 xsym  E_JOBSTATS2  LDP0    B$TCB$
         2 007026   000000 471500                    LDP1    0,,PR0
         2 007027   100102 236100                    LDQ     66,,PR1
         2 007030   201321 756100                    STQ     ERRCODE,,AUTO

     2020    14151    2         ERRCODE.SEV = 0;

  14151  2 007031   000056 236000 3                  LDQ     46
         2 007032   201321 356100                    ANSQ    ERRCODE,,AUTO

     2021    14152    3         DO CASE(ERRCODE.ERR#) ;

  14152  2 007033   201321 236100                    LDQ     ERRCODE,,AUTO
         2 007034   000003 772000                    QRL     3
         2 007035   037777 376007                    ANQ     16383,DL
         2 007036   002126 136007                    SBLQ    1110,DL
         2 007037   000007 116007                    CMPQ    7,DL
         2 007040   007042 602006 2                  TNC     s:14152+7,QL
         2 007041   007151 710000 2                  TRA     E_OPEN
         2 007042   007051 710000 2                  TRA     s:14155
         2 007043   007151 710000 2                  TRA     E_OPEN
         2 007044   007151 710000 2                  TRA     E_OPEN
         2 007045   007151 710000 2                  TRA     E_OPEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:299  
         2 007046   007111 710000 2                  TRA     s:14177
         2 007047   007131 710000 2                  TRA     s:14187
         2 007050   007121 710000 2                  TRA     s:14182

     2022    14153
     2023    14154    3             CASE(%E$NOTFND) ;                     /* Not in :JOBSTATS */

     2024    14155    4                 DO CASE(CMD_CODE) ;

  14155  2 007051   200154 235100                    LDA     CMD_CODE,,AUTO
         2 007052   000007 135007                    SBLA    7,DL
         2 007053   000004 115007                    CMPA    4,DL
         2 007054   007056 602005 2                  TNC     s:14155+5,AL
         2 007055   007073 710000 2                  TRA     s:14166
         2 007056   007062 710000 2                  TRA     s:14158
         2 007057   007065 710000 2                  TRA     s:14161
         2 007060   007070 710000 2                  TRA     s:14164
         2 007061   007065 710000 2                  TRA     s:14161

     2025    14156
     2026    14157    4                   CASE(%CH_INPUT) ;

     2027    14158    4                     CH_XFORMAT.MSG# = %CP_NONE_IN_MESS ;

  14158  2 007062   000027 235007                    LDA     23,DL
         2 007063   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 007064   007075 710000 2                  TRA     s:14168

     2028    14159
     2029    14160    4                   CASE(%CH_RUN, %CH_JOB) ;

     2030    14161    4                     CH_XFORMAT.MSG# = %CP_NONE_RUN_MESS ;

  14161  2 007065   000030 235007                    LDA     24,DL
         2 007066   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 007067   007075 710000 2                  TRA     s:14168

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:300  
     2031    14162
     2032    14163    4                   CASE(%CH_OUTPUT) ;

     2033    14164    4                     CH_XFORMAT.MSG# = %CP_NONE_OUT_MESS ;

  14164  2 007070   000031 235007                    LDA     25,DL
         2 007071   200412 755100                    STA     CH_XFORMAT,,AUTO
         2 007072   007075 710000 2                  TRA     s:14168

     2034    14165    4                   CASE(ELSE) ;

     2035    14166    4                     CH_XFORMAT.MSG# = %CP_NONE_MESS ;

  14166  2 007073   000004 235007                    LDA     4,DL
         2 007074   200412 755100                    STA     CH_XFORMAT,,AUTO

     2036    14167    4                 END ; /* DO CASE */

     2037    14168    3                 IF NOTIFYING /* No message or blank line if notify */

  14168  2 007075   200137 234100                    SZN     NOTIFYING,,AUTO
         2 007076   007101 605000 2                  TPL     s:14171

     2038    14169    3                    THEN
     2039    14170    3                       ALTRETURN;

  14170  2 007077   201320 221300                    LDX1  ! RETURN_FLG+3,,AUTO
         2 007100   000000 702211                    TSX2  ! 0,X1

     2040    14171    3                 CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  14171  2 007101   200412 631500                    EPPR1   CH_XFORMAT,,AUTO
         2 007102   201344 451500                    STP1    LFPT_PRECORD+10,,AUTO
         2 007103   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 007104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007105   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 007106   000000 011000                    NOP     0
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:301  

     2041    14172    3   E_SETUP:
     2042    14173
     2043    14174    3                 RETURN ;

  14174  2 007107   201320 221300       E_SETUP      LDX1  ! RETURN_FLG+3,,AUTO
         2 007110   000001 702211                    TSX2  ! 1,X1

     2044    14175
     2045    14176    3             CASE(%E$JSIRAS) ;                     /* Not enough space for STATs. */

     2046    14177    3                 ADDR(FPT_JOBSTATS.RESULTS_) -> B$$VECTOR.W1.VSIZE# =

  14177  2 007111   200764 236100                    LDQ     FPT_JOBSTATS+4,,AUTO
         2 007112   000020 772000                    QRL     16
         2 007113   050000 036007                    ADLQ    20480,DL
         2 007114   000020 736000                    QLS     16
         2 007115   200764 676100                    ERQ     FPT_JOBSTATS+4,,AUTO
         2 007116   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 007117   200764 656100                    ERSQ    FPT_JOBSTATS+4,,AUTO
         2 007120   007153 710000 2                  TRA     s:14202

     2047    14178    3                 ADDR(FPT_JOBSTATS.RESULTS_) -> B$$VECTOR.W1.VSIZE# +
     2048    14179    3                                                 (%CPCH_NP2G*4096) ;
     2049    14180
     2050    14181    3             CASE(%E$JSISLS) ;                     /* Not enough space for SNs. */

     2051    14182    3                 ADDR(FPT_JOBSTATS.SNLIST_) -> B$$VECTOR.W1.VSIZE# =

  14182  2 007121   200774 236100                    LDQ     FPT_JOBSTATS+12,,AUTO
         2 007122   000020 772000                    QRL     16
         2 007123   050000 036007                    ADLQ    20480,DL
         2 007124   000020 736000                    QLS     16
         2 007125   200774 676100                    ERQ     FPT_JOBSTATS+12,,AUTO
         2 007126   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 007127   200774 656100                    ERSQ    FPT_JOBSTATS+12,,AUTO

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:302  
     2052    14183    3                 ADDR(FPT_JOBSTATS.SNLIST_) -> B$$VECTOR.W1.VSIZE# +
     2053    14184    3                                                 (%CPCH_NP2G*4096) ;
     2054    14185    3                 GOTO MOVE_STATS ;

  14185  2 007130   007144 710000 2                  TRA     MOVE_STATS

     2055    14186    3             CASE(%E$JSIRLS) ;                     /* Not enough space for RES. */

     2056    14187    3                 ADDR(FPT_JOBSTATS.RESLIST_) -> B$$VECTOR.W1.VSIZE# =

  14187  2 007131   200776 236100                    LDQ     FPT_JOBSTATS+14,,AUTO
         2 007132   000020 772000                    QRL     16
         2 007133   050000 036007                    ADLQ    20480,DL
         2 007134   000020 736000                    QLS     16
         2 007135   200776 676100                    ERQ     FPT_JOBSTATS+14,,AUTO
         2 007136   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 007137   200776 656100                    ERSQ    FPT_JOBSTATS+14,,AUTO

     2057    14188    3                 ADDR(FPT_JOBSTATS.RESLIST_) -> B$$VECTOR.W1.VSIZE# +
     2058    14189    3                                                 (%CPCH_NP2G*4096) ;
     2059    14190    3                 SN$ = PINCRW(SN$,%CPCH_NP2G*1024) ;

  14190  2 007140   200015 236100                    LDQ     SN$,,AUTO
         2 007141   012000 036003                    ADLQ    5120,DU
         2 007142   200015 756100                    STQ     SN$,,AUTO

     2060    14191    3                 ADDR(FPT_JOBSTATS.SNLIST_) -> B$$VECTOR.PTR$ = SN$ ;

  14191  2 007143   200775 756100                    STQ     FPT_JOBSTATS+13,,AUTO

     2061    14192    3   MOVE_STATS:
     2062    14193    3                 STAT$ = PINCRW(STAT$,%CPCH_NP2G*1024) ;

  14193  2 007144   200013 236100       MOVE_STATS   LDQ     STAT$,,AUTO
         2 007145   012000 036003                    ADLQ    5120,DU
         2 007146   200013 756100                    STQ     STAT$,,AUTO

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:303  
     2063    14194    3                 ADDR(FPT_JOBSTATS.RESULTS_) -> B$$VECTOR.PTR$ = STAT$ ;

  14194  2 007147   200765 756100                    STQ     FPT_JOBSTATS+5,,AUTO
         2 007150   007153 710000 2                  TRA     s:14202

     2064    14195
     2065    14196    3             CASE(ELSE) ;                        /* More serious */

     2066    14197    3   E_OPEN:
     2067    14198    3                 ALTRETURN ;

  14198  2 007151   201320 221300       E_OPEN       LDX1  ! RETURN_FLG+3,,AUTO
         2 007152   000000 702211                    TSX2  ! 0,X1

     2068    14199
     2069    14200    3         END ; /* DO CASE */

     2070    14201
     2071    14202    2         CALL CPC$GETSEG (SEG4$,%CPCH_NP2G*1024) WHENALTRETURN

  14202  2 007153   000060 630400 3                  EPPR0   48
         2 007154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 007155   000000 701000 xent               TSX1    CPC$GETSEG
         2 007156   007160 702000 2                  TSX2    s:14204
         2 007157   007165 710000 2                  TRA     s:14209

     2072    14203    3            DO;

     2073    14204    3               IF ERRCODE.ERR# ~= %E$JSIRAS

  14204  2 007160   201321 236100                    LDQ     ERRCODE,,AUTO
         2 007161   377770 376007                    ANQ     131064,DL
         2 007162   021320 116007                    CMPQ    8912,DL
         2 007163   007025 601000 2                  TNZ     E_JOBSTATS2

     2074    14205    3                  THEN
     2075    14206    3                     GOTO E_JOBSTATS2;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:304  
     2076    14207    3               GOTO DISP_JOBSTATS;

  14207  2 007164   006712 710000 2                  TRA     DISP_JOBSTATS

     2077    14208    3            END;
     2078    14209    2         ERRCODE = '0'B;

  14209  2 007165   201321 450100                    STZ     ERRCODE,,AUTO

     2079    14210    2         VBOUND(RESULTS_) = VBOUND(RESULTS_)+4096*%CPCH_NP2G;

  14210  2 007166   200450 236100                    LDQ     RESULTS_,,AUTO
         2 007167   000020 772000                    QRL     16
         2 007170   050000 036007                    ADLQ    20480,DL
         2 007171   000020 736000                    QLS     16
         2 007172   200450 676100                    ERQ     RESULTS_,,AUTO
         2 007173   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 007174   200450 656100                    ERSQ    RESULTS_,,AUTO

     2080    14211    2         GOTO JOBSTATS_LOOP ;

  14211  2 007175   006706 710000 2                  TRA     JOBSTATS_LOOP

     2081    14212    2   END   GET_JOBSTATS ;
     2082    14213        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:305  
     2083    14214    1   DELETE_USEFILE_REC: PROC ;

  14214  2 007176   201332 741300       DELETE_USEF* STX1  ! FID_SN+2,,AUTO

     2084    14215
     2085    14216    2         FPT_DELREC = CFPT_DELREC ;

  14216  2 007177   000100 100400                    MLR     fill='000'O
         2 007200   000000 000050 xsym               ADSC9   CFPT_DELREC              cn=0,n=40
         2 007201   200730 000050                    ADSC9   FPT_DELREC,,AUTO         cn=0,n=40

     2086    14217    2         FPT_DELREC.V_ = VECTOR(FPT_DELREC.V) ;

  14217  2 007202   000005 235000 3                  LDA     5
         2 007203   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 007204   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 007205   000740 036003                    ADLQ    480,DU
         2 007206   200730 757100                    STAQ    FPT_DELREC,,AUTO

     2087    14218    2         FPT_DELREC.KEY_ = VECTOR(CHKEYBUF) ;

  14218  2 007207   000006 235000 3                  LDA     6
         2 007210   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 007211   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 007212   000336 036003                    ADLQ    222,DU
         2 007213   200732 757100                    STAQ    FPT_DELREC+2,,AUTO

     2088    14219    2         FPT_DELREC.V.DCB# = M$IBEX_NUM ;

  14219  2 007214   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 007215   200740 740100                    STX0    FPT_DELREC+8,,AUTO

     2089    14220                                                      /* Delete this record in USE file */
     2090    14221    2         CALL M$DELREC(FPT_DELREC) ALTRET(E_DELREC) ;

  14221  2 007216   200730 630500                    EPPR0   FPT_DELREC,,AUTO
         2 007217   440002 713400                    CLIMB   alt,+16386
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:306  
         2 007220   401400 401760                    pmme    nvectors=4
         2 007221   007223 702000 2                  TSX2    E_DELREC

     2091    14222    2         NRECS_DEL = NRECS_DEL + 1 ;

  14222  2 007222   200157 054100                    AOS     NRECS_DEL,,AUTO

     2092    14223    2   E_DELREC:
     2093    14224    2         RETURN ;

  14224  2 007223   201332 221300       E_DELREC     LDX1  ! FID_SN+2,,AUTO
         2 007224   000001 702211                    TSX2  ! 1,X1

     2094    14225    2   END   DELETE_USEFILE_REC ;
     2095    14226        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:307  
     2096    14227    1   WRITE_USEFILE_REC:  PROC  ALTRET ;

  14227  2 007225   201330 741300       WRITE_USEFI* STX1  ! FID_SN,,AUTO

     2097    14228
     2098    14229    2         IF CMD_TYPE = %CANCEL_CMD#

  14229  2 007226   200164 235100                    LDA     CMD_TYPE,,AUTO
         2 007227   000003 115007                    CMPA    3,DL
         2 007230   007232 601000 2                  TNZ     s:14232

     2099    14230    2           THEN
     2100    14231    2             RETURN;

  14231  2 007231   000001 702211                    TSX2  ! 1,X1

     2101    14232    2         IF NOT USEFID_OPEN#

  14232  2 007232   200121 234100                    SZN     USEFID_OPEN#,,AUTO
         2 007233   007236 604000 2                  TMI     s:14235

     2102    14233    2             THEN CALL OPEN_USEFILE ALTRET(E_OPEN_USE) ;

  14233  2 007234   007323 701000 2                  TSX1    OPEN_USEFILE
         2 007235   007321 702000 2                  TSX2    E_OPEN_USE

     2103    14234
     2104    14235    2         IF DELUSEREC

  14235  2 007236   200123 234100                    SZN     DELUSEREC,,AUTO
         2 007237   007244 605000 2                  TPL     s:14242

     2105    14236    2           THEN
     2106    14237    3             DO;

     2107    14238    3               CALL DELETE_USEFILE_REC;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:308  
  14238  2 007240   007176 701000 2                  TSX1    DELETE_USEFILE_REC
         2 007241   000000 011000                    NOP     0

     2108    14239    3               RETURN;

  14239  2 007242   201330 221300                    LDX1  ! FID_SN,,AUTO
         2 007243   000001 702211                    TSX2  ! 1,X1

     2109    14240    3             END;
     2110    14241
     2111    14242    2         CALL CPJ$WRITE_REC (M$IBEX_NUM,VECTOR(CHKEYBUF),VECTOR(SYSIDBUF))

  14242  2 007244   000006 235000 3                  LDA     6
         2 007245   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 007246   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 007247   000336 036003                    ADLQ    222,DU
         2 007250   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 007251   000037 235000 3                  LDA     31
         2 007252   201350 452500                    STP2    LFPT_PRECORD+14,,AUTO
         2 007253   201350 236100                    LDQ     LFPT_PRECORD+14,,AUTO
         2 007254   000344 036003                    ADLQ    228,DU
         2 007255   201354 757100                    STAQ    LFPT_PRECORD+18,,AUTO
         2 007256   201346 237100                    LDAQ    LFPT_PRECORD+12,,AUTO
         2 007257   201352 757100                    STAQ    LFPT_PRECORD+16,,AUTO
         2 007260   201354 237100                    LDAQ    LFPT_PRECORD+18,,AUTO
         2 007261   201356 757100                    STAQ    LFPT_PRECORD+20,,AUTO
         2 007262   201356 630500                    EPPR0   LFPT_PRECORD+20,,AUTO
         2 007263   201362 450500                    STP0    LFPT_PRECORD+24,,AUTO
         2 007264   201352 631500                    EPPR1   LFPT_PRECORD+16,,AUTO
         2 007265   201361 451500                    STP1    LFPT_PRECORD+23,,AUTO
         2 007266   000062 236000 3                  LDQ     50
         2 007267   201360 756100                    STQ     LFPT_PRECORD+22,,AUTO
         2 007270   201360 630500                    EPPR0   LFPT_PRECORD+22,,AUTO
         2 007271   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 007272   000000 701000 xent               TSX1    CPJ$WRITE_REC
         2 007273   007301 702000 2                  TSX2    E_WRITE_CHECK

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:309  
     2112    14243    2             ALTRET(E_WRITE_CHECK) ;
     2113    14244    2         B$JIT.CPFLAGS1.SOMENOTIFY = %YES# ;

  14244  2 007274   000000 470400 xsym               LDP0    B$JIT$
         2 007275   000040 236003                    LDQ     32,DU
         2 007276   000143 256100                    ORSQ    99,,PR0

     2114    14245
     2115    14246    2         RETURN ;

  14246  2 007277   201330 221300                    LDX1  ! FID_SN,,AUTO
         2 007300   000001 702211                    TSX2  ! 1,X1

     2116    14247    2   E_WRITE_CHECK:
     2117    14248    2         CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR,,M$IBEX1_NUM) ;

  14248  2 007301   000000 236000 xsym  E_WRITE_CHE* LDQ     SEG2$
         2 007302   000003 036003                    ADLQ    3,DU
         2 007303   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 007304   000007 236000 3                  LDQ     7
         2 007305   000001 235000 xsym               LDA     B_VECTNIL+1
         2 007306   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 007307   000000 236000 xsym               LDQ     B$JIT$
         2 007310   000144 036003                    ADLQ    100,DU
         2 007311   000035 235000 3                  LDA     29
         2 007312   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 007313   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 007314   201345 450500                    STP0    LFPT_PRECORD+11,,AUTO
         2 007315   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 007316   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 007317   000000 701000 xent               TSX1    CXP$POSTERR
         2 007320   000000 011000                    NOP     0

     2118    14249
     2119    14250    2   E_OPEN_USE:
     2120    14251    2         ALTRETURN ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:310  
  14251  2 007321   201330 221300       E_OPEN_USE   LDX1  ! FID_SN,,AUTO
         2 007322   000000 702211                    TSX2  ! 0,X1

     2121    14252
     2122    14253    2   END   WRITE_USEFILE_REC ;
     2123    14254        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:311  
     2124    14255    1   OPEN_USEFILE: PROC  ALTRET ;

  14255  2 007323   201332 741300       OPEN_USEFILE STX1  ! FID_SN+2,,AUTO

     2125    14256
     2126    14257    2         FPT_CLOSE.V.DCB# = M$IBEX_NUM ;

  14257  2 007324   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 007325   200724 740100                    STX0    FPT_CLOSE+26,,AUTO

     2127    14258    2         IF DCBADDR(M$IBEX_NUM) -> F$DCB.FCD#

  14258  2 007326   000036 470400 3                  LDP0    30
         2 007327   000000 471500                    LDP1    0,,PR0
         2 007330   100000 473510                    LDP3    0,X0,PR1
         2 007331   300031 236100                    LDQ     25,,PR3
         2 007332   020000 316007                    CANQ    8192,DL
         2 007333   007337 600000 2                  TZE     s:14260

     2128    14259    2             THEN CALL M$CLOSE (FPT_CLOSE) ;

  14259  2 007334   200672 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 007335   050001 713400                    CLIMB   close
         2 007336   406000 401760                    pmme    nvectors=13

     2129    14260    2         CMDSTRM_CLOSED# = %YES# ;

  14260  2 007337   400000 236003                    LDQ     -131072,DU
         2 007340   200122 756100                    STQ     CMDSTRM_CLOSED#,,AUTO

     2130    14261                                                              /* Set up OPEN. */
     2131    14262    2         FPT_OPEN_USE.V.FUN# = %CREATE# ;

  14262  2 007341   003000 236007                    LDQ     1536,DL
         2 007342   200611 552110                    STBQ    FPT_OPEN_USE+37,'10'O,AUTO

     2132    14263    2         FPT_OPEN_USE.V.EXIST# = %OLDFILE# ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:312  

  14263  2 007343   200610 236100                    LDQ     FPT_OPEN_USE+36,,AUTO
         2 007344   000063 376000 3                  ANQ     51
         2 007345   000400 276007                    ORQ     256,DL
         2 007346   200610 756100                    STQ     FPT_OPEN_USE+36,,AUTO

     2133    14264    2         IF (CP_CHFLAGS.USE_RESULTS = '0'B)

  14264  2 007347   000000 106500                    CMPC    fill='000'O
         2 007350   200205 000010                    ADSC9   CP_CHFLAGS+14,,AUTO      cn=0,n=8
         2 007351   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         2 007352   007405 601000 2                  TNZ     s:14275

     2134    14265    2             THEN
     2135    14266    3               DO ;

     2136    14267    3                 TEMPBUF$ = ADDR(TEMPBUF) ;

  14267  2 007353   200020 630500                    EPPR0   TEMPBUF,,AUTO
         2 007354   200011 450500                    STP0    TEMPBUF$,,AUTO

     2137    14268    3                 TEMPBUF$ -> P$S.COUNT = 6 ;

  14268  2 007355   006000 236003                    LDQ     3072,DU
         2 007356   000004 552140                    STBQ    4,'40'O,PR0

     2138    14269    3                 TEMPBUF$ -> P$S.TEXT = '*$$JOB' ;

  14269  2 007357   200011 470500                    LDP0    TEMPBUF$,,AUTO
         2 007360   000004 236100                    LDQ     4,,PR0
         2 007361   000033 772000                    QRL     27
         2 007362   000000 620006                    EAX0    0,QL
         2 007363   040140 100400                    MLR     fill='040'O
         2 007364   000277 000006 1                  ADSC9   JOBSTATS_ACCT+2          cn=0,n=6
         2 007365   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0

     2139    14270    3                 TEMPBUF$ -> P$S.TEXTC$ = ADDR(TEMPBUF$->P$S.COUNT) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:313  

  14270  2 007366   200011 236100                    LDQ     TEMPBUF$,,AUTO
         2 007367   000004 036003                    ADLQ    4,DU
         2 007370   200011 470500                    LDP0    TEMPBUF$,,AUTO
         2 007371   000003 756100                    STQ     3,,PR0

     2140    14271    3                 CALL CPC$MFID_OPEN(FPT_OPEN_USE,TEMPBUF$,CP_FIDVLPS)

  14271  2 007372   200320 630500                    EPPR0   CP_FIDVLPS,,AUTO
         2 007373   201346 450500                    STP0    LFPT_PRECORD+12,,AUTO
         2 007374   200011 631500                    EPPR1   TEMPBUF$,,AUTO
         2 007375   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 007376   200544 633500                    EPPR3   FPT_OPEN_USE,,AUTO
         2 007377   201344 453500                    STP3    LFPT_PRECORD+10,,AUTO
         2 007400   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 007401   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 007402   000000 701000 xent               TSX1    CPC$MFID_OPEN
         2 007403   007433 702000 2                  TSX2    E_OPEN_ALTRET

     2141    14272    3                           ALTRET(E_OPEN_ALTRET) ;
     2142    14273    3               END ; /* THEN DO */

  14273  2 007404   007417 710000 2                  TRA     s:14278

     2143    14274    2             ELSE
     2144    14275    2               CALL CPC$FID_OPEN(FPT_OPEN_USE,,CP_FIDVLPS)

  14275  2 007405   200320 630500                    EPPR0   CP_FIDVLPS,,AUTO
         2 007406   201346 450500                    STP0    LFPT_PRECORD+12,,AUTO
         2 007407   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 007410   201345 756100                    STQ     LFPT_PRECORD+11,,AUTO
         2 007411   200544 631500                    EPPR1   FPT_OPEN_USE,,AUTO
         2 007412   201344 451500                    STP1    LFPT_PRECORD+10,,AUTO
         2 007413   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 007414   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 007415   000000 701000 xent               TSX1    CPC$FID_OPEN
         2 007416   007433 702000 2                  TSX2    E_OPEN_ALTRET
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:314  

     2145    14276    2                           ALTRET(E_OPEN_ALTRET) ;
     2146    14277
     2147    14278    2         CP_CHFLAGS.USE_RES = CP_FIDVLPS.FID_RES ;

  14278  2 007417   200334 220100                    LDX0    CP_FIDVLPS+12,,AUTO
         2 007420   200216 740100                    STX0    CP_CHFLAGS+23,,AUTO

     2148    14279    2         CP_CHFLAGS.USE_ASN = CP_FIDVLPS.FID_ASN ;

  14279  2 007421   200335 236100                    LDQ     CP_FIDVLPS+13,,AUTO
         2 007422   000022 772000                    QRL     18
         2 007423   200216 552110                    STBQ    CP_CHFLAGS+23,'10'O,AUTO

     2149    14280    2         CP_CHFLAGS.USE_RESULTS = CP_FIDVLPS.FID_RESULTS ;

  14280  2 007424   200332 237100                    LDAQ    CP_FIDVLPS+10,,AUTO
         2 007425   200205 755100                    STA     CP_CHFLAGS+14,,AUTO
         2 007426   200206 756100                    STQ     CP_CHFLAGS+15,,AUTO

     2150    14281    2         USEFID_OPEN# = %YES# ;

  14281  2 007427   400000 236003                    LDQ     -131072,DU
         2 007430   200121 756100                    STQ     USEFID_OPEN#,,AUTO

     2151    14282
     2152    14283    2         RETURN ;

  14283  2 007431   201332 221300                    LDX1  ! FID_SN+2,,AUTO
         2 007432   000001 702211                    TSX2  ! 1,X1

     2153    14284
     2154    14285    2   E_OPEN_ALTRET:
     2155    14286    2         ADDR(SEG$2.ERRBUF) -> ERR$BLK.FIRST = 0;

  14286  2 007433   000000 470400 xsym  E_OPEN_ALTR* LDP0    SEG2$
         2 007434   000004 450100                    STZ     4,,PR0
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:315  

     2156    14287    2         ADDR(SEG$2.ERRBUF) -> ERR$BLK.NEXT = 0;

  14287  2 007435   000005 450100                    STZ     5,,PR0

     2157    14288    2         CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_CHKBADUSEFSPEC,,M$IBEX_NUM) ;

  14288  2 007436   000000 236000 xsym               LDQ     SEG2$
         2 007437   000003 036003                    ADLQ    3,DU
         2 007440   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 007441   000062 236000 3                  LDQ     50
         2 007442   000001 235000 xsym               LDA     B_VECTNIL+1
         2 007443   201350 757100                    STAQ    LFPT_PRECORD+14,,AUTO
         2 007444   000064 237000 3                  LDAQ    52
         2 007445   201346 757100                    STAQ    LFPT_PRECORD+12,,AUTO
         2 007446   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 007447   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 007450   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 007451   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 007452   000000 701000 xent               TSX1    CXP$POSTERR
         2 007453   000000 011000                    NOP     0

     2158    14289    2         CALL CPR$RPTERR (SEG$2.ERRBUF, 511) ;

  14289  2 007454   000035 236000 3                  LDQ     29
         2 007455   201345 756100                    STQ     LFPT_PRECORD+11,,AUTO
         2 007456   000000 236000 xsym               LDQ     SEG2$
         2 007457   000003 036003                    ADLQ    3,DU
         2 007460   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 007461   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 007462   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 007463   000000 701000 xent               TSX1    CPR$RPTERR
         2 007464   000000 011000                    NOP     0

     2159    14290    2         ADDR(SEG$2.ERRBUF) -> ERR$BLK.FIRST = 0;

  14290  2 007465   000000 470400 xsym               LDP0    SEG2$
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:316  
         2 007466   000004 450100                    STZ     4,,PR0

     2160    14291    2         ADDR(SEG$2.ERRBUF) -> ERR$BLK.NEXT = 0;

  14291  2 007467   000005 450100                    STZ     5,,PR0

     2161    14292    2         UNWIND TO BAD_USEFILE_REMEM ;

  14292  2 007470   200160 237300                    LDAQ  ! BAD_USEFILE_REMEM,,AUTO
         2 007471   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 007472   000000 000200                    ZERO    0,128

     2162    14293
     2163    14294        /*E*       ERROR:   CPK-E$CHKBADUSEFSPEC-C
     2164    14295                   MESSAGE: CHECK/NOTIFY unable to USE file% %UF%.
     2165    14296                   DESCRIPTION: CHECK/NOTIFY tried to access a USE file that the user
     2166    14297                                did not have access to.
     2167    14298        */
     2168    14299
     2169    14300    2   END OPEN_USEFILE ;
     2170    14301        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:317  
     2171    14302    1   COMPARE_STATUS: PROC    ALTRET ;

  14302  2 007473   201324 741300       COMPARE_STA* STX1  ! HDR_MSG#,,AUTO

     2172    14303
     2173    14304              /* COMPARE_STATUS is a routine to see if the status of
     2174    14305                  the CHECKed job has changed since the last time it
     2175    14306                  was CHECKed.  It there is NO CHANGE, then RETURN
     2176    14307                  normally, else ALTRETURN.
     2177    14308              */
     2178    14309    2         FPT_JOBSTATS_STATUS = CFPT_JOBSTATS ;

  14309  2 007474   000100 100400                    MLR     fill='000'O
         2 007475   000000 000220 xsym               ADSC9   CFPT_JOBSTATS            cn=0,n=144
         2 007476   201024 000220                    ADSC9   FPT_JOBSTATS_STATUS,,AUTO cn=0,n=144

     2179    14310    2         FPT_JOBSTATS_STATUS.V_ = VECTOR(FPT_JOBSTATS_STATUS.V) ;

  14310  2 007477   000000 235000 3                  LDA     0
         2 007500   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 007501   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 007502   001054 036003                    ADLQ    556,DU
         2 007503   201024 757100                    STAQ    FPT_JOBSTATS_STATUS,,AUTO

     2180    14311    2         FPT_JOBSTATS_STATUS.V.SYSID# = CHKEYBUF.SYSID ;

  14311  2 007504   200336 235100                    LDA     CHKEYBUF,,AUTO
         2 007505   200337 236100                    LDQ     CHKEYBUF+1,,AUTO
         2 007506   000033 773000                    LRL     27
         2 007507   201055 756100                    STQ     FPT_JOBSTATS_STATUS+25,,AUTO

     2181    14312    2         IF OUTPUT_FLG

  14312  2 007510   200142 234100                    SZN     OUTPUT_FLG,,AUTO
         2 007511   007522 605000 2                  TPL     s:14319

     2182    14313    2             THEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:318  
     2183    14314    3               DO ;

     2184    14315    3                 FPT_JOBSTATS_STATUS.V.ORDER# = %CHECKF# ;

  14315  2 007512   000007 235007                    LDA     7,DL
         2 007513   201054 755100                    STA     FPT_JOBSTATS_STATUS+24,,AUTO

     2185    14316    3                 FPT_JOBSTATS_STATUS.V.NUM# = CHKEYBUF.NUM ;

  14316  2 007514   200337 235100                    LDA     CHKEYBUF+1,,AUTO
         2 007515   200340 236100                    LDQ     CHKEYBUF+2,,AUTO
         2 007516   000033 773000                    LRL     27
         2 007517   000000 620006                    EAX0    0,QL
         2 007520   201060 740100                    STX0    FPT_JOBSTATS_STATUS+28,,AUTO

     2186    14317    3               END ; /* THEN DO */

  14317  2 007521   007524 710000 2                  TRA     s:14320

     2187    14318    2             ELSE
     2188    14319    2               FPT_JOBSTATS_STATUS.V.ORDER# = %CHECK# ;

  14319  2 007522   000001 235007                    LDA     1,DL
         2 007523   201054 755100                    STA     FPT_JOBSTATS_STATUS+24,,AUTO

     2189    14320    2         FPT_JOBSTATS_STATUS.RESULTS_ = VECTOR(VLR_JOBSTATS_CHECK) ;

  14320  2 007524   000000 235000 3                  LDA     0
         2 007525   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 007526   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 007527   001262 036003                    ADLQ    690,DU
         2 007530   201030 757100                    STAQ    FPT_JOBSTATS_STATUS+4,,AUTO

     2190    14321
     2191    14322    2         CALL M$JOBSTATS(FPT_JOBSTATS_STATUS) ALTRET(E_CHECKSTATUS) ;

  14322  2 007531   201024 630500                    EPPR0   FPT_JOBSTATS_STATUS,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:319  
         2 007532   570001 713400                    CLIMB   alt,+61441
         2 007533   405400 401760                    pmme    nvectors=12
         2 007534   007627 702000 2                  TSX2    E_CHECKSTATUS

     2192    14323
     2193    14324    2         ASYSIDBUF.STATUS = SYSIDBUF.STATUS ;

  14324  2 007535   000100 100500                    MLR     fill='000'O
         2 007536   200344 000014                    ADSC9   SYSIDBUF,,AUTO           cn=0,n=12
         2 007537   200367 000014                    ADSC9   ASYSIDBUF,,AUTO          cn=0,n=12

     2194    14325    2         IF OUTPUT_FLG

  14325  2 007540   200142 234100                    SZN     OUTPUT_FLG,,AUTO
         2 007541   007554 605000 2                  TPL     s:14335

     2195    14326    2             THEN
     2196    14327    3               DO ;

     2197    14328    3                 ASYSIDBUF.STATUS.CODE = VLR_JOBSTATS_CHECK.FCODE ;

  14328  2 007542   201266 235100                    LDA     VLR_JOBSTATS_CHECK+4,,AUTO
         2 007543   000022 771000                    ARL     18
         2 007544   200367 755100                    STA     ASYSIDBUF,,AUTO

     2198    14329    3                 IF ASYSIDBUF.STATUS.CODE = %FS_PRT#

  14329  2 007545   000003 115007                    CMPA    3,DL
         2 007546   007551 601000 2                  TNZ     s:14331

     2199    14330    3                   THEN ASYSIDBUF.STATUS.TORUN = 0 ;

  14330  2 007547   200371 450100                    STZ     ASYSIDBUF+2,,AUTO
         2 007550   007571 710000 2                  TRA     s:14344

     2200    14331    3                   ELSE ASYSIDBUF.STATUS.TORUN = VLR_JOBSTATS_CHECK.AHEAD ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:320  
  14331  2 007551   201264 236100                    LDQ     VLR_JOBSTATS_CHECK+2,,AUTO
         2 007552   200371 756100                    STQ     ASYSIDBUF+2,,AUTO

     2201    14332    3               END ; /* THEN DO */

  14332  2 007553   007571 710000 2                  TRA     s:14344

     2202    14333    2             ELSE
     2203    14334    3               DO ;

     2204    14335    3                 ASYSIDBUF.STATUS.CODE = VLR_JOBSTATS_CHECK.CODE ;

  14335  2 007554   201262 235100                    LDA     VLR_JOBSTATS_CHECK,,AUTO
         2 007555   200367 755100                    STA     ASYSIDBUF,,AUTO

     2205    14336    3                 IF VLR_JOBSTATS_CHECK.PRIO <= 15 AND VLR_JOBSTATS_CHECK.CODE = %
             14336                          JS_WAIT#

  14336  2 007556   201263 236100                    LDQ     VLR_JOBSTATS_CHECK+1,,AUTO
         2 007557   000777 376007                    ANQ     511,DL
         2 007560   000020 116007                    CMPQ    16,DL
         2 007561   007566 603000 2                  TRC     s:14339
         2 007562   000001 115007                    CMPA    1,DL
         2 007563   007566 601000 2                  TNZ     s:14339

     2206    14337    3                   THEN
     2207    14338    3                     ASYSIDBUF.STATUS.TORUN = VLR_JOBSTATS_CHECK.AHEAD ;

  14338  2 007564   201264 235100                    LDA     VLR_JOBSTATS_CHECK+2,,AUTO
         2 007565   200371 755100                    STA     ASYSIDBUF+2,,AUTO

     2208    14339    3                 IF VLR_JOBSTATS_CHECK.PRIO = %JP_RUNAFTER#

  14339  2 007566   000022 116007                    CMPQ    18,DL
         2 007567   007571 601000 2                  TNZ     s:14344

     2209    14340    3                   THEN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:321  
     2210    14341    3                     NRECS_SKIP = NRECS_SKIP + 1 ;

  14341  2 007570   200156 054100                    AOS     NRECS_SKIP,,AUTO

     2211    14342    3               END ; /* ELSE DO */

     2212    14343                                           /* Anything not PRINTing or WAITing to PRINT? */
     2213    14344    2         IF VLR_JOBSTATS_CHECK.CODE = %JS_RUN#   OR

  14344  2 007571   201262 235100                    LDA     VLR_JOBSTATS_CHECK,,AUTO
         2 007572   000002 115007                    CMPA    2,DL
         2 007573   007604 600000 2                  TZE     s:14348
         2 007574   000007 115007                    CMPA    7,DL
         2 007575   007604 600000 2                  TZE     s:14348
         2 007576   000001 115007                    CMPA    1,DL
         2 007577   007606 601000 2                  TNZ     s:14350
         2 007600   201263 236100                    LDQ     VLR_JOBSTATS_CHECK+1,,AUTO
         2 007601   000777 376007                    ANQ     511,DL
         2 007602   000022 116007                    CMPQ    18,DL
         2 007603   007606 600000 2                  TZE     s:14350

     2214    14345    2             VLR_JOBSTATS_CHECK.CODE= %JS_AP#   OR
     2215    14346    2               (VLR_JOBSTATS_CHECK.CODE= %JS_WAIT# AND
     2216    14347    2               VLR_JOBSTATS_CHECK.PRIO~= %JP_RUNAFTER#)
     2217    14348    2               THEN MORE_2_WAIT = %YES# ;      /* Yes! */

  14348  2 007604   400000 236003                    LDQ     -131072,DU
         2 007605   200134 756100                    STQ     MORE_2_WAIT,,AUTO

     2218    14349
     2219    14350    2         IF SYSIDBUF.STATUS.CODE = 0 AND

  14350  2 007606   200344 236100                    LDQ     SYSIDBUF,,AUTO
         2 007607   007621 601000 2                  TNZ     s:14356
         2 007610   200345 235100                    LDA     SYSIDBUF+1,,AUTO
         2 007611   007621 601000 2                  TNZ     s:14356
         2 007612   200346 235100                    LDA     SYSIDBUF+2,,AUTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:322  
         2 007613   007621 601000 2                  TNZ     s:14356
         2 007614   200142 234100                    SZN     OUTPUT_FLG,,AUTO
         2 007615   007621 604000 2                  TMI     s:14356

     2220    14351    2             SYSIDBUF.STATUS.PRIO = 0 AND
     2221    14352    2             SYSIDBUF.STATUS.TORUN = 0 AND
     2222    14353    2             NOT OUTPUT_FLG
     2223    14354    2             THEN SYSIDBUF.STATUS = ASYSIDBUF.STATUS ;   /* First compare. */

  14354  2 007616   000100 100500                    MLR     fill='000'O
         2 007617   200367 000014                    ADSC9   ASYSIDBUF,,AUTO          cn=0,n=12
         2 007620   200344 000014                    ADSC9   SYSIDBUF,,AUTO           cn=0,n=12

     2224    14355
     2225    14356    2         IF ASYSIDBUF.STATUS = SYSIDBUF.STATUS

  14356  2 007621   000100 106500                    CMPC    fill='000'O
         2 007622   200367 000014                    ADSC9   ASYSIDBUF,,AUTO          cn=0,n=12
         2 007623   200344 000014                    ADSC9   SYSIDBUF,,AUTO           cn=0,n=12
         2 007624   007627 601000 2                  TNZ     E_CHECKSTATUS

     2226    14357    2             THEN                                        /* Status the same. */
     2227    14358    2               ALTRETURN ;

  14358  2 007625   201324 221300                    LDX1  ! HDR_MSG#,,AUTO
         2 007626   000000 702211                    TSX2  ! 0,X1

     2228    14359
     2229    14360    2   E_CHECKSTATUS:
     2230    14361    2         SYSIDBUF.STATUS = ASYSIDBUF.STATUS ;            /* Status has changed. */

  14361  2 007627   000100 100500       E_CHECKSTAT* MLR     fill='000'O
         2 007630   200367 000014                    ADSC9   ASYSIDBUF,,AUTO          cn=0,n=12
         2 007631   200344 000014                    ADSC9   SYSIDBUF,,AUTO           cn=0,n=12

     2231    14362    2         RETURN ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:323  
  14362  2 007632   201324 221300                    LDX1  ! HDR_MSG#,,AUTO
         2 007633   000001 702211                    TSX2  ! 1,X1

     2232    14363
     2233    14364    2   END   COMPARE_STATUS ;
     2234    14365        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:324  
     2235    14366    1   SETUP_DUMMY_SUBMIT_MESS: PROC ;

  14366  2 007634   201326 741300       SETUP_DUMMY* STX1  ! @CHKEYBUF+1,,AUTO

     2236    14367
     2237    14368    2     VLR_JOBSTATS_CHECK = %NO# ;

  14368  2 007635   000100 100400                    MLR     fill='000'O
         2 007636   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 007637   201262 000054                    ADSC9   VLR_JOBSTATS_CHECK,,AUTO cn=0,n=44

     2238    14369    2     CALL CHARBIN(TEMP,P$->P$B.SUBLK$(0)->P$S.TEXTC$->TEXTC.TEXT) ;

  14369  2 007640   200004 470500                    LDP0    P$,,AUTO
         2 007641   000003 471500                    LDP1    3,,PR0
         2 007642   100003 473500                    LDP3    3,,PR1
         2 007643   000100 101500                    MRL     fill='000'O
         2 007644   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 007645   201344 000002                    ADSC9   LFPT_PRECORD+10,,AUTO    cn=0,n=2
         2 007646   201344 220100                    LDX0    LFPT_PRECORD+10,,AUTO
         2 007647   000100 305540                    DTB
         2 007650   300000 230010                    NDSC9   0,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
         2 007651   201346 000010                    NDSC9   LFPT_PRECORD+12,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 007652   201347 235100                    LDA     LFPT_PRECORD+13,,AUTO
         2 007653   200147 755100                    STA     TEMP,,AUTO

     2239    14370    2     VLR_JOBSTATS_CHECK.SYSID = TEMP ;

  14370  2 007654   201265 755100                    STA     VLR_JOBSTATS_CHECK+3,,AUTO

     2240    14371    2     CH_XFORMAT.COMMENT# = ' ' ;

  14371  2 007655   040100 100400                    MLR     fill='040'O
         2 007656   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 007657   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24

     2241    14372    2     VLP_JOBNAME.JOBNAME# = ' ' ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:325  

  14372  2 007660   040100 100400                    MLR     fill='040'O
         2 007661   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 007662   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31

     2242    14373    2     RETURN ;

  14373  2 007663   000001 702211                    TSX2  ! 1,X1

     2243    14374
     2244    14375    2   END   SETUP_DUMMY_SUBMIT_MESS ;
     2245    14376        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:326  
     2246    14377    1   PRINT_SUBMIT_MESS:  PROC ;

  14377  2 007664   201326 741300       PRINT_SUBMI* STX1  ! @CHKEYBUF+1,,AUTO

     2247    14378
     2248    14379    2     CH_XFORMAT.MSG# = %CP_APRESCAN_MESS ;

  14379  2 007665   000015 235007                    LDA     13,DL
         2 007666   200412 755100                    STA     CH_XFORMAT,,AUTO

     2249    14380    2     CH_XFORMAT.SYSID# = VLR_JOBSTATS_CHECK.SYSID ;

  14380  2 007667   201265 236100                    LDQ     VLR_JOBSTATS_CHECK+3,,AUTO
         2 007670   200413 756100                    STQ     CH_XFORMAT+1,,AUTO

     2250    14381    2     CH_XFORMAT.NUM# = 0 ;

  14381  2 007671   200426 450100                    STZ     CH_XFORMAT+12,,AUTO

     2251    14382    2     CH_XFORMAT.JOBNAME# = VLP_JOBNAME.JOBNAME# ;

  14382  2 007672   040100 100500                    MLR     fill='040'O
         2 007673   201252 200037                    ADSC9   VLP_JOBNAME,,AUTO        cn=1,n=31
         2 007674   200416 000037                    ADSC9   CH_XFORMAT+4,,AUTO       cn=0,n=31

     2252    14383    2     CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;

  14383  2 007675   200412 630500                    EPPR0   CH_XFORMAT,,AUTO
         2 007676   201344 450500                    STP0    LFPT_PRECORD+10,,AUTO
         2 007677   201344 630500                    EPPR0   LFPT_PRECORD+10,,AUTO
         2 007700   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 007701   000000 701000 xent               TSX1    CPK$CHECK_OUTPUT
         2 007702   000000 011000                    NOP     0

     2253    14384                                                              /* Save SYSID */
     2254    14385    2     CHKEYBUF = CP_C_CHKEYBUF ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:327  
  14385  2 007703   000100 100400                    MLR     fill='000'O
         2 007704   000010 000011 1                  ADSC9   CP_C_CHKEYBUF            cn=0,n=9
         2 007705   200336 000011                    ADSC9   CHKEYBUF,,AUTO           cn=0,n=9

     2255    14386                                                              /* Setup key */
     2256    14387    2     CHKEYBUF.SYSID = VLR_JOBSTATS_CHECK.SYSID ;

  14387  2 007706   000100 100500                    MLR     fill='000'O
         2 007707   201265 000004                    ADSC9   VLR_JOBSTATS_CHECK+3,,AUTO cn=0,n=4
         2 007710   200336 200004                    ADSC9   CHKEYBUF,,AUTO           cn=1,n=4

     2257    14388    2     CHKEYBUF.NUM = 0 ;

  14388  2 007711   000100 100400                    MLR     fill='000'O
         2 007712   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         2 007713   200337 200004                    ADSC9   CHKEYBUF+1,,AUTO         cn=1,n=4

     2258    14389    2     SYSIDBUF.STATUS.CODE = VLR_JOBSTATS_CHECK.CODE ;

  14389  2 007714   201262 235100                    LDA     VLR_JOBSTATS_CHECK,,AUTO
         2 007715   200344 755100                    STA     SYSIDBUF,,AUTO

     2259    14390    2     SYSIDBUF.STATUS.PRIO = VLR_JOBSTATS_CHECK.PRIO ;

  14390  2 007716   201263 236100                    LDQ     VLR_JOBSTATS_CHECK+1,,AUTO
         2 007717   000777 376007                    ANQ     511,DL
         2 007720   200345 756100                    STQ     SYSIDBUF+1,,AUTO

     2260    14391    2     SYSIDBUF.STATUS.TORUN = VLR_JOBSTATS_CHECK.AHEAD ;

  14391  2 007721   201264 235100                    LDA     VLR_JOBSTATS_CHECK+2,,AUTO
         2 007722   200346 755100                    STA     SYSIDBUF+2,,AUTO

     2261    14392    2     SYSIDBUF.ACCT = ' ' ;

  14392  2 007723   000035 235000 xsym               LDA     B_VECTNIL+29
         2 007724   000035 236000 xsym               LDQ     B_VECTNIL+29
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:328  
         2 007725   200347 755100                    STA     SYSIDBUF+3,,AUTO
         2 007726   200350 756100                    STQ     SYSIDBUF+4,,AUTO

     2262    14393    2     SYSIDBUF.JNAME = ' ' ;

  14393  2 007727   040100 100400                    MLR     fill='040'O
         2 007730   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 007731   200351 000037                    ADSC9   SYSIDBUF+5,,AUTO         cn=0,n=31

     2263    14394    2     SYSIDBUF.COMMENT = CH_XFORMAT.COMMENT# ;

  14394  2 007732   040100 100500                    MLR     fill='040'O
         2 007733   200431 000030                    ADSC9   CH_XFORMAT+15,,AUTO      cn=0,n=24
         2 007734   200360 600030                    ADSC9   SYSIDBUF+12,,AUTO        cn=3,n=24

     2264    14395                                                              /* Write out record. */
     2265    14396    2     CALL WRITE_USEFILE_REC ALTRET(E_WRITE_CHECK) ;

  14396  2 007735   007225 701000 2                  TSX1    WRITE_USEFILE_REC
         2 007736   007737 702000 2                  TSX2    E_WRITE_CHECK

     2266    14397    2   E_WRITE_CHECK:
     2267    14398    2     RETURN ;

  14398  2 007737   201326 221300       E_WRITE_CHE* LDX1  ! @CHKEYBUF+1,,AUTO
         2 007740   000001 702211                    TSX2  ! 1,X1

     2268    14399
     2269    14400    2   END   PRINT_SUBMIT_MESS ;
     2270    14401        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:329  
     2271    14402    1   READ_OUTPUT_RECORD:  PROC (CHKEYBUF) ALTRET ;

  14402  2 007741   201324 741300       READ_OUTPUT* STX1  ! HDR_MSG#,,AUTO

     2272    14403
     2273    14404        %CP_CHKEYBUF                            ( FPTN = CHKEYBUF,
     2274    14405              STCLASS = PARAM) ;
     2275    14423        %CP_CHKEYBUF                            ( FPTN = TCHKEYBUF,
     2276    14424              STCLASS = AUTO) ;
     2277    14442        %FPT_PRECORD (FPTN=LFPT_PRECORD, STCLASS=AUTO) ;
     2278    14463
     2279    14464    2         TCHKEYBUF = CP_C_CHKEYBUF ;

  14464  2 007742   000100 100400                    MLR     fill='000'O
         2 007743   000010 000011 1                  ADSC9   CP_C_CHKEYBUF            cn=0,n=9
         2 007744   201326 000011                    ADSC9   TCHKEYBUF,,AUTO          cn=0,n=9

     2280    14465    2         TCHKEYBUF.SYSID = CHKEYBUF.SYSID ;

  14465  2 007745   201325 470500                    LDP0    @CHKEYBUF,,AUTO
         2 007746   000100 100500                    MLR     fill='000'O
         2 007747   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4
         2 007750   201326 200004                    ADSC9   TCHKEYBUF,,AUTO          cn=1,n=4

     2281    14466    2         TCHKEYBUF.NUM = CHKEYBUF.NUM ;

  14466  2 007751   000100 100500                    MLR     fill='000'O
         2 007752   000001 200004                    ADSC9   1,,PR0                   cn=1,n=4
         2 007753   201327 200004                    ADSC9   TCHKEYBUF+1,,AUTO        cn=1,n=4

     2282    14467
     2283    14468    2         LFPT_PRECORD = FPT_PRECORD ;

  14468  2 007754   000100 100500                    MLR     fill='000'O
         2 007755   200746 000050                    ADSC9   FPT_PRECORD,,AUTO        cn=0,n=40
         2 007756   201332 000050                    ADSC9   LFPT_PRECORD,,AUTO       cn=0,n=40

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:330  
     2284    14469    2         LFPT_PRECORD.V_ = VECTOR(LFPT_PRECORD.V) ;

  14469  2 007757   000001 235000 3                  LDA     1
         2 007760   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 007761   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 007762   001340 036003                    ADLQ    736,DU
         2 007763   201332 757100                    STAQ    LFPT_PRECORD,,AUTO

     2285    14470    2         LFPT_PRECORD.KEY_ = VECTOR(TCHKEYBUF) ;

  14470  2 007764   000006 235000 3                  LDA     6
         2 007765   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 007766   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 007767   001326 036003                    ADLQ    726,DU
         2 007770   201334 757100                    STAQ    LFPT_PRECORD+2,,AUTO

     2286    14471
     2287    14472    3         CALL M$PRECORD(LFPT_PRECORD) WHENALTRETURN DO ;

  14472  2 007771   201332 630500                    EPPR0   LFPT_PRECORD,,AUTO
         2 007772   440003 713400                    CLIMB   alt,+16387
         2 007773   401000 401760                    pmme    nvectors=3
         2 007774   007776 702000 2                  TSX2    s:14475
         2 007775   007776 710000 2                  TRA     s:14475

     2288    14473    3                                     END ;

     2289    14474                                                        /* Set up FPT_READ_USE. */
     2290    14475    2         FPT_READ_USE = CFPT_READ ;

  14475  2 007776   000100 100400                    MLR     fill='000'O
         2 007777   000000 000070 xsym               ADSC9   CFPT_READ                cn=0,n=56
         2 010000   200636 000070                    ADSC9   FPT_READ_USE,,AUTO       cn=0,n=56

     2291    14476    2         FPT_READ_USE.V_ = VECTOR(FPT_READ_USE.V) ;

  14476  2 010001   000004 235000 3                  LDA     4
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:331  
         2 010002   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 010003   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 010004   000646 036003                    ADLQ    422,DU
         2 010005   200636 757100                    STAQ    FPT_READ_USE,,AUTO

     2292    14477    2         FPT_READ_USE.BUF_ = VECTOR(SYSIDBUF) ;

  14477  2 010006   000037 235000 3                  LDA     31
         2 010007   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 010010   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 010011   000344 036003                    ADLQ    228,DU
         2 010012   200642 757100                    STAQ    FPT_READ_USE+4,,AUTO

     2293    14478    2         FPT_READ_USE.KEY_ = VECTOR(TCHKEYBUF) ;

  14478  2 010013   000006 235000 3                  LDA     6
         2 010014   201344 452500                    STP2    LFPT_PRECORD+10,,AUTO
         2 010015   201344 236100                    LDQ     LFPT_PRECORD+10,,AUTO
         2 010016   001326 036003                    ADLQ    726,DU
         2 010017   200640 757100                    STAQ    FPT_READ_USE+2,,AUTO

     2294    14479    2         FPT_READ_USE.V.KEYS# = %NO# ;

  14479  2 010020   000033 236000 3                  LDQ     27
         2 010021   200646 356100                    ANSQ    FPT_READ_USE+8,,AUTO

     2295    14480    2         FPT_READ_USE.V.KEYR# = %YES# ;

  14480  2 010022   100000 236007                    LDQ     32768,DL
         2 010023   200646 256100                    ORSQ    FPT_READ_USE+8,,AUTO

     2296    14481    2         FPT_READ_USE.V.DCB# = M$IBEX_NUM ;

  14481  2 010024   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 010025   200646 740100                    STX0    FPT_READ_USE+8,,AUTO

     2297    14482    2         CALL M$READ(FPT_READ_USE) ALTRET (READ_ERR) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:332  

  14482  2 010026   200636 630500                    EPPR0   FPT_READ_USE,,AUTO
         2 010027   440000 713400                    CLIMB   alt,read
         2 010030   401400 401760                    pmme    nvectors=4
         2 010031   010070 702000 2                  TSX2    READ_ERR

     2298    14483
     2299    14484    2         IF TCHKEYBUF.SYSID = CHKEYBUF.SYSID AND TCHKEYBUF.NUM = CHKEYBUF.NUM

  14484  2 010032   201325 470500                    LDP0    @CHKEYBUF,,AUTO
         2 010033   000000 235100                    LDA     0,,PR0
         2 010034   000001 236100                    LDQ     1,,PR0
         2 010035   000033 773000                    LRL     27
         2 010036   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 010037   201326 235100                    LDA     TCHKEYBUF,,AUTO
         2 010040   201327 236100                    LDQ     TCHKEYBUF+1,,AUTO
         2 010041   000033 773000                    LRL     27
         2 010042   201344 116100                    CMPQ    LFPT_PRECORD+10,,AUTO
         2 010043   010061 601000 2                  TNZ     s:14488
         2 010044   000001 235100                    LDA     1,,PR0
         2 010045   000002 236100                    LDQ     2,,PR0
         2 010046   000033 773000                    LRL     27
         2 010047   201345 756100                    STQ     LFPT_PRECORD+11,,AUTO
         2 010050   201327 235100                    LDA     TCHKEYBUF+1,,AUTO
         2 010051   201330 236100                    LDQ     FID_SN,,AUTO
         2 010052   000033 773000                    LRL     27
         2 010053   201345 116100                    CMPQ    LFPT_PRECORD+11,,AUTO
         2 010054   010061 601000 2                  TNZ     s:14488

     2300    14485    2             THEN
     2301    14486    2               CHKEYBUF = TCHKEYBUF ;

  14486  2 010055   000100 100500                    MLR     fill='000'O
         2 010056   201326 000011                    ADSC9   TCHKEYBUF,,AUTO          cn=0,n=9
         2 010057   000000 000011                    ADSC9   0,,PR0                   cn=0,n=9
         2 010060   010064 710000 2                  TRA     READ_OUTPUT_RECORD_RET

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:333  
     2302    14487    2             ELSE
     2303    14488    2               SYSIDBUF.STATUS = '0'B ;

  14488  2 010061   000100 100400                    MLR     fill='000'O
         2 010062   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 010063   200344 000014                    ADSC9   SYSIDBUF,,AUTO           cn=0,n=12

     2304    14489
     2305    14490    2   READ_OUTPUT_RECORD_RET:
     2306    14491    2         B$JIT.USRERR = %NO# ;

  14491  2 010064   000000 470400 xsym  READ_OUTPUT* LDP0    B$JIT$
         2 010065   000144 450100                    STZ     100,,PR0

     2307    14492    2         RETURN ;

  14492  2 010066   201324 221300                    LDX1  ! HDR_MSG#,,AUTO
         2 010067   000001 702211                    TSX2  ! 1,X1

     2308    14493
     2309    14494    2   READ_ERR:
     2310    14495    2         IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY OR B$TCB.ALT$->B$ALT.ERR.CODE = %
             14495                  E$EOF

  14495  2 010070   000000 470400 xsym  READ_ERR     LDP0    B$TCB$
         2 010071   000000 471500                    LDP1    0,,PR0
         2 010072   100102 236100                    LDQ     66,,PR1
         2 010073   377770 376007                    ANQ     131064,DL
         2 010074   001020 116007                    CMPQ    528,DL
         2 010075   010064 600000 2                  TZE     READ_OUTPUT_RECORD_RET
         2 010076   000060 116007                    CMPQ    48,DL
         2 010077   010064 600000 2                  TZE     READ_OUTPUT_RECORD_RET

     2311    14496    2             THEN
     2312    14497    2               GOTO READ_OUTPUT_RECORD_RET ;
     2313    14498
     2314    14499    2         CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$->B$ALT.ERR) ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:334  

  14499  2 010100   000000 236000 xsym               LDQ     SEG2$
         2 010101   000003 036003                    ADLQ    3,DU
         2 010102   201344 756100                    STQ     LFPT_PRECORD+10,,AUTO
         2 010103   100102 633500                    EPPR3   66,,PR1
         2 010104   201347 453500                    STP3    LFPT_PRECORD+13,,AUTO
         2 010105   000035 236000 3                  LDQ     29
         2 010106   201346 756100                    STQ     LFPT_PRECORD+12,,AUTO
         2 010107   201344 631500                    EPPR1   LFPT_PRECORD+10,,AUTO
         2 010110   201345 451500                    STP1    LFPT_PRECORD+11,,AUTO
         2 010111   201345 630500                    EPPR0   LFPT_PRECORD+11,,AUTO
         2 010112   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 010113   000000 701000 xent               TSX1    CXP$POSTERR
         2 010114   000000 011000                    NOP     0

     2315    14500    2         ALTRETURN ;

  14500  2 010115   201324 221300                    LDX1  ! HDR_MSG#,,AUTO
         2 010116   000000 702211                    TSX2  ! 0,X1

     2316    14501
     2317    14502    2   END   READ_OUTPUT_RECORD ;
     2318    14503        %EJECT ;
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:335  
     2319    14504    1   SETUP_HDR_CNT_SZ: PROC ;

  14504  2 010117   201326 741300       SETUP_HDR_C* STX1  ! TCHKEYBUF,,AUTO

     2320    14505
     2321    14506    2     IF DCBADDR(SEG$2.LLDCB#)->F$DCB.ORG# = %TERMINAL# AND

  14506  2 010120   000036 470400 3                  LDP0    30
         2 010121   000000 471500                    LDP1    0,,PR0
         2 010122   000000 473400 xsym               LDP3    SEG2$
         2 010123   300000 720100                    LXL0    0,,PR3
         2 010124   100000 474510                    LDP4    0,X0,PR1
         2 010125   400032 236100                    LDQ     26,,PR4
         2 010126   777000 376003                    ANQ     -512,DU
         2 010127   010000 116003                    CMPQ    4096,DU
         2 010130   010137 601000 2                  TNZ     s:14511
         2 010131   400044 222100                    LDX2    36,,PR4
         2 010132   010137 600000 2                  TZE     s:14511

     2322    14507    2             DCBADDR(SEG$2.LLDCB#)->F$DCB.LINES# ~= 0
     2323    14508    2         THEN
     2324    14509    2             HDR_CNT_SZ = DCBADDR(SEG$2.LLDCB#)->F$DCB.LINES# ;

  14509  2 010133   400044 236100                    LDQ     36,,PR4
         2 010134   000022 772000                    QRL     18
         2 010135   200165 756100                    STQ     HDR_CNT_SZ,,AUTO
         2 010136   010141 710000 2                  TRA     s:14513

     2325    14510    2         ELSE
     2326    14511    2             HDR_CNT_SZ = %DFLT_HDR_CNT_SZ ;

  14511  2 010137   000030 235007                    LDA     24,DL
         2 010140   200165 755100                    STA     HDR_CNT_SZ,,AUTO

     2327    14512
     2328    14513    2     RETURN ;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:336  
  14513  2 010141   000001 702211                    TSX2  ! 1,X1
     2329    14514
     2330    14515    2   END   SETUP_HDR_CNT_SZ ;
     2331    14516    1   END CPK$CHECK;
     2332    14517                   %EOD;

PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:337  
--  Include file information  --

   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPK$CHECK.
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:338  

 **** Variables and constants ****

  ****  Section 001 RoData CPK$CHECK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   164-0-0/d STRC(2088)  r     1 CFPT_OPEN_JOBINFO        266-0-0/d STRC(144)   r     1 CFPT_PFIL
   256-0-0/d STRC(288)   r     1 CFPT_TRMPRG               13-0-0/w STRC(3168)  r     1 CP_C_CHFLAGS
    10-0-0/w STRC(81)    r     1 CP_C_CHKEYBUF            143-0-0/w STRC(27)    r     1 CXSJ_INFOKEY
   144-0-0/w STRC(369)   r     1 CXSJ_NAMEKEY               2-0-0/w STRC        r     1 E_CHKBADUSEF
     3-0-0/w STRC        r     1 E_CHKBADUSEFSPEC           0-0-0/w STRC        r     1 E_CHKNOPRIV
     1-0-0/w STRC        r     1 E_USEFILEBUSY            160-0-0/d STRC(144)   r     1 FPT_PRIV_DISPJOB
   275-0-0/c STRC(72)    r     1 JOBSTATS_ACCT            272-0-0/c STRC(90)    r     1 JOBSTATS_NAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1325-0-0/w PTR         r     1 @CHKEYBUF                  3-0-0/w PTR         r     1 @P$PCB
   367-0-0/w STRC(675)   r     1 ASYSIDBUF                160-0-0/d REMB        r     1 BAD_USEFILE_REMEM
     5-0-0/w PTR         r     1 BLK$                      17-0-0/w PTR         r     1 BUF$
   336-0-0/w STRC(81)    r     1 CHKEYBUF                  *0-0-0/w STRC(81)    r     1 CHKEYBUF
   412-0-0/w STRC(756)   r     1 CH_XFORMAT               122-0-0/w BIT         r     1 CMDSTRM_CLOSED#
   154-0-0/w UBIN        r     1 CMD_CODE                 164-0-0/w UBIN        r     1 CMD_TYPE
   167-0-0/w STRC(3168)  r     1 CP_CHFLAGS               320-0-0/d STRC(477)   r     1 CP_FIDVLPS
   127-0-0/b BIT         r     1 CROSS_ACCT_BATCH_FLG     123-0-0/b BIT         r     1 DELUSEREC
  1321-0-0/w STRC        r     1 ERRCODE                 1200-0-0/c STRC(72)    r     1 FID_ACCT
  1330-0-0/d STRC(90)    r     1 FID_SN                   140-0-0/b BIT         r     1 FIRST_QFLAG
   136-0-0/b BIT         r     1 FORCE                    672-0-0/d STRC(1080)  r     1 FPT_CLOSE
   730-0-0/d STRC(360)   r     1 FPT_DELREC               760-0-0/d STRC(1296)  r     1 FPT_JOBSTATS
  1070-0-0/d STRC(1296)  r     1 FPT_JOBSTATS_CANCEL     1024-0-0/d STRC(1296)  r     1 FPT_JOBSTATS_STATUS
   452-0-0/d STRC(2088)  r     1 FPT_OPEN                 544-0-0/d STRC(2088)  r     1 FPT_OPEN_USE
   742-0-0/d STRC(144)   r     1 FPT_PFIL                 746-0-0/d STRC(360)   r     1 FPT_PRECORD
   654-0-0/d STRC(504)   r     1 FPT_READ_JOBINFO         636-0-0/d STRC(504)   r     1 FPT_READ_USE
  1164-0-0/d STRC(432)   r     1 FPT_TIME                1156-0-0/d STRC(216)   r     1 FPT_WAIT
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:339  
   124-0-0/b BIT         r     1 GET_JOBSTATS#            441-0-0/w UBIN        r     1 HDR_CNT
   165-0-0/w UBIN        r     1 HDR_CNT_SZ              1324-0-0/w UBIN        r     1 HDR_MSG#
   130-0-0/b BIT         r     1 HELD_LINE_NOT_PRINTED
   144-0-0/w SBIN        r     1 I                        145-0-0/w SBIN        r     1 J
   120-0-0/w BIT         r     1 JOBSTATS_OPEN#           143-0-0/b BIT         r     1 JOB_COMPLETED
   146-0-0/w SBIN        r     1 K                       1332-0-0/d STRC(360)   r     1 LFPT_PRECORD
   134-0-0/b BIT         r     1 MORE_2_WAIT             1323-0-0/w UBIN        r     1 MSG#
   166-0-0/w UBIN        r     1 NLINES                   137-0-0/b BIT         r     1 NOTIFYING
   141-0-0/b BIT         r     1 NOTIFY_Q_FLAGS(0:2)
  1321-0-0/b BIT         r     1 NOT_FND                  157-0-0/w SBIN        r     1 NRECS_DEL
   155-0-0/w SBIN        r     1 NRECS_READ               156-0-0/w SBIN        r     1 NRECS_SKIP
   126-0-0/b BIT         r     1 NSTATUS_FLG              440-0-0/w UBIN        r     1 NUM_LISTED
   142-0-0/b BIT         r     1 OUTPUT_FLG                 4-0-0/w PTR         r     1 P$
    *0-0-0/w STRC(504)   r     1 P$PCB                    444-0-0/w STRC(144)   r     1 P_DUMMY
  1202-0-0/d STRC(702)   r     1 Q_CRITERIA                14-0-0/w PTR         r     1 RES$
   450-0-0/d VECT        r     1 RESULTS_                1315-0-0/b BIT         r     1 RETURN_FLG
    15-0-0/w PTR         r     1 SN$                      135-0-0/b BIT         r     1 SOMETHING_CHANGED
    13-0-0/w PTR         r     1 STAT$                    162-0-0/d REMB        r     1 SUBMIT_LOOP_REMEM
   344-0-0/w STRC(675)   r     1 SYSIDBUF                1226-0-0/d STRC(702)   r     1 SYSID_CRITERIA
   125-0-0/b BIT         r     1 SYSTEM_OK#              1326-0-0/w STRC(81)    r     1 TCHKEYBUF
   147-0-0/w UBIN        r     1 TEMP                       6-0-0/w PTR         r     1 TEMP$
   150-0-0/w UBIN        r     1 TEMP2                    151-0-0/w UBIN        r     1 TEMP3
    20-0-0/c CHAR(256)   r     1 TEMPBUF                   11-0-0/w PTR         r     1 TEMPBUF$
   121-0-0/w BIT         r     1 USEFID_OPEN#            1252-0-0/d STRC(288)   r     1 VLP_JOBNAME
  1262-0-0/d STRC(396)   r     1 VLR_JOBSTATS_CHECK       133-0-0/b BIT         r     1 WAITING
   132-0-0/b BIT         r     1 WAIT_BELL                131-0-0/b BIT         r     1 WAIT_DONE
   442-0-0/w UBIN        r     1 WAIT_INT                1134-0-0/w STRC(27)    r     1 XSJ_INFOKEY
  1135-0-0/w STRC(180)   r     1 XSJ_JOBINFO             1143-0-0/w STRC(369)   r     1 XSJ_NAMEKEY
  1142-0-0/w STRC(18)    r     1 XSJ_NAMEREC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d STRC(1080)  r     1 CFPT_CLOSE                 0-0-0/d STRC(360)   r     1 CFPT_DELREC
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:340  
     0-0-0/d STRC(1296)  r     1 CFPT_JOBSTATS              0-0-0/d STRC(2088)  r     1 CFPT_OPEN
     0-0-0/d STRC(360)   r     1 CFPT_PRECORD               0-0-0/d STRC(504)   r     1 CFPT_READ
     0-0-0/d STRC(432)   r     1 CFPT_TIME                  0-0-0/d STRC(216)   r     1 CFPT_WAIT
     0-0-0/d STRC(702)   r     1 CVLP_CRITERIA              0-0-0/c STRC(63)    r     1 K_NOTIFY
     0-0-0/w UBIN        r     1 M$IBEX1_NUM                0-0-0/w UBIN        r     1 M$IBEX_NUM
     0-0-0/w PTR         r     1 SEG2$                      0-0-0/w PTR         r     1 SEG4$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 B$$PAGE(0:1023)            0-0-0/d STRC(72)    r     1 B$$VECTOR
     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(2880)  r     1 B$NWIO                     0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(828)   r     1 ERR$BLK                    0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(324)   r     1 FID$RESULTS                0-0-0N  NULL        r     1 M$UC
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S
     0-0-0/w STRC(6264)  r     1 SEG$2                      0-0-0/c ASTR(9)     r     1 TEXTC
     0-0-0/w STRC(2304)  r     1 VLA$INPUT                  0-0-0/w STRC(1008)  r     1 VLA$OUTPUT
     0-0-0/d STRC(2376)  r     1 VLR$INPUT                  0-0-0/d STRC(1080)  r     1 VLR$OUTPUT


   Procedure CPK$CHECK requires 4194 words for executable code.
   Procedure CPK$CHECK requires 756 words of local(AUTO) storage.
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:341  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:342  
          MINI XREF LISTING

ASYSIDBUF.STATUS
     10574**DCL     14324<<ASSIGN  14354>>ASSIGN  14356>>IF      14361>>ASSIGN
ASYSIDBUF.STATUS.CODE
     10575**DCL     14328<<ASSIGN  14329>>IF      14335<<ASSIGN
ASYSIDBUF.STATUS.TORUN
     10577**DCL     14330<<ASSIGN  14331<<ASSIGN  14338<<ASSIGN
B$$PAGE
     10305**DCL     12498--ASSIGN  13055--ASSIGN  13056--ASSIGN  13088--ASSIGN  13089--ASSIGN  13224--ASSIGN
     13225--ASSIGN
B$$VECTOR.PTR$
     11871**DCL     14191<<ASSIGN  14194<<ASSIGN
B$$VECTOR.W1.VSIZE#
     11869**DCL     14177<<ASSIGN  14177>>ASSIGN  14182<<ASSIGN  14182>>ASSIGN  14187<<ASSIGN  14187>>ASSIGN
B$$VECTOR.W2
     11870**DCL     11871--REDEF
B$ALT.CODE
     10143**DCL     10143--REDEF   10144--REDEF   10144--REDEF
B$ALT.ERR
     10144**DCL     12899<>CALL    12924<>CALL    13255<>CALL    13619<>CALL    13701<>CALL    13732<>CALL
     13809<>CALL    13977<>CALL    14058<>CALL    14150>>ASSIGN  14499<>CALL
B$ALT.ERR.CODE
     10145**DCL     12877>>IF      13252>>IF      13729>>IF      13848>>IF      13974>>IF      14055>>IF
     14495>>IF      14495>>IF
B$ALT.ERR.ERR#
     10145**DCL     10145--REDEF   12884>>IF      12895>>IF
B$ALT.EVID
     10144**DCL     10144--REDEF   10144--REDEF
B$JIT.ACCN
       113**DCL     12980>>ASSIGN  12993>>ASSIGN  13106>>ASSIGN  13121>>ASSIGN  13180>>IF      14003>>IF
     14048>>ASSIGN
B$JIT.CPFLAGS1.BRK
       206**DCL     12709>>IF      12712<<ASSIGN  12749>>IF      12752<<ASSIGN  13227>>IF      13353>>IF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:343  
     13356<<ASSIGN  13432>>IF      13521>>IF      13556>>IF      13648>>IF      13759>>IF      13858>>IF
B$JIT.CPFLAGS1.NOTIFY
       205**DCL     12422<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       207**DCL       207--REDEF
B$JIT.CPFLAGS1.SOMENOTIFY
       204**DCL     12342>>IF      12423<<ASSIGN  12549>>IF      12887<<ASSIGN  12918<<ASSIGN  12944<<ASSIGN
     14244<<ASSIGN
B$JIT.ERR.MID
       114**DCL       114--REDEF
B$JIT.FACCN
       113**DCL     12676>>ASSIGN
B$JIT.FPSN
       194**DCL     12677>>IF      12682>>ASSIGN
B$JIT.JRESPEAK
       275**DCL       276--REDEF
B$JIT.JUNK2
       367**DCL     13353>>IF      13357>>IF      13358<<ASSIGN  13358>>ASSIGN
B$JIT.LBJID
       289**DCL     12765>>ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
       384**DCL       384--REDEF     385--REDEF
B$JIT.PNR
       288**DCL       288--REDEF
B$JIT.PRIV.AUTH
       154**DCL     12512>>IF      12642>>IF      13070>>IF      13095>>IF
B$JIT.SYSID
       113**DCL     12591>>ASSIGN  12782>>ASSIGN
B$JIT.TSLINE
       382**DCL       383--REDEF
B$JIT.USRERR
       249**DCL     12530<<ASSIGN  12854<>CALL    14248<>CALL    14491<<ASSIGN
B$JIT.USRERR.CODE
       249**DCL     12525>>IF
B$JIT.WOO
       113**DCL     13003>>ASSIGN  13012>>ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:344  
B$JIT$
      9882**DCL       108--IMP-PTR 12342>>IF      12422>>ASSIGN  12423>>ASSIGN  12512>>IF      12525>>IF
     12530>>ASSIGN  12549>>IF      12591>>ASSIGN  12642>>IF      12676>>ASSIGN  12677>>IF      12682>>ASSIGN
     12709>>IF      12712>>ASSIGN  12749>>IF      12752>>ASSIGN  12765>>ASSIGN  12782>>ASSIGN  12854>>CALL
     12887>>ASSIGN  12918>>ASSIGN  12944>>ASSIGN  12980>>ASSIGN  12993>>ASSIGN  13003>>ASSIGN  13012>>ASSIGN
     13070>>IF      13095>>IF      13106>>ASSIGN  13121>>ASSIGN  13180>>IF      13227>>IF      13353>>IF
     13353>>IF      13356>>ASSIGN  13357>>IF      13358>>ASSIGN  13358>>ASSIGN  13432>>IF      13521>>IF
     13556>>IF      13648>>IF      13759>>IF      13858>>IF      14003>>IF      14048>>ASSIGN  14244>>ASSIGN
     14248>>CALL    14491>>ASSIGN
B$NWIO.CGPARM.MSGIDXT
     10183**DCL     10186--REDEF
B$NWIO.CODE
     10152**DCL     10152--REDEF   10153--REDEF   10153--REDEF
B$NWIO.ERR.ERR#
     10154**DCL     10154--REDEF
B$NWIO.EVID
     10153**DCL     10153--REDEF   10153--REDEF
B$NWIO.SUBC
     10153**DCL     13359>>IF
B$TCB.ALT$
     10139**DCL     12877>>IF      12884>>IF      12895>>IF      12899>>CALL    12924>>CALL    13252>>IF
     13255>>CALL    13619>>CALL    13701>>CALL    13729>>IF      13732>>CALL    13809>>CALL    13848>>IF
     13974>>IF      13977>>CALL    14055>>IF      14058>>CALL    14150>>ASSIGN  14495>>IF      14495>>IF
     14499>>CALL
B$TCB.STK$
     10139**DCL     13359>>IF
B$TCB$
      9884**DCL     10139--IMP-PTR 12877>>IF      12884>>IF      12895>>IF      12899>>CALL    12924>>CALL
     13252>>IF      13255>>CALL    13359>>IF      13619>>CALL    13701>>CALL    13729>>IF      13732>>CALL
     13809>>CALL    13848>>IF      13974>>IF      13977>>CALL    14055>>IF      14058>>CALL    14150>>ASSIGN
     14495>>IF      14495>>IF      14499>>CALL
BAD_USEFILE_REMEM
     10341**DCL     12479<<REMEMBR 14292>>UNWIND
BLK$
      9951**DCL     12609<<ASSIGN  12614>>IF      12629>>DOINDEX 12631>>ASSIGN  12686>>IF      12702>>ASSIGN
     12703>>ASSIGN  12703>>ASSIGN  12704>>ASSIGN  12707>>DOINDEX 12717>>ASSIGN  12817>>IF      12822>>ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:345  
     12828>>ASSIGN
BUF$
      9961**DCL     13425<<ASSIGN  13426>>IF      13434<<ASSIGN  13439>>IF      13449>>IF      13457>>IF
     13464>>IF      13481>>ASSIGN
CAMR_REC.ACSVEH_
      8921**DCL      8922--REDEF
CAMR_REC.ALTKEYS_
      8927**DCL      8928--REDEF    8928--REDEF
CAMR_REC.HDR_
      8926**DCL      8927--REDEF
CAMR_REC.TAB_
      8925**DCL      8926--REDEF
CAMR_REC.UHL_
      8919**DCL      8920--REDEF    8920--REDEF
CAMR_REC.V.FSN#
      8959**DCL      8959--REDEF    8959--REDEF
CAMR_REC.WSN_
      8925**DCL      8925--REDEF
CFPT_CLOSE
      7763**DCL     12440>>ASSIGN
CFPT_CLOSE.SN_
      7763**DCL      7763--REDEF
CFPT_CLOSE.UTL_
      7764**DCL      7764--REDEF
CFPT_CLOSE.V.EXPIRE#
      7778**DCL      7778--REDEF
CFPT_CLOSE.V.TYPE#
      7776**DCL      7776--REDEF
CFPT_CLOSE.V.XTNSIZE#
      7773**DCL      7773--REDEF    7775--REDEF
CFPT_DELREC
      7971**DCL     14216>>ASSIGN
CFPT_JOBSTATS
      9011**DCL     12429>>ASSIGN  12434>>ASSIGN  13043>>ASSIGN  13078>>ASSIGN  14309>>ASSIGN
CFPT_OPEN
      7696**DCL     12446>>ASSIGN  13896>>ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:346  
CFPT_OPEN.ACSVEH_
      7698**DCL      7699--REDEF
CFPT_OPEN.ALTKEYS_
      7704**DCL      7705--REDEF    7705--REDEF
CFPT_OPEN.HDR_
      7703**DCL      7704--REDEF
CFPT_OPEN.TAB_
      7702**DCL      7703--REDEF
CFPT_OPEN.UHL_
      7696**DCL      7697--REDEF    7697--REDEF
CFPT_OPEN.V.FSN#
      7736**DCL      7736--REDEF    7736--REDEF
CFPT_OPEN.WSN_
      7702**DCL      7702--REDEF
CFPT_OPEN_JOBINFO
     10935**DCL     13905>>ASSIGN
CFPT_OPEN_JOBINFO.ACSVEH_
     10937**DCL     10938--REDEF
CFPT_OPEN_JOBINFO.ALTKEYS_
     10943**DCL     10944--REDEF   10944--REDEF
CFPT_OPEN_JOBINFO.HDR_
     10942**DCL     10943--REDEF
CFPT_OPEN_JOBINFO.TAB_
     10941**DCL     10942--REDEF
CFPT_OPEN_JOBINFO.UHL_
     10935**DCL     10936--REDEF   10936--REDEF
CFPT_OPEN_JOBINFO.V
     10944**DCL     10935--DCLINIT
CFPT_OPEN_JOBINFO.V.FSN#
     10975**DCL     10975--REDEF   10975--REDEF
CFPT_OPEN_JOBINFO.WSN_
     10941**DCL     10941--REDEF
CFPT_PFIL
     11023**DCL     12462>>ASSIGN
CFPT_PFIL.V
     11023**DCL     11023--DCLINIT
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:347  
CFPT_PRECORD
      7950**DCL     12468>>ASSIGN
CFPT_READ
      7799**DCL     12455>>ASSIGN  12867>>ASSIGN  13814>>ASSIGN  14475>>ASSIGN
CFPT_READ.STATION_
      7802**DCL      7803--REDEF
CFPT_READ.V.DVBYTE.REREAD#
      7814**DCL      7814--REDEF
CFPT_READ.V.INDX#
      7812**DCL      7812--REDEF
CFPT_READUC.STATION_
      8172**DCL      8173--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
      8184**DCL      8184--REDEF
CFPT_READUC.V.INDX#
      8182**DCL      8182--REDEF
CFPT_TIME
      7610**DCL     13343>>ASSIGN
CFPT_TRMPRG
     10997**DCL     13361<>CALL
CFPT_TRMPRG.V
     11004**DCL     10999--DCLINIT
CFPT_TRMPRG.V.CTLFLG.RSTBRK#
     11005**DCL     11006--REDEF
CFPT_TRTN.V.IR#
      8408**DCL      8409--REDEF
CFPT_WAIT
      9048**DCL     13346>>ASSIGN
CFPT_WRITE.STATION_
      7840**DCL      7840--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      7847**DCL      7847--REDEF
CFPT_WRITEUC.STATION_
      8140**DCL      8140--REDEF
CFPT_WRITEUC.V.DVBYTE.VFC#
      8147**DCL      8147--REDEF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:348  
CFPT_XXX.V.STEPCC#
      9120**DCL      9120--REDEF
CGETCMD.OUT$
      9141**DCL      9147--REDEF
CHECK_AWAITING_PRESCAN IN PROCEDURE SETUP_SYSID_SRCH
     13259**LABEL   13147--GOTO    13215--GOTO
CHECK_CLEANUP
     12838**LABEL   12551--GOTO    12597--CALLALT 12604--GOTO    12622--CALLALT 12689--CALLALT 12713--GOTO
     12759--GOTO
CHECK_SYSIDS
     13797**PROC    12597--CALL    12622--CALL    12689--CALL    13364--CALL    13368--CALL
CHECK_WAIT
     13300**PROC    12788--CALL
CHKEYBUF
     10515**DCL     12471--ASSIGN  12870--ASSIGN  13626<<ASSIGN  13654<<ASSIGN  13659<>CALL    13707<<ASSIGN
     13830--ASSIGN  14218--ASSIGN  14242--CALL    14385<<ASSIGN
CHKEYBUF.KSIZ
     10516**DCL     13958>>DOWHILE
CHKEYBUF.NUM
     10518**DCL     13144<<ASSIGN  13152<<ASSIGN  13194>>ASSIGN  13204>>ASSIGN  13214>>IF      13629<<ASSIGN
     13651>>IF      13656<<ASSIGN  13711<<ASSIGN  13782<<ASSIGN  13838>>ASSIGN  13945>>ASSIGN  13957>>ASSIGN
     13960>>IF      14014>>ASSIGN  14027>>ASSIGN  14316>>ASSIGN  14388<<ASSIGN
CHKEYBUF.SYSID
     10517**DCL     13143<<ASSIGN  13200<<ASSIGN  13628<<ASSIGN  13655<<ASSIGN  13709<<ASSIGN  13710<<ASSIGN
     13834>>IF      13837>>ASSIGN  13941>>ASSIGN  13958>>DOWHILE 14002>>ASSIGN  14023>>ASSIGN  14311>>ASSIGN
     14387<<ASSIGN
CHKEYBUF IN PROCEDURE READ_OUTPUT_RECORD
     14418**DCL     14402--PROC    14486<<ASSIGN
CHKEYBUF.NUM IN PROCEDURE READ_OUTPUT_RECORD
     14421**DCL     14466>>ASSIGN  14484>>IF
CHKEYBUF.SYSID IN PROCEDURE READ_OUTPUT_RECORD
     14420**DCL     14465>>ASSIGN  14484>>IF
CH_XFORMAT
     10596**DCL     12580<>CALL    12770<>CALL    12809<>CALL    13195<>CALL    13380<>CALL    13397<>CALL
     13468<>CALL    13477<>CALL    13484<>CALL    13499<>CALL    13506<>CALL    13527<>CALL    13533<>CALL
     13544<>CALL    13624<>CALL    13705<>CALL    13781<>CALL    13954<>CALL    14035<>CALL    14171<>CALL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:349  
     14383<>CALL
CH_XFORMAT.ACCT#
     10599**DCL     13193<<ASSIGN  13780<<ASSIGN  13942<<ASSIGN  13950<<ASSIGN  14017<<ASSIGN  14019<<ASSIGN
     14024<<ASSIGN
CH_XFORMAT.BUF$
     10603**DCL     13481<<ASSIGN  13531<<ASSIGN  13558<<ASSIGN  13560>>DOCASE  13588>>IF      13596>>IF
     13612>>ASSIGN  13628>>ASSIGN  13630>>ASSIGN  13631>>ASSIGN  13650<<ASSIGN  13651>>IF      13655>>ASSIGN
     13656>>ASSIGN  13696>>ASSIGN  13697>>ASSIGN  13709>>ASSIGN  13710>>ASSIGN  13711>>ASSIGN  13712>>ASSIGN
     13713>>ASSIGN  13762<<ASSIGN  13763>>IF      13937<<ASSIGN  14028<<ASSIGN
CH_XFORMAT.COMMENT#
     10605**DCL     13112<<ASSIGN  13116<<ASSIGN  13118<<ASSIGN  13158<<ASSIGN  13614<<ASSIGN  13617<<ASSIGN
     13620<<ASSIGN  13632>>ASSIGN  13699<<ASSIGN  13702<<ASSIGN  13714>>ASSIGN  13944<<ASSIGN  14026<<ASSIGN
     14371<<ASSIGN  14394>>ASSIGN
CH_XFORMAT.JOBNAME#
     10600**DCL     13192<<ASSIGN  13778<<ASSIGN  13943<<ASSIGN  13951<<ASSIGN  14013<<ASSIGN  14025<<ASSIGN
     14382<<ASSIGN
CH_XFORMAT.MSG#
     10597**DCL     12579<<ASSIGN  12769<<ASSIGN  12808<<ASSIGN  13190<<ASSIGN  13377<<ASSIGN  13379<<ASSIGN
     13394<<ASSIGN  13396<<ASSIGN  13467<<ASSIGN  13476<<ASSIGN  13483<<ASSIGN  13497<<ASSIGN  13498<<ASSIGN
     13505<<ASSIGN  13526<<ASSIGN  13528<<ASSIGN  13543<<ASSIGN  13563<<ASSIGN  13566<<ASSIGN  13569<<ASSIGN
     13572<<ASSIGN  13575<<ASSIGN  13578<<ASSIGN  13581<<ASSIGN  13644<<ASSIGN  13754<<ASSIGN  13776<<ASSIGN
     13936<<ASSIGN  14001<<ASSIGN  14022<<ASSIGN  14031<<ASSIGN  14158<<ASSIGN  14161<<ASSIGN  14164<<ASSIGN
     14166<<ASSIGN  14379<<ASSIGN
CH_XFORMAT.NUM#
     10602**DCL     13194<<ASSIGN  13504<<ASSIGN  13518<<ASSIGN  13542<<ASSIGN  13645<<ASSIGN  13755<<ASSIGN
     13779<<ASSIGN  13782>>ASSIGN  13945<<ASSIGN  13952<<ASSIGN  14014<<ASSIGN  14027<<ASSIGN  14381<<ASSIGN
CH_XFORMAT.STAT$
     10604**DCL     13688<<ASSIGN
CH_XFORMAT.SYSID#
     10598**DCL     13191<<ASSIGN  13777<<ASSIGN  13941<<ASSIGN  13949<<ASSIGN  13958>>DOWHILE 14002<<ASSIGN
     14023<<ASSIGN  14032<<ASSIGN  14380<<ASSIGN
CMDSTRM_CLOSED#
     10310**DCL     12478<<ASSIGN  12862>>IF      12933>>IF      14260<<ASSIGN
CMD_CODE
     10337**DCL     12566<<ASSIGN  12570<<ASSIGN  12574<<ASSIGN  12590<<ASSIGN  12632<<ASSIGN  12633>>DOCASE
     12718<<ASSIGN  12719>>DOCASE  12820>>IF      12824>>IF      12959>>IF      12964>>IF      12964>>IF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:350  
     12976>>IF      12976>>IF      13046>>IF      13110>>IF      13114>>IF      13124>>DOCASE  13132>>IF
     13413>>IF      13413>>IF      13436>>DOCASE  13496>>IF      13591>>IF      13599>>IF      13599>>IF
     13599>>IF      13607>>IF      13607>>IF      13607>>IF      13742>>IF      13785>>IF      13820<<ASSIGN
     13924>>IF      13938>>IF      13987>>DOCASE  14121>>DOCASE  14155>>DOCASE
CMD_TYPE
     10343**DCL     12349<<ASSIGN  12373<<ASSIGN  12396<<ASSIGN  12421<<ASSIGN  12616>>IF      12686>>IF
     12723>>IF      12736>>IF      12753>>IF      12777>>IF      12838>>IF      12953>>IF      13068>>IF
     13323>>IF      13585>>IF      13690>>IF      13990>>IF      14124>>IF      14131>>IF      14229>>IF
COMMON_CODE
     12429**LABEL   12351--GOTO    12375--GOTO    12403--GOTO
COMPARE_STATUS
     14302**PROC    13233--CALL    13663--CALL
CPB$OPENCS
      9965**DCL-ENT 12909--CALL    12939--CALL
CPC$FID_OPEN
      9982**DCL-ENT 14275--CALL
CPC$FID_VLP
      9981**DCL-ENT 12667--CALL
CPC$GETSEG
      9971**DCL-ENT 12497--CALL    14202--CALL
CPC$MFID_OPEN
      9980**DCL-ENT 14271--CALL
CPC$OPEN_LL
      9967**DCL-ENT 12499--CALL
CPC$OPEN_S
      9970**DCL-ENT 12496--CALL    12846--CALL
CPC$RELSEG
      9969**DCL-ENT 12851--CALL    12926--CALL
CPC$SCREECH
      9972**DCL-ENT 12502--CALL
CPC$WRITEMSGE
      9973**DCL-ENT 13619--CALL    13701--CALL    14147--CALL
CPJ$READ_S
      9974**DCL-ENT 12508--CALL
CPJ$WRITE_REC
      9977**DCL-ENT 14242--CALL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:351  
CPJ$WRITE_S
      9975**DCL-ENT 12848--CALL
CPK$CHECK_ALTRET
     12942**LABEL   12913--GOTO
CPK$CHECK_OUTPUT
      9983**DCL-ENT 12580--CALL    12770--CALL    12809--CALL    13195--CALL    13380--CALL    13397--CALL
     13468--CALL    13477--CALL    13484--CALL    13499--CALL    13506--CALL    13527--CALL    13533--CALL
     13544--CALL    13624--CALL    13705--CALL    13781--CALL    13954--CALL    14035--CALL    14171--CALL
     14383--CALL
CPR$RPTERR
      9979**DCL-ENT 14289--CALL
CP_CHFLAGS
     10369**DCL     12508--CALL    12529<<ASSIGN  12848--CALL
CP_CHFLAGS.FLG
     10387**DCL     12619<<ASSIGN  12957<<ASSIGN  13328<<ASSIGN
CP_CHFLAGS.FLG.INPUT
     10392**DCL     12556>>ASSIGN  12962<<ASSIGN
CP_CHFLAGS.FLG.OUTPUT
     10393**DCL     12558>>ASSIGN  12971<<ASSIGN
CP_CHFLAGS.FLG.RUNNING
     10394**DCL     12557>>ASSIGN  12967<<ASSIGN
CP_CHFLAGS.FLG.SRCHID
     10389**DCL     12594>>IF      12620<<ASSIGN  12726<<ASSIGN  12739<<ASSIGN
CP_CHFLAGS.FLG.SRCHQS
     10388**DCL     12553>>IF      12727<<ASSIGN  12740<<ASSIGN
CP_CHFLAGS.FLG.TERM
     10391**DCL     12585>>IF      12779<<ASSIGN  12916>>IF      12942>>IF
CP_CHFLAGS.FLG.WAIT
     10401**DCL     12599>>IF      13329<<ASSIGN
CP_CHFLAGS.INPUT_OPT
     10383**DCL     13030<<ASSIGN  13033<<ASSIGN  13036<<ASSIGN  13444>>DOCASE  13599>>IF      13599>>IF
     13607>>IF
CP_CHFLAGS.I_CRITERIA
     10419**DCL     12567>>ASSIGN  12571>>ASSIGN  12728<<ASSIGN
CP_CHFLAGS.O_CRITERIA
     10447**DCL     12575>>ASSIGN  12741<<ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:352  
CP_CHFLAGS.SYSTEM
     10384**DCL     12512>>IF      12636<<ASSIGN  12648<<ASSIGN  12793<<ASSIGN  12797<<ASSIGN  12978>>IF
     14003>>IF
CP_CHFLAGS.USE_ACCT
     10370**DCL     12535--ASSIGN  12676<<ASSIGN
CP_CHFLAGS.USE_ASN
     10381**DCL     12541>>ASSIGN  12670<<ASSIGN  14279<<ASSIGN
CP_CHFLAGS.USE_NAME
     10371**DCL     12536--ASSIGN
CP_CHFLAGS.USE_PASS
     10374**DCL     12537--ASSIGN
CP_CHFLAGS.USE_RES
     10380**DCL     12540>>ASSIGN  12669<<ASSIGN  14278<<ASSIGN
CP_CHFLAGS.USE_RESULTS
     10376**DCL     12542>>ASSIGN  12685<<ASSIGN  14264>>IF      14280<<ASSIGN
CP_CHFLAGS.USE_SN
     10377**DCL     12539--ASSIGN
CP_CHFLAGS.USE_SN.N
     10378**DCL     12681<<ASSIGN
CP_CHFLAGS.USE_SN.SN
     10379**DCL     12682<<ASSIGN
CP_CHFLAGS.USE_WSN
     10375**DCL     12538--ASSIGN
CP_CHFLAGS.WAIT_DONE
     10385**DCL     13326<<ASSIGN  13337>>ASSIGN
CP_CHFLAGS.WAIT_INT
     10404**DCL     13327<<ASSIGN  13338>>ASSIGN
CP_C_CHFLAGS
     10693**DCL     12529>>ASSIGN
CP_C_CHKEYBUF
     10674**DCL     13626>>ASSIGN  13654>>ASSIGN  13707>>ASSIGN  14385>>ASSIGN  14464>>ASSIGN
CP_FIDVLPS
     10492**DCL     12667<>CALL    14271<>CALL    14275<>CALL
CP_FIDVLPS.FID_ACCT_
     10493**DCL     12535<<ASSIGN
CP_FIDVLPS.FID_ASN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:353  
     10500**DCL     12541<<ASSIGN  12670>>ASSIGN  14279>>ASSIGN
CP_FIDVLPS.FID_NAME_
     10494**DCL     12536<<ASSIGN
CP_FIDVLPS.FID_PASS_
     10495**DCL     12537<<ASSIGN
CP_FIDVLPS.FID_RES
     10499**DCL     12540<<ASSIGN  12669>>ASSIGN  14278>>ASSIGN
CP_FIDVLPS.FID_RESULTS
     10498**DCL     12542<<ASSIGN  12671--ASSIGN  12685>>ASSIGN  14280>>ASSIGN
CP_FIDVLPS.FID_SN_
     10497**DCL     12539<<ASSIGN
CP_FIDVLPS.FID_WSN_
     10496**DCL     12538<<ASSIGN
CROSS_ACCT_BATCH_FLG
     10315**DCL     12402<<ASSIGN  13070>>IF
CVLP_CRITERIA
      8228**DCL     12975>>ASSIGN  13091>>ASSIGN
CVLP_TRMCTL.BREAKCOUNT
      8732**DCL      8733--REDEF
CVLP_WINDOW.FWINDOW#
      8828**DCL      8828--REDEF    8829--REDEF
CXP$POSTERR
      9978**DCL-ENT 12653--CALL    12854--CALL    12880--CALL    12897--CALL    12899--CALL    12924--CALL
     13255--CALL    13732--CALL    13809--CALL    13852--CALL    13977--CALL    14058--CALL    14248--CALL
     14288--CALL    14499--CALL
CXSJ_INFOKEY
     10826**DCL     13927>>ASSIGN
CXSJ_NAMEKEY
     10840**DCL     14042>>ASSIGN
DELETE_RECORDS IN PROCEDURE READ_JOBSTATS_FILE
     13957**LABEL   14036--GOTO
DELETE_USEFILE_REC
     14214**PROC    13783--CALL    13963--CALL    14238--CALL
DELUSEREC
     10311**DCL     13122<<ASSIGN  13164<<ASSIGN  14235>>IF
DISP_INPUT
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:354  
     13403**PROC    14128--CALL
DISP_JOBSTATS IN PROCEDURE GET_JOBSTATS
     14115**LABEL   14207--GOTO
DISP_ONE_OUTPUT
     13686**PROC    13675--CALL    13768--CALL
DISP_OUTPUT
     13514**PROC    14135--CALL
DISP_SYSID_SRCH_IRQ
     13552**PROC    13247--CALL    14126--CALL    14142--CALL
DISP_SYSID_SRCH_OQ
     13642**PROC    13289--CALL    14133--CALL    14141--CALL
DISP_SYSID_SUBFILE
     13721**PROC    13211--CALL
DONE_LISTING_INPUT IN PROCEDURE DISP_INPUT
     13493**LABEL   13433--GOTO    13441--GOTO    13451--GOTO
DONE_LISTING_OUTPUT IN PROCEDURE DISP_OUTPUT
     13540**LABEL   13522--GOTO
DONT_PRINT_NUM_LISTED IN PROCEDURE DISP_INPUT
     13510**LABEL   13503--GOTO
DONT_PRINT_NUM_LISTED IN PROCEDURE DISP_OUTPUT
     13548**LABEL   13541--GOTO
DONT_REMEMBER_Q_SRCH IN PROCEDURE SETUP_Q_SRCH
     12975**LABEL   12954--GOTO
DO_NEXT_K IN PROCEDURE DISP_INPUT
     13489**LABEL   13459--GOTO
ERR$BLK.FIRST
     10287**DCL     12483<<ASSIGN  12813>>IF      12893<<ASSIGN  12911>>IF      14286<<ASSIGN  14290<<ASSIGN
ERR$BLK.NEXT
     10288**DCL     12484<<ASSIGN  12894<<ASSIGN  14287<<ASSIGN  14291<<ASSIGN
ERRCODE IN PROCEDURE GET_JOBSTATS
     14081**DCL     14115<<ASSIGN  14145>>IF      14147<>CALL    14150<<ASSIGN  14209<<ASSIGN
ERRCODE.ERR# IN PROCEDURE GET_JOBSTATS
     14111**DCL     14152>>DOCASE  14204>>IF
ERRCODE.SEV IN PROCEDURE GET_JOBSTATS
     14111**DCL     14151<<ASSIGN
E_CHECK
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:355  
     12924**LABEL   12527--GOTO    12845--CALLALT 12860--CALLALT 12931--CALLALT
E_CHECKSTATUS IN PROCEDURE COMPARE_STATUS
     14361**LABEL   14322--CALLALT
E_CHKBADUSEF
     10044**DCL     12880<>CALL    13852<>CALL
E_CHKBADUSEFSPEC
     10064**DCL     14288<>CALL
E_CHKNOPRIV
     10000**DCL     12653<>CALL
E_CHKSEG
     12502**LABEL   12497--CALLALT
E_DELREC IN PROCEDURE DELETE_USEFILE_REC
     14224**LABEL   14221--CALLALT
E_DISP_SYSID_SRCH_OQ IN PROCEDURE DISP_SYSID_SRCH_OQ
     13682**LABEL   13659--CALLALT 13674--CALLALT
E_DISP_SYSID_SUBFILE_ALT IN PROCEDURE DISP_SYSID_SUBFILE
     13793**LABEL   13734--GOTO
E_DISP_SYSID_SUBFILE_NOTF IN PROCEDURE DISP_SYSID_SUBFILE
     13776**LABEL   13767--CALLALT
E_DONE_NOTIFYQ
     12582**LABEL   12578--CALLALT
E_DONT_POSTERR
     12926**LABEL   12479--REMEMBR 12496--CALLALT 12592--CALLALT 12761--CALLALT 12773--CALLALT 12783--CALLALT
     12807--CALLALT 12815--GOTO    12846--CALLALT 12882--GOTO
E_JOBSTATS IN PROCEDURE READ_JOBSTATS_FILE
     13974**LABEL   13922--CALLALT 13931--CALLALT
E_JOBSTATS2 IN PROCEDURE GET_JOBSTATS
     14150**LABEL   14118--CALLALT 14206--GOTO
E_NOT_AWAITING_PRESCAN IN PROCEDURE SETUP_SYSID_SRCH
     13278**LABEL   13262--CALLALT
E_OPEN IN PROCEDURE GET_JOBSTATS
     14198**LABEL   14139--CALLALT 14141--CALLALT
E_OPEN_ALTRET IN PROCEDURE OPEN_USEFILE
     14286**LABEL   14271--CALLALT 14275--CALLALT
E_OPEN_JOBSTATS_FILE IN PROCEDURE OPEN_JOBSTATS_FILE
     13914**LABEL   13909--CALLALT
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:356  
E_OPEN_USE IN PROCEDURE WRITE_USEFILE_REC
     14251**LABEL   14233--CALLALT
E_PFIL
     12893**LABEL   12866--CALLALT
E_READ_CHECK
     12525**LABEL   12508--CALLALT
E_READ_SYSID_NAME_REC IN PROCEDURE GET_JOBNAME_SYSID_REC
     14055**LABEL   14052--CALLALT
E_SETUP_SYSID_SRCH IN PROCEDURE SETUP_SYSID_SRCH
     13297**LABEL   13066--CALLALT 13178--CALLALT 13179--CALLALT 13267--CALLALT 13289--CALLALT
E_USEFILEBUSY
     10024**DCL     12897<>CALL
E_WRITE_CHECK
     12854**LABEL   12667--CALLALT 12848--CALLALT
E_WRITE_CHECK IN PROCEDURE DISP_ONE_OUTPUT
     13718**LABEL   13716--CALLALT
E_WRITE_CHECK IN PROCEDURE DISP_SYSID_SRCH_IRQ
     13637**LABEL   13593--GOTO    13604--GOTO    13611--GOTO    13634--CALLALT
E_WRITE_CHECK IN PROCEDURE DISP_SYSID_SRCH_OQ
     13678**LABEL   13666--GOTO    13672--GOTO
E_WRITE_CHECK IN PROCEDURE PRINT_SUBMIT_MESS
     14398**LABEL   14396--CALLALT
E_WRITE_CHECK IN PROCEDURE WRITE_USEFILE_REC
     14248**LABEL   14242--CALLALT
F$DCB.ACTPOS
     11216**DCL     11216--REDEF
F$DCB.ARS#
     11190**DCL     11190--REDEF
F$DCB.ATTR
     11209**DCL     11210--REDEF
F$DCB.BORROW
     11224**DCL     11224--REDEF   11224--REDEF   11224--REDEF
F$DCB.DCBNAME.L
     11238**DCL     11238--IMP-SIZ
F$DCB.EOMCHAR#
     11194**DCL     11194--REDEF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:357  
F$DCB.FCD#
     11203**DCL     12856>>IF      12905>>IF      12927>>IF      12937>>IF      14258>>IF
F$DCB.FLDID
     11219**DCL     11219--REDEF
F$DCB.FORM$
     11213**DCL     11213--REDEF
F$DCB.FSECT
     11229**DCL     11229--REDEF
F$DCB.FSN#
     11206**DCL     11206--REDEF   11206--REDEF   11207--REDEF
F$DCB.HEADER$
     11212**DCL     11212--REDEF
F$DCB.IXTNSIZE#
     11210**DCL     11210--REDEF
F$DCB.LASTSTA$
     11199**DCL     11199--REDEF
F$DCB.LINES#
     11212**DCL     14506>>IF      14509>>ASSIGN
F$DCB.LVL
     11225**DCL     11225--REDEF
F$DCB.NAME#.C
     11200**DCL     11200--REDEF
F$DCB.NOEOF
     11222**DCL     11222--REDEF
F$DCB.NRECS#
     11211**DCL     11211--REDEF
F$DCB.NRECX
     11230**DCL     11230--REDEF
F$DCB.OHDR
     11222**DCL     11222--REDEF
F$DCB.ORG#
     11205**DCL     11205--REDEF   14506>>IF
F$DCB.PRECNO
     11228**DCL     11228--REDEF
F$DCB.RCSZ
     11234**DCL     11234--REDEF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:358  
F$DCB.RES#
     11201**DCL     11201--REDEF
F$DCB.SETX
     11213**DCL     11213--REDEF
F$DCB.TAB$
     11213**DCL     11213--REDEF
F$DCB.TDA
     11227**DCL     11228--REDEF
F$DCB.WSN#
     11201**DCL     11201--REDEF
FID$RESULTS.ACCT
     12027**DCL     12672>>IF      12675<<ASSIGN
FID$RESULTS.SN
     12027**DCL     12677>>IF      12680<<ASSIGN
FID_ACCT.ACCT#
     11885**DCL     12477<<ASSIGN  13121<<ASSIGN  13155<<ASSIGN  13180>>IF      13193>>ASSIGN  13219>>ASSIGN
     13780>>ASSIGN  14003>>IF      14015>>IF      14019>>ASSIGN  14044>>IF      14046>>ASSIGN
FID_SN IN PROCEDURE OPEN_JOBSTATS_FILE
     13891**DCL     13908--ASSIGN
FID_SN.NUM# IN PROCEDURE OPEN_JOBSTATS_FILE
     13891**DCL     13894<<ASSIGN
FID_SN.SN# IN PROCEDURE OPEN_JOBSTATS_FILE
     13891**DCL     13895<<ASSIGN
FIRST_QFLAG
     10324**DCL     12626<<ASSIGN  12955>>DOWHILE 12956<<ASSIGN
FORCE
     10322**DCL     13214>>IF      13237>>IF      13342<<ASSIGN  13363<<ASSIGN  13372>>IF      13375>>IF
     13382<<ASSIGN  13671>>IF
FOUND_FIRST_TO_PRINT IN PROCEDURE DISP_INPUT
     13431**LABEL   13418--GOTO    13426--GOTO
FPT$CLOSE.SN_
     11128**DCL     11128--REDEF
FPT$CLOSE.UTL_
     11129**DCL     11129--REDEF
FPT$CLOSE.V.EXPIRE#
     11143**DCL     11143--REDEF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:359  
FPT$CLOSE.V.TYPE#
     11141**DCL     11141--REDEF
FPT$CLOSE.V.XTNSIZE#
     11138**DCL     11138--REDEF   11140--REDEF
FPT$WRITE.STATION_
     11093**DCL     11093--REDEF
FPT$WRITE.V.DVBYTE.VFC#
     11100**DCL     11100--REDEF
FPT_CLOSE
     11561**DCL     12440<<ASSIGN  12845<>CALL    12860<>CALL    12906<>CALL    12931<>CALL    12938<>CALL
     13903<>CALL    14259<>CALL
FPT_CLOSE.SN_
     11561**DCL     11561--REDEF
FPT_CLOSE.UTL_
     11562**DCL     11562--REDEF
FPT_CLOSE.V
     11566**DCL     12441--ASSIGN
FPT_CLOSE.V.DCB#
     11567**DCL     12844<<ASSIGN  12859<<ASSIGN  12865<<ASSIGN  12930<<ASSIGN  12936<<ASSIGN  13902<<ASSIGN
     14257<<ASSIGN
FPT_CLOSE.V.DISP#
     11570**DCL     12442<<ASSIGN  12874<<ASSIGN  12888<<ASSIGN
FPT_CLOSE.V.EXPIRE#
     11576**DCL     11576--REDEF
FPT_CLOSE.V.TYPE#
     11574**DCL     11574--REDEF
FPT_CLOSE.V.XTNSIZE#
     11571**DCL     11571--REDEF   11573--REDEF
FPT_CLOSE.V_
     11561**DCL     12441<<ASSIGN
FPT_DELREC
     11591**DCL     14216<<ASSIGN  14221<>CALL
FPT_DELREC.KEY_
     11591**DCL     14218<<ASSIGN
FPT_DELREC.V
     11594**DCL     14217--ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:360  
FPT_DELREC.V.DCB#
     11595**DCL     14219<<ASSIGN
FPT_DELREC.V_
     11591**DCL     14217<<ASSIGN
FPT_JOBSTATS
     11646**DCL     12429<<ASSIGN  13043<<ASSIGN  13078<<ASSIGN  13243<>CALL    13262<>CALL    13288<>CALL
     13727<>CALL    14118<>CALL
FPT_JOBSTATS.CRITERIA_
     11647**DCL     13049<<ASSIGN  13081<<ASSIGN
FPT_JOBSTATS.JOBNAME_
     11647**DCL     13120<<ASSIGN
FPT_JOBSTATS.RESLIST_
     11649**DCL     13055<<ASSIGN  13088<<ASSIGN  13224<<ASSIGN  14187--ASSIGN  14187--ASSIGN
FPT_JOBSTATS.RESULTS_
     11646**DCL     13054<<ASSIGN  13087<<ASSIGN  13226<<ASSIGN  13260<<ASSIGN  13279<<ASSIGN  14177--ASSIGN
     14177--ASSIGN  14194--ASSIGN
FPT_JOBSTATS.SNLIST_
     11648**DCL     13056<<ASSIGN  13089<<ASSIGN  13225<<ASSIGN  14182--ASSIGN  14182--ASSIGN  14191--ASSIGN
FPT_JOBSTATS.V
     11650**DCL     12430--ASSIGN  13045--ASSIGN  13079--ASSIGN
FPT_JOBSTATS.V.NUM#
     11652**DCL     13169<<ASSIGN  13204<<ASSIGN  13208>>IF      13749<<ASSIGN  13755>>ASSIGN  13763>>IF
     13779>>ASSIGN
FPT_JOBSTATS.V.ORDER#
     11650**DCL     13080<<ASSIGN  13259<<ASSIGN  13278<<ASSIGN  13725<<ASSIGN
FPT_JOBSTATS.V.OUTPUT#
     11651**DCL     13047<<ASSIGN  13048<<ASSIGN  13221<<ASSIGN  13287<<ASSIGN  13726<<ASSIGN  14140>>IF
FPT_JOBSTATS.V.SYSID#
     11650**DCL     13261<<ASSIGN
FPT_JOBSTATS.V_
     11646**DCL     12430<<ASSIGN  13045<<ASSIGN  13079<<ASSIGN
FPT_JOBSTATS_CANCEL
     11686**DCL     12434<<ASSIGN  13618<>CALL    13700<>CALL
FPT_JOBSTATS_CANCEL.V
     11690**DCL     12435--ASSIGN
FPT_JOBSTATS_CANCEL.V.NUM#
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:361  
     11692**DCL     13697<<ASSIGN
FPT_JOBSTATS_CANCEL.V.ORDER#
     11690**DCL     12716<<ASSIGN  13613<<ASSIGN  13698<<ASSIGN
FPT_JOBSTATS_CANCEL.V.OUTPUT#
     11691**DCL     12436<<ASSIGN  12715<<ASSIGN  13161<<ASSIGN  13615>>IF      13693>>IF
FPT_JOBSTATS_CANCEL.V.SYSID#
     11690**DCL     13612<<ASSIGN  13696<<ASSIGN
FPT_JOBSTATS_CANCEL.V_
     11686**DCL     12435<<ASSIGN
FPT_JOBSTATS_STATUS
     11666**DCL     14309<<ASSIGN  14322<>CALL
FPT_JOBSTATS_STATUS.RESULTS_
     11666**DCL     14320<<ASSIGN
FPT_JOBSTATS_STATUS.V
     11670**DCL     14310--ASSIGN
FPT_JOBSTATS_STATUS.V.NUM#
     11672**DCL     14316<<ASSIGN
FPT_JOBSTATS_STATUS.V.ORDER#
     11670**DCL     14315<<ASSIGN  14319<<ASSIGN
FPT_JOBSTATS_STATUS.V.SYSID#
     11670**DCL     14311<<ASSIGN
FPT_JOBSTATS_STATUS.V_
     11666**DCL     14310<<ASSIGN
FPT_OPEN
     11307**DCL     13896<<ASSIGN  13905<<ASSIGN  13909<>CALL
FPT_OPEN.ACSVEH_
     11309**DCL     11310--REDEF
FPT_OPEN.ALTKEYS_
     11315**DCL     11316--REDEF   11316--REDEF
FPT_OPEN.HDR_
     11314**DCL     11315--REDEF
FPT_OPEN.SN_
     11307**DCL     13908<<ASSIGN
FPT_OPEN.TAB_
     11313**DCL     11314--REDEF
FPT_OPEN.UHL_
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:362  
     11307**DCL     11308--REDEF   11308--REDEF
FPT_OPEN.V
     11316**DCL     13897--ASSIGN  13906--ASSIGN
FPT_OPEN.V.DCB#
     11316**DCL     13898<<ASSIGN  13907<<ASSIGN
FPT_OPEN.V.FSN#
     11347**DCL     11347--REDEF   11347--REDEF
FPT_OPEN.V.FUN#
     11326**DCL     13899<<ASSIGN
FPT_OPEN.V.SHARE#
     11321**DCL     13900<<ASSIGN
FPT_OPEN.V_
     11307**DCL     13897<<ASSIGN  13906<<ASSIGN
FPT_OPEN.WSN_
     11313**DCL     11313--REDEF
FPT_OPEN_USE
     11416**DCL     12446<<ASSIGN  14271<>CALL    14275<>CALL
FPT_OPEN_USE.ACSVEH_
     11418**DCL     11419--REDEF
FPT_OPEN_USE.ALTKEYS_
     11424**DCL     11425--REDEF   11425--REDEF
FPT_OPEN_USE.HDR_
     11423**DCL     11424--REDEF
FPT_OPEN_USE.TAB_
     11422**DCL     11423--REDEF
FPT_OPEN_USE.UHL_
     11416**DCL     11417--REDEF   11417--REDEF
FPT_OPEN_USE.V
     11425**DCL     12447--ASSIGN
FPT_OPEN_USE.V.ACS#
     11436**DCL     12450<<ASSIGN
FPT_OPEN_USE.V.DCB#
     11425**DCL     12448<<ASSIGN
FPT_OPEN_USE.V.EXIST#
     11429**DCL     14263<<ASSIGN
FPT_OPEN_USE.V.FSN#
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:363  
     11456**DCL     11456--REDEF   11456--REDEF
FPT_OPEN_USE.V.FUN#
     11435**DCL     14262<<ASSIGN
FPT_OPEN_USE.V.ORG#
     11436**DCL     12449<<ASSIGN
FPT_OPEN_USE.V.SHARE#
     11430**DCL     12451<<ASSIGN
FPT_OPEN_USE.V_
     11416**DCL     12447<<ASSIGN
FPT_OPEN_USE.WSN_
     11422**DCL     11422--REDEF
FPT_PFIL
     11610**DCL     12462<<ASSIGN  12866<>CALL    13808<>CALL
FPT_PFIL.V
     11610**DCL     12463--ASSIGN
FPT_PFIL.V.DCB#
     11610**DCL     12464<<ASSIGN
FPT_PFIL.V_
     11610**DCL     12463<<ASSIGN
FPT_PRECORD
     11625**DCL     12468<<ASSIGN  13959<>CALL    14468>>ASSIGN
FPT_PRECORD.KEY_
     11625**DCL     12471<<ASSIGN
FPT_PRECORD.V
     11627**DCL     12469--ASSIGN
FPT_PRECORD.V.DCB#
     11627**DCL     12470<<ASSIGN
FPT_PRECORD.V.KEYR#
     11628**DCL     12473<<ASSIGN
FPT_PRECORD.V.KEYS#
     11628**DCL     12472<<ASSIGN
FPT_PRECORD.V_
     11625**DCL     12469<<ASSIGN
FPT_PRIV_DISPJOB
     10860**DCL     12514<>CALL    12644<>CALL    12921<>CALL    12947<>CALL    13097<>CALL
FPT_PRIV_DISPJOB.V
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:364  
     10860**DCL     10860--DCLINIT
FPT_READ_JOBINFO
     11516**DCL     12455<<ASSIGN  13931<>CALL    14052<>CALL
FPT_READ_JOBINFO.BUF_
     11518**DCL     13929<<ASSIGN  14050<<ASSIGN
FPT_READ_JOBINFO.KEY_
     11516**DCL     13930<<ASSIGN  14051<<ASSIGN
FPT_READ_JOBINFO.STATION_
     11519**DCL     11520--REDEF
FPT_READ_JOBINFO.V
     11520**DCL     12456--ASSIGN
FPT_READ_JOBINFO.V.DCB#
     11520**DCL     12457<<ASSIGN
FPT_READ_JOBINFO.V.DVBYTE.REREAD#
     11531**DCL     11531--REDEF
FPT_READ_JOBINFO.V.INDX#
     11529**DCL     11529--REDEF
FPT_READ_JOBINFO.V.KEYS#
     11521**DCL     12458<<ASSIGN
FPT_READ_JOBINFO.V_
     11516**DCL     12456<<ASSIGN
FPT_READ_USE
     11477**DCL     12867<<ASSIGN  12875<>CALL    13814<<ASSIGN  13831<>CALL    14475<<ASSIGN  14482<>CALL
FPT_READ_USE.BUF_
     11479**DCL     12869<<ASSIGN  13816<<ASSIGN  14477<<ASSIGN
FPT_READ_USE.KEY_
     11477**DCL     12870<<ASSIGN  13830<<ASSIGN  14478<<ASSIGN
FPT_READ_USE.STATION_
     11480**DCL     11481--REDEF
FPT_READ_USE.V
     11481**DCL     12868--ASSIGN  13815--ASSIGN  14476--ASSIGN
FPT_READ_USE.V.DCB#
     11481**DCL     12873<<ASSIGN  13819<<ASSIGN  14481<<ASSIGN
FPT_READ_USE.V.DVBYTE.REREAD#
     11492**DCL     11492--REDEF
FPT_READ_USE.V.INDX#
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:365  
     11490**DCL     11490--REDEF
FPT_READ_USE.V.KEYR#
     11482**DCL     12872<<ASSIGN  13818<<ASSIGN  14480<<ASSIGN
FPT_READ_USE.V.KEYS#
     11482**DCL     12871<<ASSIGN  13817<<ASSIGN  14479<<ASSIGN
FPT_READ_USE.V_
     11477**DCL     12868<<ASSIGN  13815<<ASSIGN  14476<<ASSIGN
FPT_TIME
     11775**DCL     13343<<ASSIGN
FPT_TIME.TSTAMP_
     11778**DCL     13345<<ASSIGN
FPT_TIME.V
     11779**DCL     13344--ASSIGN
FPT_TIME.V_
     11775**DCL     13344<<ASSIGN
FPT_WAIT
     11761**DCL     13346<<ASSIGN  13385<>CALL
FPT_WAIT.V
     11762**DCL     13347--ASSIGN
FPT_WAIT.V.UNITS#
     11762**DCL     13348<<ASSIGN
FPT_WAIT.V_
     11761**DCL     13347<<ASSIGN
GET_INPUT_JOBSTATS IN PROCEDURE SETUP_SYSID_SRCH
     13243**LABEL   13283--GOTO
GET_JOBNAME_SYSID_REC
     14040**PROC    13179--CALL    13926--CALL
GET_JOBSTATS
     14068**PROC    12578--CALL    12807--CALL    13220--CALL    13229--CALL
GET_JOBSTATS#
     10312**DCL     12729<<ASSIGN  12732<<ASSIGN  12742<<ASSIGN  12745<<ASSIGN  12762<<ASSIGN  12774<<ASSIGN
     12785<<ASSIGN  12789<<ASSIGN  12794<<ASSIGN  12798<<ASSIGN  12801<<ASSIGN  12804>>IF
GET_OUTPUT_SYSIDS IN PROCEDURE SETUP_SYSID_SRCH
     13287**LABEL   13238--GOTO    13246--GOTO
HDR_CNT
     10609**DCL     13411<<ASSIGN  13469<<ASSIGN  13469>>ASSIGN  13473>>IF      13478<<ASSIGN  13486<<ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:366  
     13486>>ASSIGN  13517<<ASSIGN  13523>>IF      13529<<ASSIGN  13534<<ASSIGN  13534>>ASSIGN
HDR_CNT_SZ
     10350**DCL     13411>>ASSIGN  13473>>IF      13517>>ASSIGN  13523>>IF      14509<<ASSIGN  14511<<ASSIGN
HDR_MSG# IN PROCEDURE DISP_INPUT
     13406**DCL     13417<<ASSIGN  13421<<ASSIGN  13476>>ASSIGN
HELD_LINE_NOT_PRINTED
     10316**DCL     13412<<ASSIGN  13454>>IF      13456<<ASSIGN  13464>>IF      13470<<ASSIGN
I
     10329**DCL     12560<<DOINDEX 12561>>IF      12564>>DOCASE  12629<<DOINDEX 12631>>ASSIGN  12707<<DOINDEX
     12717>>ASSIGN  12829<<ASSIGN  12829>>ASSIGN
J
     10330**DCL     12984<<DOINDEX 12986>>DOCASE  12992>>IF      12994>>ASSIGN  12994>>ASSIGN  13002>>IF
     13004>>ASSIGN  13004>>ASSIGN  13011>>IF      13013>>ASSIGN  13013>>ASSIGN  13020>>ASSIGN  13020>>ASSIGN
     13023>>ASSIGN  13023>>ASSIGN  13135<<DOINDEX 13136>>DOCASE  13140>>CALLBLT 13140>>CALLBLT 13151>>ASSIGN
     13151>>ASSIGN  13155>>ASSIGN  13155>>ASSIGN  13158>>ASSIGN  13158>>ASSIGN  13167>>CALLBLT 13167>>CALLBLT
     13167>>CALLBLT 13408<<ASSIGN  13423<<DOINDEX 13425>>ASSIGN  13431>>DOINDEX 13520<<DOINDEX 13531>>ASSIGN
     13540>>IF      13542>>ASSIGN  13554<<DOINDEX 13558>>ASSIGN  13646<<DOINDEX 13650>>ASSIGN  13757<<DOINDEX
     13762>>ASSIGN
JOBSTATS_ACCT
     11070**DCL     10940--DCLINIT
JOBSTATS_LOOP IN PROCEDURE GET_JOBSTATS
     14118**LABEL   14211--GOTO
JOBSTATS_NAME
     11055**DCL     10936--DCLINIT
JOBSTATS_OPEN#
     10308**DCL     12504<<ASSIGN  12841>>IF      13176>>IF      13904<<ASSIGN  13920>>IF
JOB_COMPLETED
     10327**DCL     13207<<ASSIGN  13266<<ASSIGN  13933>>IF      13981>>IF
K
     10331**DCL     12628<<ASSIGN  12637<<ASSIGN  12637>>ASSIGN  12646>>IF      12649<<ASSIGN  12649>>ASSIGN
     12699>>IF      13305<<DOINDEX 13307>>DOCASE  13318>>CALLBLT 13318>>CALLBLT 13431<<DOINDEX 13434>>ASSIGN
     13739<<ASSIGN  13745<<ASSIGN  13745>>ASSIGN  13746>>IF      13749>>ASSIGN  13750>>IF
K_NOTIFY
      9916**DCL     12508--CALL    12848--CALL
LFPT_PRECORD IN PROCEDURE READ_OUTPUT_RECORD
     14453**DCL     14468<<ASSIGN  14472<>CALL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:367  
LFPT_PRECORD.KEY_ IN PROCEDURE READ_OUTPUT_RECORD
     14453**DCL     14470<<ASSIGN
LFPT_PRECORD.V IN PROCEDURE READ_OUTPUT_RECORD
     14455**DCL     14469--ASSIGN
LFPT_PRECORD.V_ IN PROCEDURE READ_OUTPUT_RECORD
     14453**DCL     14469<<ASSIGN
LOOP IN PROCEDURE CHECK_SYSIDS
     13829**LABEL   13842--EXIT    13856--EXIT    13860--EXIT
M$CLOSE
        27**DCL-ENT 12845--CALL    12860--CALL    12906--CALL    12931--CALL    12938--CALL    13903--CALL
     14259--CALL
M$DELREC
        29**DCL-ENT 14221--CALL
M$IBEX1_NUM
      9888**DCL     12457>>ASSIGN  12496<>CALL    12508<>CALL    12653<>CALL    12844>>ASSIGN  12846<>CALL
     12848<>CALL    12854<>CALL    12856--IF      12859>>ASSIGN  12927--IF      12930>>ASSIGN  13898>>ASSIGN
     13902>>ASSIGN  13907>>ASSIGN  13977<>CALL    14248<>CALL
M$IBEX_NUM
      9887**DCL     12448>>ASSIGN  12464>>ASSIGN  12470>>ASSIGN  12865>>ASSIGN  12873>>ASSIGN  12905--IF
     12936>>ASSIGN  12937--IF      13819>>ASSIGN  14219>>ASSIGN  14242<>CALL    14257>>ASSIGN  14258--IF
     14288<>CALL    14481>>ASSIGN
M$JOBSTATS
        92**DCL-ENT 13243--CALL    13262--CALL    13288--CALL    13618--CALL    13700--CALL    13727--CALL
     14118--CALL    14322--CALL
M$OPEN
        27**DCL-ENT 13909--CALL
M$PFIL
        29**DCL-ENT 12866--CALL    13808--CALL
M$PRECORD
        31**DCL-ENT 13959--CALL    14472--CALL
M$READ
        28**DCL-ENT 12875--CALL    13831--CALL    13931--CALL    14052--CALL    14482--CALL
M$RPRIV
        86**DCL-ENT 12921--CALL    12947--CALL
M$SPRIV
        86**DCL-ENT 12514--CALL    12644--CALL    13097--CALL
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:368  
M$TRMPRG
        52**DCL-ENT 13361--CALL
M$WAIT
        85**DCL-ENT 13385--CALL
MORE_2_WAIT
     10320**DCL     13351<<ASSIGN  13370>>IF      14348<<ASSIGN
MOVE_STATS IN PROCEDURE GET_JOBSTATS
     14193**LABEL   14185--GOTO
MSG# IN PROCEDURE DISP_INPUT
     13405**DCL     13416<<ASSIGN  13420<<ASSIGN  13483>>ASSIGN
NLINES
     10351**DCL     13468<>CALL    13469>>ASSIGN  13477<>CALL    13478>>ASSIGN  13484<>CALL    13486>>ASSIGN
     13527<>CALL    13529>>ASSIGN  13533<>CALL    13534>>ASSIGN
NONE_THERE IN PROCEDURE SETUP_SYSID_SRCH
     13251**LABEL   13243--CALLALT
NOTIFYING
     10323**DCL     12552<<ASSIGN  12610<<ASSIGN  12916>>IF      12942>>IF      13214>>IF      13237>>IF
     13493>>IF      13657>>IF      13671>>IF      14168>>IF
NOTIFY_Q_FLAGS
     10325**DCL     12556<<ASSIGN  12557<<ASSIGN  12558<<ASSIGN  12561>>IF
NOTIFY_WAIT IN PROCEDURE CHECK_WAIT
     13335**ENTRY   12602--CALL
NOT_FND IN PROCEDURE DISP_SYSID_SUBFILE
     13723**DCL     13756<<ASSIGN  13766<<ASSIGN  13771>>IF
NO_CANCEL IN PROCEDURE DISP_ONE_OUTPUT
     13702**LABEL   13695--GOTO
NO_CHANGE IN PROCEDURE SETUP_SYSID_SRCH
     13237**LABEL   13233--CALLALT
NRECS_DEL
     10340**DCL     13823<<ASSIGN  13863>>IF      14222<<ASSIGN  14222>>ASSIGN
NRECS_READ
     10338**DCL     13821<<ASSIGN  13833<<ASSIGN  13833>>ASSIGN  13863>>IF      13962<<ASSIGN  13962>>ASSIGN
NRECS_SKIP
     10339**DCL     13822<<ASSIGN  13863>>IF      14341<<ASSIGN  14341>>ASSIGN
NSTATUS_FLG
     10314**DCL     12401<<ASSIGN  13070>>IF      13992>>IF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:369  
NUM_LISTED
     10608**DCL     13409<<ASSIGN  13485<<ASSIGN  13485>>ASSIGN  13493>>IF      13502>>IF      13504>>ASSIGN
N_SRCH IN PROCEDURE DISP_SYSID_SUBFILE
     13740**LABEL   13748--EXIT
OPEN_JOBSTATS_FILE
     13878**PROC    13178--CALL    13922--CALL
OPEN_USEFILE
     14255**PROC    13066--CALL    13802--CALL    14139--CALL    14233--CALL
OUTPUT_FLG
     10326**DCL     12627<<ASSIGN  12690<<ASSIGN  12694<<ASSIGN  12699>>IF      13206<<ASSIGN  13662<<ASSIGN
     14312>>IF      14325>>IF      14350>>IF
OUTPUT_NO_CHANGE IN PROCEDURE DISP_SYSID_SRCH_OQ
     13671**LABEL   13663--CALLALT
P$
      9950**DCL     12589<<ASSIGN  12631<<ASSIGN  12632>>ASSIGN  12653>>CALL    12658>>IF      12666>>ASSIGN
     12672>>IF      12717<<ASSIGN  12718>>ASSIGN  12817>>IF      12982>>IF      12984>>DOINDEX 12986>>DOCASE
     12992>>IF      12994>>ASSIGN  12994>>ASSIGN  13002>>IF      13004>>ASSIGN  13004>>ASSIGN  13011>>IF
     13013>>ASSIGN  13013>>ASSIGN  13020>>ASSIGN  13020>>ASSIGN  13023>>ASSIGN  13023>>ASSIGN  13135>>DOINDEX
     13136>>DOCASE  13140>>CALLBLT 13140>>CALLBLT 13151>>ASSIGN  13151>>ASSIGN  13155>>ASSIGN  13155>>ASSIGN
     13158>>ASSIGN  13158>>ASSIGN  13167>>CALLBLT 13167>>CALLBLT 13167>>CALLBLT 13305>>DOINDEX 13307>>DOCASE
     13318>>CALLBLT 13318>>CALLBLT 13746>>IF      13749>>ASSIGN  13750>>IF      14369>>CALLBLT 14369>>CALLBLT
P$B.CODE
     12053**DCL     12632>>ASSIGN  12704<<ASSIGN  12718>>ASSIGN  12822<<ASSIGN  12828<<ASSIGN  12986>>DOCASE
     13136>>DOCASE  13307>>DOCASE  13750>>IF
P$B.CPOS
     12071**DCL     12653<>CALL    13167<<CALLBLT 13749>>ASSIGN
P$B.NSUBLKS
     12057**DCL     12614>>IF      12629>>DOINDEX 12686>>IF      12702<<ASSIGN  12707>>DOINDEX 12982>>IF
     12984>>DOINDEX 12992>>IF      13002>>IF      13011>>IF      13135>>DOINDEX 13305>>DOINDEX 13746>>IF
P$B.SUBLK$
     12078**DCL     12402>>ASSIGN  12631>>ASSIGN  12703<<ASSIGN  12717>>ASSIGN  12986>>DOCASE  12992>>IF
     12994>>ASSIGN  12994>>ASSIGN  12994>>ASSIGN  12994>>ASSIGN  13002>>IF      13004>>ASSIGN  13004>>ASSIGN
     13004>>ASSIGN  13004>>ASSIGN  13011>>IF      13013>>ASSIGN  13013>>ASSIGN  13013>>ASSIGN  13013>>ASSIGN
     13020>>ASSIGN  13020>>ASSIGN  13023>>ASSIGN  13023>>ASSIGN  13136>>DOCASE  13140>>CALLBLT 13140>>CALLBLT
     13151>>ASSIGN  13151>>ASSIGN  13155>>ASSIGN  13155>>ASSIGN  13158>>ASSIGN  13158>>ASSIGN  13167>>CALLBLT
     13167>>CALLBLT 13167>>CALLBLT 13307>>DOCASE  13318>>CALLBLT 13318>>CALLBLT 13749>>ASSIGN  13750>>IF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:370  
     14369>>CALLBLT 14369>>CALLBLT
P$B.TEMP
     12046**DCL     12401>>ASSIGN  12402>>ASSIGN
P$PCB
     12141**DCL        15--PROC    12342--IF      12371--ENTRY   12393--ENTRY   12418--ENTRY   12546--IF
P$PCB.OUT$
     12154**DCL     12401>>ASSIGN  12402>>ASSIGN  12609>>ASSIGN
P$S.COUNT
     12114**DCL     12117--IMP-SIZ 12662<<ASSIGN  12663>>ASSIGN  12664--ASSIGN  12994>>ASSIGN  13004>>ASSIGN
     13013>>ASSIGN  13020>>ASSIGN  13023>>ASSIGN  13151>>ASSIGN  13155>>ASSIGN  13158>>ASSIGN  13167>>CALLBLT
     13318>>CALLBLT 14268<<ASSIGN  14269>>ASSIGN  14270--ASSIGN
P$S.NSUBLKS
     12100**DCL     12658>>IF      12672>>IF
P$S.TEXT
     12117**DCL     12663<<ASSIGN  12994>>ASSIGN  13004>>ASSIGN  13013>>ASSIGN  13020>>ASSIGN  13023>>ASSIGN
     13151>>ASSIGN  13155>>ASSIGN  13158>>ASSIGN  13167>>CALLBLT 13318>>CALLBLT 14269<<ASSIGN
P$S.TEXTC$
     12109**DCL     12664<<ASSIGN  12666>>ASSIGN  13140>>CALLBLT 13140>>CALLBLT 14270<<ASSIGN  14369>>CALLBLT
     14369>>CALLBLT
PAST_NOTIFY_WAIT IN PROCEDURE CHECK_WAIT
     13342**LABEL   13333--GOTO
PRINT_SUBMIT_MESS
     14377**PROC    12757--CALL    13075--CALL    13274--CALL    13996--CALL
P_DUMMY
     10618**DCL     12588<<ASSIGN  12589--ASSIGN
Q_CRITERIA
     11899**DCL     12567<<ASSIGN  12571<<ASSIGN  12575<<ASSIGN  12728>>ASSIGN  12741>>ASSIGN  12975<<ASSIGN
     13049--ASSIGN
Q_CRITERIA.ACCT#
     11903**DCL     12979<<ASSIGN  12980<<ASSIGN  12993<<ASSIGN  12994<<ASSIGN
Q_CRITERIA.DEVTYP#
     11911**DCL     13023<<ASSIGN
Q_CRITERIA.FORM#
     11912**DCL     13020<<ASSIGN
Q_CRITERIA.NOTACCT#
     11908**DCL     12989<<ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:371  
Q_CRITERIA.NOTFORM#
     11909**DCL     13017<<ASSIGN
Q_CRITERIA.NOTTNAME#
     11909**DCL     12998<<ASSIGN
Q_CRITERIA.NOTWSN#
     11908**DCL     12999<<ASSIGN  13008<<ASSIGN
Q_CRITERIA.RUNNING#
     11907**DCL     12568<<ASSIGN  12572<<ASSIGN  12977<<ASSIGN
Q_CRITERIA.WSN#
     11903**DCL     13003<<ASSIGN  13004<<ASSIGN  13012<<ASSIGN  13013<<ASSIGN
READ_ERR IN PROCEDURE READ_OUTPUT_RECORD
     14495**LABEL   14482--CALLALT
READ_JOBSTATS_FILE
     13918**PROC    13267--CALL    13674--CALL    13767--CALL
READ_OUTPUT_RECORD
     14402**PROC    13659--CALL
READ_OUTPUT_RECORD_RET IN PROCEDURE READ_OUTPUT_RECORD
     14491**LABEL   14497--GOTO
RECORD_NOT_THERE IN PROCEDURE READ_JOBSTATS_FILE
     13965**LABEL   13959--CALLALT
RES$
      9958**DCL     13050<<ASSIGN  13051>>ASSIGN  13055>>ASSIGN  13083<<ASSIGN  13084>>ASSIGN  13088>>ASSIGN
     13222>>ASSIGN  13224>>ASSIGN
RESULTS_
     11241**DCL     12498<<ASSIGN  13054>>ASSIGN  13087>>ASSIGN  13226>>ASSIGN  13279>>ASSIGN  14210<<ASSIGN
     14210>>ASSIGN
RETURN_FLG IN PROCEDURE CHECK_SYSIDS
     13798**DCL     13800<<ASSIGN  13804<<ASSIGN  13806>>IF      13811<<ASSIGN  13827>>IF      13841<<ASSIGN
     13854<<ASSIGN  13863>>IF
SEG$2.ERRBUF
     10099**DCL     12483--ASSIGN  12484--ASSIGN  12653--CALL    12813--IF      12854--CALL    12880--CALL
     12893--ASSIGN  12894--ASSIGN  12897--CALL    12899--CALL    12911--IF      12924--CALL    13255--CALL
     13732--CALL    13809--CALL    13852--CALL    13977--CALL    14058--CALL    14248--CALL    14286--ASSIGN
     14287--ASSIGN  14288--CALL    14289<>CALL    14290--ASSIGN  14291--ASSIGN  14499--CALL
SEG$2.LLDCB#
     10094**DCL     14506--IF      14506--IF      14509--ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:372  
SEG2$
      9875**DCL     10074--IMP-PTR 12483>>ASSIGN  12484>>ASSIGN  12653>>CALL    12813>>IF      12854>>CALL
     12880>>CALL    12893>>ASSIGN  12894>>ASSIGN  12897>>CALL    12899>>CALL    12911>>IF      12924>>CALL
     13255>>CALL    13732>>CALL    13809>>CALL    13852>>CALL    13977>>CALL    14058>>CALL    14248>>CALL
     14286>>ASSIGN  14287>>ASSIGN  14288>>CALL    14289>>CALL    14290>>ASSIGN  14291>>ASSIGN  14499>>CALL
     14506>>IF      14506>>IF      14509>>ASSIGN
SEG4$
      9877**DCL     12497<>CALL    12498>>ASSIGN  12851<>CALL    12926<>CALL    13050>>ASSIGN  13083>>ASSIGN
     14202<>CALL
SETUP_DUMMY_SUBMIT_MESS
     14366**PROC    12756--CALL    13074--CALL    13995--CALL
SETUP_HDR_CNT_SZ
     14504**PROC    13410--CALL    13516--CALL
SETUP_Q_SRCH
     12951**PROC    12722--CALL    12735--CALL
SETUP_Q_SRCH_JOBSTATS IN PROCEDURE SETUP_Q_SRCH
     13042**ENTRY   12577--CALL
SETUP_SYSID_SRCH
     13062**PROC    12592--CALL    12761--CALL    12773--CALL    12783--CALL    13839--CALL
SETUP_SYSID_SRCH_RETURN IN PROCEDURE SETUP_SYSID_SRCH
     13294**LABEL   13076--GOTO    13211--CALLALT 13212--GOTO    13269--GOTO    13288--CALLALT
SN$
      9959**DCL     13051<<ASSIGN  13052>>ASSIGN  13056>>ASSIGN  13084<<ASSIGN  13085>>ASSIGN  13089>>ASSIGN
     13222<<ASSIGN  13223>>ASSIGN  13225>>ASSIGN  14190<<ASSIGN  14190>>ASSIGN  14191>>ASSIGN
SOMETHING_CHANGED
     10321**DCL     13234<<ASSIGN  13251<<ASSIGN  13268<<ASSIGN  13352<<ASSIGN  13372>>IF      13383>>IF
     13389>>IF      13668<<ASSIGN
STAT$
      9957**DCL     13052<<ASSIGN  13085<<ASSIGN  13223<<ASSIGN  13423>>DOINDEX 13425>>ASSIGN  13431>>DOINDEX
     13434>>ASSIGN  13520>>DOINDEX 13531>>ASSIGN  13554>>DOINDEX 13558>>ASSIGN  13646>>DOINDEX 13650>>ASSIGN
     13736>>ASSIGN  13757>>DOINDEX 13762>>ASSIGN  14193<<ASSIGN  14193>>ASSIGN  14194>>ASSIGN
SUBMIT_LOOP
     12749**LABEL   12748--REMEMBR
SUBMIT_LOOP_REMEM
     10342**DCL     12748<<REMEMBR 14000>>UNWIND
SYSIDBUF
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:373  
     10551**DCL     12507<<ASSIGN  12869--ASSIGN  13816--ASSIGN  14242--CALL    14477--ASSIGN
SYSIDBUF.ACCT
     10556**DCL     13630<<ASSIGN  13712<<ASSIGN  13942>>ASSIGN  14024>>ASSIGN  14392<<ASSIGN
SYSIDBUF.COMMENT
     10558**DCL     13112>>ASSIGN  13632<<ASSIGN  13714<<ASSIGN  13944>>ASSIGN  14026>>ASSIGN  14394<<ASSIGN
SYSIDBUF.JNAME
     10557**DCL     13631<<ASSIGN  13713<<ASSIGN  13943>>ASSIGN  14012<<ASSIGN  14025>>ASSIGN  14393<<ASSIGN
SYSIDBUF.STATUS
     10552**DCL     14324>>ASSIGN  14354<<ASSIGN  14356>>IF      14361<<ASSIGN  14488<<ASSIGN
SYSIDBUF.STATUS.CODE
     10553**DCL     13245>>IF      13664>>IF      14350>>IF      14389<<ASSIGN
SYSIDBUF.STATUS.PRIO
     10554**DCL     14350>>IF      14390<<ASSIGN
SYSIDBUF.STATUS.TORUN
     10555**DCL     14350>>IF      14391<<ASSIGN
SYSID_CRITERIA
     11927**DCL     13081--ASSIGN  13091<<ASSIGN
SYSID_CRITERIA.ACCT#
     11931**DCL     13100<<ASSIGN  13106<<ASSIGN  13108<<ASSIGN  13219<<ASSIGN
SYSID_CRITERIA.SYSID#
     11932**DCL     13127<<ASSIGN  13141<<ASSIGN  13198<<ASSIGN  13216>>IF      13261>>ASSIGN  13777>>ASSIGN
SYSID_CRITERIA.SYSID1#
     11932**DCL     13128<<ASSIGN  13142<<ASSIGN  13199<<ASSIGN
SYSTEM_OK#
     10313**DCL     12506<<ASSIGN  12515<<ASSIGN  12640>>IF      12650<<ASSIGN  12919>>IF      12945>>IF
     13093>>IF      13099<<ASSIGN  13180>>IF
TCHKEYBUF IN PROCEDURE READ_OUTPUT_RECORD
     14437**DCL     14464<<ASSIGN  14470--ASSIGN  14478--ASSIGN  14486>>ASSIGN
TCHKEYBUF.NUM IN PROCEDURE READ_OUTPUT_RECORD
     14440**DCL     14466<<ASSIGN  14484>>IF
TCHKEYBUF.SYSID IN PROCEDURE READ_OUTPUT_RECORD
     14439**DCL     14465<<ASSIGN  14484>>IF
TEMP
     10332**DCL     12591<<ASSIGN  12765<<ASSIGN  12766>>IF      12782<<ASSIGN  13127>>ASSIGN  13128>>ASSIGN
     13140<<CALLBLT 13141>>ASSIGN  13142>>ASSIGN  13143>>ASSIGN  13145>>IF      13180>>IF      13189<<ASSIGN
     13191>>ASSIGN  13198>>ASSIGN  13199>>ASSIGN  13200>>ASSIGN  13824<<ASSIGN  13834>>IF      13837<<ASSIGN
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:374  
     13928>>ASSIGN  13949>>ASSIGN  14032>>ASSIGN  14062<<ASSIGN  14369<<CALLBLT 14370>>ASSIGN
TEMP$
      9952**DCL     12671<<ASSIGN  12672>>IF      12675>>ASSIGN  12677>>IF      12680>>ASSIGN
TEMP2
     10333**DCL     13825<<ASSIGN  13834>>IF      13838<<ASSIGN  13957<<ASSIGN  13960>>IF      13965>>IF
TEMP3
     10334**DCL     13345--ASSIGN
TEMPBUF
     10301**DCL     10302--REDEF   12661--ASSIGN  14267--ASSIGN
TEMPBUF$
      9955**DCL     12661<<ASSIGN  12662>>ASSIGN  12663>>ASSIGN  12663>>ASSIGN  12664>>ASSIGN  12664>>ASSIGN
     12666<<ASSIGN  12667<>CALL    14267<<ASSIGN  14268>>ASSIGN  14269>>ASSIGN  14269>>ASSIGN  14270>>ASSIGN
     14270>>ASSIGN  14271<>CALL
TEXTC.SIZ
     10135**DCL     10136--IMP-SIZ 13140>>CALLBLT 14369>>CALLBLT
TEXTC.TEXT
     10136**DCL     13140>>CALLBLT 14369>>CALLBLT
TRMPRG_ERR IN PROCEDURE CHECK_WAIT
     13363**LABEL   13361--CALLALT
USEFID_OPEN#
     10309**DCL     12505<<ASSIGN  12657<<ASSIGN  13064>>IF      13801>>IF      14138>>IF      14232>>IF
     14281<<ASSIGN
VLA$INPUT.ACCT
     11819**DCL     13630>>ASSIGN
VLA$INPUT.JNAME
     11821**DCL     13631>>ASSIGN
VLA$INPUT.PRIO
     11814**DCL     13426>>IF      13439>>IF      13449>>IF      13457>>IF      13464>>IF      13560>>DOCASE
     13588>>IF      13596>>IF
VLA$INPUT.SYSID
     11819**DCL     13612>>ASSIGN  13628>>ASSIGN
VLA$OUTPUT.ACCT
     11855**DCL     13712>>ASSIGN
VLA$OUTPUT.JNAME
     11855**DCL     13713>>ASSIGN
VLA$OUTPUT.NUM
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:375  
     11854**DCL     13651>>IF      13656>>ASSIGN  13697>>ASSIGN  13711>>ASSIGN  13763>>IF
VLA$OUTPUT.SYSID
     11854**DCL     13655>>ASSIGN  13696>>ASSIGN  13709>>ASSIGN  13710>>ASSIGN
VLP_JOBNAME.JOBNAME#
     11954**DCL     13119<<ASSIGN  13151<<ASSIGN  13173>>IF      13192>>ASSIGN  13778>>ASSIGN  13951>>ASSIGN
     14013>>ASSIGN  14043>>ASSIGN  14372<<ASSIGN  14382>>ASSIGN
VLR$INPUT.FOUND
     11797**DCL     13423>>DOINDEX 13431>>DOINDEX 13554>>DOINDEX
VLR$INPUT.J
     11797**DCL     13425--ASSIGN  13434--ASSIGN  13558--ASSIGN
VLR$OUTPUT.F
     11838**DCL     13531--ASSIGN  13650--ASSIGN  13762--ASSIGN
VLR$OUTPUT.FOUND
     11838**DCL     13520>>DOINDEX 13646>>DOINDEX 13736<<ASSIGN  13757>>DOINDEX
VLR_JOBSTATS_CHECK
     11968**DCL     13260--ASSIGN  14320--ASSIGN  14368<<ASSIGN
VLR_JOBSTATS_CHECK.AHEAD
     11969**DCL     14331>>ASSIGN  14338>>ASSIGN  14391>>ASSIGN
VLR_JOBSTATS_CHECK.CODE
     11968**DCL     13263>>IF      13271>>IF      13280>>IF      13280>>IF      14335>>ASSIGN  14336>>IF
     14344>>IF      14344>>IF      14344>>IF      14389>>ASSIGN
VLR_JOBSTATS_CHECK.FCODE
     11970**DCL     14328>>ASSIGN
VLR_JOBSTATS_CHECK.PRIO
     11969**DCL     14336>>IF      14339>>IF      14344>>IF      14390>>ASSIGN
VLR_JOBSTATS_CHECK.SYSID
     11970**DCL     14370<<ASSIGN  14380>>ASSIGN  14387>>ASSIGN
WAITING
     10319**DCL     12790<<ASSIGN  13214>>IF      13237>>IF      13349<<ASSIGN  13388<<ASSIGN  13657>>IF
     13671>>IF
WAIT_BELL
     10318**DCL     13303<<ASSIGN  13315<<ASSIGN  13375>>IF      13392>>IF
WAIT_DONE
     10317**DCL     13302<<ASSIGN  13310<<ASSIGN  13313<<ASSIGN  13326>>ASSIGN  13337<<ASSIGN  13370>>IF
WAIT_DONE IN PROCEDURE CHECK_WAIT
     13388**LABEL   13360--GOTO    13364--CALLALT 13368--CALLALT 13371--GOTO
PL6.E3A0      #001=CPK$CHECK File=CPK$CHECK.:E05TSI                              TUE 07/29/97 11:55 Page:376  
WAIT_INT
     10610**DCL     13304<<ASSIGN  13318<<CALLBLT 13327>>ASSIGN  13338<<ASSIGN  13348>>ASSIGN
WRITE_USEFILE_REC
     14227**PROC    13634--CALL    13716--CALL    14396--CALL
XSJ_INFOKEY
     11706**DCL     13927<<ASSIGN  13930--ASSIGN
XSJ_INFOKEY.SYSID#
     11706**DCL     13928<<ASSIGN
XSJ_JOBINFO
     11719**DCL     13688--ASSIGN  13929--ASSIGN  13937--ASSIGN  13984<<ASSIGN  14028--ASSIGN
XSJ_JOBINFO.ACCT#
     11721**DCL     13950>>ASSIGN
XSJ_NAMEKEY
     11747**DCL     14042<<ASSIGN  14051--ASSIGN
XSJ_NAMEKEY.ACCT#
     11748**DCL     14046<<ASSIGN  14048<<ASSIGN
XSJ_NAMEKEY.JOBNAME#
     11747**DCL     14043<<ASSIGN
XSJ_NAMEREC
     11734**DCL     14050--ASSIGN
XSJ_NAMEREC.SYSID#
     11734**DCL     14049<<ASSIGN  14062>>ASSIGN

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:377  
     2333        1        /*T***********************************************************/
     2334        2        /*T*                                                         */
     2335        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2336        4        /*T*                                                         */
     2337        5        /*T***********************************************************/
     2338        6        /**********************************************************************/
     2339        7        /*F*   NAME:   CPK$CHECK_OUTPUT
     2340        8               PURPOSE: To output the jobstats that have been returned
     2341        9        DCL SYSTEM_OK# BIT(1) ;
     2342       10                       from the M$JOBSTATS.
     2343       11               DESCRIPTION: CPK$CHECK_OUTPUT is passed a pointer to the jobstats
     2344       12                       to be used as the driver for the output using X$FORMAT.
     2345       13        */
     2346       14        /*D*   NAME:   CPK$CHECK_OUTPUT
     2347       15               CALL:   CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     2348       16               INTERFACE: X$FORMAT
     2349       17               INPUT:  CH_XFORMAT  - is the data to be output using X$FORMAT.
     2350       18               OUTPUT: Specified message to device assigned to M$LL.
     2351       19               DESCRIPTION: The jobstats that have been received is output using
     2352       20                       X$FORMAT.
     2353       21        */
     2354       22        /**********************************************************************/
     2355       23        CPK$CHECK_OUTPUT: PROC (CH_XFORMAT,NLINES) ;
     2356       24
     2357       25             /***** Includes *****/
     2358       26
     2359       27        %INCLUDE B$JIT ;
     2360      317        %INCLUDE CP_6 ;
     2361      398        %INCLUDE CP_6_SUBS ;
     2362      938        %INCLUDE CP_SUBS_C ;
     2363     1855        %INCLUDE CP_MACROS_C ;
     2364     2607        %INCLUDE XU_MACRO_C ;
     2365     5713        %INCLUDE CP_DATA_R ;
     2366     8276        %INCLUDE B_ERRORS_C ;
     2367     9403        %INCLUDE OC$MESSHD_C ;
     2368     9424        %INCLUDE XU_FORMAT_C ;
     2369     9586        %INCLUDE XSJ_MAC_C ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:378  
     2370     9665        %INCLUDE XSJ_SUBS_C ;
     2371     9692        %INCLUDE NK_VFC_C ;
     2372     9766
     2373     9767             /***** Parameters *****/
     2374     9768
     2375     9769        %CH_XFORMAT                           ( FPTN = CH_XFORMAT,
     2376     9770              STCLASS=" ") ;
     2377     9794    1     DCL NLINES UBIN WORD ;  /* Number of lines to print the output */
     2378     9795
     2379     9796             /***** Based data *****/
     2380     9797
     2381     9798        %VLA_JOBSTATS_ISRCH                       ( FPTN = VLA$INPUT, STCLASS = BASED) ;
     2382     9825        %VLA_JOBSTATS_OSRCH                       ( FPTN=VLA$OUTPUT, STCLASS = BASED) ;
     2383     9842        %SEG$2 ;
     2384     9902    1   DCL CH$PART (0:15) BIT(1) BASED ;
     2385     9903        %VLP_JOBNAME (FPTN=VLP$JOBNAME,STCLASS=BASED) ;
     2386     9917        %XSJ_JOBINFO( FPTN = XSJ$JOBINFO, STCLASS = BASED) ;
     2387     9932        %FPT_WRITE( FPTN = FPT$WRITE, STCLASS = BASED) ;
     2388     9963        %F$DCB (DCBN=F$DCB) ;
     2389    10020
     2390    10021             /***** Ptr declarations *****/
     2391    10022
     2392    10023    1   DCL BUF$ PTR ;
     2393    10024    1   DCL TEMP$ PTR ;
     2394    10025
     2395    10026             /***** Entries *****/
     2396    10027
     2397    10028    1   DCL X$FORMAT ENTRY(1) ;
     2398    10029    1   DCL CPK$FDS_OUTPUT ENTRY(2) ALTRET ;
     2399    10030
     2400    10031             /***** Constant data *****/
     2401    10032
     2402    10033        %F_FDS                                  ( NAME = CF_FDS,
     2403    10034              STCLASS = CONSTANT,
     2404    10035              TRUNC = NO,
     2405    10036              DVFC = %VFC_TRANSITION1 ,
     2406    10037              WRAPTAB = 4) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:379  
     2407    10150    1   DCL BLANK_FMT CHAR(0) CONSTANT INIT('    ') ;
     2408    10151    1   DCL O_BELL BIT(9) CONSTANT INIT('007'O) ;
     2409    10152    1   DCL BELL REDEF O_BELL CHAR(1) ;
     2410    10153    1   DCL INPUT_HDR_FMT CHAR(0) CONSTANT INIT('%0A') ;
     2411    10154    1   DCL INPUT_HDR CHAR(0) CONSTANT INIT
     2412    10155    1         (' AHE PRI SYSID O A F D MAX TIME   MEM ACCOUNT  1 *PARTITION* 16 JOB NAME') ;
     2413    10156    1   DCL RUN_HDR CHAR(0) CONSTANT INIT
     2414    10157    1         (' STA PRI SYSID O A F D MAX TIME   MEM ACCOUNT  PART JOB NAME') ;
     2415    10158    1   DCL DFLT_OUTPUT_HDR_FMT CHAR(0) CONSTANT INIT('%0A') ;
     2416    10159    1   DCL DFLT_OUTPUT_HDR CHAR(0) CONSTANT INIT
     2417    10160    1         ('  STATUS    SYSID   ACCOUNT PR CP   HC GRAN   FORM      WOD DEV JOB NAME') ;
     2418    10161    1   DCL INPUT_MESS_FMT CHAR(0) CONSTANT INIT
     2419    10162    1         ('%4D%1X%3D%1X%5D%1X%1A%1X%1A%1X%1A%1X%1A%1X%8A%2X%4D%1X%8A%1X%16A%1X%>A') ;
     2420    10163    1   DCL RUN_MESS_FMT CHAR(0) CONSTANT INIT
     2421    10164    1         ('%4A%1X%3D%1X%5D%1X%1A%1X%1A%1X%1A%1X%1A%1X%8A%2X%4D%1X%8A%2X%2D%2X%>A') ;
     2422    10165    1   DCL OUTPUT_NOWAIT_MESS_FMT CHAR(0) CONSTANT INIT
     2423    10166    1         (' %8A %5D-%D%20-%8>A %2D%3D %1A%3D %4D %6>A %8>A %2A%2A %>A') ;
     2424    10167    1   DCL OUTPUT_NOWAIT_MESS_FMT2 CHAR(0) CONSTANT INIT
     2425    10168    1         (' %8A %2D-%D%20-%8>A %2D%3D %1A%3D %4D %6>A %8>A %2A%2A %>A') ;
     2426    10169    1   DCL OUTPUT_WAIT_MESS_FMT CHAR(0) CONSTANT INIT
     2427    10170    1         ('%3D %5A %5D-%D%20-%8>A %2D%3D %1A%3D %4D %6>A %8>A %2A%2A %>A') ;
     2428    10171    1   DCL OUTPUT_WAIT_MESS_FMT2 CHAR(0) CONSTANT INIT
     2429    10172    1         ('%3D %5A %2D-%D%20-%8>A %2D%3D %1A%3D %4D %6>A %8>A %2A%2A %>A') ;
     2430    10173    1   DCL SYSID_RUN_MESS_FMT CHAR(0) CONSTANT INIT
     2431    10174    1         ('%D %<>A.%<>A running %<>A/%<>A%Q - %<>A') ;
     2432    10175    1   DCL SYSID_FOLL_MESS_FMT CHAR(0) CONSTANT INIT
     2433    10176    1         ('%D %<>A.%<>A waiting to follow %D%N(,%D%)%Q - %<>A') ;
     2434    10177    1   DCL SYSID_WPART_MESS_FMT CHAR(0) CONSTANT INIT
     2435    10178    1         ('%D %<>A.%<>A no partition available.%Q - %<>A') ;
     2436    10179    1   DCL SYSID_OTHER_MESS_FMT CHAR(0) CONSTANT INIT
     2437    10180    1         ('%D %<>A.%<>A stuck in some priority queue.%Q - %<>A') ;
     2438    10181    1   DCL SYSID_WPS_MESS_FMT CHAR(0) CONSTANT INIT
     2439    10182    1         ('%D %<>A.%<>A waiting for disk packset.%Q - %<>A') ;
     2440    10183    1   DCL SYSID_WAIT_MESS_FMT CHAR(0) CONSTANT INIT
     2441    10184    1         ('%D %<>A.%<>A waiting %D to run at prio %D%Q - %<>A') ;
     2442    10185    1   DCL SYSID_DEFERRED_MESS_FMT CHAR(0) CONSTANT INIT
     2443    10186    1         ('%D %<>A.%<>A deferred to %..2U%Q - %<>A') ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:380  
     2444    10187    1   DCL SYSID_OUTPUT_MESS_FMT CHAR(0) CONSTANT INIT
     2445    10188    1         ('%D-%D %<>A.%<>A %<>A on %<>A%<>A@%<>A%Q - %<>A') ;
     2446    10189    1   DCL SYSID_OUTPUT_WAIT_MESS_FMT CHAR(0) CONSTANT INIT
     2447    10190    1         ('%D-%D %<>A.%<>A waiting %D to %<>A on %<>A%<>A@%<>A%Q - %<>A') ;
     2448    10191    1   DCL SYSID_OUTPUT_NODEV_MESS_FMT CHAR(0) CONSTANT INIT
     2449    10192    1         ('%D-%D %<>A.%<>A waiting %<>A to %<>A on %<>A%<>A@%<>A%Q - %<>A') ;
     2450    10193    1   DCL NONE_MESS_FMT CHAR(0) CONSTANT INIT ('...None') ;
     2451    10194    1   DCL NONE_IN_MESS_FMT CHAR(0) CONSTANT INIT ('...None (In)') ;
     2452    10195    1   DCL NONE_RUN_MESS_FMT CHAR(0) CONSTANT INIT ('...None (Run)') ;
     2453    10196    1   DCL NONE_OUT_MESS_FMT CHAR(0) CONSTANT INIT ('...None (Out)') ;
     2454    10197    1   DCL TIME_DI_MESS_HDR CHAR(0) CONSTANT INIT(' %..2U %D*%D <%D%Q%A') ;
     2455    10198    1   DCL NO_TERM_OUT_HDR CHAR(0) CONSTANT INIT('%D No terminal output found.') ;
     2456    10199    1   DCL NO_SUCH_MESS_HDR CHAR(0) CONSTANT INIT(
             10199            'No such message number for CHECK.  Oops.') ;
     2457    10200    1   DCL APRESCAN_FMT1 CHAR(0) CONSTANT INIT('Job %<>A submitted.') ;
     2458    10201    1   DCL APRESCAN_FMT2 CHAR(0) CONSTANT INIT('Job %D %<>A submitted.') ;
     2459    10202    1   DCL COMPLETED_FMT1 CHAR(0) CONSTANT INIT('%<>A completed.') ;
     2460    10203    1   DCL COMPLETED_FMT2 CHAR(0) CONSTANT INIT('%D %<>A completed.') ;
     2461    10204    1   DCL NUM_LISTED_HDR_FMT CHAR(0) CONSTANT INIT('%4D%0A') ;
     2462    10205    1   DCL NUM_LISTED_MESS CHAR(0) CONSTANT INIT(' items Listed.') ;
     2463    10206    1   DCL HELD_LINE_FMT (0:79) CHAR(1) CONSTANT INIT('-'*0) ;
     2464    10207    1   DCL OUT_TYPE_ARRY (0:5) CHAR(8) UNAL CONSTANT INIT
     2465    10208    1         (   'Printing',
     2466    10209    1             'Punching',
     2467    10210    1             'Beaming',
     2468    10211    1             'Plotting',
     2469    10212    1             'Typing',
     2470    10213    1             'On Dev.') ;
     2471    10214    1   DCL LC_OUT_TYPE_ARRY (0:5) CHAR(8) UNAL CONSTANT INIT
     2472    10215    1         (   'printing',
     2473    10216    1             'punching',
     2474    10217    1             'beaming',
     2475    10218    1             'plotting',
     2476    10219    1             'typing',
     2477    10220    1             'on dev.') ;
     2478    10221    1   DCL SH_OUT_TYPE_ARRY (0:5) CHAR(8) UNAL CONSTANT INIT
     2479    10222    1         (   'print',
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:381  
     2480    10223    1             'punch',
     2481    10224    1             'beam',
     2482    10225    1             'plot',
     2483    10226    1             'type',
     2484    10227    1             'output');
     2485    10228    1   DCL FMT1 CHAR(0) CONSTANT INIT('%D-%D %<>A.%<>A doesn''t exist.%Q - %<>A') ;
     2486    10229    1   DCL FMTVEC_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FMTVEC ) );
     2487    10230    1   DCL FMTVEC1_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FMTVEC1 ) );
     2488    10231    1   DCL FMTVEC2_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FMTVEC2 ) );
     2489    10232    1   DCL FMTVEC CHAR(0) CONSTANT INIT('%D %<>A.%<>A %<>A %..2U%Q - %<>A') ;
     2490    10233    1   DCL FMTVEC1 CHAR(0) CONSTANT INIT('%D %<>A.%<>A %<>A %..2U with STEPCC=%D%Q - %<>A')
             10233            ;
     2491    10234    1   DCL FMTVEC2 CHAR(0) CONSTANT INIT
     2492    10235    1         ('%D %<>A.%<>A rejected at record %D (%<>A) at %..2U%Q - %<>A') ;
     2493    10236    1   DCL LIMIT_FMT_BUF CHAR(0) CONSTANT INIT('%D %<>A.%<>A limit %<>A') ;
     2494    10237    1   DCL EXTRA_LIMITS_FMT CHAR(0) CONSTANT INIT (',%<>A') ;
     2495    10238    1   DCL LIMIT_COMMENT_FMT CHAR(0) CONSTANT INIT (' exceeded%Q - %<>A') ;
     2496    10239    1   DCL MBS_DELETED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( MBS_DELETED ) );
     2497    10240    1   DCL MBS_CANCELED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( MBS_CANCELED ) );
     2498    10241    1   DCL MBS_SHAFTED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( MBS_SHAFTED ) );
     2499    10242    1   DCL MBS_FILERR_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( MBS_FILERR ) );
     2500    10243    1   DCL PRE_PASSED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( PRE_PASSED ) );
     2501    10244    1   DCL REJ_JOB_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_JOB ) );
     2502    10245    1   DCL REJ_RES_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_RES ) );
     2503    10246    1   DCL REJ_SYNTAX_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_SYNTAX ) );
     2504    10247    1   DCL REJ_IO_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_IO ) );
     2505    10248    1   DCL REJ_JOBIMBED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_JOBIMBED ) );
     2506    10249    1   DCL REJ_BADID_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_BADID ) );
     2507    10250    1   DCL REJ_NORES_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_NORES ) );
     2508    10251    1   DCL REJ_PRESCAN_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_PRESCAN ) );
     2509    10252    1   DCL REJ_RESIMBED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_RESIMBED ) );
     2510    10253    1   DCL REJ_NOBATCH_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_NOBATCH ) );
     2511    10254    1   DCL FIN_RECOVER_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FIN_RECOVER ) );
     2512    10255    1   DCL FIN_ABNORMAL_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FIN_ABNORMAL ) );
     2513    10256    1   DCL FIN_COMPLETED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FIN_COMPLETED ) );
     2514    10257    1   DCL FIN_ABNORMAL_UNKNOWN_ BIT(72) CONSTANT DALIGNED INIT( VECTOR(
             10257            FIN_ABNORMAL_UNKNOWN ) );
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:382  
     2515    10258    1   DCL MBS_DELETED CHAR(0) CONSTANT INIT( 'Deleted by operator' );
     2516    10259    1   DCL MBS_CANCELED CHAR(0) CONSTANT INIT( 'Canceled by user' );
     2517    10260    1   DCL MBS_SHAFTED CHAR(0) CONSTANT INIT( 'Deleted by MBS for FOLLOW condition' );
     2518    10261    1   DCL MBS_FILERR CHAR(0) CONSTANT INIT( 'Canceled by MBS due to file inconsistency' );
     2519    10262    1   DCL PRE_PASSED CHAR(0) CONSTANT INIT( 'Passed PRESCAN successfully' );
     2520    10263    1   DCL REJ_JOB CHAR(0) CONSTANT INIT( 'bad !JOB' );
     2521    10264    1   DCL REJ_RES CHAR(0) CONSTANT INIT( 'bad !RESOURCE' );
     2522    10265    1   DCL REJ_SYNTAX CHAR(0) CONSTANT INIT( 'syntax error' );
     2523    10266    1   DCL REJ_IO CHAR(0) CONSTANT INIT( 'I/O error' );
     2524    10267    1   DCL REJ_JOBIMBED CHAR(0) CONSTANT INIT( 'imbedded !JOB' );
     2525    10268    1   DCL REJ_BADID CHAR(0) CONSTANT INIT( 'invalid ACCOUNT, USER, or PASSWORD on !JOB' );
     2526    10269    1   DCL REJ_NORES CHAR(0) CONSTANT INIT( 'too many resources specified' );
     2527    10270    1   DCL REJ_PRESCAN CHAR(0) CONSTANT INIT( 'PRESCAN problem' );
     2528    10271    1   DCL REJ_RESIMBED CHAR(0) CONSTANT INIT( 'imbedded !RESOURCE' );
     2529    10272    1   DCL REJ_NOBATCH CHAR(0) CONSTANT INIT( 'you are not authorized for BATCH' );
     2530    10273    1   DCL FIN_RECOVER CHAR(0) CONSTANT INIT( 'Caught in RECOVERY' );
     2531    10274    1   DCL FIN_ABNORMAL CHAR(0) CONSTANT INIT( 'Completed ABNORMALLY' );
     2532    10275    1   DCL FIN_COMPLETED CHAR(0) CONSTANT INIT( 'completed successfully at ');
     2533    10276    1   DCL FIN_ABNORMAL_UNKNOWN CHAR(0) CONSTANT INIT
     2534    10277    1                 ( 'completed ABNORMALLY with unknown error code') ;
     2535    10278    1   DCL RS__(0:8) BIT(72) CONSTANT DALIGNED INIT( VECTOR( RS_ERR ),
     2536    10279    1                                               VECTOR( RS_XXX ),
     2537    10280    1                                               VECTOR( RS_SSP ),
     2538    10281    1                                               VECTOR( RS_ABRT ),
     2539    10282    1                                               VECTOR( RS_EKEY ),
     2540    10283    1                                               VECTOR( RS_OFF ),
     2541    10284    1                                               VECTOR( RS_LIMX ),
     2542    10285    1                                               VECTOR( RS_DROP ),
     2543    10286    1                                               VECTOR( RS_XKEY ) );
     2544    10287    1   DCL XL__(0:8) BIT(72) CONSTANT DALIGNED INIT( VECTOR( XL_TIME ),
     2545    10288    1                                               VECTOR( XL_STACK ),
     2546    10289    1                                               VECTOR( XL_TAPE ),
     2547    10290    1                                               VECTOR( XL_TDISK ),
     2548    10291    1                                               VECTOR( XL_PDISK ),
     2549    10292    1                                               VECTOR( XL_DO ),
     2550    10293    1                                               VECTOR( XL_LO ),
     2551    10294    1                                               VECTOR( XL_PLO ),
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:383  
     2552    10295    1                                               VECTOR( XL_PO ) );
     2553    10296    1   DCL RS_CAN_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( RS_CAN ) );
     2554    10297    1   DCL RS_ERR CHAR(0) CONSTANT INIT( 'M$ERR pmme' );
     2555    10298    1   DCL RS_XXX CHAR(0) CONSTANT INIT( 'M$XXX pmme' );
     2556    10299    1   DCL RS_SSP CHAR(0) CONSTANT INIT( 'Aborted by special shared processor' );
     2557    10300    1   DCL RS_ABRT CHAR(0) CONSTANT INIT( 'Aborted by monitor (ABORTM)' );
     2558    10301    1   DCL RS_EKEY CHAR(0) CONSTANT INIT( 'Errored by operator' );
     2559    10302    1   DCL RS_OFF CHAR(0) CONSTANT INIT( 'Aborted by monitor (!X)' );
     2560    10303    1   DCL RS_LIMX CHAR(0) CONSTANT INIT( 'Limit exceeded' );
     2561    10304    1   DCL RS_DROP CHAR(0) CONSTANT INIT( 'Line disconnect' );
     2562    10305    1   DCL RS_XKEY CHAR(0) CONSTANT INIT( 'Aborted by operator' );
     2563    10306    1   DCL RS_CAN CHAR(0) CONSTANT INIT( 'Canceled by user' );
     2564    10307    1   DCL XL_TIME CHAR(0) CONSTANT INIT( 'TIME' );
     2565    10308    1   DCL XL_STACK CHAR(0) CONSTANT INIT( 'STACK' );
     2566    10309    1   DCL XL_TAPE CHAR(0) CONSTANT INIT( 'TAPE' );
     2567    10310    1   DCL XL_TDISK CHAR(0) CONSTANT INIT( 'TDIS' );
     2568    10311    1   DCL XL_PDISK CHAR(0) CONSTANT INIT( 'PDIS' );
     2569    10312    1   DCL XL_DO CHAR(0) CONSTANT INIT( 'DO' );
     2570    10313    1   DCL XL_LO CHAR(0) CONSTANT INIT( 'LO' );
     2571    10314    1   DCL XL_PLO CHAR(0) CONSTANT INIT( 'PLO' );
     2572    10315    1   DCL XL_PO CHAR(0) CONSTANT INIT( 'PO' );
     2573    10316    1   DCL AHEAD_HDR CHAR(0) CONSTANT INIT('Ahead') ;
     2574    10317    1   DCL RUN_TEXT_HDR CHAR(0) CONSTANT INIT('Run') ;
     2575    10318    1   DCL BATCH_HDR CHAR(0) CONSTANT INIT('B') ;
     2576    10319    1   DCL ONLINE_HDR CHAR(0) CONSTANT INIT('O') ;
     2577    10320    1   DCL GHOST_HDR CHAR(0) CONSTANT INIT('G') ;
     2578    10321    1   DCL TP_HDR CHAR(0) CONSTANT INIT('T') ;
     2579    10322    1   DCL A_CHAR CHAR(0) CONSTANT INIT('A') ;
     2580    10323    1   DCL D_CHAR CHAR(0) CONSTANT INIT('D') ;
     2581    10324    1   DCL H_CHAR CHAR(0) CONSTANT INIT('H') ;
     2582    10325    1   DCL F_CHAR CHAR(0) CONSTANT INIT('F') ;
     2583    10326    1   DCL O_CHAR CHAR(0) CONSTANT INIT('O') ;
     2584    10327    1   DCL BLANK_CHAR CHAR(0) CONSTANT INIT(' ') ;
     2585    10328    1   DCL PART_ARRY (0:15) CHAR(1) CONSTANT
     2586    10329    1         INIT('1','2','3','4','5','6','7','8','9','0','1','2','3','4','5','6') ;
     2587    10330    1   DCL NODEV_HDR CHAR(0) CONSTANT INIT ('NODEV') ;
     2588    10331    1   DCL NODEV_HDR2 CHAR(0) CONSTANT INIT ('Nodev') ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:384  
     2589    10332
     2590    10333             /***** AUTO data *****/
     2591    10334
     2592    10335        %F_FDS                                      ( NAME = F_FDS,
     2593    10336              STCLASS = AUTO) ;
     2594    10449    1   DCL FMT_VEC(0:75) BIT(72) ;
     2595    10450    1   DCL OUT_BUF CHAR(150) ;
     2596    10451    1   DCL I UBIN WORD ;
     2597    10452    1   DCL II UBIN WORD ;
     2598    10453    1   DCL NFOLL UBIN WORD ;
     2599    10454    1   DCL BITSET UBIN WORD ;
     2600    10455    1   DCL UTS SBIN WORD ;
     2601    10456    1   DCL 1 STATE_BUF ALIGNED,
     2602    10457    1         2 NUM UBIN WORD UNAL,
     2603    10458    1         2 ESC_Q CHAR(4) UNAL,
     2604    10459    1         2 TIME_USED UBIN WORD UNAL,
     2605    10460    1         2 TIME_REMAIN UBIN WORD UNAL;
     2606    10461    1   DCL TIME_BUF CHAR(8) ;
     2607    10462    1   DCL TIME_BUF1 CHAR(8) ;
     2608    10463    1   DCL PART_BUF CHAR(16) ;
     2609    10464    1   DCL DEVTYPE CHAR(2) ;
     2610    10465    1   DCL NUM_AHEAD UBIN WORD ;
     2611    10466    1   DCL TYPE_NUM UBIN WORD ;
     2612    10467    1   DCL STEPCC UBIN WORD ;
     2613    10468    1   DCL STEPCC_ BIT(72) DALIGNED ;
     2614    10469    1   DCL RECNO_ BIT(72) DALIGNED ;
     2615    10470    1   DCL FMT_BUF CHAR(80) ;
     2616    10471    1   DCL LIMIT_BUF CHAR(80) ;
     2617    10472    1   DCL START UBIN WORD ;
     2618    10473    1   DCL NCHARS UBIN WORD ;
     2619    10474    1   DCL WIDTH UBIN WORD ;
     2620    10475
     2621    10476             /***** Auto FPTs *****/
     2622    10477
     2623    10478        %VLR_DISPLAY  (FPTN = VLR_DISPLAY,STCLASS=AUTO) ;
     2624    10492        %FPT_DISPLAY  (FPTN = FPT_DISPLAY,STCLASS=AUTO) ;
     2625    10505        %FPT_TIME (FPTN = FPT_TIME,STCLASS=AUTO) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:385  
     2626    10524        %FPT_STATE(FPTN=FPT_STATE,STCLASS=AUTO) ;
     2627    10538
     2628    10539             /***** Procedure *****/
     2629    10540
     2630    10541    1         FMT_VEC = '0'B ;
     2631    10542    1         OUT_BUF = ' ' ;
     2632    10543    1         F_FDS = CF_FDS ;
     2633    10544    1         F_FDS.OUTPUT# = ENTADDR(CPK$FDS_OUTPUT) ;
     2634    10545    1         F_FDS.VECTR$ = ADDR(FMT_VEC(0)) ;
     2635    10546    1         F_FDS.BUF_ = VECTOR(OUT_BUF) ;
     2636    10547
     2637    10548    1         BUF$ = CH_XFORMAT.BUF$ ;
     2638    10549
     2639    10550    2         DO CASE (CH_XFORMAT.MSG#) ;
     2640    10551
     2641    10552    2             CASE(%CP_INPUT_MESS,%CP_RUN_MESS) ;
     2642    10553    2               IF (CH_XFORMAT.MSG# = %CP_INPUT_MESS)
     2643    10554    2                 THEN
     2644    10555    3                   DO ;
     2645    10556    3                     F_FDS.FMT_ = VECTOR(INPUT_MESS_FMT) ;
     2646    10557    3                     FMT_VEC(0) = VECTOR(BUF$->VLA$INPUT.AHEAD) ;
     2647    10558    3                   END ; /* THEN DO */
     2648    10559    2                 ELSE
     2649    10560    3                   DO ;
     2650    10561    3                     F_FDS.FMT_ = VECTOR(RUN_MESS_FMT) ;
     2651    10562    3                     FMT_VEC(0) = VECTOR(RUN_TEXT_HDR) ;
     2652    10563    3                   END ; /* ELSE DO */
     2653    10564    2               FMT_VEC(1) = VECTOR(BUF$->VLA$INPUT.IPRIO) ;
     2654    10565    2               FMT_VEC(2) = VECTOR(BUF$->VLA$INPUT.SYSID) ;
     2655    10566    2               IF (BUF$ -> VLA$INPUT.FLG.O1)
     2656    10567    2                 THEN FMT_VEC(3) = VECTOR(O_CHAR) ;
     2657    10568    2                 ELSE FMT_VEC(3) = VECTOR(BLANK_CHAR) ;
     2658    10569    2               IF (BUF$ -> VLA$INPUT.FLG.ACC)
     2659    10570    2                 THEN FMT_VEC(4) = VECTOR(A_CHAR) ;
     2660    10571    2                 ELSE FMT_VEC(4) = VECTOR(BLANK_CHAR) ;
     2661    10572    2               IF (BUF$ -> VLA$INPUT.FLG.O3)
     2662    10573    2                 THEN FMT_VEC(5) = VECTOR(F_CHAR) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:386  
     2663    10574    2                 ELSE FMT_VEC(5) = VECTOR(BLANK_CHAR) ;
     2664    10575    2               IF (BUF$ -> VLA$INPUT.FLG.RA)
     2665    10576    2                 THEN FMT_VEC(6) = VECTOR(D_CHAR) ;
     2666    10577    2                 ELSE FMT_VEC(6) = VECTOR(BLANK_CHAR) ;
     2667    10578    2               UTS = BUF$ -> VLA$INPUT.TIM ;
     2668    10579    2               CALL CONVERT_TIME(UTS,TIME_BUF) ;
     2669    10580    2               FMT_VEC(7) = VECTOR( TIME_BUF ) ;
     2670    10581    2               FMT_VEC(8) = VECTOR(BUF$->VLA$INPUT.RRT(0)) ;
     2671    10582    2               FMT_VEC(9) = VECTOR(BUF$->VLA$INPUT.ACCT) ;
     2672    10583    2               IF (CH_XFORMAT.MSG# = %CP_INPUT_MESS)
     2673    10584    2                 THEN
     2674    10585    3                   DO ;
     2675    10586    3                     TEMP$ = ADDR(BUF$->VLA$INPUT.PART) ;
     2676    10587    4                     DO I = 0 TO 15 ;
     2677    10588    4                       IF (TEMP$->CH$PART(I))
     2678    10589    4                         THEN CALL INSERT(PART_BUF,I,1,PART_ARRY(I)) ;
     2679    10590    4                         ELSE CALL INSERT(PART_BUF,I,1,'.') ;
     2680    10591    4                     END ; /* DO I */
     2681    10592    3                     FMT_VEC(10) = VECTOR(PART_BUF) ;
     2682    10593    3                   END ; /* THEN DO */
     2683    10594    2                 ELSE FMT_VEC(10) = VECTOR(BUF$->VLA$INPUT.PNUM) ;
     2684    10595    2               FMT_VEC(11) = VECTOR(BUF$->VLA$INPUT.JNAME) ;
     2685    10596    2               F_FDS.NVECS# = 12 ;
     2686    10597
     2687    10598    2             CASE(%CP_OUTPUT_MESS) ;
     2688    10599    2               IF (BUF$->VLA$OUTPUT.DEVNAME = ' ')
     2689    10600    2                 THEN
     2690    10601    3                   DO ;                                  /* Waiting to output. */
     2691    10602    3                       IF BUF$ -> VLA$OUTPUT.SYSID < 99 AND
     2692    10603    3                           BUF$ -> VLA$OUTPUT.NUM > 99
     2693    10604    3                         THEN F_FDS.FMT_ = VECTOR(OUTPUT_WAIT_MESS_FMT2) ;
     2694    10605    3                         ELSE F_FDS.FMT_ = VECTOR(OUTPUT_WAIT_MESS_FMT) ;
     2695    10606    3                       NUM_AHEAD = BUF$ -> VLA$OUTPUT.AHEAD ;
     2696    10607    3                       FMT_VEC(0) = VECTOR(NUM_AHEAD) ;
     2697    10608    3                       IF (BUF$ -> VLA$OUTPUT.FLG.DEVAVAIL)
     2698    10609    3                         THEN FMT_VEC(1) = VECTOR(AHEAD_HDR) ;
     2699    10610    3                         ELSE FMT_VEC(1) = VECTOR(NODEV_HDR2) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:387  
     2700    10611    3                       I = 1 ;
     2701    10612    3                   END ; /* THEN DO */
     2702    10613    2                 ELSE                                    /* Being output.*/
     2703    10614    3                   DO ;
     2704    10615    3                       IF BUF$ -> VLA$OUTPUT.SYSID < 99 AND
     2705    10616    3                           BUF$ -> VLA$OUTPUT.NUM > 99
     2706    10617    3                         THEN F_FDS.FMT_ = VECTOR(OUTPUT_NOWAIT_MESS_FMT2) ;
     2707    10618    3                         ELSE F_FDS.FMT_ = VECTOR(OUTPUT_NOWAIT_MESS_FMT) ;
     2708    10619    3                       I = 0 ;
     2709    10620    3                       CALL GET_OUTPUT_TYPE(I,OUT_TYPE_ARRY) ;
     2710    10621    3                   END ; /* ELSE DO */
     2711    10622    2               FMT_VEC(I+1) = VECTOR(BUF$->VLA$OUTPUT.SYSID) ;
     2712    10623    2               FMT_VEC(I+2) = VECTOR(BUF$->VLA$OUTPUT.NUM) ;
     2713    10624    2               FMT_VEC(I+3) = VECTOR(BUF$->VLA$OUTPUT.ACCT);
     2714    10625    2               FMT_VEC(I+4) = VECTOR(BUF$->VLA$OUTPUT.PRIO) ;
     2715    10626    2               FMT_VEC(I+5) = VECTOR(BUF$->VLA$OUTPUT.COPIES) ;
     2716    10627    2               IF BUF$->VLA$OUTPUT.FLG.SAP
     2717    10628    2                 THEN
     2718    10629    2                   FMT_VEC(I+6) = VECTOR(H_CHAR) ;
     2719    10630    2                 ELSE
     2720    10631    2                   FMT_VEC(I+6) = VECTOR(BLANK_CHAR) ;
     2721    10632    2               FMT_VEC(I+7) = VECTOR(BUF$->VLA$OUTPUT.SAPCOPIES) ;
     2722    10633    2               FMT_VEC(I+8) = VECTOR(BUF$->VLA$OUTPUT.GRANS) ;
     2723    10634    2               FMT_VEC(I+9) = VECTOR(BUF$->VLA$OUTPUT.FORM) ;
     2724    10635    2               IF BUF$->VLA$OUTPUT.DEVNAME = ' '
     2725    10636    2                 THEN
     2726    10637    2                   FMT_VEC(I+10) = VECTOR(BUF$->VLA$OUTPUT.WOD) ;
     2727    10638    2                 ELSE
     2728    10639    2                   FMT_VEC(I+10) = VECTOR(BUF$->VLA$OUTPUT.TNAME) ;
     2729    10640    2               FMT_VEC(I+11) = VECTOR(BUF$->VLA$OUTPUT.DEVTYP) ;
     2730    10641    2               FMT_VEC(I+12) = VECTOR(BUF$->VLA$OUTPUT.DEVNAME) ;
     2731    10642    2               FMT_VEC(I+13) = VECTOR(BUF$->VLA$OUTPUT.JNAME) ;
     2732    10643    2               F_FDS.NVECS# = I + 13 + 1 ;
     2733    10644
     2734    10645    2             CASE( %CP_SYSID_RUN_MESS,
     2735    10646    2                   %CP_SYSID_FOLL_MESS,
     2736    10647    2                   %CP_SYSID_RUNAFTER_MESS,
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:388  
     2737    10648    2                   %CP_SYSID_WPART_MESS,
     2738    10649    2                   %CP_SYSID_OTHER_MESS,
     2739    10650    2                   %CP_SYSID_WPS_MESS,
     2740    10651    2                   %CP_SYSID_WAIT_MESS) ;
     2741    10652    2               CALL OUTPUT_SYSID_IN_AND_RUN ;
     2742    10653
     2743    10654    2             CASE(%CP_SYSID_OQ_MESS) ;
     2744    10655    2               CALL OUTPUT_SYSID_OQ ;
     2745    10656
     2746    10657    2             CASE(%CP_INPUT_HDR) ;
     2747    10658    2               F_FDS.FMT_ = VECTOR(INPUT_HDR_FMT) ;
     2748    10659    2               FMT_VEC(0) = VECTOR(INPUT_HDR) ;
     2749    10660    2               F_FDS.NVECS# = 1 ;
     2750    10661
     2751    10662    2             CASE(%CP_RUN_HDR) ;
     2752    10663    2               F_FDS.FMT_ = VECTOR(INPUT_HDR_FMT) ;
     2753    10664    2               FMT_VEC(0) = VECTOR(RUN_HDR) ;
     2754    10665    2               F_FDS.NVECS# = 1 ;
     2755    10666
     2756    10667    2             CASE(%CP_DFLT_OUTPUT_HDR) ;
     2757    10668    2               F_FDS.FMT_ = VECTOR(DFLT_OUTPUT_HDR_FMT) ;
     2758    10669    2               FMT_VEC(0) = VECTOR(DFLT_OUTPUT_HDR) ;
     2759    10670    2               F_FDS.NVECS# = 1 ;
     2760    10671
     2761    10672    2             CASE(%CP_NUM_LISTED) ;
     2762    10673    2               F_FDS.FMT_ = VECTOR(NUM_LISTED_HDR_FMT) ;
     2763    10674    2               I = CH_XFORMAT.NUM# ;
     2764    10675    2               FMT_VEC(0) = VECTOR(I) ;
     2765    10676    2               FMT_VEC(1) = VECTOR(NUM_LISTED_MESS) ;
     2766    10677    2               F_FDS.NVECS# = 2 ;
     2767    10678
     2768    10679    2             CASE(%CP_NONE_IN_MESS) ;
     2769    10680    2               F_FDS.FMT_ = VECTOR(NONE_IN_MESS_FMT) ;
     2770    10681    2               F_FDS.NVECS# = 0 ;
     2771    10682
     2772    10683    2             CASE(%CP_NONE_RUN_MESS) ;
     2773    10684    2               F_FDS.FMT_ = VECTOR(NONE_RUN_MESS_FMT) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:389  
     2774    10685    2               F_FDS.NVECS# = 0 ;
     2775    10686
     2776    10687    2             CASE(%CP_NONE_OUT_MESS) ;
     2777    10688    2               F_FDS.FMT_ = VECTOR(NONE_OUT_MESS_FMT) ;
     2778    10689    2               F_FDS.NVECS# = 0 ;
     2779    10690
     2780    10691    2             CASE(%CP_NONE_MESS) ;
     2781    10692    2               F_FDS.FMT_ = VECTOR(NONE_MESS_FMT) ;
     2782    10693    2               F_FDS.NVECS# = 0 ;
     2783    10694
     2784    10695    2             CASE(%CP_NOTF_MESS) ;
     2785    10696    2               I = 0 ;
     2786    10697    2               II = 4 ;
     2787    10698    2               FMT_BUF = 'Job' ;
     2788    10699    2               IF CH_XFORMAT.SYSID# ~= 0
     2789    10700    2                 THEN
     2790    10701    3                   DO ;                                  /* SYSID specified. */
     2791    10702    3                     CALL INSERT(FMT_BUF,II,4,'%<>D') ;
     2792    10703    3                     II = II + 4 ;
     2793    10704    3                     FMT_VEC(I) = VECTOR(CH_XFORMAT.SYSID#) ;
     2794    10705    3                     I = I + 1 ;
     2795    10706    3                     IF CH_XFORMAT.NUM# ~= 0
     2796    10707    3                       THEN
     2797    10708    4                         DO ;                                  /* NUM specified. */
     2798    10709    4                           CALL INSERT(FMT_BUF,II,6,'-%<>D') ;
     2799    10710    4                           II = II + 6 ;
     2800    10711    4                           FMT_VEC(I) = VECTOR(CH_XFORMAT.NUM#) ;
     2801    10712    4                           I = I + 1 ;
     2802    10713    4                         END ; /* THEN DO */
     2803    10714    3                       ELSE
     2804    10715    3                         II = II + 1;  /* Insert a blank. */
     2805    10716    3                   END ; /* THEN DO */
     2806    10717    2               IF CH_XFORMAT.JOBNAME# ~= ' '
     2807    10718    2                 THEN
     2808    10719    3                   DO ;                                  /* JOBNAME specified. */
     2809    10720    3                     CALL INSERT(FMT_BUF,II,5,'%<>A.') ;
     2810    10721    3                     II = II + 5 ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:390  
     2811    10722    3                     FMT_VEC(I) = VECTOR(CH_XFORMAT.JOBNAME#) ;
     2812    10723    3                     I = I + 1 ;
     2813    10724    3                   END ; /* THEN DO */
     2814    10725    2               IF CH_XFORMAT.ACCT# ~= ' '
     2815    10726    2                 THEN
     2816    10727    3                   DO ;                                  /* ACCT specified. */
     2817    10728    3                     IF SUBSTR(FMT_BUF,II-1,1) ~= '.'
     2818    10729    3                       THEN
     2819    10730    4                         DO ;                            /* No JOBNAME */
     2820    10731    4                           CALL INSERT(FMT_BUF,II,1,'.') ;
     2821    10732    4                           II = II + 1 ;
     2822    10733    4                         END ; /* THEN DO */
     2823    10734    3                     CALL INSERT(FMT_BUF,II,5,'%<>A') ;
     2824    10735    3                     II = II + 5 ;
     2825    10736    3                     FMT_VEC(I) = VECTOR(CH_XFORMAT.ACCT#) ;
     2826    10737    3                     I = I + 1 ;
     2827    10738    3                   END ; /* THEN DO */
     2828    10739    2               IF SUBSTR(FMT_BUF,II-1,1) ~= ' '
     2829    10740    2                 THEN II = II + 1 ;    /* Add a blank */
     2830    10741    2               CALL INSERT(FMT_BUF,II,14,'was not found.') ;
     2831    10742    2               II = II + 14 ;
     2832    10743    2               F_FDS.NVECS# = I ;
     2833    10744    2               F_FDS.FMT_ = VECTOR(FMT_BUF) ;
     2834    10745
     2835    10746    2             CASE(%CP_APRESCAN_MESS) ;
     2836    10747    2               I = 0 ;
     2837    10748    2               IF (CH_XFORMAT.SYSID# ~= 0)
     2838    10749    2                 THEN
     2839    10750    3                   DO ;                          /* SYSID */
     2840    10751    3                     F_FDS.FMT_ = VECTOR(APRESCAN_FMT2) ;
     2841    10752    3                     FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;
     2842    10753    3                     I = 1 ;
     2843    10754    3                   END ; /* THEN DO */
     2844    10755    2                 ELSE F_FDS.FMT_ = VECTOR(APRESCAN_FMT1) ;   /* No SYSID */
     2845    10756    2                 FMT_VEC(I) = VECTOR(CH_XFORMAT.JOBNAME#) ;
     2846    10757    2                 F_FDS.NVECS# = I + 1 ;
     2847    10758
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:391  
     2848    10759    2             CASE(%CP_COMPLETED_MESS) ;
     2849    10760    2               I = 0 ;
     2850    10761    2               IF (CH_XFORMAT.SYSID# ~= 0)
     2851    10762    2                 THEN
     2852    10763    3                   DO ;                          /* SYSID */
     2853    10764    3                     F_FDS.FMT_ = VECTOR(COMPLETED_FMT2) ;
     2854    10765    3                     FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;
     2855    10766    3                     I = 1 ;
     2856    10767    3                   END ; /* THEN DO */
     2857    10768    2                 ELSE F_FDS.FMT_ = VECTOR(COMPLETED_FMT1) ;   /* No SYSID */
     2858    10769    2                 FMT_VEC(I) = VECTOR(CH_XFORMAT.JOBNAME#) ;
     2859    10770    2                 F_FDS.NVECS# = I + 1 ;
     2860    10771
     2861    10772    2             CASE(%CP_DOESNT_EXIST_MESS) ;
     2862    10773    2               F_FDS.FMT_ = VECTOR(FMT1) ;
     2863    10774    2               FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;
     2864    10775    2               FMT_VEC(1) = VECTOR(CH_XFORMAT.NUM#) ;
     2865    10776    2               FMT_VEC(2) = VECTOR(CH_XFORMAT.JOBNAME#) ;
     2866    10777    2               FMT_VEC(3) = VECTOR(CH_XFORMAT.ACCT#) ;
     2867    10778    2               IF (CH_XFORMAT.COMMENT# ~= ' ')
     2868    10779    2                 THEN
     2869    10780    3                   DO ;
     2870    10781    3                     I = 4 ;
     2871    10782    3                     FMT_VEC(4) = VECTOR(CH_XFORMAT.COMMENT#) ;
     2872    10783    3                   END ; /* THEN DO */
     2873    10784    2                 ELSE I = 3 ;
     2874    10785    2               F_FDS.NVECS# = I + 1 ;
     2875    10786
     2876    10787
     2877    10788    2             CASE(%CP_FINAL_STAT_MESS) ;
     2878    10789    2               CALL OUTPUT_FINAL_STATUS ;
     2879    10790
     2880    10791    2             CASE(%CP_TIME_DI_MESS,
     2881    10792    2                   %CP_TIME_DI_W_BELL_MESS) ;
     2882    10793    2               FPT_DISPLAY = CFPT_DISPLAY ;
     2883    10794    2               FPT_DISPLAY.RESULTS_ = VECTOR(VLR_DISPLAY) ;
     2884    10795    2               CALL M$DISPLAY (FPT_DISPLAY) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:392  
     2885    10796    2               FPT_TIME = CFPT_TIME ;
     2886    10797    2               FPT_TIME.V_ = VECTOR(FPT_TIME.V) ;
     2887    10798    2               FPT_TIME.TSTAMP_ = VECTOR(UTS) ;
     2888    10799    2               CALL M$TIME(FPT_TIME) ;
     2889    10800    2               F_FDS.FMT_ = VECTOR(TIME_DI_MESS_HDR) ;
     2890    10801    2               FMT_VEC(0) = VECTOR(UTS) ;
     2891    10802    2               FMT_VEC(1) = VECTOR(VLR_DISPLAY.USERS) ;
     2892    10803    2               FMT_VEC(2) = VECTOR(VLR_DISPLAY.ETMF) ;
     2893    10804    2               FMT_VEC(3) = VECTOR(VLR_DISPLAY.RESP) ;
     2894    10805    2               IF CH_XFORMAT.MSG# = %CP_TIME_DI_MESS
     2895    10806    2                 THEN
     2896    10807    2                   F_FDS.NVECS# = 4 ;
     2897    10808    2                 ELSE
     2898    10809    3                   DO ;
     2899    10810    3                     FMT_VEC(4) = VECTOR(BELL) ;
     2900    10811    3                     F_FDS.NVECS# = 5 ;
     2901    10812    3                   END ; /* Else Do */
     2902    10813
     2903    10814    2             CASE(%CP_BLANKLINE_MESS) ;
     2904    10815    2               F_FDS.FMT_ = VECTOR(BLANK_FMT) ;
     2905    10816    2               F_FDS.NVECS# = 0 ;
     2906    10817
     2907    10818    2             CASE(%CP_NO_TERM_OUT_MESS) ;
     2908    10819    2               F_FDS.FMT_ = VECTOR(NO_TERM_OUT_HDR) ;
     2909    10820    2               FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;
     2910    10821    2               F_FDS.NVECS# = 1 ;
     2911    10822
     2912    10823    2             CASE(%CP_HELD_LINE) ;
     2913    10824    2               F_FDS.FMT_ = VECTOR(HELD_LINE_FMT) ;
     2914    10825    2               F_FDS.NVECS# = 0 ;
     2915    10826
     2916    10827    2             CASE(ELSE) ;
     2917    10828    2               F_FDS.FMT_ = VECTOR(NO_SUCH_MESS_HDR) ;
     2918    10829
     2919    10830    2         END ; /* DO CASE */
     2920    10831
     2921    10832    1         CALL X$FORMAT(F_FDS) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:393  
     2922    10833    1         IF ADDR(NLINES) ~= ADDR(NIL)
     2923    10834    1             THEN
     2924    10835    2               DO ;
     2925    10836    2                 NCHARS = F_FDS.WRITEFPT$->FPT$WRITE.BUF_.BOUND+1 ;
     2926    10837    2                 WIDTH = DCBADDR(SEG2$->SEG$2.LLDCB#)->F$DCB.WIDTH# ;
     2927    10838    2                 IF WIDTH = 0
     2928    10839    2                   THEN
     2929    10840    3                     DO ;
     2930    10841    3                       NCHARS = 0 ;
     2931    10842    3                       NLINES = 1 ;
     2932    10843    3                     END ; /* Then Do */
     2933    10844    2                   ELSE
     2934    10845    2                     NLINES = 0 ;
     2935    10846    3                 DO WHILE(NCHARS > 0) ;
     2936    10847    3                   IF NCHARS > WIDTH
     2937    10848    3                     THEN
     2938    10849    3                       NCHARS = NCHARS - WIDTH ;
     2939    10850    3                     ELSE
     2940    10851    3                       NCHARS = 0 ;
     2941    10852    3                   NLINES = NLINES + 1 ;
     2942    10853    3                 END ; /* Do While */
     2943    10854    2               END ; /* Then Do */
     2944    10855    1         RETURN ;
     2945    10856        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:394  
     2946    10857    1   CONVERT_TIME: PROC(CSECS,TIME_BUF) ;
     2947    10858
     2948    10859        /***** Parameters *****/
     2949    10860
     2950    10861    2   DCL CSECS SBIN WORD ;      /* A time value in centi-seconds */
     2951    10862    2   DCL TIME_BUF CHAR(8) ;
     2952    10863    2   DCL 1 TIME_ REDEF TIME_BUF,
     2953    10864    2         2 HR  CHAR(2),
     2954    10865    2         2 *   CHAR(1),
     2955    10866    2         2 MIN CHAR(2),
     2956    10867    2         2 *   CHAR(1),
     2957    10868    2         2 SEC CHAR(2);
     2958    10869
     2959    10870        /***** Auto *****/
     2960    10871
     2961    10872    2   DCL I UBIN WORD ;
     2962    10873    2   DCL HOUR SBIN WORD ;
     2963    10874    2   DCL MIN SBIN WORD ;
     2964    10875    2   DCL SEC SBIN WORD ;
     2965    10876
     2966    10877        /***** Procedure *****/
     2967    10878
     2968    10879    2               SEC = CSECS/100 ;
     2969    10880    2               MIN = SEC/60 ;
     2970    10881    2               HOUR = MIN/60;
     2971    10882
     2972    10883    2               TIME_BUF = '**:**:**';
     2973    10884    2               CALL BINCHAR(TIME_.HR, HOUR) ;
     2974    10885    2               CALL BINCHAR(TIME_.MIN, MOD(MIN,60));
     2975    10886    2               CALL BINCHAR(TIME_.SEC, MOD(SEC,60));
     2976    10887
     2977    10888                    /* Now trim off hours and tens of minutes off the string
     2978    10889                       if we can (ie. they're zero).                        */
     2979    10890
     2980    10891    2               IF (MIN <= 9) THEN SUBSTR (TIME_BUF, 0, 4) = '    ';
     2981    10892    2               ELSE IF (HOUR = 0) THEN SUBSTR (TIME_BUF, 0, 3) = '   ';
     2982    10893    2               ELSE IF (HOUR <= 9) THEN SUBSTR (TIME_BUF, 0, 1) = ' ';
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:395  
     2983    10894    2               RETURN ;
     2984    10895
     2985    10896    2   END   CONVERT_TIME ;
     2986    10897
     2987    10898        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:396  
     2988    10899    1   GET_OUTPUT_TYPE:    PROC(VEC#,TYPE_ARRY) ;
     2989    10900
     2990    10901        /***** Parameters *****/
     2991    10902
     2992    10903    2   DCL VEC# UBIN WORD ;
     2993    10904    2   DCL TYPE_ARRY (0:6) CHAR(8) UNAL ;
     2994    10905
     2995    10906        /***** Constants *****/
     2996    10907    2   DCL DEV_TYPES (0:4) CHAR(4) CONSTANT INIT ('LP','CP','JE','PL','PR') ;
     2997    10908    2   DCL DEV_TYPES_STR REDEF DEV_TYPES CHAR(20) ;
     2998    10909
     2999    10910        /***** Auto *****/
     3000    10911
     3001    10912    2   DCL TYPE_NUM UBIN WORD ;
     3002    10913
     3003    10914        /***** Procedure *****/
     3004    10915
     3005    10916    2         DEVTYPE = BUF$ -> VLA$OUTPUT.DEVTYP ;
     3006    10917    2         CALL INDEX(TYPE_NUM,DEVTYPE,DEV_TYPES_STR) ;
     3007    10918    2         FMT_VEC(VEC#) = VECTOR(TYPE_ARRY(TYPE_NUM/4)) ;
     3008    10919
     3009    10920    2         RETURN ;
     3010    10921    2   END   GET_OUTPUT_TYPE ;
     3011    10922        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:397  
     3012    10923    1   OUTPUT_FINAL_STATUS:  PROC ;
     3013    10924
     3014    10925    2         FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;
     3015    10926    2         FMT_VEC(1) = VECTOR(CH_XFORMAT.JOBNAME#) ;
     3016    10927    2         FMT_VEC(2) = VECTOR(CH_XFORMAT.ACCT#) ;
     3017    10928
     3018    10929    2         STEPCC = CH_XFORMAT.BUF$ -> XSJ$JOBINFO.STEPCC# ;
     3019    10930    2         STEPCC_ = VECTOR(NIL) ;
     3020    10931    2         RECNO_ = VECTOR(CH_XFORMAT.BUF$ -> XSJ$JOBINFO.RECNO#) ;
     3021    10932    3         DO CASE(CH_XFORMAT.BUF$ -> XSJ$JOBINFO.STATUS#) ;
     3022    10933
     3023    10934    3             CASE(%MBS_DELETED#) ;
     3024    10935    3               FMT_VEC(3) = MBS_DELETED_ ;
     3025    10936
     3026    10937    3             CASE(%MBS_CANCELED#) ;
     3027    10938    3               FMT_VEC(3) = MBS_CANCELED_ ;
     3028    10939
     3029    10940    3             CASE(%MBS_SHAFTED#) ;
     3030    10941    3               FMT_VEC(3) = MBS_SHAFTED_ ;
     3031    10942
     3032    10943    3             CASE(%MBS_FILERR#) ;
     3033    10944    3               FMT_VEC(3) = MBS_FILERR_ ;
     3034    10945
     3035    10946    3             CASE(%PRE_PASSED#) ;
     3036    10947    3               FMT_VEC(3) = PRE_PASSED_ ;
     3037    10948
     3038    10949    3             CASE(%REJ_JOB#) ;
     3039    10950    3               FMT_VEC(4) = REJ_JOB_ ;
     3040    10951    3               GOTO REJECTED_MSG ;
     3041    10952
     3042    10953    3             CASE(%REJ_RES#) ;
     3043    10954    3               FMT_VEC(4) = REJ_RES_ ;
     3044    10955    3               GOTO REJECTED_MSG ;
     3045    10956
     3046    10957    3             CASE(%REJ_SYNTAX#) ;
     3047    10958    3               FMT_VEC(4) = REJ_SYNTAX_ ;
     3048    10959    3               GOTO REJECTED_MSG ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:398  
     3049    10960
     3050    10961    3             CASE(%REJ_IO#) ;
     3051    10962    3               FMT_VEC(4) = REJ_IO_ ;
     3052    10963    3               GOTO REJECTED_MSG ;
     3053    10964
     3054    10965    3             CASE(%REJ_JOBIMBED#) ;
     3055    10966    3               FMT_VEC(4) = REJ_JOBIMBED_ ;
     3056    10967    3               GOTO REJECTED_MSG ;
     3057    10968
     3058    10969    3             CASE(%REJ_BADID#) ;
     3059    10970    3               FMT_VEC(4) = REJ_BADID_ ;
     3060    10971    3               GOTO REJECTED_MSG ;
     3061    10972
     3062    10973    3             CASE(%REJ_NORES#) ;
     3063    10974    3               FMT_VEC(4) = REJ_NORES_ ;
     3064    10975    3               GOTO REJECTED_MSG ;
     3065    10976
     3066    10977    3             CASE(%REJ_PRESCAN#) ;
     3067    10978    3               FMT_VEC(4) = REJ_PRESCAN_ ;
     3068    10979    3               GOTO REJECTED_MSG ;
     3069    10980
     3070    10981    3             CASE(%REJ_RESIMBED#) ;
     3071    10982    3               FMT_VEC(4) = REJ_RESIMBED_ ;
     3072    10983    3               GOTO REJECTED_MSG ;
     3073    10984
     3074    10985    3             CASE(%REJ_NOBATCH#) ;
     3075    10986    3               FMT_VEC(4) = REJ_NOBATCH_ ;
     3076    10987    3               GOTO REJECTED_MSG ;
     3077    10988
     3078    10989    3             CASE(%FIN_RECOVER#) ;
     3079    10990    3               FMT_VEC(3) = FIN_RECOVER_ ;
     3080    10991
     3081    10992    3             CASE(%FIN_ABNORMAL#) ;
     3082    10993    3               IF (CH_XFORMAT.BUF$->XSJ$JOBINFO.FRS# = %RS_CAN#)
     3083    10994    3                 THEN FMT_VEC(3) = RS_CAN_ ;
     3084    10995    3                 ELSE
     3085    10996    4                   DO ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:399  
     3086    10997    4                     START = 0 ;
     3087    10998    4                     CALL GETBIT(CH_XFORMAT.BUF$->XSJ$JOBINFO.FRS#,START)
     3088    10999    4                         ALTRET(NOFRS) ;
     3089    11000    4                     FMT_VEC(3) = RS__(BITSET) ;
     3090    11001    4                     IF FMT_VEC(3) = VECTOR(RS_LIMX)
     3091    11002    4                       THEN
     3092    11003    4                         CALL SETUP_LIMIT_VECTOR(CH_XFORMAT.BUF$->
     3093    11004    4                                                         XSJ$JOBINFO.XLIMFLG#)
     3094    11005    5                                                 WHENRETURN DO ;
     3095    11006    5                                                   GOTO ADD_COMMENT ;
     3096    11007    5                                                 END ; /* Whenreturn Do */
     3097    11008    5                                                 WHENALTRETURN DO ;
     3098    11009    5                                                   GOTO SIMPLE_MSG ;
     3099    11010    5                                                 END ; /* Whenaltreturn Do */
     3100    11011    4                   END ; /* THEN DO */
     3101    11012
     3102    11013    3             CASE(%FIN_COMPLETED#) ;
     3103    11014    3               FMT_VEC(3) = FIN_COMPLETED_ ;
     3104    11015    3               IF STEPCC ~= 0
     3105    11016    3                 THEN STEPCC_ = VECTOR(STEPCC) ;
     3106    11017
     3107    11018    3             CASE( ELSE ) ;
     3108    11019    3               FMT_VEC(3) = FIN_ABNORMAL_UNKNOWN_ ;
     3109    11020
     3110    11021    3         END ; /* DO CASE */
     3111    11022
     3112    11023    3         DO WHILE ('0'B) ;
     3113    11024    3   NOFRS:    FMT_VEC(3) = FIN_ABNORMAL_ ;
     3114    11025    3             IF STEPCC ~= 0
     3115    11026    3               THEN STEPCC_ = VECTOR(STEPCC) ;
     3116    11027    3         END ; /* DO WHILE */
     3117    11028
     3118    11029    2   SIMPLE_MSG:
     3119    11030
     3120    11031    2         FMT_VEC(4) = VECTOR(CH_XFORMAT.BUF$->XSJ$JOBINFO.OFF_TIME#) ;
     3121    11032    2         IF STEPCC_ = VECTOR(NIL)
     3122    11033    2             THEN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:400  
     3123    11034    3               DO ;
     3124    11035    3                 I = 4 ;
     3125    11036    3                 F_FDS.FMT_ = FMTVEC_ ;
     3126    11037    3               END ; /* THEN DO */
     3127    11038    2             ELSE
     3128    11039    3               DO ;
     3129    11040    3                 FMT_VEC(5) = STEPCC_ ;
     3130    11041    3                 I = 5 ;
     3131    11042    3                 F_FDS.FMT_ = FMTVEC1_ ;
     3132    11043    3               END ; /* ELSE DO */
     3133    11044
     3134    11045    3         DO WHILE('0'B) ;
     3135    11046
     3136    11047    3   REJECTED_MSG:
     3137    11048    3             FMT_VEC(3) = RECNO_ ;
     3138    11049    3             FMT_VEC(5) = VECTOR(CH_XFORMAT.BUF$ -> XSJ$JOBINFO.OFF_TIME#) ;
     3139    11050    3             I = 5 ;
     3140    11051    3             F_FDS.FMT_ = FMTVEC2_ ;
     3141    11052    3         END ; /* DO WHILE */
     3142    11053
     3143    11054    2   ADD_COMMENT:
     3144    11055    2         IF (CH_XFORMAT.COMMENT# ~= ' ')
     3145    11056    2             THEN
     3146    11057    3               DO ;
     3147    11058    3                 FMT_VEC(I+1) = VECTOR(CH_XFORMAT.COMMENT#) ;
     3148    11059    3                 I = I + 1 ;
     3149    11060    3               END ; /* THEN DO */
     3150    11061    2         F_FDS.NVECS# = I + 1 ;
     3151    11062
     3152    11063    2         RETURN ;
     3153    11064
     3154    11065        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:401  
     3155    11066    2   GETBIT:   PROC (MASK, START) ALTRET ;
     3156    11067
     3157    11068    3   DCL MASK(0:8) BIT(1) UNAL ;
     3158    11069    3   DCL START UBIN WORD ;
     3159    11070
     3160    11071    4         DO BITSET = START TO 8;
     3161    11072    4             IF MASK(8-BITSET)
     3162    11073    4               THEN RETURN ;
     3163    11074    4         END ; /* DO BITSET */
     3164    11075
     3165    11076    3         ALTRETURN ;
     3166    11077
     3167    11078    3   END   GETBIT ;
     3168    11079        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:402  
     3169    11080    2   SETUP_LIMIT_VECTOR: PROC(MASK) ALTRET ;
     3170    11081
     3171    11082    3   DCL MASK BIT(9) UNAL ;
     3172    11083    3   DCL CHR_POS UBIN WORD ;
     3173    11084    3   DCL EXTRA_SZ UBIN WORD ;
     3174    11085    3   DCL NOT_DONE BIT(1) ;
     3175    11086    3   DCL RETFLG BIT(1) ;
     3176    11087
     3177    11088    3         LIMIT_BUF = LIMIT_FMT_BUF ;
     3178    11089    3         CHR_POS = SIZEC(LIMIT_FMT_BUF) ;
     3179    11090    3         EXTRA_SZ = SIZEC(EXTRA_LIMITS_FMT) ;
     3180    11091    3         NOT_DONE = %YES# ;
     3181    11092    3         I = 3 ;
     3182    11093
     3183    11094    4         DO WHILE(NOT_DONE) ;
     3184    11095    5             CALL GETBIT(MASK, START) WHENRETURN DO ;
     3185    11096    5                             FMT_VEC(I) = XL__(BITSET) ;
     3186    11097    5                             IF I > 3
     3187    11098    5                               THEN
     3188    11099    6                                 DO ;
     3189    11100    6                                   SUBSTR(LIMIT_BUF,CHR_POS,EXTRA_SZ) =
     3190    11101    6                                           EXTRA_LIMITS_FMT ;
     3191    11102    6                                   CHR_POS = CHR_POS + EXTRA_SZ ;
     3192    11103    6                                 END ; /* Then Do */
     3193    11104    5                             START = BITSET + 1 ;
     3194    11105    5                             IF START > 8
     3195    11106    5                               THEN
     3196    11107    5                                 NOT_DONE = %NO# ;
     3197    11108    5                             I = I + 1 ;
     3198    11109    5                           END ; /* Whenreturn Do */
     3199    11110    5                           WHENALTRETURN DO ;
     3200    11111    5                             NOT_DONE = %NO# ;
     3201    11112    5                             IF I = 3
     3202    11113    5                               THEN
     3203    11114    5                                   RETFLG = %NO# ;
     3204    11115    5                               ELSE
     3205    11116    5                                   RETFLG = %YES# ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:403  
     3206    11117    5                           END ; /* Whenaltreturn Do */
     3207    11118    4         END ; /* Do While */
     3208    11119
     3209    11120    3         IF NOT RETFLG
     3210    11121    3             THEN
     3211    11122    3               ALTRETURN ;
     3212    11123
     3213    11124    3         SUBSTR(LIMIT_BUF,CHR_POS) = LIMIT_COMMENT_FMT ;
     3214    11125    3         I = I - 1 ;
     3215    11126    3         F_FDS.FMT_ = VECTOR(LIMIT_BUF) ;
     3216    11127    3         RETURN ;
     3217    11128
     3218    11129    3   END   SETUP_LIMIT_VECTOR ;
     3219    11130    2   END   OUTPUT_FINAL_STATUS ;
     3220    11131        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:404  
     3221    11132    1   OUTPUT_SYSID_IN_AND_RUN: PROC ;
     3222    11133
     3223    11134    2         FMT_VEC(0) = VECTOR(BUF$->VLA$INPUT.SYSID) ;
     3224    11135    2         FMT_VEC(1) = VECTOR(BUF$->VLA$INPUT.JNAME) ;
     3225    11136    2         FMT_VEC(2) = VECTOR(BUF$->VLA$INPUT.ACCT) ;
     3226    11137    2         I = 2 ;
     3227    11138    3         DO CASE(CH_XFORMAT.MSG#) ;
     3228    11139
     3229    11140    3             CASE(%CP_SYSID_RUN_MESS) ;
     3230    11141    3               F_FDS.FMT_ = VECTOR(SYSID_RUN_MESS_FMT) ;
     3231    11142    3               STATE_BUF = '0'B ;
     3232    11143    3               STATE_BUF.ESC_Q = ' ' ;
     3233    11144    3               STATE_BUF.TIME_REMAIN = BUF$ -> VLA$INPUT.TIM ;
     3234    11145    3               FPT_STATE.V_ = VECTOR(FPT_STATE.V) ;
     3235    11146    3               FPT_STATE.BUF_ = VECTOR(STATE_BUF) ;
     3236    11147    3               FPT_STATE.V.SYSID# = BUF$ -> VLA$INPUT.SYSID ;
     3237    11148
     3238    11149    3               CALL M$STATE(FPT_STATE) ALTRET (STATE_ERR) ;
     3239    11150    3   STATE_ERR:
     3240    11151    3               CALL CONVERT_TIME(STATE_BUF.TIME_REMAIN,TIME_BUF) ;
     3241    11152    3               FMT_VEC(I+1) = VECTOR(TIME_BUF) ;
     3242    11153    3               CALL CONVERT_TIME(STATE_BUF.TIME_USED,TIME_BUF1) ;
     3243    11154    3               FMT_VEC(I+2) = VECTOR(TIME_BUF1) ;
     3244    11155    3               I = I + 2 ;
     3245    11156
     3246    11157    3             CASE(%CP_SYSID_FOLL_MESS) ;
     3247    11158    3               F_FDS.FMT_ = VECTOR(SYSID_FOLL_MESS_FMT) ;
     3248    11159    3               NFOLL = BUF$ -> VLA$INPUT.NFOLL - 1 ;
     3249    11160    3               FMT_VEC(I+1) = VECTOR(BUF$ -> VLA$INPUT.JDID.SYSID(0)) ;
     3250    11161    3               FMT_VEC(I+2) = VECTOR(NFOLL) ;
     3251    11162    3               I = I + 2 ;
     3252    11163    4               DO II = 1 TO NFOLL ;
     3253    11164    4                 I = I + 1 ;
     3254    11165    4                 FMT_VEC(I) = VECTOR(BUF$ -> VLA$INPUT.JDID.SYSID(II)) ;
     3255    11166    4               END ; /* DO I */
     3256    11167
     3257    11168    3             CASE(%CP_SYSID_RUNAFTER_MESS) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:405  
     3258    11169    3               F_FDS.FMT_ = VECTOR(SYSID_DEFERRED_MESS_FMT) ;
     3259    11170    3               FMT_VEC(I+1) = VECTOR(BUF$->VLA$INPUT.RATIM) ;
     3260    11171    3               I = I + 1 ;
     3261    11172
     3262    11173    3             CASE(%CP_SYSID_WPART_MESS) ;
     3263    11174    3               F_FDS.FMT_ = VECTOR(SYSID_WPART_MESS_FMT) ;
     3264    11175
     3265    11176    3             CASE(%CP_SYSID_OTHER_MESS) ;
     3266    11177    3               F_FDS.FMT_ = VECTOR(SYSID_OTHER_MESS_FMT) ;
     3267    11178
     3268    11179    3             CASE(%CP_SYSID_WPS_MESS) ;
     3269    11180    3               F_FDS.FMT_ = VECTOR(SYSID_WPS_MESS_FMT) ;
     3270    11181
     3271    11182    3             CASE(%CP_SYSID_WAIT_MESS) ;
     3272    11183    3               F_FDS.FMT_ = VECTOR(SYSID_WAIT_MESS_FMT) ;
     3273    11184    3               FMT_VEC(I+1) = VECTOR(BUF$->VLA$INPUT.AHEAD) ;
     3274    11185    3               FMT_VEC(I+2) = VECTOR(BUF$->VLA$INPUT.PRIO) ;
     3275    11186    3               I = I + 2 ;
     3276    11187
     3277    11188    3         END ; /* DO CASE */
     3278    11189
     3279    11190    2         IF (CH_XFORMAT.COMMENT# ~= ' ')
     3280    11191    2           THEN
     3281    11192    3             DO ;
     3282    11193    3               FMT_VEC(I+1) = VECTOR(CH_XFORMAT.COMMENT#) ;
     3283    11194    3               I = I + 1 ;
     3284    11195    3             END ; /* THEN DO */
     3285    11196    2         F_FDS.NVECS# = I + 1 ;
     3286    11197
     3287    11198    2         RETURN ;
     3288    11199
     3289    11200    2   END   OUTPUT_SYSID_IN_AND_RUN ;
     3290    11201        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:406  
     3291    11202    1   OUTPUT_SYSID_OQ:    PROC ;
     3292    11203
     3293    11204    2         FMT_VEC(0) = VECTOR(BUF$ -> VLA$OUTPUT.SYSID) ;
     3294    11205    2         FMT_VEC(1) = VECTOR(BUF$ -> VLA$OUTPUT.NUM) ;
     3295    11206    2         FMT_VEC(2) = VECTOR(BUF$ -> VLA$OUTPUT.JNAME) ;
     3296    11207    2         FMT_VEC(3) = VECTOR(BUF$ -> VLA$OUTPUT.ACCT) ;
     3297    11208    2         I = 3 ;
     3298    11209    2         II = 16 ;
     3299    11210    2         FMT_BUF = '%D-%D %<>A.%<>A' ;
     3300    11211    2         IF (BUF$->VLA$OUTPUT.DEVNAME = ' ')
     3301    11212    2           THEN                                             /* Waiting to be output. */
     3302    11213    3             DO ;
     3303    11214    3               CALL GET_OUTPUT_TYPE(5,SH_OUT_TYPE_ARRY) ;
     3304    11215    3               I = 5 ;
     3305    11216    3               CALL INSERT(FMT_BUF,II,8,'waiting') ;
     3306    11217    3               II = II + 8 ;
     3307    11218    3               IF (BUF$ -> VLA$OUTPUT.FLG.DEVAVAIL)
     3308    11219    3                 THEN
     3309    11220    4                   DO ;
     3310    11221    4                     NUM_AHEAD = BUF$ -> VLA$OUTPUT.AHEAD ;
     3311    11222    4                     FMT_VEC(4) = VECTOR(NUM_AHEAD) ;
     3312    11223    4                     CALL INSERT(FMT_BUF,II,11,'%D to %<>A') ;
     3313    11224    4                     II = II + 11 ;
     3314    11225    4                   END ; /* THEN DO */
     3315    11226    3                 ELSE
     3316    11227    4                   DO ;                                  /* Waiting NODEV. */
     3317    11228    4                     FMT_VEC(4) = VECTOR(NODEV_HDR) ;
     3318    11229    4                     CALL INSERT(FMT_BUF,II,13,'%<>A to %<>A') ;
     3319    11230    4                     II = II + 13 ;
     3320    11231    4                   END ; /* ELSE DO */
     3321    11232    3                   CALL INSERT(FMT_BUF,II,3,'on') ;
     3322    11233    3                   II = II + 3 ;
     3323    11234    3             END ; /* THEN DO */
     3324    11235    2           ELSE
     3325    11236    3             DO ;                                        /* Being output. */
     3326    11237    3                 CALL GET_OUTPUT_TYPE(4,LC_OUT_TYPE_ARRY) ;
     3327    11238    3                 I = 4 ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:407  
     3328    11239    3                 CALL INSERT(FMT_BUF,II,8,'%<>A on') ;
     3329    11240    3                 II = II + 8 ;
     3330    11241    3               END ; /* ELSE DO */
     3331    11242    2         FMT_VEC(I+1) = VECTOR(BUF$ -> VLA$OUTPUT.DEVTYP) ;
     3332    11243    2         FMT_VEC(I+2) = VECTOR(BUF$ -> VLA$OUTPUT.DEVNAME) ;
     3333    11244    2         IF BUF$->VLA$OUTPUT.DEVNAME = ' '
     3334    11245    2             THEN
     3335    11246    2               FMT_VEC(I+3) = VECTOR(BUF$ -> VLA$OUTPUT.WOD) ;
     3336    11247    2             ELSE
     3337    11248    2               FMT_VEC(I+3) = VECTOR(BUF$ -> VLA$OUTPUT.TNAME) ;
     3338    11249    2         I = I + 3 ;
     3339    11250    2         CALL INSERT(FMT_BUF,II,13,'%<>A%<>A@%<>A') ;
     3340    11251    2         II = II + 13 ;
     3341    11252    2         STEPCC = CH_XFORMAT.STAT$ -> XSJ$JOBINFO.STEPCC# ;
     3342    11253    2         IF STEPCC ~= 0
     3343    11254    2             THEN
     3344    11255    3               DO ;
     3345    11256    3                 FMT_VEC(I+1) = VECTOR(STEPCC) ;
     3346    11257    3                 CALL INSERT(FMT_BUF,II,15,' with STEPCC=%D') ;
     3347    11258    3                 II = II + 15 ;
     3348    11259    3                 I = I + 1 ;
     3349    11260    3               END ; /* THEN DO */
     3350    11261    2         IF (CH_XFORMAT.COMMENT# ~= ' ')
     3351    11262    2           THEN
     3352    11263    3             DO ;
     3353    11264    3               FMT_VEC(I+1) = VECTOR(CH_XFORMAT.COMMENT#) ;
     3354    11265    3               I = I + 1 ;
     3355    11266    3               CALL INSERT(FMT_BUF,II,7,' - %<>A') ;
     3356    11267    3               II = II + 7 ;
     3357    11268    3             END ; /* THEN DO */
     3358    11269    2         F_FDS.NVECS# = I + 1 ;
     3359    11270    2         F_FDS.FMT_ = VECTOR(FMT_BUF) ;
     3360    11271
     3361    11272    2         RETURN ;
     3362    11273
     3363    11274    2   END   OUTPUT_SYSID_OQ ;
     3364    11275    1   END   CPK$CHECK_OUTPUT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:408  
     3365    11276        %EOD ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:409  
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPK$CHECK_OUTPUT.

   Procedure CPK$CHECK_OUTPUT requires 1651 words for executable code.
   Procedure CPK$CHECK_OUTPUT requires 338 words of local(AUTO) storage.

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:410  

 Object Unit name= CPK$CHECK_OUTPUT                           File name= CPK$CHECK.:E05TOU
 UTS= JUL 29 '97 11:57:00.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    806   1446  CPK$CHECK_OUTPUT
    2   Proc  even  none  1651   3163  CPK$CHECK_OUTPUT
    3  RoData even  none   118    166  CPK$CHECK_OUTPUT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  CPK$CHECK_OUTPUT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 CPK$FDS_OUTPUT
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:411  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CFPT_TIME                             CFPT_DISPLAY
r    SEG2$                            r    B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:412  


     2333        1        /*T***********************************************************/
     2334        2        /*T*                                                         */
     2335        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2336        4        /*T*                                                         */
     2337        5        /*T***********************************************************/
     2338        6        /**********************************************************************/
     2339        7        /*F*   NAME:   CPK$CHECK_OUTPUT
     2340        8               PURPOSE: To output the jobstats that have been returned
     2341        9        DCL SYSTEM_OK# BIT(1) ;
     2342       10                       from the M$JOBSTATS.
     2343       11               DESCRIPTION: CPK$CHECK_OUTPUT is passed a pointer to the jobstats
     2344       12                       to be used as the driver for the output using X$FORMAT.
     2345       13        */
     2346       14        /*D*   NAME:   CPK$CHECK_OUTPUT
     2347       15               CALL:   CALL CPK$CHECK_OUTPUT(CH_XFORMAT) ;
     2348       16               INTERFACE: X$FORMAT
     2349       17               INPUT:  CH_XFORMAT  - is the data to be output using X$FORMAT.
     2350       18               OUTPUT: Specified message to device assigned to M$LL.
     2351       19               DESCRIPTION: The jobstats that have been received is output using
     2352       20                       X$FORMAT.
     2353       21        */
     2354       22        /**********************************************************************/
     2355       23        CPK$CHECK_OUTPUT: PROC (CH_XFORMAT,NLINES) ;

     23  2 000000   000000 700200 xent  CPK$CHECK_O* TSX0  ! X66_AUTO_2
         2 000001   000522 000002                    ZERO    338,2

     2356       24
     2357       25             /***** Includes *****/
     2358       26
     2359       27        %INCLUDE B$JIT ;
     2360      317        %INCLUDE CP_6 ;
     2361      398        %INCLUDE CP_6_SUBS ;
     2362      938        %INCLUDE CP_SUBS_C ;
     2363     1855        %INCLUDE CP_MACROS_C ;
     2364     2607        %INCLUDE XU_MACRO_C ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:413  
     2365     5713        %INCLUDE CP_DATA_R ;
     2366     8276        %INCLUDE B_ERRORS_C ;
     2367     9403        %INCLUDE OC$MESSHD_C ;
     2368     9424        %INCLUDE XU_FORMAT_C ;
     2369     9586        %INCLUDE XSJ_MAC_C ;
     2370     9665        %INCLUDE XSJ_SUBS_C ;
     2371     9692        %INCLUDE NK_VFC_C ;
     2372     9766
     2373     9767             /***** Parameters *****/
     2374     9768
     2375     9769        %CH_XFORMAT                           ( FPTN = CH_XFORMAT,
     2376     9770              STCLASS=" ") ;
     2377     9794    1     DCL NLINES UBIN WORD ;  /* Number of lines to print the output */
     2378     9795
     2379     9796             /***** Based data *****/
     2380     9797
     2381     9798        %VLA_JOBSTATS_ISRCH                       ( FPTN = VLA$INPUT, STCLASS = BASED) ;
     2382     9825        %VLA_JOBSTATS_OSRCH                       ( FPTN=VLA$OUTPUT, STCLASS = BASED) ;
     2383     9842        %SEG$2 ;
     2384     9902    1   DCL CH$PART (0:15) BIT(1) BASED ;
     2385     9903        %VLP_JOBNAME (FPTN=VLP$JOBNAME,STCLASS=BASED) ;
     2386     9917        %XSJ_JOBINFO( FPTN = XSJ$JOBINFO, STCLASS = BASED) ;
     2387     9932        %FPT_WRITE( FPTN = FPT$WRITE, STCLASS = BASED) ;
     2388     9963        %F$DCB (DCBN=F$DCB) ;
     2389    10020
     2390    10021             /***** Ptr declarations *****/
     2391    10022
     2392    10023    1   DCL BUF$ PTR ;
     2393    10024    1   DCL TEMP$ PTR ;
     2394    10025
     2395    10026             /***** Entries *****/
     2396    10027
     2397    10028    1   DCL X$FORMAT ENTRY(1) ;
     2398    10029    1   DCL CPK$FDS_OUTPUT ENTRY(2) ALTRET ;
     2399    10030
     2400    10031             /***** Constant data *****/
     2401    10032
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:414  
     2402    10033        %F_FDS                                  ( NAME = CF_FDS,
     2403    10034              STCLASS = CONSTANT,
     2404    10035              TRUNC = NO,
     2405    10036              DVFC = %VFC_TRANSITION1 ,
     2406    10037              WRAPTAB = 4) ;
     2407    10150    1   DCL BLANK_FMT CHAR(0) CONSTANT INIT('    ') ;
     2408    10151    1   DCL O_BELL BIT(9) CONSTANT INIT('007'O) ;
     2409    10152    1   DCL BELL REDEF O_BELL CHAR(1) ;
     2410    10153    1   DCL INPUT_HDR_FMT CHAR(0) CONSTANT INIT('%0A') ;
     2411    10154    1   DCL INPUT_HDR CHAR(0) CONSTANT INIT
     2412    10155    1         (' AHE PRI SYSID O A F D MAX TIME   MEM ACCOUNT 1 *PARTITION* 16 JOB NAME') ;
     2413    10156    1   DCL RUN_HDR CHAR(0) CONSTANT INIT
     2414    10157    1         (' STA PRI SYSID O A F D MAX TIME   MEM ACCOUNT  PART JOB NAME') ;
     2415    10158    1   DCL DFLT_OUTPUT_HDR_FMT CHAR(0) CONSTANT INIT('%0A') ;
     2416    10159    1   DCL DFLT_OUTPUT_HDR CHAR(0) CONSTANT INIT
     2417    10160    1         ('  STATUS    SYSID   ACCOUNT PR CP   HC GRAN   FORM     WOD DEV JOB NAME') ;
     2418    10161    1   DCL INPUT_MESS_FMT CHAR(0) CONSTANT INIT
     2419    10162    1         ('%4D%1X%3D%1X%5D%1X%1A%1X%1A%1X%1A%1X%1A%1X%8A%2X%4D%1X%8A%1X%16A%1X%>A') ;
     2420    10163    1   DCL RUN_MESS_FMT CHAR(0) CONSTANT INIT
     2421    10164    1         ('%4A%1X%3D%1X%5D%1X%1A%1X%1A%1X%1A%1X%1A%1X%8A%2X%4D%1X%8A%2X%2D%2X%>A') ;
     2422    10165    1   DCL OUTPUT_NOWAIT_MESS_FMT CHAR(0) CONSTANT INIT
     2423    10166    1         (' %8A %5D-%D%20-%8>A %2D%3D %1A%3D %4D %6>A %8>A %2A%2A %>A') ;
     2424    10167    1   DCL OUTPUT_NOWAIT_MESS_FMT2 CHAR(0) CONSTANT INIT
     2425    10168    1         (' %8A %2D-%D%20-%8>A %2D%3D %1A%3D %4D %6>A %8>A %2A%2A %>A') ;
     2426    10169    1   DCL OUTPUT_WAIT_MESS_FMT CHAR(0) CONSTANT INIT
     2427    10170    1         ('%3D %5A %5D-%D%20-%8>A %2D%3D %1A%3D %4D %6>A %8>A %2A%2A %>A') ;
     2428    10171    1   DCL OUTPUT_WAIT_MESS_FMT2 CHAR(0) CONSTANT INIT
     2429    10172    1         ('%3D %5A %2D-%D%20-%8>A %2D%3D %1A%3D %4D %6>A %8>A %2A%2A %>A') ;
     2430    10173    1   DCL SYSID_RUN_MESS_FMT CHAR(0) CONSTANT INIT
     2431    10174    1         ('%D %<>A.%<>A running %<>A/%<>A%Q - %<>A') ;
     2432    10175    1   DCL SYSID_FOLL_MESS_FMT CHAR(0) CONSTANT INIT
     2433    10176    1         ('%D %<>A.%<>A waiting to follow %D%N(,%D%)%Q - %<>A') ;
     2434    10177    1   DCL SYSID_WPART_MESS_FMT CHAR(0) CONSTANT INIT
     2435    10178    1         ('%D %<>A.%<>A no partition available.%Q - %<>A') ;
     2436    10179    1   DCL SYSID_OTHER_MESS_FMT CHAR(0) CONSTANT INIT
     2437    10180    1         ('%D %<>A.%<>A stuck in some priority queue.%Q - %<>A') ;
     2438    10181    1   DCL SYSID_WPS_MESS_FMT CHAR(0) CONSTANT INIT
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:415  
     2439    10182    1         ('%D %<>A.%<>A waiting for disk packset.%Q - %<>A') ;
     2440    10183    1   DCL SYSID_WAIT_MESS_FMT CHAR(0) CONSTANT INIT
     2441    10184    1         ('%D %<>A.%<>A waiting %D to run at prio %D%Q - %<>A') ;
     2442    10185    1   DCL SYSID_DEFERRED_MESS_FMT CHAR(0) CONSTANT INIT
     2443    10186    1         ('%D %<>A.%<>A deferred to %..2U%Q - %<>A') ;
     2444    10187    1   DCL SYSID_OUTPUT_MESS_FMT CHAR(0) CONSTANT INIT
     2445    10188    1         ('%D-%D %<>A.%<>A %<>A on %<>A%<>A@%<>A%Q - %<>A') ;
     2446    10189    1   DCL SYSID_OUTPUT_WAIT_MESS_FMT CHAR(0) CONSTANT INIT
     2447    10190    1         ('%D-%D %<>A.%<>A waiting %D to %<>A on %<>A%<>A@%<>A%Q - %<>A') ;
     2448    10191    1   DCL SYSID_OUTPUT_NODEV_MESS_FMT CHAR(0) CONSTANT INIT
     2449    10192    1         ('%D-%D %<>A.%<>A waiting %<>A to %<>A on %<>A%<>A@%<>A%Q - %<>A') ;
     2450    10193    1   DCL NONE_MESS_FMT CHAR(0) CONSTANT INIT ('...None') ;
     2451    10194    1   DCL NONE_IN_MESS_FMT CHAR(0) CONSTANT INIT ('...None (In)') ;
     2452    10195    1   DCL NONE_RUN_MESS_FMT CHAR(0) CONSTANT INIT ('...None (Run)') ;
     2453    10196    1   DCL NONE_OUT_MESS_FMT CHAR(0) CONSTANT INIT ('...None (Out)') ;
     2454    10197    1   DCL TIME_DI_MESS_HDR CHAR(0) CONSTANT INIT(' %..2U %D*%D <%D%Q%A') ;
     2455    10198    1   DCL NO_TERM_OUT_HDR CHAR(0) CONSTANT INIT('%D No terminal output found.') ;
     2456    10199    1   DCL NO_SUCH_MESS_HDR CHAR(0) CONSTANT INIT(
             10199            'No such message number for CHECK.  Oops.') ;
     2457    10200    1   DCL APRESCAN_FMT1 CHAR(0) CONSTANT INIT('Job %<>A submitted.') ;
     2458    10201    1   DCL APRESCAN_FMT2 CHAR(0) CONSTANT INIT('Job %D %<>A submitted.') ;
     2459    10202    1   DCL COMPLETED_FMT1 CHAR(0) CONSTANT INIT('%<>A completed.') ;
     2460    10203    1   DCL COMPLETED_FMT2 CHAR(0) CONSTANT INIT('%D %<>A completed.') ;
     2461    10204    1   DCL NUM_LISTED_HDR_FMT CHAR(0) CONSTANT INIT('%4D%0A') ;
     2462    10205    1   DCL NUM_LISTED_MESS CHAR(0) CONSTANT INIT(' items Listed.') ;
     2463    10206    1   DCL HELD_LINE_FMT (0:79) CHAR(1) CONSTANT INIT('-'*0) ;
     2464    10207    1   DCL OUT_TYPE_ARRY (0:5) CHAR(8) UNAL CONSTANT INIT
     2465    10208    1         (   'Printing',
     2466    10209    1             'Punching',
     2467    10210    1             'Beaming',
     2468    10211    1             'Plotting',
     2469    10212    1             'Typing',
     2470    10213    1             'On Dev.') ;
     2471    10214    1   DCL LC_OUT_TYPE_ARRY (0:5) CHAR(8) UNAL CONSTANT INIT
     2472    10215    1         (   'printing',
     2473    10216    1             'punching',
     2474    10217    1             'beaming',
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:416  
     2475    10218    1             'plotting',
     2476    10219    1             'typing',
     2477    10220    1             'on dev.') ;
     2478    10221    1   DCL SH_OUT_TYPE_ARRY (0:5) CHAR(8) UNAL CONSTANT INIT
     2479    10222    1         (   'print',
     2480    10223    1             'punch',
     2481    10224    1             'beam',
     2482    10225    1             'plot',
     2483    10226    1             'type',
     2484    10227    1             'output');
     2485    10228    1   DCL FMT1 CHAR(0) CONSTANT INIT('%D-%D %<>A.%<>A doesn''t exist.%Q - %<>A') ;
     2486    10229    1   DCL FMTVEC_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FMTVEC ) );
     2487    10230    1   DCL FMTVEC1_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FMTVEC1 ) );
     2488    10231    1   DCL FMTVEC2_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FMTVEC2 ) );
     2489    10232    1   DCL FMTVEC CHAR(0) CONSTANT INIT('%D %<>A.%<>A %<>A %..2U%Q - %<>A') ;
     2490    10233    1  DCL FMTVEC1 CHAR(0) CONSTANT INIT('%D %<>A.%<>A %<>A %..2U with STEPCC=%D%Q - %<>A')
             10233            ;
     2491    10234    1   DCL FMTVEC2 CHAR(0) CONSTANT INIT
     2492    10235    1         ('%D %<>A.%<>A rejected at record %D (%<>A) at %..2U%Q - %<>A') ;
     2493    10236    1   DCL LIMIT_FMT_BUF CHAR(0) CONSTANT INIT('%D %<>A.%<>A limit %<>A') ;
     2494    10237    1   DCL EXTRA_LIMITS_FMT CHAR(0) CONSTANT INIT (',%<>A') ;
     2495    10238    1   DCL LIMIT_COMMENT_FMT CHAR(0) CONSTANT INIT (' exceeded%Q - %<>A') ;
     2496    10239    1   DCL MBS_DELETED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( MBS_DELETED ) );
     2497    10240    1   DCL MBS_CANCELED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( MBS_CANCELED ) );
     2498    10241    1   DCL MBS_SHAFTED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( MBS_SHAFTED ) );
     2499    10242    1   DCL MBS_FILERR_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( MBS_FILERR ) );
     2500    10243    1   DCL PRE_PASSED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( PRE_PASSED ) );
     2501    10244    1   DCL REJ_JOB_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_JOB ) );
     2502    10245    1   DCL REJ_RES_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_RES ) );
     2503    10246    1   DCL REJ_SYNTAX_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_SYNTAX ) );
     2504    10247    1   DCL REJ_IO_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_IO ) );
     2505    10248    1   DCL REJ_JOBIMBED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_JOBIMBED ) );
     2506    10249    1   DCL REJ_BADID_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_BADID ) );
     2507    10250    1   DCL REJ_NORES_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_NORES ) );
     2508    10251    1   DCL REJ_PRESCAN_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_PRESCAN ) );
     2509    10252    1   DCL REJ_RESIMBED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_RESIMBED ) );
     2510    10253    1   DCL REJ_NOBATCH_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( REJ_NOBATCH ) );
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:417  
     2511    10254    1   DCL FIN_RECOVER_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FIN_RECOVER ) );
     2512    10255    1   DCL FIN_ABNORMAL_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FIN_ABNORMAL ) );
     2513    10256    1   DCL FIN_COMPLETED_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( FIN_COMPLETED ) );
     2514    10257    1   DCL FIN_ABNORMAL_UNKNOWN_ BIT(72) CONSTANT DALIGNED INIT( VECTOR(
             10257            FIN_ABNORMAL_UNKNOWN ) );
     2515    10258    1   DCL MBS_DELETED CHAR(0) CONSTANT INIT( 'Deleted by operator' );
     2516    10259    1   DCL MBS_CANCELED CHAR(0) CONSTANT INIT( 'Canceled by user' );
     2517    10260    1   DCL MBS_SHAFTED CHAR(0) CONSTANT INIT( 'Deleted by MBS for FOLLOW condition' );
     2518    10261    1  DCL MBS_FILERR CHAR(0) CONSTANT INIT( 'Canceled by MBS due to file inconsistency' );
     2519    10262    1   DCL PRE_PASSED CHAR(0) CONSTANT INIT( 'Passed PRESCAN successfully' );
     2520    10263    1   DCL REJ_JOB CHAR(0) CONSTANT INIT( 'bad !JOB' );
     2521    10264    1   DCL REJ_RES CHAR(0) CONSTANT INIT( 'bad !RESOURCE' );
     2522    10265    1   DCL REJ_SYNTAX CHAR(0) CONSTANT INIT( 'syntax error' );
     2523    10266    1   DCL REJ_IO CHAR(0) CONSTANT INIT( 'I/O error' );
     2524    10267    1   DCL REJ_JOBIMBED CHAR(0) CONSTANT INIT( 'imbedded !JOB' );
     2525    10268    1  DCL REJ_BADID CHAR(0) CONSTANT INIT( 'invalid ACCOUNT, USER, or PASSWORD on !JOB' );
     2526    10269    1   DCL REJ_NORES CHAR(0) CONSTANT INIT( 'too many resources specified' );
     2527    10270    1   DCL REJ_PRESCAN CHAR(0) CONSTANT INIT( 'PRESCAN problem' );
     2528    10271    1   DCL REJ_RESIMBED CHAR(0) CONSTANT INIT( 'imbedded !RESOURCE' );
     2529    10272    1   DCL REJ_NOBATCH CHAR(0) CONSTANT INIT( 'you are not authorized for BATCH' );
     2530    10273    1   DCL FIN_RECOVER CHAR(0) CONSTANT INIT( 'Caught in RECOVERY' );
     2531    10274    1   DCL FIN_ABNORMAL CHAR(0) CONSTANT INIT( 'Completed ABNORMALLY' );
     2532    10275    1   DCL FIN_COMPLETED CHAR(0) CONSTANT INIT( 'completed successfully at ');
     2533    10276    1   DCL FIN_ABNORMAL_UNKNOWN CHAR(0) CONSTANT INIT
     2534    10277    1                 ( 'completed ABNORMALLY with unknown error code') ;
     2535    10278    1   DCL RS__(0:8) BIT(72) CONSTANT DALIGNED INIT( VECTOR( RS_ERR ),
     2536    10279    1                                               VECTOR( RS_XXX ),
     2537    10280    1                                               VECTOR( RS_SSP ),
     2538    10281    1                                               VECTOR( RS_ABRT ),
     2539    10282    1                                               VECTOR( RS_EKEY ),
     2540    10283    1                                               VECTOR( RS_OFF ),
     2541    10284    1                                               VECTOR( RS_LIMX ),
     2542    10285    1                                               VECTOR( RS_DROP ),
     2543    10286    1                                               VECTOR( RS_XKEY ) );
     2544    10287    1   DCL XL__(0:8) BIT(72) CONSTANT DALIGNED INIT( VECTOR( XL_TIME ),
     2545    10288    1                                               VECTOR( XL_STACK ),
     2546    10289    1                                               VECTOR( XL_TAPE ),
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:418  
     2547    10290    1                                               VECTOR( XL_TDISK ),
     2548    10291    1                                               VECTOR( XL_PDISK ),
     2549    10292    1                                               VECTOR( XL_DO ),
     2550    10293    1                                               VECTOR( XL_LO ),
     2551    10294    1                                               VECTOR( XL_PLO ),
     2552    10295    1                                               VECTOR( XL_PO ) );
     2553    10296    1   DCL RS_CAN_ BIT(72) CONSTANT DALIGNED INIT( VECTOR( RS_CAN ) );
     2554    10297    1   DCL RS_ERR CHAR(0) CONSTANT INIT( 'M$ERR pmme' );
     2555    10298    1   DCL RS_XXX CHAR(0) CONSTANT INIT( 'M$XXX pmme' );
     2556    10299    1   DCL RS_SSP CHAR(0) CONSTANT INIT( 'Aborted by special shared processor' );
     2557    10300    1   DCL RS_ABRT CHAR(0) CONSTANT INIT( 'Aborted by monitor (ABORTM)' );
     2558    10301    1   DCL RS_EKEY CHAR(0) CONSTANT INIT( 'Errored by operator' );
     2559    10302    1   DCL RS_OFF CHAR(0) CONSTANT INIT( 'Aborted by monitor (!X)' );
     2560    10303    1   DCL RS_LIMX CHAR(0) CONSTANT INIT( 'Limit exceeded' );
     2561    10304    1   DCL RS_DROP CHAR(0) CONSTANT INIT( 'Line disconnect' );
     2562    10305    1   DCL RS_XKEY CHAR(0) CONSTANT INIT( 'Aborted by operator' );
     2563    10306    1   DCL RS_CAN CHAR(0) CONSTANT INIT( 'Canceled by user' );
     2564    10307    1   DCL XL_TIME CHAR(0) CONSTANT INIT( 'TIME' );
     2565    10308    1   DCL XL_STACK CHAR(0) CONSTANT INIT( 'STACK' );
     2566    10309    1   DCL XL_TAPE CHAR(0) CONSTANT INIT( 'TAPE' );
     2567    10310    1   DCL XL_TDISK CHAR(0) CONSTANT INIT( 'TDIS' );
     2568    10311    1   DCL XL_PDISK CHAR(0) CONSTANT INIT( 'PDIS' );
     2569    10312    1   DCL XL_DO CHAR(0) CONSTANT INIT( 'DO' );
     2570    10313    1   DCL XL_LO CHAR(0) CONSTANT INIT( 'LO' );
     2571    10314    1   DCL XL_PLO CHAR(0) CONSTANT INIT( 'PLO' );
     2572    10315    1   DCL XL_PO CHAR(0) CONSTANT INIT( 'PO' );
     2573    10316    1   DCL AHEAD_HDR CHAR(0) CONSTANT INIT('Ahead') ;
     2574    10317    1   DCL RUN_TEXT_HDR CHAR(0) CONSTANT INIT('Run') ;
     2575    10318    1   DCL BATCH_HDR CHAR(0) CONSTANT INIT('B') ;
     2576    10319    1   DCL ONLINE_HDR CHAR(0) CONSTANT INIT('O') ;
     2577    10320    1   DCL GHOST_HDR CHAR(0) CONSTANT INIT('G') ;
     2578    10321    1   DCL TP_HDR CHAR(0) CONSTANT INIT('T') ;
     2579    10322    1   DCL A_CHAR CHAR(0) CONSTANT INIT('A') ;
     2580    10323    1   DCL D_CHAR CHAR(0) CONSTANT INIT('D') ;
     2581    10324    1   DCL H_CHAR CHAR(0) CONSTANT INIT('H') ;
     2582    10325    1   DCL F_CHAR CHAR(0) CONSTANT INIT('F') ;
     2583    10326    1   DCL O_CHAR CHAR(0) CONSTANT INIT('O') ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:419  
     2584    10327    1   DCL BLANK_CHAR CHAR(0) CONSTANT INIT(' ') ;
     2585    10328    1   DCL PART_ARRY (0:15) CHAR(1) CONSTANT
     2586    10329    1         INIT('1','2','3','4','5','6','7','8','9','0','1','2','3','4','5','6') ;
     2587    10330    1   DCL NODEV_HDR CHAR(0) CONSTANT INIT ('NODEV') ;
     2588    10331    1   DCL NODEV_HDR2 CHAR(0) CONSTANT INIT ('Nodev') ;
     2589    10332
     2590    10333             /***** AUTO data *****/
     2591    10334
     2592    10335        %F_FDS                                      ( NAME = F_FDS,
     2593    10336              STCLASS = AUTO) ;
     2594    10449    1   DCL FMT_VEC(0:75) BIT(72) ;
     2595    10450    1   DCL OUT_BUF CHAR(150) ;
     2596    10451    1   DCL I UBIN WORD ;
     2597    10452    1   DCL II UBIN WORD ;
     2598    10453    1   DCL NFOLL UBIN WORD ;
     2599    10454    1   DCL BITSET UBIN WORD ;
     2600    10455    1   DCL UTS SBIN WORD ;
     2601    10456    1   DCL 1 STATE_BUF ALIGNED,
     2602    10457    1         2 NUM UBIN WORD UNAL,
     2603    10458    1         2 ESC_Q CHAR(4) UNAL,
     2604    10459    1         2 TIME_USED UBIN WORD UNAL,
     2605    10460    1         2 TIME_REMAIN UBIN WORD UNAL;
     2606    10461    1   DCL TIME_BUF CHAR(8) ;
     2607    10462    1   DCL TIME_BUF1 CHAR(8) ;
     2608    10463    1   DCL PART_BUF CHAR(16) ;
     2609    10464    1   DCL DEVTYPE CHAR(2) ;
     2610    10465    1   DCL NUM_AHEAD UBIN WORD ;
     2611    10466    1   DCL TYPE_NUM UBIN WORD ;
     2612    10467    1   DCL STEPCC UBIN WORD ;
     2613    10468    1   DCL STEPCC_ BIT(72) DALIGNED ;
     2614    10469    1   DCL RECNO_ BIT(72) DALIGNED ;
     2615    10470    1   DCL FMT_BUF CHAR(80) ;
     2616    10471    1   DCL LIMIT_BUF CHAR(80) ;
     2617    10472    1   DCL START UBIN WORD ;
     2618    10473    1   DCL NCHARS UBIN WORD ;
     2619    10474    1   DCL WIDTH UBIN WORD ;
     2620    10475
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:420  
     2621    10476             /***** Auto FPTs *****/
     2622    10477
     2623    10478        %VLR_DISPLAY  (FPTN = VLR_DISPLAY,STCLASS=AUTO) ;
     2624    10492        %FPT_DISPLAY  (FPTN = FPT_DISPLAY,STCLASS=AUTO) ;
     2625    10505        %FPT_TIME (FPTN = FPT_TIME,STCLASS=AUTO) ;
     2626    10524        %FPT_STATE(FPTN=FPT_STATE,STCLASS=AUTO) ;
     2627    10538
     2628    10539             /***** Procedure *****/
     2629    10540
     2630    10541    1         FMT_VEC = '0'B ;

  10541  2 000002   000100 100400                    MLR     fill='000'O
         2 000003   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000004   200045 001140                    ADSC9   FMT_VEC,,AUTO            cn=0,n=608

     2631    10542    1         OUT_BUF = ' ' ;

  10542  2 000005   040100 100400                    MLR     fill='040'O
         2 000006   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000007   200275 000226                    ADSC9   OUT_BUF,,AUTO            cn=0,n=150

     2632    10543    1         F_FDS = CF_FDS ;

  10543  2 000010   000100 100400                    MLR     fill='000'O
         2 000011   000000 000170 1                  ADSC9   CF_FDS                   cn=0,n=120
         2 000012   200007 000170                    ADSC9   F_FDS,,AUTO              cn=0,n=120

     2633    10544    1         F_FDS.OUTPUT# = ENTADDR(CPK$FDS_OUTPUT) ;

  10544  2 000013   000000 636000 xent               EAQ     CPK$FDS_OUTPUT
         2 000014   200023 756100                    STQ     F_FDS+12,,AUTO

     2634    10545    1         F_FDS.VECTR$ = ADDR(FMT_VEC(0)) ;

  10545  2 000015   200045 630500                    EPPR0   FMT_VEC,,AUTO
         2 000016   200021 450500                    STP0    F_FDS+10,,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:421  
     2635    10546    1         F_FDS.BUF_ = VECTOR(OUT_BUF) ;

  10546  2 000017   000000 235000 3                  LDA     0
         2 000020   200520 452500                    STP2    @START+2,,AUTO
         2 000021   200520 236100                    LDQ     @START+2,,AUTO
         2 000022   000275 036003                    ADLQ    189,DU
         2 000023   200014 757100                    STAQ    F_FDS+5,,AUTO

     2636    10547
     2637    10548    1         BUF$ = CH_XFORMAT.BUF$ ;

  10548  2 000024   200003 471500                    LDP1    @CH_XFORMAT,,AUTO
         2 000025   100015 236100                    LDQ     13,,PR1
         2 000026   200005 756100                    STQ     BUF$,,AUTO

     2638    10549
     2639    10550    2         DO CASE (CH_XFORMAT.MSG#) ;

  10550  2 000027   100000 235100                    LDA     0,,PR1
         2 000030   000036 115007                    CMPA    30,DL
         2 000031   000033 602005 2                  TNC     s:10550+4,AL
         2 000032   001372 710000 2                  TRA     s:10828
         2 000033   001372 710000 2                  TRA     s:10828
         2 000034   000605 710000 2                  TRA     s:10658
         2 000035   000071 710000 2                  TRA     s:10553
         2 000036   000640 710000 2                  TRA     s:10673
         2 000037   000700 710000 2                  TRA     s:10692
         2 000040   000627 710000 2                  TRA     s:10668
         2 000041   000302 710000 2                  TRA     s:10599
         2 000042   000616 710000 2                  TRA     s:10663
         2 000043   000071 710000 2                  TRA     s:10553
         2 000044   001243 710000 2                  TRA     s:10793
         2 000045   000602 710000 2                  TRA     s:10655
         2 000046   000705 710000 2                  TRA     s:10696
         2 000047   001132 710000 2                  TRA     s:10760
         2 000050   001075 710000 2                  TRA     s:10747
         2 000051   001167 710000 2                  TRA     s:10773
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:422  
         2 000052   001240 710000 2                  TRA     s:10789
         2 000053   000577 710000 2                  TRA     s:10652
         2 000054   000577 710000 2                  TRA     s:10652
         2 000055   000577 710000 2                  TRA     s:10652
         2 000056   000577 710000 2                  TRA     s:10652
         2 000057   000577 710000 2                  TRA     s:10652
         2 000060   000577 710000 2                  TRA     s:10652
         2 000061   000577 710000 2                  TRA     s:10652
         2 000062   000661 710000 2                  TRA     s:10680
         2 000063   000666 710000 2                  TRA     s:10684
         2 000064   000673 710000 2                  TRA     s:10688
         2 000065   001345 710000 2                  TRA     s:10815
         2 000066   001352 710000 2                  TRA     s:10819
         2 000067   001243 710000 2                  TRA     s:10793
         2 000070   001365 710000 2                  TRA     s:10824

     2640    10551
     2641    10552    2             CASE(%CP_INPUT_MESS,%CP_RUN_MESS) ;

     2642    10553    2               IF (CH_XFORMAT.MSG# = %CP_INPUT_MESS)

  10553  2 000071   000002 115007                    CMPA    2,DL
         2 000072   000104 601000 2                  TNZ     s:10561

     2643    10554    2                 THEN
     2644    10555    3                   DO ;

     2645    10556    3                     F_FDS.FMT_ = VECTOR(INPUT_MESS_FMT) ;

  10556  2 000073   000002 237000 3                  LDAQ    2
         2 000074   200007 755100                    STA     F_FDS,,AUTO
         2 000075   200010 756100                    STQ     F_FDS+1,,AUTO

     2646    10557    3                     FMT_VEC(0) = VECTOR(BUF$->VLA$INPUT.AHEAD) ;

  10557  2 000076   777640 235007                    LDA     -96,DL
         2 000077   200005 236100                    LDQ     BUF$,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:423  
         2 000100   000007 036003                    ADLQ    7,DU
         2 000101   200045 755100                    STA     FMT_VEC,,AUTO
         2 000102   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2647    10558    3                   END ; /* THEN DO */

  10558  2 000103   000112 710000 2                  TRA     s:10564

     2648    10559    2                 ELSE
     2649    10560    3                   DO ;

     2650    10561    3                     F_FDS.FMT_ = VECTOR(RUN_MESS_FMT) ;

  10561  2 000104   000004 237000 3                  LDAQ    4
         2 000105   200007 755100                    STA     F_FDS,,AUTO
         2 000106   200010 756100                    STQ     F_FDS+1,,AUTO

     2651    10562    3                     FMT_VEC(0) = VECTOR(RUN_TEXT_HDR) ;

  10562  2 000107   000006 237000 3                  LDAQ    6
         2 000110   200045 755100                    STA     FMT_VEC,,AUTO
         2 000111   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2652    10563    3                   END ; /* ELSE DO */

     2653    10564    2               FMT_VEC(1) = VECTOR(BUF$->VLA$INPUT.IPRIO) ;

  10564  2 000112   177640 235007                    LDA     65440,DL
         2 000113   200005 236100                    LDQ     BUF$,,AUTO
         2 000114   000001 036000 3                  ADLQ    1
         2 000115   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 000116   200050 756100                    STQ     FMT_VEC+3,,AUTO

     2654    10565    2               FMT_VEC(2) = VECTOR(BUF$->VLA$INPUT.SYSID) ;

  10565  2 000117   377640 235007                    LDA     130976,DL
         2 000120   200005 236100                    LDQ     BUF$,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:424  
         2 000121   000010 036000 3                  ADLQ    8
         2 000122   200051 755100                    STA     FMT_VEC+4,,AUTO
         2 000123   200052 756100                    STQ     FMT_VEC+5,,AUTO

     2655    10566    2               IF (BUF$ -> VLA$INPUT.FLG.O1)

  10566  2 000124   200005 473500                    LDP3    BUF$,,AUTO
         2 000125   300006 234100                    SZN     6,,PR3
         2 000126   000133 605000 2                  TPL     s:10568

     2656    10567    2                 THEN FMT_VEC(3) = VECTOR(O_CHAR) ;

  10567  2 000127   000012 237000 3                  LDAQ    10
         2 000130   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 000131   200054 756100                    STQ     FMT_VEC+7,,AUTO
         2 000132   000136 710000 2                  TRA     s:10569

     2657    10568    2                 ELSE FMT_VEC(3) = VECTOR(BLANK_CHAR) ;

  10568  2 000133   000014 237000 3                  LDAQ    12
         2 000134   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 000135   200054 756100                    STQ     FMT_VEC+7,,AUTO

     2658    10569    2               IF (BUF$ -> VLA$INPUT.FLG.ACC)

  10569  2 000136   300006 236100                    LDQ     6,,PR3
         2 000137   040000 316003                    CANQ    16384,DU
         2 000140   000145 600000 2                  TZE     s:10571

     2659    10570    2                 THEN FMT_VEC(4) = VECTOR(A_CHAR) ;

  10570  2 000141   000016 237000 3                  LDAQ    14
         2 000142   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 000143   200056 756100                    STQ     FMT_VEC+9,,AUTO
         2 000144   000150 710000 2                  TRA     s:10572

     2660    10571    2                 ELSE FMT_VEC(4) = VECTOR(BLANK_CHAR) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:425  

  10571  2 000145   000014 237000 3                  LDAQ    12
         2 000146   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 000147   200056 756100                    STQ     FMT_VEC+9,,AUTO

     2661    10572    2               IF (BUF$ -> VLA$INPUT.FLG.O3)

  10572  2 000150   300006 236100                    LDQ     6,,PR3
         2 000151   100000 316003                    CANQ    32768,DU
         2 000152   000157 600000 2                  TZE     s:10574

     2662    10573    2                 THEN FMT_VEC(5) = VECTOR(F_CHAR) ;

  10573  2 000153   000020 237000 3                  LDAQ    16
         2 000154   200057 755100                    STA     FMT_VEC+10,,AUTO
         2 000155   200060 756100                    STQ     FMT_VEC+11,,AUTO
         2 000156   000162 710000 2                  TRA     s:10575

     2663    10574    2                 ELSE FMT_VEC(5) = VECTOR(BLANK_CHAR) ;

  10574  2 000157   000014 237000 3                  LDAQ    12
         2 000160   200057 755100                    STA     FMT_VEC+10,,AUTO
         2 000161   200060 756100                    STQ     FMT_VEC+11,,AUTO

     2664    10575    2               IF (BUF$ -> VLA$INPUT.FLG.RA)

  10575  2 000162   300006 236100                    LDQ     6,,PR3
         2 000163   002000 316003                    CANQ    1024,DU
         2 000164   000171 600000 2                  TZE     s:10577

     2665    10576    2                 THEN FMT_VEC(6) = VECTOR(D_CHAR) ;

  10576  2 000165   000022 237000 3                  LDAQ    18
         2 000166   200061 755100                    STA     FMT_VEC+12,,AUTO
         2 000167   200062 756100                    STQ     FMT_VEC+13,,AUTO
         2 000170   000174 710000 2                  TRA     s:10578

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:426  
     2666    10577    2                 ELSE FMT_VEC(6) = VECTOR(BLANK_CHAR) ;

  10577  2 000171   000014 237000 3                  LDAQ    12
         2 000172   200061 755100                    STA     FMT_VEC+12,,AUTO
         2 000173   200062 756100                    STQ     FMT_VEC+13,,AUTO

     2667    10578    2               UTS = BUF$ -> VLA$INPUT.TIM ;

  10578  2 000174   300040 235100                    LDA     32,,PR3
         2 000175   200347 755100                    STA     UTS,,AUTO

     2668    10579    2               CALL CONVERT_TIME(UTS,TIME_BUF) ;

  10579  2 000176   200354 634500                    EPPR4   TIME_BUF,,AUTO
         2 000177   200510 454500                    STP4    @MASK+1,,AUTO
         2 000200   200347 635500                    EPPR5   UTS,,AUTO
         2 000201   200507 455500                    STP5    FPT_STATE+9,,AUTO
         2 000202   001454 701000 2                  TSX1    CONVERT_TIME
         2 000203   000000 011000                    NOP     0

     2669    10580    2               FMT_VEC(7) = VECTOR( TIME_BUF ) ;

  10580  2 000204   000011 235000 3                  LDA     9
         2 000205   200520 452500                    STP2    @START+2,,AUTO
         2 000206   200520 236100                    LDQ     @START+2,,AUTO
         2 000207   000354 036003                    ADLQ    236,DU
         2 000210   200063 755100                    STA     FMT_VEC+14,,AUTO
         2 000211   200064 756100                    STQ     FMT_VEC+15,,AUTO

     2670    10581    2               FMT_VEC(8) = VECTOR(BUF$->VLA$INPUT.RRT(0)) ;

  10581  2 000212   377640 235007                    LDA     130976,DL
         2 000213   200005 236100                    LDQ     BUF$,,AUTO
         2 000214   000032 036003                    ADLQ    26,DU
         2 000215   200065 755100                    STA     FMT_VEC+16,,AUTO
         2 000216   200066 756100                    STQ     FMT_VEC+17,,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:427  
     2671    10582    2               FMT_VEC(9) = VECTOR(BUF$->VLA$INPUT.ACCT) ;

  10582  2 000217   000011 235000 3                  LDA     9
         2 000220   200005 236100                    LDQ     BUF$,,AUTO
         2 000221   000010 036003                    ADLQ    8,DU
         2 000222   200067 755100                    STA     FMT_VEC+18,,AUTO
         2 000223   200070 756100                    STQ     FMT_VEC+19,,AUTO

     2672    10583    2               IF (CH_XFORMAT.MSG# = %CP_INPUT_MESS)

  10583  2 000224   200003 470500                    LDP0    @CH_XFORMAT,,AUTO
         2 000225   000000 235100                    LDA     0,,PR0
         2 000226   000002 115007                    CMPA    2,DL
         2 000227   000265 601000 2                  TNZ     s:10594

     2673    10584    2                 THEN
     2674    10585    3                   DO ;

     2675    10586    3                     TEMP$ = ADDR(BUF$->VLA$INPUT.PART) ;

  10586  2 000230   200005 236100                    LDQ     BUF$,,AUTO
         2 000231   000024 036000 3                  ADLQ    20
         2 000232   200006 756100                    STQ     TEMP$,,AUTO

     2676    10587    4                     DO I = 0 TO 15 ;

  10587  2 000233   200343 450100                    STZ     I,,AUTO

     2677    10588    4                       IF (TEMP$->CH$PART(I))

  10588  2 000234   200006 470500                    LDP0    TEMP$,,AUTO
         2 000235   200343 235100                    LDA     I,,AUTO
         2 000236   000000 066505                    CMPB    filb='0'B
         2 000237   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         2 000240   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000241   000246 600000 2                  TZE     s:10590

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:428  
     2678    10589    4                         THEN CALL INSERT(PART_BUF,I,1,PART_ARRY(I)) ;

  10589  2 000242   040105 100405                    MLR     fill='040'O
         2 000243   001363 000001 1                  ADSC9   PART_ARRY,A              cn=0,n=1
         2 000244   200360 000001                    ADSC9   PART_BUF,A,AUTO          cn=0,n=1
         2 000245   000251 710000 2                  TRA     s:10591

     2679    10590    4                         ELSE CALL INSERT(PART_BUF,I,1,'.') ;

  10590  2 000246   040105 100400                    MLR     fill='040'O
         2 000247   000025 000001 3                  ADSC9   21                       cn=0,n=1
         2 000250   200360 000001                    ADSC9   PART_BUF,A,AUTO          cn=0,n=1

     2680    10591    4                     END ; /* DO I */

  10591  2 000251   200343 235100                    LDA     I,,AUTO
         2 000252   000001 035007                    ADLA    1,DL
         2 000253   200343 755100                    STA     I,,AUTO
         2 000254   000020 115007                    CMPA    16,DL
         2 000255   000234 602000 2                  TNC     s:10588

     2681    10592    3                     FMT_VEC(10) = VECTOR(PART_BUF) ;

  10592  2 000256   000026 235000 3                  LDA     22
         2 000257   200520 452500                    STP2    @START+2,,AUTO
         2 000260   200520 236100                    LDQ     @START+2,,AUTO
         2 000261   000360 036003                    ADLQ    240,DU
         2 000262   200071 755100                    STA     FMT_VEC+20,,AUTO
         2 000263   200072 756100                    STQ     FMT_VEC+21,,AUTO

     2682    10593    3                   END ; /* THEN DO */

  10593  2 000264   000272 710000 2                  TRA     s:10595

     2683    10594    2                 ELSE FMT_VEC(10) = VECTOR(BUF$->VLA$INPUT.PNUM) ;

  10594  2 000265   177640 235007                    LDA     65440,DL
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:429  
         2 000266   200005 236100                    LDQ     BUF$,,AUTO
         2 000267   000003 036003                    ADLQ    3,DU
         2 000270   200071 755100                    STA     FMT_VEC+20,,AUTO
         2 000271   200072 756100                    STQ     FMT_VEC+21,,AUTO

     2684    10595    2               FMT_VEC(11) = VECTOR(BUF$->VLA$INPUT.JNAME) ;

  10595  2 000272   000027 235000 3                  LDA     23
         2 000273   200005 236100                    LDQ     BUF$,,AUTO
         2 000274   000021 036003                    ADLQ    17,DU
         2 000275   200073 755100                    STA     FMT_VEC+22,,AUTO
         2 000276   200074 756100                    STQ     FMT_VEC+23,,AUTO

     2685    10596    2               F_FDS.NVECS# = 12 ;

  10596  2 000277   000014 235007                    LDA     12,DL
         2 000300   200020 755100                    STA     F_FDS+9,,AUTO
         2 000301   001375 710000 2                  TRA     s:10832

     2686    10597
     2687    10598    2             CASE(%CP_OUTPUT_MESS) ;

     2688    10599    2               IF (BUF$->VLA$OUTPUT.DEVNAME = ' ')

  10599  2 000302   200005 473500                    LDP3    BUF$,,AUTO
         2 000303   300010 720100                    LXL0    8,,PR3
         2 000304   040040 100003                    CMPX0   16416,DU
         2 000305   000351 601000 2                  TNZ     s:10615

     2689    10600    2                 THEN
     2690    10601    3                   DO ;                                  /* Waiting to output. */

     2691    10602    3                       IF BUF$ -> VLA$OUTPUT.SYSID < 99 AND

  10602  2 000306   300005 221100                    LDX1    5,,PR3
         2 000307   000143 101003                    CMPX1   99,DU
         2 000310   000320 603000 2                  TRC     s:10605
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:430  
         2 000311   300005 722100                    LXL2    5,,PR3
         2 000312   000144 102003                    CMPX2   100,DU
         2 000313   000320 602000 2                  TNC     s:10605

     2692    10603    3                           BUF$ -> VLA$OUTPUT.NUM > 99
     2693    10604    3                         THEN F_FDS.FMT_ = VECTOR(OUTPUT_WAIT_MESS_FMT2) ;

  10604  2 000314   000030 237000 3                  LDAQ    24
         2 000315   200007 755100                    STA     F_FDS,,AUTO
         2 000316   200010 756100                    STQ     F_FDS+1,,AUTO
         2 000317   000323 710000 2                  TRA     s:10606

     2694    10605    3                         ELSE F_FDS.FMT_ = VECTOR(OUTPUT_WAIT_MESS_FMT) ;

  10605  2 000320   000032 237000 3                  LDAQ    26
         2 000321   200007 755100                    STA     F_FDS,,AUTO
         2 000322   200010 756100                    STQ     F_FDS+1,,AUTO

     2695    10606    3                       NUM_AHEAD = BUF$ -> VLA$OUTPUT.AHEAD ;

  10606  2 000323   300023 236100                    LDQ     19,,PR3
         2 000324   000022 772000                    QRL     18
         2 000325   200365 756100                    STQ     NUM_AHEAD,,AUTO

     2696    10607    3                       FMT_VEC(0) = VECTOR(NUM_AHEAD) ;

  10607  2 000326   777640 235007                    LDA     -96,DL
         2 000327   200520 452500                    STP2    @START+2,,AUTO
         2 000330   200520 236100                    LDQ     @START+2,,AUTO
         2 000331   000365 036003                    ADLQ    245,DU
         2 000332   200045 755100                    STA     FMT_VEC,,AUTO
         2 000333   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2697    10608    3                       IF (BUF$ -> VLA$OUTPUT.FLG.DEVAVAIL)

  10608  2 000334   300004 236100                    LDQ     4,,PR3
         2 000335   040000 316003                    CANQ    16384,DU
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:431  
         2 000336   000343 600000 2                  TZE     s:10610

     2698    10609    3                         THEN FMT_VEC(1) = VECTOR(AHEAD_HDR) ;

  10609  2 000337   000034 237000 3                  LDAQ    28
         2 000340   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 000341   200050 756100                    STQ     FMT_VEC+3,,AUTO
         2 000342   000346 710000 2                  TRA     s:10611

     2699    10610    3                         ELSE FMT_VEC(1) = VECTOR(NODEV_HDR2) ;

  10610  2 000343   000036 237000 3                  LDAQ    30
         2 000344   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 000345   200050 756100                    STQ     FMT_VEC+3,,AUTO

     2700    10611    3                       I = 1 ;

  10611  2 000346   000001 235007                    LDA     1,DL
         2 000347   200343 755100                    STA     I,,AUTO

     2701    10612    3                   END ; /* THEN DO */

  10612  2 000350   000375 710000 2                  TRA     s:10622

     2702    10613    2                 ELSE                                    /* Being output.*/
     2703    10614    3                   DO ;

     2704    10615    3                       IF BUF$ -> VLA$OUTPUT.SYSID < 99 AND

  10615  2 000351   300005 221100                    LDX1    5,,PR3
         2 000352   000143 101003                    CMPX1   99,DU
         2 000353   000363 603000 2                  TRC     s:10618
         2 000354   300005 722100                    LXL2    5,,PR3
         2 000355   000144 102003                    CMPX2   100,DU
         2 000356   000363 602000 2                  TNC     s:10618

     2705    10616    3                           BUF$ -> VLA$OUTPUT.NUM > 99
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:432  
     2706    10617    3                         THEN F_FDS.FMT_ = VECTOR(OUTPUT_NOWAIT_MESS_FMT2) ;

  10617  2 000357   000040 237000 3                  LDAQ    32
         2 000360   200007 755100                    STA     F_FDS,,AUTO
         2 000361   200010 756100                    STQ     F_FDS+1,,AUTO
         2 000362   000366 710000 2                  TRA     s:10619

     2707    10618    3                         ELSE F_FDS.FMT_ = VECTOR(OUTPUT_NOWAIT_MESS_FMT) ;

  10618  2 000363   000042 237000 3                  LDAQ    34
         2 000364   200007 755100                    STA     F_FDS,,AUTO
         2 000365   200010 756100                    STQ     F_FDS+1,,AUTO

     2708    10619    3                       I = 0 ;

  10619  2 000366   200343 450100                    STZ     I,,AUTO

     2709    10620    3                       CALL GET_OUTPUT_TYPE(I,OUT_TYPE_ARRY) ;

  10620  2 000367   000044 236000 3                  LDQ     36
         2 000370   200510 756100                    STQ     @MASK+1,,AUTO
         2 000371   200343 634500                    EPPR4   I,,AUTO
         2 000372   200507 454500                    STP4    FPT_STATE+9,,AUTO
         2 000373   001534 701000 2                  TSX1    GET_OUTPUT_TYPE
         2 000374   000000 011000                    NOP     0

     2710    10621    3                   END ; /* ELSE DO */

     2711    10622    2               FMT_VEC(I+1) = VECTOR(BUF$->VLA$OUTPUT.SYSID) ;

  10622  2 000375   200343 235100                    LDA     I,,AUTO
         2 000376   000001 735000                    ALS     1
         2 000377   000000 620005                    EAX0    0,AL
         2 000400   377640 235007                    LDA     130976,DL
         2 000401   200005 236100                    LDQ     BUF$,,AUTO
         2 000402   000005 036003                    ADLQ    5,DU
         2 000403   200047 755110                    STA     FMT_VEC+2,X0,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:433  
         2 000404   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     2712    10623    2               FMT_VEC(I+2) = VECTOR(BUF$->VLA$OUTPUT.NUM) ;

  10623  2 000405   200343 235100                    LDA     I,,AUTO
         2 000406   000001 735000                    ALS     1
         2 000407   000000 620005                    EAX0    0,AL
         2 000410   377640 235007                    LDA     130976,DL
         2 000411   200005 236100                    LDQ     BUF$,,AUTO
         2 000412   000045 036000 3                  ADLQ    37
         2 000413   200051 755110                    STA     FMT_VEC+4,X0,AUTO
         2 000414   200052 756110                    STQ     FMT_VEC+5,X0,AUTO

     2713    10624    2               FMT_VEC(I+3) = VECTOR(BUF$->VLA$OUTPUT.ACCT);

  10624  2 000415   200343 235100                    LDA     I,,AUTO
         2 000416   000001 735000                    ALS     1
         2 000417   000000 620005                    EAX0    0,AL
         2 000420   000011 235000 3                  LDA     9
         2 000421   200005 236100                    LDQ     BUF$,,AUTO
         2 000422   000011 036003                    ADLQ    9,DU
         2 000423   200053 755110                    STA     FMT_VEC+6,X0,AUTO
         2 000424   200054 756110                    STQ     FMT_VEC+7,X0,AUTO

     2714    10625    2               FMT_VEC(I+4) = VECTOR(BUF$->VLA$OUTPUT.PRIO) ;

  10625  2 000425   200343 235100                    LDA     I,,AUTO
         2 000426   000001 735000                    ALS     1
         2 000427   000000 620005                    EAX0    0,AL
         2 000430   177640 235007                    LDA     65440,DL
         2 000431   200005 236100                    LDQ     BUF$,,AUTO
         2 000432   000046 036000 3                  ADLQ    38
         2 000433   200055 755110                    STA     FMT_VEC+8,X0,AUTO
         2 000434   200056 756110                    STQ     FMT_VEC+9,X0,AUTO

     2715    10626    2               FMT_VEC(I+5) = VECTOR(BUF$->VLA$OUTPUT.COPIES) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:434  
  10626  2 000435   200343 235100                    LDA     I,,AUTO
         2 000436   000001 735000                    ALS     1
         2 000437   000000 620005                    EAX0    0,AL
         2 000440   177640 235007                    LDA     65440,DL
         2 000441   200005 236100                    LDQ     BUF$,,AUTO
         2 000442   000047 036000 3                  ADLQ    39
         2 000443   200057 755110                    STA     FMT_VEC+10,X0,AUTO
         2 000444   200060 756110                    STQ     FMT_VEC+11,X0,AUTO

     2716    10627    2               IF BUF$->VLA$OUTPUT.FLG.SAP

  10627  2 000445   200005 470500                    LDP0    BUF$,,AUTO
         2 000446   000004 236100                    LDQ     4,,PR0
         2 000447   200000 316003                    CANQ    65536,DU
         2 000450   000461 600000 2                  TZE     s:10631

     2717    10628    2                 THEN
     2718    10629    2                   FMT_VEC(I+6) = VECTOR(H_CHAR) ;

  10629  2 000451   200343 235100                    LDA     I,,AUTO
         2 000452   000001 735000                    ALS     1
         2 000453   000000 620005                    EAX0    0,AL
         2 000454   000000 621005                    EAX1    0,AL
         2 000455   000050 237000 3                  LDAQ    40
         2 000456   200061 755110                    STA     FMT_VEC+12,X0,AUTO
         2 000457   200062 756111                    STQ     FMT_VEC+13,X1,AUTO
         2 000460   000470 710000 2                  TRA     s:10632

     2719    10630    2                 ELSE
     2720    10631    2                   FMT_VEC(I+6) = VECTOR(BLANK_CHAR) ;

  10631  2 000461   200343 235100                    LDA     I,,AUTO
         2 000462   000001 735000                    ALS     1
         2 000463   000000 620005                    EAX0    0,AL
         2 000464   000000 621005                    EAX1    0,AL
         2 000465   000014 237000 3                  LDAQ    12
         2 000466   200061 755110                    STA     FMT_VEC+12,X0,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:435  
         2 000467   200062 756111                    STQ     FMT_VEC+13,X1,AUTO

     2721    10632    2               FMT_VEC(I+7) = VECTOR(BUF$->VLA$OUTPUT.SAPCOPIES) ;

  10632  2 000470   200343 235100                    LDA     I,,AUTO
         2 000471   000001 735000                    ALS     1
         2 000472   000000 620005                    EAX0    0,AL
         2 000473   177640 235007                    LDA     65440,DL
         2 000474   200005 236100                    LDQ     BUF$,,AUTO
         2 000475   000003 036003                    ADLQ    3,DU
         2 000476   200063 755110                    STA     FMT_VEC+14,X0,AUTO
         2 000477   200064 756110                    STQ     FMT_VEC+15,X0,AUTO

     2722    10633    2               FMT_VEC(I+8) = VECTOR(BUF$->VLA$OUTPUT.GRANS) ;

  10633  2 000500   200343 235100                    LDA     I,,AUTO
         2 000501   000001 735000                    ALS     1
         2 000502   000000 620005                    EAX0    0,AL
         2 000503   377640 235007                    LDA     130976,DL
         2 000504   200005 236100                    LDQ     BUF$,,AUTO
         2 000505   000010 036000 3                  ADLQ    8
         2 000506   200065 755110                    STA     FMT_VEC+16,X0,AUTO
         2 000507   200066 756110                    STQ     FMT_VEC+17,X0,AUTO

     2723    10634    2               FMT_VEC(I+9) = VECTOR(BUF$->VLA$OUTPUT.FORM) ;

  10634  2 000510   200343 235100                    LDA     I,,AUTO
         2 000511   000001 735000                    ALS     1
         2 000512   000000 620005                    EAX0    0,AL
         2 000513   000052 235000 3                  LDA     42
         2 000514   200005 236100                    LDQ     BUF$,,AUTO
         2 000515   000007 036003                    ADLQ    7,DU
         2 000516   200067 755110                    STA     FMT_VEC+18,X0,AUTO
         2 000517   200070 756110                    STQ     FMT_VEC+19,X0,AUTO

     2724    10635    2               IF BUF$->VLA$OUTPUT.DEVNAME = ' '

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:436  
  10635  2 000520   000010 720100                    LXL0    8,,PR0
         2 000521   040040 100003                    CMPX0   16416,DU
         2 000522   000534 601000 2                  TNZ     s:10639

     2725    10636    2                 THEN
     2726    10637    2                   FMT_VEC(I+10) = VECTOR(BUF$->VLA$OUTPUT.WOD) ;

  10637  2 000523   200343 235100                    LDA     I,,AUTO
         2 000524   000001 735000                    ALS     1
         2 000525   000000 621005                    EAX1    0,AL
         2 000526   000011 235000 3                  LDA     9
         2 000527   200005 236100                    LDQ     BUF$,,AUTO
         2 000530   000025 036003                    ADLQ    21,DU
         2 000531   200071 755111                    STA     FMT_VEC+20,X1,AUTO
         2 000532   200072 756111                    STQ     FMT_VEC+21,X1,AUTO
         2 000533   000543 710000 2                  TRA     s:10640

     2727    10638    2                 ELSE
     2728    10639    2                   FMT_VEC(I+10) = VECTOR(BUF$->VLA$OUTPUT.TNAME) ;

  10639  2 000534   200343 235100                    LDA     I,,AUTO
         2 000535   000001 735000                    ALS     1
         2 000536   000000 621005                    EAX1    0,AL
         2 000537   000011 235000 3                  LDA     9
         2 000540   200005 236100                    LDQ     BUF$,,AUTO
         2 000541   200071 755111                    STA     FMT_VEC+20,X1,AUTO
         2 000542   200072 756111                    STQ     FMT_VEC+21,X1,AUTO

     2729    10640    2               FMT_VEC(I+11) = VECTOR(BUF$->VLA$OUTPUT.DEVTYP) ;

  10640  2 000543   200343 235100                    LDA     I,,AUTO
         2 000544   000001 735000                    ALS     1
         2 000545   000000 620005                    EAX0    0,AL
         2 000546   377640 235007                    LDA     130976,DL
         2 000547   200005 236100                    LDQ     BUF$,,AUTO
         2 000550   000002 036003                    ADLQ    2,DU
         2 000551   200073 755110                    STA     FMT_VEC+22,X0,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:437  
         2 000552   200074 756110                    STQ     FMT_VEC+23,X0,AUTO

     2730    10641    2               FMT_VEC(I+12) = VECTOR(BUF$->VLA$OUTPUT.DEVNAME) ;

  10641  2 000553   200343 235100                    LDA     I,,AUTO
         2 000554   000001 735000                    ALS     1
         2 000555   000000 620005                    EAX0    0,AL
         2 000556   377640 235007                    LDA     130976,DL
         2 000557   200005 236100                    LDQ     BUF$,,AUTO
         2 000560   000053 036000 3                  ADLQ    43
         2 000561   200075 755110                    STA     FMT_VEC+24,X0,AUTO
         2 000562   200076 756110                    STQ     FMT_VEC+25,X0,AUTO

     2731    10642    2               FMT_VEC(I+13) = VECTOR(BUF$->VLA$OUTPUT.JNAME) ;

  10642  2 000563   200343 235100                    LDA     I,,AUTO
         2 000564   000001 735000                    ALS     1
         2 000565   000000 620005                    EAX0    0,AL
         2 000566   000027 235000 3                  LDA     23
         2 000567   200005 236100                    LDQ     BUF$,,AUTO
         2 000570   000013 036003                    ADLQ    11,DU
         2 000571   200077 755110                    STA     FMT_VEC+26,X0,AUTO
         2 000572   200100 756110                    STQ     FMT_VEC+27,X0,AUTO

     2732    10643    2               F_FDS.NVECS# = I + 13 + 1 ;

  10643  2 000573   200343 235100                    LDA     I,,AUTO
         2 000574   000016 035007                    ADLA    14,DL
         2 000575   200020 755100                    STA     F_FDS+9,,AUTO
         2 000576   001375 710000 2                  TRA     s:10832

     2733    10644
     2734    10645    2             CASE( %CP_SYSID_RUN_MESS,

     2735    10646    2                   %CP_SYSID_FOLL_MESS,
     2736    10647    2                   %CP_SYSID_RUNAFTER_MESS,
     2737    10648    2                   %CP_SYSID_WPART_MESS,
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:438  
     2738    10649    2                   %CP_SYSID_OTHER_MESS,
     2739    10650    2                   %CP_SYSID_WPS_MESS,
     2740    10651    2                   %CP_SYSID_WAIT_MESS) ;
     2741    10652    2               CALL OUTPUT_SYSID_IN_AND_RUN ;

  10652  2 000577   002330 701000 2                  TSX1    OUTPUT_SYSID_IN_AND_RUN
         2 000600   000000 011000                    NOP     0
         2 000601   001375 710000 2                  TRA     s:10832

     2742    10653
     2743    10654    2             CASE(%CP_SYSID_OQ_MESS) ;

     2744    10655    2               CALL OUTPUT_SYSID_OQ ;

  10655  2 000602   002656 701000 2                  TSX1    OUTPUT_SYSID_OQ
         2 000603   000000 011000                    NOP     0
         2 000604   001375 710000 2                  TRA     s:10832

     2745    10656
     2746    10657    2             CASE(%CP_INPUT_HDR) ;

     2747    10658    2               F_FDS.FMT_ = VECTOR(INPUT_HDR_FMT) ;

  10658  2 000605   000054 237000 3                  LDAQ    44
         2 000606   200007 755100                    STA     F_FDS,,AUTO
         2 000607   200010 756100                    STQ     F_FDS+1,,AUTO

     2748    10659    2               FMT_VEC(0) = VECTOR(INPUT_HDR) ;

  10659  2 000610   000056 237000 3                  LDAQ    46
         2 000611   200045 755100                    STA     FMT_VEC,,AUTO
         2 000612   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2749    10660    2               F_FDS.NVECS# = 1 ;

  10660  2 000613   000001 235007                    LDA     1,DL
         2 000614   200020 755100                    STA     F_FDS+9,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:439  
         2 000615   001375 710000 2                  TRA     s:10832

     2750    10661
     2751    10662    2             CASE(%CP_RUN_HDR) ;

     2752    10663    2               F_FDS.FMT_ = VECTOR(INPUT_HDR_FMT) ;

  10663  2 000616   000054 237000 3                  LDAQ    44
         2 000617   200007 755100                    STA     F_FDS,,AUTO
         2 000620   200010 756100                    STQ     F_FDS+1,,AUTO

     2753    10664    2               FMT_VEC(0) = VECTOR(RUN_HDR) ;

  10664  2 000621   000060 237000 3                  LDAQ    48
         2 000622   200045 755100                    STA     FMT_VEC,,AUTO
         2 000623   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2754    10665    2               F_FDS.NVECS# = 1 ;

  10665  2 000624   000001 235007                    LDA     1,DL
         2 000625   200020 755100                    STA     F_FDS+9,,AUTO
         2 000626   001375 710000 2                  TRA     s:10832

     2755    10666
     2756    10667    2             CASE(%CP_DFLT_OUTPUT_HDR) ;

     2757    10668    2               F_FDS.FMT_ = VECTOR(DFLT_OUTPUT_HDR_FMT) ;

  10668  2 000627   000062 237000 3                  LDAQ    50
         2 000630   200007 755100                    STA     F_FDS,,AUTO
         2 000631   200010 756100                    STQ     F_FDS+1,,AUTO

     2758    10669    2               FMT_VEC(0) = VECTOR(DFLT_OUTPUT_HDR) ;

  10669  2 000632   000064 237000 3                  LDAQ    52
         2 000633   200045 755100                    STA     FMT_VEC,,AUTO
         2 000634   200046 756100                    STQ     FMT_VEC+1,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:440  

     2759    10670    2               F_FDS.NVECS# = 1 ;

  10670  2 000635   000001 235007                    LDA     1,DL
         2 000636   200020 755100                    STA     F_FDS+9,,AUTO
         2 000637   001375 710000 2                  TRA     s:10832

     2760    10671
     2761    10672    2             CASE(%CP_NUM_LISTED) ;

     2762    10673    2               F_FDS.FMT_ = VECTOR(NUM_LISTED_HDR_FMT) ;

  10673  2 000640   000066 237000 3                  LDAQ    54
         2 000641   200007 755100                    STA     F_FDS,,AUTO
         2 000642   200010 756100                    STQ     F_FDS+1,,AUTO

     2763    10674    2               I = CH_XFORMAT.NUM# ;

  10674  2 000643   100014 235100                    LDA     12,,PR1
         2 000644   200343 755100                    STA     I,,AUTO

     2764    10675    2               FMT_VEC(0) = VECTOR(I) ;

  10675  2 000645   777640 235007                    LDA     -96,DL
         2 000646   200520 452500                    STP2    @START+2,,AUTO
         2 000647   200520 236100                    LDQ     @START+2,,AUTO
         2 000650   000343 036003                    ADLQ    227,DU
         2 000651   200045 755100                    STA     FMT_VEC,,AUTO
         2 000652   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2765    10676    2               FMT_VEC(1) = VECTOR(NUM_LISTED_MESS) ;

  10676  2 000653   000070 237000 3                  LDAQ    56
         2 000654   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 000655   200050 756100                    STQ     FMT_VEC+3,,AUTO

     2766    10677    2               F_FDS.NVECS# = 2 ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:441  

  10677  2 000656   000002 235007                    LDA     2,DL
         2 000657   200020 755100                    STA     F_FDS+9,,AUTO
         2 000660   001375 710000 2                  TRA     s:10832

     2767    10678
     2768    10679    2             CASE(%CP_NONE_IN_MESS) ;

     2769    10680    2               F_FDS.FMT_ = VECTOR(NONE_IN_MESS_FMT) ;

  10680  2 000661   000072 237000 3                  LDAQ    58
         2 000662   200007 755100                    STA     F_FDS,,AUTO
         2 000663   200010 756100                    STQ     F_FDS+1,,AUTO

     2770    10681    2               F_FDS.NVECS# = 0 ;

  10681  2 000664   200020 450100                    STZ     F_FDS+9,,AUTO
         2 000665   001375 710000 2                  TRA     s:10832

     2771    10682
     2772    10683    2             CASE(%CP_NONE_RUN_MESS) ;

     2773    10684    2               F_FDS.FMT_ = VECTOR(NONE_RUN_MESS_FMT) ;

  10684  2 000666   000074 237000 3                  LDAQ    60
         2 000667   200007 755100                    STA     F_FDS,,AUTO
         2 000670   200010 756100                    STQ     F_FDS+1,,AUTO

     2774    10685    2               F_FDS.NVECS# = 0 ;

  10685  2 000671   200020 450100                    STZ     F_FDS+9,,AUTO
         2 000672   001375 710000 2                  TRA     s:10832

     2775    10686
     2776    10687    2             CASE(%CP_NONE_OUT_MESS) ;

     2777    10688    2               F_FDS.FMT_ = VECTOR(NONE_OUT_MESS_FMT) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:442  

  10688  2 000673   000076 237000 3                  LDAQ    62
         2 000674   200007 755100                    STA     F_FDS,,AUTO
         2 000675   200010 756100                    STQ     F_FDS+1,,AUTO

     2778    10689    2               F_FDS.NVECS# = 0 ;

  10689  2 000676   200020 450100                    STZ     F_FDS+9,,AUTO
         2 000677   001375 710000 2                  TRA     s:10832

     2779    10690
     2780    10691    2             CASE(%CP_NONE_MESS) ;

     2781    10692    2               F_FDS.FMT_ = VECTOR(NONE_MESS_FMT) ;

  10692  2 000700   000100 237000 3                  LDAQ    64
         2 000701   200007 755100                    STA     F_FDS,,AUTO
         2 000702   200010 756100                    STQ     F_FDS+1,,AUTO

     2782    10693    2               F_FDS.NVECS# = 0 ;

  10693  2 000703   200020 450100                    STZ     F_FDS+9,,AUTO
         2 000704   001375 710000 2                  TRA     s:10832

     2783    10694
     2784    10695    2             CASE(%CP_NOTF_MESS) ;

     2785    10696    2               I = 0 ;

  10696  2 000705   200343 450100                    STZ     I,,AUTO

     2786    10697    2               II = 4 ;

  10697  2 000706   000004 235007                    LDA     4,DL
         2 000707   200344 755100                    STA     II,,AUTO

     2787    10698    2               FMT_BUF = 'Job' ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:443  

  10698  2 000710   040100 100400                    MLR     fill='040'O
         2 000711   001400 000003 1                  ADSC9   DEV_TYPES+5              cn=0,n=3
         2 000712   200374 000120                    ADSC9   FMT_BUF,,AUTO            cn=0,n=80

     2788    10699    2               IF CH_XFORMAT.SYSID# ~= 0

  10699  2 000713   100001 235100                    LDA     1,,PR1
         2 000714   000765 600000 2                  TZE     s:10717

     2789    10700    2                 THEN
     2790    10701    3                   DO ;                                  /* SYSID specified. */

     2791    10702    3                     CALL INSERT(FMT_BUF,II,4,'%<>D') ;

  10702  2 000715   200344 235100                    LDA     II,,AUTO
         2 000716   040105 100400                    MLR     fill='040'O
         2 000717   001401 000004 1                  ADSC9   DEV_TYPES+6              cn=0,n=4
         2 000720   200374 000004                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=4

     2792    10703    3                     II = II + 4 ;

  10703  2 000721   000004 035007                    ADLA    4,DL
         2 000722   200344 755100                    STA     II,,AUTO

     2793    10704    3                     FMT_VEC(I) = VECTOR(CH_XFORMAT.SYSID#) ;

  10704  2 000723   200343 235100                    LDA     I,,AUTO
         2 000724   000001 735000                    ALS     1
         2 000725   000000 620005                    EAX0    0,AL
         2 000726   777640 235007                    LDA     -96,DL
         2 000727   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 000730   000001 036003                    ADLQ    1,DU
         2 000731   200045 755110                    STA     FMT_VEC,X0,AUTO
         2 000732   200046 756110                    STQ     FMT_VEC+1,X0,AUTO

     2794    10705    3                     I = I + 1 ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:444  

  10705  2 000733   200343 235100                    LDA     I,,AUTO
         2 000734   000001 035007                    ADLA    1,DL
         2 000735   200343 755100                    STA     I,,AUTO

     2795    10706    3                     IF CH_XFORMAT.NUM# ~= 0

  10706  2 000736   100014 235100                    LDA     12,,PR1
         2 000737   000762 600000 2                  TZE     s:10715

     2796    10707    3                       THEN
     2797    10708    4                         DO ;                                  /* NUM specified. */

     2798    10709    4                           CALL INSERT(FMT_BUF,II,6,'-%<>D') ;

  10709  2 000740   200344 236100                    LDQ     II,,AUTO
         2 000741   040106 100400                    MLR     fill='040'O
         2 000742   001402 000005 1                  ADSC9   DEV_TYPES+7              cn=0,n=5
         2 000743   200374 000006                    ADSC9   FMT_BUF,Q,AUTO           cn=0,n=6

     2799    10710    4                           II = II + 6 ;

  10710  2 000744   000006 036007                    ADLQ    6,DL
         2 000745   200344 756100                    STQ     II,,AUTO

     2800    10711    4                           FMT_VEC(I) = VECTOR(CH_XFORMAT.NUM#) ;

  10711  2 000746   200343 235100                    LDA     I,,AUTO
         2 000747   000001 735000                    ALS     1
         2 000750   000000 620005                    EAX0    0,AL
         2 000751   777640 235007                    LDA     -96,DL
         2 000752   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 000753   000014 036003                    ADLQ    12,DU
         2 000754   200045 755110                    STA     FMT_VEC,X0,AUTO
         2 000755   200046 756110                    STQ     FMT_VEC+1,X0,AUTO

     2801    10712    4                           I = I + 1 ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:445  

  10712  2 000756   200343 235100                    LDA     I,,AUTO
         2 000757   000001 035007                    ADLA    1,DL
         2 000760   200343 755100                    STA     I,,AUTO

     2802    10713    4                         END ; /* THEN DO */

  10713  2 000761   000765 710000 2                  TRA     s:10717

     2803    10714    3                       ELSE
     2804    10715    3                         II = II + 1;  /* Insert a blank. */

  10715  2 000762   200344 236100                    LDQ     II,,AUTO
         2 000763   000001 036007                    ADLQ    1,DL
         2 000764   200344 756100                    STQ     II,,AUTO

     2805    10716    3                   END ; /* THEN DO */

     2806    10717    2               IF CH_XFORMAT.JOBNAME# ~= ' '

  10717  2 000765   040000 106500                    CMPC    fill='040'O
         2 000766   100004 000037                    ADSC9   4,,PR1                   cn=0,n=31
         2 000767   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000770   001012 600000 2                  TZE     s:10725

     2807    10718    2                 THEN
     2808    10719    3                   DO ;                                  /* JOBNAME specified. */

     2809    10720    3                     CALL INSERT(FMT_BUF,II,5,'%<>A.') ;

  10720  2 000771   200344 235100                    LDA     II,,AUTO
         2 000772   040105 100400                    MLR     fill='040'O
         2 000773   001404 000005 1                  ADSC9   DEV_TYPES+9              cn=0,n=5
         2 000774   200374 000005                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=5

     2810    10721    3                     II = II + 5 ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:446  
  10721  2 000775   000005 035007                    ADLA    5,DL
         2 000776   200344 755100                    STA     II,,AUTO

     2811    10722    3                     FMT_VEC(I) = VECTOR(CH_XFORMAT.JOBNAME#) ;

  10722  2 000777   200343 236100                    LDQ     I,,AUTO
         2 001000   000001 736000                    QLS     1
         2 001001   000027 235000 3                  LDA     23
         2 001002   000000 620006                    EAX0    0,QL
         2 001003   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001004   000004 036003                    ADLQ    4,DU
         2 001005   200045 755110                    STA     FMT_VEC,X0,AUTO
         2 001006   200046 756110                    STQ     FMT_VEC+1,X0,AUTO

     2812    10723    3                     I = I + 1 ;

  10723  2 001007   200343 235100                    LDA     I,,AUTO
         2 001010   000001 035007                    ADLA    1,DL
         2 001011   200343 755100                    STA     I,,AUTO

     2813    10724    3                   END ; /* THEN DO */

     2814    10725    2               IF CH_XFORMAT.ACCT# ~= ' '

  10725  2 001012   040000 106500                    CMPC    fill='040'O
         2 001013   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         2 001014   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001015   001050 600000 2                  TZE     s:10739

     2815    10726    2                 THEN
     2816    10727    3                   DO ;                                  /* ACCT specified. */

     2817    10728    3                     IF SUBSTR(FMT_BUF,II-1,1) ~= '.'

  10728  2 001016   200344 235100                    LDA     II,,AUTO
         2 001017   040000 106505                    CMPC    fill='040'O
         2 001020   200373 600001                    ADSC9   RECNO_+1,A,AUTO          cn=3,n=1
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:447  
         2 001021   000025 000001 3                  ADSC9   21                       cn=0,n=1
         2 001022   001030 600000 2                  TZE     s:10734

     2818    10729    3                       THEN
     2819    10730    4                         DO ;                            /* No JOBNAME */

     2820    10731    4                           CALL INSERT(FMT_BUF,II,1,'.') ;

  10731  2 001023   040105 100400                    MLR     fill='040'O
         2 001024   000025 000001 3                  ADSC9   21                       cn=0,n=1
         2 001025   200374 000001                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=1

     2821    10732    4                           II = II + 1 ;

  10732  2 001026   000001 035007                    ADLA    1,DL
         2 001027   200344 755100                    STA     II,,AUTO

     2822    10733    4                         END ; /* THEN DO */

     2823    10734    3                     CALL INSERT(FMT_BUF,II,5,'%<>A') ;

  10734  2 001030   040105 100400                    MLR     fill='040'O
         2 001031   001404 000004 1                  ADSC9   DEV_TYPES+9              cn=0,n=4
         2 001032   200374 000005                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=5

     2824    10735    3                     II = II + 5 ;

  10735  2 001033   000005 035007                    ADLA    5,DL
         2 001034   200344 755100                    STA     II,,AUTO

     2825    10736    3                     FMT_VEC(I) = VECTOR(CH_XFORMAT.ACCT#) ;

  10736  2 001035   200343 236100                    LDQ     I,,AUTO
         2 001036   000001 736000                    QLS     1
         2 001037   000011 235000 3                  LDA     9
         2 001040   000000 620006                    EAX0    0,QL
         2 001041   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:448  
         2 001042   000002 036003                    ADLQ    2,DU
         2 001043   200045 755110                    STA     FMT_VEC,X0,AUTO
         2 001044   200046 756110                    STQ     FMT_VEC+1,X0,AUTO

     2826    10737    3                     I = I + 1 ;

  10737  2 001045   200343 235100                    LDA     I,,AUTO
         2 001046   000001 035007                    ADLA    1,DL
         2 001047   200343 755100                    STA     I,,AUTO

     2827    10738    3                   END ; /* THEN DO */

     2828    10739    2               IF SUBSTR(FMT_BUF,II-1,1) ~= ' '

  10739  2 001050   200344 235100                    LDA     II,,AUTO
         2 001051   040000 106505                    CMPC    fill='040'O
         2 001052   200373 600001                    ADSC9   RECNO_+1,A,AUTO          cn=3,n=1
         2 001053   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001054   001057 600000 2                  TZE     s:10741

     2829    10740    2                 THEN II = II + 1 ;    /* Add a blank */

  10740  2 001055   000001 035007                    ADLA    1,DL
         2 001056   200344 755100                    STA     II,,AUTO

     2830    10741    2               CALL INSERT(FMT_BUF,II,14,'was not found.') ;

  10741  2 001057   040105 100400                    MLR     fill='040'O
         2 001060   001406 000016 1                  ADSC9   DEV_TYPES+11             cn=0,n=14
         2 001061   200374 000016                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=14

     2831    10742    2               II = II + 14 ;

  10742  2 001062   000016 035007                    ADLA    14,DL
         2 001063   200344 755100                    STA     II,,AUTO

     2832    10743    2               F_FDS.NVECS# = I ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:449  

  10743  2 001064   200343 236100                    LDQ     I,,AUTO
         2 001065   200020 756100                    STQ     F_FDS+9,,AUTO

     2833    10744    2               F_FDS.FMT_ = VECTOR(FMT_BUF) ;

  10744  2 001066   000102 235000 3                  LDA     66
         2 001067   200520 452500                    STP2    @START+2,,AUTO
         2 001070   200520 236100                    LDQ     @START+2,,AUTO
         2 001071   000374 036003                    ADLQ    252,DU
         2 001072   200007 755100                    STA     F_FDS,,AUTO
         2 001073   200010 756100                    STQ     F_FDS+1,,AUTO
         2 001074   001375 710000 2                  TRA     s:10832

     2834    10745
     2835    10746    2             CASE(%CP_APRESCAN_MESS) ;

     2836    10747    2               I = 0 ;

  10747  2 001075   200343 450100                    STZ     I,,AUTO

     2837    10748    2               IF (CH_XFORMAT.SYSID# ~= 0)

  10748  2 001076   100001 235100                    LDA     1,,PR1
         2 001077   001113 600000 2                  TZE     s:10755

     2838    10749    2                 THEN
     2839    10750    3                   DO ;                          /* SYSID */

     2840    10751    3                     F_FDS.FMT_ = VECTOR(APRESCAN_FMT2) ;

  10751  2 001100   000104 237000 3                  LDAQ    68
         2 001101   200007 755100                    STA     F_FDS,,AUTO
         2 001102   200010 756100                    STQ     F_FDS+1,,AUTO

     2841    10752    3                     FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:450  
  10752  2 001103   777640 235007                    LDA     -96,DL
         2 001104   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001105   000001 036003                    ADLQ    1,DU
         2 001106   200045 755100                    STA     FMT_VEC,,AUTO
         2 001107   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2842    10753    3                     I = 1 ;

  10753  2 001110   000001 235007                    LDA     1,DL
         2 001111   200343 755100                    STA     I,,AUTO

     2843    10754    3                   END ; /* THEN DO */

  10754  2 001112   001116 710000 2                  TRA     s:10756

     2844    10755    2                 ELSE F_FDS.FMT_ = VECTOR(APRESCAN_FMT1) ;   /* No SYSID */

  10755  2 001113   000106 237000 3                  LDAQ    70
         2 001114   200007 755100                    STA     F_FDS,,AUTO
         2 001115   200010 756100                    STQ     F_FDS+1,,AUTO

     2845    10756    2                 FMT_VEC(I) = VECTOR(CH_XFORMAT.JOBNAME#) ;

  10756  2 001116   200343 235100                    LDA     I,,AUTO
         2 001117   000001 735000                    ALS     1
         2 001120   000000 620005                    EAX0    0,AL
         2 001121   000027 235000 3                  LDA     23
         2 001122   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001123   000004 036003                    ADLQ    4,DU
         2 001124   200045 755110                    STA     FMT_VEC,X0,AUTO
         2 001125   200046 756110                    STQ     FMT_VEC+1,X0,AUTO

     2846    10757    2                 F_FDS.NVECS# = I + 1 ;

  10757  2 001126   200343 235100                    LDA     I,,AUTO
         2 001127   000001 035007                    ADLA    1,DL
         2 001130   200020 755100                    STA     F_FDS+9,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:451  
         2 001131   001375 710000 2                  TRA     s:10832

     2847    10758
     2848    10759    2             CASE(%CP_COMPLETED_MESS) ;

     2849    10760    2               I = 0 ;

  10760  2 001132   200343 450100                    STZ     I,,AUTO

     2850    10761    2               IF (CH_XFORMAT.SYSID# ~= 0)

  10761  2 001133   100001 235100                    LDA     1,,PR1
         2 001134   001150 600000 2                  TZE     s:10768

     2851    10762    2                 THEN
     2852    10763    3                   DO ;                          /* SYSID */

     2853    10764    3                     F_FDS.FMT_ = VECTOR(COMPLETED_FMT2) ;

  10764  2 001135   000110 237000 3                  LDAQ    72
         2 001136   200007 755100                    STA     F_FDS,,AUTO
         2 001137   200010 756100                    STQ     F_FDS+1,,AUTO

     2854    10765    3                     FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;

  10765  2 001140   777640 235007                    LDA     -96,DL
         2 001141   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001142   000001 036003                    ADLQ    1,DU
         2 001143   200045 755100                    STA     FMT_VEC,,AUTO
         2 001144   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2855    10766    3                     I = 1 ;

  10766  2 001145   000001 235007                    LDA     1,DL
         2 001146   200343 755100                    STA     I,,AUTO

     2856    10767    3                   END ; /* THEN DO */
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:452  

  10767  2 001147   001153 710000 2                  TRA     s:10769

     2857    10768    2                 ELSE F_FDS.FMT_ = VECTOR(COMPLETED_FMT1) ;   /* No SYSID */

  10768  2 001150   000112 237000 3                  LDAQ    74
         2 001151   200007 755100                    STA     F_FDS,,AUTO
         2 001152   200010 756100                    STQ     F_FDS+1,,AUTO

     2858    10769    2                 FMT_VEC(I) = VECTOR(CH_XFORMAT.JOBNAME#) ;

  10769  2 001153   200343 235100                    LDA     I,,AUTO
         2 001154   000001 735000                    ALS     1
         2 001155   000000 620005                    EAX0    0,AL
         2 001156   000027 235000 3                  LDA     23
         2 001157   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001160   000004 036003                    ADLQ    4,DU
         2 001161   200045 755110                    STA     FMT_VEC,X0,AUTO
         2 001162   200046 756110                    STQ     FMT_VEC+1,X0,AUTO

     2859    10770    2                 F_FDS.NVECS# = I + 1 ;

  10770  2 001163   200343 235100                    LDA     I,,AUTO
         2 001164   000001 035007                    ADLA    1,DL
         2 001165   200020 755100                    STA     F_FDS+9,,AUTO
         2 001166   001375 710000 2                  TRA     s:10832

     2860    10771
     2861    10772    2             CASE(%CP_DOESNT_EXIST_MESS) ;

     2862    10773    2               F_FDS.FMT_ = VECTOR(FMT1) ;

  10773  2 001167   000114 237000 3                  LDAQ    76
         2 001170   200007 755100                    STA     F_FDS,,AUTO
         2 001171   200010 756100                    STQ     F_FDS+1,,AUTO

     2863    10774    2               FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:453  

  10774  2 001172   777640 235007                    LDA     -96,DL
         2 001173   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001174   000001 036003                    ADLQ    1,DU
         2 001175   200045 755100                    STA     FMT_VEC,,AUTO
         2 001176   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2864    10775    2               FMT_VEC(1) = VECTOR(CH_XFORMAT.NUM#) ;

  10775  2 001177   777640 235007                    LDA     -96,DL
         2 001200   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001201   000014 036003                    ADLQ    12,DU
         2 001202   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 001203   200050 756100                    STQ     FMT_VEC+3,,AUTO

     2865    10776    2               FMT_VEC(2) = VECTOR(CH_XFORMAT.JOBNAME#) ;

  10776  2 001204   000027 235000 3                  LDA     23
         2 001205   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001206   000004 036003                    ADLQ    4,DU
         2 001207   200051 755100                    STA     FMT_VEC+4,,AUTO
         2 001210   200052 756100                    STQ     FMT_VEC+5,,AUTO

     2866    10777    2               FMT_VEC(3) = VECTOR(CH_XFORMAT.ACCT#) ;

  10777  2 001211   000011 235000 3                  LDA     9
         2 001212   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001213   000002 036003                    ADLQ    2,DU
         2 001214   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001215   200054 756100                    STQ     FMT_VEC+7,,AUTO

     2867    10778    2               IF (CH_XFORMAT.COMMENT# ~= ' ')

  10778  2 001216   040000 106500                    CMPC    fill='040'O
         2 001217   100017 000030                    ADSC9   15,,PR1                  cn=0,n=24
         2 001220   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001221   001232 600000 2                  TZE     s:10784
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:454  

     2868    10779    2                 THEN
     2869    10780    3                   DO ;

     2870    10781    3                     I = 4 ;

  10781  2 001222   000004 235007                    LDA     4,DL
         2 001223   200343 755100                    STA     I,,AUTO

     2871    10782    3                     FMT_VEC(4) = VECTOR(CH_XFORMAT.COMMENT#) ;

  10782  2 001224   000103 235000 3                  LDA     67
         2 001225   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001226   000017 036003                    ADLQ    15,DU
         2 001227   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001230   200056 756100                    STQ     FMT_VEC+9,,AUTO

     2872    10783    3                   END ; /* THEN DO */

  10783  2 001231   001234 710000 2                  TRA     s:10785

     2873    10784    2                 ELSE I = 3 ;

  10784  2 001232   000003 235007                    LDA     3,DL
         2 001233   200343 755100                    STA     I,,AUTO

     2874    10785    2               F_FDS.NVECS# = I + 1 ;

  10785  2 001234   200343 235100                    LDA     I,,AUTO
         2 001235   000001 035007                    ADLA    1,DL
         2 001236   200020 755100                    STA     F_FDS+9,,AUTO
         2 001237   001375 710000 2                  TRA     s:10832

     2875    10786
     2876    10787
     2877    10788    2             CASE(%CP_FINAL_STAT_MESS) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:455  
     2878    10789    2               CALL OUTPUT_FINAL_STATUS ;

  10789  2 001240   001564 701000 2                  TSX1    OUTPUT_FINAL_STATUS
         2 001241   000000 011000                    NOP     0
         2 001242   001375 710000 2                  TRA     s:10832

     2879    10790
     2880    10791    2             CASE(%CP_TIME_DI_MESS,

     2881    10792    2                   %CP_TIME_DI_W_BELL_MESS) ;
     2882    10793    2               FPT_DISPLAY = CFPT_DISPLAY ;

  10793  2 001243   000000 237000 xsym               LDAQ    CFPT_DISPLAY
         2 001244   200460 757100                    STAQ    FPT_DISPLAY,,AUTO

     2883    10794    2               FPT_DISPLAY.RESULTS_ = VECTOR(VLR_DISPLAY) ;

  10794  2 001245   000116 235000 3                  LDA     78
         2 001246   200520 452500                    STP2    @START+2,,AUTO
         2 001247   200520 236100                    LDQ     @START+2,,AUTO
         2 001250   000450 036003                    ADLQ    296,DU
         2 001251   200460 757100                    STAQ    FPT_DISPLAY,,AUTO

     2884    10795    2               CALL M$DISPLAY (FPT_DISPLAY) ;

  10795  2 001252   200460 630500                    EPPR0   FPT_DISPLAY,,AUTO
         2 001253   020007 713400                    CLIMB   8199
         2 001254   400000 401760                    pmme    nvectors=1

     2885    10796    2               FPT_TIME = CFPT_TIME ;

  10796  2 001255   000100 100400                    MLR     fill='000'O
         2 001256   000000 000060 xsym               ADSC9   CFPT_TIME                cn=0,n=48
         2 001257   200462 000060                    ADSC9   FPT_TIME,,AUTO           cn=0,n=48

     2886    10797    2               FPT_TIME.V_ = VECTOR(FPT_TIME.V) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:456  
  10797  2 001260   000011 235000 3                  LDA     9
         2 001261   200520 452500                    STP2    @START+2,,AUTO
         2 001262   200520 236100                    LDQ     @START+2,,AUTO
         2 001263   000474 036003                    ADLQ    316,DU
         2 001264   200462 757100                    STAQ    FPT_TIME,,AUTO

     2887    10798    2               FPT_TIME.TSTAMP_ = VECTOR(UTS) ;

  10798  2 001265   777640 235007                    LDA     -96,DL
         2 001266   200520 452500                    STP2    @START+2,,AUTO
         2 001267   200520 236100                    LDQ     @START+2,,AUTO
         2 001270   000347 036003                    ADLQ    231,DU
         2 001271   200472 757100                    STAQ    FPT_TIME+8,,AUTO

     2888    10799    2               CALL M$TIME(FPT_TIME) ;

  10799  2 001272   200462 630500                    EPPR0   FPT_TIME,,AUTO
         2 001273   020004 713400                    CLIMB   8196
         2 001274   402000 401760                    pmme    nvectors=5

     2889    10800    2               F_FDS.FMT_ = VECTOR(TIME_DI_MESS_HDR) ;

  10800  2 001275   000120 237000 3                  LDAQ    80
         2 001276   200007 755100                    STA     F_FDS,,AUTO
         2 001277   200010 756100                    STQ     F_FDS+1,,AUTO

     2890    10801    2               FMT_VEC(0) = VECTOR(UTS) ;

  10801  2 001300   777640 235007                    LDA     -96,DL
         2 001301   200520 452500                    STP2    @START+2,,AUTO
         2 001302   200520 236100                    LDQ     @START+2,,AUTO
         2 001303   000347 036003                    ADLQ    231,DU
         2 001304   200045 755100                    STA     FMT_VEC,,AUTO
         2 001305   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2891    10802    2               FMT_VEC(1) = VECTOR(VLR_DISPLAY.USERS) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:457  
  10802  2 001306   777640 235007                    LDA     -96,DL
         2 001307   200520 452500                    STP2    @START+2,,AUTO
         2 001310   200520 236100                    LDQ     @START+2,,AUTO
         2 001311   000450 036003                    ADLQ    296,DU
         2 001312   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 001313   200050 756100                    STQ     FMT_VEC+3,,AUTO

     2892    10803    2               FMT_VEC(2) = VECTOR(VLR_DISPLAY.ETMF) ;

  10803  2 001314   777640 235007                    LDA     -96,DL
         2 001315   200520 452500                    STP2    @START+2,,AUTO
         2 001316   200520 236100                    LDQ     @START+2,,AUTO
         2 001317   000451 036003                    ADLQ    297,DU
         2 001320   200051 755100                    STA     FMT_VEC+4,,AUTO
         2 001321   200052 756100                    STQ     FMT_VEC+5,,AUTO

     2893    10804    2               FMT_VEC(3) = VECTOR(VLR_DISPLAY.RESP) ;

  10804  2 001322   777640 235007                    LDA     -96,DL
         2 001323   200520 452500                    STP2    @START+2,,AUTO
         2 001324   200520 236100                    LDQ     @START+2,,AUTO
         2 001325   000452 036003                    ADLQ    298,DU
         2 001326   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001327   200054 756100                    STQ     FMT_VEC+7,,AUTO

     2894    10805    2               IF CH_XFORMAT.MSG# = %CP_TIME_DI_MESS

  10805  2 001330   200003 470500                    LDP0    @CH_XFORMAT,,AUTO
         2 001331   000000 235100                    LDA     0,,PR0
         2 001332   000011 115007                    CMPA    9,DL
         2 001333   001337 601000 2                  TNZ     s:10810

     2895    10806    2                 THEN
     2896    10807    2                   F_FDS.NVECS# = 4 ;

  10807  2 001334   000004 235007                    LDA     4,DL
         2 001335   200020 755100                    STA     F_FDS+9,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:458  
         2 001336   001375 710000 2                  TRA     s:10832

     2897    10808    2                 ELSE
     2898    10809    3                   DO ;

     2899    10810    3                     FMT_VEC(4) = VECTOR(BELL) ;

  10810  2 001337   000122 237000 3                  LDAQ    82
         2 001340   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001341   200056 756100                    STQ     FMT_VEC+9,,AUTO

     2900    10811    3                     F_FDS.NVECS# = 5 ;

  10811  2 001342   000005 235007                    LDA     5,DL
         2 001343   200020 755100                    STA     F_FDS+9,,AUTO

     2901    10812    3                   END ; /* Else Do */

  10812  2 001344   001375 710000 2                  TRA     s:10832

     2902    10813
     2903    10814    2             CASE(%CP_BLANKLINE_MESS) ;

     2904    10815    2               F_FDS.FMT_ = VECTOR(BLANK_FMT) ;

  10815  2 001345   000124 237000 3                  LDAQ    84
         2 001346   200007 755100                    STA     F_FDS,,AUTO
         2 001347   200010 756100                    STQ     F_FDS+1,,AUTO

     2905    10816    2               F_FDS.NVECS# = 0 ;

  10816  2 001350   200020 450100                    STZ     F_FDS+9,,AUTO
         2 001351   001375 710000 2                  TRA     s:10832

     2906    10817
     2907    10818    2             CASE(%CP_NO_TERM_OUT_MESS) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:459  
     2908    10819    2               F_FDS.FMT_ = VECTOR(NO_TERM_OUT_HDR) ;

  10819  2 001352   000126 237000 3                  LDAQ    86
         2 001353   200007 755100                    STA     F_FDS,,AUTO
         2 001354   200010 756100                    STQ     F_FDS+1,,AUTO

     2909    10820    2               FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;

  10820  2 001355   777640 235007                    LDA     -96,DL
         2 001356   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001357   000001 036003                    ADLQ    1,DU
         2 001360   200045 755100                    STA     FMT_VEC,,AUTO
         2 001361   200046 756100                    STQ     FMT_VEC+1,,AUTO

     2910    10821    2               F_FDS.NVECS# = 1 ;

  10821  2 001362   000001 235007                    LDA     1,DL
         2 001363   200020 755100                    STA     F_FDS+9,,AUTO
         2 001364   001375 710000 2                  TRA     s:10832

     2911    10822
     2912    10823    2             CASE(%CP_HELD_LINE) ;

     2913    10824    2               F_FDS.FMT_ = VECTOR(HELD_LINE_FMT) ;

  10824  2 001365   000130 237000 3                  LDAQ    88
         2 001366   200007 755100                    STA     F_FDS,,AUTO
         2 001367   200010 756100                    STQ     F_FDS+1,,AUTO

     2914    10825    2               F_FDS.NVECS# = 0 ;

  10825  2 001370   200020 450100                    STZ     F_FDS+9,,AUTO
         2 001371   001375 710000 2                  TRA     s:10832

     2915    10826
     2916    10827    2             CASE(ELSE) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:460  
     2917    10828    2               F_FDS.FMT_ = VECTOR(NO_SUCH_MESS_HDR) ;

  10828  2 001372   000132 237000 3                  LDAQ    90
         2 001373   200007 755100                    STA     F_FDS,,AUTO
         2 001374   200010 756100                    STQ     F_FDS+1,,AUTO

     2918    10829
     2919    10830    2         END ; /* DO CASE */

     2920    10831
     2921    10832    1         CALL X$FORMAT(F_FDS) ;

  10832  2 001375   200007 630500                    EPPR0   F_FDS,,AUTO
         2 001376   200520 450500                    STP0    @START+2,,AUTO
         2 001377   200520 630500                    EPPR0   @START+2,,AUTO
         2 001400   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001401   000000 701000 xent               TSX1    X$FORMAT
         2 001402   000000 011000                    NOP     0

     2922    10833    1         IF ADDR(NLINES) ~= ADDR(NIL)

  10833  2 001403   200004 236100                    LDQ     @NLINES,,AUTO
         2 001404   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001405   001453 600000 2                  TZE     s:10855

     2923    10834    1             THEN
     2924    10835    2               DO ;

     2925    10836    2                 NCHARS = F_FDS.WRITEFPT$->FPT$WRITE.BUF_.BOUND+1 ;

  10836  2 001406   200040 470500                    LDP0    F_FDS+25,,AUTO
         2 001407   000004 236100                    LDQ     4,,PR0
         2 001410   000020 772000                    QRL     16
         2 001411   000001 036007                    ADLQ    1,DL
         2 001412   200445 756100                    STQ     NCHARS,,AUTO

     2926    10837    2                 WIDTH = DCBADDR(SEG2$->SEG$2.LLDCB#)->F$DCB.WIDTH# ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:461  

  10837  2 001413   000117 471400 3                  LDP1    79
         2 001414   100000 473500                    LDP3    0,,PR1
         2 001415   000000 474400 xsym               LDP4    SEG2$
         2 001416   400000 720100                    LXL0    0,,PR4
         2 001417   300000 475510                    LDP5    0,X0,PR3
         2 001420   500004 236100                    LDQ     4,,PR5
         2 001421   000777 376007                    ANQ     511,DL
         2 001422   200446 756100                    STQ     WIDTH,,AUTO

     2927    10838    2                 IF WIDTH = 0

  10838  2 001423   001431 601000 2                  TNZ     s:10845

     2928    10839    2                   THEN
     2929    10840    3                     DO ;

     2930    10841    3                       NCHARS = 0 ;

  10841  2 001424   200445 450100                    STZ     NCHARS,,AUTO

     2931    10842    3                       NLINES = 1 ;

  10842  2 001425   000001 235007                    LDA     1,DL
         2 001426   200004 476500                    LDP6    @NLINES,,AUTO
         2 001427   600000 755100                    STA     0,,PR6

     2932    10843    3                     END ; /* Then Do */

  10843  2 001430   001433 710000 2                  TRA     s:10846

     2933    10844    2                   ELSE
     2934    10845    2                     NLINES = 0 ;

  10845  2 001431   200004 476500                    LDP6    @NLINES,,AUTO
         2 001432   600000 450100                    STZ     0,,PR6

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:462  
     2935    10846    3                 DO WHILE(NCHARS > 0) ;

  10846  2 001433   200445 235100                    LDA     NCHARS,,AUTO
         2 001434   001453 600000 2                  TZE     s:10855

     2936    10847    3                   IF NCHARS > WIDTH

  10847  2 001435   200446 236100                    LDQ     WIDTH,,AUTO
         2 001436   200445 116100                    CMPQ    NCHARS,,AUTO
         2 001437   001444 603000 2                  TRC     s:10851

     2937    10848    3                     THEN
     2938    10849    3                       NCHARS = NCHARS - WIDTH ;

  10849  2 001440   200445 236100                    LDQ     NCHARS,,AUTO
         2 001441   200446 136100                    SBLQ    WIDTH,,AUTO
         2 001442   200445 756100                    STQ     NCHARS,,AUTO
         2 001443   001445 710000 2                  TRA     s:10852

     2939    10850    3                     ELSE
     2940    10851    3                       NCHARS = 0 ;

  10851  2 001444   200445 450100                    STZ     NCHARS,,AUTO

     2941    10852    3                   NLINES = NLINES + 1 ;

  10852  2 001445   200004 470500                    LDP0    @NLINES,,AUTO
         2 001446   000000 235100                    LDA     0,,PR0
         2 001447   000001 035007                    ADLA    1,DL
         2 001450   000000 755100                    STA     0,,PR0

     2942    10853    3                 END ; /* Do While */

  10853  2 001451   200445 236100                    LDQ     NCHARS,,AUTO
         2 001452   001435 601000 2                  TNZ     s:10847

     2943    10854    2               END ; /* Then Do */
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:463  

     2944    10855    1         RETURN ;

  10855  2 001453   000000 702200 xent               TSX2  ! X66_ARET

     2945    10856        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:464  
     2946    10857    1   CONVERT_TIME: PROC(CSECS,TIME_BUF) ;

  10857  2 001454   200506 741300       CONVERT_TIME STX1  ! FPT_STATE+8,,AUTO

     2947    10858
     2948    10859        /***** Parameters *****/
     2949    10860
     2950    10861    2   DCL CSECS SBIN WORD ;      /* A time value in centi-seconds */
     2951    10862    2   DCL TIME_BUF CHAR(8) ;
     2952    10863    2   DCL 1 TIME_ REDEF TIME_BUF,
     2953    10864    2         2 HR  CHAR(2),
     2954    10865    2         2 *   CHAR(1),
     2955    10866    2         2 MIN CHAR(2),
     2956    10867    2         2 *   CHAR(1),
     2957    10868    2         2 SEC CHAR(2);
     2958    10869
     2959    10870        /***** Auto *****/
     2960    10871
     2961    10872    2   DCL I UBIN WORD ;
     2962    10873    2   DCL HOUR SBIN WORD ;
     2963    10874    2   DCL MIN SBIN WORD ;
     2964    10875    2   DCL SEC SBIN WORD ;
     2965    10876
     2966    10877        /***** Procedure *****/
     2967    10878
     2968    10879    2               SEC = CSECS/100 ;

  10879  2 001455   200507 470500                    LDP0    @CSECS,,AUTO
         2 001456   000000 236100                    LDQ     0,,PR0
         2 001457   000144 506007                    DIV     100,DL
         2 001460   200514 756100                    STQ     SEC,,AUTO

     2969    10880    2               MIN = SEC/60 ;

  10880  2 001461   000074 506007                    DIV     60,DL
         2 001462   200513 756100                    STQ     MIN,,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:465  
     2970    10881    2               HOUR = MIN/60;

  10881  2 001463   000074 506007                    DIV     60,DL
         2 001464   200512 756100                    STQ     HOUR,,AUTO

     2971    10882
     2972    10883    2               TIME_BUF = '**:**:**';

  10883  2 001465   200510 471500                    LDP1    @TIME_BUF,,AUTO
         2 001466   040100 100400                    MLR     fill='040'O
         2 001467   001412 000010 1                  ADSC9   DEV_TYPES+15             cn=0,n=8
         2 001470   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

     2973    10884    2               CALL BINCHAR(TIME_.HR, HOUR) ;

  10884  2 001471   000100 301500                    BTD
         2 001472   200512 000004                    NDSC9   HOUR,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         2 001473   100000 030002                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=2

     2974    10885    2               CALL BINCHAR(TIME_.MIN, MOD(MIN,60));

  10885  2 001474   200513 236100                    LDQ     MIN,,AUTO
         2 001475   000074 506007                    DIV     60,DL
         2 001476   200520 755100                    STA     @START+2,,AUTO
         2 001477   000100 301500                    BTD
         2 001500   200520 000004                    NDSC9   @START+2,,AUTO           cn=0,s=lsgnf,sf=0,n=4
         2 001501   100000 630002                    NDSC9   0,,PR1                   cn=3,s=nosgn,sf=0,n=2

     2975    10886    2               CALL BINCHAR(TIME_.SEC, MOD(SEC,60));

  10886  2 001502   200514 236100                    LDQ     SEC,,AUTO
         2 001503   000074 506007                    DIV     60,DL
         2 001504   200520 755100                    STA     @START+2,,AUTO
         2 001505   000100 301500                    BTD
         2 001506   200520 000004                    NDSC9   @START+2,,AUTO           cn=0,s=lsgnf,sf=0,n=4
         2 001507   100001 430002                    NDSC9   1,,PR1                   cn=2,s=nosgn,sf=0,n=2

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:466  
     2976    10887
     2977    10888                    /* Now trim off hours and tens of minutes off the string
     2978    10889                       if we can (ie. they're zero).                        */
     2979    10890
     2980    10891    2               IF (MIN <= 9) THEN SUBSTR (TIME_BUF, 0, 4) = '    ';

  10891  2 001510   200513 235100                    LDA     MIN,,AUTO
         2 001511   000011 115007                    CMPA    9,DL
         2 001512   001517 605400 2                  TPNZ    s:10892

  10891  2 001513   040100 100400                    MLR     fill='040'O
         2 001514   001414 000004 1                  ADSC9   DEV_TYPES+17             cn=0,n=4
         2 001515   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         2 001516   001532 710000 2                  TRA     s:10894

     2981    10892    2               ELSE IF (HOUR = 0) THEN SUBSTR (TIME_BUF, 0, 3) = '   ';

  10892  2 001517   200512 236100                    LDQ     HOUR,,AUTO
         2 001520   001525 601000 2                  TNZ     s:10893

  10892  2 001521   040100 100400                    MLR     fill='040'O
         2 001522   001414 000003 1                  ADSC9   DEV_TYPES+17             cn=0,n=3
         2 001523   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3
         2 001524   001532 710000 2                  TRA     s:10894

     2982    10893    2               ELSE IF (HOUR <= 9) THEN SUBSTR (TIME_BUF, 0, 1) = ' ';

  10893  2 001525   000011 116007                    CMPQ    9,DL
         2 001526   001532 605400 2                  TPNZ    s:10894

  10893  2 001527   040100 100400                    MLR     fill='040'O
         2 001530   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001531   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     2983    10894    2               RETURN ;

  10894  2 001532   200506 221300                    LDX1  ! FPT_STATE+8,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:467  
         2 001533   000001 702211                    TSX2  ! 1,X1

     2984    10895
     2985    10896    2   END   CONVERT_TIME ;
     2986    10897
     2987    10898        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:468  
     2988    10899    1   GET_OUTPUT_TYPE:    PROC(VEC#,TYPE_ARRY) ;

  10899  2 001534   200506 741300       GET_OUTPUT_* STX1  ! FPT_STATE+8,,AUTO

     2989    10900
     2990    10901        /***** Parameters *****/
     2991    10902
     2992    10903    2   DCL VEC# UBIN WORD ;
     2993    10904    2   DCL TYPE_ARRY (0:6) CHAR(8) UNAL ;
     2994    10905
     2995    10906        /***** Constants *****/
     2996    10907    2   DCL DEV_TYPES (0:4) CHAR(4) CONSTANT INIT ('LP','CP','JE','PL','PR') ;
     2997    10908    2   DCL DEV_TYPES_STR REDEF DEV_TYPES CHAR(20) ;
     2998    10909
     2999    10910        /***** Auto *****/
     3000    10911
     3001    10912    2   DCL TYPE_NUM UBIN WORD ;
     3002    10913
     3003    10914        /***** Procedure *****/
     3004    10915
     3005    10916    2         DEVTYPE = BUF$ -> VLA$OUTPUT.DEVTYP ;

  10916  2 001535   200005 470500                    LDP0    BUF$,,AUTO
         2 001536   000002 220100                    LDX0    2,,PR0
         2 001537   200364 740100                    STX0    DEVTYPE,,AUTO

     3006    10917    2         CALL INDEX(TYPE_NUM,DEVTYPE,DEV_TYPES_STR) ;

  10917  2 001540   000100 120400                    SCD
         2 001541   001373 000024 1                  ADSC9   DEV_TYPES                cn=0,n=20
         2 001542   200364 000002                    ADSC9   DEVTYPE,,AUTO            cn=0,n=2
         2 001543   200511 000100                    ARG     TYPE_NUM,,AUTO
         2 001544   001546 607000 2                  TTF     s:10918
         2 001545   200511 054100                    AOS     TYPE_NUM,,AUTO

     3007    10918    2         FMT_VEC(VEC#) = VECTOR(TYPE_ARRY(TYPE_NUM/4)) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:469  
  10918  2 001546   200507 471500                    LDP1    @VEC#,,AUTO
         2 001547   100000 722100                    LXL2    0,,PR1
         2 001550   000000 635012                    EAA     0,X2
         2 001551   000021 771000                    ARL     17
         2 001552   200511 236100                    LDQ     TYPE_NUM,,AUTO
         2 001553   000002 772000                    QRL     2
         2 001554   000000 623005                    EAX3    0,AL
         2 001555   000011 235000 3                  LDA     9
         2 001556   000023 736000                    QLS     19
         2 001557   200510 036100                    ADLQ    @TYPE_ARRY,,AUTO
         2 001560   200045 755113                    STA     FMT_VEC,X3,AUTO
         2 001561   200046 756113                    STQ     FMT_VEC+1,X3,AUTO

     3008    10919
     3009    10920    2         RETURN ;

  10920  2 001562   200506 221300                    LDX1  ! FPT_STATE+8,,AUTO
         2 001563   000001 702211                    TSX2  ! 1,X1

     3010    10921    2   END   GET_OUTPUT_TYPE ;
     3011    10922        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:470  
     3012    10923    1   OUTPUT_FINAL_STATUS:  PROC ;

  10923  2 001564   200504 741300       OUTPUT_FINA* STX1  ! FPT_STATE+6,,AUTO

     3013    10924
     3014    10925    2         FMT_VEC(0) = VECTOR(CH_XFORMAT.SYSID#) ;

  10925  2 001565   777640 235007                    LDA     -96,DL
         2 001566   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001567   000001 036003                    ADLQ    1,DU
         2 001570   200045 755100                    STA     FMT_VEC,,AUTO
         2 001571   200046 756100                    STQ     FMT_VEC+1,,AUTO

     3015    10926    2         FMT_VEC(1) = VECTOR(CH_XFORMAT.JOBNAME#) ;

  10926  2 001572   000027 235000 3                  LDA     23
         2 001573   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001574   000004 036003                    ADLQ    4,DU
         2 001575   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 001576   200050 756100                    STQ     FMT_VEC+3,,AUTO

     3016    10927    2         FMT_VEC(2) = VECTOR(CH_XFORMAT.ACCT#) ;

  10927  2 001577   000011 235000 3                  LDA     9
         2 001600   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 001601   000002 036003                    ADLQ    2,DU
         2 001602   200051 755100                    STA     FMT_VEC+4,,AUTO
         2 001603   200052 756100                    STQ     FMT_VEC+5,,AUTO

     3017    10928
     3018    10929    2         STEPCC = CH_XFORMAT.BUF$ -> XSJ$JOBINFO.STEPCC# ;

  10929  2 001604   200003 470500                    LDP0    @CH_XFORMAT,,AUTO
         2 001605   000015 471500                    LDP1    13,,PR0
         2 001606   100000 236100                    LDQ     0,,PR1
         2 001607   000011 772000                    QRL     9
         2 001610   000777 376007                    ANQ     511,DL
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:471  
         2 001611   200367 756100                    STQ     STEPCC,,AUTO

     3019    10930    2         STEPCC_ = VECTOR(NIL) ;

  10930  2 001612   000134 237000 3                  LDAQ    92
         2 001613   200370 757100                    STAQ    STEPCC_,,AUTO

     3020    10931    2         RECNO_ = VECTOR(CH_XFORMAT.BUF$ -> XSJ$JOBINFO.RECNO#) ;

  10931  2 001614   000015 471500                    LDP1    13,,PR0
         2 001615   777640 235007                    LDA     -96,DL
         2 001616   200520 451500                    STP1    @START+2,,AUTO
         2 001617   200520 236100                    LDQ     @START+2,,AUTO
         2 001620   000001 036003                    ADLQ    1,DU
         2 001621   200372 757100                    STAQ    RECNO_,,AUTO

     3021    10932    3         DO CASE(CH_XFORMAT.BUF$ -> XSJ$JOBINFO.STATUS#) ;

  10932  2 001622   000015 471500                    LDP1    13,,PR0
         2 001623   100000 236100                    LDQ     0,,PR1
         2 001624   000777 376007                    ANQ     511,DL
         2 001625   000036 136007                    SBLQ    30,DL
         2 001626   000036 116007                    CMPQ    30,DL
         2 001627   001631 602006 2                  TNC     s:10932+7,QL
         2 001630   002044 710000 2                  TRA     s:11019
         2 001631   001667 710000 2                  TRA     s:10935
         2 001632   001673 710000 2                  TRA     s:10938
         2 001633   001677 710000 2                  TRA     s:10941
         2 001634   001707 710000 2                  TRA     s:10947
         2 001635   002044 710000 2                  TRA     s:11019
         2 001636   002044 710000 2                  TRA     s:11019
         2 001637   002044 710000 2                  TRA     s:11019
         2 001640   002044 710000 2                  TRA     s:11019
         2 001641   002044 710000 2                  TRA     s:11019
         2 001642   002044 710000 2                  TRA     s:11019
         2 001643   001713 710000 2                  TRA     s:10950
         2 001644   001717 710000 2                  TRA     s:10954
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:472  
         2 001645   001723 710000 2                  TRA     s:10958
         2 001646   001727 710000 2                  TRA     s:10962
         2 001647   001733 710000 2                  TRA     s:10966
         2 001650   001753 710000 2                  TRA     s:10982
         2 001651   001737 710000 2                  TRA     s:10970
         2 001652   001743 710000 2                  TRA     s:10974
         2 001653   001747 710000 2                  TRA     s:10978
         2 001654   001757 710000 2                  TRA     s:10986
         2 001655   001703 710000 2                  TRA     s:10944
         2 001656   002044 710000 2                  TRA     s:11019
         2 001657   002044 710000 2                  TRA     s:11019
         2 001660   002044 710000 2                  TRA     s:11019
         2 001661   002044 710000 2                  TRA     s:11019
         2 001662   002044 710000 2                  TRA     s:11019
         2 001663   002044 710000 2                  TRA     s:11019
         2 001664   001763 710000 2                  TRA     s:10990
         2 001665   001767 710000 2                  TRA     s:10993
         2 001666   002031 710000 2                  TRA     s:11014

     3022    10933
     3023    10934    3             CASE(%MBS_DELETED#) ;

     3024    10935    3               FMT_VEC(3) = MBS_DELETED_ ;

  10935  2 001667   000752 237000 1                  LDAQ    MBS_DELETED_
         2 001670   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001671   200054 756100                    STQ     FMT_VEC+7,,AUTO
         2 001672   002047 710000 2                  TRA     s:11023

     3025    10936
     3026    10937    3             CASE(%MBS_CANCELED#) ;

     3027    10938    3               FMT_VEC(3) = MBS_CANCELED_ ;

  10938  2 001673   000754 237000 1                  LDAQ    MBS_CANCELED_
         2 001674   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001675   200054 756100                    STQ     FMT_VEC+7,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:473  
         2 001676   002047 710000 2                  TRA     s:11023

     3028    10939
     3029    10940    3             CASE(%MBS_SHAFTED#) ;

     3030    10941    3               FMT_VEC(3) = MBS_SHAFTED_ ;

  10941  2 001677   000756 237000 1                  LDAQ    MBS_SHAFTED_
         2 001700   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001701   200054 756100                    STQ     FMT_VEC+7,,AUTO
         2 001702   002047 710000 2                  TRA     s:11023

     3031    10942
     3032    10943    3             CASE(%MBS_FILERR#) ;

     3033    10944    3               FMT_VEC(3) = MBS_FILERR_ ;

  10944  2 001703   000760 237000 1                  LDAQ    MBS_FILERR_
         2 001704   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001705   200054 756100                    STQ     FMT_VEC+7,,AUTO
         2 001706   002047 710000 2                  TRA     s:11023

     3034    10945
     3035    10946    3             CASE(%PRE_PASSED#) ;

     3036    10947    3               FMT_VEC(3) = PRE_PASSED_ ;

  10947  2 001707   000762 237000 1                  LDAQ    PRE_PASSED_
         2 001710   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001711   200054 756100                    STQ     FMT_VEC+7,,AUTO
         2 001712   002047 710000 2                  TRA     s:11023

     3037    10948
     3038    10949    3             CASE(%REJ_JOB#) ;

     3039    10950    3               FMT_VEC(4) = REJ_JOB_ ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:474  
  10950  2 001713   000764 237000 1                  LDAQ    REJ_JOB_
         2 001714   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001715   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3040    10951    3               GOTO REJECTED_MSG ;

  10951  2 001716   002114 710000 2                  TRA     REJECTED_MSG

     3041    10952
     3042    10953    3             CASE(%REJ_RES#) ;

     3043    10954    3               FMT_VEC(4) = REJ_RES_ ;

  10954  2 001717   000766 237000 1                  LDAQ    REJ_RES_
         2 001720   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001721   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3044    10955    3               GOTO REJECTED_MSG ;

  10955  2 001722   002114 710000 2                  TRA     REJECTED_MSG

     3045    10956
     3046    10957    3             CASE(%REJ_SYNTAX#) ;

     3047    10958    3               FMT_VEC(4) = REJ_SYNTAX_ ;

  10958  2 001723   000770 237000 1                  LDAQ    REJ_SYNTAX_
         2 001724   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001725   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3048    10959    3               GOTO REJECTED_MSG ;

  10959  2 001726   002114 710000 2                  TRA     REJECTED_MSG

     3049    10960
     3050    10961    3             CASE(%REJ_IO#) ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:475  
     3051    10962    3               FMT_VEC(4) = REJ_IO_ ;

  10962  2 001727   000772 237000 1                  LDAQ    REJ_IO_
         2 001730   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001731   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3052    10963    3               GOTO REJECTED_MSG ;

  10963  2 001732   002114 710000 2                  TRA     REJECTED_MSG

     3053    10964
     3054    10965    3             CASE(%REJ_JOBIMBED#) ;

     3055    10966    3               FMT_VEC(4) = REJ_JOBIMBED_ ;

  10966  2 001733   000774 237000 1                  LDAQ    REJ_JOBIMBED_
         2 001734   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001735   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3056    10967    3               GOTO REJECTED_MSG ;

  10967  2 001736   002114 710000 2                  TRA     REJECTED_MSG

     3057    10968
     3058    10969    3             CASE(%REJ_BADID#) ;

     3059    10970    3               FMT_VEC(4) = REJ_BADID_ ;

  10970  2 001737   000776 237000 1                  LDAQ    REJ_BADID_
         2 001740   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001741   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3060    10971    3               GOTO REJECTED_MSG ;

  10971  2 001742   002114 710000 2                  TRA     REJECTED_MSG

     3061    10972
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:476  
     3062    10973    3             CASE(%REJ_NORES#) ;

     3063    10974    3               FMT_VEC(4) = REJ_NORES_ ;

  10974  2 001743   001000 237000 1                  LDAQ    REJ_NORES_
         2 001744   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001745   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3064    10975    3               GOTO REJECTED_MSG ;

  10975  2 001746   002114 710000 2                  TRA     REJECTED_MSG

     3065    10976
     3066    10977    3             CASE(%REJ_PRESCAN#) ;

     3067    10978    3               FMT_VEC(4) = REJ_PRESCAN_ ;

  10978  2 001747   001002 237000 1                  LDAQ    REJ_PRESCAN_
         2 001750   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001751   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3068    10979    3               GOTO REJECTED_MSG ;

  10979  2 001752   002114 710000 2                  TRA     REJECTED_MSG

     3069    10980
     3070    10981    3             CASE(%REJ_RESIMBED#) ;

     3071    10982    3               FMT_VEC(4) = REJ_RESIMBED_ ;

  10982  2 001753   001004 237000 1                  LDAQ    REJ_RESIMBED_
         2 001754   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001755   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3072    10983    3               GOTO REJECTED_MSG ;

  10983  2 001756   002114 710000 2                  TRA     REJECTED_MSG
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:477  

     3073    10984
     3074    10985    3             CASE(%REJ_NOBATCH#) ;

     3075    10986    3               FMT_VEC(4) = REJ_NOBATCH_ ;

  10986  2 001757   001006 237000 1                  LDAQ    REJ_NOBATCH_
         2 001760   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 001761   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3076    10987    3               GOTO REJECTED_MSG ;

  10987  2 001762   002114 710000 2                  TRA     REJECTED_MSG

     3077    10988
     3078    10989    3             CASE(%FIN_RECOVER#) ;

     3079    10990    3               FMT_VEC(3) = FIN_RECOVER_ ;

  10990  2 001763   001010 237000 1                  LDAQ    FIN_RECOVER_
         2 001764   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001765   200054 756100                    STQ     FMT_VEC+7,,AUTO
         2 001766   002047 710000 2                  TRA     s:11023

     3080    10991
     3081    10992    3             CASE(%FIN_ABNORMAL#) ;

     3082    10993    3               IF (CH_XFORMAT.BUF$->XSJ$JOBINFO.FRS# = %RS_CAN#)

  10993  2 001767   100000 236100                    LDQ     0,,PR1
         2 001770   777000 376003                    ANQ     -512,DU
         2 001771   021000 116003                    CMPQ    8704,DU
         2 001772   001777 601000 2                  TNZ     s:10997

     3083    10994    3                 THEN FMT_VEC(3) = RS_CAN_ ;

  10994  2 001773   001250 237000 1                  LDAQ    RS_CAN_
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:478  
         2 001774   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 001775   200054 756100                    STQ     FMT_VEC+7,,AUTO
         2 001776   002047 710000 2                  TRA     s:11023

     3084    10995    3                 ELSE
     3085    10996    4                   DO ;

     3086    10997    4                     START = 0 ;

  10997  2 001777   200444 450100                    STZ     START,,AUTO

     3087    10998    4                     CALL GETBIT(CH_XFORMAT.BUF$->XSJ$JOBINFO.FRS#,START)

  10998  2 002000   000015 471500                    LDP1    13,,PR0
         2 002001   200444 633500                    EPPR3   START,,AUTO
         2 002002   200516 453500                    STP3    @MASK+1,,AUTO
         2 002003   200515 451500                    STP1    SEC+1,,AUTO
         2 002004   002160 701000 2                  TSX1    GETBIT
         2 002005   002050 702000 2                  TSX2    NOFRS

     3088    10999    4                         ALTRET(NOFRS) ;
     3089    11000    4                     FMT_VEC(3) = RS__(BITSET) ;

  11000  2 002006   200346 235100                    LDA     BITSET,,AUTO
         2 002007   000001 735000                    ALS     1
         2 002010   001204 237005 1                  LDAQ    RS__,AL
         2 002011   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 002012   200054 756100                    STQ     FMT_VEC+7,,AUTO

     3090    11001    4                     IF FMT_VEC(3) = VECTOR(RS_LIMX)

  11001  2 002013   000000 106500                    CMPC    fill='000'O
         2 002014   200053 000010                    ADSC9   FMT_VEC+6,,AUTO          cn=0,n=8
         2 002015   000136 000010 3                  ADSC9   94                       cn=0,n=8
         2 002016   002047 601000 2                  TNZ     s:11023

     3091    11002    4                       THEN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:479  
     3092    11003    4                         CALL SETUP_LIMIT_VECTOR(CH_XFORMAT.BUF$->

  11003  2 002017   200003 470500                    LDP0    @CH_XFORMAT,,AUTO
         2 002020   000015 471500                    LDP1    13,,PR0
         2 002021   200520 451500                    STP1    @START+2,,AUTO
         2 002022   200520 236100                    LDQ     @START+2,,AUTO
         2 002023   200000 036007                    ADLQ    65536,DL
         2 002024   200507 756100                    STQ     @VEC#,,AUTO
         2 002025   002207 701000 2                  TSX1    SETUP_LIMIT_VECTOR
         2 002026   002030 702000 2                  TSX2    s:11009

     3093    11004    4                                                         XSJ$JOBINFO.XLIMFLG#)
     3094    11005    5                                                 WHENRETURN DO ;

     3095    11006    5                                                   GOTO ADD_COMMENT ;

  11006  2 002027   002133 710000 2                  TRA     ADD_COMMENT

     3096    11007    5                                                 END ; /* Whenreturn Do */
     3097    11008    5                                                 WHENALTRETURN DO ;

     3098    11009    5                                                   GOTO SIMPLE_MSG ;

  11009  2 002030   002062 710000 2                  TRA     SIMPLE_MSG

     3099    11010    5                                                 END ; /* Whenaltreturn Do */
     3100    11011    4                   END ; /* THEN DO */
     3101    11012
     3102    11013    3             CASE(%FIN_COMPLETED#) ;

     3103    11014    3               FMT_VEC(3) = FIN_COMPLETED_ ;

  11014  2 002031   001014 237000 1                  LDAQ    FIN_COMPLETED_
         2 002032   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 002033   200054 756100                    STQ     FMT_VEC+7,,AUTO

     3104    11015    3               IF STEPCC ~= 0
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:480  

  11015  2 002034   200367 235100                    LDA     STEPCC,,AUTO
         2 002035   002047 600000 2                  TZE     s:11023

     3105    11016    3                 THEN STEPCC_ = VECTOR(STEPCC) ;

  11016  2 002036   777640 235007                    LDA     -96,DL
         2 002037   200520 452500                    STP2    @START+2,,AUTO
         2 002040   200520 236100                    LDQ     @START+2,,AUTO
         2 002041   000367 036003                    ADLQ    247,DU
         2 002042   200370 757100                    STAQ    STEPCC_,,AUTO
         2 002043   002047 710000 2                  TRA     s:11023

     3106    11017
     3107    11018    3             CASE( ELSE ) ;

     3108    11019    3               FMT_VEC(3) = FIN_ABNORMAL_UNKNOWN_ ;

  11019  2 002044   001016 237000 1                  LDAQ    FIN_ABNORMAL_UNKNOWN_
         2 002045   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 002046   200054 756100                    STQ     FMT_VEC+7,,AUTO

     3109    11020
     3110    11021    3         END ; /* DO CASE */

     3111    11022
     3112    11023    3         DO WHILE ('0'B) ;

  11023  2 002047   002062 710000 2                  TRA     SIMPLE_MSG

     3113    11024    3   NOFRS:    FMT_VEC(3) = FIN_ABNORMAL_ ;

  11024  2 002050   001012 237000 1     NOFRS        LDAQ    FIN_ABNORMAL_
         2 002051   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 002052   200054 756100                    STQ     FMT_VEC+7,,AUTO

     3114    11025    3             IF STEPCC ~= 0
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:481  

  11025  2 002053   200367 235100                    LDA     STEPCC,,AUTO
         2 002054   002062 600000 2                  TZE     SIMPLE_MSG

     3115    11026    3               THEN STEPCC_ = VECTOR(STEPCC) ;

  11026  2 002055   777640 235007                    LDA     -96,DL
         2 002056   200520 452500                    STP2    @START+2,,AUTO
         2 002057   200520 236100                    LDQ     @START+2,,AUTO
         2 002060   000367 036003                    ADLQ    247,DU
         2 002061   200370 757100                    STAQ    STEPCC_,,AUTO

     3116    11027    3         END ; /* DO WHILE */

     3117    11028
     3118    11029    2   SIMPLE_MSG:
     3119    11030
     3120    11031    2         FMT_VEC(4) = VECTOR(CH_XFORMAT.BUF$->XSJ$JOBINFO.OFF_TIME#) ;

  11031  2 002062   200003 470500       SIMPLE_MSG   LDP0    @CH_XFORMAT,,AUTO
         2 002063   000015 471500                    LDP1    13,,PR0
         2 002064   777640 235007                    LDA     -96,DL
         2 002065   200520 451500                    STP1    @START+2,,AUTO
         2 002066   200520 236100                    LDQ     @START+2,,AUTO
         2 002067   000002 036003                    ADLQ    2,DU
         2 002070   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 002071   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3121    11032    2         IF STEPCC_ = VECTOR(NIL)

  11032  2 002072   200370 237100                    LDAQ    STEPCC_,,AUTO
         2 002073   000134 117000 3                  CMPAQ   92
         2 002074   002103 601000 2                  TNZ     s:11040

     3122    11033    2             THEN
     3123    11034    3               DO ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:482  
     3124    11035    3                 I = 4 ;

  11035  2 002075   000004 235007                    LDA     4,DL
         2 002076   200343 755100                    STA     I,,AUTO

     3125    11036    3                 F_FDS.FMT_ = FMTVEC_ ;

  11036  2 002077   000664 237000 1                  LDAQ    FMTVEC_
         2 002100   200007 755100                    STA     F_FDS,,AUTO
         2 002101   200010 756100                    STQ     F_FDS+1,,AUTO

     3126    11037    3               END ; /* THEN DO */

  11037  2 002102   002113 710000 2                  TRA     s:11045

     3127    11038    2             ELSE
     3128    11039    3               DO ;

     3129    11040    3                 FMT_VEC(5) = STEPCC_ ;

  11040  2 002103   200370 237100                    LDAQ    STEPCC_,,AUTO
         2 002104   200057 755100                    STA     FMT_VEC+10,,AUTO
         2 002105   200060 756100                    STQ     FMT_VEC+11,,AUTO

     3130    11041    3                 I = 5 ;

  11041  2 002106   000005 235007                    LDA     5,DL
         2 002107   200343 755100                    STA     I,,AUTO

     3131    11042    3                 F_FDS.FMT_ = FMTVEC1_ ;

  11042  2 002110   000666 237000 1                  LDAQ    FMTVEC1_
         2 002111   200007 755100                    STA     F_FDS,,AUTO
         2 002112   200010 756100                    STQ     F_FDS+1,,AUTO

     3132    11043    3               END ; /* ELSE DO */

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:483  
     3133    11044
     3134    11045    3         DO WHILE('0'B) ;

  11045  2 002113   002133 710000 2                  TRA     ADD_COMMENT

     3135    11046
     3136    11047    3   REJECTED_MSG:
     3137    11048    3             FMT_VEC(3) = RECNO_ ;

  11048  2 002114   200372 237100       REJECTED_MSG LDAQ    RECNO_,,AUTO
         2 002115   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 002116   200054 756100                    STQ     FMT_VEC+7,,AUTO

     3138    11049    3             FMT_VEC(5) = VECTOR(CH_XFORMAT.BUF$ -> XSJ$JOBINFO.OFF_TIME#) ;

  11049  2 002117   000015 471500                    LDP1    13,,PR0
         2 002120   777640 235007                    LDA     -96,DL
         2 002121   200520 451500                    STP1    @START+2,,AUTO
         2 002122   200520 236100                    LDQ     @START+2,,AUTO
         2 002123   000002 036003                    ADLQ    2,DU
         2 002124   200057 755100                    STA     FMT_VEC+10,,AUTO
         2 002125   200060 756100                    STQ     FMT_VEC+11,,AUTO

     3139    11050    3             I = 5 ;

  11050  2 002126   000005 235007                    LDA     5,DL
         2 002127   200343 755100                    STA     I,,AUTO

     3140    11051    3             F_FDS.FMT_ = FMTVEC2_ ;

  11051  2 002130   000670 237000 1                  LDAQ    FMTVEC2_
         2 002131   200007 755100                    STA     F_FDS,,AUTO
         2 002132   200010 756100                    STQ     F_FDS+1,,AUTO

     3141    11052    3         END ; /* DO WHILE */

     3142    11053
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:484  
     3143    11054    2   ADD_COMMENT:
     3144    11055    2         IF (CH_XFORMAT.COMMENT# ~= ' ')

  11055  2 002133   200003 470500       ADD_COMMENT  LDP0    @CH_XFORMAT,,AUTO
         2 002134   040000 106500                    CMPC    fill='040'O
         2 002135   000017 000030                    ADSC9   15,,PR0                  cn=0,n=24
         2 002136   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002137   002153 600000 2                  TZE     s:11061

     3145    11056    2             THEN
     3146    11057    3               DO ;

     3147    11058    3                 FMT_VEC(I+1) = VECTOR(CH_XFORMAT.COMMENT#) ;

  11058  2 002140   200343 235100                    LDA     I,,AUTO
         2 002141   000001 735000                    ALS     1
         2 002142   000000 620005                    EAX0    0,AL
         2 002143   000103 235000 3                  LDA     67
         2 002144   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 002145   000017 036003                    ADLQ    15,DU
         2 002146   200047 755110                    STA     FMT_VEC+2,X0,AUTO
         2 002147   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     3148    11059    3                 I = I + 1 ;

  11059  2 002150   200343 235100                    LDA     I,,AUTO
         2 002151   000001 035007                    ADLA    1,DL
         2 002152   200343 755100                    STA     I,,AUTO

     3149    11060    3               END ; /* THEN DO */

     3150    11061    2         F_FDS.NVECS# = I + 1 ;

  11061  2 002153   200343 235100                    LDA     I,,AUTO
         2 002154   000001 035007                    ADLA    1,DL
         2 002155   200020 755100                    STA     F_FDS+9,,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:485  
     3151    11062
     3152    11063    2         RETURN ;

  11063  2 002156   200504 221300                    LDX1  ! FPT_STATE+6,,AUTO
         2 002157   000001 702211                    TSX2  ! 1,X1

     3153    11064
     3154    11065        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:486  
     3155    11066    2   GETBIT:   PROC (MASK, START) ALTRET ;

  11066  2 002160   200514 741300       GETBIT       STX1  ! SEC,,AUTO

     3156    11067
     3157    11068    3   DCL MASK(0:8) BIT(1) UNAL ;
     3158    11069    3   DCL START UBIN WORD ;
     3159    11070
     3160    11071    4         DO BITSET = START TO 8;

  11071  2 002161   200516 470500                    LDP0    @START,,AUTO
         2 002162   000000 235100                    LDA     0,,PR0
         2 002163   200346 755100                    STA     BITSET,,AUTO
         2 002164   002203 710000 2                  TRA     s:11074+3

     3161    11072    4             IF MASK(8-BITSET)

  11072  2 002165   000000 235003                    LDA     0,DU
         2 002166   200346 135100                    SBLA    BITSET,,AUTO
         2 002167   002171 605000 2                  TPL     s:11072+4
         2 002170   000044 035003                    ADLA    36,DU
         2 002171   200515 470500                    LDP0    @MASK,,AUTO
         2 002172   000000 066505                    CMPB    filb='0'B
         2 002173   000000 100001                    BDSC    0,A,PR0                  by=0,bit=8,n=1
         2 002174   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 002175   002200 600000 2                  TZE     s:11074

     3162    11073    4               THEN RETURN ;

  11073  2 002176   200514 221300                    LDX1  ! SEC,,AUTO
         2 002177   000001 702211                    TSX2  ! 1,X1

     3163    11074    4         END ; /* DO BITSET */

  11074  2 002200   200346 235100                    LDA     BITSET,,AUTO
         2 002201   000001 035007                    ADLA    1,DL
         2 002202   200346 755100                    STA     BITSET,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:487  
         2 002203   000011 115007                    CMPA    9,DL
         2 002204   002165 602000 2                  TNC     s:11072

     3164    11075
     3165    11076    3         ALTRETURN ;

  11076  2 002205   200514 221300                    LDX1  ! SEC,,AUTO
         2 002206   000000 702211                    TSX2  ! 0,X1

     3166    11077
     3167    11078    3   END   GETBIT ;
     3168    11079        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:488  
     3169    11080    2   SETUP_LIMIT_VECTOR: PROC(MASK) ALTRET ;

  11080  2 002207   200506 741300       SETUP_LIMIT* STX1  ! FPT_STATE+8,,AUTO

     3170    11081
     3171    11082    3   DCL MASK BIT(9) UNAL ;
     3172    11083    3   DCL CHR_POS UBIN WORD ;
     3173    11084    3   DCL EXTRA_SZ UBIN WORD ;
     3174    11085    3   DCL NOT_DONE BIT(1) ;
     3175    11086    3   DCL RETFLG BIT(1) ;
     3176    11087
     3177    11088    3         LIMIT_BUF = LIMIT_FMT_BUF ;

  11088  2 002210   040100 100400                    MLR     fill='040'O
         2 002211   000735 000027 1                  ADSC9   LIMIT_FMT_BUF            cn=0,n=23
         2 002212   200420 000120                    ADSC9   LIMIT_BUF,,AUTO          cn=0,n=80

     3178    11089    3         CHR_POS = SIZEC(LIMIT_FMT_BUF) ;

  11089  2 002213   000027 235007                    LDA     23,DL
         2 002214   200510 755100                    STA     CHR_POS,,AUTO

     3179    11090    3         EXTRA_SZ = SIZEC(EXTRA_LIMITS_FMT) ;

  11090  2 002215   000005 236007                    LDQ     5,DL
         2 002216   200511 756100                    STQ     EXTRA_SZ,,AUTO

     3180    11091    3         NOT_DONE = %YES# ;

  11091  2 002217   400000 236003                    LDQ     -131072,DU
         2 002220   200512 756100                    STQ     NOT_DONE,,AUTO

     3181    11092    3         I = 3 ;

  11092  2 002221   000003 235007                    LDA     3,DL
         2 002222   200343 755100                    STA     I,,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:489  
     3182    11093
     3183    11094    4         DO WHILE(NOT_DONE) ;

  11094  2 002223   200512 234100                    SZN     NOT_DONE,,AUTO
         2 002224   002302 605000 2                  TPL     s:11120

     3184    11095    5             CALL GETBIT(MASK, START) WHENRETURN DO ;

  11095  2 002225   200444 630500                    EPPR0   START,,AUTO
         2 002226   200516 450500                    STP0    @START,,AUTO
         2 002227   200507 236100                    LDQ     @MASK,,AUTO
         2 002230   200515 756100                    STQ     @MASK,,AUTO
         2 002231   002160 701000 2                  TSX1    GETBIT
         2 002232   002270 702000 2                  TSX2    s:11111

     3185    11096    5                             FMT_VEC(I) = XL__(BITSET) ;

  11096  2 002233   200343 235100                    LDA     I,,AUTO
         2 002234   000001 735000                    ALS     1
         2 002235   000000 620005                    EAX0    0,AL
         2 002236   000000 621005                    EAX1    0,AL
         2 002237   200346 236100                    LDQ     BITSET,,AUTO
         2 002240   000001 736000                    QLS     1
         2 002241   001226 237006 1                  LDAQ    XL__,QL
         2 002242   200045 755110                    STA     FMT_VEC,X0,AUTO
         2 002243   200046 756111                    STQ     FMT_VEC+1,X1,AUTO

     3186    11097    5                             IF I > 3

  11097  2 002244   200343 235100                    LDA     I,,AUTO
         2 002245   000004 115007                    CMPA    4,DL
         2 002246   002256 602000 2                  TNC     s:11104

     3187    11098    5                               THEN
     3188    11099    6                                 DO ;

     3189    11100    6                                   SUBSTR(LIMIT_BUF,CHR_POS,EXTRA_SZ) =
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:490  

  11100  2 002247   200511 720100                    LXL0    EXTRA_SZ,,AUTO
         2 002250   200510 236100                    LDQ     CHR_POS,,AUTO
         2 002251   040146 100400                    MLR     fill='040'O
         2 002252   000743 000005 1                  ADSC9   EXTRA_LIMITS_FMT         cn=0,n=5
         2 002253   200420 000010                    ADSC9   LIMIT_BUF,Q,AUTO         cn=0,n=*X0

     3190    11101    6                                           EXTRA_LIMITS_FMT ;
     3191    11102    6                                   CHR_POS = CHR_POS + EXTRA_SZ ;

  11102  2 002254   200511 036100                    ADLQ    EXTRA_SZ,,AUTO
         2 002255   200510 756100                    STQ     CHR_POS,,AUTO

     3192    11103    6                                 END ; /* Then Do */

     3193    11104    5                             START = BITSET + 1 ;

  11104  2 002256   200346 235100                    LDA     BITSET,,AUTO
         2 002257   000001 035007                    ADLA    1,DL
         2 002260   200444 755100                    STA     START,,AUTO

     3194    11105    5                             IF START > 8

  11105  2 002261   000011 115007                    CMPA    9,DL
         2 002262   002264 602000 2                  TNC     s:11108

     3195    11106    5                               THEN
     3196    11107    5                                 NOT_DONE = %NO# ;

  11107  2 002263   200512 450100                    STZ     NOT_DONE,,AUTO

     3197    11108    5                             I = I + 1 ;

  11108  2 002264   200343 236100                    LDQ     I,,AUTO
         2 002265   000001 036007                    ADLQ    1,DL
         2 002266   200343 756100                    STQ     I,,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:491  
     3198    11109    5                           END ; /* Whenreturn Do */

  11109  2 002267   002300 710000 2                  TRA     s:11118

     3199    11110    5                           WHENALTRETURN DO ;

     3200    11111    5                             NOT_DONE = %NO# ;

  11111  2 002270   200512 450100                    STZ     NOT_DONE,,AUTO

     3201    11112    5                             IF I = 3

  11112  2 002271   200343 235100                    LDA     I,,AUTO
         2 002272   000003 115007                    CMPA    3,DL
         2 002273   002276 601000 2                  TNZ     s:11116

     3202    11113    5                               THEN
     3203    11114    5                                   RETFLG = %NO# ;

  11114  2 002274   200513 450100                    STZ     RETFLG,,AUTO
         2 002275   002300 710000 2                  TRA     s:11118

     3204    11115    5                               ELSE
     3205    11116    5                                   RETFLG = %YES# ;

  11116  2 002276   400000 236003                    LDQ     -131072,DU
         2 002277   200513 756100                    STQ     RETFLG,,AUTO

     3206    11117    5                           END ; /* Whenaltreturn Do */

     3207    11118    4         END ; /* Do While */

  11118  2 002300   200512 234100                    SZN     NOT_DONE,,AUTO
         2 002301   002225 604000 2                  TMI     s:11095

     3208    11119
     3209    11120    3         IF NOT RETFLG
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:492  

  11120  2 002302   200513 234100                    SZN     RETFLG,,AUTO
         2 002303   002306 604000 2                  TMI     s:11124

     3210    11121    3             THEN
     3211    11122    3               ALTRETURN ;

  11122  2 002304   200506 221300                    LDX1  ! FPT_STATE+8,,AUTO
         2 002305   000000 702211                    TSX2  ! 0,X1

     3212    11123
     3213    11124    3         SUBSTR(LIMIT_BUF,CHR_POS) = LIMIT_COMMENT_FMT ;

  11124  2 002306   200510 720100                    LXL0    CHR_POS,,AUTO
         2 002307   777657 620010                    EAX0    -81,X0
         2 002310   777777 660003                    ERX0    -1,DU
         2 002311   200510 235100                    LDA     CHR_POS,,AUTO
         2 002312   040145 100400                    MLR     fill='040'O
         2 002313   000745 000022 1                  ADSC9   LIMIT_COMMENT_FMT        cn=0,n=18
         2 002314   200420 000010                    ADSC9   LIMIT_BUF,A,AUTO         cn=0,n=*X0

     3214    11125    3         I = I - 1 ;

  11125  2 002315   200343 236100                    LDQ     I,,AUTO
         2 002316   000001 136007                    SBLQ    1,DL
         2 002317   200343 756100                    STQ     I,,AUTO

     3215    11126    3         F_FDS.FMT_ = VECTOR(LIMIT_BUF) ;

  11126  2 002320   000102 235000 3                  LDA     66
         2 002321   200520 452500                    STP2    @START+2,,AUTO
         2 002322   200520 236100                    LDQ     @START+2,,AUTO
         2 002323   000420 036003                    ADLQ    272,DU
         2 002324   200007 755100                    STA     F_FDS,,AUTO
         2 002325   200010 756100                    STQ     F_FDS+1,,AUTO

     3216    11127    3         RETURN ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:493  

  11127  2 002326   200506 221300                    LDX1  ! FPT_STATE+8,,AUTO
         2 002327   000001 702211                    TSX2  ! 1,X1

     3217    11128
     3218    11129    3   END   SETUP_LIMIT_VECTOR ;
     3219    11130    2   END   OUTPUT_FINAL_STATUS ;
     3220    11131        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:494  
     3221    11132    1   OUTPUT_SYSID_IN_AND_RUN: PROC ;

  11132  2 002330   200504 741300       OUTPUT_SYSI* STX1  ! FPT_STATE+6,,AUTO

     3222    11133
     3223    11134    2         FMT_VEC(0) = VECTOR(BUF$->VLA$INPUT.SYSID) ;

  11134  2 002331   377640 235007                    LDA     130976,DL
         2 002332   200005 236100                    LDQ     BUF$,,AUTO
         2 002333   000010 036000 3                  ADLQ    8
         2 002334   200045 755100                    STA     FMT_VEC,,AUTO
         2 002335   200046 756100                    STQ     FMT_VEC+1,,AUTO

     3224    11135    2         FMT_VEC(1) = VECTOR(BUF$->VLA$INPUT.JNAME) ;

  11135  2 002336   000027 235000 3                  LDA     23
         2 002337   200005 236100                    LDQ     BUF$,,AUTO
         2 002340   000021 036003                    ADLQ    17,DU
         2 002341   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 002342   200050 756100                    STQ     FMT_VEC+3,,AUTO

     3225    11136    2         FMT_VEC(2) = VECTOR(BUF$->VLA$INPUT.ACCT) ;

  11136  2 002343   000011 235000 3                  LDA     9
         2 002344   200005 236100                    LDQ     BUF$,,AUTO
         2 002345   000010 036003                    ADLQ    8,DU
         2 002346   200051 755100                    STA     FMT_VEC+4,,AUTO
         2 002347   200052 756100                    STQ     FMT_VEC+5,,AUTO

     3226    11137    2         I = 2 ;

  11137  2 002350   000002 235007                    LDA     2,DL
         2 002351   200343 755100                    STA     I,,AUTO

     3227    11138    3         DO CASE(CH_XFORMAT.MSG#) ;

  11138  2 002352   200003 470500                    LDP0    @CH_XFORMAT,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:495  
         2 002353   000000 235100                    LDA     0,,PR0
         2 002354   000020 135007                    SBLA    16,DL
         2 002355   000007 115007                    CMPA    7,DL
         2 002356   002360 602005 2                  TNC     s:11138+6,AL
         2 002357   002631 710000 2                  TRA     s:11190
         2 002360   002367 710000 2                  TRA     s:11141
         2 002361   002465 710000 2                  TRA     s:11158
         2 002362   002550 710000 2                  TRA     s:11169
         2 002363   002567 710000 2                  TRA     s:11174
         2 002364   002573 710000 2                  TRA     s:11177
         2 002365   002577 710000 2                  TRA     s:11180
         2 002366   002603 710000 2                  TRA     s:11183

     3228    11139
     3229    11140    3             CASE(%CP_SYSID_RUN_MESS) ;

     3230    11141    3               F_FDS.FMT_ = VECTOR(SYSID_RUN_MESS_FMT) ;

  11141  2 002367   000140 237000 3                  LDAQ    96
         2 002370   200007 755100                    STA     F_FDS,,AUTO
         2 002371   200010 756100                    STQ     F_FDS+1,,AUTO

     3231    11142    3               STATE_BUF = '0'B ;

  11142  2 002372   000100 100400                    MLR     fill='000'O
         2 002373   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 002374   200350 000020                    ADSC9   STATE_BUF,,AUTO          cn=0,n=16

     3232    11143    3               STATE_BUF.ESC_Q = ' ' ;

  11143  2 002375   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 002376   200351 756100                    STQ     STATE_BUF+1,,AUTO

     3233    11144    3               STATE_BUF.TIME_REMAIN = BUF$ -> VLA$INPUT.TIM ;

  11144  2 002377   200005 471500                    LDP1    BUF$,,AUTO
         2 002400   100040 235100                    LDA     32,,PR1
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:496  
         2 002401   200353 755100                    STA     STATE_BUF+3,,AUTO

     3234    11145    3               FPT_STATE.V_ = VECTOR(FPT_STATE.V) ;

  11145  2 002402   000011 235000 3                  LDA     9
         2 002403   200520 452500                    STP2    @START+2,,AUTO
         2 002404   200520 236100                    LDQ     @START+2,,AUTO
         2 002405   000502 036003                    ADLQ    322,DU
         2 002406   200476 757100                    STAQ    FPT_STATE,,AUTO

     3235    11146    3               FPT_STATE.BUF_ = VECTOR(STATE_BUF) ;

  11146  2 002407   000026 235000 3                  LDA     22
         2 002410   200520 452500                    STP2    @START+2,,AUTO
         2 002411   200520 236100                    LDQ     @START+2,,AUTO
         2 002412   000350 036003                    ADLQ    232,DU
         2 002413   200500 757100                    STAQ    FPT_STATE+2,,AUTO

     3236    11147    3               FPT_STATE.V.SYSID# = BUF$ -> VLA$INPUT.SYSID ;

  11147  2 002414   100006 236100                    LDQ     6,,PR1
         2 002415   777777 376007                    ANQ     -1,DL
         2 002416   200502 756100                    STQ     FPT_STATE+4,,AUTO

     3237    11148
     3238    11149    3               CALL M$STATE(FPT_STATE) ALTRET (STATE_ERR) ;

  11149  2 002417   200476 630500                    EPPR0   FPT_STATE,,AUTO
         2 002420   420010 713400                    CLIMB   alt,+8200
         2 002421   400400 401760                    pmme    nvectors=2
         2 002422   002423 702000 2                  TSX2    STATE_ERR

     3239    11150    3   STATE_ERR:
     3240    11151    3               CALL CONVERT_TIME(STATE_BUF.TIME_REMAIN,TIME_BUF) ;

  11151  2 002423   200354 630500       STATE_ERR    EPPR0   TIME_BUF,,AUTO
         2 002424   200510 450500                    STP0    CHR_POS,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:497  
         2 002425   200353 631500                    EPPR1   STATE_BUF+3,,AUTO
         2 002426   200507 451500                    STP1    @MASK,,AUTO
         2 002427   001454 701000 2                  TSX1    CONVERT_TIME
         2 002430   000000 011000                    NOP     0

     3241    11152    3               FMT_VEC(I+1) = VECTOR(TIME_BUF) ;

  11152  2 002431   200343 235100                    LDA     I,,AUTO
         2 002432   000001 735000                    ALS     1
         2 002433   000000 620005                    EAX0    0,AL
         2 002434   000011 235000 3                  LDA     9
         2 002435   200520 452500                    STP2    @START+2,,AUTO
         2 002436   200520 236100                    LDQ     @START+2,,AUTO
         2 002437   000354 036003                    ADLQ    236,DU
         2 002440   200047 755110                    STA     FMT_VEC+2,X0,AUTO
         2 002441   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     3242    11153    3               CALL CONVERT_TIME(STATE_BUF.TIME_USED,TIME_BUF1) ;

  11153  2 002442   200356 630500                    EPPR0   TIME_BUF1,,AUTO
         2 002443   200510 450500                    STP0    CHR_POS,,AUTO
         2 002444   200352 631500                    EPPR1   STATE_BUF+2,,AUTO
         2 002445   200507 451500                    STP1    @MASK,,AUTO
         2 002446   001454 701000 2                  TSX1    CONVERT_TIME
         2 002447   000000 011000                    NOP     0

     3243    11154    3               FMT_VEC(I+2) = VECTOR(TIME_BUF1) ;

  11154  2 002450   200343 235100                    LDA     I,,AUTO
         2 002451   000001 735000                    ALS     1
         2 002452   000000 620005                    EAX0    0,AL
         2 002453   000011 235000 3                  LDA     9
         2 002454   200520 452500                    STP2    @START+2,,AUTO
         2 002455   200520 236100                    LDQ     @START+2,,AUTO
         2 002456   000356 036003                    ADLQ    238,DU
         2 002457   200051 755110                    STA     FMT_VEC+4,X0,AUTO
         2 002460   200052 756110                    STQ     FMT_VEC+5,X0,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:498  

     3244    11155    3               I = I + 2 ;

  11155  2 002461   200343 235100                    LDA     I,,AUTO
         2 002462   000002 035007                    ADLA    2,DL
         2 002463   200343 755100                    STA     I,,AUTO
         2 002464   002631 710000 2                  TRA     s:11190

     3245    11156
     3246    11157    3             CASE(%CP_SYSID_FOLL_MESS) ;

     3247    11158    3               F_FDS.FMT_ = VECTOR(SYSID_FOLL_MESS_FMT) ;

  11158  2 002465   000142 237000 3                  LDAQ    98
         2 002466   200007 755100                    STA     F_FDS,,AUTO
         2 002467   200010 756100                    STQ     F_FDS+1,,AUTO

     3248    11159    3               NFOLL = BUF$ -> VLA$INPUT.NFOLL - 1 ;

  11159  2 002470   200005 471500                    LDP1    BUF$,,AUTO
         2 002471   100006 236100                    LDQ     6,,PR1
         2 002472   000022 772000                    QRL     18
         2 002473   000777 376007                    ANQ     511,DL
         2 002474   000001 136007                    SBLQ    1,DL
         2 002475   200345 756100                    STQ     NFOLL,,AUTO

     3249    11160    3               FMT_VEC(I+1) = VECTOR(BUF$ -> VLA$INPUT.JDID.SYSID(0)) ;

  11160  2 002476   200343 235100                    LDA     I,,AUTO
         2 002477   000001 735000                    ALS     1
         2 002500   000000 620005                    EAX0    0,AL
         2 002501   377640 235007                    LDA     130976,DL
         2 002502   200005 236100                    LDQ     BUF$,,AUTO
         2 002503   000144 036000 3                  ADLQ    100
         2 002504   200047 755110                    STA     FMT_VEC+2,X0,AUTO
         2 002505   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:499  
     3250    11161    3               FMT_VEC(I+2) = VECTOR(NFOLL) ;

  11161  2 002506   200343 235100                    LDA     I,,AUTO
         2 002507   000001 735000                    ALS     1
         2 002510   000000 620005                    EAX0    0,AL
         2 002511   777640 235007                    LDA     -96,DL
         2 002512   200520 452500                    STP2    @START+2,,AUTO
         2 002513   200520 236100                    LDQ     @START+2,,AUTO
         2 002514   000345 036003                    ADLQ    229,DU
         2 002515   200051 755110                    STA     FMT_VEC+4,X0,AUTO
         2 002516   200052 756110                    STQ     FMT_VEC+5,X0,AUTO

     3251    11162    3               I = I + 2 ;

  11162  2 002517   200343 235100                    LDA     I,,AUTO
         2 002520   000002 035007                    ADLA    2,DL
         2 002521   200343 755100                    STA     I,,AUTO

     3252    11163    4               DO II = 1 TO NFOLL ;

  11163  2 002522   000001 236007                    LDQ     1,DL
         2 002523   200344 756100                    STQ     II,,AUTO
         2 002524   002544 710000 2                  TRA     s:11166+3

     3253    11164    4                 I = I + 1 ;

  11164  2 002525   200343 235100                    LDA     I,,AUTO
         2 002526   000001 035007                    ADLA    1,DL
         2 002527   200343 755100                    STA     I,,AUTO

     3254    11165    4                 FMT_VEC(I) = VECTOR(BUF$ -> VLA$INPUT.JDID.SYSID(II)) ;

  11165  2 002530   000001 735000                    ALS     1
         2 002531   000000 620005                    EAX0    0,AL
         2 002532   377640 235007                    LDA     130976,DL
         2 002533   200344 236100                    LDQ     II,,AUTO
         2 002534   000022 736000                    QLS     18
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:500  
         2 002535   000144 036000 3                  ADLQ    100
         2 002536   200005 036100                    ADLQ    BUF$,,AUTO
         2 002537   200045 755110                    STA     FMT_VEC,X0,AUTO
         2 002540   200046 756110                    STQ     FMT_VEC+1,X0,AUTO

     3255    11166    4               END ; /* DO I */

  11166  2 002541   200344 235100                    LDA     II,,AUTO
         2 002542   000001 035007                    ADLA    1,DL
         2 002543   200344 755100                    STA     II,,AUTO
         2 002544   200345 236100                    LDQ     NFOLL,,AUTO
         2 002545   200344 116100                    CMPQ    II,,AUTO
         2 002546   002525 603000 2                  TRC     s:11164
         2 002547   002631 710000 2                  TRA     s:11190

     3256    11167
     3257    11168    3             CASE(%CP_SYSID_RUNAFTER_MESS) ;

     3258    11169    3               F_FDS.FMT_ = VECTOR(SYSID_DEFERRED_MESS_FMT) ;

  11169  2 002550   000146 237000 3                  LDAQ    102
         2 002551   200007 755100                    STA     F_FDS,,AUTO
         2 002552   200010 756100                    STQ     F_FDS+1,,AUTO

     3259    11170    3               FMT_VEC(I+1) = VECTOR(BUF$->VLA$INPUT.RATIM) ;

  11170  2 002553   200343 235100                    LDA     I,,AUTO
         2 002554   000001 735000                    ALS     1
         2 002555   000000 620005                    EAX0    0,AL
         2 002556   777640 235007                    LDA     -96,DL
         2 002557   200005 236100                    LDQ     BUF$,,AUTO
         2 002560   000031 036003                    ADLQ    25,DU
         2 002561   200047 755110                    STA     FMT_VEC+2,X0,AUTO
         2 002562   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     3260    11171    3               I = I + 1 ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:501  
  11171  2 002563   200343 235100                    LDA     I,,AUTO
         2 002564   000001 035007                    ADLA    1,DL
         2 002565   200343 755100                    STA     I,,AUTO
         2 002566   002631 710000 2                  TRA     s:11190

     3261    11172
     3262    11173    3             CASE(%CP_SYSID_WPART_MESS) ;

     3263    11174    3               F_FDS.FMT_ = VECTOR(SYSID_WPART_MESS_FMT) ;

  11174  2 002567   000150 237000 3                  LDAQ    104
         2 002570   200007 755100                    STA     F_FDS,,AUTO
         2 002571   200010 756100                    STQ     F_FDS+1,,AUTO
         2 002572   002631 710000 2                  TRA     s:11190

     3264    11175
     3265    11176    3             CASE(%CP_SYSID_OTHER_MESS) ;

     3266    11177    3               F_FDS.FMT_ = VECTOR(SYSID_OTHER_MESS_FMT) ;

  11177  2 002573   000152 237000 3                  LDAQ    106
         2 002574   200007 755100                    STA     F_FDS,,AUTO
         2 002575   200010 756100                    STQ     F_FDS+1,,AUTO
         2 002576   002631 710000 2                  TRA     s:11190

     3267    11178
     3268    11179    3             CASE(%CP_SYSID_WPS_MESS) ;

     3269    11180    3               F_FDS.FMT_ = VECTOR(SYSID_WPS_MESS_FMT) ;

  11180  2 002577   000154 237000 3                  LDAQ    108
         2 002600   200007 755100                    STA     F_FDS,,AUTO
         2 002601   200010 756100                    STQ     F_FDS+1,,AUTO
         2 002602   002631 710000 2                  TRA     s:11190

     3270    11181
     3271    11182    3             CASE(%CP_SYSID_WAIT_MESS) ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:502  

     3272    11183    3               F_FDS.FMT_ = VECTOR(SYSID_WAIT_MESS_FMT) ;

  11183  2 002603   000156 237000 3                  LDAQ    110
         2 002604   200007 755100                    STA     F_FDS,,AUTO
         2 002605   200010 756100                    STQ     F_FDS+1,,AUTO

     3273    11184    3               FMT_VEC(I+1) = VECTOR(BUF$->VLA$INPUT.AHEAD) ;

  11184  2 002606   200343 235100                    LDA     I,,AUTO
         2 002607   000001 735000                    ALS     1
         2 002610   000000 620005                    EAX0    0,AL
         2 002611   777640 235007                    LDA     -96,DL
         2 002612   200005 236100                    LDQ     BUF$,,AUTO
         2 002613   000007 036003                    ADLQ    7,DU
         2 002614   200047 755110                    STA     FMT_VEC+2,X0,AUTO
         2 002615   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     3274    11185    3               FMT_VEC(I+2) = VECTOR(BUF$->VLA$INPUT.PRIO) ;

  11185  2 002616   200343 235100                    LDA     I,,AUTO
         2 002617   000001 735000                    ALS     1
         2 002620   000000 620005                    EAX0    0,AL
         2 002621   177640 235007                    LDA     65440,DL
         2 002622   200005 236100                    LDQ     BUF$,,AUTO
         2 002623   000145 036000 3                  ADLQ    101
         2 002624   200051 755110                    STA     FMT_VEC+4,X0,AUTO
         2 002625   200052 756110                    STQ     FMT_VEC+5,X0,AUTO

     3275    11186    3               I = I + 2 ;

  11186  2 002626   200343 235100                    LDA     I,,AUTO
         2 002627   000002 035007                    ADLA    2,DL
         2 002630   200343 755100                    STA     I,,AUTO

     3276    11187
     3277    11188    3         END ; /* DO CASE */
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:503  

     3278    11189
     3279    11190    2         IF (CH_XFORMAT.COMMENT# ~= ' ')

  11190  2 002631   200003 470500                    LDP0    @CH_XFORMAT,,AUTO
         2 002632   040000 106500                    CMPC    fill='040'O
         2 002633   000017 000030                    ADSC9   15,,PR0                  cn=0,n=24
         2 002634   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002635   002651 600000 2                  TZE     s:11196

     3280    11191    2           THEN
     3281    11192    3             DO ;

     3282    11193    3               FMT_VEC(I+1) = VECTOR(CH_XFORMAT.COMMENT#) ;

  11193  2 002636   200343 235100                    LDA     I,,AUTO
         2 002637   000001 735000                    ALS     1
         2 002640   000000 620005                    EAX0    0,AL
         2 002641   000103 235000 3                  LDA     67
         2 002642   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 002643   000017 036003                    ADLQ    15,DU
         2 002644   200047 755110                    STA     FMT_VEC+2,X0,AUTO
         2 002645   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     3283    11194    3               I = I + 1 ;

  11194  2 002646   200343 235100                    LDA     I,,AUTO
         2 002647   000001 035007                    ADLA    1,DL
         2 002650   200343 755100                    STA     I,,AUTO

     3284    11195    3             END ; /* THEN DO */

     3285    11196    2         F_FDS.NVECS# = I + 1 ;

  11196  2 002651   200343 235100                    LDA     I,,AUTO
         2 002652   000001 035007                    ADLA    1,DL
         2 002653   200020 755100                    STA     F_FDS+9,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:504  

     3286    11197
     3287    11198    2         RETURN ;

  11198  2 002654   200504 221300                    LDX1  ! FPT_STATE+6,,AUTO
         2 002655   000001 702211                    TSX2  ! 1,X1

     3288    11199
     3289    11200    2   END   OUTPUT_SYSID_IN_AND_RUN ;
     3290    11201        %EJECT ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:505  
     3291    11202    1   OUTPUT_SYSID_OQ:    PROC ;

  11202  2 002656   200504 741300       OUTPUT_SYSI* STX1  ! FPT_STATE+6,,AUTO

     3292    11203
     3293    11204    2         FMT_VEC(0) = VECTOR(BUF$ -> VLA$OUTPUT.SYSID) ;

  11204  2 002657   377640 235007                    LDA     130976,DL
         2 002660   200005 236100                    LDQ     BUF$,,AUTO
         2 002661   000005 036003                    ADLQ    5,DU
         2 002662   200045 755100                    STA     FMT_VEC,,AUTO
         2 002663   200046 756100                    STQ     FMT_VEC+1,,AUTO

     3294    11205    2         FMT_VEC(1) = VECTOR(BUF$ -> VLA$OUTPUT.NUM) ;

  11205  2 002664   377640 235007                    LDA     130976,DL
         2 002665   200005 236100                    LDQ     BUF$,,AUTO
         2 002666   000045 036000 3                  ADLQ    37
         2 002667   200047 755100                    STA     FMT_VEC+2,,AUTO
         2 002670   200050 756100                    STQ     FMT_VEC+3,,AUTO

     3295    11206    2         FMT_VEC(2) = VECTOR(BUF$ -> VLA$OUTPUT.JNAME) ;

  11206  2 002671   000027 235000 3                  LDA     23
         2 002672   200005 236100                    LDQ     BUF$,,AUTO
         2 002673   000013 036003                    ADLQ    11,DU
         2 002674   200051 755100                    STA     FMT_VEC+4,,AUTO
         2 002675   200052 756100                    STQ     FMT_VEC+5,,AUTO

     3296    11207    2         FMT_VEC(3) = VECTOR(BUF$ -> VLA$OUTPUT.ACCT) ;

  11207  2 002676   000011 235000 3                  LDA     9
         2 002677   200005 236100                    LDQ     BUF$,,AUTO
         2 002700   000011 036003                    ADLQ    9,DU
         2 002701   200053 755100                    STA     FMT_VEC+6,,AUTO
         2 002702   200054 756100                    STQ     FMT_VEC+7,,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:506  
     3297    11208    2         I = 3 ;

  11208  2 002703   000003 235007                    LDA     3,DL
         2 002704   200343 755100                    STA     I,,AUTO

     3298    11209    2         II = 16 ;

  11209  2 002705   000020 235007                    LDA     16,DL
         2 002706   200344 755100                    STA     II,,AUTO

     3299    11210    2         FMT_BUF = '%D-%D %<>A.%<>A' ;

  11210  2 002707   040100 100400                    MLR     fill='040'O
         2 002710   001415 000017 1                  ADSC9   DEV_TYPES+18             cn=0,n=15
         2 002711   200374 000120                    ADSC9   FMT_BUF,,AUTO            cn=0,n=80

     3300    11211    2         IF (BUF$->VLA$OUTPUT.DEVNAME = ' ')

  11211  2 002712   200005 470500                    LDP0    BUF$,,AUTO
         2 002713   000010 720100                    LXL0    8,,PR0
         2 002714   040040 100003                    CMPX0   16416,DU
         2 002715   002777 601000 2                  TNZ     s:11237

     3301    11212    2           THEN                                            /* Waiting to be output. */
     3302    11213    3             DO ;

     3303    11214    3               CALL GET_OUTPUT_TYPE(5,SH_OUT_TYPE_ARRY) ;

  11214  2 002716   000160 236000 3                  LDQ     112
         2 002717   200510 756100                    STQ     CHR_POS,,AUTO
         2 002720   000161 236000 3                  LDQ     113
         2 002721   200507 756100                    STQ     @MASK,,AUTO
         2 002722   001534 701000 2                  TSX1    GET_OUTPUT_TYPE
         2 002723   000000 011000                    NOP     0

     3304    11215    3               I = 5 ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:507  
  11215  2 002724   000005 235007                    LDA     5,DL
         2 002725   200343 755100                    STA     I,,AUTO

     3305    11216    3               CALL INSERT(FMT_BUF,II,8,'waiting') ;

  11216  2 002726   200344 236100                    LDQ     II,,AUTO
         2 002727   040106 100400                    MLR     fill='040'O
         2 002730   001421 000007 1                  ADSC9   DEV_TYPES+22             cn=0,n=7
         2 002731   200374 000010                    ADSC9   FMT_BUF,Q,AUTO           cn=0,n=8

     3306    11217    3               II = II + 8 ;

  11217  2 002732   000010 036007                    ADLQ    8,DL
         2 002733   200344 756100                    STQ     II,,AUTO

     3307    11218    3               IF (BUF$ -> VLA$OUTPUT.FLG.DEVAVAIL)

  11218  2 002734   200005 470500                    LDP0    BUF$,,AUTO
         2 002735   000004 236100                    LDQ     4,,PR0
         2 002736   040000 316003                    CANQ    16384,DU
         2 002737   002760 600000 2                  TZE     s:11228

     3308    11219    3                 THEN
     3309    11220    4                   DO ;

     3310    11221    4                     NUM_AHEAD = BUF$ -> VLA$OUTPUT.AHEAD ;

  11221  2 002740   000023 236100                    LDQ     19,,PR0
         2 002741   000022 772000                    QRL     18
         2 002742   200365 756100                    STQ     NUM_AHEAD,,AUTO

     3311    11222    4                     FMT_VEC(4) = VECTOR(NUM_AHEAD) ;

  11222  2 002743   777640 235007                    LDA     -96,DL
         2 002744   200520 452500                    STP2    @START+2,,AUTO
         2 002745   200520 236100                    LDQ     @START+2,,AUTO
         2 002746   000365 036003                    ADLQ    245,DU
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:508  
         2 002747   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 002750   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3312    11223    4                     CALL INSERT(FMT_BUF,II,11,'%D to %<>A') ;

  11223  2 002751   200344 235100                    LDA     II,,AUTO
         2 002752   040105 100400                    MLR     fill='040'O
         2 002753   001423 000012 1                  ADSC9   DEV_TYPES+24             cn=0,n=10
         2 002754   200374 000013                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=11

     3313    11224    4                     II = II + 11 ;

  11224  2 002755   000013 035007                    ADLA    11,DL
         2 002756   200344 755100                    STA     II,,AUTO

     3314    11225    4                   END ; /* THEN DO */

  11225  2 002757   002771 710000 2                  TRA     s:11232

     3315    11226    3                 ELSE
     3316    11227    4                   DO ;                                  /* Waiting NODEV. */

     3317    11228    4                     FMT_VEC(4) = VECTOR(NODEV_HDR) ;

  11228  2 002760   000162 237000 3                  LDAQ    114
         2 002761   200055 755100                    STA     FMT_VEC+8,,AUTO
         2 002762   200056 756100                    STQ     FMT_VEC+9,,AUTO

     3318    11229    4                     CALL INSERT(FMT_BUF,II,13,'%<>A to %<>A') ;

  11229  2 002763   200344 235100                    LDA     II,,AUTO
         2 002764   040105 100400                    MLR     fill='040'O
         2 002765   001426 000014 1                  ADSC9   DEV_TYPES+27             cn=0,n=12
         2 002766   200374 000015                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=13

     3319    11230    4                     II = II + 13 ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:509  
  11230  2 002767   000015 035007                    ADLA    13,DL
         2 002770   200344 755100                    STA     II,,AUTO

     3320    11231    4                   END ; /* ELSE DO */

     3321    11232    3                   CALL INSERT(FMT_BUF,II,3,'on') ;

  11232  2 002771   040105 100400                    MLR     fill='040'O
         2 002772   001431 000002 1                  ADSC9   DEV_TYPES+30             cn=0,n=2
         2 002773   200374 000003                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=3

     3322    11233    3                   II = II + 3 ;

  11233  2 002774   000003 035007                    ADLA    3,DL
         2 002775   200344 755100                    STA     II,,AUTO

     3323    11234    3             END ; /* THEN DO */

  11234  2 002776   003015 710000 2                  TRA     s:11242

     3324    11235    2           ELSE
     3325    11236    3             DO ;                                        /* Being output. */

     3326    11237    3                 CALL GET_OUTPUT_TYPE(4,LC_OUT_TYPE_ARRY) ;

  11237  2 002777   000164 236000 3                  LDQ     116
         2 003000   200510 756100                    STQ     CHR_POS,,AUTO
         2 003001   000165 236000 3                  LDQ     117
         2 003002   200507 756100                    STQ     @MASK,,AUTO
         2 003003   001534 701000 2                  TSX1    GET_OUTPUT_TYPE
         2 003004   000000 011000                    NOP     0

     3327    11238    3                 I = 4 ;

  11238  2 003005   000004 235007                    LDA     4,DL
         2 003006   200343 755100                    STA     I,,AUTO

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:510  
     3328    11239    3                 CALL INSERT(FMT_BUF,II,8,'%<>A on') ;

  11239  2 003007   200344 236100                    LDQ     II,,AUTO
         2 003010   040106 100400                    MLR     fill='040'O
         2 003011   001432 000007 1                  ADSC9   DEV_TYPES+31             cn=0,n=7
         2 003012   200374 000010                    ADSC9   FMT_BUF,Q,AUTO           cn=0,n=8

     3329    11240    3                 II = II + 8 ;

  11240  2 003013   000010 036007                    ADLQ    8,DL
         2 003014   200344 756100                    STQ     II,,AUTO

     3330    11241    3               END ; /* ELSE DO */

     3331    11242    2         FMT_VEC(I+1) = VECTOR(BUF$ -> VLA$OUTPUT.DEVTYP) ;

  11242  2 003015   200343 235100                    LDA     I,,AUTO
         2 003016   000001 735000                    ALS     1
         2 003017   000000 620005                    EAX0    0,AL
         2 003020   377640 235007                    LDA     130976,DL
         2 003021   200005 236100                    LDQ     BUF$,,AUTO
         2 003022   000002 036003                    ADLQ    2,DU
         2 003023   200047 755110                    STA     FMT_VEC+2,X0,AUTO
         2 003024   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     3332    11243    2         FMT_VEC(I+2) = VECTOR(BUF$ -> VLA$OUTPUT.DEVNAME) ;

  11243  2 003025   200343 235100                    LDA     I,,AUTO
         2 003026   000001 735000                    ALS     1
         2 003027   000000 620005                    EAX0    0,AL
         2 003030   377640 235007                    LDA     130976,DL
         2 003031   200005 236100                    LDQ     BUF$,,AUTO
         2 003032   000053 036000 3                  ADLQ    43
         2 003033   200051 755110                    STA     FMT_VEC+4,X0,AUTO
         2 003034   200052 756110                    STQ     FMT_VEC+5,X0,AUTO

     3333    11244    2         IF BUF$->VLA$OUTPUT.DEVNAME = ' '
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:511  

  11244  2 003035   200005 470500                    LDP0    BUF$,,AUTO
         2 003036   000010 720100                    LXL0    8,,PR0
         2 003037   040040 100003                    CMPX0   16416,DU
         2 003040   003052 601000 2                  TNZ     s:11248

     3334    11245    2             THEN
     3335    11246    2               FMT_VEC(I+3) = VECTOR(BUF$ -> VLA$OUTPUT.WOD) ;

  11246  2 003041   200343 235100                    LDA     I,,AUTO
         2 003042   000001 735000                    ALS     1
         2 003043   000000 621005                    EAX1    0,AL
         2 003044   000011 235000 3                  LDA     9
         2 003045   200005 236100                    LDQ     BUF$,,AUTO
         2 003046   000025 036003                    ADLQ    21,DU
         2 003047   200053 755111                    STA     FMT_VEC+6,X1,AUTO
         2 003050   200054 756111                    STQ     FMT_VEC+7,X1,AUTO
         2 003051   003061 710000 2                  TRA     s:11249

     3336    11247    2             ELSE
     3337    11248    2               FMT_VEC(I+3) = VECTOR(BUF$ -> VLA$OUTPUT.TNAME) ;

  11248  2 003052   200343 235100                    LDA     I,,AUTO
         2 003053   000001 735000                    ALS     1
         2 003054   000000 621005                    EAX1    0,AL
         2 003055   000011 235000 3                  LDA     9
         2 003056   200005 236100                    LDQ     BUF$,,AUTO
         2 003057   200053 755111                    STA     FMT_VEC+6,X1,AUTO
         2 003060   200054 756111                    STQ     FMT_VEC+7,X1,AUTO

     3338    11249    2         I = I + 3 ;

  11249  2 003061   200343 235100                    LDA     I,,AUTO
         2 003062   000003 035007                    ADLA    3,DL
         2 003063   200343 755100                    STA     I,,AUTO

     3339    11250    2         CALL INSERT(FMT_BUF,II,13,'%<>A%<>A@%<>A') ;
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:512  

  11250  2 003064   200344 236100                    LDQ     II,,AUTO
         2 003065   040106 100400                    MLR     fill='040'O
         2 003066   001434 000015 1                  ADSC9   DEV_TYPES+33             cn=0,n=13
         2 003067   200374 000015                    ADSC9   FMT_BUF,Q,AUTO           cn=0,n=13

     3340    11251    2         II = II + 13 ;

  11251  2 003070   000015 036007                    ADLQ    13,DL
         2 003071   200344 756100                    STQ     II,,AUTO

     3341    11252    2         STEPCC = CH_XFORMAT.STAT$ -> XSJ$JOBINFO.STEPCC# ;

  11252  2 003072   200003 471500                    LDP1    @CH_XFORMAT,,AUTO
         2 003073   100016 473500                    LDP3    14,,PR1
         2 003074   300000 236100                    LDQ     0,,PR3
         2 003075   000011 772000                    QRL     9
         2 003076   000777 376007                    ANQ     511,DL
         2 003077   200367 756100                    STQ     STEPCC,,AUTO

     3342    11253    2         IF STEPCC ~= 0

  11253  2 003100   003123 600000 2                  TZE     s:11261

     3343    11254    2             THEN
     3344    11255    3               DO ;

     3345    11256    3                 FMT_VEC(I+1) = VECTOR(STEPCC) ;

  11256  2 003101   200343 235100                    LDA     I,,AUTO
         2 003102   000001 735000                    ALS     1
         2 003103   000000 620005                    EAX0    0,AL
         2 003104   777640 235007                    LDA     -96,DL
         2 003105   200520 452500                    STP2    @START+2,,AUTO
         2 003106   200520 236100                    LDQ     @START+2,,AUTO
         2 003107   000367 036003                    ADLQ    247,DU
         2 003110   200047 755110                    STA     FMT_VEC+2,X0,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:513  
         2 003111   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     3346    11257    3                 CALL INSERT(FMT_BUF,II,15,' with STEPCC=%D') ;

  11257  2 003112   200344 235100                    LDA     II,,AUTO
         2 003113   040105 100400                    MLR     fill='040'O
         2 003114   001440 000017 1                  ADSC9   DEV_TYPES+37             cn=0,n=15
         2 003115   200374 000017                    ADSC9   FMT_BUF,A,AUTO           cn=0,n=15

     3347    11258    3                 II = II + 15 ;

  11258  2 003116   000017 035007                    ADLA    15,DL
         2 003117   200344 755100                    STA     II,,AUTO

     3348    11259    3                 I = I + 1 ;

  11259  2 003120   200343 236100                    LDQ     I,,AUTO
         2 003121   000001 036007                    ADLQ    1,DL
         2 003122   200343 756100                    STQ     I,,AUTO

     3349    11260    3               END ; /* THEN DO */

     3350    11261    2         IF (CH_XFORMAT.COMMENT# ~= ' ')

  11261  2 003123   040000 106500                    CMPC    fill='040'O
         2 003124   100017 000030                    ADSC9   15,,PR1                  cn=0,n=24
         2 003125   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 003126   003150 600000 2                  TZE     s:11269

     3351    11262    2           THEN
     3352    11263    3             DO ;

     3353    11264    3               FMT_VEC(I+1) = VECTOR(CH_XFORMAT.COMMENT#) ;

  11264  2 003127   200343 235100                    LDA     I,,AUTO
         2 003130   000001 735000                    ALS     1
         2 003131   000000 620005                    EAX0    0,AL
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:514  
         2 003132   000103 235000 3                  LDA     67
         2 003133   200003 236100                    LDQ     @CH_XFORMAT,,AUTO
         2 003134   000017 036003                    ADLQ    15,DU
         2 003135   200047 755110                    STA     FMT_VEC+2,X0,AUTO
         2 003136   200050 756110                    STQ     FMT_VEC+3,X0,AUTO

     3354    11265    3               I = I + 1 ;

  11265  2 003137   200343 235100                    LDA     I,,AUTO
         2 003140   000001 035007                    ADLA    1,DL
         2 003141   200343 755100                    STA     I,,AUTO

     3355    11266    3               CALL INSERT(FMT_BUF,II,7,' - %<>A') ;

  11266  2 003142   200344 236100                    LDQ     II,,AUTO
         2 003143   040106 100400                    MLR     fill='040'O
         2 003144   001444 000007 1                  ADSC9   DEV_TYPES+41             cn=0,n=7
         2 003145   200374 000007                    ADSC9   FMT_BUF,Q,AUTO           cn=0,n=7

     3356    11267    3               II = II + 7 ;

  11267  2 003146   000007 036007                    ADLQ    7,DL
         2 003147   200344 756100                    STQ     II,,AUTO

     3357    11268    3             END ; /* THEN DO */

     3358    11269    2         F_FDS.NVECS# = I + 1 ;

  11269  2 003150   200343 235100                    LDA     I,,AUTO
         2 003151   000001 035007                    ADLA    1,DL
         2 003152   200020 755100                    STA     F_FDS+9,,AUTO

     3359    11270    2         F_FDS.FMT_ = VECTOR(FMT_BUF) ;

  11270  2 003153   000102 235000 3                  LDA     66
         2 003154   200520 452500                    STP2    @START+2,,AUTO
         2 003155   200520 236100                    LDQ     @START+2,,AUTO
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:515  
         2 003156   000374 036003                    ADLQ    252,DU
         2 003157   200007 755100                    STA     F_FDS,,AUTO
         2 003160   200010 756100                    STQ     F_FDS+1,,AUTO

     3360    11271
     3361    11272    2         RETURN ;

  11272  2 003161   200504 221300                    LDX1  ! FPT_STATE+6,,AUTO
         2 003162   000001 702211                    TSX2  ! 1,X1
     3362    11273
     3363    11274    2   END   OUTPUT_SYSID_OQ ;
     3364    11275    1   END   CPK$CHECK_OUTPUT ;
     3365    11276        %EOD ;

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:516  
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   XSJ_MAC_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPK$CHECK_OUTPUT.
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:517  

 **** Variables and constants ****

  ****  Section 001 RoData CPK$CHECK_OUTPUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1346-0-0/c CHAR(5)     r     1 AHEAD_HDR                530-0-0/c CHAR(19)    r     1 APRESCAN_FMT1
   535-0-0/c CHAR(22)    r     1 APRESCAN_FMT2           1355-0-0/c CHAR        r     1 A_CHAR
    37-0-0/c CHAR        r     1 BELL                    1362-0-0/c CHAR        r     1 BLANK_CHAR
    36-0-0/c CHAR(4)     r     1 BLANK_FMT                  0-0-0/w STRC(1080)  r     1 CF_FDS
   543-0-0/c CHAR(15)    r     1 COMPLETED_FMT1           547-0-0/c CHAR(18)    r     1 COMPLETED_FMT2
  1373-0-0/c CHAR(4)     r     1 DEV_TYPES(0:4)
  1373-0-0/c CHAR(20)    r     1 DEV_TYPES_STR            103-0-0/c CHAR(72)    r     1 DFLT_OUTPUT_HDR
   102-0-0/c CHAR(3)     r     1 DFLT_OUTPUT_HDR_FMT     1356-0-0/c CHAR        r     1 D_CHAR
   743-0-0/c CHAR(5)     r     1 EXTRA_LIMITS_FMT        1154-0-0/c CHAR(20)    r     1 FIN_ABNORMAL
  1012-0-0/d BIT (72)    r     1 FIN_ABNORMAL_           1170-0-0/c CHAR(44)    r     1 FIN_ABNORMAL_UNKNOWN
  1016-0-0/d BIT (72)    r     1 FIN_ABNORMAL_UNKNOWN_
  1161-0-0/c CHAR(26)    r     1 FIN_COMPLETED           1014-0-0/d BIT (72)    r     1 FIN_COMPLETED_
  1147-0-0/c CHAR(18)    r     1 FIN_RECOVER             1010-0-0/d BIT (72)    r     1 FIN_RECOVER_
   652-0-0/c CHAR(39)    r     1 FMT1                     672-0-0/c CHAR(32)    r     1 FMTVEC
   702-0-0/c CHAR(47)    r     1 FMTVEC1                  666-0-0/d BIT (72)    r     1 FMTVEC1_
   716-0-0/c CHAR(59)    r     1 FMTVEC2                  670-0-0/d BIT (72)    r     1 FMTVEC2_
   664-0-0/d BIT (72)    r     1 FMTVEC_                 1360-0-0/c CHAR        r     1 F_CHAR
   562-0-0/c CHAR        r     1 HELD_LINE_FMT(0:79)
  1357-0-0/c CHAR        r     1 H_CHAR                    41-0-0/c CHAR(72)    r     1 INPUT_HDR
    40-0-0/c CHAR(3)     r     1 INPUT_HDR_FMT            125-0-0/c CHAR(70)    r     1 INPUT_MESS_FMT
   622-0-0/c CHAR(8)     r     1 LC_OUT_TYPE_ARRY(0:5)
   745-0-0/c CHAR(18)    r     1 LIMIT_COMMENT_FMT        735-0-0/c CHAR(23)    r     1 LIMIT_FMT_BUF
  1025-0-0/c CHAR(16)    r     1 MBS_CANCELED             754-0-0/d BIT (72)    r     1 MBS_CANCELED_
  1020-0-0/c CHAR(19)    r     1 MBS_DELETED              752-0-0/d BIT (72)    r     1 MBS_DELETED_
  1042-0-0/c CHAR(41)    r     1 MBS_FILERR               760-0-0/d BIT (72)    r     1 MBS_FILERR_
  1031-0-0/c CHAR(35)    r     1 MBS_SHAFTED              756-0-0/d BIT (72)    r     1 MBS_SHAFTED_
  1367-0-0/c CHAR(5)     r     1 NODEV_HDR               1371-0-0/c CHAR(5)     r     1 NODEV_HDR2
   467-0-0/c CHAR(12)    r     1 NONE_IN_MESS_FMT         465-0-0/c CHAR(7)     r     1 NONE_MESS_FMT
   476-0-0/c CHAR(13)    r     1 NONE_OUT_MESS_FMT        472-0-0/c CHAR(13)    r     1 NONE_RUN_MESS_FMT
   516-0-0/c CHAR(40)    r     1 NO_SUCH_MESS_HDR         507-0-0/c CHAR(28)    r     1 NO_TERM_OUT_HDR
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:518  
   554-0-0/c CHAR(6)     r     1 NUM_LISTED_HDR_FMT       556-0-0/c CHAR(14)    r     1 NUM_LISTED_MESS
   171-0-0/c CHAR(58)    r     1 OUTPUT_NOWAIT_MESS_FMT
   210-0-0/c CHAR(58)    r     1 OUTPUT_NOWAIT_MESS_FMT2
   227-0-0/c CHAR(61)    r     1 OUTPUT_WAIT_MESS_FMT
   247-0-0/c CHAR(61)    r     1 OUTPUT_WAIT_MESS_FMT2
   606-0-0/c CHAR(8)     r     1 OUT_TYPE_ARRY(0:5)
    37-0-0/b BIT (9)     r     1 O_BELL                  1361-0-0/c CHAR        r     1 O_CHAR
  1363-0-0/c CHAR        r     1 PART_ARRY(0:15)
  1055-0-0/c CHAR(27)    r     1 PRE_PASSED               762-0-0/d BIT (72)    r     1 PRE_PASSED_
  1104-0-0/c CHAR(42)    r     1 REJ_BADID                776-0-0/d BIT (72)    r     1 REJ_BADID_
  1075-0-0/c CHAR(9)     r     1 REJ_IO                   772-0-0/d BIT (72)    r     1 REJ_IO_
  1064-0-0/c CHAR(8)     r     1 REJ_JOB                 1100-0-0/c CHAR(13)    r     1 REJ_JOBIMBED
   774-0-0/d BIT (72)    r     1 REJ_JOBIMBED_            764-0-0/d BIT (72)    r     1 REJ_JOB_
  1137-0-0/c CHAR(32)    r     1 REJ_NOBATCH             1006-0-0/d BIT (72)    r     1 REJ_NOBATCH_
  1117-0-0/c CHAR(28)    r     1 REJ_NORES               1000-0-0/d BIT (72)    r     1 REJ_NORES_
  1126-0-0/c CHAR(15)    r     1 REJ_PRESCAN             1002-0-0/d BIT (72)    r     1 REJ_PRESCAN_
  1066-0-0/c CHAR(13)    r     1 REJ_RES                 1132-0-0/c CHAR(18)    r     1 REJ_RESIMBED
  1004-0-0/d BIT (72)    r     1 REJ_RESIMBED_            766-0-0/d BIT (72)    r     1 REJ_RES_
  1072-0-0/c CHAR(12)    r     1 REJ_SYNTAX               770-0-0/d BIT (72)    r     1 REJ_SYNTAX_
  1271-0-0/c CHAR(27)    r     1 RS_ABRT                 1330-0-0/c CHAR(16)    r     1 RS_CAN
  1250-0-0/d BIT (72)    r     1 RS_CAN_                 1317-0-0/c CHAR(15)    r     1 RS_DROP
  1300-0-0/c CHAR(19)    r     1 RS_EKEY                 1252-0-0/c CHAR(10)    r     1 RS_ERR
  1313-0-0/c CHAR(14)    r     1 RS_LIMX                 1305-0-0/c CHAR(23)    r     1 RS_OFF
  1260-0-0/c CHAR(35)    r     1 RS_SSP                  1323-0-0/c CHAR(19)    r     1 RS_XKEY
  1255-0-0/c CHAR(10)    r     1 RS_XXX                  1204-0-0/d BIT (72)    r     1 RS__(0:8)
    63-0-0/c CHAR(60)    r     1 RUN_HDR                  147-0-0/c CHAR(69)    r     1 RUN_MESS_FMT
  1350-0-0/c CHAR(3)     r     1 RUN_TEXT_HDR
   636-0-0/c CHAR(8)     r     1 SH_OUT_TYPE_ARRY(0:5)
   400-0-0/c CHAR(39)    r     1 SYSID_DEFERRED_MESS_FMT
   301-0-0/c CHAR(50)    r     1 SYSID_FOLL_MESS_FMT      332-0-0/c CHAR(51)    r     1 SYSID_OTHER_MESS_FMT
   267-0-0/c CHAR(39)    r     1 SYSID_RUN_MESS_FMT       363-0-0/c CHAR(50)    r     1 SYSID_WAIT_MESS_FMT
   316-0-0/c CHAR(45)    r     1 SYSID_WPART_MESS_FMT     347-0-0/c CHAR(47)    r     1 SYSID_WPS_MESS_FMT
   502-0-0/c CHAR(20)    r     1 TIME_DI_MESS_HDR        1342-0-0/c CHAR(2)     r     1 XL_DO
  1343-0-0/c CHAR(2)     r     1 XL_LO                   1341-0-0/c CHAR(4)     r     1 XL_PDISK
  1344-0-0/c CHAR(3)     r     1 XL_PLO                  1345-0-0/c CHAR(2)     r     1 XL_PO
  1335-0-0/c CHAR(5)     r     1 XL_STACK                1337-0-0/c CHAR(4)     r     1 XL_TAPE
  1340-0-0/c CHAR(4)     r     1 XL_TDISK                1334-0-0/c CHAR(4)     r     1 XL_TIME
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:519  
  1226-0-0/d BIT (72)    r     1 XL__(0:8)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CH_XFORMAT              507-0-0/w PTR         r     1 @CSECS
   515-0-0/w PTR         r     1 @MASK                    507-0-0/w PTR         r     1 @MASK
     4-0-0/w PTR         r     1 @NLINES                  516-0-0/w PTR         r     1 @START
   510-0-0/w PTR         r     1 @TIME_BUF                510-0-0/w PTR         r     1 @TYPE_ARRY
   507-0-0/w PTR         r     1 @VEC#                    346-0-0/w UBIN        r     1 BITSET
     5-0-0/w PTR         r     1 BUF$                     510-0-0/w UBIN        r     1 CHR_POS
    *0-0-0/w STRC(756)   r     1 CH_XFORMAT                *0-0-0/w SBIN        r     1 CSECS
   364-0-0/c CHAR(2)     r     1 DEVTYPE                  511-0-0/w UBIN        r     1 EXTRA_SZ
   374-0-0/c CHAR(80)    r     1 FMT_BUF                   45-0-0/b BIT (72)    r     1 FMT_VEC(0:75)
   460-0-0/d STRC(72)    r     1 FPT_DISPLAY              476-0-0/d STRC(216)   r     1 FPT_STATE
   462-0-0/d STRC(432)   r     1 FPT_TIME                   7-0-0/w STRC(1080)  r     1 F_FDS
   512-0-0/w SBIN        r     1 HOUR                     343-0-0/w UBIN        r     1 I
   344-0-0/w UBIN        r     1 II                       420-0-0/c CHAR(80)    r     1 LIMIT_BUF
    *0-0-0/b BIT         r     1 MASK(0:8)                 *0-0-0/b BIT (9)     r     1 MASK
   513-0-0/w SBIN        r     1 MIN                      445-0-0/w UBIN        r     1 NCHARS
   345-0-0/w UBIN        r     1 NFOLL                     *0-0-0/w UBIN        r     1 NLINES
   512-0-0/b BIT         r     1 NOT_DONE                 365-0-0/w UBIN        r     1 NUM_AHEAD
   275-0-0/c CHAR(150)   r     1 OUT_BUF                  360-0-0/c CHAR(16)    r     1 PART_BUF
   372-0-0/d BIT (72)    r     1 RECNO_                   513-0-0/b BIT         r     1 RETFLG
   514-0-0/w SBIN        r     1 SEC                      444-0-0/w UBIN        r     1 START
    *0-0-0/w UBIN        r     1 START                    350-0-0/w STRC(144)   r     1 STATE_BUF
   367-0-0/w UBIN        r     1 STEPCC                   370-0-0/d BIT (72)    r     1 STEPCC_
     6-0-0/w PTR         r     1 TEMP$                     *0-0-0/c STRC(72)    r     1 TIME_
   354-0-0/c CHAR(8)     r     1 TIME_BUF                  *0-0-0/c CHAR(8)     r     1 TIME_BUF
   356-0-0/c CHAR(8)     r     1 TIME_BUF1
    *0-0-0/c CHAR(8)     r     1 TYPE_ARRY(0:6)
   511-0-0/w UBIN        r     1 TYPE_NUM                 347-0-0/w SBIN        r     1 UTS
    *0-0-0/w UBIN        r     1 VEC#                     450-0-0/d STRC(252)   r     1 VLR_DISPLAY
   446-0-0/w UBIN        r     1 WIDTH

PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:520  
  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/d STRC(72)    r     1 CFPT_DISPLAY
     0-0-0/d STRC(432)   r     1 CFPT_TIME                  0-0-0/w PTR         r     1 SEG2$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 CH$PART(0:15)              0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(432)   r     1 FPT$WRITE                  0-0-0/w STRC(6264)  r     1 SEG$2
     0-0-0/w STRC(2304)  r     1 VLA$INPUT                  0-0-0/w STRC(1008)  r     1 VLA$OUTPUT
     0-0-0/w STRC(180)   r     1 XSJ$JOBINFO


   Procedure CPK$CHECK_OUTPUT requires 1651 words for executable code.
   Procedure CPK$CHECK_OUTPUT requires 338 words of local(AUTO) storage.
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:521  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:522  
          MINI XREF LISTING

ADD_COMMENT IN PROCEDURE OUTPUT_FINAL_STATUS
     11055**LABEL   11006--GOTO
AHEAD_HDR
     10316**DCL     10609--ASSIGN
APRESCAN_FMT1
     10200**DCL     10755--ASSIGN
APRESCAN_FMT2
     10201**DCL     10751--ASSIGN
A_CHAR
     10322**DCL     10570--ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       135**DCL       135--REDEF
B$JIT.ERR.MID
        42**DCL        42--REDEF
B$JIT.JRESPEAK
       203**DCL       204--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       312**DCL       312--REDEF     313--REDEF
B$JIT.PNR
       216**DCL       216--REDEF
B$JIT.TSLINE
       310**DCL       311--REDEF
B$JIT$
      8209**DCL        36--IMP-PTR
BELL
     10152**DCL     10810--ASSIGN
BITSET
     10454**DCL     11000>>ASSIGN  11071<<DOINDEX 11072>>IF      11096>>ASSIGN  11104>>ASSIGN
BLANK_CHAR
     10327**DCL     10568--ASSIGN  10571--ASSIGN  10574--ASSIGN  10577--ASSIGN  10631--ASSIGN
BLANK_FMT
     10150**DCL     10815--ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:523  
BUF$
     10023**DCL     10548<<ASSIGN  10557>>ASSIGN  10564>>ASSIGN  10565>>ASSIGN  10566>>IF      10569>>IF
     10572>>IF      10575>>IF      10578>>ASSIGN  10581>>ASSIGN  10582>>ASSIGN  10586>>ASSIGN  10594>>ASSIGN
     10595>>ASSIGN  10599>>IF      10602>>IF      10602>>IF      10606>>ASSIGN  10608>>IF      10615>>IF
     10615>>IF      10622>>ASSIGN  10623>>ASSIGN  10624>>ASSIGN  10625>>ASSIGN  10626>>ASSIGN  10627>>IF
     10632>>ASSIGN  10633>>ASSIGN  10634>>ASSIGN  10635>>IF      10637>>ASSIGN  10639>>ASSIGN  10640>>ASSIGN
     10641>>ASSIGN  10642>>ASSIGN  10916>>ASSIGN  11134>>ASSIGN  11135>>ASSIGN  11136>>ASSIGN  11144>>ASSIGN
     11147>>ASSIGN  11159>>ASSIGN  11160>>ASSIGN  11165>>ASSIGN  11170>>ASSIGN  11184>>ASSIGN  11185>>ASSIGN
     11204>>ASSIGN  11205>>ASSIGN  11206>>ASSIGN  11207>>ASSIGN  11211>>IF      11218>>IF      11221>>ASSIGN
     11242>>ASSIGN  11243>>ASSIGN  11244>>IF      11246>>ASSIGN  11248>>ASSIGN
CAMR_REC.ACSVEH_
      7248**DCL      7249--REDEF
CAMR_REC.ALTKEYS_
      7254**DCL      7255--REDEF    7255--REDEF
CAMR_REC.HDR_
      7253**DCL      7254--REDEF
CAMR_REC.TAB_
      7252**DCL      7253--REDEF
CAMR_REC.UHL_
      7246**DCL      7247--REDEF    7247--REDEF
CAMR_REC.V.FSN#
      7286**DCL      7286--REDEF    7286--REDEF
CAMR_REC.WSN_
      7252**DCL      7252--REDEF
CFPT_CLOSE.SN_
      6090**DCL      6090--REDEF
CFPT_CLOSE.UTL_
      6091**DCL      6091--REDEF
CFPT_CLOSE.V.EXPIRE#
      6105**DCL      6105--REDEF
CFPT_CLOSE.V.TYPE#
      6103**DCL      6103--REDEF
CFPT_CLOSE.V.XTNSIZE#
      6100**DCL      6100--REDEF    6102--REDEF
CFPT_DISPLAY
      5956**DCL     10793>>ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:524  
CFPT_OPEN.ACSVEH_
      6025**DCL      6026--REDEF
CFPT_OPEN.ALTKEYS_
      6031**DCL      6032--REDEF    6032--REDEF
CFPT_OPEN.HDR_
      6030**DCL      6031--REDEF
CFPT_OPEN.TAB_
      6029**DCL      6030--REDEF
CFPT_OPEN.UHL_
      6023**DCL      6024--REDEF    6024--REDEF
CFPT_OPEN.V.FSN#
      6063**DCL      6063--REDEF    6063--REDEF
CFPT_OPEN.WSN_
      6029**DCL      6029--REDEF
CFPT_READ.STATION_
      6129**DCL      6130--REDEF
CFPT_READ.V.DVBYTE.REREAD#
      6141**DCL      6141--REDEF
CFPT_READ.V.INDX#
      6139**DCL      6139--REDEF
CFPT_READUC.STATION_
      6499**DCL      6500--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
      6511**DCL      6511--REDEF
CFPT_READUC.V.INDX#
      6509**DCL      6509--REDEF
CFPT_TIME
      5937**DCL     10796>>ASSIGN
CFPT_TRTN.V.IR#
      6735**DCL      6736--REDEF
CFPT_WRITE.STATION_
      6167**DCL      6167--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      6174**DCL      6174--REDEF
CFPT_WRITEUC.STATION_
      6467**DCL      6467--REDEF
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:525  
CFPT_WRITEUC.V.DVBYTE.VFC#
      6474**DCL      6474--REDEF
CFPT_XXX.V.STEPCC#
      7447**DCL      7447--REDEF
CF_FDS
     10051**DCL     10543>>ASSIGN
CGETCMD.OUT$
      7468**DCL      7474--REDEF
CH$PART
      9902**DCL     10588>>IF
CHR_POS IN PROCEDURE SETUP_LIMIT_VECTOR
     11083**DCL     11089<<ASSIGN  11100>>ASSIGN  11102<<ASSIGN  11102>>ASSIGN  11124>>ASSIGN
CH_XFORMAT
      9783**DCL        23--PROC
CH_XFORMAT.ACCT#
      9786**DCL     10725>>IF      10736--ASSIGN  10777--ASSIGN  10927--ASSIGN
CH_XFORMAT.BUF$
      9790**DCL     10548>>ASSIGN  10929>>ASSIGN  10931>>ASSIGN  10932>>DOCASE  10993>>IF      10998>>CALL
     11003>>CALL    11031>>ASSIGN  11049>>ASSIGN
CH_XFORMAT.COMMENT#
      9792**DCL     10778>>IF      10782--ASSIGN  11055>>IF      11058--ASSIGN  11190>>IF      11193--ASSIGN
     11261>>IF      11264--ASSIGN
CH_XFORMAT.JOBNAME#
      9787**DCL     10717>>IF      10722--ASSIGN  10756--ASSIGN  10769--ASSIGN  10776--ASSIGN  10926--ASSIGN
CH_XFORMAT.MSG#
      9784**DCL     10550>>DOCASE  10553>>IF      10583>>IF      10805>>IF      11138>>DOCASE
CH_XFORMAT.NUM#
      9789**DCL     10674>>ASSIGN  10706>>IF      10711--ASSIGN  10775--ASSIGN
CH_XFORMAT.STAT$
      9791**DCL     11252>>ASSIGN
CH_XFORMAT.SYSID#
      9785**DCL     10699>>IF      10704--ASSIGN  10748>>IF      10752--ASSIGN  10761>>IF      10765--ASSIGN
     10774--ASSIGN  10820--ASSIGN  10925--ASSIGN
COMPLETED_FMT1
     10202**DCL     10768--ASSIGN
COMPLETED_FMT2
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:526  
     10203**DCL     10764--ASSIGN
CONVERT_TIME
     10857**PROC    10579--CALL    11151--CALL    11153--CALL
CPK$FDS_OUTPUT
     10029**DCL-ENT 10544--ASSIGN
CSECS IN PROCEDURE CONVERT_TIME
     10861**DCL     10857--PROC    10879>>ASSIGN
CVLP_TRMCTL.BREAKCOUNT
      7059**DCL      7060--REDEF
CVLP_WINDOW.FWINDOW#
      7155**DCL      7155--REDEF    7156--REDEF
DEVTYPE
     10464**DCL     10916<<ASSIGN  10917>>CALLBLT
DEV_TYPES IN PROCEDURE GET_OUTPUT_TYPE
     10907**DCL     10908--REDEF
DEV_TYPES_STR IN PROCEDURE GET_OUTPUT_TYPE
     10908**DCL     10917>>CALLBLT
DFLT_OUTPUT_HDR
     10159**DCL     10669--ASSIGN
DFLT_OUTPUT_HDR_FMT
     10158**DCL     10668--ASSIGN
D_CHAR
     10323**DCL     10576--ASSIGN
EXTRA_LIMITS_FMT
     10237**DCL     11090--ASSIGN  11100>>ASSIGN
EXTRA_SZ IN PROCEDURE SETUP_LIMIT_VECTOR
     11084**DCL     11090<<ASSIGN  11100>>ASSIGN  11102>>ASSIGN
F$DCB.ACTPOS
      9996**DCL      9996--REDEF
F$DCB.ARS#
      9970**DCL      9970--REDEF
F$DCB.ATTR
      9989**DCL      9990--REDEF
F$DCB.BORROW
     10004**DCL     10004--REDEF   10004--REDEF   10004--REDEF
F$DCB.DCBNAME.L
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:527  
     10018**DCL     10018--IMP-SIZ
F$DCB.EOMCHAR#
      9974**DCL      9974--REDEF
F$DCB.FLDID
      9999**DCL      9999--REDEF
F$DCB.FORM$
      9993**DCL      9993--REDEF
F$DCB.FSECT
     10009**DCL     10009--REDEF
F$DCB.FSN#
      9986**DCL      9986--REDEF    9986--REDEF    9987--REDEF
F$DCB.HEADER$
      9992**DCL      9992--REDEF
F$DCB.IXTNSIZE#
      9990**DCL      9990--REDEF
F$DCB.LASTSTA$
      9979**DCL      9979--REDEF
F$DCB.LVL
     10005**DCL     10005--REDEF
F$DCB.NAME#.C
      9980**DCL      9980--REDEF
F$DCB.NOEOF
     10002**DCL     10002--REDEF
F$DCB.NRECS#
      9991**DCL      9991--REDEF
F$DCB.NRECX
     10010**DCL     10010--REDEF
F$DCB.OHDR
     10002**DCL     10002--REDEF
F$DCB.ORG#
      9985**DCL      9985--REDEF
F$DCB.PRECNO
     10008**DCL     10008--REDEF
F$DCB.RCSZ
     10014**DCL     10014--REDEF
F$DCB.RES#
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:528  
      9981**DCL      9981--REDEF
F$DCB.SETX
      9993**DCL      9993--REDEF
F$DCB.TAB$
      9993**DCL      9993--REDEF
F$DCB.TDA
     10007**DCL     10008--REDEF
F$DCB.WIDTH#
      9977**DCL     10837>>ASSIGN
F$DCB.WSN#
      9981**DCL      9981--REDEF
FIN_ABNORMAL
     10274**DCL     10255--DCLINIT
FIN_ABNORMAL_
     10255**DCL     11024>>ASSIGN
FIN_ABNORMAL_UNKNOWN
     10276**DCL     10257--DCLINIT
FIN_ABNORMAL_UNKNOWN_
     10257**DCL     11019>>ASSIGN
FIN_COMPLETED
     10275**DCL     10256--DCLINIT
FIN_COMPLETED_
     10256**DCL     11014>>ASSIGN
FIN_RECOVER
     10273**DCL     10254--DCLINIT
FIN_RECOVER_
     10254**DCL     10990>>ASSIGN
FMT1
     10228**DCL     10773--ASSIGN
FMTVEC
     10232**DCL     10229--DCLINIT
FMTVEC1
     10233**DCL     10230--DCLINIT
FMTVEC1_
     10230**DCL     11042>>ASSIGN
FMTVEC2
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:529  
     10234**DCL     10231--DCLINIT
FMTVEC2_
     10231**DCL     11051>>ASSIGN
FMTVEC_
     10229**DCL     11036>>ASSIGN
FMT_BUF
     10470**DCL     10698<<ASSIGN  10702<<CALLBLT 10709<<CALLBLT 10720<<CALLBLT 10728>>IF      10731<<CALLBLT
     10734<<CALLBLT 10739>>IF      10741<<CALLBLT 10744--ASSIGN  11210<<ASSIGN  11216<<CALLBLT 11223<<CALLBLT
     11229<<CALLBLT 11232<<CALLBLT 11239<<CALLBLT 11250<<CALLBLT 11257<<CALLBLT 11266<<CALLBLT 11270--ASSIGN
FMT_VEC
     10449**DCL     10541<<ASSIGN  10545--ASSIGN  10557<<ASSIGN  10562<<ASSIGN  10564<<ASSIGN  10565<<ASSIGN
     10567<<ASSIGN  10568<<ASSIGN  10570<<ASSIGN  10571<<ASSIGN  10573<<ASSIGN  10574<<ASSIGN  10576<<ASSIGN
     10577<<ASSIGN  10580<<ASSIGN  10581<<ASSIGN  10582<<ASSIGN  10592<<ASSIGN  10594<<ASSIGN  10595<<ASSIGN
     10607<<ASSIGN  10609<<ASSIGN  10610<<ASSIGN  10622<<ASSIGN  10623<<ASSIGN  10624<<ASSIGN  10625<<ASSIGN
     10626<<ASSIGN  10629<<ASSIGN  10631<<ASSIGN  10632<<ASSIGN  10633<<ASSIGN  10634<<ASSIGN  10637<<ASSIGN
     10639<<ASSIGN  10640<<ASSIGN  10641<<ASSIGN  10642<<ASSIGN  10659<<ASSIGN  10664<<ASSIGN  10669<<ASSIGN
     10675<<ASSIGN  10676<<ASSIGN  10704<<ASSIGN  10711<<ASSIGN  10722<<ASSIGN  10736<<ASSIGN  10752<<ASSIGN
     10756<<ASSIGN  10765<<ASSIGN  10769<<ASSIGN  10774<<ASSIGN  10775<<ASSIGN  10776<<ASSIGN  10777<<ASSIGN
     10782<<ASSIGN  10801<<ASSIGN  10802<<ASSIGN  10803<<ASSIGN  10804<<ASSIGN  10810<<ASSIGN  10820<<ASSIGN
     10918<<ASSIGN  10925<<ASSIGN  10926<<ASSIGN  10927<<ASSIGN  10935<<ASSIGN  10938<<ASSIGN  10941<<ASSIGN
     10944<<ASSIGN  10947<<ASSIGN  10950<<ASSIGN  10954<<ASSIGN  10958<<ASSIGN  10962<<ASSIGN  10966<<ASSIGN
     10970<<ASSIGN  10974<<ASSIGN  10978<<ASSIGN  10982<<ASSIGN  10986<<ASSIGN  10990<<ASSIGN  10994<<ASSIGN
     11000<<ASSIGN  11001>>IF      11014<<ASSIGN  11019<<ASSIGN  11024<<ASSIGN  11031<<ASSIGN  11040<<ASSIGN
     11048<<ASSIGN  11049<<ASSIGN  11058<<ASSIGN  11096<<ASSIGN  11134<<ASSIGN  11135<<ASSIGN  11136<<ASSIGN
     11152<<ASSIGN  11154<<ASSIGN  11160<<ASSIGN  11161<<ASSIGN  11165<<ASSIGN  11170<<ASSIGN  11184<<ASSIGN
     11185<<ASSIGN  11193<<ASSIGN  11204<<ASSIGN  11205<<ASSIGN  11206<<ASSIGN  11207<<ASSIGN  11222<<ASSIGN
     11228<<ASSIGN  11242<<ASSIGN  11243<<ASSIGN  11246<<ASSIGN  11248<<ASSIGN  11256<<ASSIGN  11264<<ASSIGN
FPT$WRITE.BUF_.BOUND
      9949**DCL     10836>>ASSIGN
FPT$WRITE.STATION_
      9951**DCL      9951--REDEF
FPT$WRITE.V.DVBYTE.VFC#
      9958**DCL      9958--REDEF
FPT_DISPLAY
     10503**DCL     10793<<ASSIGN  10795<>CALL
FPT_DISPLAY.RESULTS_
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:530  
     10503**DCL     10794<<ASSIGN
FPT_STATE
     10535**DCL     11149<>CALL
FPT_STATE.BUF_
     10535**DCL     11146<<ASSIGN
FPT_STATE.V
     10535**DCL     11145--ASSIGN
FPT_STATE.V.SYSID#
     10536**DCL     11147<<ASSIGN
FPT_STATE.V_
     10535**DCL     11145<<ASSIGN
FPT_TIME
     10516**DCL     10796<<ASSIGN  10799<>CALL
FPT_TIME.TSTAMP_
     10519**DCL     10798<<ASSIGN
FPT_TIME.V
     10520**DCL     10797--ASSIGN
FPT_TIME.V_
     10516**DCL     10797<<ASSIGN
F_CHAR
     10325**DCL     10573--ASSIGN
F_FDS
     10350**DCL     10543<<ASSIGN  10832<>CALL
F_FDS.BUF_
     10367**DCL     10546<<ASSIGN
F_FDS.FMT_
     10354**DCL     10556<<ASSIGN  10561<<ASSIGN  10604<<ASSIGN  10605<<ASSIGN  10617<<ASSIGN  10618<<ASSIGN
     10658<<ASSIGN  10663<<ASSIGN  10668<<ASSIGN  10673<<ASSIGN  10680<<ASSIGN  10684<<ASSIGN  10688<<ASSIGN
     10692<<ASSIGN  10744<<ASSIGN  10751<<ASSIGN  10755<<ASSIGN  10764<<ASSIGN  10768<<ASSIGN  10773<<ASSIGN
     10800<<ASSIGN  10815<<ASSIGN  10819<<ASSIGN  10824<<ASSIGN  10828<<ASSIGN  11036<<ASSIGN  11042<<ASSIGN
     11051<<ASSIGN  11126<<ASSIGN  11141<<ASSIGN  11158<<ASSIGN  11169<<ASSIGN  11174<<ASSIGN  11177<<ASSIGN
     11180<<ASSIGN  11183<<ASSIGN  11270<<ASSIGN
F_FDS.NVECS#
     10378**DCL     10596<<ASSIGN  10643<<ASSIGN  10660<<ASSIGN  10665<<ASSIGN  10670<<ASSIGN  10677<<ASSIGN
     10681<<ASSIGN  10685<<ASSIGN  10689<<ASSIGN  10693<<ASSIGN  10743<<ASSIGN  10757<<ASSIGN  10770<<ASSIGN
     10785<<ASSIGN  10807<<ASSIGN  10811<<ASSIGN  10816<<ASSIGN  10821<<ASSIGN  10825<<ASSIGN  11061<<ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:531  
     11196<<ASSIGN  11269<<ASSIGN
F_FDS.OUTPUT#
     10404**DCL     10544<<ASSIGN
F_FDS.VECTR$
     10380**DCL     10545<<ASSIGN
F_FDS.WRITEFPT$
     10436**DCL     10836>>ASSIGN
GETBIT IN PROCEDURE OUTPUT_FINAL_STATUS
     11066**PROC    10998--CALL    11095--CALL
GET_OUTPUT_TYPE
     10899**PROC    10620--CALL    11214--CALL    11237--CALL
HELD_LINE_FMT
     10206**DCL     10824--ASSIGN
HOUR IN PROCEDURE CONVERT_TIME
     10873**DCL     10881<<ASSIGN  10884>>CALLBLT 10892>>IF      10893>>IF
H_CHAR
     10324**DCL     10629--ASSIGN
I
     10451**DCL     10587<<DOINDEX 10588>>IF      10589>>CALLBLT 10589>>CALLBLT 10590>>CALLBLT 10611<<ASSIGN
     10619<<ASSIGN  10620<>CALL    10622>>ASSIGN  10623>>ASSIGN  10624>>ASSIGN  10625>>ASSIGN  10626>>ASSIGN
     10629>>ASSIGN  10631>>ASSIGN  10632>>ASSIGN  10633>>ASSIGN  10634>>ASSIGN  10637>>ASSIGN  10639>>ASSIGN
     10640>>ASSIGN  10641>>ASSIGN  10642>>ASSIGN  10643>>ASSIGN  10674<<ASSIGN  10675--ASSIGN  10696<<ASSIGN
     10704>>ASSIGN  10705<<ASSIGN  10705>>ASSIGN  10711>>ASSIGN  10712<<ASSIGN  10712>>ASSIGN  10722>>ASSIGN
     10723<<ASSIGN  10723>>ASSIGN  10736>>ASSIGN  10737<<ASSIGN  10737>>ASSIGN  10743>>ASSIGN  10747<<ASSIGN
     10753<<ASSIGN  10756>>ASSIGN  10757>>ASSIGN  10760<<ASSIGN  10766<<ASSIGN  10769>>ASSIGN  10770>>ASSIGN
     10781<<ASSIGN  10784<<ASSIGN  10785>>ASSIGN  11035<<ASSIGN  11041<<ASSIGN  11050<<ASSIGN  11058>>ASSIGN
     11059<<ASSIGN  11059>>ASSIGN  11061>>ASSIGN  11092<<ASSIGN  11096>>ASSIGN  11097>>IF      11108<<ASSIGN
     11108>>ASSIGN  11112>>IF      11125<<ASSIGN  11125>>ASSIGN  11137<<ASSIGN  11152>>ASSIGN  11154>>ASSIGN
     11155<<ASSIGN  11155>>ASSIGN  11160>>ASSIGN  11161>>ASSIGN  11162<<ASSIGN  11162>>ASSIGN  11164<<ASSIGN
     11164>>ASSIGN  11165>>ASSIGN  11170>>ASSIGN  11171<<ASSIGN  11171>>ASSIGN  11184>>ASSIGN  11185>>ASSIGN
     11186<<ASSIGN  11186>>ASSIGN  11193>>ASSIGN  11194<<ASSIGN  11194>>ASSIGN  11196>>ASSIGN  11208<<ASSIGN
     11215<<ASSIGN  11238<<ASSIGN  11242>>ASSIGN  11243>>ASSIGN  11246>>ASSIGN  11248>>ASSIGN  11249<<ASSIGN
     11249>>ASSIGN  11256>>ASSIGN  11259<<ASSIGN  11259>>ASSIGN  11264>>ASSIGN  11265<<ASSIGN  11265>>ASSIGN
     11269>>ASSIGN
II
     10452**DCL     10697<<ASSIGN  10702>>CALLBLT 10703<<ASSIGN  10703>>ASSIGN  10709>>CALLBLT 10710<<ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:532  
     10710>>ASSIGN  10715<<ASSIGN  10715>>ASSIGN  10720>>CALLBLT 10721<<ASSIGN  10721>>ASSIGN  10728>>IF
     10731>>CALLBLT 10732<<ASSIGN  10732>>ASSIGN  10734>>CALLBLT 10735<<ASSIGN  10735>>ASSIGN  10739>>IF
     10740<<ASSIGN  10740>>ASSIGN  10741>>CALLBLT 10742<<ASSIGN  10742>>ASSIGN  11163<<DOINDEX 11165>>ASSIGN
     11209<<ASSIGN  11216>>CALLBLT 11217<<ASSIGN  11217>>ASSIGN  11223>>CALLBLT 11224<<ASSIGN  11224>>ASSIGN
     11229>>CALLBLT 11230<<ASSIGN  11230>>ASSIGN  11232>>CALLBLT 11233<<ASSIGN  11233>>ASSIGN  11239>>CALLBLT
     11240<<ASSIGN  11240>>ASSIGN  11250>>CALLBLT 11251<<ASSIGN  11251>>ASSIGN  11257>>CALLBLT 11258<<ASSIGN
     11258>>ASSIGN  11266>>CALLBLT 11267<<ASSIGN  11267>>ASSIGN
INPUT_HDR
     10154**DCL     10659--ASSIGN
INPUT_HDR_FMT
     10153**DCL     10658--ASSIGN  10663--ASSIGN
INPUT_MESS_FMT
     10161**DCL     10556--ASSIGN
LC_OUT_TYPE_ARRY
     10214**DCL     11237<>CALL
LIMIT_BUF
     10471**DCL     11088<<ASSIGN  11100<<ASSIGN  11124<<ASSIGN  11126--ASSIGN
LIMIT_COMMENT_FMT
     10238**DCL     11124>>ASSIGN
LIMIT_FMT_BUF
     10236**DCL     11088>>ASSIGN  11089--ASSIGN
M$DISPLAY
       393**DCL-ENT 10795--CALL
M$STATE
       394**DCL-ENT 11149--CALL
M$TIME
       393**DCL-ENT 10799--CALL
MASK IN PROCEDURE GETBIT
     11068**DCL     11066--PROC    11072>>IF
MASK IN PROCEDURE SETUP_LIMIT_VECTOR
     11082**DCL     11080--PROC    11095<>CALL
MBS_CANCELED
     10259**DCL     10240--DCLINIT
MBS_CANCELED_
     10240**DCL     10938>>ASSIGN
MBS_DELETED
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:533  
     10258**DCL     10239--DCLINIT
MBS_DELETED_
     10239**DCL     10935>>ASSIGN
MBS_FILERR
     10261**DCL     10242--DCLINIT
MBS_FILERR_
     10242**DCL     10944>>ASSIGN
MBS_SHAFTED
     10260**DCL     10241--DCLINIT
MBS_SHAFTED_
     10241**DCL     10941>>ASSIGN
MIN IN PROCEDURE CONVERT_TIME
     10874**DCL     10880<<ASSIGN  10881>>ASSIGN  10885>>CALLBLT 10891>>IF
NCHARS
     10473**DCL     10836<<ASSIGN  10841<<ASSIGN  10846>>DOWHILE 10847>>IF      10849<<ASSIGN  10849>>ASSIGN
     10851<<ASSIGN
NFOLL
     10453**DCL     11159<<ASSIGN  11161--ASSIGN  11163>>DOINDEX
NLINES
      9794**DCL        23--PROC    10833--IF      10842<<ASSIGN  10845<<ASSIGN  10852<<ASSIGN  10852>>ASSIGN
NODEV_HDR
     10330**DCL     11228--ASSIGN
NODEV_HDR2
     10331**DCL     10610--ASSIGN
NOFRS IN PROCEDURE OUTPUT_FINAL_STATUS
     11024**LABEL   10998--CALLALT
NONE_IN_MESS_FMT
     10194**DCL     10680--ASSIGN
NONE_MESS_FMT
     10193**DCL     10692--ASSIGN
NONE_OUT_MESS_FMT
     10196**DCL     10688--ASSIGN
NONE_RUN_MESS_FMT
     10195**DCL     10684--ASSIGN
NOT_DONE IN PROCEDURE SETUP_LIMIT_VECTOR
     11085**DCL     11091<<ASSIGN  11094>>DOWHILE 11107<<ASSIGN  11111<<ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:534  
NO_SUCH_MESS_HDR
     10199**DCL     10828--ASSIGN
NO_TERM_OUT_HDR
     10198**DCL     10819--ASSIGN
NUM_AHEAD
     10465**DCL     10606<<ASSIGN  10607--ASSIGN  11221<<ASSIGN  11222--ASSIGN
NUM_LISTED_HDR_FMT
     10204**DCL     10673--ASSIGN
NUM_LISTED_MESS
     10205**DCL     10676--ASSIGN
OUTPUT_FINAL_STATUS
     10923**PROC    10789--CALL
OUTPUT_NOWAIT_MESS_FMT
     10165**DCL     10618--ASSIGN
OUTPUT_NOWAIT_MESS_FMT2
     10167**DCL     10617--ASSIGN
OUTPUT_SYSID_IN_AND_RUN
     11132**PROC    10652--CALL
OUTPUT_SYSID_OQ
     11202**PROC    10655--CALL
OUTPUT_WAIT_MESS_FMT
     10169**DCL     10605--ASSIGN
OUTPUT_WAIT_MESS_FMT2
     10171**DCL     10604--ASSIGN
OUT_BUF
     10450**DCL     10542<<ASSIGN  10546--ASSIGN
OUT_TYPE_ARRY
     10207**DCL     10620<>CALL
O_BELL
     10151**DCL     10152--REDEF
O_CHAR
     10326**DCL     10567--ASSIGN
PART_ARRY
     10328**DCL     10589>>CALLBLT
PART_BUF
     10463**DCL     10589<<CALLBLT 10590<<CALLBLT 10592--ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:535  
PRE_PASSED
     10262**DCL     10243--DCLINIT
PRE_PASSED_
     10243**DCL     10947>>ASSIGN
RECNO_
     10469**DCL     10931<<ASSIGN  11048>>ASSIGN
REJECTED_MSG IN PROCEDURE OUTPUT_FINAL_STATUS
     11048**LABEL   10951--GOTO    10955--GOTO    10959--GOTO    10963--GOTO    10967--GOTO    10971--GOTO
     10975--GOTO    10979--GOTO    10983--GOTO    10987--GOTO
REJ_BADID
     10268**DCL     10249--DCLINIT
REJ_BADID_
     10249**DCL     10970>>ASSIGN
REJ_IO
     10266**DCL     10247--DCLINIT
REJ_IO_
     10247**DCL     10962>>ASSIGN
REJ_JOB
     10263**DCL     10244--DCLINIT
REJ_JOBIMBED
     10267**DCL     10248--DCLINIT
REJ_JOBIMBED_
     10248**DCL     10966>>ASSIGN
REJ_JOB_
     10244**DCL     10950>>ASSIGN
REJ_NOBATCH
     10272**DCL     10253--DCLINIT
REJ_NOBATCH_
     10253**DCL     10986>>ASSIGN
REJ_NORES
     10269**DCL     10250--DCLINIT
REJ_NORES_
     10250**DCL     10974>>ASSIGN
REJ_PRESCAN
     10270**DCL     10251--DCLINIT
REJ_PRESCAN_
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:536  
     10251**DCL     10978>>ASSIGN
REJ_RES
     10264**DCL     10245--DCLINIT
REJ_RESIMBED
     10271**DCL     10252--DCLINIT
REJ_RESIMBED_
     10252**DCL     10982>>ASSIGN
REJ_RES_
     10245**DCL     10954>>ASSIGN
REJ_SYNTAX
     10265**DCL     10246--DCLINIT
REJ_SYNTAX_
     10246**DCL     10958>>ASSIGN
RETFLG IN PROCEDURE SETUP_LIMIT_VECTOR
     11086**DCL     11114<<ASSIGN  11116<<ASSIGN  11120>>IF
RS_ABRT
     10300**DCL     10281--DCLINIT
RS_CAN
     10306**DCL     10296--DCLINIT
RS_CAN_
     10296**DCL     10994>>ASSIGN
RS_DROP
     10304**DCL     10285--DCLINIT
RS_EKEY
     10301**DCL     10282--DCLINIT
RS_ERR
     10297**DCL     10278--DCLINIT
RS_LIMX
     10303**DCL     10284--DCLINIT 11001--IF
RS_OFF
     10302**DCL     10283--DCLINIT
RS_SSP
     10299**DCL     10280--DCLINIT
RS_XKEY
     10305**DCL     10286--DCLINIT
RS_XXX
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:537  
     10298**DCL     10279--DCLINIT
RS__
     10278**DCL     11000>>ASSIGN
RUN_HDR
     10156**DCL     10664--ASSIGN
RUN_MESS_FMT
     10163**DCL     10561--ASSIGN
RUN_TEXT_HDR
     10317**DCL     10562--ASSIGN
SEC IN PROCEDURE CONVERT_TIME
     10875**DCL     10879<<ASSIGN  10880>>ASSIGN  10886>>CALLBLT
SEG$2.LLDCB#
      9863**DCL     10837--ASSIGN
SEG2$
      8202**DCL      9843--IMP-PTR 10837>>ASSIGN
SETUP_LIMIT_VECTOR IN PROCEDURE OUTPUT_FINAL_STATUS
     11080**PROC    11003--CALL
SH_OUT_TYPE_ARRY
     10221**DCL     11214<>CALL
SIMPLE_MSG IN PROCEDURE OUTPUT_FINAL_STATUS
     11031**LABEL   11009--GOTO
START
     10472**DCL     10997<<ASSIGN  10998<>CALL    11095<>CALL    11104<<ASSIGN  11105>>IF
START IN PROCEDURE GETBIT
     11069**DCL     11066--PROC    11071>>DOINDEX
STATE_BUF
     10456**DCL     11142<<ASSIGN  11146--ASSIGN
STATE_BUF.ESC_Q
     10458**DCL     11143<<ASSIGN
STATE_BUF.TIME_REMAIN
     10460**DCL     11144<<ASSIGN  11151<>CALL
STATE_BUF.TIME_USED
     10459**DCL     11153<>CALL
STATE_ERR IN PROCEDURE OUTPUT_SYSID_IN_AND_RUN
     11151**LABEL   11149--CALLALT
STEPCC
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:538  
     10467**DCL     10929<<ASSIGN  11015>>IF      11016--ASSIGN  11025>>IF      11026--ASSIGN  11252<<ASSIGN
     11253>>IF      11256--ASSIGN
STEPCC_
     10468**DCL     10930<<ASSIGN  11016<<ASSIGN  11026<<ASSIGN  11032>>IF      11040>>ASSIGN
SYSID_DEFERRED_MESS_FMT
     10185**DCL     11169--ASSIGN
SYSID_FOLL_MESS_FMT
     10175**DCL     11158--ASSIGN
SYSID_OTHER_MESS_FMT
     10179**DCL     11177--ASSIGN
SYSID_RUN_MESS_FMT
     10173**DCL     11141--ASSIGN
SYSID_WAIT_MESS_FMT
     10183**DCL     11183--ASSIGN
SYSID_WPART_MESS_FMT
     10177**DCL     11174--ASSIGN
SYSID_WPS_MESS_FMT
     10181**DCL     11180--ASSIGN
TEMP$
     10024**DCL     10586<<ASSIGN  10588>>IF
TIME_.HR IN PROCEDURE CONVERT_TIME
     10864**DCL     10884<<CALLBLT
TIME_.MIN IN PROCEDURE CONVERT_TIME
     10866**DCL     10885<<CALLBLT
TIME_.SEC IN PROCEDURE CONVERT_TIME
     10868**DCL     10886<<CALLBLT
TIME_BUF
     10461**DCL     10579<>CALL    10580--ASSIGN  11151<>CALL    11152--ASSIGN
TIME_BUF IN PROCEDURE CONVERT_TIME
     10862**DCL     10857--PROC    10863--REDEF   10883<<ASSIGN  10891<<ASSIGN  10892<<ASSIGN  10893<<ASSIGN
TIME_BUF1
     10462**DCL     11153<>CALL    11154--ASSIGN
TIME_DI_MESS_HDR
     10197**DCL     10800--ASSIGN
TYPE_ARRY IN PROCEDURE GET_OUTPUT_TYPE
     10904**DCL     10899--PROC    10918--ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:539  
TYPE_NUM IN PROCEDURE GET_OUTPUT_TYPE
     10912**DCL     10917<<CALLBLT 10918>>ASSIGN
UTS
     10455**DCL     10578<<ASSIGN  10579<>CALL    10798--ASSIGN  10801--ASSIGN
VEC# IN PROCEDURE GET_OUTPUT_TYPE
     10903**DCL     10899--PROC    10918>>ASSIGN
VLA$INPUT.ACCT
      9817**DCL     10582--ASSIGN  11136--ASSIGN
VLA$INPUT.AHEAD
      9817**DCL     10557--ASSIGN  11184--ASSIGN
VLA$INPUT.FLG.ACC
      9814**DCL     10569>>IF
VLA$INPUT.FLG.O1
      9813**DCL     10566>>IF
VLA$INPUT.FLG.O3
      9814**DCL     10572>>IF
VLA$INPUT.FLG.RA
      9816**DCL     10575>>IF
VLA$INPUT.IPRIO
      9812**DCL     10564--ASSIGN
VLA$INPUT.JDID.SYSID
      9822**DCL     11160--ASSIGN  11165--ASSIGN
VLA$INPUT.JNAME
      9819**DCL     10595--ASSIGN  11135--ASSIGN
VLA$INPUT.NFOLL
      9816**DCL     11159>>ASSIGN
VLA$INPUT.PART
      9811**DCL     10586--ASSIGN
VLA$INPUT.PNUM
      9811**DCL     10594--ASSIGN
VLA$INPUT.PRIO
      9812**DCL     11185--ASSIGN
VLA$INPUT.RATIM
      9819**DCL     11170--ASSIGN
VLA$INPUT.RRT
      9820**DCL     10581--ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:540  
VLA$INPUT.SYSID
      9817**DCL     10565--ASSIGN  11134--ASSIGN  11147>>ASSIGN
VLA$INPUT.TIM
      9820**DCL     10578>>ASSIGN  11144>>ASSIGN
VLA$OUTPUT.ACCT
      9839**DCL     10624--ASSIGN  11207--ASSIGN
VLA$OUTPUT.AHEAD
      9839**DCL     10606>>ASSIGN  11221>>ASSIGN
VLA$OUTPUT.COPIES
      9836**DCL     10626--ASSIGN
VLA$OUTPUT.DEVNAME
      9838**DCL     10599>>IF      10635>>IF      10641--ASSIGN  11211>>IF      11243--ASSIGN  11244>>IF
VLA$OUTPUT.DEVTYP
      9836**DCL     10640--ASSIGN  10916>>ASSIGN  11242--ASSIGN
VLA$OUTPUT.FLG.DEVAVAIL
      9837**DCL     10608>>IF      11218>>IF
VLA$OUTPUT.FLG.SAP
      9837**DCL     10627>>IF
VLA$OUTPUT.FORM
      9838**DCL     10634--ASSIGN
VLA$OUTPUT.GRANS
      9838**DCL     10633--ASSIGN
VLA$OUTPUT.JNAME
      9839**DCL     10642--ASSIGN  11206--ASSIGN
VLA$OUTPUT.NUM
      9838**DCL     10602>>IF      10615>>IF      10623--ASSIGN  11205--ASSIGN
VLA$OUTPUT.PRIO
      9836**DCL     10625--ASSIGN
VLA$OUTPUT.SAPCOPIES
      9836**DCL     10632--ASSIGN
VLA$OUTPUT.SYSID
      9838**DCL     10602>>IF      10615>>IF      10622--ASSIGN  11204--ASSIGN
VLA$OUTPUT.TNAME
      9836**DCL     10639--ASSIGN  11248--ASSIGN
VLA$OUTPUT.WOD
      9839**DCL     10637--ASSIGN  11246--ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:541  
VLR_DISPLAY
     10489**DCL     10794--ASSIGN
VLR_DISPLAY.ETMF
     10489**DCL     10803--ASSIGN
VLR_DISPLAY.RESP
     10489**DCL     10804--ASSIGN
VLR_DISPLAY.USERS
     10489**DCL     10802--ASSIGN
WIDTH
     10474**DCL     10837<<ASSIGN  10838>>IF      10847>>IF      10849>>ASSIGN
X$FORMAT
     10028**DCL-ENT 10832--CALL
XL_DO
     10312**DCL     10292--DCLINIT
XL_LO
     10313**DCL     10293--DCLINIT
XL_PDISK
     10311**DCL     10291--DCLINIT
XL_PLO
     10314**DCL     10294--DCLINIT
XL_PO
     10315**DCL     10295--DCLINIT
XL_STACK
     10308**DCL     10288--DCLINIT
XL_TAPE
     10309**DCL     10289--DCLINIT
XL_TDISK
     10310**DCL     10290--DCLINIT
XL_TIME
     10307**DCL     10287--DCLINIT
XL__
     10287**DCL     11096>>ASSIGN
XSJ$JOBINFO.FRS#
      9928**DCL     10993>>IF      10998<>CALL
XSJ$JOBINFO.OFF_TIME#
      9929**DCL     11031--ASSIGN  11049--ASSIGN
PL6.E3A0      #002=CPK$CHECK_OUTPUT File=CPK$CHECK.:E05TSI                       TUE 07/29/97 11:57 Page:542  
XSJ$JOBINFO.RECNO#
      9929**DCL     10931--ASSIGN
XSJ$JOBINFO.STATUS#
      9929**DCL     10932>>DOCASE
XSJ$JOBINFO.STEPCC#
      9928**DCL     10929>>ASSIGN  11252>>ASSIGN
XSJ$JOBINFO.XLIMFLG#
      9928**DCL     11003<>CALL

PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:543  
     3366        1        /*T***********************************************************/
     3367        2        /*T*                                                         */
     3368        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3369        4        /*T*                                                         */
     3370        5        /*T***********************************************************/
     3371        6        /**********************************************************************/
     3372        7        /*F*   NAME:   CPK$FDS_OUTPUT
     3373        8               PURPOSE: To call M$WRITE for X$FORMAT.  In this way any ALTRETURNs
     3374        9                       from M$WRITE can be handled.  CPK$FDS_OUTPUT always ALTRETs
     3375       10                       back to X$FORMAT.
     3376       11               DESCRIPTION: CPK$FDS_OUTPUT is called by X$FORMAT, if IBEX does not
     3377       12                       have any error posted, the M$WRITE will be performed,
     3378       13                       otherwise, no call to M$WRITE will be done.
     3379       14        */
     3380       15        /*D*   NAME:   CPK$FDS_OUTPUT
     3381       16               CALL:   CALL CPK$FDS_OUTPUT(OUTBUF_VEC,F_FDS) ;
     3382       17               INTERFACE: X$FORMAT
     3383       18               INPUT:  OUTBUF_VEC  - is a vector framing the buffer used by X$FORMAT.
     3384       19                       F_FDS       - is the data block used by X$FORMAT.
     3385       20               DESCRIPTION: If IBEX does not have any errors posted, IBEX will
     3386       21                       call M$WRITE, then CPK$FDS_OUTPUT altreturns to X$FORMAT.
     3387       22        */
     3388       23        /**********************************************************************/
     3389       24        CPK$FDS_OUTPUT: PROC (OUTBUF_VEC,F_FDS) ALTRET ;
     3390       25
     3391       26             /***** Includes *****/
     3392       27
     3393       28        %INCLUDE CP_6 ;
     3394      109        %INCLUDE CP_6_SUBS ;
     3395      649        %INCLUDE XU_FORMAT_C ;
     3396      811        %INCLUDE B_MACROS_C ;
     3397      922        %INCLUDE CP_MACROS_C ;
     3398     1674        %INCLUDE XU_MACRO_C ;
     3399     4780        %INCLUDE CP_DATA_R ;
     3400     7343        %INCLUDE B_ERRORS_C ;
     3401     8470        %INCLUDE CP_PERR_C ;
     3402     8808
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:544  
     3403     8809             /***** Entries *****/
     3404     8810
     3405     8811    1   DCL CXP$POSTERR ENTRY(5);
     3406     8812
     3407     8813             /***** Parameters *****/
     3408     8814
     3409     8815    1   DCL OUTBUF_VEC VECTOR PARAM ;
     3410     8816        %F_FDS (STCLASS=PARAM) ;
     3411     8929
     3412     8930             /***** Based declarations *****/
     3413     8931
     3414     8932        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED) ;
     3415     8963        %ERR_BLK (NAME=ERR$BLK, STCLASS=BASED) ;
     3416     8988        %B$TCB (STCLASS="BASED(B$TCB$)") ;
     3417     8991        %B$ALT ;
     3418     8999        %B$EXCFR ;
     3419     9017        %SEG$2 ;
     3420     9077
     3421     9078             /***** Auto declarations *****/
     3422     9079
     3423     9080        %FPT_WRITE (FPTN=FPT_WRITE,STCLASS=AUTO) ;
     3424     9111    1   DCL DCB# UBIN WORD ;
     3425     9112        %VLP_ERRCODE (FPTN=E_LLSET2KEYF,MID=K,ERR#=E$LLSET2KEYF,FCG=CP,STCLASS=CONSTANT);
     3426     9157        %VLP_ERRCODE (FPTN=ERR_CODE, STCLASS=AUTO) ;
     3427     9202
     3428     9203             /***** Procedure *****/
     3429     9204
     3430     9205    1         IF ADDR(SEG$2.ERRBUF)->ERR$BLK.FIRST = 0
     3431     9206    1             THEN
     3432     9207    2               DO ;
     3433     9208    2                 FPT_WRITE = F_FDS.WRITEFPT$->FPT$WRITE ;
     3434     9209    2                 FPT_WRITE.V_ = VECTOR(FPT_WRITE.V) ;
     3435     9210    2                 FPT_WRITE.V.DCB# = SEG2$->SEG$2.LLDCB# ;
     3436     9211    2                 CALL M$WRITE (FPT_WRITE) WHENALTRETURN
     3437     9212    3                         DO ;
     3438     9213    3                           DCB# = FPT_WRITE.V.DCB# ;
     3439     9214    3                           IF B$TCB.ALT$->B$EXCFR.ERR.ERR# = %E$WRWOKEY
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:545  
     3440     9215    3                             THEN
     3441     9216    3                               ERR_CODE = E_LLSET2KEYF ;
     3442     9217    3                             ELSE
     3443     9218    3                               ERR_CODE = B$TCB.ALT$->B$EXCFR.ERR ;
     3444     9219    3                           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511,
     3445     9220    3                                 ERR_CODE,,DCB#) ;
     3446     9221    3                         END ; /* Whenaltreturn Do */
     3447     9222    2                 END ; /* Then Do */
     3448     9223
     3449     9224    1         ALTRETURN ;
     3450     9225        /*E*       ERROR:   CPK-E$LLSET2KEYF-C
     3451     9226                   MESSAGE: M$LL is SET to a KEYED file.  Unable to do this WRITE.
     3452     9227                   DESCRIPTION: The user has SET M$LL to a KEYED file, and IBEX is not
     3453     9228                                specifying a key on this WRITE.
     3454     9229        */
     3455     9230    1   END   CPK$FDS_OUTPUT ;

PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:546  
--  Include file information  --

   CP_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPK$FDS_OUTPUT.

   Procedure CPK$FDS_OUTPUT requires 54 words for executable code.
   Procedure CPK$FDS_OUTPUT requires 26 words of local(AUTO) storage.

    No errors detected in file CPK$CHECK.:E05TSI    .

PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:547  

 Object Unit name= CPK$FDS_OUTPUT                             File name= CPK$CHECK.:E05TOU
 UTS= JUL 29 '97 11:57:54.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      1      1  CPK$FDS_OUTPUT
    2   Proc  even  none    54     66  CPK$FDS_OUTPUT
    3  RoData even  none     3      3  CPK$FDS_OUTPUT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  CPK$FDS_OUTPUT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 CXP$POSTERR
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    SEG2$                            r    B$TCB$
     B_VECTNIL
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:548  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:549  


     3366        1        /*T***********************************************************/
     3367        2        /*T*                                                         */
     3368        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3369        4        /*T*                                                         */
     3370        5        /*T***********************************************************/
     3371        6        /**********************************************************************/
     3372        7        /*F*   NAME:   CPK$FDS_OUTPUT
     3373        8               PURPOSE: To call M$WRITE for X$FORMAT.  In this way any ALTRETURNs
     3374        9                       from M$WRITE can be handled.  CPK$FDS_OUTPUT always ALTRETs
     3375       10                       back to X$FORMAT.
     3376       11               DESCRIPTION: CPK$FDS_OUTPUT is called by X$FORMAT, if IBEX does not
     3377       12                       have any error posted, the M$WRITE will be performed,
     3378       13                       otherwise, no call to M$WRITE will be done.
     3379       14        */
     3380       15        /*D*   NAME:   CPK$FDS_OUTPUT
     3381       16               CALL:   CALL CPK$FDS_OUTPUT(OUTBUF_VEC,F_FDS) ;
     3382       17               INTERFACE: X$FORMAT
     3383       18               INPUT:  OUTBUF_VEC  - is a vector framing the buffer used by X$FORMAT.
     3384       19                       F_FDS       - is the data block used by X$FORMAT.
     3385       20               DESCRIPTION: If IBEX does not have any errors posted, IBEX will
     3386       21                       call M$WRITE, then CPK$FDS_OUTPUT altreturns to X$FORMAT.
     3387       22        */
     3388       23        /**********************************************************************/
     3389       24        CPK$FDS_OUTPUT: PROC (OUTBUF_VEC,F_FDS) ALTRET ;

     24  2 000000   000000 700200 xent  CPK$FDS_OUT* TSX0  ! X66_AUTO_2
         2 000001   000032 000002                    ZERO    26,2

     3390       25
     3391       26             /***** Includes *****/
     3392       27
     3393       28        %INCLUDE CP_6 ;
     3394      109        %INCLUDE CP_6_SUBS ;
     3395      649        %INCLUDE XU_FORMAT_C ;
     3396      811        %INCLUDE B_MACROS_C ;
     3397      922        %INCLUDE CP_MACROS_C ;
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:550  
     3398     1674        %INCLUDE XU_MACRO_C ;
     3399     4780        %INCLUDE CP_DATA_R ;
     3400     7343        %INCLUDE B_ERRORS_C ;
     3401     8470        %INCLUDE CP_PERR_C ;
     3402     8808
     3403     8809             /***** Entries *****/
     3404     8810
     3405     8811    1   DCL CXP$POSTERR ENTRY(5);
     3406     8812
     3407     8813             /***** Parameters *****/
     3408     8814
     3409     8815    1   DCL OUTBUF_VEC VECTOR PARAM ;
     3410     8816        %F_FDS (STCLASS=PARAM) ;
     3411     8929
     3412     8930             /***** Based declarations *****/
     3413     8931
     3414     8932        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS=BASED) ;
     3415     8963        %ERR_BLK (NAME=ERR$BLK, STCLASS=BASED) ;
     3416     8988        %B$TCB (STCLASS="BASED(B$TCB$)") ;
     3417     8991        %B$ALT ;
     3418     8999        %B$EXCFR ;
     3419     9017        %SEG$2 ;
     3420     9077
     3421     9078             /***** Auto declarations *****/
     3422     9079
     3423     9080        %FPT_WRITE (FPTN=FPT_WRITE,STCLASS=AUTO) ;
     3424     9111    1   DCL DCB# UBIN WORD ;
     3425     9112        %VLP_ERRCODE (FPTN=E_LLSET2KEYF,MID=K,ERR#=E$LLSET2KEYF,FCG=CP,STCLASS=CONSTANT);
     3426     9157        %VLP_ERRCODE (FPTN=ERR_CODE, STCLASS=AUTO) ;
     3427     9202
     3428     9203             /***** Procedure *****/
     3429     9204
     3430     9205    1         IF ADDR(SEG$2.ERRBUF)->ERR$BLK.FIRST = 0

   9205  2 000002   000000 470400 xsym               LDP0    SEG2$
         2 000003   000004 235100                    LDA     4,,PR0
         2 000004   000065 601000 2                  TNZ     s:9224
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:551  

     3431     9206    1             THEN
     3432     9207    2               DO ;

     3433     9208    2                 FPT_WRITE = F_FDS.WRITEFPT$->FPT$WRITE ;

   9208  2 000005   200004 471500                    LDP1    @F_FDS,,AUTO
         2 000006   100031 473500                    LDP3    25,,PR1
         2 000007   000100 100500                    MLR     fill='000'O
         2 000010   300000 000060                    ADSC9   0,,PR3                   cn=0,n=48
         2 000011   200006 000060                    ADSC9   FPT_WRITE,,AUTO          cn=0,n=48

     3434     9209    2                 FPT_WRITE.V_ = VECTOR(FPT_WRITE.V) ;

   9209  2 000012   000000 235000 3                  LDA     0
         2 000013   200024 452500                    STP2    ERR_CODE+1,,AUTO
         2 000014   200024 236100                    LDQ     ERR_CODE+1,,AUTO
         2 000015   000016 036003                    ADLQ    14,DU
         2 000016   200006 757100                    STAQ    FPT_WRITE,,AUTO

     3435     9210    2                 FPT_WRITE.V.DCB# = SEG2$->SEG$2.LLDCB# ;

   9210  2 000017   000000 720100                    LXL0    0,,PR0
         2 000020   200016 740100                    STX0    FPT_WRITE+8,,AUTO

     3436     9211    2                 CALL M$WRITE (FPT_WRITE) WHENALTRETURN

   9211  2 000021   200006 630500                    EPPR0   FPT_WRITE,,AUTO
         2 000022   440001 713400                    CLIMB   alt,write
         2 000023   401400 401760                    pmme    nvectors=4
         2 000024   000026 702000 2                  TSX2    s:9213
         2 000025   000065 710000 2                  TRA     s:9224

     3437     9212    3                         DO ;

     3438     9213    3                           DCB# = FPT_WRITE.V.DCB# ;

PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:552  
   9213  2 000026   200016 235100                    LDA     FPT_WRITE+8,,AUTO
         2 000027   000022 771000                    ARL     18
         2 000030   200022 755100                    STA     DCB#,,AUTO

     3439     9214    3                           IF B$TCB.ALT$->B$EXCFR.ERR.ERR# = %E$WRWOKEY

   9214  2 000031   000000 470400 xsym               LDP0    B$TCB$
         2 000032   000000 471500                    LDP1    0,,PR0
         2 000033   100102 236100                    LDQ     66,,PR1
         2 000034   377770 376007                    ANQ     131064,DL
         2 000035   001010 116007                    CMPQ    520,DL
         2 000036   000042 601000 2                  TNZ     s:9218

     3440     9215    3                             THEN
     3441     9216    3                               ERR_CODE = E_LLSET2KEYF ;

   9216  2 000037   000000 236000 1                  LDQ     E_LLSET2KEYF
         2 000040   200023 756100                    STQ     ERR_CODE,,AUTO
         2 000041   000044 710000 2                  TRA     s:9219

     3442     9217    3                             ELSE
     3443     9218    3                               ERR_CODE = B$TCB.ALT$->B$EXCFR.ERR ;

   9218  2 000042   100102 236100                    LDQ     66,,PR1
         2 000043   200023 756100                    STQ     ERR_CODE,,AUTO

     3444     9219    3                           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511,

   9219  2 000044   000000 236000 xsym               LDQ     SEG2$
         2 000045   000003 036003                    ADLQ    3,DU
         2 000046   200024 756100                    STQ     ERR_CODE+1,,AUTO
         2 000047   200022 631500                    EPPR1   DCB#,,AUTO
         2 000050   200031 451500                    STP1    ERR_CODE+6,,AUTO
         2 000051   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000052   200030 756100                    STQ     ERR_CODE+5,,AUTO
         2 000053   200023 633500                    EPPR3   ERR_CODE,,AUTO
         2 000054   200027 453500                    STP3    ERR_CODE+4,,AUTO
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:553  
         2 000055   000002 236000 3                  LDQ     2
         2 000056   200026 756100                    STQ     ERR_CODE+3,,AUTO
         2 000057   200024 634500                    EPPR4   ERR_CODE+1,,AUTO
         2 000060   200025 454500                    STP4    ERR_CODE+2,,AUTO
         2 000061   200025 630500                    EPPR0   ERR_CODE+2,,AUTO
         2 000062   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000063   000000 701000 xent               TSX1    CXP$POSTERR
         2 000064   000000 011000                    NOP     0

     3445     9220    3                                 ERR_CODE,,DCB#) ;
     3446     9221    3                         END ; /* Whenaltreturn Do */

     3447     9222    2                 END ; /* Then Do */

     3448     9223
     3449     9224    1         ALTRETURN ;

   9224  2 000065   000000 702200 xent               TSX2  ! X66_AALT
     3450     9225        /*E*       ERROR:   CPK-E$LLSET2KEYF-C
     3451     9226                   MESSAGE: M$LL is SET to a KEYED file.  Unable to do this WRITE.
     3452     9227                   DESCRIPTION: The user has SET M$LL to a KEYED file, and IBEX is not
     3453     9228                                specifying a key on this WRITE.
     3454     9229        */
     3455     9230    1   END   CPK$FDS_OUTPUT ;

PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:554  
--  Include file information  --

   CP_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPK$FDS_OUTPUT.
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:555  

 **** Variables and constants ****

  ****  Section 001 RoData CPK$FDS_OUTPUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 E_LLSET2KEYF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @F_FDS                     3-0-0/w PTR         r     1 @OUTBUF_VEC
    22-0-0/w UBIN        r     1 DCB#                      23-0-0/w STRC        r     1 ERR_CODE
     6-0-0/d STRC(432)   r     1 FPT_WRITE                 *0-0-0/w STRC(1080)  r     1 F_FDS
    *0-0-0/d VECT        r     1 OUTBUF_VEC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 SEG2$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$EXCFR                    0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(828)   r     1 ERR$BLK                    0-0-0/d STRC(432)   r     1 FPT$WRITE
     0-0-0/w STRC(6264)  r     1 SEG$2

PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:556  

   Procedure CPK$FDS_OUTPUT requires 54 words for executable code.
   Procedure CPK$FDS_OUTPUT requires 26 words of local(AUTO) storage.

    No errors detected in file CPK$CHECK.:E05TSI    .
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:557  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:558  
          MINI XREF LISTING

B$ALT.CODE
      8993**DCL      8993--REDEF    8994--REDEF    8994--REDEF
B$ALT.ERR.ERR#
      8995**DCL      8995--REDEF
B$ALT.EVID
      8994**DCL      8994--REDEF    8994--REDEF
B$EXCFR.ASL
      9000**DCL      9000--REDEF
B$EXCFR.ERR
      9014**DCL      9218>>ASSIGN
B$EXCFR.ERR.ERR#
      9014**DCL      9014--REDEF    9214>>IF
B$EXCFR.EVID
      9013**DCL      9013--REDEF    9014--REDEF
B$EXCFR.IR
      9001**DCL      9001--REDEF
B$EXCFR.PREVSZ
      9000**DCL      9000--REDEF
B$EXCFR.SUBC
      9012**DCL      9012--REDEF    9013--REDEF    9013--REDEF
B$TCB.ALT$
      8989**DCL      9214>>IF       9218>>ASSIGN
B$TCB$
      7278**DCL      8989--IMP-PTR  9214>>IF       9218>>ASSIGN
CAMR_REC.ACSVEH_
      6315**DCL      6316--REDEF
CAMR_REC.ALTKEYS_
      6321**DCL      6322--REDEF    6322--REDEF
CAMR_REC.HDR_
      6320**DCL      6321--REDEF
CAMR_REC.TAB_
      6319**DCL      6320--REDEF
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:559  
CAMR_REC.UHL_
      6313**DCL      6314--REDEF    6314--REDEF
CAMR_REC.V.FSN#
      6353**DCL      6353--REDEF    6353--REDEF
CAMR_REC.WSN_
      6319**DCL      6319--REDEF
CFPT_CLOSE.SN_
      5157**DCL      5157--REDEF
CFPT_CLOSE.UTL_
      5158**DCL      5158--REDEF
CFPT_CLOSE.V.EXPIRE#
      5172**DCL      5172--REDEF
CFPT_CLOSE.V.TYPE#
      5170**DCL      5170--REDEF
CFPT_CLOSE.V.XTNSIZE#
      5167**DCL      5167--REDEF    5169--REDEF
CFPT_OPEN.ACSVEH_
      5092**DCL      5093--REDEF
CFPT_OPEN.ALTKEYS_
      5098**DCL      5099--REDEF    5099--REDEF
CFPT_OPEN.HDR_
      5097**DCL      5098--REDEF
CFPT_OPEN.TAB_
      5096**DCL      5097--REDEF
CFPT_OPEN.UHL_
      5090**DCL      5091--REDEF    5091--REDEF
CFPT_OPEN.V.FSN#
      5130**DCL      5130--REDEF    5130--REDEF
CFPT_OPEN.WSN_
      5096**DCL      5096--REDEF
CFPT_READ.STATION_
      5196**DCL      5197--REDEF
CFPT_READ.V.DVBYTE.REREAD#
      5208**DCL      5208--REDEF
CFPT_READ.V.INDX#
      5206**DCL      5206--REDEF
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:560  
CFPT_READUC.STATION_
      5566**DCL      5567--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
      5578**DCL      5578--REDEF
CFPT_READUC.V.INDX#
      5576**DCL      5576--REDEF
CFPT_TRTN.V.IR#
      5802**DCL      5803--REDEF
CFPT_WRITE.STATION_
      5234**DCL      5234--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      5241**DCL      5241--REDEF
CFPT_WRITEUC.STATION_
      5534**DCL      5534--REDEF
CFPT_WRITEUC.V.DVBYTE.VFC#
      5541**DCL      5541--REDEF
CFPT_XXX.V.STEPCC#
      6514**DCL      6514--REDEF
CGETCMD.OUT$
      6535**DCL      6541--REDEF
CVLP_TRMCTL.BREAKCOUNT
      6126**DCL      6127--REDEF
CVLP_WINDOW.FWINDOW#
      6222**DCL      6222--REDEF    6223--REDEF
CXP$POSTERR
      8811**DCL-ENT  9219--CALL
DCB#
      9111**DCL      9213<<ASSIGN   9219<>CALL
ERR$BLK.FIRST
      8979**DCL      9205>>IF
ERR_CODE
      9169**DCL      9216<<ASSIGN   9218<<ASSIGN   9219<>CALL
E_LLSET2KEYF
      9124**DCL      9216>>ASSIGN
FPT$WRITE
      8949**DCL      9208>>ASSIGN
PL6.E3A0      #003=CPK$FDS_OUTPUT File=CPK$CHECK.:E05TSI                         TUE 07/29/97 11:57 Page:561  
FPT$WRITE.STATION_
      8951**DCL      8951--REDEF
FPT$WRITE.V.DVBYTE.VFC#
      8958**DCL      8958--REDEF
FPT_WRITE
      9097**DCL      9208<<ASSIGN   9211<>CALL
FPT_WRITE.STATION_
      9099**DCL      9099--REDEF
FPT_WRITE.V
      9100**DCL      9209--ASSIGN
FPT_WRITE.V.DCB#
      9100**DCL      9210<<ASSIGN   9213>>ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
      9106**DCL      9106--REDEF
FPT_WRITE.V_
      9097**DCL      9209<<ASSIGN
F_FDS
      8830**DCL        24--PROC
F_FDS.WRITEFPT$
      8916**DCL      9208>>ASSIGN
M$WRITE
        38**DCL-ENT  9211--CALL
OUTBUF_VEC
      8815**DCL        24--PROC
SEG$2.ERRBUF
      9043**DCL      9205--IF       9219--CALL
SEG$2.LLDCB#
      9038**DCL      9210>>ASSIGN
SEG2$
      7269**DCL      9018--IMP-PTR  9205>>IF       9210>>ASSIGN   9219>>CALL
