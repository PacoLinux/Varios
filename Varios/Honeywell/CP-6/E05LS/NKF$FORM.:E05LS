VERSION E05

PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:1    
        1        1        /*M* NKF$FORM Routines to set form names and convert VFU images */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*F* NAME:         NKF$FORM
       10       10             PURPOSE:      To perform form mounts on UR devices
       11       11             DESCRIPTION:  Called from FOM$PMME as a result of an
       12       12                           M$SYMBIO FMNT done by OUTSYM.  The
       13       13                           device in question need not belong
       14       14                           to OUTSYM and in fact need not be local,
       15       15                           although if it's remote nothing is done
       16       16                           except to verify OUTSYM owns it.
       17       17        */
       18       18        NKF$FORM: PROC (DEVNM,FNAME) ALTRET;
       19       19
       20       20
       21       21
       22       22        /**/
       23       23        /* INCLUDES */
       24       24        /**/
       25       25        %INCLUDE FR_ERRORS_C;
       26       56        %INCLUDE KC_ERRORS_C;
       27      103        %INCLUDE UD_SEV_C;
       28      117        %INCLUDE B$JIT_C;
       29      431        %INCLUDE KC$CGBLK;
       30      479        %INCLUDE NI$TABLES;
       31      695        %INCLUDE EL$TABLES;
       32     1018        %INCLUDE FR$RAT;
       33     1071        %INCLUDE NK_LDCT_R;
       34     1080        %INCLUDE SS_SCHED_C;
       35     1313        %INCLUDE JG_GHOSTS_C;
       36     1403        %INCLUDE EL_SUBS_C;
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:2    
       37     1487
       38     1488
       39     1489
       40     1490        /**/
       41     1491        /* PARAMETERS */
       42     1492        /**/
       43     1493    1   DCL DEVNM CHAR(8);
       44     1494    1   DCL FNAME CHAR(6);
       45     1495
       46     1496
       47     1497
       48     1498        /**/
       49     1499        /* BASED STRUCTURES */
       50     1500        /**/
       51     1501        %B$JIT0;
       52     1590        %A$JIT6X;
       53     1593        %FR$RAT (NAME=RAT,STCLASS=BASED);
       54     1633        %NI$DCT (NAME=DCT);
       55     1681
       56     1682
       57     1683
       58     1684        /**/
       59     1685        /* AUTO */
       60     1686        /**/
       61     1687        %EL$MTDMT (NAME=FMNT,STCLASS="");
       62     1690    1   DCL DCTX UBIN WORD;
       63     1691    1   DCL DCT$ PTR;
       64     1692    1   DCL LDCT$ PTR;
       65     1693    1   DCL RAT$ PTR;
       66     1694    1   DCL TEMP REDEF RAT$ UBIN WORD;
       67     1695
       68     1696
       69     1697
       70     1698        /**/
       71     1699        /* CONSTANT */
       72     1700        /**/
       73     1701    1   DCL 1 NOSTA CONSTANT ALIGNED,
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:3    
       74     1702    1         2 FCG BIT(18) UNAL INIT('161306'O),
       75     1703    1         2 ERR UBIN(15) UNAL INIT(%E$NOSTA),
       76     1704    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       77     1705    1   DCL 1 REOPN CONSTANT ALIGNED,
       78     1706    1         2 FCG BIT(18) UNAL INIT('161306'O),
       79     1707    1         2 ERR UBIN(15) UNAL INIT(%E$REOPN),
       80     1708    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       81     1709    1   DCL 1 UPNLDT CONSTANT ALIGNED,
       82     1710    1         2 FCG BIT(18) UNAL INIT('161306'O),
       83     1711    1         2 ERR UBIN(15) UNAL INIT(%E$UPNLDT),
       84     1712    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       85     1713    1   DCL 1 NOTUR CONSTANT ALIGNED,
       86     1714    1         2 FCG BIT(18) UNAL INIT('161306'O),
       87     1715    1         2 ERR UBIN(15) UNAL INIT(%E$NOTUR),
       88     1716    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       89     1717
       90     1718
       91     1719
       92     1720        /**/
       93     1721        /* REFS */
       94     1722        /**/
       95     1723    1   DCL ELA$SYSLOG    ENTRY(6) ALTRET;
       96     1724    1   DCL KCO$FINDSTA   ENTRY(4) ALTRET;
       97     1725    1   DCL OCZ$DEV_DCT   ENTRY(3) ALTRET;
       98     1726    1   DCL SSR$RUE       ENTRY(4);
       99     1727    1   DCL SSS$SYSTIME ENTRY(1);
      100     1728
      101     1729    1   DCL B$JIT$ PTR SYMREF;
      102     1730        %KC$CGID (FPTN=KC_OSID,STCLASS=SYMREF);
      103     1756
      104     1757
      105     1758
      106     1759        /**/
      107     1760        /* SUBS */
      108     1761        /**/
      109     1762        %INCLUDE FR_SUBS;
      110     1830        /**/
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:4    
      111     1831        /**/
      112     1832    1         CALL SSS$SYSTIME( FMNT.REQ_UTS );
      113     1833    1         CALL OCZ$DEV_DCT (DEVNM,DCTX)
      114     1834    2         WHENALTRETURN DO;
      115     1835    2           TEMP=8;
      116     1836    2           CALL KCO$FINDSTA (LDCT$,KC_OSID,DEVNM,TEMP) ALTRET(BDEV);
      117     1837    2           RETURN;
      118     1838    2           END;
      119     1839    1         DCT$=NK$LDCT$(DCTX);
      120     1840    1         IF DCT$->DCT.RAT$=ADDR(NIL) THEN
      121     1841    2           DO;
      122     1842    2   BDEV:   ;
      123     1843    2           B$JIT.ERR=NOTUR;
      124     1844    2           ALTRETURN;
      125     1845    2           END;
      126     1846    1         RAT$=DCT$->DCT.RAT$;
      127     1847    1         IF RAT$->RAT.FLG.FORM='0'B THEN GOTO BDEV;
      128     1848    1         IF DCT$->DCT.STATUS.DOWN THEN
      129     1849    2           DO;
      130     1850    2           B$JIT.ERR=UPNLDT;
      131     1851    2           ALTRETURN;
      132     1852    2           END;
      133     1853    1         IF RAT$->RAT.FLG.OPN OR RAT$->RAT.FLG.MBIT.MTD THEN
      134     1854    2           DO;
      135     1855    2           B$JIT.ERR=REOPN;
      136     1856    2           ALTRETURN;
      137     1857    2           END;
      138     1858    1         RAT$->RAT.REEL.SER=FNAME;
      139     1859    1         RAT$->RAT.FLG.RUP='1'B;
      140     1860    1         IF RAT$->RAT.FLG.MBIT.SOL THEN
      141     1861    2           DO;
      142     1862    2           RAT$->RAT.FLG.MBIT.SOL='0'B;
      143     1863    2           CALL SSR$RUE (%SS_WU,RAT$->RAT.SOLU);
      144     1864    2           END;
      145     1865    1         IF RAT$->RAT.FLG.SYMBIONT THEN
      146     1866    2           DO;
      147     1867    2           FMNT.SYSID=JG_OUTSYM#;
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:5    
      148     1868    2           FMNT.VOLUME=FNAME;
      149     1869    2           FMNT.DEVNAME=DEVNM;
      150     1870    2           FMNT.PSN=' ';
      151     1871    2           CALL ELA$SYSLOG (EL_MOUNT,FMNT,SIZEW(FMNT),'0'B,1,DCTX);
      152     1872    2           END;
      153     1873    1         RETURN;
      154     1874        /**/
      155     1875    1   END;
      156     1876        /**/
      157     1877        /**/
      158     1878        %EOD;

PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:6    
--  Include file information  --

   FR_SUBS.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FR_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure NKF$FORM.

   Procedure NKF$FORM requires 116 words for executable code.
   Procedure NKF$FORM requires 22 words of local(AUTO) storage.

PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:7    

 Object Unit name= NKF$FORM                                   File name= NKF$FORM.:E05TOU
 UTS= JUL 30 '97 03:44:48.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      4      4  NKF$FORM
    1   Proc  even  none   116    164  NKF$FORM
    2  RoData even  none    11     13  NKF$FORM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  NKF$FORM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 SSS$SYSTIME
 yes     yes           Std       3 OCZ$DEV_DCT
 yes     yes           Std       6 ELA$SYSLOG
 yes     yes           Std       4 KCO$FINDSTA
         yes           Std       4 SSR$RUE
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:8    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               B$JIT$                                KC_OSID
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:9    


        1        1        /*M* NKF$FORM Routines to set form names and convert VFU images */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*F* NAME:         NKF$FORM
       10       10             PURPOSE:      To perform form mounts on UR devices
       11       11             DESCRIPTION:  Called from FOM$PMME as a result of an
       12       12                           M$SYMBIO FMNT done by OUTSYM.  The
       13       13                           device in question need not belong
       14       14                           to OUTSYM and in fact need not be local,
       15       15                           although if it's remote nothing is done
       16       16                           except to verify OUTSYM owns it.
       17       17        */
       18       18        NKF$FORM: PROC (DEVNM,FNAME) ALTRET;

     18  1 000000   000000 700200 xent  NKF$FORM     TSX0  ! X66_AUTO_2
         1 000001   000026 000002                    ZERO    22,2

       19       19
       20       20
       21       21
       22       22        /**/
       23       23        /* INCLUDES */
       24       24        /**/
       25       25        %INCLUDE FR_ERRORS_C;
       26       56        %INCLUDE KC_ERRORS_C;
       27      103        %INCLUDE UD_SEV_C;
       28      117        %INCLUDE B$JIT_C;
       29      431        %INCLUDE KC$CGBLK;
       30      479        %INCLUDE NI$TABLES;
       31      695        %INCLUDE EL$TABLES;
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:10   
       32     1018        %INCLUDE FR$RAT;
       33     1071        %INCLUDE NK_LDCT_R;
       34     1080        %INCLUDE SS_SCHED_C;
       35     1313        %INCLUDE JG_GHOSTS_C;
       36     1403        %INCLUDE EL_SUBS_C;
       37     1487
       38     1488
       39     1489
       40     1490        /**/
       41     1491        /* PARAMETERS */
       42     1492        /**/
       43     1493    1   DCL DEVNM CHAR(8);
       44     1494    1   DCL FNAME CHAR(6);
       45     1495
       46     1496
       47     1497
       48     1498        /**/
       49     1499        /* BASED STRUCTURES */
       50     1500        /**/
       51     1501        %B$JIT0;
       52     1590        %A$JIT6X;
       53     1593        %FR$RAT (NAME=RAT,STCLASS=BASED);
       54     1633        %NI$DCT (NAME=DCT);
       55     1681
       56     1682
       57     1683
       58     1684        /**/
       59     1685        /* AUTO */
       60     1686        /**/
       61     1687        %EL$MTDMT (NAME=FMNT,STCLASS="");
       62     1690    1   DCL DCTX UBIN WORD;
       63     1691    1   DCL DCT$ PTR;
       64     1692    1   DCL LDCT$ PTR;
       65     1693    1   DCL RAT$ PTR;
       66     1694    1   DCL TEMP REDEF RAT$ UBIN WORD;
       67     1695
       68     1696
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:11   
       69     1697
       70     1698        /**/
       71     1699        /* CONSTANT */
       72     1700        /**/
       73     1701    1   DCL 1 NOSTA CONSTANT ALIGNED,
       74     1702    1         2 FCG BIT(18) UNAL INIT('161306'O),
       75     1703    1         2 ERR UBIN(15) UNAL INIT(%E$NOSTA),
       76     1704    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       77     1705    1   DCL 1 REOPN CONSTANT ALIGNED,
       78     1706    1         2 FCG BIT(18) UNAL INIT('161306'O),
       79     1707    1         2 ERR UBIN(15) UNAL INIT(%E$REOPN),
       80     1708    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       81     1709    1   DCL 1 UPNLDT CONSTANT ALIGNED,
       82     1710    1         2 FCG BIT(18) UNAL INIT('161306'O),
       83     1711    1         2 ERR UBIN(15) UNAL INIT(%E$UPNLDT),
       84     1712    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       85     1713    1   DCL 1 NOTUR CONSTANT ALIGNED,
       86     1714    1         2 FCG BIT(18) UNAL INIT('161306'O),
       87     1715    1         2 ERR UBIN(15) UNAL INIT(%E$NOTUR),
       88     1716    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       89     1717
       90     1718
       91     1719
       92     1720        /**/
       93     1721        /* REFS */
       94     1722        /**/
       95     1723    1   DCL ELA$SYSLOG    ENTRY(6) ALTRET;
       96     1724    1   DCL KCO$FINDSTA   ENTRY(4) ALTRET;
       97     1725    1   DCL OCZ$DEV_DCT   ENTRY(3) ALTRET;
       98     1726    1   DCL SSR$RUE       ENTRY(4);
       99     1727    1   DCL SSS$SYSTIME ENTRY(1);
      100     1728
      101     1729    1   DCL B$JIT$ PTR SYMREF;
      102     1730        %KC$CGID (FPTN=KC_OSID,STCLASS=SYMREF);
      103     1756
      104     1757
      105     1758
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:12   
      106     1759        /**/
      107     1760        /* SUBS */
      108     1761        /**/
      109     1762        %INCLUDE FR_SUBS;
      110     1830        /**/
      111     1831        /**/
      112     1832    1         CALL SSS$SYSTIME( FMNT.REQ_UTS );

   1832  1 000002   200013 630500                    EPPR0   FMNT+6,,AUTO
         1 000003   200020 450500                    STP0    RAT$+1,,AUTO
         1 000004   200020 630500                    EPPR0   RAT$+1,,AUTO
         1 000005   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000006   000000 701000 xent               TSX1    SSS$SYSTIME
         1 000007   000000 011000                    NOP     0

      113     1833    1         CALL OCZ$DEV_DCT (DEVNM,DCTX)

   1833  1 000010   200014 630500                    EPPR0   DCTX,,AUTO
         1 000011   200021 450500                    STP0    RAT$+2,,AUTO
         1 000012   200003 236100                    LDQ     @DEVNM,,AUTO
         1 000013   200020 756100                    STQ     RAT$+1,,AUTO
         1 000014   200020 630500                    EPPR0   RAT$+1,,AUTO
         1 000015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000016   000000 701000 xent               TSX1    OCZ$DEV_DCT
         1 000017   000021 702000 1                  TSX2    s:1835
         1 000020   000040 710000 1                  TRA     s:1839

      114     1834    2         WHENALTRETURN DO;

      115     1835    2           TEMP=8;

   1835  1 000021   000010 235007                    LDA     8,DL
         1 000022   200017 755100                    STA     RAT$,,AUTO

      116     1836    2           CALL KCO$FINDSTA (LDCT$,KC_OSID,DEVNM,TEMP) ALTRET(BDEV);

   1836  1 000023   200017 630500                    EPPR0   RAT$,,AUTO
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:13   
         1 000024   200023 450500                    STP0    RAT$+4,,AUTO
         1 000025   200003 236100                    LDQ     @DEVNM,,AUTO
         1 000026   200022 756100                    STQ     RAT$+3,,AUTO
         1 000027   000000 236000 2                  LDQ     0
         1 000030   200021 756100                    STQ     RAT$+2,,AUTO
         1 000031   200016 631500                    EPPR1   LDCT$,,AUTO
         1 000032   200020 451500                    STP1    RAT$+1,,AUTO
         1 000033   200020 630500                    EPPR0   RAT$+1,,AUTO
         1 000034   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000035   000000 701000 xent               TSX1    KCO$FINDSTA
         1 000036   000050 702000 1                  TSX2    BDEV

      117     1837    2           RETURN;

   1837  1 000037   000000 702200 xent               TSX2  ! X66_ARET

      118     1838    2           END;
      119     1839    1         DCT$=NK$LDCT$(DCTX);

   1839  1 000040   000000 470400 xsym               LDP0    N$DCT$$
         1 000041   200014 720100                    LXL0    DCTX,,AUTO
         1 000042   000000 236110                    LDQ     0,X0,PR0
         1 000043   200015 756100                    STQ     DCT$,,AUTO

      120     1840    1         IF DCT$->DCT.RAT$=ADDR(NIL) THEN

   1840  1 000044   200015 471500                    LDP1    DCT$,,AUTO
         1 000045   100005 236100                    LDQ     5,,PR1
         1 000046   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000047   000054 601000 1                  TNZ     s:1846

      121     1841    2           DO;

   1838  1 000050                       BDEV         null
      122     1842    2   BDEV:   ;
      123     1843    2           B$JIT.ERR=NOTUR;

PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:14   
   1843  1 000050   000003 236000 0                  LDQ     NOTUR
         1 000051   000000 470400 xsym               LDP0    B$JIT$
         1 000052   000012 756100                    STQ     10,,PR0

      124     1844    2           ALTRETURN;

   1844  1 000053   000000 702200 xent               TSX2  ! X66_AALT

      125     1845    2           END;
      126     1846    1         RAT$=DCT$->DCT.RAT$;

   1846  1 000054   200017 756100                    STQ     RAT$,,AUTO

      127     1847    1         IF RAT$->RAT.FLG.FORM='0'B THEN GOTO BDEV;

   1847  1 000055   200017 473500                    LDP3    RAT$,,AUTO
         1 000056   300010 236100                    LDQ     8,,PR3
         1 000057   000010 316007                    CANQ    8,DL
         1 000060   000050 600000 1                  TZE     BDEV

      128     1848    1         IF DCT$->DCT.STATUS.DOWN THEN

   1848  1 000061   100027 234100                    SZN     23,,PR1
         1 000062   000067 605000 1                  TPL     s:1853

      129     1849    2           DO;

      130     1850    2           B$JIT.ERR=UPNLDT;

   1850  1 000063   000002 236000 0                  LDQ     UPNLDT
         1 000064   000000 474400 xsym               LDP4    B$JIT$
         1 000065   400012 756100                    STQ     10,,PR4

      131     1851    2           ALTRETURN;

   1851  1 000066   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:15   
      132     1852    2           END;
      133     1853    1         IF RAT$->RAT.FLG.OPN OR RAT$->RAT.FLG.MBIT.MTD THEN

   1853  1 000067   000020 316007                    CANQ    16,DL
         1 000070   000073 601000 1                  TNZ     s:1855
         1 000071   000400 316007                    CANQ    256,DL
         1 000072   000077 600000 1                  TZE     s:1858

      134     1854    2           DO;

      135     1855    2           B$JIT.ERR=REOPN;

   1855  1 000073   000001 236000 0                  LDQ     REOPN
         1 000074   000000 474400 xsym               LDP4    B$JIT$
         1 000075   400012 756100                    STQ     10,,PR4

      136     1856    2           ALTRETURN;

   1856  1 000076   000000 702200 xent               TSX2  ! X66_AALT

      137     1857    2           END;
      138     1858    1         RAT$->RAT.REEL.SER=FNAME;

   1858  1 000077   200004 474500                    LDP4    @FNAME,,AUTO
         1 000100   040100 100500                    MLR     fill='040'O
         1 000101   400000 000006                    ADSC9   0,,PR4                   cn=0,n=6
         1 000102   300004 400006                    ADSC9   4,,PR3                   cn=2,n=6

      139     1859    1         RAT$->RAT.FLG.RUP='1'B;

   1859  1 000103   200017 473500                    LDP3    RAT$,,AUTO
         1 000104   000004 236007                    LDQ     4,DL
         1 000105   300010 256100                    ORSQ    8,,PR3

      140     1860    1         IF RAT$->RAT.FLG.MBIT.SOL THEN

   1860  1 000106   200017 473500                    LDP3    RAT$,,AUTO
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:16   
         1 000107   300010 236100                    LDQ     8,,PR3
         1 000110   000100 316007                    CANQ    64,DL
         1 000111   000124 600000 1                  TZE     s:1865

      141     1861    2           DO;

      142     1862    2           RAT$->RAT.FLG.MBIT.SOL='0'B;

   1862  1 000112   000001 236000 2                  LDQ     1
         1 000113   300010 356100                    ANSQ    8,,PR3

      143     1863    2           CALL SSR$RUE (%SS_WU,RAT$->RAT.SOLU);

   1863  1 000114   200017 236100                    LDQ     RAT$,,AUTO
         1 000115   000003 036000 2                  ADLQ    3
         1 000116   000004 235000 2                  LDA     4
         1 000117   200020 757100                    STAQ    RAT$+1,,AUTO
         1 000120   200020 630500                    EPPR0   RAT$+1,,AUTO
         1 000121   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000122   000000 701000 xent               TSX1    SSR$RUE
         1 000123   000000 011000                    NOP     0

      144     1864    2           END;

      145     1865    1         IF RAT$->RAT.FLG.SYMBIONT THEN

   1865  1 000124   200017 470500                    LDP0    RAT$,,AUTO
         1 000125   000010 236100                    LDQ     8,,PR0
         1 000126   000001 316007                    CANQ    1,DL
         1 000127   000163 600000 1                  TZE     s:1873

      146     1866    2           DO;

      147     1867    2           FMNT.SYSID=JG_OUTSYM#;

   1867  1 000130   000003 235007                    LDA     3,DL
         1 000131   200005 755100                    STA     FMNT,,AUTO
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:17   

      148     1868    2           FMNT.VOLUME=FNAME;

   1868  1 000132   200004 471500                    LDP1    @FNAME,,AUTO
         1 000133   040100 100500                    MLR     fill='040'O
         1 000134   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         1 000135   200006 000006                    ADSC9   FMNT+1,,AUTO             cn=0,n=6

      149     1869    2           FMNT.DEVNAME=DEVNM;

   1869  1 000136   200003 473500                    LDP3    @DEVNM,,AUTO
         1 000137   040100 100500                    MLR     fill='040'O
         1 000140   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         1 000141   200011 000010                    ADSC9   FMNT+4,,AUTO             cn=0,n=8

      150     1870    2           FMNT.PSN=' ';

   1870  1 000142   040100 100400                    MLR     fill='040'O
         1 000143   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000144   200007 400006                    ADSC9   FMNT+2,,AUTO             cn=2,n=6

      151     1871    2           CALL ELA$SYSLOG (EL_MOUNT,FMNT,SIZEW(FMNT),'0'B,1,DCTX);

   1871  1 000145   200014 634500                    EPPR4   DCTX,,AUTO
         1 000146   200025 454500                    STP4    RAT$+6,,AUTO
         1 000147   000006 236000 2                  LDQ     6
         1 000150   200024 756100                    STQ     RAT$+5,,AUTO
         1 000151   000010 237000 2                  LDAQ    8
         1 000152   200022 757100                    STAQ    RAT$+3,,AUTO
         1 000153   200005 635500                    EPPR5   FMNT,,AUTO
         1 000154   200021 455500                    STP5    RAT$+2,,AUTO
         1 000155   000012 236000 2                  LDQ     10
         1 000156   200020 756100                    STQ     RAT$+1,,AUTO
         1 000157   200020 630500                    EPPR0   RAT$+1,,AUTO
         1 000160   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000161   000000 701000 xent               TSX1    ELA$SYSLOG
         1 000162   000000 011000                    NOP     0
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:18   

      152     1872    2           END;

      153     1873    1         RETURN;

   1873  1 000163   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   0     000   161306 015344                                                    q...

REOPN
 Sect OctLoc
   0     001   161306 012144                                                    q..d

UPNLDT
 Sect OctLoc
   0     002   161306 012364                                                    q...

NOTUR
 Sect OctLoc
   0     003   161306 012224                                                    q...

(unnamed)
 Sect OctLoc
   2     000   000000 006000   777777 777677   000000 000027   000010 400000    ................
   2     004   000002 006000   000000 000146   000003 006000   000000 000000    .......f........
   2     010   000011 006000   000002 006000   000005 006000                    ............
      154     1874        /**/
      155     1875    1   END;
      156     1876        /**/
      157     1877        /**/
      158     1878        %EOD;

PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:19   
--  Include file information  --

   FR_SUBS.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FR_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure NKF$FORM.
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:20   

 **** Variables and constants ****

  ****  Section 000 RoData NKF$FORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w STRC        r     1 NOTUR                      1-0-0/w STRC        r     1 REOPN
     2-0-0/w STRC        r     1 UPNLDT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DEVNM                     4-0-0/w PTR         r     1 @FNAME
    15-0-0/w PTR         r     1 DCT$                      14-0-0/w UBIN        r     1 DCTX
    *0-0-0/c CHAR(8)     r     1 DEVNM                      5-0-0/w STRC(252)   r     1 FMNT
    *0-0-0/c CHAR(6)     r     1 FNAME                     16-0-0/w PTR         r     1 LDCT$
    17-0-0/w PTR         r     1 RAT$                      17-0-0/w UBIN        r     1 TEMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w STRC(432)   r     1 KC_OSID
     0-0-0/w PTR         r     1 N$DCT$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2088)  r     1 B$JIT                      0-0-0/w STRC(1332)  r     1 DCT
     0-0-0/w PTR         r     1 NK$LDCT$(0:0)
     0-0-0/w STRC(324)   r     1 RAT
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:21   


   Procedure NKF$FORM requires 116 words for executable code.
   Procedure NKF$FORM requires 22 words of local(AUTO) storage.
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:22   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:23   
          MINI XREF LISTING

B$JIT.ERR
      1507**DCL      1843<<ASSIGN   1850<<ASSIGN   1855<<ASSIGN
B$JIT.ERR.MID
      1508**DCL      1508--REDEF
B$JIT$
      1729**DCL      1502--IMP-PTR  1843>>ASSIGN   1850>>ASSIGN   1855>>ASSIGN
BDEV
      1838**LABEL    1836--CALLALT  1847--GOTO
DCT.DP
      1662**DCL      1669--REDEF    1672--REDEF    1673--REDEF    1675--REDEF    1675--REDEF    1676--REDEF
      1677--REDEF    1677--REDEF
DCT.MPC.IOCHANX
      1670**DCL      1670--REDEF
DCT.RAT$
      1643**DCL      1840>>IF       1846>>ASSIGN
DCT.STATUS.DOWN
      1659**DCL      1848>>IF
DCT$
      1691**DCL      1839<<ASSIGN   1840>>IF       1846>>ASSIGN   1848>>IF
DCTX
      1690**DCL      1833<>CALL     1839>>ASSIGN   1871<>CALL
DEVNM
      1493**DCL        18--PROC     1833<>CALL     1836<>CALL     1869>>ASSIGN
ELA$SYSLOG
      1723**DCL-ENT  1871--CALL
FMNT
      1688**DCL      1871<>CALL     1871--CALL
FMNT.DEVNAME
      1688**DCL      1869<<ASSIGN
FMNT.PSN
      1688**DCL      1870<<ASSIGN
FMNT.REQ_UTS
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:24   
      1688**DCL      1832<>CALL
FMNT.SYSID
      1688**DCL      1867<<ASSIGN
FMNT.VOLUME
      1688**DCL      1868<<ASSIGN
FNAME
      1494**DCL        18--PROC     1858>>ASSIGN   1868>>ASSIGN
KCO$FINDSTA
      1724**DCL-ENT  1836--CALL
KC_OSID
      1745**DCL      1836<>CALL
LDCT$
      1692**DCL      1836<>CALL
N$DCT$$
      1078**DCL      1078--IMP-PTR  1839>>ASSIGN
NK$LDCT$
      1078**DCL      1839>>ASSIGN
NOTUR
      1713**DCL      1843>>ASSIGN
OCZ$DEV_DCT
      1725**DCL-ENT  1833--CALL
RAT.FLG.FORM
      1628**DCL      1847>>IF
RAT.FLG.MBIT.MTD
      1623**DCL      1853>>IF
RAT.FLG.MBIT.SOL
      1625**DCL      1860>>IF       1862<<ASSIGN
RAT.FLG.OPN
      1627**DCL      1853>>IF
RAT.FLG.RUP
      1629**DCL      1859<<ASSIGN
RAT.FLG.SYMBIONT
      1631**DCL      1865>>IF
RAT.REEL.SER
      1616**DCL      1858<<ASSIGN
RAT.SOLU
PL6.E3A0      #001=NKF$FORM File=NKF$FORM.:E05TSI                                WED 07/30/97 03:44 Page:25   
      1620**DCL      1863<>CALL
RAT$
      1693**DCL      1694--REDEF    1846<<ASSIGN   1847>>IF       1853>>IF       1853>>IF       1858>>ASSIGN
      1859>>ASSIGN   1860>>IF       1862>>ASSIGN   1863>>CALL     1865>>IF
REOPN
      1705**DCL      1855>>ASSIGN
SSR$RUE
      1726**DCL-ENT  1863--CALL
SSS$SYSTIME
      1727**DCL-ENT  1832--CALL
TEMP
      1694**DCL      1835<<ASSIGN   1836<>CALL
UPNLDT
      1709**DCL      1850>>ASSIGN

PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:26   
      159        1        /*T***********************************************************/
      160        2        /*T*                                                         */
      161        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      162        4        /*T*                                                         */
      163        5        /*T***********************************************************/
      164        6        /**/
      165        7        /*F* NAME:         NKF$VFU
      166        8             PURPOSE:      To translate a software VFU image into its
      167        9                           hardware equivalent for local devices. */
      168       10        NKF$VFU: PROC (FS$SVFU,FS$HVFU,SIZE);
      169       11        /**/
      170       12
      171       13
      172       14
      173       15        /**/
      174       16        /* INCLUDES */
      175       17        /**/
      176       18        %INCLUDE FS_SUPER_C;
      177      781
      178      782
      179      783
      180      784        /**/
      181      785        /* PARAMETERS */
      182      786        /**/
      183      787        %FS$SVFU (NAME=FS$SVFU,STCLASS=CALIGNED);
      184      807        %FS$HVFU (NAME=FS$HVFU,STCLASS="");
      185      821    1   DCL SIZE UBIN WORD;
      186      822
      187      823
      188      824
      189      825        /**/
      190      826        /* BASED STRUCTURES */
      191      827        /**/
      192      828    1   DCL 1 VCHRB BASED,
      193      829    1         2 C CHAR(BIGST);
      194      830
      195      831
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:27   
      196      832
      197      833        /**/
      198      834        /* AUTO */
      199      835        /**/
      200      836    1   DCL LNTH UBIN WORD;
      201      837    1   DCL I UBIN WORD;
      202      838    1   DCL J UBIN WORD;
      203      839    1   DCL CUR UBIN WORD;
      204      840    1   DCL HX SBIN WORD;
      205      841    1   DCL BIGST UBIN WORD;
      206      842    1   DCL FRST UBIN WORD;
      207      843
      208      844
      209      845
      210      846        /**/
      211      847        /* SUBS */
      212      848        /**/
      213      849        %SUB CHN_TOF#='100'O/*TOF*/;  /* CHANNEL CODE FOR TOF */
      214      850        %SUB CHN_BOF#='060'O/*BOF*/;  /* CHANNEL CODE FOR BOF */
      215      851        /**/
      216      852        /**/
      217      853    1         FS$HVFU.LPI=FS$SVFU.LPI;
      218      854    1         FRST=FS$SVFU.FIRSTLINE;
      219      855    1         LNTH=FS$SVFU.LENGTH;
      220      856    1         IF LNTH=0 THEN LNTH=255-FRST-FS$SVFU.LIMBO;
      221      857    1         FS$HVFU.LNG=LNTH+FS$SVFU.LIMBO+FRST;
      222      858    1         FS$HVFU.BOF.LN=FS$HVFU.LNG;
      223      859    1         FRST=FRST+1;
      224      860    1         FS$HVFU.TOF.LN=FRST;
      225      861    1         FS$HVFU.TOF.CHN=CHN_TOF#;
      226      862    1         FS$HVFU.BOF.CHN=CHN_BOF#;
      227      863    1         HX=29;
      228      864    1         IF FS$SVFU.V.LINE~='0'B THEN
      229      865    2           DO;
      230      866    2   GETBIG: ;
      231      867    2           BIGST=0;
      232      868    3             DO I=1 TO 31;
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:28   
      233      869    3             IF FS$SVFU.V.LINE(I)>BIGST THEN
      234      870    4               DO;
      235      871    4               CUR=I;
      236      872    4               BIGST=FS$SVFU.V.LINE(I);
      237      873    4               END;
      238      874    3             END;
      239      875    2           IF BIGST=0 THEN GOTO DONE;
      240      876    2           HX=HX-1;
      241      877    2           FS$HVFU.V.LN(HX)=FS$SVFU.V.LINE(CUR)+FRST;
      242      878    2           FS$SVFU.V.LINE(CUR)=0;
      243      879    2   GETC:   ;
      244      880    3           IF CUR>15 THEN DO J=1 TO 31;
      245      881    3             IF FS$SVFU.V.NEXT(J)=CUR THEN
      246      882    4               DO;
      247      883    4               CUR=J;
      248      884    4               GOTO GETC;
      249      885    4               END;
      250      886    3             END;
      251      887    2           FS$HVFU.V.CHN(HX)=CUR;
      252      888    2           GOTO GETBIG;
      253      889    2           END;
      254      890    1   DONE: ;
      255      891    1         BIGST=(30-HX)*2;
      256      892    1         ADDR(FS$HVFU.V)->VCHRB.C=ADDR(FS$HVFU.V(HX))->VCHRB.C;
      257      893    1         SIZE=BIGST+LENGTHC(FS$HVFU.LPI)+LENGTHC(FS$HVFU.LNG)+LENGTHC(FS$HVFU.TOF);
      258      894    1         BIGST=LENGTHC(FS$HVFU)-SIZE;
      259      895    1         PINCRC(ADDR(FS$HVFU),SIZE)->VCHRB='0'B;
      260      896    1         SIZE=(SIZE+3)/4;
      261      897    1         RETURN;
      262      898        /**/
      263      899    1   END;
      264      900        /**/
      265      901        /**/

PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:29   
--  Include file information  --

   FS_SUPER_C.:E05TOU  is referenced.
      No diagnostics issued in procedure NKF$VFU.

   Procedure NKF$VFU requires 147 words for executable code.
   Procedure NKF$VFU requires 16 words of local(AUTO) storage.

    No errors detected in file NKF$FORM.:E05TSI    .

PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:30   

 Object Unit name= NKF$VFU                                    File name= NKF$FORM.:E05TOU
 UTS= JUL 30 '97 03:45:12.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   147    223  NKF$VFU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        3  NKF$VFU

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:31   


      159        1        /*T***********************************************************/
      160        2        /*T*                                                         */
      161        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      162        4        /*T*                                                         */
      163        5        /*T***********************************************************/
      164        6        /**/
      165        7        /*F* NAME:         NKF$VFU
      166        8             PURPOSE:      To translate a software VFU image into its
      167        9                           hardware equivalent for local devices. */
      168       10        NKF$VFU: PROC (FS$SVFU,FS$HVFU,SIZE);

     10  0 000000   000000 700200 xent  NKF$VFU      TSX0  ! X66_AUTO_3
         0 000001   000020 000003                    ZERO    16,3

      169       11        /**/
      170       12
      171       13
      172       14
      173       15        /**/
      174       16        /* INCLUDES */
      175       17        /**/
      176       18        %INCLUDE FS_SUPER_C;
      177      781
      178      782
      179      783
      180      784        /**/
      181      785        /* PARAMETERS */
      182      786        /**/
      183      787        %FS$SVFU (NAME=FS$SVFU,STCLASS=CALIGNED);
      184      807        %FS$HVFU (NAME=FS$HVFU,STCLASS="");
      185      821    1   DCL SIZE UBIN WORD;
      186      822
      187      823
      188      824
      189      825        /**/
      190      826        /* BASED STRUCTURES */
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:32   
      191      827        /**/
      192      828    1   DCL 1 VCHRB BASED,
      193      829    1         2 C CHAR(BIGST);
      194      830
      195      831
      196      832
      197      833        /**/
      198      834        /* AUTO */
      199      835        /**/
      200      836    1   DCL LNTH UBIN WORD;
      201      837    1   DCL I UBIN WORD;
      202      838    1   DCL J UBIN WORD;
      203      839    1   DCL CUR UBIN WORD;
      204      840    1   DCL HX SBIN WORD;
      205      841    1   DCL BIGST UBIN WORD;
      206      842    1   DCL FRST UBIN WORD;
      207      843
      208      844
      209      845
      210      846        /**/
      211      847        /* SUBS */
      212      848        /**/
      213      849        %SUB CHN_TOF#='100'O/*TOF*/;  /* CHANNEL CODE FOR TOF */
      214      850        %SUB CHN_BOF#='060'O/*BOF*/;  /* CHANNEL CODE FOR BOF */
      215      851        /**/
      216      852        /**/
      217      853    1         FS$HVFU.LPI=FS$SVFU.LPI;

    853  0 000002   200003 470500                    LDP0    @FS$SVFU,,AUTO
         0 000003   200004 471500                    LDP1    @FS$HVFU,,AUTO
         0 000004   000100 100500                    MLR     fill='000'O
         0 000005   000001 600001                    ADSC9   1,,PR0                   cn=3,n=1
         0 000006   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      218      854    1         FRST=FS$SVFU.FIRSTLINE;

    854  0 000007   000100 101500                    MRL     fill='000'O
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:33   
         0 000010   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1
         0 000011   200014 000004                    ADSC9   FRST,,AUTO               cn=0,n=4

      219      855    1         LNTH=FS$SVFU.LENGTH;

    855  0 000012   000100 101500                    MRL     fill='000'O
         0 000013   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
         0 000014   200006 000004                    ADSC9   LNTH,,AUTO               cn=0,n=4

      220      856    1         IF LNTH=0 THEN LNTH=255-FRST-FS$SVFU.LIMBO;

    856  0 000015   200006 235100                    LDA     LNTH,,AUTO
         0 000016   000027 601000 0                  TNZ     s:857

    856  0 000017   000100 101500                    MRL     fill='000'O
         0 000020   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         0 000021   200016 000004                    ADSC9   FRST+2,,AUTO             cn=0,n=4
         0 000022   200016 236100                    LDQ     FRST+2,,AUTO
         0 000023   200014 036100                    ADLQ    FRST,,AUTO
         0 000024   000027 676000 xsym               ERQ     B_VECTNIL+23
         0 000025   000400 036007                    ADLQ    256,DL
         0 000026   200006 756100                    STQ     LNTH,,AUTO

      221      857    1         FS$HVFU.LNG=LNTH+FS$SVFU.LIMBO+FRST;

    857  0 000027   000100 101500                    MRL     fill='000'O
         0 000030   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         0 000031   200016 000004                    ADSC9   FRST+2,,AUTO             cn=0,n=4
         0 000032   200016 236100                    LDQ     FRST+2,,AUTO
         0 000033   200006 036100                    ADLQ    LNTH,,AUTO
         0 000034   200014 036100                    ADLQ    FRST,,AUTO
         0 000035   000022 736000                    QLS     18
         0 000036   100000 552120                    STBQ    0,'20'O,PR1

      222      858    1         FS$HVFU.BOF.LN=FS$HVFU.LNG;

    858  0 000037   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:34   
         0 000040   000011 772000                    QRL     9
         0 000041   100017 552110                    STBQ    15,'10'O,PR1

      223      859    1         FRST=FRST+1;

    859  0 000042   200014 235100                    LDA     FRST,,AUTO
         0 000043   000001 035007                    ADLA    1,DL
         0 000044   200014 755100                    STA     FRST,,AUTO

      224      860    1         FS$HVFU.TOF.LN=FRST;

    860  0 000045   200014 236100                    LDQ     FRST,,AUTO
         0 000046   000011 736000                    QLS     9
         0 000047   100000 552110                    STBQ    0,'10'O,PR1

      225      861    1         FS$HVFU.TOF.CHN=CHN_TOF#;

    861  0 000050   000100 236007                    LDQ     64,DL
         0 000051   100000 552104                    STBQ    0,'04'O,PR1

      226      862    1         FS$HVFU.BOF.CHN=CHN_BOF#;

    862  0 000052   000060 236007                    LDQ     48,DL
         0 000053   100017 552104                    STBQ    15,'04'O,PR1

      227      863    1         HX=29;

    863  0 000054   000035 235007                    LDA     29,DL
         0 000055   200012 755100                    STA     HX,,AUTO

      228      864    1         IF FS$SVFU.V.LINE~='0'B THEN

    864  0 000056   000000 106500                    CMPC    fill='000'O
         0 000057   000005 000040                    ADSC9   5,,PR0                   cn=0,n=32
         0 000060   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         0 000061   000165 600000 0                  TZE     DONE

PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:35   
      229      865    2           DO;

    862  0 000062                       GETBIG       null
      230      866    2   GETBIG: ;
      231      867    2           BIGST=0;

    867  0 000062   200013 450100                    STZ     BIGST,,AUTO

      232      868    3             DO I=1 TO 31;

    868  0 000063   000001 235007                    LDA     1,DL
         0 000064   200007 755100                    STA     I,,AUTO

      233      869    3             IF FS$SVFU.V.LINE(I)>BIGST THEN

    869  0 000065   200003 470500                    LDP0    @FS$SVFU,,AUTO
         0 000066   200007 235100                    LDA     I,,AUTO
         0 000067   000100 101505                    MRL     fill='000'O
         0 000070   000005 000001                    ADSC9   5,A,PR0                  cn=0,n=1
         0 000071   200016 000004                    ADSC9   FRST+2,,AUTO             cn=0,n=4
         0 000072   200016 236100                    LDQ     FRST+2,,AUTO
         0 000073   200013 116100                    CMPQ    BIGST,,AUTO
         0 000074   000102 602000 0                  TNC     s:874
         0 000075   000102 600000 0                  TZE     s:874

      234      870    4               DO;

      235      871    4               CUR=I;

    871  0 000076   200011 755100                    STA     CUR,,AUTO

      236      872    4               BIGST=FS$SVFU.V.LINE(I);

    872  0 000077   000100 101505                    MRL     fill='000'O
         0 000100   000005 000001                    ADSC9   5,A,PR0                  cn=0,n=1
         0 000101   200013 000004                    ADSC9   BIGST,,AUTO              cn=0,n=4

PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:36   
      237      873    4               END;

      238      874    3             END;

    874  0 000102   000001 035007                    ADLA    1,DL
         0 000103   200007 755100                    STA     I,,AUTO
         0 000104   000040 115007                    CMPA    32,DL
         0 000105   000065 602000 0                  TNC     s:869

      239      875    2           IF BIGST=0 THEN GOTO DONE;

    875  0 000106   200013 236100                    LDQ     BIGST,,AUTO
         0 000107   000165 600000 0                  TZE     DONE

      240      876    2           HX=HX-1;

    876  0 000110   000001 336007                    LCQ     1,DL
         0 000111   200012 056100                    ASQ     HX,,AUTO

      241      877    2           FS$HVFU.V.LN(HX)=FS$SVFU.V.LINE(CUR)+FRST;

    877  0 000112   200011 235100                    LDA     CUR,,AUTO
         0 000113   000100 101505                    MRL     fill='000'O
         0 000114   000005 000001                    ADSC9   5,A,PR0                  cn=0,n=1
         0 000115   200016 000004                    ADSC9   FRST+2,,AUTO             cn=0,n=4
         0 000116   200016 236100                    LDQ     FRST+2,,AUTO
         0 000117   200014 036100                    ADLQ    FRST,,AUTO
         0 000120   200017 756100                    STQ     FRST+3,,AUTO
         0 000121   200012 235100                    LDA     HX,,AUTO
         0 000122   000001 735000                    ALS     1
         0 000123   200004 471500                    LDP1    @FS$HVFU,,AUTO
         0 000124   000105 101500                    MRL     fill='000'O
         0 000125   200017 000004                    ADSC9   FRST+3,,AUTO             cn=0,n=4
         0 000126   100001 000001                    ADSC9   1,A,PR1                  cn=0,n=1

      242      878    2           FS$SVFU.V.LINE(CUR)=0;

PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:37   
    878  0 000127   200011 236100                    LDQ     CUR,,AUTO
         0 000130   000106 101400                    MRL     fill='000'O
         0 000131   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         0 000132   000005 000001                    ADSC9   5,Q,PR0                  cn=0,n=1

    878  0 000133                       GETC         null
      243      879    2   GETC:   ;
      244      880    3           IF CUR>15 THEN DO J=1 TO 31;

    880  0 000133   200011 235100                    LDA     CUR,,AUTO
         0 000134   000020 115007                    CMPA    16,DL
         0 000135   000156 602000 0                  TNC     s:887

    880  0 000136   000001 236007                    LDQ     1,DL
         0 000137   200010 756100                    STQ     J,,AUTO

      245      881    3             IF FS$SVFU.V.NEXT(J)=CUR THEN

    881  0 000140   200003 470500                    LDP0    @FS$SVFU,,AUTO
         0 000141   200010 235100                    LDA     J,,AUTO
         0 000142   000100 101505                    MRL     fill='000'O
         0 000143   000015 000001                    ADSC9   13,A,PR0                 cn=0,n=1
         0 000144   200016 000004                    ADSC9   FRST+2,,AUTO             cn=0,n=4
         0 000145   200016 236100                    LDQ     FRST+2,,AUTO
         0 000146   200011 116100                    CMPQ    CUR,,AUTO
         0 000147   000152 601000 0                  TNZ     s:886

      246      882    4               DO;

      247      883    4               CUR=J;

    883  0 000150   200011 755100                    STA     CUR,,AUTO

      248      884    4               GOTO GETC;

    884  0 000151   000133 710000 0                  TRA     GETC

PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:38   
      249      885    4               END;
      250      886    3             END;

    886  0 000152   000001 035007                    ADLA    1,DL
         0 000153   200010 755100                    STA     J,,AUTO
         0 000154   000040 115007                    CMPA    32,DL
         0 000155   000140 602000 0                  TNC     s:881

      251      887    2           FS$HVFU.V.CHN(HX)=CUR;

    887  0 000156   200012 235100                    LDA     HX,,AUTO
         0 000157   000001 735000                    ALS     1
         0 000160   200004 470500                    LDP0    @FS$HVFU,,AUTO
         0 000161   000105 101500                    MRL     fill='000'O
         0 000162   200011 000004                    ADSC9   CUR,,AUTO                cn=0,n=4
         0 000163   000001 200001                    ADSC9   1,A,PR0                  cn=1,n=1

      252      888    2           GOTO GETBIG;

    888  0 000164   000062 710000 0                  TRA     GETBIG

    888  0 000165                       DONE         null
      253      889    2           END;
      254      890    1   DONE: ;
      255      891    1         BIGST=(30-HX)*2;

    891  0 000165   000036 235007                    LDA     30,DL
         0 000166   200012 135100                    SBLA    HX,,AUTO
         0 000167   000001 735000                    ALS     1
         0 000170   200013 755100                    STA     BIGST,,AUTO

      256      892    1         ADDR(FS$HVFU.V)->VCHRB.C=ADDR(FS$HVFU.V(HX))->VCHRB.C;

    892  0 000171   200012 236100                    LDQ     HX,,AUTO
         0 000172   000001 736000                    QLS     1
         0 000173   200004 471500                    LDP1    @FS$HVFU,,AUTO
         0 000174   000000 620005                    EAX0    0,AL
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:39   
         0 000175   200013 721100                    LXL1    BIGST,,AUTO
         0 000176   040140 100546                    MLR     fill='040'O
         0 000177   100001 000010                    ADSC9   1,Q,PR1                  cn=0,n=*X0
         0 000200   100001 000011                    ADSC9   1,,PR1                   cn=0,n=*X1

      257      893    1         SIZE=BIGST+LENGTHC(FS$HVFU.LPI)+LENGTHC(FS$HVFU.LNG)+LENGTHC(FS$HVFU.TOF);

    893  0 000201   200005 473500                    LDP3    @SIZE,,AUTO
         0 000202   200013 235100                    LDA     BIGST,,AUTO
         0 000203   000004 035007                    ADLA    4,DL
         0 000204   300000 755100                    STA     0,,PR3

      258      894    1         BIGST=LENGTHC(FS$HVFU)-SIZE;

    894  0 000205   300000 235100                    LDA     0,,PR3
         0 000206   000027 675000 xsym               ERA     B_VECTNIL+23
         0 000207   000101 035007                    ADLA    65,DL
         0 000210   200013 755100                    STA     BIGST,,AUTO

      259      895    1         PINCRC(ADDR(FS$HVFU),SIZE)->VCHRB='0'B;

    895  0 000211   300000 236100                    LDQ     0,,PR3
         0 000212   000000 620005                    EAX0    0,AL
         0 000213   000146 100400                    MLR     fill='000'O
         0 000214   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         0 000215   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0

      260      896    1         SIZE=(SIZE+3)/4;

    896  0 000216   300000 236100                    LDQ     0,,PR3
         0 000217   000003 036007                    ADLQ    3,DL
         0 000220   000002 772000                    QRL     2
         0 000221   300000 756100                    STQ     0,,PR3

      261      897    1         RETURN;

    897  0 000222   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:40   
      262      898        /**/
      263      899    1   END;
      264      900        /**/
      265      901        /**/

PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:41   
--  Include file information  --

   FS_SUPER_C.:E05TOU  is referenced.
      No diagnostics issued in procedure NKF$VFU.
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:42   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @FS$HVFU                   3-0-0/w PTR         r     1 @FS$SVFU
     5-0-0/w PTR         r     1 @SIZE                     13-0-0/w UBIN        r     1 BIGST
    11-0-0/w UBIN        r     1 CUR                       14-0-0/w UBIN        r     1 FRST
    *0-0-0/w STRC(576)   r     1 FS$HVFU                   *0-0-0/c STRC(756)   r     1 FS$SVFU
    12-0-0/w SBIN        r     1 HX                         7-0-0/w UBIN        r     1 I
    10-0-0/w UBIN        r     1 J                          6-0-0/w UBIN        r     1 LNTH
    *0-0-0/w UBIN        r     1 SIZE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(0)     r     1 VCHRB


   Procedure NKF$VFU requires 147 words for executable code.
   Procedure NKF$VFU requires 16 words of local(AUTO) storage.

    No errors detected in file NKF$FORM.:E05TSI    .
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:43   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:44   
          MINI XREF LISTING

BIGST
       841**DCL       829--IMP-SIZ   867<<ASSIGN    869>>IF        872<<ASSIGN    875>>IF        891<<ASSIGN
       892>>ASSIGN    892>>ASSIGN    893>>ASSIGN    894<<ASSIGN    895>>ASSIGN
CUR
       839**DCL       871<<ASSIGN    877>>ASSIGN    878>>ASSIGN    880>>IF        881>>IF        883<<ASSIGN
       887>>ASSIGN
DONE
       888**LABEL     875--GOTO
FRST
       842**DCL       854<<ASSIGN    856>>ASSIGN    857>>ASSIGN    859<<ASSIGN    859>>ASSIGN    860>>ASSIGN
       877>>ASSIGN
FS$HVFU
       808**DCL        10--PROC      894--ASSIGN    895--ASSIGN
FS$HVFU.BOF.CHN
       819**DCL       862<<ASSIGN
FS$HVFU.BOF.LN
       818**DCL       858<<ASSIGN
FS$HVFU.LNG
       810**DCL       857<<ASSIGN    858>>ASSIGN    893--ASSIGN
FS$HVFU.LPI
       809**DCL       853<<ASSIGN    893--ASSIGN
FS$HVFU.TOF
       811**DCL       893--ASSIGN
FS$HVFU.TOF.CHN
       813**DCL       861<<ASSIGN
FS$HVFU.TOF.LN
       812**DCL       860<<ASSIGN
FS$HVFU.V
       814**DCL       892--ASSIGN    892--ASSIGN
FS$HVFU.V.CHN
       816**DCL       887<<ASSIGN
FS$HVFU.V.LN
PL6.E3A0      #002=NKF$VFU File=NKF$FORM.:E05TSI                                 WED 07/30/97 03:45 Page:45   
       815**DCL       877<<ASSIGN
FS$SVFU
       788**DCL        10--PROC
FS$SVFU.FIRSTLINE
       795**DCL       854>>ASSIGN
FS$SVFU.LENGTH
       793**DCL       855>>ASSIGN
FS$SVFU.LIMBO
       794**DCL       856>>ASSIGN    857>>ASSIGN
FS$SVFU.LPI
       798**DCL       853>>ASSIGN
FS$SVFU.V.LINE
       804**DCL       864>>IF        869>>IF        872>>ASSIGN    877>>ASSIGN    878<<ASSIGN
FS$SVFU.V.NEXT
       805**DCL       881>>IF
GETBIG
       862**LABEL     888--GOTO
GETC
       878**LABEL     884--GOTO
HX
       840**DCL       863<<ASSIGN    876<<ASSIGN    876>>ASSIGN    877>>ASSIGN    887>>ASSIGN    891>>ASSIGN
       892>>ASSIGN
I
       837**DCL       868<<DOINDEX   869>>IF        871>>ASSIGN    872>>ASSIGN
J
       838**DCL       880<<DOINDEX   881>>IF        883>>ASSIGN
LNTH
       836**DCL       855<<ASSIGN    856>>IF        856<<ASSIGN    857>>ASSIGN
SIZE
       821**DCL        10--PROC      893<<ASSIGN    894>>ASSIGN    895>>ASSIGN    896<<ASSIGN    896>>ASSIGN
VCHRB
       828**DCL       895<<ASSIGN
VCHRB.C
       829**DCL       892<<ASSIGN    892>>ASSIGN
