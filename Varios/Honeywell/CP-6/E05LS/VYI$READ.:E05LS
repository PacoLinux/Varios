VERSION E05

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:1    
        1        1        /*M* VYI$READ - M$READ/M$WRITE interface for LEMUR */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=6,IND=4,CSU=2,EXM=0,ECU=2,MOC,DCI=4,CRT=4,CTI=8,CCC */
        8        8        VYI$READ: PROC(         TYPE, BUF$, SIZE, KEY, P_OVERWRITE ) ALTRET;
        9        9        %INCLUDE VY_INC_C;
       10     9185        %INCLUDE VY_PSUBS_C;
       11     9246        %VY$WORD;

              9258    1   /*******************************************************************************
              9259    1   *                                                                              *
              9260    1   *                          VY$WORD                                                 *
              9261    1   *                                                                              *
              9262    1   *******************************************************************************/

              9267    1   DCL VY$WORD_A(0:0)       UBIN(36) ALIGNED    BASED;
              9268    1   DCL VY$HALF_A(0:0)       UBIN(18) HALIGNED   BASED;
              9269    1   DCL VY$BYTE_A(0:0)       UBIN( 9) CALIGNED   BASED;
              9270    1   DCL VY$CHAR_A(0:0)       CHAR( 1) UNAL       BASED;
              9271        /**/
              9272    1   DCL VY$WORD_SBIN_A(0:0)  SBIN WORD ALIGNED   BASED;
              9273    1   DCL VY$HALF_SBIN_A(0:0)  SBIN HALF HALIGNED  BASED;
              9274    1   DCL VY$BYTE_SBIN_A(0:0)  SBIN HALF CALIGNED  BASED;
              9275    1   DCL VY$BIT_A(0:0)        BIT(36)   ALIGNED   BASED;
       12     9278        %T$C;

              9290    1   /*******************************************************************************
              9291    1   *                                                                              *
              9292    1   *                          T$C                                                 *
              9293    1   *                                                                              *
              9294    1   *******************************************************************************/

              9299    1   DCL 1 T$C           BASED     ALIGNED,  /* Text count                         */
              9300    1         2 COUNT        UBIN( 9) UNAL,
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:2    
              9301    1         2 CHARS        CHAR( T$C.COUNT )   UNAL;
              9302    1   DCL 1 T$C_UNAL      BASED     UNAL,     /* Text count                         */
              9303    1         2 COUNT        UBIN( 9) UNAL,
              9304    1         2 CHARS        CHAR( T$C_UNAL.COUNT ) UNAL;
       13     9307        %B$TCB;
       14     9310        %B$ALT;
       15     9318        %PLIST;
       16     9319        %INCLUDE B_ERRORS_C;
       17    10446        %LIST;
       18    10447        %ENTRIES;
             10448    1   DCL VYE$ERROR       ENTRY(4);
             10449    1   DCL VYE$ERR         ENTRY(3);
             10450    1   DCL VYE$MERC        ENTRY;
             10451    1   DCL VYE$ERRMSG      ENTRY(1);
             10452    1   DCL VYR$READ        ENTRY( 3 ) ALTRET;
             10453    1   DCL VYW$WRITE       ENTRY( 3 ) ALTRET;
             10454    1   DCL VYW$WRITE_DO    ENTRY( 2 ) ALTRET;
             10455    1   DCL VYD$B2C         ENTRY( 5 );
             10456    1   DCL VYD$C2B         ENTRY( 3 );
             10457    1   DCL VYA$GET         ENTRY( 3 );
             10458    1   DCL VYF$FREE        ENTRY( 3 );
             10459    1   DCL VYQ$SORT        ENTRY( 7 );
             10460    1   DCL VYY$YESNO       ENTRY( 1 );
       19    10462    1   DCL VYI$ERR         ENTRY;
       20    10463    1   DCL VYO$DEL_UNIT ENTRY(6);
       21    10464        %P;
             10465        %LSET LISTDIR='0'B;

             10472    1   /*******************************************************************************
             10473    1   *                                                                              *
             10474    1   *                          PARAMETERS                                              *
             10475    1   *                                                                              *
             10476    1   *******************************************************************************/

       22    10480    1   DCL TYPE            UBIN(36)       ALIGNED;
       23    10481    1   DCL BUF$            PTR            ALIGNED;
       24    10482    1   DCL SIZE            UBIN(36)       ALIGNED;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:3    
       25    10483    1   DCL KEY             UBIN(36)       ALIGNED;
       26    10484    1   DCL P_OVERWRITE        BIT(1)         ALIGNED;
       27    10485        %BANNER(ARG=SUBS);
             10486        %LSET LISTDIR='0'B;

             10493    1   /*******************************************************************************
             10494    1   *                                                                              *
             10495    1   *                          SUBS                                                 *
             10496    1   *                                                                              *
             10497    1   *******************************************************************************/

       28    10501        %B$RECORDSUBS;
             10502        %EQU TYPHEAD=0 ;
             10503        %EQU TYPDNAM=1 ;
             10504        %EQU TYPRNAM=2 ;
             10505        %EQU TYPSECT=3 ;
             10506        %EQU TYPEDEF=4 ;
             10507        %EQU TYPEREF=5 ;
             10508        %EQU TYPSDEF=6 ;
             10509        %EQU TYPSREF=7 ;
             10510        %EQU TYPSEGDEF=8 ;
             10511        %EQU TYPSEGREF=9 ;
             10512        %EQU TYPPROG=10 ;
             10513        %EQU SUBTYPPROG=0 ;
             10514        %EQU SUBTYPREL=1 ;
             10515        %EQU TYPLOGBLK=11 ;
             10516        %EQU TYPINTNTRY=12 ;
             10517        %EQU TYPEXST=13 ;
             10518        %EQU TYPVREBL=14 ;
             10519        %EQU TYPDBGNAM=15 ;
             10520        %EQU TYPLV1LB=16 ;
             10521        %EQU TYPLV1=17 ;
             10522        %EQU TYPDATASEG=18 ;
             10523        %EQU TYPRUM=20 ;
             10524        %EQU TYPBIRTH=21 ;
             10525        %EQU TYPPLOVER=22 ;
             10526        %EQU TYPCOMPID=23 ;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:4    
             10527        %EQU TYPROS=30 ;
       29    10529        %PTR;
             10530        %LSET LISTDIR='0'B;

             10537    1   /*******************************************************************************
             10538    1   *                                                                              *
             10539    1   *                          PTR                                                 *
             10540    1   *                                                                              *
             10541    1   *******************************************************************************/

       30    10545    1   DCL DCB$            PTR            ALIGNED   STATIC/*AUTO*/;
       31    10546    1   DCL FPT$            PTR            ALIGNED   STATIC/*AUTO*/;
       32    10547    1   DCL K$              PTR            ALIGNED   STATIC/*AUTO*/;
       33    10548    1   DCL BREAK$          PTR            ALIGNED   EXT;
       34    10549        %E;
             10550        %LSET LISTDIR='0'B;

             10557    1   /*******************************************************************************
             10558    1   *                                                                              *
             10559    1   *                          ENTRY                                                 *
             10560    1   *                                                                              *
             10561    1   *******************************************************************************/

       35    10565        %U;
             10566        %LSET LISTDIR='0'B;

             10573    1   /*******************************************************************************
             10574    1   *                                                                              *
             10575    1   *                          UBIN                                                 *
             10576    1   *                                                                              *
             10577    1   *******************************************************************************/

       36    10581    1   DCL ERR             UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       37    10582    1   DCL KEY_TYPE        UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       38    10583    1   DCL RTYPE           UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       39    10584    1   DCL SIZE2           UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       40    10585        %S;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:5    
             10586        %LSET LISTDIR='0'B;

             10593    1   /*******************************************************************************
             10594    1   *                                                                              *
             10595    1   *                          SBIN                                                 *
             10596    1   *                                                                              *
             10597    1   *******************************************************************************/

       41    10601    1   DCL PREV#           SBIN WORD      ALIGNED   STATIC/*AUTO*/;
       42    10602    1   DCL KEYFORM         SBIN WORD      ALIGNED   STATIC/*AUTO*/;
       43    10603    1   DCL CURR#           SBIN WORD      ALIGNED   STATIC/*AUTO*/;
       44    10604    1   DCL COUNT           UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       45    10605    1   DCL OVERWRITE        BIT(1)         ALIGNED;
       46    10606    1   DCL M$OF            DCB;
       47    10607    1   DCL M$LF            DCB;
       48    10608    1   DCL M$RF            DCB;
       49    10609    1   DCL 1 C$STRING BASED,
       50    10610    1         2 COUNT UBIN(9) UNAL,
       51    10611    1         2 CHARS(0:510) CHAR(1) UNAL;
       52    10612        %FPT_READ( FPTN=F$R, STCLASS="BASED(FPT$)");
             10613        %LSET LISTDIR='0'B;
             10629    1   DCL 1 F$R BASED(FPT$),2 V_ BIT(72)/*(VECTOR(F$R.V))/**/,2 KEY_,3 BOUND UBIN(20)UNAL
             10629            /*(SIZEV(NIL))
             10630    1   /**/,3 * BIT(12)/*('7772'O)/**/,3 * BIT(4)/*('0'B)/**/,3 KEY$ PTR /*(ADDR(NIL))
             10631    1   /**/,2 BUF_,3 BOUND UBIN(20)UNAL /*(SIZEV(NIL))/**/,3 * BIT(12)/*('7772'O)/**/,3 *
             10631            BIT(4)/*
             10632    1   ('0'B)/**/,3 BUF$ PTR /*(ADDR(NIL))/**/,2 STATION_ BIT(72)/*(VECTOR(NIL))
             10633    1   /**/,2 IDBUF_ REDEF STATION_ BIT(72),2 V DALIGNED,3 DCB# UBIN(18)UNAL /*(DCBNUM(NIL)
             10633            )/**/,3 WAIT# BIT(1)/*
             10634    1   ('1'B)/**/ ,3 KEYS# BIT(1)/*('0'B)/**/ ,3 KEYR# BIT(1)/*('0'B)/**/ ,3 ID# BIT(1)/*
             10635    1   ('0'B)/**/,3 KEYCHNG# BIT(1)/*('0'B)/**/,3 FULL# BIT(1)/*('0'B)/**/ ,3 IDS# BIT(1
             10636    1   )/*('0'B)/**/,3 IOERROK# BIT(1)/*('0'B)/**/,3 * BIT(1)/*('0'B)/**/,
             10642    1   3 INDX# UBIN(9)UNAL /*(0)/**/,3 KEYTYPE# REDEF INDX# UBIN BYTE CALIGNED,3 EVENT#
             10642            SBIN /*
             10643    1   (0)/**/,3 SEED# BIT(36)/*('0'B)/**/,3 DVBYTE,4 TOP# BIT(1)/*('0'B)/**/,4 BP# BIT(1
             10644    1   )/*('0'B)/**/,4 REREAD# BIT(1)/*('0'B)/**/,4 VFC# REDEF REREAD# BIT(1),4 BIN# BIT(1)
             10644            /*('0'B
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:6    
             10645    1   )/**/,4 TRANS# BIT(1)/*('0'B)/**/,4 * BIT(1)/*('0'B)/**/,4 NODAT# BIT(1)/*('0'B
             10646    1   )/**/,4 * BIT(1)/*('0'B)/**/,4 CONT# BIT(1)/*('0'B)/**/,3 STRPVFC# BIT(1)/*('0'B
             10647    1   )/**/,3 ODFNC# UBIN(8)UNAL /*(0)/**/,3 RECNUM# UBIN(18)UNAL /*(0)/**/,3
             10648    1   SINPUTSIZE# UBIN(18)UNAL /*(0)/**/,3 REREADPOS# UBIN(18)UNAL /*(0)/**/,3 * UBIN
             10649    1   UNAL /*(0)/**/;
       53    10651        %FPT_WRITE( FPTN=F$W, STCLASS="BASED(FPT$)");
             10652        %LSET LISTDIR='0'B;
             10668    1   DCL 1 F$W BASED(FPT$),2 V_ BIT(72)/*(VECTOR(F$W.V))/**/,2 KEY_ BIT(72)/*(VECTOR(NIL)
             10668            )/**/,2 BUF_,3
             10669    1   BOUND UBIN(20)UNAL /*(SIZEV(NIL))/**/,3 * BIT(12)/*('7772'O)/**/,3 * BIT(4)/*('0'B)
             10670    1   /**/,3 BUF$ PTR /*(ADDR(NIL))/**/,2 STATION_ BIT(72)/*(VECTOR(NIL))/**/,2
             10671    1   IDBUF_ REDEF STATION_ BIT(72),2 V DALIGNED,3 DCB# UBIN(18)UNAL /*(DCBNUM(NIL))/**/,3
             10671            WAIT# BIT(1)/*('1'B
             10672    1   )/**/ ,3 * BIT(2)/*('0'B)/**/,3 ID# BIT(1)/*('0'B)/**/,3 * BIT(1)/*('0'B)
             10673    1   /**/,3 FULL# BIT(1)/*('0'B)/**/ ,3 * BIT(3)/*('0'B)/**/,3 ONEWKEY# BIT(1)/*('1'B)
             10674    1   /**/ ,3 NEWKEY# BIT(1)/*('0'B)/**/ ,3 REWRITE# BIT(1)/*('0'B)/**/ ,3 NOTIME# BIT(1)
             10674            /*
             10675    1   ('0'B)/**/ ,3 IOERROK# BIT(1)/*('0'B)/**/ ,3 KEYTYPE# UBIN(4)/*(0)/**/ UNAL,
             10676    1   3 EVENT# SBIN /*(0)/**/,3 SEED# BIT(36)/*('0'B)/**/,3 DVBYTE,4 TOP# BIT(1)/*('0'B)
             10677    1   /**/,4 BP# BIT(1)/*('0'B)/**/,4 VFC# BIT(1)/*('0'B)/**/,4 REREAD# REDEF VFC# BIT(1),
             10677            4 BIN# BIT(1
             10678    1   )/*('0'B)/**/,4 TRANS# BIT(1)/*('0'B)/**/,4 RRR# BIT(1)/*('0'B)/**/,4 NODAT# BIT(1
             10679    1   )/*('0'B)/**/,4 * BIT(1)/*('0'B)/**/,4 CONT# BIT(1)/*('0'B)/**/,3 * BIT(1)/*
             10680    1   ('0'B)/**/,3 ODFNC# UBIN(8)UNAL /*(0)/**/,3 * UBIN(18)UNAL /*(0)/**/;
       54    10682        %O_KEY_BUF( KEYBUF=K$B,
       55    10683                          STCLASS="BASED(K$)",
       56    10684                          INT="");
             10685    1   DCL 1 K$B ALIGNED BASED(K$) ,
             10686    1          2 FORM0 ,
             10687    1           3 COUNT       UBIN( 9)  UNAL,
             10688    1           3 CHARS       CHAR(512) UNAL,
             10689    1         2 FORM1        REDEF     FORM0,
             10690    1           3 COUNT       UBIN( 9)  UNAL,
             10691    1           3 O777        UBIN( 9)  UNAL,   /* <- '777'O                          */
             10692    1           3 UTS         UBIN(36)  UNAL,
             10693    1           3 REC_TYPE    UBIN( 9)  UNAL,
             10694    1           3 PAGE#       UBIN( 9)  UNAL,
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:7    
             10695    1           3 *           CHAR(505),
             10696    1         2 FORM2        REDEF     FORM0,
             10697    1           3 COUNT       UBIN( 9)  UNAL,
             10698    1           3 O777        UBIN( 9)  UNAL,   /* <- '777'O                          */
             10699    1           3 UTS         UBIN(36)  UNAL,
             10700    1           3 D10         UBIN( 9)  UNAL,   /* <- 10                              */
             10701    1           3 SECT#       UBIN(18)  UNAL,
             10702    1           3 OFFSET      UBIN(18)  UNAL,
             10703    1           3 STYPE       UBIN( 9)  UNAL,
             10704    1           3 SEQUENCE    UBIN( 9)  UNAL,
             10705    1           3 *           CHAR(500) ;
       57    10707        %R_KEY_BUF( KEYBUF=K$R,
       58    10708                          STCLASS="BASED(K$)",
       59    10709                          INT="");
             10710    1   DCL 1 K$R                        BASED(K$),
             10711    1         2 FORM0                  ALIGNED,
             10712    1           3 COUNT       UBIN( 9)  UNAL,
             10713    1           3 CHARS       CHAR( 4)  UNAL,
             10714    1           3 *           CHAR( 7)  UNAL,
             10715    1         2 FORM1        REDEF     FORM0,
             10716    1           3 COUNT       UBIN( 9)  UNAL,
             10717    1           3 REC_TYPE    UBIN( 9)  UNAL,
             10718    1           3 NODE#       UBIN(18)  UNAL,
             10719    1           3 OFFSET      UBIN(18)  UNAL,
             10720    1           3 *           CHAR( 6)  UNAL,
             10721    1         2 FORM2        REDEF     FORM0,
             10722    1           3 COUNT       UBIN( 9)  UNAL,
             10723    1           3 O777        UBIN( 9)  UNAL,   /* <- '777'O                          */
             10724    1           3 NODE#       UBIN(18)  UNAL,
             10725    1           3 P_ENTDEF    UBIN(18)  UNAL,
             10726    1           3 REC_TYPE    UBIN( 9)  UNAL,
             10727    1           3 PAGE#       UBIN( 9)  UNAL,
             10728    1           3 *           CHAR( 4)  UNAL;
       60    10730        %PLIST;
       61    10731        %F$DCB;
       62    10788        %FPT_READ( FPTN=VY_O_FPT_READ,
       63    10789                   DCB=M$OF,
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:8    
       64    10790                   KEY=VY_O_KEY_BUF,
       65    10791                   KEYS=YES,
       66    10792                   KEYR=YES,
       67    10793                   STCLASS="STATIC SYMDEF");
       68    10832        %PLIST;
       69    10833        %FPT_READ( FPTN=VY_R_FPT_READ,
       70    10834                   DCB=M$RF,
       71    10835                   KEY=VY_R_KEY_BUF,
       72    10836                   KEYS=YES,
       73    10837                   KEYR=YES,
       74    10838                   STCLASS="STATIC SYMDEF");
       75    10877        %FPT_WRITE( FPTN=VY_O_FPT_WRITE,
       76    10878                   DCB=M$OF,
       77    10879                   KEY=VY_O_KEY_BUF,
       78    10880                   STCLASS="STATIC SYMDEF");
       79    10911        %FPT_WRITE( FPTN=VY_R_FPT_WRITE,
       80    10912                   DCB=M$RF,
       81    10913                   KEY=VY_R_KEY_BUF,
       82    10914                   STCLASS="STATIC SYMDEF");
       83    10945        /******Delete
       84    10946        %FPT_READ( FPTN=VY_L_FPT_READ,
       85    10947                   DCB=M$LF,
       86    10948                   KEY=VY_O_KEY_BUF,
       87    10949                   keys=yes,
       88    10950                   keyr=yes,
       89    10951                   stclass="static symdef");
       90    10952        eteled******/
       91    10953    1   DCL VYI_ROLLBACK BIT(1) STATIC SYMDEF INIT('0'B);
       92    10954        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:9    
       93    10955    2         DO CASE( TYPE );
       94    10956    2           CASE( 0/*@OF*/ );
       95    10957    2             FPT$ = ADDR( VY_O_FPT_READ );
       96    10958    2             DCB$ = M$OF$;
       97    10959    2           CASE( 1/*@RF*/ );
       98    10960    2             FPT$ = ADDR( VY_R_FPT_READ );
       99    10961    2             DCB$ = M$RF$;
      100    10962    2           CASE( 2/*@LF*/ );
      101    10963    2             FPT$ = ADDR( VY_O_FPT_READ );
      102    10964    2             DCB$ = M$LF$;
      103    10965    2           CASE(ELSE);
      104    10966        /*E*  ERROR: VYI-E$INTERNAL_READ_BAD_TYPE_VY-0
      105    10967              MESSAGE: Internal link error. Bad type passed to VYI$READ: Type = %U1.
      106    10968              DESCRIPTION: Self-explanatory.
      107    10969        */
      108    10970                  %NUMBER(
      109    10971                  NUM1=TYPE, BASE1=10, SIZE1=12 );
      110    10988                  %SCREAM(
      111    10989                  ERR#=%E$INTERNAL_READ_BAD_TYPE_VY,
      112    10990                  MID="'I'",
      113    10991                  LEVEL=%@E$F_VY,
      114    10992                  AUX=%@E$OF_VY);
      115    10995    2           END;
      116    10996    1         F$R.BUF_.BOUND   = SIZE * 4 - 1;
      117    10997    1         F$R.BUF_.BUF$   = BUF$;
      118    10998    1         F$R.V.KEYR# = '1'B/*@YES_B*/;
      119    10999    1         KEY_TYPE = KEY;
      120    11000    1         IF KEY_TYPE = 4/*@NO_KEY*/ THEN KEY_TYPE = TYPE;
      121    11001    2         DO CASE( KEY_TYPE );
      122    11002    2           CASE( 0/*@OF*/ );
      123    11003    2             F$R.KEY_   = VECTOR( VY_O_KEY_BUF );
      124    11004    2             K$ = ADDR(VY_O_KEY_BUF);
      125    11005    2           CASE( 1/*@RF*/ );
      126    11006    2             F$R.KEY_   = VECTOR( VY_R_KEY_BUF );
      127    11007    2             K$ = ADDR( VY_R_KEY_BUF );
      128    11008    2           CASE( 2/*@LF*/ );
      129    11009    2             F$R.KEY_   = VECTOR( VY_O_KEY_BUF );
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:10   
      130    11010    2             K$ = ADDR( VY_O_KEY_BUF );
      131    11011    2           CASE(ELSE);
      132    11012        /*E*  ERROR: VYI-E$INTERNAL_READ_BAD_KEY_TP_VY-0
      133    11013              MESSAGE: Internal link error. Bad key type passed to VYI$READ: Key type = %U1.
      134    11014              DESCRIPTION: Self-explanatory.
      135    11015        */
      136    11016                  %NUMBER(
      137    11017                  NUM1=KEY_TYPE, BASE1=10, SIZE1=12 );
      138    11034                  %SCREAM(
      139    11035                  ERR#=%E$INTERNAL_READ_BAD_KEY_TP_VY,
      140    11036                  MID="'I'",
      141    11037                  LEVEL=%@E$F_VY,
      142    11038                  AUX=%@E$OF_VY);
      143    11041    2           END;
      144    11042    1         BREAK$ = K$;
      145    11043    2         IF KEY ~= 4/*@NO_KEY*/ THEN DO;
      146    11044    2             F$R.V.KEYS# = '1'B/*@YES_B*/;
      147    11045    3             IF VY_IO_USEPREV ~= 1/*@YES*/ THEN DO;
      148    11046    3                END;                       /* If VY_IO_USEPREV ~= @YES then do; */
      149    11047    3             ELSE DO;                      /* If VY_IO_USEPREV ~= @YES then do; */
      150    11048    3                 VY_IO_USEPREV = 0/*@NO*/;
      151    11049    3                 IF VY_IO_SAVEPREV = 2 THEN F$R.V.KEYS# = '0'B/*@NO_B*/;
      152    11050    4                 DO CASE(KEY);
      153    11051    4                   CASE(0/*@OF*/);
      154    11052    4                     VY_O_KEY_BUF = VY_O_KEY_BUF_L;
      155    11053    4                   CASE(ELSE);
      156    11054        /*E*  ERROR: VYI-E$INTERNAL_READ_SAVE_PREV_VY-0
      157    11055         MESSAGE: Internal link error. Save previous switch set for non-object file in VYI$R
             11055        EAD.
      158    11056              DESCRIPTION: Self-explanatory.
      159    11057        */
      160    11058                          %SCREAM(
      161    11059                          ERR#=%E$INTERNAL_READ_SAVE_PREV_VY,
      162    11060                          MID="'I'",
      163    11061                          LEVEL=%@E$F_VY,
      164    11062                          AUX=%@E$OF_VY);
      165    11065    4                   END;                    /* Do case(key); */
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:11   
      166    11066    3                END;           /*Else do; - if VY_IO_USEPREV ~= @YES then do; */
      167    11067    2            END;                           /* If key ~= @NO_KEY then do; */
      168    11068    2         ELSE DO;                          /* If key ~= @NO_KEY then do; */
      169    11069    2             F$R.V.KEYS# = '0'B/*@NO_B*/;
      170    11070    2            END;                       /* Else do; - if key ~= @NO_KEY then do; */
      171    11071    1         CALL M$READ( F$R )            ALTRET( READ_ERROR );
      172    11072    1         VY_IO_STATUS = -1;
      173    11073    1   CONTINUE:
      174    11074    2         IF VY_IO_SAVEPREV ~= 0/*@NO*/ THEN DO;
      175    11075    2             VY_IO_SAVEPREV = 0/*@NO*/;         /*Reset*/
      176    11076    3             DO CASE( TYPE );
      177    11077    3               CASE(0/*@OF*/);
      178    11078    3                 VY_O_KEY_BUF_L.FORM0.COUNT = VY_O_KEY_BUF.FORM0.COUNT;
      179    11079    3                 VY_O_KEY_BUF_L.FORM0.CHARS = VY_O_KEY_BUF.FORM0.CHARS;
      180    11080    3               CASE(ELSE);
      181    11081        /*E*  ERROR: VYI-E$INTERNAL_READ_USE_PREV_VY-0
      182    11082         MESSAGE: Internal link error. Use previous switch set for non-object file in VYI$RE
             11082        AD.
      183    11083              DESCRIPTION: Self-explanatory.
      184    11084        */
      185    11085                      %SCREAM(
      186    11086                      ERR#=%E$INTERNAL_READ_USE_PREV_VY,
      187    11087                      MID="'I'",
      188    11088                      LEVEL=%@E$F_VY,
      189    11089                      AUX=%@E$OF_VY);
      190    11092    3               END;
      191    11093    2            END;
      192    11094    1         VY_IO_SIZEC = DCB$ -> F$DCB.ARS#;
      193    11095    1         VY_IO_SIZEW = ( VY_IO_SIZEC + 4/*@CHAR_WORD*/ - 1 ) /4/*@CHAR_WORD*/;
      194    11096    1         VY_OK.KFILE = TYPE;
      195    11097    2         IF K$ -> C$STRING.CHARS(0) = VY_O_KEY_HEAD THEN DO;
      196    11098                                                /*Head record*/
      197    11099    2             VY_OK.KTYPE  = -1;
      198    11100    2             VY_LAST_UTS = VY_OU_HEAD.UTS; /* Save uts */
      199    11101    2             VY_OK.OUNAME.COUNT = K$B.FORM0.COUNT - 1; /* Set count */
      200    11102    2             VY_OK.OUNAME.CHARS = SUBSTR( K$B.FORM0.CHARS,1,VY_OK.OUNAME.COUNT );
      201    11103                                        /* Move object unit name into textc buffer */
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:12   
      202    11104    2            END;
      203    11105    1         ELSE
      204    11106    1             IF K$ -> T$C.CHARS = VY_O_KEY_TREE THEN VY_OK.KTYPE = -2;
      205    11107    1             ELSE
      206    11108    2                 IF K$B.FORM1.O777 = BITBIN('777'O) THEN DO; /* Form 1 or 2 */
      207    11109    2                     COUNT = K$B.FORM0.COUNT; /* Get count */
      208    11110    3                     IF COUNT = 7 THEN DO;
      209    11111    3                         VY_OK.KTYPE = 1;  /* Set key form */
      210    11112    3                         RTYPE = K$B.FORM1.REC_TYPE; /* Set record type retrieved */
      211    11113    3                         IF RTYPE ~= VY_OK.KRTYPE THEN VY_OK.KPAGE# = -1;
      212    11114    3                         VY_OK.KRTYPE = RTYPE;
      213    11115    3                         IF VY_OK.KRTYPE < 1
      214    11116    3                                 OR
      215    11117    3                                 VY_OK.KRTYPE > 15
      216    11118    3                                 OR
      217    11119    3                                 VY_OK.KRTYPE = 10
      218    11120    3                         THEN CALL REPORT_INCONSISTENCY( 1 /* Key form 1 */ );
      219    11121    4                         IF VY_OK.KPAGE# > 0 THEN DO;
             11121                                  /* Check if checks should be performed */
      220    11122    5                             IF VY_OK.KPAGE# + 1 ~= K$B.FORM1.PAGE# THEN DO;
             11122                                      /* Sequence error*/
      221    11123        /*E*  ERROR: VYI-E$PAGE_SEQUENCE_VY-0
      222    11124        MESSAGE: Page sequence error for record type = %U1.
      223    11125        DESCRIPTION: Page sequence error has occurred for object unit records
      224    11126        */
      225    11127    5                                 CALL REPORT_SEQUENCE_ERROR( /* ERR# */
      226    11128    5                                         401,
      227    11129    5                                         VY_OK.KPAGE#, /*Set previous */
      228    11130    5                                         K$B.FORM1.PAGE# /* Set current */ );
      229    11131    5                                END;
      230    11132    4                            END;
      231    11133    3                         VY_OK.KPAGE# = K$B.FORM1.PAGE#; /* Set page number */
      232    11134    3                        END;
      233    11135    2                     ELSE
      234    11136    3                         IF COUNT = 11 OR COUNT = 12 THEN DO;
      235    11137    3                             VY_OK.KTYPE = 2; /* Set key form */
      236    11138    3                             VY_OK.KRTYPE = K$B.FORM2.D10; /* Set record type */
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:13   
      237    11139    4                             IF VY_OK.KRTYPE ~= 10 THEN DO; /* Check if type 10 */
      238    11140    4                                 CALL REPORT_INCONSISTENCY( 2 /* Key form 2 */ );
      239    11141    4                                END;
      240    11142    3                             VY_OK.KSECT# = K$B.FORM2.SECT#; /* Set section # */
      241    11143    3                             VY_OK.KOFSET = K$B.FORM2.OFFSET; /* Setoffset */
      242    11144    3                             VY_OK.KSTYPE = K$B.FORM2.STYPE; /* Set SUB_TYPE*/
      243    11145    4                             IF VY_OK.KSTYPE > 1 THEN DO; /* Range error */
      244    11146        /*E*  ERROR: VYI-E$BAD_FORM1_SUB_TYPE_VY-0
      245    11147         MESSAGE: Illegal subtype value detected for record type 10. Subtype = %U1.
      246    11148        DESCRIPTION: Self-explanatory.
      247    11149        */
      248    11150                                      %NUMBER( NUM1="VY_OK.KSTYPE" );
      249    11167                                      %SCREAM(ERR#=%E$BAD_FORM1_SUB_TYPE_VY,MID="'I'",LEVEL=
             11167                                          %@E$F_VY,AUX=%@E$OUOF_VY );
      250    11170    4                                END;
      251    11171    3                             IF COUNT = 11 THEN VY_OK.KSEQUENCE = -1; /* Reset count */
      252    11172    4                             ELSE DO;      /* Check */
      253    11173    5                                 IF VY_OK.KSEQUENCE ~= -1 THEN DO; /* Not the first */
      254    11174    6                                     IF VY_OK.KSEQUENCE + 1 < K$B.FORM2.SEQUENCE THEN
             11174                                              DO;
      255    11175        /*E*  ERROR: VYI-E$BAD_SEQUENCE_VY
      256    11176        MESSAGE: Text/relocation sequencing error for record type = %U1.
      257    11177        DESCRIPTION: A sequencing problem has arisen in the object unit for text/relocation(
             11177        type 10 ) records.
      258    11178        */
      259    11179    6                                         CALL REPORT_SEQUENCE_ERROR( /* ERR# */
      260    11180    6                                                 404,
      261    11181    6                                                 VY_OK.KSEQUENCE,
      262    11182    6                                                 K$B.FORM2.SEQUENCE );
      263    11183                                                /*Error-sequencing */
      264    11184    6                                        END;
      265    11185    5                                     VY_OK.KSEQUENCE = K$B.FORM2.SEQUENCE;
      266    11186    5                                    END;
      267    11187    4                                END;
      268    11188    3                            END;
      269    11189    3                         ELSE DO;          /* Error */
      270    11190    3   BAD_O_KEY:
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:14   
      271    11191        /**/
      272    11192        /* Check if checking should be by-passed */
      273    11193        /**/
      274    11194    4                             IF P_OVERWRITE THEN DO;
      275    11195    4                                 VY_IO_SAVEPREV = 0/*@NO*/;
      276    11196    4                                 VY_OK.KTYPE = -5;
      277    11197    4                                 RETURN;
      278    11198    4                                END;
      279    11199        /*E*  ERROR: VYI-E$UNKNOWN_REC_TYPE_VY-0
      280    11200        MESSAGE: Unknown/illegal record type detected.
      281    11201        DESCRIPTION: Self-explanatory.
      282    11202        */
      283    11203                                  %SCREAM(ERR#=%E$UNKNOWN_REC_TYPE_VY,MID="'I'",LEVEL=
             11203                                      %@E$F_VY,AUX=%@E$OUOF_VY);
      284    11206    3                            END;
      285    11207    2                    END;
      286    11208    2                 ELSE DO;                  /* Check if lib search key */
      287    11209    2                     IF VY_OK.KFILE = 2/*@LF*/ AND
      288    11210    2                             K$B.FORM0.COUNT <= 255 AND
      289    11211    2                             VY_IO_SIZEC <= 255
      290    11212    2                     THEN VY_OK.KTYPE = -3; /* Assume library probe */
      291    11213    2                     ELSE GOTO BAD_O_KEY;
      292    11214    2                    END;
      293    11215    1         RETURN;
      294    11216        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:15   
      295    11217    1   READ_ERROR:
      296    11218    1         ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR#/*@ALT_ERROR*/;
      297    11219    2         IF ERR = 6 THEN DO;
      298    11220    2             VY_IO_STATUS = 0/*@IO_EOF*/;
      299    11221    2            END;
      300    11222    1         ELSE
      301    11223    2             IF ERR = 66 THEN DO;
      302    11224    2                 VY_IO_STATUS = 1/*@IO_NOKEY*/;
      303    11225    2                END;
      304    11226    1             ELSE
      305    11227    2                 IF ERR = 7 THEN DO;
      306    11228    2                     VY_IO_STATUS = 2/*@IO_LD*/;
      307    11229    2                     IF TYPE = 1/*@RF*/ THEN GOTO POP_OUT;
      308    11230    2                     IF VY_IO_SAVEPREV > 0 THEN GOTO CONTINUE;
      309    11231    2                    END;
      310    11232    2                 ELSE DO;
      311    11233        /* Here for irrecoverable i/o errors */
      312    11234    2   REPORT_ERROR:
      313    11235    2                     CALL M$MERC ALTRET(MERC_ERROR);
      314    11236                          %ERROR_IT;
      315    11239    2                    END;
      316    11240    1   POP_OUT:
      317    11241        /* Reset global i/o variables */
      318    11242    1         VY_IO_SIZEC = 0;
      319    11243    1         VY_IO_SIZEW = 0;
      320    11244    1         VY_IO_SAVEPREV = 0/*@NO*/;
      321    11245    1         VY_OK.KTYPE = -5;
      322    11246    1         ALTRETURN;
      323    11247    1   WRITE_ERROR:
      324    11248    1         IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR#/*@ALT_ERROR*/ = 61 AND
      325    11249    1                 ADDR(P_OVERWRITE) ~= ADDR(NIL)
      326    11250    2         THEN DO;
      327    11251    2             VY_IO_STATUS = 3/*@IO_EXISTS*/;
      328    11252    2             GOTO POP_OUT;
      329    11253    2            END;
      330    11254    1         IF VY_COMMAND=3/*@C_COPY_KEY_WORD*/ OR VY_COMMAND=4/*@C_EXTRACT_KEY_WORD*/
      331    11255    2         THEN DO;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:16   
      332    11256    2             CALL VYE$ERRMSG;
      333    11257    2             IF VY_COMMAND=3/*@C_COPY_KEY_WORD*/ THEN VYI_ROLLBACK='1'B;
      334    11258    2             CALL VYO$DEL_UNIT(TYPE,'0'B,'1'B,'0'B,VY_LINK_UTS);
      335    11259    2             CALL VYI$ERR;
      336    11260    2            END;
      337    11261    1         ELSE GOTO REPORT_ERROR;
      338    11262    1   MERC_ERROR:
      339    11263    1         CALL VYE$MERC;
      340    11264        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:17   
      341    11265    1   VYI$WRITE:
      342    11266    1         ENTRY(         TYPE, BUF$, SIZE, KEY, P_OVERWRITE )  ALTRET;
      343    11267    1         SIZE2 = SIZE * 4;
      344    11268    1         GOTO JUMP_SIZE;
      345    11269    1   VYI$WRITE_C:
      346    11270    1         ENTRY(         TYPE, BUF$, SIZE, KEY, P_OVERWRITE )  ALTRET;
      347    11271    1         SIZE2 = SIZE;
      348    11272    1   JUMP_SIZE:
      349    11273    1         IF ADDR(P_OVERWRITE) = ADDR(NIL)
      350    11274    1         THEN OVERWRITE = '0'B/*@NO_B*/;
      351    11275    1         ELSE OVERWRITE = P_OVERWRITE;
      352    11276    2         DO CASE( TYPE );
      353    11277    2           CASE( 0/*@OF*/ );
      354    11278    2             FPT$ = ADDR( VY_O_FPT_WRITE );
      355    11279    2           CASE( 1/*@RF*/ );
      356    11280    2             FPT$ = ADDR( VY_R_FPT_WRITE );
      357    11281        /* Not possible for linker
      358    11282                   case( @LF );
      359    11283                   FPT$ = addr( VY_O_FPT_WRITE );
      360    11284        */
      361    11285    2           CASE(ELSE);
      362    11286        /*E*  ERROR: VYI-E$INTERNAL_WRITE_BAD_TYPE_VY-0
      363    11287              MESSAGE: Internal link error. Bad type passed to VYI$WRITE: Type = %U1.
      364    11288              DESCRIPTION: Self-explanatory.
      365    11289        */
      366    11290                  %NUMBER(
      367    11291                  NUM1=TYPE, BASE1=10, SIZE1=12 );
      368    11308                  %SCREAM(
      369    11309                  ERR#=%E$INTERNAL_WRITE_BAD_TYPE_VY,
      370    11310                  MID="'I'",
      371    11311                  LEVEL=%@E$F_VY);
      372    11314    2           END;
      373    11315    1         F$W.BUF_.BOUND   = SIZE2 - 1;
      374    11316    1         F$W.BUF_.BUF$   = BUF$;
      375    11317    2         IF KEY ~= 4/*@NO_KEY*/ THEN DO;
      376    11318    3             DO CASE( KEY );
      377    11319    3               CASE( 0/*@OF*/ );
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:18   
      378    11320    3                 F$W.KEY_   = VECTOR( VY_O_KEY_BUF );
      379    11321    3               CASE( 1/*@RF*/ );
      380    11322    3                 F$W.KEY_   = VECTOR( VY_R_KEY_BUF );
      381    11323    3               CASE( 2/*@LF*/ );
      382    11324    3                 F$W.KEY_   = VECTOR( VY_O_KEY_BUF );
      383    11325    3               CASE( 3/*@NEW_KEY*/ );
      384    11326    3                 F$W.KEY_ = VECTOR( VY_OL_KEY_BUF );
      385    11327    3               CASE( ELSE );
      386    11328        /*E*  ERROR: VYI-E$INTERNAL_WRITE_BAD_KEY_TP_VY-0
      387    11329             MESSAGE: Internal link error. Bad key type passed to VYI$WRITE: Key type = %U1.
      388    11330              DESCRIPTION: Self-explanatory.
      389    11331        */
      390    11332                      %NUMBER(
      391    11333                      NUM1=KEY, BASE1=10, SIZE1=12 );
      392    11350                      %SCREAM(
      393    11351                      ERR#=%E$INTERNAL_WRITE_BAD_KEY_TP_VY,
      394    11352                      MID="'I'",
      395    11353                      LEVEL=%@E$F_VY);
      396    11356    3               END;
      397    11357    2            END;
      398    11358    2         ELSE DO;
      399    11359    2             F$W.KEY_   = VECTOR(NIL);
      400    11360    2            END;
      401    11361    1         IF OVERWRITE THEN F$W.V.ONEWKEY# = '1'B/*@YES_B*/;
      402    11362    2         ELSE DO;
      403    11363    2             F$W.V.ONEWKEY# = '0'B/*@NO_B*/;
      404    11364    2             F$W.V.NEWKEY# = '1'B/*@YES_B*/;
      405    11365    2            END;                           /* Else do; */
      406    11366    1         CALL M$WRITE( F$W )           ALTRET( WRITE_ERROR );
      407    11367    1         VY_IO_STATUS = -1;
      408    11368    1         RETURN;
      409    11369        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:19   
      410    11370    1   REPORT_INCONSISTENCY: PROC( KEYFORM );
      411    11371
      412    11372    2   DCL KEYFORM      UBIN;
      413    11373
      414    11374        /*E*  ERROR: VYI-E$BAD_FORM1_REC_TYPE_VY-0
      415    11375              MESSAGE: Object language error.  Illegal record type/key form detected.
      416    11376                       Record type = %U1; Key form = %U2.
      417    11377              DESCRIPTION: A bad record type has been detected within an object unit.
      418    11378        */
      419    11379
      420    11380              %NUMBER( NUM1="VY_OK.KRTYPE", NUM2=KEYFORM );
      421    11397
      422    11398
      423    11399              %SCREAM(
      424    11400                      ERR#=%E$BAD_FORM1_REC_TYPE_VY, LEVEL=%@E$F_D_VY,
      425    11401                      MID="'I'", AUX=%@E$OUOF_VY );
      426    11404
      427    11405    2         CALL DUMP_KEY_BUF;
      428    11406
      429    11407    2   END REPORT_INCONSISTENCY;
      430    11408
      431    11409        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:20   
      432    11410    1   REPORT_SEQUENCE_ERROR: PROC( ERR_CODE, PREV#, CURR# );
      433    11411
      434    11412    2   DCL ERR_CODE  UBIN;
      435    11413    2   DCL PREV#     UBIN;
      436    11414    2   DCL CURR#     UBIN;
      437    11415
      438    11416              %NUMBER( NUM1="VY_OK.KRTYPE" );
      439    11433
      440    11434              %SCREAM( ERR# = ERR_CODE, LEVEL=%@E$F_D_VY, MID="'I'" );
      441    11437
      442    11438        /*E*  ERROR: VYI-E$LAST_CURR_VY-0
      443    11439              MESSAGE: Last value = %U1; Current value = %U2.
      444    11440              DESCRIPTION: Display last/current values for appropriate error condition.
      445    11441        */
      446    11442              %NUMBER( NUM1=PREV#, NUM2=CURR# );
      447    11459
      448    11460              %SCREAM( ERR#=%E$LAST_CURR_VY, LEVEL=%@E$F_VY, MID="'I'", AUX=%@E$OUOF_VY );
      449    11463
      450    11464    2   END REPORT_SEQUENCE_ERROR;
      451    11465
      452    11466        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:21   
      453    11467    1   DUMP_KEY_BUF: PROC;
      454    11468
      455    11469        /*E*  ERROR:  VYI-E$DUMP3_VY-0
      456    11470              MESSAGE: Words 0-2: %U1  %U2  %U3
      457    11471              DESCRIPTION: Dump 3 words in octal.
      458    11472        */
      459    11473
      460    11474              %NUMBER(
      461    11475                      NUM1="K$->VY$WORD_A(0)",  BASE1=8,
      462    11476                      NUM2="K$->VY$WORD_A(1)",  BASE2=8,
      463    11477                      NUM3="K$->VY$WORD_A(2)",  BASE3=8 );
      464    11494
      465    11495              %SCREAM( ERR#=%E$DUMP3_VY, LEVEL=%@E$F_VY, MID="'I'" );
      466    11498        /*
      467    11499                      Note that above call to VYE$ERROR causes VYE$ERROR to
      468    11500                      to unwind to VYM$MAIN:RESTART
      469    11501        */
      470    11502
      471    11503    2   END DUMP_KEY_BUF;
      472    11504
      473    11505
      474    11506
      475    11507
      476    11508    1   END VYI$READ;

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:22   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   VY_PSUBS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYI$READ.

   Procedure VYI$READ requires 647 words for executable code.
   Procedure VYI$READ requires 20 words of local(AUTO) storage.

    No errors detected in file VYI$READ.:E05TSI    .

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:23   

 Object Unit name= VYI$READ                                   File name= VYI$READ.:E05TOU
 UTS= JUL 30 '97 08:55:57.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    65    101  VYI$READ
    2  LblCom even  none     1      1  BREAK$
    3   DCB   even  none     0      0  M$OF
    4   DCB   even  none     0      0  M$LF
    5   DCB   even  none     0      0  M$RF
    6   Proc  even  none   647   1207  VYI$READ
    7  RoData even  none   115    163  VYI$READ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes    yes     yes      Std        5  VYI$READ
     6    646          yes     yes      Std        5  VYI$WRITE
     6    655          yes     yes      Std        5  VYI$WRITE_C

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     14  VY_O_FPT_READ                      1     32  VY_R_FPT_READ
    1     50  VY_O_FPT_WRITE                     1     64  VY_R_FPT_WRITE
    1    100  VYI_ROLLBACK
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 VYD$B2C
         yes           Std       0 VYE$MERC
         yes           Std       1 VYE$ERRMSG
         yes           Std       6 VYO$DEL_UNIT
         yes           Std       4 VYE$ERROR
         yes           Std       0 VYI$ERR
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AUNWIND
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VY_O_KEY_BUF                          VY_OL_KEY_BUF
     VY_O_KEY_BUF_L                        VY_R_KEY_BUF                          VY_OK
     B$TCB$                                VY_OU_HEAD                            VY_COMMAND
     VY_LINK_UTS                           VY_ERRORS                             VY_EFIELD1
     VY_EFIELD2                            VY_EFIELD3                            VY_IO_STATUS
     VY_IO_SIZEW                           VY_IO_SIZEC                           VY_IO_USEPREV
     VY_IO_SAVEPREV                   r    VY_O_KEY_HEAD                    r    VY_O_KEY_TREE
     VY_LAST_UTS                           VY_UNWIND                             VY_PAR_UNWIND
     M$OF$                                 M$RF$                                 M$LF$
     M$OF                                  M$LF                                  M$RF
     B_VECTNIL
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:25   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:26   


        1        1        /*M* VYI$READ - M$READ/M$WRITE interface for LEMUR */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=6,IND=4,CSU=2,EXM=0,ECU=2,MOC,DCI=4,CRT=4,CTI=8,CCC */
        8        8        VYI$READ: PROC(         TYPE, BUF$, SIZE, KEY, P_OVERWRITE ) ALTRET;

      8  6 000000   000000 700200 xent  VYI$READ     TSX0  ! X66_AUTO_5
         6 000001   000024 000005                    ZERO    20,5

        9        9        %INCLUDE VY_INC_C;
       10     9185        %INCLUDE VY_PSUBS_C;
       11     9246        %VY$WORD;

              9258    1   /*******************************************************************************
              9259    1   *                                                                              *
              9260    1   *                          VY$WORD                                                *
              9261    1   *                                                                              *
              9262    1   *******************************************************************************/

              9267    1   DCL VY$WORD_A(0:0)       UBIN(36) ALIGNED    BASED;
              9268    1   DCL VY$HALF_A(0:0)       UBIN(18) HALIGNED   BASED;
              9269    1   DCL VY$BYTE_A(0:0)       UBIN( 9) CALIGNED   BASED;
              9270    1   DCL VY$CHAR_A(0:0)       CHAR( 1) UNAL       BASED;
              9271        /**/
              9272    1   DCL VY$WORD_SBIN_A(0:0)  SBIN WORD ALIGNED   BASED;
              9273    1   DCL VY$HALF_SBIN_A(0:0)  SBIN HALF HALIGNED  BASED;
              9274    1   DCL VY$BYTE_SBIN_A(0:0)  SBIN HALF CALIGNED  BASED;
              9275    1   DCL VY$BIT_A(0:0)        BIT(36)   ALIGNED   BASED;
       12     9278        %T$C;

              9290    1   /*******************************************************************************
              9291    1   *                                                                              *
              9292    1   *                          T$C                                                 *
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:27   
              9293    1   *                                                                              *
              9294    1   *******************************************************************************/

              9299    1   DCL 1 T$C           BASED     ALIGNED,  /* Text count                         */
              9300    1         2 COUNT        UBIN( 9) UNAL,
              9301    1         2 CHARS        CHAR( T$C.COUNT )   UNAL;
              9302    1   DCL 1 T$C_UNAL      BASED     UNAL,     /* Text count                         */
              9303    1         2 COUNT        UBIN( 9) UNAL,
              9304    1         2 CHARS        CHAR( T$C_UNAL.COUNT ) UNAL;
       13     9307        %B$TCB;
       14     9310        %B$ALT;
       15     9318        %PLIST;
       16     9319        %INCLUDE B_ERRORS_C;
       17    10446        %LIST;
       18    10447        %ENTRIES;
             10448    1   DCL VYE$ERROR       ENTRY(4);
             10449    1   DCL VYE$ERR         ENTRY(3);
             10450    1   DCL VYE$MERC        ENTRY;
             10451    1   DCL VYE$ERRMSG      ENTRY(1);
             10452    1   DCL VYR$READ        ENTRY( 3 ) ALTRET;
             10453    1   DCL VYW$WRITE       ENTRY( 3 ) ALTRET;
             10454    1   DCL VYW$WRITE_DO    ENTRY( 2 ) ALTRET;
             10455    1   DCL VYD$B2C         ENTRY( 5 );
             10456    1   DCL VYD$C2B         ENTRY( 3 );
             10457    1   DCL VYA$GET         ENTRY( 3 );
             10458    1   DCL VYF$FREE        ENTRY( 3 );
             10459    1   DCL VYQ$SORT        ENTRY( 7 );
             10460    1   DCL VYY$YESNO       ENTRY( 1 );
       19    10462    1   DCL VYI$ERR         ENTRY;
       20    10463    1   DCL VYO$DEL_UNIT ENTRY(6);
       21    10464        %P;
             10465        %LSET LISTDIR='0'B;

             10472    1   /*******************************************************************************
             10473    1   *                                                                              *
             10474    1   *                          PARAMETERS                                             *
             10475    1   *                                                                              *
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:28   
             10476    1   *******************************************************************************/

       22    10480    1   DCL TYPE            UBIN(36)       ALIGNED;
       23    10481    1   DCL BUF$            PTR            ALIGNED;
       24    10482    1   DCL SIZE            UBIN(36)       ALIGNED;
       25    10483    1   DCL KEY             UBIN(36)       ALIGNED;
       26    10484    1   DCL P_OVERWRITE        BIT(1)         ALIGNED;
       27    10485        %BANNER(ARG=SUBS);
             10486        %LSET LISTDIR='0'B;

             10493    1   /*******************************************************************************
             10494    1   *                                                                              *
             10495    1   *                          SUBS                                                 *
             10496    1   *                                                                              *
             10497    1   *******************************************************************************/

       28    10501        %B$RECORDSUBS;
             10502        %EQU TYPHEAD=0 ;
             10503        %EQU TYPDNAM=1 ;
             10504        %EQU TYPRNAM=2 ;
             10505        %EQU TYPSECT=3 ;
             10506        %EQU TYPEDEF=4 ;
             10507        %EQU TYPEREF=5 ;
             10508        %EQU TYPSDEF=6 ;
             10509        %EQU TYPSREF=7 ;
             10510        %EQU TYPSEGDEF=8 ;
             10511        %EQU TYPSEGREF=9 ;
             10512        %EQU TYPPROG=10 ;
             10513        %EQU SUBTYPPROG=0 ;
             10514        %EQU SUBTYPREL=1 ;
             10515        %EQU TYPLOGBLK=11 ;
             10516        %EQU TYPINTNTRY=12 ;
             10517        %EQU TYPEXST=13 ;
             10518        %EQU TYPVREBL=14 ;
             10519        %EQU TYPDBGNAM=15 ;
             10520        %EQU TYPLV1LB=16 ;
             10521        %EQU TYPLV1=17 ;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:29   
             10522        %EQU TYPDATASEG=18 ;
             10523        %EQU TYPRUM=20 ;
             10524        %EQU TYPBIRTH=21 ;
             10525        %EQU TYPPLOVER=22 ;
             10526        %EQU TYPCOMPID=23 ;
             10527        %EQU TYPROS=30 ;
       29    10529        %PTR;
             10530        %LSET LISTDIR='0'B;

             10537    1   /*******************************************************************************
             10538    1   *                                                                              *
             10539    1   *                          PTR                                                 *
             10540    1   *                                                                              *
             10541    1   *******************************************************************************/

       30    10545    1   DCL DCB$            PTR            ALIGNED   STATIC/*AUTO*/;
       31    10546    1   DCL FPT$            PTR            ALIGNED   STATIC/*AUTO*/;
       32    10547    1   DCL K$              PTR            ALIGNED   STATIC/*AUTO*/;
       33    10548    1   DCL BREAK$          PTR            ALIGNED   EXT;
       34    10549        %E;
             10550        %LSET LISTDIR='0'B;

             10557    1   /*******************************************************************************
             10558    1   *                                                                              *
             10559    1   *                          ENTRY                                                 *
             10560    1   *                                                                              *
             10561    1   *******************************************************************************/

       35    10565        %U;
             10566        %LSET LISTDIR='0'B;

             10573    1   /*******************************************************************************
             10574    1   *                                                                              *
             10575    1   *                          UBIN                                                 *
             10576    1   *                                                                              *
             10577    1   *******************************************************************************/

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:30   
       36    10581    1   DCL ERR             UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       37    10582    1   DCL KEY_TYPE        UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       38    10583    1   DCL RTYPE           UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       39    10584    1   DCL SIZE2           UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       40    10585        %S;
             10586        %LSET LISTDIR='0'B;

             10593    1   /*******************************************************************************
             10594    1   *                                                                              *
             10595    1   *                          SBIN                                                 *
             10596    1   *                                                                              *
             10597    1   *******************************************************************************/

       41    10601    1   DCL PREV#           SBIN WORD      ALIGNED   STATIC/*AUTO*/;
       42    10602    1   DCL KEYFORM         SBIN WORD      ALIGNED   STATIC/*AUTO*/;
       43    10603    1   DCL CURR#           SBIN WORD      ALIGNED   STATIC/*AUTO*/;
       44    10604    1   DCL COUNT           UBIN(36)       ALIGNED   STATIC/*AUTO*/;
       45    10605    1   DCL OVERWRITE        BIT(1)         ALIGNED;
       46    10606    1   DCL M$OF            DCB;
       47    10607    1   DCL M$LF            DCB;
       48    10608    1   DCL M$RF            DCB;
       49    10609    1   DCL 1 C$STRING BASED,
       50    10610    1         2 COUNT UBIN(9) UNAL,
       51    10611    1         2 CHARS(0:510) CHAR(1) UNAL;
       52    10612        %FPT_READ( FPTN=F$R, STCLASS="BASED(FPT$)");
             10613        %LSET LISTDIR='0'B;
             10629    1   DCL 1 F$R BASED(FPT$),2 V_ BIT(72)/*(VECTOR(F$R.V))/**/,2 KEY_,3 BOUND UBIN(20)UNAL
             10629            /*(SIZEV(NIL))
             10630    1   /**/,3 * BIT(12)/*('7772'O)/**/,3 * BIT(4)/*('0'B)/**/,3 KEY$ PTR /*(ADDR(NIL))
             10631    1   /**/,2 BUF_,3 BOUND UBIN(20)UNAL /*(SIZEV(NIL))/**/,3 * BIT(12)/*('7772'O)/**/,3 *
             10631            BIT(4)/*
             10632    1   ('0'B)/**/,3 BUF$ PTR /*(ADDR(NIL))/**/,2 STATION_ BIT(72)/*(VECTOR(NIL))
             10633    1  /**/,2 IDBUF_ REDEF STATION_ BIT(72),2 V DALIGNED,3 DCB# UBIN(18)UNAL /*(DCBNUM(NIL)
             10633            )/**/,3 WAIT# BIT(1)/*
             10634    1   ('1'B)/**/ ,3 KEYS# BIT(1)/*('0'B)/**/ ,3 KEYR# BIT(1)/*('0'B)/**/ ,3 ID# BIT(1)/*
             10635    1   ('0'B)/**/,3 KEYCHNG# BIT(1)/*('0'B)/**/,3 FULL# BIT(1)/*('0'B)/**/ ,3 IDS# BIT(1
             10636    1   )/*('0'B)/**/,3 IOERROK# BIT(1)/*('0'B)/**/,3 * BIT(1)/*('0'B)/**/,
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:31   
             10642    1   3 INDX# UBIN(9)UNAL /*(0)/**/,3 KEYTYPE# REDEF INDX# UBIN BYTE CALIGNED,3 EVENT#
             10642            SBIN /*
             10643    1   (0)/**/,3 SEED# BIT(36)/*('0'B)/**/,3 DVBYTE,4 TOP# BIT(1)/*('0'B)/**/,4 BP# BIT(1
             10644    1  )/*('0'B)/**/,4 REREAD# BIT(1)/*('0'B)/**/,4 VFC# REDEF REREAD# BIT(1),4 BIN# BIT(1)
             10644            /*('0'B
             10645    1   )/**/,4 TRANS# BIT(1)/*('0'B)/**/,4 * BIT(1)/*('0'B)/**/,4 NODAT# BIT(1)/*('0'B
             10646    1   )/**/,4 * BIT(1)/*('0'B)/**/,4 CONT# BIT(1)/*('0'B)/**/,3 STRPVFC# BIT(1)/*('0'B
             10647    1   )/**/,3 ODFNC# UBIN(8)UNAL /*(0)/**/,3 RECNUM# UBIN(18)UNAL /*(0)/**/,3
             10648    1   SINPUTSIZE# UBIN(18)UNAL /*(0)/**/,3 REREADPOS# UBIN(18)UNAL /*(0)/**/,3 * UBIN
             10649    1   UNAL /*(0)/**/;
       53    10651        %FPT_WRITE( FPTN=F$W, STCLASS="BASED(FPT$)");
             10652        %LSET LISTDIR='0'B;
             10668    1  DCL 1 F$W BASED(FPT$),2 V_ BIT(72)/*(VECTOR(F$W.V))/**/,2 KEY_ BIT(72)/*(VECTOR(NIL)
             10668            )/**/,2 BUF_,3
             10669    1   BOUND UBIN(20)UNAL /*(SIZEV(NIL))/**/,3 * BIT(12)/*('7772'O)/**/,3 * BIT(4)/*('0'B)
             10670    1   /**/,3 BUF$ PTR /*(ADDR(NIL))/**/,2 STATION_ BIT(72)/*(VECTOR(NIL))/**/,2
             10671    1  IDBUF_ REDEF STATION_ BIT(72),2 V DALIGNED,3 DCB# UBIN(18)UNAL /*(DCBNUM(NIL))/**/,3
             10671            WAIT# BIT(1)/*('1'B
             10672    1   )/**/ ,3 * BIT(2)/*('0'B)/**/,3 ID# BIT(1)/*('0'B)/**/,3 * BIT(1)/*('0'B)
             10673    1   /**/,3 FULL# BIT(1)/*('0'B)/**/ ,3 * BIT(3)/*('0'B)/**/,3 ONEWKEY# BIT(1)/*('1'B)
             10674    1   /**/ ,3 NEWKEY# BIT(1)/*('0'B)/**/ ,3 REWRITE# BIT(1)/*('0'B)/**/ ,3 NOTIME# BIT(1)
             10674            /*
             10675    1   ('0'B)/**/ ,3 IOERROK# BIT(1)/*('0'B)/**/ ,3 KEYTYPE# UBIN(4)/*(0)/**/ UNAL,
             10676    1   3 EVENT# SBIN /*(0)/**/,3 SEED# BIT(36)/*('0'B)/**/,3 DVBYTE,4 TOP# BIT(1)/*('0'B)
             10677    1  /**/,4 BP# BIT(1)/*('0'B)/**/,4 VFC# BIT(1)/*('0'B)/**/,4 REREAD# REDEF VFC# BIT(1),
             10677            4 BIN# BIT(1
             10678    1   )/*('0'B)/**/,4 TRANS# BIT(1)/*('0'B)/**/,4 RRR# BIT(1)/*('0'B)/**/,4 NODAT# BIT(1
             10679    1   )/*('0'B)/**/,4 * BIT(1)/*('0'B)/**/,4 CONT# BIT(1)/*('0'B)/**/,3 * BIT(1)/*
             10680    1   ('0'B)/**/,3 ODFNC# UBIN(8)UNAL /*(0)/**/,3 * UBIN(18)UNAL /*(0)/**/;
       54    10682        %O_KEY_BUF( KEYBUF=K$B,
       55    10683                          STCLASS="BASED(K$)",
       56    10684                          INT="");
             10685    1   DCL 1 K$B ALIGNED BASED(K$) ,
             10686    1          2 FORM0 ,
             10687    1           3 COUNT       UBIN( 9)  UNAL,
             10688    1           3 CHARS       CHAR(512) UNAL,
             10689    1         2 FORM1        REDEF     FORM0,
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:32   
             10690    1           3 COUNT       UBIN( 9)  UNAL,
             10691    1           3 O777        UBIN( 9)  UNAL,   /* <- '777'O                          */
             10692    1           3 UTS         UBIN(36)  UNAL,
             10693    1           3 REC_TYPE    UBIN( 9)  UNAL,
             10694    1           3 PAGE#       UBIN( 9)  UNAL,
             10695    1           3 *           CHAR(505),
             10696    1         2 FORM2        REDEF     FORM0,
             10697    1           3 COUNT       UBIN( 9)  UNAL,
             10698    1           3 O777        UBIN( 9)  UNAL,   /* <- '777'O                          */
             10699    1           3 UTS         UBIN(36)  UNAL,
             10700    1           3 D10         UBIN( 9)  UNAL,   /* <- 10                              */
             10701    1           3 SECT#       UBIN(18)  UNAL,
             10702    1           3 OFFSET      UBIN(18)  UNAL,
             10703    1           3 STYPE       UBIN( 9)  UNAL,
             10704    1           3 SEQUENCE    UBIN( 9)  UNAL,
             10705    1           3 *           CHAR(500) ;
       57    10707        %R_KEY_BUF( KEYBUF=K$R,
       58    10708                          STCLASS="BASED(K$)",
       59    10709                          INT="");
             10710    1   DCL 1 K$R                        BASED(K$),
             10711    1         2 FORM0                  ALIGNED,
             10712    1           3 COUNT       UBIN( 9)  UNAL,
             10713    1           3 CHARS       CHAR( 4)  UNAL,
             10714    1           3 *           CHAR( 7)  UNAL,
             10715    1         2 FORM1        REDEF     FORM0,
             10716    1           3 COUNT       UBIN( 9)  UNAL,
             10717    1           3 REC_TYPE    UBIN( 9)  UNAL,
             10718    1           3 NODE#       UBIN(18)  UNAL,
             10719    1           3 OFFSET      UBIN(18)  UNAL,
             10720    1           3 *           CHAR( 6)  UNAL,
             10721    1         2 FORM2        REDEF     FORM0,
             10722    1           3 COUNT       UBIN( 9)  UNAL,
             10723    1           3 O777        UBIN( 9)  UNAL,   /* <- '777'O                          */
             10724    1           3 NODE#       UBIN(18)  UNAL,
             10725    1           3 P_ENTDEF    UBIN(18)  UNAL,
             10726    1           3 REC_TYPE    UBIN( 9)  UNAL,
             10727    1           3 PAGE#       UBIN( 9)  UNAL,
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:33   
             10728    1           3 *           CHAR( 4)  UNAL;
       60    10730        %PLIST;
       61    10731        %F$DCB;
       62    10788        %FPT_READ( FPTN=VY_O_FPT_READ,
       63    10789                   DCB=M$OF,
       64    10790                   KEY=VY_O_KEY_BUF,
       65    10791                   KEYS=YES,
       66    10792                   KEYR=YES,
       67    10793                   STCLASS="STATIC SYMDEF");
       68    10832        %PLIST;
       69    10833        %FPT_READ( FPTN=VY_R_FPT_READ,
       70    10834                   DCB=M$RF,
       71    10835                   KEY=VY_R_KEY_BUF,
       72    10836                   KEYS=YES,
       73    10837                   KEYR=YES,
       74    10838                   STCLASS="STATIC SYMDEF");
       75    10877        %FPT_WRITE( FPTN=VY_O_FPT_WRITE,
       76    10878                   DCB=M$OF,
       77    10879                   KEY=VY_O_KEY_BUF,
       78    10880                   STCLASS="STATIC SYMDEF");
       79    10911        %FPT_WRITE( FPTN=VY_R_FPT_WRITE,
       80    10912                   DCB=M$RF,
       81    10913                   KEY=VY_R_KEY_BUF,
       82    10914                   STCLASS="STATIC SYMDEF");
       83    10945        /******Delete
       84    10946        %FPT_READ( FPTN=VY_L_FPT_READ,
       85    10947                   DCB=M$LF,
       86    10948                   KEY=VY_O_KEY_BUF,
       87    10949                   keys=yes,
       88    10950                   keyr=yes,
       89    10951                   stclass="static symdef");
       90    10952        eteled******/
       91    10953    1   DCL VYI_ROLLBACK BIT(1) STATIC SYMDEF INIT('0'B);
       92    10954        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:34   
       93    10955    2         DO CASE( TYPE );

  10955  6 000002   200003 470500                    LDP0    @TYPE,,AUTO
         6 000003   000000 235100                    LDA     0,,PR0
         6 000004   000003 115007                    CMPA    3,DL
         6 000005   000007 602005 6                  TNC     s:10955+5,AL
         6 000006   000031 710000 6                  TRA     s:10977
         6 000007   000012 710000 6                  TRA     s:10957
         6 000010   000017 710000 6                  TRA     s:10960
         6 000011   000024 710000 6                  TRA     s:10963

       94    10956    2           CASE( 0/*@OF*/ );

       95    10957    2             FPT$ = ADDR( VY_O_FPT_READ );

  10957  6 000012   000000 236000 7                  LDQ     0
         6 000013   000001 756000 1                  STQ     FPT$

       96    10958    2             DCB$ = M$OF$;

  10958  6 000014   000000 236000 xsym               LDQ     M$OF$
         6 000015   000000 756000 1                  STQ     DCB$
         6 000016   000050 710000 6                  TRA     s:10996

       97    10959    2           CASE( 1/*@RF*/ );

       98    10960    2             FPT$ = ADDR( VY_R_FPT_READ );

  10960  6 000017   000001 236000 7                  LDQ     1
         6 000020   000001 756000 1                  STQ     FPT$

       99    10961    2             DCB$ = M$RF$;

  10961  6 000021   000000 236000 xsym               LDQ     M$RF$
         6 000022   000000 756000 1                  STQ     DCB$
         6 000023   000050 710000 6                  TRA     s:10996

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:35   
      100    10962    2           CASE( 2/*@LF*/ );

      101    10963    2             FPT$ = ADDR( VY_O_FPT_READ );

  10963  6 000024   000000 236000 7                  LDQ     0
         6 000025   000001 756000 1                  STQ     FPT$

      102    10964    2             DCB$ = M$LF$;

  10964  6 000026   000000 236000 xsym               LDQ     M$LF$
         6 000027   000000 756000 1                  STQ     DCB$
         6 000030   000050 710000 6                  TRA     s:10996

      103    10965    2           CASE(ELSE);

      104    10966        /*E*  ERROR: VYI-E$INTERNAL_READ_BAD_TYPE_VY-0
      105    10967              MESSAGE: Internal link error. Bad type passed to VYI$READ: Type = %U1.
      106    10968              DESCRIPTION: Self-explanatory.
      107    10969        */
      108    10970                  %NUMBER(
      109    10971                  NUM1=TYPE, BASE1=10, SIZE1=12 );

  10977  6 000031   000002 236000 7                  LDQ     2
         6 000032   200022 756100                    STQ     @CURR#+5,,AUTO
         6 000033   200003 236100                    LDQ     @TYPE,,AUTO
         6 000034   000003 235000 7                  LDA     3
         6 000035   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 000036   000004 237000 7                  LDAQ    4
         6 000037   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 000040   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 000041   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 000042   000000 701000 xent               TSX1    VYD$B2C
         6 000043   000000 011000                    NOP     0

      110    10988                  %SCREAM(
      111    10989                  ERR#=%E$INTERNAL_READ_BAD_TYPE_VY,
      112    10990                  MID="'I'",
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:36   
      113    10991                  LEVEL=%@E$F_VY,
      114    10992                  AUX=%@E$OF_VY);

  10993  6 000044   000010 630400 7                  EPPR0   8
         6 000045   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000046   000000 701000 xent               TSX1    VYE$ERROR
         6 000047   000000 011000                    NOP     0

      115    10995    2           END;

      116    10996    1         F$R.BUF_.BOUND   = SIZE * 4 - 1;

  10996  6 000050   200005 470500                    LDP0    @SIZE,,AUTO
         6 000051   000001 471400 1                  LDP1    FPT$
         6 000052   000000 236100                    LDQ     0,,PR0
         6 000053   000002 736000                    QLS     2
         6 000054   000001 136007                    SBLQ    1,DL
         6 000055   000020 736000                    QLS     16
         6 000056   100004 676100                    ERQ     4,,PR1
         6 000057   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 000060   100004 656100                    ERSQ    4,,PR1

      117    10997    1         F$R.BUF_.BUF$   = BUF$;

  10997  6 000061   200004 473500                    LDP3    @BUF$,,AUTO
         6 000062   300000 236100                    LDQ     0,,PR3
         6 000063   100005 756100                    STQ     5,,PR1

      118    10998    1         F$R.V.KEYR# = '1'B/*@YES_B*/;

  10998  6 000064   100000 236007                    LDQ     32768,DL
         6 000065   100010 256100                    ORSQ    8,,PR1

      119    10999    1         KEY_TYPE = KEY;

  10999  6 000066   200006 474500                    LDP4    @KEY,,AUTO
         6 000067   400000 235100                    LDA     0,,PR4
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:37   
         6 000070   000004 755000 1                  STA     KEY_TYPE

      120    11000    1         IF KEY_TYPE = 4/*@NO_KEY*/ THEN KEY_TYPE = TYPE;

  11000  6 000071   000004 115007                    CMPA    4,DL
         6 000072   000076 601000 6                  TNZ     s:11001

  11000  6 000073   200003 475500                    LDP5    @TYPE,,AUTO
         6 000074   500000 235100                    LDA     0,,PR5
         6 000075   000004 755000 1                  STA     KEY_TYPE

      121    11001    2         DO CASE( KEY_TYPE );

  11001  6 000076   000003 115007                    CMPA    3,DL
         6 000077   000101 602005 6                  TNC     s:11001+3,AL
         6 000100   000123 710000 6                  TRA     s:11023
         6 000101   000104 710000 6                  TRA     s:11003
         6 000102   000111 710000 6                  TRA     s:11006
         6 000103   000116 710000 6                  TRA     s:11009

      122    11002    2           CASE( 0/*@OF*/ );

      123    11003    2             F$R.KEY_   = VECTOR( VY_O_KEY_BUF );

  11003  6 000104   000014 237000 7                  LDAQ    12
         6 000105   100002 757100                    STAQ    2,,PR1

      124    11004    2             K$ = ADDR(VY_O_KEY_BUF);

  11004  6 000106   000015 236000 7                  LDQ     13
         6 000107   000002 756000 1                  STQ     K$
         6 000110   000133 710000 6                  TRA     s:11042

      125    11005    2           CASE( 1/*@RF*/ );

      126    11006    2             F$R.KEY_   = VECTOR( VY_R_KEY_BUF );

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:38   
  11006  6 000111   000016 237000 7                  LDAQ    14
         6 000112   100002 757100                    STAQ    2,,PR1

      127    11007    2             K$ = ADDR( VY_R_KEY_BUF );

  11007  6 000113   000017 236000 7                  LDQ     15
         6 000114   000002 756000 1                  STQ     K$
         6 000115   000133 710000 6                  TRA     s:11042

      128    11008    2           CASE( 2/*@LF*/ );

      129    11009    2             F$R.KEY_   = VECTOR( VY_O_KEY_BUF );

  11009  6 000116   000014 237000 7                  LDAQ    12
         6 000117   100002 757100                    STAQ    2,,PR1

      130    11010    2             K$ = ADDR( VY_O_KEY_BUF );

  11010  6 000120   000015 236000 7                  LDQ     13
         6 000121   000002 756000 1                  STQ     K$
         6 000122   000133 710000 6                  TRA     s:11042

      131    11011    2           CASE(ELSE);

      132    11012        /*E*  ERROR: VYI-E$INTERNAL_READ_BAD_KEY_TP_VY-0
      133    11013             MESSAGE: Internal link error. Bad key type passed to VYI$READ: Key type = %U1.
      134    11014              DESCRIPTION: Self-explanatory.
      135    11015        */
      136    11016                  %NUMBER(
      137    11017                  NUM1=KEY_TYPE, BASE1=10, SIZE1=12 );

  11023  6 000123   000020 630400 7                  EPPR0   16
         6 000124   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 000125   000000 701000 xent               TSX1    VYD$B2C
         6 000126   000000 011000                    NOP     0

      138    11034                  %SCREAM(
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:39   
      139    11035                  ERR#=%E$INTERNAL_READ_BAD_KEY_TP_VY,
      140    11036                  MID="'I'",
      141    11037                  LEVEL=%@E$F_VY,
      142    11038                  AUX=%@E$OF_VY);

  11039  6 000127   000026 630400 7                  EPPR0   22
         6 000130   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000131   000000 701000 xent               TSX1    VYE$ERROR
         6 000132   000000 011000                    NOP     0

      143    11041    2           END;

      144    11042    1         BREAK$ = K$;

  11042  6 000133   000002 236000 1                  LDQ     K$
         6 000134   000000 756000 2                  STQ     BREAK$

      145    11043    2         IF KEY ~= 4/*@NO_KEY*/ THEN DO;

  11043  6 000135   200006 470500                    LDP0    @KEY,,AUTO
         6 000136   000000 235100                    LDA     0,,PR0
         6 000137   000004 115007                    CMPA    4,DL
         6 000140   000174 600000 6                  TZE     s:11069

      146    11044    2             F$R.V.KEYS# = '1'B/*@YES_B*/;

  11044  6 000141   000001 471400 1                  LDP1    FPT$
         6 000142   200000 236007                    LDQ     65536,DL
         6 000143   100010 256100                    ORSQ    8,,PR1

      147    11045    3             IF VY_IO_USEPREV ~= 1/*@YES*/ THEN DO;

  11045  6 000144   000000 235000 xsym               LDA     VY_IO_USEPREV
         6 000145   000001 115007                    CMPA    1,DL
         6 000146   000150 600000 6                  TZE     s:11048

      148    11046    3                END;                       /* If VY_IO_USEPREV ~= @YES then do; */
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:40   

  11046  6 000147   000177 710000 6                  TRA     s:11071

      149    11047    3             ELSE DO;                      /* If VY_IO_USEPREV ~= @YES then do; */

      150    11048    3                 VY_IO_USEPREV = 0/*@NO*/;

  11048  6 000150   000000 450000 xsym               STZ     VY_IO_USEPREV

      151    11049    3                 IF VY_IO_SAVEPREV = 2 THEN F$R.V.KEYS# = '0'B/*@NO_B*/;

  11049  6 000151   000000 235000 xsym               LDA     VY_IO_SAVEPREV
         6 000152   000002 115007                    CMPA    2,DL
         6 000153   000156 601000 6                  TNZ     s:11050

  11049  6 000154   000032 236000 7                  LDQ     26
         6 000155   100010 356100                    ANSQ    8,,PR1

      152    11050    4                 DO CASE(KEY);

  11050  6 000156   000000 235100                    LDA     0,,PR0
         6 000157   000001 115007                    CMPA    1,DL
         6 000160   000162 602005 6                  TNC     s:11050+4,AL
         6 000161   000167 710000 6                  TRA     s:11063
         6 000162   000163 710000 6                  TRA     s:11052

      153    11051    4                   CASE(0/*@OF*/);

      154    11052    4                     VY_O_KEY_BUF = VY_O_KEY_BUF_L;

  11052  6 000163   000000 100400                    MLR     fill='000'O
         6 000164   000000 001001 xsym               ADSC9   VY_O_KEY_BUF_L           cn=0,n=513
         6 000165   000000 001001 xsym               ADSC9   VY_O_KEY_BUF             cn=0,n=513
         6 000166   000177 710000 6                  TRA     s:11071

      155    11053    4                   CASE(ELSE);

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:41   
      156    11054        /*E*  ERROR: VYI-E$INTERNAL_READ_SAVE_PREV_VY-0
      157    11055        MESSAGE: Internal link error. Save previous switch set for non-object file in VYI$R
             11055        EAD.
      158    11056              DESCRIPTION: Self-explanatory.
      159    11057        */
      160    11058                          %SCREAM(
      161    11059                          ERR#=%E$INTERNAL_READ_SAVE_PREV_VY,
      162    11060                          MID="'I'",
      163    11061                          LEVEL=%@E$F_VY,
      164    11062                          AUX=%@E$OF_VY);

  11063  6 000167   000034 630400 7                  EPPR0   28
         6 000170   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000171   000000 701000 xent               TSX1    VYE$ERROR
         6 000172   000000 011000                    NOP     0

      165    11065    4                   END;                    /* Do case(key); */

      166    11066    3                END;           /*Else do; - if VY_IO_USEPREV ~= @YES then do; */

      167    11067    2            END;                           /* If key ~= @NO_KEY then do; */

  11067  6 000173   000177 710000 6                  TRA     s:11071

      168    11068    2         ELSE DO;                          /* If key ~= @NO_KEY then do; */

      169    11069    2             F$R.V.KEYS# = '0'B/*@NO_B*/;

  11069  6 000174   000001 471400 1                  LDP1    FPT$
         6 000175   000032 236000 7                  LDQ     26
         6 000176   100010 356100                    ANSQ    8,,PR1

      170    11070    2            END;                       /* Else do; - if key ~= @NO_KEY then do; */

      171    11071    1         CALL M$READ( F$R )            ALTRET( READ_ERROR );

  11071  6 000177   000001 470400 1                  LDP0    FPT$
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:42   
         6 000200   440000 713400                    CLIMB   alt,read
         6 000201   401400 401760                    pmme    nvectors=4
         6 000202   000524 702000 6                  TSX2    READ_ERROR

      172    11072    1         VY_IO_STATUS = -1;

  11072  6 000203   000001 335007                    LCA     1,DL
         6 000204   000000 755000 xsym               STA     VY_IO_STATUS

      173    11073    1   CONTINUE:
      174    11074    2         IF VY_IO_SAVEPREV ~= 0/*@NO*/ THEN DO;

  11074  6 000205   000000 235000 xsym  CONTINUE     LDA     VY_IO_SAVEPREV
         6 000206   000230 600000 6                  TZE     s:11094

      175    11075    2             VY_IO_SAVEPREV = 0/*@NO*/;         /*Reset*/

  11075  6 000207   000000 450000 xsym               STZ     VY_IO_SAVEPREV

      176    11076    3             DO CASE( TYPE );

  11076  6 000210   200003 470500                    LDP0    @TYPE,,AUTO
         6 000211   000000 235100                    LDA     0,,PR0
         6 000212   000001 115007                    CMPA    1,DL
         6 000213   000215 602005 6                  TNC     s:11076+5,AL
         6 000214   000224 710000 6                  TRA     s:11090
         6 000215   000216 710000 6                  TRA     s:11078

      177    11077    3               CASE(0/*@OF*/);

      178    11078    3                 VY_O_KEY_BUF_L.FORM0.COUNT = VY_O_KEY_BUF.FORM0.COUNT;

  11078  6 000216   000000 236000 xsym               LDQ     VY_O_KEY_BUF
         6 000217   000000 552040 xsym               STBQ    VY_O_KEY_BUF_L,'40'O

      179    11079    3                 VY_O_KEY_BUF_L.FORM0.CHARS = VY_O_KEY_BUF.FORM0.CHARS;

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:43   
  11079  6 000220   040000 100400                    MLR     fill='040'O
         6 000221   000000 201000 xsym               ADSC9   VY_O_KEY_BUF             cn=1,n=512
         6 000222   000000 201000 xsym               ADSC9   VY_O_KEY_BUF_L           cn=1,n=512
         6 000223   000230 710000 6                  TRA     s:11094

      180    11080    3               CASE(ELSE);

      181    11081        /*E*  ERROR: VYI-E$INTERNAL_READ_USE_PREV_VY-0
      182    11082        MESSAGE: Internal link error. Use previous switch set for non-object file in VYI$RE
             11082        AD.
      183    11083              DESCRIPTION: Self-explanatory.
      184    11084        */
      185    11085                      %SCREAM(
      186    11086                      ERR#=%E$INTERNAL_READ_USE_PREV_VY,
      187    11087                      MID="'I'",
      188    11088                      LEVEL=%@E$F_VY,
      189    11089                      AUX=%@E$OF_VY);

  11090  6 000224   000041 630400 7                  EPPR0   33
         6 000225   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000226   000000 701000 xent               TSX1    VYE$ERROR
         6 000227   000000 011000                    NOP     0

      190    11092    3               END;

      191    11093    2            END;

      192    11094    1         VY_IO_SIZEC = DCB$ -> F$DCB.ARS#;

  11094  6 000230   000000 470400 1                  LDP0    DCB$
         6 000231   000000 235100                    LDA     0,,PR0
         6 000232   000000 755000 xsym               STA     VY_IO_SIZEC

      193    11095    1         VY_IO_SIZEW = ( VY_IO_SIZEC + 4/*@CHAR_WORD*/ - 1 ) /4/*@CHAR_WORD*/;

  11095  6 000233   000000 236000 xsym               LDQ     VY_IO_SIZEC
         6 000234   000003 036007                    ADLQ    3,DL
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:44   
         6 000235   000004 506007                    DIV     4,DL
         6 000236   000000 756000 xsym               STQ     VY_IO_SIZEW

      194    11096    1         VY_OK.KFILE = TYPE;

  11096  6 000237   200003 471500                    LDP1    @TYPE,,AUTO
         6 000240   100000 235100                    LDA     0,,PR1
         6 000241   000000 755000 xsym               STA     VY_OK

      195    11097    2         IF K$ -> C$STRING.CHARS(0) = VY_O_KEY_HEAD THEN DO;

  11097  6 000242   000002 473400 1                  LDP3    K$
         6 000243   040000 106500                    CMPC    fill='040'O
         6 000244   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1
         6 000245   000000 000001 xsym               ADSC9   VY_O_KEY_HEAD            cn=0,n=1
         6 000246   000267 601000 6                  TNZ     s:11106

      196    11098                                                /*Head record*/
      197    11099    2             VY_OK.KTYPE  = -1;

  11099  6 000247   000001 335007                    LCA     1,DL
         6 000250   000001 755000 xsym               STA     VY_OK+1

      198    11100    2             VY_LAST_UTS = VY_OU_HEAD.UTS; /* Save uts */

  11100  6 000251   000000 235000 xsym               LDA     VY_OU_HEAD
         6 000252   000000 755000 xsym               STA     VY_LAST_UTS

      199    11101    2             VY_OK.OUNAME.COUNT = K$B.FORM0.COUNT - 1; /* Set count */

  11101  6 000253   300000 236100                    LDQ     0,,PR3
         6 000254   000033 772000                    QRL     27
         6 000255   000001 136007                    SBLQ    1,DL
         6 000256   000033 736000                    QLS     27
         6 000257   000013 552040 xsym               STBQ    VY_OK+11,'40'O

      200    11102    2             VY_OK.OUNAME.CHARS = SUBSTR( K$B.FORM0.CHARS,1,VY_OK.OUNAME.COUNT );
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:45   

  11102  6 000260   000013 236000 xsym               LDQ     VY_OK+11
         6 000261   000033 772000                    QRL     27
         6 000262   000000 620006                    EAX0    0,QL
         6 000263   040000 100540                    MLR     fill='040'O
         6 000264   300000 400010                    ADSC9   0,,PR3                   cn=2,n=*X0
         6 000265   000013 200777 xsym               ADSC9   VY_OK+11                 cn=1,n=511

      201    11103                                        /* Move object unit name into textc buffer */
      202    11104    2            END;

  11104  6 000266   000523 710000 6                  TRA     s:11215

      203    11105    1         ELSE
      204    11106    1             IF K$ -> T$C.CHARS = VY_O_KEY_TREE THEN VY_OK.KTYPE = -2;

  11106  6 000267   300000 236100                    LDQ     0,,PR3
         6 000270   000033 772000                    QRL     27
         6 000271   000000 620006                    EAX0    0,QL
         6 000272   040000 106540                    CMPC    fill='040'O
         6 000273   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         6 000274   000000 000005 xsym               ADSC9   VY_O_KEY_TREE            cn=0,n=5
         6 000275   000301 601000 6                  TNZ     s:11108

  11106  6 000276   000002 335007                    LCA     2,DL
         6 000277   000001 755000 xsym               STA     VY_OK+1
         6 000300   000523 710000 6                  TRA     s:11215

      205    11107    1             ELSE
      206    11108    2                 IF K$B.FORM1.O777 = BITBIN('777'O) THEN DO; /* Form 1 or 2 */

  11108  6 000301   300000 236100                    LDQ     0,,PR3
         6 000302   000777 376003                    ANQ     511,DU
         6 000303   000777 116003                    CMPQ    511,DU
         6 000304   000507 601000 6                  TNZ     s:11209

      207    11109    2                     COUNT = K$B.FORM0.COUNT; /* Get count */
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:46   

  11109  6 000305   300000 236100                    LDQ     0,,PR3
         6 000306   000033 772000                    QRL     27
         6 000307   000012 756000 1                  STQ     COUNT

      208    11110    3                     IF COUNT = 7 THEN DO;

  11110  6 000310   000007 116007                    CMPQ    7,DL
         6 000311   000366 601000 6                  TNZ     s:11136

      209    11111    3                         VY_OK.KTYPE = 1;  /* Set key form */

  11111  6 000312   000001 235007                    LDA     1,DL
         6 000313   000001 755000 xsym               STA     VY_OK+1

      210    11112    3                         RTYPE = K$B.FORM1.REC_TYPE; /* Set record type retrieved */

  11112  6 000314   300001 236100                    LDQ     1,,PR3
         6 000315   000011 772000                    QRL     9
         6 000316   000777 376007                    ANQ     511,DL
         6 000317   000005 756000 1                  STQ     RTYPE

      211    11113    3                         IF RTYPE ~= VY_OK.KRTYPE THEN VY_OK.KPAGE# = -1;

  11113  6 000320   000002 116000 xsym               CMPQ    VY_OK+2
         6 000321   000324 600000 6                  TZE     s:11114

  11113  6 000322   000001 335007                    LCA     1,DL
         6 000323   000003 755000 xsym               STA     VY_OK+3

      212    11114    3                         VY_OK.KRTYPE = RTYPE;

  11114  6 000324   000002 756000 xsym               STQ     VY_OK+2

      213    11115    3                         IF VY_OK.KRTYPE < 1

  11115  6 000325   000000 116003                    CMPQ    0,DU
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:47   
         6 000326   000333 600000 6                  TZE     s:11120
         6 000327   000020 116007                    CMPQ    16,DL
         6 000330   000333 603000 6                  TRC     s:11120
         6 000331   000012 116007                    CMPQ    10,DL
         6 000332   000337 601000 6                  TNZ     s:11121

      214    11116    3                                 OR
      215    11117    3                                 VY_OK.KRTYPE > 15
      216    11118    3                                 OR
      217    11119    3                                 VY_OK.KRTYPE = 10
      218    11120    3                         THEN CALL REPORT_INCONSISTENCY( 1 /* Key form 1 */ );

  11120  6 000333   000012 236000 7                  LDQ     10
         6 000334   200013 756100                    STQ     OVERWRITE+3,,AUTO
         6 000335   001033 701000 6                  TSX1    REPORT_INCONSISTENCY
         6 000336   000000 011000                    NOP     0

      219    11121    4                         IF VY_OK.KPAGE# > 0 THEN DO;
             11121                                  /* Check if checks should be performed */

  11121  6 000337   000003 235000 xsym               LDA     VY_OK+3
         6 000340   000361 604400 6                  TMOZ    s:11133

      220    11122    5                             IF VY_OK.KPAGE# + 1 ~= K$B.FORM1.PAGE# THEN DO;
             11122                                      /* Sequence error*/

  11122  6 000341   000002 470400 1                  LDP0    K$
         6 000342   000001 236100                    LDQ     1,,PR0
         6 000343   000777 376007                    ANQ     511,DL
         6 000344   200016 756100                    STQ     @CURR#+1,,AUTO
         6 000345   000003 236000 xsym               LDQ     VY_OK+3
         6 000346   000001 036007                    ADLQ    1,DL
         6 000347   200016 116100                    CMPQ    @CURR#+1,,AUTO
         6 000350   000361 600000 6                  TZE     s:11133

      221    11123        /*E*  ERROR: VYI-E$PAGE_SEQUENCE_VY-0
      222    11124        MESSAGE: Page sequence error for record type = %U1.
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:48   
      223    11125        DESCRIPTION: Page sequence error has occurred for object unit records
      224    11126        */
      225    11127    5                                 CALL REPORT_SEQUENCE_ERROR( /* ERR# */

  11127  6 000351   000002 236000 1                  LDQ     K$
         6 000352   000046 036000 7                  ADLQ    38
         6 000353   000047 235000 7                  LDA     39
         6 000354   200014 757100                    STAQ    @ERR_CODE+1,,AUTO
         6 000355   000050 236000 7                  LDQ     40
         6 000356   200013 756100                    STQ     OVERWRITE+3,,AUTO
         6 000357   001063 701000 6                  TSX1    REPORT_SEQUENCE_ERROR
         6 000360   000000 011000                    NOP     0

      226    11128    5                                         401,
      227    11129    5                                         VY_OK.KPAGE#, /*Set previous */
      228    11130    5                                         K$B.FORM1.PAGE# /* Set current */ );
      229    11131    5                                END;

      230    11132    4                            END;

      231    11133    3                         VY_OK.KPAGE# = K$B.FORM1.PAGE#; /* Set page number */

  11133  6 000361   000002 470400 1                  LDP0    K$
         6 000362   000001 236100                    LDQ     1,,PR0
         6 000363   000777 376007                    ANQ     511,DL
         6 000364   000003 756000 xsym               STQ     VY_OK+3

      232    11134    3                        END;

  11134  6 000365   000523 710000 6                  TRA     s:11215

      233    11135    2                     ELSE
      234    11136    3                         IF COUNT = 11 OR COUNT = 12 THEN DO;

  11136  6 000366   000013 116007                    CMPQ    11,DL
         6 000367   000372 600000 6                  TZE     s:11137
         6 000370   000014 116007                    CMPQ    12,DL
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:49   
         6 000371   000473 601000 6                  TNZ     BAD_O_KEY

      235    11137    3                             VY_OK.KTYPE = 2; /* Set key form */

  11137  6 000372   000002 235007                    LDA     2,DL
         6 000373   000001 755000 xsym               STA     VY_OK+1

      236    11138    3                             VY_OK.KRTYPE = K$B.FORM2.D10; /* Set record type */

  11138  6 000374   300001 236100                    LDQ     1,,PR3
         6 000375   000011 772000                    QRL     9
         6 000376   000777 376007                    ANQ     511,DL
         6 000377   000002 756000 xsym               STQ     VY_OK+2

      237    11139    4                             IF VY_OK.KRTYPE ~= 10 THEN DO; /* Check if type 10 */

  11139  6 000400   000012 116007                    CMPQ    10,DL
         6 000401   000406 600000 6                  TZE     s:11142

      238    11140    4                                 CALL REPORT_INCONSISTENCY( 2 /* Key form 2 */ );

  11140  6 000402   000051 236000 7                  LDQ     41
         6 000403   200013 756100                    STQ     OVERWRITE+3,,AUTO
         6 000404   001033 701000 6                  TSX1    REPORT_INCONSISTENCY
         6 000405   000000 011000                    NOP     0

      239    11141    4                                END;

      240    11142    3                             VY_OK.KSECT# = K$B.FORM2.SECT#; /* Set section # */

  11142  6 000406   000002 470400 1                  LDP0    K$
         6 000407   000001 235100                    LDA     1,,PR0
         6 000410   000002 236100                    LDQ     2,,PR0
         6 000411   000033 773000                    LRL     27
         6 000412   777777 376007                    ANQ     -1,DL
         6 000413   000007 756000 xsym               STQ     VY_OK+7

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:50   
      241    11143    3                             VY_OK.KOFSET = K$B.FORM2.OFFSET; /* Setoffset */

  11143  6 000414   000002 236100                    LDQ     2,,PR0
         6 000415   000011 772000                    QRL     9
         6 000416   777777 376007                    ANQ     -1,DL
         6 000417   000004 756000 xsym               STQ     VY_OK+4

      242    11144    3                             VY_OK.KSTYPE = K$B.FORM2.STYPE; /* Set SUB_TYPE*/

  11144  6 000420   000002 236100                    LDQ     2,,PR0
         6 000421   000777 376007                    ANQ     511,DL
         6 000422   000005 756000 xsym               STQ     VY_OK+5

      243    11145    4                             IF VY_OK.KSTYPE > 1 THEN DO; /* Range error */

  11145  6 000423   000002 116007                    CMPQ    2,DL
         6 000424   000435 602000 6                  TNC     s:11171

      244    11146        /*E*  ERROR: VYI-E$BAD_FORM1_SUB_TYPE_VY-0
      245    11147         MESSAGE: Illegal subtype value detected for record type 10. Subtype = %U1.
      246    11148        DESCRIPTION: Self-explanatory.
      247    11149        */
      248    11150                                      %NUMBER( NUM1="VY_OK.KSTYPE" );

  11156  6 000425   000052 630400 7                  EPPR0   42
         6 000426   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 000427   000000 701000 xent               TSX1    VYD$B2C
         6 000430   000000 011000                    NOP     0

      249    11167                                     %SCREAM(ERR#=%E$BAD_FORM1_SUB_TYPE_VY,MID="'I'",LEVEL=
             11167                                          %@E$F_VY,AUX=%@E$OUOF_VY );

  11168  6 000431   000060 630400 7                  EPPR0   48
         6 000432   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000433   000000 701000 xent               TSX1    VYE$ERROR
         6 000434   000000 011000                    NOP     0

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:51   
      250    11170    4                                END;

      251    11171    3                            IF COUNT = 11 THEN VY_OK.KSEQUENCE = -1; /* Reset count */

  11171  6 000435   000012 235000 1                  LDA     COUNT
         6 000436   000013 115007                    CMPA    11,DL
         6 000437   000443 601000 6                  TNZ     s:11173

  11171  6 000440   000001 336007                    LCQ     1,DL
         6 000441   000006 756000 xsym               STQ     VY_OK+6
         6 000442   000523 710000 6                  TRA     s:11215

      252    11172    4                             ELSE DO;      /* Check */

      253    11173    5                                 IF VY_OK.KSEQUENCE ~= -1 THEN DO; /* Not the first */

  11173  6 000443   000006 236000 xsym               LDQ     VY_OK+6
         6 000444   000027 116000 xsym               CMPQ    B_VECTNIL+23
         6 000445   000523 600000 6                  TZE     s:11215

      254    11174    6                                     IF VY_OK.KSEQUENCE + 1 < K$B.FORM2.SEQUENCE THEN
             11174                                              DO;

  11174  6 000446   000002 470400 1                  LDP0    K$
         6 000447   000003 236100                    LDQ     3,,PR0
         6 000450   000033 772000                    QRL     27
         6 000451   200016 756100                    STQ     @CURR#+1,,AUTO
         6 000452   000006 236000 xsym               LDQ     VY_OK+6
         6 000453   000001 036007                    ADLQ    1,DL
         6 000454   200016 116100                    CMPQ    @CURR#+1,,AUTO
         6 000455   000466 605000 6                  TPL     s:11185

      255    11175        /*E*  ERROR: VYI-E$BAD_SEQUENCE_VY
      256    11176        MESSAGE: Text/relocation sequencing error for record type = %U1.
      257    11177       DESCRIPTION: A sequencing problem has arisen in the object unit for text/relocation(
             11177        type 10 ) records.
      258    11178        */
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:52   
      259    11179    6                                         CALL REPORT_SEQUENCE_ERROR( /* ERR# */

  11179  6 000456   000002 236000 1                  LDQ     K$
         6 000457   000003 036003                    ADLQ    3,DU
         6 000460   000065 235000 7                  LDA     53
         6 000461   200014 757100                    STAQ    @ERR_CODE+1,,AUTO
         6 000462   000066 236000 7                  LDQ     54
         6 000463   200013 756100                    STQ     OVERWRITE+3,,AUTO
         6 000464   001063 701000 6                  TSX1    REPORT_SEQUENCE_ERROR
         6 000465   000000 011000                    NOP     0

      260    11180    6                                                 404,
      261    11181    6                                                 VY_OK.KSEQUENCE,
      262    11182    6                                                 K$B.FORM2.SEQUENCE );
      263    11183                                                /*Error-sequencing */
      264    11184    6                                        END;

      265    11185    5                                     VY_OK.KSEQUENCE = K$B.FORM2.SEQUENCE;

  11185  6 000466   000002 470400 1                  LDP0    K$
         6 000467   000003 236100                    LDQ     3,,PR0
         6 000470   000033 772000                    QRL     27
         6 000471   000006 756000 xsym               STQ     VY_OK+6

      266    11186    5                                    END;

      267    11187    4                                END;

      268    11188    3                            END;

  11188  6 000472   000523 710000 6                  TRA     s:11215

      269    11189    3                         ELSE DO;          /* Error */

      270    11190    3   BAD_O_KEY:
      271    11191        /**/
      272    11192        /* Check if checking should be by-passed */
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:53   
      273    11193        /**/
      274    11194    4                             IF P_OVERWRITE THEN DO;

  11194  6 000473   200007 470500       BAD_O_KEY    LDP0    @P_OVERWRITE,,AUTO
         6 000474   000000 234100                    SZN     0,,PR0
         6 000475   000502 605000 6                  TPL     s:11204

      275    11195    4                                 VY_IO_SAVEPREV = 0/*@NO*/;

  11195  6 000476   000000 450000 xsym               STZ     VY_IO_SAVEPREV

      276    11196    4                                 VY_OK.KTYPE = -5;

  11196  6 000477   000005 335007                    LCA     5,DL
         6 000500   000001 755000 xsym               STA     VY_OK+1

      277    11197    4                                 RETURN;

  11197  6 000501   000000 702200 xent               TSX2  ! X66_ARET

      278    11198    4                                END;
      279    11199        /*E*  ERROR: VYI-E$UNKNOWN_REC_TYPE_VY-0
      280    11200        MESSAGE: Unknown/illegal record type detected.
      281    11201        DESCRIPTION: Self-explanatory.
      282    11202        */
      283    11203                                  %SCREAM(ERR#=%E$UNKNOWN_REC_TYPE_VY,MID="'I'",LEVEL=
             11203                                      %@E$F_VY,AUX=%@E$OUOF_VY);

  11204  6 000502   000070 630400 7                  EPPR0   56
         6 000503   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000504   000000 701000 xent               TSX1    VYE$ERROR
         6 000505   000000 011000                    NOP     0

      284    11206    3                            END;

      285    11207    2                    END;

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:54   
  11207  6 000506   000523 710000 6                  TRA     s:11215

      286    11208    2                 ELSE DO;                  /* Check if lib search key */

      287    11209    2                     IF VY_OK.KFILE = 2/*@LF*/ AND

  11209  6 000507   000002 115007                    CMPA    2,DL
         6 000510   000473 601000 6                  TNZ     BAD_O_KEY
         6 000511   300000 236100                    LDQ     0,,PR3
         6 000512   777000 376003                    ANQ     -512,DU
         6 000513   400000 116003                    CMPQ    -131072,DU
         6 000514   000473 603000 6                  TRC     BAD_O_KEY
         6 000515   000000 235000 xsym               LDA     VY_IO_SIZEC
         6 000516   000377 115007                    CMPA    255,DL
         6 000517   000473 605400 6                  TPNZ    BAD_O_KEY

      288    11210    2                             K$B.FORM0.COUNT <= 255 AND
      289    11211    2                             VY_IO_SIZEC <= 255
      290    11212    2                     THEN VY_OK.KTYPE = -3; /* Assume library probe */

  11212  6 000520   000003 335007                    LCA     3,DL
         6 000521   000001 755000 xsym               STA     VY_OK+1
         6 000522   000523 710000 6                  TRA     s:11215

      291    11213    2                     ELSE GOTO BAD_O_KEY;
      292    11214    2                    END;
      293    11215    1         RETURN;

  11215  6 000523   000000 702200 xent               TSX2  ! X66_ARET

      294    11216        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:55   
      295    11217    1   READ_ERROR:
      296    11218    1         ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR#/*@ALT_ERROR*/;

  11218  6 000524   000000 470400 xsym  READ_ERROR   LDP0    B$TCB$
         6 000525   000000 471500                    LDP1    0,,PR0
         6 000526   100102 236100                    LDQ     66,,PR1
         6 000527   000003 772000                    QRL     3
         6 000530   037777 376007                    ANQ     16383,DL
         6 000531   000003 756000 1                  STQ     ERR

      297    11219    2         IF ERR = 6 THEN DO;

  11219  6 000532   000006 116007                    CMPQ    6,DL
         6 000533   000536 601000 6                  TNZ     s:11223

      298    11220    2             VY_IO_STATUS = 0/*@IO_EOF*/;

  11220  6 000534   000000 450000 xsym               STZ     VY_IO_STATUS

      299    11221    2            END;

  11221  6 000535   000564 710000 6                  TRA     POP_OUT

      300    11222    1         ELSE
      301    11223    2             IF ERR = 66 THEN DO;

  11223  6 000536   000102 116007                    CMPQ    66,DL
         6 000537   000543 601000 6                  TNZ     s:11227

      302    11224    2                 VY_IO_STATUS = 1/*@IO_NOKEY*/;

  11224  6 000540   000001 235007                    LDA     1,DL
         6 000541   000000 755000 xsym               STA     VY_IO_STATUS

      303    11225    2                END;

  11225  6 000542   000564 710000 6                  TRA     POP_OUT
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:56   

      304    11226    1             ELSE
      305    11227    2                 IF ERR = 7 THEN DO;

  11227  6 000543   000007 116007                    CMPQ    7,DL
         6 000544   000556 601000 6                  TNZ     REPORT_ERROR

      306    11228    2                     VY_IO_STATUS = 2/*@IO_LD*/;

  11228  6 000545   000002 235007                    LDA     2,DL
         6 000546   000000 755000 xsym               STA     VY_IO_STATUS

      307    11229    2                     IF TYPE = 1/*@RF*/ THEN GOTO POP_OUT;

  11229  6 000547   200003 471500                    LDP1    @TYPE,,AUTO
         6 000550   100000 235100                    LDA     0,,PR1
         6 000551   000001 115007                    CMPA    1,DL
         6 000552   000564 600000 6                  TZE     POP_OUT

      308    11230    2                     IF VY_IO_SAVEPREV > 0 THEN GOTO CONTINUE;

  11230  6 000553   000000 235000 xsym               LDA     VY_IO_SAVEPREV
         6 000554   000205 605400 6                  TPNZ    CONTINUE

      309    11231    2                    END;

  11231  6 000555   000564 710000 6                  TRA     POP_OUT

      310    11232    2                 ELSE DO;

      311    11233        /* Here for irrecoverable i/o errors */
      312    11234    2   REPORT_ERROR:
      313    11235    2                     CALL M$MERC ALTRET(MERC_ERROR);

  11235  6 000556   410007 713400       REPORT_ERROR CLIMB   alt,+4103
         6 000557   000000 401760                    pmme    nvectors=0
         6 000560   000642 702000 6                  TSX2    MERC_ERROR
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:57   

      314    11236                          %ERROR_IT;

  11237  6 000561   000000 237200 xsym               LDAQ  ! VY_UNWIND
         6 000562   000000 700200 xent               TSX0  ! X66_AUNWIND
         6 000563   000000 000200                    ZERO    0,128

      315    11239    2                    END;
      316    11240    1   POP_OUT:
      317    11241        /* Reset global i/o variables */
      318    11242    1         VY_IO_SIZEC = 0;

  11242  6 000564   000000 450000 xsym  POP_OUT      STZ     VY_IO_SIZEC

      319    11243    1         VY_IO_SIZEW = 0;

  11243  6 000565   000000 450000 xsym               STZ     VY_IO_SIZEW

      320    11244    1         VY_IO_SAVEPREV = 0/*@NO*/;

  11244  6 000566   000000 450000 xsym               STZ     VY_IO_SAVEPREV

      321    11245    1         VY_OK.KTYPE = -5;

  11245  6 000567   000005 335007                    LCA     5,DL
         6 000570   000001 755000 xsym               STA     VY_OK+1

      322    11246    1         ALTRETURN;

  11246  6 000571   000000 702200 xent               TSX2  ! X66_AALT

      323    11247    1   WRITE_ERROR:
      324    11248    1         IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR#/*@ALT_ERROR*/ = 61 AND

  11248  6 000572   000000 470400 xsym  WRITE_ERROR  LDP0    B$TCB$
         6 000573   000000 471500                    LDP1    0,,PR0
         6 000574   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:58   
         6 000575   377770 376007                    ANQ     131064,DL
         6 000576   000750 116007                    CMPQ    488,DL
         6 000577   000606 601000 6                  TNZ     s:11254
         6 000600   200007 236100                    LDQ     @P_OVERWRITE,,AUTO
         6 000601   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000602   000606 600000 6                  TZE     s:11254

      325    11249    1                 ADDR(P_OVERWRITE) ~= ADDR(NIL)
      326    11250    2         THEN DO;

      327    11251    2             VY_IO_STATUS = 3/*@IO_EXISTS*/;

  11251  6 000603   000003 235007                    LDA     3,DL
         6 000604   000000 755000 xsym               STA     VY_IO_STATUS

      328    11252    2             GOTO POP_OUT;

  11252  6 000605   000564 710000 6                  TRA     POP_OUT

      329    11253    2            END;
      330    11254    1         IF VY_COMMAND=3/*@C_COPY_KEY_WORD*/ OR VY_COMMAND=4/*@C_EXTRACT_KEY_WORD*/

  11254  6 000606   000000 235000 xsym               LDA     VY_COMMAND
         6 000607   000003 115007                    CMPA    3,DL
         6 000610   000613 600000 6                  TZE     s:11256
         6 000611   000004 115007                    CMPA    4,DL
         6 000612   000556 601000 6                  TNZ     REPORT_ERROR

      331    11255    2         THEN DO;

      332    11256    2             CALL VYE$ERRMSG;

  11256  6 000613   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000614   000000 701000 xent               TSX1    VYE$ERRMSG
         6 000615   000000 011000                    NOP     0

      333    11257    2             IF VY_COMMAND=3/*@C_COPY_KEY_WORD*/ THEN VYI_ROLLBACK='1'B;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:59   

  11257  6 000616   000000 235000 xsym               LDA     VY_COMMAND
         6 000617   000003 115007                    CMPA    3,DL
         6 000620   000623 601000 6                  TNZ     s:11258

  11257  6 000621   400000 236003                    LDQ     -131072,DU
         6 000622   000100 756000 1                  STQ     VYI_ROLLBACK

      334    11258    2             CALL VYO$DEL_UNIT(TYPE,'0'B,'1'B,'0'B,VY_LINK_UTS);

  11258  6 000623   000074 236000 7                  LDQ     60
         6 000624   200022 756100                    STQ     @CURR#+5,,AUTO
         6 000625   000076 237000 7                  LDAQ    62
         6 000626   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 000627   000005 236000 7                  LDQ     5
         6 000630   200003 235100                    LDA     @TYPE,,AUTO
         6 000631   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 000632   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 000633   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 000634   000000 701000 xent               TSX1    VYO$DEL_UNIT
         6 000635   000000 011000                    NOP     0

      335    11259    2             CALL VYI$ERR;

  11259  6 000636   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000637   000000 701000 xent               TSX1    VYI$ERR
         6 000640   000000 011000                    NOP     0

      336    11260    2            END;

  11260  6 000641   000642 710000 6                  TRA     MERC_ERROR

      337    11261    1         ELSE GOTO REPORT_ERROR;
      338    11262    1   MERC_ERROR:
      339    11263    1         CALL VYE$MERC;

  11263  6 000642   000002 631400 xsym  MERC_ERROR   EPPR1   B_VECTNIL+2
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:60   
         6 000643   000000 701000 xent               TSX1    VYE$MERC
         6 000644   000000 011000                    NOP     0
         6 000645   000650 710000 6                  TRA     s:11267

      340    11264        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:61   
      341    11265    1   VYI$WRITE:
      342    11266    1         ENTRY(         TYPE, BUF$, SIZE, KEY, P_OVERWRITE )  ALTRET;

  11266  6 000646   000000 700200 xent  VYI$WRITE    TSX0  ! X66_AUTO_5
         6 000647   000024 000005                    ZERO    20,5

      343    11267    1         SIZE2 = SIZE * 4;

  11267  6 000650   200005 470500                    LDP0    @SIZE,,AUTO
         6 000651   000000 235100                    LDA     0,,PR0
         6 000652   000002 735000                    ALS     2
         6 000653   000006 755000 1                  STA     SIZE2

      344    11268    1         GOTO JUMP_SIZE;

  11268  6 000654   000662 710000 6                  TRA     JUMP_SIZE

      345    11269    1   VYI$WRITE_C:
      346    11270    1         ENTRY(         TYPE, BUF$, SIZE, KEY, P_OVERWRITE )  ALTRET;

  11270  6 000655   000000 700200 xent  VYI$WRITE_C  TSX0  ! X66_AUTO_5
         6 000656   000024 000005                    ZERO    20,5

      347    11271    1         SIZE2 = SIZE;

  11271  6 000657   200005 470500                    LDP0    @SIZE,,AUTO
         6 000660   000000 235100                    LDA     0,,PR0
         6 000661   000006 755000 1                  STA     SIZE2

      348    11272    1   JUMP_SIZE:
      349    11273    1         IF ADDR(P_OVERWRITE) = ADDR(NIL)

  11273  6 000662   200007 236100       JUMP_SIZE    LDQ     @P_OVERWRITE,,AUTO
         6 000663   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000664   000667 601000 6                  TNZ     s:11275

      350    11274    1         THEN OVERWRITE = '0'B/*@NO_B*/;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:62   

  11274  6 000665   200010 450100                    STZ     OVERWRITE,,AUTO
         6 000666   000673 710000 6                  TRA     s:11276

      351    11275    1         ELSE OVERWRITE = P_OVERWRITE;

  11275  6 000667   200007 471500                    LDP1    @P_OVERWRITE,,AUTO
         6 000670   100000 236100                    LDQ     0,,PR1
         6 000671   400000 376003                    ANQ     -131072,DU
         6 000672   200010 756100                    STQ     OVERWRITE,,AUTO

      352    11276    2         DO CASE( TYPE );

  11276  6 000673   200003 471500                    LDP1    @TYPE,,AUTO
         6 000674   100000 235100                    LDA     0,,PR1
         6 000675   000002 115007                    CMPA    2,DL
         6 000676   000700 602005 6                  TNC     s:11276+5,AL
         6 000677   000710 710000 6                  TRA     s:11297
         6 000700   000702 710000 6                  TRA     s:11278
         6 000701   000705 710000 6                  TRA     s:11280

      353    11277    2           CASE( 0/*@OF*/ );

      354    11278    2             FPT$ = ADDR( VY_O_FPT_WRITE );

  11278  6 000702   000100 236000 7                  LDQ     64
         6 000703   000001 756000 1                  STQ     FPT$
         6 000704   000727 710000 6                  TRA     s:11315

      355    11279    2           CASE( 1/*@RF*/ );

      356    11280    2             FPT$ = ADDR( VY_R_FPT_WRITE );

  11280  6 000705   000101 236000 7                  LDQ     65
         6 000706   000001 756000 1                  STQ     FPT$
         6 000707   000727 710000 6                  TRA     s:11315

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:63   
      357    11281        /* Not possible for linker
      358    11282                   case( @LF );
      359    11283                   FPT$ = addr( VY_O_FPT_WRITE );
      360    11284        */
      361    11285    2           CASE(ELSE);

      362    11286        /*E*  ERROR: VYI-E$INTERNAL_WRITE_BAD_TYPE_VY-0
      363    11287              MESSAGE: Internal link error. Bad type passed to VYI$WRITE: Type = %U1.
      364    11288              DESCRIPTION: Self-explanatory.
      365    11289        */
      366    11290                  %NUMBER(
      367    11291                  NUM1=TYPE, BASE1=10, SIZE1=12 );

  11297  6 000710   000002 236000 7                  LDQ     2
         6 000711   200022 756100                    STQ     @CURR#+5,,AUTO
         6 000712   200003 236100                    LDQ     @TYPE,,AUTO
         6 000713   000003 235000 7                  LDA     3
         6 000714   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 000715   000004 237000 7                  LDAQ    4
         6 000716   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 000717   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 000720   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 000721   000000 701000 xent               TSX1    VYD$B2C
         6 000722   000000 011000                    NOP     0

      368    11308                  %SCREAM(
      369    11309                  ERR#=%E$INTERNAL_WRITE_BAD_TYPE_VY,
      370    11310                  MID="'I'",
      371    11311                  LEVEL=%@E$F_VY);

  11312  6 000723   000103 630400 7                  EPPR0   67
         6 000724   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000725   000000 701000 xent               TSX1    VYE$ERROR
         6 000726   000000 011000                    NOP     0

      372    11314    2           END;

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:64   
      373    11315    1         F$W.BUF_.BOUND   = SIZE2 - 1;

  11315  6 000727   000001 470400 1                  LDP0    FPT$
         6 000730   000006 236000 1                  LDQ     SIZE2
         6 000731   000001 136007                    SBLQ    1,DL
         6 000732   000020 736000                    QLS     16
         6 000733   000004 676100                    ERQ     4,,PR0
         6 000734   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 000735   000004 656100                    ERSQ    4,,PR0

      374    11316    1         F$W.BUF_.BUF$   = BUF$;

  11316  6 000736   200004 471500                    LDP1    @BUF$,,AUTO
         6 000737   100000 236100                    LDQ     0,,PR1
         6 000740   000005 756100                    STQ     5,,PR0

      375    11317    2         IF KEY ~= 4/*@NO_KEY*/ THEN DO;

  11317  6 000741   200006 473500                    LDP3    @KEY,,AUTO
         6 000742   300000 235100                    LDA     0,,PR3
         6 000743   000004 115007                    CMPA    4,DL
         6 000744   001010 600000 6                  TZE     s:11359

      376    11318    3             DO CASE( KEY );

  11318  6 000745   000004 115007                    CMPA    4,DL
         6 000746   000750 602005 6                  TNC     s:11318+3,AL
         6 000747   000770 710000 6                  TRA     s:11339
         6 000750   000754 710000 6                  TRA     s:11320
         6 000751   000757 710000 6                  TRA     s:11322
         6 000752   000762 710000 6                  TRA     s:11324
         6 000753   000765 710000 6                  TRA     s:11326

      377    11319    3               CASE( 0/*@OF*/ );

      378    11320    3                 F$W.KEY_   = VECTOR( VY_O_KEY_BUF );

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:65   
  11320  6 000754   000014 237000 7                  LDAQ    12
         6 000755   000002 757100                    STAQ    2,,PR0
         6 000756   001012 710000 6                  TRA     s:11361

      379    11321    3               CASE( 1/*@RF*/ );

      380    11322    3                 F$W.KEY_   = VECTOR( VY_R_KEY_BUF );

  11322  6 000757   000016 237000 7                  LDAQ    14
         6 000760   000002 757100                    STAQ    2,,PR0
         6 000761   001012 710000 6                  TRA     s:11361

      381    11323    3               CASE( 2/*@LF*/ );

      382    11324    3                 F$W.KEY_   = VECTOR( VY_O_KEY_BUF );

  11324  6 000762   000014 237000 7                  LDAQ    12
         6 000763   000002 757100                    STAQ    2,,PR0
         6 000764   001012 710000 6                  TRA     s:11361

      383    11325    3               CASE( 3/*@NEW_KEY*/ );

      384    11326    3                 F$W.KEY_ = VECTOR( VY_OL_KEY_BUF );

  11326  6 000765   000110 237000 7                  LDAQ    72
         6 000766   000002 757100                    STAQ    2,,PR0
         6 000767   001012 710000 6                  TRA     s:11361

      385    11327    3               CASE( ELSE );

      386    11328        /*E*  ERROR: VYI-E$INTERNAL_WRITE_BAD_KEY_TP_VY-0
      387    11329            MESSAGE: Internal link error. Bad key type passed to VYI$WRITE: Key type = %U1.
      388    11330              DESCRIPTION: Self-explanatory.
      389    11331        */
      390    11332                      %NUMBER(
      391    11333                      NUM1=KEY, BASE1=10, SIZE1=12 );

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:66   
  11339  6 000770   000002 236000 7                  LDQ     2
         6 000771   200022 756100                    STQ     @CURR#+5,,AUTO
         6 000772   200006 236100                    LDQ     @KEY,,AUTO
         6 000773   000003 235000 7                  LDA     3
         6 000774   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 000775   000004 237000 7                  LDAQ    4
         6 000776   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 000777   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 001000   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001001   000000 701000 xent               TSX1    VYD$B2C
         6 001002   000000 011000                    NOP     0

      392    11350                      %SCREAM(
      393    11351                      ERR#=%E$INTERNAL_WRITE_BAD_KEY_TP_VY,
      394    11352                      MID="'I'",
      395    11353                      LEVEL=%@E$F_VY);

  11354  6 001003   000113 630400 7                  EPPR0   75
         6 001004   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001005   000000 701000 xent               TSX1    VYE$ERROR
         6 001006   000000 011000                    NOP     0

      396    11356    3               END;

      397    11357    2            END;

  11357  6 001007   001012 710000 6                  TRA     s:11361

      398    11358    2         ELSE DO;

      399    11359    2             F$W.KEY_   = VECTOR(NIL);

  11359  6 001010   000120 237000 7                  LDAQ    80
         6 001011   000002 757100                    STAQ    2,,PR0

      400    11360    2            END;

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:67   
      401    11361    1         IF OVERWRITE THEN F$W.V.ONEWKEY# = '1'B/*@YES_B*/;

  11361  6 001012   200010 234100                    SZN     OVERWRITE,,AUTO
         6 001013   001020 605000 6                  TPL     s:11363

  11361  6 001014   000001 470400 1                  LDP0    FPT$
         6 001015   000400 236007                    LDQ     256,DL
         6 001016   000010 256100                    ORSQ    8,,PR0
         6 001017   001025 710000 6                  TRA     s:11366

      402    11362    2         ELSE DO;

      403    11363    2             F$W.V.ONEWKEY# = '0'B/*@NO_B*/;

  11363  6 001020   000001 470400 1                  LDP0    FPT$
         6 001021   000122 236000 7                  LDQ     82
         6 001022   000010 356100                    ANSQ    8,,PR0

      404    11364    2             F$W.V.NEWKEY# = '1'B/*@YES_B*/;

  11364  6 001023   000200 236007                    LDQ     128,DL
         6 001024   000010 256100                    ORSQ    8,,PR0

      405    11365    2            END;                           /* Else do; */

      406    11366    1         CALL M$WRITE( F$W )           ALTRET( WRITE_ERROR );

  11366  6 001025   440001 713400                    CLIMB   alt,write
         6 001026   401400 401760                    pmme    nvectors=4
         6 001027   000572 702000 6                  TSX2    WRITE_ERROR

      407    11367    1         VY_IO_STATUS = -1;

  11367  6 001030   000001 335007                    LCA     1,DL
         6 001031   000000 755000 xsym               STA     VY_IO_STATUS

      408    11368    1         RETURN;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:68   

  11368  6 001032   000000 702200 xent               TSX2  ! X66_ARET

      409    11369        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:69   
      410    11370    1   REPORT_INCONSISTENCY: PROC( KEYFORM );

  11370  6 001033   200012 741300       REPORT_INCO* STX1  ! OVERWRITE+2,,AUTO

      411    11371
      412    11372    2   DCL KEYFORM      UBIN;

      413    11373
      414    11374        /*E*  ERROR: VYI-E$BAD_FORM1_REC_TYPE_VY-0
      415    11375              MESSAGE: Object language error.  Illegal record type/key form detected.
      416    11376                       Record type = %U1; Key form = %U2.
      417    11377              DESCRIPTION: A bad record type has been detected within an object unit.
      418    11378        */
      419    11379
      420    11380              %NUMBER( NUM1="VY_OK.KRTYPE", NUM2=KEYFORM );

  11386  6 001034   000123 630400 7                  EPPR0   83
         6 001035   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001036   000000 701000 xent               TSX1    VYD$B2C
         6 001037   000000 011000                    NOP     0

  11390  6 001040   000002 236000 7                  LDQ     2
         6 001041   200022 756100                    STQ     @CURR#+5,,AUTO
         6 001042   200013 236100                    LDQ     @KEYFORM,,AUTO
         6 001043   000131 235000 7                  LDA     89
         6 001044   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 001045   000132 237000 7                  LDAQ    90
         6 001046   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 001047   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 001050   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001051   000000 701000 xent               TSX1    VYD$B2C
         6 001052   000000 011000                    NOP     0

      421    11397
      422    11398
      423    11399              %SCREAM(
      424    11400                      ERR#=%E$BAD_FORM1_REC_TYPE_VY, LEVEL=%@E$F_D_VY,
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:70   
      425    11401                      MID="'I'", AUX=%@E$OUOF_VY );

  11402  6 001053   000136 630400 7                  EPPR0   94
         6 001054   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001055   000000 701000 xent               TSX1    VYE$ERROR
         6 001056   000000 011000                    NOP     0

      426    11404
      427    11405    2         CALL DUMP_KEY_BUF;

  11405  6 001057   001135 701000 6                  TSX1    DUMP_KEY_BUF
         6 001060   000000 011000                    NOP     0

      428    11406
      429    11407    2   END REPORT_INCONSISTENCY;

  11407  6 001061   200012 221300                    LDX1  ! OVERWRITE+2,,AUTO
         6 001062   000001 702211                    TSX2  ! 1,X1

      430    11408
      431    11409        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:71   
      432    11410    1   REPORT_SEQUENCE_ERROR: PROC( ERR_CODE, PREV#, CURR# );

  11410  6 001063   200012 741300       REPORT_SEQU* STX1  ! OVERWRITE+2,,AUTO

      433    11411
      434    11412    2   DCL ERR_CODE  UBIN;

      435    11413    2   DCL PREV#     UBIN;
      436    11414    2   DCL CURR#     UBIN;
      437    11415
      438    11416              %NUMBER( NUM1="VY_OK.KRTYPE" );

  11422  6 001064   000123 630400 7                  EPPR0   83
         6 001065   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001066   000000 701000 xent               TSX1    VYD$B2C
         6 001067   000000 011000                    NOP     0

      439    11433
      440    11434              %SCREAM( ERR# = ERR_CODE, LEVEL=%@E$F_D_VY, MID="'I'" );

  11435  6 001070   000142 237000 7                  LDAQ    98
         6 001071   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 001072   000137 236000 7                  LDQ     95
         6 001073   200013 235100                    LDA     @ERR_CODE,,AUTO
         6 001074   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 001075   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 001076   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001077   000000 701000 xent               TSX1    VYE$ERROR
         6 001100   000000 011000                    NOP     0

      441    11437
      442    11438        /*E*  ERROR: VYI-E$LAST_CURR_VY-0
      443    11439              MESSAGE: Last value = %U1; Current value = %U2.
      444    11440              DESCRIPTION: Display last/current values for appropriate error condition.
      445    11441        */
      446    11442              %NUMBER( NUM1=PREV#, NUM2=CURR# );

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:72   
  11448  6 001101   000002 236000 7                  LDQ     2
         6 001102   200022 756100                    STQ     @CURR#+5,,AUTO
         6 001103   200014 236100                    LDQ     @PREV#,,AUTO
         6 001104   000003 235000 7                  LDA     3
         6 001105   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 001106   000004 237000 7                  LDAQ    4
         6 001107   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 001110   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 001111   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001112   000000 701000 xent               TSX1    VYD$B2C
         6 001113   000000 011000                    NOP     0

  11452  6 001114   000002 236000 7                  LDQ     2
         6 001115   200022 756100                    STQ     @CURR#+5,,AUTO
         6 001116   200015 236100                    LDQ     @CURR#,,AUTO
         6 001117   000131 235000 7                  LDA     89
         6 001120   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 001121   000132 237000 7                  LDAQ    90
         6 001122   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 001123   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 001124   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001125   000000 701000 xent               TSX1    VYD$B2C
         6 001126   000000 011000                    NOP     0

      447    11459
      448    11460              %SCREAM( ERR#=%E$LAST_CURR_VY, LEVEL=%@E$F_VY, MID="'I'", AUX=%@E$OUOF_VY );

  11461  6 001127   000145 630400 7                  EPPR0   101
         6 001130   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001131   000000 701000 xent               TSX1    VYE$ERROR
         6 001132   000000 011000                    NOP     0

      449    11463
      450    11464    2   END REPORT_SEQUENCE_ERROR;

  11464  6 001133   200012 221300                    LDX1  ! OVERWRITE+2,,AUTO
         6 001134   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:73   

      451    11465
      452    11466        %EJECT;
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:74   
      453    11467    1   DUMP_KEY_BUF: PROC;

  11467  6 001135   200014 741300       DUMP_KEY_BUF STX1  ! @PREV#,,AUTO

      454    11468
      455    11469        /*E*  ERROR:  VYI-E$DUMP3_VY-0
      456    11470              MESSAGE: Words 0-2: %U1  %U2  %U3
      457    11471              DESCRIPTION: Dump 3 words in octal.
      458    11472        */
      459    11473
      460    11474              %NUMBER(
      461    11475                      NUM1="K$->VY$WORD_A(0)",  BASE1=8,
      462    11476                      NUM2="K$->VY$WORD_A(1)",  BASE2=8,
      463    11477                      NUM3="K$->VY$WORD_A(2)",  BASE3=8 );

  11483  6 001136   000151 236000 7                  LDQ     105
         6 001137   200022 756100                    STQ     @CURR#+5,,AUTO
         6 001140   000002 236000 1                  LDQ     K$
         6 001141   000003 235000 7                  LDA     3
         6 001142   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 001143   000004 237000 7                  LDAQ    4
         6 001144   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 001145   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 001146   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001147   000000 701000 xent               TSX1    VYD$B2C
         6 001150   000000 011000                    NOP     0

  11487  6 001151   000151 236000 7                  LDQ     105
         6 001152   200022 756100                    STQ     @CURR#+5,,AUTO
         6 001153   000002 236000 1                  LDQ     K$
         6 001154   000001 036003                    ADLQ    1,DU
         6 001155   000131 235000 7                  LDA     89
         6 001156   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 001157   000132 237000 7                  LDAQ    90
         6 001160   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 001161   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 001162   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:75   
         6 001163   000000 701000 xent               TSX1    VYD$B2C
         6 001164   000000 011000                    NOP     0

  11491  6 001165   000151 236000 7                  LDQ     105
         6 001166   200022 756100                    STQ     @CURR#+5,,AUTO
         6 001167   000002 236000 1                  LDQ     K$
         6 001170   000002 036003                    ADLQ    2,DU
         6 001171   000153 235000 7                  LDA     107
         6 001172   200020 757100                    STAQ    @CURR#+3,,AUTO
         6 001173   000154 237000 7                  LDAQ    108
         6 001174   200016 757100                    STAQ    @CURR#+1,,AUTO
         6 001175   200016 630500                    EPPR0   @CURR#+1,,AUTO
         6 001176   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001177   000000 701000 xent               TSX1    VYD$B2C
         6 001200   000000 011000                    NOP     0

      464    11494
      465    11495              %SCREAM( ERR#=%E$DUMP3_VY, LEVEL=%@E$F_VY, MID="'I'" );

  11496  6 001201   000157 630400 7                  EPPR0   111
         6 001202   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 001203   000000 701000 xent               TSX1    VYE$ERROR
         6 001204   000000 011000                    NOP     0

      466    11498        /*
      467    11499                      Note that above call to VYE$ERROR causes VYE$ERROR to
      468    11500                      to unwind to VYM$MAIN:RESTART
      469    11501        */
      470    11502
      471    11503    2   END DUMP_KEY_BUF;

  11503  6 001205   200014 221300                    LDX1  ! @PREV#,,AUTO
         6 001206   000001 702211                    TSX2  ! 1,X1
      472    11504
      473    11505
      474    11506
      475    11507
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:76   
      476    11508    1   END VYI$READ;

PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:77   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   VY_PSUBS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYI$READ.
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:78   

 **** Variables and constants ****

  ****  Section 001  Data  VYI$READ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w UBIN        r     1 COUNT                      0-0-0/w PTR         r     1 DCB$
     3-0-0/w UBIN        r     1 ERR                        1-0-0/w PTR         r     1 FPT$
     2-0-0/w PTR         r     1 K$                         4-0-0/w UBIN        r     1 KEY_TYPE
     5-0-0/w UBIN        r     1 RTYPE                      6-0-0/w UBIN        r     1 SIZE2
   100-0-0/b BIT         r     1 VYI_ROLLBACK              14-0-0/d STRC(504)   r     1 VY_O_FPT_READ
    50-0-0/d STRC(432)   r     1 VY_O_FPT_WRITE            32-0-0/d STRC(504)   r     1 VY_R_FPT_READ
    64-0-0/d STRC(432)   r     1 VY_R_FPT_WRITE

  ****  Section 002 LblCom BREAK$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 BREAK$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF$                     15-0-0/w PTR         r     1 @CURR#
    13-0-0/w PTR         r     1 @ERR_CODE                  6-0-0/w PTR         r     1 @KEY
    13-0-0/w PTR         r     1 @KEYFORM                  14-0-0/w PTR         r     1 @PREV#
     7-0-0/w PTR         r     1 @P_OVERWRITE               5-0-0/w PTR         r     1 @SIZE
     3-0-0/w PTR         r     1 @TYPE                     *0-0-0/w PTR         r     1 BUF$
    *0-0-0/w UBIN        r     1 CURR#                     *0-0-0/w UBIN        r     1 ERR_CODE
    *0-0-0/w UBIN        r     1 KEY                       *0-0-0/w UBIN        r     1 KEYFORM
    10-0-0/w BIT         r     1 OVERWRITE                 *0-0-0/w UBIN        r     1 PREV#
    *0-0-0/w BIT         r     1 P_OVERWRITE               *0-0-0/w UBIN        r     1 SIZE
    *0-0-0/w UBIN        r     1 TYPE
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:79   

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 M$LF$
     0-0-0/w PTR         r     1 M$OF$                      0-0-0/w PTR         r     1 M$RF$
     0-0-0/w UBIN        r     1 VY_COMMAND                 0-0-0/w STRC(720)   r     1 VY_EFIELD1
     0-0-0/w STRC(720)   r     1 VY_EFIELD2                 0-0-0/w STRC(720)   r     1 VY_EFIELD3
     0-0-0/w SBIN        r     1 VY_IO_SAVEPREV             0-0-0/w SBIN        r     1 VY_IO_SIZEC
     0-0-0/w SBIN        r     1 VY_IO_SIZEW                0-0-0/w SBIN        r     1 VY_IO_STATUS
     0-0-0/w SBIN        r     1 VY_IO_USEPREV              0-0-0/w UBIN        r     1 VY_LAST_UTS
     0-0-0/w UBIN        r     1 VY_LINK_UTS                0-0-0/w STRC(5796)  r     1 VY_OK
     0-0-0/w STRC(4617)  r     1 VY_OL_KEY_BUF              0-0-0/c STRC(1044)  r     1 VY_OU_HEAD
     0-0-0/w STRC(4617)  r     1 VY_O_KEY_BUF               0-0-0/w STRC(4617)  r     1 VY_O_KEY_BUF_L
     0-0-0/c CHAR        r     1 VY_O_KEY_HEAD              0-0-0/c CHAR(5)     r     1 VY_O_KEY_TREE
     0-0-0/w STRC(108)   r     1 VY_R_KEY_BUF               0-0-0/d REMB        r     1 VY_UNWIND

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c STRC(4608)  r     1 C$STRING                   0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(504)   r     1 F$R                        0-0-0/d STRC(432)   r     1 F$W
     0-0-0/w STRC(4617)  r     1 K$B                        0-0-0N  NULL        r     1 M$OF
     0-0-0N  NULL        r     1 M$RF                       0-0-0/w ASTR(9)     r     1 T$C
     0-0-0/c ASTR(9)     r     1 T$C_UNAL
     0-0-0/w UBIN        r     1 VY$WORD_A(0:0)


   Procedure VYI$READ requires 647 words for executable code.
   Procedure VYI$READ requires 20 words of local(AUTO) storage.
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:80   

    No errors detected in file VYI$READ.:E05TSI    .
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:81   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:82   
          MINI XREF LISTING

B$ALT.CODE
      9312**DCL      9312--REDEF    9313--REDEF    9313--REDEF
B$ALT.ERR.ERR#
      9314**DCL      9314--REDEF   11218>>ASSIGN  11248>>IF
B$ALT.EVID
      9313**DCL      9313--REDEF    9313--REDEF
B$TCB.ALT$
      9308**DCL     11218>>ASSIGN  11248>>IF
B$TCB$
      5336**DCL     11218>>ASSIGN  11248>>IF
BAD_O_KEY
     11194**LABEL   11213--GOTO
BREAK$
     10548**DCL     11042<<ASSIGN
BUF$
     10481**DCL         8--PROC    10997>>ASSIGN  11265--ENTRY   11269--ENTRY   11316>>ASSIGN
C$STRING.CHARS
     10611**DCL     11097>>IF
CONTINUE
     11074**LABEL   11230--GOTO
COUNT
     10604**DCL     11109<<ASSIGN  11110>>IF      11136>>IF      11136>>IF      11171>>IF
CURR# IN PROCEDURE REPORT_SEQUENCE_ERROR
     11414**DCL     11410--PROC    11452<>CALL
DCB$
     10545**DCL     10958<<ASSIGN  10961<<ASSIGN  10964<<ASSIGN  11094>>ASSIGN
DUMP_KEY_BUF
     11467**PROC    11405--CALL
ERR
     10581**DCL     11218<<ASSIGN  11219>>IF      11223>>IF      11227>>IF
ERR_CODE IN PROCEDURE REPORT_SEQUENCE_ERROR
     11412**DCL     11410--PROC    11435<>CALL
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:83   
F$DCB.ACTPOS
     10764**DCL     10764--REDEF
F$DCB.ARS#
     10738**DCL     10738--REDEF   11094>>ASSIGN
F$DCB.ATTR
     10757**DCL     10758--REDEF
F$DCB.BORROW
     10772**DCL     10772--REDEF   10772--REDEF   10772--REDEF
F$DCB.DCBNAME.L
     10786**DCL     10786--IMP-SIZ
F$DCB.EOMCHAR#
     10742**DCL     10742--REDEF
F$DCB.FLDID
     10767**DCL     10767--REDEF
F$DCB.FORM$
     10761**DCL     10761--REDEF
F$DCB.FSECT
     10777**DCL     10777--REDEF
F$DCB.FSN#
     10754**DCL     10754--REDEF   10754--REDEF   10755--REDEF
F$DCB.HEADER$
     10760**DCL     10760--REDEF
F$DCB.IXTNSIZE#
     10758**DCL     10758--REDEF
F$DCB.LASTSTA$
     10747**DCL     10747--REDEF
F$DCB.LVL
     10773**DCL     10773--REDEF
F$DCB.NAME#.C
     10748**DCL     10748--REDEF
F$DCB.NOEOF
     10770**DCL     10770--REDEF
F$DCB.NRECS#
     10759**DCL     10759--REDEF
F$DCB.NRECX
     10778**DCL     10778--REDEF
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:84   
F$DCB.OHDR
     10770**DCL     10770--REDEF
F$DCB.ORG#
     10753**DCL     10753--REDEF
F$DCB.PRECNO
     10776**DCL     10776--REDEF
F$DCB.RCSZ
     10782**DCL     10782--REDEF
F$DCB.RES#
     10749**DCL     10749--REDEF
F$DCB.SETX
     10761**DCL     10761--REDEF
F$DCB.TAB$
     10761**DCL     10761--REDEF
F$DCB.TDA
     10775**DCL     10776--REDEF
F$DCB.WSN#
     10749**DCL     10749--REDEF
F$R
     10629**DCL     11071<>CALL
F$R.BUF_.BOUND
     10631**DCL     10996<<ASSIGN
F$R.BUF_.BUF$
     10632**DCL     10997<<ASSIGN
F$R.KEY_
     10629**DCL     11003<<ASSIGN  11006<<ASSIGN  11009<<ASSIGN
F$R.STATION_
     10632**DCL     10633--REDEF
F$R.V.DVBYTE.REREAD#
     10644**DCL     10644--REDEF
F$R.V.INDX#
     10642**DCL     10642--REDEF
F$R.V.KEYR#
     10634**DCL     10998<<ASSIGN
F$R.V.KEYS#
     10634**DCL     11044<<ASSIGN  11049<<ASSIGN  11069<<ASSIGN
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:85   
F$W
     10668**DCL     11366<>CALL
F$W.BUF_.BOUND
     10668**DCL     11315<<ASSIGN
F$W.BUF_.BUF$
     10670**DCL     11316<<ASSIGN
F$W.KEY_
     10668**DCL     11320<<ASSIGN  11322<<ASSIGN  11324<<ASSIGN  11326<<ASSIGN  11359<<ASSIGN
F$W.STATION_
     10670**DCL     10670--REDEF
F$W.V.DVBYTE.VFC#
     10677**DCL     10677--REDEF
F$W.V.NEWKEY#
     10674**DCL     11364<<ASSIGN
F$W.V.ONEWKEY#
     10673**DCL     11361<<ASSIGN  11363<<ASSIGN
FPT$
     10546**DCL     10629--IMP-PTR 10668--IMP-PTR 10957<<ASSIGN  10960<<ASSIGN  10963<<ASSIGN  10996>>ASSIGN
     10997>>ASSIGN  10998>>ASSIGN  11003>>ASSIGN  11006>>ASSIGN  11009>>ASSIGN  11044>>ASSIGN  11049>>ASSIGN
     11069>>ASSIGN  11071>>CALL    11278<<ASSIGN  11280<<ASSIGN  11315>>ASSIGN  11316>>ASSIGN  11320>>ASSIGN
     11322>>ASSIGN  11324>>ASSIGN  11326>>ASSIGN  11359>>ASSIGN  11361>>ASSIGN  11363>>ASSIGN  11364>>ASSIGN
     11366>>CALL
JUMP_SIZE
     11273**LABEL   11268--GOTO
K$
     10547**DCL     10685--IMP-PTR 10710--IMP-PTR 11004<<ASSIGN  11007<<ASSIGN  11010<<ASSIGN  11042>>ASSIGN
     11097>>IF      11101>>ASSIGN  11102>>ASSIGN  11106>>IF      11106>>IF      11108>>IF      11109>>ASSIGN
     11112>>ASSIGN  11122>>IF      11127>>CALL    11133>>ASSIGN  11138>>ASSIGN  11142>>ASSIGN  11143>>ASSIGN
     11144>>ASSIGN  11174>>IF      11179>>CALL    11185>>ASSIGN  11209>>IF      11483>>CALL    11487>>CALL
     11491>>CALL
K$B.FORM0
     10686**DCL     10689--REDEF   10696--REDEF
K$B.FORM0.CHARS
     10688**DCL     11102>>ASSIGN
K$B.FORM0.COUNT
     10687**DCL     11101>>ASSIGN  11109>>ASSIGN  11209>>IF
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:86   
K$B.FORM1.O777
     10691**DCL     11108>>IF
K$B.FORM1.PAGE#
     10694**DCL     11122>>IF      11127<>CALL    11133>>ASSIGN
K$B.FORM1.REC_TYPE
     10693**DCL     11112>>ASSIGN
K$B.FORM2.D10
     10700**DCL     11138>>ASSIGN
K$B.FORM2.OFFSET
     10702**DCL     11143>>ASSIGN
K$B.FORM2.SECT#
     10701**DCL     11142>>ASSIGN
K$B.FORM2.SEQUENCE
     10704**DCL     11174>>IF      11179<>CALL    11185>>ASSIGN
K$B.FORM2.STYPE
     10703**DCL     11144>>ASSIGN
K$R.FORM0
     10711**DCL     10715--REDEF   10721--REDEF
KEY
     10483**DCL         8--PROC    10999>>ASSIGN  11043>>IF      11050>>DOCASE  11265--ENTRY   11269--ENTRY
     11317>>IF      11318>>DOCASE  11339<>CALL
KEYFORM IN PROCEDURE REPORT_INCONSISTENCY
     11372**DCL     11370--PROC    11390<>CALL
KEY_TYPE
     10582**DCL     10999<<ASSIGN  11000>>IF      11000<<ASSIGN  11001>>DOCASE  11023<>CALL
M$LF$
      5754**DCL     10964>>ASSIGN
M$MERC
      1662**DCL-ENT 11235--CALL
M$OF$
      5753**DCL     10958>>ASSIGN
M$READ
      1607**DCL-ENT 11071--CALL
M$RF$
      5753**DCL     10961>>ASSIGN
M$WRITE
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:87   
      1607**DCL-ENT 11366--CALL
MERC_ERROR
     11263**LABEL   11235--CALLALT
OVERWRITE
     10605**DCL     11274<<ASSIGN  11275<<ASSIGN  11361>>IF
POP_OUT
     11242**LABEL   11229--GOTO    11252--GOTO
PREV# IN PROCEDURE REPORT_SEQUENCE_ERROR
     11413**DCL     11410--PROC    11448<>CALL
P_OVERWRITE
     10484**DCL         8--PROC    11194>>IF      11248--IF      11265--ENTRY   11269--ENTRY   11273--IF
     11275>>ASSIGN
READ_ERROR
     11218**LABEL   11071--CALLALT
REPORT_ERROR
     11235**LABEL   11261--GOTO
REPORT_INCONSISTENCY
     11370**PROC    11120--CALL    11140--CALL
REPORT_SEQUENCE_ERROR
     11410**PROC    11127--CALL    11179--CALL
RTYPE
     10583**DCL     11112<<ASSIGN  11113>>IF      11114>>ASSIGN
SIZE
     10482**DCL         8--PROC    10996>>ASSIGN  11265--ENTRY   11267>>ASSIGN  11269--ENTRY   11271>>ASSIGN
SIZE2
     10584**DCL     11267<<ASSIGN  11271<<ASSIGN  11315>>ASSIGN
T$C.CHARS
      9301**DCL     11106>>IF
T$C.COUNT
      9300**DCL      9301--IMP-SIZ 11106>>IF
T$C_UNAL.COUNT
      9303**DCL      9304--IMP-SIZ
TYPE
     10480**DCL         8--PROC    10955>>DOCASE  10977<>CALL    11000>>ASSIGN  11076>>DOCASE  11096>>ASSIGN
     11229>>IF      11258<>CALL    11265--ENTRY   11269--ENTRY   11276>>DOCASE  11297<>CALL
VY$WORD_A
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:88   
      9267**DCL     11483<>CALL    11487<>CALL    11491<>CALL
VYD$B2C
     10455**DCL-ENT 10977--CALL    11023--CALL    11156--CALL    11297--CALL    11339--CALL    11386--CALL
     11390--CALL    11422--CALL    11448--CALL    11452--CALL    11483--CALL    11487--CALL    11491--CALL
VYE$ERRMSG
     10451**DCL-ENT 11256--CALL
VYE$ERROR
     10448**DCL-ENT 10993--CALL    11039--CALL    11063--CALL    11090--CALL    11168--CALL    11204--CALL
     11312--CALL    11354--CALL    11402--CALL    11435--CALL    11461--CALL    11496--CALL
VYE$MERC
     10450**DCL-ENT 11263--CALL
VYI$ERR
     10462**DCL-ENT 11259--CALL
VYI_ROLLBACK
     10953**DCL     11257<<ASSIGN
VYO$DEL_UNIT
     10463**DCL-ENT 11258--CALL
VY_BIAS.A
      5385**DCL      5385--REDEF
VY_CBUF.CHARS_A
      5376**DCL      5376--REDEF
VY_COMMAND
      5376**DCL     11254>>IF      11254>>IF      11257>>IF
VY_EBUF.CHARS_A
      5677**DCL      5678--REDEF
VY_EFIELD1.CHARS
      5678**DCL      5678--REDEF
VY_EFIELD1.CHARS_A
      5678**DCL     10977<>CALL    11023<>CALL    11156<>CALL    11297<>CALL    11339<>CALL    11386<>CALL
     11422<>CALL    11448<>CALL    11483<>CALL
VY_EFIELD2.CHARS
      5679**DCL      5679--REDEF
VY_EFIELD2.CHARS_A
      5679**DCL     11390<>CALL    11452<>CALL    11487<>CALL
VY_EFIELD3.CHARS
      5680**DCL      5680--REDEF
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:89   
VY_EFIELD3.CHARS_A
      5680**DCL     11491<>CALL
VY_ERRORS
      5381**DCL      5383--REDEF
VY_ERRORS.CONFLICT_A
      5382**DCL      5383--REDEF
VY_ERRORS.UNSAT_A
      5381**DCL      5382--REDEF
VY_IMAGE_DATA.CPAGE#_A
      5269**DCL      5270--REDEF
VY_IMAGE_DATA.NODE_A$
      5281**DCL      5282--REDEF
VY_IMAGE_DATA.START_A$
      5273**DCL      5274--REDEF
VY_IMAGE_DATA.STOP_A$
      5277**DCL      5278--REDEF
VY_IMAGE_PROC.CPAGE#_A
      5292**DCL      5293--REDEF
VY_IMAGE_PROC.NODE_A$
      5304**DCL      5305--REDEF
VY_IMAGE_PROC.START_A$
      5296**DCL      5297--REDEF
VY_IMAGE_PROC.STOP_A$
      5300**DCL      5301--REDEF
VY_IMAGE_ROS.CPAGE#_A
      5315**DCL      5316--REDEF
VY_IMAGE_ROS.NODE_A$
      5327**DCL      5328--REDEF
VY_IMAGE_ROS.START_A$
      5319**DCL      5320--REDEF
VY_IMAGE_ROS.STOP_A$
      5323**DCL      5324--REDEF
VY_IO_SAVEPREV
      5684**DCL     11049>>IF      11074>>IF      11075<<ASSIGN  11195<<ASSIGN  11230>>IF      11244<<ASSIGN
VY_IO_SIZEC
      5683**DCL     11094<<ASSIGN  11095>>ASSIGN  11209>>IF      11242<<ASSIGN
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:90   
VY_IO_SIZEW
      5683**DCL     11095<<ASSIGN  11243<<ASSIGN
VY_IO_STATUS
      5683**DCL     11072<<ASSIGN  11220<<ASSIGN  11224<<ASSIGN  11228<<ASSIGN  11251<<ASSIGN  11367<<ASSIGN
VY_IO_USEPREV
      5683**DCL     11045>>IF      11048<<ASSIGN
VY_LAST_UTS
      5700**DCL     11100<<ASSIGN
VY_LINK_UTS
      5379**DCL     11258<>CALL
VY_MAP_HDR.CHARS
      5742**DCL      5743--REDEF    5743--REDEF
VY_MAP_LIT_LO_FPT_WRITE.STATION_
      5071**DCL      5071--REDEF
VY_MAP_LIT_LO_FPT_WRITE.V.DVBYTE.VFC#
      5078**DCL      5078--REDEF
VY_MAP_LO_FPT_WRITE.STATION_
      5040**DCL      5040--REDEF
VY_MAP_LO_FPT_WRITE.V.DVBYTE.VFC#
      5047**DCL      5047--REDEF
VY_MBUF.CHARS
      5741**DCL      5742--REDEF    5742--REDEF
VY_M_VECTOR.F
      5110**DCL      5114--REDEF
VY_M_VECTOR_DP.F
      5145**DCL      5149--REDEF
VY_O.DUPL_ATTCH
      5523**DCL      5527--REDEF
VY_O.MAP_ATTCH
      5511**DCL      5522--REDEF
VY_O.PRIMARY_OPTION
      5505**DCL      5510--REDEF
VY_O.SEV_ATTCH
      5528**DCL      5530--REDEF
VY_OD.DUPL_ATTCH
      5667**DCL      5671--REDEF
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:91   
VY_OD.MAP_ATTCH
      5655**DCL      5666--REDEF
VY_OD.PRIMARY_OPTION
      5649**DCL      5654--REDEF
VY_OD.SEV_ATTCH
      5672**DCL      5674--REDEF
VY_OK.KFILE
      5245**DCL     11096<<ASSIGN  11209>>IF
VY_OK.KOFSET
      5249**DCL     11143<<ASSIGN
VY_OK.KPAGE#
      5248**DCL     11113<<ASSIGN  11121>>IF      11122>>IF      11127<>CALL    11133<<ASSIGN
VY_OK.KRTYPE
      5247**DCL     11113>>IF      11114<<ASSIGN  11115>>IF      11115>>IF      11115>>IF      11138<<ASSIGN
     11139>>IF      11386<>CALL    11422<>CALL
VY_OK.KSECT#
      5252**DCL     11142<<ASSIGN
VY_OK.KSEQUENCE
      5251**DCL     11171<<ASSIGN  11173>>IF      11174>>IF      11179<>CALL    11185<<ASSIGN
VY_OK.KSTYPE
      5250**DCL     11144<<ASSIGN  11145>>IF      11156<>CALL
VY_OK.KTYPE
      5246**DCL     11099<<ASSIGN  11106<<ASSIGN  11111<<ASSIGN  11137<<ASSIGN  11196<<ASSIGN  11212<<ASSIGN
     11245<<ASSIGN
VY_OK.OUNAME.CHARS
      5258**DCL     11102<<ASSIGN
VY_OK.OUNAME.COUNT
      5257**DCL     11101<<ASSIGN  11102>>ASSIGN
VY_OL_KEY_BUF
      5177**DCL     11326--ASSIGN
VY_OL_KEY_BUF.FORM0
      5178**DCL      5181--REDEF    5188--REDEF
VY_OU_HEAD.REC_A
      5366**DCL      5367--REDEF
VY_OU_HEAD.UTS
      5364**DCL     11100>>ASSIGN
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:92   
VY_O_FPT_READ
     10810**DCL     10957--ASSIGN  10963--ASSIGN
VY_O_FPT_READ.STATION_
     10813**DCL     10814--REDEF
VY_O_FPT_READ.V
     10814**DCL     10810--DCLINIT
VY_O_FPT_READ.V.DVBYTE.REREAD#
     10825**DCL     10825--REDEF
VY_O_FPT_READ.V.INDX#
     10823**DCL     10823--REDEF
VY_O_FPT_WRITE
     10897**DCL     11278--ASSIGN
VY_O_FPT_WRITE.STATION_
     10899**DCL     10899--REDEF
VY_O_FPT_WRITE.V
     10900**DCL     10897--DCLINIT
VY_O_FPT_WRITE.V.DVBYTE.VFC#
     10906**DCL     10906--REDEF
VY_O_KEY_BUF
      5154**DCL     10810--DCLINIT 10811--DCLINIT 10897--DCLINIT 11003--ASSIGN  11004--ASSIGN  11009--ASSIGN
     11010--ASSIGN  11052<<ASSIGN  11320--ASSIGN  11324--ASSIGN
VY_O_KEY_BUF.FORM0
      5155**DCL      5158--REDEF    5165--REDEF
VY_O_KEY_BUF.FORM0.CHARS
      5157**DCL     11079>>ASSIGN
VY_O_KEY_BUF.FORM0.COUNT
      5156**DCL     11078>>ASSIGN
VY_O_KEY_BUF_L
      5200**DCL     11052>>ASSIGN
VY_O_KEY_BUF_L.FORM0
      5201**DCL      5204--REDEF    5211--REDEF
VY_O_KEY_BUF_L.FORM0.CHARS
      5203**DCL     11079<<ASSIGN
VY_O_KEY_BUF_L.FORM0.COUNT
      5202**DCL     11078<<ASSIGN
VY_O_KEY_HEAD
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:93   
      5685**DCL     11097>>IF
VY_O_KEY_TREE
      5685**DCL     11106>>IF
VY_PAR_UNWIND
      5736**DCL      5736--REDEF
VY_PASS2_REF.OU.L_START
      5703**DCL      5704--REDEF
VY_PASS2_REF.OU.L_STOP
      5704**DCL      5705--REDEF
VY_PASS2_REF.OU.MAX
      5702**DCL      5703--REDEF
VY_PASS2_REF.OU.SIZE
      5705**DCL      5706--REDEF
VY_PASS2_REF.SAT.COUNT
      5709**DCL      5710--REDEF
VY_PASS2_REF.SAT.ENT_SIZE
      5711**DCL      5712--REDEF
VY_PASS2_REF.SAT.L_START
      5707**DCL      5708--REDEF
VY_PASS2_REF.SAT.L_STOP
      5708**DCL      5709--REDEF
VY_PASS2_REF.SAT.MAX
      5706**DCL      5707--REDEF
VY_PASS2_REF.UNSAT.L_START
      5713**DCL      5714--REDEF
VY_PASS2_REF.UNSAT.L_STOP
      5714**DCL      5715--REDEF
VY_PASS2_REF.UNSAT.L_WHERE
      5715**DCL      5716--REDEF
VY_PASS2_REF.UNSAT.MAX
      5712**DCL      5713--REDEF
VY_PASS2_REF.UNSAT.PAGE#
      5717**DCL      5718--REDEF
VY_PASS2_REF.UNSAT.SIZE
      5716**DCL      5717--REDEF
VY_PROGRAM_BIAS.A
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:94   
      5384**DCL      5384--REDEF
VY_RU_HEAD.DATA_SEGMENT
      5352**DCL      5352--REDEF
VY_RU_HEAD.L
      5348**DCL      5349--REDEF
VY_RU_HEAD.MAP_BITS
      5349**DCL      5351--REDEF
VY_RU_HEAD.PBIT
      5345**DCL      5345--REDEF
VY_RU_HEAD_BUF.DATA_SEGMENT
      5362**DCL      5362--REDEF
VY_RU_HEAD_BUF.L
      5357**DCL      5358--REDEF
VY_RU_HEAD_BUF.MAP_BITS
      5359**DCL      5361--REDEF
VY_RU_HEAD_BUF.PBIT
      5354**DCL      5355--REDEF
VY_R_FPT_READ
     10855**DCL     10960--ASSIGN
VY_R_FPT_READ.STATION_
     10858**DCL     10859--REDEF
VY_R_FPT_READ.V
     10859**DCL     10855--DCLINIT
VY_R_FPT_READ.V.DVBYTE.REREAD#
     10870**DCL     10870--REDEF
VY_R_FPT_READ.V.INDX#
     10868**DCL     10868--REDEF
VY_R_FPT_WRITE
     10931**DCL     11280--ASSIGN
VY_R_FPT_WRITE.STATION_
     10933**DCL     10933--REDEF
VY_R_FPT_WRITE.V
     10934**DCL     10931--DCLINIT
VY_R_FPT_WRITE.V.DVBYTE.VFC#
     10940**DCL     10940--REDEF
VY_R_KEY_BUF
PL6.E3A0      #001=VYI$READ File=VYI$READ.:E05TSI                                WED 07/30/97 08:55 Page:95   
      5223**DCL     10855--DCLINIT 10856--DCLINIT 10931--DCLINIT 11006--ASSIGN  11007--ASSIGN  11322--ASSIGN
VY_R_KEY_BUF.FORM0
      5224**DCL      5228--REDEF    5234--REDEF
VY_SI_KEY_BUF.KEY
      5732**DCL      5732--REDEF
VY_SPC.B$.MINE
      5727**DCL      5728--REDEF
VY_SPC.B$.NAME
      5724**DCL      5724--REDEF
VY_SPC.B$.SKIP
      5726**DCL      5727--REDEF
VY_SPC.B$.VALUE
      5725**DCL      5726--REDEF
VY_SPC.SEG.NAME
      5719**DCL      5720--REDEF
VY_SPC.SEG.VALUE
      5720**DCL      5721--REDEF
VY_TSX0_OVERLAY.H
      5691**DCL      5692--REDEF
VY_UNWIND
      5736**DCL     11237>>UNWIND
WRITE_ERROR
     11248**LABEL   11366--CALLALT
