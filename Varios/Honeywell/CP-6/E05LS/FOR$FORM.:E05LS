VERSION E05

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:1    
        1        1        /*M* FOR$FORM Output symbiont device FORM routines for OUTSYM */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         FOR$FORM
       10       10             PURPOSE:      To handle device FORMs for OUTSYM
       11       11             DESCRIPTION:  Contains various routines. */
       12       12        /**/
       13       13        FOR$FORM: PROC (FORMNAME,WSN,KEYIN$) ALTRET;
       14       14        /**/
       15       15
       16       16
       17       17
       18       18        /**/
       19       19        /* PARAMETERS */
       20       20        /**/
       21       21    1   DCL FORMNAME CHAR(6) UNAL;
       22       22    1   DCL WSN CHAR(8) ALIGNED;
       23       23    1   DCL 1 ALSTAT REDEF WSN ALIGNED,
       24       24    1         2 STAT UBIN WORD UNAL,
       25       25    1         2 ERRC UBIN WORD UNAL;
       26       26    1   DCL KEYIN$ PTR ALIGNED;
       27       27
       28       28
       29       29
       30       30        /**/
       31       31        /* INCLUDES */
       32       32        /**/
       33       33        %INCLUDE CP_6;
       34      114        %INCLUDE FS$FIT;
       35      157        %INCLUDE KC_ERRORS_C;
       36      204        %INCLUDE FO_ERRORS_C;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:2    
       37      236        %INCLUDE F_ERRORS_C;
       38      476        %INCLUDE FR_ERRORS_C;
       39      507        %INCLUDE OC_SUBS_C;
       40     1238        %INCLUDE OC_MESSHD_C;
       41     1291        %INCLUDE FOM_SUBS_C;
       42     1354        %INCLUDE FOO_SUBS_C;
       43     1590        %INCLUDE FOO_MAC_C;
       44     2338        %INCLUDE FOO_DATA_R;
       45     3504        %INCLUDE FO_SCODE_C;
       46     3532        %INCLUDE FS_SUPER_C;
       47     4295        %INCLUDE CP_6_SUBS;
       48     4835        %INCLUDE F$DCB;
       49     4884        %INCLUDE NK_VFC_C;
       50     4958
       51     4959
       52     4960
       53     4961        /**/
       54     4962        /* BASED STRUCTURES */
       55     4963        /**/
       56     4964        %B$TCB;
       57     4967        %B$ALT;
       58     4975        %FS$SET_INIT (NAME=FS$SETUP,STCLASS=BASED);
       59     4993        %FS$BAN_INIT (NAME=FS$FINST,STCLASS=BASED);
       60     5050        %FS$FORMREC (NAME=FS$FORM,STCLASS=BASED);
       61     5121        %FS$WRSP (NAME=FS$WRSP,STCLASS=BASED);
       62     5139        %FS$GWRSP (NAME=FS$GWRSP,STCLASS=BASED);
       63     5163        %FS$WORKAUTO (NAME=FS$WORKAUTO,STCLASS=BASED);
       64     5182    1   DCL B$$FORMR (0:2047) UBIN WORD BASED ALIGNED;
       65     5183    1   DCL B$$ALREC CHAR(256) BASED UNAL;
       66     5184
       67     5185
       68     5186
       69     5187        /**/
       70     5188        /* AUTO */
       71     5189        /**/
       72     5190    1   DCL ALIGN$ PTR;
       73     5191    1   DCL I UBIN WORD;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:3    
       74     5192    1   DCL IR REDEF I SBIN;
       75     5193    1   DCL FORM$ PTR;
       76     5194    1   DCL START_GRAFBAN BIT(1);
       77     5195    1   DCL ERRC UBIN WORD;
       78     5196    1   DCL WRSP$ PTR;
       79     5197    1   DCL FINST$ PTR;
       80     5198        %FO_GPARM (FPTN=GPARM,STCLASS=AUTO);
       81     5220    1   DCL KSUBC UBIN WORD;
       82     5221    1   DCL SETUP$ PTR;
       83     5222    1   DCL FS_WORKAREA$ PTR;
       84     5223
       85     5224
       86     5225
       87     5226        /**/
       88     5227        /* STATIC */
       89     5228        /**/
       90     5229    1   DCL 1 FORMKEY STATIC DALIGNED,
       91     5230    1         2 * UBIN BYTE UNAL INIT(6),
       92     5231    1         2 NAME CHAR(6) UNAL;
       93     5232    1   DCL DEVNAME CHAR(8) STATIC DALIGNED;
       94     5233    1   DCL FORMNM CHAR(6) STATIC DALIGNED;
       95     5234        %OC_MESSHD_D            (NAME=OPMSG_MERR,
       96     5235                 NPARMS    = 4,
       97     5236                 MSG       = FO_MERR_MSG#,
       98     5237                 ATR       = M_UR,
       99     5238                 STCLASS   = STATIC);
      100     5251    1         2 * UBIN BYTE UNAL INIT(1),
      101     5252    1         2 * UBIN BYTE UNAL INIT(8),
      102     5253    1         2 * UBIN BYTE UNAL INIT(2),
      103     5254    1         2 * UBIN BYTE UNAL INIT(1),
      104     5255    1         2 SUBC UBIN BYTE UNAL,
      105     5256    1         2 FORM CHAR(8) UNAL,
      106     5257    1         2 ERRC UBIN HALF UNAL,
      107     5258    1         2 CONNECT UBIN BYTE UNAL;
      108     5259        %OC_MESSHD_D            (NAME=OPMSG_FORM,
      109     5260                 NPARMS    = 3,
      110     5261                 MSG       = FO_RESP_MSG#,
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:4    
      111     5262                 ATR       = M_UR,
      112     5263                 STCLASS   = STATIC);
      113     5276    1         2 * UBIN BYTE UNAL INIT(1),
      114     5277    1         2 * UBIN BYTE UNAL INIT(8),
      115     5278    1         2 * UBIN BYTE UNAL INIT(72),
      116     5279    1         2 SUBC UBIN BYTE UNAL,
      117     5280    1         2 FORM CHAR(8) UNAL,
      118     5281    1         2 SETUP CHAR(72) UNAL;
      119     5282
      120     5283
      121     5284
      122     5285        /**/
      123     5286        /* DCBS */
      124     5287        /**/
      125     5288    1   DCL M$FORM DCB;
      126     5289    1   DCL M$CSCG DCB;
      127     5290    1   DCL M$OSYMB DCB;
      128     5291    1   DCL M$OSCG DCB;
      129     5292
      130     5293
      131     5294
      132     5295        /**/
      133     5296        /* REFS */
      134     5297        /**/
      135     5298    1   DCL B$TCB$ PTR SYMREF;
      136     5299    1   DCL FOG$ADD       ENTRY(1) ALTRET;
      137     5300    1   DCL FOG$BLD       ENTRY(1) ALTRET;
      138     5301    1   DCL FOG$GRAN      ENTRY(1) ALTRET;
      139     5302    1   DCL FOI$CRASHGO   ENTRY(3) ALTRET;
      140     5303    1   DCL FOT$DCHK      ENTRY(2) ALTRET;
      141     5304    1   DCL FOT$TCHK      ENTRY(2) ALTRET;
      142     5305    1   DCL FSK$BANNER    ENTRY(4) ALTRET;
      143     5306    1   DCL FSK$GBANNER   ENTRY(4) ALTRET;
      144     5307
      145     5308
      146     5309
      147     5310        /**/
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:5    
      148     5311        /* PMME FPTS */
      149     5312        /**/
      150     5313        %FPT_OPEN                              (FPTN=OPEN_FORM,
      151     5314                 STCLASS   = CONSTANT,
      152     5315                 DCB       = M$FORM,
      153     5316                 NAME      = FORMFILE,
      154     5317                 ACCT      = SYSACCT,
      155     5318                 ASN       = FILE,
      156     5319                 FUN       = IN,
      157     5320                 SHARE     = ALL,
      158     5321                 SCRUB     = YES);
      159     5430        %VLP_NAME                              (FPTN=FORMFILE,
      160     5431                 NAME      = ':FORM',
      161     5432                 STCLASS   = CONSTANT);
      162     5459        %VLP_ACCT                              (FPTN=SYSACCT,
      163     5460                 ACCT      = ':SYS',
      164     5461                 STCLASS   = CONSTANT);
      165     5474        %FPT_CLOSE                             (FPTN=CLOSE_FORM,
      166     5475                 DCB       = M$FORM,
      167     5476                 STCLASS   = CONSTANT,
      168     5477                 DISP      = SAVE);
      169     5519        %FPT_READ                              (FPTN=READ_FORM,
      170     5520                 STCLASS   = STATIC,
      171     5521                 DCB       = M$FORM,
      172     5522                 KEYS      = YES,
      173     5523                 KEYR      = NO,
      174     5524                 KEY       = FORMKEY);
      175     5563        %FPT_WRITE                             (FPTN=OCMSG_FORM,
      176     5564                 STCLASS=CONSTANT,
      177     5565                 DCB=M$CSCG,
      178     5566                 BUF=OPMSG_FORM);
      179     5597        %FPT_WRITE                             (FPTN=OCMSG_MERR,
      180     5598                 STCLASS=CONSTANT,
      181     5599                 DCB=M$CSCG,
      182     5600                 BUF=OPMSG_MERR);
      183     5631        %FPT_SYMBIO                            (FPTN=FMNT_SYMB,
      184     5632                 DCB       = M$OSCG,
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:6    
      185     5633                 STCLASS   = CONSTANT,
      186     5634                 FORM      = FORMNM,
      187     5635                 STATION   = DEVNAME,
      188     5636                 ORDER     = FOMO_FMNT#);
      189     5660        %FPT_TRUNC                            (FPTN=TRUNC_OSYMB,
      190     5661                 DCB       = M$OSYMB,
      191     5662                 STCLASS   = CONSTANT);
      192     5676        %FPT_TRUNC                            (FPTN=TRUNC_FORM,
      193     5677                 DCB       = M$FORM,
      194     5678                 STCLASS   = CONSTANT);
      195     5692        %FPT_WRITE                             (FPTN=WRITE_OSYMB,
      196     5693                 STCLASS   = STATIC,
      197     5694                 DCB       = M$OSYMB,
      198     5695                 KEY       = FO_OSYMBKEY,
      199     5696                 BUF       = FO_OSYMBUF,
      200     5697                 ONEWKEY   = YES);
      201     5728        %FPT_READ                             (FPTN=READ_OSYMB,
      202     5729                 STCLASS   = CONSTANT,
      203     5730                 DCB       = M$OSYMB,
      204     5731                 KEY       = FO_OSYMBKEY,
      205     5732                 KEYS      = YES,
      206     5733                 BUF       = FO_OSYMBUF,
      207     5734                 KEYR      = NO);
      208     5773        %FPT_WAIT                              (FPTN=SLEEP1,
      209     5774                 STCLASS=CONSTANT,
      210     5775                 UNITS=1);
      211     5789        %VLP_TAB                               (FPTN=ZERO_TABS,
      212     5790                 MARGIN=1,
      213     5791                 STCLASS=STATIC);
      214     5805
      215     5806        %NK$VFC (NAME=TABVFC,
      216     5807                 STCLASS=CONSTANT,
      217     5808                 IFCN=%VFCF_SPC,
      218     5809                 ICOUNT=%VFCS_OTAB);
      219     5827
      220     5828
      221     5829
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:7    
      222     5830        /**/
      223     5831        /* SUBS */
      224     5832        /**/
      225     5833        %SUB FIL$=FO_FIL$;
      226     5834        %SUB DEV$=FO_DEV$;
      227     5835        %SUB JOB$=FO_JOB$;
      228     5836        %SUB F_FO='0617'O;
      229     5837        %SUB M_R='22'O;
      230     5838        %SUB B$ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      231     5839        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:8    
      232     5840        /**/
      233     5841        /*F* NAME:         FOR$KEYIN
      234     5842             PURPOSE:      To process FORM keyins in OUTSYM.
      235     5843             DESCRIPTION:  If the keyin is particular to a device,
      236     5844                           then FO_DEV$ points to the device if it
      237     5845                           is symbiont, and is ADDR(NIL) else. */
      238     5846        /**/
      239     5847    1   FOR$KEYIN: ENTRY (FORMNAME,WSN,KEYIN$) ALTRET;
      240     5848
      241     5849                                /* ONLY KEYIN$ IS PASSED */
      242     5850    1         OPMSG_MERR.CONNECT=0;
      243     5851    1         OPMSG_MERR.DEVNM=KEYIN$->FO$DKEYIN.DEVNM;
      244     5852    1         OPMSG_MERR.CADDR=KEYIN$->FO$DKEYIN.CADDR;
      245     5853    1         OPMSG_MERR.FORM=KEYIN$->FO$DKEYIN.FORM;
      246     5854    1         FORMKEY.NAME=KEYIN$->FO$DKEYIN.FORM;
      247     5855    1         OPMSG_FORM.DEVNM=KEYIN$->FO$DKEYIN.DEVNM;
      248     5856    1         OPMSG_FORM.CADDR=KEYIN$->FO$DKEYIN.CADDR;
      249     5857    1         OPMSG_FORM.FORM=KEYIN$->FO$DKEYIN.FORM;
      250     5858    1         CALL READREC ALTRET(NOFORM);
      251     5859
      252     5860    2           DO CASE (KEYIN$->FO$DKEYIN.KIN#);
      253     5861
      254     5862        /**
      255     5863         **
      256     5864         **      SETUP KEYIN
      257     5865         **
      258     5866         **/
      259     5867
      260     5868    2             CASE (KEY_SETUP#);
      261     5869
      262     5870    2               OPMSG_FORM.SUBC=FOKR_SETUP#;
      263     5871    2               IF FORM$->FS$FORM.SETUPDISP = 0 THEN
      264     5872    3                 DO;
      265     5873    3                 OPMSG_MERR.SUBC=FOKE_NSTUP#;
      266     5874    3                 GOTO MERR;
      267     5875    3                 END;
      268     5876    2               SETUP$=PINCRW(FORM$,FORM$->FS$FORM.SETUPDISP);
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:9    
      269     5877    3                 DO IR = 0 TO SETUP$->FS$SETUP.LINES-1;
      270     5878    3                 OPMSG_FORM.SETUP=SETUP$->FS$SETUP.TXT(I);
      271     5879    3                 CALL M$WRITE (OCMSG_FORM);
      272     5880    3                 END;
      273     5881
      274     5882        /**
      275     5883         **
      276     5884         **      FORM KEYIN
      277     5885         **
      278     5886         **/
      279     5887
      280     5888    2             CASE (KEY_FORM#);
      281     5889
      282     5890    2               DEVNAME=KEYIN$->FO$DKEYIN.DEVNM;
      283     5891    2               IF DEV$ ~= ADDR(NIL) THEN
      284     5892    2                IF DEV$->FO$DEV.STATE ~= FOS_IDLE# THEN
      285     5893    3                  DO;
      286     5894    3                  OPMSG_MERR.SUBC=FOKE_DBUSY#;
      287     5895    3                  CALL M$WRITE (OCMSG_MERR);
      288     5896    3                  RETURN;
      289     5897    3                  END;
      290     5898    2               CALL MOUNT ALTRET(MERR);
      291     5899    2               IF DEV$ ~= ADDR(NIL) THEN
      292     5900    2                IF FORM$ -> FS$FORM.GRAPHIC
      293     5901    2                THEN
      294     5902    2                 DEV$ -> FO$DEV.FLG.MODE = FOMD_GRAPHIC#;
      295     5903    2                ELSE
      296     5904    2                 DEV$ -> FO$DEV.FLG.MODE = FOMD_NONGRAPHIC#;
      297     5905    2               OPMSG_FORM.CADDR=M_UR;
      298     5906    2               OPMSG_FORM.SUBC=FOKR_FORM#;
      299     5907    2               CALL M$WRITE (OCMSG_FORM);
      300     5908    2               RETURN;
      301     5909    2   NOFORM:     ;
      302     5910    2               IF B$ERRCODE = %E$NOKEY THEN
      303     5911    2                OPMSG_MERR.SUBC=FOKE_NFORM#;
      304     5912    2               ELSE
      305     5913    3                 DO;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:10   
      306     5914    3                 OPMSG_MERR.SUBC=FOKE_FFERR#;
      307     5915    3                 OPMSG_MERR.ERRC=B$ERRCODE;
      308     5916    3                 END;
      309     5917    2   MERR:       ;
      310     5918    2               CALL M$WRITE (OCMSG_MERR);
      311     5919    2               ALTRETURN;
      312     5920
      313     5921        /* END OF KEYIN TYPE DOCASE */
      314     5922    2           END;
      315     5923    1         RETURN;
      316     5924        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:11   
      317     5925
      318     5926    1   FOR$GETMODE: ENTRY (FORMNAME) ALTRET;
      319     5927        /**/
      320     5928        /*F* NAME:       FOR$GETMODE
      321     5929             PURPOSE:    To aquire the mode of the symbiont device from
      322     5930                         the form mounted on it. */
      323     5931        /**/
      324     5932
      325     5933    1         OPMSG_MERR.DEVNM = DEV$ -> FO$DEV.NAME;
      326     5934    1         OPMSG_MERR.CADDR = M_UR;
      327     5935    1         OPMSG_MERR.CONNECT = 1;
      328     5936    1         OPMSG_MERR.FORM = DEV$ -> FO$DEV.FORM;
      329     5937    1         FORMKEY.NAME = DEV$ -> FO$DEV.FORM;
      330     5938
      331     5939    1         CALL READREC ALTRET (NOFORM);
      332     5940
      333     5941    1         IF FORM$ -> FS$FORM.GRAPHIC
      334     5942    2         THEN DO;
      335     5943    2           DEV$ -> FO$DEV.FLG.MODE = FOMD_GRAPHIC#;
      336     5944    2           END;
      337     5945    2         ELSE DO;
      338     5946    2           DEV$ -> FO$DEV.FLG.MODE = FOMD_NONGRAPHIC#;
      339     5947    2           END;
      340     5948
      341     5949    1         RETURN;
      342     5950        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:12   
      343     5951        /**/
      344     5952        /*F* NAME:         FOR$MOUNT
      345     5953             PURPOSE:      To mount a form on a symbiont device when
      346     5954                           it connects with a form. */
      347     5955        /**/
      348     5956    1   FOR$MOUNT: ENTRY ALTRET;
      349     5957
      350     5958    1         OPMSG_MERR.DEVNM=DEV$->FO$DEV.NAME;
      351     5959    1         OPMSG_MERR.CADDR=M_UR; /* SEND MESSAGE TO EVERYBODY */
      352     5960    1         OPMSG_MERR.CONNECT=1;
      353     5961    1         OPMSG_MERR.FORM=DEV$->FO$DEV.FORM;
      354     5962    1         FORMKEY.NAME=DEV$->FO$DEV.FORM;
      355     5963    1         DEVNAME=DEV$->FO$DEV.NAME;
      356     5964                                      /* Read :FORM with key in FORMKEY */
      357     5965    1         CALL READREC ALTRET(MOUNT1);
      358     5966                                      /* Call M$SYMBIO, write to :OSYMB, set
      359     5967                                         AEF (Align at End of File flag) */
      360     5968    1         CALL MOUNT ALTRET(MERR);
      361     5969    1         RETURN;
      362     5970    1   MOUNT1:;
      363     5971    1         IF DEV$->FO$DEV.FORM = 'STDLP' THEN RETURN;
      364     5972    1         DEV$->FO$DEV.FORM=' ';
      365     5973    1         GOTO NOFORM;
      366     5974
      367     5975
      368     5976        /*D* NAME:         MOUNT
      369     5977             PURPOSE:      To mount a form on a device
      370     5978             DESCRIPTION:  FORMKEY.NAME is the form name.
      371     5979                           DEVNAME is the device name.
      372     5980                           FORM$ points to the form record.
      373     5981                           The form is mounted with an M$SYMBIO FMNT PMME,
      374     5982                           and the appropriate message set up if an error
      375     5983                           occurs.  If the form gets mounted and DEV$ is
      376     5984                           not ADDR(NIL), the correct goodies get shoved
      377     5985                           into the OUTSYM device table entry. */
      378     5986    1   MOUNT: PROC ALTRET;
      379     5987
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:13   
      380     5988                                /* CHECK FORM LEGAL FOR THIS DEV TYPE */
      381     5989    2         CALL FOT$DCHK (FORM$->FS$FORM,DEVNAME) ALTRET(BADFTYP);
      382     5990    2         FORMNM=FORMKEY.NAME;
      383     5991                                      /* Non-MOOS pmme. Partitioned devices
      384     5992                                         are removed from OSCG, so we write
      385     5993                                         records to remember them (in case
      386     5994                                         they reconnect). In OUTSYM, we deal
      387     5995                                         with devices whether or not we
      388     5996                                         control them */
      389     5997    2         CALL M$SYMBIO (FMNT_SYMB) ALTRET(NOMOUNT);
      390     5998    2         IF DEV$ = ADDR(NIL) THEN
      391     5999    3           DO; /* To remember form changes while it's partitioned */
      392     6000    3           FO_OSYMBKEY.NAME=DEVNAME;
      393     6001    3           CALL M$READ (READ_OSYMB) ALTRET(NOWRDEV);
      394     6002    3           FO_OSYMBUF.FO_OSYMBDEV.FORM=FORMNM;
      395     6003                                      /* Write device table entry to :OSYMB
      396     6004                                         in :SYS */
      397     6005    3           CALL WRITE_DEV1;
      398     6006    3   NOWRDEV:;
      399     6007    3           END;
      400     6008    2         ELSE
      401     6009    3           DO;
      402     6010    3           DEV$->FO$DEV.FORM=FORMNM;
      403     6011                                      /* Write :OSYMB.:SYS record */
      404     6012    3           CALL WRITE_DEV (DEV$);
      405     6013    3           DEV$->FO$DEV.FLEN=FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LENGTH;
      406     6014    3           DEV$->FO$DEV.FLG.ALGNED='0'B;
      407     6015    3           I=FORM$->FS$FORM.ALGNDISP;
      408     6016    3           IF I = 0 THEN DEV$->FO$DEV.FLG.AEF='0'B;
      409     6017    3           ELSE
      410     6018    4             DO;
      411     6019                                      /* Else handle Align Every File */
      412     6020    4             ALIGN$=PINCRW(FORM$,I);
      413     6021    4             DEV$->FO$DEV.FLG.AEF=ALIGN$->FS$FINST.ALIGNCTL.EVERY;
      414     6022    4             END;
      415     6023    3           END;
      416     6024    2         RETURN;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:14   
      417     6025    2   NOMOUNT: ;
      418     6026    2         IF DEV$ ~= ADDR(NIL) THEN DEV$->FO$DEV.FORM=' ';
      419     6027    2         I=B$ERRCODE;
      420     6028    2         IF I = %E$NOSTA THEN KSUBC=FOKE_NODEV#;
      421     6029    2         ELSE IF I = %E$REOPN THEN KSUBC=FOKE_DBUSY#;
      422     6030    2          ELSE IF I = %E$UPNLDT THEN KSUBC=FOKE_DPART#;
      423     6031    2           ELSE IF I = %E$NOTUR THEN KSUBC=FOKE_SILLY#;
      424     6032    2            ELSE
      425     6033    3              DO;
      426     6034    3              KSUBC=FOKE_BFALT#;
      427     6035    3              OPMSG_MERR.ERRC=I;
      428     6036    3              END;
      429     6037    2         OPMSG_MERR.SUBC=KSUBC;
      430     6038    2         ALTRETURN;
      431     6039    2   BADFTYP: ;
      432     6040    2         OPMSG_MERR.SUBC=FOKE_BFTYP#;
      433     6041    2         ALTRETURN;
      434     6042    2   END MOUNT;
      435     6043        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:15   
      436     6044        /**/
      437     6045        /*F* NAME:         FOR$DEVWR
      438     6046             PURPOSE:      To write a device table entry to :OSYMB
      439     6047             DESCRIPTION:  The device table entry pointed to by FO_DEV$
      440     6048                           is written to :OSYMB.:SYS with the device
      441     6049                           name as the key, if it is a local device. */
      442     6050        /**/
      443     6051    1   FOR$DEVWR: ENTRY ALTRET;
      444     6052
      445     6053    1         CALL WRITE_DEV (DEV$) ALTRET(ALTRT);
      446     6054    1         RETURN;
      447     6055
      448     6056    1   WRITE_DEV: PROC (DEV$) ALTRET;
      449     6057        /**/
      450     6058    2   DCL DEV$ PTR;
      451     6059    2   DCL WSN$ PTR;
      452     6060    2   DCL OSYMB$ PTR;
      453     6061        %FO_DEV (FPTN=DEV,STCLASS=BASED);
      454     6160        %FO_WSN (FPTN=FO$WSN,STCLASS=BASED);
      455     6198        /**/
      456     6199
      457     6200    2         IF DEV$ -> DEV.FLG.LOCAL THEN
      458     6201    3           DO;
      459     6202    3           FO_OSYMBKEY.NAME=DEV$ -> DEV.NAME;
      460     6203    3           FO_OSYMBUF.FO_OSYMBDEV=DEV$ -> DEV;
      461     6204    3           WSN$ = DEV$ -> FO$DEV.WSN$;
      462     6205    3           FO_OSYMBUF.FO_OSYMBWSN.NWSNS = 0;
      463     6206    4             DO WHILE (WSN$ ~= ADDR(NIL));
      464     6207    5               DO I = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);
      465     6208    5               FO_OSYMBUF.FO_OSYMBWSN.WSN (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      466     6209    5               = WSN$ -> FO$WSN.WSN (I);
      467     6210    5               FO_OSYMBUF.FO_OSYMBWSN.NWSNS = FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1;
      468     6211    5               END;
      469     6212    4             WSN$ = WSN$ -> FO$WSN.LNK$;
      470     6213    4             END;
      471     6214    3           WRITE_OSYMB.BUF_.BOUND = LENGTHC (DEV)
      472     6215    3           + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:16   
      473     6216    3           + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      474     6217    3           + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      475     6218    3           CALL M$WRITE (WRITE_OSYMB) ALTRET(ALTRT);
      476     6219    3           CALL M$TRUNC (TRUNC_OSYMB) ALTRET(RTN);
      477     6220    3           END;
      478     6221    2   RTN:  ;
      479     6222    2         RETURN;
      480     6223    2   ALTRT:;
      481     6224    2         ALTRETURN;
      482     6225    2   END WRITE_DEV;
      483     6226        /**/
      484     6227    1   WRITE_DEV1: PROC ALTRET;
      485     6228
      486     6229    2   DCL WSN$ PTR;
      487     6230    2   DCL OSYMB$ PTR;
      488     6231        %FO_DEV (FPTN=DEV,STCLASS=BASED);
      489     6330        %FO_WSN (FPTN=FO$WSN,STCLASS=BASED);
      490     6368
      491     6369    2         IF FO_OSYMBUF.FO_OSYMBDEV.FLG.LOCAL
      492     6370    3         THEN DO;
      493     6371    3           FO_OSYMBKEY.NAME = FO_OSYMBUF.FO_OSYMBDEV.NAME;
      494     6372    3           WRITE_OSYMB.BUF_.BOUND = LENGTHC (DEV)
      495     6373    3           + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      496     6374    3           + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      497     6375    3           + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      498     6376    3           CALL M$WRITE (WRITE_OSYMB) ALTRET (ALTRT1);
      499     6377    3           CALL M$TRUNC (TRUNC_OSYMB) ALTRET (RTN1);
      500     6378    3           END;
      501     6379    2   RTN1: ;
      502     6380    2         RETURN;
      503     6381    2   ALTRT1:;
      504     6382    2         ALTRETURN;
      505     6383    2   END WRITE_DEV1;
      506     6384        /**/
      507     6385        /*F* NAME:         FOR$CLOSE
      508     6386             PURPOSE:      To close the :FORM file. */
      509     6387        /**/
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:17   
      510     6388    1   FOR$CLOSE: ENTRY ALTRET;
      511     6389
      512     6390    1         CALL M$CLOSE (CLOSE_FORM) ALTRET(ALTRT);
      513     6391    1         RETURN;
      514     6392        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:18   
      515     6393        /**/
      516     6394        /*F* NAME:         FOR$TCHK
      517     6395             PURPOSE:      To check that a form is legal at a TERMINAL
      518     6396             DESCRIPTION:  Reads the forms file record for the given
      519     6397                           form, and uses FOT$TCHK to validate the
      520     6398                           access. ALTRETs if not allowed, else returns. */
      521     6399        /**/
      522     6400    1   FOR$TCHK: ENTRY (FORMNAME,WSN) ALTRET;
      523     6401        /**/
      524     6402
      525     6403    1         FORMKEY.NAME=FORMNAME;
      526     6404                                      /* Read :FORM */
      527     6405    1         CALL READREC ALTRET(ALTRT);
      528     6406    1         CALL FOT$TCHK (ADDR(FO_FITBUF1)->FS$FORM,WSN) ALTRET(ALTRT);
      529     6407    1         RETURN;
      530     6408    1   ALTRT:;
      531     6409    1         ALTRETURN;
      532     6410
      533     6411
      534     6412        /*D* NAME:         READREC
      535     6413             PURPOSE:      To read the :FORM record for form FORMKEY.NAME
      536     6414             DESCRIPTION:  Reads it into FO_FITBUF1.  ALTRETs if error
      537     6415                           on read or open.  SCREECHes if :FORM file
      538     6416                           is broken. Returns FORM$=record address. */
      539     6417    1   READREC: PROC ALTRET;
      540     6418    2         FORM$=ADDR(FO_FITBUF1);
      541     6419        /*D* NAME:         READREC1
      542     6420             PURPOSE:      To read a :FORM record
      543     6421             DESCRIPTION:  Same as READREC, but FORM$ points to caller's
      544     6422                           buffer. */
      545     6423    2   READREC1: ENTRY ALTRET;
      546     6424    2   TRYOPN:;
      547     6425    2         IF DCBADDR(DCBNUM(M$FORM))->F$DCB.FCD = '0'B THEN
      548     6426                                      /* Open :FORM */
      549     6427    2          CALL M$OPEN (OPEN_FORM) ALTRET(NOOPN);
      550     6428    2         READ_FORM.BUF_=VECTOR(FORM$->B$$FORMR);
      551     6429    2         CALL M$READ (READ_FORM) ALTRET(ALTRT);
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:19   
      552     6430                                      /* Force (physically) the cleaning of
      553     6431                                         buffers for DCB M$FORM */
      554     6432    2         CALL M$TRUNC (TRUNC_FORM) ALTRET(RTN);
      555     6433    2   RTN:  ;
      556     6434    2         RETURN;
      557     6435    2   ALTRT:;
      558     6436    2         ALTRETURN;
      559     6437    2   NOOPN:;
      560     6438    2         IF B$ERRCODE = %E$FILEBUSY
      561     6439    2         OR B$ERRCODE = %E$NOFILE THEN
      562     6440    3           DO;
      563     6441    3           CALL M$WAIT (SLEEP1);
      564     6442    3           GOTO TRYOPN;
      565     6443    3           END;
      566     6444    2         CALL FOI$CRASHGO (%S$FOBFORM,F_FO,M_R);
      567     6445        /*S* SCREECH_CODE: FOR-S$FOBFORM
      568     6446             TYPE:         SCREECH
      569     6447             MESSAGE:      OUTSYM - :FORM.:SYS is broken
      570     6448             REMARKS:      OUTSYM has tried to open :FORM.:SYS and has got
      571     6449                           an error other than busy/nofile.  This SCREECH
      572     6450                           should result in SLUG deleting the appropriate
      573     6451                           files on the way up, and causing them to be
      574     6452                           rebuilt. */
      575     6453    2         ALTRETURN;
      576     6454    2   END READREC;
      577     6455        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:20   
      578     6456        /**/
      579     6457        /*F* NAME:         FOR$SALIGN
      580     6458             PURPOSE:      To commence building the alignment image for
      581     6459                           a symbiont device.
      582     6460        */
      583     6461                                      /* Initialize granule,
      584     6462                                         Add alignment info (from :FORM rec),
      585     6463                                         Print banner */
      586     6464    1   FOR$SALIGN: ENTRY (FORMNAME,WSN) ALTRET;
      587     6465
      588     6466                           /* WSN IS ALSTAT */
      589     6467
      590     6468    1         FORMKEY.NAME=DEV$->FO$DEV.FORM;
      591     6469                                      /* Set pointer to device's alignment
      592     6470                                         record */
      593     6471    1         FORM$=DEV$->FO$DEV.ALR$;
      594     6472                                      /* Read :FORM with FORMKEY.NAME to get
      595     6473                                         VFU image for device */
      596     6474    1         CALL READREC1 ALTRET(SAL0);
      597     6475    1         GOTO SAL1;
      598     6476    1   SAL0: ;
      599     6477    1         IF DEV$->FO$DEV.FORM = 'STDLP' THEN ALSTAT.STAT=FOAS_NTTD#;
      600     6478    1         ELSE
      601     6479    2           DO;
      602     6480    2           ALSTAT.STAT=FOAS_FERR#;
      603     6481    2           ALSTAT.ERRC=B$ERRCODE;
      604     6482    2           END;
      605     6483    1         ALTRETURN;
      606     6484    1   SAL1: ;
      607     6485    1         CALL ALSET;
      608     6486    1         IF DEV$ -> FO$DEV.FLG.MODE = FOMD_GRAPHIC#
      609     6487    2         THEN DO;
      610     6488    2           WRSP$ -> FS$GWRSP.START = 0;
      611     6489    2           WRSP$ -> FS$GWRSP.ENTDISP = FORM$ -> FS$FORM.ALGNDISP;
      612     6490    2           GPARM.VFCR = '0'B;
      613     6491    2           FS_WORKAREA$ = PINCRW(WRSP$,LENGTHW(FS$GWRSP));
      614     6492    2           GPARM.REC$ = PINCRW(FS_WORKAREA$,LENGTHW(FS$WORKAUTO));
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:21   
      615     6493    2           START_GRAFBAN = '1'B;
      616     6494    2           WRSP$ ->FS$GWRSP.DATE_TIME = ENTADDR(NIL);
      617     6495    2           GOTO GAL2;
      618     6496    2           END;
      619     6497                                           /* Non-graphics devices here */
      620     6498    2         ELSE DO;
      621     6499                           /* Stick in VFU image */
      622     6500                                      /* WRSP$ = FORM$ + 2048 */
      623     6501    2           WRSP$->FS$WRSP.WIDTH=FORM$->FS$FORM.SOFTFORM.VLPPLATEN.WIDTH;
      624     6502                                           /**/
      625     6503                                           /* Kludge so URPs aligns properly */
      626     6504                                           /**/
      627     6505    2           FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LENGTH =
      628     6506    2           FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LENGTH +
      629     6507    2           FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LIMBO;
      630     6508    2           FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LIMBO = 0;
      631     6509    2           GPARM.REC$=ADDR(FORM$->FS$FORM.SOFTFORM);
      632     6510    2           GPARM.RECL=LENGTHC(FS$FORM.SOFTFORM);
      633     6511    2           GPARM.VFC=%VFC_VFU;
      634     6512                                      /* Initialize granule, then add a record */
      635     6513    2           CALL FOG$BLD (GPARM);
      636     6514                           /* Stick in chain image */
      637     6515                                           /**/
      638     6516                                           /* On local printers, the firmware
      639     6517                                              holds onto and handles this info.
      640     6518                                              On FEP printers, the FEP does it. */
      641     6519                                           /**/
      642     6520    2           IF  DEV$->FO$DEV.FLG.LOCAL
      643     6521    3           THEN DO;
      644     6522    3             GPARM.REC$=ADDR(FORM$->FS$FORM.CHAINIMAGE);
      645     6523    3             GPARM.RECL=LENGTHC(FORM$->FS$FORM.CHAINIMAGE);
      646     6524    3             GPARM.VFC=%VFC_LCHN;
      647     6525                                      /* ADD a record (chain image) into
      648     6526                                         granule */
      649     6527    3             CALL FOG$ADD (GPARM);
      650     6528    3             END;
      651     6529    2           IF FORM$->FS$FORM.ALGNDISP = 0 THEN
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:22   
      652     6530    3             DO;
      653     6531                                      /* Set the alignment state */
      654     6532    3             ALSTAT.STAT=FOAS_JVFU#;
      655     6533    3             RETURN;
      656     6534    3             END;
      657     6535                                           /**/
      658     6536                                           /* Place a zero tab record in
      659     6537                                              the align granule.  This must
      660     6538                                              be a transparent write. */
      661     6539                                           /**/
      662     6540                                           /**/
      663     6541    2           GPARM.REC$ = ADDR (ZERO_TABS);
      664     6542    2           GPARM.RECL = SIZEC (ZERO_TABS);
      665     6543    2           GPARM.DVBYTE = GPARM.DVBYTE | %DVBYTE_TRANS#;
      666     6544    2           GPARM.VFCR = TABVFC;
      667     6545    2           CALL FOG$ADD (GPARM);
      668     6546    2           GPARM.DVBYTE = GPARM.DVBYTE & (~(%DVBYTE_TRANS#));
      669     6547    2           GPARM.DVBYTE = GPARM.DVBYTE | %DVBYTE_BP#;
      670     6548    2           WRSP$->FS$WRSP.START=0;
      671     6549    2           GPARM.VFCR='0'B;
      672     6550    2           FS_WORKAREA$=PINCRW(WRSP$,LENGTHW(FS$WRSP));
      673     6551    2           GPARM.REC$=PINCRW(FS_WORKAREA$,LENGTHW(FS$WORKAUTO));
      674     6552    2           GOTO SAL2;
      675     6553    2           END;
      676     6554
      677     6555        /*F* NAME:         FOR$CALIGN
      678     6556             PURPOSE:      To continue building the alignment image for
      679     6557                           a symbiont device.
      680     6558        */
      681     6559    1   FOR$CALIGN: ENTRY (FORMNAME,WSN) ALTRET;
      682     6560
      683     6561                           /* WSN IS ALSTAT */
      684     6562
      685     6563    1         FORM$=DEV$->FO$DEV.ALR$;
      686     6564    1         CALL ALSET;
      687     6565    1         CALL FOG$GRAN (GPARM);
      688     6566    1         GPARM.VFCR='0'B;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:23   
      689     6567    1         FS_WORKAREA$=PINCRW(WRSP$,LENGTHW(FS$WRSP));
      690     6568    1         GPARM.REC$=PINCRW(FS_WORKAREA$,LENGTHW(FS$WORKAUTO));
      691     6569    1         GOTO SAL3;
      692     6570    1   SAL2: ;
      693     6571                                      /* Call this continuously until banner
      694     6572                                         is completed */
      695     6573    1         CALL FSK$BANNER (FINST$->FS$FINST,
      696     6574    1         WRSP$->FS$WRSP,
      697     6575    1         GPARM.REC$->B$$ALREC,
      698     6576    1         FS_WORKAREA$ -> FS$WORKAUTO) ALTRET(SAL5);
      699     6577    1         IF WRSP$->FS$WRSP.START = -1 THEN
      700     6578    2           DO;
      701     6579                                /* DONE */
      702     6580    2           ALSTAT.STAT=FOAS_LAST#;
      703     6581    2           RETURN;
      704     6582    2           END;
      705     6583    1   SAL3: ;
      706     6584    1         GPARM.RECL=WRSP$->FS$WRSP.MAXBYTES;
      707     6585    1         CALL FOG$ADD (GPARM) ALTRET(SAL4);
      708     6586    1         GOTO SAL2;
      709     6587    1   SAL4: ;
      710     6588    1         ALSTAT.STAT=FOAS_GRAN#;
      711     6589    1         RETURN;
      712     6590    1   SAL5: ;
      713     6591    1         ALSTAT.STAT=FOAS_BDIM#;
      714     6592    1         RETURN;
      715     6593
      716     6594        /*F* NAME:         FOR$GALIGN
      717     6595             PURPOSE:      To continue building the alignment image for
      718     6596                           a symbiont graphics device.
      719     6597        */
      720     6598    1   FOR$GALIGN: ENTRY (FORMNAME,WSN) ALTRET;
      721     6599
      722     6600                           /* WSN IS ALSTAT */
      723     6601
      724     6602    1         FORM$=DEV$->FO$DEV.ALR$;
      725     6603    1         CALL ALSET;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:24   
      726     6604    1         CALL FOG$GRAN (GPARM);
      727     6605    1         GPARM.VFCR='0'B;
      728     6606    1         FS_WORKAREA$=PINCRW(WRSP$,LENGTHW(FS$GWRSP));
      729     6607    1         GPARM.REC$=PINCRW(FS_WORKAREA$,LENGTHW(FS$WORKAUTO));
      730     6608    1         WRSP$ ->FS$GWRSP.DATE_TIME = ENTADDR(NIL);
      731     6609    1         GOTO GAL3;
      732     6610    1   GAL2: ;
      733     6611                                      /* Call this continuously until banner
      734     6612                                         is completed */
      735     6613    1         CALL FSK$GBANNER ( FORM$->FS$FORM,   /* GBANNER NEEDS THE WHOLE FORM */
      736     6614    1         WRSP$->FS$GWRSP,
      737     6615    1         GPARM.REC$->B$$ALREC,
      738     6616    1         FS_WORKAREA$ -> FS$WORKAUTO) ALTRET(GAL5);
      739     6617    1         IF WRSP$->FS$GWRSP.START = -1 THEN
      740     6618    2           DO;
      741     6619                                /* DONE */
      742     6620    2           IF FORM$ -> FS$FORM.ALGNDISP = 0
      743     6621    2           THEN
      744     6622    2            ALSTAT.STAT=FOAS_JDLM#;
      745     6623    2           ELSE
      746     6624    2            ALSTAT.STAT=FOAS_LAST#;
      747     6625    2           RETURN;
      748     6626    2           END;
      749     6627    1   GAL3: ;
      750     6628    1         GPARM.RECL=WRSP$->FS$GWRSP.MAXBYTES;
      751     6629    1         IF START_GRAFBAN = '1'B
      752     6630    2         THEN DO;
      753     6631    2           START_GRAFBAN = '0'B;
      754     6632    2           CALL FOG$BLD (GPARM);
      755     6633    2           END;
      756     6634    2         ELSE DO;
      757     6635    2           CALL FOG$ADD (GPARM) ALTRET (GAL4);
      758     6636    2           END;
      759     6637    1         GOTO GAL2;
      760     6638    1   GAL4: ;
      761     6639    1         ALSTAT.STAT=FOAS_GRAN#;
      762     6640    1         RETURN;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:25   
      763     6641    1   GAL5: ;
      764     6642    1         ALSTAT.STAT=FOAS_BDIM#;
      765     6643    1         RETURN;
      766     6644
      767     6645    1   ALSET: PROC;
      768     6646    2         FINST$=PINCRW(FORM$,FORM$->FS$FORM.ALGNDISP);
      769     6647    2         FINST$->FS$FINST.INTR=0;
      770     6648    2         WRSP$=PINCRW(FORM$,2048);
      771     6649                                      /* Work space pointer */
      772     6650    2         GPARM.BUF$=DEV$->FO$DEV.SPG$;
      773     6651    2         GPARM.REPEATS=1;
      774     6652    2         GPARM.DVBYTE = %DVBYTE_BP#|%DVBYTE_VFC#;
      775     6653    2         RETURN;
      776     6654    2   END ALSET;
      777     6655    1   END FOR$FORM;

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:26   
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   FO_SCODE_C.:E05TOU  is referenced.
   FOO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FOO_SUBS_C.:E05TOU  is referenced.
   FOM_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   FR_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FOR$FORM.

   Procedure FOR$FORM requires 781 words for executable code.
   Procedure FOR$FORM requires 30 words of local(AUTO) storage.

    No errors detected in file FOR$FORM.:E05TSI    .

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:27   

 Object Unit name= FOR$FORM                                   File name= FOR$FORM.:E05TOU
 UTS= JUL 29 '97 17:13:41.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    76    114  FOR$FORM
    2   DCB   even  none     0      0  M$FORM
    3   DCB   even  none     0      0  M$CSCG
    4   DCB   even  none     0      0  M$OSYMB
    5   DCB   even  none     0      0  M$OSCG
    6  RoData even  UTS    177    261  FOR$FORM
    7   Proc  even  none   781   1415  FOR$FORM
    8  RoData even  none    17     21  FOR$FORM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes    yes     yes      Std        3  FOR$FORM
     7      3          yes     yes      Std        3  FOR$KEYIN
     7    211          yes     yes      Std        1  FOR$GETMODE
     7    246          yes     yes      Std        0  FOR$MOUNT
     7    464          yes     yes      Std        0  FOR$DEVWR
     7    624          yes     yes      Std        0  FOR$CLOSE
     7    633          yes     yes      Std        2  FOR$TCHK
     7    735          yes     yes      Std        2  FOR$SALIGN
     7   1160          yes     yes      Std        2  FOR$CALIGN
     7   1252          yes     yes      Std        2  FOR$GALIGN
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:28   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FOG$ADD
 yes     yes           Std       4 FSK$GBANNER
 yes     yes           Std       2 FOT$TCHK
 yes     yes           Std       1 FOG$GRAN
 yes     yes           Std       4 FSK$BANNER
 yes     yes           Std       1 FOG$BLD
 yes     yes           Std       2 FOT$DCHK
 yes     yes           Std       3 FOI$CRASHGO
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  FO_FITBUF1                            FO_DEV$
     FO_OSYMBKEY                           FO_OSYMBUF                            M$FORM
     M$CSCG                                M$OSYMB                               M$OSCG
     B$TCB$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:29   


        1        1        /*M* FOR$FORM Output symbiont device FORM routines for OUTSYM */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         FOR$FORM
       10       10             PURPOSE:      To handle device FORMs for OUTSYM
       11       11             DESCRIPTION:  Contains various routines. */
       12       12        /**/
       13       13        FOR$FORM: PROC (FORMNAME,WSN,KEYIN$) ALTRET;

     13  7 000000   000000 700200 xent  FOR$FORM     TSX0  ! X66_AUTO_3
         7 000001   000036 000003                    ZERO    30,3
         7 000002   000005 710000 7                  TRA     s:5850

       14       14        /**/
       15       15
       16       16
       17       17
       18       18        /**/
       19       19        /* PARAMETERS */
       20       20        /**/
       21       21    1   DCL FORMNAME CHAR(6) UNAL;
       22       22    1   DCL WSN CHAR(8) ALIGNED;
       23       23    1   DCL 1 ALSTAT REDEF WSN ALIGNED,
       24       24    1         2 STAT UBIN WORD UNAL,
       25       25    1         2 ERRC UBIN WORD UNAL;
       26       26    1   DCL KEYIN$ PTR ALIGNED;
       27       27
       28       28
       29       29
       30       30        /**/
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:30   
       31       31        /* INCLUDES */
       32       32        /**/
       33       33        %INCLUDE CP_6;
       34      114        %INCLUDE FS$FIT;
       35      157        %INCLUDE KC_ERRORS_C;
       36      204        %INCLUDE FO_ERRORS_C;
       37      236        %INCLUDE F_ERRORS_C;
       38      476        %INCLUDE FR_ERRORS_C;
       39      507        %INCLUDE OC_SUBS_C;
       40     1238        %INCLUDE OC_MESSHD_C;
       41     1291        %INCLUDE FOM_SUBS_C;
       42     1354        %INCLUDE FOO_SUBS_C;
       43     1590        %INCLUDE FOO_MAC_C;
       44     2338        %INCLUDE FOO_DATA_R;
       45     3504        %INCLUDE FO_SCODE_C;
       46     3532        %INCLUDE FS_SUPER_C;
       47     4295        %INCLUDE CP_6_SUBS;
       48     4835        %INCLUDE F$DCB;
       49     4884        %INCLUDE NK_VFC_C;
       50     4958
       51     4959
       52     4960
       53     4961        /**/
       54     4962        /* BASED STRUCTURES */
       55     4963        /**/
       56     4964        %B$TCB;
       57     4967        %B$ALT;
       58     4975        %FS$SET_INIT (NAME=FS$SETUP,STCLASS=BASED);
       59     4993        %FS$BAN_INIT (NAME=FS$FINST,STCLASS=BASED);
       60     5050        %FS$FORMREC (NAME=FS$FORM,STCLASS=BASED);
       61     5121        %FS$WRSP (NAME=FS$WRSP,STCLASS=BASED);
       62     5139        %FS$GWRSP (NAME=FS$GWRSP,STCLASS=BASED);
       63     5163        %FS$WORKAUTO (NAME=FS$WORKAUTO,STCLASS=BASED);
       64     5182    1   DCL B$$FORMR (0:2047) UBIN WORD BASED ALIGNED;
       65     5183    1   DCL B$$ALREC CHAR(256) BASED UNAL;
       66     5184
       67     5185
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:31   
       68     5186
       69     5187        /**/
       70     5188        /* AUTO */
       71     5189        /**/
       72     5190    1   DCL ALIGN$ PTR;
       73     5191    1   DCL I UBIN WORD;
       74     5192    1   DCL IR REDEF I SBIN;
       75     5193    1   DCL FORM$ PTR;
       76     5194    1   DCL START_GRAFBAN BIT(1);
       77     5195    1   DCL ERRC UBIN WORD;
       78     5196    1   DCL WRSP$ PTR;
       79     5197    1   DCL FINST$ PTR;
       80     5198        %FO_GPARM (FPTN=GPARM,STCLASS=AUTO);
       81     5220    1   DCL KSUBC UBIN WORD;
       82     5221    1   DCL SETUP$ PTR;
       83     5222    1   DCL FS_WORKAREA$ PTR;
       84     5223
       85     5224
       86     5225
       87     5226        /**/
       88     5227        /* STATIC */
       89     5228        /**/
       90     5229    1   DCL 1 FORMKEY STATIC DALIGNED,
       91     5230    1         2 * UBIN BYTE UNAL INIT(6),
       92     5231    1         2 NAME CHAR(6) UNAL;
       93     5232    1   DCL DEVNAME CHAR(8) STATIC DALIGNED;
       94     5233    1   DCL FORMNM CHAR(6) STATIC DALIGNED;
       95     5234        %OC_MESSHD_D            (NAME=OPMSG_MERR,
       96     5235                 NPARMS    = 4,
       97     5236                 MSG       = FO_MERR_MSG#,
       98     5237                 ATR       = M_UR,
       99     5238                 STCLASS   = STATIC);
      100     5251    1         2 * UBIN BYTE UNAL INIT(1),
      101     5252    1         2 * UBIN BYTE UNAL INIT(8),
      102     5253    1         2 * UBIN BYTE UNAL INIT(2),
      103     5254    1         2 * UBIN BYTE UNAL INIT(1),
      104     5255    1         2 SUBC UBIN BYTE UNAL,
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:32   
      105     5256    1         2 FORM CHAR(8) UNAL,
      106     5257    1         2 ERRC UBIN HALF UNAL,
      107     5258    1         2 CONNECT UBIN BYTE UNAL;
      108     5259        %OC_MESSHD_D            (NAME=OPMSG_FORM,
      109     5260                 NPARMS    = 3,
      110     5261                 MSG       = FO_RESP_MSG#,
      111     5262                 ATR       = M_UR,
      112     5263                 STCLASS   = STATIC);
      113     5276    1         2 * UBIN BYTE UNAL INIT(1),
      114     5277    1         2 * UBIN BYTE UNAL INIT(8),
      115     5278    1         2 * UBIN BYTE UNAL INIT(72),
      116     5279    1         2 SUBC UBIN BYTE UNAL,
      117     5280    1         2 FORM CHAR(8) UNAL,
      118     5281    1         2 SETUP CHAR(72) UNAL;
      119     5282
      120     5283
      121     5284
      122     5285        /**/
      123     5286        /* DCBS */
      124     5287        /**/
      125     5288    1   DCL M$FORM DCB;
      126     5289    1   DCL M$CSCG DCB;
      127     5290    1   DCL M$OSYMB DCB;
      128     5291    1   DCL M$OSCG DCB;
      129     5292
      130     5293
      131     5294
      132     5295        /**/
      133     5296        /* REFS */
      134     5297        /**/
      135     5298    1   DCL B$TCB$ PTR SYMREF;
      136     5299    1   DCL FOG$ADD       ENTRY(1) ALTRET;
      137     5300    1   DCL FOG$BLD       ENTRY(1) ALTRET;
      138     5301    1   DCL FOG$GRAN      ENTRY(1) ALTRET;
      139     5302    1   DCL FOI$CRASHGO   ENTRY(3) ALTRET;
      140     5303    1   DCL FOT$DCHK      ENTRY(2) ALTRET;
      141     5304    1   DCL FOT$TCHK      ENTRY(2) ALTRET;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:33   
      142     5305    1   DCL FSK$BANNER    ENTRY(4) ALTRET;
      143     5306    1   DCL FSK$GBANNER   ENTRY(4) ALTRET;
      144     5307
      145     5308
      146     5309
      147     5310        /**/
      148     5311        /* PMME FPTS */
      149     5312        /**/
      150     5313        %FPT_OPEN                              (FPTN=OPEN_FORM,
      151     5314                 STCLASS   = CONSTANT,
      152     5315                 DCB       = M$FORM,
      153     5316                 NAME      = FORMFILE,
      154     5317                 ACCT      = SYSACCT,
      155     5318                 ASN       = FILE,
      156     5319                 FUN       = IN,
      157     5320                 SHARE     = ALL,
      158     5321                 SCRUB     = YES);
      159     5430        %VLP_NAME                              (FPTN=FORMFILE,
      160     5431                 NAME      = ':FORM',
      161     5432                 STCLASS   = CONSTANT);
      162     5459        %VLP_ACCT                              (FPTN=SYSACCT,
      163     5460                 ACCT      = ':SYS',
      164     5461                 STCLASS   = CONSTANT);
      165     5474        %FPT_CLOSE                             (FPTN=CLOSE_FORM,
      166     5475                 DCB       = M$FORM,
      167     5476                 STCLASS   = CONSTANT,
      168     5477                 DISP      = SAVE);
      169     5519        %FPT_READ                              (FPTN=READ_FORM,
      170     5520                 STCLASS   = STATIC,
      171     5521                 DCB       = M$FORM,
      172     5522                 KEYS      = YES,
      173     5523                 KEYR      = NO,
      174     5524                 KEY       = FORMKEY);
      175     5563        %FPT_WRITE                             (FPTN=OCMSG_FORM,
      176     5564                 STCLASS=CONSTANT,
      177     5565                 DCB=M$CSCG,
      178     5566                 BUF=OPMSG_FORM);
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:34   
      179     5597        %FPT_WRITE                             (FPTN=OCMSG_MERR,
      180     5598                 STCLASS=CONSTANT,
      181     5599                 DCB=M$CSCG,
      182     5600                 BUF=OPMSG_MERR);
      183     5631        %FPT_SYMBIO                            (FPTN=FMNT_SYMB,
      184     5632                 DCB       = M$OSCG,
      185     5633                 STCLASS   = CONSTANT,
      186     5634                 FORM      = FORMNM,
      187     5635                 STATION   = DEVNAME,
      188     5636                 ORDER     = FOMO_FMNT#);
      189     5660        %FPT_TRUNC                            (FPTN=TRUNC_OSYMB,
      190     5661                 DCB       = M$OSYMB,
      191     5662                 STCLASS   = CONSTANT);
      192     5676        %FPT_TRUNC                            (FPTN=TRUNC_FORM,
      193     5677                 DCB       = M$FORM,
      194     5678                 STCLASS   = CONSTANT);
      195     5692        %FPT_WRITE                             (FPTN=WRITE_OSYMB,
      196     5693                 STCLASS   = STATIC,
      197     5694                 DCB       = M$OSYMB,
      198     5695                 KEY       = FO_OSYMBKEY,
      199     5696                 BUF       = FO_OSYMBUF,
      200     5697                 ONEWKEY   = YES);
      201     5728        %FPT_READ                             (FPTN=READ_OSYMB,
      202     5729                 STCLASS   = CONSTANT,
      203     5730                 DCB       = M$OSYMB,
      204     5731                 KEY       = FO_OSYMBKEY,
      205     5732                 KEYS      = YES,
      206     5733                 BUF       = FO_OSYMBUF,
      207     5734                 KEYR      = NO);
      208     5773        %FPT_WAIT                              (FPTN=SLEEP1,
      209     5774                 STCLASS=CONSTANT,
      210     5775                 UNITS=1);
      211     5789        %VLP_TAB                               (FPTN=ZERO_TABS,
      212     5790                 MARGIN=1,
      213     5791                 STCLASS=STATIC);
      214     5805
      215     5806        %NK$VFC (NAME=TABVFC,
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:35   
      216     5807                 STCLASS=CONSTANT,
      217     5808                 IFCN=%VFCF_SPC,
      218     5809                 ICOUNT=%VFCS_OTAB);
      219     5827
      220     5828
      221     5829
      222     5830        /**/
      223     5831        /* SUBS */
      224     5832        /**/
      225     5833        %SUB FIL$=FO_FIL$;
      226     5834        %SUB DEV$=FO_DEV$;
      227     5835        %SUB JOB$=FO_JOB$;
      228     5836        %SUB F_FO='0617'O;
      229     5837        %SUB M_R='22'O;
      230     5838        %SUB B$ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      231     5839        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:36   
      232     5840        /**/
      233     5841        /*F* NAME:         FOR$KEYIN
      234     5842             PURPOSE:      To process FORM keyins in OUTSYM.
      235     5843             DESCRIPTION:  If the keyin is particular to a device,
      236     5844                           then FO_DEV$ points to the device if it
      237     5845                           is symbiont, and is ADDR(NIL) else. */
      238     5846        /**/
      239     5847    1   FOR$KEYIN: ENTRY (FORMNAME,WSN,KEYIN$) ALTRET;

   5847  7 000003   000000 700200 xent  FOR$KEYIN    TSX0  ! X66_AUTO_3
         7 000004   000036 000003                    ZERO    30,3

      240     5848
      241     5849                                /* ONLY KEYIN$ IS PASSED */
      242     5850    1         OPMSG_MERR.CONNECT=0;

   5850  7 000005   000000 236003                    LDQ     0,DU
         7 000006   000016 552004 1                  STBQ    OPMSG_MERR+8,'04'O

      243     5851    1         OPMSG_MERR.DEVNM=KEYIN$->FO$DKEYIN.DEVNM;

   5851  7 000007   200005 470500                    LDP0    @KEYIN$,,AUTO
         7 000010   000000 471500                    LDP1    0,,PR0
         7 000011   040000 100500                    MLR     fill='040'O
         7 000012   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         7 000013   000011 000010 1                  ADSC9   OPMSG_MERR+3             cn=0,n=8

      244     5852    1         OPMSG_MERR.CADDR=KEYIN$->FO$DKEYIN.CADDR;

   5852  7 000014   000000 471500                    LDP1    0,,PR0
         7 000015   100000 720100                    LXL0    0,,PR1
         7 000016   000006 740000 1                  STX0    OPMSG_MERR

      245     5853    1         OPMSG_MERR.FORM=KEYIN$->FO$DKEYIN.FORM;

   5853  7 000017   000000 471500                    LDP1    0,,PR0
         7 000020   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:37   
         7 000021   100005 000006                    ADSC9   5,,PR1                   cn=0,n=6
         7 000022   000014 200010 1                  ADSC9   OPMSG_MERR+6             cn=1,n=8

      246     5854    1         FORMKEY.NAME=KEYIN$->FO$DKEYIN.FORM;

   5854  7 000023   000000 471500                    LDP1    0,,PR0
         7 000024   040000 100500                    MLR     fill='040'O
         7 000025   100005 000006                    ADSC9   5,,PR1                   cn=0,n=6
         7 000026   000000 200006 1                  ADSC9   FORMKEY                  cn=1,n=6

      247     5855    1         OPMSG_FORM.DEVNM=KEYIN$->FO$DKEYIN.DEVNM;

   5855  7 000027   000000 471500                    LDP1    0,,PR0
         7 000030   040000 100500                    MLR     fill='040'O
         7 000031   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         7 000032   000022 000010 1                  ADSC9   OPMSG_FORM+3             cn=0,n=8

      248     5856    1         OPMSG_FORM.CADDR=KEYIN$->FO$DKEYIN.CADDR;

   5856  7 000033   000000 471500                    LDP1    0,,PR0
         7 000034   100000 721100                    LXL1    0,,PR1
         7 000035   000017 741000 1                  STX1    OPMSG_FORM

      249     5857    1         OPMSG_FORM.FORM=KEYIN$->FO$DKEYIN.FORM;

   5857  7 000036   000000 471500                    LDP1    0,,PR0
         7 000037   040000 100500                    MLR     fill='040'O
         7 000040   100005 000006                    ADSC9   5,,PR1                   cn=0,n=6
         7 000041   000025 000010 1                  ADSC9   OPMSG_FORM+6             cn=0,n=8

      250     5858    1         CALL READREC ALTRET(NOFORM);

   5858  7 000042   000654 701000 7                  TSX1    READREC
         7 000043   000164 702000 7                  TSX2    NOFORM

      251     5859
      252     5860    2           DO CASE (KEYIN$->FO$DKEYIN.KIN#);
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:38   

   5860  7 000044   200005 470500                    LDP0    @KEYIN$,,AUTO
         7 000045   000000 471500                    LDP1    0,,PR0
         7 000046   100000 236100                    LDQ     0,,PR1
         7 000047   000022 772000                    QRL     18
         7 000050   000022 136007                    SBLQ    18,DL
         7 000051   000002 116007                    CMPQ    2,DL
         7 000052   000054 602006 7                  TNC     s:5860+8,QL
         7 000053   000210 710000 7                  TRA     s:5923
         7 000054   000056 710000 7                  TRA     s:5870
         7 000055   000115 710000 7                  TRA     s:5890

      253     5861
      254     5862        /**
      255     5863         **
      256     5864         **      SETUP KEYIN
      257     5865         **
      258     5866         **/
      259     5867
      260     5868    2             CASE (KEY_SETUP#);

      261     5869
      262     5870    2               OPMSG_FORM.SUBC=FOKR_SETUP#;

   5870  7 000056   000011 236007                    LDQ     9,DL
         7 000057   000024 552004 1                  STBQ    OPMSG_FORM+5,'04'O

      263     5871    2               IF FORM$->FS$FORM.SETUPDISP = 0 THEN

   5871  7 000060   200010 471500                    LDP1    FORM$,,AUTO
         7 000061   100002 220100                    LDX0    2,,PR1
         7 000062   000066 601000 7                  TNZ     s:5876

      264     5872    3                 DO;

      265     5873    3                 OPMSG_MERR.SUBC=FOKE_NSTUP#;

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:39   
   5873  7 000063   000000 236003                    LDQ     0,DU
         7 000064   000014 552040 1                  STBQ    OPMSG_MERR+6,'40'O

      266     5874    3                 GOTO MERR;

   5874  7 000065   000204 710000 7                  TRA     MERR

      267     5875    3                 END;
      268     5876    2               SETUP$=PINCRW(FORM$,FORM$->FS$FORM.SETUPDISP);

   5876  7 000066   000000 636010                    EAQ     0,X0
         7 000067   200010 036100                    ADLQ    FORM$,,AUTO
         7 000070   200021 756100                    STQ     SETUP$,,AUTO

      269     5877    3                 DO IR = 0 TO SETUP$->FS$SETUP.LINES-1;

   5877  7 000071   200007 450100                    STZ     I,,AUTO
         7 000072   000105 710000 7                  TRA     s:5880+1

      270     5878    3                 OPMSG_FORM.SETUP=SETUP$->FS$SETUP.TXT(I);

   5878  7 000073   200007 236100                    LDQ     I,,AUTO
         7 000074   000110 402007                    MPY     72,DL
         7 000075   200021 470500                    LDP0    SETUP$,,AUTO
         7 000076   040000 100506                    MLR     fill='040'O
         7 000077   000001 000110                    ADSC9   1,Q,PR0                  cn=0,n=72
         7 000100   000027 000110 1                  ADSC9   OPMSG_FORM+8             cn=0,n=72

      271     5879    3                 CALL M$WRITE (OCMSG_FORM);

   5879  7 000101   000134 630400 6                  EPPR0   OCMSG_FORM
         7 000102   040001 713400                    CLIMB   write
         7 000103   401400 401760                    pmme    nvectors=4

      272     5880    3                 END;

   5880  7 000104   200007 054100                    AOS     I,,AUTO
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:40   
         7 000105   200021 470500                    LDP0    SETUP$,,AUTO
         7 000106   000100 101500                    MRL     fill='000'O
         7 000107   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         7 000110   200032 000004                    ADSC9   WSN$+2,,AUTO             cn=0,n=4
         7 000111   200032 236100                    LDQ     WSN$+2,,AUTO
         7 000112   200007 116100                    CMPQ    I,,AUTO
         7 000113   000073 605400 7                  TPNZ    s:5878
         7 000114   000210 710000 7                  TRA     s:5923

      273     5881
      274     5882        /**
      275     5883         **
      276     5884         **      FORM KEYIN
      277     5885         **
      278     5886         **/
      279     5887
      280     5888    2             CASE (KEY_FORM#);

      281     5889
      282     5890    2               DEVNAME=KEYIN$->FO$DKEYIN.DEVNM;

   5890  7 000115   040000 100500                    MLR     fill='040'O
         7 000116   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         7 000117   000002 000010 1                  ADSC9   DEVNAME                  cn=0,n=8

      283     5891    2               IF DEV$ ~= ADDR(NIL) THEN

   5891  7 000120   000000 236000 xsym               LDQ     FO_DEV$
         7 000121   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 000122   000135 600000 7                  TZE     s:5898

      284     5892    2                IF DEV$->FO$DEV.STATE ~= FOS_IDLE# THEN

   5892  7 000123   000000 471400 xsym               LDP1    FO_DEV$
         7 000124   100011 236100                    LDQ     9,,PR1
         7 000125   777000 316007                    CANQ    -512,DL
         7 000126   000135 600000 7                  TZE     s:5898
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:41   

      285     5893    3                  DO;

      286     5894    3                  OPMSG_MERR.SUBC=FOKE_DBUSY#;

   5894  7 000127   004000 236003                    LDQ     2048,DU
         7 000130   000014 552040 1                  STBQ    OPMSG_MERR+6,'40'O

      287     5895    3                  CALL M$WRITE (OCMSG_MERR);

   5895  7 000131   000150 630400 6                  EPPR0   OCMSG_MERR
         7 000132   040001 713400                    CLIMB   write
         7 000133   401400 401760                    pmme    nvectors=4

      288     5896    3                  RETURN;

   5896  7 000134   000000 702200 xent               TSX2  ! X66_ARET

      289     5897    3                  END;
      290     5898    2               CALL MOUNT ALTRET(MERR);

   5898  7 000135   000310 701000 7                  TSX1    MOUNT
         7 000136   000204 702000 7                  TSX2    MERR

      291     5899    2               IF DEV$ ~= ADDR(NIL) THEN

   5899  7 000137   000000 236000 xsym               LDQ     FO_DEV$
         7 000140   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 000141   000154 600000 7                  TZE     s:5905

      292     5900    2                IF FORM$ -> FS$FORM.GRAPHIC

   5900  7 000142   200010 470500                    LDP0    FORM$,,AUTO
         7 000143   000004 430100                    FSZN    4,,PR0
         7 000144   000151 605000 7                  TPL     s:5904

      293     5901    2                THEN
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:42   
      294     5902    2                 DEV$ -> FO$DEV.FLG.MODE = FOMD_GRAPHIC#;

   5902  7 000145   000000 471400 xsym               LDP1    FO_DEV$
         7 000146   000004 236003                    LDQ     4,DU
         7 000147   100012 256100                    ORSQ    10,,PR1
         7 000150   000154 710000 7                  TRA     s:5905

      295     5903    2                ELSE
      296     5904    2                 DEV$ -> FO$DEV.FLG.MODE = FOMD_NONGRAPHIC#;

   5904  7 000151   000000 471400 xsym               LDP1    FO_DEV$
         7 000152   000000 236000 8                  LDQ     0
         7 000153   100012 356100                    ANSQ    10,,PR1

      297     5905    2               OPMSG_FORM.CADDR=M_UR;

   5905  7 000154   100000 220003                    LDX0    32768,DU
         7 000155   000017 740000 1                  STX0    OPMSG_FORM

      298     5906    2               OPMSG_FORM.SUBC=FOKR_FORM#;

   5906  7 000156   000012 236007                    LDQ     10,DL
         7 000157   000024 552004 1                  STBQ    OPMSG_FORM+5,'04'O

      299     5907    2               CALL M$WRITE (OCMSG_FORM);

   5907  7 000160   000134 630400 6                  EPPR0   OCMSG_FORM
         7 000161   040001 713400                    CLIMB   write
         7 000162   401400 401760                    pmme    nvectors=4

      300     5908    2               RETURN;

   5908  7 000163   000000 702200 xent               TSX2  ! X66_ARET

   5906  7 000164                       NOFORM       null
      301     5909    2   NOFORM:     ;
      302     5910    2               IF B$ERRCODE = %E$NOKEY THEN
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:43   

   5910  7 000164   000000 470400 xsym               LDP0    B$TCB$
         7 000165   000000 471500                    LDP1    0,,PR0
         7 000166   100102 236100                    LDQ     66,,PR1
         7 000167   377770 376007                    ANQ     131064,DL
         7 000170   001020 116007                    CMPQ    528,DL
         7 000171   000175 601000 7                  TNZ     s:5914

      303     5911    2                OPMSG_MERR.SUBC=FOKE_NFORM#;

   5911  7 000172   003000 236003                    LDQ     1536,DU
         7 000173   000014 552040 1                  STBQ    OPMSG_MERR+6,'40'O
         7 000174   000204 710000 7                  TRA     MERR

      304     5912    2               ELSE
      305     5913    3                 DO;

      306     5914    3                 OPMSG_MERR.SUBC=FOKE_FFERR#;

   5914  7 000175   010000 236003                    LDQ     4096,DU
         7 000176   000014 552040 1                  STBQ    OPMSG_MERR+6,'40'O

      307     5915    3                 OPMSG_MERR.ERRC=B$ERRCODE;

   5915  7 000177   000000 471500                    LDP1    0,,PR0
         7 000200   100102 236100                    LDQ     66,,PR1
         7 000201   377770 376007                    ANQ     131064,DL
         7 000202   000006 736000                    QLS     6
         7 000203   000016 552030 1                  STBQ    OPMSG_MERR+8,'30'O

      308     5916    3                 END;

   5910  7 000204                       MERR         null
      309     5917    2   MERR:       ;
      310     5918    2               CALL M$WRITE (OCMSG_MERR);

   5918  7 000204   000150 630400 6                  EPPR0   OCMSG_MERR
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:44   
         7 000205   040001 713400                    CLIMB   write
         7 000206   401400 401760                    pmme    nvectors=4

      311     5919    2               ALTRETURN;

   5919  7 000207   000000 702200 xent               TSX2  ! X66_AALT

      312     5920
      313     5921        /* END OF KEYIN TYPE DOCASE */
      314     5922    2           END;

      315     5923    1         RETURN;

   5923  7 000210   000000 702200 xent               TSX2  ! X66_ARET

      316     5924        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:45   
      317     5925
      318     5926    1   FOR$GETMODE: ENTRY (FORMNAME) ALTRET;

   5926  7 000211   000000 700200 xent  FOR$GETMODE  TSX0  ! X66_AUTO_3
         7 000212   000036 000003                    ZERO    30,3

      319     5927        /**/
      320     5928        /*F* NAME:       FOR$GETMODE
      321     5929             PURPOSE:    To aquire the mode of the symbiont device from
      322     5930                         the form mounted on it. */
      323     5931        /**/
      324     5932
      325     5933    1         OPMSG_MERR.DEVNM = DEV$ -> FO$DEV.NAME;

   5933  7 000213   000000 470400 xsym               LDP0    FO_DEV$
         7 000214   040000 100500                    MLR     fill='040'O
         7 000215   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         7 000216   000011 000010 1                  ADSC9   OPMSG_MERR+3             cn=0,n=8

      326     5934    1         OPMSG_MERR.CADDR = M_UR;

   5934  7 000217   100000 220003                    LDX0    32768,DU
         7 000220   000006 740000 1                  STX0    OPMSG_MERR

      327     5935    1         OPMSG_MERR.CONNECT = 1;

   5935  7 000221   000001 236007                    LDQ     1,DL
         7 000222   000016 552004 1                  STBQ    OPMSG_MERR+8,'04'O

      328     5936    1         OPMSG_MERR.FORM = DEV$ -> FO$DEV.FORM;

   5936  7 000223   040000 100500                    MLR     fill='040'O
         7 000224   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6
         7 000225   000014 200010 1                  ADSC9   OPMSG_MERR+6             cn=1,n=8

      329     5937    1         FORMKEY.NAME = DEV$ -> FO$DEV.FORM;

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:46   
   5937  7 000226   040000 100500                    MLR     fill='040'O
         7 000227   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6
         7 000230   000000 200006 1                  ADSC9   FORMKEY                  cn=1,n=6

      330     5938
      331     5939    1         CALL READREC ALTRET (NOFORM);

   5939  7 000231   000654 701000 7                  TSX1    READREC
         7 000232   000164 702000 7                  TSX2    NOFORM

      332     5940
      333     5941    1         IF FORM$ -> FS$FORM.GRAPHIC

   5941  7 000233   200010 470500                    LDP0    FORM$,,AUTO
         7 000234   000004 430100                    FSZN    4,,PR0
         7 000235   000242 605000 7                  TPL     s:5946

      334     5942    2         THEN DO;

      335     5943    2           DEV$ -> FO$DEV.FLG.MODE = FOMD_GRAPHIC#;

   5943  7 000236   000000 471400 xsym               LDP1    FO_DEV$
         7 000237   000004 236003                    LDQ     4,DU
         7 000240   100012 256100                    ORSQ    10,,PR1

      336     5944    2           END;

   5944  7 000241   000245 710000 7                  TRA     s:5949

      337     5945    2         ELSE DO;

      338     5946    2           DEV$ -> FO$DEV.FLG.MODE = FOMD_NONGRAPHIC#;

   5946  7 000242   000000 471400 xsym               LDP1    FO_DEV$
         7 000243   000000 236000 8                  LDQ     0
         7 000244   100012 356100                    ANSQ    10,,PR1

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:47   
      339     5947    2           END;

      340     5948
      341     5949    1         RETURN;

   5949  7 000245   000000 702200 xent               TSX2  ! X66_ARET

      342     5950        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:48   
      343     5951        /**/
      344     5952        /*F* NAME:         FOR$MOUNT
      345     5953             PURPOSE:      To mount a form on a symbiont device when
      346     5954                           it connects with a form. */
      347     5955        /**/
      348     5956    1   FOR$MOUNT: ENTRY ALTRET;

   5956  7 000246   000000 700200 xent  FOR$MOUNT    TSX0  ! X66_AUTO_3
         7 000247   000036 000003                    ZERO    30,3

      349     5957
      350     5958    1         OPMSG_MERR.DEVNM=DEV$->FO$DEV.NAME;

   5958  7 000250   000000 470400 xsym               LDP0    FO_DEV$
         7 000251   040000 100500                    MLR     fill='040'O
         7 000252   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         7 000253   000011 000010 1                  ADSC9   OPMSG_MERR+3             cn=0,n=8

      351     5959    1         OPMSG_MERR.CADDR=M_UR; /* SEND MESSAGE TO EVERYBODY */

   5959  7 000254   100000 220003                    LDX0    32768,DU
         7 000255   000006 740000 1                  STX0    OPMSG_MERR

      352     5960    1         OPMSG_MERR.CONNECT=1;

   5960  7 000256   000001 236007                    LDQ     1,DL
         7 000257   000016 552004 1                  STBQ    OPMSG_MERR+8,'04'O

      353     5961    1         OPMSG_MERR.FORM=DEV$->FO$DEV.FORM;

   5961  7 000260   040000 100500                    MLR     fill='040'O
         7 000261   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6
         7 000262   000014 200010 1                  ADSC9   OPMSG_MERR+6             cn=1,n=8

      354     5962    1         FORMKEY.NAME=DEV$->FO$DEV.FORM;

   5962  7 000263   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:49   
         7 000264   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6
         7 000265   000000 200006 1                  ADSC9   FORMKEY                  cn=1,n=6

      355     5963    1         DEVNAME=DEV$->FO$DEV.NAME;

   5963  7 000266   040000 100500                    MLR     fill='040'O
         7 000267   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         7 000270   000002 000010 1                  ADSC9   DEVNAME                  cn=0,n=8

      356     5964                                      /* Read :FORM with key in FORMKEY */
      357     5965    1         CALL READREC ALTRET(MOUNT1);

   5965  7 000271   000654 701000 7                  TSX1    READREC
         7 000272   000276 702000 7                  TSX2    MOUNT1

      358     5966                                      /* Call M$SYMBIO, write to :OSYMB, set
      359     5967                                         AEF (Align at End of File flag) */
      360     5968    1         CALL MOUNT ALTRET(MERR);

   5968  7 000273   000310 701000 7                  TSX1    MOUNT
         7 000274   000204 702000 7                  TSX2    MERR

      361     5969    1         RETURN;

   5969  7 000275   000000 702200 xent               TSX2  ! X66_ARET

   5963  7 000276                       MOUNT1       null
      362     5970    1   MOUNT1:;
      363     5971    1         IF DEV$->FO$DEV.FORM = 'STDLP' THEN RETURN;

   5971  7 000276   000000 470400 xsym               LDP0    FO_DEV$
         7 000277   040000 106500                    CMPC    fill='040'O
         7 000300   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6
         7 000301   000257 000005 6                  ADSC9   TABVFC+1                 cn=0,n=5
         7 000302   000304 601000 7                  TNZ     s:5972

   5971  7 000303   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:50   

      364     5972    1         DEV$->FO$DEV.FORM=' ';

   5972  7 000304   040100 100400                    MLR     fill='040'O
         7 000305   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 000306   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6

      365     5973    1         GOTO NOFORM;

   5973  7 000307   000164 710000 7                  TRA     NOFORM

      366     5974
      367     5975
      368     5976        /*D* NAME:         MOUNT
      369     5977             PURPOSE:      To mount a form on a device
      370     5978             DESCRIPTION:  FORMKEY.NAME is the form name.
      371     5979                           DEVNAME is the device name.
      372     5980                           FORM$ points to the form record.
      373     5981                           The form is mounted with an M$SYMBIO FMNT PMME,
      374     5982                           and the appropriate message set up if an error
      375     5983                           occurs.  If the form gets mounted and DEV$ is
      376     5984                           not ADDR(NIL), the correct goodies get shoved
      377     5985                           into the OUTSYM device table entry. */
      378     5986    1   MOUNT: PROC ALTRET;

   5986  7 000310   200024 741300       MOUNT        STX1  ! FS_WORKAREA$+2,,AUTO

      379     5987
      380     5988                                /* CHECK FORM LEGAL FOR THIS DEV TYPE */
      381     5989    2         CALL FOT$DCHK (FORM$->FS$FORM,DEVNAME) ALTRET(BADFTYP);

   5989  7 000311   000001 236000 8                  LDQ     1
         7 000312   200010 235100                    LDA     FORM$,,AUTO
         7 000313   200032 757100                    STAQ    WSN$+2,,AUTO
         7 000314   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 000315   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000316   000000 701000 xent               TSX1    FOT$DCHK
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:51   
         7 000317   000460 702000 7                  TSX2    BADFTYP

      382     5990    2         FORMNM=FORMKEY.NAME;

   5990  7 000320   040000 100400                    MLR     fill='040'O
         7 000321   000000 200006 1                  ADSC9   FORMKEY                  cn=1,n=6
         7 000322   000004 000006 1                  ADSC9   FORMNM                   cn=0,n=6

      383     5991                                      /* Non-MOOS pmme. Partitioned devices
      384     5992                                         are removed from OSCG, so we write
      385     5993                                         records to remember them (in case
      386     5994                                         they reconnect). In OUTSYM, we deal
      387     5995                                         with devices whether or not we
      388     5996                                         control them */
      389     5997    2         CALL M$SYMBIO (FMNT_SYMB) ALTRET(NOMOUNT);

   5997  7 000323   000164 630400 6                  EPPR0   FMNT_SYMB
         7 000324   570000 713400                    CLIMB   alt,+61440
         7 000325   403400 401760                    pmme    nvectors=8
         7 000326   000406 702000 7                  TSX2    NOMOUNT

      390     5998    2         IF DEV$ = ADDR(NIL) THEN

   5998  7 000327   000000 236000 xsym               LDQ     FO_DEV$
         7 000330   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 000331   000347 601000 7                  TNZ     s:6010

      391     5999    3           DO; /* To remember form changes while it's partitioned */

      392     6000    3           FO_OSYMBKEY.NAME=DEVNAME;

   6000  7 000332   040000 100400                    MLR     fill='040'O
         7 000333   000002 000010 1                  ADSC9   DEVNAME                  cn=0,n=8
         7 000334   000000 200010 xsym               ADSC9   FO_OSYMBKEY              cn=1,n=8

      393     6001    3           CALL M$READ (READ_OSYMB) ALTRET(NOWRDEV);

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:52   
   6001  7 000335   000232 630400 6                  EPPR0   READ_OSYMB
         7 000336   440000 713400                    CLIMB   alt,read
         7 000337   401400 401760                    pmme    nvectors=4
         7 000340   000346 702000 7                  TSX2    NOWRDEV

      394     6002    3           FO_OSYMBUF.FO_OSYMBDEV.FORM=FORMNM;

   6002  7 000341   040000 100400                    MLR     fill='040'O
         7 000342   000004 000006 1                  ADSC9   FORMNM                   cn=0,n=6
         7 000343   000015 600006 xsym               ADSC9   FO_OSYMBUF+13            cn=3,n=6

      395     6003                                      /* Write device table entry to :OSYMB
      396     6004                                         in :SYS */
      397     6005    3           CALL WRITE_DEV1;

   6005  7 000344   000572 701000 7                  TSX1    WRITE_DEV1
         7 000345   000000 011000                    NOP     0

   6002  7 000346                       NOWRDEV      null
      398     6006    3   NOWRDEV:;
      399     6007    3           END;

   6007  7 000346   000404 710000 7                  TRA     s:6024

      400     6008    2         ELSE
      401     6009    3           DO;

      402     6010    3           DEV$->FO$DEV.FORM=FORMNM;

   6010  7 000347   000000 470400 xsym               LDP0    FO_DEV$
         7 000350   040100 100400                    MLR     fill='040'O
         7 000351   000004 000006 1                  ADSC9   FORMNM                   cn=0,n=6
         7 000352   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6

      403     6011                                      /* Write :OSYMB.:SYS record */
      404     6012    3           CALL WRITE_DEV (DEV$);

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:53   
   6012  7 000353   000002 236000 8                  LDQ     2
         7 000354   200027 756100                    STQ     FS_WORKAREA$+5,,AUTO
         7 000355   000473 701000 7                  TSX1    WRITE_DEV
         7 000356   000000 011000                    NOP     0

      405     6013    3           DEV$->FO$DEV.FLEN=FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LENGTH;

   6013  7 000357   200010 470500                    LDP0    FORM$,,AUTO
         7 000360   000006 220100                    LDX0    6,,PR0
         7 000361   000777 360003                    ANX0    511,DU
         7 000362   000000 471400 xsym               LDP1    FO_DEV$
         7 000363   100014 740100                    STX0    12,,PR1

      406     6014    3           DEV$->FO$DEV.FLG.ALGNED='0'B;

   6014  7 000364   000003 236000 8                  LDQ     3
         7 000365   100012 356100                    ANSQ    10,,PR1

      407     6015    3           I=FORM$->FS$FORM.ALGNDISP;

   6015  7 000366   000003 236100                    LDQ     3,,PR0
         7 000367   777777 376007                    ANQ     -1,DL
         7 000370   200007 756100                    STQ     I,,AUTO

      408     6016    3           IF I = 0 THEN DEV$->FO$DEV.FLG.AEF='0'B;

   6016  7 000371   000375 601000 7                  TNZ     s:6020

   6016  7 000372   000004 236000 8                  LDQ     4
         7 000373   100012 356100                    ANSQ    10,,PR1
         7 000374   000404 710000 7                  TRA     s:6024

      409     6017    3           ELSE
      410     6018    4             DO;

      411     6019                                      /* Else handle Align Every File */
      412     6020    4             ALIGN$=PINCRW(FORM$,I);
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:54   

   6020  7 000375   000022 736000                    QLS     18
         7 000376   200010 036100                    ADLQ    FORM$,,AUTO
         7 000377   200006 756100                    STQ     ALIGN$,,AUTO

      413     6021    4             DEV$->FO$DEV.FLG.AEF=ALIGN$->FS$FINST.ALIGNCTL.EVERY;

   6021  7 000400   200006 473500                    LDP3    ALIGN$,,AUTO
         7 000401   003100 060500                    CSL     bolr='003'O
         7 000402   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
         7 000403   100012 470001                    BDSC    10,,PR1                  by=2,bit=7,n=1

      414     6022    4             END;

      415     6023    3           END;

      416     6024    2         RETURN;

   6024  7 000404   200024 221300                    LDX1  ! FS_WORKAREA$+2,,AUTO
         7 000405   000001 702211                    TSX2  ! 1,X1

   6016  7 000406                       NOMOUNT      null
      417     6025    2   NOMOUNT: ;
      418     6026    2         IF DEV$ ~= ADDR(NIL) THEN DEV$->FO$DEV.FORM=' ';

   6026  7 000406   000000 236000 xsym               LDQ     FO_DEV$
         7 000407   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 000410   000415 600000 7                  TZE     s:6027

   6026  7 000411   000000 470400 xsym               LDP0    FO_DEV$
         7 000412   040100 100400                    MLR     fill='040'O
         7 000413   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 000414   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6

      419     6027    2         I=B$ERRCODE;

   6027  7 000415   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:55   
         7 000416   000000 471500                    LDP1    0,,PR0
         7 000417   100102 236100                    LDQ     66,,PR1
         7 000420   000003 772000                    QRL     3
         7 000421   037777 376007                    ANQ     16383,DL
         7 000422   200007 756100                    STQ     I,,AUTO

      420     6028    2         IF I = %E$NOSTA THEN KSUBC=FOKE_NODEV#;

   6028  7 000423   001534 116007                    CMPQ    860,DL
         7 000424   000430 601000 7                  TNZ     s:6029

   6028  7 000425   000005 235007                    LDA     5,DL
         7 000426   200020 755100                    STA     KSUBC,,AUTO
         7 000427   000453 710000 7                  TRA     s:6037

      421     6029    2         ELSE IF I = %E$REOPN THEN KSUBC=FOKE_DBUSY#;

   6029  7 000430   001214 116007                    CMPQ    652,DL
         7 000431   000435 601000 7                  TNZ     s:6030

   6029  7 000432   000004 235007                    LDA     4,DL
         7 000433   200020 755100                    STA     KSUBC,,AUTO
         7 000434   000453 710000 7                  TRA     s:6037

      422     6030    2          ELSE IF I = %E$UPNLDT THEN KSUBC=FOKE_DPART#;

   6030  7 000435   001236 116007                    CMPQ    670,DL
         7 000436   000442 601000 7                  TNZ     s:6031

   6030  7 000437   000011 235007                    LDA     9,DL
         7 000440   200020 755100                    STA     KSUBC,,AUTO
         7 000441   000453 710000 7                  TRA     s:6037

      423     6031    2           ELSE IF I = %E$NOTUR THEN KSUBC=FOKE_SILLY#;

   6031  7 000442   001222 116007                    CMPQ    658,DL
         7 000443   000447 601000 7                  TNZ     s:6034
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:56   

   6031  7 000444   000012 235007                    LDA     10,DL
         7 000445   200020 755100                    STA     KSUBC,,AUTO
         7 000446   000453 710000 7                  TRA     s:6037

      424     6032    2            ELSE
      425     6033    3              DO;

      426     6034    3              KSUBC=FOKE_BFALT#;

   6034  7 000447   000007 235007                    LDA     7,DL
         7 000450   200020 755100                    STA     KSUBC,,AUTO

      427     6035    3              OPMSG_MERR.ERRC=I;

   6035  7 000451   000011 736000                    QLS     9
         7 000452   000016 552030 1                  STBQ    OPMSG_MERR+8,'30'O

      428     6036    3              END;

      429     6037    2         OPMSG_MERR.SUBC=KSUBC;

   6037  7 000453   200020 236100                    LDQ     KSUBC,,AUTO
         7 000454   000033 736000                    QLS     27
         7 000455   000014 552040 1                  STBQ    OPMSG_MERR+6,'40'O

      430     6038    2         ALTRETURN;

   6038  7 000456   200024 221300                    LDX1  ! FS_WORKAREA$+2,,AUTO
         7 000457   000000 702211                    TSX2  ! 0,X1

   6037  7 000460                       BADFTYP      null
      431     6039    2   BADFTYP: ;
      432     6040    2         OPMSG_MERR.SUBC=FOKE_BFTYP#;

   6040  7 000460   006000 236003                    LDQ     3072,DU
         7 000461   000014 552040 1                  STBQ    OPMSG_MERR+6,'40'O
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:57   

      433     6041    2         ALTRETURN;

   6041  7 000462   200024 221300                    LDX1  ! FS_WORKAREA$+2,,AUTO
         7 000463   000000 702211                    TSX2  ! 0,X1

      434     6042    2   END MOUNT;
      435     6043        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:58   
      436     6044        /**/
      437     6045        /*F* NAME:         FOR$DEVWR
      438     6046             PURPOSE:      To write a device table entry to :OSYMB
      439     6047             DESCRIPTION:  The device table entry pointed to by FO_DEV$
      440     6048                           is written to :OSYMB.:SYS with the device
      441     6049                           name as the key, if it is a local device. */
      442     6050        /**/
      443     6051    1   FOR$DEVWR: ENTRY ALTRET;

   6051  7 000464   000000 700200 xent  FOR$DEVWR    TSX0  ! X66_AUTO_3
         7 000465   000036 000003                    ZERO    30,3

      444     6052
      445     6053    1         CALL WRITE_DEV (DEV$) ALTRET(ALTRT);

   6053  7 000466   000002 236000 8                  LDQ     2
         7 000467   200027 756100                    STQ     FS_WORKAREA$+5,,AUTO
         7 000470   000473 701000 7                  TSX1    WRITE_DEV
         7 000471   000653 702000 7                  TSX2    ALTRT

      446     6054    1         RETURN;

   6054  7 000472   000000 702200 xent               TSX2  ! X66_ARET

      447     6055
      448     6056    1   WRITE_DEV: PROC (DEV$) ALTRET;

   6056  7 000473   200026 741300       WRITE_DEV    STX1  ! FS_WORKAREA$+4,,AUTO

      449     6057        /**/
      450     6058    2   DCL DEV$ PTR;
      451     6059    2   DCL WSN$ PTR;
      452     6060    2   DCL OSYMB$ PTR;
      453     6061        %FO_DEV (FPTN=DEV,STCLASS=BASED);
      454     6160        %FO_WSN (FPTN=FO$WSN,STCLASS=BASED);
      455     6198        /**/
      456     6199
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:59   
      457     6200    2         IF DEV$ -> DEV.FLG.LOCAL THEN

   6200  7 000474   200027 470500                    LDP0    @FO_DEV$,,AUTO
         7 000475   000000 471500                    LDP1    0,,PR0
         7 000476   100012 236100                    LDQ     10,,PR1
         7 000477   040000 316007                    CANQ    16384,DL
         7 000500   000566 600000 7                  TZE     RTN

      458     6201    3           DO;

      459     6202    3           FO_OSYMBKEY.NAME=DEV$ -> DEV.NAME;

   6202  7 000501   040000 100500                    MLR     fill='040'O
         7 000502   100005 000010                    ADSC9   5,,PR1                   cn=0,n=8
         7 000503   000000 200010 xsym               ADSC9   FO_OSYMBKEY              cn=1,n=8

      460     6203    3           FO_OSYMBUF.FO_OSYMBDEV=DEV$ -> DEV;

   6203  7 000504   000000 471500                    LDP1    0,,PR0
         7 000505   000000 100500                    MLR     fill='000'O
         7 000506   100000 000111                    ADSC9   0,,PR1                   cn=0,n=73
         7 000507   000000 000111 xsym               ADSC9   FO_OSYMBUF               cn=0,n=73

      461     6204    3           WSN$ = DEV$ -> FO$DEV.WSN$;

   6204  7 000510   000000 471500                    LDP1    0,,PR0
         7 000511   100004 236100                    LDQ     4,,PR1
         7 000512   200030 756100                    STQ     WSN$,,AUTO

      462     6205    3           FO_OSYMBUF.FO_OSYMBWSN.NWSNS = 0;

   6205  7 000513   000024 450000 xsym               STZ     FO_OSYMBUF+20

      463     6206    4             DO WHILE (WSN$ ~= ADDR(NIL));

   6206  7 000514   000545 710000 7                  TRA     s:6213

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:60   
      464     6207    5               DO I = 0 TO (WSN$ -> FO$WSN.NWSNS - 1);

   6207  7 000515   200007 450100                    STZ     I,,AUTO
         7 000516   000537 710000 7                  TRA     s:6211+3

      465     6208    5               FO_OSYMBUF.FO_OSYMBWSN.WSN (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)

   6208  7 000517   200007 236100                    LDQ     I,,AUTO
         7 000520   000011 402007                    MPY     9,DL
         7 000521   200032 756100                    STQ     WSN$+2,,AUTO
         7 000522   000024 236000 xsym               LDQ     FO_OSYMBUF+20
         7 000523   000011 402007                    MPY     9,DL
         7 000524   200030 470500                    LDP0    WSN$,,AUTO
         7 000525   200032 235100                    LDA     WSN$+2,,AUTO
         7 000526   000006 100505                    MLR     fill='000'O
         7 000527   000002 000011                    ADSC9   2,A,PR0                  cn=0,n=9
         7 000530   000025 000011 xsym               ADSC9   FO_OSYMBUF+21,Q          cn=0,n=9

      466     6209    5               = WSN$ -> FO$WSN.WSN (I);
      467     6210    5               FO_OSYMBUF.FO_OSYMBWSN.NWSNS = FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1;

   6210  7 000531   000024 235000 xsym               LDA     FO_OSYMBUF+20
         7 000532   000001 035007                    ADLA    1,DL
         7 000533   000024 755000 xsym               STA     FO_OSYMBUF+20

      468     6211    5               END;

   6211  7 000534   200007 236100                    LDQ     I,,AUTO
         7 000535   000001 036007                    ADLQ    1,DL
         7 000536   200007 756100                    STQ     I,,AUTO
         7 000537   200030 470500                    LDP0    WSN$,,AUTO
         7 000540   200007 236100                    LDQ     I,,AUTO
         7 000541   000001 116100                    CMPQ    1,,PR0
         7 000542   000517 602000 7                  TNC     s:6208

      469     6212    4             WSN$ = WSN$ -> FO$WSN.LNK$;

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:61   
   6212  7 000543   000000 236100                    LDQ     0,,PR0
         7 000544   200030 756100                    STQ     WSN$,,AUTO

      470     6213    4             END;

   6213  7 000545   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 000546   000515 601000 7                  TNZ     s:6207

      471     6214    3           WRITE_OSYMB.BUF_.BOUND = LENGTHC (DEV)

   6214  7 000547   000024 236000 xsym               LDQ     FO_OSYMBUF+20
         7 000550   000012 402007                    MPY     10,DL
         7 000551   000133 036007                    ADLQ    91,DL
         7 000552   000020 736000                    QLS     16
         7 000553   000074 676000 1                  ERQ     WRITE_OSYMB+4
         7 000554   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 000555   000074 656000 1                  ERSQ    WRITE_OSYMB+4

      472     6215    3           + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      473     6216    3           + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      474     6217    3           + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      475     6218    3           CALL M$WRITE (WRITE_OSYMB) ALTRET(ALTRT);

   6218  7 000556   000070 630400 1                  EPPR0   WRITE_OSYMB
         7 000557   440001 713400                    CLIMB   alt,write
         7 000560   401400 401760                    pmme    nvectors=4
         7 000561   000570 702000 7                  TSX2    ALTRT

      476     6219    3           CALL M$TRUNC (TRUNC_OSYMB) ALTRET(RTN);

   6219  7 000562   000222 630400 6                  EPPR0   TRUNC_OSYMB
         7 000563   450003 713400                    CLIMB   alt,+20483
         7 000564   400000 401760                    pmme    nvectors=1
         7 000565   000566 702000 7                  TSX2    RTN

      477     6220    3           END;

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:62   
   6217  7 000566                       RTN          null
      478     6221    2   RTN:  ;
      479     6222    2         RETURN;

   6222  7 000566   200026 221300                    LDX1  ! FS_WORKAREA$+4,,AUTO
         7 000567   000001 702211                    TSX2  ! 1,X1

   6217  7 000570                       ALTRT        null
      480     6223    2   ALTRT:;
      481     6224    2         ALTRETURN;

   6224  7 000570   200026 221300                    LDX1  ! FS_WORKAREA$+4,,AUTO
         7 000571   000000 702211                    TSX2  ! 0,X1

      482     6225    2   END WRITE_DEV;
      483     6226        /**/
      484     6227    1   WRITE_DEV1: PROC ALTRET;

   6227  7 000572   200026 741300       WRITE_DEV1   STX1  ! FS_WORKAREA$+4,,AUTO

      485     6228
      486     6229    2   DCL WSN$ PTR;
      487     6230    2   DCL OSYMB$ PTR;
      488     6231        %FO_DEV (FPTN=DEV,STCLASS=BASED);
      489     6330        %FO_WSN (FPTN=FO$WSN,STCLASS=BASED);
      490     6368
      491     6369    2         IF FO_OSYMBUF.FO_OSYMBDEV.FLG.LOCAL

   6369  7 000573   000012 236000 xsym               LDQ     FO_OSYMBUF+10
         7 000574   040000 316007                    CANQ    16384,DL
         7 000575   000620 600000 7                  TZE     RTN1

      492     6370    3         THEN DO;

      493     6371    3           FO_OSYMBKEY.NAME = FO_OSYMBUF.FO_OSYMBDEV.NAME;

   6371  7 000576   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:63   
         7 000577   000005 000010 xsym               ADSC9   FO_OSYMBUF+5             cn=0,n=8
         7 000600   000000 200010 xsym               ADSC9   FO_OSYMBKEY              cn=1,n=8

      494     6372    3           WRITE_OSYMB.BUF_.BOUND = LENGTHC (DEV)

   6372  7 000601   000024 236000 xsym               LDQ     FO_OSYMBUF+20
         7 000602   000012 402007                    MPY     10,DL
         7 000603   000133 036007                    ADLQ    91,DL
         7 000604   000020 736000                    QLS     16
         7 000605   000074 676000 1                  ERQ     WRITE_OSYMB+4
         7 000606   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 000607   000074 656000 1                  ERSQ    WRITE_OSYMB+4

      495     6373    3           + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.LNK$)
      496     6374    3           + LENGTHC (FO_OSYMBUF.FO_OSYMBWSN.NWSNS)
      497     6375    3           + ( 10 * (FO_OSYMBUF.FO_OSYMBWSN.NWSNS + 1));
      498     6376    3           CALL M$WRITE (WRITE_OSYMB) ALTRET (ALTRT1);

   6376  7 000610   000070 630400 1                  EPPR0   WRITE_OSYMB
         7 000611   440001 713400                    CLIMB   alt,write
         7 000612   401400 401760                    pmme    nvectors=4
         7 000613   000622 702000 7                  TSX2    ALTRT1

      499     6377    3           CALL M$TRUNC (TRUNC_OSYMB) ALTRET (RTN1);

   6377  7 000614   000222 630400 6                  EPPR0   TRUNC_OSYMB
         7 000615   450003 713400                    CLIMB   alt,+20483
         7 000616   400000 401760                    pmme    nvectors=1
         7 000617   000620 702000 7                  TSX2    RTN1

      500     6378    3           END;

   6375  7 000620                       RTN1         null
      501     6379    2   RTN1: ;
      502     6380    2         RETURN;

   6380  7 000620   200026 221300                    LDX1  ! FS_WORKAREA$+4,,AUTO
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:64   
         7 000621   000001 702211                    TSX2  ! 1,X1

   6375  7 000622                       ALTRT1       null
      503     6381    2   ALTRT1:;
      504     6382    2         ALTRETURN;

   6382  7 000622   200026 221300                    LDX1  ! FS_WORKAREA$+4,,AUTO
         7 000623   000000 702211                    TSX2  ! 0,X1

      505     6383    2   END WRITE_DEV1;
      506     6384        /**/
      507     6385        /*F* NAME:         FOR$CLOSE
      508     6386             PURPOSE:      To close the :FORM file. */
      509     6387        /**/
      510     6388    1   FOR$CLOSE: ENTRY ALTRET;

   6388  7 000624   000000 700200 xent  FOR$CLOSE    TSX0  ! X66_AUTO_3
         7 000625   000036 000003                    ZERO    30,3

      511     6389
      512     6390    1         CALL M$CLOSE (CLOSE_FORM) ALTRET(ALTRT);

   6390  7 000626   000076 630400 6                  EPPR0   CLOSE_FORM
         7 000627   450001 713400                    CLIMB   alt,close
         7 000630   406000 401760                    pmme    nvectors=13
         7 000631   000653 702000 7                  TSX2    ALTRT

      513     6391    1         RETURN;

   6391  7 000632   000000 702200 xent               TSX2  ! X66_ARET

      514     6392        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:65   
      515     6393        /**/
      516     6394        /*F* NAME:         FOR$TCHK
      517     6395             PURPOSE:      To check that a form is legal at a TERMINAL
      518     6396             DESCRIPTION:  Reads the forms file record for the given
      519     6397                           form, and uses FOT$TCHK to validate the
      520     6398                           access. ALTRETs if not allowed, else returns. */
      521     6399        /**/
      522     6400    1   FOR$TCHK: ENTRY (FORMNAME,WSN) ALTRET;

   6400  7 000633   000000 700200 xent  FOR$TCHK     TSX0  ! X66_AUTO_3
         7 000634   000036 000003                    ZERO    30,3

      523     6401        /**/
      524     6402
      525     6403    1         FORMKEY.NAME=FORMNAME;

   6403  7 000635   200003 470500                    LDP0    @FORMNAME,,AUTO
         7 000636   040000 100500                    MLR     fill='040'O
         7 000637   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         7 000640   000000 200006 1                  ADSC9   FORMKEY                  cn=1,n=6

      526     6404                                      /* Read :FORM */
      527     6405    1         CALL READREC ALTRET(ALTRT);

   6405  7 000641   000654 701000 7                  TSX1    READREC
         7 000642   000653 702000 7                  TSX2    ALTRT

      528     6406    1         CALL FOT$TCHK (ADDR(FO_FITBUF1)->FS$FORM,WSN) ALTRET(ALTRT);

   6406  7 000643   200004 236100                    LDQ     @WSN,,AUTO
         7 000644   000005 235000 8                  LDA     5
         7 000645   200032 757100                    STAQ    WSN$+2,,AUTO
         7 000646   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 000647   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000650   000000 701000 xent               TSX1    FOT$TCHK
         7 000651   000653 702000 7                  TSX2    ALTRT

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:66   
      529     6407    1         RETURN;

   6407  7 000652   000000 702200 xent               TSX2  ! X66_ARET

   6403  7 000653                       ALTRT        null
      530     6408    1   ALTRT:;
      531     6409    1         ALTRETURN;

   6409  7 000653   000000 702200 xent               TSX2  ! X66_AALT

      532     6410
      533     6411
      534     6412        /*D* NAME:         READREC
      535     6413             PURPOSE:      To read the :FORM record for form FORMKEY.NAME
      536     6414             DESCRIPTION:  Reads it into FO_FITBUF1.  ALTRETs if error
      537     6415                           on read or open.  SCREECHes if :FORM file
      538     6416                           is broken. Returns FORM$=record address. */
      539     6417    1   READREC: PROC ALTRET;

   6417  7 000654   200024 741300       READREC      STX1  ! FS_WORKAREA$+2,,AUTO

      540     6418    2         FORM$=ADDR(FO_FITBUF1);

   6418  7 000655   000005 236000 8                  LDQ     5
         7 000656   200010 756100                    STQ     FORM$,,AUTO
         7 000657   000661 710000 7                  TRA     TRYOPN

      541     6419        /*D* NAME:         READREC1
      542     6420             PURPOSE:      To read a :FORM record
      543     6421             DESCRIPTION:  Same as READREC, but FORM$ points to caller's
      544     6422                           buffer. */
      545     6423    2   READREC1: ENTRY ALTRET;

   6423  7 000660   200024 741300       READREC1     STX1  ! FS_WORKAREA$+2,,AUTO

   6418  7 000661                       TRYOPN       null
      546     6424    2   TRYOPN:;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:67   
      547     6425    2         IF DCBADDR(DCBNUM(M$FORM))->F$DCB.FCD = '0'B THEN

   6425  7 000661   000000 236007 xsym               LDQ     M$FORM,DL
         7 000662   000006 470400 8                  LDP0    6
         7 000663   000000 471500                    LDP1    0,,PR0
         7 000664   100000 473506                    LDP3    0,QL,PR1
         7 000665   300031 236100                    LDQ     25,,PR3
         7 000666   020000 316007                    CANQ    8192,DL
         7 000667   000674 601000 7                  TNZ     s:6428

      548     6426                                      /* Open :FORM */
      549     6427    2          CALL M$OPEN (OPEN_FORM) ALTRET(NOOPN);

   6427  7 000670   000000 630400 6                  EPPR0   OPEN_FORM
         7 000671   450000 713400                    CLIMB   alt,open
         7 000672   410400 401760                    pmme    nvectors=18
         7 000673   000713 702000 7                  TSX2    NOOPN

      550     6428    2         READ_FORM.BUF_=VECTOR(FORM$->B$$FORMR);

   6428  7 000674   000007 235000 8                  LDA     7
         7 000675   200010 236100                    LDQ     FORM$,,AUTO
         7 000676   000056 757000 1                  STAQ    READ_FORM+4

      551     6429    2         CALL M$READ (READ_FORM) ALTRET(ALTRT);

   6429  7 000677   000052 630400 1                  EPPR0   READ_FORM
         7 000700   440000 713400                    CLIMB   alt,read
         7 000701   401400 401760                    pmme    nvectors=4
         7 000702   000711 702000 7                  TSX2    ALTRT

      552     6430                                      /* Force (physically) the cleaning of
      553     6431                                         buffers for DCB M$FORM */
      554     6432    2         CALL M$TRUNC (TRUNC_FORM) ALTRET(RTN);

   6432  7 000703   000226 630400 6                  EPPR0   TRUNC_FORM
         7 000704   450003 713400                    CLIMB   alt,+20483
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:68   
         7 000705   400000 401760                    pmme    nvectors=1
         7 000706   000707 702000 7                  TSX2    RTN

   6428  7 000707                       RTN          null
      555     6433    2   RTN:  ;
      556     6434    2         RETURN;

   6434  7 000707   200024 221300                    LDX1  ! FS_WORKAREA$+2,,AUTO
         7 000710   000001 702211                    TSX2  ! 1,X1

   6428  7 000711                       ALTRT        null
      557     6435    2   ALTRT:;
      558     6436    2         ALTRETURN;

   6436  7 000711   200024 221300                    LDX1  ! FS_WORKAREA$+2,,AUTO
         7 000712   000000 702211                    TSX2  ! 0,X1

   6428  7 000713                       NOOPN        null
      559     6437    2   NOOPN:;
      560     6438    2         IF B$ERRCODE = %E$FILEBUSY

   6438  7 000713   000000 470400 xsym               LDP0    B$TCB$
         7 000714   000000 471500                    LDP1    0,,PR0
         7 000715   100102 236100                    LDQ     66,,PR1
         7 000716   377770 376007                    ANQ     131064,DL
         7 000717   001550 116007                    CMPQ    872,DL
         7 000720   000723 600000 7                  TZE     s:6441
         7 000721   001610 116007                    CMPQ    904,DL
         7 000722   000727 601000 7                  TNZ     s:6444

      561     6439    2         OR B$ERRCODE = %E$NOFILE THEN
      562     6440    3           DO;

      563     6441    3           CALL M$WAIT (SLEEP1);

   6441  7 000723   000250 630400 6                  EPPR0   SLEEP1
         7 000724   020006 713400                    CLIMB   8198
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:69   
         7 000725   400400 401760                    pmme    nvectors=2

      564     6442    3           GOTO TRYOPN;

   6442  7 000726   000661 710000 7                  TRA     TRYOPN

      565     6443    3           END;
      566     6444    2         CALL FOI$CRASHGO (%S$FOBFORM,F_FO,M_R);

   6444  7 000727   000013 630400 8                  EPPR0   11
         7 000730   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 000731   000000 701000 xent               TSX1    FOI$CRASHGO
         7 000732   000000 011000                    NOP     0

      567     6445        /*S* SCREECH_CODE: FOR-S$FOBFORM
      568     6446             TYPE:         SCREECH
      569     6447             MESSAGE:      OUTSYM - :FORM.:SYS is broken
      570     6448             REMARKS:      OUTSYM has tried to open :FORM.:SYS and has got
      571     6449                           an error other than busy/nofile.  This SCREECH
      572     6450                           should result in SLUG deleting the appropriate
      573     6451                           files on the way up, and causing them to be
      574     6452                           rebuilt. */
      575     6453    2         ALTRETURN;

   6453  7 000733   200024 221300                    LDX1  ! FS_WORKAREA$+2,,AUTO
         7 000734   000000 702211                    TSX2  ! 0,X1

      576     6454    2   END READREC;
      577     6455        %EJECT;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:70   
      578     6456        /**/
      579     6457        /*F* NAME:         FOR$SALIGN
      580     6458             PURPOSE:      To commence building the alignment image for
      581     6459                           a symbiont device.
      582     6460        */
      583     6461                                      /* Initialize granule,
      584     6462                                         Add alignment info (from :FORM rec),
      585     6463                                         Print banner */
      586     6464    1   FOR$SALIGN: ENTRY (FORMNAME,WSN) ALTRET;

   6464  7 000735   000000 700200 xent  FOR$SALIGN   TSX0  ! X66_AUTO_3
         7 000736   000036 000003                    ZERO    30,3

      587     6465
      588     6466                           /* WSN IS ALSTAT */
      589     6467
      590     6468    1         FORMKEY.NAME=DEV$->FO$DEV.FORM;

   6468  7 000737   000000 470400 xsym               LDP0    FO_DEV$
         7 000740   040000 100500                    MLR     fill='040'O
         7 000741   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6
         7 000742   000000 200006 1                  ADSC9   FORMKEY                  cn=1,n=6

      591     6469                                      /* Set pointer to device's alignment
      592     6470                                         record */
      593     6471    1         FORM$=DEV$->FO$DEV.ALR$;

   6471  7 000743   000003 236100                    LDQ     3,,PR0
         7 000744   200010 756100                    STQ     FORM$,,AUTO

      594     6472                                      /* Read :FORM with FORMKEY.NAME to get
      595     6473                                         VFU image for device */
      596     6474    1         CALL READREC1 ALTRET(SAL0);

   6474  7 000745   000660 701000 7                  TSX1    READREC1
         7 000746   000750 702000 7                  TSX2    SAL0

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:71   
      597     6475    1         GOTO SAL1;

   6475  7 000747   000772 710000 7                  TRA     SAL1

   6471  7 000750                       SAL0         null
      598     6476    1   SAL0: ;
      599     6477    1         IF DEV$->FO$DEV.FORM = 'STDLP' THEN ALSTAT.STAT=FOAS_NTTD#;

   6477  7 000750   000000 470400 xsym               LDP0    FO_DEV$
         7 000751   040000 106500                    CMPC    fill='040'O
         7 000752   000015 600006                    ADSC9   13,,PR0                  cn=3,n=6
         7 000753   000257 000005 6                  ADSC9   TABVFC+1                 cn=0,n=5
         7 000754   000760 601000 7                  TNZ     s:6480

   6477  7 000755   200004 471500                    LDP1    @WSN,,AUTO
         7 000756   100000 450100                    STZ     0,,PR1
         7 000757   000771 710000 7                  TRA     s:6483

      600     6478    1         ELSE
      601     6479    2           DO;

      602     6480    2           ALSTAT.STAT=FOAS_FERR#;

   6480  7 000760   000002 235007                    LDA     2,DL
         7 000761   200004 471500                    LDP1    @WSN,,AUTO
         7 000762   100000 755100                    STA     0,,PR1

      603     6481    2           ALSTAT.ERRC=B$ERRCODE;

   6481  7 000763   000000 470400 xsym               LDP0    B$TCB$
         7 000764   000000 473500                    LDP3    0,,PR0
         7 000765   300102 236100                    LDQ     66,,PR3
         7 000766   000003 772000                    QRL     3
         7 000767   037777 376007                    ANQ     16383,DL
         7 000770   100001 756100                    STQ     1,,PR1

      604     6482    2           END;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:72   

      605     6483    1         ALTRETURN;

   6483  7 000771   000000 702200 xent               TSX2  ! X66_AALT

   6477  7 000772                       SAL1         null
      606     6484    1   SAL1: ;
      607     6485    1         CALL ALSET;

   6485  7 000772   001367 701000 7                  TSX1    ALSET
         7 000773   000000 011000                    NOP     0

      608     6486    1         IF DEV$ -> FO$DEV.FLG.MODE = FOMD_GRAPHIC#

   6486  7 000774   000000 470400 xsym               LDP0    FO_DEV$
         7 000775   000012 236100                    LDQ     10,,PR0
         7 000776   000004 316003                    CANQ    4,DU
         7 000777   001022 600000 7                  TZE     s:6501

      609     6487    2         THEN DO;

      610     6488    2           WRSP$ -> FS$GWRSP.START = 0;

   6488  7 001000   200013 471500                    LDP1    WRSP$,,AUTO
         7 001001   100000 450100                    STZ     0,,PR1

      611     6489    2           WRSP$ -> FS$GWRSP.ENTDISP = FORM$ -> FS$FORM.ALGNDISP;

   6489  7 001002   200010 470500                    LDP0    FORM$,,AUTO
         7 001003   000003 236100                    LDQ     3,,PR0
         7 001004   777777 376007                    ANQ     -1,DL
         7 001005   100022 756100                    STQ     18,,PR1

      612     6490    2           GPARM.VFCR = '0'B;

   6490  7 001006   000000 236003                    LDQ     0,DU
         7 001007   200017 552140                    STBQ    GPARM+2,'40'O,AUTO
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:73   

      613     6491    2           FS_WORKAREA$ = PINCRW(WRSP$,LENGTHW(FS$GWRSP));

   6491  7 001010   200013 236100                    LDQ     WRSP$,,AUTO
         7 001011   000025 036003                    ADLQ    21,DU
         7 001012   200022 756100                    STQ     FS_WORKAREA$,,AUTO

      614     6492    2           GPARM.REC$ = PINCRW(FS_WORKAREA$,LENGTHW(FS$WORKAUTO));

   6492  7 001013   000101 036003                    ADLQ    65,DU
         7 001014   200016 756100                    STQ     GPARM+1,,AUTO

      615     6493    2           START_GRAFBAN = '1'B;

   6493  7 001015   400000 236003                    LDQ     -131072,DU
         7 001016   200011 756100                    STQ     START_GRAFBAN,,AUTO

      616     6494    2           WRSP$ ->FS$GWRSP.DATE_TIME = ENTADDR(NIL);

   6494  7 001017   000002 236000 xsym               LDQ     B_VECTNIL+2
         7 001020   100024 756100                    STQ     20,,PR1

      617     6495    2           GOTO GAL2;

   6495  7 001021   001302 710000 7                  TRA     GAL2

      618     6496    2           END;
      619     6497                                           /* Non-graphics devices here */
      620     6498    2         ELSE DO;

      621     6499                           /* Stick in VFU image */
      622     6500                                      /* WRSP$ = FORM$ + 2048 */
      623     6501    2           WRSP$->FS$WRSP.WIDTH=FORM$->FS$FORM.SOFTFORM.VLPPLATEN.WIDTH;

   6501  7 001022   200010 471500                    LDP1    FORM$,,AUTO
         7 001023   200013 473500                    LDP3    WRSP$,,AUTO
         7 001024   100006 236100                    LDQ     6,,PR1
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:74   
         7 001025   000033 772000                    QRL     27
         7 001026   300022 756100                    STQ     18,,PR3

      624     6502                                           /**/
      625     6503                                           /* Kludge so URPs aligns properly */
      626     6504                                           /**/
      627     6505    2           FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LENGTH =

   6505  7 001027   100006 236100                    LDQ     6,,PR1
         7 001030   000011 772000                    QRL     9
         7 001031   000777 376007                    ANQ     511,DL
         7 001032   200032 756100                    STQ     WSN$+2,,AUTO
         7 001033   100006 236100                    LDQ     6,,PR1
         7 001034   000022 772000                    QRL     18
         7 001035   000777 376007                    ANQ     511,DL
         7 001036   200032 036100                    ADLQ    WSN$+2,,AUTO
         7 001037   000022 736000                    QLS     18
         7 001040   100006 552120                    STBQ    6,'20'O,PR1

      628     6506    2           FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LENGTH +
      629     6507    2           FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LIMBO;
      630     6508    2           FORM$->FS$FORM.SOFTFORM.VLPPLATEN.LIMBO = 0;

   6508  7 001041   000000 236003                    LDQ     0,DU
         7 001042   100006 552110                    STBQ    6,'10'O,PR1

      631     6509    2           GPARM.REC$=ADDR(FORM$->FS$FORM.SOFTFORM);

   6509  7 001043   200010 236100                    LDQ     FORM$,,AUTO
         7 001044   000016 036000 8                  ADLQ    14
         7 001045   200016 756100                    STQ     GPARM+1,,AUTO

      632     6510    2           GPARM.RECL=LENGTHC(FS$FORM.SOFTFORM);

   6510  7 001046   124000 236007                    LDQ     43008,DL
         7 001047   200017 552110                    STBQ    GPARM+2,'10'O,AUTO

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:75   
      633     6511    2           GPARM.VFC=%VFC_VFU;

   6511  7 001050   033000 236003                    LDQ     13824,DU
         7 001051   200017 552140                    STBQ    GPARM+2,'40'O,AUTO

      634     6512                                      /* Initialize granule, then add a record */
      635     6513    2           CALL FOG$BLD (GPARM);

   6513  7 001052   200015 634500                    EPPR4   GPARM,,AUTO
         7 001053   200032 454500                    STP4    WSN$+2,,AUTO
         7 001054   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001056   000000 701000 xent               TSX1    FOG$BLD
         7 001057   000000 011000                    NOP     0

      636     6514                           /* Stick in chain image */
      637     6515                                           /**/
      638     6516                                           /* On local printers, the firmware
      639     6517                                              holds onto and handles this info.
      640     6518                                              On FEP printers, the FEP does it. */
      641     6519                                           /**/
      642     6520    2           IF  DEV$->FO$DEV.FLG.LOCAL

   6520  7 001060   000000 470400 xsym               LDP0    FO_DEV$
         7 001061   000012 236100                    LDQ     10,,PR0
         7 001062   040000 316007                    CANQ    16384,DL
         7 001063   001101 600000 7                  TZE     s:6529

      643     6521    3           THEN DO;

      644     6522    3             GPARM.REC$=ADDR(FORM$->FS$FORM.CHAINIMAGE);

   6522  7 001064   200010 236100                    LDQ     FORM$,,AUTO
         7 001065   000017 036000 8                  ADLQ    15
         7 001066   200016 756100                    STQ     GPARM+1,,AUTO

      645     6523    3             GPARM.RECL=LENGTHC(FORM$->FS$FORM.CHAINIMAGE);
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:76   

   6523  7 001067   360000 236007                    LDQ     122880,DL
         7 001070   200017 552110                    STBQ    GPARM+2,'10'O,AUTO

      646     6524    3             GPARM.VFC=%VFC_LCHN;

   6524  7 001071   034000 236003                    LDQ     14336,DU
         7 001072   200017 552140                    STBQ    GPARM+2,'40'O,AUTO

      647     6525                                      /* ADD a record (chain image) into
      648     6526                                         granule */
      649     6527    3             CALL FOG$ADD (GPARM);

   6527  7 001073   200015 631500                    EPPR1   GPARM,,AUTO
         7 001074   200032 451500                    STP1    WSN$+2,,AUTO
         7 001075   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001077   000000 701000 xent               TSX1    FOG$ADD
         7 001100   000000 011000                    NOP     0

      650     6528    3             END;

      651     6529    2           IF FORM$->FS$FORM.ALGNDISP = 0 THEN

   6529  7 001101   200010 470500                    LDP0    FORM$,,AUTO
         7 001102   000003 720100                    LXL0    3,,PR0
         7 001103   001110 601000 7                  TNZ     s:6541

      652     6530    3             DO;

      653     6531                                      /* Set the alignment state */
      654     6532    3             ALSTAT.STAT=FOAS_JVFU#;

   6532  7 001104   000005 235007                    LDA     5,DL
         7 001105   200004 471500                    LDP1    @WSN,,AUTO
         7 001106   100000 755100                    STA     0,,PR1

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:77   
      655     6533    3             RETURN;

   6533  7 001107   000000 702200 xent               TSX2  ! X66_ARET

      656     6534    3             END;
      657     6535                                           /**/
      658     6536                                           /* Place a zero tab record in
      659     6537                                              the align granule.  This must
      660     6538                                              be a transparent write. */
      661     6539                                           /**/
      662     6540                                           /**/
      663     6541    2           GPARM.REC$ = ADDR (ZERO_TABS);

   6541  7 001110   000020 236000 8                  LDQ     16
         7 001111   200016 756100                    STQ     GPARM+1,,AUTO

      664     6542    2           GPARM.RECL = SIZEC (ZERO_TABS);

   6542  7 001112   040000 236007                    LDQ     16384,DL
         7 001113   200017 552110                    STBQ    GPARM+2,'10'O,AUTO

      665     6543    2           GPARM.DVBYTE = GPARM.DVBYTE | %DVBYTE_TRANS#;

   6543  7 001114   200017 236100                    LDQ     GPARM+2,,AUTO
         7 001115   000011 736000                    QLS     9
         7 001116   777000 376003                    ANQ     -512,DU
         7 001117   020000 276003                    ORQ     8192,DU
         7 001120   000011 772000                    QRL     9
         7 001121   200017 552120                    STBQ    GPARM+2,'20'O,AUTO

      666     6544    2           GPARM.VFCR = TABVFC;

   6544  7 001122   000256 236000 6                  LDQ     TABVFC
         7 001123   200017 552140                    STBQ    GPARM+2,'40'O,AUTO

      667     6545    2           CALL FOG$ADD (GPARM);

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:78   
   6545  7 001124   200015 631500                    EPPR1   GPARM,,AUTO
         7 001125   200032 451500                    STP1    WSN$+2,,AUTO
         7 001126   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001127   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001130   000000 701000 xent               TSX1    FOG$ADD
         7 001131   000000 011000                    NOP     0

      668     6546    2           GPARM.DVBYTE = GPARM.DVBYTE & (~(%DVBYTE_TRANS#));

   6546  7 001132   200017 236100                    LDQ     GPARM+2,,AUTO
         7 001133   000011 736000                    QLS     9
         7 001134   777000 376003                    ANQ     -512,DU
         7 001135   757000 376003                    ANQ     -8704,DU
         7 001136   000011 772000                    QRL     9
         7 001137   200017 552120                    STBQ    GPARM+2,'20'O,AUTO

      669     6547    2           GPARM.DVBYTE = GPARM.DVBYTE | %DVBYTE_BP#;

   6547  7 001140   200017 236100                    LDQ     GPARM+2,,AUTO
         7 001141   000011 736000                    QLS     9
         7 001142   777000 376003                    ANQ     -512,DU
         7 001143   200000 276003                    ORQ     65536,DU
         7 001144   000011 772000                    QRL     9
         7 001145   200017 552120                    STBQ    GPARM+2,'20'O,AUTO

      670     6548    2           WRSP$->FS$WRSP.START=0;

   6548  7 001146   200013 470500                    LDP0    WRSP$,,AUTO
         7 001147   000000 450100                    STZ     0,,PR0

      671     6549    2           GPARM.VFCR='0'B;

   6549  7 001150   000000 236003                    LDQ     0,DU
         7 001151   200017 552140                    STBQ    GPARM+2,'40'O,AUTO

      672     6550    2           FS_WORKAREA$=PINCRW(WRSP$,LENGTHW(FS$WRSP));

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:79   
   6550  7 001152   200013 236100                    LDQ     WRSP$,,AUTO
         7 001153   000024 036003                    ADLQ    20,DU
         7 001154   200022 756100                    STQ     FS_WORKAREA$,,AUTO

      673     6551    2           GPARM.REC$=PINCRW(FS_WORKAREA$,LENGTHW(FS$WORKAUTO));

   6551  7 001155   000101 036003                    ADLQ    65,DU
         7 001156   200016 756100                    STQ     GPARM+1,,AUTO

      674     6552    2           GOTO SAL2;

   6552  7 001157   001205 710000 7                  TRA     SAL2

      675     6553    2           END;
      676     6554
      677     6555        /*F* NAME:         FOR$CALIGN
      678     6556             PURPOSE:      To continue building the alignment image for
      679     6557                           a symbiont device.
      680     6558        */
      681     6559    1   FOR$CALIGN: ENTRY (FORMNAME,WSN) ALTRET;

   6559  7 001160   000000 700200 xent  FOR$CALIGN   TSX0  ! X66_AUTO_3
         7 001161   000036 000003                    ZERO    30,3

      682     6560
      683     6561                           /* WSN IS ALSTAT */
      684     6562
      685     6563    1         FORM$=DEV$->FO$DEV.ALR$;

   6563  7 001162   000000 470400 xsym               LDP0    FO_DEV$
         7 001163   000003 236100                    LDQ     3,,PR0
         7 001164   200010 756100                    STQ     FORM$,,AUTO

      686     6564    1         CALL ALSET;

   6564  7 001165   001367 701000 7                  TSX1    ALSET
         7 001166   000000 011000                    NOP     0
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:80   

      687     6565    1         CALL FOG$GRAN (GPARM);

   6565  7 001167   200015 630500                    EPPR0   GPARM,,AUTO
         7 001170   200032 450500                    STP0    WSN$+2,,AUTO
         7 001171   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001173   000000 701000 xent               TSX1    FOG$GRAN
         7 001174   000000 011000                    NOP     0

      688     6566    1         GPARM.VFCR='0'B;

   6566  7 001175   000000 236003                    LDQ     0,DU
         7 001176   200017 552140                    STBQ    GPARM+2,'40'O,AUTO

      689     6567    1         FS_WORKAREA$=PINCRW(WRSP$,LENGTHW(FS$WRSP));

   6567  7 001177   200013 236100                    LDQ     WRSP$,,AUTO
         7 001200   000024 036003                    ADLQ    20,DU
         7 001201   200022 756100                    STQ     FS_WORKAREA$,,AUTO

      690     6568    1         GPARM.REC$=PINCRW(FS_WORKAREA$,LENGTHW(FS$WORKAUTO));

   6568  7 001202   000101 036003                    ADLQ    65,DU
         7 001203   200016 756100                    STQ     GPARM+1,,AUTO

      691     6569    1         GOTO SAL3;

   6569  7 001204   001227 710000 7                  TRA     SAL3

   6568  7 001205                       SAL2         null
      692     6570    1   SAL2: ;
      693     6571                                      /* Call this continuously until banner
      694     6572                                         is completed */
      695     6573    1         CALL FSK$BANNER (FINST$->FS$FINST,

   6573  7 001205   200022 236100                    LDQ     FS_WORKAREA$,,AUTO
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:81   
         7 001206   200016 235100                    LDA     GPARM+1,,AUTO
         7 001207   200034 757100                    STAQ    WSN$+4,,AUTO
         7 001210   200013 236100                    LDQ     WRSP$,,AUTO
         7 001211   200014 235100                    LDA     FINST$,,AUTO
         7 001212   200032 757100                    STAQ    WSN$+2,,AUTO
         7 001213   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001214   000022 631400 xsym               EPPR1   B_VECTNIL+18
         7 001215   000000 701000 xent               TSX1    FSK$BANNER
         7 001216   001246 702000 7                  TSX2    SAL5

      696     6574    1         WRSP$->FS$WRSP,
      697     6575    1         GPARM.REC$->B$$ALREC,
      698     6576    1         FS_WORKAREA$ -> FS$WORKAUTO) ALTRET(SAL5);
      699     6577    1         IF WRSP$->FS$WRSP.START = -1 THEN

   6577  7 001217   200013 470500                    LDP0    WRSP$,,AUTO
         7 001220   000000 235100                    LDA     0,,PR0
         7 001221   000027 115000 xsym               CMPA    B_VECTNIL+23
         7 001222   001227 601000 7                  TNZ     SAL3

      700     6578    2           DO;

      701     6579                                /* DONE */
      702     6580    2           ALSTAT.STAT=FOAS_LAST#;

   6580  7 001223   000001 236007                    LDQ     1,DL
         7 001224   200004 471500                    LDP1    @WSN,,AUTO
         7 001225   100000 756100                    STQ     0,,PR1

      703     6581    2           RETURN;

   6581  7 001226   000000 702200 xent               TSX2  ! X66_ARET

   6577  7 001227                       SAL3         null
      704     6582    2           END;
      705     6583    1   SAL3: ;
      706     6584    1         GPARM.RECL=WRSP$->FS$WRSP.MAXBYTES;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:82   

   6584  7 001227   200013 470500                    LDP0    WRSP$,,AUTO
         7 001230   000011 236100                    LDQ     9,,PR0
         7 001231   000011 736000                    QLS     9
         7 001232   200017 552110                    STBQ    GPARM+2,'10'O,AUTO

      707     6585    1         CALL FOG$ADD (GPARM) ALTRET(SAL4);

   6585  7 001233   200015 631500                    EPPR1   GPARM,,AUTO
         7 001234   200032 451500                    STP1    WSN$+2,,AUTO
         7 001235   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001236   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001237   000000 701000 xent               TSX1    FOG$ADD
         7 001240   001242 702000 7                  TSX2    SAL4

      708     6586    1         GOTO SAL2;

   6586  7 001241   001205 710000 7                  TRA     SAL2

   6584  7 001242                       SAL4         null
      709     6587    1   SAL4: ;
      710     6588    1         ALSTAT.STAT=FOAS_GRAN#;

   6588  7 001242   000003 235007                    LDA     3,DL
         7 001243   200004 470500                    LDP0    @WSN,,AUTO
         7 001244   000000 755100                    STA     0,,PR0

      711     6589    1         RETURN;

   6589  7 001245   000000 702200 xent               TSX2  ! X66_ARET

   6588  7 001246                       SAL5         null
      712     6590    1   SAL5: ;
      713     6591    1         ALSTAT.STAT=FOAS_BDIM#;

   6591  7 001246   000004 235007                    LDA     4,DL
         7 001247   200004 470500                    LDP0    @WSN,,AUTO
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:83   
         7 001250   000000 755100                    STA     0,,PR0

      714     6592    1         RETURN;

   6592  7 001251   000000 702200 xent               TSX2  ! X66_ARET

      715     6593
      716     6594        /*F* NAME:         FOR$GALIGN
      717     6595             PURPOSE:      To continue building the alignment image for
      718     6596                           a symbiont graphics device.
      719     6597        */
      720     6598    1   FOR$GALIGN: ENTRY (FORMNAME,WSN) ALTRET;

   6598  7 001252   000000 700200 xent  FOR$GALIGN   TSX0  ! X66_AUTO_3
         7 001253   000036 000003                    ZERO    30,3

      721     6599
      722     6600                           /* WSN IS ALSTAT */
      723     6601
      724     6602    1         FORM$=DEV$->FO$DEV.ALR$;

   6602  7 001254   000000 470400 xsym               LDP0    FO_DEV$
         7 001255   000003 236100                    LDQ     3,,PR0
         7 001256   200010 756100                    STQ     FORM$,,AUTO

      725     6603    1         CALL ALSET;

   6603  7 001257   001367 701000 7                  TSX1    ALSET
         7 001260   000000 011000                    NOP     0

      726     6604    1         CALL FOG$GRAN (GPARM);

   6604  7 001261   200015 630500                    EPPR0   GPARM,,AUTO
         7 001262   200032 450500                    STP0    WSN$+2,,AUTO
         7 001263   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001264   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001265   000000 701000 xent               TSX1    FOG$GRAN
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:84   
         7 001266   000000 011000                    NOP     0

      727     6605    1         GPARM.VFCR='0'B;

   6605  7 001267   000000 236003                    LDQ     0,DU
         7 001270   200017 552140                    STBQ    GPARM+2,'40'O,AUTO

      728     6606    1         FS_WORKAREA$=PINCRW(WRSP$,LENGTHW(FS$GWRSP));

   6606  7 001271   200013 236100                    LDQ     WRSP$,,AUTO
         7 001272   000025 036003                    ADLQ    21,DU
         7 001273   200022 756100                    STQ     FS_WORKAREA$,,AUTO

      729     6607    1         GPARM.REC$=PINCRW(FS_WORKAREA$,LENGTHW(FS$WORKAUTO));

   6607  7 001274   000101 036003                    ADLQ    65,DU
         7 001275   200016 756100                    STQ     GPARM+1,,AUTO

      730     6608    1         WRSP$ ->FS$GWRSP.DATE_TIME = ENTADDR(NIL);

   6608  7 001276   000002 236000 xsym               LDQ     B_VECTNIL+2
         7 001277   200013 470500                    LDP0    WRSP$,,AUTO
         7 001300   000024 756100                    STQ     20,,PR0

      731     6609    1         GOTO GAL3;

   6609  7 001301   001333 710000 7                  TRA     GAL3

   6608  7 001302                       GAL2         null
      732     6610    1   GAL2: ;
      733     6611                                      /* Call this continuously until banner
      734     6612                                         is completed */
      735     6613    1         CALL FSK$GBANNER ( FORM$->FS$FORM,   /* GBANNER NEEDS THE WHOLE FORM */

   6613  7 001302   200022 236100                    LDQ     FS_WORKAREA$,,AUTO
         7 001303   200016 235100                    LDA     GPARM+1,,AUTO
         7 001304   200034 757100                    STAQ    WSN$+4,,AUTO
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:85   
         7 001305   200013 236100                    LDQ     WRSP$,,AUTO
         7 001306   200010 235100                    LDA     FORM$,,AUTO
         7 001307   200032 757100                    STAQ    WSN$+2,,AUTO
         7 001310   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001311   000022 631400 xsym               EPPR1   B_VECTNIL+18
         7 001312   000000 701000 xent               TSX1    FSK$GBANNER
         7 001313   001363 702000 7                  TSX2    GAL5

      736     6614    1         WRSP$->FS$GWRSP,
      737     6615    1         GPARM.REC$->B$$ALREC,
      738     6616    1         FS_WORKAREA$ -> FS$WORKAUTO) ALTRET(GAL5);
      739     6617    1         IF WRSP$->FS$GWRSP.START = -1 THEN

   6617  7 001314   200013 470500                    LDP0    WRSP$,,AUTO
         7 001315   000000 235100                    LDA     0,,PR0
         7 001316   000027 115000 xsym               CMPA    B_VECTNIL+23
         7 001317   001333 601000 7                  TNZ     GAL3

      740     6618    2           DO;

      741     6619                                /* DONE */
      742     6620    2           IF FORM$ -> FS$FORM.ALGNDISP = 0

   6620  7 001320   200010 471500                    LDP1    FORM$,,AUTO
         7 001321   100003 720100                    LXL0    3,,PR1
         7 001322   001327 601000 7                  TNZ     s:6624

      743     6621    2           THEN
      744     6622    2            ALSTAT.STAT=FOAS_JDLM#;

   6622  7 001323   000007 236007                    LDQ     7,DL
         7 001324   200004 473500                    LDP3    @WSN,,AUTO
         7 001325   300000 756100                    STQ     0,,PR3
         7 001326   001332 710000 7                  TRA     s:6625

      745     6623    2           ELSE
      746     6624    2            ALSTAT.STAT=FOAS_LAST#;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:86   

   6624  7 001327   000001 236007                    LDQ     1,DL
         7 001330   200004 473500                    LDP3    @WSN,,AUTO
         7 001331   300000 756100                    STQ     0,,PR3

      747     6625    2           RETURN;

   6625  7 001332   000000 702200 xent               TSX2  ! X66_ARET

   6617  7 001333                       GAL3         null
      748     6626    2           END;
      749     6627    1   GAL3: ;
      750     6628    1         GPARM.RECL=WRSP$->FS$GWRSP.MAXBYTES;

   6628  7 001333   000005 236100                    LDQ     5,,PR0
         7 001334   000011 736000                    QLS     9
         7 001335   200017 552110                    STBQ    GPARM+2,'10'O,AUTO

      751     6629    1         IF START_GRAFBAN = '1'B

   6629  7 001336   200011 234100                    SZN     START_GRAFBAN,,AUTO
         7 001337   001350 605000 7                  TPL     s:6635

      752     6630    2         THEN DO;

      753     6631    2           START_GRAFBAN = '0'B;

   6631  7 001340   200011 450100                    STZ     START_GRAFBAN,,AUTO

      754     6632    2           CALL FOG$BLD (GPARM);

   6632  7 001341   200015 631500                    EPPR1   GPARM,,AUTO
         7 001342   200032 451500                    STP1    WSN$+2,,AUTO
         7 001343   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001344   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001345   000000 701000 xent               TSX1    FOG$BLD
         7 001346   000000 011000                    NOP     0
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:87   

      755     6633    2           END;

   6633  7 001347   001356 710000 7                  TRA     s:6637

      756     6634    2         ELSE DO;

      757     6635    2           CALL FOG$ADD (GPARM) ALTRET (GAL4);

   6635  7 001350   200015 631500                    EPPR1   GPARM,,AUTO
         7 001351   200032 451500                    STP1    WSN$+2,,AUTO
         7 001352   200032 630500                    EPPR0   WSN$+2,,AUTO
         7 001353   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001354   000000 701000 xent               TSX1    FOG$ADD
         7 001355   001357 702000 7                  TSX2    GAL4

      758     6636    2           END;

      759     6637    1         GOTO GAL2;

   6637  7 001356   001302 710000 7                  TRA     GAL2

   6629  7 001357                       GAL4         null
      760     6638    1   GAL4: ;
      761     6639    1         ALSTAT.STAT=FOAS_GRAN#;

   6639  7 001357   000003 235007                    LDA     3,DL
         7 001360   200004 470500                    LDP0    @WSN,,AUTO
         7 001361   000000 755100                    STA     0,,PR0

      762     6640    1         RETURN;

   6640  7 001362   000000 702200 xent               TSX2  ! X66_ARET

   6639  7 001363                       GAL5         null
      763     6641    1   GAL5: ;
      764     6642    1         ALSTAT.STAT=FOAS_BDIM#;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:88   

   6642  7 001363   000004 235007                    LDA     4,DL
         7 001364   200004 470500                    LDP0    @WSN,,AUTO
         7 001365   000000 755100                    STA     0,,PR0

      765     6643    1         RETURN;

   6643  7 001366   000000 702200 xent               TSX2  ! X66_ARET

      766     6644
      767     6645    1   ALSET: PROC;

   6645  7 001367   200024 741300       ALSET        STX1  ! FS_WORKAREA$+2,,AUTO

      768     6646    2         FINST$=PINCRW(FORM$,FORM$->FS$FORM.ALGNDISP);

   6646  7 001370   200010 470500                    LDP0    FORM$,,AUTO
         7 001371   000003 720100                    LXL0    3,,PR0
         7 001372   000000 636010                    EAQ     0,X0
         7 001373   200010 036100                    ADLQ    FORM$,,AUTO
         7 001374   200014 756100                    STQ     FINST$,,AUTO

      769     6647    2         FINST$->FS$FINST.INTR=0;

   6647  7 001375   200014 471500                    LDP1    FINST$,,AUTO
         7 001376   000100 101400                    MRL     fill='000'O
         7 001377   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         7 001400   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1

      770     6648    2         WRSP$=PINCRW(FORM$,2048);

   6648  7 001401   200010 236100                    LDQ     FORM$,,AUTO
         7 001402   004000 036003                    ADLQ    2048,DU
         7 001403   200013 756100                    STQ     WRSP$,,AUTO

      771     6649                                      /* Work space pointer */
      772     6650    2         GPARM.BUF$=DEV$->FO$DEV.SPG$;
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:89   

   6650  7 001404   000000 473400 xsym               LDP3    FO_DEV$
         7 001405   300001 236100                    LDQ     1,,PR3
         7 001406   200015 756100                    STQ     GPARM,,AUTO

      773     6651    2         GPARM.REPEATS=1;

   6651  7 001407   000001 236007                    LDQ     1,DL
         7 001410   200017 552104                    STBQ    GPARM+2,'04'O,AUTO

      774     6652    2         GPARM.DVBYTE = %DVBYTE_BP#|%DVBYTE_VFC#;

   6652  7 001411   000300 236003                    LDQ     192,DU
         7 001412   200017 552120                    STBQ    GPARM+2,'20'O,AUTO

      775     6653    2         RETURN;

   6653  7 001413   200024 221300                    LDX1  ! FS_WORKAREA$+2,,AUTO
         7 001414   000001 702211                    TSX2  ! 1,X1
      776     6654    2   END ALSET;
      777     6655    1   END FOR$FORM;

PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:90   
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   FO_SCODE_C.:E05TOU  is referenced.
   FOO_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   FOO_SUBS_C.:E05TOU  is referenced.
   FOM_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   FR_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FS$FIT.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FOR$FORM.
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:91   

 **** Variables and constants ****

  ****  Section 001  Data  FOR$FORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d CHAR(8)     r     1 DEVNAME                    0-0-0/d STRC(63)    r     1 FORMKEY
     4-0-0/d CHAR(6)     r     1 FORMNM                    17-0-0/c STRC(936)   r     1 OPMSG_FORM
     6-0-0/c STRC(324)   r     1 OPMSG_MERR                52-0-0/d STRC(504)   r     1 READ_FORM
    70-0-0/d STRC(432)   r     1 WRITE_OSYMB              104-0-0/w STRC(288)   r     1 ZERO_TABS

  ****  Section 006 RoData FOR$FORM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    76-0-0/d STRC(1080)  r     1 CLOSE_FORM               164-0-0/d STRC(1080)  r     1 FMNT_SYMB
    72-0-0/c STRC(54)    r     1 FORMFILE                 134-0-0/d STRC(432)   r     1 OCMSG_FORM
   150-0-0/d STRC(432)   r     1 OCMSG_MERR                 0-0-0/d STRC(2088)  r     1 OPEN_FORM
   232-0-0/d STRC(504)   r     1 READ_OSYMB               250-0-0/d STRC(216)   r     1 SLEEP1
    74-0-0/c STRC(72)    r     1 SYSACCT                  256-0-0/c STRC(9)     r     1 TABVFC
   226-0-0/d STRC(144)   r     1 TRUNC_FORM               222-0-0/d STRC(144)   r     1 TRUNC_OSYMB

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FORMNAME                 27-0-0/w PTR         r     1 @FO_DEV$
     5-0-0/w PTR         r     1 @KEYIN$                    4-0-0/w PTR         r     1 @WSN
     6-0-0/w PTR         r     1 ALIGN$                    *0-0-0/w STRC(72)    r     1 ALSTAT
    14-0-0/w PTR         r     1 FINST$                    10-0-0/w PTR         r     1 FORM$
    *0-0-0/c CHAR(6)     r     1 FORMNAME                  *0-0-0/w PTR         r     1 FO_DEV$
    22-0-0/w PTR         r     1 FS_WORKAREA$              15-0-0/w STRC(108)   r     1 GPARM
     7-0-0/w UBIN        r     1 I                          7-0-0/w SBIN        r     1 IR
    *0-0-0/w PTR         r     1 KEYIN$                    20-0-0/w UBIN        r     1 KSUBC
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:92   
    21-0-0/w PTR         r     1 SETUP$                    11-0-0/b BIT         r     1 START_GRAFBAN
    13-0-0/w PTR         r     1 WRSP$                     *0-0-0/w CHAR(8)     r     1 WSN
    30-0-0/w PTR         r     1 WSN$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 FO_DEV$
     0-0-0/w UBIN        r     1 FO_FITBUF1(0:2047)
     0-0-0/w STRC(81)    r     1 FO_OSYMBKEY                0-0-0/w STRC(21600) r     1 FO_OSYMBUF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(256)   r     1 B$$ALREC                   0-0-0/w UBIN        r     1 B$$FORMR(0:2047)
     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(657)   r     1 DEV                        0-0-0/w STRC(657)   r     1 DEV
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(657)   r     1 FO$DEV
     0-0-0/w STRC(324)   r     1 FO$DKEYIN                  0-0-0/w ASTR(351)   r     1 FO$JOB
     0-0-0/w STRC(396)   r     1 FO$WSN                     0-0-0/c STRC(180)   r     1 FS$FINST
     0-0-0/w STRC(3186)  r     1 FS$FORM                    0-0-0/w STRC(756)   r     1 FS$GWRSP
     0-0-0/c STRC(684)   r     1 FS$SETUP                   0-0-0/w STRC(2313)  r     1 FS$WORKAUTO
     0-0-0/w STRC(720)   r     1 FS$WRSP                    0-0-0N  NULL        r     1 M$CSCG
     0-0-0N  NULL        r     1 M$FORM                     0-0-0N  NULL        r     1 M$OSCG
     0-0-0N  NULL        r     1 M$OSYMB


   Procedure FOR$FORM requires 781 words for executable code.
   Procedure FOR$FORM requires 30 words of local(AUTO) storage.

    No errors detected in file FOR$FORM.:E05TSI    .
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:93   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:94   
          MINI XREF LISTING

ALIGN$
      5190**DCL      6020<<ASSIGN   6021>>ASSIGN
ALSET
      6645**PROC     6485--CALL     6564--CALL     6603--CALL
ALSTAT.ERRC
        25**DCL      6481<<ASSIGN
ALSTAT.STAT
        24**DCL      6477<<ASSIGN   6480<<ASSIGN   6532<<ASSIGN   6580<<ASSIGN   6588<<ASSIGN   6591<<ASSIGN
      6622<<ASSIGN   6624<<ASSIGN   6639<<ASSIGN   6642<<ASSIGN
ALTRT
      6403**LABEL    6053--CALLALT  6390--CALLALT  6405--CALLALT  6406--CALLALT
ALTRT IN PROCEDURE READREC
      6428**LABEL    6429--CALLALT
ALTRT IN PROCEDURE WRITE_DEV
      6217**LABEL    6218--CALLALT
ALTRT1 IN PROCEDURE WRITE_DEV1
      6375**LABEL    6376--CALLALT
B$$ALREC
      5183**DCL      6573<>CALL     6613<>CALL
B$$FORMR
      5182**DCL      6428--ASSIGN
B$ALT.CODE
      4969**DCL      4969--REDEF    4970--REDEF    4970--REDEF
B$ALT.ERR.CODE
      4971**DCL      5910>>IF       5915>>ASSIGN   6027>>ASSIGN   6438>>IF       6438>>IF       6481>>ASSIGN
B$ALT.ERR.ERR#
      4971**DCL      4971--REDEF
B$ALT.EVID
      4970**DCL      4970--REDEF    4970--REDEF
B$TCB.ALT$
      4965**DCL      5910>>IF       5915>>ASSIGN   6027>>ASSIGN   6438>>IF       6438>>IF       6481>>ASSIGN
B$TCB$
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:95   
      5298**DCL      5910>>IF       5915>>ASSIGN   6027>>ASSIGN   6438>>IF       6438>>IF       6481>>ASSIGN
BADFTYP IN PROCEDURE MOUNT
      6037**LABEL    5989--CALLALT
CLOSE_FORM
      5500**DCL      6390<>CALL
CLOSE_FORM.SN_
      5500**DCL      5500--REDEF
CLOSE_FORM.UTL_
      5501**DCL      5501--REDEF
CLOSE_FORM.V
      5505**DCL      5500--DCLINIT
CLOSE_FORM.V.EXPIRE#
      5515**DCL      5515--REDEF
CLOSE_FORM.V.TYPE#
      5513**DCL      5513--REDEF
CLOSE_FORM.V.XTNSIZE#
      5510**DCL      5510--REDEF    5512--REDEF
DEV IN PROCEDURE WRITE_DEV
      6075**DCL      6203>>ASSIGN   6214--ASSIGN
DEV.FLG.LOCAL IN PROCEDURE WRITE_DEV
      6113**DCL      6200>>IF
DEV.NAME IN PROCEDURE WRITE_DEV
      6089**DCL      6090--REDEF    6202>>ASSIGN
DEV.RACCT IN PROCEDURE WRITE_DEV
      6157**DCL      6158--REDEF
DEV IN PROCEDURE WRITE_DEV1
      6245**DCL      6372--ASSIGN
DEV.NAME IN PROCEDURE WRITE_DEV1
      6259**DCL      6260--REDEF
DEV.RACCT IN PROCEDURE WRITE_DEV1
      6327**DCL      6328--REDEF
DEVNAME
      5232**DCL      5649--DCLINIT  5890<<ASSIGN   5963<<ASSIGN   5989<>CALL     6000>>ASSIGN
F$DCB.ACTPOS
      4861**DCL      4861--REDEF
F$DCB.ARS
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:96   
      4836**DCL      4836--REDEF
F$DCB.ATTR
      4854**DCL      4855--REDEF
F$DCB.BORROW
      4869**DCL      4869--REDEF    4869--REDEF    4869--REDEF
F$DCB.DCBNAME.L
      4883**DCL      4883--IMP-SIZ
F$DCB.EOMCHAR
      4840**DCL      4840--REDEF
F$DCB.FCD
      4849**DCL      6425>>IF
F$DCB.FLDID
      4864**DCL      4864--REDEF
F$DCB.FORM$
      4858**DCL      4858--REDEF
F$DCB.FSECT
      4874**DCL      4874--REDEF
F$DCB.FSN
      4851**DCL      4851--REDEF    4851--REDEF    4852--REDEF
F$DCB.HEADER$
      4857**DCL      4857--REDEF
F$DCB.IXTNSIZE
      4855**DCL      4855--REDEF
F$DCB.LASTSTA$
      4845**DCL      4845--REDEF
F$DCB.LVL
      4870**DCL      4870--REDEF
F$DCB.NAME.C
      4845**DCL      4845--REDEF
F$DCB.NOEOF
      4866**DCL      4866--REDEF
F$DCB.NRECS
      4856**DCL      4856--REDEF
F$DCB.NRECX
      4875**DCL      4875--REDEF
F$DCB.OHDR
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:97   
      4867**DCL      4867--REDEF
F$DCB.ORG
      4850**DCL      4850--REDEF
F$DCB.PRECNO
      4873**DCL      4873--REDEF
F$DCB.RCSZ
      4878**DCL      4878--REDEF
F$DCB.RES
      4846**DCL      4846--REDEF
F$DCB.SETX
      4858**DCL      4858--REDEF
F$DCB.TAB$
      4857**DCL      4858--REDEF
F$DCB.TDA
      4872**DCL      4872--REDEF
F$DCB.WSN
      4847**DCL      4847--REDEF
FINST$
      5197**DCL      6573>>CALL     6646<<ASSIGN   6647>>ASSIGN
FMNT_SYMB
      5647**DCL      5997<>CALL
FMNT_SYMB.V
      5651**DCL      5647--DCLINIT
FO$DEV.ALR$
      2460**DCL      6471>>ASSIGN   6563>>ASSIGN   6602>>ASSIGN
FO$DEV.FLEN
      2516**DCL      6013<<ASSIGN
FO$DEV.FLG.AEF
      2496**DCL      6016<<ASSIGN   6021<<ASSIGN
FO$DEV.FLG.ALGNED
      2494**DCL      6014<<ASSIGN
FO$DEV.FLG.LOCAL
      2486**DCL      6520>>IF
FO$DEV.FLG.MODE
      2477**DCL      5902<<ASSIGN   5904<<ASSIGN   5943<<ASSIGN   5946<<ASSIGN   6486>>IF
FO$DEV.FORM
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:98   
      2524**DCL      5936>>ASSIGN   5937>>ASSIGN   5961>>ASSIGN   5962>>ASSIGN   5971>>IF       5972<<ASSIGN
      6010<<ASSIGN   6026<<ASSIGN   6468>>ASSIGN   6477>>IF
FO$DEV.NAME
      2462**DCL      2463--REDEF    5933>>ASSIGN   5958>>ASSIGN   5963>>ASSIGN
FO$DEV.RACCT
      2530**DCL      2531--REDEF
FO$DEV.SPG$
      2456**DCL      6650>>ASSIGN
FO$DEV.STATE
      2471**DCL      5892>>IF
FO$DEV.WSN$
      2461**DCL      6204>>ASSIGN
FO$DKEYIN.CADDR
      2361**DCL      5852>>ASSIGN   5856>>ASSIGN
FO$DKEYIN.CHKP
      2369**DCL      2370--REDEF
FO$DKEYIN.DEVNM
      2362**DCL      2363--REDEF    5851>>ASSIGN   5855>>ASSIGN   5890>>ASSIGN
FO$DKEYIN.FORM
      2372**DCL      5853>>ASSIGN   5854>>ASSIGN   5857>>ASSIGN
FO$DKEYIN.KIN#
      2360**DCL      5860>>DOCASE
FO$DKEYIN.TNAME
      2374**DCL      2375--REDEF    2376--REDEF
FO$FIL.DEST
      2598**DCL      2599--REDEF
FO$FKEYIN.ACCT
      2403**DCL      2404--REDEF
FO$FKEYIN.NOTFORM
      2399**DCL      2400--REDEF
FO$JOB.JNL
      2710**DCL      2717--IMP-SIZ
FO$RKEYIN.DEVNM
      2426**DCL      2427--REDEF
FO$WSN.LNK$ IN PROCEDURE WRITE_DEV
      6181**DCL      6212>>ASSIGN
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:99   
FO$WSN.NWSNS IN PROCEDURE WRITE_DEV
      6183**DCL      6207>>DOINDEX
FO$WSN.WSN IN PROCEDURE WRITE_DEV
      6185**DCL      6208>>ASSIGN
FOG$ADD
      5299**DCL-ENT  6527--CALL     6545--CALL     6585--CALL     6635--CALL
FOG$BLD
      5300**DCL-ENT  6513--CALL     6632--CALL
FOG$GRAN
      5301**DCL-ENT  6565--CALL     6604--CALL
FOI$CRASHGO
      5302**DCL-ENT  6444--CALL
FORM$
      5193**DCL      5871>>IF       5876>>ASSIGN   5876>>ASSIGN   5900>>IF       5941>>IF       5989>>CALL
      6013>>ASSIGN   6015>>ASSIGN   6020>>ASSIGN   6418<<ASSIGN   6428>>ASSIGN   6471<<ASSIGN   6489>>ASSIGN
      6501>>ASSIGN   6505>>ASSIGN   6505>>ASSIGN   6505>>ASSIGN   6508>>ASSIGN   6509>>ASSIGN   6522>>ASSIGN
      6523>>ASSIGN   6529>>IF       6563<<ASSIGN   6602<<ASSIGN   6613>>CALL     6620>>IF       6646>>ASSIGN
      6646>>ASSIGN   6648>>ASSIGN
FORMFILE
      5457**DCL      5387--DCLINIT
FORMKEY
      5229**DCL      5541--DCLINIT  5542--DCLINIT
FORMKEY.NAME
      5231**DCL      5854<<ASSIGN   5937<<ASSIGN   5962<<ASSIGN   5990>>ASSIGN   6403<<ASSIGN   6468<<ASSIGN
FORMNAME
        21**DCL        13--PROC     5847--ENTRY    5926--ENTRY    6400--ENTRY    6403>>ASSIGN   6464--ENTRY
      6559--ENTRY    6598--ENTRY
FORMNM
      5233**DCL      5650--DCLINIT  5990<<ASSIGN   6002>>ASSIGN   6010>>ASSIGN
FOT$DCHK
      5303**DCL-ENT  5989--CALL
FOT$TCHK
      5304**DCL-ENT  6406--CALL
FO_DEV$
      2781**DCL      5891>>IF       5892>>IF       5899>>IF       5902>>ASSIGN   5904>>ASSIGN   5933>>ASSIGN
      5936>>ASSIGN   5937>>ASSIGN   5943>>ASSIGN   5946>>ASSIGN   5958>>ASSIGN   5961>>ASSIGN   5962>>ASSIGN
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:100  
      5963>>ASSIGN   5971>>IF       5972>>ASSIGN   5998>>IF       6010>>ASSIGN   6012<>CALL     6013>>ASSIGN
      6014>>ASSIGN   6016>>ASSIGN   6021>>ASSIGN   6026>>IF       6026>>ASSIGN   6053<>CALL     6468>>ASSIGN
      6471>>ASSIGN   6477>>IF       6486>>IF       6520>>IF       6563>>ASSIGN   6602>>ASSIGN   6650>>ASSIGN
FO_DEV$ IN PROCEDURE WRITE_DEV
      6058**DCL      6056--PROC     6200>>IF       6202>>ASSIGN   6203>>ASSIGN   6204>>ASSIGN
FO_DEV_INIT.NAME
      3128**DCL      3129--REDEF
FO_DEV_INIT.RACCT
      3196**DCL      3197--REDEF
FO_FIL_INIT.DEST
      3025**DCL      3026--REDEF
FO_FITBUF1
      2779**DCL      6406--CALL     6418--ASSIGN
FO_OSYMBKEY
      2827**DCL      5714--DCLINIT  5751--DCLINIT  5752--DCLINIT
FO_OSYMBKEY.NAME
      2827**DCL      6000<<ASSIGN   6202<<ASSIGN   6371<<ASSIGN
FO_OSYMBKEYIN.DEVNM
      2846**DCL      2847--REDEF
FO_OSYMBUF
      2859**DCL      5715--DCLINIT  5716--DCLINIT  5753--DCLINIT  5754--DCLINIT
FO_OSYMBUF.FO_OSYMBDEV
      2877**DCL      6203<<ASSIGN
FO_OSYMBUF.FO_OSYMBDEV.FLG.LOCAL
      2912**DCL      6369>>IF
FO_OSYMBUF.FO_OSYMBDEV.FORM
      2950**DCL      6002<<ASSIGN
FO_OSYMBUF.FO_OSYMBDEV.NAME
      2888**DCL      2889--REDEF    6371>>ASSIGN
FO_OSYMBUF.FO_OSYMBDEV.RACCT
      2956**DCL      2957--REDEF
FO_OSYMBUF.FO_OSYMBWSN.LNK$
      2980**DCL      6214--ASSIGN   6372--ASSIGN
FO_OSYMBUF.FO_OSYMBWSN.NWSNS
      2982**DCL      6205<<ASSIGN   6208>>ASSIGN   6210<<ASSIGN   6210>>ASSIGN   6214--ASSIGN   6214>>ASSIGN
      6372--ASSIGN   6372>>ASSIGN
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:101  
FO_OSYMBUF.FO_OSYMBWSN.WSN
      2984**DCL      6208<<ASSIGN
FS$FINST
      4997**DCL      6573<>CALL
FS$FINST.ALIGNCTL.EVERY
      5000**DCL      6021>>ASSIGN
FS$FINST.CHARGE
      4998**DCL      4999--REDEF
FS$FINST.ENTRIES.COUNT
      5019**DCL      5020--REDEF
FS$FINST.ENTRIES.DISP
      5015**DCL      5016--REDEF
FS$FINST.INTR
      5003**DCL      6647<<ASSIGN
FS$FORM
      5061**DCL      5989<>CALL     6406<>CALL     6613<>CALL
FS$FORM.ALGNDISP
      5067**DCL      6015>>ASSIGN   6489>>ASSIGN   6529>>IF       6620>>IF       6646>>ASSIGN
FS$FORM.CHAINIMAGE
      5119**DCL      6522--ASSIGN   6523--ASSIGN
FS$FORM.CHAINS
      5109**DCL      5119--REDEF
FS$FORM.GRAPHIC
      5070**DCL      5900>>IF       5941>>IF
FS$FORM.SETUPDISP
      5064**DCL      5871>>IF       5876>>ASSIGN
FS$FORM.SOFTFORM
      5085**DCL      6509--ASSIGN   6510--ASSIGN
FS$FORM.SOFTFORM.VLPPLATEN.LENGTH
      5094**DCL      6013>>ASSIGN   6505<<ASSIGN   6505>>ASSIGN
FS$FORM.SOFTFORM.VLPPLATEN.LIMBO
      5095**DCL      6505>>ASSIGN   6508<<ASSIGN
FS$FORM.SOFTFORM.VLPPLATEN.WIDTH
      5093**DCL      6501>>ASSIGN
FS$GWRSP
      5140**DCL      6491--ASSIGN   6606--ASSIGN   6613<>CALL
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:102  
FS$GWRSP.DATE_TIME
      5161**DCL      6494<<ASSIGN   6608<<ASSIGN
FS$GWRSP.ENTDISP
      5159**DCL      6489<<ASSIGN
FS$GWRSP.ENTDISP$
      5158**DCL      5159--REDEF
FS$GWRSP.MAXBYTES
      5146**DCL      6628>>ASSIGN
FS$GWRSP.START
      5141**DCL      6488<<ASSIGN   6617>>IF
FS$SETUP.LINES
      4980**DCL      5877>>DOINDEX
FS$SETUP.TXT
      4983**DCL      5878>>ASSIGN
FS$WORKAUTO
      5177**DCL      6492--ASSIGN   6551--ASSIGN   6568--ASSIGN   6573<>CALL     6607--ASSIGN   6613<>CALL
FS$WRSP
      5122**DCL      6550--ASSIGN   6567--ASSIGN   6573<>CALL
FS$WRSP.MAXBYTES
      5131**DCL      6584>>ASSIGN
FS$WRSP.START
      5123**DCL      6548<<ASSIGN   6577>>IF
FS$WRSP.WIDTH
      5136**DCL      6501<<ASSIGN
FSK$BANNER
      5305**DCL-ENT  6573--CALL
FSK$GBANNER
      5306**DCL-ENT  6613--CALL
FS_WORKAREA$
      5222**DCL      6491<<ASSIGN   6492>>ASSIGN   6550<<ASSIGN   6551>>ASSIGN   6567<<ASSIGN   6568>>ASSIGN
      6573>>CALL     6606<<ASSIGN   6607>>ASSIGN   6613>>CALL
GAL2
      6608**LABEL    6495--GOTO     6637--GOTO
GAL3
      6617**LABEL    6609--GOTO
GAL4
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:103  
      6629**LABEL    6635--CALLALT
GAL5
      6639**LABEL    6613--CALLALT
GPARM
      5211**DCL      6513<>CALL     6527<>CALL     6545<>CALL     6565<>CALL     6585<>CALL     6604<>CALL
      6632<>CALL     6635<>CALL
GPARM.BUF$
      5212**DCL      6650<<ASSIGN
GPARM.DVBYTE
      5216**DCL      6543<<ASSIGN   6543>>ASSIGN   6546<<ASSIGN   6546>>ASSIGN   6547<<ASSIGN   6547>>ASSIGN
      6652<<ASSIGN
GPARM.REC$
      5213**DCL      6492<<ASSIGN   6509<<ASSIGN   6522<<ASSIGN   6541<<ASSIGN   6551<<ASSIGN   6568<<ASSIGN
      6573>>CALL     6607<<ASSIGN   6613>>CALL
GPARM.RECL
      5217**DCL      6510<<ASSIGN   6523<<ASSIGN   6542<<ASSIGN   6584<<ASSIGN   6628<<ASSIGN
GPARM.REPEATS
      5218**DCL      6651<<ASSIGN
GPARM.VFC
      5214**DCL      5215--REDEF    6511<<ASSIGN   6524<<ASSIGN
GPARM.VFCR
      5215**DCL      6490<<ASSIGN   6544<<ASSIGN   6549<<ASSIGN   6566<<ASSIGN   6605<<ASSIGN
I
      5191**DCL      5192--REDEF    5878>>ASSIGN   6015<<ASSIGN   6016>>IF       6020>>ASSIGN   6027<<ASSIGN
      6028>>IF       6029>>IF       6030>>IF       6031>>IF       6035>>ASSIGN   6207<<DOINDEX  6208>>ASSIGN
IR
      5192**DCL      5877<<DOINDEX
KEYIN$
        26**DCL        13--PROC     5847--ENTRY    5851>>ASSIGN   5852>>ASSIGN   5853>>ASSIGN   5854>>ASSIGN
      5855>>ASSIGN   5856>>ASSIGN   5857>>ASSIGN   5860>>DOCASE   5890>>ASSIGN
KSUBC
      5220**DCL      6028<<ASSIGN   6029<<ASSIGN   6030<<ASSIGN   6031<<ASSIGN   6034<<ASSIGN   6037>>ASSIGN
M$CLOSE
        42**DCL-ENT  6390--CALL
M$FORM
      5288**DCL      6425--IF
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:104  
M$OPEN
        42**DCL-ENT  6427--CALL
M$READ
        43**DCL-ENT  6001--CALL     6429--CALL
M$SYMBIO
       107**DCL-ENT  5997--CALL
M$TRUNC
        43**DCL-ENT  6219--CALL     6377--CALL     6432--CALL
M$WAIT
       100**DCL-ENT  6441--CALL
M$WRITE
        43**DCL-ENT  5879--CALL     5895--CALL     5907--CALL     5918--CALL     6218--CALL     6376--CALL
MERR
      5910**LABEL    5874--GOTO     5898--CALLALT  5968--CALLALT
MOUNT
      5986**PROC     5898--CALL     5968--CALL
MOUNT1
      5963**LABEL    5965--CALLALT
NOFORM
      5906**LABEL    5858--CALLALT  5939--CALLALT  5973--GOTO
NOMOUNT IN PROCEDURE MOUNT
      6016**LABEL    5997--CALLALT
NOOPN IN PROCEDURE READREC
      6428**LABEL    6427--CALLALT
NOWRDEV IN PROCEDURE MOUNT
      6002**LABEL    6001--CALLALT
OCMSG_FORM
      5583**DCL      5879<>CALL     5907<>CALL
OCMSG_FORM.STATION_
      5585**DCL      5585--REDEF
OCMSG_FORM.V
      5586**DCL      5583--DCLINIT
OCMSG_FORM.V.DVBYTE.VFC#
      5592**DCL      5592--REDEF
OCMSG_MERR
      5617**DCL      5895<>CALL     5918<>CALL
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:105  
OCMSG_MERR.STATION_
      5619**DCL      5619--REDEF
OCMSG_MERR.V
      5620**DCL      5617--DCLINIT
OCMSG_MERR.V.DVBYTE.VFC#
      5626**DCL      5626--REDEF
OPEN_FORM
      5386**DCL      6427<>CALL
OPEN_FORM.ACSVEH_
      5388**DCL      5389--REDEF
OPEN_FORM.ALTKEYS_
      5394**DCL      5395--REDEF    5395--REDEF
OPEN_FORM.HDR_
      5393**DCL      5394--REDEF
OPEN_FORM.TAB_
      5392**DCL      5393--REDEF
OPEN_FORM.UHL_
      5386**DCL      5387--REDEF    5387--REDEF
OPEN_FORM.V
      5395**DCL      5386--DCLINIT
OPEN_FORM.V.FSN#
      5426**DCL      5426--REDEF    5426--REDEF
OPEN_FORM.WSN_
      5392**DCL      5392--REDEF
OPMSG_FORM
      5264**DCL      5584--DCLINIT  5585--DCLINIT
OPMSG_FORM.CADDR
      5265**DCL      5856<<ASSIGN   5905<<ASSIGN
OPMSG_FORM.DEVNM
      5274**DCL      5855<<ASSIGN
OPMSG_FORM.FLAGS
      5271**DCL      5272--REDEF
OPMSG_FORM.FORM
      5280**DCL      5857<<ASSIGN
OPMSG_FORM.MSGID
      5267**DCL      5268--REDEF
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:106  
OPMSG_FORM.SETUP
      5281**DCL      5878<<ASSIGN
OPMSG_FORM.SUBC
      5279**DCL      5870<<ASSIGN   5906<<ASSIGN
OPMSG_MERR
      5239**DCL      5618--DCLINIT  5619--DCLINIT
OPMSG_MERR.CADDR
      5240**DCL      5852<<ASSIGN   5934<<ASSIGN   5959<<ASSIGN
OPMSG_MERR.CONNECT
      5258**DCL      5850<<ASSIGN   5935<<ASSIGN   5960<<ASSIGN
OPMSG_MERR.DEVNM
      5249**DCL      5851<<ASSIGN   5933<<ASSIGN   5958<<ASSIGN
OPMSG_MERR.ERRC
      5257**DCL      5915<<ASSIGN   6035<<ASSIGN
OPMSG_MERR.FLAGS
      5246**DCL      5247--REDEF
OPMSG_MERR.FORM
      5256**DCL      5853<<ASSIGN   5936<<ASSIGN   5961<<ASSIGN
OPMSG_MERR.MSGID
      5242**DCL      5243--REDEF
OPMSG_MERR.SUBC
      5255**DCL      5873<<ASSIGN   5894<<ASSIGN   5911<<ASSIGN   5914<<ASSIGN   6037<<ASSIGN   6040<<ASSIGN
READREC
      6417**PROC     5858--CALL     5939--CALL     5965--CALL     6405--CALL
READREC1 IN PROCEDURE READREC
      6423**ENTRY    6474--CALL
READ_FORM
      5541**DCL      6429<>CALL
READ_FORM.BUF_
      5543**DCL      6428<<ASSIGN
READ_FORM.STATION_
      5544**DCL      5545--REDEF
READ_FORM.V
      5545**DCL      5541--DCLINIT
READ_FORM.V.DVBYTE.REREAD#
      5556**DCL      5556--REDEF
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:107  
READ_FORM.V.INDX#
      5554**DCL      5554--REDEF
READ_OSYMB
      5751**DCL      6001<>CALL
READ_OSYMB.STATION_
      5754**DCL      5755--REDEF
READ_OSYMB.V
      5755**DCL      5751--DCLINIT
READ_OSYMB.V.DVBYTE.REREAD#
      5766**DCL      5766--REDEF
READ_OSYMB.V.INDX#
      5764**DCL      5764--REDEF
RTN IN PROCEDURE READREC
      6428**LABEL    6432--CALLALT
RTN IN PROCEDURE WRITE_DEV
      6217**LABEL    6219--CALLALT
RTN1 IN PROCEDURE WRITE_DEV1
      6375**LABEL    6377--CALLALT
SAL0
      6471**LABEL    6474--CALLALT
SAL1
      6477**LABEL    6475--GOTO
SAL2
      6568**LABEL    6552--GOTO     6586--GOTO
SAL3
      6577**LABEL    6569--GOTO
SAL4
      6584**LABEL    6585--CALLALT
SAL5
      6588**LABEL    6573--CALLALT
SETUP$
      5221**DCL      5876<<ASSIGN   5877>>DOINDEX  5878>>ASSIGN
SLEEP1
      5786**DCL      6441<>CALL
SLEEP1.V
      5787**DCL      5786--DCLINIT
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:108  
START_GRAFBAN
      5194**DCL      6493<<ASSIGN   6629>>IF       6631<<ASSIGN
SYSACCT
      5472**DCL      5391--DCLINIT
TABVFC
      5820**DCL      6544>>ASSIGN
TRUNC_FORM
      5689**DCL      6432<>CALL
TRUNC_FORM.V
      5689**DCL      5689--DCLINIT
TRUNC_OSYMB
      5673**DCL      6219<>CALL     6377<>CALL
TRUNC_OSYMB.V
      5673**DCL      5673--DCLINIT
TRYOPN IN PROCEDURE READREC
      6418**LABEL    6442--GOTO
WRITE_DEV
      6056**PROC     6012--CALL     6053--CALL
WRITE_DEV1
      6227**PROC     6005--CALL
WRITE_OSYMB
      5714**DCL      6218<>CALL     6376<>CALL
WRITE_OSYMB.BUF_.BOUND
      5714**DCL      6214<<ASSIGN   6372<<ASSIGN
WRITE_OSYMB.STATION_
      5716**DCL      5716--REDEF
WRITE_OSYMB.V
      5717**DCL      5714--DCLINIT
WRITE_OSYMB.V.DVBYTE.VFC#
      5723**DCL      5723--REDEF
WRSP$
      5196**DCL      6488>>ASSIGN   6489>>ASSIGN   6491>>ASSIGN   6494>>ASSIGN   6501>>ASSIGN   6548>>ASSIGN
      6550>>ASSIGN   6567>>ASSIGN   6573>>CALL     6577>>IF       6584>>ASSIGN   6606>>ASSIGN   6608>>ASSIGN
      6613>>CALL     6617>>IF       6628>>ASSIGN   6648<<ASSIGN
WSN
        22**DCL        13--PROC       23--REDEF    5847--ENTRY    6400--ENTRY    6406<>CALL     6464--ENTRY
PL6.E3A0      #001=FOR$FORM File=FOR$FORM.:E05TSI                                TUE 07/29/97 17:13 Page:109  
      6559--ENTRY    6598--ENTRY
WSN$ IN PROCEDURE WRITE_DEV
      6059**DCL      6204<<ASSIGN   6206>>DOWHILE  6207>>DOINDEX  6208>>ASSIGN   6212<<ASSIGN   6212>>ASSIGN
ZERO_TABS
      5802**DCL      6541--ASSIGN   6542--ASSIGN
