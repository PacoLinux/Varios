VERSION E05

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* DMC,DFC */
        7        7        /********************************************************************/
        8        8        /*M*    CPG$IBEX     IF, LET, GOTO and OUTPUT commands              */
        9        9        /**/
       10       10        /*P*    NAME:     CPG$IBEX
       11       11                PURPOSE:  These commands allow the user to affect the
       12       12                          execution of commands within COMMAND FILES.
       13       13        */
       14       14        /********************************************************************/
       15       15        CPG$IBEX: PROC (P$PCB) ALTRET;
       16       16        /***** Include files *****/
       17       17        %INCLUDE AS_SUPER_C ;
       18      452        %INCLUDE B$JIT;
       19      742        %INCLUDE B_MACROS_C;
       20      853        %INCLUDE CP_6_SUBS;
       21     1393        %INCLUDE CP_6;
       22     1474        %INCLUDE CP_MACROS_C;
       23     2226        %INCLUDE CP_SUBS_C;
       24     3143        %INCLUDE CP_PERR_C;
       25     3481        %INCLUDE F_ERRORS_C;
       26     3721        %INCLUDE XU_MACRO_C;
       27     6827        %INCLUDE XUM_MACRO_C;
       28     6854        %INCLUDE XUE_MACRO_C;
       29     7598        %INCLUDE XUE_SUBS_C;
       30     7778        %INCLUDE CP_DATA_R;
       31    10341        %INCLUDE FS_BANNER_C ;
       32    10382        %INCLUDE B$TABLES_C;
       33    10490        /***** External routines *****/
       34    10491    1   DCL ALA$BANNER2_STAR_S ENTRY(3) ALTRET;
       35    10492    1   DCL ASC$BANNER ENTRY(3) ALTRET;
       36    10493    1   DCL CPA$FLUSH ENTRY;
       37    10494    1   DCL CPA$ECHOCC ENTRY(2);
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:2    
       38    10495    1   DCL CPA$READCC ENTRY(2) ALTRET;
       39    10496    1   DCL CPB$OPENCS ENTRY;
       40    10497    1   DCL CPB$WILDCMPR ENTRY(2) ALTRET;
       41    10498    1   DCL CPC$GETSEG ENTRY(2) ALTRET;
       42    10499    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;
       43    10500    1   DCL CPC$OPEN_LL ENTRY;
       44    10501    1   DCL CPC$RDUSERS ENTRY(2) ALTRET;
       45    10502    1   DCL CPC$RELSEG ENTRY(1);
       46    10503    1   DCL CPC$WRITEMSGE ENTRY(6);
       47    10504    1   DCL CPC$WRUSERS ENTRY(1) ALTRET;
       48    10505    1   DCL CPD$SYNTAX ENTRY(1) ALTRET;
       49    10506    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;
       50    10507    1   DCL CPG$FUN$$ ENTRY(1);
       51    10508    1   DCL CPG$GET_WHEN_CNTL_REC ENTRY(2) ALTRET;
       52    10509    1   DCL CPG$PUT_WHEN_CNTL_REC ENTRY(1) ALTRET;
       53    10510    1   DCL CPJ$READ_S ENTRY(3) ALTRET;
       54    10511    1   DCL CPJ$WRITE_S ENTRY(3) ALTRET;
       55    10512    1   DCL CXP$POSTERR ENTRY(5);
       56    10513    1   DCL X$EVAL ENTRY(1) ALTRET;
       57    10514    1   DCL X$DEC_CONVERT ENTRY(2) ALTRET;
       58    10515    1   DCL X$PUT_VAR ENTRY(5) ALTRET;
       59    10516        /***** Fpts *****/
       60    10517        %FPT_CLOSE (FPTN=FPT_CLOSE,STCLASS=AUTO);
       61    10559        %FPT_CLOSE (FPTN=FPT$CLOSE,STCLASS=BASED);
       62    10601        %FPT_DELREC (FPTN=FPT_DELREC,STCLASS=AUTO);
       63    10620        %FPT_PRECORD (FPTN=FPT_PRECORD,STCLASS=AUTO);
       64    10641        %FPT_READ (FPTN=FPT_READ,STCLASS=AUTO);
       65    10680        %FPT_REW (FPTN=FPT_REW,STCLASS=AUTO);
       66    10695        %FPT_WRITE (FPTN=FPT$WRITE,STCLASS=BASED);
       67    10726        %P$PCB (STCLASS="");
       68    10927        %P$PCB (NAME=PCB,STCLASS=AUTO);
       69    11128        %FPT_READ (FPTN=FPT$READCC,STCLASS=BASED);
       70    11167    1   DCL  1  KEY AUTO,
       71    11168    1        2  L UBIN BYTE UNAL,
       72    11169    1        2  N CHAR (35) UNAL;
       73    11170    1   DCL  1  KEY_VAR AUTO,
       74    11171    1        2  L UBIN BYTE UNAL,
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:3    
       75    11172    1        2  N CHAR (31) UNAL;
       76    11173    1   DCL  1  FKEY CONSTANT,
       77    11174    1        2  L UBIN BYTE UNAL INIT ( %(LENGTHC('VAR_0')) ),
       78    11175    1        2  N CHAR(0) INIT ('VAR_A');
       79    11176    1   DCL  1  LKEY CONSTANT,
       80    11177    1        2  L UBIN BYTE UNAL INIT ( %(LENGTHC('VAR_{')) ),
       81    11178    1        2  N CHAR(0) INIT ('VAR_{');
       82    11179        %K_WHEN (NAME=K_WHEN,STCLASS=AUTO) ;
       83    11197        %K_WHEN (NAME=CK_WHEN,STCLASS=CONSTANT) ;
       84    11215        %WHEN_CNTL_REC( NAME=CWHEN_CNTL_REC, STCLASS=CONSTANT) ;
       85    11236        %XUE_ECB (NAME=CXUE_ECB,STCLASS=CONSTANT);
       86    11438        %XUE_ECB (NAME=XUE_ECB,STCLASS=AUTO);
       87    11640        %U$PARAM (NAME=U$PARAM,STCLASS=AUTO);
       88    11656        /***** Based structures *****/
       89    11657        %F$DCB;
       90    11714        %B$TCB (STCLASS="BASED(B$TCB$)");
       91    11717        %B$ALT;
       92    11725        %PARSE$OUT (NAME=P$B,STCLASS=BASED);
       93    11770        %PARSE$SYM (NAME=P$S,STCLASS=BASED);
       94    11808        %XUG_GETCMD (NAME=GET$CMD, STCLASS=BASED);
       95    12146        %XUG_RLT (NAME=RLT, STCLASS=BASED);
       96    12153        %SEG$2;
       97    12213        %TEXTC (NAME=X$STRING,STCLASS=BASED);
       98    12218        %TEXTC (NAME=TXT$C,STCLASS="BASED(TXT$)");
       99    12223    1   DCL STARBANNER$BUF CHAR(%BAN_REC_SZ) BASED ;
      100    12224        %CP$BUFF (NAME=CP$BUFF,STCLASS=BASED);
      101    12227    1   DCL DUMMY$CHAR CHAR(%CPBUFFSIZE) BASED;
      102    12228    1   DCL B$TEXT CHAR(ARS) BASED ;
      103    12229        %FS$BANNER ;
      104    12251        %AS_USERS (STR_NAME = AS$USERS, STCLASS=BASED) ;
      105    12429    1   DCL 1 MOV$STR BASED UNAL,
      106    12430    1         2 CNT UBIN BYTE CALIGNED,
      107    12431    1         2 TXT CHAR(MOV$STR.CNT) CALIGNED ;
      108    12432    1   DCL 1 BANNER$BUF(0:9) ALIGNED BASED(BANNER$BUF$),
      109    12433    1         2 CNT UBIN BYTE CALIGNED,
      110    12434    1         2 TXT CHAR(80) CALIGNED ;
      111    12435        %WHEN_CNTL_REC( NAME=WHEN$CNTL_REC, STCLASS=BASED) ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:4    
      112    12456    1   DCL WILD_VAR$ PTR;
      113    12457        %TEXTC (NAME=WILD_VAR, STCLASS="BASED(WILD_VAR$)");
      114    12462        /***** Vectors *****/
      115    12463        %VECTOR (NAME=SEG3_,STCLASS=AUTO);
      116    12473    1   DCL BANNER_VEC VECTOR ;
      117    12474        /***** Ptrs *****/
      118    12475    1   DCL BLK$ PTR;
      119    12476    1   DCL NAME$ PTR;
      120    12477    1   DCL TXT$ PTR;
      121    12478    1   DCL ARRY$ PTR;
      122    12479    1   DCL BANNER$BUF$ PTR ;
      123    12480        /***** Character strings *****/
      124    12481    1   DCL TEMPBUF CHAR(512) AUTO;
      125    12482    1   DCL WRITEBUF CHAR(556) AUTO;
      126    12483    1   DCL NIL_TXTC UBIN(9) CONSTANT INIT (0);
      127    12484    1   DCL 1 F1_TEXT,
      128    12485    1         2 CNT UBIN(9) UNAL,
      129    12486    1         2 TXT CHAR(1) UNAL ;
      130    12487        %B$SR_NON_BLANK;
      131    12491        %B$XL_UPPER;
      132    12495        /***** Ubin word *****/
      133    12496    1   DCL DUMMY UBIN WORD;
      134    12497    1   DCL INDX1 UBIN WORD;
      135    12498    1   DCL TYPE UBIN WORD;
      136    12499    1   DCL VALUE SBIN WORD;
      137    12500    1   DCL CPOS UBIN WORD AUTO;
      138    12501    1   DCL TXT# UBIN WORD AUTO;
      139    12502    1   DCL ARS UBIN WORD AUTO;
      140    12503    1   DCL I UBIN WORD ;
      141    12504    1   DCL IBEX_CMD BIT(36) SYMREF ;
      142    12505    1   DCL CMD_SOURCE UBIN WORD ;
      143    12506    1   DCL CSLEV UBIN WORD ;
      144    12507    1   DCL LEFTPOS SBIN WORD ;
      145    12508    1   DCL RIGHTPOS SBIN WORD ;
      146    12509        /***** Bit variables *****/
      147    12510    1   DCL CHANGED BIT(1) ;
      148    12511    1   DCL PRINT_HDR# BIT(1) AUTO;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:5    
      149    12512    1   DCL SECOND_PASS# BIT(1) AUTO;
      150    12513    1   DCL PERM BIT(1) AUTO;
      151    12514    1   DCL GOT_BANNERTEXT_REC BIT(1) AUTO ;
      152    12515    1   DCL BANNER_USERS_SPLIT BIT(1) ;
      153    12516    1   DCL BANNER_STAR_SPLIT BIT(1) ;
      154    12517    1   DCL BANNER_ALTER(0:9) BIT(1) ;
      155    12518    1   DCL WHEN_LEVEL0 BIT(1) ;
      156    12519    1   DCL STAR_S_IS_OPEN BIT(1) ;
      157    12520    1   DCL REMEM$VAR REMEMBER BASED ;
      158    12521        /***** Error codes *****/
      159    12522        %VLP_ERRCODE (FPTN=E_ILLGOTO,FCG=CP,MID=G,ERR#=E$ILLGOTO,STCLASS=CONSTANT);
      160    12567        %VLP_ERRCODE (FPTN=E_MLBL,FCG=CP,MID=G,ERR#=E$MLBL,STCLASS=CONSTANT);
      161    12612        %VLP_ERRCODE (FPTN=E_READONLYLET,FCG=CP,MID=G,ERR#=E$READONLYLET,STCLASS=CONSTANT);
      162    12657        %VLP_ERRCODE (FPTN=E_XBIG511,FCG=CP,MID=G,ERR#=E$XBIG511,
      163    12658                        STCLASS=CONSTANT) ;
      164    12703        %VLP_ERRCODE (FPTN=E_MSCOMVAR,FCG=CP,MID=G,ERR#=E$MSCOMVAR,STCLASS=CONSTANT);
      165    12748        %VLP_ERRCODE (FPTN=E_BDVARNAME,FCG=CP,MID=G,ERR#=E$BDVARNAME,STCLASS=CONSTANT);
      166    12793        %VLP_ERRCODE (FPTN=E_ILLEXP,FCG=CP,MID=G,ERR#=E$ILLEXP,STCLASS=CONSTANT);
      167    12838        %VLP_ERRCODE (FPTN=E_NONDECIMAL,FCG=CP,MID=G,ERR#=E$NONDECIMAL,STCLASS=CONSTANT);
      168    12883        %VLP_ERRCODE (FPTN=E_BADBANNERTEXT0,FCG=CP,MID=G,ERR#=E$BADBANNERTEXT0,STCLASS=
             12883            CONSTANT);
      169    12928        %VLP_ERRCODE (FPTN=E_ILLBANNERTEXTLEN,FCG=CP,MID=G,ERR#=E$ILLBANNERTEXTLEN,STCLASS=
             12928            CONSTANT);
      170    12973        %VLP_ERRCODE (FPTN=E_UNALTBANNERTEXT,FCG=CP,MID=G,ERR#=E$UNALTBANNERTEXT,STCLASS=
             12973            CONSTANT);
      171    13018        %VLP_ERRCODE (FPTN=E_NOROOM4BANNERTEXT,FCG=CP,MID=G,ERR#=E$NOROOM4BANNERTEXT,STCLASS
             13018            =CONSTANT);
      172    13063        %VLP_ERRCODE (FPTN=E_CSINT,FCG=CP,MID=A,ERR#=E$CSINT,STCLASS=CONSTANT);
      173    13108        %VLP_ERRCODE (FPTN=E_NOWHEN,FCG=CP,MID=G,ERR#=E$NOWHEN,STCLASS=CONSTANT);
      174    13153        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:6    
      175    13154        /********************************************************************/
      176    13155        /*F*    NAME:    CPG$GOTO                                           */
      177    13156        /********************************************************************/
      178    13157    1   CPG$GOTO: ENTRY (P$PCB) ALTRET;
      179    13158        /*
      180    13159             ***** Goto command...
      181    13160        */
      182    13161    1     CALL GOTO_COMMAND ALTRET(ABORT_GOTO);
      183    13162    1     RETURN;
      184    13163        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:7    
      185    13164        /********************************************************************/
      186    13165        /*F*    NAME:    CPG$IF                                             */
      187    13166        /********************************************************************/
      188    13167    1   CPG$IF: ENTRY (P$PCB) ALTRET;
      189    13168        /*
      190    13169             ***** Call IF_COMMAND ...
      191    13170        */
      192    13171    1     REMEMBER CPG$BREAK_IN_EVAL IN SEG$2.REMEM$->REMEM$VAR ;
      193    13172    1     CALL IF_COMMAND ALTRET(ABORT);
      194    13173    1     GOTO SAVE_VARIABLES;
      195    13174        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:8    
      196    13175        /********************************************************************/
      197    13176        /*F*    NAME:    CPG$LET                                            */
      198    13177        /********************************************************************/
      199    13178    1   CPG$LET: ENTRY (P$PCB) ALTRET;
      200    13179        /*
      201    13180             ***** Call LET_COMMAND ...
      202    13181        */
      203    13182    1     REMEMBER CPG$BREAK_IN_EVAL IN SEG$2.REMEM$->REMEM$VAR ;
      204    13183    1     CALL LET_COMMAND ALTRET(ABORT);
      205    13184    1     GOTO SAVE_VARIABLES;
      206    13185        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:9    
      207    13186        /********************************************************************/
      208    13187        /*F*    NAME:    CPG$OUTPUT                                         */
      209    13188        /********************************************************************/
      210    13189    1   CPG$OUTPUT: ENTRY (P$PCB) ALTRET;
      211    13190        /*
      212    13191             ***** Call OUTPUT_COMMAND ...
      213    13192        */
      214    13193    1     REMEMBER CPG$BREAK_IN_EVAL IN SEG$2.REMEM$->REMEM$VAR ;
      215    13194    1     CALL OUTPUT_COMMAND ALTRET(ABORT);
      216    13195    1     GOTO SAVE_VARIABLES;
      217    13196        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:10   
      218    13197        /********************************************************************/
      219    13198        /*F*    NAME:    CPG$WHEN                                         */
      220    13199        /********************************************************************/
      221    13200    1   CPG$WHEN: ENTRY (P$PCB) ALTRET;
      222    13201
      223    13202    1     BLK$ = P$PCB.OUT$ ;
      224    13203        /*
      225    13204              Either get the WHEN control record, if one input, or create
      226    13205              one to be used for the future.
      227    13206        */
      228    13207    1     STAR_S_IS_OPEN = '0'B;
      229    13208    1     IF B$JIT.CPFLAGS1.WHEN_INPUT
      230    13209    1         THEN
      231    13210    2             DO ;
      232    13211    2               CALL CPG$GET_WHEN_CNTL_REC(CHANGED, STAR_S_IS_OPEN)
      233    13212    2                     ALTRET(GET_WHEN_CNTL_REC_ERR) ;
      234    13213    2               SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV =
      235    13214    2                                     SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.CUR_LEV ;
      236    13215    2             END ; /* Then Do */
      237    13216    1         ELSE
      238    13217    2             DO ;
      239    13218    2               IF BLK$->P$B.CODE = WHENSHORTCMND
      240    13219    2                 THEN
      241    13220    2                   GOTO WHEN_READ_ERR ;
      242    13221    2               CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(GET_WHEN_CNTL_REC_ERR) ;
      243    13222    2               STAR_S_IS_OPEN = %YES#;
      244    13223    2               SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC = CWHEN_CNTL_REC ;
      245    13224    2               SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.CUR_LEV = B$JIT.CSLEV ;
      246    13225    2               SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV = B$JIT.CSLEV ;
      247    13226    3               DO I = 0 TO B$JIT.CSLEV ;
      248    13227    3                 SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(I) = %WHEN_NONE# ;
      249    13228    3                 SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.REC(I) = %NO#;
      250    13229    3               END ; /* Do I */
      251    13230    2             END ; /* Else Do */
      252    13231    1     IF ~STAR_S_IS_OPEN
      253    13232    1       THEN
      254    13233    2         DO;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:11   
      255    13234    2           CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(GET_WHEN_CNTL_REC_ERR);
      256    13235    2           STAR_S_IS_OPEN = '1'B;
      257    13236    2         END ; /* Then Do */
      258    13237    1     IF BLK$->P$B.CODE = WHENLEVEL0CMND
      259    13238    1         THEN
      260    13239    2           DO ;
      261    13240    2             WHEN_LEVEL0 = %YES# ;
      262    13241    2             CSLEV = 0 ;
      263    13242    2           END ; /* Then Do */
      264    13243    1         ELSE
      265    13244    2           DO ;
      266    13245    2             WHEN_LEVEL0 = %NO# ;
      267    13246    2             CSLEV = B$JIT.CSLEV ;
      268    13247    2           END ; /* Else Do */
      269    13248    1     K_WHEN = CK_WHEN ;
      270    13249    1     K_WHEN.NUM = CSLEV ;
      271    13250    1     IF BLK$->P$B.CODE = WHENSHORTCMND
      272    13251    1         THEN
      273    13252                            /* 'WHEN .end' was specified. */
      274    13253    1             CALL CPJ$READ_S(M$IBEX1_NUM, VECTOR(K_WHEN), VECTOR(WRITEBUF))
      275    13254    1                                 ALTRET(WHEN_READ_ERR) ;
      276    13255    1         ELSE
      277    13256    2             DO ;
      278    13257    2               ARS = P$PCB.NCHARS ;
      279    13258    2               IF WHEN_LEVEL0
      280    13259    2                 THEN
      281    13260    3                   DO ;
      282    13261    3                     CALL INDEX (LEFTPOS, '(', P$PCB.TEXT$->B$TEXT, 0) ;
      283    13262    3                     CALL INDEX (RIGHTPOS, ')', P$PCB.TEXT$->B$TEXT, LEFTPOS) ;
      284    13263    3                     IF SUBSTR(P$PCB.TEXT$->B$TEXT, RIGHTPOS) = ')'
      285    13264    3                       THEN
      286    13265    4                         DO ;
      287    13266    4                           CALL CONCAT(WRITEBUF, '!',
      288    13267    4                             SUBSTR(P$PCB.TEXT$->B$TEXT, 0, LEFTPOS)) ;
      289    13268    4                           GOTO OUTPUT_WHENCMD ;
      290    13269    4                         END ; /* Then Do */
      291    13270    3                     IF SUBSTR(P$PCB.TEXT$->B$TEXT, RIGHTPOS+1, 1) = ' '
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:12   
      292    13271    3                       THEN
      293    13272    3                         RIGHTPOS = RIGHTPOS + 1 ;
      294    13273    3                     CALL CONCAT(WRITEBUF, '!',
      295    13274    3                           SUBSTR(P$PCB.TEXT$->B$TEXT, 0, LEFTPOS),
      296    13275    3                           ' ',
      297    13276    3                           SUBSTR(P$PCB.TEXT$->B$TEXT, RIGHTPOS+1, ARS-RIGHTPOS-1));
      298    13277    3                     ARS = ARS - (RIGHTPOS - LEFTPOS) ;
      299    13278    3                   END ; /* Then Do */
      300    13279    2                 ELSE
      301    13280    2                   CALL CONCAT(WRITEBUF, '!', P$PCB.TEXT$->B$TEXT) ;
      302    13281
      303    13282    2   OUTPUT_WHENCMD:
      304    13283    2               ARS = ARS + 1 ;
      305    13284    2               CALL CPJ$WRITE_S(M$IBEX1_NUM, VECTOR(K_WHEN), VECTOR(SUBSTR(
      306    13285    2                       WRITEBUF,0,ARS))) ALTRET(WHEN_ALTRET) ;
      307    13286    2             END ; /* Else Do */
      308    13287    1     SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(CSLEV) = %WHEN# ;
      309    13288    1     SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.REC(CSLEV) = %YES#;
      310    13289    1     CALL CPG$PUT_WHEN_CNTL_REC(STAR_S_IS_OPEN) ALTRET(WHEN_ALTRET) ;
      311    13290    1     B$JIT.CPFLAGS1.WHEN_INPUT = %YES# ;
      312    13291    1     IF CSLEV = B$JIT.CSLEV
      313    13292    1         THEN
      314    13293    1             B$JIT.PRFLAGS.WHEN = %YES# ;
      315    13294    1     CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;
      316    13295    1     RETURN ;
      317    13296
      318    13297    1   GET_WHEN_CNTL_REC_ERR:
      319    13298    1     CALL CPC$WRITEMSGE (B$JIT.USRERR,M$IBEX1_NUM);
      320    13299    1     B$JIT.USRERR = '0'O;
      321    13300    1     GOTO WHEN_ALTRET ;
      322    13301
      323    13302    1   WHEN_READ_ERR:
      324    13303    1     SEG$2.ERRBUF(1) = 0 ; /* Throw away error */
      325    13304    1     B$JIT.USRERR = '0'B ;
      326    13305    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_NOWHEN) ;
      327    13306        /*E*       ERROR: CPG-E$NOWHEN-0
      328    13307                   MESSAGE: No WHEN specified.
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:13   
      329    13308                   MESSAGE1: You have not specified a WHEN command.
      330    13309                   DESCRIPTION: The user tried to reinstate a WHEN command
      331    13310                                even though one was not specified.
      332    13311        */
      333    13312
      334    13313    1   WHEN_ALTRET:
      335    13314    1     CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;
      336    13315    1     ALTRETURN ;
      337    13316          %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:14   
      338    13317        /********************************************************************/
      339    13318        /*F*    NAME:    CPG$CHK_WHEN_CONDITION                           */
      340    13319        /********************************************************************/
      341    13320    1   CPG$CHK_WHEN_CONDITION: ENTRY(P$PCB) ALTRET;
      342    13321
      343    13322    1     CALL CPG$GET_WHEN_CNTL_REC(CHANGED, STAR_S_IS_OPEN) ALTRET(CHK_WHEN_ALT) ;
      344    13323    1     IF CHANGED
      345    13324    1       THEN
      346    13325    1         CALL CPG$PUT_WHEN_CNTL_REC(STAR_S_IS_OPEN) ALTRET(WHEN_ALTRET) ;
      347    13326    1     IF ~STAR_S_IS_OPEN
      348    13327    1       THEN
      349    13328    2         DO;
      350    13329    2             CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET (CHK_WHEN_ALT) ;
      351    13330    2             STAR_S_IS_OPEN = %YES#;
      352    13331    2         END;  /* Then Do */
      353    13332    1     IF NOT B$JIT.PRFLAGS.WHEN
      354    13333    1       THEN
      355    13334    1         GOTO CHK_WHEN_RET ;
      356    13335    1     K_WHEN = CK_WHEN ;
      357    13336    1     K_WHEN.NUM = SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV ;
      358    13337    1     CALL CPJ$READ_S(M$IBEX1_NUM, VECTOR(K_WHEN), VECTOR(WRITEBUF))
      359    13338    1             ALTRET(CHK_WHEN_ALT) ;
      360    13339    1     ARS = DCBADDR(M$IBEX1_NUM)->F$DCB.ARS# ;
      361    13340    1     U$PARAM.ERRBUF$ = ADDR(SEG$2.ERRBUF);
      362    13341    1     U$PARAM.USERS$ = ADDR(NIL);
      363    13342    1     U$PARAM.CNTU$$ = ENTADDR(NIL) ;
      364    13343    1     U$PARAM.REMEM$ = ADDR(NIL) ;
      365    13344    1     U$PARAM.SPCL$$ = ENTADDR(NIL);
      366    13345    1     U$PARAM.GETCMD$ = SEG$2.GETCMD$ ;
      367    13346    1     U$PARAM.FID_CNT = 0 ;
      368    13347    2     DO I = 0 TO %MAX_FID_BLKS - 1 ;
      369    13348    2         U$PARAM.FID_BLK$(I) = ADDR(NIL) ;
      370    13349    2     END ;   /* Do I */
      371    13350    1     P$PCB.USER$ = ADDR(U$PARAM);
      372    13351    1     SEG$2.GETCMD$->GET$CMD.PCB$ = ADDR(P$PCB);
      373    13352    1     SEG$2.GETCMD$->GET$CMD.NODES$ = ADDR(IBEX_CMD) ;
      374    13353    1     SEG$2.GETCMD$->GET$CMD.CONTINUE_OK# = %NO# ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:15   
      375    13354    1     SEG$2.GETCMD$->GET$CMD.PP_FUN$$ = ENTADDR(CPG$FUN$$) ;
      376    13355    1     SEG$2.GETCMD$->GET$CMD.SFROUTINE$ = ENTADDR(NIL);
      377    13356    1     U$PARAM.MODE = IBEX_MODE;
      378    13357    1     SEG$2.FLAGS.CONTINUED = %NO#;
      379    13358    1     SEG$2.GETCMD$->GET$CMD.TEXT_ = VECTOR(WRITEBUF) ;
      380    13359    1     VBOUND(SEG$2.GETCMD$->GET$CMD.TEXT_) = ARS - 1 ;
      381    13360    1     CALL CPC$OPEN_LL ;
      382    13361    1     CALL CPA$READCC (SEG$2.GETCMD$->GET$CMD,CMD_SOURCE) ALTRET (CHK_WHEN_ALT);
      383    13362
      384    13363    1     IF SEG$2.GETCMD$->GET$CMD.OUT$->P$B.CODE = WHENSHORTCMND
      385    13364    1         THEN
      386    13365    2             DO ;
      387    13366    2               CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_NOWHEN) ;
      388    13367    2               GOTO CHK_WHEN_ALT ;
      389    13368    2             END ; /* Then Do */
      390    13369
      391    13370    1     SEG$2.NCHARS = P$PCB.NCHARS ;
      392    13371    1     CALL CPD$SYNTAX(SEG$2.GETCMD$->GET$CMD) ALTRET(E_SYNTAX) ;
      393    13372    1     BLK$ = SEG$2.GETCMD$->GET$CMD.OUT$ ;
      394    13373    1     CALL SETUP ;
      395    13374    1     XUE_ECB.TREE$ = BLK$->P$B.SUBLK$(0) ;
      396    13375    1     CALL X$EVAL (XUE_ECB) ALTRET (E_CHK_WHEN_EVAL) ;
      397    13376        /*
      398    13377              ***** Must resolve to a numeric value for truth value.
      399    13378                    Thus 'ABC' is an error.
      400    13379        */
      401    13380    1     CALL X$DEC_CONVERT (XUE_ECB.OUT$,VALUE) ALTRET(CHK_WHEN_NON_NUMERIC) ;
      402    13381    1     IF VALUE <=0
      403    13382    1         THEN  /* False */
      404    13383    1             GOTO CHK_WHEN_RET ;
      405    13384    1     CALL CPA$ECHOCC(CMD_SOURCE, %NO#) ; /* Ehco Command thru M$LL */
      406    13385    1     BLK$ = P$PCB.OUT$ -> P$B.SUBLK$(1) ;  /* Ptr to object */
      407    13386    1     CALL INSERT (P$PCB.TEXT$->DUMMY$CHAR,,BLK$->P$B.CPOS,' ') ;
      408    13387    1     CALL CONCAT(B$JIT.CCBUF, '!', SUBSTR(P$PCB.TEXT$->DUMMY$CHAR,0,P$PCB.NCHARS));
      409    13388    1     B$JIT.CCARS = P$PCB.NCHARS + 2;
      410    13389    1     B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_BUFFULL#;
      411    13390    1     B$JIT.CPFLAGS1.SKIPABORT = %YES# ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:16   
      412    13391
      413    13392    1   CHK_WHEN_RET:
      414    13393
      415    13394    1     CALL CPC$RELSEG(SEG3$) ;
      416    13395    1     CALL CLOSE_IBEX_DCB (M$IBEX1_NUM) ;
      417    13396    1     RETURN ;
      418    13397
      419    13398    1   E_CHK_WHEN_EVAL:
      420    13399    1     CPOS = XUE_ECB.ERR_POS#;
      421    13400    1     VALUE = XUE_ECB.ERR_DCB#;
      422    13401    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_ECB.ERR,,VALUE);
      423    13402    1     GOTO CHK_WHEN_ALT;
      424    13403    1   CHK_WHEN_NON_NUMERIC:
      425    13404    1     CPOS = BLK$ -> P$B.SUBLK$(0) -> P$S.CPOS;
      426    13405    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_ILLEXP);
      427    13406    1     GOTO CHK_WHEN_ALT ;
      428    13407
      429    13408    1   E_SYNTAX:
      430    13409    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),P$PCB.HI_CHAR,SEG$2.GETCMD$
      431    13410    1                           ->GET$CMD.ERR#) ;
      432    13411
      433    13412    1   CHK_WHEN_ALT:
      434    13413
      435    13414    1     CALL CPC$RELSEG(SEG3$) ;
      436    13415    1     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#
      437    13416    1         THEN
      438    13417    1             CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;
      439    13418    1     ALTRETURN ;
      440    13419        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:17   
      441    13420        /*
      442    13421             ***** Save command VARIABLES...
      443    13422        */
      444    13423    1   SAVE_VARIABLES:
      445    13424        /*
      446    13425             ***** Reset the PROMPT if necessary ...
      447    13426        */
      448    13427    1     IF XUE_ECB.RESULTS.PROMPT#
      449    13428    1        THEN
      450    13429    1           SEG$2.GETCMD$->GET$CMD.ALWAYS_SET_PROMPT# = %YES#;
      451    13430    1     CALL CPC$RELSEG (SEG3$);
      452    13431    1     IF DCBADDR(M$IBEX1_NUM) -> F$DCB.FCD#
      453    13432    1        THEN   /* Close M$IBEX1 */
      454    13433    1           CALL CLOSE_IBEX_DCB (M$IBEX1_NUM) ;
      455    13434    1     RETURN;
      456    13435        /**/
      457    13436    1   ABORT:
      458    13437    2     DO WHILE (%NO#) ;
      459    13438
      460    13439    2   CPG$BREAK_IN_EVAL:
      461    13440    2         CALL CPC$WRITEMSGE (E_CSINT,,,,,%YES#) ;
      462    13441    2         SEG$2.FLAGS.USE_REMEM = %NO# ;
      463    13442    2     END ;   /* Do While */
      464    13443    1     CALL CPC$RELSEG (SEG3$);
      465    13444        /*
      466    13445             ***** Reset the PROMPT if necessary ...
      467    13446        */
      468    13447    1     IF XUE_ECB.RESULTS.PROMPT#
      469    13448    1        THEN
      470    13449    1           SEG$2.GETCMD$->GET$CMD.ALWAYS_SET_PROMPT# = %YES#;
      471    13450    1   ABORT_GOTO:
      472    13451    1     IF DCBADDR(M$IBEX1_NUM) -> F$DCB.FCD#
      473    13452    1        THEN   /* Close M$IBEX1 */
      474    13453    1           CALL CLOSE_IBEX_DCB (M$IBEX1_NUM) ;
      475    13454    1     ALTRETURN;
      476    13455        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:18   
      477    13456    1   IF_COMMAND: PROC ALTRET;
      478    13457    2     BLK$=P$PCB.OUT$;
      479    13458    2     CALL SETUP;
      480    13459    2     XUE_ECB.TREE$ = BLK$ -> P$B.SUBLK$(0);
      481    13460    2     SEG$2.FLAGS.USE_REMEM = %YES# ;
      482    13461    2     CALL X$EVAL (XUE_ECB) ALTRET(E_EVAL);
      483    13462    2     SEG$2.FLAGS.USE_REMEM = %NO# ;
      484    13463        /*
      485    13464             ***** Must resolve to a numeric value for truth value.
      486    13465                   Thus 'ABC' is an error.
      487    13466        */
      488    13467    2     CALL X$DEC_CONVERT (XUE_ECB.OUT$,VALUE) ALTRET(NON_NUMERIC);
      489    13468    2     IF VALUE <= 0
      490    13469    2        THEN   /* False */
      491    13470    2           P$PCB.HI_CHAR = 0; /* Set a flag so that CPA$IBEX can ignore the cmd */
      492    13471        /*
      493    13472             ***** If object ...
      494    13473                   Blank out the if command part and stuff the object
      495    13474                   into B$JIT.CCBUF. Set the flag so that ibex will
      496    13475                   "READ" from ccbuf.
      497    13476        */
      498    13477    2     BLK$ = P$PCB.OUT$ -> P$B.SUBLK$(1); /* Ptr to object */
      499    13478    2     CALL INSERT (P$PCB.TEXT$->DUMMY$CHAR,,BLK$->P$B.CPOS,' ');
      500    13479    2     TXT# = SEG$2.GETCMD$->GET$CMD.RLT$->RLT(SEG$2.GETCMD$->GET$CMD.NLINES);
      501    13480    2     TXT$ = PINCRC(P$PCB.TEXT$,P$PCB.NCHARS-TXT#);
      502    13481    2     IF SEG$2.GETCMD$ -> GET$CMD.RCVD_PROMPT#
      503    13482    2         THEN
      504    13483    3           DO ;
      505    13484    3             B$JIT.CCBUF = ' ' ;
      506    13485    3             CALL CONCAT(B$JIT.CCBUF, '!',
      507    13486    3                         SUBSTR(TXT$->DUMMY$CHAR,0,TXT#)) ;
      508    13487    3             B$JIT.CCARS = TXT# + 1 ;
      509    13488    3           END ; /* Then Do */
      510    13489    2         ELSE
      511    13490    3           DO ;
      512    13491    3             B$JIT.CCBUF = SUBSTR(TXT$->DUMMY$CHAR,0,TXT#) ;
      513    13492    3             B$JIT.CCARS = TXT# ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:19   
      514    13493    3           END ; /* Else Do */
      515    13494    2     B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_BUFFULL#;
      516    13495    2     SEG$2.FLAGS.USE_CCBUF_IF_YC = %YES# ;
      517    13496    2     RETURN;
      518    13497        /**/
      519    13498    2   E_EVAL:
      520    13499    2     SEG$2.FLAGS.USE_REMEM = %NO# ;
      521    13500    2     CPOS = XUE_ECB.ERR_POS#;
      522    13501    2     VALUE = XUE_ECB.ERR_DCB#;
      523    13502    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_ECB.ERR,,VALUE);
      524    13503    2     ALTRETURN;
      525    13504    2   NON_NUMERIC:
      526    13505    2     CPOS = BLK$ -> P$B.SUBLK$(0) -> P$S.CPOS;
      527    13506    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_ILLEXP);
      528    13507    2     ALTRETURN;
      529    13508    2   END IF_COMMAND;
      530    13509        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:20   
      531    13510    1   LET_COMMAND: PROC ALTRET;
      532    13511        /*E*       ERROR: CPG-E$ILLEXP-0
      533    13512                   MESSAGE: Illegal expression. Must resolve to NUMERIC value
      534    13513        */
      535    13514        /*
      536    13515             **** Let command...
      537    13516        */
      538    13517    2     BLK$=P$PCB.OUT$;
      539    13518    2     CALL SETUP;
      540    13519    2     IF (BLK$ -> P$B.NSUBLKS = 0) OR (BLK$->P$B.CODE = DVARIABLESOPT)
      541    13520    2        THEN
      542    13521                    /* No options means list COMMAND VARIABLES, BANNERTEXT,
      543    13522                        or REGISTERNAME.
      544    13523                    */
      545    13524    2           GOTO LET_LIST;
      546    13525    2     IF BLK$ -> P$B.SUBLK$(0) -> P$B.CODE = %LET_DELETE#
      547    13526    2        THEN   /* LET DELETE [ var [,var]... ] */
      548    13527    2           GOTO LET_DELETE;
      549    13528    2     IF BLK$ -> P$B.SUBLK$(0) -> P$B.CODE = %LET_BANNERTEXT#
      550    13529    2        THEN   /* LET BANNERTEXTx ='text' */
      551    13530    2           GOTO LET_BANNERTEXT;
      552    13531    2     IF BLK$ -> P$B.CODE = %DBANNERTEXTOPT# OR
      553    13532    2         BLK$ -> P$B.CODE = %DREGISTERNAMEOPT#
      554    13533    2        THEN   /* DI BANNERTEXT or DI REGISTERNAME */
      555    13534    2          GOTO LET_LIST;
      556    13535        /*
      557    13536             ***** Let var = exp ...
      558    13537        */
      559    13538    2     INDX1=0;
      560    13539    3     DO WHILE (INDX1 < BLK$->P$B.NSUBLKS);
      561    13540    3        NAME$=BLK$ -> P$B.SUBLK$(INDX1);
      562    13541    3        INDX1=INDX1+1;
      563    13542        /*
      564    13543             ***** Get the value that is to be stored...
      565    13544        */
      566    13545    3     XUE_ECB.TREE$ = BLK$ -> P$B.SUBLK$(INDX1);
      567    13546    3     SEG$2.FLAGS.USE_REMEM = %YES# ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:21   
      568    13547    3     CALL X$EVAL (XUE_ECB) ALTRET(E_LET);
      569    13548    3     SEG$2.FLAGS.USE_REMEM = %NO# ;
      570    13549        /*
      571    13550             ***** Don't allow lets of special values...
      572    13551        */
      573    13552    3        CALL XLATE (SUBSTR(TEMPBUF,0,8), B$XL_UPPER, NAME$ -> P$S.TEXT);
      574    13553    3        IF SUBSTR(TEMPBUF,0,4) = 'OK'
      575    13554    3          OR SUBSTR(TEMPBUF,0,8) = 'ERROR'
      576    13555    3          OR SUBSTR(TEMPBUF,0,8) = 'ABORT'
      577    13556    3           THEN
      578    13557    4              DO;
      579    13558    4                 CPOS = BLK$ -> P$B.SUBLK$(INDX1) -> P$S.CPOS;
      580    13559    4                 CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_READONLYLET);
      581    13560    4                 ALTRETURN;
      582    13561    4              END;
      583    13562        /*E*       ERROR: CPG-E$READONLYLET-0
      584    13563                   MESSAGE: OK, ERROR, and ABORT cannot be modified.
      585    13564        */
      586    13565        /*
      587    13566             ***** Store the value in B$JIT.STEPCC or a command VARIABLE...
      588    13567        */
      589    13568    3        IF SUBSTR(TEMPBUF,0,8) = 'STEPCC'
      590    13569    3           THEN
      591    13570    4              DO; /* Stepcc */
      592    13571    4                 CALL X$DEC_CONVERT (XUE_ECB.OUT$,VALUE) ALTRET(NON_NUMERIC);
      593    13572    4                 IF VALUE > 511
      594    13573    4                    THEN
      595    13574    5                       DO; /* flag it */
      596    13575    5                          CPOS = BLK$ -> P$B.SUBLK$(INDX1) -> P$S.CPOS;
      597    13576    5                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_XBIG511);
      598    13577    5                          ALTRETURN;
      599    13578    5                       END;
      600    13579        /*E*    ERROR: CPG-E$XBIG511-C
      601    13580                MESSAGE: STEPCC can not be greater than 511.
      602    13581                DESCRIPTION: The user tried to set the STEPCC to a value
      603    13582                              greater than 511.
      604    13583        */
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:22   
      605    13584    4                 B$JIT.STEPCC = VALUE;
      606    13585    4                 GOTO END_LOOP;
      607    13586    4              END;
      608    13587    3           ELSE
      609    13588    4              DO; /* Command variable */
      610    13589    4                 CPOS = BLK$ -> P$B.SUBLK$(INDX1) -> P$S.CPOS;
      611    13590    4                 CALL X$PUT_VAR (NAME$->P$S.TEXTC$, XUE_ECB.OUT$, XUE_ECB,
      612    13591    4                               CPOS, %XUE_EXTERNAL#) ALTRET(E_LET) ;
      613    13592    4              END;
      614    13593    3   END_LOOP: INDX1=INDX1+1;
      615    13594    3     END; /* Do while ... End */
      616    13595    2     RETURN;
      617    13596        /*
      618    13597             ***** List COMMAND VARIABLES ...
      619    13598        */
      620    13599    2   LET_LIST:
      621    13600    2     CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(E_ROUTINE);
      622    13601    2     IF BLK$->P$B.CODE = %DBANNERTEXTOPT# OR
      623    13602    2              BLK$->P$B.CODE = %DREGISTERNAMEOPT#
      624    13603    2       THEN
      625    13604    3         DO ;
      626    13605    3           PERM = %NO# ;
      627    13606    3           IF BLK$->P$B.NSUBLKS > 0
      628    13607    3             THEN
      629    13608    3               IF BLK$->P$B.SUBLK$(0)->P$B.CODE = %BANNERTEXT_PERM#
      630    13609    3                 THEN
      631    13610    3                   PERM = %YES# ;
      632    13611    4           DO CASE(BLK$->P$B.CODE) ;
      633    13612
      634    13613    4             CASE(%DBANNERTEXTOPT#) ;
      635    13614    4               CALL LIST_BANNERTEXT ALTRET(BANNERTEXT_ALT) ;
      636    13615
      637    13616    4             CASE(%DREGISTERNAMEOPT#) ;
      638    13617    4               CALL LIST_REGISTERNAME ALTRET(BANNERTEXT_ALT) ;
      639    13618
      640    13619    4           END ; /* Do Case */
      641    13620    3           CALL REOPEN_CS ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:23   
      642    13621    3           RETURN ;
      643    13622    3         END ; /* Then Do */
      644    13623    2     IF BLK$->P$B.CODE ~= LETCMND AND BLK$->P$B.CODE ~= DVARIABLESOPT
      645    13624    2       THEN
      646    13625    3         DO ;
      647    13626    3           PERM = %YES# ;
      648    13627    3           CALL LIST_REGISTERNAME ALTRET(BANNERTEXT_ALT) ;
      649    13628    3           CALL LIST_BANNERTEXT ALTRET(BANNERTEXT_ALT) ;
      650    13629    3           PERM = %NO# ;
      651    13630    3           CALL LIST_REGISTERNAME ALTRET(BANNERTEXT_ALT) ;
      652    13631    3           CALL LIST_BANNERTEXT ALTRET(BANNERTEXT_ALT) ;
      653    13632    3           CALL REOPEN_CS ;
      654    13633    3         END ; /* Then Do */
      655    13634        /*
      656    13635             ***** Init FPTs and flags ...
      657    13636        */
      658    13637    2     FPT_PRECORD = CFPT_PRECORD;
      659    13638    2     FPT_PRECORD.V_ = VECTOR(FPT_PRECORD.V);
      660    13639    2     FPT_PRECORD.KEY_ = VECTOR(FKEY);
      661    13640    2     FPT_PRECORD.V.DCB# = M$IBEX1_NUM;
      662    13641    2     FPT_PRECORD.V.KEYS# = %YES#;
      663    13642        /**/
      664    13643    2     FPT_READ = CFPT_READ;
      665    13644    2     FPT_READ.V_ = VECTOR(FPT_READ.V);
      666    13645    2     FPT_READ.V.DCB# = M$IBEX1_NUM;
      667    13646    2     FPT_READ.V.KEYR# = %YES#;
      668    13647    2     FPT_READ.KEY_ = VECTOR(KEY);
      669    13648    2     FPT_READ.BUF_ = VECTOR(TEMPBUF);
      670    13649        /**/
      671    13650    2     SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_ = VECTOR(WRITEBUF);
      672    13651    2     PRINT_HDR# = %NO#;   /* HDR not yet printed */
      673    13652        /*
      674    13653             ***** Position to first COMMAND VARIABLE ...
      675    13654        */
      676    13655    2     CALL M$PRECORD (FPT_PRECORD)
      677    13656    3     WHENALTRETURN DO; /* If E$NOKEY then success, else ABORT!!! */
      678    13657    3        IF B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$NOKEY
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:24   
      679    13658    3           THEN
      680    13659    3              GOTO E_PMME;
      681    13660    3     END;
      682    13661        /*
      683    13662             ***** Read, format and print all COMMAND VARIABLES ...
      684    13663        */
      685    13664    2     WILD_VAR$ = ADDR(NIL);
      686    13665    2     IF (BLK$->P$B.CODE = DVARIABLESOPT) AND (BLK$->P$B.NSUBLKS > 0)
      687    13666    2       THEN WILD_VAR$ = BLK$ -> P$B.SUBLK$(0) -> P$S.TEXTC$;
      688    13667    3     DO WHILE (%YES#);
      689    13668    4        CALL M$READ (FPT_READ) WHENALTRETURN DO; END;
      690    13669    3        IF KEY.L < LENGTHC('VAR_')
      691    13670    3        OR SUBSTR(KEY.N,0,4) ~= 'VAR_'
      692    13671    3           THEN   /* Reached the end */
      693    13672    4              DO;
      694    13673    4   LIST_RETURN:
      695    13674    4                 IF PRINT_HDR# = %NO#
      696    13675    4                    THEN   /* No HDR printed yet. Thus no COMMAND VARIABLES */
      697    13676    5                       DO;
      698    13677    5                          WRITEBUF = '   Command Variables: None';
      699    13678    5                          SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = 25;
      700    13679    5                          CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$);
      701    13680    5                       END;
      702    13681    4                 RETURN;
      703    13682    4              END;
      704    13683        /*
      705    13684             ***** Print the COMMAND VARIABLE ...
      706    13685        */
      707    13686    3        KEY_VAR.L = KEY.L - 4;
      708    13687    3        KEY_VAR.N = SUBSTR (KEY.N, 4);
      709    13688    3        CALL CPB$WILDCMPR (KEY_VAR, WILD_VAR)
      710    13689    4        WHENRETURN DO;
      711    13690    4          IF PRINT_HDR# = %NO#
      712    13691    4             THEN   /* Print the header first */
      713    13692    5                DO;
      714    13693    5                   PRINT_HDR# = %YES#;
      715    13694    5                   WRITEBUF = '   Command Variables:';
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:25   
      716    13695    5                   SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = 20;
      717    13696    5                   CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$);
      718    13697    5                END;
      719    13698    4          CALL CONCAT (WRITEBUF,'      ',SUBSTR(KEY_VAR.N,0,KEY_VAR.L),
      720    13699    4               ' = ''',SUBSTR(TEMPBUF,0,DCBADDR(M$IBEX1_NUM)->F$DCB.ARS#),
      721    13700    4               '''');
      722    13701    4          SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = (KEY.L-4) +
      723    13702    4                DCBADDR(M$IBEX1_NUM) -> F$DCB.ARS# + 11;
      724    13703    4          CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$);
      725    13704    4        END;
      726    13705    3     END;   /* Do while ... end */
      727    13706        /*
      728    13707             ***** Delete COMMAND VARIABLES ...
      729    13708        */
      730    13709    2   LET_DELETE:
      731    13710    2     NAME$ = BLK$ -> P$B.SUBLK$(0);
      732    13711    2     CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(E_PMME);
      733    13712        /*
      734    13713             ***** Init FPT_DELREC ...
      735    13714        */
      736    13715    2     FPT_DELREC = CFPT_DELREC;
      737    13716    2     FPT_DELREC.V_ = VECTOR(FPT_DELREC.V);
      738    13717    2     FPT_DELREC.V.DCB# = M$IBEX1_NUM;
      739    13718    2     FPT_DELREC.KEY_ = VECTOR(KEY);
      740    13719        /*
      741    13720             ***** Determine whether to delete all or
      742    13721                   just part of the COMMAND VARIABLES ...
      743    13722        */
      744    13723    2     IF NAME$ -> P$B.NSUBLKS > 0
      745    13724    2        THEN   /* List of VARIABLES specified */
      746    13725    3           DO INDX1 = 0 TO NAME$ -> P$B.NSUBLKS - 1;
      747    13726    3              KEY.L = NAME$ -> P$B.SUBLK$(INDX1) -> P$S.COUNT + SIZEC('VAR_');
      748    13727    3              CALL CONCAT (KEY.N,'VAR_',NAME$ -> P$B.SUBLK$(INDX1) -> P$S.TEXT);
      749    13728    3              CALL M$DELREC (FPT_DELREC) ALTRET(MS_COMVAR);
      750    13729    4              DO WHILE (%NO#);
      751    13730        /*E*    ERROR: CPG-E$MSCOMVAR-0
      752    13731                MESSAGE: That COMMAND VARIABLE doesn't exist.
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:26   
      753    13732        */
      754    13733    4   MS_COMVAR:
      755    13734    4                 CPOS = NAME$ -> P$B.SUBLK$(INDX1) -> P$B.CPOS;
      756    13735    4                 CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_MSCOMVAR);
      757    13736    4              END;
      758    13737    3           END;   /* Delete only those in list */
      759    13738    2        ELSE   /* Delete all COMMAND VARIABLES */
      760    13739    3           DO;
      761    13740    3              FPT_DELREC.LKEY_ = VECTOR(LKEY);
      762    13741    3              FPT_DELREC.KEY_ = VECTOR(FKEY);
      763    13742    3              CALL M$DELREC (FPT_DELREC) ALTRET(E_PMME);
      764    13743    3           END;
      765    13744    2     IF SEG$2.ERRBUF(1) ~= 0
      766    13745    2        THEN   /* Errors */
      767    13746    2           ALTRETURN;
      768    13747    2        ELSE
      769    13748    2           RETURN;
      770    13749        /*
      771    13750             ***** Setup the BANNERTEXT ...
      772    13751        */
      773    13752    2   LET_BANNERTEXT:
      774    13753    2     CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET (E_BANNER_ROUTINE) ;
      775    13754    2     BLK$ = BLK$ -> P$B.SUBLK$(0) ;
      776    13755    2     TXT# = BLK$ -> P$B.SUBLK$(0) -> P$B.CODE ;
      777    13756    2     IF TXT# = %BANNERTEXT_RESET#
      778    13757    2       THEN
      779    13758    3         DO ;
      780    13759    3           CALL GET_BANNER_USERS ALTRET(BANNERTEXT_ALT) ;
      781    13760    3           CALL ALA$BANNER2_STAR_S(SEG$2.USERS$, M$IBEX1_NUM, B$JIT.USRERR)
             13760                    WHENALTRETURN
      782    13761    4                   DO ;
      783    13762    4                     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511, B$JIT.USRERR) ;
      784    13763    4                     GOTO CLOSE_BOTH_DCB_ALT ;
      785    13764    4                   END ; /* Whenaltreturn Do */
      786    13765    3           CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;
      787    13766    3           CALL REOPEN_CS ;
      788    13767    3           RETURN ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:27   
      789    13768    3         END ; /* Then Do */
      790    13769        /*
      791    13770             ***** Get the value that is to be stored
      792    13771        */
      793    13772    2     TXT$ = ADDR(NIL_TXTC);
      794    13773    2     IF BLK$ -> P$B.NSUBLKS > 1   /* a BANNERTEXT expression exists */
      795    13774    3       THEN DO;
      796    13775    3         XUE_ECB.TREE$ = BLK$ -> P$B.SUBLK$(1);
      797    13776    3         SEG$2.FLAGS.USE_REMEM = %YES#;
      798    13777    3         CALL X$EVAL (XUE_ECB) ALTRET (E_LET);
      799    13778    3         SEG$2.FLAGS.USE_REMEM = %NO#;
      800    13779    3         TXT$ = XUE_ECB.OUT$;
      801    13780    3       END;  /* then do */
      802    13781    2     PERM = %NO# ;
      803    13782    2     IF BLK$ -> P$B.NSUBLKS > 2
      804    13783    2       THEN
      805    13784    2         IF BLK$ -> P$B.SUBLK$(2) -> P$B.CODE = %BANNERTEXT_PERM#
      806    13785    2           THEN
      807    13786    2             PERM = %YES# ;
      808    13787    2     IF TXT# = 0
      809    13788    2       THEN
      810    13789    3         DO ;
      811    13790    3           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511, E_BADBANNERTEXT0) ;
      812    13791    3           GOTO BANNERTEXT_ALT ;
      813    13792    3         END ; /* Then Do */
      814    13793        /*E*       ERROR: CPG-E$BADBANNERTEXT0-0
      815    13794                   MESSAGE: You can not change your REGISTERED name.
      816    13795                   MESSAGE1: Your REGISTERED name is BANNERTEXT0.
      817    13796                   DESCRIPTION: The user tried to change his REGISTERED name
      818    13797                                (BANNERTEXT0). The user is not allowed to change
      819    13798                                this bannertext.
      820    13799        */
      821    13800    2     IF TXT$C.SIZ > 80
      822    13801    2       THEN
      823    13802    3         DO ;
      824    13803    3           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511, E_ILLBANNERTEXTLEN) ;
      825    13804    3           GOTO BANNERTEXT_ALT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:28   
      826    13805    3         END ; /* Then Do */
      827    13806        /*E*       ERROR: CPG-E$ILLBANNERTEXTLEN-0
      828    13807                   MESSAGE: BANNERTEXT too long.
      829    13808                   MESSAGE1: The text of a BANNERTEXT can be at most 80 characters long.
      830    13809                   DESCRIPTION: The user tried to input a BANNERTEXT that was
      831    13810                                greater than 80 characters in length.
      832    13811        */
      833    13812    2     CALL GET_BANNER_RECORD ALTRET(BANNERTEXT_ALT) ;
      834    13813    2     IF SEG3$->FS$BANNER.PERM(TXT#)
      835    13814    2       THEN
      836    13815    3         DO ;
      837    13816    3           F1_TEXT.CNT = 1 ;
      838    13817    3           CALL BINCHAR(F1_TEXT.TXT, TXT#) ;
      839    13818    3           CALL CPC$WRITEMSGE (E_UNALTBANNERTEXT,M$IBEX1_NUM,F1_TEXT,,,%YES#) ;
      840    13819    3           GOTO CLOSE_M$IBEX1_ALT ;
      841    13820    3         END ; /* Then Do */
      842    13821        /*E*       ERROR: CPG-E$UNALTBANNERTEXT-0
      843    13822                   MESSAGE: BANNERTEXT%U1 unalterable.
      844    13823                   MESSAGE1: You are unable to alter the text of a BANNERTEXT%U1.
      845    13824                   DESCRIPTION: The user tried to input text for a BANNERTEXT that
      846    13825                                he was not able to change.
      847    13826        */
      848    13827    2     IF PERM
      849    13828    2       THEN
      850    13829    3         DO ;
      851    13830    3           CALL CLOSE_IBEX_DCB(M$IBEX_NUM) ;
      852    13831    3           SEG$2.FLAGS.USERS = %NO# ;
      853    13832    3           CALL CPC$RDUSERS (M$IBEX_NUM, %UPDATE#) ALTRET(CLOSE_M$IBEX1_ALT) ;
      854    13833    3           CALL ASC$BANNER (SEG$2.USERS$, TXT#, TXT$C) ALTRET (BANNERTEXT_ERR) ;
      855    13834    3           CALL CPC$WRUSERS (M$IBEX_NUM) ALTRET(CLOSE_BOTH_DCB_ALT) ;
      856    13835    3           CALL REOPEN_CS ;
      857    13836    3         END ; /* Then Do */
      858    13837
      859    13838    2     IF SEG3$->FS$BANNER.TEXT_OFF(TXT#) = -1
      860    13839    2       THEN
      861    13840    2         GOTO NOT_EQUAL ;
      862    13841    2     ARRY$ = PINCRC(SEG3$, SEG3$->FS$BANNER.TEXT_OFF(TXT#)) ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:29   
      863    13842    2     IF TXT$C.SIZ = ARRY$->TEXT.LENGTH_
      864    13843    2       THEN
      865    13844    3         DO ;
      866    13845    3           ARRY$->TEXT.VAL = TXT$C.TEXT ;
      867    13846    3           ARRY$ = PINCRC(SEG3$, SEG3$->FS$BANNER.TEXT_OFF(TXT#)) ;
      868    13847    3           ARS = DCBADDR(M$IBEX1_NUM) -> F$DCB.ARS# ;
      869    13848    3         END ; /* Then Do */
      870    13849    2       ELSE
      871    13850    3         DO ;
      872    13851    3   NOT_EQUAL:
      873    13852    3           CALL SEPERATE_BANNER_STAR ;
      874    13853    3           BANNER$BUF.CNT(TXT#) = TXT$C.SIZ ;
      875    13854    3           BANNER$BUF.TXT(TXT#) = TXT$C.TEXT ;
      876    13855    3           CALL REBUILD_BANNER ;
      877    13856    3         END ; /* Else Do */
      878    13857    2     BANNER_VEC = VECTOR(SEG3$->STARBANNER$BUF) ;
      879    13858    2     VBOUND(BANNER_VEC) = ARS-1 ;
      880    13859    2     CALL CPJ$WRITE_S(M$IBEX1_NUM, VECTOR(KEY), BANNER_VEC) ALTRET(CLOSE_M$IBEX1_ALT) ;
      881    13860    2     CALL REOPEN_CS ;
      882    13861    2     RETURN ;
      883    13862    2   E_BANNER_ROUTINE:   /* Handle errors from subroutines for BANNERTEXT */
      884    13863    2     CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR) ;
      885    13864    2     CALL REOPEN_CS ;
      886    13865    2     ALTRETURN;
      887    13866        /**/
      888    13867    2   E_ROUTINE:   /* Handle errors from subroutines */
      889    13868    2     CALL CPC$WRITEMSGE (B$JIT.USRERR,M$IBEX1_NUM);
      890    13869    2     B$JIT.USRERR = '0'O;
      891    13870    2     ALTRETURN;
      892    13871        /**/
      893    13872        /**/
      894    13873    2   E_PMME:   /* Handle errors from PMMEs */
      895    13874    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$ -> B$ALT.ERR,,
      896    13875    2           B$TCB.ALT$ -> B$ALT.DCB#);
      897    13876    2   BANNERTEXT_ALT:
      898    13877    3     DO WHILE (%NO#) ;
      899    13878    3   CLOSE_BOTH_DCB_ALT:
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:30   
      900    13879    3         CALL REOPEN_CS ;
      901    13880
      902    13881    3   CLOSE_M$IBEX1_ALT:
      903    13882    3         CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;
      904    13883    3     END ;   /* Do While */
      905    13884    2     ALTRETURN;
      906    13885        /**/
      907    13886    2   BANNERTEXT_ERR:
      908    13887    2           F1_TEXT.CNT = 1 ;
      909    13888    2           CALL BINCHAR(F1_TEXT.TXT, TXT#) ;
      910    13889    2           CALL CPC$WRITEMSGE (E_NOROOM4BANNERTEXT, M$IBEX1_NUM, F1_TEXT,,,%YES#) ;
      911    13890        /*E*       ERROR: CPG-E$NOROOM4BANNERTEXT-0
      912    13891                   MESSAGE: No room to put BANNERTEXT%U1.
      913    13892                   MESSAGE1: Because of the size of your SETUPs and BANNERTEXTs
      914    13893                             there is no more room for BANNERTEXT%U1.
      915    13894                   DESCRIPTION: The user has run out of space for a BANNERTEXT
      916    13895                                in his :USERS file.
      917    13896        */
      918    13897    2     ALTRETURN ;
      919    13898    2   E_LET:
      920    13899    2     SEG$2.FLAGS.USE_REMEM = %NO# ;
      921    13900    2     CPOS = XUE_ECB.ERR_POS#;
      922    13901    2     VALUE = XUE_ECB.ERR_DCB#;
      923    13902    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_ECB.ERR,,VALUE);
      924    13903    2     ALTRETURN;
      925    13904    2   NON_NUMERIC:
      926    13905    2     CPOS = NAME$ -> P$S.CPOS;
      927    13906    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_NONDECIMAL);
      928    13907    2     ALTRETURN;
      929    13908    2   END LET_COMMAND;
      930    13909        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:31   
      931    13910    1   GOTO_COMMAND: PROC ALTRET;
      932    13911        /*
      933    13912             ***** implement the goto command ...
      934    13913        */
      935    13914    2     BLK$=P$PCB.OUT$;
      936    13915    2     NAME$=BLK$->P$B.SUBLK$(0)->P$S.TEXTC$;
      937    13916        /*E*    ERROR: CPG-E$MLBL-0
      938    13917                MESSAGE: Missing label
      939    13918        */
      940    13919        /*E*    ERROR: CPG-E$ILLGOTO-C
      941    13920                MESSAGE: GOTO not allowed except in command file
      942    13921        */
      943    13922    2     IF DCBADDR(M$IBEX_NUM)->F$DCB.DDEV.IC#
      944    13923    2        THEN
      945    13924    3           DO;
      946    13925    3              CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_ILLGOTO);
      947    13926    3              ALTRETURN;
      948    13927    3           END;
      949    13928        /*
      950    13929             ***** Initialize ...
      951    13930        */
      952    13931    2     SECOND_PASS# = %NO#;
      953    13932    2     TEMPBUF = SEG$2.CPBUFF$ -> CP$BUFF ;       /* Save for possible use later */
      954    13933        /*
      955    13934             ***** Start looking for the label...
      956    13935        */
      957    13936    3     DO WHILE (%YES#);
      958    13937        /*
      959    13938             ***** read the next record, scan for label...
      960    13939        */
      961    13940    3   READ:
      962    13941        /*
      963    13942             ***** If this record is the last one in the COMMAND FILE
      964    13943                   and we did not find the specified LABEL then rewind
      965    13944                   the COMMAND FILE and make one more pass. The requested
      966    13945                   LABEL may be a backwards ref. If we still dont find it
      967    13946                   then is is missing and the user gets a C- for effort ...
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:32   
      968    13947        */
      969    13948    3        IF DCBADDR(M$IBEX_NUM) -> F$DCB.DVBYTE.TOP#
      970    13949    3        OR B$JIT.NEXTCC = %CC_FROMNO#
      971    13950    3           THEN
      972    13951    4              DO;
      973    13952    4                 IF SECOND_PASS# = %NO#
      974    13953    4                    THEN
      975    13954    5                       DO;
      976    13955    5                          SECOND_PASS# = %YES#;
      977    13956    5                          FPT_REW = CFPT_REW;
      978    13957    5                          FPT_REW.V_ = VECTOR(FPT_REW.V);
      979    13958    5                          FPT_REW.V.DCB# = M$IBEX_NUM;
      980    13959    5                          CALL M$REW (FPT_REW) ALTRET(E_PMME);
      981    13960    5                       END;
      982    13961    4                    ELSE   /* Missing label */
      983    13962    4                       GOTO MSING_LABEL;
      984    13963    4              END;
      985    13964    3        SEG$2.CPBUFF$ -> CP$BUFF = ' ';
      986    13965    3        SEG$2.FPT_READCC$->FPT$READCC.BUF_ = VECTOR(SEG$2.CPBUFF$->CP$BUFF) ;
      987    13966    3        SEG$2.FPT_READCC$->FPT$READCC.V.DCB# = SEG$2.GETCMD$->GET$CMD.INDCB# ;
      988    13967    3        CALL M$READ (SEG$2.FPT_READCC$ -> FPT$READCC) ALTRET(E_READ);
      989    13968    4        DO WHILE (%NO#);
      990    13969    4   E_READ:
      991    13970    4           IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$EOF
      992    13971    4              THEN   /* Just a !EOD. Ignore */
      993    13972    4                 GOTO READ;
      994    13973    4              ELSE
      995    13974    4                 GOTO E_PMME;
      996    13975    4        END;
      997    13976        /**/
      998    13977    3        IF SUBSTR(SEG$2.CPBUFF$ -> CP$BUFF,0,1) ~= '!'
      999    13978    3           THEN
     1000    13979    3              GOTO READ;
     1001    13980    3        CALL INDEX (INDX1,': ',SEG$2.CPBUFF$ -> CP$BUFF) ALTRET(READ);
     1002    13981    3        CALL SEARCH (CPOS, DUMMY, B$SR_NON_BLANK, SUBSTR(SEG$2.CPBUFF$->
     1003    13982    3                     CP$BUFF, 1, INDX1-1)) ALTRET(READ);
     1004    13983    3        IF SUBSTR(SEG$2.CPBUFF$ -> CP$BUFF,CPOS+1,INDX1-CPOS-1) = NAME$->X$STRING.TEXT
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:33   
     1005    13984    3           THEN
     1006    13985    4              DO; /* Found the correct label */
     1007    13986    4                 B$JIT.CCBUF=SEG$2.CPBUFF$ -> CP$BUFF ;
     1008    13987    4                 B$JIT.CCARS = DCBADDR(M$IBEX_NUM) -> F$DCB.ARS#;
     1009    13988    4                 B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_BUFFULL#;
     1010    13989    4                 B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_CFREAD# ;
     1011    13990    4                 RETURN;
     1012    13991    4              END;
     1013    13992    3     END;
     1014    13993    2   MSING_LABEL:
     1015    13994    2     SEG$2.CPBUFF$ -> CP$BUFF = TEMPBUF ;       /* Stuff command in error back */
     1016    13995    2     INDX1 = BLK$ -> P$B.SUBLK$(0) -> P$B.CPOS;
     1017    13996    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),INDX1,E_MLBL);
     1018    13997    2     B$JIT.USRERR = '0'O;
     1019    13998    2     ALTRETURN;
     1020    13999    2   E_PMME:
     1021    14000    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$ -> B$ALT.ERR,,
     1022    14001    2           B$TCB.ALT$ -> B$ALT.DCB#);
     1023    14002    2     ALTRETURN;
     1024    14003    2   END GOTO_COMMAND;
     1025    14004        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:34   
     1026    14005    1   OUTPUT_COMMAND: PROC ALTRET;
     1027    14006        /*
     1028    14007             ***** Implement the OUTPUT command ...
     1029    14008        */
     1030    14009    2     BLK$ = P$PCB.OUT$;
     1031    14010    2     CALL SETUP;
     1032    14011    3     DO INDX1 = 0 TO BLK$ -> P$B.NSUBLKS - 1;
     1033    14012    3        XUE_ECB.TREE$ = BLK$ -> P$B.SUBLK$(INDX1);
     1034    14013    3     SEG$2.FLAGS.USE_REMEM = %YES# ;
     1035    14014    3     CALL X$EVAL (XUE_ECB) ALTRET(E_OUTPUT);
     1036    14015    3     SEG$2.FLAGS.USE_REMEM = %NO# ;
     1037    14016    3        IF XUE_ECB.OUT$ -> X$STRING.SIZ = 0
     1038    14017    3           THEN   /* Write a NULL string */
     1039    14018    3              SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_ = VECTOR(NIL);
     1040    14019    3           ELSE   /* Normal record */
     1041    14020    3              SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_ =
     1042    14021    3                    VECTOR(XUE_ECB.OUT$ -> X$STRING.TEXT);
     1043    14022    3        CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$);
     1044    14023    3     END;   /* Driving loop */
     1045    14024    2     RETURN;
     1046    14025        /**/
     1047    14026    2   E_OUTPUT:
     1048    14027    2     SEG$2.FLAGS.USE_REMEM = %NO# ;
     1049    14028    2     CPOS = XUE_ECB.ERR_POS#;
     1050    14029    2     VALUE = XUE_ECB.ERR_DCB#;
     1051    14030    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_ECB.ERR,,VALUE);
     1052    14031    2     ALTRETURN;
     1053    14032    2   END OUTPUT_COMMAND;
     1054    14033        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:35   
     1055    14034    1   SETUP: PROC;
     1056    14035        /*
     1057    14036             ***** Get a page for a workspace ...
     1058    14037        */
     1059    14038    2     CALL CPC$GETSEG (SEG3$,2048) ALTRET(E_SETUP);
     1060    14039        /*
     1061    14040             ***** Initialize XUE_ECB ...
     1062    14041        */
     1063    14042    2     XUE_ECB = CXUE_ECB;   /* Move constant version into auto */
     1064    14043    2     XUE_ECB.WORK$ = SEG3$;
     1065    14044    2     XUE_ECB.WKSZ# = 2048;
     1066    14045    2     XUE_ECB.WORK_DCB# = M$IBEX1_NUM;
     1067    14046    2     XUE_ECB.FUN$$ = ENTADDR(CPG$FUN$$);
     1068    14047    2     XUE_ECB.PROCNAME_ = VECTOR(IBEX_NAME);
     1069    14048        /*
     1070    14049             ***** Misc. inits. ...
     1071    14050        */
     1072    14051    2     GOT_BANNERTEXT_REC = %NO# ;
     1073    14052    2     BANNER_USERS_SPLIT = %NO# ;
     1074    14053    2     BANNER_STAR_SPLIT = %NO# ;
     1075    14054        /**/
     1076    14055    2     RETURN;
     1077    14056    2   E_SETUP:
     1078    14057    2     CALL CPC$WRITEMSGE (B$JIT.USRERR);
     1079    14058    2     RETURN;
     1080    14059    2   END SETUP;
     1081    14060        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:36   
     1082    14061    1   GET_BANNER_USERS: PROC ALTRET ;
     1083    14062
     1084    14063    2     IF NOT SEG$2.FLAGS.USERS
     1085    14064    2       THEN
     1086    14065    3         DO ;
     1087    14066    3           CALL CLOSE_IBEX_DCB(M$IBEX_NUM) ;
     1088    14067    3           CALL CPC$RDUSERS(M$IBEX_NUM, %IN#) ALTRET(RDUSERS_ERR) ;
     1089    14068    3           CALL REOPEN_CS ;
     1090    14069    3         END ; /* Then Do */
     1091    14070
     1092    14071    2     RETURN ;
     1093    14072
     1094    14073    2   RDUSERS_ERR:
     1095    14074    2     CALL REOPEN_CS ;
     1096    14075    2     CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;
     1097    14076    2     ALTRETURN ;
     1098    14077    2   END   GET_BANNER_USERS ;
     1099    14078        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:37   
     1100    14079    1   GET_BANNER_RECORD:  PROC  ALTRET ;
     1101    14080
     1102    14081    2     IF NOT GOT_BANNERTEXT_REC
     1103    14082    2       THEN
     1104    14083    3         DO ;
     1105    14084    3           KEY.L = 10 ;
     1106    14085    3           KEY.N = 'BANNERTEXT' ;
     1107    14086    3           CALL CPJ$READ_S(M$IBEX1_NUM, VECTOR(KEY), VECTOR(SEG3$->STARBANNER$BUF))
     1108    14087    3                 ALTRET(READ_S_ERR) ;
     1109    14088    3           GOT_BANNERTEXT_REC = %YES# ;
     1110    14089    3         END ; /* Then Do */
     1111    14090
     1112    14091    2     RETURN ;
     1113    14092
     1114    14093    2   READ_S_ERR:
     1115    14094    2     CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;
     1116    14095    2     ALTRETURN ;
     1117    14096
     1118    14097    2   END   GET_BANNER_RECORD ;
     1119    14098        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:38   
     1120    14099    1   SEPERATE_BANNER_STAR: PROC ALTRET ;
     1121    14100        /*
     1122    14101          ***** Seperate the *S BANNER buffer.
     1123    14102        */
     1124    14103    2   DCL I UBIN WORD ;
     1125    14104    2   DCL TEMP$ PTR ;
     1126    14105    2     IF BANNER_STAR_SPLIT
     1127    14106    2       THEN
     1128    14107    2         RETURN ;
     1129    14108    2     BANNER$BUF$ = PINCRW(SEG3$, (%BAN_REC_SZ/4)+1) ;
     1130    14109    3     DO I=0 TO 9 ;
     1131    14110    3         IF SEG3$->FS$BANNER.TEXT_OFF(I) = -1
     1132    14111    3             THEN
     1133    14112    4               DO ;
     1134    14113    4                 BANNER$BUF.CNT(I) = 0 ;
     1135    14114    4                 BANNER$BUF.TXT(I) = ' ' ;
     1136    14115    4               END ; /* Then Do */
     1137    14116    3             ELSE
     1138    14117    4               DO ;
     1139    14118    4                 TEMP$ = PINCRC(SEG3$, SEG3$->FS$BANNER.TEXT_OFF(I)) ;
     1140    14119    4                 BANNER$BUF.TXT(I) = TEMP$ -> MOV$STR.TXT ;
     1141    14120    4                 BANNER$BUF.CNT(I) = TEMP$ -> MOV$STR.CNT ;
     1142    14121    4               END ; /* Else Do */
     1143    14122    3         IF SEG3$->FS$BANNER.PERM(I)
     1144    14123    3           THEN
     1145    14124    3             BANNER_ALTER(I) = %NO# ;
     1146    14125    3           ELSE
     1147    14126    3             BANNER_ALTER(I) = %YES# ;
     1148    14127    3     END ;   /* Do I */
     1149    14128    2     BANNER_STAR_SPLIT = %YES# ;
     1150    14129    2     RETURN ;
     1151    14130
     1152    14131    2   END   SEPERATE_BANNER_STAR ;
     1153    14132        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:39   
     1154    14133    1   SEPERATE_BANNER_USERS: PROC ALTRET ;
     1155    14134        /*
     1156    14135          ***** Seperate the :USERS BANNER buffer.
     1157    14136        */
     1158    14137    2   DCL I UBIN WORD ;
     1159    14138    2   DCL TEMP$ PTR ;
     1160    14139    2   DCL BASE$ PTR ;
     1161    14140    2     IF BANNER_USERS_SPLIT
     1162    14141    2       THEN
     1163    14142    2         RETURN ;
     1164    14143    2     BANNER$BUF$ = PINCRW(SEG3$, (%BAN_REC_SZ/4)+1) ;
     1165    14144    2     BASE$ = ADDR(SEG$2.USERS$->AS$USERS.SETUP_CHRA.TXT) ;
     1166    14145    3     DO I=0 TO 9 ;
     1167    14146    3         IF SEG$2.USERS$->AS$USERS.BANNER(I) = -1
     1168    14147    3             THEN
     1169    14148    4               DO ;
     1170    14149    4                 BANNER$BUF.CNT(I) = 0 ;
     1171    14150    4                 BANNER$BUF.TXT(I) = ' ' ;
     1172    14151    4               END ; /* Then Do */
     1173    14152    3             ELSE
     1174    14153    4               DO ;
     1175    14154    4                 TEMP$ = PINCRC(BASE$, SEG$2.USERS$->AS$USERS.BANNER(I)) ;
     1176    14155    4                 BANNER$BUF.TXT(I) = TEMP$ -> MOV$STR.TXT ;
     1177    14156    4                 BANNER$BUF.CNT(I) = TEMP$ -> MOV$STR.CNT ;
     1178    14157    4               END ; /* Else Do */
     1179    14158    3         IF SEG$2.USERS$->AS$USERS.BANNER_PERM(I)
     1180    14159    3           THEN
     1181    14160    3             BANNER_ALTER(I) = %NO# ;
     1182    14161    3           ELSE
     1183    14162    3             BANNER_ALTER(I) = %YES# ;
     1184    14163    3     END ;   /* Do I */
     1185    14164    2     BANNER_USERS_SPLIT = %YES# ;
     1186    14165    2     RETURN ;
     1187    14166
     1188    14167    2   END   SEPERATE_BANNER_USERS ;
     1189    14168        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:40   
     1190    14169    1   REBUILD_BANNER: PROC ALTRET ;
     1191    14170        /*
     1192    14171          ***** Rebuild the BANNER buffer.
     1193    14172        */
     1194    14173    2   DCL I UBIN WORD ;
     1195    14174    2   DCL TEMP$ PTR ;
     1196    14175    2   DCL OFFSET UBIN ;
     1197    14176    2   DCL PINCR UBIN WORD ;
     1198    14177
     1199    14178    2     OFFSET = LENGTHC(SEG3$->FS$BANNER) ;
     1200    14179    2     TEMP$ = PINCRC(SEG3$, OFFSET) ;
     1201    14180    3     DO I=0 TO 9 ;
     1202    14181    3         IF BANNER$BUF.CNT(I) = 0
     1203    14182    3             THEN
     1204    14183    3               SEG3$->FS$BANNER.TEXT_OFF(I) = -1 ;
     1205    14184    3             ELSE
     1206    14185    4               DO ;
     1207    14186    4                 SEG3$->FS$BANNER.TEXT_OFF(I) = OFFSET ;
     1208    14187    4                 TEMP$ -> MOV$STR.CNT = BANNER$BUF.CNT(I) ;
     1209    14188    4                 TEMP$ -> MOV$STR.TXT = BANNER$BUF.TXT(I) ;
     1210    14189    4                 PINCR = TEMP$ -> MOV$STR.CNT + 1 ;
     1211    14190    4                 OFFSET = OFFSET + PINCR ;
     1212    14191    4                 TEMP$ = PINCRC(TEMP$, PINCR) ;
     1213    14192    4               END ; /* Else Do */
     1214    14193    3     END ;   /* Do I */
     1215    14194
     1216    14195    2     ARS = OFFSET ;
     1217    14196
     1218    14197    2     RETURN ;
     1219    14198
     1220    14199    2   END   REBUILD_BANNER ;
     1221    14200        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:41   
     1222    14201    1   LIST_BANNERTEXT:  PROC  ALTRET ;
     1223    14202
     1224    14203    2   DCL START UBIN WORD ;
     1225    14204    2   DCL LAST UBIN WORD ;
     1226    14205    2   DCL I UBIN WORD ;
     1227    14206    2   DCL SZ UBIN WORD ;
     1228    14207
     1229    14208    2   DCL BANNERTEXT BIT(1) ;
     1230    14209
     1231    14210    2     BANNERTEXT = %YES# ;
     1232    14211    2     START = 1 ;
     1233    14212    2     LAST = 9 ;
     1234    14213    2     GOTO COMMON_CODE ;
     1235    14214
     1236    14215    2   LIST_REGISTERNAME:  ENTRY ALTRET ;
     1237    14216
     1238    14217    2     BANNERTEXT = %NO# ;
     1239    14218    2     START = 0 ;
     1240    14219    2     LAST = 0 ;
     1241    14220
     1242    14221    2   COMMON_CODE:
     1243    14222    2     SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_ = VECTOR(WRITEBUF) ;
     1244    14223    2     IF PERM
     1245    14224    2       THEN
     1246    14225    3         DO ;
     1247    14226    3           IF NOT SEG$2.FLAGS.USERS
     1248    14227    3             THEN
     1249    14228    3               CALL GET_BANNER_USERS ALTRET(LIST_BANNER_ERR) ;
     1250    14229    3           CALL SEPERATE_BANNER_USERS ALTRET(LIST_BANNER_ERR) ;
     1251    14230    3           WRITEBUF = '   Permanent' ;
     1252    14231    3           SZ = 12 ;
     1253    14232    3         END ; /* Then Do */
     1254    14233    2       ELSE
     1255    14234    3         DO ;
     1256    14235    3           IF NOT GOT_BANNERTEXT_REC
     1257    14236    3             THEN
     1258    14237    3               CALL GET_BANNER_RECORD ALTRET(LIST_BANNER_ERR) ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:42   
     1259    14238    3           CALL SEPERATE_BANNER_STAR ALTRET(LIST_BANNER_ERR) ;
     1260    14239    3           WRITEBUF = '   Session' ;
     1261    14240    3           SZ = 10 ;
     1262    14241    3         END ; /* Else Do */
     1263    14242    2     IF START = 0
     1264    14243    2       THEN
     1265    14244    3         DO ;
     1266    14245    3           CALL INSERT (WRITEBUF, SZ+1,, 'RegisterName:') ;
     1267    14246    3           SZ = SZ + 14 ;
     1268    14247    3         END ; /* Then Do */
     1269    14248    2       ELSE
     1270    14249    3         DO ;
     1271    14250    3           CALL INSERT (WRITEBUF, SZ+1,, 'BannerText:') ;
     1272    14251    3           SZ = SZ + 12 ;
     1273    14252    3         END ; /* Else Do */
     1274    14253    2     SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = SZ ;
     1275    14254    2     CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$) ;
     1276    14255    3     DO I = START TO LAST ;
     1277    14256
     1278    14257    3       WRITEBUF = ' ' ;
     1279    14258    3       IF I ~= 0
     1280    14259    3         THEN
     1281    14260    4           DO ;
     1282    14261    4             CALL BINCHAR(F1_TEXT.TXT, I) ;
     1283    14262    4             CALL CONCAT (WRITEBUF, '   ', F1_TEXT.TXT,':') ;
     1284    14263    4           END ; /* Else Do */
     1285    14264    3       IF NOT BANNER_ALTER(I)
     1286    14265    3         THEN
     1287    14266    3           CALL INSERT (WRITEBUF, 6,,'(Unalterable)') ;
     1288    14267    3       CALL INSERT (WRITEBUF, 20,, BANNER$BUF.TXT(I)) ;
     1289    14268    3       SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = BANNER$BUF.CNT(I) + 20 ;
     1290    14269    3       CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$) ;
     1291    14270    3     END ; /* Do I */
     1292    14271
     1293    14272    2     RETURN ;
     1294    14273
     1295    14274    2   LIST_BANNER_ERR:
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:43   
     1296    14275    2     ALTRETURN ;
     1297    14276    2   END   LIST_BANNERTEXT ;
     1298    14277        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:44   
     1299    14278    1   REOPEN_CS:  PROC ;
     1300    14279
     1301    14280    2     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX_NUM ;
     1302    14281    2     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP# = %SAVE# ;
     1303    14282    2     CALL M$CLOSE (SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(CLOSE_ERR) ;
     1304    14283    2   CLOSE_ERR:
     1305    14284    2     CALL CPB$OPENCS ;
     1306    14285    2     RETURN ;
     1307    14286
     1308    14287    2   END   REOPEN_CS ;
     1309    14288        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:45   
     1310    14289    1   CLOSE_IBEX_DCB:  PROC(DCB#) ;
     1311    14290
     1312    14291    2   DCL DCB# UBIN WORD ;
     1313    14292    2     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=DCB# ;
     1314    14293    2     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE# ;
     1315    14294    2     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(CLOSE_ERR) ;
     1316    14295    2   CLOSE_ERR:
     1317    14296    2     RETURN ;
     1318    14297    2   END   CLOSE_IBEX_DCB ;
     1319    14298    1   END CPG$IBEX;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:46   
--  Include file information  --

   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   FS_BANNER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XUE_SUBS_C.:E05TOU  is referenced.
   XUE_MACRO_C.:E05TOU  is referenced.
   XUM_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPG$IBEX.

   Procedure CPG$IBEX requires 2550 words for executable code.
   Procedure CPG$IBEX requires 482 words of local(AUTO) storage.

    No errors detected in file CPG$IBEX.:E05TSI    .

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:47   

 Object Unit name= CPG$IBEX                                   File name= CPG$IBEX.:E05TOU
 UTS= JUL 29 '97 11:42:27.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     99    143  CPG$IBEX
    2   Proc  even  none  2550   4766  CPG$IBEX
    3  RoData even  none    64    100  CPG$IBEX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  CPG$IBEX
     2      3          yes     yes      Std        1  CPG$GOTO
     2     10          yes     yes      Std        1  CPG$IF
     2     22          yes     yes      Std        1  CPG$LET
     2     34          yes     yes      Std        1  CPG$OUTPUT
     2     46          yes     yes      Std        1  CPG$WHEN
     2    526          yes     yes      Std        1  CPG$CHK_WHEN_CONDITION
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:48   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       1 X$EVAL
 yes     yes           Std       2 X$DEC_CONVERT
         yes           Std       1 CPC$RELSEG
 yes     yes           Std       2 CPG$GET_WHEN_CNTL_REC
 yes     yes           Std       3 CPJ$WRITE_S
 yes     yes           Std       1 CPD$SYNTAX
 yes     yes           Std       1 CPC$OPEN_S
 yes     yes           Std       3 CPJ$READ_S
         yes           Std       6 CPC$WRITEMSGE
         yes           Std       5 CXP$POSTERR
         yes           Std       1 CPG$FUN$$
 yes     yes           Std       1 CPG$PUT_WHEN_CNTL_REC
         yes           Std       0 CPC$OPEN_LL
         yes           Std       2 CPA$ECHOCC
 yes     yes           Std       2 CPA$READCC
 yes     yes           Std       2 CPB$WILDCMPR
 yes     yes           Std       5 X$PUT_VAR
 yes     yes           Std       1 CPE$LISTOUT
 yes     yes           Std       1 CPC$WRUSERS
 yes     yes           Std       2 CPC$RDUSERS
 yes     yes           Std       3 ALA$BANNER2_STAR_S
 yes     yes           Std       3 ASC$BANNER
 yes     yes           Std       2 CPC$GETSEG
         yes           Std       0 CPB$OPENCS
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:49   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CFPT_READ                             CFPT_PRECORD
     CFPT_DELREC                           IBEX_NAME                             CFPT_REW
r    SEG2$                            r    SEG3$                            r    B$JIT$
r    B$TCB$                                M$IBEX_NUM                            M$IBEX1_NUM
r    B$SR_NON_BLANK$                  r    B$XL_UPPER$                           IBEX_CMD
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ROSID                                 ISSID
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:50   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* DMC,DFC */
        7        7        /********************************************************************/
        8        8        /*M*    CPG$IBEX     IF, LET, GOTO and OUTPUT commands              */
        9        9        /**/
       10       10        /*P*    NAME:     CPG$IBEX
       11       11                PURPOSE:  These commands allow the user to affect the
       12       12                          execution of commands within COMMAND FILES.
       13       13        */
       14       14        /********************************************************************/
       15       15        CPG$IBEX: PROC (P$PCB) ALTRET;

     15  2 000000   000000 700200 xent  CPG$IBEX     TSX0  ! X66_AUTO_1
         2 000001   000742 000001                    ZERO    482,1
         2 000002   000005 710000 2                  TRA     s:13161

       16       16        /***** Include files *****/
       17       17        %INCLUDE AS_SUPER_C ;
       18      452        %INCLUDE B$JIT;
       19      742        %INCLUDE B_MACROS_C;
       20      853        %INCLUDE CP_6_SUBS;
       21     1393        %INCLUDE CP_6;
       22     1474        %INCLUDE CP_MACROS_C;
       23     2226        %INCLUDE CP_SUBS_C;
       24     3143        %INCLUDE CP_PERR_C;
       25     3481        %INCLUDE F_ERRORS_C;
       26     3721        %INCLUDE XU_MACRO_C;
       27     6827        %INCLUDE XUM_MACRO_C;
       28     6854        %INCLUDE XUE_MACRO_C;
       29     7598        %INCLUDE XUE_SUBS_C;
       30     7778        %INCLUDE CP_DATA_R;
       31    10341        %INCLUDE FS_BANNER_C ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:51   
       32    10382        %INCLUDE B$TABLES_C;
       33    10490        /***** External routines *****/
       34    10491    1   DCL ALA$BANNER2_STAR_S ENTRY(3) ALTRET;
       35    10492    1   DCL ASC$BANNER ENTRY(3) ALTRET;
       36    10493    1   DCL CPA$FLUSH ENTRY;
       37    10494    1   DCL CPA$ECHOCC ENTRY(2);
       38    10495    1   DCL CPA$READCC ENTRY(2) ALTRET;
       39    10496    1   DCL CPB$OPENCS ENTRY;
       40    10497    1   DCL CPB$WILDCMPR ENTRY(2) ALTRET;
       41    10498    1   DCL CPC$GETSEG ENTRY(2) ALTRET;
       42    10499    1   DCL CPC$OPEN_S ENTRY(1) ALTRET;
       43    10500    1   DCL CPC$OPEN_LL ENTRY;
       44    10501    1   DCL CPC$RDUSERS ENTRY(2) ALTRET;
       45    10502    1   DCL CPC$RELSEG ENTRY(1);
       46    10503    1   DCL CPC$WRITEMSGE ENTRY(6);
       47    10504    1   DCL CPC$WRUSERS ENTRY(1) ALTRET;
       48    10505    1   DCL CPD$SYNTAX ENTRY(1) ALTRET;
       49    10506    1   DCL CPE$LISTOUT ENTRY(1) ALTRET;
       50    10507    1   DCL CPG$FUN$$ ENTRY(1);
       51    10508    1   DCL CPG$GET_WHEN_CNTL_REC ENTRY(2) ALTRET;
       52    10509    1   DCL CPG$PUT_WHEN_CNTL_REC ENTRY(1) ALTRET;
       53    10510    1   DCL CPJ$READ_S ENTRY(3) ALTRET;
       54    10511    1   DCL CPJ$WRITE_S ENTRY(3) ALTRET;
       55    10512    1   DCL CXP$POSTERR ENTRY(5);
       56    10513    1   DCL X$EVAL ENTRY(1) ALTRET;
       57    10514    1   DCL X$DEC_CONVERT ENTRY(2) ALTRET;
       58    10515    1   DCL X$PUT_VAR ENTRY(5) ALTRET;
       59    10516        /***** Fpts *****/
       60    10517        %FPT_CLOSE (FPTN=FPT_CLOSE,STCLASS=AUTO);
       61    10559        %FPT_CLOSE (FPTN=FPT$CLOSE,STCLASS=BASED);
       62    10601        %FPT_DELREC (FPTN=FPT_DELREC,STCLASS=AUTO);
       63    10620        %FPT_PRECORD (FPTN=FPT_PRECORD,STCLASS=AUTO);
       64    10641        %FPT_READ (FPTN=FPT_READ,STCLASS=AUTO);
       65    10680        %FPT_REW (FPTN=FPT_REW,STCLASS=AUTO);
       66    10695        %FPT_WRITE (FPTN=FPT$WRITE,STCLASS=BASED);
       67    10726        %P$PCB (STCLASS="");
       68    10927        %P$PCB (NAME=PCB,STCLASS=AUTO);
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:52   
       69    11128        %FPT_READ (FPTN=FPT$READCC,STCLASS=BASED);
       70    11167    1   DCL  1  KEY AUTO,
       71    11168    1        2  L UBIN BYTE UNAL,
       72    11169    1        2  N CHAR (35) UNAL;
       73    11170    1   DCL  1  KEY_VAR AUTO,
       74    11171    1        2  L UBIN BYTE UNAL,
       75    11172    1        2  N CHAR (31) UNAL;
       76    11173    1   DCL  1  FKEY CONSTANT,
       77    11174    1        2  L UBIN BYTE UNAL INIT ( %(LENGTHC('VAR_0')) ),
       78    11175    1        2  N CHAR(0) INIT ('VAR_A');
       79    11176    1   DCL  1  LKEY CONSTANT,
       80    11177    1        2  L UBIN BYTE UNAL INIT ( %(LENGTHC('VAR_{')) ),
       81    11178    1        2  N CHAR(0) INIT ('VAR_{');
       82    11179        %K_WHEN (NAME=K_WHEN,STCLASS=AUTO) ;
       83    11197        %K_WHEN (NAME=CK_WHEN,STCLASS=CONSTANT) ;
       84    11215        %WHEN_CNTL_REC( NAME=CWHEN_CNTL_REC, STCLASS=CONSTANT) ;
       85    11236        %XUE_ECB (NAME=CXUE_ECB,STCLASS=CONSTANT);
       86    11438        %XUE_ECB (NAME=XUE_ECB,STCLASS=AUTO);
       87    11640        %U$PARAM (NAME=U$PARAM,STCLASS=AUTO);
       88    11656        /***** Based structures *****/
       89    11657        %F$DCB;
       90    11714        %B$TCB (STCLASS="BASED(B$TCB$)");
       91    11717        %B$ALT;
       92    11725        %PARSE$OUT (NAME=P$B,STCLASS=BASED);
       93    11770        %PARSE$SYM (NAME=P$S,STCLASS=BASED);
       94    11808        %XUG_GETCMD (NAME=GET$CMD, STCLASS=BASED);
       95    12146        %XUG_RLT (NAME=RLT, STCLASS=BASED);
       96    12153        %SEG$2;
       97    12213        %TEXTC (NAME=X$STRING,STCLASS=BASED);
       98    12218        %TEXTC (NAME=TXT$C,STCLASS="BASED(TXT$)");
       99    12223    1   DCL STARBANNER$BUF CHAR(%BAN_REC_SZ) BASED ;
      100    12224        %CP$BUFF (NAME=CP$BUFF,STCLASS=BASED);
      101    12227    1   DCL DUMMY$CHAR CHAR(%CPBUFFSIZE) BASED;
      102    12228    1   DCL B$TEXT CHAR(ARS) BASED ;
      103    12229        %FS$BANNER ;
      104    12251        %AS_USERS (STR_NAME = AS$USERS, STCLASS=BASED) ;
      105    12429    1   DCL 1 MOV$STR BASED UNAL,
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:53   
      106    12430    1         2 CNT UBIN BYTE CALIGNED,
      107    12431    1         2 TXT CHAR(MOV$STR.CNT) CALIGNED ;
      108    12432    1   DCL 1 BANNER$BUF(0:9) ALIGNED BASED(BANNER$BUF$),
      109    12433    1         2 CNT UBIN BYTE CALIGNED,
      110    12434    1         2 TXT CHAR(80) CALIGNED ;
      111    12435        %WHEN_CNTL_REC( NAME=WHEN$CNTL_REC, STCLASS=BASED) ;
      112    12456    1   DCL WILD_VAR$ PTR;
      113    12457        %TEXTC (NAME=WILD_VAR, STCLASS="BASED(WILD_VAR$)");
      114    12462        /***** Vectors *****/
      115    12463        %VECTOR (NAME=SEG3_,STCLASS=AUTO);
      116    12473    1   DCL BANNER_VEC VECTOR ;
      117    12474        /***** Ptrs *****/
      118    12475    1   DCL BLK$ PTR;
      119    12476    1   DCL NAME$ PTR;
      120    12477    1   DCL TXT$ PTR;
      121    12478    1   DCL ARRY$ PTR;
      122    12479    1   DCL BANNER$BUF$ PTR ;
      123    12480        /***** Character strings *****/
      124    12481    1   DCL TEMPBUF CHAR(512) AUTO;
      125    12482    1   DCL WRITEBUF CHAR(556) AUTO;
      126    12483    1   DCL NIL_TXTC UBIN(9) CONSTANT INIT (0);
      127    12484    1   DCL 1 F1_TEXT,
      128    12485    1         2 CNT UBIN(9) UNAL,
      129    12486    1         2 TXT CHAR(1) UNAL ;
      130    12487        %B$SR_NON_BLANK;
      131    12491        %B$XL_UPPER;
      132    12495        /***** Ubin word *****/
      133    12496    1   DCL DUMMY UBIN WORD;
      134    12497    1   DCL INDX1 UBIN WORD;
      135    12498    1   DCL TYPE UBIN WORD;
      136    12499    1   DCL VALUE SBIN WORD;
      137    12500    1   DCL CPOS UBIN WORD AUTO;
      138    12501    1   DCL TXT# UBIN WORD AUTO;
      139    12502    1   DCL ARS UBIN WORD AUTO;
      140    12503    1   DCL I UBIN WORD ;
      141    12504    1   DCL IBEX_CMD BIT(36) SYMREF ;
      142    12505    1   DCL CMD_SOURCE UBIN WORD ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:54   
      143    12506    1   DCL CSLEV UBIN WORD ;
      144    12507    1   DCL LEFTPOS SBIN WORD ;
      145    12508    1   DCL RIGHTPOS SBIN WORD ;
      146    12509        /***** Bit variables *****/
      147    12510    1   DCL CHANGED BIT(1) ;
      148    12511    1   DCL PRINT_HDR# BIT(1) AUTO;
      149    12512    1   DCL SECOND_PASS# BIT(1) AUTO;
      150    12513    1   DCL PERM BIT(1) AUTO;
      151    12514    1   DCL GOT_BANNERTEXT_REC BIT(1) AUTO ;
      152    12515    1   DCL BANNER_USERS_SPLIT BIT(1) ;
      153    12516    1   DCL BANNER_STAR_SPLIT BIT(1) ;
      154    12517    1   DCL BANNER_ALTER(0:9) BIT(1) ;
      155    12518    1   DCL WHEN_LEVEL0 BIT(1) ;
      156    12519    1   DCL STAR_S_IS_OPEN BIT(1) ;
      157    12520    1   DCL REMEM$VAR REMEMBER BASED ;
      158    12521        /***** Error codes *****/
      159    12522        %VLP_ERRCODE (FPTN=E_ILLGOTO,FCG=CP,MID=G,ERR#=E$ILLGOTO,STCLASS=CONSTANT);
      160    12567        %VLP_ERRCODE (FPTN=E_MLBL,FCG=CP,MID=G,ERR#=E$MLBL,STCLASS=CONSTANT);
      161    12612        %VLP_ERRCODE (FPTN=E_READONLYLET,FCG=CP,MID=G,ERR#=E$READONLYLET,STCLASS=CONSTANT);
      162    12657        %VLP_ERRCODE (FPTN=E_XBIG511,FCG=CP,MID=G,ERR#=E$XBIG511,
      163    12658                        STCLASS=CONSTANT) ;
      164    12703        %VLP_ERRCODE (FPTN=E_MSCOMVAR,FCG=CP,MID=G,ERR#=E$MSCOMVAR,STCLASS=CONSTANT);
      165    12748        %VLP_ERRCODE (FPTN=E_BDVARNAME,FCG=CP,MID=G,ERR#=E$BDVARNAME,STCLASS=CONSTANT);
      166    12793        %VLP_ERRCODE (FPTN=E_ILLEXP,FCG=CP,MID=G,ERR#=E$ILLEXP,STCLASS=CONSTANT);
      167    12838        %VLP_ERRCODE (FPTN=E_NONDECIMAL,FCG=CP,MID=G,ERR#=E$NONDECIMAL,STCLASS=CONSTANT);
      168    12883        %VLP_ERRCODE (FPTN=E_BADBANNERTEXT0,FCG=CP,MID=G,ERR#=E$BADBANNERTEXT0,STCLASS=
             12883            CONSTANT);
      169    12928        %VLP_ERRCODE (FPTN=E_ILLBANNERTEXTLEN,FCG=CP,MID=G,ERR#=E$ILLBANNERTEXTLEN,STCLASS=
             12928            CONSTANT);
      170    12973        %VLP_ERRCODE (FPTN=E_UNALTBANNERTEXT,FCG=CP,MID=G,ERR#=E$UNALTBANNERTEXT,STCLASS=
             12973            CONSTANT);
      171    13018       %VLP_ERRCODE (FPTN=E_NOROOM4BANNERTEXT,FCG=CP,MID=G,ERR#=E$NOROOM4BANNERTEXT,STCLASS
             13018            =CONSTANT);
      172    13063        %VLP_ERRCODE (FPTN=E_CSINT,FCG=CP,MID=A,ERR#=E$CSINT,STCLASS=CONSTANT);
      173    13108        %VLP_ERRCODE (FPTN=E_NOWHEN,FCG=CP,MID=G,ERR#=E$NOWHEN,STCLASS=CONSTANT);
      174    13153        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:55   
      175    13154        /********************************************************************/
      176    13155        /*F*    NAME:    CPG$GOTO                                           */
      177    13156        /********************************************************************/
      178    13157    1   CPG$GOTO: ENTRY (P$PCB) ALTRET;

  13157  2 000003   000000 700200 xent  CPG$GOTO     TSX0  ! X66_AUTO_1
         2 000004   000742 000001                    ZERO    482,1

      179    13158        /*
      180    13159             ***** Goto command...
      181    13160        */
      182    13161    1     CALL GOTO_COMMAND ALTRET(ABORT_GOTO);

  13161  2 000005   003355 701000 2                  TSX1    GOTO_COMMAND
         2 000006   001301 702000 2                  TSX2    ABORT_GOTO

      183    13162    1     RETURN;

  13162  2 000007   000000 702200 xent               TSX2  ! X66_ARET

      184    13163        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:56   
      185    13164        /********************************************************************/
      186    13165        /*F*    NAME:    CPG$IF                                             */
      187    13166        /********************************************************************/
      188    13167    1   CPG$IF: ENTRY (P$PCB) ALTRET;

  13167  2 000010   000000 700200 xent  CPG$IF       TSX0  ! X66_AUTO_1
         2 000011   000742 000001                    ZERO    482,1

      189    13168        /*
      190    13169             ***** Call IF_COMMAND ...
      191    13170        */
      192    13171    1     REMEMBER CPG$BREAK_IN_EVAL IN SEG$2.REMEM$->REMEM$VAR ;

  13171  2 000012   000000 470400 xsym               LDP0    SEG2$
         2 000013   000174 471500                    LDP1    124,,PR0
         2 000014   001247 635000 2                  EAA     CPG$BREAK_IN_EVAL
         2 000015   100000 452500                    STP2    0,,PR1
         2 000016   100001 755100                    STA     1,,PR1

      193    13172    1     CALL IF_COMMAND ALTRET(ABORT);

  13172  2 000017   001315 701000 2                  TSX1    IF_COMMAND
         2 000020   001246 702000 2                  TSX2    ABORT

      194    13173    1     GOTO SAVE_VARIABLES;

  13173  2 000021   001220 710000 2                  TRA     SAVE_VARIABLES

      195    13174        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:57   
      196    13175        /********************************************************************/
      197    13176        /*F*    NAME:    CPG$LET                                            */
      198    13177        /********************************************************************/
      199    13178    1   CPG$LET: ENTRY (P$PCB) ALTRET;

  13178  2 000022   000000 700200 xent  CPG$LET      TSX0  ! X66_AUTO_1
         2 000023   000742 000001                    ZERO    482,1

      200    13179        /*
      201    13180             ***** Call LET_COMMAND ...
      202    13181        */
      203    13182    1     REMEMBER CPG$BREAK_IN_EVAL IN SEG$2.REMEM$->REMEM$VAR ;

  13182  2 000024   000000 470400 xsym               LDP0    SEG2$
         2 000025   000174 471500                    LDP1    124,,PR0
         2 000026   001247 635000 2                  EAA     CPG$BREAK_IN_EVAL
         2 000027   100000 452500                    STP2    0,,PR1
         2 000030   100001 755100                    STA     1,,PR1

      204    13183    1     CALL LET_COMMAND ALTRET(ABORT);

  13183  2 000031   001533 701000 2                  TSX1    LET_COMMAND
         2 000032   001246 702000 2                  TSX2    ABORT

      205    13184    1     GOTO SAVE_VARIABLES;

  13184  2 000033   001220 710000 2                  TRA     SAVE_VARIABLES

      206    13185        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:58   
      207    13186        /********************************************************************/
      208    13187        /*F*    NAME:    CPG$OUTPUT                                         */
      209    13188        /********************************************************************/
      210    13189    1   CPG$OUTPUT: ENTRY (P$PCB) ALTRET;

  13189  2 000034   000000 700200 xent  CPG$OUTPUT   TSX0  ! X66_AUTO_1
         2 000035   000742 000001                    ZERO    482,1

      211    13190        /*
      212    13191             ***** Call OUTPUT_COMMAND ...
      213    13192        */
      214    13193    1     REMEMBER CPG$BREAK_IN_EVAL IN SEG$2.REMEM$->REMEM$VAR ;

  13193  2 000036   000000 470400 xsym               LDP0    SEG2$
         2 000037   000174 471500                    LDP1    124,,PR0
         2 000040   001247 635000 2                  EAA     CPG$BREAK_IN_EVAL
         2 000041   100000 452500                    STP2    0,,PR1
         2 000042   100001 755100                    STA     1,,PR1

      215    13194    1     CALL OUTPUT_COMMAND ALTRET(ABORT);

  13194  2 000043   003660 701000 2                  TSX1    OUTPUT_COMMAND
         2 000044   001246 702000 2                  TSX2    ABORT

      216    13195    1     GOTO SAVE_VARIABLES;

  13195  2 000045   001220 710000 2                  TRA     SAVE_VARIABLES

      217    13196        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:59   
      218    13197        /********************************************************************/
      219    13198        /*F*    NAME:    CPG$WHEN                                         */
      220    13199        /********************************************************************/
      221    13200    1   CPG$WHEN: ENTRY (P$PCB) ALTRET;

  13200  2 000046   000000 700200 xent  CPG$WHEN     TSX0  ! X66_AUTO_1
         2 000047   000742 000001                    ZERO    482,1

      222    13201
      223    13202    1     BLK$ = P$PCB.OUT$ ;

  13202  2 000050   200003 470500                    LDP0    @P$PCB,,AUTO
         2 000051   000003 236100                    LDQ     3,,PR0
         2 000052   200236 756100                    STQ     BLK$,,AUTO

      224    13203        /*
      225    13204              Either get the WHEN control record, if one input, or create
      226    13205              one to be used for the future.
      227    13206        */
      228    13207    1     STAR_S_IS_OPEN = '0'B;

  13207  2 000053   200704 450100                    STZ     STAR_S_IS_OPEN,,AUTO

      229    13208    1     IF B$JIT.CPFLAGS1.WHEN_INPUT

  13208  2 000054   000000 471400 xsym               LDP1    B$JIT$
         2 000055   100143 236100                    LDQ     99,,PR1
         2 000056   000400 316003                    CANQ    256,DU
         2 000057   000076 600000 2                  TZE     s:13218

      230    13209    1         THEN
      231    13210    2             DO ;

      232    13211    2               CALL CPG$GET_WHEN_CNTL_REC(CHANGED, STAR_S_IS_OPEN)

  13211  2 000060   200704 633500                    EPPR3   STAR_S_IS_OPEN,,AUTO
         2 000061   200723 453500                    STP3    @DCB#+2,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:60   
         2 000062   200673 634500                    EPPR4   CHANGED,,AUTO
         2 000063   200722 454500                    STP4    @DCB#+1,,AUTO
         2 000064   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 000065   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000066   000000 701000 xent               TSX1    CPG$GET_WHEN_CNTL_REC
         2 000067   000466 702000 2                  TSX2    GET_WHEN_CNTL_REC_ERR

      233    13212    2                     ALTRET(GET_WHEN_CNTL_REC_ERR) ;
      234    13213    2               SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV =

  13213  2 000070   000000 470400 xsym               LDP0    SEG2$
         2 000071   000175 471500                    LDP1    125,,PR0
         2 000072   100000 236100                    LDQ     0,,PR1
         2 000073   000011 772000                    QRL     9
         2 000074   100000 552120                    STBQ    0,'20'O,PR1

      235    13214    2                                     SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.CUR_LEV ;
      236    13215    2             END ; /* Then Do */

  13215  2 000075   000153 710000 2                  TRA     s:13231

      237    13216    1         ELSE
      238    13217    2             DO ;

      239    13218    2               IF BLK$->P$B.CODE = WHENSHORTCMND

  13218  2 000076   200236 473500                    LDP3    BLK$,,AUTO
         2 000077   300000 720100                    LXL0    0,,PR3
         2 000100   000127 100003                    CMPX0   87,DU
         2 000101   000502 600000 2                  TZE     WHEN_READ_ERR

      240    13219    2                 THEN
      241    13220    2                   GOTO WHEN_READ_ERR ;
      242    13221    2               CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(GET_WHEN_CNTL_REC_ERR) ;

  13221  2 000102   000000 630400 3                  EPPR0   0
         2 000103   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:61   
         2 000104   000000 701000 xent               TSX1    CPC$OPEN_S
         2 000105   000466 702000 2                  TSX2    GET_WHEN_CNTL_REC_ERR

      243    13222    2               STAR_S_IS_OPEN = %YES#;

  13222  2 000106   400000 236003                    LDQ     -131072,DU
         2 000107   200704 756100                    STQ     STAR_S_IS_OPEN,,AUTO

      244    13223    2               SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC = CWHEN_CNTL_REC ;

  13223  2 000110   000000 470400 xsym               LDP0    SEG2$
         2 000111   000175 471500                    LDP1    125,,PR0
         2 000112   000100 100400                    MLR     fill='000'O
         2 000113   000006 000045 1                  ADSC9   CWHEN_CNTL_REC           cn=0,n=37
         2 000114   100000 000045                    ADSC9   0,,PR1                   cn=0,n=37

      245    13224    2               SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.CUR_LEV = B$JIT.CSLEV ;

  13224  2 000115   000175 471500                    LDP1    125,,PR0
         2 000116   000000 473400 xsym               LDP3    B$JIT$
         2 000117   300170 236100                    LDQ     120,,PR3
         2 000120   000011 736000                    QLS     9
         2 000121   100000 552140                    STBQ    0,'40'O,PR1

      246    13225    2               SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV = B$JIT.CSLEV ;

  13225  2 000122   000175 471500                    LDP1    125,,PR0
         2 000123   300170 236100                    LDQ     120,,PR3
         2 000124   100000 552120                    STBQ    0,'20'O,PR1

      247    13226    3               DO I = 0 TO B$JIT.CSLEV ;

  13226  2 000125   200666 450100                    STZ     I,,AUTO
         2 000126   000145 710000 2                  TRA     s:13229+3

      248    13227    3                 SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(I) = %WHEN_NONE# ;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:62   
  13227  2 000127   000000 470400 xsym               LDP0    SEG2$
         2 000130   000175 471500                    LDP1    125,,PR0
         2 000131   200666 236100                    LDQ     I,,AUTO
         2 000132   000003 402007                    MPY     3,DL
         2 000133   003106 061400                    CSR     bolr='003'O
         2 000134   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         2 000135   100001 000002                    BDSC    1,Q,PR1                  by=0,bit=0,n=2

      249    13228    3                 SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.REC(I) = %NO#;

  13228  2 000136   000175 471500                    LDP1    125,,PR0
         2 000137   003106 060400                    CSL     bolr='003'O
         2 000140   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000141   100001 020001                    BDSC    1,Q,PR1                  by=0,bit=2,n=1

      250    13229    3               END ; /* Do I */

  13229  2 000142   200666 235100                    LDA     I,,AUTO
         2 000143   000001 035007                    ADLA    1,DL
         2 000144   200666 755100                    STA     I,,AUTO
         2 000145   000000 471400 xsym               LDP1    B$JIT$
         2 000146   100170 236100                    LDQ     120,,PR1
         2 000147   000022 772000                    QRL     18
         2 000150   000777 376007                    ANQ     511,DL
         2 000151   200666 116100                    CMPQ    I,,AUTO
         2 000152   000127 603000 2                  TRC     s:13227

      251    13230    2             END ; /* Else Do */

      252    13231    1     IF ~STAR_S_IS_OPEN

  13231  2 000153   200704 236100                    LDQ     STAR_S_IS_OPEN,,AUTO
         2 000154   400000 376003                    ANQ     -131072,DU
         2 000155   400000 676003                    ERQ     -131072,DU
         2 000156   000165 600000 2                  TZE     s:13237

      253    13232    1       THEN
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:63   
      254    13233    2         DO;

      255    13234    2           CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET(GET_WHEN_CNTL_REC_ERR);

  13234  2 000157   000000 630400 3                  EPPR0   0
         2 000160   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000161   000000 701000 xent               TSX1    CPC$OPEN_S
         2 000162   000466 702000 2                  TSX2    GET_WHEN_CNTL_REC_ERR

      256    13235    2           STAR_S_IS_OPEN = '1'B;

  13235  2 000163   400000 236003                    LDQ     -131072,DU
         2 000164   200704 756100                    STQ     STAR_S_IS_OPEN,,AUTO

      257    13236    2         END ; /* Then Do */

      258    13237    1     IF BLK$->P$B.CODE = WHENLEVEL0CMND

  13237  2 000165   200236 470500                    LDP0    BLK$,,AUTO
         2 000166   000000 720100                    LXL0    0,,PR0
         2 000167   000131 100003                    CMPX0   89,DU
         2 000170   000175 601000 2                  TNZ     s:13245

      259    13238    1         THEN
      260    13239    2           DO ;

      261    13240    2             WHEN_LEVEL0 = %YES# ;

  13240  2 000171   400000 236003                    LDQ     -131072,DU
         2 000172   200703 756100                    STQ     WHEN_LEVEL0,,AUTO

      262    13241    2             CSLEV = 0 ;

  13241  2 000173   200670 450100                    STZ     CSLEV,,AUTO

      263    13242    2           END ; /* Then Do */

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:64   
  13242  2 000174   000203 710000 2                  TRA     s:13248

      264    13243    1         ELSE
      265    13244    2           DO ;

      266    13245    2             WHEN_LEVEL0 = %NO# ;

  13245  2 000175   200703 450100                    STZ     WHEN_LEVEL0,,AUTO

      267    13246    2             CSLEV = B$JIT.CSLEV ;

  13246  2 000176   000000 471400 xsym               LDP1    B$JIT$
         2 000177   100170 236100                    LDQ     120,,PR1
         2 000200   000022 772000                    QRL     18
         2 000201   000777 376007                    ANQ     511,DL
         2 000202   200670 756100                    STQ     CSLEV,,AUTO

      268    13247    2           END ; /* Else Do */

      269    13248    1     K_WHEN = CK_WHEN ;

  13248  2 000203   000100 100400                    MLR     fill='000'O
         2 000204   000004 000006 1                  ADSC9   CK_WHEN                  cn=0,n=6
         2 000205   200152 000006                    ADSC9   K_WHEN,,AUTO             cn=0,n=6

      270    13249    1     K_WHEN.NUM = CSLEV ;

  13249  2 000206   200670 236100                    LDQ     CSLEV,,AUTO
         2 000207   000022 736000                    QLS     18
         2 000210   200153 552120                    STBQ    K_WHEN+1,'20'O,AUTO

      271    13250    1     IF BLK$->P$B.CODE = WHENSHORTCMND

  13250  2 000211   000000 720100                    LXL0    0,,PR0
         2 000212   000127 100003                    CMPX0   87,DU
         2 000213   000245 601000 2                  TNZ     s:13257

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:65   
      272    13251    1         THEN
      273    13252                            /* 'WHEN .end' was specified. */
      274    13253    1             CALL CPJ$READ_S(M$IBEX1_NUM, VECTOR(K_WHEN), VECTOR(WRITEBUF))

  13253  2 000214   000001 235000 3                  LDA     1
         2 000215   200722 452500                    STP2    @DCB#+1,,AUTO
         2 000216   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 000217   000152 036003                    ADLQ    106,DU
         2 000220   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 000221   000002 235000 3                  LDA     2
         2 000222   200726 452500                    STP2    @DCB#+5,,AUTO
         2 000223   200726 236100                    LDQ     @DCB#+5,,AUTO
         2 000224   000443 036003                    ADLQ    291,DU
         2 000225   200732 757100                    STAQ    @DCB#+9,,AUTO
         2 000226   200724 237100                    LDAQ    @DCB#+3,,AUTO
         2 000227   200730 757100                    STAQ    @DCB#+7,,AUTO
         2 000230   200732 237100                    LDAQ    @DCB#+9,,AUTO
         2 000231   200734 757100                    STAQ    @DCB#+11,,AUTO
         2 000232   200734 631500                    EPPR1   @DCB#+11,,AUTO
         2 000233   200740 451500                    STP1    @DCB#+15,,AUTO
         2 000234   200730 633500                    EPPR3   @DCB#+7,,AUTO
         2 000235   200737 453500                    STP3    @DCB#+14,,AUTO
         2 000236   000000 236000 3                  LDQ     0
         2 000237   200736 756100                    STQ     @DCB#+13,,AUTO
         2 000240   200736 630500                    EPPR0   @DCB#+13,,AUTO
         2 000241   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000242   000000 701000 xent               TSX1    CPJ$READ_S
         2 000243   000502 702000 2                  TSX2    WHEN_READ_ERR
         2 000244   000426 710000 2                  TRA     s:13287

      275    13254    1                                 ALTRET(WHEN_READ_ERR) ;
      276    13255    1         ELSE
      277    13256    2             DO ;

      278    13257    2               ARS = P$PCB.NCHARS ;

  13257  2 000245   200003 471500                    LDP1    @P$PCB,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:66   
         2 000246   100011 235100                    LDA     9,,PR1
         2 000247   200665 755100                    STA     ARS,,AUTO

      279    13258    2               IF WHEN_LEVEL0

  13258  2 000250   200703 234100                    SZN     WHEN_LEVEL0,,AUTO
         2 000251   000362 605000 2                  TPL     s:13280

      280    13259    2                 THEN
      281    13260    3                   DO ;

      282    13261    3                     CALL INDEX (LEFTPOS, '(', P$PCB.TEXT$->B$TEXT, 0) ;

  13261  2 000252   100000 473500                    LDP3    0,,PR1
         2 000253   000000 621005                    EAX1    0,AL
         2 000254   000000 124540                    SCM     mask='000'O
         2 000255   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         2 000256   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 000257   200671 000100                    ARG     LEFTPOS,,AUTO

      283    13262    3                     CALL INDEX (RIGHTPOS, ')', P$PCB.TEXT$->B$TEXT, LEFTPOS) ;

  13262  2 000260   200665 236100                    LDQ     ARS,,AUTO
         2 000261   200671 136100                    SBLQ    LEFTPOS,,AUTO
         2 000262   200722 756100                    STQ     @DCB#+1,,AUTO
         2 000263   200671 236100                    LDQ     LEFTPOS,,AUTO
         2 000264   200722 720100                    LXL0    @DCB#+1,,AUTO
         2 000265   200671 235100                    LDA     LEFTPOS,,AUTO
         2 000266   000000 124545                    SCM     mask='000'O
         2 000267   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=*X0
         2 000270   000004 000001 3                  ADSC9   4                        cn=0,n=1
         2 000271   200672 000100                    ARG     RIGHTPOS,,AUTO
         2 000272   200672 056100                    ASQ     RIGHTPOS,,AUTO

      284    13263    3                     IF SUBSTR(P$PCB.TEXT$->B$TEXT, RIGHTPOS) = ')'

  13263  2 000273   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:67   
         2 000274   200665 236100                    LDQ     ARS,,AUTO
         2 000275   200672 136100                    SBLQ    RIGHTPOS,,AUTO
         2 000276   000000 620006                    EAX0    0,QL
         2 000277   200672 236100                    LDQ     RIGHTPOS,,AUTO
         2 000300   040000 106546                    CMPC    fill='040'O
         2 000301   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=*X0
         2 000302   000004 000001 3                  ADSC9   4                        cn=0,n=1
         2 000303   000313 601000 2                  TNZ     s:13270

      285    13264    3                       THEN
      286    13265    4                         DO ;

      287    13266    4                           CALL CONCAT(WRITEBUF, '!',

  13266  2 000304   041000 236003                    LDQ     16896,DU
         2 000305   200443 756100                    STQ     WRITEBUF,,AUTO
         2 000306   000000 620005                    EAX0    0,AL
         2 000307   040100 100540                    MLR     fill='040'O
         2 000310   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 000311   200443 201053                    ADSC9   WRITEBUF,,AUTO           cn=1,n=555

      288    13267    4                             SUBSTR(P$PCB.TEXT$->B$TEXT, 0, LEFTPOS)) ;
      289    13268    4                           GOTO OUTPUT_WHENCMD ;

  13268  2 000312   000371 710000 2                  TRA     OUTPUT_WHENCMD

      290    13269    4                         END ; /* Then Do */
      291    13270    3                     IF SUBSTR(P$PCB.TEXT$->B$TEXT, RIGHTPOS+1, 1) = ' '

  13270  2 000313   040000 106506                    CMPC    fill='040'O
         2 000314   300000 200001                    ADSC9   0,Q,PR3                  cn=1,n=1
         2 000315   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000316   000320 601000 2                  TNZ     s:13273

      292    13271    3                       THEN
      293    13272    3                         RIGHTPOS = RIGHTPOS + 1 ;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:68   
  13272  2 000317   200672 054100                    AOS     RIGHTPOS,,AUTO

      294    13273    3                     CALL CONCAT(WRITEBUF, '!',

  13273  2 000320   200665 236100                    LDQ     ARS,,AUTO
         2 000321   200672 136100                    SBLQ    RIGHTPOS,,AUTO
         2 000322   200722 756100                    STQ     @DCB#+1,,AUTO
         2 000323   041000 236003                    LDQ     16896,DU
         2 000324   200443 756100                    STQ     WRITEBUF,,AUTO
         2 000325   000000 620005                    EAX0    0,AL
         2 000326   040100 100540                    MLR     fill='040'O
         2 000327   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 000330   200443 201053                    ADSC9   WRITEBUF,,AUTO           cn=1,n=555
         2 000331   200671 236100                    LDQ     LEFTPOS,,AUTO
         2 000332   001053 116007                    CMPQ    555,DL
         2 000333   000353 605000 2                  TPL     s:13277
         2 000334   776724 620006                    EAX0    -556,QL
         2 000335   777777 660003                    ERX0    -1,DU
         2 000336   040146 100400                    MLR     fill='040'O
         2 000337   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000340   200443 200010                    ADSC9   WRITEBUF,Q,AUTO          cn=1,n=*X0
         2 000341   001052 116007                    CMPQ    554,DL
         2 000342   000353 605000 2                  TPL     s:13277
         2 000343   200722 721100                    LXL1    @DCB#+1,,AUTO
         2 000344   777777 622011                    EAX2    -1,X1
         2 000345   776725 623006                    EAX3    -555,QL
         2 000346   777777 663003                    ERX3    -1,DU
         2 000347   200672 235100                    LDA     RIGHTPOS,,AUTO
         2 000350   040146 100545                    MLR     fill='040'O
         2 000351   300000 200012                    ADSC9   0,A,PR3                  cn=1,n=*X2
         2 000352   200443 400013                    ADSC9   WRITEBUF,Q,AUTO          cn=2,n=*X3

      295    13274    3                           SUBSTR(P$PCB.TEXT$->B$TEXT, 0, LEFTPOS),
      296    13275    3                           ' ',
      297    13276    3                           SUBSTR(P$PCB.TEXT$->B$TEXT, RIGHTPOS+1, ARS-RIGHTPOS-1));
      298    13277    3                     ARS = ARS - (RIGHTPOS - LEFTPOS) ;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:69   
  13277  2 000353   200672 236100                    LDQ     RIGHTPOS,,AUTO
         2 000354   200671 136100                    SBLQ    LEFTPOS,,AUTO
         2 000355   200722 756100                    STQ     @DCB#+1,,AUTO
         2 000356   200665 236100                    LDQ     ARS,,AUTO
         2 000357   200722 136100                    SBLQ    @DCB#+1,,AUTO
         2 000360   200665 756100                    STQ     ARS,,AUTO

      299    13278    3                   END ; /* Then Do */

  13278  2 000361   000371 710000 2                  TRA     OUTPUT_WHENCMD

      300    13279    2                 ELSE
      301    13280    2                   CALL CONCAT(WRITEBUF, '!', P$PCB.TEXT$->B$TEXT) ;

  13280  2 000362   100000 473500                    LDP3    0,,PR1
         2 000363   041000 236003                    LDQ     16896,DU
         2 000364   200443 756100                    STQ     WRITEBUF,,AUTO
         2 000365   000000 620005                    EAX0    0,AL
         2 000366   040100 100540                    MLR     fill='040'O
         2 000367   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 000370   200443 201053                    ADSC9   WRITEBUF,,AUTO           cn=1,n=555

      302    13281
      303    13282    2   OUTPUT_WHENCMD:
      304    13283    2               ARS = ARS + 1 ;

  13283  2 000371   200665 235100       OUTPUT_WHEN* LDA     ARS,,AUTO
         2 000372   000001 035007                    ADLA    1,DL
         2 000373   200665 755100                    STA     ARS,,AUTO

      305    13284    2               CALL CPJ$WRITE_S(M$IBEX1_NUM, VECTOR(K_WHEN), VECTOR(SUBSTR(

  13284  2 000374   000001 235000 3                  LDA     1
         2 000375   200722 452500                    STP2    @DCB#+1,,AUTO
         2 000376   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 000377   000152 036003                    ADLQ    106,DU
         2 000400   200724 757100                    STAQ    @DCB#+3,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:70   
         2 000401   200665 235100                    LDA     ARS,,AUTO
         2 000402   000020 735000                    ALS     16
         2 000403   000140 135007                    SBLA    96,DL
         2 000404   200726 452500                    STP2    @DCB#+5,,AUTO
         2 000405   200726 236100                    LDQ     @DCB#+5,,AUTO
         2 000406   000443 036003                    ADLQ    291,DU
         2 000407   200732 757100                    STAQ    @DCB#+9,,AUTO
         2 000410   200724 237100                    LDAQ    @DCB#+3,,AUTO
         2 000411   200730 757100                    STAQ    @DCB#+7,,AUTO
         2 000412   200732 237100                    LDAQ    @DCB#+9,,AUTO
         2 000413   200734 757100                    STAQ    @DCB#+11,,AUTO
         2 000414   200734 630500                    EPPR0   @DCB#+11,,AUTO
         2 000415   200740 450500                    STP0    @DCB#+15,,AUTO
         2 000416   200730 631500                    EPPR1   @DCB#+7,,AUTO
         2 000417   200737 451500                    STP1    @DCB#+14,,AUTO
         2 000420   000000 236000 3                  LDQ     0
         2 000421   200736 756100                    STQ     @DCB#+13,,AUTO
         2 000422   200736 630500                    EPPR0   @DCB#+13,,AUTO
         2 000423   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000424   000000 701000 xent               TSX1    CPJ$WRITE_S
         2 000425   000521 702000 2                  TSX2    WHEN_ALTRET

      306    13285    2                       WRITEBUF,0,ARS))) ALTRET(WHEN_ALTRET) ;
      307    13286    2             END ; /* Else Do */

      308    13287    1     SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.OPT(CSLEV) = %WHEN# ;

  13287  2 000426   000000 470400 xsym               LDP0    SEG2$
         2 000427   000175 471500                    LDP1    125,,PR0
         2 000430   200670 236100                    LDQ     CSLEV,,AUTO
         2 000431   000003 402007                    MPY     3,DL
         2 000432   003106 061400                    CSR     bolr='003'O
         2 000433   000003 000044 xsym               BDSC    B_VECTNIL+3              by=0,bit=0,n=36
         2 000434   100001 000002                    BDSC    1,Q,PR1                  by=0,bit=0,n=2

      309    13288    1     SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.WHEN.REC(CSLEV) = %YES#;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:71   
  13288  2 000435   000175 471500                    LDP1    125,,PR0
         2 000436   003106 060400                    CSL     bolr='003'O
         2 000437   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000440   100001 020001                    BDSC    1,Q,PR1                  by=0,bit=2,n=1

      310    13289    1     CALL CPG$PUT_WHEN_CNTL_REC(STAR_S_IS_OPEN) ALTRET(WHEN_ALTRET) ;

  13289  2 000441   200704 631500                    EPPR1   STAR_S_IS_OPEN,,AUTO
         2 000442   200722 451500                    STP1    @DCB#+1,,AUTO
         2 000443   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 000444   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000445   000000 701000 xent               TSX1    CPG$PUT_WHEN_CNTL_REC
         2 000446   000521 702000 2                  TSX2    WHEN_ALTRET

      311    13290    1     B$JIT.CPFLAGS1.WHEN_INPUT = %YES# ;

  13290  2 000447   000000 470400 xsym               LDP0    B$JIT$
         2 000450   000400 236003                    LDQ     256,DU
         2 000451   000143 256100                    ORSQ    99,,PR0

      312    13291    1     IF CSLEV = B$JIT.CSLEV

  13291  2 000452   000170 236100                    LDQ     120,,PR0
         2 000453   000022 772000                    QRL     18
         2 000454   000777 376007                    ANQ     511,DL
         2 000455   200670 116100                    CMPQ    CSLEV,,AUTO
         2 000456   000461 601000 2                  TNZ     s:13294

      313    13292    1         THEN
      314    13293    1             B$JIT.PRFLAGS.WHEN = %YES# ;

  13293  2 000457   000010 236003                    LDQ     8,DU
         2 000460   000030 256100                    ORSQ    24,,PR0

      315    13294    1     CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;

  13294  2 000461   000000 236000 3                  LDQ     0
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:72   
         2 000462   200721 756100                    STQ     TEMP$+1,,AUTO
         2 000463   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 000464   000000 011000                    NOP     0

      316    13295    1     RETURN ;

  13295  2 000465   000000 702200 xent               TSX2  ! X66_ARET

      317    13296
      318    13297    1   GET_WHEN_CNTL_REC_ERR:
      319    13298    1     CALL CPC$WRITEMSGE (B$JIT.USRERR,M$IBEX1_NUM);

  13298  2 000466   000000 236000 3     GET_WHEN_CN* LDQ     0
         2 000467   200723 756100                    STQ     @DCB#+2,,AUTO
         2 000470   000000 236000 xsym               LDQ     B$JIT$
         2 000471   000144 036003                    ADLQ    100,DU
         2 000472   200722 756100                    STQ     @DCB#+1,,AUTO
         2 000473   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 000474   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000475   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 000476   000000 011000                    NOP     0

      320    13299    1     B$JIT.USRERR = '0'O;

  13299  2 000477   000000 470400 xsym               LDP0    B$JIT$
         2 000500   000144 450100                    STZ     100,,PR0

      321    13300    1     GOTO WHEN_ALTRET ;

  13300  2 000501   000521 710000 2                  TRA     WHEN_ALTRET

      322    13301
      323    13302    1   WHEN_READ_ERR:
      324    13303    1     SEG$2.ERRBUF(1) = 0 ; /* Throw away error */

  13303  2 000502   000000 470400 xsym  WHEN_READ_E* LDP0    SEG2$
         2 000503   000004 450100                    STZ     4,,PR0
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:73   

      325    13304    1     B$JIT.USRERR = '0'B ;

  13304  2 000504   000000 471400 xsym               LDP1    B$JIT$
         2 000505   100144 450100                    STZ     100,,PR1

      326    13305    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_NOWHEN) ;

  13305  2 000506   000000 236000 xsym               LDQ     SEG2$
         2 000507   000003 036003                    ADLQ    3,DU
         2 000510   200722 756100                    STQ     @DCB#+1,,AUTO
         2 000511   000006 237000 3                  LDAQ    6
         2 000512   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 000513   200722 633500                    EPPR3   @DCB#+1,,AUTO
         2 000514   200723 453500                    STP3    @DCB#+2,,AUTO
         2 000515   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 000516   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000517   000000 701000 xent               TSX1    CXP$POSTERR
         2 000520   000000 011000                    NOP     0

      327    13306        /*E*       ERROR: CPG-E$NOWHEN-0
      328    13307                   MESSAGE: No WHEN specified.
      329    13308                   MESSAGE1: You have not specified a WHEN command.
      330    13309                   DESCRIPTION: The user tried to reinstate a WHEN command
      331    13310                                even though one was not specified.
      332    13311        */
      333    13312
      334    13313    1   WHEN_ALTRET:
      335    13314    1     CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;

  13314  2 000521   000000 236000 3     WHEN_ALTRET  LDQ     0
         2 000522   200721 756100                    STQ     TEMP$+1,,AUTO
         2 000523   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 000524   000000 011000                    NOP     0

      336    13315    1     ALTRETURN ;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:74   
  13315  2 000525   000000 702200 xent               TSX2  ! X66_AALT

      337    13316          %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:75   
      338    13317        /********************************************************************/
      339    13318        /*F*    NAME:    CPG$CHK_WHEN_CONDITION                           */
      340    13319        /********************************************************************/
      341    13320    1   CPG$CHK_WHEN_CONDITION: ENTRY(P$PCB) ALTRET;

  13320  2 000526   000000 700200 xent  CPG$CHK_WHE* TSX0  ! X66_AUTO_1
         2 000527   000742 000001                    ZERO    482,1

      342    13321
      343    13322    1     CALL CPG$GET_WHEN_CNTL_REC(CHANGED, STAR_S_IS_OPEN) ALTRET(CHK_WHEN_ALT) ;

  13322  2 000530   200704 630500                    EPPR0   STAR_S_IS_OPEN,,AUTO
         2 000531   200723 450500                    STP0    @DCB#+2,,AUTO
         2 000532   200673 631500                    EPPR1   CHANGED,,AUTO
         2 000533   200722 451500                    STP1    @DCB#+1,,AUTO
         2 000534   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 000535   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000536   000000 701000 xent               TSX1    CPG$GET_WHEN_CNTL_REC
         2 000537   001200 702000 2                  TSX2    CHK_WHEN_ALT

      344    13323    1     IF CHANGED

  13323  2 000540   200673 234100                    SZN     CHANGED,,AUTO
         2 000541   000550 605000 2                  TPL     s:13326

      345    13324    1       THEN
      346    13325    1         CALL CPG$PUT_WHEN_CNTL_REC(STAR_S_IS_OPEN) ALTRET(WHEN_ALTRET) ;

  13325  2 000542   200704 630500                    EPPR0   STAR_S_IS_OPEN,,AUTO
         2 000543   200722 450500                    STP0    @DCB#+1,,AUTO
         2 000544   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 000545   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000546   000000 701000 xent               TSX1    CPG$PUT_WHEN_CNTL_REC
         2 000547   000521 702000 2                  TSX2    WHEN_ALTRET

      347    13326    1     IF ~STAR_S_IS_OPEN

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:76   
  13326  2 000550   200704 236100                    LDQ     STAR_S_IS_OPEN,,AUTO
         2 000551   400000 376003                    ANQ     -131072,DU
         2 000552   400000 676003                    ERQ     -131072,DU
         2 000553   000562 600000 2                  TZE     s:13332

      348    13327    1       THEN
      349    13328    2         DO;

      350    13329    2             CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET (CHK_WHEN_ALT) ;

  13329  2 000554   000000 630400 3                  EPPR0   0
         2 000555   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000556   000000 701000 xent               TSX1    CPC$OPEN_S
         2 000557   001200 702000 2                  TSX2    CHK_WHEN_ALT

      351    13330    2             STAR_S_IS_OPEN = %YES#;

  13330  2 000560   400000 236003                    LDQ     -131072,DU
         2 000561   200704 756100                    STQ     STAR_S_IS_OPEN,,AUTO

      352    13331    2         END;  /* Then Do */

      353    13332    1     IF NOT B$JIT.PRFLAGS.WHEN

  13332  2 000562   000000 470400 xsym               LDP0    B$JIT$
         2 000563   000030 236100                    LDQ     24,,PR0
         2 000564   000010 316003                    CANQ    8,DU
         2 000565   001075 600000 2                  TZE     CHK_WHEN_RET

      354    13333    1       THEN
      355    13334    1         GOTO CHK_WHEN_RET ;
      356    13335    1     K_WHEN = CK_WHEN ;

  13335  2 000566   000100 100400                    MLR     fill='000'O
         2 000567   000004 000006 1                  ADSC9   CK_WHEN                  cn=0,n=6
         2 000570   200152 000006                    ADSC9   K_WHEN,,AUTO             cn=0,n=6

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:77   
      357    13336    1     K_WHEN.NUM = SEG$2.WHEN_CNTL_REC$->WHEN$CNTL_REC.STATE_LEV ;

  13336  2 000571   000000 471400 xsym               LDP1    SEG2$
         2 000572   100175 473500                    LDP3    125,,PR1
         2 000573   300000 236100                    LDQ     0,,PR3
         2 000574   200153 552120                    STBQ    K_WHEN+1,'20'O,AUTO

      358    13337    1     CALL CPJ$READ_S(M$IBEX1_NUM, VECTOR(K_WHEN), VECTOR(WRITEBUF))

  13337  2 000575   000001 235000 3                  LDA     1
         2 000576   200722 452500                    STP2    @DCB#+1,,AUTO
         2 000577   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 000600   000152 036003                    ADLQ    106,DU
         2 000601   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 000602   000002 235000 3                  LDA     2
         2 000603   200726 452500                    STP2    @DCB#+5,,AUTO
         2 000604   200726 236100                    LDQ     @DCB#+5,,AUTO
         2 000605   000443 036003                    ADLQ    291,DU
         2 000606   200732 757100                    STAQ    @DCB#+9,,AUTO
         2 000607   200724 237100                    LDAQ    @DCB#+3,,AUTO
         2 000610   200730 757100                    STAQ    @DCB#+7,,AUTO
         2 000611   200732 237100                    LDAQ    @DCB#+9,,AUTO
         2 000612   200734 757100                    STAQ    @DCB#+11,,AUTO
         2 000613   200734 633500                    EPPR3   @DCB#+11,,AUTO
         2 000614   200740 453500                    STP3    @DCB#+15,,AUTO
         2 000615   200730 634500                    EPPR4   @DCB#+7,,AUTO
         2 000616   200737 454500                    STP4    @DCB#+14,,AUTO
         2 000617   000000 236000 3                  LDQ     0
         2 000620   200736 756100                    STQ     @DCB#+13,,AUTO
         2 000621   200736 630500                    EPPR0   @DCB#+13,,AUTO
         2 000622   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000623   000000 701000 xent               TSX1    CPJ$READ_S
         2 000624   001200 702000 2                  TSX2    CHK_WHEN_ALT

      359    13338    1             ALTRET(CHK_WHEN_ALT) ;
      360    13339    1     ARS = DCBADDR(M$IBEX1_NUM)->F$DCB.ARS# ;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:78   
  13339  2 000625   000010 470400 3                  LDP0    8
         2 000626   000000 471500                    LDP1    0,,PR0
         2 000627   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 000630   100000 473510                    LDP3    0,X0,PR1
         2 000631   300000 235100                    LDA     0,,PR3
         2 000632   200665 755100                    STA     ARS,,AUTO

      361    13340    1     U$PARAM.ERRBUF$ = ADDR(SEG$2.ERRBUF);

  13340  2 000633   000000 236000 xsym               LDQ     SEG2$
         2 000634   000003 036003                    ADLQ    3,DU
         2 000635   200210 756100                    STQ     U$PARAM,,AUTO

      362    13341    1     U$PARAM.USERS$ = ADDR(NIL);

  13341  2 000636   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000637   200211 756100                    STQ     U$PARAM+1,,AUTO

      363    13342    1     U$PARAM.CNTU$$ = ENTADDR(NIL) ;

  13342  2 000640   000002 236000 xsym               LDQ     B_VECTNIL+2
         2 000641   200212 756100                    STQ     U$PARAM+2,,AUTO

      364    13343    1     U$PARAM.REMEM$ = ADDR(NIL) ;

  13343  2 000642   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000643   200226 756100                    STQ     U$PARAM+14,,AUTO

      365    13344    1     U$PARAM.SPCL$$ = ENTADDR(NIL);

  13344  2 000644   000002 236000 xsym               LDQ     B_VECTNIL+2
         2 000645   200213 756100                    STQ     U$PARAM+3,,AUTO

      366    13345    1     U$PARAM.GETCMD$ = SEG$2.GETCMD$ ;

  13345  2 000646   000000 474400 xsym               LDP4    SEG2$
         2 000647   400173 236100                    LDQ     123,,PR4
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:79   
         2 000650   200224 756100                    STQ     U$PARAM+12,,AUTO

      367    13346    1     U$PARAM.FID_CNT = 0 ;

  13346  2 000651   000000 236003                    LDQ     0,DU
         2 000652   200216 552120                    STBQ    U$PARAM+6,'20'O,AUTO

      368    13347    2     DO I = 0 TO %MAX_FID_BLKS - 1 ;

  13347  2 000653   200666 450100                    STZ     I,,AUTO
         2 000654   000663 710000 2                  TRA     s:13349+3

      369    13348    2         U$PARAM.FID_BLK$(I) = ADDR(NIL) ;

  13348  2 000655   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000656   200666 720100                    LXL0    I,,AUTO
         2 000657   200217 756110                    STQ     U$PARAM+7,X0,AUTO

      370    13349    2     END ;   /* Do I */

  13349  2 000660   200666 235100                    LDA     I,,AUTO
         2 000661   000001 035007                    ADLA    1,DL
         2 000662   200666 755100                    STA     I,,AUTO
         2 000663   200666 235100                    LDA     I,,AUTO
         2 000664   000005 115007                    CMPA    5,DL
         2 000665   000655 602000 2                  TNC     s:13348

      371    13350    1     P$PCB.USER$ = ADDR(U$PARAM);

  13350  2 000666   200210 630500                    EPPR0   U$PARAM,,AUTO
         2 000667   200003 471500                    LDP1    @P$PCB,,AUTO
         2 000670   100014 450500                    STP0    12,,PR1

      372    13351    1     SEG$2.GETCMD$->GET$CMD.PCB$ = ADDR(P$PCB);

  13351  2 000671   000000 473400 xsym               LDP3    SEG2$
         2 000672   300173 474500                    LDP4    123,,PR3
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:80   
         2 000673   200003 236100                    LDQ     @P$PCB,,AUTO
         2 000674   400003 756100                    STQ     3,,PR4

      373    13352    1     SEG$2.GETCMD$->GET$CMD.NODES$ = ADDR(IBEX_CMD) ;

  13352  2 000675   300173 470500                    LDP0    123,,PR3
         2 000676   000011 236000 3                  LDQ     9
         2 000677   000000 756100                    STQ     0,,PR0

      374    13353    1     SEG$2.GETCMD$->GET$CMD.CONTINUE_OK# = %NO# ;

  13353  2 000700   300173 470500                    LDP0    123,,PR3
         2 000701   000012 236000 3                  LDQ     10
         2 000702   000006 356100                    ANSQ    6,,PR0

      375    13354    1     SEG$2.GETCMD$->GET$CMD.PP_FUN$$ = ENTADDR(CPG$FUN$$) ;

  13354  2 000703   300173 470500                    LDP0    123,,PR3
         2 000704   000000 636000 xent               EAQ     CPG$FUN$$
         2 000705   000031 756100                    STQ     25,,PR0

      376    13355    1     SEG$2.GETCMD$->GET$CMD.SFROUTINE$ = ENTADDR(NIL);

  13355  2 000706   300173 470500                    LDP0    123,,PR3
         2 000707   000002 236000 xsym               LDQ     B_VECTNIL+2
         2 000710   000033 756100                    STQ     27,,PR0

      377    13356    1     U$PARAM.MODE = IBEX_MODE;

  13356  2 000711   001000 236003                    LDQ     512,DU
         2 000712   200216 552140                    STBQ    U$PARAM+6,'40'O,AUTO

      378    13357    1     SEG$2.FLAGS.CONTINUED = %NO#;

  13357  2 000713   000013 236000 3                  LDQ     11
         2 000714   300000 356100                    ANSQ    0,,PR3

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:81   
      379    13358    1     SEG$2.GETCMD$->GET$CMD.TEXT_ = VECTOR(WRITEBUF) ;

  13358  2 000715   300173 470500                    LDP0    123,,PR3
         2 000716   000002 235000 3                  LDA     2
         2 000717   200722 452500                    STP2    @DCB#+1,,AUTO
         2 000720   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 000721   000443 036003                    ADLQ    291,DU
         2 000722   000034 757100                    STAQ    28,,PR0

      380    13359    1     VBOUND(SEG$2.GETCMD$->GET$CMD.TEXT_) = ARS - 1 ;

  13359  2 000723   300173 470500                    LDP0    123,,PR3
         2 000724   200665 236100                    LDQ     ARS,,AUTO
         2 000725   000001 136007                    SBLQ    1,DL
         2 000726   000020 736000                    QLS     16
         2 000727   000034 676100                    ERQ     28,,PR0
         2 000730   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000731   000034 656100                    ERSQ    28,,PR0

      381    13360    1     CALL CPC$OPEN_LL ;

  13360  2 000732   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000733   000000 701000 xent               TSX1    CPC$OPEN_LL
         2 000734   000000 011000                    NOP     0

      382    13361    1     CALL CPA$READCC (SEG$2.GETCMD$->GET$CMD,CMD_SOURCE) ALTRET (CHK_WHEN_ALT);

  13361  2 000735   000000 470400 xsym               LDP0    SEG2$
         2 000736   000173 471500                    LDP1    123,,PR0
         2 000737   200667 633500                    EPPR3   CMD_SOURCE,,AUTO
         2 000740   200723 453500                    STP3    @DCB#+2,,AUTO
         2 000741   200722 451500                    STP1    @DCB#+1,,AUTO
         2 000742   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 000743   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000744   000000 701000 xent               TSX1    CPA$READCC
         2 000745   001200 702000 2                  TSX2    CHK_WHEN_ALT

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:82   
      383    13362
      384    13363    1     IF SEG$2.GETCMD$->GET$CMD.OUT$->P$B.CODE = WHENSHORTCMND

  13363  2 000746   000000 470400 xsym               LDP0    SEG2$
         2 000747   000173 471500                    LDP1    123,,PR0
         2 000750   100001 473500                    LDP3    1,,PR1
         2 000751   300000 720100                    LXL0    0,,PR3
         2 000752   000127 100003                    CMPX0   87,DU
         2 000753   000770 601000 2                  TNZ     s:13370

      385    13364    1         THEN
      386    13365    2             DO ;

      387    13366    2               CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_NOWHEN) ;

  13366  2 000754   000000 236000 xsym               LDQ     SEG2$
         2 000755   000003 036003                    ADLQ    3,DU
         2 000756   200722 756100                    STQ     @DCB#+1,,AUTO
         2 000757   000006 237000 3                  LDAQ    6
         2 000760   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 000761   200722 631500                    EPPR1   @DCB#+1,,AUTO
         2 000762   200723 451500                    STP1    @DCB#+2,,AUTO
         2 000763   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 000764   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000765   000000 701000 xent               TSX1    CXP$POSTERR
         2 000766   000000 011000                    NOP     0

      388    13367    2               GOTO CHK_WHEN_ALT ;

  13367  2 000767   001200 710000 2                  TRA     CHK_WHEN_ALT

      389    13368    2             END ; /* Then Do */
      390    13369
      391    13370    1     SEG$2.NCHARS = P$PCB.NCHARS ;

  13370  2 000770   200003 474500                    LDP4    @P$PCB,,AUTO
         2 000771   400011 721100                    LXL1    9,,PR4
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:83   
         2 000772   000001 741100                    STX1    1,,PR0

      392    13371    1     CALL CPD$SYNTAX(SEG$2.GETCMD$->GET$CMD) ALTRET(E_SYNTAX) ;

  13371  2 000773   200722 451500                    STP1    @DCB#+1,,AUTO
         2 000774   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 000775   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000776   000000 701000 xent               TSX1    CPD$SYNTAX
         2 000777   001160 702000 2                  TSX2    E_SYNTAX

      393    13372    1     BLK$ = SEG$2.GETCMD$->GET$CMD.OUT$ ;

  13372  2 001000   000000 470400 xsym               LDP0    SEG2$
         2 001001   000173 471500                    LDP1    123,,PR0
         2 001002   100001 236100                    LDQ     1,,PR1
         2 001003   200236 756100                    STQ     BLK$,,AUTO

      394    13373    1     CALL SETUP ;

  13373  2 001004   004014 701000 2                  TSX1    SETUP
         2 001005   000000 011000                    NOP     0

      395    13374    1     XUE_ECB.TREE$ = BLK$->P$B.SUBLK$(0) ;

  13374  2 001006   200236 470500                    LDP0    BLK$,,AUTO
         2 001007   000003 236100                    LDQ     3,,PR0
         2 001010   200154 756100                    STQ     XUE_ECB,,AUTO

      396    13375    1     CALL X$EVAL (XUE_ECB) ALTRET (E_CHK_WHEN_EVAL) ;

  13375  2 001011   200154 631500                    EPPR1   XUE_ECB,,AUTO
         2 001012   200722 451500                    STP1    @DCB#+1,,AUTO
         2 001013   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001014   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001015   000000 701000 xent               TSX1    X$EVAL
         2 001016   001106 702000 2                  TSX2    E_CHK_WHEN_EVAL

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:84   
      397    13376        /*
      398    13377              ***** Must resolve to a numeric value for truth value.
      399    13378                    Thus 'ABC' is an error.
      400    13379        */
      401    13380    1     CALL X$DEC_CONVERT (XUE_ECB.OUT$,VALUE) ALTRET(CHK_WHEN_NON_NUMERIC) ;

  13380  2 001017   200662 630500                    EPPR0   VALUE,,AUTO
         2 001020   200723 450500                    STP0    @DCB#+2,,AUTO
         2 001021   200160 631500                    EPPR1   XUE_ECB+4,,AUTO
         2 001022   200722 451500                    STP1    @DCB#+1,,AUTO
         2 001023   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001024   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001025   000000 701000 xent               TSX1    X$DEC_CONVERT
         2 001026   001136 702000 2                  TSX2    CHK_WHEN_NON_NUMERIC

      402    13381    1     IF VALUE <=0

  13381  2 001027   200662 235100                    LDA     VALUE,,AUTO
         2 001030   001075 604400 2                  TMOZ    CHK_WHEN_RET

      403    13382    1         THEN  /* False */
      404    13383    1             GOTO CHK_WHEN_RET ;
      405    13384    1     CALL CPA$ECHOCC(CMD_SOURCE, %NO#) ; /* Ehco Command thru M$LL */

  13384  2 001031   000014 236000 3                  LDQ     12
         2 001032   200723 756100                    STQ     @DCB#+2,,AUTO
         2 001033   200667 630500                    EPPR0   CMD_SOURCE,,AUTO
         2 001034   200722 450500                    STP0    @DCB#+1,,AUTO
         2 001035   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001036   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001037   000000 701000 xent               TSX1    CPA$ECHOCC
         2 001040   000000 011000                    NOP     0

      406    13385    1     BLK$ = P$PCB.OUT$ -> P$B.SUBLK$(1) ;  /* Ptr to object */

  13385  2 001041   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001042   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:85   
         2 001043   100004 236100                    LDQ     4,,PR1
         2 001044   200236 756100                    STQ     BLK$,,AUTO

      407    13386    1     CALL INSERT (P$PCB.TEXT$->DUMMY$CHAR,,BLK$->P$B.CPOS,' ') ;

  13386  2 001045   000000 473500                    LDP3    0,,PR0
         2 001046   200236 474500                    LDP4    BLK$,,AUTO
         2 001047   400002 720100                    LXL0    2,,PR4
         2 001050   040140 100400                    MLR     fill='040'O
         2 001051   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001052   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      408    13387    1     CALL CONCAT(B$JIT.CCBUF, '!', SUBSTR(P$PCB.TEXT$->DUMMY$CHAR,0,P$PCB.NCHARS));

  13387  2 001053   000000 471500                    LDP1    0,,PR0
         2 001054   000011 720100                    LXL0    9,,PR0
         2 001055   000000 473400 xsym               LDP3    B$JIT$
         2 001056   041000 236003                    LDQ     16896,DU
         2 001057   300033 552140                    STBQ    27,'40'O,PR3
         2 001060   040100 100540                    MLR     fill='040'O
         2 001061   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 001062   300033 200377                    ADSC9   27,,PR3                  cn=1,n=255

      409    13388    1     B$JIT.CCARS = P$PCB.NCHARS + 2;

  13388  2 001063   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001064   000011 720100                    LXL0    9,,PR0
         2 001065   000002 621010                    EAX1    2,X0
         2 001066   000000 471400 xsym               LDP1    B$JIT$
         2 001067   100032 741100                    STX1    26,,PR1

      410    13389    1     B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_BUFFULL#;

  13389  2 001070   100143 236100                    LDQ     99,,PR1
         2 001071   000073 276000 1                  ORQ     E_NOWHEN+1
         2 001072   100143 756100                    STQ     99,,PR1

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:86   
      411    13390    1     B$JIT.CPFLAGS1.SKIPABORT = %YES# ;

  13390  2 001073   040000 236007                    LDQ     16384,DL
         2 001074   100143 256100                    ORSQ    99,,PR1

      412    13391
      413    13392    1   CHK_WHEN_RET:
      414    13393
      415    13394    1     CALL CPC$RELSEG(SEG3$) ;

  13394  2 001075   000015 630400 3     CHK_WHEN_RET EPPR0   13
         2 001076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001077   000000 701000 xent               TSX1    CPC$RELSEG
         2 001100   000000 011000                    NOP     0

      416    13395    1     CALL CLOSE_IBEX_DCB (M$IBEX1_NUM) ;

  13395  2 001101   000000 236000 3                  LDQ     0
         2 001102   200721 756100                    STQ     TEMP$+1,,AUTO
         2 001103   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 001104   000000 011000                    NOP     0

      417    13396    1     RETURN ;

  13396  2 001105   000000 702200 xent               TSX2  ! X66_ARET

      418    13397
      419    13398    1   E_CHK_WHEN_EVAL:
      420    13399    1     CPOS = XUE_ECB.ERR_POS#;

  13399  2 001106   200164 235100       E_CHK_WHEN_* LDA     XUE_ECB+8,,AUTO
         2 001107   000022 771000                    ARL     18
         2 001110   200663 755100                    STA     CPOS,,AUTO

      421    13400    1     VALUE = XUE_ECB.ERR_DCB#;

  13400  2 001111   200164 236100                    LDQ     XUE_ECB+8,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:87   
         2 001112   777777 376007                    ANQ     -1,DL
         2 001113   200662 756100                    STQ     VALUE,,AUTO

      422    13401    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_ECB.ERR,,VALUE);

  13401  2 001114   000000 236000 xsym               LDQ     SEG2$
         2 001115   000003 036003                    ADLQ    3,DU
         2 001116   200722 756100                    STQ     @DCB#+1,,AUTO
         2 001117   200662 630500                    EPPR0   VALUE,,AUTO
         2 001120   200727 450500                    STP0    @DCB#+6,,AUTO
         2 001121   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001122   200726 756100                    STQ     @DCB#+5,,AUTO
         2 001123   200165 631500                    EPPR1   XUE_ECB+9,,AUTO
         2 001124   200725 451500                    STP1    @DCB#+4,,AUTO
         2 001125   200663 633500                    EPPR3   CPOS,,AUTO
         2 001126   200724 453500                    STP3    @DCB#+3,,AUTO
         2 001127   200722 634500                    EPPR4   @DCB#+1,,AUTO
         2 001130   200723 454500                    STP4    @DCB#+2,,AUTO
         2 001131   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 001132   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001133   000000 701000 xent               TSX1    CXP$POSTERR
         2 001134   000000 011000                    NOP     0

      423    13402    1     GOTO CHK_WHEN_ALT;

  13402  2 001135   001200 710000 2                  TRA     CHK_WHEN_ALT

      424    13403    1   CHK_WHEN_NON_NUMERIC:
      425    13404    1     CPOS = BLK$ -> P$B.SUBLK$(0) -> P$S.CPOS;

  13404  2 001136   200236 470500       CHK_WHEN_NO* LDP0    BLK$,,AUTO
         2 001137   000003 471500                    LDP1    3,,PR0
         2 001140   100002 235100                    LDA     2,,PR1
         2 001141   200663 755100                    STA     CPOS,,AUTO

      426    13405    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_ILLEXP);

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:88   
  13405  2 001142   000000 236000 xsym               LDQ     SEG2$
         2 001143   000003 036003                    ADLQ    3,DU
         2 001144   200722 756100                    STQ     @DCB#+1,,AUTO
         2 001145   000016 236000 3                  LDQ     14
         2 001146   200725 756100                    STQ     @DCB#+4,,AUTO
         2 001147   200663 631500                    EPPR1   CPOS,,AUTO
         2 001150   200724 451500                    STP1    @DCB#+3,,AUTO
         2 001151   200722 633500                    EPPR3   @DCB#+1,,AUTO
         2 001152   200723 453500                    STP3    @DCB#+2,,AUTO
         2 001153   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 001154   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001155   000000 701000 xent               TSX1    CXP$POSTERR
         2 001156   000000 011000                    NOP     0

      427    13406    1     GOTO CHK_WHEN_ALT ;

  13406  2 001157   001200 710000 2                  TRA     CHK_WHEN_ALT

      428    13407
      429    13408    1   E_SYNTAX:
      430    13409    1     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),P$PCB.HI_CHAR,SEG$2.GETCMD$

  13409  2 001160   000000 470400 xsym  E_SYNTAX     LDP0    SEG2$
         2 001161   000173 471500                    LDP1    123,,PR0
         2 001162   000000 236000 xsym               LDQ     SEG2$
         2 001163   000003 036003                    ADLQ    3,DU
         2 001164   200722 756100                    STQ     @DCB#+1,,AUTO
         2 001165   100001 633500                    EPPR3   1,,PR1
         2 001166   200725 453500                    STP3    @DCB#+4,,AUTO
         2 001167   200003 236100                    LDQ     @P$PCB,,AUTO
         2 001170   000012 036003                    ADLQ    10,DU
         2 001171   200724 756100                    STQ     @DCB#+3,,AUTO
         2 001172   200722 631500                    EPPR1   @DCB#+1,,AUTO
         2 001173   200723 451500                    STP1    @DCB#+2,,AUTO
         2 001174   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 001175   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001176   000000 701000 xent               TSX1    CXP$POSTERR
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:89   
         2 001177   000000 011000                    NOP     0

      431    13410    1                           ->GET$CMD.ERR#) ;
      432    13411
      433    13412    1   CHK_WHEN_ALT:
      434    13413
      435    13414    1     CALL CPC$RELSEG(SEG3$) ;

  13414  2 001200   000015 630400 3     CHK_WHEN_ALT EPPR0   13
         2 001201   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001202   000000 701000 xent               TSX1    CPC$RELSEG
         2 001203   000000 011000                    NOP     0

      436    13415    1     IF DCBADDR(M$IBEX1_NUM)->F$DCB.FCD#

  13415  2 001204   000010 470400 3                  LDP0    8
         2 001205   000000 471500                    LDP1    0,,PR0
         2 001206   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001207   100000 473510                    LDP3    0,X0,PR1
         2 001210   300031 236100                    LDQ     25,,PR3
         2 001211   020000 316007                    CANQ    8192,DL
         2 001212   001217 600000 2                  TZE     s:13418

      437    13416    1         THEN
      438    13417    1             CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;

  13417  2 001213   000000 236000 3                  LDQ     0
         2 001214   200721 756100                    STQ     TEMP$+1,,AUTO
         2 001215   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 001216   000000 011000                    NOP     0

      439    13418    1     ALTRETURN ;

  13418  2 001217   000000 702200 xent               TSX2  ! X66_AALT

      440    13419        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:90   
      441    13420        /*
      442    13421             ***** Save command VARIABLES...
      443    13422        */
      444    13423    1   SAVE_VARIABLES:
      445    13424        /*
      446    13425             ***** Reset the PROMPT if necessary ...
      447    13426        */
      448    13427    1     IF XUE_ECB.RESULTS.PROMPT#

  13427  2 001220   200173 234100       SAVE_VARIAB* SZN     XUE_ECB+15,,AUTO
         2 001221   001226 605000 2                  TPL     s:13430

      449    13428    1        THEN
      450    13429    1           SEG$2.GETCMD$->GET$CMD.ALWAYS_SET_PROMPT# = %YES#;

  13429  2 001222   000000 470400 xsym               LDP0    SEG2$
         2 001223   000173 471500                    LDP1    123,,PR0
         2 001224   002000 236003                    LDQ     1024,DU
         2 001225   100006 256100                    ORSQ    6,,PR1

      451    13430    1     CALL CPC$RELSEG (SEG3$);

  13430  2 001226   000015 630400 3                  EPPR0   13
         2 001227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001230   000000 701000 xent               TSX1    CPC$RELSEG
         2 001231   000000 011000                    NOP     0

      452    13431    1     IF DCBADDR(M$IBEX1_NUM) -> F$DCB.FCD#

  13431  2 001232   000010 470400 3                  LDP0    8
         2 001233   000000 471500                    LDP1    0,,PR0
         2 001234   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001235   100000 473510                    LDP3    0,X0,PR1
         2 001236   300031 236100                    LDQ     25,,PR3
         2 001237   020000 316007                    CANQ    8192,DL
         2 001240   001245 600000 2                  TZE     s:13434

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:91   
      453    13432    1        THEN   /* Close M$IBEX1 */
      454    13433    1           CALL CLOSE_IBEX_DCB (M$IBEX1_NUM) ;

  13433  2 001241   000000 236000 3                  LDQ     0
         2 001242   200721 756100                    STQ     TEMP$+1,,AUTO
         2 001243   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 001244   000000 011000                    NOP     0

      455    13434    1     RETURN;

  13434  2 001245   000000 702200 xent               TSX2  ! X66_ARET

      456    13435        /**/
      457    13436    1   ABORT:
      458    13437    2     DO WHILE (%NO#) ;

  13437  2 001246   001267 710000 2     ABORT        TRA     s:13443

      459    13438
      460    13439    2   CPG$BREAK_IN_EVAL:
      461    13440    2         CALL CPC$WRITEMSGE (E_CSINT,,,,,%YES#) ;

  13440  2 001247   000017 236000 3     CPG$BREAK_I* LDQ     15
         2 001250   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001251   200726 757100                    STAQ    @DCB#+5,,AUTO
         2 001252   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001253   000001 235000 xsym               LDA     B_VECTNIL+1
         2 001254   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 001255   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001256   000020 235000 3                  LDA     16
         2 001257   200722 757100                    STAQ    @DCB#+1,,AUTO
         2 001260   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001261   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001262   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 001263   000000 011000                    NOP     0

      462    13441    2         SEG$2.FLAGS.USE_REMEM = %NO# ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:92   

  13441  2 001264   000000 470400 xsym               LDP0    SEG2$
         2 001265   000021 236000 3                  LDQ     17
         2 001266   000000 356100                    ANSQ    0,,PR0

      463    13442    2     END ;   /* Do While */

      464    13443    1     CALL CPC$RELSEG (SEG3$);

  13443  2 001267   000015 630400 3                  EPPR0   13
         2 001270   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001271   000000 701000 xent               TSX1    CPC$RELSEG
         2 001272   000000 011000                    NOP     0

      465    13444        /*
      466    13445             ***** Reset the PROMPT if necessary ...
      467    13446        */
      468    13447    1     IF XUE_ECB.RESULTS.PROMPT#

  13447  2 001273   200173 234100                    SZN     XUE_ECB+15,,AUTO
         2 001274   001301 605000 2                  TPL     ABORT_GOTO

      469    13448    1        THEN
      470    13449    1           SEG$2.GETCMD$->GET$CMD.ALWAYS_SET_PROMPT# = %YES#;

  13449  2 001275   000000 470400 xsym               LDP0    SEG2$
         2 001276   000173 471500                    LDP1    123,,PR0
         2 001277   002000 236003                    LDQ     1024,DU
         2 001300   100006 256100                    ORSQ    6,,PR1

      471    13450    1   ABORT_GOTO:
      472    13451    1     IF DCBADDR(M$IBEX1_NUM) -> F$DCB.FCD#

  13451  2 001301   000010 470400 3     ABORT_GOTO   LDP0    8
         2 001302   000000 471500                    LDP1    0,,PR0
         2 001303   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 001304   100000 473510                    LDP3    0,X0,PR1
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:93   
         2 001305   300031 236100                    LDQ     25,,PR3
         2 001306   020000 316007                    CANQ    8192,DL
         2 001307   001314 600000 2                  TZE     s:13454

      473    13452    1        THEN   /* Close M$IBEX1 */
      474    13453    1           CALL CLOSE_IBEX_DCB (M$IBEX1_NUM) ;

  13453  2 001310   000000 236000 3                  LDQ     0
         2 001311   200721 756100                    STQ     TEMP$+1,,AUTO
         2 001312   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 001313   000000 011000                    NOP     0

      475    13454    1     ALTRETURN;

  13454  2 001314   000000 702200 xent               TSX2  ! X66_AALT

      476    13455        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:94   
      477    13456    1   IF_COMMAND: PROC ALTRET;

  13456  2 001315   200706 741300       IF_COMMAND   STX1  ! STAR_S_IS_OPEN+2,,AUTO

      478    13457    2     BLK$=P$PCB.OUT$;

  13457  2 001316   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001317   000003 236100                    LDQ     3,,PR0
         2 001320   200236 756100                    STQ     BLK$,,AUTO

      479    13458    2     CALL SETUP;

  13458  2 001321   004014 701000 2                  TSX1    SETUP
         2 001322   000000 011000                    NOP     0

      480    13459    2     XUE_ECB.TREE$ = BLK$ -> P$B.SUBLK$(0);

  13459  2 001323   200236 470500                    LDP0    BLK$,,AUTO
         2 001324   000003 236100                    LDQ     3,,PR0
         2 001325   200154 756100                    STQ     XUE_ECB,,AUTO

      481    13460    2     SEG$2.FLAGS.USE_REMEM = %YES# ;

  13460  2 001326   000000 471400 xsym               LDP1    SEG2$
         2 001327   000020 236003                    LDQ     16,DU
         2 001330   100000 256100                    ORSQ    0,,PR1

      482    13461    2     CALL X$EVAL (XUE_ECB) ALTRET(E_EVAL);

  13461  2 001331   200154 633500                    EPPR3   XUE_ECB,,AUTO
         2 001332   200722 453500                    STP3    @DCB#+1,,AUTO
         2 001333   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001334   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001335   000000 701000 xent               TSX1    X$EVAL
         2 001336   001454 702000 2                  TSX2    E_EVAL

      483    13462    2     SEG$2.FLAGS.USE_REMEM = %NO# ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:95   

  13462  2 001337   000000 470400 xsym               LDP0    SEG2$
         2 001340   000021 236000 3                  LDQ     17
         2 001341   000000 356100                    ANSQ    0,,PR0

      484    13463        /*
      485    13464             ***** Must resolve to a numeric value for truth value.
      486    13465                   Thus 'ABC' is an error.
      487    13466        */
      488    13467    2     CALL X$DEC_CONVERT (XUE_ECB.OUT$,VALUE) ALTRET(NON_NUMERIC);

  13467  2 001342   200662 631500                    EPPR1   VALUE,,AUTO
         2 001343   200723 451500                    STP1    @DCB#+2,,AUTO
         2 001344   200160 633500                    EPPR3   XUE_ECB+4,,AUTO
         2 001345   200722 453500                    STP3    @DCB#+1,,AUTO
         2 001346   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001347   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001350   000000 701000 xent               TSX1    X$DEC_CONVERT
         2 001351   001510 702000 2                  TSX2    NON_NUMERIC

      489    13468    2     IF VALUE <= 0

  13468  2 001352   200662 235100                    LDA     VALUE,,AUTO
         2 001353   001356 605400 2                  TPNZ    s:13477

      490    13469    2        THEN   /* False */
      491    13470    2           P$PCB.HI_CHAR = 0; /* Set a flag so that CPA$IBEX can ignore the cmd */

  13470  2 001354   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001355   000012 450100                    STZ     10,,PR0

      492    13471        /*
      493    13472             ***** If object ...
      494    13473                   Blank out the if command part and stuff the object
      495    13474                   into B$JIT.CCBUF. Set the flag so that ibex will
      496    13475                   "READ" from ccbuf.
      497    13476        */
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:96   
      498    13477    2     BLK$ = P$PCB.OUT$ -> P$B.SUBLK$(1); /* Ptr to object */

  13477  2 001356   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001357   000003 471500                    LDP1    3,,PR0
         2 001360   100004 236100                    LDQ     4,,PR1
         2 001361   200236 756100                    STQ     BLK$,,AUTO

      499    13478    2     CALL INSERT (P$PCB.TEXT$->DUMMY$CHAR,,BLK$->P$B.CPOS,' ');

  13478  2 001362   000000 473500                    LDP3    0,,PR0
         2 001363   200236 474500                    LDP4    BLK$,,AUTO
         2 001364   400002 720100                    LXL0    2,,PR4
         2 001365   040140 100400                    MLR     fill='040'O
         2 001366   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001367   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      500    13479    2     TXT# = SEG$2.GETCMD$->GET$CMD.RLT$->RLT(SEG$2.GETCMD$->GET$CMD.NLINES);

  13479  2 001370   000000 471400 xsym               LDP1    SEG2$
         2 001371   100173 473500                    LDP3    123,,PR1
         2 001372   300041 475500                    LDP5    33,,PR3
         2 001373   300046 236100                    LDQ     38,,PR3
         2 001374   000022 732000                    QRS     18
         2 001375   000100 101506                    MRL     fill='000'O
         2 001376   500000 000001                    ADSC9   0,Q,PR5                  cn=0,n=1
         2 001377   200664 000004                    ADSC9   TXT#,,AUTO               cn=0,n=4

      501    13480    2     TXT$ = PINCRC(P$PCB.TEXT$,P$PCB.NCHARS-TXT#);

  13480  2 001400   000011 236100                    LDQ     9,,PR0
         2 001401   200664 136100                    SBLQ    TXT#,,AUTO
         2 001402   000000 473500                    LDP3    0,,PR0
         2 001403   000011 402007                    MPY     9,DL
         2 001404   000000 116003                    CMPQ    0,DU
         2 001405   001407 605000 2                  TPL     s:13480+7
         2 001406   000044 036003                    ADLQ    36,DU
         2 001407   300000 503506                    ABD     0,QL,PR3
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:97   
         2 001410   200240 453500                    STP3    TXT$,,AUTO

      502    13481    2     IF SEG$2.GETCMD$ -> GET$CMD.RCVD_PROMPT#

  13481  2 001411   100173 475500                    LDP5    123,,PR1
         2 001412   500006 236100                    LDQ     6,,PR5
         2 001413   020000 316003                    CANQ    8192,DU
         2 001414   001434 600000 2                  TZE     s:13491

      503    13482    2         THEN
      504    13483    3           DO ;

      505    13484    3             B$JIT.CCBUF = ' ' ;

  13484  2 001415   000000 476400 xsym               LDP6    B$JIT$
         2 001416   040100 100400                    MLR     fill='040'O
         2 001417   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001420   600033 000400                    ADSC9   27,,PR6                  cn=0,n=256

      506    13485    3             CALL CONCAT(B$JIT.CCBUF, '!',

  13485  2 001421   041000 236003                    LDQ     16896,DU
         2 001422   600033 552140                    STBQ    27,'40'O,PR6
         2 001423   200664 720100                    LXL0    TXT#,,AUTO
         2 001424   040100 100540                    MLR     fill='040'O
         2 001425   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 001426   600033 200377                    ADSC9   27,,PR6                  cn=1,n=255

      507    13486    3                         SUBSTR(TXT$->DUMMY$CHAR,0,TXT#)) ;
      508    13487    3             B$JIT.CCARS = TXT# + 1 ;

  13487  2 001427   200664 720100                    LXL0    TXT#,,AUTO
         2 001430   000001 621010                    EAX1    1,X0
         2 001431   000000 470400 xsym               LDP0    B$JIT$
         2 001432   000032 741100                    STX1    26,,PR0

      509    13488    3           END ; /* Then Do */
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:98   

  13488  2 001433   001443 710000 2                  TRA     s:13494

      510    13489    2         ELSE
      511    13490    3           DO ;

      512    13491    3             B$JIT.CCBUF = SUBSTR(TXT$->DUMMY$CHAR,0,TXT#) ;

  13491  2 001434   200664 720100                    LXL0    TXT#,,AUTO
         2 001435   000000 476400 xsym               LDP6    B$JIT$
         2 001436   040100 100540                    MLR     fill='040'O
         2 001437   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 001440   600033 000400                    ADSC9   27,,PR6                  cn=0,n=256

      513    13492    3             B$JIT.CCARS = TXT# ;

  13492  2 001441   200664 720100                    LXL0    TXT#,,AUTO
         2 001442   600032 740100                    STX0    26,,PR6

      514    13493    3           END ; /* Else Do */

      515    13494    2     B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_BUFFULL#;

  13494  2 001443   000000 470400 xsym               LDP0    B$JIT$
         2 001444   000143 236100                    LDQ     99,,PR0
         2 001445   000073 276000 1                  ORQ     E_NOWHEN+1
         2 001446   000143 756100                    STQ     99,,PR0

      516    13495    2     SEG$2.FLAGS.USE_CCBUF_IF_YC = %YES# ;

  13495  2 001447   000000 471400 xsym               LDP1    SEG2$
         2 001450   000010 236003                    LDQ     8,DU
         2 001451   100000 256100                    ORSQ    0,,PR1

      517    13496    2     RETURN;

  13496  2 001452   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:99   
         2 001453   000001 702211                    TSX2  ! 1,X1

      518    13497        /**/
      519    13498    2   E_EVAL:
      520    13499    2     SEG$2.FLAGS.USE_REMEM = %NO# ;

  13499  2 001454   000000 470400 xsym  E_EVAL       LDP0    SEG2$
         2 001455   000021 236000 3                  LDQ     17
         2 001456   000000 356100                    ANSQ    0,,PR0

      521    13500    2     CPOS = XUE_ECB.ERR_POS#;

  13500  2 001457   200164 235100                    LDA     XUE_ECB+8,,AUTO
         2 001460   000022 771000                    ARL     18
         2 001461   200663 755100                    STA     CPOS,,AUTO

      522    13501    2     VALUE = XUE_ECB.ERR_DCB#;

  13501  2 001462   200164 236100                    LDQ     XUE_ECB+8,,AUTO
         2 001463   777777 376007                    ANQ     -1,DL
         2 001464   200662 756100                    STQ     VALUE,,AUTO

      523    13502    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_ECB.ERR,,VALUE);

  13502  2 001465   000000 236000 xsym               LDQ     SEG2$
         2 001466   000003 036003                    ADLQ    3,DU
         2 001467   200722 756100                    STQ     @DCB#+1,,AUTO
         2 001470   200662 631500                    EPPR1   VALUE,,AUTO
         2 001471   200727 451500                    STP1    @DCB#+6,,AUTO
         2 001472   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001473   200726 756100                    STQ     @DCB#+5,,AUTO
         2 001474   200165 633500                    EPPR3   XUE_ECB+9,,AUTO
         2 001475   200725 453500                    STP3    @DCB#+4,,AUTO
         2 001476   200663 634500                    EPPR4   CPOS,,AUTO
         2 001477   200724 454500                    STP4    @DCB#+3,,AUTO
         2 001500   200722 635500                    EPPR5   @DCB#+1,,AUTO
         2 001501   200723 455500                    STP5    @DCB#+2,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:100  
         2 001502   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 001503   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001504   000000 701000 xent               TSX1    CXP$POSTERR
         2 001505   000000 011000                    NOP     0

      524    13503    2     ALTRETURN;

  13503  2 001506   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 001507   000000 702211                    TSX2  ! 0,X1

      525    13504    2   NON_NUMERIC:
      526    13505    2     CPOS = BLK$ -> P$B.SUBLK$(0) -> P$S.CPOS;

  13505  2 001510   200236 470500       NON_NUMERIC  LDP0    BLK$,,AUTO
         2 001511   000003 471500                    LDP1    3,,PR0
         2 001512   100002 235100                    LDA     2,,PR1
         2 001513   200663 755100                    STA     CPOS,,AUTO

      527    13506    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_ILLEXP);

  13506  2 001514   000000 236000 xsym               LDQ     SEG2$
         2 001515   000003 036003                    ADLQ    3,DU
         2 001516   200722 756100                    STQ     @DCB#+1,,AUTO
         2 001517   000016 236000 3                  LDQ     14
         2 001520   200725 756100                    STQ     @DCB#+4,,AUTO
         2 001521   200663 631500                    EPPR1   CPOS,,AUTO
         2 001522   200724 451500                    STP1    @DCB#+3,,AUTO
         2 001523   200722 633500                    EPPR3   @DCB#+1,,AUTO
         2 001524   200723 453500                    STP3    @DCB#+2,,AUTO
         2 001525   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 001526   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001527   000000 701000 xent               TSX1    CXP$POSTERR
         2 001530   000000 011000                    NOP     0

      528    13507    2     ALTRETURN;

  13507  2 001531   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:101  
         2 001532   000000 702211                    TSX2  ! 0,X1

      529    13508    2   END IF_COMMAND;
      530    13509        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:102  
      531    13510    1   LET_COMMAND: PROC ALTRET;

  13510  2 001533   200706 741300       LET_COMMAND  STX1  ! STAR_S_IS_OPEN+2,,AUTO

      532    13511        /*E*       ERROR: CPG-E$ILLEXP-0
      533    13512                   MESSAGE: Illegal expression. Must resolve to NUMERIC value
      534    13513        */
      535    13514        /*
      536    13515             **** Let command...
      537    13516        */
      538    13517    2     BLK$=P$PCB.OUT$;

  13517  2 001534   200003 470500                    LDP0    @P$PCB,,AUTO
         2 001535   000003 236100                    LDQ     3,,PR0
         2 001536   200236 756100                    STQ     BLK$,,AUTO

      539    13518    2     CALL SETUP;

  13518  2 001537   004014 701000 2                  TSX1    SETUP
         2 001540   000000 011000                    NOP     0

      540    13519    2     IF (BLK$ -> P$B.NSUBLKS = 0) OR (BLK$->P$B.CODE = DVARIABLESOPT)

  13519  2 001541   200236 470500                    LDP0    BLK$,,AUTO
         2 001542   000001 220100                    LDX0    1,,PR0
         2 001543   001774 600000 2                  TZE     LET_LIST
         2 001544   000000 721100                    LXL1    0,,PR0
         2 001545   000023 101003                    CMPX1   19,DU
         2 001546   001774 600000 2                  TZE     LET_LIST

      541    13520    2        THEN
      542    13521                    /* No options means list COMMAND VARIABLES, BANNERTEXT,
      543    13522                        or REGISTERNAME.
      544    13523                    */
      545    13524    2           GOTO LET_LIST;
      546    13525    2     IF BLK$ -> P$B.SUBLK$(0) -> P$B.CODE = %LET_DELETE#

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:103  
  13525  2 001547   000003 471500                    LDP1    3,,PR0
         2 001550   100000 722100                    LXL2    0,,PR1
         2 001551   000003 102003                    CMPX2   3,DU
         2 001552   002370 600000 2                  TZE     LET_DELETE

      547    13526    2        THEN   /* LET DELETE [ var [,var]... ] */
      548    13527    2           GOTO LET_DELETE;
      549    13528    2     IF BLK$ -> P$B.SUBLK$(0) -> P$B.CODE = %LET_BANNERTEXT#

  13528  2 001553   000004 102003                    CMPX2   4,DU
         2 001554   002524 600000 2                  TZE     LET_BANNERTEXT

      550    13529    2        THEN   /* LET BANNERTEXTx ='text' */
      551    13530    2           GOTO LET_BANNERTEXT;
      552    13531    2     IF BLK$ -> P$B.CODE = %DBANNERTEXTOPT# OR

  13531  2 001555   000032 101003                    CMPX1   26,DU
         2 001556   001774 600000 2                  TZE     LET_LIST
         2 001557   000033 101003                    CMPX1   27,DU
         2 001560   001774 600000 2                  TZE     LET_LIST

      553    13532    2         BLK$ -> P$B.CODE = %DREGISTERNAMEOPT#
      554    13533    2        THEN   /* DI BANNERTEXT or DI REGISTERNAME */
      555    13534    2          GOTO LET_LIST;
      556    13535        /*
      557    13536             ***** Let var = exp ...
      558    13537        */
      559    13538    2     INDX1=0;

  13538  2 001561   200660 450100                    STZ     INDX1,,AUTO

      560    13539    3     DO WHILE (INDX1 < BLK$->P$B.NSUBLKS);

  13539  2 001562   000001 236100                    LDQ     1,,PR0
         2 001563   000022 772000                    QRL     18
         2 001564   200660 116100                    CMPQ    INDX1,,AUTO
         2 001565   001772 602000 2                  TNC     s:13595
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:104  
         2 001566   001772 600000 2                  TZE     s:13595

      561    13540    3        NAME$=BLK$ -> P$B.SUBLK$(INDX1);

  13540  2 001567   200236 470500                    LDP0    BLK$,,AUTO
         2 001570   200660 720100                    LXL0    INDX1,,AUTO
         2 001571   000003 236110                    LDQ     3,X0,PR0
         2 001572   200237 756100                    STQ     NAME$,,AUTO

      562    13541    3        INDX1=INDX1+1;

  13541  2 001573   200660 235100                    LDA     INDX1,,AUTO
         2 001574   000001 035007                    ADLA    1,DL
         2 001575   200660 755100                    STA     INDX1,,AUTO

      563    13542        /*
      564    13543             ***** Get the value that is to be stored...
      565    13544        */
      566    13545    3     XUE_ECB.TREE$ = BLK$ -> P$B.SUBLK$(INDX1);

  13545  2 001576   000003 236105                    LDQ     3,AL,PR0
         2 001577   200154 756100                    STQ     XUE_ECB,,AUTO

      567    13546    3     SEG$2.FLAGS.USE_REMEM = %YES# ;

  13546  2 001600   000000 471400 xsym               LDP1    SEG2$
         2 001601   000020 236003                    LDQ     16,DU
         2 001602   100000 256100                    ORSQ    0,,PR1

      568    13547    3     CALL X$EVAL (XUE_ECB) ALTRET(E_LET);

  13547  2 001603   200154 633500                    EPPR3   XUE_ECB,,AUTO
         2 001604   200722 453500                    STP3    @DCB#+1,,AUTO
         2 001605   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001606   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001607   000000 701000 xent               TSX1    X$EVAL
         2 001610   003277 702000 2                  TSX2    E_LET
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:105  

      569    13548    3     SEG$2.FLAGS.USE_REMEM = %NO# ;

  13548  2 001611   000000 470400 xsym               LDP0    SEG2$
         2 001612   000021 236000 3                  LDQ     17
         2 001613   000000 356100                    ANSQ    0,,PR0

      570    13549        /*
      571    13550             ***** Don't allow lets of special values...
      572    13551        */
      573    13552    3        CALL XLATE (SUBSTR(TEMPBUF,0,8), B$XL_UPPER, NAME$ -> P$S.TEXT);

  13552  2 001614   200237 471500                    LDP1    NAME$,,AUTO
         2 001615   100004 236100                    LDQ     4,,PR1
         2 001616   000033 772000                    QRL     27
         2 001617   000000 620006                    EAX0    0,QL
         2 001620   000000 473400 xsym               LDP3    B$XL_UPPER$
         2 001621   040100 160540                    MVT     fill='040'O
         2 001622   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 001623   200243 000010                    ADSC9   TEMPBUF,,AUTO            cn=0,n=8
         2 001624   300000 000100                    ARG     0,,PR3

      574    13553    3        IF SUBSTR(TEMPBUF,0,4) = 'OK'

  13553  2 001625   040000 106500                    CMPC    fill='040'O
         2 001626   200243 000004                    ADSC9   TEMPBUF,,AUTO            cn=0,n=4
         2 001627   000074 000002 1                  ADSC9   E_NOWHEN+2               cn=0,n=2
         2 001630   001641 600000 2                  TZE     s:13558
         2 001631   040000 106500                    CMPC    fill='040'O
         2 001632   200243 000010                    ADSC9   TEMPBUF,,AUTO            cn=0,n=8
         2 001633   000075 000005 1                  ADSC9   E_NOWHEN+3               cn=0,n=5
         2 001634   001641 600000 2                  TZE     s:13558
         2 001635   040000 106500                    CMPC    fill='040'O
         2 001636   200243 000010                    ADSC9   TEMPBUF,,AUTO            cn=0,n=8
         2 001637   000077 000005 1                  ADSC9   E_NOWHEN+5               cn=0,n=5
         2 001640   001665 601000 2                  TNZ     s:13568

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:106  
      575    13554    3          OR SUBSTR(TEMPBUF,0,8) = 'ERROR'
      576    13555    3          OR SUBSTR(TEMPBUF,0,8) = 'ABORT'
      577    13556    3           THEN
      578    13557    4              DO;

      579    13558    4                 CPOS = BLK$ -> P$B.SUBLK$(INDX1) -> P$S.CPOS;

  13558  2 001641   200236 474500                    LDP4    BLK$,,AUTO
         2 001642   200660 720100                    LXL0    INDX1,,AUTO
         2 001643   400003 475510                    LDP5    3,X0,PR4
         2 001644   500002 235100                    LDA     2,,PR5
         2 001645   200663 755100                    STA     CPOS,,AUTO

      580    13559    4                 CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_READONLYLET);

  13559  2 001646   000000 236000 xsym               LDQ     SEG2$
         2 001647   000003 036003                    ADLQ    3,DU
         2 001650   200722 756100                    STQ     @DCB#+1,,AUTO
         2 001651   000022 236000 3                  LDQ     18
         2 001652   200725 756100                    STQ     @DCB#+4,,AUTO
         2 001653   200663 635500                    EPPR5   CPOS,,AUTO
         2 001654   200724 455500                    STP5    @DCB#+3,,AUTO
         2 001655   200722 636500                    EPPR6   @DCB#+1,,AUTO
         2 001656   200723 456500                    STP6    @DCB#+2,,AUTO
         2 001657   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 001660   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001661   000000 701000 xent               TSX1    CXP$POSTERR
         2 001662   000000 011000                    NOP     0

      581    13560    4                 ALTRETURN;

  13560  2 001663   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 001664   000000 702211                    TSX2  ! 0,X1

      582    13561    4              END;
      583    13562        /*E*       ERROR: CPG-E$READONLYLET-0
      584    13563                   MESSAGE: OK, ERROR, and ABORT cannot be modified.
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:107  
      585    13564        */
      586    13565        /*
      587    13566             ***** Store the value in B$JIT.STEPCC or a command VARIABLE...
      588    13567        */
      589    13568    3        IF SUBSTR(TEMPBUF,0,8) = 'STEPCC'

  13568  2 001665   040000 106500                    CMPC    fill='040'O
         2 001666   200243 000010                    ADSC9   TEMPBUF,,AUTO            cn=0,n=8
         2 001667   000101 000006 1                  ADSC9   E_NOWHEN+7               cn=0,n=6
         2 001670   001735 601000 2                  TNZ     s:13589

      590    13569    3           THEN
      591    13570    4              DO; /* Stepcc */

      592    13571    4                 CALL X$DEC_CONVERT (XUE_ECB.OUT$,VALUE) ALTRET(NON_NUMERIC);

  13571  2 001671   200662 634500                    EPPR4   VALUE,,AUTO
         2 001672   200723 454500                    STP4    @DCB#+2,,AUTO
         2 001673   200160 635500                    EPPR5   XUE_ECB+4,,AUTO
         2 001674   200722 455500                    STP5    @DCB#+1,,AUTO
         2 001675   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001676   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001677   000000 701000 xent               TSX1    X$DEC_CONVERT
         2 001700   003333 702000 2                  TSX2    NON_NUMERIC

      593    13572    4                 IF VALUE > 511

  13572  2 001701   200662 235100                    LDA     VALUE,,AUTO
         2 001702   000777 115007                    CMPA    511,DL
         2 001703   001730 604400 2                  TMOZ    s:13584

      594    13573    4                    THEN
      595    13574    5                       DO; /* flag it */

      596    13575    5                          CPOS = BLK$ -> P$B.SUBLK$(INDX1) -> P$S.CPOS;

  13575  2 001704   200236 470500                    LDP0    BLK$,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:108  
         2 001705   200660 720100                    LXL0    INDX1,,AUTO
         2 001706   000003 471510                    LDP1    3,X0,PR0
         2 001707   100002 235100                    LDA     2,,PR1
         2 001710   200663 755100                    STA     CPOS,,AUTO

      597    13576    5                          CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_XBIG511);

  13576  2 001711   000000 236000 xsym               LDQ     SEG2$
         2 001712   000003 036003                    ADLQ    3,DU
         2 001713   200722 756100                    STQ     @DCB#+1,,AUTO
         2 001714   000023 236000 3                  LDQ     19
         2 001715   200725 756100                    STQ     @DCB#+4,,AUTO
         2 001716   200663 631500                    EPPR1   CPOS,,AUTO
         2 001717   200724 451500                    STP1    @DCB#+3,,AUTO
         2 001720   200722 633500                    EPPR3   @DCB#+1,,AUTO
         2 001721   200723 453500                    STP3    @DCB#+2,,AUTO
         2 001722   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 001723   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001724   000000 701000 xent               TSX1    CXP$POSTERR
         2 001725   000000 011000                    NOP     0

      598    13577    5                          ALTRETURN;

  13577  2 001726   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 001727   000000 702211                    TSX2  ! 0,X1

      599    13578    5                       END;
      600    13579        /*E*    ERROR: CPG-E$XBIG511-C
      601    13580                MESSAGE: STEPCC can not be greater than 511.
      602    13581                DESCRIPTION: The user tried to set the STEPCC to a value
      603    13582                              greater than 511.
      604    13583        */
      605    13584    4                 B$JIT.STEPCC = VALUE;

  13584  2 001730   000000 470400 xsym               LDP0    B$JIT$
         2 001731   200662 236100                    LDQ     VALUE,,AUTO
         2 001732   000022 736000                    QLS     18
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:109  
         2 001733   000316 552120                    STBQ    206,'20'O,PR0

      606    13585    4                 GOTO END_LOOP;

  13585  2 001734   001761 710000 2                  TRA     END_LOOP

      607    13586    4              END;
      608    13587    3           ELSE
      609    13588    4              DO; /* Command variable */

      610    13589    4                 CPOS = BLK$ -> P$B.SUBLK$(INDX1) -> P$S.CPOS;

  13589  2 001735   200236 474500                    LDP4    BLK$,,AUTO
         2 001736   200660 720100                    LXL0    INDX1,,AUTO
         2 001737   400003 475510                    LDP5    3,X0,PR4
         2 001740   500002 235100                    LDA     2,,PR5
         2 001741   200663 755100                    STA     CPOS,,AUTO

      611    13590    4                 CALL X$PUT_VAR (NAME$->P$S.TEXTC$, XUE_ECB.OUT$, XUE_ECB,

  13590  2 001742   000024 236000 3                  LDQ     20
         2 001743   200726 756100                    STQ     @DCB#+5,,AUTO
         2 001744   200663 635500                    EPPR5   CPOS,,AUTO
         2 001745   200725 455500                    STP5    @DCB#+4,,AUTO
         2 001746   200154 636500                    EPPR6   XUE_ECB,,AUTO
         2 001747   200724 456500                    STP6    @DCB#+3,,AUTO
         2 001750   200160 637500                    EPPR7   XUE_ECB+4,,AUTO
         2 001751   200723 457500                    STP7    @DCB#+2,,AUTO
         2 001752   200237 236100                    LDQ     NAME$,,AUTO
         2 001753   000003 036003                    ADLQ    3,DU
         2 001754   200722 756100                    STQ     @DCB#+1,,AUTO
         2 001755   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 001756   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001757   000000 701000 xent               TSX1    X$PUT_VAR
         2 001760   003277 702000 2                  TSX2    E_LET

      612    13591    4                               CPOS, %XUE_EXTERNAL#) ALTRET(E_LET) ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:110  
      613    13592    4              END;

      614    13593    3   END_LOOP: INDX1=INDX1+1;

  13593  2 001761   200660 235100       END_LOOP     LDA     INDX1,,AUTO
         2 001762   000001 035007                    ADLA    1,DL
         2 001763   200660 755100                    STA     INDX1,,AUTO

      615    13594    3     END; /* Do while ... End */

  13594  2 001764   200236 470500                    LDP0    BLK$,,AUTO
         2 001765   000001 236100                    LDQ     1,,PR0
         2 001766   000022 772000                    QRL     18
         2 001767   200660 116100                    CMPQ    INDX1,,AUTO
         2 001770   001772 600000 2                  TZE     s:13595
         2 001771   001567 603000 2                  TRC     s:13540

      616    13595    2     RETURN;

  13595  2 001772   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 001773   000001 702211                    TSX2  ! 1,X1

      617    13596        /*
      618    13597             ***** List COMMAND VARIABLES ...
      619    13598        */
      620    13599    2   LET_LIST:
      621    13600    2     CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(E_ROUTINE);

  13600  2 001774   000000 630400 3     LET_LIST     EPPR0   0
         2 001775   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001776   000000 701000 xent               TSX1    CPC$OPEN_S
         2 001777   003177 702000 2                  TSX2    E_ROUTINE

      622    13601    2     IF BLK$->P$B.CODE = %DBANNERTEXTOPT# OR

  13601  2 002000   200236 470500                    LDP0    BLK$,,AUTO
         2 002001   000000 720100                    LXL0    0,,PR0
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:111  
         2 002002   000032 100003                    CMPX0   26,DU
         2 002003   002006 600000 2                  TZE     s:13605
         2 002004   000033 100003                    CMPX0   27,DU
         2 002005   002037 601000 2                  TNZ     s:13623

      623    13602    2              BLK$->P$B.CODE = %DREGISTERNAMEOPT#
      624    13603    2       THEN
      625    13604    3         DO ;

      626    13605    3           PERM = %NO# ;

  13605  2 002006   200676 450100                    STZ     PERM,,AUTO

      627    13606    3           IF BLK$->P$B.NSUBLKS > 0

  13606  2 002007   000001 221100                    LDX1    1,,PR0
         2 002010   002016 600000 2                  TZE     s:13611

      628    13607    3             THEN
      629    13608    3               IF BLK$->P$B.SUBLK$(0)->P$B.CODE = %BANNERTEXT_PERM#

  13608  2 002011   000003 471500                    LDP1    3,,PR0
         2 002012   100000 722100                    LXL2    0,,PR1
         2 002013   002016 601000 2                  TNZ     s:13611

      630    13609    3                 THEN
      631    13610    3                   PERM = %YES# ;

  13610  2 002014   400000 236003                    LDQ     -131072,DU
         2 002015   200676 756100                    STQ     PERM,,AUTO

      632    13611    4           DO CASE(BLK$->P$B.CODE) ;

  13611  2 002016   000000 236100                    LDQ     0,,PR0
         2 002017   777777 376007                    ANQ     -1,DL
         2 002020   000032 136007                    SBLQ    26,DL
         2 002021   000002 116007                    CMPQ    2,DL
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:112  
         2 002022   002024 602006 2                  TNC     s:13611+6,QL
         2 002023   002033 710000 2                  TRA     s:13620
         2 002024   002026 710000 2                  TRA     s:13614
         2 002025   002031 710000 2                  TRA     s:13617

      633    13612
      634    13613    4             CASE(%DBANNERTEXTOPT#) ;

      635    13614    4               CALL LIST_BANNERTEXT ALTRET(BANNERTEXT_ALT) ;

  13614  2 002026   004510 701000 2                  TSX1    LIST_BANNERTEXT
         2 002027   003237 702000 2                  TSX2    BANNERTEXT_ALT
         2 002030   002033 710000 2                  TRA     s:13620

      636    13615
      637    13616    4             CASE(%DREGISTERNAMEOPT#) ;

      638    13617    4               CALL LIST_REGISTERNAME ALTRET(BANNERTEXT_ALT) ;

  13617  2 002031   004520 701000 2                  TSX1    LIST_REGISTERNAME
         2 002032   003237 702000 2                  TSX2    BANNERTEXT_ALT

      639    13618
      640    13619    4           END ; /* Do Case */

      641    13620    3           CALL REOPEN_CS ;

  13620  2 002033   004724 701000 2                  TSX1    REOPEN_CS
         2 002034   000000 011000                    NOP     0

      642    13621    3           RETURN ;

  13621  2 002035   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 002036   000001 702211                    TSX2  ! 1,X1

      643    13622    3         END ; /* Then Do */
      644    13623    2     IF BLK$->P$B.CODE ~= LETCMND AND BLK$->P$B.CODE ~= DVARIABLESOPT
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:113  

  13623  2 002037   000042 100003                    CMPX0   34,DU
         2 002040   002060 600000 2                  TZE     s:13637
         2 002041   000023 100003                    CMPX0   19,DU
         2 002042   002060 600000 2                  TZE     s:13637

      645    13624    2       THEN
      646    13625    3         DO ;

      647    13626    3           PERM = %YES# ;

  13626  2 002043   400000 236003                    LDQ     -131072,DU
         2 002044   200676 756100                    STQ     PERM,,AUTO

      648    13627    3           CALL LIST_REGISTERNAME ALTRET(BANNERTEXT_ALT) ;

  13627  2 002045   004520 701000 2                  TSX1    LIST_REGISTERNAME
         2 002046   003237 702000 2                  TSX2    BANNERTEXT_ALT

      649    13628    3           CALL LIST_BANNERTEXT ALTRET(BANNERTEXT_ALT) ;

  13628  2 002047   004510 701000 2                  TSX1    LIST_BANNERTEXT
         2 002050   003237 702000 2                  TSX2    BANNERTEXT_ALT

      650    13629    3           PERM = %NO# ;

  13629  2 002051   200676 450100                    STZ     PERM,,AUTO

      651    13630    3           CALL LIST_REGISTERNAME ALTRET(BANNERTEXT_ALT) ;

  13630  2 002052   004520 701000 2                  TSX1    LIST_REGISTERNAME
         2 002053   003237 702000 2                  TSX2    BANNERTEXT_ALT

      652    13631    3           CALL LIST_BANNERTEXT ALTRET(BANNERTEXT_ALT) ;

  13631  2 002054   004510 701000 2                  TSX1    LIST_BANNERTEXT
         2 002055   003237 702000 2                  TSX2    BANNERTEXT_ALT
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:114  

      653    13632    3           CALL REOPEN_CS ;

  13632  2 002056   004724 701000 2                  TSX1    REOPEN_CS
         2 002057   000000 011000                    NOP     0

      654    13633    3         END ; /* Then Do */

      655    13634        /*
      656    13635             ***** Init FPTs and flags ...
      657    13636        */
      658    13637    2     FPT_PRECORD = CFPT_PRECORD;

  13637  2 002060   000100 100400                    MLR     fill='000'O
         2 002061   000000 000050 xsym               ADSC9   CFPT_PRECORD             cn=0,n=40
         2 002062   200054 000050                    ADSC9   FPT_PRECORD,,AUTO        cn=0,n=40

      659    13638    2     FPT_PRECORD.V_ = VECTOR(FPT_PRECORD.V);

  13638  2 002063   000025 235000 3                  LDA     21
         2 002064   200722 452500                    STP2    @DCB#+1,,AUTO
         2 002065   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 002066   000062 036003                    ADLQ    50,DU
         2 002067   200054 757100                    STAQ    FPT_PRECORD,,AUTO

      660    13639    2     FPT_PRECORD.KEY_ = VECTOR(FKEY);

  13639  2 002070   000026 237000 3                  LDAQ    22
         2 002071   200056 757100                    STAQ    FPT_PRECORD+2,,AUTO

      661    13640    2     FPT_PRECORD.V.DCB# = M$IBEX1_NUM;

  13640  2 002072   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002073   200062 740100                    STX0    FPT_PRECORD+6,,AUTO

      662    13641    2     FPT_PRECORD.V.KEYS# = %YES#;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:115  
  13641  2 002074   400000 236007                    LDQ     -131072,DL
         2 002075   200062 256100                    ORSQ    FPT_PRECORD+6,,AUTO

      663    13642        /**/
      664    13643    2     FPT_READ = CFPT_READ;

  13643  2 002076   000100 100400                    MLR     fill='000'O
         2 002077   000000 000070 xsym               ADSC9   CFPT_READ                cn=0,n=56
         2 002100   200066 000070                    ADSC9   FPT_READ,,AUTO           cn=0,n=56

      665    13644    2     FPT_READ.V_ = VECTOR(FPT_READ.V);

  13644  2 002101   000030 235000 3                  LDA     24
         2 002102   200722 452500                    STP2    @DCB#+1,,AUTO
         2 002103   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 002104   000076 036003                    ADLQ    62,DU
         2 002105   200066 757100                    STAQ    FPT_READ,,AUTO

      666    13645    2     FPT_READ.V.DCB# = M$IBEX1_NUM;

  13645  2 002106   200076 740100                    STX0    FPT_READ+8,,AUTO

      667    13646    2     FPT_READ.V.KEYR# = %YES#;

  13646  2 002107   100000 236007                    LDQ     32768,DL
         2 002110   200076 256100                    ORSQ    FPT_READ+8,,AUTO

      668    13647    2     FPT_READ.KEY_ = VECTOR(KEY);

  13647  2 002111   000031 235000 3                  LDA     25
         2 002112   200722 452500                    STP2    @DCB#+1,,AUTO
         2 002113   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 002114   000130 036003                    ADLQ    88,DU
         2 002115   200070 757100                    STAQ    FPT_READ+2,,AUTO

      669    13648    2     FPT_READ.BUF_ = VECTOR(TEMPBUF);

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:116  
  13648  2 002116   000032 235000 3                  LDA     26
         2 002117   200722 452500                    STP2    @DCB#+1,,AUTO
         2 002120   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 002121   000243 036003                    ADLQ    163,DU
         2 002122   200072 757100                    STAQ    FPT_READ+4,,AUTO

      670    13649        /**/
      671    13650    2     SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_ = VECTOR(WRITEBUF);

  13650  2 002123   000000 470400 xsym               LDP0    SEG2$
         2 002124   000161 471500                    LDP1    113,,PR0
         2 002125   000002 235000 3                  LDA     2
         2 002126   200722 452500                    STP2    @DCB#+1,,AUTO
         2 002127   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 002130   000443 036003                    ADLQ    291,DU
         2 002131   100004 757100                    STAQ    4,,PR1

      672    13651    2     PRINT_HDR# = %NO#;   /* HDR not yet printed */

  13651  2 002132   200674 450100                    STZ     PRINT_HDR#,,AUTO

      673    13652        /*
      674    13653             ***** Position to first COMMAND VARIABLE ...
      675    13654        */
      676    13655    2     CALL M$PRECORD (FPT_PRECORD)

  13655  2 002133   200054 630500                    EPPR0   FPT_PRECORD,,AUTO
         2 002134   440003 713400                    CLIMB   alt,+16387
         2 002135   401000 401760                    pmme    nvectors=3
         2 002136   002140 702000 2                  TSX2    s:13657
         2 002137   002146 710000 2                  TRA     s:13664

      677    13656    3     WHENALTRETURN DO; /* If E$NOKEY then success, else ABORT!!! */

      678    13657    3        IF B$TCB.ALT$ -> B$ALT.ERR.CODE ~= %E$NOKEY

  13657  2 002140   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:117  
         2 002141   000000 471500                    LDP1    0,,PR0
         2 002142   100102 236100                    LDQ     66,,PR1
         2 002143   377770 376007                    ANQ     131064,DL
         2 002144   001020 116007                    CMPQ    528,DL
         2 002145   003214 601000 2                  TNZ     E_PMME

      679    13658    3           THEN
      680    13659    3              GOTO E_PMME;
      681    13660    3     END;

      682    13661        /*
      683    13662             ***** Read, format and print all COMMAND VARIABLES ...
      684    13663        */
      685    13664    2     WILD_VAR$ = ADDR(NIL);

  13664  2 002146   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002147   200230 756100                    STQ     WILD_VAR$,,AUTO

      686    13665    2     IF (BLK$->P$B.CODE = DVARIABLESOPT) AND (BLK$->P$B.NSUBLKS > 0)

  13665  2 002150   200236 470500                    LDP0    BLK$,,AUTO
         2 002151   000000 720100                    LXL0    0,,PR0
         2 002152   000023 100003                    CMPX0   19,DU
         2 002153   002161 601000 2                  TNZ     s:13668
         2 002154   000001 221100                    LDX1    1,,PR0
         2 002155   002161 600000 2                  TZE     s:13668

      687    13666    2       THEN WILD_VAR$ = BLK$ -> P$B.SUBLK$(0) -> P$S.TEXTC$;

  13666  2 002156   000003 471500                    LDP1    3,,PR0
         2 002157   100003 236100                    LDQ     3,,PR1
         2 002160   200230 756100                    STQ     WILD_VAR$,,AUTO

      688    13667    3     DO WHILE (%YES#);

      689    13668    4        CALL M$READ (FPT_READ) WHENALTRETURN DO; END;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:118  
  13668  2 002161   200066 630500                    EPPR0   FPT_READ,,AUTO
         2 002162   440000 713400                    CLIMB   alt,read
         2 002163   401400 401760                    pmme    nvectors=4
         2 002164   002166 702000 2                  TSX2    s:13669
         2 002165   002166 710000 2                  TRA     s:13669

      690    13669    3        IF KEY.L < LENGTHC('VAR_')

  13669  2 002166   200130 236100                    LDQ     KEY,,AUTO
         2 002167   777000 376003                    ANQ     -512,DU
         2 002170   004000 116003                    CMPQ    2048,DU
         2 002171   002176 602000 2                  TNC     LIST_RETURN
         2 002172   040000 106500                    CMPC    fill='040'O
         2 002173   200130 200004                    ADSC9   KEY,,AUTO                cn=1,n=4
         2 002174   000103 000004 1                  ADSC9   E_NOWHEN+9               cn=0,n=4
         2 002175   002222 600000 2                  TZE     s:13686

      691    13670    3        OR SUBSTR(KEY.N,0,4) ~= 'VAR_'
      692    13671    3           THEN   /* Reached the end */
      693    13672    4              DO;

      694    13673    4   LIST_RETURN:
      695    13674    4                 IF PRINT_HDR# = %NO#

  13674  2 002176   200674 234100       LIST_RETURN  SZN     PRINT_HDR#,,AUTO
         2 002177   002220 604000 2                  TMI     s:13681

      696    13675    4                    THEN   /* No HDR printed yet. Thus no COMMAND VARIABLES */
      697    13676    5                       DO;

      698    13677    5                          WRITEBUF = '   Command Variables: None';

  13677  2 002200   040100 100400                    MLR     fill='040'O
         2 002201   000104 000032 1                  ADSC9   E_NOWHEN+10              cn=0,n=26
         2 002202   200443 001054                    ADSC9   WRITEBUF,,AUTO           cn=0,n=556

      699    13678    5                          SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = 25;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:119  

  13678  2 002203   000000 470400 xsym               LDP0    SEG2$
         2 002204   000161 471500                    LDP1    113,,PR0
         2 002205   100004 236100                    LDQ     4,,PR1
         2 002206   177777 376007                    ANQ     65535,DL
         2 002207   000033 276000 3                  ORQ     27
         2 002210   100004 756100                    STQ     4,,PR1

      700    13679    5                          CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$);

  13679  2 002211   000000 236000 xsym               LDQ     SEG2$
         2 002212   000161 036003                    ADLQ    113,DU
         2 002213   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002214   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002215   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002216   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002217   000000 011000                    NOP     0

      701    13680    5                       END;

      702    13681    4                 RETURN;

  13681  2 002220   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 002221   000001 702211                    TSX2  ! 1,X1

      703    13682    4              END;
      704    13683        /*
      705    13684             ***** Print the COMMAND VARIABLE ...
      706    13685        */
      707    13686    3        KEY_VAR.L = KEY.L - 4;

  13686  2 002222   200130 236100                    LDQ     KEY,,AUTO
         2 002223   000033 772000                    QRL     27
         2 002224   000004 136007                    SBLQ    4,DL
         2 002225   000033 736000                    QLS     27
         2 002226   200141 552140                    STBQ    KEY_VAR,'40'O,AUTO

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:120  
      708    13687    3        KEY_VAR.N = SUBSTR (KEY.N, 4);

  13687  2 002227   040100 100500                    MLR     fill='040'O
         2 002230   200131 200037                    ADSC9   KEY+1,,AUTO              cn=1,n=31
         2 002231   200141 200037                    ADSC9   KEY_VAR,,AUTO            cn=1,n=31

      709    13688    3        CALL CPB$WILDCMPR (KEY_VAR, WILD_VAR)

  13688  2 002232   200230 236100                    LDQ     WILD_VAR$,,AUTO
         2 002233   200723 756100                    STQ     @DCB#+2,,AUTO
         2 002234   200141 630500                    EPPR0   KEY_VAR,,AUTO
         2 002235   200722 450500                    STP0    @DCB#+1,,AUTO
         2 002236   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002237   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002240   000000 701000 xent               TSX1    CPB$WILDCMPR
         2 002241   002367 702000 2                  TSX2    s:13705

      710    13689    4        WHENRETURN DO;

      711    13690    4          IF PRINT_HDR# = %NO#

  13690  2 002242   200674 234100                    SZN     PRINT_HDR#,,AUTO
         2 002243   002266 604000 2                  TMI     s:13698

      712    13691    4             THEN   /* Print the header first */
      713    13692    5                DO;

      714    13693    5                   PRINT_HDR# = %YES#;

  13693  2 002244   400000 236003                    LDQ     -131072,DU
         2 002245   200674 756100                    STQ     PRINT_HDR#,,AUTO

      715    13694    5                   WRITEBUF = '   Command Variables:';

  13694  2 002246   040100 100400                    MLR     fill='040'O
         2 002247   000104 000025 1                  ADSC9   E_NOWHEN+10              cn=0,n=21
         2 002250   200443 001054                    ADSC9   WRITEBUF,,AUTO           cn=0,n=556
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:121  

      716    13695    5                   SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = 20;

  13695  2 002251   000000 470400 xsym               LDP0    SEG2$
         2 002252   000161 471500                    LDP1    113,,PR0
         2 002253   100004 236100                    LDQ     4,,PR1
         2 002254   177777 376007                    ANQ     65535,DL
         2 002255   000005 276003                    ORQ     5,DU
         2 002256   100004 756100                    STQ     4,,PR1

      717    13696    5                   CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$);

  13696  2 002257   000000 236000 xsym               LDQ     SEG2$
         2 002260   000161 036003                    ADLQ    113,DU
         2 002261   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002262   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002264   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002265   000000 011000                    NOP     0

      718    13697    5                END;

      719    13698    4          CALL CONCAT (WRITEBUF,'      ',SUBSTR(KEY_VAR.N,0,KEY_VAR.L),

  13698  2 002266   200141 236100                    LDQ     KEY_VAR,,AUTO
         2 002267   000033 772000                    QRL     27
         2 002270   000010 470400 3                  LDP0    8
         2 002271   000000 471500                    LDP1    0,,PR0
         2 002272   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002273   100000 473510                    LDP3    0,X0,PR1
         2 002274   300000 721100                    LXL1    0,,PR3
         2 002275   040100 100400                    MLR     fill='040'O
         2 002276   000113 000006 1                  ADSC9   E_NOWHEN+17              cn=0,n=6
         2 002277   200443 000006                    ADSC9   WRITEBUF,,AUTO           cn=0,n=6
         2 002300   000000 622006                    EAX2    0,QL
         2 002301   040100 100540                    MLR     fill='040'O
         2 002302   200141 200012                    ADSC9   KEY_VAR,,AUTO            cn=1,n=*X2
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:122  
         2 002303   200444 401046                    ADSC9   WRITEBUF+1,,AUTO         cn=2,n=550
         2 002304   001046 116007                    CMPQ    550,DL
         2 002305   002346 603000 2                  TRC     s:13701
         2 002306   776731 622006                    EAX2    -551,QL
         2 002307   777777 662003                    ERX2    -1,DU
         2 002310   040146 100400                    MLR     fill='040'O
         2 002311   000115 000004 1                  ADSC9   E_NOWHEN+19              cn=0,n=4
         2 002312   200444 400012                    ADSC9   WRITEBUF+1,Q,AUTO        cn=2,n=*X2
         2 002313   001042 116007                    CMPQ    546,DL
         2 002314   002346 603000 2                  TRC     s:13701
         2 002315   776735 622006                    EAX2    -547,QL
         2 002316   777777 662003                    ERX2    -1,DU
         2 002317   040146 100540                    MLR     fill='040'O
         2 002320   200243 000011                    ADSC9   TEMPBUF,,AUTO            cn=0,n=*X1
         2 002321   200445 400012                    ADSC9   WRITEBUF+2,Q,AUTO        cn=2,n=*X2
         2 002322   000000 635011                    EAA     0,X1
         2 002323   000022 771000                    ARL     18
         2 002324   200722 755100                    STA     @DCB#+1,,AUTO
         2 002325   000000 622006                    EAX2    0,QL
         2 002326   200722 036100                    ADLQ    @DCB#+1,,AUTO
         2 002327   001042 116007                    CMPQ    546,DL
         2 002330   002346 603000 2                  TRC     s:13701
         2 002331   000000 635011                    EAA     0,X1
         2 002332   000022 771000                    ARL     18
         2 002333   200723 755100                    STA     @DCB#+2,,AUTO
         2 002334   200724 756100                    STQ     @DCB#+3,,AUTO
         2 002335   000000 636012                    EAQ     0,X2
         2 002336   000022 772000                    QRL     18
         2 002337   200723 036100                    ADLQ    @DCB#+2,,AUTO
         2 002340   200724 721100                    LXL1    @DCB#+3,,AUTO
         2 002341   776735 621011                    EAX1    -547,X1
         2 002342   777777 661003                    ERX1    -1,DU
         2 002343   040146 100400                    MLR     fill='040'O
         2 002344   000034 000001 3                  ADSC9   28                       cn=0,n=1
         2 002345   200445 400011                    ADSC9   WRITEBUF+2,Q,AUTO        cn=2,n=*X1

      720    13699    4               ' = ''',SUBSTR(TEMPBUF,0,DCBADDR(M$IBEX1_NUM)->F$DCB.ARS#),
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:123  
      721    13700    4               '''');
      722    13701    4          SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = (KEY.L-4) +

  13701  2 002346   000000 474400 xsym               LDP4    SEG2$
         2 002347   400161 475500                    LDP5    113,,PR4
         2 002350   200130 236100                    LDQ     KEY,,AUTO
         2 002351   000033 772000                    QRL     27
         2 002352   300000 036100                    ADLQ    0,,PR3
         2 002353   000007 036007                    ADLQ    7,DL
         2 002354   000020 736000                    QLS     16
         2 002355   500004 676100                    ERQ     4,,PR5
         2 002356   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002357   500004 656100                    ERSQ    4,,PR5

      723    13702    4                DCBADDR(M$IBEX1_NUM) -> F$DCB.ARS# + 11;
      724    13703    4          CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$);

  13703  2 002360   000000 236000 xsym               LDQ     SEG2$
         2 002361   000161 036003                    ADLQ    113,DU
         2 002362   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002363   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002364   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002365   000000 701000 xent               TSX1    CPE$LISTOUT
         2 002366   000000 011000                    NOP     0

      725    13704    4        END;

      726    13705    3     END;   /* Do while ... end */

  13705  2 002367   002161 710000 2                  TRA     s:13668

      727    13706        /*
      728    13707             ***** Delete COMMAND VARIABLES ...
      729    13708        */
      730    13709    2   LET_DELETE:
      731    13710    2     NAME$ = BLK$ -> P$B.SUBLK$(0);

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:124  
  13710  2 002370   000003 236100       LET_DELETE   LDQ     3,,PR0
         2 002371   200237 756100                    STQ     NAME$,,AUTO

      732    13711    2     CALL CPC$OPEN_S (M$IBEX1_NUM) ALTRET(E_PMME);

  13711  2 002372   000000 630400 3                  EPPR0   0
         2 002373   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002374   000000 701000 xent               TSX1    CPC$OPEN_S
         2 002375   003214 702000 2                  TSX2    E_PMME

      733    13712        /*
      734    13713             ***** Init FPT_DELREC ...
      735    13714        */
      736    13715    2     FPT_DELREC = CFPT_DELREC;

  13715  2 002376   000100 100400                    MLR     fill='000'O
         2 002377   000000 000050 xsym               ADSC9   CFPT_DELREC              cn=0,n=40
         2 002400   200042 000050                    ADSC9   FPT_DELREC,,AUTO         cn=0,n=40

      737    13716    2     FPT_DELREC.V_ = VECTOR(FPT_DELREC.V);

  13716  2 002401   000001 235000 3                  LDA     1
         2 002402   200722 452500                    STP2    @DCB#+1,,AUTO
         2 002403   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 002404   000052 036003                    ADLQ    42,DU
         2 002405   200042 757100                    STAQ    FPT_DELREC,,AUTO

      738    13717    2     FPT_DELREC.V.DCB# = M$IBEX1_NUM;

  13717  2 002406   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 002407   200052 740100                    STX0    FPT_DELREC+8,,AUTO

      739    13718    2     FPT_DELREC.KEY_ = VECTOR(KEY);

  13718  2 002410   000031 235000 3                  LDA     25
         2 002411   200722 452500                    STP2    @DCB#+1,,AUTO
         2 002412   200722 236100                    LDQ     @DCB#+1,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:125  
         2 002413   000130 036003                    ADLQ    88,DU
         2 002414   200044 757100                    STAQ    FPT_DELREC+2,,AUTO

      740    13719        /*
      741    13720             ***** Determine whether to delete all or
      742    13721                   just part of the COMMAND VARIABLES ...
      743    13722        */
      744    13723    2     IF NAME$ -> P$B.NSUBLKS > 0

  13723  2 002415   200237 470500                    LDP0    NAME$,,AUTO
         2 002416   000001 221100                    LDX1    1,,PR0
         2 002417   002505 600000 2                  TZE     s:13740

      745    13724    2        THEN   /* List of VARIABLES specified */
      746    13725    3           DO INDX1 = 0 TO NAME$ -> P$B.NSUBLKS - 1;

  13725  2 002420   200660 450100                    STZ     INDX1,,AUTO
         2 002421   002476 710000 2                  TRA     s:13737+3

      747    13726    3              KEY.L = NAME$ -> P$B.SUBLK$(INDX1) -> P$S.COUNT + SIZEC('VAR_');

  13726  2 002422   200237 470500                    LDP0    NAME$,,AUTO
         2 002423   200660 720100                    LXL0    INDX1,,AUTO
         2 002424   000003 471510                    LDP1    3,X0,PR0
         2 002425   100004 236100                    LDQ     4,,PR1
         2 002426   000033 772000                    QRL     27
         2 002427   000004 036007                    ADLQ    4,DL
         2 002430   000033 736000                    QLS     27
         2 002431   200130 552140                    STBQ    KEY,'40'O,AUTO

      748    13727    3              CALL CONCAT (KEY.N,'VAR_',NAME$ -> P$B.SUBLK$(INDX1) -> P$S.TEXT);

  13727  2 002432   000003 471510                    LDP1    3,X0,PR0
         2 002433   100004 236100                    LDQ     4,,PR1
         2 002434   000033 772000                    QRL     27
         2 002435   040100 100400                    MLR     fill='040'O
         2 002436   000103 000004 1                  ADSC9   E_NOWHEN+9               cn=0,n=4
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:126  
         2 002437   200130 200004                    ADSC9   KEY,,AUTO                cn=1,n=4
         2 002440   000000 621006                    EAX1    0,QL
         2 002441   040100 100540                    MLR     fill='040'O
         2 002442   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 002443   200131 200037                    ADSC9   KEY+1,,AUTO              cn=1,n=31

      749    13728    3              CALL M$DELREC (FPT_DELREC) ALTRET(MS_COMVAR);

  13728  2 002444   200042 630500                    EPPR0   FPT_DELREC,,AUTO
         2 002445   440002 713400                    CLIMB   alt,+16386
         2 002446   401400 401760                    pmme    nvectors=4
         2 002447   002451 702000 2                  TSX2    MS_COMVAR

      750    13729    4              DO WHILE (%NO#);

  13729  2 002450   002473 710000 2                  TRA     s:13737

      751    13730        /*E*    ERROR: CPG-E$MSCOMVAR-0
      752    13731                MESSAGE: That COMMAND VARIABLE doesn't exist.
      753    13732        */
      754    13733    4   MS_COMVAR:
      755    13734    4                 CPOS = NAME$ -> P$B.SUBLK$(INDX1) -> P$B.CPOS;

  13734  2 002451   200237 470500       MS_COMVAR    LDP0    NAME$,,AUTO
         2 002452   200660 720100                    LXL0    INDX1,,AUTO
         2 002453   000003 471510                    LDP1    3,X0,PR0
         2 002454   100002 235100                    LDA     2,,PR1
         2 002455   200663 755100                    STA     CPOS,,AUTO

      756    13735    4                 CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_MSCOMVAR);

  13735  2 002456   000000 236000 xsym               LDQ     SEG2$
         2 002457   000003 036003                    ADLQ    3,DU
         2 002460   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002461   000035 236000 3                  LDQ     29
         2 002462   200725 756100                    STQ     @DCB#+4,,AUTO
         2 002463   200663 631500                    EPPR1   CPOS,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:127  
         2 002464   200724 451500                    STP1    @DCB#+3,,AUTO
         2 002465   200722 633500                    EPPR3   @DCB#+1,,AUTO
         2 002466   200723 453500                    STP3    @DCB#+2,,AUTO
         2 002467   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 002470   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002471   000000 701000 xent               TSX1    CXP$POSTERR
         2 002472   000000 011000                    NOP     0

      757    13736    4              END;

      758    13737    3           END;   /* Delete only those in list */

  13737  2 002473   200660 235100                    LDA     INDX1,,AUTO
         2 002474   000001 035007                    ADLA    1,DL
         2 002475   200660 755100                    STA     INDX1,,AUTO
         2 002476   200237 470500                    LDP0    NAME$,,AUTO
         2 002477   000001 236100                    LDQ     1,,PR0
         2 002500   000022 772000                    QRL     18
         2 002501   200660 116100                    CMPQ    INDX1,,AUTO
         2 002502   002504 600000 2                  TZE     s:13737+9
         2 002503   002422 603000 2                  TRC     s:13726
         2 002504   002515 710000 2                  TRA     s:13744

      759    13738    2        ELSE   /* Delete all COMMAND VARIABLES */
      760    13739    3           DO;

      761    13740    3              FPT_DELREC.LKEY_ = VECTOR(LKEY);

  13740  2 002505   000036 237000 3                  LDAQ    30
         2 002506   200046 757100                    STAQ    FPT_DELREC+4,,AUTO

      762    13741    3              FPT_DELREC.KEY_ = VECTOR(FKEY);

  13741  2 002507   000026 237000 3                  LDAQ    22
         2 002510   200044 757100                    STAQ    FPT_DELREC+2,,AUTO

      763    13742    3              CALL M$DELREC (FPT_DELREC) ALTRET(E_PMME);
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:128  

  13742  2 002511   200042 630500                    EPPR0   FPT_DELREC,,AUTO
         2 002512   440002 713400                    CLIMB   alt,+16386
         2 002513   401400 401760                    pmme    nvectors=4
         2 002514   003214 702000 2                  TSX2    E_PMME

      764    13743    3           END;

      765    13744    2     IF SEG$2.ERRBUF(1) ~= 0

  13744  2 002515   000000 470400 xsym               LDP0    SEG2$
         2 002516   000004 235100                    LDA     4,,PR0
         2 002517   002522 600000 2                  TZE     s:13748

      766    13745    2        THEN   /* Errors */
      767    13746    2           ALTRETURN;

  13746  2 002520   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 002521   000000 702211                    TSX2  ! 0,X1

      768    13747    2        ELSE
      769    13748    2           RETURN;

  13748  2 002522   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 002523   000001 702211                    TSX2  ! 1,X1

      770    13749        /*
      771    13750             ***** Setup the BANNERTEXT ...
      772    13751        */
      773    13752    2   LET_BANNERTEXT:
      774    13753    2     CALL CPC$OPEN_S(M$IBEX1_NUM) ALTRET (E_BANNER_ROUTINE) ;

  13753  2 002524   000000 630400 3     LET_BANNERT* EPPR0   0
         2 002525   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002526   000000 701000 xent               TSX1    CPC$OPEN_S
         2 002527   003156 702000 2                  TSX2    E_BANNER_ROUTINE

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:129  
      775    13754    2     BLK$ = BLK$ -> P$B.SUBLK$(0) ;

  13754  2 002530   200236 470500                    LDP0    BLK$,,AUTO
         2 002531   000003 236100                    LDQ     3,,PR0
         2 002532   200236 756100                    STQ     BLK$,,AUTO

      776    13755    2     TXT# = BLK$ -> P$B.SUBLK$(0) -> P$B.CODE ;

  13755  2 002533   200236 470500                    LDP0    BLK$,,AUTO
         2 002534   000003 471500                    LDP1    3,,PR0
         2 002535   100000 236100                    LDQ     0,,PR1
         2 002536   777777 376007                    ANQ     -1,DL
         2 002537   200664 756100                    STQ     TXT#,,AUTO

      777    13756    2     IF TXT# = %BANNERTEXT_RESET#

  13756  2 002540   000024 116007                    CMPQ    20,DL
         2 002541   002607 601000 2                  TNZ     s:13772

      778    13757    2       THEN
      779    13758    3         DO ;

      780    13759    3           CALL GET_BANNER_USERS ALTRET(BANNERTEXT_ALT) ;

  13759  2 002542   004054 701000 2                  TSX1    GET_BANNER_USERS
         2 002543   003237 702000 2                  TSX2    BANNERTEXT_ALT

      781    13760    3           CALL ALA$BANNER2_STAR_S(SEG$2.USERS$, M$IBEX1_NUM, B$JIT.USRERR)
             13760                    WHENALTRETURN

  13760  2 002544   000000 236000 xsym               LDQ     B$JIT$
         2 002545   000144 036003                    ADLQ    100,DU
         2 002546   200724 756100                    STQ     @DCB#+3,,AUTO
         2 002547   000000 236000 3                  LDQ     0
         2 002550   200723 756100                    STQ     @DCB#+2,,AUTO
         2 002551   000000 236000 xsym               LDQ     SEG2$
         2 002552   000152 036003                    ADLQ    106,DU
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:130  
         2 002553   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002554   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002555   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002556   000000 701000 xent               TSX1    ALA$BANNER2_STAR_S
         2 002557   002561 702000 2                  TSX2    s:13762
         2 002560   002577 710000 2                  TRA     s:13765

      782    13761    4                   DO ;

      783    13762    4                     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511, B$JIT.USRERR) ;

  13762  2 002561   000000 236000 xsym               LDQ     SEG2$
         2 002562   000003 036003                    ADLQ    3,DU
         2 002563   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002564   000000 236000 xsym               LDQ     B$JIT$
         2 002565   000144 036003                    ADLQ    100,DU
         2 002566   000006 235000 3                  LDA     6
         2 002567   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 002570   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002571   200723 450500                    STP0    @DCB#+2,,AUTO
         2 002572   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 002573   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002574   000000 701000 xent               TSX1    CXP$POSTERR
         2 002575   000000 011000                    NOP     0

      784    13763    4                     GOTO CLOSE_BOTH_DCB_ALT ;

  13763  2 002576   003240 710000 2                  TRA     CLOSE_BOTH_DCB_ALT

      785    13764    4                   END ; /* Whenaltreturn Do */
      786    13765    3           CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;

  13765  2 002577   000000 236000 3                  LDQ     0
         2 002600   200721 756100                    STQ     TEMP$+1,,AUTO
         2 002601   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 002602   000000 011000                    NOP     0

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:131  
      787    13766    3           CALL REOPEN_CS ;

  13766  2 002603   004724 701000 2                  TSX1    REOPEN_CS
         2 002604   000000 011000                    NOP     0

      788    13767    3           RETURN ;

  13767  2 002605   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 002606   000001 702211                    TSX2  ! 1,X1

      789    13768    3         END ; /* Then Do */
      790    13769        /*
      791    13770             ***** Get the value that is to be stored
      792    13771        */
      793    13772    2     TXT$ = ADDR(NIL_TXTC);

  13772  2 002607   000040 236000 3                  LDQ     32
         2 002610   200240 756100                    STQ     TXT$,,AUTO

      794    13773    2     IF BLK$ -> P$B.NSUBLKS > 1   /* a BANNERTEXT expression exists */

  13773  2 002611   000001 220100                    LDX0    1,,PR0
         2 002612   000002 100003                    CMPX0   2,DU
         2 002613   002634 602000 2                  TNC     s:13781

      795    13774    3       THEN DO;

      796    13775    3         XUE_ECB.TREE$ = BLK$ -> P$B.SUBLK$(1);

  13775  2 002614   000004 236100                    LDQ     4,,PR0
         2 002615   200154 756100                    STQ     XUE_ECB,,AUTO

      797    13776    3         SEG$2.FLAGS.USE_REMEM = %YES#;

  13776  2 002616   000000 471400 xsym               LDP1    SEG2$
         2 002617   000020 236003                    LDQ     16,DU
         2 002620   100000 256100                    ORSQ    0,,PR1
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:132  

      798    13777    3         CALL X$EVAL (XUE_ECB) ALTRET (E_LET);

  13777  2 002621   200154 633500                    EPPR3   XUE_ECB,,AUTO
         2 002622   200722 453500                    STP3    @DCB#+1,,AUTO
         2 002623   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002624   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002625   000000 701000 xent               TSX1    X$EVAL
         2 002626   003277 702000 2                  TSX2    E_LET

      799    13778    3         SEG$2.FLAGS.USE_REMEM = %NO#;

  13778  2 002627   000000 470400 xsym               LDP0    SEG2$
         2 002630   000021 236000 3                  LDQ     17
         2 002631   000000 356100                    ANSQ    0,,PR0

      800    13779    3         TXT$ = XUE_ECB.OUT$;

  13779  2 002632   200160 236100                    LDQ     XUE_ECB+4,,AUTO
         2 002633   200240 756100                    STQ     TXT$,,AUTO

      801    13780    3       END;  /* then do */

      802    13781    2     PERM = %NO# ;

  13781  2 002634   200676 450100                    STZ     PERM,,AUTO

      803    13782    2     IF BLK$ -> P$B.NSUBLKS > 2

  13782  2 002635   200236 470500                    LDP0    BLK$,,AUTO
         2 002636   000001 220100                    LDX0    1,,PR0
         2 002637   000003 100003                    CMPX0   3,DU
         2 002640   002646 602000 2                  TNC     s:13787

      804    13783    2       THEN
      805    13784    2         IF BLK$ -> P$B.SUBLK$(2) -> P$B.CODE = %BANNERTEXT_PERM#

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:133  
  13784  2 002641   000005 471500                    LDP1    5,,PR0
         2 002642   100000 721100                    LXL1    0,,PR1
         2 002643   002646 601000 2                  TNZ     s:13787

      806    13785    2           THEN
      807    13786    2             PERM = %YES# ;

  13786  2 002644   400000 236003                    LDQ     -131072,DU
         2 002645   200676 756100                    STQ     PERM,,AUTO

      808    13787    2     IF TXT# = 0

  13787  2 002646   200664 235100                    LDA     TXT#,,AUTO
         2 002647   002664 601000 2                  TNZ     s:13800

      809    13788    2       THEN
      810    13789    3         DO ;

      811    13790    3           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511, E_BADBANNERTEXT0) ;

  13790  2 002650   000000 236000 xsym               LDQ     SEG2$
         2 002651   000003 036003                    ADLQ    3,DU
         2 002652   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002653   000042 237000 3                  LDAQ    34
         2 002654   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 002655   200722 631500                    EPPR1   @DCB#+1,,AUTO
         2 002656   200723 451500                    STP1    @DCB#+2,,AUTO
         2 002657   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 002660   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002661   000000 701000 xent               TSX1    CXP$POSTERR
         2 002662   000000 011000                    NOP     0

      812    13791    3           GOTO BANNERTEXT_ALT ;

  13791  2 002663   003237 710000 2                  TRA     BANNERTEXT_ALT

      813    13792    3         END ; /* Then Do */
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:134  
      814    13793        /*E*       ERROR: CPG-E$BADBANNERTEXT0-0
      815    13794                   MESSAGE: You can not change your REGISTERED name.
      816    13795                   MESSAGE1: Your REGISTERED name is BANNERTEXT0.
      817    13796                   DESCRIPTION: The user tried to change his REGISTERED name
      818    13797                                (BANNERTEXT0). The user is not allowed to change
      819    13798                                this bannertext.
      820    13799        */
      821    13800    2     IF TXT$C.SIZ > 80

  13800  2 002664   200240 471500                    LDP1    TXT$,,AUTO
         2 002665   000100 101500                    MRL     fill='000'O
         2 002666   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 002667   200722 000004                    ADSC9   @DCB#+1,,AUTO            cn=0,n=4
         2 002670   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 002671   000121 116007                    CMPQ    81,DL
         2 002672   002707 604000 2                  TMI     s:13812

      822    13801    2       THEN
      823    13802    3         DO ;

      824    13803    3           CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF), 511, E_ILLBANNERTEXTLEN) ;

  13803  2 002673   000000 236000 xsym               LDQ     SEG2$
         2 002674   000003 036003                    ADLQ    3,DU
         2 002675   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002676   000044 237000 3                  LDAQ    36
         2 002677   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 002700   200722 633500                    EPPR3   @DCB#+1,,AUTO
         2 002701   200723 453500                    STP3    @DCB#+2,,AUTO
         2 002702   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 002703   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002704   000000 701000 xent               TSX1    CXP$POSTERR
         2 002705   000000 011000                    NOP     0

      825    13804    3           GOTO BANNERTEXT_ALT ;

  13804  2 002706   003237 710000 2                  TRA     BANNERTEXT_ALT
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:135  

      826    13805    3         END ; /* Then Do */
      827    13806        /*E*       ERROR: CPG-E$ILLBANNERTEXTLEN-0
      828    13807                   MESSAGE: BANNERTEXT too long.
      829    13808                   MESSAGE1: The text of a BANNERTEXT can be at most 80 characters long.
      830    13809                   DESCRIPTION: The user tried to input a BANNERTEXT that was
      831    13810                                greater than 80 characters in length.
      832    13811        */
      833    13812    2     CALL GET_BANNER_RECORD ALTRET(BANNERTEXT_ALT) ;

  13812  2 002707   004104 701000 2                  TSX1    GET_BANNER_RECORD
         2 002710   003237 702000 2                  TSX2    BANNERTEXT_ALT

      834    13813    2     IF SEG3$->FS$BANNER.PERM(TXT#)

  13813  2 002711   000000 470400 xsym               LDP0    SEG3$
         2 002712   200664 235100                    LDA     TXT#,,AUTO
         2 002713   000000 066505                    CMPB    filb='0'B
         2 002714   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         2 002715   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 002716   002744 600000 2                  TZE     s:13827

      835    13814    2       THEN
      836    13815    3         DO ;

      837    13816    3           F1_TEXT.CNT = 1 ;

  13816  2 002717   001000 236003                    LDQ     512,DU
         2 002720   200656 552140                    STBQ    F1_TEXT,'40'O,AUTO

      838    13817    3           CALL BINCHAR(F1_TEXT.TXT, TXT#) ;

  13817  2 002721   000044 773000                    LRL     36
         2 002722   200722 757100                    STAQ    @DCB#+1,,AUTO
         2 002723   000100 301500                    BTD
         2 002724   200722 000010                    NDSC9   @DCB#+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         2 002725   200656 230001                    NDSC9   F1_TEXT,,AUTO            cn=1,s=nosgn,sf=0,n=1
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:136  

      839    13818    3           CALL CPC$WRITEMSGE (E_UNALTBANNERTEXT,M$IBEX1_NUM,F1_TEXT,,,%YES#) ;

  13818  2 002726   000017 236000 3                  LDQ     15
         2 002727   000001 235000 xsym               LDA     B_VECTNIL+1
         2 002730   200726 757100                    STAQ    @DCB#+5,,AUTO
         2 002731   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002732   200725 756100                    STQ     @DCB#+4,,AUTO
         2 002733   200656 631500                    EPPR1   F1_TEXT,,AUTO
         2 002734   200724 451500                    STP1    @DCB#+3,,AUTO
         2 002735   000046 237000 3                  LDAQ    38
         2 002736   200722 757100                    STAQ    @DCB#+1,,AUTO
         2 002737   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002740   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 002741   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 002742   000000 011000                    NOP     0

      840    13819    3           GOTO CLOSE_M$IBEX1_ALT ;

  13819  2 002743   003242 710000 2                  TRA     CLOSE_M$IBEX1_ALT

      841    13820    3         END ; /* Then Do */
      842    13821        /*E*       ERROR: CPG-E$UNALTBANNERTEXT-0
      843    13822                   MESSAGE: BANNERTEXT%U1 unalterable.
      844    13823                   MESSAGE1: You are unable to alter the text of a BANNERTEXT%U1.
      845    13824                   DESCRIPTION: The user tried to input text for a BANNERTEXT that
      846    13825                                he was not able to change.
      847    13826        */
      848    13827    2     IF PERM

  13827  2 002744   200676 234100                    SZN     PERM,,AUTO
         2 002745   003002 605000 2                  TPL     s:13838

      849    13828    2       THEN
      850    13829    3         DO ;

      851    13830    3           CALL CLOSE_IBEX_DCB(M$IBEX_NUM) ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:137  

  13830  2 002746   000050 236000 3                  LDQ     40
         2 002747   200721 756100                    STQ     TEMP$+1,,AUTO
         2 002750   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 002751   000000 011000                    NOP     0

      852    13831    3           SEG$2.FLAGS.USERS = %NO# ;

  13831  2 002752   000000 470400 xsym               LDP0    SEG2$
         2 002753   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 002754   000000 356100                    ANSQ    0,,PR0

      853    13832    3           CALL CPC$RDUSERS (M$IBEX_NUM, %UPDATE#) ALTRET(CLOSE_M$IBEX1_ALT) ;

  13832  2 002755   000051 630400 3                  EPPR0   41
         2 002756   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002757   000000 701000 xent               TSX1    CPC$RDUSERS
         2 002760   003242 702000 2                  TSX2    CLOSE_M$IBEX1_ALT

      854    13833    3           CALL ASC$BANNER (SEG$2.USERS$, TXT#, TXT$C) ALTRET (BANNERTEXT_ERR) ;

  13833  2 002761   200240 236100                    LDQ     TXT$,,AUTO
         2 002762   200724 756100                    STQ     @DCB#+3,,AUTO
         2 002763   200664 630500                    EPPR0   TXT#,,AUTO
         2 002764   200723 450500                    STP0    @DCB#+2,,AUTO
         2 002765   000000 236000 xsym               LDQ     SEG2$
         2 002766   000152 036003                    ADLQ    106,DU
         2 002767   200722 756100                    STQ     @DCB#+1,,AUTO
         2 002770   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 002771   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 002772   000000 701000 xent               TSX1    ASC$BANNER
         2 002773   003250 702000 2                  TSX2    BANNERTEXT_ERR

      855    13834    3           CALL CPC$WRUSERS (M$IBEX_NUM) ALTRET(CLOSE_BOTH_DCB_ALT) ;

  13834  2 002774   000050 630400 3                  EPPR0   40
         2 002775   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:138  
         2 002776   000000 701000 xent               TSX1    CPC$WRUSERS
         2 002777   003240 702000 2                  TSX2    CLOSE_BOTH_DCB_ALT

      856    13835    3           CALL REOPEN_CS ;

  13835  2 003000   004724 701000 2                  TSX1    REOPEN_CS
         2 003001   000000 011000                    NOP     0

      857    13836    3         END ; /* Then Do */

      858    13837
      859    13838    2     IF SEG3$->FS$BANNER.TEXT_OFF(TXT#) = -1

  13838  2 003002   200664 236100                    LDQ     TXT#,,AUTO
         2 003003   000022 402007                    MPY     18,DL
         2 003004   000000 470400 xsym               LDP0    SEG3$
         2 003005   003100 060506                    CSL     bolr='003'O
         2 003006   000000 400022                    BDSC    0,Q,PR0                  by=2,bit=0,n=18
         2 003007   200722 000044                    BDSC    @DCB#+1,,AUTO            by=0,bit=0,n=36
         2 003010   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 003011   000022 732000                    QRS     18
         2 003012   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 003013   003075 600000 2                  TZE     NOT_EQUAL

      860    13839    2       THEN
      861    13840    2         GOTO NOT_EQUAL ;
      862    13841    2     ARRY$ = PINCRC(SEG3$, SEG3$->FS$BANNER.TEXT_OFF(TXT#)) ;

  13841  2 003014   200664 236100                    LDQ     TXT#,,AUTO
         2 003015   000022 402007                    MPY     18,DL
         2 003016   003100 060506                    CSL     bolr='003'O
         2 003017   000000 400022                    BDSC    0,Q,PR0                  by=2,bit=0,n=18
         2 003020   200722 000044                    BDSC    @DCB#+1,,AUTO            by=0,bit=0,n=36
         2 003021   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 003022   000022 732000                    QRS     18
         2 003023   000020 736000                    QLS     16
         2 003024   000000 036000 xsym               ADLQ    SEG3$
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:139  
         2 003025   200241 756100                    STQ     ARRY$,,AUTO

      863    13842    2     IF TXT$C.SIZ = ARRY$->TEXT.LENGTH_

  13842  2 003026   200241 471500                    LDP1    ARRY$,,AUTO
         2 003027   000100 101500                    MRL     fill='000'O
         2 003030   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 003031   200722 000004                    ADSC9   @DCB#+1,,AUTO            cn=0,n=4
         2 003032   200240 473500                    LDP3    TXT$,,AUTO
         2 003033   000100 101500                    MRL     fill='000'O
         2 003034   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 003035   200723 000004                    ADSC9   @DCB#+2,,AUTO            cn=0,n=4
         2 003036   200723 236100                    LDQ     @DCB#+2,,AUTO
         2 003037   200722 116100                    CMPQ    @DCB#+1,,AUTO
         2 003040   003075 601000 2                  TNZ     NOT_EQUAL

      864    13843    2       THEN
      865    13844    3         DO ;

      866    13845    3           ARRY$->TEXT.VAL = TXT$C.TEXT ;

  13845  2 003041   000100 101500                    MRL     fill='000'O
         2 003042   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 003043   200722 000002                    ADSC9   @DCB#+1,,AUTO            cn=0,n=2
         2 003044   200722 220100                    LDX0    @DCB#+1,,AUTO
         2 003045   000100 101500                    MRL     fill='000'O
         2 003046   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 003047   200723 000002                    ADSC9   @DCB#+2,,AUTO            cn=0,n=2
         2 003050   200723 221100                    LDX1    @DCB#+2,,AUTO
         2 003051   040140 100540                    MLR     fill='040'O
         2 003052   300000 200011                    ADSC9   0,,PR3                   cn=1,n=*X1
         2 003053   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0

      867    13846    3           ARRY$ = PINCRC(SEG3$, SEG3$->FS$BANNER.TEXT_OFF(TXT#)) ;

  13846  2 003054   200664 236100                    LDQ     TXT#,,AUTO
         2 003055   000022 402007                    MPY     18,DL
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:140  
         2 003056   003100 060506                    CSL     bolr='003'O
         2 003057   000000 400022                    BDSC    0,Q,PR0                  by=2,bit=0,n=18
         2 003060   200722 000044                    BDSC    @DCB#+1,,AUTO            by=0,bit=0,n=36
         2 003061   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 003062   000022 732000                    QRS     18
         2 003063   000020 736000                    QLS     16
         2 003064   000000 036000 xsym               ADLQ    SEG3$
         2 003065   200241 756100                    STQ     ARRY$,,AUTO

      868    13847    3           ARS = DCBADDR(M$IBEX1_NUM) -> F$DCB.ARS# ;

  13847  2 003066   000010 471400 3                  LDP1    8
         2 003067   100000 474500                    LDP4    0,,PR1
         2 003070   000000 720000 xsym               LXL0    M$IBEX1_NUM
         2 003071   400000 475510                    LDP5    0,X0,PR4
         2 003072   500000 235100                    LDA     0,,PR5
         2 003073   200665 755100                    STA     ARS,,AUTO

      869    13848    3         END ; /* Then Do */

  13848  2 003074   003122 710000 2                  TRA     s:13857

      870    13849    2       ELSE
      871    13850    3         DO ;

      872    13851    3   NOT_EQUAL:
      873    13852    3           CALL SEPERATE_BANNER_STAR ;

  13852  2 003075   004154 701000 2     NOT_EQUAL    TSX1    SEPERATE_BANNER_STAR
         2 003076   000000 011000                    NOP     0

      874    13853    3           BANNER$BUF.CNT(TXT#) = TXT$C.SIZ ;

  13853  2 003077   200664 236100                    LDQ     TXT#,,AUTO
         2 003100   000025 402007                    MPY     21,DL
         2 003101   000002 736000                    QLS     2
         2 003102   200240 470500                    LDP0    TXT$,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:141  
         2 003103   200242 471500                    LDP1    BANNER$BUF$,,AUTO
         2 003104   000106 100500                    MLR     fill='000'O
         2 003105   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 003106   100000 000001                    ADSC9   0,Q,PR1                  cn=0,n=1

      875    13854    3           BANNER$BUF.TXT(TXT#) = TXT$C.TEXT ;

  13854  2 003107   000100 101500                    MRL     fill='000'O
         2 003110   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 003111   200722 000002                    ADSC9   @DCB#+1,,AUTO            cn=0,n=2
         2 003112   200722 220100                    LDX0    @DCB#+1,,AUTO
         2 003113   200664 236100                    LDQ     TXT#,,AUTO
         2 003114   000124 402007                    MPY     84,DL
         2 003115   040106 100540                    MLR     fill='040'O
         2 003116   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         2 003117   100000 200120                    ADSC9   0,Q,PR1                  cn=1,n=80

      876    13855    3           CALL REBUILD_BANNER ;

  13855  2 003120   004413 701000 2                  TSX1    REBUILD_BANNER
         2 003121   000000 011000                    NOP     0

      877    13856    3         END ; /* Else Do */

      878    13857    2     BANNER_VEC = VECTOR(SEG3$->STARBANNER$BUF) ;

  13857  2 003122   000053 235000 3                  LDA     43
         2 003123   000000 236000 xsym               LDQ     SEG3$
         2 003124   200234 757100                    STAQ    BANNER_VEC,,AUTO

      879    13858    2     VBOUND(BANNER_VEC) = ARS-1 ;

  13858  2 003125   200665 236100                    LDQ     ARS,,AUTO
         2 003126   000001 136007                    SBLQ    1,DL
         2 003127   000020 736000                    QLS     16
         2 003130   200234 676100                    ERQ     BANNER_VEC,,AUTO
         2 003131   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:142  
         2 003132   200234 656100                    ERSQ    BANNER_VEC,,AUTO

      880    13859    2    CALL CPJ$WRITE_S(M$IBEX1_NUM, VECTOR(KEY), BANNER_VEC) ALTRET(CLOSE_M$IBEX1_ALT) ;

  13859  2 003133   000031 235000 3                  LDA     25
         2 003134   200722 452500                    STP2    @DCB#+1,,AUTO
         2 003135   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 003136   000130 036003                    ADLQ    88,DU
         2 003137   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 003140   200234 630500                    EPPR0   BANNER_VEC,,AUTO
         2 003141   200730 450500                    STP0    @DCB#+7,,AUTO
         2 003142   200724 631500                    EPPR1   @DCB#+3,,AUTO
         2 003143   200727 451500                    STP1    @DCB#+6,,AUTO
         2 003144   000000 236000 3                  LDQ     0
         2 003145   200726 756100                    STQ     @DCB#+5,,AUTO
         2 003146   200726 630500                    EPPR0   @DCB#+5,,AUTO
         2 003147   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 003150   000000 701000 xent               TSX1    CPJ$WRITE_S
         2 003151   003242 702000 2                  TSX2    CLOSE_M$IBEX1_ALT

      881    13860    2     CALL REOPEN_CS ;

  13860  2 003152   004724 701000 2                  TSX1    REOPEN_CS
         2 003153   000000 011000                    NOP     0

      882    13861    2     RETURN ;

  13861  2 003154   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003155   000001 702211                    TSX2  ! 1,X1

      883    13862    2   E_BANNER_ROUTINE:   /* Handle errors from subroutines for BANNERTEXT */
      884    13863    2     CALL CXP$POSTERR(ADDR(SEG$2.ERRBUF),511,B$JIT.USRERR) ;

  13863  2 003156   000000 236000 xsym  E_BANNER_RO* LDQ     SEG2$
         2 003157   000003 036003                    ADLQ    3,DU
         2 003160   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003161   000000 236000 xsym               LDQ     B$JIT$
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:143  
         2 003162   000144 036003                    ADLQ    100,DU
         2 003163   000006 235000 3                  LDA     6
         2 003164   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 003165   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 003166   200723 450500                    STP0    @DCB#+2,,AUTO
         2 003167   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 003170   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 003171   000000 701000 xent               TSX1    CXP$POSTERR
         2 003172   000000 011000                    NOP     0

      885    13864    2     CALL REOPEN_CS ;

  13864  2 003173   004724 701000 2                  TSX1    REOPEN_CS
         2 003174   000000 011000                    NOP     0

      886    13865    2     ALTRETURN;

  13865  2 003175   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003176   000000 702211                    TSX2  ! 0,X1

      887    13866        /**/
      888    13867    2   E_ROUTINE:   /* Handle errors from subroutines */
      889    13868    2     CALL CPC$WRITEMSGE (B$JIT.USRERR,M$IBEX1_NUM);

  13868  2 003177   000000 236000 3     E_ROUTINE    LDQ     0
         2 003200   200723 756100                    STQ     @DCB#+2,,AUTO
         2 003201   000000 236000 xsym               LDQ     B$JIT$
         2 003202   000144 036003                    ADLQ    100,DU
         2 003203   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003204   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 003205   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003206   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 003207   000000 011000                    NOP     0

      890    13869    2     B$JIT.USRERR = '0'O;

  13869  2 003210   000000 470400 xsym               LDP0    B$JIT$
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:144  
         2 003211   000144 450100                    STZ     100,,PR0

      891    13870    2     ALTRETURN;

  13870  2 003212   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003213   000000 702211                    TSX2  ! 0,X1

      892    13871        /**/
      893    13872        /**/
      894    13873    2   E_PMME:   /* Handle errors from PMMEs */
      895    13874    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$ -> B$ALT.ERR,,

  13874  2 003214   000000 470400 xsym  E_PMME       LDP0    B$TCB$
         2 003215   000000 471500                    LDP1    0,,PR0
         2 003216   000000 236000 xsym               LDQ     SEG2$
         2 003217   000003 036003                    ADLQ    3,DU
         2 003220   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003221   100101 633500                    EPPR3   65,,PR1
         2 003222   200727 453500                    STP3    @DCB#+6,,AUTO
         2 003223   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 003224   200726 756100                    STQ     @DCB#+5,,AUTO
         2 003225   100102 634500                    EPPR4   66,,PR1
         2 003226   200725 454500                    STP4    @DCB#+4,,AUTO
         2 003227   000006 236000 3                  LDQ     6
         2 003230   200724 756100                    STQ     @DCB#+3,,AUTO
         2 003231   200722 631500                    EPPR1   @DCB#+1,,AUTO
         2 003232   200723 451500                    STP1    @DCB#+2,,AUTO
         2 003233   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 003234   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003235   000000 701000 xent               TSX1    CXP$POSTERR
         2 003236   000000 011000                    NOP     0

      896    13875    2           B$TCB.ALT$ -> B$ALT.DCB#);
      897    13876    2   BANNERTEXT_ALT:
      898    13877    3     DO WHILE (%NO#) ;

  13877  2 003237   003246 710000 2     BANNERTEXT_* TRA     s:13884
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:145  

      899    13878    3   CLOSE_BOTH_DCB_ALT:
      900    13879    3         CALL REOPEN_CS ;

  13879  2 003240   004724 701000 2     CLOSE_BOTH_* TSX1    REOPEN_CS
         2 003241   000000 011000                    NOP     0

      901    13880
      902    13881    3   CLOSE_M$IBEX1_ALT:
      903    13882    3         CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;

  13882  2 003242   000000 236000 3     CLOSE_M$IBE* LDQ     0
         2 003243   200721 756100                    STQ     TEMP$+1,,AUTO
         2 003244   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 003245   000000 011000                    NOP     0

      904    13883    3     END ;   /* Do While */

      905    13884    2     ALTRETURN;

  13884  2 003246   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003247   000000 702211                    TSX2  ! 0,X1

      906    13885        /**/
      907    13886    2   BANNERTEXT_ERR:
      908    13887    2           F1_TEXT.CNT = 1 ;

  13887  2 003250   001000 236003       BANNERTEXT_* LDQ     512,DU
         2 003251   200656 552140                    STBQ    F1_TEXT,'40'O,AUTO

      909    13888    2           CALL BINCHAR(F1_TEXT.TXT, TXT#) ;

  13888  2 003252   200664 235100                    LDA     TXT#,,AUTO
         2 003253   000044 773000                    LRL     36
         2 003254   200722 757100                    STAQ    @DCB#+1,,AUTO
         2 003255   000100 301500                    BTD
         2 003256   200722 000010                    NDSC9   @DCB#+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:146  
         2 003257   200656 230001                    NDSC9   F1_TEXT,,AUTO            cn=1,s=nosgn,sf=0,n=1

      910    13889    2           CALL CPC$WRITEMSGE (E_NOROOM4BANNERTEXT, M$IBEX1_NUM, F1_TEXT,,,%YES#) ;

  13889  2 003260   000017 236000 3                  LDQ     15
         2 003261   000001 235000 xsym               LDA     B_VECTNIL+1
         2 003262   200726 757100                    STAQ    @DCB#+5,,AUTO
         2 003263   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 003264   200725 756100                    STQ     @DCB#+4,,AUTO
         2 003265   200656 630500                    EPPR0   F1_TEXT,,AUTO
         2 003266   200724 450500                    STP0    @DCB#+3,,AUTO
         2 003267   000054 237000 3                  LDAQ    44
         2 003270   200722 757100                    STAQ    @DCB#+1,,AUTO
         2 003271   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 003272   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 003273   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 003274   000000 011000                    NOP     0

      911    13890        /*E*       ERROR: CPG-E$NOROOM4BANNERTEXT-0
      912    13891                   MESSAGE: No room to put BANNERTEXT%U1.
      913    13892                   MESSAGE1: Because of the size of your SETUPs and BANNERTEXTs
      914    13893                             there is no more room for BANNERTEXT%U1.
      915    13894                   DESCRIPTION: The user has run out of space for a BANNERTEXT
      916    13895                                in his :USERS file.
      917    13896        */
      918    13897    2     ALTRETURN ;

  13897  2 003275   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003276   000000 702211                    TSX2  ! 0,X1

      919    13898    2   E_LET:
      920    13899    2     SEG$2.FLAGS.USE_REMEM = %NO# ;

  13899  2 003277   000000 470400 xsym  E_LET        LDP0    SEG2$
         2 003300   000021 236000 3                  LDQ     17
         2 003301   000000 356100                    ANSQ    0,,PR0

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:147  
      921    13900    2     CPOS = XUE_ECB.ERR_POS#;

  13900  2 003302   200164 235100                    LDA     XUE_ECB+8,,AUTO
         2 003303   000022 771000                    ARL     18
         2 003304   200663 755100                    STA     CPOS,,AUTO

      922    13901    2     VALUE = XUE_ECB.ERR_DCB#;

  13901  2 003305   200164 236100                    LDQ     XUE_ECB+8,,AUTO
         2 003306   777777 376007                    ANQ     -1,DL
         2 003307   200662 756100                    STQ     VALUE,,AUTO

      923    13902    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_ECB.ERR,,VALUE);

  13902  2 003310   000000 236000 xsym               LDQ     SEG2$
         2 003311   000003 036003                    ADLQ    3,DU
         2 003312   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003313   200662 631500                    EPPR1   VALUE,,AUTO
         2 003314   200727 451500                    STP1    @DCB#+6,,AUTO
         2 003315   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 003316   200726 756100                    STQ     @DCB#+5,,AUTO
         2 003317   200165 633500                    EPPR3   XUE_ECB+9,,AUTO
         2 003320   200725 453500                    STP3    @DCB#+4,,AUTO
         2 003321   200663 634500                    EPPR4   CPOS,,AUTO
         2 003322   200724 454500                    STP4    @DCB#+3,,AUTO
         2 003323   200722 635500                    EPPR5   @DCB#+1,,AUTO
         2 003324   200723 455500                    STP5    @DCB#+2,,AUTO
         2 003325   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 003326   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003327   000000 701000 xent               TSX1    CXP$POSTERR
         2 003330   000000 011000                    NOP     0

      924    13903    2     ALTRETURN;

  13903  2 003331   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003332   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:148  
      925    13904    2   NON_NUMERIC:
      926    13905    2     CPOS = NAME$ -> P$S.CPOS;

  13905  2 003333   200237 470500       NON_NUMERIC  LDP0    NAME$,,AUTO
         2 003334   000002 235100                    LDA     2,,PR0
         2 003335   200663 755100                    STA     CPOS,,AUTO

      927    13906    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,E_NONDECIMAL);

  13906  2 003336   000000 236000 xsym               LDQ     SEG2$
         2 003337   000003 036003                    ADLQ    3,DU
         2 003340   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003341   000056 236000 3                  LDQ     46
         2 003342   200725 756100                    STQ     @DCB#+4,,AUTO
         2 003343   200663 631500                    EPPR1   CPOS,,AUTO
         2 003344   200724 451500                    STP1    @DCB#+3,,AUTO
         2 003345   200722 633500                    EPPR3   @DCB#+1,,AUTO
         2 003346   200723 453500                    STP3    @DCB#+2,,AUTO
         2 003347   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 003350   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 003351   000000 701000 xent               TSX1    CXP$POSTERR
         2 003352   000000 011000                    NOP     0

      928    13907    2     ALTRETURN;

  13907  2 003353   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003354   000000 702211                    TSX2  ! 0,X1

      929    13908    2   END LET_COMMAND;
      930    13909        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:149  
      931    13910    1   GOTO_COMMAND: PROC ALTRET;

  13910  2 003355   200706 741300       GOTO_COMMAND STX1  ! STAR_S_IS_OPEN+2,,AUTO

      932    13911        /*
      933    13912             ***** implement the goto command ...
      934    13913        */
      935    13914    2     BLK$=P$PCB.OUT$;

  13914  2 003356   200003 470500                    LDP0    @P$PCB,,AUTO
         2 003357   000003 236100                    LDQ     3,,PR0
         2 003360   200236 756100                    STQ     BLK$,,AUTO

      936    13915    2     NAME$=BLK$->P$B.SUBLK$(0)->P$S.TEXTC$;

  13915  2 003361   200236 471500                    LDP1    BLK$,,AUTO
         2 003362   100003 473500                    LDP3    3,,PR1
         2 003363   300003 236100                    LDQ     3,,PR3
         2 003364   200237 756100                    STQ     NAME$,,AUTO

      937    13916        /*E*    ERROR: CPG-E$MLBL-0
      938    13917                MESSAGE: Missing label
      939    13918        */
      940    13919        /*E*    ERROR: CPG-E$ILLGOTO-C
      941    13920                MESSAGE: GOTO not allowed except in command file
      942    13921        */
      943    13922    2     IF DCBADDR(M$IBEX_NUM)->F$DCB.DDEV.IC#

  13922  2 003365   000010 474400 3                  LDP4    8
         2 003366   400000 475500                    LDP5    0,,PR4
         2 003367   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 003370   500000 476510                    LDP6    0,X0,PR5
         2 003371   600004 236100                    LDQ     4,,PR6
         2 003372   100000 316007                    CANQ    32768,DL
         2 003373   003411 600000 2                  TZE     s:13931

      944    13923    2        THEN
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:150  
      945    13924    3           DO;

      946    13925    3              CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,E_ILLGOTO);

  13925  2 003374   000000 236000 xsym               LDQ     SEG2$
         2 003375   000003 036003                    ADLQ    3,DU
         2 003376   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003377   000060 237000 3                  LDAQ    48
         2 003400   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 003401   200722 633500                    EPPR3   @DCB#+1,,AUTO
         2 003402   200723 453500                    STP3    @DCB#+2,,AUTO
         2 003403   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 003404   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 003405   000000 701000 xent               TSX1    CXP$POSTERR
         2 003406   000000 011000                    NOP     0

      947    13926    3              ALTRETURN;

  13926  2 003407   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003410   000000 702211                    TSX2  ! 0,X1

      948    13927    3           END;
      949    13928        /*
      950    13929             ***** Initialize ...
      951    13930        */
      952    13931    2     SECOND_PASS# = %NO#;

  13931  2 003411   200675 450100                    STZ     SECOND_PASS#,,AUTO

      953    13932    2     TEMPBUF = SEG$2.CPBUFF$ -> CP$BUFF ;       /* Save for possible use later */

  13932  2 003412   000000 477400 xsym               LDP7    SEG2$
         2 003413   700171 470500                    LDP0    121,,PR7
         2 003414   040100 100500                    MLR     fill='040'O
         2 003415   000000 000400                    ADSC9   0,,PR0                   cn=0,n=256
         2 003416   200243 001000                    ADSC9   TEMPBUF,,AUTO            cn=0,n=512

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:151  
      954    13933        /*
      955    13934             ***** Start looking for the label...
      956    13935        */
      957    13936    3     DO WHILE (%YES#);

      958    13937        /*
      959    13938             ***** read the next record, scan for label...
      960    13939        */
      961    13940    3   READ:
      962    13941        /*
      963    13942             ***** If this record is the last one in the COMMAND FILE
      964    13943                   and we did not find the specified LABEL then rewind
      965    13944                   the COMMAND FILE and make one more pass. The requested
      966    13945                   LABEL may be a backwards ref. If we still dont find it
      967    13946                   then is is missing and the user gets a C- for effort ...
      968    13947        */
      969    13948    3        IF DCBADDR(M$IBEX_NUM) -> F$DCB.DVBYTE.TOP#

  13948  2 003417   000010 470400 3     READ         LDP0    8
         2 003420   000000 471500                    LDP1    0,,PR0
         2 003421   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 003422   100000 473510                    LDP3    0,X0,PR1
         2 003423   300003 234100                    SZN     3,,PR3
         2 003424   003431 604000 2                  TMI     s:13952
         2 003425   000000 474400 xsym               LDP4    B$JIT$
         2 003426   400151 236100                    LDQ     105,,PR4
         2 003427   000777 316003                    CANQ    511,DU
         2 003430   003453 601000 2                  TNZ     s:13964

      970    13949    3        OR B$JIT.NEXTCC = %CC_FROMNO#
      971    13950    3           THEN
      972    13951    4              DO;

      973    13952    4                 IF SECOND_PASS# = %NO#

  13952  2 003431   200675 234100                    SZN     SECOND_PASS#,,AUTO
         2 003432   003601 604000 2                  TMI     MSING_LABEL
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:152  

      974    13953    4                    THEN
      975    13954    5                       DO;

      976    13955    5                          SECOND_PASS# = %YES#;

  13955  2 003433   400000 236003                    LDQ     -131072,DU
         2 003434   200675 756100                    STQ     SECOND_PASS#,,AUTO

      977    13956    5                          FPT_REW = CFPT_REW;

  13956  2 003435   000100 100400                    MLR     fill='000'O
         2 003436   000000 000030 xsym               ADSC9   CFPT_REW                 cn=0,n=24
         2 003437   200104 000030                    ADSC9   FPT_REW,,AUTO            cn=0,n=24

      978    13957    5                          FPT_REW.V_ = VECTOR(FPT_REW.V);

  13957  2 003440   000025 235000 3                  LDA     21
         2 003441   200722 452500                    STP2    @DCB#+1,,AUTO
         2 003442   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 003443   000106 036003                    ADLQ    70,DU
         2 003444   200104 757100                    STAQ    FPT_REW,,AUTO

      979    13958    5                          FPT_REW.V.DCB# = M$IBEX_NUM;

  13958  2 003445   200106 740100                    STX0    FPT_REW+2,,AUTO

      980    13959    5                          CALL M$REW (FPT_REW) ALTRET(E_PMME);

  13959  2 003446   200104 630500                    EPPR0   FPT_REW,,AUTO
         2 003447   440006 713400                    CLIMB   alt,+16390
         2 003450   400000 401760                    pmme    nvectors=1
         2 003451   003633 702000 2                  TSX2    E_PMME

      981    13960    5                       END;

  13960  2 003452   003453 710000 2                  TRA     s:13964
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:153  

      982    13961    4                    ELSE   /* Missing label */
      983    13962    4                       GOTO MSING_LABEL;
      984    13963    4              END;
      985    13964    3        SEG$2.CPBUFF$ -> CP$BUFF = ' ';

  13964  2 003453   000000 470400 xsym               LDP0    SEG2$
         2 003454   000171 471500                    LDP1    121,,PR0
         2 003455   040100 100400                    MLR     fill='040'O
         2 003456   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 003457   100000 000400                    ADSC9   0,,PR1                   cn=0,n=256

      986    13965    3        SEG$2.FPT_READCC$->FPT$READCC.BUF_ = VECTOR(SEG$2.CPBUFF$->CP$BUFF) ;

  13965  2 003460   000160 471500                    LDP1    112,,PR0
         2 003461   000171 473500                    LDP3    121,,PR0
         2 003462   000062 235000 3                  LDA     50
         2 003463   200722 453500                    STP3    @DCB#+1,,AUTO
         2 003464   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 003465   100004 757100                    STAQ    4,,PR1

      987    13966    3        SEG$2.FPT_READCC$->FPT$READCC.V.DCB# = SEG$2.GETCMD$->GET$CMD.INDCB# ;

  13966  2 003466   000160 471500                    LDP1    112,,PR0
         2 003467   000173 473500                    LDP3    123,,PR0
         2 003470   300012 720100                    LXL0    10,,PR3
         2 003471   100010 740100                    STX0    8,,PR1

      988    13967    3        CALL M$READ (SEG$2.FPT_READCC$ -> FPT$READCC) ALTRET(E_READ);

  13967  2 003472   000160 471500                    LDP1    112,,PR0
         2 003473   100000 630500                    EPPR0   0,,PR1
         2 003474   440000 713400                    CLIMB   alt,read
         2 003475   401400 401760                    pmme    nvectors=4
         2 003476   003500 702000 2                  TSX2    E_READ

      989    13968    4        DO WHILE (%NO#);
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:154  

  13968  2 003477   003507 710000 2                  TRA     s:13977

      990    13969    4   E_READ:
      991    13970    4           IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$EOF

  13970  2 003500   000000 470400 xsym  E_READ       LDP0    B$TCB$
         2 003501   000000 471500                    LDP1    0,,PR0
         2 003502   100102 236100                    LDQ     66,,PR1
         2 003503   377770 376007                    ANQ     131064,DL
         2 003504   000060 116007                    CMPQ    48,DL
         2 003505   003417 600000 2                  TZE     READ

      992    13971    4              THEN   /* Just a !EOD. Ignore */
      993    13972    4                 GOTO READ;
      994    13973    4              ELSE
      995    13974    4                 GOTO E_PMME;

  13974  2 003506   003633 710000 2                  TRA     E_PMME

      996    13975    4        END;

      997    13976        /**/
      998    13977    3        IF SUBSTR(SEG$2.CPBUFF$ -> CP$BUFF,0,1) ~= '!'

  13977  2 003507   000000 470400 xsym               LDP0    SEG2$
         2 003510   000171 471500                    LDP1    121,,PR0
         2 003511   100000 236100                    LDQ     0,,PR1
         2 003512   777000 376003                    ANQ     -512,DU
         2 003513   041000 116003                    CMPQ    16896,DU
         2 003514   003417 601000 2                  TNZ     READ

      999    13978    3           THEN
     1000    13979    3              GOTO READ;
     1001    13980    3        CALL INDEX (INDX1,': ',SEG$2.CPBUFF$ -> CP$BUFF) ALTRET(READ);

  13980  2 003515   000000 120500                    SCD
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:155  
         2 003516   100000 000400                    ADSC9   0,,PR1                   cn=0,n=256
         2 003517   000111 000002 1                  ADSC9   E_NOWHEN+15              cn=0,n=2
         2 003520   200660 000100                    ARG     INDX1,,AUTO
         2 003521   003524 607000 2                  TTF     s:13981
         2 003522   200660 054100                    AOS     INDX1,,AUTO
         2 003523   003417 710000 2                  TRA     READ

     1002    13981    3        CALL SEARCH (CPOS, DUMMY, B$SR_NON_BLANK, SUBSTR(SEG$2.CPBUFF$->

  13981  2 003524   000171 471500                    LDP1    121,,PR0
         2 003525   200660 720100                    LXL0    INDX1,,AUTO
         2 003526   777777 621010                    EAX1    -1,X0
         2 003527   000000 473400 xsym               LDP3    B$SR_NON_BLANK$
         2 003530   000000 164540                    TCT
         2 003531   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         2 003532   300000 000100                    ARG     0,,PR3
         2 003533   200663 000100                    ARG     CPOS,,AUTO
         2 003534   200663 235100                    LDA     CPOS,,AUTO
         2 003535   000033 771000                    ARL     27
         2 003536   200657 755100                    STA     DUMMY,,AUTO
         2 003537   200663 551140                    STBA    CPOS,'40'O,AUTO
         2 003540   003417 606400 2                  TTN     READ

     1003    13982    3                     CP$BUFF, 1, INDX1-1)) ALTRET(READ);
     1004    13983    3        IF SUBSTR(SEG$2.CPBUFF$ -> CP$BUFF,CPOS+1,INDX1-CPOS-1) = NAME$->X$STRING.TEXT

  13983  2 003541   000171 471500                    LDP1    121,,PR0
         2 003542   200660 236100                    LDQ     INDX1,,AUTO
         2 003543   200663 136100                    SBLQ    CPOS,,AUTO
         2 003544   200237 474500                    LDP4    NAME$,,AUTO
         2 003545   000100 101500                    MRL     fill='000'O
         2 003546   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         2 003547   200722 000002                    ADSC9   @DCB#+1,,AUTO            cn=0,n=2
         2 003550   200722 222100                    LDX2    @DCB#+1,,AUTO
         2 003551   777777 623006                    EAX3    -1,QL
         2 003552   200663 236100                    LDQ     CPOS,,AUTO
         2 003553   040140 106546                    CMPC    fill='040'O
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:156  
         2 003554   100000 200013                    ADSC9   0,Q,PR1                  cn=1,n=*X3
         2 003555   400000 200012                    ADSC9   0,,PR4                   cn=1,n=*X2
         2 003556   003417 601000 2                  TNZ     READ

     1005    13984    3           THEN
     1006    13985    4              DO; /* Found the correct label */

     1007    13986    4                 B$JIT.CCBUF=SEG$2.CPBUFF$ -> CP$BUFF ;

  13986  2 003557   000171 471500                    LDP1    121,,PR0
         2 003560   000000 475400 xsym               LDP5    B$JIT$
         2 003561   040100 100500                    MLR     fill='040'O
         2 003562   100000 000400                    ADSC9   0,,PR1                   cn=0,n=256
         2 003563   500033 000400                    ADSC9   27,,PR5                  cn=0,n=256

     1008    13987    4                 B$JIT.CCARS = DCBADDR(M$IBEX_NUM) -> F$DCB.ARS#;

  13987  2 003564   000010 471400 3                  LDP1    8
         2 003565   100000 476500                    LDP6    0,,PR1
         2 003566   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 003567   600000 477510                    LDP7    0,X0,PR6
         2 003570   700000 721100                    LXL1    0,,PR7
         2 003571   500032 741100                    STX1    26,,PR5

     1009    13988    4                 B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_BUFFULL#;

  13988  2 003572   500143 236100                    LDQ     99,,PR5
         2 003573   000073 276000 1                  ORQ     E_NOWHEN+1
         2 003574   500143 756100                    STQ     99,,PR5

     1010    13989    4                 B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_CFREAD# ;

  13989  2 003575   000116 276000 1                  ORQ     E_NOWHEN+20
         2 003576   500143 756100                    STQ     99,,PR5

     1011    13990    4                 RETURN;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:157  
  13990  2 003577   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003600   000001 702211                    TSX2  ! 1,X1

     1012    13991    4              END;
     1013    13992    3     END;

     1014    13993    2   MSING_LABEL:
     1015    13994    2     SEG$2.CPBUFF$ -> CP$BUFF = TEMPBUF ;       /* Stuff command in error back */

  13994  2 003601   000000 474400 xsym  MSING_LABEL  LDP4    SEG2$
         2 003602   400171 475500                    LDP5    121,,PR4
         2 003603   040100 100500                    MLR     fill='040'O
         2 003604   200243 000400                    ADSC9   TEMPBUF,,AUTO            cn=0,n=256
         2 003605   500000 000400                    ADSC9   0,,PR5                   cn=0,n=256

     1016    13995    2     INDX1 = BLK$ -> P$B.SUBLK$(0) -> P$B.CPOS;

  13995  2 003606   200236 473500                    LDP3    BLK$,,AUTO
         2 003607   300003 475500                    LDP5    3,,PR3
         2 003610   500002 235100                    LDA     2,,PR5
         2 003611   200660 755100                    STA     INDX1,,AUTO

     1017    13996    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),INDX1,E_MLBL);

  13996  2 003612   000000 236000 xsym               LDQ     SEG2$
         2 003613   000003 036003                    ADLQ    3,DU
         2 003614   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003615   000063 236000 3                  LDQ     51
         2 003616   200725 756100                    STQ     @DCB#+4,,AUTO
         2 003617   200660 635500                    EPPR5   INDX1,,AUTO
         2 003620   200724 455500                    STP5    @DCB#+3,,AUTO
         2 003621   200722 636500                    EPPR6   @DCB#+1,,AUTO
         2 003622   200723 456500                    STP6    @DCB#+2,,AUTO
         2 003623   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 003624   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 003625   000000 701000 xent               TSX1    CXP$POSTERR
         2 003626   000000 011000                    NOP     0
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:158  

     1018    13997    2     B$JIT.USRERR = '0'O;

  13997  2 003627   000000 470400 xsym               LDP0    B$JIT$
         2 003630   000144 450100                    STZ     100,,PR0

     1019    13998    2     ALTRETURN;

  13998  2 003631   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003632   000000 702211                    TSX2  ! 0,X1

     1020    13999    2   E_PMME:
     1021    14000    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),511,B$TCB.ALT$ -> B$ALT.ERR,,

  14000  2 003633   000000 470400 xsym  E_PMME       LDP0    B$TCB$
         2 003634   000000 471500                    LDP1    0,,PR0
         2 003635   000000 236000 xsym               LDQ     SEG2$
         2 003636   000003 036003                    ADLQ    3,DU
         2 003637   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003640   100101 633500                    EPPR3   65,,PR1
         2 003641   200727 453500                    STP3    @DCB#+6,,AUTO
         2 003642   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 003643   200726 756100                    STQ     @DCB#+5,,AUTO
         2 003644   100102 634500                    EPPR4   66,,PR1
         2 003645   200725 454500                    STP4    @DCB#+4,,AUTO
         2 003646   000006 236000 3                  LDQ     6
         2 003647   200724 756100                    STQ     @DCB#+3,,AUTO
         2 003650   200722 631500                    EPPR1   @DCB#+1,,AUTO
         2 003651   200723 451500                    STP1    @DCB#+2,,AUTO
         2 003652   200723 630500                    EPPR0   @DCB#+2,,AUTO
         2 003653   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003654   000000 701000 xent               TSX1    CXP$POSTERR
         2 003655   000000 011000                    NOP     0

     1022    14001    2           B$TCB.ALT$ -> B$ALT.DCB#);
     1023    14002    2     ALTRETURN;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:159  
  14002  2 003656   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003657   000000 702211                    TSX2  ! 0,X1

     1024    14003    2   END GOTO_COMMAND;
     1025    14004        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:160  
     1026    14005    1   OUTPUT_COMMAND: PROC ALTRET;

  14005  2 003660   200706 741300       OUTPUT_COMM* STX1  ! STAR_S_IS_OPEN+2,,AUTO

     1027    14006        /*
     1028    14007             ***** Implement the OUTPUT command ...
     1029    14008        */
     1030    14009    2     BLK$ = P$PCB.OUT$;

  14009  2 003661   200003 470500                    LDP0    @P$PCB,,AUTO
         2 003662   000003 236100                    LDQ     3,,PR0
         2 003663   200236 756100                    STQ     BLK$,,AUTO

     1031    14010    2     CALL SETUP;

  14010  2 003664   004014 701000 2                  TSX1    SETUP
         2 003665   000000 011000                    NOP     0

     1032    14011    3     DO INDX1 = 0 TO BLK$ -> P$B.NSUBLKS - 1;

  14011  2 003666   200660 450100                    STZ     INDX1,,AUTO
         2 003667   003750 710000 2                  TRA     s:14023+3

     1033    14012    3        XUE_ECB.TREE$ = BLK$ -> P$B.SUBLK$(INDX1);

  14012  2 003670   200236 470500                    LDP0    BLK$,,AUTO
         2 003671   200660 720100                    LXL0    INDX1,,AUTO
         2 003672   000003 236110                    LDQ     3,X0,PR0
         2 003673   200154 756100                    STQ     XUE_ECB,,AUTO

     1034    14013    3     SEG$2.FLAGS.USE_REMEM = %YES# ;

  14013  2 003674   000000 471400 xsym               LDP1    SEG2$
         2 003675   000020 236003                    LDQ     16,DU
         2 003676   100000 256100                    ORSQ    0,,PR1

     1035    14014    3     CALL X$EVAL (XUE_ECB) ALTRET(E_OUTPUT);
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:161  

  14014  2 003677   200154 633500                    EPPR3   XUE_ECB,,AUTO
         2 003700   200722 453500                    STP3    @DCB#+1,,AUTO
         2 003701   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 003702   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003703   000000 701000 xent               TSX1    X$EVAL
         2 003704   003760 702000 2                  TSX2    E_OUTPUT

     1036    14015    3     SEG$2.FLAGS.USE_REMEM = %NO# ;

  14015  2 003705   000000 470400 xsym               LDP0    SEG2$
         2 003706   000021 236000 3                  LDQ     17
         2 003707   000000 356100                    ANSQ    0,,PR0

     1037    14016    3        IF XUE_ECB.OUT$ -> X$STRING.SIZ = 0

  14016  2 003710   200160 471500                    LDP1    XUE_ECB+4,,AUTO
         2 003711   000100 101500                    MRL     fill='000'O
         2 003712   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 003713   200722 000004                    ADSC9   @DCB#+1,,AUTO            cn=0,n=4
         2 003714   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 003715   000000 116003                    CMPQ    0,DU
         2 003716   003723 601000 2                  TNZ     s:14020

     1038    14017    3           THEN   /* Write a NULL string */
     1039    14018    3              SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_ = VECTOR(NIL);

  14018  2 003717   000161 473500                    LDP3    113,,PR0
         2 003720   000064 237000 3                  LDAQ    52
         2 003721   300004 757100                    STAQ    4,,PR3
         2 003722   003736 710000 2                  TRA     s:14022

     1040    14019    3           ELSE   /* Normal record */
     1041    14020    3              SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_ =

  14020  2 003723   000161 473500                    LDP3    113,,PR0
         2 003724   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:162  
         2 003725   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 003726   200722 000002                    ADSC9   @DCB#+1,,AUTO            cn=0,n=2
         2 003727   200722 220100                    LDX0    @DCB#+1,,AUTO
         2 003730   000000 635010                    EAA     0,X0
         2 003731   000002 771000                    ARL     2
         2 003732   000140 135007                    SBLA    96,DL
         2 003733   200160 236100                    LDQ     XUE_ECB+4,,AUTO
         2 003734   200000 036007                    ADLQ    65536,DL
         2 003735   300004 757100                    STAQ    4,,PR3

     1042    14021    3                    VECTOR(XUE_ECB.OUT$ -> X$STRING.TEXT);
     1043    14022    3        CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$);

  14022  2 003736   000000 236000 xsym               LDQ     SEG2$
         2 003737   000161 036003                    ADLQ    113,DU
         2 003740   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003741   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 003742   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003743   000000 701000 xent               TSX1    CPE$LISTOUT
         2 003744   000000 011000                    NOP     0

     1044    14023    3     END;   /* Driving loop */

  14023  2 003745   200660 235100                    LDA     INDX1,,AUTO
         2 003746   000001 035007                    ADLA    1,DL
         2 003747   200660 755100                    STA     INDX1,,AUTO
         2 003750   200236 470500                    LDP0    BLK$,,AUTO
         2 003751   000001 236100                    LDQ     1,,PR0
         2 003752   000022 772000                    QRL     18
         2 003753   200660 116100                    CMPQ    INDX1,,AUTO
         2 003754   003756 600000 2                  TZE     s:14024
         2 003755   003670 603000 2                  TRC     s:14012

     1045    14024    2     RETURN;

  14024  2 003756   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 003757   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:163  

     1046    14025        /**/
     1047    14026    2   E_OUTPUT:
     1048    14027    2     SEG$2.FLAGS.USE_REMEM = %NO# ;

  14027  2 003760   000000 470400 xsym  E_OUTPUT     LDP0    SEG2$
         2 003761   000021 236000 3                  LDQ     17
         2 003762   000000 356100                    ANSQ    0,,PR0

     1049    14028    2     CPOS = XUE_ECB.ERR_POS#;

  14028  2 003763   200164 235100                    LDA     XUE_ECB+8,,AUTO
         2 003764   000022 771000                    ARL     18
         2 003765   200663 755100                    STA     CPOS,,AUTO

     1050    14029    2     VALUE = XUE_ECB.ERR_DCB#;

  14029  2 003766   200164 236100                    LDQ     XUE_ECB+8,,AUTO
         2 003767   777777 376007                    ANQ     -1,DL
         2 003770   200662 756100                    STQ     VALUE,,AUTO

     1051    14030    2     CALL CXP$POSTERR (ADDR(SEG$2.ERRBUF),CPOS,XUE_ECB.ERR,,VALUE);

  14030  2 003771   000000 236000 xsym               LDQ     SEG2$
         2 003772   000003 036003                    ADLQ    3,DU
         2 003773   200722 756100                    STQ     @DCB#+1,,AUTO
         2 003774   200662 631500                    EPPR1   VALUE,,AUTO
         2 003775   200727 451500                    STP1    @DCB#+6,,AUTO
         2 003776   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 003777   200726 756100                    STQ     @DCB#+5,,AUTO
         2 004000   200165 633500                    EPPR3   XUE_ECB+9,,AUTO
         2 004001   200725 453500                    STP3    @DCB#+4,,AUTO
         2 004002   200663 634500                    EPPR4   CPOS,,AUTO
         2 004003   200724 454500                    STP4    @DCB#+3,,AUTO
         2 004004   200722 635500                    EPPR5   @DCB#+1,,AUTO
         2 004005   200723 455500                    STP5    @DCB#+2,,AUTO
         2 004006   200723 630500                    EPPR0   @DCB#+2,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:164  
         2 004007   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 004010   000000 701000 xent               TSX1    CXP$POSTERR
         2 004011   000000 011000                    NOP     0

     1052    14031    2     ALTRETURN;

  14031  2 004012   200706 221300                    LDX1  ! STAR_S_IS_OPEN+2,,AUTO
         2 004013   000000 702211                    TSX2  ! 0,X1

     1053    14032    2   END OUTPUT_COMMAND;
     1054    14033        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:165  
     1055    14034    1   SETUP: PROC;

  14034  2 004014   200710 741300       SETUP        STX1  ! STAR_S_IS_OPEN+4,,AUTO

     1056    14035        /*
     1057    14036             ***** Get a page for a workspace ...
     1058    14037        */
     1059    14038    2     CALL CPC$GETSEG (SEG3$,2048) ALTRET(E_SETUP);

  14038  2 004015   000067 630400 3                  EPPR0   55
         2 004016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004017   000000 701000 xent               TSX1    CPC$GETSEG
         2 004020   004043 702000 2                  TSX2    E_SETUP

     1060    14039        /*
     1061    14040             ***** Initialize XUE_ECB ...
     1062    14041        */
     1063    14042    2     XUE_ECB = CXUE_ECB;   /* Move constant version into auto */

  14042  2 004021   000100 100400                    MLR     fill='000'O
         2 004022   000020 000160 1                  ADSC9   CXUE_ECB                 cn=0,n=112
         2 004023   200154 000160                    ADSC9   XUE_ECB,,AUTO            cn=0,n=112

     1064    14043    2     XUE_ECB.WORK$ = SEG3$;

  14043  2 004024   000000 236000 xsym               LDQ     SEG3$
         2 004025   200155 756100                    STQ     XUE_ECB+1,,AUTO

     1065    14044    2     XUE_ECB.WKSZ# = 2048;

  14044  2 004026   004000 235007                    LDA     2048,DL
         2 004027   200156 755100                    STA     XUE_ECB+2,,AUTO

     1066    14045    2     XUE_ECB.WORK_DCB# = M$IBEX1_NUM;

  14045  2 004030   000000 235000 xsym               LDA     M$IBEX1_NUM
         2 004031   200157 755100                    STA     XUE_ECB+3,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:166  

     1067    14046    2     XUE_ECB.FUN$$ = ENTADDR(CPG$FUN$$);

  14046  2 004032   000000 636000 xent               EAQ     CPG$FUN$$
         2 004033   200161 756100                    STQ     XUE_ECB+5,,AUTO

     1068    14047    2     XUE_ECB.PROCNAME_ = VECTOR(IBEX_NAME);

  14047  2 004034   000072 237000 3                  LDAQ    58
         2 004035   200166 757100                    STAQ    XUE_ECB+10,,AUTO

     1069    14048        /*
     1070    14049             ***** Misc. inits. ...
     1071    14050        */
     1072    14051    2     GOT_BANNERTEXT_REC = %NO# ;

  14051  2 004036   200677 450100                    STZ     GOT_BANNERTEXT_REC,,AUTO

     1073    14052    2     BANNER_USERS_SPLIT = %NO# ;

  14052  2 004037   200700 450100                    STZ     BANNER_USERS_SPLIT,,AUTO

     1074    14053    2     BANNER_STAR_SPLIT = %NO# ;

  14053  2 004040   200701 450100                    STZ     BANNER_STAR_SPLIT,,AUTO

     1075    14054        /**/
     1076    14055    2     RETURN;

  14055  2 004041   200710 221300                    LDX1  ! STAR_S_IS_OPEN+4,,AUTO
         2 004042   000001 702211                    TSX2  ! 1,X1

     1077    14056    2   E_SETUP:
     1078    14057    2     CALL CPC$WRITEMSGE (B$JIT.USRERR);

  14057  2 004043   000000 236000 xsym  E_SETUP      LDQ     B$JIT$
         2 004044   000144 036003                    ADLQ    100,DU
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:167  
         2 004045   200722 756100                    STQ     @DCB#+1,,AUTO
         2 004046   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 004047   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004050   000000 701000 xent               TSX1    CPC$WRITEMSGE
         2 004051   000000 011000                    NOP     0

     1079    14058    2     RETURN;

  14058  2 004052   200710 221300                    LDX1  ! STAR_S_IS_OPEN+4,,AUTO
         2 004053   000001 702211                    TSX2  ! 1,X1

     1080    14059    2   END SETUP;
     1081    14060        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:168  
     1082    14061    1   GET_BANNER_USERS: PROC ALTRET ;

  14061  2 004054   200716 741300       GET_BANNER_* STX1  ! BANNERTEXT+1,,AUTO

     1083    14062
     1084    14063    2     IF NOT SEG$2.FLAGS.USERS

  14063  2 004055   000000 470400 xsym               LDP0    SEG2$
         2 004056   000000 234100                    SZN     0,,PR0
         2 004057   004072 604000 2                  TMI     s:14071

     1085    14064    2       THEN
     1086    14065    3         DO ;

     1087    14066    3           CALL CLOSE_IBEX_DCB(M$IBEX_NUM) ;

  14066  2 004060   000050 236000 3                  LDQ     40
         2 004061   200721 756100                    STQ     TEMP$+1,,AUTO
         2 004062   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 004063   000000 011000                    NOP     0

     1088    14067    3           CALL CPC$RDUSERS(M$IBEX_NUM, %IN#) ALTRET(RDUSERS_ERR) ;

  14067  2 004064   000074 630400 3                  EPPR0   60
         2 004065   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004066   000000 701000 xent               TSX1    CPC$RDUSERS
         2 004067   004074 702000 2                  TSX2    RDUSERS_ERR

     1089    14068    3           CALL REOPEN_CS ;

  14068  2 004070   004724 701000 2                  TSX1    REOPEN_CS
         2 004071   000000 011000                    NOP     0

     1090    14069    3         END ; /* Then Do */

     1091    14070
     1092    14071    2     RETURN ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:169  

  14071  2 004072   200716 221300                    LDX1  ! BANNERTEXT+1,,AUTO
         2 004073   000001 702211                    TSX2  ! 1,X1

     1093    14072
     1094    14073    2   RDUSERS_ERR:
     1095    14074    2     CALL REOPEN_CS ;

  14074  2 004074   004724 701000 2     RDUSERS_ERR  TSX1    REOPEN_CS
         2 004075   000000 011000                    NOP     0

     1096    14075    2     CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;

  14075  2 004076   000000 236000 3                  LDQ     0
         2 004077   200721 756100                    STQ     TEMP$+1,,AUTO
         2 004100   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 004101   000000 011000                    NOP     0

     1097    14076    2     ALTRETURN ;

  14076  2 004102   200716 221300                    LDX1  ! BANNERTEXT+1,,AUTO
         2 004103   000000 702211                    TSX2  ! 0,X1

     1098    14077    2   END   GET_BANNER_USERS ;
     1099    14078        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:170  
     1100    14079    1   GET_BANNER_RECORD:  PROC  ALTRET ;

  14079  2 004104   200716 741300       GET_BANNER_* STX1  ! BANNERTEXT+1,,AUTO

     1101    14080
     1102    14081    2     IF NOT GOT_BANNERTEXT_REC

  14081  2 004105   200677 234100                    SZN     GOT_BANNERTEXT_REC,,AUTO
         2 004106   004144 604000 2                  TMI     s:14091

     1103    14082    2       THEN
     1104    14083    3         DO ;

     1105    14084    3           KEY.L = 10 ;

  14084  2 004107   012000 236003                    LDQ     5120,DU
         2 004110   200130 552140                    STBQ    KEY,'40'O,AUTO

     1106    14085    3           KEY.N = 'BANNERTEXT' ;

  14085  2 004111   040100 100400                    MLR     fill='040'O
         2 004112   000117 000012 1                  ADSC9   E_NOWHEN+21              cn=0,n=10
         2 004113   200130 200043                    ADSC9   KEY,,AUTO                cn=1,n=35

     1107    14086    3           CALL CPJ$READ_S(M$IBEX1_NUM, VECTOR(KEY), VECTOR(SEG3$->STARBANNER$BUF))

  14086  2 004114   000031 235000 3                  LDA     25
         2 004115   200722 452500                    STP2    @DCB#+1,,AUTO
         2 004116   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 004117   000130 036003                    ADLQ    88,DU
         2 004120   200724 757100                    STAQ    @DCB#+3,,AUTO
         2 004121   000053 235000 3                  LDA     43
         2 004122   000000 236000 xsym               LDQ     SEG3$
         2 004123   200730 757100                    STAQ    @DCB#+7,,AUTO
         2 004124   200724 237100                    LDAQ    @DCB#+3,,AUTO
         2 004125   200726 757100                    STAQ    @DCB#+5,,AUTO
         2 004126   200730 237100                    LDAQ    @DCB#+7,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:171  
         2 004127   200732 757100                    STAQ    @DCB#+9,,AUTO
         2 004130   200732 630500                    EPPR0   @DCB#+9,,AUTO
         2 004131   200736 450500                    STP0    @DCB#+13,,AUTO
         2 004132   200726 631500                    EPPR1   @DCB#+5,,AUTO
         2 004133   200735 451500                    STP1    @DCB#+12,,AUTO
         2 004134   000000 236000 3                  LDQ     0
         2 004135   200734 756100                    STQ     @DCB#+11,,AUTO
         2 004136   200734 630500                    EPPR0   @DCB#+11,,AUTO
         2 004137   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 004140   000000 701000 xent               TSX1    CPJ$READ_S
         2 004141   004146 702000 2                  TSX2    READ_S_ERR

     1108    14087    3                 ALTRET(READ_S_ERR) ;
     1109    14088    3           GOT_BANNERTEXT_REC = %YES# ;

  14088  2 004142   400000 236003                    LDQ     -131072,DU
         2 004143   200677 756100                    STQ     GOT_BANNERTEXT_REC,,AUTO

     1110    14089    3         END ; /* Then Do */

     1111    14090
     1112    14091    2     RETURN ;

  14091  2 004144   200716 221300                    LDX1  ! BANNERTEXT+1,,AUTO
         2 004145   000001 702211                    TSX2  ! 1,X1

     1113    14092
     1114    14093    2   READ_S_ERR:
     1115    14094    2     CALL CLOSE_IBEX_DCB(M$IBEX1_NUM) ;

  14094  2 004146   000000 236000 3     READ_S_ERR   LDQ     0
         2 004147   200721 756100                    STQ     TEMP$+1,,AUTO
         2 004150   004746 701000 2                  TSX1    CLOSE_IBEX_DCB
         2 004151   000000 011000                    NOP     0

     1116    14095    2     ALTRETURN ;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:172  
  14095  2 004152   200716 221300                    LDX1  ! BANNERTEXT+1,,AUTO
         2 004153   000000 702211                    TSX2  ! 0,X1

     1117    14096
     1118    14097    2   END   GET_BANNER_RECORD ;
     1119    14098        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:173  
     1120    14099    1   SEPERATE_BANNER_STAR: PROC ALTRET ;

  14099  2 004154   200716 741300       SEPERATE_BA* STX1  ! BANNERTEXT+1,,AUTO

     1121    14100        /*
     1122    14101          ***** Seperate the *S BANNER buffer.
     1123    14102        */
     1124    14103    2   DCL I UBIN WORD ;
     1125    14104    2   DCL TEMP$ PTR ;
     1126    14105    2     IF BANNER_STAR_SPLIT

  14105  2 004155   200701 234100                    SZN     BANNER_STAR_SPLIT,,AUTO
         2 004156   004160 605000 2                  TPL     s:14108

     1127    14106    2       THEN
     1128    14107    2         RETURN ;

  14107  2 004157   000001 702211                    TSX2  ! 1,X1

     1129    14108    2     BANNER$BUF$ = PINCRW(SEG3$, (%BAN_REC_SZ/4)+1) ;

  14108  2 004160   000000 236000 xsym               LDQ     SEG3$
         2 004161   000404 036003                    ADLQ    260,DU
         2 004162   200242 756100                    STQ     BANNER$BUF$,,AUTO

     1130    14109    3     DO I=0 TO 9 ;

  14109  2 004163   200717 450100                    STZ     I,,AUTO

     1131    14110    3         IF SEG3$->FS$BANNER.TEXT_OFF(I) = -1

  14110  2 004164   200717 236100                    LDQ     I,,AUTO
         2 004165   000022 402007                    MPY     18,DL
         2 004166   000000 470400 xsym               LDP0    SEG3$
         2 004167   003100 060506                    CSL     bolr='003'O
         2 004170   000000 400022                    BDSC    0,Q,PR0                  by=2,bit=0,n=18
         2 004171   200722 000044                    BDSC    @DCB#+1,,AUTO            by=0,bit=0,n=36
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:174  
         2 004172   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 004173   000022 732000                    QRS     18
         2 004174   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 004175   004212 601000 2                  TNZ     s:14118

     1132    14111    3             THEN
     1133    14112    4               DO ;

     1134    14113    4                 BANNER$BUF.CNT(I) = 0 ;

  14113  2 004176   200717 236100                    LDQ     I,,AUTO
         2 004177   000025 402007                    MPY     21,DL
         2 004200   200242 471500                    LDP1    BANNER$BUF$,,AUTO
         2 004201   000000 620006                    EAX0    0,QL
         2 004202   000032 236000 xsym               LDQ     B_VECTNIL+26
         2 004203   100000 356110                    ANSQ    0,X0,PR1

     1135    14114    4                 BANNER$BUF.TXT(I) = ' ' ;

  14114  2 004204   200717 236100                    LDQ     I,,AUTO
         2 004205   000124 402007                    MPY     84,DL
         2 004206   040106 100400                    MLR     fill='040'O
         2 004207   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004210   100000 200120                    ADSC9   0,Q,PR1                  cn=1,n=80

     1136    14115    4               END ; /* Then Do */

  14115  2 004211   004245 710000 2                  TRA     s:14122

     1137    14116    3             ELSE
     1138    14117    4               DO ;

     1139    14118    4                 TEMP$ = PINCRC(SEG3$, SEG3$->FS$BANNER.TEXT_OFF(I)) ;

  14118  2 004212   200717 236100                    LDQ     I,,AUTO
         2 004213   000022 402007                    MPY     18,DL
         2 004214   003100 060506                    CSL     bolr='003'O
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:175  
         2 004215   000000 400022                    BDSC    0,Q,PR0                  by=2,bit=0,n=18
         2 004216   200722 000044                    BDSC    @DCB#+1,,AUTO            by=0,bit=0,n=36
         2 004217   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 004220   000022 732000                    QRS     18
         2 004221   000020 736000                    QLS     16
         2 004222   000000 036000 xsym               ADLQ    SEG3$
         2 004223   200720 756100                    STQ     TEMP$,,AUTO

     1140    14119    4                 BANNER$BUF.TXT(I) = TEMP$ -> MOV$STR.TXT ;

  14119  2 004224   200720 471500                    LDP1    TEMP$,,AUTO
         2 004225   000100 101500                    MRL     fill='000'O
         2 004226   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 004227   200722 000002                    ADSC9   @DCB#+1,,AUTO            cn=0,n=2
         2 004230   200722 220100                    LDX0    @DCB#+1,,AUTO
         2 004231   200717 236100                    LDQ     I,,AUTO
         2 004232   000124 402007                    MPY     84,DL
         2 004233   200242 473500                    LDP3    BANNER$BUF$,,AUTO
         2 004234   040106 100540                    MLR     fill='040'O
         2 004235   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         2 004236   300000 200120                    ADSC9   0,Q,PR3                  cn=1,n=80

     1141    14120    4                 BANNER$BUF.CNT(I) = TEMP$ -> MOV$STR.CNT ;

  14120  2 004237   200717 236100                    LDQ     I,,AUTO
         2 004240   000025 402007                    MPY     21,DL
         2 004241   000002 736000                    QLS     2
         2 004242   000106 100500                    MLR     fill='000'O
         2 004243   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 004244   300000 000001                    ADSC9   0,Q,PR3                  cn=0,n=1

     1142    14121    4               END ; /* Else Do */

     1143    14122    3         IF SEG3$->FS$BANNER.PERM(I)

  14122  2 004245   200717 235100                    LDA     I,,AUTO
         2 004246   000000 066505                    CMPB    filb='0'B
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:176  
         2 004247   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         2 004250   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 004251   004256 600000 2                  TZE     s:14126

     1144    14123    3           THEN
     1145    14124    3             BANNER_ALTER(I) = %NO# ;

  14124  2 004252   003105 060400                    CSL     bolr='003'O
         2 004253   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 004254   200702 000001                    BDSC    BANNER_ALTER,A,AUTO      by=0,bit=0,n=1
         2 004255   004261 710000 2                  TRA     s:14127

     1146    14125    3           ELSE
     1147    14126    3             BANNER_ALTER(I) = %YES# ;

  14126  2 004256   003105 060400                    CSL     bolr='003'O
         2 004257   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 004260   200702 000001                    BDSC    BANNER_ALTER,A,AUTO      by=0,bit=0,n=1

     1148    14127    3     END ;   /* Do I */

  14127  2 004261   000001 035007                    ADLA    1,DL
         2 004262   200717 755100                    STA     I,,AUTO
         2 004263   000012 115007                    CMPA    10,DL
         2 004264   004164 602000 2                  TNC     s:14110

     1149    14128    2     BANNER_STAR_SPLIT = %YES# ;

  14128  2 004265   400000 236003                    LDQ     -131072,DU
         2 004266   200701 756100                    STQ     BANNER_STAR_SPLIT,,AUTO

     1150    14129    2     RETURN ;

  14129  2 004267   200716 221300                    LDX1  ! BANNERTEXT+1,,AUTO
         2 004270   000001 702211                    TSX2  ! 1,X1

     1151    14130
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:177  
     1152    14131    2   END   SEPERATE_BANNER_STAR ;
     1153    14132        %EJECT;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:178  
     1154    14133    1   SEPERATE_BANNER_USERS: PROC ALTRET ;

  14133  2 004271   200716 741300       SEPERATE_BA* STX1  ! BANNERTEXT+1,,AUTO

     1155    14134        /*
     1156    14135          ***** Seperate the :USERS BANNER buffer.
     1157    14136        */
     1158    14137    2   DCL I UBIN WORD ;
     1159    14138    2   DCL TEMP$ PTR ;
     1160    14139    2   DCL BASE$ PTR ;
     1161    14140    2     IF BANNER_USERS_SPLIT

  14140  2 004272   200700 234100                    SZN     BANNER_USERS_SPLIT,,AUTO
         2 004273   004275 605000 2                  TPL     s:14143

     1162    14141    2       THEN
     1163    14142    2         RETURN ;

  14142  2 004274   000001 702211                    TSX2  ! 1,X1

     1164    14143    2     BANNER$BUF$ = PINCRW(SEG3$, (%BAN_REC_SZ/4)+1) ;

  14143  2 004275   000000 236000 xsym               LDQ     SEG3$
         2 004276   000404 036003                    ADLQ    260,DU
         2 004277   200242 756100                    STQ     BANNER$BUF$,,AUTO

     1165    14144    2     BASE$ = ADDR(SEG$2.USERS$->AS$USERS.SETUP_CHRA.TXT) ;

  14144  2 004300   000000 470400 xsym               LDP0    SEG2$
         2 004301   000152 471500                    LDP1    106,,PR0
         2 004302   100362 633500                    EPPR3   242,,PR1
         2 004303   200721 453500                    STP3    BASE$,,AUTO

     1166    14145    3     DO I=0 TO 9 ;

  14145  2 004304   200717 450100                    STZ     I,,AUTO

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:179  
     1167    14146    3         IF SEG$2.USERS$->AS$USERS.BANNER(I) = -1

  14146  2 004305   000000 470400 xsym               LDP0    SEG2$
         2 004306   000152 471500                    LDP1    106,,PR0
         2 004307   200717 235100                    LDA     I,,AUTO
         2 004310   000001 735000                    ALS     1
         2 004311   000100 100505                    MLR     fill='000'O
         2 004312   100354 000002                    ADSC9   236,A,PR1                cn=0,n=2
         2 004313   200722 000004                    ADSC9   @DCB#+1,,AUTO            cn=0,n=4
         2 004314   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 004315   000022 732000                    QRS     18
         2 004316   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 004317   004334 601000 2                  TNZ     s:14154

     1168    14147    3             THEN
     1169    14148    4               DO ;

     1170    14149    4                 BANNER$BUF.CNT(I) = 0 ;

  14149  2 004320   200717 236100                    LDQ     I,,AUTO
         2 004321   000025 402007                    MPY     21,DL
         2 004322   200242 471500                    LDP1    BANNER$BUF$,,AUTO
         2 004323   000000 620006                    EAX0    0,QL
         2 004324   000032 236000 xsym               LDQ     B_VECTNIL+26
         2 004325   100000 356110                    ANSQ    0,X0,PR1

     1171    14150    4                 BANNER$BUF.TXT(I) = ' ' ;

  14150  2 004326   200717 236100                    LDQ     I,,AUTO
         2 004327   000124 402007                    MPY     84,DL
         2 004330   040106 100400                    MLR     fill='040'O
         2 004331   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004332   100000 200120                    ADSC9   0,Q,PR1                  cn=1,n=80

     1172    14151    4               END ; /* Then Do */

  14151  2 004333   004366 710000 2                  TRA     s:14158
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:180  

     1173    14152    3             ELSE
     1174    14153    4               DO ;

     1175    14154    4                 TEMP$ = PINCRC(BASE$, SEG$2.USERS$->AS$USERS.BANNER(I)) ;

  14154  2 004334   000152 471500                    LDP1    106,,PR0
         2 004335   000100 100505                    MLR     fill='000'O
         2 004336   100354 000002                    ADSC9   236,A,PR1                cn=0,n=2
         2 004337   200722 000004                    ADSC9   @DCB#+1,,AUTO            cn=0,n=4
         2 004340   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 004341   000022 732000                    QRS     18
         2 004342   000020 736000                    QLS     16
         2 004343   200721 036100                    ADLQ    BASE$,,AUTO
         2 004344   200720 756100                    STQ     TEMP$,,AUTO

     1176    14155    4                 BANNER$BUF.TXT(I) = TEMP$ -> MOV$STR.TXT ;

  14155  2 004345   200720 471500                    LDP1    TEMP$,,AUTO
         2 004346   000100 101500                    MRL     fill='000'O
         2 004347   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 004350   200722 000002                    ADSC9   @DCB#+1,,AUTO            cn=0,n=2
         2 004351   200722 220100                    LDX0    @DCB#+1,,AUTO
         2 004352   200717 236100                    LDQ     I,,AUTO
         2 004353   000124 402007                    MPY     84,DL
         2 004354   200242 473500                    LDP3    BANNER$BUF$,,AUTO
         2 004355   040106 100540                    MLR     fill='040'O
         2 004356   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         2 004357   300000 200120                    ADSC9   0,Q,PR3                  cn=1,n=80

     1177    14156    4                 BANNER$BUF.CNT(I) = TEMP$ -> MOV$STR.CNT ;

  14156  2 004360   200717 236100                    LDQ     I,,AUTO
         2 004361   000025 402007                    MPY     21,DL
         2 004362   000002 736000                    QLS     2
         2 004363   000106 100500                    MLR     fill='000'O
         2 004364   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:181  
         2 004365   300000 000001                    ADSC9   0,Q,PR3                  cn=0,n=1

     1178    14157    4               END ; /* Else Do */

     1179    14158    3         IF SEG$2.USERS$->AS$USERS.BANNER_PERM(I)

  14158  2 004366   000152 471500                    LDP1    106,,PR0
         2 004367   200717 235100                    LDA     I,,AUTO
         2 004370   000000 066505                    CMPB    filb='0'B
         2 004371   100351 440001                    BDSC    233,A,PR1                by=2,bit=4,n=1
         2 004372   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 004373   004400 600000 2                  TZE     s:14162

     1180    14159    3           THEN
     1181    14160    3             BANNER_ALTER(I) = %NO# ;

  14160  2 004374   003105 060400                    CSL     bolr='003'O
         2 004375   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 004376   200702 000001                    BDSC    BANNER_ALTER,A,AUTO      by=0,bit=0,n=1
         2 004377   004403 710000 2                  TRA     s:14163

     1182    14161    3           ELSE
     1183    14162    3             BANNER_ALTER(I) = %YES# ;

  14162  2 004400   003105 060400                    CSL     bolr='003'O
         2 004401   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 004402   200702 000001                    BDSC    BANNER_ALTER,A,AUTO      by=0,bit=0,n=1

     1184    14163    3     END ;   /* Do I */

  14163  2 004403   000001 035007                    ADLA    1,DL
         2 004404   200717 755100                    STA     I,,AUTO
         2 004405   000012 115007                    CMPA    10,DL
         2 004406   004305 602000 2                  TNC     s:14146

     1185    14164    2     BANNER_USERS_SPLIT = %YES# ;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:182  
  14164  2 004407   400000 236003                    LDQ     -131072,DU
         2 004410   200700 756100                    STQ     BANNER_USERS_SPLIT,,AUTO

     1186    14165    2     RETURN ;

  14165  2 004411   200716 221300                    LDX1  ! BANNERTEXT+1,,AUTO
         2 004412   000001 702211                    TSX2  ! 1,X1

     1187    14166
     1188    14167    2   END   SEPERATE_BANNER_USERS ;
     1189    14168        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:183  
     1190    14169    1   REBUILD_BANNER: PROC ALTRET ;

  14169  2 004413   200710 741300       REBUILD_BAN* STX1  ! STAR_S_IS_OPEN+4,,AUTO

     1191    14170        /*
     1192    14171          ***** Rebuild the BANNER buffer.
     1193    14172        */
     1194    14173    2   DCL I UBIN WORD ;
     1195    14174    2   DCL TEMP$ PTR ;
     1196    14175    2   DCL OFFSET UBIN ;
     1197    14176    2   DCL PINCR UBIN WORD ;
     1198    14177
     1199    14178    2     OFFSET = LENGTHC(SEG3$->FS$BANNER) ;

  14178  2 004414   000026 235007                    LDA     22,DL
         2 004415   200713 755100                    STA     OFFSET,,AUTO

     1200    14179    2     TEMP$ = PINCRC(SEG3$, OFFSET) ;

  14179  2 004416   200713 236100                    LDQ     OFFSET,,AUTO
         2 004417   000020 736000                    QLS     16
         2 004420   000000 036000 xsym               ADLQ    SEG3$
         2 004421   200712 756100                    STQ     TEMP$,,AUTO

     1201    14180    3     DO I=0 TO 9 ;

  14180  2 004422   200711 450100                    STZ     I,,AUTO

     1202    14181    3         IF BANNER$BUF.CNT(I) = 0

  14181  2 004423   200711 236100                    LDQ     I,,AUTO
         2 004424   000025 402007                    MPY     21,DL
         2 004425   200242 470500                    LDP0    BANNER$BUF$,,AUTO
         2 004426   000000 236106                    LDQ     0,QL,PR0
         2 004427   777000 316003                    CANQ    -512,DU
         2 004430   004440 601000 2                  TNZ     s:14186

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:184  
     1203    14182    3             THEN
     1204    14183    3               SEG3$->FS$BANNER.TEXT_OFF(I) = -1 ;

  14183  2 004431   200711 236100                    LDQ     I,,AUTO
         2 004432   000022 402007                    MPY     18,DL
         2 004433   000000 471400 xsym               LDP1    SEG3$
         2 004434   003106 061400                    CSR     bolr='003'O
         2 004435   000027 000044 xsym               BDSC    B_VECTNIL+23             by=0,bit=0,n=36
         2 004436   100000 400022                    BDSC    0,Q,PR1                  by=2,bit=0,n=18
         2 004437   004477 710000 2                  TRA     s:14193

     1205    14184    3             ELSE
     1206    14185    4               DO ;

     1207    14186    4                 SEG3$->FS$BANNER.TEXT_OFF(I) = OFFSET ;

  14186  2 004440   200711 236100                    LDQ     I,,AUTO
         2 004441   000022 402007                    MPY     18,DL
         2 004442   000000 471400 xsym               LDP1    SEG3$
         2 004443   003106 061500                    CSR     bolr='003'O
         2 004444   200713 000044                    BDSC    OFFSET,,AUTO             by=0,bit=0,n=36
         2 004445   100000 400022                    BDSC    0,Q,PR1                  by=2,bit=0,n=18

     1208    14187    4                 TEMP$ -> MOV$STR.CNT = BANNER$BUF.CNT(I) ;

  14187  2 004446   200711 236100                    LDQ     I,,AUTO
         2 004447   000124 402007                    MPY     84,DL
         2 004450   200712 473500                    LDP3    TEMP$,,AUTO
         2 004451   000100 100506                    MLR     fill='000'O
         2 004452   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         2 004453   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

     1209    14188    4                 TEMP$ -> MOV$STR.TXT = BANNER$BUF.TXT(I) ;

  14188  2 004454   000100 101500                    MRL     fill='000'O
         2 004455   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 004456   200722 000002                    ADSC9   @DCB#+1,,AUTO            cn=0,n=2
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:185  
         2 004457   200722 220100                    LDX0    @DCB#+1,,AUTO
         2 004460   040140 100506                    MLR     fill='040'O
         2 004461   000000 200120                    ADSC9   0,Q,PR0                  cn=1,n=80
         2 004462   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0

     1210    14189    4                 PINCR = TEMP$ -> MOV$STR.CNT + 1 ;

  14189  2 004463   000100 101500                    MRL     fill='000'O
         2 004464   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 004465   200722 000004                    ADSC9   @DCB#+1,,AUTO            cn=0,n=4
         2 004466   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 004467   000001 036007                    ADLQ    1,DL
         2 004470   200714 756100                    STQ     PINCR,,AUTO

     1211    14190    4                 OFFSET = OFFSET + PINCR ;

  14190  2 004471   200713 036100                    ADLQ    OFFSET,,AUTO
         2 004472   200713 756100                    STQ     OFFSET,,AUTO

     1212    14191    4                 TEMP$ = PINCRC(TEMP$, PINCR) ;

  14191  2 004473   200714 236100                    LDQ     PINCR,,AUTO
         2 004474   000020 736000                    QLS     16
         2 004475   200712 036100                    ADLQ    TEMP$,,AUTO
         2 004476   200712 756100                    STQ     TEMP$,,AUTO

     1213    14192    4               END ; /* Else Do */

     1214    14193    3     END ;   /* Do I */

  14193  2 004477   200711 235100                    LDA     I,,AUTO
         2 004500   000001 035007                    ADLA    1,DL
         2 004501   200711 755100                    STA     I,,AUTO
         2 004502   000012 115007                    CMPA    10,DL
         2 004503   004423 602000 2                  TNC     s:14181

     1215    14194
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:186  
     1216    14195    2     ARS = OFFSET ;

  14195  2 004504   200713 236100                    LDQ     OFFSET,,AUTO
         2 004505   200665 756100                    STQ     ARS,,AUTO

     1217    14196
     1218    14197    2     RETURN ;

  14197  2 004506   200710 221300                    LDX1  ! STAR_S_IS_OPEN+4,,AUTO
         2 004507   000001 702211                    TSX2  ! 1,X1

     1219    14198
     1220    14199    2   END   REBUILD_BANNER ;
     1221    14200        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:187  
     1222    14201    1   LIST_BANNERTEXT:  PROC  ALTRET ;

  14201  2 004510   200710 741300       LIST_BANNER* STX1  ! STAR_S_IS_OPEN+4,,AUTO

     1223    14202
     1224    14203    2   DCL START UBIN WORD ;
     1225    14204    2   DCL LAST UBIN WORD ;
     1226    14205    2   DCL I UBIN WORD ;
     1227    14206    2   DCL SZ UBIN WORD ;
     1228    14207
     1229    14208    2   DCL BANNERTEXT BIT(1) ;
     1230    14209
     1231    14210    2     BANNERTEXT = %YES# ;

  14210  2 004511   400000 236003                    LDQ     -131072,DU
         2 004512   200715 756100                    STQ     BANNERTEXT,,AUTO

     1232    14211    2     START = 1 ;

  14211  2 004513   000001 235007                    LDA     1,DL
         2 004514   200711 755100                    STA     START,,AUTO

     1233    14212    2     LAST = 9 ;

  14212  2 004515   000011 235007                    LDA     9,DL
         2 004516   200712 755100                    STA     LAST,,AUTO

     1234    14213    2     GOTO COMMON_CODE ;

  14213  2 004517   004524 710000 2                  TRA     COMMON_CODE

     1235    14214
     1236    14215    2   LIST_REGISTERNAME:  ENTRY ALTRET ;

  14215  2 004520   200710 741300       LIST_REGIST* STX1  ! STAR_S_IS_OPEN+4,,AUTO

     1237    14216
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:188  
     1238    14217    2     BANNERTEXT = %NO# ;

  14217  2 004521   200715 450100                    STZ     BANNERTEXT,,AUTO

     1239    14218    2     START = 0 ;

  14218  2 004522   200711 450100                    STZ     START,,AUTO

     1240    14219    2     LAST = 0 ;

  14219  2 004523   200712 450100                    STZ     LAST,,AUTO

     1241    14220
     1242    14221    2   COMMON_CODE:
     1243    14222    2     SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_ = VECTOR(WRITEBUF) ;

  14222  2 004524   000000 470400 xsym  COMMON_CODE  LDP0    SEG2$
         2 004525   000161 471500                    LDP1    113,,PR0
         2 004526   000002 235000 3                  LDA     2
         2 004527   200722 452500                    STP2    @DCB#+1,,AUTO
         2 004530   200722 236100                    LDQ     @DCB#+1,,AUTO
         2 004531   000443 036003                    ADLQ    291,DU
         2 004532   100004 757100                    STAQ    4,,PR1

     1244    14223    2     IF PERM

  14223  2 004533   200676 234100                    SZN     PERM,,AUTO
         2 004534   004551 605000 2                  TPL     s:14235

     1245    14224    2       THEN
     1246    14225    3         DO ;

     1247    14226    3           IF NOT SEG$2.FLAGS.USERS

  14226  2 004535   000000 234100                    SZN     0,,PR0
         2 004536   004541 604000 2                  TMI     s:14229

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:189  
     1248    14227    3             THEN
     1249    14228    3               CALL GET_BANNER_USERS ALTRET(LIST_BANNER_ERR) ;

  14228  2 004537   004054 701000 2                  TSX1    GET_BANNER_USERS
         2 004540   004722 702000 2                  TSX2    LIST_BANNER_ERR

     1250    14229    3           CALL SEPERATE_BANNER_USERS ALTRET(LIST_BANNER_ERR) ;

  14229  2 004541   004271 701000 2                  TSX1    SEPERATE_BANNER_USERS
         2 004542   004722 702000 2                  TSX2    LIST_BANNER_ERR

     1251    14230    3           WRITEBUF = '   Permanent' ;

  14230  2 004543   040100 100400                    MLR     fill='040'O
         2 004544   000122 000014 1                  ADSC9   E_NOWHEN+24              cn=0,n=12
         2 004545   200443 001054                    ADSC9   WRITEBUF,,AUTO           cn=0,n=556

     1252    14231    3           SZ = 12 ;

  14231  2 004546   000014 235007                    LDA     12,DL
         2 004547   200714 755100                    STA     SZ,,AUTO

     1253    14232    3         END ; /* Then Do */

  14232  2 004550   004564 710000 2                  TRA     s:14242

     1254    14233    2       ELSE
     1255    14234    3         DO ;

     1256    14235    3           IF NOT GOT_BANNERTEXT_REC

  14235  2 004551   200677 234100                    SZN     GOT_BANNERTEXT_REC,,AUTO
         2 004552   004555 604000 2                  TMI     s:14238

     1257    14236    3             THEN
     1258    14237    3               CALL GET_BANNER_RECORD ALTRET(LIST_BANNER_ERR) ;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:190  
  14237  2 004553   004104 701000 2                  TSX1    GET_BANNER_RECORD
         2 004554   004722 702000 2                  TSX2    LIST_BANNER_ERR

     1259    14238    3           CALL SEPERATE_BANNER_STAR ALTRET(LIST_BANNER_ERR) ;

  14238  2 004555   004154 701000 2                  TSX1    SEPERATE_BANNER_STAR
         2 004556   004722 702000 2                  TSX2    LIST_BANNER_ERR

     1260    14239    3           WRITEBUF = '   Session' ;

  14239  2 004557   040100 100400                    MLR     fill='040'O
         2 004560   000125 000012 1                  ADSC9   E_NOWHEN+27              cn=0,n=10
         2 004561   200443 001054                    ADSC9   WRITEBUF,,AUTO           cn=0,n=556

     1261    14240    3           SZ = 10 ;

  14240  2 004562   000012 235007                    LDA     10,DL
         2 004563   200714 755100                    STA     SZ,,AUTO

     1262    14241    3         END ; /* Else Do */

     1263    14242    2     IF START = 0

  14242  2 004564   200711 236100                    LDQ     START,,AUTO
         2 004565   004576 601000 2                  TNZ     s:14250

     1264    14243    2       THEN
     1265    14244    3         DO ;

     1266    14245    3           CALL INSERT (WRITEBUF, SZ+1,, 'RegisterName:') ;

  14245  2 004566   776724 620005                    EAX0    -556,AL
         2 004567   777777 660003                    ERX0    -1,DU
         2 004570   040145 100400                    MLR     fill='040'O
         2 004571   000130 000015 1                  ADSC9   E_NOWHEN+30              cn=0,n=13
         2 004572   200443 200010                    ADSC9   WRITEBUF,A,AUTO          cn=1,n=*X0

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:191  
     1267    14246    3           SZ = SZ + 14 ;

  14246  2 004573   000016 035007                    ADLA    14,DL
         2 004574   200714 755100                    STA     SZ,,AUTO

     1268    14247    3         END ; /* Then Do */

  14247  2 004575   004605 710000 2                  TRA     s:14253

     1269    14248    2       ELSE
     1270    14249    3         DO ;

     1271    14250    3           CALL INSERT (WRITEBUF, SZ+1,, 'BannerText:') ;

  14250  2 004576   776724 620005                    EAX0    -556,AL
         2 004577   777777 660003                    ERX0    -1,DU
         2 004600   040145 100400                    MLR     fill='040'O
         2 004601   000134 000013 1                  ADSC9   E_NOWHEN+34              cn=0,n=11
         2 004602   200443 200010                    ADSC9   WRITEBUF,A,AUTO          cn=1,n=*X0

     1272    14251    3           SZ = SZ + 12 ;

  14251  2 004603   000014 035007                    ADLA    12,DL
         2 004604   200714 755100                    STA     SZ,,AUTO

     1273    14252    3         END ; /* Else Do */

     1274    14253    2     SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = SZ ;

  14253  2 004605   000000 470400 xsym               LDP0    SEG2$
         2 004606   000161 471500                    LDP1    113,,PR0
         2 004607   200714 236100                    LDQ     SZ,,AUTO
         2 004610   000020 736000                    QLS     16
         2 004611   100004 676100                    ERQ     4,,PR1
         2 004612   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 004613   100004 656100                    ERSQ    4,,PR1

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:192  
     1275    14254    2     CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$) ;

  14254  2 004614   000000 236000 xsym               LDQ     SEG2$
         2 004615   000161 036003                    ADLQ    113,DU
         2 004616   200722 756100                    STQ     @DCB#+1,,AUTO
         2 004617   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 004620   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004621   000000 701000 xent               TSX1    CPE$LISTOUT
         2 004622   000000 011000                    NOP     0

     1276    14255    3     DO I = START TO LAST ;

  14255  2 004623   200711 235100                    LDA     START,,AUTO
         2 004624   200713 755100                    STA     I,,AUTO
         2 004625   004715 710000 2                  TRA     s:14270+3

     1277    14256
     1278    14257    3       WRITEBUF = ' ' ;

  14257  2 004626   040100 100400                    MLR     fill='040'O
         2 004627   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004630   200443 001054                    ADSC9   WRITEBUF,,AUTO           cn=0,n=556

     1279    14258    3       IF I ~= 0

  14258  2 004631   200713 235100                    LDA     I,,AUTO
         2 004632   004652 600000 2                  TZE     s:14264

     1280    14259    3         THEN
     1281    14260    4           DO ;

     1282    14261    4             CALL BINCHAR(F1_TEXT.TXT, I) ;

  14261  2 004633   000044 773000                    LRL     36
         2 004634   200722 757100                    STAQ    @DCB#+1,,AUTO
         2 004635   000100 301500                    BTD
         2 004636   200722 000010                    NDSC9   @DCB#+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:193  
         2 004637   200656 230001                    NDSC9   F1_TEXT,,AUTO            cn=1,s=nosgn,sf=0,n=1

     1283    14262    4             CALL CONCAT (WRITEBUF, '   ', F1_TEXT.TXT,':') ;

  14262  2 004640   000104 236000 1                  LDQ     E_NOWHEN+10
         2 004641   000076 376000 3                  ANQ     62
         2 004642   000040 276007                    ORQ     32,DL
         2 004643   200443 756100                    STQ     WRITEBUF,,AUTO
         2 004644   200656 236100                    LDQ     F1_TEXT,,AUTO
         2 004645   000022 772000                    QRL     18
         2 004646   200443 552104                    STBQ    WRITEBUF,'04'O,AUTO
         2 004647   040100 100400                    MLR     fill='040'O
         2 004650   000077 000001 3                  ADSC9   63                       cn=0,n=1
         2 004651   200444 001050                    ADSC9   WRITEBUF+1,,AUTO         cn=0,n=552

     1284    14263    4           END ; /* Else Do */

     1285    14264    3       IF NOT BANNER_ALTER(I)

  14264  2 004652   200713 235100                    LDA     I,,AUTO
         2 004653   000000 066505                    CMPB    filb='0'B
         2 004654   200702 000001                    BDSC    BANNER_ALTER,A,AUTO      by=0,bit=0,n=1
         2 004655   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 004656   004662 601000 2                  TNZ     s:14267

     1286    14265    3         THEN
     1287    14266    3           CALL INSERT (WRITEBUF, 6,,'(Unalterable)') ;

  14266  2 004657   040100 100400                    MLR     fill='040'O
         2 004660   000137 000015 1                  ADSC9   E_NOWHEN+37              cn=0,n=13
         2 004661   200444 401046                    ADSC9   WRITEBUF+1,,AUTO         cn=2,n=550

     1288    14267    3       CALL INSERT (WRITEBUF, 20,, BANNER$BUF.TXT(I)) ;

  14267  2 004662   200713 236100                    LDQ     I,,AUTO
         2 004663   000124 402007                    MPY     84,DL
         2 004664   200242 470500                    LDP0    BANNER$BUF$,,AUTO
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:194  
         2 004665   040100 100506                    MLR     fill='040'O
         2 004666   000000 200120                    ADSC9   0,Q,PR0                  cn=1,n=80
         2 004667   200450 001030                    ADSC9   WRITEBUF+5,,AUTO         cn=0,n=536

     1289    14268    3       SEG$2.FPT_WRITECC$ -> FPT$WRITE.BUF_.BOUND = BANNER$BUF.CNT(I) + 20 ;

  14268  2 004670   000000 471400 xsym               LDP1    SEG2$
         2 004671   100161 473500                    LDP3    113,,PR1
         2 004672   200713 236100                    LDQ     I,,AUTO
         2 004673   000025 402007                    MPY     21,DL
         2 004674   000000 236106                    LDQ     0,QL,PR0
         2 004675   000033 772000                    QRL     27
         2 004676   000024 036007                    ADLQ    20,DL
         2 004677   000020 736000                    QLS     16
         2 004700   300004 676100                    ERQ     4,,PR3
         2 004701   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 004702   300004 656100                    ERSQ    4,,PR3

     1290    14269    3       CALL CPE$LISTOUT (SEG$2.FPT_WRITECC$) ;

  14269  2 004703   000000 236000 xsym               LDQ     SEG2$
         2 004704   000161 036003                    ADLQ    113,DU
         2 004705   200722 756100                    STQ     @DCB#+1,,AUTO
         2 004706   200722 630500                    EPPR0   @DCB#+1,,AUTO
         2 004707   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004710   000000 701000 xent               TSX1    CPE$LISTOUT
         2 004711   000000 011000                    NOP     0

     1291    14270    3     END ; /* Do I */

  14270  2 004712   200713 235100                    LDA     I,,AUTO
         2 004713   000001 035007                    ADLA    1,DL
         2 004714   200713 755100                    STA     I,,AUTO
         2 004715   200712 236100                    LDQ     LAST,,AUTO
         2 004716   200713 116100                    CMPQ    I,,AUTO
         2 004717   004626 603000 2                  TRC     s:14257

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:195  
     1292    14271
     1293    14272    2     RETURN ;

  14272  2 004720   200710 221300                    LDX1  ! STAR_S_IS_OPEN+4,,AUTO
         2 004721   000001 702211                    TSX2  ! 1,X1

     1294    14273
     1295    14274    2   LIST_BANNER_ERR:
     1296    14275    2     ALTRETURN ;

  14275  2 004722   200710 221300       LIST_BANNER* LDX1  ! STAR_S_IS_OPEN+4,,AUTO
         2 004723   000000 702211                    TSX2  ! 0,X1

     1297    14276    2   END   LIST_BANNERTEXT ;
     1298    14277        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:196  
     1299    14278    1   REOPEN_CS:  PROC ;

  14278  2 004724   200720 741300       REOPEN_CS    STX1  ! TEMP$,,AUTO

     1300    14279
     1301    14280    2     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB# = M$IBEX_NUM ;

  14280  2 004725   000000 470400 xsym               LDP0    SEG2$
         2 004726   000163 471500                    LDP1    115,,PR0
         2 004727   000000 720000 xsym               LXL0    M$IBEX_NUM
         2 004730   100032 740100                    STX0    26,,PR1

     1302    14281    2     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP# = %SAVE# ;

  14281  2 004731   000163 471500                    LDP1    115,,PR0
         2 004732   000002 236007                    LDQ     2,DL
         2 004733   100032 552104                    STBQ    26,'04'O,PR1

     1303    14282    2     CALL M$CLOSE (SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(CLOSE_ERR) ;

  14282  2 004734   000163 471500                    LDP1    115,,PR0
         2 004735   100000 630500                    EPPR0   0,,PR1
         2 004736   450001 713400                    CLIMB   alt,close
         2 004737   406000 401760                    pmme    nvectors=13
         2 004740   004741 702000 2                  TSX2    CLOSE_ERR

     1304    14283    2   CLOSE_ERR:
     1305    14284    2     CALL CPB$OPENCS ;

  14284  2 004741   000002 631400 xsym  CLOSE_ERR    EPPR1   B_VECTNIL+2
         2 004742   000000 701000 xent               TSX1    CPB$OPENCS
         2 004743   000000 011000                    NOP     0

     1306    14285    2     RETURN ;

  14285  2 004744   200720 221300                    LDX1  ! TEMP$,,AUTO
         2 004745   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:197  

     1307    14286
     1308    14287    2   END   REOPEN_CS ;
     1309    14288        %EJECT ;
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:198  
     1310    14289    1   CLOSE_IBEX_DCB:  PROC(DCB#) ;

  14289  2 004746   200720 741300       CLOSE_IBEX_* STX1  ! TEMP$,,AUTO

     1311    14290
     1312    14291    2   DCL DCB# UBIN WORD ;
     1313    14292    2     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DCB#=DCB# ;

  14292  2 004747   000000 470400 xsym               LDP0    SEG2$
         2 004750   000163 471500                    LDP1    115,,PR0
         2 004751   200721 473500                    LDP3    @DCB#,,AUTO
         2 004752   300000 720100                    LXL0    0,,PR3
         2 004753   100032 740100                    STX0    26,,PR1

     1314    14293    2     SEG$2.FPT_CLOSE$->FPT$CLOSE.V.DISP#=%SAVE# ;

  14293  2 004754   000163 471500                    LDP1    115,,PR0
         2 004755   000002 236007                    LDQ     2,DL
         2 004756   100032 552104                    STBQ    26,'04'O,PR1

     1315    14294    2     CALL M$CLOSE(SEG$2.FPT_CLOSE$->FPT$CLOSE) ALTRET(CLOSE_ERR) ;

  14294  2 004757   000163 471500                    LDP1    115,,PR0
         2 004760   100000 630500                    EPPR0   0,,PR1
         2 004761   450001 713400                    CLIMB   alt,close
         2 004762   406000 401760                    pmme    nvectors=13
         2 004763   004764 702000 2                  TSX2    CLOSE_ERR

     1316    14295    2   CLOSE_ERR:
     1317    14296    2     RETURN ;

  14296  2 004764   200720 221300       CLOSE_ERR    LDX1  ! TEMP$,,AUTO
         2 004765   000001 702211                    TSX2  ! 1,X1
     1318    14297    2   END   CLOSE_IBEX_DCB ;
     1319    14298    1   END CPG$IBEX;

PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:199  
--  Include file information  --

   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   FS_BANNER_C.:E05TOU  is referenced.
   CP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XUE_SUBS_C.:E05TOU  is referenced.
   XUE_MACRO_C.:E05TOU  is referenced.
   XUM_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   CP_PERR_C.:E05TOU  is referenced.
   CP_SUBS_C.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure CPG$IBEX.
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:200  

 **** Variables and constants ****

  ****  Section 001 RoData CPG$IBEX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/d STRC(54)    r     1 CK_WHEN                    6-0-0/d STRC(333)   r     1 CWHEN_CNTL_REC
    20-0-0/d STRC(1008)  r     1 CXUE_ECB                  65-0-0/w STRC        r     1 E_BADBANNERTEXT0
    71-0-0/w STRC        r     1 E_CSINT                   66-0-0/w STRC        r     1 E_ILLBANNERTEXTLEN
    63-0-0/w STRC        r     1 E_ILLEXP                  55-0-0/w STRC        r     1 E_ILLGOTO
    56-0-0/w STRC        r     1 E_MLBL                    61-0-0/w STRC        r     1 E_MSCOMVAR
    64-0-0/w STRC        r     1 E_NONDECIMAL              70-0-0/w STRC        r     1 E_NOROOM4BANNERTEXT
    72-0-0/w STRC        r     1 E_NOWHEN                  57-0-0/w STRC        r     1 E_READONLYLET
    67-0-0/w STRC        r     1 E_UNALTBANNERTEXT         60-0-0/w STRC        r     1 E_XBIG511
     0-0-0/c STRC(54)    r     1 FKEY                       2-0-0/c STRC(54)    r     1 LKEY
    54-0-0/w UBIN(9)     r     1 NIL_TXTC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   721-0-0/w PTR         r     1 @DCB#                      3-0-0/w PTR         r     1 @P$PCB
   241-0-0/w PTR         r     1 ARRY$                    665-0-0/w UBIN        r     1 ARS
   242-0-0/w PTR         r     1 BANNER$BUF$              715-0-0/b BIT         r     1 BANNERTEXT
   702-0-0/b BIT         r     1 BANNER_ALTER(0:9)
   701-0-0/b BIT         r     1 BANNER_STAR_SPLIT        700-0-0/b BIT         r     1 BANNER_USERS_SPLIT
   234-0-0/d VECT        r     1 BANNER_VEC               721-0-0/w PTR         r     1 BASE$
   236-0-0/w PTR         r     1 BLK$                     673-0-0/b BIT         r     1 CHANGED
   667-0-0/w UBIN        r     1 CMD_SOURCE               663-0-0/w UBIN        r     1 CPOS
   670-0-0/w UBIN        r     1 CSLEV                     *0-0-0/w UBIN        r     1 DCB#
   657-0-0/w UBIN        r     1 DUMMY                    656-0-0/c STRC(18)    r     1 F1_TEXT
    42-0-0/d STRC(360)   r     1 FPT_DELREC                54-0-0/d STRC(360)   r     1 FPT_PRECORD
    66-0-0/d STRC(504)   r     1 FPT_READ                 104-0-0/d STRC(216)   r     1 FPT_REW
   677-0-0/b BIT         r     1 GOT_BANNERTEXT_REC       666-0-0/w UBIN        r     1 I
   717-0-0/w UBIN        r     1 I                        717-0-0/w UBIN        r     1 I
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:201  
   711-0-0/w UBIN        r     1 I                        713-0-0/w UBIN        r     1 I
   660-0-0/w UBIN        r     1 INDX1                    130-0-0/c STRC(324)   r     1 KEY
   141-0-0/c STRC(288)   r     1 KEY_VAR                  152-0-0/d STRC(54)    r     1 K_WHEN
   712-0-0/w UBIN        r     1 LAST                     671-0-0/w SBIN        r     1 LEFTPOS
   237-0-0/w PTR         r     1 NAME$                    713-0-0/w UBIN        r     1 OFFSET
    *0-0-0/w STRC(504)   r     1 P$PCB                    676-0-0/b BIT         r     1 PERM
   714-0-0/w UBIN        r     1 PINCR                    674-0-0/b BIT         r     1 PRINT_HDR#
   672-0-0/w SBIN        r     1 RIGHTPOS                 675-0-0/b BIT         r     1 SECOND_PASS#
   711-0-0/w UBIN        r     1 START                    704-0-0/b BIT         r     1 STAR_S_IS_OPEN
   714-0-0/w UBIN        r     1 SZ                       720-0-0/w PTR         r     1 TEMP$
   720-0-0/w PTR         r     1 TEMP$                    712-0-0/w PTR         r     1 TEMP$
   243-0-0/c CHAR(512)   r     1 TEMPBUF                  664-0-0/w UBIN        r     1 TXT#
   240-0-0/w PTR         r     1 TXT$                     210-0-0/w STRC(576)   r     1 U$PARAM
   662-0-0/w SBIN        r     1 VALUE                    703-0-0/b BIT         r     1 WHEN_LEVEL0
   230-0-0/w PTR         r     1 WILD_VAR$                443-0-0/c CHAR(556)   r     1 WRITEBUF
   154-0-0/d STRC(1008)  r     1 XUE_ECB

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$SR_NON_BLANK$
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 B$XL_UPPER$
     0-0-0/d STRC(360)   r     1 CFPT_DELREC                0-0-0/d STRC(360)   r     1 CFPT_PRECORD
     0-0-0/d STRC(504)   r     1 CFPT_READ                  0-0-0/d STRC(216)   r     1 CFPT_REW
     0-0-0/b BIT         r     1 IBEX_CMD                   0-0-0/c STRC(45)    r     1 IBEX_NAME
     0-0-0/w UBIN        r     1 M$IBEX1_NUM                0-0-0/w UBIN        r     1 M$IBEX_NUM
     0-0-0/w PTR         r     1 SEG2$                      0-0-0/w PTR         r     1 SEG3$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(18576) r     1 AS$USERS                   0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(4608)  r     1 B$SR_NON_BLANK
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:202  
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 B$TEXT
     0-0-0/d STRC(4608)  r     1 B$XL_UPPER
     0-0-0/w STRC(729)   r     1 BANNER$BUF(0:9)
     0-0-0/w CHAR(256)   r     1 CP$BUFF                    0-0-0/c CHAR(256)   r     1 DUMMY$CHAR
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(1080)  r     1 FPT$CLOSE
     0-0-0/d STRC(504)   r     1 FPT$READCC                 0-0-0/d STRC(432)   r     1 FPT$WRITE
     0-0-0/b STRC(198)   r     1 FS$BANNER                  0-0-0/d STRC(1512)  r     1 GET$CMD
     0-0-0/c ASTR(9)     r     1 MOV$STR                    0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S                        0-0-0/d REMB        r     1 REMEM$VAR
     0-0-0/c UBIN(9)     r     1 RLT(0:0)                   0-0-0/w STRC(6264)  r     1 SEG$2
     0-0-0/c CHAR(1036)  r     1 STARBANNER$BUF             0-0-0/c ASTR(9)     r     1 TEXT
     0-0-0/c ASTR(9)     r     1 TXT$C                      0-0-0/d STRC(333)   r     1 WHEN$CNTL_REC
     0-0-0/c ASTR(9)     r     1 WILD_VAR                   0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure CPG$IBEX requires 2550 words for executable code.
   Procedure CPG$IBEX requires 482 words of local(AUTO) storage.

    No errors detected in file CPG$IBEX.:E05TSI    .
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:203  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:204  
          MINI XREF LISTING

ABORT
     13437**LABEL   13172--CALLALT 13183--CALLALT 13194--CALLALT
ABORT_GOTO
     13451**LABEL   13161--CALLALT
ALA$BANNER2_STAR_S
     10491**DCL-ENT 13760--CALL
ARRY$
     12478**DCL     13841<<ASSIGN  13842>>IF      13845>>ASSIGN  13845>>ASSIGN  13846<<ASSIGN
ARS
     12502**DCL     12228--IMP-SIZ 13257<<ASSIGN  13261>>CALLBLT 13262>>CALLBLT 13263>>IF      13266>>CALLBLT
     13270>>IF      13273>>CALLBLT 13273>>CALLBLT 13273>>CALLBLT 13277<<ASSIGN  13277>>ASSIGN  13280>>CALLBLT
     13283<<ASSIGN  13283>>ASSIGN  13284>>CALL    13339<<ASSIGN  13359>>ASSIGN  13847<<ASSIGN  13858>>ASSIGN
     14195<<ASSIGN
AS$USERS.BANNER
     12392**DCL     14146>>IF      14154>>ASSIGN
AS$USERS.BANNER_PERM
     12379**DCL     12380--REDEF   14158>>IF
AS$USERS.BUDGET.MACCT
     12284**DCL     12288--REDEF
AS$USERS.BUDGET.MAX_PROJECTS
     12297**DCL     12300--REDEF
AS$USERS.BUDGET.PACCUM
     12280**DCL     12282--REDEF
AS$USERS.BUDGET.PMAXC
     12275**DCL     12277--REDEF
AS$USERS.SETUP_CHRA.TXT
     12395**DCL     12396--REDEF   12397--REDEF   14144--ASSIGN
ASC$BANNER
     10492**DCL-ENT 13833--CALL
B$ALT.CODE
     11719**DCL     11719--REDEF   11720--REDEF   11720--REDEF
B$ALT.DCB#
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:205  
     11720**DCL     13874<>CALL    14000<>CALL
B$ALT.ERR
     11720**DCL     13874<>CALL    14000<>CALL
B$ALT.ERR.CODE
     11721**DCL     13657>>IF      13970>>IF
B$ALT.ERR.ERR#
     11721**DCL     11721--REDEF
B$ALT.EVID
     11720**DCL     11720--REDEF   11720--REDEF
B$JIT.CCARS
       554**DCL     13388<<ASSIGN  13487<<ASSIGN  13492<<ASSIGN  13987<<ASSIGN
B$JIT.CCBUF
       554**DCL     13387<<CALLBLT 13484<<ASSIGN  13485<<CALLBLT 13491<<ASSIGN  13986<<ASSIGN
B$JIT.CPFLAGS1
       555**DCL     13389<<ASSIGN  13389>>ASSIGN  13494<<ASSIGN  13494>>ASSIGN  13988<<ASSIGN  13988>>ASSIGN
     13989<<ASSIGN  13989>>ASSIGN
B$JIT.CPFLAGS1.SKIPABORT
       558**DCL     13390<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       560**DCL       560--REDEF
B$JIT.CPFLAGS1.WHEN_INPUT
       556**DCL     13208>>IF      13290<<ASSIGN
B$JIT.CSLEV
       621**DCL     13224>>ASSIGN  13225>>ASSIGN  13226>>DOINDEX 13246>>ASSIGN  13291>>IF
B$JIT.ERR.MID
       467**DCL       467--REDEF
B$JIT.JRESPEAK
       628**DCL       629--REDEF
B$JIT.NEXTCC
       608**DCL     13948>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       737**DCL       737--REDEF     738--REDEF
B$JIT.PNR
       641**DCL       641--REDEF
B$JIT.PRFLAGS.WHEN
       551**DCL     13293<<ASSIGN  13332>>IF
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:206  
B$JIT.STEPCC
       693**DCL     13584<<ASSIGN
B$JIT.TSLINE
       735**DCL       736--REDEF
B$JIT.USRERR
       602**DCL     13298<>CALL    13299<<ASSIGN  13304<<ASSIGN  13760<>CALL    13762<>CALL    13863<>CALL
     13868<>CALL    13869<<ASSIGN  13997<<ASSIGN  14057<>CALL
B$JIT$
     10274**DCL       461--IMP-PTR 13208>>IF      13224>>ASSIGN  13225>>ASSIGN  13226>>DOINDEX 13246>>ASSIGN
     13290>>ASSIGN  13291>>IF      13293>>ASSIGN  13298>>CALL    13299>>ASSIGN  13304>>ASSIGN  13332>>IF
     13387>>CALLBLT 13388>>ASSIGN  13389>>ASSIGN  13389>>ASSIGN  13390>>ASSIGN  13484>>ASSIGN  13485>>CALLBLT
     13487>>ASSIGN  13491>>ASSIGN  13492>>ASSIGN  13494>>ASSIGN  13494>>ASSIGN  13584>>ASSIGN  13760>>CALL
     13762>>CALL    13863>>CALL    13868>>CALL    13869>>ASSIGN  13948>>IF      13986>>ASSIGN  13987>>ASSIGN
     13988>>ASSIGN  13988>>ASSIGN  13989>>ASSIGN  13989>>ASSIGN  13997>>ASSIGN  14057>>CALL
B$SR_NON_BLANK
     12489**DCL     13981>>CALLBLT
B$SR_NON_BLANK$
     12488**DCL     12489--IMP-PTR 13981>>CALLBLT
B$TCB.ALT$
     11715**DCL     13657>>IF      13874>>CALL    13874>>CALL    13970>>IF      14000>>CALL    14000>>CALL
B$TCB$
     10276**DCL     11715--IMP-PTR 13657>>IF      13874>>CALL    13874>>CALL    13970>>IF      14000>>CALL
     14000>>CALL
B$TEXT
     12228**DCL     13261>>CALLBLT 13262>>CALLBLT 13263>>IF      13266>>CALLBLT 13270>>IF      13273>>CALLBLT
     13273>>CALLBLT 13280>>CALLBLT
B$XL_UPPER
     12493**DCL     13552>>CALLBLT
B$XL_UPPER$
     12492**DCL     12493--IMP-PTR 13552>>CALLBLT
BANNER$BUF.CNT
     12433**DCL     13853<<ASSIGN  14113<<ASSIGN  14120<<ASSIGN  14149<<ASSIGN  14156<<ASSIGN  14181>>IF
     14187>>ASSIGN  14268>>ASSIGN
BANNER$BUF.TXT
     12434**DCL     13854<<ASSIGN  14114<<ASSIGN  14119<<ASSIGN  14150<<ASSIGN  14155<<ASSIGN  14188>>ASSIGN
     14267>>CALLBLT
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:207  
BANNER$BUF$
     12479**DCL     12432--IMP-PTR 13853>>ASSIGN  13854>>ASSIGN  14108<<ASSIGN  14113>>ASSIGN  14114>>ASSIGN
     14119>>ASSIGN  14120>>ASSIGN  14143<<ASSIGN  14149>>ASSIGN  14150>>ASSIGN  14155>>ASSIGN  14156>>ASSIGN
     14181>>IF      14187>>ASSIGN  14188>>ASSIGN  14267>>CALLBLT 14268>>ASSIGN
BANNERTEXT IN PROCEDURE LIST_BANNERTEXT
     14208**DCL     14210<<ASSIGN  14217<<ASSIGN
BANNERTEXT_ALT IN PROCEDURE LET_COMMAND
     13877**LABEL   13614--CALLALT 13617--CALLALT 13627--CALLALT 13628--CALLALT 13630--CALLALT 13631--CALLALT
     13759--CALLALT 13791--GOTO    13804--GOTO    13812--CALLALT
BANNERTEXT_ERR IN PROCEDURE LET_COMMAND
     13887**LABEL   13833--CALLALT
BANNER_ALTER
     12517**DCL     14124<<ASSIGN  14126<<ASSIGN  14160<<ASSIGN  14162<<ASSIGN  14264>>IF
BANNER_STAR_SPLIT
     12516**DCL     14053<<ASSIGN  14105>>IF      14128<<ASSIGN
BANNER_USERS_SPLIT
     12515**DCL     14052<<ASSIGN  14140>>IF      14164<<ASSIGN
BANNER_VEC
     12473**DCL     13857<<ASSIGN  13858<<ASSIGN  13859<>CALL
BASE$ IN PROCEDURE SEPERATE_BANNER_USERS
     14139**DCL     14144<<ASSIGN  14154>>ASSIGN
BLK$
     12475**DCL     13202<<ASSIGN  13218>>IF      13237>>IF      13250>>IF      13372<<ASSIGN  13374>>ASSIGN
     13385<<ASSIGN  13386>>CALLBLT 13404>>ASSIGN  13457<<ASSIGN  13459>>ASSIGN  13477<<ASSIGN  13478>>CALLBLT
     13505>>ASSIGN  13517<<ASSIGN  13519>>IF      13519>>IF      13525>>IF      13528>>IF      13531>>IF
     13531>>IF      13539>>DOWHILE 13540>>ASSIGN  13545>>ASSIGN  13558>>ASSIGN  13575>>ASSIGN  13589>>ASSIGN
     13601>>IF      13601>>IF      13606>>IF      13608>>IF      13611>>DOCASE  13623>>IF      13623>>IF
     13665>>IF      13665>>IF      13666>>ASSIGN  13710>>ASSIGN  13754<<ASSIGN  13754>>ASSIGN  13755>>ASSIGN
     13773>>IF      13775>>ASSIGN  13782>>IF      13784>>IF      13914<<ASSIGN  13915>>ASSIGN  13995>>ASSIGN
     14009<<ASSIGN  14011>>DOINDEX 14012>>ASSIGN
CAMR_REC.ACSVEH_
      9313**DCL      9314--REDEF
CAMR_REC.ALTKEYS_
      9319**DCL      9320--REDEF    9320--REDEF
CAMR_REC.HDR_
      9318**DCL      9319--REDEF
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:208  
CAMR_REC.TAB_
      9317**DCL      9318--REDEF
CAMR_REC.UHL_
      9311**DCL      9312--REDEF    9312--REDEF
CAMR_REC.V.FSN#
      9351**DCL      9351--REDEF    9351--REDEF
CAMR_REC.WSN_
      9317**DCL      9317--REDEF
CFPT_CLOSE.SN_
      8155**DCL      8155--REDEF
CFPT_CLOSE.UTL_
      8156**DCL      8156--REDEF
CFPT_CLOSE.V.EXPIRE#
      8170**DCL      8170--REDEF
CFPT_CLOSE.V.TYPE#
      8168**DCL      8168--REDEF
CFPT_CLOSE.V.XTNSIZE#
      8165**DCL      8165--REDEF    8167--REDEF
CFPT_DELREC
      8363**DCL     13715>>ASSIGN
CFPT_OPEN.ACSVEH_
      8090**DCL      8091--REDEF
CFPT_OPEN.ALTKEYS_
      8096**DCL      8097--REDEF    8097--REDEF
CFPT_OPEN.HDR_
      8095**DCL      8096--REDEF
CFPT_OPEN.TAB_
      8094**DCL      8095--REDEF
CFPT_OPEN.UHL_
      8088**DCL      8089--REDEF    8089--REDEF
CFPT_OPEN.V.FSN#
      8128**DCL      8128--REDEF    8128--REDEF
CFPT_OPEN.WSN_
      8094**DCL      8094--REDEF
CFPT_PRECORD
      8342**DCL     13637>>ASSIGN
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:209  
CFPT_READ
      8191**DCL     13643>>ASSIGN
CFPT_READ.STATION_
      8194**DCL      8195--REDEF
CFPT_READ.V.DVBYTE.REREAD#
      8206**DCL      8206--REDEF
CFPT_READ.V.INDX#
      8204**DCL      8204--REDEF
CFPT_READUC.STATION_
      8564**DCL      8565--REDEF
CFPT_READUC.V.DVBYTE.REREAD#
      8576**DCL      8576--REDEF
CFPT_READUC.V.INDX#
      8574**DCL      8574--REDEF
CFPT_REW
      9485**DCL     13956>>ASSIGN
CFPT_TRTN.V.IR#
      8800**DCL      8801--REDEF
CFPT_WRITE.STATION_
      8232**DCL      8232--REDEF
CFPT_WRITE.V.DVBYTE.VFC#
      8239**DCL      8239--REDEF
CFPT_WRITEUC.STATION_
      8532**DCL      8532--REDEF
CFPT_WRITEUC.V.DVBYTE.VFC#
      8539**DCL      8539--REDEF
CFPT_XXX.V.STEPCC#
      9512**DCL      9512--REDEF
CGETCMD.OUT$
      9533**DCL      9539--REDEF
CHANGED
     12510**DCL     13211<>CALL    13322<>CALL    13323>>IF
CHK_WHEN_ALT
     13414**LABEL   13322--CALLALT 13329--CALLALT 13337--CALLALT 13361--CALLALT 13367--GOTO    13402--GOTO
     13406--GOTO
CHK_WHEN_NON_NUMERIC
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:210  
     13404**LABEL   13380--CALLALT
CHK_WHEN_RET
     13394**LABEL   13334--GOTO    13383--GOTO
CK_WHEN
     11210**DCL     13248>>ASSIGN  13335>>ASSIGN
CLOSE_BOTH_DCB_ALT IN PROCEDURE LET_COMMAND
     13879**LABEL   13763--GOTO    13834--CALLALT
CLOSE_ERR IN PROCEDURE CLOSE_IBEX_DCB
     14296**LABEL   14294--CALLALT
CLOSE_ERR IN PROCEDURE REOPEN_CS
     14284**LABEL   14282--CALLALT
CLOSE_IBEX_DCB
     14289**PROC    13294--CALL    13314--CALL    13395--CALL    13417--CALL    13433--CALL    13453--CALL
     13765--CALL    13830--CALL    13882--CALL    14066--CALL    14075--CALL    14094--CALL
CLOSE_M$IBEX1_ALT IN PROCEDURE LET_COMMAND
     13882**LABEL   13819--GOTO    13832--CALLALT 13859--CALLALT
CMD_SOURCE
     12505**DCL     13361<>CALL    13384<>CALL
COMMON_CODE IN PROCEDURE LIST_BANNERTEXT
     14222**LABEL   14213--GOTO
CP$BUFF
     12225**DCL     13932>>ASSIGN  13964<<ASSIGN  13965--ASSIGN  13977>>IF      13980>>CALLBLT 13981>>CALLBLT
     13983>>IF      13986>>ASSIGN  13994<<ASSIGN
CPA$ECHOCC
     10494**DCL-ENT 13384--CALL
CPA$READCC
     10495**DCL-ENT 13361--CALL
CPB$OPENCS
     10496**DCL-ENT 14284--CALL
CPB$WILDCMPR
     10497**DCL-ENT 13688--CALL
CPC$GETSEG
     10498**DCL-ENT 14038--CALL
CPC$OPEN_LL
     10500**DCL-ENT 13360--CALL
CPC$OPEN_S
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:211  
     10499**DCL-ENT 13221--CALL    13234--CALL    13329--CALL    13600--CALL    13711--CALL    13753--CALL
CPC$RDUSERS
     10501**DCL-ENT 13832--CALL    14067--CALL
CPC$RELSEG
     10502**DCL-ENT 13394--CALL    13414--CALL    13430--CALL    13443--CALL
CPC$WRITEMSGE
     10503**DCL-ENT 13298--CALL    13440--CALL    13818--CALL    13868--CALL    13889--CALL    14057--CALL
CPC$WRUSERS
     10504**DCL-ENT 13834--CALL
CPD$SYNTAX
     10505**DCL-ENT 13371--CALL
CPE$LISTOUT
     10506**DCL-ENT 13679--CALL    13696--CALL    13703--CALL    14022--CALL    14254--CALL    14269--CALL
CPG$BREAK_IN_EVAL
     13440**LABEL   13171--REMEMBR 13182--REMEMBR 13193--REMEMBR
CPG$FUN$$
     10507**DCL-ENT 13354--ASSIGN  14046--ASSIGN
CPG$GET_WHEN_CNTL_REC
     10508**DCL-ENT 13211--CALL    13322--CALL
CPG$PUT_WHEN_CNTL_REC
     10509**DCL-ENT 13289--CALL    13325--CALL
CPJ$READ_S
     10510**DCL-ENT 13253--CALL    13337--CALL    14086--CALL
CPJ$WRITE_S
     10511**DCL-ENT 13284--CALL    13859--CALL
CPOS
     12500**DCL     13399<<ASSIGN  13401<>CALL    13404<<ASSIGN  13405<>CALL    13500<<ASSIGN  13502<>CALL
     13505<<ASSIGN  13506<>CALL    13558<<ASSIGN  13559<>CALL    13575<<ASSIGN  13576<>CALL    13589<<ASSIGN
     13590<>CALL    13734<<ASSIGN  13735<>CALL    13900<<ASSIGN  13902<>CALL    13905<<ASSIGN  13906<>CALL
     13981<<CALLBLT 13983>>IF      13983>>IF      14028<<ASSIGN  14030<>CALL
CSLEV
     12506**DCL     13241<<ASSIGN  13246<<ASSIGN  13249>>ASSIGN  13287>>ASSIGN  13288>>ASSIGN  13291>>IF
CVLP_TRMCTL.BREAKCOUNT
      9124**DCL      9125--REDEF
CVLP_WINDOW.FWINDOW#
      9220**DCL      9220--REDEF    9221--REDEF
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:212  
CWHEN_CNTL_REC
     11228**DCL     13223>>ASSIGN
CXP$POSTERR
     10512**DCL-ENT 13305--CALL    13366--CALL    13401--CALL    13405--CALL    13409--CALL    13502--CALL
     13506--CALL    13559--CALL    13576--CALL    13735--CALL    13762--CALL    13790--CALL    13803--CALL
     13863--CALL    13874--CALL    13902--CALL    13906--CALL    13925--CALL    13996--CALL    14000--CALL
     14030--CALL
CXUE_ECB
     11250**DCL     14042>>ASSIGN
DCB# IN PROCEDURE CLOSE_IBEX_DCB
     14291**DCL     14289--PROC    14292>>ASSIGN
DUMMY
     12496**DCL     13981<<CALLBLT
DUMMY$CHAR
     12227**DCL     13386<<CALLBLT 13387>>CALLBLT 13478<<CALLBLT 13485>>CALLBLT 13491>>ASSIGN
END_LOOP IN PROCEDURE LET_COMMAND
     13593**LABEL   13585--GOTO
E_BADBANNERTEXT0
     12895**DCL     13790<>CALL
E_BANNER_ROUTINE IN PROCEDURE LET_COMMAND
     13863**LABEL   13753--CALLALT
E_CHK_WHEN_EVAL
     13399**LABEL   13375--CALLALT
E_CSINT
     13075**DCL     13440<>CALL
E_EVAL IN PROCEDURE IF_COMMAND
     13499**LABEL   13461--CALLALT
E_ILLBANNERTEXTLEN
     12940**DCL     13803<>CALL
E_ILLEXP
     12805**DCL     13405<>CALL    13506<>CALL
E_ILLGOTO
     12534**DCL     13925<>CALL
E_LET IN PROCEDURE LET_COMMAND
     13899**LABEL   13547--CALLALT 13590--CALLALT 13777--CALLALT
E_MLBL
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:213  
     12579**DCL     13996<>CALL
E_MSCOMVAR
     12715**DCL     13735<>CALL
E_NONDECIMAL
     12850**DCL     13906<>CALL
E_NOROOM4BANNERTEXT
     13030**DCL     13889<>CALL
E_NOWHEN
     13120**DCL     13305<>CALL    13366<>CALL
E_OUTPUT IN PROCEDURE OUTPUT_COMMAND
     14027**LABEL   14014--CALLALT
E_PMME IN PROCEDURE GOTO_COMMAND
     14000**LABEL   13959--CALLALT 13974--GOTO
E_PMME IN PROCEDURE LET_COMMAND
     13874**LABEL   13659--GOTO    13711--CALLALT 13742--CALLALT
E_READ IN PROCEDURE GOTO_COMMAND
     13970**LABEL   13967--CALLALT
E_READONLYLET
     12624**DCL     13559<>CALL
E_ROUTINE IN PROCEDURE LET_COMMAND
     13868**LABEL   13600--CALLALT
E_SETUP IN PROCEDURE SETUP
     14057**LABEL   14038--CALLALT
E_SYNTAX
     13409**LABEL   13371--CALLALT
E_UNALTBANNERTEXT
     12985**DCL     13818<>CALL
E_XBIG511
     12670**DCL     13576<>CALL
F$DCB.ACTPOS
     11690**DCL     11690--REDEF
F$DCB.ARS#
     11664**DCL     11664--REDEF   13339>>ASSIGN  13698>>CALLBLT 13701>>ASSIGN  13847>>ASSIGN  13987>>ASSIGN
F$DCB.ATTR
     11683**DCL     11684--REDEF
F$DCB.BORROW
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:214  
     11698**DCL     11698--REDEF   11698--REDEF   11698--REDEF
F$DCB.DCBNAME.L
     11712**DCL     11712--IMP-SIZ
F$DCB.DDEV.IC#
     11670**DCL     13922>>IF
F$DCB.DVBYTE.TOP#
     11667**DCL     13948>>IF
F$DCB.EOMCHAR#
     11668**DCL     11668--REDEF
F$DCB.FCD#
     11677**DCL     13415>>IF      13431>>IF      13451>>IF
F$DCB.FLDID
     11693**DCL     11693--REDEF
F$DCB.FORM$
     11687**DCL     11687--REDEF
F$DCB.FSECT
     11703**DCL     11703--REDEF
F$DCB.FSN#
     11680**DCL     11680--REDEF   11680--REDEF   11681--REDEF
F$DCB.HEADER$
     11686**DCL     11686--REDEF
F$DCB.IXTNSIZE#
     11684**DCL     11684--REDEF
F$DCB.LASTSTA$
     11673**DCL     11673--REDEF
F$DCB.LVL
     11699**DCL     11699--REDEF
F$DCB.NAME#.C
     11674**DCL     11674--REDEF
F$DCB.NOEOF
     11696**DCL     11696--REDEF
F$DCB.NRECS#
     11685**DCL     11685--REDEF
F$DCB.NRECX
     11704**DCL     11704--REDEF
F$DCB.OHDR
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:215  
     11696**DCL     11696--REDEF
F$DCB.ORG#
     11679**DCL     11679--REDEF
F$DCB.PRECNO
     11702**DCL     11702--REDEF
F$DCB.RCSZ
     11708**DCL     11708--REDEF
F$DCB.RES#
     11675**DCL     11675--REDEF
F$DCB.SETX
     11687**DCL     11687--REDEF
F$DCB.TAB$
     11687**DCL     11687--REDEF
F$DCB.TDA
     11701**DCL     11702--REDEF
F$DCB.WSN#
     11675**DCL     11675--REDEF
F1_TEXT
     12484**DCL     13818<>CALL    13889<>CALL
F1_TEXT.CNT
     12485**DCL     13816<<ASSIGN  13887<<ASSIGN
F1_TEXT.TXT
     12486**DCL     13817<<CALLBLT 13888<<CALLBLT 14261<<CALLBLT 14262>>CALLBLT
FKEY
     11173**DCL     13639--ASSIGN  13741--ASSIGN
FPT$CLOSE
     10582**DCL     14282<>CALL    14294<>CALL
FPT$CLOSE.SN_
     10582**DCL     10582--REDEF
FPT$CLOSE.UTL_
     10583**DCL     10583--REDEF
FPT$CLOSE.V.DCB#
     10588**DCL     14280<<ASSIGN  14292<<ASSIGN
FPT$CLOSE.V.DISP#
     10591**DCL     14281<<ASSIGN  14293<<ASSIGN
FPT$CLOSE.V.EXPIRE#
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:216  
     10597**DCL     10597--REDEF
FPT$CLOSE.V.TYPE#
     10595**DCL     10595--REDEF
FPT$CLOSE.V.XTNSIZE#
     10592**DCL     10592--REDEF   10594--REDEF
FPT$READCC
     11145**DCL     13967<>CALL
FPT$READCC.BUF_
     11147**DCL     13965<<ASSIGN
FPT$READCC.STATION_
     11148**DCL     11149--REDEF
FPT$READCC.V.DCB#
     11149**DCL     13966<<ASSIGN
FPT$READCC.V.DVBYTE.REREAD#
     11160**DCL     11160--REDEF
FPT$READCC.V.INDX#
     11158**DCL     11158--REDEF
FPT$WRITE.BUF_
     10712**DCL     13650<<ASSIGN  14018<<ASSIGN  14020<<ASSIGN  14222<<ASSIGN
FPT$WRITE.BUF_.BOUND
     10712**DCL     13678<<ASSIGN  13695<<ASSIGN  13701<<ASSIGN  14253<<ASSIGN  14268<<ASSIGN
FPT$WRITE.STATION_
     10714**DCL     10714--REDEF
FPT$WRITE.V.DVBYTE.VFC#
     10721**DCL     10721--REDEF
FPT_CLOSE.SN_
     10540**DCL     10540--REDEF
FPT_CLOSE.UTL_
     10541**DCL     10541--REDEF
FPT_CLOSE.V.EXPIRE#
     10555**DCL     10555--REDEF
FPT_CLOSE.V.TYPE#
     10553**DCL     10553--REDEF
FPT_CLOSE.V.XTNSIZE#
     10550**DCL     10550--REDEF   10552--REDEF
FPT_DELREC
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:217  
     10612**DCL     13715<<ASSIGN  13728<>CALL    13742<>CALL
FPT_DELREC.KEY_
     10612**DCL     13718<<ASSIGN  13741<<ASSIGN
FPT_DELREC.LKEY_
     10614**DCL     13740<<ASSIGN
FPT_DELREC.V
     10615**DCL     13716--ASSIGN
FPT_DELREC.V.DCB#
     10616**DCL     13717<<ASSIGN
FPT_DELREC.V_
     10612**DCL     13716<<ASSIGN
FPT_PRECORD
     10631**DCL     13637<<ASSIGN  13655<>CALL
FPT_PRECORD.KEY_
     10631**DCL     13639<<ASSIGN
FPT_PRECORD.V
     10633**DCL     13638--ASSIGN
FPT_PRECORD.V.DCB#
     10633**DCL     13640<<ASSIGN
FPT_PRECORD.V.KEYS#
     10634**DCL     13641<<ASSIGN
FPT_PRECORD.V_
     10631**DCL     13638<<ASSIGN
FPT_READ
     10658**DCL     13643<<ASSIGN  13668<>CALL
FPT_READ.BUF_
     10660**DCL     13648<<ASSIGN
FPT_READ.KEY_
     10658**DCL     13647<<ASSIGN
FPT_READ.STATION_
     10661**DCL     10662--REDEF
FPT_READ.V
     10662**DCL     13644--ASSIGN
FPT_READ.V.DCB#
     10662**DCL     13645<<ASSIGN
FPT_READ.V.DVBYTE.REREAD#
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:218  
     10673**DCL     10673--REDEF
FPT_READ.V.INDX#
     10671**DCL     10671--REDEF
FPT_READ.V.KEYR#
     10663**DCL     13646<<ASSIGN
FPT_READ.V_
     10658**DCL     13644<<ASSIGN
FPT_REW
     10691**DCL     13956<<ASSIGN  13959<>CALL
FPT_REW.V
     10691**DCL     13957--ASSIGN
FPT_REW.V.DCB#
     10691**DCL     13958<<ASSIGN
FPT_REW.V_
     10691**DCL     13957<<ASSIGN
FS$BANNER
     12240**DCL     14178--ASSIGN
FS$BANNER.PERM
     12241**DCL     12242--REDEF   13813>>IF      14122>>IF
FS$BANNER.TEXT_OFF
     12244**DCL     13838>>IF      13841>>ASSIGN  13846>>ASSIGN  14110>>IF      14118>>ASSIGN  14183<<ASSIGN
     14186<<ASSIGN
GET$CMD
     11821**DCL     13361<>CALL    13371<>CALL
GET$CMD.ALWAYS_SET_PROMPT#
     11909**DCL     13429<<ASSIGN  13449<<ASSIGN
GET$CMD.CONTINUE_OK#
     11885**DCL     13353<<ASSIGN
GET$CMD.ERR#
     11832**DCL     13409<>CALL
GET$CMD.INDCB#
     11992**DCL     13966>>ASSIGN
GET$CMD.NLINES
     12137**DCL     13479>>ASSIGN
GET$CMD.NODES$
     11822**DCL     13352<<ASSIGN
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:219  
GET$CMD.OUT$
     11826**DCL     11832--REDEF   13363>>IF      13372>>ASSIGN
GET$CMD.PCB$
     11846**DCL     13351<<ASSIGN
GET$CMD.PP_FUN$$
     12039**DCL     13354<<ASSIGN
GET$CMD.RCVD_PROMPT#
     11891**DCL     13481>>IF
GET$CMD.RLT$
     12103**DCL     13479>>ASSIGN
GET$CMD.SFROUTINE$
     12071**DCL     13355<<ASSIGN
GET$CMD.TEXT_
     12084**DCL     13358<<ASSIGN  13359<<ASSIGN
GET_BANNER_RECORD
     14079**PROC    13812--CALL    14237--CALL
GET_BANNER_USERS
     14061**PROC    13759--CALL    14228--CALL
GET_WHEN_CNTL_REC_ERR
     13298**LABEL   13211--CALLALT 13221--CALLALT 13234--CALLALT
GOTO_COMMAND
     13910**PROC    13161--CALL
GOT_BANNERTEXT_REC
     12514**DCL     14051<<ASSIGN  14081>>IF      14088<<ASSIGN  14235>>IF
I
     12503**DCL     13226<<DOINDEX 13227>>ASSIGN  13228>>ASSIGN  13347<<DOINDEX 13348>>ASSIGN
I IN PROCEDURE LIST_BANNERTEXT
     14205**DCL     14255<<DOINDEX 14258>>IF      14261>>CALLBLT 14264>>IF      14267>>CALLBLT 14268>>ASSIGN
I IN PROCEDURE REBUILD_BANNER
     14173**DCL     14180<<DOINDEX 14181>>IF      14183>>ASSIGN  14186>>ASSIGN  14187>>ASSIGN  14188>>ASSIGN
I IN PROCEDURE SEPERATE_BANNER_STAR
     14103**DCL     14109<<DOINDEX 14110>>IF      14113>>ASSIGN  14114>>ASSIGN  14118>>ASSIGN  14119>>ASSIGN
     14120>>ASSIGN  14122>>IF      14124>>ASSIGN  14126>>ASSIGN
I IN PROCEDURE SEPERATE_BANNER_USERS
     14137**DCL     14145<<DOINDEX 14146>>IF      14149>>ASSIGN  14150>>ASSIGN  14154>>ASSIGN  14155>>ASSIGN
     14156>>ASSIGN  14158>>IF      14160>>ASSIGN  14162>>ASSIGN
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:220  
IBEX_CMD
     12504**DCL     13352--ASSIGN
IBEX_NAME
      8982**DCL     14047--ASSIGN
IF_COMMAND
     13456**PROC    13172--CALL
INDX1
     12497**DCL     13538<<ASSIGN  13539>>DOWHILE 13540>>ASSIGN  13541<<ASSIGN  13541>>ASSIGN  13545>>ASSIGN
     13558>>ASSIGN  13575>>ASSIGN  13589>>ASSIGN  13593<<ASSIGN  13593>>ASSIGN  13725<<DOINDEX 13726>>ASSIGN
     13727>>CALLBLT 13727>>CALLBLT 13734>>ASSIGN  13980<<CALLBLT 13981>>CALLBLT 13983>>IF      13995<<ASSIGN
     13996<>CALL    14011<<DOINDEX 14012>>ASSIGN
KEY
     11167**DCL     13647--ASSIGN  13718--ASSIGN  13859--CALL    14086--CALL
KEY.L
     11168**DCL     13669>>IF      13686>>ASSIGN  13701>>ASSIGN  13726<<ASSIGN  14084<<ASSIGN
KEY.N
     11169**DCL     13669>>IF      13687>>ASSIGN  13727<<CALLBLT 14085<<ASSIGN
KEY_VAR
     11170**DCL     13688<>CALL
KEY_VAR.L
     11171**DCL     13686<<ASSIGN  13698>>CALLBLT
KEY_VAR.N
     11172**DCL     13687<<ASSIGN  13698>>CALLBLT
K_WHEN
     11192**DCL     13248<<ASSIGN  13253--CALL    13284--CALL    13335<<ASSIGN  13337--CALL
K_WHEN.NUM
     11195**DCL     13249<<ASSIGN  13336<<ASSIGN
LAST IN PROCEDURE LIST_BANNERTEXT
     14204**DCL     14212<<ASSIGN  14219<<ASSIGN  14255>>DOINDEX
LEFTPOS
     12507**DCL     13261<<CALLBLT 13262>>CALLBLT 13266>>CALLBLT 13273>>CALLBLT 13277>>ASSIGN
LET_BANNERTEXT IN PROCEDURE LET_COMMAND
     13753**LABEL   13530--GOTO
LET_COMMAND
     13510**PROC    13183--CALL
LET_DELETE IN PROCEDURE LET_COMMAND
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:221  
     13710**LABEL   13527--GOTO
LET_LIST IN PROCEDURE LET_COMMAND
     13600**LABEL   13524--GOTO    13534--GOTO
LIST_BANNERTEXT
     14201**PROC    13614--CALL    13628--CALL    13631--CALL
LIST_BANNER_ERR IN PROCEDURE LIST_BANNERTEXT
     14275**LABEL   14228--CALLALT 14229--CALLALT 14237--CALLALT 14238--CALLALT
LIST_REGISTERNAME IN PROCEDURE LIST_BANNERTEXT
     14215**ENTRY   13617--CALL    13627--CALL    13630--CALL
LKEY
     11176**DCL     13740--ASSIGN
M$CLOSE
      1402**DCL-ENT 14282--CALL    14294--CALL
M$DELREC
      1404**DCL-ENT 13728--CALL    13742--CALL
M$IBEX1_NUM
     10280**DCL     13221<>CALL    13234<>CALL    13253<>CALL    13284<>CALL    13294<>CALL    13298<>CALL
     13314<>CALL    13329<>CALL    13337<>CALL    13339--ASSIGN  13395<>CALL    13415--IF      13417<>CALL
     13431--IF      13433<>CALL    13451--IF      13453<>CALL    13600<>CALL    13640>>ASSIGN  13645>>ASSIGN
     13698--CALLBLT 13701--ASSIGN  13711<>CALL    13717>>ASSIGN  13753<>CALL    13760<>CALL    13765<>CALL
     13818<>CALL    13847--ASSIGN  13859<>CALL    13868<>CALL    13882<>CALL    13889<>CALL    14045>>ASSIGN
     14075<>CALL    14086<>CALL    14094<>CALL
M$IBEX_NUM
     10279**DCL     13830<>CALL    13832<>CALL    13834<>CALL    13922--IF      13948--IF      13958>>ASSIGN
     13987--ASSIGN  14066<>CALL    14067<>CALL    14280>>ASSIGN
M$PRECORD
      1406**DCL-ENT 13655--CALL
M$READ
      1403**DCL-ENT 13668--CALL    13967--CALL
M$REW
      1405**DCL-ENT 13959--CALL
MOV$STR.CNT
     12430**DCL     12431--IMP-SIZ 14119>>ASSIGN  14120>>ASSIGN  14155>>ASSIGN  14156>>ASSIGN  14187<<ASSIGN
     14188>>ASSIGN  14189>>ASSIGN
MOV$STR.TXT
     12431**DCL     14119>>ASSIGN  14155>>ASSIGN  14188<<ASSIGN
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:222  
MSING_LABEL IN PROCEDURE GOTO_COMMAND
     13994**LABEL   13962--GOTO
MS_COMVAR IN PROCEDURE LET_COMMAND
     13734**LABEL   13728--CALLALT
NAME$
     12476**DCL     13540<<ASSIGN  13552>>CALLBLT 13552>>CALLBLT 13590>>CALL    13710<<ASSIGN  13723>>IF
     13725>>DOINDEX 13726>>ASSIGN  13727>>CALLBLT 13727>>CALLBLT 13734>>ASSIGN  13905>>ASSIGN  13915<<ASSIGN
     13983>>IF      13983>>IF
NIL_TXTC
     12483**DCL     13772--ASSIGN
NON_NUMERIC IN PROCEDURE IF_COMMAND
     13505**LABEL   13467--CALLALT
NON_NUMERIC IN PROCEDURE LET_COMMAND
     13905**LABEL   13571--CALLALT
NOT_EQUAL IN PROCEDURE LET_COMMAND
     13852**LABEL   13840--GOTO
OFFSET IN PROCEDURE REBUILD_BANNER
     14175**DCL     14178<<ASSIGN  14179>>ASSIGN  14186>>ASSIGN  14190<<ASSIGN  14190>>ASSIGN  14195>>ASSIGN
OUTPUT_COMMAND
     14005**PROC    13194--CALL
OUTPUT_WHENCMD
     13283**LABEL   13268--GOTO
P$B.CODE
     11739**DCL     13218>>IF      13237>>IF      13250>>IF      13363>>IF      13519>>IF      13525>>IF
     13528>>IF      13531>>IF      13531>>IF      13601>>IF      13601>>IF      13608>>IF      13611>>DOCASE
     13623>>IF      13623>>IF      13665>>IF      13755>>ASSIGN  13784>>IF
P$B.CPOS
     11757**DCL     13386>>CALLBLT 13478>>CALLBLT 13734>>ASSIGN  13995>>ASSIGN
P$B.NSUBLKS
     11743**DCL     13519>>IF      13539>>DOWHILE 13606>>IF      13665>>IF      13723>>IF      13725>>DOINDEX
     13773>>IF      13782>>IF      14011>>DOINDEX
P$B.SUBLK$
     11764**DCL     13374>>ASSIGN  13385>>ASSIGN  13404>>ASSIGN  13459>>ASSIGN  13477>>ASSIGN  13505>>ASSIGN
     13525>>IF      13528>>IF      13540>>ASSIGN  13545>>ASSIGN  13558>>ASSIGN  13575>>ASSIGN  13589>>ASSIGN
     13608>>IF      13666>>ASSIGN  13710>>ASSIGN  13726>>ASSIGN  13727>>CALLBLT 13727>>CALLBLT 13734>>ASSIGN
     13754>>ASSIGN  13755>>ASSIGN  13775>>ASSIGN  13784>>IF      13915>>ASSIGN  13995>>ASSIGN  14012>>ASSIGN
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:223  
P$PCB
     10745**DCL        15--PROC    13157--ENTRY   13167--ENTRY   13178--ENTRY   13189--ENTRY   13200--ENTRY
     13320--ENTRY   13351--ASSIGN
P$PCB.HI_CHAR
     10896**DCL     13409<>CALL    13470<<ASSIGN
P$PCB.NCHARS
     10892**DCL     13257>>ASSIGN  13370>>ASSIGN  13387>>CALLBLT 13388>>ASSIGN  13480>>ASSIGN
P$PCB.OUT$
     10758**DCL     13202>>ASSIGN  13385>>ASSIGN  13457>>ASSIGN  13477>>ASSIGN  13517>>ASSIGN  13914>>ASSIGN
     14009>>ASSIGN
P$PCB.TEXT$
     10746**DCL     13261>>CALLBLT 13262>>CALLBLT 13263>>IF      13266>>CALLBLT 13270>>IF      13273>>CALLBLT
     13273>>CALLBLT 13280>>CALLBLT 13386>>CALLBLT 13387>>CALLBLT 13478>>CALLBLT 13480>>ASSIGN
P$PCB.USER$
     10912**DCL     13350<<ASSIGN
P$S.COUNT
     11800**DCL     11803--IMP-SIZ 13552>>CALLBLT 13726>>ASSIGN  13727>>CALLBLT
P$S.CPOS
     11792**DCL     13404>>ASSIGN  13505>>ASSIGN  13558>>ASSIGN  13575>>ASSIGN  13589>>ASSIGN  13905>>ASSIGN
P$S.TEXT
     11803**DCL     13552>>CALLBLT 13727>>CALLBLT
P$S.TEXTC$
     11795**DCL     13590<>CALL    13666>>ASSIGN  13915>>ASSIGN
PERM
     12513**DCL     13605<<ASSIGN  13610<<ASSIGN  13626<<ASSIGN  13629<<ASSIGN  13781<<ASSIGN  13786<<ASSIGN
     13827>>IF      14223>>IF
PINCR IN PROCEDURE REBUILD_BANNER
     14176**DCL     14189<<ASSIGN  14190>>ASSIGN  14191>>ASSIGN
PRINT_HDR#
     12511**DCL     13651<<ASSIGN  13674>>IF      13690>>IF      13693<<ASSIGN
RDUSERS_ERR IN PROCEDURE GET_BANNER_USERS
     14074**LABEL   14067--CALLALT
READ IN PROCEDURE GOTO_COMMAND
     13948**LABEL   13972--GOTO    13979--GOTO    13980--CALLALT 13981--CALLALT
READ_S_ERR IN PROCEDURE GET_BANNER_RECORD
     14094**LABEL   14086--CALLALT
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:224  
REBUILD_BANNER
     14169**PROC    13855--CALL
REMEM$VAR
     12520**DCL     13171<<REMEMBR 13182<<REMEMBR 13193<<REMEMBR
REOPEN_CS
     14278**PROC    13620--CALL    13632--CALL    13766--CALL    13835--CALL    13860--CALL    13864--CALL
     13879--CALL    14068--CALL    14074--CALL
RIGHTPOS
     12508**DCL     13262<<CALLBLT 13263>>IF      13270>>IF      13272<<ASSIGN  13272>>ASSIGN  13273>>CALLBLT
     13273>>CALLBLT 13277>>ASSIGN
RLT
     12149**DCL     13479>>ASSIGN
SAVE_VARIABLES
     13427**LABEL   13173--GOTO    13184--GOTO    13195--GOTO
SECOND_PASS#
     12512**DCL     13931<<ASSIGN  13952>>IF      13955<<ASSIGN
SEG$2.CPBUFF$
     12198**DCL     13932>>ASSIGN  13964>>ASSIGN  13965>>ASSIGN  13977>>IF      13980>>CALLBLT 13981>>CALLBLT
     13983>>IF      13986>>ASSIGN  13994>>ASSIGN
SEG$2.ERRBUF
     12179**DCL     13303<<ASSIGN  13305--CALL    13340--ASSIGN  13366--CALL    13401--CALL    13405--CALL
     13409--CALL    13502--CALL    13506--CALL    13559--CALL    13576--CALL    13735--CALL    13744>>IF
     13762--CALL    13790--CALL    13803--CALL    13863--CALL    13874--CALL    13902--CALL    13906--CALL
     13925--CALL    13996--CALL    14000--CALL    14030--CALL
SEG$2.FLAGS.CONTINUED
     12163**DCL     13357<<ASSIGN
SEG$2.FLAGS.USERS
     12156**DCL     13831<<ASSIGN  14063>>IF      14226>>IF
SEG$2.FLAGS.USE_CCBUF_IF_YC
     12170**DCL     13495<<ASSIGN
SEG$2.FLAGS.USE_REMEM
     12169**DCL     13441<<ASSIGN  13460<<ASSIGN  13462<<ASSIGN  13499<<ASSIGN  13546<<ASSIGN  13548<<ASSIGN
     13776<<ASSIGN  13778<<ASSIGN  13899<<ASSIGN  14013<<ASSIGN  14015<<ASSIGN  14027<<ASSIGN
SEG$2.FPT_CLOSE$
     12192**DCL     14280>>ASSIGN  14281>>ASSIGN  14282>>CALL    14292>>ASSIGN  14293>>ASSIGN  14294>>CALL
SEG$2.FPT_READCC$
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:225  
     12189**DCL     13965>>ASSIGN  13966>>ASSIGN  13967>>CALL
SEG$2.FPT_WRITECC$
     12190**DCL     13650>>ASSIGN  13678>>ASSIGN  13679<>CALL    13695>>ASSIGN  13696<>CALL    13701>>ASSIGN
     13703<>CALL    14018>>ASSIGN  14020>>ASSIGN  14022<>CALL    14222>>ASSIGN  14253>>ASSIGN  14254<>CALL
     14268>>ASSIGN  14269<>CALL
SEG$2.GETCMD$
     12200**DCL     13345>>ASSIGN  13351>>ASSIGN  13352>>ASSIGN  13353>>ASSIGN  13354>>ASSIGN  13355>>ASSIGN
     13358>>ASSIGN  13359>>ASSIGN  13361>>CALL    13363>>IF      13371>>CALL    13372>>ASSIGN  13409>>CALL
     13429>>ASSIGN  13449>>ASSIGN  13479>>ASSIGN  13479>>ASSIGN  13481>>IF      13966>>ASSIGN
SEG$2.NCHARS
     12175**DCL     13370<<ASSIGN
SEG$2.REMEM$
     12201**DCL     13171>>REMEMBR 13182>>REMEMBR 13193>>REMEMBR
SEG$2.USERS$
     12183**DCL     13760<>CALL    13833<>CALL    14144>>ASSIGN  14146>>IF      14154>>ASSIGN  14158>>IF
SEG$2.WHEN_CNTL_REC$
     12202**DCL     13213>>ASSIGN  13213>>ASSIGN  13223>>ASSIGN  13224>>ASSIGN  13225>>ASSIGN  13227>>ASSIGN
     13228>>ASSIGN  13287>>ASSIGN  13288>>ASSIGN  13336>>ASSIGN
SEG2$
     10267**DCL     12154--IMP-PTR 13171>>REMEMBR 13182>>REMEMBR 13193>>REMEMBR 13213>>ASSIGN  13213>>ASSIGN
     13223>>ASSIGN  13224>>ASSIGN  13225>>ASSIGN  13227>>ASSIGN  13228>>ASSIGN  13287>>ASSIGN  13288>>ASSIGN
     13303>>ASSIGN  13305>>CALL    13336>>ASSIGN  13340>>ASSIGN  13345>>ASSIGN  13351>>ASSIGN  13352>>ASSIGN
     13353>>ASSIGN  13354>>ASSIGN  13355>>ASSIGN  13357>>ASSIGN  13358>>ASSIGN  13359>>ASSIGN  13361>>CALL
     13363>>IF      13366>>CALL    13370>>ASSIGN  13371>>CALL    13372>>ASSIGN  13401>>CALL    13405>>CALL
     13409>>CALL    13409>>CALL    13429>>ASSIGN  13441>>ASSIGN  13449>>ASSIGN  13460>>ASSIGN  13462>>ASSIGN
     13479>>ASSIGN  13479>>ASSIGN  13481>>IF      13495>>ASSIGN  13499>>ASSIGN  13502>>CALL    13506>>CALL
     13546>>ASSIGN  13548>>ASSIGN  13559>>CALL    13576>>CALL    13650>>ASSIGN  13678>>ASSIGN  13679>>CALL
     13695>>ASSIGN  13696>>CALL    13701>>ASSIGN  13703>>CALL    13735>>CALL    13744>>IF      13760>>CALL
     13762>>CALL    13776>>ASSIGN  13778>>ASSIGN  13790>>CALL    13803>>CALL    13831>>ASSIGN  13833>>CALL
     13863>>CALL    13874>>CALL    13899>>ASSIGN  13902>>CALL    13906>>CALL    13925>>CALL    13932>>ASSIGN
     13964>>ASSIGN  13965>>ASSIGN  13965>>ASSIGN  13966>>ASSIGN  13966>>ASSIGN  13967>>CALL    13977>>IF
     13980>>CALLBLT 13981>>CALLBLT 13983>>IF      13986>>ASSIGN  13994>>ASSIGN  13996>>CALL    14000>>CALL
     14013>>ASSIGN  14015>>ASSIGN  14018>>ASSIGN  14020>>ASSIGN  14022>>CALL    14027>>ASSIGN  14030>>CALL
     14063>>IF      14144>>ASSIGN  14146>>IF      14154>>ASSIGN  14158>>IF      14222>>ASSIGN  14226>>IF
     14253>>ASSIGN  14254>>CALL    14268>>ASSIGN  14269>>CALL    14280>>ASSIGN  14281>>ASSIGN  14282>>CALL
     14292>>ASSIGN  14293>>ASSIGN  14294>>CALL
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:226  
SEG3$
     10268**DCL     13394<>CALL    13414<>CALL    13430<>CALL    13443<>CALL    13813>>IF      13838>>IF
     13841>>ASSIGN  13841>>ASSIGN  13846>>ASSIGN  13846>>ASSIGN  13857>>ASSIGN  14038<>CALL    14043>>ASSIGN
     14086>>CALL    14108>>ASSIGN  14110>>IF      14118>>ASSIGN  14118>>ASSIGN  14122>>IF      14143>>ASSIGN
     14178>>ASSIGN  14179>>ASSIGN  14183>>ASSIGN  14186>>ASSIGN
SEPERATE_BANNER_STAR
     14099**PROC    13852--CALL    14238--CALL
SEPERATE_BANNER_USERS
     14133**PROC    14229--CALL
SETUP
     14034**PROC    13373--CALL    13458--CALL    13518--CALL    14010--CALL
STARBANNER$BUF
     12223**DCL     13857--ASSIGN  14086--CALL
START IN PROCEDURE LIST_BANNERTEXT
     14203**DCL     14211<<ASSIGN  14218<<ASSIGN  14242>>IF      14255>>DOINDEX
STAR_S_IS_OPEN
     12519**DCL     13207<<ASSIGN  13211<>CALL    13222<<ASSIGN  13231>>IF      13235<<ASSIGN  13289<>CALL
     13322<>CALL    13325<>CALL    13326>>IF      13330<<ASSIGN
SZ IN PROCEDURE LIST_BANNERTEXT
     14206**DCL     14231<<ASSIGN  14240<<ASSIGN  14245>>CALLBLT 14246<<ASSIGN  14246>>ASSIGN  14250>>CALLBLT
     14251<<ASSIGN  14251>>ASSIGN  14253>>ASSIGN
TEMP$ IN PROCEDURE REBUILD_BANNER
     14174**DCL     14179<<ASSIGN  14187>>ASSIGN  14188>>ASSIGN  14188>>ASSIGN  14189>>ASSIGN  14191<<ASSIGN
     14191>>ASSIGN
TEMP$ IN PROCEDURE SEPERATE_BANNER_STAR
     14104**DCL     14118<<ASSIGN  14119>>ASSIGN  14119>>ASSIGN  14120>>ASSIGN
TEMP$ IN PROCEDURE SEPERATE_BANNER_USERS
     14138**DCL     14154<<ASSIGN  14155>>ASSIGN  14155>>ASSIGN  14156>>ASSIGN
TEMPBUF
     12481**DCL     13552<<CALLBLT 13553>>IF      13553>>IF      13553>>IF      13568>>IF      13648--ASSIGN
     13698>>CALLBLT 13932<<ASSIGN  13994>>ASSIGN
TEXT.LENGTH_
     12248**DCL     12249--IMP-SIZ 13842>>IF      13845>>ASSIGN
TEXT.VAL
     12249**DCL     13845<<ASSIGN
TXT#
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:227  
     12501**DCL     13479<<ASSIGN  13480>>ASSIGN  13485>>CALLBLT 13487>>ASSIGN  13491>>ASSIGN  13492>>ASSIGN
     13755<<ASSIGN  13756>>IF      13787>>IF      13813>>IF      13817>>CALLBLT 13833<>CALL    13838>>IF
     13841>>ASSIGN  13846>>ASSIGN  13853>>ASSIGN  13854>>ASSIGN  13888>>CALLBLT
TXT$
     12477**DCL     12219--IMP-PTR 13480<<ASSIGN  13485>>CALLBLT 13491>>ASSIGN  13772<<ASSIGN  13779<<ASSIGN
     13800>>IF      13833>>CALL    13833>>CALL    13842>>IF      13845>>ASSIGN  13845>>ASSIGN  13853>>ASSIGN
     13854>>ASSIGN  13854>>ASSIGN
TXT$C
     12219**DCL     13833<>CALL
TXT$C.SIZ
     12220**DCL     12221--IMP-SIZ 13800>>IF      13833>>CALL    13842>>IF      13845>>ASSIGN  13853>>ASSIGN
     13854>>ASSIGN
TXT$C.TEXT
     12221**DCL     13845>>ASSIGN  13854>>ASSIGN
U$PARAM
     11641**DCL     13350--ASSIGN
U$PARAM.CNTU$$
     11644**DCL     13342<<ASSIGN
U$PARAM.ERRBUF$
     11642**DCL     13340<<ASSIGN
U$PARAM.FID_BLK$
     11650**DCL     13348<<ASSIGN
U$PARAM.FID_CNT
     11649**DCL     13346<<ASSIGN
U$PARAM.GETCMD$
     11651**DCL     13345<<ASSIGN
U$PARAM.MODE
     11648**DCL     13356<<ASSIGN
U$PARAM.REMEM$
     11653**DCL     13343<<ASSIGN
U$PARAM.SPCL$$
     11645**DCL     13344<<ASSIGN
U$PARAM.USERS$
     11643**DCL     13341<<ASSIGN
VALUE
     12499**DCL     13380<>CALL    13381>>IF      13400<<ASSIGN  13401<>CALL    13467<>CALL    13468>>IF
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:228  
     13501<<ASSIGN  13502<>CALL    13571<>CALL    13572>>IF      13584>>ASSIGN  13901<<ASSIGN  13902<>CALL
     14029<<ASSIGN  14030<>CALL
WHEN$CNTL_REC
     12448**DCL     13223<<ASSIGN
WHEN$CNTL_REC.CUR_LEV
     12449**DCL     13213>>ASSIGN  13224<<ASSIGN
WHEN$CNTL_REC.STATE_LEV
     12450**DCL     13213<<ASSIGN  13225<<ASSIGN  13336>>ASSIGN
WHEN$CNTL_REC.WHEN.OPT
     12453**DCL     13227<<ASSIGN  13287<<ASSIGN
WHEN$CNTL_REC.WHEN.REC
     12454**DCL     13228<<ASSIGN  13288<<ASSIGN
WHEN_ALTRET
     13314**LABEL   13284--CALLALT 13289--CALLALT 13300--GOTO    13325--CALLALT
WHEN_LEVEL0
     12518**DCL     13240<<ASSIGN  13245<<ASSIGN  13258>>IF
WHEN_READ_ERR
     13303**LABEL   13220--GOTO    13253--CALLALT
WILD_VAR
     12458**DCL     13688<>CALL
WILD_VAR.SIZ
     12459**DCL     12460--IMP-SIZ 13688>>CALL
WILD_VAR$
     12456**DCL     12458--IMP-PTR 13664<<ASSIGN  13666<<ASSIGN  13688>>CALL    13688>>CALL
WRITEBUF
     12482**DCL     13253--CALL    13266<<CALLBLT 13273<<CALLBLT 13280<<CALLBLT 13284--CALL    13337--CALL
     13358--ASSIGN  13650--ASSIGN  13677<<ASSIGN  13694<<ASSIGN  13698<<CALLBLT 14222--ASSIGN  14230<<ASSIGN
     14239<<ASSIGN  14245<<CALLBLT 14250<<CALLBLT 14257<<ASSIGN  14262<<CALLBLT 14266<<CALLBLT 14267<<CALLBLT
X$DEC_CONVERT
     10514**DCL-ENT 13380--CALL    13467--CALL    13571--CALL
X$EVAL
     10513**DCL-ENT 13375--CALL    13461--CALL    13547--CALL    13777--CALL    14014--CALL
X$PUT_VAR
     10515**DCL-ENT 13590--CALL
X$STRING.SIZ
     12215**DCL     12216--IMP-SIZ 13983>>IF      14016>>IF      14020>>ASSIGN
PL6.E3A0      #001=CPG$IBEX File=CPG$IBEX.:E05TSI                                TUE 07/29/97 11:42 Page:229  
X$STRING.TEXT
     12216**DCL     13983>>IF      14020--ASSIGN
XUE_ECB
     11452**DCL     13375<>CALL    13461<>CALL    13547<>CALL    13590<>CALL    13777<>CALL    14014<>CALL
     14042<<ASSIGN
XUE_ECB.ERR
     11536**DCL     13401<>CALL    13502<>CALL    13902<>CALL    14030<>CALL
XUE_ECB.ERR_DCB#
     11528**DCL     13400>>ASSIGN  13501>>ASSIGN  13901>>ASSIGN  14029>>ASSIGN
XUE_ECB.ERR_POS#
     11519**DCL     13399>>ASSIGN  13500>>ASSIGN  13900>>ASSIGN  14028>>ASSIGN
XUE_ECB.FUN$$
     11491**DCL     14046<<ASSIGN
XUE_ECB.OUT$
     11484**DCL     13380<>CALL    13467<>CALL    13571<>CALL    13590<>CALL    13779>>ASSIGN  14016>>IF
     14020>>ASSIGN  14020>>ASSIGN
XUE_ECB.PROCNAME_
     11551**DCL     14047<<ASSIGN
XUE_ECB.RESULTS.PROMPT#
     11598**DCL     13427>>IF      13447>>IF
XUE_ECB.TREE$
     11456**DCL     13374<<ASSIGN  13459<<ASSIGN  13545<<ASSIGN  13775<<ASSIGN  14012<<ASSIGN
XUE_ECB.WKSZ#
     11467**DCL     14044<<ASSIGN
XUE_ECB.WORK$
     11462**DCL     14043<<ASSIGN
XUE_ECB.WORK_DCB#
     11474**DCL     14045<<ASSIGN
