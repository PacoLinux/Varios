VERSION E05

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:1    
        1        1        /*M* TSC$CHECK - SYNTAX CHECKING AND INTERNAL TABLE BUILDING ROUTINES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        TSC$CHECK: PROC(PCB) ALTRET;
        9        9        /**/
       10       10        /*********************************************************************/
       11       11        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       12       12        /*********************************************************************/
       13       13        /**/
       14       14        %INCLUDE TS_SUBS_C;
       15       95        %INCLUDE TS_PERR_C;
       16      178        %INCLUDE CP_6;
       17      259        %INCLUDE XU_MACRO_C;
       18     3365        %INCLUDE TD$STRUCT;
       19     3466        %INCLUDE IT_SUBS_C;
       20     3733        %INCLUDE NI$TABLES ;
       21     3949        /**/
       22     3950        %SUB YES = '1'B/*YES*/;
       23     3951        %SUB NO = '0'B/*NO*/;
       24     3952        /**/
       25     3953        /*****************************************************************************/
       26     3954        /*   PARAMETER   PARAMETER   PARAMETER   PARAMETER   PARAMETER   PARAMETER   */
       27     3955        /*****************************************************************************/
       28     3956        /**/
       29     3957        %P$PCB (NAME=PCB,STCLASS=" ");
       30     4158        /**/
       31     4159        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:2    
       32     4160        /*****************************************************************/
       33     4161        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
       34     4162        /*****************************************************************/
       35     4163    1   DCL BLK$ PTR SYMREF;
       36     4164    1   DCL CMD$ PTR SYMREF;
       37     4165    1   DCL CMD_BASE$ PTR SYMREF;
       38     4166    1   DCL CONFIG$ PTR SYMREF;
       39     4167    1   DCL SAVEBLK$ PTR;
       40     4168    1   DCL PTR$ PTR;
       41     4169        /**/
       42     4170    1   DCL I SBIN WORD SYMREF;
       43     4171    1   DCL J SBIN WORD SYMREF;
       44     4172    1   DCL K SBIN WORD SYMREF;
       45     4173    1   DCL TEMP UBIN WORD;
       46     4174    1   DCL NUMIOMS SBIN WORD;
       47     4175    1   DCL FEPNAME CHAR(8);
       48     4176    1   DCL TS_DIPART BIT(1) STATIC SYMDEF INIT('0'B);
       49     4177    1   DCL TS_DIREL BIT(1) STATIC SYMDEF INIT('0'B);
       50     4178    1   DCL MPC_CHANS BIT(1);
       51     4179    1   DCL MPC_DEVS BIT(1);
       52     4180    1   DCL MPCNAME CHAR(8);
       53     4181    1   DCL 1 NAME REDEF MPCNAME,
       54     4182    1         2 MNEM CHAR(2),
       55     4183    1         2 NUM CHAR(2),
       56     4184    1         2 TWSN CHAR(4);
       57     4185        /**/
       58     4186    1   DCL 1 CONFIG_KEY SYMREF,
       59     4187    1         2 COUNT UBIN(9) UNAL,
       60     4188    1         2 TEXT CHAR(8) UNAL;
       61     4189        /**/
       62     4190    1   DCL 1 SUB_BUF_1 SYMREF,
       63     4191    1         2 COUNT UBIN(9) UNAL,
       64     4192    1         2 TEXT CHAR(31) UNAL;
       65     4193    1   DCL 1 SUB_BUF_2 SYMREF,
       66     4194    1         2 COUNT UBIN(9) UNAL,
       67     4195    1         2 TEXT CHAR(31) UNAL;
       68     4196    1   DCL 1 SUB_BUF_3 SYMREF,
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:3    
       69     4197    1         2 COUNT UBIN(9) UNAL,
       70     4198    1         2 TEXT CHAR(31) UNAL;
       71     4199        /***********************************************************************/
       72     4200        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
       73     4201        /**********************************************************************/
       74     4202        /**/
       75     4203    1   DCL TSE$ERROR ENTRY(2) ALTRET;
       76     4204        /**/
       77     4205        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:4    
       78     4206        /********************************************************************/
       79     4207        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
       80     4208        /********************************************************************/
       81     4209        /**/
       82     4210    1   DCL M$CONF DCB;
       83     4211        /**/
       84     4212        /********************************************************************/
       85     4213        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       86     4214        /********************************************************************/
       87     4215        /**/
       88     4216        %FPT_OPEN(FPTN = OPEN_CONFIG,
       89     4217                  DCB = M$CONF,
       90     4218                  NAME = CONFIG_FILE,
       91     4219                  ACCT = SYSACCT,
       92     4220                  ASN = FILE,
       93     4221                  FUN = UPDATE,
       94     4222                  DISP = NAMED,
       95     4223                  ORG = KEYED,
       96     4224                  ACS = DIRECT);
       97     4333        /**/
       98     4334        %FPT_CLOSE(FPTN = CLOSE_CONFIG,
       99     4335                   DCB = M$CONF,
      100     4336                   DISP = SAVE);
      101     4378        /**/
      102     4379        %FPT_READ(FPTN = READ_CONFIG,
      103     4380                  DCB = M$CONF,
      104     4381                  KEY = CONFIG_KEY,
      105     4382                  KEYS = YES);
      106     4421        /**/
      107     4422        %VLP_NAME (FPTN = CONFIG_FILE,NAME = ':CONFIG',LEN = 7);
      108     4449        /**/
      109     4450        %VLP_ACCT (FPTN = SYSACCT,ACCT = ':SYS');
      110     4463        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:5    
      111     4464        /**********************************************************************/
      112     4465        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      113     4466        /**********************************************************************/
      114     4467        /**/
      115     4468    1   DCL TS$CMDWD UBIN WORD BASED ALIGNED;
      116     4469        /**/
      117     4470    1   DCL 1 TS$DEV BASED ALIGNED,
      118     4471    1         2 SIZE UBIN HALF UNAL,
      119     4472    1         2 CODE UBIN HALF UNAL,
      120     4473    1         2 DEVNAME CHAR(8) UNAL,
      121     4474    1         2 NAME REDEF DEVNAME,
      122     4475    1           3 MNEM CHAR(2) UNAL,
      123     4476    1           3 NUM CHAR(2) UNAL,
      124     4477    1           3 TWSN CHAR(4) UNAL;
      125     4478        /**/
      126     4479    1   DCL 1 TS$MPC BASED ALIGNED,
      127     4480    1         2 SIZE UBIN HALF UNAL,
      128     4481    1         2 CODE UBIN HALF UNAL,
      129     4482    1         2 MPCNAME CHAR(8) UNAL,
      130     4483    1         2 NAME REDEF MPCNAME,
      131     4484    1           3 MNEM CHAR(2) UNAL,
      132     4485    1           3 NUM CHAR(2) UNAL,
      133     4486    1           3 TWSN CHAR(4) UNAL;
      134     4487        /**/
      135     4488    1   DCL 1 TS$IOM BASED ALIGNED,
      136     4489    1         2 SIZE UBIN HALF UNAL,
      137     4490    1         2 CODE UBIN HALF UNAL,
      138     4491    1         2 IOM UBIN WORD UNAL;
      139     4492    1   DCL 1 TS$CPU BASED ALIGNED,
      140     4493    1         2 SIZE UBIN HALF UNAL,
      141     4494    1         2 CODE UBIN HALF UNAL,
      142     4495    1         2 CPU UBIN WORD UNAL;
      143     4496    1   DCL 1 TS$SCU BASED ALIGNED,
      144     4497    1         2 SIZE UBIN HALF UNAL,
      145     4498    1         2 CODE UBIN HALF UNAL,
      146     4499    1         2 SCU UBIN WORD UNAL;
      147     4500        /**/
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:6    
      148     4501    1   DCL 1 TS$CHAN BASED ALIGNED,
      149     4502    1         2 SIZE UBIN HALF UNAL,
      150     4503    1         2 CODE UBIN HALF UNAL,
      151     4504    1         2 IOM UBIN WORD UNAL,
      152     4505    1         2 LOCHAN UBIN WORD UNAL,
      153     4506    1         2 HICHAN UBIN WORD UNAL;
      154     4507        /**/
      155     4508    1   DCL 1 TS$FEP BASED ALIGNED,
      156     4509    1         2 SIZE UBIN HALF UNAL,
      157     4510    1         2 CODE UBIN HALF UNAL,
      158     4511    1         2 LEN UBIN HALF UNAL,
      159     4512    1         2 IOM UBIN HALF UNAL,
      160     4513    1         2 CHAN UBIN HALF UNAL,
      161     4514    1         2 FEP UBIN HALF UNAL;
      162     4515        /**/
      163     4516    1   DCL 1 TS$PAGES BASED ALIGNED,
      164     4517    1         2 SIZE UBIN HALF UNAL,
      165     4518    1         2 CODE UBIN HALF UNAL,
      166     4519    1         2 LOPAGE UBIN WORD UNAL,
      167     4520    1         2 HIPAGE UBIN WORD UNAL;
      168     4521        /**/
      169     4522        %TD$IOM;
      170     4530        %TD$MPC;
      171     4552        %TD$HEAD;
      172     4588        /**/
      173     4589        %PARSE$OUT (NAME=O$BLK);
      174     4634        /**/
      175     4635        %PARSE$SYM (NAME = O$SYM);
      176     4673        /**/
      177     4674        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:7    
      178     4675        /*****************************************************************************/
      179     4676        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      180     4677        /*****************************************************************************/
      181     4678        /**/
      182     4679    1           TS_DIPART = NO;
      183     4680    1           READ_CONFIG.BUF_.BUF$ = CONFIG$;
      184     4681    1           READ_CONFIG.BUF_.BOUND = 4095;  /* ONE PAGE                           */
      185     4682        /**/
      186     4683    1           CMD$ = CMD_BASE$;
      187     4684    1           CMD$ -> TS$CMDWD = PCB.OUT$ -> O$BLK.CODE;
      188     4685    1           CMD$ = PINCRW(CMD$,SIZEW(TS$CMDWD));
      189     4686        /**/
      190     4687    1           CMD$ -> TS$CMDWD = 0;           /* MARK END OF TABLE                  */
      191     4688    2           IF PCB.OUT$->O$BLK.NSUBLKS = 1 THEN DO;
      192     4689    3              IF PCB.OUT$->O$BLK.CODE = TSS_DISP THEN DO;
      193     4690    3                 CMD$->TS$DEV = NO;
      194     4691    3                 CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);
      195     4692    3                 CMD$->TS$DEV.CODE = TSS_ALL;
      196     4693    3                 CMD$ = PINCRW(CMD$,CMD$->TS$DEV.SIZE);
      197     4694    3                 CMD$->TS$CMDWD = 0;
      198     4695    3                 RETURN;
      199     4696    3                 END;  /* IF CODE = TSS_DISP */
      200     4697    2              ELSE RETURN;
      201     4698    2              END;  /* IF O$BLK.NSUBLKS = 1 */
      202     4699        /**/
      203     4700    2           IF (CMD_BASE$ -> TS$CMDWD = TSS_HELP) THEN DO;
      204     4701    2              CMD$ -> TS$CMDWD = PCB.OUT$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE;
      205     4702    2              RETURN;
      206     4703    2              END;
      207     4704        /**/
      208     4705    2           DO I = 1 TO PCB.OUT$ -> O$BLK.NSUBLKS - 1; /* ALL COMPONENTS          */
      209     4706    2              BLK$ = PCB.OUT$ ->O$BLK.SUBLK$(I);
      210     4707    2              IF PCB.OUT$->O$BLK.CODE = TSS_THRESH OR PCB.OUT$->O$BLK.CODE = TSS_SET
      211     4708    2                 THEN BLK$ = BLK$->O$BLK.SUBLK$(0);
      212     4709    2              SAVEBLK$ = BLK$;
      213     4710        /**/
      214     4711    3              DO CASE ( BLK$ -> O$BLK.CODE);
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:8    
      215     4712        /**/
      216     4713    3               CASE (TSS_DEV);             /* DEVICE                             */
      217     4714    3                 CMD$ -> TS$DEV = NO;
      218     4715    3                 CMD$ -> TS$DEV.SIZE = SIZEW(TS$DEV);
      219     4716    3                 CMD$ -> TS$DEV.CODE = TSS_DEV;
      220     4717        /**/
      221     4718    3                 BLK$ = BLK$ -> O$BLK.SUBLK$(0);
      222     4719    4                 DO CASE (BLK$ -> O$BLK.CODE); /* NAME OR PATH                   */
      223     4720        /**/
      224     4721    4                  CASE (TSS_NAME);
      225     4722    5                    DO CASE ( BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE);
      226     4723        /**/
      227     4724    5                     CASE (TSS_LP);
      228     4725    5                       CMD$ -> TS$DEV.NAME.MNEM = 'LP';
      229     4726    5                     CASE (TSS_CR);
      230     4727    5                       CMD$ -> TS$DEV.NAME.MNEM = 'CR';
      231     4728    5                     CASE (TSS_CP);
      232     4729    5                       CMD$ -> TS$DEV.NAME.MNEM = 'CP';
      233     4730    5                     CASE (TSS_DP);
      234     4731    5                       CMD$ -> TS$DEV.NAME.MNEM = 'DP';
      235     4732    5                     CASE (TSS_MT);
      236     4733    5                       CMD$ -> TS$DEV.NAME.MNEM = 'MT';
      237     4734    5                     CASE (TSS_SC);
      238     4735    5                       CMD$ -> TS$DEV.NAME.MNEM = 'SC';
      239     4736    5                     CASE (TSS_AP);
      240     4737    5                       CMD$ -> TS$DEV.NAME.MNEM = 'AP';
      241     4738    5                     CASE (TSS_OD);
      242     4739    5                       CMD$ -> TS$DEV.NAME.MNEM = 'OD';
      243     4740    5                     END;
      244     4741        /**/
      245     4742    4                    BLK$ = BLK$ -> O$BLK.SUBLK$(1); /* POINT TO NUMBER             */
      246     4743        /**/
      247     4744    5                    IF (BLK$ -> O$SYM.COUNT = 2) THEN DO;
      248     4745    5                       CMD$ -> TS$DEV.NAME.NUM = BLK$ -> O$SYM.TEXT;
      249     4746    5                       CMD$ -> TS$DEV.NAME.TWSN = '0000';
      250     4747    5                       END;
      251     4748        /**/
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:9    
      252     4749    5                    ELSE IF (BLK$ -> O$SYM.COUNT = 6) THEN DO;
      253     4750    5                          CALL INSERT(CMD$ -> TS$DEV.DEVNAME,2,6,BLK$ -> O$SYM.TEXT);
      254     4751    5                          END;
      255     4752        /**/
      256     4753    5                       ELSE DO;
      257     4754    5                          CALL TSE$ERROR(%E$T_BADDEVNUM);
      258     4755    5                          ALTRETURN;
      259     4756    5                          END;
      260     4757        /**/
      261     4758        /*E*    ERROR:   TSS-E$T_BADDEVNUM-0
      262     4759                MESSAGE: Illegal device number - must be 2 or 6 digits.
      263     4760                DESCRIPTION: DEV NUMBER MUST BE 2 CHAR W/O WORKSTATION,
      264     4761                             OR 6 WITH WORKSTATION        */
      265     4762        /**/
      266     4763    4                  CASE (TSS_PATH);
      267     4764    4                    CALL PATH_2_NAME (BLK$ -> O$BLK,CMD$ -> TS$DEV.DEVNAME,
      268     4765    4                      TSS_DEV) ALTRET (BAD_PATH);
      269     4766    4                  END;
      270     4767        /**/
      271     4768    3               CASE (TSS_IOM);
      272     4769    3                 BLK$ = BLK$->O$BLK.SUBLK$(0);
      273     4770    3                 CMD$ -> TS$IOM = NO;
      274     4771    3                 CMD$ -> TS$IOM.CODE = TSS_IOM;
      275     4772    3                 CMD$ -> TS$IOM.SIZE = SIZEW(TS$IOM);
      276     4773    3                 CALL CHARBIN(CMD$->TS$IOM.IOM,BLK$->O$SYM.TEXT);
      277     4774        /**/
      278     4775    3               CASE (TSS_MPC);
      279     4776    3                 MPC_CHANS = YES;
      280     4777    3                 MPC_DEVS = NO;
      281     4778    4                 IF BLK$->O$BLK.NSUBLKS > 1 THEN DO;  /* MPC OPTIONS */
      282     4779    4                    IF (CMD_BASE$->TS$CMDWD ~= TSS_RET) AND
      283     4780    5                       (CMD_BASE$->TS$CMDWD ~= TSS_PART) THEN DO;
      284     4781    5                       CALL TSE$ERROR(%E$T_DEVNOTRET);
      285     4782    5                       ALTRETURN;
      286     4783    5                       END;  /* IF NOT RET OR PART */
      287     4784    5                    DO J = 1 TO BLK$->O$BLK.NSUBLKS - 1;
      288     4785    6                       DO CASE(BLK$->O$BLK.SUBLK$(J)->O$BLK.CODE);
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:10   
      289     4786    6                          CASE(TSS_DEVLIT);
      290     4787    6                             MPC_DEVS = YES;
      291     4788    6                          CASE(TSS_CHANSOPT);
      292     4789    6                             MPC_CHANS = YES;
      293     4790    6                          CASE(TSS_NCHANSOPT);
      294     4791    6                             MPC_CHANS = NO;
      295     4792    6                          END;  /* DO CASE */
      296     4793    5                       END;  /* DO J */
      297     4794    4                    END;  /* IF MPC OPTIONS */
      298     4795    3                 BLK$ = BLK$ -> O$BLK.SUBLK$(0);
      299     4796    4                 DO CASE (BLK$ -> O$BLK.CODE); /* PATH OR NAME                   */
      300     4797        /**/
      301     4798    4                  CASE (TSS_NAME);
      302     4799    5                    DO CASE (BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE);
      303     4800        /**/
      304     4801    5                     CASE (TSS_DC);
      305     4802    5                       NAME.MNEM = 'DC';
      306     4803    5                     CASE (TSS_TC);
      307     4804    5                       NAME.MNEM = 'TC';
      308     4805    5                     CASE (TSS_UC);
      309     4806    5                       NAME.MNEM = 'UC';
      310     4807    5                     CASE (TSS_AC);
      311     4808    5                       NAME.MNEM = 'AC';
      312     4809    5                     END;
      313     4810        /**/
      314     4811    4                    BLK$ = BLK$ -> O$BLK.SUBLK$(1); /* POINT TO NUMBER             */
      315     4812    5                    IF (BLK$ -> O$SYM.COUNT ~= 2) THEN DO;
      316     4813    5                       CALL TSE$ERROR(%E$T_BADMPCNUM);
      317     4814    5                       ALTRETURN;
      318     4815    5                       END;
      319     4816        /**/
      320     4817        /*E*    ERROR:  TSS-E$T_BADMPCNUM-0
      321     4818                MESSAGE: Illegal MPC number - must be 2 digits.
      322     4819                DESCRIPTION: SEE MESSAGE        */
      323     4820        /**/
      324     4821    4                    NAME.NUM = BLK$ -> O$SYM.TEXT;
      325     4822    4                    NAME.TWSN = '0000';
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:11   
      326     4823        /**/
      327     4824    4                  CASE (TSS_PATH);
      328     4825    4                    CALL PATH_2_NAME (BLK$ -> O$BLK,MPCNAME,
      329     4826    4                      TSS_MPC) ALTRET (BAD_PATH);
      330     4827    4                  END;
      331     4828
      332     4829    4                 IF CMD_BASE$->TS$CMDWD = TSS_PART THEN DO;
      333     4830    5                    IF MPC_DEVS THEN DO;
      334     4831    5                       CONFIG_KEY.COUNT = 8;
      335     4832    5                       CONFIG_KEY.TEXT = MPCNAME;
      336     4833           /**/
      337     4834    5                       CALL M$OPEN (OPEN_CONFIG) ALTRET (CONFIG_ERR);
      338     4835    5                       CALL M$READ (READ_CONFIG) ALTRET (CONFIG_ERR);
      339     4836    5                       CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);
      340     4837           /**/
      341     4838    6                       IF (CONFIG$ -> TD$MPC.NUMDEVS ~= 0) THEN DO;
      342     4839    6                          K = CONFIG$ -> TD$MPC.NUMDEVS - 1;
      343     4840           /**/
      344     4841    7                          DO J = 0 TO K;      /* ALL DEVICES                        */
      345     4842    7                             CMD$ -> TS$DEV = NO;
      346     4843    7                             CMD$ -> TS$DEV.SIZE = SIZEW(TS$DEV);
      347     4844    7                             CMD$ -> TS$DEV.CODE = TSS_DEV;
      348     4845    7                             CMD$ -> TS$DEV.DEVNAME = CONFIG$ -> TD$MPC.DEVNAME(J);
      349     4846    7                             CMD$ = PINCRW(CMD$,CMD$->TS$DEV.SIZE);
      350     4847    7                             END;  /* DO J */
      351     4848    6                          END;  /* IF NUMDEVS ~= 0 */
      352     4849    5                       END;  /* IF MPC_DEVS */
      353     4850    5                    IF MPC_CHANS THEN DO;
      354     4851    5                       CONFIG_KEY.COUNT = 8;
      355     4852    5                       CONFIG_KEY.TEXT = MPCNAME;
      356     4853           /**/
      357     4854    5                       CALL M$OPEN (OPEN_CONFIG) ALTRET (CONFIG_ERR);
      358     4855    5                       CALL M$READ (READ_CONFIG) ALTRET (CONFIG_ERR);
      359     4856    5                       CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);
      360     4857    6                       DO J = 0 TO 7;
      361     4858    7                          IF CONFIG$->TD$MPC.IOCHAN.PRESENCE(J) THEN DO;
      362     4859    7                             CMD$->TS$CHAN = NO;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:12   
      363     4860    7                             CMD$->TS$CHAN.SIZE = SIZEW(TS$CHAN);
      364     4861    7                             CMD$->TS$CHAN.CODE = TSS_CHAN;
      365     4862    7                             CMD$->TS$CHAN.IOM = CONFIG$->TD$MPC.IOCHAN.IOM(J);
      366     4863    7                             CMD$->TS$CHAN.LOCHAN = CONFIG$->TD$MPC.IOCHAN.LOCHAN(J);
      367     4864    7                             CMD$->TS$CHAN.HICHAN = CONFIG$->TD$MPC.IOCHAN.HICHAN(J);
      368     4865    7                             CMD$ = PINCRW(CMD$,CMD$->TS$CHAN.SIZE);
      369     4866    7                             END;  /* IF IOCHAN.PRESENCE */
      370     4867    6                          END;  /* DO J */
      371     4868    5                       END;  /* IF MPC_CHANS */
      372     4869    4                    END;  /* IF TSS_PART */
      373     4870    3                 CMD$ -> TS$MPC = NO;
      374     4871    3                 CMD$ -> TS$MPC.SIZE = SIZEW(TS$MPC);
      375     4872    3                 CMD$ -> TS$MPC.CODE = TSS_MPC;
      376     4873    3                 CMD$ -> TS$MPC.MPCNAME = MPCNAME;
      377     4874        /**/
      378     4875    4                 IF CMD_BASE$->TS$CMDWD = TSS_RET THEN DO;
      379     4876    5                    IF MPC_CHANS THEN DO;
      380     4877    5                       CONFIG_KEY.COUNT = 8;
      381     4878    5                       CONFIG_KEY.TEXT = MPCNAME;
      382     4879           /**/
      383     4880    5                       CALL M$OPEN (OPEN_CONFIG) ALTRET (CONFIG_ERR);
      384     4881    5                       CALL M$READ (READ_CONFIG) ALTRET (CONFIG_ERR);
      385     4882    5                       CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);
      386     4883    6                       DO J = 0 TO 7;
      387     4884    7                          IF CONFIG$->TD$MPC.IOCHAN.PRESENCE(J) THEN DO;
      388     4885    7                             CMD$ = PINCRW(CMD$,CMD$->TS$CHAN.SIZE);
      389     4886    7                             CMD$->TS$CHAN = NO;
      390     4887    7                             CMD$->TS$CHAN.SIZE = SIZEW(TS$CHAN);
      391     4888    7                             CMD$->TS$CHAN.CODE = TSS_CHAN;
      392     4889    7                             CMD$->TS$CHAN.IOM = CONFIG$->TD$MPC.IOCHAN.IOM(J);
      393     4890    7                             CMD$->TS$CHAN.LOCHAN = CONFIG$->TD$MPC.IOCHAN.LOCHAN(J);
      394     4891    7                             CMD$->TS$CHAN.HICHAN = CONFIG$->TD$MPC.IOCHAN.HICHAN(J);
      395     4892    7                             END;  /* IF IOCHAN.PRESENCE */
      396     4893    6                          END;  /* DO J */
      397     4894    5                       END;  /* IF MPC_CHANS */
      398     4895    5                    IF MPC_DEVS THEN DO;
      399     4896    5                       CONFIG_KEY.COUNT = 8;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:13   
      400     4897    5                       CONFIG_KEY.TEXT = MPCNAME;
      401     4898           /**/
      402     4899    5                       CALL M$OPEN (OPEN_CONFIG) ALTRET (CONFIG_ERR);
      403     4900    5                       CALL M$READ (READ_CONFIG) ALTRET (CONFIG_ERR);
      404     4901    5                       CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);
      405     4902           /**/
      406     4903    6                       IF (CONFIG$ -> TD$MPC.NUMDEVS ~= 0) THEN DO;
      407     4904    6                          K = CONFIG$ -> TD$MPC.NUMDEVS - 1;
      408     4905           /**/
      409     4906    7                          DO J = 0 TO K;      /* ALL DEVICES                        */
      410     4907    7                             CMD$ = PINCRW(CMD$,CMD$->TS$DEV.SIZE);
      411     4908    7                             CMD$ -> TS$DEV = NO;
      412     4909    7                             CMD$ -> TS$DEV.SIZE = SIZEW(TS$DEV);
      413     4910    7                             CMD$ -> TS$DEV.CODE = TSS_DEV;
      414     4911    7                             CMD$ -> TS$DEV.DEVNAME = CONFIG$ -> TD$MPC.DEVNAME(J);
      415     4912    7                             END;  /* DO J */
      416     4913    6                          END;  /* IF NUMDEVS ~= 0 */
      417     4914    5                       END;  /* IF MPC_DEVS */
      418     4915    4                    END;  /* IF TSS_RET */
      419     4916        /*E*    ERROR: TSS-E$T_DEVNOTRET-0
      420     4917           MESSAGE: Illegal to specify 'DEVICES' except on 'RETURN' or 'PARTITION' commands.
      421     4918                DESCRIPTION: 'DECICES SAID ON OTHER COMMAND THAN RETURN */
      422     4919        /**/
      423     4920    3               CASE (TSS_FEP);
      424     4921    3                 CMD$ -> TS$FEP = NO;
      425     4922    3                 CMD$ -> TS$FEP.SIZE = SIZEW(TS$FEP);
      426     4923    3                 CMD$ -> TS$FEP.CODE = TSS_FEP;
      427     4924        /**/
      428     4925    3                 BLK$ = BLK$ -> O$BLK.SUBLK$(0);
      429     4926    4                 DO CASE (BLK$ -> O$BLK.CODE); /* PATH OR NAME                   */
      430     4927        /**/
      431     4928    4                  CASE (TSS_NAME);
      432     4929    4                    BLK$ = BLK$ -> O$BLK.SUBLK$(1);
      433     4930    5                    IF (BLK$ -> O$SYM.COUNT > 3) THEN DO;
      434     4931    5                       CALL TSE$ERROR(%E$T_BADFEPNUM);
      435     4932    5                       ALTRETURN;
      436     4933    5                       END;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:14   
      437     4934        /**/
      438     4935        /*E*    ERROR:   TSS-E$T_BADFEPNUM-0
      439     4936                MESSAGE: Illegal FEP number - must be less than 512.
      440     4937                DESCRIPTION: SEE MESSAGE        */
      441     4938        /**/
      442     4939    4                    FEPNAME = 'FEP';
      443     4940    4                    CALL INSERT(FEPNAME,3,BLK$->O$SYM.COUNT,SUBSTR(BLK$->O$SYM.TEXT,0,
              4940                             BLK$->O$SYM.COUNT));
      444     4941    4                    CALL CHARBIN(TEMP,SUBSTR(BLK$->O$SYM.TEXT,0,BLK$->O$SYM.COUNT));
      445     4942    4                    CMD$->TS$FEP.FEP = TEMP;
      446     4943    4                    CMD$->TS$FEP.LEN = BLK$->O$SYM.COUNT;
      447     4944        /**/
      448     4945    4                  CASE (TSS_PATH);
      449     4946    4                    CALL PATH_2_NAME (BLK$ -> O$BLK,SUB_BUF_3.TEXT,
      450     4947    4                      TSS_FEP) ALTRET (BAD_PATH);
      451     4948    4                    FEPNAME = SUB_BUF_3.TEXT;
      452     4949    4                    J = 0;
      453     4950    5                    DO WHILE(SUBSTR(FEPNAME,J,1) ~= ' ');
      454     4951    5                       J = J + 1;
      455     4952    5                       END;  /* DO WHILE */
      456     4953    4                    CMD$->TS$FEP.LEN = J - 3;
      457     4954    4                    CALL CHARBIN(TEMP,SUBSTR(FEPNAME,3,CMD$->TS$FEP.LEN));
      458     4955    4                    CMD$->TS$FEP.FEP = TEMP;
      459     4956    4                  END;
      460     4957                      /* GET IOM,CHAN THIS FEP IS ON */
      461     4958    3                 CONFIG_KEY.COUNT = 1;
      462     4959    3                 CONFIG_KEY.TEXT = BINASC(0);
      463     4960    3                 CALL M$OPEN(OPEN_CONFIG) ALTRET(CONFIG_ERR);
      464     4961    3                 CALL M$READ(READ_CONFIG) ALTRET(CONFIG_ERR);
      465     4962    3                 NUMIOMS = CONFIG$->TD$HEAD.NUMIOMS;
      466     4963    4                 DO J = 0 TO NUMIOMS - 1;
      467     4964    4                    CONFIG_KEY.COUNT = 4;
      468     4965    4                    CONFIG_KEY.TEXT = 'IOM';
      469     4966    4                    CALL BINCHAR(SUBSTR(CONFIG_KEY.TEXT,3,1),J);
      470     4967    4                    CALL M$READ(READ_CONFIG) ALTRET(CONFIG_ERR);
      471     4968    5                    DO K = 8 TO %N_MAXCHANS-1;  /* ALL CHANNELS */
      472     4969    6                       IF CONFIG$->TD$IOM.DEVNAME(K) = FEPNAME THEN DO;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:15   
      473     4970    6                          CMD$->TS$FEP.IOM = J;
      474     4971    6                          CMD$->TS$FEP.CHAN = K;
      475     4972    6                          CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);
      476     4973    6                          GOTO FEP_FOUND;
      477     4974    6                          END;  /* IF FOUND IT */
      478     4975    5                       END;  /* DO K */
      479     4976    4                    END;  /* DO J */
      480     4977    3                 CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);
      481     4978    3               CASE (TSS_CHAN);
      482     4979    3                 CMD$ -> TS$CHAN = NO;
      483     4980    3                 CMD$ -> TS$CHAN.SIZE = SIZEW(TS$CHAN);
      484     4981    3                 CMD$ -> TS$CHAN.CODE = TSS_CHAN;
      485     4982        /**/
      486     4983    4                 IF (BLK$ -> O$BLK.SUBLK$(0) -> O$SYM.COUNT ~= 1) THEN DO;
      487     4984    4                    CALL TSE$ERROR(%E$T_BADIOMNUM);
      488     4985    4                    ALTRETURN;
      489     4986    4                    END;
      490     4987        /**/
      491     4988        /*E*    ERROR:   TSS-E$T_BADIOMNUM-0
      492     4989                MESSAGE: Illegal IOM number - must be single digit.
      493     4990                DESCRIPTION: SEE MESSAGE        */
      494     4991        /**/
      495     4992    3                 CALL CHARBIN(CMD$ -> TS$CHAN.IOM,
      496     4993    3                   SUBSTR(BLK$ -> O$BLK.SUBLK$(0) -> O$SYM.TEXT,0,1));
      497     4994        /**/
      498     4995    3                 CALL CHARBIN(CMD$ -> TS$CHAN.LOCHAN,
      499     4996    3                   SUBSTR(BLK$ -> O$BLK.SUBLK$(1) -> O$SYM.TEXT,0,
      500     4997    3                   BLK$ -> O$BLK.SUBLK$(1) -> O$SYM.COUNT));
      501     4998    4                 IF (CMD$ -> TS$CHAN.LOCHAN > %N_MAXCHANS-1) THEN DO;
      502     4999    4                    CALL TSE$ERROR(%E$T_BADCHANNUM);
      503     5000    4                    ALTRETURN;
      504     5001    4                    END;
      505     5002        /**/
      506     5003        /*E*    ERROR:   TSS-E$T_BADCHANNUM-0
      507     5004                MESSAGE: Illegal channel number.
      508     5005                MESSAGE1: Channel number greater than 127 - or LO > HI in range.
      509     5006                DESCRIPTION: SEE MESSAGE        */
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:16   
      510     5007        /**/
      511     5008    4                 IF (BLK$ -> O$BLK.NSUBLKS = 3) THEN DO; /* HICHAN SPECIFIED     */
      512     5009    4                    CALL CHARBIN(CMD$ -> TS$CHAN.HICHAN,
      513     5010    4                      SUBSTR(BLK$ -> O$BLK.SUBLK$(2) -> O$SYM.TEXT,0,
      514     5011    4                      BLK$ -> O$BLK.SUBLK$(2) -> O$SYM.COUNT));
      515     5012    4                    IF (CMD$ -> TS$CHAN.HICHAN > %N_MAXCHANS-1)OR
      516     5013    5                      (CMD$ -> TS$CHAN.HICHAN < CMD$ -> TS$CHAN.LOCHAN) THEN DO;
      517     5014    5                       CALL TSE$ERROR(%E$T_BADCHANNUM);
      518     5015    5                       ALTRETURN;
      519     5016    5                       END;
      520     5017    4                    END;
      521     5018        /**/
      522     5019    3                 ELSE CMD$ -> TS$CHAN.HICHAN = CMD$ -> TS$CHAN.LOCHAN;
      523     5020        /**/
      524     5021    3               CASE (TSS_PAGES);
      525     5022    3                 CMD$ -> TS$PAGES = NO;
      526     5023    3                 CMD$ -> TS$PAGES.SIZE = SIZEW(TS$PAGES);
      527     5024    3                 CMD$ -> TS$PAGES.CODE = TSS_PAGES;
      528     5025        /**/
      529     5026    4                 IF BLK$->O$BLK.NSUBLKS=0 THEN DO;
      530     5027    4                   CMD$->TS$PAGES.LOPAGE=0;
      531     5028    4                   CMD$->TS$PAGES.HIPAGE=BITBIN('777777777777'O);
      532     5029    4                   GOTO PAGEDONE;
      533     5030    4                   END;
      534     5031        /**/
      535     5032    3                 CALL CHARBIN(CMD$ -> TS$PAGES.LOPAGE,
      536     5033    3                   SUBSTR(BLK$ -> O$BLK.SUBLK$(0) -> O$SYM.TEXT,0,
      537     5034    3                   BLK$ -> O$BLK.SUBLK$(0) -> O$SYM.COUNT));
      538     5035        /**/
      539     5036    4                 IF (BLK$ -> O$BLK.NSUBLKS = 2) THEN DO;
      540     5037    4                    CALL CHARBIN(CMD$ -> TS$PAGES.HIPAGE,
      541     5038    4                      SUBSTR(BLK$ -> O$BLK.SUBLK$(1) -> O$SYM.TEXT,0,
      542     5039    4                      BLK$ -> O$BLK.SUBLK$(1) -> O$SYM.COUNT));
      543     5040    5                    IF (CMD$ -> TS$PAGES.HIPAGE < CMD$ -> TS$PAGES.LOPAGE) THEN DO;
      544     5041    5                       CALL TSE$ERROR(%E$T_BADPAGENUM);
      545     5042    5                       ALTRETURN;
      546     5043    5                       END;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:17   
      547     5044    4                    END;
      548     5045        /**/
      549     5046        /*E*    ERROR:   TSS-E$T_BADPAGENUM-0
      550     5047                MESSAGE: Illegal page number range - LO > HI.
      551     5048                DESCRIPTION: SEE MESSAGE        */
      552     5049        /**/
      553     5050    3                 ELSE CMD$ -> TS$PAGES.HIPAGE = CMD$ -> TS$PAGES.LOPAGE;
      554     5051    3   PAGEDONE:;
      555     5052    3               CASE(TSS_ALL);
      556     5053    3                 CMD$->TS$DEV = NO;
      557     5054    3                 CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);
      558     5055    3                 CMD$->TS$DEV.CODE = TSS_ALL;
      559     5056    3               CASE(TSS_DIREL);
      560     5057    3                 CMD$->TS$DEV = NO;
      561     5058    3                 CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);
      562     5059    3                 CMD$->TS$DEV.CODE = TSS_DIREL;
      563     5060    3                 TS_DIREL = YES;
      564     5061    3               CASE(TSS_DIPART);
      565     5062    3                 CMD$->TS$DEV = NO;
      566     5063    3                 CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);
      567     5064    3                 CMD$->TS$DEV.CODE = TSS_DIPART;
      568     5065    3                 TS_DIPART = YES;
      569     5066    3               CASE(TSS_DIPATH);
      570     5067    4                 DO J = 0 TO BLK$->O$BLK.NSUBLKS - 1;
      571     5068    4                    PTR$ = BLK$->O$BLK.SUBLK$(J);
      572     5069    4                    CMD$->TS$DEV = NO;
      573     5070    4                    CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);
      574     5071    4                    CMD$->TS$DEV.CODE = TSS_DIPATH;
      575     5072    5                    DO CASE(PTR$->O$BLK.CODE);
      576     5073    5                       CASE(TSS_DEV);
      577     5074    6                          DO CASE(PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.CODE);
      578     5075    6                             CASE(TSS_LP);
      579     5076    6                                CMD$->TS$DEV.NAME.MNEM = 'LP';
      580     5077    6                             CASE(TSS_CR);
      581     5078    6                                CMD$->TS$DEV.NAME.MNEM = 'CR';
      582     5079    6                             CASE(TSS_CP);
      583     5080    6                                CMD$->TS$DEV.NAME.MNEM = 'CP';
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:18   
      584     5081    6                             CASE(TSS_DP);
      585     5082    6                                CMD$->TS$DEV.NAME.MNEM = 'DP';
      586     5083    6                             CASE(TSS_MT);
      587     5084    6                                CMD$->TS$DEV.NAME.MNEM = 'MT';
      588     5085    6                             CASE(TSS_SC);
      589     5086    6                                CMD$->TS$DEV.NAME.MNEM = 'SC';
      590     5087    6                             CASE(TSS_AP);
      591     5088    6                                CMD$->TS$DEV.NAME.MNEM = 'AP';
      592     5089    6                             CASE(TSS_OD);
      593     5090    6                                CMD$->TS$DEV.NAME.MNEM = 'OD';
      594     5091    6                             END;  /* CASE */
      595     5092    5                          CMD$->TS$DEV.NAME.NUM = PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1
              5092                                   )->O$SYM.TEXT;
      596     5093    5                          CMD$->TS$DEV.NAME.TWSN = '0000';
      597     5094    5                       CASE(TSS_MPC);
      598     5095    6                          DO CASE(PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.CODE);
      599     5096    6                             CASE(TSS_DC);
      600     5097    6                                CMD$->TS$DEV.NAME.MNEM = 'DC';
      601     5098    6                             CASE(TSS_TC);
      602     5099    6                                CMD$->TS$DEV.NAME.MNEM = 'TC';
      603     5100    6                             CASE(TSS_UC);
      604     5101    6                                CMD$->TS$DEV.NAME.MNEM = 'UC';
      605     5102    6                             CASE(TSS_AC);
      606     5103    6                                CMD$->TS$DEV.NAME.MNEM = 'AC';
      607     5104    6                             END;  /* CASE */
      608     5105    5                          CMD$->TS$DEV.NAME.NUM = PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1
              5105                                   )->O$SYM.TEXT;
      609     5106    5                          CMD$->TS$DEV.NAME.TWSN = '0000';
      610     5107    5                       CASE(TSS_FEP);
      611     5108    5                          FEPNAME = 'FEP';
      612     5109    5                          PTR$ = PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1);
      613     5110    5                          CALL INSERT(FEPNAME,3,PTR$->O$SYM.COUNT,SUBSTR(PTR$->O$SYM.
              5110                                   TEXT,0,PTR$->O$SYM.COUNT));
      614     5111    5                          CMD$->TS$DEV.DEVNAME = FEPNAME;
      615     5112    5                       END;  /* DO CASE */
      616     5113    4                    CMD$ = PINCRW(CMD$,CMD$->TS$DEV.SIZE);
      617     5114    4                    CMD$->TS$CMDWD = 0;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:19   
      618     5115    4                 END;  /* DO J */
      619     5116    3               CASE (TSS_CPU);
      620     5117    3                 BLK$ = BLK$->O$BLK.SUBLK$(0);
      621     5118    3                 CMD$ -> TS$CPU = NO;
      622     5119    3                 CMD$ -> TS$CPU.CODE = TSS_CPU;
      623     5120    3                 CMD$ -> TS$CPU.SIZE = SIZEW(TS$CPU);
      624     5121    3                 CALL CHARBIN(CMD$->TS$CPU.CPU,BLK$->O$SYM.TEXT);
      625     5122    3               CASE (TSS_SCU);
      626     5123    3                 BLK$ = BLK$->O$BLK.SUBLK$(0);
      627     5124    3                 CMD$ -> TS$SCU = NO;
      628     5125    3                 CMD$ -> TS$SCU.CODE = TSS_SCU;
      629     5126    3                 CMD$ -> TS$SCU.SIZE = SIZEW(TS$SCU);
      630     5127    3                 CALL CHARBIN(CMD$->TS$SCU.SCU,BLK$->O$SYM.TEXT);
      631     5128    3              END;  /* DO CASE BLK$->O$BLK.CODE */
      632     5129    2   FEP_FOUND:
      633     5130    2              CMD$ = PINCRW(CMD$,CMD$ -> TS$DEV.SIZE);
      634     5131    2              CMD$ -> TS$CMDWD = 0;
      635     5132    2              END;
      636     5133        /**/
      637     5134    1           RETURN;
      638     5135        /**/
      639     5136    1   CONFIG_ERR:
      640     5137    1           CALL TSE$ERROR(0);
      641     5138    1           CALL TSE$ERROR(%E$T_CONFIGERR);
      642     5139    1           CALL M$CLOSE (CLOSE_CONFIG);
      643     5140        /**/
      644     5141        /*E*    ERROR:   TSS-E$T_CONFIGERR-0
      645     5142                MESSAGE: Error accessing :CONFIG file.
      646     5143                DESCRIPTION: CANT GET AT :CONFIG TO DO DEVICES  */
      647     5144        /**/
      648     5145    1   BAD_PATH:
      649     5146    1           ALTRETURN;
      650     5147        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:20   
      651     5148        /**/
      652     5149    1   PATH_2_NAME: PROC (O_BLK,NAME,TYPE) ALTRET;
      653     5150        /**/
      654     5151        /* PARAMETERS */
      655     5152        /**/
      656     5153        %PARSE$OUT (NAME=O_BLK,STCLASS=" ");
      657     5198    2   DCL NAME CHAR(8);
      658     5199    2   DCL TYPE UBIN WORD;
      659     5200        /**/
      660     5201        /* AUTOMATIC */
      661     5202        /**/
      662     5203    2   DCL MNEM CHAR(3) AUTO;
      663     5204        /**/
      664     5205        /* PROCEDURE */
      665     5206        /**/
      666     5207    3           IF (TYPE = TSS_MPC) THEN DO CASE (O_BLK.SUBLK$(0) -> O$BLK.CODE);
      667     5208    3            CASE (TSS_DC);
      668     5209    3              MNEM = 'DC';
      669     5210    3            CASE (TSS_TC);
      670     5211    3              MNEM = 'TC';
      671     5212    3            CASE (TSS_UC);
      672     5213    3              MNEM = 'UC';
      673     5214    3            CASE (TSS_AC);
      674     5215    3              MNEM = 'AC';
      675     5216    3            END;
      676     5217        /**/
      677     5218    2           ELSE IF (TYPE = TSS_FEP) THEN MNEM = 'FEP';
      678     5219        /**/
      679     5220    3              ELSE DO CASE (O_BLK.SUBLK$(0) -> O$BLK.CODE);
      680     5221    3               CASE (TSS_LP);
      681     5222    3                 MNEM = 'LP';
      682     5223    3               CASE (TSS_CR);
      683     5224    3                 MNEM = 'CR';
      684     5225    3               CASE (TSS_CP);
      685     5226    3                 MNEM = 'CP';
      686     5227    3               CASE (TSS_DP);
      687     5228    3                 MNEM = 'DP';
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:21   
      688     5229    3               CASE (TSS_MT);
      689     5230    3                 MNEM = 'MT';
      690     5231    3               CASE (TSS_AP);
      691     5232    3                 MNEM = 'AP';
      692     5233    3               CASE (TSS_OD);
      693     5234    3                 MNEM = 'OD';
      694     5235    3               CASE (TSS_SC);
      695     5236    3                 MNEM = 'SC';
      696     5237    3               END;
      697     5238        /**/
      698     5239    3           IF ((MNEM = 'DP')OR(MNEM = 'MT')OR(MNEM='OD')) THEN DO;
      699     5240    4              IF (O_BLK.NSUBLKS < 4) THEN DO; /* DEV# NOT GIVEN                  */
      700     5241    4                 CALL TSE$ERROR(%E$T_MISSINGDEV#);
      701     5242    4                 ALTRETURN;
      702     5243    4                 END;
      703     5244    3              END;
      704     5245        /**/
      705     5246        /*E*    ERROR:   TSS-E$T_MISSINGDEV#-0
      706     5247                MESSAGE: Missing device number - path description incomplete.
      707     5248                MESSAGE1: You must specify a device number as part of the
      708     5249                          access path description for this device.
      709     5250                DESCRIPTION: MT AND DP NEED DEVICE NUMBER TO BE LOCATED.  */
      710     5251        /**/
      711     5252    3           ELSE IF (O_BLK.NSUBLKS = 4) THEN DO; /* GIVEN DEV# NOT LEGAL          */
      712     5253    3                 CALL TSE$ERROR(%E$T_ILLEGALDEV#);
      713     5254    3                 ALTRETURN;
      714     5255    3                 END;
      715     5256        /**/
      716     5257        /*E*    ERROR:   TSS-E$T_ILLEGALDEV#-0
      717     5258                MESSAGE: Illegal device number - not part of path for this device.
      718     5259                MESSAGE1: The access path description for this device does not
      719     5260                          allow a device number - just IOM and CHANNEL.
      720     5261                DESCRIPTION: DEVICE NUMBER GIVEN WHERE UNWANTED */
      721     5262        /**/
      722     5263    3           IF (O_BLK.SUBLK$(1) -> O$SYM.COUNT ~= 1) THEN DO;
      723     5264    3              CALL TSE$ERROR(%E$T_BADIOMNUM);
      724     5265    3              ALTRETURN;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:22   
      725     5266    3              END;
      726     5267        /**/
      727     5268    2           CALL CHARBIN(I,SUBSTR(O_BLK.SUBLK$(2) -> O$SYM.TEXT,0,
      728     5269    2             O_BLK.SUBLK$(2) -> O$SYM.COUNT));
      729     5270    3           IF (I > %N_MAXCHANS-1) THEN DO;
      730     5271    3              CALL TSE$ERROR(%E$T_BADCHANNUM);
      731     5272    3              ALTRETURN;
      732     5273    3              END;
      733     5274        /**/
      734     5275    2           CONFIG_KEY.COUNT = 4;
      735     5276    2           CONFIG_KEY.TEXT = 'IOM';
      736     5277    2           CALL INSERT(CONFIG_KEY.TEXT,3,1,O_BLK.SUBLK$(1) -> O$SYM.TEXT);
      737     5278        /**/
      738     5279    2           CALL M$OPEN(OPEN_CONFIG) ALTRET(CONFIG_ERR);
      739     5280    2           CALL M$READ(READ_CONFIG) ALTRET(CONFIG_ERR);
      740     5281    2           CALL M$CLOSE(CLOSE_CONFIG) ALTRET (CONFIG_ERR);
      741     5282        /**/
      742     5283    2           NAME = CONFIG$ -> TD$IOM.DEVNAME(I);
      743     5284        /**/
      744     5285    2           IF (((MNEM = 'DP')OR(MNEM = 'DC'))AND
      745     5286    2             (SUBSTR(NAME,0,2) ~= 'DC'))OR
      746     5287    2             (((MNEM = 'MT')OR(MNEM = 'TC'))AND
      747     5288    2             (SUBSTR(NAME,0,2) ~= 'TC'))OR
      748     5289    2             (((MNEM = 'LP')OR(MNEM = 'CR')OR(MNEM = 'CP')OR(MNEM = 'UC'))AND
      749     5290    2             (SUBSTR(NAME,0,2) ~= 'UC'))OR
      750     5291    2             (((MNEM = 'FEP')OR(MNEM = 'OD'))AND
      751     5292    2             (SUBSTR(NAME,0,3) ~= 'FEP'))OR
      752     5293    2             (((MNEM = 'SC'))AND
      753     5294    2             (SUBSTR(NAME,0,2) ~= 'SC')) OR
      754     5295    2             (((MNEM = 'AP')OR(MNEM = 'AC'))AND
      755     5296    3             (SUBSTR(NAME,0,2) ~= 'AC')) THEN DO; /* DEVICE NOT THERE            */
      756     5297        /**/
      757     5298    3   BAD_DEVMNEM:
      758     5299    3              SUB_BUF_1.COUNT = 1;
      759     5300    3              SUB_BUF_1.TEXT = O_BLK.SUBLK$(1) -> O$SYM.TEXT; /* IOM NUMBER        */
      760     5301    3              SUB_BUF_2.COUNT = O_BLK.SUBLK$(2) -> O$SYM.COUNT;
      761     5302    3              SUB_BUF_2.TEXT = O_BLK.SUBLK$(2) -> O$SYM.TEXT; /* CHAN NUMBER       */
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:23   
      762     5303    3              SUB_BUF_3.COUNT = 3;
      763     5304    3              SUB_BUF_3.TEXT = MNEM;
      764     5305    3              CALL TSE$ERROR (%E$T_DEVNOTTHERE);
      765     5306    3              ALTRETURN;
      766     5307    3              END;
      767     5308        /**/
      768     5309        /*E*    ERROR: TSS-E$T_DEVNOTTHERE-0
      769     5310                MESSAGE: No %U3 on IOM#%U1,CHAN%U2
      770     5311                DESCRIPTION: PATH DESCRIPTION DOESN'T LEAD TO RIGHT DEVICE TYPE */
      771     5312        /**/
      772     5313    2           IF (TYPE = TSS_MPC)OR(MNEM = 'SC')OR(MNEM = 'FEP') THEN RETURN; /* GOT IT */
      773     5314        /**/
      774     5315    2           CONFIG_KEY.COUNT = 8;
      775     5316    2           CONFIG_KEY.TEXT = NAME;
      776     5317        /**/
      777     5318    2           CALL M$OPEN(OPEN_CONFIG) ALTRET(CONFIG_ERR);
      778     5319    2           CALL M$READ(READ_CONFIG) ALTRET(CONFIG_ERR);
      779     5320    2           CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);
      780     5321        /**/
      781     5322    3           IF (MNEM = 'DP')OR(MNEM = 'MT')OR(MNEM = 'OD') THEN DO; /* GET DEV NUMBER */
      782     5323    3              CALL CHARBIN(I,SUBSTR(O_BLK.SUBLK$(3) -> O$SYM.TEXT,0,
      783     5324    3                O_BLK.SUBLK$(3) -> O$SYM.COUNT));
      784     5325        /**/
      785     5326    4              IF (I > CONFIG$ -> TD$MPC.NUMDEVS) THEN DO;
      786     5327    4                 CALL TSE$ERROR(%E$T_BADDEV#);
      787     5328    4                 ALTRETURN;
      788     5329    4                 END;
      789     5330        /**/
      790     5331        /*E*    ERROR:   TSS-E$T_BADDEV#-0
      791     5332                MESSAGE: No device on this path with that device number.
      792     5333                DESCRIPTION: DEVICE NUMBER GIVEN IS TOO BIG. */
      793     5334        /**/
      794     5335    3              NAME = CONFIG$ -> TD$MPC.DEVNAME(I-1);
      795     5336    3              END;
      796     5337        /**/
      797     5338    3           ELSE DO;
      798     5339    3              CALL CHARBIN(J,SUBSTR(O_BLK.SUBLK$(1) -> O$SYM.TEXT,0,1));;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:24   
      799     5340    4              DO K = 0 TO 7;               /* CHECK ALL POSSIBLE DEVICES         */
      800     5341    4                 IF (CONFIG$ -> TD$MPC.IOCHAN.PRESENCE(K)) THEN
      801     5342    4                    IF (CONFIG$ -> TD$MPC.IOCHAN.IOM(K) = J) THEN
      802     5343    5                       IF (CONFIG$ -> TD$MPC.IOCHAN.LOCHAN(K) = I) THEN DO;
      803     5344    5                          IF MNEM = 'AP' THEN
      804     5345    5                             K = K-1;
              5345                                      /* 1st channel is reserved for AC - no dev on it */
      805     5346    5                          NAME = CONFIG$ -> TD$MPC.DEVNAME(K);
      806     5347    5                          IF (SUBSTR(NAME,0,2) ~= MNEM) THEN GOTO BAD_DEVMNEM;
      807     5348    5                          RETURN;
      808     5349    5                          END;
      809     5350    4                 END;
      810     5351    3              GOTO BAD_DEVMNEM;
      811     5352    3              END;
      812     5353    2           RETURN;
      813     5354        /**/
      814     5355    2   CONFIG_ERR:
      815     5356    2           CALL TSE$ERROR(0);
      816     5357    2           CALL TSE$ERROR(%E$T_CONFIGERR);
      817     5358    2           CALL M$CLOSE (CLOSE_CONFIG);
      818     5359    2           ALTRETURN;
      819     5360    2   END;
      820     5361    1   END;

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:25   
--  Include file information  --

   NI$TABLES.:E05TOU  is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
   TD$STRUCT.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   TS_PERR_C.:E05TOU  is referenced.
   TS_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TSC$CHECK.

   Procedure TSC$CHECK requires 1525 words for executable code.
   Procedure TSC$CHECK requires 22 words of local(AUTO) storage.

    No errors detected in file TSC$CHECK.:E05TSI    .

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:26   

 Object Unit name= TSC$CHECK                                  File name= TSC$CHECK.:E05TOU
 UTS= JUL 30 '97 06:52:42.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   108    154  TSC$CHECK
    2   DCB   even  none     0      0  M$CONF
    3  RoData even  UTS     15     17  TSC$CHECK
    4   Proc  even  none  1525   2765  TSC$CHECK
    5  RoData even  none    33     41  TSC$CHECK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  TSC$CHECK

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  TS_DIPART                          1      1  TS_DIREL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 TSE$ERROR
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:27   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  BLK$                                  CMD$
     CMD_BASE$                             CONFIG$                               I
     J                                     K                                     CONFIG_KEY
     SUB_BUF_1                             SUB_BUF_2                             SUB_BUF_3
     M$CONF                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:28   


        1        1        /*M* TSC$CHECK - SYNTAX CHECKING AND INTERNAL TABLE BUILDING ROUTINES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*/
        8        8        TSC$CHECK: PROC(PCB) ALTRET;

      8  4 000000   000000 700200 xent  TSC$CHECK    TSX0  ! X66_AUTO_1
         4 000001   000026 000001                    ZERO    22,1

        9        9        /**/
       10       10        /*********************************************************************/
       11       11        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       12       12        /*********************************************************************/
       13       13        /**/
       14       14        %INCLUDE TS_SUBS_C;
       15       95        %INCLUDE TS_PERR_C;
       16      178        %INCLUDE CP_6;
       17      259        %INCLUDE XU_MACRO_C;
       18     3365        %INCLUDE TD$STRUCT;
       19     3466        %INCLUDE IT_SUBS_C;
       20     3733        %INCLUDE NI$TABLES ;
       21     3949        /**/
       22     3950        %SUB YES = '1'B/*YES*/;
       23     3951        %SUB NO = '0'B/*NO*/;
       24     3952        /**/
       25     3953        /*****************************************************************************/
       26     3954        /*   PARAMETER   PARAMETER   PARAMETER   PARAMETER   PARAMETER   PARAMETER   */
       27     3955        /*****************************************************************************/
       28     3956        /**/
       29     3957        %P$PCB (NAME=PCB,STCLASS=" ");
       30     4158        /**/
       31     4159        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:29   
       32     4160        /*****************************************************************/
       33     4161        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
       34     4162        /*****************************************************************/
       35     4163    1   DCL BLK$ PTR SYMREF;
       36     4164    1   DCL CMD$ PTR SYMREF;
       37     4165    1   DCL CMD_BASE$ PTR SYMREF;
       38     4166    1   DCL CONFIG$ PTR SYMREF;
       39     4167    1   DCL SAVEBLK$ PTR;
       40     4168    1   DCL PTR$ PTR;
       41     4169        /**/
       42     4170    1   DCL I SBIN WORD SYMREF;
       43     4171    1   DCL J SBIN WORD SYMREF;
       44     4172    1   DCL K SBIN WORD SYMREF;
       45     4173    1   DCL TEMP UBIN WORD;
       46     4174    1   DCL NUMIOMS SBIN WORD;
       47     4175    1   DCL FEPNAME CHAR(8);
       48     4176    1   DCL TS_DIPART BIT(1) STATIC SYMDEF INIT('0'B);
       49     4177    1   DCL TS_DIREL BIT(1) STATIC SYMDEF INIT('0'B);
       50     4178    1   DCL MPC_CHANS BIT(1);
       51     4179    1   DCL MPC_DEVS BIT(1);
       52     4180    1   DCL MPCNAME CHAR(8);
       53     4181    1   DCL 1 NAME REDEF MPCNAME,
       54     4182    1         2 MNEM CHAR(2),
       55     4183    1         2 NUM CHAR(2),
       56     4184    1         2 TWSN CHAR(4);
       57     4185        /**/
       58     4186    1   DCL 1 CONFIG_KEY SYMREF,
       59     4187    1         2 COUNT UBIN(9) UNAL,
       60     4188    1         2 TEXT CHAR(8) UNAL;
       61     4189        /**/
       62     4190    1   DCL 1 SUB_BUF_1 SYMREF,
       63     4191    1         2 COUNT UBIN(9) UNAL,
       64     4192    1         2 TEXT CHAR(31) UNAL;
       65     4193    1   DCL 1 SUB_BUF_2 SYMREF,
       66     4194    1         2 COUNT UBIN(9) UNAL,
       67     4195    1         2 TEXT CHAR(31) UNAL;
       68     4196    1   DCL 1 SUB_BUF_3 SYMREF,
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:30   
       69     4197    1         2 COUNT UBIN(9) UNAL,
       70     4198    1         2 TEXT CHAR(31) UNAL;
       71     4199        /***********************************************************************/
       72     4200        /*    ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   ENTRY DCLS   */
       73     4201        /**********************************************************************/
       74     4202        /**/
       75     4203    1   DCL TSE$ERROR ENTRY(2) ALTRET;
       76     4204        /**/
       77     4205        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:31   
       78     4206        /********************************************************************/
       79     4207        /*   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   DCBS   */
       80     4208        /********************************************************************/
       81     4209        /**/
       82     4210    1   DCL M$CONF DCB;
       83     4211        /**/
       84     4212        /********************************************************************/
       85     4213        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       86     4214        /********************************************************************/
       87     4215        /**/
       88     4216        %FPT_OPEN(FPTN = OPEN_CONFIG,
       89     4217                  DCB = M$CONF,
       90     4218                  NAME = CONFIG_FILE,
       91     4219                  ACCT = SYSACCT,
       92     4220                  ASN = FILE,
       93     4221                  FUN = UPDATE,
       94     4222                  DISP = NAMED,
       95     4223                  ORG = KEYED,
       96     4224                  ACS = DIRECT);
       97     4333        /**/
       98     4334        %FPT_CLOSE(FPTN = CLOSE_CONFIG,
       99     4335                   DCB = M$CONF,
      100     4336                   DISP = SAVE);
      101     4378        /**/
      102     4379        %FPT_READ(FPTN = READ_CONFIG,
      103     4380                  DCB = M$CONF,
      104     4381                  KEY = CONFIG_KEY,
      105     4382                  KEYS = YES);
      106     4421        /**/
      107     4422        %VLP_NAME (FPTN = CONFIG_FILE,NAME = ':CONFIG',LEN = 7);
      108     4449        /**/
      109     4450        %VLP_ACCT (FPTN = SYSACCT,ACCT = ':SYS');
      110     4463        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:32   
      111     4464        /**********************************************************************/
      112     4465        /*   BASED DATA   BASED DATA   BASED DATA   BASED DATA   BASED DATA   */
      113     4466        /**********************************************************************/
      114     4467        /**/
      115     4468    1   DCL TS$CMDWD UBIN WORD BASED ALIGNED;
      116     4469        /**/
      117     4470    1   DCL 1 TS$DEV BASED ALIGNED,
      118     4471    1         2 SIZE UBIN HALF UNAL,
      119     4472    1         2 CODE UBIN HALF UNAL,
      120     4473    1         2 DEVNAME CHAR(8) UNAL,
      121     4474    1         2 NAME REDEF DEVNAME,
      122     4475    1           3 MNEM CHAR(2) UNAL,
      123     4476    1           3 NUM CHAR(2) UNAL,
      124     4477    1           3 TWSN CHAR(4) UNAL;
      125     4478        /**/
      126     4479    1   DCL 1 TS$MPC BASED ALIGNED,
      127     4480    1         2 SIZE UBIN HALF UNAL,
      128     4481    1         2 CODE UBIN HALF UNAL,
      129     4482    1         2 MPCNAME CHAR(8) UNAL,
      130     4483    1         2 NAME REDEF MPCNAME,
      131     4484    1           3 MNEM CHAR(2) UNAL,
      132     4485    1           3 NUM CHAR(2) UNAL,
      133     4486    1           3 TWSN CHAR(4) UNAL;
      134     4487        /**/
      135     4488    1   DCL 1 TS$IOM BASED ALIGNED,
      136     4489    1         2 SIZE UBIN HALF UNAL,
      137     4490    1         2 CODE UBIN HALF UNAL,
      138     4491    1         2 IOM UBIN WORD UNAL;
      139     4492    1   DCL 1 TS$CPU BASED ALIGNED,
      140     4493    1         2 SIZE UBIN HALF UNAL,
      141     4494    1         2 CODE UBIN HALF UNAL,
      142     4495    1         2 CPU UBIN WORD UNAL;
      143     4496    1   DCL 1 TS$SCU BASED ALIGNED,
      144     4497    1         2 SIZE UBIN HALF UNAL,
      145     4498    1         2 CODE UBIN HALF UNAL,
      146     4499    1         2 SCU UBIN WORD UNAL;
      147     4500        /**/
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:33   
      148     4501    1   DCL 1 TS$CHAN BASED ALIGNED,
      149     4502    1         2 SIZE UBIN HALF UNAL,
      150     4503    1         2 CODE UBIN HALF UNAL,
      151     4504    1         2 IOM UBIN WORD UNAL,
      152     4505    1         2 LOCHAN UBIN WORD UNAL,
      153     4506    1         2 HICHAN UBIN WORD UNAL;
      154     4507        /**/
      155     4508    1   DCL 1 TS$FEP BASED ALIGNED,
      156     4509    1         2 SIZE UBIN HALF UNAL,
      157     4510    1         2 CODE UBIN HALF UNAL,
      158     4511    1         2 LEN UBIN HALF UNAL,
      159     4512    1         2 IOM UBIN HALF UNAL,
      160     4513    1         2 CHAN UBIN HALF UNAL,
      161     4514    1         2 FEP UBIN HALF UNAL;
      162     4515        /**/
      163     4516    1   DCL 1 TS$PAGES BASED ALIGNED,
      164     4517    1         2 SIZE UBIN HALF UNAL,
      165     4518    1         2 CODE UBIN HALF UNAL,
      166     4519    1         2 LOPAGE UBIN WORD UNAL,
      167     4520    1         2 HIPAGE UBIN WORD UNAL;
      168     4521        /**/
      169     4522        %TD$IOM;
      170     4530        %TD$MPC;
      171     4552        %TD$HEAD;
      172     4588        /**/
      173     4589        %PARSE$OUT (NAME=O$BLK);
      174     4634        /**/
      175     4635        %PARSE$SYM (NAME = O$SYM);
      176     4673        /**/
      177     4674        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:34   
      178     4675        /*****************************************************************************/
      179     4676        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
      180     4677        /*****************************************************************************/
      181     4678        /**/
      182     4679    1           TS_DIPART = NO;

   4679  4 000002   000000 450000 1                  STZ     TS_DIPART

      183     4680    1           READ_CONFIG.BUF_.BUF$ = CONFIG$;

   4680  4 000003   000000 236000 xsym               LDQ     CONFIG$
         4 000004   000137 756000 1                  STQ     READ_CONFIG+5

      184     4681    1           READ_CONFIG.BUF_.BOUND = 4095;  /* ONE PAGE                           */

   4681  4 000005   000136 236000 1                  LDQ     READ_CONFIG+4
         4 000006   177777 376007                    ANQ     65535,DL
         4 000007   000000 276000 5                  ORQ     0
         4 000010   000136 756000 1                  STQ     READ_CONFIG+4

      185     4682        /**/
      186     4683    1           CMD$ = CMD_BASE$;

   4683  4 000011   000000 236000 xsym               LDQ     CMD_BASE$
         4 000012   000000 756000 xsym               STQ     CMD$

      187     4684    1           CMD$ -> TS$CMDWD = PCB.OUT$ -> O$BLK.CODE;

   4684  4 000013   200003 470500                    LDP0    @PCB,,AUTO
         4 000014   000003 471500                    LDP1    3,,PR0
         4 000015   100000 236100                    LDQ     0,,PR1
         4 000016   777777 376007                    ANQ     -1,DL
         4 000017   000000 473400 xsym               LDP3    CMD$
         4 000020   300000 756100                    STQ     0,,PR3

      188     4685    1           CMD$ = PINCRW(CMD$,SIZEW(TS$CMDWD));

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:35   
   4685  4 000021   000000 236000 xsym               LDQ     CMD$
         4 000022   000001 036003                    ADLQ    1,DU
         4 000023   000000 756000 xsym               STQ     CMD$

      189     4686        /**/
      190     4687    1           CMD$ -> TS$CMDWD = 0;           /* MARK END OF TABLE                  */

   4687  4 000024   000000 471400 xsym               LDP1    CMD$
         4 000025   100000 450100                    STZ     0,,PR1

      191     4688    2           IF PCB.OUT$->O$BLK.NSUBLKS = 1 THEN DO;

   4688  4 000026   000003 471500                    LDP1    3,,PR0
         4 000027   100001 220100                    LDX0    1,,PR1
         4 000030   000001 100003                    CMPX0   1,DU
         4 000031   000060 601000 4                  TNZ     s:4700

      192     4689    3              IF PCB.OUT$->O$BLK.CODE = TSS_DISP THEN DO;

   4689  4 000032   100000 721100                    LXL1    0,,PR1
         4 000033   000003 101003                    CMPX1   3,DU
         4 000034   000057 601000 4                  TNZ     s:4697

      193     4690    3                 CMD$->TS$DEV = NO;

   4690  4 000035   000000 473400 xsym               LDP3    CMD$
         4 000036   000100 100400                    MLR     fill='000'O
         4 000037   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000040   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

      194     4691    3                 CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);

   4691  4 000041   000003 220003                    LDX0    3,DU
         4 000042   000000 471400 xsym               LDP1    CMD$
         4 000043   100000 740100                    STX0    0,,PR1

      195     4692    3                 CMD$->TS$DEV.CODE = TSS_ALL;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:36   

   4692  4 000044   000007 221003                    LDX1    7,DU
         4 000045   000000 471400 xsym               LDP1    CMD$
         4 000046   100000 441100                    SXL1    0,,PR1

      196     4693    3                 CMD$ = PINCRW(CMD$,CMD$->TS$DEV.SIZE);

   4693  4 000047   000000 471400 xsym               LDP1    CMD$
         4 000050   100000 222100                    LDX2    0,,PR1
         4 000051   000000 636012                    EAQ     0,X2
         4 000052   000000 036000 xsym               ADLQ    CMD$
         4 000053   000000 756000 xsym               STQ     CMD$

      197     4694    3                 CMD$->TS$CMDWD = 0;

   4694  4 000054   000000 471400 xsym               LDP1    CMD$
         4 000055   100000 450100                    STZ     0,,PR1

      198     4695    3                 RETURN;

   4695  4 000056   000000 702200 xent               TSX2  ! X66_ARET

      199     4696    3                 END;  /* IF CODE = TSS_DISP */
      200     4697    2              ELSE RETURN;

   4697  4 000057   000000 702200 xent               TSX2  ! X66_ARET

      201     4698    2              END;  /* IF O$BLK.NSUBLKS = 1 */
      202     4699        /**/
      203     4700    2           IF (CMD_BASE$ -> TS$CMDWD = TSS_HELP) THEN DO;

   4700  4 000060   000000 473400 xsym               LDP3    CMD_BASE$
         4 000061   300000 235100                    LDA     0,,PR3
         4 000062   000005 115007                    CMPA    5,DL
         4 000063   000072 601000 4                  TNZ     s:4705

      204     4701    2              CMD$ -> TS$CMDWD = PCB.OUT$ -> O$BLK.SUBLK$(1) -> O$BLK.CODE;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:37   

   4701  4 000064   100004 474500                    LDP4    4,,PR1
         4 000065   400000 236100                    LDQ     0,,PR4
         4 000066   777777 376007                    ANQ     -1,DL
         4 000067   000000 475400 xsym               LDP5    CMD$
         4 000070   500000 756100                    STQ     0,,PR5

      205     4702    2              RETURN;

   4702  4 000071   000000 702200 xent               TSX2  ! X66_ARET

      206     4703    2              END;
      207     4704        /**/
      208     4705    2           DO I = 1 TO PCB.OUT$ -> O$BLK.NSUBLKS - 1; /* ALL COMPONENTS          */

   4705  4 000072   000001 236007                    LDQ     1,DL
         4 000073   000000 756000 xsym               STQ     I
         4 000074   002074 710000 4                  TRA     s:5132+1

      209     4706    2              BLK$ = PCB.OUT$ ->O$BLK.SUBLK$(I);

   4706  4 000075   200003 470500                    LDP0    @PCB,,AUTO
         4 000076   000003 471500                    LDP1    3,,PR0
         4 000077   000000 720000 xsym               LXL0    I
         4 000100   100003 236110                    LDQ     3,X0,PR1
         4 000101   000000 756000 xsym               STQ     BLK$

      210     4707    2              IF PCB.OUT$->O$BLK.CODE = TSS_THRESH OR PCB.OUT$->O$BLK.CODE = TSS_SET

   4707  4 000102   100000 721100                    LXL1    0,,PR1
         4 000103   000010 101003                    CMPX1   8,DU
         4 000104   000107 600000 4                  TZE     s:4708
         4 000105   000011 101003                    CMPX1   9,DU
         4 000106   000112 601000 4                  TNZ     s:4709

      211     4708    2                 THEN BLK$ = BLK$->O$BLK.SUBLK$(0);

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:38   
   4708  4 000107   000000 473400 xsym               LDP3    BLK$
         4 000110   300003 236100                    LDQ     3,,PR3
         4 000111   000000 756000 xsym               STQ     BLK$

      212     4709    2              SAVEBLK$ = BLK$;

   4709  4 000112   200004 756100                    STQ     SAVEBLK$,,AUTO

      213     4710        /**/
      214     4711    3              DO CASE ( BLK$ -> O$BLK.CODE);

   4711  4 000113   000000 473400 xsym               LDP3    BLK$
         4 000114   300000 721100                    LXL1    0,,PR3
         4 000115   000015 101003                    CMPX1   13,DU
         4 000116   000120 602011 4                  TNC     s:4711+5,X1
         4 000117   002064 710000 4                  TRA     FEP_FOUND
         4 000120   002064 710000 4                  TRA     FEP_FOUND
         4 000121   000135 710000 4                  TRA     s:4714
         4 000122   000340 710000 4                  TRA     s:4776
         4 000123   001075 710000 4                  TRA     s:4921
         4 000124   001324 710000 4                  TRA     s:4979
         4 000125   001426 710000 4                  TRA     s:5022
         4 000126   000312 710000 4                  TRA     s:4769
         4 000127   001510 710000 4                  TRA     s:5053
         4 000130   001540 710000 4                  TRA     s:5062
         4 000131   001555 710000 4                  TRA     s:5067
         4 000132   002011 710000 4                  TRA     s:5117
         4 000133   002037 710000 4                  TRA     s:5123
         4 000134   001523 710000 4                  TRA     s:5057

      215     4712        /**/
      216     4713    3               CASE (TSS_DEV);             /* DEVICE                             */

      217     4714    3                 CMD$ -> TS$DEV = NO;

   4714  4 000135   000000 474400 xsym               LDP4    CMD$
         4 000136   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:39   
         4 000137   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000140   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      218     4715    3                 CMD$ -> TS$DEV.SIZE = SIZEW(TS$DEV);

   4715  4 000141   000003 220003                    LDX0    3,DU
         4 000142   000000 471400 xsym               LDP1    CMD$
         4 000143   100000 740100                    STX0    0,,PR1

      219     4716    3                 CMD$ -> TS$DEV.CODE = TSS_DEV;

   4716  4 000144   000001 221003                    LDX1    1,DU
         4 000145   000000 471400 xsym               LDP1    CMD$
         4 000146   100000 441100                    SXL1    0,,PR1

      220     4717        /**/
      221     4718    3                 BLK$ = BLK$ -> O$BLK.SUBLK$(0);

   4718  4 000147   000000 471400 xsym               LDP1    BLK$
         4 000150   100003 236100                    LDQ     3,,PR1
         4 000151   000000 756000 xsym               STQ     BLK$

      222     4719    4                 DO CASE (BLK$ -> O$BLK.CODE); /* NAME OR PATH                   */

   4719  4 000152   000000 471400 xsym               LDP1    BLK$
         4 000153   100000 722100                    LXL2    0,,PR1
         4 000154   000003 102003                    CMPX2   3,DU
         4 000155   000157 602012 4                  TNC     s:4719+5,X2
         4 000156   002064 710000 4                  TRA     FEP_FOUND
         4 000157   000311 710000 4                  TRA     s:4766
         4 000160   000162 710000 4                  TRA     s:4722
         4 000161   000300 710000 4                  TRA     s:4764

      223     4720        /**/
      224     4721    4                  CASE (TSS_NAME);

      225     4722    5                    DO CASE ( BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE);
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:40   

   4722  4 000162   100003 473500                    LDP3    3,,PR1
         4 000163   300000 723100                    LXL3    0,,PR3
         4 000164   000012 103003                    CMPX3   10,DU
         4 000165   000167 602013 4                  TNC     s:4722+5,X3
         4 000166   000240 710000 4                  TRA     s:4742
         4 000167   000240 710000 4                  TRA     s:4742
         4 000170   000201 710000 4                  TRA     s:4725
         4 000171   000205 710000 4                  TRA     s:4727
         4 000172   000211 710000 4                  TRA     s:4729
         4 000173   000215 710000 4                  TRA     s:4731
         4 000174   000221 710000 4                  TRA     s:4733
         4 000175   000225 710000 4                  TRA     s:4735
         4 000176   000240 710000 4                  TRA     s:4742
         4 000177   000231 710000 4                  TRA     s:4737
         4 000200   000235 710000 4                  TRA     s:4739

      226     4723        /**/
      227     4724    5                     CASE (TSS_LP);

      228     4725    5                       CMD$ -> TS$DEV.NAME.MNEM = 'LP';

   4725  4 000201   000000 224000 3                  LDX4    0
         4 000202   000000 474400 xsym               LDP4    CMD$
         4 000203   400001 744100                    STX4    1,,PR4
         4 000204   000240 710000 4                  TRA     s:4742

      229     4726    5                     CASE (TSS_CR);

      230     4727    5                       CMD$ -> TS$DEV.NAME.MNEM = 'CR';

   4727  4 000205   000001 224000 3                  LDX4    1
         4 000206   000000 474400 xsym               LDP4    CMD$
         4 000207   400001 744100                    STX4    1,,PR4
         4 000210   000240 710000 4                  TRA     s:4742

      231     4728    5                     CASE (TSS_CP);
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:41   

      232     4729    5                       CMD$ -> TS$DEV.NAME.MNEM = 'CP';

   4729  4 000211   000002 224000 3                  LDX4    2
         4 000212   000000 474400 xsym               LDP4    CMD$
         4 000213   400001 744100                    STX4    1,,PR4
         4 000214   000240 710000 4                  TRA     s:4742

      233     4730    5                     CASE (TSS_DP);

      234     4731    5                       CMD$ -> TS$DEV.NAME.MNEM = 'DP';

   4731  4 000215   000003 224000 3                  LDX4    3
         4 000216   000000 474400 xsym               LDP4    CMD$
         4 000217   400001 744100                    STX4    1,,PR4
         4 000220   000240 710000 4                  TRA     s:4742

      235     4732    5                     CASE (TSS_MT);

      236     4733    5                       CMD$ -> TS$DEV.NAME.MNEM = 'MT';

   4733  4 000221   000004 224000 3                  LDX4    4
         4 000222   000000 474400 xsym               LDP4    CMD$
         4 000223   400001 744100                    STX4    1,,PR4
         4 000224   000240 710000 4                  TRA     s:4742

      237     4734    5                     CASE (TSS_SC);

      238     4735    5                       CMD$ -> TS$DEV.NAME.MNEM = 'SC';

   4735  4 000225   000005 224000 3                  LDX4    5
         4 000226   000000 474400 xsym               LDP4    CMD$
         4 000227   400001 744100                    STX4    1,,PR4
         4 000230   000240 710000 4                  TRA     s:4742

      239     4736    5                     CASE (TSS_AP);

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:42   
      240     4737    5                       CMD$ -> TS$DEV.NAME.MNEM = 'AP';

   4737  4 000231   000006 224000 3                  LDX4    6
         4 000232   000000 474400 xsym               LDP4    CMD$
         4 000233   400001 744100                    STX4    1,,PR4
         4 000234   000240 710000 4                  TRA     s:4742

      241     4738    5                     CASE (TSS_OD);

      242     4739    5                       CMD$ -> TS$DEV.NAME.MNEM = 'OD';

   4739  4 000235   000007 224000 3                  LDX4    7
         4 000236   000000 474400 xsym               LDP4    CMD$
         4 000237   400001 744100                    STX4    1,,PR4

      243     4740    5                     END;

      244     4741        /**/
      245     4742    4                    BLK$ = BLK$ -> O$BLK.SUBLK$(1); /* POINT TO NUMBER             */

   4742  4 000240   100004 236100                    LDQ     4,,PR1
         4 000241   000000 756000 xsym               STQ     BLK$

      246     4743        /**/
      247     4744    5                    IF (BLK$ -> O$SYM.COUNT = 2) THEN DO;

   4744  4 000242   000000 471400 xsym               LDP1    BLK$
         4 000243   100004 236100                    LDQ     4,,PR1
         4 000244   777000 376003                    ANQ     -512,DU
         4 000245   002000 116003                    CMPQ    1024,DU
         4 000246   000261 601000 4                  TNZ     s:4749

      248     4745    5                       CMD$ -> TS$DEV.NAME.NUM = BLK$ -> O$SYM.TEXT;

   4745  4 000247   100004 236100                    LDQ     4,,PR1
         4 000250   000033 772000                    QRL     27
         4 000251   000000 622006                    EAX2    0,QL
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:43   
         4 000252   000000 473400 xsym               LDP3    CMD$
         4 000253   040100 100540                    MLR     fill='040'O
         4 000254   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         4 000255   300001 400002                    ADSC9   1,,PR3                   cn=2,n=2

      249     4746    5                       CMD$ -> TS$DEV.NAME.TWSN = '0000';

   4746  4 000256   000010 236000 3                  LDQ     8
         4 000257   300002 756100                    STQ     2,,PR3

      250     4747    5                       END;

   4747  4 000260   002064 710000 4                  TRA     FEP_FOUND

      251     4748        /**/
      252     4749    5                    ELSE IF (BLK$ -> O$SYM.COUNT = 6) THEN DO;

   4749  4 000261   006000 116003                    CMPQ    3072,DU
         4 000262   000273 601000 4                  TNZ     s:4754

      253     4750    5                          CALL INSERT(CMD$ -> TS$DEV.DEVNAME,2,6,BLK$ -> O$SYM.TEXT);

   4750  4 000263   100004 236100                    LDQ     4,,PR1
         4 000264   000033 772000                    QRL     27
         4 000265   000000 622006                    EAX2    0,QL
         4 000266   000000 473400 xsym               LDP3    CMD$
         4 000267   040100 100540                    MLR     fill='040'O
         4 000270   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         4 000271   300001 400006                    ADSC9   1,,PR3                   cn=2,n=6

      254     4751    5                          END;

   4751  4 000272   002064 710000 4                  TRA     FEP_FOUND

      255     4752        /**/
      256     4753    5                       ELSE DO;

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:44   
      257     4754    5                          CALL TSE$ERROR(%E$T_BADDEVNUM);

   4754  4 000273   000002 630400 5                  EPPR0   2
         4 000274   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000275   000000 701000 xent               TSX1    TSE$ERROR
         4 000276   000000 011000                    NOP     0

      258     4755    5                          ALTRETURN;

   4755  4 000277   000000 702200 xent               TSX2  ! X66_AALT

      259     4756    5                          END;
      260     4757        /**/
      261     4758        /*E*    ERROR:   TSS-E$T_BADDEVNUM-0
      262     4759                MESSAGE: Illegal device number - must be 2 or 6 digits.
      263     4760                DESCRIPTION: DEV NUMBER MUST BE 2 CHAR W/O WORKSTATION,
      264     4761                             OR 6 WITH WORKSTATION        */
      265     4762        /**/
      266     4763    4                  CASE (TSS_PATH);

      267     4764    4                    CALL PATH_2_NAME (BLK$ -> O$BLK,CMD$ -> TS$DEV.DEVNAME,

   4764  4 000300   000003 236000 5                  LDQ     3
         4 000301   200021 756100                    STQ     @NAME+1,,AUTO
         4 000302   000000 236000 xsym               LDQ     CMD$
         4 000303   000001 036003                    ADLQ    1,DU
         4 000304   200020 756100                    STQ     @O_BLK+1,,AUTO
         4 000305   000000 236000 xsym               LDQ     BLK$
         4 000306   200017 756100                    STQ     MPCNAME+3,,AUTO
         4 000307   002117 701000 4                  TSX1    PATH_2_NAME
         4 000310   002116 702000 4                  TSX2    BAD_PATH

      268     4765    4                      TSS_DEV) ALTRET (BAD_PATH);
      269     4766    4                  END;

   4766  4 000311   002064 710000 4                  TRA     FEP_FOUND

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:45   
      270     4767        /**/
      271     4768    3               CASE (TSS_IOM);

      272     4769    3                 BLK$ = BLK$->O$BLK.SUBLK$(0);

   4769  4 000312   300003 236100                    LDQ     3,,PR3
         4 000313   000000 756000 xsym               STQ     BLK$

      273     4770    3                 CMD$ -> TS$IOM = NO;

   4770  4 000314   000000 473400 xsym               LDP3    CMD$
         4 000315   300000 450100                    STZ     0,,PR3
         4 000316   300001 450100                    STZ     1,,PR3

      274     4771    3                 CMD$ -> TS$IOM.CODE = TSS_IOM;

   4771  4 000317   000006 220003                    LDX0    6,DU
         4 000320   000000 471400 xsym               LDP1    CMD$
         4 000321   100000 440100                    SXL0    0,,PR1

      275     4772    3                 CMD$ -> TS$IOM.SIZE = SIZEW(TS$IOM);

   4772  4 000322   000002 221003                    LDX1    2,DU
         4 000323   000000 471400 xsym               LDP1    CMD$
         4 000324   100000 741100                    STX1    0,,PR1

      276     4773    3                 CALL CHARBIN(CMD$->TS$IOM.IOM,BLK$->O$SYM.TEXT);

   4773  4 000325   000000 471400 xsym               LDP1    BLK$
         4 000326   100004 236100                    LDQ     4,,PR1
         4 000327   000033 772000                    QRL     27
         4 000330   000000 622006                    EAX2    0,QL
         4 000331   000100 305540                    DTB
         4 000332   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
         4 000333   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000334   000000 473400 xsym               LDP3    CMD$
         4 000335   200025 235100                    LDA     MNEM+3,,AUTO
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:46   
         4 000336   300001 755100                    STA     1,,PR3
         4 000337   002064 710000 4                  TRA     FEP_FOUND

      277     4774        /**/
      278     4775    3               CASE (TSS_MPC);

      279     4776    3                 MPC_CHANS = YES;

   4776  4 000340   400000 236003                    LDQ     -131072,DU
         4 000341   200012 756100                    STQ     MPC_CHANS,,AUTO

      280     4777    3                 MPC_DEVS = NO;

   4777  4 000342   200013 450100                    STZ     MPC_DEVS,,AUTO

      281     4778    4                 IF BLK$->O$BLK.NSUBLKS > 1 THEN DO;  /* MPC OPTIONS */

   4778  4 000343   300001 222100                    LDX2    1,,PR3
         4 000344   000002 102003                    CMPX2   2,DU
         4 000345   000417 602000 4                  TNC     s:4795

      282     4779    4                    IF (CMD_BASE$->TS$CMDWD ~= TSS_RET) AND

   4779  4 000346   000000 474400 xsym               LDP4    CMD_BASE$
         4 000347   400000 235100                    LDA     0,,PR4
         4 000350   000002 115007                    CMPA    2,DL
         4 000351   000361 600000 4                  TZE     s:4784
         4 000352   000001 115007                    CMPA    1,DL
         4 000353   000361 600000 4                  TZE     s:4784

      283     4780    5                       (CMD_BASE$->TS$CMDWD ~= TSS_PART) THEN DO;

      284     4781    5                       CALL TSE$ERROR(%E$T_DEVNOTRET);

   4781  4 000354   000005 630400 5                  EPPR0   5
         4 000355   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000356   000000 701000 xent               TSX1    TSE$ERROR
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:47   
         4 000357   000000 011000                    NOP     0

      285     4782    5                       ALTRETURN;

   4782  4 000360   000000 702200 xent               TSX2  ! X66_AALT

      286     4783    5                       END;  /* IF NOT RET OR PART */
      287     4784    5                    DO J = 1 TO BLK$->O$BLK.NSUBLKS - 1;

   4784  4 000361   000001 235007                    LDA     1,DL
         4 000362   000000 755000 xsym               STA     J
         4 000363   000412 710000 4                  TRA     s:4793+1

      288     4785    6                       DO CASE(BLK$->O$BLK.SUBLK$(J)->O$BLK.CODE);

   4785  4 000364   000000 470400 xsym               LDP0    BLK$
         4 000365   000000 720000 xsym               LXL0    J
         4 000366   000003 471510                    LDP1    3,X0,PR0
         4 000367   100000 236100                    LDQ     0,,PR1
         4 000370   777777 376007                    ANQ     -1,DL
         4 000371   000151 136007                    SBLQ    105,DL
         4 000372   000005 116007                    CMPQ    5,DL
         4 000373   000375 602006 4                  TNC     s:4785+9,QL
         4 000374   000411 710000 4                  TRA     s:4793
         4 000375   000402 710000 4                  TRA     s:4787
         4 000376   000411 710000 4                  TRA     s:4793
         4 000377   000411 710000 4                  TRA     s:4793
         4 000400   000405 710000 4                  TRA     s:4789
         4 000401   000410 710000 4                  TRA     s:4791

      289     4786    6                          CASE(TSS_DEVLIT);

      290     4787    6                             MPC_DEVS = YES;

   4787  4 000402   400000 236003                    LDQ     -131072,DU
         4 000403   200013 756100                    STQ     MPC_DEVS,,AUTO
         4 000404   000411 710000 4                  TRA     s:4793
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:48   

      291     4788    6                          CASE(TSS_CHANSOPT);

      292     4789    6                             MPC_CHANS = YES;

   4789  4 000405   400000 236003                    LDQ     -131072,DU
         4 000406   200012 756100                    STQ     MPC_CHANS,,AUTO
         4 000407   000411 710000 4                  TRA     s:4793

      293     4790    6                          CASE(TSS_NCHANSOPT);

      294     4791    6                             MPC_CHANS = NO;

   4791  4 000410   200012 450100                    STZ     MPC_CHANS,,AUTO

      295     4792    6                          END;  /* DO CASE */

      296     4793    5                       END;  /* DO J */

   4793  4 000411   000000 054000 xsym               AOS     J
         4 000412   000000 470400 xsym               LDP0    BLK$
         4 000413   000001 236100                    LDQ     1,,PR0
         4 000414   000022 772000                    QRL     18
         4 000415   000000 116000 xsym               CMPQ    J
         4 000416   000364 605400 4                  TPNZ    s:4785

      297     4794    4                    END;  /* IF MPC OPTIONS */

      298     4795    3                 BLK$ = BLK$ -> O$BLK.SUBLK$(0);

   4795  4 000417   000000 470400 xsym               LDP0    BLK$
         4 000420   000003 236100                    LDQ     3,,PR0
         4 000421   000000 756000 xsym               STQ     BLK$

      299     4796    4                 DO CASE (BLK$ -> O$BLK.CODE); /* PATH OR NAME                   */

   4796  4 000422   000000 470400 xsym               LDP0    BLK$
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:49   
         4 000423   000000 720100                    LXL0    0,,PR0
         4 000424   000003 100003                    CMPX0   3,DU
         4 000425   000427 602010 4                  TNC     s:4796+5,X0
         4 000426   000514 710000 4                  TRA     s:4829
         4 000427   000514 710000 4                  TRA     s:4829
         4 000430   000432 710000 4                  TRA     s:4799
         4 000431   000504 710000 4                  TRA     s:4825

      300     4797        /**/
      301     4798    4                  CASE (TSS_NAME);

      302     4799    5                    DO CASE (BLK$ -> O$BLK.SUBLK$(0) -> O$BLK.CODE);

   4799  4 000432   000003 471500                    LDP1    3,,PR0
         4 000433   100000 721100                    LXL1    0,,PR1
         4 000434   000005 101003                    CMPX1   5,DU
         4 000435   000437 602011 4                  TNC     s:4799+5,X1
         4 000436   000457 710000 4                  TRA     s:4811
         4 000437   000457 710000 4                  TRA     s:4811
         4 000440   000444 710000 4                  TRA     s:4802
         4 000441   000447 710000 4                  TRA     s:4804
         4 000442   000452 710000 4                  TRA     s:4806
         4 000443   000455 710000 4                  TRA     s:4808

      303     4800        /**/
      304     4801    5                     CASE (TSS_DC);

      305     4802    5                       NAME.MNEM = 'DC';

   4802  4 000444   000011 222000 3                  LDX2    9
         4 000445   200014 742100                    STX2    MPCNAME,,AUTO
         4 000446   000457 710000 4                  TRA     s:4811

      306     4803    5                     CASE (TSS_TC);

      307     4804    5                       NAME.MNEM = 'TC';

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:50   
   4804  4 000447   000012 222000 3                  LDX2    10
         4 000450   200014 742100                    STX2    MPCNAME,,AUTO
         4 000451   000457 710000 4                  TRA     s:4811

      308     4805    5                     CASE (TSS_UC);

      309     4806    5                       NAME.MNEM = 'UC';

   4806  4 000452   000013 222000 3                  LDX2    11
         4 000453   200014 742100                    STX2    MPCNAME,,AUTO
         4 000454   000457 710000 4                  TRA     s:4811

      310     4807    5                     CASE (TSS_AC);

      311     4808    5                       NAME.MNEM = 'AC';

   4808  4 000455   000014 222000 3                  LDX2    12
         4 000456   200014 742100                    STX2    MPCNAME,,AUTO

      312     4809    5                     END;

      313     4810        /**/
      314     4811    4                    BLK$ = BLK$ -> O$BLK.SUBLK$(1); /* POINT TO NUMBER             */

   4811  4 000457   000004 236100                    LDQ     4,,PR0
         4 000460   000000 756000 xsym               STQ     BLK$

      315     4812    5                    IF (BLK$ -> O$SYM.COUNT ~= 2) THEN DO;

   4812  4 000461   000000 470400 xsym               LDP0    BLK$
         4 000462   000004 236100                    LDQ     4,,PR0
         4 000463   777000 376003                    ANQ     -512,DU
         4 000464   002000 116003                    CMPQ    1024,DU
         4 000465   000473 600000 4                  TZE     s:4821

      316     4813    5                       CALL TSE$ERROR(%E$T_BADMPCNUM);

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:51   
   4813  4 000466   000007 630400 5                  EPPR0   7
         4 000467   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000470   000000 701000 xent               TSX1    TSE$ERROR
         4 000471   000000 011000                    NOP     0

      317     4814    5                       ALTRETURN;

   4814  4 000472   000000 702200 xent               TSX2  ! X66_AALT

      318     4815    5                       END;
      319     4816        /**/
      320     4817        /*E*    ERROR:  TSS-E$T_BADMPCNUM-0
      321     4818                MESSAGE: Illegal MPC number - must be 2 digits.
      322     4819                DESCRIPTION: SEE MESSAGE        */
      323     4820        /**/
      324     4821    4                    NAME.NUM = BLK$ -> O$SYM.TEXT;

   4821  4 000473   000004 236100                    LDQ     4,,PR0
         4 000474   000033 772000                    QRL     27
         4 000475   000000 620006                    EAX0    0,QL
         4 000476   040100 100540                    MLR     fill='040'O
         4 000477   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000500   200014 400002                    ADSC9   MPCNAME,,AUTO            cn=2,n=2

      325     4822    4                    NAME.TWSN = '0000';

   4822  4 000501   000010 236000 3                  LDQ     8
         4 000502   200015 756100                    STQ     MPCNAME+1,,AUTO
         4 000503   000514 710000 4                  TRA     s:4829

      326     4823        /**/
      327     4824    4                  CASE (TSS_PATH);

      328     4825    4                    CALL PATH_2_NAME (BLK$ -> O$BLK,MPCNAME,

   4825  4 000504   000010 236000 5                  LDQ     8
         4 000505   200021 756100                    STQ     @NAME+1,,AUTO
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:52   
         4 000506   200014 631500                    EPPR1   MPCNAME,,AUTO
         4 000507   200020 451500                    STP1    @O_BLK+1,,AUTO
         4 000510   000000 236000 xsym               LDQ     BLK$
         4 000511   200017 756100                    STQ     MPCNAME+3,,AUTO
         4 000512   002117 701000 4                  TSX1    PATH_2_NAME
         4 000513   002116 702000 4                  TSX2    BAD_PATH

      329     4826    4                      TSS_MPC) ALTRET (BAD_PATH);
      330     4827    4                  END;

      331     4828
      332     4829    4                 IF CMD_BASE$->TS$CMDWD = TSS_PART THEN DO;

   4829  4 000514   000000 470400 xsym               LDP0    CMD_BASE$
         4 000515   000000 235100                    LDA     0,,PR0
         4 000516   000001 115007                    CMPA    1,DL
         4 000517   000674 601000 4                  TNZ     s:4870

      333     4830    5                    IF MPC_DEVS THEN DO;

   4830  4 000520   200013 234100                    SZN     MPC_DEVS,,AUTO
         4 000521   000605 605000 4                  TPL     s:4850

      334     4831    5                       CONFIG_KEY.COUNT = 8;

   4831  4 000522   010000 236003                    LDQ     4096,DU
         4 000523   000000 552040 xsym               STBQ    CONFIG_KEY,'40'O

      335     4832    5                       CONFIG_KEY.TEXT = MPCNAME;

   4832  4 000524   040000 100500                    MLR     fill='040'O
         4 000525   200014 000010                    ADSC9   MPCNAME,,AUTO            cn=0,n=8
         4 000526   000000 200010 xsym               ADSC9   CONFIG_KEY               cn=1,n=8

      336     4833           /**/
      337     4834    5                       CALL M$OPEN (OPEN_CONFIG) ALTRET (CONFIG_ERR);

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:53   
   4834  4 000527   000002 630400 1                  EPPR0   OPEN_CONFIG
         4 000530   450000 713400                    CLIMB   alt,open
         4 000531   410400 401760                    pmme    nvectors=18
         4 000532   002103 702000 4                  TSX2    CONFIG_ERR

      338     4835    5                       CALL M$READ (READ_CONFIG) ALTRET (CONFIG_ERR);

   4835  4 000533   000132 630400 1                  EPPR0   READ_CONFIG
         4 000534   440000 713400                    CLIMB   alt,read
         4 000535   401400 401760                    pmme    nvectors=4
         4 000536   002103 702000 4                  TSX2    CONFIG_ERR

      339     4836    5                       CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);

   4836  4 000537   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 000540   450001 713400                    CLIMB   alt,close
         4 000541   406000 401760                    pmme    nvectors=13
         4 000542   002103 702000 4                  TSX2    CONFIG_ERR

      340     4837           /**/
      341     4838    6                       IF (CONFIG$ -> TD$MPC.NUMDEVS ~= 0) THEN DO;

   4838  4 000543   000000 470400 xsym               LDP0    CONFIG$
         4 000544   000012 220100                    LDX0    10,,PR0
         4 000545   000605 600000 4                  TZE     s:4850

      342     4839    6                          K = CONFIG$ -> TD$MPC.NUMDEVS - 1;

   4839  4 000546   000012 236100                    LDQ     10,,PR0
         4 000547   000022 772000                    QRL     18
         4 000550   000001 136007                    SBLQ    1,DL
         4 000551   000000 756000 xsym               STQ     K

      343     4840           /**/
      344     4841    7                          DO J = 0 TO K;      /* ALL DEVICES                        */

   4841  4 000552   000000 450000 xsym               STZ     J
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:54   
         4 000553   000602 710000 4                  TRA     s:4847+1

      345     4842    7                             CMD$ -> TS$DEV = NO;

   4842  4 000554   000000 470400 xsym               LDP0    CMD$
         4 000555   000100 100400                    MLR     fill='000'O
         4 000556   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000557   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      346     4843    7                             CMD$ -> TS$DEV.SIZE = SIZEW(TS$DEV);

   4843  4 000560   000003 220003                    LDX0    3,DU
         4 000561   000000 470400 xsym               LDP0    CMD$
         4 000562   000000 740100                    STX0    0,,PR0

      347     4844    7                             CMD$ -> TS$DEV.CODE = TSS_DEV;

   4844  4 000563   000001 221003                    LDX1    1,DU
         4 000564   000000 470400 xsym               LDP0    CMD$
         4 000565   000000 441100                    SXL1    0,,PR0

      348     4845    7                             CMD$ -> TS$DEV.DEVNAME = CONFIG$ -> TD$MPC.DEVNAME(J);

   4845  4 000566   000000 235000 xsym               LDA     J
         4 000567   000003 735000                    ALS     3
         4 000570   000000 470400 xsym               LDP0    CONFIG$
         4 000571   000000 471400 xsym               LDP1    CMD$
         4 000572   040100 100505                    MLR     fill='040'O
         4 000573   000017 000010                    ADSC9   15,A,PR0                 cn=0,n=8
         4 000574   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

      349     4846    7                             CMD$ = PINCRW(CMD$,CMD$->TS$DEV.SIZE);

   4846  4 000575   100000 222100                    LDX2    0,,PR1
         4 000576   000000 636012                    EAQ     0,X2
         4 000577   000000 036000 xsym               ADLQ    CMD$
         4 000600   000000 756000 xsym               STQ     CMD$
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:55   

      350     4847    7                             END;  /* DO J */

   4847  4 000601   000000 054000 xsym               AOS     J
         4 000602   000000 236000 xsym               LDQ     J
         4 000603   000000 116000 xsym               CMPQ    K
         4 000604   000554 604400 4                  TMOZ    s:4842

      351     4848    6                          END;  /* IF NUMDEVS ~= 0 */

      352     4849    5                       END;  /* IF MPC_DEVS */

      353     4850    5                    IF MPC_CHANS THEN DO;

   4850  4 000605   200012 234100                    SZN     MPC_CHANS,,AUTO
         4 000606   000674 605000 4                  TPL     s:4870

      354     4851    5                       CONFIG_KEY.COUNT = 8;

   4851  4 000607   010000 236003                    LDQ     4096,DU
         4 000610   000000 552040 xsym               STBQ    CONFIG_KEY,'40'O

      355     4852    5                       CONFIG_KEY.TEXT = MPCNAME;

   4852  4 000611   040000 100500                    MLR     fill='040'O
         4 000612   200014 000010                    ADSC9   MPCNAME,,AUTO            cn=0,n=8
         4 000613   000000 200010 xsym               ADSC9   CONFIG_KEY               cn=1,n=8

      356     4853           /**/
      357     4854    5                       CALL M$OPEN (OPEN_CONFIG) ALTRET (CONFIG_ERR);

   4854  4 000614   000002 630400 1                  EPPR0   OPEN_CONFIG
         4 000615   450000 713400                    CLIMB   alt,open
         4 000616   410400 401760                    pmme    nvectors=18
         4 000617   002103 702000 4                  TSX2    CONFIG_ERR

      358     4855    5                       CALL M$READ (READ_CONFIG) ALTRET (CONFIG_ERR);
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:56   

   4855  4 000620   000132 630400 1                  EPPR0   READ_CONFIG
         4 000621   440000 713400                    CLIMB   alt,read
         4 000622   401400 401760                    pmme    nvectors=4
         4 000623   002103 702000 4                  TSX2    CONFIG_ERR

      359     4856    5                       CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);

   4856  4 000624   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 000625   450001 713400                    CLIMB   alt,close
         4 000626   406000 401760                    pmme    nvectors=13
         4 000627   002103 702000 4                  TSX2    CONFIG_ERR

      360     4857    6                       DO J = 0 TO 7;

   4857  4 000630   000000 450000 xsym               STZ     J

      361     4858    7                          IF CONFIG$->TD$MPC.IOCHAN.PRESENCE(J) THEN DO;

   4858  4 000631   000000 470400 xsym               LDP0    CONFIG$
         4 000632   000000 720000 xsym               LXL0    J
         4 000633   000002 234110                    SZN     2,X0,PR0
         4 000634   000670 605000 4                  TPL     s:4867

      362     4859    7                             CMD$->TS$CHAN = NO;

   4859  4 000635   000000 471400 xsym               LDP1    CMD$
         4 000636   000100 100400                    MLR     fill='000'O
         4 000637   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000640   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16

      363     4860    7                             CMD$->TS$CHAN.SIZE = SIZEW(TS$CHAN);

   4860  4 000641   000004 220003                    LDX0    4,DU
         4 000642   000000 470400 xsym               LDP0    CMD$
         4 000643   000000 740100                    STX0    0,,PR0

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:57   
      364     4861    7                             CMD$->TS$CHAN.CODE = TSS_CHAN;

   4861  4 000644   000000 470400 xsym               LDP0    CMD$
         4 000645   000000 440100                    SXL0    0,,PR0

      365     4862    7                             CMD$->TS$CHAN.IOM = CONFIG$->TD$MPC.IOCHAN.IOM(J);

   4862  4 000646   000000 470400 xsym               LDP0    CONFIG$
         4 000647   000000 721000 xsym               LXL1    J
         4 000650   000000 471400 xsym               LDP1    CMD$
         4 000651   000002 236111                    LDQ     2,X1,PR0
         4 000652   000022 772000                    QRL     18
         4 000653   000777 376007                    ANQ     511,DL
         4 000654   100001 756100                    STQ     1,,PR1

      366     4863    7                             CMD$->TS$CHAN.LOCHAN = CONFIG$->TD$MPC.IOCHAN.LOCHAN(J);

   4863  4 000655   000002 236111                    LDQ     2,X1,PR0
         4 000656   000011 772000                    QRL     9
         4 000657   000777 376007                    ANQ     511,DL
         4 000660   100002 756100                    STQ     2,,PR1

      367     4864    7                             CMD$->TS$CHAN.HICHAN = CONFIG$->TD$MPC.IOCHAN.HICHAN(J);

   4864  4 000661   000002 236111                    LDQ     2,X1,PR0
         4 000662   000777 376007                    ANQ     511,DL
         4 000663   100003 756100                    STQ     3,,PR1

      368     4865    7                             CMD$ = PINCRW(CMD$,CMD$->TS$CHAN.SIZE);

   4865  4 000664   100000 222100                    LDX2    0,,PR1
         4 000665   000000 636012                    EAQ     0,X2
         4 000666   000000 036000 xsym               ADLQ    CMD$
         4 000667   000000 756000 xsym               STQ     CMD$

      369     4866    7                             END;  /* IF IOCHAN.PRESENCE */

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:58   
      370     4867    6                          END;  /* DO J */

   4867  4 000670   000000 054000 xsym               AOS     J
         4 000671   000000 235000 xsym               LDA     J
         4 000672   000007 115007                    CMPA    7,DL
         4 000673   000631 604400 4                  TMOZ    s:4858

      371     4868    5                       END;  /* IF MPC_CHANS */

      372     4869    4                    END;  /* IF TSS_PART */

      373     4870    3                 CMD$ -> TS$MPC = NO;

   4870  4 000674   000000 470400 xsym               LDP0    CMD$
         4 000675   000100 100400                    MLR     fill='000'O
         4 000676   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000677   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      374     4871    3                 CMD$ -> TS$MPC.SIZE = SIZEW(TS$MPC);

   4871  4 000700   000003 220003                    LDX0    3,DU
         4 000701   000000 470400 xsym               LDP0    CMD$
         4 000702   000000 740100                    STX0    0,,PR0

      375     4872    3                 CMD$ -> TS$MPC.CODE = TSS_MPC;

   4872  4 000703   000002 221003                    LDX1    2,DU
         4 000704   000000 470400 xsym               LDP0    CMD$
         4 000705   000000 441100                    SXL1    0,,PR0

      376     4873    3                 CMD$ -> TS$MPC.MPCNAME = MPCNAME;

   4873  4 000706   000000 470400 xsym               LDP0    CMD$
         4 000707   200014 237100                    LDAQ    MPCNAME,,AUTO
         4 000710   000001 755100                    STA     1,,PR0
         4 000711   000002 756100                    STQ     2,,PR0

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:59   
      377     4874        /**/
      378     4875    4                 IF CMD_BASE$->TS$CMDWD = TSS_RET THEN DO;

   4875  4 000712   000000 471400 xsym               LDP1    CMD_BASE$
         4 000713   100000 235100                    LDA     0,,PR1
         4 000714   000002 115007                    CMPA    2,DL
         4 000715   002064 601000 4                  TNZ     FEP_FOUND

      379     4876    5                    IF MPC_CHANS THEN DO;

   4876  4 000716   200012 234100                    SZN     MPC_CHANS,,AUTO
         4 000717   001006 605000 4                  TPL     s:4895

      380     4877    5                       CONFIG_KEY.COUNT = 8;

   4877  4 000720   010000 236003                    LDQ     4096,DU
         4 000721   000000 552040 xsym               STBQ    CONFIG_KEY,'40'O

      381     4878    5                       CONFIG_KEY.TEXT = MPCNAME;

   4878  4 000722   040000 100500                    MLR     fill='040'O
         4 000723   200014 000010                    ADSC9   MPCNAME,,AUTO            cn=0,n=8
         4 000724   000000 200010 xsym               ADSC9   CONFIG_KEY               cn=1,n=8

      382     4879           /**/
      383     4880    5                       CALL M$OPEN (OPEN_CONFIG) ALTRET (CONFIG_ERR);

   4880  4 000725   000002 630400 1                  EPPR0   OPEN_CONFIG
         4 000726   450000 713400                    CLIMB   alt,open
         4 000727   410400 401760                    pmme    nvectors=18
         4 000730   002103 702000 4                  TSX2    CONFIG_ERR

      384     4881    5                       CALL M$READ (READ_CONFIG) ALTRET (CONFIG_ERR);

   4881  4 000731   000132 630400 1                  EPPR0   READ_CONFIG
         4 000732   440000 713400                    CLIMB   alt,read
         4 000733   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:60   
         4 000734   002103 702000 4                  TSX2    CONFIG_ERR

      385     4882    5                       CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);

   4882  4 000735   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 000736   450001 713400                    CLIMB   alt,close
         4 000737   406000 401760                    pmme    nvectors=13
         4 000740   002103 702000 4                  TSX2    CONFIG_ERR

      386     4883    6                       DO J = 0 TO 7;

   4883  4 000741   000000 450000 xsym               STZ     J

      387     4884    7                          IF CONFIG$->TD$MPC.IOCHAN.PRESENCE(J) THEN DO;

   4884  4 000742   000000 470400 xsym               LDP0    CONFIG$
         4 000743   000000 720000 xsym               LXL0    J
         4 000744   000002 234110                    SZN     2,X0,PR0
         4 000745   001002 605000 4                  TPL     s:4893

      388     4885    7                             CMD$ = PINCRW(CMD$,CMD$->TS$CHAN.SIZE);

   4885  4 000746   000000 471400 xsym               LDP1    CMD$
         4 000747   100000 221100                    LDX1    0,,PR1
         4 000750   000000 636011                    EAQ     0,X1
         4 000751   000000 036000 xsym               ADLQ    CMD$
         4 000752   000000 756000 xsym               STQ     CMD$

      389     4886    7                             CMD$->TS$CHAN = NO;

   4886  4 000753   000000 471400 xsym               LDP1    CMD$
         4 000754   000100 100400                    MLR     fill='000'O
         4 000755   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000756   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16

      390     4887    7                             CMD$->TS$CHAN.SIZE = SIZEW(TS$CHAN);

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:61   
   4887  4 000757   000004 220003                    LDX0    4,DU
         4 000760   000000 470400 xsym               LDP0    CMD$
         4 000761   000000 740100                    STX0    0,,PR0

      391     4888    7                             CMD$->TS$CHAN.CODE = TSS_CHAN;

   4888  4 000762   000000 470400 xsym               LDP0    CMD$
         4 000763   000000 440100                    SXL0    0,,PR0

      392     4889    7                             CMD$->TS$CHAN.IOM = CONFIG$->TD$MPC.IOCHAN.IOM(J);

   4889  4 000764   000000 470400 xsym               LDP0    CONFIG$
         4 000765   000000 721000 xsym               LXL1    J
         4 000766   000000 471400 xsym               LDP1    CMD$
         4 000767   000002 236111                    LDQ     2,X1,PR0
         4 000770   000022 772000                    QRL     18
         4 000771   000777 376007                    ANQ     511,DL
         4 000772   100001 756100                    STQ     1,,PR1

      393     4890    7                             CMD$->TS$CHAN.LOCHAN = CONFIG$->TD$MPC.IOCHAN.LOCHAN(J);

   4890  4 000773   000002 236111                    LDQ     2,X1,PR0
         4 000774   000011 772000                    QRL     9
         4 000775   000777 376007                    ANQ     511,DL
         4 000776   100002 756100                    STQ     2,,PR1

      394     4891    7                             CMD$->TS$CHAN.HICHAN = CONFIG$->TD$MPC.IOCHAN.HICHAN(J);

   4891  4 000777   000002 236111                    LDQ     2,X1,PR0
         4 001000   000777 376007                    ANQ     511,DL
         4 001001   100003 756100                    STQ     3,,PR1

      395     4892    7                             END;  /* IF IOCHAN.PRESENCE */

      396     4893    6                          END;  /* DO J */

   4893  4 001002   000000 054000 xsym               AOS     J
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:62   
         4 001003   000000 235000 xsym               LDA     J
         4 001004   000007 115007                    CMPA    7,DL
         4 001005   000742 604400 4                  TMOZ    s:4884

      397     4894    5                       END;  /* IF MPC_CHANS */

      398     4895    5                    IF MPC_DEVS THEN DO;

   4895  4 001006   200013 234100                    SZN     MPC_DEVS,,AUTO
         4 001007   002064 605000 4                  TPL     FEP_FOUND

      399     4896    5                       CONFIG_KEY.COUNT = 8;

   4896  4 001010   010000 236003                    LDQ     4096,DU
         4 001011   000000 552040 xsym               STBQ    CONFIG_KEY,'40'O

      400     4897    5                       CONFIG_KEY.TEXT = MPCNAME;

   4897  4 001012   040000 100500                    MLR     fill='040'O
         4 001013   200014 000010                    ADSC9   MPCNAME,,AUTO            cn=0,n=8
         4 001014   000000 200010 xsym               ADSC9   CONFIG_KEY               cn=1,n=8

      401     4898           /**/
      402     4899    5                       CALL M$OPEN (OPEN_CONFIG) ALTRET (CONFIG_ERR);

   4899  4 001015   000002 630400 1                  EPPR0   OPEN_CONFIG
         4 001016   450000 713400                    CLIMB   alt,open
         4 001017   410400 401760                    pmme    nvectors=18
         4 001020   002103 702000 4                  TSX2    CONFIG_ERR

      403     4900    5                       CALL M$READ (READ_CONFIG) ALTRET (CONFIG_ERR);

   4900  4 001021   000132 630400 1                  EPPR0   READ_CONFIG
         4 001022   440000 713400                    CLIMB   alt,read
         4 001023   401400 401760                    pmme    nvectors=4
         4 001024   002103 702000 4                  TSX2    CONFIG_ERR

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:63   
      404     4901    5                       CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);

   4901  4 001025   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 001026   450001 713400                    CLIMB   alt,close
         4 001027   406000 401760                    pmme    nvectors=13
         4 001030   002103 702000 4                  TSX2    CONFIG_ERR

      405     4902           /**/
      406     4903    6                       IF (CONFIG$ -> TD$MPC.NUMDEVS ~= 0) THEN DO;

   4903  4 001031   000000 470400 xsym               LDP0    CONFIG$
         4 001032   000012 220100                    LDX0    10,,PR0
         4 001033   002064 600000 4                  TZE     FEP_FOUND

      407     4904    6                          K = CONFIG$ -> TD$MPC.NUMDEVS - 1;

   4904  4 001034   000012 236100                    LDQ     10,,PR0
         4 001035   000022 772000                    QRL     18
         4 001036   000001 136007                    SBLQ    1,DL
         4 001037   000000 756000 xsym               STQ     K

      408     4905           /**/
      409     4906    7                          DO J = 0 TO K;      /* ALL DEVICES                        */

   4906  4 001040   000000 450000 xsym               STZ     J
         4 001041   001071 710000 4                  TRA     s:4912+1

      410     4907    7                             CMD$ = PINCRW(CMD$,CMD$->TS$DEV.SIZE);

   4907  4 001042   000000 470400 xsym               LDP0    CMD$
         4 001043   000000 220100                    LDX0    0,,PR0
         4 001044   000000 636010                    EAQ     0,X0
         4 001045   000000 036000 xsym               ADLQ    CMD$
         4 001046   000000 756000 xsym               STQ     CMD$

      411     4908    7                             CMD$ -> TS$DEV = NO;

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:64   
   4908  4 001047   000000 470400 xsym               LDP0    CMD$
         4 001050   000100 100400                    MLR     fill='000'O
         4 001051   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001052   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      412     4909    7                             CMD$ -> TS$DEV.SIZE = SIZEW(TS$DEV);

   4909  4 001053   000003 220003                    LDX0    3,DU
         4 001054   000000 470400 xsym               LDP0    CMD$
         4 001055   000000 740100                    STX0    0,,PR0

      413     4910    7                             CMD$ -> TS$DEV.CODE = TSS_DEV;

   4910  4 001056   000001 221003                    LDX1    1,DU
         4 001057   000000 470400 xsym               LDP0    CMD$
         4 001060   000000 441100                    SXL1    0,,PR0

      414     4911    7                             CMD$ -> TS$DEV.DEVNAME = CONFIG$ -> TD$MPC.DEVNAME(J);

   4911  4 001061   000000 235000 xsym               LDA     J
         4 001062   000003 735000                    ALS     3
         4 001063   000000 470400 xsym               LDP0    CONFIG$
         4 001064   000000 471400 xsym               LDP1    CMD$
         4 001065   040100 100505                    MLR     fill='040'O
         4 001066   000017 000010                    ADSC9   15,A,PR0                 cn=0,n=8
         4 001067   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

      415     4912    7                             END;  /* DO J */

   4912  4 001070   000000 054000 xsym               AOS     J
         4 001071   000000 236000 xsym               LDQ     J
         4 001072   000000 116000 xsym               CMPQ    K
         4 001073   001042 604400 4                  TMOZ    s:4907

      416     4913    6                          END;  /* IF NUMDEVS ~= 0 */

      417     4914    5                       END;  /* IF MPC_DEVS */
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:65   

      418     4915    4                    END;  /* IF TSS_RET */

   4915  4 001074   002064 710000 4                  TRA     FEP_FOUND

      419     4916        /*E*    ERROR: TSS-E$T_DEVNOTRET-0
      420     4917          MESSAGE: Illegal to specify 'DEVICES' except on 'RETURN' or 'PARTITION' commands.
      421     4918                DESCRIPTION: 'DECICES SAID ON OTHER COMMAND THAN RETURN */
      422     4919        /**/
      423     4920    3               CASE (TSS_FEP);

      424     4921    3                 CMD$ -> TS$FEP = NO;

   4921  4 001075   000000 474400 xsym               LDP4    CMD$
         4 001076   000100 100400                    MLR     fill='000'O
         4 001077   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001100   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      425     4922    3                 CMD$ -> TS$FEP.SIZE = SIZEW(TS$FEP);

   4922  4 001101   000003 220003                    LDX0    3,DU
         4 001102   000000 471400 xsym               LDP1    CMD$
         4 001103   100000 740100                    STX0    0,,PR1

      426     4923    3                 CMD$ -> TS$FEP.CODE = TSS_FEP;

   4923  4 001104   000000 471400 xsym               LDP1    CMD$
         4 001105   100000 440100                    SXL0    0,,PR1

      427     4924        /**/
      428     4925    3                 BLK$ = BLK$ -> O$BLK.SUBLK$(0);

   4925  4 001106   000000 471400 xsym               LDP1    BLK$
         4 001107   100003 236100                    LDQ     3,,PR1
         4 001110   000000 756000 xsym               STQ     BLK$

      429     4926    4                 DO CASE (BLK$ -> O$BLK.CODE); /* PATH OR NAME                   */
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:66   

   4926  4 001111   000000 471400 xsym               LDP1    BLK$
         4 001112   100000 721100                    LXL1    0,,PR1
         4 001113   000003 101003                    CMPX1   3,DU
         4 001114   001116 602011 4                  TNC     s:4926+5,X1
         4 001115   001224 710000 4                  TRA     s:4958
         4 001116   001224 710000 4                  TRA     s:4958
         4 001117   001121 710000 4                  TRA     s:4929
         4 001120   001171 710000 4                  TRA     s:4946

      430     4927        /**/
      431     4928    4                  CASE (TSS_NAME);

      432     4929    4                    BLK$ = BLK$ -> O$BLK.SUBLK$(1);

   4929  4 001121   100004 236100                    LDQ     4,,PR1
         4 001122   000000 756000 xsym               STQ     BLK$

      433     4930    5                    IF (BLK$ -> O$SYM.COUNT > 3) THEN DO;

   4930  4 001123   000000 471400 xsym               LDP1    BLK$
         4 001124   100004 236100                    LDQ     4,,PR1
         4 001125   777000 376003                    ANQ     -512,DU
         4 001126   004000 116003                    CMPQ    2048,DU
         4 001127   001135 602000 4                  TNC     s:4939

      434     4931    5                       CALL TSE$ERROR(%E$T_BADFEPNUM);

   4931  4 001130   000012 630400 5                  EPPR0   10
         4 001131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001132   000000 701000 xent               TSX1    TSE$ERROR
         4 001133   000000 011000                    NOP     0

      435     4932    5                       ALTRETURN;

   4932  4 001134   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:67   
      436     4933    5                       END;
      437     4934        /**/
      438     4935        /*E*    ERROR:   TSS-E$T_BADFEPNUM-0
      439     4936                MESSAGE: Illegal FEP number - must be less than 512.
      440     4937                DESCRIPTION: SEE MESSAGE        */
      441     4938        /**/
      442     4939    4                    FEPNAME = 'FEP';

   4939  4 001135   040100 100400                    MLR     fill='040'O
         4 001136   000015 000003 3                  ADSC9   13                       cn=0,n=3
         4 001137   200010 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8

      443     4940    4                    CALL INSERT(FEPNAME,3,BLK$->O$SYM.COUNT,SUBSTR(BLK$->O$SYM.TEXT,0,
              4940                             BLK$->O$SYM.COUNT));

   4940  4 001140   100004 236100                    LDQ     4,,PR1
         4 001141   000033 772000                    QRL     27
         4 001142   000000 621006                    EAX1    0,QL
         4 001143   100004 236100                    LDQ     4,,PR1
         4 001144   000033 772000                    QRL     27
         4 001145   000000 622006                    EAX2    0,QL
         4 001146   040140 100540                    MLR     fill='040'O
         4 001147   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 001150   200010 600012                    ADSC9   FEPNAME,,AUTO            cn=3,n=*X2

      444     4941    4                    CALL CHARBIN(TEMP,SUBSTR(BLK$->O$SYM.TEXT,0,BLK$->O$SYM.COUNT));

   4941  4 001151   100004 236100                    LDQ     4,,PR1
         4 001152   000033 772000                    QRL     27
         4 001153   000000 621006                    EAX1    0,QL
         4 001154   000100 305540                    DTB
         4 001155   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         4 001156   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001157   200025 235100                    LDA     MNEM+3,,AUTO
         4 001160   200006 755100                    STA     TEMP,,AUTO

      445     4942    4                    CMD$->TS$FEP.FEP = TEMP;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:68   

   4942  4 001161   000000 621005                    EAX1    0,AL
         4 001162   000000 473400 xsym               LDP3    CMD$
         4 001163   300002 441100                    SXL1    2,,PR3

      446     4943    4                    CMD$->TS$FEP.LEN = BLK$->O$SYM.COUNT;

   4943  4 001164   100004 236100                    LDQ     4,,PR1
         4 001165   000033 772000                    QRL     27
         4 001166   000000 622006                    EAX2    0,QL
         4 001167   300001 742100                    STX2    1,,PR3
         4 001170   001224 710000 4                  TRA     s:4958

      447     4944        /**/
      448     4945    4                  CASE (TSS_PATH);

      449     4946    4                    CALL PATH_2_NAME (BLK$ -> O$BLK,SUB_BUF_3.TEXT,

   4946  4 001171   000014 237000 5                  LDAQ    12
         4 001172   200020 757100                    STAQ    @O_BLK+1,,AUTO
         4 001173   000000 236000 xsym               LDQ     BLK$
         4 001174   200017 756100                    STQ     MPCNAME+3,,AUTO
         4 001175   002117 701000 4                  TSX1    PATH_2_NAME
         4 001176   002116 702000 4                  TSX2    BAD_PATH

      450     4947    4                      TSS_FEP) ALTRET (BAD_PATH);
      451     4948    4                    FEPNAME = SUB_BUF_3.TEXT;

   4948  4 001177   040100 100400                    MLR     fill='040'O
         4 001200   000000 200010 xsym               ADSC9   SUB_BUF_3                cn=1,n=8
         4 001201   200010 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8

      452     4949    4                    J = 0;

   4949  4 001202   000000 450000 xsym               STZ     J

      453     4950    5                    DO WHILE(SUBSTR(FEPNAME,J,1) ~= ' ');
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:69   

   4950  4 001203   001205 710000 4                  TRA     s:4952

      454     4951    5                       J = J + 1;

   4951  4 001204   000000 054000 xsym               AOS     J

      455     4952    5                       END;  /* DO WHILE */

   4952  4 001205   000000 235000 xsym               LDA     J
         4 001206   040000 106505                    CMPC    fill='040'O
         4 001207   200010 000001                    ADSC9   FEPNAME,A,AUTO           cn=0,n=1
         4 001210   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001211   001204 601000 4                  TNZ     s:4951

      456     4953    4                    CMD$->TS$FEP.LEN = J - 3;

   4953  4 001212   777775 620005                    EAX0    -3,AL
         4 001213   000000 470400 xsym               LDP0    CMD$
         4 001214   000001 740100                    STX0    1,,PR0

      457     4954    4                    CALL CHARBIN(TEMP,SUBSTR(FEPNAME,3,CMD$->TS$FEP.LEN));

   4954  4 001215   000100 305540                    DTB
         4 001216   200010 630010                    NDSC9   FEPNAME,,AUTO            cn=3,s=nosgn,sf=0,n=*X0
         4 001217   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001220   200025 236100                    LDQ     MNEM+3,,AUTO
         4 001221   200006 756100                    STQ     TEMP,,AUTO

      458     4955    4                    CMD$->TS$FEP.FEP = TEMP;

   4955  4 001222   000000 620006                    EAX0    0,QL
         4 001223   000002 440100                    SXL0    2,,PR0

      459     4956    4                  END;

      460     4957                      /* GET IOM,CHAN THIS FEP IS ON */
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:70   
      461     4958    3                 CONFIG_KEY.COUNT = 1;

   4958  4 001224   001000 236003                    LDQ     512,DU
         4 001225   000000 552040 xsym               STBQ    CONFIG_KEY,'40'O

      462     4959    3                 CONFIG_KEY.TEXT = BINASC(0);

   4959  4 001226   040000 100400                    MLR     fill='040'O
         4 001227   000016 000001 5                  ADSC9   14                       cn=0,n=1
         4 001230   000000 200010 xsym               ADSC9   CONFIG_KEY               cn=1,n=8

      463     4960    3                 CALL M$OPEN(OPEN_CONFIG) ALTRET(CONFIG_ERR);

   4960  4 001231   000002 630400 1                  EPPR0   OPEN_CONFIG
         4 001232   450000 713400                    CLIMB   alt,open
         4 001233   410400 401760                    pmme    nvectors=18
         4 001234   002103 702000 4                  TSX2    CONFIG_ERR

      464     4961    3                 CALL M$READ(READ_CONFIG) ALTRET(CONFIG_ERR);

   4961  4 001235   000132 630400 1                  EPPR0   READ_CONFIG
         4 001236   440000 713400                    CLIMB   alt,read
         4 001237   401400 401760                    pmme    nvectors=4
         4 001240   002103 702000 4                  TSX2    CONFIG_ERR

      465     4962    3                 NUMIOMS = CONFIG$->TD$HEAD.NUMIOMS;

   4962  4 001241   000000 470400 xsym               LDP0    CONFIG$
         4 001242   000000 236100                    LDQ     0,,PR0
         4 001243   777777 376007                    ANQ     -1,DL
         4 001244   200007 756100                    STQ     NUMIOMS,,AUTO

      466     4963    4                 DO J = 0 TO NUMIOMS - 1;

   4963  4 001245   000000 450000 xsym               STZ     J
         4 001246   001314 710000 4                  TRA     s:4976+1

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:71   
      467     4964    4                    CONFIG_KEY.COUNT = 4;

   4964  4 001247   004000 236003                    LDQ     2048,DU
         4 001250   000000 552040 xsym               STBQ    CONFIG_KEY,'40'O

      468     4965    4                    CONFIG_KEY.TEXT = 'IOM';

   4965  4 001251   040000 100400                    MLR     fill='040'O
         4 001252   000016 000003 3                  ADSC9   14                       cn=0,n=3
         4 001253   000000 200010 xsym               ADSC9   CONFIG_KEY               cn=1,n=8

      469     4966    4                    CALL BINCHAR(SUBSTR(CONFIG_KEY.TEXT,3,1),J);

   4966  4 001254   000000 301400                    BTD
         4 001255   000000 000004 xsym               NDSC9   J                        cn=0,s=lsgnf,sf=0,n=4
         4 001256   000001 030001 xsym               NDSC9   CONFIG_KEY+1             cn=0,s=nosgn,sf=0,n=1

      470     4967    4                    CALL M$READ(READ_CONFIG) ALTRET(CONFIG_ERR);

   4967  4 001257   000132 630400 1                  EPPR0   READ_CONFIG
         4 001260   440000 713400                    CLIMB   alt,read
         4 001261   401400 401760                    pmme    nvectors=4
         4 001262   002103 702000 4                  TSX2    CONFIG_ERR

      471     4968    5                    DO K = 8 TO %N_MAXCHANS-1;  /* ALL CHANNELS */

   4968  4 001263   000010 235007                    LDA     8,DL
         4 001264   000000 755000 xsym               STA     K
         4 001265   001310 710000 4                  TRA     s:4975+1

      472     4969    6                       IF CONFIG$->TD$IOM.DEVNAME(K) = FEPNAME THEN DO;

   4969  4 001266   000000 235000 xsym               LDA     K
         4 001267   000003 735000                    ALS     3
         4 001270   000000 470400 xsym               LDP0    CONFIG$
         4 001271   040100 106505                    CMPC    fill='040'O
         4 001272   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:72   
         4 001273   200010 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 001274   001307 601000 4                  TNZ     s:4975

      473     4970    6                          CMD$->TS$FEP.IOM = J;

   4970  4 001275   000000 720000 xsym               LXL0    J
         4 001276   000000 471400 xsym               LDP1    CMD$
         4 001277   100001 440100                    SXL0    1,,PR1

      474     4971    6                          CMD$->TS$FEP.CHAN = K;

   4971  4 001300   000000 721000 xsym               LXL1    K
         4 001301   100002 741100                    STX1    2,,PR1

      475     4972    6                          CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);

   4972  4 001302   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 001303   450001 713400                    CLIMB   alt,close
         4 001304   406000 401760                    pmme    nvectors=13
         4 001305   002103 702000 4                  TSX2    CONFIG_ERR

      476     4973    6                          GOTO FEP_FOUND;

   4973  4 001306   002064 710000 4                  TRA     FEP_FOUND

      477     4974    6                          END;  /* IF FOUND IT */
      478     4975    5                       END;  /* DO K */

   4975  4 001307   000000 054000 xsym               AOS     K
         4 001310   000000 235000 xsym               LDA     K
         4 001311   000177 115007                    CMPA    127,DL
         4 001312   001266 604400 4                  TMOZ    s:4969

      479     4976    4                    END;  /* DO J */

   4976  4 001313   000000 054000 xsym               AOS     J
         4 001314   000000 236000 xsym               LDQ     J
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:73   
         4 001315   200007 116100                    CMPQ    NUMIOMS,,AUTO
         4 001316   001247 604000 4                  TMI     s:4964

      480     4977    3                 CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);

   4977  4 001317   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 001320   450001 713400                    CLIMB   alt,close
         4 001321   406000 401760                    pmme    nvectors=13
         4 001322   002103 702000 4                  TSX2    CONFIG_ERR
         4 001323   002064 710000 4                  TRA     FEP_FOUND

      481     4978    3               CASE (TSS_CHAN);

      482     4979    3                 CMD$ -> TS$CHAN = NO;

   4979  4 001324   000000 474400 xsym               LDP4    CMD$
         4 001325   000100 100400                    MLR     fill='000'O
         4 001326   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001327   400000 000020                    ADSC9   0,,PR4                   cn=0,n=16

      483     4980    3                 CMD$ -> TS$CHAN.SIZE = SIZEW(TS$CHAN);

   4980  4 001330   000004 220003                    LDX0    4,DU
         4 001331   000000 471400 xsym               LDP1    CMD$
         4 001332   100000 740100                    STX0    0,,PR1

      484     4981    3                 CMD$ -> TS$CHAN.CODE = TSS_CHAN;

   4981  4 001333   000000 471400 xsym               LDP1    CMD$
         4 001334   100000 440100                    SXL0    0,,PR1

      485     4982        /**/
      486     4983    4                 IF (BLK$ -> O$BLK.SUBLK$(0) -> O$SYM.COUNT ~= 1) THEN DO;

   4983  4 001335   000000 471400 xsym               LDP1    BLK$
         4 001336   100003 473500                    LDP3    3,,PR1
         4 001337   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:74   
         4 001340   777000 376003                    ANQ     -512,DU
         4 001341   001000 116003                    CMPQ    512,DU
         4 001342   001350 600000 4                  TZE     s:4992

      487     4984    4                    CALL TSE$ERROR(%E$T_BADIOMNUM);

   4984  4 001343   000020 630400 5                  EPPR0   16
         4 001344   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001345   000000 701000 xent               TSX1    TSE$ERROR
         4 001346   000000 011000                    NOP     0

      488     4985    4                    ALTRETURN;

   4985  4 001347   000000 702200 xent               TSX2  ! X66_AALT

      489     4986    4                    END;
      490     4987        /**/
      491     4988        /*E*    ERROR:   TSS-E$T_BADIOMNUM-0
      492     4989                MESSAGE: Illegal IOM number - must be single digit.
      493     4990                DESCRIPTION: SEE MESSAGE        */
      494     4991        /**/
      495     4992    3                 CALL CHARBIN(CMD$ -> TS$CHAN.IOM,

   4992  4 001350   300004 236100                    LDQ     4,,PR3
         4 001351   000033 772000                    QRL     27
         4 001352   000000 474400 xsym               LDP4    CMD$
         4 001353   000100 305500                    DTB
         4 001354   300004 230001                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=1
         4 001355   400001 000004                    NDSC9   1,,PR4                   cn=0,s=lsgnf,sf=0,n=4

      496     4993    3                   SUBSTR(BLK$ -> O$BLK.SUBLK$(0) -> O$SYM.TEXT,0,1));
      497     4994        /**/
      498     4995    3                 CALL CHARBIN(CMD$ -> TS$CHAN.LOCHAN,

   4995  4 001356   100004 473500                    LDP3    4,,PR1
         4 001357   300004 236100                    LDQ     4,,PR3
         4 001360   000033 772000                    QRL     27
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:75   
         4 001361   000000 621006                    EAX1    0,QL
         4 001362   000100 305540                    DTB
         4 001363   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 001364   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001365   200025 235100                    LDA     MNEM+3,,AUTO
         4 001366   400002 755100                    STA     2,,PR4

      499     4996    3                   SUBSTR(BLK$ -> O$BLK.SUBLK$(1) -> O$SYM.TEXT,0,
      500     4997    3                   BLK$ -> O$BLK.SUBLK$(1) -> O$SYM.COUNT));
      501     4998    4                 IF (CMD$ -> TS$CHAN.LOCHAN > %N_MAXCHANS-1) THEN DO;

   4998  4 001367   000200 115007                    CMPA    128,DL
         4 001370   001376 602000 4                  TNC     s:5008

      502     4999    4                    CALL TSE$ERROR(%E$T_BADCHANNUM);

   4999  4 001371   000022 630400 5                  EPPR0   18
         4 001372   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001373   000000 701000 xent               TSX1    TSE$ERROR
         4 001374   000000 011000                    NOP     0

      503     5000    4                    ALTRETURN;

   5000  4 001375   000000 702200 xent               TSX2  ! X66_AALT

      504     5001    4                    END;
      505     5002        /**/
      506     5003        /*E*    ERROR:   TSS-E$T_BADCHANNUM-0
      507     5004                MESSAGE: Illegal channel number.
      508     5005                MESSAGE1: Channel number greater than 127 - or LO > HI in range.
      509     5006                DESCRIPTION: SEE MESSAGE        */
      510     5007        /**/
      511     5008    4                 IF (BLK$ -> O$BLK.NSUBLKS = 3) THEN DO; /* HICHAN SPECIFIED     */

   5008  4 001376   100001 221100                    LDX1    1,,PR1
         4 001377   000003 101003                    CMPX1   3,DU
         4 001400   001424 601000 4                  TNZ     s:5019
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:76   

      512     5009    4                    CALL CHARBIN(CMD$ -> TS$CHAN.HICHAN,

   5009  4 001401   100005 473500                    LDP3    5,,PR1
         4 001402   300004 236100                    LDQ     4,,PR3
         4 001403   000033 772000                    QRL     27
         4 001404   000000 622006                    EAX2    0,QL
         4 001405   000100 305540                    DTB
         4 001406   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         4 001407   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001410   200025 235100                    LDA     MNEM+3,,AUTO
         4 001411   400003 755100                    STA     3,,PR4

      513     5010    4                      SUBSTR(BLK$ -> O$BLK.SUBLK$(2) -> O$SYM.TEXT,0,
      514     5011    4                      BLK$ -> O$BLK.SUBLK$(2) -> O$SYM.COUNT));
      515     5012    4                    IF (CMD$ -> TS$CHAN.HICHAN > %N_MAXCHANS-1)OR

   5012  4 001412   000200 115007                    CMPA    128,DL
         4 001413   001417 603000 4                  TRC     s:5014
         4 001414   400003 236100                    LDQ     3,,PR4
         4 001415   400002 116100                    CMPQ    2,,PR4
         4 001416   002064 603000 4                  TRC     FEP_FOUND

      516     5013    5                      (CMD$ -> TS$CHAN.HICHAN < CMD$ -> TS$CHAN.LOCHAN) THEN DO;

      517     5014    5                       CALL TSE$ERROR(%E$T_BADCHANNUM);

   5014  4 001417   000022 630400 5                  EPPR0   18
         4 001420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001421   000000 701000 xent               TSX1    TSE$ERROR
         4 001422   000000 011000                    NOP     0

      518     5015    5                       ALTRETURN;

   5015  4 001423   000000 702200 xent               TSX2  ! X66_AALT

      519     5016    5                       END;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:77   
      520     5017    4                    END;
      521     5018        /**/
      522     5019    3                 ELSE CMD$ -> TS$CHAN.HICHAN = CMD$ -> TS$CHAN.LOCHAN;

   5019  4 001424   400003 755100                    STA     3,,PR4
         4 001425   002064 710000 4                  TRA     FEP_FOUND

      523     5020        /**/
      524     5021    3               CASE (TSS_PAGES);

      525     5022    3                 CMD$ -> TS$PAGES = NO;

   5022  4 001426   000000 474400 xsym               LDP4    CMD$
         4 001427   000100 100400                    MLR     fill='000'O
         4 001430   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001431   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      526     5023    3                 CMD$ -> TS$PAGES.SIZE = SIZEW(TS$PAGES);

   5023  4 001432   000003 220003                    LDX0    3,DU
         4 001433   000000 471400 xsym               LDP1    CMD$
         4 001434   100000 740100                    STX0    0,,PR1

      527     5024    3                 CMD$ -> TS$PAGES.CODE = TSS_PAGES;

   5024  4 001435   000005 221003                    LDX1    5,DU
         4 001436   000000 471400 xsym               LDP1    CMD$
         4 001437   100000 441100                    SXL1    0,,PR1

      528     5025        /**/
      529     5026    4                 IF BLK$->O$BLK.NSUBLKS=0 THEN DO;

   5026  4 001440   000000 471400 xsym               LDP1    BLK$
         4 001441   100001 222100                    LDX2    1,,PR1
         4 001442   001450 601000 4                  TNZ     s:5032

      530     5027    4                   CMD$->TS$PAGES.LOPAGE=0;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:78   

   5027  4 001443   000000 473400 xsym               LDP3    CMD$
         4 001444   300001 450100                    STZ     1,,PR3

      531     5028    4                   CMD$->TS$PAGES.HIPAGE=BITBIN('777777777777'O);

   5028  4 001445   000027 235000 xsym               LDA     B_VECTNIL+23
         4 001446   300002 755100                    STA     2,,PR3

      532     5029    4                   GOTO PAGEDONE;

   5029  4 001447   001507 710000 4                  TRA     PAGEDONE

      533     5030    4                   END;
      534     5031        /**/
      535     5032    3                 CALL CHARBIN(CMD$ -> TS$PAGES.LOPAGE,

   5032  4 001450   100003 473500                    LDP3    3,,PR1
         4 001451   300004 236100                    LDQ     4,,PR3
         4 001452   000033 772000                    QRL     27
         4 001453   000000 623006                    EAX3    0,QL
         4 001454   000100 305540                    DTB
         4 001455   300004 230013                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X3
         4 001456   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001457   000000 473400 xsym               LDP3    CMD$
         4 001460   200025 235100                    LDA     MNEM+3,,AUTO
         4 001461   300001 755100                    STA     1,,PR3

      536     5033    3                   SUBSTR(BLK$ -> O$BLK.SUBLK$(0) -> O$SYM.TEXT,0,
      537     5034    3                   BLK$ -> O$BLK.SUBLK$(0) -> O$SYM.COUNT));
      538     5035        /**/
      539     5036    4                 IF (BLK$ -> O$BLK.NSUBLKS = 2) THEN DO;

   5036  4 001462   100001 222100                    LDX2    1,,PR1
         4 001463   000002 102003                    CMPX2   2,DU
         4 001464   001506 601000 4                  TNZ     s:5050

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:79   
      540     5037    4                    CALL CHARBIN(CMD$ -> TS$PAGES.HIPAGE,

   5037  4 001465   100004 474500                    LDP4    4,,PR1
         4 001466   400004 236100                    LDQ     4,,PR4
         4 001467   000033 772000                    QRL     27
         4 001470   000000 623006                    EAX3    0,QL
         4 001471   000100 305540                    DTB
         4 001472   400004 230013                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X3
         4 001473   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001474   200025 235100                    LDA     MNEM+3,,AUTO
         4 001475   300002 755100                    STA     2,,PR3

      541     5038    4                      SUBSTR(BLK$ -> O$BLK.SUBLK$(1) -> O$SYM.TEXT,0,
      542     5039    4                      BLK$ -> O$BLK.SUBLK$(1) -> O$SYM.COUNT));
      543     5040    5                    IF (CMD$ -> TS$PAGES.HIPAGE < CMD$ -> TS$PAGES.LOPAGE) THEN DO;

   5040  4 001476   300002 236100                    LDQ     2,,PR3
         4 001477   300001 116100                    CMPQ    1,,PR3
         4 001500   001507 603000 4                  TRC     PAGEDONE

      544     5041    5                       CALL TSE$ERROR(%E$T_BADPAGENUM);

   5041  4 001501   000024 630400 5                  EPPR0   20
         4 001502   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001503   000000 701000 xent               TSX1    TSE$ERROR
         4 001504   000000 011000                    NOP     0

      545     5042    5                       ALTRETURN;

   5042  4 001505   000000 702200 xent               TSX2  ! X66_AALT

      546     5043    5                       END;
      547     5044    4                    END;
      548     5045        /**/
      549     5046        /*E*    ERROR:   TSS-E$T_BADPAGENUM-0
      550     5047                MESSAGE: Illegal page number range - LO > HI.
      551     5048                DESCRIPTION: SEE MESSAGE        */
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:80   
      552     5049        /**/
      553     5050    3                 ELSE CMD$ -> TS$PAGES.HIPAGE = CMD$ -> TS$PAGES.LOPAGE;

   5050  4 001506   300002 755100                    STA     2,,PR3

   5039  4 001507   002064 710000 4     PAGEDONE     TRA     FEP_FOUND

      554     5051    3   PAGEDONE:;
      555     5052    3               CASE(TSS_ALL);

      556     5053    3                 CMD$->TS$DEV = NO;

   5053  4 001510   000000 474400 xsym               LDP4    CMD$
         4 001511   000100 100400                    MLR     fill='000'O
         4 001512   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001513   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      557     5054    3                 CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);

   5054  4 001514   000003 220003                    LDX0    3,DU
         4 001515   000000 471400 xsym               LDP1    CMD$
         4 001516   100000 740100                    STX0    0,,PR1

      558     5055    3                 CMD$->TS$DEV.CODE = TSS_ALL;

   5055  4 001517   000007 221003                    LDX1    7,DU
         4 001520   000000 471400 xsym               LDP1    CMD$
         4 001521   100000 441100                    SXL1    0,,PR1
         4 001522   002064 710000 4                  TRA     FEP_FOUND

      559     5056    3               CASE(TSS_DIREL);

      560     5057    3                 CMD$->TS$DEV = NO;

   5057  4 001523   000000 474400 xsym               LDP4    CMD$
         4 001524   000100 100400                    MLR     fill='000'O
         4 001525   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:81   
         4 001526   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      561     5058    3                 CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);

   5058  4 001527   000003 220003                    LDX0    3,DU
         4 001530   000000 471400 xsym               LDP1    CMD$
         4 001531   100000 740100                    STX0    0,,PR1

      562     5059    3                 CMD$->TS$DEV.CODE = TSS_DIREL;

   5059  4 001532   000014 221003                    LDX1    12,DU
         4 001533   000000 471400 xsym               LDP1    CMD$
         4 001534   100000 441100                    SXL1    0,,PR1

      563     5060    3                 TS_DIREL = YES;

   5060  4 001535   400000 236003                    LDQ     -131072,DU
         4 001536   000001 756000 1                  STQ     TS_DIREL
         4 001537   002064 710000 4                  TRA     FEP_FOUND

      564     5061    3               CASE(TSS_DIPART);

      565     5062    3                 CMD$->TS$DEV = NO;

   5062  4 001540   000000 474400 xsym               LDP4    CMD$
         4 001541   000100 100400                    MLR     fill='000'O
         4 001542   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001543   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      566     5063    3                 CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);

   5063  4 001544   000003 220003                    LDX0    3,DU
         4 001545   000000 471400 xsym               LDP1    CMD$
         4 001546   100000 740100                    STX0    0,,PR1

      567     5064    3                 CMD$->TS$DEV.CODE = TSS_DIPART;

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:82   
   5064  4 001547   000010 221003                    LDX1    8,DU
         4 001550   000000 471400 xsym               LDP1    CMD$
         4 001551   100000 441100                    SXL1    0,,PR1

      568     5065    3                 TS_DIPART = YES;

   5065  4 001552   400000 236003                    LDQ     -131072,DU
         4 001553   000000 756000 1                  STQ     TS_DIPART
         4 001554   002064 710000 4                  TRA     FEP_FOUND

      569     5066    3               CASE(TSS_DIPATH);

      570     5067    4                 DO J = 0 TO BLK$->O$BLK.NSUBLKS - 1;

   5067  4 001555   000000 450000 xsym               STZ     J
         4 001556   002003 710000 4                  TRA     s:5115+1

      571     5068    4                    PTR$ = BLK$->O$BLK.SUBLK$(J);

   5068  4 001557   000000 470400 xsym               LDP0    BLK$
         4 001560   000000 720000 xsym               LXL0    J
         4 001561   000003 236110                    LDQ     3,X0,PR0
         4 001562   200005 756100                    STQ     PTR$,,AUTO

      572     5069    4                    CMD$->TS$DEV = NO;

   5069  4 001563   000000 471400 xsym               LDP1    CMD$
         4 001564   000100 100400                    MLR     fill='000'O
         4 001565   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001566   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      573     5070    4                    CMD$->TS$DEV.SIZE = SIZEW(TS$DEV);

   5070  4 001567   000003 220003                    LDX0    3,DU
         4 001570   000000 470400 xsym               LDP0    CMD$
         4 001571   000000 740100                    STX0    0,,PR0

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:83   
      574     5071    4                    CMD$->TS$DEV.CODE = TSS_DIPATH;

   5071  4 001572   000011 221003                    LDX1    9,DU
         4 001573   000000 470400 xsym               LDP0    CMD$
         4 001574   000000 441100                    SXL1    0,,PR0

      575     5072    5                    DO CASE(PTR$->O$BLK.CODE);

   5072  4 001575   200005 470500                    LDP0    PTR$,,AUTO
         4 001576   000000 722100                    LXL2    0,,PR0
         4 001577   000004 102003                    CMPX2   4,DU
         4 001600   001602 602012 4                  TNC     s:5072+5,X2
         4 001601   001773 710000 4                  TRA     s:5113
         4 001602   001773 710000 4                  TRA     s:5113
         4 001603   001606 710000 4                  TRA     s:5074
         4 001604   001701 710000 4                  TRA     s:5095
         4 001605   001747 710000 4                  TRA     s:5108

      576     5073    5                       CASE(TSS_DEV);

      577     5074    6                          DO CASE(PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.CODE);

   5074  4 001606   000003 471500                    LDP1    3,,PR0
         4 001607   100003 473500                    LDP3    3,,PR1
         4 001610   300000 723100                    LXL3    0,,PR3
         4 001611   000012 103003                    CMPX3   10,DU
         4 001612   001614 602013 4                  TNC     s:5074+6,X3
         4 001613   001665 710000 4                  TRA     s:5092
         4 001614   001665 710000 4                  TRA     s:5092
         4 001615   001626 710000 4                  TRA     s:5076
         4 001616   001632 710000 4                  TRA     s:5078
         4 001617   001636 710000 4                  TRA     s:5080
         4 001620   001642 710000 4                  TRA     s:5082
         4 001621   001646 710000 4                  TRA     s:5084
         4 001622   001652 710000 4                  TRA     s:5086
         4 001623   001665 710000 4                  TRA     s:5092
         4 001624   001656 710000 4                  TRA     s:5088
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:84   
         4 001625   001662 710000 4                  TRA     s:5090

      578     5075    6                             CASE(TSS_LP);

      579     5076    6                                CMD$->TS$DEV.NAME.MNEM = 'LP';

   5076  4 001626   000000 224000 3                  LDX4    0
         4 001627   000000 474400 xsym               LDP4    CMD$
         4 001630   400001 744100                    STX4    1,,PR4
         4 001631   001665 710000 4                  TRA     s:5092

      580     5077    6                             CASE(TSS_CR);

      581     5078    6                                CMD$->TS$DEV.NAME.MNEM = 'CR';

   5078  4 001632   000001 224000 3                  LDX4    1
         4 001633   000000 474400 xsym               LDP4    CMD$
         4 001634   400001 744100                    STX4    1,,PR4
         4 001635   001665 710000 4                  TRA     s:5092

      582     5079    6                             CASE(TSS_CP);

      583     5080    6                                CMD$->TS$DEV.NAME.MNEM = 'CP';

   5080  4 001636   000002 224000 3                  LDX4    2
         4 001637   000000 474400 xsym               LDP4    CMD$
         4 001640   400001 744100                    STX4    1,,PR4
         4 001641   001665 710000 4                  TRA     s:5092

      584     5081    6                             CASE(TSS_DP);

      585     5082    6                                CMD$->TS$DEV.NAME.MNEM = 'DP';

   5082  4 001642   000003 224000 3                  LDX4    3
         4 001643   000000 474400 xsym               LDP4    CMD$
         4 001644   400001 744100                    STX4    1,,PR4
         4 001645   001665 710000 4                  TRA     s:5092
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:85   

      586     5083    6                             CASE(TSS_MT);

      587     5084    6                                CMD$->TS$DEV.NAME.MNEM = 'MT';

   5084  4 001646   000004 224000 3                  LDX4    4
         4 001647   000000 474400 xsym               LDP4    CMD$
         4 001650   400001 744100                    STX4    1,,PR4
         4 001651   001665 710000 4                  TRA     s:5092

      588     5085    6                             CASE(TSS_SC);

      589     5086    6                                CMD$->TS$DEV.NAME.MNEM = 'SC';

   5086  4 001652   000005 224000 3                  LDX4    5
         4 001653   000000 474400 xsym               LDP4    CMD$
         4 001654   400001 744100                    STX4    1,,PR4
         4 001655   001665 710000 4                  TRA     s:5092

      590     5087    6                             CASE(TSS_AP);

      591     5088    6                                CMD$->TS$DEV.NAME.MNEM = 'AP';

   5088  4 001656   000006 224000 3                  LDX4    6
         4 001657   000000 474400 xsym               LDP4    CMD$
         4 001660   400001 744100                    STX4    1,,PR4
         4 001661   001665 710000 4                  TRA     s:5092

      592     5089    6                             CASE(TSS_OD);

      593     5090    6                                CMD$->TS$DEV.NAME.MNEM = 'OD';

   5090  4 001662   000007 224000 3                  LDX4    7
         4 001663   000000 474400 xsym               LDP4    CMD$
         4 001664   400001 744100                    STX4    1,,PR4

      594     5091    6                             END;  /* CASE */
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:86   

      595     5092    5                         CMD$->TS$DEV.NAME.NUM = PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1
              5092                                   )->O$SYM.TEXT;

   5092  4 001665   000003 471500                    LDP1    3,,PR0
         4 001666   100004 473500                    LDP3    4,,PR1
         4 001667   300004 236100                    LDQ     4,,PR3
         4 001670   000033 772000                    QRL     27
         4 001671   000000 622006                    EAX2    0,QL
         4 001672   000000 474400 xsym               LDP4    CMD$
         4 001673   040100 100540                    MLR     fill='040'O
         4 001674   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 001675   400001 400002                    ADSC9   1,,PR4                   cn=2,n=2

      596     5093    5                          CMD$->TS$DEV.NAME.TWSN = '0000';

   5093  4 001676   000010 236000 3                  LDQ     8
         4 001677   400002 756100                    STQ     2,,PR4
         4 001700   001773 710000 4                  TRA     s:5113

      597     5094    5                       CASE(TSS_MPC);

      598     5095    6                          DO CASE(PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(0)->O$BLK.CODE);

   5095  4 001701   000003 471500                    LDP1    3,,PR0
         4 001702   100003 473500                    LDP3    3,,PR1
         4 001703   300000 723100                    LXL3    0,,PR3
         4 001704   000005 103003                    CMPX3   5,DU
         4 001705   001707 602013 4                  TNC     s:5095+6,X3
         4 001706   001733 710000 4                  TRA     s:5105
         4 001707   001733 710000 4                  TRA     s:5105
         4 001710   001714 710000 4                  TRA     s:5097
         4 001711   001720 710000 4                  TRA     s:5099
         4 001712   001724 710000 4                  TRA     s:5101
         4 001713   001730 710000 4                  TRA     s:5103

      599     5096    6                             CASE(TSS_DC);
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:87   

      600     5097    6                                CMD$->TS$DEV.NAME.MNEM = 'DC';

   5097  4 001714   000011 224000 3                  LDX4    9
         4 001715   000000 474400 xsym               LDP4    CMD$
         4 001716   400001 744100                    STX4    1,,PR4
         4 001717   001733 710000 4                  TRA     s:5105

      601     5098    6                             CASE(TSS_TC);

      602     5099    6                                CMD$->TS$DEV.NAME.MNEM = 'TC';

   5099  4 001720   000012 224000 3                  LDX4    10
         4 001721   000000 474400 xsym               LDP4    CMD$
         4 001722   400001 744100                    STX4    1,,PR4
         4 001723   001733 710000 4                  TRA     s:5105

      603     5100    6                             CASE(TSS_UC);

      604     5101    6                                CMD$->TS$DEV.NAME.MNEM = 'UC';

   5101  4 001724   000013 224000 3                  LDX4    11
         4 001725   000000 474400 xsym               LDP4    CMD$
         4 001726   400001 744100                    STX4    1,,PR4
         4 001727   001733 710000 4                  TRA     s:5105

      605     5102    6                             CASE(TSS_AC);

      606     5103    6                                CMD$->TS$DEV.NAME.MNEM = 'AC';

   5103  4 001730   000014 224000 3                  LDX4    12
         4 001731   000000 474400 xsym               LDP4    CMD$
         4 001732   400001 744100                    STX4    1,,PR4

      607     5104    6                             END;  /* CASE */

      608     5105    5                         CMD$->TS$DEV.NAME.NUM = PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:88   
              5105                                   )->O$SYM.TEXT;

   5105  4 001733   000003 471500                    LDP1    3,,PR0
         4 001734   100004 473500                    LDP3    4,,PR1
         4 001735   300004 236100                    LDQ     4,,PR3
         4 001736   000033 772000                    QRL     27
         4 001737   000000 622006                    EAX2    0,QL
         4 001740   000000 474400 xsym               LDP4    CMD$
         4 001741   040100 100540                    MLR     fill='040'O
         4 001742   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 001743   400001 400002                    ADSC9   1,,PR4                   cn=2,n=2

      609     5106    5                          CMD$->TS$DEV.NAME.TWSN = '0000';

   5106  4 001744   000010 236000 3                  LDQ     8
         4 001745   400002 756100                    STQ     2,,PR4
         4 001746   001773 710000 4                  TRA     s:5113

      610     5107    5                       CASE(TSS_FEP);

      611     5108    5                          FEPNAME = 'FEP';

   5108  4 001747   040100 100400                    MLR     fill='040'O
         4 001750   000015 000003 3                  ADSC9   13                       cn=0,n=3
         4 001751   200010 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8

      612     5109    5                          PTR$ = PTR$->O$BLK.SUBLK$(0)->O$BLK.SUBLK$(1);

   5109  4 001752   000003 471500                    LDP1    3,,PR0
         4 001753   100004 236100                    LDQ     4,,PR1
         4 001754   200005 756100                    STQ     PTR$,,AUTO

      613     5110    5                          CALL INSERT(FEPNAME,3,PTR$->O$SYM.COUNT,SUBSTR(PTR$->O$SYM.
              5110                                   TEXT,0,PTR$->O$SYM.COUNT));

   5110  4 001755   200005 470500                    LDP0    PTR$,,AUTO
         4 001756   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:89   
         4 001757   000033 772000                    QRL     27
         4 001760   000000 622006                    EAX2    0,QL
         4 001761   000004 236100                    LDQ     4,,PR0
         4 001762   000033 772000                    QRL     27
         4 001763   000000 623006                    EAX3    0,QL
         4 001764   040140 100540                    MLR     fill='040'O
         4 001765   000004 200012                    ADSC9   4,,PR0                   cn=1,n=*X2
         4 001766   200010 600013                    ADSC9   FEPNAME,,AUTO            cn=3,n=*X3

      614     5111    5                          CMD$->TS$DEV.DEVNAME = FEPNAME;

   5111  4 001767   000000 471400 xsym               LDP1    CMD$
         4 001770   200010 237100                    LDAQ    FEPNAME,,AUTO
         4 001771   100001 755100                    STA     1,,PR1
         4 001772   100002 756100                    STQ     2,,PR1

      615     5112    5                       END;  /* DO CASE */

      616     5113    4                    CMD$ = PINCRW(CMD$,CMD$->TS$DEV.SIZE);

   5113  4 001773   000000 471400 xsym               LDP1    CMD$
         4 001774   100000 222100                    LDX2    0,,PR1
         4 001775   000000 636012                    EAQ     0,X2
         4 001776   000000 036000 xsym               ADLQ    CMD$
         4 001777   000000 756000 xsym               STQ     CMD$

      617     5114    4                    CMD$->TS$CMDWD = 0;

   5114  4 002000   000000 471400 xsym               LDP1    CMD$
         4 002001   100000 450100                    STZ     0,,PR1

      618     5115    4                 END;  /* DO J */

   5115  4 002002   000000 054000 xsym               AOS     J
         4 002003   000000 470400 xsym               LDP0    BLK$
         4 002004   000001 236100                    LDQ     1,,PR0
         4 002005   000022 772000                    QRL     18
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:90   
         4 002006   000000 116000 xsym               CMPQ    J
         4 002007   001557 605400 4                  TPNZ    s:5068
         4 002010   002064 710000 4                  TRA     FEP_FOUND

      619     5116    3               CASE (TSS_CPU);

      620     5117    3                 BLK$ = BLK$->O$BLK.SUBLK$(0);

   5117  4 002011   300003 236100                    LDQ     3,,PR3
         4 002012   000000 756000 xsym               STQ     BLK$

      621     5118    3                 CMD$ -> TS$CPU = NO;

   5118  4 002013   000000 473400 xsym               LDP3    CMD$
         4 002014   300000 450100                    STZ     0,,PR3
         4 002015   300001 450100                    STZ     1,,PR3

      622     5119    3                 CMD$ -> TS$CPU.CODE = TSS_CPU;

   5119  4 002016   000012 220003                    LDX0    10,DU
         4 002017   000000 471400 xsym               LDP1    CMD$
         4 002020   100000 440100                    SXL0    0,,PR1

      623     5120    3                 CMD$ -> TS$CPU.SIZE = SIZEW(TS$CPU);

   5120  4 002021   000002 221003                    LDX1    2,DU
         4 002022   000000 471400 xsym               LDP1    CMD$
         4 002023   100000 741100                    STX1    0,,PR1

      624     5121    3                 CALL CHARBIN(CMD$->TS$CPU.CPU,BLK$->O$SYM.TEXT);

   5121  4 002024   000000 471400 xsym               LDP1    BLK$
         4 002025   100004 236100                    LDQ     4,,PR1
         4 002026   000033 772000                    QRL     27
         4 002027   000000 622006                    EAX2    0,QL
         4 002030   000100 305540                    DTB
         4 002031   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:91   
         4 002032   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 002033   000000 473400 xsym               LDP3    CMD$
         4 002034   200025 235100                    LDA     MNEM+3,,AUTO
         4 002035   300001 755100                    STA     1,,PR3
         4 002036   002064 710000 4                  TRA     FEP_FOUND

      625     5122    3               CASE (TSS_SCU);

      626     5123    3                 BLK$ = BLK$->O$BLK.SUBLK$(0);

   5123  4 002037   300003 236100                    LDQ     3,,PR3
         4 002040   000000 756000 xsym               STQ     BLK$

      627     5124    3                 CMD$ -> TS$SCU = NO;

   5124  4 002041   000000 473400 xsym               LDP3    CMD$
         4 002042   300000 450100                    STZ     0,,PR3
         4 002043   300001 450100                    STZ     1,,PR3

      628     5125    3                 CMD$ -> TS$SCU.CODE = TSS_SCU;

   5125  4 002044   000013 220003                    LDX0    11,DU
         4 002045   000000 471400 xsym               LDP1    CMD$
         4 002046   100000 440100                    SXL0    0,,PR1

      629     5126    3                 CMD$ -> TS$SCU.SIZE = SIZEW(TS$SCU);

   5126  4 002047   000002 221003                    LDX1    2,DU
         4 002050   000000 471400 xsym               LDP1    CMD$
         4 002051   100000 741100                    STX1    0,,PR1

      630     5127    3                 CALL CHARBIN(CMD$->TS$SCU.SCU,BLK$->O$SYM.TEXT);

   5127  4 002052   000000 471400 xsym               LDP1    BLK$
         4 002053   100004 236100                    LDQ     4,,PR1
         4 002054   000033 772000                    QRL     27
         4 002055   000000 622006                    EAX2    0,QL
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:92   
         4 002056   000100 305540                    DTB
         4 002057   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
         4 002060   200024 000010                    NDSC9   MNEM+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 002061   000000 473400 xsym               LDP3    CMD$
         4 002062   200025 235100                    LDA     MNEM+3,,AUTO
         4 002063   300001 755100                    STA     1,,PR3

      631     5128    3              END;  /* DO CASE BLK$->O$BLK.CODE */

      632     5129    2   FEP_FOUND:
      633     5130    2              CMD$ = PINCRW(CMD$,CMD$ -> TS$DEV.SIZE);

   5130  4 002064   000000 470400 xsym  FEP_FOUND    LDP0    CMD$
         4 002065   000000 220100                    LDX0    0,,PR0
         4 002066   000000 636010                    EAQ     0,X0
         4 002067   000000 036000 xsym               ADLQ    CMD$
         4 002070   000000 756000 xsym               STQ     CMD$

      634     5131    2              CMD$ -> TS$CMDWD = 0;

   5131  4 002071   000000 470400 xsym               LDP0    CMD$
         4 002072   000000 450100                    STZ     0,,PR0

      635     5132    2              END;

   5132  4 002073   000000 054000 xsym               AOS     I
         4 002074   200003 470500                    LDP0    @PCB,,AUTO
         4 002075   000003 471500                    LDP1    3,,PR0
         4 002076   100001 236100                    LDQ     1,,PR1
         4 002077   000022 772000                    QRL     18
         4 002100   000000 116000 xsym               CMPQ    I
         4 002101   000075 605400 4                  TPNZ    s:4706

      636     5133        /**/
      637     5134    1           RETURN;

   5134  4 002102   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:93   

      638     5135        /**/
      639     5136    1   CONFIG_ERR:
      640     5137    1           CALL TSE$ERROR(0);

   5137  4 002103   000025 630400 5     CONFIG_ERR   EPPR0   21
         4 002104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002105   000000 701000 xent               TSX1    TSE$ERROR
         4 002106   000000 011000                    NOP     0

      641     5138    1           CALL TSE$ERROR(%E$T_CONFIGERR);

   5138  4 002107   000027 630400 5                  EPPR0   23
         4 002110   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002111   000000 701000 xent               TSX1    TSE$ERROR
         4 002112   000000 011000                    NOP     0

      642     5139    1           CALL M$CLOSE (CLOSE_CONFIG);

   5139  4 002113   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 002114   050001 713400                    CLIMB   close
         4 002115   406000 401760                    pmme    nvectors=13

      643     5140        /**/
      644     5141        /*E*    ERROR:   TSS-E$T_CONFIGERR-0
      645     5142                MESSAGE: Error accessing :CONFIG file.
      646     5143                DESCRIPTION: CANT GET AT :CONFIG TO DO DEVICES  */
      647     5144        /**/
      648     5145    1   BAD_PATH:
      649     5146    1           ALTRETURN;

   5146  4 002116   000000 702200 xent  BAD_PATH     TSX2  ! X66_AALT

      650     5147        %EJECT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:94   
      651     5148        /**/
      652     5149    1   PATH_2_NAME: PROC (O_BLK,NAME,TYPE) ALTRET;

   5149  4 002117   200016 741300       PATH_2_NAME  STX1  ! MPCNAME+2,,AUTO

      653     5150        /**/
      654     5151        /* PARAMETERS */
      655     5152        /**/
      656     5153        %PARSE$OUT (NAME=O_BLK,STCLASS=" ");
      657     5198    2   DCL NAME CHAR(8);
      658     5199    2   DCL TYPE UBIN WORD;
      659     5200        /**/
      660     5201        /* AUTOMATIC */
      661     5202        /**/
      662     5203    2   DCL MNEM CHAR(3) AUTO;
      663     5204        /**/
      664     5205        /* PROCEDURE */
      665     5206        /**/
      666     5207    3           IF (TYPE = TSS_MPC) THEN DO CASE (O_BLK.SUBLK$(0) -> O$BLK.CODE);

   5207  4 002120   200021 470500                    LDP0    @TYPE,,AUTO
         4 002121   000000 235100                    LDA     0,,PR0
         4 002122   000002 115007                    CMPA    2,DL
         4 002123   002163 601000 4                  TNZ     s:5218

   5207  4 002124   200017 471500                    LDP1    @O_BLK,,AUTO
         4 002125   100003 473500                    LDP3    3,,PR1
         4 002126   300000 720100                    LXL0    0,,PR3
         4 002127   000005 100003                    CMPX0   5,DU
         4 002130   002132 602010 4                  TNC     s:5207+10,X0
         4 002131   002261 710000 4                  TRA     s:5239
         4 002132   002162 710000 4                  TRA     s:5216
         4 002133   002137 710000 4                  TRA     s:5209
         4 002134   002144 710000 4                  TRA     s:5211
         4 002135   002151 710000 4                  TRA     s:5213
         4 002136   002156 710000 4                  TRA     s:5215

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:95   
      667     5208    3            CASE (TSS_DC);

      668     5209    3              MNEM = 'DC';

   5209  4 002137   000011 236000 3                  LDQ     9
         4 002140   777777 376003                    ANQ     -1,DU
         4 002141   040040 276007                    ORQ     16416,DL
         4 002142   200022 756100                    STQ     MNEM,,AUTO
         4 002143   002261 710000 4                  TRA     s:5239

      669     5210    3            CASE (TSS_TC);

      670     5211    3              MNEM = 'TC';

   5211  4 002144   000012 236000 3                  LDQ     10
         4 002145   777777 376003                    ANQ     -1,DU
         4 002146   040040 276007                    ORQ     16416,DL
         4 002147   200022 756100                    STQ     MNEM,,AUTO
         4 002150   002261 710000 4                  TRA     s:5239

      671     5212    3            CASE (TSS_UC);

      672     5213    3              MNEM = 'UC';

   5213  4 002151   000013 236000 3                  LDQ     11
         4 002152   777777 376003                    ANQ     -1,DU
         4 002153   040040 276007                    ORQ     16416,DL
         4 002154   200022 756100                    STQ     MNEM,,AUTO
         4 002155   002261 710000 4                  TRA     s:5239

      673     5214    3            CASE (TSS_AC);

      674     5215    3              MNEM = 'AC';

   5215  4 002156   000014 236000 3                  LDQ     12
         4 002157   777777 376003                    ANQ     -1,DU
         4 002160   040040 276007                    ORQ     16416,DL
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:96   
         4 002161   200022 756100                    STQ     MNEM,,AUTO

      675     5216    3            END;

   5216  4 002162   002261 710000 4                  TRA     s:5239

      676     5217        /**/
      677     5218    2           ELSE IF (TYPE = TSS_FEP) THEN MNEM = 'FEP';

   5218  4 002163   000003 115007                    CMPA    3,DL
         4 002164   002172 601000 4                  TNZ     s:5220

   5218  4 002165   000015 236000 3                  LDQ     13
         4 002166   000030 376000 5                  ANQ     24
         4 002167   000040 276007                    ORQ     32,DL
         4 002170   200022 756100                    STQ     MNEM,,AUTO
         4 002171   002261 710000 4                  TRA     s:5239

      678     5219        /**/
      679     5220    3              ELSE DO CASE (O_BLK.SUBLK$(0) -> O$BLK.CODE);

   5220  4 002172   200017 471500                    LDP1    @O_BLK,,AUTO
         4 002173   100003 473500                    LDP3    3,,PR1
         4 002174   300000 720100                    LXL0    0,,PR3
         4 002175   000012 100003                    CMPX0   10,DU
         4 002176   002200 602010 4                  TNC     s:5220+6,X0
         4 002177   002261 710000 4                  TRA     s:5239
         4 002200   002261 710000 4                  TRA     s:5239
         4 002201   002212 710000 4                  TRA     s:5222
         4 002202   002217 710000 4                  TRA     s:5224
         4 002203   002224 710000 4                  TRA     s:5226
         4 002204   002231 710000 4                  TRA     s:5228
         4 002205   002236 710000 4                  TRA     s:5230
         4 002206   002255 710000 4                  TRA     s:5236
         4 002207   002261 710000 4                  TRA     s:5239
         4 002210   002243 710000 4                  TRA     s:5232
         4 002211   002250 710000 4                  TRA     s:5234
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:97   

      680     5221    3               CASE (TSS_LP);

      681     5222    3                 MNEM = 'LP';

   5222  4 002212   000000 236000 3                  LDQ     0
         4 002213   777777 376003                    ANQ     -1,DU
         4 002214   040040 276007                    ORQ     16416,DL
         4 002215   200022 756100                    STQ     MNEM,,AUTO
         4 002216   002261 710000 4                  TRA     s:5239

      682     5223    3               CASE (TSS_CR);

      683     5224    3                 MNEM = 'CR';

   5224  4 002217   000001 236000 3                  LDQ     1
         4 002220   777777 376003                    ANQ     -1,DU
         4 002221   040040 276007                    ORQ     16416,DL
         4 002222   200022 756100                    STQ     MNEM,,AUTO
         4 002223   002261 710000 4                  TRA     s:5239

      684     5225    3               CASE (TSS_CP);

      685     5226    3                 MNEM = 'CP';

   5226  4 002224   000002 236000 3                  LDQ     2
         4 002225   777777 376003                    ANQ     -1,DU
         4 002226   040040 276007                    ORQ     16416,DL
         4 002227   200022 756100                    STQ     MNEM,,AUTO
         4 002230   002261 710000 4                  TRA     s:5239

      686     5227    3               CASE (TSS_DP);

      687     5228    3                 MNEM = 'DP';

   5228  4 002231   000003 236000 3                  LDQ     3
         4 002232   777777 376003                    ANQ     -1,DU
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:98   
         4 002233   040040 276007                    ORQ     16416,DL
         4 002234   200022 756100                    STQ     MNEM,,AUTO
         4 002235   002261 710000 4                  TRA     s:5239

      688     5229    3               CASE (TSS_MT);

      689     5230    3                 MNEM = 'MT';

   5230  4 002236   000004 236000 3                  LDQ     4
         4 002237   777777 376003                    ANQ     -1,DU
         4 002240   040040 276007                    ORQ     16416,DL
         4 002241   200022 756100                    STQ     MNEM,,AUTO
         4 002242   002261 710000 4                  TRA     s:5239

      690     5231    3               CASE (TSS_AP);

      691     5232    3                 MNEM = 'AP';

   5232  4 002243   000006 236000 3                  LDQ     6
         4 002244   777777 376003                    ANQ     -1,DU
         4 002245   040040 276007                    ORQ     16416,DL
         4 002246   200022 756100                    STQ     MNEM,,AUTO
         4 002247   002261 710000 4                  TRA     s:5239

      692     5233    3               CASE (TSS_OD);

      693     5234    3                 MNEM = 'OD';

   5234  4 002250   000007 236000 3                  LDQ     7
         4 002251   777777 376003                    ANQ     -1,DU
         4 002252   040040 276007                    ORQ     16416,DL
         4 002253   200022 756100                    STQ     MNEM,,AUTO
         4 002254   002261 710000 4                  TRA     s:5239

      694     5235    3               CASE (TSS_SC);

      695     5236    3                 MNEM = 'SC';
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:99   

   5236  4 002255   000005 236000 3                  LDQ     5
         4 002256   777777 376003                    ANQ     -1,DU
         4 002257   040040 276007                    ORQ     16416,DL
         4 002260   200022 756100                    STQ     MNEM,,AUTO

      696     5237    3               END;

      697     5238        /**/
      698     5239    3           IF ((MNEM = 'DP')OR(MNEM = 'MT')OR(MNEM='OD')) THEN DO;

   5239  4 002261   040000 106500                    CMPC    fill='040'O
         4 002262   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002263   000003 000002 3                  ADSC9   3                        cn=0,n=2
         4 002264   002275 600000 4                  TZE     s:5240
         4 002265   040000 106500                    CMPC    fill='040'O
         4 002266   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002267   000004 000002 3                  ADSC9   4                        cn=0,n=2
         4 002270   002275 600000 4                  TZE     s:5240
         4 002271   040000 106500                    CMPC    fill='040'O
         4 002272   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002273   000007 000002 3                  ADSC9   7                        cn=0,n=2
         4 002274   002307 601000 4                  TNZ     s:5252

      699     5240    4              IF (O_BLK.NSUBLKS < 4) THEN DO; /* DEV# NOT GIVEN                  */

   5240  4 002275   200017 471500                    LDP1    @O_BLK,,AUTO
         4 002276   100001 220100                    LDX0    1,,PR1
         4 002277   000004 100003                    CMPX0   4,DU
         4 002300   002321 603000 4                  TRC     s:5263

      700     5241    4                 CALL TSE$ERROR(%E$T_MISSINGDEV#);

   5241  4 002301   000032 630400 5                  EPPR0   26
         4 002302   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002303   000000 701000 xent               TSX1    TSE$ERROR
         4 002304   000000 011000                    NOP     0
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:100  

      701     5242    4                 ALTRETURN;

   5242  4 002305   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002306   000000 702211                    TSX2  ! 0,X1

      702     5243    4                 END;
      703     5244    3              END;
      704     5245        /**/
      705     5246        /*E*    ERROR:   TSS-E$T_MISSINGDEV#-0
      706     5247                MESSAGE: Missing device number - path description incomplete.
      707     5248                MESSAGE1: You must specify a device number as part of the
      708     5249                          access path description for this device.
      709     5250                DESCRIPTION: MT AND DP NEED DEVICE NUMBER TO BE LOCATED.  */
      710     5251        /**/
      711     5252    3           ELSE IF (O_BLK.NSUBLKS = 4) THEN DO; /* GIVEN DEV# NOT LEGAL          */

   5252  4 002307   200017 471500                    LDP1    @O_BLK,,AUTO
         4 002310   100001 220100                    LDX0    1,,PR1
         4 002311   000004 100003                    CMPX0   4,DU
         4 002312   002321 601000 4                  TNZ     s:5263

      712     5253    3                 CALL TSE$ERROR(%E$T_ILLEGALDEV#);

   5253  4 002313   000034 630400 5                  EPPR0   28
         4 002314   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002315   000000 701000 xent               TSX1    TSE$ERROR
         4 002316   000000 011000                    NOP     0

      713     5254    3                 ALTRETURN;

   5254  4 002317   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002320   000000 702211                    TSX2  ! 0,X1

      714     5255    3                 END;
      715     5256        /**/
      716     5257        /*E*    ERROR:   TSS-E$T_ILLEGALDEV#-0
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:101  
      717     5258                MESSAGE: Illegal device number - not part of path for this device.
      718     5259                MESSAGE1: The access path description for this device does not
      719     5260                          allow a device number - just IOM and CHANNEL.
      720     5261                DESCRIPTION: DEVICE NUMBER GIVEN WHERE UNWANTED */
      721     5262        /**/
      722     5263    3           IF (O_BLK.SUBLK$(1) -> O$SYM.COUNT ~= 1) THEN DO;

   5263  4 002321   100004 473500                    LDP3    4,,PR1
         4 002322   300004 236100                    LDQ     4,,PR3
         4 002323   777000 376003                    ANQ     -512,DU
         4 002324   001000 116003                    CMPQ    512,DU
         4 002325   002334 600000 4                  TZE     s:5268

      723     5264    3              CALL TSE$ERROR(%E$T_BADIOMNUM);

   5264  4 002326   000020 630400 5                  EPPR0   16
         4 002327   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002330   000000 701000 xent               TSX1    TSE$ERROR
         4 002331   000000 011000                    NOP     0

      724     5265    3              ALTRETURN;

   5265  4 002332   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002333   000000 702211                    TSX2  ! 0,X1

      725     5266    3              END;
      726     5267        /**/
      727     5268    2           CALL CHARBIN(I,SUBSTR(O_BLK.SUBLK$(2) -> O$SYM.TEXT,0,

   5268  4 002334   100005 474500                    LDP4    5,,PR1
         4 002335   400004 236100                    LDQ     4,,PR4
         4 002336   000033 772000                    QRL     27
         4 002337   000000 622006                    EAX2    0,QL
         4 002340   000000 305540                    DTB
         4 002341   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 002342   000000 000004 xsym               NDSC9   I                        cn=0,s=lsgnf,sf=0,n=4

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:102  
      728     5269    2             O_BLK.SUBLK$(2) -> O$SYM.COUNT));
      729     5270    3           IF (I > %N_MAXCHANS-1) THEN DO;

   5270  4 002343   000000 235000 xsym               LDA     I
         4 002344   000177 115007                    CMPA    127,DL
         4 002345   002354 604400 4                  TMOZ    s:5275

      730     5271    3              CALL TSE$ERROR(%E$T_BADCHANNUM);

   5271  4 002346   000022 630400 5                  EPPR0   18
         4 002347   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002350   000000 701000 xent               TSX1    TSE$ERROR
         4 002351   000000 011000                    NOP     0

      731     5272    3              ALTRETURN;

   5272  4 002352   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002353   000000 702211                    TSX2  ! 0,X1

      732     5273    3              END;
      733     5274        /**/
      734     5275    2           CONFIG_KEY.COUNT = 4;

   5275  4 002354   004000 236003                    LDQ     2048,DU
         4 002355   000000 552040 xsym               STBQ    CONFIG_KEY,'40'O

      735     5276    2           CONFIG_KEY.TEXT = 'IOM';

   5276  4 002356   040000 100400                    MLR     fill='040'O
         4 002357   000016 000003 3                  ADSC9   14                       cn=0,n=3
         4 002360   000000 200010 xsym               ADSC9   CONFIG_KEY               cn=1,n=8

      736     5277    2           CALL INSERT(CONFIG_KEY.TEXT,3,1,O_BLK.SUBLK$(1) -> O$SYM.TEXT);

   5277  4 002361   300004 236100                    LDQ     4,,PR3
         4 002362   000033 772000                    QRL     27
         4 002363   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:103  
         4 002364   040000 100540                    MLR     fill='040'O
         4 002365   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 002366   000001 000001 xsym               ADSC9   CONFIG_KEY+1             cn=0,n=1

      737     5278        /**/
      738     5279    2           CALL M$OPEN(OPEN_CONFIG) ALTRET(CONFIG_ERR);

   5279  4 002367   000002 630400 1                  EPPR0   OPEN_CONFIG
         4 002370   450000 713400                    CLIMB   alt,open
         4 002371   410400 401760                    pmme    nvectors=18
         4 002372   002750 702000 4                  TSX2    CONFIG_ERR

      739     5280    2           CALL M$READ(READ_CONFIG) ALTRET(CONFIG_ERR);

   5280  4 002373   000132 630400 1                  EPPR0   READ_CONFIG
         4 002374   440000 713400                    CLIMB   alt,read
         4 002375   401400 401760                    pmme    nvectors=4
         4 002376   002750 702000 4                  TSX2    CONFIG_ERR

      740     5281    2           CALL M$CLOSE(CLOSE_CONFIG) ALTRET (CONFIG_ERR);

   5281  4 002377   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 002400   450001 713400                    CLIMB   alt,close
         4 002401   406000 401760                    pmme    nvectors=13
         4 002402   002750 702000 4                  TSX2    CONFIG_ERR

      741     5282        /**/
      742     5283    2           NAME = CONFIG$ -> TD$IOM.DEVNAME(I);

   5283  4 002403   000000 235000 xsym               LDA     I
         4 002404   000003 735000                    ALS     3
         4 002405   000000 470400 xsym               LDP0    CONFIG$
         4 002406   200020 471500                    LDP1    @NAME,,AUTO
         4 002407   040100 100505                    MLR     fill='040'O
         4 002410   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8
         4 002411   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:104  
      743     5284        /**/
      744     5285    2           IF (((MNEM = 'DP')OR(MNEM = 'DC'))AND

   5285  4 002412   040000 106500                    CMPC    fill='040'O
         4 002413   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002414   000003 000002 3                  ADSC9   3                        cn=0,n=2
         4 002415   002422 600000 4                  TZE     s:5285+8
         4 002416   040000 106500                    CMPC    fill='040'O
         4 002417   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002420   000011 000002 3                  ADSC9   9                        cn=0,n=2
         4 002421   002426 601000 4                  TNZ     s:5285+12
         4 002422   040000 106500                    CMPC    fill='040'O
         4 002423   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         4 002424   000011 000002 3                  ADSC9   9                        cn=0,n=2
         4 002425   002526 601000 4                  TNZ     BAD_DEVMNEM
         4 002426   040000 106500                    CMPC    fill='040'O
         4 002427   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002430   000004 000002 3                  ADSC9   4                        cn=0,n=2
         4 002431   002436 600000 4                  TZE     s:5285+20
         4 002432   040000 106500                    CMPC    fill='040'O
         4 002433   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002434   000012 000002 3                  ADSC9   10                       cn=0,n=2
         4 002435   002442 601000 4                  TNZ     s:5285+24
         4 002436   040000 106500                    CMPC    fill='040'O
         4 002437   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         4 002440   000012 000002 3                  ADSC9   10                       cn=0,n=2
         4 002441   002526 601000 4                  TNZ     BAD_DEVMNEM
         4 002442   040000 106500                    CMPC    fill='040'O
         4 002443   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002444   000000 000002 3                  ADSC9   0                        cn=0,n=2
         4 002445   002462 600000 4                  TZE     s:5285+40
         4 002446   040000 106500                    CMPC    fill='040'O
         4 002447   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002450   000001 000002 3                  ADSC9   1                        cn=0,n=2
         4 002451   002462 600000 4                  TZE     s:5285+40
         4 002452   040000 106500                    CMPC    fill='040'O
         4 002453   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:105  
         4 002454   000002 000002 3                  ADSC9   2                        cn=0,n=2
         4 002455   002462 600000 4                  TZE     s:5285+40
         4 002456   040000 106500                    CMPC    fill='040'O
         4 002457   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002460   000013 000002 3                  ADSC9   11                       cn=0,n=2
         4 002461   002466 601000 4                  TNZ     s:5285+44
         4 002462   040000 106500                    CMPC    fill='040'O
         4 002463   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         4 002464   000013 000002 3                  ADSC9   11                       cn=0,n=2
         4 002465   002526 601000 4                  TNZ     BAD_DEVMNEM
         4 002466   200022 236100                    LDQ     MNEM,,AUTO
         4 002467   000015 676000 3                  ERQ     13
         4 002470   000030 376000 5                  ANQ     24
         4 002471   002476 600000 4                  TZE     s:5285+52
         4 002472   040000 106500                    CMPC    fill='040'O
         4 002473   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002474   000007 000002 3                  ADSC9   7                        cn=0,n=2
         4 002475   002502 601000 4                  TNZ     s:5285+56
         4 002476   040000 106500                    CMPC    fill='040'O
         4 002477   100000 000003                    ADSC9   0,,PR1                   cn=0,n=3
         4 002500   000015 000003 3                  ADSC9   13                       cn=0,n=3
         4 002501   002526 601000 4                  TNZ     BAD_DEVMNEM
         4 002502   040000 106500                    CMPC    fill='040'O
         4 002503   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002504   000005 000002 3                  ADSC9   5                        cn=0,n=2
         4 002505   002512 601000 4                  TNZ     s:5285+64
         4 002506   040000 106500                    CMPC    fill='040'O
         4 002507   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         4 002510   000005 000002 3                  ADSC9   5                        cn=0,n=2
         4 002511   002526 601000 4                  TNZ     BAD_DEVMNEM
         4 002512   040000 106500                    CMPC    fill='040'O
         4 002513   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002514   000006 000002 3                  ADSC9   6                        cn=0,n=2
         4 002515   002522 600000 4                  TZE     s:5285+72
         4 002516   040000 106500                    CMPC    fill='040'O
         4 002517   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002520   000014 000002 3                  ADSC9   12                       cn=0,n=2
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:106  
         4 002521   002564 601000 4                  TNZ     s:5313
         4 002522   040000 106500                    CMPC    fill='040'O
         4 002523   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         4 002524   000014 000002 3                  ADSC9   12                       cn=0,n=2
         4 002525   002564 600000 4                  TZE     s:5313

      745     5286    2             (SUBSTR(NAME,0,2) ~= 'DC'))OR
      746     5287    2             (((MNEM = 'MT')OR(MNEM = 'TC'))AND
      747     5288    2             (SUBSTR(NAME,0,2) ~= 'TC'))OR
      748     5289    2             (((MNEM = 'LP')OR(MNEM = 'CR')OR(MNEM = 'CP')OR(MNEM = 'UC'))AND
      749     5290    2             (SUBSTR(NAME,0,2) ~= 'UC'))OR
      750     5291    2             (((MNEM = 'FEP')OR(MNEM = 'OD'))AND
      751     5292    2             (SUBSTR(NAME,0,3) ~= 'FEP'))OR
      752     5293    2             (((MNEM = 'SC'))AND
      753     5294    2             (SUBSTR(NAME,0,2) ~= 'SC')) OR
      754     5295    2             (((MNEM = 'AP')OR(MNEM = 'AC'))AND
      755     5296    3             (SUBSTR(NAME,0,2) ~= 'AC')) THEN DO; /* DEVICE NOT THERE            */

      756     5297        /**/
      757     5298    3   BAD_DEVMNEM:
      758     5299    3              SUB_BUF_1.COUNT = 1;

   5299  4 002526   001000 236003       BAD_DEVMNEM  LDQ     512,DU
         4 002527   000000 552040 xsym               STBQ    SUB_BUF_1,'40'O

      759     5300    3              SUB_BUF_1.TEXT = O_BLK.SUBLK$(1) -> O$SYM.TEXT; /* IOM NUMBER        */

   5300  4 002530   200017 470500                    LDP0    @O_BLK,,AUTO
         4 002531   000004 471500                    LDP1    4,,PR0
         4 002532   100004 236100                    LDQ     4,,PR1
         4 002533   000033 772000                    QRL     27
         4 002534   000000 620006                    EAX0    0,QL
         4 002535   040000 100540                    MLR     fill='040'O
         4 002536   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 002537   000000 200037 xsym               ADSC9   SUB_BUF_1                cn=1,n=31

      760     5301    3              SUB_BUF_2.COUNT = O_BLK.SUBLK$(2) -> O$SYM.COUNT;
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:107  

   5301  4 002540   000005 471500                    LDP1    5,,PR0
         4 002541   100004 236100                    LDQ     4,,PR1
         4 002542   000000 552040 xsym               STBQ    SUB_BUF_2,'40'O

      761     5302    3              SUB_BUF_2.TEXT = O_BLK.SUBLK$(2) -> O$SYM.TEXT; /* CHAN NUMBER       */

   5302  4 002543   100004 236100                    LDQ     4,,PR1
         4 002544   000033 772000                    QRL     27
         4 002545   000000 620006                    EAX0    0,QL
         4 002546   040000 100540                    MLR     fill='040'O
         4 002547   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 002550   000000 200037 xsym               ADSC9   SUB_BUF_2                cn=1,n=31

      762     5303    3              SUB_BUF_3.COUNT = 3;

   5303  4 002551   003000 236003                    LDQ     1536,DU
         4 002552   000000 552040 xsym               STBQ    SUB_BUF_3,'40'O

      763     5304    3              SUB_BUF_3.TEXT = MNEM;

   5304  4 002553   040000 100500                    MLR     fill='040'O
         4 002554   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002555   000000 200037 xsym               ADSC9   SUB_BUF_3                cn=1,n=31

      764     5305    3              CALL TSE$ERROR (%E$T_DEVNOTTHERE);

   5305  4 002556   000036 630400 5                  EPPR0   30
         4 002557   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002560   000000 701000 xent               TSX1    TSE$ERROR
         4 002561   000000 011000                    NOP     0

      765     5306    3              ALTRETURN;

   5306  4 002562   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002563   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:108  
      766     5307    3              END;
      767     5308        /**/
      768     5309        /*E*    ERROR: TSS-E$T_DEVNOTTHERE-0
      769     5310                MESSAGE: No %U3 on IOM#%U1,CHAN%U2
      770     5311                DESCRIPTION: PATH DESCRIPTION DOESN'T LEAD TO RIGHT DEVICE TYPE */
      771     5312        /**/
      772     5313    2          IF (TYPE = TSS_MPC)OR(MNEM = 'SC')OR(MNEM = 'FEP') THEN RETURN; /* GOT IT */

   5313  4 002564   200021 470500                    LDP0    @TYPE,,AUTO
         4 002565   000000 235100                    LDA     0,,PR0
         4 002566   000002 115007                    CMPA    2,DL
         4 002567   002600 600000 4                  TZE     s:5313+12
         4 002570   040000 106500                    CMPC    fill='040'O
         4 002571   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002572   000005 000002 3                  ADSC9   5                        cn=0,n=2
         4 002573   002600 600000 4                  TZE     s:5313+12
         4 002574   200022 236100                    LDQ     MNEM,,AUTO
         4 002575   000015 676000 3                  ERQ     13
         4 002576   000030 376000 5                  ANQ     24
         4 002577   002602 601000 4                  TNZ     s:5315

   5313  4 002600   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002601   000001 702211                    TSX2  ! 1,X1

      773     5314        /**/
      774     5315    2           CONFIG_KEY.COUNT = 8;

   5315  4 002602   010000 236003                    LDQ     4096,DU
         4 002603   000000 552040 xsym               STBQ    CONFIG_KEY,'40'O

      775     5316    2           CONFIG_KEY.TEXT = NAME;

   5316  4 002604   040000 100500                    MLR     fill='040'O
         4 002605   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         4 002606   000000 200010 xsym               ADSC9   CONFIG_KEY               cn=1,n=8

      776     5317        /**/
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:109  
      777     5318    2           CALL M$OPEN(OPEN_CONFIG) ALTRET(CONFIG_ERR);

   5318  4 002607   000002 630400 1                  EPPR0   OPEN_CONFIG
         4 002610   450000 713400                    CLIMB   alt,open
         4 002611   410400 401760                    pmme    nvectors=18
         4 002612   002750 702000 4                  TSX2    CONFIG_ERR

      778     5319    2           CALL M$READ(READ_CONFIG) ALTRET(CONFIG_ERR);

   5319  4 002613   000132 630400 1                  EPPR0   READ_CONFIG
         4 002614   440000 713400                    CLIMB   alt,read
         4 002615   401400 401760                    pmme    nvectors=4
         4 002616   002750 702000 4                  TSX2    CONFIG_ERR

      779     5320    2           CALL M$CLOSE(CLOSE_CONFIG) ALTRET(CONFIG_ERR);

   5320  4 002617   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 002620   450001 713400                    CLIMB   alt,close
         4 002621   406000 401760                    pmme    nvectors=13
         4 002622   002750 702000 4                  TSX2    CONFIG_ERR

      780     5321        /**/
      781     5322    3          IF (MNEM = 'DP')OR(MNEM = 'MT')OR(MNEM = 'OD') THEN DO; /* GET DEV NUMBER */

   5322  4 002623   040000 106500                    CMPC    fill='040'O
         4 002624   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002625   000003 000002 3                  ADSC9   3                        cn=0,n=2
         4 002626   002637 600000 4                  TZE     s:5323
         4 002627   040000 106500                    CMPC    fill='040'O
         4 002630   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002631   000004 000002 3                  ADSC9   4                        cn=0,n=2
         4 002632   002637 600000 4                  TZE     s:5323
         4 002633   040000 106500                    CMPC    fill='040'O
         4 002634   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002635   000007 000002 3                  ADSC9   7                        cn=0,n=2
         4 002636   002671 601000 4                  TNZ     s:5339

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:110  
      782     5323    3              CALL CHARBIN(I,SUBSTR(O_BLK.SUBLK$(3) -> O$SYM.TEXT,0,

   5323  4 002637   200017 470500                    LDP0    @O_BLK,,AUTO
         4 002640   000006 471500                    LDP1    6,,PR0
         4 002641   100004 236100                    LDQ     4,,PR1
         4 002642   000033 772000                    QRL     27
         4 002643   000000 620006                    EAX0    0,QL
         4 002644   000000 305540                    DTB
         4 002645   100004 230010                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X0
         4 002646   000000 000004 xsym               NDSC9   I                        cn=0,s=lsgnf,sf=0,n=4

      783     5324    3                O_BLK.SUBLK$(3) -> O$SYM.COUNT));
      784     5325        /**/
      785     5326    4              IF (I > CONFIG$ -> TD$MPC.NUMDEVS) THEN DO;

   5326  4 002647   000000 473400 xsym               LDP3    CONFIG$
         4 002650   300012 236100                    LDQ     10,,PR3
         4 002651   000022 772000                    QRL     18
         4 002652   000000 116000 xsym               CMPQ    I
         4 002653   002662 605000 4                  TPL     s:5335

      786     5327    4                 CALL TSE$ERROR(%E$T_BADDEV#);

   5327  4 002654   000040 630400 5                  EPPR0   32
         4 002655   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002656   000000 701000 xent               TSX1    TSE$ERROR
         4 002657   000000 011000                    NOP     0

      787     5328    4                 ALTRETURN;

   5328  4 002660   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002661   000000 702211                    TSX2  ! 0,X1

      788     5329    4                 END;
      789     5330        /**/
      790     5331        /*E*    ERROR:   TSS-E$T_BADDEV#-0
      791     5332                MESSAGE: No device on this path with that device number.
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:111  
      792     5333                DESCRIPTION: DEVICE NUMBER GIVEN IS TOO BIG. */
      793     5334        /**/
      794     5335    3              NAME = CONFIG$ -> TD$MPC.DEVNAME(I-1);

   5335  4 002662   000000 235000 xsym               LDA     I
         4 002663   000003 735000                    ALS     3
         4 002664   200020 474500                    LDP4    @NAME,,AUTO
         4 002665   040100 100505                    MLR     fill='040'O
         4 002666   300015 000010                    ADSC9   13,A,PR3                 cn=0,n=8
         4 002667   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8

      795     5336    3              END;

   5336  4 002670   002746 710000 4                  TRA     s:5353

      796     5337        /**/
      797     5338    3           ELSE DO;

      798     5339    3              CALL CHARBIN(J,SUBSTR(O_BLK.SUBLK$(1) -> O$SYM.TEXT,0,1));;

   5339  4 002671   200017 470500                    LDP0    @O_BLK,,AUTO
         4 002672   000004 471500                    LDP1    4,,PR0
         4 002673   100004 236100                    LDQ     4,,PR1
         4 002674   000033 772000                    QRL     27
         4 002675   000000 305500                    DTB
         4 002676   100004 230001                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=1
         4 002677   000000 000004 xsym               NDSC9   J                        cn=0,s=lsgnf,sf=0,n=4

      799     5340    4              DO K = 0 TO 7;               /* CHECK ALL POSSIBLE DEVICES         */

   5340  4 002700   000000 450000 xsym               STZ     K

      800     5341    4                 IF (CONFIG$ -> TD$MPC.IOCHAN.PRESENCE(K)) THEN

   5341  4 002701   000000 470400 xsym               LDP0    CONFIG$
         4 002702   000000 720000 xsym               LXL0    K
         4 002703   000002 234110                    SZN     2,X0,PR0
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:112  
         4 002704   002741 605000 4                  TPL     s:5350

      801     5342    4                    IF (CONFIG$ -> TD$MPC.IOCHAN.IOM(K) = J) THEN

   5342  4 002705   000002 236110                    LDQ     2,X0,PR0
         4 002706   000022 772000                    QRL     18
         4 002707   000777 376007                    ANQ     511,DL
         4 002710   000000 116000 xsym               CMPQ    J
         4 002711   002741 601000 4                  TNZ     s:5350

      802     5343    5                       IF (CONFIG$ -> TD$MPC.IOCHAN.LOCHAN(K) = I) THEN DO;

   5343  4 002712   000002 236110                    LDQ     2,X0,PR0
         4 002713   000011 772000                    QRL     9
         4 002714   000777 376007                    ANQ     511,DL
         4 002715   000000 116000 xsym               CMPQ    I
         4 002716   002741 601000 4                  TNZ     s:5350

      803     5344    5                          IF MNEM = 'AP' THEN

   5344  4 002717   040000 106500                    CMPC    fill='040'O
         4 002720   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002721   000006 000002 3                  ADSC9   6                        cn=0,n=2
         4 002722   002725 601000 4                  TNZ     s:5346

      804     5345    5                             K = K-1;
              5345                                      /* 1st channel is reserved for AC - no dev on it */

   5345  4 002723   000001 336007                    LCQ     1,DL
         4 002724   000000 056000 xsym               ASQ     K

      805     5346    5                          NAME = CONFIG$ -> TD$MPC.DEVNAME(K);

   5346  4 002725   000000 235000 xsym               LDA     K
         4 002726   000003 735000                    ALS     3
         4 002727   200020 471500                    LDP1    @NAME,,AUTO
         4 002730   040100 100505                    MLR     fill='040'O
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:113  
         4 002731   000017 000010                    ADSC9   15,A,PR0                 cn=0,n=8
         4 002732   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

      806     5347    5                          IF (SUBSTR(NAME,0,2) ~= MNEM) THEN GOTO BAD_DEVMNEM;

   5347  4 002733   040100 106500                    CMPC    fill='040'O
         4 002734   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         4 002735   200022 000003                    ADSC9   MNEM,,AUTO               cn=0,n=3
         4 002736   002526 601000 4                  TNZ     BAD_DEVMNEM

      807     5348    5                          RETURN;

   5348  4 002737   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002740   000001 702211                    TSX2  ! 1,X1

      808     5349    5                          END;
      809     5350    4                 END;

   5350  4 002741   000000 054000 xsym               AOS     K
         4 002742   000000 235000 xsym               LDA     K
         4 002743   000007 115007                    CMPA    7,DL
         4 002744   002701 604400 4                  TMOZ    s:5341

      810     5351    3              GOTO BAD_DEVMNEM;

   5351  4 002745   002526 710000 4                  TRA     BAD_DEVMNEM

      811     5352    3              END;
      812     5353    2           RETURN;

   5353  4 002746   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002747   000001 702211                    TSX2  ! 1,X1

      813     5354        /**/
      814     5355    2   CONFIG_ERR:
      815     5356    2           CALL TSE$ERROR(0);

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:114  
   5356  4 002750   000025 630400 5     CONFIG_ERR   EPPR0   21
         4 002751   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002752   000000 701000 xent               TSX1    TSE$ERROR
         4 002753   000000 011000                    NOP     0

      816     5357    2           CALL TSE$ERROR(%E$T_CONFIGERR);

   5357  4 002754   000027 630400 5                  EPPR0   23
         4 002755   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002756   000000 701000 xent               TSX1    TSE$ERROR
         4 002757   000000 011000                    NOP     0

      817     5358    2           CALL M$CLOSE (CLOSE_CONFIG);

   5358  4 002760   000074 630400 1                  EPPR0   CLOSE_CONFIG
         4 002761   050001 713400                    CLIMB   close
         4 002762   406000 401760                    pmme    nvectors=13

      818     5359    2           ALTRETURN;

   5359  4 002763   200016 221300                    LDX1  ! MPCNAME+2,,AUTO
         4 002764   000000 702211                    TSX2  ! 0,X1
      819     5360    2   END;
      820     5361    1   END;

PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:115  
--  Include file information  --

   NI$TABLES.:E05TOU  is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
   TD$STRUCT.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   TS_PERR_C.:E05TOU  is referenced.
   TS_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TSC$CHECK.
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:116  

 **** Variables and constants ****

  ****  Section 001  Data  TSC$CHECK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    74-0-0/d STRC(1080)  r     1 CLOSE_CONFIG             150-0-0/c STRC(72)    r     1 CONFIG_FILE
     2-0-0/d STRC(2088)  r     1 OPEN_CONFIG              132-0-0/d STRC(504)   r     1 READ_CONFIG
   152-0-0/c STRC(72)    r     1 SYSACCT                    0-0-0/b BIT         r     1 TS_DIPART
     1-0-0/b BIT         r     1 TS_DIREL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    20-0-0/w PTR         r     1 @NAME                     17-0-0/w PTR         r     1 @O_BLK
     3-0-0/w PTR         r     1 @PCB                      21-0-0/w PTR         r     1 @TYPE
    10-0-0/c CHAR(8)     r     1 FEPNAME                   22-0-0/c CHAR(3)     r     1 MNEM
    14-0-0/c CHAR(8)     r     1 MPCNAME                   12-0-0/b BIT         r     1 MPC_CHANS
    13-0-0/b BIT         r     1 MPC_DEVS                  14-0-0/c STRC(72)    r     1 NAME
    *0-0-0/c CHAR(8)     r     1 NAME                       7-0-0/w SBIN        r     1 NUMIOMS
    *0-0-0/w STRC(144)   r     1 O_BLK                     *0-0-0/w STRC(504)   r     1 PCB
     5-0-0/w PTR         r     1 PTR$                       4-0-0/w PTR         r     1 SAVEBLK$
     6-0-0/w UBIN        r     1 TEMP                      *0-0-0/w UBIN        r     1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 BLK$                       0-0-0/w PTR         r     1 CMD$
     0-0-0/w PTR         r     1 CMD_BASE$                  0-0-0/w PTR         r     1 CONFIG$
     0-0-0/c STRC(81)    r     1 CONFIG_KEY                 0-0-0/w SBIN        r     1 I
     0-0-0/w SBIN        r     1 J                          0-0-0/w SBIN        r     1 K
     0-0-0/c STRC(288)   r     1 SUB_BUF_1                  0-0-0/c STRC(288)   r     1 SUB_BUF_2
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:117  
     0-0-0/c STRC(288)   r     1 SUB_BUF_3

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$CONF                     0-0-0/w STRC(144)   r     1 O$BLK
     0-0-0/w ASTR(153)   r     1 O$SYM                      0-0-0/w STRC(648)   r     1 TD$HEAD
     0-0-0/w STRC(9540)  r     1 TD$IOM                     0-0-0/w STRC(612)   r     1 TD$MPC
     0-0-0/w STRC(144)   r     1 TS$CHAN                    0-0-0/w UBIN        r     1 TS$CMDWD
     0-0-0/w STRC(72)    r     1 TS$CPU                     0-0-0/w STRC(108)   r     1 TS$DEV
     0-0-0/w STRC(108)   r     1 TS$FEP                     0-0-0/w STRC(72)    r     1 TS$IOM
     0-0-0/w STRC(108)   r     1 TS$MPC                     0-0-0/w STRC(108)   r     1 TS$PAGES
     0-0-0/w STRC(72)    r     1 TS$SCU


   Procedure TSC$CHECK requires 1525 words for executable code.
   Procedure TSC$CHECK requires 22 words of local(AUTO) storage.

    No errors detected in file TSC$CHECK.:E05TSI    .
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:118  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:119  
          MINI XREF LISTING

BAD_DEVMNEM IN PROCEDURE PATH_2_NAME
      5299**LABEL    5347--GOTO     5351--GOTO
BAD_PATH
      5146**LABEL    4764--CALLALT  4825--CALLALT  4946--CALLALT
BLK$
      4163**DCL      4595--IMP-PTR  4642--IMP-PTR  4706<<ASSIGN   4708<<ASSIGN   4708>>ASSIGN   4709>>ASSIGN
      4711>>DOCASE   4718<<ASSIGN   4718>>ASSIGN   4719>>DOCASE   4722>>DOCASE   4742<<ASSIGN   4742>>ASSIGN
      4744>>IF       4745>>ASSIGN   4745>>ASSIGN   4749>>IF       4750>>CALLBLT  4750>>CALLBLT  4764>>CALL
      4769<<ASSIGN   4769>>ASSIGN   4773>>CALLBLT  4773>>CALLBLT  4778>>IF       4784>>DOINDEX  4785>>DOCASE
      4795<<ASSIGN   4795>>ASSIGN   4796>>DOCASE   4799>>DOCASE   4811<<ASSIGN   4811>>ASSIGN   4812>>IF
      4821>>ASSIGN   4821>>ASSIGN   4825>>CALL     4925<<ASSIGN   4925>>ASSIGN   4926>>DOCASE   4929<<ASSIGN
      4929>>ASSIGN   4930>>IF       4940>>CALLBLT  4940>>CALLBLT  4940>>CALLBLT  4940>>CALLBLT  4941>>CALLBLT
      4941>>CALLBLT  4941>>CALLBLT  4943>>ASSIGN   4946>>CALL     4983>>IF       4992>>CALLBLT  4992>>CALLBLT
      4995>>CALLBLT  4995>>CALLBLT  4995>>CALLBLT  5008>>IF       5009>>CALLBLT  5009>>CALLBLT  5009>>CALLBLT
      5026>>IF       5032>>CALLBLT  5032>>CALLBLT  5032>>CALLBLT  5036>>IF       5037>>CALLBLT  5037>>CALLBLT
      5037>>CALLBLT  5067>>DOINDEX  5068>>ASSIGN   5117<<ASSIGN   5117>>ASSIGN   5121>>CALLBLT  5121>>CALLBLT
      5123<<ASSIGN   5123>>ASSIGN   5127>>CALLBLT  5127>>CALLBLT
CLOSE_CONFIG
      4359**DCL      4836<>CALL     4856<>CALL     4882<>CALL     4901<>CALL     4972<>CALL     4977<>CALL
      5139<>CALL     5281<>CALL     5320<>CALL     5358<>CALL
CLOSE_CONFIG.SN_
      4359**DCL      4359--REDEF
CLOSE_CONFIG.UTL_
      4360**DCL      4360--REDEF
CLOSE_CONFIG.V
      4364**DCL      4359--DCLINIT
CLOSE_CONFIG.V.EXPIRE#
      4374**DCL      4374--REDEF
CLOSE_CONFIG.V.TYPE#
      4372**DCL      4372--REDEF
CLOSE_CONFIG.V.XTNSIZE#
      4369**DCL      4369--REDEF    4371--REDEF
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:120  
CMD$
      4164**DCL      4683<<ASSIGN   4684>>ASSIGN   4685<<ASSIGN   4685>>ASSIGN   4687>>ASSIGN   4690>>ASSIGN
      4691>>ASSIGN   4692>>ASSIGN   4693<<ASSIGN   4693>>ASSIGN   4693>>ASSIGN   4694>>ASSIGN   4701>>ASSIGN
      4714>>ASSIGN   4715>>ASSIGN   4716>>ASSIGN   4725>>ASSIGN   4727>>ASSIGN   4729>>ASSIGN   4731>>ASSIGN
      4733>>ASSIGN   4735>>ASSIGN   4737>>ASSIGN   4739>>ASSIGN   4745>>ASSIGN   4746>>ASSIGN   4750>>CALLBLT
      4764>>CALL     4770>>ASSIGN   4771>>ASSIGN   4772>>ASSIGN   4773>>CALLBLT  4842>>ASSIGN   4843>>ASSIGN
      4844>>ASSIGN   4845>>ASSIGN   4846<<ASSIGN   4846>>ASSIGN   4846>>ASSIGN   4859>>ASSIGN   4860>>ASSIGN
      4861>>ASSIGN   4862>>ASSIGN   4863>>ASSIGN   4864>>ASSIGN   4865<<ASSIGN   4865>>ASSIGN   4865>>ASSIGN
      4870>>ASSIGN   4871>>ASSIGN   4872>>ASSIGN   4873>>ASSIGN   4885<<ASSIGN   4885>>ASSIGN   4885>>ASSIGN
      4886>>ASSIGN   4887>>ASSIGN   4888>>ASSIGN   4889>>ASSIGN   4890>>ASSIGN   4891>>ASSIGN   4907<<ASSIGN
      4907>>ASSIGN   4907>>ASSIGN   4908>>ASSIGN   4909>>ASSIGN   4910>>ASSIGN   4911>>ASSIGN   4921>>ASSIGN
      4922>>ASSIGN   4923>>ASSIGN   4942>>ASSIGN   4943>>ASSIGN   4953>>ASSIGN   4954>>CALLBLT  4955>>ASSIGN
      4970>>ASSIGN   4971>>ASSIGN   4979>>ASSIGN   4980>>ASSIGN   4981>>ASSIGN   4992>>CALLBLT  4995>>CALLBLT
      4998>>IF       5009>>CALLBLT  5012>>IF       5012>>IF       5012>>IF       5019>>ASSIGN   5019>>ASSIGN
      5022>>ASSIGN   5023>>ASSIGN   5024>>ASSIGN   5027>>ASSIGN   5028>>ASSIGN   5032>>CALLBLT  5037>>CALLBLT
      5040>>IF       5040>>IF       5050>>ASSIGN   5050>>ASSIGN   5053>>ASSIGN   5054>>ASSIGN   5055>>ASSIGN
      5057>>ASSIGN   5058>>ASSIGN   5059>>ASSIGN   5062>>ASSIGN   5063>>ASSIGN   5064>>ASSIGN   5069>>ASSIGN
      5070>>ASSIGN   5071>>ASSIGN   5076>>ASSIGN   5078>>ASSIGN   5080>>ASSIGN   5082>>ASSIGN   5084>>ASSIGN
      5086>>ASSIGN   5088>>ASSIGN   5090>>ASSIGN   5092>>ASSIGN   5093>>ASSIGN   5097>>ASSIGN   5099>>ASSIGN
      5101>>ASSIGN   5103>>ASSIGN   5105>>ASSIGN   5106>>ASSIGN   5111>>ASSIGN   5113<<ASSIGN   5113>>ASSIGN
      5113>>ASSIGN   5114>>ASSIGN   5118>>ASSIGN   5119>>ASSIGN   5120>>ASSIGN   5121>>CALLBLT  5124>>ASSIGN
      5125>>ASSIGN   5126>>ASSIGN   5127>>CALLBLT  5130<<ASSIGN   5130>>ASSIGN   5130>>ASSIGN   5131>>ASSIGN
CMD_BASE$
      4165**DCL      4683>>ASSIGN   4700>>IF       4779>>IF       4779>>IF       4829>>IF       4875>>IF
CONFIG$
      4166**DCL      4680>>ASSIGN   4838>>IF       4839>>ASSIGN   4845>>ASSIGN   4858>>IF       4862>>ASSIGN
      4863>>ASSIGN   4864>>ASSIGN   4884>>IF       4889>>ASSIGN   4890>>ASSIGN   4891>>ASSIGN   4903>>IF
      4904>>ASSIGN   4911>>ASSIGN   4962>>ASSIGN   4969>>IF       5283>>ASSIGN   5326>>IF       5335>>ASSIGN
      5341>>IF       5342>>IF       5343>>IF       5346>>ASSIGN
CONFIG_ERR
      5137**LABEL    4834--CALLALT  4835--CALLALT  4836--CALLALT  4854--CALLALT  4855--CALLALT  4856--CALLALT
      4880--CALLALT  4881--CALLALT  4882--CALLALT  4899--CALLALT  4900--CALLALT  4901--CALLALT  4960--CALLALT
      4961--CALLALT  4967--CALLALT  4972--CALLALT  4977--CALLALT
CONFIG_ERR IN PROCEDURE PATH_2_NAME
      5356**LABEL    5279--CALLALT  5280--CALLALT  5281--CALLALT  5318--CALLALT  5319--CALLALT  5320--CALLALT
CONFIG_FILE
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:121  
      4447**DCL      4290--DCLINIT
CONFIG_KEY
      4186**DCL      4399--DCLINIT  4400--DCLINIT
CONFIG_KEY.COUNT
      4187**DCL      4831<<ASSIGN   4851<<ASSIGN   4877<<ASSIGN   4896<<ASSIGN   4958<<ASSIGN   4964<<ASSIGN
      5275<<ASSIGN   5315<<ASSIGN
CONFIG_KEY.TEXT
      4188**DCL      4832<<ASSIGN   4852<<ASSIGN   4878<<ASSIGN   4897<<ASSIGN   4959<<ASSIGN   4965<<ASSIGN
      4966<<CALLBLT  5276<<ASSIGN   5277<<CALLBLT  5316<<ASSIGN
FEPNAME
      4175**DCL      4939<<ASSIGN   4940<<CALLBLT  4948<<ASSIGN   4950>>DOWHILE  4954>>CALLBLT  4969>>IF
      5108<<ASSIGN   5110<<CALLBLT  5111>>ASSIGN
FEP_FOUND
      5130**LABEL    4973--GOTO
I
      4170**DCL      4705<<DOINDEX  4706>>ASSIGN   5268<<CALLBLT  5270>>IF       5283>>ASSIGN   5323<<CALLBLT
      5326>>IF       5335>>ASSIGN   5343>>IF
J
      4171**DCL      4784<<DOINDEX  4785>>DOCASE   4841<<DOINDEX  4845>>ASSIGN   4857<<DOINDEX  4858>>IF
      4862>>ASSIGN   4863>>ASSIGN   4864>>ASSIGN   4883<<DOINDEX  4884>>IF       4889>>ASSIGN   4890>>ASSIGN
      4891>>ASSIGN   4906<<DOINDEX  4911>>ASSIGN   4949<<ASSIGN   4950>>DOWHILE  4951<<ASSIGN   4951>>ASSIGN
      4953>>ASSIGN   4963<<DOINDEX  4966>>CALLBLT  4970>>ASSIGN   5067<<DOINDEX  5068>>ASSIGN   5339<<CALLBLT
      5342>>IF
K
      4172**DCL      4839<<ASSIGN   4841>>DOINDEX  4904<<ASSIGN   4906>>DOINDEX  4968<<DOINDEX  4969>>IF
      4971>>ASSIGN   5340<<DOINDEX  5341>>IF       5342>>IF       5343>>IF       5345<<ASSIGN   5345>>ASSIGN
      5346>>ASSIGN
M$CLOSE
       187**DCL-ENT  4836--CALL     4856--CALL     4882--CALL     4901--CALL     4972--CALL     4977--CALL
      5139--CALL     5281--CALL     5320--CALL     5358--CALL
M$OPEN
       187**DCL-ENT  4834--CALL     4854--CALL     4880--CALL     4899--CALL     4960--CALL     5279--CALL
      5318--CALL
M$READ
       188**DCL-ENT  4835--CALL     4855--CALL     4881--CALL     4900--CALL     4961--CALL     4967--CALL
      5280--CALL     5319--CALL
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:122  
MNEM IN PROCEDURE PATH_2_NAME
      5203**DCL      5209<<ASSIGN   5211<<ASSIGN   5213<<ASSIGN   5215<<ASSIGN   5218<<ASSIGN   5222<<ASSIGN
      5224<<ASSIGN   5226<<ASSIGN   5228<<ASSIGN   5230<<ASSIGN   5232<<ASSIGN   5234<<ASSIGN   5236<<ASSIGN
      5239>>IF       5239>>IF       5239>>IF       5285>>IF       5285>>IF       5285>>IF       5285>>IF
      5285>>IF       5285>>IF       5285>>IF       5285>>IF       5285>>IF       5285>>IF       5285>>IF
      5285>>IF       5285>>IF       5304>>ASSIGN   5313>>IF       5313>>IF       5322>>IF       5322>>IF
      5322>>IF       5344>>IF       5347>>IF
MPCNAME
      4180**DCL      4181--REDEF    4825<>CALL     4832>>ASSIGN   4852>>ASSIGN   4873>>ASSIGN   4878>>ASSIGN
      4897>>ASSIGN
MPC_CHANS
      4178**DCL      4776<<ASSIGN   4789<<ASSIGN   4791<<ASSIGN   4850>>IF       4876>>IF
MPC_DEVS
      4179**DCL      4777<<ASSIGN   4787<<ASSIGN   4830>>IF       4895>>IF
NAME.MNEM
      4182**DCL      4802<<ASSIGN   4804<<ASSIGN   4806<<ASSIGN   4808<<ASSIGN
NAME.NUM
      4183**DCL      4821<<ASSIGN
NAME.TWSN
      4184**DCL      4822<<ASSIGN
NAME IN PROCEDURE PATH_2_NAME
      5198**DCL      5149--PROC     5283<<ASSIGN   5285>>IF       5285>>IF       5285>>IF       5285>>IF
      5285>>IF       5285>>IF       5316>>ASSIGN   5335<<ASSIGN   5346<<ASSIGN   5347>>IF
NUMIOMS
      4174**DCL      4962<<ASSIGN   4963>>DOINDEX
O$BLK
      4595**DCL      4764<>CALL     4825<>CALL     4946<>CALL
O$BLK.CODE
      4603**DCL      4684>>ASSIGN   4689>>IF       4701>>ASSIGN   4707>>IF       4707>>IF       4711>>DOCASE
      4719>>DOCASE   4722>>DOCASE   4785>>DOCASE   4796>>DOCASE   4799>>DOCASE   4926>>DOCASE   5072>>DOCASE
      5074>>DOCASE   5095>>DOCASE   5207>>DOCASE   5220>>DOCASE
O$BLK.NSUBLKS
      4607**DCL      4688>>IF       4705>>DOINDEX  4778>>IF       4784>>DOINDEX  5008>>IF       5026>>IF
      5036>>IF       5067>>DOINDEX
O$BLK.SUBLK$
      4628**DCL      4701>>ASSIGN   4706>>ASSIGN   4708>>ASSIGN   4718>>ASSIGN   4722>>DOCASE   4742>>ASSIGN
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:123  
      4769>>ASSIGN   4785>>DOCASE   4795>>ASSIGN   4799>>DOCASE   4811>>ASSIGN   4925>>ASSIGN   4929>>ASSIGN
      4983>>IF       4992>>CALLBLT  4992>>CALLBLT  4995>>CALLBLT  4995>>CALLBLT  4995>>CALLBLT  5009>>CALLBLT
      5009>>CALLBLT  5009>>CALLBLT  5032>>CALLBLT  5032>>CALLBLT  5032>>CALLBLT  5037>>CALLBLT  5037>>CALLBLT
      5037>>CALLBLT  5068>>ASSIGN   5074>>DOCASE   5074>>DOCASE   5092>>ASSIGN   5092>>ASSIGN   5092>>ASSIGN
      5092>>ASSIGN   5095>>DOCASE   5095>>DOCASE   5105>>ASSIGN   5105>>ASSIGN   5105>>ASSIGN   5105>>ASSIGN
      5109>>ASSIGN   5109>>ASSIGN   5117>>ASSIGN   5123>>ASSIGN
O$SYM.COUNT
      4665**DCL      4668--IMP-SIZ  4744>>IF       4745>>ASSIGN   4749>>IF       4750>>CALLBLT  4773>>CALLBLT
      4812>>IF       4821>>ASSIGN   4930>>IF       4940>>CALLBLT  4940>>CALLBLT  4940>>CALLBLT  4941>>CALLBLT
      4941>>CALLBLT  4943>>ASSIGN   4983>>IF       4992>>CALLBLT  4995>>CALLBLT  4995>>CALLBLT  5009>>CALLBLT
      5009>>CALLBLT  5032>>CALLBLT  5032>>CALLBLT  5037>>CALLBLT  5037>>CALLBLT  5092>>ASSIGN   5105>>ASSIGN
      5110>>CALLBLT  5110>>CALLBLT  5110>>CALLBLT  5121>>CALLBLT  5127>>CALLBLT  5263>>IF       5268>>CALLBLT
      5268>>CALLBLT  5277>>CALLBLT  5300>>ASSIGN   5301>>ASSIGN   5302>>ASSIGN   5323>>CALLBLT  5323>>CALLBLT
      5339>>CALLBLT
O$SYM.TEXT
      4668**DCL      4745>>ASSIGN   4750>>CALLBLT  4773>>CALLBLT  4821>>ASSIGN   4940>>CALLBLT  4941>>CALLBLT
      4992>>CALLBLT  4995>>CALLBLT  5009>>CALLBLT  5032>>CALLBLT  5037>>CALLBLT  5092>>ASSIGN   5105>>ASSIGN
      5110>>CALLBLT  5121>>CALLBLT  5127>>CALLBLT  5268>>CALLBLT  5277>>CALLBLT  5300>>ASSIGN   5302>>ASSIGN
      5323>>CALLBLT  5339>>CALLBLT
OPEN_CONFIG
      4289**DCL      4834<>CALL     4854<>CALL     4880<>CALL     4899<>CALL     4960<>CALL     5279<>CALL
      5318<>CALL
OPEN_CONFIG.ACSVEH_
      4291**DCL      4292--REDEF
OPEN_CONFIG.ALTKEYS_
      4297**DCL      4298--REDEF    4298--REDEF
OPEN_CONFIG.HDR_
      4296**DCL      4297--REDEF
OPEN_CONFIG.TAB_
      4295**DCL      4296--REDEF
OPEN_CONFIG.UHL_
      4289**DCL      4290--REDEF    4290--REDEF
OPEN_CONFIG.V
      4298**DCL      4289--DCLINIT
OPEN_CONFIG.V.FSN#
      4329**DCL      4329--REDEF    4329--REDEF
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:124  
OPEN_CONFIG.WSN_
      4295**DCL      4295--REDEF
O_BLK IN PROCEDURE PATH_2_NAME
      5159**DCL      5149--PROC
O_BLK.NSUBLKS IN PROCEDURE PATH_2_NAME
      5171**DCL      5240>>IF       5252>>IF
O_BLK.SUBLK$ IN PROCEDURE PATH_2_NAME
      5192**DCL      5207>>DOCASE   5220>>DOCASE   5263>>IF       5268>>CALLBLT  5268>>CALLBLT  5268>>CALLBLT
      5277>>CALLBLT  5277>>CALLBLT  5300>>ASSIGN   5300>>ASSIGN   5301>>ASSIGN   5302>>ASSIGN   5302>>ASSIGN
      5323>>CALLBLT  5323>>CALLBLT  5323>>CALLBLT  5339>>CALLBLT  5339>>CALLBLT
PAGEDONE
      5039**LABEL    5029--GOTO
PATH_2_NAME
      5149**PROC     4764--CALL     4825--CALL     4946--CALL
PCB
      3976**DCL         8--PROC
PCB.OUT$
      3989**DCL      4684>>ASSIGN   4688>>IF       4689>>IF       4701>>ASSIGN   4705>>DOINDEX  4706>>ASSIGN
      4707>>IF       4707>>IF
PTR$
      4168**DCL      5068<<ASSIGN   5072>>DOCASE   5074>>DOCASE   5092>>ASSIGN   5092>>ASSIGN   5095>>DOCASE
      5105>>ASSIGN   5105>>ASSIGN   5109<<ASSIGN   5109>>ASSIGN   5110>>CALLBLT  5110>>CALLBLT  5110>>CALLBLT
      5110>>CALLBLT
READ_CONFIG
      4399**DCL      4835<>CALL     4855<>CALL     4881<>CALL     4900<>CALL     4961<>CALL     4967<>CALL
      5280<>CALL     5319<>CALL
READ_CONFIG.BUF_.BOUND
      4401**DCL      4681<<ASSIGN
READ_CONFIG.BUF_.BUF$
      4402**DCL      4680<<ASSIGN
READ_CONFIG.STATION_
      4402**DCL      4403--REDEF
READ_CONFIG.V
      4403**DCL      4399--DCLINIT
READ_CONFIG.V.DVBYTE.REREAD#
      4414**DCL      4414--REDEF
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:125  
READ_CONFIG.V.INDX#
      4412**DCL      4412--REDEF
SAVEBLK$
      4167**DCL      4709<<ASSIGN
SUB_BUF_1.COUNT
      4191**DCL      5299<<ASSIGN
SUB_BUF_1.TEXT
      4192**DCL      5300<<ASSIGN
SUB_BUF_2.COUNT
      4194**DCL      5301<<ASSIGN
SUB_BUF_2.TEXT
      4195**DCL      5302<<ASSIGN
SUB_BUF_3.COUNT
      4197**DCL      5303<<ASSIGN
SUB_BUF_3.TEXT
      4198**DCL      4946<>CALL     4948>>ASSIGN   5304<<ASSIGN
SYSACCT
      4461**DCL      4294--DCLINIT
TD$HEAD.NUMIOMS
      4555**DCL      4962>>ASSIGN
TD$IOM.DEVNAME
      4524**DCL      4969>>IF       5283>>ASSIGN
TD$MPC.DEVNAME
      4550**DCL      4845>>ASSIGN   4911>>ASSIGN   5335>>ASSIGN   5346>>ASSIGN
TD$MPC.IOCHAN.HICHAN
      4538**DCL      4864>>ASSIGN   4891>>ASSIGN
TD$MPC.IOCHAN.IOM
      4536**DCL      4862>>ASSIGN   4889>>ASSIGN   5342>>IF
TD$MPC.IOCHAN.LOCHAN
      4537**DCL      4863>>ASSIGN   4890>>ASSIGN   5343>>IF
TD$MPC.IOCHAN.PRESENCE
      4534**DCL      4858>>IF       4884>>IF       5341>>IF
TD$MPC.NUMDEVS
      4539**DCL      4838>>IF       4839>>ASSIGN   4903>>IF       4904>>ASSIGN   5326>>IF
TEMP
      4173**DCL      4941<<CALLBLT  4942>>ASSIGN   4954<<CALLBLT  4955>>ASSIGN
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:126  
TS$CHAN
      4501**DCL      4859<<ASSIGN   4860--ASSIGN   4886<<ASSIGN   4887--ASSIGN   4979<<ASSIGN   4980--ASSIGN
TS$CHAN.CODE
      4503**DCL      4861<<ASSIGN   4888<<ASSIGN   4981<<ASSIGN
TS$CHAN.HICHAN
      4506**DCL      4864<<ASSIGN   4891<<ASSIGN   5009<<CALLBLT  5012>>IF       5012>>IF       5019<<ASSIGN
TS$CHAN.IOM
      4504**DCL      4862<<ASSIGN   4889<<ASSIGN   4992<<CALLBLT
TS$CHAN.LOCHAN
      4505**DCL      4863<<ASSIGN   4890<<ASSIGN   4995<<CALLBLT  4998>>IF       5012>>IF       5019>>ASSIGN
TS$CHAN.SIZE
      4502**DCL      4860<<ASSIGN   4865>>ASSIGN   4885>>ASSIGN   4887<<ASSIGN   4980<<ASSIGN
TS$CMDWD
      4468**DCL      4684<<ASSIGN   4685--ASSIGN   4687<<ASSIGN   4694<<ASSIGN   4700>>IF       4701<<ASSIGN
      4779>>IF       4779>>IF       4829>>IF       4875>>IF       5114<<ASSIGN   5131<<ASSIGN
TS$CPU
      4492**DCL      5118<<ASSIGN   5120--ASSIGN
TS$CPU.CODE
      4494**DCL      5119<<ASSIGN
TS$CPU.CPU
      4495**DCL      5121<<CALLBLT
TS$CPU.SIZE
      4493**DCL      5120<<ASSIGN
TS$DEV
      4470**DCL      4690<<ASSIGN   4691--ASSIGN   4714<<ASSIGN   4715--ASSIGN   4842<<ASSIGN   4843--ASSIGN
      4908<<ASSIGN   4909--ASSIGN   5053<<ASSIGN   5054--ASSIGN   5057<<ASSIGN   5058--ASSIGN   5062<<ASSIGN
      5063--ASSIGN   5069<<ASSIGN   5070--ASSIGN
TS$DEV.CODE
      4472**DCL      4692<<ASSIGN   4716<<ASSIGN   4844<<ASSIGN   4910<<ASSIGN   5055<<ASSIGN   5059<<ASSIGN
      5064<<ASSIGN   5071<<ASSIGN
TS$DEV.DEVNAME
      4473**DCL      4474--REDEF    4750<<CALLBLT  4764<>CALL     4845<<ASSIGN   4911<<ASSIGN   5111<<ASSIGN
TS$DEV.NAME.MNEM
      4475**DCL      4725<<ASSIGN   4727<<ASSIGN   4729<<ASSIGN   4731<<ASSIGN   4733<<ASSIGN   4735<<ASSIGN
      4737<<ASSIGN   4739<<ASSIGN   5076<<ASSIGN   5078<<ASSIGN   5080<<ASSIGN   5082<<ASSIGN   5084<<ASSIGN
      5086<<ASSIGN   5088<<ASSIGN   5090<<ASSIGN   5097<<ASSIGN   5099<<ASSIGN   5101<<ASSIGN   5103<<ASSIGN
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:127  
TS$DEV.NAME.NUM
      4476**DCL      4745<<ASSIGN   5092<<ASSIGN   5105<<ASSIGN
TS$DEV.NAME.TWSN
      4477**DCL      4746<<ASSIGN   5093<<ASSIGN   5106<<ASSIGN
TS$DEV.SIZE
      4471**DCL      4691<<ASSIGN   4693>>ASSIGN   4715<<ASSIGN   4843<<ASSIGN   4846>>ASSIGN   4907>>ASSIGN
      4909<<ASSIGN   5054<<ASSIGN   5058<<ASSIGN   5063<<ASSIGN   5070<<ASSIGN   5113>>ASSIGN   5130>>ASSIGN
TS$FEP
      4508**DCL      4921<<ASSIGN   4922--ASSIGN
TS$FEP.CHAN
      4513**DCL      4971<<ASSIGN
TS$FEP.CODE
      4510**DCL      4923<<ASSIGN
TS$FEP.FEP
      4514**DCL      4942<<ASSIGN   4955<<ASSIGN
TS$FEP.IOM
      4512**DCL      4970<<ASSIGN
TS$FEP.LEN
      4511**DCL      4943<<ASSIGN   4953<<ASSIGN   4954>>CALLBLT
TS$FEP.SIZE
      4509**DCL      4922<<ASSIGN
TS$IOM
      4488**DCL      4770<<ASSIGN   4772--ASSIGN
TS$IOM.CODE
      4490**DCL      4771<<ASSIGN
TS$IOM.IOM
      4491**DCL      4773<<CALLBLT
TS$IOM.SIZE
      4489**DCL      4772<<ASSIGN
TS$MPC
      4479**DCL      4870<<ASSIGN   4871--ASSIGN
TS$MPC.CODE
      4481**DCL      4872<<ASSIGN
TS$MPC.MPCNAME
      4482**DCL      4483--REDEF    4873<<ASSIGN
TS$MPC.SIZE
PL6.E3A0      #001=TSC$CHECK File=TSC$CHECK.:E05TSI                              WED 07/30/97 06:52 Page:128  
      4480**DCL      4871<<ASSIGN
TS$PAGES
      4516**DCL      5022<<ASSIGN   5023--ASSIGN
TS$PAGES.CODE
      4518**DCL      5024<<ASSIGN
TS$PAGES.HIPAGE
      4520**DCL      5028<<ASSIGN   5037<<CALLBLT  5040>>IF       5050<<ASSIGN
TS$PAGES.LOPAGE
      4519**DCL      5027<<ASSIGN   5032<<CALLBLT  5040>>IF       5050>>ASSIGN
TS$PAGES.SIZE
      4517**DCL      5023<<ASSIGN
TS$SCU
      4496**DCL      5124<<ASSIGN   5126--ASSIGN
TS$SCU.CODE
      4498**DCL      5125<<ASSIGN
TS$SCU.SCU
      4499**DCL      5127<<CALLBLT
TS$SCU.SIZE
      4497**DCL      5126<<ASSIGN
TSE$ERROR
      4203**DCL-ENT  4754--CALL     4781--CALL     4813--CALL     4931--CALL     4984--CALL     4999--CALL
      5014--CALL     5041--CALL     5137--CALL     5138--CALL     5241--CALL     5253--CALL     5264--CALL
      5271--CALL     5305--CALL     5327--CALL     5356--CALL     5357--CALL
TS_DIPART
      4176**DCL      4679<<ASSIGN   5065<<ASSIGN
TS_DIREL
      4177**DCL      5060<<ASSIGN
TYPE IN PROCEDURE PATH_2_NAME
      5199**DCL      5149--PROC     5207>>IF       5218>>IF       5313>>IF
