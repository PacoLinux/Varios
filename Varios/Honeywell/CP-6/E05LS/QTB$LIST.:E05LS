VERSION E05

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:1    
        1        1        /*M* QTB$LIST - Perform  LIST  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTB$LIST:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QT_DATA_R;
       16      164        %INCLUDE QT_PERR_C;
       17      215        %INCLUDE Q_ERRCODE_C;
       18      238        %INCLUDE QT_MACROS_C;
       19      396        %INCLUDE QT_SUBS_C;
       20      480        %INCLUDE XU_MACRO_C;
       21     3586        %PAGE(ARG="Externally defined routines");

              3603    1   /***************************************************************************
              3604    1    *                                                                         *
              3605    1    *                        Externally defined routines                      *
              3606    1    *                                                                         *
              3607    1    ***************************************************************************/

       22     3611    1   DCL QQC$CONVERT_NUM ENTRY(3);
       23     3612    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:2    
       24     3613    1   DCL QTC$READ_TRADER ENTRY(3) ALTRET;
       25     3614    1   DCL QTC$MON_ERR ENTRY(1);
       26     3615        %PAGE(ARG="DCBs");

              3632    1   /***************************************************************************
              3633    1    *                                                                         *
              3634    1    *                                    DCBs                                 *
              3635    1    *                                                                         *
              3636    1    ***************************************************************************/

       27     3640    1   DCL M$LO DCB;
       28     3641        %PAGE(ARG="Based");

              3658    1   /***************************************************************************
              3659    1    *                                                                         *
              3660    1    *                                   Based                                 *
              3661    1    *                                                                         *
              3662    1    ***************************************************************************/

       29     3666        %QT$ENTRY;
       30     3720        %QT$FORM;
       31     3759        %QT$SETTEXT;
       32     3769        %F$DCB;
       33     3826        %PARSE$SYM(STCLASS=BASED);
       34     3864        %PARSE$OUT(STCLASS=BASED);
       35     3909
       36     3910    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       37     3911        %PAGE(ARG="Static");

              3928    1   /***************************************************************************
              3929    1    *                                                                         *
              3930    1    *                                   Static                                *
              3931    1    *                                                                         *
              3932    1    ***************************************************************************/

       38     3936    1   DCL FID CHAR(100) STATIC;
       39     3937    1   DCL DATE CHAR(10) STATIC;
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:3    
       40     3938    1   DCL TIME CHAR(11) STATIC;
       41     3939    1   DCL DAY CHAR(3) STATIC;
       42     3940
       43     3941    1   DCL UTS UBIN WORD STATIC;
       44     3942    1   DCL UNFID_SIZE UBIN WORD STATIC;
       45     3943        %PAGE(ARG="Constant");

              3960    1   /***************************************************************************
              3961    1    *                                                                         *
              3962    1    *                                  Constant                               *
              3963    1    *                                                                         *
              3964    1    ***************************************************************************/

       46     3968        %VLP_CGCP(FPTN=VLP_CGCP_C, STCLASS=CONSTANT);
       47     4011        %VLP_CGTYPL(FPTN=VLP_CGTYPL_C, STCLASS=CONSTANT);
       48     4036        %QT$ENTRY(FPTN=QT_ENTRY_C, STCLASS=CONSTANT);
       49     4090
       50     4091    1   DCL ENTRY_HDR_C CHAR(0) CONSTANT INIT(
              4091            'A  NAME     LAST MODIFIED  PRIO MXACT   LOCK MSG  DEBUGGER   JOURNAL');
       51     4092    1   DCL FORM_HDR_C CHAR(0) CONSTANT INIT('A  NAME     LAST MODIFIED  JOURNAL ONEREPORT')
              4092            ;
       52     4093        %PAGE(ARG="Auto");

              4110    1   /***************************************************************************
              4111    1    *                                                                         *
              4112    1    *                                    Auto                                 *
              4113    1    *                                                                         *
              4114    1    ***************************************************************************/

       53     4118    1   DCL MSGTYP CHAR(8);
       54     4119    1   DCL FOUND_MSGTYP CHAR(8);
       55     4120
       56     4121    1   DCL HEADING_FLAG BIT(1) ALIGNED;
       57     4122    1   DCL WILD_FLAG BIT(1) ALIGNED;
       58     4123    1   DCL ATTRIBUTES_FLAG BIT(1) ALIGNED;
       59     4124
       60     4125    1   DCL BYTE_COUNT SBIN WORD;
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:4    
       61     4126    1   DCL CHAR_STRING_SIZE SBIN WORD;
       62     4127    1   DCL NSUBLKS SBIN WORD;
       63     4128    1   DCL NAMES_LISTED SBIN WORD;
       64     4129    1   DCL I SBIN WORD;
       65     4130    1   DCL PAGE_WIDTH SBIN WORD;
       66     4131    1   DCL POS SBIN WORD;
       67     4132    1   DCL TYPE SBIN WORD;
       68     4133    1   DCL NUM SBIN WORD;
       69     4134    1   DCL SIZE SBIN WORD;
       70     4135
       71     4136    1   DCL SUBLK$ PTR;
       72     4137    1   DCL REC$ PTR;
       73     4138
       74     4139    1   DCL OUTPUT_LINE CHAR(131);
       75     4140        %VLP_NAME(FPTN=TEXTC_NUM, LEN=9, NAME=' ');
       76     4167        %VLP_NAME(FPTN=TEXTC_MSGTYP, LEN=8, NAME=' ');
       77     4194
       78     4195    1   DCL 1 ENTRY_INFO,
       79     4196    1         2 VFC CHAR(1),
       80     4197    1         2 NAME CHAR(8),
       81     4198    1         2 * CHAR(1),
       82     4199    1         2 TIME CHAR(5),
       83     4200    1         2 * CHAR(1),
       84     4201    1         2 DATE CHAR(10),
       85     4202    1         2 * CHAR(2),
       86     4203    1         2 PRIO CHAR(3),
       87     4204    1         2 * CHAR(1),
       88     4205    1         2 MXACT CHAR(7),
       89     4206    1         2 * CHAR(1),
       90     4207    1         2 LOCK CHAR(3),
       91     4208    1         2 * CHAR(2),
       92     4209    1         2 MSG CHAR(3),
       93     4210    1         2 * CHAR(1),
       94     4211    1         2 DEBUGGER CHAR(11),
       95     4212    1         2 * CHAR(2),
       96     4213    1         2 JOURNAL CHAR(3);
       97     4214    1   DCL 1 ENTRY_INFO_TEXT REDEF ENTRY_INFO CHAR(65);
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:5    
       98     4215
       99     4216    1   DCL 1 FORM_INFO,
      100     4217    1         2 VFC CHAR(1),
      101     4218    1         2 NAME CHAR(8),
      102     4219    1         2 * CHAR(1),
      103     4220    1         2 TIME CHAR(5),
      104     4221    1         2 * CHAR(1),
      105     4222    1         2 DATE CHAR(10),
      106     4223    1         2 * CHAR(2),
      107     4224    1         2 JOURNAL CHAR(3),
      108     4225    1         2 * CHAR(7),
      109     4226    1         2 ONEREPORT CHAR(3);
      110     4227    1   DCL 1 FORM_INFO_TEXT REDEF FORM_INFO CHAR(41);
      111     4228        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:6    
              4245    1   /***************************************************************************
              4246    1    *                                                                         *
              4247    1    *                                Error codes                              *
              4248    1    *                                                                         *
              4249    1    ***************************************************************************/

      112     4253        %ERRCODE(NAME=CODE_NLISTED, CODE#=%E$NLISTED, FCG#=%FCG_QT, MID#=%MID_B);
      113     4260        %ERRCODE(NAME=CODE_NTL, CODE#=%E$NTL, FCG#=%FCG_QT, MID#=%MID_B);
      114     4267        %ERRCODE(NAME=CODE_NFL, CODE#=%E$NFL, FCG#=%FCG_QT, MID#=%MID_B);
      115     4274        /*E*       ERROR: QTB-E$NLISTED-C
      116     4275
      117     4276                 MESSAGE: .. %U1 listed
      118     4277             DESCRIPTION: This is the number of items listed by a LIST
      119     4278                          command.
      120     4279        */
      121     4280        /*E*       ERROR: QTB-E$NTL-C
      122     4281
      123     4282                 MESSAGE: Nothing to list
      124     4283             DESCRIPTION: There was nothing that matched the list
      125     4284                          criteria of the LIST command.
      126     4285        */
      127     4286        /*E*       ERROR: QTB-E$NFL-C
      128     4287
      129     4288                 MESSAGE: Can't list; %U1 was not found
      130     4289             DESCRIPTION: The type specified was not found.
      131     4290        */
      132     4291        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:7    
              4308    1   /***************************************************************************
              4309    1    *                                                                         *
              4310    1    *                                    FPTs                                 *
              4311    1    *                                                                         *
              4312    1    ***************************************************************************/

      133     4316        %FPT_OPEN(ASN=FILE);
      134     4425
      135     4426        %FPT_UNFID(TEXTFID=FID, NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS,
      136     4427        ASN="FPT_OPEN.V.ASN#", SN=VLP_SN, WSN=VLP_WSN,
      137     4428        RES="FPT_OPEN.V.RES#", LEN=UNFID_SIZE);
      138     4446
      139     4447        %FPT_TIME(DEST=EXT, SOURCE=UTS, DATE=DATE,
      140     4448        TIME=TIME, DAY=DAY, TSTAMP=UTS);
      141     4467
      142     4468        %FPT_WRITE(DCB=M$LO, VFC=YES);
      143     4499
      144     4500        %FPT_CORRES;
      145     4514        %PAGE(ARG="VLPs");

              4531    1   /***************************************************************************
              4532    1    *                                                                         *
              4533    1    *                                    VLPs                                 *
              4534    1    *                                                                         *
              4535    1    ***************************************************************************/

      146     4539        %VLP_NAME;
      147     4566        %VLP_ACCT;
      148     4579        %VLP_PASS;
      149     4592        %VLP_SN;
      150     4605        %VLP_WSN;
      151     4618        %PAGE(ARG="QTB$LIST", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:8    
              4635    1   /***************************************************************************
              4636    1    *                                                                         *
              4637    1    *                                  QTB$LIST                               *
              4638    1    *                                                                         *
              4639    1    ***************************************************************************/

      152     4643    1           NAMES_LISTED = 0;
      153     4644    1           BYTE_COUNT = 1;
      154     4645    1           HEADING_FLAG = '1'B;
      155     4646    1           WILD_FLAG = '0'B;
      156     4647    1           ATTRIBUTES_FLAG = '0'B;
      157     4648    1           NSUBLKS = QT_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;
      158     4649    1           FPT_WRITE.BUF_.BUF$ = ADDR(OUTPUT_LINE);
      159     4650    1           OUTPUT_LINE = 'A';
      160     4651
      161     4652    1           FPT_CORRES.V.DCB1# = DCBNUM(M$LO);
      162     4653    1           FPT_CORRES.V.DCB2# = QT_GLOBAL.M$DO#;
      163     4654    1           CALL M$CORRES (FPT_CORRES)
      164     4655    2           WHENRETURN DO;
      165     4656    2               PAGE_WIDTH = DCBADDR(DCBNUM(M$LO)) -> F$DCB.WIDTH#;
      166     4657    2             END;
      167     4658    1           WHENALTRETURN
      168     4659    2             DO;
      169     4660    2               PAGE_WIDTH = DCBADDR(QT_GLOBAL.M$DO#) -> F$DCB.WIDTH#;
      170     4661    2               FPT_WRITE.V.DCB# = QT_GLOBAL.M$DO#;
      171     4662    2             END;
      172     4663    1           IF PAGE_WIDTH = 0 OR PAGE_WIDTH < 20 THEN
      173     4664    2             DO;
      174     4665    2               PAGE_WIDTH = 80;
      175     4666    2             END;
      176     4667
      177     4668    2           DO I = 0 TO NSUBLKS;
      178     4669    2             SUBLK$ = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      179     4670
      180     4671    3             DO CASE(SUBLK$ -> OUT$SYM.CODE);
      181     4672
      182     4673    3               CASE(1 /* OPT_TTYPE */);
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:9    
      183     4674    3                 MSGTYP = SUBLK$ -> OUT$SYM.TEXT;
      184     4675
      185     4676    3               CASE(2 /* OPT_ATTRIBUTES */);
      186     4677    3                 ATTRIBUTES_FLAG = '1'B;
      187     4678
      188     4679    3             END /* CASE */;
      189     4680    2           END /* Do for each sub option */;
      190     4681
      191     4682    1           CALL INDEX(POS, '?', MSGTYP) ALTRET(NO_Q1);
      192     4683    1           WILD_FLAG = '1'B;
      193     4684
      194     4685    2           DO WHILE('0'B);
      195     4686
      196     4687    2   NO_Q1:
      197     4688    2             ATTRIBUTES_FLAG = '1'B;
      198     4689    2           END /* NEVER */;
      199     4690
      200     4691    1           IF QT_CMDBLK.CODE = 10 /* LIST_ENTRY */ THEN
      201     4692    2             DO;
      202     4693    2               TYPE = 1 /* TYPE_E */;
      203     4694    2             END;
      204     4695    1           ELSE
      205     4696    2             DO;
      206     4697    2               TYPE = 2 /* TYPE_F */;
      207     4698    2             END;
      208     4699
      209     4700    2           DO WHILE('1'B);
      210     4701
      211     4702    2             CALL QTC$READ_TRADER(MSGTYP, TYPE, FOUND_MSGTYP) ALTRET(NOT_FOUND);
      212     4703
      213     4704    2             IF ATTRIBUTES_FLAG THEN
      214     4705    3               DO;
      215     4706    4                 DO CASE(TYPE);
      216     4707
      217     4708    4                   CASE(1 /* TYPE_E */);
      218     4709    4                     CALL PRINT_ENTRY;
      219     4710
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:10   
      220     4711    4                   CASE(2 /* TYPE_F */);
      221     4712    4                     CALL PRINT_FORM;
      222     4713
      223     4714    4                 END /* CASE */;
      224     4715    3               END;
      225     4716    2             ELSE
      226     4717    3               DO;
      227     4718    3                 CALL LIST_NAME;
      228     4719    3               END;
      229     4720
      230     4721    2             IF QT_GLOBAL.BREAK THEN
      231     4722    3               DO;
      232     4723    3                 GOTO NOT_FOUND;
      233     4724    3               END;
      234     4725
      235     4726    2           END /* WHILE */;
      236     4727
      237     4728    1   NOT_FOUND:
      238     4729    1           IF NOT ATTRIBUTES_FLAG AND BYTE_COUNT > 1 THEN
      239     4730    2             DO;
      240     4731    2               FPT_WRITE.BUF_.BOUND = BYTE_COUNT - 1;
      241     4732    2               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      242     4733    2             END;
      243     4734
      244     4735    1           IF NAMES_LISTED > 0 THEN
      245     4736    2             DO;
      246     4737    2               CALL QQC$CONVERT_NUM(NAMES_LISTED, SIZE, ADDR(TEXTC_NUM.NAME#));
      247     4738    2               TEXTC_NUM.L# = SIZE;
      248     4739    2               CALL XUR$ERRMSG(CODE_NLISTED, , , VECTOR(TEXTC_NUM));
      249     4740    2             END;
      250     4741
      251     4742    1           IF NAMES_LISTED = 0 AND WILD_FLAG THEN
      252     4743    2             DO;
      253     4744    2               QT_CMDBLK.MINOR_ERR = CODE_NTL;
      254     4745    2               CALL XUR$ERRMSG(CODE_NTL);
      255     4746    2             END;
      256     4747
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:11   
      257     4748    1           IF NAMES_LISTED = 0 AND NOT WILD_FLAG THEN
      258     4749    2             DO;
      259     4750    2               TEXTC_MSGTYP.NAME# = MSGTYP;
      260     4751    2               QT_CMDBLK.MINOR_ERR = CODE_NFL;
      261     4752    2               TEXTC_MSGTYP.L# = 8;
      262     4753    2               CALL XUR$ERRMSG(CODE_NFL, , , VECTOR(TEXTC_MSGTYP));
      263     4754    2             END;
      264     4755
      265     4756    1           RETURN;
      266     4757
      267     4758    1   MON_ERR:
      268     4759    1           CALL QTC$MON_ERR('1'B);
      269     4760                %PAGE(ARG="LIST_NAME", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:12   
              4777    1   /***************************************************************************
              4778    1    *                                                                         *
              4779    1    *                                 LIST_NAME                               *
              4780    1    *                                                                         *
              4781    1    ***************************************************************************/

      270     4785    1   LIST_NAME:
      271     4786    1           PROC;
      272     4787
      273     4788    2           NAMES_LISTED = NAMES_LISTED + 1;
      274     4789    2           CHAR_STRING_SIZE = 8;
      275     4790
      276     4791    2           IF BYTE_COUNT + 8 > PAGE_WIDTH THEN
      277     4792    3             DO;
      278     4793    3               FPT_WRITE.BUF_.BOUND = BYTE_COUNT - 1;
      279     4794    3               BYTE_COUNT = 1;
      280     4795    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      281     4796    3               OUTPUT_LINE = 'A';
      282     4797    3             END;
      283     4798
      284     4799    2           PINCRC(ADDR(OUTPUT_LINE), BYTE_COUNT) -> CHAR$STRING = FOUND_MSGTYP;
      285     4800
      286     4801    2           BYTE_COUNT = BYTE_COUNT + 8;
      287     4802
      288     4803    2           IF BYTE_COUNT + 2 <= PAGE_WIDTH THEN
      289     4804    3             DO;
      290     4805    3               BYTE_COUNT = BYTE_COUNT + 2;
      291     4806    3             END;
      292     4807    2           ELSE
      293     4808    3             DO;
      294     4809    3               BYTE_COUNT = PAGE_WIDTH;
      295     4810    3             END;
      296     4811
      297     4812    2           RETURN;
      298     4813
      299     4814    2   MON_ERR:
      300     4815    2           CALL QTC$MON_ERR('1'B);
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:13   
      301     4816
      302     4817    2   END LIST_NAME;
      303     4818                %PAGE(ARG="PRINT_ENTRY", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:14   
              4835    2   /***************************************************************************
              4836    2    *                                                                         *
              4837    2    *                                PRINT_ENTRY                              *
              4838    2    *                                                                         *
              4839    2    ***************************************************************************/

      304     4843    1   PRINT_ENTRY:
      305     4844    1           PROC;
      306     4845
      307     4846    2           IF HEADING_FLAG THEN
      308     4847    3             DO;
      309     4848    3               HEADING_FLAG = '0'B;
      310     4849    3               OUTPUT_LINE = ENTRY_HDR_C;
      311     4850    3               FPT_WRITE.BUF_.BOUND = SIZEC(ENTRY_HDR_C) - 1;
      312     4851    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      313     4852    3             END;
      314     4853
      315     4854    2           NAMES_LISTED = NAMES_LISTED + 1;
      316     4855    2           ENTRY_INFO_TEXT = 'A';
      317     4856
      318     4857    2           ENTRY_INFO.NAME = FOUND_MSGTYP;
      319     4858
      320     4859    2           UTS = QT$ENTRY.UTS;
      321     4860    2           CALL M$TIME(FPT_TIME);
      322     4861    2           ENTRY_INFO.TIME = SUBSTR(TIME, 0, 5);
      323     4862    2           ENTRY_INFO.DATE = DATE;
      324     4863
      325     4864    2           NUM = QT$ENTRY.PRIO;
      326     4865    2           CALL QQC$CONVERT_NUM(NUM, SIZE, ADDR(ENTRY_INFO.PRIO));
      327     4866
      328     4867    2           NUM = QT$ENTRY.MAXACTIVE;
      329     4868    2           CALL QQC$CONVERT_NUM(NUM, SIZE, ADDR(ENTRY_INFO.MXACT));
      330     4869
      331     4870    2           IF QT$ENTRY.FLAGS.NEW_LOCK THEN
      332     4871    3             DO;
      333     4872    3               ENTRY_INFO.LOCK = 'ON';
      334     4873    3             END;
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:15   
      335     4874    2           ELSE
      336     4875    3             DO;
      337     4876    3               ENTRY_INFO.LOCK = 'OFF';
      338     4877    3             END;
      339     4878
      340     4879    2           IF QT$ENTRY.FLAGS.MESSAGE THEN
      341     4880    3             DO;
      342     4881    3               ENTRY_INFO.MSG = 'ON';
      343     4882    3             END;
      344     4883    2           ELSE
      345     4884    3             DO;
      346     4885    3               ENTRY_INFO.MSG = 'OFF';
      347     4886    3             END;
      348     4887
      349     4888    2           ENTRY_INFO.DEBUGGER = QT$ENTRY.DEBUGGER.TEXT;
      350     4889
      351     4890    2           IF QT$ENTRY.FLAGS.JOURNAL THEN
      352     4891    3             DO;
      353     4892    3               ENTRY_INFO.JOURNAL = 'ON';
      354     4893    3             END;
      355     4894    2           ELSE
      356     4895    3             DO;
      357     4896    3               ENTRY_INFO.JOURNAL = 'OFF';
      358     4897    3             END;
      359     4898
      360     4899    2           OUTPUT_LINE = ENTRY_INFO_TEXT;
      361     4900    2           FPT_WRITE.BUF_.BOUND = SIZEC(ENTRY_INFO_TEXT) - 1;
      362     4901    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      363     4902
      364     4903    2           VLP_NAME = QT$ENTRY.TPAP.NAME;
      365     4904    2           VLP_ACCT.ACCT# = QT$ENTRY.TPAP.ACCT;
      366     4905    2           VLP_PASS.PASS# = QT$ENTRY.TPAP.PASS;
      367     4906    2           VLP_SN.SN#(0) = QT$ENTRY.TPAP.SN;
      368     4907    2           CALL M$UNFID(FPT_UNFID) ALTRET(MON_ERR);
      369     4908
      370     4909    2           OUTPUT_LINE = 'A  TPAP=';
      371     4910    2           CHAR_STRING_SIZE = UNFID_SIZE;
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:16   
      372     4911    2           PINCRC(ADDR(OUTPUT_LINE), 8) -> CHAR$STRING = FID;
      373     4912
      374     4913    2           FPT_WRITE.BUF_.BOUND = UNFID_SIZE + 7;
      375     4914    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      376     4915
      377     4916    2           I = 1;
      378     4917    2           REC$ = QT_GLOBAL.QT$SETTEXT$;
      379     4918
      380     4919    3           DO WHILE(I <= QT$ENTRY.SET_COUNT AND NOT QT_GLOBAL.BREAK);
      381     4920    3             OUTPUT_LINE = 'A';
      382     4921    3             CHAR_STRING_SIZE = REC$ -> QT$SETTEXT.COUNT;
      383     4922    3             PINCRC(ADDR(OUTPUT_LINE), 5) -> CHAR$STRING =
      384     4923    3                 REC$ -> QT$SETTEXT.TEXT;
      385     4924
      386     4925    3             FPT_WRITE.BUF_.BOUND = CHAR_STRING_SIZE + 4;
      387     4926    3             CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      388     4927
      389     4928    3             REC$ = PINCRW(REC$, SIZEW(REC$ -> QT$SETTEXT));
      390     4929    3             I = I + 1;
      391     4930    3           END;
      392     4931
      393     4932    2           RETURN;
      394     4933
      395     4934    2   MON_ERR:
      396     4935    2           CALL QTC$MON_ERR('1'B);
      397     4936
      398     4937    2   END PRINT_ENTRY;
      399     4938                %PAGE(ARG="PRINT_FORM", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:17   
              4955    2   /***************************************************************************
              4956    2    *                                                                         *
              4957    2    *                                 PRINT_FORM                              *
              4958    2    *                                                                         *
              4959    2    ***************************************************************************/

      400     4963    1   PRINT_FORM:
      401     4964    1           PROC;
      402     4965
      403     4966    2           IF HEADING_FLAG THEN
      404     4967    3             DO;
      405     4968    3               HEADING_FLAG = '0'B;
      406     4969    3               OUTPUT_LINE = FORM_HDR_C;
      407     4970    3               FPT_WRITE.BUF_.BOUND = SIZEC(FORM_HDR_C) - 1;
      408     4971    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      409     4972    3             END;
      410     4973
      411     4974    2           NAMES_LISTED = NAMES_LISTED + 1;
      412     4975    2           FORM_INFO_TEXT = 'A';
      413     4976
      414     4977    2           FORM_INFO.NAME = FOUND_MSGTYP;
      415     4978
      416     4979    2           UTS = QT$FORM.UTS;
      417     4980    2           CALL M$TIME(FPT_TIME);
      418     4981    2           FORM_INFO.TIME = SUBSTR(TIME, 0, 5);
      419     4982    2           FORM_INFO.DATE = DATE;
      420     4983
      421     4984    2           IF QT$FORM.FLAGS.JOURNAL THEN
      422     4985    3             DO;
      423     4986    3               FORM_INFO.JOURNAL = 'ON';
      424     4987    3             END;
      425     4988    2           ELSE
      426     4989    3             DO;
      427     4990    3               FORM_INFO.JOURNAL = 'OFF';
      428     4991    3             END;
      429     4992
      430     4993    2           IF QT$FORM.FLAGS.ONEREPORT THEN
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:18   
      431     4994    3             DO;
      432     4995    3               FORM_INFO.ONEREPORT = 'ON';
      433     4996    3             END;
      434     4997    2           ELSE
      435     4998    3             DO;
      436     4999    3               FORM_INFO.ONEREPORT = 'OFF';
      437     5000    3             END;
      438     5001
      439     5002    2           OUTPUT_LINE = FORM_INFO_TEXT;
      440     5003    2           FPT_WRITE.BUF_.BOUND = SIZEC(FORM_INFO_TEXT) - 1;
      441     5004    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      442     5005
      443     5006    2           VLP_NAME = QT$FORM.FP.NAME;
      444     5007    2           VLP_ACCT.ACCT# = QT$FORM.FP.ACCT;
      445     5008    2           VLP_PASS.PASS# = QT$FORM.FP.PASS;
      446     5009    2           VLP_SN.SN#(0) = QT$FORM.FP.SN;
      447     5010    2           CALL M$UNFID(FPT_UNFID) ALTRET(MON_ERR);
      448     5011
      449     5012    2           OUTPUT_LINE = 'A  FP=';
      450     5013    2           CHAR_STRING_SIZE = UNFID_SIZE;
      451     5014    2           PINCRC(ADDR(OUTPUT_LINE), 6) -> CHAR$STRING = FID;
      452     5015
      453     5016    2           FPT_WRITE.BUF_.BOUND = UNFID_SIZE + 5;
      454     5017    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      455     5018
      456     5019    2           RETURN;
      457     5020
      458     5021    2   MON_ERR:
      459     5022    2           CALL QTC$MON_ERR('1'B);
      460     5023
      461     5024    2   END PRINT_FORM;
      462     5025    1   END QTB$LIST;

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:19   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QT_PERR_C.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTB$LIST.

   Procedure QTB$LIST requires 564 words for executable code.
   Procedure QTB$LIST requires 90 words of local(AUTO) storage.

    No errors detected in file QTB$LIST.:E05TSI    .

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:20   

 Object Unit name= QTB$LIST                                   File name= QTB$LIST.:E05TOU
 UTS= JUL 30 '97 05:48:00.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none   166    246  QTB$LIST
    3  RoData even  UTS     91    133  QTB$LIST
    4   Proc  even  none   564   1064  QTB$LIST
    5  RoData even  none    17     21  QTB$LIST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  QTB$LIST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 QTC$READ_TRADER
         yes           Std       1 QTC$MON_ERR
         yes           Std       3 QQC$CONVERT_NUM
 yes     yes           Std       7 XUR$ERRMSG
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:21   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QT_GLOBAL                             QT_CMDBLK
     M$LO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:22   


        1        1        /*M* QTB$LIST - Perform  LIST  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTB$LIST:
        9        9                PROC;

      9  4 000000   000000 700200 xent  QTB$LIST     TSX0  ! X66_AUTO_0
         4 000001   000132 000000                    ZERO    90,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QT_DATA_R;
       16      164        %INCLUDE QT_PERR_C;
       17      215        %INCLUDE Q_ERRCODE_C;
       18      238        %INCLUDE QT_MACROS_C;
       19      396        %INCLUDE QT_SUBS_C;
       20      480        %INCLUDE XU_MACRO_C;
       21     3586        %PAGE(ARG="Externally defined routines");

              3603    1   /***************************************************************************
              3604    1    *                                                                         *
              3605    1    *                        Externally defined routines                      *
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:23   
              3606    1    *                                                                         *
              3607    1    ***************************************************************************/

       22     3611    1   DCL QQC$CONVERT_NUM ENTRY(3);
       23     3612    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       24     3613    1   DCL QTC$READ_TRADER ENTRY(3) ALTRET;
       25     3614    1   DCL QTC$MON_ERR ENTRY(1);
       26     3615        %PAGE(ARG="DCBs");

              3632    1   /***************************************************************************
              3633    1    *                                                                         *
              3634    1    *                                    DCBs                                 *
              3635    1    *                                                                         *
              3636    1    ***************************************************************************/

       27     3640    1   DCL M$LO DCB;
       28     3641        %PAGE(ARG="Based");

              3658    1   /***************************************************************************
              3659    1    *                                                                         *
              3660    1    *                                   Based                                 *
              3661    1    *                                                                         *
              3662    1    ***************************************************************************/

       29     3666        %QT$ENTRY;
       30     3720        %QT$FORM;
       31     3759        %QT$SETTEXT;
       32     3769        %F$DCB;
       33     3826        %PARSE$SYM(STCLASS=BASED);
       34     3864        %PARSE$OUT(STCLASS=BASED);
       35     3909
       36     3910    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       37     3911        %PAGE(ARG="Static");

              3928    1   /***************************************************************************
              3929    1    *                                                                         *
              3930    1    *                                   Static                                *
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:24   
              3931    1    *                                                                         *
              3932    1    ***************************************************************************/

       38     3936    1   DCL FID CHAR(100) STATIC;
       39     3937    1   DCL DATE CHAR(10) STATIC;
       40     3938    1   DCL TIME CHAR(11) STATIC;
       41     3939    1   DCL DAY CHAR(3) STATIC;
       42     3940
       43     3941    1   DCL UTS UBIN WORD STATIC;
       44     3942    1   DCL UNFID_SIZE UBIN WORD STATIC;
       45     3943        %PAGE(ARG="Constant");

              3960    1   /***************************************************************************
              3961    1    *                                                                         *
              3962    1    *                                  Constant                               *
              3963    1    *                                                                         *
              3964    1    ***************************************************************************/

       46     3968        %VLP_CGCP(FPTN=VLP_CGCP_C, STCLASS=CONSTANT);
       47     4011        %VLP_CGTYPL(FPTN=VLP_CGTYPL_C, STCLASS=CONSTANT);
       48     4036        %QT$ENTRY(FPTN=QT_ENTRY_C, STCLASS=CONSTANT);
       49     4090
       50     4091    1   DCL ENTRY_HDR_C CHAR(0) CONSTANT INIT(
              4091            'A  NAME     LAST MODIFIED  PRIO MXACT   LOCK MSG  DEBUGGER   JOURNAL');
       51     4092    1   DCL FORM_HDR_C CHAR(0) CONSTANT INIT('A  NAME     LAST MODIFIED JOURNAL ONEREPORT')
              4092            ;
       52     4093        %PAGE(ARG="Auto");

              4110    1   /***************************************************************************
              4111    1    *                                                                         *
              4112    1    *                                    Auto                                 *
              4113    1    *                                                                         *
              4114    1    ***************************************************************************/

       53     4118    1   DCL MSGTYP CHAR(8);
       54     4119    1   DCL FOUND_MSGTYP CHAR(8);
       55     4120
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:25   
       56     4121    1   DCL HEADING_FLAG BIT(1) ALIGNED;
       57     4122    1   DCL WILD_FLAG BIT(1) ALIGNED;
       58     4123    1   DCL ATTRIBUTES_FLAG BIT(1) ALIGNED;
       59     4124
       60     4125    1   DCL BYTE_COUNT SBIN WORD;
       61     4126    1   DCL CHAR_STRING_SIZE SBIN WORD;
       62     4127    1   DCL NSUBLKS SBIN WORD;
       63     4128    1   DCL NAMES_LISTED SBIN WORD;
       64     4129    1   DCL I SBIN WORD;
       65     4130    1   DCL PAGE_WIDTH SBIN WORD;
       66     4131    1   DCL POS SBIN WORD;
       67     4132    1   DCL TYPE SBIN WORD;
       68     4133    1   DCL NUM SBIN WORD;
       69     4134    1   DCL SIZE SBIN WORD;
       70     4135
       71     4136    1   DCL SUBLK$ PTR;
       72     4137    1   DCL REC$ PTR;
       73     4138
       74     4139    1   DCL OUTPUT_LINE CHAR(131);
       75     4140        %VLP_NAME(FPTN=TEXTC_NUM, LEN=9, NAME=' ');
       76     4167        %VLP_NAME(FPTN=TEXTC_MSGTYP, LEN=8, NAME=' ');
       77     4194
       78     4195    1   DCL 1 ENTRY_INFO,
       79     4196    1         2 VFC CHAR(1),
       80     4197    1         2 NAME CHAR(8),
       81     4198    1         2 * CHAR(1),
       82     4199    1         2 TIME CHAR(5),
       83     4200    1         2 * CHAR(1),
       84     4201    1         2 DATE CHAR(10),
       85     4202    1         2 * CHAR(2),
       86     4203    1         2 PRIO CHAR(3),
       87     4204    1         2 * CHAR(1),
       88     4205    1         2 MXACT CHAR(7),
       89     4206    1         2 * CHAR(1),
       90     4207    1         2 LOCK CHAR(3),
       91     4208    1         2 * CHAR(2),
       92     4209    1         2 MSG CHAR(3),
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:26   
       93     4210    1         2 * CHAR(1),
       94     4211    1         2 DEBUGGER CHAR(11),
       95     4212    1         2 * CHAR(2),
       96     4213    1         2 JOURNAL CHAR(3);
       97     4214    1   DCL 1 ENTRY_INFO_TEXT REDEF ENTRY_INFO CHAR(65);
       98     4215
       99     4216    1   DCL 1 FORM_INFO,
      100     4217    1         2 VFC CHAR(1),
      101     4218    1         2 NAME CHAR(8),
      102     4219    1         2 * CHAR(1),
      103     4220    1         2 TIME CHAR(5),
      104     4221    1         2 * CHAR(1),
      105     4222    1         2 DATE CHAR(10),
      106     4223    1         2 * CHAR(2),
      107     4224    1         2 JOURNAL CHAR(3),
      108     4225    1         2 * CHAR(7),
      109     4226    1         2 ONEREPORT CHAR(3);
      110     4227    1   DCL 1 FORM_INFO_TEXT REDEF FORM_INFO CHAR(41);
      111     4228        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:27   
              4245    1   /***************************************************************************
              4246    1    *                                                                         *
              4247    1    *                                Error codes                              *
              4248    1    *                                                                         *
              4249    1    ***************************************************************************/

      112     4253        %ERRCODE(NAME=CODE_NLISTED, CODE#=%E$NLISTED, FCG#=%FCG_QT, MID#=%MID_B);
      113     4260        %ERRCODE(NAME=CODE_NTL, CODE#=%E$NTL, FCG#=%FCG_QT, MID#=%MID_B);
      114     4267        %ERRCODE(NAME=CODE_NFL, CODE#=%E$NFL, FCG#=%FCG_QT, MID#=%MID_B);
      115     4274        /*E*       ERROR: QTB-E$NLISTED-C
      116     4275
      117     4276                 MESSAGE: .. %U1 listed
      118     4277             DESCRIPTION: This is the number of items listed by a LIST
      119     4278                          command.
      120     4279        */
      121     4280        /*E*       ERROR: QTB-E$NTL-C
      122     4281
      123     4282                 MESSAGE: Nothing to list
      124     4283             DESCRIPTION: There was nothing that matched the list
      125     4284                          criteria of the LIST command.
      126     4285        */
      127     4286        /*E*       ERROR: QTB-E$NFL-C
      128     4287
      129     4288                 MESSAGE: Can't list; %U1 was not found
      130     4289             DESCRIPTION: The type specified was not found.
      131     4290        */
      132     4291        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:28   
              4308    1   /***************************************************************************
              4309    1    *                                                                         *
              4310    1    *                                    FPTs                                 *
              4311    1    *                                                                         *
              4312    1    ***************************************************************************/

      133     4316        %FPT_OPEN(ASN=FILE);
      134     4425
      135     4426        %FPT_UNFID(TEXTFID=FID, NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS,
      136     4427        ASN="FPT_OPEN.V.ASN#", SN=VLP_SN, WSN=VLP_WSN,
      137     4428        RES="FPT_OPEN.V.RES#", LEN=UNFID_SIZE);
      138     4446
      139     4447        %FPT_TIME(DEST=EXT, SOURCE=UTS, DATE=DATE,
      140     4448        TIME=TIME, DAY=DAY, TSTAMP=UTS);
      141     4467
      142     4468        %FPT_WRITE(DCB=M$LO, VFC=YES);
      143     4499
      144     4500        %FPT_CORRES;
      145     4514        %PAGE(ARG="VLPs");

              4531    1   /***************************************************************************
              4532    1    *                                                                         *
              4533    1    *                                    VLPs                                 *
              4534    1    *                                                                         *
              4535    1    ***************************************************************************/

      146     4539        %VLP_NAME;
      147     4566        %VLP_ACCT;
      148     4579        %VLP_PASS;
      149     4592        %VLP_SN;
      150     4605        %VLP_WSN;
      151     4618        %PAGE(ARG="QTB$LIST", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:29   
              4635    1   /***************************************************************************
              4636    1    *                                                                         *
              4637    1    *                                  QTB$LIST                               *
              4638    1    *                                                                         *
              4639    1    ***************************************************************************/

      152     4643    1           NAMES_LISTED = 0;

   4643  4 000002   200015 450100                    STZ     NAMES_LISTED,,AUTO

      153     4644    1           BYTE_COUNT = 1;

   4644  4 000003   000001 235007                    LDA     1,DL
         4 000004   200012 755100                    STA     BYTE_COUNT,,AUTO

      154     4645    1           HEADING_FLAG = '1'B;

   4645  4 000005   400000 236003                    LDQ     -131072,DU
         4 000006   200007 756100                    STQ     HEADING_FLAG,,AUTO

      155     4646    1           WILD_FLAG = '0'B;

   4646  4 000007   200010 450100                    STZ     WILD_FLAG,,AUTO

      156     4647    1           ATTRIBUTES_FLAG = '0'B;

   4647  4 000010   200011 450100                    STZ     ATTRIBUTES_FLAG,,AUTO

      157     4648    1           NSUBLKS = QT_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;

   4648  4 000011   000004 470400 xsym               LDP0    QT_CMDBLK+4
         4 000012   000001 236100                    LDQ     1,,PR0
         4 000013   000022 772000                    QRL     18
         4 000014   000001 136007                    SBLQ    1,DL
         4 000015   200014 756100                    STQ     NSUBLKS,,AUTO

      158     4649    1           FPT_WRITE.BUF_.BUF$ = ADDR(OUTPUT_LINE);
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:30   

   4649  4 000016   200026 631500                    EPPR1   OUTPUT_LINE,,AUTO
         4 000017   000211 451400 2                  STP1    FPT_WRITE+5

      159     4650    1           OUTPUT_LINE = 'A';

   4650  4 000020   040100 100400                    MLR     fill='040'O
         4 000021   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000022   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      160     4651
      161     4652    1           FPT_CORRES.V.DCB1# = DCBNUM(M$LO);

   4652  4 000023   000000 236007 xsym               LDQ     M$LO,DL
         4 000024   000000 620006                    EAX0    0,QL
         4 000025   000222 740000 2                  STX0    FPT_CORRES+2

      162     4653    1           FPT_CORRES.V.DCB2# = QT_GLOBAL.M$DO#;

   4653  4 000026   000035 721000 xsym               LXL1    QT_GLOBAL+29
         4 000027   000222 441000 2                  SXL1    FPT_CORRES+2

      163     4654    1           CALL M$CORRES (FPT_CORRES)

   4654  4 000030   000220 630400 2                  EPPR0   FPT_CORRES
         4 000031   460000 713400                    CLIMB   alt,+24576
         4 000032   400000 401760                    pmme    nvectors=1
         4 000033   000044 702000 4                  TSX2    s:4660

      164     4655    2           WHENRETURN DO;

      165     4656    2               PAGE_WIDTH = DCBADDR(DCBNUM(M$LO)) -> F$DCB.WIDTH#;

   4656  4 000034   000000 236007 xsym               LDQ     M$LO,DL
         4 000035   000001 470400 5                  LDP0    1
         4 000036   000000 471500                    LDP1    0,,PR0
         4 000037   100000 473506                    LDP3    0,QL,PR1
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:31   
         4 000040   300004 236100                    LDQ     4,,PR3
         4 000041   000777 376007                    ANQ     511,DL
         4 000042   200017 756100                    STQ     PAGE_WIDTH,,AUTO

      166     4657    2             END;

   4657  4 000043   000054 710000 4                  TRA     s:4663

      167     4658    1           WHENALTRETURN
      168     4659    2             DO;

      169     4660    2               PAGE_WIDTH = DCBADDR(QT_GLOBAL.M$DO#) -> F$DCB.WIDTH#;

   4660  4 000044   000001 470400 5                  LDP0    1
         4 000045   000000 471500                    LDP1    0,,PR0
         4 000046   000035 720000 xsym               LXL0    QT_GLOBAL+29
         4 000047   100000 473510                    LDP3    0,X0,PR1
         4 000050   300004 236100                    LDQ     4,,PR3
         4 000051   000777 376007                    ANQ     511,DL
         4 000052   200017 756100                    STQ     PAGE_WIDTH,,AUTO

      170     4661    2               FPT_WRITE.V.DCB# = QT_GLOBAL.M$DO#;

   4661  4 000053   000214 740000 2                  STX0    FPT_WRITE+8

      171     4662    2             END;

      172     4663    1           IF PAGE_WIDTH = 0 OR PAGE_WIDTH < 20 THEN

   4663  4 000054   000057 600000 4                  TZE     s:4665
         4 000055   000024 116007                    CMPQ    20,DL
         4 000056   000061 605000 4                  TPL     s:4668

      173     4664    2             DO;

      174     4665    2               PAGE_WIDTH = 80;

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:32   
   4665  4 000057   000120 235007                    LDA     80,DL
         4 000060   200017 755100                    STA     PAGE_WIDTH,,AUTO

      175     4666    2             END;

      176     4667
      177     4668    2           DO I = 0 TO NSUBLKS;

   4668  4 000061   200016 450100                    STZ     I,,AUTO
         4 000062   000111 710000 4                  TRA     s:4680+1

      178     4669    2             SUBLK$ = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   4669  4 000063   000004 470400 xsym               LDP0    QT_CMDBLK+4
         4 000064   200016 720100                    LXL0    I,,AUTO
         4 000065   000003 236110                    LDQ     3,X0,PR0
         4 000066   200024 756100                    STQ     SUBLK$,,AUTO

      179     4670
      180     4671    3             DO CASE(SUBLK$ -> OUT$SYM.CODE);

   4671  4 000067   200024 471500                    LDP1    SUBLK$,,AUTO
         4 000070   100000 721100                    LXL1    0,,PR1
         4 000071   000003 101003                    CMPX1   3,DU
         4 000072   000074 602011 4                  TNC     s:4671+5,X1
         4 000073   000110 710000 4                  TRA     s:4680
         4 000074   000110 710000 4                  TRA     s:4680
         4 000075   000077 710000 4                  TRA     s:4674
         4 000076   000106 710000 4                  TRA     s:4677

      181     4672
      182     4673    3               CASE(1 /* OPT_TTYPE */);

      183     4674    3                 MSGTYP = SUBLK$ -> OUT$SYM.TEXT;

   4674  4 000077   100004 236100                    LDQ     4,,PR1
         4 000100   000033 772000                    QRL     27
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:33   
         4 000101   000000 622006                    EAX2    0,QL
         4 000102   040100 100540                    MLR     fill='040'O
         4 000103   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         4 000104   200003 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
         4 000105   000110 710000 4                  TRA     s:4680

      184     4675
      185     4676    3               CASE(2 /* OPT_ATTRIBUTES */);

      186     4677    3                 ATTRIBUTES_FLAG = '1'B;

   4677  4 000106   400000 236003                    LDQ     -131072,DU
         4 000107   200011 756100                    STQ     ATTRIBUTES_FLAG,,AUTO

      187     4678
      188     4679    3             END /* CASE */;

      189     4680    2           END /* Do for each sub option */;

   4680  4 000110   200016 054100                    AOS     I,,AUTO
         4 000111   200016 236100                    LDQ     I,,AUTO
         4 000112   200014 116100                    CMPQ    NSUBLKS,,AUTO
         4 000113   000063 604400 4                  TMOZ    s:4669

      190     4681
      191     4682    1           CALL INDEX(POS, '?', MSGTYP) ALTRET(NO_Q1);

   4682  4 000114   000000 124500                    SCM     mask='000'O
         4 000115   200003 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
         4 000116   000002 000001 5                  ADSC9   2                        cn=0,n=1
         4 000117   200020 000100                    ARG     POS,,AUTO
         4 000120   000124 606400 4                  TTN     NO_Q1

      192     4683    1           WILD_FLAG = '1'B;

   4683  4 000121   400000 236003                    LDQ     -131072,DU
         4 000122   200010 756100                    STQ     WILD_FLAG,,AUTO
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:34   

      193     4684
      194     4685    2           DO WHILE('0'B);

   4685  4 000123   000126 710000 4                  TRA     s:4691

      195     4686
      196     4687    2   NO_Q1:
      197     4688    2             ATTRIBUTES_FLAG = '1'B;

   4688  4 000124   400000 236003       NO_Q1        LDQ     -131072,DU
         4 000125   200011 756100                    STQ     ATTRIBUTES_FLAG,,AUTO

      198     4689    2           END /* NEVER */;

      199     4690
      200     4691    1           IF QT_CMDBLK.CODE = 10 /* LIST_ENTRY */ THEN

   4691  4 000126   000005 235000 xsym               LDA     QT_CMDBLK+5
         4 000127   000012 115007                    CMPA    10,DL
         4 000130   000134 601000 4                  TNZ     s:4697

      201     4692    2             DO;

      202     4693    2               TYPE = 1 /* TYPE_E */;

   4693  4 000131   000001 235007                    LDA     1,DL
         4 000132   200021 755100                    STA     TYPE,,AUTO

      203     4694    2             END;

   4694  4 000133   000136 710000 4                  TRA     s:4702

      204     4695    1           ELSE
      205     4696    2             DO;

      206     4697    2               TYPE = 2 /* TYPE_F */;
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:35   

   4697  4 000134   000002 235007                    LDA     2,DL
         4 000135   200021 755100                    STA     TYPE,,AUTO

      207     4698    2             END;

      208     4699
      209     4700    2           DO WHILE('1'B);

      210     4701
      211     4702    2             CALL QTC$READ_TRADER(MSGTYP, TYPE, FOUND_MSGTYP) ALTRET(NOT_FOUND);

   4702  4 000136   200005 630500                    EPPR0   FOUND_MSGTYP,,AUTO
         4 000137   200130 450500                    STP0    FORM_INFO+16,,AUTO
         4 000140   200021 631500                    EPPR1   TYPE,,AUTO
         4 000141   200127 451500                    STP1    FORM_INFO+15,,AUTO
         4 000142   200003 633500                    EPPR3   MSGTYP,,AUTO
         4 000143   200126 453500                    STP3    FORM_INFO+14,,AUTO
         4 000144   200126 630500                    EPPR0   FORM_INFO+14,,AUTO
         4 000145   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000146   000000 701000 xent               TSX1    QTC$READ_TRADER
         4 000147   000174 702000 4                  TSX2    NOT_FOUND

      212     4703
      213     4704    2             IF ATTRIBUTES_FLAG THEN

   4704  4 000150   200011 234100                    SZN     ATTRIBUTES_FLAG,,AUTO
         4 000151   000167 605000 4                  TPL     s:4718

      214     4705    3               DO;

      215     4706    4                 DO CASE(TYPE);

   4706  4 000152   200021 235100                    LDA     TYPE,,AUTO
         4 000153   000003 115007                    CMPA    3,DL
         4 000154   000156 602005 4                  TNC     s:4706+4,AL
         4 000155   000171 710000 4                  TRA     s:4721
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:36   
         4 000156   000166 710000 4                  TRA     s:4715
         4 000157   000161 710000 4                  TRA     s:4709
         4 000160   000164 710000 4                  TRA     s:4712

      216     4707
      217     4708    4                   CASE(1 /* TYPE_E */);

      218     4709    4                     CALL PRINT_ENTRY;

   4709  4 000161   000372 701000 4                  TSX1    PRINT_ENTRY
         4 000162   000000 011000                    NOP     0
         4 000163   000171 710000 4                  TRA     s:4721

      219     4710
      220     4711    4                   CASE(2 /* TYPE_F */);

      221     4712    4                     CALL PRINT_FORM;

   4712  4 000164   000706 701000 4                  TSX1    PRINT_FORM
         4 000165   000000 011000                    NOP     0

      222     4713
      223     4714    4                 END /* CASE */;

      224     4715    3               END;

   4715  4 000166   000171 710000 4                  TRA     s:4721

      225     4716    2             ELSE
      226     4717    3               DO;

      227     4718    3                 CALL LIST_NAME;

   4718  4 000167   000313 701000 4                  TSX1    LIST_NAME
         4 000170   000000 011000                    NOP     0

      228     4719    3               END;
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:37   

      229     4720
      230     4721    2             IF QT_GLOBAL.BREAK THEN

   4721  4 000171   000003 234000 xsym               SZN     QT_GLOBAL+3
         4 000172   000136 605000 4                  TPL     s:4702

      231     4722    3               DO;

      232     4723    3                 GOTO NOT_FOUND;

   4723  4 000173   000174 710000 4                  TRA     NOT_FOUND

      233     4724    3               END;
      234     4725
      235     4726    2           END /* WHILE */;

      236     4727
      237     4728    1   NOT_FOUND:
      238     4729    1           IF NOT ATTRIBUTES_FLAG AND BYTE_COUNT > 1 THEN

   4729  4 000174   200011 234100       NOT_FOUND    SZN     ATTRIBUTES_FLAG,,AUTO
         4 000175   000213 604000 4                  TMI     s:4735
         4 000176   200012 235100                    LDA     BYTE_COUNT,,AUTO
         4 000177   000001 115007                    CMPA    1,DL
         4 000200   000213 604400 4                  TMOZ    s:4735

      239     4730    2             DO;

      240     4731    2               FPT_WRITE.BUF_.BOUND = BYTE_COUNT - 1;

   4731  4 000201   200012 236100                    LDQ     BYTE_COUNT,,AUTO
         4 000202   000001 136007                    SBLQ    1,DL
         4 000203   000020 736000                    QLS     16
         4 000204   000210 676000 2                  ERQ     FPT_WRITE+4
         4 000205   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000206   000210 656000 2                  ERSQ    FPT_WRITE+4
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:38   

      241     4732    2               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   4732  4 000207   000204 630400 2                  EPPR0   FPT_WRITE
         4 000210   440001 713400                    CLIMB   alt,write
         4 000211   401400 401760                    pmme    nvectors=4
         4 000212   000306 702000 4                  TSX2    MON_ERR

      242     4733    2             END;

      243     4734
      244     4735    1           IF NAMES_LISTED > 0 THEN

   4735  4 000213   200015 235100                    LDA     NAMES_LISTED,,AUTO
         4 000214   000246 604400 4                  TMOZ    s:4742

      245     4736    2             DO;

      246     4737    2               CALL QQC$CONVERT_NUM(NAMES_LISTED, SIZE, ADDR(TEXTC_NUM.NAME#));

   4737  4 000215   000003 236000 5                  LDQ     3
         4 000216   200126 756100                    STQ     FORM_INFO+14,,AUTO
         4 000217   200126 630500                    EPPR0   FORM_INFO+14,,AUTO
         4 000220   200131 450500                    STP0    FORM_INFO+17,,AUTO
         4 000221   200023 631500                    EPPR1   SIZE,,AUTO
         4 000222   200130 451500                    STP1    FORM_INFO+16,,AUTO
         4 000223   200015 633500                    EPPR3   NAMES_LISTED,,AUTO
         4 000224   200127 453500                    STP3    FORM_INFO+15,,AUTO
         4 000225   200127 630500                    EPPR0   FORM_INFO+15,,AUTO
         4 000226   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000227   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         4 000230   000000 011000                    NOP     0

      247     4738    2               TEXTC_NUM.L# = SIZE;

   4738  4 000231   200023 236100                    LDQ     SIZE,,AUTO
         4 000232   000033 736000                    QLS     27
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:39   
         4 000233   000042 552040 2                  STBQ    TEXTC_NUM,'40'O

      248     4739    2               CALL XUR$ERRMSG(CODE_NLISTED, , , VECTOR(TEXTC_NUM));

   4739  4 000234   000006 236000 5                  LDQ     6
         4 000235   000001 235000 xsym               LDA     B_VECTNIL+1
         4 000236   200130 757100                    STAQ    FORM_INFO+16,,AUTO
         4 000237   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000240   000007 235000 5                  LDA     7
         4 000241   200126 757100                    STAQ    FORM_INFO+14,,AUTO
         4 000242   200126 630500                    EPPR0   FORM_INFO+14,,AUTO
         4 000243   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000244   000000 701000 xent               TSX1    XUR$ERRMSG
         4 000245   000000 011000                    NOP     0

      249     4740    2             END;

      250     4741
      251     4742    1           IF NAMES_LISTED = 0 AND WILD_FLAG THEN

   4742  4 000246   200015 235100                    LDA     NAMES_LISTED,,AUTO
         4 000247   000260 601000 4                  TNZ     s:4748
         4 000250   200010 234100                    SZN     WILD_FLAG,,AUTO
         4 000251   000260 605000 4                  TPL     s:4748

      252     4743    2             DO;

      253     4744    2               QT_CMDBLK.MINOR_ERR = CODE_NTL;

   4744  4 000252   000123 236000 3                  LDQ     CODE_NTL
         4 000253   000001 756000 xsym               STQ     QT_CMDBLK+1

      254     4745    2               CALL XUR$ERRMSG(CODE_NTL);

   4745  4 000254   000010 630400 5                  EPPR0   8
         4 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000256   000000 701000 xent               TSX1    XUR$ERRMSG
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:40   
         4 000257   000000 011000                    NOP     0

      255     4746    2             END;

      256     4747
      257     4748    1           IF NAMES_LISTED = 0 AND NOT WILD_FLAG THEN

   4748  4 000260   200015 235100                    LDA     NAMES_LISTED,,AUTO
         4 000261   000305 601000 4                  TNZ     s:4756
         4 000262   200010 234100                    SZN     WILD_FLAG,,AUTO
         4 000263   000305 604000 4                  TMI     s:4756

      258     4749    2             DO;

      259     4750    2               TEXTC_MSGTYP.NAME# = MSGTYP;

   4750  4 000264   040000 100500                    MLR     fill='040'O
         4 000265   200003 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
         4 000266   000045 200010 2                  ADSC9   TEXTC_MSGTYP             cn=1,n=8

      260     4751    2               QT_CMDBLK.MINOR_ERR = CODE_NFL;

   4751  4 000267   000124 236000 3                  LDQ     CODE_NFL
         4 000270   000001 756000 xsym               STQ     QT_CMDBLK+1

      261     4752    2               TEXTC_MSGTYP.L# = 8;

   4752  4 000271   010000 236003                    LDQ     4096,DU
         4 000272   000045 552040 2                  STBQ    TEXTC_MSGTYP,'40'O

      262     4753    2               CALL XUR$ERRMSG(CODE_NFL, , , VECTOR(TEXTC_MSGTYP));

   4753  4 000273   000014 236000 5                  LDQ     12
         4 000274   000001 235000 xsym               LDA     B_VECTNIL+1
         4 000275   200130 757100                    STAQ    FORM_INFO+16,,AUTO
         4 000276   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000277   000015 235000 5                  LDA     13
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:41   
         4 000300   200126 757100                    STAQ    FORM_INFO+14,,AUTO
         4 000301   200126 630500                    EPPR0   FORM_INFO+14,,AUTO
         4 000302   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000303   000000 701000 xent               TSX1    XUR$ERRMSG
         4 000304   000000 011000                    NOP     0

      263     4754    2             END;

      264     4755
      265     4756    1           RETURN;

   4756  4 000305   000000 702200 xent               TSX2  ! X66_ARET

      266     4757
      267     4758    1   MON_ERR:
      268     4759    1           CALL QTC$MON_ERR('1'B);

   4759  4 000306   000016 630400 5     MON_ERR      EPPR0   14
         4 000307   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000310   000000 701000 xent               TSX1    QTC$MON_ERR
         4 000311   000000 011000                    NOP     0
         4 000312   001063 710000 4                  TRA     s:5025

      269     4760                %PAGE(ARG="LIST_NAME", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:42   
              4777    1   /***************************************************************************
              4778    1    *                                                                         *
              4779    1    *                                 LIST_NAME                               *
              4780    1    *                                                                         *
              4781    1    ***************************************************************************/

      270     4785    1   LIST_NAME:

   4785  4 000313   200124 741300       LIST_NAME    STX1  ! FORM_INFO+12,,AUTO

      271     4786    1           PROC;
      272     4787
      273     4788    2           NAMES_LISTED = NAMES_LISTED + 1;

   4788  4 000314   200015 054100                    AOS     NAMES_LISTED,,AUTO

      274     4789    2           CHAR_STRING_SIZE = 8;

   4789  4 000315   000010 235007                    LDA     8,DL
         4 000316   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      275     4790
      276     4791    2           IF BYTE_COUNT + 8 > PAGE_WIDTH THEN

   4791  4 000317   200012 236100                    LDQ     BYTE_COUNT,,AUTO
         4 000320   000010 036007                    ADLQ    8,DL
         4 000321   200017 116100                    CMPQ    PAGE_WIDTH,,AUTO
         4 000322   000342 604400 4                  TMOZ    s:4799

      277     4792    3             DO;

      278     4793    3               FPT_WRITE.BUF_.BOUND = BYTE_COUNT - 1;

   4793  4 000323   200012 236100                    LDQ     BYTE_COUNT,,AUTO
         4 000324   000001 136007                    SBLQ    1,DL
         4 000325   000020 736000                    QLS     16
         4 000326   000210 676000 2                  ERQ     FPT_WRITE+4
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:43   
         4 000327   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000330   000210 656000 2                  ERSQ    FPT_WRITE+4

      279     4794    3               BYTE_COUNT = 1;

   4794  4 000331   000001 236007                    LDQ     1,DL
         4 000332   200012 756100                    STQ     BYTE_COUNT,,AUTO

      280     4795    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   4795  4 000333   000204 630400 2                  EPPR0   FPT_WRITE
         4 000334   440001 713400                    CLIMB   alt,write
         4 000335   401400 401760                    pmme    nvectors=4
         4 000336   000364 702000 4                  TSX2    MON_ERR

      281     4796    3               OUTPUT_LINE = 'A';

   4796  4 000337   040100 100400                    MLR     fill='040'O
         4 000340   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000341   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      282     4797    3             END;

      283     4798
      284     4799    2           PINCRC(ADDR(OUTPUT_LINE), BYTE_COUNT) -> CHAR$STRING = FOUND_MSGTYP;

   4799  4 000342   200013 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         4 000343   200012 235100                    LDA     BYTE_COUNT,,AUTO
         4 000344   040145 100500                    MLR     fill='040'O
         4 000345   200005 000010                    ADSC9   FOUND_MSGTYP,,AUTO       cn=0,n=8
         4 000346   200026 000010                    ADSC9   OUTPUT_LINE,A,AUTO       cn=0,n=*X0

      285     4800
      286     4801    2           BYTE_COUNT = BYTE_COUNT + 8;

   4801  4 000347   000010 236007                    LDQ     8,DL
         4 000350   200012 056100                    ASQ     BYTE_COUNT,,AUTO
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:44   

      287     4802
      288     4803    2           IF BYTE_COUNT + 2 <= PAGE_WIDTH THEN

   4803  4 000351   200012 236100                    LDQ     BYTE_COUNT,,AUTO
         4 000352   000002 036007                    ADLQ    2,DL
         4 000353   200017 116100                    CMPQ    PAGE_WIDTH,,AUTO
         4 000354   000360 605400 4                  TPNZ    s:4809

      289     4804    3             DO;

      290     4805    3               BYTE_COUNT = BYTE_COUNT + 2;

   4805  4 000355   000002 236007                    LDQ     2,DL
         4 000356   200012 056100                    ASQ     BYTE_COUNT,,AUTO

      291     4806    3             END;

   4806  4 000357   000362 710000 4                  TRA     s:4812

      292     4807    2           ELSE
      293     4808    3             DO;

      294     4809    3               BYTE_COUNT = PAGE_WIDTH;

   4809  4 000360   200017 235100                    LDA     PAGE_WIDTH,,AUTO
         4 000361   200012 755100                    STA     BYTE_COUNT,,AUTO

      295     4810    3             END;

      296     4811
      297     4812    2           RETURN;

   4812  4 000362   200124 221300                    LDX1  ! FORM_INFO+12,,AUTO
         4 000363   000001 702211                    TSX2  ! 1,X1

      298     4813
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:45   
      299     4814    2   MON_ERR:
      300     4815    2           CALL QTC$MON_ERR('1'B);

   4815  4 000364   000016 630400 5     MON_ERR      EPPR0   14
         4 000365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000366   000000 701000 xent               TSX1    QTC$MON_ERR
         4 000367   000000 011000                    NOP     0

      301     4816
      302     4817    2   END LIST_NAME;

   4817  4 000370   200124 221300                    LDX1  ! FORM_INFO+12,,AUTO
         4 000371   000001 702211                    TSX2  ! 1,X1

      303     4818                %PAGE(ARG="PRINT_ENTRY", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:46   
              4835    2   /***************************************************************************
              4836    2    *                                                                         *
              4837    2    *                                PRINT_ENTRY                              *
              4838    2    *                                                                         *
              4839    2    ***************************************************************************/

      304     4843    1   PRINT_ENTRY:

   4843  4 000372   200124 741300       PRINT_ENTRY  STX1  ! FORM_INFO+12,,AUTO

      305     4844    1           PROC;
      306     4845
      307     4846    2           IF HEADING_FLAG THEN

   4846  4 000373   200007 234100                    SZN     HEADING_FLAG,,AUTO
         4 000374   000411 605000 4                  TPL     s:4854

      308     4847    3             DO;

      309     4848    3               HEADING_FLAG = '0'B;

   4848  4 000375   200007 450100                    STZ     HEADING_FLAG,,AUTO

      310     4849    3               OUTPUT_LINE = ENTRY_HDR_C;

   4849  4 000376   040100 100400                    MLR     fill='040'O
         4 000377   000066 000104 3                  ADSC9   ENTRY_HDR_C              cn=0,n=68
         4 000400   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      311     4850    3               FPT_WRITE.BUF_.BOUND = SIZEC(ENTRY_HDR_C) - 1;

   4850  4 000401   000210 236000 2                  LDQ     FPT_WRITE+4
         4 000402   177777 376007                    ANQ     65535,DL
         4 000403   000017 276000 5                  ORQ     15
         4 000404   000210 756000 2                  STQ     FPT_WRITE+4

      312     4851    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:47   

   4851  4 000405   000204 630400 2                  EPPR0   FPT_WRITE
         4 000406   440001 713400                    CLIMB   alt,write
         4 000407   401400 401760                    pmme    nvectors=4
         4 000410   000700 702000 4                  TSX2    MON_ERR

      313     4852    3             END;

      314     4853
      315     4854    2           NAMES_LISTED = NAMES_LISTED + 1;

   4854  4 000411   200015 054100                    AOS     NAMES_LISTED,,AUTO

      316     4855    2           ENTRY_INFO_TEXT = 'A';

   4855  4 000412   040100 100400                    MLR     fill='040'O
         4 000413   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000414   200067 000101                    ADSC9   ENTRY_INFO,,AUTO         cn=0,n=65

      317     4856
      318     4857    2           ENTRY_INFO.NAME = FOUND_MSGTYP;

   4857  4 000415   040100 100500                    MLR     fill='040'O
         4 000416   200005 000010                    ADSC9   FOUND_MSGTYP,,AUTO       cn=0,n=8
         4 000417   200067 200010                    ADSC9   ENTRY_INFO,,AUTO         cn=1,n=8

      319     4858
      320     4859    2           UTS = QT$ENTRY.UTS;

   4859  4 000420   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000421   000001 235100                    LDA     1,,PR0
         4 000422   000040 755000 2                  STA     UTS

      321     4860    2           CALL M$TIME(FPT_TIME);

   4860  4 000423   000170 630400 2                  EPPR0   FPT_TIME
         4 000424   020004 713400                    CLIMB   8196
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:48   
         4 000425   402000 401760                    pmme    nvectors=5

      322     4861    2           ENTRY_INFO.TIME = SUBSTR(TIME, 0, 5);

   4861  4 000426   040100 100400                    MLR     fill='040'O
         4 000427   000034 000005 2                  ADSC9   TIME                     cn=0,n=5
         4 000430   200071 400005                    ADSC9   ENTRY_INFO+2,,AUTO       cn=2,n=5

      323     4862    2           ENTRY_INFO.DATE = DATE;

   4862  4 000431   040100 100400                    MLR     fill='040'O
         4 000432   000031 000012 2                  ADSC9   DATE                     cn=0,n=10
         4 000433   200073 000012                    ADSC9   ENTRY_INFO+4,,AUTO       cn=0,n=10

      324     4863
      325     4864    2           NUM = QT$ENTRY.PRIO;

   4864  4 000434   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000435   000023 236100                    LDQ     19,,PR0
         4 000436   000777 376007                    ANQ     511,DL
         4 000437   200022 756100                    STQ     NUM,,AUTO

      326     4865    2           CALL QQC$CONVERT_NUM(NUM, SIZE, ADDR(ENTRY_INFO.PRIO));

   4865  4 000440   200076 631500                    EPPR1   ENTRY_INFO+7,,AUTO
         4 000441   200126 451500                    STP1    FORM_INFO+14,,AUTO
         4 000442   200126 633500                    EPPR3   FORM_INFO+14,,AUTO
         4 000443   200131 453500                    STP3    FORM_INFO+17,,AUTO
         4 000444   200023 634500                    EPPR4   SIZE,,AUTO
         4 000445   200130 454500                    STP4    FORM_INFO+16,,AUTO
         4 000446   200022 635500                    EPPR5   NUM,,AUTO
         4 000447   200127 455500                    STP5    FORM_INFO+15,,AUTO
         4 000450   200127 630500                    EPPR0   FORM_INFO+15,,AUTO
         4 000451   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000452   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         4 000453   000000 011000                    NOP     0

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:49   
      327     4866
      328     4867    2           NUM = QT$ENTRY.MAXACTIVE;

   4867  4 000454   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000455   000002 235100                    LDA     2,,PR0
         4 000456   200022 755100                    STA     NUM,,AUTO

      329     4868    2           CALL QQC$CONVERT_NUM(NUM, SIZE, ADDR(ENTRY_INFO.MXACT));

   4868  4 000457   200077 631500                    EPPR1   ENTRY_INFO+8,,AUTO
         4 000460   200126 451500                    STP1    FORM_INFO+14,,AUTO
         4 000461   200126 633500                    EPPR3   FORM_INFO+14,,AUTO
         4 000462   200131 453500                    STP3    FORM_INFO+17,,AUTO
         4 000463   200023 634500                    EPPR4   SIZE,,AUTO
         4 000464   200130 454500                    STP4    FORM_INFO+16,,AUTO
         4 000465   200022 635500                    EPPR5   NUM,,AUTO
         4 000466   200127 455500                    STP5    FORM_INFO+15,,AUTO
         4 000467   200127 630500                    EPPR0   FORM_INFO+15,,AUTO
         4 000470   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000471   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         4 000472   000000 011000                    NOP     0

      330     4869
      331     4870    2           IF QT$ENTRY.FLAGS.NEW_LOCK THEN

   4870  4 000473   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000474   000000 236100                    LDQ     0,,PR0
         4 000475   100000 316003                    CANQ    32768,DU
         4 000476   000504 600000 4                  TZE     s:4876

      332     4871    3             DO;

      333     4872    3               ENTRY_INFO.LOCK = 'ON';

   4872  4 000477   000125 236000 3                  LDQ     CODE_NFL+1
         4 000500   777777 376003                    ANQ     -1,DU
         4 000501   040040 276007                    ORQ     16416,DL
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:50   
         4 000502   200101 552170                    STBQ    ENTRY_INFO+10,'70'O,AUTO

      334     4873    3             END;

   4873  4 000503   000506 710000 4                  TRA     s:4879

      335     4874    2           ELSE
      336     4875    3             DO;

      337     4876    3               ENTRY_INFO.LOCK = 'OFF';

   4876  4 000504   000126 236000 3                  LDQ     CODE_NFL+2
         4 000505   200101 552170                    STBQ    ENTRY_INFO+10,'70'O,AUTO

      338     4877    3             END;

      339     4878
      340     4879    2           IF QT$ENTRY.FLAGS.MESSAGE THEN

   4879  4 000506   000000 236100                    LDQ     0,,PR0
         4 000507   040000 316003                    CANQ    16384,DU
         4 000510   000517 600000 4                  TZE     s:4885

      341     4880    3             DO;

      342     4881    3               ENTRY_INFO.MSG = 'ON';

   4881  4 000511   000125 236000 3                  LDQ     CODE_NFL+1
         4 000512   777777 376003                    ANQ     -1,DU
         4 000513   040040 276007                    ORQ     16416,DL
         4 000514   000011 772000                    QRL     9
         4 000515   200102 552134                    STBQ    ENTRY_INFO+11,'34'O,AUTO

      343     4882    3             END;

   4882  4 000516   000522 710000 4                  TRA     s:4888

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:51   
      344     4883    2           ELSE
      345     4884    3             DO;

      346     4885    3               ENTRY_INFO.MSG = 'OFF';

   4885  4 000517   000126 236000 3                  LDQ     CODE_NFL+2
         4 000520   000011 772000                    QRL     9
         4 000521   200102 552134                    STBQ    ENTRY_INFO+11,'34'O,AUTO

      347     4886    3             END;

      348     4887
      349     4888    2           ENTRY_INFO.DEBUGGER = QT$ENTRY.DEBUGGER.TEXT;

   4888  4 000522   040100 100500                    MLR     fill='040'O
         4 000523   000020 600013                    ADSC9   16,,PR0                  cn=3,n=11
         4 000524   200103 200013                    ADSC9   ENTRY_INFO+12,,AUTO      cn=1,n=11

      350     4889
      351     4890    2           IF QT$ENTRY.FLAGS.JOURNAL THEN

   4890  4 000525   000000 236100                    LDQ     0,,PR0
         4 000526   020000 316003                    CANQ    8192,DU
         4 000527   000534 600000 4                  TZE     s:4896

      352     4891    3             DO;

      353     4892    3               ENTRY_INFO.JOURNAL = 'ON';

   4892  4 000530   040100 100400                    MLR     fill='040'O
         4 000531   000125 000002 3                  ADSC9   CODE_NFL+1               cn=0,n=2
         4 000532   200106 400003                    ADSC9   ENTRY_INFO+15,,AUTO      cn=2,n=3

      354     4893    3             END;

   4893  4 000533   000537 710000 4                  TRA     s:4899

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:52   
      355     4894    2           ELSE
      356     4895    3             DO;

      357     4896    3               ENTRY_INFO.JOURNAL = 'OFF';

   4896  4 000534   040100 100400                    MLR     fill='040'O
         4 000535   000126 000003 3                  ADSC9   CODE_NFL+2               cn=0,n=3
         4 000536   200106 400003                    ADSC9   ENTRY_INFO+15,,AUTO      cn=2,n=3

      358     4897    3             END;

      359     4898
      360     4899    2           OUTPUT_LINE = ENTRY_INFO_TEXT;

   4899  4 000537   040100 100500                    MLR     fill='040'O
         4 000540   200067 000101                    ADSC9   ENTRY_INFO,,AUTO         cn=0,n=65
         4 000541   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      361     4900    2           FPT_WRITE.BUF_.BOUND = SIZEC(ENTRY_INFO_TEXT) - 1;

   4900  4 000542   000210 236000 2                  LDQ     FPT_WRITE+4
         4 000543   177777 376007                    ANQ     65535,DL
         4 000544   000020 276003                    ORQ     16,DU
         4 000545   000210 756000 2                  STQ     FPT_WRITE+4

      362     4901    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   4901  4 000546   000204 630400 2                  EPPR0   FPT_WRITE
         4 000547   440001 713400                    CLIMB   alt,write
         4 000550   401400 401760                    pmme    nvectors=4
         4 000551   000700 702000 4                  TSX2    MON_ERR

      363     4902
      364     4903    2           VLP_NAME = QT$ENTRY.TPAP.NAME;

   4903  4 000552   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000553   000000 100500                    MLR     fill='000'O
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:53   
         4 000554   000003 000040                    ADSC9   3,,PR0                   cn=0,n=32
         4 000555   000224 000040 2                  ADSC9   VLP_NAME                 cn=0,n=32

      365     4904    2           VLP_ACCT.ACCT# = QT$ENTRY.TPAP.ACCT;

   4904  4 000556   040000 100500                    MLR     fill='040'O
         4 000557   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 000560   000234 000010 2                  ADSC9   VLP_ACCT                 cn=0,n=8

      366     4905    2           VLP_PASS.PASS# = QT$ENTRY.TPAP.PASS;

   4905  4 000561   040000 100500                    MLR     fill='040'O
         4 000562   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         4 000563   000236 000010 2                  ADSC9   VLP_PASS                 cn=0,n=8

      367     4906    2           VLP_SN.SN#(0) = QT$ENTRY.TPAP.SN;

   4906  4 000564   040000 100500                    MLR     fill='040'O
         4 000565   000017 000006                    ADSC9   15,,PR0                  cn=0,n=6
         4 000566   000241 000006 2                  ADSC9   VLP_SN+1                 cn=0,n=6

      368     4907    2           CALL M$UNFID(FPT_UNFID) ALTRET(MON_ERR);

   4907  4 000567   000142 630400 2                  EPPR0   FPT_UNFID
         4 000570   420021 713400                    CLIMB   alt,+8209
         4 000571   404400 401760                    pmme    nvectors=10
         4 000572   000700 702000 4                  TSX2    MON_ERR

      369     4908
      370     4909    2           OUTPUT_LINE = 'A  TPAP=';

   4909  4 000573   040100 100400                    MLR     fill='040'O
         4 000574   000127 000010 3                  ADSC9   CODE_NFL+3               cn=0,n=8
         4 000575   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      371     4910    2           CHAR_STRING_SIZE = UNFID_SIZE;

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:54   
   4910  4 000576   000041 235000 2                  LDA     UNFID_SIZE
         4 000577   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      372     4911    2           PINCRC(ADDR(OUTPUT_LINE), 8) -> CHAR$STRING = FID;

   4911  4 000600   000000 620005                    EAX0    0,AL
         4 000601   040140 100400                    MLR     fill='040'O
         4 000602   000000 000144 2                  ADSC9   FID                      cn=0,n=100
         4 000603   200030 000010                    ADSC9   OUTPUT_LINE+2,,AUTO      cn=0,n=*X0

      373     4912
      374     4913    2           FPT_WRITE.BUF_.BOUND = UNFID_SIZE + 7;

   4913  4 000604   000041 236000 2                  LDQ     UNFID_SIZE
         4 000605   000007 036007                    ADLQ    7,DL
         4 000606   000020 736000                    QLS     16
         4 000607   000210 676000 2                  ERQ     FPT_WRITE+4
         4 000610   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000611   000210 656000 2                  ERSQ    FPT_WRITE+4

      375     4914    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   4914  4 000612   000204 630400 2                  EPPR0   FPT_WRITE
         4 000613   440001 713400                    CLIMB   alt,write
         4 000614   401400 401760                    pmme    nvectors=4
         4 000615   000700 702000 4                  TSX2    MON_ERR

      376     4915
      377     4916    2           I = 1;

   4916  4 000616   000001 235007                    LDA     1,DL
         4 000617   200016 755100                    STA     I,,AUTO

      378     4917    2           REC$ = QT_GLOBAL.QT$SETTEXT$;

   4917  4 000620   000032 236000 xsym               LDQ     QT_GLOBAL+26
         4 000621   200025 756100                    STQ     REC$,,AUTO
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:55   

      379     4918
      380     4919    3           DO WHILE(I <= QT$ENTRY.SET_COUNT AND NOT QT_GLOBAL.BREAK);

   4919  4 000622   000666 710000 4                  TRA     s:4930

      381     4920    3             OUTPUT_LINE = 'A';

   4920  4 000623   040100 100400                    MLR     fill='040'O
         4 000624   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000625   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      382     4921    3             CHAR_STRING_SIZE = REC$ -> QT$SETTEXT.COUNT;

   4921  4 000626   200025 470500                    LDP0    REC$,,AUTO
         4 000627   000000 236100                    LDQ     0,,PR0
         4 000630   000033 772000                    QRL     27
         4 000631   200013 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      383     4922    3             PINCRC(ADDR(OUTPUT_LINE), 5) -> CHAR$STRING =

   4922  4 000632   000000 620006                    EAX0    0,QL
         4 000633   200013 721100                    LXL1    CHAR_STRING_SIZE,,AUTO
         4 000634   040140 100540                    MLR     fill='040'O
         4 000635   000004 000010                    ADSC9   4,,PR0                   cn=0,n=*X0
         4 000636   200027 200011                    ADSC9   OUTPUT_LINE+1,,AUTO      cn=1,n=*X1

      384     4923    3                 REC$ -> QT$SETTEXT.TEXT;
      385     4924
      386     4925    3             FPT_WRITE.BUF_.BOUND = CHAR_STRING_SIZE + 4;

   4925  4 000637   200013 236100                    LDQ     CHAR_STRING_SIZE,,AUTO
         4 000640   000004 036007                    ADLQ    4,DL
         4 000641   000020 736000                    QLS     16
         4 000642   000210 676000 2                  ERQ     FPT_WRITE+4
         4 000643   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000644   000210 656000 2                  ERSQ    FPT_WRITE+4
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:56   

      387     4926    3             CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   4926  4 000645   000204 630400 2                  EPPR0   FPT_WRITE
         4 000646   440001 713400                    CLIMB   alt,write
         4 000647   401400 401760                    pmme    nvectors=4
         4 000650   000700 702000 4                  TSX2    MON_ERR

      388     4927
      389     4928    3             REC$ = PINCRW(REC$, SIZEW(REC$ -> QT$SETTEXT));

   4928  4 000651   200025 470500                    LDP0    REC$,,AUTO
         4 000652   000000 236100                    LDQ     0,,PR0
         4 000653   000033 772000                    QRL     27
         4 000654   000020 620006                    EAX0    16,QL
         4 000655   000000 636010                    EAQ     0,X0
         4 000656   000022 772000                    QRL     18
         4 000657   000011 402007                    MPY     9,DL
         4 000660   000043 036007                    ADLQ    35,DL
         4 000661   000044 506007                    DIV     36,DL
         4 000662   000022 736000                    QLS     18
         4 000663   200025 036100                    ADLQ    REC$,,AUTO
         4 000664   200025 756100                    STQ     REC$,,AUTO

      390     4929    3             I = I + 1;

   4929  4 000665   200016 054100                    AOS     I,,AUTO

      391     4930    3           END;

   4930  4 000666   000031 470400 xsym               LDP0    QT_GLOBAL+25
         4 000667   000023 236100                    LDQ     19,,PR0
         4 000670   000011 772000                    QRL     9
         4 000671   000777 376007                    ANQ     511,DL
         4 000672   200016 116100                    CMPQ    I,,AUTO
         4 000673   000676 604000 4                  TMI     s:4932
         4 000674   000003 234000 xsym               SZN     QT_GLOBAL+3
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:57   
         4 000675   000623 605000 4                  TPL     s:4920

      392     4931
      393     4932    2           RETURN;

   4932  4 000676   200124 221300                    LDX1  ! FORM_INFO+12,,AUTO
         4 000677   000001 702211                    TSX2  ! 1,X1

      394     4933
      395     4934    2   MON_ERR:
      396     4935    2           CALL QTC$MON_ERR('1'B);

   4935  4 000700   000016 630400 5     MON_ERR      EPPR0   14
         4 000701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000702   000000 701000 xent               TSX1    QTC$MON_ERR
         4 000703   000000 011000                    NOP     0

      397     4936
      398     4937    2   END PRINT_ENTRY;

   4937  4 000704   200124 221300                    LDX1  ! FORM_INFO+12,,AUTO
         4 000705   000001 702211                    TSX2  ! 1,X1

      399     4938                %PAGE(ARG="PRINT_FORM", PAGE=YES);

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:58   
              4955    2   /***************************************************************************
              4956    2    *                                                                         *
              4957    2    *                                 PRINT_FORM                              *
              4958    2    *                                                                         *
              4959    2    ***************************************************************************/

      400     4963    1   PRINT_FORM:

   4963  4 000706   200124 741300       PRINT_FORM   STX1  ! FORM_INFO+12,,AUTO

      401     4964    1           PROC;
      402     4965
      403     4966    2           IF HEADING_FLAG THEN

   4966  4 000707   200007 234100                    SZN     HEADING_FLAG,,AUTO
         4 000710   000725 605000 4                  TPL     s:4974

      404     4967    3             DO;

      405     4968    3               HEADING_FLAG = '0'B;

   4968  4 000711   200007 450100                    STZ     HEADING_FLAG,,AUTO

      406     4969    3               OUTPUT_LINE = FORM_HDR_C;

   4969  4 000712   040100 100400                    MLR     fill='040'O
         4 000713   000107 000054 3                  ADSC9   FORM_HDR_C               cn=0,n=44
         4 000714   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      407     4970    3               FPT_WRITE.BUF_.BOUND = SIZEC(FORM_HDR_C) - 1;

   4970  4 000715   000210 236000 2                  LDQ     FPT_WRITE+4
         4 000716   177777 376007                    ANQ     65535,DL
         4 000717   000020 276000 5                  ORQ     16
         4 000720   000210 756000 2                  STQ     FPT_WRITE+4

      408     4971    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:59   

   4971  4 000721   000204 630400 2                  EPPR0   FPT_WRITE
         4 000722   440001 713400                    CLIMB   alt,write
         4 000723   401400 401760                    pmme    nvectors=4
         4 000724   001055 702000 4                  TSX2    MON_ERR

      409     4972    3             END;

      410     4973
      411     4974    2           NAMES_LISTED = NAMES_LISTED + 1;

   4974  4 000725   200015 054100                    AOS     NAMES_LISTED,,AUTO

      412     4975    2           FORM_INFO_TEXT = 'A';

   4975  4 000726   040100 100400                    MLR     fill='040'O
         4 000727   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000730   200110 000051                    ADSC9   FORM_INFO,,AUTO          cn=0,n=41

      413     4976
      414     4977    2           FORM_INFO.NAME = FOUND_MSGTYP;

   4977  4 000731   040100 100500                    MLR     fill='040'O
         4 000732   200005 000010                    ADSC9   FOUND_MSGTYP,,AUTO       cn=0,n=8
         4 000733   200110 200010                    ADSC9   FORM_INFO,,AUTO          cn=1,n=8

      415     4978
      416     4979    2           UTS = QT$FORM.UTS;

   4979  4 000734   000033 470400 xsym               LDP0    QT_GLOBAL+27
         4 000735   000001 235100                    LDA     1,,PR0
         4 000736   000040 755000 2                  STA     UTS

      417     4980    2           CALL M$TIME(FPT_TIME);

   4980  4 000737   000170 630400 2                  EPPR0   FPT_TIME
         4 000740   020004 713400                    CLIMB   8196
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:60   
         4 000741   402000 401760                    pmme    nvectors=5

      418     4981    2           FORM_INFO.TIME = SUBSTR(TIME, 0, 5);

   4981  4 000742   040100 100400                    MLR     fill='040'O
         4 000743   000034 000005 2                  ADSC9   TIME                     cn=0,n=5
         4 000744   200112 400005                    ADSC9   FORM_INFO+2,,AUTO        cn=2,n=5

      419     4982    2           FORM_INFO.DATE = DATE;

   4982  4 000745   040100 100400                    MLR     fill='040'O
         4 000746   000031 000012 2                  ADSC9   DATE                     cn=0,n=10
         4 000747   200114 000012                    ADSC9   FORM_INFO+4,,AUTO        cn=0,n=10

      420     4983
      421     4984    2           IF QT$FORM.FLAGS.JOURNAL THEN

   4984  4 000750   000033 470400 xsym               LDP0    QT_GLOBAL+27
         4 000751   000000 234100                    SZN     0,,PR0
         4 000752   000760 605000 4                  TPL     s:4990

      422     4985    3             DO;

      423     4986    3               FORM_INFO.JOURNAL = 'ON';

   4986  4 000753   000125 236000 3                  LDQ     CODE_NFL+1
         4 000754   777777 376003                    ANQ     -1,DU
         4 000755   040040 276007                    ORQ     16416,DL
         4 000756   200117 552170                    STBQ    FORM_INFO+7,'70'O,AUTO

      424     4987    3             END;

   4987  4 000757   000762 710000 4                  TRA     s:4993

      425     4988    2           ELSE
      426     4989    3             DO;

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:61   
      427     4990    3               FORM_INFO.JOURNAL = 'OFF';

   4990  4 000760   000126 236000 3                  LDQ     CODE_NFL+2
         4 000761   200117 552170                    STBQ    FORM_INFO+7,'70'O,AUTO

      428     4991    3             END;

      429     4992
      430     4993    2           IF QT$FORM.FLAGS.ONEREPORT THEN

   4993  4 000762   000000 236100                    LDQ     0,,PR0
         4 000763   200000 316003                    CANQ    65536,DU
         4 000764   000771 600000 4                  TZE     s:4999

      431     4994    3             DO;

      432     4995    3               FORM_INFO.ONEREPORT = 'ON';

   4995  4 000765   040100 100400                    MLR     fill='040'O
         4 000766   000125 000002 3                  ADSC9   CODE_NFL+1               cn=0,n=2
         4 000767   200121 400003                    ADSC9   FORM_INFO+9,,AUTO        cn=2,n=3

      433     4996    3             END;

   4996  4 000770   000774 710000 4                  TRA     s:5002

      434     4997    2           ELSE
      435     4998    3             DO;

      436     4999    3               FORM_INFO.ONEREPORT = 'OFF';

   4999  4 000771   040100 100400                    MLR     fill='040'O
         4 000772   000126 000003 3                  ADSC9   CODE_NFL+2               cn=0,n=3
         4 000773   200121 400003                    ADSC9   FORM_INFO+9,,AUTO        cn=2,n=3

      437     5000    3             END;

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:62   
      438     5001
      439     5002    2           OUTPUT_LINE = FORM_INFO_TEXT;

   5002  4 000774   040100 100500                    MLR     fill='040'O
         4 000775   200110 000051                    ADSC9   FORM_INFO,,AUTO          cn=0,n=41
         4 000776   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      440     5003    2           FPT_WRITE.BUF_.BOUND = SIZEC(FORM_INFO_TEXT) - 1;

   5003  4 000777   000210 236000 2                  LDQ     FPT_WRITE+4
         4 001000   177777 376007                    ANQ     65535,DL
         4 001001   000012 276003                    ORQ     10,DU
         4 001002   000210 756000 2                  STQ     FPT_WRITE+4

      441     5004    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   5004  4 001003   000204 630400 2                  EPPR0   FPT_WRITE
         4 001004   440001 713400                    CLIMB   alt,write
         4 001005   401400 401760                    pmme    nvectors=4
         4 001006   001055 702000 4                  TSX2    MON_ERR

      442     5005
      443     5006    2           VLP_NAME = QT$FORM.FP.NAME;

   5006  4 001007   000033 470400 xsym               LDP0    QT_GLOBAL+27
         4 001010   000000 100500                    MLR     fill='000'O
         4 001011   000002 000040                    ADSC9   2,,PR0                   cn=0,n=32
         4 001012   000224 000040 2                  ADSC9   VLP_NAME                 cn=0,n=32

      444     5007    2           VLP_ACCT.ACCT# = QT$FORM.FP.ACCT;

   5007  4 001013   040000 100500                    MLR     fill='040'O
         4 001014   000012 000010                    ADSC9   10,,PR0                  cn=0,n=8
         4 001015   000234 000010 2                  ADSC9   VLP_ACCT                 cn=0,n=8

      445     5008    2           VLP_PASS.PASS# = QT$FORM.FP.PASS;

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:63   
   5008  4 001016   040000 100500                    MLR     fill='040'O
         4 001017   000014 000010                    ADSC9   12,,PR0                  cn=0,n=8
         4 001020   000236 000010 2                  ADSC9   VLP_PASS                 cn=0,n=8

      446     5009    2           VLP_SN.SN#(0) = QT$FORM.FP.SN;

   5009  4 001021   040000 100500                    MLR     fill='040'O
         4 001022   000016 000006                    ADSC9   14,,PR0                  cn=0,n=6
         4 001023   000241 000006 2                  ADSC9   VLP_SN+1                 cn=0,n=6

      447     5010    2           CALL M$UNFID(FPT_UNFID) ALTRET(MON_ERR);

   5010  4 001024   000142 630400 2                  EPPR0   FPT_UNFID
         4 001025   420021 713400                    CLIMB   alt,+8209
         4 001026   404400 401760                    pmme    nvectors=10
         4 001027   001055 702000 4                  TSX2    MON_ERR

      448     5011
      449     5012    2           OUTPUT_LINE = 'A  FP=';

   5012  4 001030   040100 100400                    MLR     fill='040'O
         4 001031   000131 000006 3                  ADSC9   CODE_NFL+5               cn=0,n=6
         4 001032   200026 000203                    ADSC9   OUTPUT_LINE,,AUTO        cn=0,n=131

      450     5013    2           CHAR_STRING_SIZE = UNFID_SIZE;

   5013  4 001033   000041 235000 2                  LDA     UNFID_SIZE
         4 001034   200013 755100                    STA     CHAR_STRING_SIZE,,AUTO

      451     5014    2           PINCRC(ADDR(OUTPUT_LINE), 6) -> CHAR$STRING = FID;

   5014  4 001035   000000 620005                    EAX0    0,AL
         4 001036   040140 100400                    MLR     fill='040'O
         4 001037   000000 000144 2                  ADSC9   FID                      cn=0,n=100
         4 001040   200027 400010                    ADSC9   OUTPUT_LINE+1,,AUTO      cn=2,n=*X0

      452     5015
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:64   
      453     5016    2           FPT_WRITE.BUF_.BOUND = UNFID_SIZE + 5;

   5016  4 001041   000041 236000 2                  LDQ     UNFID_SIZE
         4 001042   000005 036007                    ADLQ    5,DL
         4 001043   000020 736000                    QLS     16
         4 001044   000210 676000 2                  ERQ     FPT_WRITE+4
         4 001045   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001046   000210 656000 2                  ERSQ    FPT_WRITE+4

      454     5017    2           CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   5017  4 001047   000204 630400 2                  EPPR0   FPT_WRITE
         4 001050   440001 713400                    CLIMB   alt,write
         4 001051   401400 401760                    pmme    nvectors=4
         4 001052   001055 702000 4                  TSX2    MON_ERR

      455     5018
      456     5019    2           RETURN;

   5019  4 001053   200124 221300                    LDX1  ! FORM_INFO+12,,AUTO
         4 001054   000001 702211                    TSX2  ! 1,X1

      457     5020
      458     5021    2   MON_ERR:
      459     5022    2           CALL QTC$MON_ERR('1'B);

   5022  4 001055   000016 630400 5     MON_ERR      EPPR0   14
         4 001056   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001057   000000 701000 xent               TSX1    QTC$MON_ERR
         4 001060   000000 011000                    NOP     0

      460     5023
      461     5024    2   END PRINT_FORM;

   5024  4 001061   200124 221300                    LDX1  ! FORM_INFO+12,,AUTO
         4 001062   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:65   
      462     5025    1   END QTB$LIST;

   5025  4 001063   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:66   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QT_PERR_C.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTB$LIST.
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:67   

 **** Variables and constants ****

  ****  Section 002  Data  QTB$LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    31-0-0/c CHAR(10)    r     1 DATE                      37-0-0/c CHAR(3)     r     1 DAY
     0-0-0/c CHAR(100)   r     1 FID                      220-0-0/d STRC(144)   r     1 FPT_CORRES
    50-0-0/d STRC(2088)  r     1 FPT_OPEN                 170-0-0/d STRC(432)   r     1 FPT_TIME
   142-0-0/d STRC(792)   r     1 FPT_UNFID                204-0-0/d STRC(432)   r     1 FPT_WRITE
    45-0-0/c STRC(81)    r     1 TEXTC_MSGTYP              42-0-0/c STRC(90)    r     1 TEXTC_NUM
    34-0-0/c CHAR(11)    r     1 TIME                      41-0-0/w UBIN        r     1 UNFID_SIZE
    40-0-0/w UBIN        r     1 UTS                      234-0-0/c STRC(72)    r     1 VLP_ACCT
   224-0-0/c STRC(288)   r     1 VLP_NAME                 236-0-0/c STRC(72)    r     1 VLP_PASS
   240-0-0/d STRC(90)    r     1 VLP_SN                   244-0-0/c STRC(72)    r     1 VLP_WSN

  ****  Section 003 RoData QTB$LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   124-0-0/b STRC        r     1 CODE_NFL                 122-0-0/b STRC        r     1 CODE_NLISTED
   123-0-0/b STRC        r     1 CODE_NTL                  66-0-0/c CHAR(68)    r     1 ENTRY_HDR_C
   107-0-0/c CHAR(44)    r     1 FORM_HDR_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/w BIT         r     1 ATTRIBUTES_FLAG           12-0-0/w SBIN        r     1 BYTE_COUNT
    13-0-0/w SBIN        r     1 CHAR_STRING_SIZE          67-0-0/c STRC(585)   r     1 ENTRY_INFO
    67-0-0/c CHAR(65)    r     1 ENTRY_INFO_TEXT          110-0-0/c STRC(369)   r     1 FORM_INFO
   110-0-0/c CHAR(41)    r     1 FORM_INFO_TEXT             5-0-0/c CHAR(8)     r     1 FOUND_MSGTYP
     7-0-0/w BIT         r     1 HEADING_FLAG              16-0-0/w SBIN        r     1 I
     3-0-0/c CHAR(8)     r     1 MSGTYP                    15-0-0/w SBIN        r     1 NAMES_LISTED
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:68   
    14-0-0/w SBIN        r     1 NSUBLKS                   22-0-0/w SBIN        r     1 NUM
    26-0-0/c CHAR(131)   r     1 OUTPUT_LINE               17-0-0/w SBIN        r     1 PAGE_WIDTH
    20-0-0/w SBIN        r     1 POS                       25-0-0/w PTR         r     1 REC$
    23-0-0/w SBIN        r     1 SIZE                      24-0-0/w PTR         r     1 SUBLK$
    21-0-0/w SBIN        r     1 TYPE                      10-0-0/w BIT         r     1 WILD_FLAG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(261)   r     1 QT_CMDBLK                  0-0-0/w STRC(1872)  r     1 QT_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 CHAR$STRING                0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$LO                       0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(936)   r     1 QT$ENTRY
     0-0-0/w STRC(828)   r     1 QT$FORM                    0-0-0/w ASTR(144)   r     1 QT$SETTEXT


   Procedure QTB$LIST requires 564 words for executable code.
   Procedure QTB$LIST requires 90 words of local(AUTO) storage.

    No errors detected in file QTB$LIST.:E05TSI    .
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:69   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:70   
          MINI XREF LISTING

ATTRIBUTES_FLAG
      4123**DCL      4647<<ASSIGN   4677<<ASSIGN   4688<<ASSIGN   4704>>IF       4729>>IF
BYTE_COUNT
      4125**DCL      4644<<ASSIGN   4729>>IF       4731>>ASSIGN   4791>>IF       4793>>ASSIGN   4794<<ASSIGN
      4799>>ASSIGN   4801<<ASSIGN   4801>>ASSIGN   4803>>IF       4805<<ASSIGN   4805>>ASSIGN   4809<<ASSIGN
CHAR$STRING
      3910**DCL      4799<<ASSIGN   4911<<ASSIGN   4922<<ASSIGN   5014<<ASSIGN
CHAR_STRING_SIZE
      4126**DCL      3910--IMP-SIZ  4789<<ASSIGN   4799>>ASSIGN   4910<<ASSIGN   4911>>ASSIGN   4921<<ASSIGN
      4922>>ASSIGN   4925>>ASSIGN   5013<<ASSIGN   5014>>ASSIGN
CODE_NFL
      4268**DCL      4751>>ASSIGN   4753<>CALL
CODE_NLISTED
      4254**DCL      4739<>CALL
CODE_NTL
      4261**DCL      4744>>ASSIGN   4745<>CALL
DATE
      3937**DCL      4459--DCLINIT  4460--DCLINIT  4862>>ASSIGN   4982>>ASSIGN
DAY
      3939**DCL      4462--DCLINIT
ENTRY_HDR_C
      4091**DCL      4849>>ASSIGN   4850--ASSIGN
ENTRY_INFO
      4195**DCL      4214--REDEF
ENTRY_INFO.DATE
      4201**DCL      4862<<ASSIGN
ENTRY_INFO.DEBUGGER
      4211**DCL      4888<<ASSIGN
ENTRY_INFO.JOURNAL
      4213**DCL      4892<<ASSIGN   4896<<ASSIGN
ENTRY_INFO.LOCK
      4207**DCL      4872<<ASSIGN   4876<<ASSIGN
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:71   
ENTRY_INFO.MSG
      4209**DCL      4881<<ASSIGN   4885<<ASSIGN
ENTRY_INFO.MXACT
      4205**DCL      4868--CALL
ENTRY_INFO.NAME
      4197**DCL      4857<<ASSIGN
ENTRY_INFO.PRIO
      4203**DCL      4865--CALL
ENTRY_INFO.TIME
      4199**DCL      4861<<ASSIGN
ENTRY_INFO_TEXT
      4214**DCL      4855<<ASSIGN   4899>>ASSIGN   4900--ASSIGN
F$DCB.ACTPOS
      3802**DCL      3802--REDEF
F$DCB.ARS#
      3776**DCL      3776--REDEF
F$DCB.ATTR
      3795**DCL      3796--REDEF
F$DCB.BORROW
      3810**DCL      3810--REDEF    3810--REDEF    3810--REDEF
F$DCB.DCBNAME.L
      3824**DCL      3824--IMP-SIZ
F$DCB.EOMCHAR#
      3780**DCL      3780--REDEF
F$DCB.FLDID
      3805**DCL      3805--REDEF
F$DCB.FORM$
      3799**DCL      3799--REDEF
F$DCB.FSECT
      3815**DCL      3815--REDEF
F$DCB.FSN#
      3792**DCL      3792--REDEF    3792--REDEF    3793--REDEF
F$DCB.HEADER$
      3798**DCL      3798--REDEF
F$DCB.IXTNSIZE#
      3796**DCL      3796--REDEF
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:72   
F$DCB.LASTSTA$
      3785**DCL      3785--REDEF
F$DCB.LVL
      3811**DCL      3811--REDEF
F$DCB.NAME#.C
      3786**DCL      3786--REDEF
F$DCB.NOEOF
      3808**DCL      3808--REDEF
F$DCB.NRECS#
      3797**DCL      3797--REDEF
F$DCB.NRECX
      3816**DCL      3816--REDEF
F$DCB.OHDR
      3808**DCL      3808--REDEF
F$DCB.ORG#
      3791**DCL      3791--REDEF
F$DCB.PRECNO
      3814**DCL      3814--REDEF
F$DCB.RCSZ
      3820**DCL      3820--REDEF
F$DCB.RES#
      3787**DCL      3787--REDEF
F$DCB.SETX
      3799**DCL      3799--REDEF
F$DCB.TAB$
      3799**DCL      3799--REDEF
F$DCB.TDA
      3813**DCL      3814--REDEF
F$DCB.WIDTH#
      3783**DCL      4656>>ASSIGN   4660>>ASSIGN
F$DCB.WSN#
      3787**DCL      3787--REDEF
FID
      3936**DCL      4439--DCLINIT  4911>>ASSIGN   5014>>ASSIGN
FORM_HDR_C
      4092**DCL      4969>>ASSIGN   4970--ASSIGN
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:73   
FORM_INFO
      4216**DCL      4227--REDEF
FORM_INFO.DATE
      4222**DCL      4982<<ASSIGN
FORM_INFO.JOURNAL
      4224**DCL      4986<<ASSIGN   4990<<ASSIGN
FORM_INFO.NAME
      4218**DCL      4977<<ASSIGN
FORM_INFO.ONEREPORT
      4226**DCL      4995<<ASSIGN   4999<<ASSIGN
FORM_INFO.TIME
      4220**DCL      4981<<ASSIGN
FORM_INFO_TEXT
      4227**DCL      4975<<ASSIGN   5002>>ASSIGN   5003--ASSIGN
FOUND_MSGTYP
      4119**DCL      4702<>CALL     4799>>ASSIGN   4857>>ASSIGN   4977>>ASSIGN
FPT_CORRES
      4511**DCL      4654<>CALL
FPT_CORRES.V
      4511**DCL      4511--DCLINIT
FPT_CORRES.V.DCB1#
      4511**DCL      4652<<ASSIGN
FPT_CORRES.V.DCB2#
      4512**DCL      4653<<ASSIGN
FPT_OPEN.ACSVEH_
      4383**DCL      4384--REDEF
FPT_OPEN.ALTKEYS_
      4389**DCL      4390--REDEF    4390--REDEF
FPT_OPEN.HDR_
      4388**DCL      4389--REDEF
FPT_OPEN.TAB_
      4387**DCL      4388--REDEF
FPT_OPEN.UHL_
      4381**DCL      4382--REDEF    4382--REDEF
FPT_OPEN.V
      4390**DCL      4381--DCLINIT
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:74   
FPT_OPEN.V.ASN#
      4400**DCL      4442--DCLINIT
FPT_OPEN.V.FSN#
      4421**DCL      4421--REDEF    4421--REDEF
FPT_OPEN.V.RES#
      4405**DCL      4442--DCLINIT
FPT_OPEN.WSN_
      4387**DCL      4387--REDEF
FPT_TIME
      4459**DCL      4860<>CALL     4980<>CALL
FPT_TIME.V
      4463**DCL      4459--DCLINIT
FPT_UNFID
      4439**DCL      4907<>CALL     5010<>CALL
FPT_UNFID.V
      4443**DCL      4439--DCLINIT
FPT_WRITE
      4485**DCL      4732<>CALL     4795<>CALL     4851<>CALL     4901<>CALL     4914<>CALL     4926<>CALL
      4971<>CALL     5004<>CALL     5017<>CALL
FPT_WRITE.BUF_.BOUND
      4485**DCL      4731<<ASSIGN   4793<<ASSIGN   4850<<ASSIGN   4900<<ASSIGN   4913<<ASSIGN   4925<<ASSIGN
      4970<<ASSIGN   5003<<ASSIGN   5016<<ASSIGN
FPT_WRITE.BUF_.BUF$
      4487**DCL      4649<<ASSIGN
FPT_WRITE.STATION_
      4487**DCL      4487--REDEF
FPT_WRITE.V
      4488**DCL      4485--DCLINIT
FPT_WRITE.V.DCB#
      4488**DCL      4661<<ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
      4494**DCL      4494--REDEF
HEADING_FLAG
      4121**DCL      4645<<ASSIGN   4846>>IF       4848<<ASSIGN   4966>>IF       4968<<ASSIGN
I
      4129**DCL      4668<<DOINDEX  4669>>ASSIGN   4916<<ASSIGN   4919>>DOWHILE  4929<<ASSIGN   4929>>ASSIGN
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:75   
LIST_NAME
      4786**PROC     4718--CALL
M$CORRES
        83**DCL-ENT  4654--CALL
M$LO
      3640**DCL      4652>>ASSIGN   4656--ASSIGN
M$TIME
       145**DCL-ENT  4860--CALL     4980--CALL
M$UNFID
       141**DCL-ENT  4907--CALL     5010--CALL
M$WRITE
        79**DCL-ENT  4732--CALL     4795--CALL     4851--CALL     4901--CALL     4914--CALL     4926--CALL
      4971--CALL     5004--CALL     5017--CALL
MON_ERR
      4759**LABEL    4732--CALLALT
MON_ERR IN PROCEDURE LIST_NAME
      4815**LABEL    4795--CALLALT
MON_ERR IN PROCEDURE PRINT_ENTRY
      4935**LABEL    4851--CALLALT  4901--CALLALT  4907--CALLALT  4914--CALLALT  4926--CALLALT
MON_ERR IN PROCEDURE PRINT_FORM
      5022**LABEL    4971--CALLALT  5004--CALLALT  5010--CALLALT  5017--CALLALT
MSGTYP
      4118**DCL      4674<<ASSIGN   4682>>CALLBLT  4702<>CALL     4750>>ASSIGN
NAMES_LISTED
      4128**DCL      4643<<ASSIGN   4735>>IF       4737<>CALL     4742>>IF       4748>>IF       4788<<ASSIGN
      4788>>ASSIGN   4854<<ASSIGN   4854>>ASSIGN   4974<<ASSIGN   4974>>ASSIGN
NOT_FOUND
      4729**LABEL    4702--CALLALT  4723--GOTO
NO_Q1
      4688**LABEL    4682--CALLALT
NSUBLKS
      4127**DCL      4648<<ASSIGN   4668>>DOINDEX
NUM
      4133**DCL      4864<<ASSIGN   4865<>CALL     4867<<ASSIGN   4868<>CALL
OUT$BLK.NSUBLKS
      3882**DCL      4648>>ASSIGN
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:76   
OUT$BLK.SUBLK$
      3903**DCL      4669>>ASSIGN
OUT$SYM.CODE
      3839**DCL      4671>>DOCASE
OUT$SYM.COUNT
      3856**DCL      3859--IMP-SIZ  4674>>ASSIGN
OUT$SYM.TEXT
      3859**DCL      4674>>ASSIGN
OUTPUT_LINE
      4139**DCL      4649--ASSIGN   4650<<ASSIGN   4796<<ASSIGN   4799--ASSIGN   4849<<ASSIGN   4899<<ASSIGN
      4909<<ASSIGN   4911--ASSIGN   4920<<ASSIGN   4922--ASSIGN   4969<<ASSIGN   5002<<ASSIGN   5012<<ASSIGN
      5014--ASSIGN
PAGE_WIDTH
      4130**DCL      4656<<ASSIGN   4660<<ASSIGN   4663>>IF       4663>>IF       4665<<ASSIGN   4791>>IF
      4803>>IF       4809>>ASSIGN
POS
      4131**DCL      4682<<CALLBLT
PRINT_ENTRY
      4844**PROC     4709--CALL
PRINT_FORM
      4964**PROC     4712--CALL
QQC$CONVERT_NUM
      3611**DCL-ENT  4737--CALL     4865--CALL     4868--CALL
QT$ENTRY.DEBUGGER.TEXT
      3712**DCL      4888>>ASSIGN
QT$ENTRY.FLAGS.JOURNAL
      3688**DCL      4890>>IF
QT$ENTRY.FLAGS.MESSAGE
      3686**DCL      4879>>IF
QT$ENTRY.FLAGS.NEW_LOCK
      3684**DCL      4870>>IF
QT$ENTRY.MAXACTIVE
      3694**DCL      4867>>ASSIGN
QT$ENTRY.PRIO
      3715**DCL      4864>>ASSIGN
QT$ENTRY.SET_COUNT
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:77   
      3713**DCL      4919>>DOWHILE
QT$ENTRY.TPAP.ACCT
      3702**DCL      4904>>ASSIGN
QT$ENTRY.TPAP.NAME
      3698**DCL      4903>>ASSIGN
QT$ENTRY.TPAP.PASS
      3704**DCL      4905>>ASSIGN
QT$ENTRY.TPAP.SN
      3706**DCL      4906>>ASSIGN
QT$ENTRY.UTS
      3692**DCL      4859>>ASSIGN
QT$FORM.FLAGS.JOURNAL
      3734**DCL      4984>>IF
QT$FORM.FLAGS.ONEREPORT
      3736**DCL      4993>>IF
QT$FORM.FP.ACCT
      3748**DCL      5007>>ASSIGN
QT$FORM.FP.NAME
      3744**DCL      5006>>ASSIGN
QT$FORM.FP.PASS
      3750**DCL      5008>>ASSIGN
QT$FORM.FP.SN
      3752**DCL      5009>>ASSIGN
QT$FORM.UTS
      3740**DCL      4979>>ASSIGN
QT$SETTEXT
      3760**DCL      4928--ASSIGN
QT$SETTEXT.COUNT
      3761**DCL      3766--IMP-SIZ  4921>>ASSIGN   4922>>ASSIGN   4928>>ASSIGN
QT$SETTEXT.TEXT
      3766**DCL      4922>>ASSIGN
QTC$MON_ERR
      3614**DCL-ENT  4759--CALL     4815--CALL     4935--CALL     5022--CALL
QTC$READ_TRADER
      3613**DCL-ENT  4702--CALL
QT_CMDBLK.CODE
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:78   
       162**DCL      4691>>IF
QT_CMDBLK.MINOR_ERR
       161**DCL      4744<<ASSIGN   4751<<ASSIGN
QT_CMDBLK.OUT$
       161**DCL       162--REDEF    4648>>ASSIGN   4669>>ASSIGN
QT_GLOBAL.BREAK
       158**DCL      4721>>IF       4919>>DOWHILE
QT_GLOBAL.M$DO#
       160**DCL      4653>>ASSIGN   4660--ASSIGN   4661>>ASSIGN
QT_GLOBAL.QT$ENTRY$
       159**DCL      3677--IMP-PTR  4859>>ASSIGN   4864>>ASSIGN   4867>>ASSIGN   4870>>IF       4879>>IF
      4888>>ASSIGN   4890>>IF       4903>>ASSIGN   4904>>ASSIGN   4905>>ASSIGN   4906>>ASSIGN   4919>>DOWHILE
QT_GLOBAL.QT$FORM$
       159**DCL      3731--IMP-PTR  4979>>ASSIGN   4984>>IF       4993>>IF       5006>>ASSIGN   5007>>ASSIGN
      5008>>ASSIGN   5009>>ASSIGN
QT_GLOBAL.QT$SETTEXT$
       159**DCL      3760--IMP-PTR  4917>>ASSIGN
REC$
      4137**DCL      4917<<ASSIGN   4921>>ASSIGN   4922>>ASSIGN   4922>>ASSIGN   4928<<ASSIGN   4928>>ASSIGN
      4928>>ASSIGN   4928>>ASSIGN
SIZE
      4134**DCL      4737<>CALL     4738>>ASSIGN   4865<>CALL     4868<>CALL
SUBLK$
      4136**DCL      4669<<ASSIGN   4671>>DOCASE   4674>>ASSIGN   4674>>ASSIGN
TEXTC_MSGTYP
      4192**DCL      4753--CALL
TEXTC_MSGTYP.L#
      4192**DCL      4752<<ASSIGN
TEXTC_MSGTYP.NAME#
      4192**DCL      4750<<ASSIGN
TEXTC_NUM
      4165**DCL      4739--CALL
TEXTC_NUM.L#
      4165**DCL      4738<<ASSIGN
TEXTC_NUM.NAME#
      4165**DCL      4737--CALL
PL6.E3A0      #001=QTB$LIST File=QTB$LIST.:E05TSI                                WED 07/30/97 05:48 Page:79   
TIME
      3938**DCL      4461--DCLINIT  4462--DCLINIT  4861>>ASSIGN   4981>>ASSIGN
TYPE
      4132**DCL      4693<<ASSIGN   4697<<ASSIGN   4702<>CALL     4706>>DOCASE
UNFID_SIZE
      3942**DCL      4443--DCLINIT  4910>>ASSIGN   4913>>ASSIGN   5013>>ASSIGN   5016>>ASSIGN
UTS
      3941**DCL      4463--DCLINIT  4859<<ASSIGN   4979<<ASSIGN
VLP_ACCT
      4577**DCL      4440--DCLINIT
VLP_ACCT.ACCT#
      4577**DCL      4904<<ASSIGN   5007<<ASSIGN
VLP_CGCP_C.DVBYTE.REREAD#
      3994**DCL      3995--REDEF
VLP_NAME
      4564**DCL      4440--DCLINIT  4903<<ASSIGN   5006<<ASSIGN
VLP_PASS
      4590**DCL      4441--DCLINIT
VLP_PASS.PASS#
      4590**DCL      4905<<ASSIGN   5008<<ASSIGN
VLP_SN
      4603**DCL      4441--DCLINIT
VLP_SN.SN#
      4603**DCL      4906<<ASSIGN   5009<<ASSIGN
VLP_WSN
      4616**DCL      4441--DCLINIT
WILD_FLAG
      4122**DCL      4646<<ASSIGN   4683<<ASSIGN   4742>>IF       4748>>IF
XUR$ERRMSG
      3612**DCL-ENT  4739--CALL     4745--CALL     4753--CALL
