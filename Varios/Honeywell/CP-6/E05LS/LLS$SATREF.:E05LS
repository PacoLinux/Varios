VERSION E05

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:1    
        1        1        /*M* LLS$SATREF - Reference satisfier                               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,ENI=4,
        8        8             CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC*/
        9        9        /*F* NAME:         LLS$SATREF
       10       10             PURPOSE:      Satisfies external references on a module by
       11       11                           module basis.  This module also maintains a count
       12       12                           of number of unsatisfied references and writes
       13       13                           an appropriate "error message" for each ref.     */
       14       14        LLS$SATREF: PROC (REF$, NREFS, ROOT$, NUNSATS, TYPE, DEFN$, REFN$, OU$);
       15       15        %INCLUDE LL_DATA_R;
       16       51        %INCLUDE LL_SUBS_C;
       17      180        %INCLUDE LL_MACS_C;
       18      534        %INCLUDE B$OBJECT_C;
       19     3964        %INCLUDE CP_6;
       20     4045        %B$DNAME;
       21     4064        %LL$UNSATREF ( NAME = B$FEP_UNSATREF );
       22     4077        %B$RECORDSUBS;
       23     4105        %B$FEP_RUKEY;
       24     4129        %FPT_GDS ( FPTN = GET_NAME_SPACE,
       25     4130         SEGSIZE = 1024,
       26     4131         RESULTS = VLP_NAME_SPACE );
       27     4147        %FPT_GDS ( FPTN = GET_ENTREF_SPACE,
       28     4148         SEGSIZE = 1024,
       29     4149         RESULTS = VLP_ENTREF_SPACE );
       30     4165        %FPT_GDS ( FPTN = GET_SYMREF_SPACE,
       31     4166         SEGSIZE = 1024,
       32     4167         RESULTS = VLP_SYMREF_SPACE );
       33     4183        %VLP_VECTOR ( FPTN = VLP_NAME_SPACE );
       34     4198        %VLP_VECTOR ( FPTN = VLP_ENTREF_SPACE );
       35     4213        %VLP_VECTOR ( FPTN = VLP_SYMREF_SPACE );
       36     4228        %B$EDEF ( NAME = LL_ENTDEF );
       37     4298        %B$SDEF ( NAME = LL_SYMDEF );
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:2    
       38     4352    1   DCL REF$ PTR; /* Pointer to ref entries */
       39     4353    1   DCL NREFS UBIN WORD ALIGNED; /* Number of ref entries */
       40     4354    1   DCL ROOT$ PTR; /* Pointer to root of tree */
       41     4355    1   DCL NUNSATS UBIN WORD ALIGNED; /* Count of unsatisfied refs */
       42     4356    1   DCL TYPE UBIN WORD ALIGNED; /* Ref type (ENTREF/SYMREF) */
       43     4357    1   DCL DEFN$ PTR; /* Pointer to def name table */
       44     4358    1   DCL REFN$ PTR; /* Pointer to ref name table */
       45     4359    1   DCL OU$ PTR; /* Pointer to o.u. entry */
       46     4360    1   DCL REF_PTR$ PTR;
       47     4361    1   DCL DEF_PTR$ PTR;
       48     4362    1   DCL REFN_PTR$ PTR;
       49     4363    1   DCL DEFN_PTR$ PTR;
       50     4364    1   DCL TPTR$ PTR;
       51     4365    1   DCL TEMP UBIN WORD ALIGNED;
       52     4366    1   DCL TEMP1 UBIN WORD ALIGNED;
       53     4367    1   DCL VALUE UBIN WORD ALIGNED;
       54     4368    1   DCL ISADDR UBIN WORD BASED ALIGNED;
       55     4369    1   DCL NOT_FOUND# BIT(1) UNAL;
       56     4370         /**/
       57     4371         /**/
       58     4372    1   DCL 1 TEXTC STATIC ALIGNED,
       59     4373    1         2 COUNT UBIN BYTE UNAL,
       60     4374    1         2 STRING CHAR(7) UNAL,
       61     4375    1         2 BYTES(0:6) REDEF STRING CHAR(1) UNAL;
       62     4376    1   DCL TEXTC$ PTR CONSTANT INIT(ADDR(TEXTC));
       63     4377    1   DCL 1 B_TEXTC BASED(TEXTC$) ALIGNED,
       64     4378    1         2 COUNT UBIN BYTE UNAL,
       65     4379    1         2 STRING CHAR(B_TEXTC.COUNT) UNAL;
       66     4380         /**/
       67     4381        %LL$NODE ( NAME = TREE );
       68     4413        %LL$OU_ENTRY ( NAME = OU_ENTRY );
       69     4461        %B$EREF ( NAME = REF );
       70     4504        %B$EDEF ( NAME = DEF );
       71     4574    1   DCL I SBIN WORD ALIGNED;
       72     4575    1   DCL J SBIN WORD ALIGNED;
       73     4576    1   DCL LLM$MON_SVC ENTRY(4) ALTRET;
       74     4577    1   DCL LLS$SAYREFS ENTRY;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:3    
       75     4578    1   DCL ALREADY_YELLED# BIT(1) STATIC INIT ('0'B);
       76     4579    1   DCL OU_FID (0:0) CHAR(50) BASED ALIGNED;
       77     4580    1   DCL BUFFER_INDEX UBIN WORD ALIGNED;
       78     4581    1   DCL REGION UBIN BYTE;
       79     4582    1   DCL NEXT_REGION UBIN BYTE;
       80     4583        %B$HEAD ( NAME = LL_HEAD,
       81     4584         STCLASS = SYMREF );
       82     4784        %EJECT;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:4    
       83     4785    1   BEGIN:
       84     4786         /**/
       85     4787         /*
       86     4788            If TYPE is 0, write the unsat records into the run unit.
       87     4789         */
       88     4790         /**/
       89     4791    2       IF TYPE = 0 THEN DO;
       90     4792    3           IF LL_UREF_NAME_CUR > 0 THEN DO;
       91     4793         /**/
       92     4794         /*
       93     4795            Sort the SYMREF record by symbol name.
       94     4796         */
       95     4797         /**/
       96     4798    3               CALL LLS$SORT ( LL_UREF_NAME$, LL_U_SYMREF$, LL_U_SYMREF_CUR );
       97     4799    3               CALL LLS$SORT ( LL_UREF_NAME$, LL_U_ENTREF$, LL_U_ENTREF_CUR );
       98     4800         /**/
       99     4801         /*
      100     4802            Tell how many unsatisfied prefs and srefs there were.
      101     4803         */
      102     4804         /**/
      103     4805    4               IF LL_U_PRIMARY_ENTREF_COUNT > 0 THEN DO;
      104     4806    4                   CALL LLS$BINDEC ( LL_U_PRIMARY_ENTREF_COUNT );
      105     4807    4                   CALL INSERT ( LL_DOBUF, 0,,
      106     4808    4                      'A  ***',
      107     4809    4                      B_TEXTC.STRING,
      108     4810    4                      ' unsatisfied primary entry reference(s)' );
      109     4811    4                   CALL LLM$MON_SVC (LL#WRITEDO);
      110     4812    4                   END;
      111     4813    4               IF LL_U_SECONDARY_ENTREF_COUNT > 0 THEN DO;
      112     4814    4                   CALL LLS$BINDEC ( LL_U_SECONDARY_ENTREF_COUNT );
      113     4815    4                   CALL INSERT ( LL_DOBUF, 0,,
      114     4816    4                      'A  ***',
      115     4817    4                      B_TEXTC.STRING,
      116     4818    4                      ' unsatisfied secondary entry reference(s)');
      117     4819    4                   CALL LLM$MON_SVC (LL#WRITEDO);
      118     4820    4                   END;
      119     4821    4               IF LL_U_PRIMARY_SYMREF_COUNT > 0 THEN DO;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:5    
      120     4822    4                   CALL LLS$BINDEC ( LL_U_PRIMARY_SYMREF_COUNT );
      121     4823    4                   CALL INSERT ( LL_DOBUF,0,,
      122     4824    4                      'A  ***',
      123     4825    4                      B_TEXTC.STRING,
      124     4826    4                      ' unsatisfied primary data reference(s)');
      125     4827    4                   CALL LLM$MON_SVC (LL#WRITEDO);
      126     4828    4                   END;
      127     4829    4               IF LL_U_SECONDARY_SYMREF_COUNT > 0 THEN DO;
      128     4830    4                   CALL LLS$BINDEC ( LL_U_SECONDARY_SYMREF_COUNT );
      129     4831    4                   CALL INSERT ( LL_DOBUF,0,,
      130     4832    4                      'A  ***',
      131     4833    4                      B_TEXTC.STRING,
      132     4834    4                      ' unsatisfied secondary data reference(s)');
      133     4835    4                   CALL LLM$MON_SVC (LL#WRITEDO);
      134     4836    4                   END;
      135     4837         /**/
      136     4838         /*
      137     4839            Decide whether or not to call LLS$SAYREFS depending on the map
      138     4840            option.  If MAP has been specified, LLD$MAP will call LLS$SAYREFS
      139     4841            to process the ref records after setting up data segments for
      140     4842            ref names, for entref records, and for symref records and checking
      141     4843            LLS_INIT# to make sure that this is not a MAP only request.
      142     4844         */
      143     4845         /**/
      144     4846    4               IF NOT LL_FLAGS.MAP# THEN DO;
      145     4847    4                   LL_DOBUF = 'C';
      146     4848    4                   CALL LLM$MON_SVC (LL#WRITEDO);
      147     4849    4                   CALL LLS$SAYREFS;
      148     4850    4                   END;
      149     4851         /**/
      150     4852         /*
      151     4853            Write the SYMREF record(s).
      152     4854         */
      153     4855         /**/
      154     4856    3               B$FEP_RUKEY.TYPE = 7; /* SYMREFS */
      155     4857    3               B$FEP_RUKEY.PAGE = 0;
      156     4858    3               TEMP1 = LL_U_SYMREF_CUR;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:6    
      157     4859    4               DO WHILE ( LL_U_SYMREF_CUR > 0 );
      158     4860    5                   IF LL_U_SYMREF_CUR > LL_EDRECSIZE THEN DO;
      159     4861    5                       TEMP = LL_EDRECSIZE * 4 - 1;
      160     4862    5                       LL_U_SYMREF_CUR = LL_U_SYMREF_CUR - LL_EDRECSIZE;
      161     4863    5                       END;
      162     4864    5                   ELSE DO;
      163     4865    5                       TEMP = LL_U_SYMREF_CUR * 4 - 1;
      164     4866    5                       LL_U_SYMREF_CUR = 0;
      165     4867    5                       END;
      166     4868    4                   CALL LLM$MON_SVC (LL#WRITERU, LL_U_SYMREF$,
      167     4869    4                      TEMP, B$FEP_RUKEY);
      168     4870    4                   B$FEP_RUKEY.PAGE = B$FEP_RUKEY.PAGE + 1;
      169     4871    4                   END;
      170     4872    3               LL_U_SYMREF_CUR = TEMP1;
      171     4873         /**/
      172     4874         /*
      173     4875            Write the ENTREF record(s).
      174     4876         */
      175     4877         /**/
      176     4878    3               B$FEP_RUKEY.TYPE = 5; /* ENTREFS */
      177     4879    3               B$FEP_RUKEY.PAGE = 0;
      178     4880    3               TEMP1 = LL_U_ENTREF_CUR;
      179     4881    4               DO WHILE ( LL_U_ENTREF_CUR > 0 );
      180     4882    5                   IF LL_U_ENTREF_CUR > LL_EPRECSIZE THEN DO;
      181     4883    5                       TEMP = LL_EPRECSIZE * 4 - 1;
      182     4884    5                       LL_U_ENTREF_CUR = LL_U_SYMREF_CUR - LL_EPRECSIZE;
      183     4885    5                       END;
      184     4886    5                   ELSE DO;
      185     4887    5                       TEMP = LL_U_ENTREF_CUR * 4 - 1;
      186     4888    5                       LL_U_ENTREF_CUR = 0;
      187     4889    5                       END;
      188     4890    4                   CALL LLM$MON_SVC (LL#WRITERU, LL_U_ENTREF$,
      189     4891    4                      TEMP, B$FEP_RUKEY);
      190     4892    4                   B$FEP_RUKEY.PAGE = B$FEP_RUKEY.PAGE + 1;
      191     4893    4                   END;
      192     4894    3               LL_U_ENTREF_CUR = TEMP1;
      193     4895         /**/
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:7    
      194     4896         /*
      195     4897            Write the ref names record.
      196     4898         */
      197     4899         /**/
      198     4900    3               IF LL_HEAD.NRECSIZE < LL_UREF_NAME_CUR THEN
      199     4901    3                   LL_HEAD.NRECSIZE = LL_UREF_NAME_CUR;
      200     4902    3               B$FEP_RUKEY.TYPE = 2; /* REF NAMES */
      201     4903    3               B$FEP_RUKEY.PAGE = 0;
      202     4904    3               TEMP = LL_UREF_NAME_CUR * 4 - 1;
      203     4905    3               CALL LLM$MON_SVC (LL#WRITERU, LL_UREF_NAME$, TEMP,
      204     4906    3                  B$FEP_RUKEY);
      205     4907    3               END;
      206     4908    2           RETURN;
      207     4909    2           END;
      208     4910         /**/
      209     4911         /* Here we check LLS_INIT#.
      210     4912            If LLS_INIT# is set, then this is our first trip through this
      211     4913            module.  We glom onto some memory in an unused data segment
      212     4914            so that unsatisfied refs and ref names may be placed there. */
      213     4915         /**/
      214     4916    2       IF LLS_INIT# THEN DO;
      215     4917    2           LLS_INIT# = '0'B;
      216     4918    2           VLP_NAME_SPACE.PTR$ = ADDR(NIL);
      217     4919    2           CALL M$GDS (GET_NAME_SPACE) ALTRET (NO_MEMORY);
      218     4920    2           LL_UREF_NAME$ = VLP_NAME_SPACE.PTR$;
      219     4921    2           VLP_ENTREF_SPACE.PTR$ = ADDR(NIL);
      220     4922    2           CALL M$GDS (GET_ENTREF_SPACE) ALTRET (NO_MEMORY);
      221     4923    2           LL_U_ENTREF$ = VLP_ENTREF_SPACE.PTR$;
      222     4924    2           VLP_SYMREF_SPACE.PTR$ = ADDR(NIL);
      223     4925    2           CALL M$GDS (GET_SYMREF_SPACE) ALTRET (NO_MEMORY);
      224     4926    2           LL_U_SYMREF$ = VLP_SYMREF_SPACE.PTR$;
      225     4927    2           LL_UREF_NAME_MAX = 1024;
      226     4928    2           LL_U_SYMREF_MAX = 1024;
      227     4929    2           LL_U_ENTREF_MAX = 1024;
      228     4930    2           END;
      229     4931    1       OU_NAME_IN_RECORD# = '0'B;
      230     4932    1       OU_NAME_INDEX = 0;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:8    
      231     4933    1       NUNSATS = 0;
      232     4934    2       DO I = 0 TO NREFS - 1;
      233     4935    2           TPTR$ = ROOT$;
      234     4936    2           REF_PTR$ = PINCRW (REF$, I);
      235     4937    2           REFN_PTR$ = PINCRW (REFN$, REF_PTR$ -> REF.NPOINTER);
      236     4938    2           VALUE = 0;
      237     4939    2           NOT_FOUND# = '1'B;
      238     4940    3           DO WHILE (NOT_FOUND# & TPTR$ ~= ADDR(NIL));
      239     4941    3               DEF_PTR$ = TPTR$ -> TREE.NODE$;
      240     4942    3               DEFN_PTR$ = PINCRW (DEFN$, DEF_PTR$ -> DEF.NPOINTER);
      241     4943    3               IF (REFN_PTR$ -> B$DNAME.TEXT > DEFN_PTR$ -> B$DNAME.TEXT)
      242     4944    3               THEN TPTR$ = TPTR$ -> TREE.R_CHILD$;
      243     4945    3               ELSE IF (REFN_PTR$ -> B$DNAME.TEXT < DEFN_PTR$ -> B$DNAME.TEXT)
      244     4946    3                   THEN TPTR$ = TPTR$ -> TREE.L_CHILD$;
      245     4947    3                   ELSE
      246     4948    3                       NOT_FOUND# = '0'B;
      247     4949    3               END;
      248     4950    3           IF NOT NOT_FOUND# THEN DO;
      249     4951    3               IF LL_FLAGS.BIAS_OU
      250     4952    3               THEN
      251     4953    4               DO;
      252     4954    4                   IF OU$ = ADDR(NIL)
      253     4955    4                   THEN
      254     4956    4                       REGION = 0;
      255     4957    4                   ELSE
      256     4958    4                       REGION = OU$->OU_ENTRY.REGION;
      257     4959    4                   NEXT_REGION = 0;
      258     4960    5                   DO WHILE (TPTR$ ~= ADDR(NIL));
      259     4961    5                       IF TPTR$->TREE.OU$ ~= ADDR(NIL)
      260     4962    5                       THEN
      261     4963    5                           NEXT_REGION =TPTR$->TREE.OU$->OU_ENTRY.REGION;
      262     4964    5                       IF NEXT_REGION = REGION
      263     4965    5                       THEN
      264     4966    6                       DO;
      265     4967    6                           DEF_PTR$ = TPTR$->TREE.NODE$;
      266     4968    6                           END;
      267     4969    5                       TPTR$ = TPTR$->TREE.BROTHER$;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:9    
      268     4970    5                       END;
      269     4971    4                   END;
      270     4972    4               IF (TYPE = %TYPEREF) THEN DO;
      271     4973    5                   IF (REF_PTR$->REF.CHECK AND DEF_PTR$->DEF.CHECK) THEN DO;
      272     4974    5                       IF ((REF_PTR$ -> REF.ALT ~= DEF_PTR$ -> DEF.ALT) OR
      273     4975    5                          (REF_PTR$ -> REF.CST ~= DEF_PTR$ -> DEF.CST) OR
      274     4976    6                          (REF_PTR$ -> REF.NPARAM ~= DEF_PTR$ -> DEF.NPARAM)) THEN DO;
      275     4977    6                           LL_DOBUF = 'A  ***Calling sequence mismatch on reference ';
      276     4978    6                           CALL INSERT (LL_DOBUF,45,,
      277     4979    6                              REFN_PTR$ -> B$DNAME.TEXT,
      278     4980    6                              ' of object unit ',
      279     4981    6                              OU$ -> OU_ENTRY.OUNAME.TEXT);
      280     4982    6                           CALL LLM$MON_SVC (LL#WRITEDO);
      281     4983    6                           END;
      282     4984    5                       END;
      283     4985    4                   END;
      284     4986    3               REF_PTR$ -> ISADDR = DEF_PTR$ -> DEF.ISADDR;
      285     4987    3               IF ( TYPE = %TYPEREF ) THEN
      286     4988    3                   DEF_PTR$ -> LL_ENTDEF.LFLAGS.USED = '1'B;
      287     4989    3               ELSE
      288     4990    3                   DEF_PTR$ -> LL_SYMDEF.LFLAGS.USED = '1'B;
      289     4991    3               END;
      290     4992    3           ELSE DO;
      291     4993    4               IF NOT OU_NAME_IN_RECORD# THEN DO;
      292     4994    4                   OU_NAME_IN_RECORD# = '1'B;
      293     4995    4                   TEMP = ( OU$ -> OU_ENTRY.OUNAME.SIZE + 5 ) / 4;
      294     4996         /**/
      295     4997         /*
      296     4998            TEMP contains the number of words occupied by the OU name.
      297     4999         */
      298     5000         /**/
      299     5001    5                   IF TEMP + LL_UREF_NAME_CUR >LL_UREF_NAME_MAX THEN DO;
      300     5002    5                       CALL M$GDS (GET_NAME_SPACE)
      301     5003    5                          ALTRET (NO_MEMORY);
      302     5004    5                       LL_UREF_NAME_MAX =LL_UREF_NAME_MAX + 1024;
      303     5005    5                       END;
      304     5006    4                   REFN_PTR$ = PINCRW (LL_UREF_NAME$, LL_UREF_NAME_CUR );
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:10   
      305     5007    4                   REFN_PTR$ -> B$DNAME.COUNT = TEMP * 4 - 2;
      306     5008    4                   REFN_PTR$ -> B$DNAME.TEXT = ' ';
      307     5009    4                   REFN_PTR$ -> B$DNAME.COUNT =
      308     5010    4                      OU$ -> OU_ENTRY.OUNAME.SIZE;
      309     5011    4                   REFN_PTR$ -> B$DNAME.TEXT =
      310     5012    4                      OU$ -> OU_ENTRY.OUNAME.TEXT;
      311     5013    4                   OU_NAME_INDEX = LL_UREF_NAME_CUR;
      312     5014    4                   LL_UREF_NAME_CUR = LL_UREF_NAME_CUR + TEMP;
      313     5015    4                   END;
      314     5016    4               IF TYPE = 5 THEN DO;
      315     5017         /**/
      316     5018         /*
      317     5019            We have an unsatisfied entref....Put him in the entref record.
      318     5020         */
      319     5021         /**/
      320     5022    4                   TEMP = SIZEW ( B$FEP_UNSATREF );
      321     5023    5                   IF TEMP + LL_U_ENTREF_CUR > LL_U_ENTREF_MAX THEN DO;
      322     5024    5                       CALL M$GDS (GET_ENTREF_SPACE)
      323     5025    5                          ALTRET (NO_MEMORY);
      324     5026    5                       LL_U_ENTREF_MAX = LL_U_ENTREF_MAX + 1024;
      325     5027    5                       END;
      326     5028    4                   TPTR$ = PINCRW (LL_U_ENTREF$,LL_U_ENTREF_CUR );
      327     5029    4                   TPTR$ -> B$FEP_UNSATREF.OPOINTER =
      328     5030    4                      OU_NAME_INDEX;
      329     5031    4                   TPTR$ -> B$FEP_UNSATREF.SREF =
      330     5032    4                      REF_PTR$ -> REF.SREF;
      331     5033         /**/
      332     5034         /*
      333     5035            Figure out how much space the ref name is going to take up
      334     5036            so that we can make sure that we have enough memory.
      335     5037         */
      336     5038         /**/
      337     5039    4                   TEMP = REF_PTR$ -> REF.NPOINTER;
      338     5040    4                   REFN_PTR$ = PINCRW ( REFN$, TEMP );
      339     5041    4                   TEMP = REFN_PTR$ -> B$DNAME.COUNT;
      340     5042    4                   TEMP = ( TEMP + 5 ) / 4;
      341     5043         /**/
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:11   
      342     5044         /*
      343     5045            TEMP contains the number of words the ref name will take up.
      344     5046         */
      345     5047         /**/
      346     5048    4                   IF TEMP + LL_UREF_NAME_CUR > LL_UREF_NAME_MAX
      347     5049    5                   THEN DO;
      348     5050    5                       CALL M$GDS (GET_NAME_SPACE)
      349     5051    5                          ALTRET (NO_MEMORY);
      350     5052    5                       LL_UREF_NAME_MAX = LL_UREF_NAME_MAX + 1024;
      351     5053    5                       END;
      352     5054    4                   TPTR$ -> B$FEP_UNSATREF.NPOINTER =
      353     5055    4                      LL_UREF_NAME_CUR;
      354     5056    4                   LL_U_ENTREF_CUR = LL_U_ENTREF_CUR +
      355     5057    4                      SIZEW ( B$FEP_UNSATREF );
      356     5058         /**/
      357     5059         /*
      358     5060            The ref entry is built.  Move in the name.
      359     5061         */
      360     5062         /**/
      361     5063    4                   TPTR$ = PINCRW (LL_UREF_NAME$,LL_UREF_NAME_CUR );
      362     5064    4                   TPTR$ -> B$DNAME.COUNT = TEMP * 4 - 2;
      363     5065    4                   TPTR$ -> B$DNAME.TEXT = ' ';
      364     5066    4                   TPTR$ -> B$DNAME.COUNT = REFN_PTR$ ->
      365     5067    4                      B$DNAME.COUNT;
      366     5068    4                   TPTR$ -> B$DNAME.TEXT = REFN_PTR$ ->
      367     5069    4                      B$DNAME.TEXT;
      368     5070    4                   LL_UREF_NAME_CUR = LL_UREF_NAME_CUR + TEMP;
      369     5071    4                   IF REF_PTR$ -> REF.SREF THEN
      370     5072    4                       LL_U_SECONDARY_ENTREF_COUNT =
      371     5073    4                          LL_U_SECONDARY_ENTREF_COUNT + 1;
      372     5074    4                   ELSE
      373     5075    4                       LL_U_PRIMARY_ENTREF_COUNT =
      374     5076    4                          LL_U_PRIMARY_ENTREF_COUNT + 1;
      375     5077    4                   END;
      376     5078    4               ELSE DO;
      377     5079         /**/
      378     5080         /*
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:12   
      379     5081            We have an unsatisfied symref....Put him in the entref record.
      380     5082         */
      381     5083         /**/
      382     5084    4                   TEMP = SIZEW ( B$FEP_UNSATREF );
      383     5085    5                   IF TEMP + LL_U_SYMREF_CUR >LL_U_SYMREF_MAX THEN DO;
      384     5086    5                       CALL M$GDS (GET_SYMREF_SPACE)
      385     5087    5                          ALTRET (NO_MEMORY);
      386     5088    5                       LL_U_SYMREF_MAX = LL_U_SYMREF_MAX + 1024;
      387     5089    5                       END;
      388     5090    4                   TPTR$ = PINCRW (LL_U_SYMREF$,LL_U_SYMREF_CUR );
      389     5091    4                   TPTR$ -> B$FEP_UNSATREF.OPOINTER =
      390     5092    4                      OU_NAME_INDEX;
      391     5093    4                   TPTR$ -> B$FEP_UNSATREF.SREF =
      392     5094    4                      REF_PTR$ -> REF.SREF;
      393     5095         /**/
      394     5096         /*
      395     5097            Figure out how much space the ref name is going to take up
      396     5098            so that we can make sure that we have enough memory.
      397     5099         */
      398     5100         /**/
      399     5101    4                   TEMP = REF_PTR$ -> REF.NPOINTER;
      400     5102    4                   REFN_PTR$ = PINCRW ( REFN$, TEMP );
      401     5103    4                   TEMP = REFN_PTR$ -> B$DNAME.COUNT;
      402     5104    4                   TEMP = ( TEMP + 5 ) / 4;
      403     5105         /**/
      404     5106         /*
      405     5107            TEMP contains the number of words the ref name will take up.
      406     5108         */
      407     5109         /**/
      408     5110    4                   IF TEMP + LL_UREF_NAME_CUR > LL_UREF_NAME_MAX
      409     5111    5                   THEN DO;
      410     5112    5                       CALL M$GDS (GET_NAME_SPACE)
      411     5113    5                          ALTRET (NO_MEMORY);
      412     5114    5                       LL_UREF_NAME_MAX = LL_UREF_NAME_MAX + 1024;
      413     5115    5                       END;
      414     5116    4                   TPTR$ -> B$FEP_UNSATREF.NPOINTER =
      415     5117    4                      LL_UREF_NAME_CUR;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:13   
      416     5118    4                   LL_U_SYMREF_CUR = LL_U_SYMREF_CUR +
      417     5119    4                      SIZEW ( B$FEP_UNSATREF );
      418     5120         /**/
      419     5121         /*
      420     5122            The ref entry is built.  Move in the name.
      421     5123         */
      422     5124         /**/
      423     5125    4                   TPTR$ = PINCRW (LL_UREF_NAME$,LL_UREF_NAME_CUR );
      424     5126    4                   TPTR$ -> B$DNAME.COUNT = TEMP * 4 - 2;
      425     5127    4                   TPTR$ -> B$DNAME.TEXT = ' ';
      426     5128    4                   TPTR$ -> B$DNAME.COUNT = REFN_PTR$ ->
      427     5129    4                      B$DNAME.COUNT;
      428     5130    4                   TPTR$ -> B$DNAME.TEXT = REFN_PTR$ ->
      429     5131    4                      B$DNAME.TEXT;
      430     5132    4                   LL_UREF_NAME_CUR = LL_UREF_NAME_CUR + TEMP;
      431     5133    4                   IF REF_PTR$ -> REF.SREF THEN
      432     5134    4                       LL_U_SECONDARY_SYMREF_COUNT =
      433     5135    4                          LL_U_SECONDARY_SYMREF_COUNT + 1;
      434     5136    4                   ELSE
      435     5137    4                       LL_U_PRIMARY_SYMREF_COUNT =
      436     5138    4                          LL_U_PRIMARY_SYMREF_COUNT + 1;
      437     5139    4                   END;
      438     5140    3               IF ( NOT REF_PTR$ -> REF.SREF) AND
      439     5141    3                  LL_HEAD.SEV < 7 THEN
      440     5142    3                   LL_HEAD.SEV = 7;
      441     5143    3               REF_PTR$ -> ISADDR = 0;
      442     5144    3               END;
      443     5145    2           END;
      444     5146    1       OU_NAME_IN_RECORD# = '0'B;
      445     5147    1       RETURN;
      446     5148        %EJECT;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:14   
      447     5149    1   NO_MEMORY:
      448     5150    1       CALL LLM$MON_SVC (LL#GETMEM);
      449     5151        %EJECT;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:15   
      450     5152    1   LLS$SORT: PROC ( NAME$, RCD$, SIZE );
      451     5153         /**/
      452     5154    2   DCL NAME$ PTR; /* Pointer to ref names record */
      453     5155    2   DCL RCD$ PTR; /* Pointer to ref record */
      454     5156    2   DCL SIZE UBIN WORD ALIGNED; /* Contains the word size of the ref record */
      455     5157         /**/
      456     5158        %LL$UNSATREF ( NAME = STATIC$FEP_UNSATREF,
      457     5159         STCLASS = STATIC );
      458     5172         /***
      459     5173            *** STATIC
      460     5174            ***/
      461     5175
      462     5176    2   DCL COUNT SBIN STATIC;
      463     5177    2   DCL M SBIN STATIC;
      464     5178    2   DCL LAST_SWAP_IX SBIN STATIC;
      465     5179    2   DCL SWAP_UPTO_IX SBIN STATIC;
      466     5180    2   DCL PTR_I_REF$ PTR STATIC;
      467     5181    2   DCL PTR_I_NAME$ PTR STATIC;
      468     5182    2   DCL PTR_J_REF$ PTR STATIC;
      469     5183    2   DCL PTR_J_NAME$ PTR STATIC;
      470     5184
      471     5185         /********************/
      472     5186
      473     5187         /***
      474     5188            *** Algorithm: enhanced shell sort.  Should start M at log base 2
      475     5189            *** of COUNT, but 6 is a decent compromise.
      476     5190            ***/
      477     5191
      478     5192    2       COUNT = SIZE / SIZEW(B$FEP_UNSATREF) - 1;
      479     5193    3       DO M = MAXIMUM(1,(COUNT+1)/6) DOWNTO 1;
      480     5194    3           LAST_SWAP_IX = COUNT;
      481     5195    4           DO UNTIL( M > 1 OR ( M = 1 AND LAST_SWAP_IX <= 0 ) );
      482     5196    4               SWAP_UPTO_IX = LAST_SWAP_IX;
      483     5197    4               LAST_SWAP_IX = 0;
      484     5198    5               DO J = M TO SWAP_UPTO_IX;
      485     5199    5                   I = J - M;
      486     5200    5                   PTR_I_REF$ = PINCRW( RCD$, I * SIZEW(B$FEP_UNSATREF) );
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:16   
      487     5201    5                   PTR_J_REF$ = PINCRW( RCD$, J * SIZEW(B$FEP_UNSATREF) );
      488     5202    5                   PTR_I_NAME$ = PINCRW( NAME$, PTR_I_REF$->B$FEP_UNSATREF.NPOINTER );
      489     5203    5                   PTR_J_NAME$ = PINCRW( NAME$, PTR_J_REF$->B$FEP_UNSATREF.NPOINTER );
      490     5204    5                   IF PTR_I_NAME$->B$DNAME.TEXT > PTR_J_NAME$->B$DNAME.TEXT
      491     5205    6                   THEN DO;
      492     5206    6                       STATIC$FEP_UNSATREF = PTR_I_REF$->B$FEP_UNSATREF;
      493     5207    6                       PTR_I_REF$->B$FEP_UNSATREF = PTR_J_REF$->B$FEP_UNSATREF;
      494     5208    6                       PTR_J_REF$->B$FEP_UNSATREF = STATIC$FEP_UNSATREF;
      495     5209    6                       LAST_SWAP_IX = I;
      496     5210    6                       END;
      497     5211    5                   END;
      498     5212    4               END;
      499     5213    3           END;
      500     5214    2       RETURN;
      501     5215    2   END LLS$SORT;
      502     5216        %EJECT;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:17   
      503     5217    1   LLS$BINDEC: PROC ( COUNT );
      504     5218         /**/
      505     5219    2   DCL COUNT UBIN WORD ALIGNED;
      506     5220    2   DCL CHARS CHAR(7) ALIGNED;
      507     5221         /**/
      508     5222    2       TEXTC.COUNT = 7;
      509     5223    2       CALL BINCHAR (CHARS, COUNT);
      510     5224    2       TEXTC.STRING = CHARS;
      511     5225    2       I = 0;
      512     5226    3       DO WHILE ( I < 6 AND TEXTC.BYTES(I) = '0' );
      513     5227    3           I = I + 1;
      514     5228    3           END;
      515     5229    2       J = 7 - I;
      516     5230         /* J: Length of string */
      517     5231         /* I: Start of first character. */
      518     5232    2       CHARS = SUBSTR (TEXTC.STRING,I,J);
      519     5233    2       TEXTC.COUNT = J;
      520     5234    2       TEXTC.STRING = CHARS;
      521     5235    2       RETURN;
      522     5236    2   END LLS$BINDEC;
      523     5237    1   END LLS$SATREF;
      524     5238        %EOD;

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:18   
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   LL_MACS_C.:E05TOU  is referenced.
   LL_SUBS_C.:E05TOU  is referenced.
   LL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure LLS$SATREF.

   Procedure LLS$SATREF requires 827 words for executable code.
   Procedure LLS$SATREF requires 34 words of local(AUTO) storage.

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:19   

 Object Unit name= LLS$SATREF                                 File name= LLS$SATREF.:E05TOU
 UTS= JUL 30 '97 03:17:21.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    38     46  LLS$SATREF
    2  RoData even  UTS     60     74  LLS$SATREF
    3   Proc  even  none   827   1473  LLS$SATREF
    4  RoData even  none    23     27  LLS$SATREF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        8  LLS$SATREF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 LLM$MON_SVC
         yes           Std       0 LLS$SAYREFS
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:20   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     LL_DOBUF                              LL_FLAGS                              LL_UREF_NAME$
     LL_U_SYMREF$                          LL_U_ENTREF$                          LL_UREF_NAME_MAX
     LL_U_SYMREF_MAX                       LL_U_ENTREF_MAX                       LL_UREF_NAME_CUR
     LL_U_ENTREF_CUR                       LL_U_SYMREF_CUR                       LLS_INIT#
     OU_NAME_INDEX                         LL_U_SECONDARY_SYMREF_COUNT           LL_U_PRIMARY_SYMREF_COUNT
     LL_U_SECONDARY_ENTREF_COUNT           LL_U_PRIMARY_ENTREF_COUNT             M$UC
     LL_HEAD                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:21   


        1        1        /*M* LLS$SATREF - Reference satisfier                               */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,ENI=4,
        8        8             CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC*/
        9        9        /*F* NAME:         LLS$SATREF
       10       10             PURPOSE:      Satisfies external references on a module by
       11       11                           module basis.  This module also maintains a count
       12       12                           of number of unsatisfied references and writes
       13       13                           an appropriate "error message" for each ref.     */
       14       14        LLS$SATREF: PROC (REF$, NREFS, ROOT$, NUNSATS, TYPE, DEFN$, REFN$, OU$);

     14  3 000000   000000 700200 xent  LLS$SATREF   TSX0  ! X66_AUTO_N
         3 000001   000042 000010                    ZERO    34,8

       15       15        %INCLUDE LL_DATA_R;
       16       51        %INCLUDE LL_SUBS_C;
       17      180        %INCLUDE LL_MACS_C;
       18      534        %INCLUDE B$OBJECT_C;
       19     3964        %INCLUDE CP_6;
       20     4045        %B$DNAME;
       21     4064        %LL$UNSATREF ( NAME = B$FEP_UNSATREF );
       22     4077        %B$RECORDSUBS;
       23     4105        %B$FEP_RUKEY;
       24     4129        %FPT_GDS ( FPTN = GET_NAME_SPACE,
       25     4130         SEGSIZE = 1024,
       26     4131         RESULTS = VLP_NAME_SPACE );
       27     4147        %FPT_GDS ( FPTN = GET_ENTREF_SPACE,
       28     4148         SEGSIZE = 1024,
       29     4149         RESULTS = VLP_ENTREF_SPACE );
       30     4165        %FPT_GDS ( FPTN = GET_SYMREF_SPACE,
       31     4166         SEGSIZE = 1024,
       32     4167         RESULTS = VLP_SYMREF_SPACE );
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:22   
       33     4183        %VLP_VECTOR ( FPTN = VLP_NAME_SPACE );
       34     4198        %VLP_VECTOR ( FPTN = VLP_ENTREF_SPACE );
       35     4213        %VLP_VECTOR ( FPTN = VLP_SYMREF_SPACE );
       36     4228        %B$EDEF ( NAME = LL_ENTDEF );
       37     4298        %B$SDEF ( NAME = LL_SYMDEF );
       38     4352    1   DCL REF$ PTR; /* Pointer to ref entries */
       39     4353    1   DCL NREFS UBIN WORD ALIGNED; /* Number of ref entries */
       40     4354    1   DCL ROOT$ PTR; /* Pointer to root of tree */
       41     4355    1   DCL NUNSATS UBIN WORD ALIGNED; /* Count of unsatisfied refs */
       42     4356    1   DCL TYPE UBIN WORD ALIGNED; /* Ref type (ENTREF/SYMREF) */
       43     4357    1   DCL DEFN$ PTR; /* Pointer to def name table */
       44     4358    1   DCL REFN$ PTR; /* Pointer to ref name table */
       45     4359    1   DCL OU$ PTR; /* Pointer to o.u. entry */
       46     4360    1   DCL REF_PTR$ PTR;
       47     4361    1   DCL DEF_PTR$ PTR;
       48     4362    1   DCL REFN_PTR$ PTR;
       49     4363    1   DCL DEFN_PTR$ PTR;
       50     4364    1   DCL TPTR$ PTR;
       51     4365    1   DCL TEMP UBIN WORD ALIGNED;
       52     4366    1   DCL TEMP1 UBIN WORD ALIGNED;
       53     4367    1   DCL VALUE UBIN WORD ALIGNED;
       54     4368    1   DCL ISADDR UBIN WORD BASED ALIGNED;
       55     4369    1   DCL NOT_FOUND# BIT(1) UNAL;
       56     4370         /**/
       57     4371         /**/
       58     4372    1   DCL 1 TEXTC STATIC ALIGNED,
       59     4373    1         2 COUNT UBIN BYTE UNAL,
       60     4374    1         2 STRING CHAR(7) UNAL,
       61     4375    1         2 BYTES(0:6) REDEF STRING CHAR(1) UNAL;
       62     4376    1   DCL TEXTC$ PTR CONSTANT INIT(ADDR(TEXTC));
       63     4377    1   DCL 1 B_TEXTC BASED(TEXTC$) ALIGNED,
       64     4378    1         2 COUNT UBIN BYTE UNAL,
       65     4379    1         2 STRING CHAR(B_TEXTC.COUNT) UNAL;
       66     4380         /**/
       67     4381        %LL$NODE ( NAME = TREE );
       68     4413        %LL$OU_ENTRY ( NAME = OU_ENTRY );
       69     4461        %B$EREF ( NAME = REF );
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:23   
       70     4504        %B$EDEF ( NAME = DEF );
       71     4574    1   DCL I SBIN WORD ALIGNED;
       72     4575    1   DCL J SBIN WORD ALIGNED;
       73     4576    1   DCL LLM$MON_SVC ENTRY(4) ALTRET;
       74     4577    1   DCL LLS$SAYREFS ENTRY;
       75     4578    1   DCL ALREADY_YELLED# BIT(1) STATIC INIT ('0'B);
       76     4579    1   DCL OU_FID (0:0) CHAR(50) BASED ALIGNED;
       77     4580    1   DCL BUFFER_INDEX UBIN WORD ALIGNED;
       78     4581    1   DCL REGION UBIN BYTE;
       79     4582    1   DCL NEXT_REGION UBIN BYTE;
       80     4583        %B$HEAD ( NAME = LL_HEAD,
       81     4584         STCLASS = SYMREF );
       82     4784        %EJECT;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:24   
       83     4785    1   BEGIN:
       84     4786         /**/
       85     4787         /*
       86     4788            If TYPE is 0, write the unsat records into the run unit.
       87     4789         */
       88     4790         /**/
       89     4791    2       IF TYPE = 0 THEN DO;

   4791  3 000002   200007 470500       BEGIN        LDP0    @TYPE,,AUTO
         3 000003   000000 235100                    LDA     0,,PR0
         3 000004   000375 601000 3                  TNZ     s:4916

       90     4792    3           IF LL_UREF_NAME_CUR > 0 THEN DO;

   4792  3 000005   000000 236000 xsym               LDQ     LL_UREF_NAME_CUR
         3 000006   000374 600000 3                  TZE     s:4908

       91     4793         /**/
       92     4794         /*
       93     4795            Sort the SYMREF record by symbol name.
       94     4796         */
       95     4797         /**/
       96     4798    3               CALL LLS$SORT ( LL_UREF_NAME$, LL_U_SYMREF$, LL_U_SYMREF_CUR );

   4798  3 000007   000000 237000 4                  LDAQ    0
         3 000010   200034 757100                    STAQ    @COUNT+1,,AUTO
         3 000011   000002 236000 4                  LDQ     2
         3 000012   200033 756100                    STQ     NEXT_REGION+2,,AUTO
         3 000013   001316 701000 3                  TSX1    LLS$SORT
         3 000014   000000 011000                    NOP     0

       97     4799    3               CALL LLS$SORT ( LL_UREF_NAME$, LL_U_ENTREF$, LL_U_ENTREF_CUR );

   4799  3 000015   000004 237000 4                  LDAQ    4
         3 000016   200034 757100                    STAQ    @COUNT+1,,AUTO
         3 000017   000002 236000 4                  LDQ     2
         3 000020   200033 756100                    STQ     NEXT_REGION+2,,AUTO
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:25   
         3 000021   001316 701000 3                  TSX1    LLS$SORT
         3 000022   000000 011000                    NOP     0

       98     4800         /**/
       99     4801         /*
      100     4802            Tell how many unsatisfied prefs and srefs there were.
      101     4803         */
      102     4804         /**/
      103     4805    4               IF LL_U_PRIMARY_ENTREF_COUNT > 0 THEN DO;

   4805  3 000023   000000 235000 xsym               LDA     LL_U_PRIMARY_ENTREF_COUNT
         3 000024   000056 600000 3                  TZE     s:4813

      104     4806    4                   CALL LLS$BINDEC ( LL_U_PRIMARY_ENTREF_COUNT );

   4806  3 000025   000006 236000 4                  LDQ     6
         3 000026   200033 756100                    STQ     NEXT_REGION+2,,AUTO
         3 000027   001423 701000 3                  TSX1    LLS$BINDEC
         3 000030   000000 011000                    NOP     0

      105     4807    4                   CALL INSERT ( LL_DOBUF, 0,,

   4807  3 000031   000000 470400 2                  LDP0    TEXTC$
         3 000032   000000 236100                    LDQ     0,,PR0
         3 000033   000033 772000                    QRL     27
         3 000034   040000 100400                    MLR     fill='040'O
         3 000035   000001 000006 2                  ADSC9   TEXTC$+1                 cn=0,n=6
         3 000036   000000 000006 xsym               ADSC9   LL_DOBUF                 cn=0,n=6
         3 000037   000000 620006                    EAX0    0,QL
         3 000040   040000 100540                    MLR     fill='040'O
         3 000041   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         3 000042   000001 400152 xsym               ADSC9   LL_DOBUF+1               cn=2,n=106
         3 000043   000152 116007                    CMPQ    106,DL
         3 000044   000052 603000 3                  TRC     s:4811
         3 000045   777625 620006                    EAX0    -107,QL
         3 000046   777777 660003                    ERX0    -1,DU
         3 000047   040046 100400                    MLR     fill='040'O
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:26   
         3 000050   000003 000047 2                  ADSC9   TEXTC$+3                 cn=0,n=39
         3 000051   000001 400010 xsym               ADSC9   LL_DOBUF+1,Q             cn=2,n=*X0

      106     4808    4                      'A  ***',
      107     4809    4                      B_TEXTC.STRING,
      108     4810    4                      ' unsatisfied primary entry reference(s)' );
      109     4811    4                   CALL LLM$MON_SVC (LL#WRITEDO);

   4811  3 000052   000007 630400 4                  EPPR0   7
         3 000053   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000054   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000055   000000 011000                    NOP     0

      110     4812    4                   END;

      111     4813    4               IF LL_U_SECONDARY_ENTREF_COUNT > 0 THEN DO;

   4813  3 000056   000000 235000 xsym               LDA     LL_U_SECONDARY_ENTREF_COUNT
         3 000057   000111 600000 3                  TZE     s:4821

      112     4814    4                   CALL LLS$BINDEC ( LL_U_SECONDARY_ENTREF_COUNT );

   4814  3 000060   000010 236000 4                  LDQ     8
         3 000061   200033 756100                    STQ     NEXT_REGION+2,,AUTO
         3 000062   001423 701000 3                  TSX1    LLS$BINDEC
         3 000063   000000 011000                    NOP     0

      113     4815    4                   CALL INSERT ( LL_DOBUF, 0,,

   4815  3 000064   000000 470400 2                  LDP0    TEXTC$
         3 000065   000000 236100                    LDQ     0,,PR0
         3 000066   000033 772000                    QRL     27
         3 000067   040000 100400                    MLR     fill='040'O
         3 000070   000001 000006 2                  ADSC9   TEXTC$+1                 cn=0,n=6
         3 000071   000000 000006 xsym               ADSC9   LL_DOBUF                 cn=0,n=6
         3 000072   000000 620006                    EAX0    0,QL
         3 000073   040000 100540                    MLR     fill='040'O
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:27   
         3 000074   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         3 000075   000001 400152 xsym               ADSC9   LL_DOBUF+1               cn=2,n=106
         3 000076   000152 116007                    CMPQ    106,DL
         3 000077   000105 603000 3                  TRC     s:4819
         3 000100   777625 620006                    EAX0    -107,QL
         3 000101   777777 660003                    ERX0    -1,DU
         3 000102   040046 100400                    MLR     fill='040'O
         3 000103   000015 000051 2                  ADSC9   TEXTC$+13                cn=0,n=41
         3 000104   000001 400010 xsym               ADSC9   LL_DOBUF+1,Q             cn=2,n=*X0

      114     4816    4                      'A  ***',
      115     4817    4                      B_TEXTC.STRING,
      116     4818    4                      ' unsatisfied secondary entry reference(s)');
      117     4819    4                   CALL LLM$MON_SVC (LL#WRITEDO);

   4819  3 000105   000007 630400 4                  EPPR0   7
         3 000106   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000107   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000110   000000 011000                    NOP     0

      118     4820    4                   END;

      119     4821    4               IF LL_U_PRIMARY_SYMREF_COUNT > 0 THEN DO;

   4821  3 000111   000000 235000 xsym               LDA     LL_U_PRIMARY_SYMREF_COUNT
         3 000112   000144 600000 3                  TZE     s:4829

      120     4822    4                   CALL LLS$BINDEC ( LL_U_PRIMARY_SYMREF_COUNT );

   4822  3 000113   000011 236000 4                  LDQ     9
         3 000114   200033 756100                    STQ     NEXT_REGION+2,,AUTO
         3 000115   001423 701000 3                  TSX1    LLS$BINDEC
         3 000116   000000 011000                    NOP     0

      121     4823    4                   CALL INSERT ( LL_DOBUF,0,,

   4823  3 000117   000000 470400 2                  LDP0    TEXTC$
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:28   
         3 000120   000000 236100                    LDQ     0,,PR0
         3 000121   000033 772000                    QRL     27
         3 000122   040000 100400                    MLR     fill='040'O
         3 000123   000001 000006 2                  ADSC9   TEXTC$+1                 cn=0,n=6
         3 000124   000000 000006 xsym               ADSC9   LL_DOBUF                 cn=0,n=6
         3 000125   000000 620006                    EAX0    0,QL
         3 000126   040000 100540                    MLR     fill='040'O
         3 000127   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         3 000130   000001 400152 xsym               ADSC9   LL_DOBUF+1               cn=2,n=106
         3 000131   000152 116007                    CMPQ    106,DL
         3 000132   000140 603000 3                  TRC     s:4827
         3 000133   777625 620006                    EAX0    -107,QL
         3 000134   777777 660003                    ERX0    -1,DU
         3 000135   040046 100400                    MLR     fill='040'O
         3 000136   000030 000046 2                  ADSC9   TEXTC$+24                cn=0,n=38
         3 000137   000001 400010 xsym               ADSC9   LL_DOBUF+1,Q             cn=2,n=*X0

      122     4824    4                      'A  ***',
      123     4825    4                      B_TEXTC.STRING,
      124     4826    4                      ' unsatisfied primary data reference(s)');
      125     4827    4                   CALL LLM$MON_SVC (LL#WRITEDO);

   4827  3 000140   000007 630400 4                  EPPR0   7
         3 000141   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000142   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000143   000000 011000                    NOP     0

      126     4828    4                   END;

      127     4829    4               IF LL_U_SECONDARY_SYMREF_COUNT > 0 THEN DO;

   4829  3 000144   000000 235000 xsym               LDA     LL_U_SECONDARY_SYMREF_COUNT
         3 000145   000177 600000 3                  TZE     s:4846

      128     4830    4                   CALL LLS$BINDEC ( LL_U_SECONDARY_SYMREF_COUNT );

   4830  3 000146   000012 236000 4                  LDQ     10
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:29   
         3 000147   200033 756100                    STQ     NEXT_REGION+2,,AUTO
         3 000150   001423 701000 3                  TSX1    LLS$BINDEC
         3 000151   000000 011000                    NOP     0

      129     4831    4                   CALL INSERT ( LL_DOBUF,0,,

   4831  3 000152   000000 470400 2                  LDP0    TEXTC$
         3 000153   000000 236100                    LDQ     0,,PR0
         3 000154   000033 772000                    QRL     27
         3 000155   040000 100400                    MLR     fill='040'O
         3 000156   000001 000006 2                  ADSC9   TEXTC$+1                 cn=0,n=6
         3 000157   000000 000006 xsym               ADSC9   LL_DOBUF                 cn=0,n=6
         3 000160   000000 620006                    EAX0    0,QL
         3 000161   040000 100540                    MLR     fill='040'O
         3 000162   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         3 000163   000001 400152 xsym               ADSC9   LL_DOBUF+1               cn=2,n=106
         3 000164   000152 116007                    CMPQ    106,DL
         3 000165   000173 603000 3                  TRC     s:4835
         3 000166   777625 620006                    EAX0    -107,QL
         3 000167   777777 660003                    ERX0    -1,DU
         3 000170   040046 100400                    MLR     fill='040'O
         3 000171   000042 000050 2                  ADSC9   TEXTC$+34                cn=0,n=40
         3 000172   000001 400010 xsym               ADSC9   LL_DOBUF+1,Q             cn=2,n=*X0

      130     4832    4                      'A  ***',
      131     4833    4                      B_TEXTC.STRING,
      132     4834    4                      ' unsatisfied secondary data reference(s)');
      133     4835    4                   CALL LLM$MON_SVC (LL#WRITEDO);

   4835  3 000173   000007 630400 4                  EPPR0   7
         3 000174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000175   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000176   000000 011000                    NOP     0

      134     4836    4                   END;

      135     4837         /**/
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:30   
      136     4838         /*
      137     4839            Decide whether or not to call LLS$SAYREFS depending on the map
      138     4840            option.  If MAP has been specified, LLD$MAP will call LLS$SAYREFS
      139     4841            to process the ref records after setting up data segments for
      140     4842            ref names, for entref records, and for symref records and checking
      141     4843            LLS_INIT# to make sure that this is not a MAP only request.
      142     4844         */
      143     4845         /**/
      144     4846    4               IF NOT LL_FLAGS.MAP# THEN DO;

   4846  3 000177   000000 236000 xsym               LDQ     LL_FLAGS
         3 000200   004000 316003                    CANQ    2048,DU
         3 000201   000214 601000 3                  TNZ     s:4856

      145     4847    4                   LL_DOBUF = 'C';

   4847  3 000202   040000 100400                    MLR     fill='040'O
         3 000203   000013 000001 4                  ADSC9   11                       cn=0,n=1
         3 000204   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      146     4848    4                   CALL LLM$MON_SVC (LL#WRITEDO);

   4848  3 000205   000007 630400 4                  EPPR0   7
         3 000206   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000207   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000210   000000 011000                    NOP     0

      147     4849    4                   CALL LLS$SAYREFS;

   4849  3 000211   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000212   000000 701000 xent               TSX1    LLS$SAYREFS
         3 000213   000000 011000                    NOP     0

      148     4850    4                   END;

      149     4851         /**/
      150     4852         /*
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:31   
      151     4853            Write the SYMREF record(s).
      152     4854         */
      153     4855         /**/
      154     4856    3               B$FEP_RUKEY.TYPE = 7; /* SYMREFS */

   4856  3 000214   000007 236003                    LDQ     7,DU
         3 000215   000000 552020 1                  STBQ    B$FEP_RUKEY,'20'O

      155     4857    3               B$FEP_RUKEY.PAGE = 0;

   4857  3 000216   003000 061400                    CSR     bolr='003'O
         3 000217   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         3 000220   000000 670024 1                  BDSC    B$FEP_RUKEY              by=3,bit=7,n=20

      156     4858    3               TEMP1 = LL_U_SYMREF_CUR;

   4858  3 000221   000000 235000 xsym               LDA     LL_U_SYMREF_CUR
         3 000222   200022 755100                    STA     TEMP1,,AUTO

      157     4859    4               DO WHILE ( LL_U_SYMREF_CUR > 0 );

   4859  3 000223   000265 600000 3                  TZE     s:4872

      158     4860    5                   IF LL_U_SYMREF_CUR > LL_EDRECSIZE THEN DO;

   4860  3 000224   000000 235000 xsym               LDA     LL_U_SYMREF_CUR
         3 000225   002001 115007                    CMPA    1025,DL
         3 000226   000234 602000 3                  TNC     s:4865

      159     4861    5                       TEMP = LL_EDRECSIZE * 4 - 1;

   4861  3 000227   007777 236007                    LDQ     4095,DL
         3 000230   200021 756100                    STQ     TEMP,,AUTO

      160     4862    5                       LL_U_SYMREF_CUR = LL_U_SYMREF_CUR - LL_EDRECSIZE;

   4862  3 000231   002000 135007                    SBLA    1024,DL
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:32   
         3 000232   000000 755000 xsym               STA     LL_U_SYMREF_CUR

      161     4863    5                       END;

   4863  3 000233   000240 710000 3                  TRA     s:4868

      162     4864    5                   ELSE DO;

      163     4865    5                       TEMP = LL_U_SYMREF_CUR * 4 - 1;

   4865  3 000234   000002 735000                    ALS     2
         3 000235   000001 135007                    SBLA    1,DL
         3 000236   200021 755100                    STA     TEMP,,AUTO

      164     4866    5                       LL_U_SYMREF_CUR = 0;

   4866  3 000237   000000 450000 xsym               STZ     LL_U_SYMREF_CUR

      165     4867    5                       END;

      166     4868    4                   CALL LLM$MON_SVC (LL#WRITERU, LL_U_SYMREF$,

   4868  3 000240   000015 236000 4                  LDQ     13
         3 000241   200041 756100                    STQ     @SIZE+4,,AUTO
         3 000242   200021 630500                    EPPR0   TEMP,,AUTO
         3 000243   200040 450500                    STP0    @SIZE+3,,AUTO
         3 000244   000016 237000 4                  LDAQ    14
         3 000245   200036 757100                    STAQ    @SIZE+1,,AUTO
         3 000246   200036 630500                    EPPR0   @SIZE+1,,AUTO
         3 000247   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000250   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000251   000000 011000                    NOP     0

      167     4869    4                      TEMP, B$FEP_RUKEY);
      168     4870    4                   B$FEP_RUKEY.PAGE = B$FEP_RUKEY.PAGE + 1;

   4870  3 000252   000000 235000 1                  LDA     B$FEP_RUKEY
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:33   
         3 000253   000001 236000 1                  LDQ     B$FEP_RUKEY+1
         3 000254   000022 773000                    LRL     18
         3 000255   000020 376000 4                  ANQ     16
         3 000256   000001 036007                    ADLQ    1,DL
         3 000257   200036 756100                    STQ     @SIZE+1,,AUTO
         3 000260   003000 061500                    CSR     bolr='003'O
         3 000261   200036 000044                    BDSC    @SIZE+1,,AUTO            by=0,bit=0,n=36
         3 000262   000000 670024 1                  BDSC    B$FEP_RUKEY              by=3,bit=7,n=20

      169     4871    4                   END;

   4871  3 000263   000000 235000 xsym               LDA     LL_U_SYMREF_CUR
         3 000264   000224 601000 3                  TNZ     s:4860

      170     4872    3               LL_U_SYMREF_CUR = TEMP1;

   4872  3 000265   200022 236100                    LDQ     TEMP1,,AUTO
         3 000266   000000 756000 xsym               STQ     LL_U_SYMREF_CUR

      171     4873         /**/
      172     4874         /*
      173     4875            Write the ENTREF record(s).
      174     4876         */
      175     4877         /**/
      176     4878    3               B$FEP_RUKEY.TYPE = 5; /* ENTREFS */

   4878  3 000267   000005 236003                    LDQ     5,DU
         3 000270   000000 552020 1                  STBQ    B$FEP_RUKEY,'20'O

      177     4879    3               B$FEP_RUKEY.PAGE = 0;

   4879  3 000271   003000 061400                    CSR     bolr='003'O
         3 000272   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         3 000273   000000 670024 1                  BDSC    B$FEP_RUKEY              by=3,bit=7,n=20

      178     4880    3               TEMP1 = LL_U_ENTREF_CUR;

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:34   
   4880  3 000274   000000 235000 xsym               LDA     LL_U_ENTREF_CUR
         3 000275   200022 755100                    STA     TEMP1,,AUTO

      179     4881    4               DO WHILE ( LL_U_ENTREF_CUR > 0 );

   4881  3 000276   000341 600000 3                  TZE     s:4894

      180     4882    5                   IF LL_U_ENTREF_CUR > LL_EPRECSIZE THEN DO;

   4882  3 000277   000000 235000 xsym               LDA     LL_U_ENTREF_CUR
         3 000300   002001 115007                    CMPA    1025,DL
         3 000301   000310 602000 3                  TNC     s:4887

      181     4883    5                       TEMP = LL_EPRECSIZE * 4 - 1;

   4883  3 000302   007777 236007                    LDQ     4095,DL
         3 000303   200021 756100                    STQ     TEMP,,AUTO

      182     4884    5                       LL_U_ENTREF_CUR = LL_U_SYMREF_CUR - LL_EPRECSIZE;

   4884  3 000304   000000 235000 xsym               LDA     LL_U_SYMREF_CUR
         3 000305   002000 135007                    SBLA    1024,DL
         3 000306   000000 755000 xsym               STA     LL_U_ENTREF_CUR

      183     4885    5                       END;

   4885  3 000307   000314 710000 3                  TRA     s:4890

      184     4886    5                   ELSE DO;

      185     4887    5                       TEMP = LL_U_ENTREF_CUR * 4 - 1;

   4887  3 000310   000002 735000                    ALS     2
         3 000311   000001 135007                    SBLA    1,DL
         3 000312   200021 755100                    STA     TEMP,,AUTO

      186     4888    5                       LL_U_ENTREF_CUR = 0;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:35   

   4888  3 000313   000000 450000 xsym               STZ     LL_U_ENTREF_CUR

      187     4889    5                       END;

      188     4890    4                   CALL LLM$MON_SVC (LL#WRITERU, LL_U_ENTREF$,

   4890  3 000314   000015 236000 4                  LDQ     13
         3 000315   200041 756100                    STQ     @SIZE+4,,AUTO
         3 000316   200021 630500                    EPPR0   TEMP,,AUTO
         3 000317   200040 450500                    STP0    @SIZE+3,,AUTO
         3 000320   000022 237000 4                  LDAQ    18
         3 000321   200036 757100                    STAQ    @SIZE+1,,AUTO
         3 000322   200036 630500                    EPPR0   @SIZE+1,,AUTO
         3 000323   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000324   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000325   000000 011000                    NOP     0

      189     4891    4                      TEMP, B$FEP_RUKEY);
      190     4892    4                   B$FEP_RUKEY.PAGE = B$FEP_RUKEY.PAGE + 1;

   4892  3 000326   000000 235000 1                  LDA     B$FEP_RUKEY
         3 000327   000001 236000 1                  LDQ     B$FEP_RUKEY+1
         3 000330   000022 773000                    LRL     18
         3 000331   000020 376000 4                  ANQ     16
         3 000332   000001 036007                    ADLQ    1,DL
         3 000333   200036 756100                    STQ     @SIZE+1,,AUTO
         3 000334   003000 061500                    CSR     bolr='003'O
         3 000335   200036 000044                    BDSC    @SIZE+1,,AUTO            by=0,bit=0,n=36
         3 000336   000000 670024 1                  BDSC    B$FEP_RUKEY              by=3,bit=7,n=20

      191     4893    4                   END;

   4893  3 000337   000000 235000 xsym               LDA     LL_U_ENTREF_CUR
         3 000340   000277 601000 3                  TNZ     s:4882

      192     4894    3               LL_U_ENTREF_CUR = TEMP1;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:36   

   4894  3 000341   200022 236100                    LDQ     TEMP1,,AUTO
         3 000342   000000 756000 xsym               STQ     LL_U_ENTREF_CUR

      193     4895         /**/
      194     4896         /*
      195     4897            Write the ref names record.
      196     4898         */
      197     4899         /**/
      198     4900    3               IF LL_HEAD.NRECSIZE < LL_UREF_NAME_CUR THEN

   4900  3 000343   000006 236000 xsym               LDQ     LL_HEAD+6
         3 000344   777777 376007                    ANQ     -1,DL
         3 000345   000000 116000 xsym               CMPQ    LL_UREF_NAME_CUR
         3 000346   000351 603000 3                  TRC     s:4902

      199     4901    3                   LL_HEAD.NRECSIZE = LL_UREF_NAME_CUR;

   4901  3 000347   000000 720000 xsym               LXL0    LL_UREF_NAME_CUR
         3 000350   000006 440000 xsym               SXL0    LL_HEAD+6

      200     4902    3               B$FEP_RUKEY.TYPE = 2; /* REF NAMES */

   4902  3 000351   000002 236003                    LDQ     2,DU
         3 000352   000000 552020 1                  STBQ    B$FEP_RUKEY,'20'O

      201     4903    3               B$FEP_RUKEY.PAGE = 0;

   4903  3 000353   003000 061400                    CSR     bolr='003'O
         3 000354   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         3 000355   000000 670024 1                  BDSC    B$FEP_RUKEY              by=3,bit=7,n=20

      202     4904    3               TEMP = LL_UREF_NAME_CUR * 4 - 1;

   4904  3 000356   000000 235000 xsym               LDA     LL_UREF_NAME_CUR
         3 000357   000002 735000                    ALS     2
         3 000360   000001 135007                    SBLA    1,DL
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:37   
         3 000361   200021 755100                    STA     TEMP,,AUTO

      203     4905    3               CALL LLM$MON_SVC (LL#WRITERU, LL_UREF_NAME$, TEMP,

   4905  3 000362   000015 236000 4                  LDQ     13
         3 000363   200041 756100                    STQ     @SIZE+4,,AUTO
         3 000364   200021 630500                    EPPR0   TEMP,,AUTO
         3 000365   200040 450500                    STP0    @SIZE+3,,AUTO
         3 000366   000024 237000 4                  LDAQ    20
         3 000367   200036 757100                    STAQ    @SIZE+1,,AUTO
         3 000370   200036 630500                    EPPR0   @SIZE+1,,AUTO
         3 000371   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000372   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000373   000000 011000                    NOP     0

      204     4906    3                  B$FEP_RUKEY);
      205     4907    3               END;

      206     4908    2           RETURN;

   4908  3 000374   000000 702200 xent               TSX2  ! X66_ARET

      207     4909    2           END;
      208     4910         /**/
      209     4911         /* Here we check LLS_INIT#.
      210     4912            If LLS_INIT# is set, then this is our first trip through this
      211     4913            module.  We glom onto some memory in an unused data segment
      212     4914            so that unsatisfied refs and ref names may be placed there. */
      213     4915         /**/
      214     4916    2       IF LLS_INIT# THEN DO;

   4916  3 000375   000000 234000 xsym               SZN     LLS_INIT#
         3 000376   000434 605000 3                  TPL     s:4931

      215     4917    2           LLS_INIT# = '0'B;

   4917  3 000377   000000 450000 xsym               STZ     LLS_INIT#
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:38   

      216     4918    2           VLP_NAME_SPACE.PTR$ = ADDR(NIL);

   4918  3 000400   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000401   000025 756000 1                  STQ     VLP_NAME_SPACE+1

      217     4919    2           CALL M$GDS (GET_NAME_SPACE) ALTRET (NO_MEMORY);

   4919  3 000402   000002 630400 1                  EPPR0   GET_NAME_SPACE
         3 000403   430001 713400                    CLIMB   alt,gds
         3 000404   400400 401760                    pmme    nvectors=2
         3 000405   001311 702000 3                  TSX2    NO_MEMORY

      218     4920    2           LL_UREF_NAME$ = VLP_NAME_SPACE.PTR$;

   4920  3 000406   000025 236000 1                  LDQ     VLP_NAME_SPACE+1
         3 000407   000000 756000 xsym               STQ     LL_UREF_NAME$

      219     4921    2           VLP_ENTREF_SPACE.PTR$ = ADDR(NIL);

   4921  3 000410   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000411   000027 756000 1                  STQ     VLP_ENTREF_SPACE+1

      220     4922    2           CALL M$GDS (GET_ENTREF_SPACE) ALTRET (NO_MEMORY);

   4922  3 000412   000010 630400 1                  EPPR0   GET_ENTREF_SPACE
         3 000413   430001 713400                    CLIMB   alt,gds
         3 000414   400400 401760                    pmme    nvectors=2
         3 000415   001311 702000 3                  TSX2    NO_MEMORY

      221     4923    2           LL_U_ENTREF$ = VLP_ENTREF_SPACE.PTR$;

   4923  3 000416   000027 236000 1                  LDQ     VLP_ENTREF_SPACE+1
         3 000417   000000 756000 xsym               STQ     LL_U_ENTREF$

      222     4924    2           VLP_SYMREF_SPACE.PTR$ = ADDR(NIL);

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:39   
   4924  3 000420   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000421   000031 756000 1                  STQ     VLP_SYMREF_SPACE+1

      223     4925    2           CALL M$GDS (GET_SYMREF_SPACE) ALTRET (NO_MEMORY);

   4925  3 000422   000016 630400 1                  EPPR0   GET_SYMREF_SPACE
         3 000423   430001 713400                    CLIMB   alt,gds
         3 000424   400400 401760                    pmme    nvectors=2
         3 000425   001311 702000 3                  TSX2    NO_MEMORY

      224     4926    2           LL_U_SYMREF$ = VLP_SYMREF_SPACE.PTR$;

   4926  3 000426   000031 236000 1                  LDQ     VLP_SYMREF_SPACE+1
         3 000427   000000 756000 xsym               STQ     LL_U_SYMREF$

      225     4927    2           LL_UREF_NAME_MAX = 1024;

   4927  3 000430   002000 235007                    LDA     1024,DL
         3 000431   000000 755000 xsym               STA     LL_UREF_NAME_MAX

      226     4928    2           LL_U_SYMREF_MAX = 1024;

   4928  3 000432   000000 755000 xsym               STA     LL_U_SYMREF_MAX

      227     4929    2           LL_U_ENTREF_MAX = 1024;

   4929  3 000433   000000 755000 xsym               STA     LL_U_ENTREF_MAX

      228     4930    2           END;

      229     4931    1       OU_NAME_IN_RECORD# = '0'B;

   4931  3 000434   200013 450100                    STZ     OU_NAME_IN_RECORD#,,AUTO

      230     4932    1       OU_NAME_INDEX = 0;

   4932  3 000435   000000 450000 xsym               STZ     OU_NAME_INDEX
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:40   

      231     4933    1       NUNSATS = 0;

   4933  3 000436   200006 470500                    LDP0    @NUNSATS,,AUTO
         3 000437   000000 450100                    STZ     0,,PR0

      232     4934    2       DO I = 0 TO NREFS - 1;

   4934  3 000440   200025 450100                    STZ     I,,AUTO
         3 000441   001302 710000 3                  TRA     s:5145+1

      233     4935    2           TPTR$ = ROOT$;

   4935  3 000442   200005 470500                    LDP0    @ROOT$,,AUTO
         3 000443   000000 236100                    LDQ     0,,PR0
         3 000444   200020 756100                    STQ     TPTR$,,AUTO

      234     4936    2           REF_PTR$ = PINCRW (REF$, I);

   4936  3 000445   200003 471500                    LDP1    @REF$,,AUTO
         3 000446   100000 473500                    LDP3    0,,PR1
         3 000447   200025 720100                    LXL0    I,,AUTO
         3 000450   300000 634510                    EPPR4   0,X0,PR3
         3 000451   200014 454500                    STP4    REF_PTR$,,AUTO

      235     4937    2           REFN_PTR$ = PINCRW (REFN$, REF_PTR$ -> REF.NPOINTER);

   4937  3 000452   400000 221100                    LDX1    0,,PR4
         3 000453   200011 475500                    LDP5    @REFN$,,AUTO
         3 000454   500000 476500                    LDP6    0,,PR5
         3 000455   600000 637511                    EPPR7   0,X1,PR6
         3 000456   200016 457500                    STP7    REFN_PTR$,,AUTO

      236     4938    2           VALUE = 0;

   4938  3 000457   200023 450100                    STZ     VALUE,,AUTO

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:41   
      237     4939    2           NOT_FOUND# = '1'B;

   4939  3 000460   400000 236003                    LDQ     -131072,DU
         3 000461   200024 756100                    STQ     NOT_FOUND#,,AUTO

      238     4940    3           DO WHILE (NOT_FOUND# & TPTR$ ~= ADDR(NIL));

   4940  3 000462   000514 710000 3                  TRA     s:4949

      239     4941    3               DEF_PTR$ = TPTR$ -> TREE.NODE$;

   4941  3 000463   200020 470500                    LDP0    TPTR$,,AUTO
         3 000464   000001 236100                    LDQ     1,,PR0
         3 000465   200015 756100                    STQ     DEF_PTR$,,AUTO

      240     4942    3               DEFN_PTR$ = PINCRW (DEFN$, DEF_PTR$ -> DEF.NPOINTER);

   4942  3 000466   200015 471500                    LDP1    DEF_PTR$,,AUTO
         3 000467   100001 220100                    LDX0    1,,PR1
         3 000470   200010 473500                    LDP3    @DEFN$,,AUTO
         3 000471   300000 474500                    LDP4    0,,PR3
         3 000472   400000 635510                    EPPR5   0,X0,PR4
         3 000473   200017 455500                    STP5    DEFN_PTR$,,AUTO

      241     4943    3               IF (REFN_PTR$ -> B$DNAME.TEXT > DEFN_PTR$ -> B$DNAME.TEXT)

   4943  3 000474   200016 476500                    LDP6    REFN_PTR$,,AUTO
         3 000475   600000 221100                    LDX1    0,,PR6
         3 000476   500000 222100                    LDX2    0,,PR5
         3 000477   040140 106540                    CMPC    fill='040'O
         3 000500   500000 400012                    ADSC9   0,,PR5                   cn=2,n=*X2
         3 000501   600000 400011                    ADSC9   0,,PR6                   cn=2,n=*X1
         3 000502   000506 603000 3                  TRC     s:4945

      242     4944    3               THEN TPTR$ = TPTR$ -> TREE.R_CHILD$;

   4944  3 000503   000005 236100                    LDQ     5,,PR0
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:42   
         3 000504   200020 756100                    STQ     TPTR$,,AUTO
         3 000505   000514 710000 3                  TRA     s:4949

      243     4945    3               ELSE IF (REFN_PTR$ -> B$DNAME.TEXT < DEFN_PTR$ -> B$DNAME.TEXT)

   4945  3 000506   000513 602000 3                  TNC     s:4948
         3 000507   000513 600000 3                  TZE     s:4948

      244     4946    3                   THEN TPTR$ = TPTR$ -> TREE.L_CHILD$;

   4946  3 000510   000004 236100                    LDQ     4,,PR0
         3 000511   200020 756100                    STQ     TPTR$,,AUTO
         3 000512   000514 710000 3                  TRA     s:4949

      245     4947    3                   ELSE
      246     4948    3                       NOT_FOUND# = '0'B;

   4948  3 000513   200024 450100                    STZ     NOT_FOUND#,,AUTO

      247     4949    3               END;

   4949  3 000514   400000 220003                    LDX0    -131072,DU
         3 000515   200020 236100                    LDQ     TPTR$,,AUTO
         3 000516   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000517   000521 601000 3                  TNZ     s:4949+5
         3 000520   000000 220003                    LDX0    0,DU
         3 000521   200024 236100                    LDQ     NOT_FOUND#,,AUTO
         3 000522   400000 376003                    ANQ     -131072,DU
         3 000523   200036 756100                    STQ     @SIZE+1,,AUTO
         3 000524   000000 636010                    EAQ     0,X0
         3 000525   200036 376100                    ANQ     @SIZE+1,,AUTO
         3 000526   000463 601000 3                  TNZ     s:4941

      248     4950    3           IF NOT NOT_FOUND# THEN DO;

   4950  3 000527   200024 234100                    SZN     NOT_FOUND#,,AUTO
         3 000530   000712 604000 3                  TMI     s:4993
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:43   

      249     4951    3               IF LL_FLAGS.BIAS_OU

   4951  3 000531   000000 236000 xsym               LDQ     LL_FLAGS
         3 000532   040000 316007                    CANQ    16384,DL
         3 000533   000575 600000 3                  TZE     s:4972

      250     4952    3               THEN
      251     4953    4               DO;

      252     4954    4                   IF OU$ = ADDR(NIL)

   4954  3 000534   200012 470500                    LDP0    @OU$,,AUTO
         3 000535   000000 236100                    LDQ     0,,PR0
         3 000536   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000537   000542 601000 3                  TNZ     s:4958

      253     4955    4                   THEN
      254     4956    4                       REGION = 0;

   4956  3 000540   200030 450100                    STZ     REGION,,AUTO
         3 000541   000547 710000 3                  TRA     s:4959

      255     4957    4                   ELSE
      256     4958    4                       REGION = OU$->OU_ENTRY.REGION;

   4958  3 000542   000000 471500                    LDP1    0,,PR0
         3 000543   100014 236100                    LDQ     12,,PR1
         3 000544   000033 772000                    QRL     27
         3 000545   000033 736000                    QLS     27
         3 000546   200030 756100                    STQ     REGION,,AUTO

      257     4959    4                   NEXT_REGION = 0;

   4959  3 000547   200031 450100                    STZ     NEXT_REGION,,AUTO

      258     4960    5                   DO WHILE (TPTR$ ~= ADDR(NIL));
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:44   

   4960  3 000550   000572 710000 3                  TRA     s:4970

      259     4961    5                       IF TPTR$->TREE.OU$ ~= ADDR(NIL)

   4961  3 000551   200020 470500                    LDP0    TPTR$,,AUTO
         3 000552   000000 236100                    LDQ     0,,PR0
         3 000553   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000554   000562 600000 3                  TZE     s:4964

      260     4962    5                       THEN
      261     4963    5                           NEXT_REGION =TPTR$->TREE.OU$->OU_ENTRY.REGION;

   4963  3 000555   000000 471500                    LDP1    0,,PR0
         3 000556   100014 236100                    LDQ     12,,PR1
         3 000557   000033 772000                    QRL     27
         3 000560   000033 736000                    QLS     27
         3 000561   200031 756100                    STQ     NEXT_REGION,,AUTO

      262     4964    5                       IF NEXT_REGION = REGION

   4964  3 000562   200031 236100                    LDQ     NEXT_REGION,,AUTO
         3 000563   200030 676100                    ERQ     REGION,,AUTO
         3 000564   777000 376003                    ANQ     -512,DU
         3 000565   000570 601000 3                  TNZ     s:4969

      263     4965    5                       THEN
      264     4966    6                       DO;

      265     4967    6                           DEF_PTR$ = TPTR$->TREE.NODE$;

   4967  3 000566   000001 236100                    LDQ     1,,PR0
         3 000567   200015 756100                    STQ     DEF_PTR$,,AUTO

      266     4968    6                           END;

      267     4969    5                       TPTR$ = TPTR$->TREE.BROTHER$;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:45   

   4969  3 000570   000002 236100                    LDQ     2,,PR0
         3 000571   200020 756100                    STQ     TPTR$,,AUTO

      268     4970    5                       END;

   4970  3 000572   200020 236100                    LDQ     TPTR$,,AUTO
         3 000573   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000574   000551 601000 3                  TNZ     s:4961

      269     4971    4                   END;

      270     4972    4               IF (TYPE = %TYPEREF) THEN DO;

   4972  3 000575   200007 470500                    LDP0    @TYPE,,AUTO
         3 000576   000000 235100                    LDA     0,,PR0
         3 000577   000005 115007                    CMPA    5,DL
         3 000600   000673 601000 3                  TNZ     s:4986

      271     4973    5                   IF (REF_PTR$->REF.CHECK AND DEF_PTR$->DEF.CHECK) THEN DO;

   4973  3 000601   200014 471500                    LDP1    REF_PTR$,,AUTO
         3 000602   100000 236100                    LDQ     0,,PR1
         3 000603   100000 316007                    CANQ    32768,DL
         3 000604   000673 600000 3                  TZE     s:4986
         3 000605   200015 473500                    LDP3    DEF_PTR$,,AUTO
         3 000606   300001 236100                    LDQ     1,,PR3
         3 000607   100000 316007                    CANQ    32768,DL
         3 000610   000673 600000 3                  TZE     s:4986

      272     4974    5                       IF ((REF_PTR$ -> REF.ALT ~= DEF_PTR$ -> DEF.ALT) OR

   4974  3 000611   100000 236100                    LDQ     0,,PR1
         3 000612   300001 676100                    ERQ     1,,PR3
         3 000613   200000 376007                    ANQ     65536,DL
         3 000614   000625 601000 3                  TNZ     s:4977
         3 000615   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:46   
         3 000616   300001 676100                    ERQ     1,,PR3
         3 000617   074000 376007                    ANQ     30720,DL
         3 000620   000625 601000 3                  TNZ     s:4977
         3 000621   100000 236100                    LDQ     0,,PR1
         3 000622   300001 676100                    ERQ     1,,PR3
         3 000623   003777 376007                    ANQ     2047,DL
         3 000624   000673 600000 3                  TZE     s:4986

      273     4975    5                          (REF_PTR$ -> REF.CST ~= DEF_PTR$ -> DEF.CST) OR
      274     4976    6                          (REF_PTR$ -> REF.NPARAM ~= DEF_PTR$ -> DEF.NPARAM)) THEN DO;

      275     4977    6                           LL_DOBUF = 'A  ***Calling sequence mismatch on reference ';

   4977  3 000625   040000 100400                    MLR     fill='040'O
         3 000626   000054 000055 2                  ADSC9   TEXTC$+44                cn=0,n=45
         3 000627   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      276     4978    6                           CALL INSERT (LL_DOBUF,45,,

   4978  3 000630   200016 474500                    LDP4    REFN_PTR$,,AUTO
         3 000631   400000 220100                    LDX0    0,,PR4
         3 000632   200012 475500                    LDP5    @OU$,,AUTO
         3 000633   500000 476500                    LDP6    0,,PR5
         3 000634   600015 236100                    LDQ     13,,PR6
         3 000635   000033 772000                    QRL     27
         3 000636   040000 100540                    MLR     fill='040'O
         3 000637   400000 400010                    ADSC9   0,,PR4                   cn=2,n=*X0
         3 000640   000013 200103 xsym               ADSC9   LL_DOBUF+11              cn=1,n=67
         3 000641   000000 621006                    EAX1    0,QL
         3 000642   000000 636010                    EAQ     0,X0
         3 000643   000022 772000                    QRL     18
         3 000644   000103 116007                    CMPQ    67,DL
         3 000645   000667 603000 3                  TRC     s:4982
         3 000646   200036 740100                    STX0    @SIZE+1,,AUTO
         3 000647   777674 620010                    EAX0    -68,X0
         3 000650   777777 660003                    ERX0    -1,DU
         3 000651   200036 235100                    LDA     @SIZE+1,,AUTO
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:47   
         3 000652   000022 771000                    ARL     18
         3 000653   040045 100400                    MLR     fill='040'O
         3 000654   000070 000020 2                  ADSC9   TEXTC$+56                cn=0,n=16
         3 000655   000013 200010 xsym               ADSC9   LL_DOBUF+11,A            cn=1,n=*X0
         3 000656   200036 236100                    LDQ     @SIZE+1,,AUTO
         3 000657   000022 772000                    QRL     18
         3 000660   000063 116007                    CMPQ    51,DL
         3 000661   000667 603000 3                  TRC     s:4982
         3 000662   777714 620006                    EAX0    -52,QL
         3 000663   777777 660003                    ERX0    -1,DU
         3 000664   040046 100540                    MLR     fill='040'O
         3 000665   600015 200011                    ADSC9   13,,PR6                  cn=1,n=*X1
         3 000666   000017 200010 xsym               ADSC9   LL_DOBUF+15,Q            cn=1,n=*X0

      277     4979    6                              REFN_PTR$ -> B$DNAME.TEXT,
      278     4980    6                              ' of object unit ',
      279     4981    6                              OU$ -> OU_ENTRY.OUNAME.TEXT);
      280     4982    6                           CALL LLM$MON_SVC (LL#WRITEDO);

   4982  3 000667   000007 630400 4                  EPPR0   7
         3 000670   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000671   000000 701000 xent               TSX1    LLM$MON_SVC
         3 000672   000000 011000                    NOP     0

      281     4983    6                           END;

      282     4984    5                       END;

      283     4985    4                   END;

      284     4986    3               REF_PTR$ -> ISADDR = DEF_PTR$ -> DEF.ISADDR;

   4986  3 000673   200015 470500                    LDP0    DEF_PTR$,,AUTO
         3 000674   200014 471500                    LDP1    REF_PTR$,,AUTO
         3 000675   000000 236100                    LDQ     0,,PR0
         3 000676   000032 376000 xsym               ANQ     B_VECTNIL+26
         3 000677   100000 756100                    STQ     0,,PR1
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:48   

      285     4987    3               IF ( TYPE = %TYPEREF ) THEN

   4987  3 000700   200007 473500                    LDP3    @TYPE,,AUTO
         3 000701   300000 235100                    LDA     0,,PR3
         3 000702   000005 115007                    CMPA    5,DL
         3 000703   000707 601000 3                  TNZ     s:4990

      286     4988    3                   DEF_PTR$ -> LL_ENTDEF.LFLAGS.USED = '1'B;

   4988  3 000704   010000 236003                    LDQ     4096,DU
         3 000705   000000 256100                    ORSQ    0,,PR0
         3 000706   001301 710000 3                  TRA     s:5145

      287     4989    3               ELSE
      288     4990    3                   DEF_PTR$ -> LL_SYMDEF.LFLAGS.USED = '1'B;

   4990  3 000707   100000 236007                    LDQ     32768,DL
         3 000710   000001 256100                    ORSQ    1,,PR0

      289     4991    3               END;

   4991  3 000711   001301 710000 3                  TRA     s:5145

      290     4992    3           ELSE DO;

      291     4993    4               IF NOT OU_NAME_IN_RECORD# THEN DO;

   4993  3 000712   200013 234100                    SZN     OU_NAME_IN_RECORD#,,AUTO
         3 000713   000776 604000 3                  TMI     s:5016

      292     4994    4                   OU_NAME_IN_RECORD# = '1'B;

   4994  3 000714   400000 236003                    LDQ     -131072,DU
         3 000715   200013 756100                    STQ     OU_NAME_IN_RECORD#,,AUTO

      293     4995    4                   TEMP = ( OU$ -> OU_ENTRY.OUNAME.SIZE + 5 ) / 4;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:49   

   4995  3 000716   200012 470500                    LDP0    @OU$,,AUTO
         3 000717   000000 471500                    LDP1    0,,PR0
         3 000720   100015 236100                    LDQ     13,,PR1
         3 000721   000033 772000                    QRL     27
         3 000722   000005 036007                    ADLQ    5,DL
         3 000723   000002 772000                    QRL     2
         3 000724   200021 756100                    STQ     TEMP,,AUTO

      294     4996         /**/
      295     4997         /*
      296     4998            TEMP contains the number of words occupied by the OU name.
      297     4999         */
      298     5000         /**/
      299     5001    5                   IF TEMP + LL_UREF_NAME_CUR >LL_UREF_NAME_MAX THEN DO;

   5001  3 000725   000000 036000 xsym               ADLQ    LL_UREF_NAME_CUR
         3 000726   000000 116000 xsym               CMPQ    LL_UREF_NAME_MAX
         3 000727   000740 602000 3                  TNC     s:5006
         3 000730   000740 600000 3                  TZE     s:5006

      300     5002    5                       CALL M$GDS (GET_NAME_SPACE)

   5002  3 000731   000002 630400 1                  EPPR0   GET_NAME_SPACE
         3 000732   430001 713400                    CLIMB   alt,gds
         3 000733   400400 401760                    pmme    nvectors=2
         3 000734   001311 702000 3                  TSX2    NO_MEMORY

      301     5003    5                          ALTRET (NO_MEMORY);
      302     5004    5                       LL_UREF_NAME_MAX =LL_UREF_NAME_MAX + 1024;

   5004  3 000735   000000 235000 xsym               LDA     LL_UREF_NAME_MAX
         3 000736   002000 035007                    ADLA    1024,DL
         3 000737   000000 755000 xsym               STA     LL_UREF_NAME_MAX

      303     5005    5                       END;

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:50   
      304     5006    4                   REFN_PTR$ = PINCRW (LL_UREF_NAME$, LL_UREF_NAME_CUR );

   5006  3 000740   000000 236000 xsym               LDQ     LL_UREF_NAME_CUR
         3 000741   000022 736000                    QLS     18
         3 000742   000000 036000 xsym               ADLQ    LL_UREF_NAME$
         3 000743   200016 756100                    STQ     REFN_PTR$,,AUTO

      305     5007    4                   REFN_PTR$ -> B$DNAME.COUNT = TEMP * 4 - 2;

   5007  3 000744   200021 235100                    LDA     TEMP,,AUTO
         3 000745   000002 735000                    ALS     2
         3 000746   777776 620005                    EAX0    -2,AL
         3 000747   200016 470500                    LDP0    REFN_PTR$,,AUTO
         3 000750   000000 740100                    STX0    0,,PR0

      306     5008    4                   REFN_PTR$ -> B$DNAME.TEXT = ' ';

   5008  3 000751   040140 100400                    MLR     fill='040'O
         3 000752   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000753   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0

      307     5009    4                   REFN_PTR$ -> B$DNAME.COUNT =

   5009  3 000754   200012 471500                    LDP1    @OU$,,AUTO
         3 000755   100000 473500                    LDP3    0,,PR1
         3 000756   300015 236100                    LDQ     13,,PR3
         3 000757   000033 772000                    QRL     27
         3 000760   000000 621006                    EAX1    0,QL
         3 000761   000000 741100                    STX1    0,,PR0

      308     5010    4                      OU$ -> OU_ENTRY.OUNAME.SIZE;
      309     5011    4                   REFN_PTR$ -> B$DNAME.TEXT =

   5011  3 000762   100000 473500                    LDP3    0,,PR1
         3 000763   300015 236100                    LDQ     13,,PR3
         3 000764   000033 772000                    QRL     27
         3 000765   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:51   
         3 000766   040140 100540                    MLR     fill='040'O
         3 000767   300015 200010                    ADSC9   13,,PR3                  cn=1,n=*X0
         3 000770   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1

      310     5012    4                      OU$ -> OU_ENTRY.OUNAME.TEXT;
      311     5013    4                   OU_NAME_INDEX = LL_UREF_NAME_CUR;

   5013  3 000771   000000 235000 xsym               LDA     LL_UREF_NAME_CUR
         3 000772   000000 755000 xsym               STA     OU_NAME_INDEX

      312     5014    4                   LL_UREF_NAME_CUR = LL_UREF_NAME_CUR + TEMP;

   5014  3 000773   000000 236000 xsym               LDQ     LL_UREF_NAME_CUR
         3 000774   200021 036100                    ADLQ    TEMP,,AUTO
         3 000775   000000 756000 xsym               STQ     LL_UREF_NAME_CUR

      313     5015    4                   END;

      314     5016    4               IF TYPE = 5 THEN DO;

   5016  3 000776   200007 470500                    LDP0    @TYPE,,AUTO
         3 000777   000000 235100                    LDA     0,,PR0
         3 001000   000005 115007                    CMPA    5,DL
         3 001001   001135 601000 3                  TNZ     s:5084

      315     5017         /**/
      316     5018         /*
      317     5019            We have an unsatisfied entref....Put him in the entref record.
      318     5020         */
      319     5021         /**/
      320     5022    4                   TEMP = SIZEW ( B$FEP_UNSATREF );

   5022  3 001002   000001 236007                    LDQ     1,DL
         3 001003   200021 756100                    STQ     TEMP,,AUTO

      321     5023    5                   IF TEMP + LL_U_ENTREF_CUR > LL_U_ENTREF_MAX THEN DO;

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:52   
   5023  3 001004   000000 036000 xsym               ADLQ    LL_U_ENTREF_CUR
         3 001005   000000 116000 xsym               CMPQ    LL_U_ENTREF_MAX
         3 001006   001017 602000 3                  TNC     s:5028
         3 001007   001017 600000 3                  TZE     s:5028

      322     5024    5                       CALL M$GDS (GET_ENTREF_SPACE)

   5024  3 001010   000010 630400 1                  EPPR0   GET_ENTREF_SPACE
         3 001011   430001 713400                    CLIMB   alt,gds
         3 001012   400400 401760                    pmme    nvectors=2
         3 001013   001311 702000 3                  TSX2    NO_MEMORY

      323     5025    5                          ALTRET (NO_MEMORY);
      324     5026    5                       LL_U_ENTREF_MAX = LL_U_ENTREF_MAX + 1024;

   5026  3 001014   000000 235000 xsym               LDA     LL_U_ENTREF_MAX
         3 001015   002000 035007                    ADLA    1024,DL
         3 001016   000000 755000 xsym               STA     LL_U_ENTREF_MAX

      325     5027    5                       END;

      326     5028    4                   TPTR$ = PINCRW (LL_U_ENTREF$,LL_U_ENTREF_CUR );

   5028  3 001017   000000 236000 xsym               LDQ     LL_U_ENTREF_CUR
         3 001020   000022 736000                    QLS     18
         3 001021   000000 036000 xsym               ADLQ    LL_U_ENTREF$
         3 001022   200020 756100                    STQ     TPTR$,,AUTO

      327     5029    4                   TPTR$ -> B$FEP_UNSATREF.OPOINTER =

   5029  3 001023   200020 470500                    LDP0    TPTR$,,AUTO
         3 001024   000000 236000 xsym               LDQ     OU_NAME_INDEX
         3 001025   000000 676100                    ERQ     0,,PR0
         3 001026   377777 376007                    ANQ     131071,DL
         3 001027   000000 656100                    ERSQ    0,,PR0

      328     5030    4                      OU_NAME_INDEX;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:53   
      329     5031    4                   TPTR$ -> B$FEP_UNSATREF.SREF =

   5031  3 001030   200014 471500                    LDP1    REF_PTR$,,AUTO
         3 001031   100000 236100                    LDQ     0,,PR1
         3 001032   000000 676100                    ERQ     0,,PR0
         3 001033   400000 376007                    ANQ     -131072,DL
         3 001034   000000 656100                    ERSQ    0,,PR0

      330     5032    4                      REF_PTR$ -> REF.SREF;
      331     5033         /**/
      332     5034         /*
      333     5035            Figure out how much space the ref name is going to take up
      334     5036            so that we can make sure that we have enough memory.
      335     5037         */
      336     5038         /**/
      337     5039    4                   TEMP = REF_PTR$ -> REF.NPOINTER;

   5039  3 001035   100000 236100                    LDQ     0,,PR1
         3 001036   000022 732000                    QRS     18
         3 001037   200021 756100                    STQ     TEMP,,AUTO

      338     5040    4                   REFN_PTR$ = PINCRW ( REFN$, TEMP );

   5040  3 001040   200011 473500                    LDP3    @REFN$,,AUTO
         3 001041   300000 474500                    LDP4    0,,PR3
         3 001042   400000 635506                    EPPR5   0,QL,PR4
         3 001043   200016 455500                    STP5    REFN_PTR$,,AUTO

      339     5041    4                   TEMP = REFN_PTR$ -> B$DNAME.COUNT;

   5041  3 001044   500000 236100                    LDQ     0,,PR5
         3 001045   000022 772000                    QRL     18
         3 001046   200021 756100                    STQ     TEMP,,AUTO

      340     5042    4                   TEMP = ( TEMP + 5 ) / 4;

   5042  3 001047   000005 036007                    ADLQ    5,DL
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:54   
         3 001050   000002 772000                    QRL     2
         3 001051   200021 756100                    STQ     TEMP,,AUTO

      341     5043         /**/
      342     5044         /*
      343     5045            TEMP contains the number of words the ref name will take up.
      344     5046         */
      345     5047         /**/
      346     5048    4                   IF TEMP + LL_UREF_NAME_CUR > LL_UREF_NAME_MAX

   5048  3 001052   000000 036000 xsym               ADLQ    LL_UREF_NAME_CUR
         3 001053   000000 116000 xsym               CMPQ    LL_UREF_NAME_MAX
         3 001054   001065 602000 3                  TNC     s:5054
         3 001055   001065 600000 3                  TZE     s:5054

      347     5049    5                   THEN DO;

      348     5050    5                       CALL M$GDS (GET_NAME_SPACE)

   5050  3 001056   000002 630400 1                  EPPR0   GET_NAME_SPACE
         3 001057   430001 713400                    CLIMB   alt,gds
         3 001060   400400 401760                    pmme    nvectors=2
         3 001061   001311 702000 3                  TSX2    NO_MEMORY

      349     5051    5                          ALTRET (NO_MEMORY);
      350     5052    5                       LL_UREF_NAME_MAX = LL_UREF_NAME_MAX + 1024;

   5052  3 001062   000000 235000 xsym               LDA     LL_UREF_NAME_MAX
         3 001063   002000 035007                    ADLA    1024,DL
         3 001064   000000 755000 xsym               STA     LL_UREF_NAME_MAX

      351     5053    5                       END;

      352     5054    4                   TPTR$ -> B$FEP_UNSATREF.NPOINTER =

   5054  3 001065   000000 720000 xsym               LXL0    LL_UREF_NAME_CUR
         3 001066   200020 470500                    LDP0    TPTR$,,AUTO
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:55   
         3 001067   000000 740100                    STX0    0,,PR0

      353     5055    4                      LL_UREF_NAME_CUR;
      354     5056    4                   LL_U_ENTREF_CUR = LL_U_ENTREF_CUR +

   5056  3 001070   000000 235000 xsym               LDA     LL_U_ENTREF_CUR
         3 001071   000001 035007                    ADLA    1,DL
         3 001072   000000 755000 xsym               STA     LL_U_ENTREF_CUR

      355     5057    4                      SIZEW ( B$FEP_UNSATREF );
      356     5058         /**/
      357     5059         /*
      358     5060            The ref entry is built.  Move in the name.
      359     5061         */
      360     5062         /**/
      361     5063    4                   TPTR$ = PINCRW (LL_UREF_NAME$,LL_UREF_NAME_CUR );

   5063  3 001073   000000 236000 xsym               LDQ     LL_UREF_NAME_CUR
         3 001074   000022 736000                    QLS     18
         3 001075   000000 036000 xsym               ADLQ    LL_UREF_NAME$
         3 001076   200020 756100                    STQ     TPTR$,,AUTO

      362     5064    4                   TPTR$ -> B$DNAME.COUNT = TEMP * 4 - 2;

   5064  3 001077   200021 235100                    LDA     TEMP,,AUTO
         3 001100   000002 735000                    ALS     2
         3 001101   777776 620005                    EAX0    -2,AL
         3 001102   200020 470500                    LDP0    TPTR$,,AUTO
         3 001103   000000 740100                    STX0    0,,PR0

      363     5065    4                   TPTR$ -> B$DNAME.TEXT = ' ';

   5065  3 001104   040140 100400                    MLR     fill='040'O
         3 001105   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001106   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0

      364     5066    4                   TPTR$ -> B$DNAME.COUNT = REFN_PTR$ ->
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:56   

   5066  3 001107   200016 471500                    LDP1    REFN_PTR$,,AUTO
         3 001110   100000 221100                    LDX1    0,,PR1
         3 001111   000000 741100                    STX1    0,,PR0

      365     5067    4                      B$DNAME.COUNT;
      366     5068    4                   TPTR$ -> B$DNAME.TEXT = REFN_PTR$ ->

   5068  3 001112   100000 220100                    LDX0    0,,PR1
         3 001113   040140 100540                    MLR     fill='040'O
         3 001114   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         3 001115   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1

      367     5069    4                      B$DNAME.TEXT;
      368     5070    4                   LL_UREF_NAME_CUR = LL_UREF_NAME_CUR + TEMP;

   5070  3 001116   000000 236000 xsym               LDQ     LL_UREF_NAME_CUR
         3 001117   200021 036100                    ADLQ    TEMP,,AUTO
         3 001120   000000 756000 xsym               STQ     LL_UREF_NAME_CUR

      369     5071    4                   IF REF_PTR$ -> REF.SREF THEN

   5071  3 001121   200014 473500                    LDP3    REF_PTR$,,AUTO
         3 001122   300000 236100                    LDQ     0,,PR3
         3 001123   400000 316007                    CANQ    -131072,DL
         3 001124   001131 600000 3                  TZE     s:5075

      370     5072    4                       LL_U_SECONDARY_ENTREF_COUNT =

   5072  3 001125   000000 235000 xsym               LDA     LL_U_SECONDARY_ENTREF_COUNT
         3 001126   000001 035007                    ADLA    1,DL
         3 001127   000000 755000 xsym               STA     LL_U_SECONDARY_ENTREF_COUNT
         3 001130   001267 710000 3                  TRA     s:5140

      371     5073    4                          LL_U_SECONDARY_ENTREF_COUNT + 1;
      372     5074    4                   ELSE
      373     5075    4                       LL_U_PRIMARY_ENTREF_COUNT =
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:57   

   5075  3 001131   000000 235000 xsym               LDA     LL_U_PRIMARY_ENTREF_COUNT
         3 001132   000001 035007                    ADLA    1,DL
         3 001133   000000 755000 xsym               STA     LL_U_PRIMARY_ENTREF_COUNT

      374     5076    4                          LL_U_PRIMARY_ENTREF_COUNT + 1;
      375     5077    4                   END;

   5077  3 001134   001267 710000 3                  TRA     s:5140

      376     5078    4               ELSE DO;

      377     5079         /**/
      378     5080         /*
      379     5081            We have an unsatisfied symref....Put him in the entref record.
      380     5082         */
      381     5083         /**/
      382     5084    4                   TEMP = SIZEW ( B$FEP_UNSATREF );

   5084  3 001135   000001 236007                    LDQ     1,DL
         3 001136   200021 756100                    STQ     TEMP,,AUTO

      383     5085    5                   IF TEMP + LL_U_SYMREF_CUR >LL_U_SYMREF_MAX THEN DO;

   5085  3 001137   000000 036000 xsym               ADLQ    LL_U_SYMREF_CUR
         3 001140   000000 116000 xsym               CMPQ    LL_U_SYMREF_MAX
         3 001141   001152 602000 3                  TNC     s:5090
         3 001142   001152 600000 3                  TZE     s:5090

      384     5086    5                       CALL M$GDS (GET_SYMREF_SPACE)

   5086  3 001143   000016 630400 1                  EPPR0   GET_SYMREF_SPACE
         3 001144   430001 713400                    CLIMB   alt,gds
         3 001145   400400 401760                    pmme    nvectors=2
         3 001146   001311 702000 3                  TSX2    NO_MEMORY

      385     5087    5                          ALTRET (NO_MEMORY);
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:58   
      386     5088    5                       LL_U_SYMREF_MAX = LL_U_SYMREF_MAX + 1024;

   5088  3 001147   000000 235000 xsym               LDA     LL_U_SYMREF_MAX
         3 001150   002000 035007                    ADLA    1024,DL
         3 001151   000000 755000 xsym               STA     LL_U_SYMREF_MAX

      387     5089    5                       END;

      388     5090    4                   TPTR$ = PINCRW (LL_U_SYMREF$,LL_U_SYMREF_CUR );

   5090  3 001152   000000 236000 xsym               LDQ     LL_U_SYMREF_CUR
         3 001153   000022 736000                    QLS     18
         3 001154   000000 036000 xsym               ADLQ    LL_U_SYMREF$
         3 001155   200020 756100                    STQ     TPTR$,,AUTO

      389     5091    4                   TPTR$ -> B$FEP_UNSATREF.OPOINTER =

   5091  3 001156   200020 470500                    LDP0    TPTR$,,AUTO
         3 001157   000000 236000 xsym               LDQ     OU_NAME_INDEX
         3 001160   000000 676100                    ERQ     0,,PR0
         3 001161   377777 376007                    ANQ     131071,DL
         3 001162   000000 656100                    ERSQ    0,,PR0

      390     5092    4                      OU_NAME_INDEX;
      391     5093    4                   TPTR$ -> B$FEP_UNSATREF.SREF =

   5093  3 001163   200014 471500                    LDP1    REF_PTR$,,AUTO
         3 001164   100000 236100                    LDQ     0,,PR1
         3 001165   000000 676100                    ERQ     0,,PR0
         3 001166   400000 376007                    ANQ     -131072,DL
         3 001167   000000 656100                    ERSQ    0,,PR0

      392     5094    4                      REF_PTR$ -> REF.SREF;
      393     5095         /**/
      394     5096         /*
      395     5097            Figure out how much space the ref name is going to take up
      396     5098            so that we can make sure that we have enough memory.
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:59   
      397     5099         */
      398     5100         /**/
      399     5101    4                   TEMP = REF_PTR$ -> REF.NPOINTER;

   5101  3 001170   100000 236100                    LDQ     0,,PR1
         3 001171   000022 732000                    QRS     18
         3 001172   200021 756100                    STQ     TEMP,,AUTO

      400     5102    4                   REFN_PTR$ = PINCRW ( REFN$, TEMP );

   5102  3 001173   200011 473500                    LDP3    @REFN$,,AUTO
         3 001174   300000 474500                    LDP4    0,,PR3
         3 001175   400000 635506                    EPPR5   0,QL,PR4
         3 001176   200016 455500                    STP5    REFN_PTR$,,AUTO

      401     5103    4                   TEMP = REFN_PTR$ -> B$DNAME.COUNT;

   5103  3 001177   500000 236100                    LDQ     0,,PR5
         3 001200   000022 772000                    QRL     18
         3 001201   200021 756100                    STQ     TEMP,,AUTO

      402     5104    4                   TEMP = ( TEMP + 5 ) / 4;

   5104  3 001202   000005 036007                    ADLQ    5,DL
         3 001203   000002 772000                    QRL     2
         3 001204   200021 756100                    STQ     TEMP,,AUTO

      403     5105         /**/
      404     5106         /*
      405     5107            TEMP contains the number of words the ref name will take up.
      406     5108         */
      407     5109         /**/
      408     5110    4                   IF TEMP + LL_UREF_NAME_CUR > LL_UREF_NAME_MAX

   5110  3 001205   000000 036000 xsym               ADLQ    LL_UREF_NAME_CUR
         3 001206   000000 116000 xsym               CMPQ    LL_UREF_NAME_MAX
         3 001207   001220 602000 3                  TNC     s:5116
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:60   
         3 001210   001220 600000 3                  TZE     s:5116

      409     5111    5                   THEN DO;

      410     5112    5                       CALL M$GDS (GET_NAME_SPACE)

   5112  3 001211   000002 630400 1                  EPPR0   GET_NAME_SPACE
         3 001212   430001 713400                    CLIMB   alt,gds
         3 001213   400400 401760                    pmme    nvectors=2
         3 001214   001311 702000 3                  TSX2    NO_MEMORY

      411     5113    5                          ALTRET (NO_MEMORY);
      412     5114    5                       LL_UREF_NAME_MAX = LL_UREF_NAME_MAX + 1024;

   5114  3 001215   000000 235000 xsym               LDA     LL_UREF_NAME_MAX
         3 001216   002000 035007                    ADLA    1024,DL
         3 001217   000000 755000 xsym               STA     LL_UREF_NAME_MAX

      413     5115    5                       END;

      414     5116    4                   TPTR$ -> B$FEP_UNSATREF.NPOINTER =

   5116  3 001220   000000 720000 xsym               LXL0    LL_UREF_NAME_CUR
         3 001221   200020 470500                    LDP0    TPTR$,,AUTO
         3 001222   000000 740100                    STX0    0,,PR0

      415     5117    4                      LL_UREF_NAME_CUR;
      416     5118    4                   LL_U_SYMREF_CUR = LL_U_SYMREF_CUR +

   5118  3 001223   000000 235000 xsym               LDA     LL_U_SYMREF_CUR
         3 001224   000001 035007                    ADLA    1,DL
         3 001225   000000 755000 xsym               STA     LL_U_SYMREF_CUR

      417     5119    4                      SIZEW ( B$FEP_UNSATREF );
      418     5120         /**/
      419     5121         /*
      420     5122            The ref entry is built.  Move in the name.
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:61   
      421     5123         */
      422     5124         /**/
      423     5125    4                   TPTR$ = PINCRW (LL_UREF_NAME$,LL_UREF_NAME_CUR );

   5125  3 001226   000000 236000 xsym               LDQ     LL_UREF_NAME_CUR
         3 001227   000022 736000                    QLS     18
         3 001230   000000 036000 xsym               ADLQ    LL_UREF_NAME$
         3 001231   200020 756100                    STQ     TPTR$,,AUTO

      424     5126    4                   TPTR$ -> B$DNAME.COUNT = TEMP * 4 - 2;

   5126  3 001232   200021 235100                    LDA     TEMP,,AUTO
         3 001233   000002 735000                    ALS     2
         3 001234   777776 620005                    EAX0    -2,AL
         3 001235   200020 470500                    LDP0    TPTR$,,AUTO
         3 001236   000000 740100                    STX0    0,,PR0

      425     5127    4                   TPTR$ -> B$DNAME.TEXT = ' ';

   5127  3 001237   040140 100400                    MLR     fill='040'O
         3 001240   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001241   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0

      426     5128    4                   TPTR$ -> B$DNAME.COUNT = REFN_PTR$ ->

   5128  3 001242   200016 471500                    LDP1    REFN_PTR$,,AUTO
         3 001243   100000 221100                    LDX1    0,,PR1
         3 001244   000000 741100                    STX1    0,,PR0

      427     5129    4                      B$DNAME.COUNT;
      428     5130    4                   TPTR$ -> B$DNAME.TEXT = REFN_PTR$ ->

   5130  3 001245   100000 220100                    LDX0    0,,PR1
         3 001246   040140 100540                    MLR     fill='040'O
         3 001247   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         3 001250   000000 400011                    ADSC9   0,,PR0                   cn=2,n=*X1

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:62   
      429     5131    4                      B$DNAME.TEXT;
      430     5132    4                   LL_UREF_NAME_CUR = LL_UREF_NAME_CUR + TEMP;

   5132  3 001251   000000 236000 xsym               LDQ     LL_UREF_NAME_CUR
         3 001252   200021 036100                    ADLQ    TEMP,,AUTO
         3 001253   000000 756000 xsym               STQ     LL_UREF_NAME_CUR

      431     5133    4                   IF REF_PTR$ -> REF.SREF THEN

   5133  3 001254   200014 473500                    LDP3    REF_PTR$,,AUTO
         3 001255   300000 236100                    LDQ     0,,PR3
         3 001256   400000 316007                    CANQ    -131072,DL
         3 001257   001264 600000 3                  TZE     s:5137

      432     5134    4                       LL_U_SECONDARY_SYMREF_COUNT =

   5134  3 001260   000000 235000 xsym               LDA     LL_U_SECONDARY_SYMREF_COUNT
         3 001261   000001 035007                    ADLA    1,DL
         3 001262   000000 755000 xsym               STA     LL_U_SECONDARY_SYMREF_COUNT
         3 001263   001267 710000 3                  TRA     s:5140

      433     5135    4                          LL_U_SECONDARY_SYMREF_COUNT + 1;
      434     5136    4                   ELSE
      435     5137    4                       LL_U_PRIMARY_SYMREF_COUNT =

   5137  3 001264   000000 235000 xsym               LDA     LL_U_PRIMARY_SYMREF_COUNT
         3 001265   000001 035007                    ADLA    1,DL
         3 001266   000000 755000 xsym               STA     LL_U_PRIMARY_SYMREF_COUNT

      436     5138    4                          LL_U_PRIMARY_SYMREF_COUNT + 1;
      437     5139    4                   END;

      438     5140    3               IF ( NOT REF_PTR$ -> REF.SREF) AND

   5140  3 001267   300000 236100                    LDQ     0,,PR3
         3 001270   400000 316007                    CANQ    -131072,DL
         3 001271   001300 601000 3                  TNZ     s:5143
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:63   
         3 001272   000003 236000 xsym               LDQ     LL_HEAD+3
         3 001273   777000 376003                    ANQ     -512,DU
         3 001274   007000 116003                    CMPQ    3584,DU
         3 001275   001300 603000 3                  TRC     s:5143

      439     5141    3                  LL_HEAD.SEV < 7 THEN
      440     5142    3                   LL_HEAD.SEV = 7;

   5142  3 001276   007000 236003                    LDQ     3584,DU
         3 001277   000003 552040 xsym               STBQ    LL_HEAD+3,'40'O

      441     5143    3               REF_PTR$ -> ISADDR = 0;

   5143  3 001300   300000 450100                    STZ     0,,PR3

      442     5144    3               END;

      443     5145    2           END;

   5145  3 001301   200025 054100                    AOS     I,,AUTO
         3 001302   200004 470500                    LDP0    @NREFS,,AUTO
         3 001303   200025 236100                    LDQ     I,,AUTO
         3 001304   000442 604000 3                  TMI     s:4935
         3 001305   000000 116100                    CMPQ    0,,PR0
         3 001306   000442 602000 3                  TNC     s:4935

      444     5146    1       OU_NAME_IN_RECORD# = '0'B;

   5146  3 001307   200013 450100                    STZ     OU_NAME_IN_RECORD#,,AUTO

      445     5147    1       RETURN;

   5147  3 001310   000000 702200 xent               TSX2  ! X66_ARET

      446     5148        %EJECT;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:64   
      447     5149    1   NO_MEMORY:
      448     5150    1       CALL LLM$MON_SVC (LL#GETMEM);

   5150  3 001311   000021 630400 4     NO_MEMORY    EPPR0   17
         3 001312   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001313   000000 701000 xent               TSX1    LLM$MON_SVC
         3 001314   000000 011000                    NOP     0
         3 001315   001472 710000 3                  TRA     s:5237

      449     5151        %EJECT;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:65   
      450     5152    1   LLS$SORT: PROC ( NAME$, RCD$, SIZE );

   5152  3 001316   200032 741300       LLS$SORT     STX1  ! NEXT_REGION+1,,AUTO

      451     5153         /**/
      452     5154    2   DCL NAME$ PTR; /* Pointer to ref names record */
      453     5155    2   DCL RCD$ PTR; /* Pointer to ref record */
      454     5156    2   DCL SIZE UBIN WORD ALIGNED; /* Contains the word size of the ref record */
      455     5157         /**/
      456     5158        %LL$UNSATREF ( NAME = STATIC$FEP_UNSATREF,
      457     5159         STCLASS = STATIC );
      458     5172         /***
      459     5173            *** STATIC
      460     5174            ***/
      461     5175
      462     5176    2   DCL COUNT SBIN STATIC;
      463     5177    2   DCL M SBIN STATIC;
      464     5178    2   DCL LAST_SWAP_IX SBIN STATIC;
      465     5179    2   DCL SWAP_UPTO_IX SBIN STATIC;
      466     5180    2   DCL PTR_I_REF$ PTR STATIC;
      467     5181    2   DCL PTR_I_NAME$ PTR STATIC;
      468     5182    2   DCL PTR_J_REF$ PTR STATIC;
      469     5183    2   DCL PTR_J_NAME$ PTR STATIC;
      470     5184
      471     5185         /********************/
      472     5186
      473     5187         /***
      474     5188            *** Algorithm: enhanced shell sort.  Should start M at log base 2
      475     5189            *** of COUNT, but 6 is a decent compromise.
      476     5190            ***/
      477     5191
      478     5192    2       COUNT = SIZE / SIZEW(B$FEP_UNSATREF) - 1;

   5192  3 001317   200035 470500                    LDP0    @SIZE,,AUTO
         3 001320   000000 235100                    LDA     0,,PR0
         3 001321   000001 135007                    SBLA    1,DL
         3 001322   000036 755000 1                  STA     COUNT
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:66   

      479     5193    3       DO M = MAXIMUM(1,(COUNT+1)/6) DOWNTO 1;

   5193  3 001323   000036 236000 1                  LDQ     COUNT
         3 001324   000001 036007                    ADLQ    1,DL
         3 001325   000006 506007                    DIV     6,DL
         3 001326   000001 116007                    CMPQ    1,DL
         3 001327   001331 605000 3                  TPL     s:5193+6
         3 001330   000001 236007                    LDQ     1,DL
         3 001331   000037 756000 1                  STQ     M
         3 001332   001417 710000 3                  TRA     s:5213+2

      480     5194    3           LAST_SWAP_IX = COUNT;

   5194  3 001333   000036 235000 1                  LDA     COUNT
         3 001334   000040 755000 1                  STA     LAST_SWAP_IX

      481     5195    4           DO UNTIL( M > 1 OR ( M = 1 AND LAST_SWAP_IX <= 0 ) );

      482     5196    4               SWAP_UPTO_IX = LAST_SWAP_IX;

   5196  3 001335   000040 235000 1                  LDA     LAST_SWAP_IX
         3 001336   000041 755000 1                  STA     SWAP_UPTO_IX

      483     5197    4               LAST_SWAP_IX = 0;

   5197  3 001337   000040 450000 1                  STZ     LAST_SWAP_IX

      484     5198    5               DO J = M TO SWAP_UPTO_IX;

   5198  3 001340   000037 236000 1                  LDQ     M
         3 001341   200026 756100                    STQ     J,,AUTO
         3 001342   001404 710000 3                  TRA     s:5211+1

      485     5199    5                   I = J - M;

   5199  3 001343   200026 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:67   
         3 001344   000037 136000 1                  SBLQ    M
         3 001345   200025 756100                    STQ     I,,AUTO

      486     5200    5                   PTR_I_REF$ = PINCRW( RCD$, I * SIZEW(B$FEP_UNSATREF) );

   5200  3 001346   200034 470500                    LDP0    @RCD$,,AUTO
         3 001347   000000 471500                    LDP1    0,,PR0
         3 001350   100000 633506                    EPPR3   0,QL,PR1
         3 001351   000042 453400 1                  STP3    PTR_I_REF$

      487     5201    5                   PTR_J_REF$ = PINCRW( RCD$, J * SIZEW(B$FEP_UNSATREF) );

   5201  3 001352   200026 720100                    LXL0    J,,AUTO
         3 001353   100000 634510                    EPPR4   0,X0,PR1
         3 001354   000044 454400 1                  STP4    PTR_J_REF$

      488     5202    5                   PTR_I_NAME$ = PINCRW( NAME$, PTR_I_REF$->B$FEP_UNSATREF.NPOINTER );

   5202  3 001355   300000 221100                    LDX1    0,,PR3
         3 001356   200033 475500                    LDP5    @NAME$,,AUTO
         3 001357   500000 476500                    LDP6    0,,PR5
         3 001360   600000 637511                    EPPR7   0,X1,PR6
         3 001361   000043 457400 1                  STP7    PTR_I_NAME$

      489     5203    5                   PTR_J_NAME$ = PINCRW( NAME$, PTR_J_REF$->B$FEP_UNSATREF.NPOINTER );

   5203  3 001362   400000 222100                    LDX2    0,,PR4
         3 001363   600000 630512                    EPPR0   0,X2,PR6
         3 001364   000045 450400 1                  STP0    PTR_J_NAME$

      490     5204    5                   IF PTR_I_NAME$->B$DNAME.TEXT > PTR_J_NAME$->B$DNAME.TEXT

   5204  3 001365   700000 223100                    LDX3    0,,PR7
         3 001366   000000 224100                    LDX4    0,,PR0
         3 001367   040140 106540                    CMPC    fill='040'O
         3 001370   000000 400014                    ADSC9   0,,PR0                   cn=2,n=*X4
         3 001371   700000 400013                    ADSC9   0,,PR7                   cn=2,n=*X3
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:68   
         3 001372   001403 603000 3                  TRC     s:5211

      491     5205    6                   THEN DO;

      492     5206    6                       STATIC$FEP_UNSATREF = PTR_I_REF$->B$FEP_UNSATREF;

   5206  3 001373   300000 236100                    LDQ     0,,PR3
         3 001374   000035 756000 1                  STQ     STATIC$FEP_UNSATREF

      493     5207    6                       PTR_I_REF$->B$FEP_UNSATREF = PTR_J_REF$->B$FEP_UNSATREF;

   5207  3 001375   400000 236100                    LDQ     0,,PR4
         3 001376   300000 756100                    STQ     0,,PR3

      494     5208    6                       PTR_J_REF$->B$FEP_UNSATREF = STATIC$FEP_UNSATREF;

   5208  3 001377   000035 236000 1                  LDQ     STATIC$FEP_UNSATREF
         3 001400   400000 756100                    STQ     0,,PR4

      495     5209    6                       LAST_SWAP_IX = I;

   5209  3 001401   200025 235100                    LDA     I,,AUTO
         3 001402   000040 755000 1                  STA     LAST_SWAP_IX

      496     5210    6                       END;

      497     5211    5                   END;

   5211  3 001403   200026 054100                    AOS     J,,AUTO
         3 001404   200026 236100                    LDQ     J,,AUTO
         3 001405   000041 116000 1                  CMPQ    SWAP_UPTO_IX
         3 001406   001343 604400 3                  TMOZ    s:5199

      498     5212    4               END;

   5212  3 001407   000037 235000 1                  LDA     M
         3 001410   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:69   
         3 001411   001415 605400 3                  TPNZ    s:5213
         3 001412   001335 601000 3                  TNZ     s:5196
         3 001413   000040 235000 1                  LDA     LAST_SWAP_IX
         3 001414   001335 605400 3                  TPNZ    s:5196

      499     5213    3           END;

   5213  3 001415   000001 336007                    LCQ     1,DL
         3 001416   000037 056000 1                  ASQ     M
         3 001417   000037 235000 1                  LDA     M
         3 001420   001333 605400 3                  TPNZ    s:5194

      500     5214    2       RETURN;

   5214  3 001421   200032 221300                    LDX1  ! NEXT_REGION+1,,AUTO
         3 001422   000001 702211                    TSX2  ! 1,X1

      501     5215    2   END LLS$SORT;
      502     5216        %EJECT;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:70   
      503     5217    1   LLS$BINDEC: PROC ( COUNT );

   5217  3 001423   200032 741300       LLS$BINDEC   STX1  ! NEXT_REGION+1,,AUTO

      504     5218         /**/
      505     5219    2   DCL COUNT UBIN WORD ALIGNED;
      506     5220    2   DCL CHARS CHAR(7) ALIGNED;
      507     5221         /**/
      508     5222    2       TEXTC.COUNT = 7;

   5222  3 001424   007000 236003                    LDQ     3584,DU
         3 001425   000032 552040 1                  STBQ    TEXTC,'40'O

      509     5223    2       CALL BINCHAR (CHARS, COUNT);

   5223  3 001426   200033 470500                    LDP0    @COUNT,,AUTO
         3 001427   000000 235100                    LDA     0,,PR0
         3 001430   000044 773000                    LRL     36
         3 001431   200036 757100                    STAQ    @SIZE+1,,AUTO
         3 001432   000100 301500                    BTD
         3 001433   200036 000010                    NDSC9   @SIZE+1,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         3 001434   200034 030007                    NDSC9   CHARS,,AUTO              cn=0,s=nosgn,sf=0,n=7

      510     5224    2       TEXTC.STRING = CHARS;

   5224  3 001435   040000 100500                    MLR     fill='040'O
         3 001436   200034 000007                    ADSC9   CHARS,,AUTO              cn=0,n=7
         3 001437   000032 200007 1                  ADSC9   TEXTC                    cn=1,n=7

      511     5225    2       I = 0;

   5225  3 001440   200025 450100                    STZ     I,,AUTO

      512     5226    3       DO WHILE ( I < 6 AND TEXTC.BYTES(I) = '0' );

   5226  3 001441   001443 710000 3                  TRA     s:5228

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:71   
      513     5227    3           I = I + 1;

   5227  3 001442   200025 054100                    AOS     I,,AUTO

      514     5228    3           END;

   5228  3 001443   200025 235100                    LDA     I,,AUTO
         3 001444   000006 115007                    CMPA    6,DL
         3 001445   001452 605000 3                  TPL     s:5229
         3 001446   040000 106405                    CMPC    fill='040'O
         3 001447   000032 200001 1                  ADSC9   TEXTC,A                  cn=1,n=1
         3 001450   000026 000001 4                  ADSC9   22                       cn=0,n=1
         3 001451   001442 600000 3                  TZE     s:5227

      515     5229    2       J = 7 - I;

   5229  3 001452   000027 675000 xsym               ERA     B_VECTNIL+23
         3 001453   000010 035007                    ADLA    8,DL
         3 001454   200026 755100                    STA     J,,AUTO

      516     5230         /* J: Length of string */
      517     5231         /* I: Start of first character. */
      518     5232    2       CHARS = SUBSTR (TEXTC.STRING,I,J);

   5232  3 001455   000000 620005                    EAX0    0,AL
         3 001456   200025 235100                    LDA     I,,AUTO
         3 001457   040100 100445                    MLR     fill='040'O
         3 001460   000032 200010 1                  ADSC9   TEXTC,A                  cn=1,n=*X0
         3 001461   200034 000007                    ADSC9   CHARS,,AUTO              cn=0,n=7

      519     5233    2       TEXTC.COUNT = J;

   5233  3 001462   200026 236100                    LDQ     J,,AUTO
         3 001463   000033 736000                    QLS     27
         3 001464   000032 552040 1                  STBQ    TEXTC,'40'O

      520     5234    2       TEXTC.STRING = CHARS;
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:72   

   5234  3 001465   040000 100500                    MLR     fill='040'O
         3 001466   200034 000007                    ADSC9   CHARS,,AUTO              cn=0,n=7
         3 001467   000032 200007 1                  ADSC9   TEXTC                    cn=1,n=7

      521     5235    2       RETURN;

   5235  3 001470   200032 221300                    LDX1  ! NEXT_REGION+1,,AUTO
         3 001471   000001 702211                    TSX2  ! 1,X1

      522     5236    2   END LLS$BINDEC;
      523     5237    1   END LLS$SATREF;

   5237  3 001472   000000 702200 xent               TSX2  ! X66_ARET
      524     5238        %EOD;

PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:73   
--  Include file information  --

   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   LL_MACS_C.:E05TOU  is referenced.
   LL_SUBS_C.:E05TOU  is referenced.
   LL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure LLS$SATREF.
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:74   

 **** Variables and constants ****

  ****  Section 001  Data  LLS$SATREF

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(54)    r     1 B$FEP_RUKEY               36-0-0/w SBIN        r     1 COUNT
    10-0-0/d STRC(216)   r     1 GET_ENTREF_SPACE           2-0-0/d STRC(216)   r     1 GET_NAME_SPACE
    16-0-0/d STRC(216)   r     1 GET_SYMREF_SPACE          40-0-0/w SBIN        r     1 LAST_SWAP_IX
    37-0-0/w SBIN        r     1 M                         43-0-0/w PTR         r     1 PTR_I_NAME$
    42-0-0/w PTR         r     1 PTR_I_REF$                45-0-0/w PTR         r     1 PTR_J_NAME$
    44-0-0/w PTR         r     1 PTR_J_REF$                35-0-0/w STRC        r     1 STATIC$FEP_UNSATREF
    41-0-0/w SBIN        r     1 SWAP_UPTO_IX              32-0-0/w STRC(72)    r     1 TEXTC
    26-0-0/d STRC(72)    r     1 VLP_ENTREF_SPACE          24-0-0/d STRC(72)    r     1 VLP_NAME_SPACE
    30-0-0/d STRC(72)    r     1 VLP_SYMREF_SPACE

  ****  Section 002 RoData LLS$SATREF

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 TEXTC$

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    33-0-0/w PTR         r     1 @COUNT                    10-0-0/w PTR         r     1 @DEFN$
    33-0-0/w PTR         r     1 @NAME$                     4-0-0/w PTR         r     1 @NREFS
     6-0-0/w PTR         r     1 @NUNSATS                  12-0-0/w PTR         r     1 @OU$
    34-0-0/w PTR         r     1 @RCD$                      3-0-0/w PTR         r     1 @REF$
    11-0-0/w PTR         r     1 @REFN$                     5-0-0/w PTR         r     1 @ROOT$
    35-0-0/w PTR         r     1 @SIZE                      7-0-0/w PTR         r     1 @TYPE
    34-0-0/w CHAR(7)     r     1 CHARS                     *0-0-0/w UBIN        r     1 COUNT
    *0-0-0/w PTR         r     1 DEFN$                     17-0-0/w PTR         r     1 DEFN_PTR$
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:75   
    15-0-0/w PTR         r     1 DEF_PTR$                  25-0-0/w SBIN        r     1 I
    26-0-0/w SBIN        r     1 J                         *0-0-0/w PTR         r     1 NAME$
    31-0-0/w UBIN(9)     r     1 NEXT_REGION               24-0-0/b BIT         r     1 NOT_FOUND#
    *0-0-0/w UBIN        r     1 NREFS                     *0-0-0/w UBIN        r     1 NUNSATS
    *0-0-0/w PTR         r     1 OU$                       13-0-0/w BIT         r     1 OU_NAME_IN_RECORD#
    *0-0-0/w PTR         r     1 RCD$                      *0-0-0/w PTR         r     1 REF$
    *0-0-0/w PTR         r     1 REFN$                     16-0-0/w PTR         r     1 REFN_PTR$
    14-0-0/w PTR         r     1 REF_PTR$                  30-0-0/w UBIN(9)     r     1 REGION
    *0-0-0/w PTR         r     1 ROOT$                     *0-0-0/w UBIN        r     1 SIZE
    21-0-0/w UBIN        r     1 TEMP                      22-0-0/w UBIN        r     1 TEMP1
    20-0-0/w PTR         r     1 TPTR$                     *0-0-0/w UBIN        r     1 TYPE
    23-0-0/w UBIN        r     1 VALUE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT         r     1 LLS_INIT#                  0-0-0/w CHAR(112)   r     1 LL_DOBUF
     0-0-0/w STRC        r     1 LL_FLAGS                   0-0-0/w STRC(1440)  r     1 LL_HEAD
     0-0-0/w PTR         r     1 LL_UREF_NAME$              0-0-0/w UBIN        r     1 LL_UREF_NAME_CUR
     0-0-0/w UBIN        r     1 LL_UREF_NAME_MAX           0-0-0/w PTR         r     1 LL_U_ENTREF$
     0-0-0/w UBIN        r     1 LL_U_ENTREF_CUR            0-0-0/w UBIN        r     1 LL_U_ENTREF_MAX
     0-0-0/w UBIN        r     1 LL_U_PRIMARY_ENTREF_COUNT
     0-0-0/w UBIN        r     1 LL_U_PRIMARY_SYMREF_COUNT
     0-0-0/w UBIN        r     1 LL_U_SECONDARY_ENTREF_COUNT
     0-0-0/w UBIN        r     1 LL_U_SECONDARY_SYMREF_COUNT
     0-0-0/w PTR         r     1 LL_U_SYMREF$               0-0-0/w UBIN        r     1 LL_U_SYMREF_CUR
     0-0-0/w UBIN        r     1 LL_U_SYMREF_MAX            0-0-0/w UBIN        r     1 OU_NAME_INDEX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(18)    r     1 B$DNAME                    0-0-0/w STRC        r     1 B$FEP_UNSATREF
     0-0-0/w ASTR(9)     r     1 B_TEXTC                    0-0-0/w STRC(72)    r     1 DEF
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:76   
     0-0-0/w UBIN        r     1 ISADDR                     0-0-0/w STRC(72)    r     1 LL_ENTDEF
     0-0-0/w STRC(72)    r     1 LL_SYMDEF                  0-0-0/w ASTR(504)   r     1 OU_ENTRY
     0-0-0/w STRC        r     1 REF                        0-0-0/w STRC(216)   r     1 TREE


   Procedure LLS$SATREF requires 827 words for executable code.
   Procedure LLS$SATREF requires 34 words of local(AUTO) storage.
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:77   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:78   
          MINI XREF LISTING

B$DNAME.COUNT
      4054**DCL      4061--IMP-SIZ  4943>>IF       4943>>IF       4945>>IF       4945>>IF       4978>>CALLBLT
      5007<<ASSIGN   5008>>ASSIGN   5009<<ASSIGN   5011>>ASSIGN   5041>>ASSIGN   5064<<ASSIGN   5065>>ASSIGN
      5066<<ASSIGN   5066>>ASSIGN   5068>>ASSIGN   5068>>ASSIGN   5103>>ASSIGN   5126<<ASSIGN   5127>>ASSIGN
      5128<<ASSIGN   5128>>ASSIGN   5130>>ASSIGN   5130>>ASSIGN   5204>>IF       5204>>IF
B$DNAME.TEXT
      4061**DCL      4943>>IF       4943>>IF       4945>>IF       4945>>IF       4978>>CALLBLT  5008<<ASSIGN
      5011<<ASSIGN   5065<<ASSIGN   5068<<ASSIGN   5068>>ASSIGN   5127<<ASSIGN   5130<<ASSIGN   5130>>ASSIGN
      5204>>IF       5204>>IF
B$FEP_RUKEY
      4118**DCL      4868<>CALL     4890<>CALL     4905<>CALL
B$FEP_RUKEY.PAGE
      4125**DCL      4127--REDEF    4857<<ASSIGN   4870<<ASSIGN   4870>>ASSIGN   4879<<ASSIGN   4892<<ASSIGN
      4892>>ASSIGN   4903<<ASSIGN
B$FEP_RUKEY.TYPE
      4121**DCL      4856<<ASSIGN   4878<<ASSIGN   4902<<ASSIGN
B$FEP_UNSATREF
      4065**DCL      5022--ASSIGN   5056--ASSIGN   5084--ASSIGN   5118--ASSIGN   5192--ASSIGN   5200--ASSIGN
      5201--ASSIGN   5206>>ASSIGN   5207<<ASSIGN   5207>>ASSIGN   5208<<ASSIGN
B$FEP_UNSATREF.NPOINTER
      4066**DCL      5054<<ASSIGN   5116<<ASSIGN   5202>>ASSIGN   5203>>ASSIGN
B$FEP_UNSATREF.OPOINTER
      4072**DCL      5029<<ASSIGN   5091<<ASSIGN
B$FEP_UNSATREF.SREF
      4070**DCL      5031<<ASSIGN   5093<<ASSIGN
B_TEXTC.COUNT
      4378**DCL      4379--IMP-SIZ  4807>>CALLBLT  4815>>CALLBLT  4823>>CALLBLT  4831>>CALLBLT
B_TEXTC.STRING
      4379**DCL      4807>>CALLBLT  4815>>CALLBLT  4823>>CALLBLT  4831>>CALLBLT
CHARS IN PROCEDURE LLS$BINDEC
      5220**DCL      5223<<CALLBLT  5224>>ASSIGN   5232<<ASSIGN   5234>>ASSIGN
COUNT IN PROCEDURE LLS$BINDEC
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:79   
      5219**DCL      5217--PROC     5223>>CALLBLT
COUNT IN PROCEDURE LLS$SORT
      5176**DCL      5192<<ASSIGN   5193>>DOINDEX  5194>>ASSIGN
DEF.ALT
      4538**DCL      4974>>IF
DEF.CHECK
      4543**DCL      4973>>IF
DEF.CST
      4551**DCL      4974>>IF
DEF.ISADDR
      4528**DCL      4986>>ASSIGN
DEF.NPARAM
      4571**DCL      4974>>IF
DEF.NPOINTER
      4530**DCL      4942>>ASSIGN
DEF.OU
      4522**DCL      4528--REDEF
DEFN$
      4357**DCL        14--PROC     4942>>ASSIGN
DEFN_PTR$
      4363**DCL      4942<<ASSIGN   4943>>IF       4943>>IF       4945>>IF       4945>>IF
DEF_PTR$
      4361**DCL      4941<<ASSIGN   4942>>ASSIGN   4967<<ASSIGN   4973>>IF       4974>>IF       4974>>IF
      4974>>IF       4986>>ASSIGN   4988>>ASSIGN   4990>>ASSIGN
GET_ENTREF_SPACE
      4160**DCL      4922<>CALL     5024<>CALL
GET_ENTREF_SPACE.V
      4160**DCL      4160--DCLINIT
GET_NAME_SPACE
      4142**DCL      4919<>CALL     5002<>CALL     5050<>CALL     5112<>CALL
GET_NAME_SPACE.V
      4142**DCL      4142--DCLINIT
GET_SYMREF_SPACE
      4178**DCL      4925<>CALL     5086<>CALL
GET_SYMREF_SPACE.V
      4178**DCL      4178--DCLINIT
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:80   
I
      4574**DCL      4934<<DOINDEX  4936>>ASSIGN   5199<<ASSIGN   5200>>ASSIGN   5209>>ASSIGN   5225<<ASSIGN
      5226>>DOWHILE  5226>>DOWHILE  5227<<ASSIGN   5227>>ASSIGN   5229>>ASSIGN   5232>>ASSIGN
ISADDR
      4368**DCL      4986<<ASSIGN   5143<<ASSIGN
J
      4575**DCL      5198<<DOINDEX  5199>>ASSIGN   5201>>ASSIGN   5229<<ASSIGN   5232>>ASSIGN   5233>>ASSIGN
LAST_SWAP_IX IN PROCEDURE LLS$SORT
      5178**DCL      5194<<ASSIGN   5195>>DOUNTIL  5196>>ASSIGN   5197<<ASSIGN   5209<<ASSIGN
LLM$MON_SVC
      4576**DCL-ENT  4811--CALL     4819--CALL     4827--CALL     4835--CALL     4848--CALL     4868--CALL
      4890--CALL     4905--CALL     4982--CALL     5150--CALL
LLS$BINDEC
      5217**PROC     4806--CALL     4814--CALL     4822--CALL     4830--CALL
LLS$SAYREFS
      4577**DCL-ENT  4849--CALL
LLS$SORT
      5152**PROC     4798--CALL     4799--CALL
LLS_INIT#
        37**DCL      4916>>IF       4917<<ASSIGN
LL_DOBUF
        23**DCL      4807<<CALLBLT  4815<<CALLBLT  4823<<CALLBLT  4831<<CALLBLT  4847<<ASSIGN   4977<<ASSIGN
      4978<<CALLBLT
LL_ENTDEF.LFLAGS.USED
      4240**DCL      4988<<ASSIGN
LL_ENTDEF.OU
      4246**DCL      4252--REDEF
LL_FLAGS.BIAS_OU
        26**DCL      4951>>IF
LL_FLAGS.MAP#
        24**DCL      4846>>IF
LL_HEAD.NRECSIZE
      4651**DCL      4900>>IF       4901<<ASSIGN
LL_HEAD.SEV
      4625**DCL      5140>>IF       5142<<ASSIGN
LL_SYMDEF.AD.OU
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:81   
      4319**DCL      4325--REDEF
LL_SYMDEF.LFLAGS.USED
      4341**DCL      4990<<ASSIGN
LL_SYMDEF.VALUE
      4300**DCL      4303--REDEF
LL_UREF_NAME$
        34**DCL      4798<>CALL     4799<>CALL     4905<>CALL     4920<<ASSIGN   5006>>ASSIGN   5063>>ASSIGN
      5125>>ASSIGN
LL_UREF_NAME_CUR
        36**DCL      4792>>IF       4900>>IF       4901>>ASSIGN   4904>>ASSIGN   5001>>IF       5006>>ASSIGN
      5013>>ASSIGN   5014<<ASSIGN   5014>>ASSIGN   5048>>IF       5054>>ASSIGN   5063>>ASSIGN   5070<<ASSIGN
      5070>>ASSIGN   5110>>IF       5116>>ASSIGN   5125>>ASSIGN   5132<<ASSIGN   5132>>ASSIGN
LL_UREF_NAME_MAX
        35**DCL      4927<<ASSIGN   5001>>IF       5004<<ASSIGN   5004>>ASSIGN   5048>>IF       5052<<ASSIGN
      5052>>ASSIGN   5110>>IF       5114<<ASSIGN   5114>>ASSIGN
LL_U_ENTREF$
        35**DCL      4799<>CALL     4890<>CALL     4923<<ASSIGN   5028>>ASSIGN
LL_U_ENTREF_CUR
        37**DCL      4799<>CALL     4880>>ASSIGN   4881>>DOWHILE  4882>>IF       4884<<ASSIGN   4887>>ASSIGN
      4888<<ASSIGN   4894<<ASSIGN   5023>>IF       5028>>ASSIGN   5056<<ASSIGN   5056>>ASSIGN
LL_U_ENTREF_MAX
        36**DCL      4929<<ASSIGN   5023>>IF       5026<<ASSIGN   5026>>ASSIGN
LL_U_PRIMARY_ENTREF_COUNT
        40**DCL      4805>>IF       4806<>CALL     5075<<ASSIGN   5075>>ASSIGN
LL_U_PRIMARY_SYMREF_COUNT
        39**DCL      4821>>IF       4822<>CALL     5137<<ASSIGN   5137>>ASSIGN
LL_U_SECONDARY_ENTREF_COUNT
        39**DCL      4813>>IF       4814<>CALL     5072<<ASSIGN   5072>>ASSIGN
LL_U_SECONDARY_SYMREF_COUNT
        38**DCL      4829>>IF       4830<>CALL     5134<<ASSIGN   5134>>ASSIGN
LL_U_SYMREF$
        35**DCL      4798<>CALL     4868<>CALL     4926<<ASSIGN   5090>>ASSIGN
LL_U_SYMREF_CUR
        37**DCL      4798<>CALL     4858>>ASSIGN   4859>>DOWHILE  4860>>IF       4862<<ASSIGN   4862>>ASSIGN
      4865>>ASSIGN   4866<<ASSIGN   4872<<ASSIGN   4884>>ASSIGN   5085>>IF       5090>>ASSIGN   5118<<ASSIGN
      5118>>ASSIGN
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:82   
LL_U_SYMREF_MAX
        35**DCL      4928<<ASSIGN   5085>>IF       5088<<ASSIGN   5088>>ASSIGN
M IN PROCEDURE LLS$SORT
      5177**DCL      5193<<DOINDEX  5195>>DOUNTIL  5195>>DOUNTIL  5198>>DOINDEX  5199>>ASSIGN
M$GDS
      4008**DCL-ENT  4919--CALL     4922--CALL     4925--CALL     5002--CALL     5024--CALL     5050--CALL
      5086--CALL     5112--CALL
NAME$ IN PROCEDURE LLS$SORT
      5154**DCL      5152--PROC     5202>>ASSIGN   5203>>ASSIGN
NEXT_REGION
      4582**DCL      4959<<ASSIGN   4963<<ASSIGN   4964>>IF
NOT_FOUND#
      4369**DCL      4939<<ASSIGN   4940>>DOWHILE  4948<<ASSIGN   4950>>IF
NO_MEMORY
      5150**LABEL    4919--CALLALT  4922--CALLALT  4925--CALLALT  5002--CALLALT  5024--CALLALT  5050--CALLALT
      5086--CALLALT  5112--CALLALT
NREFS
      4353**DCL        14--PROC     4934>>DOINDEX
NUNSATS
      4355**DCL        14--PROC     4933<<ASSIGN
OU$
      4359**DCL        14--PROC     4954>>IF       4958>>ASSIGN   4978>>CALLBLT  4978>>CALLBLT  4995>>ASSIGN
      5009>>ASSIGN   5011>>ASSIGN   5011>>ASSIGN
OU_ENTRY.OUNAME.SIZE
      4456**DCL      4458--IMP-SIZ  4978>>CALLBLT  4995>>ASSIGN   5009>>ASSIGN   5011>>ASSIGN
OU_ENTRY.OUNAME.TEXT
      4458**DCL      4978>>CALLBLT  5011>>ASSIGN
OU_ENTRY.REGION
      4452**DCL      4958>>ASSIGN   4963>>ASSIGN
OU_NAME_INDEX
        38**DCL      4932<<ASSIGN   5013<<ASSIGN   5029>>ASSIGN   5091>>ASSIGN
OU_NAME_IN_RECORD#
        38**DCL      4931<<ASSIGN   4993>>IF       4994<<ASSIGN   5146<<ASSIGN
PTR_I_NAME$ IN PROCEDURE LLS$SORT
      5181**DCL      5202<<ASSIGN   5204>>IF       5204>>IF
PTR_I_REF$ IN PROCEDURE LLS$SORT
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:83   
      5180**DCL      5200<<ASSIGN   5202>>ASSIGN   5206>>ASSIGN   5207>>ASSIGN
PTR_J_NAME$ IN PROCEDURE LLS$SORT
      5183**DCL      5203<<ASSIGN   5204>>IF       5204>>IF
PTR_J_REF$ IN PROCEDURE LLS$SORT
      5182**DCL      5201<<ASSIGN   5203>>ASSIGN   5207>>ASSIGN   5208>>ASSIGN
RCD$ IN PROCEDURE LLS$SORT
      5155**DCL      5152--PROC     5200>>ASSIGN   5201>>ASSIGN
REF.ALT
      4469**DCL      4974>>IF
REF.CHECK
      4473**DCL      4973>>IF
REF.CST
      4481**DCL      4974>>IF
REF.NPARAM
      4501**DCL      4974>>IF
REF.NPOINTER
      4463**DCL      4937>>ASSIGN   5039>>ASSIGN   5101>>ASSIGN
REF.SREF
      4466**DCL      5031>>ASSIGN   5071>>IF       5093>>ASSIGN   5133>>IF       5140>>IF
REF$
      4352**DCL        14--PROC     4936>>ASSIGN
REFN$
      4358**DCL        14--PROC     4937>>ASSIGN   5040>>ASSIGN   5102>>ASSIGN
REFN_PTR$
      4362**DCL      4937<<ASSIGN   4943>>IF       4943>>IF       4945>>IF       4945>>IF       4978>>CALLBLT
      4978>>CALLBLT  5006<<ASSIGN   5007>>ASSIGN   5008>>ASSIGN   5008>>ASSIGN   5009>>ASSIGN   5011>>ASSIGN
      5011>>ASSIGN   5040<<ASSIGN   5041>>ASSIGN   5066>>ASSIGN   5068>>ASSIGN   5068>>ASSIGN   5102<<ASSIGN
      5103>>ASSIGN   5128>>ASSIGN   5130>>ASSIGN   5130>>ASSIGN
REF_PTR$
      4360**DCL      4936<<ASSIGN   4937>>ASSIGN   4973>>IF       4974>>IF       4974>>IF       4974>>IF
      4986>>ASSIGN   5031>>ASSIGN   5039>>ASSIGN   5071>>IF       5093>>ASSIGN   5101>>ASSIGN   5133>>IF
      5140>>IF       5143>>ASSIGN
REGION
      4581**DCL      4956<<ASSIGN   4958<<ASSIGN   4964>>IF
ROOT$
      4354**DCL        14--PROC     4935>>ASSIGN
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:84   
SIZE IN PROCEDURE LLS$SORT
      5156**DCL      5152--PROC     5192>>ASSIGN
STATIC$FEP_UNSATREF IN PROCEDURE LLS$SORT
      5160**DCL      5206<<ASSIGN   5208>>ASSIGN
SWAP_UPTO_IX IN PROCEDURE LLS$SORT
      5179**DCL      5196<<ASSIGN   5198>>DOINDEX
TEMP
      4365**DCL      4861<<ASSIGN   4865<<ASSIGN   4868<>CALL     4883<<ASSIGN   4887<<ASSIGN   4890<>CALL
      4904<<ASSIGN   4905<>CALL     4995<<ASSIGN   5001>>IF       5007>>ASSIGN   5014>>ASSIGN   5022<<ASSIGN
      5023>>IF       5039<<ASSIGN   5040>>ASSIGN   5041<<ASSIGN   5042<<ASSIGN   5042>>ASSIGN   5048>>IF
      5064>>ASSIGN   5070>>ASSIGN   5084<<ASSIGN   5085>>IF       5101<<ASSIGN   5102>>ASSIGN   5103<<ASSIGN
      5104<<ASSIGN   5104>>ASSIGN   5110>>IF       5126>>ASSIGN   5132>>ASSIGN
TEMP1
      4366**DCL      4858<<ASSIGN   4872>>ASSIGN   4880<<ASSIGN   4894>>ASSIGN
TEXTC
      4372**DCL      4376--DCLINIT
TEXTC.BYTES
      4375**DCL      5226>>DOWHILE
TEXTC.COUNT
      4373**DCL      5222<<ASSIGN   5233<<ASSIGN
TEXTC.STRING
      4374**DCL      4375--REDEF    5224<<ASSIGN   5232>>ASSIGN   5234<<ASSIGN
TEXTC$
      4376**DCL      4377--IMP-PTR  4807>>CALLBLT  4807>>CALLBLT  4815>>CALLBLT  4815>>CALLBLT  4823>>CALLBLT
      4823>>CALLBLT  4831>>CALLBLT  4831>>CALLBLT
TPTR$
      4364**DCL      4935<<ASSIGN   4940>>DOWHILE  4941>>ASSIGN   4944<<ASSIGN   4944>>ASSIGN   4946<<ASSIGN
      4946>>ASSIGN   4960>>DOWHILE  4961>>IF       4963>>ASSIGN   4967>>ASSIGN   4969<<ASSIGN   4969>>ASSIGN
      5028<<ASSIGN   5029>>ASSIGN   5031>>ASSIGN   5054>>ASSIGN   5063<<ASSIGN   5064>>ASSIGN   5065>>ASSIGN
      5065>>ASSIGN   5066>>ASSIGN   5068>>ASSIGN   5068>>ASSIGN   5090<<ASSIGN   5091>>ASSIGN   5093>>ASSIGN
      5116>>ASSIGN   5125<<ASSIGN   5126>>ASSIGN   5127>>ASSIGN   5127>>ASSIGN   5128>>ASSIGN   5130>>ASSIGN
      5130>>ASSIGN
TREE.BROTHER$
      4401**DCL      4969>>ASSIGN
TREE.L_CHILD$
      4408**DCL      4946>>ASSIGN
PL6.E3A0      #001=LLS$SATREF File=LLS$SATREF.:E05TSI                            WED 07/30/97 03:17 Page:85   
TREE.NODE$
      4397**DCL      4941>>ASSIGN   4967>>ASSIGN
TREE.OU$
      4394**DCL      4961>>IF       4963>>ASSIGN
TREE.R_CHILD$
      4410**DCL      4944>>ASSIGN
TYPE
      4356**DCL        14--PROC     4791>>IF       4972>>IF       4987>>IF       5016>>IF
VALUE
      4367**DCL      4938<<ASSIGN
VLP_ENTREF_SPACE
      4209**DCL      4160--DCLINIT
VLP_ENTREF_SPACE.PTR$
      4211**DCL      4921<<ASSIGN   4923>>ASSIGN
VLP_ENTREF_SPACE.W2
      4210**DCL      4211--REDEF
VLP_NAME_SPACE
      4194**DCL      4142--DCLINIT
VLP_NAME_SPACE.PTR$
      4196**DCL      4918<<ASSIGN   4920>>ASSIGN
VLP_NAME_SPACE.W2
      4195**DCL      4196--REDEF
VLP_SYMREF_SPACE
      4224**DCL      4178--DCLINIT
VLP_SYMREF_SPACE.PTR$
      4226**DCL      4924<<ASSIGN   4926>>ASSIGN
VLP_SYMREF_SPACE.W2
      4225**DCL      4226--REDEF

PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:86   
      525        1        /*T***********************************************************/
      526        2        /*T*                                                         */
      527        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      528        4        /*T*                                                         */
      529        5        /*T***********************************************************/
      530        6        LLS$SAYREFS: PROC;
      531        7        %INCLUDE LL_DATA_R;
      532       43        %INCLUDE LL_SUBS_C;
      533      172        %INCLUDE LL_MACS_C;
      534      526        %INCLUDE B$OBJECT_C;
      535     3956         /**/
      536     3957        %LL$UNSATREF ( NAME = B$FEP_UNSATREF );
      537     3970        %B$DNAME;
      538     3989         /**/
      539     3990    1   DCL ONAME$ PTR; /* Pointer to OU name */
      540     3991    1   DCL RNAME$ PTR; /* Pointer to ref name */
      541     3992    1   DCL REF$ PTR; /* Pointer to ref entry */
      542     3993    1   DCL LLM$MON_SVC ENTRY(4) ALTRET;
      543     3994    1   DCL COUNT UBIN WORD ALIGNED;
      544     3995    1   DCL BUFFER_1 CHAR(32) ALIGNED;
      545     3996    1   DCL BUFFER_2 CHAR(32) ALIGNED;
      546     3997    1   DCL LENGTH UBIN WORD ALIGNED;
      547     3998         /**/
      548     3999    1   DCL TEMP UBIN WORD ALIGNED;
      549     4000         /**/
      550     4001    1   BEGIN:
      551     4002    2       IF LL_U_PRIMARY_ENTREF_COUNT > 0 THEN DO;
      552     4003    2           LL_DOBUF = 'B******** UNRESOLVED PRIMARY ENTRY REFERENCES ********';
      553     4004    2           CALL LLM$MON_SVC (LL#WRITEDO);
      554     4005    2           TEMP = 0;
      555     4006    2           COUNT = 0;
      556     4007    2           BUFFER_1 = ' ';
      557     4008    2           BUFFER_2 = ' ';
      558     4009    3           DO WHILE ( COUNT < LL_U_PRIMARY_ENTREF_COUNT AND
      559     4010    3              TEMP < LL_U_ENTREF_CUR );
      560     4011    3               REF$ = PINCRW ( LL_U_ENTREF$, TEMP );
      561     4012    4               IF NOT REF$ -> B$FEP_UNSATREF.SREF THEN DO;
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:87   
      562     4013    4                   CALL SUB1;
      563     4014    4                   END;
      564     4015    3               TEMP = TEMP + 1;
      565     4016    3               END;
      566     4017    2           CALL SUB2;
      567     4018    2           END;
      568     4019    2       IF LL_U_PRIMARY_SYMREF_COUNT > 0 THEN DO;
      569     4020    2           LL_DOBUF = 'B******** UNRESOLVED PRIMARY DATA REFERENCES ********';
      570     4021    2           CALL LLM$MON_SVC (LL#WRITEDO);
      571     4022    2           TEMP = 0;
      572     4023    2           COUNT = 0;
      573     4024    2           BUFFER_1 = ' ';
      574     4025    2           BUFFER_2 = ' ';
      575     4026    3           DO WHILE ( COUNT < LL_U_PRIMARY_SYMREF_COUNT AND
      576     4027    3              TEMP < LL_U_SYMREF_CUR );
      577     4028    3               REF$ = PINCRW ( LL_U_SYMREF$, TEMP );
      578     4029    4               IF NOT REF$ -> B$FEP_UNSATREF.SREF THEN DO;
      579     4030    4                   CALL SUB1;
      580     4031    4                   END;
      581     4032    3               TEMP = TEMP + 1;
      582     4033    3               END;
      583     4034    2           CALL SUB2;
      584     4035    2           END;
      585     4036    2       IF LL_U_SECONDARY_ENTREF_COUNT > 0 THEN DO;
      586     4037    2           LL_DOBUF = 'B******** UNRESOLVED SECONDARY ENTRY REFERENCES ********';
      587     4038    2           CALL LLM$MON_SVC (LL#WRITEDO);
      588     4039    2           TEMP = 0;
      589     4040    2           COUNT = 0;
      590     4041    2           BUFFER_1 = ' ';
      591     4042    2           BUFFER_2 = ' ';
      592     4043    3           DO WHILE ( COUNT < LL_U_SECONDARY_ENTREF_COUNT AND
      593     4044    3              TEMP < LL_U_ENTREF_CUR );
      594     4045    3               REF$ = PINCRW ( LL_U_ENTREF$, TEMP );
      595     4046    4               IF REF$ -> B$FEP_UNSATREF.SREF THEN DO;
      596     4047    4                   CALL SUB1;
      597     4048    4                   END;
      598     4049    3               TEMP = TEMP + 1;
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:88   
      599     4050    3               END;
      600     4051    2           CALL SUB2;
      601     4052    2           END;
      602     4053    2       IF LL_U_SECONDARY_SYMREF_COUNT > 0 THEN DO;
      603     4054    2           LL_DOBUF = 'B******** UNRESOLVED SECONDARY DATA REFERENCES ********';
      604     4055    2           CALL LLM$MON_SVC (LL#WRITEDO);
      605     4056    2           TEMP = 0;
      606     4057    2           COUNT = 0;
      607     4058    2           BUFFER_1 = ' ';
      608     4059    2           BUFFER_2 = ' ';
      609     4060    3           DO WHILE ( COUNT < LL_U_SECONDARY_SYMREF_COUNT AND
      610     4061    3              TEMP < LL_U_SYMREF_CUR );
      611     4062    3               REF$ = PINCRW ( LL_U_SYMREF$, TEMP );
      612     4063    4               IF REF$ -> B$FEP_UNSATREF.SREF THEN DO;
      613     4064    4                   CALL SUB1;
      614     4065    4                   END;
      615     4066    3               TEMP = TEMP + 1;
      616     4067    3               END;
      617     4068    2           CALL SUB2;
      618     4069    2           END;
      619     4070    1       RETURN;
      620     4071    1   SUB1: PROC;
      621     4072    2       COUNT = COUNT + 1;
      622     4073    2       ONAME$ = PINCRW ( LL_UREF_NAME$,
      623     4074    2          REF$ -> B$FEP_UNSATREF.OPOINTER );
      624     4075    2       RNAME$ = PINCRW ( LL_UREF_NAME$,
      625     4076    2          REF$ -> B$FEP_UNSATREF.NPOINTER );
      626     4077    2       LENGTH = 1 + ONAME$ -> B$DNAME.COUNT +
      627     4078    2          RNAME$ -> B$DNAME.COUNT;
      628     4079    3       IF LENGTH > 32 THEN DO;
      629     4080    4           IF BUFFER_1 ~= ' ' THEN DO;
      630     4081    4               CALL INSERT ( LL_DOBUF, 0,,
      631     4082    4                  'A    ',
      632     4083    4                  BUFFER_1,
      633     4084    4                  '    ',
      634     4085    4                  BUFFER_2 );
      635     4086    4               CALL LLM$MON_SVC (LL#WRITEDO);
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:89   
      636     4087    4               BUFFER_1 = ' ';
      637     4088    4               BUFFER_2 = ' ';
      638     4089    4               END;
      639     4090    3           CALL INSERT ( LL_DOBUF, 0,,
      640     4091    3              'A    ',
      641     4092    3              RNAME$ -> B$DNAME.TEXT,
      642     4093    3              '.',
      643     4094    3              ONAME$ -> B$DNAME.TEXT );
      644     4095    3           CALL LLM$MON_SVC (LL#WRITEDO);
      645     4096    3           BUFFER_1 = ' ';
      646     4097    3           BUFFER_2 = ' ';
      647     4098    3           END;
      648     4099    3       ELSE DO;
      649     4100    3           IF BUFFER_1 = ' ' THEN
      650     4101    3               CALL CONCAT ( BUFFER_1,
      651     4102    3                  RNAME$ -> B$DNAME.TEXT,
      652     4103    3                  '.',
      653     4104    3                  ONAME$ -> B$DNAME.TEXT );
      654     4105    3           ELSE
      655     4106    4               IF BUFFER_2 = ' ' THEN DO;
      656     4107    4                   CALL CONCAT ( BUFFER_2,
      657     4108    4                      RNAME$ -> B$DNAME.TEXT,
      658     4109    4                      '.',
      659     4110    4                      ONAME$ -> B$DNAME.TEXT );
      660     4111    4                   CALL INSERT ( LL_DOBUF, 0,,
      661     4112    4                      'A    ',
      662     4113    4                      BUFFER_1,
      663     4114    4                      '    ',
      664     4115    4                      BUFFER_2 );
      665     4116    4                   CALL LLM$MON_SVC (LL#WRITEDO);
      666     4117    4                   BUFFER_1 = ' ';
      667     4118    4                   BUFFER_2 = ' ';
      668     4119    4                   END;
      669     4120    4               ELSE DO;
      670     4121    4                   CALL INSERT ( LL_DOBUF, 0,,
      671     4122    4                      'A    ',
      672     4123    4                      BUFFER_1,
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:90   
      673     4124    4                      '    ',
      674     4125    4                      BUFFER_2 );
      675     4126    4                   CALL LLM$MON_SVC (LL#WRITEDO);
      676     4127    4                   BUFFER_1 = ' ';
      677     4128    4                   BUFFER_2 = ' ';
      678     4129    4                   END;
      679     4130    3           END;
      680     4131    2   END SUB1;
      681     4132
      682     4133    1   SUB2: PROC;
      683     4134    3       IF BUFFER_1 ~= ' ' THEN DO;
      684     4135    3           CALL INSERT ( LL_DOBUF, 0,,
      685     4136    3              'D    ',
      686     4137    3              BUFFER_1,
      687     4138    3              '    ',
      688     4139    3              BUFFER_2 );
      689     4140    3           CALL LLM$MON_SVC (LL#WRITEDO);
      690     4141    3           END;
      691     4142    3       ELSE DO;
      692     4143    3           LL_DOBUF = 'C';
      693     4144    3           CALL LLM$MON_SVC (LL#WRITEDO);
      694     4145    3           END;
      695     4146    2   END SUB2;
      696     4147    1   END LLS$SAYREFS;

PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:91   
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   LL_MACS_C.:E05TOU  is referenced.
   LL_SUBS_C.:E05TOU  is referenced.
   LL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure LLS$SAYREFS.

   Procedure LLS$SAYREFS requires 388 words for executable code.
   Procedure LLS$SAYREFS requires 30 words of local(AUTO) storage.

    No errors detected in file LLS$SATREF.:E05TSI    .

PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:92   

 Object Unit name= LLS$SAYREFS                                File name= LLS$SATREF.:E05TOU
 UTS= JUL 30 '97 03:18:09.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     60     74  LLS$SAYREFS
    1   Proc  even  none   388    604  LLS$SAYREFS
    2  RoData even  none     3      3  LLS$SAYREFS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  LLS$SAYREFS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 LLM$MON_SVC
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:93   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     LL_DOBUF                              LL_UREF_NAME$                         LL_U_SYMREF$
     LL_U_ENTREF$                          LL_U_ENTREF_CUR                       LL_U_SYMREF_CUR
     LL_U_SECONDARY_SYMREF_COUNT           LL_U_PRIMARY_SYMREF_COUNT             LL_U_SECONDARY_ENTREF_COUNT
     LL_U_PRIMARY_ENTREF_COUNT             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:94   


      525        1        /*T***********************************************************/
      526        2        /*T*                                                         */
      527        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      528        4        /*T*                                                         */
      529        5        /*T***********************************************************/
      530        6        LLS$SAYREFS: PROC;

      6  1 000000   000000 700200 xent  LLS$SAYREFS  TSX0  ! X66_AUTO_0
         1 000001   000036 000000                    ZERO    30,0

      531        7        %INCLUDE LL_DATA_R;
      532       43        %INCLUDE LL_SUBS_C;
      533      172        %INCLUDE LL_MACS_C;
      534      526        %INCLUDE B$OBJECT_C;
      535     3956         /**/
      536     3957        %LL$UNSATREF ( NAME = B$FEP_UNSATREF );
      537     3970        %B$DNAME;
      538     3989         /**/
      539     3990    1   DCL ONAME$ PTR; /* Pointer to OU name */
      540     3991    1   DCL RNAME$ PTR; /* Pointer to ref name */
      541     3992    1   DCL REF$ PTR; /* Pointer to ref entry */
      542     3993    1   DCL LLM$MON_SVC ENTRY(4) ALTRET;
      543     3994    1   DCL COUNT UBIN WORD ALIGNED;
      544     3995    1   DCL BUFFER_1 CHAR(32) ALIGNED;
      545     3996    1   DCL BUFFER_2 CHAR(32) ALIGNED;
      546     3997    1   DCL LENGTH UBIN WORD ALIGNED;
      547     3998         /**/
      548     3999    1   DCL TEMP UBIN WORD ALIGNED;
      549     4000         /**/
      550     4001    1   BEGIN:
      551     4002    2       IF LL_U_PRIMARY_ENTREF_COUNT > 0 THEN DO;

   4002  1 000002   000000 235000 xsym  BEGIN        LDA     LL_U_PRIMARY_ENTREF_COUNT
         1 000003   000051 600000 1                  TZE     s:4019

      552     4003    2           LL_DOBUF = 'B******** UNRESOLVED PRIMARY ENTRY REFERENCES ********';
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:95   

   4003  1 000004   040000 100400                    MLR     fill='040'O
         1 000005   000000 000066 0                  ADSC9   0                        cn=0,n=54
         1 000006   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      553     4004    2           CALL LLM$MON_SVC (LL#WRITEDO);

   4004  1 000007   000000 630400 2                  EPPR0   0
         1 000010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000011   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000012   000000 011000                    NOP     0

      554     4005    2           TEMP = 0;

   4005  1 000013   200031 450100                    STZ     TEMP,,AUTO

      555     4006    2           COUNT = 0;

   4006  1 000014   200007 450100                    STZ     COUNT,,AUTO

      556     4007    2           BUFFER_1 = ' ';

   4007  1 000015   040100 100400                    MLR     fill='040'O
         1 000016   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000017   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32

      557     4008    2           BUFFER_2 = ' ';

   4008  1 000020   040100 100400                    MLR     fill='040'O
         1 000021   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000022   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32

      558     4009    3           DO WHILE ( COUNT < LL_U_PRIMARY_ENTREF_COUNT AND

   4009  1 000023   000041 710000 1                  TRA     s:4016

      559     4010    3              TEMP < LL_U_ENTREF_CUR );
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:96   
      560     4011    3               REF$ = PINCRW ( LL_U_ENTREF$, TEMP );

   4011  1 000024   200031 236100                    LDQ     TEMP,,AUTO
         1 000025   000022 736000                    QLS     18
         1 000026   000000 036000 xsym               ADLQ    LL_U_ENTREF$
         1 000027   200006 756100                    STQ     REF$,,AUTO

      561     4012    4               IF NOT REF$ -> B$FEP_UNSATREF.SREF THEN DO;

   4012  1 000030   200006 470500                    LDP0    REF$,,AUTO
         1 000031   000000 236100                    LDQ     0,,PR0
         1 000032   400000 316007                    CANQ    -131072,DL
         1 000033   000036 601000 1                  TNZ     s:4015

      562     4013    4                   CALL SUB1;

   4013  1 000034   000237 701000 1                  TSX1    SUB1
         1 000035   000000 011000                    NOP     0

      563     4014    4                   END;

      564     4015    3               TEMP = TEMP + 1;

   4015  1 000036   200031 235100                    LDA     TEMP,,AUTO
         1 000037   000001 035007                    ADLA    1,DL
         1 000040   200031 755100                    STA     TEMP,,AUTO

      565     4016    3               END;

   4016  1 000041   200007 236100                    LDQ     COUNT,,AUTO
         1 000042   000000 116000 xsym               CMPQ    LL_U_PRIMARY_ENTREF_COUNT
         1 000043   000047 603000 1                  TRC     s:4017
         1 000044   200031 236100                    LDQ     TEMP,,AUTO
         1 000045   000000 116000 xsym               CMPQ    LL_U_ENTREF_CUR
         1 000046   000024 602000 1                  TNC     s:4011

      566     4017    2           CALL SUB2;
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:97   

   4017  1 000047   000545 701000 1                  TSX1    SUB2
         1 000050   000000 011000                    NOP     0

      567     4018    2           END;

      568     4019    2       IF LL_U_PRIMARY_SYMREF_COUNT > 0 THEN DO;

   4019  1 000051   000000 235000 xsym               LDA     LL_U_PRIMARY_SYMREF_COUNT
         1 000052   000120 600000 1                  TZE     s:4036

      569     4020    2           LL_DOBUF = 'B******** UNRESOLVED PRIMARY DATA REFERENCES ********';

   4020  1 000053   040000 100400                    MLR     fill='040'O
         1 000054   000016 000065 0                  ADSC9   14                       cn=0,n=53
         1 000055   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      570     4021    2           CALL LLM$MON_SVC (LL#WRITEDO);

   4021  1 000056   000000 630400 2                  EPPR0   0
         1 000057   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000060   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000061   000000 011000                    NOP     0

      571     4022    2           TEMP = 0;

   4022  1 000062   200031 450100                    STZ     TEMP,,AUTO

      572     4023    2           COUNT = 0;

   4023  1 000063   200007 450100                    STZ     COUNT,,AUTO

      573     4024    2           BUFFER_1 = ' ';

   4024  1 000064   040100 100400                    MLR     fill='040'O
         1 000065   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000066   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:98   

      574     4025    2           BUFFER_2 = ' ';

   4025  1 000067   040100 100400                    MLR     fill='040'O
         1 000070   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000071   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32

      575     4026    3           DO WHILE ( COUNT < LL_U_PRIMARY_SYMREF_COUNT AND

   4026  1 000072   000110 710000 1                  TRA     s:4033

      576     4027    3              TEMP < LL_U_SYMREF_CUR );
      577     4028    3               REF$ = PINCRW ( LL_U_SYMREF$, TEMP );

   4028  1 000073   200031 236100                    LDQ     TEMP,,AUTO
         1 000074   000022 736000                    QLS     18
         1 000075   000000 036000 xsym               ADLQ    LL_U_SYMREF$
         1 000076   200006 756100                    STQ     REF$,,AUTO

      578     4029    4               IF NOT REF$ -> B$FEP_UNSATREF.SREF THEN DO;

   4029  1 000077   200006 470500                    LDP0    REF$,,AUTO
         1 000100   000000 236100                    LDQ     0,,PR0
         1 000101   400000 316007                    CANQ    -131072,DL
         1 000102   000105 601000 1                  TNZ     s:4032

      579     4030    4                   CALL SUB1;

   4030  1 000103   000237 701000 1                  TSX1    SUB1
         1 000104   000000 011000                    NOP     0

      580     4031    4                   END;

      581     4032    3               TEMP = TEMP + 1;

   4032  1 000105   200031 235100                    LDA     TEMP,,AUTO
         1 000106   000001 035007                    ADLA    1,DL
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:99   
         1 000107   200031 755100                    STA     TEMP,,AUTO

      582     4033    3               END;

   4033  1 000110   200007 236100                    LDQ     COUNT,,AUTO
         1 000111   000000 116000 xsym               CMPQ    LL_U_PRIMARY_SYMREF_COUNT
         1 000112   000116 603000 1                  TRC     s:4034
         1 000113   200031 236100                    LDQ     TEMP,,AUTO
         1 000114   000000 116000 xsym               CMPQ    LL_U_SYMREF_CUR
         1 000115   000073 602000 1                  TNC     s:4028

      583     4034    2           CALL SUB2;

   4034  1 000116   000545 701000 1                  TSX1    SUB2
         1 000117   000000 011000                    NOP     0

      584     4035    2           END;

      585     4036    2       IF LL_U_SECONDARY_ENTREF_COUNT > 0 THEN DO;

   4036  1 000120   000000 235000 xsym               LDA     LL_U_SECONDARY_ENTREF_COUNT
         1 000121   000167 600000 1                  TZE     s:4053

      586     4037    2           LL_DOBUF = 'B******** UNRESOLVED SECONDARY ENTRY REFERENCES ********';

   4037  1 000122   040000 100400                    MLR     fill='040'O
         1 000123   000034 000070 0                  ADSC9   28                       cn=0,n=56
         1 000124   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      587     4038    2           CALL LLM$MON_SVC (LL#WRITEDO);

   4038  1 000125   000000 630400 2                  EPPR0   0
         1 000126   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000127   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000130   000000 011000                    NOP     0

      588     4039    2           TEMP = 0;
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:100  

   4039  1 000131   200031 450100                    STZ     TEMP,,AUTO

      589     4040    2           COUNT = 0;

   4040  1 000132   200007 450100                    STZ     COUNT,,AUTO

      590     4041    2           BUFFER_1 = ' ';

   4041  1 000133   040100 100400                    MLR     fill='040'O
         1 000134   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000135   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32

      591     4042    2           BUFFER_2 = ' ';

   4042  1 000136   040100 100400                    MLR     fill='040'O
         1 000137   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000140   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32

      592     4043    3           DO WHILE ( COUNT < LL_U_SECONDARY_ENTREF_COUNT AND

   4043  1 000141   000157 710000 1                  TRA     s:4050

      593     4044    3              TEMP < LL_U_ENTREF_CUR );
      594     4045    3               REF$ = PINCRW ( LL_U_ENTREF$, TEMP );

   4045  1 000142   200031 236100                    LDQ     TEMP,,AUTO
         1 000143   000022 736000                    QLS     18
         1 000144   000000 036000 xsym               ADLQ    LL_U_ENTREF$
         1 000145   200006 756100                    STQ     REF$,,AUTO

      595     4046    4               IF REF$ -> B$FEP_UNSATREF.SREF THEN DO;

   4046  1 000146   200006 470500                    LDP0    REF$,,AUTO
         1 000147   000000 236100                    LDQ     0,,PR0
         1 000150   400000 316007                    CANQ    -131072,DL
         1 000151   000154 600000 1                  TZE     s:4049
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:101  

      596     4047    4                   CALL SUB1;

   4047  1 000152   000237 701000 1                  TSX1    SUB1
         1 000153   000000 011000                    NOP     0

      597     4048    4                   END;

      598     4049    3               TEMP = TEMP + 1;

   4049  1 000154   200031 235100                    LDA     TEMP,,AUTO
         1 000155   000001 035007                    ADLA    1,DL
         1 000156   200031 755100                    STA     TEMP,,AUTO

      599     4050    3               END;

   4050  1 000157   200007 236100                    LDQ     COUNT,,AUTO
         1 000160   000000 116000 xsym               CMPQ    LL_U_SECONDARY_ENTREF_COUNT
         1 000161   000165 603000 1                  TRC     s:4051
         1 000162   200031 236100                    LDQ     TEMP,,AUTO
         1 000163   000000 116000 xsym               CMPQ    LL_U_ENTREF_CUR
         1 000164   000142 602000 1                  TNC     s:4045

      600     4051    2           CALL SUB2;

   4051  1 000165   000545 701000 1                  TSX1    SUB2
         1 000166   000000 011000                    NOP     0

      601     4052    2           END;

      602     4053    2       IF LL_U_SECONDARY_SYMREF_COUNT > 0 THEN DO;

   4053  1 000167   000000 235000 xsym               LDA     LL_U_SECONDARY_SYMREF_COUNT
         1 000170   000236 600000 1                  TZE     s:4070

      603     4054    2           LL_DOBUF = 'B******** UNRESOLVED SECONDARY DATA REFERENCES ********';

PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:102  
   4054  1 000171   040000 100400                    MLR     fill='040'O
         1 000172   000052 000067 0                  ADSC9   42                       cn=0,n=55
         1 000173   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      604     4055    2           CALL LLM$MON_SVC (LL#WRITEDO);

   4055  1 000174   000000 630400 2                  EPPR0   0
         1 000175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000176   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000177   000000 011000                    NOP     0

      605     4056    2           TEMP = 0;

   4056  1 000200   200031 450100                    STZ     TEMP,,AUTO

      606     4057    2           COUNT = 0;

   4057  1 000201   200007 450100                    STZ     COUNT,,AUTO

      607     4058    2           BUFFER_1 = ' ';

   4058  1 000202   040100 100400                    MLR     fill='040'O
         1 000203   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000204   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32

      608     4059    2           BUFFER_2 = ' ';

   4059  1 000205   040100 100400                    MLR     fill='040'O
         1 000206   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000207   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32

      609     4060    3           DO WHILE ( COUNT < LL_U_SECONDARY_SYMREF_COUNT AND

   4060  1 000210   000226 710000 1                  TRA     s:4067

      610     4061    3              TEMP < LL_U_SYMREF_CUR );
      611     4062    3               REF$ = PINCRW ( LL_U_SYMREF$, TEMP );
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:103  

   4062  1 000211   200031 236100                    LDQ     TEMP,,AUTO
         1 000212   000022 736000                    QLS     18
         1 000213   000000 036000 xsym               ADLQ    LL_U_SYMREF$
         1 000214   200006 756100                    STQ     REF$,,AUTO

      612     4063    4               IF REF$ -> B$FEP_UNSATREF.SREF THEN DO;

   4063  1 000215   200006 470500                    LDP0    REF$,,AUTO
         1 000216   000000 236100                    LDQ     0,,PR0
         1 000217   400000 316007                    CANQ    -131072,DL
         1 000220   000223 600000 1                  TZE     s:4066

      613     4064    4                   CALL SUB1;

   4064  1 000221   000237 701000 1                  TSX1    SUB1
         1 000222   000000 011000                    NOP     0

      614     4065    4                   END;

      615     4066    3               TEMP = TEMP + 1;

   4066  1 000223   200031 235100                    LDA     TEMP,,AUTO
         1 000224   000001 035007                    ADLA    1,DL
         1 000225   200031 755100                    STA     TEMP,,AUTO

      616     4067    3               END;

   4067  1 000226   200007 236100                    LDQ     COUNT,,AUTO
         1 000227   000000 116000 xsym               CMPQ    LL_U_SECONDARY_SYMREF_COUNT
         1 000230   000234 603000 1                  TRC     s:4068
         1 000231   200031 236100                    LDQ     TEMP,,AUTO
         1 000232   000000 116000 xsym               CMPQ    LL_U_SYMREF_CUR
         1 000233   000211 602000 1                  TNC     s:4062

      617     4068    2           CALL SUB2;

PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:104  
   4068  1 000234   000545 701000 1                  TSX1    SUB2
         1 000235   000000 011000                    NOP     0

      618     4069    2           END;

      619     4070    1       RETURN;

   4070  1 000236   000000 702200 xent               TSX2  ! X66_ARET

      620     4071    1   SUB1: PROC;

   4071  1 000237   200032 741300       SUB1         STX1  ! TEMP+1,,AUTO

      621     4072    2       COUNT = COUNT + 1;

   4072  1 000240   200007 235100                    LDA     COUNT,,AUTO
         1 000241   000001 035007                    ADLA    1,DL
         1 000242   200007 755100                    STA     COUNT,,AUTO

      622     4073    2       ONAME$ = PINCRW ( LL_UREF_NAME$,

   4073  1 000243   200006 470500                    LDP0    REF$,,AUTO
         1 000244   000000 720100                    LXL0    0,,PR0
         1 000245   377777 360003                    ANX0    131071,DU
         1 000246   000000 636010                    EAQ     0,X0
         1 000247   000000 036000 xsym               ADLQ    LL_UREF_NAME$
         1 000250   200004 756100                    STQ     ONAME$,,AUTO

      623     4074    2          REF$ -> B$FEP_UNSATREF.OPOINTER );
      624     4075    2       RNAME$ = PINCRW ( LL_UREF_NAME$,

   4075  1 000251   000000 222100                    LDX2    0,,PR0
         1 000252   000000 636012                    EAQ     0,X2
         1 000253   000000 036000 xsym               ADLQ    LL_UREF_NAME$
         1 000254   200005 756100                    STQ     RNAME$,,AUTO

      625     4076    2          REF$ -> B$FEP_UNSATREF.NPOINTER );
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:105  
      626     4077    2       LENGTH = 1 + ONAME$ -> B$DNAME.COUNT +

   4077  1 000255   200005 471500                    LDP1    RNAME$,,AUTO
         1 000256   100000 236100                    LDQ     0,,PR1
         1 000257   000022 772000                    QRL     18
         1 000260   200034 756100                    STQ     TEMP+3,,AUTO
         1 000261   200004 473500                    LDP3    ONAME$,,AUTO
         1 000262   300000 236100                    LDQ     0,,PR3
         1 000263   000022 772000                    QRL     18
         1 000264   200034 036100                    ADLQ    TEMP+3,,AUTO
         1 000265   000001 036007                    ADLQ    1,DL
         1 000266   200030 756100                    STQ     LENGTH,,AUTO

      627     4078    2          RNAME$ -> B$DNAME.COUNT;
      628     4079    3       IF LENGTH > 32 THEN DO;

   4079  1 000267   000041 116007                    CMPQ    33,DL
         1 000270   000375 602000 1                  TNC     s:4100

      629     4080    4           IF BUFFER_1 ~= ' ' THEN DO;

   4080  1 000271   040000 106500                    CMPC    fill='040'O
         1 000272   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
         1 000273   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000274   000323 600000 1                  TZE     s:4090

      630     4081    4               CALL INSERT ( LL_DOBUF, 0,,

   4081  1 000275   040000 100400                    MLR     fill='040'O
         1 000276   000070 000005 0                  ADSC9   56                       cn=0,n=5
         1 000277   000000 000005 xsym               ADSC9   LL_DOBUF                 cn=0,n=5
         1 000300   040000 100500                    MLR     fill='040'O
         1 000301   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
         1 000302   000001 200040 xsym               ADSC9   LL_DOBUF+1               cn=1,n=32
         1 000303   040000 100400                    MLR     fill='040'O
         1 000304   000071 000004 0                  ADSC9   57                       cn=0,n=4
         1 000305   000011 200004 xsym               ADSC9   LL_DOBUF+9               cn=1,n=4
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:106  
         1 000306   040000 100500                    MLR     fill='040'O
         1 000307   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32
         1 000310   000012 200107 xsym               ADSC9   LL_DOBUF+10              cn=1,n=71

      631     4082    4                  'A    ',
      632     4083    4                  BUFFER_1,
      633     4084    4                  '    ',
      634     4085    4                  BUFFER_2 );
      635     4086    4               CALL LLM$MON_SVC (LL#WRITEDO);

   4086  1 000311   000000 630400 2                  EPPR0   0
         1 000312   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000313   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000314   000000 011000                    NOP     0

      636     4087    4               BUFFER_1 = ' ';

   4087  1 000315   040100 100400                    MLR     fill='040'O
         1 000316   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000317   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32

      637     4088    4               BUFFER_2 = ' ';

   4088  1 000320   040100 100400                    MLR     fill='040'O
         1 000321   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000322   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32

      638     4089    4               END;

      639     4090    3           CALL INSERT ( LL_DOBUF, 0,,

   4090  1 000323   200005 470500                    LDP0    RNAME$,,AUTO
         1 000324   000000 220100                    LDX0    0,,PR0
         1 000325   200004 471500                    LDP1    ONAME$,,AUTO
         1 000326   100000 221100                    LDX1    0,,PR1
         1 000327   040000 100400                    MLR     fill='040'O
         1 000330   000070 000005 0                  ADSC9   56                       cn=0,n=5
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:107  
         1 000331   000000 000005 xsym               ADSC9   LL_DOBUF                 cn=0,n=5
         1 000332   040000 100540                    MLR     fill='040'O
         1 000333   000000 400010                    ADSC9   0,,PR0                   cn=2,n=*X0
         1 000334   000001 200153 xsym               ADSC9   LL_DOBUF+1               cn=1,n=107
         1 000335   000000 636010                    EAQ     0,X0
         1 000336   000022 772000                    QRL     18
         1 000337   000153 116007                    CMPQ    107,DL
         1 000340   000362 603000 1                  TRC     s:4095
         1 000341   200034 740100                    STX0    TEMP+3,,AUTO
         1 000342   777624 620010                    EAX0    -108,X0
         1 000343   777777 660003                    ERX0    -1,DU
         1 000344   200034 235100                    LDA     TEMP+3,,AUTO
         1 000345   000022 771000                    ARL     18
         1 000346   040045 100400                    MLR     fill='040'O
         1 000347   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000350   000001 200010 xsym               ADSC9   LL_DOBUF+1,A             cn=1,n=*X0
         1 000351   200034 236100                    LDQ     TEMP+3,,AUTO
         1 000352   000022 772000                    QRL     18
         1 000353   000152 116007                    CMPQ    106,DL
         1 000354   000362 603000 1                  TRC     s:4095
         1 000355   777625 620006                    EAX0    -107,QL
         1 000356   777777 660003                    ERX0    -1,DU
         1 000357   040046 100540                    MLR     fill='040'O
         1 000360   100000 400011                    ADSC9   0,,PR1                   cn=2,n=*X1
         1 000361   000001 400010 xsym               ADSC9   LL_DOBUF+1,Q             cn=2,n=*X0

      640     4091    3              'A    ',
      641     4092    3              RNAME$ -> B$DNAME.TEXT,
      642     4093    3              '.',
      643     4094    3              ONAME$ -> B$DNAME.TEXT );
      644     4095    3           CALL LLM$MON_SVC (LL#WRITEDO);

   4095  1 000362   000000 630400 2                  EPPR0   0
         1 000363   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000364   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000365   000000 011000                    NOP     0

PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:108  
      645     4096    3           BUFFER_1 = ' ';

   4096  1 000366   040100 100400                    MLR     fill='040'O
         1 000367   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000370   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32

      646     4097    3           BUFFER_2 = ' ';

   4097  1 000371   040100 100400                    MLR     fill='040'O
         1 000372   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000373   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32

      647     4098    3           END;

   4098  1 000374   000543 710000 1                  TRA     s:4131

      648     4099    3       ELSE DO;

      649     4100    3           IF BUFFER_1 = ' ' THEN

   4100  1 000375   040000 106500                    CMPC    fill='040'O
         1 000376   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
         1 000377   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000400   000432 601000 1                  TNZ     s:4106

      650     4101    3               CALL CONCAT ( BUFFER_1,

   4101  1 000401   100000 220100                    LDX0    0,,PR1
         1 000402   300000 222100                    LDX2    0,,PR3
         1 000403   040100 100540                    MLR     fill='040'O
         1 000404   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         1 000405   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
         1 000406   000000 636010                    EAQ     0,X0
         1 000407   000022 772000                    QRL     18
         1 000410   000040 116007                    CMPQ    32,DL
         1 000411   000431 603000 1                  TRC     s:4101+24
         1 000412   200034 740100                    STX0    TEMP+3,,AUTO
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:109  
         1 000413   777737 620010                    EAX0    -33,X0
         1 000414   777777 660003                    ERX0    -1,DU
         1 000415   200034 236100                    LDQ     TEMP+3,,AUTO
         1 000416   000022 772000                    QRL     18
         1 000417   040146 100400                    MLR     fill='040'O
         1 000420   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000421   200010 000010                    ADSC9   BUFFER_1,Q,AUTO          cn=0,n=*X0
         1 000422   000037 116007                    CMPQ    31,DL
         1 000423   000431 603000 1                  TRC     s:4101+24
         1 000424   777740 620006                    EAX0    -32,QL
         1 000425   777777 660003                    ERX0    -1,DU
         1 000426   040146 100540                    MLR     fill='040'O
         1 000427   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         1 000430   200010 200010                    ADSC9   BUFFER_1,Q,AUTO          cn=1,n=*X0
         1 000431   000543 710000 1                  TRA     s:4131

      651     4102    3                  RNAME$ -> B$DNAME.TEXT,
      652     4103    3                  '.',
      653     4104    3                  ONAME$ -> B$DNAME.TEXT );
      654     4105    3           ELSE
      655     4106    4               IF BUFFER_2 = ' ' THEN DO;

   4106  1 000432   040000 106500                    CMPC    fill='040'O
         1 000433   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32
         1 000434   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000435   000515 601000 1                  TNZ     s:4121

      656     4107    4                   CALL CONCAT ( BUFFER_2,

   4107  1 000436   100000 220100                    LDX0    0,,PR1
         1 000437   300000 222100                    LDX2    0,,PR3
         1 000440   040100 100540                    MLR     fill='040'O
         1 000441   100000 400010                    ADSC9   0,,PR1                   cn=2,n=*X0
         1 000442   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32
         1 000443   000000 636010                    EAQ     0,X0
         1 000444   000022 772000                    QRL     18
         1 000445   000040 116007                    CMPQ    32,DL
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:110  
         1 000446   000466 603000 1                  TRC     s:4111
         1 000447   200034 740100                    STX0    TEMP+3,,AUTO
         1 000450   777737 620010                    EAX0    -33,X0
         1 000451   777777 660003                    ERX0    -1,DU
         1 000452   200034 236100                    LDQ     TEMP+3,,AUTO
         1 000453   000022 772000                    QRL     18
         1 000454   040146 100400                    MLR     fill='040'O
         1 000455   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000456   200020 000010                    ADSC9   BUFFER_2,Q,AUTO          cn=0,n=*X0
         1 000457   000037 116007                    CMPQ    31,DL
         1 000460   000466 603000 1                  TRC     s:4111
         1 000461   777740 620006                    EAX0    -32,QL
         1 000462   777777 660003                    ERX0    -1,DU
         1 000463   040146 100540                    MLR     fill='040'O
         1 000464   300000 400012                    ADSC9   0,,PR3                   cn=2,n=*X2
         1 000465   200020 200010                    ADSC9   BUFFER_2,Q,AUTO          cn=1,n=*X0

      657     4108    4                      RNAME$ -> B$DNAME.TEXT,
      658     4109    4                      '.',
      659     4110    4                      ONAME$ -> B$DNAME.TEXT );
      660     4111    4                   CALL INSERT ( LL_DOBUF, 0,,

   4111  1 000466   040000 100400                    MLR     fill='040'O
         1 000467   000070 000005 0                  ADSC9   56                       cn=0,n=5
         1 000470   000000 000005 xsym               ADSC9   LL_DOBUF                 cn=0,n=5
         1 000471   040000 100500                    MLR     fill='040'O
         1 000472   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
         1 000473   000001 200040 xsym               ADSC9   LL_DOBUF+1               cn=1,n=32
         1 000474   040000 100400                    MLR     fill='040'O
         1 000475   000071 000004 0                  ADSC9   57                       cn=0,n=4
         1 000476   000011 200004 xsym               ADSC9   LL_DOBUF+9               cn=1,n=4
         1 000477   040000 100500                    MLR     fill='040'O
         1 000500   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32
         1 000501   000012 200107 xsym               ADSC9   LL_DOBUF+10              cn=1,n=71

      661     4112    4                      'A    ',
      662     4113    4                      BUFFER_1,
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:111  
      663     4114    4                      '    ',
      664     4115    4                      BUFFER_2 );
      665     4116    4                   CALL LLM$MON_SVC (LL#WRITEDO);

   4116  1 000502   000000 630400 2                  EPPR0   0
         1 000503   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000504   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000505   000000 011000                    NOP     0

      666     4117    4                   BUFFER_1 = ' ';

   4117  1 000506   040100 100400                    MLR     fill='040'O
         1 000507   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000510   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32

      667     4118    4                   BUFFER_2 = ' ';

   4118  1 000511   040100 100400                    MLR     fill='040'O
         1 000512   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000513   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32

      668     4119    4                   END;

   4119  1 000514   000543 710000 1                  TRA     s:4131

      669     4120    4               ELSE DO;

      670     4121    4                   CALL INSERT ( LL_DOBUF, 0,,

   4121  1 000515   040000 100400                    MLR     fill='040'O
         1 000516   000070 000005 0                  ADSC9   56                       cn=0,n=5
         1 000517   000000 000005 xsym               ADSC9   LL_DOBUF                 cn=0,n=5
         1 000520   040000 100500                    MLR     fill='040'O
         1 000521   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
         1 000522   000001 200040 xsym               ADSC9   LL_DOBUF+1               cn=1,n=32
         1 000523   040000 100400                    MLR     fill='040'O
         1 000524   000071 000004 0                  ADSC9   57                       cn=0,n=4
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:112  
         1 000525   000011 200004 xsym               ADSC9   LL_DOBUF+9               cn=1,n=4
         1 000526   040000 100500                    MLR     fill='040'O
         1 000527   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32
         1 000530   000012 200107 xsym               ADSC9   LL_DOBUF+10              cn=1,n=71

      671     4122    4                      'A    ',
      672     4123    4                      BUFFER_1,
      673     4124    4                      '    ',
      674     4125    4                      BUFFER_2 );
      675     4126    4                   CALL LLM$MON_SVC (LL#WRITEDO);

   4126  1 000531   000000 630400 2                  EPPR0   0
         1 000532   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000533   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000534   000000 011000                    NOP     0

      676     4127    4                   BUFFER_1 = ' ';

   4127  1 000535   040100 100400                    MLR     fill='040'O
         1 000536   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000537   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32

      677     4128    4                   BUFFER_2 = ' ';

   4128  1 000540   040100 100400                    MLR     fill='040'O
         1 000541   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000542   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32

      678     4129    4                   END;

      679     4130    3           END;

      680     4131    2   END SUB1;

   4131  1 000543   200032 221300                    LDX1  ! TEMP+1,,AUTO
         1 000544   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:113  
      681     4132
      682     4133    1   SUB2: PROC;

   4133  1 000545   200032 741300       SUB2         STX1  ! TEMP+1,,AUTO

      683     4134    3       IF BUFFER_1 ~= ' ' THEN DO;

   4134  1 000546   040000 106500                    CMPC    fill='040'O
         1 000547   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
         1 000550   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000551   000573 600000 1                  TZE     s:4143

      684     4135    3           CALL INSERT ( LL_DOBUF, 0,,

   4135  1 000552   040000 100400                    MLR     fill='040'O
         1 000553   000072 000005 0                  ADSC9   58                       cn=0,n=5
         1 000554   000000 000005 xsym               ADSC9   LL_DOBUF                 cn=0,n=5
         1 000555   040000 100500                    MLR     fill='040'O
         1 000556   200010 000040                    ADSC9   BUFFER_1,,AUTO           cn=0,n=32
         1 000557   000001 200040 xsym               ADSC9   LL_DOBUF+1               cn=1,n=32
         1 000560   040000 100400                    MLR     fill='040'O
         1 000561   000071 000004 0                  ADSC9   57                       cn=0,n=4
         1 000562   000011 200004 xsym               ADSC9   LL_DOBUF+9               cn=1,n=4
         1 000563   040000 100500                    MLR     fill='040'O
         1 000564   200020 000040                    ADSC9   BUFFER_2,,AUTO           cn=0,n=32
         1 000565   000012 200107 xsym               ADSC9   LL_DOBUF+10              cn=1,n=71

      685     4136    3              'D    ',
      686     4137    3              BUFFER_1,
      687     4138    3              '    ',
      688     4139    3              BUFFER_2 );
      689     4140    3           CALL LLM$MON_SVC (LL#WRITEDO);

   4140  1 000566   000000 630400 2                  EPPR0   0
         1 000567   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000570   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000571   000000 011000                    NOP     0
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:114  

      690     4141    3           END;

   4141  1 000572   000602 710000 1                  TRA     s:4146

      691     4142    3       ELSE DO;

      692     4143    3           LL_DOBUF = 'C';

   4143  1 000573   040000 100400                    MLR     fill='040'O
         1 000574   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000575   000000 000160 xsym               ADSC9   LL_DOBUF                 cn=0,n=112

      693     4144    3           CALL LLM$MON_SVC (LL#WRITEDO);

   4144  1 000576   000000 630400 2                  EPPR0   0
         1 000577   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000600   000000 701000 xent               TSX1    LLM$MON_SVC
         1 000601   000000 011000                    NOP     0

      694     4145    3           END;

      695     4146    2   END SUB2;

   4146  1 000602   200032 221300                    LDX1  ! TEMP+1,,AUTO
         1 000603   000001 702211                    TSX2  ! 1,X1
      696     4147    1   END LLS$SAYREFS;

PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:115  
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   LL_MACS_C.:E05TOU  is referenced.
   LL_SUBS_C.:E05TOU  is referenced.
   LL_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure LLS$SAYREFS.
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:116  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w CHAR(32)    r     1 BUFFER_1                  20-0-0/w CHAR(32)    r     1 BUFFER_2
     7-0-0/w UBIN        r     1 COUNT                     30-0-0/w UBIN        r     1 LENGTH
     4-0-0/w PTR         r     1 ONAME$                     6-0-0/w PTR         r     1 REF$
     5-0-0/w PTR         r     1 RNAME$                    31-0-0/w UBIN        r     1 TEMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w CHAR(112)   r     1 LL_DOBUF                   0-0-0/w PTR         r     1 LL_UREF_NAME$
     0-0-0/w PTR         r     1 LL_U_ENTREF$               0-0-0/w UBIN        r     1 LL_U_ENTREF_CUR
     0-0-0/w UBIN        r     1 LL_U_PRIMARY_ENTREF_COUNT
     0-0-0/w UBIN        r     1 LL_U_PRIMARY_SYMREF_COUNT
     0-0-0/w UBIN        r     1 LL_U_SECONDARY_ENTREF_COUNT
     0-0-0/w UBIN        r     1 LL_U_SECONDARY_SYMREF_COUNT
     0-0-0/w PTR         r     1 LL_U_SYMREF$               0-0-0/w UBIN        r     1 LL_U_SYMREF_CUR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(18)    r     1 B$DNAME                    0-0-0/w STRC        r     1 B$FEP_UNSATREF


   Procedure LLS$SAYREFS requires 388 words for executable code.
   Procedure LLS$SAYREFS requires 30 words of local(AUTO) storage.
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:117  

    No errors detected in file LLS$SATREF.:E05TSI    .
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:118  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:119  
          MINI XREF LISTING

B$DNAME.COUNT
      3979**DCL      3986--IMP-SIZ  4077>>ASSIGN   4077>>ASSIGN   4090>>CALLBLT  4090>>CALLBLT  4101>>CALLBLT
      4101>>CALLBLT  4107>>CALLBLT  4107>>CALLBLT
B$DNAME.TEXT
      3986**DCL      4090>>CALLBLT  4090>>CALLBLT  4101>>CALLBLT  4101>>CALLBLT  4107>>CALLBLT  4107>>CALLBLT
B$FEP_UNSATREF.NPOINTER
      3959**DCL      4075>>ASSIGN
B$FEP_UNSATREF.OPOINTER
      3965**DCL      4073>>ASSIGN
B$FEP_UNSATREF.SREF
      3963**DCL      4012>>IF       4029>>IF       4046>>IF       4063>>IF
BUFFER_1
      3995**DCL      4007<<ASSIGN   4024<<ASSIGN   4041<<ASSIGN   4058<<ASSIGN   4080>>IF       4081>>CALLBLT
      4087<<ASSIGN   4096<<ASSIGN   4100>>IF       4101<<CALLBLT  4111>>CALLBLT  4117<<ASSIGN   4121>>CALLBLT
      4127<<ASSIGN   4134>>IF       4135>>CALLBLT
BUFFER_2
      3996**DCL      4008<<ASSIGN   4025<<ASSIGN   4042<<ASSIGN   4059<<ASSIGN   4081>>CALLBLT  4088<<ASSIGN
      4097<<ASSIGN   4106>>IF       4107<<CALLBLT  4111>>CALLBLT  4118<<ASSIGN   4121>>CALLBLT  4128<<ASSIGN
      4135>>CALLBLT
COUNT
      3994**DCL      4006<<ASSIGN   4009>>DOWHILE  4023<<ASSIGN   4026>>DOWHILE  4040<<ASSIGN   4043>>DOWHILE
      4057<<ASSIGN   4060>>DOWHILE  4072<<ASSIGN   4072>>ASSIGN
LENGTH
      3997**DCL      4077<<ASSIGN   4079>>IF
LLM$MON_SVC
      3993**DCL-ENT  4004--CALL     4021--CALL     4038--CALL     4055--CALL     4086--CALL     4095--CALL
      4116--CALL     4126--CALL     4140--CALL     4144--CALL
LL_DOBUF
        15**DCL      4003<<ASSIGN   4020<<ASSIGN   4037<<ASSIGN   4054<<ASSIGN   4081<<CALLBLT  4090<<CALLBLT
      4111<<CALLBLT  4121<<CALLBLT  4135<<CALLBLT  4143<<ASSIGN
LL_UREF_NAME$
        26**DCL      4073>>ASSIGN   4075>>ASSIGN
PL6.E3A0      #002=LLS$SAYREFS File=LLS$SATREF.:E05TSI                           WED 07/30/97 03:18 Page:120  
LL_U_ENTREF$
        27**DCL      4011>>ASSIGN   4045>>ASSIGN
LL_U_ENTREF_CUR
        29**DCL      4009>>DOWHILE  4043>>DOWHILE
LL_U_PRIMARY_ENTREF_COUNT
        32**DCL      4002>>IF       4009>>DOWHILE
LL_U_PRIMARY_SYMREF_COUNT
        31**DCL      4019>>IF       4026>>DOWHILE
LL_U_SECONDARY_ENTREF_COUNT
        31**DCL      4036>>IF       4043>>DOWHILE
LL_U_SECONDARY_SYMREF_COUNT
        30**DCL      4053>>IF       4060>>DOWHILE
LL_U_SYMREF$
        27**DCL      4028>>ASSIGN   4062>>ASSIGN
LL_U_SYMREF_CUR
        29**DCL      4026>>DOWHILE  4060>>DOWHILE
ONAME$
      3990**DCL      4073<<ASSIGN   4077>>ASSIGN   4090>>CALLBLT  4090>>CALLBLT  4101>>CALLBLT  4101>>CALLBLT
      4107>>CALLBLT  4107>>CALLBLT
REF$
      3992**DCL      4011<<ASSIGN   4012>>IF       4028<<ASSIGN   4029>>IF       4045<<ASSIGN   4046>>IF
      4062<<ASSIGN   4063>>IF       4073>>ASSIGN   4075>>ASSIGN
RNAME$
      3991**DCL      4075<<ASSIGN   4077>>ASSIGN   4090>>CALLBLT  4090>>CALLBLT  4101>>CALLBLT  4101>>CALLBLT
      4107>>CALLBLT  4107>>CALLBLT
SUB1
      4071**PROC     4013--CALL     4030--CALL     4047--CALL     4064--CALL
SUB2
      4133**PROC     4017--CALL     4034--CALL     4051--CALL     4068--CALL
TEMP
      3999**DCL      4005<<ASSIGN   4009>>DOWHILE  4011>>ASSIGN   4015<<ASSIGN   4015>>ASSIGN   4022<<ASSIGN
      4026>>DOWHILE  4028>>ASSIGN   4032<<ASSIGN   4032>>ASSIGN   4039<<ASSIGN   4043>>DOWHILE  4045>>ASSIGN
      4049<<ASSIGN   4049>>ASSIGN   4056<<ASSIGN   4060>>DOWHILE  4062>>ASSIGN   4066<<ASSIGN   4066>>ASSIGN
