VERSION E05

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:1    
        1        1        /*M* KXA$ADMIN  -  X.25 Handler Administrative Routine                          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* PLM=4,IND=3,CTI=3,DCI=6,IAD=0,DTI=6,AND=Y,CSI=3,THI=3,STI=3,DMC=Y */
        9        9        /*P* NAME: KXA$ADMIN                                                          */
       10       10        /*P* PURPOSE: This subroutine takes care of the administrative                */
       11       11        /*P* chores for the X.25 handler.                                             */
       12       12
       13       13        KXA$ADMIN: PROC ( ADMIN_FPT ) ALTRET;
       14       14
       15       15        /*F* NAME: KXA$ADMIN                                                          */
       16       16        /*F* PURPOSE: This subroutine takes care of the administrative                */
       17       17        /*F* chores for the X.25 handler.                                             */
       18       18
       19       19        /*D* NAME: KXA$ADMIN                                                          */
       20       20        /*D* PURPOSE: This subroutine takes care of the administrative                */
       21       21        /*D* chores for the X.25 handler.                                             */
       22       22        /*D* CALL: CALL KXA$ADMIN ( KH$ADMIN_FPT ) ALTRET ( label );  */
       23       23        /*D* INPUT: ADMIN_FPT - the function to perform  */
       24       24        /*D* OUTPUT: ADMIN_FPT.RESULTS - error code on altreturns  */
       25       25        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:2    
       26       26        /*****************************************************************
       27       27        *                                                                *
       28       28        *                           Include files                        *
       29       29        *                                                                *
       30       30        *****************************************************************/
       31       31
       32       32        %INCLUDE LCP_6;
       33     4311        %INCLUDE CP_6_SUBS;
       34     4851        %INCLUDE G_JIT_M;
       35     5116        %INCLUDE KH$CHN;
       36     5238        %INCLUDE KHA_FNC_E;
       37     5338        %INCLUDE KH_MACRO_C;
       38     6081        %INCLUDE KL_CONTROL_C;
       39     6461        %INCLUDE KX_EQUS_E;
       40     6900        %INCLUDE KX_PERR_C;
       41     7029        %INCLUDE KX_SCODE_C;
       42     7095        %INCLUDE KX_DATA_C;
       43     7163        %INCLUDE KX_MACROS_M;
       44     7934        %INCLUDE KXX_MACROS_M;
       45     8276        %INCLUDE KV_GLBCNS_E;
       46     8617        %INCLUDE KV$GLB;
       47     9036        %KV#CQ_HNDID_E;
       48     9041        %INCLUDE K_ID_E;
       49     9091        %K#ENTID_E;
       50     9110        %K#LYRID_E;
       51     9117        %INCLUDE KL_MACRO_C;
       52    12469        %KL_REQSTATS;
       53    12763        %INCLUDE KL_AFCN_C;
       54    12864        %INCLUDE KL_SUPER_C;
       55    15766        %INCLUDE KNH_MACRO_C;
       56    16049        %INCLUDE K_ADDRESS_M;
       57    16552        %INCLUDE KH$STT;
       58    16582        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:3    
       59    16583        /*****************************************************************
       60    16584        *                                                                *
       61    16585        *                           Refs                                 *
       62    16586        *                                                                *
       63    16587        *****************************************************************/
       64    16588
       65    16589    1   DCL KHA$DVCADM ENTRY (6) ALTRET;
       66    16590    1   DCL KHI$DISABLE ENTRY (1);
       67    16591    1   DCL KHI$ENABLE ENTRY;
       68    16592    1   DCL KXF$FRAME ENTRY (1) ALTRET;
       69    16593    1   DCL KXN$CMND ENTRY (3);
       70    16594    1   DCL KXS$Q_SYSLOG ENTRY (1);
       71    16595    1   DCL KXS$SYSLOG ENTRY (7);
       72    16596    1   DCL KXX$X29 ENTRY (1);
       73    16597    1   DCL KHA$SNDSTT ENTRY(2) ALTRET;
       74    16598    1   DCL KHD$SCREECH ENTRY (1);
       75    16599    1   DCL KHA$ERRLOG ENTRY (2) ALTRET;
       76    16600    1   DCL KHC$XEQ2 ENTRY (1) ALTRET;
       77    16601    1   DCL KHA$LINE_ACTIVE ENTRY (1);
       78    16602    1   DCL KXX$INTCNC ENTRY (2) ALTRET;
       79    16603        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:4    
       80    16604        /*****************************************************************
       81    16605        *                                                                *
       82    16606        *                           Auto                                 *
       83    16607        *                                                                *
       84    16608        *****************************************************************/
       85    16609
       86    16610        %KH$ADMIN_FPT ( FPTN = ADMIN_FPT, STCLASS = );
       87    16821        %FPT_X25 ( FPTN = CALL_FPT, STCLASS = );
       88    16865
       89    16866    1   DCL CTX$ PTR;
       90    16867    1   DCL BUF$ PTR;
       91    16868    1   DCL LEVEL UBIN;
       92    16869    1   DCL ERROR UBIN(32);
       93    16870    1   DCL Y@CRTEXCTIM UBIN(32);
       94    16871        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:5    
       95    16872        /*****************************************************************
       96    16873        *                                                                *
       97    16874        *                           Based                                *
       98    16875        *                                                                *
       99    16876        *****************************************************************/
      100    16877
      101    16878    1   DCL BASED_WORD UBIN BASED;
      102    16879        %KH$CHN ( STCLASS = BASED );
      103    17003        %KX$L2 ( STCLASS=BASED );
      104    17370        %EQU L2 = CHARTEXT ('ADMIN_FPT.CHN$->KH$CHN.CTX$->KX$L2');
      105    17371        %KX$LINKDEV ( STCLASS = "BASED(BUF$)" );
      106    17398        %G$JIT ( STCLASS = "BASED(G$JIT$)" );
      107    17812        %KL_BLKHDR ( NAME = BLKHDR, STCLASS = "BASED(ADMIN_FPT.CTX$)" );
      108    17907        %EJECT
      109    17908        /*****************************************************************
      110    17909        *                                                                *
      111    17910        *                           Constant                             *
      112    17911        *                                                                *
      113    17912        *****************************************************************/
      114    17913
      115    17914        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      116    17915                           FPTN = SGNRJC,
      117    17916                           ERR# = %E_KXA_SGNRJC# );
      118    17962        /*E*   ERROR:      KXA-E_KXA_SGNRJC#-0
      119    17963               MESSAGE:    autologon failed, line KILLed.
      120    17964        */
      121    17965        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      122    17966                           FPTN = SUBSUB,
      123    17967                           ERR# = %E_KXA_SUBSUB# );
      124    18013        /*E*   ERROR:      KXA-E_KXA_SUBSUB#-0
      125    18014               MESSAGE:    Admin fcn for subsubchan not accepted.
      126    18015        */
      127    18016        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      128    18017                           FPTN = AUTLOG,
      129    18018                           ERR# = %E_KXA_AUTLOG# );
      130    18064        /*E*   ERROR:      KXA-E_KXA_AUTLOG#-0
      131    18065               MESSAGE:    All HDLC lines have to be autologged.
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:6    
      132    18066        */
      133    18067        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      134    18068                           FPTN = ENBFAL,
      135    18069                           ERR# = %E_KXA_ENBFAL# );
      136    18115        /*E*   ERROR:      KXA-E_KXA_ENBFAL#-0
      137    18116               MESSAGE:    Problem encountered in enabling line.
      138    18117        */
      139    18118        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      140    18119                           FPTN = KILFAL,
      141    18120                           ERR# = %E_KXA_KILFAL# );
      142    18166        /*E*   ERROR:      KXA-E_KXA_KILFAL#-0
      143    18167               MESSAGE:    Problem encountered in killing line.
      144    18168        */
      145    18169        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      146    18170                           FPTN = BLDFAL,
      147    18171                           ERR# = %E_KXA_BLDFAL# );
      148    18217        /*E*   ERROR:      KXA-E_KXA_BLDFAL#-0
      149    18218               MESSAGE:    Problem encountered in getting context.
      150    18219        */
      151    18220        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      152    18221                           FPTN = DSCFAL,
      153    18222                           ERR# = %E_KXA_DSCFAL# );
      154    18268        /*E*   ERROR:      KXA-E_KXA_DSCFAL#-0
      155    18269               MESSAGE:    Problem encountered in disconnecting line.
      156    18270        */
      157    18271        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      158    18272                           FPTN = UNKFCN,
      159    18273                           ERR# = %E_KXA_UNKFCN# );
      160    18319        /*E*   ERROR:      KXA-E_KXA_UNKFCN#-0
      161    18320               MESSAGE:    Unknown admin function.
      162    18321        */
      163    18322        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      164    18323                           FPTN = DSBFAL,
      165    18324                           ERR# = %E_KXA_DSBFAL# );
      166    18370        /*E*   ERROR:      KXA-E_KXA_DSBFAL#-0
      167    18371               MESSAGE:    Problem encountered in disabling line.
      168    18372        */
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:7    
      169    18373        %VLP_SCODE (FPTN=Y_VC_SGNRJC,STCLASS=CONSTANT,FCG=KX,MID=A,ERR#=%S$KX_VC_SGNRJC#);
      170    18434        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:8    
      171    18435        /*****************************************************************
      172    18436        *                                                                *
      173    18437        *                           Static                               *
      174    18438        *                                                                *
      175    18439        *****************************************************************/
      176    18440
      177    18441        %KH$CTLTBL ( FPTN = KH_CTLTBL, STCLASS = SYMREF );
      178    18653        %KX_DATA;
      179    19343        %KX_STATS_X29;
      180    19684    1   DCL G$JIT$ PTR SYMREF;
      181    19685        %KV$STT ( NAME = KV_STT, STCLASS = SYMREF );
      182    20079        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:9    
      183    20080        /*****************************************************************
      184    20081        *                                                                *
      185    20082        *                           Procedure                            *
      186    20083        *                                                                *
      187    20084        *****************************************************************/
      188    20085
      189    20086            %DISABLE;
      190    20089        /*
      191    20090                                             All that we really need for this
      192    20091                                             module is the function and line
      193    20092                                             context block pointer.
      194    20093        */
      195    20094    1       IF ADMIN_FPT.FNC ~= %KHA_FNC_REQSTATS AND ADMIN_FPT.FNC ~= %KHA_FNC_CNTRLCHG
      196    20095    1          THEN
      197    20096    1             CTX$ = ADMIN_FPT.LIN$ -> KH$CHN.CTX$;
      198    20097    2       DO CASE ( ADMIN_FPT.FNC );
      199    20098        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:10   
      200    20099        /*
      201    20100                                             No operation.
      202    20101                                             Configure a line.
      203    20102        */
      204    20103    2          CASE ( %KHA_FNC_NON, %KHA_FNC_CNFG, %KHA_FNC_CNTRLCHG );
      205    20104        /*
      206    20105                                             Do nothing.
      207    20106        */
      208    20107        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:11   
      209    20108        /*
      210    20109                                             Enable a line.
      211    20110        */
      212    20111    2          CASE ( %KHA_FNC_ENABLE );
      213    20112        /*
      214    20113                                             All X25 lines have to be auto-
      215    20114                                             logged in the host.
      216    20115        */
      217    20116    2             IF NOT ADMIN_FPT.CHN$ -> KH$CHN.AUTLGN AND ADMIN_FPT.TERMID.LEV =
      218    20117    2                %TERMINAL_ID_LEV_CHAN#
      219    20118    2                THEN
      220    20119    3                   DO;
      221    20120    3   RESULT_SUBSUB:     ADMIN_FPT.RESULTS = SUBSUB;
      222    20121    3   ENABLE_ALTRET:
      223    20122                           %ENABLE;
      224    20125    3                      ALTRETURN;
      225    20126    3                   END;
      226    20127        /*
      227    20128                                             Call KXF with the request.  If it
      228    20129                                             is for the packet level, KXF will
      229    20130                                             forward it.
      230    20131        */
      231    20132    2             CALL_FPT = '0'B;
      232    20133    2             CALL_FPT.EVN = %KX_F_EV_ENB#;
      233    20134    2             CALL_FPT.RCV$ = CTX$;
      234    20135    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );
      235    20136    2             CALL KXF$FRAME ( CALL_FPT )
      236    20137    2                WHENALTRETURN
      237    20138    3                   DO;
      238    20139    3                      ADMIN_FPT.RESULTS = ENBFAL;
      239    20140    3                      GOTO ENABLE_ALTRET;
      240    20141    3                   END;
      241    20142        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:12   
      242    20143        /*
      243    20144                                             Disable a line.
      244    20145        */
      245    20146    2          CASE ( %KHA_FNC_DISABLE );
      246    20147        /*
      247    20148                                             Call KXF with the request.  If it
      248    20149                                             is for the packet level, KXF will
      249    20150                                             forward it.
      250    20151        */
      251    20152    2             CALL_FPT = '0'B;
      252    20153    2             CALL_FPT.EVN = %KX_F_EV_DSB#;
      253    20154    2             CALL_FPT.RCV$ = CTX$;
      254    20155    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );
      255    20156    2             CALL KXF$FRAME ( CALL_FPT )
      256    20157    2                WHENALTRETURN
      257    20158    3                   DO;
      258    20159    3                      ADMIN_FPT.RESULTS = DSBFAL;
      259    20160    3                      GOTO ENABLE_ALTRET;
      260    20161    3                   END;
      261    20162        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:13   
      262    20163        /*
      263    20164                                             Kill a line.
      264    20165        */
      265    20166    2          CASE ( %KHA_FNC_KILL );
      266    20167        /*
      267    20168                                             Call KXF with the request.  If it
      268    20169                                             is for the packet level, KXF will
      269    20170                                             forward it.
      270    20171        */
      271    20172    2             CALL_FPT = '0'B;
      272    20173    2             CALL_FPT.EVN = %KX_F_EV_KLL#;
      273    20174    2             CALL_FPT.RCV$ = CTX$;
      274    20175    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );
      275    20176    2             CALL KXF$FRAME ( CALL_FPT )
      276    20177    2                WHENALTRETURN
      277    20178    3                   DO;
      278    20179    3                      ADMIN_FPT.RESULTS = KILFAL;
      279    20180    3                      GOTO ENABLE_ALTRET;
      280    20181    3                   END;
      281    20182        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:14   
      282    20183        /*
      283    20184                                             Request statistics.
      284    20185        */
      285    20186    2          CASE ( %KHA_FNC_REQSTATS );
      286    20187        /*
      287    20188            Request for sending statistics buffers to the host.
      288    20189        */
      289    20190    2             IF ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_HDLC)
      290    20191    3                THEN DO;
      291    20192    4                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_HDLC) THEN DO;
      292    20193        /*
      293    20194            HDLC stats requested.
      294    20195        */
      295    20196    4                               CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS, VECTOR(
             20196                                        KX_STATS_HDLC));
      296    20197    4                            END;
      297    20198    4                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_X25) THEN DO;
      298    20199        /*
      299    20200            X25 stats requested.
      300    20201        */
      301    20202    4                               CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS, VECTOR(
             20202                                        KX_STATS_X25));
      302    20203    4                            END;
      303    20204    4                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_X29) THEN DO;
      304    20205        /*
      305    20206            X.29 stats requested.
      306    20207        */
      307    20208    4                               CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS, VECTOR(
             20208                                        KX_STATS_X29));
      308    20209    4                            END;
      309    20210    4                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_VDH) THEN DO;
      310    20211        /*
      311    20212            VDH stats requested.
      312    20213        */
      313    20214    4                               CALL KHC$XEQ2 ( Y@CRTEXCTIM );
      314    20215    4                               KV_STT.SCHEXCTIM = Y@CRTEXCTIM - KX_STATS_HDLC.
             20215                                        IN_TCB_TICS - KX_STATS_HDLC.OUT_TCB_TICS;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:15   
      315    20216    4                               CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS, VECTOR(
             20216                                        KV_STT));
      316    20217    4                            END;
      317    20218    3                   END;
      318    20219        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:16   
      319    20220        /*
      320    20221                                             Build context.
      321    20222        */
      322    20223    2          CASE ( %KHA_FNC_BLDCTX );
      323    20224        /*
      324    20225                                             Make sure the command is for
      325    20226                                             correct BLKTYP.
      326    20227        */
      327    20228    2             IF ( BLKHDR.BLKTYP ~= %KLTY_LINK# ) AND
      328    20229    2                ( BLKHDR.BLKTYP ~= %KLTY_VIRCIR# ) AND
      329    20230    2                ( BLKHDR.BLKTYP ~= %KLTY_LINKDEV# )
      330    20231    2                THEN
      331    20232    3                   DO;
      332    20233    3   BLDFAL:            ADMIN_FPT.RESULTS = BLDFAL;
      333    20234                           %ENABLE;
      334    20237    3                      ALTRETURN;
      335    20238    3                   END;
      336    20239        /*
      337    20240                                             Call KXF with the request.  If it
      338    20241                                             is for the packet level, KXF will
      339    20242                                             forward it.
      340    20243        */
      341    20244    2             CALL_FPT = '0'B;
      342    20245    2             CALL_FPT.EVN = %KX_F_EV_BLDCTX#;
      343    20246    2             CALL_FPT.RCV$ = CTX$;
      344    20247    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );
      345    20248    2             CALL KXF$FRAME ( CALL_FPT ) ALTRET ( BLDFAL );
      346    20249        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:17   
      347    20250        /*
      348    20251                                             Disconnect request for a line.
      349    20252        */
      350    20253    2          CASE ( %KHA_FNC_DISCONNECT_RQS );
      351    20254        /*
      352    20255                                             Call KXF with the request.  If it
      353    20256                                             is for the packet level, KXF will
      354    20257                                             forward it.
      355    20258        */
      356    20259    2             CALL_FPT = '0'B;
      357    20260    2             CALL_FPT.EVN = %KX_F_EV_DSC#;
      358    20261    2             CALL_FPT.RCV$ = CTX$;
      359    20262    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );
      360    20263    2             CALL KXF$FRAME ( CALL_FPT )
      361    20264    2                WHENALTRETURN
      362    20265    3                   DO;
      363    20266    3                      ADMIN_FPT.RESULTS = DSCFAL;
      364    20267    3                      GOTO ENABLE_ALTRET;
      365    20268    3                   END;
      366    20269        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:18   
      367    20270        /*
      368    20271                                             Context building completed for
      369    20272                                             a line.
      370    20273        */
      371    20274    2          CASE ( %KHA_FNC_BLDCTXCMP );
      372    20275        /*
      373    20276                                             This event can only be reported
      374    20277                                             for a line with existing context
      375    20278                                             and only for the channel level.
      376    20279        */
      377    20280    2             IF ( ADMIN_FPT.TERMID.LEV ~= %TERMINAL_ID_LEV_CHAN# ) OR
      378    20281    2                ( CTX$ = ADDR(NIL) )
      379    20282    2                THEN
      380    20283    2                   ADMIN_FPT.RESULTS = SUBSUB;
      381    20284        /*
      382    20285                                             Report START to KXF.
      383    20286        */
      384    20287    2             CALL_FPT = '0'B;
      385    20288    2             CALL_FPT.EVN = %KX_F_EV_START#;
      386    20289    2             CALL_FPT.RCV$ = CTX$;
      387    20290    2             CALL KXF$FRAME ( CALL_FPT );
      388    20291        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:19   
      389    20292        /*
      390    20293                                             Initialize a controller.
      391    20294        */
      392    20295    2          CASE ( %KHA_FNC_INTCTR );
      393    20296        /*
      394    20297                                             Call KXN to load the CCP into
      395    20298                                             the MLCP.
      396    20299        */
      397    20300    2             CALL KXN$CMND ( %KX_N_INIT_CTR#, ADMIN_FPT.CHN$->KH$CHN );
      398    20301        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:20   
      399    20302        /*
      400    20303                                             Sign-on reject.
      401    20304        */
      402    20305    2          CASE ( %KHA_FNC_SGNRJC );
      403    20306        /*
      404    20307                                             SGNRJC for a link means that the
      405    20308                                             user either specified a bad logon
      406    20309                                             or it is already logged on.  For
      407    20310                                             a VC, it makes no sense since all
      408    20311                                             of that is under system control.
      409    20312                                             So, for VCs, screech.  For links,
      410    20313                                             tell KHA to do a KILL.
      411    20314        */
      412    20315    3             DO SELECT ( ADMIN_FPT.TERMID.LEV );
      413    20316    3                SELECT ( %TERMINAL_ID_LEV_CHAN# );
      414    20317                     %WRSYSLOG ( ERRCOD = SGNRJC,
      415    20318                     TRMID = ADMIN_FPT.TERMID );
      416    20336    3                CALL KHA$DVCADM ( %KHA_FNC_KILL,
      417    20337    3                   ERROR,
      418    20338    3                   ADMIN_FPT.TERMID,
      419    20339    3                   ADMIN_FPT.TERMID, ,1 );
      420    20340
      421    20341    3                SELECT ( %TERMINAL_ID_LEV_SUBCHAN# );
      422    20342        /*S* SCREECH_CODE: KXA-S$KX_VC_SGNRJC#
      423    20343             MESSAGE: Sign-on reject meaningless for virtual circuits.
      424    20344        */
      425    20345    3                CALL KHD$SCREECH ( Y_VC_SGNRJC );
      426    20346
      427    20347    3                SELECT ( ELSE );
      428    20348    3             ADMIN_FPT.RESULTS = SUBSUB;
      429    20349                  %ENABLE;
      430    20352    3             ALTRETURN;
      431    20353    3             END;  /*  SELECT on LEV  */
      432    20354        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:21   
      433    20355        /*
      434    20356           On HOSTUP just report LINE_ACTIVE if L2 state is NORMAL (=4).
      435    20357        */
      436    20358    2          CASE ( %KHA_FNC_HOSTUP );
      437    20359
      438    20360    2             IF ADMIN_FPT.CHN$->KH$CHN.CTX$ ~= ADDR(NIL)
      439    20361    2                AND %L2.STATE.CURRENT = 4  /* normal state */
      440    20362    2                THEN
      441    20363    3                   DO;
      442    20364    3                      CALL KHA$LINE_ACTIVE ( ADMIN_FPT.TERMID );
      443    20365    3                      IF NOT %L2.FLG.RESTART AND NOT %L2.FLG.RESTART_PEND
      444    20366    3                         THEN
      445    20367    4                            DO;
      446    20368    4                               BUF$ = %L2.DVC_HEAD$;
      447    20369    5                               DO WHILE ( BUF$ ~= ADDR(NIL) );
      448    20370    5                                  IF KX$LINKDEV.VDI$ = ADDR(NIL)
      449    20371    5                                     THEN
      450    20372    5                                        CALL KXX$INTCNC ( KX$LINKDEV) WHENALTRETURN
      451    20373    6                                              DO;
      452    20374    6                                              END;
      453    20375    5                                     ELSE
      454    20376    5                                        KX$LINKDEV.RECNC = '1'B;
      455    20377    5                                  BUF$ = KX$LINKDEV.FLNK$;
      456    20378    5                               END;
      457    20379    4                            END;
      458    20380    3                   END;
      459    20381        /*
      460    20382                                             All other cases.
      461    20383        */
      462    20384    2          CASE ( ELSE );
      463    20385        /*
      464    20386                                             Tell KHA that the request was
      465    20387                                             not handled.
      466    20388        */
      467    20389    2             ADMIN_FPT.RESULTS = UNKFCN;
      468    20390                  %ENABLE;
      469    20393    2             ALTRETURN;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:22   
      470    20394        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:23   
      471    20395    2       END;  /*  Case on FNC  */
      472    20396
      473    20397            %ENABLE;
      474    20400
      475    20401    1       RETURN;
      476    20402
      477    20403    1   END KXA$ADMIN;

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:24   
--  Include file information  --

   KH$STT.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KXX_MACROS_M.:E05TOU  is referenced.
   KX_MACROS_M.:E05TOU  is referenced.
   KX_DATA_C.:E05TOU  is referenced.
   KX_SCODE_C.:E05TOU  is referenced.
   KX_PERR_C.:E05TOU  is referenced.
   KX_EQUS_E.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KXA$ADMIN.

   Procedure KXA$ADMIN requires 758 words for executable code.
   Procedure KXA$ADMIN requires 44 words of local(AUTO) storage.
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:25   

    No errors detected in file KXA$ADMIN.:E05TSI    .

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:26   

 Object Unit name= KXA$ADMIN                                  File name= KXA$ADMIN.:E05TOU
 UTS= JUL 30 '97 02:17:41.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS     21     15  KXA$ADMIN
    1   Proc  even  none   758    2F6  KXA$ADMIN
    2  RoData even  none    14      E  KXA$ADMIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  KXA$ADMIN
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:27   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KHI$DISABLE
         yes           Std       0 KHI$ENABLE
 yes     yes           Std       1 KXF$FRAME
         yes           Std       7 KXS$SYSLOG
         yes           Std       1 KHA$LINE_ACTIVE
 yes     yes           Std       2 KHA$SNDSTT
 yes     yes           Std       6 KHA$DVCADM
 yes     yes           Std       1 KHC$XEQ2
         yes           Std       3 KXN$CMND
         yes           Std       1 KHD$SCREECH
 yes     yes           Std       2 KXX$INTCNC
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_AALT
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KH_CTLTBL                             KX_STATS_HDLC                         KX_STATS_X25
     KX_PM$                                KX_STATS_X29                          G$JIT$
     KV_STT                           r    G$ROS$
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:28   


        1        1        /*M* KXA$ADMIN  -  X.25 Handler Administrative Routine                          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* PLM=4,IND=3,CTI=3,DCI=6,IAD=0,DTI=6,AND=Y,CSI=3,THI=3,STI=3,DMC=Y */
        9        9        /*P* NAME: KXA$ADMIN                                                          */
       10       10        /*P* PURPOSE: This subroutine takes care of the administrative                */
       11       11        /*P* chores for the X.25 handler.                                             */
       12       12
       13       13        KXA$ADMIN: PROC ( ADMIN_FPT ) ALTRET;

     13   1 000000  D380 0000 0000  xent KXA$ADMIN       LNJ,B5   X6A_AUTO_1
          1 000003       002C 0001                       DC       44,1

       14       14
       15       15        /*F* NAME: KXA$ADMIN                                                          */
       16       16        /*F* PURPOSE: This subroutine takes care of the administrative                */
       17       17        /*F* chores for the X.25 handler.                                             */
       18       18
       19       19        /*D* NAME: KXA$ADMIN                                                          */
       20       20        /*D* PURPOSE: This subroutine takes care of the administrative                */
       21       21        /*D* chores for the X.25 handler.                                             */
       22       22        /*D* CALL: CALL KXA$ADMIN ( KH$ADMIN_FPT ) ALTRET ( label );  */
       23       23        /*D* INPUT: ADMIN_FPT - the function to perform  */
       24       24        /*D* OUTPUT: ADMIN_FPT.RESULTS - error code on altreturns  */
       25       25        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:29   
       26       26        /*****************************************************************
       27       27        *                                                                *
       28       28        *                           Include files                        *
       29       29        *                                                                *
       30       30        *****************************************************************/
       31       31
       32       32        %INCLUDE LCP_6;
       33     4311        %INCLUDE CP_6_SUBS;
       34     4851        %INCLUDE G_JIT_M;
       35     5116        %INCLUDE KH$CHN;
       36     5238        %INCLUDE KHA_FNC_E;
       37     5338        %INCLUDE KH_MACRO_C;
       38     6081        %INCLUDE KL_CONTROL_C;
       39     6461        %INCLUDE KX_EQUS_E;
       40     6900        %INCLUDE KX_PERR_C;
       41     7029        %INCLUDE KX_SCODE_C;
       42     7095        %INCLUDE KX_DATA_C;
       43     7163        %INCLUDE KX_MACROS_M;
       44     7934        %INCLUDE KXX_MACROS_M;
       45     8276        %INCLUDE KV_GLBCNS_E;
       46     8617        %INCLUDE KV$GLB;
       47     9036        %KV#CQ_HNDID_E;
       48     9041        %INCLUDE K_ID_E;
       49     9091        %K#ENTID_E;
       50     9110        %K#LYRID_E;
       51     9117        %INCLUDE KL_MACRO_C;
       52    12469        %KL_REQSTATS;
       53    12763        %INCLUDE KL_AFCN_C;
       54    12864        %INCLUDE KL_SUPER_C;
       55    15766        %INCLUDE KNH_MACRO_C;
       56    16049        %INCLUDE K_ADDRESS_M;
       57    16552        %INCLUDE KH$STT;
       58    16582        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:30   
       59    16583        /*****************************************************************
       60    16584        *                                                                *
       61    16585        *                           Refs                                 *
       62    16586        *                                                                *
       63    16587        *****************************************************************/
       64    16588
       65    16589    1   DCL KHA$DVCADM ENTRY (6) ALTRET;
       66    16590    1   DCL KHI$DISABLE ENTRY (1);
       67    16591    1   DCL KHI$ENABLE ENTRY;
       68    16592    1   DCL KXF$FRAME ENTRY (1) ALTRET;
       69    16593    1   DCL KXN$CMND ENTRY (3);
       70    16594    1   DCL KXS$Q_SYSLOG ENTRY (1);
       71    16595    1   DCL KXS$SYSLOG ENTRY (7);
       72    16596    1   DCL KXX$X29 ENTRY (1);
       73    16597    1   DCL KHA$SNDSTT ENTRY(2) ALTRET;
       74    16598    1   DCL KHD$SCREECH ENTRY (1);
       75    16599    1   DCL KHA$ERRLOG ENTRY (2) ALTRET;
       76    16600    1   DCL KHC$XEQ2 ENTRY (1) ALTRET;
       77    16601    1   DCL KHA$LINE_ACTIVE ENTRY (1);
       78    16602    1   DCL KXX$INTCNC ENTRY (2) ALTRET;
       79    16603        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:31   
       80    16604        /*****************************************************************
       81    16605        *                                                                *
       82    16606        *                           Auto                                 *
       83    16607        *                                                                *
       84    16608        *****************************************************************/
       85    16609
       86    16610        %KH$ADMIN_FPT ( FPTN = ADMIN_FPT, STCLASS = );
       87    16821        %FPT_X25 ( FPTN = CALL_FPT, STCLASS = );
       88    16865
       89    16866    1   DCL CTX$ PTR;
       90    16867    1   DCL BUF$ PTR;
       91    16868    1   DCL LEVEL UBIN;
       92    16869    1   DCL ERROR UBIN(32);
       93    16870    1   DCL Y@CRTEXCTIM UBIN(32);
       94    16871        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:32   
       95    16872        /*****************************************************************
       96    16873        *                                                                *
       97    16874        *                           Based                                *
       98    16875        *                                                                *
       99    16876        *****************************************************************/
      100    16877
      101    16878    1   DCL BASED_WORD UBIN BASED;
      102    16879        %KH$CHN ( STCLASS = BASED );
      103    17003        %KX$L2 ( STCLASS=BASED );
      104    17370        %EQU L2 = CHARTEXT ('ADMIN_FPT.CHN$->KH$CHN.CTX$->KX$L2');
      105    17371        %KX$LINKDEV ( STCLASS = "BASED(BUF$)" );
      106    17398        %G$JIT ( STCLASS = "BASED(G$JIT$)" );
      107    17812        %KL_BLKHDR ( NAME = BLKHDR, STCLASS = "BASED(ADMIN_FPT.CTX$)" );
      108    17907        %EJECT
      109    17908        /*****************************************************************
      110    17909        *                                                                *
      111    17910        *                           Constant                             *
      112    17911        *                                                                *
      113    17912        *****************************************************************/
      114    17913
      115    17914        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      116    17915                           FPTN = SGNRJC,
      117    17916                           ERR# = %E_KXA_SGNRJC# );
      118    17962        /*E*   ERROR:      KXA-E_KXA_SGNRJC#-0
      119    17963               MESSAGE:    autologon failed, line KILLed.
      120    17964        */
      121    17965        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      122    17966                           FPTN = SUBSUB,
      123    17967                           ERR# = %E_KXA_SUBSUB# );
      124    18013        /*E*   ERROR:      KXA-E_KXA_SUBSUB#-0
      125    18014               MESSAGE:    Admin fcn for subsubchan not accepted.
      126    18015        */
      127    18016        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      128    18017                           FPTN = AUTLOG,
      129    18018                           ERR# = %E_KXA_AUTLOG# );
      130    18064        /*E*   ERROR:      KXA-E_KXA_AUTLOG#-0
      131    18065               MESSAGE:    All HDLC lines have to be autologged.
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:33   
      132    18066        */
      133    18067        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      134    18068                           FPTN = ENBFAL,
      135    18069                           ERR# = %E_KXA_ENBFAL# );
      136    18115        /*E*   ERROR:      KXA-E_KXA_ENBFAL#-0
      137    18116               MESSAGE:    Problem encountered in enabling line.
      138    18117        */
      139    18118        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      140    18119                           FPTN = KILFAL,
      141    18120                           ERR# = %E_KXA_KILFAL# );
      142    18166        /*E*   ERROR:      KXA-E_KXA_KILFAL#-0
      143    18167               MESSAGE:    Problem encountered in killing line.
      144    18168        */
      145    18169        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      146    18170                           FPTN = BLDFAL,
      147    18171                           ERR# = %E_KXA_BLDFAL# );
      148    18217        /*E*   ERROR:      KXA-E_KXA_BLDFAL#-0
      149    18218               MESSAGE:    Problem encountered in getting context.
      150    18219        */
      151    18220        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      152    18221                           FPTN = DSCFAL,
      153    18222                           ERR# = %E_KXA_DSCFAL# );
      154    18268        /*E*   ERROR:      KXA-E_KXA_DSCFAL#-0
      155    18269               MESSAGE:    Problem encountered in disconnecting line.
      156    18270        */
      157    18271        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      158    18272                           FPTN = UNKFCN,
      159    18273                           ERR# = %E_KXA_UNKFCN# );
      160    18319        /*E*   ERROR:      KXA-E_KXA_UNKFCN#-0
      161    18320               MESSAGE:    Unknown admin function.
      162    18321        */
      163    18322        %VLP_ERRCODE (STCLASS=CONSTANT,FCG='KX',MID='A',SEV=%G_WRSYSLOG_SEV_INFO#,
      164    18323                           FPTN = DSBFAL,
      165    18324                           ERR# = %E_KXA_DSBFAL# );
      166    18370        /*E*   ERROR:      KXA-E_KXA_DSBFAL#-0
      167    18371               MESSAGE:    Problem encountered in disabling line.
      168    18372        */
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:34   
      169    18373        %VLP_SCODE (FPTN=Y_VC_SGNRJC,STCLASS=CONSTANT,FCG=KX,MID=A,ERR#=%S$KX_VC_SGNRJC#);
      170    18434        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:35   
      171    18435        /*****************************************************************
      172    18436        *                                                                *
      173    18437        *                           Static                               *
      174    18438        *                                                                *
      175    18439        *****************************************************************/
      176    18440
      177    18441        %KH$CTLTBL ( FPTN = KH_CTLTBL, STCLASS = SYMREF );
      178    18653        %KX_DATA;
      179    19343        %KX_STATS_X29;
      180    19684    1   DCL G$JIT$ PTR SYMREF;
      181    19685        %KV$STT ( NAME = KV_STT, STCLASS = SYMREF );
      182    20079        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:36   
      183    20080        /*****************************************************************
      184    20081        *                                                                *
      185    20082        *                           Procedure                            *
      186    20083        *                                                                *
      187    20084        *****************************************************************/
      188    20085
      189    20086            %DISABLE;

  20087   1 000005  EC80 0000 0002  xsym                 LDB,B6   KH_CTLTBL+2
          1 000008  E806                                 LDR,R6   ,B6
          1 000009  EF47 001A                            STR,R6   LEVEL,AUTO

  20087   1 00000B  DBC7 001A                            LAB,B5   LEVEL,AUTO
          1 00000D  DFC7 0020                            STB,B5   Y@CRTEXCTIM+3,AUTO
          1 00000F  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000011  CBF0 0100                            LAB,B4   256,IMO
          1 000013  E380 0000 0000  xent                 LNJ,B6   KHI$DISABLE
          1 000016       0001                            DC       s:20094,PREL

      190    20089        /*
      191    20090                                             All that we really need for this
      192    20091                                             module is the function and line
      193    20092                                             context block pointer.
      194    20093        */
      195    20094    1       IF ADMIN_FPT.FNC ~= %KHA_FNC_REQSTATS AND ADMIN_FPT.FNC ~= %KHA_FNC_CNTRLCHG

  20094   1 000017  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 000019  E806                                 LDR,R6   ,B6
          1 00001A  6D04                                 CMV,R6   4
          1 00001B  0901 000A                            BE       s:20097,PREL
          1 00001D  6D1E                                 CMV,R6   30
          1 00001E  0901 0007                            BE       s:20097,PREL

      196    20095    1          THEN
      197    20096    1             CTX$ = ADMIN_FPT.LIN$ -> KH$CHN.CTX$;

  20096   1 000020  DCC6 000D                            LDB,B5   13,B6
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:37   
          1 000022  CCC5 000C                            LDB,B4   12,B5
          1 000024  CFC7 0016                            STB,B4   CTX$,AUTO

      198    20097    2       DO CASE ( ADMIN_FPT.FNC );

  20097   1 000026  B856                                 LDR,R3   R6
          1 000027  3D1F                                 CMV,R3   31
          1 000028  0281 02A6                            BGE      s:20389,PREL
          1 00002A  A830 0000 0030  01                   LDR,R2   s:20097+10,R3
          1 00002D  83A0 0000 004F  01                   JMP      s:20116,R2
          1 000030       0296                            DC       s:20398,PREL
          1 000031       0000                            DC       s:20116,PREL
          1 000032       004B                            DC       s:20152,PREL
          1 000033       0074                            DC       s:20172,PREL
          1 000034       009D                            DC       s:20190,PREL
          1 000035       0280                            DC       s:20389,PREL
          1 000036       0280                            DC       s:20389,PREL
          1 000037       0280                            DC       s:20389,PREL
          1 000038       0280                            DC       s:20389,PREL
          1 000039       0280                            DC       s:20389,PREL
          1 00003A       011D                            DC       s:20228,PREL
          1 00003B       0189                            DC       s:20280,PREL
          1 00003C       0280                            DC       s:20389,PREL
          1 00003D       0160                            DC       s:20259,PREL
          1 00003E       0280                            DC       s:20389,PREL
          1 00003F       01B4                            DC       s:20300,PREL
          1 000040       0280                            DC       s:20389,PREL
          1 000041       0296                            DC       s:20398,PREL
          1 000042       0280                            DC       s:20389,PREL
          1 000043       0280                            DC       s:20389,PREL
          1 000044       0280                            DC       s:20389,PREL
          1 000045       01C6                            DC       s:20315,PREL
          1 000046       0280                            DC       s:20389,PREL
          1 000047       0280                            DC       s:20389,PREL
          1 000048       0280                            DC       s:20389,PREL
          1 000049       0280                            DC       s:20389,PREL
          1 00004A       0231                            DC       s:20360,PREL
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:38   
          1 00004B       0280                            DC       s:20389,PREL
          1 00004C       0280                            DC       s:20389,PREL
          1 00004D       0280                            DC       s:20389,PREL
          1 00004E       0296                            DC       s:20398,PREL

      199    20098        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:39   
      200    20099        /*
      201    20100                                             No operation.
      202    20101                                             Configure a line.
      203    20102        */
      204    20103    2          CASE ( %KHA_FNC_NON, %KHA_FNC_CNFG, %KHA_FNC_CNTRLCHG );

      205    20104        /*
      206    20105                                             Do nothing.
      207    20106        */
      208    20107        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:40   
      209    20108        /*
      210    20109                                             Enable a line.
      211    20110        */
      212    20111    2          CASE ( %KHA_FNC_ENABLE );

      213    20112        /*
      214    20113                                             All X25 lines have to be auto-
      215    20114                                             logged in the host.
      216    20115        */
      217    20116    2             IF NOT ADMIN_FPT.CHN$ -> KH$CHN.AUTLGN AND ADMIN_FPT.TERMID.LEV =

  20116   1 00004F  DCC6 000B                            LDB,B5   11,B6
          1 000051  8285                                 LB,'0004'X        ,B5
          1 000052       0004
          1 000053  0501 001E                            BBT      s:20132,PREL
          1 000055  D846 0001                            LDR,R5   1,B6
          1 000057  D570 00FF                            AND,R5   255,IMO
          1 000059  5D01                                 CMV,R5   1
          1 00005A  0981 0017                            BNE      s:20132,PREL

      218    20117    2                %TERMINAL_ID_LEV_CHAN#
      219    20118    2                THEN
      220    20119    3                   DO;

      221    20120    3   RESULT_SUBSUB:     ADMIN_FPT.RESULTS = SUBSUB;

  20120   1 00005C  8C80 0000 0002  00   RESULT_SUBSUB   LDI      SUBSUB
          1 00005F  8D46 000F                            SDI      15,B6

      222    20121    3   ENABLE_ALTRET:
      223    20122                           %ENABLE;

  20123   1 000061  EC80 0000 0002  xsym ENABLE_ALTRET   LDB,B6   KH_CTLTBL+2
          1 000064  E847 001A                            LDR,R6   LEVEL,AUTO
          1 000066  E906                                 CMR,R6   ,B6
          1 000067  0901 0007                            BE       s:20125,PREL

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:41   
  20123   1 000069  CBF0 0000                            LAB,B4   0,IMO
          1 00006B  E380 0000 0000  xent                 LNJ,B6   KHI$ENABLE
          1 00006E       0001                            DC       s:20125,PREL

      224    20125    3                      ALTRETURN;

  20125   1 00006F  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      225    20126    3                   END;
      226    20127        /*
      227    20128                                             Call KXF with the request.  If it
      228    20129                                             is for the packet level, KXF will
      229    20130                                             forward it.
      230    20131        */
      231    20132    2             CALL_FPT = '0'B;

  20132   1 000072  5C20                                 LDV,R5   32
          1 000073  0021                                 ALR      ;
          1 000074       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 000076       4007 0006                                ALPHANUM(CALL_FPT,AUTO,,R5,FILL)

      232    20133    2             CALL_FPT.EVN = %KX_F_EV_ENB#;

  20133   1 000078  4C0B                                 LDV,R4   11
          1 000079  437F                                 CSYNC    s:20133,SPREL
          1 00007A  CF47 0006                            STR,R4   CALL_FPT,AUTO

      233    20134    2             CALL_FPT.RCV$ = CTX$;

  20134   1 00007C  DCC7 0016                            LDB,B5   CTX$,AUTO
          1 00007E  DFC7 0009                            STB,B5   CALL_FPT+3,AUTO

      234    20135    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );

  20135   1 000080  EFC7 000D                            STB,B6   CALL_FPT+7,AUTO

      235    20136    2             CALL KXF$FRAME ( CALL_FPT )
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:42   

  20136   1 000082  CBC7 0006                            LAB,B4   CALL_FPT,AUTO
          1 000084  CFC7 0020                            STB,B4   Y@CRTEXCTIM+3,AUTO
          1 000086  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000088  CBF0 0100                            LAB,B4   256,IMO
          1 00008A  E380 0000 0000  xent                 LNJ,B6   KXF$FRAME
          1 00008D       0003                            DC       s:20139,PREL
          1 00008E  0F81 0009                            B        s:20140+1,PREL

      236    20137    2                WHENALTRETURN
      237    20138    3                   DO;

      238    20139    3                      ADMIN_FPT.RESULTS = ENBFAL;

  20139   1 000090  8C80 0000 0006  00                   LDI      ENBFAL
          1 000093  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 000095  8D46 000F                            SDI      15,B6

      239    20140    3                      GOTO ENABLE_ALTRET;

  20140   1 000097  0FCA                                 B        s:20123,SPREL
          1 000098  0F81 024C                            B        s:20398,PREL

      240    20141    3                   END;
      241    20142        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:43   
      242    20143        /*
      243    20144                                             Disable a line.
      244    20145        */
      245    20146    2          CASE ( %KHA_FNC_DISABLE );

      246    20147        /*
      247    20148                                             Call KXF with the request.  If it
      248    20149                                             is for the packet level, KXF will
      249    20150                                             forward it.
      250    20151        */
      251    20152    2             CALL_FPT = '0'B;

  20152   1 00009A  5C20                                 LDV,R5   32
          1 00009B  0021                                 ALR      ;
          1 00009C       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 00009E       4007 0006                                ALPHANUM(CALL_FPT,AUTO,,R5,FILL)

      252    20153    2             CALL_FPT.EVN = %KX_F_EV_DSB#;

  20153   1 0000A0  4C0C                                 LDV,R4   12
          1 0000A1  437F                                 CSYNC    s:20153,SPREL
          1 0000A2  CF47 0006                            STR,R4   CALL_FPT,AUTO

      253    20154    2             CALL_FPT.RCV$ = CTX$;

  20154   1 0000A4  DCC7 0016                            LDB,B5   CTX$,AUTO
          1 0000A6  DFC7 0009                            STB,B5   CALL_FPT+3,AUTO

      254    20155    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );

  20155   1 0000A8  EFC7 000D                            STB,B6   CALL_FPT+7,AUTO

      255    20156    2             CALL KXF$FRAME ( CALL_FPT )

  20156   1 0000AA  CBC7 0006                            LAB,B4   CALL_FPT,AUTO
          1 0000AC  CFC7 0020                            STB,B4   Y@CRTEXCTIM+3,AUTO
          1 0000AE  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:44   
          1 0000B0  CBF0 0100                            LAB,B4   256,IMO
          1 0000B2  E380 0000 0000  xent                 LNJ,B6   KXF$FRAME
          1 0000B5       0003                            DC       s:20159,PREL
          1 0000B6  0F81 000A                            B        s:20160+2,PREL

      256    20157    2                WHENALTRETURN
      257    20158    3                   DO;

      258    20159    3                      ADMIN_FPT.RESULTS = DSBFAL;

  20159   1 0000B8  8C80 0000 0010  00                   LDI      DSBFAL
          1 0000BB  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 0000BD  8D46 000F                            SDI      15,B6

      259    20160    3                      GOTO ENABLE_ALTRET;

  20160   1 0000BF  0F81 FFA1                            B        s:20123,PREL
          1 0000C1  0F81 0223                            B        s:20398,PREL

      260    20161    3                   END;
      261    20162        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:45   
      262    20163        /*
      263    20164                                             Kill a line.
      264    20165        */
      265    20166    2          CASE ( %KHA_FNC_KILL );

      266    20167        /*
      267    20168                                             Call KXF with the request.  If it
      268    20169                                             is for the packet level, KXF will
      269    20170                                             forward it.
      270    20171        */
      271    20172    2             CALL_FPT = '0'B;

  20172   1 0000C3  5C20                                 LDV,R5   32
          1 0000C4  0021                                 ALR      ;
          1 0000C5       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 0000C7       4007 0006                                ALPHANUM(CALL_FPT,AUTO,,R5,FILL)

      272    20173    2             CALL_FPT.EVN = %KX_F_EV_KLL#;

  20173   1 0000C9  4C0D                                 LDV,R4   13
          1 0000CA  437F                                 CSYNC    s:20173,SPREL
          1 0000CB  CF47 0006                            STR,R4   CALL_FPT,AUTO

      273    20174    2             CALL_FPT.RCV$ = CTX$;

  20174   1 0000CD  DCC7 0016                            LDB,B5   CTX$,AUTO
          1 0000CF  DFC7 0009                            STB,B5   CALL_FPT+3,AUTO

      274    20175    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );

  20175   1 0000D1  EFC7 000D                            STB,B6   CALL_FPT+7,AUTO

      275    20176    2             CALL KXF$FRAME ( CALL_FPT )

  20176   1 0000D3  CBC7 0006                            LAB,B4   CALL_FPT,AUTO
          1 0000D5  CFC7 0020                            STB,B4   Y@CRTEXCTIM+3,AUTO
          1 0000D7  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:46   
          1 0000D9  CBF0 0100                            LAB,B4   256,IMO
          1 0000DB  E380 0000 0000  xent                 LNJ,B6   KXF$FRAME
          1 0000DE       0003                            DC       s:20179,PREL
          1 0000DF  0F81 000A                            B        s:20180+2,PREL

      276    20177    2                WHENALTRETURN
      277    20178    3                   DO;

      278    20179    3                      ADMIN_FPT.RESULTS = KILFAL;

  20179   1 0000E1  8C80 0000 0008  00                   LDI      KILFAL
          1 0000E4  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 0000E6  8D46 000F                            SDI      15,B6

      279    20180    3                      GOTO ENABLE_ALTRET;

  20180   1 0000E8  0F81 FF78                            B        s:20123,PREL
          1 0000EA  0F81 01FA                            B        s:20398,PREL

      280    20181    3                   END;
      281    20182        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:47   
      282    20183        /*
      283    20184                                             Request statistics.
      284    20185        */
      285    20186    2          CASE ( %KHA_FNC_REQSTATS );

      286    20187        /*
      287    20188            Request for sending statistics buffers to the host.
      288    20189        */
      289    20190    2             IF ADMIN_FPT.CTX$->KL_REQSTATS.SLCENT(%KH#ENTID_HDLC)

  20190   1 0000EC  DCC6 0009                            LDB,B5   9,B6
          1 0000EE  82C5 0012                            LB,'0800'X        18,B5
          1 0000F0       0800
          1 0000F1  0581 01F3                            BBF      s:20398,PREL

      290    20191    3                THEN DO;

      291    20192    4                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_HDLC) THEN DO;

  20192   1 0000F3  82C5 0010                            LB,'0800'X        16,B5
  20192   1 0000F5       0800
          1 0000F6  0581 0010                            BBF      s:20198,PREL

      292    20193        /*
      293    20194            HDLC stats requested.
      294    20195        */
      295    20196    4                               CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS, VECTOR(
             20196                                        KX_STATS_HDLC));

  20196   1 0000F8  CB80 0000 0000  02                   LAB,B4   0
          1 0000FB  CFC7 0022                            STB,B4   Y@CRTEXCTIM+5,AUTO
          1 0000FD  DFC7 0020                            STB,B5   Y@CRTEXCTIM+3,AUTO
          1 0000FF  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000101  CBF0 0200                            LAB,B4   512,IMO
          1 000103  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          1 000106       0001                            DC       s:20198,PREL

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:48   
      296    20197    4                            END;

      297    20198    4                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_X25) THEN DO;

  20198   1 000107  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 000109  DCC6 0009                            LDB,B5   9,B6
          1 00010B  82C5 0010                            LB,'0040'X        16,B5
          1 00010D       0040
          1 00010E  0581 0010                            BBF      s:20204,PREL

      298    20199        /*
      299    20200            X25 stats requested.
      300    20201        */
      301    20202    4                               CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS, VECTOR(
             20202                                        KX_STATS_X25));

  20202   1 000110  CB80 0000 0003  02                   LAB,B4   +3
          1 000113  CFC7 0022                            STB,B4   Y@CRTEXCTIM+5,AUTO
          1 000115  DFC7 0020                            STB,B5   Y@CRTEXCTIM+3,AUTO
          1 000117  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000119  CBF0 0200                            LAB,B4   512,IMO
          1 00011B  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          1 00011E       0001                            DC       s:20204,PREL

      302    20203    4                            END;

      303    20204    4                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_X29) THEN DO;

  20204   1 00011F  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 000121  DCC6 0009                            LDB,B5   9,B6
          1 000123  82C5 0010                            LB,'0002'X        16,B5
          1 000125       0002
          1 000126  0581 0010                            BBF      s:20210,PREL

      304    20205        /*
      305    20206            X.29 stats requested.
      306    20207        */
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:49   
      307    20208    4                               CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS, VECTOR(
             20208                                        KX_STATS_X29));

  20208   1 000128  CB80 0000 0006  02                   LAB,B4   +6
          1 00012B  CFC7 0022                            STB,B4   Y@CRTEXCTIM+5,AUTO
          1 00012D  DFC7 0020                            STB,B5   Y@CRTEXCTIM+3,AUTO
          1 00012F  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000131  CBF0 0200                            LAB,B4   512,IMO
          1 000133  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          1 000136       0001                            DC       s:20210,PREL

      308    20209    4                            END;

      309    20210    4                      IF ADMIN_FPT.CTX$->KL_REQSTATS.DSPENT(%KH#ENTID_VDH) THEN DO;

  20210   1 000137  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 000139  DCC6 0009                            LDB,B5   9,B6
          1 00013B  82C5 0010                            LB,'0020'X        16,B5
          1 00013D       0020
          1 00013E  0581 01A6                            BBF      s:20398,PREL

      310    20211        /*
      311    20212            VDH stats requested.
      312    20213        */
      313    20214    4                               CALL KHC$XEQ2 ( Y@CRTEXCTIM );

  20214   1 000140  CBC7 001D                            LAB,B4   Y@CRTEXCTIM,AUTO
          1 000142  CFC7 0020                            STB,B4   Y@CRTEXCTIM+3,AUTO
          1 000144  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000146  CBF0 0100                            LAB,B4   256,IMO
          1 000148  E380 0000 0000  xent                 LNJ,B6   KHC$XEQ2
          1 00014B       0001                            DC       s:20215,PREL

      314    20215    4                               KV_STT.SCHEXCTIM = Y@CRTEXCTIM - KX_STATS_HDLC.
             20215                                        IN_TCB_TICS - KX_STATS_HDLC.OUT_TCB_TICS;

  20215   1 00014C  8CC7 001D                            LDI      Y@CRTEXCTIM,AUTO
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:50   
          1 00014E  8480 0000 002A  xsym                 SID      KX_STATS_HDLC+42
          1 000151  8480 0000 002C  xsym                 SID      KX_STATS_HDLC+44
          1 000154  8D00 0000 003C  xsym                 SDI      KV_STT+60

      315    20216    4                               CALL KHA$SNDSTT(ADMIN_FPT.CTX$->KL_REQSTATS, VECTOR(
             20216                                        KV_STT));

  20216   1 000157  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 000159  DCC6 0009                            LDB,B5   9,B6
          1 00015B  CB80 0000 0009  02                   LAB,B4   +9
          1 00015E  CFC7 0022                            STB,B4   Y@CRTEXCTIM+5,AUTO
          1 000160  DFC7 0020                            STB,B5   Y@CRTEXCTIM+3,AUTO
          1 000162  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000164  CBF0 0200                            LAB,B4   512,IMO
          1 000166  E380 0000 0000  xent                 LNJ,B6   KHA$SNDSTT
          1 000169       0001                            DC       s:20218,PREL

      316    20217    4                            END;

      317    20218    3                   END;

  20218   1 00016A  0F81 017A                            B        s:20398,PREL

      318    20219        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:51   
      319    20220        /*
      320    20221                                             Build context.
      321    20222        */
      322    20223    2          CASE ( %KHA_FNC_BLDCTX );

      323    20224        /*
      324    20225                                             Make sure the command is for
      325    20226                                             correct BLKTYP.
      326    20227        */
      327    20228    2             IF ( BLKHDR.BLKTYP ~= %KLTY_LINK# ) AND

  20228   1 00016C  DCC6 0009                            LDB,B5   9,B6
          1 00016E  D2C5 0002                            LLH,R5   2,B5
          1 000170  5D04                                 CMV,R5   4
          1 000171  0901 001F                            BE       s:20244,PREL
          1 000173  5D08                                 CMV,R5   8
          1 000174  0901 001C                            BE       s:20244,PREL
          1 000176  5D0B                                 CMV,R5   11
          1 000177  0901 0019                            BE       s:20244,PREL

      328    20229    2                ( BLKHDR.BLKTYP ~= %KLTY_VIRCIR# ) AND
      329    20230    2                ( BLKHDR.BLKTYP ~= %KLTY_LINKDEV# )
      330    20231    2                THEN
      331    20232    3                   DO;

      332    20233    3   BLDFAL:            ADMIN_FPT.RESULTS = BLDFAL;

  20233   1 000179  8C80 0000 000A  00   BLDFAL          LDI      BLDFAL
          1 00017C  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 00017E  8D46 000F                            SDI      15,B6

      333    20234                           %ENABLE;

  20235   1 000180  DC80 0000 0002  xsym                 LDB,B5   KH_CTLTBL+2
          1 000183  D847 001A                            LDR,R5   LEVEL,AUTO
          1 000185  D905                                 CMR,R5   ,B5
          1 000186  0901 0007                            BE       s:20237,PREL
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:52   

  20235   1 000188  CBF0 0000                            LAB,B4   0,IMO
          1 00018A  E380 0000 0000  xent                 LNJ,B6   KHI$ENABLE
          1 00018D       0001                            DC       s:20237,PREL

      334    20237    3                      ALTRETURN;

  20237   1 00018E  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      335    20238    3                   END;
      336    20239        /*
      337    20240                                             Call KXF with the request.  If it
      338    20241                                             is for the packet level, KXF will
      339    20242                                             forward it.
      340    20243        */
      341    20244    2             CALL_FPT = '0'B;

  20244   1 000191  5C20                                 LDV,R5   32
          1 000192  0021                                 ALR      ;
          1 000193       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 000195       4007 0006                                ALPHANUM(CALL_FPT,AUTO,,R5,FILL)

      342    20245    2             CALL_FPT.EVN = %KX_F_EV_BLDCTX#;

  20245   1 000197  4C0E                                 LDV,R4   14
          1 000198  437F                                 CSYNC    s:20245,SPREL
          1 000199  CF47 0006                            STR,R4   CALL_FPT,AUTO

      343    20246    2             CALL_FPT.RCV$ = CTX$;

  20246   1 00019B  DCC7 0016                            LDB,B5   CTX$,AUTO
          1 00019D  DFC7 0009                            STB,B5   CALL_FPT+3,AUTO

      344    20247    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );

  20247   1 00019F  EFC7 000D                            STB,B6   CALL_FPT+7,AUTO

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:53   
      345    20248    2             CALL KXF$FRAME ( CALL_FPT ) ALTRET ( BLDFAL );

  20248   1 0001A1  CBC7 0006                            LAB,B4   CALL_FPT,AUTO
          1 0001A3  CFC7 0020                            STB,B4   Y@CRTEXCTIM+3,AUTO
          1 0001A5  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 0001A7  CBF0 0100                            LAB,B4   256,IMO
          1 0001A9  E380 0000 0000  xent                 LNJ,B6   KXF$FRAME
          1 0001AC       FFCD                            DC       s:20232,PREL
          1 0001AD  0F81 0137                            B        s:20398,PREL

      346    20249        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:54   
      347    20250        /*
      348    20251                                             Disconnect request for a line.
      349    20252        */
      350    20253    2          CASE ( %KHA_FNC_DISCONNECT_RQS );

      351    20254        /*
      352    20255                                             Call KXF with the request.  If it
      353    20256                                             is for the packet level, KXF will
      354    20257                                             forward it.
      355    20258        */
      356    20259    2             CALL_FPT = '0'B;

  20259   1 0001AF  5C20                                 LDV,R5   32
          1 0001B0  0021                                 ALR      ;
          1 0001B1       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 0001B3       4007 0006                                ALPHANUM(CALL_FPT,AUTO,,R5,FILL)

      357    20260    2             CALL_FPT.EVN = %KX_F_EV_DSC#;

  20260   1 0001B5  4C0F                                 LDV,R4   15
          1 0001B6  437F                                 CSYNC    s:20260,SPREL
          1 0001B7  CF47 0006                            STR,R4   CALL_FPT,AUTO

      358    20261    2             CALL_FPT.RCV$ = CTX$;

  20261   1 0001B9  DCC7 0016                            LDB,B5   CTX$,AUTO
          1 0001BB  DFC7 0009                            STB,B5   CALL_FPT+3,AUTO

      359    20262    2             CALL_FPT.PRM1$ = ADDR ( ADMIN_FPT );

  20262   1 0001BD  EFC7 000D                            STB,B6   CALL_FPT+7,AUTO

      360    20263    2             CALL KXF$FRAME ( CALL_FPT )

  20263   1 0001BF  CBC7 0006                            LAB,B4   CALL_FPT,AUTO
          1 0001C1  CFC7 0020                            STB,B4   Y@CRTEXCTIM+3,AUTO
          1 0001C3  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:55   
          1 0001C5  CBF0 0100                            LAB,B4   256,IMO
          1 0001C7  E380 0000 0000  xent                 LNJ,B6   KXF$FRAME
          1 0001CA       0003                            DC       s:20266,PREL
          1 0001CB  0F81 000A                            B        s:20267+2,PREL

      361    20264    2                WHENALTRETURN
      362    20265    3                   DO;

      363    20266    3                      ADMIN_FPT.RESULTS = DSCFAL;

  20266   1 0001CD  8C80 0000 000C  00                   LDI      DSCFAL
          1 0001D0  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 0001D2  8D46 000F                            SDI      15,B6

      364    20267    3                      GOTO ENABLE_ALTRET;

  20267   1 0001D4  0F81 FE8C                            B        s:20123,PREL
          1 0001D6  0F81 010E                            B        s:20398,PREL

      365    20268    3                   END;
      366    20269        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:56   
      367    20270        /*
      368    20271                                             Context building completed for
      369    20272                                             a line.
      370    20273        */
      371    20274    2          CASE ( %KHA_FNC_BLDCTXCMP );

      372    20275        /*
      373    20276                                             This event can only be reported
      374    20277                                             for a line with existing context
      375    20278                                             and only for the channel level.
      376    20279        */
      377    20280    2             IF ( ADMIN_FPT.TERMID.LEV ~= %TERMINAL_ID_LEV_CHAN# ) OR

  20280   1 0001D8  D846 0001                            LDR,R5   1,B6
          1 0001DA  D570 00FF                            AND,R5   255,IMO
          1 0001DC  5D01                                 CMV,R5   1
          1 0001DD  0981 0005                            BNE      s:20283,PREL
          1 0001DF  8DC7 0016                            CMN      CTX$,AUTO
          1 0001E1  0981 0006                            BNE      s:20287,PREL

      378    20281    2                ( CTX$ = ADDR(NIL) )
      379    20282    2                THEN
      380    20283    2                   ADMIN_FPT.RESULTS = SUBSUB;

  20283   1 0001E3  8C80 0000 0002  00                   LDI      SUBSUB
          1 0001E6  8D46 000F                            SDI      15,B6

      381    20284        /*
      382    20285                                             Report START to KXF.
      383    20286        */
      384    20287    2             CALL_FPT = '0'B;

  20287   1 0001E8  5C20                                 LDV,R5   32
          1 0001E9  0021                                 ALR      ;
          1 0001EA       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 0001EC       4007 0006                                ALPHANUM(CALL_FPT,AUTO,,R5,FILL)

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:57   
      385    20288    2             CALL_FPT.EVN = %KX_F_EV_START#;

  20288   1 0001EE  437F                                 CSYNC    s:20287+5,SPREL
          1 0001EF  8747 0006                            CL       CALL_FPT,AUTO

      386    20289    2             CALL_FPT.RCV$ = CTX$;

  20289   1 0001F1  DCC7 0016                            LDB,B5   CTX$,AUTO
          1 0001F3  DFC7 0009                            STB,B5   CALL_FPT+3,AUTO

      387    20290    2             CALL KXF$FRAME ( CALL_FPT );

  20290   1 0001F5  CBC7 0006                            LAB,B4   CALL_FPT,AUTO
          1 0001F7  CFC7 0020                            STB,B4   Y@CRTEXCTIM+3,AUTO
          1 0001F9  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 0001FB  CBF0 0100                            LAB,B4   256,IMO
          1 0001FD  E380 0000 0000  xent                 LNJ,B6   KXF$FRAME
          1 000200       0001                            DC       s:20290+12,PREL
          1 000201  0F81 00E3                            B        s:20398,PREL

      388    20291        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:58   
      389    20292        /*
      390    20293                                             Initialize a controller.
      391    20294        */
      392    20295    2          CASE ( %KHA_FNC_INTCTR );

      393    20296        /*
      394    20297                                             Call KXN to load the CCP into
      395    20298                                             the MLCP.
      396    20299        */
      397    20300    2             CALL KXN$CMND ( %KX_N_INIT_CTR#, ADMIN_FPT.CHN$->KH$CHN );

  20300   1 000203  DCC6 000B                            LDB,B5   11,B6
          1 000205  CBF0 0000                            LAB,B4   0,IMO
          1 000207  DFC7 0022                            STB,B5   Y@CRTEXCTIM+5,AUTO
          1 000209  CFC7 0020                            STB,B4   Y@CRTEXCTIM+3,AUTO
          1 00020B  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 00020D  CBF0 0200                            LAB,B4   512,IMO
          1 00020F  E380 0000 0000  xent                 LNJ,B6   KXN$CMND
          1 000212       0001                            DC       s:20300+16,PREL
          1 000213  0F81 00D1                            B        s:20398,PREL

      398    20301        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:59   
      399    20302        /*
      400    20303                                             Sign-on reject.
      401    20304        */
      402    20305    2          CASE ( %KHA_FNC_SGNRJC );

      403    20306        /*
      404    20307                                             SGNRJC for a link means that the
      405    20308                                             user either specified a bad logon
      406    20309                                             or it is already logged on.  For
      407    20310                                             a VC, it makes no sense since all
      408    20311                                             of that is under system control.
      409    20312                                             So, for VCs, screech.  For links,
      410    20313                                             tell KHA to do a KILL.
      411    20314        */
      412    20315    3             DO SELECT ( ADMIN_FPT.TERMID.LEV );

  20315   1 000215  D846 0001                            LDR,R5   1,B6
          1 000217  D570 00FF                            AND,R5   255,IMO
          1 000219  D970 0001                            CMR,R5   1,IMO
          1 00021B  0201 004E                            BL       s:20348,PREL
          1 00021D  0901 0006                            BE       s:20334,PREL
          1 00021F  5D02                                 CMV,R5   2
          1 000220  0981 0049                            BNE      s:20348,PREL
          1 000222  0F81 003C                            B        s:20345,PREL

      413    20316    3                SELECT ( %TERMINAL_ID_LEV_CHAN# );

      414    20317                     %WRSYSLOG ( ERRCOD = SGNRJC,
      415    20318                     TRMID = ADMIN_FPT.TERMID );

  20334   1 000224  DB80 0000 0000                       LAB,B5   0
          1 000227  DFC7 0024                            STB,B5   Y@CRTEXCTIM+7,AUTO
          1 000229  CBC6 0001                            LAB,B4   1,B6
          1 00022B  CFC7 0022                            STB,B4   Y@CRTEXCTIM+5,AUTO
          1 00022D  BB80 0000 0000  00                   LAB,B3   SGNRJC
          1 000230  BFC7 0020                            STB,B3   Y@CRTEXCTIM+3,AUTO
          1 000232  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:60   
          1 000234  CBF0 0300                            LAB,B4   768,IMO
          1 000236  E380 0000 0000  xent                 LNJ,B6   KXS$SYSLOG
          1 000239       0001                            DC       s:20336,PREL

      416    20336    3                CALL KHA$DVCADM ( %KHA_FNC_KILL,

  20336   1 00023A  EBF0 0003                            LAB,B6   3,IMO
          1 00023C  DBF0 0001                            LAB,B5   1,IMO
          1 00023E  DFC7 002A                            STB,B5   Y@CRTEXCTIM+13,AUTO
          1 000240  CB80 0000 0000                       LAB,B4   0
          1 000243  CFC7 0028                            STB,B4   Y@CRTEXCTIM+11,AUTO
          1 000245  BCC7 0004                            LDB,B3   @ADMIN_FPT,AUTO
          1 000247  ABC3 0001                            LAB,B2   1,B3
          1 000249  AFC7 0026                            STB,B2   Y@CRTEXCTIM+9,AUTO
          1 00024B  9BC3 0001                            LAB,B1   1,B3
          1 00024D  9FC7 0024                            STB,B1   Y@CRTEXCTIM+7,AUTO
          1 00024F  DBC7 001B                            LAB,B5   ERROR,AUTO
          1 000251  DFC7 0022                            STB,B5   Y@CRTEXCTIM+5,AUTO
          1 000253  EFC7 0020                            STB,B6   Y@CRTEXCTIM+3,AUTO
          1 000255  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000257  CBF0 0600                            LAB,B4   1536,IMO
          1 000259  E380 0000 0000  xent                 LNJ,B6   KHA$DVCADM
          1 00025C       0001                            DC       s:20336+35,PREL
          1 00025D  0F81 0087                            B        s:20398,PREL

      417    20337    3                   ERROR,
      418    20338    3                   ADMIN_FPT.TERMID,
      419    20339    3                   ADMIN_FPT.TERMID, ,1 );
      420    20340
      421    20341    3                SELECT ( %TERMINAL_ID_LEV_SUBCHAN# );

      422    20342        /*S* SCREECH_CODE: KXA-S$KX_VC_SGNRJC#
      423    20343             MESSAGE: Sign-on reject meaningless for virtual circuits.
      424    20344        */
      425    20345    3                CALL KHD$SCREECH ( Y_VC_SGNRJC );

  20345   1 00025F  BB80 0000 000C  02                   LAB,B3   +12
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:61   
          1 000262  CBF0 0100                            LAB,B4   256,IMO
          1 000264  E380 0000 0000  xent                 LNJ,B6   KHD$SCREECH
          1 000267       0001                            DC       s:20345+9,PREL
          1 000268  0F81 007C                            B        s:20398,PREL

      426    20346
      427    20347    3                SELECT ( ELSE );

      428    20348    3             ADMIN_FPT.RESULTS = SUBSUB;

  20348   1 00026A  8C80 0000 0002  00                   LDI      SUBSUB
          1 00026D  8D46 000F                            SDI      15,B6

      429    20349                  %ENABLE;

  20350   1 00026F  DC80 0000 0002  xsym                 LDB,B5   KH_CTLTBL+2
          1 000272  C847 001A                            LDR,R4   LEVEL,AUTO
          1 000274  C905                                 CMR,R4   ,B5
          1 000275  0901 0007                            BE       s:20352,PREL

  20350   1 000277  CBF0 0000                            LAB,B4   0,IMO
          1 000279  E380 0000 0000  xent                 LNJ,B6   KHI$ENABLE
          1 00027C       0001                            DC       s:20352,PREL

      430    20352    3             ALTRETURN;

  20352   1 00027D  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      431    20353    3             END;  /*  SELECT on LEV  */

      432    20354        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:62   
      433    20355        /*
      434    20356           On HOSTUP just report LINE_ACTIVE if L2 state is NORMAL (=4).
      435    20357        */
      436    20358    2          CASE ( %KHA_FNC_HOSTUP );

      437    20359
      438    20360    2             IF ADMIN_FPT.CHN$->KH$CHN.CTX$ ~= ADDR(NIL)

  20360   1 000280  DCC6 000B                            LDB,B5   11,B6
          1 000282  8DC5 000C                            CMN      12,B5
          1 000284  0901 0060                            BE       s:20398,PREL
          1 000286  CCC5 000C                            LDB,B4   12,B5
          1 000288  D2C4 001D                            LLH,R5   29,B4
          1 00028A  5D04                                 CMV,R5   4
          1 00028B  0981 0059                            BNE      s:20398,PREL

      439    20361    2                AND %L2.STATE.CURRENT = 4  /* normal state */
      440    20362    2                THEN
      441    20363    3                   DO;

      442    20364    3                      CALL KHA$LINE_ACTIVE ( ADMIN_FPT.TERMID );

  20364   1 00028D  BBC6 0001                            LAB,B3   1,B6
          1 00028F  BFC7 0020                            STB,B3   Y@CRTEXCTIM+3,AUTO
          1 000291  BBC7 0020                            LAB,B3   Y@CRTEXCTIM+3,AUTO
          1 000293  CBF0 0100                            LAB,B4   256,IMO
          1 000295  E380 0000 0000  xent                 LNJ,B6   KHA$LINE_ACTIVE
          1 000298       0001                            DC       s:20365,PREL

      443    20365    3                      IF NOT %L2.FLG.RESTART AND NOT %L2.FLG.RESTART_PEND

  20365   1 000299  ECC7 0004                            LDB,B6   @ADMIN_FPT,AUTO
          1 00029B  DCC6 000B                            LDB,B5   11,B6
          1 00029D  CCC5 000C                            LDB,B4   12,B5
          1 00029F  82C4 002E                            LB,'0008'X        46,B4
          1 0002A1       0008
          1 0002A2  0501 0042                            BBT      s:20398,PREL
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:63   
          1 0002A4  82C4 002E                            LB,'0004'X        46,B4
          1 0002A6       0004
          1 0002A7  0501 003D                            BBT      s:20398,PREL

      444    20366    3                         THEN
      445    20367    4                            DO;

      446    20368    4                               BUF$ = %L2.DVC_HEAD$;

  20368   1 0002A9  BCC4 0068                            LDB,B3   104,B4
          1 0002AB  BFC7 0018                            STB,B3   BUF$,AUTO

      447    20369    5                               DO WHILE ( BUF$ ~= ADDR(NIL) );

  20369   1 0002AD  0F81 001C                            B        s:20378,PREL

      448    20370    5                                  IF KX$LINKDEV.VDI$ = ADDR(NIL)

  20370   1 0002AF  ECC7 0018                            LDB,B6   BUF$,AUTO
          1 0002B1  8DC6 0002                            CMN      2,B6
          1 0002B3  0981 000D                            BNE      s:20376,PREL

      449    20371    5                                     THEN
      450    20372    5                                        CALL KXX$INTCNC ( KX$LINKDEV) WHENALTRETURN

  20372   1 0002B5  BBC7 0018                            LAB,B3   BUF$,AUTO
          1 0002B7  CBF0 0100                            LAB,B4   256,IMO
          1 0002B9  E380 0000 0000  xent                 LNJ,B6   KXX$INTCNC
          1 0002BC       0003                            DC       s:20374,PREL
          1 0002BD  0F81 0001                            B        s:20374,PREL

      451    20373    6                                              DO;

      452    20374    6                                              END;

  20374   1 0002BF  0F81 0004                            B        s:20377,PREL

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:64   
      453    20375    5                                     ELSE
      454    20376    5                                        KX$LINKDEV.RECNC = '1'B;

  20376   1 0002C1  8946 0017                            LBT,'0008'X       23,B6
  20376   1 0002C3       0008

      455    20377    5                                  BUF$ = KX$LINKDEV.FLNK$;

  20377   1 0002C4  ECC7 0018                            LDB,B6   BUF$,AUTO
          1 0002C6  DCC6 0006                            LDB,B5   6,B6
          1 0002C8  DFC7 0018                            STB,B5   BUF$,AUTO

      456    20378    5                               END;

  20378   1 0002CA  8DC7 0018                            CMN      BUF$,AUTO
          1 0002CC  09E3                                 BNE      s:20370,SPREL

      457    20379    4                            END;

      458    20380    3                   END;

  20380   1 0002CD  0F81 0017                            B        s:20398,PREL

      459    20381        /*
      460    20382                                             All other cases.
      461    20383        */
      462    20384    2          CASE ( ELSE );

      463    20385        /*
      464    20386                                             Tell KHA that the request was
      465    20387                                             not handled.
      466    20388        */
      467    20389    2             ADMIN_FPT.RESULTS = UNKFCN;

  20389   1 0002CF  8C80 0000 000E  00                   LDI      UNKFCN
          1 0002D2  8D46 000F                            SDI      15,B6

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:65   
      468    20390                  %ENABLE;

  20391   1 0002D4  DC80 0000 0002  xsym                 LDB,B5   KH_CTLTBL+2
          1 0002D7  D847 001A                            LDR,R5   LEVEL,AUTO
          1 0002D9  D905                                 CMR,R5   ,B5
          1 0002DA  0901 0007                            BE       s:20393,PREL

  20391   1 0002DC  CBF0 0000                            LAB,B4   0,IMO
          1 0002DE  E380 0000 0000  xent                 LNJ,B6   KHI$ENABLE
          1 0002E1       0001                            DC       s:20393,PREL

      469    20393    2             ALTRETURN;

  20393   1 0002E2  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      470    20394        %EJECT;
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:66   
      471    20395    2       END;  /*  Case on FNC  */

      472    20396
      473    20397            %ENABLE;

  20398   1 0002E5  EC80 0000 0002  xsym                 LDB,B6   KH_CTLTBL+2
          1 0002E8  E847 001A                            LDR,R6   LEVEL,AUTO
          1 0002EA  E906                                 CMR,R6   ,B6
          1 0002EB  0901 0007                            BE       s:20401,PREL

  20398   1 0002ED  CBF0 0000                            LAB,B4   0,IMO
          1 0002EF  E380 0000 0000  xent                 LNJ,B6   KHI$ENABLE
          1 0002F2       0001                            DC       s:20401,PREL

      474    20400
      475    20401    1       RETURN;

  20401   1 0002F3  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      476    20402
      477    20403    1   END KXA$ADMIN;

PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:67   
--  Include file information  --

   KH$STT.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KXX_MACROS_M.:E05TOU  is referenced.
   KX_MACROS_M.:E05TOU  is referenced.
   KX_DATA_C.:E05TOU  is referenced.
   KX_SCODE_C.:E05TOU  is referenced.
   KX_PERR_C.:E05TOU  is referenced.
   KX_EQUS_E.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KXA$ADMIN.
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:68   

 **** Variables and constants ****

  ****  Section 000 RoData KXA$ADMIN

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     A-0-0/w STRC(32)    r     1 BLDFAL                    10-0-0/w STRC(32)    r     1 DSBFAL
     C-0-0/w STRC(32)    r     1 DSCFAL                     6-0-0/w STRC(32)    r     1 ENBFAL
     8-0-0/w STRC(32)    r     1 KILFAL                     0-0-0/w STRC(32)    r     1 SGNRJC
     2-0-0/w STRC(32)    r     1 SUBSUB                     E-0-0/w STRC(32)    r     1 UNKFCN
    12-0-0/w STRC(48)    r     1 Y_VC_SGNRJC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ADMIN_FPT                *0-0-0/w STRC(288)   r     1 ADMIN_FPT
    18-0-0/w PTR         r     1 BUF$                       6-0-0/w STRC(256)   r     1 CALL_FPT
    16-0-0/w PTR         r     1 CTX$                      1B-0-0/w UBIN(32)    r     1 ERROR
    1A-0-0/w UBIN(16)    r     1 LEVEL                     1D-0-0/w UBIN(32)    r     1 Y@CRTEXCTIM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 G$JIT$                     0-0-0/w STRC(64)    r     1 KH_CTLTBL
     0-0-0/w STRC(8960)  r     1 KV_STT                     0-0-0/b EPTR        r     1 KX_PM$(0:2)
     0-0-0/w STRC(800)   r     1 KX_STATS_HDLC              0-0-0/w STRC(1248)  r     1 KX_STATS_X25
     0-0-0/w STRC(1248)  r     1 KX_STATS_X29

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:69   

     0-0-0/w UBIN(16)    r     1 BASED_WORD                 0-0-0/w STRC(64)    r     1 BLKHDR
     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(320)   r     1 KL_REQSTATS
     0-0-0/w STRC(4992)  r     1 KX$L2                      0-0-0/w STRC(384)   r     1 KX$LINKDEV


   Procedure KXA$ADMIN requires 758 words for executable code.
   Procedure KXA$ADMIN requires 44 words of local(AUTO) storage.

    No errors detected in file KXA$ADMIN.:E05TSI    .
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:70   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:71   
          MINI XREF LISTING

ADMIN_FPT
     16625**DCL        13--PROC    20135--ASSIGN  20155--ASSIGN  20175--ASSIGN  20247--ASSIGN  20262--ASSIGN
ADMIN_FPT.CHN$
     16752**DCL     20116>>IF      20300>>CALL    20360>>IF      20360>>IF      20365>>IF      20365>>IF
     20368>>ASSIGN
ADMIN_FPT.CTX$
     16681**DCL     17826--IMP-PTR 20190>>IF      20192>>IF      20196>>CALL    20198>>IF      20202>>CALL
     20204>>IF      20208>>CALL    20210>>IF      20216>>CALL    20228>>IF      20228>>IF      20228>>IF
ADMIN_FPT.FNC
     16626**DCL     20094>>IF      20094>>IF      20097>>DOCASE
ADMIN_FPT.LIN$
     16756**DCL     20096>>ASSIGN
ADMIN_FPT.RESULTS
     16777**DCL     20120<<ASSIGN  20139<<ASSIGN  20159<<ASSIGN  20179<<ASSIGN  20233<<ASSIGN  20266<<ASSIGN
     20283<<ASSIGN  20348<<ASSIGN  20389<<ASSIGN
ADMIN_FPT.TERMID
     16647**DCL     20334<>CALL    20336<>CALL    20336<>CALL    20364<>CALL
ADMIN_FPT.TERMID.LEV
     16649**DCL     20116>>IF      20280>>IF      20315>>DOSELCT
ADMIN_FPT.TERMID.TERM
     16649**DCL     16658--REDEF
BASED_WORD
     16878**DCL     20087>>ASSIGN  20123>>IF      20235>>IF      20350>>IF      20391>>IF      20398>>IF
BLDFAL
     20233**LABEL   20233>>ASSIGN  20248--CALLALT
BLKHDR.BLKTYP
     17854**DCL     20228>>IF      20228>>IF      20228>>IF
BUF$
     16867**DCL     17389--IMP-PTR 20368<<ASSIGN  20369>>DOWHILE 20370>>IF      20372>>CALL    20376>>ASSIGN
     20377<<ASSIGN  20377>>ASSIGN
CALL_FPT
     16848**DCL     20132<<ASSIGN  20136<>CALL    20152<<ASSIGN  20156<>CALL    20172<<ASSIGN  20176<>CALL
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:72   
     20244<<ASSIGN  20248<>CALL    20259<<ASSIGN  20263<>CALL    20287<<ASSIGN  20290<>CALL
CALL_FPT.EVN
     16852**DCL     20133<<ASSIGN  20153<<ASSIGN  20173<<ASSIGN  20245<<ASSIGN  20260<<ASSIGN  20288<<ASSIGN
CALL_FPT.PRM1$
     16853**DCL     16854--REDEF   20135<<ASSIGN  20155<<ASSIGN  20175<<ASSIGN  20247<<ASSIGN  20262<<ASSIGN
CALL_FPT.PRM2$
     16855**DCL     16855--REDEF
CALL_FPT.RCV$
     16852**DCL     20134<<ASSIGN  20154<<ASSIGN  20174<<ASSIGN  20246<<ASSIGN  20261<<ASSIGN  20289<<ASSIGN
CTX$
     16866**DCL     20096<<ASSIGN  20134>>ASSIGN  20154>>ASSIGN  20174>>ASSIGN  20246>>ASSIGN  20261>>ASSIGN
     20280>>IF      20289>>ASSIGN
DSBFAL
     18338**DCL     20159>>ASSIGN
DSCFAL
     18236**DCL     20266>>ASSIGN
ENABLE_ALTRET
     20123**LABEL   20140--GOTO    20160--GOTO    20180--GOTO    20267--GOTO
ENBFAL
     18083**DCL     20139>>ASSIGN
ERROR
     16869**DCL     20336<>CALL
G$JIT.ERRLOG
     17742**DCL     17745--REDEF
G$JIT.JSUNIT
     17481**DCL     17482--REDEF
G$JIT.MCLS
     17480**DCL     17480--REDEF
G$JIT.TMRZ
     17749**DCL     17750--REDEF
G$JIT.USER_EXTIME
     17473**DCL     17474--REDEF
G$JIT.USER_MEMTIME
     17476**DCL     17476--REDEF
G$JIT.USER_SVTIME
     17475**DCL     17475--REDEF
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:73   
G$JIT$
     19684**DCL     17412--IMP-PTR
KH$CHN
     16894**DCL     20300<>CALL
KH$CHN.AUTLGN
     16905**DCL     20116>>IF
KH$CHN.CTX$
     16964**DCL     20096>>ASSIGN  20360>>IF      20360>>IF      20365>>IF      20365>>IF      20368>>ASSIGN
KH$CHN.TERMID.TERM
     16990**DCL     16999--REDEF
KHA$DVCADM
     16589**DCL-ENT 20336--CALL
KHA$LINE_ACTIVE
     16601**DCL-ENT 20364--CALL
KHA$SNDSTT
     16597**DCL-ENT 20196--CALL    20202--CALL    20208--CALL    20216--CALL
KHC$XEQ2
     16600**DCL-ENT 20214--CALL
KHD$SCREECH
     16598**DCL-ENT 20345--CALL
KHI$DISABLE
     16590**DCL-ENT 20087--CALL
KHI$ENABLE
     16591**DCL-ENT 20123--CALL    20235--CALL    20350--CALL    20391--CALL    20398--CALL
KH_CTLTBL.PARM.PTR$
     18584**DCL     20087>>ASSIGN  20123>>IF      20235>>IF      20350>>IF      20391>>IF      20398>>IF
KILFAL
     18134**DCL     20179>>ASSIGN
KL_REQSTATS
     12621**DCL     20196<>CALL    20202<>CALL    20208<>CALL    20216<>CALL
KL_REQSTATS.DSPENT
     12717**DCL     20192>>IF      20198>>IF      20204>>IF      20210>>IF
KL_REQSTATS.DSPMSK
     12711**DCL     12717--REDEF
KL_REQSTATS.SLCENT
     12759**DCL     20190>>IF
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:74   
KL_REQSTATS.SLCMSK
     12752**DCL     12759--REDEF
KV_STT
     19712**DCL     20216--CALL
KV_STT.REQSTATS.DSPMSK
     19958**DCL     19964--REDEF
KV_STT.REQSTATS.SLCMSK
     19999**DCL     20006--REDEF
KV_STT.SCHEXCTIM
     20069**DCL     20215<<ASSIGN
KX$L2.DFLVCPRF.TRADEL
     17161**DCL     17171--REDEF
KX$L2.DSTSNPA.ADR_STRING
     17352**DCL     17352--REDEF
KX$L2.DVC_HEAD$
     17358**DCL     20368>>ASSIGN
KX$L2.FLG.RESTART
     17067**DCL     20365>>IF
KX$L2.FLG.RESTART_PEND
     17067**DCL     20365>>IF
KX$L2.FRMR_NSNR
     17138**DCL     17139--REDEF
KX$L2.NTWADR.ADR_STRING
     17072**DCL     17072--REDEF
KX$L2.STATE.CURRENT
     17051**DCL     20360>>IF
KX$L2.STATES
     17050**DCL     17050--REDEF
KX$LINKDEV
     17389**DCL     20372<>CALL
KX$LINKDEV.FLNK$
     17390**DCL     20377>>ASSIGN
KX$LINKDEV.RECNC
     17395**DCL     20376<<ASSIGN
KX$LINKDEV.VDI$
     17389**DCL     20370>>IF
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:75   
KXF$FRAME
     16592**DCL-ENT 20136--CALL    20156--CALL    20176--CALL    20248--CALL    20263--CALL    20290--CALL
KXN$CMND
     16593**DCL-ENT 20300--CALL
KXS$SYSLOG
     16595**DCL-ENT 20334--CALL
KXX$INTCNC
     16602**DCL-ENT 20372--CALL
KX_STATS_HDLC
     18694**DCL     20196--CALL
KX_STATS_HDLC.IN_TCB_TICS
     18996**DCL     20215>>ASSIGN
KX_STATS_HDLC.OUT_TCB_TICS
     18996**DCL     20215>>ASSIGN
KX_STATS_HDLC.REQSTATS.DSPMSK
     18940**DCL     18946--REDEF
KX_STATS_HDLC.REQSTATS.SLCMSK
     18981**DCL     18988--REDEF
KX_STATS_X25
     19019**DCL     20202--CALL
KX_STATS_X25.REQSTATS.DSPMSK
     19265**DCL     19271--REDEF
KX_STATS_X25.REQSTATS.SLCMSK
     19306**DCL     19313--REDEF
KX_STATS_X29
     19358**DCL     20208--CALL
KX_STATS_X29.REQSTATS.DSPMSK
     19604**DCL     19610--REDEF
KX_STATS_X29.REQSTATS.SLCMSK
     19645**DCL     19652--REDEF
LEVEL
     16868**DCL     20087<<ASSIGN  20087<>CALL    20123>>IF      20235>>IF      20350>>IF      20391>>IF
     20398>>IF
SGNRJC
     17930**DCL     20334<>CALL
SUBSUB
PL6.E3A0      #001=KXA$ADMIN File=KXA$ADMIN.:E05TSI                              WED 07/30/97 02:17 Page:76   
     17981**DCL     20120>>ASSIGN  20283>>ASSIGN  20348>>ASSIGN
UNKFCN
     18287**DCL     20389>>ASSIGN
Y@CRTEXCTIM
     16870**DCL     20214<>CALL    20215>>ASSIGN
Y_VC_SGNRJC
     18400**DCL     20345<>CALL
