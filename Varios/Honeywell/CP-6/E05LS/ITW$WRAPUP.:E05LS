VERSION E05

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:1    
        1        1        /*M*     Process the END command and perform clean up */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        9        9        /*P*     NAME:     ITW$WRAPUP
       10       10                 PURPOSE:  ITW$WRAPUP performs the various functions that must
       11       11                           be done at the end of TIGR processing. These include
       12       12                           initializing GHOST1,unmasking the I/O channels and
       13       13                           calling FMX$INIT and KIS$FEINIT.        */
       14       14        ITW$WRAPUP: PROC(PTR$,CALL_VOLINIT);
       15       15        /**/
       16       16    1   DCL PTR$ PTR;                           /* TABLE SPACE PTR                    */
       17       17    1   DCL CALL_VOLINIT BIT(1) ALIGNED;
       18       18        /**/
       19       19        /*  INCLUDE FILES */
       20       20        %INCLUDE B$USER;
       21      236        %B$USERREFS;
       22      240        %INCLUDE B$P;
       23      324        %INCLUDE P_PMDAT_R;
       24      632        %INCLUDE KI_DATA_R;
       25      658        %INCLUDE KI_SUBS_C ;
       26      794        %INCLUDE KI_MACROS_C;
       27     1402        %INCLUDE NI_DATA_R;
       28     1839        %INCLUDE NI_DATA_C;
       29     1952        %INCLUDE IT_SUBS_C;
       30     2219        %INCLUDE IT_ERROR_C;
       31     2302        %INCLUDE IT$CONFIG;
       32     2371        %INCLUDE MM_DATA_R;
       33     2891        %INCLUDE B_MLSMAC_C;
       34     3833        %INCLUDE I$DISK;
       35     4085        %INCLUDE B$JIT;
       36     4688        %INCLUDE B$MAP;
       37     4787        %INCLUDE NI_MACROS_C;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:2    
       38     5054        %INCLUDE SS_SCHED_C;
       39     5287        %INCLUDE SS_SCHED_R;
       40     5330        %INCLUDE JG_GHOSTS_C;
       41     5420        %INCLUDE FR_DATA_R;
       42     5452        %INCLUDE FR_SUBS;
       43     5520        %INCLUDE S_WSPTD_R;
       44     5536        %INCLUDE I_SUBS_C;
       45     5560        %INCLUDE IR_DATA_M;
       46     5724        %INCLUDE UM_CP6;
       47     6576        %INCLUDE TD_CP6;
       48     6754        %INCLUDE CP_6_SUBS;
       49     7294        %INCLUDE HF_DATA_R;
       50     7337        %INCLUDE KNN_NETWORK_M;
       51     7700        %INCLUDE K_ADDRESS_M;
       52     8203        %INCLUDE XUD_UTS_M;
       53     8285        %XUD_UTS_EQU;
       54     8296        %XUD$UTS_ENTRIES;
       55     8328        %INCLUDE K_SESSION_M;
       56     8418        %INCLUDE IS$MACROS;
       57     9693        %INCLUDE TM_DATA_M;
       58     9795        /**/
       59     9796        /*  SUBS  */
       60     9797        /**/
       61     9798        %SUB VIDDA = 0/*VIDDA*/;
       62     9799        %SUB MAXFWSIZE = 20;                    /* 20 PAGE DS1 FOR FW                 */
       63     9800        %SUB TRUE = '1'B;
       64     9801        %SUB FALSE = '0'B;
       65     9802        %SUB WAIT_N_MINS = 1;    /* wait 1 minute for outstanding IOs to complete */
       66     9803        /**/
       67     9804        /*  ENTRY DCLS  */
       68     9805        /**/
       69     9806    1   DCL NIM$INTDIS ENTRY ;
       70     9807    1   DCL NIM$WRENBL ENTRY(2);
       71     9808    1   DCL NIM$WRDSBL ENTRY(2);
       72     9809    1   DCL NIQ$GETS ENTRY(1) ALTRET;
       73     9810    1   DCL NIW$MPCSTART ENTRY(1);
       74     9811    1   DCL NIW$MPCSTOP ENTRY(1);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:3    
       75     9812    1   DCL NII$LIP ENTRY(1);
       76     9813    1   DCL NIW$LDFW ENTRY(2) ALTRET;
       77     9814    1   DCL ITF$FREEZE ENTRY;
       78     9815    1   DCL ITX$INITS ENTRY;
       79     9816    1   DCL ITX$INITS2 ENTRY;
       80     9817    1   DCL HFB$EDAC ENTRY;
       81     9818    1   DCL SSC$MONTIMR ENTRY(3);
       82     9819    1   DCL SSS$CURTIME ENTRY(1);
       83     9820    1   DCL SSS$TIME ENTRY;
       84     9821    1   DCL SSR$CHSE ENTRY(1);
       85     9822    1   DCL SSS$SENT ENTRY;
       86     9823    1   DCL MMH$FDS ENTRY(4) ALTRET;
       87     9824    1   DCL MMH$GDS ENTRY(5) ALTRET;
       88     9825    1   DCL MME$CVM ENTRY(4) ALTRET;
       89     9826    1   DCL MME$WFVP ENTRY(4) ALTRET;
       90     9827    1   DCL HFC$LCON ENTRY;
       91     9828    1   DCL MMB$GPP ENTRY(2) ALTRET;
       92     9829    1   DCL MMB$GNPP ENTRY(2) ALTRET;
       93     9830    1   DCL MMB$FPP ENTRY(1) ALTRET;
       94     9831    1   DCL ITK$VOLINIT ENTRY  ALTRET;
       95     9832    1   DCL ITH$READ_VERIFY_SAD ENTRY(2) ALTRET;
       96     9833    1   DCL ITQ$DREAD ENTRY(2) ALTRET;
       97     9834    1   DCL ITQ$DWRITE ENTRY(2) ALTRET;
       98     9835    1   DCL ITP$PROCREC ENTRY;
       99     9836    1   DCL ITE$ERROR ENTRY(2);
      100     9837    1   DCL ITZ$RECOVER ENTRY;
      101     9838    1   DCL HFB$ENAPORT ENTRY(1);
      102     9839    1   DCL HFB$INITMASK ENTRY;
      103     9840    1   DCL HFC$RSCR ENTRY(3);
      104     9841    1   DCL HFC$RRES ENTRY(2);
      105     9842    1   DCL HFC$RCONF ENTRY(2) ALTRET;
      106     9843    1   DCL ITK$TDP$SYSCON ENTRY(5) ALTRET;
      107     9844    1   DCL NKP$PART ENTRY(2) ALTRET;
      108     9845    1   DCL ITH$ALLOCATE ENTRY(2) ALTRET;
      109     9846    1   DCL UMT$LCLDATE ENTRY(3) ALTRET;
      110     9847    1   DCL ITG$MPY10000 ENTRY(2);
      111     9848    1   DCL KIQ$FEINT ENTRY(3);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:4    
      112     9849    1   DCL KIQ$PARTFEP ENTRY(2) ;
      113     9850    1   DCL ITK$TMB$MCA ENTRY(3) ALTRET;
      114     9851    1   DCL ITK$TMB$BUF_ALLOC ENTRY(3) ALTRET;
      115     9852    1   DCL ITK$TMB$BUF_DEALLOC ENTRY(2) ALTRET;
      116     9853        /**/
      117     9854        /*  ENTRIES ADDED FOR THE ITK$KILLTIGR CODE MOVED INTO HERE.   */
      118     9855        /**/
      119     9856    1   DCL HFD$CNNCT ENTRY(2);
      120     9857    1   DCL HFC$RCONF_8000 ENTRY;
      121     9858    1   DCL HFC$STCPU ENTRY(1);
      122     9859    1   DCL SSS$CACHEBP ENTRY;
      123     9860    1   DCL SSW$LOGSTRT ENTRY(2);
      124     9861    1   DCL SSW$USECACHE ENTRY;
      125     9862        /* DCL HFB$ENAPORT ENTRY(1);    DCLed above */
      126     9863    1   DCL HFB$DISPORT ENTRY(1);
      127     9864    1   DCL SSW$BYPASSCACHE ENTRY;
      128     9865        /**/
      129     9866        /**/
      130     9867        /*  AUTOMATIC  */
      131     9868        /**/
      132     9869    1   DCL I SBIN WORD;
      133     9870    1   DCL J SBIN WORD;
      134     9871    1   DCL K SBIN WORD;
      135     9872    1   DCL ERR SBIN;
      136     9873    1   DCL 1 TEXT_C,
      137     9874    1            2 L UBIN(9) UNAL,
      138     9875    1            2 T CHAR(10) UNAL;
      139     9876    1   DCL 1 CPUNUM AUTO,                 /* added for ITK$KILLTIGR code moved in */
      140     9877    1            2 COUNT UBIN(9) UNAL,
      141     9878    1            2 TEXT CHAR(5) UNAL;
      142     9879    1   DCL 1 SCU_REG DALIGNED,
      143     9880    1            2 * BIT(28) UNAL,
      144     9881    1            2 PORTS(0:7) BIT(1) UNAL,
      145     9882    1            2 * BIT(36) UNAL;
      146     9883    1   DCL CUR_FWSLOT SBIN;
      147     9884    1   DCL DEVNM CHAR(8);
      148     9885    1   DCL OFFSET SBIN;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:5    
      149     9886    1   DCL RSLT BIT(72) ALIGNED;
      150     9887    1   DCL BASE_CHAN SBIN WORD;
      151     9888    1   DCL DEV_CHAN SBIN WORD;                 /* UNIT RECORD FW BITS BY CHANNEL     */
      152     9889    1   DCL LP_WORD UBIN WORD;
      153     9890    1   DCL LP_WORD_BITS(0:35) REDEF LP_WORD BIT(1) UNAL;
      154     9891    1   DCL CRCP_WORD SBIN WORD;
      155     9892    1   DCL CRCP_WORD_BITS(0:35) REDEF CRCP_WORD BIT(1) UNAL;
      156     9893    1   DCL MAX_DA  SBIN WORD;
      157     9894    1   DCL MIN_DA SBIN WORD;
      158     9895    1   DCL MONDATA_DA SBIN WORD;
      159     9896    1   DCL MONDATA_SIZE SBIN WORD;
      160     9897    1   DCL TIGRDATA_DA SBIN WORD;
      161     9898    1   DCL IT_DATASIZE UBIN WORD SYMREF;
      162     9899    1   DCL LOWREAL_DA SBIN WORD;
      163     9900    1   DCL DIR_DA SBIN WORD;
      164     9901    1   DCL MAX_NUM_PORTS SBIN WORD;
      165     9902    1   DCL APPL$ PTR;
      166     9903        /**/
      167     9904    1   DCL FWDA SBIN WORD;
      168     9905    1   DCL FWSIZE SBIN WORD;
      169     9906    1   DCL FWSLOTS SBIN WORD;
      170     9907    1   DCL 1 FW(0:19),
      171     9908    1            2 BASE UBIN WORD UNAL,
      172     9909    1            2 DA UBIN WORD UNAL,
      173     9910    1            2 CS0SIZE UBIN HALF UNAL,
      174     9911    1            2 MM0SIZE UBIN HALF UNAL,
      175     9912    1            2 NAME CHAR(4) UNAL;
      176     9913        /**/
      177     9914    1   DCL 1 SUB_BUF,
      178     9915    1            2 COUNT UBIN(9) UNAL,
      179     9916    1            2 TEXT CHAR(11) UNAL;
      180     9917        /**/
      181     9918    1   DCL REQ$ PTR;
      182     9919    1   DCL 1 REREQ$ REDEF REQ$,
      183     9920    1            2 OFFSET UBIN(18) UNAL,
      184     9921    1            2 * BIT(6) UNAL,
      185     9922    1            2 SEGID UBIN(12) UNAL;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:6    
      186     9923    1   DCL SQH$ PTR;
      187     9924    1   DCL DQH$ PTR;
      188     9925    1   DCL DEV$ PTR;
      189     9926    1   DCL DCT$ PTR ;
      190     9927    1   DCL MPC$ PTR ;
      191     9928    1   DCL USER$ PTR;
      192     9929    1   DCL DBUF$ PTR;
      193     9930    1   DCL CVM$ PTR;
      194     9931        %FPT_SYSCON (FPTN=FPT_SYSCON,STCLASS=AUTO);
      195     9948        /**/
      196     9949    1   DCL LAX SBIN;
      197     9950    1   DCL PCHAN SBIN;
      198     9951        /* AUTO DATA FOR STORE UNIT SURVEY */
      199     9952    1   DCL STOREUNIT# SBIN WORD;               /* INDEX INTO STORE UNIT ARRAYS       */
      200     9953    1   DCL PORT# SBIN WORD;                    /* INDEX INTO CPU PORT ARRAYS         */
      201     9954    1   DCL PORT_START_ADDR SBIN WORD;          /* PORT STARTING ADDRESS IN WORDS     */
      202     9955    1   DCL PORT_MEM_SIZE SBIN WORD;            /* TOTAL MEMORY ON PORT IN WORDS      */
      203     9956    1   DCL ERRCDE SBIN WORD;
      204     9957    1   DCL RSCR_ADDR SBIN WORD;
      205     9958    1   DCL LOWER_STORE_SIZE SBIN WORD;         /* TOTAL MEMORY ON LOWER STORE PAIR   */
      206     9959    1   DCL SU# SBIN WORD;                      /* INDEX FOR STORE UNITS ON EACH SCU  */
      207     9960    1   DCL LOG_SU# SBIN WORD;
      208     9961    1   DCL 1 SU,
      209     9962    1            2 ONLINE (0:3) BIT(1) UNAL,
      210     9963    1            2 ONLINE_REDEF REDEF ONLINE BIT(4) UNAL;
      211     9964    1   DCL 1 CPU_CONFIG ,
      212     9965    1            2 PORT_ASSIGN UBIN(3) UNAL,
      213     9966    1            2 PORT_ENABLE BIT(1) UNAL,
      214     9967    1            2 INITIALIZE BIT(1) UNAL,
      215     9968    1            2 INTERLACE BIT(1) UNAL,
      216     9969    1            2 SIZE UBIN(3) UNAL;
      217     9970    1   DCL 1 SCU_CONFIG DALIGNED,
      218     9971    1            2 * BIT(9) UNAL,
      219     9972    1            2 SIZE UBIN(3) UNAL,
      220     9973    1            2 ON_LINE BIT(4) UNAL,
      221     9974    1            2 * BIT(14) UNAL,
      222     9975    1            2 INTERLACE BIT(1) UNAL,
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:7    
      223     9976    1            2 LOWER_STORE BIT(1) UNAL,
      224     9977    1            2 * BIT(40) UNAL;
      225     9978    1   DCL 1 RSW2,
      226     9979    1            2 DPSE_2WAY (0:3) BIT(1) UNAL,
      227     9980    1            2 L66_SIZE_MULT (0:3) REDEF DPSE_2WAY BIT(1) UNAL,
      228     9981    1            2 * BIT(32) UNAL;
      229     9982    1   DCL CPU_INTL UBIN WORD;
      230     9983
      231     9984    1   DCL B$BIT36(0:0) BIT(36) ALIGNED BASED;
      232     9985    1   DCL IT_CLOFF BIT(72) DALIGNED SYMREF;
      233     9986    1   DCL 1 XXX_CLOCK DALIGNED,
      234     9987    1            2 DATE,
      235     9988    1                 3 Y UBIN(12) UNAL,
      236     9989    1                 3 M UBIN(6) UNAL,
      237     9990    1                 3 D UBIN(6) UNAL,
      238     9991    1            2 TIME BIT(48) UNAL;
      239     9992
      240     9993    1   DCL 1 LOCAL_DATE,
      241     9994    1            2 M CHAR(2),
      242     9995    1            2 S1 CHAR(1),
      243     9996    1            2 D CHAR(2),
      244     9997    1            2 S2 CHAR(1),
      245     9998    1            2 Y CHAR(2);
      246     9999
      247    10000    1   DCL START_TIME UBIN(36);
      248    10001    1   DCL LAP_TIME   UBIN(36);
      249    10002    1   DCL UTS_DATE UBIN;
      250    10003    1   DCL PPNO SBIN;
      251    10004    1   DCL IPC SBIN;
      252    10005    1   DCL CHAN SBIN;
      253    10006    1   DCL BUF$ PTR;
      254    10007    1   DCL BUFX SBIN;
      255    10008    1   DCL TDQH$ PTR;
      256    10009    1   DCL IO_OUTSTANDING BIT(1) ALIGNED;
      257    10010    1   DCL ONQUEUE REDEF IO_OUTSTANDING BIT(1) ALIGNED;
      258    10011    1   DCL ITW_FREEZE BIT(1) ALIGNED;
      259    10012        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:8    
      260    10013        /*  BASED */
      261    10014        %INCLUDE IT$SPROCDS;
      262    10030        %NI$DCT;
      263    10078        %NI$SQH;
      264    10091        %NI$DVT;
      265    10098        %NI$REQ;
      266    10123        %NI$DQH;
      267    10146        %KI$ROUTE (STCLASS=BASED);
      268    10200        %KIS$APPL (NAME=APPL,STCLASS=BASED);
      269    10269        %KNN$OSIROUTE(FPTN=KI$OSIROUTE);
      270    10486    1   DCL KI$OSIROUTE$(0:0) PTR BASED(KI_OSIROUTE$$);
      271    10487        %MCA_CFG(NAME=MCA_CFG,STCLASS="BASED(BUF$)");
      272    10597    1   DCL KI$ROUTE$(0:0) PTR BASED(KI_ROUTE$$);
      273    10598        %NI$FW (STCLASS="BASED(B$DS1$)");
      274    10604        %NI$CHT;
      275    10607        %NI$IOM;
      276    10612        %N$REQ;
      277    10670        %B_MLS (FPTN=B$MLNK,STCLASS=BASED);
      278    11485        /**/
      279    11486        %FM$VID;
      280    11532        /**/
      281    11533        %VLR_SITEINFO (FPTN=B$SITEINFO,STCLASS=BASED);
      282    11552        /**/
      283    11553    1   DCL 1 REAL BASED DALIGNED,
      284    11554    1            2 *(0:23) SBIN,
      285    11555    1            2 L30 BIT(72);
      286    11556    1   DCL B$WORD UBIN WORD BASED ALIGNED;
      287    11557    1   DCL 1 MINI_DATA BASED(B$LOWMEM$) ALIGNED,
      288    11558    1            2 *(0:8191) UBIN,
      289    11559    1            2 MINIQM EPTR,
      290    11560    1            2 MINIQX EPTR,
      291    11561    1            2 RSTART EPTR,
      292    11562    1            2 GOLOOP EPTR,
      293    11563    1            2 RECOVER EPTR,
      294    11564    1            2 OK2WRVID SBIN;
      295    11565        /**/
      296    11566        /*  SYMREFS  */
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:9    
      297    11567        /**/
      298    11568    1   DCL B$JIT$ PTR SYMREF;
      299    11569    1   DCL B$REAL$ PTR SYMREF;
      300    11570    1   DCL B$DS1$ PTR SYMREF;
      301    11571    1   DCL B$DS2$ PTR SYMREF;
      302    11572    1   DCL B$DS3$ PTR SYMREF;
      303    11573    1   DCL B$DS4$ PTR SYMREF;
      304    11574    1   DCL B$DS5$ PTR SYMREF;
      305    11575    1   DCL B$DS6$ PTR SYMREF;
      306    11576    1   DCL B$UPT$ PTR SYMREF;
      307    11577    1   DCL B$MPT$ PTR SYMREF;
      308    11578    1   DCL B$IS$ PTR SYMREF;
      309    11579    1   DCL B$LS$ PTR SYMREF;
      310    11580    1   DCL B$LOWMEM$ PTR SYMREF;
      311    11581    1   DCL B$TIGR$ PTR SYMREF;
      312    11582    1   DCL B$WINDOW$ PTR SYMREF;
      313    11583    1   DCL B$WSQ0PT$ PTR SYMREF;
      314    11584    1   DCL B$IPHYMAP$ PTR SYMREF;
      315    11585    1   DCL B$IMX$ PTR SYMREF;
      316    11586    1   DCL B$SCU$ PTR SYMREF;
      317    11587    1   DCL NK_MXLOCAL SBIN SYMREF;
      318    11588    1   DCL S_TIMR UBIN WORD SYMREF;
      319    11589    1   DCL B_SCDCTX UBIN WORD SYMREF;
      320    11590    1   DCL IT_FEI$$ PTR SYMREF;
      321    11591    1   DCL 1 FM_SYSDP SYMREF,                  /* THIS FORM MAKES IT EASY FOR BOOT   */
      322    11592    1            2 PORT UBIN(9) UNAL,
      323    11593    1            2 CHN UBIN(9) UNAL,
      324    11594    1            2 DVN UBIN(9) UNAL,
      325    11595    1            2 * UBIN(9) UNAL;
      326    11596    1   DCL IT_SYSDIR$ PTR SYMREF;              /* SYSTEM AREA DIRECTORY IN TIGR DATA */
      327    11597    1   DCL IT_SCPUWSPTD(0:%NUM_CPUS) UBIN WORD SYMREF;
      328    11598    1   DCL IT_SCPUJIT(0:%NUM_CPUS) UBIN WORD SYMREF;
      329    11599    1   DCL IT_SCPUHJIT(0:%NUM_CPUS) UBIN WORD SYMREF;
      330    11600    1   DCL IT_BOOTFLAG UBIN WORD SYMREF;
      331    11601    1   DCL IT_GOTLP BIT(1) SYMREF;
      332    11602    1   DCL IT_SYSDISK UBIN WORD SYMREF;        /* SYSTEM DISK DCTX                   */
      333    11603    1   DCL IT_DUMPSIZE UBIN WORD SYMREF;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:10   
      334    11604    1   DCL IT_DBUF UBIN WORD SYMREF;
      335    11605    1   DCL IT_DBUFEND UBIN WORD SYMREF;
      336    11606    1   DCL IT_MMDSMAX(0:7) UBIN BYTE UNAL SYMREF;
      337    11607    1   DCL KIS_SSN_CLIENTS UBIN SYMREF;
      338    11608    1   DCL KIS_SSN_SERVERS UBIN SYMREF;
      339    11609    1   DCL KIS_SSN_MAX UBIN SYMREF;
      340    11610    1   DCL KIS_SSN_MAXMINOR UBIN SYMREF;
      341    11611    1   DCL KIS_SSN_MAXMAJOR UBIN SYMREF;
      342    11612    1   DCL KIS_MAJOR$ PTR SYMREF;
      343    11613    1   DCL KIS_MINOR$ PTR SYMREF;
      344    11614
      345    11615    1   DCL EL_LOGERRS BIT(1) ALIGNED SYMREF;
      346    11616    1   DCL IT_TIGRCUB BIT(1) ALIGNED SYMREF;
      347    11617    1   DCL S_PNO UBIN SYMREF;
      348    11618        %NI$PARTITION (NAME=IT_PARTITION,STCLASS=SYMREF);
      349    11626        %IT$CONFIG (NAME=IT_CONFIG, STCLASS=SYMREF);
      350    11687        %KI$FEI;
      351    11771        /**/
      352    11772        %VLR_SITEINFO (FPTN=B_SITEINFO,STCLASS=SYMREF);
      353    11791        /**/
      354    11792        /*  CONSTANT DATA  */
      355    11793        /**/
      356    11794        %RV_BOOTID;
      357    11799        /* CONSTANT DATA FOR STORE UNIT SURVEY */
      358    11800    1   DCL L66_CPU_MEM_SIZE (0:7) SBIN WORD CONSTANT INIT(
      359    11801    1         32768,65536,0,131072,0,0,0,262144);
      360    11802    1   DCL DPSE_ELS1_CPU_MEM_SIZE (0:7) SBIN WORD CONSTANT INIT(
      361    11803    1         0,65536,131072,262144,524288,1048576,2097152,4194304);
      362    11804    1   DCL L66_CPU_BF (0:7) SBIN WORD CONSTANT INIT(
      363    11805    1         8,7,0,6,0,0,0,5);
      364    11806    1   DCL DPSE_ELS1_CPU_BF (0:7) SBIN WORD CONSTANT INIT(
      365    11807    1         0,7,6,5,4,3,2,1);
      366    11808    1   DCL SCU_MEM_SIZE (0:7) SBIN WORD CONSTANT INIT(
      367    11809    1         0,65536,131072,262144,524288,1048576,2097152,4194394);
      368    11810    1   DCL SCU_BF (0:7) SBIN WORD CONSTANT INIT(
      369    11811    1         0,7,6,5,4,3,2,1);
      370    11812    1   DCL A_LOW (0:3) SBIN WORD CONSTANT INIT(0,1,2,3);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:11   
      371    11813    1   DCL B_LOW (0:3) SBIN WORD CONSTANT INIT(2,3,0,1);
      372    11814    1   DCL MCA_FW_LOAD(0:15) BIT(1) UNAL CONSTANT
      373    11815    1     INIT ('0'B, '0'B, '1'B, '0'B, '1'B, '1'B, '1'B, '0'B*0);
      374    11816    1   DCL 1 NI_ENTADDR EPTR CONSTANT INIT(ENTADDR(NIM$INTDIS)) ;
      375    11817    1   DCL 1 NI_ENTRY   REDEF NI_ENTADDR,
      376    11818    1            2 LOC   UBIN(18) UNAL,
      377    11819    1            2 *     UBIN(18) UNAL ;
      378    11820        /**/
      379    11821        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:12   
      380    11822        /*D*     NAME:     ITW$WRAPUP
      381    11823                 PURPOSE:  To perform the various functions that must be done
      382    11824                           after all TIGR commands have been processed
      383    11825        *
      384    11826                 INPUT:    PTR$ - parameter - pointer to next available TIGR table
      385    11827                                  location.
      386    11828        *
      387    11829                 OUTPUT:   Initialized tables, GHOST1 and etc.
      388    11830        *
      389    11831                 DESCRIPTION:   ITW$WRAPUP first moves the N$DCT$ and B$P tables
      390    11832                           from the data segments where they were built to the
      391    11833                           TIGR table area. Then an I/O operation is done
      392    11834                           to every subsystem to unmask the I/O channels and allow
      393    11835                           special interrupts, TIGR's working data segments
      394    11836                           are released, FMX$INIT and KIS$FEINIT are called, and
      395    11837                           GHOST1 is readied for execution. When this is done
      396    11838                           ITW$WRAPUP returns to ITT$TIGR.         */
      397    11839        /**/
      398    11840    1        IF HW_SMART_CACHE
      399    11841    1        THEN B$LS$ -> B$MLNK.BUF.FLGS = '743'O;
      400    11842
      401    11843    2        IF HW_SECT_PT THEN DO;             /* Get MM_SCTDFT */
      402    11844    2             CALL MMB$GPP (MM_SCTDFT, %MONWSQ);
      403    11845    2             CALL MME$CVM (%MONWSQ, %WINDOWLO, MM_SCTDFT, ERR);
      404    11846    3             DO I = 0 TO 1023;
      405    11847    3                  B$WINDOW$->B$BIT36(I) = MM_FPMC;
      406    11848    3                END;
      407    11849    2             CALL MME$CVM (%MONWSQ, %WINDOWLO, -1, ERR);
      408    11850    2             IF HW_WSQ0PT THEN MM_SCTDFT = B$WSQ0PT$->B$MAP.RPN(MM_SCTDFT);
      409    11851    2           END;
      410    11852
      411    11853    2        DO I = 0 TO NI_IOMS-1;
      412    11854    2             PORT# = NI$IOM$(I)->NI$IOM.ADDRESS;
      413    11855    2             IF NOT IT_PARTITION.IOCHAN(I*%N_MAXCHANS) THEN CALL HFB$ENAPORT(PORT#);
      414    11856    2           END;
      415    11857        /**/
      416    11858    2        IF HW_IMX THEN DO;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:13   
      417    11859        /* RPM has no IMWs, and needs to do funny stuff with IOS packets here, because
      418    11860           they are not written to disk like they are on DPS8's.  Remember, on
      419    11861           RPM's they don't live in $LS17, they live in $LS114. */
      420    11862    2             NI$IMW$ = ADDR(NIL);
      421    11863    2             NI_IMXLO_PBASE = (B$MPT$->B$MAP.RPN(%PGTBLLO)*1024+%IMXLO)*1024;
      422    11864    2             PPNO=%(IMXHI-IMXLO+1);
      423    11865    3             CALL MMB$GNPP (PPNO, %MONWSQ) WHENALTRETURN DO; CALL ITF$FREEZE; END;
      424    11866    3             DO I = 0 TO %(IMXHI-IMXLO);
      425    11867    4                  CALL MME$CVM (%MONWSQ, %IMXLO+I, PPNO+I, J) WHENALTRETURN DO;
      426    11868    4                       CALL ITF$FREEZE;
      427    11869    4                     END;
      428    11870    3                END;
      429    11871    2             NI$FQ$->NI$FQ.HD$ = B$IMX$; /* IOS packets live in B$IMX for the RPM */
      430    11872    2             REQ$ = NI$FQ$->NI$FQ.HD$;
      431    11873    3             DO I = 1 TO NI_NUMIOS;
             11873                      /* Need to link 'em here, cause they aren't written to disk */
      432    11874    3                  REQ$->NI$REQ.FL$=PINCRW(REQ$,%IMX_IOSMBX_SIZE);
      433    11875    3                  REQ$ = PINCRW(REQ$,%IMX_IOSMBX_SIZE);
      434    11876    3                END;
      435    11877    2             REQ$ = PINCRW(REQ$,-(%IMX_IOSMBX_SIZE));
      436    11878    2             REQ$->NI$REQ.FL$=NI$FQ$->NI$FQ.HD$;
      437    11879        /* Assign permanent mailboxes for IMX direct channels */
      438    11880    3             DO I = 0 TO NI_IOMS-1;
      439    11881    4                  DO J = 8 TO %N_MAXCHANS;
      440    11882    5                       IF NI$CHT$->NI$CHT.POSTER(I*%N_MAXCHANS + J) = ENTADDR(KIQ$FEINT
             11882                                ) THEN DO;
      441    11883    5                            DQH$ = NI$CHT$->NI$CHT.DQH$(I*%N_MAXCHANS + J);
      442    11884    5                            CALL NIQ$GETS (REQ$) ALTRET (ITW$ALLOC_ERR);
      443    11885    5                            DQH$ -> NI$DQH.MBX$ = PINCRW (REQ$, %IMX_MBX_OFFSET);
      444    11886    5                            DQH$ -> NI$DQH.IOSTATUS$ = PINCRW (REQ$, %IMX_STATUS_OFFSET
             11886                                     );
      445    11887    5                          END;
      446    11888    4                     END;
      447    11889    3                END;
      448    11890    2           END;
      449    11891    2        ELSE DO;
      450    11892    2             NI$IMW$ = PINCRW(B$REAL$,BITBIN(%IMW_BASE));
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:14   
      451    11893    2             NI_IMXLO_PBASE = 0;
      452    11894    2           END;
      453    11895    1        NI_INTENTRY.LOC = NI_ENTRY.LOC ;
      454    11896    1        B$REAL$ -> REAL.L30 = NI_INTENTRY;
      455    11897        /**/
      456    11898    1        I = S_NSCPU;                       /* INIT SLAVES                      */
      457    11899    1        S_NSCPU = 0;
      458    11900    2        DO WHILE (S_NSCPU < I);
      459    11901    2             S_NSCPU = S_NSCPU + 1;
      460    11902    2             CALL ITP$PROCREC;
      461    11903    2           END;
      462    11904        /**/
      463    11905    2        IF (S_NSCPU ~= 0) THEN DO;         /* INIT SLAVE/MASTER MAPS FOR MM      */
      464    11906    2             CVM$ = B$WINDOW$;
      465    11907        /**/
      466    11908    3             DO I = 1 TO S_NSCPU;
      467    11909    3                  CALL MME$CVM(%MON_WSQ,%WINDOWLO,IT_SCPUJIT(I),J) ALTRET(CVM_ERR);
      468    11910        /**/
      469    11911    4                  DO CASE (I);
      470    11912    4                  CASE (1);
      471    11913    4                     B$MPT$ -> B$MAP(%SLV1PTPG) = CVM$ -> B$MAP(%PGTBLLO);
      472    11914    4                     B$MPT$ -> B$MAP(%SLV1HJITPG) = CVM$ -> B$MAP(%HJITPG);
      473    11915    4                  CASE (2);
      474    11916    4                     B$MPT$ -> B$MAP(%SLV2PTPG) = CVM$ -> B$MAP(%PGTBLLO);
      475    11917    4                     B$MPT$ -> B$MAP(%SLV2HJITPG) = CVM$ -> B$MAP(%HJITPG);
      476    11918    4                  CASE (3);
      477    11919    4                     B$MPT$ -> B$MAP(%SLV3PTPG) = CVM$ -> B$MAP(%PGTBLLO);
      478    11920    4                     B$MPT$ -> B$MAP(%SLV3HJITPG) = CVM$ -> B$MAP(%HJITPG);
      479    11921    4                  CASE (4);
      480    11922    4                     B$MPT$ -> B$MAP(%SLV4PTPG) = CVM$ -> B$MAP(%PGTBLLO);
      481    11923    4                     B$MPT$ -> B$MAP(%SLV4HJITPG) = CVM$ -> B$MAP(%HJITPG);
      482    11924    4                  CASE (5);
      483    11925    4                     B$MPT$ -> B$MAP(%SLV5PTPG) = CVM$ -> B$MAP(%PGTBLLO);
      484    11926    4                     B$MPT$ -> B$MAP(%SLV5HJITPG) = CVM$ -> B$MAP(%HJITPG);
      485    11927    4                  END;
      486    11928        /**/
      487    11929    3                  CALL MME$CVM(%MON_WSQ,%WINDOWLO,-1,J) ALTRET(CVM_ERR); /* RELEASE */
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:15   
      488    11930    3                END;
      489    11931        /**/
      490    11932    3             DO I = 1 TO S_NSCPU;
      491    11933    3                  CALL MME$CVM(%MON_WSQ,%WINDOWLO,IT_SCPUJIT(I),J) ALTRET(CVM_ERR);
      492    11934        /**/
      493    11935    3                  CVM$ -> B$MAP(%MASTERPTPG) = B$MPT$ -> B$MAP(%MASTERPTPG);
      494    11936    3                  CVM$ -> B$MAP(%MASTERHJITPG) = B$MPT$ -> B$MAP(%MASTERHJITPG);
      495    11937    3                  CVM$ -> B$MAP(%SLV1PTPG) = B$MPT$ -> B$MAP(%SLV1PTPG);
      496    11938    3                  CVM$ -> B$MAP(%SLV1HJITPG) = B$MPT$ -> B$MAP(%SLV1HJITPG);
      497    11939    3                  CVM$ -> B$MAP(%SLV2PTPG) = B$MPT$ -> B$MAP(%SLV2PTPG);
      498    11940    3                  CVM$ -> B$MAP(%SLV2HJITPG) = B$MPT$ -> B$MAP(%SLV2HJITPG);
      499    11941    3                  CVM$ -> B$MAP(%SLV3PTPG) = B$MPT$ -> B$MAP(%SLV3PTPG);
      500    11942    3                  CVM$ -> B$MAP(%SLV3HJITPG) = B$MPT$ -> B$MAP(%SLV3HJITPG);
      501    11943    3                  CVM$ -> B$MAP(%SLV4PTPG) = B$MPT$ -> B$MAP(%SLV4PTPG);
      502    11944    3                  CVM$ -> B$MAP(%SLV4HJITPG) = B$MPT$ -> B$MAP(%SLV4HJITPG);
      503    11945    3                  CVM$ -> B$MAP(%SLV5PTPG) = B$MPT$ -> B$MAP(%SLV5PTPG);
      504    11946    3                  CVM$ -> B$MAP(%SLV5HJITPG) = B$MPT$ -> B$MAP(%SLV5HJITPG);
      505    11947        /**/
      506    11948    3                  CALL MME$CVM(%MON_WSQ,%WINDOWLO,-1,J) ALTRET(CVM_ERR);
      507    11949    3                END;
      508    11950    2           END;
      509    11951        /**/
      510    11952        /*
      511    11953          ****     RELEASE COMGROUP MAP PAGES WHICH EXCEED THE NUMBER SPECIFED OR
      512    11954          ****     THE DEFAULT. AARDVARK ALWAYS ALLOCATES THE MAXIMUM.
      513    11955        */
      514    11956    1        I = MM_CGQMAP_PGS;
      515    11957    2        DO WHILE (I < %MM_CGQMAX#);
      516    11958    2             CALL MME$WFVP(%MON_WSQ,%CGPGTBLLO+I,0,J);
      517    11959    2             I = I+1;
      518    11960    2           END;
      519    11961        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:16   
      520    11962    2        DO I = 1 TO NK_MXLOCAL;
      521    11963    2             IF NI$IOM$(N$DCT$(I)->NI$DCT.DQH$->NI$DQH.IOCHAN.IOM)->NI$IOM.ADDRESS =
             11963                      IT_CONFIG.IOM.PORT AND
      522    11964    2                  N$DCT$(I)->NI$DCT.DQH$->NI$DQH.IOCHAN.CHANNEL = IT_CONFIG.SC01.CHAN
             11964                           THEN
      523    11965    2                  B_SCDCTX = I;
      524    11966    2           END;
      525    11967
      526    11968    2        IF NOT HW_NORM_CLOCK THEN DO;      /* FIX THE CLOCK, BEFORE ITZ!! */
      527    11969    2             CALL HFC$RSCR ('000000006121'O, 32, XXX_CLOCK);
      528    11970    2             LOCAL_DATE.S1 = '/';
      529    11971    2             LOCAL_DATE.S2 = '/';
      530    11972    2             CALL BINCHAR(LOCAL_DATE.Y, MOD(XXX_CLOCK.DATE.Y,100));
      531    11973    2             CALL BINCHAR(LOCAL_DATE.M, XXX_CLOCK.DATE.M);
      532    11974    2             CALL BINCHAR(LOCAL_DATE.D, XXX_CLOCK.DATE.D);
      533    11975    2             IT_CLOFF='0'B;
      534    11976    2             CALL UMT$LCLDATE (UTS_DATE, LOCAL_DATE, '00:00:00.00');
      535    11977    2             CALL ITG$MPY10000 (IT_CLOFF, UTS_DATE);
      536    11978    2           END;
      537    11979
      538    11980    1        IF  ( IT_BOOTFLAG >= I_DISKBOOT )
      539    11981    2        THEN DO;                           /* DB OR RECOVERY             */
      540    11982    2             CALL ITZ$RECOVER;
      541    11983    3             DO I = 1 TO NK_MXLOCAL;
      542    11984    3                  IF NOT IT_PARTITION.DEVICE(I)
      543    11985    3                       AND NOT IT_PARTITION.MSOS_DEVICE(I)
      544    11986    3                       AND N$DCT$(I)->NI$DCT.TYPE = %DV_MPC
      545    11987    3                       AND N$DCT$(I)->NI$DCT.MPC.FWNAME ~= 'NONE'
      546    11988    4                  THEN DO ;
      547    11989    4                       N$DCT$(I)->NI$DCT.DFLG.MPCSTOP = '0'B ;
      548    11990    4                       CALL NIW$MPCSTOP ( N$DCT$(I)->NI$DCT ) ;
      549    11991    4                       CALL NIW$MPCSTART ( N$DCT$(I)->NI$DCT ) ;
      550    11992    4                     END ;
      551    11993    3                END;
      552    11994    2             CALL IOSPIN ;
      553    11995    2           END ;
      554    11996        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:17   
      555    11997    2        ELSE DO;                           /* NOT DB OR RECOVERY                 */
      556    11998        /**/
      557    11999    2             S_SYSID = JG_MING# + 1;
      558    12000        /**/
      559    12001    2             FR_PRM$(%M_GHOST#) -> FR$PR(FR_DP) = /* SET GHOST MAX TO TOTAL     */
      560    12002    2                  FR_PRM$(0) -> FR$PR(FR_DP);
      561    12003    2             FR_PRM$(%M_GHOST#) -> FR$PR(FR_MT) =
      562    12004    2                  FR_PRM$(0) -> FR$PR(FR_MT);
      563    12005    2             FR_PRM$(%M_GHOST#) -> FR$PR(FR_NPOOL) =
      564    12006    2                  FR_PRM$(0) -> FR$PR(FR_NPOOL);
      565    12007        /**/
      566    12008        /**/
      567    12009    2             PTR$ -> N$DCT$(0) = ADDR(NIL);
      568    12010        /**/
      569    12011    2             I = 1;
      570    12012    3             DO WHILE (N$DCT$$ -> N$DCT$(I) ~= ADDR(NIL));
      571    12013    3                  PTR$ -> N$DCT$(I) = N$DCT$$ -> N$DCT$(I);
      572    12014    3                  I = I+1;
      573    12015    3                END;
      574    12016        /**/
      575    12017    3             DO I = I TO N_DCTXMAX;
      576    12018    3                  PTR$ -> N$DCT$(I) = ADDR(NIL);
      577    12019    3                END;
      578    12020        /**/
      579    12021    2             N$DCT$$ = PTR$;
      580    12022        /**/
      581    12023    2             CALL ITH$ALLOCATE(PTR$,N_DCTXMAX+1) ALTRET(ITW$ALLOC_ERR);
      582    12024    2             IT_SYSDIR$=PTR$;              /* AREA FOR SYSTEM AREA DIRECTORY     */
      583    12025    2             CALL ITH$ALLOCATE(PTR$,SIZEW(I$DISKDIR)) ALTRET(ITW$ALLOC_ERR);
      584    12026        /**/
      585    12027    2             KI_FEI$$ = PTR$;
      586    12028    2             CALL ITH$ALLOCATE(PTR$,1+KI_MXFE) ALTRET(ITW$ALLOC_ERR);
      587    12029    3             DO I = 0 TO KI_MXFE;
      588    12030    3                  KI$FEI$(I) = IT_FEI$$->KI$FEI$(I);
      589    12031    3                END;
      590    12032
      591    12033        /* Allocate the network route table */
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:18   
      592    12034    3             DO I = 0 TO KI_NODES;
      593    12035    3                  KI$ROUTE$(I) = PTR$;
      594    12036    3                  PTR$->KI$ROUTE = '0'B;
      595    12037    3                  PTR$->KI$ROUTE.NODE_NAME = ' ';
      596    12038    3                  PTR$->KI$ROUTE.CURRENT_QOS = 255;
      597    12039    3                  PTR$->KI$ROUTE.ALT_QOS = 255;
      598    12040    4                  DO J = 0 TO KI_MXFE;
      599    12041    4                       PTR$->KI$ROUTE.LINK(J) = '0'B;
      600    12042    4                       PTR$->KI$ROUTE.LINK.QOS(J) = 255;
      601    12043    4                     END;
      602    12044    3                  K = SIZEW(KI$ROUTE)+KI_MXFE*SIZEW(KI$ROUTE.LINK);
      603    12045    3                  CALL ITH$ALLOCATE(PTR$,K);
      604    12046    3                END;
      605    12047
      606    12048        /* Allocate the OSI route tables.
      607    12049        */
      608    12050    3             DO I = 0 TO KI_OSIMAX#-1;
      609    12051    3                  KI$OSIROUTE$(I) = PTR$;
      610    12052    3                  PTR$->KI$OSIROUTE = '0'B;
      611    12053    4                  DO J = 0 TO KI_MXFE;
      612    12054    4                       PTR$->KI$OSIROUTE.LINK(J) = '0'B;
      613    12055    4                     END;
      614    12056    3                  K = SIZEW(KI$OSIROUTE)+KI_MXFE*SIZEW(KI$OSIROUTE.LINK);
      615    12057    3                  CALL ITH$ALLOCATE(PTR$,K);
      616    12058    3                END;
      617    12059
      618    12060        /* Allocate and initialize OSI Session stuff.
      619    12061        */
      620    12062    2             KIS_MINOR$ = PTR$;
      621    12063    2             I = 1 + KIS_SSN_MAX;          /* number of words for minor table */
      622    12064    2             CALL ITH$ALLOCATE( PTR$, I) ALTRET( ITW$ALLOC_ERR);
      623    12065
      624    12066    2             APPL$ = KIS_MINOR$;
      625    12067    3             DO I = 0 TO KIS_SSN_MAX;
      626    12068    3                  APPL$->APPL.TCTX = 0;
      627    12069    3                  APPL$->APPL.Z.COOKIE = 0;
      628    12070    3                  APPL$->APPL.Z.LINK = I + 1;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:19   
      629    12071    3                  APPL$ = PINCRW( APPL$, 1);
      630    12072    3                END;
      631    12073
      632    12074    2             APPL$ = PINCRW( KIS_MINOR$, KIS_SSN_MAX);
      633    12075    2             APPL$->APPL.Z.LINK = 0;
      634    12076
      635    12077    2             KIS_MAJOR$ = PTR$;
      636    12078    2             I = 1 + KIS_SSN_CLIENTS + ( SIZEW(APPL) * KIS_SSN_SERVERS);
             12078                      /* wds for major tbl */
      637    12079    2             CALL ITH$ALLOCATE( PTR$, I) ALTRET( ITW$ALLOC_ERR);
      638    12080
      639    12081    2             KIS_MAJOR$->APPL.SRVRHD = 1;
      640    12082    2             KIS_MAJOR$->APPL.CLNTHD = 1 + ( SIZEW(APPL) * KIS_SSN_SERVERS);
      641    12083    3             DO I = 1 TO KIS_SSN_SERVERS;
      642    12084    3                  APPL$ = PINCRW( KIS_MAJOR$, KIS_MAJOR$->APPL.SRVRHD + SIZEW(APPL) * (
             12084                           I - 1));
      643    12085    3                  APPL$->APPL.LDCTX = 0;
      644    12086    3                  APPL$->APPL.Z.COOKIE = 0;
      645    12087    3                  APPL$->APPL.Z.LINK = SIZEW(APPL) + POFFW( APPL$, KIS_MAJOR$);
      646    12088    3                  APPL$->APPL.TSAP.LEN = 0;
      647    12089    3                  APPL$->APPL.TSAP.TSAP = ' ';
      648    12090    3                  APPL$->APPL.AUDCT = 0;
      649    12091    3                END;
      650    12092
      651    12093    2             APPL$ = PINCRW( KIS_MAJOR$, 1 + ( SIZEW(APPL) * ( KIS_SSN_SERVERS - 1)));
      652    12094    2             APPL$->APPL.Z.LINK = 0;
      653    12095
      654    12096    3             DO I = 1 TO KIS_SSN_CLIENTS;
      655    12097    3                  APPL$ = PINCRW( KIS_MAJOR$, KIS_MAJOR$->APPL.CLNTHD + I - 1);
      656    12098    3                  APPL$->APPL.LDCTX = 0;
      657    12099    3                  APPL$->APPL.Z.COOKIE = 0;
      658    12100    3                  APPL$->APPL.Z.LINK = I + KIS_MAJOR$->APPL.CLNTHD;
      659    12101    3                END;
      660    12102
      661    12103    2             APPL$ = PINCRW(KIS_MAJOR$, KIS_MAJOR$->APPL.CLNTHD + KIS_SSN_CLIENTS -1);
      662    12104    2             APPL$->APPL.Z.LINK = 0;
      663    12105
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:20   
      664    12106    2             KIS_SSN_MAXMINOR = KIS_SSN_MAX;
      665    12107    2             KIS_SSN_MAXMAJOR = KIS_SSN_CLIENTS + (KIS_SSN_SERVERS * SIZEW(APPL));
      666    12108
      667    12109
      668    12110
      669    12111    2             B$P$ = PTR$;
      670    12112        /**/
      671    12113    2             CALL ITH$ALLOCATE(PTR$,SIZEW(B$P) * (P_MAXPROCS+1))  ALTRET(ITW$ALLOC_ERR)
             12113                      ;
      672    12114        /**/
      673    12115    2             B$P$ -> B$P(0) = %NO#;
      674    12116        /**/
      675    12117    3             DO I = 1 TO B$DS6$ -> IT$SPROCDS.COUNT ;
      676    12118    3                  B$P$ -> B$P(I) = %NO#;
      677    12119    3                  B$P$ -> B$P.NAME(I) = B$DS6$ -> IT$SPROCDS.PROCS.NAME(I-1);
      678    12120    3                  B$P$->B$P.ACCT(I) = ':SYS';
      679    12121    3                  B$P$ -> B$P.FLGS(I) = B$DS6$ -> IT$SPROCDS.PROCS.FLGS(I-1);
      680    12122    3                END;
      681    12123        /**/
      682    12124    3             DO I = B$DS6$ -> IT$SPROCDS.COUNT + 1 TO P_MAXPROCS;
      683    12125    3                  B$P$ -> B$P(I) = %NO#;
      684    12126    3                  B$P$->B$P.ACCT(I) = ' ';
      685    12127    3                END;
      686    12128        /**/
      687    12129    2             P_AUTO_START = P_MAXPROCS + 1;
      688    12130    2             P_USED_AUTO = P_AUTO_START;
      689    12131    2             P_AUTOSPACE = MINIMUM (P_AUTOSPACE , 4095 - P_AUTO_START);
      690    12132    2             P_LAST_AUTO = P_AUTO_START + P_AUTOSPACE - 1;
      691    12133        /**/
      692    12134    2             B$LOOKUP$ = PTR$;
      693    12135        /**/
      694    12136    2             CALL ITH$ALLOCATE(PTR$,SIZEW(B$P) * P_AUTOSPACE)  ALTRET(ITW$ALLOC_ERR);
      695    12137    3             DO I = 0 TO P_AUTOSPACE - 1;
      696    12138    3                  B$LOOKUP$->B$P(I) = %NO#;
      697    12139    3                  B$LOOKUP$->B$P.ACCT(I) = ' ';
      698    12140    3                END;
      699    12141        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:21   
      700    12142    2             B$LOOKUP$ = PTR$;
      701    12143        /**/
      702    12144    2             CALL ITH$ALLOCATE(PTR$,P_AUTOSPACE+P_MAXPROCS+1)  ALTRET(ITW$ALLOC_ERR);
      703    12145    3             DO I = 0 TO P_AUTOSPACE + P_MAXPROCS;
      704    12146    3                  B$LOOKUP$->B$LOOKUP(I) = 0;
      705    12147    3                END;
      706    12148        /**/
      707    12149    3             IF HW_WSQ0PT THEN DO;
      708    12150    3                  IT_SCPUWSPTD(0) = B$IPHYMAP$->MM$IPHY_MAP (B$MPT$ -> B$MAP.RPN(%
             12150                           ISEGLO)); /* MASTER WSPTD ADDRESS IN SLOT ZERO */
      709    12151    3                  IT_SCPUJIT(0) = B$IPHYMAP$->MM$IPHY_MAP (B$MPT$ -> B$MAP.RPN(%PGTBLLO
             12151                           )); /* MASTER JIT PAGE  */
      710    12152    3                  IT_SCPUHJIT(0) = B$IPHYMAP$->MM$IPHY_MAP (B$MPT$ -> B$MAP.RPN(%HJITPG
             12152                           )); /* MASTER HJIT      */
      711    12153    3                END;
      712    12154    3             ELSE DO;
      713    12155    3                  IT_SCPUWSPTD(0) = B$MPT$ -> B$MAP.RPN(%ISEGLO);
             12155                           /* MASTER WSPTD ADDRESS IN SLOT ZERO */
      714    12156    3                  IT_SCPUJIT(0) = B$MPT$ -> B$MAP.RPN(%PGTBLLO); /* MASTER JIT PAGE  */
      715    12157    3                  IT_SCPUHJIT(0) = B$MPT$ -> B$MAP.RPN(%HJITPG); /* MASTER HJIT      */
      716    12158    3                END;
      717    12159        /**/
      718    12160    2             REQ$ = B$DS2$;
      719    12161    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */
      720    12162        /**/
      721    12163    2             REQ$ = B$DS3$;
      722    12164    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */
      723    12165        /**/
      724    12166    2             REQ$ = B$DS4$;
      725    12167    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */
      726    12168        /**/
      727    12169    2             REQ$ = B$DS5$;
      728    12170    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */
      729    12171        /**/
      730    12172    2             REQ$ = B$DS6$;
      731    12173    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */
      732    12174        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:22   
      733    12175    2             MM_HELD = MM_RDS(0) + MM_RDS(1) + MM_RDS(2) + MM_RDS(3) +
      734    12176    2                  MM_RDS(4) + MM_RDS(5) + MM_RDS(6) + MM_RDS(7); /* TOTAL HELD PAGES */
      735    12177        /**/
      736    12178    3             IF (B_SCDCTX = 0) THEN DO;    /* NO CONSOLE                         */
      737    12179    3                  CALL ITE$ERROR(%E$NOCONSOLE);
      738    12180    3                  CALL ITF$FREEZE;
      739    12181    3                END;
      740    12182        /**/
      741    12183    3             IF (FR_PRM$(0) -> FR$PR(FR_DP) = 0) THEN DO; /* NO DISK            */
      742    12184    3                  CALL ITE$ERROR(%E$NODISK);
      743    12185    3                  CALL ITF$FREEZE;
      744    12186    3                END;
      745    12187        /**/
      746    12188    3             IF (FR_PRM$(0) -> FR$PR(FR_MT) = 0) THEN DO; /* NO TAPE            */
      747    12189    3                  CALL ITE$ERROR(%E$NOTAPE);
      748    12190    3                  CALL ITF$FREEZE;
      749    12191    3                END;
      750    12192        /**/
      751    12193    3             IF HW_IOP THEN DO;
      752    12194    3                  NI_MBX_INIT.LPW = '000000023777'O;
      753    12195    3                  NI_MBX_INIT.SCW = '000000100000'O;
      754    12196    3                  H_ENMASK = '777777777760'O;
      755    12197    3                END;
      756    12198        /**/
      757    12199    3             DO I=0 TO NI_IOMS-1;
      758    12200    3                  NI_CHANS(I)=0;
      759    12201    4   CHANLP:        DO J=%N_MAXCHANS-1 DOWNTO 0;
      760    12202    5                       IF NI$CHT$->NI$CHT.DQH$(I*%N_MAXCHANS+J) ~= ADDR(NIL) THEN DO;
      761    12203    5                            NI_CHANS(I)=J;
      762    12204    5                            EXIT CHANLP;
      763    12205    5                          END;
      764    12206    4                     END;
      765    12207    3                END;
      766    12208    2             NI_MAX_CHANS = NI_IOMS*%N_MAXCHANS;
      767    12209        /**/
      768    12210    3             DO I = 0 TO NI_IOMS-1;
      769    12211    3                  IF NI$IOM$(I) ~= ADDR(NIL) THEN IF NI$IOM$(I)->NI$IOM.ADDRESS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:23   
      770    12212    3                            = FM_SYSDP.PORT THEN
      771    12213    3                            GOTO GOTSIOM;
      772    12214    3                END;
      773    12215    2             GOTO GTT;
      774    12216    2   GOTSIOM:  IF NI$CHT$->NI$CHT.DQH$(I*%N_MAXCHANS+FM_SYSDP.CHN) = ADDR(NIL) THEN
      775    12217    2                  GOTO GTT;
      776    12218    2             SQH$=NI$CHT$->NI$CHT.DQH$(I*%N_MAXCHANS+FM_SYSDP.CHN)->NI$DQH.SQH$;
      777    12219    3             DO I = SQH$->NI$SQH.FDCT TO SQH$->NI$SQH.FDCT+SQH$->NI$SQH.NDCT-1;
      778    12220    3                  IF N$DCT$(I)->NI$DCT.DVN = FM_SYSDP.DVN AND N$DCT$(I)->NI$DCT.TYPE=%
             12220                           DV_DP THEN
      779    12221    4                  DO;
      780    12222    4                       IT_SYSDISK=I;
      781    12223    4                       GOTO GOTSYSDISK;
      782    12224    4                     END;
      783    12225    3                END;
      784    12226    2   GTT:      ;
      785    12227    2             CALL ITE$ERROR(%E$NOSYSDISK);
      786    12228    2             CALL ITF$FREEZE;
      787    12229        /**/
      788    12230    2   GOTSYSDISK: IF (IT_BOOTFLAG = I_VOLONLY) THEN GOTO STARTGHOST1;
      789    12231    2           END;
      790    12232        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:24   
      791    12233        /*
      792    12234                SURVEY OF STORE UNITS ON SYSTEM.  BUILD H_STOREUNIT,
      793    12235                H_CPU_CONFIG, H_SCU_CONFIG, H_SCU_BF, AND H_CPU_BF
      794    12236                TABLES IN MONITOR STATIC.
      795    12237        */
      796    12238    1        IF H_S1000_FLG THEN CALL HFC$RCONF (H_S1000_CONFIG);
      797    12239    2        IF H_RPM_FLG THEN DO;
      798    12240    2             CALL HFC$RSCR(B$SCU$,8,H_DPS8000_SCU_CONF_REG);
      799    12241    2             CALL HFC$RCONF_8000;
      800    12242    2           END;
      801    12243    1        H_CPU_CONFIG = H_RSW1(S_PNO);      /* CPU PORT CONFIG SWITCHES           */
      802    12244    1        STOREUNIT#=0;                 /* INDEX INTO 16 WORD H_STOREUNIT TABLE    */
      803    12245    1        H_MAXPORT# = -1;
      804    12246    1        RSW2 = H_RSW2(S_PNO);
      805    12247    1        IF S_PTYPE(S_PNO)=%ELS1
      806    12248    1        THEN MAX_NUM_PORTS=2;
      807    12249    1        ELSE MAX_NUM_PORTS=4;
      808    12250    2        DO PORT# = 0 TO MAX_NUM_PORTS-1;
      809    12251    2             CPU_CONFIG=H_CPU_CONFIG(PORT#);
      810    12252    2             IF CPU_CONFIG.PORT_ENABLE
      811    12253    3             THEN DO;
      812    12254    4                  DO CASE (S_PTYPE(S_PNO));
      813    12255    4                  CASE (%L66);
      814    12256    4                     PORT_MEM_SIZE = L66_CPU_MEM_SIZE(CPU_CONFIG.SIZE);
      815    12257    4                     H_CPU_BF(PORT#) = L66_CPU_BF(CPU_CONFIG.SIZE);
      816    12258    4                     IF RSW2.L66_SIZE_MULT(PORT#) = '1'B
      817    12259    5                     THEN DO;
      818    12260    5                          PORT_MEM_SIZE = PORT_MEM_SIZE * 16;
      819    12261    5                          H_CPU_BF(PORT#) = H_CPU_BF(PORT#) - 4;
      820    12262    5                        END;
      821    12263    4                  CASE (%DPSE,%ELS1);
      822    12264    4                     PORT_MEM_SIZE=DPSE_ELS1_CPU_MEM_SIZE(CPU_CONFIG.SIZE);
      823    12265    4                     H_CPU_BF(PORT#)=DPSE_ELS1_CPU_BF(CPU_CONFIG.SIZE);
      824    12266    4                  CASE (ELSE);
      825    12267    4                     PORT_MEM_SIZE=0;
      826    12268    4                     H_CPU_BF(PORT#)=0;
      827    12269    4                  END;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:25   
      828    12270    3                  IF CPU_CONFIG.INTERLACE
      829    12271    3                       AND (MOD(CPU_CONFIG.PORT_ASSIGN,2)~=0)
      830    12272    4                  THEN DO;
      831    12273        /*
      832    12274                         CPU INTERLACE AND START ADDRESS IS ODD
      833    12275        */
      834    12276    4                       IF S_PTYPE(S_PNO) = %DPSE
      835    12277    4                            AND RSW2.DPSE_2WAY(PORT#) = '1'B
      836    12278    4                       THEN CPU_INTL = 2;
      837    12279    4                       ELSE CPU_INTL = 4;
      838    12280    4                       PORT_START_ADDR=
      839    12281    4                            PORT_MEM_SIZE*(CPU_CONFIG.PORT_ASSIGN-1)+CPU_INTL;
      840    12282    4                       RSCR_ADDR=8+CPU_INTL; /* FOR HFC$RSCR CALL                  */
      841    12283    4                     END;
      842    12284    4                  ELSE DO;
      843    12285        /*
      844    12286                         NO CPU INTERLACE OR START ADDRESS IS EVEN
      845    12287        */
      846    12288    4                       PORT_START_ADDR=
      847    12289    4                            PORT_MEM_SIZE*CPU_CONFIG.PORT_ASSIGN;
      848    12290    4                       RSCR_ADDR=8;        /* FOR HFC$RSCR CALL                  */
      849    12291    4                     END;
      850    12292    3                  H_MAXPORT# = H_MAXPORT#+1;
      851    12293    3                  H_PORT_FIRST_ADDR(H_MAXPORT#)=PORT_START_ADDR;
      852    12294    3                  CALL MME$CVM(%MONWSQ,%WINDOWLO,PORT_START_ADDR/1024,ERRCDE);
      853    12295    3                  CALL HFC$RSCR(B$WINDOW$,RSCR_ADDR,SCU_CONFIG);
      854    12296    3                  H_SCU_CONFIG(PORT#)=SCU_CONFIG;
      855    12297    3                  LOWER_STORE_SIZE=SCU_MEM_SIZE(SCU_CONFIG.SIZE);
      856    12298    3                  H_SCU_BF(PORT#)=SCU_BF(SCU_CONFIG.SIZE);
      857    12299    3                  SU.ONLINE_REDEF=SCU_CONFIG.ON_LINE;
      858    12300    4                  DO SU# = 0 TO 3;         /* DO FOR ALL STORAGE UNITS ON SCU    */
      859    12301                                 /* If the B is the lower bank change the logical Su# */
      860    12302    4                       IF SCU_CONFIG.LOWER_STORE
      861    12303    4                       THEN
      862    12304    4                            IF SU# < 2
      863    12305    4                            THEN
      864    12306    4                                 LOG_SU# = SU#+2;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:26   
      865    12307    4                            ELSE
      866    12308    4                                 LOG_SU# = SU# - 2;
      867    12309    4                       ELSE
      868    12310    4                            LOG_SU# = SU#;
      869    12311
      870    12312    4                       IF SU.ONLINE(SU#)
      871    12313    5                       THEN DO;
      872    12314    5                            IF (NOT SCU_CONFIG.INTERLACE) OR (LOG_SU#<2)
      873    12315    6                            THEN DO;
      874    12316        /*
      875    12317                               NO SCU INTERLACE OR LOWER STORE PAIR
      876    12318        */
      877    12319    6                                 H_STOREUNIT.FIRST_ADDR(STOREUNIT#)=PORT_START_ADDR
      878    12320    6                                      + LOWER_STORE_SIZE*LOG_SU#/2;
      879    12321    6                               END;
      880    12322    6                            ELSE DO;
      881    12323        /*
      882    12324                               SCU INTERLACE AND UPPER STORE PAIR
      883    12325        */
      884    12326    6                                 H_STOREUNIT.FIRST_ADDR(STOREUNIT#)=PORT_START_ADDR
      885    12327    6                                      + (LOWER_STORE_SIZE*(LOG_SU#-2)/2)+2;
      886    12328    6                               END;
      887    12329    5                            H_STOREUNIT.PORT#(STOREUNIT#)=PORT#;
      888    12330    5                            IF SCU_CONFIG.LOWER_STORE
      889    12331    5                            THEN H_STOREUNIT.STORE_UNIT#(STOREUNIT#)=B_LOW(SU#);
      890    12332    5                            ELSE H_STOREUNIT.STORE_UNIT#(STOREUNIT#)=A_LOW(SU#);
      891    12333    5                            H_MAXSU#=STOREUNIT#;
      892    12334    5                            STOREUNIT#=STOREUNIT#+1;
      893    12335    5                          END;
      894    12336    4                     END;
      895    12337    3                END;
      896    12338    2           END;
      897    12339        /**/
      898    12340    1        H_MEMOK = '1'B;                    /* NOW, ENAPORT CAN DO ALL STUFF */
      899    12341    1        CALL HFB$INITMASK;            /* MAKE H_PORTMASK THE REAL SCU PORT MASK  */
      900    12342    1        IF IT_BOOTFLAG >= I_RECOVERY THEN GOTO STARTGHOST1;
      901    12343        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:27   
      902    12344        /**/
      903    12345    1        CALL NIM$WRENBL(IT_DBUF,IT_DBUFEND); /* UNWRITE PROTECT BUFFER        */
      904    12346
      905    12347    1        IT_DATASIZE = POFFW (PTR$,B$TIGR$);
      906    12348
      907    12349                                                /* COMPUTE SIZE OF TIGRDATA
      908    12350                                                     FOR TIGRCUB.X */
      909    12351    1        IF IT_TIGRCUB THEN GOTO STARTGHOST1;
      910    12352        /**/
      911    12353    1        DBUF$ = ADDR(IT_DBUF);
      912    12354        /**/
      913    12355    1        CALL ITQ$DREAD(DBUF$,VIDDA) ALTRET (DISK_ERR);
      914    12356        /**/
      915    12357    1        MIN_DA = DBUF$ -> FM$VID.SYSSIZE - 1;
      916    12358    1        DIR_DA = DBUF$ -> FM$VID.SYSDIRDA;
      917    12359        /**/
      918    12360    1        CALL ITH$READ_VERIFY_SAD(DBUF$,DIR_DA) ALTRET (DISK_ERR);
      919    12361    1        IT_SYSDIR$->I$DISKDIR=DBUF$->I$DISKDIR;
      920    12362        /**/
      921    12363    1        MONDATA_DA = DBUF$ -> I$DISKDIR.MONDATA.DA;
      922    12364    1        MONDATA_SIZE = DBUF$ -> I$DISKDIR.MONDATA.SIZE;
      923    12365        /**/
      924    12366    1        TIGRDATA_DA = DBUF$ -> I$DISKDIR.TIGRDATA.DA;
      925    12367    1        LOWREAL_DA = DBUF$ -> I$DISKDIR.LOWREAL.DA;
      926    12368        /**/
      927    12369    1        MAX_DA = DBUF$ -> I$DISKDIR.AARDVARK.DA;
      928    12370        /**/
      929    12371    1        I = 0;                             /* SAVE FW DATA                       */
      930    12372    2        DO WHILE (DBUF$ -> I$DISKDIR.FW.NAMEBIN(I) ~= 0);
      931    12373    2             FW(I) = DBUF$ -> I$DISKDIR.FW(I);
      932    12374    2             I = I+1;
      933    12375    2           END;
      934    12376    1        FWSLOTS = I;
      935    12377    1        FW(I) = '0'B;
      936    12378        /**/
      937    12379    1        DBUF$->I$DISKDIR.MONID.M.VER=DBUF$->I$DISKDIR.MONID.A.VER;
      938    12380    1        I=DBUF$->I$DISKDIR.MONID.A.BOOTC;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:28   
      939    12381    2        DO WHILE (I>61);
      940    12382    2             I=I-61;
      941    12383    2           END;
      942    12384    1        DBUF$->I$DISKDIR.MONID.M.BOOTC = RV_BOOTID.C(I);
      943    12385    1        B_SITEINFO.VERSION# = DBUF$ -> I$DISKDIR.MONID.M_CHAR4;
      944    12386        /**/
      945    12387    1        CALL ITQ$DWRITE(DBUF$,DIR_DA) ALTRET(DISK_ERR);
      946    12388        /**/
      947    12389    1        CALL ITQ$DREAD(DBUF$,DBUF$ -> I$DISKDIR.SITEINFO.DA) ALTRET(DISK_ERR);
      948    12390        /**/
      949    12391    1        B_SITEINFO.MON_UTS# = DBUF$ -> B$SITEINFO.MON_UTS#;
      950    12392    1        B_SITEINFO.MINI_ID# = DBUF$ -> B$SITEINFO.MINI_ID#;
      951    12393    1        IF (B_SITEINFO.SITE_NAME#.L = 0) THEN
      952    12394    1             B_SITEINFO.SITE_NAME# = DBUF$ -> B$SITEINFO.SITE_NAME#;
      953    12395    1        IF (B_SITEINFO.SALUTATION#.L = 0) THEN
      954    12396    1             B_SITEINFO.SALUTATION# = DBUF$ -> B$SITEINFO.SALUTATION#;
      955    12397    1        IF (B_SITEINFO.SITE_ID# = ' ') THEN
      956    12398    1             B_SITEINFO.SITE_ID# = DBUF$ -> B$SITEINFO.SITE_ID#;
      957    12399        /**/
      958    12400    1        REQ$ = B$DS1$;                     /* GET DS1 FOR FW                     */
      959    12401    1        MM_DSMAX(0) = MAXFWSIZE;           /* LET IT GROW                        */
      960    12402    1        CALL MMH$GDS(%MONWSQ,REREQ$.SEGID,MAXFWSIZE*1024,J) ALTRET(NO_FW);
      961    12403        /**/
      962    12404    1        S_TIMR=2;                          /* SET TO MONITOR EXECUTION           */
      963    12405    1        IF  HW_IMX
      964    12406    2        THEN DO ;
      965    12407    2             CALL ITK$TMB$BUF_ALLOC(BUF$,BUFX) ALTRET(CONFIG_ERR);
      966    12408    3             DO I = 0 TO NI_IOMS-1;
      967    12409    3                  IF NOT IT_PARTITION.IOCHAN(I*%N_MAXCHANS)
      968    12410    4                  THEN DO ;
      969    12411    4                       CALL ITK$TMB$MCA(N$DCT$(NI_MAINT_DCTX(I))->NI$DCT.DQH$->NI$DQH,
             12411                                TM_OC_CONFIG#,BUFX)
      970    12412    5                       WHENALTRETURN DO ;
      971    12413    5                            CALL ITK$TMB$BUF_DEALLOC (BUF$,BUFX);
      972    12414    5                            GOTO CONFIG_ERR;
      973    12415    5                          END ;
      974    12416    5                       DO IPC = 0 TO 15;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:29   
      975    12417    5                            DQH$ = ADDR(NIL);
      976    12418    5                            IF MCA_CFG.LEVEL_1.STATE(IPC) > 7
      977    12419    6                            THEN DO ;
      978    12420    6                                 CHAN = I * %N_MAXCHANS + MCA_CFG.LEVEL_1.PRI_CHN(IPC);
      979    12421    7                                 DO J = CHAN TO (CHAN + MCA_CFG.LEVEL_1.LOG_CHNS(IPC)-1
             12421                                          );
      980    12422    7                                      DQH$ = NI$CHT$ -> NI$CHT.DQH$(J);
      981    12423    7                                      IF DQH$ ~= ADDR(NIL)
      982    12424    7                                      THEN
      983    12425    7                                           DQH$->NI$DQH.IPCNUM = IPC;
      984    12426    7                                    END ;
      985    12427    6                               END ;
      986    12428    5                          END ;
      987    12429    5                       DO CHAN = 8 TO %N_MAXCHANSM1 ;
      988    12430    5                            J = I * %N_MAXCHANS + CHAN ;
      989    12431    5                            DQH$ = NI$CHT$ -> NI$CHT.DQH$(J) ;
      990    12432    5                            IF DQH$ ~= ADDR(NIL)
      991    12433    6                            THEN DO ;
      992    12434    6                                 MPC$ = DQH$->NI$DQH.MPC$ ;
      993    12435    6                                 SQH$ = DQH$->NI$DQH.SQH$ ;
      994    12436    6                                 IF DQH$->NI$DQH.IPCNUM = 0
      995    12437    6                                 THEN
      996    12438    6                                      IF SQH$ = ADDR(NIL)
      997    12439    7                                      THEN DO ;
      998    12440    7                                           DQH$->NI$DQH.STATUS.DOWN = '1'B ;
      999    12441    7                                           DQH$->NI$DQH.STATUS.MSOS_PART = '1'B ;
     1000    12442    7                                           K = DQH$->NI$DQH.FEX ;
     1001    12443    7                                           CALL KIQ$PARTFEP ( K, KIER_PART ) ;
     1002    12444    7                                         END ;
     1003    12445    6                                      ELSE IF MPC$ ~= ADDR(NIL)
     1004    12446    7                                           THEN MPC_PART: DO ;
     1005    12447    7                                      DQH$->NI$DQH.STATUS.DOWN    = '1'B ;
     1006    12448    7                                      DQH$->NI$DQH.STATUS.MSOS_PART = '1'B ;
     1007    12449    8                                      DO J = 0 TO %N_CHANSPERMPCM1 ;
     1008    12450    8                                           K = MPC$->NI$DCT.MPC.IOCHANX(J) ;
     1009    12451    8                                           DQH$ = NI$CHT$->NI$CHT.DQH$(K) ;
     1010    12452    8                                           IF K ~= 0
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:30   
     1011    12453    8                                                AND DQH$ ~= ADDR(NIL)
     1012    12454    8                                                AND NOT DQH$->NI$DQH.STATUS.DOWN
     1013    12455    8                                           THEN
     1014    12456    8                                                EXIT MPC_PART ;
     1015    12457    8                                         END ;
     1016    12458    7                                      MPC$->NI$DCT.STATUS.DOWN    = '1'B ;
     1017    12459    7                                      MPC$->NI$DCT.STATUS.MSOS_PART = '1'B ;
     1018    12460    7                                    END MPC_PART ;
     1019    12461    6                               END ;
     1020    12462    5                          END ;
     1021    12463    4                     END ;
     1022    12464    3                END ;
     1023    12465    2             CALL ITK$TMB$BUF_DEALLOC (BUF$, BUFX);
     1024    12466    3             DO I = 1 TO NK_MXLOCAL ;
     1025    12467    3                  DCT$ = N$DCT$$->N$DCT$(I) ;
     1026    12468    3                  IF DCT$->NI$DCT.TYPE = %DV_MPC
     1027    12469    4                  THEN DEV_PART: DO ;
     1028    12470    4                       SQH$ = DCT$->NI$DCT.SQH$ ;
     1029    12471    5                       DO J = 0 TO %N_MPCSPERSQHM1 ;
     1030    12472    5                            MPC$ = SQH$->NI$SQH.MPC$(J) ;
     1031    12473    5                            IF MPC$ ~= ADDR(NIL)
     1032    12474    6                            THEN DO ;
     1033    12475    7                                 DO SELECT ( MPC$->NI$DCT.DVT$->NI$DVT.MODEL(MPC$->
             12475                                          NI$DCT.MODX) ) ;
     1034    12476    7                                      SELECT ( 'MSP3882', 'MSP3886', 'MSP3991',
             12476                                               'MSP3992' ) ;
     1035    12477    7                                      MPC$->NI$DCT.MPC.FWNAME = 'IFDK' ;
     1036    12478    7                                      SELECT ( 'MTP8225', 'MTP8226', 'MTP8228' ) ;
     1037    12479    7                                      MPC$->NI$DCT.MPC.FWNAME = 'IFTP' ;
     1038    12480    7                                      SELECT ( 'URP8600' ) ;
     1039    12481    7                                      MPC$->NI$DCT.MPC.FWNAME = 'ICRD' ;
     1040    12482    7                                      SELECT ( 'URP8601' ) ;
     1041    12483    7                                      MPC$->NI$DCT.MPC.FWNAME = 'IPR5' ;
     1042    12484    7                                    END ;
     1043    12485    6                                 IF NOT MPC$->NI$DCT.STATUS.DOWN
     1044    12486    6                                 THEN
     1045    12487    6                                      EXIT DEV_PART ;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:31   
     1046    12488    6                               END ;
     1047    12489    5                          END ;
     1048    12490    5                       DO J = SQH$->NI$SQH.FDCT TO (SQH$->NI$SQH.FDCT+SQH$->NI$SQH.NDCT
             12490                                -1) ;
     1049    12491    5                            DCT$ = N$DCT$$->N$DCT$(J) ;
     1050    12492    5                            DCT$->NI$DCT.STATUS.DOWN  = '1'B ;
     1051    12493    5                            DCT$->NI$DCT.STATUS.MSOS_PART = '1'B ;
     1052    12494    5                          END ;
     1053    12495    4                     END DEV_PART ;
     1054    12496    3                END ;
     1055    12497    2           END ;
     1056    12498    1        I = 1;
     1057    12499    2        DO WHILE (N$DCT$$ -> N$DCT$(I) ~= ADDR(NIL));
     1058    12500        /**/
     1059    12501    2   NEXTFWDEV:
     1060    12502    2             DEV$ = N$DCT$$ -> N$DCT$(I);
     1061    12503    3             IF (DEV$ -> NI$DCT.TYPE = %DV_MPC) THEN DO;
     1062    12504        /**/
     1063    12505        /*
     1064    12506           ***  Get the specified  firmware from the disk -
     1065    12507                and load the MPCs.
     1066    12508        */
     1067    12509        /**/
     1068    12510    3                  IF NOT HW_LOAD_FW OR DEV$->NI$DCT.CTYP = %C_IPC THEN
     1069    12511    3                       GOTO SKIP_FW;
     1070    12512
     1071    12513    4                  DO J = 0 TO FWSLOTS;     /* LOOK FOR FW IN TABLE               */
     1072    12514    5                       IF (FW.NAME(J) = DEV$ -> NI$DCT.MPC.FWNAME) THEN DO;
     1073    12515    5                            FWDA = FW.DA(J);
     1074    12516    5                            FWSIZE = FW.CS0SIZE(J) + FW.MM0SIZE(J);
     1075    12517    5                            NI$FW = '0'B;
     1076    12518    5                            NI$FW.FWDA = FW.DA(J);
     1077    12519    5                            NI$FW.FWOL(0) = FW.CS0SIZE(J);
     1078    12520    5                            NI$FW.FWOL(1) = FW.MM0SIZE(J);
     1079    12521    5                            REQ$ = ADDR(NI$FW.FW);
     1080    12522    5                            CALL FW_MOVE ALTRET(DISK_ERR);
     1081    12523    5                            DEV$ -> NI$DCT.MPC.FW$ = B$DS1$;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:32   
     1082    12524    5                            CUR_FWSLOT = J;
     1083    12525    5                            GOTO GOTFW;
     1084    12526    5                          END;
     1085    12527    4                     END;
     1086    12528    3                  IF DEV$->NI$DCT.MPC.FWNAME = 'NONE' THEN
     1087    12529    3                       GOTO FWNONE;
     1088    12530    3                  SUB_BUF.COUNT = SIZEC(NI$DCT.MPC.FWNAME);
     1089    12531    3                  SUB_BUF.TEXT = DEV$ -> NI$DCT.MPC.FWNAME;
     1090    12532    3                  CALL ITE$ERROR (%E$CANTFINDFW,ADDR(SUB_BUF));
     1091    12533    3                  CALL ITF$FREEZE;
     1092    12534        /**/
     1093    12535        /*
     1094    12536           ***  Got the FW. If this is the system disk MPC and a tape BOOT
     1095    12537                then put the FW in the TIGR data area in case of disaster.
     1096    12538        */
     1097    12539        /**/
     1098    12540    3   GOTFW:
     1099    12541        /**/
     1100    12542        /*
     1101    12543           ***  If this is a UNIT record MPC then get the two FW overlays.
     1102    12544        */
     1103    12545        /**/
     1104    12546    4                  IF (DEV$ -> NI$DCT.MPC.TYPE = %DV_LP) THEN DO;
     1105    12547    4   NEXTLPFW:
     1106    12548    5                       DO J = 0 TO FWSLOTS;
     1107    12549    6                            IF (FW.NAME(J) = DEV$ -> NI$DCT.MPC.LPNAME) THEN DO;
     1108    12550    6                                 FWDA = FW.DA(J);
     1109    12551    6                                 FWSIZE = FW.CS0SIZE(J);
     1110    12552    6                                 NI$FW.LPDA = FW.DA(J);
     1111    12553    6                                 NI$FW.FWOL(2) = FW.CS0SIZE(J);
     1112    12554    6                                 CALL FW_MOVE ALTRET (DISK_ERR);
     1113    12555    6                                 GOTO NEXTCRPFW;
     1114    12556    6                               END;
     1115    12557    5                          END;
     1116    12558        /**/
     1117    12559    4                       SUB_BUF.COUNT = SIZEC(NI$DCT.MPC.LPNAME);
     1118    12560    4                       SUB_BUF.TEXT = DEV$ -> NI$DCT.MPC.LPNAME;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:33   
     1119    12561    4                       CALL ITE$ERROR(%E$CANTFINDFW,ADDR(SUB_BUF));
     1120    12562    4                       CALL ITF$FREEZE;
     1121    12563        /**/
     1122    12564    4   NEXTCRPFW:
     1123    12565    5                       DO J = 0 TO FWSLOTS;
     1124    12566    6                            IF (FW.NAME(J) = DEV$ -> NI$DCT.MPC.CRPNAME) THEN DO;
     1125    12567    6                                 FWDA = FW.DA(J);
     1126    12568    6                                 FWSIZE = FW.CS0SIZE(J);
     1127    12569    6                                 NI$FW.CRPDA = FW.DA(J);
     1128    12570    6                                 NI$FW.FWOL(3) = FW.CS0SIZE(J);
     1129    12571    6                                 CALL FW_MOVE ALTRET (DISK_ERR);
     1130    12572    6                                 GOTO GOTCRPFW;
     1131    12573    6                               END;
     1132    12574    5                          END;
     1133    12575        /**/
     1134    12576    4                       SUB_BUF.COUNT = SIZEC(NI$DCT.MPC.CRPNAME);
     1135    12577    4                       SUB_BUF.TEXT = DEV$ -> NI$DCT.MPC.CRPNAME;
     1136    12578    4                       CALL ITE$ERROR(%E$CANTFINDFW,ADDR(SUB_BUF));
     1137    12579    4                       CALL ITF$FREEZE;
     1138    12580        /**/
     1139    12581        /*
     1140    12582           ***  Now we have the UNIT record FW ready to go except the first
     1141    12583                of the two overlays has to have bits set to indicate which
     1142    12584                channels have what sorts of devices on them.
     1143    12585        */
     1144    12586        /**/
     1145    12587    4   GOTCRPFW:
     1146    12588    4                       BASE_CHAN = DEV$ -> NI$DCT.MPC.IOCHAN.CHAN(0);
     1147    12589    4                       LP_WORD = 0;
     1148    12590    4                       CRCP_WORD = 0;
     1149    12591    4                       IF DEV$ -> NI$DCT.MPC.FWNAME = 'UCMN'
     1150    12592    4                       THEN OFFSET = 1;
     1151    12593    4                       ELSE OFFSET = 5;
     1152    12594        /**/
     1153    12595    5                       DO J = 1 TO DEV$ -> NI$DCT.SQH$ -> NI$SQH.NDCT - 1;
     1154    12596    5                            USER$ = N$DCT$$ -> N$DCT$(I+J);
     1155    12597    5                            DEV_CHAN = USER$ -> NI$DCT.DQH$ -> NI$DQH.IOCHAN.CHANNEL;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:34   
     1156    12598    5                            IF (USER$ -> NI$DCT.TYPE = %DV_LP) THEN
     1157    12599    5                                 LP_WORD_BITS(DEV_CHAN - BASE_CHAN + OFFSET) = %YES#;
     1158    12600    5                            ELSE CRCP_WORD_BITS(DEV_CHAN - BASE_CHAN + OFFSET) = %YES#;
     1159    12601    5                          END;
     1160    12602        /**/
     1161    12603    4                       DEV$ -> NI$DCT.MPC.LPCHANS = BINBIT(LP_WORD,36);
     1162    12604    4                       DEV$ -> NI$DCT.MPC.CRPCHANS = BINBIT(CRCP_WORD,36);
     1163    12605    5                       IF DEV$->NI$DCT.MPC.FWNAME='URTP' THEN DO;
     1164    12606    5                            CALL CONCAT(DEVNM,'TC',SUBSTR(DEV$->NI$DCT.DEVNM,2));
     1165    12607    6                            DO J=1 TO NK_MXLOCAL;
     1166    12608    7                                 IF N$DCT$$->N$DCT$(J)->NI$DCT.DEVNM=DEVNM THEN DO;
     1167    12609    7                                      REQ$=N$DCT$$->N$DCT$(J);
     1168    12610    8                                      IF REQ$->NI$DCT.MPC.FWNAME='TPUR' THEN DO;
     1169    12611    8                                           REQ$->NI$DCT.MPC.ALTMPCX=I;
     1170    12612    8                                           DEV$->NI$DCT.MPC.ALTMPCX=J;
     1171    12613    8                                         END;
     1172    12614    7                                      J=NK_MXLOCAL+1;
             12614                                               /* EXIT LOOP                        */
     1173    12615    7                                    END;
     1174    12616    6                               END;
     1175    12617    5                          END;
     1176    12618    4                     END;
     1177    12619        /**/
     1178    12620        /*
     1179    12621           ***  Now call NIW$LDFW to load FW.
     1180    12622        */
     1181    12623        /**/
     1182    12624    3   SKIP_FW:       ;
     1183    12625    3                  IF NOT HW_LOAD_FW THEN
     1184    12626    3                       IF DEV$->NI$DCT.MPC.FWNAME ~= 'NONE' AND
     1185    12627    3                            NOT IT_PARTITION.DEVICE(I) AND NOT IT_PARTITION.MSOS_DEVICE
             12627                                     (I) THEN
     1186    12628    4                       DO;
     1187    12629    4                            DEV$->NI$DCT.DFLG.MPCSTOP = '1'B;
     1188    12630    4                            CALL NIW$MPCSTART (DEV$->NI$DCT);
     1189    12631    4                          END;
     1190    12632    3                       ELSE ;              /* Don't call MPCSTART for UCnn */
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:35   
     1191    12633    3                  ELSE
     1192    12634    3                       IF NOT IT_PARTITION.DEVICE(I) AND NOT IT_PARTITION.MSOS_DEVICE(I
             12634                                ) THEN
     1193    12635    3                            CALL NIW$LDFW(DEV$ -> NI$DCT,'1'B);
     1194    12636    3                  IF (DEV$ -> NI$DCT.MPC.FW$ = B$DS1$) THEN
     1195    12637    3                       DEV$ -> NI$DCT.MPC.FW$ = ADDR(NIL);
     1196    12638    3                  IF DEV$->NI$DCT.SQH$ = N$DCT$(IT_SYSDISK)->NI$DCT.SQH$ THEN
     1197    12639    3                       CALL IOSPIN ;
     1198    12640    3                END;
     1199    12641        /**/
     1200    12642    2   FWNONE:   I = I+1;
     1201    12643    2           END;
     1202    12644    1        CALL IOSPIN ;
     1203    12645        /**/
     1204    12646    1        REQ$=B$DS1$;
     1205    12647    1        CALL MMH$FDS(%MONWSQ,REREQ$.SEGID,MM_DSMAX(0)*1024,J);
     1206    12648        /**/
     1207    12649    1        MM_DSMAX = IT_MMDSMAX;             /* RESTORE SAVED DATA                 */
     1208    12650        /**/
     1209    12651    1        IF (IT_BOOTFLAG >= I_DISKBOOT) THEN GOTO FWDONE; /* DONT WRITE DISK ON DB */
     1210    12652        /**/
     1211    12653    1        REQ$ = B$REAL$;
     1212    12654        /**/
     1213    12655    2        DO J=0 TO 7;                       /* LOW REAL */
     1214    12656    2             REREQ$.OFFSET = J * 1024;     /* WRITE DATA PAGE                    */
     1215    12657    2             DBUF$ -> B$PAGE = REQ$ -> B$PAGE;
     1216    12658        /**/
     1217    12659    2             CALL ITQ$DWRITE(DBUF$,LOWREAL_DA) ALTRET(DISK_ERR);
     1218    12660    2             LOWREAL_DA = LOWREAL_DA + 1;
     1219    12661    3             IF LOWREAL_DA > MIN_DA THEN DO;
     1220    12662    3                  CALL ITE$ERROR(%E$SYS2SMALL);
     1221    12663    3                  CALL ITF$FREEZE;
     1222    12664    3                END;
     1223    12665        /**/
     1224    12666    2           END;
     1225    12667    1        REQ$ = B$IS$;                      /* USE REQ$ AS PTR TO PAGE            */
     1226    12668        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:36   
     1227    12669    2        DO J = 0 TO (MONDATA_SIZE/1024)-1;
     1228    12670    2             REREQ$.OFFSET = J * 1024;     /* WRITE DATA PAGE                    */
     1229    12671    2             CALL ITQ$DWRITE(REQ$,MONDATA_DA) ALTRET(DISK_ERR);
     1230    12672        /**/
     1231    12673    2             MONDATA_DA = MONDATA_DA + 1;
     1232    12674    3             IF MONDATA_DA > MIN_DA THEN DO;
     1233    12675    3                  CALL ITE$ERROR(%E$SYS2SMALL);
     1234    12676    3                  CALL ITF$FREEZE;
     1235    12677    3                END;
     1236    12678    2           END;
     1237    12679        /**/
     1238    12680    1        REQ$ = PTR$;
     1239    12681    1        I = REREQ$.OFFSET/1024;
     1240    12682        /**/
     1241    12683    1        REQ$ = B$TIGR$;
     1242    12684    1        IT_DATASIZE = (I+1)*1024;
     1243    12685    2        DO J = 0 TO I;
     1244    12686    2             REREQ$.OFFSET = J*1024;
     1245    12687    2             DBUF$ -> B$PAGE = REQ$ -> B$PAGE;
     1246    12688        /**/
     1247    12689    2             CALL ITQ$DWRITE(DBUF$,TIGRDATA_DA) ALTRET(DISK_ERR);
     1248    12690        /**/
     1249    12691    2             TIGRDATA_DA = TIGRDATA_DA + 1;
     1250    12692    3             IF TIGRDATA_DA > MIN_DA THEN DO;
     1251    12693    3                  CALL ITE$ERROR(%E$SYS2SMALL);
     1252    12694    3                  CALL ITF$FREEZE;
     1253    12695    3                END;
     1254    12696        /**/
     1255    12697    2           END;
     1256    12698        /**/
     1257    12699    2        IF IT_BOOTFLAG=I_NEWFILES THEN DO;
     1258    12700                                 /* check that there's room for system area in case */
     1259    12701                                                /* it's getting extended */
     1260    12702    2             CALL ITQ$DREAD(DBUF$,VIDDA) ALTRET(DISK_ERR);
     1261    12703    2             IF DBUF$->FM$VID.SECTSTRT(2) < DBUF$->FM$VID.SECTSTRT(3) THEN
     1262    12704    2                  GOTO STOPBOOT;           /* More than 2 sections */
     1263    12705    2             I = DBUF$->FM$VID.SECTSTRT(1);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:37   
     1264    12706    3             IF DBUF$->FM$VID.SECTSTRT(1) < DBUF$->FM$VID.SECTSTRT(2) THEN DO;
     1265    12707    3                  CALL ITQ$DREAD(DBUF$,I) ALTRET(DISK_ERR);
     1266    12708                                                /* only extend over #SYS or scratch */
     1267    12709    3                  IF DBUF$->FM$VID.PSN ~= 'SYS   '
     1268    12710    3                       AND DBUF$->FM$VID.VOLCNT ~= 0 THEN
     1269    12711    3                       GOTO STOPBOOT;
     1270    12712    3                END;
     1271    12713    2             MIN_DA = TIGRDATA_DA + IT_DUMPSIZE;
     1272    12714    2             CALL ITQ$DREAD(DBUF$,VIDDA) ALTRET (DISK_ERR);
     1273    12715    2             DBUF$ -> FM$VID.SYSSIZE = MIN_DA + 1;
     1274    12716    2             MINI_DATA.OK2WRVID = MINI_DATA.OK2WRVID+1;
     1275    12717    2             CALL ITQ$DWRITE(DBUF$,VIDDA) ALTRET(DISK_ERR);
     1276    12718    2           END;
     1277    12719
     1278    12720    2        IF TIGRDATA_DA + IT_DUMPSIZE > MIN_DA THEN DO;
     1279    12721    2   STOPBOOT: ;
     1280    12722    2             CALL ITE$ERROR(%E$SYS2SMALL);
     1281    12723    2             CALL ITF$FREEZE;
     1282    12724    2           END;
     1283    12725        /**/
     1284    12726    1        CALL ITH$READ_VERIFY_SAD(DBUF$,DIR_DA) ALTRET(DISK_ERR);
     1285    12727        /**/
     1286    12728    1        DBUF$ -> I$DISKDIR.TIGRDATA.SIZE = IT_DATASIZE;
     1287    12729    1        DBUF$ -> I$DISKDIR.DUMP.DA = TIGRDATA_DA;
     1288    12730    1        DBUF$ -> I$DISKDIR.DUMP.SIZE = (MIN_DA - TIGRDATA_DA - 1);
     1289    12731    1        DBUF$ -> I$DISKDIR.DUMP.SCOUNT = 0;
     1290    12732    1        DBUF$ -> I$DISKDIR.DUMP.LDUMP = 0;
     1291    12733    2        DO I=0 TO %RV_SYSDDUMP#-1;
     1292    12734    2             DBUF$ -> I$DISKDIR.RCVR2.DA(I) = 0;
     1293    12735    2           END;
     1294    12736        /**/
     1295    12737    1        CALL ITQ$DWRITE(DBUF$,DIR_DA) ALTRET(DISK_ERR);
     1296    12738        /**/
     1297    12739    1        DBUF$ -> B$PAGE = %NO#;
     1298    12740        /**/
     1299    12741    1        CALL ITQ$DWRITE(DBUF$,TIGRDATA_DA) ALTRET(DISK_ERR);
     1300    12742        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:38   
     1301    12743    1   FWDONE:
     1302    12744    1        CALL NIM$WRDSBL(IT_DBUF,IT_DBUFEND);
     1303    12745        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:39   
     1304    12746    1   STARTGHOST1:
     1305    12747        /* Set RELIOS here, because IOS pkts are not written out on RPM */
     1306    12748    1        IF NI_NUMIOS>NI_NUMIOQ+10 THEN NI_RELIOS = '0'B;
     1307    12749    2        IF CALL_VOLINIT THEN DO;
     1308    12750    3             DO I=1 TO NK_MXLOCAL;
     1309    12751    3                  DEV$=N$DCT$$->N$DCT$(I);
     1310    12752    3                  IF DEV$->NI$DCT.TYPE=%DV_MPC AND DEV$->NI$DCT.MPC.FWNAME ~= 'NONE'
             12752                           AND
     1311    12753    4                       NOT IT_PARTITION.DEVICE(I) THEN DO;
     1312    12754    4                       DEV$->NI$DCT.DFLG.MPCSTOP='1'B;
     1313    12755    4                       CALL NIW$MPCSTART(DEV$->NI$DCT);
     1314    12756    4                     END;
     1315    12757    3                END;
     1316    12758    3             DO WHILE('1'B);
     1317    12759    3                  CALL ITK$VOLINIT;
     1318    12760    3                END;
     1319    12761    2           END;
     1320    12762        /**/
     1321    12763    1        EL_LOGERRS = '1'B;
     1322    12764
     1323    12765    1        FPT_SYSCON.V.FUNCTION#=%PARTITION#;
     1324    12766        /**/
     1325    12767    1        FPT_SYSCON.V.COMPONENT#=%DVC#;
     1326    12768    2        DO I=1 TO NK_MXLOCAL;
     1327    12769    3             IF N$DCT$(I)~=ADDR(NIL) THEN DO;
     1328    12770    3                  IF N$DCT$(I)->NI$DCT.TYPE = %DV_MPC THEN EXIT;
     1329    12771    4                  IF IT_PARTITION.DEVICE(I) THEN DO;
     1330    12772    4                       FPT_SYSCON.V.DEVNM#=N$DCT$(I)->NI$DCT.DEVNM;
     1331    12773    5                       CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR) WHENALTRETURN DO;
     1332    12774    5                            TEXT_C.L = 4;
     1333    12775    5                            TEXT_C.T = N$DCT$(I)->NI$DCT.DEVNM;
     1334    12776    5                            CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));
     1335    12777    5                          END;
     1336    12778    4                     END;
     1337    12779    4                  IF IT_PARTITION.MSOS_DEVICE(I) THEN DO;
     1338    12780    4                       IF N$DCT$(I)->NI$DCT.RAT$~=ADDR(NIL) OR N$DCT$(I)->NI$DCT.DFLG.
             12780                                CONSOLE THEN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:40   
     1339    12781    5                            CALL NKP$PART (N$DCT$(I)->NI$DCT,ERR) WHENALTRETURN DO;
     1340    12782    5                                 TEXT_C.L = 10;
     1341    12783    5                                 TEXT_C.T = N$DCT$(I)->NI$DCT.DEVNM;
     1342    12784    5                                 SUBSTR(TEXT_C.T,5,5) = '*NKP*';
     1343    12785    5                               END;
     1344    12786    4                       N$DCT$(I)->NI$DCT.STATUS.DOWN = '1'B;
     1345    12787    4                       N$DCT$(I)->NI$DCT.STATUS.MSOS_PART = '1'B;
     1346    12788    4                     END;
     1347    12789    3                END;
     1348    12790    2           END;
     1349    12791        /**/
     1350    12792    1        FPT_SYSCON.V.COMPONENT#=%MPC#;
     1351    12793    2        DO I=1 TO NK_MXLOCAL;
     1352    12794    3             IF N$DCT$(I)~=ADDR(NIL) THEN DO;
     1353    12795    3                  IF N$DCT$(I)->NI$DCT.TYPE ~= %DV_MPC THEN EXIT;
     1354    12796    4                  IF IT_PARTITION.DEVICE(I) THEN DO;
     1355    12797    4                       FPT_SYSCON.V.DEVNM#=N$DCT$(I)->NI$DCT.DEVNM;
     1356    12798    5                       CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR) WHENALTRETURN DO;
     1357    12799    5                            TEXT_C.L = 4;
     1358    12800    5                            TEXT_C.T = N$DCT$(I)->NI$DCT.DEVNM;
     1359    12801    5                            CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));
     1360    12802    5                          END;
     1361    12803    4                     END;
     1362    12804    4                  IF IT_PARTITION.MSOS_DEVICE(I) THEN DO;
     1363    12805    4                       N$DCT$(I)->NI$DCT.STATUS.DOWN = '1'B;
     1364    12806    4                       N$DCT$(I)->NI$DCT.STATUS.MSOS_PART = '1'B;
     1365    12807    4                     END;
     1366    12808    3                END;
     1367    12809    2           END;
     1368    12810        /**/
     1369    12811    2        DO I=0 TO NI_IOMS-1;
     1370    12812    3             DO J=8 TO NI_CHANS(I);
     1371    12813    3                  DQH$=NI$CHT.DQH$(I*%N_MAXCHANS+J);
     1372    12814    4                  IF DQH$ ~= ADDR(NIL) THEN DO;
     1373    12815    5                       IF IT_PARTITION.IOCHAN(I*%N_MAXCHANS+J) AND DQH$->NI$DQH.MPC$~=
             12815                                ADDR(NIL) THEN DO;
     1374    12816    5                            FPT_SYSCON.V.IOM#=I;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:41   
     1375    12817    5                            FPT_SYSCON.V.CHAN#=J;
     1376    12818    5                            FPT_SYSCON.V.COMPONENT# = %CHANNEL#;
     1377    12819    6                            CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR)
             12819                                     WHENALTRETURN DO;
     1378    12820    6                                 TEXT_C.L = 10;
     1379    12821    6                                 TEXT_C.T = 'Chan ?-???';
     1380    12822    6                                 CALL BINCHAR(SUBSTR(TEXT_C.T,5,1),I);
     1381    12823    6                                 CALL BINCHAR(SUBSTR(TEXT_C.T,7,3),J);
     1382    12824    6                                 CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));
     1383    12825    6                               END;
     1384    12826    5                          END;
     1385    12827    5                       IF IT_PARTITION.MSOS_IOCHAN(I*%N_MAXCHANS+J) THEN DO;
     1386    12828    5                            DQH$->NI$DQH.STATUS.DOWN = '1'B;
     1387    12829    5                            DQH$->NI$DQH.STATUS.MSOS_PART = '1'B;
     1388    12830    6                            IF DQH$->NI$DQH.SQH$->NI$SQH.CQ$ ~= ADDR(NIL) THEN DO;
     1389    12831                       /* can't MSOS_PART a FEP, so DQH should always have an SQH$ */
     1390    12832    6                                 TDQH$ = DQH$->NI$DQH.SQH$->NI$SQH.CQ$;
     1391    12833    6                                 ONQUEUE = '1'B;
     1392    12834    7                                 DO WHILE ONQUEUE AND TDQH$->NI$DQH.FL$ ~= DQH$;
     1393    12835    7                                      TDQH$ = TDQH$->NI$DQH.FL$;
     1394    12836    7                                      IF TDQH$ = DQH$->NI$DQH.SQH$->NI$SQH.CQ$ THEN
     1395    12837    7                                           ONQUEUE = '0'B;
     1396    12838    7                                    END;
     1397    12839    7                                 IF ONQUEUE THEN DO;
     1398    12840    7                                      DQH$->NI$DQH.SQH$->NI$SQH.CQ$ = TDQH$;
     1399    12841                                           %DEQUEUE (P#=DQH$, Q#=
             12841                                               DQH$->NI$DQH.SQH$->NI$SQH.CQ$);
     1400    12848    7                                    END;
     1401    12849    6                               END;
     1402    12850    5                          END;
     1403    12851    4                     END;
     1404    12852    3                END;
     1405    12853    2           END;
     1406    12854        /**/
     1407    12855    1        FPT_SYSCON.V.COMPONENT# =%FEP##;
     1408    12856    2        DO I=1 TO KI_MXFE;
     1409    12857    2             J = BITBIN(KI_FEI$$->KI$FEI$(I)->KI$FEI.FECH);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:42   
     1410    12858    3             IF IT_PARTITION.IOCHAN(J) THEN DO;
     1411    12859    3                  FPT_SYSCON.V.CHAN# = KI_FEI$$->KI$FEI$(I)->KI$FEI.FEP#;
     1412    12860    4                  CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR) WHENALTRETURN DO;
     1413    12861    4                       TEXT_C.L = 6;
     1414    12862    4                       TEXT_C.T = 'Fep ??';
     1415    12863    4                       CALL BINCHAR(SUBSTR(TEXT_C.T,4,2),I);
     1416    12864    4                       CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));
     1417    12865    4                     END;
     1418    12866    3                END;
     1419    12867    3             IF IT_PARTITION.MSOS_IOCHAN(J) THEN DO;
     1420    12868    3                  DQH$ = NI$CHT.DQH$(J);
     1421    12869    3                  DQH$->NI$DQH.STATUS.DOWN = '1'B;
     1422    12870    3                  DQH$->NI$DQH.STATUS.MSOS_PART = '1'B;
     1423    12871    3                END;
     1424    12872    2           END;
     1425    12873        /**/
     1426    12874    1        FPT_SYSCON.V.COMPONENT# = %IOM##;
     1427    12875    2        DO I = 0 TO NI_IOMS - 1;
     1428    12876    3             IF IT_PARTITION.IOCHAN(I*%N_MAXCHANS) THEN DO;
     1429    12877    3                  FPT_SYSCON.V.IOM# = I;
     1430    12878    4                  CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR) WHENALTRETURN DO;
     1431    12879    4                       TEXT_C.L = 5;
     1432    12880    4                       TEXT_C.T = 'IOM ?';
     1433    12881    4                       CALL BINCHAR (SUBSTR(TEXT_C.T,4,1),I);
     1434    12882    4                       CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));
     1435    12883    4                       CALL ITE$ERROR (%E$TRYAGAIN);
     1436    12884    4                       CALL ITF$FREEZE;     /* can't go on, if unable to partition
     1437    12885                                                    an IOM at this point  */
     1438    12886    4                     END;
     1439    12887    3                END;
     1440    12888    2           END;
     1441    12889        /**/
     1442    12890    1        CALL ITX$INITS;                    /* Initialize FEPS, CQ, MSOS ect. */
     1443    12891    1        CALL ITX$INITS2;                   /* Finish initializing file system   */
     1444    12892        /**/
     1445    12893    1        CALL SSC$MONTIMR(500,ENTADDR(NII$LIP),0); /* START LOST INTERRUPT POLLER */
     1446    12894              /* THEN, START THE EDAC MEMORY CHECKING (NOT USEFUL ON AN S1000) */
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:43   
     1447    12895    1        IF HW_EDAC THEN CALL SSC$MONTIMR(6000,ENTADDR(HFB$EDAC),0);
     1448    12896    1        IF H_RPM_FLG THEN CALL HFC$LCON;
     1449    12897        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:44   
     1450    12898        /**/
     1451    12899        /*  GET READY TO GO TO GHOST1 */
     1452    12900        /**/
     1453    12901    1        CALL SSS$TIME;                     /* START MONITOR EXECUTION TIME       */
     1454    12902    1        I = %JG_GHOST1#;
     1455    12903    1        USER$ = ADDR(B$USRT$ -> B$USER(I));
     1456    12904    1        S_CUIS(%M_GHOST#) = 1;
     1457    12905    1        S_CTUIS = 1;
     1458    12906        /**/
     1459    12907    1        USER$ -> B$U.FLG = %U_RTR;
     1460    12908    1        USER$ -> B$U.PCT = B$JIT$ -> B$JIT.PPC; /* COUNT FOR JIT,HJIT,ROSEG   */
     1461    12909    1        USER$ -> B$U.PT = B$UPT$ -> B$MAP.RPN(0)*(1024/HW_PTB_UNITS);
             12909                 /* PAGE TABLE ADDRESS    */
     1462    12910    1        USER$ -> B$U.PRIOB = S_PRIOB(%M_GHOST#)+4; /* HELP GHOST1 RUN FASSSST */
     1463    12911    1        USER$ -> B$U.PRIO = S_PRIOB(%M_GHOST#)+4; /* HELP GHOST1 RUN FASSSST  */
     1464    12912    1        USER$ -> B$U.SYSID = %JG_GHOST1#;
     1465    12913    1        USER$ -> B$U.MODE = %M_GHOST#;
     1466    12914        /**/
     1467    12915    1        B$JIT$ -> B$JIT.SYSID = %JG_GHOST1#;
     1468    12916    1        B$JIT$ -> B$JIT.USER = I;
     1469    12917    1        B$JIT$ -> B$JIT.MRT = BITBIN('377777777777'O);
     1470    12918    1        B$JIT$ -> B$JIT.ACCN = ':SYS';
     1471    12919    1        B$JIT$ -> B$JIT.FACCN = ':SYS';
     1472    12920    1        B$JIT$ -> B$JIT.PRIV.ACTIVE = ~%PR_FMEFT#;
     1473    12921    1        B$JIT$ -> B$JIT.PRIV.JOB = ~%PR_FMEFT#;
     1474    12922    1        B$JIT$ -> B$JIT.LOCK = '777777777777777777777777'O;
     1475    12923    1        B$JIT$ -> B$JIT.UNAME = 'GHOST1';
     1476    12924    1        B$JIT$ -> B$JIT.JOBNAME = ' ';
     1477    12925    1        B$JIT$ -> B$JIT.MODE = %M_GHOST#;
     1478    12926    1        B$JIT$ -> B$JIT.MAXTMPDP=99999;
     1479    12927    1        B$JIT$ -> B$JIT.PRDPRM =99999;
     1480    12928    1        B$JIT$ -> B$JIT.DO$ = ADDR(NIL);
     1481    12929    1        B$JIT$ -> B$JIT.FPSN = ' ';
     1482    12930    1        B$JIT$ -> B$JIT.HPSN = 'SYS   ';
     1483    12931    1        B$JIT$ -> B$JIT.OUTPRIO = 7;
     1484    12932        /**/
     1485    12933    1        CALL SSR$CHSE(I);                  /* MAKE HIM EXECUTABLE                */
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:45   
     1486    12934        /**/
     1487    12935        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:46   
     1488    12936        /*  The following code was taken from ITK$KILLTIG, and put here when
     1489    12937            B$ROGERS was split into 2 overlays,  the new one being B$ANDERSON     */
     1490    12938        /**/
     1491    12939    1        CALL SSW$BYPASSCACHE;
     1492    12940    1        CALL SSW$LOGSTRT(0);               /* LOG MASTER START                   */
     1493    12941    2        DO I = 1 TO S_NSCPU;               /* START SLAVES            */
     1494    12942    2             CPUNUM.COUNT = SIZEC(CPUNUM.TEXT);
     1495    12943    2             CPUNUM.TEXT = 'CPU';
     1496    12944    2             CALL BINCHAR(SUBSTR(CPUNUM.TEXT,SIZEC(CPUNUM.TEXT)-1,1),S_PORTNR(I));
     1497    12945    2             IF (IT_BOOTFLAG < I_DISKBOOT) OR (S_MPSTATE(I) = %SS_PAUSE# ) OR
     1498    12946    3                  (S_MPSTATE(I) = %SS_RUN#) THEN DO;
     1499    12947    3                  S_MPSTATE(I)=0;          /* INITIALIZE STATE CODE TO STOPPED   */
     1500    12948    4                  IF H_RPM_FLG THEN DO;
     1501    12949    5                       IF H_DPS8000_SCU_CONF_REG.PORTS(S_PORTNR(I)) = '0'B THEN DO;
     1502    12950    6                            IF SUBSTR(H_DPS8000_CONFIG_NAME,7,1) = 'R' THEN DO;
     1503    12951    6                                 S_MPSTATE(I) = %SS_REL#;
     1504    12952    6                                 ERR = %E$CPUREL;
     1505    12953    6                               END;
     1506    12954    5                            ELSE
     1507    12955    5                                 ERR = %E$CPUWONTSTART;
     1508    12956    5                            GOTO WONT_START;
     1509    12957    5                          END;
     1510    12958    4                     END;
     1511    12959    3                  CALL HFB$ENAPORT(S_PORTNR(I)); /* ENABLE SCU PORT MASK          */
     1512    12960    3                  CALL HFC$STCPU(I);       /* GET HIM FROM STOPPED TO PAUSED     */
     1513    12961    3                  CALL SSS$CACHEBP;        /* BYPASS CACHE AS HE IS RUNNING      */
     1514    12962    3                  IF S_MPSTATE(I)=1 THEN
     1515    12963                                                /* HE IS PAUSED, GOING TO RUN         */
     1516    12964    4                  DO;
     1517    12965    4                       S_NSCPUA=S_NSCPUA+1;
     1518    12966    4                       CALL SSW$LOGSTRT(I);
     1519    12967    4                       CALL ITE$ERROR(%E$CPUSTART,ADDR(CPUNUM));
     1520    12968    4                     END;
     1521    12969    3                  ELSE
     1522    12970                                                /* HE WOUDN'T START.                  */
     1523    12971    4                  DO;
     1524    12972    4                       ERR = %E$CPUWONTSTART;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:47   
     1525    12973    4                       CALL HFB$DISPORT(S_PORTNR(I)); /* DISABLE SCU PORT MASK      */
     1526    12974    4   WONT_START:
     1527    12975    4                       CALL ITE$ERROR(ERR,ADDR(CPUNUM));
     1528    12976    4                     END;
     1529    12977    3                END;
     1530    12978    2           END;
     1531    12979    2        DO I = 1 TO S_NSCPU;               /* GET THEM ALL GOING AT ONCE         */
     1532    12980    2             CALL SSS$CACHEBP;
     1533    12981    3             IF S_MPSTATE(I) = 1 THEN DO;
     1534    12982    3                  CALL HFD$CNNCT(I,0);
     1535    12983    3                END;
     1536    12984    2           END;
     1537    12985        /**/
     1538    12986    1        IF S_NSCPUA = 0
     1539    12987    1        THEN CALL SSW$USECACHE;            /* ONLY ONE CPU - USE CACHE      */
     1540    12988        /**/
     1541    12989    1        RETURN;
     1542    12990        /**/
     1543    12991        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:48   
     1544    12992    1   IOSPIN: PROC ;
     1545    12993
     1546    12994    2   DCL 1 I                 SBIN WORD ALIGNED AUTO ;
     1547    12995    2   DCL 1 J                 SBIN WORD ALIGNED AUTO ;
     1548    12996    2   DCL END_UTS UBIN AUTO;
     1549    12997    2   DCL 1 DQH$              PTR ALIGNED AUTO ;
     1550    12998
     1551    12999    2        CALL SSS$CURTIME (START_TIME) ;
     1552    13000    2        ITW_FREEZE = FALSE ;
     1553    13001    2        CALL XUD$UTS_ADJ_25TH (END_UTS, START_TIME, WAIT_N_MINS * %UTS_25TH_MIN#);
     1554    13002
     1555    13003    3        DO UNTIL NOT IO_OUTSTANDING ;
     1556    13004    3             IO_OUTSTANDING = FALSE ;
     1557    13005    4             DO I = 0 TO NI_IOMS-1 ;
     1558    13006    5                  DO J = 8 TO NI_CHANS(I) ;
     1559    13007    5                       DQH$ = NI$CHT.DQH$(I*%N_MAXCHANS + J) ;
     1560    13008    5                       IF DQH$ ~= ADDR(NIL) THEN
     1561    13009    5                            IF DQH$->NI$DQH.STATE = %BUSY  AND
     1562    13010    6                                 ITW_FREEZE THEN DO ;
     1563    13011    6                                 TEXT_C.T = 'I-CCC' ;
     1564    13012    6                                 CALL BINCHAR (SUBSTR(TEXT_C.T,0,1),I) ;
             13012                                          /* iom number */
     1565    13013    6                                 CALL BINCHAR (SUBSTR(TEXT_C.T,2,3),J) ;
             13013                                          /* chan number */
     1566    13014    6                                 TEXT_C.L = 5 ; /* I-CCC */
     1567    13015    6                                 CALL ITE$ERROR (%E$CHANBUSY2LONG, ADDR(TEXT_C)) ;
     1568    13016    6                               END ;
     1569    13017    5                            ELSE
     1570    13018    5                                 IF DQH$->NI$DQH.STATE = %BUSY THEN
     1571    13019    5                                      IO_OUTSTANDING = TRUE ;
     1572    13020    5                     END ;
     1573    13021    4                END ;
     1574    13022    4             IF ITW_FREEZE THEN DO ;
     1575    13023    4                  CALL ITE$ERROR(%E$TRYAGAIN) ;
     1576    13024    4                  CALL ITF$FREEZE ;        /* BYE-BYE */
     1577    13025    4                END ;                      /*FREEZE*/
     1578    13026    3             CALL SSS$CURTIME (LAP_TIME) ;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:49   
     1579    13027    3             IF LAP_TIME > END_UTS THEN
     1580    13028    3                  ITW_FREEZE = TRUE ;
     1581    13029    3           END ;
     1582    13030
     1583    13031    2        RETURN ;
     1584    13032
     1585    13033    2   END IOSPIN ;
     1586    13034        %EJECT ;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:50   
     1587    13035        /**/
     1588    13036    1   DISK_ERR:
     1589    13037    1        CALL ITE$ERROR(%E$DISKERR);        /* ERROR READ/WRITING DISK       */
     1590    13038    1        CALL ITF$FREEZE;
     1591    13039        /**/
     1592    13040        /**/
     1593    13041    1   NO_FW: ;
     1594    13042    1   FW_ERR:
     1595    13043    1        CALL ITE$ERROR(%E$FWERR);
     1596    13044    1        I = I+1;
     1597    13045    1        GOTO NEXTFWDEV;
     1598    13046        /**/
     1599    13047    1   CONFIG_ERR:
     1600    13048    1        CALL ITE$ERROR(%E$CONFIGERR);
     1601    13049    1        CALL ITF$FREEZE;
     1602    13050        /**/
     1603    13051    1   CVM_ERR:
     1604    13052    1        CALL ITE$ERROR(%E$CVMERR);
     1605    13053    1        CALL ITF$FREEZE;
     1606    13054    1   ITW$ALLOC_ERR:
     1607    13055    1        CALL ITF$FREEZE;
     1608    13056        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:51   
     1609    13057        /**/
     1610    13058    1   FW_MOVE: PROC ALTRET;
     1611    13059        /**/
     1612    13060        /*I*     NAME:     FW_MOVE
     1613    13061                DESCRIPTION: FW_MOVE is used by TIGR to read the FW from the
     1614    13062                         system disk into a data segment or TIGR data area
     1615    13063                         to load the MPCs. When called:
     1616    13064                            FWDA = first DA of this FW.
     1617    13065                            FWSIZE = size in words of this FW.
     1618    13066                            REQ$ = pointer to where to put the FW.
     1619    13067        */
     1620    13068    3        DO WHILE (FWSIZE >= 1024);
     1621    13069    3             CALL ITQ$DREAD(DBUF$,FWDA) ALTRET (DISK_ERR);
     1622    13070    3             REQ$ -> B$PAGE = DBUF$ -> B$PAGE;
     1623    13071    3             REQ$ = PINCRW(REQ$,1024);
     1624    13072    3             FWSIZE = FWSIZE-1024;
     1625    13073    3             FWDA = FWDA+1;
     1626    13074    3           END;
     1627    13075        /**/
     1628    13076    3        IF (FWSIZE ~=0) THEN DO;
     1629    13077    3             CALL ITQ$DREAD(DBUF$,FWDA) ALTRET(DISK_ERR);
     1630    13078    4             DO K = 0 TO FWSIZE-1;
     1631    13079    4                  REQ$ -> B$PAGE.WRD(K) = DBUF$ -> B$PAGE.WRD(K);
     1632    13080    4                END;
     1633    13081    3             REQ$ = PINCRW(REQ$,FWSIZE);
     1634    13082    3           END;
     1635    13083    2        RETURN;
     1636    13084        /**/
     1637    13085    2   DISK_ERR:
     1638    13086    2        ALTRETURN;
     1639    13087    2   END;
     1640    13088    1   END;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:52   
--  Include file information  --

   IT$SPROCDS.:E05TOU  cannot be made into a system file and is referenced.
   TM_DATA_M.:E05TOU  is referenced.
   IS$MACROS.:E05TOU  is referenced.
   K_SESSION_M.:E05TOU  is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   TD_CP6.:E05TOU  is referenced.
   UM_CP6.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   I_SUBS_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_SUBS.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   I$DISK.:E05TOU  cannot be made into a system file and is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   IT$CONFIG.:E05TOU  is referenced.
   IT_ERROR_C.:E05TOU  is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:53   
   NI_DATA_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ITW$WRAPUP.

   Procedure ITW$WRAPUP requires 3621 words for executable code.
   Procedure ITW$WRAPUP requires 186 words of local(AUTO) storage.

    No errors detected in file ITW$WRAPUP.:E05TSI    .

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:54   

 Object Unit name= ITW$WRAPUP                                 File name= ITW$WRAPUP.:E05TOU
 UTS= JUL 29 '97 23:10:05.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    127    177  ITW$WRAPUP
    1   Proc  even  none  3621   7045  ITW$WRAPUP
    2  RoData even  none    69    105  ITW$WRAPUP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  ITW$WRAPUP
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:55   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 NIM$INTDIS
 yes     yes           Std       2 MMB$GPP
 yes     yes           Std       4 MME$CVM
 yes     yes           Std       4 MME$WFVP
 yes     yes           Std       3 UMT$LCLDATE
         yes           Std       0 ITZ$RECOVER
 yes     yes           Std       4 MMH$FDS
 yes     yes           Std       0 ITK$VOLINIT
         yes           Std       2 ITG$MPY10000
         yes           Std       2 ITE$ERROR
         yes           Std       2 NIM$WRENBL
 yes     yes           Std       2 NKP$PART
         yes           Std       0 SSS$CACHEBP
         yes           Std       3 SSC$MONTIMR
         yes           Std       2 SSW$LOGSTRT
         yes           Std       2 HFD$CNNCT
         yes           Std       0 HFC$RCONF_8000
 yes     yes           Std       3 ITK$TMB$BUF_ALLOC
         yes           Std       1 HFB$ENAPORT
         yes           Std       3 KIQ$FEINT
         yes           Std       1 NIW$MPCSTOP
 yes     yes           Std       2 ITH$ALLOCATE
 yes     yes           Std       5 ITK$TDP$SYSCON
 yes     yes           Std       2 HFC$RCONF
         yes           Std       3 HFC$RSCR
         yes           Std       0 HFB$INITMASK
 yes     yes           Std       3 ITK$TMB$MCA
         yes           Std       1 HFC$STCPU
 yes     yes           Std       2 NIW$LDFW
 yes     yes           Std       2 NIM$DEQUEUE
         yes           Std       0 HFB$EDAC
         yes           Std       0 SSS$TIME
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:56   
         yes           Std       1 SSR$CHSE
         yes           Std       0 SSW$BYPASSCACHE
         yes           Std       1 HFB$DISPORT
         yes           Std       1 NIW$MPCSTART
         yes           Std       2 NIM$WRDSBL
         yes           Std       0 ITX$INITS2
         yes           Std       0 SSW$USECACHE
 yes     yes           Std       2 MMB$GNPP
         yes           Std       0 ITF$FREEZE
 yes     yes           Std       5 MMH$GDS
 yes     yes           Std       1 NIQ$GETS
         yes           Std       0 ITP$PROCREC
 yes     yes           Std       2 ITQ$DREAD
 yes     yes           Std       2 ITH$READ_VERIFY_SAD
         yes           Std       0 HFC$LCON
 yes     yes           Std       2 ITK$TMB$BUF_DEALLOC
         yes           Std       1 NII$LIP
 yes     yes           Std       2 ITQ$DWRITE
         yes           Std       2 KIQ$PARTFEP
         yes           Std       0 ITX$INITS
         yes           Std       1 SSS$CURTIME
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:57   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$USRT$                               P_MAXPROCS                            P_AUTO_START
     P_LAST_AUTO                           P_AUTOSPACE                           P_USED_AUTO
     B$P$                                  B$LOOKUP$                             P_RESOURCE$
     P_UPTIME                              P_NSCPU                               KI_FEI$$
     KI_ROUTE$$                            KI_OSIMAX#                            KI_OSIROUTE$$
     KI_NODES                              KI_MXFE                               N$DCT$$
     N$FQ$                                 NI$CHT$                               NI$FQ$
     NI$IMW$                               NI$IBUF$                              NI$IOM$
     NI$RP$                                N_DCTXMAX                             NI_CHANS
     NI_IMXLO_PBASE                        NI_INTENTRY                           NI_IOMS
     NI_MAINT_DCTX                         NI_MAX_CHANS                          NI_MBX_INIT
     NI_NUMIOQ                             NI_NUMIOS                             NI_RELIOS
r    MM_BYP$                               MM_RDS                                MM_DSMAX
     MM_HELD                               MM_FPMC                               MM_SCTDFT
     MM_CGQMAP_PGS                         S_PRIOB                               S_CUIS
     S_CTUIS                               S_PORTNR                              S_MPSTATE
     S_PTYPE                               S_NSCPU                               S_NSCPUA
     S_SYSID                               FR_PRM$                               H_ENMASK
     H_STOREUNIT                           H_MAXSU#                              H_MEMOK
     H_S1000_FLG                           H_RPM_FLG                             H_S1000_CONFIG
     H_CPU_CONFIG                          H_SCU_CONFIG                          H_SCU_BF
     H_CPU_BF                              H_PORT_FIRST_ADDR                     H_MAXPORT#
     H_RSW1                                H_RSW2                                H_DPS8000_SCU_CONF_REG
     H_DPS8000_CONFIG_NAME                 HW_PTB_UNITS                          HW_WSQ0PT
     HW_LOAD_FW                            HW_SECT_PT                            HW_IOP
     HW_SMART_CACHE                        HW_EDAC                               HW_NORM_CLOCK
     HW_IMX                                IT_DATASIZE                           IT_CLOFF
     B$JIT$                                B$REAL$                               B$DS1$
     B$DS2$                                B$DS3$                                B$DS4$
     B$DS5$                                B$DS6$                                B$UPT$
     B$MPT$                                B$IS$                                 B$LS$
     B$LOWMEM$                             B$TIGR$                               B$WINDOW$
     B$WSQ0PT$                             B$IPHYMAP$                            B$IMX$
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:58   
     B$SCU$                                NK_MXLOCAL                            S_TIMR
     B_SCDCTX                              IT_FEI$$                              FM_SYSDP
     IT_SYSDIR$                            IT_SCPUWSPTD                          IT_SCPUJIT
     IT_SCPUHJIT                           IT_BOOTFLAG                           IT_SYSDISK
     IT_DUMPSIZE                           IT_DBUF                               IT_DBUFEND
     IT_MMDSMAX                            KIS_SSN_CLIENTS                       KIS_SSN_SERVERS
     KIS_SSN_MAX                           KIS_SSN_MAXMINOR                      KIS_SSN_MAXMAJOR
     KIS_MAJOR$                            KIS_MINOR$                            EL_LOGERRS
     IT_TIGRCUB                            S_PNO                                 IT_PARTITION
     IT_CONFIG                             B_SITEINFO                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:59   


        1        1        /*M*     Process the END command and perform clean up */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        9        9        /*P*     NAME:     ITW$WRAPUP
       10       10                 PURPOSE:  ITW$WRAPUP performs the various functions that must
       11       11                           be done at the end of TIGR processing. These include
       12       12                           initializing GHOST1,unmasking the I/O channels and
       13       13                           calling FMX$INIT and KIS$FEINIT.        */
       14       14        ITW$WRAPUP: PROC(PTR$,CALL_VOLINIT);

     14  1 000000   000000 700200 xent  ITW$WRAPUP   TSX0  ! X66_AUTO_2
         1 000001   000272 000002                    ZERO    186,2

       15       15        /**/
       16       16    1   DCL PTR$ PTR;                           /* TABLE SPACE PTR                    */
       17       17    1   DCL CALL_VOLINIT BIT(1) ALIGNED;
       18       18        /**/
       19       19        /*  INCLUDE FILES */
       20       20        %INCLUDE B$USER;
       21      236        %B$USERREFS;
       22      240        %INCLUDE B$P;
       23      324        %INCLUDE P_PMDAT_R;
       24      632        %INCLUDE KI_DATA_R;
       25      658        %INCLUDE KI_SUBS_C ;
       26      794        %INCLUDE KI_MACROS_C;
       27     1402        %INCLUDE NI_DATA_R;
       28     1839        %INCLUDE NI_DATA_C;
       29     1952        %INCLUDE IT_SUBS_C;
       30     2219        %INCLUDE IT_ERROR_C;
       31     2302        %INCLUDE IT$CONFIG;
       32     2371        %INCLUDE MM_DATA_R;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:60   
       33     2891        %INCLUDE B_MLSMAC_C;
       34     3833        %INCLUDE I$DISK;
       35     4085        %INCLUDE B$JIT;
       36     4688        %INCLUDE B$MAP;
       37     4787        %INCLUDE NI_MACROS_C;
       38     5054        %INCLUDE SS_SCHED_C;
       39     5287        %INCLUDE SS_SCHED_R;
       40     5330        %INCLUDE JG_GHOSTS_C;
       41     5420        %INCLUDE FR_DATA_R;
       42     5452        %INCLUDE FR_SUBS;
       43     5520        %INCLUDE S_WSPTD_R;
       44     5536        %INCLUDE I_SUBS_C;
       45     5560        %INCLUDE IR_DATA_M;
       46     5724        %INCLUDE UM_CP6;
       47     6576        %INCLUDE TD_CP6;
       48     6754        %INCLUDE CP_6_SUBS;
       49     7294        %INCLUDE HF_DATA_R;
       50     7337        %INCLUDE KNN_NETWORK_M;
       51     7700        %INCLUDE K_ADDRESS_M;
       52     8203        %INCLUDE XUD_UTS_M;
       53     8285        %XUD_UTS_EQU;
       54     8296        %XUD$UTS_ENTRIES;
       55     8328        %INCLUDE K_SESSION_M;
       56     8418        %INCLUDE IS$MACROS;
       57     9693        %INCLUDE TM_DATA_M;
       58     9795        /**/
       59     9796        /*  SUBS  */
       60     9797        /**/
       61     9798        %SUB VIDDA = 0/*VIDDA*/;
       62     9799        %SUB MAXFWSIZE = 20;                    /* 20 PAGE DS1 FOR FW                 */
       63     9800        %SUB TRUE = '1'B;
       64     9801        %SUB FALSE = '0'B;
       65     9802        %SUB WAIT_N_MINS = 1;    /* wait 1 minute for outstanding IOs to complete */
       66     9803        /**/
       67     9804        /*  ENTRY DCLS  */
       68     9805        /**/
       69     9806    1   DCL NIM$INTDIS ENTRY ;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:61   
       70     9807    1   DCL NIM$WRENBL ENTRY(2);
       71     9808    1   DCL NIM$WRDSBL ENTRY(2);
       72     9809    1   DCL NIQ$GETS ENTRY(1) ALTRET;
       73     9810    1   DCL NIW$MPCSTART ENTRY(1);
       74     9811    1   DCL NIW$MPCSTOP ENTRY(1);
       75     9812    1   DCL NII$LIP ENTRY(1);
       76     9813    1   DCL NIW$LDFW ENTRY(2) ALTRET;
       77     9814    1   DCL ITF$FREEZE ENTRY;
       78     9815    1   DCL ITX$INITS ENTRY;
       79     9816    1   DCL ITX$INITS2 ENTRY;
       80     9817    1   DCL HFB$EDAC ENTRY;
       81     9818    1   DCL SSC$MONTIMR ENTRY(3);
       82     9819    1   DCL SSS$CURTIME ENTRY(1);
       83     9820    1   DCL SSS$TIME ENTRY;
       84     9821    1   DCL SSR$CHSE ENTRY(1);
       85     9822    1   DCL SSS$SENT ENTRY;
       86     9823    1   DCL MMH$FDS ENTRY(4) ALTRET;
       87     9824    1   DCL MMH$GDS ENTRY(5) ALTRET;
       88     9825    1   DCL MME$CVM ENTRY(4) ALTRET;
       89     9826    1   DCL MME$WFVP ENTRY(4) ALTRET;
       90     9827    1   DCL HFC$LCON ENTRY;
       91     9828    1   DCL MMB$GPP ENTRY(2) ALTRET;
       92     9829    1   DCL MMB$GNPP ENTRY(2) ALTRET;
       93     9830    1   DCL MMB$FPP ENTRY(1) ALTRET;
       94     9831    1   DCL ITK$VOLINIT ENTRY  ALTRET;
       95     9832    1   DCL ITH$READ_VERIFY_SAD ENTRY(2) ALTRET;
       96     9833    1   DCL ITQ$DREAD ENTRY(2) ALTRET;
       97     9834    1   DCL ITQ$DWRITE ENTRY(2) ALTRET;
       98     9835    1   DCL ITP$PROCREC ENTRY;
       99     9836    1   DCL ITE$ERROR ENTRY(2);
      100     9837    1   DCL ITZ$RECOVER ENTRY;
      101     9838    1   DCL HFB$ENAPORT ENTRY(1);
      102     9839    1   DCL HFB$INITMASK ENTRY;
      103     9840    1   DCL HFC$RSCR ENTRY(3);
      104     9841    1   DCL HFC$RRES ENTRY(2);
      105     9842    1   DCL HFC$RCONF ENTRY(2) ALTRET;
      106     9843    1   DCL ITK$TDP$SYSCON ENTRY(5) ALTRET;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:62   
      107     9844    1   DCL NKP$PART ENTRY(2) ALTRET;
      108     9845    1   DCL ITH$ALLOCATE ENTRY(2) ALTRET;
      109     9846    1   DCL UMT$LCLDATE ENTRY(3) ALTRET;
      110     9847    1   DCL ITG$MPY10000 ENTRY(2);
      111     9848    1   DCL KIQ$FEINT ENTRY(3);
      112     9849    1   DCL KIQ$PARTFEP ENTRY(2) ;
      113     9850    1   DCL ITK$TMB$MCA ENTRY(3) ALTRET;
      114     9851    1   DCL ITK$TMB$BUF_ALLOC ENTRY(3) ALTRET;
      115     9852    1   DCL ITK$TMB$BUF_DEALLOC ENTRY(2) ALTRET;
      116     9853        /**/
      117     9854        /*  ENTRIES ADDED FOR THE ITK$KILLTIGR CODE MOVED INTO HERE.   */
      118     9855        /**/
      119     9856    1   DCL HFD$CNNCT ENTRY(2);
      120     9857    1   DCL HFC$RCONF_8000 ENTRY;
      121     9858    1   DCL HFC$STCPU ENTRY(1);
      122     9859    1   DCL SSS$CACHEBP ENTRY;
      123     9860    1   DCL SSW$LOGSTRT ENTRY(2);
      124     9861    1   DCL SSW$USECACHE ENTRY;
      125     9862        /* DCL HFB$ENAPORT ENTRY(1);    DCLed above */
      126     9863    1   DCL HFB$DISPORT ENTRY(1);
      127     9864    1   DCL SSW$BYPASSCACHE ENTRY;
      128     9865        /**/
      129     9866        /**/
      130     9867        /*  AUTOMATIC  */
      131     9868        /**/
      132     9869    1   DCL I SBIN WORD;
      133     9870    1   DCL J SBIN WORD;
      134     9871    1   DCL K SBIN WORD;
      135     9872    1   DCL ERR SBIN;
      136     9873    1   DCL 1 TEXT_C,
      137     9874    1            2 L UBIN(9) UNAL,
      138     9875    1            2 T CHAR(10) UNAL;
      139     9876    1   DCL 1 CPUNUM AUTO,                 /* added for ITK$KILLTIGR code moved in */
      140     9877    1            2 COUNT UBIN(9) UNAL,
      141     9878    1            2 TEXT CHAR(5) UNAL;
      142     9879    1   DCL 1 SCU_REG DALIGNED,
      143     9880    1            2 * BIT(28) UNAL,
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:63   
      144     9881    1            2 PORTS(0:7) BIT(1) UNAL,
      145     9882    1            2 * BIT(36) UNAL;
      146     9883    1   DCL CUR_FWSLOT SBIN;
      147     9884    1   DCL DEVNM CHAR(8);
      148     9885    1   DCL OFFSET SBIN;
      149     9886    1   DCL RSLT BIT(72) ALIGNED;
      150     9887    1   DCL BASE_CHAN SBIN WORD;
      151     9888    1   DCL DEV_CHAN SBIN WORD;                 /* UNIT RECORD FW BITS BY CHANNEL     */
      152     9889    1   DCL LP_WORD UBIN WORD;
      153     9890    1   DCL LP_WORD_BITS(0:35) REDEF LP_WORD BIT(1) UNAL;
      154     9891    1   DCL CRCP_WORD SBIN WORD;
      155     9892    1   DCL CRCP_WORD_BITS(0:35) REDEF CRCP_WORD BIT(1) UNAL;
      156     9893    1   DCL MAX_DA  SBIN WORD;
      157     9894    1   DCL MIN_DA SBIN WORD;
      158     9895    1   DCL MONDATA_DA SBIN WORD;
      159     9896    1   DCL MONDATA_SIZE SBIN WORD;
      160     9897    1   DCL TIGRDATA_DA SBIN WORD;
      161     9898    1   DCL IT_DATASIZE UBIN WORD SYMREF;
      162     9899    1   DCL LOWREAL_DA SBIN WORD;
      163     9900    1   DCL DIR_DA SBIN WORD;
      164     9901    1   DCL MAX_NUM_PORTS SBIN WORD;
      165     9902    1   DCL APPL$ PTR;
      166     9903        /**/
      167     9904    1   DCL FWDA SBIN WORD;
      168     9905    1   DCL FWSIZE SBIN WORD;
      169     9906    1   DCL FWSLOTS SBIN WORD;
      170     9907    1   DCL 1 FW(0:19),
      171     9908    1            2 BASE UBIN WORD UNAL,
      172     9909    1            2 DA UBIN WORD UNAL,
      173     9910    1            2 CS0SIZE UBIN HALF UNAL,
      174     9911    1            2 MM0SIZE UBIN HALF UNAL,
      175     9912    1            2 NAME CHAR(4) UNAL;
      176     9913        /**/
      177     9914    1   DCL 1 SUB_BUF,
      178     9915    1            2 COUNT UBIN(9) UNAL,
      179     9916    1            2 TEXT CHAR(11) UNAL;
      180     9917        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:64   
      181     9918    1   DCL REQ$ PTR;
      182     9919    1   DCL 1 REREQ$ REDEF REQ$,
      183     9920    1            2 OFFSET UBIN(18) UNAL,
      184     9921    1            2 * BIT(6) UNAL,
      185     9922    1            2 SEGID UBIN(12) UNAL;
      186     9923    1   DCL SQH$ PTR;
      187     9924    1   DCL DQH$ PTR;
      188     9925    1   DCL DEV$ PTR;
      189     9926    1   DCL DCT$ PTR ;
      190     9927    1   DCL MPC$ PTR ;
      191     9928    1   DCL USER$ PTR;
      192     9929    1   DCL DBUF$ PTR;
      193     9930    1   DCL CVM$ PTR;
      194     9931        %FPT_SYSCON (FPTN=FPT_SYSCON,STCLASS=AUTO);
      195     9948        /**/
      196     9949    1   DCL LAX SBIN;
      197     9950    1   DCL PCHAN SBIN;
      198     9951        /* AUTO DATA FOR STORE UNIT SURVEY */
      199     9952    1   DCL STOREUNIT# SBIN WORD;               /* INDEX INTO STORE UNIT ARRAYS       */
      200     9953    1   DCL PORT# SBIN WORD;                    /* INDEX INTO CPU PORT ARRAYS         */
      201     9954    1   DCL PORT_START_ADDR SBIN WORD;          /* PORT STARTING ADDRESS IN WORDS     */
      202     9955    1   DCL PORT_MEM_SIZE SBIN WORD;            /* TOTAL MEMORY ON PORT IN WORDS      */
      203     9956    1   DCL ERRCDE SBIN WORD;
      204     9957    1   DCL RSCR_ADDR SBIN WORD;
      205     9958    1   DCL LOWER_STORE_SIZE SBIN WORD;         /* TOTAL MEMORY ON LOWER STORE PAIR   */
      206     9959    1   DCL SU# SBIN WORD;                      /* INDEX FOR STORE UNITS ON EACH SCU  */
      207     9960    1   DCL LOG_SU# SBIN WORD;
      208     9961    1   DCL 1 SU,
      209     9962    1            2 ONLINE (0:3) BIT(1) UNAL,
      210     9963    1            2 ONLINE_REDEF REDEF ONLINE BIT(4) UNAL;
      211     9964    1   DCL 1 CPU_CONFIG ,
      212     9965    1            2 PORT_ASSIGN UBIN(3) UNAL,
      213     9966    1            2 PORT_ENABLE BIT(1) UNAL,
      214     9967    1            2 INITIALIZE BIT(1) UNAL,
      215     9968    1            2 INTERLACE BIT(1) UNAL,
      216     9969    1            2 SIZE UBIN(3) UNAL;
      217     9970    1   DCL 1 SCU_CONFIG DALIGNED,
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:65   
      218     9971    1            2 * BIT(9) UNAL,
      219     9972    1            2 SIZE UBIN(3) UNAL,
      220     9973    1            2 ON_LINE BIT(4) UNAL,
      221     9974    1            2 * BIT(14) UNAL,
      222     9975    1            2 INTERLACE BIT(1) UNAL,
      223     9976    1            2 LOWER_STORE BIT(1) UNAL,
      224     9977    1            2 * BIT(40) UNAL;
      225     9978    1   DCL 1 RSW2,
      226     9979    1            2 DPSE_2WAY (0:3) BIT(1) UNAL,
      227     9980    1            2 L66_SIZE_MULT (0:3) REDEF DPSE_2WAY BIT(1) UNAL,
      228     9981    1            2 * BIT(32) UNAL;
      229     9982    1   DCL CPU_INTL UBIN WORD;
      230     9983
      231     9984    1   DCL B$BIT36(0:0) BIT(36) ALIGNED BASED;
      232     9985    1   DCL IT_CLOFF BIT(72) DALIGNED SYMREF;
      233     9986    1   DCL 1 XXX_CLOCK DALIGNED,
      234     9987    1            2 DATE,
      235     9988    1                 3 Y UBIN(12) UNAL,
      236     9989    1                 3 M UBIN(6) UNAL,
      237     9990    1                 3 D UBIN(6) UNAL,
      238     9991    1            2 TIME BIT(48) UNAL;
      239     9992
      240     9993    1   DCL 1 LOCAL_DATE,
      241     9994    1            2 M CHAR(2),
      242     9995    1            2 S1 CHAR(1),
      243     9996    1            2 D CHAR(2),
      244     9997    1            2 S2 CHAR(1),
      245     9998    1            2 Y CHAR(2);
      246     9999
      247    10000    1   DCL START_TIME UBIN(36);
      248    10001    1   DCL LAP_TIME   UBIN(36);
      249    10002    1   DCL UTS_DATE UBIN;
      250    10003    1   DCL PPNO SBIN;
      251    10004    1   DCL IPC SBIN;
      252    10005    1   DCL CHAN SBIN;
      253    10006    1   DCL BUF$ PTR;
      254    10007    1   DCL BUFX SBIN;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:66   
      255    10008    1   DCL TDQH$ PTR;
      256    10009    1   DCL IO_OUTSTANDING BIT(1) ALIGNED;
      257    10010    1   DCL ONQUEUE REDEF IO_OUTSTANDING BIT(1) ALIGNED;
      258    10011    1   DCL ITW_FREEZE BIT(1) ALIGNED;
      259    10012        /**/
      260    10013        /*  BASED */
      261    10014        %INCLUDE IT$SPROCDS;
      262    10030        %NI$DCT;
      263    10078        %NI$SQH;
      264    10091        %NI$DVT;
      265    10098        %NI$REQ;
      266    10123        %NI$DQH;
      267    10146        %KI$ROUTE (STCLASS=BASED);
      268    10200        %KIS$APPL (NAME=APPL,STCLASS=BASED);
      269    10269        %KNN$OSIROUTE(FPTN=KI$OSIROUTE);
      270    10486    1   DCL KI$OSIROUTE$(0:0) PTR BASED(KI_OSIROUTE$$);
      271    10487        %MCA_CFG(NAME=MCA_CFG,STCLASS="BASED(BUF$)");
      272    10597    1   DCL KI$ROUTE$(0:0) PTR BASED(KI_ROUTE$$);
      273    10598        %NI$FW (STCLASS="BASED(B$DS1$)");
      274    10604        %NI$CHT;
      275    10607        %NI$IOM;
      276    10612        %N$REQ;
      277    10670        %B_MLS (FPTN=B$MLNK,STCLASS=BASED);
      278    11485        /**/
      279    11486        %FM$VID;
      280    11532        /**/
      281    11533        %VLR_SITEINFO (FPTN=B$SITEINFO,STCLASS=BASED);
      282    11552        /**/
      283    11553    1   DCL 1 REAL BASED DALIGNED,
      284    11554    1            2 *(0:23) SBIN,
      285    11555    1            2 L30 BIT(72);
      286    11556    1   DCL B$WORD UBIN WORD BASED ALIGNED;
      287    11557    1   DCL 1 MINI_DATA BASED(B$LOWMEM$) ALIGNED,
      288    11558    1            2 *(0:8191) UBIN,
      289    11559    1            2 MINIQM EPTR,
      290    11560    1            2 MINIQX EPTR,
      291    11561    1            2 RSTART EPTR,
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:67   
      292    11562    1            2 GOLOOP EPTR,
      293    11563    1            2 RECOVER EPTR,
      294    11564    1            2 OK2WRVID SBIN;
      295    11565        /**/
      296    11566        /*  SYMREFS  */
      297    11567        /**/
      298    11568    1   DCL B$JIT$ PTR SYMREF;
      299    11569    1   DCL B$REAL$ PTR SYMREF;
      300    11570    1   DCL B$DS1$ PTR SYMREF;
      301    11571    1   DCL B$DS2$ PTR SYMREF;
      302    11572    1   DCL B$DS3$ PTR SYMREF;
      303    11573    1   DCL B$DS4$ PTR SYMREF;
      304    11574    1   DCL B$DS5$ PTR SYMREF;
      305    11575    1   DCL B$DS6$ PTR SYMREF;
      306    11576    1   DCL B$UPT$ PTR SYMREF;
      307    11577    1   DCL B$MPT$ PTR SYMREF;
      308    11578    1   DCL B$IS$ PTR SYMREF;
      309    11579    1   DCL B$LS$ PTR SYMREF;
      310    11580    1   DCL B$LOWMEM$ PTR SYMREF;
      311    11581    1   DCL B$TIGR$ PTR SYMREF;
      312    11582    1   DCL B$WINDOW$ PTR SYMREF;
      313    11583    1   DCL B$WSQ0PT$ PTR SYMREF;
      314    11584    1   DCL B$IPHYMAP$ PTR SYMREF;
      315    11585    1   DCL B$IMX$ PTR SYMREF;
      316    11586    1   DCL B$SCU$ PTR SYMREF;
      317    11587    1   DCL NK_MXLOCAL SBIN SYMREF;
      318    11588    1   DCL S_TIMR UBIN WORD SYMREF;
      319    11589    1   DCL B_SCDCTX UBIN WORD SYMREF;
      320    11590    1   DCL IT_FEI$$ PTR SYMREF;
      321    11591    1   DCL 1 FM_SYSDP SYMREF,                  /* THIS FORM MAKES IT EASY FOR BOOT   */
      322    11592    1            2 PORT UBIN(9) UNAL,
      323    11593    1            2 CHN UBIN(9) UNAL,
      324    11594    1            2 DVN UBIN(9) UNAL,
      325    11595    1            2 * UBIN(9) UNAL;
      326    11596    1   DCL IT_SYSDIR$ PTR SYMREF;              /* SYSTEM AREA DIRECTORY IN TIGR DATA */
      327    11597    1   DCL IT_SCPUWSPTD(0:%NUM_CPUS) UBIN WORD SYMREF;
      328    11598    1   DCL IT_SCPUJIT(0:%NUM_CPUS) UBIN WORD SYMREF;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:68   
      329    11599    1   DCL IT_SCPUHJIT(0:%NUM_CPUS) UBIN WORD SYMREF;
      330    11600    1   DCL IT_BOOTFLAG UBIN WORD SYMREF;
      331    11601    1   DCL IT_GOTLP BIT(1) SYMREF;
      332    11602    1   DCL IT_SYSDISK UBIN WORD SYMREF;        /* SYSTEM DISK DCTX                   */
      333    11603    1   DCL IT_DUMPSIZE UBIN WORD SYMREF;
      334    11604    1   DCL IT_DBUF UBIN WORD SYMREF;
      335    11605    1   DCL IT_DBUFEND UBIN WORD SYMREF;
      336    11606    1   DCL IT_MMDSMAX(0:7) UBIN BYTE UNAL SYMREF;
      337    11607    1   DCL KIS_SSN_CLIENTS UBIN SYMREF;
      338    11608    1   DCL KIS_SSN_SERVERS UBIN SYMREF;
      339    11609    1   DCL KIS_SSN_MAX UBIN SYMREF;
      340    11610    1   DCL KIS_SSN_MAXMINOR UBIN SYMREF;
      341    11611    1   DCL KIS_SSN_MAXMAJOR UBIN SYMREF;
      342    11612    1   DCL KIS_MAJOR$ PTR SYMREF;
      343    11613    1   DCL KIS_MINOR$ PTR SYMREF;
      344    11614
      345    11615    1   DCL EL_LOGERRS BIT(1) ALIGNED SYMREF;
      346    11616    1   DCL IT_TIGRCUB BIT(1) ALIGNED SYMREF;
      347    11617    1   DCL S_PNO UBIN SYMREF;
      348    11618        %NI$PARTITION (NAME=IT_PARTITION,STCLASS=SYMREF);
      349    11626        %IT$CONFIG (NAME=IT_CONFIG, STCLASS=SYMREF);
      350    11687        %KI$FEI;
      351    11771        /**/
      352    11772        %VLR_SITEINFO (FPTN=B_SITEINFO,STCLASS=SYMREF);
      353    11791        /**/
      354    11792        /*  CONSTANT DATA  */
      355    11793        /**/
      356    11794        %RV_BOOTID;
      357    11799        /* CONSTANT DATA FOR STORE UNIT SURVEY */
      358    11800    1   DCL L66_CPU_MEM_SIZE (0:7) SBIN WORD CONSTANT INIT(
      359    11801    1         32768,65536,0,131072,0,0,0,262144);
      360    11802    1   DCL DPSE_ELS1_CPU_MEM_SIZE (0:7) SBIN WORD CONSTANT INIT(
      361    11803    1         0,65536,131072,262144,524288,1048576,2097152,4194304);
      362    11804    1   DCL L66_CPU_BF (0:7) SBIN WORD CONSTANT INIT(
      363    11805    1         8,7,0,6,0,0,0,5);
      364    11806    1   DCL DPSE_ELS1_CPU_BF (0:7) SBIN WORD CONSTANT INIT(
      365    11807    1         0,7,6,5,4,3,2,1);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:69   
      366    11808    1   DCL SCU_MEM_SIZE (0:7) SBIN WORD CONSTANT INIT(
      367    11809    1         0,65536,131072,262144,524288,1048576,2097152,4194394);
      368    11810    1   DCL SCU_BF (0:7) SBIN WORD CONSTANT INIT(
      369    11811    1         0,7,6,5,4,3,2,1);
      370    11812    1   DCL A_LOW (0:3) SBIN WORD CONSTANT INIT(0,1,2,3);
      371    11813    1   DCL B_LOW (0:3) SBIN WORD CONSTANT INIT(2,3,0,1);
      372    11814    1   DCL MCA_FW_LOAD(0:15) BIT(1) UNAL CONSTANT
      373    11815    1     INIT ('0'B, '0'B, '1'B, '0'B, '1'B, '1'B, '1'B, '0'B*0);
      374    11816    1   DCL 1 NI_ENTADDR EPTR CONSTANT INIT(ENTADDR(NIM$INTDIS)) ;
      375    11817    1   DCL 1 NI_ENTRY   REDEF NI_ENTADDR,
      376    11818    1            2 LOC   UBIN(18) UNAL,
      377    11819    1            2 *     UBIN(18) UNAL ;
      378    11820        /**/
      379    11821        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:70   
      380    11822        /*D*     NAME:     ITW$WRAPUP
      381    11823                 PURPOSE:  To perform the various functions that must be done
      382    11824                           after all TIGR commands have been processed
      383    11825        *
      384    11826                 INPUT:    PTR$ - parameter - pointer to next available TIGR table
      385    11827                                  location.
      386    11828        *
      387    11829                 OUTPUT:   Initialized tables, GHOST1 and etc.
      388    11830        *
      389    11831                 DESCRIPTION:   ITW$WRAPUP first moves the N$DCT$ and B$P tables
      390    11832                           from the data segments where they were built to the
      391    11833                           TIGR table area. Then an I/O operation is done
      392    11834                           to every subsystem to unmask the I/O channels and allow
      393    11835                           special interrupts, TIGR's working data segments
      394    11836                           are released, FMX$INIT and KIS$FEINIT are called, and
      395    11837                           GHOST1 is readied for execution. When this is done
      396    11838                           ITW$WRAPUP returns to ITT$TIGR.         */
      397    11839        /**/
      398    11840    1        IF HW_SMART_CACHE

  11840  1 000002   000000 234000 xsym               SZN     HW_SMART_CACHE
         1 000003   000011 605000 1                  TPL     s:11843

      399    11841    1        THEN B$LS$ -> B$MLNK.BUF.FLGS = '743'O;

  11841  1 000004   000000 470400 xsym               LDP0    B$LS$
         1 000005   000004 236100                    LDQ     4,,PR0
         1 000006   000000 376000 2                  ANQ     0
         1 000007   170600 276007                    ORQ     61824,DL
         1 000010   000004 756100                    STQ     4,,PR0

      400    11842
      401    11843    2        IF HW_SECT_PT THEN DO;             /* Get MM_SCTDFT */

  11843  1 000011   000000 234000 xsym               SZN     HW_SECT_PT
         1 000012   000063 605000 1                  TPL     s:11853

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:71   
      402    11844    2             CALL MMB$GPP (MM_SCTDFT, %MONWSQ);

  11844  1 000013   000001 630400 2                  EPPR0   1
         1 000014   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000015   000000 701000 xent               TSX1    MMB$GPP
         1 000016   000000 011000                    NOP     0

      403    11845    2             CALL MME$CVM (%MONWSQ, %WINDOWLO, MM_SCTDFT, ERR);

  11845  1 000017   200010 630500                    EPPR0   ERR,,AUTO
         1 000020   200265 450500                    STP0    DQH$+5,,AUTO
         1 000021   000001 236000 2                  LDQ     1
         1 000022   200264 756100                    STQ     DQH$+4,,AUTO
         1 000023   000004 237000 2                  LDAQ    4
         1 000024   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000025   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000026   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000027   000000 701000 xent               TSX1    MME$CVM
         1 000030   000000 011000                    NOP     0

      404    11846    3             DO I = 0 TO 1023;

  11846  1 000031   200005 450100                    STZ     I,,AUTO

      405    11847    3                  B$WINDOW$->B$BIT36(I) = MM_FPMC;

  11847  1 000032   000000 236000 xsym               LDQ     MM_FPMC
         1 000033   000000 470400 xsym               LDP0    B$WINDOW$
         1 000034   200005 720100                    LXL0    I,,AUTO
         1 000035   000000 756110                    STQ     0,X0,PR0

      406    11848    3                END;

  11848  1 000036   200005 054100                    AOS     I,,AUTO
         1 000037   200005 235100                    LDA     I,,AUTO
         1 000040   001777 115007                    CMPA    1023,DL
         1 000041   000032 604400 1                  TMOZ    s:11847
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:72   

      407    11849    2             CALL MME$CVM (%MONWSQ, %WINDOWLO, -1, ERR);

  11849  1 000042   200010 630500                    EPPR0   ERR,,AUTO
         1 000043   200265 450500                    STP0    DQH$+5,,AUTO
         1 000044   000006 236000 2                  LDQ     6
         1 000045   200264 756100                    STQ     DQH$+4,,AUTO
         1 000046   000004 237000 2                  LDAQ    4
         1 000047   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000050   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000051   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000052   000000 701000 xent               TSX1    MME$CVM
         1 000053   000000 011000                    NOP     0

      408    11850    2             IF HW_WSQ0PT THEN MM_SCTDFT = B$WSQ0PT$->B$MAP.RPN(MM_SCTDFT);

  11850  1 000054   000000 234000 xsym               SZN     HW_WSQ0PT
         1 000055   000063 605000 1                  TPL     s:11853

  11850  1 000056   000000 470400 xsym               LDP0    B$WSQ0PT$
         1 000057   000000 720000 xsym               LXL0    MM_SCTDFT
         1 000060   000000 236110                    LDQ     0,X0,PR0
         1 000061   000022 772000                    QRL     18
         1 000062   000000 756000 xsym               STQ     MM_SCTDFT

      409    11851    2           END;

      410    11852
      411    11853    2        DO I = 0 TO NI_IOMS-1;

  11853  1 000063   200005 450100                    STZ     I,,AUTO
         1 000064   000111 710000 1                  TRA     s:11856+1

      412    11854    2             PORT# = NI$IOM$(I)->NI$IOM.ADDRESS;

  11854  1 000065   200005 720100                    LXL0    I,,AUTO
         1 000066   000000 470410 xsym               LDP0    NI$IOM$,X0
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:73   
         1 000067   000003 236100                    LDQ     3,,PR0
         1 000070   000007 376007                    ANQ     7,DL
         1 000071   200215 756100                    STQ     PORT#,,AUTO

      413    11855    2             IF NOT IT_PARTITION.IOCHAN(I*%N_MAXCHANS) THEN CALL HFB$ENAPORT(PORT#);

  11855  1 000072   200005 235100                    LDA     I,,AUTO
         1 000073   000007 735000                    ALS     7
         1 000074   000076 605000 1                  TPL     s:11855+4
         1 000075   000044 035003                    ADLA    36,DU
         1 000076   000000 066405                    CMPB    filb='0'B
         1 000077   000012 000001 xsym               BDSC    IT_PARTITION+10,A        by=0,bit=0,n=1
         1 000100   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000101   000110 601000 1                  TNZ     s:11856

  11855  1 000102   200215 631500                    EPPR1   PORT#,,AUTO
         1 000103   200262 451500                    STP1    DQH$+2,,AUTO
         1 000104   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000105   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000106   000000 701000 xent               TSX1    HFB$ENAPORT
         1 000107   000000 011000                    NOP     0

      414    11856    2           END;

  11856  1 000110   200005 054100                    AOS     I,,AUTO
         1 000111   200005 236100                    LDQ     I,,AUTO
         1 000112   000000 116000 xsym               CMPQ    NI_IOMS
         1 000113   000065 604000 1                  TMI     s:11854

      415    11857        /**/
      416    11858    2        IF HW_IMX THEN DO;

  11858  1 000114   000000 234000 xsym               SZN     HW_IMX
         1 000115   000303 605000 1                  TPL     s:11892

      417    11859        /* RPM has no IMWs, and needs to do funny stuff with IOS packets here, because
      418    11860           they are not written to disk like they are on DPS8's.  Remember, on
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:74   
      419    11861           RPM's they don't live in $LS17, they live in $LS114. */
      420    11862    2             NI$IMW$ = ADDR(NIL);

  11862  1 000116   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000117   000000 756000 xsym               STQ     NI$IMW$

      421    11863    2             NI_IMXLO_PBASE = (B$MPT$->B$MAP.RPN(%PGTBLLO)*1024+%IMXLO)*1024;

  11863  1 000120   000000 470400 xsym               LDP0    B$MPT$
         1 000121   000000 236100                    LDQ     0,,PR0
         1 000122   000002 736000                    QLS     2
         1 000123   777774 376003                    ANQ     -4,DU
         1 000124   000007 036000 2                  ADLQ    7
         1 000125   000000 756000 xsym               STQ     NI_IMXLO_PBASE

      422    11864    2             PPNO=%(IMXHI-IMXLO+1);

  11864  1 000126   000020 235007                    LDA     16,DL
         1 000127   200243 755100                    STA     PPNO,,AUTO

      423    11865    3             CALL MMB$GNPP (PPNO, %MONWSQ) WHENALTRETURN DO; CALL ITF$FREEZE; END;

  11865  1 000130   000002 236000 2                  LDQ     2
         1 000131   200263 756100                    STQ     DQH$+3,,AUTO
         1 000132   200243 631500                    EPPR1   PPNO,,AUTO
         1 000133   200262 451500                    STP1    DQH$+2,,AUTO
         1 000134   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000135   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000136   000000 701000 xent               TSX1    MMB$GNPP
         1 000137   000141 702000 1                  TSX2    s:11865+9
         1 000140   000144 710000 1                  TRA     s:11866

  11865  1 000141   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000142   000000 701000 xent               TSX1    ITF$FREEZE
         1 000143   000000 011000                    NOP     0

      424    11866    3             DO I = 0 TO %(IMXHI-IMXLO);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:75   

  11866  1 000144   200005 450100                    STZ     I,,AUTO

      425    11867    4                  CALL MME$CVM (%MONWSQ, %IMXLO+I, PPNO+I, J) WHENALTRETURN DO;

  11867  1 000145   200243 236100                    LDQ     PPNO,,AUTO
         1 000146   200005 036100                    ADLQ    I,,AUTO
         1 000147   200005 235100                    LDA     I,,AUTO
         1 000150   000510 035007                    ADLA    328,DL
         1 000151   200262 755100                    STA     DQH$+2,,AUTO
         1 000152   200263 756100                    STQ     DQH$+3,,AUTO
         1 000153   200006 630500                    EPPR0   J,,AUTO
         1 000154   200267 450500                    STP0    DQH$+7,,AUTO
         1 000155   200263 631500                    EPPR1   DQH$+3,,AUTO
         1 000156   200266 451500                    STP1    DQH$+6,,AUTO
         1 000157   200262 633500                    EPPR3   DQH$+2,,AUTO
         1 000160   200265 453500                    STP3    DQH$+5,,AUTO
         1 000161   000002 236000 2                  LDQ     2
         1 000162   200264 756100                    STQ     DQH$+4,,AUTO
         1 000163   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 000164   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000165   000000 701000 xent               TSX1    MME$CVM
         1 000166   000170 702000 1                  TSX2    s:11868
         1 000167   000173 710000 1                  TRA     s:11870

      426    11868    4                       CALL ITF$FREEZE;

  11868  1 000170   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000171   000000 701000 xent               TSX1    ITF$FREEZE
         1 000172   000000 011000                    NOP     0

      427    11869    4                     END;

      428    11870    3                END;

  11870  1 000173   200005 054100                    AOS     I,,AUTO
         1 000174   200005 235100                    LDA     I,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:76   
         1 000175   000017 115007                    CMPA    15,DL
         1 000176   000145 604400 1                  TMOZ    s:11867

      429    11871    2             NI$FQ$->NI$FQ.HD$ = B$IMX$; /* IOS packets live in B$IMX for the RPM */

  11871  1 000177   000000 236000 xsym               LDQ     B$IMX$
         1 000200   000000 470400 xsym               LDP0    NI$FQ$
         1 000201   000002 756100                    STQ     2,,PR0

      430    11872    2             REQ$ = NI$FQ$->NI$FQ.HD$;

  11872  1 000202   200171 756100                    STQ     REQ$,,AUTO

      431    11873    3             DO I = 1 TO NI_NUMIOS;
             11873                      /* Need to link 'em here, cause they aren't written to disk */

  11873  1 000203   000001 235007                    LDA     1,DL
         1 000204   200005 755100                    STA     I,,AUTO
         1 000205   000216 710000 1                  TRA     s:11876+1

      432    11874    3                  REQ$->NI$REQ.FL$=PINCRW(REQ$,%IMX_IOSMBX_SIZE);

  11874  1 000206   200171 236100                    LDQ     REQ$,,AUTO
         1 000207   000040 036003                    ADLQ    32,DU
         1 000210   200171 470500                    LDP0    REQ$,,AUTO
         1 000211   000000 756100                    STQ     0,,PR0

      433    11875    3                  REQ$ = PINCRW(REQ$,%IMX_IOSMBX_SIZE);

  11875  1 000212   200171 236100                    LDQ     REQ$,,AUTO
         1 000213   000040 036003                    ADLQ    32,DU
         1 000214   200171 756100                    STQ     REQ$,,AUTO

      434    11876    3                END;

  11876  1 000215   200005 054100                    AOS     I,,AUTO
         1 000216   200005 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:77   
         1 000217   000000 116000 xsym               CMPQ    NI_NUMIOS
         1 000220   000206 604400 1                  TMOZ    s:11874

      435    11877    2             REQ$ = PINCRW(REQ$,-(%IMX_IOSMBX_SIZE));

  11877  1 000221   200171 236100                    LDQ     REQ$,,AUTO
         1 000222   777740 036003                    ADLQ    -32,DU
         1 000223   200171 756100                    STQ     REQ$,,AUTO

      436    11878    2             REQ$->NI$REQ.FL$=NI$FQ$->NI$FQ.HD$;

  11878  1 000224   000000 470400 xsym               LDP0    NI$FQ$
         1 000225   000002 236100                    LDQ     2,,PR0
         1 000226   200171 471500                    LDP1    REQ$,,AUTO
         1 000227   100000 756100                    STQ     0,,PR1

      437    11879        /* Assign permanent mailboxes for IMX direct channels */
      438    11880    3             DO I = 0 TO NI_IOMS-1;

  11880  1 000230   200005 450100                    STZ     I,,AUTO
         1 000231   000277 710000 1                  TRA     s:11889+1

      439    11881    4                  DO J = 8 TO %N_MAXCHANS;

  11881  1 000232   000010 235007                    LDA     8,DL
         1 000233   200006 755100                    STA     J,,AUTO

      440    11882    5                      IF NI$CHT$->NI$CHT.POSTER(I*%N_MAXCHANS + J) = ENTADDR(KIQ$FEINT
             11882                                ) THEN DO;

  11882  1 000234   200005 236100                    LDQ     I,,AUTO
         1 000235   000007 736000                    QLS     7
         1 000236   200006 036100                    ADLQ    J,,AUTO
         1 000237   200262 756100                    STQ     DQH$+2,,AUTO
         1 000240   000000 636000 xent               EAQ     KIQ$FEINT
         1 000241   200262 235100                    LDA     DQH$+2,,AUTO
         1 000242   000001 735000                    ALS     1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:78   
         1 000243   000000 470400 xsym               LDP0    NI$CHT$
         1 000244   000001 116105                    CMPQ    1,AL,PR0
         1 000245   000272 601000 1                  TNZ     s:11888

      441    11883    5                            DQH$ = NI$CHT$->NI$CHT.DQH$(I*%N_MAXCHANS + J);

  11883  1 000246   200005 236100                    LDQ     I,,AUTO
         1 000247   000007 736000                    QLS     7
         1 000250   200006 036100                    ADLQ    J,,AUTO
         1 000251   000001 736000                    QLS     1
         1 000252   000000 236106                    LDQ     0,QL,PR0
         1 000253   200173 756100                    STQ     DQH$,,AUTO

      442    11884    5                            CALL NIQ$GETS (REQ$) ALTRET (ITW$ALLOC_ERR);

  11884  1 000254   200171 631500                    EPPR1   REQ$,,AUTO
         1 000255   200262 451500                    STP1    DQH$+2,,AUTO
         1 000256   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000257   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000260   000000 701000 xent               TSX1    NIQ$GETS
         1 000261   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      443    11885    5                            DQH$ -> NI$DQH.MBX$ = PINCRW (REQ$, %IMX_MBX_OFFSET);

  11885  1 000262   200171 236100                    LDQ     REQ$,,AUTO
         1 000263   000010 036003                    ADLQ    8,DU
         1 000264   200173 470500                    LDP0    DQH$,,AUTO
         1 000265   000021 756100                    STQ     17,,PR0

      444    11886    5                           DQH$ -> NI$DQH.IOSTATUS$ = PINCRW (REQ$, %IMX_STATUS_OFFSET
             11886                                     );

  11886  1 000266   200171 236100                    LDQ     REQ$,,AUTO
         1 000267   000020 036003                    ADLQ    16,DU
         1 000270   200173 470500                    LDP0    DQH$,,AUTO
         1 000271   000016 756100                    STQ     14,,PR0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:79   
      445    11887    5                          END;

      446    11888    4                     END;

  11888  1 000272   200006 054100                    AOS     J,,AUTO
         1 000273   200006 235100                    LDA     J,,AUTO
         1 000274   000200 115007                    CMPA    128,DL
         1 000275   000234 604400 1                  TMOZ    s:11882

      447    11889    3                END;

  11889  1 000276   200005 054100                    AOS     I,,AUTO
         1 000277   200005 236100                    LDQ     I,,AUTO
         1 000300   000000 116000 xsym               CMPQ    NI_IOMS
         1 000301   000232 604000 1                  TMI     s:11881

      448    11890    2           END;

  11890  1 000302   000307 710000 1                  TRA     s:11895

      449    11891    2        ELSE DO;

      450    11892    2             NI$IMW$ = PINCRW(B$REAL$,BITBIN(%IMW_BASE));

  11892  1 000303   000000 236000 xsym               LDQ     B$REAL$
         1 000304   000740 036003                    ADLQ    480,DU
         1 000305   000000 756000 xsym               STQ     NI$IMW$

      451    11893    2             NI_IMXLO_PBASE = 0;

  11893  1 000306   000000 450000 xsym               STZ     NI_IMXLO_PBASE

      452    11894    2           END;

      453    11895    1        NI_INTENTRY.LOC = NI_ENTRY.LOC ;

  11895  1 000307   000111 220000 0                  LDX0    NI_ENTADDR
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:80   
         1 000310   000000 740000 xsym               STX0    NI_INTENTRY

      454    11896    1        B$REAL$ -> REAL.L30 = NI_INTENTRY;

  11896  1 000311   000000 237000 xsym               LDAQ    NI_INTENTRY
         1 000312   000000 470400 xsym               LDP0    B$REAL$
         1 000313   000030 757100                    STAQ    24,,PR0

      455    11897        /**/
      456    11898    1        I = S_NSCPU;                       /* INIT SLAVES                      */

  11898  1 000314   000000 235000 xsym               LDA     S_NSCPU
         1 000315   200005 755100                    STA     I,,AUTO

      457    11899    1        S_NSCPU = 0;

  11899  1 000316   000000 450000 xsym               STZ     S_NSCPU

      458    11900    2        DO WHILE (S_NSCPU < I);

  11900  1 000317   000000 236000 xsym               LDQ     S_NSCPU
         1 000320   000335 604000 1                  TMI     s:11905
         1 000321   200005 116100                    CMPQ    I,,AUTO
         1 000322   000335 605000 1                  TPL     s:11905

      459    11901    2             S_NSCPU = S_NSCPU + 1;

  11901  1 000323   000000 235000 xsym               LDA     S_NSCPU
         1 000324   000001 035007                    ADLA    1,DL
         1 000325   000000 755000 xsym               STA     S_NSCPU

      460    11902    2             CALL ITP$PROCREC;

  11902  1 000326   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000327   000000 701000 xent               TSX1    ITP$PROCREC
         1 000330   000000 011000                    NOP     0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:81   
      461    11903    2           END;

  11903  1 000331   000000 236000 xsym               LDQ     S_NSCPU
         1 000332   000335 604000 1                  TMI     s:11905
         1 000333   200005 116100                    CMPQ    I,,AUTO
         1 000334   000323 604000 1                  TMI     s:11901

      462    11904        /**/
      463    11905    2        IF (S_NSCPU ~= 0) THEN DO;         /* INIT SLAVE/MASTER MAPS FOR MM      */

  11905  1 000335   000000 116003                    CMPQ    0,DU
         1 000336   000541 600000 1                  TZE     s:11956

      464    11906    2             CVM$ = B$WINDOW$;

  11906  1 000337   000000 236000 xsym               LDQ     B$WINDOW$
         1 000340   200201 756100                    STQ     CVM$,,AUTO

      465    11907        /**/
      466    11908    3             DO I = 1 TO S_NSCPU;

  11908  1 000341   000001 235007                    LDA     1,DL
         1 000342   200005 755100                    STA     I,,AUTO
         1 000343   000446 710000 1                  TRA     s:11930+1

      467    11909    3                  CALL MME$CVM(%MON_WSQ,%WINDOWLO,IT_SCPUJIT(I),J) ALTRET(CVM_ERR);

  11909  1 000344   200006 630500                    EPPR0   J,,AUTO
         1 000345   200265 450500                    STP0    DQH$+5,,AUTO
         1 000346   200005 720100                    LXL0    I,,AUTO
         1 000347   000000 631410 xsym               EPPR1   IT_SCPUJIT,X0
         1 000350   200264 451500                    STP1    DQH$+4,,AUTO
         1 000351   000004 237000 2                  LDAQ    4
         1 000352   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000353   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000354   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000355   000000 701000 xent               TSX1    MME$CVM
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:82   
         1 000356   006741 702000 1                  TSX2    CVM_ERR

      468    11910        /**/
      469    11911    4                  DO CASE (I);

  11911  1 000357   200005 235100                    LDA     I,,AUTO
         1 000360   000006 115007                    CMPA    6,DL
         1 000361   000363 602005 1                  TNC     s:11911+4,AL
         1 000362   000433 710000 1                  TRA     s:11929
         1 000363   000433 710000 1                  TRA     s:11929
         1 000364   000371 710000 1                  TRA     s:11913
         1 000365   000400 710000 1                  TRA     s:11916
         1 000366   000407 710000 1                  TRA     s:11919
         1 000367   000416 710000 1                  TRA     s:11922
         1 000370   000425 710000 1                  TRA     s:11925

      470    11912    4                  CASE (1);

      471    11913    4                     B$MPT$ -> B$MAP(%SLV1PTPG) = CVM$ -> B$MAP(%PGTBLLO);

  11913  1 000371   200201 470500                    LDP0    CVM$,,AUTO
         1 000372   000000 236100                    LDQ     0,,PR0
         1 000373   000000 471400 xsym               LDP1    B$MPT$
         1 000374   100551 756100                    STQ     361,,PR1

      472    11914    4                     B$MPT$ -> B$MAP(%SLV1HJITPG) = CVM$ -> B$MAP(%HJITPG);

  11914  1 000375   000015 236100                    LDQ     13,,PR0
         1 000376   100561 756100                    STQ     369,,PR1
         1 000377   000433 710000 1                  TRA     s:11929

      473    11915    4                  CASE (2);

      474    11916    4                     B$MPT$ -> B$MAP(%SLV2PTPG) = CVM$ -> B$MAP(%PGTBLLO);

  11916  1 000400   200201 470500                    LDP0    CVM$,,AUTO
         1 000401   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:83   
         1 000402   000000 471400 xsym               LDP1    B$MPT$
         1 000403   100552 756100                    STQ     362,,PR1

      475    11917    4                     B$MPT$ -> B$MAP(%SLV2HJITPG) = CVM$ -> B$MAP(%HJITPG);

  11917  1 000404   000015 236100                    LDQ     13,,PR0
         1 000405   100562 756100                    STQ     370,,PR1
         1 000406   000433 710000 1                  TRA     s:11929

      476    11918    4                  CASE (3);

      477    11919    4                     B$MPT$ -> B$MAP(%SLV3PTPG) = CVM$ -> B$MAP(%PGTBLLO);

  11919  1 000407   200201 470500                    LDP0    CVM$,,AUTO
         1 000410   000000 236100                    LDQ     0,,PR0
         1 000411   000000 471400 xsym               LDP1    B$MPT$
         1 000412   100553 756100                    STQ     363,,PR1

      478    11920    4                     B$MPT$ -> B$MAP(%SLV3HJITPG) = CVM$ -> B$MAP(%HJITPG);

  11920  1 000413   000015 236100                    LDQ     13,,PR0
         1 000414   100563 756100                    STQ     371,,PR1
         1 000415   000433 710000 1                  TRA     s:11929

      479    11921    4                  CASE (4);

      480    11922    4                     B$MPT$ -> B$MAP(%SLV4PTPG) = CVM$ -> B$MAP(%PGTBLLO);

  11922  1 000416   200201 470500                    LDP0    CVM$,,AUTO
         1 000417   000000 236100                    LDQ     0,,PR0
         1 000420   000000 471400 xsym               LDP1    B$MPT$
         1 000421   100554 756100                    STQ     364,,PR1

      481    11923    4                     B$MPT$ -> B$MAP(%SLV4HJITPG) = CVM$ -> B$MAP(%HJITPG);

  11923  1 000422   000015 236100                    LDQ     13,,PR0
         1 000423   100564 756100                    STQ     372,,PR1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:84   
         1 000424   000433 710000 1                  TRA     s:11929

      482    11924    4                  CASE (5);

      483    11925    4                     B$MPT$ -> B$MAP(%SLV5PTPG) = CVM$ -> B$MAP(%PGTBLLO);

  11925  1 000425   200201 470500                    LDP0    CVM$,,AUTO
         1 000426   000000 236100                    LDQ     0,,PR0
         1 000427   000000 471400 xsym               LDP1    B$MPT$
         1 000430   100555 756100                    STQ     365,,PR1

      484    11926    4                     B$MPT$ -> B$MAP(%SLV5HJITPG) = CVM$ -> B$MAP(%HJITPG);

  11926  1 000431   000015 236100                    LDQ     13,,PR0
         1 000432   100565 756100                    STQ     373,,PR1

      485    11927    4                  END;

      486    11928        /**/
      487    11929    3                  CALL MME$CVM(%MON_WSQ,%WINDOWLO,-1,J) ALTRET(CVM_ERR); /* RELEASE */

  11929  1 000433   200006 630500                    EPPR0   J,,AUTO
         1 000434   200265 450500                    STP0    DQH$+5,,AUTO
         1 000435   000006 236000 2                  LDQ     6
         1 000436   200264 756100                    STQ     DQH$+4,,AUTO
         1 000437   000004 237000 2                  LDAQ    4
         1 000440   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000441   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000442   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000443   000000 701000 xent               TSX1    MME$CVM
         1 000444   006741 702000 1                  TSX2    CVM_ERR

      488    11930    3                END;

  11930  1 000445   200005 054100                    AOS     I,,AUTO
         1 000446   000000 236000 xsym               LDQ     S_NSCPU
         1 000447   000344 604000 1                  TMI     s:11909
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:85   
         1 000450   200005 116100                    CMPQ    I,,AUTO
         1 000451   000344 605000 1                  TPL     s:11909

      489    11931        /**/
      490    11932    3             DO I = 1 TO S_NSCPU;

  11932  1 000452   000001 235007                    LDA     1,DL
         1 000453   200005 755100                    STA     I,,AUTO
         1 000454   000535 710000 1                  TRA     s:11949+1

      491    11933    3                  CALL MME$CVM(%MON_WSQ,%WINDOWLO,IT_SCPUJIT(I),J) ALTRET(CVM_ERR);

  11933  1 000455   200006 630500                    EPPR0   J,,AUTO
         1 000456   200265 450500                    STP0    DQH$+5,,AUTO
         1 000457   200005 720100                    LXL0    I,,AUTO
         1 000460   000000 631410 xsym               EPPR1   IT_SCPUJIT,X0
         1 000461   200264 451500                    STP1    DQH$+4,,AUTO
         1 000462   000004 237000 2                  LDAQ    4
         1 000463   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000464   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000465   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000466   000000 701000 xent               TSX1    MME$CVM
         1 000467   006741 702000 1                  TSX2    CVM_ERR

      492    11934        /**/
      493    11935    3                  CVM$ -> B$MAP(%MASTERPTPG) = B$MPT$ -> B$MAP(%MASTERPTPG);

  11935  1 000470   000000 470400 xsym               LDP0    B$MPT$
         1 000471   000550 236100                    LDQ     360,,PR0
         1 000472   200201 471500                    LDP1    CVM$,,AUTO
         1 000473   100550 756100                    STQ     360,,PR1

      494    11936    3                  CVM$ -> B$MAP(%MASTERHJITPG) = B$MPT$ -> B$MAP(%MASTERHJITPG);

  11936  1 000474   000560 236100                    LDQ     368,,PR0
         1 000475   100560 756100                    STQ     368,,PR1

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:86   
      495    11937    3                  CVM$ -> B$MAP(%SLV1PTPG) = B$MPT$ -> B$MAP(%SLV1PTPG);

  11937  1 000476   000551 236100                    LDQ     361,,PR0
         1 000477   100551 756100                    STQ     361,,PR1

      496    11938    3                  CVM$ -> B$MAP(%SLV1HJITPG) = B$MPT$ -> B$MAP(%SLV1HJITPG);

  11938  1 000500   000561 236100                    LDQ     369,,PR0
         1 000501   100561 756100                    STQ     369,,PR1

      497    11939    3                  CVM$ -> B$MAP(%SLV2PTPG) = B$MPT$ -> B$MAP(%SLV2PTPG);

  11939  1 000502   000552 236100                    LDQ     362,,PR0
         1 000503   100552 756100                    STQ     362,,PR1

      498    11940    3                  CVM$ -> B$MAP(%SLV2HJITPG) = B$MPT$ -> B$MAP(%SLV2HJITPG);

  11940  1 000504   000562 236100                    LDQ     370,,PR0
         1 000505   100562 756100                    STQ     370,,PR1

      499    11941    3                  CVM$ -> B$MAP(%SLV3PTPG) = B$MPT$ -> B$MAP(%SLV3PTPG);

  11941  1 000506   000553 236100                    LDQ     363,,PR0
         1 000507   100553 756100                    STQ     363,,PR1

      500    11942    3                  CVM$ -> B$MAP(%SLV3HJITPG) = B$MPT$ -> B$MAP(%SLV3HJITPG);

  11942  1 000510   000563 236100                    LDQ     371,,PR0
         1 000511   100563 756100                    STQ     371,,PR1

      501    11943    3                  CVM$ -> B$MAP(%SLV4PTPG) = B$MPT$ -> B$MAP(%SLV4PTPG);

  11943  1 000512   000554 236100                    LDQ     364,,PR0
         1 000513   100554 756100                    STQ     364,,PR1

      502    11944    3                  CVM$ -> B$MAP(%SLV4HJITPG) = B$MPT$ -> B$MAP(%SLV4HJITPG);

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:87   
  11944  1 000514   000564 236100                    LDQ     372,,PR0
         1 000515   100564 756100                    STQ     372,,PR1

      503    11945    3                  CVM$ -> B$MAP(%SLV5PTPG) = B$MPT$ -> B$MAP(%SLV5PTPG);

  11945  1 000516   000555 236100                    LDQ     365,,PR0
         1 000517   100555 756100                    STQ     365,,PR1

      504    11946    3                  CVM$ -> B$MAP(%SLV5HJITPG) = B$MPT$ -> B$MAP(%SLV5HJITPG);

  11946  1 000520   000565 236100                    LDQ     373,,PR0
         1 000521   100565 756100                    STQ     373,,PR1

      505    11947        /**/
      506    11948    3                  CALL MME$CVM(%MON_WSQ,%WINDOWLO,-1,J) ALTRET(CVM_ERR);

  11948  1 000522   200006 633500                    EPPR3   J,,AUTO
         1 000523   200265 453500                    STP3    DQH$+5,,AUTO
         1 000524   000006 236000 2                  LDQ     6
         1 000525   200264 756100                    STQ     DQH$+4,,AUTO
         1 000526   000004 237000 2                  LDAQ    4
         1 000527   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000530   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000531   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000532   000000 701000 xent               TSX1    MME$CVM
         1 000533   006741 702000 1                  TSX2    CVM_ERR

      507    11949    3                END;

  11949  1 000534   200005 054100                    AOS     I,,AUTO
         1 000535   000000 236000 xsym               LDQ     S_NSCPU
         1 000536   000455 604000 1                  TMI     s:11933
         1 000537   200005 116100                    CMPQ    I,,AUTO
         1 000540   000455 605000 1                  TPL     s:11933

      508    11950    2           END;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:88   
      509    11951        /**/
      510    11952        /*
      511    11953          ****     RELEASE COMGROUP MAP PAGES WHICH EXCEED THE NUMBER SPECIFED OR
      512    11954          ****     THE DEFAULT. AARDVARK ALWAYS ALLOCATES THE MAXIMUM.
      513    11955        */
      514    11956    1        I = MM_CGQMAP_PGS;

  11956  1 000541   000000 235000 xsym               LDA     MM_CGQMAP_PGS
         1 000542   200005 755100                    STA     I,,AUTO

      515    11957    2        DO WHILE (I < %MM_CGQMAX#);

  11957  1 000543   000012 115007                    CMPA    10,DL
         1 000544   000570 605000 1                  TPL     s:11962

      516    11958    2             CALL MME$WFVP(%MON_WSQ,%CGPGTBLLO+I,0,J);

  11958  1 000545   200005 235100                    LDA     I,,AUTO
         1 000546   000001 035007                    ADLA    1,DL
         1 000547   200262 755100                    STA     DQH$+2,,AUTO
         1 000550   200006 630500                    EPPR0   J,,AUTO
         1 000551   200267 450500                    STP0    DQH$+7,,AUTO
         1 000552   000010 236000 2                  LDQ     8
         1 000553   200266 756100                    STQ     DQH$+6,,AUTO
         1 000554   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 000555   200265 451500                    STP1    DQH$+5,,AUTO
         1 000556   000002 236000 2                  LDQ     2
         1 000557   200264 756100                    STQ     DQH$+4,,AUTO
         1 000560   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 000561   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000562   000000 701000 xent               TSX1    MME$WFVP
         1 000563   000000 011000                    NOP     0

      517    11959    2             I = I+1;

  11959  1 000564   200005 054100                    AOS     I,,AUTO

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:89   
      518    11960    2           END;

  11960  1 000565   200005 235100                    LDA     I,,AUTO
         1 000566   000012 115007                    CMPA    10,DL
         1 000567   000545 604000 1                  TMI     s:11958

      519    11961        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:90   
      520    11962    2        DO I = 1 TO NK_MXLOCAL;

  11962  1 000570   000001 236007                    LDQ     1,DL
         1 000571   200005 756100                    STQ     I,,AUTO
         1 000572   000617 710000 1                  TRA     s:11966+1

      521    11963    2             IF NI$IOM$(N$DCT$(I)->NI$DCT.DQH$->NI$DQH.IOCHAN.IOM)->NI$IOM.ADDRESS =
             11963                      IT_CONFIG.IOM.PORT AND

  11963  1 000573   000000 470400 xsym               LDP0    N$DCT$$
         1 000574   200005 720100                    LXL0    I,,AUTO
         1 000575   000000 471510                    LDP1    0,X0,PR0
         1 000576   100023 473500                    LDP3    19,,PR1
         1 000577   300001 236100                    LDQ     1,,PR3
         1 000600   000031 772000                    QRL     25
         1 000601   000003 376007                    ANQ     3,DL
         1 000602   000000 474406 xsym               LDP4    NI$IOM$,QL
         1 000603   400003 236100                    LDQ     3,,PR4
         1 000604   000007 376007                    ANQ     7,DL
         1 000605   000000 116000 xsym               CMPQ    IT_CONFIG
         1 000606   000616 601000 1                  TNZ     s:11966
         1 000607   300001 236100                    LDQ     1,,PR3
         1 000610   000022 772000                    QRL     18
         1 000611   000177 376007                    ANQ     127,DL
         1 000612   000002 116000 xsym               CMPQ    IT_CONFIG+2
         1 000613   000616 601000 1                  TNZ     s:11966

      522    11964    2                  N$DCT$(I)->NI$DCT.DQH$->NI$DQH.IOCHAN.CHANNEL = IT_CONFIG.SC01.CHAN
             11964                           THEN
      523    11965    2                  B_SCDCTX = I;

  11965  1 000614   200005 235100                    LDA     I,,AUTO
         1 000615   000000 755000 xsym               STA     B_SCDCTX

      524    11966    2           END;

  11966  1 000616   200005 054100                    AOS     I,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:91   
         1 000617   200005 236100                    LDQ     I,,AUTO
         1 000620   000000 116000 xsym               CMPQ    NK_MXLOCAL
         1 000621   000573 604400 1                  TMOZ    s:11963

      525    11967
      526    11968    2        IF NOT HW_NORM_CLOCK THEN DO;      /* FIX THE CLOCK, BEFORE ITZ!! */

  11968  1 000622   000000 234000 xsym               SZN     HW_NORM_CLOCK
         1 000623   000715 604000 1                  TMI     s:11980

      527    11969    2             CALL HFC$RSCR ('000000006121'O, 32, XXX_CLOCK);

  11969  1 000624   200234 630500                    EPPR0   XXX_CLOCK,,AUTO
         1 000625   200264 450500                    STP0    DQH$+4,,AUTO
         1 000626   000012 237000 2                  LDAQ    10
         1 000627   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000630   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000631   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000632   000000 701000 xent               TSX1    HFC$RSCR
         1 000633   000000 011000                    NOP     0

      528    11970    2             LOCAL_DATE.S1 = '/';

  11970  1 000634   057000 236007                    LDQ     24064,DL
         1 000635   200236 552110                    STBQ    LOCAL_DATE,'10'O,AUTO

      529    11971    2             LOCAL_DATE.S2 = '/';

  11971  1 000636   000057 236003                    LDQ     47,DU
         1 000637   200237 552120                    STBQ    LOCAL_DATE+1,'20'O,AUTO

      530    11972    2             CALL BINCHAR(LOCAL_DATE.Y, MOD(XXX_CLOCK.DATE.Y,100));

  11972  1 000640   200234 236100                    LDQ     XXX_CLOCK,,AUTO
         1 000641   000030 772000                    QRL     24
         1 000642   000144 506007                    DIV     100,DL
         1 000643   000044 773000                    LRL     36
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:92   
         1 000644   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000645   000100 301500                    BTD
         1 000646   200262 000010                    NDSC9   DQH$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 000647   200237 430002                    NDSC9   LOCAL_DATE+1,,AUTO       cn=2,s=nosgn,sf=0,n=2

      531    11973    2             CALL BINCHAR(LOCAL_DATE.M, XXX_CLOCK.DATE.M);

  11973  1 000650   200234 236100                    LDQ     XXX_CLOCK,,AUTO
         1 000651   000022 772000                    QRL     18
         1 000652   000077 376007                    ANQ     63,DL
         1 000653   000000 235003                    LDA     0,DU
         1 000654   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000655   000100 301500                    BTD
         1 000656   200262 000010                    NDSC9   DQH$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 000657   200236 030002                    NDSC9   LOCAL_DATE,,AUTO         cn=0,s=nosgn,sf=0,n=2

      532    11974    2             CALL BINCHAR(LOCAL_DATE.D, XXX_CLOCK.DATE.D);

  11974  1 000660   200234 236100                    LDQ     XXX_CLOCK,,AUTO
         1 000661   000014 772000                    QRL     12
         1 000662   000077 376007                    ANQ     63,DL
         1 000663   000000 235003                    LDA     0,DU
         1 000664   200262 757100                    STAQ    DQH$+2,,AUTO
         1 000665   000100 301500                    BTD
         1 000666   200262 000010                    NDSC9   DQH$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 000667   200236 630002                    NDSC9   LOCAL_DATE,,AUTO         cn=3,s=nosgn,sf=0,n=2

      533    11975    2             IT_CLOFF='0'B;

  11975  1 000670   000000 235003                    LDA     0,DU
         1 000671   000000 236003                    LDQ     0,DU
         1 000672   000000 757000 xsym               STAQ    IT_CLOFF

      534    11976    2             CALL UMT$LCLDATE (UTS_DATE, LOCAL_DATE, '00:00:00.00');

  11976  1 000673   000014 236000 2                  LDQ     12
         1 000674   200264 756100                    STQ     DQH$+4,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:93   
         1 000675   200236 630500                    EPPR0   LOCAL_DATE,,AUTO
         1 000676   200263 450500                    STP0    DQH$+3,,AUTO
         1 000677   200242 631500                    EPPR1   UTS_DATE,,AUTO
         1 000700   200262 451500                    STP1    DQH$+2,,AUTO
         1 000701   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000702   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000703   000000 701000 xent               TSX1    UMT$LCLDATE
         1 000704   000000 011000                    NOP     0

      535    11977    2             CALL ITG$MPY10000 (IT_CLOFF, UTS_DATE);

  11977  1 000705   200242 630500                    EPPR0   UTS_DATE,,AUTO
         1 000706   200263 450500                    STP0    DQH$+3,,AUTO
         1 000707   000015 236000 2                  LDQ     13
         1 000710   200262 756100                    STQ     DQH$+2,,AUTO
         1 000711   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000712   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000713   000000 701000 xent               TSX1    ITG$MPY10000
         1 000714   000000 011000                    NOP     0

      536    11978    2           END;

      537    11979
      538    11980    1        IF  ( IT_BOOTFLAG >= I_DISKBOOT )

  11980  1 000715   000000 235000 xsym               LDA     IT_BOOTFLAG
         1 000716   000007 115007                    CMPA    7,DL
         1 000717   001005 602000 1                  TNC     s:11999

      539    11981    2        THEN DO;                           /* DB OR RECOVERY             */

      540    11982    2             CALL ITZ$RECOVER;

  11982  1 000720   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000721   000000 701000 xent               TSX1    ITZ$RECOVER
         1 000722   000000 011000                    NOP     0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:94   
      541    11983    3             DO I = 1 TO NK_MXLOCAL;

  11983  1 000723   000001 235007                    LDA     1,DL
         1 000724   200005 755100                    STA     I,,AUTO
         1 000725   000777 710000 1                  TRA     s:11993+1

      542    11984    3                  IF NOT IT_PARTITION.DEVICE(I)

  11984  1 000726   200005 235100                    LDA     I,,AUTO
         1 000727   000731 605000 1                  TPL     s:11984+3
         1 000730   000044 035003                    ADLA    36,DU
         1 000731   000000 066405                    CMPB    filb='0'B
         1 000732   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1
         1 000733   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000734   000776 601000 1                  TNZ     s:11993
         1 000735   200005 235100                    LDA     I,,AUTO
         1 000736   000740 605000 1                  TPL     s:11984+10
         1 000737   000044 035003                    ADLA    36,DU
         1 000740   000000 066405                    CMPB    filb='2'B
         1 000741   000031 000001 xsym               BDSC    IT_PARTITION+25,A        by=0,bit=0,n=1
         1 000742   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000743   000776 601000 1                  TNZ     s:11993
         1 000744   000000 470400 xsym               LDP0    N$DCT$$
         1 000745   200005 720100                    LXL0    I,,AUTO
         1 000746   000000 471510                    LDP1    0,X0,PR0
         1 000747   100007 236100                    LDQ     7,,PR1
         1 000750   007700 376007                    ANQ     4032,DL
         1 000751   000700 116007                    CMPQ    448,DL
         1 000752   000776 601000 1                  TNZ     s:11993
         1 000753   100041 236100                    LDQ     33,,PR1
         1 000754   000116 116000 0                  CMPQ    NI_ENTADDR+5
         1 000755   000776 600000 1                  TZE     s:11993

      543    11985    3                       AND NOT IT_PARTITION.MSOS_DEVICE(I)
      544    11986    3                       AND N$DCT$(I)->NI$DCT.TYPE = %DV_MPC
      545    11987    3                       AND N$DCT$(I)->NI$DCT.MPC.FWNAME ~= 'NONE'
      546    11988    4                  THEN DO ;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:95   

      547    11989    4                       N$DCT$(I)->NI$DCT.DFLG.MPCSTOP = '0'B ;

  11989  1 000756   000016 236000 2                  LDQ     14
         1 000757   100006 356100                    ANSQ    6,,PR1

      548    11990    4                       CALL NIW$MPCSTOP ( N$DCT$(I)->NI$DCT ) ;

  11990  1 000760   000000 471510                    LDP1    0,X0,PR0
         1 000761   200262 451500                    STP1    DQH$+2,,AUTO
         1 000762   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000763   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000764   000000 701000 xent               TSX1    NIW$MPCSTOP
         1 000765   000000 011000                    NOP     0

      549    11991    4                       CALL NIW$MPCSTART ( N$DCT$(I)->NI$DCT ) ;

  11991  1 000766   000000 470400 xsym               LDP0    N$DCT$$
         1 000767   200005 720100                    LXL0    I,,AUTO
         1 000770   000000 471510                    LDP1    0,X0,PR0
         1 000771   200262 451500                    STP1    DQH$+2,,AUTO
         1 000772   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 000773   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000774   000000 701000 xent               TSX1    NIW$MPCSTART
         1 000775   000000 011000                    NOP     0

      550    11992    4                     END ;

      551    11993    3                END;

  11993  1 000776   200005 054100                    AOS     I,,AUTO
         1 000777   200005 236100                    LDQ     I,,AUTO
         1 001000   000000 116000 xsym               CMPQ    NK_MXLOCAL
         1 001001   000726 604400 1                  TMOZ    s:11984

      552    11994    2             CALL IOSPIN ;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:96   
  11994  1 001002   006550 701000 1                  TSX1    IOSPIN
         1 001003   000000 011000                    NOP     0

      553    11995    2           END ;

  11995  1 001004   002413 710000 1                  TRA     s:12238

      554    11996        /**/
      555    11997    2        ELSE DO;                           /* NOT DB OR RECOVERY                 */

      556    11998        /**/
      557    11999    2             S_SYSID = JG_MING# + 1;

  11999  1 001005   000020 236007                    LDQ     16,DL
         1 001006   000000 756000 xsym               STQ     S_SYSID

      558    12000        /**/
      559    12001    2             FR_PRM$(%M_GHOST#) -> FR$PR(FR_DP) = /* SET GHOST MAX TO TOTAL     */

  12001  1 001007   000000 470400 xsym               LDP0    FR_PRM$
         1 001010   000002 471400 xsym               LDP1    FR_PRM$+2
         1 001011   000000 235100                    LDA     0,,PR0
         1 001012   100000 755100                    STA     0,,PR1

      560    12002    2                  FR_PRM$(0) -> FR$PR(FR_DP);
      561    12003    2             FR_PRM$(%M_GHOST#) -> FR$PR(FR_MT) =

  12003  1 001013   000000 470400 xsym               LDP0    FR_PRM$
         1 001014   000002 471400 xsym               LDP1    FR_PRM$+2
         1 001015   000001 235100                    LDA     1,,PR0
         1 001016   100001 755100                    STA     1,,PR1

      562    12004    2                  FR_PRM$(0) -> FR$PR(FR_MT);
      563    12005    2             FR_PRM$(%M_GHOST#) -> FR$PR(FR_NPOOL) =

  12005  1 001017   000002 471400 xsym               LDP1    FR_PRM$+2
         1 001020   000002 235100                    LDA     2,,PR0
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:97   
         1 001021   100002 755100                    STA     2,,PR1

      564    12006    2                  FR_PRM$(0) -> FR$PR(FR_NPOOL);
      565    12007        /**/
      566    12008        /**/
      567    12009    2             PTR$ -> N$DCT$(0) = ADDR(NIL);

  12009  1 001022   200003 471500                    LDP1    @PTR$,,AUTO
         1 001023   100000 473500                    LDP3    0,,PR1
         1 001024   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001025   300000 756100                    STQ     0,,PR3

      568    12010        /**/
      569    12011    2             I = 1;

  12011  1 001026   000001 235007                    LDA     1,DL
         1 001027   200005 755100                    STA     I,,AUTO

      570    12012    3             DO WHILE (N$DCT$$ -> N$DCT$(I) ~= ADDR(NIL));

  12012  1 001030   001040 710000 1                  TRA     s:12015

      571    12013    3                  PTR$ -> N$DCT$(I) = N$DCT$$ -> N$DCT$(I);

  12013  1 001031   200003 470500                    LDP0    @PTR$,,AUTO
         1 001032   000000 471500                    LDP1    0,,PR0
         1 001033   000000 473400 xsym               LDP3    N$DCT$$
         1 001034   200005 720100                    LXL0    I,,AUTO
         1 001035   300000 236110                    LDQ     0,X0,PR3
         1 001036   100000 756110                    STQ     0,X0,PR1

      572    12014    3                  I = I+1;

  12014  1 001037   200005 054100                    AOS     I,,AUTO

      573    12015    3                END;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:98   
  12015  1 001040   000000 470400 xsym               LDP0    N$DCT$$
         1 001041   200005 720100                    LXL0    I,,AUTO
         1 001042   000000 236110                    LDQ     0,X0,PR0
         1 001043   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001044   001031 601000 1                  TNZ     s:12013

      574    12016        /**/
      575    12017    3             DO I = I TO N_DCTXMAX;

  12017  1 001045   001054 710000 1                  TRA     s:12019+1

      576    12018    3                  PTR$ -> N$DCT$(I) = ADDR(NIL);

  12018  1 001046   200003 470500                    LDP0    @PTR$,,AUTO
         1 001047   000000 471500                    LDP1    0,,PR0
         1 001050   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001051   200005 720100                    LXL0    I,,AUTO
         1 001052   100000 756110                    STQ     0,X0,PR1

      577    12019    3                END;

  12019  1 001053   200005 054100                    AOS     I,,AUTO
         1 001054   200005 236100                    LDQ     I,,AUTO
         1 001055   000000 116000 xsym               CMPQ    N_DCTXMAX
         1 001056   001046 604400 1                  TMOZ    s:12018

      578    12020        /**/
      579    12021    2             N$DCT$$ = PTR$;

  12021  1 001057   200003 470500                    LDP0    @PTR$,,AUTO
         1 001060   000000 236100                    LDQ     0,,PR0
         1 001061   000000 756000 xsym               STQ     N$DCT$$

      580    12022        /**/
      581    12023    2             CALL ITH$ALLOCATE(PTR$,N_DCTXMAX+1) ALTRET(ITW$ALLOC_ERR);

  12023  1 001062   000000 235000 xsym               LDA     N_DCTXMAX
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:99   
         1 001063   000001 035007                    ADLA    1,DL
         1 001064   200262 755100                    STA     DQH$+2,,AUTO
         1 001065   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 001066   200265 451500                    STP1    DQH$+5,,AUTO
         1 001067   200003 236100                    LDQ     @PTR$,,AUTO
         1 001070   200264 756100                    STQ     DQH$+4,,AUTO
         1 001071   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 001072   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001073   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001074   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      582    12024    2             IT_SYSDIR$=PTR$;              /* AREA FOR SYSTEM AREA DIRECTORY     */

  12024  1 001075   200003 470500                    LDP0    @PTR$,,AUTO
         1 001076   000000 236100                    LDQ     0,,PR0
         1 001077   000000 756000 xsym               STQ     IT_SYSDIR$

      583    12025    2             CALL ITH$ALLOCATE(PTR$,SIZEW(I$DISKDIR)) ALTRET(ITW$ALLOC_ERR);

  12025  1 001100   000020 236000 2                  LDQ     16
         1 001101   200003 235100                    LDA     @PTR$,,AUTO
         1 001102   200262 757100                    STAQ    DQH$+2,,AUTO
         1 001103   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 001104   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001105   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001106   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      584    12026        /**/
      585    12027    2             KI_FEI$$ = PTR$;

  12027  1 001107   200003 470500                    LDP0    @PTR$,,AUTO
         1 001110   000000 236100                    LDQ     0,,PR0
         1 001111   000000 756000 xsym               STQ     KI_FEI$$

      586    12028    2             CALL ITH$ALLOCATE(PTR$,1+KI_MXFE) ALTRET(ITW$ALLOC_ERR);

  12028  1 001112   000000 235000 xsym               LDA     KI_MXFE
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:100  
         1 001113   000001 035007                    ADLA    1,DL
         1 001114   200262 755100                    STA     DQH$+2,,AUTO
         1 001115   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 001116   200265 451500                    STP1    DQH$+5,,AUTO
         1 001117   200003 236100                    LDQ     @PTR$,,AUTO
         1 001120   200264 756100                    STQ     DQH$+4,,AUTO
         1 001121   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 001122   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001123   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001124   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      587    12029    3             DO I = 0 TO KI_MXFE;

  12029  1 001125   200005 450100                    STZ     I,,AUTO
         1 001126   001135 710000 1                  TRA     s:12031+1

      588    12030    3                  KI$FEI$(I) = IT_FEI$$->KI$FEI$(I);

  12030  1 001127   000000 470400 xsym               LDP0    IT_FEI$$
         1 001130   200005 720100                    LXL0    I,,AUTO
         1 001131   000000 236110                    LDQ     0,X0,PR0
         1 001132   000000 471400 xsym               LDP1    KI_FEI$$
         1 001133   100000 756110                    STQ     0,X0,PR1

      589    12031    3                END;

  12031  1 001134   200005 054100                    AOS     I,,AUTO
         1 001135   000000 236000 xsym               LDQ     KI_MXFE
         1 001136   001127 604000 1                  TMI     s:12030
         1 001137   200005 116100                    CMPQ    I,,AUTO
         1 001140   001127 605000 1                  TPL     s:12030

      590    12032
      591    12033        /* Allocate the network route table */
      592    12034    3             DO I = 0 TO KI_NODES;

  12034  1 001141   200005 450100                    STZ     I,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:101  
         1 001142   001231 710000 1                  TRA     s:12046+1

      593    12035    3                  KI$ROUTE$(I) = PTR$;

  12035  1 001143   200003 470500                    LDP0    @PTR$,,AUTO
         1 001144   000000 236100                    LDQ     0,,PR0
         1 001145   000000 471400 xsym               LDP1    KI_ROUTE$$
         1 001146   200005 720100                    LXL0    I,,AUTO
         1 001147   100000 756110                    STQ     0,X0,PR1

      594    12036    3                  PTR$->KI$ROUTE = '0'B;

  12036  1 001150   000000 471500                    LDP1    0,,PR0
         1 001151   000100 100400                    MLR     fill='000'O
         1 001152   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001153   100000 000030                    ADSC9   0,,PR1                   cn=0,n=24

      595    12037    3                  PTR$->KI$ROUTE.NODE_NAME = ' ';

  12037  1 001154   000000 471500                    LDP1    0,,PR0
         1 001155   000035 235000 xsym               LDA     B_VECTNIL+29
         1 001156   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 001157   100000 755100                    STA     0,,PR1
         1 001160   100001 756100                    STQ     1,,PR1

      596    12038    3                  PTR$->KI$ROUTE.CURRENT_QOS = 255;

  12038  1 001161   000000 471500                    LDP1    0,,PR0
         1 001162   000377 236003                    LDQ     255,DU
         1 001163   100002 552120                    STBQ    2,'20'O,PR1

      597    12039    3                  PTR$->KI$ROUTE.ALT_QOS = 255;

  12039  1 001164   000000 471500                    LDP1    0,,PR0
         1 001165   377000 236007                    LDQ     130560,DL
         1 001166   100002 552110                    STBQ    2,'10'O,PR1

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:102  
      598    12040    4                  DO J = 0 TO KI_MXFE;

  12040  1 001167   200006 450100                    STZ     J,,AUTO
         1 001170   001211 710000 1                  TRA     s:12043+1

      599    12041    4                       PTR$->KI$ROUTE.LINK(J) = '0'B;

  12041  1 001171   200003 470500                    LDP0    @PTR$,,AUTO
         1 001172   000000 471500                    LDP1    0,,PR0
         1 001173   200006 236100                    LDQ     J,,AUTO
         1 001174   000014 402007                    MPY     12,DL
         1 001175   000106 100400                    MLR     fill='000'O
         1 001176   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001177   100003 000014                    ADSC9   3,Q,PR1                  cn=0,n=12

      600    12042    4                       PTR$->KI$ROUTE.LINK.QOS(J) = 255;

  12042  1 001200   000000 471500                    LDP1    0,,PR0
         1 001201   200006 236100                    LDQ     J,,AUTO
         1 001202   000003 402007                    MPY     3,DL
         1 001203   000000 620006                    EAX0    0,QL
         1 001204   100003 236106                    LDQ     3,QL,PR1
         1 001205   000032 376000 xsym               ANQ     B_VECTNIL+26
         1 001206   377000 276003                    ORQ     130560,DU
         1 001207   100003 756110                    STQ     3,X0,PR1

      601    12043    4                     END;

  12043  1 001210   200006 054100                    AOS     J,,AUTO
         1 001211   000000 236000 xsym               LDQ     KI_MXFE
         1 001212   001171 604000 1                  TMI     s:12041
         1 001213   200006 116100                    CMPQ    J,,AUTO
         1 001214   001171 605000 1                  TPL     s:12041

      602    12044    3                  K = SIZEW(KI$ROUTE)+KI_MXFE*SIZEW(KI$ROUTE.LINK);

  12044  1 001215   000003 402007                    MPY     3,DL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:103  
         1 001216   000006 036007                    ADLQ    6,DL
         1 001217   200007 756100                    STQ     K,,AUTO

      603    12045    3                  CALL ITH$ALLOCATE(PTR$,K);

  12045  1 001220   200007 631500                    EPPR1   K,,AUTO
         1 001221   200263 451500                    STP1    DQH$+3,,AUTO
         1 001222   200003 236100                    LDQ     @PTR$,,AUTO
         1 001223   200262 756100                    STQ     DQH$+2,,AUTO
         1 001224   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 001225   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001226   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001227   000000 011000                    NOP     0

      604    12046    3                END;

  12046  1 001230   200005 054100                    AOS     I,,AUTO
         1 001231   000000 236000 xsym               LDQ     KI_NODES
         1 001232   001143 604000 1                  TMI     s:12035
         1 001233   200005 116100                    CMPQ    I,,AUTO
         1 001234   001143 605000 1                  TPL     s:12035

      605    12047
      606    12048        /* Allocate the OSI route tables.
      607    12049        */
      608    12050    3             DO I = 0 TO KI_OSIMAX#-1;

  12050  1 001235   200005 450100                    STZ     I,,AUTO
         1 001236   001303 710000 1                  TRA     s:12058+1

      609    12051    3                  KI$OSIROUTE$(I) = PTR$;

  12051  1 001237   200003 470500                    LDP0    @PTR$,,AUTO
         1 001240   000000 236100                    LDQ     0,,PR0
         1 001241   000000 471400 xsym               LDP1    KI_OSIROUTE$$
         1 001242   200005 720100                    LXL0    I,,AUTO
         1 001243   100000 756110                    STQ     0,X0,PR1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:104  

      610    12052    3                  PTR$->KI$OSIROUTE = '0'B;

  12052  1 001244   000000 471500                    LDP1    0,,PR0
         1 001245   000100 100400                    MLR     fill='000'O
         1 001246   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001247   100000 000104                    ADSC9   0,,PR1                   cn=0,n=68

      611    12053    4                  DO J = 0 TO KI_MXFE;

  12053  1 001250   200006 450100                    STZ     J,,AUTO
         1 001251   001262 710000 1                  TRA     s:12055+1

      612    12054    4                       PTR$->KI$OSIROUTE.LINK(J) = '0'B;

  12054  1 001252   200003 470500                    LDP0    @PTR$,,AUTO
         1 001253   000000 471500                    LDP1    0,,PR0
         1 001254   200006 236100                    LDQ     J,,AUTO
         1 001255   000017 402007                    MPY     15,DL
         1 001256   000106 100400                    MLR     fill='000'O
         1 001257   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001260   100015 200017                    ADSC9   13,Q,PR1                 cn=1,n=15

      613    12055    4                     END;

  12055  1 001261   200006 054100                    AOS     J,,AUTO
         1 001262   000000 236000 xsym               LDQ     KI_MXFE
         1 001263   001252 604000 1                  TMI     s:12054
         1 001264   200006 116100                    CMPQ    J,,AUTO
         1 001265   001252 605000 1                  TPL     s:12054

      614    12056    3                  K = SIZEW(KI$OSIROUTE)+KI_MXFE*SIZEW(KI$OSIROUTE.LINK);

  12056  1 001266   000000 235000 xsym               LDA     KI_MXFE
         1 001267   000002 735000                    ALS     2
         1 001270   000021 035007                    ADLA    17,DL
         1 001271   200007 755100                    STA     K,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:105  

      615    12057    3                  CALL ITH$ALLOCATE(PTR$,K);

  12057  1 001272   200007 631500                    EPPR1   K,,AUTO
         1 001273   200263 451500                    STP1    DQH$+3,,AUTO
         1 001274   200003 236100                    LDQ     @PTR$,,AUTO
         1 001275   200262 756100                    STQ     DQH$+2,,AUTO
         1 001276   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 001277   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001300   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001301   000000 011000                    NOP     0

      616    12058    3                END;

  12058  1 001302   200005 054100                    AOS     I,,AUTO
         1 001303   200005 236100                    LDQ     I,,AUTO
         1 001304   001237 604000 1                  TMI     s:12051
         1 001305   000000 116000 xsym               CMPQ    KI_OSIMAX#
         1 001306   001237 602000 1                  TNC     s:12051

      617    12059
      618    12060        /* Allocate and initialize OSI Session stuff.
      619    12061        */
      620    12062    2             KIS_MINOR$ = PTR$;

  12062  1 001307   200003 470500                    LDP0    @PTR$,,AUTO
         1 001310   000000 236100                    LDQ     0,,PR0
         1 001311   000000 756000 xsym               STQ     KIS_MINOR$

      621    12063    2             I = 1 + KIS_SSN_MAX;          /* number of words for minor table */

  12063  1 001312   000000 235000 xsym               LDA     KIS_SSN_MAX
         1 001313   000001 035007                    ADLA    1,DL
         1 001314   200005 755100                    STA     I,,AUTO

      622    12064    2             CALL ITH$ALLOCATE( PTR$, I) ALTRET( ITW$ALLOC_ERR);

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:106  
  12064  1 001315   200005 631500                    EPPR1   I,,AUTO
         1 001316   200263 451500                    STP1    DQH$+3,,AUTO
         1 001317   200003 236100                    LDQ     @PTR$,,AUTO
         1 001320   200262 756100                    STQ     DQH$+2,,AUTO
         1 001321   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 001322   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001323   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001324   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      623    12065
      624    12066    2             APPL$ = KIS_MINOR$;

  12066  1 001325   000000 236000 xsym               LDQ     KIS_MINOR$
         1 001326   200042 756100                    STQ     APPL$,,AUTO

      625    12067    3             DO I = 0 TO KIS_SSN_MAX;

  12067  1 001327   200005 450100                    STZ     I,,AUTO
         1 001330   001345 710000 1                  TRA     s:12072+1

      626    12068    3                  APPL$->APPL.TCTX = 0;

  12068  1 001331   000000 220003                    LDX0    0,DU
         1 001332   200042 470500                    LDP0    APPL$,,AUTO
         1 001333   000000 740100                    STX0    0,,PR0

      627    12069    3                  APPL$->APPL.Z.COOKIE = 0;

  12069  1 001334   000000 236003                    LDQ     0,DU
         1 001335   000000 552110                    STBQ    0,'10'O,PR0

      628    12070    3                  APPL$->APPL.Z.LINK = I + 1;

  12070  1 001336   200005 236100                    LDQ     I,,AUTO
         1 001337   000001 036007                    ADLQ    1,DL
         1 001340   000000 552104                    STBQ    0,'04'O,PR0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:107  
      629    12071    3                  APPL$ = PINCRW( APPL$, 1);

  12071  1 001341   200042 236100                    LDQ     APPL$,,AUTO
         1 001342   000001 036003                    ADLQ    1,DU
         1 001343   200042 756100                    STQ     APPL$,,AUTO

      630    12072    3                END;

  12072  1 001344   200005 054100                    AOS     I,,AUTO
         1 001345   000000 236000 xsym               LDQ     KIS_SSN_MAX
         1 001346   001331 604000 1                  TMI     s:12068
         1 001347   200005 116100                    CMPQ    I,,AUTO
         1 001350   001331 605000 1                  TPL     s:12068

      631    12073
      632    12074    2             APPL$ = PINCRW( KIS_MINOR$, KIS_SSN_MAX);

  12074  1 001351   000022 736000                    QLS     18
         1 001352   000000 036000 xsym               ADLQ    KIS_MINOR$
         1 001353   200042 756100                    STQ     APPL$,,AUTO

      633    12075    2             APPL$->APPL.Z.LINK = 0;

  12075  1 001354   200042 470500                    LDP0    APPL$,,AUTO
         1 001355   000000 236003                    LDQ     0,DU
         1 001356   000000 552104                    STBQ    0,'04'O,PR0

      634    12076
      635    12077    2             KIS_MAJOR$ = PTR$;

  12077  1 001357   200003 471500                    LDP1    @PTR$,,AUTO
         1 001360   100000 236100                    LDQ     0,,PR1
         1 001361   000000 756000 xsym               STQ     KIS_MAJOR$

      636    12078    2             I = 1 + KIS_SSN_CLIENTS + ( SIZEW(APPL) * KIS_SSN_SERVERS);
             12078                      /* wds for major tbl */

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:108  
  12078  1 001362   000000 236000 xsym               LDQ     KIS_SSN_SERVERS
         1 001363   000012 402007                    MPY     10,DL
         1 001364   000000 036000 xsym               ADLQ    KIS_SSN_CLIENTS
         1 001365   000001 036007                    ADLQ    1,DL
         1 001366   200005 756100                    STQ     I,,AUTO

      637    12079    2             CALL ITH$ALLOCATE( PTR$, I) ALTRET( ITW$ALLOC_ERR);

  12079  1 001367   200005 633500                    EPPR3   I,,AUTO
         1 001370   200263 453500                    STP3    DQH$+3,,AUTO
         1 001371   200003 236100                    LDQ     @PTR$,,AUTO
         1 001372   200262 756100                    STQ     DQH$+2,,AUTO
         1 001373   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 001374   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001375   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001376   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      638    12080
      639    12081    2             KIS_MAJOR$->APPL.SRVRHD = 1;

  12081  1 001377   000001 220003                    LDX0    1,DU
         1 001400   000000 470400 xsym               LDP0    KIS_MAJOR$
         1 001401   000000 740100                    STX0    0,,PR0

      640    12082    2             KIS_MAJOR$->APPL.CLNTHD = 1 + ( SIZEW(APPL) * KIS_SSN_SERVERS);

  12082  1 001402   000000 236000 xsym               LDQ     KIS_SSN_SERVERS
         1 001403   000012 402007                    MPY     10,DL
         1 001404   000001 621006                    EAX1    1,QL
         1 001405   000000 470400 xsym               LDP0    KIS_MAJOR$
         1 001406   000000 441100                    SXL1    0,,PR0

      641    12083    3             DO I = 1 TO KIS_SSN_SERVERS;

  12083  1 001407   000001 235007                    LDA     1,DL
         1 001410   200005 755100                    STA     I,,AUTO
         1 001411   001450 710000 1                  TRA     s:12091+1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:109  

      642    12084    3                 APPL$ = PINCRW( KIS_MAJOR$, KIS_MAJOR$->APPL.SRVRHD + SIZEW(APPL) * (
             12084                           I - 1));

  12084  1 001412   000000 470400 xsym               LDP0    KIS_MAJOR$
         1 001413   000000 236100                    LDQ     0,,PR0
         1 001414   000022 772000                    QRL     18
         1 001415   200262 756100                    STQ     DQH$+2,,AUTO
         1 001416   200005 236100                    LDQ     I,,AUTO
         1 001417   000012 402007                    MPY     10,DL
         1 001420   200262 036100                    ADLQ    DQH$+2,,AUTO
         1 001421   000022 736000                    QLS     18
         1 001422   000012 136003                    SBLQ    10,DU
         1 001423   000000 036000 xsym               ADLQ    KIS_MAJOR$
         1 001424   200042 756100                    STQ     APPL$,,AUTO

      643    12085    3                  APPL$->APPL.LDCTX = 0;

  12085  1 001425   000000 220003                    LDX0    0,DU
         1 001426   200042 471500                    LDP1    APPL$,,AUTO
         1 001427   100000 740100                    STX0    0,,PR1

      644    12086    3                  APPL$->APPL.Z.COOKIE = 0;

  12086  1 001430   000000 236003                    LDQ     0,DU
         1 001431   100000 552110                    STBQ    0,'10'O,PR1

      645    12087    3                  APPL$->APPL.Z.LINK = SIZEW(APPL) + POFFW( APPL$, KIS_MAJOR$);

  12087  1 001432   000000 235000 xsym               LDA     KIS_MAJOR$
         1 001433   000022 771000                    ARL     18
         1 001434   200262 755100                    STA     DQH$+2,,AUTO
         1 001435   200042 236100                    LDQ     APPL$,,AUTO
         1 001436   000022 772000                    QRL     18
         1 001437   200262 136100                    SBLQ    DQH$+2,,AUTO
         1 001440   000012 036007                    ADLQ    10,DL
         1 001441   100000 552104                    STBQ    0,'04'O,PR1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:110  

      646    12088    3                  APPL$->APPL.TSAP.LEN = 0;

  12088  1 001442   100001 740100                    STX0    1,,PR1

      647    12089    3                  APPL$->APPL.TSAP.TSAP = ' ';

  12089  1 001443   040100 100400                    MLR     fill='040'O
         1 001444   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001445   100001 400040                    ADSC9   1,,PR1                   cn=2,n=32

      648    12090    3                  APPL$->APPL.AUDCT = 0;

  12090  1 001446   100011 440100                    SXL0    9,,PR1

      649    12091    3                END;

  12091  1 001447   200005 054100                    AOS     I,,AUTO
         1 001450   000000 236000 xsym               LDQ     KIS_SSN_SERVERS
         1 001451   001412 604000 1                  TMI     s:12084
         1 001452   200005 116100                    CMPQ    I,,AUTO
         1 001453   001412 605000 1                  TPL     s:12084

      650    12092
      651    12093    2             APPL$ = PINCRW( KIS_MAJOR$, 1 + ( SIZEW(APPL) * ( KIS_SSN_SERVERS - 1)));

  12093  1 001454   000012 402003                    MPY     10,DU
         1 001455   000011 136003                    SBLQ    9,DU
         1 001456   000000 036000 xsym               ADLQ    KIS_MAJOR$
         1 001457   200042 756100                    STQ     APPL$,,AUTO

      652    12094    2             APPL$->APPL.Z.LINK = 0;

  12094  1 001460   200042 470500                    LDP0    APPL$,,AUTO
         1 001461   000000 236003                    LDQ     0,DU
         1 001462   000000 552104                    STBQ    0,'04'O,PR0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:111  
      653    12095
      654    12096    3             DO I = 1 TO KIS_SSN_CLIENTS;

  12096  1 001463   000001 235007                    LDA     1,DL
         1 001464   200005 755100                    STA     I,,AUTO
         1 001465   001511 710000 1                  TRA     s:12101+1

      655    12097    3                  APPL$ = PINCRW( KIS_MAJOR$, KIS_MAJOR$->APPL.CLNTHD + I - 1);

  12097  1 001466   000000 470400 xsym               LDP0    KIS_MAJOR$
         1 001467   000000 236100                    LDQ     0,,PR0
         1 001470   777777 376007                    ANQ     -1,DL
         1 001471   200005 036100                    ADLQ    I,,AUTO
         1 001472   000022 736000                    QLS     18
         1 001473   000001 136003                    SBLQ    1,DU
         1 001474   000000 036000 xsym               ADLQ    KIS_MAJOR$
         1 001475   200042 756100                    STQ     APPL$,,AUTO

      656    12098    3                  APPL$->APPL.LDCTX = 0;

  12098  1 001476   000000 220003                    LDX0    0,DU
         1 001477   200042 471500                    LDP1    APPL$,,AUTO
         1 001500   100000 740100                    STX0    0,,PR1

      657    12099    3                  APPL$->APPL.Z.COOKIE = 0;

  12099  1 001501   000000 236003                    LDQ     0,DU
         1 001502   100000 552110                    STBQ    0,'10'O,PR1

      658    12100    3                  APPL$->APPL.Z.LINK = I + KIS_MAJOR$->APPL.CLNTHD;

  12100  1 001503   000000 470400 xsym               LDP0    KIS_MAJOR$
         1 001504   000000 236100                    LDQ     0,,PR0
         1 001505   777777 376007                    ANQ     -1,DL
         1 001506   200005 036100                    ADLQ    I,,AUTO
         1 001507   100000 552104                    STBQ    0,'04'O,PR1

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:112  
      659    12101    3                END;

  12101  1 001510   200005 054100                    AOS     I,,AUTO
         1 001511   000000 236000 xsym               LDQ     KIS_SSN_CLIENTS
         1 001512   001466 604000 1                  TMI     s:12097
         1 001513   200005 116100                    CMPQ    I,,AUTO
         1 001514   001466 605000 1                  TPL     s:12097

      660    12102
      661    12103    2             APPL$ = PINCRW(KIS_MAJOR$, KIS_MAJOR$->APPL.CLNTHD + KIS_SSN_CLIENTS -1);

  12103  1 001515   000000 470400 xsym               LDP0    KIS_MAJOR$
         1 001516   000000 236100                    LDQ     0,,PR0
         1 001517   777777 376007                    ANQ     -1,DL
         1 001520   000000 036000 xsym               ADLQ    KIS_SSN_CLIENTS
         1 001521   000022 736000                    QLS     18
         1 001522   000001 136003                    SBLQ    1,DU
         1 001523   000000 036000 xsym               ADLQ    KIS_MAJOR$
         1 001524   200042 756100                    STQ     APPL$,,AUTO

      662    12104    2             APPL$->APPL.Z.LINK = 0;

  12104  1 001525   200042 471500                    LDP1    APPL$,,AUTO
         1 001526   000000 236003                    LDQ     0,DU
         1 001527   100000 552104                    STBQ    0,'04'O,PR1

      663    12105
      664    12106    2             KIS_SSN_MAXMINOR = KIS_SSN_MAX;

  12106  1 001530   000000 235000 xsym               LDA     KIS_SSN_MAX
         1 001531   000000 755000 xsym               STA     KIS_SSN_MAXMINOR

      665    12107    2             KIS_SSN_MAXMAJOR = KIS_SSN_CLIENTS + (KIS_SSN_SERVERS * SIZEW(APPL));

  12107  1 001532   000000 236000 xsym               LDQ     KIS_SSN_SERVERS
         1 001533   000012 402007                    MPY     10,DL
         1 001534   000000 036000 xsym               ADLQ    KIS_SSN_CLIENTS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:113  
         1 001535   000000 756000 xsym               STQ     KIS_SSN_MAXMAJOR

      666    12108
      667    12109
      668    12110
      669    12111    2             B$P$ = PTR$;

  12111  1 001536   200003 470500                    LDP0    @PTR$,,AUTO
         1 001537   000000 236100                    LDQ     0,,PR0
         1 001540   000000 756000 xsym               STQ     B$P$

      670    12112        /**/
      671    12113    2             CALL ITH$ALLOCATE(PTR$,SIZEW(B$P) * (P_MAXPROCS+1)) ALTRET(ITW$ALLOC_ERR)
             12113                      ;

  12113  1 001541   000000 236000 xsym               LDQ     P_MAXPROCS
         1 001542   000042 402007                    MPY     34,DL
         1 001543   000042 036007                    ADLQ    34,DL
         1 001544   200262 756100                    STQ     DQH$+2,,AUTO
         1 001545   200262 633500                    EPPR3   DQH$+2,,AUTO
         1 001546   200265 453500                    STP3    DQH$+5,,AUTO
         1 001547   200003 236100                    LDQ     @PTR$,,AUTO
         1 001550   200264 756100                    STQ     DQH$+4,,AUTO
         1 001551   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 001552   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001553   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001554   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      672    12114        /**/
      673    12115    2             B$P$ -> B$P(0) = %NO#;

  12115  1 001555   000000 470400 xsym               LDP0    B$P$
         1 001556   000100 100400                    MLR     fill='000'O
         1 001557   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001560   000000 000210                    ADSC9   0,,PR0                   cn=0,n=136

      674    12116        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:114  
      675    12117    3             DO I = 1 TO B$DS6$ -> IT$SPROCDS.COUNT ;

  12117  1 001561   000001 235007                    LDA     1,DL
         1 001562   200005 755100                    STA     I,,AUTO
         1 001563   001626 710000 1                  TRA     s:12122+1

      676    12118    3                  B$P$ -> B$P(I) = %NO#;

  12118  1 001564   200005 236100                    LDQ     I,,AUTO
         1 001565   000210 402007                    MPY     136,DL
         1 001566   000000 470400 xsym               LDP0    B$P$
         1 001567   000106 100400                    MLR     fill='000'O
         1 001570   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001571   000000 000210                    ADSC9   0,Q,PR0                  cn=0,n=136

      677    12119    3                  B$P$ -> B$P.NAME(I) = B$DS6$ -> IT$SPROCDS.PROCS.NAME(I-1);

  12119  1 001572   200005 236100                    LDQ     I,,AUTO
         1 001573   000044 402007                    MPY     36,DL
         1 001574   200262 756100                    STQ     DQH$+2,,AUTO
         1 001575   200005 236100                    LDQ     I,,AUTO
         1 001576   000210 402007                    MPY     136,DL
         1 001577   000000 470400 xsym               LDP0    B$DS6$
         1 001600   200262 235100                    LDA     DQH$+2,,AUTO
         1 001601   000000 471400 xsym               LDP1    B$P$
         1 001602   000106 100505                    MLR     fill='000'O
         1 001603   077770 000040                    ADSC9   -8,A,PR0                 cn=0,n=32
         1 001604   100032 000040                    ADSC9   26,Q,PR1                 cn=0,n=32

      678    12120    3                  B$P$->B$P.ACCT(I) = ':SYS';

  12120  1 001605   200005 236100                    LDQ     I,,AUTO
         1 001606   000042 402007                    MPY     34,DL
         1 001607   000117 235000 0                  LDA     NI_ENTADDR+6
         1 001610   000000 620006                    EAX0    0,QL
         1 001611   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 001612   000000 470400 xsym               LDP0    B$P$
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:115  
         1 001613   000030 757110                    STAQ    24,X0,PR0

      679    12121    3                  B$P$ -> B$P.FLGS(I) = B$DS6$ -> IT$SPROCDS.PROCS.FLGS(I-1);

  12121  1 001614   200005 236100                    LDQ     I,,AUTO
         1 001615   000042 402007                    MPY     34,DL
         1 001616   000000 620006                    EAX0    0,QL
         1 001617   200005 236100                    LDQ     I,,AUTO
         1 001620   000011 402007                    MPY     9,DL
         1 001621   000000 470400 xsym               LDP0    B$DS6$
         1 001622   000000 221106                    LDX1    0,QL,PR0
         1 001623   000000 471400 xsym               LDP1    B$P$
         1 001624   100027 741110                    STX1    23,X0,PR1

      680    12122    3                END;

  12122  1 001625   200005 054100                    AOS     I,,AUTO
         1 001626   000000 470400 xsym               LDP0    B$DS6$
         1 001627   000000 236100                    LDQ     0,,PR0
         1 001630   001564 604000 1                  TMI     s:12118
         1 001631   200005 116100                    CMPQ    I,,AUTO
         1 001632   001564 605000 1                  TPL     s:12118

      681    12123        /**/
      682    12124    3             DO I = B$DS6$ -> IT$SPROCDS.COUNT + 1 TO P_MAXPROCS;

  12124  1 001633   000001 036007                    ADLQ    1,DL
         1 001634   200005 756100                    STQ     I,,AUTO
         1 001635   001654 710000 1                  TRA     s:12127+1

      683    12125    3                  B$P$ -> B$P(I) = %NO#;

  12125  1 001636   200005 236100                    LDQ     I,,AUTO
         1 001637   000210 402007                    MPY     136,DL
         1 001640   000000 470400 xsym               LDP0    B$P$
         1 001641   000106 100400                    MLR     fill='000'O
         1 001642   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:116  
         1 001643   000000 000210                    ADSC9   0,Q,PR0                  cn=0,n=136

      684    12126    3                  B$P$->B$P.ACCT(I) = ' ';

  12126  1 001644   200005 236100                    LDQ     I,,AUTO
         1 001645   000042 402007                    MPY     34,DL
         1 001646   000035 235000 xsym               LDA     B_VECTNIL+29
         1 001647   000000 620006                    EAX0    0,QL
         1 001650   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 001651   000000 470400 xsym               LDP0    B$P$
         1 001652   000030 757110                    STAQ    24,X0,PR0

      685    12127    3                END;

  12127  1 001653   200005 054100                    AOS     I,,AUTO
         1 001654   000000 236000 xsym               LDQ     P_MAXPROCS
         1 001655   001636 604000 1                  TMI     s:12125
         1 001656   200005 116100                    CMPQ    I,,AUTO
         1 001657   001636 605000 1                  TPL     s:12125

      686    12128        /**/
      687    12129    2             P_AUTO_START = P_MAXPROCS + 1;

  12129  1 001660   000001 036007                    ADLQ    1,DL
         1 001661   000000 756000 xsym               STQ     P_AUTO_START

      688    12130    2             P_USED_AUTO = P_AUTO_START;

  12130  1 001662   000000 756000 xsym               STQ     P_USED_AUTO

      689    12131    2             P_AUTOSPACE = MINIMUM (P_AUTOSPACE , 4095 - P_AUTO_START);

  12131  1 001663   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 001664   010000 036007                    ADLQ    4096,DL
         1 001665   001672 604000 1                  TMI     s:12131+7
         1 001666   000000 116000 xsym               CMPQ    P_AUTOSPACE
         1 001667   001672 602000 1                  TNC     s:12131+7
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:117  
         1 001670   001672 600000 1                  TZE     s:12131+7
         1 001671   000000 236000 xsym               LDQ     P_AUTOSPACE
         1 001672   000000 756000 xsym               STQ     P_AUTOSPACE

      690    12132    2             P_LAST_AUTO = P_AUTO_START + P_AUTOSPACE - 1;

  12132  1 001673   000000 036000 xsym               ADLQ    P_AUTO_START
         1 001674   000001 136007                    SBLQ    1,DL
         1 001675   000000 756000 xsym               STQ     P_LAST_AUTO

      691    12133        /**/
      692    12134    2             B$LOOKUP$ = PTR$;

  12134  1 001676   200003 470500                    LDP0    @PTR$,,AUTO
         1 001677   000000 236100                    LDQ     0,,PR0
         1 001700   000000 756000 xsym               STQ     B$LOOKUP$

      693    12135        /**/
      694    12136    2             CALL ITH$ALLOCATE(PTR$,SIZEW(B$P) * P_AUTOSPACE)  ALTRET(ITW$ALLOC_ERR);

  12136  1 001701   000000 236000 xsym               LDQ     P_AUTOSPACE
         1 001702   000042 402007                    MPY     34,DL
         1 001703   200262 756100                    STQ     DQH$+2,,AUTO
         1 001704   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 001705   200265 451500                    STP1    DQH$+5,,AUTO
         1 001706   200003 236100                    LDQ     @PTR$,,AUTO
         1 001707   200264 756100                    STQ     DQH$+4,,AUTO
         1 001710   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 001711   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001712   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001713   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      695    12137    3             DO I = 0 TO P_AUTOSPACE - 1;

  12137  1 001714   200005 450100                    STZ     I,,AUTO
         1 001715   001734 710000 1                  TRA     s:12140+1

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:118  
      696    12138    3                  B$LOOKUP$->B$P(I) = %NO#;

  12138  1 001716   200005 236100                    LDQ     I,,AUTO
         1 001717   000210 402007                    MPY     136,DL
         1 001720   000000 470400 xsym               LDP0    B$LOOKUP$
         1 001721   000106 100400                    MLR     fill='000'O
         1 001722   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 001723   000000 000210                    ADSC9   0,Q,PR0                  cn=0,n=136

      697    12139    3                  B$LOOKUP$->B$P.ACCT(I) = ' ';

  12139  1 001724   200005 236100                    LDQ     I,,AUTO
         1 001725   000042 402007                    MPY     34,DL
         1 001726   000035 235000 xsym               LDA     B_VECTNIL+29
         1 001727   000000 620006                    EAX0    0,QL
         1 001730   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 001731   000000 470400 xsym               LDP0    B$LOOKUP$
         1 001732   000030 757110                    STAQ    24,X0,PR0

      698    12140    3                END;

  12140  1 001733   200005 054100                    AOS     I,,AUTO
         1 001734   200005 236100                    LDQ     I,,AUTO
         1 001735   001716 604000 1                  TMI     s:12138
         1 001736   000000 116000 xsym               CMPQ    P_AUTOSPACE
         1 001737   001716 602000 1                  TNC     s:12138

      699    12141        /**/
      700    12142    2             B$LOOKUP$ = PTR$;

  12142  1 001740   200003 470500                    LDP0    @PTR$,,AUTO
         1 001741   000000 236100                    LDQ     0,,PR0
         1 001742   000000 756000 xsym               STQ     B$LOOKUP$

      701    12143        /**/
      702    12144    2             CALL ITH$ALLOCATE(PTR$,P_AUTOSPACE+P_MAXPROCS+1)  ALTRET(ITW$ALLOC_ERR);

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:119  
  12144  1 001743   000000 236000 xsym               LDQ     P_AUTOSPACE
         1 001744   000000 036000 xsym               ADLQ    P_MAXPROCS
         1 001745   000001 036007                    ADLQ    1,DL
         1 001746   200262 756100                    STQ     DQH$+2,,AUTO
         1 001747   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 001750   200265 451500                    STP1    DQH$+5,,AUTO
         1 001751   200003 236100                    LDQ     @PTR$,,AUTO
         1 001752   200264 756100                    STQ     DQH$+4,,AUTO
         1 001753   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 001754   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001755   000000 701000 xent               TSX1    ITH$ALLOCATE
         1 001756   006750 702000 1                  TSX2    ITW$ALLOC_ERR

      703    12145    3             DO I = 0 TO P_AUTOSPACE + P_MAXPROCS;

  12145  1 001757   200005 450100                    STZ     I,,AUTO
         1 001760   001765 710000 1                  TRA     s:12147+1

      704    12146    3                  B$LOOKUP$->B$LOOKUP(I) = 0;

  12146  1 001761   000000 470400 xsym               LDP0    B$LOOKUP$
         1 001762   200005 720100                    LXL0    I,,AUTO
         1 001763   000000 450110                    STZ     0,X0,PR0

      705    12147    3                END;

  12147  1 001764   200005 054100                    AOS     I,,AUTO
         1 001765   000000 236000 xsym               LDQ     P_AUTOSPACE
         1 001766   000000 036000 xsym               ADLQ    P_MAXPROCS
         1 001767   001761 604000 1                  TMI     s:12146
         1 001770   200005 116100                    CMPQ    I,,AUTO
         1 001771   001761 605000 1                  TPL     s:12146

      706    12148        /**/
      707    12149    3             IF HW_WSQ0PT THEN DO;

  12149  1 001772   000000 234000 xsym               SZN     HW_WSQ0PT
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:120  
         1 001773   002021 605000 1                  TPL     s:12155

      708    12150    3                  IT_SCPUWSPTD(0) = B$IPHYMAP$->MM$IPHY_MAP (B$MPT$ -> B$MAP.RPN(%
             12150                           ISEGLO)); /* MASTER WSPTD ADDRESS IN SLOT ZERO */

  12150  1 001774   000000 470400 xsym               LDP0    B$MPT$
         1 001775   000100 236100                    LDQ     64,,PR0
         1 001776   000022 772000                    QRL     18
         1 001777   000001 736000                    QLS     1
         1 002000   000000 471400 xsym               LDP1    B$IPHYMAP$
         1 002001   000000 101506                    MRL     fill='000'O
         1 002002   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 002003   000000 000004 xsym               ADSC9   IT_SCPUWSPTD             cn=0,n=4

      709    12151    3                 IT_SCPUJIT(0) = B$IPHYMAP$->MM$IPHY_MAP (B$MPT$ -> B$MAP.RPN(%PGTBLLO
             12151                           )); /* MASTER JIT PAGE  */

  12151  1 002004   000000 236100                    LDQ     0,,PR0
         1 002005   000022 772000                    QRL     18
         1 002006   000001 736000                    QLS     1
         1 002007   000000 101506                    MRL     fill='000'O
         1 002010   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 002011   000000 000004 xsym               ADSC9   IT_SCPUJIT               cn=0,n=4

      710    12152    3                 IT_SCPUHJIT(0) = B$IPHYMAP$->MM$IPHY_MAP (B$MPT$ -> B$MAP.RPN(%HJITPG
             12152                           )); /* MASTER HJIT      */

  12152  1 002012   000015 236100                    LDQ     13,,PR0
         1 002013   000022 772000                    QRL     18
         1 002014   000001 736000                    QLS     1
         1 002015   000000 101506                    MRL     fill='000'O
         1 002016   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2
         1 002017   000000 000004 xsym               ADSC9   IT_SCPUHJIT              cn=0,n=4

      711    12153    3                END;

  12153  1 002020   002033 710000 1                  TRA     s:12160
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:121  

      712    12154    3             ELSE DO;

      713    12155    3                  IT_SCPUWSPTD(0) = B$MPT$ -> B$MAP.RPN(%ISEGLO);
             12155                           /* MASTER WSPTD ADDRESS IN SLOT ZERO */

  12155  1 002021   000000 470400 xsym               LDP0    B$MPT$
         1 002022   000100 236100                    LDQ     64,,PR0
         1 002023   000022 772000                    QRL     18
         1 002024   000000 756000 xsym               STQ     IT_SCPUWSPTD

      714    12156    3                  IT_SCPUJIT(0) = B$MPT$ -> B$MAP.RPN(%PGTBLLO); /* MASTER JIT PAGE */

  12156  1 002025   000000 236100                    LDQ     0,,PR0
         1 002026   000022 772000                    QRL     18
         1 002027   000000 756000 xsym               STQ     IT_SCPUJIT

      715    12157    3                  IT_SCPUHJIT(0) = B$MPT$ -> B$MAP.RPN(%HJITPG); /* MASTER HJIT     */

  12157  1 002030   000015 236100                    LDQ     13,,PR0
         1 002031   000022 772000                    QRL     18
         1 002032   000000 756000 xsym               STQ     IT_SCPUHJIT

      716    12158    3                END;

      717    12159        /**/
      718    12160    2             REQ$ = B$DS2$;

  12160  1 002033   000000 236000 xsym               LDQ     B$DS2$
         1 002034   200171 756100                    STQ     REQ$,,AUTO

      719    12161    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */

  12161  1 002035   200005 631500                    EPPR1   I,,AUTO
         1 002036   200265 451500                    STP1    DQH$+5,,AUTO
         1 002037   000022 236000 2                  LDQ     18
         1 002040   200264 756100                    STQ     DQH$+4,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:122  
         1 002041   200266 452500                    STP2    DQH$+6,,AUTO
         1 002042   200266 236100                    LDQ     DQH$+6,,AUTO
         1 002043   000023 036000 2                  ADLQ    19
         1 002044   000002 235000 2                  LDA     2
         1 002045   200262 757100                    STAQ    DQH$+2,,AUTO
         1 002046   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 002047   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002050   000000 701000 xent               TSX1    MMH$FDS
         1 002051   000000 011000                    NOP     0

      720    12162        /**/
      721    12163    2             REQ$ = B$DS3$;

  12163  1 002052   000000 236000 xsym               LDQ     B$DS3$
         1 002053   200171 756100                    STQ     REQ$,,AUTO

      722    12164    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */

  12164  1 002054   200005 630500                    EPPR0   I,,AUTO
         1 002055   200265 450500                    STP0    DQH$+5,,AUTO
         1 002056   000022 236000 2                  LDQ     18
         1 002057   200264 756100                    STQ     DQH$+4,,AUTO
         1 002060   200266 452500                    STP2    DQH$+6,,AUTO
         1 002061   200266 236100                    LDQ     DQH$+6,,AUTO
         1 002062   000023 036000 2                  ADLQ    19
         1 002063   000002 235000 2                  LDA     2
         1 002064   200262 757100                    STAQ    DQH$+2,,AUTO
         1 002065   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 002066   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002067   000000 701000 xent               TSX1    MMH$FDS
         1 002070   000000 011000                    NOP     0

      723    12165        /**/
      724    12166    2             REQ$ = B$DS4$;

  12166  1 002071   000000 236000 xsym               LDQ     B$DS4$
         1 002072   200171 756100                    STQ     REQ$,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:123  

      725    12167    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */

  12167  1 002073   200005 630500                    EPPR0   I,,AUTO
         1 002074   200265 450500                    STP0    DQH$+5,,AUTO
         1 002075   000022 236000 2                  LDQ     18
         1 002076   200264 756100                    STQ     DQH$+4,,AUTO
         1 002077   200266 452500                    STP2    DQH$+6,,AUTO
         1 002100   200266 236100                    LDQ     DQH$+6,,AUTO
         1 002101   000023 036000 2                  ADLQ    19
         1 002102   000002 235000 2                  LDA     2
         1 002103   200262 757100                    STAQ    DQH$+2,,AUTO
         1 002104   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 002105   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002106   000000 701000 xent               TSX1    MMH$FDS
         1 002107   000000 011000                    NOP     0

      726    12168        /**/
      727    12169    2             REQ$ = B$DS5$;

  12169  1 002110   000000 236000 xsym               LDQ     B$DS5$
         1 002111   200171 756100                    STQ     REQ$,,AUTO

      728    12170    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */

  12170  1 002112   200005 630500                    EPPR0   I,,AUTO
         1 002113   200265 450500                    STP0    DQH$+5,,AUTO
         1 002114   000022 236000 2                  LDQ     18
         1 002115   200264 756100                    STQ     DQH$+4,,AUTO
         1 002116   200266 452500                    STP2    DQH$+6,,AUTO
         1 002117   200266 236100                    LDQ     DQH$+6,,AUTO
         1 002120   000023 036000 2                  ADLQ    19
         1 002121   000002 235000 2                  LDA     2
         1 002122   200262 757100                    STAQ    DQH$+2,,AUTO
         1 002123   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 002124   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002125   000000 701000 xent               TSX1    MMH$FDS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:124  
         1 002126   000000 011000                    NOP     0

      729    12171        /**/
      730    12172    2             REQ$ = B$DS6$;

  12172  1 002127   000000 236000 xsym               LDQ     B$DS6$
         1 002130   200171 756100                    STQ     REQ$,,AUTO

      731    12173    2             CALL MMH$FDS(%MON_WSQ,REREQ$.SEGID,1024*10,I); /* FREE DATA SEGMENTS */

  12173  1 002131   200005 630500                    EPPR0   I,,AUTO
         1 002132   200265 450500                    STP0    DQH$+5,,AUTO
         1 002133   000022 236000 2                  LDQ     18
         1 002134   200264 756100                    STQ     DQH$+4,,AUTO
         1 002135   200266 452500                    STP2    DQH$+6,,AUTO
         1 002136   200266 236100                    LDQ     DQH$+6,,AUTO
         1 002137   000023 036000 2                  ADLQ    19
         1 002140   000002 235000 2                  LDA     2
         1 002141   200262 757100                    STAQ    DQH$+2,,AUTO
         1 002142   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 002143   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002144   000000 701000 xent               TSX1    MMH$FDS
         1 002145   000000 011000                    NOP     0

      732    12174        /**/
      733    12175    2             MM_HELD = MM_RDS(0) + MM_RDS(1) + MM_RDS(2) + MM_RDS(3) +

  12175  1 002146   000000 236000 xsym               LDQ     MM_RDS
         1 002147   000001 036000 xsym               ADLQ    MM_RDS+1
         1 002150   000002 036000 xsym               ADLQ    MM_RDS+2
         1 002151   000003 036000 xsym               ADLQ    MM_RDS+3
         1 002152   000004 036000 xsym               ADLQ    MM_RDS+4
         1 002153   000005 036000 xsym               ADLQ    MM_RDS+5
         1 002154   000006 036000 xsym               ADLQ    MM_RDS+6
         1 002155   000007 036000 xsym               ADLQ    MM_RDS+7
         1 002156   000000 756000 xsym               STQ     MM_HELD

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:125  
      734    12176    2                 MM_RDS(4) + MM_RDS(5) + MM_RDS(6) + MM_RDS(7); /* TOTAL HELD PAGES */
      735    12177        /**/
      736    12178    3             IF (B_SCDCTX = 0) THEN DO;    /* NO CONSOLE                         */

  12178  1 002157   000000 235000 xsym               LDA     B_SCDCTX
         1 002160   002170 601000 1                  TNZ     s:12183

      737    12179    3                  CALL ITE$ERROR(%E$NOCONSOLE);

  12179  1 002161   000025 630400 2                  EPPR0   21
         1 002162   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002163   000000 701000 xent               TSX1    ITE$ERROR
         1 002164   000000 011000                    NOP     0

      738    12180    3                  CALL ITF$FREEZE;

  12180  1 002165   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002166   000000 701000 xent               TSX1    ITF$FREEZE
         1 002167   000000 011000                    NOP     0

      739    12181    3                END;

      740    12182        /**/
      741    12183    3             IF (FR_PRM$(0) -> FR$PR(FR_DP) = 0) THEN DO; /* NO DISK            */

  12183  1 002170   000000 470400 xsym               LDP0    FR_PRM$
         1 002171   000000 235100                    LDA     0,,PR0
         1 002172   002202 601000 1                  TNZ     s:12188

      742    12184    3                  CALL ITE$ERROR(%E$NODISK);

  12184  1 002173   000027 630400 2                  EPPR0   23
         1 002174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002175   000000 701000 xent               TSX1    ITE$ERROR
         1 002176   000000 011000                    NOP     0

      743    12185    3                  CALL ITF$FREEZE;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:126  

  12185  1 002177   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002200   000000 701000 xent               TSX1    ITF$FREEZE
         1 002201   000000 011000                    NOP     0

      744    12186    3                END;

      745    12187        /**/
      746    12188    3             IF (FR_PRM$(0) -> FR$PR(FR_MT) = 0) THEN DO; /* NO TAPE            */

  12188  1 002202   000000 470400 xsym               LDP0    FR_PRM$
         1 002203   000001 235100                    LDA     1,,PR0
         1 002204   002214 601000 1                  TNZ     s:12193

      747    12189    3                  CALL ITE$ERROR(%E$NOTAPE);

  12189  1 002205   000031 630400 2                  EPPR0   25
         1 002206   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002207   000000 701000 xent               TSX1    ITE$ERROR
         1 002210   000000 011000                    NOP     0

      748    12190    3                  CALL ITF$FREEZE;

  12190  1 002211   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002212   000000 701000 xent               TSX1    ITF$FREEZE
         1 002213   000000 011000                    NOP     0

      749    12191    3                END;

      750    12192        /**/
      751    12193    3             IF HW_IOP THEN DO;

  12193  1 002214   000000 234000 xsym               SZN     HW_IOP
         1 002215   002225 605000 1                  TPL     s:12199

      752    12194    3                  NI_MBX_INIT.LPW = '000000023777'O;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:127  
  12194  1 002216   000120 236000 0                  LDQ     NI_ENTADDR+7
         1 002217   000000 756000 xsym               STQ     NI_MBX_INIT

      753    12195    3                  NI_MBX_INIT.SCW = '000000100000'O;

  12195  1 002220   000121 236000 0                  LDQ     NI_ENTADDR+8
         1 002221   000002 756000 xsym               STQ     NI_MBX_INIT+2

      754    12196    3                  H_ENMASK = '777777777760'O;

  12196  1 002222   000122 235000 0                  LDA     NI_ENTADDR+9
         1 002223   000000 236003                    LDQ     0,DU
         1 002224   000000 757000 xsym               STAQ    H_ENMASK

      755    12197    3                END;

      756    12198        /**/
      757    12199    3             DO I=0 TO NI_IOMS-1;

  12199  1 002225   200005 450100                    STZ     I,,AUTO
         1 002226   002255 710000 1                  TRA     s:12207+1

      758    12200    3                  NI_CHANS(I)=0;

  12200  1 002227   200005 720100                    LXL0    I,,AUTO
         1 002230   000000 450010 xsym               STZ     NI_CHANS,X0

      759    12201    4   CHANLP:        DO J=%N_MAXCHANS-1 DOWNTO 0;

  12201  1 002231   000177 235007       CHANLP       LDA     127,DL
         1 002232   200006 755100                    STA     J,,AUTO
         1 002233   002252 710000 1                  TRA     s:12206+2

      760    12202    5                       IF NI$CHT$->NI$CHT.DQH$(I*%N_MAXCHANS+J) ~= ADDR(NIL) THEN DO;

  12202  1 002234   200005 236100                    LDQ     I,,AUTO
         1 002235   000007 736000                    QLS     7
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:128  
         1 002236   200006 036100                    ADLQ    J,,AUTO
         1 002237   000001 736000                    QLS     1
         1 002240   000000 470400 xsym               LDP0    NI$CHT$
         1 002241   000000 236106                    LDQ     0,QL,PR0
         1 002242   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002243   002250 600000 1                  TZE     s:12206

      761    12203    5                            NI_CHANS(I)=J;

  12203  1 002244   200006 235100                    LDA     J,,AUTO
         1 002245   200005 720100                    LXL0    I,,AUTO
         1 002246   000000 755010 xsym               STA     NI_CHANS,X0

      762    12204    5                            EXIT CHANLP;

  12204  1 002247   002254 710000 1                  TRA     s:12207

      763    12205    5                          END;
      764    12206    4                     END;

  12206  1 002250   000001 336007                    LCQ     1,DL
         1 002251   200006 056100                    ASQ     J,,AUTO
         1 002252   200006 235100                    LDA     J,,AUTO
         1 002253   002234 605000 1                  TPL     s:12202

      765    12207    3                END;

  12207  1 002254   200005 054100                    AOS     I,,AUTO
         1 002255   200005 236100                    LDQ     I,,AUTO
         1 002256   000000 116000 xsym               CMPQ    NI_IOMS
         1 002257   002227 604000 1                  TMI     s:12200

      766    12208    2             NI_MAX_CHANS = NI_IOMS*%N_MAXCHANS;

  12208  1 002260   000000 235000 xsym               LDA     NI_IOMS
         1 002261   000007 735000                    ALS     7
         1 002262   000000 755000 xsym               STA     NI_MAX_CHANS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:129  

      767    12209        /**/
      768    12210    3             DO I = 0 TO NI_IOMS-1;

  12210  1 002263   200005 450100                    STZ     I,,AUTO
         1 002264   002302 710000 1                  TRA     s:12214+1

      769    12211    3                  IF NI$IOM$(I) ~= ADDR(NIL) THEN IF NI$IOM$(I)->NI$IOM.ADDRESS

  12211  1 002265   200005 720100                    LXL0    I,,AUTO
         1 002266   000000 236010 xsym               LDQ     NI$IOM$,X0
         1 002267   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002270   002301 600000 1                  TZE     s:12214

  12211  1 002271   000000 470410 xsym               LDP0    NI$IOM$,X0
         1 002272   000000 236000 xsym               LDQ     FM_SYSDP
         1 002273   000033 772000                    QRL     27
         1 002274   200262 756100                    STQ     DQH$+2,,AUTO
         1 002275   000003 236100                    LDQ     3,,PR0
         1 002276   000007 376007                    ANQ     7,DL
         1 002277   200262 116100                    CMPQ    DQH$+2,,AUTO
         1 002300   002306 600000 1                  TZE     GOTSIOM

      770    12212    3                            = FM_SYSDP.PORT THEN
      771    12213    3                            GOTO GOTSIOM;
      772    12214    3                END;

  12214  1 002301   200005 054100                    AOS     I,,AUTO
         1 002302   200005 236100                    LDQ     I,,AUTO
         1 002303   000000 116000 xsym               CMPQ    NI_IOMS
         1 002304   002265 604000 1                  TMI     s:12211

      773    12215    2             GOTO GTT;

  12215  1 002305   002401 710000 1                  TRA     GTT

      774    12216    2   GOTSIOM:  IF NI$CHT$->NI$CHT.DQH$(I*%N_MAXCHANS+FM_SYSDP.CHN) = ADDR(NIL) THEN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:130  

  12216  1 002306   000000 236000 xsym  GOTSIOM      LDQ     FM_SYSDP
         1 002307   000022 772000                    QRL     18
         1 002310   000777 376007                    ANQ     511,DL
         1 002311   200262 756100                    STQ     DQH$+2,,AUTO
         1 002312   200005 236100                    LDQ     I,,AUTO
         1 002313   000007 736000                    QLS     7
         1 002314   200262 036100                    ADLQ    DQH$+2,,AUTO
         1 002315   000001 736000                    QLS     1
         1 002316   000000 471400 xsym               LDP1    NI$CHT$
         1 002317   100000 236106                    LDQ     0,QL,PR1
         1 002320   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002321   002401 600000 1                  TZE     GTT

      775    12217    2                  GOTO GTT;
      776    12218    2             SQH$=NI$CHT$->NI$CHT.DQH$(I*%N_MAXCHANS+FM_SYSDP.CHN)->NI$DQH.SQH$;

  12218  1 002322   000000 236000 xsym               LDQ     FM_SYSDP
         1 002323   000022 772000                    QRL     18
         1 002324   000777 376007                    ANQ     511,DL
         1 002325   200262 756100                    STQ     DQH$+2,,AUTO
         1 002326   200005 236100                    LDQ     I,,AUTO
         1 002327   000007 736000                    QLS     7
         1 002330   200262 036100                    ADLQ    DQH$+2,,AUTO
         1 002331   000001 736000                    QLS     1
         1 002332   100000 473506                    LDP3    0,QL,PR1
         1 002333   300013 236100                    LDQ     11,,PR3
         1 002334   200172 756100                    STQ     SQH$,,AUTO

      777    12219    3             DO I = SQH$->NI$SQH.FDCT TO SQH$->NI$SQH.FDCT+SQH$->NI$SQH.NDCT-1;

  12219  1 002335   200172 473500                    LDP3    SQH$,,AUTO
         1 002336   300002 236100                    LDQ     2,,PR3
         1 002337   000022 772000                    QRL     18
         1 002340   200005 756100                    STQ     I,,AUTO
         1 002341   002367 710000 1                  TRA     s:12225+1

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:131  
      778    12220    3                  IF N$DCT$(I)->NI$DCT.DVN = FM_SYSDP.DVN AND N$DCT$(I)->NI$DCT.TYPE=%
             12220                           DV_DP THEN

  12220  1 002342   000000 470400 xsym               LDP0    N$DCT$$
         1 002343   200005 720100                    LXL0    I,,AUTO
         1 002344   000000 471510                    LDP1    0,X0,PR0
         1 002345   000000 236000 xsym               LDQ     FM_SYSDP
         1 002346   000011 772000                    QRL     9
         1 002347   000777 376007                    ANQ     511,DL
         1 002350   200262 756100                    STQ     DQH$+2,,AUTO
         1 002351   100007 236100                    LDQ     7,,PR1
         1 002352   000030 772000                    QRL     24
         1 002353   000077 376007                    ANQ     63,DL
         1 002354   200262 116100                    CMPQ    DQH$+2,,AUTO
         1 002355   002366 601000 1                  TNZ     s:12225
         1 002356   000000 471510                    LDP1    0,X0,PR0
         1 002357   100007 236100                    LDQ     7,,PR1
         1 002360   007700 376007                    ANQ     4032,DL
         1 002361   000600 116007                    CMPQ    384,DL
         1 002362   002366 601000 1                  TNZ     s:12225

      779    12221    4                  DO;

      780    12222    4                       IT_SYSDISK=I;

  12222  1 002363   200005 235100                    LDA     I,,AUTO
         1 002364   000000 755000 xsym               STA     IT_SYSDISK

      781    12223    4                       GOTO GOTSYSDISK;

  12223  1 002365   002410 710000 1                  TRA     GOTSYSDISK

      782    12224    4                     END;
      783    12225    3                END;

  12225  1 002366   200005 054100                    AOS     I,,AUTO
         1 002367   200172 470500                    LDP0    SQH$,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:132  
         1 002370   000002 236100                    LDQ     2,,PR0
         1 002371   777777 376007                    ANQ     -1,DL
         1 002372   200262 756100                    STQ     DQH$+2,,AUTO
         1 002373   000002 236100                    LDQ     2,,PR0
         1 002374   000022 772000                    QRL     18
         1 002375   200262 036100                    ADLQ    DQH$+2,,AUTO
         1 002376   002342 604000 1                  TMI     s:12220
         1 002377   200005 116100                    CMPQ    I,,AUTO
         1 002400   002342 605400 1                  TPNZ    s:12220

  12222  1 002401                       GTT          null
      784    12226    2   GTT:      ;
      785    12227    2             CALL ITE$ERROR(%E$NOSYSDISK);

  12227  1 002401   000033 630400 2                  EPPR0   27
         1 002402   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002403   000000 701000 xent               TSX1    ITE$ERROR
         1 002404   000000 011000                    NOP     0

      786    12228    2             CALL ITF$FREEZE;

  12228  1 002405   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002406   000000 701000 xent               TSX1    ITF$FREEZE
         1 002407   000000 011000                    NOP     0

      787    12229        /**/
      788    12230    2   GOTSYSDISK: IF (IT_BOOTFLAG = I_VOLONLY) THEN GOTO STARTGHOST1;

  12230  1 002410   000000 235000 xsym  GOTSYSDISK   LDA     IT_BOOTFLAG
         1 002411   000001 115007                    CMPA    1,DL
         1 002412   005155 600000 1                  TZE     STARTGHOST1

      789    12231    2           END;

      790    12232        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:133  
      791    12233        /*
      792    12234                SURVEY OF STORE UNITS ON SYSTEM.  BUILD H_STOREUNIT,
      793    12235                H_CPU_CONFIG, H_SCU_CONFIG, H_SCU_BF, AND H_CPU_BF
      794    12236                TABLES IN MONITOR STATIC.
      795    12237        */
      796    12238    1        IF H_S1000_FLG THEN CALL HFC$RCONF (H_S1000_CONFIG);

  12238  1 002413   000000 234000 xsym               SZN     H_S1000_FLG
         1 002414   002421 605000 1                  TPL     s:12239

  12238  1 002415   000034 630400 2                  EPPR0   28
         1 002416   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002417   000000 701000 xent               TSX1    HFC$RCONF
         1 002420   000000 011000                    NOP     0

      797    12239    2        IF H_RPM_FLG THEN DO;

  12239  1 002421   000000 234000 xsym               SZN     H_RPM_FLG
         1 002422   002432 605000 1                  TPL     s:12243

      798    12240    2             CALL HFC$RSCR(B$SCU$,8,H_DPS8000_SCU_CONF_REG);

  12240  1 002423   000035 630400 2                  EPPR0   29
         1 002424   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 002425   000000 701000 xent               TSX1    HFC$RSCR
         1 002426   000000 011000                    NOP     0

      799    12241    2             CALL HFC$RCONF_8000;

  12241  1 002427   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002430   000000 701000 xent               TSX1    HFC$RCONF_8000
         1 002431   000000 011000                    NOP     0

      800    12242    2           END;

      801    12243    1        H_CPU_CONFIG = H_RSW1(S_PNO);      /* CPU PORT CONFIG SWITCHES           */

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:134  
  12243  1 002432   000000 720000 xsym               LXL0    S_PNO
         1 002433   000000 236010 xsym               LDQ     H_RSW1,X0
         1 002434   000000 756000 xsym               STQ     H_CPU_CONFIG

      802    12244    1        STOREUNIT#=0;                 /* INDEX INTO 16 WORD H_STOREUNIT TABLE    */

  12244  1 002435   200214 450100                    STZ     STOREUNIT#,,AUTO

      803    12245    1        H_MAXPORT# = -1;

  12245  1 002436   000001 335007                    LCA     1,DL
         1 002437   000000 755000 xsym               STA     H_MAXPORT#

      804    12246    1        RSW2 = H_RSW2(S_PNO);

  12246  1 002440   000000 236010 xsym               LDQ     H_RSW2,X0
         1 002441   200232 756100                    STQ     RSW2,,AUTO

      805    12247    1        IF S_PTYPE(S_PNO)=%ELS1

  12247  1 002442   000000 235010 xsym               LDA     S_PTYPE,X0
         1 002443   000002 115007                    CMPA    2,DL
         1 002444   002450 601000 1                  TNZ     s:12249

      806    12248    1        THEN MAX_NUM_PORTS=2;

  12248  1 002445   000002 235007                    LDA     2,DL
         1 002446   200041 755100                    STA     MAX_NUM_PORTS,,AUTO
         1 002447   002452 710000 1                  TRA     s:12250

      807    12249    1        ELSE MAX_NUM_PORTS=4;

  12249  1 002450   000004 235007                    LDA     4,DL
         1 002451   200041 755100                    STA     MAX_NUM_PORTS,,AUTO

      808    12250    2        DO PORT# = 0 TO MAX_NUM_PORTS-1;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:135  
  12250  1 002452   200215 450100                    STZ     PORT#,,AUTO
         1 002453   002771 710000 1                  TRA     s:12338+1

      809    12251    2             CPU_CONFIG=H_CPU_CONFIG(PORT#);

  12251  1 002454   200215 235100                    LDA     PORT#,,AUTO
         1 002455   000100 100405                    MLR     fill='000'O
         1 002456   000000 000001 xsym               ADSC9   H_CPU_CONFIG,A           cn=0,n=1
         1 002457   200226 000001                    ADSC9   CPU_CONFIG,,AUTO         cn=0,n=1

      810    12252    2             IF CPU_CONFIG.PORT_ENABLE

  12252  1 002460   200226 236100                    LDQ     CPU_CONFIG,,AUTO
         1 002461   040000 316003                    CANQ    16384,DU
         1 002462   002770 600000 1                  TZE     s:12338

      811    12253    3             THEN DO;

      812    12254    4                  DO CASE (S_PTYPE(S_PNO));

  12254  1 002463   000000 720000 xsym               LXL0    S_PNO
         1 002464   000000 235010 xsym               LDA     S_PTYPE,X0
         1 002465   000003 115007                    CMPA    3,DL
         1 002466   002470 602005 1                  TNC     s:12254+5,AL
         1 002467   002532 710000 1                  TRA     s:12267
         1 002470   002473 710000 1                  TRA     s:12256
         1 002471   002521 710000 1                  TRA     s:12264
         1 002472   002521 710000 1                  TRA     s:12264

      813    12255    4                  CASE (%L66);

      814    12256    4                     PORT_MEM_SIZE = L66_CPU_MEM_SIZE(CPU_CONFIG.SIZE);

  12256  1 002473   200226 236100                    LDQ     CPU_CONFIG,,AUTO
         1 002474   000033 772000                    QRL     27
         1 002475   000007 376007                    ANQ     7,DL
         1 002476   000020 235006 0                  LDA     L66_CPU_MEM_SIZE,QL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:136  
         1 002477   200217 755100                    STA     PORT_MEM_SIZE,,AUTO

      815    12257    4                     H_CPU_BF(PORT#) = L66_CPU_BF(CPU_CONFIG.SIZE);

  12257  1 002500   000040 235006 0                  LDA     L66_CPU_BF,QL
         1 002501   200215 721100                    LXL1    PORT#,,AUTO
         1 002502   000000 755011 xsym               STA     H_CPU_BF,X1

      816    12258    4                     IF RSW2.L66_SIZE_MULT(PORT#) = '1'B

  12258  1 002503   200215 235100                    LDA     PORT#,,AUTO
         1 002504   002506 605000 1                  TPL     s:12258+3
         1 002505   000044 035003                    ADLA    36,DU
         1 002506   000000 066505                    CMPB    filb='0'B
         1 002507   200232 000001                    BDSC    RSW2,A,AUTO              by=0,bit=0,n=1
         1 002510   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 002511   002535 600000 1                  TZE     s:12270

      817    12259    5                     THEN DO;

      818    12260    5                          PORT_MEM_SIZE = PORT_MEM_SIZE * 16;

  12260  1 002512   200217 235100                    LDA     PORT_MEM_SIZE,,AUTO
         1 002513   000004 735000                    ALS     4
         1 002514   200217 755100                    STA     PORT_MEM_SIZE,,AUTO

      819    12261    5                          H_CPU_BF(PORT#) = H_CPU_BF(PORT#) - 4;

  12261  1 002515   000000 235011 xsym               LDA     H_CPU_BF,X1
         1 002516   000004 135007                    SBLA    4,DL
         1 002517   000000 755011 xsym               STA     H_CPU_BF,X1

      820    12262    5                        END;

  12262  1 002520   002535 710000 1                  TRA     s:12270

      821    12263    4                  CASE (%DPSE,%ELS1);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:137  

      822    12264    4                     PORT_MEM_SIZE=DPSE_ELS1_CPU_MEM_SIZE(CPU_CONFIG.SIZE);

  12264  1 002521   200226 236100                    LDQ     CPU_CONFIG,,AUTO
         1 002522   000033 772000                    QRL     27
         1 002523   000007 376007                    ANQ     7,DL
         1 002524   000030 235006 0                  LDA     DPSE_ELS1_CPU_MEM_SIZE,QL
         1 002525   200217 755100                    STA     PORT_MEM_SIZE,,AUTO

      823    12265    4                     H_CPU_BF(PORT#)=DPSE_ELS1_CPU_BF(CPU_CONFIG.SIZE);

  12265  1 002526   000050 235006 0                  LDA     DPSE_ELS1_CPU_BF,QL
         1 002527   200215 721100                    LXL1    PORT#,,AUTO
         1 002530   000000 755011 xsym               STA     H_CPU_BF,X1
         1 002531   002535 710000 1                  TRA     s:12270

      824    12266    4                  CASE (ELSE);

      825    12267    4                     PORT_MEM_SIZE=0;

  12267  1 002532   200217 450100                    STZ     PORT_MEM_SIZE,,AUTO

      826    12268    4                     H_CPU_BF(PORT#)=0;

  12268  1 002533   200215 721100                    LXL1    PORT#,,AUTO
         1 002534   000000 450011 xsym               STZ     H_CPU_BF,X1

      827    12269    4                  END;

      828    12270    3                  IF CPU_CONFIG.INTERLACE

  12270  1 002535   200226 236100                    LDQ     CPU_CONFIG,,AUTO
         1 002536   010000 316003                    CANQ    4096,DU
         1 002537   002575 600000 1                  TZE     s:12288
         1 002540   200226 236100                    LDQ     CPU_CONFIG,,AUTO
         1 002541   000041 772000                    QRL     33
         1 002542   000001 376007                    ANQ     1,DL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:138  
         1 002543   002575 600000 1                  TZE     s:12288

      829    12271    3                       AND (MOD(CPU_CONFIG.PORT_ASSIGN,2)~=0)
      830    12272    4                  THEN DO;

      831    12273        /*
      832    12274                         CPU INTERLACE AND START ADDRESS IS ODD
      833    12275        */
      834    12276    4                       IF S_PTYPE(S_PNO) = %DPSE

  12276  1 002544   000000 235010 xsym               LDA     S_PTYPE,X0
         1 002545   000001 115007                    CMPA    1,DL
         1 002546   002561 601000 1                  TNZ     s:12279
         1 002547   200215 236100                    LDQ     PORT#,,AUTO
         1 002550   002552 605000 1                  TPL     s:12276+6
         1 002551   000044 036003                    ADLQ    36,DU
         1 002552   000000 066506                    CMPB    filb='0'B
         1 002553   200232 000001                    BDSC    RSW2,Q,AUTO              by=0,bit=0,n=1
         1 002554   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 002555   002561 600000 1                  TZE     s:12279

      835    12277    4                            AND RSW2.DPSE_2WAY(PORT#) = '1'B
      836    12278    4                       THEN CPU_INTL = 2;

  12278  1 002556   000002 236007                    LDQ     2,DL
         1 002557   200233 756100                    STQ     CPU_INTL,,AUTO
         1 002560   002563 710000 1                  TRA     s:12280

      837    12279    4                       ELSE CPU_INTL = 4;

  12279  1 002561   000004 236007                    LDQ     4,DL
         1 002562   200233 756100                    STQ     CPU_INTL,,AUTO

      838    12280    4                       PORT_START_ADDR=

  12280  1 002563   200226 236100                    LDQ     CPU_CONFIG,,AUTO
         1 002564   000041 772000                    QRL     33
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:139  
         1 002565   000001 136007                    SBLQ    1,DL
         1 002566   200217 402100                    MPY     PORT_MEM_SIZE,,AUTO
         1 002567   200233 036100                    ADLQ    CPU_INTL,,AUTO
         1 002570   200216 756100                    STQ     PORT_START_ADDR,,AUTO

      839    12281    4                            PORT_MEM_SIZE*(CPU_CONFIG.PORT_ASSIGN-1)+CPU_INTL;
      840    12282    4                       RSCR_ADDR=8+CPU_INTL; /* FOR HFC$RSCR CALL                  */

  12282  1 002571   200233 235100                    LDA     CPU_INTL,,AUTO
         1 002572   000010 035007                    ADLA    8,DL
         1 002573   200221 755100                    STA     RSCR_ADDR,,AUTO

      841    12283    4                     END;

  12283  1 002574   002603 710000 1                  TRA     s:12292

      842    12284    4                  ELSE DO;

      843    12285        /*
      844    12286                         NO CPU INTERLACE OR START ADDRESS IS EVEN
      845    12287        */
      846    12288    4                       PORT_START_ADDR=

  12288  1 002575   200226 236100                    LDQ     CPU_CONFIG,,AUTO
         1 002576   000041 772000                    QRL     33
         1 002577   200217 402100                    MPY     PORT_MEM_SIZE,,AUTO
         1 002600   200216 756100                    STQ     PORT_START_ADDR,,AUTO

      847    12289    4                            PORT_MEM_SIZE*CPU_CONFIG.PORT_ASSIGN;
      848    12290    4                       RSCR_ADDR=8;        /* FOR HFC$RSCR CALL                  */

  12290  1 002601   000010 235007                    LDA     8,DL
         1 002602   200221 755100                    STA     RSCR_ADDR,,AUTO

      849    12291    4                     END;

      850    12292    3                  H_MAXPORT# = H_MAXPORT#+1;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:140  

  12292  1 002603   000000 054000 xsym               AOS     H_MAXPORT#

      851    12293    3                  H_PORT_FIRST_ADDR(H_MAXPORT#)=PORT_START_ADDR;

  12293  1 002604   000000 722000 xsym               LXL2    H_MAXPORT#
         1 002605   000000 756012 xsym               STQ     H_PORT_FIRST_ADDR,X2

      852    12294    3                  CALL MME$CVM(%MONWSQ,%WINDOWLO,PORT_START_ADDR/1024,ERRCDE);

  12294  1 002606   002000 506007                    DIV     1024,DL
         1 002607   200262 756100                    STQ     DQH$+2,,AUTO
         1 002610   200220 630500                    EPPR0   ERRCDE,,AUTO
         1 002611   200267 450500                    STP0    DQH$+7,,AUTO
         1 002612   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 002613   200266 451500                    STP1    DQH$+6,,AUTO
         1 002614   000004 237000 2                  LDAQ    4
         1 002615   200264 757100                    STAQ    DQH$+4,,AUTO
         1 002616   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 002617   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 002620   000000 701000 xent               TSX1    MME$CVM
         1 002621   000000 011000                    NOP     0

      853    12295    3                  CALL HFC$RSCR(B$WINDOW$,RSCR_ADDR,SCU_CONFIG);

  12295  1 002622   200230 630500                    EPPR0   SCU_CONFIG,,AUTO
         1 002623   200264 450500                    STP0    DQH$+4,,AUTO
         1 002624   200221 631500                    EPPR1   RSCR_ADDR,,AUTO
         1 002625   200263 451500                    STP1    DQH$+3,,AUTO
         1 002626   000040 236000 2                  LDQ     32
         1 002627   200262 756100                    STQ     DQH$+2,,AUTO
         1 002630   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 002631   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 002632   000000 701000 xent               TSX1    HFC$RSCR
         1 002633   000000 011000                    NOP     0

      854    12296    3                  H_SCU_CONFIG(PORT#)=SCU_CONFIG;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:141  

  12296  1 002634   200215 235100                    LDA     PORT#,,AUTO
         1 002635   000001 735000                    ALS     1
         1 002636   000000 620005                    EAX0    0,AL
         1 002637   200230 237100                    LDAQ    SCU_CONFIG,,AUTO
         1 002640   000000 757010 xsym               STAQ    H_SCU_CONFIG,X0

      855    12297    3                  LOWER_STORE_SIZE=SCU_MEM_SIZE(SCU_CONFIG.SIZE);

  12297  1 002641   200230 236100                    LDQ     SCU_CONFIG,,AUTO
         1 002642   000030 772000                    QRL     24
         1 002643   000007 376007                    ANQ     7,DL
         1 002644   000060 235006 0                  LDA     SCU_MEM_SIZE,QL
         1 002645   200222 755100                    STA     LOWER_STORE_SIZE,,AUTO

      856    12298    3                  H_SCU_BF(PORT#)=SCU_BF(SCU_CONFIG.SIZE);

  12298  1 002646   000070 235006 0                  LDA     SCU_BF,QL
         1 002647   200215 721100                    LXL1    PORT#,,AUTO
         1 002650   000000 755011 xsym               STA     H_SCU_BF,X1

      857    12299    3                  SU.ONLINE_REDEF=SCU_CONFIG.ON_LINE;

  12299  1 002651   200230 236100                    LDQ     SCU_CONFIG,,AUTO
         1 002652   000014 736000                    QLS     12
         1 002653   200225 676100                    ERQ     SU,,AUTO
         1 002654   740000 376003                    ANQ     -16384,DU
         1 002655   200225 656100                    ERSQ    SU,,AUTO

      858    12300    4                  DO SU# = 0 TO 3;         /* DO FOR ALL STORAGE UNITS ON SCU    */

  12300  1 002656   200223 450100                    STZ     SU#,,AUTO

      859    12301                                 /* If the B is the lower bank change the logical Su# */
      860    12302    4                       IF SCU_CONFIG.LOWER_STORE

  12302  1 002657   200230 236100                    LDQ     SCU_CONFIG,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:142  
         1 002660   000020 316007                    CANQ    16,DL
         1 002661   002673 600000 1                  TZE     s:12310

      861    12303    4                       THEN
      862    12304    4                            IF SU# < 2

  12304  1 002662   200223 235100                    LDA     SU#,,AUTO
         1 002663   000002 115007                    CMPA    2,DL
         1 002664   002670 605000 1                  TPL     s:12308

      863    12305    4                            THEN
      864    12306    4                                 LOG_SU# = SU#+2;

  12306  1 002665   000002 035007                    ADLA    2,DL
         1 002666   200224 755100                    STA     LOG_SU#,,AUTO
         1 002667   002675 710000 1                  TRA     s:12312

      865    12307    4                            ELSE
      866    12308    4                                 LOG_SU# = SU# - 2;

  12308  1 002670   000002 135007                    SBLA    2,DL
         1 002671   200224 755100                    STA     LOG_SU#,,AUTO
         1 002672   002675 710000 1                  TRA     s:12312

      867    12309    4                       ELSE
      868    12310    4                            LOG_SU# = SU#;

  12310  1 002673   200223 235100                    LDA     SU#,,AUTO
         1 002674   200224 755100                    STA     LOG_SU#,,AUTO

      869    12311
      870    12312    4                       IF SU.ONLINE(SU#)

  12312  1 002675   200223 235100                    LDA     SU#,,AUTO
         1 002676   002700 605000 1                  TPL     s:12312+3
         1 002677   000044 035003                    ADLA    36,DU
         1 002700   000000 066505                    CMPB    filb='0'B
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:143  
         1 002701   200225 000001                    BDSC    SU,A,AUTO                by=0,bit=0,n=1
         1 002702   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 002703   002764 600000 1                  TZE     s:12336

      871    12313    5                       THEN DO;

      872    12314    5                            IF (NOT SCU_CONFIG.INTERLACE) OR (LOG_SU#<2)

  12314  1 002704   000040 316007                    CANQ    32,DL
         1 002705   002711 600000 1                  TZE     s:12319
         1 002706   200224 235100                    LDA     LOG_SU#,,AUTO
         1 002707   000002 115007                    CMPA    2,DL
         1 002710   002722 605000 1                  TPL     s:12326

      873    12315    6                            THEN DO;

      874    12316        /*
      875    12317                               NO SCU INTERLACE OR LOWER STORE PAIR
      876    12318        */
      877    12319    6                                 H_STOREUNIT.FIRST_ADDR(STOREUNIT#)=PORT_START_ADDR

  12319  1 002711   200222 236100                    LDQ     LOWER_STORE_SIZE,,AUTO
         1 002712   200224 402100                    MPY     LOG_SU#,,AUTO
         1 002713   000002 506007                    DIV     2,DL
         1 002714   200216 036100                    ADLQ    PORT_START_ADDR,,AUTO
         1 002715   200214 720100                    LXL0    STOREUNIT#,,AUTO
         1 002716   000000 676010 xsym               ERQ     H_STOREUNIT,X0
         1 002717   000041 376000 2                  ANQ     33
         1 002720   000000 656010 xsym               ERSQ    H_STOREUNIT,X0

      878    12320    6                                      + LOWER_STORE_SIZE*LOG_SU#/2;
      879    12321    6                               END;

  12321  1 002721   002734 710000 1                  TRA     s:12329

      880    12322    6                            ELSE DO;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:144  
      881    12323        /*
      882    12324                               SCU INTERLACE AND UPPER STORE PAIR
      883    12325        */
      884    12326    6                                 H_STOREUNIT.FIRST_ADDR(STOREUNIT#)=PORT_START_ADDR

  12326  1 002722   200224 236100                    LDQ     LOG_SU#,,AUTO
         1 002723   000002 136007                    SBLQ    2,DL
         1 002724   200222 402100                    MPY     LOWER_STORE_SIZE,,AUTO
         1 002725   000002 506007                    DIV     2,DL
         1 002726   200216 036100                    ADLQ    PORT_START_ADDR,,AUTO
         1 002727   200214 720100                    LXL0    STOREUNIT#,,AUTO
         1 002730   000002 036007                    ADLQ    2,DL
         1 002731   000000 676010 xsym               ERQ     H_STOREUNIT,X0
         1 002732   000041 376000 2                  ANQ     33
         1 002733   000000 656010 xsym               ERSQ    H_STOREUNIT,X0

      885    12327    6                                      + (LOWER_STORE_SIZE*(LOG_SU#-2)/2)+2;
      886    12328    6                               END;

      887    12329    5                            H_STOREUNIT.PORT#(STOREUNIT#)=PORT#;

  12329  1 002734   200215 236100                    LDQ     PORT#,,AUTO
         1 002735   000042 736000                    QLS     34
         1 002736   000000 676010 xsym               ERQ     H_STOREUNIT,X0
         1 002737   600000 376003                    ANQ     -65536,DU
         1 002740   000000 656010 xsym               ERSQ    H_STOREUNIT,X0

      888    12330    5                            IF SCU_CONFIG.LOWER_STORE

  12330  1 002741   200230 236100                    LDQ     SCU_CONFIG,,AUTO
         1 002742   000020 316007                    CANQ    16,DL
         1 002743   002753 600000 1                  TZE     s:12332

      889    12331    5                            THEN H_STOREUNIT.STORE_UNIT#(STOREUNIT#)=B_LOW(SU#);

  12331  1 002744   200223 721100                    LXL1    SU#,,AUTO
         1 002745   000104 236011 0                  LDQ     B_LOW,X1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:145  
         1 002746   000040 736000                    QLS     32
         1 002747   000000 676010 xsym               ERQ     H_STOREUNIT,X0
         1 002750   140000 376003                    ANQ     49152,DU
         1 002751   000000 656010 xsym               ERSQ    H_STOREUNIT,X0
         1 002752   002761 710000 1                  TRA     s:12333

      890    12332    5                            ELSE H_STOREUNIT.STORE_UNIT#(STOREUNIT#)=A_LOW(SU#);

  12332  1 002753   200223 721100                    LXL1    SU#,,AUTO
         1 002754   000100 236011 0                  LDQ     A_LOW,X1
         1 002755   000040 736000                    QLS     32
         1 002756   000000 676010 xsym               ERQ     H_STOREUNIT,X0
         1 002757   140000 376003                    ANQ     49152,DU
         1 002760   000000 656010 xsym               ERSQ    H_STOREUNIT,X0

      891    12333    5                            H_MAXSU#=STOREUNIT#;

  12333  1 002761   200214 235100                    LDA     STOREUNIT#,,AUTO
         1 002762   000000 755000 xsym               STA     H_MAXSU#

      892    12334    5                            STOREUNIT#=STOREUNIT#+1;

  12334  1 002763   200214 054100                    AOS     STOREUNIT#,,AUTO

      893    12335    5                          END;

      894    12336    4                     END;

  12336  1 002764   200223 054100                    AOS     SU#,,AUTO
         1 002765   200223 235100                    LDA     SU#,,AUTO
         1 002766   000003 115007                    CMPA    3,DL
         1 002767   002657 604400 1                  TMOZ    s:12302

      895    12337    3                END;

      896    12338    2           END;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:146  
  12338  1 002770   200215 054100                    AOS     PORT#,,AUTO
         1 002771   200215 236100                    LDQ     PORT#,,AUTO
         1 002772   200041 116100                    CMPQ    MAX_NUM_PORTS,,AUTO
         1 002773   002454 604000 1                  TMI     s:12251

      897    12339        /**/
      898    12340    1        H_MEMOK = '1'B;                    /* NOW, ENAPORT CAN DO ALL STUFF */

  12340  1 002774   400000 236003                    LDQ     -131072,DU
         1 002775   000000 756000 xsym               STQ     H_MEMOK

      899    12341    1        CALL HFB$INITMASK;            /* MAKE H_PORTMASK THE REAL SCU PORT MASK  */

  12341  1 002776   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002777   000000 701000 xent               TSX1    HFB$INITMASK
         1 003000   000000 011000                    NOP     0

      900    12342    1        IF IT_BOOTFLAG >= I_RECOVERY THEN GOTO STARTGHOST1;

  12342  1 003001   000000 235000 xsym               LDA     IT_BOOTFLAG
         1 003002   000011 115007                    CMPA    9,DL
         1 003003   005155 603000 1                  TRC     STARTGHOST1

      901    12343        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:147  
      902    12344        /**/
      903    12345    1        CALL NIM$WRENBL(IT_DBUF,IT_DBUFEND); /* UNWRITE PROTECT BUFFER        */

  12345  1 003004   000042 630400 2                  EPPR0   34
         1 003005   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003006   000000 701000 xent               TSX1    NIM$WRENBL
         1 003007   000000 011000                    NOP     0

      904    12346
      905    12347    1        IT_DATASIZE = POFFW (PTR$,B$TIGR$);

  12347  1 003010   000000 235000 xsym               LDA     B$TIGR$
         1 003011   000022 771000                    ARL     18
         1 003012   200262 755100                    STA     DQH$+2,,AUTO
         1 003013   200003 470500                    LDP0    @PTR$,,AUTO
         1 003014   000000 236100                    LDQ     0,,PR0
         1 003015   000022 772000                    QRL     18
         1 003016   200262 136100                    SBLQ    DQH$+2,,AUTO
         1 003017   000000 756000 xsym               STQ     IT_DATASIZE

      906    12348
      907    12349                                                /* COMPUTE SIZE OF TIGRDATA
      908    12350                                                     FOR TIGRCUB.X */
      909    12351    1        IF IT_TIGRCUB THEN GOTO STARTGHOST1;

  12351  1 003020   000000 234000 xsym               SZN     IT_TIGRCUB
         1 003021   005155 604000 1                  TMI     STARTGHOST1

      910    12352        /**/
      911    12353    1        DBUF$ = ADDR(IT_DBUF);

  12353  1 003022   000042 236000 2                  LDQ     34
         1 003023   200200 756100                    STQ     DBUF$,,AUTO

      912    12354        /**/
      913    12355    1        CALL ITQ$DREAD(DBUF$,VIDDA) ALTRET (DISK_ERR);

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:148  
  12355  1 003024   000010 236000 2                  LDQ     8
         1 003025   200263 756100                    STQ     DQH$+3,,AUTO
         1 003026   200200 631500                    EPPR1   DBUF$,,AUTO
         1 003027   200262 451500                    STP1    DQH$+2,,AUTO
         1 003030   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003032   000000 701000 xent               TSX1    ITQ$DREAD
         1 003033   006715 702000 1                  TSX2    DISK_ERR

      914    12356        /**/
      915    12357    1        MIN_DA = DBUF$ -> FM$VID.SYSSIZE - 1;

  12357  1 003034   200200 470500                    LDP0    DBUF$,,AUTO
         1 003035   000005 235100                    LDA     5,,PR0
         1 003036   000001 135007                    SBLA    1,DL
         1 003037   200033 755100                    STA     MIN_DA,,AUTO

      916    12358    1        DIR_DA = DBUF$ -> FM$VID.SYSDIRDA;

  12358  1 003040   000006 235100                    LDA     6,,PR0
         1 003041   200040 755100                    STA     DIR_DA,,AUTO

      917    12359        /**/
      918    12360    1        CALL ITH$READ_VERIFY_SAD(DBUF$,DIR_DA) ALTRET (DISK_ERR);

  12360  1 003042   200040 631500                    EPPR1   DIR_DA,,AUTO
         1 003043   200263 451500                    STP1    DQH$+3,,AUTO
         1 003044   200200 633500                    EPPR3   DBUF$,,AUTO
         1 003045   200262 453500                    STP3    DQH$+2,,AUTO
         1 003046   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003047   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003050   000000 701000 xent               TSX1    ITH$READ_VERIFY_SAD
         1 003051   006715 702000 1                  TSX2    DISK_ERR

      919    12361    1        IT_SYSDIR$->I$DISKDIR=DBUF$->I$DISKDIR;

  12361  1 003052   200200 470500                    LDP0    DBUF$,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:149  
         1 003053   000000 471400 xsym               LDP1    IT_SYSDIR$
         1 003054   000100 100500                    MLR     fill='000'O
         1 003055   000000 001700                    ADSC9   0,,PR0                   cn=0,n=960
         1 003056   100000 001700                    ADSC9   0,,PR1                   cn=0,n=960

      920    12362        /**/
      921    12363    1        MONDATA_DA = DBUF$ -> I$DISKDIR.MONDATA.DA;

  12363  1 003057   200200 470500                    LDP0    DBUF$,,AUTO
         1 003060   000015 235100                    LDA     13,,PR0
         1 003061   200034 755100                    STA     MONDATA_DA,,AUTO

      922    12364    1        MONDATA_SIZE = DBUF$ -> I$DISKDIR.MONDATA.SIZE;

  12364  1 003062   000016 235100                    LDA     14,,PR0
         1 003063   200035 755100                    STA     MONDATA_SIZE,,AUTO

      923    12365        /**/
      924    12366    1        TIGRDATA_DA = DBUF$ -> I$DISKDIR.TIGRDATA.DA;

  12366  1 003064   000115 235100                    LDA     77,,PR0
         1 003065   200036 755100                    STA     TIGRDATA_DA,,AUTO

      925    12367    1        LOWREAL_DA = DBUF$ -> I$DISKDIR.LOWREAL.DA;

  12367  1 003066   000005 235100                    LDA     5,,PR0
         1 003067   200037 755100                    STA     LOWREAL_DA,,AUTO

      926    12368        /**/
      927    12369    1        MAX_DA = DBUF$ -> I$DISKDIR.AARDVARK.DA;

  12369  1 003070   000001 235100                    LDA     1,,PR0
         1 003071   200032 755100                    STA     MAX_DA,,AUTO

      928    12370        /**/
      929    12371    1        I = 0;                             /* SAVE FW DATA                       */

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:150  
  12371  1 003072   200005 450100                    STZ     I,,AUTO

      930    12372    2        DO WHILE (DBUF$ -> I$DISKDIR.FW.NAMEBIN(I) ~= 0);

  12372  1 003073   200005 236100                    LDQ     I,,AUTO
         1 003074   000002 736000                    QLS     2
         1 003075   000243 235106                    LDA     163,QL,PR0
         1 003076   003112 600000 1                  TZE     s:12376

      931    12373    2             FW(I) = DBUF$ -> I$DISKDIR.FW(I);

  12373  1 003077   200005 235100                    LDA     I,,AUTO
         1 003100   000004 735000                    ALS     4
         1 003101   200200 470500                    LDP0    DBUF$,,AUTO
         1 003102   000105 100505                    MLR     fill='000'O
         1 003103   000240 000020                    ADSC9   160,A,PR0                cn=0,n=16
         1 003104   200046 000020                    ADSC9   FW,A,AUTO                cn=0,n=16

      932    12374    2             I = I+1;

  12374  1 003105   200005 054100                    AOS     I,,AUTO

      933    12375    2           END;

  12375  1 003106   200005 235100                    LDA     I,,AUTO
         1 003107   000002 735000                    ALS     2
         1 003110   000243 235105                    LDA     163,AL,PR0
         1 003111   003077 601000 1                  TNZ     s:12373

      934    12376    1        FWSLOTS = I;

  12376  1 003112   200005 235100                    LDA     I,,AUTO
         1 003113   200045 755100                    STA     FWSLOTS,,AUTO

      935    12377    1        FW(I) = '0'B;

  12377  1 003114   000004 735000                    ALS     4
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:151  
         1 003115   000105 100400                    MLR     fill='000'O
         1 003116   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 003117   200046 000020                    ADSC9   FW,A,AUTO                cn=0,n=16

      936    12378        /**/
      937    12379    1        DBUF$->I$DISKDIR.MONID.M.VER=DBUF$->I$DISKDIR.MONID.A.VER;

  12379  1 003120   000210 236100                    LDQ     136,,PR0
         1 003121   000211 552170                    STBQ    137,'70'O,PR0

      938    12380    1        I=DBUF$->I$DISKDIR.MONID.A.BOOTC;

  12380  1 003122   000210 236100                    LDQ     136,,PR0
         1 003123   000777 376007                    ANQ     511,DL
         1 003124   200005 756100                    STQ     I,,AUTO

      939    12381    2        DO WHILE (I>61);

  12381  1 003125   000075 116007                    CMPQ    61,DL
         1 003126   003134 604400 1                  TMOZ    s:12384

      940    12382    2             I=I-61;

  12382  1 003127   000075 336007                    LCQ     61,DL
         1 003130   200005 056100                    ASQ     I,,AUTO

      941    12383    2           END;

  12383  1 003131   200005 235100                    LDA     I,,AUTO
         1 003132   000075 115007                    CMPA    61,DL
         1 003133   003127 605400 1                  TPNZ    s:12382

      942    12384    1        DBUF$->I$DISKDIR.MONID.M.BOOTC = RV_BOOTID.C(I);

  12384  1 003134   200005 235100                    LDA     I,,AUTO
         1 003135   200200 470500                    LDP0    DBUF$,,AUTO
         1 003136   040100 100405                    MLR     fill='040'O
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:152  
         1 003137   000000 000001 0                  ADSC9   RV_BOOTID,A              cn=0,n=1
         1 003140   000211 600001                    ADSC9   137,,PR0                 cn=3,n=1

      943    12385    1        B_SITEINFO.VERSION# = DBUF$ -> I$DISKDIR.MONID.M_CHAR4;

  12385  1 003141   000211 236100                    LDQ     137,,PR0
         1 003142   000064 756000 xsym               STQ     B_SITEINFO+52

      944    12386        /**/
      945    12387    1        CALL ITQ$DWRITE(DBUF$,DIR_DA) ALTRET(DISK_ERR);

  12387  1 003143   200040 631500                    EPPR1   DIR_DA,,AUTO
         1 003144   200263 451500                    STP1    DQH$+3,,AUTO
         1 003145   200200 633500                    EPPR3   DBUF$,,AUTO
         1 003146   200262 453500                    STP3    DQH$+2,,AUTO
         1 003147   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003150   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003151   000000 701000 xent               TSX1    ITQ$DWRITE
         1 003152   006715 702000 1                  TSX2    DISK_ERR

      946    12388        /**/
      947    12389    1        CALL ITQ$DREAD(DBUF$,DBUF$ -> I$DISKDIR.SITEINFO.DA) ALTRET(DISK_ERR);

  12389  1 003153   200200 236100                    LDQ     DBUF$,,AUTO
         1 003154   000235 036003                    ADLQ    157,DU
         1 003155   200263 756100                    STQ     DQH$+3,,AUTO
         1 003156   200200 630500                    EPPR0   DBUF$,,AUTO
         1 003157   200262 450500                    STP0    DQH$+2,,AUTO
         1 003160   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003161   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003162   000000 701000 xent               TSX1    ITQ$DREAD
         1 003163   006715 702000 1                  TSX2    DISK_ERR

      948    12390        /**/
      949    12391    1        B_SITEINFO.MON_UTS# = DBUF$ -> B$SITEINFO.MON_UTS#;

  12391  1 003164   200200 470500                    LDP0    DBUF$,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:153  
         1 003165   000065 235100                    LDA     53,,PR0
         1 003166   000065 755000 xsym               STA     B_SITEINFO+53

      950    12392    1        B_SITEINFO.MINI_ID# = DBUF$ -> B$SITEINFO.MINI_ID#;

  12392  1 003167   000000 236100                    LDQ     0,,PR0
         1 003170   000000 552070 xsym               STBQ    B_SITEINFO,'70'O

      951    12393    1        IF (B_SITEINFO.SITE_NAME#.L = 0) THEN

  12393  1 003171   000001 236000 xsym               LDQ     B_SITEINFO+1
         1 003172   777000 316003                    CANQ    -512,DU
         1 003173   003177 601000 1                  TNZ     s:12395

      952    12394    1             B_SITEINFO.SITE_NAME# = DBUF$ -> B$SITEINFO.SITE_NAME#;

  12394  1 003174   000000 100500                    MLR     fill='000'O
         1 003175   000001 000170                    ADSC9   1,,PR0                   cn=0,n=120
         1 003176   000001 000170 xsym               ADSC9   B_SITEINFO+1             cn=0,n=120

      953    12395    1        IF (B_SITEINFO.SALUTATION#.L = 0) THEN

  12395  1 003177   000037 236000 xsym               LDQ     B_SITEINFO+31
         1 003200   777000 316003                    CANQ    -512,DU
         1 003201   003205 601000 1                  TNZ     s:12397

      954    12396    1             B_SITEINFO.SALUTATION# = DBUF$ -> B$SITEINFO.SALUTATION#;

  12396  1 003202   000000 100500                    MLR     fill='000'O
         1 003203   000037 000120                    ADSC9   31,,PR0                  cn=0,n=80
         1 003204   000037 000120 xsym               ADSC9   B_SITEINFO+31            cn=0,n=80

      955    12397    1        IF (B_SITEINFO.SITE_ID# = ' ') THEN

  12397  1 003205   040000 106400                    CMPC    fill='040'O
         1 003206   000066 000006 xsym               ADSC9   B_SITEINFO+54            cn=0,n=6
         1 003207   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:154  
         1 003210   003214 601000 1                  TNZ     s:12400

      956    12398    1             B_SITEINFO.SITE_ID# = DBUF$ -> B$SITEINFO.SITE_ID#;

  12398  1 003211   040000 100500                    MLR     fill='040'O
         1 003212   000066 000006                    ADSC9   54,,PR0                  cn=0,n=6
         1 003213   000066 000006 xsym               ADSC9   B_SITEINFO+54            cn=0,n=6

      957    12399        /**/
      958    12400    1        REQ$ = B$DS1$;                     /* GET DS1 FOR FW                     */

  12400  1 003214   000000 236000 xsym               LDQ     B$DS1$
         1 003215   200171 756100                    STQ     REQ$,,AUTO

      959    12401    1        MM_DSMAX(0) = MAXFWSIZE;           /* LET IT GROW                        */

  12401  1 003216   024000 236003                    LDQ     10240,DU
         1 003217   000000 552040 xsym               STBQ    MM_DSMAX,'40'O

      960    12402    1        CALL MMH$GDS(%MONWSQ,REREQ$.SEGID,MAXFWSIZE*1024,J) ALTRET(NO_FW);

  12402  1 003220   200006 631500                    EPPR1   J,,AUTO
         1 003221   200265 451500                    STP1    DQH$+5,,AUTO
         1 003222   000045 236000 2                  LDQ     37
         1 003223   200264 756100                    STQ     DQH$+4,,AUTO
         1 003224   200266 452500                    STP2    DQH$+6,,AUTO
         1 003225   200266 236100                    LDQ     DQH$+6,,AUTO
         1 003226   000023 036000 2                  ADLQ    19
         1 003227   000002 235000 2                  LDA     2
         1 003230   200262 757100                    STAQ    DQH$+2,,AUTO
         1 003231   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003232   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 003233   000000 701000 xent               TSX1    MMH$GDS
         1 003234   006724 702000 1                  TSX2    NO_FW

      961    12403        /**/
      962    12404    1        S_TIMR=2;                          /* SET TO MONITOR EXECUTION           */
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:155  

  12404  1 003235   000002 235007                    LDA     2,DL
         1 003236   000000 755000 xsym               STA     S_TIMR

      963    12405    1        IF  HW_IMX

  12405  1 003237   000000 234000 xsym               SZN     HW_IMX
         1 003240   003763 605000 1                  TPL     s:12498

      964    12406    2        THEN DO ;

      965    12407    2             CALL ITK$TMB$BUF_ALLOC(BUF$,BUFX) ALTRET(CONFIG_ERR);

  12407  1 003241   200247 630500                    EPPR0   BUFX,,AUTO
         1 003242   200263 450500                    STP0    DQH$+3,,AUTO
         1 003243   200246 631500                    EPPR1   BUF$,,AUTO
         1 003244   200262 451500                    STP1    DQH$+2,,AUTO
         1 003245   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003246   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003247   000000 701000 xent               TSX1    ITK$TMB$BUF_ALLOC
         1 003250   006732 702000 1                  TSX2    CONFIG_ERR

      966    12408    3             DO I = 0 TO NI_IOMS-1;

  12408  1 003251   200005 450100                    STZ     I,,AUTO
         1 003252   003516 710000 1                  TRA     s:12464+1

      967    12409    3                  IF NOT IT_PARTITION.IOCHAN(I*%N_MAXCHANS)

  12409  1 003253   200005 235100                    LDA     I,,AUTO
         1 003254   000007 735000                    ALS     7
         1 003255   003257 605000 1                  TPL     s:12409+4
         1 003256   000044 035003                    ADLA    36,DU
         1 003257   000000 066405                    CMPB    filb='0'B
         1 003260   000012 000001 xsym               BDSC    IT_PARTITION+10,A        by=0,bit=0,n=1
         1 003261   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 003262   003515 601000 1                  TNZ     s:12464
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:156  

      968    12410    4                  THEN DO ;

      969    12411    4                       CALL ITK$TMB$MCA(N$DCT$(NI_MAINT_DCTX(I))->NI$DCT.DQH$->NI$DQH,
             12411                                TM_OC_CONFIG#,BUFX)

  12411  1 003263   200005 720100                    LXL0    I,,AUTO
         1 003264   000000 721010 xsym               LXL1    NI_MAINT_DCTX,X0
         1 003265   000000 470400 xsym               LDP0    N$DCT$$
         1 003266   000000 471511                    LDP1    0,X1,PR0
         1 003267   100023 473500                    LDP3    19,,PR1
         1 003270   200247 634500                    EPPR4   BUFX,,AUTO
         1 003271   200264 454500                    STP4    DQH$+4,,AUTO
         1 003272   000002 236000 2                  LDQ     2
         1 003273   200263 756100                    STQ     DQH$+3,,AUTO
         1 003274   200262 453500                    STP3    DQH$+2,,AUTO
         1 003275   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003276   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 003277   000000 701000 xent               TSX1    ITK$TMB$MCA
         1 003300   003302 702000 1                  TSX2    s:12413
         1 003301   003313 710000 1                  TRA     s:12416

      970    12412    5                       WHENALTRETURN DO ;

      971    12413    5                            CALL ITK$TMB$BUF_DEALLOC (BUF$,BUFX);

  12413  1 003302   200247 630500                    EPPR0   BUFX,,AUTO
         1 003303   200263 450500                    STP0    DQH$+3,,AUTO
         1 003304   200246 631500                    EPPR1   BUF$,,AUTO
         1 003305   200262 451500                    STP1    DQH$+2,,AUTO
         1 003306   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003307   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003310   000000 701000 xent               TSX1    ITK$TMB$BUF_DEALLOC
         1 003311   000000 011000                    NOP     0

      972    12414    5                            GOTO CONFIG_ERR;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:157  
  12414  1 003312   006732 710000 1                  TRA     CONFIG_ERR

      973    12415    5                          END ;
      974    12416    5                       DO IPC = 0 TO 15;

  12416  1 003313   200244 450100                    STZ     IPC,,AUTO

      975    12417    5                            DQH$ = ADDR(NIL);

  12417  1 003314   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 003315   200173 756100                    STQ     DQH$,,AUTO

      976    12418    5                            IF MCA_CFG.LEVEL_1.STATE(IPC) > 7

  12418  1 003316   200244 236100                    LDQ     IPC,,AUTO
         1 003317   000013 402007                    MPY     11,DL
         1 003320   200246 470500                    LDP0    BUF$,,AUTO
         1 003321   000100 101506                    MRL     fill='000'O
         1 003322   000026 400001                    ADSC9   22,Q,PR0                 cn=2,n=1
         1 003323   200262 000004                    ADSC9   DQH$+2,,AUTO             cn=0,n=4
         1 003324   200262 236100                    LDQ     DQH$+2,,AUTO
         1 003325   000010 116007                    CMPQ    8,DL
         1 003326   003367 604000 1                  TMI     s:12428

      977    12419    6                            THEN DO ;

      978    12420    6                                CHAN = I * %N_MAXCHANS + MCA_CFG.LEVEL_1.PRI_CHN(IPC);

  12420  1 003327   200244 236100                    LDQ     IPC,,AUTO
         1 003330   000013 402007                    MPY     11,DL
         1 003331   000100 101506                    MRL     fill='000'O
         1 003332   000030 000001                    ADSC9   24,Q,PR0                 cn=0,n=1
         1 003333   200262 000004                    ADSC9   DQH$+2,,AUTO             cn=0,n=4
         1 003334   200005 236100                    LDQ     I,,AUTO
         1 003335   000007 736000                    QLS     7
         1 003336   200262 036100                    ADLQ    DQH$+2,,AUTO
         1 003337   200245 756100                    STQ     CHAN,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:158  

      979    12421    7                                DO J = CHAN TO (CHAN + MCA_CFG.LEVEL_1.LOG_CHNS(IPC)-1
             12421                                          );

  12421  1 003340   200006 756100                    STQ     J,,AUTO
         1 003341   003355 710000 1                  TRA     s:12426+1

      980    12422    7                                      DQH$ = NI$CHT$ -> NI$CHT.DQH$(J);

  12422  1 003342   200006 235100                    LDA     J,,AUTO
         1 003343   000001 735000                    ALS     1
         1 003344   000000 470400 xsym               LDP0    NI$CHT$
         1 003345   000000 236105                    LDQ     0,AL,PR0
         1 003346   200173 756100                    STQ     DQH$,,AUTO

      981    12423    7                                      IF DQH$ ~= ADDR(NIL)

  12423  1 003347   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003350   003354 600000 1                  TZE     s:12426

      982    12424    7                                      THEN
      983    12425    7                                           DQH$->NI$DQH.IPCNUM = IPC;

  12425  1 003351   200173 471500                    LDP1    DQH$,,AUTO
         1 003352   200244 236100                    LDQ     IPC,,AUTO
         1 003353   100020 552104                    STBQ    16,'04'O,PR1

      984    12426    7                                    END ;

  12426  1 003354   200006 054100                    AOS     J,,AUTO
         1 003355   200244 236100                    LDQ     IPC,,AUTO
         1 003356   000013 402007                    MPY     11,DL
         1 003357   200246 470500                    LDP0    BUF$,,AUTO
         1 003360   000100 101506                    MRL     fill='000'O
         1 003361   000030 200001                    ADSC9   24,Q,PR0                 cn=1,n=1
         1 003362   200262 000004                    ADSC9   DQH$+2,,AUTO             cn=0,n=4
         1 003363   200262 236100                    LDQ     DQH$+2,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:159  
         1 003364   200245 036100                    ADLQ    CHAN,,AUTO
         1 003365   200006 116100                    CMPQ    J,,AUTO
         1 003366   003342 605400 1                  TPNZ    s:12422

      985    12427    6                               END ;

      986    12428    5                          END ;

  12428  1 003367   200244 054100                    AOS     IPC,,AUTO
         1 003370   200244 235100                    LDA     IPC,,AUTO
         1 003371   000017 115007                    CMPA    15,DL
         1 003372   003314 604400 1                  TMOZ    s:12417

      987    12429    5                       DO CHAN = 8 TO %N_MAXCHANSM1 ;

  12429  1 003373   000010 236007                    LDQ     8,DL
         1 003374   200245 756100                    STQ     CHAN,,AUTO

      988    12430    5                            J = I * %N_MAXCHANS + CHAN ;

  12430  1 003375   200005 236100                    LDQ     I,,AUTO
         1 003376   000007 736000                    QLS     7
         1 003377   200245 036100                    ADLQ    CHAN,,AUTO
         1 003400   200006 756100                    STQ     J,,AUTO

      989    12431    5                            DQH$ = NI$CHT$ -> NI$CHT.DQH$(J) ;

  12431  1 003401   200006 235100                    LDA     J,,AUTO
         1 003402   000001 735000                    ALS     1
         1 003403   000000 470400 xsym               LDP0    NI$CHT$
         1 003404   000000 236105                    LDQ     0,AL,PR0
         1 003405   200173 756100                    STQ     DQH$,,AUTO

      990    12432    5                            IF DQH$ ~= ADDR(NIL)

  12432  1 003406   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003407   003511 600000 1                  TZE     s:12462
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:160  

      991    12433    6                            THEN DO ;

      992    12434    6                                 MPC$ = DQH$->NI$DQH.MPC$ ;

  12434  1 003410   200173 471500                    LDP1    DQH$,,AUTO
         1 003411   100015 236100                    LDQ     13,,PR1
         1 003412   200176 756100                    STQ     MPC$,,AUTO

      993    12435    6                                 SQH$ = DQH$->NI$DQH.SQH$ ;

  12435  1 003413   100013 236100                    LDQ     11,,PR1
         1 003414   200172 756100                    STQ     SQH$,,AUTO

      994    12436    6                                 IF DQH$->NI$DQH.IPCNUM = 0

  12436  1 003415   100020 236100                    LDQ     16,,PR1
         1 003416   000777 316007                    CANQ    511,DL
         1 003417   003511 601000 1                  TNZ     s:12462

      995    12437    6                                 THEN
      996    12438    6                                      IF SQH$ = ADDR(NIL)

  12438  1 003420   200172 236100                    LDQ     SQH$,,AUTO
         1 003421   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003422   003446 601000 1                  TNZ     s:12445

      997    12439    7                                      THEN DO ;

      998    12440    7                                           DQH$->NI$DQH.STATUS.DOWN = '1'B ;

  12440  1 003423   200000 236003                    LDQ     65536,DU
         1 003424   100001 256100                    ORSQ    1,,PR1

      999    12441    7                                           DQH$->NI$DQH.STATUS.MSOS_PART = '1'B ;

  12441  1 003425   200173 471500                    LDP1    DQH$,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:161  
         1 003426   001000 236003                    LDQ     512,DU
         1 003427   100001 256100                    ORSQ    1,,PR1

     1000    12442    7                                           K = DQH$->NI$DQH.FEX ;

  12442  1 003430   200173 471500                    LDP1    DQH$,,AUTO
         1 003431   100001 236100                    LDQ     1,,PR1
         1 003432   000006 772000                    QRL     6
         1 003433   000077 376007                    ANQ     63,DL
         1 003434   200007 756100                    STQ     K,,AUTO

     1001    12443    7                                           CALL KIQ$PARTFEP ( K, KIER_PART ) ;

  12443  1 003435   000047 236000 2                  LDQ     39
         1 003436   200263 756100                    STQ     DQH$+3,,AUTO
         1 003437   200007 633500                    EPPR3   K,,AUTO
         1 003440   200262 453500                    STP3    DQH$+2,,AUTO
         1 003441   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003442   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003443   000000 701000 xent               TSX1    KIQ$PARTFEP
         1 003444   000000 011000                    NOP     0

     1002    12444    7                                         END ;

  12444  1 003445   003511 710000 1                  TRA     s:12462

     1003    12445    6                                      ELSE IF MPC$ ~= ADDR(NIL)

  12445  1 003446   200176 236100                    LDQ     MPC$,,AUTO
         1 003447   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003450   003511 600000 1                  TZE     s:12462

     1004    12446    7                                           THEN MPC_PART: DO ;

  12446  1 003451                       MPC_PART     null
     1005    12447    7                                      DQH$->NI$DQH.STATUS.DOWN    = '1'B ;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:162  
  12447  1 003451   200000 236003                    LDQ     65536,DU
         1 003452   100001 256100                    ORSQ    1,,PR1

     1006    12448    7                                      DQH$->NI$DQH.STATUS.MSOS_PART = '1'B ;

  12448  1 003453   200173 471500                    LDP1    DQH$,,AUTO
         1 003454   001000 236003                    LDQ     512,DU
         1 003455   100001 256100                    ORSQ    1,,PR1

     1007    12449    8                                      DO J = 0 TO %N_CHANSPERMPCM1 ;

  12449  1 003456   200006 450100                    STZ     J,,AUTO

     1008    12450    8                                           K = MPC$->NI$DCT.MPC.IOCHANX(J) ;

  12450  1 003457   200176 470500                    LDP0    MPC$,,AUTO
         1 003460   200006 235100                    LDA     J,,AUTO
         1 003461   000100 101505                    MRL     fill='000'O
         1 003462   000031 000001                    ADSC9   25,A,PR0                 cn=0,n=1
         1 003463   200007 000004                    ADSC9   K,,AUTO                  cn=0,n=4

     1009    12451    8                                           DQH$ = NI$CHT$->NI$CHT.DQH$(K) ;

  12451  1 003464   200007 236100                    LDQ     K,,AUTO
         1 003465   000001 736000                    QLS     1
         1 003466   000000 471400 xsym               LDP1    NI$CHT$
         1 003467   100000 236106                    LDQ     0,QL,PR1
         1 003470   200173 756100                    STQ     DQH$,,AUTO

     1010    12452    8                                           IF K ~= 0

  12452  1 003471   200007 235100                    LDA     K,,AUTO
         1 003472   003501 600000 1                  TZE     s:12457
         1 003473   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003474   003501 600000 1                  TZE     s:12457
         1 003475   200173 473500                    LDP3    DQH$,,AUTO
         1 003476   300001 236100                    LDQ     1,,PR3
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:163  
         1 003477   200000 316003                    CANQ    65536,DU
         1 003500   003511 600000 1                  TZE     s:12462

     1011    12453    8                                                AND DQH$ ~= ADDR(NIL)
     1012    12454    8                                                AND NOT DQH$->NI$DQH.STATUS.DOWN
     1013    12455    8                                           THEN
     1014    12456    8                                                EXIT MPC_PART ;
     1015    12457    8                                         END ;

  12457  1 003501   200006 054100                    AOS     J,,AUTO
         1 003502   200006 236100                    LDQ     J,,AUTO
         1 003503   000017 116007                    CMPQ    15,DL
         1 003504   003457 604400 1                  TMOZ    s:12450

     1016    12458    7                                      MPC$->NI$DCT.STATUS.DOWN    = '1'B ;

  12458  1 003505   400000 236003                    LDQ     -131072,DU
         1 003506   000027 256100                    ORSQ    23,,PR0

     1017    12459    7                                      MPC$->NI$DCT.STATUS.MSOS_PART = '1'B ;

  12459  1 003507   002000 236003                    LDQ     1024,DU
         1 003510   000027 256100                    ORSQ    23,,PR0

     1018    12460    7                                    END MPC_PART ;

     1019    12461    6                               END ;

     1020    12462    5                          END ;

  12462  1 003511   200245 054100                    AOS     CHAN,,AUTO
         1 003512   200245 235100                    LDA     CHAN,,AUTO
         1 003513   000177 115007                    CMPA    127,DL
         1 003514   003375 604400 1                  TMOZ    s:12430

     1021    12463    4                     END ;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:164  
     1022    12464    3                END ;

  12464  1 003515   200005 054100                    AOS     I,,AUTO
         1 003516   200005 236100                    LDQ     I,,AUTO
         1 003517   000000 116000 xsym               CMPQ    NI_IOMS
         1 003520   003253 604000 1                  TMI     s:12409

     1023    12465    2             CALL ITK$TMB$BUF_DEALLOC (BUF$, BUFX);

  12465  1 003521   200247 630500                    EPPR0   BUFX,,AUTO
         1 003522   200263 450500                    STP0    DQH$+3,,AUTO
         1 003523   200246 631500                    EPPR1   BUF$,,AUTO
         1 003524   200262 451500                    STP1    DQH$+2,,AUTO
         1 003525   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 003526   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003527   000000 701000 xent               TSX1    ITK$TMB$BUF_DEALLOC
         1 003530   000000 011000                    NOP     0

     1024    12466    3             DO I = 1 TO NK_MXLOCAL ;

  12466  1 003531   000001 235007                    LDA     1,DL
         1 003532   200005 755100                    STA     I,,AUTO
         1 003533   003760 710000 1                  TRA     s:12496+1

     1025    12467    3                  DCT$ = N$DCT$$->N$DCT$(I) ;

  12467  1 003534   000000 470400 xsym               LDP0    N$DCT$$
         1 003535   200005 720100                    LXL0    I,,AUTO
         1 003536   000000 236110                    LDQ     0,X0,PR0
         1 003537   200175 756100                    STQ     DCT$,,AUTO

     1026    12468    3                  IF DCT$->NI$DCT.TYPE = %DV_MPC

  12468  1 003540   200175 471500                    LDP1    DCT$,,AUTO
         1 003541   100007 236100                    LDQ     7,,PR1
         1 003542   007700 376007                    ANQ     4032,DL
         1 003543   000700 116007                    CMPQ    448,DL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:165  
         1 003544   003757 601000 1                  TNZ     s:12496

     1027    12469    4                  THEN DEV_PART: DO ;

  12469  1 003545                       DEV_PART     null
     1028    12470    4                       SQH$ = DCT$->NI$DCT.SQH$ ;

  12470  1 003545   100022 236100                    LDQ     18,,PR1
         1 003546   200172 756100                    STQ     SQH$,,AUTO

     1029    12471    5                       DO J = 0 TO %N_MPCSPERSQHM1 ;

  12471  1 003547   200006 450100                    STZ     J,,AUTO

     1030    12472    5                            MPC$ = SQH$->NI$SQH.MPC$(J) ;

  12472  1 003550   200172 470500                    LDP0    SQH$,,AUTO
         1 003551   200006 720100                    LXL0    J,,AUTO
         1 003552   000005 236110                    LDQ     5,X0,PR0
         1 003553   200176 756100                    STQ     MPC$,,AUTO

     1031    12473    5                            IF MPC$ ~= ADDR(NIL)

  12473  1 003554   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 003555   003723 600000 1                  TZE     s:12489

     1032    12474    6                            THEN DO ;

     1033    12475    7                                 DO SELECT ( MPC$->NI$DCT.DVT$->NI$DVT.MODEL(MPC$->
             12475                                          NI$DCT.MODX) ) ;

  12475  1 003556   200176 471500                    LDP1    MPC$,,AUTO
         1 003557   100024 473500                    LDP3    20,,PR1
         1 003560   100007 236100                    LDQ     7,,PR1
         1 003561   000021 772000                    QRL     17
         1 003562   000176 376007                    ANQ     126,DL
         1 003563   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:166  
         1 003564   000002 736000                    QLS     2
         1 003565   040000 106506                    CMPC    fill='040'O
         1 003566   300003 000010                    ADSC9   3,Q,PR3                  cn=0,n=8
         1 003567   000123 000007 0                  ADSC9   NI_ENTADDR+10            cn=0,n=7
         1 003570   003654 602000 1                  TNC     s:12475+62
         1 003571   000000 635011                    EAA     0,X1
         1 003572   000020 771000                    ARL     16
         1 003573   040000 106505                    CMPC    fill='040'O
         1 003574   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003575   000123 000007 0                  ADSC9   NI_ENTADDR+10            cn=0,n=7
         1 003576   003706 600000 1                  TZE     s:12477
         1 003577   000000 635011                    EAA     0,X1
         1 003600   000020 771000                    ARL     16
         1 003601   040000 106505                    CMPC    fill='040'O
         1 003602   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003603   000125 000007 0                  ADSC9   NI_ENTADDR+12            cn=0,n=7
         1 003604   003645 602000 1                  TNC     s:12475+55
         1 003605   000000 635011                    EAA     0,X1
         1 003606   000020 771000                    ARL     16
         1 003607   040000 106505                    CMPC    fill='040'O
         1 003610   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003611   000125 000007 0                  ADSC9   NI_ENTADDR+12            cn=0,n=7
         1 003612   003711 600000 1                  TZE     s:12479
         1 003613   000000 635011                    EAA     0,X1
         1 003614   000020 771000                    ARL     16
         1 003615   040000 106505                    CMPC    fill='040'O
         1 003616   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003617   000127 000007 0                  ADSC9   NI_ENTADDR+14            cn=0,n=7
         1 003620   003636 602000 1                  TNC     s:12475+48
         1 003621   000000 635011                    EAA     0,X1
         1 003622   000020 771000                    ARL     16
         1 003623   040000 106505                    CMPC    fill='040'O
         1 003624   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003625   000127 000007 0                  ADSC9   NI_ENTADDR+14            cn=0,n=7
         1 003626   003714 600000 1                  TZE     s:12481
         1 003627   000000 635011                    EAA     0,X1
         1 003630   000020 771000                    ARL     16
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:167  
         1 003631   040000 106505                    CMPC    fill='040'O
         1 003632   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003633   000131 000007 0                  ADSC9   NI_ENTADDR+16            cn=0,n=7
         1 003634   003721 601000 1                  TNZ     s:12485
         1 003635   003717 710000 1                  TRA     s:12483
         1 003636   000000 635011                    EAA     0,X1
         1 003637   000020 771000                    ARL     16
         1 003640   040000 106505                    CMPC    fill='040'O
         1 003641   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003642   000133 000007 0                  ADSC9   NI_ENTADDR+18            cn=0,n=7
         1 003643   003721 601000 1                  TNZ     s:12485
         1 003644   003711 710000 1                  TRA     s:12479
         1 003645   000000 635011                    EAA     0,X1
         1 003646   000020 771000                    ARL     16
         1 003647   040000 106505                    CMPC    fill='040'O
         1 003650   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003651   000135 000007 0                  ADSC9   NI_ENTADDR+20            cn=0,n=7
         1 003652   003721 601000 1                  TNZ     s:12485
         1 003653   003711 710000 1                  TRA     s:12479
         1 003654   000000 635011                    EAA     0,X1
         1 003655   000020 771000                    ARL     16
         1 003656   040000 106505                    CMPC    fill='040'O
         1 003657   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003660   000137 000007 0                  ADSC9   NI_ENTADDR+22            cn=0,n=7
         1 003661   003677 602000 1                  TNC     s:12475+81
         1 003662   000000 635011                    EAA     0,X1
         1 003663   000020 771000                    ARL     16
         1 003664   040000 106505                    CMPC    fill='040'O
         1 003665   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003666   000137 000007 0                  ADSC9   NI_ENTADDR+22            cn=0,n=7
         1 003667   003706 600000 1                  TZE     s:12477
         1 003670   000000 635011                    EAA     0,X1
         1 003671   000020 771000                    ARL     16
         1 003672   040000 106505                    CMPC    fill='040'O
         1 003673   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003674   000141 000007 0                  ADSC9   NI_ENTADDR+24            cn=0,n=7
         1 003675   003721 601000 1                  TNZ     s:12485
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:168  
         1 003676   003706 710000 1                  TRA     s:12477
         1 003677   000000 635011                    EAA     0,X1
         1 003700   000020 771000                    ARL     16
         1 003701   040000 106505                    CMPC    fill='040'O
         1 003702   300003 000010                    ADSC9   3,A,PR3                  cn=0,n=8
         1 003703   000143 000007 0                  ADSC9   NI_ENTADDR+26            cn=0,n=7
         1 003704   003721 601000 1                  TNZ     s:12485
         1 003705   003706 710000 1                  TRA     s:12477

     1034    12476    7                                      SELECT ( 'MSP3882', 'MSP3886', 'MSP3991',
             12476                                               'MSP3992' ) ;

     1035    12477    7                                      MPC$->NI$DCT.MPC.FWNAME = 'IFDK' ;

  12477  1 003706   000145 236000 0                  LDQ     NI_ENTADDR+28
         1 003707   100041 756100                    STQ     33,,PR1
         1 003710   003721 710000 1                  TRA     s:12485

     1036    12478    7                                      SELECT ( 'MTP8225', 'MTP8226', 'MTP8228' ) ;

     1037    12479    7                                      MPC$->NI$DCT.MPC.FWNAME = 'IFTP' ;

  12479  1 003711   000146 236000 0                  LDQ     NI_ENTADDR+29
         1 003712   100041 756100                    STQ     33,,PR1
         1 003713   003721 710000 1                  TRA     s:12485

     1038    12480    7                                      SELECT ( 'URP8600' ) ;

     1039    12481    7                                      MPC$->NI$DCT.MPC.FWNAME = 'ICRD' ;

  12481  1 003714   000147 236000 0                  LDQ     NI_ENTADDR+30
         1 003715   100041 756100                    STQ     33,,PR1
         1 003716   003721 710000 1                  TRA     s:12485

     1040    12482    7                                      SELECT ( 'URP8601' ) ;

     1041    12483    7                                      MPC$->NI$DCT.MPC.FWNAME = 'IPR5' ;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:169  

  12483  1 003717   000150 236000 0                  LDQ     NI_ENTADDR+31
         1 003720   100041 756100                    STQ     33,,PR1

     1042    12484    7                                    END ;

     1043    12485    6                                 IF NOT MPC$->NI$DCT.STATUS.DOWN

  12485  1 003721   100027 234100                    SZN     23,,PR1
         1 003722   003757 605000 1                  TPL     s:12496

     1044    12486    6                                 THEN
     1045    12487    6                                      EXIT DEV_PART ;
     1046    12488    6                               END ;

     1047    12489    5                          END ;

  12489  1 003723   200006 054100                    AOS     J,,AUTO
         1 003724   200006 235100                    LDA     J,,AUTO
         1 003725   000001 115007                    CMPA    1,DL
         1 003726   003550 604400 1                  TMOZ    s:12472

     1048    12490    5                      DO J = SQH$->NI$SQH.FDCT TO (SQH$->NI$SQH.FDCT+SQH$->NI$SQH.NDCT
             12490                                -1) ;

  12490  1 003727   000002 236100                    LDQ     2,,PR0
         1 003730   000022 772000                    QRL     18
         1 003731   200006 756100                    STQ     J,,AUTO
         1 003732   003745 710000 1                  TRA     s:12494+1

     1049    12491    5                            DCT$ = N$DCT$$->N$DCT$(J) ;

  12491  1 003733   000000 470400 xsym               LDP0    N$DCT$$
         1 003734   200006 720100                    LXL0    J,,AUTO
         1 003735   000000 236110                    LDQ     0,X0,PR0
         1 003736   200175 756100                    STQ     DCT$,,AUTO

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:170  
     1050    12492    5                            DCT$->NI$DCT.STATUS.DOWN  = '1'B ;

  12492  1 003737   200175 471500                    LDP1    DCT$,,AUTO
         1 003740   400000 236003                    LDQ     -131072,DU
         1 003741   100027 256100                    ORSQ    23,,PR1

     1051    12493    5                            DCT$->NI$DCT.STATUS.MSOS_PART = '1'B ;

  12493  1 003742   002000 236003                    LDQ     1024,DU
         1 003743   100027 256100                    ORSQ    23,,PR1

     1052    12494    5                          END ;

  12494  1 003744   200006 054100                    AOS     J,,AUTO
         1 003745   200172 470500                    LDP0    SQH$,,AUTO
         1 003746   000002 236100                    LDQ     2,,PR0
         1 003747   777777 376007                    ANQ     -1,DL
         1 003750   200262 756100                    STQ     DQH$+2,,AUTO
         1 003751   000002 236100                    LDQ     2,,PR0
         1 003752   000022 772000                    QRL     18
         1 003753   200262 036100                    ADLQ    DQH$+2,,AUTO
         1 003754   003733 604000 1                  TMI     s:12491
         1 003755   200006 116100                    CMPQ    J,,AUTO
         1 003756   003733 605400 1                  TPNZ    s:12491

     1053    12495    4                     END DEV_PART ;

     1054    12496    3                END ;

  12496  1 003757   200005 054100                    AOS     I,,AUTO
         1 003760   200005 236100                    LDQ     I,,AUTO
         1 003761   000000 116000 xsym               CMPQ    NK_MXLOCAL
         1 003762   003534 604400 1                  TMOZ    s:12467

     1055    12497    2           END ;

     1056    12498    1        I = 1;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:171  

  12498  1 003763   000001 235007                    LDA     1,DL
         1 003764   200005 755100                    STA     I,,AUTO

     1057    12499    2        DO WHILE (N$DCT$$ -> N$DCT$(I) ~= ADDR(NIL));

  12499  1 003765   004533 710000 1                  TRA     s:12643

     1058    12500        /**/
     1059    12501    2   NEXTFWDEV:
     1060    12502    2             DEV$ = N$DCT$$ -> N$DCT$(I);

  12502  1 003766   000000 470400 xsym  NEXTFWDEV    LDP0    N$DCT$$
         1 003767   200005 720100                    LXL0    I,,AUTO
         1 003770   000000 236110                    LDQ     0,X0,PR0
         1 003771   200174 756100                    STQ     DEV$,,AUTO

     1061    12503    3             IF (DEV$ -> NI$DCT.TYPE = %DV_MPC) THEN DO;

  12503  1 003772   200174 471500                    LDP1    DEV$,,AUTO
         1 003773   100007 236100                    LDQ     7,,PR1
         1 003774   007700 376007                    ANQ     4032,DL
         1 003775   000700 116007                    CMPQ    448,DL
         1 003776   004532 601000 1                  TNZ     FWNONE

     1062    12504        /**/
     1063    12505        /*
     1064    12506           ***  Get the specified  firmware from the disk -
     1065    12507                and load the MPCs.
     1066    12508        */
     1067    12509        /**/
     1068    12510    3                  IF NOT HW_LOAD_FW OR DEV$->NI$DCT.CTYP = %C_IPC THEN

  12510  1 003777   000000 234000 xsym               SZN     HW_LOAD_FW
         1 004000   004434 605000 1                  TPL     SKIP_FW
         1 004001   100007 236100                    LDQ     7,,PR1
         1 004002   070000 376003                    ANQ     28672,DU
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:172  
         1 004003   020000 116003                    CMPQ    8192,DU
         1 004004   004434 600000 1                  TZE     SKIP_FW

     1069    12511    3                       GOTO SKIP_FW;
     1070    12512
     1071    12513    4                  DO J = 0 TO FWSLOTS;     /* LOOK FOR FW IN TABLE               */

  12513  1 004005   200006 450100                    STZ     J,,AUTO
         1 004006   004070 710000 1                  TRA     s:12527+1

     1072    12514    5                       IF (FW.NAME(J) = DEV$ -> NI$DCT.MPC.FWNAME) THEN DO;

  12514  1 004007   200174 470500                    LDP0    DEV$,,AUTO
         1 004010   200006 235100                    LDA     J,,AUTO
         1 004011   000002 735000                    ALS     2
         1 004012   200051 236105                    LDQ     FW+3,AL,AUTO
         1 004013   000041 116100                    CMPQ    33,,PR0
         1 004014   004067 601000 1                  TNZ     s:12527

     1073    12515    5                            FWDA = FW.DA(J);

  12515  1 004015   200047 235105                    LDA     FW+1,AL,AUTO
         1 004016   200043 755100                    STA     FWDA,,AUTO

     1074    12516    5                            FWSIZE = FW.CS0SIZE(J) + FW.MM0SIZE(J);

  12516  1 004017   200006 236100                    LDQ     J,,AUTO
         1 004020   000002 736000                    QLS     2
         1 004021   200050 236106                    LDQ     FW+2,QL,AUTO
         1 004022   777777 376007                    ANQ     -1,DL
         1 004023   200262 756100                    STQ     DQH$+2,,AUTO
         1 004024   200006 235100                    LDA     J,,AUTO
         1 004025   000002 735000                    ALS     2
         1 004026   200050 236105                    LDQ     FW+2,AL,AUTO
         1 004027   000022 772000                    QRL     18
         1 004030   200262 036100                    ADLQ    DQH$+2,,AUTO
         1 004031   200044 756100                    STQ     FWSIZE,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:173  

     1075    12517    5                            NI$FW = '0'B;

  12517  1 004032   000000 471400 xsym               LDP1    B$DS1$
         1 004033   000100 100400                    MLR     fill='000'O
         1 004034   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 004035   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

     1076    12518    5                            NI$FW.FWDA = FW.DA(J);

  12518  1 004036   200006 235100                    LDA     J,,AUTO
         1 004037   000002 735000                    ALS     2
         1 004040   000000 471400 xsym               LDP1    B$DS1$
         1 004041   200047 235105                    LDA     FW+1,AL,AUTO
         1 004042   100000 755100                    STA     0,,PR1

     1077    12519    5                            NI$FW.FWOL(0) = FW.CS0SIZE(J);

  12519  1 004043   200006 235100                    LDA     J,,AUTO
         1 004044   000002 735000                    ALS     2
         1 004045   200050 220105                    LDX0    FW+2,AL,AUTO
         1 004046   000000 471400 xsym               LDP1    B$DS1$
         1 004047   100003 740100                    STX0    3,,PR1

     1078    12520    5                            NI$FW.FWOL(1) = FW.MM0SIZE(J);

  12520  1 004050   200006 235100                    LDA     J,,AUTO
         1 004051   000002 735000                    ALS     2
         1 004052   200050 721105                    LXL1    FW+2,AL,AUTO
         1 004053   100003 441100                    SXL1    3,,PR1

     1079    12521    5                            REQ$ = ADDR(NI$FW.FW);

  12521  1 004054   000000 236000 xsym               LDQ     B$DS1$
         1 004055   000013 036003                    ADLQ    11,DU
         1 004056   200171 756100                    STQ     REQ$,,AUTO

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:174  
     1080    12522    5                            CALL FW_MOVE ALTRET(DISK_ERR);

  12522  1 004057   006754 701000 1                  TSX1    FW_MOVE
         1 004060   006715 702000 1                  TSX2    DISK_ERR

     1081    12523    5                            DEV$ -> NI$DCT.MPC.FW$ = B$DS1$;

  12523  1 004061   000000 236000 xsym               LDQ     B$DS1$
         1 004062   200174 470500                    LDP0    DEV$,,AUTO
         1 004063   000030 756100                    STQ     24,,PR0

     1082    12524    5                            CUR_FWSLOT = J;

  12524  1 004064   200006 235100                    LDA     J,,AUTO
         1 004065   200020 755100                    STA     CUR_FWSLOT,,AUTO

     1083    12525    5                            GOTO GOTFW;

  12525  1 004066   004121 710000 1                  TRA     GOTFW

     1084    12526    5                          END;
     1085    12527    4                     END;

  12527  1 004067   200006 054100                    AOS     J,,AUTO
         1 004070   200006 236100                    LDQ     J,,AUTO
         1 004071   200045 116100                    CMPQ    FWSLOTS,,AUTO
         1 004072   004007 604400 1                  TMOZ    s:12514

     1086    12528    3                  IF DEV$->NI$DCT.MPC.FWNAME = 'NONE' THEN

  12528  1 004073   200174 470500                    LDP0    DEV$,,AUTO
         1 004074   000041 236100                    LDQ     33,,PR0
         1 004075   000116 116000 0                  CMPQ    NI_ENTADDR+5
         1 004076   004532 600000 1                  TZE     FWNONE

     1087    12529    3                       GOTO FWNONE;
     1088    12530    3                  SUB_BUF.COUNT = SIZEC(NI$DCT.MPC.FWNAME);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:175  

  12530  1 004077   004000 236003                    LDQ     2048,DU
         1 004100   200166 552140                    STBQ    SUB_BUF,'40'O,AUTO

     1089    12531    3                  SUB_BUF.TEXT = DEV$ -> NI$DCT.MPC.FWNAME;

  12531  1 004101   040100 100500                    MLR     fill='040'O
         1 004102   000041 000004                    ADSC9   33,,PR0                  cn=0,n=4
         1 004103   200166 200013                    ADSC9   SUB_BUF,,AUTO            cn=1,n=11

     1090    12532    3                  CALL ITE$ERROR (%E$CANTFINDFW,ADDR(SUB_BUF));

  12532  1 004104   200166 631500                    EPPR1   SUB_BUF,,AUTO
         1 004105   200262 451500                    STP1    DQH$+2,,AUTO
         1 004106   200262 633500                    EPPR3   DQH$+2,,AUTO
         1 004107   200265 453500                    STP3    DQH$+5,,AUTO
         1 004110   000051 236000 2                  LDQ     41
         1 004111   200264 756100                    STQ     DQH$+4,,AUTO
         1 004112   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 004113   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004114   000000 701000 xent               TSX1    ITE$ERROR
         1 004115   000000 011000                    NOP     0

     1091    12533    3                  CALL ITF$FREEZE;

  12533  1 004116   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004117   000000 701000 xent               TSX1    ITF$FREEZE
         1 004120   000000 011000                    NOP     0

     1092    12534        /**/
     1093    12535        /*
     1094    12536           ***  Got the FW. If this is the system disk MPC and a tape BOOT
     1095    12537                then put the FW in the TIGR data area in case of disaster.
     1096    12538        */
     1097    12539        /**/
     1098    12540    3   GOTFW:
     1099    12541        /**/
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:176  
     1100    12542        /*
     1101    12543           ***  If this is a UNIT record MPC then get the two FW overlays.
     1102    12544        */
     1103    12545        /**/
     1104    12546    4                  IF (DEV$ -> NI$DCT.MPC.TYPE = %DV_LP) THEN DO;

  12546  1 004121   200174 470500       GOTFW        LDP0    DEV$,,AUTO
         1 004122   000035 236100                    LDQ     29,,PR0
         1 004123   777000 376003                    ANQ     -512,DU
         1 004124   003000 116003                    CMPQ    1536,DU
         1 004125   004434 601000 1                  TNZ     SKIP_FW

     1105    12547    4   NEXTLPFW:
     1106    12548    5                       DO J = 0 TO FWSLOTS;

  12548  1 004126   200006 450100       NEXTLPFW     STZ     J,,AUTO
         1 004127   004162 710000 1                  TRA     s:12557+1

     1107    12549    6                            IF (FW.NAME(J) = DEV$ -> NI$DCT.MPC.LPNAME) THEN DO;

  12549  1 004130   200174 470500                    LDP0    DEV$,,AUTO
         1 004131   200006 235100                    LDA     J,,AUTO
         1 004132   000002 735000                    ALS     2
         1 004133   200051 236105                    LDQ     FW+3,AL,AUTO
         1 004134   000042 116100                    CMPQ    34,,PR0
         1 004135   004161 601000 1                  TNZ     s:12557

     1108    12550    6                                 FWDA = FW.DA(J);

  12550  1 004136   200047 235105                    LDA     FW+1,AL,AUTO
         1 004137   200043 755100                    STA     FWDA,,AUTO

     1109    12551    6                                 FWSIZE = FW.CS0SIZE(J);

  12551  1 004140   200006 236100                    LDQ     J,,AUTO
         1 004141   000002 736000                    QLS     2
         1 004142   200050 236106                    LDQ     FW+2,QL,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:177  
         1 004143   000022 772000                    QRL     18
         1 004144   200044 756100                    STQ     FWSIZE,,AUTO

     1110    12552    6                                 NI$FW.LPDA = FW.DA(J);

  12552  1 004145   200006 235100                    LDA     J,,AUTO
         1 004146   000002 735000                    ALS     2
         1 004147   000000 471400 xsym               LDP1    B$DS1$
         1 004150   200047 235105                    LDA     FW+1,AL,AUTO
         1 004151   100001 755100                    STA     1,,PR1

     1111    12553    6                                 NI$FW.FWOL(2) = FW.CS0SIZE(J);

  12553  1 004152   200006 235100                    LDA     J,,AUTO
         1 004153   000002 735000                    ALS     2
         1 004154   200050 220105                    LDX0    FW+2,AL,AUTO
         1 004155   100004 740100                    STX0    4,,PR1

     1112    12554    6                                 CALL FW_MOVE ALTRET (DISK_ERR);

  12554  1 004156   006754 701000 1                  TSX1    FW_MOVE
         1 004157   006715 702000 1                  TSX2    DISK_ERR

     1113    12555    6                                 GOTO NEXTCRPFW;

  12555  1 004160   004207 710000 1                  TRA     NEXTCRPFW

     1114    12556    6                               END;
     1115    12557    5                          END;

  12557  1 004161   200006 054100                    AOS     J,,AUTO
         1 004162   200006 236100                    LDQ     J,,AUTO
         1 004163   200045 116100                    CMPQ    FWSLOTS,,AUTO
         1 004164   004130 604400 1                  TMOZ    s:12549

     1116    12558        /**/
     1117    12559    4                       SUB_BUF.COUNT = SIZEC(NI$DCT.MPC.LPNAME);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:178  

  12559  1 004165   004000 236003                    LDQ     2048,DU
         1 004166   200166 552140                    STBQ    SUB_BUF,'40'O,AUTO

     1118    12560    4                       SUB_BUF.TEXT = DEV$ -> NI$DCT.MPC.LPNAME;

  12560  1 004167   040100 100500                    MLR     fill='040'O
         1 004170   000042 000004                    ADSC9   34,,PR0                  cn=0,n=4
         1 004171   200166 200013                    ADSC9   SUB_BUF,,AUTO            cn=1,n=11

     1119    12561    4                       CALL ITE$ERROR(%E$CANTFINDFW,ADDR(SUB_BUF));

  12561  1 004172   200166 631500                    EPPR1   SUB_BUF,,AUTO
         1 004173   200262 451500                    STP1    DQH$+2,,AUTO
         1 004174   200262 633500                    EPPR3   DQH$+2,,AUTO
         1 004175   200265 453500                    STP3    DQH$+5,,AUTO
         1 004176   000051 236000 2                  LDQ     41
         1 004177   200264 756100                    STQ     DQH$+4,,AUTO
         1 004200   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 004201   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004202   000000 701000 xent               TSX1    ITE$ERROR
         1 004203   000000 011000                    NOP     0

     1120    12562    4                       CALL ITF$FREEZE;

  12562  1 004204   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004205   000000 701000 xent               TSX1    ITF$FREEZE
         1 004206   000000 011000                    NOP     0

     1121    12563        /**/
     1122    12564    4   NEXTCRPFW:
     1123    12565    5                       DO J = 0 TO FWSLOTS;

  12565  1 004207   200006 450100       NEXTCRPFW    STZ     J,,AUTO
         1 004210   004243 710000 1                  TRA     s:12574+1

     1124    12566    6                            IF (FW.NAME(J) = DEV$ -> NI$DCT.MPC.CRPNAME) THEN DO;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:179  

  12566  1 004211   200174 470500                    LDP0    DEV$,,AUTO
         1 004212   200006 235100                    LDA     J,,AUTO
         1 004213   000002 735000                    ALS     2
         1 004214   200051 236105                    LDQ     FW+3,AL,AUTO
         1 004215   000043 116100                    CMPQ    35,,PR0
         1 004216   004242 601000 1                  TNZ     s:12574

     1125    12567    6                                 FWDA = FW.DA(J);

  12567  1 004217   200047 235105                    LDA     FW+1,AL,AUTO
         1 004220   200043 755100                    STA     FWDA,,AUTO

     1126    12568    6                                 FWSIZE = FW.CS0SIZE(J);

  12568  1 004221   200006 236100                    LDQ     J,,AUTO
         1 004222   000002 736000                    QLS     2
         1 004223   200050 236106                    LDQ     FW+2,QL,AUTO
         1 004224   000022 772000                    QRL     18
         1 004225   200044 756100                    STQ     FWSIZE,,AUTO

     1127    12569    6                                 NI$FW.CRPDA = FW.DA(J);

  12569  1 004226   200006 235100                    LDA     J,,AUTO
         1 004227   000002 735000                    ALS     2
         1 004230   000000 471400 xsym               LDP1    B$DS1$
         1 004231   200047 235105                    LDA     FW+1,AL,AUTO
         1 004232   100002 755100                    STA     2,,PR1

     1128    12570    6                                 NI$FW.FWOL(3) = FW.CS0SIZE(J);

  12570  1 004233   200006 235100                    LDA     J,,AUTO
         1 004234   000002 735000                    ALS     2
         1 004235   200050 220105                    LDX0    FW+2,AL,AUTO
         1 004236   100004 440100                    SXL0    4,,PR1

     1129    12571    6                                 CALL FW_MOVE ALTRET (DISK_ERR);
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:180  

  12571  1 004237   006754 701000 1                  TSX1    FW_MOVE
         1 004240   006715 702000 1                  TSX2    DISK_ERR

     1130    12572    6                                 GOTO GOTCRPFW;

  12572  1 004241   004271 710000 1                  TRA     GOTCRPFW

     1131    12573    6                               END;
     1132    12574    5                          END;

  12574  1 004242   200006 054100                    AOS     J,,AUTO
         1 004243   200006 236100                    LDQ     J,,AUTO
         1 004244   200045 116100                    CMPQ    FWSLOTS,,AUTO
         1 004245   004211 604400 1                  TMOZ    s:12566

     1133    12575        /**/
     1134    12576    4                       SUB_BUF.COUNT = SIZEC(NI$DCT.MPC.CRPNAME);

  12576  1 004246   004000 236003                    LDQ     2048,DU
         1 004247   200166 552140                    STBQ    SUB_BUF,'40'O,AUTO

     1135    12577    4                       SUB_BUF.TEXT = DEV$ -> NI$DCT.MPC.CRPNAME;

  12577  1 004250   200174 470500                    LDP0    DEV$,,AUTO
         1 004251   040100 100500                    MLR     fill='040'O
         1 004252   000043 000004                    ADSC9   35,,PR0                  cn=0,n=4
         1 004253   200166 200013                    ADSC9   SUB_BUF,,AUTO            cn=1,n=11

     1136    12578    4                       CALL ITE$ERROR(%E$CANTFINDFW,ADDR(SUB_BUF));

  12578  1 004254   200166 631500                    EPPR1   SUB_BUF,,AUTO
         1 004255   200262 451500                    STP1    DQH$+2,,AUTO
         1 004256   200262 633500                    EPPR3   DQH$+2,,AUTO
         1 004257   200265 453500                    STP3    DQH$+5,,AUTO
         1 004260   000051 236000 2                  LDQ     41
         1 004261   200264 756100                    STQ     DQH$+4,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:181  
         1 004262   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 004263   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004264   000000 701000 xent               TSX1    ITE$ERROR
         1 004265   000000 011000                    NOP     0

     1137    12579    4                       CALL ITF$FREEZE;

  12579  1 004266   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004267   000000 701000 xent               TSX1    ITF$FREEZE
         1 004270   000000 011000                    NOP     0

     1138    12580        /**/
     1139    12581        /*
     1140    12582           ***  Now we have the UNIT record FW ready to go except the first
     1141    12583                of the two overlays has to have bits set to indicate which
     1142    12584                channels have what sorts of devices on them.
     1143    12585        */
     1144    12586        /**/
     1145    12587    4   GOTCRPFW:
     1146    12588    4                       BASE_CHAN = DEV$ -> NI$DCT.MPC.IOCHAN.CHAN(0);

  12588  1 004271   200174 470500       GOTCRPFW     LDP0    DEV$,,AUTO
         1 004272   000031 236100                    LDQ     25,,PR0
         1 004273   000033 772000                    QRL     27
         1 004274   000177 376007                    ANQ     127,DL
         1 004275   200026 756100                    STQ     BASE_CHAN,,AUTO

     1147    12589    4                       LP_WORD = 0;

  12589  1 004276   200030 450100                    STZ     LP_WORD,,AUTO

     1148    12590    4                       CRCP_WORD = 0;

  12590  1 004277   200031 450100                    STZ     CRCP_WORD,,AUTO

     1149    12591    4                       IF DEV$ -> NI$DCT.MPC.FWNAME = 'UCMN'

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:182  
  12591  1 004300   000041 236100                    LDQ     33,,PR0
         1 004301   000151 116000 0                  CMPQ    NI_ENTADDR+32
         1 004302   004306 601000 1                  TNZ     s:12593

     1150    12592    4                       THEN OFFSET = 1;

  12592  1 004303   000001 235007                    LDA     1,DL
         1 004304   200023 755100                    STA     OFFSET,,AUTO
         1 004305   004310 710000 1                  TRA     s:12595

     1151    12593    4                       ELSE OFFSET = 5;

  12593  1 004306   000005 235007                    LDA     5,DL
         1 004307   200023 755100                    STA     OFFSET,,AUTO

     1152    12594        /**/
     1153    12595    5                       DO J = 1 TO DEV$ -> NI$DCT.SQH$ -> NI$SQH.NDCT - 1;

  12595  1 004310   000001 235007                    LDA     1,DL
         1 004311   200006 755100                    STA     J,,AUTO
         1 004312   004354 710000 1                  TRA     s:12601+1

     1154    12596    5                            USER$ = N$DCT$$ -> N$DCT$(I+J);

  12596  1 004313   200005 236100                    LDQ     I,,AUTO
         1 004314   200006 036100                    ADLQ    J,,AUTO
         1 004315   000000 470400 xsym               LDP0    N$DCT$$
         1 004316   000000 236106                    LDQ     0,QL,PR0
         1 004317   200177 756100                    STQ     USER$,,AUTO

     1155    12597    5                            DEV_CHAN = USER$ -> NI$DCT.DQH$ -> NI$DQH.IOCHAN.CHANNEL;

  12597  1 004320   200177 471500                    LDP1    USER$,,AUTO
         1 004321   100023 473500                    LDP3    19,,PR1
         1 004322   300001 236100                    LDQ     1,,PR3
         1 004323   000022 772000                    QRL     18
         1 004324   000177 376007                    ANQ     127,DL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:183  
         1 004325   200027 756100                    STQ     DEV_CHAN,,AUTO

     1156    12598    5                            IF (USER$ -> NI$DCT.TYPE = %DV_LP) THEN

  12598  1 004326   100007 236100                    LDQ     7,,PR1
         1 004327   007700 376007                    ANQ     4032,DL
         1 004330   000300 116007                    CMPQ    192,DL
         1 004331   004343 601000 1                  TNZ     s:12600

     1157    12599    5                                 LP_WORD_BITS(DEV_CHAN - BASE_CHAN + OFFSET) = %YES#;

  12599  1 004332   200027 236100                    LDQ     DEV_CHAN,,AUTO
         1 004333   200026 136100                    SBLQ    BASE_CHAN,,AUTO
         1 004334   200023 036100                    ADLQ    OFFSET,,AUTO
         1 004335   004337 605000 1                  TPL     s:12599+5
         1 004336   000044 036003                    ADLQ    36,DU
         1 004337   003106 060400                    CSL     bolr='003'O
         1 004340   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 004341   200030 000001                    BDSC    LP_WORD,Q,AUTO           by=0,bit=0,n=1
         1 004342   004353 710000 1                  TRA     s:12601

     1158    12600    5                           ELSE CRCP_WORD_BITS(DEV_CHAN - BASE_CHAN + OFFSET) = %YES#;

  12600  1 004343   200027 236100                    LDQ     DEV_CHAN,,AUTO
         1 004344   200026 136100                    SBLQ    BASE_CHAN,,AUTO
         1 004345   200023 036100                    ADLQ    OFFSET,,AUTO
         1 004346   004350 605000 1                  TPL     s:12600+5
         1 004347   000044 036003                    ADLQ    36,DU
         1 004350   003106 060400                    CSL     bolr='003'O
         1 004351   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 004352   200031 000001                    BDSC    CRCP_WORD,Q,AUTO         by=0,bit=0,n=1

     1159    12601    5                          END;

  12601  1 004353   200006 054100                    AOS     J,,AUTO
         1 004354   200174 470500                    LDP0    DEV$,,AUTO
         1 004355   000022 471500                    LDP1    18,,PR0
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:184  
         1 004356   100002 236100                    LDQ     2,,PR1
         1 004357   777777 376007                    ANQ     -1,DL
         1 004360   200006 116100                    CMPQ    J,,AUTO
         1 004361   004313 605400 1                  TPNZ    s:12596

     1160    12602        /**/
     1161    12603    4                       DEV$ -> NI$DCT.MPC.LPCHANS = BINBIT(LP_WORD,36);

  12603  1 004362   200030 236100                    LDQ     LP_WORD,,AUTO
         1 004363   000011 772000                    QRL     9
         1 004364   000035 552120                    STBQ    29,'20'O,PR0

     1162    12604    4                       DEV$ -> NI$DCT.MPC.CRPCHANS = BINBIT(CRCP_WORD,36);

  12604  1 004365   200031 236100                    LDQ     CRCP_WORD,,AUTO
         1 004366   000022 772000                    QRL     18
         1 004367   000035 552110                    STBQ    29,'10'O,PR0

     1163    12605    5                       IF DEV$->NI$DCT.MPC.FWNAME='URTP' THEN DO;

  12605  1 004370   000041 236100                    LDQ     33,,PR0
         1 004371   000152 116000 0                  CMPQ    NI_ENTADDR+33
         1 004372   004434 601000 1                  TNZ     SKIP_FW

     1164    12606    5                            CALL CONCAT(DEVNM,'TC',SUBSTR(DEV$->NI$DCT.DEVNM,2));

  12606  1 004373   000153 220000 0                  LDX0    NI_ENTADDR+34
         1 004374   200021 740100                    STX0    DEVNM,,AUTO
         1 004375   040100 100500                    MLR     fill='040'O
         1 004376   000002 400006                    ADSC9   2,,PR0                   cn=2,n=6
         1 004377   200021 400006                    ADSC9   DEVNM,,AUTO              cn=2,n=6

     1165    12607    6                            DO J=1 TO NK_MXLOCAL;

  12607  1 004400   000001 235007                    LDA     1,DL
         1 004401   200006 755100                    STA     J,,AUTO
         1 004402   004431 710000 1                  TRA     s:12616+1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:185  

     1166    12608    7                                 IF N$DCT$$->N$DCT$(J)->NI$DCT.DEVNM=DEVNM THEN DO;

  12608  1 004403   000000 470400 xsym               LDP0    N$DCT$$
         1 004404   200006 720100                    LXL0    J,,AUTO
         1 004405   000000 471510                    LDP1    0,X0,PR0
         1 004406   040100 106500                    CMPC    fill='040'O
         1 004407   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         1 004410   200021 000010                    ADSC9   DEVNM,,AUTO              cn=0,n=8
         1 004411   004430 601000 1                  TNZ     s:12616

     1167    12609    7                                      REQ$=N$DCT$$->N$DCT$(J);

  12609  1 004412   000000 236110                    LDQ     0,X0,PR0
         1 004413   200171 756100                    STQ     REQ$,,AUTO

     1168    12610    8                                      IF REQ$->NI$DCT.MPC.FWNAME='TPUR' THEN DO;

  12610  1 004414   200171 471500                    LDP1    REQ$,,AUTO
         1 004415   100041 236100                    LDQ     33,,PR1
         1 004416   000154 116000 0                  CMPQ    NI_ENTADDR+35
         1 004417   004425 601000 1                  TNZ     s:12614

     1169    12611    8                                           REQ$->NI$DCT.MPC.ALTMPCX=I;

  12611  1 004420   200005 236100                    LDQ     I,,AUTO
         1 004421   100035 552104                    STBQ    29,'04'O,PR1

     1170    12612    8                                           DEV$->NI$DCT.MPC.ALTMPCX=J;

  12612  1 004422   200174 471500                    LDP1    DEV$,,AUTO
         1 004423   200006 236100                    LDQ     J,,AUTO
         1 004424   100035 552104                    STBQ    29,'04'O,PR1

     1171    12613    8                                         END;

     1172    12614    7                                      J=NK_MXLOCAL+1;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:186  
             12614                                               /* EXIT LOOP                        */

  12614  1 004425   000000 235000 xsym               LDA     NK_MXLOCAL
         1 004426   000001 035007                    ADLA    1,DL
         1 004427   200006 755100                    STA     J,,AUTO

     1173    12615    7                                    END;

     1174    12616    6                               END;

  12616  1 004430   200006 054100                    AOS     J,,AUTO
         1 004431   200006 236100                    LDQ     J,,AUTO
         1 004432   000000 116000 xsym               CMPQ    NK_MXLOCAL
         1 004433   004403 604400 1                  TMOZ    s:12608

     1175    12617    5                          END;

     1176    12618    4                     END;

  12612  1 004434                       SKIP_FW      null
     1177    12619        /**/
     1178    12620        /*
     1179    12621           ***  Now call NIW$LDFW to load FW.
     1180    12622        */
     1181    12623        /**/
     1182    12624    3   SKIP_FW:       ;
     1183    12625    3                  IF NOT HW_LOAD_FW THEN

  12625  1 004434   000000 234000 xsym               SZN     HW_LOAD_FW
         1 004435   004467 604000 1                  TMI     s:12634

     1184    12626    3                       IF DEV$->NI$DCT.MPC.FWNAME ~= 'NONE' AND

  12626  1 004436   200174 470500                    LDP0    DEV$,,AUTO
         1 004437   000041 236100                    LDQ     33,,PR0
         1 004440   000116 116000 0                  CMPQ    NI_ENTADDR+5
         1 004441   004514 600000 1                  TZE     s:12636
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:187  
         1 004442   200005 235100                    LDA     I,,AUTO
         1 004443   004445 605000 1                  TPL     s:12626+7
         1 004444   000044 035003                    ADLA    36,DU
         1 004445   000000 066405                    CMPB    filb='1'B
         1 004446   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1
         1 004447   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004450   004514 601000 1                  TNZ     s:12636
         1 004451   200005 235100                    LDA     I,,AUTO
         1 004452   004454 605000 1                  TPL     s:12626+14
         1 004453   000044 035003                    ADLA    36,DU
         1 004454   000000 066405                    CMPB    filb='2'B
         1 004455   000031 000001 xsym               BDSC    IT_PARTITION+25,A        by=0,bit=0,n=1
         1 004456   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004457   004514 601000 1                  TNZ     s:12636

     1185    12627    3                           NOT IT_PARTITION.DEVICE(I) AND NOT IT_PARTITION.MSOS_DEVICE
             12627                                     (I) THEN
     1186    12628    4                       DO;

     1187    12629    4                            DEV$->NI$DCT.DFLG.MPCSTOP = '1'B;

  12629  1 004460   001000 236007                    LDQ     512,DL
         1 004461   000006 256100                    ORSQ    6,,PR0

     1188    12630    4                            CALL NIW$MPCSTART (DEV$->NI$DCT);

  12630  1 004462   200174 630500                    EPPR0   DEV$,,AUTO
         1 004463   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004464   000000 701000 xent               TSX1    NIW$MPCSTART
         1 004465   000000 011000                    NOP     0

     1189    12631    4                          END;

  12631  1 004466   004514 710000 1                  TRA     s:12636

     1190    12632    3                       ELSE ;              /* Don't call MPCSTART for UCnn */
     1191    12633    3                  ELSE
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:188  
     1192    12634    3                      IF NOT IT_PARTITION.DEVICE(I) AND NOT IT_PARTITION.MSOS_DEVICE(I
             12634                                ) THEN

  12634  1 004467   200005 235100                    LDA     I,,AUTO
         1 004470   004472 605000 1                  TPL     s:12634+3
         1 004471   000044 035003                    ADLA    36,DU
         1 004472   000000 066405                    CMPB    filb='0'B
         1 004473   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1
         1 004474   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004475   004514 601000 1                  TNZ     s:12636
         1 004476   200005 235100                    LDA     I,,AUTO
         1 004477   004501 605000 1                  TPL     s:12634+10
         1 004500   000044 035003                    ADLA    36,DU
         1 004501   000000 066405                    CMPB    filb='2'B
         1 004502   000031 000001 xsym               BDSC    IT_PARTITION+25,A        by=0,bit=0,n=1
         1 004503   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 004504   004514 601000 1                  TNZ     s:12636

     1193    12635    3                            CALL NIW$LDFW(DEV$ -> NI$DCT,'1'B);

  12635  1 004505   000052 236000 2                  LDQ     42
         1 004506   200174 235100                    LDA     DEV$,,AUTO
         1 004507   200262 757100                    STAQ    DQH$+2,,AUTO
         1 004510   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 004511   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004512   000000 701000 xent               TSX1    NIW$LDFW
         1 004513   000000 011000                    NOP     0

     1194    12636    3                  IF (DEV$ -> NI$DCT.MPC.FW$ = B$DS1$) THEN

  12636  1 004514   200174 470500                    LDP0    DEV$,,AUTO
         1 004515   000030 236100                    LDQ     24,,PR0
         1 004516   000000 116000 xsym               CMPQ    B$DS1$
         1 004517   004522 601000 1                  TNZ     s:12638

     1195    12637    3                       DEV$ -> NI$DCT.MPC.FW$ = ADDR(NIL);

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:189  
  12637  1 004520   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 004521   000030 756100                    STQ     24,,PR0

     1196    12638    3                  IF DEV$->NI$DCT.SQH$ = N$DCT$(IT_SYSDISK)->NI$DCT.SQH$ THEN

  12638  1 004522   000000 471400 xsym               LDP1    N$DCT$$
         1 004523   000000 720000 xsym               LXL0    IT_SYSDISK
         1 004524   100000 473510                    LDP3    0,X0,PR1
         1 004525   000022 236100                    LDQ     18,,PR0
         1 004526   300022 116100                    CMPQ    18,,PR3
         1 004527   004532 601000 1                  TNZ     FWNONE

     1197    12639    3                       CALL IOSPIN ;

  12639  1 004530   006550 701000 1                  TSX1    IOSPIN
         1 004531   000000 011000                    NOP     0

     1198    12640    3                END;

     1199    12641        /**/
     1200    12642    2   FWNONE:   I = I+1;

  12642  1 004532   200005 054100       FWNONE       AOS     I,,AUTO

     1201    12643    2           END;

  12643  1 004533   000000 470400 xsym               LDP0    N$DCT$$
         1 004534   200005 720100                    LXL0    I,,AUTO
         1 004535   000000 236110                    LDQ     0,X0,PR0
         1 004536   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 004537   003766 601000 1                  TNZ     NEXTFWDEV

     1202    12644    1        CALL IOSPIN ;

  12644  1 004540   006550 701000 1                  TSX1    IOSPIN
         1 004541   000000 011000                    NOP     0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:190  
     1203    12645        /**/
     1204    12646    1        REQ$=B$DS1$;

  12646  1 004542   000000 236000 xsym               LDQ     B$DS1$
         1 004543   200171 756100                    STQ     REQ$,,AUTO

     1205    12647    1        CALL MMH$FDS(%MONWSQ,REREQ$.SEGID,MM_DSMAX(0)*1024,J);

  12647  1 004544   000000 236000 xsym               LDQ     MM_DSMAX
         1 004545   000021 772000                    QRL     17
         1 004546   000053 376000 2                  ANQ     43
         1 004547   200262 756100                    STQ     DQH$+2,,AUTO
         1 004550   200006 630500                    EPPR0   J,,AUTO
         1 004551   200267 450500                    STP0    DQH$+7,,AUTO
         1 004552   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 004553   200266 451500                    STP1    DQH$+6,,AUTO
         1 004554   200270 452500                    STP2    DQH$+8,,AUTO
         1 004555   200270 236100                    LDQ     DQH$+8,,AUTO
         1 004556   000023 036000 2                  ADLQ    19
         1 004557   000002 235000 2                  LDA     2
         1 004560   200264 757100                    STAQ    DQH$+4,,AUTO
         1 004561   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 004562   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 004563   000000 701000 xent               TSX1    MMH$FDS
         1 004564   000000 011000                    NOP     0

     1206    12648        /**/
     1207    12649    1        MM_DSMAX = IT_MMDSMAX;             /* RESTORE SAVED DATA                 */

  12649  1 004565   000000 100400                    MLR     fill='000'O
         1 004566   000000 000010 xsym               ADSC9   IT_MMDSMAX               cn=0,n=8
         1 004567   000000 000010 xsym               ADSC9   MM_DSMAX                 cn=0,n=8

     1208    12650        /**/
     1209    12651    1        IF (IT_BOOTFLAG >= I_DISKBOOT) THEN GOTO FWDONE; /* DONT WRITE DISK ON DB */

  12651  1 004570   000000 235000 xsym               LDA     IT_BOOTFLAG
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:191  
         1 004571   000007 115007                    CMPA    7,DL
         1 004572   005151 603000 1                  TRC     FWDONE

     1210    12652        /**/
     1211    12653    1        REQ$ = B$REAL$;

  12653  1 004573   000000 236000 xsym               LDQ     B$REAL$
         1 004574   200171 756100                    STQ     REQ$,,AUTO

     1212    12654        /**/
     1213    12655    2        DO J=0 TO 7;                       /* LOW REAL */

  12655  1 004575   200006 450100                    STZ     J,,AUTO

     1214    12656    2             REREQ$.OFFSET = J * 1024;     /* WRITE DATA PAGE                    */

  12656  1 004576   200006 235100                    LDA     J,,AUTO
         1 004577   000012 735000                    ALS     10
         1 004600   000000 620005                    EAX0    0,AL
         1 004601   200171 740100                    STX0    REQ$,,AUTO

     1215    12657    2             DBUF$ -> B$PAGE = REQ$ -> B$PAGE;

  12657  1 004602   200171 470500                    LDP0    REQ$,,AUTO
         1 004603   010000 221003                    LDX1    4096,DU
         1 004604   200200 471500                    LDP1    DBUF$,,AUTO
         1 004605   000140 100540                    MLR     fill='000'O
         1 004606   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         1 004607   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

     1216    12658        /**/
     1217    12659    2             CALL ITQ$DWRITE(DBUF$,LOWREAL_DA) ALTRET(DISK_ERR);

  12659  1 004610   200037 630500                    EPPR0   LOWREAL_DA,,AUTO
         1 004611   200263 450500                    STP0    DQH$+3,,AUTO
         1 004612   200200 631500                    EPPR1   DBUF$,,AUTO
         1 004613   200262 451500                    STP1    DQH$+2,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:192  
         1 004614   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 004615   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004616   000000 701000 xent               TSX1    ITQ$DWRITE
         1 004617   006715 702000 1                  TSX2    DISK_ERR

     1218    12660    2             LOWREAL_DA = LOWREAL_DA + 1;

  12660  1 004620   200037 054100                    AOS     LOWREAL_DA,,AUTO

     1219    12661    3             IF LOWREAL_DA > MIN_DA THEN DO;

  12661  1 004621   200037 236100                    LDQ     LOWREAL_DA,,AUTO
         1 004622   200033 116100                    CMPQ    MIN_DA,,AUTO
         1 004623   004633 604400 1                  TMOZ    s:12666

     1220    12662    3                  CALL ITE$ERROR(%E$SYS2SMALL);

  12662  1 004624   000055 630400 2                  EPPR0   45
         1 004625   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004626   000000 701000 xent               TSX1    ITE$ERROR
         1 004627   000000 011000                    NOP     0

     1221    12663    3                  CALL ITF$FREEZE;

  12663  1 004630   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004631   000000 701000 xent               TSX1    ITF$FREEZE
         1 004632   000000 011000                    NOP     0

     1222    12664    3                END;

     1223    12665        /**/
     1224    12666    2           END;

  12666  1 004633   200006 054100                    AOS     J,,AUTO
         1 004634   200006 235100                    LDA     J,,AUTO
         1 004635   000007 115007                    CMPA    7,DL
         1 004636   004576 604400 1                  TMOZ    s:12656
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:193  

     1225    12667    1        REQ$ = B$IS$;                      /* USE REQ$ AS PTR TO PAGE            */

  12667  1 004637   000000 236000 xsym               LDQ     B$IS$
         1 004640   200171 756100                    STQ     REQ$,,AUTO

     1226    12668        /**/
     1227    12669    2        DO J = 0 TO (MONDATA_SIZE/1024)-1;

  12669  1 004641   200006 450100                    STZ     J,,AUTO
         1 004642   004673 710000 1                  TRA     s:12678+1

     1228    12670    2             REREQ$.OFFSET = J * 1024;     /* WRITE DATA PAGE                    */

  12670  1 004643   200006 235100                    LDA     J,,AUTO
         1 004644   000012 735000                    ALS     10
         1 004645   000000 620005                    EAX0    0,AL
         1 004646   200171 740100                    STX0    REQ$,,AUTO

     1229    12671    2             CALL ITQ$DWRITE(REQ$,MONDATA_DA) ALTRET(DISK_ERR);

  12671  1 004647   200034 630500                    EPPR0   MONDATA_DA,,AUTO
         1 004650   200263 450500                    STP0    DQH$+3,,AUTO
         1 004651   200171 631500                    EPPR1   REQ$,,AUTO
         1 004652   200262 451500                    STP1    DQH$+2,,AUTO
         1 004653   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 004654   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004655   000000 701000 xent               TSX1    ITQ$DWRITE
         1 004656   006715 702000 1                  TSX2    DISK_ERR

     1230    12672        /**/
     1231    12673    2             MONDATA_DA = MONDATA_DA + 1;

  12673  1 004657   200034 054100                    AOS     MONDATA_DA,,AUTO

     1232    12674    3             IF MONDATA_DA > MIN_DA THEN DO;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:194  
  12674  1 004660   200034 236100                    LDQ     MONDATA_DA,,AUTO
         1 004661   200033 116100                    CMPQ    MIN_DA,,AUTO
         1 004662   004672 604400 1                  TMOZ    s:12678

     1233    12675    3                  CALL ITE$ERROR(%E$SYS2SMALL);

  12675  1 004663   000055 630400 2                  EPPR0   45
         1 004664   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004665   000000 701000 xent               TSX1    ITE$ERROR
         1 004666   000000 011000                    NOP     0

     1234    12676    3                  CALL ITF$FREEZE;

  12676  1 004667   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004670   000000 701000 xent               TSX1    ITF$FREEZE
         1 004671   000000 011000                    NOP     0

     1235    12677    3                END;

     1236    12678    2           END;

  12678  1 004672   200006 054100                    AOS     J,,AUTO
         1 004673   200035 236100                    LDQ     MONDATA_SIZE,,AUTO
         1 004674   002000 506007                    DIV     1024,DL
         1 004675   200006 116100                    CMPQ    J,,AUTO
         1 004676   004643 605400 1                  TPNZ    s:12670

     1237    12679        /**/
     1238    12680    1        REQ$ = PTR$;

  12680  1 004677   200003 470500                    LDP0    @PTR$,,AUTO
         1 004700   000000 236100                    LDQ     0,,PR0
         1 004701   200171 756100                    STQ     REQ$,,AUTO

     1239    12681    1        I = REREQ$.OFFSET/1024;

  12681  1 004702   200171 236100                    LDQ     REQ$,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:195  
         1 004703   000022 772000                    QRL     18
         1 004704   000012 772000                    QRL     10
         1 004705   200005 756100                    STQ     I,,AUTO

     1240    12682        /**/
     1241    12683    1        REQ$ = B$TIGR$;

  12683  1 004706   000000 236000 xsym               LDQ     B$TIGR$
         1 004707   200171 756100                    STQ     REQ$,,AUTO

     1242    12684    1        IT_DATASIZE = (I+1)*1024;

  12684  1 004710   200005 235100                    LDA     I,,AUTO
         1 004711   000012 735000                    ALS     10
         1 004712   002000 035007                    ADLA    1024,DL
         1 004713   000000 755000 xsym               STA     IT_DATASIZE

     1243    12685    2        DO J = 0 TO I;

  12685  1 004714   200006 450100                    STZ     J,,AUTO
         1 004715   004754 710000 1                  TRA     s:12697+1

     1244    12686    2             REREQ$.OFFSET = J*1024;

  12686  1 004716   200006 235100                    LDA     J,,AUTO
         1 004717   000012 735000                    ALS     10
         1 004720   000000 620005                    EAX0    0,AL
         1 004721   200171 740100                    STX0    REQ$,,AUTO

     1245    12687    2             DBUF$ -> B$PAGE = REQ$ -> B$PAGE;

  12687  1 004722   200171 470500                    LDP0    REQ$,,AUTO
         1 004723   010000 221003                    LDX1    4096,DU
         1 004724   200200 471500                    LDP1    DBUF$,,AUTO
         1 004725   000140 100540                    MLR     fill='000'O
         1 004726   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         1 004727   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:196  

     1246    12688        /**/
     1247    12689    2             CALL ITQ$DWRITE(DBUF$,TIGRDATA_DA) ALTRET(DISK_ERR);

  12689  1 004730   200036 630500                    EPPR0   TIGRDATA_DA,,AUTO
         1 004731   200263 450500                    STP0    DQH$+3,,AUTO
         1 004732   200200 631500                    EPPR1   DBUF$,,AUTO
         1 004733   200262 451500                    STP1    DQH$+2,,AUTO
         1 004734   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 004735   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004736   000000 701000 xent               TSX1    ITQ$DWRITE
         1 004737   006715 702000 1                  TSX2    DISK_ERR

     1248    12690        /**/
     1249    12691    2             TIGRDATA_DA = TIGRDATA_DA + 1;

  12691  1 004740   200036 054100                    AOS     TIGRDATA_DA,,AUTO

     1250    12692    3             IF TIGRDATA_DA > MIN_DA THEN DO;

  12692  1 004741   200036 236100                    LDQ     TIGRDATA_DA,,AUTO
         1 004742   200033 116100                    CMPQ    MIN_DA,,AUTO
         1 004743   004753 604400 1                  TMOZ    s:12697

     1251    12693    3                  CALL ITE$ERROR(%E$SYS2SMALL);

  12693  1 004744   000055 630400 2                  EPPR0   45
         1 004745   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 004746   000000 701000 xent               TSX1    ITE$ERROR
         1 004747   000000 011000                    NOP     0

     1252    12694    3                  CALL ITF$FREEZE;

  12694  1 004750   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 004751   000000 701000 xent               TSX1    ITF$FREEZE
         1 004752   000000 011000                    NOP     0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:197  
     1253    12695    3                END;

     1254    12696        /**/
     1255    12697    2           END;

  12697  1 004753   200006 054100                    AOS     J,,AUTO
         1 004754   200006 236100                    LDQ     J,,AUTO
         1 004755   200005 116100                    CMPQ    I,,AUTO
         1 004756   004716 604400 1                  TMOZ    s:12686

     1256    12698        /**/
     1257    12699    2        IF IT_BOOTFLAG=I_NEWFILES THEN DO;

  12699  1 004757   000000 235000 xsym               LDA     IT_BOOTFLAG
         1 004760   000002 115007                    CMPA    2,DL
         1 004761   005053 601000 1                  TNZ     s:12720

     1258    12700                                 /* check that there's room for system area in case */
     1259    12701                                                /* it's getting extended */
     1260    12702    2             CALL ITQ$DREAD(DBUF$,VIDDA) ALTRET(DISK_ERR);

  12702  1 004762   000010 236000 2                  LDQ     8
         1 004763   200263 756100                    STQ     DQH$+3,,AUTO
         1 004764   200200 630500                    EPPR0   DBUF$,,AUTO
         1 004765   200262 450500                    STP0    DQH$+2,,AUTO
         1 004766   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 004767   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 004770   000000 701000 xent               TSX1    ITQ$DREAD
         1 004771   006715 702000 1                  TSX2    DISK_ERR

     1261    12703    2             IF DBUF$->FM$VID.SECTSTRT(2) < DBUF$->FM$VID.SECTSTRT(3) THEN

  12703  1 004772   200200 470500                    LDP0    DBUF$,,AUTO
         1 004773   000012 236100                    LDQ     10,,PR0
         1 004774   000013 116100                    CMPQ    11,,PR0
         1 004775   005057 602000 1                  TNC     STOPBOOT

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:198  
     1262    12704    2                  GOTO STOPBOOT;           /* More than 2 sections */
     1263    12705    2             I = DBUF$->FM$VID.SECTSTRT(1);

  12705  1 004776   000011 235100                    LDA     9,,PR0
         1 004777   200005 755100                    STA     I,,AUTO

     1264    12706    3             IF DBUF$->FM$VID.SECTSTRT(1) < DBUF$->FM$VID.SECTSTRT(2) THEN DO;

  12706  1 005000   000011 116100                    CMPQ    9,,PR0
         1 005001   005022 602000 1                  TNC     s:12713
         1 005002   005022 600000 1                  TZE     s:12713

     1265    12707    3                  CALL ITQ$DREAD(DBUF$,I) ALTRET(DISK_ERR);

  12707  1 005003   200005 631500                    EPPR1   I,,AUTO
         1 005004   200263 451500                    STP1    DQH$+3,,AUTO
         1 005005   200200 633500                    EPPR3   DBUF$,,AUTO
         1 005006   200262 453500                    STP3    DQH$+2,,AUTO
         1 005007   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005010   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005011   000000 701000 xent               TSX1    ITQ$DREAD
         1 005012   006715 702000 1                  TSX2    DISK_ERR

     1266    12708                                                /* only extend over #SYS or scratch */
     1267    12709    3                  IF DBUF$->FM$VID.PSN ~= 'SYS   '

  12709  1 005013   200200 470500                    LDP0    DBUF$,,AUTO
         1 005014   040000 106500                    CMPC    fill='040'O
         1 005015   000003 000006                    ADSC9   3,,PR0                   cn=0,n=6
         1 005016   000155 000006 0                  ADSC9   NI_ENTADDR+36            cn=0,n=6
         1 005017   005022 600000 1                  TZE     s:12713
         1 005020   000004 720100                    LXL0    4,,PR0
         1 005021   005057 601000 1                  TNZ     STOPBOOT

     1268    12710    3                       AND DBUF$->FM$VID.VOLCNT ~= 0 THEN
     1269    12711    3                       GOTO STOPBOOT;
     1270    12712    3                END;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:199  

     1271    12713    2             MIN_DA = TIGRDATA_DA + IT_DUMPSIZE;

  12713  1 005022   200036 236100                    LDQ     TIGRDATA_DA,,AUTO
         1 005023   000000 036000 xsym               ADLQ    IT_DUMPSIZE
         1 005024   200033 756100                    STQ     MIN_DA,,AUTO

     1272    12714    2             CALL ITQ$DREAD(DBUF$,VIDDA) ALTRET (DISK_ERR);

  12714  1 005025   000010 236000 2                  LDQ     8
         1 005026   200263 756100                    STQ     DQH$+3,,AUTO
         1 005027   200200 631500                    EPPR1   DBUF$,,AUTO
         1 005030   200262 451500                    STP1    DQH$+2,,AUTO
         1 005031   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005032   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005033   000000 701000 xent               TSX1    ITQ$DREAD
         1 005034   006715 702000 1                  TSX2    DISK_ERR

     1273    12715    2             DBUF$ -> FM$VID.SYSSIZE = MIN_DA + 1;

  12715  1 005035   200033 235100                    LDA     MIN_DA,,AUTO
         1 005036   000001 035007                    ADLA    1,DL
         1 005037   200200 470500                    LDP0    DBUF$,,AUTO
         1 005040   000005 755100                    STA     5,,PR0

     1274    12716    2             MINI_DATA.OK2WRVID = MINI_DATA.OK2WRVID+1;

  12716  1 005041   000000 470400 xsym               LDP0    B$LOWMEM$
         1 005042   020005 054100                    AOS     8197,,PR0

     1275    12717    2             CALL ITQ$DWRITE(DBUF$,VIDDA) ALTRET(DISK_ERR);

  12717  1 005043   000010 236000 2                  LDQ     8
         1 005044   200263 756100                    STQ     DQH$+3,,AUTO
         1 005045   200200 631500                    EPPR1   DBUF$,,AUTO
         1 005046   200262 451500                    STP1    DQH$+2,,AUTO
         1 005047   200262 630500                    EPPR0   DQH$+2,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:200  
         1 005050   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005051   000000 701000 xent               TSX1    ITQ$DWRITE
         1 005052   006715 702000 1                  TSX2    DISK_ERR

     1276    12718    2           END;

     1277    12719
     1278    12720    2        IF TIGRDATA_DA + IT_DUMPSIZE > MIN_DA THEN DO;

  12720  1 005053   200036 236100                    LDQ     TIGRDATA_DA,,AUTO
         1 005054   000000 036000 xsym               ADLQ    IT_DUMPSIZE
         1 005055   200033 116100                    CMPQ    MIN_DA,,AUTO
         1 005056   005066 604400 1                  TMOZ    s:12726

  12716  1 005057                       STOPBOOT     null
     1279    12721    2   STOPBOOT: ;
     1280    12722    2             CALL ITE$ERROR(%E$SYS2SMALL);

  12722  1 005057   000055 630400 2                  EPPR0   45
         1 005060   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005061   000000 701000 xent               TSX1    ITE$ERROR
         1 005062   000000 011000                    NOP     0

     1281    12723    2             CALL ITF$FREEZE;

  12723  1 005063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 005064   000000 701000 xent               TSX1    ITF$FREEZE
         1 005065   000000 011000                    NOP     0

     1282    12724    2           END;

     1283    12725        /**/
     1284    12726    1        CALL ITH$READ_VERIFY_SAD(DBUF$,DIR_DA) ALTRET(DISK_ERR);

  12726  1 005066   200040 630500                    EPPR0   DIR_DA,,AUTO
         1 005067   200263 450500                    STP0    DQH$+3,,AUTO
         1 005070   200200 631500                    EPPR1   DBUF$,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:201  
         1 005071   200262 451500                    STP1    DQH$+2,,AUTO
         1 005072   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005073   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005074   000000 701000 xent               TSX1    ITH$READ_VERIFY_SAD
         1 005075   006715 702000 1                  TSX2    DISK_ERR

     1285    12727        /**/
     1286    12728    1        DBUF$ -> I$DISKDIR.TIGRDATA.SIZE = IT_DATASIZE;

  12728  1 005076   200200 470500                    LDP0    DBUF$,,AUTO
         1 005077   000000 235000 xsym               LDA     IT_DATASIZE
         1 005100   000116 755100                    STA     78,,PR0

     1287    12729    1        DBUF$ -> I$DISKDIR.DUMP.DA = TIGRDATA_DA;

  12729  1 005101   200036 236100                    LDQ     TIGRDATA_DA,,AUTO
         1 005102   200200 470500                    LDP0    DBUF$,,AUTO
         1 005103   000201 756100                    STQ     129,,PR0

     1288    12730    1        DBUF$ -> I$DISKDIR.DUMP.SIZE = (MIN_DA - TIGRDATA_DA - 1);

  12730  1 005104   200033 236100                    LDQ     MIN_DA,,AUTO
         1 005105   200036 136100                    SBLQ    TIGRDATA_DA,,AUTO
         1 005106   000001 136007                    SBLQ    1,DL
         1 005107   000202 756100                    STQ     130,,PR0

     1289    12731    1        DBUF$ -> I$DISKDIR.DUMP.SCOUNT = 0;

  12731  1 005110   000200 450100                    STZ     128,,PR0

     1290    12732    1        DBUF$ -> I$DISKDIR.DUMP.LDUMP = 0;

  12732  1 005111   200200 470500                    LDP0    DBUF$,,AUTO
         1 005112   000203 450100                    STZ     131,,PR0

     1291    12733    2        DO I=0 TO %RV_SYSDDUMP#-1;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:202  
  12733  1 005113   200005 450100                    STZ     I,,AUTO
         1 005114   005121 710000 1                  TRA     s:12735+1

     1292    12734    2             DBUF$ -> I$DISKDIR.RCVR2.DA(I) = 0;

  12734  1 005115   200200 470500                    LDP0    DBUF$,,AUTO
         1 005116   200005 720100                    LXL0    I,,AUTO
         1 005117   000204 450110                    STZ     132,X0,PR0

     1293    12735    2           END;

  12735  1 005120   200005 054100                    AOS     I,,AUTO
         1 005121   200005 235100                    LDA     I,,AUTO
         1 005122   000003 115007                    CMPA    3,DL
         1 005123   005115 604400 1                  TMOZ    s:12734

     1294    12736        /**/
     1295    12737    1        CALL ITQ$DWRITE(DBUF$,DIR_DA) ALTRET(DISK_ERR);

  12737  1 005124   200040 630500                    EPPR0   DIR_DA,,AUTO
         1 005125   200263 450500                    STP0    DQH$+3,,AUTO
         1 005126   200200 631500                    EPPR1   DBUF$,,AUTO
         1 005127   200262 451500                    STP1    DQH$+2,,AUTO
         1 005130   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005131   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005132   000000 701000 xent               TSX1    ITQ$DWRITE
         1 005133   006715 702000 1                  TSX2    DISK_ERR

     1296    12738        /**/
     1297    12739    1        DBUF$ -> B$PAGE = %NO#;

  12739  1 005134   200200 470500                    LDP0    DBUF$,,AUTO
         1 005135   010000 220003                    LDX0    4096,DU
         1 005136   000140 100400                    MLR     fill='000'O
         1 005137   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 005140   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:203  
     1298    12740        /**/
     1299    12741    1        CALL ITQ$DWRITE(DBUF$,TIGRDATA_DA) ALTRET(DISK_ERR);

  12741  1 005141   200036 630500                    EPPR0   TIGRDATA_DA,,AUTO
         1 005142   200263 450500                    STP0    DQH$+3,,AUTO
         1 005143   200200 631500                    EPPR1   DBUF$,,AUTO
         1 005144   200262 451500                    STP1    DQH$+2,,AUTO
         1 005145   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005146   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005147   000000 701000 xent               TSX1    ITQ$DWRITE
         1 005150   006715 702000 1                  TSX2    DISK_ERR

     1300    12742        /**/
     1301    12743    1   FWDONE:
     1302    12744    1        CALL NIM$WRDSBL(IT_DBUF,IT_DBUFEND);

  12744  1 005151   000042 630400 2     FWDONE       EPPR0   34
         1 005152   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005153   000000 701000 xent               TSX1    NIM$WRDSBL
         1 005154   000000 011000                    NOP     0

     1303    12745        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:204  
     1304    12746    1   STARTGHOST1:
     1305    12747        /* Set RELIOS here, because IOS pkts are not written out on RPM */
     1306    12748    1        IF NI_NUMIOS>NI_NUMIOQ+10 THEN NI_RELIOS = '0'B;

  12748  1 005155   000000 236000 xsym  STARTGHOST1  LDQ     NI_NUMIOQ
         1 005156   000012 036007                    ADLQ    10,DL
         1 005157   000000 116000 xsym               CMPQ    NI_NUMIOS
         1 005160   005162 605000 1                  TPL     s:12749

  12748  1 005161   000000 450000 xsym               STZ     NI_RELIOS

     1307    12749    2        IF CALL_VOLINIT THEN DO;

  12749  1 005162   200004 470500                    LDP0    @CALL_VOLINIT,,AUTO
         1 005163   000000 234100                    SZN     0,,PR0
         1 005164   005231 605000 1                  TPL     s:12763

     1308    12750    3             DO I=1 TO NK_MXLOCAL;

  12750  1 005165   000001 235007                    LDA     1,DL
         1 005166   200005 755100                    STA     I,,AUTO
         1 005167   005222 710000 1                  TRA     s:12757+1

     1309    12751    3                  DEV$=N$DCT$$->N$DCT$(I);

  12751  1 005170   000000 470400 xsym               LDP0    N$DCT$$
         1 005171   200005 720100                    LXL0    I,,AUTO
         1 005172   000000 236110                    LDQ     0,X0,PR0
         1 005173   200174 756100                    STQ     DEV$,,AUTO

     1310    12752    3                  IF DEV$->NI$DCT.TYPE=%DV_MPC AND DEV$->NI$DCT.MPC.FWNAME ~= 'NONE'
             12752                           AND

  12752  1 005174   200174 471500                    LDP1    DEV$,,AUTO
         1 005175   100007 236100                    LDQ     7,,PR1
         1 005176   007700 376007                    ANQ     4032,DL
         1 005177   000700 116007                    CMPQ    448,DL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:205  
         1 005200   005221 601000 1                  TNZ     s:12757
         1 005201   100041 236100                    LDQ     33,,PR1
         1 005202   000116 116000 0                  CMPQ    NI_ENTADDR+5
         1 005203   005221 600000 1                  TZE     s:12757
         1 005204   200005 235100                    LDA     I,,AUTO
         1 005205   005207 605000 1                  TPL     s:12752+11
         1 005206   000044 035003                    ADLA    36,DU
         1 005207   000000 066405                    CMPB    filb='0'B
         1 005210   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1
         1 005211   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 005212   005221 601000 1                  TNZ     s:12757

     1311    12753    4                       NOT IT_PARTITION.DEVICE(I) THEN DO;

     1312    12754    4                       DEV$->NI$DCT.DFLG.MPCSTOP='1'B;

  12754  1 005213   001000 236007                    LDQ     512,DL
         1 005214   100006 256100                    ORSQ    6,,PR1

     1313    12755    4                       CALL NIW$MPCSTART(DEV$->NI$DCT);

  12755  1 005215   200174 630500                    EPPR0   DEV$,,AUTO
         1 005216   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 005217   000000 701000 xent               TSX1    NIW$MPCSTART
         1 005220   000000 011000                    NOP     0

     1314    12756    4                     END;

     1315    12757    3                END;

  12757  1 005221   200005 054100                    AOS     I,,AUTO
         1 005222   200005 236100                    LDQ     I,,AUTO
         1 005223   000000 116000 xsym               CMPQ    NK_MXLOCAL
         1 005224   005170 604400 1                  TMOZ    s:12751

     1316    12758    3             DO WHILE('1'B);

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:206  
     1317    12759    3                  CALL ITK$VOLINIT;

  12759  1 005225   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 005226   000000 701000 xent               TSX1    ITK$VOLINIT
         1 005227   000000 011000                    NOP     0

     1318    12760    3                END;

  12760  1 005230   005225 710000 1                  TRA     s:12759

     1319    12761    2           END;
     1320    12762        /**/
     1321    12763    1        EL_LOGERRS = '1'B;

  12763  1 005231   400000 236003                    LDQ     -131072,DU
         1 005232   000000 756000 xsym               STQ     EL_LOGERRS

     1322    12764
     1323    12765    1        FPT_SYSCON.V.FUNCTION#=%PARTITION#;

  12765  1 005233   001000 236003                    LDQ     512,DU
         1 005234   200206 552140                    STBQ    FPT_SYSCON+4,'40'O,AUTO

     1324    12766        /**/
     1325    12767    1        FPT_SYSCON.V.COMPONENT#=%DVC#;

  12767  1 005235   000002 236003                    LDQ     2,DU
         1 005236   200206 552120                    STBQ    FPT_SYSCON+4,'20'O,AUTO

     1326    12768    2        DO I=1 TO NK_MXLOCAL;

  12768  1 005237   000001 235007                    LDA     1,DL
         1 005240   200005 755100                    STA     I,,AUTO
         1 005241   005402 710000 1                  TRA     s:12790+1

     1327    12769    3             IF N$DCT$(I)~=ADDR(NIL) THEN DO;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:207  
  12769  1 005242   000000 470400 xsym               LDP0    N$DCT$$
         1 005243   200005 720100                    LXL0    I,,AUTO
         1 005244   000000 236110                    LDQ     0,X0,PR0
         1 005245   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 005246   005401 600000 1                  TZE     s:12790

     1328    12770    3                  IF N$DCT$(I)->NI$DCT.TYPE = %DV_MPC THEN EXIT;

  12770  1 005247   000000 471510                    LDP1    0,X0,PR0
         1 005250   100007 236100                    LDQ     7,,PR1
         1 005251   007700 376007                    ANQ     4032,DL
         1 005252   000700 116007                    CMPQ    448,DL
         1 005253   005401 600000 1                  TZE     s:12790

     1329    12771    4                  IF IT_PARTITION.DEVICE(I) THEN DO;

  12771  1 005254   200005 235100                    LDA     I,,AUTO
         1 005255   005257 605000 1                  TPL     s:12771+3
         1 005256   000044 035003                    ADLA    36,DU
         1 005257   000000 066405                    CMPB    filb='2'B
         1 005260   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1
         1 005261   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 005262   005326 600000 1                  TZE     s:12779

     1330    12772    4                       FPT_SYSCON.V.DEVNM#=N$DCT$(I)->NI$DCT.DEVNM;

  12772  1 005263   040100 100500                    MLR     fill='040'O
         1 005264   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         1 005265   200207 000010                    ADSC9   FPT_SYSCON+5,,AUTO       cn=0,n=8

     1331    12773    5                      CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR) WHENALTRETURN DO;

  12773  1 005266   200010 631500                    EPPR1   ERR,,AUTO
         1 005267   200266 451500                    STP1    DQH$+6,,AUTO
         1 005270   200024 633500                    EPPR3   RSLT,,AUTO
         1 005271   200265 453500                    STP3    DQH$+5,,AUTO
         1 005272   200206 634500                    EPPR4   FPT_SYSCON+4,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:208  
         1 005273   200264 454500                    STP4    DQH$+4,,AUTO
         1 005274   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 005275   000001 235000 xsym               LDA     B_VECTNIL+1
         1 005276   200262 757100                    STAQ    DQH$+2,,AUTO
         1 005277   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005300   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 005301   000000 701000 xent               TSX1    ITK$TDP$SYSCON
         1 005302   005304 702000 1                  TSX2    s:12774
         1 005303   005326 710000 1                  TRA     s:12779

     1332    12774    5                            TEXT_C.L = 4;

  12774  1 005304   004000 236003                    LDQ     2048,DU
         1 005305   200011 552140                    STBQ    TEXT_C,'40'O,AUTO

     1333    12775    5                            TEXT_C.T = N$DCT$(I)->NI$DCT.DEVNM;

  12775  1 005306   000000 470400 xsym               LDP0    N$DCT$$
         1 005307   200005 720100                    LXL0    I,,AUTO
         1 005310   000000 471510                    LDP1    0,X0,PR0
         1 005311   040100 100500                    MLR     fill='040'O
         1 005312   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         1 005313   200011 200012                    ADSC9   TEXT_C,,AUTO             cn=1,n=10

     1334    12776    5                            CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));

  12776  1 005314   200011 631500                    EPPR1   TEXT_C,,AUTO
         1 005315   200262 451500                    STP1    DQH$+2,,AUTO
         1 005316   200262 633500                    EPPR3   DQH$+2,,AUTO
         1 005317   200265 453500                    STP3    DQH$+5,,AUTO
         1 005320   000057 236000 2                  LDQ     47
         1 005321   200264 756100                    STQ     DQH$+4,,AUTO
         1 005322   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 005323   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005324   000000 701000 xent               TSX1    ITE$ERROR
         1 005325   000000 011000                    NOP     0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:209  
     1335    12777    5                          END;

     1336    12778    4                     END;

     1337    12779    4                  IF IT_PARTITION.MSOS_DEVICE(I) THEN DO;

  12779  1 005326   200005 235100                    LDA     I,,AUTO
         1 005327   005331 605000 1                  TPL     s:12779+3
         1 005330   000044 035003                    ADLA    36,DU
         1 005331   000000 066405                    CMPB    filb='0'B
         1 005332   000031 000001 xsym               BDSC    IT_PARTITION+25,A        by=0,bit=0,n=1
         1 005333   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 005334   005401 600000 1                  TZE     s:12790

     1338    12780    4                       IF N$DCT$(I)->NI$DCT.RAT$~=ADDR(NIL) OR N$DCT$(I)->NI$DCT.DFLG.
             12780                                CONSOLE THEN

  12780  1 005335   000000 470400 xsym               LDP0    N$DCT$$
         1 005336   200005 720100                    LXL0    I,,AUTO
         1 005337   000000 471510                    LDP1    0,X0,PR0
         1 005340   100005 236100                    LDQ     5,,PR1
         1 005341   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 005342   005346 601000 1                  TNZ     s:12781
         1 005343   100006 236100                    LDQ     6,,PR1
         1 005344   040000 316007                    CANQ    16384,DL
         1 005345   005371 600000 1                  TZE     s:12786

     1339    12781    5                            CALL NKP$PART (N$DCT$(I)->NI$DCT,ERR) WHENALTRETURN DO;

  12781  1 005346   200010 633500                    EPPR3   ERR,,AUTO
         1 005347   200263 453500                    STP3    DQH$+3,,AUTO
         1 005350   200262 451500                    STP1    DQH$+2,,AUTO
         1 005351   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005352   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005353   000000 701000 xent               TSX1    NKP$PART
         1 005354   005356 702000 1                  TSX2    s:12782
         1 005355   005371 710000 1                  TRA     s:12786
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:210  

     1340    12782    5                                 TEXT_C.L = 10;

  12782  1 005356   012000 236003                    LDQ     5120,DU
         1 005357   200011 552140                    STBQ    TEXT_C,'40'O,AUTO

     1341    12783    5                                 TEXT_C.T = N$DCT$(I)->NI$DCT.DEVNM;

  12783  1 005360   000000 470400 xsym               LDP0    N$DCT$$
         1 005361   200005 720100                    LXL0    I,,AUTO
         1 005362   000000 471510                    LDP1    0,X0,PR0
         1 005363   040100 100500                    MLR     fill='040'O
         1 005364   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         1 005365   200011 200012                    ADSC9   TEXT_C,,AUTO             cn=1,n=10

     1342    12784    5                                 SUBSTR(TEXT_C.T,5,5) = '*NKP*';

  12784  1 005366   040100 100400                    MLR     fill='040'O
         1 005367   000157 000005 0                  ADSC9   NI_ENTADDR+38            cn=0,n=5
         1 005370   200012 400005                    ADSC9   TEXT_C+1,,AUTO           cn=2,n=5

     1343    12785    5                               END;

     1344    12786    4                       N$DCT$(I)->NI$DCT.STATUS.DOWN = '1'B;

  12786  1 005371   000000 470400 xsym               LDP0    N$DCT$$
         1 005372   200005 720100                    LXL0    I,,AUTO
         1 005373   000000 471510                    LDP1    0,X0,PR0
         1 005374   400000 236003                    LDQ     -131072,DU
         1 005375   100027 256100                    ORSQ    23,,PR1

     1345    12787    4                       N$DCT$(I)->NI$DCT.STATUS.MSOS_PART = '1'B;

  12787  1 005376   000000 471510                    LDP1    0,X0,PR0
         1 005377   002000 236003                    LDQ     1024,DU
         1 005400   100027 256100                    ORSQ    23,,PR1

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:211  
     1346    12788    4                     END;

     1347    12789    3                END;

     1348    12790    2           END;

  12790  1 005401   200005 054100                    AOS     I,,AUTO
         1 005402   200005 236100                    LDQ     I,,AUTO
         1 005403   000000 116000 xsym               CMPQ    NK_MXLOCAL
         1 005404   005242 604400 1                  TMOZ    s:12769

     1349    12791        /**/
     1350    12792    1        FPT_SYSCON.V.COMPONENT#=%MPC#;

  12792  1 005405   000003 236003                    LDQ     3,DU
         1 005406   200206 552120                    STBQ    FPT_SYSCON+4,'20'O,AUTO

     1351    12793    2        DO I=1 TO NK_MXLOCAL;

  12793  1 005407   000001 235007                    LDA     1,DL
         1 005410   200005 755100                    STA     I,,AUTO
         1 005411   005516 710000 1                  TRA     s:12809+1

     1352    12794    3             IF N$DCT$(I)~=ADDR(NIL) THEN DO;

  12794  1 005412   000000 470400 xsym               LDP0    N$DCT$$
         1 005413   200005 720100                    LXL0    I,,AUTO
         1 005414   000000 236110                    LDQ     0,X0,PR0
         1 005415   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 005416   005515 600000 1                  TZE     s:12809

     1353    12795    3                  IF N$DCT$(I)->NI$DCT.TYPE ~= %DV_MPC THEN EXIT;

  12795  1 005417   000000 471510                    LDP1    0,X0,PR0
         1 005420   100007 236100                    LDQ     7,,PR1
         1 005421   007700 376007                    ANQ     4032,DL
         1 005422   000700 116007                    CMPQ    448,DL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:212  
         1 005423   005515 601000 1                  TNZ     s:12809

     1354    12796    4                  IF IT_PARTITION.DEVICE(I) THEN DO;

  12796  1 005424   200005 235100                    LDA     I,,AUTO
         1 005425   005427 605000 1                  TPL     s:12796+3
         1 005426   000044 035003                    ADLA    36,DU
         1 005427   000000 066405                    CMPB    filb='2'B
         1 005430   000000 000001 xsym               BDSC    IT_PARTITION,A           by=0,bit=0,n=1
         1 005431   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 005432   005476 600000 1                  TZE     s:12804

     1355    12797    4                       FPT_SYSCON.V.DEVNM#=N$DCT$(I)->NI$DCT.DEVNM;

  12797  1 005433   040100 100500                    MLR     fill='040'O
         1 005434   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         1 005435   200207 000010                    ADSC9   FPT_SYSCON+5,,AUTO       cn=0,n=8

     1356    12798    5                      CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR) WHENALTRETURN DO;

  12798  1 005436   200010 631500                    EPPR1   ERR,,AUTO
         1 005437   200266 451500                    STP1    DQH$+6,,AUTO
         1 005440   200024 633500                    EPPR3   RSLT,,AUTO
         1 005441   200265 453500                    STP3    DQH$+5,,AUTO
         1 005442   200206 634500                    EPPR4   FPT_SYSCON+4,,AUTO
         1 005443   200264 454500                    STP4    DQH$+4,,AUTO
         1 005444   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 005445   000001 235000 xsym               LDA     B_VECTNIL+1
         1 005446   200262 757100                    STAQ    DQH$+2,,AUTO
         1 005447   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005450   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 005451   000000 701000 xent               TSX1    ITK$TDP$SYSCON
         1 005452   005454 702000 1                  TSX2    s:12799
         1 005453   005476 710000 1                  TRA     s:12804

     1357    12799    5                            TEXT_C.L = 4;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:213  
  12799  1 005454   004000 236003                    LDQ     2048,DU
         1 005455   200011 552140                    STBQ    TEXT_C,'40'O,AUTO

     1358    12800    5                            TEXT_C.T = N$DCT$(I)->NI$DCT.DEVNM;

  12800  1 005456   000000 470400 xsym               LDP0    N$DCT$$
         1 005457   200005 720100                    LXL0    I,,AUTO
         1 005460   000000 471510                    LDP1    0,X0,PR0
         1 005461   040100 100500                    MLR     fill='040'O
         1 005462   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         1 005463   200011 200012                    ADSC9   TEXT_C,,AUTO             cn=1,n=10

     1359    12801    5                            CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));

  12801  1 005464   200011 631500                    EPPR1   TEXT_C,,AUTO
         1 005465   200262 451500                    STP1    DQH$+2,,AUTO
         1 005466   200262 633500                    EPPR3   DQH$+2,,AUTO
         1 005467   200265 453500                    STP3    DQH$+5,,AUTO
         1 005470   000057 236000 2                  LDQ     47
         1 005471   200264 756100                    STQ     DQH$+4,,AUTO
         1 005472   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 005473   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005474   000000 701000 xent               TSX1    ITE$ERROR
         1 005475   000000 011000                    NOP     0

     1360    12802    5                          END;

     1361    12803    4                     END;

     1362    12804    4                  IF IT_PARTITION.MSOS_DEVICE(I) THEN DO;

  12804  1 005476   200005 235100                    LDA     I,,AUTO
         1 005477   005501 605000 1                  TPL     s:12804+3
         1 005500   000044 035003                    ADLA    36,DU
         1 005501   000000 066405                    CMPB    filb='0'B
         1 005502   000031 000001 xsym               BDSC    IT_PARTITION+25,A        by=0,bit=0,n=1
         1 005503   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:214  
         1 005504   005515 600000 1                  TZE     s:12809

     1363    12805    4                       N$DCT$(I)->NI$DCT.STATUS.DOWN = '1'B;

  12805  1 005505   000000 470400 xsym               LDP0    N$DCT$$
         1 005506   200005 720100                    LXL0    I,,AUTO
         1 005507   000000 471510                    LDP1    0,X0,PR0
         1 005510   400000 236003                    LDQ     -131072,DU
         1 005511   100027 256100                    ORSQ    23,,PR1

     1364    12806    4                       N$DCT$(I)->NI$DCT.STATUS.MSOS_PART = '1'B;

  12806  1 005512   000000 471510                    LDP1    0,X0,PR0
         1 005513   002000 236003                    LDQ     1024,DU
         1 005514   100027 256100                    ORSQ    23,,PR1

     1365    12807    4                     END;

     1366    12808    3                END;

     1367    12809    2           END;

  12809  1 005515   200005 054100                    AOS     I,,AUTO
         1 005516   200005 236100                    LDQ     I,,AUTO
         1 005517   000000 116000 xsym               CMPQ    NK_MXLOCAL
         1 005520   005412 604400 1                  TMOZ    s:12794

     1368    12810        /**/
     1369    12811    2        DO I=0 TO NI_IOMS-1;

  12811  1 005521   200005 450100                    STZ     I,,AUTO
         1 005522   005722 710000 1                  TRA     s:12853+1

     1370    12812    3             DO J=8 TO NI_CHANS(I);

  12812  1 005523   000010 235007                    LDA     8,DL
         1 005524   200006 755100                    STA     J,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:215  
         1 005525   005714 710000 1                  TRA     s:12852+1

     1371    12813    3                  DQH$=NI$CHT.DQH$(I*%N_MAXCHANS+J);

  12813  1 005526   200005 236100                    LDQ     I,,AUTO
         1 005527   000007 736000                    QLS     7
         1 005530   200006 036100                    ADLQ    J,,AUTO
         1 005531   000001 736000                    QLS     1
         1 005532   000000 470400 xsym               LDP0    NI$CHT$
         1 005533   000000 236106                    LDQ     0,QL,PR0
         1 005534   200173 756100                    STQ     DQH$,,AUTO

     1372    12814    4                  IF DQH$ ~= ADDR(NIL) THEN DO;

  12814  1 005535   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 005536   005713 600000 1                  TZE     s:12852

     1373    12815    5                       IF IT_PARTITION.IOCHAN(I*%N_MAXCHANS+J) AND DQH$->NI$DQH.MPC$~=
             12815                                ADDR(NIL) THEN DO;

  12815  1 005537   200005 236100                    LDQ     I,,AUTO
         1 005540   000007 736000                    QLS     7
         1 005541   200006 036100                    ADLQ    J,,AUTO
         1 005542   005544 605000 1                  TPL     s:12815+5
         1 005543   000044 036003                    ADLQ    36,DU
         1 005544   000000 066406                    CMPB    filb='2'B
         1 005545   000012 000001 xsym               BDSC    IT_PARTITION+10,Q        by=0,bit=0,n=1
         1 005546   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 005547   005626 600000 1                  TZE     s:12827
         1 005550   200173 471500                    LDP1    DQH$,,AUTO
         1 005551   100015 236100                    LDQ     13,,PR1
         1 005552   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 005553   005626 600000 1                  TZE     s:12827

     1374    12816    5                            FPT_SYSCON.V.IOM#=I;

  12816  1 005554   200005 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:216  
         1 005555   000011 736000                    QLS     9
         1 005556   200206 552110                    STBQ    FPT_SYSCON+4,'10'O,AUTO

     1375    12817    5                            FPT_SYSCON.V.CHAN#=J;

  12817  1 005557   200006 236100                    LDQ     J,,AUTO
         1 005560   200206 552104                    STBQ    FPT_SYSCON+4,'04'O,AUTO

     1376    12818    5                            FPT_SYSCON.V.COMPONENT# = %CHANNEL#;

  12818  1 005561   000001 236003                    LDQ     1,DU
         1 005562   200206 552120                    STBQ    FPT_SYSCON+4,'20'O,AUTO

     1377    12819    6                            CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR)
             12819                                     WHENALTRETURN DO;

  12819  1 005563   200010 633500                    EPPR3   ERR,,AUTO
         1 005564   200266 453500                    STP3    DQH$+6,,AUTO
         1 005565   200024 634500                    EPPR4   RSLT,,AUTO
         1 005566   200265 454500                    STP4    DQH$+5,,AUTO
         1 005567   200206 635500                    EPPR5   FPT_SYSCON+4,,AUTO
         1 005570   200264 455500                    STP5    DQH$+4,,AUTO
         1 005571   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 005572   000001 235000 xsym               LDA     B_VECTNIL+1
         1 005573   200262 757100                    STAQ    DQH$+2,,AUTO
         1 005574   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005575   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 005576   000000 701000 xent               TSX1    ITK$TDP$SYSCON
         1 005577   005601 702000 1                  TSX2    s:12820
         1 005600   005626 710000 1                  TRA     s:12827

     1378    12820    6                                 TEXT_C.L = 10;

  12820  1 005601   012000 236003                    LDQ     5120,DU
         1 005602   200011 552140                    STBQ    TEXT_C,'40'O,AUTO

     1379    12821    6                                 TEXT_C.T = 'Chan ?-???';
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:217  

  12821  1 005603   040100 100400                    MLR     fill='040'O
         1 005604   000161 000012 0                  ADSC9   NI_ENTADDR+40            cn=0,n=10
         1 005605   200011 200012                    ADSC9   TEXT_C,,AUTO             cn=1,n=10

     1380    12822    6                                 CALL BINCHAR(SUBSTR(TEXT_C.T,5,1),I);

  12822  1 005606   000100 301500                    BTD
         1 005607   200005 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         1 005610   200012 430001                    NDSC9   TEXT_C+1,,AUTO           cn=2,s=nosgn,sf=0,n=1

     1381    12823    6                                 CALL BINCHAR(SUBSTR(TEXT_C.T,7,3),J);

  12823  1 005611   000100 301500                    BTD
         1 005612   200006 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         1 005613   200013 030003                    NDSC9   TEXT_C+2,,AUTO           cn=0,s=nosgn,sf=0,n=3

     1382    12824    6                                 CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));

  12824  1 005614   200011 630500                    EPPR0   TEXT_C,,AUTO
         1 005615   200262 450500                    STP0    DQH$+2,,AUTO
         1 005616   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 005617   200265 451500                    STP1    DQH$+5,,AUTO
         1 005620   000057 236000 2                  LDQ     47
         1 005621   200264 756100                    STQ     DQH$+4,,AUTO
         1 005622   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 005623   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005624   000000 701000 xent               TSX1    ITE$ERROR
         1 005625   000000 011000                    NOP     0

     1383    12825    6                               END;

     1384    12826    5                          END;

     1385    12827    5                       IF IT_PARTITION.MSOS_IOCHAN(I*%N_MAXCHANS+J) THEN DO;

  12827  1 005626   200005 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:218  
         1 005627   000007 736000                    QLS     7
         1 005630   200006 036100                    ADLQ    J,,AUTO
         1 005631   005633 605000 1                  TPL     s:12827+5
         1 005632   000044 036003                    ADLQ    36,DU
         1 005633   000000 066406                    CMPB    filb='0'B
         1 005634   000043 000001 xsym               BDSC    IT_PARTITION+35,Q        by=0,bit=0,n=1
         1 005635   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 005636   005713 600000 1                  TZE     s:12852

     1386    12828    5                            DQH$->NI$DQH.STATUS.DOWN = '1'B;

  12828  1 005637   200173 470500                    LDP0    DQH$,,AUTO
         1 005640   200000 236003                    LDQ     65536,DU
         1 005641   000001 256100                    ORSQ    1,,PR0

     1387    12829    5                            DQH$->NI$DQH.STATUS.MSOS_PART = '1'B;

  12829  1 005642   200173 470500                    LDP0    DQH$,,AUTO
         1 005643   001000 236003                    LDQ     512,DU
         1 005644   000001 256100                    ORSQ    1,,PR0

     1388    12830    6                            IF DQH$->NI$DQH.SQH$->NI$SQH.CQ$ ~= ADDR(NIL) THEN DO;

  12830  1 005645   200173 470500                    LDP0    DQH$,,AUTO
         1 005646   000013 471500                    LDP1    11,,PR0
         1 005647   100004 236100                    LDQ     4,,PR1
         1 005650   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 005651   005713 600000 1                  TZE     s:12852

     1389    12831                       /* can't MSOS_PART a FEP, so DQH should always have an SQH$ */
     1390    12832    6                                 TDQH$ = DQH$->NI$DQH.SQH$->NI$SQH.CQ$;

  12832  1 005652   200250 756100                    STQ     TDQH$,,AUTO

     1391    12833    6                                 ONQUEUE = '1'B;

  12833  1 005653   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:219  
         1 005654   200251 256100                    ORSQ    IO_OUTSTANDING,,AUTO

     1392    12834    7                                 DO WHILE ONQUEUE AND TDQH$->NI$DQH.FL$ ~= DQH$;

  12834  1 005655   005667 710000 1                  TRA     s:12838

     1393    12835    7                                      TDQH$ = TDQH$->NI$DQH.FL$;

  12835  1 005656   200250 470500                    LDP0    TDQH$,,AUTO
         1 005657   000000 236100                    LDQ     0,,PR0
         1 005660   200250 756100                    STQ     TDQH$,,AUTO

     1394    12836    7                                      IF TDQH$ = DQH$->NI$DQH.SQH$->NI$SQH.CQ$ THEN

  12836  1 005661   200173 470500                    LDP0    DQH$,,AUTO
         1 005662   000013 471500                    LDP1    11,,PR0
         1 005663   100004 116100                    CMPQ    4,,PR1
         1 005664   005667 601000 1                  TNZ     s:12838

     1395    12837    7                                           ONQUEUE = '0'B;

  12837  1 005665   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 005666   200251 356100                    ANSQ    IO_OUTSTANDING,,AUTO

     1396    12838    7                                    END;

  12838  1 005667   200251 234100                    SZN     IO_OUTSTANDING,,AUTO
         1 005670   005675 605000 1                  TPL     s:12839
         1 005671   200250 473500                    LDP3    TDQH$,,AUTO
         1 005672   300000 236100                    LDQ     0,,PR3
         1 005673   200173 116100                    CMPQ    DQH$,,AUTO
         1 005674   005656 601000 1                  TNZ     s:12835

     1397    12839    7                                 IF ONQUEUE THEN DO;

  12839  1 005675   200251 234100                    SZN     IO_OUTSTANDING,,AUTO
         1 005676   005713 605000 1                  TPL     s:12852
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:220  

     1398    12840    7                                      DQH$->NI$DQH.SQH$->NI$SQH.CQ$ = TDQH$;

  12840  1 005677   200250 236100                    LDQ     TDQH$,,AUTO
         1 005700   100004 756100                    STQ     4,,PR1

     1399    12841                                           %DEQUEUE (P#=DQH$, Q#=
             12841                                               DQH$->NI$DQH.SQH$->NI$SQH.CQ$);

  12845  1 005701   200173 470500                    LDP0    DQH$,,AUTO
         1 005702   000013 471500                    LDP1    11,,PR0
         1 005703   100004 633500                    EPPR3   4,,PR1
         1 005704   200263 453500                    STP3    DQH$+3,,AUTO
         1 005705   200173 631500                    EPPR1   DQH$,,AUTO
         1 005706   200262 451500                    STP1    DQH$+2,,AUTO
         1 005707   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005710   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 005711   000000 701000 xent               TSX1    NIM$DEQUEUE
         1 005712   000000 011000                    NOP     0

     1400    12848    7                                    END;

     1401    12849    6                               END;

     1402    12850    5                          END;

     1403    12851    4                     END;

     1404    12852    3                END;

  12852  1 005713   200006 054100                    AOS     J,,AUTO
         1 005714   200005 720100                    LXL0    I,,AUTO
         1 005715   000000 236010 xsym               LDQ     NI_CHANS,X0
         1 005716   005526 604000 1                  TMI     s:12813
         1 005717   200006 116100                    CMPQ    J,,AUTO
         1 005720   005526 605000 1                  TPL     s:12813

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:221  
     1405    12853    2           END;

  12853  1 005721   200005 054100                    AOS     I,,AUTO
         1 005722   200005 236100                    LDQ     I,,AUTO
         1 005723   000000 116000 xsym               CMPQ    NI_IOMS
         1 005724   005523 604000 1                  TMI     s:12812

     1406    12854        /**/
     1407    12855    1        FPT_SYSCON.V.COMPONENT# =%FEP##;

  12855  1 005725   000004 236003                    LDQ     4,DU
         1 005726   200206 552120                    STBQ    FPT_SYSCON+4,'20'O,AUTO

     1408    12856    2        DO I=1 TO KI_MXFE;

  12856  1 005727   000001 235007                    LDA     1,DL
         1 005730   200005 755100                    STA     I,,AUTO
         1 005731   006035 710000 1                  TRA     s:12872+1

     1409    12857    2             J = BITBIN(KI_FEI$$->KI$FEI$(I)->KI$FEI.FECH);

  12857  1 005732   000000 470400 xsym               LDP0    KI_FEI$$
         1 005733   200005 720100                    LXL0    I,,AUTO
         1 005734   000000 471510                    LDP1    0,X0,PR0
         1 005735   100002 236100                    LDQ     2,,PR1
         1 005736   000033 772000                    QRL     27
         1 005737   200006 756100                    STQ     J,,AUTO

     1410    12858    3             IF IT_PARTITION.IOCHAN(J) THEN DO;

  12858  1 005740   005742 605000 1                  TPL     s:12858+2
         1 005741   000044 036003                    ADLQ    36,DU
         1 005742   000000 066406                    CMPB    filb='0'B
         1 005743   000012 000001 xsym               BDSC    IT_PARTITION+10,Q        by=0,bit=0,n=1
         1 005744   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 005745   006012 600000 1                  TZE     s:12867

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:222  
     1411    12859    3                  FPT_SYSCON.V.CHAN# = KI_FEI$$->KI$FEI$(I)->KI$FEI.FEP#;

  12859  1 005746   000000 471510                    LDP1    0,X0,PR0
         1 005747   100012 236100                    LDQ     10,,PR1
         1 005750   000011 772000                    QRL     9
         1 005751   200206 552104                    STBQ    FPT_SYSCON+4,'04'O,AUTO

     1412    12860    4                  CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR) WHENALTRETURN DO;

  12860  1 005752   200010 631500                    EPPR1   ERR,,AUTO
         1 005753   200266 451500                    STP1    DQH$+6,,AUTO
         1 005754   200024 633500                    EPPR3   RSLT,,AUTO
         1 005755   200265 453500                    STP3    DQH$+5,,AUTO
         1 005756   200206 634500                    EPPR4   FPT_SYSCON+4,,AUTO
         1 005757   200264 454500                    STP4    DQH$+4,,AUTO
         1 005760   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 005761   000001 235000 xsym               LDA     B_VECTNIL+1
         1 005762   200262 757100                    STAQ    DQH$+2,,AUTO
         1 005763   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 005764   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 005765   000000 701000 xent               TSX1    ITK$TDP$SYSCON
         1 005766   005770 702000 1                  TSX2    s:12861
         1 005767   006012 710000 1                  TRA     s:12867

     1413    12861    4                       TEXT_C.L = 6;

  12861  1 005770   006000 236003                    LDQ     3072,DU
         1 005771   200011 552140                    STBQ    TEXT_C,'40'O,AUTO

     1414    12862    4                       TEXT_C.T = 'Fep ??';

  12862  1 005772   040100 100400                    MLR     fill='040'O
         1 005773   000164 000006 0                  ADSC9   NI_ENTADDR+43            cn=0,n=6
         1 005774   200011 200012                    ADSC9   TEXT_C,,AUTO             cn=1,n=10

     1415    12863    4                       CALL BINCHAR(SUBSTR(TEXT_C.T,4,2),I);

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:223  
  12863  1 005775   000100 301500                    BTD
         1 005776   200005 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         1 005777   200012 230002                    NDSC9   TEXT_C+1,,AUTO           cn=1,s=nosgn,sf=0,n=2

     1416    12864    4                       CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));

  12864  1 006000   200011 630500                    EPPR0   TEXT_C,,AUTO
         1 006001   200262 450500                    STP0    DQH$+2,,AUTO
         1 006002   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 006003   200265 451500                    STP1    DQH$+5,,AUTO
         1 006004   000057 236000 2                  LDQ     47
         1 006005   200264 756100                    STQ     DQH$+4,,AUTO
         1 006006   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 006007   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006010   000000 701000 xent               TSX1    ITE$ERROR
         1 006011   000000 011000                    NOP     0

     1417    12865    4                     END;

     1418    12866    3                END;

     1419    12867    3             IF IT_PARTITION.MSOS_IOCHAN(J) THEN DO;

  12867  1 006012   200006 235100                    LDA     J,,AUTO
         1 006013   006015 605000 1                  TPL     s:12867+3
         1 006014   000044 035003                    ADLA    36,DU
         1 006015   000000 066405                    CMPB    filb='0'B
         1 006016   000043 000001 xsym               BDSC    IT_PARTITION+35,A        by=0,bit=0,n=1
         1 006017   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 006020   006034 600000 1                  TZE     s:12872

     1420    12868    3                  DQH$ = NI$CHT.DQH$(J);

  12868  1 006021   200006 235100                    LDA     J,,AUTO
         1 006022   000001 735000                    ALS     1
         1 006023   000000 470400 xsym               LDP0    NI$CHT$
         1 006024   000000 236105                    LDQ     0,AL,PR0
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:224  
         1 006025   200173 756100                    STQ     DQH$,,AUTO

     1421    12869    3                  DQH$->NI$DQH.STATUS.DOWN = '1'B;

  12869  1 006026   200173 471500                    LDP1    DQH$,,AUTO
         1 006027   200000 236003                    LDQ     65536,DU
         1 006030   100001 256100                    ORSQ    1,,PR1

     1422    12870    3                  DQH$->NI$DQH.STATUS.MSOS_PART = '1'B;

  12870  1 006031   200173 471500                    LDP1    DQH$,,AUTO
         1 006032   001000 236003                    LDQ     512,DU
         1 006033   100001 256100                    ORSQ    1,,PR1

     1423    12871    3                END;

     1424    12872    2           END;

  12872  1 006034   200005 054100                    AOS     I,,AUTO
         1 006035   000000 236000 xsym               LDQ     KI_MXFE
         1 006036   005732 604000 1                  TMI     s:12857
         1 006037   200005 116100                    CMPQ    I,,AUTO
         1 006040   005732 605000 1                  TPL     s:12857

     1425    12873        /**/
     1426    12874    1        FPT_SYSCON.V.COMPONENT# = %IOM##;

  12874  1 006041   000005 236003                    LDQ     5,DU
         1 006042   200206 552120                    STBQ    FPT_SYSCON+4,'20'O,AUTO

     1427    12875    2        DO I = 0 TO NI_IOMS - 1;

  12875  1 006043   200005 450100                    STZ     I,,AUTO
         1 006044   006130 710000 1                  TRA     s:12888+1

     1428    12876    3             IF IT_PARTITION.IOCHAN(I*%N_MAXCHANS) THEN DO;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:225  
  12876  1 006045   200005 235100                    LDA     I,,AUTO
         1 006046   000007 735000                    ALS     7
         1 006047   006051 605000 1                  TPL     s:12876+4
         1 006050   000044 035003                    ADLA    36,DU
         1 006051   000000 066405                    CMPB    filb='0'B
         1 006052   000012 000001 xsym               BDSC    IT_PARTITION+10,A        by=0,bit=0,n=1
         1 006053   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 006054   006127 600000 1                  TZE     s:12888

     1429    12877    3                  FPT_SYSCON.V.IOM# = I;

  12877  1 006055   200005 236100                    LDQ     I,,AUTO
         1 006056   000011 736000                    QLS     9
         1 006057   200206 552110                    STBQ    FPT_SYSCON+4,'10'O,AUTO

     1430    12878    4                  CALL ITK$TDP$SYSCON( , ,FPT_SYSCON.V,RSLT,ERR) WHENALTRETURN DO;

  12878  1 006060   200010 630500                    EPPR0   ERR,,AUTO
         1 006061   200266 450500                    STP0    DQH$+6,,AUTO
         1 006062   200024 631500                    EPPR1   RSLT,,AUTO
         1 006063   200265 451500                    STP1    DQH$+5,,AUTO
         1 006064   200206 633500                    EPPR3   FPT_SYSCON+4,,AUTO
         1 006065   200264 453500                    STP3    DQH$+4,,AUTO
         1 006066   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 006067   000001 235000 xsym               LDA     B_VECTNIL+1
         1 006070   200262 757100                    STAQ    DQH$+2,,AUTO
         1 006071   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006072   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 006073   000000 701000 xent               TSX1    ITK$TDP$SYSCON
         1 006074   006076 702000 1                  TSX2    s:12879
         1 006075   006127 710000 1                  TRA     s:12888

     1431    12879    4                       TEXT_C.L = 5;

  12879  1 006076   005000 236003                    LDQ     2560,DU
         1 006077   200011 552140                    STBQ    TEXT_C,'40'O,AUTO

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:226  
     1432    12880    4                       TEXT_C.T = 'IOM ?';

  12880  1 006100   040100 100400                    MLR     fill='040'O
         1 006101   000166 000005 0                  ADSC9   NI_ENTADDR+45            cn=0,n=5
         1 006102   200011 200012                    ADSC9   TEXT_C,,AUTO             cn=1,n=10

     1433    12881    4                       CALL BINCHAR (SUBSTR(TEXT_C.T,4,1),I);

  12881  1 006103   000100 301500                    BTD
         1 006104   200005 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         1 006105   200012 230001                    NDSC9   TEXT_C+1,,AUTO           cn=1,s=nosgn,sf=0,n=1

     1434    12882    4                       CALL ITE$ERROR (%E$PART, ADDR(TEXT_C));

  12882  1 006106   200011 630500                    EPPR0   TEXT_C,,AUTO
         1 006107   200262 450500                    STP0    DQH$+2,,AUTO
         1 006110   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 006111   200265 451500                    STP1    DQH$+5,,AUTO
         1 006112   000057 236000 2                  LDQ     47
         1 006113   200264 756100                    STQ     DQH$+4,,AUTO
         1 006114   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 006115   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006116   000000 701000 xent               TSX1    ITE$ERROR
         1 006117   000000 011000                    NOP     0

     1435    12883    4                       CALL ITE$ERROR (%E$TRYAGAIN);

  12883  1 006120   000061 630400 2                  EPPR0   49
         1 006121   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006122   000000 701000 xent               TSX1    ITE$ERROR
         1 006123   000000 011000                    NOP     0

     1436    12884    4                       CALL ITF$FREEZE;     /* can't go on, if unable to partition

  12884  1 006124   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006125   000000 701000 xent               TSX1    ITF$FREEZE
         1 006126   000000 011000                    NOP     0
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:227  

     1437    12885                                                    an IOM at this point  */
     1438    12886    4                     END;

     1439    12887    3                END;

     1440    12888    2           END;

  12888  1 006127   200005 054100                    AOS     I,,AUTO
         1 006130   200005 236100                    LDQ     I,,AUTO
         1 006131   000000 116000 xsym               CMPQ    NI_IOMS
         1 006132   006045 604000 1                  TMI     s:12876

     1441    12889        /**/
     1442    12890    1        CALL ITX$INITS;                    /* Initialize FEPS, CQ, MSOS ect. */

  12890  1 006133   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006134   000000 701000 xent               TSX1    ITX$INITS
         1 006135   000000 011000                    NOP     0

     1443    12891    1        CALL ITX$INITS2;                   /* Finish initializing file system   */

  12891  1 006136   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006137   000000 701000 xent               TSX1    ITX$INITS2
         1 006140   000000 011000                    NOP     0

     1444    12892        /**/
     1445    12893    1        CALL SSC$MONTIMR(500,ENTADDR(NII$LIP),0); /* START LOST INTERRUPT POLLER */

  12893  1 006141   000000 636000 xent               EAQ     NII$LIP
         1 006142   200262 756100                    STQ     DQH$+2,,AUTO
         1 006143   000010 236000 2                  LDQ     8
         1 006144   200265 756100                    STQ     DQH$+5,,AUTO
         1 006145   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006146   200264 450500                    STP0    DQH$+4,,AUTO
         1 006147   000063 236000 2                  LDQ     51
         1 006150   200263 756100                    STQ     DQH$+3,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:228  
         1 006151   200263 630500                    EPPR0   DQH$+3,,AUTO
         1 006152   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 006153   000000 701000 xent               TSX1    SSC$MONTIMR
         1 006154   000000 011000                    NOP     0

     1446    12894              /* THEN, START THE EDAC MEMORY CHECKING (NOT USEFUL ON AN S1000) */
     1447    12895    1        IF HW_EDAC THEN CALL SSC$MONTIMR(6000,ENTADDR(HFB$EDAC),0);

  12895  1 006155   000000 234000 xsym               SZN     HW_EDAC
         1 006156   006173 605000 1                  TPL     s:12896

  12895  1 006157   000000 636000 xent               EAQ     HFB$EDAC
         1 006160   200262 756100                    STQ     DQH$+2,,AUTO
         1 006161   000010 236000 2                  LDQ     8
         1 006162   200265 756100                    STQ     DQH$+5,,AUTO
         1 006163   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006164   200264 450500                    STP0    DQH$+4,,AUTO
         1 006165   000065 236000 2                  LDQ     53
         1 006166   200263 756100                    STQ     DQH$+3,,AUTO
         1 006167   200263 630500                    EPPR0   DQH$+3,,AUTO
         1 006170   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 006171   000000 701000 xent               TSX1    SSC$MONTIMR
         1 006172   000000 011000                    NOP     0

     1448    12896    1        IF H_RPM_FLG THEN CALL HFC$LCON;

  12896  1 006173   000000 234000 xsym               SZN     H_RPM_FLG
         1 006174   006200 605000 1                  TPL     s:12901

  12896  1 006175   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006176   000000 701000 xent               TSX1    HFC$LCON
         1 006177   000000 011000                    NOP     0

     1449    12897        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:229  
     1450    12898        /**/
     1451    12899        /*  GET READY TO GO TO GHOST1 */
     1452    12900        /**/
     1453    12901    1        CALL SSS$TIME;                     /* START MONITOR EXECUTION TIME       */

  12901  1 006200   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006201   000000 701000 xent               TSX1    SSS$TIME
         1 006202   000000 011000                    NOP     0

     1454    12902    1        I = %JG_GHOST1#;

  12902  1 006203   000001 235007                    LDA     1,DL
         1 006204   200005 755100                    STA     I,,AUTO

     1455    12903    1        USER$ = ADDR(B$USRT$ -> B$USER(I));

  12903  1 006205   200005 236100                    LDQ     I,,AUTO
         1 006206   000026 736000                    QLS     22
         1 006207   000000 036000 xsym               ADLQ    B$USRT$
         1 006210   200177 756100                    STQ     USER$,,AUTO

     1456    12904    1        S_CUIS(%M_GHOST#) = 1;

  12904  1 006211   000002 755000 xsym               STA     S_CUIS+2

     1457    12905    1        S_CTUIS = 1;

  12905  1 006212   000000 755000 xsym               STA     S_CTUIS

     1458    12906        /**/
     1459    12907    1        USER$ -> B$U.FLG = %U_RTR;

  12907  1 006213   000030 236000 xsym               LDQ     B_VECTNIL+24
         1 006214   200177 470500                    LDP0    USER$,,AUTO
         1 006215   000000 756100                    STQ     0,,PR0

     1460    12908    1        USER$ -> B$U.PCT = B$JIT$ -> B$JIT.PPC; /* COUNT FOR JIT,HJIT,ROSEG   */
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:230  

  12908  1 006216   000000 471400 xsym               LDP1    B$JIT$
         1 006217   100207 720100                    LXL0    135,,PR1
         1 006220   000010 740100                    STX0    8,,PR0

     1461    12909    1        USER$ -> B$U.PT = B$UPT$ -> B$MAP.RPN(0)*(1024/HW_PTB_UNITS);
             12909                 /* PAGE TABLE ADDRESS    */

  12909  1 006221   002000 236007                    LDQ     1024,DL
         1 006222   000000 506000 xsym               DIV     HW_PTB_UNITS
         1 006223   200262 756100                    STQ     DQH$+2,,AUTO
         1 006224   000000 473400 xsym               LDP3    B$UPT$
         1 006225   300000 236100                    LDQ     0,,PR3
         1 006226   000022 772000                    QRL     18
         1 006227   200262 402100                    MPY     DQH$+2,,AUTO
         1 006230   000000 620006                    EAX0    0,QL
         1 006231   000014 740100                    STX0    12,,PR0

     1462    12910    1        USER$ -> B$U.PRIOB = S_PRIOB(%M_GHOST#)+4; /* HELP GHOST1 RUN FASSSST */

  12910  1 006232   000002 236000 xsym               LDQ     S_PRIOB+2
         1 006233   000004 036007                    ADLQ    4,DL
         1 006234   000014 736000                    QLS     12
         1 006235   000011 752104                    STCQ    9,'04'O,PR0

     1463    12911    1        USER$ -> B$U.PRIO = S_PRIOB(%M_GHOST#)+4; /* HELP GHOST1 RUN FASSSST  */

  12911  1 006236   000002 236000 xsym               LDQ     S_PRIOB+2
         1 006237   000004 036007                    ADLQ    4,DL
         1 006240   000022 736000                    QLS     18
         1 006241   000011 752110                    STCQ    9,'10'O,PR0

     1464    12912    1        USER$ -> B$U.SYSID = %JG_GHOST1#;

  12912  1 006242   000001 221003                    LDX1    1,DU
         1 006243   000014 441100                    SXL1    12,,PR0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:231  
     1465    12913    1        USER$ -> B$U.MODE = %M_GHOST#;

  12913  1 006244   000200 236007                    LDQ     128,DL
         1 006245   000011 752102                    STCQ    9,'02'O,PR0

     1466    12914        /**/
     1467    12915    1        B$JIT$ -> B$JIT.SYSID = %JG_GHOST1#;

  12915  1 006246   100000 441100                    SXL1    0,,PR1

     1468    12916    1        B$JIT$ -> B$JIT.USER = I;

  12916  1 006247   000000 471400 xsym               LDP1    B$JIT$
         1 006250   200005 236100                    LDQ     I,,AUTO
         1 006251   000022 736000                    QLS     18
         1 006252   100000 552120                    STBQ    0,'20'O,PR1

     1469    12917    1        B$JIT$ -> B$JIT.MRT = BITBIN('377777777777'O);

  12917  1 006253   000031 235000 xsym               LDA     B_VECTNIL+25
         1 006254   000000 471400 xsym               LDP1    B$JIT$
         1 006255   100276 755100                    STA     190,,PR1

     1470    12918    1        B$JIT$ -> B$JIT.ACCN = ':SYS';

  12918  1 006256   040100 100400                    MLR     fill='040'O
         1 006257   000117 000004 0                  ADSC9   NI_ENTADDR+6             cn=0,n=4
         1 006260   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

     1471    12919    1        B$JIT$ -> B$JIT.FACCN = ':SYS';

  12919  1 006261   000117 236000 0                  LDQ     NI_ENTADDR+6
         1 006262   000044 737000                    LLS     36
         1 006263   000035 236000 xsym               LDQ     B_VECTNIL+29
         1 006264   100006 757100                    STAQ    6,,PR1

     1472    12920    1        B$JIT$ -> B$JIT.PRIV.ACTIVE = ~%PR_FMEFT#;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:232  

  12920  1 006265   000030 236000 xsym               LDQ     B_VECTNIL+24
         1 006266   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 006267   100013 756100                    STQ     11,,PR1

     1473    12921    1        B$JIT$ -> B$JIT.PRIV.JOB = ~%PR_FMEFT#;

  12921  1 006270   000030 236000 xsym               LDQ     B_VECTNIL+24
         1 006271   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 006272   100015 756100                    STQ     13,,PR1

     1474    12922    1        B$JIT$ -> B$JIT.LOCK = '777777777777777777777777'O;

  12922  1 006273   000170 237000 0                  LDAQ    NI_ENTADDR+47
         1 006274   100154 757100                    STAQ    108,,PR1

     1475    12923    1        B$JIT$ -> B$JIT.UNAME = 'GHOST1';

  12923  1 006275   040100 100400                    MLR     fill='040'O
         1 006276   000172 000006 0                  ADSC9   NI_ENTADDR+49            cn=0,n=6
         1 006277   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12

     1476    12924    1        B$JIT$ -> B$JIT.JOBNAME = ' ';

  12924  1 006300   040100 100400                    MLR     fill='040'O
         1 006301   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 006302   100156 200037                    ADSC9   110,,PR1                 cn=1,n=31

     1477    12925    1        B$JIT$ -> B$JIT.MODE = %M_GHOST#;

  12925  1 006303   100000 236100                    LDQ     0,,PR1
         1 006304   000066 376000 2                  ANQ     54
         1 006305   100000 276003                    ORQ     32768,DU
         1 006306   100000 756100                    STQ     0,,PR1

     1478    12926    1        B$JIT$ -> B$JIT.MAXTMPDP=99999;

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:233  
  12926  1 006307   303237 236007                    LDQ     99999,DL
         1 006310   000000 471400 xsym               LDP1    B$JIT$
         1 006311   100241 756100                    STQ     161,,PR1

     1479    12927    1        B$JIT$ -> B$JIT.PRDPRM =99999;

  12927  1 006312   100242 756100                    STQ     162,,PR1

     1480    12928    1        B$JIT$ -> B$JIT.DO$ = ADDR(NIL);

  12928  1 006313   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 006314   100233 756100                    STQ     155,,PR1

     1481    12929    1        B$JIT$ -> B$JIT.FPSN = ' ';

  12929  1 006315   040100 100400                    MLR     fill='040'O
         1 006316   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 006317   100021 000006                    ADSC9   17,,PR1                  cn=0,n=6

     1482    12930    1        B$JIT$ -> B$JIT.HPSN = 'SYS   ';

  12930  1 006320   040100 100400                    MLR     fill='040'O
         1 006321   000155 000006 0                  ADSC9   NI_ENTADDR+36            cn=0,n=6
         1 006322   100234 000006                    ADSC9   156,,PR1                 cn=0,n=6

     1483    12931    1        B$JIT$ -> B$JIT.OUTPRIO = 7;

  12931  1 006323   007000 236007                    LDQ     3584,DL
         1 006324   100022 552110                    STBQ    18,'10'O,PR1

     1484    12932        /**/
     1485    12933    1        CALL SSR$CHSE(I);                  /* MAKE HIM EXECUTABLE                */

  12933  1 006325   200005 633500                    EPPR3   I,,AUTO
         1 006326   200262 453500                    STP3    DQH$+2,,AUTO
         1 006327   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006330   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:234  
         1 006331   000000 701000 xent               TSX1    SSR$CHSE
         1 006332   000000 011000                    NOP     0

     1486    12934        /**/
     1487    12935        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:235  
     1488    12936        /*  The following code was taken from ITK$KILLTIG, and put here when
     1489    12937            B$ROGERS was split into 2 overlays,  the new one being B$ANDERSON     */
     1490    12938        /**/
     1491    12939    1        CALL SSW$BYPASSCACHE;

  12939  1 006333   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006334   000000 701000 xent               TSX1    SSW$BYPASSCACHE
         1 006335   000000 011000                    NOP     0

     1492    12940    1        CALL SSW$LOGSTRT(0);               /* LOG MASTER START                   */

  12940  1 006336   000010 630400 2                  EPPR0   8
         1 006337   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006340   000000 701000 xent               TSX1    SSW$LOGSTRT
         1 006341   000000 011000                    NOP     0

     1493    12941    2        DO I = 1 TO S_NSCPU;               /* START SLAVES            */

  12941  1 006342   000001 235007                    LDA     1,DL
         1 006343   200005 755100                    STA     I,,AUTO
         1 006344   006507 710000 1                  TRA     s:12978+1

     1494    12942    2             CPUNUM.COUNT = SIZEC(CPUNUM.TEXT);

  12942  1 006345   005000 236003                    LDQ     2560,DU
         1 006346   200014 552140                    STBQ    CPUNUM,'40'O,AUTO

     1495    12943    2             CPUNUM.TEXT = 'CPU';

  12943  1 006347   040100 100400                    MLR     fill='040'O
         1 006350   000174 000003 0                  ADSC9   NI_ENTADDR+51            cn=0,n=3
         1 006351   200014 200005                    ADSC9   CPUNUM,,AUTO             cn=1,n=5

     1496    12944    2             CALL BINCHAR(SUBSTR(CPUNUM.TEXT,SIZEC(CPUNUM.TEXT)-1,1),S_PORTNR(I));

  12944  1 006352   200005 720100                    LXL0    I,,AUTO
         1 006353   000000 235010 xsym               LDA     S_PORTNR,X0
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:236  
         1 006354   000044 773000                    LRL     36
         1 006355   200262 757100                    STAQ    DQH$+2,,AUTO
         1 006356   000100 301500                    BTD
         1 006357   200262 000010                    NDSC9   DQH$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         1 006360   200015 230001                    NDSC9   CPUNUM+1,,AUTO           cn=1,s=nosgn,sf=0,n=1

     1497    12945    2             IF (IT_BOOTFLAG < I_DISKBOOT) OR (S_MPSTATE(I) = %SS_PAUSE# ) OR

  12945  1 006361   000000 235000 xsym               LDA     IT_BOOTFLAG
         1 006362   000007 115007                    CMPA    7,DL
         1 006363   006371 602000 1                  TNC     s:12947
         1 006364   000000 235010 xsym               LDA     S_MPSTATE,X0
         1 006365   000001 115007                    CMPA    1,DL
         1 006366   006371 600000 1                  TZE     s:12947
         1 006367   000002 115007                    CMPA    2,DL
         1 006370   006506 601000 1                  TNZ     s:12978

     1498    12946    3                  (S_MPSTATE(I) = %SS_RUN#) THEN DO;

     1499    12947    3                  S_MPSTATE(I)=0;          /* INITIALIZE STATE CODE TO STOPPED   */

  12947  1 006371   000000 450010 xsym               STZ     S_MPSTATE,X0

     1500    12948    4                  IF H_RPM_FLG THEN DO;

  12948  1 006372   000000 234000 xsym               SZN     H_RPM_FLG
         1 006373   006415 605000 1                  TPL     s:12959

     1501    12949    5                       IF H_DPS8000_SCU_CONF_REG.PORTS(S_PORTNR(I)) = '0'B THEN DO;

  12949  1 006374   000000 235010 xsym               LDA     S_PORTNR,X0
         1 006375   000000 066405                    CMPB    filb='0'B
         1 006376   000000 610001 xsym               BDSC    H_DPS8000_SCU_CONF_REG,A by=3,bit=1,n=1
         1 006377   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 006400   006415 601000 1                  TNZ     s:12959

     1502    12950    6                            IF SUBSTR(H_DPS8000_CONFIG_NAME,7,1) = 'R' THEN DO;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:237  

  12950  1 006401   000001 236000 xsym               LDQ     H_DPS8000_CONFIG_NAME+1
         1 006402   000777 376007                    ANQ     511,DL
         1 006403   000122 116007                    CMPQ    82,DL
         1 006404   006412 601000 1                  TNZ     s:12955

     1503    12951    6                                 S_MPSTATE(I) = %SS_REL#;

  12951  1 006405   000003 236007                    LDQ     3,DL
         1 006406   000000 756010 xsym               STQ     S_MPSTATE,X0

     1504    12952    6                                 ERR = %E$CPUREL;

  12952  1 006407   000261 235007                    LDA     177,DL
         1 006410   200010 755100                    STA     ERR,,AUTO

     1505    12953    6                               END;

  12953  1 006411   006414 710000 1                  TRA     s:12956

     1506    12954    5                            ELSE
     1507    12955    5                                 ERR = %E$CPUWONTSTART;

  12955  1 006412   000204 236007                    LDQ     132,DL
         1 006413   200010 756100                    STQ     ERR,,AUTO

     1508    12956    5                            GOTO WONT_START;

  12956  1 006414   006474 710000 1                  TRA     WONT_START

     1509    12957    5                          END;
     1510    12958    4                     END;
     1511    12959    3                  CALL HFB$ENAPORT(S_PORTNR(I)); /* ENABLE SCU PORT MASK          */

  12959  1 006415   000000 630410 xsym               EPPR0   S_PORTNR,X0
         1 006416   200262 450500                    STP0    DQH$+2,,AUTO
         1 006417   200262 630500                    EPPR0   DQH$+2,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:238  
         1 006420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006421   000000 701000 xent               TSX1    HFB$ENAPORT
         1 006422   000000 011000                    NOP     0

     1512    12960    3                  CALL HFC$STCPU(I);       /* GET HIM FROM STOPPED TO PAUSED     */

  12960  1 006423   200005 630500                    EPPR0   I,,AUTO
         1 006424   200262 450500                    STP0    DQH$+2,,AUTO
         1 006425   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006426   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006427   000000 701000 xent               TSX1    HFC$STCPU
         1 006430   000000 011000                    NOP     0

     1513    12961    3                  CALL SSS$CACHEBP;        /* BYPASS CACHE AS HE IS RUNNING      */

  12961  1 006431   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006432   000000 701000 xent               TSX1    SSS$CACHEBP
         1 006433   000000 011000                    NOP     0

     1514    12962    3                  IF S_MPSTATE(I)=1 THEN

  12962  1 006434   200005 720100                    LXL0    I,,AUTO
         1 006435   000000 235010 xsym               LDA     S_MPSTATE,X0
         1 006436   000001 115007                    CMPA    1,DL
         1 006437   006464 601000 1                  TNZ     s:12972

     1515    12963                                                /* HE IS PAUSED, GOING TO RUN         */
     1516    12964    4                  DO;

     1517    12965    4                       S_NSCPUA=S_NSCPUA+1;

  12965  1 006440   000000 236000 xsym               LDQ     S_NSCPUA
         1 006441   000001 036007                    ADLQ    1,DL
         1 006442   000000 756000 xsym               STQ     S_NSCPUA

     1518    12966    4                       CALL SSW$LOGSTRT(I);

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:239  
  12966  1 006443   200005 630500                    EPPR0   I,,AUTO
         1 006444   200262 450500                    STP0    DQH$+2,,AUTO
         1 006445   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006446   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006447   000000 701000 xent               TSX1    SSW$LOGSTRT
         1 006450   000000 011000                    NOP     0

     1519    12967    4                       CALL ITE$ERROR(%E$CPUSTART,ADDR(CPUNUM));

  12967  1 006451   200014 630500                    EPPR0   CPUNUM,,AUTO
         1 006452   200262 450500                    STP0    DQH$+2,,AUTO
         1 006453   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 006454   200265 451500                    STP1    DQH$+5,,AUTO
         1 006455   000070 236000 2                  LDQ     56
         1 006456   200264 756100                    STQ     DQH$+4,,AUTO
         1 006457   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 006460   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006461   000000 701000 xent               TSX1    ITE$ERROR
         1 006462   000000 011000                    NOP     0

     1520    12968    4                     END;

  12968  1 006463   006506 710000 1                  TRA     s:12978

     1521    12969    3                  ELSE
     1522    12970                                                /* HE WOUDN'T START.                  */
     1523    12971    4                  DO;

     1524    12972    4                       ERR = %E$CPUWONTSTART;

  12972  1 006464   000204 236007                    LDQ     132,DL
         1 006465   200010 756100                    STQ     ERR,,AUTO

     1525    12973    4                       CALL HFB$DISPORT(S_PORTNR(I)); /* DISABLE SCU PORT MASK      */

  12973  1 006466   000000 630410 xsym               EPPR0   S_PORTNR,X0
         1 006467   200262 450500                    STP0    DQH$+2,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:240  
         1 006470   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006471   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006472   000000 701000 xent               TSX1    HFB$DISPORT
         1 006473   000000 011000                    NOP     0

     1526    12974    4   WONT_START:
     1527    12975    4                       CALL ITE$ERROR(ERR,ADDR(CPUNUM));

  12975  1 006474   200014 630500       WONT_START   EPPR0   CPUNUM,,AUTO
         1 006475   200262 450500                    STP0    DQH$+2,,AUTO
         1 006476   200262 631500                    EPPR1   DQH$+2,,AUTO
         1 006477   200265 451500                    STP1    DQH$+5,,AUTO
         1 006500   200010 633500                    EPPR3   ERR,,AUTO
         1 006501   200264 453500                    STP3    DQH$+4,,AUTO
         1 006502   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 006503   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006504   000000 701000 xent               TSX1    ITE$ERROR
         1 006505   000000 011000                    NOP     0

     1528    12976    4                     END;

     1529    12977    3                END;

     1530    12978    2           END;

  12978  1 006506   200005 054100                    AOS     I,,AUTO
         1 006507   000000 236000 xsym               LDQ     S_NSCPU
         1 006510   006345 604000 1                  TMI     s:12942
         1 006511   200005 116100                    CMPQ    I,,AUTO
         1 006512   006345 605000 1                  TPL     s:12942

     1531    12979    2        DO I = 1 TO S_NSCPU;               /* GET THEM ALL GOING AT ONCE         */

  12979  1 006513   000001 235007                    LDA     1,DL
         1 006514   200005 755100                    STA     I,,AUTO
         1 006515   006536 710000 1                  TRA     s:12984+1

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:241  
     1532    12980    2             CALL SSS$CACHEBP;

  12980  1 006516   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006517   000000 701000 xent               TSX1    SSS$CACHEBP
         1 006520   000000 011000                    NOP     0

     1533    12981    3             IF S_MPSTATE(I) = 1 THEN DO;

  12981  1 006521   200005 720100                    LXL0    I,,AUTO
         1 006522   000000 235010 xsym               LDA     S_MPSTATE,X0
         1 006523   000001 115007                    CMPA    1,DL
         1 006524   006535 601000 1                  TNZ     s:12984

     1534    12982    3                  CALL HFD$CNNCT(I,0);

  12982  1 006525   000010 236000 2                  LDQ     8
         1 006526   200263 756100                    STQ     DQH$+3,,AUTO
         1 006527   200005 630500                    EPPR0   I,,AUTO
         1 006530   200262 450500                    STP0    DQH$+2,,AUTO
         1 006531   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006532   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006533   000000 701000 xent               TSX1    HFD$CNNCT
         1 006534   000000 011000                    NOP     0

     1535    12983    3                END;

     1536    12984    2           END;

  12984  1 006535   200005 054100                    AOS     I,,AUTO
         1 006536   000000 236000 xsym               LDQ     S_NSCPU
         1 006537   006516 604000 1                  TMI     s:12980
         1 006540   200005 116100                    CMPQ    I,,AUTO
         1 006541   006516 605000 1                  TPL     s:12980

     1537    12985        /**/
     1538    12986    1        IF S_NSCPUA = 0

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:242  
  12986  1 006542   000000 235000 xsym               LDA     S_NSCPUA
         1 006543   006547 601000 1                  TNZ     s:12989

     1539    12987    1        THEN CALL SSW$USECACHE;            /* ONLY ONE CPU - USE CACHE      */

  12987  1 006544   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006545   000000 701000 xent               TSX1    SSW$USECACHE
         1 006546   000000 011000                    NOP     0

     1540    12988        /**/
     1541    12989    1        RETURN;

  12989  1 006547   000000 702200 xent               TSX2  ! X66_ARET

     1542    12990        /**/
     1543    12991        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:243  
     1544    12992    1   IOSPIN: PROC ;

  12992  1 006550   200254 741300       IOSPIN       STX1  ! ITW_FREEZE+2,,AUTO

     1545    12993
     1546    12994    2   DCL 1 I                 SBIN WORD ALIGNED AUTO ;
     1547    12995    2   DCL 1 J                 SBIN WORD ALIGNED AUTO ;
     1548    12996    2   DCL END_UTS UBIN AUTO;
     1549    12997    2   DCL 1 DQH$              PTR ALIGNED AUTO ;
     1550    12998
     1551    12999    2        CALL SSS$CURTIME (START_TIME) ;

  12999  1 006551   200240 630500                    EPPR0   START_TIME,,AUTO
         1 006552   200262 450500                    STP0    DQH$+2,,AUTO
         1 006553   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006554   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006555   000000 701000 xent               TSX1    SSS$CURTIME
         1 006556   000000 011000                    NOP     0

     1552    13000    2        ITW_FREEZE = FALSE ;

  13000  1 006557   200252 450100                    STZ     ITW_FREEZE,,AUTO

     1553    13001    2        CALL XUD$UTS_ADJ_25TH (END_UTS, START_TIME, WAIT_N_MINS * %UTS_25TH_MIN#);

  13001  1 006560   000072 236000 2                  LDQ     58
         1 006561   200264 756100                    STQ     DQH$+4,,AUTO
         1 006562   200240 630500                    EPPR0   START_TIME,,AUTO
         1 006563   200263 450500                    STP0    DQH$+3,,AUTO
         1 006564   200257 631500                    EPPR1   END_UTS,,AUTO
         1 006565   200262 451500                    STP1    DQH$+2,,AUTO
         1 006566   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006567   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 006570   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
         1 006571   000000 011000                    NOP     0

     1554    13002
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:244  
     1555    13003    3        DO UNTIL NOT IO_OUTSTANDING ;

     1556    13004    3             IO_OUTSTANDING = FALSE ;

  13004  1 006572   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 006573   200251 356100                    ANSQ    IO_OUTSTANDING,,AUTO

     1557    13005    4             DO I = 0 TO NI_IOMS-1 ;

  13005  1 006574   200255 450100                    STZ     I,,AUTO
         1 006575   006662 710000 1                  TRA     s:13021+1

     1558    13006    5                  DO J = 8 TO NI_CHANS(I) ;

  13006  1 006576   000010 235007                    LDA     8,DL
         1 006577   200256 755100                    STA     J,,AUTO
         1 006600   006654 710000 1                  TRA     s:13020+1

     1559    13007    5                       DQH$ = NI$CHT.DQH$(I*%N_MAXCHANS + J) ;

  13007  1 006601   200255 236100                    LDQ     I,,AUTO
         1 006602   000007 736000                    QLS     7
         1 006603   200256 036100                    ADLQ    J,,AUTO
         1 006604   000001 736000                    QLS     1
         1 006605   000000 470400 xsym               LDP0    NI$CHT$
         1 006606   000000 236106                    LDQ     0,QL,PR0
         1 006607   200260 756100                    STQ     DQH$,,AUTO

     1560    13008    5                       IF DQH$ ~= ADDR(NIL) THEN

  13008  1 006610   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 006611   006653 600000 1                  TZE     s:13020

     1561    13009    5                            IF DQH$->NI$DQH.STATE = %BUSY  AND

  13009  1 006612   200260 471500                    LDP1    DQH$,,AUTO
         1 006613   100001 236100                    LDQ     1,,PR1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:245  
         1 006614   000077 376007                    ANQ     63,DL
         1 006615   000005 116007                    CMPQ    5,DL
         1 006616   006647 601000 1                  TNZ     s:13018
         1 006617   200252 234100                    SZN     ITW_FREEZE,,AUTO
         1 006620   006647 605000 1                  TPL     s:13018

     1562    13010    6                                 ITW_FREEZE THEN DO ;

     1563    13011    6                                 TEXT_C.T = 'I-CCC' ;

  13011  1 006621   040100 100400                    MLR     fill='040'O
         1 006622   000175 000005 0                  ADSC9   NI_ENTADDR+52            cn=0,n=5
         1 006623   200011 200012                    ADSC9   TEXT_C,,AUTO             cn=1,n=10

     1564    13012    6                                 CALL BINCHAR (SUBSTR(TEXT_C.T,0,1),I) ;
             13012                                          /* iom number */

  13012  1 006624   000100 301500                    BTD
         1 006625   200255 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         1 006626   200011 230001                    NDSC9   TEXT_C,,AUTO             cn=1,s=nosgn,sf=0,n=1

     1565    13013    6                                 CALL BINCHAR (SUBSTR(TEXT_C.T,2,3),J) ;
             13013                                          /* chan number */

  13013  1 006627   000100 301500                    BTD
         1 006630   200256 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         1 006631   200011 630003                    NDSC9   TEXT_C,,AUTO             cn=3,s=nosgn,sf=0,n=3

     1566    13014    6                                 TEXT_C.L = 5 ; /* I-CCC */

  13014  1 006632   005000 236003                    LDQ     2560,DU
         1 006633   200011 552140                    STBQ    TEXT_C,'40'O,AUTO

     1567    13015    6                                 CALL ITE$ERROR (%E$CHANBUSY2LONG, ADDR(TEXT_C)) ;

  13015  1 006634   200011 633500                    EPPR3   TEXT_C,,AUTO
         1 006635   200262 453500                    STP3    DQH$+2,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:246  
         1 006636   200262 634500                    EPPR4   DQH$+2,,AUTO
         1 006637   200265 454500                    STP4    DQH$+5,,AUTO
         1 006640   000074 236000 2                  LDQ     60
         1 006641   200264 756100                    STQ     DQH$+4,,AUTO
         1 006642   200264 630500                    EPPR0   DQH$+4,,AUTO
         1 006643   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006644   000000 701000 xent               TSX1    ITE$ERROR
         1 006645   000000 011000                    NOP     0

     1568    13016    6                               END ;

  13016  1 006646   006653 710000 1                  TRA     s:13020

     1569    13017    5                            ELSE
     1570    13018    5                                 IF DQH$->NI$DQH.STATE = %BUSY THEN

  13018  1 006647   000005 116007                    CMPQ    5,DL
         1 006650   006653 601000 1                  TNZ     s:13020

     1571    13019    5                                      IO_OUTSTANDING = TRUE ;

  13019  1 006651   400000 236003                    LDQ     -131072,DU
         1 006652   200251 256100                    ORSQ    IO_OUTSTANDING,,AUTO

     1572    13020    5                     END ;

  13020  1 006653   200256 054100                    AOS     J,,AUTO
         1 006654   200255 720100                    LXL0    I,,AUTO
         1 006655   000000 236010 xsym               LDQ     NI_CHANS,X0
         1 006656   006601 604000 1                  TMI     s:13007
         1 006657   200256 116100                    CMPQ    J,,AUTO
         1 006660   006601 605000 1                  TPL     s:13007

     1573    13021    4                END ;

  13021  1 006661   200255 054100                    AOS     I,,AUTO
         1 006662   200255 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:247  
         1 006663   000000 116000 xsym               CMPQ    NI_IOMS
         1 006664   006576 604000 1                  TMI     s:13006

     1574    13022    4             IF ITW_FREEZE THEN DO ;

  13022  1 006665   200252 234100                    SZN     ITW_FREEZE,,AUTO
         1 006666   006676 605000 1                  TPL     s:13026

     1575    13023    4                  CALL ITE$ERROR(%E$TRYAGAIN) ;

  13023  1 006667   000061 630400 2                  EPPR0   49
         1 006670   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006671   000000 701000 xent               TSX1    ITE$ERROR
         1 006672   000000 011000                    NOP     0

     1576    13024    4                  CALL ITF$FREEZE ;        /* BYE-BYE */

  13024  1 006673   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006674   000000 701000 xent               TSX1    ITF$FREEZE
         1 006675   000000 011000                    NOP     0

     1577    13025    4                END ;                      /*FREEZE*/

     1578    13026    3             CALL SSS$CURTIME (LAP_TIME) ;

  13026  1 006676   200241 630500                    EPPR0   LAP_TIME,,AUTO
         1 006677   200262 450500                    STP0    DQH$+2,,AUTO
         1 006700   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006702   000000 701000 xent               TSX1    SSS$CURTIME
         1 006703   000000 011000                    NOP     0

     1579    13027    3             IF LAP_TIME > END_UTS THEN

  13027  1 006704   200257 236100                    LDQ     END_UTS,,AUTO
         1 006705   200241 116100                    CMPQ    LAP_TIME,,AUTO
         1 006706   006711 603000 1                  TRC     s:13029
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:248  

     1580    13028    3                  ITW_FREEZE = TRUE ;

  13028  1 006707   400000 236003                    LDQ     -131072,DU
         1 006710   200252 756100                    STQ     ITW_FREEZE,,AUTO

     1581    13029    3           END ;

  13029  1 006711   200251 234100                    SZN     IO_OUTSTANDING,,AUTO
         1 006712   006572 604000 1                  TMI     s:13004

     1582    13030
     1583    13031    2        RETURN ;

  13031  1 006713   200254 221300                    LDX1  ! ITW_FREEZE+2,,AUTO
         1 006714   000001 702211                    TSX2  ! 1,X1

     1584    13032
     1585    13033    2   END IOSPIN ;
     1586    13034        %EJECT ;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:249  
     1587    13035        /**/
     1588    13036    1   DISK_ERR:
     1589    13037    1        CALL ITE$ERROR(%E$DISKERR);        /* ERROR READ/WRITING DISK       */

  13037  1 006715   000076 630400 2     DISK_ERR     EPPR0   62
         1 006716   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006717   000000 701000 xent               TSX1    ITE$ERROR
         1 006720   000000 011000                    NOP     0

     1590    13038    1        CALL ITF$FREEZE;

  13038  1 006721   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006722   000000 701000 xent               TSX1    ITF$FREEZE
         1 006723   000000 011000                    NOP     0

  13031  1 006724                       NO_FW        null
     1591    13039        /**/
     1592    13040        /**/
     1593    13041    1   NO_FW: ;
     1594    13042    1   FW_ERR:
     1595    13043    1        CALL ITE$ERROR(%E$FWERR);

  13043  1 006724   000100 630400 2     FW_ERR       EPPR0   64
         1 006725   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006726   000000 701000 xent               TSX1    ITE$ERROR
         1 006727   000000 011000                    NOP     0

     1596    13044    1        I = I+1;

  13044  1 006730   200005 054100                    AOS     I,,AUTO

     1597    13045    1        GOTO NEXTFWDEV;

  13045  1 006731   003766 710000 1                  TRA     NEXTFWDEV

     1598    13046        /**/
     1599    13047    1   CONFIG_ERR:
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:250  
     1600    13048    1        CALL ITE$ERROR(%E$CONFIGERR);

  13048  1 006732   000102 630400 2     CONFIG_ERR   EPPR0   66
         1 006733   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006734   000000 701000 xent               TSX1    ITE$ERROR
         1 006735   000000 011000                    NOP     0

     1601    13049    1        CALL ITF$FREEZE;

  13049  1 006736   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006737   000000 701000 xent               TSX1    ITF$FREEZE
         1 006740   000000 011000                    NOP     0

     1602    13050        /**/
     1603    13051    1   CVM_ERR:
     1604    13052    1        CALL ITE$ERROR(%E$CVMERR);

  13052  1 006741   000104 630400 2     CVM_ERR      EPPR0   68
         1 006742   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 006743   000000 701000 xent               TSX1    ITE$ERROR
         1 006744   000000 011000                    NOP     0

     1605    13053    1        CALL ITF$FREEZE;

  13053  1 006745   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 006746   000000 701000 xent               TSX1    ITF$FREEZE
         1 006747   000000 011000                    NOP     0

     1606    13054    1   ITW$ALLOC_ERR:
     1607    13055    1        CALL ITF$FREEZE;

  13055  1 006750   000002 631400 xsym  ITW$ALLOC_E* EPPR1   B_VECTNIL+2
         1 006751   000000 701000 xent               TSX1    ITF$FREEZE
         1 006752   000000 011000                    NOP     0
         1 006753   007044 710000 1                  TRA     s:13088

     1608    13056        %EJECT;
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:251  
     1609    13057        /**/
     1610    13058    1   FW_MOVE: PROC ALTRET;

  13058  1 006754   200254 741300       FW_MOVE      STX1  ! ITW_FREEZE+2,,AUTO

     1611    13059        /**/
     1612    13060        /*I*     NAME:     FW_MOVE
     1613    13061                DESCRIPTION: FW_MOVE is used by TIGR to read the FW from the
     1614    13062                         system disk into a data segment or TIGR data area
     1615    13063                         to load the MPCs. When called:
     1616    13064                            FWDA = first DA of this FW.
     1617    13065                            FWSIZE = size in words of this FW.
     1618    13066                            REQ$ = pointer to where to put the FW.
     1619    13067        */
     1620    13068    3        DO WHILE (FWSIZE >= 1024);

  13068  1 006755   200044 235100                    LDA     FWSIZE,,AUTO
         1 006756   002000 115007                    CMPA    1024,DL
         1 006757   007007 604000 1                  TMI     s:13076

     1621    13069    3             CALL ITQ$DREAD(DBUF$,FWDA) ALTRET (DISK_ERR);

  13069  1 006760   200043 630500                    EPPR0   FWDA,,AUTO
         1 006761   200263 450500                    STP0    DQH$+3,,AUTO
         1 006762   200200 631500                    EPPR1   DBUF$,,AUTO
         1 006763   200262 451500                    STP1    DQH$+2,,AUTO
         1 006764   200262 630500                    EPPR0   DQH$+2,,AUTO
         1 006765   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 006766   000000 701000 xent               TSX1    ITQ$DREAD
         1 006767   007042 702000 1                  TSX2    DISK_ERR

     1622    13070    3             REQ$ -> B$PAGE = DBUF$ -> B$PAGE;

  13070  1 006770   200200 470500                    LDP0    DBUF$,,AUTO
         1 006771   010000 220003                    LDX0    4096,DU
         1 006772   200171 471500                    LDP1    REQ$,,AUTO
         1 006773   000140 100540                    MLR     fill='000'O
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:252  
         1 006774   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 006775   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

     1623    13071    3             REQ$ = PINCRW(REQ$,1024);

  13071  1 006776   200171 236100                    LDQ     REQ$,,AUTO
         1 006777   002000 036003                    ADLQ    1024,DU
         1 007000   200171 756100                    STQ     REQ$,,AUTO

     1624    13072    3             FWSIZE = FWSIZE-1024;

  13072  1 007001   002000 336007                    LCQ     1024,DL
         1 007002   200044 056100                    ASQ     FWSIZE,,AUTO

     1625    13073    3             FWDA = FWDA+1;

  13073  1 007003   200043 054100                    AOS     FWDA,,AUTO

     1626    13074    3           END;

  13074  1 007004   200044 235100                    LDA     FWSIZE,,AUTO
         1 007005   002000 115007                    CMPA    1024,DL
         1 007006   006760 605000 1                  TPL     s:13069

     1627    13075        /**/
     1628    13076    3        IF (FWSIZE ~=0) THEN DO;

  13076  1 007007   000000 115003                    CMPA    0,DU
         1 007010   007040 600000 1                  TZE     s:13083

     1629    13077    3             CALL ITQ$DREAD(DBUF$,FWDA) ALTRET(DISK_ERR);

  13077  1 007011   200043 630500                    EPPR0   FWDA,,AUTO
         1 007012   200263 450500                    STP0    DQH$+3,,AUTO
         1 007013   200200 631500                    EPPR1   DBUF$,,AUTO
         1 007014   200262 451500                    STP1    DQH$+2,,AUTO
         1 007015   200262 630500                    EPPR0   DQH$+2,,AUTO
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:253  
         1 007016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 007017   000000 701000 xent               TSX1    ITQ$DREAD
         1 007020   007042 702000 1                  TSX2    DISK_ERR

     1630    13078    4             DO K = 0 TO FWSIZE-1;

  13078  1 007021   200007 450100                    STZ     K,,AUTO
         1 007022   007031 710000 1                  TRA     s:13080+1

     1631    13079    4                  REQ$ -> B$PAGE.WRD(K) = DBUF$ -> B$PAGE.WRD(K);

  13079  1 007023   200200 470500                    LDP0    DBUF$,,AUTO
         1 007024   200007 720100                    LXL0    K,,AUTO
         1 007025   200171 471500                    LDP1    REQ$,,AUTO
         1 007026   000000 235110                    LDA     0,X0,PR0
         1 007027   100000 755110                    STA     0,X0,PR1

     1632    13080    4                END;

  13080  1 007030   200007 054100                    AOS     K,,AUTO
         1 007031   200007 236100                    LDQ     K,,AUTO
         1 007032   200044 116100                    CMPQ    FWSIZE,,AUTO
         1 007033   007023 604000 1                  TMI     s:13079

     1633    13081    3             REQ$ = PINCRW(REQ$,FWSIZE);

  13081  1 007034   200044 236100                    LDQ     FWSIZE,,AUTO
         1 007035   000022 736000                    QLS     18
         1 007036   200171 036100                    ADLQ    REQ$,,AUTO
         1 007037   200171 756100                    STQ     REQ$,,AUTO

     1634    13082    3           END;

     1635    13083    2        RETURN;

  13083  1 007040   200254 221300                    LDX1  ! ITW_FREEZE+2,,AUTO
         1 007041   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:254  

     1636    13084        /**/
     1637    13085    2   DISK_ERR:
     1638    13086    2        ALTRETURN;

  13086  1 007042   200254 221300       DISK_ERR     LDX1  ! ITW_FREEZE+2,,AUTO
         1 007043   000000 702211                    TSX2  ! 0,X1

     1639    13087    2   END;
     1640    13088    1   END;

  13088  1 007044   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:255  
--  Include file information  --

   IT$SPROCDS.:E05TOU  cannot be made into a system file and is referenced.
   TM_DATA_M.:E05TOU  is referenced.
   IS$MACROS.:E05TOU  is referenced.
   K_SESSION_M.:E05TOU  is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   TD_CP6.:E05TOU  is referenced.
   UM_CP6.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   I_SUBS_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   FR_SUBS.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   NI_MACROS_C.:E05TOU  cannot be made into a system file and is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   I$DISK.:E05TOU  cannot be made into a system file and is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   MM_MACRO_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   MM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   IT$CONFIG.:E05TOU  is referenced.
   IT_ERROR_C.:E05TOU  is referenced.
   IT_SUBS_C.:E05TOU  is referenced.
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:256  
   NI_DATA_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ITW$WRAPUP.
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:257  

 **** Variables and constants ****

  ****  Section 000 RoData ITW$WRAPUP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   100-0-0/w SBIN        r     1 A_LOW(0:3)               104-0-0/w SBIN        r     1 B_LOW(0:3)
    50-0-0/w SBIN        r     1 DPSE_ELS1_CPU_BF(0:7)
    30-0-0/w SBIN        r     1 DPSE_ELS1_CPU_MEM_SIZE(0:7)
    40-0-0/w SBIN        r     1 L66_CPU_BF(0:7)
    20-0-0/w SBIN        r     1 L66_CPU_MEM_SIZE(0:7)
   111-0-0/w EPTR        r     1 NI_ENTADDR               111-0-0/w STRC        r     1 NI_ENTRY
     0-0-0/c STRC(567)   r     1 RV_BOOTID                 70-0-0/w SBIN        r     1 SCU_BF(0:7)
    60-0-0/w SBIN        r     1 SCU_MEM_SIZE(0:7)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CALL_VOLINIT              3-0-0/w PTR         r     1 @PTR$
    42-0-0/w PTR         r     1 APPL$                     26-0-0/w SBIN        r     1 BASE_CHAN
   246-0-0/w PTR         r     1 BUF$                     247-0-0/w SBIN        r     1 BUFX
    *0-0-0/w BIT         r     1 CALL_VOLINIT             245-0-0/w SBIN        r     1 CHAN
    14-0-0/c STRC(54)    r     1 CPUNUM                   226-0-0/b STRC(9)     r     1 CPU_CONFIG
   233-0-0/w UBIN        r     1 CPU_INTL                  31-0-0/w SBIN        r     1 CRCP_WORD
    31-0-0/w BIT         r     1 CRCP_WORD_BITS(0:35)
    20-0-0/w SBIN        r     1 CUR_FWSLOT               201-0-0/w PTR         r     1 CVM$
   200-0-0/w PTR         r     1 DBUF$                    175-0-0/w PTR         r     1 DCT$
   174-0-0/w PTR         r     1 DEV$                      21-0-0/c CHAR(8)     r     1 DEVNM
    27-0-0/w SBIN        r     1 DEV_CHAN                  40-0-0/w SBIN        r     1 DIR_DA
   173-0-0/w PTR         r     1 DQH$                     260-0-0/w PTR         r     1 DQH$
   257-0-0/w UBIN        r     1 END_UTS                   10-0-0/w SBIN        r     1 ERR
   220-0-0/w SBIN        r     1 ERRCDE                   202-0-0/d STRC(288)   r     1 FPT_SYSCON
    46-0-0/c STRC(144)   r     1 FW(0:19)                  43-0-0/w SBIN        r     1 FWDA
    44-0-0/w SBIN        r     1 FWSIZE                    45-0-0/w SBIN        r     1 FWSLOTS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:258  
     5-0-0/w SBIN        r     1 I                        255-0-0/w SBIN        r     1 I
   251-0-0/w BIT         r     1 IO_OUTSTANDING           244-0-0/w SBIN        r     1 IPC
   252-0-0/w BIT         r     1 ITW_FREEZE                 6-0-0/w SBIN        r     1 J
   256-0-0/w SBIN        r     1 J                          7-0-0/w SBIN        r     1 K
   241-0-0/w UBIN        r     1 LAP_TIME                 236-0-0/c STRC(72)    r     1 LOCAL_DATE
   224-0-0/w SBIN        r     1 LOG_SU#                  222-0-0/w SBIN        r     1 LOWER_STORE_SIZE
    37-0-0/w SBIN        r     1 LOWREAL_DA                30-0-0/w UBIN        r     1 LP_WORD
    30-0-0/w BIT         r     1 LP_WORD_BITS(0:35)
    32-0-0/w SBIN        r     1 MAX_DA                    41-0-0/w SBIN        r     1 MAX_NUM_PORTS
    33-0-0/w SBIN        r     1 MIN_DA                    34-0-0/w SBIN        r     1 MONDATA_DA
    35-0-0/w SBIN        r     1 MONDATA_SIZE             176-0-0/w PTR         r     1 MPC$
    23-0-0/w SBIN        r     1 OFFSET                   251-0-0/w BIT         r     1 ONQUEUE
   215-0-0/w SBIN        r     1 PORT#                    217-0-0/w SBIN        r     1 PORT_MEM_SIZE
   216-0-0/w SBIN        r     1 PORT_START_ADDR          243-0-0/w SBIN        r     1 PPNO
    *0-0-0/w PTR         r     1 PTR$                     171-0-0/w PTR         r     1 REQ$
   171-0-0/w STRC        r     1 REREQ$                   221-0-0/w SBIN        r     1 RSCR_ADDR
    24-0-0/w BIT (72)    r     1 RSLT                     232-0-0/b STRC        r     1 RSW2
   230-0-0/d STRC(72)    r     1 SCU_CONFIG               172-0-0/w PTR         r     1 SQH$
   240-0-0/w UBIN        r     1 START_TIME               214-0-0/w SBIN        r     1 STOREUNIT#
   225-0-0/b STRC(4)     r     1 SU                       223-0-0/w SBIN        r     1 SU#
   166-0-0/c STRC(108)   r     1 SUB_BUF                  250-0-0/w PTR         r     1 TDQH$
    11-0-0/c STRC(99)    r     1 TEXT_C                    36-0-0/w SBIN        r     1 TIGRDATA_DA
   177-0-0/w PTR         r     1 USER$                    242-0-0/w UBIN        r     1 UTS_DATE
   234-0-0/d STRC(72)    r     1 XXX_CLOCK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS1$                     0-0-0/w PTR         r     1 B$DS2$
     0-0-0/w PTR         r     1 B$DS3$                     0-0-0/w PTR         r     1 B$DS4$
     0-0-0/w PTR         r     1 B$DS5$                     0-0-0/w PTR         r     1 B$DS6$
     0-0-0/w PTR         r     1 B$IMX$                     0-0-0/w PTR         r     1 B$IPHYMAP$
     0-0-0/w PTR         r     1 B$IS$                      0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w PTR         r     1 B$LOOKUP$                  0-0-0/w PTR         r     1 B$LOWMEM$
     0-0-0/w PTR         r     1 B$LS$                      0-0-0/w PTR         r     1 B$MPT$
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:259  
     0-0-0/w PTR         r     1 B$P$                       0-0-0/w PTR         r     1 B$REAL$
     0-0-0/w PTR         r     1 B$SCU$                     0-0-0/w PTR         r     1 B$TIGR$
     0-0-0/w PTR         r     1 B$UPT$                     0-0-0/w PTR         r     1 B$USRT$
     0-0-0/w PTR         r     1 B$WINDOW$                  0-0-0/w PTR         r     1 B$WSQ0PT$
     0-0-0/w UBIN        r     1 B_SCDCTX                   0-0-0/d STRC(2232)  r     1 B_SITEINFO
     0-0-0/w BIT         r     1 EL_LOGERRS                 0-0-0/b STRC        r     1 FM_SYSDP
     0-0-0/w PTR         r     1 FR_PRM$(0:0)
     0-0-0/w BIT         r     1 HW_EDAC                    0-0-0/w BIT         r     1 HW_IMX
     0-0-0/w BIT         r     1 HW_IOP                     0-0-0/w BIT         r     1 HW_LOAD_FW
     0-0-0/w BIT         r     1 HW_NORM_CLOCK              0-0-0/w SBIN        r     1 HW_PTB_UNITS
     0-0-0/w BIT         r     1 HW_SECT_PT                 0-0-0/w BIT         r     1 HW_SMART_CACHE
     0-0-0/w BIT         r     1 HW_WSQ0PT
     0-0-0/w UBIN        r     1 H_CPU_BF(0:3)
     0-0-0/b STRC(9)     r     1 H_CPU_CONFIG(0:3)
     0-0-0/c CHAR(12)    r     1 H_DPS8000_CONFIG_NAME
     0-0-0/d STRC(72)    r     1 H_DPS8000_SCU_CONF_REG
     0-0-0/d BIT (72)    r     1 H_ENMASK                   0-0-0/w SBIN        r     1 H_MAXPORT#
     0-0-0/w UBIN        r     1 H_MAXSU#                   0-0-0/w BIT         r     1 H_MEMOK
     0-0-0/w UBIN        r     1 H_PORT_FIRST_ADDR(0:3)
     0-0-0/w BIT         r     1 H_RPM_FLG                  0-0-0/w BIT         r     1 H_RSW1(0:7)
     0-0-0/w BIT         r     1 H_RSW2(0:7)                0-0-0/b STRC        r     1 H_S1000_CONFIG
     0-0-0/w BIT         r     1 H_S1000_FLG
     0-0-0/w UBIN        r     1 H_SCU_BF(0:3)
     0-0-0/d STRC(72)    r     1 H_SCU_CONFIG(0:3)
     0-0-0/b STRC        r     1 H_STOREUNIT(0:15)
     0-0-0/w UBIN        r     1 IT_BOOTFLAG                0-0-0/d BIT (72)    r     1 IT_CLOFF
     0-0-0/d STRC(936)   r     1 IT_CONFIG                  0-0-0/w UBIN        r     1 IT_DATASIZE
     0-0-0/w UBIN        r     1 IT_DBUF                    0-0-0/w UBIN        r     1 IT_DBUFEND
     0-0-0/w UBIN        r     1 IT_DUMPSIZE                0-0-0/w PTR         r     1 IT_FEI$$
     0-0-0/b UBIN(9)     r     1 IT_MMDSMAX(0:7)
     0-0-0/w STRC(1800)  r     1 IT_PARTITION
     0-0-0/w UBIN        r     1 IT_SCPUHJIT(0:7)
     0-0-0/w UBIN        r     1 IT_SCPUJIT(0:7)
     0-0-0/w UBIN        r     1 IT_SCPUWSPTD(0:7)
     0-0-0/w PTR         r     1 IT_SYSDIR$                 0-0-0/w UBIN        r     1 IT_SYSDISK
     0-0-0/w BIT         r     1 IT_TIGRCUB                 0-0-0/w PTR         r     1 KIS_MAJOR$
     0-0-0/w PTR         r     1 KIS_MINOR$                 0-0-0/w UBIN        r     1 KIS_SSN_CLIENTS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:260  
     0-0-0/w UBIN        r     1 KIS_SSN_MAX                0-0-0/w UBIN        r     1 KIS_SSN_MAXMAJOR
     0-0-0/w UBIN        r     1 KIS_SSN_MAXMINOR           0-0-0/w UBIN        r     1 KIS_SSN_SERVERS
     0-0-0/w PTR         r     1 KI_FEI$$                   0-0-0/w UBIN        r     1 KI_MXFE
     0-0-0/w UBIN        r     1 KI_NODES                   0-0-0/w UBIN        r     1 KI_OSIMAX#
     0-0-0/w PTR         r     1 KI_OSIROUTE$$              0-0-0/w PTR         r     1 KI_ROUTE$$
     0-0-0/w PTR         r     1 MM_BYP$                    0-0-0/w UBIN        r     1 MM_CGQMAP_PGS
     0-0-0/b UBIN(9)     r     1 MM_DSMAX(0:7)
     0-0-0/b STRC        r     1 MM_FPMC                    0-0-0/w UBIN        r     1 MM_HELD
     0-0-0/w SBIN        r     1 MM_RDS(0:7)                0-0-0/w UBIN        r     1 MM_SCTDFT
     0-0-0/w PTR         r     1 N$DCT$$                    0-0-0/w PTR         r     1 N$FQ$
     0-0-0/w PTR         r     1 NI$CHT$                    0-0-0/w PTR         r     1 NI$FQ$
     0-0-0/w PTR         r     1 NI$IBUF$                   0-0-0/w PTR         r     1 NI$IMW$
     0-0-0/w PTR         r     1 NI$IOM$(0:3)
     0-0-0/w PTR         r     1 NI$RP$
     0-0-0/w UBIN        r     1 NI_CHANS(0:3)
     0-0-0/w UBIN        r     1 NI_IMXLO_PBASE             0-0-0/d STRC(72)    r     1 NI_INTENTRY
     0-0-0/w SBIN        r     1 NI_IOMS
     0-0-0/w UBIN        r     1 NI_MAINT_DCTX(0:3)
     0-0-0/w UBIN        r     1 NI_MAX_CHANS               0-0-0/d STRC(144)   r     1 NI_MBX_INIT
     0-0-0/w SBIN        r     1 NI_NUMIOQ                  0-0-0/w SBIN        r     1 NI_NUMIOS
     0-0-0/w BIT         r     1 NI_RELIOS                  0-0-0/w SBIN        r     1 NK_MXLOCAL
     0-0-0/w SBIN        r     1 N_DCTXMAX                  0-0-0/w UBIN        r     1 P_AUTOSPACE
     0-0-0/w UBIN        r     1 P_AUTO_START               0-0-0/w UBIN        r     1 P_LAST_AUTO
     0-0-0/w UBIN        r     1 P_MAXPROCS                 0-0-0/w PTR         r     1 P_RESOURCE$
     0-0-0/w UBIN        r     1 P_USED_AUTO                0-0-0/w SBIN        r     1 S_CTUIS
     0-0-0/w SBIN        r     1 S_CUIS(0:4)
     0-0-0/w SBIN        r     1 S_MPSTATE(0:7)
     0-0-0/w UBIN        r     1 S_NSCPU                    0-0-0/w UBIN        r     1 S_NSCPUA
     0-0-0/w UBIN        r     1 S_PNO
     0-0-0/w UBIN        r     1 S_PORTNR(0:7)
     0-0-0/w SBIN        r     1 S_PRIOB(0:4)
     0-0-0/w SBIN        r     1 S_PTYPE(0:7)
     0-0-0/w UBIN        r     1 S_SYSID                    0-0-0/w UBIN        r     1 S_TIMR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:261  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(360)   r     1 APPL
     0-0-0/w BIT         r     1 B$BIT36(0:0)
     0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w UBIN        r     1 B$LOOKUP(0:0)
     0-0-0/w STRC        r     1 B$MAP(0:1023)              0-0-0/d STRC(10368) r     1 B$MLNK
     0-0-0/d STRC(1224)  r     1 B$P(0:0)                   0-0-0/w STRC(36864) r     1 B$PAGE
     0-0-0/d STRC(2232)  r     1 B$SITEINFO                 0-0-0/d STRC(576)   r     1 B$U
     0-0-0/w STRC(576)   r     1 B$USER(0:0)                0-0-0/w STRC(36864) r     1 FM$VID
     0-0-0/w SBIN        r     1 FR$PR(0:0)                 0-0-0/w STRC(8640)  r     1 I$DISKDIR
     0-0-0/w STRC(360)   r     1 IT$SPROCDS                 0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/w STRC(612)   r     1 KI$OSIROUTE
     0-0-0/w PTR         r     1 KI$OSIROUTE$(0:0)
     0-0-0/w STRC(216)   r     1 KI$ROUTE
     0-0-0/w PTR         r     1 KI$ROUTE$(0:0)
     0-0-0/w STRC(14616) r     1 MCA_CFG                    0-0-0/w STRC(32984) r     1 MINI_DATA
     0-0-0/h UBIN(18)    r     1 MM$IPHY_MAP(0:0)
     0-0-0/w PTR         r     1 N$DCT$(0:0)                0-0-0/w STRC(72)    r     1 NI$CHT(0:127)
     0-0-0/w STRC(1332)  r     1 NI$DCT                     0-0-0/w STRC(648)   r     1 NI$DQH
     0-0-0/w STRC(2844)  r     1 NI$DVT                     0-0-0/w STRC(144)   r     1 NI$FQ
     0-0-0/d STRC(432)   r     1 NI$FW                      0-0-0/w STRC(252)   r     1 NI$IOM
     0-0-0/d STRC(504)   r     1 NI$REQ                     0-0-0/w STRC(252)   r     1 NI$SQH
     0-0-0/d STRC(936)   r     1 REAL


   Procedure ITW$WRAPUP requires 3621 words for executable code.
   Procedure ITW$WRAPUP requires 186 words of local(AUTO) storage.

    No errors detected in file ITW$WRAPUP.:E05TSI    .
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:262  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:263  
          MINI XREF LISTING

APPL
     10217**DCL     12078--ASSIGN  12082--ASSIGN  12084--ASSIGN  12087--ASSIGN  12093--ASSIGN  12107--ASSIGN
APPL.AUDCT
     10267**DCL     12090<<ASSIGN
APPL.CLNTHD
     10227**DCL     10228--REDEF   12082<<ASSIGN  12097>>ASSIGN  12100>>ASSIGN  12103>>ASSIGN
APPL.LDCTX
     10225**DCL     12085<<ASSIGN  12098<<ASSIGN
APPL.SRVRHD
     10226**DCL     12081<<ASSIGN  12084>>ASSIGN
APPL.TCTX
     10224**DCL     10225--REDEF   10226--REDEF   12068<<ASSIGN
APPL.TSAP.LEN
     10252**DCL     12088<<ASSIGN
APPL.TSAP.TSAP
     10260**DCL     12089<<ASSIGN
APPL.Z.COOKIE
     10229**DCL     10230--REDEF   12069<<ASSIGN  12086<<ASSIGN  12099<<ASSIGN
APPL.Z.LINK
     10231**DCL     12070<<ASSIGN  12075<<ASSIGN  12087<<ASSIGN  12094<<ASSIGN  12100<<ASSIGN  12104<<ASSIGN
APPL$
      9902**DCL     12066<<ASSIGN  12068>>ASSIGN  12069>>ASSIGN  12070>>ASSIGN  12071<<ASSIGN  12071>>ASSIGN
     12074<<ASSIGN  12075>>ASSIGN  12084<<ASSIGN  12085>>ASSIGN  12086>>ASSIGN  12087>>ASSIGN  12087>>ASSIGN
     12088>>ASSIGN  12089>>ASSIGN  12090>>ASSIGN  12093<<ASSIGN  12094>>ASSIGN  12097<<ASSIGN  12098>>ASSIGN
     12099>>ASSIGN  12100>>ASSIGN  12103<<ASSIGN  12104>>ASSIGN
A_LOW
     11812**DCL     12332>>ASSIGN
B$BIT36
      9984**DCL     11847<<ASSIGN
B$DO.ECCINFO
       171**DCL       172--REDEF
B$DS1$
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:264  
     11570**DCL     10599--IMP-PTR 12400>>ASSIGN  12517>>ASSIGN  12518>>ASSIGN  12519>>ASSIGN  12520>>ASSIGN
     12521>>ASSIGN  12523>>ASSIGN  12552>>ASSIGN  12553>>ASSIGN  12569>>ASSIGN  12570>>ASSIGN  12636>>IF
     12646>>ASSIGN
B$DS2$
     11571**DCL     12160>>ASSIGN
B$DS3$
     11572**DCL     12163>>ASSIGN
B$DS4$
     11573**DCL     12166>>ASSIGN
B$DS5$
     11574**DCL     12169>>ASSIGN
B$DS6$
     11575**DCL     12117>>DOINDEX 12119>>ASSIGN  12121>>ASSIGN  12124>>DOINDEX 12172>>ASSIGN
B$IMX$
     11585**DCL     11871>>ASSIGN
B$IPHYMAP$
     11584**DCL     12150>>ASSIGN  12151>>ASSIGN  12152>>ASSIGN
B$IS$
     11578**DCL     12667>>ASSIGN
B$JIT.ACCN
      4412**DCL     12918<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      4506**DCL      4506--REDEF
B$JIT.DO$
      4580**DCL     12928<<ASSIGN
B$JIT.ERR.MID
      4413**DCL      4413--REDEF
B$JIT.FACCN
      4412**DCL     12919<<ASSIGN
B$JIT.FPSN
      4493**DCL     12929<<ASSIGN
B$JIT.HPSN
      4580**DCL     12930<<ASSIGN
B$JIT.JOBNAME
      4561**DCL     12924<<ASSIGN
B$JIT.JRESPEAK
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:265  
      4574**DCL      4575--REDEF
B$JIT.LOCK
      4561**DCL     12922<<ASSIGN
B$JIT.MAXTMPDP
      4581**DCL     12926<<ASSIGN
B$JIT.MODE
      4407**DCL     12925<<ASSIGN
B$JIT.MRT
      4586**DCL     12917<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
      4683**DCL      4683--REDEF    4684--REDEF
B$JIT.OUTPRIO
      4493**DCL     12931<<ASSIGN
B$JIT.PNR
      4587**DCL      4587--REDEF
B$JIT.PPC
      4573**DCL     12908>>ASSIGN
B$JIT.PRDPRM
      4581**DCL     12927<<ASSIGN
B$JIT.PRIV.ACTIVE
      4413**DCL     12920<<ASSIGN
B$JIT.PRIV.JOB
      4456**DCL     12921<<ASSIGN
B$JIT.SYSID
      4412**DCL     12915<<ASSIGN
B$JIT.TSLINE
      4681**DCL      4682--REDEF
B$JIT.UNAME
      4412**DCL     12923<<ASSIGN
B$JIT.USER
      4412**DCL     12916<<ASSIGN
B$JIT$
     11568**DCL      4407--IMP-PTR 12908>>ASSIGN  12915>>ASSIGN  12916>>ASSIGN  12917>>ASSIGN  12918>>ASSIGN
     12919>>ASSIGN  12920>>ASSIGN  12921>>ASSIGN  12922>>ASSIGN  12923>>ASSIGN  12924>>ASSIGN  12925>>ASSIGN
     12926>>ASSIGN  12927>>ASSIGN  12928>>ASSIGN  12929>>ASSIGN  12930>>ASSIGN  12931>>ASSIGN
B$LOOKUP
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:266  
       281**DCL     12146<<ASSIGN
B$LOOKUP$
       303**DCL     12134<<ASSIGN  12138>>ASSIGN  12139>>ASSIGN  12142<<ASSIGN  12146>>ASSIGN
B$LOWMEM$
     11580**DCL     11557--IMP-PTR 12716>>ASSIGN  12716>>ASSIGN
B$LS$
     11579**DCL     11841>>ASSIGN
B$MAP
      4729**DCL     11913<<ASSIGN  11913>>ASSIGN  11914<<ASSIGN  11914>>ASSIGN  11916<<ASSIGN  11916>>ASSIGN
     11917<<ASSIGN  11917>>ASSIGN  11919<<ASSIGN  11919>>ASSIGN  11920<<ASSIGN  11920>>ASSIGN  11922<<ASSIGN
     11922>>ASSIGN  11923<<ASSIGN  11923>>ASSIGN  11925<<ASSIGN  11925>>ASSIGN  11926<<ASSIGN  11926>>ASSIGN
     11935<<ASSIGN  11935>>ASSIGN  11936<<ASSIGN  11936>>ASSIGN  11937<<ASSIGN  11937>>ASSIGN  11938<<ASSIGN
     11938>>ASSIGN  11939<<ASSIGN  11939>>ASSIGN  11940<<ASSIGN  11940>>ASSIGN  11941<<ASSIGN  11941>>ASSIGN
     11942<<ASSIGN  11942>>ASSIGN  11943<<ASSIGN  11943>>ASSIGN  11944<<ASSIGN  11944>>ASSIGN  11945<<ASSIGN
     11945>>ASSIGN  11946<<ASSIGN  11946>>ASSIGN
B$MAP.RPN
      4730**DCL     11850>>ASSIGN  11863>>ASSIGN  12150>>ASSIGN  12151>>ASSIGN  12152>>ASSIGN  12155>>ASSIGN
     12156>>ASSIGN  12157>>ASSIGN  12909>>ASSIGN
B$MAP.SCTRL
      4731**DCL      4732--REDEF
B$MLNK.BUF.FLGS
     10724**DCL     11841<<ASSIGN
B$MPT$
     11577**DCL     11863>>ASSIGN  11913>>ASSIGN  11914>>ASSIGN  11916>>ASSIGN  11917>>ASSIGN  11919>>ASSIGN
     11920>>ASSIGN  11922>>ASSIGN  11923>>ASSIGN  11925>>ASSIGN  11926>>ASSIGN  11935>>ASSIGN  11936>>ASSIGN
     11937>>ASSIGN  11938>>ASSIGN  11939>>ASSIGN  11940>>ASSIGN  11941>>ASSIGN  11942>>ASSIGN  11943>>ASSIGN
     11944>>ASSIGN  11945>>ASSIGN  11946>>ASSIGN  12150>>ASSIGN  12151>>ASSIGN  12152>>ASSIGN  12155>>ASSIGN
     12156>>ASSIGN  12157>>ASSIGN
B$P
       248**DCL     12113--CALL    12115<<ASSIGN  12118<<ASSIGN  12125<<ASSIGN  12136--CALL    12138<<ASSIGN
B$P.ACCT
       271**DCL     12120<<ASSIGN  12126<<ASSIGN  12139<<ASSIGN
B$P.FLGS
       269**DCL     12121<<ASSIGN
B$P.NAME
       272**DCL     12119<<ASSIGN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:267  
B$P$
       302**DCL     12111<<ASSIGN  12115>>ASSIGN  12118>>ASSIGN  12119>>ASSIGN  12120>>ASSIGN  12121>>ASSIGN
     12125>>ASSIGN  12126>>ASSIGN
B$PAGE
      4780**DCL     12657<<ASSIGN  12657>>ASSIGN  12687<<ASSIGN  12687>>ASSIGN  12739<<ASSIGN  13070<<ASSIGN
     13070>>ASSIGN
B$PAGE.WRD
      4781**DCL     13079<<ASSIGN  13079>>ASSIGN
B$REAL$
     11569**DCL     11892>>ASSIGN  11896>>ASSIGN  12653>>ASSIGN
B$SCU$
     11586**DCL     12240<>CALL
B$SITEINFO.MINI_ID#
     11544**DCL     12392>>ASSIGN
B$SITEINFO.MON_UTS#
     11547**DCL     12391>>ASSIGN
B$SITEINFO.SALUTATION#
     11545**DCL     12396>>ASSIGN
B$SITEINFO.SITE_ID#
     11548**DCL     12398>>ASSIGN
B$SITEINFO.SITE_NAME#
     11544**DCL     12394>>ASSIGN
B$TIGR$
     11581**DCL     12347>>ASSIGN  12683>>ASSIGN
B$U.FLG
        37**DCL     12907<<ASSIGN
B$U.MISC
       150**DCL       151--REDEF
B$U.MODE
       141**DCL     12913<<ASSIGN
B$U.PCT
       134**DCL     12908<<ASSIGN
B$U.PRIO
       139**DCL     12911<<ASSIGN
B$U.PRIOB
       140**DCL     12910<<ASSIGN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:268  
B$U.PT
       144**DCL     12909<<ASSIGN
B$U.SYSID
       145**DCL     12912<<ASSIGN
B$UPT$
     11576**DCL     12909>>ASSIGN
B$USER
       195**DCL     12903--ASSIGN
B$USER.MISC
       226**DCL       227--REDEF
B$USRT$
       238**DCL     12903>>ASSIGN
B$WINDOW$
     11582**DCL     11847>>ASSIGN  11906>>ASSIGN  12295<>CALL
B$WSQ0PT$
     11583**DCL     11850>>ASSIGN
BASE_CHAN
      9887**DCL     12588<<ASSIGN  12599>>ASSIGN  12600>>ASSIGN
BUF$
     10006**DCL     10497--IMP-PTR 12407<>CALL    12413<>CALL    12418>>IF      12420>>ASSIGN  12421>>DOINDEX
     12465<>CALL
BUFX
     10007**DCL     12407<>CALL    12411<>CALL    12413<>CALL    12465<>CALL
B_LOW
     11813**DCL     12331>>ASSIGN
B_SCDCTX
     11589**DCL     11965<<ASSIGN  12178>>IF
B_SITEINFO.MINI_ID#
     11783**DCL     12392<<ASSIGN
B_SITEINFO.MON_UTS#
     11786**DCL     12391<<ASSIGN
B_SITEINFO.SALUTATION#
     11784**DCL     12396<<ASSIGN
B_SITEINFO.SALUTATION#.L
     11785**DCL     12395>>IF
B_SITEINFO.SITE_ID#
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:269  
     11787**DCL     12397>>IF      12398<<ASSIGN
B_SITEINFO.SITE_NAME#
     11783**DCL     12394<<ASSIGN
B_SITEINFO.SITE_NAME#.L
     11784**DCL     12393>>IF
B_SITEINFO.VERSION#
     11786**DCL     12385<<ASSIGN
CALL_VOLINIT
        17**DCL        14--PROC    12749>>IF
CHAN
     10005**DCL     12420<<ASSIGN  12421>>DOINDEX 12421>>DOINDEX 12429<<DOINDEX 12430>>ASSIGN
CHANLP
     12201**LABEL   12204--EXIT
CONFIG_ERR
     13048**LABEL   12407--CALLALT 12414--GOTO
CPUNUM
      9876**DCL     12967--CALL    12975--CALL
CPUNUM.COUNT
      9877**DCL     12942<<ASSIGN
CPUNUM.TEXT
      9878**DCL     12942--ASSIGN  12943<<ASSIGN  12944<<CALLBLT 12944--CALLBLT
CPU_CONFIG
      9964**DCL     12251<<ASSIGN
CPU_CONFIG.INTERLACE
      9968**DCL     12270>>IF
CPU_CONFIG.PORT_ASSIGN
      9965**DCL     12270>>IF      12280>>ASSIGN  12288>>ASSIGN
CPU_CONFIG.PORT_ENABLE
      9966**DCL     12252>>IF
CPU_CONFIG.SIZE
      9969**DCL     12256>>ASSIGN  12257>>ASSIGN  12264>>ASSIGN  12265>>ASSIGN
CPU_INTL
      9982**DCL     12278<<ASSIGN  12279<<ASSIGN  12280>>ASSIGN  12282>>ASSIGN
CRCP_WORD
      9891**DCL      9892--REDEF   12590<<ASSIGN  12604>>ASSIGN
CRCP_WORD_BITS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:270  
      9892**DCL     12600<<ASSIGN
CUR_FWSLOT
      9883**DCL     12524<<ASSIGN
CVM$
      9930**DCL     11906<<ASSIGN  11913>>ASSIGN  11914>>ASSIGN  11916>>ASSIGN  11917>>ASSIGN  11919>>ASSIGN
     11920>>ASSIGN  11922>>ASSIGN  11923>>ASSIGN  11925>>ASSIGN  11926>>ASSIGN  11935>>ASSIGN  11936>>ASSIGN
     11937>>ASSIGN  11938>>ASSIGN  11939>>ASSIGN  11940>>ASSIGN  11941>>ASSIGN  11942>>ASSIGN  11943>>ASSIGN
     11944>>ASSIGN  11945>>ASSIGN  11946>>ASSIGN
CVM_ERR
     13052**LABEL   11909--CALLALT 11929--CALLALT 11933--CALLALT 11948--CALLALT
DBUF$
      9929**DCL     12353<<ASSIGN  12355<>CALL    12357>>ASSIGN  12358>>ASSIGN  12360<>CALL    12361>>ASSIGN
     12363>>ASSIGN  12364>>ASSIGN  12366>>ASSIGN  12367>>ASSIGN  12369>>ASSIGN  12372>>DOWHILE 12373>>ASSIGN
     12379>>ASSIGN  12379>>ASSIGN  12380>>ASSIGN  12384>>ASSIGN  12385>>ASSIGN  12387<>CALL    12389<>CALL
     12389>>CALL    12391>>ASSIGN  12392>>ASSIGN  12394>>ASSIGN  12396>>ASSIGN  12398>>ASSIGN  12657>>ASSIGN
     12659<>CALL    12687>>ASSIGN  12689<>CALL    12702<>CALL    12703>>IF      12703>>IF      12705>>ASSIGN
     12706>>IF      12706>>IF      12707<>CALL    12709>>IF      12709>>IF      12714<>CALL    12715>>ASSIGN
     12717<>CALL    12726<>CALL    12728>>ASSIGN  12729>>ASSIGN  12730>>ASSIGN  12731>>ASSIGN  12732>>ASSIGN
     12734>>ASSIGN  12737<>CALL    12739>>ASSIGN  12741<>CALL    13069<>CALL    13070>>ASSIGN  13077<>CALL
     13079>>ASSIGN
DCT$
      9926**DCL     12467<<ASSIGN  12468>>IF      12470>>ASSIGN  12491<<ASSIGN  12492>>ASSIGN  12493>>ASSIGN
DEV$
      9925**DCL     12502<<ASSIGN  12503>>IF      12510>>IF      12514>>IF      12523>>ASSIGN  12528>>IF
     12531>>ASSIGN  12546>>IF      12549>>IF      12560>>ASSIGN  12566>>IF      12577>>ASSIGN  12588>>ASSIGN
     12591>>IF      12595>>DOINDEX 12603>>ASSIGN  12604>>ASSIGN  12605>>IF      12606>>CALLBLT 12612>>ASSIGN
     12626>>IF      12629>>ASSIGN  12630>>CALL    12635>>CALL    12636>>IF      12637>>ASSIGN  12638>>IF
     12751<<ASSIGN  12752>>IF      12752>>IF      12754>>ASSIGN  12755>>CALL
DEVNM
      9884**DCL     12606<<CALLBLT 12608>>IF
DEV_CHAN
      9888**DCL     12597<<ASSIGN  12599>>ASSIGN  12600>>ASSIGN
DEV_PART
     12469**LABEL   12487--EXIT
DIR_DA
      9900**DCL     12358<<ASSIGN  12360<>CALL    12387<>CALL    12726<>CALL    12737<>CALL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:271  
DISK_ERR
     13037**LABEL   12355--CALLALT 12360--CALLALT 12387--CALLALT 12389--CALLALT 12522--CALLALT 12554--CALLALT
     12571--CALLALT 12659--CALLALT 12671--CALLALT 12689--CALLALT 12702--CALLALT 12707--CALLALT 12714--CALLALT
     12717--CALLALT 12726--CALLALT 12737--CALLALT 12741--CALLALT
DISK_ERR IN PROCEDURE FW_MOVE
     13086**LABEL   13069--CALLALT 13077--CALLALT
DPSE_ELS1_CPU_BF
     11806**DCL     12265>>ASSIGN
DPSE_ELS1_CPU_MEM_SIZE
     11802**DCL     12264>>ASSIGN
DQH$
      9924**DCL     11883<<ASSIGN  11885>>ASSIGN  11886>>ASSIGN  12417<<ASSIGN  12422<<ASSIGN  12423>>IF
     12425>>ASSIGN  12431<<ASSIGN  12432>>IF      12434>>ASSIGN  12435>>ASSIGN  12436>>IF      12440>>ASSIGN
     12441>>ASSIGN  12442>>ASSIGN  12447>>ASSIGN  12448>>ASSIGN  12451<<ASSIGN  12452>>IF      12452>>IF
     12813<<ASSIGN  12814>>IF      12815>>IF      12828>>ASSIGN  12829>>ASSIGN  12830>>IF      12832>>ASSIGN
     12834>>DOWHILE 12836>>IF      12840>>ASSIGN  12845<>CALL    12845>>CALL    12868<<ASSIGN  12869>>ASSIGN
     12870>>ASSIGN
DQH$ IN PROCEDURE IOSPIN
     12997**DCL     13007<<ASSIGN  13008>>IF      13009>>IF      13018>>IF
EL_LOGERRS
     11615**DCL     12763<<ASSIGN
END_UTS IN PROCEDURE IOSPIN
     12996**DCL     13001<>CALL    13027>>IF
ERR
      9872**DCL     11845<>CALL    11849<>CALL    12773<>CALL    12781<>CALL    12798<>CALL    12819<>CALL
     12860<>CALL    12878<>CALL    12952<<ASSIGN  12955<<ASSIGN  12972<<ASSIGN  12975<>CALL
ERRCDE
      9956**DCL     12294<>CALL
FM$VID.DTT
     11514**DCL     11517--REDEF
FM$VID.PSN
     11497**DCL     12709>>IF
FM$VID.SECTSTRT
     11507**DCL     12703>>IF      12703>>IF      12705>>ASSIGN  12706>>IF      12706>>IF
FM$VID.SYSDIRDA
     11503**DCL     12358>>ASSIGN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:272  
FM$VID.SYSSIZE
     11501**DCL     12357>>ASSIGN  12715<<ASSIGN
FM$VID.VOLCNT
     11499**DCL     12709>>IF
FM_SYSDP.CHN
     11593**DCL     12216>>IF      12218>>ASSIGN
FM_SYSDP.DVN
     11594**DCL     12220>>IF
FM_SYSDP.PORT
     11592**DCL     12211>>IF
FPT_SYSCON.V
      9942**DCL     12773<>CALL    12798<>CALL    12819<>CALL    12860<>CALL    12878<>CALL
FPT_SYSCON.V.CHAN#
      9944**DCL     12817<<ASSIGN  12859<<ASSIGN
FPT_SYSCON.V.COMPONENT#
      9943**DCL     12767<<ASSIGN  12792<<ASSIGN  12818<<ASSIGN  12855<<ASSIGN  12874<<ASSIGN
FPT_SYSCON.V.DEVNM#
      9945**DCL     12772<<ASSIGN  12797<<ASSIGN
FPT_SYSCON.V.FUNCTION#
      9943**DCL     12765<<ASSIGN
FPT_SYSCON.V.IOM#
      9943**DCL      9944--REDEF    9944--REDEF   12816<<ASSIGN  12877<<ASSIGN
FR$PR
      5435**DCL     12001<<ASSIGN  12001>>ASSIGN  12003<<ASSIGN  12003>>ASSIGN  12005<<ASSIGN  12005>>ASSIGN
     12183>>IF      12188>>IF
FR_PRM$
      5436**DCL     12001>>ASSIGN  12001>>ASSIGN  12003>>ASSIGN  12003>>ASSIGN  12005>>ASSIGN  12005>>ASSIGN
     12183>>IF      12188>>IF
FW
      9907**DCL     12373<<ASSIGN  12377<<ASSIGN
FW.CS0SIZE
      9910**DCL     12516>>ASSIGN  12519>>ASSIGN  12551>>ASSIGN  12553>>ASSIGN  12568>>ASSIGN  12570>>ASSIGN
FW.DA
      9909**DCL     12515>>ASSIGN  12518>>ASSIGN  12550>>ASSIGN  12552>>ASSIGN  12567>>ASSIGN  12569>>ASSIGN
FW.MM0SIZE
      9911**DCL     12516>>ASSIGN  12520>>ASSIGN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:273  
FW.NAME
      9912**DCL     12514>>IF      12549>>IF      12566>>IF
FWDA
      9904**DCL     12515<<ASSIGN  12550<<ASSIGN  12567<<ASSIGN  13069<>CALL    13073<<ASSIGN  13073>>ASSIGN
     13077<>CALL
FWDONE
     12744**LABEL   12651--GOTO
FWNONE
     12642**LABEL   12529--GOTO
FWSIZE
      9905**DCL     12516<<ASSIGN  12551<<ASSIGN  12568<<ASSIGN  13068>>DOWHILE 13072<<ASSIGN  13072>>ASSIGN
     13076>>IF      13078>>DOINDEX 13081>>ASSIGN
FWSLOTS
      9906**DCL     12376<<ASSIGN  12513>>DOINDEX 12548>>DOINDEX 12565>>DOINDEX
FW_MOVE
     13058**PROC    12522--CALL    12554--CALL    12571--CALL
GOTCRPFW
     12588**LABEL   12572--GOTO
GOTFW
     12546**LABEL   12525--GOTO
GOTSIOM
     12216**LABEL   12213--GOTO
GOTSYSDISK
     12230**LABEL   12223--GOTO
GTT
     12222**LABEL   12215--GOTO    12217--GOTO
HFB$DISPORT
      9863**DCL-ENT 12973--CALL
HFB$EDAC
      9817**DCL-ENT 12895--CALL
HFB$ENAPORT
      9838**DCL-ENT 11855--CALL    12959--CALL
HFB$INITMASK
      9839**DCL-ENT 12341--CALL
HFC$LCON
      9827**DCL-ENT 12896--CALL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:274  
HFC$RCONF
      9842**DCL-ENT 12238--CALL
HFC$RCONF_8000
      9857**DCL-ENT 12241--CALL
HFC$RSCR
      9840**DCL-ENT 11969--CALL    12240--CALL    12295--CALL
HFC$STCPU
      9858**DCL-ENT 12960--CALL
HFD$CNNCT
      9856**DCL-ENT 12982--CALL
HW_EDAC
      7335**DCL     12895>>IF
HW_IMX
      7336**DCL     11858>>IF      12405>>IF
HW_IOP
      7333**DCL     12193>>IF
HW_LOAD_FW
      7332**DCL     12510>>IF      12625>>IF
HW_NORM_CLOCK
      7335**DCL     11968>>IF
HW_PTB_UNITS
      7331**DCL     12909>>ASSIGN
HW_SECT_PT
      7332**DCL     11843>>IF
HW_SMART_CACHE
      7334**DCL     11840>>IF
HW_WSQ0PT
      7332**DCL     11850>>IF      12149>>IF
H_CPU_BF
      7312**DCL     12257<<ASSIGN  12261<<ASSIGN  12261>>ASSIGN  12265<<ASSIGN  12268<<ASSIGN
H_CPU_CONFIG
      7308**DCL     12243<<ASSIGN  12251>>ASSIGN
H_DPS8000_CONFIG_NAME
      7327**DCL     12950>>IF
H_DPS8000_SCU_CONF_REG
      7324**DCL     12240<>CALL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:275  
H_DPS8000_SCU_CONF_REG.PORTS
      7325**DCL     12949>>IF
H_ENMASK
      7304**DCL     12196<<ASSIGN
H_MAXPORT#
      7313**DCL     12245<<ASSIGN  12292<<ASSIGN  12292>>ASSIGN  12293>>ASSIGN
H_MAXSU#
      7305**DCL     12333<<ASSIGN
H_MEMOK
      7305**DCL     12340<<ASSIGN
H_PORT_FIRST_ADDR
      7312**DCL     12293<<ASSIGN
H_RPM_FLG
      7306**DCL     12239>>IF      12896>>IF      12948>>IF
H_RSW1
      7317**DCL     12243>>ASSIGN
H_RSW2
      7317**DCL     12246>>ASSIGN
H_S1000_CONFIG
      7306**DCL     12238<>CALL
H_S1000_FLG
      7306**DCL     12238>>IF
H_SCU_BF
      7312**DCL     12298<<ASSIGN
H_SCU_CONFIG
      7309**DCL     12296<<ASSIGN
H_STOREUNIT.FIRST_ADDR
      7305**DCL     12319<<ASSIGN  12326<<ASSIGN
H_STOREUNIT.PORT#
      7304**DCL     12329<<ASSIGN
H_STOREUNIT.STORE_UNIT#
      7305**DCL     12331<<ASSIGN  12332<<ASSIGN
I
      9869**DCL     11846<<DOINDEX 11847>>ASSIGN  11853<<DOINDEX 11854>>ASSIGN  11855>>IF      11866<<DOINDEX
     11867>>CALL    11867>>CALL    11873<<DOINDEX 11880<<DOINDEX 11882>>IF      11883>>ASSIGN  11898<<ASSIGN
     11900>>DOWHILE 11908<<DOINDEX 11909>>CALL    11911>>DOCASE  11932<<DOINDEX 11933>>CALL    11956<<ASSIGN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:276  
     11957>>DOWHILE 11958>>CALL    11959<<ASSIGN  11959>>ASSIGN  11962<<DOINDEX 11963>>IF      11963>>IF
     11965>>ASSIGN  11983<<DOINDEX 11984>>IF      11984>>IF      11984>>IF      11984>>IF      11989>>ASSIGN
     11990>>CALL    11991>>CALL    12011<<ASSIGN  12012>>DOWHILE 12013>>ASSIGN  12013>>ASSIGN  12014<<ASSIGN
     12014>>ASSIGN  12017<<DOINDEX 12017>>DOINDEX 12018>>ASSIGN  12029<<DOINDEX 12030>>ASSIGN  12030>>ASSIGN
     12034<<DOINDEX 12035>>ASSIGN  12050<<DOINDEX 12051>>ASSIGN  12063<<ASSIGN  12064<>CALL    12067<<DOINDEX
     12070>>ASSIGN  12078<<ASSIGN  12079<>CALL    12083<<DOINDEX 12084>>ASSIGN  12096<<DOINDEX 12097>>ASSIGN
     12100>>ASSIGN  12117<<DOINDEX 12118>>ASSIGN  12119>>ASSIGN  12119>>ASSIGN  12120>>ASSIGN  12121>>ASSIGN
     12121>>ASSIGN  12124<<DOINDEX 12125>>ASSIGN  12126>>ASSIGN  12137<<DOINDEX 12138>>ASSIGN  12139>>ASSIGN
     12145<<DOINDEX 12146>>ASSIGN  12161<>CALL    12164<>CALL    12167<>CALL    12170<>CALL    12173<>CALL
     12199<<DOINDEX 12200>>ASSIGN  12202>>IF      12203>>ASSIGN  12210<<DOINDEX 12211>>IF      12211>>IF
     12216>>IF      12218>>ASSIGN  12219<<DOINDEX 12220>>IF      12220>>IF      12222>>ASSIGN  12371<<ASSIGN
     12372>>DOWHILE 12373>>ASSIGN  12373>>ASSIGN  12374<<ASSIGN  12374>>ASSIGN  12376>>ASSIGN  12377>>ASSIGN
     12380<<ASSIGN  12381>>DOWHILE 12382<<ASSIGN  12382>>ASSIGN  12384>>ASSIGN  12408<<DOINDEX 12409>>IF
     12411>>CALL    12420>>ASSIGN  12430>>ASSIGN  12466<<DOINDEX 12467>>ASSIGN  12498<<ASSIGN  12499>>DOWHILE
     12502>>ASSIGN  12596>>ASSIGN  12611>>ASSIGN  12626>>IF      12626>>IF      12634>>IF      12634>>IF
     12642<<ASSIGN  12642>>ASSIGN  12681<<ASSIGN  12684>>ASSIGN  12685>>DOINDEX 12705<<ASSIGN  12707<>CALL
     12733<<DOINDEX 12734>>ASSIGN  12750<<DOINDEX 12751>>ASSIGN  12752>>IF      12768<<DOINDEX 12769>>IF
     12770>>IF      12771>>IF      12772>>ASSIGN  12775>>ASSIGN  12779>>IF      12780>>IF      12780>>IF
     12781>>CALL    12783>>ASSIGN  12786>>ASSIGN  12787>>ASSIGN  12793<<DOINDEX 12794>>IF      12795>>IF
     12796>>IF      12797>>ASSIGN  12800>>ASSIGN  12804>>IF      12805>>ASSIGN  12806>>ASSIGN  12811<<DOINDEX
     12812>>DOINDEX 12813>>ASSIGN  12815>>IF      12816>>ASSIGN  12822>>CALLBLT 12827>>IF      12856<<DOINDEX
     12857>>ASSIGN  12859>>ASSIGN  12863>>CALLBLT 12875<<DOINDEX 12876>>IF      12877>>ASSIGN  12881>>CALLBLT
     12902<<ASSIGN  12903>>ASSIGN  12916>>ASSIGN  12933<>CALL    12941<<DOINDEX 12944>>CALLBLT 12945>>IF
     12945>>IF      12947>>ASSIGN  12949>>IF      12951>>ASSIGN  12959>>CALL    12960<>CALL    12962>>IF
     12966<>CALL    12973>>CALL    12979<<DOINDEX 12981>>IF      12982<>CALL    13044<<ASSIGN  13044>>ASSIGN
I IN PROCEDURE IOSPIN
     12994**DCL     13005<<DOINDEX 13006>>DOINDEX 13007>>ASSIGN  13012>>CALLBLT
I$DISKDIR
      3841**DCL     12025--CALL    12361<<ASSIGN  12361>>ASSIGN
I$DISKDIR.AARDVARK.DA
      3844**DCL     12369>>ASSIGN
I$DISKDIR.DUMP.DA
      4034**DCL     12729<<ASSIGN
I$DISKDIR.DUMP.LDUMP
      4036**DCL     12732<<ASSIGN
I$DISKDIR.DUMP.SCOUNT
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:277  
      4033**DCL     12731<<ASSIGN
I$DISKDIR.DUMP.SIZE
      4035**DCL     12730<<ASSIGN
I$DISKDIR.FW
      4077**DCL     12373>>ASSIGN
I$DISKDIR.FW.NAME
      4083**DCL      4084--REDEF
I$DISKDIR.FW.NAMEBIN
      4084**DCL     12372>>DOWHILE
I$DISKDIR.LOWREAL.DA
      3850**DCL     12367>>ASSIGN
I$DISKDIR.MONDATA.DA
      3862**DCL     12363>>ASSIGN
I$DISKDIR.MONDATA.SIZE
      3863**DCL     12364>>ASSIGN
I$DISKDIR.MONID.A.BOOTC
      4042**DCL     12380>>ASSIGN
I$DISKDIR.MONID.A.VER
      4041**DCL     12379>>ASSIGN
I$DISKDIR.MONID.M
      4043**DCL      4046--REDEF
I$DISKDIR.MONID.M.BOOTC
      4045**DCL     12384<<ASSIGN
I$DISKDIR.MONID.M.VER
      4044**DCL     12379<<ASSIGN
I$DISKDIR.MONID.M_CHAR4
      4046**DCL     12385>>ASSIGN
I$DISKDIR.RCVR2.DA
      4038**DCL     12734<<ASSIGN
I$DISKDIR.SITEINFO.DA
      4074**DCL     12389<>CALL
I$DISKDIR.TIGRDATA.DA
      3958**DCL     12366>>ASSIGN
I$DISKDIR.TIGRDATA.SIZE
      3959**DCL     12728<<ASSIGN
IOSPIN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:278  
     12992**PROC    11994--CALL    12639--CALL    12644--CALL
IO_OUTSTANDING
     10009**DCL     10010--REDEF   13003>>DOUNTIL 13004<<ASSIGN  13019<<ASSIGN
IPC
     10004**DCL     12416<<DOINDEX 12418>>IF      12420>>ASSIGN  12421>>DOINDEX 12425>>ASSIGN
IT$SPROCDS.COUNT
     10023**DCL     12117>>DOINDEX 12124>>DOINDEX
IT$SPROCDS.PROCS.FLGS
     10028**DCL     12121>>ASSIGN
IT$SPROCDS.PROCS.NAME
     10025**DCL     12119>>ASSIGN
ITE$ERROR
      9836**DCL-ENT 12179--CALL    12184--CALL    12189--CALL    12227--CALL    12532--CALL    12561--CALL
     12578--CALL    12662--CALL    12675--CALL    12693--CALL    12722--CALL    12776--CALL    12801--CALL
     12824--CALL    12864--CALL    12882--CALL    12883--CALL    12967--CALL    12975--CALL    13015--CALL
     13023--CALL    13037--CALL    13043--CALL    13048--CALL    13052--CALL
ITF$FREEZE
      9814**DCL-ENT 11865--CALL    11868--CALL    12180--CALL    12185--CALL    12190--CALL    12228--CALL
     12533--CALL    12562--CALL    12579--CALL    12663--CALL    12676--CALL    12694--CALL    12723--CALL
     12884--CALL    13024--CALL    13038--CALL    13049--CALL    13053--CALL    13055--CALL
ITG$MPY10000
      9847**DCL-ENT 11977--CALL
ITH$ALLOCATE
      9845**DCL-ENT 12023--CALL    12025--CALL    12028--CALL    12045--CALL    12057--CALL    12064--CALL
     12079--CALL    12113--CALL    12136--CALL    12144--CALL
ITH$READ_VERIFY_SAD
      9832**DCL-ENT 12360--CALL    12726--CALL
ITK$TDP$SYSCON
      9843**DCL-ENT 12773--CALL    12798--CALL    12819--CALL    12860--CALL    12878--CALL
ITK$TMB$BUF_ALLOC
      9851**DCL-ENT 12407--CALL
ITK$TMB$BUF_DEALLOC
      9852**DCL-ENT 12413--CALL    12465--CALL
ITK$TMB$MCA
      9850**DCL-ENT 12411--CALL
ITK$VOLINIT
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:279  
      9831**DCL-ENT 12759--CALL
ITP$PROCREC
      9835**DCL-ENT 11902--CALL
ITQ$DREAD
      9833**DCL-ENT 12355--CALL    12389--CALL    12702--CALL    12707--CALL    12714--CALL    13069--CALL
     13077--CALL
ITQ$DWRITE
      9834**DCL-ENT 12387--CALL    12659--CALL    12671--CALL    12689--CALL    12717--CALL    12737--CALL
     12741--CALL
ITW$ALLOC_ERR
     13055**LABEL   11884--CALLALT 12023--CALLALT 12025--CALLALT 12028--CALLALT 12064--CALLALT 12079--CALLALT
     12113--CALLALT 12136--CALLALT 12144--CALLALT
ITW_FREEZE
     10011**DCL     13000<<ASSIGN  13009>>IF      13022>>IF      13028<<ASSIGN
ITX$INITS
      9815**DCL-ENT 12890--CALL
ITX$INITS2
      9816**DCL-ENT 12891--CALL
ITZ$RECOVER
      9837**DCL-ENT 11982--CALL
IT_BOOTFLAG
     11600**DCL     11980>>IF      12230>>IF      12342>>IF      12651>>IF      12699>>IF      12945>>IF
IT_CLOFF
      9985**DCL     11975<<ASSIGN  11977<>CALL
IT_CONFIG.IOM.PORT
     11651**DCL     11963>>IF
IT_CONFIG.SC01.CHAN
     11654**DCL     11963>>IF
IT_DATASIZE
      9898**DCL     12347<<ASSIGN  12684<<ASSIGN  12728>>ASSIGN
IT_DBUF
     11604**DCL     12345<>CALL    12353--ASSIGN  12744<>CALL
IT_DBUFEND
     11605**DCL     12345<>CALL    12744<>CALL
IT_DUMPSIZE
     11603**DCL     12713>>ASSIGN  12720>>IF
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:280  
IT_FEI$$
     11590**DCL     12030>>ASSIGN
IT_MMDSMAX
     11606**DCL     12649>>ASSIGN
IT_PARTITION.DEVICE
     11624**DCL     11984>>IF      12626>>IF      12634>>IF      12752>>IF      12771>>IF      12796>>IF
IT_PARTITION.IOCHAN
     11624**DCL     11855>>IF      12409>>IF      12815>>IF      12858>>IF      12876>>IF
IT_PARTITION.MSOS_DEVICE
     11624**DCL     11984>>IF      12626>>IF      12634>>IF      12779>>IF      12804>>IF
IT_PARTITION.MSOS_IOCHAN
     11624**DCL     12827>>IF      12867>>IF
IT_SCPUHJIT
     11599**DCL     12152<<ASSIGN  12157<<ASSIGN
IT_SCPUJIT
     11598**DCL     11909<>CALL    11933<>CALL    12151<<ASSIGN  12156<<ASSIGN
IT_SCPUWSPTD
     11597**DCL     12150<<ASSIGN  12155<<ASSIGN
IT_SYSDIR$
     11596**DCL     12024<<ASSIGN  12361>>ASSIGN
IT_SYSDISK
     11602**DCL     12222<<ASSIGN  12638>>IF
IT_TIGRCUB
     11616**DCL     12351>>IF
J
      9870**DCL     11867<>CALL    11881<<DOINDEX 11882>>IF      11883>>ASSIGN  11909<>CALL    11929<>CALL
     11933<>CALL    11948<>CALL    11958<>CALL    12040<<DOINDEX 12041>>ASSIGN  12042>>ASSIGN  12053<<DOINDEX
     12054>>ASSIGN  12201<<DOINDEX 12202>>IF      12203>>ASSIGN  12402<>CALL    12421<<DOINDEX 12422>>ASSIGN
     12430<<ASSIGN  12431>>ASSIGN  12449<<DOINDEX 12450>>ASSIGN  12471<<DOINDEX 12472>>ASSIGN  12490<<DOINDEX
     12491>>ASSIGN  12513<<DOINDEX 12514>>IF      12515>>ASSIGN  12516>>ASSIGN  12516>>ASSIGN  12518>>ASSIGN
     12519>>ASSIGN  12520>>ASSIGN  12524>>ASSIGN  12548<<DOINDEX 12549>>IF      12550>>ASSIGN  12551>>ASSIGN
     12552>>ASSIGN  12553>>ASSIGN  12565<<DOINDEX 12566>>IF      12567>>ASSIGN  12568>>ASSIGN  12569>>ASSIGN
     12570>>ASSIGN  12595<<DOINDEX 12596>>ASSIGN  12607<<DOINDEX 12608>>IF      12609>>ASSIGN  12612>>ASSIGN
     12614<<ASSIGN  12647<>CALL    12655<<DOINDEX 12656>>ASSIGN  12669<<DOINDEX 12670>>ASSIGN  12685<<DOINDEX
     12686>>ASSIGN  12812<<DOINDEX 12813>>ASSIGN  12815>>IF      12817>>ASSIGN  12823>>CALLBLT 12827>>IF
     12857<<ASSIGN  12858>>IF      12867>>IF      12868>>ASSIGN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:281  
J IN PROCEDURE IOSPIN
     12995**DCL     13006<<DOINDEX 13007>>ASSIGN  13013>>CALLBLT
K
      9871**DCL     12044<<ASSIGN  12045<>CALL    12056<<ASSIGN  12057<>CALL    12442<<ASSIGN  12443<>CALL
     12450<<ASSIGN  12451>>ASSIGN  12452>>IF      13078<<DOINDEX 13079>>ASSIGN  13079>>ASSIGN
KI$FEI.BD$
     11735**DCL     11736--REDEF
KI$FEI.BDAD.WADDR
     11737**DCL     11738--REDEF
KI$FEI.FECH
     11702**DCL     12857>>ASSIGN
KI$FEI.FEP#
     11745**DCL     12859>>ASSIGN
KI$FEI.RCVPB
     11751**DCL     11752--REDEF
KI$FEI$
       644**DCL     12030<<ASSIGN  12030>>ASSIGN  12857>>ASSIGN  12859>>ASSIGN
KI$OSIROUTE
     10285**DCL     12052<<ASSIGN  12056--ASSIGN
KI$OSIROUTE.LINK
     10450**DCL     12054<<ASSIGN  12056--ASSIGN
KI$OSIROUTE.LNSAP.ADDRESS_N
     10427**DCL     10428--REDEF
KI$OSIROUTE.NSAP.ADDRESS_N
     10337**DCL     10338--REDEF
KI$OSIROUTE$
     10486**DCL     12051<<ASSIGN
KI$ROUTE
     10147**DCL     12036<<ASSIGN  12044--ASSIGN
KI$ROUTE.ALT_QOS
     10164**DCL     12039<<ASSIGN
KI$ROUTE.CURRENT_QOS
     10163**DCL     12038<<ASSIGN
KI$ROUTE.LINK
     10176**DCL     12041<<ASSIGN  12044--ASSIGN
KI$ROUTE.LINK.QOS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:282  
     10185**DCL     12042<<ASSIGN
KI$ROUTE.NODE_NAME
     10148**DCL     12037<<ASSIGN
KI$ROUTE$
     10597**DCL     12035<<ASSIGN
KIQ$FEINT
      9848**DCL-ENT 11882--IF
KIQ$PARTFEP
      9849**DCL-ENT 12443--CALL
KIS_MAJOR$
     11612**DCL     12077<<ASSIGN  12081>>ASSIGN  12082>>ASSIGN  12084>>ASSIGN  12084>>ASSIGN  12087>>ASSIGN
     12093>>ASSIGN  12097>>ASSIGN  12097>>ASSIGN  12100>>ASSIGN  12103>>ASSIGN  12103>>ASSIGN
KIS_MINOR$
     11613**DCL     12062<<ASSIGN  12066>>ASSIGN  12074>>ASSIGN
KIS_SSN_CLIENTS
     11607**DCL     12078>>ASSIGN  12096>>DOINDEX 12103>>ASSIGN  12107>>ASSIGN
KIS_SSN_MAX
     11609**DCL     12063>>ASSIGN  12067>>DOINDEX 12074>>ASSIGN  12106>>ASSIGN
KIS_SSN_MAXMAJOR
     11611**DCL     12107<<ASSIGN
KIS_SSN_MAXMINOR
     11610**DCL     12106<<ASSIGN
KIS_SSN_SERVERS
     11608**DCL     12078>>ASSIGN  12082>>ASSIGN  12083>>DOINDEX 12093>>ASSIGN  12107>>ASSIGN
KI_FEI$$
       643**DCL       644--IMP-PTR 12027<<ASSIGN  12030>>ASSIGN  12857>>ASSIGN  12859>>ASSIGN
KI_MXFE
       652**DCL     12028>>CALL    12029>>DOINDEX 12040>>DOINDEX 12044>>ASSIGN  12053>>DOINDEX 12056>>ASSIGN
     12856>>DOINDEX
KI_NODES
       651**DCL     12034>>DOINDEX
KI_OSIMAX#
       646**DCL     12050>>DOINDEX
KI_OSIROUTE$$
       647**DCL     10486--IMP-PTR 12051>>ASSIGN
KI_ROUTE$$
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:283  
       645**DCL     10597--IMP-PTR 12035>>ASSIGN
L66_CPU_BF
     11804**DCL     12257>>ASSIGN
L66_CPU_MEM_SIZE
     11800**DCL     12256>>ASSIGN
LAP_TIME
     10001**DCL     13026<>CALL    13027>>IF
LOCAL_DATE
      9993**DCL     11976<>CALL
LOCAL_DATE.D
      9996**DCL     11974<<CALLBLT
LOCAL_DATE.M
      9994**DCL     11973<<CALLBLT
LOCAL_DATE.S1
      9995**DCL     11970<<ASSIGN
LOCAL_DATE.S2
      9997**DCL     11971<<ASSIGN
LOCAL_DATE.Y
      9998**DCL     11972<<CALLBLT
LOG_SU#
      9960**DCL     12306<<ASSIGN  12308<<ASSIGN  12310<<ASSIGN  12314>>IF      12319>>ASSIGN  12326>>ASSIGN
LOWER_STORE_SIZE
      9958**DCL     12297<<ASSIGN  12319>>ASSIGN  12326>>ASSIGN
LOWREAL_DA
      9899**DCL     12367<<ASSIGN  12659<>CALL    12660<<ASSIGN  12660>>ASSIGN  12661>>IF
LP_WORD
      9889**DCL      9890--REDEF   12589<<ASSIGN  12603>>ASSIGN
LP_WORD_BITS
      9890**DCL     12599<<ASSIGN
MAX_DA
      9893**DCL     12369<<ASSIGN
MAX_NUM_PORTS
      9901**DCL     12248<<ASSIGN  12249<<ASSIGN  12250>>DOINDEX
MCA_CFG.LEVEL_1.CONSOLE_CNTL
     10559**DCL     10565--REDEF   10569--REDEF
MCA_CFG.LEVEL_1.LOG_CHNS
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:284  
     10583**DCL     12421>>DOINDEX
MCA_CFG.LEVEL_1.PRI_CHN
     10582**DCL     12420>>ASSIGN
MCA_CFG.LEVEL_1.STATE
     10558**DCL     12418>>IF
MINI_DATA.OK2WRVID
     11564**DCL     12716<<ASSIGN  12716>>ASSIGN
MIN_DA
      9894**DCL     12357<<ASSIGN  12661>>IF      12674>>IF      12692>>IF      12713<<ASSIGN  12715>>ASSIGN
     12720>>IF      12730>>ASSIGN
MM$DESC.BOUND
      2842**DCL      2843--REDEF
MM$DESC.FLGS
      2843**DCL      2843--REDEF
MM$IPHY_MAP
      4785**DCL     12150>>ASSIGN  12151>>ASSIGN  12152>>ASSIGN
MM$PPUT.USER#
      2831**DCL      2831--REDEF
MMB$GNPP
      9829**DCL-ENT 11865--CALL
MMB$GPP
      9828**DCL-ENT 11844--CALL
MME$CVM
      9825**DCL-ENT 11845--CALL    11849--CALL    11867--CALL    11909--CALL    11929--CALL    11933--CALL
     11948--CALL    12294--CALL
MME$WFVP
      9826**DCL-ENT 11958--CALL
MMH$FDS
      9823**DCL-ENT 12161--CALL    12164--CALL    12167--CALL    12170--CALL    12173--CALL    12647--CALL
MMH$GDS
      9824**DCL-ENT 12402--CALL
MM_BYP$
      2762**DCL      2762--IMP-PTR
MM_CGQMAP_PGS
      2768**DCL     11956>>ASSIGN
MM_DSMAX
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:285  
      2765**DCL     12401<<ASSIGN  12647>>CALL    12649<<ASSIGN
MM_FPMC
      2768**DCL     11847>>ASSIGN
MM_HELD
      2765**DCL     12175<<ASSIGN
MM_RDS
      2765**DCL     12175>>ASSIGN  12175>>ASSIGN  12175>>ASSIGN  12175>>ASSIGN  12175>>ASSIGN  12175>>ASSIGN
     12175>>ASSIGN  12175>>ASSIGN
MM_SCTDFT
      2768**DCL     11844<>CALL    11845<>CALL    11850<<ASSIGN  11850>>ASSIGN
MONDATA_DA
      9895**DCL     12363<<ASSIGN  12671<>CALL    12673<<ASSIGN  12673>>ASSIGN  12674>>IF
MONDATA_SIZE
      9896**DCL     12364<<ASSIGN  12669>>DOINDEX
MPC$
      9927**DCL     12434<<ASSIGN  12445>>IF      12450>>ASSIGN  12458>>ASSIGN  12459>>ASSIGN  12472<<ASSIGN
     12473>>IF      12475>>DOSELCT 12475>>DOSELCT 12477>>ASSIGN  12479>>ASSIGN  12481>>ASSIGN  12483>>ASSIGN
     12485>>IF
MPC_PART
     12446**LABEL   12456--EXIT
N$DCT$
      1834**DCL     11963>>IF      11963>>IF      11984>>IF      11984>>IF      11989>>ASSIGN  11990>>CALL
     11991>>CALL    12009<<ASSIGN  12012>>DOWHILE 12013<<ASSIGN  12013>>ASSIGN  12018<<ASSIGN  12220>>IF
     12220>>IF      12411>>CALL    12467>>ASSIGN  12491>>ASSIGN  12499>>DOWHILE 12502>>ASSIGN  12596>>ASSIGN
     12608>>IF      12609>>ASSIGN  12638>>IF      12751>>ASSIGN  12769>>IF      12770>>IF      12772>>ASSIGN
     12775>>ASSIGN  12780>>IF      12780>>IF      12781>>CALL    12783>>ASSIGN  12786>>ASSIGN  12787>>ASSIGN
     12794>>IF      12795>>IF      12797>>ASSIGN  12800>>ASSIGN  12805>>ASSIGN  12806>>ASSIGN
N$DCT$$
      1700**DCL      1834--IMP-PTR 11963>>IF      11963>>IF      11984>>IF      11984>>IF      11989>>ASSIGN
     11990>>CALL    11991>>CALL    12012>>DOWHILE 12013>>ASSIGN  12021<<ASSIGN  12220>>IF      12220>>IF
     12411>>CALL    12467>>ASSIGN  12491>>ASSIGN  12499>>DOWHILE 12502>>ASSIGN  12596>>ASSIGN  12608>>IF
     12609>>ASSIGN  12638>>IF      12751>>ASSIGN  12769>>IF      12770>>IF      12772>>ASSIGN  12775>>ASSIGN
     12780>>IF      12780>>IF      12781>>CALL    12783>>ASSIGN  12786>>ASSIGN  12787>>ASSIGN  12794>>IF
     12795>>IF      12797>>ASSIGN  12800>>ASSIGN  12805>>ASSIGN  12806>>ASSIGN
N$FQ$
      1700**DCL      1835--IMP-PTR
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:286  
N$REQ.BUFADDR
     10630**DCL     10631--REDEF   10631--REDEF
N$REQ.DLA.DRELADDR
     10622**DCL     10622--REDEF
N$REQ.DVE.EOMCHAR
     10659**DCL     10660--REDEF
N$REQ.EAINFO
     10653**DCL     10653--REDEF
N$REQ.EAINFOX
     10653**DCL     10654--REDEF
N$REQ.EVNTINFO
     10654**DCL     10654--REDEF
N$REQ.STATUS
     10635**DCL     10641--REDEF
N$REQ_INIT.BUFADDR
      1719**DCL      1720--REDEF    1720--REDEF
N$REQ_INIT.DLA.DRELADDR
      1711**DCL      1711--REDEF
N$REQ_INIT.DVE.EOMCHAR
      1748**DCL      1749--REDEF
N$REQ_INIT.EAINFO
      1742**DCL      1742--REDEF
N$REQ_INIT.EAINFOX
      1742**DCL      1743--REDEF
N$REQ_INIT.EVNTINFO
      1743**DCL      1743--REDEF
N$REQ_INIT.STATUS
      1724**DCL      1730--REDEF
NEXTCRPFW
     12565**LABEL   12555--GOTO
NEXTFWDEV
     12502**LABEL   13045--GOTO
NI$CHT.DQH$
     10605**DCL     11883>>ASSIGN  12202>>IF      12216>>IF      12218>>ASSIGN  12422>>ASSIGN  12431>>ASSIGN
     12451>>ASSIGN  12813>>ASSIGN  12868>>ASSIGN  13007>>ASSIGN
NI$CHT.POSTER
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:287  
     10605**DCL     11882>>IF
NI$CHT$
      1759**DCL     10605--IMP-PTR 11882>>IF      11883>>ASSIGN  12202>>IF      12216>>IF      12218>>ASSIGN
     12422>>ASSIGN  12431>>ASSIGN  12451>>ASSIGN  12813>>ASSIGN  12868>>ASSIGN  13007>>ASSIGN
NI$DCT
     10039**DCL     11990<>CALL    11991<>CALL    12630<>CALL    12635<>CALL    12755<>CALL    12781<>CALL
NI$DCT.CTYP
     10047**DCL     12510>>IF
NI$DCT.DEVNM
     10039**DCL     12606>>CALLBLT 12608>>IF      12772>>ASSIGN  12775>>ASSIGN  12783>>ASSIGN  12797>>ASSIGN
     12800>>ASSIGN
NI$DCT.DFLG.CONSOLE
     10042**DCL     12780>>IF
NI$DCT.DFLG.MPCSTOP
     10044**DCL     11989<<ASSIGN  12629<<ASSIGN  12754<<ASSIGN
NI$DCT.DP
     10059**DCL     10066--REDEF   10069--REDEF   10070--REDEF   10072--REDEF   10072--REDEF   10073--REDEF
     10074--REDEF   10074--REDEF
NI$DCT.DQH$
     10055**DCL     11963>>IF      11963>>IF      12411>>CALL    12597>>ASSIGN
NI$DCT.DVN
     10048**DCL     12220>>IF
NI$DCT.DVT$
     10055**DCL     12475>>DOSELCT
NI$DCT.MODX
     10048**DCL     12475>>DOSELCT
NI$DCT.MPC.ALTMPCX
     10068**DCL     12611<<ASSIGN  12612<<ASSIGN
NI$DCT.MPC.CRPCHANS
     10068**DCL     12604<<ASSIGN
NI$DCT.MPC.CRPNAME
     10069**DCL     12566>>IF      12576--ASSIGN  12577>>ASSIGN
NI$DCT.MPC.FW$
     10067**DCL     12523<<ASSIGN  12636>>IF      12637<<ASSIGN
NI$DCT.MPC.FWNAME
     10069**DCL     11984>>IF      12477<<ASSIGN  12479<<ASSIGN  12481<<ASSIGN  12483<<ASSIGN  12514>>IF
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:288  
     12528>>IF      12530--ASSIGN  12531>>ASSIGN  12591>>IF      12605>>IF      12610>>IF      12626>>IF
     12752>>IF
NI$DCT.MPC.IOCHAN.CHAN
     10067**DCL     12588>>ASSIGN
NI$DCT.MPC.IOCHANX
     10067**DCL     10067--REDEF   12450>>ASSIGN
NI$DCT.MPC.LPCHANS
     10068**DCL     12603<<ASSIGN
NI$DCT.MPC.LPNAME
     10069**DCL     12549>>IF      12559--ASSIGN  12560>>ASSIGN
NI$DCT.MPC.TYPE
     10067**DCL     12546>>IF
NI$DCT.RAT$
     10040**DCL     12780>>IF
NI$DCT.SQH$
     10054**DCL     12470>>ASSIGN  12595>>DOINDEX 12638>>IF      12638>>IF
NI$DCT.STATUS.DOWN
     10056**DCL     12458<<ASSIGN  12485>>IF      12492<<ASSIGN  12786<<ASSIGN  12805<<ASSIGN
NI$DCT.STATUS.MSOS_PART
     10058**DCL     12459<<ASSIGN  12493<<ASSIGN  12787<<ASSIGN  12806<<ASSIGN
NI$DCT.TYPE
     10049**DCL     11984>>IF      12220>>IF      12468>>IF      12503>>IF      12598>>IF      12752>>IF
     12770>>IF      12795>>IF
NI$DQH
     10132**DCL     12411<>CALL
NI$DQH.FEX
     10135**DCL     12442>>ASSIGN
NI$DQH.FL$
     10132**DCL     12834>>DOWHILE 12835>>ASSIGN
NI$DQH.IOCHAN.CHANNEL
     10135**DCL     11963>>IF      12597>>ASSIGN
NI$DQH.IOCHAN.IOM
     10135**DCL     11963>>IF
NI$DQH.IOCHANX
     10134**DCL     10135--REDEF
NI$DQH.IOSTATUS$
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:289  
     10139**DCL     11886<<ASSIGN
NI$DQH.IPCNUM
     10143**DCL     12425<<ASSIGN  12436>>IF
NI$DQH.MBX$
     10143**DCL     10144--REDEF   11885<<ASSIGN
NI$DQH.MPC$
     10139**DCL     12434>>ASSIGN  12815>>IF
NI$DQH.SQH$
     10138**DCL     12218>>ASSIGN  12435>>ASSIGN  12830>>IF      12832>>ASSIGN  12836>>IF      12840>>ASSIGN
     12845>>CALL
NI$DQH.STATE
     10136**DCL     13009>>IF      13018>>IF
NI$DQH.STATUS.DOWN
     10132**DCL     12440<<ASSIGN  12447<<ASSIGN  12452>>IF      12828<<ASSIGN  12869<<ASSIGN
NI$DQH.STATUS.MSOS_PART
     10134**DCL     12441<<ASSIGN  12448<<ASSIGN  12829<<ASSIGN  12870<<ASSIGN
NI$DVT.MODEL
     10092**DCL     12475>>DOSELCT
NI$DVT.MPC
     10094**DCL     10095--REDEF
NI$FQ.HD$
      1836**DCL     11871<<ASSIGN  11872>>ASSIGN  11878>>ASSIGN
NI$FQ$
      1760**DCL      1836--IMP-PTR 11871>>ASSIGN  11872>>ASSIGN  11878>>ASSIGN
NI$FW
     10599**DCL     12517<<ASSIGN
NI$FW.CRPDA
     10599**DCL     12569<<ASSIGN
NI$FW.FW
     10602**DCL     12521--ASSIGN
NI$FW.FWDA
     10599**DCL     12518<<ASSIGN
NI$FW.FWOL
     10599**DCL     12519<<ASSIGN  12520<<ASSIGN  12553<<ASSIGN  12570<<ASSIGN
NI$FW.IDCW.EXTA
     10600**DCL     10600--REDEF
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:290  
NI$FW.LPDA
     10599**DCL     12552<<ASSIGN
NI$IBUF$
      1760**DCL      1836--IMP-PTR
NI$IMW$
      1760**DCL     11862<<ASSIGN  11892<<ASSIGN
NI$IMXMBX_INIT.PAGED_BASE
      1770**DCL      1771--REDEF    1771--REDEF
NI$IMXMBX_INIT.SIZE
      1772**DCL      1772--REDEF
NI$IOM.ADDRESS
     10609**DCL     11854>>ASSIGN  11963>>IF      12211>>IF
NI$IOM$
      1782**DCL     11854>>ASSIGN  11963>>IF      12211>>IF      12211>>IF
NI$REQ.DCW
     10109**DCL     10112--REDEF
NI$REQ.DCW.TALLY
     10110**DCL     10110--REDEF
NI$REQ.FL$
     10107**DCL     11874<<ASSIGN  11878<<ASSIGN
NI$REQ.IDCW.EXTA
     10112**DCL     10112--REDEF
NI$REQ.PCW
     10114**DCL     10118--REDEF
NI$REQ.SEEK
     10119**DCL     10120--REDEF   10121--REDEF
NI$REQ_INIT.DCW
      1794**DCL      1797--REDEF
NI$REQ_INIT.DCW.TALLY
      1795**DCL      1795--REDEF
NI$REQ_INIT.IDCW.EXTA
      1797**DCL      1797--REDEF
NI$REQ_INIT.PCW
      1799**DCL      1803--REDEF
NI$REQ_INIT.SEEK
      1804**DCL      1805--REDEF    1806--REDEF
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:291  
NI$RP$
      1808**DCL      1838--IMP-PTR
NI$SQH.CQ$
     10088**DCL     12830>>IF      12832>>ASSIGN  12836>>IF      12840<<ASSIGN  12845<>CALL
NI$SQH.DOOR
     10087**DCL     10087--REDEF
NI$SQH.FDCT
     10087**DCL     12219>>DOINDEX 12219>>DOINDEX 12490>>DOINDEX 12490>>DOINDEX
NI$SQH.MPC$
     10089**DCL     12472>>ASSIGN
NI$SQH.NDCT
     10088**DCL     12219>>DOINDEX 12490>>DOINDEX 12595>>DOINDEX
NII$LIP
      9812**DCL-ENT 12893--CALL
NIM$DEQUEUE
      4811**DCL-ENT 12845--CALL
NIM$INTDIS
      9806**DCL-ENT 11816--DCLINIT
NIM$WRDSBL
      9808**DCL-ENT 12744--CALL
NIM$WRENBL
      9807**DCL-ENT 12345--CALL
NIQ$GETS
      9809**DCL-ENT 11884--CALL
NIW$LDFW
      9813**DCL-ENT 12635--CALL
NIW$MPCSTART
      9810**DCL-ENT 11991--CALL    12630--CALL    12755--CALL
NIW$MPCSTOP
      9811**DCL-ENT 11990--CALL
NI_CHANS
      1808**DCL     12200<<ASSIGN  12203<<ASSIGN  12812>>DOINDEX 13006>>DOINDEX
NI_ENTADDR
     11816**DCL     11817--REDEF
NI_ENTRY.LOC
     11818**DCL     11895>>ASSIGN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:292  
NI_IMXLO_PBASE
      1810**DCL     11863<<ASSIGN  11893<<ASSIGN
NI_INTENTRY
      1810**DCL     11896>>ASSIGN
NI_INTENTRY.LOC
      1811**DCL     11895<<ASSIGN
NI_IOMS
      1812**DCL     11853>>DOINDEX 11880>>DOINDEX 12199>>DOINDEX 12208>>ASSIGN  12210>>DOINDEX 12408>>DOINDEX
     12811>>DOINDEX 12875>>DOINDEX 13005>>DOINDEX
NI_MAINT_DCTX
      1812**DCL     12411>>CALL
NI_MAX_CHANS
      1813**DCL     12208<<ASSIGN
NI_MBX_INIT.DCW.CONTROL.AE
      1830**DCL      1830--REDEF
NI_MBX_INIT.LPW
      1825**DCL     12194<<ASSIGN
NI_MBX_INIT.LPW.CONTROL.AE
      1826**DCL      1826--REDEF
NI_MBX_INIT.SCW
      1828**DCL     12195<<ASSIGN
NI_NUMIOQ
      1833**DCL     12748>>IF
NI_NUMIOS
      1833**DCL     11873>>DOINDEX 12748>>IF
NI_RELIOS
      1834**DCL     12748<<ASSIGN
NKP$PART
      9844**DCL-ENT 12781--CALL
NK_MXLOCAL
     11587**DCL     11962>>DOINDEX 11983>>DOINDEX 12466>>DOINDEX 12607>>DOINDEX 12614>>ASSIGN  12750>>DOINDEX
     12768>>DOINDEX 12793>>DOINDEX
NO_FW
     13031**LABEL   12402--CALLALT
N_DCTXMAX
      1808**DCL     12017>>DOINDEX 12023>>CALL
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:293  
OFFSET
      9885**DCL     12592<<ASSIGN  12593<<ASSIGN  12599>>ASSIGN  12600>>ASSIGN
ONQUEUE
     10010**DCL     12833<<ASSIGN  12834>>DOWHILE 12837<<ASSIGN  12839>>IF
PORT#
      9953**DCL     11854<<ASSIGN  11855<>CALL    12250<<DOINDEX 12251>>ASSIGN  12257>>ASSIGN  12258>>IF
     12261>>ASSIGN  12261>>ASSIGN  12265>>ASSIGN  12268>>ASSIGN  12276>>IF      12296>>ASSIGN  12298>>ASSIGN
     12329>>ASSIGN
PORT_MEM_SIZE
      9955**DCL     12256<<ASSIGN  12260<<ASSIGN  12260>>ASSIGN  12264<<ASSIGN  12267<<ASSIGN  12280>>ASSIGN
     12288>>ASSIGN
PORT_START_ADDR
      9954**DCL     12280<<ASSIGN  12288<<ASSIGN  12293>>ASSIGN  12294>>CALL    12319>>ASSIGN  12326>>ASSIGN
PPNO
     10003**DCL     11864<<ASSIGN  11865<>CALL    11867>>CALL
PTR$
        16**DCL        14--PROC    12009>>ASSIGN  12013>>ASSIGN  12018>>ASSIGN  12021>>ASSIGN  12023<>CALL
     12024>>ASSIGN  12025<>CALL    12027>>ASSIGN  12028<>CALL    12035>>ASSIGN  12036>>ASSIGN  12037>>ASSIGN
     12038>>ASSIGN  12039>>ASSIGN  12041>>ASSIGN  12042>>ASSIGN  12045<>CALL    12051>>ASSIGN  12052>>ASSIGN
     12054>>ASSIGN  12057<>CALL    12062>>ASSIGN  12064<>CALL    12077>>ASSIGN  12079<>CALL    12111>>ASSIGN
     12113<>CALL    12134>>ASSIGN  12136<>CALL    12142>>ASSIGN  12144<>CALL    12347>>ASSIGN  12680>>ASSIGN
P_AUTOSPACE
       299**DCL     12131<<ASSIGN  12131>>ASSIGN  12132>>ASSIGN  12136>>CALL    12137>>DOINDEX 12144>>CALL
     12145>>DOINDEX
P_AUTO_START
       297**DCL     12129<<ASSIGN  12130>>ASSIGN  12131>>ASSIGN  12132>>ASSIGN
P_LAST_AUTO
       298**DCL     12132<<ASSIGN
P_MAXPROCS
       296**DCL     12113>>CALL    12124>>DOINDEX 12129>>ASSIGN  12144>>CALL    12145>>DOINDEX
P_NSCPU
       612**DCL       613--REDEF
P_RESOURCE.RES
       485**DCL       552--REDEF
P_RESOURCE$
       565**DCL       453--IMP-PTR
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:294  
P_UPTIME
       601**DCL       602--REDEF
P_USED_AUTO
       300**DCL     12130<<ASSIGN
REAL.L30
     11555**DCL     11896<<ASSIGN
REQ$
      9918**DCL      9919--REDEF   11872<<ASSIGN  11874>>ASSIGN  11874>>ASSIGN  11875<<ASSIGN  11875>>ASSIGN
     11877<<ASSIGN  11877>>ASSIGN  11878>>ASSIGN  11884<>CALL    11885>>ASSIGN  11886>>ASSIGN  12160<<ASSIGN
     12163<<ASSIGN  12166<<ASSIGN  12169<<ASSIGN  12172<<ASSIGN  12400<<ASSIGN  12521<<ASSIGN  12609<<ASSIGN
     12610>>IF      12611>>ASSIGN  12646<<ASSIGN  12653<<ASSIGN  12657>>ASSIGN  12667<<ASSIGN  12671<>CALL
     12680<<ASSIGN  12683<<ASSIGN  12687>>ASSIGN  13070>>ASSIGN  13071<<ASSIGN  13071>>ASSIGN  13079>>ASSIGN
     13081<<ASSIGN  13081>>ASSIGN
REREQ$.OFFSET
      9920**DCL     12656<<ASSIGN  12670<<ASSIGN  12681>>ASSIGN  12686<<ASSIGN
REREQ$.SEGID
      9922**DCL     12161<>CALL    12164<>CALL    12167<>CALL    12170<>CALL    12173<>CALL    12402<>CALL
     12647<>CALL
RSCR_ADDR
      9957**DCL     12282<<ASSIGN  12290<<ASSIGN  12295<>CALL
RSLT
      9886**DCL     12773<>CALL    12798<>CALL    12819<>CALL    12860<>CALL    12878<>CALL
RSW2
      9978**DCL     12246<<ASSIGN
RSW2.DPSE_2WAY
      9979**DCL      9980--REDEF   12276>>IF
RSW2.L66_SIZE_MULT
      9980**DCL     12258>>IF
RV_BOOTID.C
     11795**DCL     12384>>ASSIGN
SCU_BF
     11810**DCL     12298>>ASSIGN
SCU_CONFIG
      9970**DCL     12295<>CALL    12296>>ASSIGN
SCU_CONFIG.INTERLACE
      9975**DCL     12314>>IF
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:295  
SCU_CONFIG.LOWER_STORE
      9976**DCL     12302>>IF      12330>>IF
SCU_CONFIG.ON_LINE
      9973**DCL     12299>>ASSIGN
SCU_CONFIG.SIZE
      9972**DCL     12297>>ASSIGN  12298>>ASSIGN
SCU_MEM_SIZE
     11808**DCL     12297>>ASSIGN
SKIP_FW
     12612**LABEL   12511--GOTO
SQH$
      9923**DCL     12218<<ASSIGN  12219>>DOINDEX 12219>>DOINDEX 12219>>DOINDEX 12435<<ASSIGN  12438>>IF
     12470<<ASSIGN  12472>>ASSIGN  12490>>DOINDEX 12490>>DOINDEX 12490>>DOINDEX
SSC$MONTIMR
      9818**DCL-ENT 12893--CALL    12895--CALL
SSR$CHSE
      9821**DCL-ENT 12933--CALL
SSS$CACHEBP
      9859**DCL-ENT 12961--CALL    12980--CALL
SSS$CURTIME
      9819**DCL-ENT 12999--CALL    13026--CALL
SSS$TIME
      9820**DCL-ENT 12901--CALL
SSW$BYPASSCACHE
      9864**DCL-ENT 12939--CALL
SSW$LOGSTRT
      9860**DCL-ENT 12940--CALL    12966--CALL
SSW$USECACHE
      9861**DCL-ENT 12987--CALL
STARTGHOST1
     12748**LABEL   12230--GOTO    12342--GOTO    12351--GOTO
START_TIME
     10000**DCL     12999<>CALL    13001<>CALL
STOPBOOT
     12716**LABEL   12704--GOTO    12711--GOTO
STOREUNIT#
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:296  
      9952**DCL     12244<<ASSIGN  12319>>ASSIGN  12326>>ASSIGN  12329>>ASSIGN  12331>>ASSIGN  12332>>ASSIGN
     12333>>ASSIGN  12334<<ASSIGN  12334>>ASSIGN
SU.ONLINE
      9962**DCL      9963--REDEF   12312>>IF
SU.ONLINE_REDEF
      9963**DCL     12299<<ASSIGN
SU#
      9959**DCL     12300<<DOINDEX 12304>>IF      12306>>ASSIGN  12308>>ASSIGN  12310>>ASSIGN  12312>>IF
     12331>>ASSIGN  12332>>ASSIGN
SUB_BUF
      9914**DCL     12532--CALL    12561--CALL    12578--CALL
SUB_BUF.COUNT
      9915**DCL     12530<<ASSIGN  12559<<ASSIGN  12576<<ASSIGN
SUB_BUF.TEXT
      9916**DCL     12531<<ASSIGN  12560<<ASSIGN  12577<<ASSIGN
S_CTUIS
      5313**DCL     12905<<ASSIGN
S_CUIS
      5313**DCL     12904<<ASSIGN
S_MPSTATE
      5316**DCL     12945>>IF      12945>>IF      12947<<ASSIGN  12951<<ASSIGN  12962>>IF      12981>>IF
S_NSCPU
      5317**DCL     11898>>ASSIGN  11899<<ASSIGN  11900>>DOWHILE 11901<<ASSIGN  11901>>ASSIGN  11905>>IF
     11908>>DOINDEX 11932>>DOINDEX 12941>>DOINDEX 12979>>DOINDEX
S_NSCPUA
      5317**DCL     12965<<ASSIGN  12965>>ASSIGN  12986>>IF
S_PNO
     11617**DCL     12243>>ASSIGN  12246>>ASSIGN  12247>>IF      12254>>DOCASE  12276>>IF
S_PORTNR
      5316**DCL     12944>>CALLBLT 12949>>IF      12959<>CALL    12973<>CALL
S_PRIOB
      5303**DCL     12910>>ASSIGN  12911>>ASSIGN
S_PTYPE
      5317**DCL     12247>>IF      12254>>DOCASE  12276>>IF
S_SYSID
      5319**DCL     11999<<ASSIGN
PL6.E3A0      #001=ITW$WRAPUP File=ITW$WRAPUP.:E05TSI                            TUE 07/29/97 23:10 Page:297  
S_TIMR
     11588**DCL     12404<<ASSIGN
TDQH$
     10008**DCL     12832<<ASSIGN  12834>>DOWHILE 12835<<ASSIGN  12835>>ASSIGN  12836>>IF      12840>>ASSIGN
TEXT_C
      9873**DCL     12776--CALL    12801--CALL    12824--CALL    12864--CALL    12882--CALL    13015--CALL
TEXT_C.L
      9874**DCL     12774<<ASSIGN  12782<<ASSIGN  12799<<ASSIGN  12820<<ASSIGN  12861<<ASSIGN  12879<<ASSIGN
     13014<<ASSIGN
TEXT_C.T
      9875**DCL     12775<<ASSIGN  12783<<ASSIGN  12784<<ASSIGN  12800<<ASSIGN  12821<<ASSIGN  12822<<CALLBLT
     12823<<CALLBLT 12862<<ASSIGN  12863<<CALLBLT 12880<<ASSIGN  12881<<CALLBLT 13011<<ASSIGN  13012<<CALLBLT
     13013<<CALLBLT
TIGRDATA_DA
      9897**DCL     12366<<ASSIGN  12689<>CALL    12691<<ASSIGN  12691>>ASSIGN  12692>>IF      12713>>ASSIGN
     12720>>IF      12729>>ASSIGN  12730>>ASSIGN  12741<>CALL
UMT$LCLDATE
      9846**DCL-ENT 11976--CALL
USER$
      9928**DCL     12596<<ASSIGN  12597>>ASSIGN  12598>>IF      12903<<ASSIGN  12907>>ASSIGN  12908>>ASSIGN
     12909>>ASSIGN  12910>>ASSIGN  12911>>ASSIGN  12912>>ASSIGN  12913>>ASSIGN
UTS_DATE
     10002**DCL     11976<>CALL    11977<>CALL
WONT_START
     12975**LABEL   12956--GOTO
XUD$UTS_ADJ_25TH
      8321**DCL-ENT 13001--CALL
XXX_CLOCK
      9986**DCL     11969<>CALL
XXX_CLOCK.DATE.D
      9990**DCL     11974>>CALLBLT
XXX_CLOCK.DATE.M
      9989**DCL     11973>>CALLBLT
XXX_CLOCK.DATE.Y
      9988**DCL     11972>>CALLBLT
