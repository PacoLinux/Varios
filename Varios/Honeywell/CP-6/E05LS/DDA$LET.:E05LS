VERSION E05

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:1    
        1        1        /*M*  DDA$LET - LET command do routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F*  NAME: DDA$LET
       10       10              PURPOSE:  The LET command allows the user to assign
       11       11                       constant values to variables and some special symbols.
       12       12                                                     */
       13       13        DDA$LET: PROC ALTRET;
       14       14                                                /* Locals */
       15       15    1   DCL DESC$ PTR;
       16       16    1   DCL VITEM$ PTR;
       17       17    1   DCL DTYP UBIN;
       18       18    1   DCL VALUE$ PTR;
       19       19    1   DCL SVALUE SBIN;
       20       20    1   DCL SIZE SBIN;
       21       21    1   DCL RSIZE UBIN;
       22       22    1   DCL INDXX SBIN;
       23       23    1   DCL POINTER UBIN;
       24       24    1   DCL 1 POINTR REDEF POINTER,
       25       25    1         2 ADR,
       26       26    1           3 W UBIN(18) UNAL,
       27       27    1           3 C UBIN(2) UNAL,
       28       28    1           3 B UBIN(4) UNAL,
       29       29    1         2 SEG UBIN(2) UNAL,
       30       30    1         2 DESC# UBIN(10) UNAL;
       31       31    1   DCL 1 PSDITEM REDEF POINTER,
       32       32    1         2 TYPE UBIN(6) UNAL,
       33       33    1         2 ID UBIN(9) UNAL,
       34       34    1         2 DISP UBIN(9) UNAL,
       35       35    1         2 SEGID UBIN(12) UNAL;
       36       36    1   DCL EXPR_VAL SBIN;
       37       37    1   DCL EXPR_OP UBIN;
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:2    
       38       38    1   DCL ADDR_TYPE UBIN;
       39       39    1   DCL ARRAY_FLAG BIT(1);
       40       40    1   DCL EIS UBIN;
       41       41    1   DCL TSCALE SBIN;
       42       42    1   DCL XVALUE(0:62) CHAR(1);
       43       43    1   DCL I UBIN;
       44       44    1   DCL VALUE SBIN;
       45       45    1   DCL CVALUE REDEF VALUE CHAR(4);
       46       46    1   DCL DVALUE BIT(72) DALIGNED;
       47       47    1   DCL DVALS(0:1) REDEF DVALUE UBIN;
       48       48    1   DCL SVALS(0:1) UBIN;
       49       49    1   DCL DO$ PTR;
       50       50                                                /* Misc */
       51       51    1   DCL USE$ PTR SYMREF;
       52       52        %INCLUDE OC_SUBS_C;
       53      783        %INCLUDE DD$BASED;
       54     2086        %U$SE;
       55     2094        %LET$CMD(STCLASS="BASED(DO$)");
       56     2144    1   DCL D_XDELTA BIT(1) SYMREF;
       57     2145        %INCLUDE DD_ERR_C;
       58     2542        %INCLUDE DD_EIS_C;
       59     2568        %INCLUDE DD_SUBS_C;
       60     2839        %INCLUDE DD$DITEM;
       12+    2942             %LIST;
       13+    2943    1        DCL SDD$ PTR;
       14+    2944    1        DCL ZITEM$ PTR;
       15+    2945    1        DCL SDD_L6$ PTR;
       16+    2946    1        DCL ZITEM_L6$ PTR;
       61     3520        %ZITEM;
       62     3592        %DITEM;
       63     3672        %DITEM (NAME=ITEM, STCLASS=AUTO);
       64     3752    1   DCL EMVNP(0:2) UBIN CONSTANT INIT(BITBIN('400000000007'O), BITBIN('400000000012'O),
              3752            BITBIN('400000000013'O));
       65     3753    1   DCL MVNP(0:2) UBIN CONSTANT INIT(BITBIN('400000000007'O), BITBIN('400000000010'O),
              3753            BITBIN('400000000011'O));
       66     3754    1   DCL MVNU(0:2) UBIN CONSTANT INIT(BITBIN('400000000014'O), BITBIN('400000000015'O),
              3754            BITBIN('400000000016'O));
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:3    
       67     3755             %INCLUDE XUH_MACRO_C;
       68     3839             %INCLUDE DD_SD_M;
       69     5175             %S_D;
       70     6493    1   DCL UBIN36 UBIN BASED;
       71     6494    1   DCL 1 TEXTC BASED,
       72     6495    1         2 SZ UBIN(9) UNAL,
       73     6496    1         2 TXT CHAR(TEXTC.SZ);
       74     6497                                                /* External routines */
       75     6498    1   DCL DDK$GETADDR ENTRY(9) ALTRET;
       76     6499    1   DCL DDK$PUTVAL ENTRY(13) ALTRET;
       77     6500    1   DCL DDK$PUTSPEC ENTRY(2);
       78     6501    1   DCL DDK$FROUND ENTRY(1);
       79     6502    1   DCL DUQ$OCMSG ENTRY(1);
       80     6503    1   DCL DUQ$WRERRLOG ENTRY(1);
       81     6504    1   DCL DDK$MCOMP1 ENTRY(1);
       82     6505    1   DCL DDK$MCOMP2 ENTRY(1);
       83     6506    1   DCL XPS_IFIX ENTRY(2);
       84     6507    1   DCL XPS_DFLOAT ENTRY(2);
       85     6508                                                /**/
       86     6509    1        IF S_D.RUM
       87     6510    2        THEN DO;
       88     6511    2             S_D.ERROR = 212;     /* E@BADCMD_RUM */
       89     6512    2             ALTRETURN;
       90     6513    2           END;
       91     6514    1        DO$ = S_D.DO$;
       92     6515    1        DESC$ = S_D.D$;
       93     6516    1        ZITEM$ = S_D.D$;
       94     6517    1        IF D_XDELTA
       95     6518    1          AND ZITEM.FLAGS.MDSE.S
       96     6519    1          AND NOT U$SE.CUR
       97     6520    2        THEN DO;
       98     6521    2             S_D.ERROR = 38;   /* E@USE_CONFLICT */
       99     6522    2             ALTRETURN;
      100     6523    2           END;
      101     6524    1        DTYP = ZITEM.FMT_SPEC;
      102     6525    2        DO CASE(ZITEM.DTYP);
      103     6526                                                /*
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:4    
      104     6527                                                 SIM_DTYP
      105     6528                                                 */
      106     6529    2          CASE( %SIM_DTYP );
      107     6530    2             S_D.DESC$ = DESC$;
      108     6531    2             CALL DDK$GETADDR(ITEM, SVALUE, SIZE, INDXX, POINTER,
      109     6532    2               EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG ) ALTRET(LERR);
      110     6533    2             IF ADDR_TYPE = %SPEC_ACODE
      111     6534    3             THEN DO;
      112     6535    4                  DO CASE (ITEM.SP.VS.ID);
      113     6536    4                    CASE (%IOBUFSZ_RTN, %WSR_RTN, %WSQ_RTN);
      114     6537    4                       IF NOT D_XDELTA
      115     6538    5                       THEN DO;
      116     6539    5                            S_D.ERROR = 111; /* E@XDONLYSYM */
      117     6540    5                            ALTRETURN;
      118     6541    5                          END;
      119     6542    4                    CASE (ELSE);
      120     6543    4                       ;
      121     6544    4                    END;
      122     6545    3                END;
      123     6546    2             IF POINTR.SEG = 1
      124     6547    3             THEN DO;
      125     6548    4                  DO CASE (PSDITEM.TYPE);
      126     6549    4                    CASE (0);
      127     6550    5                       DO CASE (PSDITEM.ID);
      128     6551    5                         CASE (3);         /* $TCB */
      129     6552    5                            IF D_XDELTA
      130     6553    6                            THEN DO;
      131     6554    6                                 S_D.ERROR = 113; /* E@UDONLYSYM */
      132     6555    6                                 ALTRETURN;
      133     6556    6                               END;
      134     6557    5                         CASE (5, 6, 7, 9); /* $RVB, $USD, $ERR, $CGn */
      135     6558    5                            IF NOT S_D.ANLZ_FILE
      136     6559    6                            THEN DO;
      137     6560    6                                 S_D.ERROR = 182; /* E@NOTANLZ_FILE */
      138     6561    6                                 ALTRETURN;
      139     6562    6                               END;
      140     6563    5                         CASE (8);         /* $HEAD */
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:5    
      141     6564    5                            IF NOT S_D.RUM
      142     6565    6                            THEN DO;
      143     6566    6                                 S_D.ERROR = 202; /* E@RUMONLY */
      144     6567    6                                 ALTRETURN;
      145     6568    6                               END;
      146     6569    5                         END;              /* DO CASE (PSDITEM.ID)  */
      147     6570    4                    CASE (ELSE);
      148     6571    4                       ;
      149     6572    4                    END;                   /* DO CASE (PSDITEM.TYPE) */
      150     6573
      151     6574    3                END;
      152     6575    3             DO CASE(LET$CMD.TYPE);
      153     6576    3               CASE( %CHAR_FMT );
      154     6577    3                  IF MOD(SIZE, 9) ~= 0
      155     6578    4                  THEN DO;
      156     6579    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */
      157     6580    4                       ALTRETURN;
      158     6581    4                     END;
      159     6582    3                  VALUE$ = ADDR(LET$CMD.TEXTC.TEXT);
      160     6583    3                  RSIZE = LET$CMD.TEXTC.SIZE * 9;
      161     6584    3                  EIS = BITBIN('400000000001'O);           /* MLR_EIS */
      162     6585    3               CASE( %BIT_FMT, %OBIT_FMT );
      163     6586    3   BITS:          ;
      164     6587    3                  VALUE$ = ADDR(LET$CMD.BITS.TRING);
      165     6588    3                  RSIZE = 72;
      166     6589    3                  EIS = BITBIN('400000000002'O);           /* CSL_EIS */
      167     6590    3               CASE( %LOGFORT_FMT );
      168     6591    3                  IF DTYP ~= %LOGFORT_FMT
      169     6592    4                  THEN DO;
      170     6593    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */
      171     6594    4                       ALTRETURN;
      172     6595    4                     END;
      173     6596    3                  GOTO BITS;
      174     6597    3               CASE( %FLOAT_FMT );
      175     6598    3                  IF DTYP ~= %FLOAT_FMT
      176     6599    3                    AND (SIZE ~= 36 AND DTYP ~= %OCT_FMT)
      177     6600    3                    AND DTYP ~= %SINT_FMT
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:6    
      178     6601    4                  THEN DO;
      179     6602    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */
      180     6603    4                       ALTRETURN;
      181     6604    4                     END;
      182     6605    3                  DVALUE = LET$CMD.COMP.LEX1;
      183     6606    3                  IF DTYP = %SINT_FMT
      184     6607    4                  THEN DO;
      185     6608    4                       CALL XPS_IFIX(VALUE, DVALUE);
      186     6609    4                       VALUE$ = ADDR(VALUE);
      187     6610    4                     END;
      188     6611    4                  ELSE DO;
      189     6612    4                       VALUE$ = ADDR(DVALUE);
      190     6613    4                       IF SIZE = 36
      191     6614    4                       THEN CALL DDK$FROUND(DVALUE);
      192     6615    4                     END;
      193     6616    3                  RSIZE = SIZE;
      194     6617    3                  EIS = BITBIN('400000000003'O);           /* CSR_EIS */
      195     6618    3               CASE( %CMPXFORT_FMT );
      196     6619    3                  IF DTYP ~= %CMPXFORT_FMT
      197     6620    4                  THEN DO;
      198     6621    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */
      199     6622    4                       ALTRETURN;
      200     6623    4                     END;
      201     6624    3                  IF SIZE ~= 144
      202     6625    4                  THEN DO;
      203     6626    4                       DVALUE = LET$CMD.COMP.LEX1;
      204     6627    4                       CALL DDK$FROUND(DVALUE);
      205     6628    4                       SVALS(0) = DVALS(0);
      206     6629    4                       DVALUE = LET$CMD.COMP.LEX2;
      207     6630    4                       CALL DDK$FROUND(DVALUE);
      208     6631    4                       SVALS(1) = DVALS(0);
      209     6632    4                       VALUE$ = ADDR(SVALS);
      210     6633    4                     END;
      211     6634    3                  ELSE VALUE$ = ADDR(LET$CMD.COMP.LEX1);
      212     6635    3                  RSIZE = SIZE;
      213     6636    3                  EIS = BITBIN('400000000003'O);           /* CSR_EIS */
      214     6637    3               CASE( %PTR_FMT );
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:7    
      215     6638    3                  IF SIZE ~= 36
      216     6639    4                  THEN DO;
      217     6640    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */
      218     6641    4                       ALTRETURN;
      219     6642    4                     END;
      220     6643    3                  GOTO OTHERS;
      221     6644    3               CASE( %PUP_FMT );
      222     6645    3                  IF DTYP = %PUP_FMT
      223     6646    4                  THEN DO;
      224     6647    4                       IF ZITEM.PUP.BITS.SIGNOVER
      225     6648    5                       THEN DO;
      226     6649    5                            S_D.ERROR = 206; /* E@CANTLETOVERP */
      227     6650    5                            ALTRETURN;
      228     6651    5                          END;
      229     6652    4                       TSCALE = LET$CMD.TEXTC.EXP - ZITEM.PUP.SCALE;
      230     6653    4                       IF TSCALE < 0
      231     6654    5                       THEN DO;
      232     6655    5                            RSIZE = 63 + TSCALE;
      233     6656    5                            VALUE$ = ADDR(LET$CMD.TEXTC.TEXT);
      234     6657    5                          END;
      235     6658    5                       ELSE DO;
      236     6659    5                            RSIZE = 63;
      237     6660    6                            DO I = 0 TO TSCALE - 1;
      238     6661    6                                 XVALUE( 62 - I ) = '0';
      239     6662    6                               END;
      240     6663    6                            DO I = 0 TO 62 - TSCALE;
      241     6664    6                                 XVALUE( I ) = LET$CMD.TEXTC.TEXTA( I + TSCALE );
      242     6665    6                               END;
      243     6666    5                            XVALUE(0) = LET$CMD.TEXTC.TEXTA(0);
      244     6667    5                            VALUE$ = ADDR(XVALUE);
      245     6668    5                          END;
      246     6669    4                       IF ZITEM.PUP.BITS.PUB = 1 /* Packed */
      247     6670    4                       THEN IF ZITEM.PUP.BITS.SIGNTYP
      248     6671    4                            THEN EIS = EMVNP(ZITEM.PUP.BITS.SIGNPOS);
      249     6672    4                            ELSE EIS = MVNP(ZITEM.PUP.BITS.SIGNPOS);
      250     6673    5                       ELSE DO;
      251     6674    5                            EIS = MVNU(ZITEM.PUP.BITS.SIGNPOS); /* Unpacked */
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:8    
      252     6675    5                            SIZE = SIZE / 9;
      253     6676    5                          END;
      254     6677    4                     END;
      255     6678    4                  ELSE DO;       /* Convert to binary for COMP-6, COMP-1, COMP2 */
      256     6679    4                       REMEMBER VAL2BIG IN S_D.REM_ACCESS;
      257     6680    4                       S_D.ACCESS = '1'B;
      258     6681    4                       IF DTYP ~= %FLOAT_FMT
      259     6682    4                       THEN CALL XCHARBIN(VALUE, SUBSTR(LET$CMD.TEXTC.TEXT,0,63 +
              6682                                LET$CMD.TEXTC.EXP));
      260     6683    4                       S_D.ACCESS = '0'B;
      261     6684    4                       VALUE$ = ADDR(VALUE);
      262     6685    5                       DO CASE(DTYP);
      263     6686    5                         CASE( %COMP1_FMT );
      264     6687    5                            CALL DDK$MCOMP1(VALUE);
      265     6688    5                         CASE( %COMP2_FMT );
      266     6689    5                            CALL DDK$MCOMP2(VALUE);
      267     6690    5                         CASE( %FLOAT_FMT );
      268     6691    5                            DVALUE = LET$CMD.COMP.LEX1;
      269     6692    5                            CALL DDK$FROUND(DVALUE);
      270     6693    5                            VALUE$ = ADDR(DVALUE);
      271     6694    5                         CASE( %SINT_FMT );
      272     6695                                                /* Do nothing */
      273     6696    5                         END;              /* DO CASE(DTYP) */
      274     6697    4                       RSIZE = 36;
      275     6698    4                       EIS = BITBIN('400000000003'O);      /* CSR_EIS */
      276     6699    4                     END;                  /* COMP-6, COMP-1, COMP-2 */
      277     6700    3               CASE( ELSE );
      278     6701    3                  IF DTYP = %FLOAT_FMT
      279     6702    4                  THEN DO;
      280     6703    4                       CALL XPS_DFLOAT(LET$CMD.CONS.TANT, DVALUE);
      281     6704    4                       IF SIZE = 36
      282     6705    4                       THEN CALL DDK$FROUND(DVALUE);
      283     6706    4                       VALUE$ = ADDR(DVALUE);
      284     6707    4                       RSIZE = SIZE;
      285     6708    4                       EIS = BITBIN('400000000003'O);      /* CSR_EIS */
      286     6709    4                     END;
      287     6710    4                  ELSE DO;
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:9    
      288     6711    4                       IF DTYP ~= %UINT_FMT
      289     6712    4                         AND DTYP ~= %SINT_FMT
      290     6713    4                         AND SIZE ~= 36
      291     6714    5                       THEN DO;
      292     6715    5                            S_D.ERROR = 90; /* E@SIZE_TYPE */
      293     6716    5                            ALTRETURN;
      294     6717    5                          END;
      295     6718    4   OTHERS:
      296     6719    4                       RSIZE = 36;
      297     6720    4                       VALUE$ = ADDR(LET$CMD.CONS.TANT);
      298     6721    4                       EIS = BITBIN('400000000003'O);      /* CSR_EIS */
      299     6722    4                     END;
      300     6723    3               END;                        /* DO CASE(LET$CMD.TYPE) */
      301     6724    2             CALL DDK$PUTVAL(VALUE$, ITEM, SVALUE, SIZE, RSIZE, INDXX,
      302     6725    2               POINTER, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG, '0'B, EIS)
      303     6726    2               ALTRET(LERR);
      304     6727                                                /*
      305     6728                                                 SPEC_DTYP
      306     6729                                                 */
      307     6730    2          CASE( %SPEC_DTYP );              /* Modifiable special symbol */
      308     6731    2             VALUE = 0;
      309     6732    3             DO CASE(LET$CMD.TYPE);
      310     6733    3               CASE( %CHAR_FMT );
      311     6734    3                  CVALUE = ADDR(LET$CMD.TEXTC) -> TEXTC.TXT;
      312     6735    3               CASE( ELSE );
      313     6736    3                  VALUE = LET$CMD.CONS.TANT;
      314     6737    3               END;                        /* DO CASE(LET$CMD.TYPE) */
      315     6738    2             CALL DDK$PUTSPEC(PINCRW(DESC$, POFFW(ADDR(ZITEM.ADDR_TYPE), ADDR(ZITEM)))
              6738                      -> DITEM, VALUE);
      316     6739                                                /**/
      317     6740    2          CASE( ELSE );
      318     6741    2             S_D.ERROR = 521;  /* E@NO_LET_ARRAYS */
      319     6742    2             ALTRETURN;
      320     6743    2          END;                             /* DO CASE(DESC$ -> ZITEM.DTYP) */
      321     6744    1        IF S_D.ANLZ AND NOT S_D.ANLZ_FILE
      322     6745    2        THEN DO;
      323     6746    2             IF NOT S_D.ANLZ_MODIFIED
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:10   
      324     6747    3             THEN DO;
      325     6748    3                  S_D.ANLZ_MODIFIED = '1'B;
      326     6749    3                  CALL DUQ$OCMSG (60 /* ANLZMOD_MSG# */);
      327     6750    3                END;
      328     6751    2             S_D.OUTPUT = S_D.INPUT;
      329     6752    2             CALL DUQ$WRERRLOG (SIZEC(S_D.INPUT));
      330     6753    2           END;
      331     6754    1        RETURN;
      332     6755    1   VAL2BIG:;
      333     6756    1        S_D.ERROR = 207;             /* E@VAL2BIG */
      334     6757    1   LERR:
      335     6758    1        ALTRETURN;
      336     6759    1   END DDA$LET;

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:11   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_EIS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$LET.

   Procedure DDA$LET requires 636 words for executable code.
   Procedure DDA$LET requires 62 words of local(AUTO) storage.

    No errors detected in file DDA$LET.:E05TSI    .

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:12   

 Object Unit name= DDA$LET                                    File name= DDA$LET.:E05TOU
 UTS= JUL 29 '97 13:33:13.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     12     14  DDA$LET
    1   Proc  even  none   636   1174  DDA$LET
    2  RoData even  none    10     12  DDA$LET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  DDA$LET
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:13   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       9 DDK$GETADDR
         yes           Std       2 XPS_IFIX
         yes           Std       1 DDK$FROUND
         yes           Std       1 DDK$MCOMP1
         yes           Std       1 DUQ$WRERRLOG
         yes           Std       1 DUQ$OCMSG
         yes           Std       1 DDK$MCOMP2
         yes           Std       2 XPS_DFLOAT
 yes     yes           Std      13 DDK$PUTVAL
         yes           Std       2 DDK$PUTSPEC
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     USE$                                  D_XDELTA                         r    S_D$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:14   


        1        1        /*M*  DDA$LET - LET command do routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F*  NAME: DDA$LET
       10       10              PURPOSE:  The LET command allows the user to assign
       11       11                       constant values to variables and some special symbols.
       12       12                                                     */
       13       13        DDA$LET: PROC ALTRET;

     13  1 000000   000000 700200 xent  DDA$LET      TSX0  ! X66_AUTO_0
         1 000001   000076 000000                    ZERO    62,0

       14       14                                                /* Locals */
       15       15    1   DCL DESC$ PTR;
       16       16    1   DCL VITEM$ PTR;
       17       17    1   DCL DTYP UBIN;
       18       18    1   DCL VALUE$ PTR;
       19       19    1   DCL SVALUE SBIN;
       20       20    1   DCL SIZE SBIN;
       21       21    1   DCL RSIZE UBIN;
       22       22    1   DCL INDXX SBIN;
       23       23    1   DCL POINTER UBIN;
       24       24    1   DCL 1 POINTR REDEF POINTER,
       25       25    1         2 ADR,
       26       26    1           3 W UBIN(18) UNAL,
       27       27    1           3 C UBIN(2) UNAL,
       28       28    1           3 B UBIN(4) UNAL,
       29       29    1         2 SEG UBIN(2) UNAL,
       30       30    1         2 DESC# UBIN(10) UNAL;
       31       31    1   DCL 1 PSDITEM REDEF POINTER,
       32       32    1         2 TYPE UBIN(6) UNAL,
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:15   
       33       33    1         2 ID UBIN(9) UNAL,
       34       34    1         2 DISP UBIN(9) UNAL,
       35       35    1         2 SEGID UBIN(12) UNAL;
       36       36    1   DCL EXPR_VAL SBIN;
       37       37    1   DCL EXPR_OP UBIN;
       38       38    1   DCL ADDR_TYPE UBIN;
       39       39    1   DCL ARRAY_FLAG BIT(1);
       40       40    1   DCL EIS UBIN;
       41       41    1   DCL TSCALE SBIN;
       42       42    1   DCL XVALUE(0:62) CHAR(1);
       43       43    1   DCL I UBIN;
       44       44    1   DCL VALUE SBIN;
       45       45    1   DCL CVALUE REDEF VALUE CHAR(4);
       46       46    1   DCL DVALUE BIT(72) DALIGNED;
       47       47    1   DCL DVALS(0:1) REDEF DVALUE UBIN;
       48       48    1   DCL SVALS(0:1) UBIN;
       49       49    1   DCL DO$ PTR;
       50       50                                                /* Misc */
       51       51    1   DCL USE$ PTR SYMREF;
       52       52        %INCLUDE OC_SUBS_C;
       53      783        %INCLUDE DD$BASED;
       54     2086        %U$SE;
       55     2094        %LET$CMD(STCLASS="BASED(DO$)");
       56     2144    1   DCL D_XDELTA BIT(1) SYMREF;
       57     2145        %INCLUDE DD_ERR_C;
       58     2542        %INCLUDE DD_EIS_C;
       59     2568        %INCLUDE DD_SUBS_C;
       60     2839        %INCLUDE DD$DITEM;
       12+    2942             %LIST;
       13+    2943    1        DCL SDD$ PTR;
       14+    2944    1        DCL ZITEM$ PTR;
       15+    2945    1        DCL SDD_L6$ PTR;
       16+    2946    1        DCL ZITEM_L6$ PTR;
       61     3520        %ZITEM;
       62     3592        %DITEM;
       63     3672        %DITEM (NAME=ITEM, STCLASS=AUTO);
       64     3752    1   DCL EMVNP(0:2) UBIN CONSTANT INIT(BITBIN('400000000007'O), BITBIN('400000000012'O),
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:16   
              3752            BITBIN('400000000013'O));
       65     3753    1   DCL MVNP(0:2) UBIN CONSTANT INIT(BITBIN('400000000007'O), BITBIN('400000000010'O),
              3753            BITBIN('400000000011'O));
       66     3754    1   DCL MVNU(0:2) UBIN CONSTANT INIT(BITBIN('400000000014'O), BITBIN('400000000015'O),
              3754            BITBIN('400000000016'O));
       67     3755             %INCLUDE XUH_MACRO_C;
       68     3839             %INCLUDE DD_SD_M;
       69     5175             %S_D;
       70     6493    1   DCL UBIN36 UBIN BASED;
       71     6494    1   DCL 1 TEXTC BASED,
       72     6495    1         2 SZ UBIN(9) UNAL,
       73     6496    1         2 TXT CHAR(TEXTC.SZ);
       74     6497                                                /* External routines */
       75     6498    1   DCL DDK$GETADDR ENTRY(9) ALTRET;
       76     6499    1   DCL DDK$PUTVAL ENTRY(13) ALTRET;
       77     6500    1   DCL DDK$PUTSPEC ENTRY(2);
       78     6501    1   DCL DDK$FROUND ENTRY(1);
       79     6502    1   DCL DUQ$OCMSG ENTRY(1);
       80     6503    1   DCL DUQ$WRERRLOG ENTRY(1);
       81     6504    1   DCL DDK$MCOMP1 ENTRY(1);
       82     6505    1   DCL DDK$MCOMP2 ENTRY(1);
       83     6506    1   DCL XPS_IFIX ENTRY(2);
       84     6507    1   DCL XPS_DFLOAT ENTRY(2);
       85     6508                                                /**/
       86     6509    1        IF S_D.RUM

   6509  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   004755 234100                    SZN     2541,,PR0
         1 000004   000010 605000 1                  TPL     s:6514

       87     6510    2        THEN DO;

       88     6511    2             S_D.ERROR = 212;     /* E@BADCMD_RUM */

   6511  1 000005   000324 235007                    LDA     212,DL
         1 000006   000013 755100                    STA     11,,PR0

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:17   
       89     6512    2             ALTRETURN;

   6512  1 000007   000000 702200 xent               TSX2  ! X66_AALT

       90     6513    2           END;
       91     6514    1        DO$ = S_D.DO$;

   6514  1 000010   000031 236100                    LDQ     25,,PR0
         1 000011   200050 756100                    STQ     DO$,,AUTO

       92     6515    1        DESC$ = S_D.D$;

   6515  1 000012   000044 236100                    LDQ     36,,PR0
         1 000013   200003 756100                    STQ     DESC$,,AUTO

       93     6516    1        ZITEM$ = S_D.D$;

   6516  1 000014   200052 756100                    STQ     ZITEM$,,AUTO

       94     6517    1        IF D_XDELTA

   6517  1 000015   000000 234000 xsym               SZN     D_XDELTA
         1 000016   000031 605000 1                  TPL     s:6524
         1 000017   200052 471500                    LDP1    ZITEM$,,AUTO
         1 000020   100001 236100                    LDQ     1,,PR1
         1 000021   100000 316003                    CANQ    32768,DU
         1 000022   000031 600000 1                  TZE     s:6524
         1 000023   000000 473400 xsym               LDP3    USE$
         1 000024   300000 234100                    SZN     0,,PR3
         1 000025   000031 604000 1                  TMI     s:6524

       95     6518    1          AND ZITEM.FLAGS.MDSE.S
       96     6519    1          AND NOT U$SE.CUR
       97     6520    2        THEN DO;

       98     6521    2             S_D.ERROR = 38;   /* E@USE_CONFLICT */

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:18   
   6521  1 000026   000046 235007                    LDA     38,DL
         1 000027   000013 755100                    STA     11,,PR0

       99     6522    2             ALTRETURN;

   6522  1 000030   000000 702200 xent               TSX2  ! X66_AALT

      100     6523    2           END;
      101     6524    1        DTYP = ZITEM.FMT_SPEC;

   6524  1 000031   200052 471500                    LDP1    ZITEM$,,AUTO
         1 000032   100006 236100                    LDQ     6,,PR1
         1 000033   000011 772000                    QRL     9
         1 000034   000777 376007                    ANQ     511,DL
         1 000035   200005 756100                    STQ     DTYP,,AUTO

      102     6525    2        DO CASE(ZITEM.DTYP);

   6525  1 000036   100001 220100                    LDX0    1,,PR1
         1 000037   000777 360003                    ANX0    511,DU
         1 000040   000004 100003                    CMPX0   4,DU
         1 000041   000043 602010 1                  TNC     s:6525+5,X0
         1 000042   001137 710000 1                  TRA     s:6741
         1 000043   000047 710000 1                  TRA     s:6530
         1 000044   001137 710000 1                  TRA     s:6741
         1 000045   001137 710000 1                  TRA     s:6741
         1 000046   001073 710000 1                  TRA     s:6731

      103     6526                                                /*
      104     6527                                                 SIM_DTYP
      105     6528                                                 */
      106     6529    2          CASE( %SIM_DTYP );

      107     6530    2             S_D.DESC$ = DESC$;

   6530  1 000047   200003 236100                    LDQ     DESC$,,AUTO
         1 000050   000041 756100                    STQ     33,,PR0
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:19   

      108     6531    2             CALL DDK$GETADDR(ITEM, SVALUE, SIZE, INDXX, POINTER,

   6531  1 000051   200017 633500                    EPPR3   ARRAY_FLAG,,AUTO
         1 000052   200070 453500                    STP3    ITEM+11,,AUTO
         1 000053   200016 634500                    EPPR4   ADDR_TYPE,,AUTO
         1 000054   200067 454500                    STP4    ITEM+10,,AUTO
         1 000055   200015 635500                    EPPR5   EXPR_OP,,AUTO
         1 000056   200066 455500                    STP5    ITEM+9,,AUTO
         1 000057   200014 636500                    EPPR6   EXPR_VAL,,AUTO
         1 000060   200065 456500                    STP6    ITEM+8,,AUTO
         1 000061   200013 637500                    EPPR7   POINTER,,AUTO
         1 000062   200064 457500                    STP7    ITEM+7,,AUTO
         1 000063   200012 630500                    EPPR0   INDXX,,AUTO
         1 000064   200063 450500                    STP0    ITEM+6,,AUTO
         1 000065   200010 630500                    EPPR0   SIZE,,AUTO
         1 000066   200062 450500                    STP0    ITEM+5,,AUTO
         1 000067   200007 630500                    EPPR0   SVALUE,,AUTO
         1 000070   200061 450500                    STP0    ITEM+4,,AUTO
         1 000071   200055 630500                    EPPR0   ITEM,,AUTO
         1 000072   200060 450500                    STP0    ITEM+3,,AUTO
         1 000073   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 000074   000000 631400 2                  EPPR1   0
         1 000075   000000 701000 xent               TSX1    DDK$GETADDR
         1 000076   001173 702000 1                  TSX2    LERR

      109     6532    2               EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG ) ALTRET(LERR);
      110     6533    2             IF ADDR_TYPE = %SPEC_ACODE

   6533  1 000077   200016 235100                    LDA     ADDR_TYPE,,AUTO
         1 000100   000101 115007                    CMPA    65,DL
         1 000101   000146 601000 1                  TNZ     s:6546

      111     6534    3             THEN DO;

      112     6535    4                  DO CASE (ITEM.SP.VS.ID);

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:20   
   6535  1 000102   200056 236100                    LDQ     ITEM+1,,AUTO
         1 000103   000033 772000                    QRL     27
         1 000104   000004 136007                    SBLQ    4,DL
         1 000105   000030 116007                    CMPQ    24,DL
         1 000106   000110 602006 1                  TNC     s:6535+6,QL
         1 000107   000146 710000 1                  TRA     s:6546
         1 000110   000140 710000 1                  TRA     s:6537
         1 000111   000146 710000 1                  TRA     s:6546
         1 000112   000146 710000 1                  TRA     s:6546
         1 000113   000146 710000 1                  TRA     s:6546
         1 000114   000146 710000 1                  TRA     s:6546
         1 000115   000146 710000 1                  TRA     s:6546
         1 000116   000146 710000 1                  TRA     s:6546
         1 000117   000146 710000 1                  TRA     s:6546
         1 000120   000146 710000 1                  TRA     s:6546
         1 000121   000146 710000 1                  TRA     s:6546
         1 000122   000146 710000 1                  TRA     s:6546
         1 000123   000146 710000 1                  TRA     s:6546
         1 000124   000146 710000 1                  TRA     s:6546
         1 000125   000146 710000 1                  TRA     s:6546
         1 000126   000146 710000 1                  TRA     s:6546
         1 000127   000146 710000 1                  TRA     s:6546
         1 000130   000146 710000 1                  TRA     s:6546
         1 000131   000146 710000 1                  TRA     s:6546
         1 000132   000146 710000 1                  TRA     s:6546
         1 000133   000146 710000 1                  TRA     s:6546
         1 000134   000146 710000 1                  TRA     s:6546
         1 000135   000146 710000 1                  TRA     s:6546
         1 000136   000140 710000 1                  TRA     s:6537
         1 000137   000140 710000 1                  TRA     s:6537

      113     6536    4                    CASE (%IOBUFSZ_RTN, %WSR_RTN, %WSQ_RTN);

      114     6537    4                       IF NOT D_XDELTA

   6537  1 000140   000000 234000 xsym               SZN     D_XDELTA
         1 000141   000146 604000 1                  TMI     s:6546
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:21   

      115     6538    5                       THEN DO;

      116     6539    5                            S_D.ERROR = 111; /* E@XDONLYSYM */

   6539  1 000142   000157 235007                    LDA     111,DL
         1 000143   000000 470400 xsym               LDP0    S_D$
         1 000144   000013 755100                    STA     11,,PR0

      117     6540    5                            ALTRETURN;

   6540  1 000145   000000 702200 xent               TSX2  ! X66_AALT

      118     6541    5                          END;
      119     6542    4                    CASE (ELSE);

      120     6543    4                       ;
      121     6544    4                    END;

      122     6545    3                END;

      123     6546    2             IF POINTR.SEG = 1

   6546  1 000146   200013 236100                    LDQ     POINTER,,AUTO
         1 000147   006000 376007                    ANQ     3072,DL
         1 000150   002000 116007                    CMPQ    1024,DL
         1 000151   000223 601000 1                  TNZ     s:6575

      124     6547    3             THEN DO;

      125     6548    4                  DO CASE (PSDITEM.TYPE);

   6548  1 000152   200013 236100                    LDQ     POINTER,,AUTO
         1 000153   000036 772000                    QRL     30
         1 000154   000001 116007                    CMPQ    1,DL
         1 000155   000157 602006 1                  TNC     s:6548+5,QL
         1 000156   000223 710000 1                  TRA     s:6575
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:22   
         1 000157   000160 710000 1                  TRA     s:6550

      126     6549    4                    CASE (0);

      127     6550    5                       DO CASE (PSDITEM.ID);

   6550  1 000160   200013 236100                    LDQ     POINTER,,AUTO
         1 000161   000025 772000                    QRL     21
         1 000162   000777 376007                    ANQ     511,DL
         1 000163   000012 116007                    CMPQ    10,DL
         1 000164   000166 602006 1                  TNC     s:6550+6,QL
         1 000165   000223 710000 1                  TRA     s:6575
         1 000166   000222 710000 1                  TRA     s:6569
         1 000167   000222 710000 1                  TRA     s:6569
         1 000170   000222 710000 1                  TRA     s:6569
         1 000171   000200 710000 1                  TRA     s:6552
         1 000172   000222 710000 1                  TRA     s:6569
         1 000173   000206 710000 1                  TRA     s:6558
         1 000174   000206 710000 1                  TRA     s:6558
         1 000175   000206 710000 1                  TRA     s:6558
         1 000176   000214 710000 1                  TRA     s:6564
         1 000177   000206 710000 1                  TRA     s:6558

      128     6551    5                         CASE (3);         /* $TCB */

      129     6552    5                            IF D_XDELTA

   6552  1 000200   000000 234000 xsym               SZN     D_XDELTA
         1 000201   000223 605000 1                  TPL     s:6575

      130     6553    6                            THEN DO;

      131     6554    6                                 S_D.ERROR = 113; /* E@UDONLYSYM */

   6554  1 000202   000161 235007                    LDA     113,DL
         1 000203   000000 470400 xsym               LDP0    S_D$
         1 000204   000013 755100                    STA     11,,PR0
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:23   

      132     6555    6                                 ALTRETURN;

   6555  1 000205   000000 702200 xent               TSX2  ! X66_AALT

      133     6556    6                               END;
      134     6557    5                         CASE (5, 6, 7, 9); /* $RVB, $USD, $ERR, $CGn */

      135     6558    5                            IF NOT S_D.ANLZ_FILE

   6558  1 000206   000000 470400 xsym               LDP0    S_D$
         1 000207   005052 234100                    SZN     2602,,PR0
         1 000210   000223 604000 1                  TMI     s:6575

      136     6559    6                            THEN DO;

      137     6560    6                                 S_D.ERROR = 182; /* E@NOTANLZ_FILE */

   6560  1 000211   000266 235007                    LDA     182,DL
         1 000212   000013 755100                    STA     11,,PR0

      138     6561    6                                 ALTRETURN;

   6561  1 000213   000000 702200 xent               TSX2  ! X66_AALT

      139     6562    6                               END;
      140     6563    5                         CASE (8);         /* $HEAD */

      141     6564    5                            IF NOT S_D.RUM

   6564  1 000214   000000 470400 xsym               LDP0    S_D$
         1 000215   004755 234100                    SZN     2541,,PR0
         1 000216   000223 604000 1                  TMI     s:6575

      142     6565    6                            THEN DO;

      143     6566    6                                 S_D.ERROR = 202; /* E@RUMONLY */
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:24   

   6566  1 000217   000312 235007                    LDA     202,DL
         1 000220   000013 755100                    STA     11,,PR0

      144     6567    6                                 ALTRETURN;

   6567  1 000221   000000 702200 xent               TSX2  ! X66_AALT

      145     6568    6                               END;
      146     6569    5                         END;              /* DO CASE (PSDITEM.ID)  */

   6569  1 000222   000223 710000 1                  TRA     s:6575

      147     6570    4                    CASE (ELSE);

      148     6571    4                       ;
      149     6572    4                    END;                   /* DO CASE (PSDITEM.TYPE) */

      150     6573
      151     6574    3                END;
      152     6575    3             DO CASE(LET$CMD.TYPE);

   6575  1 000223   200050 470500                    LDP0    DO$,,AUTO
         1 000224   000001 236100                    LDQ     1,,PR0
         1 000225   000011 772000                    QRL     9
         1 000226   000777 376007                    ANQ     511,DL
         1 000227   000004 136007                    SBLQ    4,DL
         1 000230   000032 116007                    CMPQ    26,DL
         1 000231   000233 602006 1                  TNC     s:6575+8,QL
         1 000232   000756 710000 1                  TRA     s:6701
         1 000233   000265 710000 1                  TRA     s:6577
         1 000234   000310 710000 1                  TRA     BITS
         1 000235   000756 710000 1                  TRA     s:6701
         1 000236   000464 710000 1                  TRA     s:6638
         1 000237   000756 710000 1                  TRA     s:6701
         1 000240   000756 710000 1                  TRA     s:6701
         1 000241   000756 710000 1                  TRA     s:6701
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:25   
         1 000242   000756 710000 1                  TRA     s:6701
         1 000243   000756 710000 1                  TRA     s:6701
         1 000244   000756 710000 1                  TRA     s:6701
         1 000245   000310 710000 1                  TRA     BITS
         1 000246   000756 710000 1                  TRA     s:6701
         1 000247   000330 710000 1                  TRA     s:6598
         1 000250   000756 710000 1                  TRA     s:6701
         1 000251   000756 710000 1                  TRA     s:6701
         1 000252   000756 710000 1                  TRA     s:6701
         1 000253   000756 710000 1                  TRA     s:6701
         1 000254   000756 710000 1                  TRA     s:6701
         1 000255   000756 710000 1                  TRA     s:6701
         1 000256   000756 710000 1                  TRA     s:6701
         1 000257   000756 710000 1                  TRA     s:6701
         1 000260   000320 710000 1                  TRA     s:6591
         1 000261   000410 710000 1                  TRA     s:6619
         1 000262   000756 710000 1                  TRA     s:6701
         1 000263   000756 710000 1                  TRA     s:6701
         1 000264   000474 710000 1                  TRA     s:6645

      153     6576    3               CASE( %CHAR_FMT );

      154     6577    3                  IF MOD(SIZE, 9) ~= 0

   6577  1 000265   200010 236100                    LDQ     SIZE,,AUTO
         1 000266   000011 506007                    DIV     9,DL
         1 000267   000044 733000                    LRS     36
         1 000270   000000 116003                    CMPQ    0,DU
         1 000271   000276 600000 1                  TZE     s:6582

      155     6578    4                  THEN DO;

      156     6579    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */

   6579  1 000272   000132 235007                    LDA     90,DL
         1 000273   000000 471400 xsym               LDP1    S_D$
         1 000274   100013 755100                    STA     11,,PR1
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:26   

      157     6580    4                       ALTRETURN;

   6580  1 000275   000000 702200 xent               TSX2  ! X66_AALT

      158     6581    4                     END;
      159     6582    3                  VALUE$ = ADDR(LET$CMD.TEXTC.TEXT);

   6582  1 000276   200050 236100                    LDQ     DO$,,AUTO
         1 000277   000001 036000 2                  ADLQ    1
         1 000300   200006 756100                    STQ     VALUE$,,AUTO

      160     6583    3                  RSIZE = LET$CMD.TEXTC.SIZE * 9;

   6583  1 000301   000002 236100                    LDQ     2,,PR0
         1 000302   000033 772000                    QRL     27
         1 000303   000011 402007                    MPY     9,DL
         1 000304   200011 756100                    STQ     RSIZE,,AUTO

      161     6584    3                  EIS = BITBIN('400000000001'O);           /* MLR_EIS */

   6584  1 000305   000011 235000 0                  LDA     MVNU+3
         1 000306   200020 755100                    STA     EIS,,AUTO
         1 000307   001034 710000 1                  TRA     s:6724

      162     6585    3               CASE( %BIT_FMT, %OBIT_FMT );

   6584  1 000310                       BITS         null
      163     6586    3   BITS:          ;
      164     6587    3                  VALUE$ = ADDR(LET$CMD.BITS.TRING);

   6587  1 000310   200050 236100                    LDQ     DO$,,AUTO
         1 000311   000003 036003                    ADLQ    3,DU
         1 000312   200006 756100                    STQ     VALUE$,,AUTO

      165     6588    3                  RSIZE = 72;

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:27   
   6588  1 000313   000110 235007                    LDA     72,DL
         1 000314   200011 755100                    STA     RSIZE,,AUTO

      166     6589    3                  EIS = BITBIN('400000000002'O);           /* CSL_EIS */

   6589  1 000315   000012 235000 0                  LDA     MVNU+4
         1 000316   200020 755100                    STA     EIS,,AUTO
         1 000317   001034 710000 1                  TRA     s:6724

      167     6590    3               CASE( %LOGFORT_FMT );

      168     6591    3                  IF DTYP ~= %LOGFORT_FMT

   6591  1 000320   200005 235100                    LDA     DTYP,,AUTO
         1 000321   000031 115007                    CMPA    25,DL
         1 000322   000327 600000 1                  TZE     s:6596

      169     6592    4                  THEN DO;

      170     6593    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */

   6593  1 000323   000132 235007                    LDA     90,DL
         1 000324   000000 471400 xsym               LDP1    S_D$
         1 000325   100013 755100                    STA     11,,PR1

      171     6594    4                       ALTRETURN;

   6594  1 000326   000000 702200 xent               TSX2  ! X66_AALT

      172     6595    4                     END;
      173     6596    3                  GOTO BITS;

   6596  1 000327   000310 710000 1                  TRA     BITS

      174     6597    3               CASE( %FLOAT_FMT );

      175     6598    3                  IF DTYP ~= %FLOAT_FMT
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:28   

   6598  1 000330   200005 235100                    LDA     DTYP,,AUTO
         1 000331   000020 115007                    CMPA    16,DL
         1 000332   000347 600000 1                  TZE     s:6605
         1 000333   200010 235100                    LDA     SIZE,,AUTO
         1 000334   000044 115007                    CMPA    36,DL
         1 000335   000347 600000 1                  TZE     s:6605
         1 000336   200005 235100                    LDA     DTYP,,AUTO
         1 000337   000001 115007                    CMPA    1,DL
         1 000340   000347 600000 1                  TZE     s:6605
         1 000341   000003 115007                    CMPA    3,DL
         1 000342   000347 600000 1                  TZE     s:6605

      176     6599    3                    AND (SIZE ~= 36 AND DTYP ~= %OCT_FMT)
      177     6600    3                    AND DTYP ~= %SINT_FMT
      178     6601    4                  THEN DO;

      179     6602    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */

   6602  1 000343   000132 235007                    LDA     90,DL
         1 000344   000000 471400 xsym               LDP1    S_D$
         1 000345   100013 755100                    STA     11,,PR1

      180     6603    4                       ALTRETURN;

   6603  1 000346   000000 702200 xent               TSX2  ! X66_AALT

      181     6604    4                     END;
      182     6605    3                  DVALUE = LET$CMD.COMP.LEX1;

   6605  1 000347   000100 100500                    MLR     fill='000'O
         1 000350   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         1 000351   200044 000010                    ADSC9   DVALUE,,AUTO             cn=0,n=8

      183     6606    3                  IF DTYP = %SINT_FMT

   6606  1 000352   200005 235100                    LDA     DTYP,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:29   
         1 000353   000003 115007                    CMPA    3,DL
         1 000354   000370 601000 1                  TNZ     s:6612

      184     6607    4                  THEN DO;

      185     6608    4                       CALL XPS_IFIX(VALUE, DVALUE);

   6608  1 000355   200044 631500                    EPPR1   DVALUE,,AUTO
         1 000356   200061 451500                    STP1    ITEM+4,,AUTO
         1 000357   200043 633500                    EPPR3   VALUE,,AUTO
         1 000360   200060 453500                    STP3    ITEM+3,,AUTO
         1 000361   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 000362   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000363   000000 701000 xent               TSX1    XPS_IFIX
         1 000364   000000 011000                    NOP     0

      186     6609    4                       VALUE$ = ADDR(VALUE);

   6609  1 000365   200043 630500                    EPPR0   VALUE,,AUTO
         1 000366   200006 450500                    STP0    VALUE$,,AUTO

      187     6610    4                     END;

   6610  1 000367   000403 710000 1                  TRA     s:6616

      188     6611    4                  ELSE DO;

      189     6612    4                       VALUE$ = ADDR(DVALUE);

   6612  1 000370   200044 631500                    EPPR1   DVALUE,,AUTO
         1 000371   200006 451500                    STP1    VALUE$,,AUTO

      190     6613    4                       IF SIZE = 36

   6613  1 000372   200010 236100                    LDQ     SIZE,,AUTO
         1 000373   000044 116007                    CMPQ    36,DL
         1 000374   000403 601000 1                  TNZ     s:6616
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:30   

      191     6614    4                       THEN CALL DDK$FROUND(DVALUE);

   6614  1 000375   200044 633500                    EPPR3   DVALUE,,AUTO
         1 000376   200060 453500                    STP3    ITEM+3,,AUTO
         1 000377   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 000400   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000401   000000 701000 xent               TSX1    DDK$FROUND
         1 000402   000000 011000                    NOP     0

      192     6615    4                     END;

      193     6616    3                  RSIZE = SIZE;

   6616  1 000403   200010 235100                    LDA     SIZE,,AUTO
         1 000404   200011 755100                    STA     RSIZE,,AUTO

      194     6617    3                  EIS = BITBIN('400000000003'O);           /* CSR_EIS */

   6617  1 000405   000013 236000 0                  LDQ     MVNU+5
         1 000406   200020 756100                    STQ     EIS,,AUTO
         1 000407   001034 710000 1                  TRA     s:6724

      195     6618    3               CASE( %CMPXFORT_FMT );

      196     6619    3                  IF DTYP ~= %CMPXFORT_FMT

   6619  1 000410   200005 235100                    LDA     DTYP,,AUTO
         1 000411   000032 115007                    CMPA    26,DL
         1 000412   000417 600000 1                  TZE     s:6624

      197     6620    4                  THEN DO;

      198     6621    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */

   6621  1 000413   000132 235007                    LDA     90,DL
         1 000414   000000 471400 xsym               LDP1    S_D$
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:31   
         1 000415   100013 755100                    STA     11,,PR1

      199     6622    4                       ALTRETURN;

   6622  1 000416   000000 702200 xent               TSX2  ! X66_AALT

      200     6623    4                     END;
      201     6624    3                  IF SIZE ~= 144

   6624  1 000417   200010 235100                    LDA     SIZE,,AUTO
         1 000420   000220 115007                    CMPA    144,DL
         1 000421   000454 600000 1                  TZE     s:6634

      202     6625    4                  THEN DO;

      203     6626    4                       DVALUE = LET$CMD.COMP.LEX1;

   6626  1 000422   000100 100500                    MLR     fill='000'O
         1 000423   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         1 000424   200044 000010                    ADSC9   DVALUE,,AUTO             cn=0,n=8

      204     6627    4                       CALL DDK$FROUND(DVALUE);

   6627  1 000425   200044 631500                    EPPR1   DVALUE,,AUTO
         1 000426   200060 451500                    STP1    ITEM+3,,AUTO
         1 000427   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 000430   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000431   000000 701000 xent               TSX1    DDK$FROUND
         1 000432   000000 011000                    NOP     0

      205     6628    4                       SVALS(0) = DVALS(0);

   6628  1 000433   200044 235100                    LDA     DVALUE,,AUTO
         1 000434   200046 755100                    STA     SVALS,,AUTO

      206     6629    4                       DVALUE = LET$CMD.COMP.LEX2;

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:32   
   6629  1 000435   200050 470500                    LDP0    DO$,,AUTO
         1 000436   000100 100500                    MLR     fill='000'O
         1 000437   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         1 000440   200044 000010                    ADSC9   DVALUE,,AUTO             cn=0,n=8

      207     6630    4                       CALL DDK$FROUND(DVALUE);

   6630  1 000441   200044 631500                    EPPR1   DVALUE,,AUTO
         1 000442   200060 451500                    STP1    ITEM+3,,AUTO
         1 000443   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 000444   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000445   000000 701000 xent               TSX1    DDK$FROUND
         1 000446   000000 011000                    NOP     0

      208     6631    4                       SVALS(1) = DVALS(0);

   6631  1 000447   200044 235100                    LDA     DVALUE,,AUTO
         1 000450   200047 755100                    STA     SVALS+1,,AUTO

      209     6632    4                       VALUE$ = ADDR(SVALS);

   6632  1 000451   200046 630500                    EPPR0   SVALS,,AUTO
         1 000452   200006 450500                    STP0    VALUE$,,AUTO

      210     6633    4                     END;

   6633  1 000453   000457 710000 1                  TRA     s:6635

      211     6634    3                  ELSE VALUE$ = ADDR(LET$CMD.COMP.LEX1);

   6634  1 000454   200050 236100                    LDQ     DO$,,AUTO
         1 000455   000003 036003                    ADLQ    3,DU
         1 000456   200006 756100                    STQ     VALUE$,,AUTO

      212     6635    3                  RSIZE = SIZE;

   6635  1 000457   200010 235100                    LDA     SIZE,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:33   
         1 000460   200011 755100                    STA     RSIZE,,AUTO

      213     6636    3                  EIS = BITBIN('400000000003'O);           /* CSR_EIS */

   6636  1 000461   000013 236000 0                  LDQ     MVNU+5
         1 000462   200020 756100                    STQ     EIS,,AUTO
         1 000463   001034 710000 1                  TRA     s:6724

      214     6637    3               CASE( %PTR_FMT );

      215     6638    3                  IF SIZE ~= 36

   6638  1 000464   200010 235100                    LDA     SIZE,,AUTO
         1 000465   000044 115007                    CMPA    36,DL
         1 000466   000473 600000 1                  TZE     s:6643

      216     6639    4                  THEN DO;

      217     6640    4                       S_D.ERROR = 90; /* E@SIZE_TYPE */

   6640  1 000467   000132 235007                    LDA     90,DL
         1 000470   000000 471400 xsym               LDP1    S_D$
         1 000471   100013 755100                    STA     11,,PR1

      218     6641    4                       ALTRETURN;

   6641  1 000472   000000 702200 xent               TSX2  ! X66_AALT

      219     6642    4                     END;
      220     6643    3                  GOTO OTHERS;

   6643  1 000473   001025 710000 1                  TRA     OTHERS

      221     6644    3               CASE( %PUP_FMT );

      222     6645    3                  IF DTYP = %PUP_FMT

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:34   
   6645  1 000474   200005 235100                    LDA     DTYP,,AUTO
         1 000475   000035 115007                    CMPA    29,DL
         1 000476   000631 601000 1                  TNZ     s:6679

      223     6646    4                  THEN DO;

      224     6647    4                       IF ZITEM.PUP.BITS.SIGNOVER

   6647  1 000477   200052 471500                    LDP1    ZITEM$,,AUTO
         1 000500   100010 236100                    LDQ     8,,PR1
         1 000501   000001 316007                    CANQ    1,DL
         1 000502   000507 600000 1                  TZE     s:6652

      225     6648    5                       THEN DO;

      226     6649    5                            S_D.ERROR = 206; /* E@CANTLETOVERP */

   6649  1 000503   000316 235007                    LDA     206,DL
         1 000504   000000 473400 xsym               LDP3    S_D$
         1 000505   300013 755100                    STA     11,,PR3

      227     6650    5                            ALTRETURN;

   6650  1 000506   000000 702200 xent               TSX2  ! X66_AALT

      228     6651    5                          END;
      229     6652    4                       TSCALE = LET$CMD.TEXTC.EXP - ZITEM.PUP.SCALE;

   6652  1 000507   100010 236100                    LDQ     8,,PR1
         1 000510   000026 736000                    QLS     22
         1 000511   000034 732000                    QRS     28
         1 000512   200060 756100                    STQ     ITEM+3,,AUTO
         1 000513   000002 236100                    LDQ     2,,PR0
         1 000514   000033 732000                    QRS     27
         1 000515   200060 136100                    SBLQ    ITEM+3,,AUTO
         1 000516   200021 756100                    STQ     TSCALE,,AUTO

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:35   
      230     6653    4                       IF TSCALE < 0

   6653  1 000517   000526 605000 1                  TPL     s:6659

      231     6654    5                       THEN DO;

      232     6655    5                            RSIZE = 63 + TSCALE;

   6655  1 000520   000077 036007                    ADLQ    63,DL
         1 000521   200011 756100                    STQ     RSIZE,,AUTO

      233     6656    5                            VALUE$ = ADDR(LET$CMD.TEXTC.TEXT);

   6656  1 000522   200050 236100                    LDQ     DO$,,AUTO
         1 000523   000001 036000 2                  ADLQ    1
         1 000524   200006 756100                    STQ     VALUE$,,AUTO

      234     6657    5                          END;

   6657  1 000525   000574 710000 1                  TRA     s:6669

      235     6658    5                       ELSE DO;

      236     6659    5                            RSIZE = 63;

   6659  1 000526   000077 235007                    LDA     63,DL
         1 000527   200011 755100                    STA     RSIZE,,AUTO

      237     6660    6                            DO I = 0 TO TSCALE - 1;

   6660  1 000530   200042 450100                    STZ     I,,AUTO
         1 000531   000542 710000 1                  TRA     s:6662+3

      238     6661    6                                 XVALUE( 62 - I ) = '0';

   6661  1 000532   000000 235003                    LDA     0,DU
         1 000533   200042 135100                    SBLA    I,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:36   
         1 000534   040105 100400                    MLR     fill='040'O
         1 000535   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000536   200041 400001                    ADSC9   XVALUE+15,A,AUTO         cn=2,n=1

      239     6662    6                               END;

   6662  1 000537   200042 236100                    LDQ     I,,AUTO
         1 000540   000001 036007                    ADLQ    1,DL
         1 000541   200042 756100                    STQ     I,,AUTO
         1 000542   200042 236100                    LDQ     I,,AUTO
         1 000543   000546 604000 1                  TMI     s:6663
         1 000544   200021 116100                    CMPQ    TSCALE,,AUTO
         1 000545   000532 604000 1                  TMI     s:6661

      240     6663    6                            DO I = 0 TO 62 - TSCALE;

   6663  1 000546   200042 450100                    STZ     I,,AUTO
         1 000547   000561 710000 1                  TRA     s:6665+2

      241     6664    6                                 XVALUE( I ) = LET$CMD.TEXTC.TEXTA( I + TSCALE );

   6664  1 000550   200042 236100                    LDQ     I,,AUTO
         1 000551   200021 036100                    ADLQ    TSCALE,,AUTO
         1 000552   200050 470500                    LDP0    DO$,,AUTO
         1 000553   200042 235100                    LDA     I,,AUTO
         1 000554   040105 100506                    MLR     fill='040'O
         1 000555   000002 200001                    ADSC9   2,Q,PR0                  cn=1,n=1
         1 000556   200022 000001                    ADSC9   XVALUE,A,AUTO            cn=0,n=1

      242     6665    6                               END;

   6665  1 000557   000001 035007                    ADLA    1,DL
         1 000560   200042 755100                    STA     I,,AUTO
         1 000561   000076 236007                    LDQ     62,DL
         1 000562   200021 136100                    SBLQ    TSCALE,,AUTO
         1 000563   000566 604000 1                  TMI     s:6666
         1 000564   200042 116100                    CMPQ    I,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:37   
         1 000565   000550 603000 1                  TRC     s:6664

      243     6666    5                            XVALUE(0) = LET$CMD.TEXTC.TEXTA(0);

   6666  1 000566   200050 470500                    LDP0    DO$,,AUTO
         1 000567   000002 236100                    LDQ     2,,PR0
         1 000570   000011 736000                    QLS     9
         1 000571   200022 552140                    STBQ    XVALUE,'40'O,AUTO

      244     6667    5                            VALUE$ = ADDR(XVALUE);

   6667  1 000572   200022 631500                    EPPR1   XVALUE,,AUTO
         1 000573   200006 451500                    STP1    VALUE$,,AUTO

      245     6668    5                          END;

      246     6669    4                       IF ZITEM.PUP.BITS.PUB = 1 /* Packed */

   6669  1 000574   200052 471500                    LDP1    ZITEM$,,AUTO
         1 000575   100010 236100                    LDQ     8,,PR1
         1 000576   000060 376007                    ANQ     48,DL
         1 000577   000020 116007                    CMPQ    16,DL
         1 000600   000620 601000 1                  TNZ     s:6674

      247     6670    4                       THEN IF ZITEM.PUP.BITS.SIGNTYP

   6670  1 000601   100010 236100                    LDQ     8,,PR1
         1 000602   000002 316007                    CANQ    2,DL
         1 000603   000612 600000 1                  TZE     s:6672

      248     6671    4                            THEN EIS = EMVNP(ZITEM.PUP.BITS.SIGNPOS);

   6671  1 000604   100010 236100                    LDQ     8,,PR1
         1 000605   000002 772000                    QRL     2
         1 000606   000003 376007                    ANQ     3,DL
         1 000607   000000 235006 0                  LDA     EMVNP,QL
         1 000610   200020 755100                    STA     EIS,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:38   
         1 000611   001034 710000 1                  TRA     s:6724

      249     6672    4                            ELSE EIS = MVNP(ZITEM.PUP.BITS.SIGNPOS);

   6672  1 000612   100010 236100                    LDQ     8,,PR1
         1 000613   000002 772000                    QRL     2
         1 000614   000003 376007                    ANQ     3,DL
         1 000615   000003 235006 0                  LDA     MVNP,QL
         1 000616   200020 755100                    STA     EIS,,AUTO
         1 000617   001034 710000 1                  TRA     s:6724

      250     6673    5                       ELSE DO;

      251     6674    5                            EIS = MVNU(ZITEM.PUP.BITS.SIGNPOS); /* Unpacked */

   6674  1 000620   100010 236100                    LDQ     8,,PR1
         1 000621   000002 772000                    QRL     2
         1 000622   000003 376007                    ANQ     3,DL
         1 000623   000006 235006 0                  LDA     MVNU,QL
         1 000624   200020 755100                    STA     EIS,,AUTO

      252     6675    5                            SIZE = SIZE / 9;

   6675  1 000625   200010 236100                    LDQ     SIZE,,AUTO
         1 000626   000011 506007                    DIV     9,DL
         1 000627   200010 756100                    STQ     SIZE,,AUTO

      253     6676    5                          END;

      254     6677    4                     END;

   6677  1 000630   001034 710000 1                  TRA     s:6724

      255     6678    4                  ELSE DO;       /* Convert to binary for COMP-6, COMP-1, COMP2 */

      256     6679    4                       REMEMBER VAL2BIG IN S_D.REM_ACCESS;

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:39   
   6679  1 000631   001170 635000 1                  EAA     VAL2BIG
         1 000632   000000 471400 xsym               LDP1    S_D$
         1 000633   100024 452500                    STP2    20,,PR1
         1 000634   100025 755100                    STA     21,,PR1

      257     6680    4                       S_D.ACCESS = '1'B;

   6680  1 000635   400000 236003                    LDQ     -131072,DU
         1 000636   100016 756100                    STQ     14,,PR1

      258     6681    4                       IF DTYP ~= %FLOAT_FMT

   6681  1 000637   200005 235100                    LDA     DTYP,,AUTO
         1 000640   000020 115007                    CMPA    16,DL
         1 000641   000650 600000 1                  TZE     s:6683

      259     6682    4                       THEN CALL XCHARBIN(VALUE, SUBSTR(LET$CMD.TEXTC.TEXT,0,63 +
              6682                                LET$CMD.TEXTC.EXP));

   6682  1 000642   000002 236100                    LDQ     2,,PR0
         1 000643   000033 732000                    QRS     27
         1 000644   000077 620006                    EAX0    63,QL
         1 000645   000100 305540                    DTB
         1 000646   000002 210010                    NDSC9   2,,PR0                   cn=1,s=lsgns,sf=0,n=*X0
         1 000647   200043 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      260     6683    4                       S_D.ACCESS = '0'B;

   6683  1 000650   100016 450100                    STZ     14,,PR1

      261     6684    4                       VALUE$ = ADDR(VALUE);

   6684  1 000651   200043 633500                    EPPR3   VALUE,,AUTO
         1 000652   200006 453500                    STP3    VALUE$,,AUTO

      262     6685    5                       DO CASE(DTYP);

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:40   
   6685  1 000653   000041 115007                    CMPA    33,DL
         1 000654   000656 602005 1                  TNC     s:6685+3,AL
         1 000655   000751 710000 1                  TRA     s:6697
         1 000656   000751 710000 1                  TRA     s:6697
         1 000657   000751 710000 1                  TRA     s:6697
         1 000660   000751 710000 1                  TRA     s:6697
         1 000661   000751 710000 1                  TRA     s:6697
         1 000662   000751 710000 1                  TRA     s:6697
         1 000663   000751 710000 1                  TRA     s:6697
         1 000664   000751 710000 1                  TRA     s:6697
         1 000665   000751 710000 1                  TRA     s:6697
         1 000666   000751 710000 1                  TRA     s:6697
         1 000667   000751 710000 1                  TRA     s:6697
         1 000670   000751 710000 1                  TRA     s:6697
         1 000671   000751 710000 1                  TRA     s:6697
         1 000672   000751 710000 1                  TRA     s:6697
         1 000673   000751 710000 1                  TRA     s:6697
         1 000674   000751 710000 1                  TRA     s:6697
         1 000675   000751 710000 1                  TRA     s:6697
         1 000676   000735 710000 1                  TRA     s:6691
         1 000677   000751 710000 1                  TRA     s:6697
         1 000700   000751 710000 1                  TRA     s:6697
         1 000701   000751 710000 1                  TRA     s:6697
         1 000702   000751 710000 1                  TRA     s:6697
         1 000703   000751 710000 1                  TRA     s:6697
         1 000704   000726 710000 1                  TRA     s:6689
         1 000705   000751 710000 1                  TRA     s:6697
         1 000706   000751 710000 1                  TRA     s:6697
         1 000707   000751 710000 1                  TRA     s:6697
         1 000710   000751 710000 1                  TRA     s:6697
         1 000711   000751 710000 1                  TRA     s:6697
         1 000712   000751 710000 1                  TRA     s:6697
         1 000713   000751 710000 1                  TRA     s:6697
         1 000714   000751 710000 1                  TRA     s:6697
         1 000715   000751 710000 1                  TRA     s:6697
         1 000716   000717 710000 1                  TRA     s:6687

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:41   
      263     6686    5                         CASE( %COMP1_FMT );

      264     6687    5                            CALL DDK$MCOMP1(VALUE);

   6687  1 000717   200043 634500                    EPPR4   VALUE,,AUTO
         1 000720   200060 454500                    STP4    ITEM+3,,AUTO
         1 000721   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 000722   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000723   000000 701000 xent               TSX1    DDK$MCOMP1
         1 000724   000000 011000                    NOP     0
         1 000725   000751 710000 1                  TRA     s:6697

      265     6688    5                         CASE( %COMP2_FMT );

      266     6689    5                            CALL DDK$MCOMP2(VALUE);

   6689  1 000726   200043 634500                    EPPR4   VALUE,,AUTO
         1 000727   200060 454500                    STP4    ITEM+3,,AUTO
         1 000730   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 000731   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000732   000000 701000 xent               TSX1    DDK$MCOMP2
         1 000733   000000 011000                    NOP     0
         1 000734   000751 710000 1                  TRA     s:6697

      267     6690    5                         CASE( %FLOAT_FMT );

      268     6691    5                            DVALUE = LET$CMD.COMP.LEX1;

   6691  1 000735   000100 100500                    MLR     fill='000'O
         1 000736   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         1 000737   200044 000010                    ADSC9   DVALUE,,AUTO             cn=0,n=8

      269     6692    5                            CALL DDK$FROUND(DVALUE);

   6692  1 000740   200044 634500                    EPPR4   DVALUE,,AUTO
         1 000741   200060 454500                    STP4    ITEM+3,,AUTO
         1 000742   200060 630500                    EPPR0   ITEM+3,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:42   
         1 000743   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000744   000000 701000 xent               TSX1    DDK$FROUND
         1 000745   000000 011000                    NOP     0

      270     6693    5                            VALUE$ = ADDR(DVALUE);

   6693  1 000746   200044 630500                    EPPR0   DVALUE,,AUTO
         1 000747   200006 450500                    STP0    VALUE$,,AUTO
         1 000750   000751 710000 1                  TRA     s:6697

      271     6694    5                         CASE( %SINT_FMT );

      272     6695                                                /* Do nothing */
      273     6696    5                         END;              /* DO CASE(DTYP) */

      274     6697    4                       RSIZE = 36;

   6697  1 000751   000044 235007                    LDA     36,DL
         1 000752   200011 755100                    STA     RSIZE,,AUTO

      275     6698    4                       EIS = BITBIN('400000000003'O);      /* CSR_EIS */

   6698  1 000753   000013 236000 0                  LDQ     MVNU+5
         1 000754   200020 756100                    STQ     EIS,,AUTO

      276     6699    4                     END;                  /* COMP-6, COMP-1, COMP-2 */

   6699  1 000755   001034 710000 1                  TRA     s:6724

      277     6700    3               CASE( ELSE );

      278     6701    3                  IF DTYP = %FLOAT_FMT

   6701  1 000756   200005 235100                    LDA     DTYP,,AUTO
         1 000757   000020 115007                    CMPA    16,DL
         1 000760   001012 601000 1                  TNZ     s:6711

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:43   
      279     6702    4                  THEN DO;

      280     6703    4                       CALL XPS_DFLOAT(LET$CMD.CONS.TANT, DVALUE);

   6703  1 000761   200044 631500                    EPPR1   DVALUE,,AUTO
         1 000762   200061 451500                    STP1    ITEM+4,,AUTO
         1 000763   200050 236100                    LDQ     DO$,,AUTO
         1 000764   000003 036003                    ADLQ    3,DU
         1 000765   200060 756100                    STQ     ITEM+3,,AUTO
         1 000766   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 000767   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000770   000000 701000 xent               TSX1    XPS_DFLOAT
         1 000771   000000 011000                    NOP     0

      281     6704    4                       IF SIZE = 36

   6704  1 000772   200010 235100                    LDA     SIZE,,AUTO
         1 000773   000044 115007                    CMPA    36,DL
         1 000774   001003 601000 1                  TNZ     s:6706

      282     6705    4                       THEN CALL DDK$FROUND(DVALUE);

   6705  1 000775   200044 630500                    EPPR0   DVALUE,,AUTO
         1 000776   200060 450500                    STP0    ITEM+3,,AUTO
         1 000777   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 001000   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001001   000000 701000 xent               TSX1    DDK$FROUND
         1 001002   000000 011000                    NOP     0

      283     6706    4                       VALUE$ = ADDR(DVALUE);

   6706  1 001003   200044 630500                    EPPR0   DVALUE,,AUTO
         1 001004   200006 450500                    STP0    VALUE$,,AUTO

      284     6707    4                       RSIZE = SIZE;

   6707  1 001005   200010 235100                    LDA     SIZE,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:44   
         1 001006   200011 755100                    STA     RSIZE,,AUTO

      285     6708    4                       EIS = BITBIN('400000000003'O);      /* CSR_EIS */

   6708  1 001007   000013 236000 0                  LDQ     MVNU+5
         1 001010   200020 756100                    STQ     EIS,,AUTO

      286     6709    4                     END;

   6709  1 001011   001034 710000 1                  TRA     s:6724

      287     6710    4                  ELSE DO;

      288     6711    4                       IF DTYP ~= %UINT_FMT

   6711  1 001012   000002 115007                    CMPA    2,DL
         1 001013   001025 600000 1                  TZE     OTHERS
         1 001014   000003 115007                    CMPA    3,DL
         1 001015   001025 600000 1                  TZE     OTHERS
         1 001016   200010 235100                    LDA     SIZE,,AUTO
         1 001017   000044 115007                    CMPA    36,DL
         1 001020   001025 600000 1                  TZE     OTHERS

      289     6712    4                         AND DTYP ~= %SINT_FMT
      290     6713    4                         AND SIZE ~= 36
      291     6714    5                       THEN DO;

      292     6715    5                            S_D.ERROR = 90; /* E@SIZE_TYPE */

   6715  1 001021   000132 235007                    LDA     90,DL
         1 001022   000000 471400 xsym               LDP1    S_D$
         1 001023   100013 755100                    STA     11,,PR1

      293     6716    5                            ALTRETURN;

   6716  1 001024   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:45   
      294     6717    5                          END;
      295     6718    4   OTHERS:
      296     6719    4                       RSIZE = 36;

   6719  1 001025   000044 235007       OTHERS       LDA     36,DL
         1 001026   200011 755100                    STA     RSIZE,,AUTO

      297     6720    4                       VALUE$ = ADDR(LET$CMD.CONS.TANT);

   6720  1 001027   200050 236100                    LDQ     DO$,,AUTO
         1 001030   000003 036003                    ADLQ    3,DU
         1 001031   200006 756100                    STQ     VALUE$,,AUTO

      298     6721    4                       EIS = BITBIN('400000000003'O);      /* CSR_EIS */

   6721  1 001032   000013 235000 0                  LDA     MVNU+5
         1 001033   200020 755100                    STA     EIS,,AUTO

      299     6722    4                     END;

      300     6723    3               END;                        /* DO CASE(LET$CMD.TYPE) */

      301     6724    2             CALL DDK$PUTVAL(VALUE$, ITEM, SVALUE, SIZE, RSIZE, INDXX,

   6724  1 001034   200020 630500                    EPPR0   EIS,,AUTO
         1 001035   200074 450500                    STP0    ITEM+15,,AUTO
         1 001036   000004 236000 2                  LDQ     4
         1 001037   200073 756100                    STQ     ITEM+14,,AUTO
         1 001040   200017 631500                    EPPR1   ARRAY_FLAG,,AUTO
         1 001041   200072 451500                    STP1    ITEM+13,,AUTO
         1 001042   200016 633500                    EPPR3   ADDR_TYPE,,AUTO
         1 001043   200071 453500                    STP3    ITEM+12,,AUTO
         1 001044   200015 634500                    EPPR4   EXPR_OP,,AUTO
         1 001045   200070 454500                    STP4    ITEM+11,,AUTO
         1 001046   200014 635500                    EPPR5   EXPR_VAL,,AUTO
         1 001047   200067 455500                    STP5    ITEM+10,,AUTO
         1 001050   200013 636500                    EPPR6   POINTER,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:46   
         1 001051   200066 456500                    STP6    ITEM+9,,AUTO
         1 001052   200012 637500                    EPPR7   INDXX,,AUTO
         1 001053   200065 457500                    STP7    ITEM+8,,AUTO
         1 001054   200011 630500                    EPPR0   RSIZE,,AUTO
         1 001055   200064 450500                    STP0    ITEM+7,,AUTO
         1 001056   200010 630500                    EPPR0   SIZE,,AUTO
         1 001057   200063 450500                    STP0    ITEM+6,,AUTO
         1 001060   200007 630500                    EPPR0   SVALUE,,AUTO
         1 001061   200062 450500                    STP0    ITEM+5,,AUTO
         1 001062   200055 630500                    EPPR0   ITEM,,AUTO
         1 001063   200061 450500                    STP0    ITEM+4,,AUTO
         1 001064   200006 630500                    EPPR0   VALUE$,,AUTO
         1 001065   200060 450500                    STP0    ITEM+3,,AUTO
         1 001066   200060 630500                    EPPR0   ITEM+3,,AUTO
         1 001067   000003 631400 2                  EPPR1   3
         1 001070   000000 701000 xent               TSX1    DDK$PUTVAL
         1 001071   001173 702000 1                  TSX2    LERR
         1 001072   001142 710000 1                  TRA     s:6744

      302     6725    2               POINTER, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG, '0'B, EIS)
      303     6726    2               ALTRET(LERR);
      304     6727                                                /*
      305     6728                                                 SPEC_DTYP
      306     6729                                                 */
      307     6730    2          CASE( %SPEC_DTYP );              /* Modifiable special symbol */

      308     6731    2             VALUE = 0;

   6731  1 001073   200043 450100                    STZ     VALUE,,AUTO

      309     6732    3             DO CASE(LET$CMD.TYPE);

   6732  1 001074   200050 473500                    LDP3    DO$,,AUTO
         1 001075   300001 236100                    LDQ     1,,PR3
         1 001076   000011 772000                    QRL     9
         1 001077   000777 376007                    ANQ     511,DL
         1 001100   000004 136007                    SBLQ    4,DL
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:47   
         1 001101   000001 116007                    CMPQ    1,DL
         1 001102   001104 602006 1                  TNC     s:6732+8,QL
         1 001103   001114 710000 1                  TRA     s:6736
         1 001104   001105 710000 1                  TRA     s:6734

      310     6733    3               CASE( %CHAR_FMT );

      311     6734    3                  CVALUE = ADDR(LET$CMD.TEXTC) -> TEXTC.TXT;

   6734  1 001105   300002 236100                    LDQ     2,,PR3
         1 001106   000033 772000                    QRL     27
         1 001107   000000 620006                    EAX0    0,QL
         1 001110   040100 100540                    MLR     fill='040'O
         1 001111   300002 200010                    ADSC9   2,,PR3                   cn=1,n=*X0
         1 001112   200043 000004                    ADSC9   VALUE,,AUTO              cn=0,n=4
         1 001113   001116 710000 1                  TRA     s:6738

      312     6735    3               CASE( ELSE );

      313     6736    3                  VALUE = LET$CMD.CONS.TANT;

   6736  1 001114   300003 235100                    LDA     3,,PR3
         1 001115   200043 755100                    STA     VALUE,,AUTO

      314     6737    3               END;                        /* DO CASE(LET$CMD.TYPE) */

      315     6738    2             CALL DDK$PUTSPEC(PINCRW(DESC$, POFFW(ADDR(ZITEM.ADDR_TYPE), ADDR(ZITEM)))
              6738                      -> DITEM, VALUE);

   6738  1 001116   200052 236100                    LDQ     ZITEM$,,AUTO
         1 001117   000022 772000                    QRL     18
         1 001120   200060 756100                    STQ     ITEM+3,,AUTO
         1 001121   200052 236100                    LDQ     ZITEM$,,AUTO
         1 001122   000005 036000 2                  ADLQ    5
         1 001123   000022 772000                    QRL     18
         1 001124   200060 136100                    SBLQ    ITEM+3,,AUTO
         1 001125   200043 634500                    EPPR4   VALUE,,AUTO
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:48   
         1 001126   200063 454500                    STP4    ITEM+6,,AUTO
         1 001127   000022 736000                    QLS     18
         1 001130   200003 036100                    ADLQ    DESC$,,AUTO
         1 001131   200062 756100                    STQ     ITEM+5,,AUTO
         1 001132   200062 630500                    EPPR0   ITEM+5,,AUTO
         1 001133   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001134   000000 701000 xent               TSX1    DDK$PUTSPEC
         1 001135   000000 011000                    NOP     0
         1 001136   001142 710000 1                  TRA     s:6744

      316     6739                                                /**/
      317     6740    2          CASE( ELSE );

      318     6741    2             S_D.ERROR = 521;  /* E@NO_LET_ARRAYS */

   6741  1 001137   001011 235007                    LDA     521,DL
         1 001140   000013 755100                    STA     11,,PR0

      319     6742    2             ALTRETURN;

   6742  1 001141   000000 702200 xent               TSX2  ! X66_AALT

      320     6743    2          END;                             /* DO CASE(DESC$ -> ZITEM.DTYP) */

      321     6744    1        IF S_D.ANLZ AND NOT S_D.ANLZ_FILE

   6744  1 001142   000000 470400 xsym               LDP0    S_D$
         1 001143   004756 234100                    SZN     2542,,PR0
         1 001144   001167 605000 1                  TPL     s:6754
         1 001145   005052 234100                    SZN     2602,,PR0
         1 001146   001167 604000 1                  TMI     s:6754

      322     6745    2        THEN DO;

      323     6746    2             IF NOT S_D.ANLZ_MODIFIED

   6746  1 001147   005311 234100                    SZN     2761,,PR0
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:49   
         1 001150   001157 604000 1                  TMI     s:6751

      324     6747    3             THEN DO;

      325     6748    3                  S_D.ANLZ_MODIFIED = '1'B;

   6748  1 001151   400000 236003                    LDQ     -131072,DU
         1 001152   005311 756100                    STQ     2761,,PR0

      326     6749    3                  CALL DUQ$OCMSG (60 /* ANLZMOD_MSG# */);

   6749  1 001153   000007 630400 2                  EPPR0   7
         1 001154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001155   000000 701000 xent               TSX1    DUQ$OCMSG
         1 001156   000000 011000                    NOP     0

      327     6750    3                END;

      328     6751    2             S_D.OUTPUT = S_D.INPUT;

   6751  1 001157   000000 470400 xsym               LDP0    S_D$
         1 001160   040100 100500                    MLR     fill='040'O
         1 001161   000610 000400                    ADSC9   392,,PR0                 cn=0,n=256
         1 001162   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      329     6752    2             CALL DUQ$WRERRLOG (SIZEC(S_D.INPUT));

   6752  1 001163   000011 630400 2                  EPPR0   9
         1 001164   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001165   000000 701000 xent               TSX1    DUQ$WRERRLOG
         1 001166   000000 011000                    NOP     0

      330     6753    2           END;

      331     6754    1        RETURN;

   6754  1 001167   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:50   

   6752  1 001170                       VAL2BIG      null
      332     6755    1   VAL2BIG:;
      333     6756    1        S_D.ERROR = 207;             /* E@VAL2BIG */

   6756  1 001170   000317 235007                    LDA     207,DL
         1 001171   000000 470400 xsym               LDP0    S_D$
         1 001172   000013 755100                    STA     11,,PR0

      334     6757    1   LERR:
      335     6758    1        ALTRETURN;

   6758  1 001173   000000 702200 xent  LERR         TSX2  ! X66_AALT

EMVNP
 Sect OctLoc
   0     000   400000 000007   400000 000012   400000 000013                    ............

MVNP
 Sect OctLoc
   0     003   400000 000007   400000 000010   400000 000011                    ............

MVNU
 Sect OctLoc
   0     006   400000 000014   400000 000015   400000 000016                    ............

(unnamed)
 Sect OctLoc
   0     011   400000 000001   400000 000002   400000 000003                    ............

(unnamed)
 Sect OctLoc
   2     000   000011 000000   000002 200000   060040 040040   000015 000000    ........0   ....
   2     004   000002 006000   000006 200000   000000 000074   000006 006000    ...........<....
   2     010   000000 000400   000010 006000                                    ........
      336     6759    1   END DDA$LET;

PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:51   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_EIS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$LET.

   Procedure DDA$LET requires 636 words for executable code.
   Procedure DDA$LET requires 62 words of local(AUTO) storage.

    No errors detected in file DDA$LET.:E05TSI    .
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:52   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:53   
          MINI XREF LISTING

ADDR_TYPE
        38**DCL      6531<>CALL     6533>>IF       6724<>CALL
ARRAY_FLAG
        39**DCL      6531<>CALL     6724<>CALL
BITS
      6584**LABEL    6596--GOTO
CVALUE
        45**DCL      6734<<ASSIGN
DDK$FROUND
      6501**DCL-ENT  6614--CALL     6627--CALL     6630--CALL     6692--CALL     6705--CALL
DDK$GETADDR
      6498**DCL-ENT  6531--CALL
DDK$MCOMP1
      6504**DCL-ENT  6687--CALL
DDK$MCOMP2
      6505**DCL-ENT  6689--CALL
DDK$PUTSPEC
      6500**DCL-ENT  6738--CALL
DDK$PUTVAL
      6499**DCL-ENT  6724--CALL
DESC$
        15**DCL      6515<<ASSIGN   6530>>ASSIGN   6738>>CALL
DITEM
      3593**DCL      6738<>CALL
DITEM.ADDRESS
      3614**DCL      3619--REDEF    3620--REDEF    3621--REDEF
DITEM.SP.VD
      3622**DCL      3626--REDEF    3629--REDEF
DO$
        49**DCL      2095--IMP-PTR  6514<<ASSIGN   6575>>DOCASE   6582>>ASSIGN   6583>>ASSIGN   6587>>ASSIGN
      6605>>ASSIGN   6626>>ASSIGN   6629>>ASSIGN   6634>>ASSIGN   6652>>ASSIGN   6656>>ASSIGN   6664>>ASSIGN
      6666>>ASSIGN   6682>>CALLBLT  6682>>CALLBLT  6691>>ASSIGN   6703>>CALL     6720>>ASSIGN   6732>>DOCASE
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:54   
      6734>>ASSIGN   6734>>ASSIGN   6736>>ASSIGN
DTYP
        17**DCL      6524<<ASSIGN   6591>>IF       6598>>IF       6598>>IF       6598>>IF       6606>>IF
      6619>>IF       6645>>IF       6681>>IF       6685>>DOCASE   6701>>IF       6711>>IF       6711>>IF
DUQ$OCMSG
      6502**DCL-ENT  6749--CALL
DUQ$WRERRLOG
      6503**DCL-ENT  6752--CALL
DVALS
        47**DCL      6628>>ASSIGN   6631>>ASSIGN
DVALUE
        46**DCL        47--REDEF    6605<<ASSIGN   6608<>CALL     6612--ASSIGN   6614<>CALL     6626<<ASSIGN
      6627<>CALL     6629<<ASSIGN   6630<>CALL     6691<<ASSIGN   6692<>CALL     6693--ASSIGN   6703<>CALL
      6705<>CALL     6706--ASSIGN
D_XDELTA
      2144**DCL      6517>>IF       6537>>IF       6552>>IF
EIS
        40**DCL      6584<<ASSIGN   6589<<ASSIGN   6617<<ASSIGN   6636<<ASSIGN   6671<<ASSIGN   6672<<ASSIGN
      6674<<ASSIGN   6698<<ASSIGN   6708<<ASSIGN   6721<<ASSIGN   6724<>CALL
EMVNP
      3752**DCL      6671>>ASSIGN
EXPR_OP
        37**DCL      6531<>CALL     6724<>CALL
EXPR_VAL
        36**DCL      6531<>CALL     6724<>CALL
I
        43**DCL      6660<<DOINDEX  6661>>ASSIGN   6663<<DOINDEX  6664>>ASSIGN   6664>>ASSIGN
INDXX
        22**DCL      6531<>CALL     6724<>CALL
ITEM
      3673**DCL      6531<>CALL     6724<>CALL
ITEM.ADDRESS
      3694**DCL      3699--REDEF    3700--REDEF    3701--REDEF
ITEM.SP.VD
      3702**DCL      3706--REDEF    3709--REDEF
ITEM.SP.VS.ID
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:55   
      3710**DCL      6535>>DOCASE
LERR
      6758**LABEL    6531--CALLALT  6724--CALLALT
LET$CMD.BITS.TRING
      2121**DCL      6587--ASSIGN
LET$CMD.COMP.LEX1
      2140**DCL      6605>>ASSIGN   6626>>ASSIGN   6634--ASSIGN   6691>>ASSIGN
LET$CMD.COMP.LEX2
      2141**DCL      6629>>ASSIGN
LET$CMD.CONS.TANT
      2115**DCL      2116--REDEF    6703<>CALL     6720--ASSIGN   6736>>ASSIGN
LET$CMD.P.ADR
      2126**DCL      2130--REDEF
LET$CMD.TEXTC
      2104**DCL      2112--REDEF    2118--REDEF    2123--REDEF    2137--REDEF    6734--ASSIGN   6734--ASSIGN
LET$CMD.TEXTC.EXP
      2106**DCL      6652>>ASSIGN   6682>>CALLBLT
LET$CMD.TEXTC.SIZE
      2105**DCL      2106--REDEF    6583>>ASSIGN
LET$CMD.TEXTC.TEXT
      2107**DCL      2108--REDEF    2109--REDEF    6582--ASSIGN   6656--ASSIGN   6682>>CALLBLT
LET$CMD.TEXTC.TEXTA
      2108**DCL      6664>>ASSIGN   6666>>ASSIGN
LET$CMD.TYPE
      2100**DCL      6575>>DOCASE   6732>>DOCASE
MVNP
      3753**DCL      6672>>ASSIGN
MVNU
      3754**DCL      6674>>ASSIGN
OTHERS
      6719**LABEL    6643--GOTO
POINTER
        23**DCL        24--REDEF      31--REDEF    6531<>CALL     6724<>CALL
POINTR.SEG
        29**DCL      6546>>IF
PSDITEM.ID
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:56   
        33**DCL      6550>>DOCASE
PSDITEM.TYPE
        32**DCL      6548>>DOCASE
RSIZE
        21**DCL      6583<<ASSIGN   6588<<ASSIGN   6616<<ASSIGN   6635<<ASSIGN   6655<<ASSIGN   6659<<ASSIGN
      6697<<ASSIGN   6707<<ASSIGN   6719<<ASSIGN   6724<>CALL
SDD$
      2943**DCL      3593--IMP-PTR
SIZE
        20**DCL      6531<>CALL     6577>>IF       6598>>IF       6613>>IF       6616>>ASSIGN   6624>>IF
      6635>>ASSIGN   6638>>IF       6675<<ASSIGN   6675>>ASSIGN   6704>>IF       6707>>ASSIGN   6711>>IF
      6724<>CALL
SVALS
        48**DCL      6628<<ASSIGN   6631<<ASSIGN   6632--ASSIGN
SVALUE
        19**DCL      6531<>CALL     6724<>CALL
S_D.ACCESS
      5214**DCL      6680<<ASSIGN   6683<<ASSIGN
S_D.ANLZ
      5827**DCL      6744>>IF
S_D.ANLZ_FILE
      5891**DCL      6558>>IF       6744>>IF
S_D.ANLZ_MODIFIED
      6107**DCL      6746>>IF       6748<<ASSIGN
S_D.CURRENT_CHANNEL
      6127**DCL      6129--REDEF
S_D.D$
      5265**DCL      6515>>ASSIGN   6516>>ASSIGN
S_D.DEBUGA
      5279**DCL      5281--REDEF
S_D.DESC$
      5259**DCL      6530<<ASSIGN
S_D.DO$
      5230**DCL      6514>>ASSIGN
S_D.EIS
      6237**DCL      6266--REDEF
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:57   
S_D.ERROR
      5208**DCL      6511<<ASSIGN   6521<<ASSIGN   6539<<ASSIGN   6554<<ASSIGN   6560<<ASSIGN   6566<<ASSIGN
      6579<<ASSIGN   6593<<ASSIGN   6602<<ASSIGN   6621<<ASSIGN   6640<<ASSIGN   6649<<ASSIGN   6715<<ASSIGN
      6741<<ASSIGN   6756<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      6170**DCL      6171--REDEF    6185--REDEF
S_D.INPUT
      5442**DCL      6751>>ASSIGN   6752--CALL
S_D.JDE
      5784**DCL      5785--REDEF
S_D.L$.VALUE
      5337**DCL      5343--REDEF    5351--REDEF    5354--REDEF    5357--REDEF    5360--REDEF
S_D.L$.VALUE.L
      5338**DCL      5339--REDEF    5340--REDEF
S_D.L6_MESSAGE_BUF
      6191**DCL      6193--REDEF
S_D.OUTPUT
      6157**DCL      6159--REDEF    6751<<ASSIGN
S_D.REMOTE_MSG.FNCC
      6176**DCL      6177--REDEF
S_D.REMOTE_MSG.STXC
      6172**DCL      6173--REDEF
S_D.REMOTE_MSG.SUBFNCC
      6180**DCL      6181--REDEF
S_D.REM_ACCESS
      5222**DCL      6679<<REMEMBR
S_D.RUM
      5825**DCL      6509>>IF       6564>>IF
S_D.SV
      5236**DCL      5257--REDEF
S_D$
      6488**DCL      5184--IMP-PTR  6509>>IF       6511>>ASSIGN   6514>>ASSIGN   6515>>ASSIGN   6516>>ASSIGN
      6521>>ASSIGN   6530>>ASSIGN   6539>>ASSIGN   6554>>ASSIGN   6558>>IF       6560>>ASSIGN   6564>>IF
      6566>>ASSIGN   6579>>ASSIGN   6593>>ASSIGN   6602>>ASSIGN   6621>>ASSIGN   6640>>ASSIGN   6649>>ASSIGN
      6679>>REMEMBR  6680>>ASSIGN   6683>>ASSIGN   6715>>ASSIGN   6741>>ASSIGN   6744>>IF       6744>>IF
      6746>>IF       6748>>ASSIGN   6751>>ASSIGN   6751>>ASSIGN   6756>>ASSIGN
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:58   
TEXTC.SZ
      6495**DCL      6496--IMP-SIZ  6734>>ASSIGN
TEXTC.TXT
      6496**DCL      6734>>ASSIGN
TSCALE
        41**DCL      6652<<ASSIGN   6653>>IF       6655>>ASSIGN   6660>>DOINDEX  6663>>DOINDEX  6664>>ASSIGN
U$SE.CUR
      2088**DCL      6517>>IF
USE$
        51**DCL      2087--IMP-PTR  6517>>IF
VAL2BIG
      6752**LABEL    6679--REMEMBR
VALUE
        44**DCL        45--REDEF    6608<>CALL     6609--ASSIGN   6682<<CALLBLT  6684--ASSIGN   6687<>CALL
      6689<>CALL     6731<<ASSIGN   6736<<ASSIGN   6738<>CALL
VALUE$
        18**DCL      6582<<ASSIGN   6587<<ASSIGN   6609<<ASSIGN   6612<<ASSIGN   6632<<ASSIGN   6634<<ASSIGN
      6656<<ASSIGN   6667<<ASSIGN   6684<<ASSIGN   6693<<ASSIGN   6706<<ASSIGN   6720<<ASSIGN   6724<>CALL
XPS_DFLOAT
      6507**DCL-ENT  6703--CALL
XPS_IFIX
      6506**DCL-ENT  6608--CALL
XVALUE
        42**DCL      6661<<ASSIGN   6664<<ASSIGN   6666<<ASSIGN   6667--ASSIGN
ZITEM
      3521**DCL      6738--CALL
ZITEM.ADDRESS
      3555**DCL      3560--REDEF    3561--REDEF    3562--REDEF
ZITEM.ADDR_TYPE
      3549**DCL      6738--CALL
ZITEM.DTYP
      3537**DCL      6525>>DOCASE
ZITEM.FLAGS.MDSE.S
      3530**DCL      6517>>IF
ZITEM.FMT_SPEC
      3551**DCL      6524>>ASSIGN
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:59   
ZITEM.PUP.BITS.PUB
      3580**DCL      6669>>IF
ZITEM.PUP.BITS.SIGNOVER
      3583**DCL      6647>>IF
ZITEM.PUP.BITS.SIGNPOS
      3581**DCL      6671>>ASSIGN   6672>>ASSIGN   6674>>ASSIGN
ZITEM.PUP.BITS.SIGNTYP
      3582**DCL      6670>>IF
ZITEM.PUP.SCALE
      3578**DCL      6652>>ASSIGN
ZITEM.SP.VD
      3563**DCL      3567--REDEF    3570--REDEF
ZITEM$
      2944**DCL      3521--IMP-PTR  6516<<ASSIGN   6517>>IF       6524>>ASSIGN   6525>>DOCASE   6647>>IF
      6652>>ASSIGN   6669>>IF       6670>>IF       6671>>ASSIGN   6672>>ASSIGN   6674>>ASSIGN   6738>>CALL
      6738>>CALL
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:60   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$LET File=DDA$LET.:E05TSI                                  TUE 07/29/97 13:33 Page:61   
              MINI UREF LISTING

DDA$LET      13**PROC
SDD_L6$    2945**DCL
UBIN36    6493**DCL
VITEM$      16**DCL
ZITEM_L6$    2946**DCL
