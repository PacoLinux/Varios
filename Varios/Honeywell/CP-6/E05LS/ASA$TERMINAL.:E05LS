VERSION E05

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:1    
        1        1        /*M* ASA$TERMINAL - Processes the TERMINAL line profile. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASA$TERMINAL: PROC ;
       11       11        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:2    
       12       12        /*********************************************************************/
       13       13        /*   Include files   include files   include files   include files   */
       14       14        /*********************************************************************/
       15       15                                                              /**/
       16       16              %INCLUDE  KL_SUPER_C   ;
       17     2918              %INCLUDE  AS_SUPER_C   ;
       18     3353              %INCLUDE  AS_MAC_C     ;
       19     3433              %INCLUDE  XU_FORMAT_C  ;
       20     3595              %INCLUDE  XU_MACRO_C   ;
       21     6701              %INCLUDE  AS_SUBS_C    ;
       22     8115              %INCLUDE  AS_SSUBS_C   ;
       23     8207              %INCLUDE  AS_PERR_C    ;
       24     8809              %INCLUDE  CP_6         ;
       25     8890              %INCLUDE  KL_CONFIG_M  ;
       26     9652              %INCLUDE  KL_MACRO_C   ;
       27    13004              %INCLUDE  KC$CGBLK     ;
       28    13052              %INCLUDE  AS_SUPER_R   ;
       29    16068              %INCLUDE  AS_ENTRIES_M ;
       30    17118              %INCLUDE  CP_6_SUBS    ;
       31    17658        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:3    
       32    17659        /********************************************************************/
       33    17660        /*   Auto data       auto data       auto data       auto data       */
       34    17661        /*********************************************************************/
       35    17662                                                              /**/
       36    17663    1   DCL ARS                           UBIN WORD ;
       37    17664    1   DCL BEGIN$                        PTR ;
       38    17665    1   DCL BLK$                          PTR ;
       39    17666    1   DCL CDNN                          CHAR(8) ;
       40    17667    1   DCL 1 CDNN_R REDEF CDNN,
       41    17668    1          2 TYPE                     CHAR(2),
       42    17669    1          2 NUM                      CHAR(2),
       43    17670    1          2 *                        CHAR(4);
       44    17671    1   DCL CNT                           UBIN WORD ;
       45    17672    1   DCL CODE2                         UBIN WORD ;
       46    17673    1   DCL CONSOLE_FLG                   BIT(1) ;
       47    17674    1   DCL CREATE                        BIT(1) ;
       48    17675    1   DCL DADR$                         PTR;
       49    17676    1   DCL DEVS                          UBIN WORD ;
       50    17677    1   DCL DEV_BUF2                      CHAR(100);
       51    17678    1   DCL DEV_REC                       CHAR(1000) ;
       52    17679    1   DCL DREC2$                        PTR;
       53    17680    1   DCL DREC$                         PTR;
       54    17681        %KL_GJOB  ( NAME     = GJOB,
       55    17682                    STCLASS  = AUTO,
       56    17683                    LVL      = 1,
       57    17684                    LAST     = ";" );
       58    17708    1   DCL GJOB_FLG                      BIT(1);
       59    17709    1   DCL GJOB_OK                       BIT(1);
       60    17710    1   DCL HASPDEV$                      PTR ;
       61    17711    1   DCL I                             SBIN WORD ;
       62    17712    1   DCL J                             SBIN WORD ;
       63    17713    1   DCL K                             SBIN WORD ;
       64    17714    1   DCL L                             SBIN WORD ;
       65    17715    1   DCL LOCAL                         BIT(1) ;
       66    17716    1   DCL MORE                          BIT(1) ;
       67    17717    1   DCL M_CONDEV                      BIT(1) ;
       68    17718    1   DCL M_CONDEV$                     PTR;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:4    
       69    17719    1   DCL 1 NAME,
       70    17720    1          2 COUNT                    UBIN BYTE UNAL,
       71    17721    1          2 TEXT                     CHAR(8) UNAL;
       72    17722    1   DCL NUM                           CHAR(2) ;
       73    17723    1   DCL PP$                           PTR ;
       74    17724    1   DCL PP_SIZE                       UBIN WORD ;
       75    17725    1   DCL PP_END$                       PTR;
       76    17726    1   DCL PP_TYPE                       UBIN;
       77    17727    1   DCL PRO$                          PTR ;
       78    17728    1   DCL PRO_BUF                       CHAR(AS_PRO_BUF_SIZEC);
       79    17729    1   DCL PTR$                          PTR ;
       80    17730    1   DCL P$                            PTR ;
       81    17731    1   DCL SAME_FLG                      BIT(1) ;
       82    17732    1   DCL SNAME                         CHAR(8) ;
       83    17733    1   DCL SREC$                         PTR ;
       84    17734    1   DCL SUBNDS                        UBIN WORD ;
       85    17735    1   DCL SUBS                          UBIN WORD ;
       86    17736    1   DCL S_HASPDEV$                    PTR ;
       87    17737    1   DCL S_TWSNC                       CHAR(4) ;
       88    17738    1   DCL TEMP                          UBIN WORD;
       89    17739    1   DCL TEMP$                         PTR;
       90    17740    1   DCL TERM_T                        CHAR(7);
       91    17741    1   DCL TREC$                         PTR ;
       92    17742    1   DCL TWSNC                         CHAR(4) ;
       93    17743    1   DCL TWSNR$                        PTR ;
       94    17744    1   DCL TWSN#                         UBIN WORD ;
       95    17745    1   DCL TWSN_ARS                      UBIN WORD ;
       96    17746    1   DCL TWSN_INDEX                    UBIN ;
       97    17747        %KL$UBWORD    ( NAME     = KL$UBWORD,
       98    17748                        STCLASS  = AUTO);
       99    17758        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:5    
      100    17759        /********************************************************************/
      101    17760        /*   Symref's        symref's        symref's        symref's        */
      102    17761        /*********************************************************************/
      103    17762                                                              /**/
      104    17763    1   DCL B$TCB$               PTR       SYMREF ;
      105    17764    1   DCL TYPE                 CHAR(2)   SYMREF ;
      106    17765    1   DCL TCD_OPT_LIST         UBIN WORD SYMREF ;
      107    17766    1   DCL TERMINAL_CMD         UBIN(36)  SYMREF ;
      108    17767    1   DCL TERM_OPT_LIST        UBIN WORD SYMREF ;
      109    17768        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:6    
      110    17769        /********************************************************************/
      111    17770        /*   Static data     static data     static data     static data     */
      112    17771        /*********************************************************************/
      113    17772                                                              /**/
      114    17773        %KL$CONFIG_KEY  ( NAME    = CONFIG_KEY,
      115    17774                          STCLASS = STATIC);
      116    17821        %KL_HNDCMN_INFO ( FPTN    = KL_HNDCMN,
      117    17822                          STCLASS = STATIC);
      118    17902        %KL_NA_INFO     ( FPTN    = KL_NA,
      119    17903                          STCLASS = STATIC);
      120    17952        %KL_SS;
      121    17987        %KL$TERM        ( NAME    = KL_TERM_REC,
      122    17988                          STCLASS = STATIC);
      123    18037        %KL$TERM_KEY    ( NAME    = KL_TERM_KEY,
      124    18038                          STCLASS = STATIC);
      125    18084    1   DCL LINCNFG$                PTR STATIC INIT(ADDR(LINCNFG_BUF));
      126    18085    1   DCL LINCNFG_BUF   (0:49)    UBIN WORD STATIC INIT(0*0);
      127    18086    1   DCL 1 LNGTH ALIGNED STATIC,
      128    18087    1          2 T                  UBIN(28) UNAL INIT(0),
      129    18088    1          2 B                  UBIN(8) UNAL INIT(0);
      130    18089    1   DCL LNG_CNT REDEF LNGTH UBIN;
      131    18090    1   DCL 1 TERM_KEY ALIGNED STATIC ,
      132    18091    1          2 CNT                UBIN BYTE UNAL INIT( 9 ),
      133    18092    1          2 TXT UNAL ,
      134    18093    1             3 ACCT            CHAR(8) UNAL INIT(' ') ,
      135    18094    1             3 ASTR            CHAR(1) UNAL INIT('*') ;
      136    18095        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:7    
      137    18096        /********************************************************************/
      138    18097        /*   Constant data        constant data        constant data        */
      139    18098        /*********************************************************************/
      140    18099        %KL_HASPDEV ( NAME    = KL_HASPDEV ,
      141    18100                      STCLASS = CONSTANT ) ;
      142    18334        %KL_DREC ( NAME    = KL_TREC ,
      143    18335                   STCLASS = CONSTANT ,
      144    18336                   TYP     = %KLAT_TRM# ,
      145    18337                   RNAME   = ' ' ,
      146    18338                   PASS    = ' ' ,
      147    18339                   PRO     = ' ' ,
      148    18340                   WORG    = ' ' ,
      149    18341                   LAST    = "," ) ;
      150    18454        %KL_GJOB ( NAME    = GJOB,
      151    18455                   STCLASS = CONSTANT,
      152    18456                   LAST    = ",",
      153    18457                   LVL     = 2 );
      154    18481        %KL_HASP ( NAME    = HASP,
      155    18482                   STCLASS = STATIC,
      156    18483                   LVL     = 2 );
      157    18633    1   DCL TERM_TYPE_A(0:2) CHAR(11) CONSTANT INIT( 'STDHASP', 'STD2780', 'STD3780' ) ;
      158    18634    1   DCL TERM_TYPES  REDEF TERM_TYPE_A CHAR(33) ;
      159    18635        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:8    
      160    18636        /*********************************************************************/
      161    18637        /*   Local based     local based     local based     local based     */
      162    18638        /*********************************************************************/
      163    18639        %B$TCB;
      164    18642        %B$ALT;
      165    18650                                                              /**/
      166    18651    1   DCL ACHAR                  CHAR(1) BASED;
      167    18652        %KL_DREC      ( NAME     = KL$SREC,
      168    18653                        LAST     = ";",
      169    18654                        STCLASS  = "BASED( SREC$ )" );
      170    18767        %KL_DREC      ( NAME     = KL$DREC ,
      171    18768                        STCLASS  = BASED ,
      172    18769                        LAST     = "," );
      173    18882           %KC$CGID   ( FPTN     = KC$CGID,
      174    18883                        STCLASS  = STCLASS,
      175    18884                        LVL      = 2,
      176    18885                        LAST     = ";" );
      177    18911        %KL_DREC      ( NAME     = KL$TREC ,
      178    18912                        STCLASS  = "BASED( TREC$ )",
      179    18913                        LAST     = "," );
      180    19026           %KL_GJOB   ( NAME     = GJOB,
      181    19027                        STCLASS  = BASED,
      182    19028                        LVL      = 2,
      183    19029                        LAST     = "," );
      184    19053           %KL_HASP   ( NAME     = HASP,
      185    19054                        STCLASS  = BASED,
      186    19055                        LVL      = 2);
      187    19205        %KL_HASPDEV   ( NAME     = KL$HASPDEV,
      188    19206                        STCLASS  = "BASED( HASPDEV$ )");
      189    19440        %KL$LINCNFG   ( NAME     = LINCNFG,
      190    19441                        STCLASS  = "BASED(LINCNFG$)");
      191    19599        %KL_PHDR      ( NAME     = KL$PHDR ,
      192    19600                        STCLASS  = "BASED( PRO$ )") ;
      193    19641    1   DCL 1 PP$STRCT BASED( PP$ ) UNAL ,
      194    19642    1          2 TYPE                     UBIN BYTE UNAL ,
      195    19643    1          2 SIZE                     UBIN BYTE UNAL ;
      196    19644        %KL_TRMD      ( NAME     = KL$TRMD ,
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:9    
      197    19645                        STCLASS  = "BASED UNAL") ;
      198    19807        %KL_TWSNREC   ( NAME     = KL$TWSNREC ,
      199    19808                        STCLASS  = "BASED( TWSNR$ )") ;
      200    19833        %PARSE$OUT    ( NAME = P$NODE, STCLASS = "BASED (NODE$)",
      201    19834                        NDTYPE = TYPE, NSUBLKS = SUBNODES) ;
      202    19879        %PARSE$SYM    ( NAME = OUT$SYM ,
      203    19880                        STCLASS = "BASED(BLK$)") ;
      204    19918        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:10   
      205    19919        /********************************************************************/
      206    19920        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      207    19921        /*********************************************************************/
      208    19922                                                              /**/
      209    19923        %ASA$CON_OPTS ;
      210    19926        %ASA$DEV_OPTS ;
      211    19929        %ASA$ERROR ;
      212    19932        %ASB$CHECK_TYPE ;
      213    19935        %ASB$CLOSE_NETCON ;
      214    19938        %ASB$DELREC_HLP ;
      215    19941        %ASB$DEQ_HLP ;
      216    19944        %ASB$ENQ_HLP ;
      217    19947        %ASB$FIND_NUM ;
      218    19950        %ASB$FIND_TWSN_INDEX ;
      219    19953        %ASB$GETSEG ;
      220    19956        %ASB$READ_HLP ;
      221    19959        %ASB$READ_NETCON ;
      222    19962        %ASB$READ_SI ;
      223    19965        %ASB$SET_PROMPT ;
      224    19968        %ASB$VALID_TDEVICE ;
      225    19971        %ASB$WRITE_HLP ;
      226    19974        %ASB$WRITE_LO ;
      227    19977        %ASB$WRITE_NETCON ;
      228    19980        %ASD$READ_PRO ;
      229    19983        %ASH$DQUEST ;
      230    19986        %ASH$ERROR ;
      231    19989        %ASH$HELP ;
      232    19992        %ASH$INFO ;
      233    19995        %ASH$QUEST ;
      234    19998        %ASH$WARN ;
      235    20001        %ASZ$SCRAMBLE ;
      236    20004    1   DCL X$PARSE ENTRY(1) ALTRET ;
      237    20005        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:11   
      238    20006        /********************************************************************/
      239    20007        /*   Procedure       procedure       procedure       procedure       */
      240    20008        /*********************************************************************/
      241    20009                                                              /**/
      242    20010        /*
      243    20011            ***            Begin procedure                    ***
      244    20012        */
      245    20013    1   DREC$=ADDR(DEV_REC);
      246    20014    1   IF P$NODE.SUBLK$(0) -> P$NODE.CODE = CREATE_VAL
      247    20015    1   THEN
      248    20016    1      CREATE = AS_TRUE ;
      249    20017    1   ELSE
      250    20018    1      CREATE = AS_FALSE ;
      251    20019    1   P_PCB.ROOT$ = ADDR( TERMINAL_CMD ) ;
      252    20020    1   CALL X$PARSE( P_PCB )
      253    20021    2   WHENALTRETURN DO;
      254    20022    2      CALL ASH$ERROR( P_PCB.ERROR ) ;
      255    20023    2      RETURN ;
      256    20024    2      END; /*  Whenaltreturn  */
      257    20025                                                              /**/
      258    20026    1   NODE$ = P_PCB.OUT$ ;
      259    20027    1   SUBS = P$NODE.SUBNODES ;
      260    20028                                                              /**/
      261    20029                                                              /*  Set up :HLP record.  */
      262    20030                                                              /*  Blank out password.   */
      263    20031                                                              /**/
      264    20032    1   USERS_KEY = '0'B ;
      265    20033    1   IF NOT DSEG_FLG
      266    20034    1   THEN
      267    20035    1      CALL ASB$GETSEG
      268    20036    2      WHENALTRETURN DO;
      269    20037              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A') ;
      270    20052    2         RETURN ;
      271    20053    2         END;  /*  Whenaltreturn  from ASB$GETSEG  */
      272    20054                                                              /**/
      273    20055    1   TREC$ = DSEG1$ ;
      274    20056    1   TWSNR$ = DSEG2$ ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:12   
      275    20057    1   SREC$ = DSEG3$ ;
      276    20058                                                         /* Check exist. of  c/m terminal */
      277    20059    1   BLK$ = NODE$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      278    20060    2   IF OUT$SYM.COUNT > 8 THEN DO;
      279    20061        /*E*  ERROR:    ASA-E$TNAMETOOBIG-C
      280    20062              MESSAGE:  Terminal name too long.
      281    20063              MESSAGE1: Terminal names can be at most 8 characters.
      282    20064        */
      283    20065           %SCREAM( ERR#=E$TNAMETOOBIG, LEVEL=ERROR, MID='A' );
      284    20080    2      RETURN ;
      285    20081    2      END ;    /* Then do */
      286    20082    1   NAME.COUNT = OUT$SYM.COUNT;
      287    20083    1   NAME.TEXT  = OUT$SYM.TEXT;
      288    20084    1   TERM_KEY.TXT.ACCT = NAME.TEXT;
      289    20085    1   USERS_KEY = TERM_KEY ;
      290    20086    1   ARS = DSEG1SIZE ;
      291    20087    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;
      292    20088    1   ENQDEQ_FLG = AS_TRUE ;
      293    20089    1   CALL ASB$READ_HLP( DSEG1$, ARS )
      294    20090    2   WHENRETURN DO;
      295    20091    2      CALL ASB$CHECK_TYPE( DSEG1$, ARS, AS_TERM#, CREATE, NAME ) ALTRET(EXIT#);
      296    20092    3      IF CREATE THEN DO;
      297    20093           /*E*  ERROR:    ASA-E$TERM_ALREADY_EXISTS-C
      298    20094                 MESSAGE0: Terminal %%U1 %already exists.
      299    20095                 MESSAGE1: Cannot CREATE a terminal that already exists.
      300    20096           */
      301    20097    3         AS_FIELD1 = NAME;
      302    20098              %SCREAM( ERR#=E$TERM_ALREADY_EXISTS, LEVEL=ERROR, MID='A') ;
      303    20113    3   EXIT#: CALL ASB$DEQ_HLP ;
      304    20114    3         ENQDEQ_FLG = AS_FALSE ;
      305    20115    3         RETURN ;
      306    20116    3         END ; /* If create */
      307    20117    2      SNAME = KL$TREC.SNAME ;
      308    20118    2      END;  /*  Whenreturn  */
      309    20119    2   WHENALTRETURN DO;
      310    20120    3      IF NOT CREATE THEN DO;
      311    20121        /*E*  ERROR:    ASA-E$TERM_NO_EXIST-C
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:13   
      312    20122              MESSAGE0: Terminal %%U1 %does not exist. Switching to CREATE mode.
      313    20123        */
      314    20124    3         CALL INDEX( I, AS_BLANK, SUBSTR(USERS_KEY.TXTC,0,8) ) ;
      315    20125    3         AS_FIELD1.COUNT = I ;
      316    20126    3         AS_FIELD1.TEXT = USERS_KEY.TXTC ;
      317    20127              %SCREAM( ERR#=E$TERM_NO_EXIST, LEVEL=WARN, MID='A') ;
      318    20142    3         CREATE = AS_TRUE ;
      319    20143    3         END;  /*  If not create  */
      320    20144    2      SNAME = 'LOCAL';
      321    20145    2      END;  /*  Whenaltreturn  */
      322    20146        /**/
      323    20147    1   TERM_T=' ';
      324    20148                                                              /*  Check exist of station */
      325    20149    2   DO I = 1 TO SUBS-1 ;
      326    20150    2      IF P$NODE.SUBLK$(I) -> P$NODE.CODE = STAT_ACCT_N
      327    20151    3      THEN DO;
      328    20152    3         BLK$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) ;
      329    20153    4         IF OUT$SYM.COUNT > 8 THEN DO;
      330    20154                 %SCREAM( ERR#=E$SNAMETOOBIG, LEVEL=ERROR, MID='A' );
      331    20169    4            RETURN ;
      332    20170    4            END ; /* If count > 8  */
      333    20171    3         SNAME = OUT$SYM.TEXT;
      334    20172    3         IF NOT CREATE AND KL$TREC.SNAME ~= SNAME
      335    20173    4         THEN DO;
      336    20174        /*E* ERROR:   ASA-E$TERM_NOTBELONG-C
      337    20175             MESSAGE: Warning:  Terminal %U1 was created for %U2, not %U3.
      338    20176        */
      339    20177    4            AS_FIELD1 = NAME ;
      340    20178    4            CALL INDEX( I, AS_BLANK, KL$TREC.SNAME ) ;
      341    20179    4            AS_FIELD2.COUNT = I ;
      342    20180    4            AS_FIELD2.TEXT = KL$TREC.SNAME ;
      343    20181    4            AS_FIELD3.COUNT = OUT$SYM.COUNT ;
      344    20182    4            AS_FIELD3.TEXT = OUT$SYM.TEXT ;
      345    20183                 %SCREAM( ERR#=E$TERM_NOTBELONG, LEVEL=ERROR, MID='A');
      346    20198    4            SNAME = KL$TREC.SNAME ;
      347    20199    4            END ;  /*  Not create and sname's dont match  */
      348    20200    3         END;  /*  If STAT_ACCT_N  */
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:14   
      349    20201                                                              /*  Term type.  */
      350    20202                                                              /**/
      351    20203    2      IF P$NODE.SUBLK$(I) -> P$NODE.CODE = TERM_TYPE_VAL
      352    20204    3      THEN DO;
      353    20205    3         CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      354    20206                                                              /**/
      355    20207    4         DO SELECT( CODE ) ;
      356    20208                                                              /**/
      357    20209    4            SELECT( T_IRBT_VAL ) ;
      358    20210    4            TERM_T='STDHASP';
      359    20211                                                              /**/
      360    20212    4            SELECT( T_2780_VAL ) ;
      361    20213    4            TERM_T='STD2780';
      362    20214                                                              /**/
      363    20215    4            SELECT( T_3780_VAL ) ;
      364    20216    4            TERM_T='STD3780';
      365    20217                                                              /**/
      366    20218    4            END ;   /* Do case code  */
      367    20219    3         END ; /* If TERM_TYPE_VAL  */
      368    20220    2      END; /* Of do i */
      369    20221                                                          /* If for station was not  */
      370    20222                                                          /* specified in create, then  */
      371    20223                                                         /* the default is local station. */
      372    20224    1   IF SNAME = 'LOCAL'
      373    20225    1   THEN LOCAL = AS_TRUE ;
      374    20226    1   ELSE LOCAL = AS_FALSE ;
      375    20227    1   CALL CONCAT ( USERS_KEY.TXTC, SNAME, 'STATION' );
      376    20228    1   USERS_KEY.COUNT = 15;
      377    20229    1   CALL INDEX ( I, AS_BLANK, SNAME );
      378    20230    1   NAME.COUNT = I ;
      379    20231    1   NAME.TEXT = SNAME ;
      380    20232    1   ARS = DSEG3SIZE ;
      381    20233    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;
      382    20234    1   ENQDEQ_FLG = AS_TRUE ;
      383    20235    1   CALL ASB$READ_HLP( DSEG3$, ARS )
      384    20236    2   WHENALTRETURN DO;
      385    20237        /*E* ERROR:   ASA-E$STAT_NO_EXIST-C
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:15   
      386    20238             MESSAGE0: Station %%U1 %does not exist.
      387    20239        */
      388    20240    2      CALL INDEX (I, AS_BLANK, SUBSTR(USERS_KEY.TXTC,0,8) ) ;
      389    20241    2      AS_FIELD1.COUNT = I ;
      390    20242    2      AS_FIELD1.TEXT = USERS_KEY.TXTC ;
      391    20243           %SCREAM( ERR#=E$STAT_NO_EXIST, LEVEL=WARN, MID='A') ;
      392    20258    2      CALL ASB$DEQ_HLP ;
      393    20259    2      ENQDEQ_FLG = AS_FALSE ;
      394    20260    2      RETURN ;
      395    20261    2      END; /*  Whenaltreturn  */
      396    20262        /**/
      397    20263    1   CALL ASB$CHECK_TYPE( DSEG3$, ARS, AS_STAT#, CREATE, NAME ) ALTRET(EXIT#);
      398    20264    1   TWSNC = KL$SREC.TWSN# ;
      399    20265                                                              /* Read twsn record */
      400    20266    1   CALL CHARBIN( TWSN#, TWSNC ) ;
      401    20267    1   USERS_KEY.COUNT = 8 ;
      402    20268    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;
      403    20269    1   ARS = DSEG2SIZE ;
      404    20270    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;
      405    20271    1   ENQDEQ_FLG = AS_TRUE ;
      406    20272    1   CALL ASB$READ_HLP( TWSNR$, ARS )
      407    20273    2   WHENALTRETURN DO;
      408    20274        /*E*  ERROR:    ASA-E$TWSN_NO_EXIST-C
      409    20275              MESSAGE:  %%U1 %does not exist.
      410    20276              MESSAGE1: TWSN %%U1 %record does not exist.
      411    20277        */
      412    20278    2      AS_FIELD1 = USERS_KEY ;
      413    20279           %SCREAM( ERR#=E$TWSN_NO_EXIST, LEVEL=ERROR, MID='A') ;
      414    20294    2      CALL ASB$DEQ_HLP ;
      415    20295    2      ENQDEQ_FLG = AS_FALSE ;
      416    20296    2      RETURN ;
      417    20297    2      END; /*  Whenaltreturn  */
      418    20298        /**/
      419    20299    1   USERS_KEY = TERM_KEY ;
      420    20300    1   TWSN_ARS = ARS ;
      421    20301                                                              /**/
      422    20302    1   IF CREATE
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:16   
      423    20303    2   THEN DO ;
      424    20304    2      KL$TREC = KL_TREC ;
      425    20305    2      KL$TREC.SUPER = AS_TERM#;
      426    20306    2      KL$TREC.TNAME = TERM_KEY.TXT.ACCT ;
      427    20307    2      KL$TREC.SNAME = SNAME ;
      428    20308    2      KL$TREC.ATYP = %KLAT_TRM# ;
      429    20309    2      KL$TREC.PNAME.TXT=TERM_T;
      430    20310    2      IF TERM_T~=' ' THEN
      431    20311    2         KL$TREC.PNAME.CNT=7;
      432    20312    2      ELSE
      433    20313    2         KL$TREC.PNAME.CNT = 0 ;
      434    20314    2      CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;
      435    20315    2      CALL ASZ$SCRAMBLE( KL$TREC.GJOB.PASS ) ;
      436    20316    2      KL$TREC.TWSN# = TWSNC ;
      437    20317    2      HASPDEV$ = PINCRW( ADDR(KL$TREC.HASP), SIZEW(KL$TREC.HASP));
      438    20318    2      KL$TREC.HASP.BLKHDR.LEV = 1;
      439    20319    2      KL$TREC.HASP.BLKHDR.NSUBS = 0;
      440    20320    2      KL$TREC.HASP.BLKHDR.BLKTYP = %KLTY_STRM#;
      441    20321    2      LNG_CNT = LENGTHC( KL$TREC.HASP);
      442    20322    2      KL$UBWORD.REPLACE.T = LNGTH.T;
      443    20323    2      KL$UBWORD.REPLACE.B = LNGTH.B;
      444    20324    2      KL$TREC.HASP.BLKHDR.LEN.BYT(0) = KL$UBWORD.REPLACE.T;
      445    20325    2      KL$TREC.HASP.BLKHDR.LEN.BYT(1) = KL$UBWORD.REPLACE.B;
      446    20326    2      END ;  /*  If create  */
      447    20327    2   ELSE DO ;
      448    20328    2      HASPDEV$ = PINCRW(ADDR(KL$TREC.HASP),SIZEW(KL$TREC.HASP)+(KL$TREC.HASP.BLKHDR.
             20328               NSUBS*SIZEW(KL_HASPDEV)));
      449    20329    2      CALL INDEX( I, KL$TREC.PNAME.TXT, TERM_TYPES )
      450    20330    3      WHENRETURN DO;
      451    20331    3         TERM_T = KL$TREC.PNAME.TXT ;
      452    20332    3         END ;  /*  Whenreturn  */
      453    20333    2      END;  /*  Not create  */
      454    20334                                                              /*  Do options  */
      455    20335    1   MORE = AS_TRUE ;
      456    20336    1   M_CONDEV = AS_FALSE ;
      457    20337                                                              /**/
      458    20338    1   TERM_LOOP: ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:17   
      459    20339    2   DO WHILE( MORE ) ;
      460    20340    2      P_PCB.ROOT$ = ADDR( TERM_OPT_LIST ) ;
      461    20341    2      REMEMBER TERM_LOOP IN REMEM_VAR ;
      462    20342                                                              /* Set prompt */
      463    20343    2      CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;
      464    20344                                                              /* Read input */
      465    20345    2      CALL ASB$READ_SI( IN_BUF, ARS ) ;
      466    20346    2      P_PCB.NCHARS = ARS ;
      467    20347    2      CALL X$PARSE( P_PCB ) ALTRET( TERM_OPT_ERR ) ;
      468    20348    2      NODE$ = P_PCB.OUT$ ;
      469    20349                                                              /**/
      470    20350    3      DO I = 0 TO P$NODE.SUBNODES-1 ;
      471    20351    3         PTR$ = P$NODE.SUBLK$(I) ;
      472    20352    3         CODE = PTR$ -> P$NODE.CODE ;
      473    20353    4         DO SELECT( CODE ) ;
      474    20354                                                              /**/
      475    20355    4            SELECT( TERM_PASS_VAL ) ;
      476    20356    4            CODE2 = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
      477    20357    5            DO SELECT( CODE2 ) ;
      478    20358                                                              /**/
      479    20359    5               SELECT( NONE_VAL ) ;
      480    20360                                                              /* No password */
      481    20361    5               KL$TREC.PASSWORD = AS_BLANK ;
      482    20362    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;
      483    20363                                                              /**/
      484    20364    5               SELECT( TERM_PW_VAL ) ;
      485    20365    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
      486    20366    5               CNT = OUT$SYM.COUNT ;
      487    20367    6               IF CNT > 8 THEN DO;
      488    20368        /*E*  ERROR:    ASA-E$PASSW_TOO_LONG-C
      489    20369              MESSAGE:  Password is too long.
      490    20370              MESSAGE1: Password can be at most 8 characters long.
      491    20371        */
      492    20372                       %SCREAM( ERR#=E$PASSW_TOO_LONG, LEVEL=ERROR, MID='A') ;
      493    20387    6                  RETURN ;
      494    20388    6                  END ;  /* Then do */
      495    20389    5               KL$TREC.PASSWORD = OUT$SYM.TEXT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:18   
      496    20390    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;
      497    20391                                                              /**/
      498    20392    5               SELECT( OCT_PASS_VAL ) ;
      499    20393    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);
      500    20394    5               CNT = OUT$SYM.COUNT;
      501    20395    5               IF CNT ~= 24
      502    20396    6               THEN DO;
      503    20397        /*E*  ERROR:    AS-E$OCTAL_PASSWORD_LENGTH_ERR-C
      504    20398              MESSAGE: PASSWORD not the right size.
      505    20399              MESSAGE1: PASSWORD in octal form must be 24 characters long.
      506    20400        */
      507    20401                       %SCREAM(ERR#=E$OCTAL_PASSWORD_LENGTH_ERR,LEVEL=ERROR,MID='A');
      508    20416    6                  END; /*  Length error  */
      509    20417    6               ELSE DO;
      510    20418    6                  P$ = ADDR ( OUT$SYM.TEXT );
      511    20419    6                  PTR$ = PINCRC (P$,24);
      512    20420    6                  TEMP$ = ADDR (KL$TREC.PASSWORD);
      513    20421    7                  DO WHILE P$ < PTR$ ;
      514    20422    7                     CALL CHARBIN (L, P$->ACHAR);
      515    20423    7                     P$ = PINCRC (P$,1);
      516    20424    7                     CALL CHARBIN (J, P$-> ACHAR);
      517    20425    7                     P$ = PINCRC (P$,1);
      518    20426    7                     CALL CHARBIN (K, P$->ACHAR);
      519    20427    7                     TEMP = L * 64 + J * 8 + K;
      520    20428    7                     P$ = PINCRC (P$, 1);
      521    20429    7                     TEMP$ -> ACHAR = BINASC ( TEMP );
      522    20430    7                     TEMP$ = PINCRC (TEMP$, 1);
      523    20431    7                     END; /*  Do while P$ < PTR$  */
      524    20432    6                  END; /*  Length ok  */
      525    20433    5               END ; /* Do case( CODE2 ) */
      526    20434                                                              /**/
      527    20435    4            SELECT( TERM_PRO_VAL ) ;
      528    20436    5            IF PTR$->P$NODE.CODE = NONE_VAL THEN DO;
      529    20437    5               KL$TREC.PNAME.CNT=0;
      530    20438    5               KL$TREC.PNAME.TXT=' ';
      531    20439    5               GOTO TERM_LOOP;
      532    20440    5               END;  /*  Profile none  */
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:19   
      533    20441    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;
      534    20442    4            IF OUT$SYM.COUNT > 11
      535    20443    4            THEN
      536    20444    5            DO ;
      537    20445                    %SCREAM( ERR#=E$PRO_TOO_LONG, LEVEL=ERROR, MID='A') ;
      538    20460    5               GOTO TERM_LOOP ;
      539    20461    5               END ;    /* Then do */
      540    20462    4            PRO$ = ADDR(PRO_BUF);
      541    20463    4            ARS = LENGTHC(PRO_BUF);
      542    20464    4            USERS_KEY.COUNT=OUT$SYM.COUNT;
      543    20465    4            USERS_KEY.TXTC=OUT$SYM.TEXT;
      544    20466    4            CALL ASD$READ_PRO(USERS_KEY,KL$PHDR,ARS) ALTRET(TERM_PRO_ERR);
      545    20467    5            IF KL$PHDR.TTYP ~= %KLTY_STRM# THEN DO;
      546    20468        /*E* ERROR: ASA-E$TERMPROTYPE-0
      547    20469             MESSAGE: You must specify a profile that defines a terminal.
      548    20470             MESSAGE1: Examples: PRO=IRBT, PRO=2780, PRO=STDHASP.
      549    20471        */
      550    20472                    %SCREAM( ERR#=E$TERMPROTYPE, LEVEL=ERROR, MID='A' );
      551    20487    5               GOTO TERM_LOOP;
      552    20488    5               END;
      553    20489        /*
      554    20490            Find the trmd portion of the profile just read in.
      555    20491            It contains a profile type for stream type profiles.
      556    20492            Compare that to the terminal type.
      557    20493        */
      558    20494    4            PP$ = PRO$;
      559    20495    4            PP_END$ = PINCRC( PP$, ARS ) ;
      560    20496    4            PP$ = PINCRW( PP$, SIZEW( KL$PHDR ) ) ;
      561    20497    5            DO WHILE ( PP$ < PP_END$ ) ;
      562    20498    5               PP_TYPE = PP$STRCT.TYPE ;
      563    20499    5               PP_SIZE = PP$STRCT.SIZE ;
      564    20500    5               PP$ = PINCRC( PP$, 2 ) ;
      565    20501
      566    20502    6               DO SELECT( PP_TYPE ) ;
      567    20503
      568    20504    6                  SELECT( %KL_PRMID_TRMD ) ;
      569    20505    6                  GOTO FOUND_IT;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:20   
      570    20506
      571    20507    6                  END ; /*  Do case  */
      572    20508
      573    20509    5               I = PP_SIZE + (MOD (PP_SIZE, 2)); /* Force i to be even */
      574    20510    5               L = PP_SIZE + (MOD (PP_SIZE, 2)); /* Force l to be even */
      575    20511    5               PP$ = PINCRC ( PP$, L ) ;
      576    20512
      577    20513    5               END ; /*  Do while  */
      578    20514
      579    20515    4   FOUND_IT:
      580    20516        /*  Compare terminal type against profile type, if not = error */
      581    20517    4            IF (PP$ -> KL$TRMD.PROTYP# = %PT_HASP_VAL AND NOT TERM_T = 'STDHASP')
      582    20518    4                 OR (PP$ -> KL$TRMD.PROTYP# = %PT_NJE_VAL AND NOT TERM_T = 'STDHASP')
      583    20519    4                 OR (PP$ -> KL$TRMD.PROTYP# = %PT_2780_VAL AND NOT TERM_T = 'STD2780')
      584    20520    4                 OR (PP$ -> KL$TRMD.PROTYP# = %PT_3780_VAL AND NOT TERM_T = 'STD3780')
      585    20521    5            THEN DO;
      586    20522        /*E* ERROR: ASA-E$TYPE_DONT_MATCH-0
      587    20523             MESSAGE: Profile type doesn't match terminal type.
      588    20524             MESSAGE1: %U1 profile type is not the same as %U2 terminal type.
      589    20525        */
      590    20526    5               AS_FIELD1.COUNT = 6;
      591    20527    6               DO SELECT (PP$->KL$TRMD.PROTYP#);
      592    20528    6                  SELECT (%PT_HASP_VAL);
      593    20529    6                  AS_FIELD1.TEXT = 'HASP  ';
      594    20530
      595    20531    6                  SELECT (%PT_2780_VAL);
      596    20532    6                  AS_FIELD1.TEXT = '2780  ';
      597    20533
      598    20534    6                  SELECT (%PT_3780_VAL);
      599    20535    6                  AS_FIELD1.TEXT = '3780  ';
      600    20536
      601    20537    6                  SELECT (%PT_POLLED_VAL);
      602    20538    6                  AS_FIELD1.TEXT = 'POLLED';
      603    20539
      604    20540    6                  SELECT (%PT_HIP_VAL);
      605    20541    6                  AS_FIELD1.TEXT = 'HIP   ';
      606    20542
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:21   
      607    20543    6                  SELECT (%PT_NJE_VAL);
      608    20544    6                  AS_FIELD1.TEXT = 'NJE   ';
      609    20545
      610    20546    6                  END; /*  Case protyp  */
      611    20547    5               AS_FIELD2.COUNT = 4;
      612    20548    5               AS_FIELD2.TEXT = SUBSTR (TERM_T,3,4);
      613    20549                    %SCREAM (ERR#=%E$TYPE_DONT_MATCH, LEVEL=ERROR, MID='A');
      614    20564    5               GOTO TERM_LOOP;
      615    20565    5               END;
      616    20566    4            KL$TREC.PNAME.CNT = OUT$SYM.COUNT ;
      617    20567    4            KL$TREC.PNAME.TXT = OUT$SYM.TEXT ;
      618    20568                                                              /**/
      619    20569    4            SELECT( TERM_CON_VAL ) ;
      620    20570    4            CONSOLE_FLG = AS_TRUE ;
      621    20571    4            TWSN_INDEX = KL$TWSNREC.NDEV ;
      622    20572    4            KL$HASPDEV = KL_HASPDEV;
      623    20573    4            KL$HASPDEV.BLKHDR.LEV = 2;
      624    20574    4            KL$HASPDEV.BLKHDR.BLKTYP = %KLTY_SDEV#;
      625    20575    4            LNG_CNT = LENGTHC( KL_HASPDEV );
      626    20576    4            KL$UBWORD.REPLACE.T = LNGTH.T;
      627    20577    4            KL$UBWORD.REPLACE.B = LNGTH.B;
      628    20578    4            KL$HASPDEV.BLKHDR.LEN.BYT(0) = KL$UBWORD.REPLACE.T;
      629    20579    4            KL$HASPDEV.BLKHDR.LEN.BYT(1) = KL$UBWORD.REPLACE.B;
      630    20580    4            KL$HASPDEV.BLKHDR.DEVNUM = KL$TREC.HASP.BLKHDR.NSUBS+1;
      631    20581    4            KL$HASPDEV.TERMID.TERM.TERM_NAME = TERM_KEY.TXT.ACCT;
      632    20582    4            KL$HASPDEV.TERMID.LEV = 2;
      633    20583    4            LNG_CNT = KL$HASPDEV.BLKHDR.DEVNUM;
      634    20584    4            KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT(0) = LNGTH.T;
      635    20585    4            KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT(1) = LNGTH.B;
      636    20586    4            DADR$ = ADDR (KL$HASPDEV.DADR);
      637    20587    4            CALL ASA$CON_OPTS(DREC$,TWSNR$,TWSNC,'1'B,'1'B,TERM_T,LOCAL,TWSN_INDEX,
             20587                     KL_SS,DADR$);
      638    20588    4            KL$TREC.HASP.BLKHDR.NSUBS = KL$TREC.HASP.BLKHDR.NSUBS+1;
      639    20589    4            DREC$->KL$TREC.FLAGS.RNME='0'B;
      640    20590    4            DREC$->KL$TREC.TNAME=TERM_KEY.TXT.ACCT ;
      641    20591    4            DREC$->KL$TREC.SNAME=SNAME ;
      642    20592    4            ARS = DREC$->KL$TREC.NWINFO * 4  +  LENGTHC(KL_DREC_CNT) ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:22   
      643    20593    4            USERS_KEY.COUNT = 8 ;
      644    20594    4            USERS_KEY.TXTC = FROM_KEY.TEXT ;
      645    20595    4            CALL ASB$WRITE_HLP(DREC$,ARS) ALTRET(WRITE_TREC_ERR) ;
      646    20596    4            KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = TERM_KEY.TXT.ACCT ;
      647    20597    4            KL$TWSNREC.NDEV = TWSN_INDEX + 1 ;
      648    20598    4            TWSN_ARS = TWSN_ARS + LENGTHC(KL$TWSNREC.DEVS(0));
      649    20599    4            CALL ASB$WRITE_LO( AS_CREATED_TEXT, LENGTHC(AS_CREATED_TEXT));
      650    20600    4            CONFIG_KEY.TERMID = KL$HASPDEV.TERMID;
      651    20601    4            LINCNFG_BUF = '0'B;
      652    20602    4            LINCNFG.KHA = KL_HNDCMN;
      653    20603    4            LINCNFG.NA = KL_NA;
      654    20604    4            LINCNFG.NA.SNDSLT = '0'B;
      655    20605    4            LINCNFG.NA.AUTLGN = '1'B;
      656    20606    4            LINCNFG.LGN.LGNSIZE = KL_SS.CNT;
      657    20607    4            LINCNFG.LGN.LGNSTRING = KL_SS.SGN_R;
      658    20608    4            CALL ASB$WRITE_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG)) ALTRET(NETCON_ERR
             20608                     );
      659    20609    4            HASPDEV$ = PINCRW(HASPDEV$, SIZEW(KL_HASPDEV));
      660    20610                                                              /**/
      661    20611    4            SELECT( TERM_DEV_VAL ) ;
      662    20612    4            CONSOLE_FLG = AS_FALSE ;
      663    20613    4            TWSN_INDEX = KL$TWSNREC.NDEV ;
      664    20614    4            KL$HASPDEV = KL_HASPDEV;
      665    20615    4            KL$HASPDEV.BLKHDR.LEV = 2;
      666    20616    4            KL$HASPDEV.BLKHDR.BLKTYP = %KLTY_SDEV#;
      667    20617    4            LNG_CNT = LENGTHC( KL_HASPDEV );
      668    20618    4            KL$UBWORD.REPLACE.T = LNGTH.T;
      669    20619    4            KL$UBWORD.REPLACE.B = LNGTH.B;
      670    20620    4            KL$HASPDEV.BLKHDR.LEN.BYT(0) = KL$UBWORD.REPLACE.T;
      671    20621    4            KL$HASPDEV.BLKHDR.LEN.BYT(1) = KL$UBWORD.REPLACE.B;
      672    20622    4            KL$HASPDEV.BLKHDR.DEVNUM = KL$TREC.HASP.BLKHDR.NSUBS+1;
      673    20623    4            KL$HASPDEV.TERMID.TERM.TERM_NAME = TERM_KEY.TXT.ACCT;
      674    20624    4            KL$HASPDEV.TERMID.LEV = 2;
      675    20625    4            LNG_CNT = KL$HASPDEV.BLKHDR.DEVNUM;
      676    20626    4            KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT(0) = LNGTH.T;
      677    20627    4            KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT(1) = LNGTH.B;
      678    20628    4            DADR$ = ADDR (KL$HASPDEV.DADR);
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:23   
      679    20629    4            CALL ASA$DEV_OPTS(DREC$,TWSNR$,TWSNC,'1'B,'1'B,TERM_T,TWSN_INDEX,KL_SS,
             20629                     DADR$)
      680    20630    5            WHENRETURN DO;
      681    20631    6               IF KL_SS.SGN.TYPE ~='CG' THEN DO ;
      682    20632    6                  DREC$->KL$TREC.RENAME=' ';
      683    20633    6                  DREC$->KL$TREC.FLAGS.RNME='0'B;
      684    20634    6                  END;    /* Do  */
      685    20635    5               KL$TREC.HASP.BLKHDR.NSUBS = KL$TREC.HASP.BLKHDR.NSUBS+1;
      686    20636    5               KL$TREC.HASP.BLKHDR.USE = DREC$->KL$TREC.SUPER;
      687    20637    5               DREC$->KL$TREC.TNAME=TERM_KEY.TXT.ACCT ;
      688    20638    5               DREC$->KL$TREC.SNAME=SNAME ;
      689    20639    5               ARS = (DREC$->KL$TREC.NWINFO * 4) + LENGTHC(KL_DREC_CNT) ;
      690    20640    5               USERS_KEY.COUNT = 8 ;
      691    20641    5               USERS_KEY.TXTC = FROM_KEY.TEXT ;
      692    20642    5               CALL ASB$WRITE_HLP(DREC$,ARS) ALTRET(WRITE_TREC_ERR) ;
      693    20643    5               KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = TERM_KEY.TXT.ACCT ;
      694    20644    5               KL$TWSNREC.NDEV = TWSN_INDEX + 1 ;
      695    20645    5               TWSN_ARS = TWSN_ARS + LENGTHC(KL$TWSNREC.DEVS(0));
      696    20646    5               CALL ASB$WRITE_LO( AS_CREATED_TEXT, LENGTHC(AS_CREATED_TEXT));
      697    20647    5               CONFIG_KEY.TERMID = KL$HASPDEV.TERMID;
      698    20648    5               LINCNFG_BUF = '0'B;
      699    20649    5               LINCNFG.KHA = KL_HNDCMN;
      700    20650    5               LINCNFG.NA = KL_NA;
      701    20651    5               LINCNFG.NA.SNDSLT = '0'B;
      702    20652    5               LINCNFG.NA.AUTLGN = '1'B;
      703    20653    5               LINCNFG.LGN.LGNSIZE = KL_SS.CNT;
      704    20654    5               LINCNFG.LGN.LGNSTRING = KL_SS.SGN_R;
      705    20655    5               CALL ASB$WRITE_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG)) ALTRET(
             20655                        NETCON_ERR);
      706    20656    5               HASPDEV$ = PINCRW(HASPDEV$, SIZEW(KL_HASPDEV));
      707    20657    5               END;
      708    20658    4            SELECT( TERM_M_DC_VAL ) ;
      709    20659    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      710    20660                                      /* Make sure the device name is valid */
      711    20661    4            CALL ASB$VALID_TDEVICE( OUT$SYM ) ALTRET( TERM_LOOP );
      712    20662                                                              /* Set up type and num */
      713    20663    4            CDNN = OUT$SYM.TEXT;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:24   
      714    20664    4            TYPE = CDNN_R.TYPE;
      715    20665    4            NUM  = CDNN_R.NUM ;
      716    20666    5            IF KL$TREC.HASP.BLKHDR.NSUBS = 0 THEN DO;
      717    20667    5               AS_FIELD1.COUNT = OUT$SYM.COUNT ;
      718    20668    5               AS_FIELD1.TEXT = OUT$SYM.TEXT ;
      719    20669                    %SCREAM( ERR#=E$M_DEV_CON_NOT_DEFINED, LEVEL=ERROR, MID='A') ;
      720    20684                             /*E*  ERROR:    ASA-E$M_DEV_CON_NOT_DEFINED-C
      721    20685                                   MESSAGE0: %%U1 %is not defined. */
      722    20686    5               END; /* If nsubs = 0 */
      723    20687    5            ELSE DO;
      724    20688    6               DO J = 0 TO KL$TREC.HASP.BLKHDR.NSUBS-1;
      725    20689    6                  M_CONDEV$ = PINCRW(ADDR(KL$TREC.HASP), SIZEW(KL$TREC.HASP)+(J*SIZEW(
             20689                           KL_HASPDEV)));
      726    20690    6                  CONFIG_KEY.TERMID = M_CONDEV$->KL$HASPDEV.TERMID;
      727    20691    6                  CALL ASB$READ_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG_BUF)) ALTRET(
             20691                           NETCON_ERR);
      728    20692    6                  KL_SS.CNT = LINCNFG.LGN.LGNSIZE;
      729    20693    6                  KL_SS.SGN_R = LINCNFG.LGN.LGNSTRING;
      730    20694    6                  IF KL_SS.SGN.TYPE = TYPE AND
      731    20695    7                       KL_SS.SGN.NUM = NUM THEN DO;
      732    20696    7                     M_CONDEV = AS_TRUE;
      733    20697    7                     USERS_KEY.COUNT = 8 ;
      734    20698    7                     CALL CONCAT( USERS_KEY.TXTC, TYPE, NUM, TWSNC ) ;
      735    20699    7                     K = SIZEC(DEV_REC);
      736    20700    8                     CALL ASB$READ_HLP(DREC$,K) WHENALTRETURN DO;
      737    20701    8                        CALL ASA$ERROR(USERS_KEY,E$UNABLE_TO_READ_HLP);
      738    20702    8                        GOTO TERM_LOOP;
      739    20703    8                        END; /* Do never */
      740    20704    7                     CALL ASB$FIND_TWSN_INDEX(TREC$,DREC$,TWSNR$,AS_TRUE,CDNN,
             20704                              TWSN_INDEX ) ALTRET( SKIP ) ;
      741    20705    7                     IF DREC$->KL$TREC.SUPER = AS_UNDEF#
      742    20706    7                     THEN CALL ASB$CHECK_TYPE(DREC$,K);
      743    20707    7                     DADR$ = ADDR (M_CONDEV$->KL$HASPDEV.DADR);
      744    20708    8                     IF DREC$->KL$TREC.SUPER = AS_CON# THEN DO;
      745    20709    8                        CALL ASA$CON_OPTS(DREC$,TWSNR$,TWSNC,'0'B,'1'B,TERM_T,LOCAL,
             20709                                 TWSN_INDEX,KL_SS,DADR$);
      746    20710    8                        DREC$->KL$TREC.FLAGS.RNME='0'B;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:25   
      747    20711    8                        END; /* If */
      748    20712    8                     ELSE DO;
      749    20713    8                        CALL ASA$DEV_OPTS(DREC$,TWSNR$,TWSNC,'0'B,'1'B,TERM_T,
             20713                                 TWSN_INDEX,KL_SS,DADR$);
      750    20714    9                        IF TYPE ~= 'CG' THEN DO;
      751    20715    9                           DREC$->KL$TREC.RENAME = ' ' ;
      752    20716    9                           DREC$->KL$TREC.FLAGS.RNME = '0'B;
      753    20717    9                           END; /* If */
      754    20718    8                        END;
      755    20719    7                     CALL CONCAT( USERS_KEY.TXTC, TYPE, NUM, TWSNC ) ;
      756    20720    7                     USERS_KEY.COUNT = 8 ;
      757    20721    7                     ARS = DREC$->KL$TREC.NWINFO*4 + LENGTHC(KL_DREC_CNT) ;
      758    20722    7                     CALL ASB$WRITE_HLP( DREC$, ARS ) ALTRET( WRITE_TREC_ERR);
      759    20723    7                     KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = TERM_KEY.TXT.ACCT ;
      760    20724    7                     LINCNFG.LGN.LGNSIZE = KL_SS.CNT;
      761    20725    7                     LINCNFG.LGN.LGNSTRING = KL_SS.SGN_R;
      762    20726    7                     CALL ASB$WRITE_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG)) ALTRET(
             20726                              NETCON_ERR);
      763    20727    7                     END;  /* Else */
      764    20728    6                  END;  /* Do j */
      765    20729    5               END;  /* Else */
      766    20730    4   SKIP:    M_CONDEV = AS_FALSE ;
      767    20731                                                              /**/
      768    20732    4            SELECT( GJOB_OPT_VAL ) ;
      769    20733    4            GJOB_FLG = '1'B;
      770    20734    4            GJOB = KL_TREC.GJOB;
      771    20735    4            GJOB_OK = '1'B;
      772    20736    4            J = 0;
      773    20737    5            DO WHILE( J < PTR$->P$NODE.SUBNODES  AND  GJOB_OK );
      774    20738    5               CODE = PTR$ -> P$NODE.SUBLK$(J) -> P$NODE.CODE;
      775    20739    6               DO SELECT( CODE );
      776    20740    6                  SELECT( GJNAME_VAL );
      777    20741    6                  BLK$ = PTR$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0);
      778    20742    7                  IF OUT$SYM.COUNT > 12 THEN DO;
      779    20743        /*E*  ERROR:    ASA-E$GJNAMETOOBIG-C
      780    20744              MESSAGE0: GJOB name too big.
      781    20745              MESSAGE1: GJOB name can be at most 12 characters.
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:26   
      782    20746        */
      783    20747                          %SCREAM( ERR#=E$GJNAMETOOBIG, LEVEL=ERROR, MID='A') ;
      784    20762    7                     GJOB_OK = '0'B;
      785    20763    7                     END ; /* Then do */
      786    20764    6                  ELSE
      787    20765    6                     GJOB.UNAME = OUT$SYM.TEXT ;
      788    20766    6                  SELECT( GJACCT_VAL ) ;
      789    20767    6                  BLK$ = PTR$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0);
      790    20768    7                  IF OUT$SYM.COUNT > 8 THEN DO;
      791    20769        /*E*  ERROR:    ASA-E$GJACCTTOOBIG-C
      792    20770              MESSAGE0: GJOB account too big.
      793    20771              MESSAGE1: GJOB account can be at most 8 characters long.
      794    20772        */
      795    20773                          %SCREAM( ERR#=E$GJACCTTOOBIG, LEVEL=ERROR, MID='A') ;
      796    20788    7                     GJOB_OK = '0'B;
      797    20789    7                     END ; /* Then do */
      798    20790    6                  ELSE
      799    20791    6                     GJOB.ACCT = OUT$SYM.TEXT ;
      800    20792    6                  SELECT( GJPASSW_VAL ) ;
      801    20793    6                  BLK$ = PTR$ -> P$NODE.SUBLK$(J);
      802    20794    7                  IF OUT$SYM.COUNT > 8 THEN DO;
      803    20795        /*E*  ERROR:    ASA-E$GJPASSTOOBIG-C
      804    20796              MESSAGE0: GJOB password too big.
      805    20797              MESSAGE1: GJOB password can be at most 8 characters long.
      806    20798        */
      807    20799                          %SCREAM( ERR#=E$GJPASSTOOBIG, LEVEL=ERROR, MID='A') ;
      808    20814    7                     GJOB_OK = '0'B;
      809    20815    7                     END ; /* Then do */
      810    20816    6                  ELSE
      811    20817    6                     GJOB.PASS = OUT$SYM.TEXT ;
      812    20818    6                  SELECT( GJCMD_VAL ) ;
      813    20819    6                  BLK$ = PTR$ -> P$NODE.SUBLK$(J);
      814    20820    7                  IF OUT$SYM.COUNT > 80 THEN DO;
      815    20821        /*E*  ERROR:    ASA-E$GJCMDTOOBIG-C
      816    20822              MESSAGE0: GJOB CMD too big.
      817    20823              MESSAGE1: GJOB CMD can be at most 80 characters long.
      818    20824        */
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:27   
      819    20825                          %SCREAM( ERR#=E$GJCMDTOOBIG, LEVEL=ERROR, MID='A') ;
      820    20840    7                     GJOB_OK = '0'B;
      821    20841    7                     END ; /* Then do */
      822    20842    7                  ELSE DO;
      823    20843    7                     GJOB.CMDCNT = OUT$SYM.COUNT;
      824    20844    7                     GJOB.CMD    = OUT$SYM.TEXT ;
      825    20845    7                     END;
      826    20846    6                  SELECT( GJNONE_VAL );
      827    20847    6                  GJOB_FLG = '0'B;
      828    20848    6                  END;    /* End do case */
      829    20849    5               J = J + 1;
      830    20850    5               END;      /* End do while */
      831    20851    5            IF GJOB_OK THEN DO;
      832    20852    5               KL$TREC.FLAGS.GJOB = GJOB_FLG;
      833    20853    5               CALL ASZ$SCRAMBLE( GJOB.PASS );
      834    20854    5               KL$TREC.GJOB = GJOB;
      835    20855    5               END;
      836    20856                                                              /**/
      837    20857    4            SELECT( %TERM_RLS_VAL ) ;
      838    20858    4            CODE2 = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;
      839    20859
      840    20860    5            DO SELECT (CODE2);
      841    20861
      842    20862    5               SELECT (NONE_VAL);
      843    20863
      844    20864    5               KL$TREC.HASP.RLS# = AS_BLANK ;
      845    20865
      846    20866    5               SELECT ( ASYM_VAL );
      847    20867
      848    20868    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0);
      849    20869    6               IF OUT$SYM.COUNT > 80 THEN DO;
      850    20870        /*E*  ERROR:    ASA-E$RLSTOOLONG-C
      851    20871              MESSAGE0: String too long.
      852    20872              MESSAGE1: REMOTE LOGON STRING can be at most 80 characters long.
      853    20873        */
      854    20874                       %SCREAM( ERR#=E$RLSTOOLONG, LEVEL=ERROR, MID='A');
      855    20889    6                  END ; /* Then do */
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:28   
      856    20890    5               ELSE
      857    20891    5                  KL$TREC.HASP.RLS# = OUT$SYM.TEXT ;
      858    20892    5               END;  /*  Do case CODE2  */
      859    20893
      860    20894    4            SELECT( %TERM_SLAVE_VAL );
      861    20895
      862    20896    4            IF PTR$->P$NODE.SUBNODES = 0 THEN
      863    20897    4               KL$TREC.HASP.SLAVE# = %YES#;
      864    20898    5            ELSE DO;
      865    20899    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0);
      866    20900    5               IF BLK$ -> P$NODE.CODE = YES_VAL THEN
      867    20901    5                  KL$TREC.HASP.SLAVE# = %YES#;
      868    20902    5               ELSE
      869    20903    5                  KL$TREC.HASP.SLAVE# = %NO#;
      870    20904    5               END;
      871    20905                                                              /**/
      872    20906    4            SELECT( EOL_VAL ) ;
      873    20907                                                              /**/
      874    20908    4            SELECT( HELP_VAL ) ;
      875    20909    4            CALL ASH$HELP ;
      876    20910                                                              /**/
      877    20911    4            SELECT( QUESTION_VAL ) ;
      878    20912    4            CALL ASH$QUEST ;
      879    20913                                                              /**/
      880    20914    4            SELECT( DQUESTION_VAL ) ;
      881    20915    4            CALL ASH$DQUEST ;
      882    20916                                                              /**/
      883    20917    4            SELECT( END_VAL ,
      884    20918    4                 BLANK_LINE_VAL ) ;
      885    20919    4            IF KL$TREC.HASP.BLKHDR.NSUBS > 0
      886    20920    4            THEN
      887    20921    4               MORE = AS_FALSE ;
      888    20922    4            ELSE
      889    20923    5            DO ;
      890    20924        /*E*  ERROR:    ASA-E$NO_CON_DEV_DEFINED-C
      891    20925              MESSAGE:  No CON/DEV defined, TERMINAL is not being created.
      892    20926              MESSAGE1: There must be at least one DEVICE or CONSOLE defined
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:29   
      893    20927                        in order to create a TERMINAL.
      894    20928        */
      895    20929                    %SCREAM( ERR#=E$NO_CON_DEV_DEFINED, LEVEL=WARN, MID='A') ;
      896    20944    5               RETURN;
      897    20945    5               END;     /* Else do */
      898    20946    4            END ; /* Do case( code ) */
      899    20947    3         END ; /* Do i */
      900    20948    2      END ; /* Do while */
      901    20949    1   DONE_OPTIONS: ;
      902    20950                                                              /* Output term rec */
      903    20951    1   KL$TREC.NWINFO = SIZEW(KL$TREC.GJOB) + SIZEW(KL$TREC.HASP) + (KL$TREC.HASP.BLKHDR.
             20951            NSUBS*SIZEW(KL_HASPDEV));
      904    20952    1   ARS = LENGTHC(KL_DREC_CNT) + ( KL$TREC.NWINFO * 4 ) ;
      905    20953    1   USERS_KEY = TERM_KEY ;
      906    20954    1   CALL ASB$WRITE_HLP( TREC$, ARS ) ALTRET ( WRITE_TREC_ERR ) ;
      907    20955                                                              /* Twsn record */
      908    20956    1   IF CREATE
      909    20957    1   THEN
      910    20958    2   DO ;
      911    20959    2      KL_TERM_KEY.TERMID.TERM.TERM_NAME = TERM_KEY.TXT.ACCT ;
      912    20960    2      KL_TERM_REC = '0'B;
      913    20961    2      CALL ASB$WRITE_NETCON(VECTOR(KL_TERM_KEY),VECTOR(KL_TERM_REC)) ALTRET(NETCON_ERR)
             20961               ;
      914    20962    2      CALL ASB$CLOSE_NETCON;
      915    20963    2      END ; /*Then do */
      916    20964                                                              /* Twsnxxxx record */
      917    20965    1   USERS_KEY.COUNT = 8 ;
      918    20966    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;
      919    20967    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;
      920    20968    1   CALL ASB$WRITE_HLP( TWSNR$, TWSN_ARS ) ALTRET( WRITE_TREC_ERR ) ;
      921    20969    1   CALL ASB$DEQ_HLP ALTRET( DEQ_ERR ) ;
      922    20970    1   ENQDEQ_FLG = AS_FALSE ;
      923    20971    1   RETURN ;
      924    20972                                                              /* Errors */
      925    20973    1   READ_CHAIN_ERR: ;
      926    20974                                                              /**/
      927    20975                                                              /**/
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:30   
      928    20976    1   WRITE_TREC_ERR: ;
      929    20977    1   CALL ASH$ERROR( ERR_CODE ) ;
      930    20978    1   RETURN ;
      931    20979                                                              /**/
      932    20980    1   TERM_OPT_ERR: ;
      933    20981    1   CALL ASH$ERROR( P_PCB.ERROR ) ;
      934    20982    1   GOTO TERM_LOOP ;
      935    20983                                                              /**/
      936    20984    1   TERM_PRO_ERR:
      937    20985        /*E* ERROR: ASA-E$PRO_NO_EXIST-C
      938    20986             MESSAGE: Profile %%U1 %does not exist.
      939    20987             MESSAGE1: The profile %%U1 %must exist in :PRO before
      940    20988                       you can use it.
      941    20989        */
      942    20990    1   AS_FIELD1 = USERS_KEY ;
      943    20991        %SCREAM( ERR#=E$PRO_NO_EXIST, LEVEL=ERROR, MID='A' ) ;
      944    21006    1   GOTO TERM_LOOP;
      945    21007                                                              /**/
      946    21008    1   NETCON_ERR:;
      947    21009    1   ERR_CODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      948    21010    1   CALL ASH$ERROR(ERR_CODE);
      949    21011    1   RETURN;
      950    21012                                                              /**/
      951    21013                                                              /**/
      952    21014    1   ENQ_ERR: ;
      953    21015                                                              /**/
      954    21016    1   DEQ_ERR: ;
      955    21017    1   END   ASA$TERMINAL ;
      956    21018        %EOD;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:31   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$TERMINAL.

   Procedure ASA$TERMINAL requires 1892 words for executable code.
   Procedure ASA$TERMINAL requires 626 words of local(AUTO) storage.

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:32   

 Object Unit name= ASA$TERMINAL                               File name= ASA$TERMINAL.:E05TOU
 UTS= JUL 29 '97 08:46:31.88 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    84    124  ASA$TERMINAL
    3  RoData even  UTS    128    200  ASA$TERMINAL
    4   Proc  even  none  1892   3544  ASA$TERMINAL
    5  RoData even  none    64    100  ASA$TERMINAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  ASA$TERMINAL
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:33   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       1 ASB$VALID_TDEVICE
 yes     yes           Std       6 ASB$FIND_TWSN_INDEX
 yes     yes           Std       2 ASB$WRITE_HLP
 yes     yes           Std       1 X$PARSE
         yes           Std       2 ASH$ERROR
 yes     yes           Std       0 ASB$ENQ_HLP
 yes     yes           Std       3 ASB$READ_HLP
 yes     yes           Std       3 ASD$READ_PRO
         yes           Std      10 ASA$CON_OPTS
 yes     yes           Std       3 ASB$WRITE_NETCON
         yes           Std       0 ASH$HELP
 yes     yes           Std       3 ASB$READ_NETCON
         yes           Std       0 ASH$QUEST
         yes           Std       3 ASA$ERROR
 yes     yes           Std       0 ASB$GETSEG
 yes     yes           Std       0 ASB$DEQ_HLP
         yes           Std       2 ASH$WARN
         yes           Std       1 ASZ$SCRAMBLE
 yes     yes           Std       3 ASB$SET_PROMPT
 yes     yes           Std       9 ASA$DEV_OPTS
         yes           Std       0 ASH$DQUEST
 yes     yes           Std       5 ASB$CHECK_TYPE
 yes     yes           Std       0 ASB$CLOSE_NETCON
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_INDEX
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:34   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_TRUE
r    AS_FALSE                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             AS_CREATED_TEXT
     FROM_KEY                              IN_BUF                                NODE$
     CODE                                  ERR_CODE                              AS_FIELD1
     AS_FIELD2                             AS_FIELD3                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG_FLG
     DSEG1$                                DSEG1SIZE                             DSEG2$
     DSEG2SIZE                             DSEG3$                                DSEG3SIZE
     ENQDEQ_FLG                            P_PCB                                 KL_DREC_CNT
     B$TCB$                                TYPE                                  TERMINAL_CMD
     TERM_OPT_LIST                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:35   


        1        1        /*M* ASA$TERMINAL - Processes the TERMINAL line profile. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASA$TERMINAL: PROC ;

     10  4 000000   000000 700200 xent  ASA$TERMINAL TSX0  ! X66_AUTO_0
         4 000001   001162 000000                    ZERO    626,0

       11       11        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:36   
       12       12        /*********************************************************************/
       13       13        /*   Include files   include files   include files   include files   */
       14       14        /*********************************************************************/
       15       15                                                              /**/
       16       16              %INCLUDE  KL_SUPER_C   ;
       17     2918              %INCLUDE  AS_SUPER_C   ;
       18     3353              %INCLUDE  AS_MAC_C     ;
       19     3433              %INCLUDE  XU_FORMAT_C  ;
       20     3595              %INCLUDE  XU_MACRO_C   ;
       21     6701              %INCLUDE  AS_SUBS_C    ;
       22     8115              %INCLUDE  AS_SSUBS_C   ;
       23     8207              %INCLUDE  AS_PERR_C    ;
       24     8809              %INCLUDE  CP_6         ;
       25     8890              %INCLUDE  KL_CONFIG_M  ;
       26     9652              %INCLUDE  KL_MACRO_C   ;
       27    13004              %INCLUDE  KC$CGBLK     ;
       28    13052              %INCLUDE  AS_SUPER_R   ;
       29    16068              %INCLUDE  AS_ENTRIES_M ;
       30    17118              %INCLUDE  CP_6_SUBS    ;
       31    17658        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:37   
       32    17659        /********************************************************************/
       33    17660        /*   Auto data       auto data       auto data       auto data       */
       34    17661        /*********************************************************************/
       35    17662                                                              /**/
       36    17663    1   DCL ARS                           UBIN WORD ;
       37    17664    1   DCL BEGIN$                        PTR ;
       38    17665    1   DCL BLK$                          PTR ;
       39    17666    1   DCL CDNN                          CHAR(8) ;
       40    17667    1   DCL 1 CDNN_R REDEF CDNN,
       41    17668    1          2 TYPE                     CHAR(2),
       42    17669    1          2 NUM                      CHAR(2),
       43    17670    1          2 *                        CHAR(4);
       44    17671    1   DCL CNT                           UBIN WORD ;
       45    17672    1   DCL CODE2                         UBIN WORD ;
       46    17673    1   DCL CONSOLE_FLG                   BIT(1) ;
       47    17674    1   DCL CREATE                        BIT(1) ;
       48    17675    1   DCL DADR$                         PTR;
       49    17676    1   DCL DEVS                          UBIN WORD ;
       50    17677    1   DCL DEV_BUF2                      CHAR(100);
       51    17678    1   DCL DEV_REC                       CHAR(1000) ;
       52    17679    1   DCL DREC2$                        PTR;
       53    17680    1   DCL DREC$                         PTR;
       54    17681        %KL_GJOB  ( NAME     = GJOB,
       55    17682                    STCLASS  = AUTO,
       56    17683                    LVL      = 1,
       57    17684                    LAST     = ";" );
       58    17708    1   DCL GJOB_FLG                      BIT(1);
       59    17709    1   DCL GJOB_OK                       BIT(1);
       60    17710    1   DCL HASPDEV$                      PTR ;
       61    17711    1   DCL I                             SBIN WORD ;
       62    17712    1   DCL J                             SBIN WORD ;
       63    17713    1   DCL K                             SBIN WORD ;
       64    17714    1   DCL L                             SBIN WORD ;
       65    17715    1   DCL LOCAL                         BIT(1) ;
       66    17716    1   DCL MORE                          BIT(1) ;
       67    17717    1   DCL M_CONDEV                      BIT(1) ;
       68    17718    1   DCL M_CONDEV$                     PTR;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:38   
       69    17719    1   DCL 1 NAME,
       70    17720    1          2 COUNT                    UBIN BYTE UNAL,
       71    17721    1          2 TEXT                     CHAR(8) UNAL;
       72    17722    1   DCL NUM                           CHAR(2) ;
       73    17723    1   DCL PP$                           PTR ;
       74    17724    1   DCL PP_SIZE                       UBIN WORD ;
       75    17725    1   DCL PP_END$                       PTR;
       76    17726    1   DCL PP_TYPE                       UBIN;
       77    17727    1   DCL PRO$                          PTR ;
       78    17728    1   DCL PRO_BUF                       CHAR(AS_PRO_BUF_SIZEC);
       79    17729    1   DCL PTR$                          PTR ;
       80    17730    1   DCL P$                            PTR ;
       81    17731    1   DCL SAME_FLG                      BIT(1) ;
       82    17732    1   DCL SNAME                         CHAR(8) ;
       83    17733    1   DCL SREC$                         PTR ;
       84    17734    1   DCL SUBNDS                        UBIN WORD ;
       85    17735    1   DCL SUBS                          UBIN WORD ;
       86    17736    1   DCL S_HASPDEV$                    PTR ;
       87    17737    1   DCL S_TWSNC                       CHAR(4) ;
       88    17738    1   DCL TEMP                          UBIN WORD;
       89    17739    1   DCL TEMP$                         PTR;
       90    17740    1   DCL TERM_T                        CHAR(7);
       91    17741    1   DCL TREC$                         PTR ;
       92    17742    1   DCL TWSNC                         CHAR(4) ;
       93    17743    1   DCL TWSNR$                        PTR ;
       94    17744    1   DCL TWSN#                         UBIN WORD ;
       95    17745    1   DCL TWSN_ARS                      UBIN WORD ;
       96    17746    1   DCL TWSN_INDEX                    UBIN ;
       97    17747        %KL$UBWORD    ( NAME     = KL$UBWORD,
       98    17748                        STCLASS  = AUTO);
       99    17758        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:39   
      100    17759        /********************************************************************/
      101    17760        /*   Symref's        symref's        symref's        symref's        */
      102    17761        /*********************************************************************/
      103    17762                                                              /**/
      104    17763    1   DCL B$TCB$               PTR       SYMREF ;
      105    17764    1   DCL TYPE                 CHAR(2)   SYMREF ;
      106    17765    1   DCL TCD_OPT_LIST         UBIN WORD SYMREF ;
      107    17766    1   DCL TERMINAL_CMD         UBIN(36)  SYMREF ;
      108    17767    1   DCL TERM_OPT_LIST        UBIN WORD SYMREF ;
      109    17768        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:40   
      110    17769        /********************************************************************/
      111    17770        /*   Static data     static data     static data     static data     */
      112    17771        /*********************************************************************/
      113    17772                                                              /**/
      114    17773        %KL$CONFIG_KEY  ( NAME    = CONFIG_KEY,
      115    17774                          STCLASS = STATIC);
      116    17821        %KL_HNDCMN_INFO ( FPTN    = KL_HNDCMN,
      117    17822                          STCLASS = STATIC);
      118    17902        %KL_NA_INFO     ( FPTN    = KL_NA,
      119    17903                          STCLASS = STATIC);
      120    17952        %KL_SS;
      121    17987        %KL$TERM        ( NAME    = KL_TERM_REC,
      122    17988                          STCLASS = STATIC);
      123    18037        %KL$TERM_KEY    ( NAME    = KL_TERM_KEY,
      124    18038                          STCLASS = STATIC);
      125    18084    1   DCL LINCNFG$                PTR STATIC INIT(ADDR(LINCNFG_BUF));
      126    18085    1   DCL LINCNFG_BUF   (0:49)    UBIN WORD STATIC INIT(0*0);
      127    18086    1   DCL 1 LNGTH ALIGNED STATIC,
      128    18087    1          2 T                  UBIN(28) UNAL INIT(0),
      129    18088    1          2 B                  UBIN(8) UNAL INIT(0);
      130    18089    1   DCL LNG_CNT REDEF LNGTH UBIN;
      131    18090    1   DCL 1 TERM_KEY ALIGNED STATIC ,
      132    18091    1          2 CNT                UBIN BYTE UNAL INIT( 9 ),
      133    18092    1          2 TXT UNAL ,
      134    18093    1             3 ACCT            CHAR(8) UNAL INIT(' ') ,
      135    18094    1             3 ASTR            CHAR(1) UNAL INIT('*') ;
      136    18095        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:41   
      137    18096        /********************************************************************/
      138    18097        /*   Constant data        constant data        constant data        */
      139    18098        /*********************************************************************/
      140    18099        %KL_HASPDEV ( NAME    = KL_HASPDEV ,
      141    18100                      STCLASS = CONSTANT ) ;
      142    18334        %KL_DREC ( NAME    = KL_TREC ,
      143    18335                   STCLASS = CONSTANT ,
      144    18336                   TYP     = %KLAT_TRM# ,
      145    18337                   RNAME   = ' ' ,
      146    18338                   PASS    = ' ' ,
      147    18339                   PRO     = ' ' ,
      148    18340                   WORG    = ' ' ,
      149    18341                   LAST    = "," ) ;
      150    18454        %KL_GJOB ( NAME    = GJOB,
      151    18455                   STCLASS = CONSTANT,
      152    18456                   LAST    = ",",
      153    18457                   LVL     = 2 );
      154    18481        %KL_HASP ( NAME    = HASP,
      155    18482                   STCLASS = STATIC,
      156    18483                   LVL     = 2 );
      157    18633    1   DCL TERM_TYPE_A(0:2) CHAR(11) CONSTANT INIT( 'STDHASP', 'STD2780', 'STD3780' ) ;
      158    18634    1   DCL TERM_TYPES  REDEF TERM_TYPE_A CHAR(33) ;
      159    18635        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:42   
      160    18636        /*********************************************************************/
      161    18637        /*   Local based     local based     local based     local based     */
      162    18638        /*********************************************************************/
      163    18639        %B$TCB;
      164    18642        %B$ALT;
      165    18650                                                              /**/
      166    18651    1   DCL ACHAR                  CHAR(1) BASED;
      167    18652        %KL_DREC      ( NAME     = KL$SREC,
      168    18653                        LAST     = ";",
      169    18654                        STCLASS  = "BASED( SREC$ )" );
      170    18767        %KL_DREC      ( NAME     = KL$DREC ,
      171    18768                        STCLASS  = BASED ,
      172    18769                        LAST     = "," );
      173    18882           %KC$CGID   ( FPTN     = KC$CGID,
      174    18883                        STCLASS  = STCLASS,
      175    18884                        LVL      = 2,
      176    18885                        LAST     = ";" );
      177    18911        %KL_DREC      ( NAME     = KL$TREC ,
      178    18912                        STCLASS  = "BASED( TREC$ )",
      179    18913                        LAST     = "," );
      180    19026           %KL_GJOB   ( NAME     = GJOB,
      181    19027                        STCLASS  = BASED,
      182    19028                        LVL      = 2,
      183    19029                        LAST     = "," );
      184    19053           %KL_HASP   ( NAME     = HASP,
      185    19054                        STCLASS  = BASED,
      186    19055                        LVL      = 2);
      187    19205        %KL_HASPDEV   ( NAME     = KL$HASPDEV,
      188    19206                        STCLASS  = "BASED( HASPDEV$ )");
      189    19440        %KL$LINCNFG   ( NAME     = LINCNFG,
      190    19441                        STCLASS  = "BASED(LINCNFG$)");
      191    19599        %KL_PHDR      ( NAME     = KL$PHDR ,
      192    19600                        STCLASS  = "BASED( PRO$ )") ;
      193    19641    1   DCL 1 PP$STRCT BASED( PP$ ) UNAL ,
      194    19642    1          2 TYPE                     UBIN BYTE UNAL ,
      195    19643    1          2 SIZE                     UBIN BYTE UNAL ;
      196    19644        %KL_TRMD      ( NAME     = KL$TRMD ,
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:43   
      197    19645                        STCLASS  = "BASED UNAL") ;
      198    19807        %KL_TWSNREC   ( NAME     = KL$TWSNREC ,
      199    19808                        STCLASS  = "BASED( TWSNR$ )") ;
      200    19833        %PARSE$OUT    ( NAME = P$NODE, STCLASS = "BASED (NODE$)",
      201    19834                        NDTYPE = TYPE, NSUBLKS = SUBNODES) ;
      202    19879        %PARSE$SYM    ( NAME = OUT$SYM ,
      203    19880                        STCLASS = "BASED(BLK$)") ;
      204    19918        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:44   
      205    19919        /********************************************************************/
      206    19920        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      207    19921        /*********************************************************************/
      208    19922                                                              /**/
      209    19923        %ASA$CON_OPTS ;
      210    19926        %ASA$DEV_OPTS ;
      211    19929        %ASA$ERROR ;
      212    19932        %ASB$CHECK_TYPE ;
      213    19935        %ASB$CLOSE_NETCON ;
      214    19938        %ASB$DELREC_HLP ;
      215    19941        %ASB$DEQ_HLP ;
      216    19944        %ASB$ENQ_HLP ;
      217    19947        %ASB$FIND_NUM ;
      218    19950        %ASB$FIND_TWSN_INDEX ;
      219    19953        %ASB$GETSEG ;
      220    19956        %ASB$READ_HLP ;
      221    19959        %ASB$READ_NETCON ;
      222    19962        %ASB$READ_SI ;
      223    19965        %ASB$SET_PROMPT ;
      224    19968        %ASB$VALID_TDEVICE ;
      225    19971        %ASB$WRITE_HLP ;
      226    19974        %ASB$WRITE_LO ;
      227    19977        %ASB$WRITE_NETCON ;
      228    19980        %ASD$READ_PRO ;
      229    19983        %ASH$DQUEST ;
      230    19986        %ASH$ERROR ;
      231    19989        %ASH$HELP ;
      232    19992        %ASH$INFO ;
      233    19995        %ASH$QUEST ;
      234    19998        %ASH$WARN ;
      235    20001        %ASZ$SCRAMBLE ;
      236    20004    1   DCL X$PARSE ENTRY(1) ALTRET ;
      237    20005        %EJECT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:45   
      238    20006        /********************************************************************/
      239    20007        /*   Procedure       procedure       procedure       procedure       */
      240    20008        /*********************************************************************/
      241    20009                                                              /**/
      242    20010        /*
      243    20011            ***            Begin procedure                    ***
      244    20012        */
      245    20013    1   DREC$=ADDR(DEV_REC);

  20013  4 000002   200047 630500                    EPPR0   DEV_REC,,AUTO
         4 000003   200442 450500                    STP0    DREC$,,AUTO

      246    20014    1   IF P$NODE.SUBLK$(0) -> P$NODE.CODE = CREATE_VAL

  20014  4 000004   000000 471400 xsym               LDP1    NODE$
         4 000005   100003 473500                    LDP3    3,,PR1
         4 000006   300000 720100                    LXL0    0,,PR3
         4 000007   000043 100003                    CMPX0   35,DU
         4 000010   000015 601000 4                  TNZ     s:20018

      247    20015    1   THEN
      248    20016    1      CREATE = AS_TRUE ;

  20016  4 000011   000000 236000 xsym               LDQ     AS_TRUE
         4 000012   400000 376003                    ANQ     -131072,DU
         4 000013   200013 756100                    STQ     CREATE,,AUTO
         4 000014   000020 710000 4                  TRA     s:20019

      249    20017    1   ELSE
      250    20018    1      CREATE = AS_FALSE ;

  20018  4 000015   000000 236000 xsym               LDQ     AS_FALSE
         4 000016   400000 376003                    ANQ     -131072,DU
         4 000017   200013 756100                    STQ     CREATE,,AUTO

      251    20019    1   P_PCB.ROOT$ = ADDR( TERMINAL_CMD ) ;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:46   
  20019  4 000020   000000 236000 5                  LDQ     0
         4 000021   000001 756000 xsym               STQ     P_PCB+1

      252    20020    1   CALL X$PARSE( P_PCB )

  20020  4 000022   000001 630400 5                  EPPR0   1
         4 000023   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000024   000000 701000 xent               TSX1    X$PARSE
         4 000025   000027 702000 4                  TSX2    s:20022
         4 000026   000034 710000 4                  TRA     s:20026

      253    20021    2   WHENALTRETURN DO;

      254    20022    2      CALL ASH$ERROR( P_PCB.ERROR ) ;

  20022  4 000027   000002 630400 5                  EPPR0   2
         4 000030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000031   000000 701000 xent               TSX1    ASH$ERROR
         4 000032   000000 011000                    NOP     0

      255    20023    2      RETURN ;

  20023  4 000033   000000 702200 xent               TSX2  ! X66_ARET

      256    20024    2      END; /*  Whenaltreturn  */
      257    20025                                                              /**/
      258    20026    1   NODE$ = P_PCB.OUT$ ;

  20026  4 000034   000003 236000 xsym               LDQ     P_PCB+3
         4 000035   000000 756000 xsym               STQ     NODE$

      259    20027    1   SUBS = P$NODE.SUBNODES ;

  20027  4 000036   000000 470400 xsym               LDP0    NODE$
         4 000037   000001 236100                    LDQ     1,,PR0
         4 000040   000022 772000                    QRL     18
         4 000041   201132 756100                    STQ     SUBS,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:47   

      260    20028                                                              /**/
      261    20029                                                              /*  Set up :HLP record.  */
      262    20030                                                              /*  Blank out password.   */
      263    20031                                                              /**/
      264    20032    1   USERS_KEY = '0'B ;

  20032  4 000042   000000 100400                    MLR     fill='000'O
         4 000043   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000044   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      265    20033    1   IF NOT DSEG_FLG

  20033  4 000045   000000 234000 xsym               SZN     DSEG_FLG
         4 000046   000060 604000 4                  TMI     s:20055

      266    20034    1   THEN
      267    20035    1      CALL ASB$GETSEG

  20035  4 000047   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000050   000000 701000 xent               TSX1    ASB$GETSEG
         4 000051   000053 702000 4                  TSX2    s:20049
         4 000052   000060 710000 4                  TRA     s:20055

      268    20036    2      WHENALTRETURN DO;

      269    20037              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A') ;

  20049  4 000053   000003 630400 5                  EPPR0   3
         4 000054   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000055   000000 701000 xent               TSX1    ASH$ERROR
         4 000056   000000 011000                    NOP     0

      270    20052    2         RETURN ;

  20052  4 000057   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:48   
      271    20053    2         END;  /*  Whenaltreturn  from ASB$GETSEG  */
      272    20054                                                              /**/
      273    20055    1   TREC$ = DSEG1$ ;

  20055  4 000060   000000 236000 xsym               LDQ     DSEG1$
         4 000061   201141 756100                    STQ     TREC$,,AUTO

      274    20056    1   TWSNR$ = DSEG2$ ;

  20056  4 000062   000000 236000 xsym               LDQ     DSEG2$
         4 000063   201143 756100                    STQ     TWSNR$,,AUTO

      275    20057    1   SREC$ = DSEG3$ ;

  20057  4 000064   000000 236000 xsym               LDQ     DSEG3$
         4 000065   201130 756100                    STQ     SREC$,,AUTO

      276    20058                                                         /* Check exist. of c/m terminal */
      277    20059    1   BLK$ = NODE$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;

  20059  4 000066   000000 470400 xsym               LDP0    NODE$
         4 000067   000003 471500                    LDP1    3,,PR0
         4 000070   100003 236100                    LDQ     3,,PR1
         4 000071   200005 756100                    STQ     BLK$,,AUTO

      278    20060    2   IF OUT$SYM.COUNT > 8 THEN DO;

  20060  4 000072   200005 473500                    LDP3    BLK$,,AUTO
         4 000073   300004 236100                    LDQ     4,,PR3
         4 000074   777000 376003                    ANQ     -512,DU
         4 000075   011000 116003                    CMPQ    4608,DU
         4 000076   000104 602000 4                  TNC     s:20082

      279    20061        /*E*  ERROR:    ASA-E$TNAMETOOBIG-C
      280    20062              MESSAGE:  Terminal name too long.
      281    20063              MESSAGE1: Terminal names can be at most 8 characters.
      282    20064        */
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:49   
      283    20065           %SCREAM( ERR#=E$TNAMETOOBIG, LEVEL=ERROR, MID='A' );

  20077  4 000077   000004 630400 5                  EPPR0   4
         4 000100   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000101   000000 701000 xent               TSX1    ASH$ERROR
         4 000102   000000 011000                    NOP     0

      284    20080    2      RETURN ;

  20080  4 000103   000000 702200 xent               TSX2  ! X66_ARET

      285    20081    2      END ;    /* Then do */
      286    20082    1   NAME.COUNT = OUT$SYM.COUNT;

  20082  4 000104   300004 236100                    LDQ     4,,PR3
         4 000105   200512 552140                    STBQ    NAME,'40'O,AUTO

      287    20083    1   NAME.TEXT  = OUT$SYM.TEXT;

  20083  4 000106   300004 236100                    LDQ     4,,PR3
         4 000107   000033 772000                    QRL     27
         4 000110   000000 620006                    EAX0    0,QL
         4 000111   040100 100540                    MLR     fill='040'O
         4 000112   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000113   200512 200010                    ADSC9   NAME,,AUTO               cn=1,n=8

      288    20084    1   TERM_KEY.TXT.ACCT = NAME.TEXT;

  20084  4 000114   040000 100500                    MLR     fill='040'O
         4 000115   200512 200010                    ADSC9   NAME,,AUTO               cn=1,n=8
         4 000116   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8

      289    20085    1   USERS_KEY = TERM_KEY ;

  20085  4 000117   000000 100400                    MLR     fill='000'O
         4 000120   000121 000012 2                  ADSC9   TERM_KEY                 cn=0,n=10
         4 000121   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:50   

      290    20086    1   ARS = DSEG1SIZE ;

  20086  4 000122   000000 235000 xsym               LDA     DSEG1SIZE
         4 000123   200003 755100                    STA     ARS,,AUTO

      291    20087    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;

  20087  4 000124   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000125   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000126   003543 702000 4                  TSX2    ENQ_ERR

      292    20088    1   ENQDEQ_FLG = AS_TRUE ;

  20088  4 000127   000000 236000 xsym               LDQ     AS_TRUE
         4 000130   400000 376003                    ANQ     -131072,DU
         4 000131   000000 756000 xsym               STQ     ENQDEQ_FLG

      293    20089    1   CALL ASB$READ_HLP( DSEG1$, ARS )

  20089  4 000132   200003 630500                    EPPR0   ARS,,AUTO
         4 000133   201151 450500                    STP0    KL$UBWORD+2,,AUTO
         4 000134   000005 236000 5                  LDQ     5
         4 000135   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 000136   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 000137   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000140   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000141   000205 702000 4                  TSX2    s:20120

      294    20090    2   WHENRETURN DO;

      295    20091    2      CALL ASB$CHECK_TYPE( DSEG1$, ARS, AS_TERM#, CREATE, NAME ) ALTRET(EXIT#);

  20091  4 000142   200512 630500                    EPPR0   NAME,,AUTO
         4 000143   201154 450500                    STP0    KL$UBWORD+5,,AUTO
         4 000144   200013 631500                    EPPR1   CREATE,,AUTO
         4 000145   201153 451500                    STP1    KL$UBWORD+4,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:51   
         4 000146   000006 236000 5                  LDQ     6
         4 000147   201152 756100                    STQ     KL$UBWORD+3,,AUTO
         4 000150   200003 633500                    EPPR3   ARS,,AUTO
         4 000151   201151 453500                    STP3    KL$UBWORD+2,,AUTO
         4 000152   000005 236000 5                  LDQ     5
         4 000153   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 000154   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 000155   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 000156   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 000157   000171 702000 4                  TSX2    EXIT#

      296    20092    3      IF CREATE THEN DO;

  20092  4 000160   200013 234100                    SZN     CREATE,,AUTO
         4 000161   000200 605000 4                  TPL     s:20117

      297    20093           /*E*  ERROR:    ASA-E$TERM_ALREADY_EXISTS-C
      298    20094                 MESSAGE0: Terminal %%U1 %already exists.
      299    20095                 MESSAGE1: Cannot CREATE a terminal that already exists.
      300    20096           */
      301    20097    3         AS_FIELD1 = NAME;

  20097  4 000162   000000 100500                    MLR     fill='000'O
         4 000163   200512 000011                    ADSC9   NAME,,AUTO               cn=0,n=9
         4 000164   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      302    20098              %SCREAM( ERR#=E$TERM_ALREADY_EXISTS, LEVEL=ERROR, MID='A') ;

  20110  4 000165   000007 630400 5                  EPPR0   7
         4 000166   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000167   000000 701000 xent               TSX1    ASH$ERROR
         4 000170   000000 011000                    NOP     0

      303    20113    3   EXIT#: CALL ASB$DEQ_HLP ;

  20113  4 000171   000002 631400 xsym  EXIT#        EPPR1   B_VECTNIL+2
         4 000172   000000 701000 xent               TSX1    ASB$DEQ_HLP
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:52   
         4 000173   000000 011000                    NOP     0

      304    20114    3         ENQDEQ_FLG = AS_FALSE ;

  20114  4 000174   000000 236000 xsym               LDQ     AS_FALSE
         4 000175   400000 376003                    ANQ     -131072,DU
         4 000176   000000 756000 xsym               STQ     ENQDEQ_FLG

      305    20115    3         RETURN ;

  20115  4 000177   000000 702200 xent               TSX2  ! X66_ARET

      306    20116    3         END ; /* If create */
      307    20117    2      SNAME = KL$TREC.SNAME ;

  20117  4 000200   201141 470500                    LDP0    TREC$,,AUTO
         4 000201   040100 100500                    MLR     fill='040'O
         4 000202   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         4 000203   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      308    20118    2      END;  /*  Whenreturn  */

  20118  4 000204   000233 710000 4                  TRA     s:20147

      309    20119    2   WHENALTRETURN DO;

      310    20120    3      IF NOT CREATE THEN DO;

  20120  4 000205   200013 234100                    SZN     CREATE,,AUTO
         4 000206   000230 604000 4                  TMI     s:20144

      311    20121        /*E*  ERROR:    ASA-E$TERM_NO_EXIST-C
      312    20122              MESSAGE0: Terminal %%U1 %does not exist. Switching to CREATE mode.
      313    20123        */
      314    20124    3         CALL INDEX( I, AS_BLANK, SUBSTR(USERS_KEY.TXTC,0,8) ) ;

  20124  4 000207   000000 124400                    SCM     mask='000'O
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:53   
         4 000210   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000211   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000212   200502 000100                    ARG     I,,AUTO

      315    20125    3         AS_FIELD1.COUNT = I ;

  20125  4 000213   200502 236100                    LDQ     I,,AUTO
         4 000214   000033 736000                    QLS     27
         4 000215   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      316    20126    3         AS_FIELD1.TEXT = USERS_KEY.TXTC ;

  20126  4 000216   040000 100400                    MLR     fill='040'O
         4 000217   000000 200050 xsym               ADSC9   USERS_KEY                cn=1,n=40
         4 000220   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      317    20127              %SCREAM( ERR#=E$TERM_NO_EXIST, LEVEL=WARN, MID='A') ;

  20137  4 000221   000010 630400 5                  EPPR0   8
         4 000222   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000223   000000 701000 xent               TSX1    ASH$WARN
         4 000224   000000 011000                    NOP     0

      318    20142    3         CREATE = AS_TRUE ;

  20142  4 000225   000000 236000 xsym               LDQ     AS_TRUE
         4 000226   400000 376003                    ANQ     -131072,DU
         4 000227   200013 756100                    STQ     CREATE,,AUTO

      319    20143    3         END;  /*  If not create  */

      320    20144    2      SNAME = 'LOCAL';

  20144  4 000230   040100 100400                    MLR     fill='040'O
         4 000231   000127 000005 3                  ADSC9   TERM_TYPE_A+13           cn=0,n=5
         4 000232   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:54   
      321    20145    2      END;  /*  Whenaltreturn  */

      322    20146        /**/
      323    20147    1   TERM_T=' ';

  20147  4 000233   040100 100400                    MLR     fill='040'O
         4 000234   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000235   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7

      324    20148                                                              /*  Check exist of station */
      325    20149    2   DO I = 1 TO SUBS-1 ;

  20149  4 000236   000001 235007                    LDA     1,DL
         4 000237   200502 755100                    STA     I,,AUTO
         4 000240   000374 710000 4                  TRA     s:20220+1

      326    20150    2      IF P$NODE.SUBLK$(I) -> P$NODE.CODE = STAT_ACCT_N

  20150  4 000241   000000 470400 xsym               LDP0    NODE$
         4 000242   200502 720100                    LXL0    I,,AUTO
         4 000243   000003 471510                    LDP1    3,X0,PR0
         4 000244   100000 721100                    LXL1    0,,PR1
         4 000245   000144 101003                    CMPX1   100,DU
         4 000246   000335 601000 4                  TNZ     s:20203

      327    20151    3      THEN DO;

      328    20152    3         BLK$ = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) ;

  20152  4 000247   100003 236100                    LDQ     3,,PR1
         4 000250   200005 756100                    STQ     BLK$,,AUTO

      329    20153    4         IF OUT$SYM.COUNT > 8 THEN DO;

  20153  4 000251   200005 473500                    LDP3    BLK$,,AUTO
         4 000252   300004 236100                    LDQ     4,,PR3
         4 000253   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:55   
         4 000254   011000 116003                    CMPQ    4608,DU
         4 000255   000263 602000 4                  TNC     s:20171

      330    20154                 %SCREAM( ERR#=E$SNAMETOOBIG, LEVEL=ERROR, MID='A' );

  20166  4 000256   000011 630400 5                  EPPR0   9
         4 000257   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000260   000000 701000 xent               TSX1    ASH$ERROR
         4 000261   000000 011000                    NOP     0

      331    20169    4            RETURN ;

  20169  4 000262   000000 702200 xent               TSX2  ! X66_ARET

      332    20170    4            END ; /* If count > 8  */
      333    20171    3         SNAME = OUT$SYM.TEXT;

  20171  4 000263   300004 236100                    LDQ     4,,PR3
         4 000264   000033 772000                    QRL     27
         4 000265   000000 622006                    EAX2    0,QL
         4 000266   040100 100540                    MLR     fill='040'O
         4 000267   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 000270   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      334    20172    3         IF NOT CREATE AND KL$TREC.SNAME ~= SNAME

  20172  4 000271   200013 234100                    SZN     CREATE,,AUTO
         4 000272   000335 604000 4                  TMI     s:20203
         4 000273   201141 474500                    LDP4    TREC$,,AUTO
         4 000274   040100 106500                    CMPC    fill='040'O
         4 000275   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000276   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000277   000335 600000 4                  TZE     s:20203

      335    20173    4         THEN DO;

      336    20174        /*E* ERROR:   ASA-E$TERM_NOTBELONG-C
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:56   
      337    20175             MESSAGE: Warning:  Terminal %U1 was created for %U2, not %U3.
      338    20176        */
      339    20177    4            AS_FIELD1 = NAME ;

  20177  4 000300   000000 100500                    MLR     fill='000'O
         4 000301   200512 000011                    ADSC9   NAME,,AUTO               cn=0,n=9
         4 000302   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      340    20178    4            CALL INDEX( I, AS_BLANK, KL$TREC.SNAME ) ;

  20178  4 000303   000000 124500                    SCM     mask='000'O
         4 000304   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000305   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000306   200502 000100                    ARG     I,,AUTO

      341    20179    4            AS_FIELD2.COUNT = I ;

  20179  4 000307   200502 236100                    LDQ     I,,AUTO
         4 000310   000033 736000                    QLS     27
         4 000311   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      342    20180    4            AS_FIELD2.TEXT = KL$TREC.SNAME ;

  20180  4 000312   040000 100500                    MLR     fill='040'O
         4 000313   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
         4 000314   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      343    20181    4            AS_FIELD3.COUNT = OUT$SYM.COUNT ;

  20181  4 000315   300004 236100                    LDQ     4,,PR3
         4 000316   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

      344    20182    4            AS_FIELD3.TEXT = OUT$SYM.TEXT ;

  20182  4 000317   300004 236100                    LDQ     4,,PR3
         4 000320   000033 772000                    QRL     27
         4 000321   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:57   
         4 000322   040000 100540                    MLR     fill='040'O
         4 000323   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000324   000000 200050 xsym               ADSC9   AS_FIELD3                cn=1,n=40

      345    20183                 %SCREAM( ERR#=E$TERM_NOTBELONG, LEVEL=ERROR, MID='A');

  20195  4 000325   000012 630400 5                  EPPR0   10
         4 000326   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000327   000000 701000 xent               TSX1    ASH$ERROR
         4 000330   000000 011000                    NOP     0

      346    20198    4            SNAME = KL$TREC.SNAME ;

  20198  4 000331   201141 470500                    LDP0    TREC$,,AUTO
         4 000332   040100 100500                    MLR     fill='040'O
         4 000333   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         4 000334   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8

      347    20199    4            END ;  /*  Not create and sname's dont match  */

      348    20200    3         END;  /*  If STAT_ACCT_N  */

      349    20201                                                              /*  Term type.  */
      350    20202                                                              /**/
      351    20203    2      IF P$NODE.SUBLK$(I) -> P$NODE.CODE = TERM_TYPE_VAL

  20203  4 000335   000000 470400 xsym               LDP0    NODE$
         4 000336   200502 720100                    LXL0    I,,AUTO
         4 000337   000003 471510                    LDP1    3,X0,PR0
         4 000340   100000 721100                    LXL1    0,,PR1
         4 000341   000045 101003                    CMPX1   37,DU
         4 000342   000373 601000 4                  TNZ     s:20220

      352    20204    3      THEN DO;

      353    20205    3         CODE = P$NODE.SUBLK$(I) -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:58   
  20205  4 000343   100003 473500                    LDP3    3,,PR1
         4 000344   300000 236100                    LDQ     0,,PR3
         4 000345   777777 376007                    ANQ     -1,DL
         4 000346   000000 756000 xsym               STQ     CODE

      354    20206                                                              /**/
      355    20207    4         DO SELECT( CODE ) ;

  20207  4 000347   000047 116007                    CMPQ    39,DL
         4 000350   000355 602000 4                  TNC     s:20207+6
         4 000351   000364 600000 4                  TZE     s:20213
         4 000352   000050 116007                    CMPQ    40,DL
         4 000353   000373 601000 4                  TNZ     s:20220
         4 000354   000370 710000 4                  TRA     s:20216
         4 000355   000046 116007                    CMPQ    38,DL
         4 000356   000373 601000 4                  TNZ     s:20220
         4 000357   000360 710000 4                  TRA     s:20210

      356    20208                                                              /**/
      357    20209    4            SELECT( T_IRBT_VAL ) ;

      358    20210    4            TERM_T='STDHASP';

  20210  4 000360   040100 100400                    MLR     fill='040'O
         4 000361   000133 000007 3                  ADSC9   TERM_TYPE_A+17           cn=0,n=7
         4 000362   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7
         4 000363   000373 710000 4                  TRA     s:20220

      359    20211                                                              /**/
      360    20212    4            SELECT( T_2780_VAL ) ;

      361    20213    4            TERM_T='STD2780';

  20213  4 000364   040100 100400                    MLR     fill='040'O
         4 000365   000135 000007 3                  ADSC9   TERM_TYPE_A+19           cn=0,n=7
         4 000366   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7
         4 000367   000373 710000 4                  TRA     s:20220
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:59   

      362    20214                                                              /**/
      363    20215    4            SELECT( T_3780_VAL ) ;

      364    20216    4            TERM_T='STD3780';

  20216  4 000370   040100 100400                    MLR     fill='040'O
         4 000371   000137 000007 3                  ADSC9   TERM_TYPE_A+21           cn=0,n=7
         4 000372   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7

      365    20217                                                              /**/
      366    20218    4            END ;   /* Do case code  */

      367    20219    3         END ; /* If TERM_TYPE_VAL  */

      368    20220    2      END; /* Of do i */

  20220  4 000373   200502 054100                    AOS     I,,AUTO
         4 000374   200502 236100                    LDQ     I,,AUTO
         4 000375   000241 604000 4                  TMI     s:20150
         4 000376   201132 116100                    CMPQ    SUBS,,AUTO
         4 000377   000241 602000 4                  TNC     s:20150

      369    20221                                                          /* If for station was not  */
      370    20222                                                          /* specified in create, then  */
      371    20223                                                        /* the default is local station. */
      372    20224    1   IF SNAME = 'LOCAL'

  20224  4 000400   040000 106500                    CMPC    fill='040'O
         4 000401   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000402   000127 000005 3                  ADSC9   TERM_TYPE_A+13           cn=0,n=5
         4 000403   000410 601000 4                  TNZ     s:20226

      373    20225    1   THEN LOCAL = AS_TRUE ;

  20225  4 000404   000000 236000 xsym               LDQ     AS_TRUE
         4 000405   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:60   
         4 000406   200506 756100                    STQ     LOCAL,,AUTO
         4 000407   000413 710000 4                  TRA     s:20227

      374    20226    1   ELSE LOCAL = AS_FALSE ;

  20226  4 000410   000000 236000 xsym               LDQ     AS_FALSE
         4 000411   400000 376003                    ANQ     -131072,DU
         4 000412   200506 756100                    STQ     LOCAL,,AUTO

      375    20227    1   CALL CONCAT ( USERS_KEY.TXTC, SNAME, 'STATION' );

  20227  4 000413   040000 100500                    MLR     fill='040'O
         4 000414   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000415   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000416   040000 100400                    MLR     fill='040'O
         4 000417   000141 000007 3                  ADSC9   TERM_TYPE_A+23           cn=0,n=7
         4 000420   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      376    20228    1   USERS_KEY.COUNT = 15;

  20228  4 000421   017000 236003                    LDQ     7680,DU
         4 000422   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      377    20229    1   CALL INDEX ( I, AS_BLANK, SNAME );

  20229  4 000423   000000 124500                    SCM     mask='000'O
         4 000424   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000425   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000426   200502 000100                    ARG     I,,AUTO

      378    20230    1   NAME.COUNT = I ;

  20230  4 000427   200502 236100                    LDQ     I,,AUTO
         4 000430   000033 736000                    QLS     27
         4 000431   200512 552140                    STBQ    NAME,'40'O,AUTO

      379    20231    1   NAME.TEXT = SNAME ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:61   

  20231  4 000432   040100 100500                    MLR     fill='040'O
         4 000433   201126 000010                    ADSC9   SNAME,,AUTO              cn=0,n=8
         4 000434   200512 200010                    ADSC9   NAME,,AUTO               cn=1,n=8

      380    20232    1   ARS = DSEG3SIZE ;

  20232  4 000435   000000 235000 xsym               LDA     DSEG3SIZE
         4 000436   200003 755100                    STA     ARS,,AUTO

      381    20233    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;

  20233  4 000437   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000440   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000441   003543 702000 4                  TSX2    ENQ_ERR

      382    20234    1   ENQDEQ_FLG = AS_TRUE ;

  20234  4 000442   000000 236000 xsym               LDQ     AS_TRUE
         4 000443   400000 376003                    ANQ     -131072,DU
         4 000444   000000 756000 xsym               STQ     ENQDEQ_FLG

      383    20235    1   CALL ASB$READ_HLP( DSEG3$, ARS )

  20235  4 000445   200003 630500                    EPPR0   ARS,,AUTO
         4 000446   201151 450500                    STP0    KL$UBWORD+2,,AUTO
         4 000447   000013 236000 5                  LDQ     11
         4 000450   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 000451   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 000452   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000453   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000454   000456 702000 4                  TSX2    s:20240
         4 000455   000503 710000 4                  TRA     s:20263

      384    20236    2   WHENALTRETURN DO;

      385    20237        /*E* ERROR:   ASA-E$STAT_NO_EXIST-C
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:62   
      386    20238             MESSAGE0: Station %%U1 %does not exist.
      387    20239        */
      388    20240    2      CALL INDEX (I, AS_BLANK, SUBSTR(USERS_KEY.TXTC,0,8) ) ;

  20240  4 000456   000000 124400                    SCM     mask='000'O
         4 000457   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000460   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000461   200502 000100                    ARG     I,,AUTO

      389    20241    2      AS_FIELD1.COUNT = I ;

  20241  4 000462   200502 236100                    LDQ     I,,AUTO
         4 000463   000033 736000                    QLS     27
         4 000464   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      390    20242    2      AS_FIELD1.TEXT = USERS_KEY.TXTC ;

  20242  4 000465   040000 100400                    MLR     fill='040'O
         4 000466   000000 200050 xsym               ADSC9   USERS_KEY                cn=1,n=40
         4 000467   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      391    20243           %SCREAM( ERR#=E$STAT_NO_EXIST, LEVEL=WARN, MID='A') ;

  20253  4 000470   000014 630400 5                  EPPR0   12
         4 000471   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000472   000000 701000 xent               TSX1    ASH$WARN
         4 000473   000000 011000                    NOP     0

      392    20258    2      CALL ASB$DEQ_HLP ;

  20258  4 000474   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000475   000000 701000 xent               TSX1    ASB$DEQ_HLP
         4 000476   000000 011000                    NOP     0

      393    20259    2      ENQDEQ_FLG = AS_FALSE ;

  20259  4 000477   000000 236000 xsym               LDQ     AS_FALSE
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:63   
         4 000500   400000 376003                    ANQ     -131072,DU
         4 000501   000000 756000 xsym               STQ     ENQDEQ_FLG

      394    20260    2      RETURN ;

  20260  4 000502   000000 702200 xent               TSX2  ! X66_ARET

      395    20261    2      END; /*  Whenaltreturn  */
      396    20262        /**/
      397    20263    1   CALL ASB$CHECK_TYPE( DSEG3$, ARS, AS_STAT#, CREATE, NAME ) ALTRET(EXIT#);

  20263  4 000503   200512 630500                    EPPR0   NAME,,AUTO
         4 000504   201154 450500                    STP0    KL$UBWORD+5,,AUTO
         4 000505   200013 631500                    EPPR1   CREATE,,AUTO
         4 000506   201153 451500                    STP1    KL$UBWORD+4,,AUTO
         4 000507   000015 236000 5                  LDQ     13
         4 000510   201152 756100                    STQ     KL$UBWORD+3,,AUTO
         4 000511   200003 633500                    EPPR3   ARS,,AUTO
         4 000512   201151 453500                    STP3    KL$UBWORD+2,,AUTO
         4 000513   000013 236000 5                  LDQ     11
         4 000514   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 000515   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 000516   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 000517   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 000520   000171 702000 4                  TSX2    EXIT#

      398    20264    1   TWSNC = KL$SREC.TWSN# ;

  20264  4 000521   201130 470500                    LDP0    SREC$,,AUTO
         4 000522   000001 236100                    LDQ     1,,PR0
         4 000523   201142 756100                    STQ     TWSNC,,AUTO

      399    20265                                                              /* Read twsn record */
      400    20266    1   CALL CHARBIN( TWSN#, TWSNC ) ;

  20266  4 000524   000100 305500                    DTB
         4 000525   201142 030004                    NDSC9   TWSNC,,AUTO              cn=0,s=nosgn,sf=0,n=4
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:64   
         4 000526   201150 000010                    NDSC9   KL$UBWORD+1,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         4 000527   201151 235100                    LDA     KL$UBWORD+2,,AUTO
         4 000530   201144 755100                    STA     TWSN#,,AUTO

      401    20267    1   USERS_KEY.COUNT = 8 ;

  20267  4 000531   010000 236003                    LDQ     4096,DU
         4 000532   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      402    20268    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;

  20268  4 000533   040000 100400                    MLR     fill='040'O
         4 000534   000144 000004 3                  ADSC9   TERM_TYPE_A+26           cn=0,n=4
         4 000535   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 000536   040000 100500                    MLR     fill='040'O
         4 000537   201142 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 000540   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      403    20269    1   ARS = DSEG2SIZE ;

  20269  4 000541   000000 235000 xsym               LDA     DSEG2SIZE
         4 000542   200003 755100                    STA     ARS,,AUTO

      404    20270    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;

  20270  4 000543   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000544   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000545   003543 702000 4                  TSX2    ENQ_ERR

      405    20271    1   ENQDEQ_FLG = AS_TRUE ;

  20271  4 000546   000000 236000 xsym               LDQ     AS_TRUE
         4 000547   400000 376003                    ANQ     -131072,DU
         4 000550   000000 756000 xsym               STQ     ENQDEQ_FLG

      406    20272    1   CALL ASB$READ_HLP( TWSNR$, ARS )

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:65   
  20272  4 000551   200003 630500                    EPPR0   ARS,,AUTO
         4 000552   201151 450500                    STP0    KL$UBWORD+2,,AUTO
         4 000553   201143 631500                    EPPR1   TWSNR$,,AUTO
         4 000554   201150 451500                    STP1    KL$UBWORD+1,,AUTO
         4 000555   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 000556   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000557   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000560   000562 702000 4                  TSX2    s:20278
         4 000561   000600 710000 4                  TRA     s:20299

      407    20273    2   WHENALTRETURN DO;

      408    20274        /*E*  ERROR:    ASA-E$TWSN_NO_EXIST-C
      409    20275              MESSAGE:  %%U1 %does not exist.
      410    20276              MESSAGE1: TWSN %%U1 %record does not exist.
      411    20277        */
      412    20278    2      AS_FIELD1 = USERS_KEY ;

  20278  4 000562   000000 100400                    MLR     fill='000'O
         4 000563   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         4 000564   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      413    20279           %SCREAM( ERR#=E$TWSN_NO_EXIST, LEVEL=ERROR, MID='A') ;

  20291  4 000565   000016 630400 5                  EPPR0   14
         4 000566   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000567   000000 701000 xent               TSX1    ASH$ERROR
         4 000570   000000 011000                    NOP     0

      414    20294    2      CALL ASB$DEQ_HLP ;

  20294  4 000571   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000572   000000 701000 xent               TSX1    ASB$DEQ_HLP
         4 000573   000000 011000                    NOP     0

      415    20295    2      ENQDEQ_FLG = AS_FALSE ;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:66   
  20295  4 000574   000000 236000 xsym               LDQ     AS_FALSE
         4 000575   400000 376003                    ANQ     -131072,DU
         4 000576   000000 756000 xsym               STQ     ENQDEQ_FLG

      416    20296    2      RETURN ;

  20296  4 000577   000000 702200 xent               TSX2  ! X66_ARET

      417    20297    2      END; /*  Whenaltreturn  */
      418    20298        /**/
      419    20299    1   USERS_KEY = TERM_KEY ;

  20299  4 000600   000000 100400                    MLR     fill='000'O
         4 000601   000121 000012 2                  ADSC9   TERM_KEY                 cn=0,n=10
         4 000602   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      420    20300    1   TWSN_ARS = ARS ;

  20300  4 000603   200003 235100                    LDA     ARS,,AUTO
         4 000604   201145 755100                    STA     TWSN_ARS,,AUTO

      421    20301                                                              /**/
      422    20302    1   IF CREATE

  20302  4 000605   200013 234100                    SZN     CREATE,,AUTO
         4 000606   000733 605000 4                  TPL     s:20328

      423    20303    2   THEN DO ;

      424    20304    2      KL$TREC = KL_TREC ;

  20304  4 000607   201141 470500                    LDP0    TREC$,,AUTO
         4 000610   000100 100400                    MLR     fill='000'O
         4 000611   000007 000414 3                  ADSC9   KL_TREC                  cn=0,n=268
         4 000612   000000 000414                    ADSC9   0,,PR0                   cn=0,n=268

      425    20305    2      KL$TREC.SUPER = AS_TERM#;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:67   

  20305  4 000613   201141 470500                    LDP0    TREC$,,AUTO
         4 000614   000003 236007                    LDQ     3,DL
         4 000615   000000 552104                    STBQ    0,'04'O,PR0

      426    20306    2      KL$TREC.TNAME = TERM_KEY.TXT.ACCT ;

  20306  4 000616   201141 470500                    LDP0    TREC$,,AUTO
         4 000617   040100 100400                    MLR     fill='040'O
         4 000620   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 000621   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8

      427    20307    2      KL$TREC.SNAME = SNAME ;

  20307  4 000622   201141 470500                    LDP0    TREC$,,AUTO
         4 000623   201126 237100                    LDAQ    SNAME,,AUTO
         4 000624   000015 755100                    STA     13,,PR0
         4 000625   000016 756100                    STQ     14,,PR0

      428    20308    2      KL$TREC.ATYP = %KLAT_TRM# ;

  20308  4 000626   201141 470500                    LDP0    TREC$,,AUTO
         4 000627   004000 236003                    LDQ     2048,DU
         4 000630   000000 552140                    STBQ    0,'40'O,PR0

      429    20309    2      KL$TREC.PNAME.TXT=TERM_T;

  20309  4 000631   201141 470500                    LDP0    TREC$,,AUTO
         4 000632   040100 100500                    MLR     fill='040'O
         4 000633   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7
         4 000634   000004 200013                    ADSC9   4,,PR0                   cn=1,n=11

      430    20310    2      IF TERM_T~=' ' THEN

  20310  4 000635   040000 106500                    CMPC    fill='040'O
         4 000636   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7
         4 000637   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:68   
         4 000640   000645 600000 4                  TZE     s:20313

      431    20311    2         KL$TREC.PNAME.CNT=7;

  20311  4 000641   201141 470500                    LDP0    TREC$,,AUTO
         4 000642   007000 236003                    LDQ     3584,DU
         4 000643   000004 552140                    STBQ    4,'40'O,PR0
         4 000644   000650 710000 4                  TRA     s:20314

      432    20312    2      ELSE
      433    20313    2         KL$TREC.PNAME.CNT = 0 ;

  20313  4 000645   201141 470500                    LDP0    TREC$,,AUTO
         4 000646   000000 236003                    LDQ     0,DU
         4 000647   000004 552140                    STBQ    4,'40'O,PR0

      434    20314    2      CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;

  20314  4 000650   201141 236100                    LDQ     TREC$,,AUTO
         4 000651   000002 036003                    ADLQ    2,DU
         4 000652   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 000653   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 000654   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000655   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 000656   000000 011000                    NOP     0

      435    20315    2      CALL ASZ$SCRAMBLE( KL$TREC.GJOB.PASS ) ;

  20315  4 000657   201141 236100                    LDQ     TREC$,,AUTO
         4 000660   000025 036003                    ADLQ    21,DU
         4 000661   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 000662   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 000663   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000664   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 000665   000000 011000                    NOP     0

      436    20316    2      KL$TREC.TWSN# = TWSNC ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:69   

  20316  4 000666   201142 236100                    LDQ     TWSNC,,AUTO
         4 000667   201141 470500                    LDP0    TREC$,,AUTO
         4 000670   000001 756100                    STQ     1,,PR0

      437    20317    2      HASPDEV$ = PINCRW( ADDR(KL$TREC.HASP), SIZEW(KL$TREC.HASP));

  20317  4 000671   201141 236100                    LDQ     TREC$,,AUTO
         4 000672   000103 036003                    ADLQ    67,DU
         4 000673   200501 756100                    STQ     HASPDEV$,,AUTO

      438    20318    2      KL$TREC.HASP.BLKHDR.LEV = 1;

  20318  4 000674   201141 470500                    LDP0    TREC$,,AUTO
         4 000675   001000 236003                    LDQ     512,DU
         4 000676   000054 552140                    STBQ    44,'40'O,PR0

      439    20319    2      KL$TREC.HASP.BLKHDR.NSUBS = 0;

  20319  4 000677   201141 470500                    LDP0    TREC$,,AUTO
         4 000700   000000 236003                    LDQ     0,DU
         4 000701   000054 552120                    STBQ    44,'20'O,PR0

      440    20320    2      KL$TREC.HASP.BLKHDR.BLKTYP = %KLTY_STRM#;

  20320  4 000702   201141 470500                    LDP0    TREC$,,AUTO
         4 000703   003000 236003                    LDQ     1536,DU
         4 000704   000055 552140                    STBQ    45,'40'O,PR0

      441    20321    2      LNG_CNT = LENGTHC( KL$TREC.HASP);

  20321  4 000705   000134 235007                    LDA     92,DL
         4 000706   000120 755000 2                  STA     LNGTH

      442    20322    2      KL$UBWORD.REPLACE.T = LNGTH.T;

  20322  4 000707   000120 236000 2                  LDQ     LNGTH
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:70   
         4 000710   000001 736000                    QLS     1
         4 000711   201147 676100                    ERQ     KL$UBWORD,,AUTO
         4 000712   377000 376007                    ANQ     130560,DL
         4 000713   201147 656100                    ERSQ    KL$UBWORD,,AUTO

      443    20323    2      KL$UBWORD.REPLACE.B = LNGTH.B;

  20323  4 000714   000120 236000 2                  LDQ     LNGTH
         4 000715   201147 676100                    ERQ     KL$UBWORD,,AUTO
         4 000716   000377 376007                    ANQ     255,DL
         4 000717   201147 656100                    ERSQ    KL$UBWORD,,AUTO

      444    20324    2      KL$TREC.HASP.BLKHDR.LEN.BYT(0) = KL$UBWORD.REPLACE.T;

  20324  4 000720   201141 470500                    LDP0    TREC$,,AUTO
         4 000721   201147 236100                    LDQ     KL$UBWORD,,AUTO
         4 000722   000054 676100                    ERQ     44,,PR0
         4 000723   377000 376007                    ANQ     130560,DL
         4 000724   000054 656100                    ERSQ    44,,PR0

      445    20325    2      KL$TREC.HASP.BLKHDR.LEN.BYT(1) = KL$UBWORD.REPLACE.B;

  20325  4 000725   201141 470500                    LDP0    TREC$,,AUTO
         4 000726   201147 236100                    LDQ     KL$UBWORD,,AUTO
         4 000727   000054 676100                    ERQ     44,,PR0
         4 000730   000377 376007                    ANQ     255,DL
         4 000731   000054 656100                    ERSQ    44,,PR0

      446    20326    2      END ;  /*  If create  */

  20326  4 000732   000761 710000 4                  TRA     s:20335

      447    20327    2   ELSE DO ;

      448    20328    2      HASPDEV$ = PINCRW(ADDR(KL$TREC.HASP),SIZEW(KL$TREC.HASP)+(KL$TREC.HASP.BLKHDR.
             20328               NSUBS*SIZEW(KL_HASPDEV)));

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:71   
  20328  4 000733   201141 470500                    LDP0    TREC$,,AUTO
         4 000734   000054 220100                    LDX0    44,,PR0
         4 000735   000777 360003                    ANX0    511,DU
         4 000736   000000 636010                    EAQ     0,X0
         4 000737   000007 402007                    MPY     7,DL
         4 000740   000103 036003                    ADLQ    67,DU
         4 000741   201141 036100                    ADLQ    TREC$,,AUTO
         4 000742   200501 756100                    STQ     HASPDEV$,,AUTO

      449    20329    2      CALL INDEX( I, KL$TREC.PNAME.TXT, TERM_TYPES )

  20329  4 000743   200502 631500                    EPPR1   I,,AUTO
         4 000744   000000 633500                    EPPR3   0,,PR0
         4 000745   000021 221003                    LDX1    17,DU
         4 000746   300000 500511                    A9BD    0,X1,PR3
         4 000747   000013 223003                    LDX3    11,DU
         4 000750   000112 630400 3                  EPPR0   TERM_TYPE_A
         4 000751   000041 220003                    LDX0    33,DU
         4 000752   000000 236003                    LDQ     0,DU
         4 000753   000000 701000 xent               TSX1    X66_INDEX
         4 000754   000761 710000 4                  TRA     s:20335

      450    20330    3      WHENRETURN DO;

      451    20331    3         TERM_T = KL$TREC.PNAME.TXT ;

  20331  4 000755   201141 470500                    LDP0    TREC$,,AUTO
         4 000756   040100 100500                    MLR     fill='040'O
         4 000757   000004 200007                    ADSC9   4,,PR0                   cn=1,n=7
         4 000760   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7

      452    20332    3         END ;  /*  Whenreturn  */

      453    20333    2      END;  /*  Not create  */

      454    20334                                                              /*  Do options  */
      455    20335    1   MORE = AS_TRUE ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:72   

  20335  4 000761   000000 236000 xsym               LDQ     AS_TRUE
         4 000762   400000 376003                    ANQ     -131072,DU
         4 000763   200507 756100                    STQ     MORE,,AUTO

      456    20336    1   M_CONDEV = AS_FALSE ;

  20336  4 000764   000000 236000 xsym               LDQ     AS_FALSE
         4 000765   400000 376003                    ANQ     -131072,DU
         4 000766   200510 756100                    STQ     M_CONDEV,,AUTO

  20336  4 000767                       TERM_LOOP    null
      457    20337                                                              /**/
      458    20338    1   TERM_LOOP: ;
      459    20339    2   DO WHILE( MORE ) ;

  20339  4 000767   200507 234100                    SZN     MORE,,AUTO
         4 000770   003410 605000 4                  TPL     DONE_OPTIONS

      460    20340    2      P_PCB.ROOT$ = ADDR( TERM_OPT_LIST ) ;

  20340  4 000771   000017 236000 5                  LDQ     15
         4 000772   000001 756000 xsym               STQ     P_PCB+1

      461    20341    2      REMEMBER TERM_LOOP IN REMEM_VAR ;

  20341  4 000773   000767 635000 4                  EAA     TERM_LOOP
         4 000774   000000 452400 xsym               STP2    REMEM_VAR
         4 000775   000001 755000 xsym               STA     REMEM_VAR+1

      462    20342                                                              /* Set prompt */
      463    20343    2      CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;

  20343  4 000776   000020 630400 5                  EPPR0   16
         4 000777   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001000   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 001001   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:73   

      464    20344                                                              /* Read input */
      465    20345    2      CALL ASB$READ_SI( IN_BUF, ARS ) ;

  20345  4 001002   200003 630500                    EPPR0   ARS,,AUTO
         4 001003   201151 450500                    STP0    KL$UBWORD+2,,AUTO
         4 001004   000021 236000 5                  LDQ     17
         4 001005   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 001006   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 001007   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001010   000000 701000 xent               TSX1    ASB$READ_SI
         4 001011   000000 011000                    NOP     0

      466    20346    2      P_PCB.NCHARS = ARS ;

  20346  4 001012   200003 235100                    LDA     ARS,,AUTO
         4 001013   000011 755000 xsym               STA     P_PCB+9

      467    20347    2      CALL X$PARSE( P_PCB ) ALTRET( TERM_OPT_ERR ) ;

  20347  4 001014   000001 630400 5                  EPPR0   1
         4 001015   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001016   000000 701000 xent               TSX1    X$PARSE
         4 001017   003515 702000 4                  TSX2    TERM_OPT_ERR

      468    20348    2      NODE$ = P_PCB.OUT$ ;

  20348  4 001020   000003 236000 xsym               LDQ     P_PCB+3
         4 001021   000000 756000 xsym               STQ     NODE$

      469    20349                                                              /**/
      470    20350    3      DO I = 0 TO P$NODE.SUBNODES-1 ;

  20350  4 001022   200502 450100                    STZ     I,,AUTO
         4 001023   003401 710000 4                  TRA     s:20947+1

      471    20351    3         PTR$ = P$NODE.SUBLK$(I) ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:74   

  20351  4 001024   000000 470400 xsym               LDP0    NODE$
         4 001025   200502 720100                    LXL0    I,,AUTO
         4 001026   000003 236110                    LDQ     3,X0,PR0
         4 001027   201123 756100                    STQ     PTR$,,AUTO

      472    20352    3         CODE = PTR$ -> P$NODE.CODE ;

  20352  4 001030   201123 471500                    LDP1    PTR$,,AUTO
         4 001031   100000 236100                    LDQ     0,,PR1
         4 001032   777777 376007                    ANQ     -1,DL
         4 001033   000000 756000 xsym               STQ     CODE

      473    20353    4         DO SELECT( CODE ) ;

  20353  4 001034   000044 116007                    CMPQ    36,DL
         4 001035   001064 602000 4                  TNC     s:20353+24
         4 001036   002123 600000 4                  TZE     s:20612
         4 001037   000055 116007                    CMPQ    45,DL
         4 001040   001053 602000 4                  TNC     s:20353+15
         4 001041   003316 600000 4                  TZE     s:20896
         4 001042   000455 116007                    CMPQ    301,DL
         4 001043   001050 602000 4                  TNC     s:20353+12
         4 001044   003353 600000 4                  TZE     s:20912
         4 001045   000456 116007                    CMPQ    302,DL
         4 001046   003400 601000 4                  TNZ     s:20947
         4 001047   003347 710000 4                  TRA     s:20909
         4 001050   000454 116007                    CMPQ    300,DL
         4 001051   003400 601000 4                  TNZ     s:20947
         4 001052   003357 710000 4                  TRA     s:20915
         4 001053   000046 116007                    CMPQ    38,DL
         4 001054   001061 602000 4                  TNC     s:20353+21
         4 001055   003035 600000 4                  TZE     s:20733
         4 001056   000054 116007                    CMPQ    44,DL
         4 001057   003400 601000 4                  TNZ     s:20947
         4 001060   003253 710000 4                  TRA     s:20858
         4 001061   000045 116007                    CMPQ    37,DL
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:75   
         4 001062   003400 601000 4                  TNZ     s:20947
         4 001063   002426 710000 4                  TRA     s:20659
         4 001064   000041 116007                    CMPQ    33,DL
         4 001065   001075 602000 4                  TNC     s:20353+33
         4 001066   001106 600000 4                  TZE     s:20356
         4 001067   000042 116007                    CMPQ    34,DL
         4 001070   003400 602000 4                  TNC     s:20947
         4 001071   001272 600000 4                  TZE     s:20436
         4 001072   000043 116007                    CMPQ    35,DL
         4 001073   003400 601000 4                  TNZ     s:20947
         4 001074   001633 710000 4                  TRA     s:20570
         4 001075   000020 116007                    CMPQ    16,DL
         4 001076   001103 602000 4                  TNC     s:20353+39
         4 001077   003346 600000 4                  TZE     s:20906
         4 001100   000032 116007                    CMPQ    26,DL
         4 001101   003400 601000 4                  TNZ     s:20947
         4 001102   003363 710000 4                  TRA     s:20919
         4 001103   000014 116007                    CMPQ    12,DL
         4 001104   003400 601000 4                  TNZ     s:20947
         4 001105   003363 710000 4                  TRA     s:20919

      474    20354                                                              /**/
      475    20355    4            SELECT( TERM_PASS_VAL ) ;

      476    20356    4            CODE2 = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  20356  4 001106   100003 473500                    LDP3    3,,PR1
         4 001107   300000 236100                    LDQ     0,,PR3
         4 001110   777777 376007                    ANQ     -1,DL
         4 001111   200011 756100                    STQ     CODE2,,AUTO

      477    20357    5            DO SELECT( CODE2 ) ;

  20357  4 001112   000053 116007                    CMPQ    43,DL
         4 001113   001120 602000 4                  TNC     s:20357+6
         4 001114   001137 600000 4                  TZE     s:20365
         4 001115   000057 116007                    CMPQ    47,DL
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:76   
         4 001116   003400 601000 4                  TNZ     s:20947
         4 001117   001171 710000 4                  TRA     s:20393
         4 001120   000007 116007                    CMPQ    7,DL
         4 001121   003400 601000 4                  TNZ     s:20947
         4 001122   001123 710000 4                  TRA     s:20361

      478    20358                                                              /**/
      479    20359    5               SELECT( NONE_VAL ) ;

      480    20360                                                              /* No password */
      481    20361    5               KL$TREC.PASSWORD = AS_BLANK ;

  20361  4 001123   201141 474500                    LDP4    TREC$,,AUTO
         4 001124   040100 100400                    MLR     fill='040'O
         4 001125   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001126   400002 000010                    ADSC9   2,,PR4                   cn=0,n=8

      482    20362    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;

  20362  4 001127   201141 236100                    LDQ     TREC$,,AUTO
         4 001130   000002 036003                    ADLQ    2,DU
         4 001131   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 001132   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 001133   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001134   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 001135   000000 011000                    NOP     0
         4 001136   003400 710000 4                  TRA     s:20947

      483    20363                                                              /**/
      484    20364    5               SELECT( TERM_PW_VAL ) ;

      485    20365    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  20365  4 001137   100003 236100                    LDQ     3,,PR1
         4 001140   200005 756100                    STQ     BLK$,,AUTO

      486    20366    5               CNT = OUT$SYM.COUNT ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:77   

  20366  4 001141   200005 474500                    LDP4    BLK$,,AUTO
         4 001142   400004 236100                    LDQ     4,,PR4
         4 001143   000033 772000                    QRL     27
         4 001144   200010 756100                    STQ     CNT,,AUTO

      487    20367    6               IF CNT > 8 THEN DO;

  20367  4 001145   000011 116007                    CMPQ    9,DL
         4 001146   001154 602000 4                  TNC     s:20389

      488    20368        /*E*  ERROR:    ASA-E$PASSW_TOO_LONG-C
      489    20369              MESSAGE:  Password is too long.
      490    20370              MESSAGE1: Password can be at most 8 characters long.
      491    20371        */
      492    20372                       %SCREAM( ERR#=E$PASSW_TOO_LONG, LEVEL=ERROR, MID='A') ;

  20384  4 001147   000022 630400 5                  EPPR0   18
         4 001150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001151   000000 701000 xent               TSX1    ASH$ERROR
         4 001152   000000 011000                    NOP     0

      493    20387    6                  RETURN ;

  20387  4 001153   000000 702200 xent               TSX2  ! X66_ARET

      494    20388    6                  END ;  /* Then do */
      495    20389    5               KL$TREC.PASSWORD = OUT$SYM.TEXT ;

  20389  4 001154   000000 621006                    EAX1    0,QL
         4 001155   201141 475500                    LDP5    TREC$,,AUTO
         4 001156   040100 100540                    MLR     fill='040'O
         4 001157   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
         4 001160   500002 000010                    ADSC9   2,,PR5                   cn=0,n=8

      496    20390    5               CALL ASZ$SCRAMBLE( KL$TREC.PASSWORD ) ;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:78   
  20390  4 001161   201141 236100                    LDQ     TREC$,,AUTO
         4 001162   000002 036003                    ADLQ    2,DU
         4 001163   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 001164   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 001165   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001166   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 001167   000000 011000                    NOP     0
         4 001170   003400 710000 4                  TRA     s:20947

      497    20391                                                              /**/
      498    20392    5               SELECT( OCT_PASS_VAL ) ;

      499    20393    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);

  20393  4 001171   300003 236100                    LDQ     3,,PR3
         4 001172   200005 756100                    STQ     BLK$,,AUTO

      500    20394    5               CNT = OUT$SYM.COUNT;

  20394  4 001173   200005 474500                    LDP4    BLK$,,AUTO
         4 001174   400004 236100                    LDQ     4,,PR4
         4 001175   000033 772000                    QRL     27
         4 001176   200010 756100                    STQ     CNT,,AUTO

      501    20395    5               IF CNT ~= 24

  20395  4 001177   000030 116007                    CMPQ    24,DL
         4 001200   001206 600000 4                  TZE     s:20418

      502    20396    6               THEN DO;

      503    20397        /*E*  ERROR:    AS-E$OCTAL_PASSWORD_LENGTH_ERR-C
      504    20398              MESSAGE: PASSWORD not the right size.
      505    20399              MESSAGE1: PASSWORD in octal form must be 24 characters long.
      506    20400        */
      507    20401                       %SCREAM(ERR#=E$OCTAL_PASSWORD_LENGTH_ERR,LEVEL=ERROR,MID='A');

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:79   
  20413  4 001201   000023 630400 5                  EPPR0   19
         4 001202   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001203   000000 701000 xent               TSX1    ASH$ERROR
         4 001204   000000 011000                    NOP     0

      508    20416    6                  END; /*  Length error  */

  20416  4 001205   003400 710000 4                  TRA     s:20947

      509    20417    6               ELSE DO;

      510    20418    6                  P$ = ADDR ( OUT$SYM.TEXT );

  20418  4 001206   200005 236100                    LDQ     BLK$,,AUTO
         4 001207   000024 036000 5                  ADLQ    20
         4 001210   201124 756100                    STQ     P$,,AUTO

      511    20419    6                  PTR$ = PINCRC (P$,24);

  20419  4 001211   000006 036003                    ADLQ    6,DU
         4 001212   201123 756100                    STQ     PTR$,,AUTO

      512    20420    6                  TEMP$ = ADDR (KL$TREC.PASSWORD);

  20420  4 001213   201141 236100                    LDQ     TREC$,,AUTO
         4 001214   000002 036003                    ADLQ    2,DU
         4 001215   201136 756100                    STQ     TEMP$,,AUTO

      513    20421    7                  DO WHILE P$ < PTR$ ;

  20421  4 001216   201124 236100                    LDQ     P$,,AUTO
         4 001217   201123 116100                    CMPQ    PTR$,,AUTO
         4 001220   003400 603000 4                  TRC     s:20947

      514    20422    7                     CALL CHARBIN (L, P$->ACHAR);

  20422  4 001221   201124 470500                    LDP0    P$,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:80   
         4 001222   000100 305500                    DTB
         4 001223   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 001224   200505 000004                    NDSC9   L,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      515    20423    7                     P$ = PINCRC (P$,1);

  20423  4 001225   201124 236100                    LDQ     P$,,AUTO
         4 001226   200000 036007                    ADLQ    65536,DL
         4 001227   201124 756100                    STQ     P$,,AUTO

      516    20424    7                     CALL CHARBIN (J, P$-> ACHAR);

  20424  4 001230   201124 470500                    LDP0    P$,,AUTO
         4 001231   000100 305500                    DTB
         4 001232   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 001233   200503 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      517    20425    7                     P$ = PINCRC (P$,1);

  20425  4 001234   200000 036007                    ADLQ    65536,DL
         4 001235   201124 756100                    STQ     P$,,AUTO

      518    20426    7                     CALL CHARBIN (K, P$->ACHAR);

  20426  4 001236   201124 470500                    LDP0    P$,,AUTO
         4 001237   000100 305500                    DTB
         4 001240   000000 030001                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=1
         4 001241   200504 000004                    NDSC9   K,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      519    20427    7                     TEMP = L * 64 + J * 8 + K;

  20427  4 001242   200505 236100                    LDQ     L,,AUTO
         4 001243   000003 736000                    QLS     3
         4 001244   200503 036100                    ADLQ    J,,AUTO
         4 001245   000003 736000                    QLS     3
         4 001246   200504 036100                    ADLQ    K,,AUTO
         4 001247   201135 756100                    STQ     TEMP,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:81   

      520    20428    7                     P$ = PINCRC (P$, 1);

  20428  4 001250   201124 236100                    LDQ     P$,,AUTO
         4 001251   200000 036007                    ADLQ    65536,DL
         4 001252   201124 756100                    STQ     P$,,AUTO

      521    20429    7                     TEMP$ -> ACHAR = BINASC ( TEMP );

  20429  4 001253   201135 236100                    LDQ     TEMP,,AUTO
         4 001254   000033 736000                    QLS     27
         4 001255   000025 276000 5                  ORQ     21
         4 001256   201150 756100                    STQ     KL$UBWORD+1,,AUTO
         4 001257   201136 470500                    LDP0    TEMP$,,AUTO
         4 001260   040100 100500                    MLR     fill='040'O
         4 001261   201150 000004                    ADSC9   KL$UBWORD+1,,AUTO        cn=0,n=4
         4 001262   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      522    20430    7                     TEMP$ = PINCRC (TEMP$, 1);

  20430  4 001263   201136 236100                    LDQ     TEMP$,,AUTO
         4 001264   200000 036007                    ADLQ    65536,DL
         4 001265   201136 756100                    STQ     TEMP$,,AUTO

      523    20431    7                     END; /*  Do while P$ < PTR$  */

  20431  4 001266   201124 236100                    LDQ     P$,,AUTO
         4 001267   201123 116100                    CMPQ    PTR$,,AUTO
         4 001270   001221 602000 4                  TNC     s:20422

      524    20432    6                  END; /*  Length ok  */

      525    20433    5               END ; /* Do case( CODE2 ) */

  20433  4 001271   003400 710000 4                  TRA     s:20947

      526    20434                                                              /**/
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:82   
      527    20435    4            SELECT( TERM_PRO_VAL ) ;

      528    20436    5            IF PTR$->P$NODE.CODE = NONE_VAL THEN DO;

  20436  4 001272   100000 721100                    LXL1    0,,PR1
         4 001273   000007 101003                    CMPX1   7,DU
         4 001274   001305 601000 4                  TNZ     s:20441

      529    20437    5               KL$TREC.PNAME.CNT=0;

  20437  4 001275   201141 473500                    LDP3    TREC$,,AUTO
         4 001276   000000 236003                    LDQ     0,DU
         4 001277   300004 552140                    STBQ    4,'40'O,PR3

      530    20438    5               KL$TREC.PNAME.TXT=' ';

  20438  4 001300   201141 473500                    LDP3    TREC$,,AUTO
         4 001301   040100 100400                    MLR     fill='040'O
         4 001302   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001303   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11

      531    20439    5               GOTO TERM_LOOP;

  20439  4 001304   000767 710000 4                  TRA     TERM_LOOP

      532    20440    5               END;  /*  Profile none  */
      533    20441    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) ;

  20441  4 001305   100003 236100                    LDQ     3,,PR1
         4 001306   200005 756100                    STQ     BLK$,,AUTO

      534    20442    4            IF OUT$SYM.COUNT > 11

  20442  4 001307   200005 473500                    LDP3    BLK$,,AUTO
         4 001310   300004 236100                    LDQ     4,,PR3
         4 001311   777000 376003                    ANQ     -512,DU
         4 001312   014000 116003                    CMPQ    6144,DU
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:83   
         4 001313   001321 602000 4                  TNC     s:20462

      535    20443    4            THEN
      536    20444    5            DO ;

      537    20445                    %SCREAM( ERR#=E$PRO_TOO_LONG, LEVEL=ERROR, MID='A') ;

  20457  4 001314   000026 630400 5                  EPPR0   22
         4 001315   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001316   000000 701000 xent               TSX1    ASH$ERROR
         4 001317   000000 011000                    NOP     0

      538    20460    5               GOTO TERM_LOOP ;

  20460  4 001320   000767 710000 4                  TRA     TERM_LOOP

      539    20461    5               END ;    /* Then do */
      540    20462    4            PRO$ = ADDR(PRO_BUF);

  20462  4 001321   200523 634500                    EPPR4   PRO_BUF,,AUTO
         4 001322   200522 454500                    STP4    PRO$,,AUTO

      541    20463    4            ARS = LENGTHC(PRO_BUF);

  20463  4 001323   002000 235007                    LDA     1024,DL
         4 001324   200003 755100                    STA     ARS,,AUTO

      542    20464    4            USERS_KEY.COUNT=OUT$SYM.COUNT;

  20464  4 001325   300004 236100                    LDQ     4,,PR3
         4 001326   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      543    20465    4            USERS_KEY.TXTC=OUT$SYM.TEXT;

  20465  4 001327   300004 236100                    LDQ     4,,PR3
         4 001330   000033 772000                    QRL     27
         4 001331   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:84   
         4 001332   040000 100540                    MLR     fill='040'O
         4 001333   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 001334   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      544    20466    4            CALL ASD$READ_PRO(USERS_KEY,KL$PHDR,ARS) ALTRET(TERM_PRO_ERR);

  20466  4 001335   200003 635500                    EPPR5   ARS,,AUTO
         4 001336   201152 455500                    STP5    KL$UBWORD+3,,AUTO
         4 001337   200522 236100                    LDQ     PRO$,,AUTO
         4 001340   000027 235000 5                  LDA     23
         4 001341   201150 757100                    STAQ    KL$UBWORD+1,,AUTO
         4 001342   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 001343   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001344   000000 701000 xent               TSX1    ASD$READ_PRO
         4 001345   003522 702000 4                  TSX2    TERM_PRO_ERR

      545    20467    5            IF KL$PHDR.TTYP ~= %KLTY_STRM# THEN DO;

  20467  4 001346   200522 470500                    LDP0    PRO$,,AUTO
         4 001347   000100 101500                    MRL     fill='000'O
         4 001350   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 001351   201150 000004                    ADSC9   KL$UBWORD+1,,AUTO        cn=0,n=4
         4 001352   201150 236100                    LDQ     KL$UBWORD+1,,AUTO
         4 001353   000003 116007                    CMPQ    3,DL
         4 001354   001362 600000 4                  TZE     s:20494

      546    20468        /*E* ERROR: ASA-E$TERMPROTYPE-0
      547    20469             MESSAGE: You must specify a profile that defines a terminal.
      548    20470             MESSAGE1: Examples: PRO=IRBT, PRO=2780, PRO=STDHASP.
      549    20471        */
      550    20472                    %SCREAM( ERR#=E$TERMPROTYPE, LEVEL=ERROR, MID='A' );

  20484  4 001355   000030 630400 5                  EPPR0   24
         4 001356   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001357   000000 701000 xent               TSX1    ASH$ERROR
         4 001360   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:85   
      551    20487    5               GOTO TERM_LOOP;

  20487  4 001361   000767 710000 4                  TRA     TERM_LOOP

      552    20488    5               END;
      553    20489        /*
      554    20490            Find the trmd portion of the profile just read in.
      555    20491            It contains a profile type for stream type profiles.
      556    20492            Compare that to the terminal type.
      557    20493        */
      558    20494    4            PP$ = PRO$;

  20494  4 001362   200522 236100                    LDQ     PRO$,,AUTO
         4 001363   200516 756100                    STQ     PP$,,AUTO

      559    20495    4            PP_END$ = PINCRC( PP$, ARS ) ;

  20495  4 001364   200003 236100                    LDQ     ARS,,AUTO
         4 001365   000020 736000                    QLS     16
         4 001366   200516 036100                    ADLQ    PP$,,AUTO
         4 001367   200520 756100                    STQ     PP_END$,,AUTO

      560    20496    4            PP$ = PINCRW( PP$, SIZEW( KL$PHDR ) ) ;

  20496  4 001370   200516 236100                    LDQ     PP$,,AUTO
         4 001371   000024 036003                    ADLQ    20,DU
         4 001372   200516 756100                    STQ     PP$,,AUTO

      561    20497    5            DO WHILE ( PP$ < PP_END$ ) ;

  20497  4 001373   200520 116100                    CMPQ    PP_END$,,AUTO
         4 001374   001431 603000 4                  TRC     FOUND_IT

      562    20498    5               PP_TYPE = PP$STRCT.TYPE ;

  20498  4 001375   200516 470500                    LDP0    PP$,,AUTO
         4 001376   003100 061500                    CSR     bolr='003'O
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:86   
         4 001377   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001400   200521 000044                    BDSC    PP_TYPE,,AUTO            by=0,bit=0,n=36

      563    20499    5               PP_SIZE = PP$STRCT.SIZE ;

  20499  4 001401   003100 061500                    CSR     bolr='003'O
         4 001402   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         4 001403   200517 000044                    BDSC    PP_SIZE,,AUTO            by=0,bit=0,n=36

      564    20500    5               PP$ = PINCRC( PP$, 2 ) ;

  20500  4 001404   200516 236100                    LDQ     PP$,,AUTO
         4 001405   400000 036007                    ADLQ    -131072,DL
         4 001406   200516 756100                    STQ     PP$,,AUTO

      565    20501
      566    20502    6               DO SELECT( PP_TYPE ) ;

  20502  4 001407   200521 235100                    LDA     PP_TYPE,,AUTO
         4 001410   000015 115007                    CMPA    13,DL
         4 001411   001414 601000 4                  TNZ     s:20509
         4 001412   001413 710000 4                  TRA     s:20505

      567    20503
      568    20504    6                  SELECT( %KL_PRMID_TRMD ) ;

      569    20505    6                  GOTO FOUND_IT;

  20505  4 001413   001431 710000 4                  TRA     FOUND_IT

      570    20506
      571    20507    6                  END ; /*  Do case  */

      572    20508
      573    20509    5               I = PP_SIZE + (MOD (PP_SIZE, 2)); /* Force i to be even */

  20509  4 001414   200517 236100                    LDQ     PP_SIZE,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:87   
         4 001415   000001 376007                    ANQ     1,DL
         4 001416   200517 036100                    ADLQ    PP_SIZE,,AUTO
         4 001417   200502 756100                    STQ     I,,AUTO

      574    20510    5               L = PP_SIZE + (MOD (PP_SIZE, 2)); /* Force l to be even */

  20510  4 001420   200517 236100                    LDQ     PP_SIZE,,AUTO
         4 001421   000001 376007                    ANQ     1,DL
         4 001422   200517 036100                    ADLQ    PP_SIZE,,AUTO
         4 001423   200505 756100                    STQ     L,,AUTO

      575    20511    5               PP$ = PINCRC ( PP$, L ) ;

  20511  4 001424   000020 736000                    QLS     16
         4 001425   200516 036100                    ADLQ    PP$,,AUTO
         4 001426   200516 756100                    STQ     PP$,,AUTO

      576    20512
      577    20513    5               END ; /*  Do while  */

  20513  4 001427   200520 116100                    CMPQ    PP_END$,,AUTO
         4 001430   001375 602000 4                  TNC     s:20498

      578    20514
      579    20515    4   FOUND_IT:
      580    20516        /*  Compare terminal type against profile type, if not = error */
      581    20517    4            IF (PP$ -> KL$TRMD.PROTYP# = %PT_HASP_VAL AND NOT TERM_T = 'STDHASP')

  20517  4 001431   200516 470500       FOUND_IT     LDP0    PP$,,AUTO
         4 001432   003100 061500                    CSR     bolr='003'O
         4 001433   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001434   201150 000044                    BDSC    KL$UBWORD+1,,AUTO        by=0,bit=0,n=36
         4 001435   201150 236100                    LDQ     KL$UBWORD+1,,AUTO
         4 001436   000003 116007                    CMPQ    3,DL
         4 001437   001444 601000 4                  TNZ     FOUND_IT+11
         4 001440   040000 106500                    CMPC    fill='040'O
         4 001441   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:88   
         4 001442   000133 000007 3                  ADSC9   TERM_TYPE_A+17           cn=0,n=7
         4 001443   001502 601000 4                  TNZ     s:20526
         4 001444   003100 061500                    CSR     bolr='003'O
         4 001445   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001446   201151 000044                    BDSC    KL$UBWORD+2,,AUTO        by=0,bit=0,n=36
         4 001447   201151 236100                    LDQ     KL$UBWORD+2,,AUTO
         4 001450   000007 116007                    CMPQ    7,DL
         4 001451   001456 601000 4                  TNZ     FOUND_IT+21
         4 001452   040000 106500                    CMPC    fill='040'O
         4 001453   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7
         4 001454   000133 000007 3                  ADSC9   TERM_TYPE_A+17           cn=0,n=7
         4 001455   001502 601000 4                  TNZ     s:20526
         4 001456   003100 061500                    CSR     bolr='003'O
         4 001457   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001460   201152 000044                    BDSC    KL$UBWORD+3,,AUTO        by=0,bit=0,n=36
         4 001461   201152 236100                    LDQ     KL$UBWORD+3,,AUTO
         4 001462   000001 116007                    CMPQ    1,DL
         4 001463   001470 601000 4                  TNZ     FOUND_IT+31
         4 001464   040000 106500                    CMPC    fill='040'O
         4 001465   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7
         4 001466   000135 000007 3                  ADSC9   TERM_TYPE_A+19           cn=0,n=7
         4 001467   001502 601000 4                  TNZ     s:20526
         4 001470   003100 061500                    CSR     bolr='003'O
         4 001471   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001472   201153 000044                    BDSC    KL$UBWORD+4,,AUTO        by=0,bit=0,n=36
         4 001473   201153 236100                    LDQ     KL$UBWORD+4,,AUTO
         4 001474   000002 116007                    CMPQ    2,DL
         4 001475   001617 601000 4                  TNZ     s:20566
         4 001476   040000 106500                    CMPC    fill='040'O
         4 001477   201137 000007                    ADSC9   TERM_T,,AUTO             cn=0,n=7
         4 001500   000137 000007 3                  ADSC9   TERM_TYPE_A+21           cn=0,n=7
         4 001501   001617 600000 4                  TZE     s:20566

      582    20518    4                 OR (PP$ -> KL$TRMD.PROTYP# = %PT_NJE_VAL AND NOT TERM_T = 'STDHASP')
      583    20519    4                 OR (PP$ -> KL$TRMD.PROTYP# = %PT_2780_VAL AND NOT TERM_T = 'STD2780')
      584    20520    4                 OR (PP$ -> KL$TRMD.PROTYP# = %PT_3780_VAL AND NOT TERM_T = 'STD3780')
      585    20521    5            THEN DO;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:89   

      586    20522        /*E* ERROR: ASA-E$TYPE_DONT_MATCH-0
      587    20523             MESSAGE: Profile type doesn't match terminal type.
      588    20524             MESSAGE1: %U1 profile type is not the same as %U2 terminal type.
      589    20525        */
      590    20526    5               AS_FIELD1.COUNT = 6;

  20526  4 001502   006000 236003                    LDQ     3072,DU
         4 001503   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      591    20527    6               DO SELECT (PP$->KL$TRMD.PROTYP#);

  20527  4 001504   003100 061500                    CSR     bolr='003'O
         4 001505   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001506   201150 000044                    BDSC    KL$UBWORD+1,,AUTO        by=0,bit=0,n=36
         4 001507   201150 236100                    LDQ     KL$UBWORD+1,,AUTO
         4 001510   000004 116007                    CMPQ    4,DL
         4 001511   001531 602000 4                  TNC     s:20527+21
         4 001512   001572 600000 4                  TZE     s:20538
         4 001513   003100 061500                    CSR     bolr='003'O
         4 001514   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001515   201151 000044                    BDSC    KL$UBWORD+2,,AUTO        by=0,bit=0,n=36
         4 001516   201151 236100                    LDQ     KL$UBWORD+2,,AUTO
         4 001517   000006 116007                    CMPQ    6,DL
         4 001520   001605 602000 4                  TNC     s:20547
         4 001521   001576 600000 4                  TZE     s:20541
         4 001522   003100 061500                    CSR     bolr='003'O
         4 001523   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001524   201152 000044                    BDSC    KL$UBWORD+3,,AUTO        by=0,bit=0,n=36
         4 001525   201152 236100                    LDQ     KL$UBWORD+3,,AUTO
         4 001526   000007 116007                    CMPQ    7,DL
         4 001527   001605 601000 4                  TNZ     s:20547
         4 001530   001602 710000 4                  TRA     s:20544
         4 001531   003100 061500                    CSR     bolr='003'O
         4 001532   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001533   201153 000044                    BDSC    KL$UBWORD+4,,AUTO        by=0,bit=0,n=36
         4 001534   201153 236100                    LDQ     KL$UBWORD+4,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:90   
         4 001535   000002 116007                    CMPQ    2,DL
         4 001536   001547 602000 4                  TNC     s:20527+35
         4 001537   001566 600000 4                  TZE     s:20535
         4 001540   003100 061500                    CSR     bolr='003'O
         4 001541   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001542   201154 000044                    BDSC    KL$UBWORD+5,,AUTO        by=0,bit=0,n=36
         4 001543   201154 236100                    LDQ     KL$UBWORD+5,,AUTO
         4 001544   000003 116007                    CMPQ    3,DL
         4 001545   001605 601000 4                  TNZ     s:20547
         4 001546   001556 710000 4                  TRA     s:20529
         4 001547   003100 061500                    CSR     bolr='003'O
         4 001550   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 001551   201155 000044                    BDSC    KL$UBWORD+6,,AUTO        by=0,bit=0,n=36
         4 001552   201155 236100                    LDQ     KL$UBWORD+6,,AUTO
         4 001553   000001 116007                    CMPQ    1,DL
         4 001554   001605 601000 4                  TNZ     s:20547
         4 001555   001562 710000 4                  TRA     s:20532

      592    20528    6                  SELECT (%PT_HASP_VAL);

      593    20529    6                  AS_FIELD1.TEXT = 'HASP  ';

  20529  4 001556   040000 100400                    MLR     fill='040'O
         4 001557   000152 000006 3                  ADSC9   TERM_TYPE_A+32           cn=0,n=6
         4 001560   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 001561   001605 710000 4                  TRA     s:20547

      594    20530
      595    20531    6                  SELECT (%PT_2780_VAL);

      596    20532    6                  AS_FIELD1.TEXT = '2780  ';

  20532  4 001562   040000 100400                    MLR     fill='040'O
         4 001563   000154 000006 3                  ADSC9   TERM_TYPE_A+34           cn=0,n=6
         4 001564   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 001565   001605 710000 4                  TRA     s:20547

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:91   
      597    20533
      598    20534    6                  SELECT (%PT_3780_VAL);

      599    20535    6                  AS_FIELD1.TEXT = '3780  ';

  20535  4 001566   040000 100400                    MLR     fill='040'O
         4 001567   000156 000006 3                  ADSC9   TERM_TYPE_A+36           cn=0,n=6
         4 001570   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 001571   001605 710000 4                  TRA     s:20547

      600    20536
      601    20537    6                  SELECT (%PT_POLLED_VAL);

      602    20538    6                  AS_FIELD1.TEXT = 'POLLED';

  20538  4 001572   040000 100400                    MLR     fill='040'O
         4 001573   000160 000006 3                  ADSC9   TERM_TYPE_A+38           cn=0,n=6
         4 001574   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 001575   001605 710000 4                  TRA     s:20547

      603    20539
      604    20540    6                  SELECT (%PT_HIP_VAL);

      605    20541    6                  AS_FIELD1.TEXT = 'HIP   ';

  20541  4 001576   040000 100400                    MLR     fill='040'O
         4 001577   000162 000006 3                  ADSC9   TERM_TYPE_A+40           cn=0,n=6
         4 001600   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 001601   001605 710000 4                  TRA     s:20547

      606    20542
      607    20543    6                  SELECT (%PT_NJE_VAL);

      608    20544    6                  AS_FIELD1.TEXT = 'NJE   ';

  20544  4 001602   040000 100400                    MLR     fill='040'O
         4 001603   000164 000006 3                  ADSC9   TERM_TYPE_A+42           cn=0,n=6
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:92   
         4 001604   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      609    20545
      610    20546    6                  END; /*  Case protyp  */

      611    20547    5               AS_FIELD2.COUNT = 4;

  20547  4 001605   004000 236003                    LDQ     2048,DU
         4 001606   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      612    20548    5               AS_FIELD2.TEXT = SUBSTR (TERM_T,3,4);

  20548  4 001607   040000 100500                    MLR     fill='040'O
         4 001610   201137 600004                    ADSC9   TERM_T,,AUTO             cn=3,n=4
         4 001611   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      613    20549                    %SCREAM (ERR#=%E$TYPE_DONT_MATCH, LEVEL=ERROR, MID='A');

  20561  4 001612   000031 630400 5                  EPPR0   25
         4 001613   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001614   000000 701000 xent               TSX1    ASH$ERROR
         4 001615   000000 011000                    NOP     0

      614    20564    5               GOTO TERM_LOOP;

  20564  4 001616   000767 710000 4                  TRA     TERM_LOOP

      615    20565    5               END;
      616    20566    4            KL$TREC.PNAME.CNT = OUT$SYM.COUNT ;

  20566  4 001617   200005 471500                    LDP1    BLK$,,AUTO
         4 001620   201141 473500                    LDP3    TREC$,,AUTO
         4 001621   100004 236100                    LDQ     4,,PR1
         4 001622   300004 552140                    STBQ    4,'40'O,PR3

      617    20567    4            KL$TREC.PNAME.TXT = OUT$SYM.TEXT ;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:93   
  20567  4 001623   100004 236100                    LDQ     4,,PR1
         4 001624   000033 772000                    QRL     27
         4 001625   000000 620006                    EAX0    0,QL
         4 001626   201141 473500                    LDP3    TREC$,,AUTO
         4 001627   040100 100540                    MLR     fill='040'O
         4 001630   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 001631   300004 200013                    ADSC9   4,,PR3                   cn=1,n=11
         4 001632   003400 710000 4                  TRA     s:20947

      618    20568                                                              /**/
      619    20569    4            SELECT( TERM_CON_VAL ) ;

      620    20570    4            CONSOLE_FLG = AS_TRUE ;

  20570  4 001633   000000 236000 xsym               LDQ     AS_TRUE
         4 001634   400000 376003                    ANQ     -131072,DU
         4 001635   200012 756100                    STQ     CONSOLE_FLG,,AUTO

      621    20571    4            TWSN_INDEX = KL$TWSNREC.NDEV ;

  20571  4 001636   201143 473500                    LDP3    TWSNR$,,AUTO
         4 001637   300004 235100                    LDA     4,,PR3
         4 001640   201146 755100                    STA     TWSN_INDEX,,AUTO

      622    20572    4            KL$HASPDEV = KL_HASPDEV;

  20572  4 001641   200501 474500                    LDP4    HASPDEV$,,AUTO
         4 001642   000100 100400                    MLR     fill='000'O
         4 001643   000000 000034 3                  ADSC9   KL_HASPDEV               cn=0,n=28
         4 001644   400000 000034                    ADSC9   0,,PR4                   cn=0,n=28

      623    20573    4            KL$HASPDEV.BLKHDR.LEV = 2;

  20573  4 001645   002000 236003                    LDQ     1024,DU
         4 001646   400000 552140                    STBQ    0,'40'O,PR4

      624    20574    4            KL$HASPDEV.BLKHDR.BLKTYP = %KLTY_SDEV#;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:94   

  20574  4 001647   001000 236003                    LDQ     512,DU
         4 001650   400001 552140                    STBQ    1,'40'O,PR4

      625    20575    4            LNG_CNT = LENGTHC( KL_HASPDEV );

  20575  4 001651   000034 235007                    LDA     28,DL
         4 001652   000120 755000 2                  STA     LNGTH

      626    20576    4            KL$UBWORD.REPLACE.T = LNGTH.T;

  20576  4 001653   000120 236000 2                  LDQ     LNGTH
         4 001654   000001 736000                    QLS     1
         4 001655   201147 676100                    ERQ     KL$UBWORD,,AUTO
         4 001656   377000 376007                    ANQ     130560,DL
         4 001657   201147 656100                    ERSQ    KL$UBWORD,,AUTO

      627    20577    4            KL$UBWORD.REPLACE.B = LNGTH.B;

  20577  4 001660   000120 236000 2                  LDQ     LNGTH
         4 001661   201147 676100                    ERQ     KL$UBWORD,,AUTO
         4 001662   000377 376007                    ANQ     255,DL
         4 001663   201147 656100                    ERSQ    KL$UBWORD,,AUTO

      628    20578    4            KL$HASPDEV.BLKHDR.LEN.BYT(0) = KL$UBWORD.REPLACE.T;

  20578  4 001664   201147 236100                    LDQ     KL$UBWORD,,AUTO
         4 001665   400000 676100                    ERQ     0,,PR4
         4 001666   377000 376007                    ANQ     130560,DL
         4 001667   400000 656100                    ERSQ    0,,PR4

      629    20579    4            KL$HASPDEV.BLKHDR.LEN.BYT(1) = KL$UBWORD.REPLACE.B;

  20579  4 001670   201147 236100                    LDQ     KL$UBWORD,,AUTO
         4 001671   400000 676100                    ERQ     0,,PR4
         4 001672   000377 376007                    ANQ     255,DL
         4 001673   400000 656100                    ERSQ    0,,PR4
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:95   

      630    20580    4            KL$HASPDEV.BLKHDR.DEVNUM = KL$TREC.HASP.BLKHDR.NSUBS+1;

  20580  4 001674   201141 470500                    LDP0    TREC$,,AUTO
         4 001675   000054 236100                    LDQ     44,,PR0
         4 001676   000022 772000                    QRL     18
         4 001677   000777 376007                    ANQ     511,DL
         4 001700   000001 036007                    ADLQ    1,DL
         4 001701   000011 736000                    QLS     9
         4 001702   400001 552110                    STBQ    1,'10'O,PR4

      631    20581    4            KL$HASPDEV.TERMID.TERM.TERM_NAME = TERM_KEY.TXT.ACCT;

  20581  4 001703   040100 100400                    MLR     fill='040'O
         4 001704   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 001705   400004 000010                    ADSC9   4,,PR4                   cn=0,n=8

      632    20582    4            KL$HASPDEV.TERMID.LEV = 2;

  20582  4 001706   000002 236003                    LDQ     2,DU
         4 001707   400002 552120                    STBQ    2,'20'O,PR4

      633    20583    4            LNG_CNT = KL$HASPDEV.BLKHDR.DEVNUM;

  20583  4 001710   400001 236100                    LDQ     1,,PR4
         4 001711   000011 772000                    QRL     9
         4 001712   000777 376007                    ANQ     511,DL
         4 001713   000120 756000 2                  STQ     LNGTH

      634    20584    4            KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT(0) = LNGTH.T;

  20584  4 001714   000120 236000 2                  LDQ     LNGTH
         4 001715   000023 736000                    QLS     19
         4 001716   400003 676100                    ERQ     3,,PR4
         4 001717   377000 376003                    ANQ     130560,DU
         4 001720   400003 656100                    ERSQ    3,,PR4

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:96   
      635    20585    4            KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT(1) = LNGTH.B;

  20585  4 001721   000120 236000 2                  LDQ     LNGTH
         4 001722   000022 736000                    QLS     18
         4 001723   400003 676100                    ERQ     3,,PR4
         4 001724   000377 376003                    ANQ     255,DU
         4 001725   400003 656100                    ERSQ    3,,PR4

      636    20586    4            DADR$ = ADDR (KL$HASPDEV.DADR);

  20586  4 001726   200501 236100                    LDQ     HASPDEV$,,AUTO
         4 001727   000006 036003                    ADLQ    6,DU
         4 001730   200014 756100                    STQ     DADR$,,AUTO

      637    20587    4            CALL ASA$CON_OPTS(DREC$,TWSNR$,TWSNC,'1'B,'1'B,TERM_T,LOCAL,TWSN_INDEX,
             20587                     KL_SS,DADR$);

  20587  4 001731   200014 630500                    EPPR0   DADR$,,AUTO
         4 001732   201161 450500                    STP0    KL$UBWORD+10,,AUTO
         4 001733   000033 236000 5                  LDQ     27
         4 001734   201160 756100                    STQ     KL$UBWORD+9,,AUTO
         4 001735   201146 633500                    EPPR3   TWSN_INDEX,,AUTO
         4 001736   201157 453500                    STP3    KL$UBWORD+8,,AUTO
         4 001737   200506 635500                    EPPR5   LOCAL,,AUTO
         4 001740   201156 455500                    STP5    KL$UBWORD+7,,AUTO
         4 001741   201137 636500                    EPPR6   TERM_T,,AUTO
         4 001742   201155 456500                    STP6    KL$UBWORD+6,,AUTO
         4 001743   000034 236000 5                  LDQ     28
         4 001744   201154 756100                    STQ     KL$UBWORD+5,,AUTO
         4 001745   201153 756100                    STQ     KL$UBWORD+4,,AUTO
         4 001746   201142 637500                    EPPR7   TWSNC,,AUTO
         4 001747   201152 457500                    STP7    KL$UBWORD+3,,AUTO
         4 001750   201143 630500                    EPPR0   TWSNR$,,AUTO
         4 001751   201151 450500                    STP0    KL$UBWORD+2,,AUTO
         4 001752   200442 630500                    EPPR0   DREC$,,AUTO
         4 001753   201150 450500                    STP0    KL$UBWORD+1,,AUTO
         4 001754   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:97   
         4 001755   000032 631400 5                  EPPR1   26
         4 001756   000000 701000 xent               TSX1    ASA$CON_OPTS
         4 001757   000000 011000                    NOP     0

      638    20588    4            KL$TREC.HASP.BLKHDR.NSUBS = KL$TREC.HASP.BLKHDR.NSUBS+1;

  20588  4 001760   201141 470500                    LDP0    TREC$,,AUTO
         4 001761   000054 236100                    LDQ     44,,PR0
         4 001762   000001 036003                    ADLQ    1,DU
         4 001763   000054 552120                    STBQ    44,'20'O,PR0

      639    20589    4            DREC$->KL$TREC.FLAGS.RNME='0'B;

  20589  4 001764   200442 470500                    LDP0    DREC$,,AUTO
         4 001765   000035 236000 5                  LDQ     29
         4 001766   000000 356100                    ANSQ    0,,PR0

      640    20590    4            DREC$->KL$TREC.TNAME=TERM_KEY.TXT.ACCT ;

  20590  4 001767   200442 470500                    LDP0    DREC$,,AUTO
         4 001770   040100 100400                    MLR     fill='040'O
         4 001771   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 001772   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8

      641    20591    4            DREC$->KL$TREC.SNAME=SNAME ;

  20591  4 001773   200442 470500                    LDP0    DREC$,,AUTO
         4 001774   201126 237100                    LDAQ    SNAME,,AUTO
         4 001775   000015 755100                    STA     13,,PR0
         4 001776   000016 756100                    STQ     14,,PR0

      642    20592    4            ARS = DREC$->KL$TREC.NWINFO * 4  +  LENGTHC(KL_DREC_CNT) ;

  20592  4 001777   200442 470500                    LDP0    DREC$,,AUTO
         4 002000   000017 235100                    LDA     15,,PR0
         4 002001   000002 735000                    ALS     2
         4 002002   000100 035007                    ADLA    64,DL
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:98   
         4 002003   200003 755100                    STA     ARS,,AUTO

      643    20593    4            USERS_KEY.COUNT = 8 ;

  20593  4 002004   010000 236003                    LDQ     4096,DU
         4 002005   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      644    20594    4            USERS_KEY.TXTC = FROM_KEY.TEXT ;

  20594  4 002006   040000 100400                    MLR     fill='040'O
         4 002007   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20
         4 002010   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      645    20595    4            CALL ASB$WRITE_HLP(DREC$,ARS) ALTRET(WRITE_TREC_ERR) ;

  20595  4 002011   200003 631500                    EPPR1   ARS,,AUTO
         4 002012   201151 451500                    STP1    KL$UBWORD+2,,AUTO
         4 002013   200442 633500                    EPPR3   DREC$,,AUTO
         4 002014   201150 453500                    STP3    KL$UBWORD+1,,AUTO
         4 002015   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002017   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 002020   003510 702000 4                  TSX2    READ_CHAIN_ERR

      646    20596    4            KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = TERM_KEY.TXT.ACCT ;

  20596  4 002021   201146 236100                    LDQ     TWSN_INDEX,,AUTO
         4 002022   000013 402007                    MPY     11,DL
         4 002023   000002 736000                    QLS     2
         4 002024   201143 470500                    LDP0    TWSNR$,,AUTO
         4 002025   040106 100400                    MLR     fill='040'O
         4 002026   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 002027   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8

      647    20597    4            KL$TWSNREC.NDEV = TWSN_INDEX + 1 ;

  20597  4 002030   201143 470500                    LDP0    TWSNR$,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:99   
         4 002031   201146 235100                    LDA     TWSN_INDEX,,AUTO
         4 002032   000001 035007                    ADLA    1,DL
         4 002033   000004 755100                    STA     4,,PR0

      648    20598    4            TWSN_ARS = TWSN_ARS + LENGTHC(KL$TWSNREC.DEVS(0));

  20598  4 002034   201145 235100                    LDA     TWSN_ARS,,AUTO
         4 002035   000054 035007                    ADLA    44,DL
         4 002036   201145 755100                    STA     TWSN_ARS,,AUTO

      649    20599    4            CALL ASB$WRITE_LO( AS_CREATED_TEXT, LENGTHC(AS_CREATED_TEXT));

  20599  4 002037   000037 630400 5                  EPPR0   31
         4 002040   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002041   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002042   000000 011000                    NOP     0

      650    20600    4            CONFIG_KEY.TERMID = KL$HASPDEV.TERMID;

  20600  4 002043   200501 470500                    LDP0    HASPDEV$,,AUTO
         4 002044   000000 100500                    MLR     fill='000'O
         4 002045   000002 000020                    ADSC9   2,,PR0                   cn=0,n=16
         4 002046   000000 600020 2                  ADSC9   CONFIG_KEY               cn=3,n=16

      651    20601    4            LINCNFG_BUF = '0'B;

  20601  4 002047   000000 100400                    MLR     fill='000'O
         4 002050   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 002051   000036 000310 2                  ADSC9   LINCNFG_BUF              cn=0,n=200

      652    20602    4            LINCNFG.KHA = KL_HNDCMN;

  20602  4 002052   000035 471400 2                  LDP1    LINCNFG$
         4 002053   000100 100400                    MLR     fill='000'O
         4 002054   000005 000022 2                  ADSC9   KL_HNDCMN                cn=0,n=18
         4 002055   100000 000022                    ADSC9   0,,PR1                   cn=0,n=18

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:100  
      653    20603    4            LINCNFG.NA = KL_NA;

  20603  4 002056   000100 100400                    MLR     fill='000'O
         4 002057   000012 000010 2                  ADSC9   KL_NA                    cn=0,n=8
         4 002060   100004 400010                    ADSC9   4,,PR1                   cn=2,n=8

      654    20604    4            LINCNFG.NA.SNDSLT = '0'B;

  20604  4 002061   000041 236000 5                  LDQ     33
         4 002062   100004 356100                    ANSQ    4,,PR1

      655    20605    4            LINCNFG.NA.AUTLGN = '1'B;

  20605  4 002063   100004 236100                    LDQ     4,,PR1
         4 002064   000042 376000 5                  ANQ     34
         4 002065   010000 276007                    ORQ     4096,DL
         4 002066   100004 756100                    STQ     4,,PR1

      656    20606    4            LINCNFG.LGN.LGNSIZE = KL_SS.CNT;

  20606  4 002067   000014 236000 2                  LDQ     KL_SS
         4 002070   000022 772000                    QRL     18
         4 002071   100012 552110                    STBQ    10,'10'O,PR1

      657    20607    4            LINCNFG.LGN.LGNSTRING = KL_SS.SGN_R;

  20607  4 002072   100012 236100                    LDQ     10,,PR1
         4 002073   000011 772000                    QRL     9
         4 002074   000777 376007                    ANQ     511,DL
         4 002075   000000 620006                    EAX0    0,QL
         4 002076   040140 100400                    MLR     fill='040'O
         4 002077   000014 200032 2                  ADSC9   KL_SS                    cn=1,n=26
         4 002100   100012 600010                    ADSC9   10,,PR1                  cn=3,n=*X0

      658    20608    4           CALL ASB$WRITE_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG)) ALTRET(NETCON_ERR
             20608                     );

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:101  
  20608  4 002101   000053 621010                    EAX1    43,X0
         4 002102   000000 635011                    EAA     0,X1
         4 002103   000002 771000                    ARL     2
         4 002104   000140 135007                    SBLA    96,DL
         4 002105   000035 236000 2                  LDQ     LINCNFG$
         4 002106   201150 757100                    STAQ    KL$UBWORD+1,,AUTO
         4 002107   201150 633500                    EPPR3   KL$UBWORD+1,,AUTO
         4 002110   201153 453500                    STP3    KL$UBWORD+4,,AUTO
         4 002111   000043 236000 5                  LDQ     35
         4 002112   201152 756100                    STQ     KL$UBWORD+3,,AUTO
         4 002113   201152 630500                    EPPR0   KL$UBWORD+3,,AUTO
         4 002114   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002115   000000 701000 xent               TSX1    ASB$WRITE_NETCON
         4 002116   003532 702000 4                  TSX2    NETCON_ERR

      659    20609    4            HASPDEV$ = PINCRW(HASPDEV$, SIZEW(KL_HASPDEV));

  20609  4 002117   200501 236100                    LDQ     HASPDEV$,,AUTO
         4 002120   000007 036003                    ADLQ    7,DU
         4 002121   200501 756100                    STQ     HASPDEV$,,AUTO
         4 002122   003400 710000 4                  TRA     s:20947

      660    20610                                                              /**/
      661    20611    4            SELECT( TERM_DEV_VAL ) ;

      662    20612    4            CONSOLE_FLG = AS_FALSE ;

  20612  4 002123   000000 236000 xsym               LDQ     AS_FALSE
         4 002124   400000 376003                    ANQ     -131072,DU
         4 002125   200012 756100                    STQ     CONSOLE_FLG,,AUTO

      663    20613    4            TWSN_INDEX = KL$TWSNREC.NDEV ;

  20613  4 002126   201143 473500                    LDP3    TWSNR$,,AUTO
         4 002127   300004 235100                    LDA     4,,PR3
         4 002130   201146 755100                    STA     TWSN_INDEX,,AUTO

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:102  
      664    20614    4            KL$HASPDEV = KL_HASPDEV;

  20614  4 002131   200501 474500                    LDP4    HASPDEV$,,AUTO
         4 002132   000100 100400                    MLR     fill='000'O
         4 002133   000000 000034 3                  ADSC9   KL_HASPDEV               cn=0,n=28
         4 002134   400000 000034                    ADSC9   0,,PR4                   cn=0,n=28

      665    20615    4            KL$HASPDEV.BLKHDR.LEV = 2;

  20615  4 002135   002000 236003                    LDQ     1024,DU
         4 002136   400000 552140                    STBQ    0,'40'O,PR4

      666    20616    4            KL$HASPDEV.BLKHDR.BLKTYP = %KLTY_SDEV#;

  20616  4 002137   001000 236003                    LDQ     512,DU
         4 002140   400001 552140                    STBQ    1,'40'O,PR4

      667    20617    4            LNG_CNT = LENGTHC( KL_HASPDEV );

  20617  4 002141   000034 235007                    LDA     28,DL
         4 002142   000120 755000 2                  STA     LNGTH

      668    20618    4            KL$UBWORD.REPLACE.T = LNGTH.T;

  20618  4 002143   000120 236000 2                  LDQ     LNGTH
         4 002144   000001 736000                    QLS     1
         4 002145   201147 676100                    ERQ     KL$UBWORD,,AUTO
         4 002146   377000 376007                    ANQ     130560,DL
         4 002147   201147 656100                    ERSQ    KL$UBWORD,,AUTO

      669    20619    4            KL$UBWORD.REPLACE.B = LNGTH.B;

  20619  4 002150   000120 236000 2                  LDQ     LNGTH
         4 002151   201147 676100                    ERQ     KL$UBWORD,,AUTO
         4 002152   000377 376007                    ANQ     255,DL
         4 002153   201147 656100                    ERSQ    KL$UBWORD,,AUTO

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:103  
      670    20620    4            KL$HASPDEV.BLKHDR.LEN.BYT(0) = KL$UBWORD.REPLACE.T;

  20620  4 002154   201147 236100                    LDQ     KL$UBWORD,,AUTO
         4 002155   400000 676100                    ERQ     0,,PR4
         4 002156   377000 376007                    ANQ     130560,DL
         4 002157   400000 656100                    ERSQ    0,,PR4

      671    20621    4            KL$HASPDEV.BLKHDR.LEN.BYT(1) = KL$UBWORD.REPLACE.B;

  20621  4 002160   201147 236100                    LDQ     KL$UBWORD,,AUTO
         4 002161   400000 676100                    ERQ     0,,PR4
         4 002162   000377 376007                    ANQ     255,DL
         4 002163   400000 656100                    ERSQ    0,,PR4

      672    20622    4            KL$HASPDEV.BLKHDR.DEVNUM = KL$TREC.HASP.BLKHDR.NSUBS+1;

  20622  4 002164   201141 470500                    LDP0    TREC$,,AUTO
         4 002165   000054 236100                    LDQ     44,,PR0
         4 002166   000022 772000                    QRL     18
         4 002167   000777 376007                    ANQ     511,DL
         4 002170   000001 036007                    ADLQ    1,DL
         4 002171   000011 736000                    QLS     9
         4 002172   400001 552110                    STBQ    1,'10'O,PR4

      673    20623    4            KL$HASPDEV.TERMID.TERM.TERM_NAME = TERM_KEY.TXT.ACCT;

  20623  4 002173   040100 100400                    MLR     fill='040'O
         4 002174   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 002175   400004 000010                    ADSC9   4,,PR4                   cn=0,n=8

      674    20624    4            KL$HASPDEV.TERMID.LEV = 2;

  20624  4 002176   000002 236003                    LDQ     2,DU
         4 002177   400002 552120                    STBQ    2,'20'O,PR4

      675    20625    4            LNG_CNT = KL$HASPDEV.BLKHDR.DEVNUM;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:104  
  20625  4 002200   400001 236100                    LDQ     1,,PR4
         4 002201   000011 772000                    QRL     9
         4 002202   000777 376007                    ANQ     511,DL
         4 002203   000120 756000 2                  STQ     LNGTH

      676    20626    4            KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT(0) = LNGTH.T;

  20626  4 002204   000120 236000 2                  LDQ     LNGTH
         4 002205   000023 736000                    QLS     19
         4 002206   400003 676100                    ERQ     3,,PR4
         4 002207   377000 376003                    ANQ     130560,DU
         4 002210   400003 656100                    ERSQ    3,,PR4

      677    20627    4            KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT(1) = LNGTH.B;

  20627  4 002211   000120 236000 2                  LDQ     LNGTH
         4 002212   000022 736000                    QLS     18
         4 002213   400003 676100                    ERQ     3,,PR4
         4 002214   000377 376003                    ANQ     255,DU
         4 002215   400003 656100                    ERSQ    3,,PR4

      678    20628    4            DADR$ = ADDR (KL$HASPDEV.DADR);

  20628  4 002216   200501 236100                    LDQ     HASPDEV$,,AUTO
         4 002217   000006 036003                    ADLQ    6,DU
         4 002220   200014 756100                    STQ     DADR$,,AUTO

      679    20629    4            CALL ASA$DEV_OPTS(DREC$,TWSNR$,TWSNC,'1'B,'1'B,TERM_T,TWSN_INDEX,KL_SS,
             20629                     DADR$)

  20629  4 002221   200014 630500                    EPPR0   DADR$,,AUTO
         4 002222   201160 450500                    STP0    KL$UBWORD+9,,AUTO
         4 002223   000033 236000 5                  LDQ     27
         4 002224   201157 756100                    STQ     KL$UBWORD+8,,AUTO
         4 002225   201146 633500                    EPPR3   TWSN_INDEX,,AUTO
         4 002226   201156 453500                    STP3    KL$UBWORD+7,,AUTO
         4 002227   201137 635500                    EPPR5   TERM_T,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:105  
         4 002230   201155 455500                    STP5    KL$UBWORD+6,,AUTO
         4 002231   000034 236000 5                  LDQ     28
         4 002232   201154 756100                    STQ     KL$UBWORD+5,,AUTO
         4 002233   201153 756100                    STQ     KL$UBWORD+4,,AUTO
         4 002234   201142 636500                    EPPR6   TWSNC,,AUTO
         4 002235   201152 456500                    STP6    KL$UBWORD+3,,AUTO
         4 002236   201143 637500                    EPPR7   TWSNR$,,AUTO
         4 002237   201151 457500                    STP7    KL$UBWORD+2,,AUTO
         4 002240   200442 630500                    EPPR0   DREC$,,AUTO
         4 002241   201150 450500                    STP0    KL$UBWORD+1,,AUTO
         4 002242   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002243   000046 631400 5                  EPPR1   38
         4 002244   000000 701000 xent               TSX1    ASA$DEV_OPTS
         4 002245   002425 702000 4                  TSX2    s:20657

      680    20630    5            WHENRETURN DO;

      681    20631    6               IF KL_SS.SGN.TYPE ~='CG' THEN DO ;

  20631  4 002246   040000 106400                    CMPC    fill='040'O
         4 002247   000014 200002 2                  ADSC9   KL_SS                    cn=1,n=2
         4 002250   000167 000002 3                  ADSC9   TERM_TYPE_A+45           cn=0,n=2
         4 002251   002262 600000 4                  TZE     s:20635

      682    20632    6                  DREC$->KL$TREC.RENAME=' ';

  20632  4 002252   200442 470500                    LDP0    DREC$,,AUTO
         4 002253   000035 235000 xsym               LDA     B_VECTNIL+29
         4 002254   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 002255   000011 755100                    STA     9,,PR0
         4 002256   000012 756100                    STQ     10,,PR0

      683    20633    6                  DREC$->KL$TREC.FLAGS.RNME='0'B;

  20633  4 002257   200442 470500                    LDP0    DREC$,,AUTO
         4 002260   000035 236000 5                  LDQ     29
         4 002261   000000 356100                    ANSQ    0,,PR0
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:106  

      684    20634    6                  END;    /* Do  */

      685    20635    5               KL$TREC.HASP.BLKHDR.NSUBS = KL$TREC.HASP.BLKHDR.NSUBS+1;

  20635  4 002262   201141 470500                    LDP0    TREC$,,AUTO
         4 002263   000054 236100                    LDQ     44,,PR0
         4 002264   000001 036003                    ADLQ    1,DU
         4 002265   000054 552120                    STBQ    44,'20'O,PR0

      686    20636    5               KL$TREC.HASP.BLKHDR.USE = DREC$->KL$TREC.SUPER;

  20636  4 002266   200442 470500                    LDP0    DREC$,,AUTO
         4 002267   201141 471500                    LDP1    TREC$,,AUTO
         4 002270   000000 236100                    LDQ     0,,PR0
         4 002271   100055 552104                    STBQ    45,'04'O,PR1

      687    20637    5               DREC$->KL$TREC.TNAME=TERM_KEY.TXT.ACCT ;

  20637  4 002272   200442 470500                    LDP0    DREC$,,AUTO
         4 002273   040100 100400                    MLR     fill='040'O
         4 002274   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 002275   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8

      688    20638    5               DREC$->KL$TREC.SNAME=SNAME ;

  20638  4 002276   200442 470500                    LDP0    DREC$,,AUTO
         4 002277   201126 237100                    LDAQ    SNAME,,AUTO
         4 002300   000015 755100                    STA     13,,PR0
         4 002301   000016 756100                    STQ     14,,PR0

      689    20639    5               ARS = (DREC$->KL$TREC.NWINFO * 4) + LENGTHC(KL_DREC_CNT) ;

  20639  4 002302   200442 470500                    LDP0    DREC$,,AUTO
         4 002303   000017 235100                    LDA     15,,PR0
         4 002304   000002 735000                    ALS     2
         4 002305   000100 035007                    ADLA    64,DL
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:107  
         4 002306   200003 755100                    STA     ARS,,AUTO

      690    20640    5               USERS_KEY.COUNT = 8 ;

  20640  4 002307   010000 236003                    LDQ     4096,DU
         4 002310   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      691    20641    5               USERS_KEY.TXTC = FROM_KEY.TEXT ;

  20641  4 002311   040000 100400                    MLR     fill='040'O
         4 002312   000000 200024 xsym               ADSC9   FROM_KEY                 cn=1,n=20
         4 002313   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      692    20642    5               CALL ASB$WRITE_HLP(DREC$,ARS) ALTRET(WRITE_TREC_ERR) ;

  20642  4 002314   200003 631500                    EPPR1   ARS,,AUTO
         4 002315   201151 451500                    STP1    KL$UBWORD+2,,AUTO
         4 002316   200442 633500                    EPPR3   DREC$,,AUTO
         4 002317   201150 453500                    STP3    KL$UBWORD+1,,AUTO
         4 002320   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002321   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002322   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 002323   003510 702000 4                  TSX2    READ_CHAIN_ERR

      693    20643    5               KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = TERM_KEY.TXT.ACCT ;

  20643  4 002324   201146 236100                    LDQ     TWSN_INDEX,,AUTO
         4 002325   000013 402007                    MPY     11,DL
         4 002326   000002 736000                    QLS     2
         4 002327   201143 470500                    LDP0    TWSNR$,,AUTO
         4 002330   040106 100400                    MLR     fill='040'O
         4 002331   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 002332   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8

      694    20644    5               KL$TWSNREC.NDEV = TWSN_INDEX + 1 ;

  20644  4 002333   201143 470500                    LDP0    TWSNR$,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:108  
         4 002334   201146 235100                    LDA     TWSN_INDEX,,AUTO
         4 002335   000001 035007                    ADLA    1,DL
         4 002336   000004 755100                    STA     4,,PR0

      695    20645    5               TWSN_ARS = TWSN_ARS + LENGTHC(KL$TWSNREC.DEVS(0));

  20645  4 002337   201145 235100                    LDA     TWSN_ARS,,AUTO
         4 002340   000054 035007                    ADLA    44,DL
         4 002341   201145 755100                    STA     TWSN_ARS,,AUTO

      696    20646    5               CALL ASB$WRITE_LO( AS_CREATED_TEXT, LENGTHC(AS_CREATED_TEXT));

  20646  4 002342   000037 630400 5                  EPPR0   31
         4 002343   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002344   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002345   000000 011000                    NOP     0

      697    20647    5               CONFIG_KEY.TERMID = KL$HASPDEV.TERMID;

  20647  4 002346   200501 470500                    LDP0    HASPDEV$,,AUTO
         4 002347   000000 100500                    MLR     fill='000'O
         4 002350   000002 000020                    ADSC9   2,,PR0                   cn=0,n=16
         4 002351   000000 600020 2                  ADSC9   CONFIG_KEY               cn=3,n=16

      698    20648    5               LINCNFG_BUF = '0'B;

  20648  4 002352   000000 100400                    MLR     fill='000'O
         4 002353   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 002354   000036 000310 2                  ADSC9   LINCNFG_BUF              cn=0,n=200

      699    20649    5               LINCNFG.KHA = KL_HNDCMN;

  20649  4 002355   000035 471400 2                  LDP1    LINCNFG$
         4 002356   000100 100400                    MLR     fill='000'O
         4 002357   000005 000022 2                  ADSC9   KL_HNDCMN                cn=0,n=18
         4 002360   100000 000022                    ADSC9   0,,PR1                   cn=0,n=18

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:109  
      700    20650    5               LINCNFG.NA = KL_NA;

  20650  4 002361   000100 100400                    MLR     fill='000'O
         4 002362   000012 000010 2                  ADSC9   KL_NA                    cn=0,n=8
         4 002363   100004 400010                    ADSC9   4,,PR1                   cn=2,n=8

      701    20651    5               LINCNFG.NA.SNDSLT = '0'B;

  20651  4 002364   000041 236000 5                  LDQ     33
         4 002365   100004 356100                    ANSQ    4,,PR1

      702    20652    5               LINCNFG.NA.AUTLGN = '1'B;

  20652  4 002366   100004 236100                    LDQ     4,,PR1
         4 002367   000042 376000 5                  ANQ     34
         4 002370   010000 276007                    ORQ     4096,DL
         4 002371   100004 756100                    STQ     4,,PR1

      703    20653    5               LINCNFG.LGN.LGNSIZE = KL_SS.CNT;

  20653  4 002372   000014 236000 2                  LDQ     KL_SS
         4 002373   000022 772000                    QRL     18
         4 002374   100012 552110                    STBQ    10,'10'O,PR1

      704    20654    5               LINCNFG.LGN.LGNSTRING = KL_SS.SGN_R;

  20654  4 002375   100012 236100                    LDQ     10,,PR1
         4 002376   000011 772000                    QRL     9
         4 002377   000777 376007                    ANQ     511,DL
         4 002400   000000 620006                    EAX0    0,QL
         4 002401   040140 100400                    MLR     fill='040'O
         4 002402   000014 200032 2                  ADSC9   KL_SS                    cn=1,n=26
         4 002403   100012 600010                    ADSC9   10,,PR1                  cn=3,n=*X0

      705    20655    5               CALL ASB$WRITE_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG)) ALTRET(
             20655                        NETCON_ERR);

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:110  
  20655  4 002404   000053 621010                    EAX1    43,X0
         4 002405   000000 635011                    EAA     0,X1
         4 002406   000002 771000                    ARL     2
         4 002407   000140 135007                    SBLA    96,DL
         4 002410   000035 236000 2                  LDQ     LINCNFG$
         4 002411   201150 757100                    STAQ    KL$UBWORD+1,,AUTO
         4 002412   201150 633500                    EPPR3   KL$UBWORD+1,,AUTO
         4 002413   201153 453500                    STP3    KL$UBWORD+4,,AUTO
         4 002414   000043 236000 5                  LDQ     35
         4 002415   201152 756100                    STQ     KL$UBWORD+3,,AUTO
         4 002416   201152 630500                    EPPR0   KL$UBWORD+3,,AUTO
         4 002417   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002420   000000 701000 xent               TSX1    ASB$WRITE_NETCON
         4 002421   003532 702000 4                  TSX2    NETCON_ERR

      706    20656    5               HASPDEV$ = PINCRW(HASPDEV$, SIZEW(KL_HASPDEV));

  20656  4 002422   200501 236100                    LDQ     HASPDEV$,,AUTO
         4 002423   000007 036003                    ADLQ    7,DU
         4 002424   200501 756100                    STQ     HASPDEV$,,AUTO

      707    20657    5               END;

  20657  4 002425   003400 710000 4                  TRA     s:20947

      708    20658    4            SELECT( TERM_M_DC_VAL ) ;

      709    20659    4            BLK$ = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;

  20659  4 002426   100003 473500                    LDP3    3,,PR1
         4 002427   300003 236100                    LDQ     3,,PR3
         4 002430   200005 756100                    STQ     BLK$,,AUTO

      710    20660                                      /* Make sure the device name is valid */
      711    20661    4            CALL ASB$VALID_TDEVICE( OUT$SYM ) ALTRET( TERM_LOOP );

  20661  4 002431   200005 630500                    EPPR0   BLK$,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:111  
         4 002432   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002433   000000 701000 xent               TSX1    ASB$VALID_TDEVICE
         4 002434   000767 702000 4                  TSX2    TERM_LOOP

      712    20662                                                              /* Set up type and num */
      713    20663    4            CDNN = OUT$SYM.TEXT;

  20663  4 002435   200005 470500                    LDP0    BLK$,,AUTO
         4 002436   000004 236100                    LDQ     4,,PR0
         4 002437   000033 772000                    QRL     27
         4 002440   000000 620006                    EAX0    0,QL
         4 002441   040100 100540                    MLR     fill='040'O
         4 002442   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 002443   200006 000010                    ADSC9   CDNN,,AUTO               cn=0,n=8

      714    20664    4            TYPE = CDNN_R.TYPE;

  20664  4 002444   200006 220100                    LDX0    CDNN,,AUTO
         4 002445   000000 740000 xsym               STX0    TYPE

      715    20665    4            NUM  = CDNN_R.NUM ;

  20665  4 002446   200006 721100                    LXL1    CDNN,,AUTO
         4 002447   200515 741100                    STX1    NUM,,AUTO

      716    20666    5            IF KL$TREC.HASP.BLKHDR.NSUBS = 0 THEN DO;

  20666  4 002450   201141 471500                    LDP1    TREC$,,AUTO
         4 002451   100054 236100                    LDQ     44,,PR1
         4 002452   000777 316003                    CANQ    511,DU
         4 002453   002471 601000 4                  TNZ     s:20688

      717    20667    5               AS_FIELD1.COUNT = OUT$SYM.COUNT ;

  20667  4 002454   000004 236100                    LDQ     4,,PR0
         4 002455   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:112  
      718    20668    5               AS_FIELD1.TEXT = OUT$SYM.TEXT ;

  20668  4 002456   000004 236100                    LDQ     4,,PR0
         4 002457   000033 772000                    QRL     27
         4 002460   000000 622006                    EAX2    0,QL
         4 002461   040000 100540                    MLR     fill='040'O
         4 002462   000004 200012                    ADSC9   4,,PR0                   cn=1,n=*X2
         4 002463   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      719    20669                    %SCREAM( ERR#=E$M_DEV_CON_NOT_DEFINED, LEVEL=ERROR, MID='A') ;

  20681  4 002464   000047 630400 5                  EPPR0   39
         4 002465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002466   000000 701000 xent               TSX1    ASH$ERROR
         4 002467   000000 011000                    NOP     0

      720    20684                             /*E*  ERROR:    ASA-E$M_DEV_CON_NOT_DEFINED-C
      721    20685                                   MESSAGE0: %%U1 %is not defined. */
      722    20686    5               END; /* If nsubs = 0 */

  20686  4 002470   003031 710000 4                  TRA     SKIP

      723    20687    5            ELSE DO;

      724    20688    6               DO J = 0 TO KL$TREC.HASP.BLKHDR.NSUBS-1;

  20688  4 002471   200503 450100                    STZ     J,,AUTO
         4 002472   003023 710000 4                  TRA     s:20728+1

      725    20689    6                  M_CONDEV$ = PINCRW(ADDR(KL$TREC.HASP), SIZEW(KL$TREC.HASP)+(J*SIZEW(
             20689                           KL_HASPDEV)));

  20689  4 002473   200503 236100                    LDQ     J,,AUTO
         4 002474   000007 402003                    MPY     7,DU
         4 002475   000103 036003                    ADLQ    67,DU
         4 002476   201141 036100                    ADLQ    TREC$,,AUTO
         4 002477   200511 756100                    STQ     M_CONDEV$,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:113  

      726    20690    6                  CONFIG_KEY.TERMID = M_CONDEV$->KL$HASPDEV.TERMID;

  20690  4 002500   200511 470500                    LDP0    M_CONDEV$,,AUTO
         4 002501   000000 100500                    MLR     fill='000'O
         4 002502   000002 000020                    ADSC9   2,,PR0                   cn=0,n=16
         4 002503   000000 600020 2                  ADSC9   CONFIG_KEY               cn=3,n=16

      727    20691    6                  CALL ASB$READ_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG_BUF)) ALTRET(
             20691                           NETCON_ERR);

  20691  4 002504   000052 630400 5                  EPPR0   42
         4 002505   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002506   000000 701000 xent               TSX1    ASB$READ_NETCON
         4 002507   003532 702000 4                  TSX2    NETCON_ERR

      728    20692    6                  KL_SS.CNT = LINCNFG.LGN.LGNSIZE;

  20692  4 002510   000035 470400 2                  LDP0    LINCNFG$
         4 002511   000012 236100                    LDQ     10,,PR0
         4 002512   000022 736000                    QLS     18
         4 002513   000014 552040 2                  STBQ    KL_SS,'40'O

      729    20693    6                  KL_SS.SGN_R = LINCNFG.LGN.LGNSTRING;

  20693  4 002514   000012 236100                    LDQ     10,,PR0
         4 002515   000011 772000                    QRL     9
         4 002516   000777 376007                    ANQ     511,DL
         4 002517   000000 620006                    EAX0    0,QL
         4 002520   040000 100540                    MLR     fill='040'O
         4 002521   000012 600010                    ADSC9   10,,PR0                  cn=3,n=*X0
         4 002522   000014 200032 2                  ADSC9   KL_SS                    cn=1,n=26

      730    20694    6                  IF KL_SS.SGN.TYPE = TYPE AND

  20694  4 002523   040000 106400                    CMPC    fill='040'O
         4 002524   000014 200002 2                  ADSC9   KL_SS                    cn=1,n=2
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:114  
         4 002525   000000 000002 xsym               ADSC9   TYPE                     cn=0,n=2
         4 002526   003022 601000 4                  TNZ     s:20728
         4 002527   040100 106400                    CMPC    fill='040'O
         4 002530   000014 600002 2                  ADSC9   KL_SS                    cn=3,n=2
         4 002531   200515 000002                    ADSC9   NUM,,AUTO                cn=0,n=2
         4 002532   003022 601000 4                  TNZ     s:20728

      731    20695    7                       KL_SS.SGN.NUM = NUM THEN DO;

      732    20696    7                     M_CONDEV = AS_TRUE;

  20696  4 002533   000000 236000 xsym               LDQ     AS_TRUE
         4 002534   400000 376003                    ANQ     -131072,DU
         4 002535   200510 756100                    STQ     M_CONDEV,,AUTO

      733    20697    7                     USERS_KEY.COUNT = 8 ;

  20697  4 002536   010000 236003                    LDQ     4096,DU
         4 002537   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      734    20698    7                     CALL CONCAT( USERS_KEY.TXTC, TYPE, NUM, TWSNC ) ;

  20698  4 002540   000000 236000 xsym               LDQ     TYPE
         4 002541   000011 772000                    QRL     9
         4 002542   000000 552030 xsym               STBQ    USERS_KEY,'30'O
         4 002543   040000 100500                    MLR     fill='040'O
         4 002544   200515 000002                    ADSC9   NUM,,AUTO                cn=0,n=2
         4 002545   000000 600002 xsym               ADSC9   USERS_KEY                cn=3,n=2
         4 002546   040000 100500                    MLR     fill='040'O
         4 002547   201142 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 002550   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      735    20699    7                     K = SIZEC(DEV_REC);

  20699  4 002551   001750 235007                    LDA     1000,DL
         4 002552   200504 755100                    STA     K,,AUTO

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:115  
      736    20700    8                     CALL ASB$READ_HLP(DREC$,K) WHENALTRETURN DO;

  20700  4 002553   200504 630500                    EPPR0   K,,AUTO
         4 002554   201151 450500                    STP0    KL$UBWORD+2,,AUTO
         4 002555   200442 631500                    EPPR1   DREC$,,AUTO
         4 002556   201150 451500                    STP1    KL$UBWORD+1,,AUTO
         4 002557   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002560   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002561   000000 701000 xent               TSX1    ASB$READ_HLP
         4 002562   002564 702000 4                  TSX2    s:20701
         4 002563   002571 710000 4                  TRA     s:20704

      737    20701    8                        CALL ASA$ERROR(USERS_KEY,E$UNABLE_TO_READ_HLP);

  20701  4 002564   000055 630400 5                  EPPR0   45
         4 002565   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002566   000000 701000 xent               TSX1    ASA$ERROR
         4 002567   000000 011000                    NOP     0

      738    20702    8                        GOTO TERM_LOOP;

  20702  4 002570   000767 710000 4                  TRA     TERM_LOOP

      739    20703    8                        END; /* Do never */
      740    20704    7                     CALL ASB$FIND_TWSN_INDEX(TREC$,DREC$,TWSNR$,AS_TRUE,CDNN,
             20704                              TWSN_INDEX ) ALTRET( SKIP ) ;

  20704  4 002571   201146 630500                    EPPR0   TWSN_INDEX,,AUTO
         4 002572   201155 450500                    STP0    KL$UBWORD+6,,AUTO
         4 002573   200006 631500                    EPPR1   CDNN,,AUTO
         4 002574   201154 451500                    STP1    KL$UBWORD+5,,AUTO
         4 002575   000057 236000 5                  LDQ     47
         4 002576   201153 756100                    STQ     KL$UBWORD+4,,AUTO
         4 002577   201143 633500                    EPPR3   TWSNR$,,AUTO
         4 002600   201152 453500                    STP3    KL$UBWORD+3,,AUTO
         4 002601   200442 634500                    EPPR4   DREC$,,AUTO
         4 002602   201151 454500                    STP4    KL$UBWORD+2,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:116  
         4 002603   201141 635500                    EPPR5   TREC$,,AUTO
         4 002604   201150 455500                    STP5    KL$UBWORD+1,,AUTO
         4 002605   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002606   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 002607   000000 701000 xent               TSX1    ASB$FIND_TWSN_INDEX
         4 002610   003031 702000 4                  TSX2    SKIP

      741    20705    7                     IF DREC$->KL$TREC.SUPER = AS_UNDEF#

  20705  4 002611   200442 470500                    LDP0    DREC$,,AUTO
         4 002612   000000 236100                    LDQ     0,,PR0
         4 002613   000777 316007                    CANQ    511,DL
         4 002614   002625 601000 4                  TNZ     s:20707

      742    20706    7                     THEN CALL ASB$CHECK_TYPE(DREC$,K);

  20706  4 002615   200504 631500                    EPPR1   K,,AUTO
         4 002616   201151 451500                    STP1    KL$UBWORD+2,,AUTO
         4 002617   200442 633500                    EPPR3   DREC$,,AUTO
         4 002620   201150 453500                    STP3    KL$UBWORD+1,,AUTO
         4 002621   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002622   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002623   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 002624   000000 011000                    NOP     0

      743    20707    7                     DADR$ = ADDR (M_CONDEV$->KL$HASPDEV.DADR);

  20707  4 002625   200511 236100                    LDQ     M_CONDEV$,,AUTO
         4 002626   000006 036003                    ADLQ    6,DU
         4 002627   200014 756100                    STQ     DADR$,,AUTO

      744    20708    8                     IF DREC$->KL$TREC.SUPER = AS_CON# THEN DO;

  20708  4 002630   200442 470500                    LDP0    DREC$,,AUTO
         4 002631   000000 236100                    LDQ     0,,PR0
         4 002632   000777 376007                    ANQ     511,DL
         4 002633   000004 116007                    CMPQ    4,DL
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:117  
         4 002634   002671 601000 4                  TNZ     s:20713

      745    20709    8                        CALL ASA$CON_OPTS(DREC$,TWSNR$,TWSNC,'0'B,'1'B,TERM_T,LOCAL,
             20709                                 TWSN_INDEX,KL_SS,DADR$);

  20709  4 002635   200014 631500                    EPPR1   DADR$,,AUTO
         4 002636   201161 451500                    STP1    KL$UBWORD+10,,AUTO
         4 002637   000033 236000 5                  LDQ     27
         4 002640   201160 756100                    STQ     KL$UBWORD+9,,AUTO
         4 002641   201146 633500                    EPPR3   TWSN_INDEX,,AUTO
         4 002642   201157 453500                    STP3    KL$UBWORD+8,,AUTO
         4 002643   200506 634500                    EPPR4   LOCAL,,AUTO
         4 002644   201156 454500                    STP4    KL$UBWORD+7,,AUTO
         4 002645   201137 635500                    EPPR5   TERM_T,,AUTO
         4 002646   201155 455500                    STP5    KL$UBWORD+6,,AUTO
         4 002647   000034 236000 5                  LDQ     28
         4 002650   201154 756100                    STQ     KL$UBWORD+5,,AUTO
         4 002651   000060 236000 5                  LDQ     48
         4 002652   201153 756100                    STQ     KL$UBWORD+4,,AUTO
         4 002653   201142 636500                    EPPR6   TWSNC,,AUTO
         4 002654   201152 456500                    STP6    KL$UBWORD+3,,AUTO
         4 002655   201143 637500                    EPPR7   TWSNR$,,AUTO
         4 002656   201151 457500                    STP7    KL$UBWORD+2,,AUTO
         4 002657   200442 630500                    EPPR0   DREC$,,AUTO
         4 002660   201150 450500                    STP0    KL$UBWORD+1,,AUTO
         4 002661   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002662   000032 631400 5                  EPPR1   26
         4 002663   000000 701000 xent               TSX1    ASA$CON_OPTS
         4 002664   000000 011000                    NOP     0

      746    20710    8                        DREC$->KL$TREC.FLAGS.RNME='0'B;

  20710  4 002665   200442 470500                    LDP0    DREC$,,AUTO
         4 002666   000035 236000 5                  LDQ     29
         4 002667   000000 356100                    ANSQ    0,,PR0

      747    20711    8                        END; /* If */
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:118  

  20711  4 002670   002732 710000 4                  TRA     s:20719

      748    20712    8                     ELSE DO;

      749    20713    8                        CALL ASA$DEV_OPTS(DREC$,TWSNR$,TWSNC,'0'B,'1'B,TERM_T,
             20713                                 TWSN_INDEX,KL_SS,DADR$);

  20713  4 002671   200014 631500                    EPPR1   DADR$,,AUTO
         4 002672   201160 451500                    STP1    KL$UBWORD+9,,AUTO
         4 002673   000033 236000 5                  LDQ     27
         4 002674   201157 756100                    STQ     KL$UBWORD+8,,AUTO
         4 002675   201146 633500                    EPPR3   TWSN_INDEX,,AUTO
         4 002676   201156 453500                    STP3    KL$UBWORD+7,,AUTO
         4 002677   201137 634500                    EPPR4   TERM_T,,AUTO
         4 002700   201155 454500                    STP4    KL$UBWORD+6,,AUTO
         4 002701   000034 236000 5                  LDQ     28
         4 002702   201154 756100                    STQ     KL$UBWORD+5,,AUTO
         4 002703   000060 236000 5                  LDQ     48
         4 002704   201153 756100                    STQ     KL$UBWORD+4,,AUTO
         4 002705   201142 635500                    EPPR5   TWSNC,,AUTO
         4 002706   201152 455500                    STP5    KL$UBWORD+3,,AUTO
         4 002707   201143 636500                    EPPR6   TWSNR$,,AUTO
         4 002710   201151 456500                    STP6    KL$UBWORD+2,,AUTO
         4 002711   200442 637500                    EPPR7   DREC$,,AUTO
         4 002712   201150 457500                    STP7    KL$UBWORD+1,,AUTO
         4 002713   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002714   000046 631400 5                  EPPR1   38
         4 002715   000000 701000 xent               TSX1    ASA$DEV_OPTS
         4 002716   000000 011000                    NOP     0

      750    20714    9                        IF TYPE ~= 'CG' THEN DO;

  20714  4 002717   000000 220000 xsym               LDX0    TYPE
         4 002720   000167 100000 3                  CMPX0   TERM_TYPE_A+45
         4 002721   002732 600000 4                  TZE     s:20719

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:119  
      751    20715    9                           DREC$->KL$TREC.RENAME = ' ' ;

  20715  4 002722   200442 470500                    LDP0    DREC$,,AUTO
         4 002723   000035 235000 xsym               LDA     B_VECTNIL+29
         4 002724   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 002725   000011 755100                    STA     9,,PR0
         4 002726   000012 756100                    STQ     10,,PR0

      752    20716    9                           DREC$->KL$TREC.FLAGS.RNME = '0'B;

  20716  4 002727   200442 470500                    LDP0    DREC$,,AUTO
         4 002730   000035 236000 5                  LDQ     29
         4 002731   000000 356100                    ANSQ    0,,PR0

      753    20717    9                           END; /* If */

      754    20718    8                        END;

      755    20719    7                     CALL CONCAT( USERS_KEY.TXTC, TYPE, NUM, TWSNC ) ;

  20719  4 002732   000000 236000 xsym               LDQ     TYPE
         4 002733   000011 772000                    QRL     9
         4 002734   000000 552030 xsym               STBQ    USERS_KEY,'30'O
         4 002735   040000 100500                    MLR     fill='040'O
         4 002736   200515 000002                    ADSC9   NUM,,AUTO                cn=0,n=2
         4 002737   000000 600002 xsym               ADSC9   USERS_KEY                cn=3,n=2
         4 002740   040000 100500                    MLR     fill='040'O
         4 002741   201142 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 002742   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      756    20720    7                     USERS_KEY.COUNT = 8 ;

  20720  4 002743   010000 236003                    LDQ     4096,DU
         4 002744   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      757    20721    7                     ARS = DREC$->KL$TREC.NWINFO*4 + LENGTHC(KL_DREC_CNT) ;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:120  
  20721  4 002745   200442 470500                    LDP0    DREC$,,AUTO
         4 002746   000017 235100                    LDA     15,,PR0
         4 002747   000002 735000                    ALS     2
         4 002750   000100 035007                    ADLA    64,DL
         4 002751   200003 755100                    STA     ARS,,AUTO

      758    20722    7                     CALL ASB$WRITE_HLP( DREC$, ARS ) ALTRET( WRITE_TREC_ERR);

  20722  4 002752   200003 631500                    EPPR1   ARS,,AUTO
         4 002753   201151 451500                    STP1    KL$UBWORD+2,,AUTO
         4 002754   200442 633500                    EPPR3   DREC$,,AUTO
         4 002755   201150 453500                    STP3    KL$UBWORD+1,,AUTO
         4 002756   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 002757   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002760   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 002761   003510 702000 4                  TSX2    READ_CHAIN_ERR

      759    20723    7                     KL$TWSNREC.DEVS.TERM(TWSN_INDEX) = TERM_KEY.TXT.ACCT ;

  20723  4 002762   201146 236100                    LDQ     TWSN_INDEX,,AUTO
         4 002763   000013 402007                    MPY     11,DL
         4 002764   000002 736000                    QLS     2
         4 002765   201143 470500                    LDP0    TWSNR$,,AUTO
         4 002766   040106 100400                    MLR     fill='040'O
         4 002767   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 002770   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8

      760    20724    7                     LINCNFG.LGN.LGNSIZE = KL_SS.CNT;

  20724  4 002771   000035 470400 2                  LDP0    LINCNFG$
         4 002772   000014 236000 2                  LDQ     KL_SS
         4 002773   000022 772000                    QRL     18
         4 002774   000012 552110                    STBQ    10,'10'O,PR0

      761    20725    7                     LINCNFG.LGN.LGNSTRING = KL_SS.SGN_R;

  20725  4 002775   000012 236100                    LDQ     10,,PR0
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:121  
         4 002776   000011 772000                    QRL     9
         4 002777   000777 376007                    ANQ     511,DL
         4 003000   000000 620006                    EAX0    0,QL
         4 003001   040140 100400                    MLR     fill='040'O
         4 003002   000014 200032 2                  ADSC9   KL_SS                    cn=1,n=26
         4 003003   000012 600010                    ADSC9   10,,PR0                  cn=3,n=*X0

      762    20726    7                     CALL ASB$WRITE_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG)) ALTRET(
             20726                              NETCON_ERR);

  20726  4 003004   000053 621010                    EAX1    43,X0
         4 003005   000000 635011                    EAA     0,X1
         4 003006   000002 771000                    ARL     2
         4 003007   000140 135007                    SBLA    96,DL
         4 003010   000035 236000 2                  LDQ     LINCNFG$
         4 003011   201150 757100                    STAQ    KL$UBWORD+1,,AUTO
         4 003012   201150 631500                    EPPR1   KL$UBWORD+1,,AUTO
         4 003013   201153 451500                    STP1    KL$UBWORD+4,,AUTO
         4 003014   000043 236000 5                  LDQ     35
         4 003015   201152 756100                    STQ     KL$UBWORD+3,,AUTO
         4 003016   201152 630500                    EPPR0   KL$UBWORD+3,,AUTO
         4 003017   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003020   000000 701000 xent               TSX1    ASB$WRITE_NETCON
         4 003021   003532 702000 4                  TSX2    NETCON_ERR

      763    20727    7                     END;  /* Else */

      764    20728    6                  END;  /* Do j */

  20728  4 003022   200503 054100                    AOS     J,,AUTO
         4 003023   201141 470500                    LDP0    TREC$,,AUTO
         4 003024   000054 236100                    LDQ     44,,PR0
         4 003025   000022 772000                    QRL     18
         4 003026   000777 376007                    ANQ     511,DL
         4 003027   200503 116100                    CMPQ    J,,AUTO
         4 003030   002473 605400 4                  TPNZ    s:20689

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:122  
      765    20729    5               END;  /* Else */

      766    20730    4   SKIP:    M_CONDEV = AS_FALSE ;

  20730  4 003031   000000 236000 xsym  SKIP         LDQ     AS_FALSE
         4 003032   400000 376003                    ANQ     -131072,DU
         4 003033   200510 756100                    STQ     M_CONDEV,,AUTO
         4 003034   003400 710000 4                  TRA     s:20947

      767    20731                                                              /**/
      768    20732    4            SELECT( GJOB_OPT_VAL ) ;

      769    20733    4            GJOB_FLG = '1'B;

  20733  4 003035   400000 236003                    LDQ     -131072,DU
         4 003036   200477 756100                    STQ     GJOB_FLG,,AUTO

      770    20734    4            GJOB = KL_TREC.GJOB;

  20734  4 003037   000100 100400                    MLR     fill='000'O
         4 003040   000027 000160 3                  ADSC9   KL_TREC+16               cn=0,n=112
         4 003041   200443 000160                    ADSC9   GJOB,,AUTO               cn=0,n=112

      771    20735    4            GJOB_OK = '1'B;

  20735  4 003042   200500 756100                    STQ     GJOB_OK,,AUTO

      772    20736    4            J = 0;

  20736  4 003043   200503 450100                    STZ     J,,AUTO

      773    20737    5            DO WHILE( J < PTR$->P$NODE.SUBNODES  AND  GJOB_OK );

  20737  4 003044   003221 710000 4                  TRA     s:20850

      774    20738    5               CODE = PTR$ -> P$NODE.SUBLK$(J) -> P$NODE.CODE;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:123  
  20738  4 003045   201123 470500                    LDP0    PTR$,,AUTO
         4 003046   200503 720100                    LXL0    J,,AUTO
         4 003047   000003 471510                    LDP1    3,X0,PR0
         4 003050   100000 236100                    LDQ     0,,PR1
         4 003051   777777 376007                    ANQ     -1,DL
         4 003052   000000 756000 xsym               STQ     CODE

      775    20739    6               DO SELECT( CODE );

  20739  4 003053   000002 116007                    CMPQ    2,DL
         4 003054   003067 602000 4                  TNC     s:20739+12
         4 003055   003117 600000 4                  TZE     s:20767
         4 003056   000004 116007                    CMPQ    4,DL
         4 003057   003064 602000 4                  TNC     s:20739+9
         4 003060   003217 600000 4                  TZE     s:20847
         4 003061   000005 116007                    CMPQ    5,DL
         4 003062   003220 601000 4                  TNZ     s:20849
         4 003063   003170 710000 4                  TRA     s:20819
         4 003064   000003 116007                    CMPQ    3,DL
         4 003065   003220 601000 4                  TNZ     s:20849
         4 003066   003144 710000 4                  TRA     s:20793
         4 003067   000001 116007                    CMPQ    1,DL
         4 003070   003220 601000 4                  TNZ     s:20849
         4 003071   003072 710000 4                  TRA     s:20741

      776    20740    6                  SELECT( GJNAME_VAL );

      777    20741    6                  BLK$ = PTR$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0);

  20741  4 003072   000003 471510                    LDP1    3,X0,PR0
         4 003073   100003 236100                    LDQ     3,,PR1
         4 003074   200005 756100                    STQ     BLK$,,AUTO

      778    20742    7                  IF OUT$SYM.COUNT > 12 THEN DO;

  20742  4 003075   200005 473500                    LDP3    BLK$,,AUTO
         4 003076   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:124  
         4 003077   777000 376003                    ANQ     -512,DU
         4 003100   015000 116003                    CMPQ    6656,DU
         4 003101   003110 602000 4                  TNC     s:20765

      779    20743        /*E*  ERROR:    ASA-E$GJNAMETOOBIG-C
      780    20744              MESSAGE0: GJOB name too big.
      781    20745              MESSAGE1: GJOB name can be at most 12 characters.
      782    20746        */
      783    20747                          %SCREAM( ERR#=E$GJNAMETOOBIG, LEVEL=ERROR, MID='A') ;

  20759  4 003102   000061 630400 5                  EPPR0   49
         4 003103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003104   000000 701000 xent               TSX1    ASH$ERROR
         4 003105   000000 011000                    NOP     0

      784    20762    7                     GJOB_OK = '0'B;

  20762  4 003106   200500 450100                    STZ     GJOB_OK,,AUTO

      785    20763    7                     END ; /* Then do */

  20763  4 003107   003220 710000 4                  TRA     s:20849

      786    20764    6                  ELSE
      787    20765    6                     GJOB.UNAME = OUT$SYM.TEXT ;

  20765  4 003110   300004 236100                    LDQ     4,,PR3
         4 003111   000033 772000                    QRL     27
         4 003112   000000 621006                    EAX1    0,QL
         4 003113   040100 100540                    MLR     fill='040'O
         4 003114   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 003115   200445 000014                    ADSC9   GJOB+2,,AUTO             cn=0,n=12
         4 003116   003220 710000 4                  TRA     s:20849

      788    20766    6                  SELECT( GJACCT_VAL ) ;

      789    20767    6                  BLK$ = PTR$ -> P$NODE.SUBLK$(J) -> P$NODE.SUBLK$(0);
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:125  

  20767  4 003117   000003 471510                    LDP1    3,X0,PR0
         4 003120   100003 236100                    LDQ     3,,PR1
         4 003121   200005 756100                    STQ     BLK$,,AUTO

      790    20768    7                  IF OUT$SYM.COUNT > 8 THEN DO;

  20768  4 003122   200005 473500                    LDP3    BLK$,,AUTO
         4 003123   300004 236100                    LDQ     4,,PR3
         4 003124   777000 376003                    ANQ     -512,DU
         4 003125   011000 116003                    CMPQ    4608,DU
         4 003126   003135 602000 4                  TNC     s:20791

      791    20769        /*E*  ERROR:    ASA-E$GJACCTTOOBIG-C
      792    20770              MESSAGE0: GJOB account too big.
      793    20771              MESSAGE1: GJOB account can be at most 8 characters long.
      794    20772        */
      795    20773                          %SCREAM( ERR#=E$GJACCTTOOBIG, LEVEL=ERROR, MID='A') ;

  20785  4 003127   000062 630400 5                  EPPR0   50
         4 003130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003131   000000 701000 xent               TSX1    ASH$ERROR
         4 003132   000000 011000                    NOP     0

      796    20788    7                     GJOB_OK = '0'B;

  20788  4 003133   200500 450100                    STZ     GJOB_OK,,AUTO

      797    20789    7                     END ; /* Then do */

  20789  4 003134   003220 710000 4                  TRA     s:20849

      798    20790    6                  ELSE
      799    20791    6                     GJOB.ACCT = OUT$SYM.TEXT ;

  20791  4 003135   300004 236100                    LDQ     4,,PR3
         4 003136   000033 772000                    QRL     27
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:126  
         4 003137   000000 621006                    EAX1    0,QL
         4 003140   040100 100540                    MLR     fill='040'O
         4 003141   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 003142   200443 000010                    ADSC9   GJOB,,AUTO               cn=0,n=8
         4 003143   003220 710000 4                  TRA     s:20849

      800    20792    6                  SELECT( GJPASSW_VAL ) ;

      801    20793    6                  BLK$ = PTR$ -> P$NODE.SUBLK$(J);

  20793  4 003144   000003 236110                    LDQ     3,X0,PR0
         4 003145   200005 756100                    STQ     BLK$,,AUTO

      802    20794    7                  IF OUT$SYM.COUNT > 8 THEN DO;

  20794  4 003146   200005 471500                    LDP1    BLK$,,AUTO
         4 003147   100004 236100                    LDQ     4,,PR1
         4 003150   777000 376003                    ANQ     -512,DU
         4 003151   011000 116003                    CMPQ    4608,DU
         4 003152   003161 602000 4                  TNC     s:20817

      803    20795        /*E*  ERROR:    ASA-E$GJPASSTOOBIG-C
      804    20796              MESSAGE0: GJOB password too big.
      805    20797              MESSAGE1: GJOB password can be at most 8 characters long.
      806    20798        */
      807    20799                          %SCREAM( ERR#=E$GJPASSTOOBIG, LEVEL=ERROR, MID='A') ;

  20811  4 003153   000063 630400 5                  EPPR0   51
         4 003154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003155   000000 701000 xent               TSX1    ASH$ERROR
         4 003156   000000 011000                    NOP     0

      808    20814    7                     GJOB_OK = '0'B;

  20814  4 003157   200500 450100                    STZ     GJOB_OK,,AUTO

      809    20815    7                     END ; /* Then do */
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:127  

  20815  4 003160   003220 710000 4                  TRA     s:20849

      810    20816    6                  ELSE
      811    20817    6                     GJOB.PASS = OUT$SYM.TEXT ;

  20817  4 003161   100004 236100                    LDQ     4,,PR1
         4 003162   000033 772000                    QRL     27
         4 003163   000000 621006                    EAX1    0,QL
         4 003164   040100 100540                    MLR     fill='040'O
         4 003165   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 003166   200450 000010                    ADSC9   GJOB+5,,AUTO             cn=0,n=8
         4 003167   003220 710000 4                  TRA     s:20849

      812    20818    6                  SELECT( GJCMD_VAL ) ;

      813    20819    6                  BLK$ = PTR$ -> P$NODE.SUBLK$(J);

  20819  4 003170   000003 236110                    LDQ     3,X0,PR0
         4 003171   200005 756100                    STQ     BLK$,,AUTO

      814    20820    7                  IF OUT$SYM.COUNT > 80 THEN DO;

  20820  4 003172   200005 471500                    LDP1    BLK$,,AUTO
         4 003173   100004 236100                    LDQ     4,,PR1
         4 003174   777000 376003                    ANQ     -512,DU
         4 003175   121000 116003                    CMPQ    41472,DU
         4 003176   003205 602000 4                  TNC     s:20843

      815    20821        /*E*  ERROR:    ASA-E$GJCMDTOOBIG-C
      816    20822              MESSAGE0: GJOB CMD too big.
      817    20823              MESSAGE1: GJOB CMD can be at most 80 characters long.
      818    20824        */
      819    20825                          %SCREAM( ERR#=E$GJCMDTOOBIG, LEVEL=ERROR, MID='A') ;

  20837  4 003177   000064 630400 5                  EPPR0   52
         4 003200   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:128  
         4 003201   000000 701000 xent               TSX1    ASH$ERROR
         4 003202   000000 011000                    NOP     0

      820    20840    7                     GJOB_OK = '0'B;

  20840  4 003203   200500 450100                    STZ     GJOB_OK,,AUTO

      821    20841    7                     END ; /* Then do */

  20841  4 003204   003220 710000 4                  TRA     s:20849

      822    20842    7                  ELSE DO;

      823    20843    7                     GJOB.CMDCNT = OUT$SYM.COUNT;

  20843  4 003205   100004 236100                    LDQ     4,,PR1
         4 003206   000033 772000                    QRL     27
         4 003207   200452 756100                    STQ     GJOB+7,,AUTO

      824    20844    7                     GJOB.CMD    = OUT$SYM.TEXT ;

  20844  4 003210   100004 236100                    LDQ     4,,PR1
         4 003211   000033 772000                    QRL     27
         4 003212   000000 621006                    EAX1    0,QL
         4 003213   040100 100540                    MLR     fill='040'O
         4 003214   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 003215   200453 000120                    ADSC9   GJOB+8,,AUTO             cn=0,n=80

      825    20845    7                     END;

  20845  4 003216   003220 710000 4                  TRA     s:20849

      826    20846    6                  SELECT( GJNONE_VAL );

      827    20847    6                  GJOB_FLG = '0'B;

  20847  4 003217   200477 450100                    STZ     GJOB_FLG,,AUTO
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:129  

      828    20848    6                  END;    /* End do case */

      829    20849    5               J = J + 1;

  20849  4 003220   200503 054100                    AOS     J,,AUTO

      830    20850    5               END;      /* End do while */

  20850  4 003221   201123 470500                    LDP0    PTR$,,AUTO
         4 003222   000001 236100                    LDQ     1,,PR0
         4 003223   000022 772000                    QRL     18
         4 003224   200503 116100                    CMPQ    J,,AUTO
         4 003225   003230 604400 4                  TMOZ    s:20851
         4 003226   200500 234100                    SZN     GJOB_OK,,AUTO
         4 003227   003045 604000 4                  TMI     s:20738

      831    20851    5            IF GJOB_OK THEN DO;

  20851  4 003230   200500 234100                    SZN     GJOB_OK,,AUTO
         4 003231   003400 605000 4                  TPL     s:20947

      832    20852    5               KL$TREC.FLAGS.GJOB = GJOB_FLG;

  20852  4 003232   201141 471500                    LDP1    TREC$,,AUTO
         4 003233   200477 236100                    LDQ     GJOB_FLG,,AUTO
         4 003234   000015 772000                    QRL     13
         4 003235   100000 676100                    ERQ     0,,PR1
         4 003236   000020 376003                    ANQ     16,DU
         4 003237   100000 656100                    ERSQ    0,,PR1

      833    20853    5               CALL ASZ$SCRAMBLE( GJOB.PASS );

  20853  4 003240   200450 631500                    EPPR1   GJOB+5,,AUTO
         4 003241   201150 451500                    STP1    KL$UBWORD+1,,AUTO
         4 003242   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 003243   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:130  
         4 003244   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 003245   000000 011000                    NOP     0

      834    20854    5               KL$TREC.GJOB = GJOB;

  20854  4 003246   201141 470500                    LDP0    TREC$,,AUTO
         4 003247   000100 100500                    MLR     fill='000'O
         4 003250   200443 000160                    ADSC9   GJOB,,AUTO               cn=0,n=112
         4 003251   000020 000160                    ADSC9   16,,PR0                  cn=0,n=112

      835    20855    5               END;

  20855  4 003252   003400 710000 4                  TRA     s:20947

      836    20856                                                              /**/
      837    20857    4            SELECT( %TERM_RLS_VAL ) ;

      838    20858    4            CODE2 = PTR$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;

  20858  4 003253   100003 473500                    LDP3    3,,PR1
         4 003254   300000 236100                    LDQ     0,,PR3
         4 003255   777777 376007                    ANQ     -1,DL
         4 003256   200011 756100                    STQ     CODE2,,AUTO

      839    20859
      840    20860    5            DO SELECT (CODE2);

  20860  4 003257   000007 116007                    CMPQ    7,DL
         4 003260   003400 602000 4                  TNC     s:20947
         4 003261   003265 600000 4                  TZE     s:20864
         4 003262   000025 116007                    CMPQ    21,DL
         4 003263   003400 601000 4                  TNZ     s:20947
         4 003264   003272 710000 4                  TRA     s:20868

      841    20861
      842    20862    5               SELECT (NONE_VAL);

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:131  
      843    20863
      844    20864    5               KL$TREC.HASP.RLS# = AS_BLANK ;

  20864  4 003265   201141 474500                    LDP4    TREC$,,AUTO
         4 003266   040100 100400                    MLR     fill='040'O
         4 003267   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 003270   400056 400120                    ADSC9   46,,PR4                  cn=2,n=80
         4 003271   003400 710000 4                  TRA     s:20947

      845    20865
      846    20866    5               SELECT ( ASYM_VAL );

      847    20867
      848    20868    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0);

  20868  4 003272   100003 236100                    LDQ     3,,PR1
         4 003273   200005 756100                    STQ     BLK$,,AUTO

      849    20869    6               IF OUT$SYM.COUNT > 80 THEN DO;

  20869  4 003274   200005 474500                    LDP4    BLK$,,AUTO
         4 003275   400004 236100                    LDQ     4,,PR4
         4 003276   777000 376003                    ANQ     -512,DU
         4 003277   121000 116003                    CMPQ    41472,DU
         4 003300   003306 602000 4                  TNC     s:20891

      850    20870        /*E*  ERROR:    ASA-E$RLSTOOLONG-C
      851    20871              MESSAGE0: String too long.
      852    20872              MESSAGE1: REMOTE LOGON STRING can be at most 80 characters long.
      853    20873        */
      854    20874                       %SCREAM( ERR#=E$RLSTOOLONG, LEVEL=ERROR, MID='A');

  20886  4 003301   000065 630400 5                  EPPR0   53
         4 003302   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003303   000000 701000 xent               TSX1    ASH$ERROR
         4 003304   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:132  
      855    20889    6                  END ; /* Then do */

  20889  4 003305   003400 710000 4                  TRA     s:20947

      856    20890    5               ELSE
      857    20891    5                  KL$TREC.HASP.RLS# = OUT$SYM.TEXT ;

  20891  4 003306   400004 236100                    LDQ     4,,PR4
         4 003307   000033 772000                    QRL     27
         4 003310   000000 621006                    EAX1    0,QL
         4 003311   201141 475500                    LDP5    TREC$,,AUTO
         4 003312   040100 100540                    MLR     fill='040'O
         4 003313   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
         4 003314   500056 400120                    ADSC9   46,,PR5                  cn=2,n=80

      858    20892    5               END;  /*  Do case CODE2  */

  20892  4 003315   003400 710000 4                  TRA     s:20947

      859    20893
      860    20894    4            SELECT( %TERM_SLAVE_VAL );

      861    20895
      862    20896    4            IF PTR$->P$NODE.SUBNODES = 0 THEN

  20896  4 003316   100001 221100                    LDX1    1,,PR1
         4 003317   003326 601000 4                  TNZ     s:20899

      863    20897    4               KL$TREC.HASP.SLAVE# = %YES#;

  20897  4 003320   201141 473500                    LDP3    TREC$,,AUTO
         4 003321   300056 236100                    LDQ     46,,PR3
         4 003322   000066 376000 5                  ANQ     54
         4 003323   200000 276003                    ORQ     65536,DU
         4 003324   300056 756100                    STQ     46,,PR3
         4 003325   003400 710000 4                  TRA     s:20947

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:133  
      864    20898    5            ELSE DO;

      865    20899    5               BLK$ = PTR$ -> P$NODE.SUBLK$(0);

  20899  4 003326   100003 236100                    LDQ     3,,PR1
         4 003327   200005 756100                    STQ     BLK$,,AUTO

      866    20900    5               IF BLK$ -> P$NODE.CODE = YES_VAL THEN

  20900  4 003330   200005 473500                    LDP3    BLK$,,AUTO
         4 003331   300000 722100                    LXL2    0,,PR3
         4 003332   000001 102003                    CMPX2   1,DU
         4 003333   003342 601000 4                  TNZ     s:20903

      867    20901    5                  KL$TREC.HASP.SLAVE# = %YES#;

  20901  4 003334   201141 474500                    LDP4    TREC$,,AUTO
         4 003335   400056 236100                    LDQ     46,,PR4
         4 003336   000066 376000 5                  ANQ     54
         4 003337   200000 276003                    ORQ     65536,DU
         4 003340   400056 756100                    STQ     46,,PR4
         4 003341   003400 710000 4                  TRA     s:20947

      868    20902    5               ELSE
      869    20903    5                  KL$TREC.HASP.SLAVE# = %NO#;

  20903  4 003342   201141 474500                    LDP4    TREC$,,AUTO
         4 003343   000066 236000 5                  LDQ     54
         4 003344   400056 356100                    ANSQ    46,,PR4

      870    20904    5               END;

  20904  4 003345   003400 710000 4                  TRA     s:20947

      871    20905                                                              /**/
      872    20906    4            SELECT( EOL_VAL ) ;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:134  
  20906  4 003346   003400 710000 4                  TRA     s:20947

      873    20907                                                              /**/
      874    20908    4            SELECT( HELP_VAL ) ;

      875    20909    4            CALL ASH$HELP ;

  20909  4 003347   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003350   000000 701000 xent               TSX1    ASH$HELP
         4 003351   000000 011000                    NOP     0
         4 003352   003400 710000 4                  TRA     s:20947

      876    20910                                                              /**/
      877    20911    4            SELECT( QUESTION_VAL ) ;

      878    20912    4            CALL ASH$QUEST ;

  20912  4 003353   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003354   000000 701000 xent               TSX1    ASH$QUEST
         4 003355   000000 011000                    NOP     0
         4 003356   003400 710000 4                  TRA     s:20947

      879    20913                                                              /**/
      880    20914    4            SELECT( DQUESTION_VAL ) ;

      881    20915    4            CALL ASH$DQUEST ;

  20915  4 003357   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003360   000000 701000 xent               TSX1    ASH$DQUEST
         4 003361   000000 011000                    NOP     0
         4 003362   003400 710000 4                  TRA     s:20947

      882    20916                                                              /**/
      883    20917    4            SELECT( END_VAL ,

      884    20918    4                 BLANK_LINE_VAL ) ;
      885    20919    4            IF KL$TREC.HASP.BLKHDR.NSUBS > 0
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:135  

  20919  4 003363   201141 473500                    LDP3    TREC$,,AUTO
         4 003364   300054 236100                    LDQ     44,,PR3
         4 003365   000777 316003                    CANQ    511,DU
         4 003366   003373 600000 4                  TZE     s:20939

      886    20920    4            THEN
      887    20921    4               MORE = AS_FALSE ;

  20921  4 003367   000000 236000 xsym               LDQ     AS_FALSE
         4 003370   400000 376003                    ANQ     -131072,DU
         4 003371   200507 756100                    STQ     MORE,,AUTO
         4 003372   003400 710000 4                  TRA     s:20947

      888    20922    4            ELSE
      889    20923    5            DO ;

      890    20924        /*E*  ERROR:    ASA-E$NO_CON_DEV_DEFINED-C
      891    20925              MESSAGE:  No CON/DEV defined, TERMINAL is not being created.
      892    20926              MESSAGE1: There must be at least one DEVICE or CONSOLE defined
      893    20927                        in order to create a TERMINAL.
      894    20928        */
      895    20929                    %SCREAM( ERR#=E$NO_CON_DEV_DEFINED, LEVEL=WARN, MID='A') ;

  20939  4 003373   000067 630400 5                  EPPR0   55
         4 003374   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003375   000000 701000 xent               TSX1    ASH$WARN
         4 003376   000000 011000                    NOP     0

      896    20944    5               RETURN;

  20944  4 003377   000000 702200 xent               TSX2  ! X66_ARET

      897    20945    5               END;     /* Else do */
      898    20946    4            END ; /* Do case( code ) */

      899    20947    3         END ; /* Do i */
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:136  

  20947  4 003400   200502 054100                    AOS     I,,AUTO
         4 003401   000000 470400 xsym               LDP0    NODE$
         4 003402   000001 236100                    LDQ     1,,PR0
         4 003403   000022 772000                    QRL     18
         4 003404   200502 116100                    CMPQ    I,,AUTO
         4 003405   001024 605400 4                  TPNZ    s:20351

      900    20948    2      END ; /* Do while */

  20948  4 003406   200507 234100                    SZN     MORE,,AUTO
         4 003407   000771 604000 4                  TMI     s:20340

  20947  4 003410                       DONE_OPTIONS null
      901    20949    1   DONE_OPTIONS: ;
      902    20950                                                              /* Output term rec */
      903    20951    1   KL$TREC.NWINFO = SIZEW(KL$TREC.GJOB) + SIZEW(KL$TREC.HASP) + (KL$TREC.HASP.BLKHDR.
             20951            NSUBS*SIZEW(KL_HASPDEV));

  20951  4 003410   201141 470500                    LDP0    TREC$,,AUTO
         4 003411   000054 236100                    LDQ     44,,PR0
         4 003412   000022 772000                    QRL     18
         4 003413   000777 376007                    ANQ     511,DL
         4 003414   000007 402007                    MPY     7,DL
         4 003415   000063 036007                    ADLQ    51,DL
         4 003416   000017 756100                    STQ     15,,PR0

      904    20952    1   ARS = LENGTHC(KL_DREC_CNT) + ( KL$TREC.NWINFO * 4 ) ;

  20952  4 003417   201141 470500                    LDP0    TREC$,,AUTO
         4 003420   000017 235100                    LDA     15,,PR0
         4 003421   000002 735000                    ALS     2
         4 003422   000100 035007                    ADLA    64,DL
         4 003423   200003 755100                    STA     ARS,,AUTO

      905    20953    1   USERS_KEY = TERM_KEY ;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:137  
  20953  4 003424   000000 100400                    MLR     fill='000'O
         4 003425   000121 000012 2                  ADSC9   TERM_KEY                 cn=0,n=10
         4 003426   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      906    20954    1   CALL ASB$WRITE_HLP( TREC$, ARS ) ALTRET ( WRITE_TREC_ERR ) ;

  20954  4 003427   200003 631500                    EPPR1   ARS,,AUTO
         4 003430   201151 451500                    STP1    KL$UBWORD+2,,AUTO
         4 003431   201141 633500                    EPPR3   TREC$,,AUTO
         4 003432   201150 453500                    STP3    KL$UBWORD+1,,AUTO
         4 003433   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 003434   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003435   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 003436   003510 702000 4                  TSX2    READ_CHAIN_ERR

      907    20955                                                              /* Twsn record */
      908    20956    1   IF CREATE

  20956  4 003437   200013 234100                    SZN     CREATE,,AUTO
         4 003440   003456 605000 4                  TPL     s:20965

      909    20957    1   THEN
      910    20958    2   DO ;

      911    20959    2      KL_TERM_KEY.TERMID.TERM.TERM_NAME = TERM_KEY.TXT.ACCT ;

  20959  4 003441   040000 100400                    MLR     fill='040'O
         4 003442   000121 200010 2                  ADSC9   TERM_KEY                 cn=1,n=8
         4 003443   000032 400010 2                  ADSC9   KL_TERM_KEY+2            cn=2,n=8

      912    20960    2      KL_TERM_REC = '0'B;

  20960  4 003444   000000 100400                    MLR     fill='000'O
         4 003445   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 003446   000023 000023 2                  ADSC9   KL_TERM_REC              cn=0,n=19

      913    20961    2     CALL ASB$WRITE_NETCON(VECTOR(KL_TERM_KEY),VECTOR(KL_TERM_REC)) ALTRET(NETCON_ERR)
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:138  
             20961               ;

  20961  4 003447   000074 630400 5                  EPPR0   60
         4 003450   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003451   000000 701000 xent               TSX1    ASB$WRITE_NETCON
         4 003452   003532 702000 4                  TSX2    NETCON_ERR

      914    20962    2      CALL ASB$CLOSE_NETCON;

  20962  4 003453   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003454   000000 701000 xent               TSX1    ASB$CLOSE_NETCON
         4 003455   000000 011000                    NOP     0

      915    20963    2      END ; /*Then do */

      916    20964                                                              /* Twsnxxxx record */
      917    20965    1   USERS_KEY.COUNT = 8 ;

  20965  4 003456   010000 236003                    LDQ     4096,DU
         4 003457   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      918    20966    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;

  20966  4 003460   040000 100400                    MLR     fill='040'O
         4 003461   000144 000004 3                  ADSC9   TERM_TYPE_A+26           cn=0,n=4
         4 003462   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 003463   040000 100500                    MLR     fill='040'O
         4 003464   201142 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 003465   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      919    20967    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;

  20967  4 003466   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003467   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 003470   003543 702000 4                  TSX2    ENQ_ERR

      920    20968    1   CALL ASB$WRITE_HLP( TWSNR$, TWSN_ARS ) ALTRET( WRITE_TREC_ERR ) ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:139  

  20968  4 003471   201145 630500                    EPPR0   TWSN_ARS,,AUTO
         4 003472   201151 450500                    STP0    KL$UBWORD+2,,AUTO
         4 003473   201143 631500                    EPPR1   TWSNR$,,AUTO
         4 003474   201150 451500                    STP1    KL$UBWORD+1,,AUTO
         4 003475   201150 630500                    EPPR0   KL$UBWORD+1,,AUTO
         4 003476   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003477   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 003500   003510 702000 4                  TSX2    READ_CHAIN_ERR

      921    20969    1   CALL ASB$DEQ_HLP ALTRET( DEQ_ERR ) ;

  20969  4 003501   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003502   000000 701000 xent               TSX1    ASB$DEQ_HLP
         4 003503   003543 702000 4                  TSX2    ENQ_ERR

      922    20970    1   ENQDEQ_FLG = AS_FALSE ;

  20970  4 003504   000000 236000 xsym               LDQ     AS_FALSE
         4 003505   400000 376003                    ANQ     -131072,DU
         4 003506   000000 756000 xsym               STQ     ENQDEQ_FLG

      923    20971    1   RETURN ;

  20971  4 003507   000000 702200 xent               TSX2  ! X66_ARET

  20970  4 003510                       READ_CHAIN_* null
  20970  4 003510                       WRITE_TREC_* null
      924    20972                                                              /* Errors */
      925    20973    1   READ_CHAIN_ERR: ;
      926    20974                                                              /**/
      927    20975                                                              /**/
      928    20976    1   WRITE_TREC_ERR: ;
      929    20977    1   CALL ASH$ERROR( ERR_CODE ) ;

  20977  4 003510   000076 630400 5                  EPPR0   62
         4 003511   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:140  
         4 003512   000000 701000 xent               TSX1    ASH$ERROR
         4 003513   000000 011000                    NOP     0

      930    20978    1   RETURN ;

  20978  4 003514   000000 702200 xent               TSX2  ! X66_ARET

  20970  4 003515                       TERM_OPT_ERR null
      931    20979                                                              /**/
      932    20980    1   TERM_OPT_ERR: ;
      933    20981    1   CALL ASH$ERROR( P_PCB.ERROR ) ;

  20981  4 003515   000002 630400 5                  EPPR0   2
         4 003516   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003517   000000 701000 xent               TSX1    ASH$ERROR
         4 003520   000000 011000                    NOP     0

      934    20982    1   GOTO TERM_LOOP ;

  20982  4 003521   000767 710000 4                  TRA     TERM_LOOP

      935    20983                                                              /**/
      936    20984    1   TERM_PRO_ERR:
      937    20985        /*E* ERROR: ASA-E$PRO_NO_EXIST-C
      938    20986             MESSAGE: Profile %%U1 %does not exist.
      939    20987             MESSAGE1: The profile %%U1 %must exist in :PRO before
      940    20988                       you can use it.
      941    20989        */
      942    20990    1   AS_FIELD1 = USERS_KEY ;

  20990  4 003522   000000 100400       TERM_PRO_ERR MLR     fill='000'O
         4 003523   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         4 003524   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      943    20991        %SCREAM( ERR#=E$PRO_NO_EXIST, LEVEL=ERROR, MID='A' ) ;

  21003  4 003525   000077 630400 5                  EPPR0   63
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:141  
         4 003526   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003527   000000 701000 xent               TSX1    ASH$ERROR
         4 003530   000000 011000                    NOP     0

      944    21006    1   GOTO TERM_LOOP;

  21006  4 003531   000767 710000 4                  TRA     TERM_LOOP

  20970  4 003532                       NETCON_ERR   null
      945    21007                                                              /**/
      946    21008    1   NETCON_ERR:;
      947    21009    1   ERR_CODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  21009  4 003532   000000 470400 xsym               LDP0    B$TCB$
         4 003533   000000 471500                    LDP1    0,,PR0
         4 003534   100102 236100                    LDQ     66,,PR1
         4 003535   000000 756000 xsym               STQ     ERR_CODE

      948    21010    1   CALL ASH$ERROR(ERR_CODE);

  21010  4 003536   000076 630400 5                  EPPR0   62
         4 003537   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003540   000000 701000 xent               TSX1    ASH$ERROR
         4 003541   000000 011000                    NOP     0

      949    21011    1   RETURN;

  21011  4 003542   000000 702200 xent               TSX2  ! X66_ARET

  21009  4 003543                       ENQ_ERR      null
  21009  4 003543                       DEQ_ERR      null
      950    21012                                                              /**/
      951    21013                                                              /**/
      952    21014    1   ENQ_ERR: ;
      953    21015                                                              /**/
      954    21016    1   DEQ_ERR: ;
      955    21017    1   END   ASA$TERMINAL ;
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:142  

  21017  4 003543   000000 702200 xent               TSX2  ! X66_ARET
      956    21018        %EOD;

PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:143  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$TERMINAL.
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:144  

 **** Variables and constants ****

  ****  Section 002  Data  ASA$TERMINAL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(171)   r     1 CONFIG_KEY                 5-0-0/c STRC(162)   r     1 KL_HNDCMN
    12-0-0/c STRC(72)    r     1 KL_NA                     14-0-0/c STRC(243)   r     1 KL_SS
    30-0-0/w STRC(162)   r     1 KL_TERM_KEY               23-0-0/c STRC(171)   r     1 KL_TERM_REC
    35-0-0/w PTR         r     1 LINCNFG$
    36-0-0/w UBIN        r     1 LINCNFG_BUF(0:49)
   120-0-0/w STRC        r     1 LNGTH                    120-0-0/w UBIN        r     1 LNG_CNT
   121-0-0/w STRC(90)    r     1 TERM_KEY

  ****  Section 003 RoData ASA$TERMINAL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(252)   r     1 KL_HASPDEV                 7-0-0/w STRC(2412)  r     1 KL_TREC
   112-0-0/c CHAR(33)    r     1 TERM_TYPES
   112-0-0/c CHAR(11)    r     1 TERM_TYPE_A(0:2)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN        r     1 ARS                        5-0-0/w PTR         r     1 BLK$
     6-0-0/c CHAR(8)     r     1 CDNN                       6-0-0/c STRC(72)    r     1 CDNN_R
    10-0-0/w UBIN        r     1 CNT                       11-0-0/w UBIN        r     1 CODE2
    12-0-0/b BIT         r     1 CONSOLE_FLG               13-0-0/b BIT         r     1 CREATE
    14-0-0/w PTR         r     1 DADR$                     47-0-0/c CHAR(1000)  r     1 DEV_REC
   442-0-0/w PTR         r     1 DREC$                    443-0-0/w STRC(1008)  r     1 GJOB
   477-0-0/b BIT         r     1 GJOB_FLG                 500-0-0/b BIT         r     1 GJOB_OK
   501-0-0/w PTR         r     1 HASPDEV$                 502-0-0/w SBIN        r     1 I
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:145  
   503-0-0/w SBIN        r     1 J                        504-0-0/w SBIN        r     1 K
  1147-0-0/w STRC        r     1 KL$UBWORD                505-0-0/w SBIN        r     1 L
   506-0-0/b BIT         r     1 LOCAL                    507-0-0/b BIT         r     1 MORE
   510-0-0/b BIT         r     1 M_CONDEV                 511-0-0/w PTR         r     1 M_CONDEV$
   512-0-0/c STRC(81)    r     1 NAME                     515-0-0/c CHAR(2)     r     1 NUM
  1124-0-0/w PTR         r     1 P$                       516-0-0/w PTR         r     1 PP$
   520-0-0/w PTR         r     1 PP_END$                  517-0-0/w UBIN        r     1 PP_SIZE
   521-0-0/w UBIN        r     1 PP_TYPE                  522-0-0/w PTR         r     1 PRO$
   523-0-0/c CHAR(1024)  r     1 PRO_BUF                 1123-0-0/w PTR         r     1 PTR$
  1126-0-0/c CHAR(8)     r     1 SNAME                   1130-0-0/w PTR         r     1 SREC$
  1132-0-0/w UBIN        r     1 SUBS                    1135-0-0/w UBIN        r     1 TEMP
  1136-0-0/w PTR         r     1 TEMP$                   1137-0-0/c CHAR(7)     r     1 TERM_T
  1141-0-0/w PTR         r     1 TREC$                   1144-0-0/w UBIN        r     1 TWSN#
  1142-0-0/c CHAR(4)     r     1 TWSNC                   1143-0-0/w PTR         r     1 TWSNR$
  1145-0-0/w UBIN        r     1 TWSN_ARS                1146-0-0/w UBIN        r     1 TWSN_INDEX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/c CHAR(20)    r     1 AS_CREATED_TEXT
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w STRC(369)   r     1 AS_FIELD2                  0-0-0/w STRC(369)   r     1 AS_FIELD3
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w UBIN        r     1 DSEG1SIZE                  0-0-0/w PTR         r     1 DSEG2$
     0-0-0/w UBIN        r     1 DSEG2SIZE                  0-0-0/w PTR         r     1 DSEG3$
     0-0-0/w UBIN        r     1 DSEG3SIZE                  0-0-0/b BIT         r     1 DSEG_FLG
     0-0-0/b BIT         r     1 ENQDEQ_FLG                 0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/c STRC(189)   r     1 FROM_KEY                   0-0-0/c CHAR(255)   r     1 IN_BUF
     0-0-0/w STRC(576)   r     1 KL_DREC_CNT                0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/d REMB        r     1 REMEM_VAR
     0-0-0/w UBIN        r     1 TERMINAL_CMD               0-0-0/w UBIN        r     1 TERM_OPT_LIST
     0-0-0/c CHAR(2)     r     1 TYPE                       0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:146  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 ACHAR                      0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(252)   r     1 KL$HASPDEV
     0-0-0/c STRC(720)   r     1 KL$PHDR                    0-0-0/w STRC(576)   r     1 KL$SREC
     0-0-0/w STRC(2412)  r     1 KL$TREC                    0-0-0/b STRC(126)   r     1 KL$TRMD
     0-0-0/w STRC(576)   r     1 KL$TWSNREC                 0-0-0/w ASTR(387)   r     1 LINCNFG
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(144)   r     1 P$NODE
     0-0-0/b STRC(18)    r     1 PP$STRCT


   Procedure ASA$TERMINAL requires 1892 words for executable code.
   Procedure ASA$TERMINAL requires 626 words of local(AUTO) storage.
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:147  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:148  
          MINI XREF LISTING

ACHAR
     18651**DCL     20422>>CALLBLT 20424>>CALLBLT 20426>>CALLBLT 20429<<ASSIGN
ARS
     17663**DCL     20086<<ASSIGN  20089<>CALL    20091<>CALL    20232<<ASSIGN  20235<>CALL    20263<>CALL
     20269<<ASSIGN  20272<>CALL    20300>>ASSIGN  20345<>CALL    20346>>ASSIGN  20463<<ASSIGN  20466<>CALL
     20495>>ASSIGN  20592<<ASSIGN  20595<>CALL    20639<<ASSIGN  20642<>CALL    20721<<ASSIGN  20722<>CALL
     20952<<ASSIGN  20954<>CALL
ASA$CON_OPTS
     19924**DCL-ENT 20587--CALL    20709--CALL
ASA$DEV_OPTS
     19927**DCL-ENT 20629--CALL    20713--CALL
ASA$ERROR
     19930**DCL-ENT 20701--CALL
ASA_BRKS_LOC
     13216**DCL     13216--REDEF
ASB$CHECK_TYPE
     19933**DCL-ENT 20091--CALL    20263--CALL    20706--CALL
ASB$CLOSE_NETCON
     19936**DCL-ENT 20962--CALL
ASB$DEQ_HLP
     19942**DCL-ENT 20113--CALL    20258--CALL    20294--CALL    20969--CALL
ASB$ENQ_HLP
     19945**DCL-ENT 20087--CALL    20233--CALL    20270--CALL    20967--CALL
ASB$FIND_TWSN_INDEX
     19951**DCL-ENT 20704--CALL
ASB$GETSEG
     19954**DCL-ENT 20035--CALL
ASB$READ_HLP
     19957**DCL-ENT 20089--CALL    20235--CALL    20272--CALL    20700--CALL
ASB$READ_NETCON
     19960**DCL-ENT 20691--CALL
ASB$READ_SI
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:149  
     19963**DCL-ENT 20345--CALL
ASB$SET_PROMPT
     19966**DCL-ENT 20343--CALL
ASB$VALID_TDEVICE
     19969**DCL-ENT 20661--CALL
ASB$WRITE_HLP
     19972**DCL-ENT 20595--CALL    20642--CALL    20722--CALL    20954--CALL    20968--CALL
ASB$WRITE_LO
     19975**DCL-ENT 20599--CALL    20646--CALL
ASB$WRITE_NETCON
     19978**DCL-ENT 20608--CALL    20655--CALL    20726--CALL    20961--CALL
ASD$READ_PRO
     19981**DCL-ENT 20466--CALL
ASH$DQUEST
     19984**DCL-ENT 20915--CALL
ASH$ERROR
     19987**DCL-ENT 20022--CALL    20049--CALL    20077--CALL    20110--CALL    20166--CALL    20195--CALL
     20291--CALL    20384--CALL    20413--CALL    20457--CALL    20484--CALL    20561--CALL    20681--CALL
     20759--CALL    20785--CALL    20811--CALL    20837--CALL    20886--CALL    20977--CALL    20981--CALL
     21003--CALL    21010--CALL
ASH$HELP
     19990**DCL-ENT 20909--CALL
ASH$QUEST
     19996**DCL-ENT 20912--CALL
ASH$WARN
     19999**DCL-ENT 20137--CALL    20253--CALL    20939--CALL
ASZ$SCRAMBLE
     20002**DCL-ENT 20314--CALL    20315--CALL    20362--CALL    20390--CALL    20853--CALL
AS_BLANK
     13076**DCL     20124>>CALLBLT 20178>>CALLBLT 20229>>CALLBLT 20240>>CALLBLT 20361>>ASSIGN  20864>>ASSIGN
AS_CREATED_TEXT
     13090**DCL     20599<>CALL    20599--CALL    20646<>CALL    20646--CALL
AS_DEFAULT.BANNER_PERM
     13909**DCL     13910--REDEF
AS_DEFAULT.BUDGET.MACCT
     13814**DCL     13818--REDEF
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:150  
AS_DEFAULT.BUDGET.MAX_PROJECTS
     13827**DCL     13830--REDEF
AS_DEFAULT.BUDGET.PACCUM
     13810**DCL     13812--REDEF
AS_DEFAULT.BUDGET.PMAXC
     13805**DCL     13807--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     13925**DCL     13926--REDEF   13927--REDEF
AS_DEFAULT_DREC.PASSWORD
     15179**DCL     15183--REDEF
AS_DEFAULT_DREC.RENAME
     15202**DCL     15203--REDEF
AS_DFLT.BANNER_PERM
     13731**DCL     13732--REDEF
AS_DFLT.BUDGET.MACCT
     13636**DCL     13640--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     13649**DCL     13652--REDEF
AS_DFLT.BUDGET.PACCUM
     13632**DCL     13634--REDEF
AS_DFLT.BUDGET.PMAXC
     13627**DCL     13629--REDEF
AS_DFLT.SETUP_CHRA.TXT
     13747**DCL     13748--REDEF   13749--REDEF
AS_FALSE
     13076**DCL     20018>>ASSIGN  20114>>ASSIGN  20226>>ASSIGN  20259>>ASSIGN  20295>>ASSIGN  20336>>ASSIGN
     20612>>ASSIGN  20730>>ASSIGN  20921>>ASSIGN  20970>>ASSIGN
AS_FE_MODE
     13082**DCL     13083--REDEF
AS_FIELD1
     13212**DCL     20097<<ASSIGN  20177<<ASSIGN  20278<<ASSIGN  20990<<ASSIGN
AS_FIELD1.COUNT
     13213**DCL     20125<<ASSIGN  20241<<ASSIGN  20526<<ASSIGN  20667<<ASSIGN
AS_FIELD1.TEXT
     13213**DCL     20126<<ASSIGN  20242<<ASSIGN  20529<<ASSIGN  20532<<ASSIGN  20535<<ASSIGN  20538<<ASSIGN
     20541<<ASSIGN  20544<<ASSIGN  20668<<ASSIGN
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:151  
AS_FIELD2.COUNT
     13213**DCL     20179<<ASSIGN  20547<<ASSIGN
AS_FIELD2.TEXT
     13213**DCL     20180<<ASSIGN  20548<<ASSIGN
AS_FIELD3.COUNT
     13214**DCL     20181<<ASSIGN
AS_FIELD3.TEXT
     13214**DCL     20182<<ASSIGN
AS_MODE
     13079**DCL     13081--REDEF
AS_MOD_USER.ACCESS
     15944**DCL     15945--REDEF
AS_MOD_USER.BANNER
     15931**DCL     15932--REDEF
AS_MOD_USER.BANNER_PERM
     15933**DCL     15934--REDEF
AS_MOD_USER.BILL
     15939**DCL     15940--REDEF
AS_MOD_USER.CPROC
     15935**DCL     15936--REDEF
AS_MOD_USER.FEBILL
     16015**DCL     16016--REDEF
AS_MOD_USER.FECXTMEM
     16032**DCL     16033--REDEF
AS_MOD_USER.FEMINTS
     16017**DCL     16018--REDEF
AS_MOD_USER.FEMMEM
     16028**DCL     16029--REDEF
AS_MOD_USER.FEMTIME
     16026**DCL     16027--REDEF
AS_MOD_USER.FEPPRIV
     16023**DCL     16025--REDEF
AS_MOD_USER.FEPRIV
     16020**DCL     16022--REDEF
AS_MOD_USER.FORCE_BIT
     15929**DCL     15930--REDEF
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:152  
AS_MOD_USER.KEY
     16011**DCL     16013--REDEF
AS_MOD_USER.LASTCPROC
     15937**DCL     15938--REDEF
AS_MOD_USER.LIMITS.DO_
     15985**DCL     15986--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     16001**DCL     16002--REDEF
AS_MOD_USER.LIMITS.LO
     15981**DCL     15982--REDEF
AS_MOD_USER.LIMITS.MEM
     15977**DCL     15978--REDEF
AS_MOD_USER.LIMITS.MPRIO
     16005**DCL     16006--REDEF
AS_MOD_USER.LIMITS.PDIS
     15993**DCL     15994--REDEF
AS_MOD_USER.LIMITS.PO
     15989**DCL     15990--REDEF
AS_MOD_USER.LIMITS.TDIS
     15997**DCL     15998--REDEF
AS_MOD_USER.LIMITS.TIME
     15973**DCL     15974--REDEF
AS_MOD_USER.MAXENQ
     15954**DCL     15955--REDEF
AS_MOD_USER.PERM_BIT
     15927**DCL     15928--REDEF
AS_MOD_USER.PPRIV
     15949**DCL     15951--REDEF
AS_MOD_USER.PRIOB
     15956**DCL     15957--REDEF
AS_MOD_USER.PRIV
     15946**DCL     15948--REDEF
AS_MOD_USER.QUAN
     15952**DCL     15953--REDEF
AS_MOD_USER.SETUP
     15925**DCL     15926--REDEF
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:153  
AS_PROJECT.BANNER_PERM
     14265**DCL     14266--REDEF
AS_PROJECT.BUDGET.MACCT
     14170**DCL     14174--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     14183**DCL     14186--REDEF
AS_PROJECT.BUDGET.PACCUM
     14166**DCL     14168--REDEF
AS_PROJECT.BUDGET.PMAXC
     14161**DCL     14163--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     14281**DCL     14282--REDEF   14283--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     14443**DCL     14444--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     14348**DCL     14352--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     14361**DCL     14364--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     14344**DCL     14346--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     14339**DCL     14341--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     14459**DCL     14460--REDEF   14461--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     15665**DCL     15669--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     15688**DCL     15689--REDEF
AS_PROJECT_DREC.PASSWORD
     15503**DCL     15507--REDEF
AS_PROJECT_DREC.RENAME
     15526**DCL     15527--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     14087**DCL     14088--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     13992**DCL     13996--REDEF
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:154  
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     14005**DCL     14008--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     13988**DCL     13990--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     13983**DCL     13985--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     14103**DCL     14104--REDEF   14105--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     15341**DCL     15345--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     15364**DCL     15365--REDEF
AS_TRUE
     13076**DCL     20016>>ASSIGN  20088>>ASSIGN  20142>>ASSIGN  20225>>ASSIGN  20234>>ASSIGN  20271>>ASSIGN
     20335>>ASSIGN  20570>>ASSIGN  20696>>ASSIGN  20704<>CALL
AS_USERS.BANNER_PERM
     13553**DCL     13554--REDEF
AS_USERS.BUDGET.MACCT
     13458**DCL     13462--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     13471**DCL     13474--REDEF
AS_USERS.BUDGET.PACCUM
     13454**DCL     13456--REDEF
AS_USERS.BUDGET.PMAXC
     13449**DCL     13451--REDEF
AS_USERS.SETUP_CHRA.TXT
     13569**DCL     13570--REDEF   13571--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     14621**DCL     14622--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     14526**DCL     14530--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     14539**DCL     14542--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     14522**DCL     14524--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:155  
     14517**DCL     14519--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     14637**DCL     14638--REDEF   14639--REDEF
B$ALT.CODE
     18644**DCL     18644--REDEF   18645--REDEF   18645--REDEF
B$ALT.ERR
     18645**DCL     21009>>ASSIGN
B$ALT.ERR.ERR#
     18646**DCL     18646--REDEF
B$ALT.EVID
     18645**DCL     18645--REDEF   18645--REDEF
B$TCB.ALT$
     18640**DCL     21009>>ASSIGN
B$TCB$
     17763**DCL     21009>>ASSIGN
BLK$
     17665**DCL     19887--IMP-PTR 20059<<ASSIGN  20060>>IF      20082>>ASSIGN  20083>>ASSIGN  20083>>ASSIGN
     20152<<ASSIGN  20153>>IF      20171>>ASSIGN  20171>>ASSIGN  20181>>ASSIGN  20182>>ASSIGN  20182>>ASSIGN
     20365<<ASSIGN  20366>>ASSIGN  20389>>ASSIGN  20389>>ASSIGN  20393<<ASSIGN  20394>>ASSIGN  20418>>ASSIGN
     20441<<ASSIGN  20442>>IF      20464>>ASSIGN  20465>>ASSIGN  20465>>ASSIGN  20566>>ASSIGN  20567>>ASSIGN
     20567>>ASSIGN  20659<<ASSIGN  20661>>CALL    20661>>CALL    20663>>ASSIGN  20663>>ASSIGN  20667>>ASSIGN
     20668>>ASSIGN  20668>>ASSIGN  20741<<ASSIGN  20742>>IF      20765>>ASSIGN  20765>>ASSIGN  20767<<ASSIGN
     20768>>IF      20791>>ASSIGN  20791>>ASSIGN  20793<<ASSIGN  20794>>IF      20817>>ASSIGN  20817>>ASSIGN
     20819<<ASSIGN  20820>>IF      20843>>ASSIGN  20844>>ASSIGN  20844>>ASSIGN  20868<<ASSIGN  20869>>IF
     20891>>ASSIGN  20891>>ASSIGN  20899<<ASSIGN  20900>>IF
CDNN
     17666**DCL     17667--REDEF   20663<<ASSIGN  20704<>CALL
CDNN_R.NUM
     17669**DCL     20665>>ASSIGN
CDNN_R.TYPE
     17668**DCL     20664>>ASSIGN
CNT
     17671**DCL     20366<<ASSIGN  20367>>IF      20394<<ASSIGN  20395>>IF
CODE
     13209**DCL     20205<<ASSIGN  20207>>DOSELCT 20352<<ASSIGN  20353>>DOSELCT 20738<<ASSIGN  20739>>DOSELCT
CODE2
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:156  
     17672**DCL     20356<<ASSIGN  20357>>DOSELCT 20858<<ASSIGN  20860>>DOSELCT
CONFIG_KEY
     17787**DCL     20608--CALL    20655--CALL    20691--CALL    20726--CALL
CONFIG_KEY.TERMID
     17807**DCL     20600<<ASSIGN  20647<<ASSIGN  20690<<ASSIGN
CONFIG_KEY.TERMID.TERM
     17809**DCL     17818--REDEF
CONSOLE_FLG
     17673**DCL     20570<<ASSIGN  20612<<ASSIGN
CREATE
     17674**DCL     20016<<ASSIGN  20018<<ASSIGN  20091<>CALL    20092>>IF      20120>>IF      20142<<ASSIGN
     20172>>IF      20263<>CALL    20302>>IF      20956>>IF
DADR$
     17675**DCL     20586<<ASSIGN  20587<>CALL    20628<<ASSIGN  20629<>CALL    20707<<ASSIGN  20709<>CALL
     20713<>CALL
DEQ_ERR
     21009**LABEL   20969--CALLALT
DEV_REC
     17678**DCL     20013--ASSIGN  20699--ASSIGN
DREC$
     17680**DCL     20013<<ASSIGN  20587<>CALL    20589>>ASSIGN  20590>>ASSIGN  20591>>ASSIGN  20592>>ASSIGN
     20595<>CALL    20629<>CALL    20632>>ASSIGN  20633>>ASSIGN  20636>>ASSIGN  20637>>ASSIGN  20638>>ASSIGN
     20639>>ASSIGN  20642<>CALL    20700<>CALL    20704<>CALL    20705>>IF      20706<>CALL    20708>>IF
     20709<>CALL    20710>>ASSIGN  20713<>CALL    20715>>ASSIGN  20716>>ASSIGN  20721>>ASSIGN  20722<>CALL
DSEG1$
     13217**DCL     20055>>ASSIGN  20089<>CALL    20091<>CALL
DSEG1SIZE
     13218**DCL     20086>>ASSIGN
DSEG2$
     13218**DCL     20056>>ASSIGN
DSEG2SIZE
     13218**DCL     20269>>ASSIGN
DSEG3$
     13218**DCL     20057>>ASSIGN  20235<>CALL    20263<>CALL
DSEG3SIZE
     13218**DCL     20232>>ASSIGN
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:157  
DSEG_FLG
     13217**DCL     20033>>IF
ENQDEQ_FLG
     13219**DCL     20088<<ASSIGN  20114<<ASSIGN  20234<<ASSIGN  20259<<ASSIGN  20271<<ASSIGN  20295<<ASSIGN
     20970<<ASSIGN
ENQ_ERR
     21009**LABEL   20087--CALLALT 20233--CALLALT 20270--CALLALT 20967--CALLALT
ERR_CODE
     13211**DCL     13212--REDEF   20977<>CALL    21009<<ASSIGN  21010<>CALL
EXIT#
     20113**LABEL   20091--CALLALT 20263--CALLALT
FOUND_IT
     20517**LABEL   20505--GOTO
FROM_KEY.TEXT
     13090**DCL     20594>>ASSIGN  20641>>ASSIGN
GJOB
     17698**DCL     20734<<ASSIGN  20854>>ASSIGN
GJOB.ACCT
     17702**DCL     20791<<ASSIGN
GJOB.CMD
     17706**DCL     20844<<ASSIGN
GJOB.CMDCNT
     17705**DCL     20843<<ASSIGN
GJOB.PASS
     17704**DCL     20817<<ASSIGN  20853<>CALL
GJOB.UNAME
     17703**DCL     20765<<ASSIGN
GJOB_FLG
     17708**DCL     20733<<ASSIGN  20847<<ASSIGN  20852>>ASSIGN
GJOB_OK
     17709**DCL     20735<<ASSIGN  20737>>DOWHILE 20762<<ASSIGN  20788<<ASSIGN  20814<<ASSIGN  20840<<ASSIGN
     20851>>IF
HASPDEV$
     17710**DCL     19221--IMP-PTR 20317<<ASSIGN  20328<<ASSIGN  20572>>ASSIGN  20573>>ASSIGN  20574>>ASSIGN
     20578>>ASSIGN  20579>>ASSIGN  20580>>ASSIGN  20581>>ASSIGN  20582>>ASSIGN  20583>>ASSIGN  20584>>ASSIGN
     20585>>ASSIGN  20586>>ASSIGN  20600>>ASSIGN  20609<<ASSIGN  20609>>ASSIGN  20614>>ASSIGN  20615>>ASSIGN
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:158  
     20616>>ASSIGN  20620>>ASSIGN  20621>>ASSIGN  20622>>ASSIGN  20623>>ASSIGN  20624>>ASSIGN  20625>>ASSIGN
     20626>>ASSIGN  20627>>ASSIGN  20628>>ASSIGN  20647>>ASSIGN  20656<<ASSIGN  20656>>ASSIGN
I
     17711**DCL     20124<<CALLBLT 20125>>ASSIGN  20149<<DOINDEX 20150>>IF      20152>>ASSIGN  20178<<CALLBLT
     20179>>ASSIGN  20203>>IF      20205>>ASSIGN  20229<<CALLBLT 20230>>ASSIGN  20240<<CALLBLT 20241>>ASSIGN
     20329<<CALLBLT 20350<<DOINDEX 20351>>ASSIGN  20509<<ASSIGN
IN_BUF
     13207**DCL     20345<>CALL
J
     17712**DCL     20424<<CALLBLT 20427>>ASSIGN  20688<<DOINDEX 20689>>ASSIGN  20736<<ASSIGN  20737>>DOWHILE
     20738>>ASSIGN  20741>>ASSIGN  20767>>ASSIGN  20793>>ASSIGN  20819>>ASSIGN  20849<<ASSIGN  20849>>ASSIGN
K
     17713**DCL     20426<<CALLBLT 20427>>ASSIGN  20699<<ASSIGN  20700<>CALL    20706<>CALL
KL$DREC.PASSWORD
     18840**DCL     18844--REDEF
KL$DREC.RENAME
     18863**DCL     18864--REDEF
KL$HASPDEV
     19221**DCL     20572<<ASSIGN  20614<<ASSIGN
KL$HASPDEV.BLKHDR.BLKTYP
     19278**DCL     20574<<ASSIGN  20616<<ASSIGN
KL$HASPDEV.BLKHDR.DEVNUM
     19305**DCL     20580<<ASSIGN  20583>>ASSIGN  20622<<ASSIGN  20625>>ASSIGN
KL$HASPDEV.BLKHDR.LEN.BYT
     19271**DCL     20578<<ASSIGN  20579<<ASSIGN  20620<<ASSIGN  20621<<ASSIGN
KL$HASPDEV.BLKHDR.LEV
     19254**DCL     20573<<ASSIGN  20615<<ASSIGN
KL$HASPDEV.DADR
     19407**DCL     20586--ASSIGN  20628--ASSIGN  20707--ASSIGN
KL$HASPDEV.TERMID
     19369**DCL     20600>>ASSIGN  20647>>ASSIGN  20690>>ASSIGN
KL$HASPDEV.TERMID.LEV
     19371**DCL     20582<<ASSIGN  20624<<ASSIGN
KL$HASPDEV.TERMID.TERM
     19371**DCL     19380--REDEF
KL$HASPDEV.TERMID.TERM.SUBDEVICE.BYT
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:159  
     19374**DCL     20584<<ASSIGN  20585<<ASSIGN  20626<<ASSIGN  20627<<ASSIGN
KL$HASPDEV.TERMID.TERM.TERM_NAME
     19380**DCL     20581<<ASSIGN  20623<<ASSIGN
KL$PHDR
     19613**DCL     20466<>CALL    20496--ASSIGN
KL$PHDR.TTYP
     19614**DCL     20467>>IF
KL$SREC.PASSWORD
     18725**DCL     18729--REDEF
KL$SREC.RENAME
     18748**DCL     18749--REDEF
KL$SREC.TWSN#
     18722**DCL     20264>>ASSIGN
KL$TREC
     18926**DCL     20304<<ASSIGN
KL$TREC.ATYP
     18931**DCL     20308<<ASSIGN
KL$TREC.FLAGS.GJOB
     18952**DCL     20852<<ASSIGN
KL$TREC.FLAGS.RNME
     18937**DCL     20589<<ASSIGN  20633<<ASSIGN  20710<<ASSIGN  20716<<ASSIGN
KL$TREC.GJOB
     19045**DCL     20854<<ASSIGN  20951--ASSIGN
KL$TREC.GJOB.PASS
     19049**DCL     20315<>CALL
KL$TREC.HASP
     19072**DCL     20317--ASSIGN  20317--ASSIGN  20321--ASSIGN  20328--ASSIGN  20328--ASSIGN  20689--ASSIGN
     20689--ASSIGN  20951--ASSIGN
KL$TREC.HASP.BLKHDR.BLKTYP
     19116**DCL     20320<<ASSIGN
KL$TREC.HASP.BLKHDR.LEN.BYT
     19109**DCL     20324<<ASSIGN  20325<<ASSIGN
KL$TREC.HASP.BLKHDR.LEV
     19092**DCL     20318<<ASSIGN
KL$TREC.HASP.BLKHDR.NSUBS
     19103**DCL     20319<<ASSIGN  20328>>ASSIGN  20580>>ASSIGN  20588<<ASSIGN  20588>>ASSIGN  20622>>ASSIGN
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:160  
     20635<<ASSIGN  20635>>ASSIGN  20666>>IF      20688>>DOINDEX 20919>>IF      20951>>ASSIGN
KL$TREC.HASP.BLKHDR.USE
     19147**DCL     20636<<ASSIGN
KL$TREC.HASP.RLS#
     19197**DCL     20864<<ASSIGN  20891<<ASSIGN
KL$TREC.HASP.SLAVE#
     19190**DCL     20897<<ASSIGN  20901<<ASSIGN  20903<<ASSIGN
KL$TREC.NWINFO
     19024**DCL     20592>>ASSIGN  20639>>ASSIGN  20721>>ASSIGN  20951<<ASSIGN  20952>>ASSIGN
KL$TREC.PASSWORD
     18984**DCL     18988--REDEF   20314<>CALL    20361<<ASSIGN  20362<>CALL    20389<<ASSIGN  20390<>CALL
     20420--ASSIGN
KL$TREC.PNAME.CNT
     18998**DCL     20311<<ASSIGN  20313<<ASSIGN  20437<<ASSIGN  20566<<ASSIGN
KL$TREC.PNAME.TXT
     19001**DCL     20309<<ASSIGN  20329>>CALLBLT 20331>>ASSIGN  20438<<ASSIGN  20567<<ASSIGN
KL$TREC.RENAME
     19007**DCL     19008--REDEF   20632<<ASSIGN  20715<<ASSIGN
KL$TREC.SNAME
     19021**DCL     20117>>ASSIGN  20172>>IF      20178>>CALLBLT 20180>>ASSIGN  20198>>ASSIGN  20307<<ASSIGN
     20591<<ASSIGN  20638<<ASSIGN
KL$TREC.SUPER
     18978**DCL     20305<<ASSIGN  20636>>ASSIGN  20705>>IF      20708>>IF
KL$TREC.TNAME
     19017**DCL     20306<<ASSIGN  20590<<ASSIGN  20637<<ASSIGN
KL$TREC.TWSN#
     18981**DCL     20316<<ASSIGN
KL$TRMD.PROTYP#
     19663**DCL     20517>>IF      20517>>IF      20517>>IF      20517>>IF      20527>>DOSELCT
KL$TWSNREC.DEVS
     19813**DCL     20598--ASSIGN  20645--ASSIGN
KL$TWSNREC.DEVS.TERM
     19828**DCL     20596<<ASSIGN  20643<<ASSIGN  20723<<ASSIGN
KL$TWSNREC.NDEV
     19812**DCL     20571>>ASSIGN  20597<<ASSIGN  20613>>ASSIGN  20644<<ASSIGN
KL$UBWORD.NUM
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:161  
     17751**DCL     17752--REDEF
KL$UBWORD.REPLACE.B
     17756**DCL     20323<<ASSIGN  20325>>ASSIGN  20577<<ASSIGN  20579>>ASSIGN  20619<<ASSIGN  20621>>ASSIGN
KL$UBWORD.REPLACE.T
     17754**DCL     20322<<ASSIGN  20324>>ASSIGN  20576<<ASSIGN  20578>>ASSIGN  20618<<ASSIGN  20620>>ASSIGN
KL_DEFAULT.PASSWORD
     15827**DCL     15831--REDEF
KL_DEFAULT.RENAME
     15850**DCL     15851--REDEF
KL_DFLT.PASSWORD
     15017**DCL     15021--REDEF
KL_DFLT.RENAME
     15040**DCL     15041--REDEF
KL_DREC.PASSWORD
     14855**DCL     14859--REDEF
KL_DREC.RENAME
     14878**DCL     14879--REDEF
KL_DREC_CNT
     14684**DCL     20592--ASSIGN  20639--ASSIGN  20721--ASSIGN  20952--ASSIGN
KL_DREC_CNT.PASSWORD
     14742**DCL     14746--REDEF
KL_DREC_CNT.RENAME
     14765**DCL     14766--REDEF
KL_HASPDEV
     18115**DCL     20328--ASSIGN  20572>>ASSIGN  20575--ASSIGN  20609--ASSIGN  20614>>ASSIGN  20617--ASSIGN
     20656--ASSIGN  20689--ASSIGN  20951--ASSIGN
KL_HASPDEV.TERMID.TERM
     18265**DCL     18274--REDEF
KL_HNDCMN
     17838**DCL     20602>>ASSIGN  20649>>ASSIGN
KL_NA
     17919**DCL     20603>>ASSIGN  20650>>ASSIGN
KL_SS
     17971**DCL     20587<>CALL    20629<>CALL    20709<>CALL    20713<>CALL
KL_SS.CNT
     17975**DCL     20606>>ASSIGN  20653>>ASSIGN  20692<<ASSIGN  20724>>ASSIGN
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:162  
KL_SS.SGN
     17976**DCL     17985--REDEF
KL_SS.SGN.NUM
     17978**DCL     20694>>IF
KL_SS.SGN.TYPE
     17977**DCL     20631>>IF      20694>>IF
KL_SS.SGN_R
     17985**DCL     20607>>ASSIGN  20654>>ASSIGN  20693<<ASSIGN  20725>>ASSIGN
KL_TERM_KEY
     18051**DCL     20961--CALL
KL_TERM_KEY.TERMID.TERM
     18072**DCL     18081--REDEF
KL_TERM_KEY.TERMID.TERM.TERM_NAME
     18081**DCL     20959<<ASSIGN
KL_TERM_REC
     18002**DCL     20960<<ASSIGN  20961--CALL
KL_TERM_REC.TERMID.TERM
     18024**DCL     18033--REDEF
KL_TREC
     18354**DCL     20304>>ASSIGN
KL_TREC.GJOB
     18473**DCL     20734>>ASSIGN
KL_TREC.PASSWORD
     18412**DCL     18416--REDEF
KL_TREC.RENAME
     18435**DCL     18436--REDEF
L
     17714**DCL     20422<<CALLBLT 20427>>ASSIGN  20510<<ASSIGN  20511>>ASSIGN
LINCNFG
     19459**DCL     20608--CALL    20655--CALL    20726--CALL
LINCNFG.KHA
     19478**DCL     20602<<ASSIGN  20649<<ASSIGN
LINCNFG.LGN.LGNSIZE
     19596**DCL     19597--IMP-SIZ 20606<<ASSIGN  20607>>ASSIGN  20608>>CALL    20653<<ASSIGN  20654>>ASSIGN
     20655>>CALL    20692>>ASSIGN  20693>>ASSIGN  20724<<ASSIGN  20725>>ASSIGN  20726>>CALL
LINCNFG.LGN.LGNSTRING
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:163  
     19597**DCL     20607<<ASSIGN  20654<<ASSIGN  20693>>ASSIGN  20725<<ASSIGN
LINCNFG.NA
     19558**DCL     20603<<ASSIGN  20650<<ASSIGN
LINCNFG.NA.AUTLGN
     19565**DCL     20605<<ASSIGN  20652<<ASSIGN
LINCNFG.NA.SNDSLT
     19563**DCL     20604<<ASSIGN  20651<<ASSIGN
LINCNFG$
     18084**DCL     19459--IMP-PTR 20602>>ASSIGN  20603>>ASSIGN  20604>>ASSIGN  20605>>ASSIGN  20606>>ASSIGN
     20607>>ASSIGN  20607>>ASSIGN  20608>>CALL    20608>>CALL    20649>>ASSIGN  20650>>ASSIGN  20651>>ASSIGN
     20652>>ASSIGN  20653>>ASSIGN  20654>>ASSIGN  20654>>ASSIGN  20655>>CALL    20655>>CALL    20692>>ASSIGN
     20693>>ASSIGN  20693>>ASSIGN  20724>>ASSIGN  20725>>ASSIGN  20725>>ASSIGN  20726>>CALL    20726>>CALL
LINCNFG_BUF
     18085**DCL     18084--DCLINIT 20601<<ASSIGN  20648<<ASSIGN  20691--CALL
LNGTH
     18086**DCL     18089--REDEF
LNGTH.B
     18088**DCL     20323>>ASSIGN  20577>>ASSIGN  20585>>ASSIGN  20619>>ASSIGN  20627>>ASSIGN
LNGTH.T
     18087**DCL     20322>>ASSIGN  20576>>ASSIGN  20584>>ASSIGN  20618>>ASSIGN  20626>>ASSIGN
LNG_CNT
     18089**DCL     20321<<ASSIGN  20575<<ASSIGN  20583<<ASSIGN  20617<<ASSIGN  20625<<ASSIGN
LOCAL
     17715**DCL     20225<<ASSIGN  20226<<ASSIGN  20587<>CALL    20709<>CALL
MORE
     17716**DCL     20335<<ASSIGN  20339>>DOWHILE 20921<<ASSIGN
M_CONDEV
     17717**DCL     20336<<ASSIGN  20696<<ASSIGN  20730<<ASSIGN
M_CONDEV$
     17718**DCL     20689<<ASSIGN  20690>>ASSIGN  20707>>ASSIGN
NAME
     17719**DCL     20091<>CALL    20097>>ASSIGN  20177>>ASSIGN  20263<>CALL
NAME.COUNT
     17720**DCL     20082<<ASSIGN  20230<<ASSIGN
NAME.TEXT
     17721**DCL     20083<<ASSIGN  20084>>ASSIGN  20231<<ASSIGN
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:164  
NETCON_ERR
     20970**LABEL   20608--CALLALT 20655--CALLALT 20691--CALLALT 20726--CALLALT 20961--CALLALT
NODE$
     13209**DCL     19840--IMP-PTR 20014>>IF      20026<<ASSIGN  20027>>ASSIGN  20059>>ASSIGN  20150>>IF
     20152>>ASSIGN  20203>>IF      20205>>ASSIGN  20348<<ASSIGN  20350>>DOINDEX 20351>>ASSIGN
NUM
     17722**DCL     20665<<ASSIGN  20694>>IF      20698>>CALLBLT 20719>>CALLBLT
OUT$SYM
     19887**DCL     20661<>CALL
OUT$SYM.COUNT
     19910**DCL     19913--IMP-SIZ 20060>>IF      20082>>ASSIGN  20083>>ASSIGN  20153>>IF      20171>>ASSIGN
     20181>>ASSIGN  20182>>ASSIGN  20366>>ASSIGN  20389>>ASSIGN  20394>>ASSIGN  20442>>IF      20464>>ASSIGN
     20465>>ASSIGN  20566>>ASSIGN  20567>>ASSIGN  20661>>CALL    20663>>ASSIGN  20667>>ASSIGN  20668>>ASSIGN
     20742>>IF      20765>>ASSIGN  20768>>IF      20791>>ASSIGN  20794>>IF      20817>>ASSIGN  20820>>IF
     20843>>ASSIGN  20844>>ASSIGN  20869>>IF      20891>>ASSIGN
OUT$SYM.TEXT
     19913**DCL     20083>>ASSIGN  20171>>ASSIGN  20182>>ASSIGN  20389>>ASSIGN  20418--ASSIGN  20465>>ASSIGN
     20567>>ASSIGN  20663>>ASSIGN  20668>>ASSIGN  20765>>ASSIGN  20791>>ASSIGN  20817>>ASSIGN  20844>>ASSIGN
     20891>>ASSIGN
P$
     17730**DCL     20418<<ASSIGN  20419>>ASSIGN  20421>>DOWHILE 20422>>CALLBLT 20423<<ASSIGN  20423>>ASSIGN
     20424>>CALLBLT 20425<<ASSIGN  20425>>ASSIGN  20426>>CALLBLT 20428<<ASSIGN  20428>>ASSIGN
P$NODE.CODE
     19848**DCL     20014>>IF      20150>>IF      20203>>IF      20205>>ASSIGN  20352>>ASSIGN  20356>>ASSIGN
     20436>>IF      20738>>ASSIGN  20858>>ASSIGN  20900>>IF
P$NODE.SUBLK$
     19873**DCL     20014>>IF      20059>>ASSIGN  20059>>ASSIGN  20150>>IF      20152>>ASSIGN  20152>>ASSIGN
     20203>>IF      20205>>ASSIGN  20205>>ASSIGN  20351>>ASSIGN  20356>>ASSIGN  20365>>ASSIGN  20393>>ASSIGN
     20393>>ASSIGN  20441>>ASSIGN  20659>>ASSIGN  20659>>ASSIGN  20738>>ASSIGN  20741>>ASSIGN  20741>>ASSIGN
     20767>>ASSIGN  20767>>ASSIGN  20793>>ASSIGN  20819>>ASSIGN  20858>>ASSIGN  20868>>ASSIGN  20899>>ASSIGN
P$NODE.SUBNODES
     19852**DCL     20027>>ASSIGN  20350>>DOINDEX 20737>>DOWHILE 20896>>IF
PP$
     17723**DCL     19641--IMP-PTR 20494<<ASSIGN  20495>>ASSIGN  20496<<ASSIGN  20496>>ASSIGN  20497>>DOWHILE
     20498>>ASSIGN  20499>>ASSIGN  20500<<ASSIGN  20500>>ASSIGN  20511<<ASSIGN  20511>>ASSIGN  20517>>IF
     20517>>IF      20517>>IF      20517>>IF      20527>>DOSELCT
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:165  
PP$STRCT.SIZE
     19643**DCL     20499>>ASSIGN
PP$STRCT.TYPE
     19642**DCL     20498>>ASSIGN
PP_END$
     17725**DCL     20495<<ASSIGN  20497>>DOWHILE
PP_SIZE
     17724**DCL     20499<<ASSIGN  20509>>ASSIGN  20509>>ASSIGN  20510>>ASSIGN  20510>>ASSIGN
PP_TYPE
     17726**DCL     20498<<ASSIGN  20502>>DOSELCT
PRO$
     17727**DCL     19613--IMP-PTR 20462<<ASSIGN  20466>>CALL    20467>>IF      20494>>ASSIGN
PROJ_KEY.TEXT
     13089**DCL     13089--REDEF
PROJ_KEY.TXT.PROJECT
     13089**DCL     13089--REDEF
PRO_BUF
     17728**DCL     20462--ASSIGN  20463--ASSIGN
PTR$
     17729**DCL     20351<<ASSIGN  20352>>ASSIGN  20356>>ASSIGN  20365>>ASSIGN  20393>>ASSIGN  20419<<ASSIGN
     20421>>DOWHILE 20436>>IF      20441>>ASSIGN  20659>>ASSIGN  20737>>DOWHILE 20738>>ASSIGN  20741>>ASSIGN
     20767>>ASSIGN  20793>>ASSIGN  20819>>ASSIGN  20858>>ASSIGN  20868>>ASSIGN  20896>>IF      20899>>ASSIGN
P_PCB
     13244**DCL     20020<>CALL    20347<>CALL
P_PCB.ERROR
     13348**DCL     20022<>CALL    20981<>CALL
P_PCB.NCHARS
     13391**DCL     20346<<ASSIGN
P_PCB.OUT$
     13257**DCL     20026>>ASSIGN  20348>>ASSIGN
P_PCB.ROOT$
     13249**DCL     20019<<ASSIGN  20340<<ASSIGN
REMEM_VAR
     13215**DCL     13215--REDEF   20341<<REMEMBR
REM_FCMD
     13215**DCL     13216--REDEF
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:166  
SKIP
     20730**LABEL   20704--CALLALT
SNAME
     17732**DCL     20117<<ASSIGN  20144<<ASSIGN  20171<<ASSIGN  20172>>IF      20198<<ASSIGN  20224>>IF
     20227>>CALLBLT 20229>>CALLBLT 20231>>ASSIGN  20307>>ASSIGN  20591>>ASSIGN  20638>>ASSIGN
SREC$
     17733**DCL     18667--IMP-PTR 20057<<ASSIGN  20264>>ASSIGN
SUBS
     17735**DCL     20027<<ASSIGN  20149>>DOINDEX
TEMP
     17738**DCL     20427<<ASSIGN  20429>>ASSIGN
TEMP$
     17739**DCL     20420<<ASSIGN  20429>>ASSIGN  20430<<ASSIGN  20430>>ASSIGN
TERMINAL_CMD
     17766**DCL     20019--ASSIGN
TERM_KEY
     18090**DCL     20085>>ASSIGN  20299>>ASSIGN  20953>>ASSIGN
TERM_KEY.TXT.ACCT
     18093**DCL     20084<<ASSIGN  20306>>ASSIGN  20581>>ASSIGN  20590>>ASSIGN  20596>>ASSIGN  20623>>ASSIGN
     20637>>ASSIGN  20643>>ASSIGN  20723>>ASSIGN  20959>>ASSIGN
TERM_LOOP
     20336**LABEL   20341--REMEMBR 20439--GOTO    20460--GOTO    20487--GOTO    20564--GOTO    20661--CALLALT
     20702--GOTO    20982--GOTO    21006--GOTO
TERM_OPT_ERR
     20970**LABEL   20347--CALLALT
TERM_OPT_LIST
     17767**DCL     20340--ASSIGN
TERM_PRO_ERR
     20990**LABEL   20466--CALLALT
TERM_T
     17740**DCL     20147<<ASSIGN  20210<<ASSIGN  20213<<ASSIGN  20216<<ASSIGN  20309>>ASSIGN  20310>>IF
     20331<<ASSIGN  20517>>IF      20517>>IF      20517>>IF      20517>>IF      20548>>ASSIGN  20587<>CALL
     20629<>CALL    20709<>CALL    20713<>CALL
TERM_TYPES
     18634**DCL     20329>>CALLBLT
TERM_TYPE_A
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:167  
     18633**DCL     18634--REDEF
TREC$
     17741**DCL     18926--IMP-PTR 20055<<ASSIGN  20117>>ASSIGN  20172>>IF      20178>>CALLBLT 20180>>ASSIGN
     20198>>ASSIGN  20304>>ASSIGN  20305>>ASSIGN  20306>>ASSIGN  20307>>ASSIGN  20308>>ASSIGN  20309>>ASSIGN
     20311>>ASSIGN  20313>>ASSIGN  20314>>CALL    20315>>CALL    20316>>ASSIGN  20317>>ASSIGN  20318>>ASSIGN
     20319>>ASSIGN  20320>>ASSIGN  20324>>ASSIGN  20325>>ASSIGN  20328>>ASSIGN  20328>>ASSIGN  20329>>CALLBLT
     20331>>ASSIGN  20361>>ASSIGN  20362>>CALL    20389>>ASSIGN  20390>>CALL    20420>>ASSIGN  20437>>ASSIGN
     20438>>ASSIGN  20566>>ASSIGN  20567>>ASSIGN  20580>>ASSIGN  20588>>ASSIGN  20588>>ASSIGN  20622>>ASSIGN
     20635>>ASSIGN  20635>>ASSIGN  20636>>ASSIGN  20666>>IF      20688>>DOINDEX 20689>>ASSIGN  20704<>CALL
     20852>>ASSIGN  20854>>ASSIGN  20864>>ASSIGN  20891>>ASSIGN  20897>>ASSIGN  20901>>ASSIGN  20903>>ASSIGN
     20919>>IF      20951>>ASSIGN  20951>>ASSIGN  20952>>ASSIGN  20954<>CALL
TWSN#
     17744**DCL     20266<<CALLBLT
TWSNC
     17742**DCL     20264<<ASSIGN  20266>>CALLBLT 20268>>CALLBLT 20316>>ASSIGN  20587<>CALL    20629<>CALL
     20698>>CALLBLT 20709<>CALL    20713<>CALL    20719>>CALLBLT 20966>>CALLBLT
TWSNR$
     17743**DCL     19809--IMP-PTR 20056<<ASSIGN  20272<>CALL    20571>>ASSIGN  20587<>CALL    20596>>ASSIGN
     20597>>ASSIGN  20613>>ASSIGN  20629<>CALL    20643>>ASSIGN  20644>>ASSIGN  20704<>CALL    20709<>CALL
     20713<>CALL    20723>>ASSIGN  20968<>CALL
TWSN_ARS
     17745**DCL     20300<<ASSIGN  20598<<ASSIGN  20598>>ASSIGN  20645<<ASSIGN  20645>>ASSIGN  20968<>CALL
TWSN_INDEX
     17746**DCL     20571<<ASSIGN  20587<>CALL    20596>>ASSIGN  20597>>ASSIGN  20613<<ASSIGN  20629<>CALL
     20643>>ASSIGN  20644>>ASSIGN  20704<>CALL    20709<>CALL    20713<>CALL    20723>>ASSIGN
TYPE
     17764**DCL     20664<<ASSIGN  20694>>IF      20698>>CALLBLT 20714>>IF      20719>>CALLBLT
USERS_KEY
     13086**DCL     20032<<ASSIGN  20085<<ASSIGN  20278>>ASSIGN  20299<<ASSIGN  20466<>CALL    20701<>CALL
     20953<<ASSIGN  20990>>ASSIGN
USERS_KEY.COUNT
     13086**DCL     20228<<ASSIGN  20267<<ASSIGN  20464<<ASSIGN  20593<<ASSIGN  20640<<ASSIGN  20697<<ASSIGN
     20720<<ASSIGN  20965<<ASSIGN
USERS_KEY.TEXT
     13086**DCL     13087--REDEF   13087--REDEF   13087--REDEF   13088--REDEF
USERS_KEY.TXTC
PL6.E3A0      #001=ASA$TERMINAL File=ASA$TERMINAL.:E05TSI                        TUE 07/29/97 08:46 Page:168  
     13087**DCL     20124>>CALLBLT 20126>>ASSIGN  20227<<CALLBLT 20240>>CALLBLT 20242>>ASSIGN  20268<<CALLBLT
     20465<<ASSIGN  20594<<ASSIGN  20641<<ASSIGN  20698<<CALLBLT 20719<<CALLBLT 20966<<CALLBLT
WRITE_TREC_ERR
     20970**LABEL   20595--CALLALT 20642--CALLALT 20722--CALLALT 20954--CALLALT 20968--CALLALT
X$PARSE
     20004**DCL-ENT 20020--CALL    20347--CALL

PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:169  
      957        1        /*T***********************************************************/
      958        2        /*T*                                                         */
      959        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      960        4        /*T*                                                         */
      961        5        /*T***********************************************************/
      962        6        %EJECT;
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:170  
      963        7        /*M* ASB$VALID_TDEVICE - validates a terminal device name. */
      964        8        /*P*  NAME:   ASB$VALID_TDEVICE
      965        9              PURPOSE: To validate a terminal device name.
      966       10              DESCRIPTION:
      967       11                  A terminal device name is of the form "ddnn" where
      968       12                  "dd" is the device type and "nn" are 2 decimal digits.
      969       13                  The character set for a device type consists of uppercase
      970       14                  letters (A-Z) and digits (0-9).
      971       15        */
      972       16
      973       17        ASB$VALID_TDEVICE: PROC( OUT_SYM ) ALTRET;
      974       18
      975       19        /********************************************************************/
      976       20        /*    Include files       include files       include files         */
      977       21        /********************************************************************/
      978       22
      979       23        %INCLUDE           AS_ENTRIES_M   ;
      980     1073        %INCLUDE           AS_SUPER_C     ;
      981     1508        %INCLUDE           AS_PERR_C      ;
      982     2110        %INCLUDE           AS_SUBS_C      ;
      983     3524        %INCLUDE           AS_MAC_C       ;
      984     3604        %INCLUDE           KL_SUPER_C     ;
      985     6506        %INCLUDE           XU_MACRO_C     ;
      986     9612        %INCLUDE           XU_FORMAT_C    ;
      987     9774        %INCLUDE           AS_SUPER_R     ;
      988    12790
      989    12791        /********************************************************************/
      990    12792        /*    Parameter           parameter           parameter             */
      991    12793        /********************************************************************/
      992    12794
      993    12795        %PARSE$SYM( NAME=OUT_SYM, STCLASS=" " );
      994    12833
      995    12834        /********************************************************************/
      996    12835        /*    Auto data           auto data           auto data             */
      997    12836        /********************************************************************/
      998    12837
      999    12838    1   DCL I SBIN;
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:171  
     1000    12839    1   DCL J SBIN;
     1001    12840    1   DCL DDNN CHAR(4);
     1002    12841    1   DCL DDNN_A(0:3) REDEF DDNN CHAR(1);
     1003    12842
     1004    12843        /********************************************************************/
     1005    12844        /*    Entry dcls          entry dcls          entry dcls            */
     1006    12845        /********************************************************************/
     1007    12846
     1008    12847        %ASH$ERROR ;
     1009    12850
     1010    12851        %EJECT;
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:172  
     1011    12852    2   IF OUT_SYM.COUNT ~= 4 THEN DO;
     1012    12853        /*E*  ERROR:    ASA-E$BAD_M_DEV_CON-C
     1013    12854              MESSAGE0: A terminal device name must be 4 characters.
     1014    12855              MESSAGE1: A terminal device name must have a 2 character device type
     1015    12856                        and 2 decimal digits.
     1016    12857        */
     1017    12858           %SCREAM( ERR#=E$BAD_M_DEV_CON, LEVEL=ERROR, MID='A') ;
     1018    12873    2      ALTRETURN;
     1019    12874    2      END ; /* Then do */
     1020    12875    1   DDNN = OUT_SYM.TEXT ;
     1021    12876    2   DO I = 0 TO 1 ;
     1022    12877    2      CALL INDEX( J, DDNN_A(I), AS_VALID_DEVICE_TYPE_CHARS ) ALTRET(
             12877               BAD_DEVICE_TYPE_CHAR ) ;
     1023    12878    3      DO WHILE( '0'B );
     1024    12879    3   BAD_DEVICE_TYPE_CHAR:
     1025    12880        /*E*  ERROR:    ASA-E$INVALID_DEV_TYPE_CHAR-C
     1026    12881              MESSAGE0: "%U1" is an invalid character for a device type.
     1027    12882              MESSAGE1: The character set for a device type consists of uppercase
     1028    12883                        letters (A-Z) and digits (0-9).
     1029    12884        */
     1030    12885    3         AS_FIELD1.COUNT = 1 ;
     1031    12886    3         AS_FIELD1.TEXT  = DDNN_A(I) ;
     1032    12887              %SCREAM( ERR#=E$INVALID_DEV_TYPE_CHAR, LEVEL=ERROR, MID='A') ;
     1033    12902    3         ALTRETURN;
     1034    12903    3         END ;
     1035    12904    2      END ; /* Do i */
     1036    12905    2   DO I = 2 TO 3 ;
     1037    12906    2      CALL INDEX( J, DDNN_A(I), SUBSTR(AS_VALID_DEVICE_TYPE_CHARS,0,10) )  ALTRET(
             12906               NOT_DECIMAL ) ;
     1038    12907    3      DO WHILE( '0'B );
     1039    12908    3   NOT_DECIMAL:
     1040    12909        /*E*  ERROR:    ASA-E$MUST_BE_DECIMAL-C
     1041    12910              MESSAGE0: Two decimal digits must follow the device type (e.g., %U101).
     1042    12911        */
     1043    12912    3         AS_FIELD1.COUNT = 2 ;
     1044    12913    3         AS_FIELD1.TEXT = OUT_SYM.TEXT ;
     1045    12914              %SCREAM( ERR#=E$MUST_BE_DECIMAL, LEVEL=ERROR,MID='A');
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:173  
     1046    12929    3         ALTRETURN;
     1047    12930    3         END;
     1048    12931    2      END ; /* Do i */
     1049    12932
     1050    12933    1   END ASB$VALID_TDEVICE;

PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:174  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$VALID_TDEVICE.

   Procedure ASB$VALID_TDEVICE requires 69 words for executable code.
   Procedure ASB$VALID_TDEVICE requires 8 words of local(AUTO) storage.

    No errors detected in file ASA$TERMINAL.:E05TSI    .

PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:175  

 Object Unit name= ASB$VALID_TDEVICE                          File name= ASA$TERMINAL.:E05TOU
 UTS= JUL 29 '97 08:49:59.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      3      3  ASB$VALID_TDEVICE
    2   Proc  even  none    69    105  ASB$VALID_TDEVICE
    3  RoData even  none     3      3  ASB$VALID_TDEVICE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  ASB$VALID_TDEVICE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:176  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_VALID_DEVICE_TYPE_CHARS       r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  ERR_CODE                              AS_FIELD1
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:177  


      957        1        /*T***********************************************************/
      958        2        /*T*                                                         */
      959        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      960        4        /*T*                                                         */
      961        5        /*T***********************************************************/
      962        6        %EJECT;
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:178  
      963        7        /*M* ASB$VALID_TDEVICE - validates a terminal device name. */
      964        8        /*P*  NAME:   ASB$VALID_TDEVICE
      965        9              PURPOSE: To validate a terminal device name.
      966       10              DESCRIPTION:
      967       11                  A terminal device name is of the form "ddnn" where
      968       12                  "dd" is the device type and "nn" are 2 decimal digits.
      969       13                  The character set for a device type consists of uppercase
      970       14                  letters (A-Z) and digits (0-9).
      971       15        */
      972       16
      973       17        ASB$VALID_TDEVICE: PROC( OUT_SYM ) ALTRET;

     17  2 000000   000000 700200 xent  ASB$VALID_T* TSX0  ! X66_AUTO_1
         2 000001   000010 000001                    ZERO    8,1

      974       18
      975       19        /********************************************************************/
      976       20        /*    Include files       include files       include files         */
      977       21        /********************************************************************/
      978       22
      979       23        %INCLUDE           AS_ENTRIES_M   ;
      980     1073        %INCLUDE           AS_SUPER_C     ;
      981     1508        %INCLUDE           AS_PERR_C      ;
      982     2110        %INCLUDE           AS_SUBS_C      ;
      983     3524        %INCLUDE           AS_MAC_C       ;
      984     3604        %INCLUDE           KL_SUPER_C     ;
      985     6506        %INCLUDE           XU_MACRO_C     ;
      986     9612        %INCLUDE           XU_FORMAT_C    ;
      987     9774        %INCLUDE           AS_SUPER_R     ;
      988    12790
      989    12791        /********************************************************************/
      990    12792        /*    Parameter           parameter           parameter             */
      991    12793        /********************************************************************/
      992    12794
      993    12795        %PARSE$SYM( NAME=OUT_SYM, STCLASS=" " );
      994    12833
      995    12834        /********************************************************************/
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:179  
      996    12835        /*    Auto data           auto data           auto data             */
      997    12836        /********************************************************************/
      998    12837
      999    12838    1   DCL I SBIN;
     1000    12839    1   DCL J SBIN;
     1001    12840    1   DCL DDNN CHAR(4);
     1002    12841    1   DCL DDNN_A(0:3) REDEF DDNN CHAR(1);
     1003    12842
     1004    12843        /********************************************************************/
     1005    12844        /*    Entry dcls          entry dcls          entry dcls            */
     1006    12845        /********************************************************************/
     1007    12846
     1008    12847        %ASH$ERROR ;
     1009    12850
     1010    12851        %EJECT;
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:180  
     1011    12852    2   IF OUT_SYM.COUNT ~= 4 THEN DO;

  12852  2 000002   200003 470500                    LDP0    @OUT_SYM,,AUTO
         2 000003   000004 236100                    LDQ     4,,PR0
         2 000004   777000 376003                    ANQ     -512,DU
         2 000005   004000 116003                    CMPQ    2048,DU
         2 000006   000014 600000 2                  TZE     s:12875

     1012    12853        /*E*  ERROR:    ASA-E$BAD_M_DEV_CON-C
     1013    12854              MESSAGE0: A terminal device name must be 4 characters.
     1014    12855              MESSAGE1: A terminal device name must have a 2 character device type
     1015    12856                        and 2 decimal digits.
     1016    12857        */
     1017    12858           %SCREAM( ERR#=E$BAD_M_DEV_CON, LEVEL=ERROR, MID='A') ;

  12870  2 000007   000000 630400 3                  EPPR0   0
         2 000010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000011   000000 701000 xent               TSX1    ASH$ERROR
         2 000012   000000 011000                    NOP     0

     1018    12873    2      ALTRETURN;

  12873  2 000013   000000 702200 xent               TSX2  ! X66_AALT

     1019    12874    2      END ; /* Then do */
     1020    12875    1   DDNN = OUT_SYM.TEXT ;

  12875  2 000014   000004 236100                    LDQ     4,,PR0
         2 000015   000033 772000                    QRL     27
         2 000016   000000 620006                    EAX0    0,QL
         2 000017   040100 100540                    MLR     fill='040'O
         2 000020   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         2 000021   200006 000004                    ADSC9   DDNN,,AUTO               cn=0,n=4

     1021    12876    2   DO I = 0 TO 1 ;

  12876  2 000022   200004 450100                    STZ     I,,AUTO
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:181  

     1022    12877    2      CALL INDEX( J, DDNN_A(I), AS_VALID_DEVICE_TYPE_CHARS ) ALTRET(
             12877               BAD_DEVICE_TYPE_CHAR ) ;

  12877  2 000023   200004 235100                    LDA     I,,AUTO
         2 000024   000105 124400                    SCM     mask='000'O
         2 000025   000000 000044 xsym               ADSC9   AS_VALID_DEVICE_TYPE_CHARS cn=0,n=36
         2 000026   200006 000001                    ADSC9   DDNN,A,AUTO              cn=0,n=1
         2 000027   200005 000100                    ARG     J,,AUTO
         2 000030   000032 606400 2                  TTN     BAD_DEVICE_TYPE_CHAR

     1023    12878    3      DO WHILE( '0'B );

  12878  2 000031   000045 710000 2                  TRA     s:12904

     1024    12879    3   BAD_DEVICE_TYPE_CHAR:
     1025    12880        /*E*  ERROR:    ASA-E$INVALID_DEV_TYPE_CHAR-C
     1026    12881              MESSAGE0: "%U1" is an invalid character for a device type.
     1027    12882              MESSAGE1: The character set for a device type consists of uppercase
     1028    12883                        letters (A-Z) and digits (0-9).
     1029    12884        */
     1030    12885    3         AS_FIELD1.COUNT = 1 ;

  12885  2 000032   001000 236003       BAD_DEVICE_* LDQ     512,DU
         2 000033   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1031    12886    3         AS_FIELD1.TEXT  = DDNN_A(I) ;

  12886  2 000034   200004 235100                    LDA     I,,AUTO
         2 000035   040000 100505                    MLR     fill='040'O
         2 000036   200006 000001                    ADSC9   DDNN,A,AUTO              cn=0,n=1
         2 000037   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1032    12887              %SCREAM( ERR#=E$INVALID_DEV_TYPE_CHAR, LEVEL=ERROR, MID='A') ;

  12899  2 000040   000001 630400 3                  EPPR0   1
         2 000041   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:182  
         2 000042   000000 701000 xent               TSX1    ASH$ERROR
         2 000043   000000 011000                    NOP     0

     1033    12902    3         ALTRETURN;

  12902  2 000044   000000 702200 xent               TSX2  ! X66_AALT

     1034    12903    3         END ;

     1035    12904    2      END ; /* Do i */

  12904  2 000045   200004 054100                    AOS     I,,AUTO
         2 000046   200004 235100                    LDA     I,,AUTO
         2 000047   000001 115007                    CMPA    1,DL
         2 000050   000023 604400 2                  TMOZ    s:12877

     1036    12905    2   DO I = 2 TO 3 ;

  12905  2 000051   000002 236007                    LDQ     2,DL
         2 000052   200004 756100                    STQ     I,,AUTO

     1037    12906    2      CALL INDEX( J, DDNN_A(I), SUBSTR(AS_VALID_DEVICE_TYPE_CHARS,0,10) )  ALTRET(
             12906               NOT_DECIMAL ) ;

  12906  2 000053   200004 235100                    LDA     I,,AUTO
         2 000054   000105 124400                    SCM     mask='000'O
         2 000055   000000 000012 xsym               ADSC9   AS_VALID_DEVICE_TYPE_CHARS cn=0,n=10
         2 000056   200006 000001                    ADSC9   DDNN,A,AUTO              cn=0,n=1
         2 000057   200005 000100                    ARG     J,,AUTO
         2 000060   000062 606400 2                  TTN     NOT_DECIMAL

     1038    12907    3      DO WHILE( '0'B );

  12907  2 000061   000100 710000 2                  TRA     s:12931

     1039    12908    3   NOT_DECIMAL:
     1040    12909        /*E*  ERROR:    ASA-E$MUST_BE_DECIMAL-C
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:183  
     1041    12910              MESSAGE0: Two decimal digits must follow the device type (e.g., %U101).
     1042    12911        */
     1043    12912    3         AS_FIELD1.COUNT = 2 ;

  12912  2 000062   002000 236003       NOT_DECIMAL  LDQ     1024,DU
         2 000063   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

     1044    12913    3         AS_FIELD1.TEXT = OUT_SYM.TEXT ;

  12913  2 000064   200003 470500                    LDP0    @OUT_SYM,,AUTO
         2 000065   000004 236100                    LDQ     4,,PR0
         2 000066   000033 772000                    QRL     27
         2 000067   000000 620006                    EAX0    0,QL
         2 000070   040000 100540                    MLR     fill='040'O
         2 000071   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         2 000072   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

     1045    12914              %SCREAM( ERR#=E$MUST_BE_DECIMAL, LEVEL=ERROR,MID='A');

  12926  2 000073   000002 630400 3                  EPPR0   2
         2 000074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000075   000000 701000 xent               TSX1    ASH$ERROR
         2 000076   000000 011000                    NOP     0

     1046    12929    3         ALTRETURN;

  12929  2 000077   000000 702200 xent               TSX2  ! X66_AALT

     1047    12930    3         END;

     1048    12931    2      END ; /* Do i */

  12931  2 000100   200004 054100                    AOS     I,,AUTO
         2 000101   200004 235100                    LDA     I,,AUTO
         2 000102   000003 115007                    CMPA    3,DL
         2 000103   000053 604400 2                  TMOZ    s:12906

PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:184  
     1049    12932
     1050    12933    1   END ASB$VALID_TDEVICE;

  12933  2 000104   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:185  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$VALID_TDEVICE.
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:186  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @OUT_SYM                   6-0-0/c CHAR(4)     r     1 DDNN
     6-0-0/c CHAR        r     1 DDNN_A(0:3)                4-0-0/w SBIN        r     1 I
     5-0-0/w SBIN        r     1 J                         *0-0-0/w ASTR(153)   r     1 OUT_SYM

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/c CHAR        r     1 AS_VALID_DEVICE_TYPE_CHARS


   Procedure ASB$VALID_TDEVICE requires 69 words for executable code.
   Procedure ASB$VALID_TDEVICE requires 8 words of local(AUTO) storage.

    No errors detected in file ASA$TERMINAL.:E05TSI    .
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:187  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:188  
          MINI XREF LISTING

ASA_BRKS_LOC
      9938**DCL      9938--REDEF
ASH$ERROR
     12848**DCL-ENT 12870--CALL    12899--CALL    12926--CALL
AS_DEFAULT.BANNER_PERM
     10631**DCL     10632--REDEF
AS_DEFAULT.BUDGET.MACCT
     10536**DCL     10540--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10549**DCL     10552--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10532**DCL     10534--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10527**DCL     10529--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10647**DCL     10648--REDEF   10649--REDEF
AS_DEFAULT_DREC.PASSWORD
     11901**DCL     11905--REDEF
AS_DEFAULT_DREC.RENAME
     11924**DCL     11925--REDEF
AS_DFLT.BANNER_PERM
     10453**DCL     10454--REDEF
AS_DFLT.BUDGET.MACCT
     10358**DCL     10362--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10371**DCL     10374--REDEF
AS_DFLT.BUDGET.PACCUM
     10354**DCL     10356--REDEF
AS_DFLT.BUDGET.PMAXC
     10349**DCL     10351--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10469**DCL     10470--REDEF   10471--REDEF
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:189  
AS_FE_MODE
      9804**DCL      9805--REDEF
AS_FIELD1.COUNT
      9935**DCL     12885<<ASSIGN  12912<<ASSIGN
AS_FIELD1.TEXT
      9935**DCL     12886<<ASSIGN  12913<<ASSIGN
AS_MODE
      9801**DCL      9803--REDEF
AS_MOD_USER.ACCESS
     12666**DCL     12667--REDEF
AS_MOD_USER.BANNER
     12653**DCL     12654--REDEF
AS_MOD_USER.BANNER_PERM
     12655**DCL     12656--REDEF
AS_MOD_USER.BILL
     12661**DCL     12662--REDEF
AS_MOD_USER.CPROC
     12657**DCL     12658--REDEF
AS_MOD_USER.FEBILL
     12737**DCL     12738--REDEF
AS_MOD_USER.FECXTMEM
     12754**DCL     12755--REDEF
AS_MOD_USER.FEMINTS
     12739**DCL     12740--REDEF
AS_MOD_USER.FEMMEM
     12750**DCL     12751--REDEF
AS_MOD_USER.FEMTIME
     12748**DCL     12749--REDEF
AS_MOD_USER.FEPPRIV
     12745**DCL     12747--REDEF
AS_MOD_USER.FEPRIV
     12742**DCL     12744--REDEF
AS_MOD_USER.FORCE_BIT
     12651**DCL     12652--REDEF
AS_MOD_USER.KEY
     12733**DCL     12735--REDEF
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:190  
AS_MOD_USER.LASTCPROC
     12659**DCL     12660--REDEF
AS_MOD_USER.LIMITS.DO_
     12707**DCL     12708--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12723**DCL     12724--REDEF
AS_MOD_USER.LIMITS.LO
     12703**DCL     12704--REDEF
AS_MOD_USER.LIMITS.MEM
     12699**DCL     12700--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12727**DCL     12728--REDEF
AS_MOD_USER.LIMITS.PDIS
     12715**DCL     12716--REDEF
AS_MOD_USER.LIMITS.PO
     12711**DCL     12712--REDEF
AS_MOD_USER.LIMITS.TDIS
     12719**DCL     12720--REDEF
AS_MOD_USER.LIMITS.TIME
     12695**DCL     12696--REDEF
AS_MOD_USER.MAXENQ
     12676**DCL     12677--REDEF
AS_MOD_USER.PERM_BIT
     12649**DCL     12650--REDEF
AS_MOD_USER.PPRIV
     12671**DCL     12673--REDEF
AS_MOD_USER.PRIOB
     12678**DCL     12679--REDEF
AS_MOD_USER.PRIV
     12668**DCL     12670--REDEF
AS_MOD_USER.QUAN
     12674**DCL     12675--REDEF
AS_MOD_USER.SETUP
     12647**DCL     12648--REDEF
AS_PROJECT.BANNER_PERM
     10987**DCL     10988--REDEF
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:191  
AS_PROJECT.BUDGET.MACCT
     10892**DCL     10896--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10905**DCL     10908--REDEF
AS_PROJECT.BUDGET.PACCUM
     10888**DCL     10890--REDEF
AS_PROJECT.BUDGET.PMAXC
     10883**DCL     10885--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11003**DCL     11004--REDEF   11005--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11165**DCL     11166--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11070**DCL     11074--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11083**DCL     11086--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11066**DCL     11068--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11061**DCL     11063--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11181**DCL     11182--REDEF   11183--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12387**DCL     12391--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12410**DCL     12411--REDEF
AS_PROJECT_DREC.PASSWORD
     12225**DCL     12229--REDEF
AS_PROJECT_DREC.RENAME
     12248**DCL     12249--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10809**DCL     10810--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10714**DCL     10718--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10727**DCL     10730--REDEF
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:192  
AS_PROJ_ADMIN.BUDGET.PACCUM
     10710**DCL     10712--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10705**DCL     10707--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10825**DCL     10826--REDEF   10827--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12063**DCL     12067--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12086**DCL     12087--REDEF
AS_USERS.BANNER_PERM
     10275**DCL     10276--REDEF
AS_USERS.BUDGET.MACCT
     10180**DCL     10184--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10193**DCL     10196--REDEF
AS_USERS.BUDGET.PACCUM
     10176**DCL     10178--REDEF
AS_USERS.BUDGET.PMAXC
     10171**DCL     10173--REDEF
AS_USERS.SETUP_CHRA.TXT
     10291**DCL     10292--REDEF   10293--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11343**DCL     11344--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11248**DCL     11252--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11261**DCL     11264--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11244**DCL     11246--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11239**DCL     11241--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11359**DCL     11360--REDEF   11361--REDEF
AS_VALID_DEVICE_TYPE_CHARS
      9799**DCL     12877>>CALLBLT 12906>>CALLBLT
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:193  
BAD_DEVICE_TYPE_CHAR
     12885**LABEL   12877--CALLALT
DDNN
     12840**DCL     12841--REDEF   12875<<ASSIGN
DDNN_A
     12841**DCL     12877>>CALLBLT 12886>>ASSIGN  12906>>CALLBLT
ERR_CODE
      9933**DCL      9934--REDEF
I
     12838**DCL     12876<<DOINDEX 12877>>CALLBLT 12886>>ASSIGN  12905<<DOINDEX 12906>>CALLBLT
J
     12839**DCL     12877<<CALLBLT 12906<<CALLBLT
KL_DEFAULT.PASSWORD
     12549**DCL     12553--REDEF
KL_DEFAULT.RENAME
     12572**DCL     12573--REDEF
KL_DFLT.PASSWORD
     11739**DCL     11743--REDEF
KL_DFLT.RENAME
     11762**DCL     11763--REDEF
KL_DREC.PASSWORD
     11577**DCL     11581--REDEF
KL_DREC.RENAME
     11600**DCL     11601--REDEF
KL_DREC_CNT.PASSWORD
     11464**DCL     11468--REDEF
KL_DREC_CNT.RENAME
     11487**DCL     11488--REDEF
NOT_DECIMAL
     12912**LABEL   12906--CALLALT
OUT_SYM
     12802**DCL        17--PROC
OUT_SYM.COUNT
     12825**DCL     12828--IMP-SIZ 12852>>IF      12875>>ASSIGN  12913>>ASSIGN
OUT_SYM.TEXT
     12828**DCL     12875>>ASSIGN  12913>>ASSIGN
PL6.E3A0      #002=ASB$VALID_TDEVICE File=ASA$TERMINAL.:E05TSI                   TUE 07/29/97 08:49 Page:194  
PROJ_KEY.TEXT
      9811**DCL      9811--REDEF
PROJ_KEY.TXT.PROJECT
      9811**DCL      9811--REDEF
REMEM_VAR
      9937**DCL      9937--REDEF
REM_FCMD
      9937**DCL      9938--REDEF
USERS_KEY.TEXT
      9808**DCL      9809--REDEF    9809--REDEF    9809--REDEF    9810--REDEF
