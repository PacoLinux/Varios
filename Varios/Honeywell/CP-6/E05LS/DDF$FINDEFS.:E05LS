VERSION E05

PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:1    
        1        1        /*M* DDF$FINDEFS Common routines to find program defs given IC value */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %EJECT;
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:2    
        9        9        /*F* NAME: DDF$FIND_PEDEF
       10       10             PURPOSE: To find the primary ENTDEF that is closest to the
       11       11             specified IS address.
       12       12             DESCRIPTION: Searches the ENTDEF table for the primary ENTDEF
       13       13             that is closest to the specified IS address. */
       14       14        /*D* NAME: DDF$FIND_PEDEF
       15       15             CALL: CALL DDF$FIND_PEDEF( IC, ENTRY$ ) ALTRET( not found );
       16       16             INPUT: IC - specified IS address.
       17       17             OUTPUT: ENTRY$ - pointer to primary ENTDEF entry.
       18       18             SCRATCH: Local auto only.
       19       19             DESCRIPTION: Searches the ENTDEF table for the primary ENTDEF
       20       20             that is closest to the specified IS address. RETURNs if the
       21       21             search is successful. ALTRETURNs only when the specified IS
       22       22             address is less than any primary ENTDEF. */
       23       23                                                /**/
       24       24        DDF$FIND_PEDEF: PROC( IC, ENTRY$ ) ALTRET;
       25       25                                                /**/
       26       26    1   DCL IC SBIN;                            /* IS address input */
       27       27    1   DCL ENTRY$ PTR;                         /* Ptr to ENTDEF entry output */
       28       28    1   DCL ICT SBIN;                           /* Temp for IS address */
       29       29    1   DCL TEMP SBIN;                          /* Temp for offset from ICT */
       30       30    1   DCL DIFF SBIN;                          /* Current difference */
       31       31    1   DCL FARTHEST SBIN;                      /* Closest greater */
       32       32    1   DCL CLOSEST SBIN;                       /* Closest less */
       33       33    1   DCL RANGE SBIN;                         /* Range of primary entdef */
       34       34    1   DCL TEMP$ PTR;                /* Temp pointer to closest primary ENTDEF entry */
       35       35    1   DCL END$ PTR;                           /* Ptr to last entry in record */
       36       36    1   DCL TEDEF$ PTR;                         /* Temp ptr into ENTDEF record */
       37       37        %INCLUDE B$OBJECT_C;                    /* Run unit templates */
       38     3467        %B$EDEF (STCLASS="BASED(TEDEF$)");
       39     3537        %SUB_CST;
       40     3553        %SUB_LINKFLAGS;
       41     3562        %INCLUDE XUH_MACRO_C;
       42     3646        %INCLUDE DD_SD_M;
       43     4982        %S_D;
       44     6300    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
       45     6301                                                /**/
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:3    
       46     6302    1        ICT = IC;
       47     6303    1        IF S_D.OVERLAID
       48     6304    1        THEN CALL DDS$IC2NODE( ICT ) ALTRET( ALTRT );
       49     6305    1        IF S_D.EDEF$ = ADDR( NIL )
       50     6306    1        THEN GOTO ALTRT;
       51     6307        /* Initialization */
       52     6308    1        IF ( S_D.LASTPD.RANGE > 0 ) AND
       53     6309    1          ( S_D.LASTPD.NODE = S_D.NODE ) AND
       54     6310    1          ( ICT >= S_D.LASTPD.IC ) AND
       55     6311    1          ( ICT < S_D.LASTPD.RANGE + S_D.LASTPD.IC )
       56     6312    2        THEN DO;                           /* Already got it */
       57     6313    2             ENTRY$ = PINCRW( S_D.EDEF$, SIZEW( B$EDEF ) * S_D.LASTPD.PEDEF# );
       58     6314    2             RETURN;
       59     6315    2           END;
       60     6316    1        END$ = S_D.EDEF_END$;
       61     6317    1        FARTHEST = 1048576;                /* 2**20 */
       62     6318    1        CLOSEST = -1048576;
       63     6319    1        TEDEF$ = S_D.EDEF$;
       64     6320        /* Search the ENTDEF table */
       65     6321    2        DO WHILE ( TEDEF$ <= END$ );
       66     6322    2             IF B$EDEF.LFLAGS.SOURCE = %SOURCE_RLIB#
       67     6323    2             THEN GOTO NEXT_EDEF;
       68     6324    2             TEMP = B$EDEF.ISADDR - ICT;
       69     6325    2             IF B$EDEF.PRI                 /* Is it a primary ENTDEF ? */
       70     6326    2               AND B$EDEF.CST ~= %NOTPROC# /* and is not a noncallable procedure */
       71     6327    2             THEN IF ( TEMP > 0 )
       72     6328    3                  THEN DO;                 /* Check for farthest */
       73     6329    3                       IF ( TEMP < FARTHEST )
       74     6330    3                       THEN FARTHEST = TEMP;
       75     6331    3                     END;
       76     6332    3                  ELSE DO;                 /* Check for nearest */
       77     6333    3                       IF TEMP > CLOSEST
       78     6334    4                       THEN DO;
       79     6335    4                            CLOSEST = TEMP;
       80     6336    4                            TEMP$ = TEDEF$;
       81     6337    4                          END;
       82     6338    3                     END;
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:4    
       83     6339    2   NEXT_EDEF: TEDEF$ = PINCRW( TEDEF$, SIZEW( B$EDEF ) );
       84     6340    2           END;
       85     6341        /* Make sure we found it */
       86     6342    1        RANGE = FARTHEST - CLOSEST;
       87     6343    1        IF ( CLOSEST = -1048576 )
       88     6344    2        THEN DO;                           /* Nope */
       89     6345    2   ALTRT:
       90     6346    2             ALTRETURN;
       91     6347    2           END;
       92     6348    1        S_D.LASTPD.NODE = S_D.NODE;
       93     6349    1        S_D.LASTPD.RANGE = RANGE;
       94     6350    1        S_D.LASTPD.IC = TEMP$ -> B$EDEF.ISADDR;
       95     6351    1        S_D.LASTPD.PEDEF# = POFFW( TEMP$, S_D.EDEF$ ) / SIZEW( B$EDEF );
       96     6352    1        ENTRY$ = TEMP$;                    /* Yup - got it */
       97     6353                                                /**/
       98     6354    1        RETURN;
       99     6355                                                /**/
      100     6356    1   END DDF$FIND_PEDEF;
      101     6357        %EOD;

PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:5    
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$FIND_PEDEF.

   Procedure DDF$FIND_PEDEF requires 112 words for executable code.
   Procedure DDF$FIND_PEDEF requires 16 words of local(AUTO) storage.

PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:6    

 Object Unit name= DDF$FIND_PEDEF                             File name= DDF$FINDEFS.:E05TOU
 UTS= JUL 29 '97 13:58:15.92 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   112    160  DDF$FIND_PEDEF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  DDF$FIND_PEDEF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDS$IC2NODE
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  B_VECTNIL
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:7    


        1        1        /*M* DDF$FINDEFS Common routines to find program defs given IC value */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %EJECT;
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:8    
        9        9        /*F* NAME: DDF$FIND_PEDEF
       10       10             PURPOSE: To find the primary ENTDEF that is closest to the
       11       11             specified IS address.
       12       12             DESCRIPTION: Searches the ENTDEF table for the primary ENTDEF
       13       13             that is closest to the specified IS address. */
       14       14        /*D* NAME: DDF$FIND_PEDEF
       15       15             CALL: CALL DDF$FIND_PEDEF( IC, ENTRY$ ) ALTRET( not found );
       16       16             INPUT: IC - specified IS address.
       17       17             OUTPUT: ENTRY$ - pointer to primary ENTDEF entry.
       18       18             SCRATCH: Local auto only.
       19       19             DESCRIPTION: Searches the ENTDEF table for the primary ENTDEF
       20       20             that is closest to the specified IS address. RETURNs if the
       21       21             search is successful. ALTRETURNs only when the specified IS
       22       22             address is less than any primary ENTDEF. */
       23       23                                                /**/
       24       24        DDF$FIND_PEDEF: PROC( IC, ENTRY$ ) ALTRET;

     24  0 000000   000000 700200 xent  DDF$FIND_PE* TSX0  ! X66_AUTO_2
         0 000001   000020 000002                    ZERO    16,2

       25       25                                                /**/
       26       26    1   DCL IC SBIN;                            /* IS address input */
       27       27    1   DCL ENTRY$ PTR;                         /* Ptr to ENTDEF entry output */
       28       28    1   DCL ICT SBIN;                           /* Temp for IS address */
       29       29    1   DCL TEMP SBIN;                          /* Temp for offset from ICT */
       30       30    1   DCL DIFF SBIN;                          /* Current difference */
       31       31    1   DCL FARTHEST SBIN;                      /* Closest greater */
       32       32    1   DCL CLOSEST SBIN;                       /* Closest less */
       33       33    1   DCL RANGE SBIN;                         /* Range of primary entdef */
       34       34    1   DCL TEMP$ PTR;                /* Temp pointer to closest primary ENTDEF entry */
       35       35    1   DCL END$ PTR;                           /* Ptr to last entry in record */
       36       36    1   DCL TEDEF$ PTR;                         /* Temp ptr into ENTDEF record */
       37       37        %INCLUDE B$OBJECT_C;                    /* Run unit templates */
       38     3467        %B$EDEF (STCLASS="BASED(TEDEF$)");
       39     3537        %SUB_CST;
       40     3553        %SUB_LINKFLAGS;
       41     3562        %INCLUDE XUH_MACRO_C;
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:9    
       42     3646        %INCLUDE DD_SD_M;
       43     4982        %S_D;
       44     6300    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
       45     6301                                                /**/
       46     6302    1        ICT = IC;

   6302  0 000002   200003 470500                    LDP0    @IC,,AUTO
         0 000003   000000 235100                    LDA     0,,PR0
         0 000004   200005 755100                    STA     ICT,,AUTO

       47     6303    1        IF S_D.OVERLAID

   6303  0 000005   000000 471400 xsym               LDP1    S_D$
         0 000006   104764 234100                    SZN     2548,,PR1
         0 000007   000016 605000 0                  TPL     s:6305

       48     6304    1        THEN CALL DDS$IC2NODE( ICT ) ALTRET( ALTRT );

   6304  0 000010   200005 633500                    EPPR3   ICT,,AUTO
         0 000011   200016 453500                    STP3    TEDEF$+1,,AUTO
         0 000012   200016 630500                    EPPR0   TEDEF$+1,,AUTO
         0 000013   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000014   000000 701000 xent               TSX1    DDS$IC2NODE
         0 000015   000133 702000 0                  TSX2    ALTRT

       49     6305    1        IF S_D.EDEF$ = ADDR( NIL )

   6305  0 000016   000000 470400 xsym               LDP0    S_D$
         0 000017   001042 236100                    LDQ     546,,PR0
         0 000020   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000021   000133 600000 0                  TZE     ALTRT

       50     6306    1        THEN GOTO ALTRT;
       51     6307        /* Initialization */
       52     6308    1        IF ( S_D.LASTPD.RANGE > 0 ) AND

   6308  0 000022   005257 235100                    LDA     2735,,PR0
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:10   
         0 000023   000047 604400 0                  TMOZ    s:6316
         0 000024   005256 236100                    LDQ     2734,,PR0
         0 000025   004706 116100                    CMPQ    2502,,PR0
         0 000026   000047 601000 0                  TNZ     s:6316
         0 000027   200005 236100                    LDQ     ICT,,AUTO
         0 000030   000047 604000 0                  TMI     s:6316
         0 000031   005260 116100                    CMPQ    2736,,PR0
         0 000032   000047 602000 0                  TNC     s:6316
         0 000033   005257 236100                    LDQ     2735,,PR0
         0 000034   005260 036100                    ADLQ    2736,,PR0
         0 000035   200005 116100                    CMPQ    ICT,,AUTO
         0 000036   000047 604400 0                  TMOZ    s:6316

       53     6309    1          ( S_D.LASTPD.NODE = S_D.NODE ) AND
       54     6310    1          ( ICT >= S_D.LASTPD.IC ) AND
       55     6311    1          ( ICT < S_D.LASTPD.RANGE + S_D.LASTPD.IC )
       56     6312    2        THEN DO;                           /* Already got it */

       57     6313    2             ENTRY$ = PINCRW( S_D.EDEF$, SIZEW( B$EDEF ) * S_D.LASTPD.PEDEF# );

   6313  0 000037   005261 720100                    LXL0    2737,,PR0
         0 000040   001042 471500                    LDP1    546,,PR0
         0 000041   000000 636010                    EAQ     0,X0
         0 000042   000021 772000                    QRL     17
         0 000043   100000 633506                    EPPR3   0,QL,PR1
         0 000044   200004 474500                    LDP4    @ENTRY$,,AUTO
         0 000045   400000 453500                    STP3    0,,PR4

       58     6314    2             RETURN;

   6314  0 000046   000000 702200 xent               TSX2  ! X66_ARET

       59     6315    2           END;
       60     6316    1        END$ = S_D.EDEF_END$;

   6316  0 000047   001044 236100                    LDQ     548,,PR0
         0 000050   200014 756100                    STQ     END$,,AUTO
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:11   

       61     6317    1        FARTHEST = 1048576;                /* 2**20 */

   6317  0 000051   000004 235003                    LDA     4,DU
         0 000052   200010 755100                    STA     FARTHEST,,AUTO

       62     6318    1        CLOSEST = -1048576;

   6318  0 000053   777774 235003                    LDA     -4,DU
         0 000054   200011 755100                    STA     CLOSEST,,AUTO

       63     6319    1        TEDEF$ = S_D.EDEF$;

   6319  0 000055   001042 236100                    LDQ     546,,PR0
         0 000056   200015 756100                    STQ     TEDEF$,,AUTO

       64     6320        /* Search the ENTDEF table */
       65     6321    2        DO WHILE ( TEDEF$ <= END$ );

   6321  0 000057   200014 116100                    CMPQ    END$,,AUTO
         0 000060   000062 600000 0                  TZE     s:6322
         0 000061   000125 603000 0                  TRC     s:6342

       66     6322    2             IF B$EDEF.LFLAGS.SOURCE = %SOURCE_RLIB#

   6322  0 000062   200015 470500                    LDP0    TEDEF$,,AUTO
         0 000063   000000 236100                    LDQ     0,,PR0
         0 000064   700000 376003                    ANQ     -32768,DU
         0 000065   400000 116003                    CMPQ    -131072,DU
         0 000066   000117 600000 0                  TZE     NEXT_EDEF

       67     6323    2             THEN GOTO NEXT_EDEF;
       68     6324    2             TEMP = B$EDEF.ISADDR - ICT;

   6324  0 000067   000000 236100                    LDQ     0,,PR0
         0 000070   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000071   200005 136100                    SBLQ    ICT,,AUTO
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:12   
         0 000072   200006 756100                    STQ     TEMP,,AUTO

       69     6325    2             IF B$EDEF.PRI                 /* Is it a primary ENTDEF ? */

   6325  0 000073   000001 236100                    LDQ     1,,PR0
         0 000074   400000 316007                    CANQ    -131072,DL
         0 000075   000117 600000 0                  TZE     NEXT_EDEF
         0 000076   000001 236100                    LDQ     1,,PR0
         0 000077   074000 376007                    ANQ     30720,DL
         0 000100   074000 116007                    CMPQ    30720,DL
         0 000101   000117 600000 0                  TZE     NEXT_EDEF

       70     6326    2               AND B$EDEF.CST ~= %NOTPROC# /* and is not a noncallable procedure */
       71     6327    2             THEN IF ( TEMP > 0 )

   6327  0 000102   200006 235100                    LDA     TEMP,,AUTO
         0 000103   000111 604400 0                  TMOZ    s:6333

       72     6328    3                  THEN DO;                 /* Check for farthest */

       73     6329    3                       IF ( TEMP < FARTHEST )

   6329  0 000104   200006 236100                    LDQ     TEMP,,AUTO
         0 000105   200010 116100                    CMPQ    FARTHEST,,AUTO
         0 000106   000117 605000 0                  TPL     NEXT_EDEF

       74     6330    3                       THEN FARTHEST = TEMP;

   6330  0 000107   200010 756100                    STQ     FARTHEST,,AUTO

       75     6331    3                     END;

   6331  0 000110   000117 710000 0                  TRA     NEXT_EDEF

       76     6332    3                  ELSE DO;                 /* Check for nearest */

       77     6333    3                       IF TEMP > CLOSEST
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:13   

   6333  0 000111   200006 236100                    LDQ     TEMP,,AUTO
         0 000112   200011 116100                    CMPQ    CLOSEST,,AUTO
         0 000113   000117 604400 0                  TMOZ    NEXT_EDEF

       78     6334    4                       THEN DO;

       79     6335    4                            CLOSEST = TEMP;

   6335  0 000114   200011 756100                    STQ     CLOSEST,,AUTO

       80     6336    4                            TEMP$ = TEDEF$;

   6336  0 000115   200015 236100                    LDQ     TEDEF$,,AUTO
         0 000116   200013 756100                    STQ     TEMP$,,AUTO

       81     6337    4                          END;

       82     6338    3                     END;

       83     6339    2   NEXT_EDEF: TEDEF$ = PINCRW( TEDEF$, SIZEW( B$EDEF ) );

   6339  0 000117   200015 236100       NEXT_EDEF    LDQ     TEDEF$,,AUTO
         0 000120   000002 036003                    ADLQ    2,DU
         0 000121   200015 756100                    STQ     TEDEF$,,AUTO

       84     6340    2           END;

   6340  0 000122   200014 116100                    CMPQ    END$,,AUTO
         0 000123   000062 602000 0                  TNC     s:6322
         0 000124   000062 600000 0                  TZE     s:6322

       85     6341        /* Make sure we found it */
       86     6342    1        RANGE = FARTHEST - CLOSEST;

   6342  0 000125   200010 236100                    LDQ     FARTHEST,,AUTO
         0 000126   200011 136100                    SBLQ    CLOSEST,,AUTO
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:14   
         0 000127   200012 756100                    STQ     RANGE,,AUTO

       87     6343    1        IF ( CLOSEST = -1048576 )

   6343  0 000130   200011 235100                    LDA     CLOSEST,,AUTO
         0 000131   777774 115003                    CMPA    -4,DU
         0 000132   000134 601000 0                  TNZ     s:6348

       88     6344    2        THEN DO;                           /* Nope */

       89     6345    2   ALTRT:
       90     6346    2             ALTRETURN;

   6346  0 000133   000000 702200 xent  ALTRT        TSX2  ! X66_AALT

       91     6347    2           END;
       92     6348    1        S_D.LASTPD.NODE = S_D.NODE;

   6348  0 000134   000000 470400 xsym               LDP0    S_D$
         0 000135   004706 235100                    LDA     2502,,PR0
         0 000136   005256 755100                    STA     2734,,PR0

       93     6349    1        S_D.LASTPD.RANGE = RANGE;

   6349  0 000137   005257 756100                    STQ     2735,,PR0

       94     6350    1        S_D.LASTPD.IC = TEMP$ -> B$EDEF.ISADDR;

   6350  0 000140   200013 471500                    LDP1    TEMP$,,AUTO
         0 000141   100000 236100                    LDQ     0,,PR1
         0 000142   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000143   005260 756100                    STQ     2736,,PR0

       95     6351    1        S_D.LASTPD.PEDEF# = POFFW( TEMP$, S_D.EDEF$ ) / SIZEW( B$EDEF );

   6351  0 000144   001042 236100                    LDQ     546,,PR0
         0 000145   000022 772000                    QRL     18
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:15   
         0 000146   200016 756100                    STQ     TEDEF$+1,,AUTO
         0 000147   200013 236100                    LDQ     TEMP$,,AUTO
         0 000150   000022 772000                    QRL     18
         0 000151   200016 136100                    SBLQ    TEDEF$+1,,AUTO
         0 000152   000002 506007                    DIV     2,DL
         0 000153   005261 756100                    STQ     2737,,PR0

       96     6352    1        ENTRY$ = TEMP$;                    /* Yup - got it */

   6352  0 000154   200013 236100                    LDQ     TEMP$,,AUTO
         0 000155   200004 473500                    LDP3    @ENTRY$,,AUTO
         0 000156   300000 756100                    STQ     0,,PR3

       97     6353                                                /**/
       98     6354    1        RETURN;

   6354  0 000157   000000 702200 xent               TSX2  ! X66_ARET
       99     6355                                                /**/
      100     6356    1   END DDF$FIND_PEDEF;
      101     6357        %EOD;

PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:16   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$FIND_PEDEF.

   Procedure DDF$FIND_PEDEF requires 112 words for executable code.
   Procedure DDF$FIND_PEDEF requires 16 words of local(AUTO) storage.
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:17   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:18   
          MINI XREF LISTING

ALTRT
      6346**LABEL    6304--CALLALT  6306--GOTO
B$EDEF
      3468**DCL      6313--ASSIGN   6339--ASSIGN   6351--ASSIGN
B$EDEF.CST
      3514**DCL      6325>>IF
B$EDEF.ISADDR
      3491**DCL      6324>>ASSIGN   6350>>ASSIGN
B$EDEF.LFLAGS.SOURCE
      3473**DCL      6322>>IF
B$EDEF.OU
      3485**DCL      3491--REDEF
B$EDEF.PRI
      3496**DCL      6325>>IF
CLOSEST
        32**DCL      6318<<ASSIGN   6333>>IF       6335<<ASSIGN   6342>>ASSIGN   6343>>IF
DDS$IC2NODE
      6300**DCL-ENT  6304--CALL
END$
        35**DCL      6316<<ASSIGN   6321>>DOWHILE
ENTRY$
        27**DCL        24--PROC     6313<<ASSIGN   6352<<ASSIGN
FARTHEST
        31**DCL      6317<<ASSIGN   6329>>IF       6330<<ASSIGN   6342>>ASSIGN
IC
        26**DCL        24--PROC     6302>>ASSIGN
ICT
        28**DCL      6302<<ASSIGN   6304<>CALL     6308>>IF       6308>>IF       6324>>ASSIGN
NEXT_EDEF
      6339**LABEL    6323--GOTO
RANGE
        33**DCL      6342<<ASSIGN   6349>>ASSIGN
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:19   
S_D.CURRENT_CHANNEL
      5934**DCL      5936--REDEF
S_D.DEBUGA
      5086**DCL      5088--REDEF
S_D.EDEF$
      5430**DCL      6305>>IF       6313>>ASSIGN   6319>>ASSIGN   6351>>ASSIGN
S_D.EDEF_END$
      5434**DCL      6316>>ASSIGN
S_D.EIS
      6044**DCL      6073--REDEF
S_D.HOST_MESSAGE_BUF_REMOTE
      5977**DCL      5978--REDEF    5992--REDEF
S_D.JDE
      5591**DCL      5592--REDEF
S_D.L$.VALUE
      5144**DCL      5150--REDEF    5158--REDEF    5161--REDEF    5164--REDEF    5167--REDEF
S_D.L$.VALUE.L
      5145**DCL      5146--REDEF    5147--REDEF
S_D.L6_MESSAGE_BUF
      5998**DCL      6000--REDEF
S_D.LASTPD.IC
      5852**DCL      6308>>IF       6308>>IF       6350<<ASSIGN
S_D.LASTPD.NODE
      5847**DCL      6308>>IF       6348<<ASSIGN
S_D.LASTPD.PEDEF#
      5854**DCL      6313>>ASSIGN   6351<<ASSIGN
S_D.LASTPD.RANGE
      5849**DCL      6308>>IF       6308>>IF       6349<<ASSIGN
S_D.NODE
      5543**DCL      6308>>IF       6348>>ASSIGN
S_D.OUTPUT
      5964**DCL      5966--REDEF
S_D.OVERLAID
      5648**DCL      6303>>IF
S_D.REMOTE_MSG.FNCC
      5983**DCL      5984--REDEF
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:20   
S_D.REMOTE_MSG.STXC
      5979**DCL      5980--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5987**DCL      5988--REDEF
S_D.SV
      5043**DCL      5064--REDEF
S_D$
      6295**DCL      4991--IMP-PTR  6303>>IF       6305>>IF       6308>>IF       6308>>IF       6308>>IF
      6308>>IF       6308>>IF       6308>>IF       6313>>ASSIGN   6313>>ASSIGN   6316>>ASSIGN   6319>>ASSIGN
      6348>>ASSIGN   6348>>ASSIGN   6349>>ASSIGN   6350>>ASSIGN   6351>>ASSIGN   6351>>ASSIGN
TEDEF$
        36**DCL      3468--IMP-PTR  6319<<ASSIGN   6321>>DOWHILE  6322>>IF       6324>>ASSIGN   6325>>IF
      6325>>IF       6336>>ASSIGN   6339<<ASSIGN   6339>>ASSIGN
TEMP
        29**DCL      6324<<ASSIGN   6327>>IF       6329>>IF       6330>>ASSIGN   6333>>IF       6335>>ASSIGN
TEMP$
        34**DCL      6336<<ASSIGN   6350>>ASSIGN   6351>>ASSIGN   6352>>ASSIGN
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:21   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDF$FIND_PEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:22   
              MINI UREF LISTING

DDF$FIND_PEDEF      24**PROC
DIFF      30**DCL

PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:23   
      102        1        /*T***********************************************************/
      103        2        /*T*                                                         */
      104        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      105        4        /*T*                                                         */
      106        5        /*T***********************************************************/
      107        6        /*F* NAME: DDF$FIND_SEDEF
      108        7             PURPOSE: To find a secondary ENTDEF at the specified location.
      109        8             DESCRIPTION: Searches the ENTDEF table for the specified location.
      110        9             Only non-primary, i.e., secondary entries are considered. RETURNs
      111       10             if the search is successful, else ALTRETURNs. */
      112       11        /*D* NAME: DDF$FIND_SEDEF
      113       12             CALL: CALL DDF$FIND_SEDEF( IC, ENTRY$ ) ALTRET( not found );
      114       13             INPUT: IC - specified address.
      115       14             OUTPUT: ENTRY$ - pointer to ENTDEF entry.
      116       15             SCRATCH: Local auto only.
      117       16             DESCRIPTION: Searches the ENTDEF table for the specified location.
      118       17             Only non-primary, i.e., secondary entries are considered. RETURNs
      119       18             if the search is successful, else ALTRETURNs. */
      120       19                                                /**/
      121       20        DDF$FIND_SEDEF: PROC( IC, ENTRY$ ) ALTRET;
      122       21                                                /**/
      123       22    1   DCL IC UBIN;                            /* IS address input */
      124       23    1   DCL ENTRY$ PTR;                         /* Ptr to ENTDEF entry output */
      125       24    1   DCL ICT UBIN;                           /* Temp for IC */
      126       25    1   DCL TNTRY$ PTR;                         /* Temp for ENTRY$ */
      127       26    1   DCL END$ PTR;                           /* Last entry in ENTDEF record */
      128       27        %INCLUDE B$OBJECT_C;                    /* Object language templates */
      129     3457        %B$EDEF (STCLASS="BASED(TNTRY$)");
      130     3527        %SUB_CST;
      131     3543        %INCLUDE XUH_MACRO_C;
      132     3627        %INCLUDE DD_SD_M;
      133     4963        %S_D;
      134     6281    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      135     6282                                                /**/
      136     6283        /*N* The only way to speed this up is to have the ENTDEF table ordered
      137     6284             by value (ISADDR). */
      138     6285    1        ICT = IC;
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:24   
      139     6286    1        IF S_D.OVERLAID
      140     6287    1        THEN CALL DDS$IC2NODE( ICT ) ALTRET( ARET );
      141     6288    1        IF S_D.EDEF$ = ADDR( NIL )
      142     6289    1        THEN GOTO ARET;
      143     6290    1        END$ = S_D.EDEF_END$;
      144     6291    1        TNTRY$ = S_D.EDEF$;
      145     6292                                                /* Search the ENTDEF table */
      146     6293    2        DO WHILE ( TNTRY$ <= END$ );
      147     6294    2             IF ( NOT B$EDEF.PRI )
      148     6295    2             THEN IF ( ICT = B$EDEF.ISADDR )
      149     6296    3                  THEN DO;
      150     6297    3                       ENTRY$ = TNTRY$;
      151     6298    3                       RETURN;
      152     6299    3                     END;
      153     6300    2             TNTRY$ = PINCRW( TNTRY$, SIZEW( B$EDEF ) );
      154     6301    2           END;
      155     6302                                                /**/
      156     6303    1   ARET: ALTRETURN;
      157     6304                                                /**/
      158     6305    1   END DDF$FIND_SEDEF;
      159     6306        %EOD;

PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:25   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$FIND_SEDEF.

   Procedure DDF$FIND_SEDEF requires 44 words for executable code.
   Procedure DDF$FIND_SEDEF requires 10 words of local(AUTO) storage.

PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:26   

 Object Unit name= DDF$FIND_SEDEF                             File name= DDF$FINDEFS.:E05TOU
 UTS= JUL 29 '97 13:58:26.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    44     54  DDF$FIND_SEDEF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  DDF$FIND_SEDEF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDS$IC2NODE
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  B_VECTNIL
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:27   


      102        1        /*T***********************************************************/
      103        2        /*T*                                                         */
      104        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      105        4        /*T*                                                         */
      106        5        /*T***********************************************************/
      107        6        /*F* NAME: DDF$FIND_SEDEF
      108        7             PURPOSE: To find a secondary ENTDEF at the specified location.
      109        8             DESCRIPTION: Searches the ENTDEF table for the specified location.
      110        9             Only non-primary, i.e., secondary entries are considered. RETURNs
      111       10             if the search is successful, else ALTRETURNs. */
      112       11        /*D* NAME: DDF$FIND_SEDEF
      113       12             CALL: CALL DDF$FIND_SEDEF( IC, ENTRY$ ) ALTRET( not found );
      114       13             INPUT: IC - specified address.
      115       14             OUTPUT: ENTRY$ - pointer to ENTDEF entry.
      116       15             SCRATCH: Local auto only.
      117       16             DESCRIPTION: Searches the ENTDEF table for the specified location.
      118       17             Only non-primary, i.e., secondary entries are considered. RETURNs
      119       18             if the search is successful, else ALTRETURNs. */
      120       19                                                /**/
      121       20        DDF$FIND_SEDEF: PROC( IC, ENTRY$ ) ALTRET;

     20  0 000000   000000 700200 xent  DDF$FIND_SE* TSX0  ! X66_AUTO_2
         0 000001   000012 000002                    ZERO    10,2

      122       21                                                /**/
      123       22    1   DCL IC UBIN;                            /* IS address input */
      124       23    1   DCL ENTRY$ PTR;                         /* Ptr to ENTDEF entry output */
      125       24    1   DCL ICT UBIN;                           /* Temp for IC */
      126       25    1   DCL TNTRY$ PTR;                         /* Temp for ENTRY$ */
      127       26    1   DCL END$ PTR;                           /* Last entry in ENTDEF record */
      128       27        %INCLUDE B$OBJECT_C;                    /* Object language templates */
      129     3457        %B$EDEF (STCLASS="BASED(TNTRY$)");
      130     3527        %SUB_CST;
      131     3543        %INCLUDE XUH_MACRO_C;
      132     3627        %INCLUDE DD_SD_M;
      133     4963        %S_D;
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:28   
      134     6281    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      135     6282                                                /**/
      136     6283        /*N* The only way to speed this up is to have the ENTDEF table ordered
      137     6284             by value (ISADDR). */
      138     6285    1        ICT = IC;

   6285  0 000002   200003 470500                    LDP0    @IC,,AUTO
         0 000003   000000 235100                    LDA     0,,PR0
         0 000004   200005 755100                    STA     ICT,,AUTO

      139     6286    1        IF S_D.OVERLAID

   6286  0 000005   000000 471400 xsym               LDP1    S_D$
         0 000006   104764 234100                    SZN     2548,,PR1
         0 000007   000016 605000 0                  TPL     s:6288

      140     6287    1        THEN CALL DDS$IC2NODE( ICT ) ALTRET( ARET );

   6287  0 000010   200005 633500                    EPPR3   ICT,,AUTO
         0 000011   200010 453500                    STP3    END$+1,,AUTO
         0 000012   200010 630500                    EPPR0   END$+1,,AUTO
         0 000013   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000014   000000 701000 xent               TSX1    DDS$IC2NODE
         0 000015   000053 702000 0                  TSX2    ARET

      141     6288    1        IF S_D.EDEF$ = ADDR( NIL )

   6288  0 000016   000000 470400 xsym               LDP0    S_D$
         0 000017   001042 236100                    LDQ     546,,PR0
         0 000020   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000021   000053 600000 0                  TZE     ARET

      142     6289    1        THEN GOTO ARET;
      143     6290    1        END$ = S_D.EDEF_END$;

   6290  0 000022   001044 236100                    LDQ     548,,PR0
         0 000023   200007 756100                    STQ     END$,,AUTO
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:29   

      144     6291    1        TNTRY$ = S_D.EDEF$;

   6291  0 000024   001042 236100                    LDQ     546,,PR0
         0 000025   200006 756100                    STQ     TNTRY$,,AUTO

      145     6292                                                /* Search the ENTDEF table */
      146     6293    2        DO WHILE ( TNTRY$ <= END$ );

   6293  0 000026   200007 116100                    CMPQ    END$,,AUTO
         0 000027   000031 600000 0                  TZE     s:6294
         0 000030   000053 603000 0                  TRC     ARET

      147     6294    2             IF ( NOT B$EDEF.PRI )

   6294  0 000031   200006 470500                    LDP0    TNTRY$,,AUTO
         0 000032   000001 236100                    LDQ     1,,PR0
         0 000033   400000 316007                    CANQ    -131072,DL
         0 000034   000045 601000 0                  TNZ     s:6300

      148     6295    2             THEN IF ( ICT = B$EDEF.ISADDR )

   6295  0 000035   000000 236100                    LDQ     0,,PR0
         0 000036   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000037   200005 116100                    CMPQ    ICT,,AUTO
         0 000040   000045 601000 0                  TNZ     s:6300

      149     6296    3                  THEN DO;

      150     6297    3                       ENTRY$ = TNTRY$;

   6297  0 000041   200006 236100                    LDQ     TNTRY$,,AUTO
         0 000042   200004 471500                    LDP1    @ENTRY$,,AUTO
         0 000043   100000 756100                    STQ     0,,PR1

      151     6298    3                       RETURN;

PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:30   
   6298  0 000044   000000 702200 xent               TSX2  ! X66_ARET

      152     6299    3                     END;
      153     6300    2             TNTRY$ = PINCRW( TNTRY$, SIZEW( B$EDEF ) );

   6300  0 000045   200006 236100                    LDQ     TNTRY$,,AUTO
         0 000046   000002 036003                    ADLQ    2,DU
         0 000047   200006 756100                    STQ     TNTRY$,,AUTO

      154     6301    2           END;

   6301  0 000050   200007 116100                    CMPQ    END$,,AUTO
         0 000051   000031 602000 0                  TNC     s:6294
         0 000052   000031 600000 0                  TZE     s:6294

      155     6302                                                /**/
      156     6303    1   ARET: ALTRETURN;

   6303  0 000053   000000 702200 xent  ARET         TSX2  ! X66_AALT
      157     6304                                                /**/
      158     6305    1   END DDF$FIND_SEDEF;
      159     6306        %EOD;

PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:31   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$FIND_SEDEF.

   Procedure DDF$FIND_SEDEF requires 44 words for executable code.
   Procedure DDF$FIND_SEDEF requires 10 words of local(AUTO) storage.
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:32   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:33   
          MINI XREF LISTING

ARET
      6303**LABEL    6287--CALLALT  6289--GOTO
B$EDEF
      3458**DCL      6300--ASSIGN
B$EDEF.ISADDR
      3481**DCL      6295>>IF
B$EDEF.OU
      3475**DCL      3481--REDEF
B$EDEF.PRI
      3486**DCL      6294>>IF
DDS$IC2NODE
      6281**DCL-ENT  6287--CALL
END$
        26**DCL      6290<<ASSIGN   6293>>DOWHILE
ENTRY$
        23**DCL        20--PROC     6297<<ASSIGN
IC
        22**DCL        20--PROC     6285>>ASSIGN
ICT
        24**DCL      6285<<ASSIGN   6287<>CALL     6295>>IF
S_D.CURRENT_CHANNEL
      5915**DCL      5917--REDEF
S_D.DEBUGA
      5067**DCL      5069--REDEF
S_D.EDEF$
      5411**DCL      6288>>IF       6291>>ASSIGN
S_D.EDEF_END$
      5415**DCL      6290>>ASSIGN
S_D.EIS
      6025**DCL      6054--REDEF
S_D.HOST_MESSAGE_BUF_REMOTE
      5958**DCL      5959--REDEF    5973--REDEF
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:34   
S_D.JDE
      5572**DCL      5573--REDEF
S_D.L$.VALUE
      5125**DCL      5131--REDEF    5139--REDEF    5142--REDEF    5145--REDEF    5148--REDEF
S_D.L$.VALUE.L
      5126**DCL      5127--REDEF    5128--REDEF
S_D.L6_MESSAGE_BUF
      5979**DCL      5981--REDEF
S_D.OUTPUT
      5945**DCL      5947--REDEF
S_D.OVERLAID
      5629**DCL      6286>>IF
S_D.REMOTE_MSG.FNCC
      5964**DCL      5965--REDEF
S_D.REMOTE_MSG.STXC
      5960**DCL      5961--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5968**DCL      5969--REDEF
S_D.SV
      5024**DCL      5045--REDEF
S_D$
      6276**DCL      4972--IMP-PTR  6286>>IF       6288>>IF       6290>>ASSIGN   6291>>ASSIGN
TNTRY$
        25**DCL      3458--IMP-PTR  6291<<ASSIGN   6293>>DOWHILE  6294>>IF       6295>>IF       6297>>ASSIGN
      6300<<ASSIGN   6300>>ASSIGN
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:35   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DDF$FIND_SEDEF File=DDF$FINDEFS.:E05TSI                       TUE 07/29/97 13:58 Page:36   
              MINI UREF LISTING

DDF$FIND_SEDEF      20**PROC

PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:37   
      160        1        /*T***********************************************************/
      161        2        /*T*                                                         */
      162        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      163        4        /*T*                                                         */
      164        5        /*T***********************************************************/
      165        6        /*F* NAME: DDF$FIND_SYMDEF
      166        7             PURPOSE: To find the SYMDEF that is closest to the
      167        8             specified SYMDEF value.
      168        9             DESCRIPTION: Searches the SYMDEF table for the SYMDEF
      169       10             that is closest to the specified SYMDEF value. */
      170       11        /*D* NAME: DDF$FIND_SYMDEF
      171       12             CALL: CALL DDF$FIND_SYMDEF( IC, ENTRY$, SKIPC ) ALTRET( not found );
      172       13             INPUT: IC - specified SYMDEF value.
      173       14                    SKIPC - whether to skip constants flag.
      174       15             OUTPUT: ENTRY$ - pointer to SYMDEF entry.
      175       16             SCRATCH: Local auto only.
      176       17             DESCRIPTION: Searches the SYMDEF table for the SYMDEF
      177       18             that is closest to the specified SYMDEF value, ignoring
      178       19             any constant entrys if SKIPC bit is set. RETURNs if the
      179       20             search is successful. ALTRETURNs only when the specified IS
      180       21             address is less than any SYMDEF. */
      181       22                                                /**/
      182       23        DDF$FIND_SYMDEF: PROC( IC, ENTRY$, SKIPC ) ALTRET;
      183       24                                                /**/
      184       25    1   DCL IC SBIN;                            /* SYMDEF value input */
      185       26    1   DCL ENTRY$ PTR;                         /* Ptr to SYMDEF entry output */
      186       27    1   DCL SKIPC BIT(1) ALIGNED;               /* Skip constants flag */
      187       28    1   DCL ICT SBIN;                           /* Temp for IS address */
      188       29    1   DCL TEMP SBIN;                     /* Temp for closest address difference */
      189       30    1   DCL CONSTNT BIT(1) ALIGNED;             /* Temp for B$SDEF.CONSTNT */
      190       31    1   DCL SKIPCT BIT(1) ALIGNED;              /* Temp for SKIPC */
      191       32    1   DCL ANY$ PTR;                           /* Pointer to closest */
      192       33    1   DCL DIFF_ANY SBIN;                      /* Current difference */
      193       34    1   DCL FARTHEST_ANY SBIN;                  /* Closest greater */
      194       35    1   DCL CLOSEST_ANY SBIN;                   /* Closest less */
      195       36    1   DCL RANGE_ANY SBIN;                     /* Range of symdef */
      196       37    1   DCL NCN$ PTR;                           /* Pointer to closest */
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:38   
      197       38    1   DCL DIFF_NCN SBIN;                      /* Current difference */
      198       39    1   DCL FARTHEST_NCN SBIN;                  /* Closest greater */
      199       40    1   DCL CLOSEST_NCN SBIN;                   /* Closest less */
      200       41    1   DCL RANGE_NCN SBIN;                     /* Range of symdef */
      201       42    1   DCL END$ PTR;                           /* Ptr to last entry in record */
      202       43    1   DCL TSDEF$ PTR;                         /* Temp ptr into SYMDEF record */
      203       44        %INCLUDE B$OBJECT_C;                    /* Run unit templates */
      204     3474        %B$SDEF (STCLASS="BASED(TSDEF$)");
      205     3528        %SUB_CST;
      206     3544        %SUB_LINKFLAGS;
      207     3553        %INCLUDE XUH_MACRO_C;
      208     3637        %INCLUDE DD_SD_M;
      209     4973        %S_D;
      210     6291    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      211     6292                                                /**/
      212     6293        /* Initialization */
      213     6294    1        ICT = IC;
      214     6295    1        SKIPCT = SKIPC;
      215     6296    1        IF S_D.OVERLAID
      216     6297    1        THEN CALL DDS$IC2NODE( ICT ) ALTRET( ALTRT );
      217     6298    1        IF S_D.SDEF$ = ADDR( NIL )
      218     6299    1        THEN GOTO ALTRT;
      219     6300    1        IF NOT SKIPCT
      220     6301    2        THEN DO;
      221     6302    2             IF ( S_D.ANYSD.RANGE > 0 ) AND
      222     6303    2               ( S_D.ANYSD.NODE = S_D.NODE ) AND
      223     6304    2               ( ICT >= S_D.ANYSD.IC ) AND
      224     6305    2               ( ICT < S_D.ANYSD.RANGE + S_D.ANYSD.IC )
      225     6306    3             THEN DO;                      /* Already got it */
      226     6307    3                  ENTRY$ = PINCRW( S_D.SDEF$, SIZEW( B$SDEF ) * S_D.ANYSD.SDEF# );
      227     6308    3                  RETURN;
      228     6309    3                END;
      229     6310    2           END;
      230     6311    2        ELSE DO;
      231     6312    2             IF ( S_D.NCNSD.RANGE > 0 ) AND
      232     6313    2               ( S_D.NCNSD.NODE = S_D.NODE ) AND
      233     6314    2               ( ICT >= S_D.NCNSD.IC ) AND
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:39   
      234     6315    2               ( ICT < S_D.NCNSD.RANGE + S_D.NCNSD.IC )
      235     6316    3             THEN DO;                      /* Already got it */
      236     6317    3                  ENTRY$ = PINCRW( S_D.SDEF$, SIZEW( B$SDEF ) * S_D.NCNSD.SDEF# );
      237     6318    3                  RETURN;
      238     6319    3                END;
      239     6320    2           END;
      240     6321    1        END$ = S_D.SDEF_END$;
      241     6322    1        FARTHEST_ANY = 1048576;            /* 2**20 */
      242     6323    1        CLOSEST_ANY = -1048576;
      243     6324    1        FARTHEST_NCN = 1048576;            /* 2**20 */
      244     6325    1        CLOSEST_NCN = -1048576;
      245     6326    1        TSDEF$ = S_D.SDEF$;
      246     6327        /* Search the SYMDEF table */
      247     6328    2        DO WHILE ( TSDEF$ <= END$ );
      248     6329    2             IF B$SDEF.AD.LFLAGS.SOURCE = %SOURCE_RLIB#
      249     6330    2             THEN GOTO NEXT_SDEF;
      250     6331    2             CONSTNT = B$SDEF.CONSTNT;
      251     6332    2             IF CONSTNT
      252     6333    2             THEN TEMP = B$SDEF.VALUE - ICT; /* Constant */
      253     6334    2             ELSE TEMP = B$SDEF.AD.ISADDR - ICT; /* Address */
      254     6335        /* Do for any SYMDEF (address or constant) */
      255     6336    2             IF ( TEMP > 0 )
      256     6337    3             THEN DO;                      /* Check for farthest */
      257     6338    3                  IF ( TEMP < FARTHEST_ANY )
      258     6339    3                  THEN FARTHEST_ANY = TEMP;
      259     6340    3                END;
      260     6341    3             ELSE DO;                      /* Check for nearest */
      261     6342    3                  IF TEMP > CLOSEST_ANY
      262     6343    4                  THEN DO;
      263     6344    4                       CLOSEST_ANY = TEMP;
      264     6345    4                       ANY$ = TSDEF$;
      265     6346    4                     END;
      266     6347    3                END;
      267     6348        /* Do for non-constant (address type) SYMDEFs only */
      268     6349    2             IF NOT CONSTNT
      269     6350    3             THEN DO;
      270     6351    3                  IF ( TEMP > 0 )
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:40   
      271     6352    4                  THEN DO;                 /* Check for farthest */
      272     6353    4                       IF ( TEMP < FARTHEST_NCN )
      273     6354    4                       THEN FARTHEST_NCN = TEMP;
      274     6355    4                     END;
      275     6356    4                  ELSE DO;                 /* Check for nearest */
      276     6357    4                       IF TEMP > CLOSEST_NCN
      277     6358    5                       THEN DO;
      278     6359    5                            CLOSEST_NCN = TEMP;
      279     6360    5                            NCN$ = TSDEF$;
      280     6361    5                          END;
      281     6362    4                     END;
      282     6363    3                END;
      283     6364    2   NEXT_SDEF: TSDEF$ = PINCRW( TSDEF$, SIZEW( B$SDEF ) );
      284     6365    2           END;
      285     6366        /* Make sure we found it */
      286     6367    1        RANGE_NCN = FARTHEST_NCN - CLOSEST_NCN;
      287     6368    1        IF ( CLOSEST_NCN > -1048576 )
      288     6369    2        THEN DO;
      289     6370    2             S_D.NCNSD.NODE = S_D.NODE;
      290     6371    2             S_D.NCNSD.RANGE = RANGE_NCN;
      291     6372    2             S_D.NCNSD.IC = NCN$ -> B$SDEF.AD.ISADDR;
      292     6373    2             S_D.NCNSD.SDEF# = POFFW( NCN$, S_D.SDEF$ ) / SIZEW( B$SDEF );
      293     6374    2           END;
      294     6375    1        RANGE_ANY = FARTHEST_ANY - CLOSEST_ANY;
      295     6376    1        IF ( CLOSEST_ANY > -1048576 )
      296     6377    2        THEN DO;
      297     6378    2             S_D.ANYSD.NODE = S_D.NODE;
      298     6379    2             S_D.ANYSD.RANGE = RANGE_ANY;
      299     6380    2             IF ANY$ -> B$SDEF.CONSTNT
      300     6381    2             THEN S_D.ANYSD.IC = ANY$ -> B$SDEF.VALUE;
      301     6382    2             ELSE S_D.ANYSD.IC = ANY$ -> B$SDEF.AD.ISADDR;
      302     6383    2             S_D.ANYSD.SDEF# = POFFW( ANY$, S_D.SDEF$ ) / SIZEW( B$SDEF );
      303     6384    2           END;
      304     6385                                                /**/
      305     6386    1        IF ( NOT SKIPCT ) AND ( CLOSEST_ANY > -1048576 )
      306     6387    2        THEN DO;
      307     6388    2             ENTRY$ = ANY$;
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:41   
      308     6389    2             RETURN;
      309     6390    2           END;
      310     6391    1        ELSE IF ( SKIPCT ) AND ( CLOSEST_NCN > -1048576 )
      311     6392    2             THEN DO;
      312     6393    2                  ENTRY$ = NCN$;
      313     6394    2                  RETURN;
      314     6395    2                END;
      315     6396                                                /**/
      316     6397    1   ALTRT: ;
      317     6398    1        ALTRETURN;
      318     6399                                                /**/
      319     6400    1   END DDF$FIND_SYMDEF;

PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:42   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$FIND_SYMDEF.

   Procedure DDF$FIND_SYMDEF requires 200 words for executable code.
   Procedure DDF$FIND_SYMDEF requires 24 words of local(AUTO) storage.

    No errors detected in file DDF$FINDEFS.:E05TSI    .

PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:43   

 Object Unit name= DDF$FIND_SYMDEF                            File name= DDF$FINDEFS.:E05TOU
 UTS= JUL 29 '97 13:58:35.16 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   200    310  DDF$FIND_SYMDEF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        3  DDF$FIND_SYMDEF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDS$IC2NODE
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  B_VECTNIL
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:44   


      160        1        /*T***********************************************************/
      161        2        /*T*                                                         */
      162        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      163        4        /*T*                                                         */
      164        5        /*T***********************************************************/
      165        6        /*F* NAME: DDF$FIND_SYMDEF
      166        7             PURPOSE: To find the SYMDEF that is closest to the
      167        8             specified SYMDEF value.
      168        9             DESCRIPTION: Searches the SYMDEF table for the SYMDEF
      169       10             that is closest to the specified SYMDEF value. */
      170       11        /*D* NAME: DDF$FIND_SYMDEF
      171       12             CALL: CALL DDF$FIND_SYMDEF( IC, ENTRY$, SKIPC ) ALTRET( not found );
      172       13             INPUT: IC - specified SYMDEF value.
      173       14                    SKIPC - whether to skip constants flag.
      174       15             OUTPUT: ENTRY$ - pointer to SYMDEF entry.
      175       16             SCRATCH: Local auto only.
      176       17             DESCRIPTION: Searches the SYMDEF table for the SYMDEF
      177       18             that is closest to the specified SYMDEF value, ignoring
      178       19             any constant entrys if SKIPC bit is set. RETURNs if the
      179       20             search is successful. ALTRETURNs only when the specified IS
      180       21             address is less than any SYMDEF. */
      181       22                                                /**/
      182       23        DDF$FIND_SYMDEF: PROC( IC, ENTRY$, SKIPC ) ALTRET;

     23  0 000000   000000 700200 xent  DDF$FIND_SY* TSX0  ! X66_AUTO_3
         0 000001   000030 000003                    ZERO    24,3

      183       24                                                /**/
      184       25    1   DCL IC SBIN;                            /* SYMDEF value input */
      185       26    1   DCL ENTRY$ PTR;                         /* Ptr to SYMDEF entry output */
      186       27    1   DCL SKIPC BIT(1) ALIGNED;               /* Skip constants flag */
      187       28    1   DCL ICT SBIN;                           /* Temp for IS address */
      188       29    1   DCL TEMP SBIN;                     /* Temp for closest address difference */
      189       30    1   DCL CONSTNT BIT(1) ALIGNED;             /* Temp for B$SDEF.CONSTNT */
      190       31    1   DCL SKIPCT BIT(1) ALIGNED;              /* Temp for SKIPC */
      191       32    1   DCL ANY$ PTR;                           /* Pointer to closest */
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:45   
      192       33    1   DCL DIFF_ANY SBIN;                      /* Current difference */
      193       34    1   DCL FARTHEST_ANY SBIN;                  /* Closest greater */
      194       35    1   DCL CLOSEST_ANY SBIN;                   /* Closest less */
      195       36    1   DCL RANGE_ANY SBIN;                     /* Range of symdef */
      196       37    1   DCL NCN$ PTR;                           /* Pointer to closest */
      197       38    1   DCL DIFF_NCN SBIN;                      /* Current difference */
      198       39    1   DCL FARTHEST_NCN SBIN;                  /* Closest greater */
      199       40    1   DCL CLOSEST_NCN SBIN;                   /* Closest less */
      200       41    1   DCL RANGE_NCN SBIN;                     /* Range of symdef */
      201       42    1   DCL END$ PTR;                           /* Ptr to last entry in record */
      202       43    1   DCL TSDEF$ PTR;                         /* Temp ptr into SYMDEF record */
      203       44        %INCLUDE B$OBJECT_C;                    /* Run unit templates */
      204     3474        %B$SDEF (STCLASS="BASED(TSDEF$)");
      205     3528        %SUB_CST;
      206     3544        %SUB_LINKFLAGS;
      207     3553        %INCLUDE XUH_MACRO_C;
      208     3637        %INCLUDE DD_SD_M;
      209     4973        %S_D;
      210     6291    1   DCL DDS$IC2NODE ENTRY(2) ALTRET;
      211     6292                                                /**/
      212     6293        /* Initialization */
      213     6294    1        ICT = IC;

   6294  0 000002   200003 470500                    LDP0    @IC,,AUTO
         0 000003   000000 235100                    LDA     0,,PR0
         0 000004   200006 755100                    STA     ICT,,AUTO

      214     6295    1        SKIPCT = SKIPC;

   6295  0 000005   200005 471500                    LDP1    @SKIPC,,AUTO
         0 000006   100000 236100                    LDQ     0,,PR1
         0 000007   400000 376003                    ANQ     -131072,DU
         0 000010   200011 756100                    STQ     SKIPCT,,AUTO

      215     6296    1        IF S_D.OVERLAID

   6296  0 000011   000000 473400 xsym               LDP3    S_D$
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:46   
         0 000012   304764 234100                    SZN     2548,,PR3
         0 000013   000022 605000 0                  TPL     s:6298

      216     6297    1        THEN CALL DDS$IC2NODE( ICT ) ALTRET( ALTRT );

   6297  0 000014   200006 634500                    EPPR4   ICT,,AUTO
         0 000015   200026 454500                    STP4    TSDEF$+1,,AUTO
         0 000016   200026 630500                    EPPR0   TSDEF$+1,,AUTO
         0 000017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000020   000000 701000 xent               TSX1    DDS$IC2NODE
         0 000021   000307 702000 0                  TSX2    ALTRT

      217     6298    1        IF S_D.SDEF$ = ADDR( NIL )

   6298  0 000022   000000 470400 xsym               LDP0    S_D$
         0 000023   001043 236100                    LDQ     547,,PR0
         0 000024   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000025   000307 600000 0                  TZE     ALTRT

      218     6299    1        THEN GOTO ALTRT;
      219     6300    1        IF NOT SKIPCT

   6300  0 000026   200011 234100                    SZN     SKIPCT,,AUTO
         0 000027   000055 604000 0                  TMI     s:6312

      220     6301    2        THEN DO;

      221     6302    2             IF ( S_D.ANYSD.RANGE > 0 ) AND

   6302  0 000030   005263 235100                    LDA     2739,,PR0
         0 000031   000102 604400 0                  TMOZ    s:6321
         0 000032   005262 236100                    LDQ     2738,,PR0
         0 000033   004706 116100                    CMPQ    2502,,PR0
         0 000034   000102 601000 0                  TNZ     s:6321
         0 000035   200006 236100                    LDQ     ICT,,AUTO
         0 000036   000102 604000 0                  TMI     s:6321
         0 000037   005264 116100                    CMPQ    2740,,PR0
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:47   
         0 000040   000102 602000 0                  TNC     s:6321
         0 000041   005263 236100                    LDQ     2739,,PR0
         0 000042   005264 036100                    ADLQ    2740,,PR0
         0 000043   200006 116100                    CMPQ    ICT,,AUTO
         0 000044   000102 604400 0                  TMOZ    s:6321

      222     6303    2               ( S_D.ANYSD.NODE = S_D.NODE ) AND
      223     6304    2               ( ICT >= S_D.ANYSD.IC ) AND
      224     6305    2               ( ICT < S_D.ANYSD.RANGE + S_D.ANYSD.IC )
      225     6306    3             THEN DO;                      /* Already got it */

      226     6307    3                  ENTRY$ = PINCRW( S_D.SDEF$, SIZEW( B$SDEF ) * S_D.ANYSD.SDEF# );

   6307  0 000045   005265 720100                    LXL0    2741,,PR0
         0 000046   001043 471500                    LDP1    547,,PR0
         0 000047   000000 636010                    EAQ     0,X0
         0 000050   000021 772000                    QRL     17
         0 000051   100000 633506                    EPPR3   0,QL,PR1
         0 000052   200004 474500                    LDP4    @ENTRY$,,AUTO
         0 000053   400000 453500                    STP3    0,,PR4

      227     6308    3                  RETURN;

   6308  0 000054   000000 702200 xent               TSX2  ! X66_ARET

      228     6309    3                END;
      229     6310    2           END;
      230     6311    2        ELSE DO;

      231     6312    2             IF ( S_D.NCNSD.RANGE > 0 ) AND

   6312  0 000055   005267 235100                    LDA     2743,,PR0
         0 000056   000102 604400 0                  TMOZ    s:6321
         0 000057   005266 236100                    LDQ     2742,,PR0
         0 000060   004706 116100                    CMPQ    2502,,PR0
         0 000061   000102 601000 0                  TNZ     s:6321
         0 000062   200006 236100                    LDQ     ICT,,AUTO
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:48   
         0 000063   000102 604000 0                  TMI     s:6321
         0 000064   005270 116100                    CMPQ    2744,,PR0
         0 000065   000102 602000 0                  TNC     s:6321
         0 000066   005267 236100                    LDQ     2743,,PR0
         0 000067   005270 036100                    ADLQ    2744,,PR0
         0 000070   200006 116100                    CMPQ    ICT,,AUTO
         0 000071   000102 604400 0                  TMOZ    s:6321

      232     6313    2               ( S_D.NCNSD.NODE = S_D.NODE ) AND
      233     6314    2               ( ICT >= S_D.NCNSD.IC ) AND
      234     6315    2               ( ICT < S_D.NCNSD.RANGE + S_D.NCNSD.IC )
      235     6316    3             THEN DO;                      /* Already got it */

      236     6317    3                  ENTRY$ = PINCRW( S_D.SDEF$, SIZEW( B$SDEF ) * S_D.NCNSD.SDEF# );

   6317  0 000072   005271 720100                    LXL0    2745,,PR0
         0 000073   001043 471500                    LDP1    547,,PR0
         0 000074   000000 636010                    EAQ     0,X0
         0 000075   000021 772000                    QRL     17
         0 000076   100000 633506                    EPPR3   0,QL,PR1
         0 000077   200004 474500                    LDP4    @ENTRY$,,AUTO
         0 000100   400000 453500                    STP3    0,,PR4

      237     6318    3                  RETURN;

   6318  0 000101   000000 702200 xent               TSX2  ! X66_ARET

      238     6319    3                END;
      239     6320    2           END;
      240     6321    1        END$ = S_D.SDEF_END$;

   6321  0 000102   001045 236100                    LDQ     549,,PR0
         0 000103   200024 756100                    STQ     END$,,AUTO

      241     6322    1        FARTHEST_ANY = 1048576;            /* 2**20 */

   6322  0 000104   000004 235003                    LDA     4,DU
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:49   
         0 000105   200014 755100                    STA     FARTHEST_ANY,,AUTO

      242     6323    1        CLOSEST_ANY = -1048576;

   6323  0 000106   777774 235003                    LDA     -4,DU
         0 000107   200015 755100                    STA     CLOSEST_ANY,,AUTO

      243     6324    1        FARTHEST_NCN = 1048576;            /* 2**20 */

   6324  0 000110   000004 235003                    LDA     4,DU
         0 000111   200021 755100                    STA     FARTHEST_NCN,,AUTO

      244     6325    1        CLOSEST_NCN = -1048576;

   6325  0 000112   777774 235003                    LDA     -4,DU
         0 000113   200022 755100                    STA     CLOSEST_NCN,,AUTO

      245     6326    1        TSDEF$ = S_D.SDEF$;

   6326  0 000114   001043 236100                    LDQ     547,,PR0
         0 000115   200025 756100                    STQ     TSDEF$,,AUTO

      246     6327        /* Search the SYMDEF table */
      247     6328    2        DO WHILE ( TSDEF$ <= END$ );

   6328  0 000116   200024 116100                    CMPQ    END$,,AUTO
         0 000117   000121 600000 0                  TZE     s:6329
         0 000120   000203 603000 0                  TRC     s:6367

      248     6329    2             IF B$SDEF.AD.LFLAGS.SOURCE = %SOURCE_RLIB#

   6329  0 000121   200025 470500                    LDP0    TSDEF$,,AUTO
         0 000122   000000 236100                    LDQ     0,,PR0
         0 000123   700000 376003                    ANQ     -32768,DU
         0 000124   400000 116003                    CMPQ    -131072,DU
         0 000125   000175 600000 0                  TZE     NEXT_SDEF

PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:50   
      249     6330    2             THEN GOTO NEXT_SDEF;
      250     6331    2             CONSTNT = B$SDEF.CONSTNT;

   6331  0 000126   000001 236100                    LDQ     1,,PR0
         0 000127   000022 736000                    QLS     18
         0 000130   400000 376003                    ANQ     -131072,DU
         0 000131   200010 756100                    STQ     CONSTNT,,AUTO

      251     6332    2             IF CONSTNT

   6332  0 000132   200010 234100                    SZN     CONSTNT,,AUTO
         0 000133   000140 605000 0                  TPL     s:6334

      252     6333    2             THEN TEMP = B$SDEF.VALUE - ICT; /* Constant */

   6333  0 000134   000000 236100                    LDQ     0,,PR0
         0 000135   200006 136100                    SBLQ    ICT,,AUTO
         0 000136   200007 756100                    STQ     TEMP,,AUTO
         0 000137   000144 710000 0                  TRA     s:6336

      253     6334    2             ELSE TEMP = B$SDEF.AD.ISADDR - ICT; /* Address */

   6334  0 000140   000000 236100                    LDQ     0,,PR0
         0 000141   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000142   200006 136100                    SBLQ    ICT,,AUTO
         0 000143   200007 756100                    STQ     TEMP,,AUTO

      254     6335        /* Do for any SYMDEF (address or constant) */
      255     6336    2             IF ( TEMP > 0 )

   6336  0 000144   000151 604400 0                  TMOZ    s:6342

      256     6337    3             THEN DO;                      /* Check for farthest */

      257     6338    3                  IF ( TEMP < FARTHEST_ANY )

   6338  0 000145   200014 116100                    CMPQ    FARTHEST_ANY,,AUTO
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:51   
         0 000146   000156 605000 0                  TPL     s:6349

      258     6339    3                  THEN FARTHEST_ANY = TEMP;

   6339  0 000147   200014 756100                    STQ     FARTHEST_ANY,,AUTO

      259     6340    3                END;

   6340  0 000150   000156 710000 0                  TRA     s:6349

      260     6341    3             ELSE DO;                      /* Check for nearest */

      261     6342    3                  IF TEMP > CLOSEST_ANY

   6342  0 000151   200015 116100                    CMPQ    CLOSEST_ANY,,AUTO
         0 000152   000156 604400 0                  TMOZ    s:6349

      262     6343    4                  THEN DO;

      263     6344    4                       CLOSEST_ANY = TEMP;

   6344  0 000153   200015 756100                    STQ     CLOSEST_ANY,,AUTO

      264     6345    4                       ANY$ = TSDEF$;

   6345  0 000154   200025 236100                    LDQ     TSDEF$,,AUTO
         0 000155   200012 756100                    STQ     ANY$,,AUTO

      265     6346    4                     END;

      266     6347    3                END;

      267     6348        /* Do for non-constant (address type) SYMDEFs only */
      268     6349    2             IF NOT CONSTNT

   6349  0 000156   200010 234100                    SZN     CONSTNT,,AUTO
         0 000157   000175 604000 0                  TMI     NEXT_SDEF
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:52   

      269     6350    3             THEN DO;

      270     6351    3                  IF ( TEMP > 0 )

   6351  0 000160   200007 235100                    LDA     TEMP,,AUTO
         0 000161   000167 604400 0                  TMOZ    s:6357

      271     6352    4                  THEN DO;                 /* Check for farthest */

      272     6353    4                       IF ( TEMP < FARTHEST_NCN )

   6353  0 000162   200007 236100                    LDQ     TEMP,,AUTO
         0 000163   200021 116100                    CMPQ    FARTHEST_NCN,,AUTO
         0 000164   000175 605000 0                  TPL     NEXT_SDEF

      273     6354    4                       THEN FARTHEST_NCN = TEMP;

   6354  0 000165   200021 756100                    STQ     FARTHEST_NCN,,AUTO

      274     6355    4                     END;

   6355  0 000166   000175 710000 0                  TRA     NEXT_SDEF

      275     6356    4                  ELSE DO;                 /* Check for nearest */

      276     6357    4                       IF TEMP > CLOSEST_NCN

   6357  0 000167   200007 236100                    LDQ     TEMP,,AUTO
         0 000170   200022 116100                    CMPQ    CLOSEST_NCN,,AUTO
         0 000171   000175 604400 0                  TMOZ    NEXT_SDEF

      277     6358    5                       THEN DO;

      278     6359    5                            CLOSEST_NCN = TEMP;

   6359  0 000172   200022 756100                    STQ     CLOSEST_NCN,,AUTO
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:53   

      279     6360    5                            NCN$ = TSDEF$;

   6360  0 000173   200025 236100                    LDQ     TSDEF$,,AUTO
         0 000174   200017 756100                    STQ     NCN$,,AUTO

      280     6361    5                          END;

      281     6362    4                     END;

      282     6363    3                END;

      283     6364    2   NEXT_SDEF: TSDEF$ = PINCRW( TSDEF$, SIZEW( B$SDEF ) );

   6364  0 000175   200025 236100       NEXT_SDEF    LDQ     TSDEF$,,AUTO
         0 000176   000002 036003                    ADLQ    2,DU
         0 000177   200025 756100                    STQ     TSDEF$,,AUTO

      284     6365    2           END;

   6365  0 000200   200024 116100                    CMPQ    END$,,AUTO
         0 000201   000121 602000 0                  TNC     s:6329
         0 000202   000121 600000 0                  TZE     s:6329

      285     6366        /* Make sure we found it */
      286     6367    1        RANGE_NCN = FARTHEST_NCN - CLOSEST_NCN;

   6367  0 000203   200021 236100                    LDQ     FARTHEST_NCN,,AUTO
         0 000204   200022 136100                    SBLQ    CLOSEST_NCN,,AUTO
         0 000205   200023 756100                    STQ     RANGE_NCN,,AUTO

      287     6368    1        IF ( CLOSEST_NCN > -1048576 )

   6368  0 000206   200022 235100                    LDA     CLOSEST_NCN,,AUTO
         0 000207   777774 115003                    CMPA    -4,DU
         0 000210   000231 604400 0                  TMOZ    s:6375

PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:54   
      288     6369    2        THEN DO;

      289     6370    2             S_D.NCNSD.NODE = S_D.NODE;

   6370  0 000211   000000 470400 xsym               LDP0    S_D$
         0 000212   004706 235100                    LDA     2502,,PR0
         0 000213   005266 755100                    STA     2742,,PR0

      290     6371    2             S_D.NCNSD.RANGE = RANGE_NCN;

   6371  0 000214   005267 756100                    STQ     2743,,PR0

      291     6372    2             S_D.NCNSD.IC = NCN$ -> B$SDEF.AD.ISADDR;

   6372  0 000215   200017 471500                    LDP1    NCN$,,AUTO
         0 000216   100000 236100                    LDQ     0,,PR1
         0 000217   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000220   005270 756100                    STQ     2744,,PR0

      292     6373    2             S_D.NCNSD.SDEF# = POFFW( NCN$, S_D.SDEF$ ) / SIZEW( B$SDEF );

   6373  0 000221   001043 236100                    LDQ     547,,PR0
         0 000222   000022 772000                    QRL     18
         0 000223   200026 756100                    STQ     TSDEF$+1,,AUTO
         0 000224   200017 236100                    LDQ     NCN$,,AUTO
         0 000225   000022 772000                    QRL     18
         0 000226   200026 136100                    SBLQ    TSDEF$+1,,AUTO
         0 000227   000002 506007                    DIV     2,DL
         0 000230   005271 756100                    STQ     2745,,PR0

      293     6374    2           END;

      294     6375    1        RANGE_ANY = FARTHEST_ANY - CLOSEST_ANY;

   6375  0 000231   200014 236100                    LDQ     FARTHEST_ANY,,AUTO
         0 000232   200015 136100                    SBLQ    CLOSEST_ANY,,AUTO
         0 000233   200016 756100                    STQ     RANGE_ANY,,AUTO
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:55   

      295     6376    1        IF ( CLOSEST_ANY > -1048576 )

   6376  0 000234   200015 235100                    LDA     CLOSEST_ANY,,AUTO
         0 000235   777774 115003                    CMPA    -4,DU
         0 000236   000265 604400 0                  TMOZ    s:6386

      296     6377    2        THEN DO;

      297     6378    2             S_D.ANYSD.NODE = S_D.NODE;

   6378  0 000237   000000 470400 xsym               LDP0    S_D$
         0 000240   004706 235100                    LDA     2502,,PR0
         0 000241   005262 755100                    STA     2738,,PR0

      298     6379    2             S_D.ANYSD.RANGE = RANGE_ANY;

   6379  0 000242   005263 756100                    STQ     2739,,PR0

      299     6380    2             IF ANY$ -> B$SDEF.CONSTNT

   6380  0 000243   200012 471500                    LDP1    ANY$,,AUTO
         0 000244   100001 236100                    LDQ     1,,PR1
         0 000245   400000 316007                    CANQ    -131072,DL
         0 000246   000252 600000 0                  TZE     s:6382

      300     6381    2             THEN S_D.ANYSD.IC = ANY$ -> B$SDEF.VALUE;

   6381  0 000247   100000 235100                    LDA     0,,PR1
         0 000250   005264 755100                    STA     2740,,PR0
         0 000251   000255 710000 0                  TRA     s:6383

      301     6382    2             ELSE S_D.ANYSD.IC = ANY$ -> B$SDEF.AD.ISADDR;

   6382  0 000252   100000 236100                    LDQ     0,,PR1
         0 000253   000032 376000 xsym               ANQ     B_VECTNIL+26
         0 000254   005264 756100                    STQ     2740,,PR0
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:56   

      302     6383    2             S_D.ANYSD.SDEF# = POFFW( ANY$, S_D.SDEF$ ) / SIZEW( B$SDEF );

   6383  0 000255   001043 236100                    LDQ     547,,PR0
         0 000256   000022 772000                    QRL     18
         0 000257   200026 756100                    STQ     TSDEF$+1,,AUTO
         0 000260   200012 236100                    LDQ     ANY$,,AUTO
         0 000261   000022 772000                    QRL     18
         0 000262   200026 136100                    SBLQ    TSDEF$+1,,AUTO
         0 000263   000002 506007                    DIV     2,DL
         0 000264   005265 756100                    STQ     2741,,PR0

      303     6384    2           END;

      304     6385                                                /**/
      305     6386    1        IF ( NOT SKIPCT ) AND ( CLOSEST_ANY > -1048576 )

   6386  0 000265   200011 234100                    SZN     SKIPCT,,AUTO
         0 000266   000276 604000 0                  TMI     s:6391
         0 000267   200015 235100                    LDA     CLOSEST_ANY,,AUTO
         0 000270   777774 115003                    CMPA    -4,DU
         0 000271   000276 604400 0                  TMOZ    s:6391

      306     6387    2        THEN DO;

      307     6388    2             ENTRY$ = ANY$;

   6388  0 000272   200012 236100                    LDQ     ANY$,,AUTO
         0 000273   200004 470500                    LDP0    @ENTRY$,,AUTO
         0 000274   000000 756100                    STQ     0,,PR0

      308     6389    2             RETURN;

   6389  0 000275   000000 702200 xent               TSX2  ! X66_ARET

      309     6390    2           END;
      310     6391    1        ELSE IF ( SKIPCT ) AND ( CLOSEST_NCN > -1048576 )
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:57   

   6391  0 000276   200011 234100                    SZN     SKIPCT,,AUTO
         0 000277   000307 605000 0                  TPL     ALTRT
         0 000300   200022 235100                    LDA     CLOSEST_NCN,,AUTO
         0 000301   777774 115003                    CMPA    -4,DU
         0 000302   000307 604400 0                  TMOZ    ALTRT

      311     6392    2             THEN DO;

      312     6393    2                  ENTRY$ = NCN$;

   6393  0 000303   200017 236100                    LDQ     NCN$,,AUTO
         0 000304   200004 470500                    LDP0    @ENTRY$,,AUTO
         0 000305   000000 756100                    STQ     0,,PR0

      313     6394    2                  RETURN;

   6394  0 000306   000000 702200 xent               TSX2  ! X66_ARET

   6386  0 000307                       ALTRT        null
      314     6395    2                END;
      315     6396                                                /**/
      316     6397    1   ALTRT: ;
      317     6398    1        ALTRETURN;

   6398  0 000307   000000 702200 xent               TSX2  ! X66_AALT
      318     6399                                                /**/
      319     6400    1   END DDF$FIND_SYMDEF;

PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:58   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDF$FIND_SYMDEF.

   Procedure DDF$FIND_SYMDEF requires 200 words for executable code.
   Procedure DDF$FIND_SYMDEF requires 24 words of local(AUTO) storage.

    No errors detected in file DDF$FINDEFS.:E05TSI    .
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:59   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:60   
          MINI XREF LISTING

ALTRT
      6386**LABEL    6297--CALLALT  6299--GOTO
ANY$
        32**DCL      6345<<ASSIGN   6380>>IF       6381>>ASSIGN   6382>>ASSIGN   6383>>ASSIGN   6388>>ASSIGN
B$SDEF
      3475**DCL      6307--ASSIGN   6317--ASSIGN   6364--ASSIGN   6373--ASSIGN   6383--ASSIGN
B$SDEF.AD.ISADDR
      3501**DCL      6334>>ASSIGN   6372>>ASSIGN   6382>>ASSIGN
B$SDEF.AD.LFLAGS.SOURCE
      3485**DCL      6329>>IF
B$SDEF.AD.OU
      3495**DCL      3501--REDEF
B$SDEF.CONSTNT
      3506**DCL      6331>>ASSIGN   6380>>IF
B$SDEF.VALUE
      3476**DCL      3479--REDEF    6333>>ASSIGN   6381>>ASSIGN
CLOSEST_ANY
        35**DCL      6323<<ASSIGN   6342>>IF       6344<<ASSIGN   6375>>ASSIGN   6376>>IF       6386>>IF
CLOSEST_NCN
        40**DCL      6325<<ASSIGN   6357>>IF       6359<<ASSIGN   6367>>ASSIGN   6368>>IF       6391>>IF
CONSTNT
        30**DCL      6331<<ASSIGN   6332>>IF       6349>>IF
DDS$IC2NODE
      6291**DCL-ENT  6297--CALL
END$
        42**DCL      6321<<ASSIGN   6328>>DOWHILE
ENTRY$
        26**DCL        23--PROC     6307<<ASSIGN   6317<<ASSIGN   6388<<ASSIGN   6393<<ASSIGN
FARTHEST_ANY
        34**DCL      6322<<ASSIGN   6338>>IF       6339<<ASSIGN   6375>>ASSIGN
FARTHEST_NCN
        39**DCL      6324<<ASSIGN   6353>>IF       6354<<ASSIGN   6367>>ASSIGN
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:61   
IC
        25**DCL        23--PROC     6294>>ASSIGN
ICT
        28**DCL      6294<<ASSIGN   6297<>CALL     6302>>IF       6302>>IF       6312>>IF       6312>>IF
      6333>>ASSIGN   6334>>ASSIGN
NCN$
        37**DCL      6360<<ASSIGN   6372>>ASSIGN   6373>>ASSIGN   6393>>ASSIGN
NEXT_SDEF
      6364**LABEL    6330--GOTO
RANGE_ANY
        36**DCL      6375<<ASSIGN   6379>>ASSIGN
RANGE_NCN
        41**DCL      6367<<ASSIGN   6371>>ASSIGN
SKIPC
        27**DCL        23--PROC     6295>>ASSIGN
SKIPCT
        31**DCL      6295<<ASSIGN   6300>>IF       6386>>IF       6391>>IF
S_D.ANYSD.IC
      5854**DCL      6302>>IF       6302>>IF       6381<<ASSIGN   6382<<ASSIGN
S_D.ANYSD.NODE
      5849**DCL      6302>>IF       6378<<ASSIGN
S_D.ANYSD.RANGE
      5851**DCL      6302>>IF       6302>>IF       6379<<ASSIGN
S_D.ANYSD.SDEF#
      5856**DCL      6307>>ASSIGN   6383<<ASSIGN
S_D.CURRENT_CHANNEL
      5925**DCL      5927--REDEF
S_D.DEBUGA
      5077**DCL      5079--REDEF
S_D.EIS
      6035**DCL      6064--REDEF
S_D.HOST_MESSAGE_BUF_REMOTE
      5968**DCL      5969--REDEF    5983--REDEF
S_D.JDE
      5582**DCL      5583--REDEF
S_D.L$.VALUE
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:62   
      5135**DCL      5141--REDEF    5149--REDEF    5152--REDEF    5155--REDEF    5158--REDEF
S_D.L$.VALUE.L
      5136**DCL      5137--REDEF    5138--REDEF
S_D.L6_MESSAGE_BUF
      5989**DCL      5991--REDEF
S_D.NCNSD.IC
      5865**DCL      6312>>IF       6312>>IF       6372<<ASSIGN
S_D.NCNSD.NODE
      5860**DCL      6312>>IF       6370<<ASSIGN
S_D.NCNSD.RANGE
      5862**DCL      6312>>IF       6312>>IF       6371<<ASSIGN
S_D.NCNSD.SDEF#
      5867**DCL      6317>>ASSIGN   6373<<ASSIGN
S_D.NODE
      5534**DCL      6302>>IF       6312>>IF       6370>>ASSIGN   6378>>ASSIGN
S_D.OUTPUT
      5955**DCL      5957--REDEF
S_D.OVERLAID
      5639**DCL      6296>>IF
S_D.REMOTE_MSG.FNCC
      5974**DCL      5975--REDEF
S_D.REMOTE_MSG.STXC
      5970**DCL      5971--REDEF
S_D.REMOTE_MSG.SUBFNCC
      5978**DCL      5979--REDEF
S_D.SDEF$
      5423**DCL      6298>>IF       6307>>ASSIGN   6317>>ASSIGN   6326>>ASSIGN   6373>>ASSIGN   6383>>ASSIGN
S_D.SDEF_END$
      5427**DCL      6321>>ASSIGN
S_D.SV
      5034**DCL      5055--REDEF
S_D$
      6286**DCL      4982--IMP-PTR  6296>>IF       6298>>IF       6302>>IF       6302>>IF       6302>>IF
      6302>>IF       6302>>IF       6302>>IF       6307>>ASSIGN   6307>>ASSIGN   6312>>IF       6312>>IF
      6312>>IF       6312>>IF       6312>>IF       6312>>IF       6317>>ASSIGN   6317>>ASSIGN   6321>>ASSIGN
      6326>>ASSIGN   6370>>ASSIGN   6370>>ASSIGN   6371>>ASSIGN   6372>>ASSIGN   6373>>ASSIGN   6373>>ASSIGN
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:63   
      6378>>ASSIGN   6378>>ASSIGN   6379>>ASSIGN   6381>>ASSIGN   6382>>ASSIGN   6383>>ASSIGN   6383>>ASSIGN
TEMP
        29**DCL      6333<<ASSIGN   6334<<ASSIGN   6336>>IF       6338>>IF       6339>>ASSIGN   6342>>IF
      6344>>ASSIGN   6351>>IF       6353>>IF       6354>>ASSIGN   6357>>IF       6359>>ASSIGN
TSDEF$
        43**DCL      3475--IMP-PTR  6326<<ASSIGN   6328>>DOWHILE  6329>>IF       6331>>ASSIGN   6333>>ASSIGN
      6334>>ASSIGN   6345>>ASSIGN   6360>>ASSIGN   6364<<ASSIGN   6364>>ASSIGN
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:64   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #003=DDF$FIND_SYMDEF File=DDF$FINDEFS.:E05TSI                      TUE 07/29/97 13:58 Page:65   
              MINI UREF LISTING

DDF$FIND_SYMDEF      23**PROC
DIFF_ANY      33**DCL
DIFF_NCN      38**DCL
