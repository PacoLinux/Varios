VERSION E05

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:1    
        1        1        /*M*     KPC$CERTIFY Certifies the integrity of the diskette surface          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*F*     NAME:          KPC$CERTIFY
        8        8                 PURPOSE:       Certify diskette surface
        9        9                 DESCRIPTION:   This command is used to certify the quality
       10       10                                of a diskette surface.  The disk is volinited
       11       11                                and test data is written and read.
       12       12        */
       13       13        KPC$CERTIFY : PROC( OUT$ );
       14       14        /**/
       15       15        /*  Include files  */
       16       16        /**/
       17       17        %INCLUDE XU_MACRO_C;
       18     3123        %INCLUDE KP_DATA_R;
       19     4375        %INCLUDE XU_SUBS_C;
       20     4467        %INCLUDE KP_MSG;
       21     4560        %INCLUDE XUF_ENTRY;
       22     4568        /**/
       23     4569        /*  Entry declarations  */
       24     4570        /**/
       25     4571        %KP_ENTRIES (OMIT=KPC$CERTIFY);
       26     4677        /**/
       27     4678        /*  BASED DATA  */
       28     4679        /**/
       29     4680        %PARSE$OUT    ( NAME    = OUT$BLK,
       30     4681                        STCLASS = BASED );
       31     4726        %KP$MSG (NAME = KP$MSG,STCLASS = BASED);
       32     4802        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:2    
       33     4803        /**/
       34     4804        /*  Local goodies  */
       35     4805        /**/
       36     4806    1   DCL OUT$ PTR;
       37     4807    1   DCL NSUBLKS UBIN WORD;
       38     4808    1   DCL FEP_NUM UBIN WORD;
       39     4809    1   DCL DRIVE_NUM UBIN WORD;
       40     4810    1   DCL PART SBIN WORD;
       41     4811    1   DCL PART$ PTR;
       42     4812    1   DCL OPT SBIN WORD;
       43     4813    1   DCL OPT$ PTR;
       44     4814    1   DCL TRACK SBIN WORD;
       45     4815    1   DCL SECTOR SBIN WORD;
       46     4816    1   DCL SIDE SBIN WORD;
       47     4817    1   DCL CROSSTALK SBIN WORD;
       48     4818    1   DCL PRINTTHROUGH SBIN WORD;
       49     4819    1   DCL RETRIES_V SBIN;
       50     4820    1   DCL RETRIES_W SBIN;
       51     4821    1   DCL RETRIES_R SBIN;
       52     4822    1   DCL RETRIES_D SBIN;
       53     4823    1   DCL TOT_RETRIES_V SBIN;
       54     4824    1   DCL TOT_RETRIES_W SBIN;
       55     4825    1   DCL TOT_RETRIES_R SBIN;
       56     4826    1   DCL TOT_RETRIES_D SBIN;
       57     4827    1   DCL TOT_HARD SBIN;
       58     4828    1   DCL IMAGE_SIZE UBIN(16) UNAL;
       59     4829    1   DCL 1 IMAGE_SIZE_ REDEF IMAGE_SIZE,
       60     4830    1         2 HOB UBIN(8) UNAL,
       61     4831    1         2 LOB UBIN(8) UNAL;
       62     4832    1   DCL HARD BIT(1);
       63     4833        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:3    
       64     4834        /**/
       65     4835        /*  FORMATTER TEXT STRINGS  */
       66     4836        /**/
       67     4837    1   DCL FMT1 CONSTANT CHAR(0) INIT(
       68     4838    1            'Track %D, side %D is error_free.');
       69     4839    1   DCL FMT2 CONSTANT CHAR(0) INIT(
       70     4840    1            'Track %D, side %D ERRORS -> volinit=%D, write=%D, read=%D, data=%D.');
       71     4841    1   DCL FMT4 CONSTANT CHAR(0) INIT(
       72     4842    1            'Total ERRORS -> volinit=%D, write=%D, read=%D, data=%D.');
       73     4843    1   DCL FMT5 CONSTANT CHAR(0) INIT(
       74     4844    1            'Print-through errors=%D, crosstalk errors = %D.');
       75     4845        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:4    
       76     4846        /**/
       77     4847        /*  Hook to implement testing of diskette DRIVE.  */
       78     4848        /**/
       79     4849    1   KPC$CERTDRV: ENTRY( OUT$ );
       80     4850        /**/
       81     4851        /*  Make sure he is allowed to do this thing.  */
       82     4852        /**/
       83     4853    1           CALL KPU$SECURITY(%KP_PRIV_WR#) ALTRET(CANT_OPEN);
       84     4854    1           CALL KPD$DISK_TYPE (IN_OPTS,%DT_RFEP#);
       85     4855        /**/
       86     4856        /*  Initialize some stuff.  */
       87     4857        /**/
       88     4858    1           F_FDS.DVFC# = ' ';
       89     4859    1           TOT_RETRIES_V = 0;
       90     4860    1           TOT_RETRIES_W = 0;
       91     4861    1           TOT_RETRIES_R = 0;
       92     4862    1           TOT_RETRIES_D = 0;
       93     4863        /**/
       94     4864        /*  Loop, processing options.  */
       95     4865        /**/
       96     4866    2           DO PART = 0 TO OUT$ -> OUT$BLK.NSUBLKS -1;
       97     4867    2              PART$ = OUT$ -> OUT$BLK.SUBLK$(PART);
       98     4868    3              DO CASE(PART$ -> OUT$BLK.CODE);
       99     4869    3               CASE(1);                    /* CERTIFY options                    */
      100     4870    3                 CALL KPU$OPTIONS (IN_OPTS,PART$) ALTRET(BAD_OPTS);
      101     4871    3               CASE(2);                    /* DRIVE ID                           */
      102     4872    3                 CALL KPU$FEP_AND_DRIVE(
      103     4873    3                   PART$ -> OUT$BLK,
      104     4874    3                   FEP_NUM,DRIVE_NUM) ALTRET(CANT_OPEN);
      105     4875    3                 CALL KPX$OPEN( FEP_NUM, DRIVE_NUM ) ALTRET(CANT_OPEN);
      106     4876    3               END;                        /* END CASE                           */
      107     4877    2              END;                         /* END DO INDEX                       */
      108     4878        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:5    
      109     4879        /**/
      110     4880        /* Tell the human what we're up to */
      111     4881        /**/
      112     4882    1           CALL KPT$TERM_MSG( %T$CERTIFYING );
      113     4883        /**/
      114     4884        /*  Perform preliminary tests for crosstalk and printthrough.  */
      115     4885        /**/
      116     4886    1           KP_DISK_ACTIVITY = %KP_DISK_CERT2#;
      117     4887    1           KP_FECG_OUT$ -> KP$MSG.HEAD.MSG_TYPE = %KP_CER2_RQS#;
      118     4888    1           KP_FECG_OUT$ -> KP$MSG.HEAD.DRIVE_NO = DRIVE_NUM;
      119     4889    1           KP_FECG_OUT$ -> KP$MSG.HEAD.SEC_SIZE = IN_OPTS.SSIZE_CODE;
      120     4890    1           KP_FECG_OUT$ -> KP$MSG.HEAD.TRACK_NO = IN_OPTS.TRACK_LO;
      121     4891    1           KP_FECG_OUT$ -> KP$MSG.HEAD.SECTOR_NO = IN_OPTS.SECTOR_LO;
      122     4892    1           KP_FECG_OUT$ -> KP$MSG.CER2_RQS.SECTOR_HI = IN_OPTS.SECTOR_HI;
      123     4893    1           KP_FECG_OUT$ -> KP$MSG.CER2_RQS.TRACK_HI = IN_OPTS.TRACK_HI;
      124     4894    1           KP_FECG_OUT$ -> KP$MSG.CER2_RQS.SIDE_HI = IN_OPTS.SIDE_HI;
      125     4895    1           KP_FECG_OUT$ -> KP$MSG.HEAD.SIDE = IN_OPTS.SIDE_LO;
      126     4896    1           IMAGE_SIZE = SIZEC(KP$MSG.CER2_RQS) - SIZEC(KP$MSG.CER2_RQS.SPARE);
      127     4897    1           KP_FECG_OUT$ -> KP$MSG.HEAD.NUM_BYTES.HOB = IMAGE_SIZE_.HOB;
      128     4898    1           KP_FECG_OUT$ -> KP$MSG.HEAD.NUM_BYTES.LOB = IMAGE_SIZE_.LOB;
      129     4899    1           KP_FECG_OUT_SIZE = SIZEC(KP$MSG.HEAD) + IMAGE_SIZE;
      130     4900    1           CALL KPI$IO_SVC(%KP_FECG_WRITE#) ALTRET(PIGETTE_ERR);
      131     4901    1           CALL KPI$IO_SVC(%KP_FECG_READ#) ALTRET(PIGETTE_ERR);
      132     4902    1           CALL KPE$CHECK_ERR(%KP_CER2_RSP#) ALTRET(PIGETTE_ERR);
      133     4903    1           PRINTTHROUGH = KP_FECG_IN$ -> KP$MSG.CER2_RSP.PRINTTHROUGH;
      134     4904    1           CROSSTALK = KP_FECG_IN$ -> KP$MSG.CER2_RSP.CROSSTALK;
      135     4905    1           CALL X$WRITE (F_FDS, VECTOR(FMT5),
      136     4906    1                         VECTOR(PRINTTHROUGH),
      137     4907    1                         VECTOR(CROSSTALK) );
      138     4908    1           CALL KPI$IO_SVC (%KP_LO_WRITE#);
      139     4909        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:6    
      140     4910    1           KP_DISK_ACTIVITY = %KP_DISK_CERTIFYING#;
      141     4911        /**/
      142     4912        /*  For each track to be formatted...  */
      143     4913        /**/
      144     4914    2           DO TRACK = IN_OPTS.TRACK_LO TO IN_OPTS.TRACK_HI;
      145     4915    3              DO SIDE = IN_OPTS.SIDE_LO TO IN_OPTS.SIDE_HI;
      146     4916        /**/
      147     4917        /*  Send message to the FEP.  */
      148     4918        /**/
      149     4919    3                 KP_DISK_ACTIVITY = %KP_DISK_CERTIFYING#;
      150     4920    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.MSG_TYPE = %KP_CERTIFY_RQS#;
      151     4921    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.DRIVE_NO = DRIVE_NUM;
      152     4922    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.SEC_SIZE = IN_OPTS.SSIZE_CODE;
      153     4923    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.TRACK_NO = TRACK;
      154     4924    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.SECTOR_NO = IN_OPTS.SECTOR_LO;
      155     4925    3                 KP_FECG_OUT$ -> KP$MSG.CRTFY_RQS.SECTOR_HI = IN_OPTS.SECTOR_HI;
      156     4926    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.SIDE = SIDE;
      157     4927    3                 IMAGE_SIZE = SIZEC(KP$MSG.CRTFY_RQS) - SIZEC(KP$MSG.CRTFY_RQS.SPARE);
      158     4928    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.NUM_BYTES.HOB = IMAGE_SIZE_.HOB;
      159     4929    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.NUM_BYTES.LOB = IMAGE_SIZE_.LOB;
      160     4930    3                 KP_FECG_OUT_SIZE = SIZEC(KP$MSG.HEAD) + IMAGE_SIZE;
      161     4931    3                 CALL KPI$IO_SVC(%KP_FECG_WRITE#) ALTRET(PIGETTE_ERR);
      162     4932        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:7    
      163     4933        /**/
      164     4934        /*  Read response from FEP and check for errors.  */
      165     4935        /**/
      166     4936    3                 CALL KPI$IO_SVC(%KP_FECG_READ#) ALTRET(PIGETTE_ERR);
      167     4937    3                 CALL KPE$CHECK_ERR(%KP_CERTIFY_RSP#)
      168     4938    4                      WHENRETURN DO;
      169     4939    4                                   HARD='0'B;
      170     4940    4                                   END;
      171     4941    4                      WHENALTRETURN DO;
      172     4942    4                                      HARD='1'B;
      173     4943    4                                      END;
      174     4944        /**/
      175     4945        /*  Make grand totals of all error counts.  */
      176     4946        /**/
      177     4947    3                 RETRIES_V = KP_FECG_IN$ -> KP$MSG.CRTFY_RSP.VINIT_RETRIES;
      178     4948    3                 RETRIES_W = KP_FECG_IN$ -> KP$MSG.CRTFY_RSP.WRITE_RETRIES;
      179     4949    3                 RETRIES_R = KP_FECG_IN$ -> KP$MSG.CRTFY_RSP.READ_RETRIES;
      180     4950    3                 RETRIES_D = KP_FECG_IN$ -> KP$MSG.CRTFY_RSP.READ_DATA_ERRORS;
      181     4951    3                 TOT_RETRIES_V = TOT_RETRIES_V + RETRIES_V;
      182     4952    3                 TOT_RETRIES_W = TOT_RETRIES_W + RETRIES_W;
      183     4953    3                 TOT_RETRIES_R = TOT_RETRIES_R + RETRIES_R;
      184     4954    3                 TOT_RETRIES_D = TOT_RETRIES_D + RETRIES_D;
      185     4955    3                 TOT_HARD = TOT_HARD + BITBIN(HARD);
      186     4956        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:8    
      187     4957        /**/
      188     4958        /*  Print appropriate error message.  */
      189     4959        /**/
      190     4960    3                 IF (RETRIES_V+RETRIES_W+RETRIES_R+RETRIES_D+BITBIN(HARD)) = 0 THEN
      191     4961    3                    CALL X$WRITE (F_FDS, VECTOR(FMT1),
      192     4962    3                                  VECTOR(TRACK),
      193     4963    3                                  VECTOR(SIDE));
      194     4964    3                 ELSE
      195     4965    4                    DO;
      196     4966    4                      CALL X$WRITE (F_FDS, VECTOR(FMT2),
      197     4967    4                                    VECTOR(TRACK),
      198     4968    4                                    VECTOR(SIDE),
      199     4969    4                                    VECTOR(RETRIES_V),
      200     4970    4                                    VECTOR(RETRIES_W),
      201     4971    4                                    VECTOR(RETRIES_R),
      202     4972    4                                    VECTOR(RETRIES_D) );
      203     4973    4                      END;
      204     4974    3                 CALL KPI$IO_SVC (%KP_LO_WRITE#);
      205     4975        /**/
      206     4976    3                 END;                      /* END DO SIDE                        */
      207     4977    2              END;                         /* END DO TRACK                       */
      208     4978        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:9    
      209     4979        /**/
      210     4980        /*  We're finished, and it all went OK.  */
      211     4981        /**/
      212     4982    1           CALL KPX$CLOSE( FEP_NUM, DRIVE_NUM ) ALTRET(CANT_CLOSE);
      213     4983        /**/
      214     4984    1           CALL X$WRITE (F_FDS, VECTOR(FMT4),
      215     4985    1                         VECTOR(TOT_RETRIES_V),
      216     4986    1                         VECTOR(TOT_RETRIES_W),
      217     4987    1                         VECTOR(TOT_RETRIES_R),
      218     4988    1                         VECTOR(TOT_RETRIES_D) );
      219     4989    1           CALL KPI$IO_SVC (%KP_LO_WRITE#);
      220     4990        /**/
      221     4991    1           RETURN;
      222     4992        /**/
      223     4993        /* Get here when things become severely fouled */
      224     4994        /**/
      225     4995    1   BAD_OPTS: ;
      226     4996    1   PIGETTE_ERR: ;
      227     4997    1   CANT_CLOSE: ;
      228     4998    1   CANT_OPEN: ;
      229     4999    1           RETURN;
      230     5000    1   END KPC$CERTIFY;

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:10   
--  Include file information  --

   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   KP_MSG.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KP_MACRO_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KP_PERR_C.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KPC$CERTIFY.

   Procedure KPC$CERTIFY requires 421 words for executable code.
   Procedure KPC$CERTIFY requires 72 words of local(AUTO) storage.

    No errors detected in file KPC$CERTIFY.:E05TSI    .

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:11   

 Object Unit name= KPC$CERTIFY                                File name= KPC$CERTIFY.:E05TOU
 UTS= JUL 30 '97 01:17:14.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     51     63  KPC$CERTIFY
    2   Proc  even  none   421    645  KPC$CERTIFY
    3  RoData even  none    28     34  KPC$CERTIFY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  KPC$CERTIFY
     2      3                  yes      Std        1  KPC$CERTDRV
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:12   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KPU$SECURITY
 yes     yes           Std       2 KPU$OPTIONS
 yes     yes           Std       2 KPX$OPEN
         yes           Std       1 KPT$TERM_MSG
         yes           Std       2 KPD$DISK_TYPE
 yes     yes           Std       1 KPE$CHECK_ERR
         yes           Std      22 X$WRITE
 yes     yes           Std       3 KPU$FEP_AND_DRIVE
 yes     yes           Std       2 KPX$CLOSE
 yes     yes           Std       1 KPI$IO_SVC
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KP_INBUF                              KP_RU_OUTBUF
     KP_FECG_IN$                           KP_FECG_OUT$                          KP_FECG_OUT_SIZE
     KP_RU_KEY                             KP_DISK_ACTIVITY                      IN_OPTS
     F_FDS                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:13   


        1        1        /*M*     KPC$CERTIFY Certifies the integrity of the diskette surface          */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*F*     NAME:          KPC$CERTIFY
        8        8                 PURPOSE:       Certify diskette surface
        9        9                 DESCRIPTION:   This command is used to certify the quality
       10       10                                of a diskette surface.  The disk is volinited
       11       11                                and test data is written and read.
       12       12        */
       13       13        KPC$CERTIFY : PROC( OUT$ );

     13  2 000000   000000 700200 xent  KPC$CERTIFY  TSX0  ! X66_AUTO_1
         2 000001   000110 000001                    ZERO    72,1
         2 000002   000005 710000 2                  TRA     s:4853

       14       14        /**/
       15       15        /*  Include files  */
       16       16        /**/
       17       17        %INCLUDE XU_MACRO_C;
       18     3123        %INCLUDE KP_DATA_R;
       19     4375        %INCLUDE XU_SUBS_C;
       20     4467        %INCLUDE KP_MSG;
       21     4560        %INCLUDE XUF_ENTRY;
       22     4568        /**/
       23     4569        /*  Entry declarations  */
       24     4570        /**/
       25     4571        %KP_ENTRIES (OMIT=KPC$CERTIFY);
       26     4677        /**/
       27     4678        /*  BASED DATA  */
       28     4679        /**/
       29     4680        %PARSE$OUT    ( NAME    = OUT$BLK,
       30     4681                        STCLASS = BASED );
       31     4726        %KP$MSG (NAME = KP$MSG,STCLASS = BASED);
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:14   
       32     4802        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:15   
       33     4803        /**/
       34     4804        /*  Local goodies  */
       35     4805        /**/
       36     4806    1   DCL OUT$ PTR;
       37     4807    1   DCL NSUBLKS UBIN WORD;
       38     4808    1   DCL FEP_NUM UBIN WORD;
       39     4809    1   DCL DRIVE_NUM UBIN WORD;
       40     4810    1   DCL PART SBIN WORD;
       41     4811    1   DCL PART$ PTR;
       42     4812    1   DCL OPT SBIN WORD;
       43     4813    1   DCL OPT$ PTR;
       44     4814    1   DCL TRACK SBIN WORD;
       45     4815    1   DCL SECTOR SBIN WORD;
       46     4816    1   DCL SIDE SBIN WORD;
       47     4817    1   DCL CROSSTALK SBIN WORD;
       48     4818    1   DCL PRINTTHROUGH SBIN WORD;
       49     4819    1   DCL RETRIES_V SBIN;
       50     4820    1   DCL RETRIES_W SBIN;
       51     4821    1   DCL RETRIES_R SBIN;
       52     4822    1   DCL RETRIES_D SBIN;
       53     4823    1   DCL TOT_RETRIES_V SBIN;
       54     4824    1   DCL TOT_RETRIES_W SBIN;
       55     4825    1   DCL TOT_RETRIES_R SBIN;
       56     4826    1   DCL TOT_RETRIES_D SBIN;
       57     4827    1   DCL TOT_HARD SBIN;
       58     4828    1   DCL IMAGE_SIZE UBIN(16) UNAL;
       59     4829    1   DCL 1 IMAGE_SIZE_ REDEF IMAGE_SIZE,
       60     4830    1         2 HOB UBIN(8) UNAL,
       61     4831    1         2 LOB UBIN(8) UNAL;
       62     4832    1   DCL HARD BIT(1);
       63     4833        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:16   
       64     4834        /**/
       65     4835        /*  FORMATTER TEXT STRINGS  */
       66     4836        /**/
       67     4837    1   DCL FMT1 CONSTANT CHAR(0) INIT(
       68     4838    1            'Track %D, side %D is error_free.');
       69     4839    1   DCL FMT2 CONSTANT CHAR(0) INIT(
       70     4840    1            'Track %D, side %D ERRORS -> volinit=%D, write=%D, read=%D, data=%D.');
       71     4841    1   DCL FMT4 CONSTANT CHAR(0) INIT(
       72     4842    1            'Total ERRORS -> volinit=%D, write=%D, read=%D, data=%D.');
       73     4843    1   DCL FMT5 CONSTANT CHAR(0) INIT(
       74     4844    1            'Print-through errors=%D, crosstalk errors = %D.');
       75     4845        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:17   
       76     4846        /**/
       77     4847        /*  Hook to implement testing of diskette DRIVE.  */
       78     4848        /**/
       79     4849    1   KPC$CERTDRV: ENTRY( OUT$ );

   4849  2 000003   000000 700200 xent  KPC$CERTDRV  TSX0  ! X66_AUTO_1
         2 000004   000110 000001                    ZERO    72,1

       80     4850        /**/
       81     4851        /*  Make sure he is allowed to do this thing.  */
       82     4852        /**/
       83     4853    1           CALL KPU$SECURITY(%KP_PRIV_WR#) ALTRET(CANT_OPEN);

   4853  2 000005   000000 630400 3                  EPPR0   0
         2 000006   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000007   000000 701000 xent               TSX1    KPU$SECURITY
         2 000010   000644 702000 2                  TSX2    BAD_OPTS

       84     4854    1           CALL KPD$DISK_TYPE (IN_OPTS,%DT_RFEP#);

   4854  2 000011   000001 630400 3                  EPPR0   1
         2 000012   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000013   000000 701000 xent               TSX1    KPD$DISK_TYPE
         2 000014   000000 011000                    NOP     0

       85     4855        /**/
       86     4856        /*  Initialize some stuff.  */
       87     4857        /**/
       88     4858    1           F_FDS.DVFC# = ' ';

   4858  2 000015   040000 236007                    LDQ     16384,DL
         2 000016   000013 552010 xsym               STBQ    F_FDS+11,'10'O

       89     4859    1           TOT_RETRIES_V = 0;

   4859  2 000017   200024 450100                    STZ     TOT_RETRIES_V,,AUTO

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:18   
       90     4860    1           TOT_RETRIES_W = 0;

   4860  2 000020   200025 450100                    STZ     TOT_RETRIES_W,,AUTO

       91     4861    1           TOT_RETRIES_R = 0;

   4861  2 000021   200026 450100                    STZ     TOT_RETRIES_R,,AUTO

       92     4862    1           TOT_RETRIES_D = 0;

   4862  2 000022   200027 450100                    STZ     TOT_RETRIES_D,,AUTO

       93     4863        /**/
       94     4864        /*  Loop, processing options.  */
       95     4865        /**/
       96     4866    2           DO PART = 0 TO OUT$ -> OUT$BLK.NSUBLKS -1;

   4866  2 000023   200007 450100                    STZ     PART,,AUTO
         2 000024   000075 710000 2                  TRA     s:4877+1

       97     4867    2              PART$ = OUT$ -> OUT$BLK.SUBLK$(PART);

   4867  2 000025   200003 470500                    LDP0    @OUT$,,AUTO
         2 000026   000000 471500                    LDP1    0,,PR0
         2 000027   200007 720100                    LXL0    PART,,AUTO
         2 000030   100003 236110                    LDQ     3,X0,PR1
         2 000031   200010 756100                    STQ     PART$,,AUTO

       98     4868    3              DO CASE(PART$ -> OUT$BLK.CODE);

   4868  2 000032   200010 471500                    LDP1    PART$,,AUTO
         2 000033   100000 721100                    LXL1    0,,PR1
         2 000034   000003 101003                    CMPX1   3,DU
         2 000035   000037 602011 2                  TNC     s:4868+5,X1
         2 000036   000074 710000 2                  TRA     s:4877
         2 000037   000074 710000 2                  TRA     s:4877
         2 000040   000042 710000 2                  TRA     s:4870
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:19   
         2 000041   000053 710000 2                  TRA     s:4872

       99     4869    3               CASE(1);                    /* CERTIFY options                    */

      100     4870    3                 CALL KPU$OPTIONS (IN_OPTS,PART$) ALTRET(BAD_OPTS);

   4870  2 000042   200010 633500                    EPPR3   PART$,,AUTO
         2 000043   200035 453500                    STP3    HARD+3,,AUTO
         2 000044   000001 236000 3                  LDQ     1
         2 000045   200034 756100                    STQ     HARD+2,,AUTO
         2 000046   200034 630500                    EPPR0   HARD+2,,AUTO
         2 000047   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000050   000000 701000 xent               TSX1    KPU$OPTIONS
         2 000051   000644 702000 2                  TSX2    BAD_OPTS
         2 000052   000074 710000 2                  TRA     s:4877

      101     4871    3               CASE(2);                    /* DRIVE ID                           */

      102     4872    3                 CALL KPU$FEP_AND_DRIVE(

   4872  2 000053   200006 633500                    EPPR3   DRIVE_NUM,,AUTO
         2 000054   200036 453500                    STP3    HARD+4,,AUTO
         2 000055   200005 634500                    EPPR4   FEP_NUM,,AUTO
         2 000056   200035 454500                    STP4    HARD+3,,AUTO
         2 000057   200034 756100                    STQ     HARD+2,,AUTO
         2 000060   200034 630500                    EPPR0   HARD+2,,AUTO
         2 000061   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000062   000000 701000 xent               TSX1    KPU$FEP_AND_DRIVE
         2 000063   000644 702000 2                  TSX2    BAD_OPTS

      103     4873    3                   PART$ -> OUT$BLK,
      104     4874    3                   FEP_NUM,DRIVE_NUM) ALTRET(CANT_OPEN);
      105     4875    3                 CALL KPX$OPEN( FEP_NUM, DRIVE_NUM ) ALTRET(CANT_OPEN);

   4875  2 000064   200006 630500                    EPPR0   DRIVE_NUM,,AUTO
         2 000065   200035 450500                    STP0    HARD+3,,AUTO
         2 000066   200005 631500                    EPPR1   FEP_NUM,,AUTO
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:20   
         2 000067   200034 451500                    STP1    HARD+2,,AUTO
         2 000070   200034 630500                    EPPR0   HARD+2,,AUTO
         2 000071   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000072   000000 701000 xent               TSX1    KPX$OPEN
         2 000073   000644 702000 2                  TSX2    BAD_OPTS

      106     4876    3               END;                        /* END CASE                           */

      107     4877    2              END;                         /* END DO INDEX                       */

   4877  2 000074   200007 054100                    AOS     PART,,AUTO
         2 000075   200003 470500                    LDP0    @OUT$,,AUTO
         2 000076   000000 471500                    LDP1    0,,PR0
         2 000077   100001 236100                    LDQ     1,,PR1
         2 000100   000022 772000                    QRL     18
         2 000101   200007 116100                    CMPQ    PART,,AUTO
         2 000102   000025 605400 2                  TPNZ    s:4867

      108     4878        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:21   
      109     4879        /**/
      110     4880        /* Tell the human what we're up to */
      111     4881        /**/
      112     4882    1           CALL KPT$TERM_MSG( %T$CERTIFYING );

   4882  2 000103   000004 630400 3                  EPPR0   4
         2 000104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000105   000000 701000 xent               TSX1    KPT$TERM_MSG
         2 000106   000000 011000                    NOP     0

      113     4883        /**/
      114     4884        /*  Perform preliminary tests for crosstalk and printthrough.  */
      115     4885        /**/
      116     4886    1           KP_DISK_ACTIVITY = %KP_DISK_CERT2#;

   4886  2 000107   000006 235007                    LDA     6,DL
         2 000110   000000 755000 xsym               STA     KP_DISK_ACTIVITY

      117     4887    1           KP_FECG_OUT$ -> KP$MSG.HEAD.MSG_TYPE = %KP_CER2_RQS#;

   4887  2 000111   000000 470400 xsym               LDP0    KP_FECG_OUT$
         2 000112   023000 236003                    LDQ     9728,DU
         2 000113   000000 552140                    STBQ    0,'40'O,PR0

      118     4888    1           KP_FECG_OUT$ -> KP$MSG.HEAD.DRIVE_NO = DRIVE_NUM;

   4888  2 000114   000000 470400 xsym               LDP0    KP_FECG_OUT$
         2 000115   200006 236100                    LDQ     DRIVE_NUM,,AUTO
         2 000116   000022 736000                    QLS     18
         2 000117   000000 552120                    STBQ    0,'20'O,PR0

      119     4889    1           KP_FECG_OUT$ -> KP$MSG.HEAD.SEC_SIZE = IN_OPTS.SSIZE_CODE;

   4889  2 000120   000000 470400 xsym               LDP0    KP_FECG_OUT$
         2 000121   000011 236000 xsym               LDQ     IN_OPTS+9
         2 000122   000002 552104                    STBQ    2,'04'O,PR0

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:22   
      120     4890    1           KP_FECG_OUT$ -> KP$MSG.HEAD.TRACK_NO = IN_OPTS.TRACK_LO;

   4890  2 000123   000000 236000 xsym               LDQ     IN_OPTS
         2 000124   000022 736000                    QLS     18
         2 000125   000002 552120                    STBQ    2,'20'O,PR0

      121     4891    1           KP_FECG_OUT$ -> KP$MSG.HEAD.SECTOR_NO = IN_OPTS.SECTOR_LO;

   4891  2 000126   000002 236000 xsym               LDQ     IN_OPTS+2
         2 000127   000011 736000                    QLS     9
         2 000130   000002 552110                    STBQ    2,'10'O,PR0

      122     4892    1           KP_FECG_OUT$ -> KP$MSG.CER2_RQS.SECTOR_HI = IN_OPTS.SECTOR_HI;

   4892  2 000131   000003 236000 xsym               LDQ     IN_OPTS+3
         2 000132   000011 736000                    QLS     9
         2 000133   000004 552110                    STBQ    4,'10'O,PR0

      123     4893    1           KP_FECG_OUT$ -> KP$MSG.CER2_RQS.TRACK_HI = IN_OPTS.TRACK_HI;

   4893  2 000134   000001 236000 xsym               LDQ     IN_OPTS+1
         2 000135   000033 736000                    QLS     27
         2 000136   000005 552140                    STBQ    5,'40'O,PR0

      124     4894    1           KP_FECG_OUT$ -> KP$MSG.CER2_RQS.SIDE_HI = IN_OPTS.SIDE_HI;

   4894  2 000137   000005 236000 xsym               LDQ     IN_OPTS+5
         2 000140   000004 552104                    STBQ    4,'04'O,PR0

      125     4895    1           KP_FECG_OUT$ -> KP$MSG.HEAD.SIDE = IN_OPTS.SIDE_LO;

   4895  2 000141   000004 236000 xsym               LDQ     IN_OPTS+4
         2 000142   000033 736000                    QLS     27
         2 000143   000002 552140                    STBQ    2,'40'O,PR0

      126     4896    1           IMAGE_SIZE = SIZEC(KP$MSG.CER2_RQS) - SIZEC(KP$MSG.CER2_RQS.SPARE);

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:23   
   4896  2 000144   200031 236100                    LDQ     IMAGE_SIZE,,AUTO
         2 000145   000005 376000 3                  ANQ     5
         2 000146   000014 276003                    ORQ     12,DU
         2 000147   200031 756100                    STQ     IMAGE_SIZE,,AUTO

      127     4897    1           KP_FECG_OUT$ -> KP$MSG.HEAD.NUM_BYTES.HOB = IMAGE_SIZE_.HOB;

   4897  2 000150   200031 236100                    LDQ     IMAGE_SIZE,,AUTO
         2 000151   776000 376003                    ANQ     -1024,DU
         2 000152   000023 772000                    QRL     19
         2 000153   000001 552110                    STBQ    1,'10'O,PR0

      128     4898    1           KP_FECG_OUT$ -> KP$MSG.HEAD.NUM_BYTES.LOB = IMAGE_SIZE_.LOB;

   4898  2 000154   200031 236100                    LDQ     IMAGE_SIZE,,AUTO
         2 000155   001774 376003                    ANQ     1020,DU
         2 000156   000024 772000                    QRL     20
         2 000157   000001 552104                    STBQ    1,'04'O,PR0

      129     4899    1           KP_FECG_OUT_SIZE = SIZEC(KP$MSG.HEAD) + IMAGE_SIZE;

   4899  2 000160   200031 236100                    LDQ     IMAGE_SIZE,,AUTO
         2 000161   000024 772000                    QRL     20
         2 000162   000022 036007                    ADLQ    18,DL
         2 000163   000000 756000 xsym               STQ     KP_FECG_OUT_SIZE

      130     4900    1           CALL KPI$IO_SVC(%KP_FECG_WRITE#) ALTRET(PIGETTE_ERR);

   4900  2 000164   000006 630400 3                  EPPR0   6
         2 000165   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000166   000000 701000 xent               TSX1    KPI$IO_SVC
         2 000167   000644 702000 2                  TSX2    BAD_OPTS

      131     4901    1           CALL KPI$IO_SVC(%KP_FECG_READ#) ALTRET(PIGETTE_ERR);

   4901  2 000170   000002 630400 3                  EPPR0   2
         2 000171   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:24   
         2 000172   000000 701000 xent               TSX1    KPI$IO_SVC
         2 000173   000644 702000 2                  TSX2    BAD_OPTS

      132     4902    1           CALL KPE$CHECK_ERR(%KP_CER2_RSP#) ALTRET(PIGETTE_ERR);

   4902  2 000174   000010 630400 3                  EPPR0   8
         2 000175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000176   000000 701000 xent               TSX1    KPE$CHECK_ERR
         2 000177   000644 702000 2                  TSX2    BAD_OPTS

      133     4903    1           PRINTTHROUGH = KP_FECG_IN$ -> KP$MSG.CER2_RSP.PRINTTHROUGH;

   4903  2 000200   000000 470400 xsym               LDP0    KP_FECG_IN$
         2 000201   000004 236100                    LDQ     4,,PR0
         2 000202   000011 772000                    QRL     9
         2 000203   000777 376007                    ANQ     511,DL
         2 000204   200017 756100                    STQ     PRINTTHROUGH,,AUTO

      134     4904    1           CROSSTALK = KP_FECG_IN$ -> KP$MSG.CER2_RSP.CROSSTALK;

   4904  2 000205   000004 236100                    LDQ     4,,PR0
         2 000206   000777 376007                    ANQ     511,DL
         2 000207   200016 756100                    STQ     CROSSTALK,,AUTO

      135     4905    1           CALL X$WRITE (F_FDS, VECTOR(FMT5),

   4905  2 000210   777640 235007                    LDA     -96,DL
         2 000211   200034 452500                    STP2    HARD+2,,AUTO
         2 000212   200034 236100                    LDQ     HARD+2,,AUTO
         2 000213   000017 036003                    ADLQ    15,DU
         2 000214   200036 757100                    STAQ    HARD+4,,AUTO
         2 000215   777640 235007                    LDA     -96,DL
         2 000216   200040 452500                    STP2    HARD+6,,AUTO
         2 000217   200040 236100                    LDQ     HARD+6,,AUTO
         2 000220   000016 036003                    ADLQ    14,DU
         2 000221   200044 757100                    STAQ    HARD+10,,AUTO
         2 000222   200036 237100                    LDAQ    HARD+4,,AUTO
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:25   
         2 000223   200042 757100                    STAQ    HARD+8,,AUTO
         2 000224   200044 237100                    LDAQ    HARD+10,,AUTO
         2 000225   200046 757100                    STAQ    HARD+12,,AUTO
         2 000226   200046 631500                    EPPR1   HARD+12,,AUTO
         2 000227   200053 451500                    STP1    HARD+17,,AUTO
         2 000230   200042 633500                    EPPR3   HARD+8,,AUTO
         2 000231   200052 453500                    STP3    HARD+16,,AUTO
         2 000232   000014 237000 3                  LDAQ    12
         2 000233   200050 757100                    STAQ    HARD+14,,AUTO
         2 000234   200050 630500                    EPPR0   HARD+14,,AUTO
         2 000235   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000236   000000 701000 xent               TSX1    X$WRITE
         2 000237   000000 011000                    NOP     0

      136     4906    1                         VECTOR(PRINTTHROUGH),
      137     4907    1                         VECTOR(CROSSTALK) );
      138     4908    1           CALL KPI$IO_SVC (%KP_LO_WRITE#);

   4908  2 000240   000016 630400 3                  EPPR0   14
         2 000241   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000242   000000 701000 xent               TSX1    KPI$IO_SVC
         2 000243   000000 011000                    NOP     0

      139     4909        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:26   
      140     4910    1           KP_DISK_ACTIVITY = %KP_DISK_CERTIFYING#;

   4910  2 000244   000005 235007                    LDA     5,DL
         2 000245   000000 755000 xsym               STA     KP_DISK_ACTIVITY

      141     4911        /**/
      142     4912        /*  For each track to be formatted...  */
      143     4913        /**/
      144     4914    2           DO TRACK = IN_OPTS.TRACK_LO TO IN_OPTS.TRACK_HI;

   4914  2 000246   000000 236000 xsym               LDQ     IN_OPTS
         2 000247   200013 756100                    STQ     TRACK,,AUTO
         2 000250   000552 710000 2                  TRA     s:4977+1

      145     4915    3              DO SIDE = IN_OPTS.SIDE_LO TO IN_OPTS.SIDE_HI;

   4915  2 000251   000004 235000 xsym               LDA     IN_OPTS+4
         2 000252   200015 755100                    STA     SIDE,,AUTO
         2 000253   000546 710000 2                  TRA     s:4976+1

      146     4916        /**/
      147     4917        /*  Send message to the FEP.  */
      148     4918        /**/
      149     4919    3                 KP_DISK_ACTIVITY = %KP_DISK_CERTIFYING#;

   4919  2 000254   000005 235007                    LDA     5,DL
         2 000255   000000 755000 xsym               STA     KP_DISK_ACTIVITY

      150     4920    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.MSG_TYPE = %KP_CERTIFY_RQS#;

   4920  2 000256   000000 470400 xsym               LDP0    KP_FECG_OUT$
         2 000257   012000 236003                    LDQ     5120,DU
         2 000260   000000 552140                    STBQ    0,'40'O,PR0

      151     4921    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.DRIVE_NO = DRIVE_NUM;

   4921  2 000261   000000 470400 xsym               LDP0    KP_FECG_OUT$
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:27   
         2 000262   200006 236100                    LDQ     DRIVE_NUM,,AUTO
         2 000263   000022 736000                    QLS     18
         2 000264   000000 552120                    STBQ    0,'20'O,PR0

      152     4922    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.SEC_SIZE = IN_OPTS.SSIZE_CODE;

   4922  2 000265   000000 470400 xsym               LDP0    KP_FECG_OUT$
         2 000266   000011 236000 xsym               LDQ     IN_OPTS+9
         2 000267   000002 552104                    STBQ    2,'04'O,PR0

      153     4923    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.TRACK_NO = TRACK;

   4923  2 000270   200013 236100                    LDQ     TRACK,,AUTO
         2 000271   000022 736000                    QLS     18
         2 000272   000002 552120                    STBQ    2,'20'O,PR0

      154     4924    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.SECTOR_NO = IN_OPTS.SECTOR_LO;

   4924  2 000273   000002 236000 xsym               LDQ     IN_OPTS+2
         2 000274   000011 736000                    QLS     9
         2 000275   000002 552110                    STBQ    2,'10'O,PR0

      155     4925    3                 KP_FECG_OUT$ -> KP$MSG.CRTFY_RQS.SECTOR_HI = IN_OPTS.SECTOR_HI;

   4925  2 000276   000003 236000 xsym               LDQ     IN_OPTS+3
         2 000277   000011 736000                    QLS     9
         2 000300   000004 552110                    STBQ    4,'10'O,PR0

      156     4926    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.SIDE = SIDE;

   4926  2 000301   200015 236100                    LDQ     SIDE,,AUTO
         2 000302   000033 736000                    QLS     27
         2 000303   000002 552140                    STBQ    2,'40'O,PR0

      157     4927    3                 IMAGE_SIZE = SIZEC(KP$MSG.CRTFY_RQS) - SIZEC(KP$MSG.CRTFY_RQS.SPARE);

   4927  2 000304   200031 236100                    LDQ     IMAGE_SIZE,,AUTO
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:28   
         2 000305   000005 376000 3                  ANQ     5
         2 000306   000004 276003                    ORQ     4,DU
         2 000307   200031 756100                    STQ     IMAGE_SIZE,,AUTO

      158     4928    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.NUM_BYTES.HOB = IMAGE_SIZE_.HOB;

   4928  2 000310   200031 236100                    LDQ     IMAGE_SIZE,,AUTO
         2 000311   776000 376003                    ANQ     -1024,DU
         2 000312   000023 772000                    QRL     19
         2 000313   000001 552110                    STBQ    1,'10'O,PR0

      159     4929    3                 KP_FECG_OUT$ -> KP$MSG.HEAD.NUM_BYTES.LOB = IMAGE_SIZE_.LOB;

   4929  2 000314   200031 236100                    LDQ     IMAGE_SIZE,,AUTO
         2 000315   001774 376003                    ANQ     1020,DU
         2 000316   000024 772000                    QRL     20
         2 000317   000001 552104                    STBQ    1,'04'O,PR0

      160     4930    3                 KP_FECG_OUT_SIZE = SIZEC(KP$MSG.HEAD) + IMAGE_SIZE;

   4930  2 000320   200031 236100                    LDQ     IMAGE_SIZE,,AUTO
         2 000321   000024 772000                    QRL     20
         2 000322   000022 036007                    ADLQ    18,DL
         2 000323   000000 756000 xsym               STQ     KP_FECG_OUT_SIZE

      161     4931    3                 CALL KPI$IO_SVC(%KP_FECG_WRITE#) ALTRET(PIGETTE_ERR);

   4931  2 000324   000006 630400 3                  EPPR0   6
         2 000325   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000326   000000 701000 xent               TSX1    KPI$IO_SVC
         2 000327   000644 702000 2                  TSX2    BAD_OPTS

      162     4932        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:29   
      163     4933        /**/
      164     4934        /*  Read response from FEP and check for errors.  */
      165     4935        /**/
      166     4936    3                 CALL KPI$IO_SVC(%KP_FECG_READ#) ALTRET(PIGETTE_ERR);

   4936  2 000330   000002 630400 3                  EPPR0   2
         2 000331   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000332   000000 701000 xent               TSX1    KPI$IO_SVC
         2 000333   000644 702000 2                  TSX2    BAD_OPTS

      167     4937    3                 CALL KPE$CHECK_ERR(%KP_CERTIFY_RSP#)

   4937  2 000334   000017 630400 3                  EPPR0   15
         2 000335   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000336   000000 701000 xent               TSX1    KPE$CHECK_ERR
         2 000337   000342 702000 2                  TSX2    s:4942

      168     4938    4                      WHENRETURN DO;

      169     4939    4                                   HARD='0'B;

   4939  2 000340   200032 450100                    STZ     HARD,,AUTO

      170     4940    4                                   END;

   4940  2 000341   000344 710000 2                  TRA     s:4947

      171     4941    4                      WHENALTRETURN DO;

      172     4942    4                                      HARD='1'B;

   4942  2 000342   400000 236003                    LDQ     -131072,DU
         2 000343   200032 756100                    STQ     HARD,,AUTO

      173     4943    4                                      END;

      174     4944        /**/
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:30   
      175     4945        /*  Make grand totals of all error counts.  */
      176     4946        /**/
      177     4947    3                 RETRIES_V = KP_FECG_IN$ -> KP$MSG.CRTFY_RSP.VINIT_RETRIES;

   4947  2 000344   000000 470400 xsym               LDP0    KP_FECG_IN$
         2 000345   000004 236100                    LDQ     4,,PR0
         2 000346   000011 772000                    QRL     9
         2 000347   000777 376007                    ANQ     511,DL
         2 000350   200020 756100                    STQ     RETRIES_V,,AUTO

      178     4948    3                 RETRIES_W = KP_FECG_IN$ -> KP$MSG.CRTFY_RSP.WRITE_RETRIES;

   4948  2 000351   000004 236100                    LDQ     4,,PR0
         2 000352   000777 376007                    ANQ     511,DL
         2 000353   200021 756100                    STQ     RETRIES_W,,AUTO

      179     4949    3                 RETRIES_R = KP_FECG_IN$ -> KP$MSG.CRTFY_RSP.READ_RETRIES;

   4949  2 000354   000005 236100                    LDQ     5,,PR0
         2 000355   000033 772000                    QRL     27
         2 000356   200022 756100                    STQ     RETRIES_R,,AUTO

      180     4950    3                 RETRIES_D = KP_FECG_IN$ -> KP$MSG.CRTFY_RSP.READ_DATA_ERRORS;

   4950  2 000357   000005 236100                    LDQ     5,,PR0
         2 000360   000022 772000                    QRL     18
         2 000361   000777 376007                    ANQ     511,DL
         2 000362   200023 756100                    STQ     RETRIES_D,,AUTO

      181     4951    3                 TOT_RETRIES_V = TOT_RETRIES_V + RETRIES_V;

   4951  2 000363   200024 236100                    LDQ     TOT_RETRIES_V,,AUTO
         2 000364   200020 036100                    ADLQ    RETRIES_V,,AUTO
         2 000365   200024 756100                    STQ     TOT_RETRIES_V,,AUTO

      182     4952    3                 TOT_RETRIES_W = TOT_RETRIES_W + RETRIES_W;

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:31   
   4952  2 000366   200025 236100                    LDQ     TOT_RETRIES_W,,AUTO
         2 000367   200021 036100                    ADLQ    RETRIES_W,,AUTO
         2 000370   200025 756100                    STQ     TOT_RETRIES_W,,AUTO

      183     4953    3                 TOT_RETRIES_R = TOT_RETRIES_R + RETRIES_R;

   4953  2 000371   200026 236100                    LDQ     TOT_RETRIES_R,,AUTO
         2 000372   200022 036100                    ADLQ    RETRIES_R,,AUTO
         2 000373   200026 756100                    STQ     TOT_RETRIES_R,,AUTO

      184     4954    3                 TOT_RETRIES_D = TOT_RETRIES_D + RETRIES_D;

   4954  2 000374   200027 236100                    LDQ     TOT_RETRIES_D,,AUTO
         2 000375   200023 036100                    ADLQ    RETRIES_D,,AUTO
         2 000376   200027 756100                    STQ     TOT_RETRIES_D,,AUTO

      185     4955    3                 TOT_HARD = TOT_HARD + BITBIN(HARD);

   4955  2 000377   200032 236100                    LDQ     HARD,,AUTO
         2 000400   000043 772000                    QRL     35
         2 000401   200030 036100                    ADLQ    TOT_HARD,,AUTO
         2 000402   200030 756100                    STQ     TOT_HARD,,AUTO

      186     4956        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:32   
      187     4957        /**/
      188     4958        /*  Print appropriate error message.  */
      189     4959        /**/
      190     4960    3                 IF (RETRIES_V+RETRIES_W+RETRIES_R+RETRIES_D+BITBIN(HARD)) = 0 THEN

   4960  2 000403   200020 236100                    LDQ     RETRIES_V,,AUTO
         2 000404   200021 036100                    ADLQ    RETRIES_W,,AUTO
         2 000405   200022 036100                    ADLQ    RETRIES_R,,AUTO
         2 000406   200023 036100                    ADLQ    RETRIES_D,,AUTO
         2 000407   200034 756100                    STQ     HARD+2,,AUTO
         2 000410   200032 236100                    LDQ     HARD,,AUTO
         2 000411   000043 772000                    QRL     35
         2 000412   200034 036100                    ADLQ    HARD+2,,AUTO
         2 000413   000445 601000 2                  TNZ     s:4966

      191     4961    3                    CALL X$WRITE (F_FDS, VECTOR(FMT1),

   4961  2 000414   777640 235007                    LDA     -96,DL
         2 000415   200034 452500                    STP2    HARD+2,,AUTO
         2 000416   200034 236100                    LDQ     HARD+2,,AUTO
         2 000417   000013 036003                    ADLQ    11,DU
         2 000420   200036 757100                    STAQ    HARD+4,,AUTO
         2 000421   777640 235007                    LDA     -96,DL
         2 000422   200040 452500                    STP2    HARD+6,,AUTO
         2 000423   200040 236100                    LDQ     HARD+6,,AUTO
         2 000424   000015 036003                    ADLQ    13,DU
         2 000425   200044 757100                    STAQ    HARD+10,,AUTO
         2 000426   200036 237100                    LDAQ    HARD+4,,AUTO
         2 000427   200042 757100                    STAQ    HARD+8,,AUTO
         2 000430   200044 237100                    LDAQ    HARD+10,,AUTO
         2 000431   200046 757100                    STAQ    HARD+12,,AUTO
         2 000432   200046 631500                    EPPR1   HARD+12,,AUTO
         2 000433   200053 451500                    STP1    HARD+17,,AUTO
         2 000434   200042 633500                    EPPR3   HARD+8,,AUTO
         2 000435   200052 453500                    STP3    HARD+16,,AUTO
         2 000436   000022 237000 3                  LDAQ    18
         2 000437   200050 757100                    STAQ    HARD+14,,AUTO
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:33   
         2 000440   200050 630500                    EPPR0   HARD+14,,AUTO
         2 000441   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000442   000000 701000 xent               TSX1    X$WRITE
         2 000443   000000 011000                    NOP     0
         2 000444   000541 710000 2                  TRA     s:4974

      192     4962    3                                  VECTOR(TRACK),
      193     4963    3                                  VECTOR(SIDE));
      194     4964    3                 ELSE
      195     4965    4                    DO;

      196     4966    4                      CALL X$WRITE (F_FDS, VECTOR(FMT2),

   4966  2 000445   777640 235007                    LDA     -96,DL
         2 000446   200034 452500                    STP2    HARD+2,,AUTO
         2 000447   200034 236100                    LDQ     HARD+2,,AUTO
         2 000450   000013 036003                    ADLQ    11,DU
         2 000451   200036 757100                    STAQ    HARD+4,,AUTO
         2 000452   777640 235007                    LDA     -96,DL
         2 000453   200040 452500                    STP2    HARD+6,,AUTO
         2 000454   200040 236100                    LDQ     HARD+6,,AUTO
         2 000455   000015 036003                    ADLQ    13,DU
         2 000456   200042 757100                    STAQ    HARD+8,,AUTO
         2 000457   777640 235007                    LDA     -96,DL
         2 000460   200044 452500                    STP2    HARD+10,,AUTO
         2 000461   200044 236100                    LDQ     HARD+10,,AUTO
         2 000462   000020 036003                    ADLQ    16,DU
         2 000463   200046 757100                    STAQ    HARD+12,,AUTO
         2 000464   777640 235007                    LDA     -96,DL
         2 000465   200050 452500                    STP2    HARD+14,,AUTO
         2 000466   200050 236100                    LDQ     HARD+14,,AUTO
         2 000467   000021 036003                    ADLQ    17,DU
         2 000470   200052 757100                    STAQ    HARD+16,,AUTO
         2 000471   777640 235007                    LDA     -96,DL
         2 000472   200054 452500                    STP2    HARD+18,,AUTO
         2 000473   200054 236100                    LDQ     HARD+18,,AUTO
         2 000474   000022 036003                    ADLQ    18,DU
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:34   
         2 000475   200056 757100                    STAQ    HARD+20,,AUTO
         2 000476   777640 235007                    LDA     -96,DL
         2 000477   200060 452500                    STP2    HARD+22,,AUTO
         2 000500   200060 236100                    LDQ     HARD+22,,AUTO
         2 000501   000023 036003                    ADLQ    19,DU
         2 000502   200064 757100                    STAQ    HARD+26,,AUTO
         2 000503   200036 237100                    LDAQ    HARD+4,,AUTO
         2 000504   200062 757100                    STAQ    HARD+24,,AUTO
         2 000505   200042 237100                    LDAQ    HARD+8,,AUTO
         2 000506   200066 757100                    STAQ    HARD+28,,AUTO
         2 000507   200046 237100                    LDAQ    HARD+12,,AUTO
         2 000510   200070 757100                    STAQ    HARD+30,,AUTO
         2 000511   200052 237100                    LDAQ    HARD+16,,AUTO
         2 000512   200072 757100                    STAQ    HARD+32,,AUTO
         2 000513   200056 237100                    LDAQ    HARD+20,,AUTO
         2 000514   200074 757100                    STAQ    HARD+34,,AUTO
         2 000515   200064 237100                    LDAQ    HARD+26,,AUTO
         2 000516   200076 757100                    STAQ    HARD+36,,AUTO
         2 000517   200076 631500                    EPPR1   HARD+36,,AUTO
         2 000520   200107 451500                    STP1    HARD+45,,AUTO
         2 000521   200074 633500                    EPPR3   HARD+34,,AUTO
         2 000522   200106 453500                    STP3    HARD+44,,AUTO
         2 000523   200072 634500                    EPPR4   HARD+32,,AUTO
         2 000524   200105 454500                    STP4    HARD+43,,AUTO
         2 000525   200070 635500                    EPPR5   HARD+30,,AUTO
         2 000526   200104 455500                    STP5    HARD+42,,AUTO
         2 000527   200066 636500                    EPPR6   HARD+28,,AUTO
         2 000530   200103 456500                    STP6    HARD+41,,AUTO
         2 000531   200062 637500                    EPPR7   HARD+24,,AUTO
         2 000532   200102 457500                    STP7    HARD+40,,AUTO
         2 000533   000026 237000 3                  LDAQ    22
         2 000534   200100 757100                    STAQ    HARD+38,,AUTO
         2 000535   200100 630500                    EPPR0   HARD+38,,AUTO
         2 000536   000026 631400 xsym               EPPR1   B_VECTNIL+22
         2 000537   000000 701000 xent               TSX1    X$WRITE
         2 000540   000000 011000                    NOP     0

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:35   
      197     4967    4                                    VECTOR(TRACK),
      198     4968    4                                    VECTOR(SIDE),
      199     4969    4                                    VECTOR(RETRIES_V),
      200     4970    4                                    VECTOR(RETRIES_W),
      201     4971    4                                    VECTOR(RETRIES_R),
      202     4972    4                                    VECTOR(RETRIES_D) );
      203     4973    4                      END;

      204     4974    3                 CALL KPI$IO_SVC (%KP_LO_WRITE#);

   4974  2 000541   000016 630400 3                  EPPR0   14
         2 000542   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000543   000000 701000 xent               TSX1    KPI$IO_SVC
         2 000544   000000 011000                    NOP     0

      205     4975        /**/
      206     4976    3                 END;                      /* END DO SIDE                        */

   4976  2 000545   200015 054100                    AOS     SIDE,,AUTO
         2 000546   200015 236100                    LDQ     SIDE,,AUTO
         2 000547   000005 116000 xsym               CMPQ    IN_OPTS+5
         2 000550   000254 604400 2                  TMOZ    s:4919

      207     4977    2              END;                         /* END DO TRACK                       */

   4977  2 000551   200013 054100                    AOS     TRACK,,AUTO
         2 000552   200013 236100                    LDQ     TRACK,,AUTO
         2 000553   000001 116000 xsym               CMPQ    IN_OPTS+1
         2 000554   000251 604400 2                  TMOZ    s:4915

      208     4978        %EJECT;
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:36   
      209     4979        /**/
      210     4980        /*  We're finished, and it all went OK.  */
      211     4981        /**/
      212     4982    1           CALL KPX$CLOSE( FEP_NUM, DRIVE_NUM ) ALTRET(CANT_CLOSE);

   4982  2 000555   200006 630500                    EPPR0   DRIVE_NUM,,AUTO
         2 000556   200035 450500                    STP0    HARD+3,,AUTO
         2 000557   200005 631500                    EPPR1   FEP_NUM,,AUTO
         2 000560   200034 451500                    STP1    HARD+2,,AUTO
         2 000561   200034 630500                    EPPR0   HARD+2,,AUTO
         2 000562   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000563   000000 701000 xent               TSX1    KPX$CLOSE
         2 000564   000644 702000 2                  TSX2    BAD_OPTS

      213     4983        /**/
      214     4984    1           CALL X$WRITE (F_FDS, VECTOR(FMT4),

   4984  2 000565   777640 235007                    LDA     -96,DL
         2 000566   200034 452500                    STP2    HARD+2,,AUTO
         2 000567   200034 236100                    LDQ     HARD+2,,AUTO
         2 000570   000024 036003                    ADLQ    20,DU
         2 000571   200036 757100                    STAQ    HARD+4,,AUTO
         2 000572   777640 235007                    LDA     -96,DL
         2 000573   200040 452500                    STP2    HARD+6,,AUTO
         2 000574   200040 236100                    LDQ     HARD+6,,AUTO
         2 000575   000025 036003                    ADLQ    21,DU
         2 000576   200042 757100                    STAQ    HARD+8,,AUTO
         2 000577   777640 235007                    LDA     -96,DL
         2 000600   200044 452500                    STP2    HARD+10,,AUTO
         2 000601   200044 236100                    LDQ     HARD+10,,AUTO
         2 000602   000026 036003                    ADLQ    22,DU
         2 000603   200046 757100                    STAQ    HARD+12,,AUTO
         2 000604   777640 235007                    LDA     -96,DL
         2 000605   200050 452500                    STP2    HARD+14,,AUTO
         2 000606   200050 236100                    LDQ     HARD+14,,AUTO
         2 000607   000027 036003                    ADLQ    23,DU
         2 000610   200054 757100                    STAQ    HARD+18,,AUTO
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:37   
         2 000611   200036 237100                    LDAQ    HARD+4,,AUTO
         2 000612   200052 757100                    STAQ    HARD+16,,AUTO
         2 000613   200042 237100                    LDAQ    HARD+8,,AUTO
         2 000614   200056 757100                    STAQ    HARD+20,,AUTO
         2 000615   200046 237100                    LDAQ    HARD+12,,AUTO
         2 000616   200060 757100                    STAQ    HARD+22,,AUTO
         2 000617   200054 237100                    LDAQ    HARD+18,,AUTO
         2 000620   200062 757100                    STAQ    HARD+24,,AUTO
         2 000621   200062 630500                    EPPR0   HARD+24,,AUTO
         2 000622   200071 450500                    STP0    HARD+31,,AUTO
         2 000623   200060 631500                    EPPR1   HARD+22,,AUTO
         2 000624   200070 451500                    STP1    HARD+30,,AUTO
         2 000625   200056 633500                    EPPR3   HARD+20,,AUTO
         2 000626   200067 453500                    STP3    HARD+29,,AUTO
         2 000627   200052 634500                    EPPR4   HARD+16,,AUTO
         2 000630   200066 454500                    STP4    HARD+28,,AUTO
         2 000631   000032 237000 3                  LDAQ    26
         2 000632   200064 757100                    STAQ    HARD+26,,AUTO
         2 000633   200064 630500                    EPPR0   HARD+26,,AUTO
         2 000634   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000635   000000 701000 xent               TSX1    X$WRITE
         2 000636   000000 011000                    NOP     0

      215     4985    1                         VECTOR(TOT_RETRIES_V),
      216     4986    1                         VECTOR(TOT_RETRIES_W),
      217     4987    1                         VECTOR(TOT_RETRIES_R),
      218     4988    1                         VECTOR(TOT_RETRIES_D) );
      219     4989    1           CALL KPI$IO_SVC (%KP_LO_WRITE#);

   4989  2 000637   000016 630400 3                  EPPR0   14
         2 000640   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000641   000000 701000 xent               TSX1    KPI$IO_SVC
         2 000642   000000 011000                    NOP     0

      220     4990        /**/
      221     4991    1           RETURN;

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:38   
   4991  2 000643   000000 702200 xent               TSX2  ! X66_ARET

   4991  2 000644                       BAD_OPTS     null
   4991  2 000644                       PIGETTE_ERR  null
   4991  2 000644                       CANT_CLOSE   null
   4991  2 000644                       CANT_OPEN    null
      222     4992        /**/
      223     4993        /* Get here when things become severely fouled */
      224     4994        /**/
      225     4995    1   BAD_OPTS: ;
      226     4996    1   PIGETTE_ERR: ;
      227     4997    1   CANT_CLOSE: ;
      228     4998    1   CANT_OPEN: ;
      229     4999    1           RETURN;

   4999  2 000644   000000 702200 xent               TSX2  ! X66_ARET
      230     5000    1   END KPC$CERTIFY;

PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:39   
--  Include file information  --

   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   KP_MSG.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KP_MACRO_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KP_PERR_C.:E05TOU  is referenced.
   KP_SUBS.:E05TOU  is referenced.
   KP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KPC$CERTIFY.
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:40   

 **** Variables and constants ****

  ****  Section 001 RoData KPC$CERTIFY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(32)    r     1 FMT1                      10-0-0/c CHAR(67)    r     1 FMT2
    31-0-0/c CHAR(55)    r     1 FMT4                      47-0-0/c CHAR(47)    r     1 FMT5

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @OUT$                     16-0-0/w SBIN        r     1 CROSSTALK
     6-0-0/w UBIN        r     1 DRIVE_NUM                  5-0-0/w UBIN        r     1 FEP_NUM
    32-0-0/b BIT         r     1 HARD                      31-0-0/b UBIN(16)    r     1 IMAGE_SIZE
    31-0-0/b STRC(16)    r     1 IMAGE_SIZE_               *0-0-0/w PTR         r     1 OUT$
     7-0-0/w SBIN        r     1 PART                      10-0-0/w PTR         r     1 PART$
    17-0-0/w SBIN        r     1 PRINTTHROUGH              23-0-0/w SBIN        r     1 RETRIES_D
    22-0-0/w SBIN        r     1 RETRIES_R                 20-0-0/w SBIN        r     1 RETRIES_V
    21-0-0/w SBIN        r     1 RETRIES_W                 15-0-0/w SBIN        r     1 SIDE
    30-0-0/w SBIN        r     1 TOT_HARD                  27-0-0/w SBIN        r     1 TOT_RETRIES_D
    26-0-0/w SBIN        r     1 TOT_RETRIES_R             24-0-0/w SBIN        r     1 TOT_RETRIES_V
    25-0-0/w SBIN        r     1 TOT_RETRIES_W             13-0-0/w SBIN        r     1 TRACK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1080)  r     1 F_FDS                      0-0-0/w STRC(468)   r     1 IN_OPTS
     0-0-0/w SBIN        r     1 KP_DISK_ACTIVITY           0-0-0/w PTR         r     1 KP_FECG_IN$
     0-0-0/w PTR         r     1 KP_FECG_OUT$               0-0-0/w UBIN        r     1 KP_FECG_OUT_SIZE

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:41   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(18594) r     1 KP$MSG                     0-0-0/w STRC(144)   r     1 OUT$BLK


   Procedure KPC$CERTIFY requires 421 words for executable code.
   Procedure KPC$CERTIFY requires 72 words of local(AUTO) storage.

    No errors detected in file KPC$CERTIFY.:E05TSI    .
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:42   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:43   
          MINI XREF LISTING

BAD_OPTS
      4991**LABEL    4870--CALLALT
CANT_CLOSE
      4991**LABEL    4982--CALLALT
CANT_OPEN
      4991**LABEL    4853--CALLALT  4872--CALLALT  4875--CALLALT
CROSSTALK
      4817**DCL      4904<<ASSIGN   4905--CALL
DRIVE_NUM
      4809**DCL      4872<>CALL     4875<>CALL     4888>>ASSIGN   4921>>ASSIGN   4982<>CALL
FEP_NUM
      4808**DCL      4872<>CALL     4875<>CALL     4982<>CALL
FMT1
      4837**DCL      4961--CALL
FMT2
      4839**DCL      4966--CALL
FMT4
      4841**DCL      4984--CALL
FMT5
      4843**DCL      4905--CALL
F_FDS
      4224**DCL      4905<>CALL     4961<>CALL     4966<>CALL     4984<>CALL
F_FDS.DVFC#
      4260**DCL      4858<<ASSIGN
HARD
      4832**DCL      4939<<ASSIGN   4942<<ASSIGN   4955>>ASSIGN   4960>>IF
IMAGE_SIZE
      4828**DCL      4829--REDEF    4896<<ASSIGN   4899>>ASSIGN   4927<<ASSIGN   4930>>ASSIGN
IMAGE_SIZE_.HOB
      4830**DCL      4897>>ASSIGN   4928>>ASSIGN
IMAGE_SIZE_.LOB
      4831**DCL      4898>>ASSIGN   4929>>ASSIGN
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:44   
IN_OPTS
      4130**DCL      4854<>CALL     4870<>CALL
IN_OPTS.SECTOR_HI
      4134**DCL      4892>>ASSIGN   4925>>ASSIGN
IN_OPTS.SECTOR_LO
      4133**DCL      4891>>ASSIGN   4924>>ASSIGN
IN_OPTS.SIDE_HI
      4136**DCL      4894>>ASSIGN   4915>>DOINDEX
IN_OPTS.SIDE_LO
      4135**DCL      4895>>ASSIGN   4915>>DOINDEX
IN_OPTS.SSIZE_CODE
      4140**DCL      4889>>ASSIGN   4922>>ASSIGN
IN_OPTS.TRACK_HI
      4132**DCL      4893>>ASSIGN   4914>>DOINDEX
IN_OPTS.TRACK_LO
      4131**DCL      4890>>ASSIGN   4914>>DOINDEX
KP$MSG.CER2_RQS
      4774**DCL      4896--ASSIGN
KP$MSG.CER2_RQS.SECTOR_HI
      4775**DCL      4892<<ASSIGN
KP$MSG.CER2_RQS.SIDE_HI
      4776**DCL      4894<<ASSIGN
KP$MSG.CER2_RQS.SPARE
      4778**DCL      4896--ASSIGN
KP$MSG.CER2_RQS.TRACK_HI
      4777**DCL      4893<<ASSIGN
KP$MSG.CER2_RSP.CROSSTALK
      4781**DCL      4904>>ASSIGN
KP$MSG.CER2_RSP.PRINTTHROUGH
      4780**DCL      4903>>ASSIGN
KP$MSG.CRTFY_RQS
      4789**DCL      4927--ASSIGN
KP$MSG.CRTFY_RQS.SECTOR_HI
      4790**DCL      4925<<ASSIGN
KP$MSG.CRTFY_RQS.SPARE
      4791**DCL      4927--ASSIGN
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:45   
KP$MSG.CRTFY_RSP.READ_DATA_ERRORS
      4796**DCL      4950>>ASSIGN
KP$MSG.CRTFY_RSP.READ_RETRIES
      4795**DCL      4949>>ASSIGN
KP$MSG.CRTFY_RSP.VINIT_RETRIES
      4793**DCL      4947>>ASSIGN
KP$MSG.CRTFY_RSP.WRITE_RETRIES
      4794**DCL      4948>>ASSIGN
KP$MSG.HEAD
      4728**DCL      4899--ASSIGN   4930--ASSIGN
KP$MSG.HEAD.DRIVE_NO
      4730**DCL      4888<<ASSIGN   4921<<ASSIGN
KP$MSG.HEAD.MSG_TYPE
      4729**DCL      4887<<ASSIGN   4920<<ASSIGN
KP$MSG.HEAD.NUM_BYTES.HOB
      4741**DCL      4897<<ASSIGN   4928<<ASSIGN
KP$MSG.HEAD.NUM_BYTES.LOB
      4742**DCL      4898<<ASSIGN   4929<<ASSIGN
KP$MSG.HEAD.SECTOR_NO
      4745**DCL      4891<<ASSIGN   4924<<ASSIGN
KP$MSG.HEAD.SEC_SIZE
      4746**DCL      4889<<ASSIGN   4922<<ASSIGN
KP$MSG.HEAD.SIDE
      4743**DCL      4895<<ASSIGN   4926<<ASSIGN
KP$MSG.HEAD.TRACK_NO
      4744**DCL      4890<<ASSIGN   4923<<ASSIGN
KP$MSG.TDATA
      4753**DCL      4754--REDEF    4755--REDEF    4760--REDEF    4774--REDEF    4779--REDEF    4783--REDEF
      4789--REDEF    4792--REDEF
KPD$DISK_TYPE
      4588**DCL-ENT  4854--CALL
KPE$CHECK_ERR
      4591**DCL-ENT  4902--CALL     4937--CALL
KPI$IO_SVC
      4606**DCL-ENT  4900--CALL     4901--CALL     4908--CALL     4931--CALL     4936--CALL     4974--CALL
      4989--CALL
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:46   
KPT$TERM_MSG
      4618**DCL-ENT  4882--CALL
KPU$FEP_AND_DRIVE
      4624**DCL-ENT  4872--CALL
KPU$OPTIONS
      4631**DCL-ENT  4870--CALL
KPU$SECURITY
      4674**DCL-ENT  4853--CALL
KPX$CLOSE
      4640**DCL-ENT  4982--CALL
KPX$OPEN
      4646**DCL-ENT  4875--CALL
KP_DISK_ACTIVITY
      3979**DCL      4886<<ASSIGN   4910<<ASSIGN   4919<<ASSIGN
KP_EXIT.V.STEPCC#
      4046**DCL      4046--REDEF
KP_FECG_IN$
      3972**DCL      4903>>ASSIGN   4904>>ASSIGN   4947>>ASSIGN   4948>>ASSIGN   4949>>ASSIGN   4950>>ASSIGN
KP_FECG_OUT$
      3972**DCL      4887>>ASSIGN   4888>>ASSIGN   4889>>ASSIGN   4890>>ASSIGN   4891>>ASSIGN   4892>>ASSIGN
      4893>>ASSIGN   4894>>ASSIGN   4895>>ASSIGN   4897>>ASSIGN   4898>>ASSIGN   4920>>ASSIGN   4921>>ASSIGN
      4922>>ASSIGN   4923>>ASSIGN   4924>>ASSIGN   4925>>ASSIGN   4926>>ASSIGN   4928>>ASSIGN   4929>>ASSIGN
KP_FECG_OUT_SIZE
      3972**DCL      4899<<ASSIGN   4930<<ASSIGN
KP_INBUF
      3968**DCL      3968--REDEF
KP_RU_KEY
      3976**DCL      3977--REDEF
KP_RU_KEY.NODE
      3976**DCL      3976--REDEF
KP_RU_KEY.PAGE
      3977**DCL      3977--REDEF
KP_RU_OUTBUF
      3970**DCL      3970--REDEF
OUT$
      4806**DCL        13--PROC     4849--ENTRY    4866>>DOINDEX  4867>>ASSIGN
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:47   
OUT$BLK
      4687**DCL      4872<>CALL
OUT$BLK.CODE
      4695**DCL      4868>>DOCASE
OUT$BLK.NSUBLKS
      4699**DCL      4866>>DOINDEX
OUT$BLK.SUBLK$
      4720**DCL      4867>>ASSIGN
PART
      4810**DCL      4866<<DOINDEX  4867>>ASSIGN
PART$
      4811**DCL      4867<<ASSIGN   4868>>DOCASE   4870<>CALL     4872>>CALL
PIGETTE_ERR
      4991**LABEL    4900--CALLALT  4901--CALLALT  4902--CALLALT  4931--CALLALT  4936--CALLALT
PRINTTHROUGH
      4818**DCL      4903<<ASSIGN   4905--CALL
RETRIES_D
      4822**DCL      4950<<ASSIGN   4954>>ASSIGN   4960>>IF       4966--CALL
RETRIES_R
      4821**DCL      4949<<ASSIGN   4953>>ASSIGN   4960>>IF       4966--CALL
RETRIES_V
      4819**DCL      4947<<ASSIGN   4951>>ASSIGN   4960>>IF       4966--CALL
RETRIES_W
      4820**DCL      4948<<ASSIGN   4952>>ASSIGN   4960>>IF       4966--CALL
SIDE
      4816**DCL      4915<<DOINDEX  4926>>ASSIGN   4961--CALL     4966--CALL
TOT_HARD
      4827**DCL      4955<<ASSIGN   4955>>ASSIGN
TOT_RETRIES_D
      4826**DCL      4862<<ASSIGN   4954<<ASSIGN   4954>>ASSIGN   4984--CALL
TOT_RETRIES_R
      4825**DCL      4861<<ASSIGN   4953<<ASSIGN   4953>>ASSIGN   4984--CALL
TOT_RETRIES_V
      4823**DCL      4859<<ASSIGN   4951<<ASSIGN   4951>>ASSIGN   4984--CALL
TOT_RETRIES_W
      4824**DCL      4860<<ASSIGN   4952<<ASSIGN   4952>>ASSIGN   4984--CALL
PL6.E3A0      #001=KPC$CERTIFY File=KPC$CERTIFY.:E05TSI                          WED 07/30/97 01:17 Page:48   
TRACK
      4814**DCL      4914<<DOINDEX  4923>>ASSIGN   4961--CALL     4966--CALL
X$WRITE
      4566**DCL-ENT  4905--CALL     4961--CALL     4966--CALL     4984--CALL
