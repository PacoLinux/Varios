VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:1    
        1        1        /*M* ASL$LIST_TERMINALS: External routine to list/disp TERMinals.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_TERMINALS: PROC ;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_TERMINALS
       13       13             CALL:     CALL ASL$LIST_ALL_TERMINALS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_TERMINALS is a subroutine to handle
       17       17                           the LIST TERMINAL command for SUPER.
       18       18                           This routine will read the terminal record from
       19       19                           :HLP into data segment 1.  It will read the
       20       20                           TWSN record associated with the terminal record
       21       21                           into data segment 2.
       22       22                           It will also read the individual device records
       23       23                           from :NETCON to pick up the signon string for the
       24       24                           device. The device record will be read into
       25       25                           auto memory.
       26       26                           If necessary, matching will be done on the key
       27       27                           of the terminal record read, and if the record
       28       28                           matches the selection criterion and is a valid
       29       29                           terminal, this routine will do either
       30       30                           of two things.  It will call the display routine
       31       31                           if the command was a DISPLAY command, or it will
       32       32                           put the vector framing the terminal name into the
       33       33                           formatter vector list.
       34       34
       35       35                  MEMORY REQUIREMENTS:
       36       36                           For all of the routines that deal with listing/
       37       37                           displaying stations:
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:2    
       38       38
       39       39                            ASL$LIST_ALL_TERMINALS
       40       40                            ASL$DISP_ONE_TERMINAL
       41       41                            ASB$INIT_GET_TERMINAL
       42       42                            ASB$GET_NEXT_TERMINAL
       43       43
       44       44                           Data segment 1 will be used for reading records
       45       45                           from :HLP.  Terminal records will be left in data
       46       46                           segment 1.  Device records from :NETCON for
       47       47                           devices that belong to the current terminal will
       48       48                           be read one at a time into auto memory.
       49       49                           Data segment 2 will be used for the TWSN999 record
       50       50                           associated with the terminal record in data segment
       51       51                           1.
       52       52        */
       53       53        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:3    
       54       54        /********************************************************************/
       55       55        /*   Include files   include files   include files   include files  */
       56       56        /********************************************************************/
       57       57        %INCLUDE AS_PERR_C;
       58      659        %INCLUDE AS_SUPER_C;
       59     1094        %INCLUDE AS_SUBS_C;
       60     2508        %INCLUDE AS_MAC_C;
       61     2588        %INCLUDE AS_ENTRIES_M;
       62     3638        %INCLUDE OCI_SUBS_C ;
       63     3736        %INCLUDE AS_SSUBS_C;
       64     3828        %INCLUDE B_ERRORS_C;
       65     4955        %INCLUDE CP_6;
       66     5036        %INCLUDE CP_6_SUBS;
       67     5576        %INCLUDE KL_CONFIG_M;
       68     6338        %INCLUDE KL_MACRO_C;
       69     9690        %INCLUDE KL_SUPER_C;
       70    12592        %INCLUDE XU_MACRO_C;
       71    15698        %INCLUDE XU_FORMAT_C;
       72    15860        %INCLUDE AS_SUPER_R;
       73    18876        /********************************************************************/
       74    18877        /*   Equs            equs            equs            equs           */
       75    18878        /********************************************************************/
       76    18879        %EQU TERMINAL = 0;
       77    18880        %EQU TERMINAL_WILD = 1;
       78    18881        %EQU STATION = 2;
       79    18882        %EQU STATION_WILD = 3;
       80    18883        %EQU ALL = 4;
       81    18884        /********************************************************************/
       82    18885        /*   Static data     static data     static data     static data    */
       83    18886        /********************************************************************/
       84    18887    1   DCL KLDREC$                  PTR STATIC;
       85    18888    1   DCL KL$HASPDEV$              PTR STATIC;
       86    18889    1   DCL LINCNFG_BUF   (0:49)     UBIN WORD STATIC INIT(0*0);
       87    18890    1   DCL LINCNFG$                 PTR STATIC INIT(ADDR(LINCNFG_BUF));
       88    18891        %KL$CONFIG_KEY ( NAME = CONFIG_KEY, STCLASS = STATIC);
       89    18938        %KL$LINCNFG    ( NAME = LINCNFG, STCLASS = "BASED(LINCNFG$)");
       90    19096        %KL_SS;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:4    
       91    19131        /********************************************************************/
       92    19132        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       93    19133        /********************************************************************/
       94    19134        %ASA$ERROR ;
       95    19137        %ASB$CHECK_TYPE ;
       96    19140        %ASB$GET_NEXT_STATION ;
       97    19143        %ASB$GET_NEXT_TERMINAL ;
       98    19146        %ASB$INIT_GET_STATION ;
       99    19149        %ASB$INIT_GET_TERMINAL ;
      100    19152        %ASB$READ_HLP ;
      101    19155        %ASB$WILD_MATCH ;
      102    19158        %ASH$ERROR ;
      103    19161        %ASH$INFO ;
      104    19164        %ASH$WARN ;
      105    19167        %ASL$DISP_ONE_TERMINAL;
      106    19170    1   DCL X$PARSE ENTRY(1) ALTRET ;
      107    19171    1   DCL X$FORMAT ENTRY(1) ;
      108    19172        /********************************************************************/
      109    19173        /*   Local based     local based     local based     local based    */
      110    19174        /********************************************************************/
      111    19175    1   DCL 1 TEXT$C BASED ALIGNED,
      112    19176    1          2 CNT                    UBIN(9) UNAL ,
      113    19177    1          2 TEXT                   CHAR(TEXT$C.CNT) UNAL;
      114    19178        %KL_DREC       ( NAME      = KL$TREC,
      115    19179                         STCLASS   = "BASED(KLDREC$)",
      116    19180                         LAST      = ",");
      117    19293        %KL_GJOB       ( NAME      = GJOB,
      118    19294                         STCLASS   = BASED,
      119    19295                         LVL       = 2,
      120    19296                         LAST      = "," );
      121    19320        %KL_HASP       ( NAME      = HASP,
      122    19321                         STCLASS   = BASED,
      123    19322                         LVL       = 2 );
      124    19472        %KL_HASPDEV    ( NAME      = KL$HASPDEV,
      125    19473                         STCLASS   = "BASED(KL$HASPDEV$)");
      126    19707        %KL_TWSNREC    ( NAME      = KL$TWSNREC,
      127    19708                         STCLASS   = "BASED(DSEG2$)");
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:5    
      128    19733        %KL_WSNCVT     ( NAME      = KL$WSNCVT,
      129    19734                         STCLASS   = "BASED(DSEG1$)");
      130    19741        %KL_DREC       ( NAME      = KL$DREC,
      131    19742                         LAST      = ";",
      132    19743                         STCLASS   = "BASED(KLDREC$)") ;
      133    19856        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
      134    19857                     NDTYPE = TYPE, NSUBLKS = NSUBLKS);
      135    19902        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
      136    19940        /********************************************************************/
      137    19941        /*   Auto data       auto data       auto data       auto data      */
      138    19942        /********************************************************************/
      139    19943    1   DCL ARS                      UBIN;
      140    19944    1   DCL DISP                     BIT(1);
      141    19945    1   DCL DISP_TERMINALS           UBIN;
      142    19946    1   DCL I                        SBIN;
      143    19947    1   DCL J                        SBIN;
      144    19948    1   DCL JCL                      BIT(1);
      145    19949    1   DCL K                        SBIN;
      146    19950    1   DCL MATCH_LEN                UBIN;
      147    19951    1   DCL NAME_LEN                 UBIN;
      148    19952    1   DCL NAME                     CHAR(12);
      149    19953    1   DCL OPTION_CODE              UBIN;
      150    19954    1   DCL 1 STATION_NAME,
      151    19955    1          2 COUNT               UBIN BYTE UNAL,
      152    19956    1          2 TEXT                CHAR(8) CALIGNED;
      153    19957    1   DCL 1 TERMINAL,
      154    19958    1          2 COUNT               UBIN BYTE UNAL,
      155    19959    1          2 TEXT                CHAR(8) CALIGNED;
      156    19960    1   DCL 1 TERMINAL_NAME,
      157    19961    1          2 COUNT               UBIN BYTE UNAL,
      158    19962    1          2 TEXT                CHAR(8) CALIGNED;
      159    19963    1   DCL TEMP_DSEG1$              PTR;
      160    19964    1   DCL TERM_CNT                 UBIN BYTE;
      161    19965    1   DCL TERM_EXT                 BIT(1);
      162    19966    1   DCL TERM_LIST     (0:49)     CHAR(8);
      163    19967    1   DCL TNAME                    CHAR(8);
      164    19968    1   DCL TWSN_NUMBER              UBIN;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:6    
      165    19969        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:7    
      166    19970        /********************************************************************/
      167    19971        /*   Constant data   constant data   constant data   constant data  */
      168    19972        /********************************************************************/
      169    19973    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      170    19974    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      171    19975    1   DCL TERMINAL_STR             CHAR(0) CONSTANT INIT('terminal');
      172    19976    1   DCL TERMINALS_STR            CHAR(0) CONSTANT INIT ('terminals');
      173    19977        /********************************************************************/
      174    19978        /*   Procedure       procedure       procedure       procedure      */
      175    19979        /********************************************************************/
      176    19980    1   KLDREC$ = DSEG1$;
      177    19981    1   JCL = %NO#;
      178    19982
      179    19983    1   OPTION_CODE = %ALL;
      180    19984    1   STATION_NAME.COUNT = 1;
      181    19985    1   STATION_NAME.TEXT = '?';
      182    19986    1   TERMINAL_NAME.COUNT = 1;
      183    19987    1   TERMINAL_NAME.TEXT = '?';
      184    19988    1   DISP_TERMINALS = 0;
      185    19989
      186    19990    2   DO I = 0 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      187    19991
      188    19992    2      CODE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      189    19993
      190    19994    3      DO SELECT (CODE);
      191    19995
      192    19996    3         SELECT ( %LIST_ALL_VAL );
      193    19997
      194    19998    3         DISP = %NO#;
      195    19999    3         OPTION_CODE = %ALL ;
      196    20000
      197    20001    3         SELECT ( %DISPLAY_ALL_VAL );
      198    20002
      199    20003    3         DISP = %YES#;
      200    20004    3         OPTION_CODE = %ALL ;
      201    20005    3         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS > 0 THEN
      202    20006    4         DO K = 0 TO P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS - 1;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:8    
      203    20007    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(K)->P$B.CODE = %JCL_VAL THEN
      204    20008    4               JCL = %YES#;
      205    20009    4            END;
      206    20010
      207    20011    3         SELECT ( %DISPLAY_TERM_VAL );
      208    20012
      209    20013    3         DISP = %YES#;
      210    20014
      211    20015    3         SELECT ( %LIST_TERM_VAL );
      212    20016
      213    20017    3         DISP = %NO#;
      214    20018
      215    20019    3         SELECT (%STATION_NAME_WILD_VAL);
      216    20020
      217    20021    3         STATION_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      218    20022    3         STATION_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      219    20023    3         OPTION_CODE = %STATION;
      220    20024    3         CALL INDEX (J, '?', STATION_NAME.TEXT)
      221    20025    4         WHENRETURN DO;
      222    20026    4            OPTION_CODE = %STATION_WILD;
      223    20027    4            END; /*  Whenreturn  */
      224    20028
      225    20029    3         SELECT (%TERMINAL_NAME_WILD_VAL);
      226    20030
      227    20031    3         TERMINAL_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      228    20032    3         TERMINAL_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      229    20033    3         OPTION_CODE = %TERMINAL;
      230    20034    3         CALL INDEX (J, '?', TERMINAL_NAME.TEXT)
      231    20035    4         WHENRETURN DO;
      232    20036    4            OPTION_CODE = %TERMINAL_WILD;
      233    20037    4            END; /*  Whenreturn  */
      234    20038
      235    20039    3         SELECT (%JCL_VAL);
      236    20040
      237    20041    3         JCL = %YES#;
      238    20042
      239    20043    3         END;  /*  Do select on code  */
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:9    
      240    20044
      241    20045    2      END;  /*  Do i  */
      242    20046
      243    20047    1   FDS.NVECS# = 0;
      244    20048    1   FDS.WRAPTAB# = 1;
      245    20049    2   IF JCL THEN DO;
      246    20050    2      CALL CONCAT (FMT_BUF, '%1"/', TERMINALS_STR, '%1/');
      247    20051    2      CALL CONCAT (FMT_BUF, '%1/', TERMINALS_STR, '%1/');
      248    20052    2      FDS.FMT_.BOUND = LENGTHC (TERMINALS_STR) + 6;
      249    20053    2      END;   /*  Jcl  */
      250    20054    2   ELSE DO;
      251    20055    2      CALL CONCAT (FMT_BUF, '%1/', TERMINALS_STR, '%1/');
      252    20056    2      FDS.FMT_.BOUND = LENGTHC (TERMINALS_STR) + 5;
      253    20057    2      END;   /* Not jcl */
      254    20058    1   FDS.TABDFLT# = 10;
      255    20059    1   CALL X$FORMAT (FDS);
      256    20060
      257    20061    1   IF OPTION_CODE = %TERMINAL_WILD THEN
      258    20062    1      IF TERMINAL_NAME.TEXT = '?' THEN
      259    20063    1         OPTION_CODE = %ALL;
      260    20064    2      ELSE DO; END;
      261    20065    1   ELSE IF OPTION_CODE = %STATION_WILD THEN
      262    20066    1         IF STATION_NAME.TEXT = '?' THEN
      263    20067    1            OPTION_CODE = %TERMINAL_WILD;
      264    20068
      265    20069    2   DO SELECT (OPTION_CODE);
      266    20070
      267    20071    2      SELECT (%ALL,  /*  List/display all terminals  */
      268    20072    2           %TERMINAL_WILD);
      269    20073
      270    20074    2      CALL ASB$INIT_GET_TERMINAL (TERMINAL_NAME);
      271    20075    3      DO FOREVER;
      272    20076    3   NEXT_TERM:
      273    20077    3         CALL ASB$GET_NEXT_TERMINAL (TERMINAL) ALTRET (FINISH_UP);
      274    20078    4         IF OPTION_CODE = %TERMINAL_WILD THEN DO;
      275    20079    4            CALL INDEX (NAME_LEN,' ',TERMINAL.TEXT);
      276    20080    4            MATCH_LEN = TERMINAL_NAME.COUNT;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:10   
      277    20081    4            CALL ASB$WILD_MATCH (NAME_LEN,TERMINAL.TEXT,MATCH_LEN,TERMINAL_NAME.TEXT)
      278    20082    4                 ALTRET (NEXT_TERM);
      279    20083    4            END; /*  OPTION_CODE = TERMINAL_WILD  */
      280    20084    4         IF ~ DISP THEN DO;
      281    20085    5            IF DISP_TERMINALS = 0 THEN DO;
      282    20086    5               CALL CONCAT (FMT_BUF, '%\', KL$TREC.TNAME);
      283    20087    5               FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 1;
      284    20088    5               END; /*  DISP_TERMINALS = 0  */
      285    20089    5            ELSE DO;
      286    20090    5               CALL CONCAT (FMT_BUF, '%\%-%10R', KL$TREC.TNAME);
      287    20091    5               FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 7;
      288    20092    5               END; /*  Else  */
      289    20093    4            CALL X$FORMAT (FDS);
      290    20094    4            END; /*  ~disp  */
      291    20095    3         ELSE
      292    20096    3            CALL ASL$DISP_ONE_TERMINAL (JCL);
      293    20097    3         DISP_TERMINALS = DISP_TERMINALS + 1;
      294    20098    3         END; /*  Do forever  */
      295    20099
      296    20100    2      SELECT (%TERMINAL);
      297    20101
      298    20102    2      USERS_KEY.COUNT = 9;
      299    20103    2      CALL CONCAT( USERS_KEY.TXTC, TERMINAL_NAME.TEXT, '*' );
      300    20104    2      ARS = DSEG1SIZE;
      301    20105    2      CALL ASB$READ_HLP( DSEG1$, ARS, 1) ALTRET( READ_ERR );
      302    20106    3      IF KL$TREC.ATYP ~= %KLAT_TRM# THEN DO ;
      303    20107    3         AS_FIELD1.COUNT = TERMINAL_NAME.COUNT;
      304    20108    3         AS_FIELD1.TEXT  = TERMINAL_NAME.TEXT;
      305    20109    4         DO SELECT(KL$TREC.ATYP);
      306    20110    4            SELECT(%KLAT_STA#);
      307    20111    4            AS_FIELD2.COUNT=7;
      308    20112    4            AS_FIELD2.TEXT ='STATION';
      309    20113    4            SELECT(%KLAT_TS#);
      310    20114    4            AS_FIELD2.COUNT=12;
      311    20115    4            AS_FIELD2.TEXT ='TIME SHARING';
      312    20116    4            SELECT(%KLAT_CG#);
      313    20117    4            AS_FIELD2.COUNT=8;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:11   
      314    20118    4            AS_FIELD2.TEXT ='COMGROUP';
      315    20119    4            SELECT(%KLAT_RES#);
      316    20120    4            AS_FIELD2.COUNT=8;
      317    20121    4            AS_FIELD2.TEXT ='RESOURCE';
      318    20122    4            SELECT(%KLAT_LINE#);
      319    20123    4            AS_FIELD2.COUNT=9;
      320    20124    4            AS_FIELD2.TEXT ='LINK LINE';
      321    20125    4            SELECT(%KLAT_NETWORK#);
      322    20126    4            AS_FIELD2.COUNT=18;
      323    20127    4            AS_FIELD2.TEXT ='NETWORK CONNECTION';
      324    20128    4            END; /* SELECT(KL$TREC.ATYP) */
      325    20129    3         AS_FIELD3.COUNT = 8;
      326    20130    3         AS_FIELD3.TEXT = 'TERMINAL';
      327    20131              %SCREAM(ERR#=E$HLP_WRONG_TYPE2, LEVEL=ERROR, MID='L');
      328    20146    3         RETURN;
      329    20147    3         END; /* Wrong type */
      330    20148    2      USERS_KEY.COUNT = 8;
      331    20149    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );
      332    20150    2      ARS = DSEG2SIZE;
      333    20151    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
      334    20152    3      IF ~ DISP THEN DO;
      335    20153    4         IF DISP_TERMINALS = 0 THEN DO;
      336    20154    4            CALL CONCAT (FMT_BUF, '%\', KL$TREC.TNAME);
      337    20155    4            FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 1;
      338    20156    4            END; /*  DISP_TERMINALS = 0  */
      339    20157    4         ELSE DO;
      340    20158    4            CALL CONCAT (FMT_BUF, '%\%-%10R', KL$TREC.TNAME);
      341    20159    4            FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 7;
      342    20160    4            END; /*  Else  */
      343    20161    3         CALL X$FORMAT (FDS);
      344    20162    3         END; /*  ~disp  */
      345    20163    2      ELSE
      346    20164    2         CALL ASL$DISP_ONE_TERMINAL (JCL);
      347    20165    2      DISP_TERMINALS = DISP_TERMINALS + 1;
      348    20166
      349    20167    2      SELECT (%STATION_WILD);
      350    20168
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:12   
      351    20169    2      CALL ASB$INIT_GET_STATION;
      352    20170    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;
      353    20171    3         CALL INDEX (NAME_LEN, ' ', KL$WSNCVT.WSN(TWSN_NUMBER));
      354    20172    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;
      355    20173    3         MATCH_LEN = STATION_NAME.COUNT;
      356    20174    3         CALL ASB$WILD_MATCH (NAME_LEN,KL$WSNCVT.WSN(TWSN_NUMBER),MATCH_LEN,
             20174                  STATION_NAME.TEXT) ALTRET (NEXT_STATION);
      357    20175    4         CALL ASB$GET_NEXT_STATION (TWSN_NUMBER) WHENALTRETURN DO;
      358    20176    4            GOTO FINISH_UP; /*  We are finished  */
      359    20177    4            END; /*  Whenaltreturn  */
      360    20178    3         TERM_CNT = 0;
      361    20179    4         DO J = 0 TO KL$TWSNREC.NDEV - 1;
      362    20180    4            TERM_EXT = %NO# ;
      363    20181    4            IF KL$TWSNREC.DEVS.TDEV(J)
      364    20182    5            THEN DO;
      365    20183    6               DO K = 0 TO TERM_CNT - 1;
      366    20184    6                  IF TERM_LIST(K) = KL$TWSNREC.DEVS.TERM(J)
      367    20185    7                  THEN DO; K = TERM_CNT ;
      368    20186    7                     TERM_EXT = %YES# ;
      369    20187    7                     END;
      370    20188    6                  END;
      371    20189    5               IF NOT TERM_EXT
      372    20190    6               THEN DO;
      373    20191    6                  TERM_LIST(TERM_CNT) = KL$TWSNREC.DEVS.TERM(J);
      374    20192    6                  TERM_CNT = TERM_CNT+1;
      375    20193    6                  CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.TERM(J));
      376    20194    6                  MATCH_LEN = TERMINAL_NAME.COUNT;
      377    20195    6                  CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(J),MATCH_LEN,
             20195                           TERMINAL_NAME.TEXT)
      378    20196    7                  WHENRETURN DO;
      379    20197    7                     CALL CONCAT( USERS_KEY.TXTC, KL$TWSNREC.DEVS.TERM(J), '*');
      380    20198    7                     USERS_KEY.COUNT = 9 ;
      381    20199    7                     KLDREC$ = ADDR(KL$WSNCVT.WSN(KL$WSNCVT.LTWSN+1));
      382    20200    7                     I = (DSEG1SIZE - POFFC(KLDREC$,ADDR(KL$WSNCVT)));
      383    20201    7                     CALL ASB$READ_HLP( KLDREC$, I, 1) ALTRET( NO_TERM );
      384    20202    8                     IF ~ DISP THEN DO;
      385    20203    9                        IF DISP_TERMINALS = 0 THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:13   
      386    20204    9                           CALL CONCAT (FMT_BUF, '%\', KL$TREC.TNAME);
      387    20205    9                           FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 1;
      388    20206    9                           END; /*  DISP_TERMINALS = 0  */
      389    20207    9                        ELSE DO;
      390    20208    9                           CALL CONCAT (FMT_BUF, '%\%-%10R', KL$TREC.TNAME);
      391    20209    9                           FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 7;
      392    20210    9                           END; /*  Else  */
      393    20211    8                        CALL X$FORMAT (FDS);
      394    20212    8                        END; /*  ~disp  */
      395    20213    7                     ELSE
      396    20214    8                     DO;
      397    20215    8                        TEMP_DSEG1$ = DSEG1$;
      398    20216    8                        DSEG1$ = KLDREC$;
      399    20217    8                        CALL ASL$DISP_ONE_TERMINAL (JCL);
      400    20218    8                        DSEG1$ = TEMP_DSEG1$;
      401    20219    8                        END;
      402    20220    7                     DISP_TERMINALS = DISP_TERMINALS + 1;
      403    20221    7                     END; /* Whenreturn from WILD_MATCH */
      404    20222    6                  END; /* Not TERM_EXT */
      405    20223    5               END; /* If KL$TWSNREC.DEVS.TDEV(J)  */
      406    20224    4            END; /*   Of do j */
      407    20225    3   NEXT_STATION:
      408    20226    3         END; /*  Do ltwsn  */
      409    20227    2      GOTO FINISH_UP;
      410    20228
      411    20229    2      SELECT (%STATION);
      412    20230
      413    20231    2      USERS_KEY.COUNT = 15;
      414    20232    2      CALL CONCAT( USERS_KEY.TXTC, STATION_NAME.TEXT, 'STATION' );
      415    20233    2      ARS = DSEG1SIZE;
      416    20234    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( NO_TERM );
      417    20235    2      USERS_KEY.COUNT = 8;
      418    20236    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );
      419    20237    2      ARS = DSEG2SIZE;
      420    20238    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
      421    20239    2      TERM_CNT = 0;
      422    20240    3      DO J = 0 TO KL$TWSNREC.NDEV - 1;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:14   
      423    20241    3         TERM_EXT = %NO# ;
      424    20242    3         IF KL$TWSNREC.DEVS.TDEV(J)
      425    20243    4         THEN DO;
      426    20244    5            DO K = 0 TO TERM_CNT - 1;
      427    20245    5               IF TERM_LIST(K) = KL$TWSNREC.DEVS.TERM(J)
      428    20246    6               THEN DO; K = TERM_CNT ;
      429    20247    6                  TERM_EXT = %YES# ;
      430    20248    6                  END; /*  If TERM_LIST  */
      431    20249    5               END; /*  Do k  */
      432    20250    4            IF NOT TERM_EXT
      433    20251    5            THEN DO;
      434    20252    5               TERM_LIST(TERM_CNT) = KL$TWSNREC.DEVS.TERM(J);
      435    20253    5               TERM_CNT = TERM_CNT+1;
      436    20254    5               CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.TERM(J));
      437    20255    5               MATCH_LEN = TERMINAL_NAME.COUNT;
      438    20256    5               CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(J),MATCH_LEN,
             20256                        TERMINAL_NAME.TEXT)
      439    20257    6               WHENRETURN DO;
      440    20258    6                  CALL CONCAT( USERS_KEY.TXTC, KL$TWSNREC.DEVS.TERM(J), '*');
      441    20259    6                  USERS_KEY.COUNT = 9 ;
      442    20260    6                  I = DSEG1SIZE;
      443    20261    6                  CALL ASB$READ_HLP( KLDREC$, I, 1) ALTRET( NO_TERM );
      444    20262    7                  IF ~ DISP THEN DO;
      445    20263    8                     IF DISP_TERMINALS = 0 THEN DO;
      446    20264    8                        CALL CONCAT (FMT_BUF, '%\', KL$TREC.TNAME);
      447    20265    8                        FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 1;
      448    20266    8                        END; /*  DISP_TERMINALS = 0  */
      449    20267    8                     ELSE DO;
      450    20268    8                        CALL CONCAT (FMT_BUF, '%\%-%10R', KL$TREC.TNAME);
      451    20269    8                        FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 7;
      452    20270    8                        END; /*  Else  */
      453    20271    7                     CALL X$FORMAT (FDS);
      454    20272    7                     END; /*  ~disp  */
      455    20273    6                  ELSE
      456    20274    6                     CALL ASL$DISP_ONE_TERMINAL (JCL);
      457    20275    6                  DISP_TERMINALS = DISP_TERMINALS + 1;
      458    20276    6                  END; /* Whenreturn from WILD_MATCH */
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:15   
      459    20277    5               END; /* Not TERM_EXT */
      460    20278    4            END; /* If KL$TWSNREC.DEVS.TDEV(J)  */
      461    20279    3         END; /*   Of do j */
      462    20280    2      END;   /*  Do case (OPTION_CODE)  */
      463    20281
      464    20282    2   DO NEVER;
      465    20283
      466    20284    2   NO_TERM:
      467    20285    3      IF MERR_CODE.CODE = %E$NOKEY THEN DO;
      468    20286        /*E*  ERROR:  ASL-E$TERMINAL_NOEXIST-C
      469    20287                 MESSAGE: %U1 does not exist.
      470    20288                 MESSAGE1: The specified TERMINAL/STATION does not exist.
      471    20289        */
      472    20290    3         AS_FIELD1.COUNT = STATION_NAME.COUNT;
      473    20291    3         AS_FIELD1.TEXT  = STATION_NAME.TEXT;
      474    20292              %SCREAM( ERR#=E$TERMINAL_NOEXIST, LEVEL=ERROR, MID='L' );
      475    20307    3         END;  /*  No such key error  */
      476    20308    2      ELSE
      477    20309    2   READ_ERR: CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      478    20310    2      END;  /*  Do never  */
      479    20311    1   FINISH_UP:
      480    20312    2   IF NOT DISP THEN DO;
      481    20313    2      FMT_BUF = '%\%/';
      482    20314    2      FDS.FMT_.BOUND = 3;
      483    20315    2      FDS.NVECS# = 0;
      484    20316    2      CALL X$FORMAT (FDS);
      485    20317    2      END; /*  If not disp  */
      486    20318    2   IF NOT JCL THEN DO;
      487    20319    2      FMT_VEC(0) = VECTOR (DISP_TERMINALS);
      488    20320    2      IF DISP_TERMINALS = 1 THEN
      489    20321    3      DO;
      490    20322    3         FMT_VEC(1) = VECTOR (TERMINAL_STR);
      491    20323    3         END; /*  DISP_TERMINALS = 1  */
      492    20324    3      ELSE DO;
      493    20325    3         FMT_VEC(1) = VECTOR (TERMINALS_STR);
      494    20326    3         END; /*  DISP_TERMINALS ~= 1  */
      495    20327    2      IF DISP THEN
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:16   
      496    20328    3      DO;
      497    20329    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      498    20330    3         END; /*  If disp  */
      499    20331    3      ELSE DO;
      500    20332    3         FMT_VEC(2) = VECTOR (LIST_STR);
      501    20333    3         END; /*  If ~ disp  */
      502    20334    2      FDS.NVECS# = 3;
      503    20335    2      FMT_BUF = '   %5D %A %A.';
      504    20336    2      FDS.FMT_.BOUND = 12;
      505    20337    2      CALL X$FORMAT(FDS);
      506    20338    2      END; /* Not jcl */
      507    20339    1   FDS.WRAPTAB# = 4;
      508    20340    1   RETURN;
      509    20341    1   END ASL$LIST_ALL_TERMINALS;

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:17   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_TERMINALS.

   Procedure ASL$LIST_ALL_TERMINALS requires 935 words for executable code.
   Procedure ASL$LIST_ALL_TERMINALS requires 138 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_TERMINALS.:E05TSI    .

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:18   

 Object Unit name= ASL$LIST_ALL_TERMINALS                     File name= ASL$LIST_TERMINALS.:E05TOU
 UTS= JUL 29 '97 10:21:21.56 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    65    101  ASL$LIST_ALL_TERMINALS
    3  RoData even  UTS     42     52  ASL$LIST_ALL_TERMINALS
    4   Proc  even  none   935   1647  ASL$LIST_ALL_TERMINALS
    5  RoData even  none    28     34  ASL$LIST_ALL_TERMINALS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  ASL$LIST_ALL_TERMINALS
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:19   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 X$FORMAT
 yes     yes           Std       1 ASB$INIT_GET_TERMINAL
 yes     yes           Std       3 ASB$READ_HLP
 yes     yes           Std       0 ASB$INIT_GET_STATION
 yes     yes           Std       1 ASB$GET_NEXT_TERMINAL
 yes     yes           Std       4 ASB$WILD_MATCH
         yes           Std       1 ASL$DISP_ONE_TERMINAL
         yes           Std       2 ASH$ERROR
         yes           Std       3 ASA$ERROR
 yes     yes           Std       1 ASB$GET_NEXT_STATION
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             FDS
     FMT_BUF                               FMT_VEC                               NODE$
     CODE                                  ERR_CODE                              AS_FIELD1
     AS_FIELD2                             AS_FIELD3                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             DSEG2$                                DSEG2SIZE
     P_PCB                                 B_VECTNIL
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:20   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:21   


        1        1        /*M* ASL$LIST_TERMINALS: External routine to list/disp TERMinals.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_TERMINALS: PROC ;

      9  4 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         4 000001   000212 000000                    ZERO    138,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_TERMINALS
       13       13             CALL:     CALL ASL$LIST_ALL_TERMINALS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_TERMINALS is a subroutine to handle
       17       17                           the LIST TERMINAL command for SUPER.
       18       18                           This routine will read the terminal record from
       19       19                           :HLP into data segment 1.  It will read the
       20       20                           TWSN record associated with the terminal record
       21       21                           into data segment 2.
       22       22                           It will also read the individual device records
       23       23                           from :NETCON to pick up the signon string for the
       24       24                           device. The device record will be read into
       25       25                           auto memory.
       26       26                           If necessary, matching will be done on the key
       27       27                           of the terminal record read, and if the record
       28       28                           matches the selection criterion and is a valid
       29       29                           terminal, this routine will do either
       30       30                           of two things.  It will call the display routine
       31       31                           if the command was a DISPLAY command, or it will
       32       32                           put the vector framing the terminal name into the
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:22   
       33       33                           formatter vector list.
       34       34
       35       35                  MEMORY REQUIREMENTS:
       36       36                           For all of the routines that deal with listing/
       37       37                           displaying stations:
       38       38
       39       39                            ASL$LIST_ALL_TERMINALS
       40       40                            ASL$DISP_ONE_TERMINAL
       41       41                            ASB$INIT_GET_TERMINAL
       42       42                            ASB$GET_NEXT_TERMINAL
       43       43
       44       44                           Data segment 1 will be used for reading records
       45       45                           from :HLP.  Terminal records will be left in data
       46       46                           segment 1.  Device records from :NETCON for
       47       47                           devices that belong to the current terminal will
       48       48                           be read one at a time into auto memory.
       49       49                           Data segment 2 will be used for the TWSN999 record
       50       50                           associated with the terminal record in data segment
       51       51                           1.
       52       52        */
       53       53        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:23   
       54       54        /********************************************************************/
       55       55        /*   Include files   include files   include files   include files  */
       56       56        /********************************************************************/
       57       57        %INCLUDE AS_PERR_C;
       58      659        %INCLUDE AS_SUPER_C;
       59     1094        %INCLUDE AS_SUBS_C;
       60     2508        %INCLUDE AS_MAC_C;
       61     2588        %INCLUDE AS_ENTRIES_M;
       62     3638        %INCLUDE OCI_SUBS_C ;
       63     3736        %INCLUDE AS_SSUBS_C;
       64     3828        %INCLUDE B_ERRORS_C;
       65     4955        %INCLUDE CP_6;
       66     5036        %INCLUDE CP_6_SUBS;
       67     5576        %INCLUDE KL_CONFIG_M;
       68     6338        %INCLUDE KL_MACRO_C;
       69     9690        %INCLUDE KL_SUPER_C;
       70    12592        %INCLUDE XU_MACRO_C;
       71    15698        %INCLUDE XU_FORMAT_C;
       72    15860        %INCLUDE AS_SUPER_R;
       73    18876        /********************************************************************/
       74    18877        /*   Equs            equs            equs            equs           */
       75    18878        /********************************************************************/
       76    18879        %EQU TERMINAL = 0;
       77    18880        %EQU TERMINAL_WILD = 1;
       78    18881        %EQU STATION = 2;
       79    18882        %EQU STATION_WILD = 3;
       80    18883        %EQU ALL = 4;
       81    18884        /********************************************************************/
       82    18885        /*   Static data     static data     static data     static data    */
       83    18886        /********************************************************************/
       84    18887    1   DCL KLDREC$                  PTR STATIC;
       85    18888    1   DCL KL$HASPDEV$              PTR STATIC;
       86    18889    1   DCL LINCNFG_BUF   (0:49)     UBIN WORD STATIC INIT(0*0);
       87    18890    1   DCL LINCNFG$                 PTR STATIC INIT(ADDR(LINCNFG_BUF));
       88    18891        %KL$CONFIG_KEY ( NAME = CONFIG_KEY, STCLASS = STATIC);
       89    18938        %KL$LINCNFG    ( NAME = LINCNFG, STCLASS = "BASED(LINCNFG$)");
       90    19096        %KL_SS;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:24   
       91    19131        /********************************************************************/
       92    19132        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       93    19133        /********************************************************************/
       94    19134        %ASA$ERROR ;
       95    19137        %ASB$CHECK_TYPE ;
       96    19140        %ASB$GET_NEXT_STATION ;
       97    19143        %ASB$GET_NEXT_TERMINAL ;
       98    19146        %ASB$INIT_GET_STATION ;
       99    19149        %ASB$INIT_GET_TERMINAL ;
      100    19152        %ASB$READ_HLP ;
      101    19155        %ASB$WILD_MATCH ;
      102    19158        %ASH$ERROR ;
      103    19161        %ASH$INFO ;
      104    19164        %ASH$WARN ;
      105    19167        %ASL$DISP_ONE_TERMINAL;
      106    19170    1   DCL X$PARSE ENTRY(1) ALTRET ;
      107    19171    1   DCL X$FORMAT ENTRY(1) ;
      108    19172        /********************************************************************/
      109    19173        /*   Local based     local based     local based     local based    */
      110    19174        /********************************************************************/
      111    19175    1   DCL 1 TEXT$C BASED ALIGNED,
      112    19176    1          2 CNT                    UBIN(9) UNAL ,
      113    19177    1          2 TEXT                   CHAR(TEXT$C.CNT) UNAL;
      114    19178        %KL_DREC       ( NAME      = KL$TREC,
      115    19179                         STCLASS   = "BASED(KLDREC$)",
      116    19180                         LAST      = ",");
      117    19293        %KL_GJOB       ( NAME      = GJOB,
      118    19294                         STCLASS   = BASED,
      119    19295                         LVL       = 2,
      120    19296                         LAST      = "," );
      121    19320        %KL_HASP       ( NAME      = HASP,
      122    19321                         STCLASS   = BASED,
      123    19322                         LVL       = 2 );
      124    19472        %KL_HASPDEV    ( NAME      = KL$HASPDEV,
      125    19473                         STCLASS   = "BASED(KL$HASPDEV$)");
      126    19707        %KL_TWSNREC    ( NAME      = KL$TWSNREC,
      127    19708                         STCLASS   = "BASED(DSEG2$)");
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:25   
      128    19733        %KL_WSNCVT     ( NAME      = KL$WSNCVT,
      129    19734                         STCLASS   = "BASED(DSEG1$)");
      130    19741        %KL_DREC       ( NAME      = KL$DREC,
      131    19742                         LAST      = ";",
      132    19743                         STCLASS   = "BASED(KLDREC$)") ;
      133    19856        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
      134    19857                     NDTYPE = TYPE, NSUBLKS = NSUBLKS);
      135    19902        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
      136    19940        /********************************************************************/
      137    19941        /*   Auto data       auto data       auto data       auto data      */
      138    19942        /********************************************************************/
      139    19943    1   DCL ARS                      UBIN;
      140    19944    1   DCL DISP                     BIT(1);
      141    19945    1   DCL DISP_TERMINALS           UBIN;
      142    19946    1   DCL I                        SBIN;
      143    19947    1   DCL J                        SBIN;
      144    19948    1   DCL JCL                      BIT(1);
      145    19949    1   DCL K                        SBIN;
      146    19950    1   DCL MATCH_LEN                UBIN;
      147    19951    1   DCL NAME_LEN                 UBIN;
      148    19952    1   DCL NAME                     CHAR(12);
      149    19953    1   DCL OPTION_CODE              UBIN;
      150    19954    1   DCL 1 STATION_NAME,
      151    19955    1          2 COUNT               UBIN BYTE UNAL,
      152    19956    1          2 TEXT                CHAR(8) CALIGNED;
      153    19957    1   DCL 1 TERMINAL,
      154    19958    1          2 COUNT               UBIN BYTE UNAL,
      155    19959    1          2 TEXT                CHAR(8) CALIGNED;
      156    19960    1   DCL 1 TERMINAL_NAME,
      157    19961    1          2 COUNT               UBIN BYTE UNAL,
      158    19962    1          2 TEXT                CHAR(8) CALIGNED;
      159    19963    1   DCL TEMP_DSEG1$              PTR;
      160    19964    1   DCL TERM_CNT                 UBIN BYTE;
      161    19965    1   DCL TERM_EXT                 BIT(1);
      162    19966    1   DCL TERM_LIST     (0:49)     CHAR(8);
      163    19967    1   DCL TNAME                    CHAR(8);
      164    19968    1   DCL TWSN_NUMBER              UBIN;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:26   
      165    19969        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:27   
      166    19970        /********************************************************************/
      167    19971        /*   Constant data   constant data   constant data   constant data  */
      168    19972        /********************************************************************/
      169    19973    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      170    19974    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      171    19975    1   DCL TERMINAL_STR             CHAR(0) CONSTANT INIT('terminal');
      172    19976    1   DCL TERMINALS_STR            CHAR(0) CONSTANT INIT ('terminals');
      173    19977        /********************************************************************/
      174    19978        /*   Procedure       procedure       procedure       procedure      */
      175    19979        /********************************************************************/
      176    19980    1   KLDREC$ = DSEG1$;

  19980  4 000002   000000 236000 xsym               LDQ     DSEG1$
         4 000003   000000 756000 2                  STQ     KLDREC$

      177    19981    1   JCL = %NO#;

  19981  4 000004   200010 450100                    STZ     JCL,,AUTO

      178    19982
      179    19983    1   OPTION_CODE = %ALL;

  19983  4 000005   000004 235007                    LDA     4,DL
         4 000006   200017 755100                    STA     OPTION_CODE,,AUTO

      180    19984    1   STATION_NAME.COUNT = 1;

  19984  4 000007   001000 236003                    LDQ     512,DU
         4 000010   200020 552140                    STBQ    STATION_NAME,'40'O,AUTO

      181    19985    1   STATION_NAME.TEXT = '?';

  19985  4 000011   040100 100400                    MLR     fill='040'O
         4 000012   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000013   200020 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8

      182    19986    1   TERMINAL_NAME.COUNT = 1;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:28   

  19986  4 000014   200026 552140                    STBQ    TERMINAL_NAME,'40'O,AUTO

      183    19987    1   TERMINAL_NAME.TEXT = '?';

  19987  4 000015   040100 100400                    MLR     fill='040'O
         4 000016   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000017   200026 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8

      184    19988    1   DISP_TERMINALS = 0;

  19988  4 000020   200005 450100                    STZ     DISP_TERMINALS,,AUTO

      185    19989
      186    19990    2   DO I = 0 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  19990  4 000021   200006 450100                    STZ     I,,AUTO
         4 000022   000173 710000 4                  TRA     s:20045+1

      187    19991
      188    19992    2      CODE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  19992  4 000023   000003 470400 xsym               LDP0    P_PCB+3
         4 000024   200006 720100                    LXL0    I,,AUTO
         4 000025   000003 471510                    LDP1    3,X0,PR0
         4 000026   100000 236100                    LDQ     0,,PR1
         4 000027   777777 376007                    ANQ     -1,DL
         4 000030   000000 756000 xsym               STQ     CODE

      189    19993
      190    19994    3      DO SELECT (CODE);

  19994  4 000031   000137 116007                    CMPQ    95,DL
         4 000032   000045 602000 4                  TNC     s:19994+12
         4 000033   000114 600000 4                  TZE     s:20013
         4 000034   000311 116007                    CMPQ    201,DL
         4 000035   000042 602000 4                  TNC     s:19994+9
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:29   
         4 000036   000121 600000 4                  TZE     s:20021
         4 000037   000351 116007                    CMPQ    233,DL
         4 000040   000172 601000 4                  TNZ     s:20045
         4 000041   000145 710000 4                  TRA     s:20031
         4 000042   000144 116007                    CMPQ    100,DL
         4 000043   000172 601000 4                  TNZ     s:20045
         4 000044   000062 710000 4                  TRA     s:20003
         4 000045   000002 116007                    CMPQ    2,DL
         4 000046   000053 602000 4                  TNC     s:19994+18
         4 000047   000117 600000 4                  TZE     s:20017
         4 000050   000022 116007                    CMPQ    18,DL
         4 000051   000172 601000 4                  TNZ     s:20045
         4 000052   000056 710000 4                  TRA     s:19998
         4 000053   000001 116007                    CMPQ    1,DL
         4 000054   000172 601000 4                  TNZ     s:20045
         4 000055   000170 710000 4                  TRA     s:20041

      191    19995
      192    19996    3         SELECT ( %LIST_ALL_VAL );

      193    19997
      194    19998    3         DISP = %NO#;

  19998  4 000056   200004 450100                    STZ     DISP,,AUTO

      195    19999    3         OPTION_CODE = %ALL ;

  19999  4 000057   000004 235007                    LDA     4,DL
         4 000060   200017 755100                    STA     OPTION_CODE,,AUTO
         4 000061   000172 710000 4                  TRA     s:20045

      196    20000
      197    20001    3         SELECT ( %DISPLAY_ALL_VAL );

      198    20002
      199    20003    3         DISP = %YES#;

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:30   
  20003  4 000062   400000 236003                    LDQ     -131072,DU
         4 000063   200004 756100                    STQ     DISP,,AUTO

      200    20004    3         OPTION_CODE = %ALL ;

  20004  4 000064   000004 235007                    LDA     4,DL
         4 000065   200017 755100                    STA     OPTION_CODE,,AUTO

      201    20005    3         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS > 0 THEN

  20005  4 000066   000003 471510                    LDP1    3,X0,PR0
         4 000067   100001 221100                    LDX1    1,,PR1
         4 000070   000172 600000 4                  TZE     s:20045

      202    20006    4         DO K = 0 TO P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS - 1;

  20006  4 000071   200011 450100                    STZ     K,,AUTO
         4 000072   000106 710000 4                  TRA     s:20009+1

      203    20007    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(K)->P$B.CODE = %JCL_VAL THEN

  20007  4 000073   000003 470400 xsym               LDP0    P_PCB+3
         4 000074   200006 720100                    LXL0    I,,AUTO
         4 000075   000003 471510                    LDP1    3,X0,PR0
         4 000076   200011 721100                    LXL1    K,,AUTO
         4 000077   100003 473511                    LDP3    3,X1,PR1
         4 000100   300000 722100                    LXL2    0,,PR3
         4 000101   000001 102003                    CMPX2   1,DU
         4 000102   000105 601000 4                  TNZ     s:20009

      204    20008    4               JCL = %YES#;

  20008  4 000103   400000 236003                    LDQ     -131072,DU
         4 000104   200010 756100                    STQ     JCL,,AUTO

      205    20009    4            END;

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:31   
  20009  4 000105   200011 054100                    AOS     K,,AUTO
         4 000106   000003 471510                    LDP1    3,X0,PR0
         4 000107   100001 236100                    LDQ     1,,PR1
         4 000110   000022 772000                    QRL     18
         4 000111   200011 116100                    CMPQ    K,,AUTO
         4 000112   000073 605400 4                  TPNZ    s:20007
         4 000113   000172 710000 4                  TRA     s:20045

      206    20010
      207    20011    3         SELECT ( %DISPLAY_TERM_VAL );

      208    20012
      209    20013    3         DISP = %YES#;

  20013  4 000114   400000 236003                    LDQ     -131072,DU
         4 000115   200004 756100                    STQ     DISP,,AUTO
         4 000116   000172 710000 4                  TRA     s:20045

      210    20014
      211    20015    3         SELECT ( %LIST_TERM_VAL );

      212    20016
      213    20017    3         DISP = %NO#;

  20017  4 000117   200004 450100                    STZ     DISP,,AUTO
         4 000120   000172 710000 4                  TRA     s:20045

      214    20018
      215    20019    3         SELECT (%STATION_NAME_WILD_VAL);

      216    20020
      217    20021    3         STATION_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  20021  4 000121   000003 471510                    LDP1    3,X0,PR0
         4 000122   100004 236100                    LDQ     4,,PR1
         4 000123   200020 552140                    STBQ    STATION_NAME,'40'O,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:32   
      218    20022    3         STATION_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  20022  4 000124   000003 471510                    LDP1    3,X0,PR0
         4 000125   100004 236100                    LDQ     4,,PR1
         4 000126   000033 772000                    QRL     27
         4 000127   000000 621006                    EAX1    0,QL
         4 000130   040100 100540                    MLR     fill='040'O
         4 000131   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000132   200020 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8

      219    20023    3         OPTION_CODE = %STATION;

  20023  4 000133   000002 235007                    LDA     2,DL
         4 000134   200017 755100                    STA     OPTION_CODE,,AUTO

      220    20024    3         CALL INDEX (J, '?', STATION_NAME.TEXT)

  20024  4 000135   000000 124500                    SCM     mask='000'O
         4 000136   200020 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 000137   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000140   200007 000100                    ARG     J,,AUTO
         4 000141   000144 606400 4                  TTN     s:20027

      221    20025    4         WHENRETURN DO;

      222    20026    4            OPTION_CODE = %STATION_WILD;

  20026  4 000142   000003 236007                    LDQ     3,DL
         4 000143   200017 756100                    STQ     OPTION_CODE,,AUTO

      223    20027    4            END; /*  Whenreturn  */

  20027  4 000144   000172 710000 4                  TRA     s:20045

      224    20028
      225    20029    3         SELECT (%TERMINAL_NAME_WILD_VAL);

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:33   
      226    20030
      227    20031    3         TERMINAL_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  20031  4 000145   000003 471510                    LDP1    3,X0,PR0
         4 000146   100004 236100                    LDQ     4,,PR1
         4 000147   200026 552140                    STBQ    TERMINAL_NAME,'40'O,AUTO

      228    20032    3         TERMINAL_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  20032  4 000150   000003 471510                    LDP1    3,X0,PR0
         4 000151   100004 236100                    LDQ     4,,PR1
         4 000152   000033 772000                    QRL     27
         4 000153   000000 621006                    EAX1    0,QL
         4 000154   040100 100540                    MLR     fill='040'O
         4 000155   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000156   200026 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8

      229    20033    3         OPTION_CODE = %TERMINAL;

  20033  4 000157   200017 450100                    STZ     OPTION_CODE,,AUTO

      230    20034    3         CALL INDEX (J, '?', TERMINAL_NAME.TEXT)

  20034  4 000160   000000 124500                    SCM     mask='000'O
         4 000161   200026 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 000162   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000163   200007 000100                    ARG     J,,AUTO
         4 000164   000167 606400 4                  TTN     s:20037

      231    20035    4         WHENRETURN DO;

      232    20036    4            OPTION_CODE = %TERMINAL_WILD;

  20036  4 000165   000001 235007                    LDA     1,DL
         4 000166   200017 755100                    STA     OPTION_CODE,,AUTO

      233    20037    4            END; /*  Whenreturn  */
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:34   

  20037  4 000167   000172 710000 4                  TRA     s:20045

      234    20038
      235    20039    3         SELECT (%JCL_VAL);

      236    20040
      237    20041    3         JCL = %YES#;

  20041  4 000170   400000 236003                    LDQ     -131072,DU
         4 000171   200010 756100                    STQ     JCL,,AUTO

      238    20042
      239    20043    3         END;  /*  Do select on code  */

      240    20044
      241    20045    2      END;  /*  Do i  */

  20045  4 000172   200006 054100                    AOS     I,,AUTO
         4 000173   000003 470400 xsym               LDP0    P_PCB+3
         4 000174   000001 236100                    LDQ     1,,PR0
         4 000175   000022 772000                    QRL     18
         4 000176   200006 116100                    CMPQ    I,,AUTO
         4 000177   000023 605400 4                  TPNZ    s:19992

      242    20046
      243    20047    1   FDS.NVECS# = 0;

  20047  4 000200   000011 450000 xsym               STZ     FDS+9

      244    20048    1   FDS.WRAPTAB# = 1;

  20048  4 000201   000001 235007                    LDA     1,DL
         4 000202   000016 755000 xsym               STA     FDS+14

      245    20049    2   IF JCL THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:35   
  20049  4 000203   200010 234100                    SZN     JCL,,AUTO
         4 000204   000234 605000 4                  TPL     s:20055

      246    20050    2      CALL CONCAT (FMT_BUF, '%1"/', TERMINALS_STR, '%1/');

  20050  4 000205   000012 236000 3                  LDQ     TERMINALS_STR+3
         4 000206   000000 756000 xsym               STQ     FMT_BUF
         4 000207   040000 100400                    MLR     fill='040'O
         4 000210   000007 000011 3                  ADSC9   TERMINALS_STR            cn=0,n=9
         4 000211   000001 000011 xsym               ADSC9   FMT_BUF+1                cn=0,n=9
         4 000212   040000 100400                    MLR     fill='040'O
         4 000213   000013 000003 3                  ADSC9   TERMINALS_STR+4          cn=0,n=3
         4 000214   000003 200362 xsym               ADSC9   FMT_BUF+3                cn=1,n=242

      247    20051    2      CALL CONCAT (FMT_BUF, '%1/', TERMINALS_STR, '%1/');

  20051  4 000215   000013 236000 3                  LDQ     TERMINALS_STR+4
         4 000216   000001 376000 5                  ANQ     1
         4 000217   000040 276007                    ORQ     32,DL
         4 000220   000000 756000 xsym               STQ     FMT_BUF
         4 000221   040000 100400                    MLR     fill='040'O
         4 000222   000007 000011 3                  ADSC9   TERMINALS_STR            cn=0,n=9
         4 000223   000000 600011 xsym               ADSC9   FMT_BUF                  cn=3,n=9
         4 000224   040000 100400                    MLR     fill='040'O
         4 000225   000013 000003 3                  ADSC9   TERMINALS_STR+4          cn=0,n=3
         4 000226   000003 000363 xsym               ADSC9   FMT_BUF+3                cn=0,n=243

      248    20052    2      FDS.FMT_.BOUND = LENGTHC (TERMINALS_STR) + 6;

  20052  4 000227   000000 236000 xsym               LDQ     FDS
         4 000230   177777 376007                    ANQ     65535,DL
         4 000231   000002 276000 5                  ORQ     2
         4 000232   000000 756000 xsym               STQ     FDS

      249    20053    2      END;   /*  Jcl  */

  20053  4 000233   000252 710000 4                  TRA     s:20058
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:36   

      250    20054    2   ELSE DO;

      251    20055    2      CALL CONCAT (FMT_BUF, '%1/', TERMINALS_STR, '%1/');

  20055  4 000234   000013 236000 3                  LDQ     TERMINALS_STR+4
         4 000235   000001 376000 5                  ANQ     1
         4 000236   000040 276007                    ORQ     32,DL
         4 000237   000000 756000 xsym               STQ     FMT_BUF
         4 000240   040000 100400                    MLR     fill='040'O
         4 000241   000007 000011 3                  ADSC9   TERMINALS_STR            cn=0,n=9
         4 000242   000000 600011 xsym               ADSC9   FMT_BUF                  cn=3,n=9
         4 000243   040000 100400                    MLR     fill='040'O
         4 000244   000013 000003 3                  ADSC9   TERMINALS_STR+4          cn=0,n=3
         4 000245   000003 000363 xsym               ADSC9   FMT_BUF+3                cn=0,n=243

      252    20056    2      FDS.FMT_.BOUND = LENGTHC (TERMINALS_STR) + 5;

  20056  4 000246   000000 236000 xsym               LDQ     FDS
         4 000247   177777 376007                    ANQ     65535,DL
         4 000250   000003 276000 5                  ORQ     3
         4 000251   000000 756000 xsym               STQ     FDS

      253    20057    2      END;   /* Not jcl */

      254    20058    1   FDS.TABDFLT# = 10;

  20058  4 000252   000012 235007                    LDA     10,DL
         4 000253   000017 755000 xsym               STA     FDS+15

      255    20059    1   CALL X$FORMAT (FDS);

  20059  4 000254   000004 630400 5                  EPPR0   4
         4 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000256   000000 701000 xent               TSX1    X$FORMAT
         4 000257   000000 011000                    NOP     0

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:37   
      256    20060
      257    20061    1   IF OPTION_CODE = %TERMINAL_WILD THEN

  20061  4 000260   200017 235100                    LDA     OPTION_CODE,,AUTO
         4 000261   000001 115007                    CMPA    1,DL
         4 000262   000273 601000 4                  TNZ     s:20065

      258    20062    1      IF TERMINAL_NAME.TEXT = '?' THEN

  20062  4 000263   040000 106500                    CMPC    fill='040'O
         4 000264   200026 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 000265   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000266   000272 601000 4                  TNZ     s:20064

      259    20063    1         OPTION_CODE = %ALL;

  20063  4 000267   000004 236007                    LDQ     4,DL
         4 000270   200017 756100                    STQ     OPTION_CODE,,AUTO
         4 000271   000303 710000 4                  TRA     s:20069

      260    20064    2      ELSE DO; END;

  20064  4 000272   000303 710000 4                  TRA     s:20069

      261    20065    1   ELSE IF OPTION_CODE = %STATION_WILD THEN

  20065  4 000273   000003 115007                    CMPA    3,DL
         4 000274   000303 601000 4                  TNZ     s:20069

      262    20066    1         IF STATION_NAME.TEXT = '?' THEN

  20066  4 000275   040000 106500                    CMPC    fill='040'O
         4 000276   200020 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 000277   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000300   000303 601000 4                  TNZ     s:20069

      263    20067    1            OPTION_CODE = %TERMINAL_WILD;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:38   

  20067  4 000301   000001 236007                    LDQ     1,DL
         4 000302   200017 756100                    STQ     OPTION_CODE,,AUTO

      264    20068
      265    20069    2   DO SELECT (OPTION_CODE);

  20069  4 000303   200017 236100                    LDQ     OPTION_CODE,,AUTO
         4 000304   000001 116007                    CMPQ    1,DL
         4 000305   000320 602000 4                  TNC     s:20069+13
         4 000306   000323 600000 4                  TZE     s:20074
         4 000307   000003 116007                    CMPQ    3,DL
         4 000310   000315 602000 4                  TNC     s:20069+10
         4 000311   000710 600000 4                  TZE     s:20169
         4 000312   000004 116007                    CMPQ    4,DL
         4 000313   001533 601000 4                  TNZ     s:20282
         4 000314   000323 710000 4                  TRA     s:20074
         4 000315   000002 116007                    CMPQ    2,DL
         4 000316   001533 601000 4                  TNZ     s:20282
         4 000317   001242 710000 4                  TRA     s:20231
         4 000320   000000 116003                    CMPQ    0,DU
         4 000321   000444 600000 4                  TZE     s:20102
         4 000322   001533 710000 4                  TRA     s:20282

      266    20070
      267    20071    2      SELECT (%ALL,  /*  List/display all terminals  */

      268    20072    2           %TERMINAL_WILD);
      269    20073
      270    20074    2      CALL ASB$INIT_GET_TERMINAL (TERMINAL_NAME);

  20074  4 000323   200026 630500                    EPPR0   TERMINAL_NAME,,AUTO
         4 000324   200204 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000325   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000326   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000327   000000 701000 xent               TSX1    ASB$INIT_GET_TERMINAL
         4 000330   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:39   

      271    20075    3      DO FOREVER;

      272    20076    3   NEXT_TERM:
      273    20077    3         CALL ASB$GET_NEXT_TERMINAL (TERMINAL) ALTRET (FINISH_UP);

  20077  4 000331   200023 630500       NEXT_TERM    EPPR0   TERMINAL,,AUTO
         4 000332   200204 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000333   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000334   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000335   000000 701000 xent               TSX1    ASB$GET_NEXT_TERMINAL
         4 000336   001556 702000 4                  TSX2    FINISH_UP

      274    20078    4         IF OPTION_CODE = %TERMINAL_WILD THEN DO;

  20078  4 000337   200017 235100                    LDA     OPTION_CODE,,AUTO
         4 000340   000001 115007                    CMPA    1,DL
         4 000341   000371 601000 4                  TNZ     s:20084

      275    20079    4            CALL INDEX (NAME_LEN,' ',TERMINAL.TEXT);

  20079  4 000342   000000 124500                    SCM     mask='000'O
         4 000343   200023 200010                    ADSC9   TERMINAL,,AUTO           cn=1,n=8
         4 000344   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000345   200013 000100                    ARG     NAME_LEN,,AUTO

      276    20080    4            MATCH_LEN = TERMINAL_NAME.COUNT;

  20080  4 000346   200026 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 000347   000033 772000                    QRL     27
         4 000350   200012 756100                    STQ     MATCH_LEN,,AUTO

      277    20081    4            CALL ASB$WILD_MATCH (NAME_LEN,TERMINAL.TEXT,MATCH_LEN,TERMINAL_NAME.TEXT)

  20081  4 000351   200210 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 000352   200210 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 000353   000005 036000 5                  ADLQ    5
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:40   
         4 000354   200207 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 000355   200012 630500                    EPPR0   MATCH_LEN,,AUTO
         4 000356   200206 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 000357   200211 452500                    STP2    TWSN_NUMBER+7,,AUTO
         4 000360   200211 236100                    LDQ     TWSN_NUMBER+7,,AUTO
         4 000361   000006 036000 5                  ADLQ    6
         4 000362   200205 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 000363   200013 631500                    EPPR1   NAME_LEN,,AUTO
         4 000364   200204 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 000365   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000366   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000367   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 000370   000331 702000 4                  TSX2    NEXT_TERM

      278    20082    4                 ALTRET (NEXT_TERM);
      279    20083    4            END; /*  OPTION_CODE = TERMINAL_WILD  */

      280    20084    4         IF ~ DISP THEN DO;

  20084  4 000371   200004 236100                    LDQ     DISP,,AUTO
         4 000372   400000 376003                    ANQ     -131072,DU
         4 000373   400000 676003                    ERQ     -131072,DU
         4 000374   000432 600000 4                  TZE     s:20096

      281    20085    5            IF DISP_TERMINALS = 0 THEN DO;

  20085  4 000375   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 000376   000412 601000 4                  TNZ     s:20090

      282    20086    5               CALL CONCAT (FMT_BUF, '%\', KL$TREC.TNAME);

  20086  4 000377   000014 220000 3                  LDX0    TERMINALS_STR+5
         4 000400   000000 740000 xsym               STX0    FMT_BUF
         4 000401   000000 470400 2                  LDP0    KLDREC$
         4 000402   040000 100500                    MLR     fill='040'O
         4 000403   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 000404   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:41   

      283    20087    5               FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 1;

  20087  4 000405   000000 236000 xsym               LDQ     FDS
         4 000406   177777 376007                    ANQ     65535,DL
         4 000407   000007 276000 5                  ORQ     7
         4 000410   000000 756000 xsym               STQ     FDS

      284    20088    5               END; /*  DISP_TERMINALS = 0  */

  20088  4 000411   000425 710000 4                  TRA     s:20093

      285    20089    5            ELSE DO;

      286    20090    5               CALL CONCAT (FMT_BUF, '%\%-%10R', KL$TREC.TNAME);

  20090  4 000412   040000 100400                    MLR     fill='040'O
         4 000413   000015 000010 3                  ADSC9   TERMINALS_STR+6          cn=0,n=8
         4 000414   000000 000010 xsym               ADSC9   FMT_BUF                  cn=0,n=8
         4 000415   000000 470400 2                  LDP0    KLDREC$
         4 000416   040000 100500                    MLR     fill='040'O
         4 000417   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 000420   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      287    20091    5               FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 7;

  20091  4 000421   000000 236000 xsym               LDQ     FDS
         4 000422   177777 376007                    ANQ     65535,DL
         4 000423   000002 276000 5                  ORQ     2
         4 000424   000000 756000 xsym               STQ     FDS

      288    20092    5               END; /*  Else  */

      289    20093    4            CALL X$FORMAT (FDS);

  20093  4 000425   000004 630400 5                  EPPR0   4
         4 000426   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:42   
         4 000427   000000 701000 xent               TSX1    X$FORMAT
         4 000430   000000 011000                    NOP     0

      290    20094    4            END; /*  ~disp  */

  20094  4 000431   000440 710000 4                  TRA     s:20097

      291    20095    3         ELSE
      292    20096    3            CALL ASL$DISP_ONE_TERMINAL (JCL);

  20096  4 000432   200010 630500                    EPPR0   JCL,,AUTO
         4 000433   200204 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000434   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000435   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000436   000000 701000 xent               TSX1    ASL$DISP_ONE_TERMINAL
         4 000437   000000 011000                    NOP     0

      293    20097    3         DISP_TERMINALS = DISP_TERMINALS + 1;

  20097  4 000440   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 000441   000001 035007                    ADLA    1,DL
         4 000442   200005 755100                    STA     DISP_TERMINALS,,AUTO

      294    20098    3         END; /*  Do forever  */

  20098  4 000443   000331 710000 4                  TRA     NEXT_TERM

      295    20099
      296    20100    2      SELECT (%TERMINAL);

      297    20101
      298    20102    2      USERS_KEY.COUNT = 9;

  20102  4 000444   011000 236003                    LDQ     4608,DU
         4 000445   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      299    20103    2      CALL CONCAT( USERS_KEY.TXTC, TERMINAL_NAME.TEXT, '*' );
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:43   

  20103  4 000446   040000 100500                    MLR     fill='040'O
         4 000447   200026 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 000450   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000451   040000 100400                    MLR     fill='040'O
         4 000452   000010 000001 5                  ADSC9   8                        cn=0,n=1
         4 000453   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      300    20104    2      ARS = DSEG1SIZE;

  20104  4 000454   000000 235000 xsym               LDA     DSEG1SIZE
         4 000455   200003 755100                    STA     ARS,,AUTO

      301    20105    2      CALL ASB$READ_HLP( DSEG1$, ARS, 1) ALTRET( READ_ERR );

  20105  4 000456   000011 236000 5                  LDQ     9
         4 000457   200206 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 000460   200003 630500                    EPPR0   ARS,,AUTO
         4 000461   200205 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 000462   000012 236000 5                  LDQ     10
         4 000463   200204 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000464   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000465   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000466   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000467   001552 702000 4                  TSX2    READ_ERR

      302    20106    3      IF KL$TREC.ATYP ~= %KLAT_TRM# THEN DO ;

  20106  4 000470   000000 470400 2                  LDP0    KLDREC$
         4 000471   000000 236100                    LDQ     0,,PR0
         4 000472   777000 376003                    ANQ     -512,DU
         4 000473   004000 116003                    CMPQ    2048,DU
         4 000474   000610 600000 4                  TZE     s:20148

      303    20107    3         AS_FIELD1.COUNT = TERMINAL_NAME.COUNT;

  20107  4 000475   200026 236100                    LDQ     TERMINAL_NAME,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:44   
         4 000476   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      304    20108    3         AS_FIELD1.TEXT  = TERMINAL_NAME.TEXT;

  20108  4 000477   040000 100500                    MLR     fill='040'O
         4 000500   200026 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 000501   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      305    20109    4         DO SELECT(KL$TREC.ATYP);

  20109  4 000502   000000 236100                    LDQ     0,,PR0
         4 000503   000033 772000                    QRL     27
         4 000504   000003 116007                    CMPQ    3,DL
         4 000505   000516 602000 4                  TNC     s:20109+12
         4 000506   000555 600000 4                  TZE     s:20120
         4 000507   000005 116007                    CMPQ    5,DL
         4 000510   000576 602000 4                  TNC     s:20129
         4 000511   000563 600000 4                  TZE     s:20123
         4 000512   000033 736000                    QLS     27
         4 000513   007000 116003                    CMPQ    3584,DU
         4 000514   000576 601000 4                  TNZ     s:20129
         4 000515   000571 710000 4                  TRA     s:20126
         4 000516   000000 236100                    LDQ     0,,PR0
         4 000517   000033 772000                    QRL     27
         4 000520   000001 116007                    CMPQ    1,DL
         4 000521   000527 602000 4                  TNC     s:20109+21
         4 000522   000541 600000 4                  TZE     s:20114
         4 000523   000033 736000                    QLS     27
         4 000524   002000 116003                    CMPQ    1024,DU
         4 000525   000576 601000 4                  TNZ     s:20129
         4 000526   000547 710000 4                  TRA     s:20117
         4 000527   000000 236100                    LDQ     0,,PR0
         4 000530   777000 316003                    CANQ    -512,DU
         4 000531   000533 600000 4                  TZE     s:20111
         4 000532   000576 710000 4                  TRA     s:20129

      306    20110    4            SELECT(%KLAT_STA#);
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:45   

      307    20111    4            AS_FIELD2.COUNT=7;

  20111  4 000533   007000 236003                    LDQ     3584,DU
         4 000534   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      308    20112    4            AS_FIELD2.TEXT ='STATION';

  20112  4 000535   040000 100400                    MLR     fill='040'O
         4 000536   000017 000007 3                  ADSC9   TERMINALS_STR+8          cn=0,n=7
         4 000537   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         4 000540   000576 710000 4                  TRA     s:20129

      309    20113    4            SELECT(%KLAT_TS#);

      310    20114    4            AS_FIELD2.COUNT=12;

  20114  4 000541   014000 236003                    LDQ     6144,DU
         4 000542   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      311    20115    4            AS_FIELD2.TEXT ='TIME SHARING';

  20115  4 000543   040000 100400                    MLR     fill='040'O
         4 000544   000021 000014 3                  ADSC9   TERMINALS_STR+10         cn=0,n=12
         4 000545   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         4 000546   000576 710000 4                  TRA     s:20129

      312    20116    4            SELECT(%KLAT_CG#);

      313    20117    4            AS_FIELD2.COUNT=8;

  20117  4 000547   010000 236003                    LDQ     4096,DU
         4 000550   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      314    20118    4            AS_FIELD2.TEXT ='COMGROUP';

  20118  4 000551   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:46   
         4 000552   000024 000010 3                  ADSC9   TERMINALS_STR+13         cn=0,n=8
         4 000553   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         4 000554   000576 710000 4                  TRA     s:20129

      315    20119    4            SELECT(%KLAT_RES#);

      316    20120    4            AS_FIELD2.COUNT=8;

  20120  4 000555   010000 236003                    LDQ     4096,DU
         4 000556   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      317    20121    4            AS_FIELD2.TEXT ='RESOURCE';

  20121  4 000557   040000 100400                    MLR     fill='040'O
         4 000560   000026 000010 3                  ADSC9   TERMINALS_STR+15         cn=0,n=8
         4 000561   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         4 000562   000576 710000 4                  TRA     s:20129

      318    20122    4            SELECT(%KLAT_LINE#);

      319    20123    4            AS_FIELD2.COUNT=9;

  20123  4 000563   011000 236003                    LDQ     4608,DU
         4 000564   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      320    20124    4            AS_FIELD2.TEXT ='LINK LINE';

  20124  4 000565   040000 100400                    MLR     fill='040'O
         4 000566   000030 000011 3                  ADSC9   TERMINALS_STR+17         cn=0,n=9
         4 000567   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         4 000570   000576 710000 4                  TRA     s:20129

      321    20125    4            SELECT(%KLAT_NETWORK#);

      322    20126    4            AS_FIELD2.COUNT=18;

  20126  4 000571   022000 236003                    LDQ     9216,DU
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:47   
         4 000572   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      323    20127    4            AS_FIELD2.TEXT ='NETWORK CONNECTION';

  20127  4 000573   040000 100400                    MLR     fill='040'O
         4 000574   000033 000022 3                  ADSC9   TERMINALS_STR+20         cn=0,n=18
         4 000575   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      324    20128    4            END; /* SELECT(KL$TREC.ATYP) */

      325    20129    3         AS_FIELD3.COUNT = 8;

  20129  4 000576   010000 236003                    LDQ     4096,DU
         4 000577   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

      326    20130    3         AS_FIELD3.TEXT = 'TERMINAL';

  20130  4 000600   040000 100400                    MLR     fill='040'O
         4 000601   000040 000010 3                  ADSC9   TERMINALS_STR+25         cn=0,n=8
         4 000602   000000 200050 xsym               ADSC9   AS_FIELD3                cn=1,n=40

      327    20131              %SCREAM(ERR#=E$HLP_WRONG_TYPE2, LEVEL=ERROR, MID='L');

  20143  4 000603   000013 630400 5                  EPPR0   11
         4 000604   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000605   000000 701000 xent               TSX1    ASH$ERROR
         4 000606   000000 011000                    NOP     0

      328    20146    3         RETURN;

  20146  4 000607   000000 702200 xent               TSX2  ! X66_ARET

      329    20147    3         END; /* Wrong type */
      330    20148    2      USERS_KEY.COUNT = 8;

  20148  4 000610   010000 236003                    LDQ     4096,DU
         4 000611   000000 552040 xsym               STBQ    USERS_KEY,'40'O
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:48   

      331    20149    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );

  20149  4 000612   040000 100400                    MLR     fill='040'O
         4 000613   000043 000004 3                  ADSC9   TERMINALS_STR+28         cn=0,n=4
         4 000614   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 000615   000000 471400 xsym               LDP1    DSEG1$
         4 000616   040000 100500                    MLR     fill='040'O
         4 000617   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4
         4 000620   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      332    20150    2      ARS = DSEG2SIZE;

  20150  4 000621   000000 235000 xsym               LDA     DSEG2SIZE
         4 000622   200003 755100                    STA     ARS,,AUTO

      333    20151    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );

  20151  4 000623   000014 236000 5                  LDQ     12
         4 000624   200206 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 000625   200003 630500                    EPPR0   ARS,,AUTO
         4 000626   200205 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 000627   000015 236000 5                  LDQ     13
         4 000630   200204 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000631   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000632   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000633   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000634   001552 702000 4                  TSX2    READ_ERR

      334    20152    3      IF ~ DISP THEN DO;

  20152  4 000635   200004 236100                    LDQ     DISP,,AUTO
         4 000636   400000 376003                    ANQ     -131072,DU
         4 000637   400000 676003                    ERQ     -131072,DU
         4 000640   000676 600000 4                  TZE     s:20164

      335    20153    4         IF DISP_TERMINALS = 0 THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:49   

  20153  4 000641   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 000642   000656 601000 4                  TNZ     s:20158

      336    20154    4            CALL CONCAT (FMT_BUF, '%\', KL$TREC.TNAME);

  20154  4 000643   000014 220000 3                  LDX0    TERMINALS_STR+5
         4 000644   000000 740000 xsym               STX0    FMT_BUF
         4 000645   000000 470400 2                  LDP0    KLDREC$
         4 000646   040000 100500                    MLR     fill='040'O
         4 000647   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 000650   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      337    20155    4            FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 1;

  20155  4 000651   000000 236000 xsym               LDQ     FDS
         4 000652   177777 376007                    ANQ     65535,DL
         4 000653   000007 276000 5                  ORQ     7
         4 000654   000000 756000 xsym               STQ     FDS

      338    20156    4            END; /*  DISP_TERMINALS = 0  */

  20156  4 000655   000671 710000 4                  TRA     s:20161

      339    20157    4         ELSE DO;

      340    20158    4            CALL CONCAT (FMT_BUF, '%\%-%10R', KL$TREC.TNAME);

  20158  4 000656   040000 100400                    MLR     fill='040'O
         4 000657   000015 000010 3                  ADSC9   TERMINALS_STR+6          cn=0,n=8
         4 000660   000000 000010 xsym               ADSC9   FMT_BUF                  cn=0,n=8
         4 000661   000000 470400 2                  LDP0    KLDREC$
         4 000662   040000 100500                    MLR     fill='040'O
         4 000663   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 000664   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      341    20159    4            FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 7;
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:50   

  20159  4 000665   000000 236000 xsym               LDQ     FDS
         4 000666   177777 376007                    ANQ     65535,DL
         4 000667   000002 276000 5                  ORQ     2
         4 000670   000000 756000 xsym               STQ     FDS

      342    20160    4            END; /*  Else  */

      343    20161    3         CALL X$FORMAT (FDS);

  20161  4 000671   000004 630400 5                  EPPR0   4
         4 000672   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000673   000000 701000 xent               TSX1    X$FORMAT
         4 000674   000000 011000                    NOP     0

      344    20162    3         END; /*  ~disp  */

  20162  4 000675   000704 710000 4                  TRA     s:20165

      345    20163    2      ELSE
      346    20164    2         CALL ASL$DISP_ONE_TERMINAL (JCL);

  20164  4 000676   200010 630500                    EPPR0   JCL,,AUTO
         4 000677   200204 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000700   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000702   000000 701000 xent               TSX1    ASL$DISP_ONE_TERMINAL
         4 000703   000000 011000                    NOP     0

      347    20165    2      DISP_TERMINALS = DISP_TERMINALS + 1;

  20165  4 000704   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 000705   000001 035007                    ADLA    1,DL
         4 000706   200005 755100                    STA     DISP_TERMINALS,,AUTO
         4 000707   001533 710000 4                  TRA     s:20282

      348    20166
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:51   
      349    20167    2      SELECT (%STATION_WILD);

      350    20168
      351    20169    2      CALL ASB$INIT_GET_STATION;

  20169  4 000710   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000711   000000 701000 xent               TSX1    ASB$INIT_GET_STATION
         4 000712   000000 011000                    NOP     0

      352    20170    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;

  20170  4 000713   200202 450100                    STZ     TWSN_NUMBER,,AUTO
         4 000714   001235 710000 4                  TRA     NEXT_STATION+3

      353    20171    3         CALL INDEX (NAME_LEN, ' ', KL$WSNCVT.WSN(TWSN_NUMBER));

  20171  4 000715   200202 235100                    LDA     TWSN_NUMBER,,AUTO
         4 000716   000003 735000                    ALS     3
         4 000717   000000 470400 xsym               LDP0    DSEG1$
         4 000720   000000 124505                    SCM     mask='000'O
         4 000721   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         4 000722   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000723   200013 000100                    ARG     NAME_LEN,,AUTO

      354    20172    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;

  20172  4 000724   200013 236100                    LDQ     NAME_LEN,,AUTO
         4 000725   000730 601000 4                  TNZ     s:20173

  20172  4 000726   000001 235007                    LDA     1,DL
         4 000727   200013 755100                    STA     NAME_LEN,,AUTO

      355    20173    3         MATCH_LEN = STATION_NAME.COUNT;

  20173  4 000730   200020 236100                    LDQ     STATION_NAME,,AUTO
         4 000731   000033 772000                    QRL     27
         4 000732   200012 756100                    STQ     MATCH_LEN,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:52   

      356    20174    3         CALL ASB$WILD_MATCH (NAME_LEN,KL$WSNCVT.WSN(TWSN_NUMBER),MATCH_LEN,
             20174                  STATION_NAME.TEXT) ALTRET (NEXT_STATION);

  20174  4 000733   200210 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 000734   200210 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 000735   000016 036000 5                  ADLQ    14
         4 000736   200207 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 000737   200012 631500                    EPPR1   MATCH_LEN,,AUTO
         4 000740   200206 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 000741   200202 236100                    LDQ     TWSN_NUMBER,,AUTO
         4 000742   000023 736000                    QLS     19
         4 000743   000002 036003                    ADLQ    2,DU
         4 000744   000000 036000 xsym               ADLQ    DSEG1$
         4 000745   200205 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 000746   200013 633500                    EPPR3   NAME_LEN,,AUTO
         4 000747   200204 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 000750   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000751   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000752   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 000753   001232 702000 4                  TSX2    NEXT_STATION

      357    20175    4         CALL ASB$GET_NEXT_STATION (TWSN_NUMBER) WHENALTRETURN DO;

  20175  4 000754   200202 630500                    EPPR0   TWSN_NUMBER,,AUTO
         4 000755   200204 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000756   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000757   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000760   000000 701000 xent               TSX1    ASB$GET_NEXT_STATION
         4 000761   000763 702000 4                  TSX2    s:20176
         4 000762   000764 710000 4                  TRA     s:20178

      358    20176    4            GOTO FINISH_UP; /*  We are finished  */

  20176  4 000763   001556 710000 4                  TRA     FINISH_UP

      359    20177    4            END; /*  Whenaltreturn  */
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:53   
      360    20178    3         TERM_CNT = 0;

  20178  4 000764   200032 450100                    STZ     TERM_CNT,,AUTO

      361    20179    4         DO J = 0 TO KL$TWSNREC.NDEV - 1;

  20179  4 000765   200007 450100                    STZ     J,,AUTO
         4 000766   001225 710000 4                  TRA     s:20224+1

      362    20180    4            TERM_EXT = %NO# ;

  20180  4 000767   200033 450100                    STZ     TERM_EXT,,AUTO

      363    20181    4            IF KL$TWSNREC.DEVS.TDEV(J)

  20181  4 000770   200007 236100                    LDQ     J,,AUTO
         4 000771   000013 402007                    MPY     11,DL
         4 000772   000000 470400 xsym               LDP0    DSEG2$
         4 000773   000006 236106                    LDQ     6,QL,PR0
         4 000774   000100 316007                    CANQ    64,DL
         4 000775   001224 600000 4                  TZE     s:20224

      364    20182    5            THEN DO;

      365    20183    6               DO K = 0 TO TERM_CNT - 1;

  20183  4 000776   200011 450100                    STZ     K,,AUTO
         4 000777   001021 710000 4                  TRA     s:20188+1

      366    20184    6                  IF TERM_LIST(K) = KL$TWSNREC.DEVS.TERM(J)

  20184  4 001000   200011 235100                    LDA     K,,AUTO
         4 001001   000003 735000                    ALS     3
         4 001002   200007 236100                    LDQ     J,,AUTO
         4 001003   200204 755100                    STA     TWSN_NUMBER+2,,AUTO
         4 001004   000054 402007                    MPY     44,DL
         4 001005   200204 235100                    LDA     TWSN_NUMBER+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:54   
         4 001006   000000 470400 xsym               LDP0    DSEG2$
         4 001007   040106 106505                    CMPC    fill='040'O
         4 001010   200034 000010                    ADSC9   TERM_LIST,A,AUTO         cn=0,n=8
         4 001011   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001012   001020 601000 4                  TNZ     s:20188

      367    20185    7                  THEN DO; K = TERM_CNT ;

  20185  4 001013   200032 236100                    LDQ     TERM_CNT,,AUTO
         4 001014   000033 772000                    QRL     27
         4 001015   200011 756100                    STQ     K,,AUTO

      368    20186    7                     TERM_EXT = %YES# ;

  20186  4 001016   400000 236003                    LDQ     -131072,DU
         4 001017   200033 756100                    STQ     TERM_EXT,,AUTO

      369    20187    7                     END;

      370    20188    6                  END;

  20188  4 001020   200011 054100                    AOS     K,,AUTO
         4 001021   200032 236100                    LDQ     TERM_CNT,,AUTO
         4 001022   000033 772000                    QRL     27
         4 001023   200011 116100                    CMPQ    K,,AUTO
         4 001024   001000 605400 4                  TPNZ    s:20184

      371    20189    5               IF NOT TERM_EXT

  20189  4 001025   200033 234100                    SZN     TERM_EXT,,AUTO
         4 001026   001224 604000 4                  TMI     s:20224

      372    20190    6               THEN DO;

      373    20191    6                  TERM_LIST(TERM_CNT) = KL$TWSNREC.DEVS.TERM(J);

  20191  4 001027   000001 736000                    QLS     1
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:55   
         4 001030   000000 620006                    EAX0    0,QL
         4 001031   200007 236100                    LDQ     J,,AUTO
         4 001032   000054 402007                    MPY     44,DL
         4 001033   000000 635010                    EAA     0,X0
         4 001034   000020 771000                    ARL     16
         4 001035   040105 100506                    MLR     fill='040'O
         4 001036   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001037   200034 000010                    ADSC9   TERM_LIST,A,AUTO         cn=0,n=8

      374    20192    6                  TERM_CNT = TERM_CNT+1;

  20192  4 001040   200032 236100                    LDQ     TERM_CNT,,AUTO
         4 001041   001000 036003                    ADLQ    512,DU
         4 001042   200032 552140                    STBQ    TERM_CNT,'40'O,AUTO

      375    20193    6                  CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.TERM(J));

  20193  4 001043   200007 236100                    LDQ     J,,AUTO
         4 001044   000054 402007                    MPY     44,DL
         4 001045   000000 124506                    SCM     mask='000'O
         4 001046   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001047   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001050   200013 000100                    ARG     NAME_LEN,,AUTO

      376    20194    6                  MATCH_LEN = TERMINAL_NAME.COUNT;

  20194  4 001051   200026 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 001052   000033 772000                    QRL     27
         4 001053   200012 756100                    STQ     MATCH_LEN,,AUTO

      377    20195    6                  CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(J),MATCH_LEN,
             20195                           TERMINAL_NAME.TEXT)

  20195  4 001054   200210 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 001055   200210 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 001056   000005 036000 5                  ADLQ    5
         4 001057   200207 756100                    STQ     TWSN_NUMBER+5,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:56   
         4 001060   200012 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001061   200206 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 001062   200007 236100                    LDQ     J,,AUTO
         4 001063   000013 402003                    MPY     11,DU
         4 001064   000013 036003                    ADLQ    11,DU
         4 001065   000000 036000 xsym               ADLQ    DSEG2$
         4 001066   200205 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001067   200013 633500                    EPPR3   NAME_LEN,,AUTO
         4 001070   200204 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 001071   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001072   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001073   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001074   001224 702000 4                  TSX2    s:20224

      378    20196    7                  WHENRETURN DO;

      379    20197    7                     CALL CONCAT( USERS_KEY.TXTC, KL$TWSNREC.DEVS.TERM(J), '*');

  20197  4 001075   200007 236100                    LDQ     J,,AUTO
         4 001076   000054 402007                    MPY     44,DL
         4 001077   000000 470400 xsym               LDP0    DSEG2$
         4 001100   040000 100506                    MLR     fill='040'O
         4 001101   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001102   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001103   040000 100400                    MLR     fill='040'O
         4 001104   000010 000001 5                  ADSC9   8                        cn=0,n=1
         4 001105   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      380    20198    7                     USERS_KEY.COUNT = 9 ;

  20198  4 001106   011000 236003                    LDQ     4608,DU
         4 001107   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      381    20199    7                     KLDREC$ = ADDR(KL$WSNCVT.WSN(KL$WSNCVT.LTWSN+1));

  20199  4 001110   000000 470400 xsym               LDP0    DSEG1$
         4 001111   000001 235100                    LDA     1,,PR0
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:57   
         4 001112   000001 735000                    ALS     1
         4 001113   000044 733000                    LRS     36
         4 001114   000022 736000                    QLS     18
         4 001115   000004 036003                    ADLQ    4,DU
         4 001116   000000 036000 xsym               ADLQ    DSEG1$
         4 001117   000000 756000 2                  STQ     KLDREC$

      382    20200    7                     I = (DSEG1SIZE - POFFC(KLDREC$,ADDR(KL$WSNCVT)));

  20200  4 001120   000000 236000 xsym               LDQ     DSEG1$
         4 001121   000020 772000                    QRL     16
         4 001122   200204 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001123   000000 236000 2                  LDQ     KLDREC$
         4 001124   000020 772000                    QRL     16
         4 001125   200204 136100                    SBLQ    TWSN_NUMBER+2,,AUTO
         4 001126   200205 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001127   000000 236000 xsym               LDQ     DSEG1SIZE
         4 001130   200205 136100                    SBLQ    TWSN_NUMBER+3,,AUTO
         4 001131   200006 756100                    STQ     I,,AUTO

      383    20201    7                     CALL ASB$READ_HLP( KLDREC$, I, 1) ALTRET( NO_TERM );

  20201  4 001132   000011 236000 5                  LDQ     9
         4 001133   200206 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001134   200006 631500                    EPPR1   I,,AUTO
         4 001135   200205 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001136   000017 236000 5                  LDQ     15
         4 001137   200204 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001140   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001141   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001142   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001143   001534 702000 4                  TSX2    NO_TERM

      384    20202    8                     IF ~ DISP THEN DO;

  20202  4 001144   200004 236100                    LDQ     DISP,,AUTO
         4 001145   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:58   
         4 001146   400000 676003                    ERQ     -131072,DU
         4 001147   001205 600000 4                  TZE     s:20215

      385    20203    9                        IF DISP_TERMINALS = 0 THEN DO;

  20203  4 001150   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 001151   001165 601000 4                  TNZ     s:20208

      386    20204    9                           CALL CONCAT (FMT_BUF, '%\', KL$TREC.TNAME);

  20204  4 001152   000014 220000 3                  LDX0    TERMINALS_STR+5
         4 001153   000000 740000 xsym               STX0    FMT_BUF
         4 001154   000000 470400 2                  LDP0    KLDREC$
         4 001155   040000 100500                    MLR     fill='040'O
         4 001156   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 001157   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      387    20205    9                           FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 1;

  20205  4 001160   000000 236000 xsym               LDQ     FDS
         4 001161   177777 376007                    ANQ     65535,DL
         4 001162   000007 276000 5                  ORQ     7
         4 001163   000000 756000 xsym               STQ     FDS

      388    20206    9                           END; /*  DISP_TERMINALS = 0  */

  20206  4 001164   001200 710000 4                  TRA     s:20211

      389    20207    9                        ELSE DO;

      390    20208    9                           CALL CONCAT (FMT_BUF, '%\%-%10R', KL$TREC.TNAME);

  20208  4 001165   040000 100400                    MLR     fill='040'O
         4 001166   000015 000010 3                  ADSC9   TERMINALS_STR+6          cn=0,n=8
         4 001167   000000 000010 xsym               ADSC9   FMT_BUF                  cn=0,n=8
         4 001170   000000 470400 2                  LDP0    KLDREC$
         4 001171   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:59   
         4 001172   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 001173   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      391    20209    9                           FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 7;

  20209  4 001174   000000 236000 xsym               LDQ     FDS
         4 001175   177777 376007                    ANQ     65535,DL
         4 001176   000002 276000 5                  ORQ     2
         4 001177   000000 756000 xsym               STQ     FDS

      392    20210    9                           END; /*  Else  */

      393    20211    8                        CALL X$FORMAT (FDS);

  20211  4 001200   000004 630400 5                  EPPR0   4
         4 001201   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001202   000000 701000 xent               TSX1    X$FORMAT
         4 001203   000000 011000                    NOP     0

      394    20212    8                        END; /*  ~disp  */

  20212  4 001204   001221 710000 4                  TRA     s:20220

      395    20213    7                     ELSE
      396    20214    8                     DO;

      397    20215    8                        TEMP_DSEG1$ = DSEG1$;

  20215  4 001205   000000 236000 xsym               LDQ     DSEG1$
         4 001206   200031 756100                    STQ     TEMP_DSEG1$,,AUTO

      398    20216    8                        DSEG1$ = KLDREC$;

  20216  4 001207   000000 236000 2                  LDQ     KLDREC$
         4 001210   000000 756000 xsym               STQ     DSEG1$

      399    20217    8                        CALL ASL$DISP_ONE_TERMINAL (JCL);
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:60   

  20217  4 001211   200010 630500                    EPPR0   JCL,,AUTO
         4 001212   200204 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001213   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001214   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001215   000000 701000 xent               TSX1    ASL$DISP_ONE_TERMINAL
         4 001216   000000 011000                    NOP     0

      400    20218    8                        DSEG1$ = TEMP_DSEG1$;

  20218  4 001217   200031 236100                    LDQ     TEMP_DSEG1$,,AUTO
         4 001220   000000 756000 xsym               STQ     DSEG1$

      401    20219    8                        END;

      402    20220    7                     DISP_TERMINALS = DISP_TERMINALS + 1;

  20220  4 001221   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 001222   000001 035007                    ADLA    1,DL
         4 001223   200005 755100                    STA     DISP_TERMINALS,,AUTO

      403    20221    7                     END; /* Whenreturn from WILD_MATCH */

      404    20222    6                  END; /* Not TERM_EXT */

      405    20223    5               END; /* If KL$TWSNREC.DEVS.TDEV(J)  */

      406    20224    4            END; /*   Of do j */

  20224  4 001224   200007 054100                    AOS     J,,AUTO
         4 001225   000000 470400 xsym               LDP0    DSEG2$
         4 001226   200007 236100                    LDQ     J,,AUTO
         4 001227   000767 604000 4                  TMI     s:20180
         4 001230   000004 116100                    CMPQ    4,,PR0
         4 001231   000767 602000 4                  TNC     s:20180

      407    20225    3   NEXT_STATION:
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:61   
      408    20226    3         END; /*  Do ltwsn  */

  20226  4 001232   200202 235100       NEXT_STATION LDA     TWSN_NUMBER,,AUTO
         4 001233   000001 035007                    ADLA    1,DL
         4 001234   200202 755100                    STA     TWSN_NUMBER,,AUTO
         4 001235   000000 470400 xsym               LDP0    DSEG1$
         4 001236   000001 236100                    LDQ     1,,PR0
         4 001237   200202 116100                    CMPQ    TWSN_NUMBER,,AUTO
         4 001240   000715 603000 4                  TRC     s:20171

      409    20227    2      GOTO FINISH_UP;

  20227  4 001241   001556 710000 4                  TRA     FINISH_UP

      410    20228
      411    20229    2      SELECT (%STATION);

      412    20230
      413    20231    2      USERS_KEY.COUNT = 15;

  20231  4 001242   017000 236003                    LDQ     7680,DU
         4 001243   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      414    20232    2      CALL CONCAT( USERS_KEY.TXTC, STATION_NAME.TEXT, 'STATION' );

  20232  4 001244   040000 100500                    MLR     fill='040'O
         4 001245   200020 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 001246   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001247   040000 100400                    MLR     fill='040'O
         4 001250   000017 000007 3                  ADSC9   TERMINALS_STR+8          cn=0,n=7
         4 001251   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      415    20233    2      ARS = DSEG1SIZE;

  20233  4 001252   000000 235000 xsym               LDA     DSEG1SIZE
         4 001253   200003 755100                    STA     ARS,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:62   
      416    20234    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( NO_TERM );

  20234  4 001254   000011 236000 5                  LDQ     9
         4 001255   200206 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001256   200003 630500                    EPPR0   ARS,,AUTO
         4 001257   200205 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001260   000012 236000 5                  LDQ     10
         4 001261   200204 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001262   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001263   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001264   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001265   001534 702000 4                  TSX2    NO_TERM

      417    20235    2      USERS_KEY.COUNT = 8;

  20235  4 001266   010000 236003                    LDQ     4096,DU
         4 001267   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      418    20236    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );

  20236  4 001270   040000 100400                    MLR     fill='040'O
         4 001271   000043 000004 3                  ADSC9   TERMINALS_STR+28         cn=0,n=4
         4 001272   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 001273   000000 470400 xsym               LDP0    DSEG1$
         4 001274   040000 100500                    MLR     fill='040'O
         4 001275   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         4 001276   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      419    20237    2      ARS = DSEG2SIZE;

  20237  4 001277   000000 235000 xsym               LDA     DSEG2SIZE
         4 001300   200003 755100                    STA     ARS,,AUTO

      420    20238    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );

  20238  4 001301   000014 236000 5                  LDQ     12
         4 001302   200206 756100                    STQ     TWSN_NUMBER+4,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:63   
         4 001303   200003 630500                    EPPR0   ARS,,AUTO
         4 001304   200205 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001305   000015 236000 5                  LDQ     13
         4 001306   200204 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001307   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001310   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001311   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001312   001552 702000 4                  TSX2    READ_ERR

      421    20239    2      TERM_CNT = 0;

  20239  4 001313   200032 450100                    STZ     TERM_CNT,,AUTO

      422    20240    3      DO J = 0 TO KL$TWSNREC.NDEV - 1;

  20240  4 001314   200007 450100                    STZ     J,,AUTO
         4 001315   001526 710000 4                  TRA     s:20279+1

      423    20241    3         TERM_EXT = %NO# ;

  20241  4 001316   200033 450100                    STZ     TERM_EXT,,AUTO

      424    20242    3         IF KL$TWSNREC.DEVS.TDEV(J)

  20242  4 001317   200007 236100                    LDQ     J,,AUTO
         4 001320   000013 402007                    MPY     11,DL
         4 001321   000000 470400 xsym               LDP0    DSEG2$
         4 001322   000006 236106                    LDQ     6,QL,PR0
         4 001323   000100 316007                    CANQ    64,DL
         4 001324   001525 600000 4                  TZE     s:20279

      425    20243    4         THEN DO;

      426    20244    5            DO K = 0 TO TERM_CNT - 1;

  20244  4 001325   200011 450100                    STZ     K,,AUTO
         4 001326   001350 710000 4                  TRA     s:20249+1
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:64   

      427    20245    5               IF TERM_LIST(K) = KL$TWSNREC.DEVS.TERM(J)

  20245  4 001327   200011 235100                    LDA     K,,AUTO
         4 001330   000003 735000                    ALS     3
         4 001331   200007 236100                    LDQ     J,,AUTO
         4 001332   200204 755100                    STA     TWSN_NUMBER+2,,AUTO
         4 001333   000054 402007                    MPY     44,DL
         4 001334   200204 235100                    LDA     TWSN_NUMBER+2,,AUTO
         4 001335   000000 470400 xsym               LDP0    DSEG2$
         4 001336   040106 106505                    CMPC    fill='040'O
         4 001337   200034 000010                    ADSC9   TERM_LIST,A,AUTO         cn=0,n=8
         4 001340   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001341   001347 601000 4                  TNZ     s:20249

      428    20246    6               THEN DO; K = TERM_CNT ;

  20246  4 001342   200032 236100                    LDQ     TERM_CNT,,AUTO
         4 001343   000033 772000                    QRL     27
         4 001344   200011 756100                    STQ     K,,AUTO

      429    20247    6                  TERM_EXT = %YES# ;

  20247  4 001345   400000 236003                    LDQ     -131072,DU
         4 001346   200033 756100                    STQ     TERM_EXT,,AUTO

      430    20248    6                  END; /*  If TERM_LIST  */

      431    20249    5               END; /*  Do k  */

  20249  4 001347   200011 054100                    AOS     K,,AUTO
         4 001350   200032 236100                    LDQ     TERM_CNT,,AUTO
         4 001351   000033 772000                    QRL     27
         4 001352   200011 116100                    CMPQ    K,,AUTO
         4 001353   001327 605400 4                  TPNZ    s:20245

      432    20250    4            IF NOT TERM_EXT
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:65   

  20250  4 001354   200033 234100                    SZN     TERM_EXT,,AUTO
         4 001355   001525 604000 4                  TMI     s:20279

      433    20251    5            THEN DO;

      434    20252    5               TERM_LIST(TERM_CNT) = KL$TWSNREC.DEVS.TERM(J);

  20252  4 001356   000001 736000                    QLS     1
         4 001357   000000 620006                    EAX0    0,QL
         4 001360   200007 236100                    LDQ     J,,AUTO
         4 001361   000054 402007                    MPY     44,DL
         4 001362   000000 635010                    EAA     0,X0
         4 001363   000020 771000                    ARL     16
         4 001364   040105 100506                    MLR     fill='040'O
         4 001365   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001366   200034 000010                    ADSC9   TERM_LIST,A,AUTO         cn=0,n=8

      435    20253    5               TERM_CNT = TERM_CNT+1;

  20253  4 001367   200032 236100                    LDQ     TERM_CNT,,AUTO
         4 001370   001000 036003                    ADLQ    512,DU
         4 001371   200032 552140                    STBQ    TERM_CNT,'40'O,AUTO

      436    20254    5               CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.TERM(J));

  20254  4 001372   200007 236100                    LDQ     J,,AUTO
         4 001373   000054 402007                    MPY     44,DL
         4 001374   000000 124506                    SCM     mask='000'O
         4 001375   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001376   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001377   200013 000100                    ARG     NAME_LEN,,AUTO

      437    20255    5               MATCH_LEN = TERMINAL_NAME.COUNT;

  20255  4 001400   200026 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 001401   000033 772000                    QRL     27
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:66   
         4 001402   200012 756100                    STQ     MATCH_LEN,,AUTO

      438    20256    5               CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(J),MATCH_LEN,
             20256                        TERMINAL_NAME.TEXT)

  20256  4 001403   200210 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 001404   200210 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 001405   000005 036000 5                  ADLQ    5
         4 001406   200207 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 001407   200012 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001410   200206 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 001411   200007 236100                    LDQ     J,,AUTO
         4 001412   000013 402003                    MPY     11,DU
         4 001413   000013 036003                    ADLQ    11,DU
         4 001414   000000 036000 xsym               ADLQ    DSEG2$
         4 001415   200205 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001416   200013 633500                    EPPR3   NAME_LEN,,AUTO
         4 001417   200204 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 001420   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001421   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001422   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001423   001525 702000 4                  TSX2    s:20279

      439    20257    6               WHENRETURN DO;

      440    20258    6                  CALL CONCAT( USERS_KEY.TXTC, KL$TWSNREC.DEVS.TERM(J), '*');

  20258  4 001424   200007 236100                    LDQ     J,,AUTO
         4 001425   000054 402007                    MPY     44,DL
         4 001426   000000 470400 xsym               LDP0    DSEG2$
         4 001427   040000 100506                    MLR     fill='040'O
         4 001430   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001431   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001432   040000 100400                    MLR     fill='040'O
         4 001433   000010 000001 5                  ADSC9   8                        cn=0,n=1
         4 001434   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:67   
      441    20259    6                  USERS_KEY.COUNT = 9 ;

  20259  4 001435   011000 236003                    LDQ     4608,DU
         4 001436   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      442    20260    6                  I = DSEG1SIZE;

  20260  4 001437   000000 235000 xsym               LDA     DSEG1SIZE
         4 001440   200006 755100                    STA     I,,AUTO

      443    20261    6                  CALL ASB$READ_HLP( KLDREC$, I, 1) ALTRET( NO_TERM );

  20261  4 001441   000011 236000 5                  LDQ     9
         4 001442   200206 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001443   200006 630500                    EPPR0   I,,AUTO
         4 001444   200205 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001445   000017 236000 5                  LDQ     15
         4 001446   200204 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001447   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001450   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001451   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001452   001534 702000 4                  TSX2    NO_TERM

      444    20262    7                  IF ~ DISP THEN DO;

  20262  4 001453   200004 236100                    LDQ     DISP,,AUTO
         4 001454   400000 376003                    ANQ     -131072,DU
         4 001455   400000 676003                    ERQ     -131072,DU
         4 001456   001514 600000 4                  TZE     s:20274

      445    20263    8                     IF DISP_TERMINALS = 0 THEN DO;

  20263  4 001457   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 001460   001474 601000 4                  TNZ     s:20268

      446    20264    8                        CALL CONCAT (FMT_BUF, '%\', KL$TREC.TNAME);

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:68   
  20264  4 001461   000014 220000 3                  LDX0    TERMINALS_STR+5
         4 001462   000000 740000 xsym               STX0    FMT_BUF
         4 001463   000000 470400 2                  LDP0    KLDREC$
         4 001464   040000 100500                    MLR     fill='040'O
         4 001465   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 001466   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      447    20265    8                        FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 1;

  20265  4 001467   000000 236000 xsym               LDQ     FDS
         4 001470   177777 376007                    ANQ     65535,DL
         4 001471   000007 276000 5                  ORQ     7
         4 001472   000000 756000 xsym               STQ     FDS

      448    20266    8                        END; /*  DISP_TERMINALS = 0  */

  20266  4 001473   001507 710000 4                  TRA     s:20271

      449    20267    8                     ELSE DO;

      450    20268    8                        CALL CONCAT (FMT_BUF, '%\%-%10R', KL$TREC.TNAME);

  20268  4 001474   040000 100400                    MLR     fill='040'O
         4 001475   000015 000010 3                  ADSC9   TERMINALS_STR+6          cn=0,n=8
         4 001476   000000 000010 xsym               ADSC9   FMT_BUF                  cn=0,n=8
         4 001477   000000 470400 2                  LDP0    KLDREC$
         4 001500   040000 100500                    MLR     fill='040'O
         4 001501   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 001502   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      451    20269    8                        FDS.FMT_.BOUND = SIZEC(KL$TREC.TNAME) + 7;

  20269  4 001503   000000 236000 xsym               LDQ     FDS
         4 001504   177777 376007                    ANQ     65535,DL
         4 001505   000002 276000 5                  ORQ     2
         4 001506   000000 756000 xsym               STQ     FDS

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:69   
      452    20270    8                        END; /*  Else  */

      453    20271    7                     CALL X$FORMAT (FDS);

  20271  4 001507   000004 630400 5                  EPPR0   4
         4 001510   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001511   000000 701000 xent               TSX1    X$FORMAT
         4 001512   000000 011000                    NOP     0

      454    20272    7                     END; /*  ~disp  */

  20272  4 001513   001522 710000 4                  TRA     s:20275

      455    20273    6                  ELSE
      456    20274    6                     CALL ASL$DISP_ONE_TERMINAL (JCL);

  20274  4 001514   200010 630500                    EPPR0   JCL,,AUTO
         4 001515   200204 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001516   200204 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001517   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001520   000000 701000 xent               TSX1    ASL$DISP_ONE_TERMINAL
         4 001521   000000 011000                    NOP     0

      457    20275    6                  DISP_TERMINALS = DISP_TERMINALS + 1;

  20275  4 001522   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 001523   000001 035007                    ADLA    1,DL
         4 001524   200005 755100                    STA     DISP_TERMINALS,,AUTO

      458    20276    6                  END; /* Whenreturn from WILD_MATCH */

      459    20277    5               END; /* Not TERM_EXT */

      460    20278    4            END; /* If KL$TWSNREC.DEVS.TDEV(J)  */

      461    20279    3         END; /*   Of do j */

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:70   
  20279  4 001525   200007 054100                    AOS     J,,AUTO
         4 001526   000000 470400 xsym               LDP0    DSEG2$
         4 001527   200007 236100                    LDQ     J,,AUTO
         4 001530   001316 604000 4                  TMI     s:20241
         4 001531   000004 116100                    CMPQ    4,,PR0
         4 001532   001316 602000 4                  TNC     s:20241

      462    20280    2      END;   /*  Do case (OPTION_CODE)  */

      463    20281
      464    20282    2   DO NEVER;

  20282  4 001533   001556 710000 4                  TRA     FINISH_UP

      465    20283
      466    20284    2   NO_TERM:
      467    20285    3      IF MERR_CODE.CODE = %E$NOKEY THEN DO;

  20285  4 001534   000000 236000 xsym  NO_TERM      LDQ     ERR_CODE
         4 001535   377770 376007                    ANQ     131064,DL
         4 001536   001020 116007                    CMPQ    528,DL
         4 001537   001552 601000 4                  TNZ     READ_ERR

      468    20286        /*E*  ERROR:  ASL-E$TERMINAL_NOEXIST-C
      469    20287                 MESSAGE: %U1 does not exist.
      470    20288                 MESSAGE1: The specified TERMINAL/STATION does not exist.
      471    20289        */
      472    20290    3         AS_FIELD1.COUNT = STATION_NAME.COUNT;

  20290  4 001540   200020 236100                    LDQ     STATION_NAME,,AUTO
         4 001541   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      473    20291    3         AS_FIELD1.TEXT  = STATION_NAME.TEXT;

  20291  4 001542   040000 100500                    MLR     fill='040'O
         4 001543   200020 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 001544   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:71   

      474    20292              %SCREAM( ERR#=E$TERMINAL_NOEXIST, LEVEL=ERROR, MID='L' );

  20304  4 001545   000020 630400 5                  EPPR0   16
         4 001546   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001547   000000 701000 xent               TSX1    ASH$ERROR
         4 001550   000000 011000                    NOP     0

      475    20307    3         END;  /*  No such key error  */

  20307  4 001551   001556 710000 4                  TRA     FINISH_UP

      476    20308    2      ELSE
      477    20309    2   READ_ERR: CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  20309  4 001552   000022 630400 5     READ_ERR     EPPR0   18
         4 001553   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001554   000000 701000 xent               TSX1    ASA$ERROR
         4 001555   000000 011000                    NOP     0

      478    20310    2      END;  /*  Do never  */

      479    20311    1   FINISH_UP:
      480    20312    2   IF NOT DISP THEN DO;

  20312  4 001556   200004 234100       FINISH_UP    SZN     DISP,,AUTO
         4 001557   001574 604000 4                  TMI     s:20318

      481    20313    2      FMT_BUF = '%\%/';

  20313  4 001560   040000 100400                    MLR     fill='040'O
         4 001561   000045 000004 3                  ADSC9   TERMINALS_STR+30         cn=0,n=4
         4 001562   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      482    20314    2      FDS.FMT_.BOUND = 3;

  20314  4 001563   000000 236000 xsym               LDQ     FDS
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:72   
         4 001564   177777 376007                    ANQ     65535,DL
         4 001565   600000 276007                    ORQ     -65536,DL
         4 001566   000000 756000 xsym               STQ     FDS

      483    20315    2      FDS.NVECS# = 0;

  20315  4 001567   000011 450000 xsym               STZ     FDS+9

      484    20316    2      CALL X$FORMAT (FDS);

  20316  4 001570   000004 630400 5                  EPPR0   4
         4 001571   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001572   000000 701000 xent               TSX1    X$FORMAT
         4 001573   000000 011000                    NOP     0

      485    20317    2      END; /*  If not disp  */

      486    20318    2   IF NOT JCL THEN DO;

  20318  4 001574   200010 234100                    SZN     JCL,,AUTO
         4 001575   001644 604000 4                  TMI     s:20339

      487    20319    2      FMT_VEC(0) = VECTOR (DISP_TERMINALS);

  20319  4 001576   777640 235007                    LDA     -96,DL
         4 001577   200204 452500                    STP2    TWSN_NUMBER+2,,AUTO
         4 001600   200204 236100                    LDQ     TWSN_NUMBER+2,,AUTO
         4 001601   000005 036003                    ADLQ    5,DU
         4 001602   000000 755000 xsym               STA     FMT_VEC
         4 001603   000001 756000 xsym               STQ     FMT_VEC+1

      488    20320    2      IF DISP_TERMINALS = 1 THEN

  20320  4 001604   200005 235100                    LDA     DISP_TERMINALS,,AUTO
         4 001605   000001 115007                    CMPA    1,DL
         4 001606   001613 601000 4                  TNZ     s:20325

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:73   
      489    20321    3      DO;

      490    20322    3         FMT_VEC(1) = VECTOR (TERMINAL_STR);

  20322  4 001607   000024 237000 5                  LDAQ    20
         4 001610   000002 755000 xsym               STA     FMT_VEC+2
         4 001611   000003 756000 xsym               STQ     FMT_VEC+3

      491    20323    3         END; /*  DISP_TERMINALS = 1  */

  20323  4 001612   001616 710000 4                  TRA     s:20327

      492    20324    3      ELSE DO;

      493    20325    3         FMT_VEC(1) = VECTOR (TERMINALS_STR);

  20325  4 001613   000026 237000 5                  LDAQ    22
         4 001614   000002 755000 xsym               STA     FMT_VEC+2
         4 001615   000003 756000 xsym               STQ     FMT_VEC+3

      494    20326    3         END; /*  DISP_TERMINALS ~= 1  */

      495    20327    2      IF DISP THEN

  20327  4 001616   200004 234100                    SZN     DISP,,AUTO
         4 001617   001624 605000 4                  TPL     s:20332

      496    20328    3      DO;

      497    20329    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  20329  4 001620   000030 237000 5                  LDAQ    24
         4 001621   000004 755000 xsym               STA     FMT_VEC+4
         4 001622   000005 756000 xsym               STQ     FMT_VEC+5

      498    20330    3         END; /*  If disp  */

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:74   
  20330  4 001623   001627 710000 4                  TRA     s:20334

      499    20331    3      ELSE DO;

      500    20332    3         FMT_VEC(2) = VECTOR (LIST_STR);

  20332  4 001624   000032 237000 5                  LDAQ    26
         4 001625   000004 755000 xsym               STA     FMT_VEC+4
         4 001626   000005 756000 xsym               STQ     FMT_VEC+5

      501    20333    3         END; /*  If ~ disp  */

      502    20334    2      FDS.NVECS# = 3;

  20334  4 001627   000003 235007                    LDA     3,DL
         4 001630   000011 755000 xsym               STA     FDS+9

      503    20335    2      FMT_BUF = '   %5D %A %A.';

  20335  4 001631   040000 100400                    MLR     fill='040'O
         4 001632   000046 000015 3                  ADSC9   TERMINALS_STR+31         cn=0,n=13
         4 001633   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      504    20336    2      FDS.FMT_.BOUND = 12;

  20336  4 001634   000000 236000 xsym               LDQ     FDS
         4 001635   177777 376007                    ANQ     65535,DL
         4 001636   000003 276003                    ORQ     3,DU
         4 001637   000000 756000 xsym               STQ     FDS

      505    20337    2      CALL X$FORMAT(FDS);

  20337  4 001640   000004 630400 5                  EPPR0   4
         4 001641   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001642   000000 701000 xent               TSX1    X$FORMAT
         4 001643   000000 011000                    NOP     0

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:75   
      506    20338    2      END; /* Not jcl */

      507    20339    1   FDS.WRAPTAB# = 4;

  20339  4 001644   000004 235007                    LDA     4,DL
         4 001645   000016 755000 xsym               STA     FDS+14

      508    20340    1   RETURN;

  20340  4 001646   000000 702200 xent               TSX2  ! X66_ARET
      509    20341    1   END ASL$LIST_ALL_TERMINALS;

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:76   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_TERMINALS.
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:77   

 **** Variables and constants ****

  ****  Section 002  Data  ASL$LIST_ALL_TERMINALS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w PTR         r     1 KL$HASPDEV$                0-0-0/w PTR         r     1 KLDREC$
    64-0-0/w PTR         r     1 LINCNFG$
     2-0-0/w UBIN        r     1 LINCNFG_BUF(0:49)

  ****  Section 003 RoData ASL$LIST_ALL_TERMINALS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(9)     r     1 DISPLAY_STR                3-0-0/c CHAR(6)     r     1 LIST_STR
     7-0-0/c CHAR(9)     r     1 TERMINALS_STR              5-0-0/c CHAR(8)     r     1 TERMINAL_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN        r     1 ARS                        4-0-0/b BIT         r     1 DISP
     5-0-0/w UBIN        r     1 DISP_TERMINALS             6-0-0/w SBIN        r     1 I
     7-0-0/w SBIN        r     1 J                         10-0-0/b BIT         r     1 JCL
    11-0-0/w SBIN        r     1 K                         12-0-0/w UBIN        r     1 MATCH_LEN
    13-0-0/w UBIN        r     1 NAME_LEN                  17-0-0/w UBIN        r     1 OPTION_CODE
    20-0-0/c STRC(81)    r     1 STATION_NAME              31-0-0/w PTR         r     1 TEMP_DSEG1$
    23-0-0/c STRC(81)    r     1 TERMINAL                  26-0-0/c STRC(81)    r     1 TERMINAL_NAME
    32-0-0/w UBIN(9)     r     1 TERM_CNT                  33-0-0/b BIT         r     1 TERM_EXT
    34-0-0/c CHAR(8)     r     1 TERM_LIST(0:49)
   202-0-0/w UBIN        r     1 TWSN_NUMBER

  ****  SYMREF variables  ****

PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:78   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(369)   r     1 AS_FIELD3                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w UBIN        r     1 DSEG2SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 KL$DREC                    0-0-0/w STRC(2412)  r     1 KL$TREC
     0-0-0/w STRC(576)   r     1 KL$TWSNREC                 0-0-0/w STRC(144)   r     1 KL$WSNCVT
     0-0-0/w ASTR(387)   r     1 LINCNFG                    0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S                        0-0-0/w ASTR(9)     r     1 TEXT$C


   Procedure ASL$LIST_ALL_TERMINALS requires 935 words for executable code.
   Procedure ASL$LIST_ALL_TERMINALS requires 138 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_TERMINALS.:E05TSI    .
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:79   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:80   
          MINI XREF LISTING

ARS
     19943**DCL     20104<<ASSIGN  20105<>CALL    20150<<ASSIGN  20151<>CALL    20233<<ASSIGN  20234<>CALL
     20237<<ASSIGN  20238<>CALL
ASA$ERROR
     19135**DCL-ENT 20309--CALL
ASA_BRKS_LOC
     16024**DCL     16024--REDEF
ASB$GET_NEXT_STATION
     19141**DCL-ENT 20175--CALL
ASB$GET_NEXT_TERMINAL
     19144**DCL-ENT 20077--CALL
ASB$INIT_GET_STATION
     19147**DCL-ENT 20169--CALL
ASB$INIT_GET_TERMINAL
     19150**DCL-ENT 20074--CALL
ASB$READ_HLP
     19153**DCL-ENT 20105--CALL    20151--CALL    20201--CALL    20234--CALL    20238--CALL    20261--CALL
ASB$WILD_MATCH
     19156**DCL-ENT 20081--CALL    20174--CALL    20195--CALL    20256--CALL
ASH$ERROR
     19159**DCL-ENT 20143--CALL    20304--CALL
ASL$DISP_ONE_TERMINAL
     19168**DCL-ENT 20096--CALL    20164--CALL    20217--CALL    20274--CALL
AS_DEFAULT.BANNER_PERM
     16717**DCL     16718--REDEF
AS_DEFAULT.BUDGET.MACCT
     16622**DCL     16626--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     16635**DCL     16638--REDEF
AS_DEFAULT.BUDGET.PACCUM
     16618**DCL     16620--REDEF
AS_DEFAULT.BUDGET.PMAXC
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:81   
     16613**DCL     16615--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     16733**DCL     16734--REDEF   16735--REDEF
AS_DEFAULT_DREC.PASSWORD
     17987**DCL     17991--REDEF
AS_DEFAULT_DREC.RENAME
     18010**DCL     18011--REDEF
AS_DFLT.BANNER_PERM
     16539**DCL     16540--REDEF
AS_DFLT.BUDGET.MACCT
     16444**DCL     16448--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     16457**DCL     16460--REDEF
AS_DFLT.BUDGET.PACCUM
     16440**DCL     16442--REDEF
AS_DFLT.BUDGET.PMAXC
     16435**DCL     16437--REDEF
AS_DFLT.SETUP_CHRA.TXT
     16555**DCL     16556--REDEF   16557--REDEF
AS_FE_MODE
     15890**DCL     15891--REDEF
AS_FIELD1.COUNT
     16021**DCL     20107<<ASSIGN  20290<<ASSIGN
AS_FIELD1.TEXT
     16021**DCL     20108<<ASSIGN  20291<<ASSIGN
AS_FIELD2.COUNT
     16021**DCL     20111<<ASSIGN  20114<<ASSIGN  20117<<ASSIGN  20120<<ASSIGN  20123<<ASSIGN  20126<<ASSIGN
AS_FIELD2.TEXT
     16021**DCL     20112<<ASSIGN  20115<<ASSIGN  20118<<ASSIGN  20121<<ASSIGN  20124<<ASSIGN  20127<<ASSIGN
AS_FIELD3.COUNT
     16022**DCL     20129<<ASSIGN
AS_FIELD3.TEXT
     16022**DCL     20130<<ASSIGN
AS_MODE
     15887**DCL     15889--REDEF
AS_MOD_USER.ACCESS
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:82   
     18752**DCL     18753--REDEF
AS_MOD_USER.BANNER
     18739**DCL     18740--REDEF
AS_MOD_USER.BANNER_PERM
     18741**DCL     18742--REDEF
AS_MOD_USER.BILL
     18747**DCL     18748--REDEF
AS_MOD_USER.CPROC
     18743**DCL     18744--REDEF
AS_MOD_USER.FEBILL
     18823**DCL     18824--REDEF
AS_MOD_USER.FECXTMEM
     18840**DCL     18841--REDEF
AS_MOD_USER.FEMINTS
     18825**DCL     18826--REDEF
AS_MOD_USER.FEMMEM
     18836**DCL     18837--REDEF
AS_MOD_USER.FEMTIME
     18834**DCL     18835--REDEF
AS_MOD_USER.FEPPRIV
     18831**DCL     18833--REDEF
AS_MOD_USER.FEPRIV
     18828**DCL     18830--REDEF
AS_MOD_USER.FORCE_BIT
     18737**DCL     18738--REDEF
AS_MOD_USER.KEY
     18819**DCL     18821--REDEF
AS_MOD_USER.LASTCPROC
     18745**DCL     18746--REDEF
AS_MOD_USER.LIMITS.DO_
     18793**DCL     18794--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     18809**DCL     18810--REDEF
AS_MOD_USER.LIMITS.LO
     18789**DCL     18790--REDEF
AS_MOD_USER.LIMITS.MEM
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:83   
     18785**DCL     18786--REDEF
AS_MOD_USER.LIMITS.MPRIO
     18813**DCL     18814--REDEF
AS_MOD_USER.LIMITS.PDIS
     18801**DCL     18802--REDEF
AS_MOD_USER.LIMITS.PO
     18797**DCL     18798--REDEF
AS_MOD_USER.LIMITS.TDIS
     18805**DCL     18806--REDEF
AS_MOD_USER.LIMITS.TIME
     18781**DCL     18782--REDEF
AS_MOD_USER.MAXENQ
     18762**DCL     18763--REDEF
AS_MOD_USER.PERM_BIT
     18735**DCL     18736--REDEF
AS_MOD_USER.PPRIV
     18757**DCL     18759--REDEF
AS_MOD_USER.PRIOB
     18764**DCL     18765--REDEF
AS_MOD_USER.PRIV
     18754**DCL     18756--REDEF
AS_MOD_USER.QUAN
     18760**DCL     18761--REDEF
AS_MOD_USER.SETUP
     18733**DCL     18734--REDEF
AS_PROJECT.BANNER_PERM
     17073**DCL     17074--REDEF
AS_PROJECT.BUDGET.MACCT
     16978**DCL     16982--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     16991**DCL     16994--REDEF
AS_PROJECT.BUDGET.PACCUM
     16974**DCL     16976--REDEF
AS_PROJECT.BUDGET.PMAXC
     16969**DCL     16971--REDEF
AS_PROJECT.SETUP_CHRA.TXT
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:84   
     17089**DCL     17090--REDEF   17091--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     17251**DCL     17252--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     17156**DCL     17160--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     17169**DCL     17172--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     17152**DCL     17154--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     17147**DCL     17149--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     17267**DCL     17268--REDEF   17269--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     18473**DCL     18477--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     18496**DCL     18497--REDEF
AS_PROJECT_DREC.PASSWORD
     18311**DCL     18315--REDEF
AS_PROJECT_DREC.RENAME
     18334**DCL     18335--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     16895**DCL     16896--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     16800**DCL     16804--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     16813**DCL     16816--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     16796**DCL     16798--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     16791**DCL     16793--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     16911**DCL     16912--REDEF   16913--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     18149**DCL     18153--REDEF
AS_PROJ_ADMIN_DREC.RENAME
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:85   
     18172**DCL     18173--REDEF
AS_USERS.BANNER_PERM
     16361**DCL     16362--REDEF
AS_USERS.BUDGET.MACCT
     16266**DCL     16270--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     16279**DCL     16282--REDEF
AS_USERS.BUDGET.PACCUM
     16262**DCL     16264--REDEF
AS_USERS.BUDGET.PMAXC
     16257**DCL     16259--REDEF
AS_USERS.SETUP_CHRA.TXT
     16377**DCL     16378--REDEF   16379--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     17429**DCL     17430--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     17334**DCL     17338--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     17347**DCL     17350--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     17330**DCL     17332--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     17325**DCL     17327--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     17445**DCL     17446--REDEF   17447--REDEF
CODE
     16017**DCL     19992<<ASSIGN  19994>>DOSELCT
CONFIG_KEY.TERMID.TERM
     18926**DCL     18935--REDEF
DISP
     19944**DCL     19998<<ASSIGN  20003<<ASSIGN  20013<<ASSIGN  20017<<ASSIGN  20084>>IF      20152>>IF
     20202>>IF      20262>>IF      20312>>IF      20327>>IF
DISPLAY_STR
     19973**DCL     20329--ASSIGN
DISP_TERMINALS
     19945**DCL     19988<<ASSIGN  20085>>IF      20097<<ASSIGN  20097>>ASSIGN  20153>>IF      20165<<ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:86   
     20165>>ASSIGN  20203>>IF      20220<<ASSIGN  20220>>ASSIGN  20263>>IF      20275<<ASSIGN  20275>>ASSIGN
     20319--ASSIGN  20320>>IF
DSEG1$
     16025**DCL     19735--IMP-PTR 19980>>ASSIGN  20105<>CALL    20149>>CALLBLT 20170>>DOINDEX 20171>>CALLBLT
     20174>>CALL    20199>>ASSIGN  20199>>ASSIGN  20200>>ASSIGN  20215>>ASSIGN  20216<<ASSIGN  20218<<ASSIGN
     20234<>CALL    20236>>CALLBLT
DSEG1SIZE
     16026**DCL     20104>>ASSIGN  20200>>ASSIGN  20233>>ASSIGN  20260>>ASSIGN
DSEG2$
     16026**DCL     19709--IMP-PTR 20151<>CALL    20179>>DOINDEX 20181>>IF      20184>>IF      20191>>ASSIGN
     20193>>CALLBLT 20195>>CALL    20197>>CALLBLT 20238<>CALL    20240>>DOINDEX 20242>>IF      20245>>IF
     20252>>ASSIGN  20254>>CALLBLT 20256>>CALL    20258>>CALLBLT
DSEG2SIZE
     16026**DCL     20150>>ASSIGN  20237>>ASSIGN
ERR_CODE
     16019**DCL     16020--REDEF
FDS
     15916**DCL     20059<>CALL    20093<>CALL    20161<>CALL    20211<>CALL    20271<>CALL    20316<>CALL
     20337<>CALL
FDS.FMT_.BOUND
     15921**DCL     20052<<ASSIGN  20056<<ASSIGN  20087<<ASSIGN  20091<<ASSIGN  20155<<ASSIGN  20159<<ASSIGN
     20205<<ASSIGN  20209<<ASSIGN  20265<<ASSIGN  20269<<ASSIGN  20314<<ASSIGN  20336<<ASSIGN
FDS.NVECS#
     15944**DCL     20047<<ASSIGN  20315<<ASSIGN  20334<<ASSIGN
FDS.TABDFLT#
     15982**DCL     20058<<ASSIGN
FDS.WRAPTAB#
     15979**DCL     20048<<ASSIGN  20339<<ASSIGN
FINISH_UP
     20312**LABEL   20077--CALLALT 20176--GOTO    20227--GOTO
FMT_BUF
     16015**DCL     20050<<CALLBLT 20051<<CALLBLT 20055<<CALLBLT 20086<<CALLBLT 20090<<CALLBLT 20154<<CALLBLT
     20158<<CALLBLT 20204<<CALLBLT 20208<<CALLBLT 20264<<CALLBLT 20268<<CALLBLT 20313<<ASSIGN  20335<<ASSIGN
FMT_VEC
     16015**DCL     20319<<ASSIGN  20322<<ASSIGN  20325<<ASSIGN  20329<<ASSIGN  20332<<ASSIGN
I
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:87   
     19946**DCL     19990<<DOINDEX 19992>>ASSIGN  20005>>IF      20006>>DOINDEX 20007>>IF      20021>>ASSIGN
     20022>>ASSIGN  20022>>ASSIGN  20031>>ASSIGN  20032>>ASSIGN  20032>>ASSIGN  20200<<ASSIGN  20201<>CALL
     20260<<ASSIGN  20261<>CALL
J
     19947**DCL     20024<<CALLBLT 20034<<CALLBLT 20179<<DOINDEX 20181>>IF      20184>>IF      20191>>ASSIGN
     20193>>CALLBLT 20195>>CALL    20197>>CALLBLT 20240<<DOINDEX 20242>>IF      20245>>IF      20252>>ASSIGN
     20254>>CALLBLT 20256>>CALL    20258>>CALLBLT
JCL
     19948**DCL     19981<<ASSIGN  20008<<ASSIGN  20041<<ASSIGN  20049>>IF      20096<>CALL    20164<>CALL
     20217<>CALL    20274<>CALL    20318>>IF
K
     19949**DCL     20006<<DOINDEX 20007>>IF      20183<<DOINDEX 20184>>IF      20185<<ASSIGN  20244<<DOINDEX
     20245>>IF      20246<<ASSIGN
KL$DREC.PASSWORD
     19814**DCL     19818--REDEF
KL$DREC.RENAME
     19837**DCL     19838--REDEF
KL$DREC.TWSN#
     19811**DCL     20149>>CALLBLT 20236>>CALLBLT
KL$HASPDEV.TERMID.TERM
     19638**DCL     19647--REDEF
KL$HASPDEV$
     18888**DCL     19488--IMP-PTR
KL$TREC.ATYP
     19198**DCL     20106>>IF      20109>>DOSELCT
KL$TREC.PASSWORD
     19251**DCL     19255--REDEF
KL$TREC.RENAME
     19274**DCL     19275--REDEF
KL$TREC.TNAME
     19284**DCL     20086>>CALLBLT 20087--ASSIGN  20090>>CALLBLT 20091--ASSIGN  20154>>CALLBLT 20155--ASSIGN
     20158>>CALLBLT 20159--ASSIGN  20204>>CALLBLT 20205--ASSIGN  20208>>CALLBLT 20209--ASSIGN  20264>>CALLBLT
     20265--ASSIGN  20268>>CALLBLT 20269--ASSIGN
KL$TWSNREC.DEVS.TDEV
     19721**DCL     20181>>IF      20242>>IF
KL$TWSNREC.DEVS.TERM
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:88   
     19728**DCL     20184>>IF      20191>>ASSIGN  20193>>CALLBLT 20195<>CALL    20197>>CALLBLT 20245>>IF
     20252>>ASSIGN  20254>>CALLBLT 20256<>CALL    20258>>CALLBLT
KL$TWSNREC.NDEV
     19712**DCL     20179>>DOINDEX 20240>>DOINDEX
KL$WSNCVT
     19735**DCL     20200--ASSIGN
KL$WSNCVT.LTWSN
     19738**DCL     20170>>DOINDEX 20199>>ASSIGN
KL$WSNCVT.WSN
     19739**DCL     20171>>CALLBLT 20174<>CALL    20199--ASSIGN
KLDREC$
     18887**DCL     19193--IMP-PTR 19756--IMP-PTR 19980<<ASSIGN  20086>>CALLBLT 20090>>CALLBLT 20106>>IF
     20109>>DOSELCT 20154>>CALLBLT 20158>>CALLBLT 20199<<ASSIGN  20200>>ASSIGN  20201<>CALL    20204>>CALLBLT
     20208>>CALLBLT 20216>>ASSIGN  20261<>CALL    20264>>CALLBLT 20268>>CALLBLT
KL_DEFAULT.PASSWORD
     18635**DCL     18639--REDEF
KL_DEFAULT.RENAME
     18658**DCL     18659--REDEF
KL_DFLT.PASSWORD
     17825**DCL     17829--REDEF
KL_DFLT.RENAME
     17848**DCL     17849--REDEF
KL_DREC.PASSWORD
     17663**DCL     17667--REDEF
KL_DREC.RENAME
     17686**DCL     17687--REDEF
KL_DREC_CNT.PASSWORD
     17550**DCL     17554--REDEF
KL_DREC_CNT.RENAME
     17573**DCL     17574--REDEF
KL_SS.SGN
     19120**DCL     19129--REDEF
LINCNFG.LGN.LGNSIZE
     19093**DCL     19094--IMP-SIZ
LINCNFG$
     18890**DCL     18956--IMP-PTR
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:89   
LINCNFG_BUF
     18889**DCL     18890--DCLINIT
LIST_STR
     19974**DCL     20332--ASSIGN
MATCH_LEN
     19950**DCL     20080<<ASSIGN  20081<>CALL    20173<<ASSIGN  20174<>CALL    20194<<ASSIGN  20195<>CALL
     20255<<ASSIGN  20256<>CALL
MERR_CODE.CODE
     16020**DCL     20285>>IF
NAME_LEN
     19951**DCL     20079<<CALLBLT 20081<>CALL    20171<<CALLBLT 20172>>IF      20172<<ASSIGN  20174<>CALL
     20193<<CALLBLT 20195<>CALL    20254<<CALLBLT 20256<>CALL
NEXT_STATION
     20226**LABEL   20174--CALLALT
NEXT_TERM
     20077**LABEL   20081--CALLALT
NODE$
     16017**DCL     19863--IMP-PTR
NO_TERM
     20285**LABEL   20201--CALLALT 20234--CALLALT 20261--CALLALT
OPTION_CODE
     19953**DCL     19983<<ASSIGN  19999<<ASSIGN  20004<<ASSIGN  20023<<ASSIGN  20026<<ASSIGN  20033<<ASSIGN
     20036<<ASSIGN  20061>>IF      20063<<ASSIGN  20065>>IF      20067<<ASSIGN  20069>>DOSELCT 20078>>IF
P$B.CODE
     19871**DCL     19992>>ASSIGN  20007>>IF
P$B.NSUBLKS
     19875**DCL     19990>>DOINDEX 20005>>IF      20006>>DOINDEX
P$B.SUBLK$
     19896**DCL     19992>>ASSIGN  20005>>IF      20006>>DOINDEX 20007>>IF      20007>>IF      20021>>ASSIGN
     20022>>ASSIGN  20022>>ASSIGN  20031>>ASSIGN  20032>>ASSIGN  20032>>ASSIGN
P$S.COUNT
     19932**DCL     19935--IMP-SIZ 20021>>ASSIGN  20022>>ASSIGN  20031>>ASSIGN  20032>>ASSIGN
P$S.TEXT
     19935**DCL     20022>>ASSIGN  20032>>ASSIGN
PROJ_KEY.TEXT
     15897**DCL     15897--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:90   
PROJ_KEY.TXT.PROJECT
     15897**DCL     15897--REDEF
P_PCB.OUT$
     16065**DCL     19990>>DOINDEX 19992>>ASSIGN  20005>>IF      20006>>DOINDEX 20007>>IF      20021>>ASSIGN
     20022>>ASSIGN  20022>>ASSIGN  20031>>ASSIGN  20032>>ASSIGN  20032>>ASSIGN
READ_ERR
     20309**LABEL   20105--CALLALT 20151--CALLALT 20238--CALLALT
REMEM_VAR
     16023**DCL     16023--REDEF
REM_FCMD
     16023**DCL     16024--REDEF
STATION_NAME.COUNT
     19955**DCL     19984<<ASSIGN  20021<<ASSIGN  20173>>ASSIGN  20290>>ASSIGN
STATION_NAME.TEXT
     19956**DCL     19985<<ASSIGN  20022<<ASSIGN  20024>>CALLBLT 20066>>IF      20174<>CALL    20232>>CALLBLT
     20291>>ASSIGN
TEMP_DSEG1$
     19963**DCL     20215<<ASSIGN  20218>>ASSIGN
TERMINAL
     19957**DCL     20077<>CALL
TERMINAL.TEXT
     19959**DCL     20079>>CALLBLT 20081<>CALL
TERMINALS_STR
     19976**DCL     20050>>CALLBLT 20051>>CALLBLT 20052--ASSIGN  20055>>CALLBLT 20056--ASSIGN  20325--ASSIGN
TERMINAL_NAME
     19960**DCL     20074<>CALL
TERMINAL_NAME.COUNT
     19961**DCL     19986<<ASSIGN  20031<<ASSIGN  20080>>ASSIGN  20107>>ASSIGN  20194>>ASSIGN  20255>>ASSIGN
TERMINAL_NAME.TEXT
     19962**DCL     19987<<ASSIGN  20032<<ASSIGN  20034>>CALLBLT 20062>>IF      20081<>CALL    20103>>CALLBLT
     20108>>ASSIGN  20195<>CALL    20256<>CALL
TERMINAL_STR
     19975**DCL     20322--ASSIGN
TERM_CNT
     19964**DCL     20178<<ASSIGN  20183>>DOINDEX 20185>>ASSIGN  20191>>ASSIGN  20192<<ASSIGN  20192>>ASSIGN
     20239<<ASSIGN  20244>>DOINDEX 20246>>ASSIGN  20252>>ASSIGN  20253<<ASSIGN  20253>>ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_TERMINALS File=ASL$LIST_TERMINALS.:E05TSI        TUE 07/29/97 10:21 Page:91   
TERM_EXT
     19965**DCL     20180<<ASSIGN  20186<<ASSIGN  20189>>IF      20241<<ASSIGN  20247<<ASSIGN  20250>>IF
TERM_LIST
     19966**DCL     20184>>IF      20191<<ASSIGN  20245>>IF      20252<<ASSIGN
TEXT$C.CNT
     19176**DCL     19177--IMP-SIZ
TWSN_NUMBER
     19968**DCL     20170<<DOINDEX 20171>>CALLBLT 20174>>CALL    20175<>CALL
USERS_KEY
     15894**DCL     20309<>CALL
USERS_KEY.COUNT
     15894**DCL     20102<<ASSIGN  20148<<ASSIGN  20198<<ASSIGN  20231<<ASSIGN  20235<<ASSIGN  20259<<ASSIGN
USERS_KEY.TEXT
     15894**DCL     15895--REDEF   15895--REDEF   15895--REDEF   15896--REDEF
USERS_KEY.TXTC
     15895**DCL     20103<<CALLBLT 20149<<CALLBLT 20197<<CALLBLT 20232<<CALLBLT 20236<<CALLBLT 20258<<CALLBLT
X$FORMAT
     19171**DCL-ENT 20059--CALL    20093--CALL    20161--CALL    20211--CALL    20271--CALL    20316--CALL
     20337--CALL
