VERSION E05

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:1    
        1        1        /*M*    OCW$CONSOLE   Perform console writes  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8        /*
        9        9         ###    ###   #   #   #    ###    ###   #   #   ###    ###   #      #####
       10       10        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #  #   #  #      #
       11       11        #   #  #      #   # # #   #      #   #  ##  #  #      #   #  #      #
       12       12        #   #  #      # # #  ###  #      #   #  # # #   ###   #   #  #      ####
       13       13        #   #  #      # # #   # # #      #   #  #  ##      #  #   #  #      #
       14       14        #   #  #   #  # # #  ###  #   #  #   #  #   #  #   #  #   #  #      #
       15       15         ###    ###    # #    #    ###    ###   #   #   ###    ###   #####  #####
       16       16                                                                   */
       17       17                                                /**/
       18       18                                                /**/
       19       19        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:2    
       20       20                                                /**/
       21       21                                                /**/
       22       22        /*M* OCW$WRITE Procedure to dispatch messages to consoles on OCCG */
       23       23        %SET LISTSUB='1'B;
       24       24                                                /**/
       25       25                                                /**/
       26       26        /*
       27       27         ###    ###   #   #   #   #   #  ####    ###   #####  #####
       28       28        #   #  #   #  #   #  ###  #   #  #   #    #      #    #
       29       29        #   #  #      #   # # #   #   #  #   #    #      #    #
       30       30        #   #  #      # # #  ###  # # #  ####     #      #    ####
       31       31        #   #  #      # # #   # # # # #  # #      #      #    #
       32       32        #   #  #   #  # # #  ###  # # #  #  #     #      #    #
       33       33         ###    ###    # #    #    # #   #   #   ###     #    #####
       34       34                                                                   */
       35       35                                                /**/
       36       36                                                /**/
       37       37                                                /**/
       38       38                                                /**/
       39       39                                           /* OCW$WRITE performs the general
       40       40                                                "write buffer on specified
       41       41                                                 console" function */
       42       42                                                /**/
       43       43        OCW$WRITE: PROC (MESS, SIZE, CADDR, WSN, MSG#);
       44       44                                                /**/
       45       45        /************************
       46       46             PARAMETERS
       47       47         ************************/
       48       48                                                /**/
       49       49    1   DCL SIZE UBIN WORD CALIGNED;
       50       50    1   DCL MESS CHAR(SIZE) CALIGNED;
       51       51    1   DCL CADDR BIT(18) CALIGNED;
       52       52    1   DCL MSG# UBIN HALF CALIGNED;
       53       53    1   DCL 1 WSN,
       54       54    1            2 FIRST_HALF CHAR(4) UNAL,
       55       55    1            2 SECND_HALF CHAR(4) UNAL;
       56       56    1   DCL WORKSTATION REDEF WSN CHAR(8) UNAL;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:3    
       57       57                                                /**/
       58       58        /**************************
       59       59             LOCALS
       60       60         **************************/
       61       61                                                /**/
       62       62    1   DCL M$OCCG DCB;
       63       63    1   DCL I UBIN WORD;
       64       64    1   DCL J SBIN WORD;
       65       65    1   DCL DO_WRITE BIT(1) ALIGNED;
       66       66    1   DCL LOG_IT BIT(1) UNAL;
       67       67    1   DCL CRLF_ BIT(36) CONSTANT INIT('012015000000'O) ALIGNED;
       68       68                                                /**/
       69       69    1   DCL OCL$LISTIT ENTRY (9);
       70       70                                                /**/
       71       71    1   DCL 1 TEMP,
       72       72    1            2 B BIT(18) UNAL,
       73       73    1            2 U REDEF B UBIN HALF UNAL;
       74       74                                                /**/
       75       75        %SUB MASK='377777'O;
       76       76                                                /**/
       77       77        %INCLUDE OCI_SUBS_C;
       78      175                                                /**/
       79      176        %INCLUDE CP_6;
       80      257        %INCLUDE OC_DAT_R;
       81      418                                                /**/
       82      419        %INCLUDE OC_SUBS_C;
       83     1150        %INCLUDE OUT_SUBS_C;
       84     1273        %INCLUDE OCM_DATA_R;
       85     1286                                                /**/
       86     1287    1   DCL MESS$ PTR;
       87     1288    1   DCL WSIZE SBIN WORD;
       88     1289    1   DCL LASTLANG CHAR(1);
       89     1290                                                /**/
       90     1291    1   DCL OCM$TPSET ENTRY(2) ALTRET;
       91     1292    1   DCL MESSAGE# UBIN HALF UNAL STATIC INIT(1024 /* LGST_MSG# */);
       92     1293    1   DCL TERM_TEXT CHAR (8) STATIC;
       93     1294    1   DCL WSN_TEXT CHAR(8) STATIC;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:4    
       94     1295                                                /**/
       95     1296                                                /**/
       96     1297        %INCLUDE KC_ERRORS_C;
       97     1344                                                /**/
       98     1345                                                /**/
       99     1346             %FPT_WRITE     (DCB=M$OCCG,
      100     1347                                 STATION=KSTA,
      101     1348                                 EVENT=OC_WRDN_O);
      102     1379                                                /**/
      103     1380              %VLP_STATION (FPTN=KSTA);
      104     1407                                                /**/
      105     1408        /*
      106     1409             Begin INTERNAL routine WRITE
      107     1410                                                                          */
      108     1411    1   WRITE: PROC;
      109     1412          /**/
      110     1413    2        IF OC_CONSOLE.FLAGS.OUTP(I)        /* output legal on this console */
      111     1414    2        THEN
      112     1415    3        DO;
      113     1416    3             IF ADDR(MSG#) ~= ADDR(NIL)
      114     1417    3                  AND
      115     1418    3                  LASTLANG ~= OC_CONSOLE.NATLANG(I)
      116     1419    3             THEN
      117     1420    4             DO;
      118     1421    4                  CALL OCM$TPSET(OC_CONSOLE.NATLANG(I),MESS) ALTRET(BADDY);
      119     1422    4                  MESS$ = ADDR(OCM_BUFFER);
      120     1423    4                  IF OCM_BPOSN = 0
      121     1424    4                  THEN
      122     1425    4                       RETURN;
      123     1426    4                  WSIZE = OCM_BPOSN;
      124     1427    4                  LASTLANG = OC_CONSOLE.NATLANG(I);
      125     1428    4                  FPT_WRITE.BUF_.BOUND = WSIZE - 1;
      126     1429    4                  FPT_WRITE.BUF_.BUF$ = MESS$;
      127     1430    4                END;                       /* NEW LANGUAGE */
      128     1431    3             KSTA.STATION# = OC_CONSOLE.STATION(I);
      129     1432    3             IF WSIZE > OC_PLATEN_WIDTH
      130     1433    3             THEN
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:5    
      131     1434    3                  IF SUBSTR(OC_CONSOLE.STATION(I),0,2) = 'SC'
      132     1435    3                  THEN
      133     1436    4                  DO;
      134     1437    4                       FPT_WRITE.BUF_.BOUND = OC_PLATEN_WIDTH - 1;
      135     1438    4                       CALL M$WRITE (FPT_WRITE) ALTRET(OOPS1);
      136     1439    4   OOPS1:              ;
      137     1440    4                       FPT_WRITE.BUF_.BOUND = WSIZE - OC_PLATEN_WIDTH-1;
      138     1441    4                       FPT_WRITE.BUF_.BUF$=PINCRC(MESS$,OC_PLATEN_WIDTH);
      139     1442    4                       CALL M$WRITE (FPT_WRITE) ALTRET (OOPS2);
      140     1443    4   OOPS2:              ;
      141     1444    4                       FPT_WRITE.BUF_.BOUND = WSIZE - 1;
      142     1445    4                       FPT_WRITE.BUF_.BUF$ = MESS$;
      143     1446    4                     END;                  /* DO IF SYSTEM (IOM CONS) */
      144     1447    3                  ELSE
      145     1448    3                       CALL M$WRITE (FPT_WRITE) ALTRET (IGNORE);
      146     1449    3             ELSE
      147     1450    3                  CALL M$WRITE (FPT_WRITE) ALTRET (IGNORE);
      148     1451    3   IGNORE:   ;
      149     1452                                                /* Set the 'print the time' bit */
      150     1453    3             OC_CONSOLE.TRANSAC_LAST_MIN(I) = '1'B /*TRUE#*/;
      151     1454    3           END;
      152     1455    2        RETURN;
      153     1456    2   BADDY: RETURN;                     /* BAD TEMPLATE DO NOT WRITE ANYTHING  */
      154     1457    2   END WRITE;
      155     1458                                                /**/
      156     1459                                                /**/
      157     1460                                                /**/
      158     1461        /*
      159     1462             Begin       O C W $ W R I T E
      160     1463                                                                          */
      161     1464                                                /**/
      162     1465                                                /**/
      163     1466    1        IF SIZE = 0
      164     1467    1        THEN
      165     1468    1             RETURN;
      166     1469                                                /**/
      167     1470    1        LASTLANG = BINASC(0);
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:6    
      168     1471    1        WSN_TEXT = ' ';
      169     1472    1        TERM_TEXT = ' ';
      170     1473    1        LOG_IT = '0'B;
      171     1474    1        OC_CONSOLE.NATLANG (0) = BITASC('377'O); /* SET LANGUAGE BYTE  */
      172     1475    1        OC_CONSOLE.NEXT (0) = 0;
      173     1476    1        MESS$ = ADDR(MESS);
      174     1477    1        WSIZE = SIZE;
      175     1478    1        FPT_WRITE.BUF_.BOUND = WSIZE - 1;
      176     1479    1        FPT_WRITE.BUF_.BUF$ = ADDR (MESS);
      177     1480                                           /* If console direct address is
      178     1481                                                specified, write on that
      179     1482                                                console only */
      180     1483                                           /* Note that this test checks to
      181     1484                                                see if the Console Direct
      182     1485                                                Address Bit is set AND
      183     1486                                                coincidentally checks to see
      184     1487                                                if this direct write was the
      185     1488                                                result of an Internal keyin.
      186     1489                                                If it was the result of an
      187     1490                                                internal keyin, the test fails
      188     1491                                                and is treated like an
      189     1492                                                attribute write to SYSTEM
      190     1493                                                consoles  */
      191     1494    1        IF (CADDR & ~'177777'O) = OC_DIR
      192     1495    1        THEN
      193     1496    2        DO;
      194     1497    2             TEMP.B = CADDR & '377777'O;
      195     1498    3             DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      196     1499    3                  IF OC_CONSOLE.ACTIVE(I)
      197     1500    3                  THEN
      198     1501    3                       IF OC_CONSOLE.CID(I) = TEMP.U
      199     1502    3                       THEN
      200     1503    4                       DO;
      201     1504    4                            CALL WRITE;
      202     1505    4                            IF OC_LIST
      203     1506    4                            THEN
      204     1507    5                            DO;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:7    
      205     1508    5                                 IF ADDR(MSG#) = ADDR(NIL)
      206     1509    5                                 THEN
      207     1510    6                                 DO;
      208     1511    6                                      CALL OCL$LISTIT (CADDR, 0 /* OCI_OUTPUT# */,
              1511                                               MESSAGE#,
      209     1512    6                                           WSN, I, SIZE, MESS, ,);
      210     1513    6                                    END;
      211     1514    5                                 ELSE
      212     1515    6                                 DO;
      213     1516    6                                      CALL OCL$LISTIT (CADDR, 0 /* OCI_OUTPUT# */, MSG#
              1516                                               ,
      214     1517    6                                           WSN, I, SIZE, MESS, ,);
      215     1518    6                                    END;   /* DO IF NOT ADDR(NIL) */
      216     1519    5                               END;        /* DO IF LISTING ON */
      217     1520                                                /**/
      218     1521    4                            I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
      219     1522    4                          END;             /* DO (if found) */
      220     1523    3                END;                       /* DO I=0 TO 71 */
      221     1524    2           END;                            /* DO IF direct addressed */
      222     1525                                                /**/
      223     1526                                                /**/
      224     1527        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:8    
      225     1528    1        ELSE
      226     1529                                                /**/
      227     1530                                                /**/
      228     1531                                                /* Must be attribute addressed */
      229     1532    2        DO;
      230     1533    2             TEMP.B = CADDR;
      231     1534                                           /* For now -- if the passed msg is
      232     1535                                                not a device msg, then it might
      233     1536                                                be for local. If the passed wsn
      234     1537                                                is blanks, it should be zeroed
      235     1538                                                prior to search           */
      236     1539                                                /**/
      237     1540    2             IF (TEMP.B & ~'100000'O /* M_DEVC  */)
      238     1541    2                  AND
      239     1542    2                  (WSN.FIRST_HALF = ' ')
      240     1543    2             THEN
      241     1544    2                  WSN.FIRST_HALF = '0000';
      242     1545                                                /**/
      243     1546                                                /**/
      244     1547                                           /* Scan the console table --
      245     1548                                                if addressed by WSN/DEVNM,
      246     1549                                                an additional check is made
      247     1550                                                to be sure that the message is
      248     1551                                                for the right console */
      249     1552                                                /**/
      250     1553                                           /* Also, all non-device messages are
      251     1554                                                sent to the system console */
      252     1555    2             OC_CONSOLE.NATLANG (0) = BITASC('377'O); /* SET LANGUAGE BYTE  */
      253     1556    2             OC_CONSOLE.NEXT (0) = 0;
      254     1557    3             DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
      255     1558                                                /**/
      256     1559                                           /* Save the console attribute for
      257     1560                                              which this message is intended. */
      258     1561                                                /**/
      259     1562    3                  TEMP.B = CADDR;
      260     1563    3                  IF OC_CONSOLE.ACTIVE(I)
      261     1564    3                  THEN
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:9    
      262     1565    4                  DO;
      263     1566                                                /**/
      264     1567                                                /* Is this a SYSTEM console? */
      265     1568    4                       IF ('200000'O /* M_SYS  */ & OC_CONSOLE.ATTR_OUTPUT(I))
      266     1569    4                       THEN
      267     1570    5                       DO;
      268     1571                                           /* Is there a deliberate request to
      269     1572                                              skip SYSTEM consoles?  */
      270     1573    5                            IF TEMP.B & '000040'O /* M_NONSYS */
      271     1574    5                            THEN
      272     1575    5                                 GOTO SKIP_IT;
      273     1576                                                /**/
      274     1577                                           /* If its a device message, and the
      275     1578                                              TWSN is  station LOCAL, allow the
      276     1579                                              write. */
      277     1580                                                /**/
      278     1581    5                            IF TEMP.B & '100000'O /* M_DEVC  */
      279     1582    5                            THEN
      280     1583    5                                 IF WSN.SECND_HALF ~= '0000'
      281     1584    5                                 THEN
      282     1585    5                                      GOTO SKIP_IT;
      283     1586                                                /**/
      284     1587    5                            TERM_TEXT = OC_CONSOLE.TERM_NAME (I);
      285     1588                                           /* If the message is ADMIN and the
      286     1589                                              workstation matches, do the write
      287     1590                                              and use the passed workstation.
      288     1591                                              Otherwise, do the write and use
      289     1592                                              the workstation from the console
      290     1593                                              table. */
      291     1594                                                /**/
      292     1595                                                /**/
      293     1596    5                            IF TEMP.B & '040000'O /* M_ADMIN */
      294     1597    5                            THEN
      295     1598    6                            DO;
      296     1599    6                                 CALL INDEX (J, '?', OC_CONSOLE.WSN(I));
      297     1600    6                                 IF SUBSTR (OC_CONSOLE.WSN(I), 0, J)
      298     1601    6                                      ~= SUBSTR (WORKSTATION, 0, J)
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:10   
      299     1602    6                                 THEN
      300     1603    6                                      GOTO SKIP_IT;
      301     1604    6                                 WSN_TEXT = WORKSTATION;
      302     1605    6                               END;
      303     1606    5                            ELSE
      304     1607    5                                 WSN_TEXT = OC_CONSOLE.WSN(I);
      305     1608                                                /**/
      306     1609                                                /**/
      307     1610    5                            CALL ORDER;    /* ORDER THE WRITE */
      308     1611    5                            LOG_IT = '1'B; /* This prevents accidental logging
      309     1612                                          by code that goes to SKIP_IT */
      310     1613    5   SKIP_IT:                 ;
      311     1614    5                          END;             /* DO IF SYS CONS */
      312     1615                                                /**/
      313     1616        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:11   
      314     1617    4                       ELSE
      315     1618    5                       DO;
      316     1619                                                /**/
      317     1620                                           /* If its a device console message,
      318     1621                                              check if the TWSN of the message
      319     1622                                              matches that of the console. If
      320     1623                                              so save the WSN and TWSN. If not
      321     1624                                              mask out the DEVC bit. */
      322     1625                                                /**/
      323     1626    5                            IF TEMP.B & '100000'O /* M_DEVC  */
      324     1627    5                            THEN
      325     1628    5                                 IF OC_CONSOLE.STATIONR.SECND_HALF(I) ~=
      326     1629    5                                      WSN.SECND_HALF
      327     1630    5                                 THEN
      328     1631    5                                      TEMP.B = TEMP.B & (~ '100000'O /* M_DEVC  */);
      329     1632    5                                 ELSE
      330     1633    6                                 DO;
      331     1634    6                                      TERM_TEXT = OC_CONSOLE.TERM_NAME(I);
      332     1635    6                                      WSN_TEXT = OC_CONSOLE.WSN(I);
      333     1636    6                                    END;
      334     1637                                                /**/
      335     1638                                                /**/
      336     1639                                                /**/
      337     1640                                           /* If its an ADMIN message, check
      338     1641                                              if WSN in the message matches
      339     1642                                              that of the console.  If so save
      340     1643                                              the passed WSN. If not, mask out
      341     1644                                              the ADMIN bit. */
      342     1645                                                /**/
      343     1646    5                            IF TEMP.B & '040000'O /* M_ADMIN */
      344     1647    5                            THEN
      345     1648    6                            DO;
      346     1649    6                                 CALL INDEX(J,'?',OC_CONSOLE.WSN(I));
      347     1650    6                                 IF SUBSTR(OC_CONSOLE.WSN(I),0,J) ~= SUBSTR(WORKSTATION
              1650                                          ,0,J)
      348     1651    6                                 THEN
      349     1652    6                                      TEMP.B = TEMP.B & (~ '040000'O /* M_ADMIN */);
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:12   
      350     1653    6                                 ELSE
      351     1654    7                                 DO;
      352     1655    7                                      TERM_TEXT = OC_CONSOLE.TERM_NAME(I);
      353     1656    7                                      WSN_TEXT = WORKSTATION;
      354     1657    7                                    END;
      355     1658    6                               END;
      356     1659                                                /**/
      357     1660                                                /**/
      358     1661    5                            IF OC_CONSOLE.ATTR_OUTPUT(I) & TEMP.B
      359     1662    5                            THEN
      360     1663    6                            DO;
      361     1664    6                                 CALL ORDER; /* ORDER THE WRITE */
      362     1665    6                                 LOG_IT = '1'B; /* Only log if we call order */
      363     1666    6                               END;
      364     1667    5                          END;             /* DO IF NON_SYS CONS */
      365     1668    4                     END;                  /* DO IF ACTIVE */
      366     1669    3                END;                       /* DO I = 0 TO 71 */
      367     1670                                                /**/
      368     1671    2             CALL WRITEO;                  /* WRITE ANY MESSAGES SAVED */
      369     1672                                                /**/
      370     1673    2           END;                            /* Do if attribute addressed */
      371     1674                                                /**/
      372     1675                                           /* Write to :OCHIST must take
      373     1676                                                place after write to consoles
      374     1677                                                so that the data saved in
      375     1678                                                OCO$IWRITE is not clobbered
      376     1679                                                by possible altrets in
      377     1680                                                OCL$LISTIT. */
      378     1681                                                /**/
      379     1682                                                /**/
      380     1683                                      /* Note that the level on this is a
      381     1684                                         2.  This means there will be a write
      382     1685                                         to :OCHIST for every console we
      383     1686                                         locate.  This is necessary because
      384     1687                                         it allows REPLAY users to select by
      385     1688                                         WSN and thus see a true replay of
      386     1689                                         activity. */
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:13   
      387     1690                                                /**/
      388     1691    1        IF OC_LIST AND LOG_IT = '1'B
      389     1692    1        THEN
      390     1693    2        DO;
      391     1694    2             LOG_IT = '0'B;
      392     1695    2             IF ADDR(MSG#) = ADDR(NIL)
      393     1696    2             THEN
      394     1697    3             DO;
      395     1698    3                  CALL OCL$LISTIT (CADDR, 0 /* OCI_OUTPUT# */, MESSAGE#,
      396     1699    3                       WSN, OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */, SIZE,
      397     1700    3                       MESS, TERM_TEXT, WSN_TEXT);
      398     1701    3                END;
      399     1702    2             ELSE
      400     1703    3             DO;
      401     1704    3                  CALL OCL$LISTIT (CADDR, 0 /* OCI_OUTPUT# */,
      402     1705    3                       MSG#, WSN, OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */,
      403     1706    3                       SIZE, MESS, TERM_TEXT, WSN_TEXT);
      404     1707    3                END;                       /* DO IF NOT ADDR (NIL) */
      405     1708    2           END;                            /* DO IF LISTING ON */
      406     1709                                                /**/
      407     1710    1        RETURN;
      408     1711                                                /**/
      409     1712        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:14   
      410     1713                            /*
      411     1714                                 Internal routine ORDER will sort the
      412     1715                                 writes to consoles so the language will
      413     1716                                 always be written in order. This saves
      414     1717                                 extra I/O's to get the same template more
      415     1718                                 than once.
      416     1719                                                      */
      417     1720    1   ORDER: PROC ;
      418     1721                                                /**/
      419     1722    2   DCL J SBIN WORD;
      420     1723    2   DCL LAST SBIN WORD;
      421     1724                                                /**/
      422     1725    2        J = OC_CONSOLE.NEXT(0);            /* GET FIRST ENTRY */
      423     1726    2        LAST = 0;
      424     1727                                                /**/
      425     1728                                                /**/
      426     1729    3        DO WHILE (J ~= 0 AND OC_CONSOLE.NATLANG(J) > OC_CONSOLE.NATLANG(I));
      427     1730    3             LAST = J;                     /* SAVE LAST ENTRY WE LOOKED AT */
      428     1731    3             J = OC_CONSOLE.NEXT(J);       /* POINT TO NEXT ENTRY */
      429     1732    3           END;
      430     1733                                                /*
      431     1734                                                     We no have the positon
      432     1735                                                     so we will insert this console
      433     1736                                                           */
      434     1737    2        OC_CONSOLE.NEXT(LAST) = I;         /* POINT LAST ENTRY TO NEW */
      435     1738    2        OC_CONSOLE.NEXT(I) = J;            /* POINT NEW ENRY TO NEXT ONE */
      436     1739    2        RETURN;
      437     1740    2   END ORDER;
      438     1741        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:15   
      439     1742                            /* Internal proc WRITEO will write the messages
      440     1743                                 in the order specified in ORDER_TAB
      441     1744                                       */
      442     1745    1   WRITEO: PROC;
      443     1746                                                /**/
      444     1747    2        I = OC_CONSOLE.NEXT(0);            /* GET FIRST ENTRY */
      445     1748                                                /**/
      446     1749    3        DO WHILE (I ~= 0);
      447     1750    3             CALL WRITE;
      448     1751    3             I = OC_CONSOLE.NEXT(I);       /* GET NEXT ENTRY */
      449     1752    3           END;                            /* END WRITE LOOP */
      450     1753    2        RETURN;                            /* FINISHED WRITING */
      451     1754    2   END WRITEO;
      452     1755    1   END OCW$WRITE;

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:16   
--  Include file information  --

   KC_ERRORS_C.:E05TOU  is referenced.
   OCM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OUT_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCW$WRITE.

   Procedure OCW$WRITE requires 487 words for executable code.
   Procedure OCW$WRITE requires 30 words of local(AUTO) storage.

    No errors detected in file OCW$CONSOLE.:E05TSI    .

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:17   

 Object Unit name= OCW$WRITE                                  File name= OCW$CONSOLE.:E05TOU
 UTS= JUL 30 '97 04:08:24.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$OCCG
    1  RoData even  UTS      3      3  OCW$WRITE
    2   DCB   even  none     0      0  M$UC
    3   Data  even  none    26     32  OCW$WRITE
    4   Proc  even  none   487    747  OCW$WRITE
    5  RoData even  none    12     14  OCW$WRITE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        5  OCW$WRITE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       9 OCL$LISTIT
 yes     yes           Std       2 OCM$TPSET
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:18   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$OCCG                                M$UC                                  OC_INTMSG
     OC_MESSBUF                            OC_MSGBUFFER                          OC_PARAM
     OC_CONSOLE$                           OC_MAXCONSOLE                         OC_DIR
     OC_INTBIT                             OC_MASK                               OC_LIST
     OC_PLATEN_WIDTH                       OCM_BPOSN                             OCM_BUFFER
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:19   


        1        1        /*M*    OCW$CONSOLE   Perform console writes  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8        /*
        9        9         ###    ###   #   #   #    ###    ###   #   #   ###    ###   #      #####
       10       10        #   #  #   #  #   #  ###  #   #  #   #  #   #  #   #  #   #  #      #
       11       11        #   #  #      #   # # #   #      #   #  ##  #  #      #   #  #      #
       12       12        #   #  #      # # #  ###  #      #   #  # # #   ###   #   #  #      ####
       13       13        #   #  #      # # #   # # #      #   #  #  ##      #  #   #  #      #
       14       14        #   #  #   #  # # #  ###  #   #  #   #  #   #  #   #  #   #  #      #
       15       15         ###    ###    # #    #    ###    ###   #   #   ###    ###   #####  #####
       16       16                                                                   */
       17       17                                                /**/
       18       18                                                /**/
       19       19        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:20   
       20       20                                                /**/
       21       21                                                /**/
       22       22        /*M* OCW$WRITE Procedure to dispatch messages to consoles on OCCG */
       23       23        %SET LISTSUB='1'B;
       24       24                                                /**/
       25       25                                                /**/
       26       26        /*
       27       27         ###    ###   #   #   #   #   #  ####    ###   #####  #####
       28       28        #   #  #   #  #   #  ###  #   #  #   #    #      #    #
       29       29        #   #  #      #   # # #   #   #  #   #    #      #    #
       30       30        #   #  #      # # #  ###  # # #  ####     #      #    ####
       31       31        #   #  #      # # #   # # # # #  # #      #      #    #
       32       32        #   #  #   #  # # #  ###  # # #  #  #     #      #    #
       33       33         ###    ###    # #    #    # #   #   #   ###     #    #####
       34       34                                                                   */
       35       35                                                /**/
       36       36                                                /**/
       37       37                                                /**/
       38       38                                                /**/
       39       39                                           /* OCW$WRITE performs the general
       40       40                                                "write buffer on specified
       41       41                                                 console" function */
       42       42                                                /**/
       43       43        OCW$WRITE: PROC (MESS, SIZE, CADDR, WSN, MSG#);

     43  4 000000   000000 700200 xent  OCW$WRITE    TSX0  ! X66_AUTO_5
         4 000001   000036 000005                    ZERO    30,5
         4 000002   000166 710000 4                  TRA     s:1466

       44       44                                                /**/
       45       45        /************************
       46       46             PARAMETERS
       47       47         ************************/
       48       48                                                /**/
       49       49    1   DCL SIZE UBIN WORD CALIGNED;
       50       50    1   DCL MESS CHAR(SIZE) CALIGNED;
       51       51    1   DCL CADDR BIT(18) CALIGNED;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:21   
       52       52    1   DCL MSG# UBIN HALF CALIGNED;
       53       53    1   DCL 1 WSN,
       54       54    1            2 FIRST_HALF CHAR(4) UNAL,
       55       55    1            2 SECND_HALF CHAR(4) UNAL;
       56       56    1   DCL WORKSTATION REDEF WSN CHAR(8) UNAL;
       57       57                                                /**/
       58       58        /**************************
       59       59             LOCALS
       60       60         **************************/
       61       61                                                /**/
       62       62    1   DCL M$OCCG DCB;
       63       63    1   DCL I UBIN WORD;
       64       64    1   DCL J SBIN WORD;
       65       65    1   DCL DO_WRITE BIT(1) ALIGNED;
       66       66    1   DCL LOG_IT BIT(1) UNAL;
       67       67    1   DCL CRLF_ BIT(36) CONSTANT INIT('012015000000'O) ALIGNED;
       68       68                                                /**/
       69       69    1   DCL OCL$LISTIT ENTRY (9);
       70       70                                                /**/
       71       71    1   DCL 1 TEMP,
       72       72    1            2 B BIT(18) UNAL,
       73       73    1            2 U REDEF B UBIN HALF UNAL;
       74       74                                                /**/
       75       75        %SUB MASK='377777'O;
       76       76                                                /**/
       77       77        %INCLUDE OCI_SUBS_C;
       78      175                                                /**/
       79      176        %INCLUDE CP_6;
       80      257        %INCLUDE OC_DAT_R;
       81      418                                                /**/
       82      419        %INCLUDE OC_SUBS_C;
       83     1150        %INCLUDE OUT_SUBS_C;
       84     1273        %INCLUDE OCM_DATA_R;
       85     1286                                                /**/
       86     1287    1   DCL MESS$ PTR;
       87     1288    1   DCL WSIZE SBIN WORD;
       88     1289    1   DCL LASTLANG CHAR(1);
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:22   
       89     1290                                                /**/
       90     1291    1   DCL OCM$TPSET ENTRY(2) ALTRET;
       91     1292    1   DCL MESSAGE# UBIN HALF UNAL STATIC INIT(1024 /* LGST_MSG# */);
       92     1293    1   DCL TERM_TEXT CHAR (8) STATIC;
       93     1294    1   DCL WSN_TEXT CHAR(8) STATIC;
       94     1295                                                /**/
       95     1296                                                /**/
       96     1297        %INCLUDE KC_ERRORS_C;
       97     1344                                                /**/
       98     1345                                                /**/
       99     1346             %FPT_WRITE     (DCB=M$OCCG,
      100     1347                                 STATION=KSTA,
      101     1348                                 EVENT=OC_WRDN_O);
      102     1379                                                /**/
      103     1380              %VLP_STATION (FPTN=KSTA);
      104     1407                                                /**/
      105     1408        /*
      106     1409             Begin INTERNAL routine WRITE
      107     1410                                                                          */
      108     1411    1   WRITE: PROC;

   1411  4 000003   200022 741300       WRITE        STX1  ! J+1,,AUTO

      109     1412          /**/
      110     1413    2        IF OC_CONSOLE.FLAGS.OUTP(I)        /* output legal on this console */

   1413  4 000004   200010 236100                    LDQ     I,,AUTO
         4 000005   000076 402007                    MPY     62,DL
         4 000006   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000007   000017 236106                    LDQ     15,QL,PR0
         4 000010   200000 316003                    CANQ    65536,DU
         4 000011   000162 600000 4                  TZE     s:1455

      111     1414    2        THEN
      112     1415    3        DO;

      113     1416    3             IF ADDR(MSG#) ~= ADDR(NIL)
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:23   

   1416  4 000012   200007 236100                    LDQ     @MSG#,,AUTO
         4 000013   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000014   000064 600000 4                  TZE     s:1431
         4 000015   200010 236100                    LDQ     I,,AUTO
         4 000016   000370 402007                    MPY     248,DL
         4 000017   040106 106500                    CMPC    fill='040'O
         4 000020   200017 000001                    ADSC9   LASTLANG,,AUTO           cn=0,n=1
         4 000021   000017 600001                    ADSC9   15,Q,PR0                 cn=3,n=1
         4 000022   000064 600000 4                  TZE     s:1431

      114     1417    3                  AND
      115     1418    3                  LASTLANG ~= OC_CONSOLE.NATLANG(I)
      116     1419    3             THEN
      117     1420    4             DO;

      118     1421    4                  CALL OCM$TPSET(OC_CONSOLE.NATLANG(I),MESS) ALTRET(BADDY);

   1421  4 000023   200003 236100                    LDQ     @MESS,,AUTO
         4 000024   200025 756100                    STQ     LAST+3,,AUTO
         4 000025   200010 236100                    LDQ     I,,AUTO
         4 000026   000076 402003                    MPY     62,DU
         4 000027   000000 036000 5                  ADLQ    0
         4 000030   000000 036000 xsym               ADLQ    OC_CONSOLE$
         4 000031   200024 756100                    STQ     LAST+2,,AUTO
         4 000032   200024 630500                    EPPR0   LAST+2,,AUTO
         4 000033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000034   000000 701000 xent               TSX1    OCM$TPSET
         4 000035   000164 702000 4                  TSX2    BADDY

      119     1422    4                  MESS$ = ADDR(OCM_BUFFER);

   1422  4 000036   000001 236000 5                  LDQ     1
         4 000037   200015 756100                    STQ     MESS$,,AUTO

      120     1423    4                  IF OCM_BPOSN = 0

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:24   
   1423  4 000040   000000 235000 xsym               LDA     OCM_BPOSN
         4 000041   000044 601000 4                  TNZ     s:1426

      121     1424    4                  THEN
      122     1425    4                       RETURN;

   1425  4 000042   200022 221300                    LDX1  ! J+1,,AUTO
         4 000043   000001 702211                    TSX2  ! 1,X1

      123     1426    4                  WSIZE = OCM_BPOSN;

   1426  4 000044   200016 755100                    STA     WSIZE,,AUTO

      124     1427    4                  LASTLANG = OC_CONSOLE.NATLANG(I);

   1427  4 000045   200010 236100                    LDQ     I,,AUTO
         4 000046   000076 402007                    MPY     62,DL
         4 000047   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000050   000017 236106                    LDQ     15,QL,PR0
         4 000051   000033 736000                    QLS     27
         4 000052   000002 276000 5                  ORQ     2
         4 000053   200017 756100                    STQ     LASTLANG,,AUTO

      125     1428    4                  FPT_WRITE.BUF_.BOUND = WSIZE - 1;

   1428  4 000054   200016 236100                    LDQ     WSIZE,,AUTO
         4 000055   000001 136007                    SBLQ    1,DL
         4 000056   000020 736000                    QLS     16
         4 000057   000012 676000 3                  ERQ     FPT_WRITE+4
         4 000060   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000061   000012 656000 3                  ERSQ    FPT_WRITE+4

      126     1429    4                  FPT_WRITE.BUF_.BUF$ = MESS$;

   1429  4 000062   200015 236100                    LDQ     MESS$,,AUTO
         4 000063   000013 756000 3                  STQ     FPT_WRITE+5

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:25   
      127     1430    4                END;                       /* NEW LANGUAGE */

      128     1431    3             KSTA.STATION# = OC_CONSOLE.STATION(I);

   1431  4 000064   200010 236100                    LDQ     I,,AUTO
         4 000065   000370 402007                    MPY     248,DL
         4 000066   040000 100506                    MLR     fill='040'O
         4 000067   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         4 000070   000022 000010 3                  ADSC9   KSTA                     cn=0,n=8

      129     1432    3             IF WSIZE > OC_PLATEN_WIDTH

   1432  4 000071   200016 236100                    LDQ     WSIZE,,AUTO
         4 000072   000000 116000 xsym               CMPQ    OC_PLATEN_WIDTH
         4 000073   000150 604400 4                  TMOZ    s:1450

      130     1433    3             THEN
      131     1434    3                  IF SUBSTR(OC_CONSOLE.STATION(I),0,2) = 'SC'

   1434  4 000074   200010 236100                    LDQ     I,,AUTO
         4 000075   000076 402007                    MPY     62,DL
         4 000076   000000 220106                    LDX0    0,QL,PR0
         4 000077   000001 100000 1                  CMPX0   1
         4 000100   000143 601000 4                  TNZ     s:1448

      132     1435    3                  THEN
      133     1436    4                  DO;

      134     1437    4                       FPT_WRITE.BUF_.BOUND = OC_PLATEN_WIDTH - 1;

   1437  4 000101   000000 236000 xsym               LDQ     OC_PLATEN_WIDTH
         4 000102   000001 136007                    SBLQ    1,DL
         4 000103   000020 736000                    QLS     16
         4 000104   000012 676000 3                  ERQ     FPT_WRITE+4
         4 000105   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000106   000012 656000 3                  ERSQ    FPT_WRITE+4

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:26   
      135     1438    4                       CALL M$WRITE (FPT_WRITE) ALTRET(OOPS1);

   1438  4 000107   000006 630400 3                  EPPR0   FPT_WRITE
         4 000110   440001 713400                    CLIMB   alt,write
         4 000111   401400 401760                    pmme    nvectors=4
         4 000112   000113 702000 4                  TSX2    OOPS1

   1437  4 000113                       OOPS1        null
      136     1439    4   OOPS1:              ;
      137     1440    4                       FPT_WRITE.BUF_.BOUND = WSIZE - OC_PLATEN_WIDTH-1;

   1440  4 000113   200016 236100                    LDQ     WSIZE,,AUTO
         4 000114   000000 136000 xsym               SBLQ    OC_PLATEN_WIDTH
         4 000115   000001 136007                    SBLQ    1,DL
         4 000116   000020 736000                    QLS     16
         4 000117   000012 676000 3                  ERQ     FPT_WRITE+4
         4 000120   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000121   000012 656000 3                  ERSQ    FPT_WRITE+4

      138     1441    4                       FPT_WRITE.BUF_.BUF$=PINCRC(MESS$,OC_PLATEN_WIDTH);

   1441  4 000122   000000 236000 xsym               LDQ     OC_PLATEN_WIDTH
         4 000123   000020 736000                    QLS     16
         4 000124   200015 036100                    ADLQ    MESS$,,AUTO
         4 000125   000013 756000 3                  STQ     FPT_WRITE+5

      139     1442    4                       CALL M$WRITE (FPT_WRITE) ALTRET (OOPS2);

   1442  4 000126   000006 630400 3                  EPPR0   FPT_WRITE
         4 000127   440001 713400                    CLIMB   alt,write
         4 000130   401400 401760                    pmme    nvectors=4
         4 000131   000132 702000 4                  TSX2    OOPS2

   1441  4 000132                       OOPS2        null
      140     1443    4   OOPS2:              ;
      141     1444    4                       FPT_WRITE.BUF_.BOUND = WSIZE - 1;

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:27   
   1444  4 000132   200016 236100                    LDQ     WSIZE,,AUTO
         4 000133   000001 136007                    SBLQ    1,DL
         4 000134   000020 736000                    QLS     16
         4 000135   000012 676000 3                  ERQ     FPT_WRITE+4
         4 000136   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000137   000012 656000 3                  ERSQ    FPT_WRITE+4

      142     1445    4                       FPT_WRITE.BUF_.BUF$ = MESS$;

   1445  4 000140   200015 236100                    LDQ     MESS$,,AUTO
         4 000141   000013 756000 3                  STQ     FPT_WRITE+5

      143     1446    4                     END;                  /* DO IF SYSTEM (IOM CONS) */

   1446  4 000142   000154 710000 4                  TRA     IGNORE

      144     1447    3                  ELSE
      145     1448    3                       CALL M$WRITE (FPT_WRITE) ALTRET (IGNORE);

   1448  4 000143   000006 630400 3                  EPPR0   FPT_WRITE
         4 000144   440001 713400                    CLIMB   alt,write
         4 000145   401400 401760                    pmme    nvectors=4
         4 000146   000154 702000 4                  TSX2    IGNORE
         4 000147   000154 710000 4                  TRA     IGNORE

      146     1449    3             ELSE
      147     1450    3                  CALL M$WRITE (FPT_WRITE) ALTRET (IGNORE);

   1450  4 000150   000006 630400 3                  EPPR0   FPT_WRITE
         4 000151   440001 713400                    CLIMB   alt,write
         4 000152   401400 401760                    pmme    nvectors=4
         4 000153   000154 702000 4                  TSX2    IGNORE

   1446  4 000154                       IGNORE       null
      148     1451    3   IGNORE:   ;
      149     1452                                                /* Set the 'print the time' bit */
      150     1453    3             OC_CONSOLE.TRANSAC_LAST_MIN(I) = '1'B /*TRUE#*/;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:28   

   1453  4 000154   200010 236100                    LDQ     I,,AUTO
         4 000155   000076 402007                    MPY     62,DL
         4 000156   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000157   000000 620006                    EAX0    0,QL
         4 000160   020000 236007                    LDQ     8192,DL
         4 000161   000017 256110                    ORSQ    15,X0,PR0

      151     1454    3           END;

      152     1455    2        RETURN;

   1455  4 000162   200022 221300                    LDX1  ! J+1,,AUTO
         4 000163   000001 702211                    TSX2  ! 1,X1

      153     1456    2   BADDY: RETURN;                     /* BAD TEMPLATE DO NOT WRITE ANYTHING  */

   1456  4 000164   200022 221300       BADDY        LDX1  ! J+1,,AUTO
         4 000165   000001 702211                    TSX2  ! 1,X1

      154     1457    2   END WRITE;
      155     1458                                                /**/
      156     1459                                                /**/
      157     1460                                                /**/
      158     1461        /*
      159     1462             Begin       O C W $ W R I T E
      160     1463                                                                          */
      161     1464                                                /**/
      162     1465                                                /**/
      163     1466    1        IF SIZE = 0

   1466  4 000166   200004 470500                    LDP0    @SIZE,,AUTO
         4 000167   000100 100500                    MLR     fill='000'O
         4 000170   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 000171   200024 000004                    ADSC9   LAST+2,,AUTO             cn=0,n=4
         4 000172   200024 236100                    LDQ     LAST+2,,AUTO
         4 000173   000000 116003                    CMPQ    0,DU
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:29   
         4 000174   000176 601000 4                  TNZ     s:1470

      164     1467    1        THEN
      165     1468    1             RETURN;

   1468  4 000175   000000 702200 xent               TSX2  ! X66_ARET

      166     1469                                                /**/
      167     1470    1        LASTLANG = BINASC(0);

   1470  4 000176   000000 236003                    LDQ     0,DU
         4 000177   200017 756100                    STQ     LASTLANG,,AUTO

      168     1471    1        WSN_TEXT = ' ';

   1471  4 000200   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000201   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000202   000003 755000 3                  STA     WSN_TEXT
         4 000203   000004 756000 3                  STQ     WSN_TEXT+1

      169     1472    1        TERM_TEXT = ' ';

   1472  4 000204   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000205   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000206   000001 755000 3                  STA     TERM_TEXT
         4 000207   000002 756000 3                  STQ     TERM_TEXT+1

      170     1473    1        LOG_IT = '0'B;

   1473  4 000210   200013 450100                    STZ     LOG_IT,,AUTO

      171     1474    1        OC_CONSOLE.NATLANG (0) = BITASC('377'O); /* SET LANGUAGE BYTE  */

   1474  4 000211   000000 471400 xsym               LDP1    OC_CONSOLE$
         4 000212   000377 236007                    LDQ     255,DL
         4 000213   100017 552104                    STBQ    15,'04'O,PR1

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:30   
      172     1475    1        OC_CONSOLE.NEXT (0) = 0;

   1475  4 000214   000000 220003                    LDX0    0,DU
         4 000215   100016 740100                    STX0    14,,PR1

      173     1476    1        MESS$ = ADDR(MESS);

   1476  4 000216   200003 236100                    LDQ     @MESS,,AUTO
         4 000217   200015 756100                    STQ     MESS$,,AUTO

      174     1477    1        WSIZE = SIZE;

   1477  4 000220   000100 100500                    MLR     fill='000'O
         4 000221   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4
         4 000222   200016 000004                    ADSC9   WSIZE,,AUTO              cn=0,n=4

      175     1478    1        FPT_WRITE.BUF_.BOUND = WSIZE - 1;

   1478  4 000223   200016 236100                    LDQ     WSIZE,,AUTO
         4 000224   000001 136007                    SBLQ    1,DL
         4 000225   000020 736000                    QLS     16
         4 000226   000012 676000 3                  ERQ     FPT_WRITE+4
         4 000227   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000230   000012 656000 3                  ERSQ    FPT_WRITE+4

      176     1479    1        FPT_WRITE.BUF_.BUF$ = ADDR (MESS);

   1479  4 000231   200003 236100                    LDQ     @MESS,,AUTO
         4 000232   000013 756000 3                  STQ     FPT_WRITE+5

      177     1480                                           /* If console direct address is
      178     1481                                                specified, write on that
      179     1482                                                console only */
      180     1483                                           /* Note that this test checks to
      181     1484                                                see if the Console Direct
      182     1485                                                Address Bit is set AND
      183     1486                                                coincidentally checks to see
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:31   
      184     1487                                                if this direct write was the
      185     1488                                                result of an Internal keyin.
      186     1489                                                If it was the result of an
      187     1490                                                internal keyin, the test fails
      188     1491                                                and is treated like an
      189     1492                                                attribute write to SYSTEM
      190     1493                                                consoles  */
      191     1494    1        IF (CADDR & ~'177777'O) = OC_DIR

   1494  4 000233   200005 473500                    LDP3    @CADDR,,AUTO
         4 000234   000100 100500                    MLR     fill='000'O
         4 000235   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         4 000236   200024 000004                    ADSC9   LAST+2,,AUTO             cn=0,n=4
         4 000237   200024 236100                    LDQ     LAST+2,,AUTO
         4 000240   600000 376003                    ANQ     -65536,DU
         4 000241   200025 756100                    STQ     LAST+3,,AUTO
         4 000242   000000 106500                    CMPC    fill='000'O
         4 000243   200025 000004                    ADSC9   LAST+3,,AUTO             cn=0,n=4
         4 000244   000000 000002 xsym               ADSC9   OC_DIR                   cn=0,n=2
         4 000245   000360 601000 4                  TNZ     s:1533

      192     1495    1        THEN
      193     1496    2        DO;

      194     1497    2             TEMP.B = CADDR & '377777'O;

   1497  4 000246   000100 100500                    MLR     fill='000'O
         4 000247   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         4 000250   200024 000004                    ADSC9   LAST+2,,AUTO             cn=0,n=4
         4 000251   200024 236100                    LDQ     LAST+2,,AUTO
         4 000252   377777 376003                    ANQ     131071,DU
         4 000253   000022 772000                    QRL     18
         4 000254   000000 621006                    EAX1    0,QL
         4 000255   200014 741100                    STX1    TEMP,,AUTO

      195     1498    3             DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:32   
   1498  4 000256   000001 236007                    LDQ     1,DL
         4 000257   200010 756100                    STQ     I,,AUTO
         4 000260   000353 710000 4                  TRA     s:1523+3

      196     1499    3                  IF OC_CONSOLE.ACTIVE(I)

   1499  4 000261   200010 236100                    LDQ     I,,AUTO
         4 000262   000076 402007                    MPY     62,DL
         4 000263   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000264   000017 236106                    LDQ     15,QL,PR0
         4 000265   010000 316007                    CANQ    4096,DL
         4 000266   000350 600000 4                  TZE     s:1523

      197     1500    3                  THEN
      198     1501    3                       IF OC_CONSOLE.CID(I) = TEMP.U

   1501  4 000267   200010 236100                    LDQ     I,,AUTO
         4 000270   000076 402007                    MPY     62,DL
         4 000271   000012 220106                    LDX0    10,QL,PR0
         4 000272   200014 100100                    CMPX0   TEMP,,AUTO
         4 000273   000350 601000 4                  TNZ     s:1523

      199     1502    3                       THEN
      200     1503    4                       DO;

      201     1504    4                            CALL WRITE;

   1504  4 000274   000003 701000 4                  TSX1    WRITE
         4 000275   000000 011000                    NOP     0

      202     1505    4                            IF OC_LIST

   1505  4 000276   000000 234000 xsym               SZN     OC_LIST
         4 000277   000344 605000 4                  TPL     s:1521

      203     1506    4                            THEN
      204     1507    5                            DO;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:33   

      205     1508    5                                 IF ADDR(MSG#) = ADDR(NIL)

   1508  4 000300   200007 236100                    LDQ     @MSG#,,AUTO
         4 000301   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000302   000324 601000 4                  TNZ     s:1516

      206     1509    5                                 THEN
      207     1510    6                                 DO;

      208     1511    6                                      CALL OCL$LISTIT (CADDR, 0 /* OCI_OUTPUT# */,
              1511                                               MESSAGE#,

   1511  4 000303   200003 236100                    LDQ     @MESS,,AUTO
         4 000304   200032 756100                    STQ     LAST+8,,AUTO
         4 000305   200004 236100                    LDQ     @SIZE,,AUTO
         4 000306   200031 756100                    STQ     LAST+7,,AUTO
         4 000307   200010 630500                    EPPR0   I,,AUTO
         4 000310   200030 450500                    STP0    LAST+6,,AUTO
         4 000311   200006 236100                    LDQ     @WSN,,AUTO
         4 000312   000003 235000 5                  LDA     3
         4 000313   200026 757100                    STAQ    LAST+4,,AUTO
         4 000314   000004 236000 5                  LDQ     4
         4 000315   200005 235100                    LDA     @CADDR,,AUTO
         4 000316   200024 757100                    STAQ    LAST+2,,AUTO
         4 000317   200024 630500                    EPPR0   LAST+2,,AUTO
         4 000320   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 000321   000000 701000 xent               TSX1    OCL$LISTIT
         4 000322   000000 011000                    NOP     0

      209     1512    6                                           WSN, I, SIZE, MESS, ,);
      210     1513    6                                    END;

   1513  4 000323   000344 710000 4                  TRA     s:1521

      211     1514    5                                 ELSE
      212     1515    6                                 DO;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:34   

      213     1516    6                                     CALL OCL$LISTIT (CADDR, 0 /* OCI_OUTPUT# */, MSG#
              1516                                               ,

   1516  4 000324   200003 236100                    LDQ     @MESS,,AUTO
         4 000325   200032 756100                    STQ     LAST+8,,AUTO
         4 000326   200004 236100                    LDQ     @SIZE,,AUTO
         4 000327   200031 756100                    STQ     LAST+7,,AUTO
         4 000330   200010 630500                    EPPR0   I,,AUTO
         4 000331   200030 450500                    STP0    LAST+6,,AUTO
         4 000332   200006 236100                    LDQ     @WSN,,AUTO
         4 000333   200007 235100                    LDA     @MSG#,,AUTO
         4 000334   200026 757100                    STAQ    LAST+4,,AUTO
         4 000335   000004 236000 5                  LDQ     4
         4 000336   200005 235100                    LDA     @CADDR,,AUTO
         4 000337   200024 757100                    STAQ    LAST+2,,AUTO
         4 000340   200024 630500                    EPPR0   LAST+2,,AUTO
         4 000341   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 000342   000000 701000 xent               TSX1    OCL$LISTIT
         4 000343   000000 011000                    NOP     0

      214     1517    6                                           WSN, I, SIZE, MESS, ,);
      215     1518    6                                    END;   /* DO IF NOT ADDR(NIL) */

      216     1519    5                               END;        /* DO IF LISTING ON */

      217     1520                                                /**/
      218     1521    4                            I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   1521  4 000344   000000 235000 xsym               LDA     OC_MAXCONSOLE
         4 000345   000022 771000                    ARL     18
         4 000346   000001 035007                    ADLA    1,DL
         4 000347   200010 755100                    STA     I,,AUTO

      219     1522    4                          END;             /* DO (if found) */

      220     1523    3                END;                       /* DO I=0 TO 71 */
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:35   

   1523  4 000350   200010 235100                    LDA     I,,AUTO
         4 000351   000001 035007                    ADLA    1,DL
         4 000352   200010 755100                    STA     I,,AUTO
         4 000353   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000354   000022 772000                    QRL     18
         4 000355   200010 116100                    CMPQ    I,,AUTO
         4 000356   000261 603000 4                  TRC     s:1499

      221     1524    2           END;                            /* DO IF direct addressed */

   1524  4 000357   000574 710000 4                  TRA     s:1691

      222     1525                                                /**/
      223     1526                                                /**/
      224     1527        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:36   
      225     1528    1        ELSE
      226     1529                                                /**/
      227     1530                                                /**/
      228     1531                                                /* Must be attribute addressed */
      229     1532    2        DO;

      230     1533    2             TEMP.B = CADDR;

   1533  4 000360   000100 100500                    MLR     fill='000'O
         4 000361   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         4 000362   200014 000002                    ADSC9   TEMP,,AUTO               cn=0,n=2

      231     1534                                           /* For now -- if the passed msg is
      232     1535                                                not a device msg, then it might
      233     1536                                                be for local. If the passed wsn
      234     1537                                                is blanks, it should be zeroed
      235     1538                                                prior to search           */
      236     1539                                                /**/
      237     1540    2             IF (TEMP.B & ~'100000'O /* M_DEVC  */)

   1540  4 000363   200014 221100                    LDX1    TEMP,,AUTO
         4 000364   677777 361003                    ANX1    -32769,DU
         4 000365   000376 600000 4                  TZE     s:1555
         4 000366   200006 474500                    LDP4    @WSN,,AUTO
         4 000367   040000 106500                    CMPC    fill='040'O
         4 000370   400000 000004                    ADSC9   0,,PR4                   cn=0,n=4
         4 000371   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000372   000376 601000 4                  TNZ     s:1555

      238     1541    2                  AND
      239     1542    2                  (WSN.FIRST_HALF = ' ')
      240     1543    2             THEN
      241     1544    2                  WSN.FIRST_HALF = '0000';

   1544  4 000373   040100 100400                    MLR     fill='040'O
         4 000374   000002 000004 1                  ADSC9   2                        cn=0,n=4
         4 000375   400000 000004                    ADSC9   0,,PR4                   cn=0,n=4
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:37   

      242     1545                                                /**/
      243     1546                                                /**/
      244     1547                                           /* Scan the console table --
      245     1548                                                if addressed by WSN/DEVNM,
      246     1549                                                an additional check is made
      247     1550                                                to be sure that the message is
      248     1551                                                for the right console */
      249     1552                                                /**/
      250     1553                                           /* Also, all non-device messages are
      251     1554                                                sent to the system console */
      252     1555    2             OC_CONSOLE.NATLANG (0) = BITASC('377'O); /* SET LANGUAGE BYTE  */

   1555  4 000376   000000 471400 xsym               LDP1    OC_CONSOLE$
         4 000377   000377 236007                    LDQ     255,DL
         4 000400   100017 552104                    STBQ    15,'04'O,PR1

      253     1556    2             OC_CONSOLE.NEXT (0) = 0;

   1556  4 000401   100016 740100                    STX0    14,,PR1

      254     1557    3             DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   1557  4 000402   000001 235007                    LDA     1,DL
         4 000403   200010 755100                    STA     I,,AUTO
         4 000404   000566 710000 4                  TRA     s:1669+3

      255     1558                                                /**/
      256     1559                                           /* Save the console attribute for
      257     1560                                              which this message is intended. */
      258     1561                                                /**/
      259     1562    3                  TEMP.B = CADDR;

   1562  4 000405   200005 470500                    LDP0    @CADDR,,AUTO
         4 000406   000100 100500                    MLR     fill='000'O
         4 000407   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         4 000410   200014 000002                    ADSC9   TEMP,,AUTO               cn=0,n=2
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:38   

      260     1563    3                  IF OC_CONSOLE.ACTIVE(I)

   1563  4 000411   200010 236100                    LDQ     I,,AUTO
         4 000412   000076 402007                    MPY     62,DL
         4 000413   000000 471400 xsym               LDP1    OC_CONSOLE$
         4 000414   100017 236106                    LDQ     15,QL,PR1
         4 000415   010000 316007                    CANQ    4096,DL
         4 000416   000563 600000 4                  TZE     s:1669

      261     1564    3                  THEN
      262     1565    4                  DO;

      263     1566                                                /**/
      264     1567                                                /* Is this a SYSTEM console? */
      265     1568    4                       IF ('200000'O /* M_SYS  */ & OC_CONSOLE.ATTR_OUTPUT(I))

   1568  4 000417   200010 236100                    LDQ     I,,AUTO
         4 000420   000076 402007                    MPY     62,DL
         4 000421   100014 220106                    LDX0    12,QL,PR1
         4 000422   200000 360003                    ANX0    65536,DU
         4 000423   000475 600000 4                  TZE     s:1626

      266     1569    4                       THEN
      267     1570    5                       DO;

      268     1571                                           /* Is there a deliberate request to
      269     1572                                              skip SYSTEM consoles?  */
      270     1573    5                            IF TEMP.B & '000040'O /* M_NONSYS */

   1573  4 000424   200014 220100                    LDX0    TEMP,,AUTO
         4 000425   000040 360003                    ANX0    32,DU
         4 000426   000474 601000 4                  TNZ     SKIP_IT

      271     1574    5                            THEN
      272     1575    5                                 GOTO SKIP_IT;
      273     1576                                                /**/
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:39   
      274     1577                                           /* If its a device message, and the
      275     1578                                              TWSN is  station LOCAL, allow the
      276     1579                                              write. */
      277     1580                                                /**/
      278     1581    5                            IF TEMP.B & '100000'O /* M_DEVC  */

   1581  4 000427   200014 220100                    LDX0    TEMP,,AUTO
         4 000430   100000 360003                    ANX0    32768,DU
         4 000431   000437 600000 4                  TZE     s:1587

      279     1582    5                            THEN
      280     1583    5                                 IF WSN.SECND_HALF ~= '0000'

   1583  4 000432   200006 473500                    LDP3    @WSN,,AUTO
         4 000433   040000 106500                    CMPC    fill='040'O
         4 000434   300001 000004                    ADSC9   1,,PR3                   cn=0,n=4
         4 000435   000002 000004 1                  ADSC9   2                        cn=0,n=4
         4 000436   000474 601000 4                  TNZ     SKIP_IT

      281     1584    5                                 THEN
      282     1585    5                                      GOTO SKIP_IT;
      283     1586                                                /**/
      284     1587    5                            TERM_TEXT = OC_CONSOLE.TERM_NAME (I);

   1587  4 000437   200010 236100                    LDQ     I,,AUTO
         4 000440   000370 402007                    MPY     248,DL
         4 000441   040000 100506                    MLR     fill='040'O
         4 000442   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         4 000443   000001 000010 3                  ADSC9   TERM_TEXT                cn=0,n=8

      285     1588                                           /* If the message is ADMIN and the
      286     1589                                              workstation matches, do the write
      287     1590                                              and use the passed workstation.
      288     1591                                              Otherwise, do the write and use
      289     1592                                              the workstation from the console
      290     1593                                              table. */
      291     1594                                                /**/
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:40   
      292     1595                                                /**/
      293     1596    5                            IF TEMP.B & '040000'O /* M_ADMIN */

   1596  4 000444   200014 220100                    LDX0    TEMP,,AUTO
         4 000445   040000 360003                    ANX0    16384,DU
         4 000446   000465 600000 4                  TZE     s:1607

      294     1597    5                            THEN
      295     1598    6                            DO;

      296     1599    6                                 CALL INDEX (J, '?', OC_CONSOLE.WSN(I));

   1599  4 000447   000000 124506                    SCM     mask='000'O
         4 000450   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         4 000451   000005 000001 5                  ADSC9   5                        cn=0,n=1
         4 000452   200011 000100                    ARG     J,,AUTO

      297     1600    6                                 IF SUBSTR (OC_CONSOLE.WSN(I), 0, J)

   1600  4 000453   200011 720100                    LXL0    J,,AUTO
         4 000454   200006 473500                    LDP3    @WSN,,AUTO
         4 000455   040140 106546                    CMPC    fill='040'O
         4 000456   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=*X0
         4 000457   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         4 000460   000474 601000 4                  TNZ     SKIP_IT

      298     1601    6                                      ~= SUBSTR (WORKSTATION, 0, J)
      299     1602    6                                 THEN
      300     1603    6                                      GOTO SKIP_IT;
      301     1604    6                                 WSN_TEXT = WORKSTATION;

   1604  4 000461   040000 100500                    MLR     fill='040'O
         4 000462   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         4 000463   000003 000010 3                  ADSC9   WSN_TEXT                 cn=0,n=8

      302     1605    6                               END;

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:41   
   1605  4 000464   000470 710000 4                  TRA     s:1610

      303     1606    5                            ELSE
      304     1607    5                                 WSN_TEXT = OC_CONSOLE.WSN(I);

   1607  4 000465   040000 100506                    MLR     fill='040'O
         4 000466   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         4 000467   000003 000010 3                  ADSC9   WSN_TEXT                 cn=0,n=8

      305     1608                                                /**/
      306     1609                                                /**/
      307     1610    5                            CALL ORDER;    /* ORDER THE WRITE */

   1610  4 000470   000661 701000 4                  TSX1    ORDER
         4 000471   000000 011000                    NOP     0

      308     1611    5                            LOG_IT = '1'B; /* This prevents accidental logging

   1611  4 000472   400000 236003                    LDQ     -131072,DU
         4 000473   200013 756100                    STQ     LOG_IT,,AUTO

   1611  4 000474                       SKIP_IT      null
      309     1612                                          by code that goes to SKIP_IT */
      310     1613    5   SKIP_IT:                 ;
      311     1614    5                          END;             /* DO IF SYS CONS */

   1614  4 000474   000563 710000 4                  TRA     s:1669

      312     1615                                                /**/
      313     1616        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:42   
      314     1617    4                       ELSE
      315     1618    5                       DO;

      316     1619                                                /**/
      317     1620                                           /* If its a device console message,
      318     1621                                              check if the TWSN of the message
      319     1622                                              matches that of the console. If
      320     1623                                              so save the WSN and TWSN. If not
      321     1624                                              mask out the DEVC bit. */
      322     1625                                                /**/
      323     1626    5                            IF TEMP.B & '100000'O /* M_DEVC  */

   1626  4 000475   200014 220100                    LDX0    TEMP,,AUTO
         4 000476   100000 360003                    ANX0    32768,DU
         4 000477   000521 600000 4                  TZE     s:1646

      324     1627    5                            THEN
      325     1628    5                                 IF OC_CONSOLE.STATIONR.SECND_HALF(I) ~=

   1628  4 000500   200010 236100                    LDQ     I,,AUTO
         4 000501   000370 402007                    MPY     248,DL
         4 000502   200006 473500                    LDP3    @WSN,,AUTO
         4 000503   040100 106506                    CMPC    fill='040'O
         4 000504   100001 000004                    ADSC9   1,Q,PR1                  cn=0,n=4
         4 000505   300001 000004                    ADSC9   1,,PR3                   cn=0,n=4
         4 000506   000513 600000 4                  TZE     s:1634

      326     1629    5                                      WSN.SECND_HALF
      327     1630    5                                 THEN
      328     1631    5                                      TEMP.B = TEMP.B & (~ '100000'O /* M_DEVC  */);

   1631  4 000507   200014 220100                    LDX0    TEMP,,AUTO
         4 000510   677777 360003                    ANX0    -32769,DU
         4 000511   200014 740100                    STX0    TEMP,,AUTO
         4 000512   000521 710000 4                  TRA     s:1646

      329     1632    5                                 ELSE
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:43   
      330     1633    6                                 DO;

      331     1634    6                                      TERM_TEXT = OC_CONSOLE.TERM_NAME(I);

   1634  4 000513   040000 100506                    MLR     fill='040'O
         4 000514   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         4 000515   000001 000010 3                  ADSC9   TERM_TEXT                cn=0,n=8

      332     1635    6                                      WSN_TEXT = OC_CONSOLE.WSN(I);

   1635  4 000516   040000 100506                    MLR     fill='040'O
         4 000517   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         4 000520   000003 000010 3                  ADSC9   WSN_TEXT                 cn=0,n=8

      333     1636    6                                    END;

      334     1637                                                /**/
      335     1638                                                /**/
      336     1639                                                /**/
      337     1640                                           /* If its an ADMIN message, check
      338     1641                                              if WSN in the message matches
      339     1642                                              that of the console.  If so save
      340     1643                                              the passed WSN. If not, mask out
      341     1644                                              the ADMIN bit. */
      342     1645                                                /**/
      343     1646    5                            IF TEMP.B & '040000'O /* M_ADMIN */

   1646  4 000521   200014 220100                    LDX0    TEMP,,AUTO
         4 000522   040000 360003                    ANX0    16384,DU
         4 000523   000552 600000 4                  TZE     s:1661

      344     1647    5                            THEN
      345     1648    6                            DO;

      346     1649    6                                 CALL INDEX(J,'?',OC_CONSOLE.WSN(I));

   1649  4 000524   200010 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:44   
         4 000525   000370 402007                    MPY     248,DL
         4 000526   000000 124506                    SCM     mask='000'O
         4 000527   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         4 000530   000005 000001 5                  ADSC9   5                        cn=0,n=1
         4 000531   200011 000100                    ARG     J,,AUTO

      347     1650    6                                IF SUBSTR(OC_CONSOLE.WSN(I),0,J) ~= SUBSTR(WORKSTATION
              1650                                          ,0,J)

   1650  4 000532   200011 720100                    LXL0    J,,AUTO
         4 000533   200006 473500                    LDP3    @WSN,,AUTO
         4 000534   040140 106546                    CMPC    fill='040'O
         4 000535   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=*X0
         4 000536   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         4 000537   000544 600000 4                  TZE     s:1655

      348     1651    6                                 THEN
      349     1652    6                                      TEMP.B = TEMP.B & (~ '040000'O /* M_ADMIN */);

   1652  4 000540   200014 221100                    LDX1    TEMP,,AUTO
         4 000541   737777 361003                    ANX1    -16385,DU
         4 000542   200014 741100                    STX1    TEMP,,AUTO
         4 000543   000552 710000 4                  TRA     s:1661

      350     1653    6                                 ELSE
      351     1654    7                                 DO;

      352     1655    7                                      TERM_TEXT = OC_CONSOLE.TERM_NAME(I);

   1655  4 000544   040000 100506                    MLR     fill='040'O
         4 000545   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         4 000546   000001 000010 3                  ADSC9   TERM_TEXT                cn=0,n=8

      353     1656    7                                      WSN_TEXT = WORKSTATION;

   1656  4 000547   040000 100500                    MLR     fill='040'O
         4 000550   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:45   
         4 000551   000003 000010 3                  ADSC9   WSN_TEXT                 cn=0,n=8

      354     1657    7                                    END;

      355     1658    6                               END;

      356     1659                                                /**/
      357     1660                                                /**/
      358     1661    5                            IF OC_CONSOLE.ATTR_OUTPUT(I) & TEMP.B

   1661  4 000552   200010 236100                    LDQ     I,,AUTO
         4 000553   000076 402007                    MPY     62,DL
         4 000554   100014 220106                    LDX0    12,QL,PR1
         4 000555   200014 360100                    ANX0    TEMP,,AUTO
         4 000556   000563 600000 4                  TZE     s:1669

      359     1662    5                            THEN
      360     1663    6                            DO;

      361     1664    6                                 CALL ORDER; /* ORDER THE WRITE */

   1664  4 000557   000661 701000 4                  TSX1    ORDER
         4 000560   000000 011000                    NOP     0

      362     1665    6                                 LOG_IT = '1'B; /* Only log if we call order */

   1665  4 000561   400000 236003                    LDQ     -131072,DU
         4 000562   200013 756100                    STQ     LOG_IT,,AUTO

      363     1666    6                               END;

      364     1667    5                          END;             /* DO IF NON_SYS CONS */

      365     1668    4                     END;                  /* DO IF ACTIVE */

      366     1669    3                END;                       /* DO I = 0 TO 71 */

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:46   
   1669  4 000563   200010 235100                    LDA     I,,AUTO
         4 000564   000001 035007                    ADLA    1,DL
         4 000565   200010 755100                    STA     I,,AUTO
         4 000566   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         4 000567   000022 772000                    QRL     18
         4 000570   200010 116100                    CMPQ    I,,AUTO
         4 000571   000405 603000 4                  TRC     s:1562

      367     1670                                                /**/
      368     1671    2             CALL WRITEO;                  /* WRITE ANY MESSAGES SAVED */

   1671  4 000572   000726 701000 4                  TSX1    WRITEO
         4 000573   000000 011000                    NOP     0

      369     1672                                                /**/
      370     1673    2           END;                            /* Do if attribute addressed */

      371     1674                                                /**/
      372     1675                                           /* Write to :OCHIST must take
      373     1676                                                place after write to consoles
      374     1677                                                so that the data saved in
      375     1678                                                OCO$IWRITE is not clobbered
      376     1679                                                by possible altrets in
      377     1680                                                OCL$LISTIT. */
      378     1681                                                /**/
      379     1682                                                /**/
      380     1683                                      /* Note that the level on this is a
      381     1684                                         2.  This means there will be a write
      382     1685                                         to :OCHIST for every console we
      383     1686                                         locate.  This is necessary because
      384     1687                                         it allows REPLAY users to select by
      385     1688                                         WSN and thus see a true replay of
      386     1689                                         activity. */
      387     1690                                                /**/
      388     1691    1        IF OC_LIST AND LOG_IT = '1'B

   1691  4 000574   000000 234000 xsym               SZN     OC_LIST
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:47   
         4 000575   000660 605000 4                  TPL     s:1710
         4 000576   200013 234100                    SZN     LOG_IT,,AUTO
         4 000577   000660 605000 4                  TPL     s:1710

      389     1692    1        THEN
      390     1693    2        DO;

      391     1694    2             LOG_IT = '0'B;

   1694  4 000600   200013 450100                    STZ     LOG_IT,,AUTO

      392     1695    2             IF ADDR(MSG#) = ADDR(NIL)

   1695  4 000601   200007 236100                    LDQ     @MSG#,,AUTO
         4 000602   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000603   000632 601000 4                  TNZ     s:1704

      393     1696    2             THEN
      394     1697    3             DO;

      395     1698    3                  CALL OCL$LISTIT (CADDR, 0 /* OCI_OUTPUT# */, MESSAGE#,

   1698  4 000604   000000 235000 xsym               LDA     OC_MAXCONSOLE
         4 000605   000022 771000                    ARL     18
         4 000606   000001 035007                    ADLA    1,DL
         4 000607   200024 755100                    STA     LAST+2,,AUTO
         4 000610   000010 237000 5                  LDAQ    8
         4 000611   200034 757100                    STAQ    LAST+10,,AUTO
         4 000612   200003 236100                    LDQ     @MESS,,AUTO
         4 000613   200004 235100                    LDA     @SIZE,,AUTO
         4 000614   200032 757100                    STAQ    LAST+8,,AUTO
         4 000615   200024 630500                    EPPR0   LAST+2,,AUTO
         4 000616   200031 450500                    STP0    LAST+7,,AUTO
         4 000617   200006 236100                    LDQ     @WSN,,AUTO
         4 000620   200030 756100                    STQ     LAST+6,,AUTO
         4 000621   000012 237000 5                  LDAQ    10
         4 000622   200026 757100                    STAQ    LAST+4,,AUTO
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:48   
         4 000623   200005 236100                    LDQ     @CADDR,,AUTO
         4 000624   200025 756100                    STQ     LAST+3,,AUTO
         4 000625   200025 630500                    EPPR0   LAST+3,,AUTO
         4 000626   000006 631400 5                  EPPR1   6
         4 000627   000000 701000 xent               TSX1    OCL$LISTIT
         4 000630   000000 011000                    NOP     0

      396     1699    3                       WSN, OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */, SIZE,
      397     1700    3                       MESS, TERM_TEXT, WSN_TEXT);
      398     1701    3                END;

   1701  4 000631   000660 710000 4                  TRA     s:1710

      399     1702    2             ELSE
      400     1703    3             DO;

      401     1704    3                  CALL OCL$LISTIT (CADDR, 0 /* OCI_OUTPUT# */,

   1704  4 000632   000000 235000 xsym               LDA     OC_MAXCONSOLE
         4 000633   000022 771000                    ARL     18
         4 000634   000001 035007                    ADLA    1,DL
         4 000635   200024 755100                    STA     LAST+2,,AUTO
         4 000636   000010 237000 5                  LDAQ    8
         4 000637   200034 757100                    STAQ    LAST+10,,AUTO
         4 000640   200003 236100                    LDQ     @MESS,,AUTO
         4 000641   200004 235100                    LDA     @SIZE,,AUTO
         4 000642   200032 757100                    STAQ    LAST+8,,AUTO
         4 000643   200024 630500                    EPPR0   LAST+2,,AUTO
         4 000644   200031 450500                    STP0    LAST+7,,AUTO
         4 000645   200006 236100                    LDQ     @WSN,,AUTO
         4 000646   200030 756100                    STQ     LAST+6,,AUTO
         4 000647   200007 236100                    LDQ     @MSG#,,AUTO
         4 000650   000004 235000 5                  LDA     4
         4 000651   200026 757100                    STAQ    LAST+4,,AUTO
         4 000652   200005 236100                    LDQ     @CADDR,,AUTO
         4 000653   200025 756100                    STQ     LAST+3,,AUTO
         4 000654   200025 630500                    EPPR0   LAST+3,,AUTO
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:49   
         4 000655   000006 631400 5                  EPPR1   6
         4 000656   000000 701000 xent               TSX1    OCL$LISTIT
         4 000657   000000 011000                    NOP     0

      402     1705    3                       MSG#, WSN, OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */,
      403     1706    3                       SIZE, MESS, TERM_TEXT, WSN_TEXT);
      404     1707    3                END;                       /* DO IF NOT ADDR (NIL) */

      405     1708    2           END;                            /* DO IF LISTING ON */

      406     1709                                                /**/
      407     1710    1        RETURN;

   1710  4 000660   000000 702200 xent               TSX2  ! X66_ARET

      408     1711                                                /**/
      409     1712        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:50   
      410     1713                            /*
      411     1714                                 Internal routine ORDER will sort the
      412     1715                                 writes to consoles so the language will
      413     1716                                 always be written in order. This saves
      414     1717                                 extra I/O's to get the same template more
      415     1718                                 than once.
      416     1719                                                      */
      417     1720    1   ORDER: PROC ;

   1720  4 000661   200020 741300       ORDER        STX1  ! LASTLANG+1,,AUTO

      418     1721                                                /**/
      419     1722    2   DCL J SBIN WORD;
      420     1723    2   DCL LAST SBIN WORD;
      421     1724                                                /**/
      422     1725    2        J = OC_CONSOLE.NEXT(0);            /* GET FIRST ENTRY */

   1725  4 000662   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000663   000016 236100                    LDQ     14,,PR0
         4 000664   000022 772000                    QRL     18
         4 000665   200021 756100                    STQ     J,,AUTO

      423     1726    2        LAST = 0;

   1726  4 000666   200022 450100                    STZ     LAST,,AUTO

      424     1727                                                /**/
      425     1728                                                /**/
      426     1729    3        DO WHILE (J ~= 0 AND OC_CONSOLE.NATLANG(J) > OC_CONSOLE.NATLANG(I));

   1729  4 000667   000700 710000 4                  TRA     s:1732

      427     1730    3             LAST = J;                     /* SAVE LAST ENTRY WE LOOKED AT */

   1730  4 000670   200021 235100                    LDA     J,,AUTO
         4 000671   200022 755100                    STA     LAST,,AUTO

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:51   
      428     1731    3             J = OC_CONSOLE.NEXT(J);       /* POINT TO NEXT ENTRY */

   1731  4 000672   200021 236100                    LDQ     J,,AUTO
         4 000673   000076 402007                    MPY     62,DL
         4 000674   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000675   000016 236106                    LDQ     14,QL,PR0
         4 000676   000022 772000                    QRL     18
         4 000677   200021 756100                    STQ     J,,AUTO

      429     1732    3           END;

   1732  4 000700   000713 600000 4                  TZE     s:1737
         4 000701   200010 236100                    LDQ     I,,AUTO
         4 000702   000370 402007                    MPY     248,DL
         4 000703   200024 756100                    STQ     LAST+2,,AUTO
         4 000704   200021 236100                    LDQ     J,,AUTO
         4 000705   000370 402007                    MPY     248,DL
         4 000706   200024 235100                    LDA     LAST+2,,AUTO
         4 000707   040106 106505                    CMPC    fill='040'O
         4 000710   000017 600001                    ADSC9   15,A,PR0                 cn=3,n=1
         4 000711   000017 600001                    ADSC9   15,Q,PR0                 cn=3,n=1
         4 000712   000670 602000 4                  TNC     s:1730

      430     1733                                                /*
      431     1734                                                     We no have the positon
      432     1735                                                     so we will insert this console
      433     1736                                                           */
      434     1737    2        OC_CONSOLE.NEXT(LAST) = I;         /* POINT LAST ENTRY TO NEW */

   1737  4 000713   200022 236100                    LDQ     LAST,,AUTO
         4 000714   000076 402007                    MPY     62,DL
         4 000715   200010 720100                    LXL0    I,,AUTO
         4 000716   000016 740106                    STX0    14,QL,PR0

      435     1738    2        OC_CONSOLE.NEXT(I) = J;            /* POINT NEW ENRY TO NEXT ONE */

   1738  4 000717   200010 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:52   
         4 000720   000076 402007                    MPY     62,DL
         4 000721   200021 720100                    LXL0    J,,AUTO
         4 000722   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000723   000016 740106                    STX0    14,QL,PR0

      436     1739    2        RETURN;

   1739  4 000724   200020 221300                    LDX1  ! LASTLANG+1,,AUTO
         4 000725   000001 702211                    TSX2  ! 1,X1

      437     1740    2   END ORDER;
      438     1741        %EJECT;
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:53   
      439     1742                            /* Internal proc WRITEO will write the messages
      440     1743                                 in the order specified in ORDER_TAB
      441     1744                                       */
      442     1745    1   WRITEO: PROC;

   1745  4 000726   200020 741300       WRITEO       STX1  ! LASTLANG+1,,AUTO

      443     1746                                                /**/
      444     1747    2        I = OC_CONSOLE.NEXT(0);            /* GET FIRST ENTRY */

   1747  4 000727   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000730   000016 236100                    LDQ     14,,PR0
         4 000731   000022 772000                    QRL     18
         4 000732   200010 756100                    STQ     I,,AUTO

      445     1748                                                /**/
      446     1749    3        DO WHILE (I ~= 0);

   1749  4 000733   000745 600000 4                  TZE     s:1753

      447     1750    3             CALL WRITE;

   1750  4 000734   000003 701000 4                  TSX1    WRITE
         4 000735   000000 011000                    NOP     0

      448     1751    3             I = OC_CONSOLE.NEXT(I);       /* GET NEXT ENTRY */

   1751  4 000736   200010 236100                    LDQ     I,,AUTO
         4 000737   000076 402007                    MPY     62,DL
         4 000740   000000 470400 xsym               LDP0    OC_CONSOLE$
         4 000741   000016 236106                    LDQ     14,QL,PR0
         4 000742   000022 772000                    QRL     18
         4 000743   200010 756100                    STQ     I,,AUTO

      449     1752    3           END;                            /* END WRITE LOOP */

   1752  4 000744   000734 601000 4                  TNZ     s:1750
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:54   

      450     1753    2        RETURN;                            /* FINISHED WRITING */

   1753  4 000745   200020 221300                    LDX1  ! LASTLANG+1,,AUTO
         4 000746   000001 702211                    TSX2  ! 1,X1
      451     1754    2   END WRITEO;
      452     1755    1   END OCW$WRITE;

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:55   
--  Include file information  --

   KC_ERRORS_C.:E05TOU  is referenced.
   OCM_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OUT_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCW$WRITE.
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:56   

 **** Variables and constants ****

  ****  Section 003  Data  OCW$WRITE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/d STRC(432)   r     1 FPT_WRITE                 22-0-0/w STRC(288)   r     1 KSTA
     0-0-0/b UBIN(18)    r     1 MESSAGE#                   1-0-0/c CHAR(8)     r     1 TERM_TEXT
     3-0-0/c CHAR(8)     r     1 WSN_TEXT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @CADDR                     3-0-0/w PTR         r     1 @MESS
     7-0-0/w PTR         r     1 @MSG#                      4-0-0/w PTR         r     1 @SIZE
     6-0-0/w PTR         r     1 @WSN                      *0-0-0/c BIT (18)    r     1 CADDR
    10-0-0/w UBIN        r     1 I                         11-0-0/w SBIN        r     1 J
    21-0-0/w SBIN        r     1 J                         22-0-0/w SBIN        r     1 LAST
    17-0-0/c CHAR        r     1 LASTLANG                  13-0-0/b BIT         r     1 LOG_IT
    *0-0-0/c ACHR        r     1 MESS                      15-0-0/w PTR         r     1 MESS$
    *0-0-0/c UBIN(18)    r     1 MSG#                      *0-0-0/c UBIN        r     1 SIZE
    14-0-0/b STRC(18)    r     1 TEMP                      *0-0-0/c CHAR(8)     r     1 WORKSTATION
    16-0-0/w SBIN        r     1 WSIZE                     *0-0-0/c STRC(72)    r     1 WSN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OCM_BPOSN                  0-0-0/c CHAR(256)   r     1 OCM_BUFFER
     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/w BIT (18)    r     1 OC_DIR
     0-0-0/w BIT         r     1 OC_LIST                    0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE
     0-0-0/w SBIN        r     1 OC_PLATEN_WIDTH

PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:57   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$OCCG
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)


   Procedure OCW$WRITE requires 487 words for executable code.
   Procedure OCW$WRITE requires 30 words of local(AUTO) storage.

    No errors detected in file OCW$CONSOLE.:E05TSI    .
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:58   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:59   
          MINI XREF LISTING

BADDY IN PROCEDURE WRITE
      1456**LABEL    1421--CALLALT
CADDR
        51**DCL        43--PROC     1494>>IF       1497>>ASSIGN   1511<>CALL     1516<>CALL     1533>>ASSIGN
      1562>>ASSIGN   1698<>CALL     1704<>CALL
FPT_WRITE
      1365**DCL      1438<>CALL     1442<>CALL     1448<>CALL     1450<>CALL
FPT_WRITE.BUF_.BOUND
      1365**DCL      1428<<ASSIGN   1437<<ASSIGN   1440<<ASSIGN   1444<<ASSIGN   1478<<ASSIGN
FPT_WRITE.BUF_.BUF$
      1367**DCL      1429<<ASSIGN   1441<<ASSIGN   1445<<ASSIGN   1479<<ASSIGN
FPT_WRITE.STATION_
      1367**DCL      1367--REDEF
FPT_WRITE.V
      1368**DCL      1365--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      1374**DCL      1374--REDEF
I
        63**DCL      1413>>IF       1416>>IF       1421>>CALL     1427>>ASSIGN   1431>>ASSIGN   1434>>IF
      1453>>ASSIGN   1498<<DOINDEX  1499>>IF       1501>>IF       1511<>CALL     1516<>CALL     1521<<ASSIGN
      1557<<DOINDEX  1563>>IF       1568>>IF       1587>>ASSIGN   1599>>CALLBLT  1600>>IF       1607>>ASSIGN
      1628>>IF       1634>>ASSIGN   1635>>ASSIGN   1649>>CALLBLT  1650>>IF       1655>>ASSIGN   1661>>IF
      1729>>DOWHILE  1737>>ASSIGN   1738>>ASSIGN   1747<<ASSIGN   1749>>DOWHILE  1751<<ASSIGN   1751>>ASSIGN
IGNORE IN PROCEDURE WRITE
      1446**LABEL    1448--CALLALT  1450--CALLALT
J
        64**DCL      1599<<CALLBLT  1600>>IF       1600>>IF       1649<<CALLBLT  1650>>IF       1650>>IF
J IN PROCEDURE ORDER
      1722**DCL      1725<<ASSIGN   1729>>DOWHILE  1729>>DOWHILE  1730>>ASSIGN   1731<<ASSIGN   1731>>ASSIGN
      1738>>ASSIGN
KSTA
      1392**DCL      1367--DCLINIT
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:60   
KSTA.MSGIDXT
      1402**DCL      1405--REDEF
KSTA.STATION#
      1396**DCL      1431<<ASSIGN
LAST IN PROCEDURE ORDER
      1723**DCL      1726<<ASSIGN   1730<<ASSIGN   1737>>ASSIGN
LASTLANG
      1289**DCL      1416>>IF       1427<<ASSIGN   1470<<ASSIGN
LOG_IT
        66**DCL      1473<<ASSIGN   1611<<ASSIGN   1665<<ASSIGN   1691>>IF       1694<<ASSIGN
M$WRITE
       186**DCL-ENT  1438--CALL     1442--CALL     1448--CALL     1450--CALL
MESS
        50**DCL        43--PROC     1421<>CALL     1476--ASSIGN   1479--ASSIGN   1511<>CALL     1516<>CALL
      1698<>CALL     1704<>CALL
MESS$
      1287**DCL      1422<<ASSIGN   1429>>ASSIGN   1441>>ASSIGN   1445>>ASSIGN   1476<<ASSIGN
MESSAGE#
      1292**DCL      1511<>CALL     1698<>CALL
MSG#
        52**DCL        43--PROC     1416--IF       1508--IF       1516<>CALL     1695--IF       1704<>CALL
OCL$LISTIT
        69**DCL-ENT  1511--CALL     1516--CALL     1698--CALL     1704--CALL
OCM$TPSET
      1291**DCL-ENT  1421--CALL
OCM_BPOSN
      1282**DCL      1423>>IF       1426>>ASSIGN
OCM_BUFFER
      1283**DCL      1422--ASSIGN
OC_CONSOLE.ACTIVE
       374**DCL      1499>>IF       1563>>IF
OC_CONSOLE.ATTR
       371**DCL       371--REDEF
OC_CONSOLE.ATTRO
       372**DCL       372--REDEF
OC_CONSOLE.ATTR_OUTPUT
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:61   
       372**DCL      1568>>IF       1661>>IF
OC_CONSOLE.CID
       370**DCL       371--REDEF    1501>>IF
OC_CONSOLE.FLAGS.OUTP
       374**DCL      1413>>IF
OC_CONSOLE.NATLANG
       375**DCL      1416>>IF       1421<>CALL     1427>>ASSIGN   1474<<ASSIGN   1555<<ASSIGN   1729>>DOWHILE
      1729>>DOWHILE
OC_CONSOLE.NEXT
       373**DCL      1475<<ASSIGN   1556<<ASSIGN   1725>>ASSIGN   1731>>ASSIGN   1737<<ASSIGN   1738<<ASSIGN
      1747>>ASSIGN   1751>>ASSIGN
OC_CONSOLE.STATION
       369**DCL       369--REDEF    1431>>ASSIGN   1434>>IF
OC_CONSOLE.STATIONR.SECND_HALF
       369**DCL      1628>>IF
OC_CONSOLE.TERM_NAME
       370**DCL      1587>>ASSIGN   1634>>ASSIGN   1655>>ASSIGN
OC_CONSOLE.TRANSAC_LAST_MIN
       374**DCL      1453<<ASSIGN
OC_CONSOLE.WSN
       370**DCL      1599>>CALLBLT  1600>>IF       1607>>ASSIGN   1635>>ASSIGN   1649>>CALLBLT  1650>>IF
OC_CONSOLE$
       368**DCL       369--IMP-PTR  1413>>IF       1416>>IF       1421>>CALL     1427>>ASSIGN   1431>>ASSIGN
      1434>>IF       1453>>ASSIGN   1474>>ASSIGN   1475>>ASSIGN   1499>>IF       1501>>IF       1555>>ASSIGN
      1556>>ASSIGN   1563>>IF       1568>>IF       1587>>ASSIGN   1599>>CALLBLT  1600>>IF       1607>>ASSIGN
      1628>>IF       1634>>ASSIGN   1635>>ASSIGN   1649>>CALLBLT  1650>>IF       1655>>ASSIGN   1661>>IF
      1725>>ASSIGN   1729>>DOWHILE  1729>>DOWHILE  1731>>ASSIGN   1737>>ASSIGN   1738>>ASSIGN   1747>>ASSIGN
      1751>>ASSIGN
OC_DIR
       411**DCL       411--REDEF    1494>>IF
OC_INTBIT
       411**DCL       412--REDEF
OC_INTMSG
       288**DCL       301--REDEF
OC_INTMSG.FLAGS
       295**DCL       296--REDEF
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:62   
OC_INTMSG.MESS
       301**DCL       301--REDEF
OC_INTMSG.MSGID
       291**DCL       292--REDEF
OC_INTMSG.WSN
       298**DCL       299--REDEF
OC_LIST
       414**DCL      1505>>IF       1691>>IF
OC_MASK
       412**DCL       412--REDEF
OC_MAXCONSOLE
       368**DCL      1498>>DOINDEX  1521>>ASSIGN   1557>>DOINDEX  1698>>CALL     1704>>CALL
OC_MESSBUF
       303**DCL       318--REDEF     332--REDEF
OC_MESSBUF.FLAGS
       310**DCL       311--REDEF
OC_MESSBUF.MESS
       316**DCL       316--REDEF
OC_MESSBUF.MSGID
       306**DCL       307--REDEF
OC_MESSBUF.WSN
       313**DCL       314--REDEF
OC_MESSBUF1.FLAGS
       325**DCL       326--REDEF
OC_MESSBUF1.LEN
       331**DCL       331--REDEF
OC_MESSBUF1.MSGID
       321**DCL       322--REDEF
OC_MESSBUF1.WSN
       328**DCL       329--REDEF
OC_MSGBUFFER
       334**DCL       349--REDEF
OC_MSGBUFFER.FLAGS
       341**DCL       342--REDEF
OC_MSGBUFFER.MESS
       347**DCL       347--REDEF
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:63   
OC_MSGBUFFER.MSGID
       337**DCL       338--REDEF
OC_MSGBUFFER.WSN
       344**DCL       345--REDEF
OC_MSGBUFFER2.FLAGS
       356**DCL       357--REDEF
OC_MSGBUFFER2.MSGID
       352**DCL       353--REDEF
OC_MSGBUFFER2.WSN
       359**DCL       360--REDEF
OC_PARAM
       367**DCL       367--REDEF
OC_PLATEN_WIDTH
       416**DCL      1432>>IF       1437>>ASSIGN   1440>>ASSIGN   1441>>ASSIGN
OC_QUEUE.PARMC
       366**DCL       366--REDEF
OOPS1 IN PROCEDURE WRITE
      1437**LABEL    1438--CALLALT
OOPS2 IN PROCEDURE WRITE
      1441**LABEL    1442--CALLALT
ORDER
      1720**PROC     1610--CALL     1664--CALL
SIZE
        49**DCL        43--PROC       50--IMP-SIZ  1421>>CALL     1466>>IF       1477>>ASSIGN   1511<>CALL
      1511>>CALL     1516<>CALL     1516>>CALL     1698<>CALL     1698>>CALL     1704<>CALL     1704>>CALL
SKIP_IT
      1611**LABEL    1575--GOTO     1585--GOTO     1603--GOTO
TEMP.B
        72**DCL        73--REDEF    1497<<ASSIGN   1533<<ASSIGN   1540>>IF       1562<<ASSIGN   1573>>IF
      1581>>IF       1596>>IF       1626>>IF       1631<<ASSIGN   1631>>ASSIGN   1646>>IF       1652<<ASSIGN
      1652>>ASSIGN   1661>>IF
TEMP.U
        73**DCL      1501>>IF
TERM_TEXT
      1293**DCL      1472<<ASSIGN   1587<<ASSIGN   1634<<ASSIGN   1655<<ASSIGN   1698<>CALL     1704<>CALL
WORKSTATION
PL6.E3A0      #001=OCW$WRITE File=OCW$CONSOLE.:E05TSI                            WED 07/30/97 04:08 Page:64   
        56**DCL      1600>>IF       1604>>ASSIGN   1650>>IF       1656>>ASSIGN
WRITE
      1411**PROC     1504--CALL     1750--CALL
WRITEO
      1745**PROC     1671--CALL
WSIZE
      1288**DCL      1426<<ASSIGN   1428>>ASSIGN   1432>>IF       1440>>ASSIGN   1444>>ASSIGN   1477<<ASSIGN
      1478>>ASSIGN
WSN
        53**DCL        43--PROC       56--REDEF    1511<>CALL     1516<>CALL     1698<>CALL     1704<>CALL
WSN.FIRST_HALF
        54**DCL      1540>>IF       1544<<ASSIGN
WSN.SECND_HALF
        55**DCL      1583>>IF       1628>>IF
WSN_TEXT
      1294**DCL      1471<<ASSIGN   1604<<ASSIGN   1607<<ASSIGN   1635<<ASSIGN   1656<<ASSIGN   1698<>CALL
      1704<>CALL
