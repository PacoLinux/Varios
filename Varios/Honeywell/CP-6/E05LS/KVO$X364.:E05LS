VERSION E05

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:1    
        1        1        /*M* KVO$X364 VDH ANS X3.64 Virtual Device Output */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        /*N* WHAT ABOUT DMI/INT/EMI/RIS (6/0 - 6/3)? */
        9        9        /*N* BOUND POSITIONING (IN KVO$PST?) */
       10       10        KVO$X364: PROC (PRM_VDH_OTPLCL);
       11       11        %INCLUDE KV_INT_M;
       12      154
       13      155        %KV$BOX(PAGE = YES, TITLE = "SYMREFs, ENTRY declarations.");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:2    
               173        /***************************************************************************
               174         *                                                                         *
               175         *                        SYMREFs, ENTRY declarations.                     *
               176         *                                                                         *
               177         ***************************************************************************/

       14      182        /*
       15      183        Declare external procedures CALLed.
       16      184        */
       17      185    1   DCL KVO$OTPLCL ENTRY(1);
       18      186    1   DCL KVO$PST ENTRY(1);
       19      187    1   DCL KVV$CALUSR ENTRY(1) ALTRET;
       20      188    1   DCL KVV$CALUSR_PST ENTRY ALTRET;
       21      189        %KV$BOX(PAGE = YES, TITLE =
               189            "INCLUDEs, EQUs, based structures, static data defined elsewhere.");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:3    
               207    1   /***************************************************************************
               208    1    *                                                                         *
               209    1    *      INCLUDEs, EQUs, based structures, static data defined elsewhere.   *
               210    1    *                                                                         *
               211    1    ***************************************************************************/

       22      216        %INCLUDE KV_ERRORS_C;
       23      276 S      %INCLUDE KV_GLBCNS_E;
       24      277
       25      278 S      %INCLUDE KV$GLB;
       26      279 S      %INCLUDE KV$GLBCTX;
       27      280        %KV$MVD;
       28      324        %KV$PTR;
       29      367        %KV$SRD (STCLASS = "BASED(Y@SRD$)");
       30      642        %EQU KV_SRD = CHARTEXT('KV$SRD');
       31      643        %KV$STR;
       32      730        %KV$VDI;
       33      801
       34      802 S      %INCLUDE KV$INT;
       35      803        %KV$X364 (STCLASS = "BASED(Y@X364$)");
       36      837        %EQU KV_X364 = CHARTEXT('KV$X364');
       37      838
       38      839 S      %INCLUDE KV$USR;
       39      840 S      %INCLUDE KV$VDH;
       40      841
       41      842        %KV$USR_DAT (NAME = KV_USR_DAT, STCLASS = SYMREF READONLY);
       42      926        %KV$USR_ERS (NAME = KV_USR_ERS, STCLASS = SYMREF READONLY);
       43     1030        %KV$USR_SETATR (NAME = KV_USR_SETATR, STCLASS = SYMREF READONLY);
       44     1153
       45     1154        %KV$VDH_OTPLCL (NAME = PRM_VDH_OTPLCL, STCLASS = PARAM);
       46     1227        %KV$VDH_PST (NAME = KV_VDH_PST_ABS_VRT_NO_SCR, STCLASS = SYMREF READONLY);
       47     1301        %KV$VDH_PST (NAME = KV_VDH_PST_0_VRT, STCLASS = SYMREF READONLY);
       48     1375
       49     1376        %INCLUDE K_CP6_M;
       50     1572        %G#GRPRND_E;
       51     1582
       52     1583    1   DCL Y$CHR(0:0) UBIN BYTE BASED CALIGNED;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:4    
       53     1584        %KV$BOX(PAGE = YES, TITLE = "Internal EQUs");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:5    
              1602    1   /***************************************************************************
              1603    1    *                                                                         *
              1604    1    *                               Internal EQUs                             *
              1605    1    *                                                                         *
              1606    1    ***************************************************************************/

       54     1611        /* EQUs for EVenTs.
       55     1612        */
       56     1613        %EQU Y#EVT_CE = 0;                      /* Ce character (not Ce CSI) received */
       57     1614        %EQU Y#EVT_CE_CSI = 1;                  /* Ce CSI character (.9B) received    */
       58     1615        %EQU Y#EVT_ERR = 2;           /* Illegal character received in 3.64 string    */
       59     1616        %EQU Y#EVT_ESC = 3;                     /* ESC character received             */
       60     1617        %EQU Y#EVT_EXPP = 4;                    /* Experimental P  character received */
       61     1618        %EQU Y#EVT_F_1 = 5;           /* F (final) character received (our group 1)   */
       62     1619        %EQU Y#EVT_F_2 = 6;           /* F (final) character received (our group 2)   */
       63     1620        %EQU Y#EVT_I = 7;                  /* I (intermediate) character received     */
       64     1621        %EQU Y#EVT_LFTBRK = 8;             /* Left bracket ([) character received     */
       65     1622        %EQU Y#EVT_P = 9;                       /* P  character received              */
       66     1623        %EQU Y#EVT_SEMCLN = 10;                 /* Semi-colon character received      */
       67     1624
       68     1625        %EQU Y#EVT_HI = 10;                     /* Hi value                           */
       69     1626
       70     1627        /*F* NAME:  KV_Y#STT_E
       71     1628        EQUs for STaTes.
       72     1629        The *K* comments show KV]DATMOD_..; .TRF makes it # in manual.
       73     1630        */
       74     1631        /*K* RCVERR
       75     1632        .TRF ]#
       76     1633        Y]STT_RCVERR        Received error.
       77     1634        .TRF ]]
       78     1635        */
       79     1636        %EQU Y#STT_RCVERR = 0;                  /* Received error                     */
       80     1637        /*K* RCVEXPP
       81     1638        .TRF ]#
       82     1639        Y]STT_RCVEXPP       Received experimental (private) P.
       83     1640        .TRF ]]
       84     1641        */
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:6    
       85     1642        %EQU Y#STT_RCVEXPP = 1;                 /* Received experimental (private) P  */
       86     1643        /*K* RCVI
       87     1644        .TRF ]#
       88     1645        Y]STT_RCVI          Received I (intermediate) character.
       89     1646        .TRF ]]
       90     1647        */
       91     1648        %EQU Y#STT_RCVI = 2;               /* Received I (intermediate) character     */
       92     1649        /*K* RCVP
       93     1650        .TRF ]#
       94     1651        Y]STT_RCVP          Received P character.
       95     1652        .TRF ]]
       96     1653        */
       97     1654        %EQU Y#STT_RCVP = 3;                    /* Received P  character              */
       98     1655        /*K* WATCSI
       99     1656        .TRF ]#
      100     1657        Y]STT_WATCSI        Waiting for CSI.
      101     1658        .TRF ]]
      102     1659        */
      103     1660        %EQU Y#STT_WATCSI = 4;                  /* Waiting for CSI                    */
      104     1661        /*K* WATFE
      105     1662        .TRF ]#
      106     1663        Y]STT_WATFE         Waiting for Fe (after receiving ESC).
      107     1664        .TRF ]]
      108     1665        */
      109     1666        %EQU Y#STT_WATFE = 5;              /* Waiting for Fe (after receiving ESC)    */
      110     1667        /*K* WATTKN
      111     1668        .TRF ]#
      112     1669        Y]STT_WATTKN        Waiting for token (F, P, ;, I) character.
      113     1670        .TRF ]]
      114     1671        */
      115     1672        %EQU Y#STT_WATTKN = 6;        /* Waiting for token (F, P,  ;, I) character    */
      116     1673
      117     1674        %EQU Y#ST_HI = 6;                       /* Hi value                           */
      118     1675
      119     1676        /* EQUs for ACTions.
      120     1677        */
      121     1678        %EQU Y#ACT_ZERACM = 0;                  /* Zero -> P-accumulator              */
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:7    
      122     1679        %EQU Y#ACT_ADDACM = 1;             /* Add current P  digit to P-accumulator   */
      123     1680        %EQU Y#ACT_CTRSQN = 2;        /* (Perform) control sequence (no I character)  */
      124     1681        %EQU Y#ACT_CTRSQN_I = 3;      /* (Perform) control sequence, with I character */
      125     1682        %EQU Y#ACT_ERR = 4;                     /* Error                              */
      126     1683        %EQU Y#ACT_ERREXT = 5;                  /* Error, exit                        */
      127     1684        %EQU Y#ACT_INDCTR_CE = 6;          /* (Perform) independent control, Ce form  */
      128     1685        %EQU Y#ACT_INDCTR_FE = 7;          /* (Perform) independent control, Fe form  */
      129     1686        %EQU Y#ACT_INT = 8;           /* Initialize (for receiving control sequence)  */
      130     1687        %EQU Y#ACT_NO = 9;                      /* No action                          */
      131     1688        %EQU Y#ACT_OPNACM = 10;                 /* Open P-accumulator (receiving a P) */
      132     1689        %EQU Y#ACT_OTP = 11;                    /* Output 'normal' (non-3.64) text    */
      133     1690        %EQU Y#ACT_PAS = 12;                    /* Pass ('normal' text to OTPLCL)     */
      134     1691        %EQU Y#ACT_SAVI = 13;                   /* Save I character                   */
      135     1692
      136     1693        /* EQUs declaring the function of independent controls and
      137     1694        control sequences.
      138     1695        */
      139     1696        %EQU Y#CTRFNC_CHA = 2;
      140     1697        %EQU Y#CTRFNC_CHT = 3;
      141     1698        %EQU Y#CTRFNC_CNL = 4;
      142     1699        %EQU Y#CTRFNC_CPL = 5;
      143     1700        %EQU Y#CTRFNC_CPR = 6;
      144     1701        %EQU Y#CTRFNC_CTC = 7;
      145     1702        %EQU Y#CTRFNC_CUB = 8;
      146     1703        %EQU Y#CTRFNC_CUD = 9;
      147     1704        %EQU Y#CTRFNC_CUF = 10;
      148     1705        %EQU Y#CTRFNC_CUP = 11;
      149     1706        %EQU Y#CTRFNC_CUU = 1;
      150     1707        %EQU Y#CTRFNC_DAQ = 12;
      151     1708        %EQU Y#CTRFNC_DCH = 13;
      152     1709        %EQU Y#CTRFNC_DL = 14;
      153     1710        %EQU Y#CTRFNC_ECH = 15;
      154     1711        %EQU Y#CTRFNC_ED = 16;
      155     1712        %EQU Y#CTRFNC_EL = 17;
      156     1713        %EQU Y#CTRFNC_EPA = 18;
      157     1714        %EQU Y#CTRFNC_HPA = 19;
      158     1715        %EQU Y#CTRFNC_HPR = 20;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:8    
      159     1716        %EQU Y#CTRFNC_HVP = 21;
      160     1717        %EQU Y#CTRFNC_ICH = 22;
      161     1718        %EQU Y#CTRFNC_IL = 23;
      162     1719        %EQU Y#CTRFNC_IND = 24;
      163     1720        %EQU Y#CTRFNC_NEL = 25;
      164     1721        %EQU Y#CTRFNC_REP = 26;
      165     1722        %EQU Y#CTRFNC_RI = 27;
      166     1723        %EQU Y#CTRFNC_RM = 28;
      167     1724        %EQU Y#CTRFNC_SEM = 29;
      168     1725        %EQU Y#CTRFNC_SGR = 30;
      169     1726        %EQU Y#CTRFNC_SM = 31;
      170     1727        %EQU Y#CTRFNC_SPA = 32;
      171     1728        %EQU Y#CTRFNC_TBC = 33;
      172     1729        %EQU Y#CTRFNC_VPA = 34;
      173     1730        %EQU Y#CTRFNC_VPR = 35;
      174     1731
      175     1732        %EQU Y#E$X364_ILG_LOW = 1420;           /* Low value for X3.64 parse errors   */
      176     1733        %KV$BOX(PAGE = YES, TITLE = "Static data contained within this PROCedure.");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:9    
              1751    1   /***************************************************************************
              1752    1    *                                                                         *
              1753    1    *                Static data contained within this PROCedure.             *
              1754    1    *                                                                         *
              1755    1    ***************************************************************************/

      177     1760        /*
      178     1761        Static (and constant) data contained within this procedure.
      179     1762        */
      180     1763        %KV$X364(NAME = KV_X364, STCLASS = CONSTANT SYMDEF);
      181     1797
      182     1798        %KV$BOX(PAGE = YES, TITLE = "AUTO variables.");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:10   
              1816    1   /***************************************************************************
              1817    1    *                                                                         *
              1818    1    *                              AUTO variables.                            *
              1819    1    *                                                                         *
              1820    1    ***************************************************************************/

      183     1825        /*
      184     1826        AUTO variables.
      185     1827        */
      186     1828        /*
      187     1829        Pointer to KV$X364 structure.
      188     1830        */
      189     1831    1   DCL Y@X364$ PTR AUTO;
      190     1832        /*
      191     1833        Pointer to KV$SRD, since we use it so much too.
      192     1834        */
      193     1835    1   DCL Y@SRD$ PTR;
      194     1836        /*
      195     1837        Character (currently being processed).
      196     1838        */
      197     1839    1   DCL Y@CHR SBIN AUTO;
      198     1840        /*
      199     1841        Function (currently being processed).
      200     1842        */
      201     1843    1   DCL Y@FNC UBIN AUTO;
      202     1844        /*
      203     1845        ANS I (intermediate) character, saved from the current control sequence.
      204     1846        */
      205     1847    1   DCL Y@I_CHR UBIN AUTO;
      206     1848        /*
      207     1849        Beginning character index.  Index in the PRM_VDH_OTPLCL.BFR_
      208     1850        character string to the beginning of the region of characters
      209     1851        that haven't been fully processed.
      210     1852        */
      211     1853    1   DCL Y@BGNCHRX SBIN AUTO;
      212     1854        /*
      213     1855        Character index.  Index in the PRM_VDH_OTPLCL.BFR_
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:11   
      214     1856        character string to the character currently being processed.
      215     1857        */
      216     1858    1   DCL Y@CHRX SBIN AUTO;
      217     1859        /*
      218     1860        Character index hi value.  Max value for Y@CHRX.
      219     1861        */
      220     1862    1   DCL Y@CHRX_HI SBIN AUTO;
      221     1863
      222     1864        %KV$USR_DAT (NAME = KV@USR_DAT, STCLASS = AUTO);
      223     1948
      224     1949        %KV$USR_ERS (NAME = KV@USR_ERS, STCLASS = AUTO);
      225     2053
      226     2054        %KV$USR_SETATR (NAME = KV@USR_SETATR, STCLASS = AUTO);
      227     2177
      228     2178        %KV$VDH_OTPLCL (NAME = KV@VDH_OTPLCL, STCLASS = AUTO);
      229     2251
      230     2252        %KV$VDH_PST (NAME = KV@VDH_PST, STCLASS = AUTO);
      231     2326
      232     2327        %KV$BOX(PAGE = YES, TITLE = "Y$DCLCHR MACRO");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:12   
              2345    1   /***************************************************************************
              2346    1    *                                                                         *
              2347    1    *                               Y$DCLCHR MACRO                            *
              2348    1    *                                                                         *
              2349    1    ***************************************************************************/

      233     2354        /* Declare the attributes of the characters we're parsing.
      234     2355        BEWARE the unusual defaults in the %MACRO definition.
      235     2356
      236     2357        */
      237     2358        %SET Y#CHR = 0;
      238     2359
      239     2360        %EQU Y#CTRSQNCHR_F_LOW = 64;       /* Control sequence F character low value  */
      240     2361        %EQU Y#CTRSQNCHR_F_HI = 127;       /* Control sequence F character hi value   */
      241     2362        %EQU Y#CTRSQNCHR_CNT = Y#CTRSQNCHR_F_HI - Y#CTRSQNCHR_F_LOW + 1;
              2362            /* Control sequence, count (of) */
      242     2363
      243     2364        %SET Y#CTRSQNCHR =
              2364            '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF';
      244     2365
      245     2366        %EQU Y#INDCTRCHR_FE_LOW = 64;           /* Independent control Fe low value   */
      246     2367        %EQU Y#INDCTRCHR_FE_HI = 99;            /* Independent control Fe hi value    */
      247     2368        %EQU Y#INDCTRCHR_CNT = Y#INDCTRCHR_FE_HI - Y#INDCTRCHR_FE_LOW + 1;
              2368            /* Independent control, count (of) */
      248     2369
      249     2370        %EQU Y#INDCTRCHR_CE_LOW = 128;          /* Independent control Ce low value   */
      250     2371        %EQU Y#INDCTRCHR_CE_HI = 159;           /* Independent control Ce hi value    */
      251     2372
      252     2373        %SET Y#INDCTRCHR = '0123456789ABCDEF0123456789ABCDEF0123';
      253     2374
      254     2375        %MACRO Y$DCLCHR (NAME = *, STCLASS = CONSTANT, LAST = ",", LVL = 2,
      255     2376         EVT (
      256     2377         CE = %Y#EVT_CE,
      257     2378         CE_CSI = %Y#EVT_CE_CSI,
      258     2379         ERR = %Y#EVT_ERR,
      259     2380         ESC = %Y#EVT_ESC,
      260     2381         EXPP = %Y#EVT_EXPP,
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:13   
      261     2382         F_1 = %Y#EVT_F_1,
      262     2383         F_2 = %Y#EVT_F_2,
      263     2384         I = %Y#EVT_I,
      264     2385         LFTBRK = %Y#EVT_LFTBRK,
      265     2386         P = %Y#EVT_P,
      266     2387         SEMCLN = %Y#EVT_SEMCLN) = ,
      267     2388         CTRSQN = 0,
      268     2389         INDCTR = 0);
      269     2390        %LSET LISTEXP = '1'B;
      270     2391        %LSET LISTCOM = '0'B;
      271     2392        %LSET LISTSUB = '1'B;
      272     2393        %LSET STR = SUBSTR(CONCAT(TEXTCHAR(STCLASS),'   '),0,3);
      273     2394        %IF (STR = 'STA') OR (STR = 'CON') OR (STR = 'EXT');
      274     2395        %LSET INIT = CHARTEXT(' INIT');
      275     2396        %LSET ENIT = CHARTEXT('');
      276     2397        %ELSE;
      277     2398        %LSET INIT = CHARTEXT('/*');
      278     2399        %LSET ENIT = CHARTEXT('*/');
      279     2400        %ENDIF;
      280     2401        %IF LVL = 1;
      281     2402        DCL 1 NAME(0:255) STCLASS UNAL,
      282     2403        %ELSE;
      283     2404        %IF TEXTCHAR(NAME) ~= '';
      284     2405        %(LVL) NAME,
      285     2406        %ENDIF;
      286     2407        %ENDIF;
      287     2408        %(LVL+1) %CHARTEXT('EVT') UBIN(8) %INIT(EVT)%ENIT UNAL LAST
      288     2409        /* EVT = DEC(0-31).  Event code.
      289     2410        */
      290     2411
      291     2412        %IF INIT = CHARTEXT(' INIT');
      292     2413
      293     2414        %IF Y#CHR >= Y#CTRSQNCHR_F_LOW AND Y#CHR <= Y#CTRSQNCHR_F_HI;
      294     2415        %SET Y#CTRSQNCHR = CONCAT(
      295     2416         SUBSTR(Y#CTRSQNCHR, 0, Y#CHR-Y#CTRSQNCHR_F_LOW),
      296     2417         %BINASC(CTRSQN),
      297     2418         SUBSTR(Y#CTRSQNCHR, Y#CHR-Y#CTRSQNCHR_F_LOW+1));
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:14   
      298     2419        %ELSEIF Y#CHR >= Y#INDCTRCHR_CE_LOW AND Y#CHR <= Y#INDCTRCHR_CE_HI;
      299     2420        %SET Y#INDCTRCHR = CONCAT(
      300     2421         SUBSTR(Y#INDCTRCHR, 0, Y#CHR-Y#INDCTRCHR_CE_LOW),
      301     2422         %BINASC(INDCTR),
      302     2423         SUBSTR(Y#INDCTRCHR, Y#CHR-Y#INDCTRCHR_CE_LOW+1));
      303     2424        %ENDIF;
      304     2425
      305     2426        %SET Y#CHR = Y#CHR + 1;
      306     2427        %ENDIF;
      307     2428        %MEND;
      308     2429
      309     2430        %KV$BOX(PAGE = YES, TITLE = "Y$EVTSTT MACRO");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:15   
              2448    1   /***************************************************************************
              2449    1    *                                                                         *
              2450    1    *                               Y$EVTSTT MACRO                            *
              2451    1    *                                                                         *
              2452    1    ***************************************************************************/

      310     2457        /* Event/state table entry definition.
      311     2458        The event/state table is used to parse the text received in the message.
      312     2459
      313     2460        BEWARE the unusual defaults in the %MACRO definition.
      314     2461
      315     2462        */
      316     2463        %MACRO Y$EVTSTT (NAME = *, STCLASS = CONSTANT, LAST = ",", LVL = 2,
      317     2464         ERRCOD = Y#E$X364_ILG_LOW,
      318     2465         NXTSTT (
      319     2466         RCVERR = %Y#STT_RCVERR,
      320     2467         RCVEXPP = %Y#STT_RCVEXPP,
      321     2468         RCVI = %Y#STT_RCVI,
      322     2469         RCVP = %Y#STT_RCVP,
      323     2470         WATCSI = %Y#STT_WATCSI,
      324     2471         WATFE = %Y#STT_WATFE,
      325     2472         WATTKN = %Y#STT_WATTKN) = ,
      326     2473         ACT (
      327     2474         ZERACM = %Y#ACT_ZERACM,
      328     2475         ADDACM = %Y#ACT_ADDACM,
      329     2476         CTRSQN = %Y#ACT_CTRSQN,
      330     2477         CTRSQN_I = %Y#ACT_CTRSQN_I,
      331     2478         ERR = %Y#ACT_ERR,
      332     2479         ERREXT = %Y#ACT_ERREXT,
      333     2480         INDCTR_CE = %Y#ACT_INDCTR_CE,
      334     2481         INDCTR_FE = %Y#ACT_INDCTR_FE,
      335     2482         INT = %Y#ACT_INT,
      336     2483         NO = %Y#ACT_NO,
      337     2484         OPNACM = %Y#ACT_OPNACM,
      338     2485         OTP = %Y#ACT_OTP,
      339     2486         PAS = %Y#ACT_PAS,
      340     2487         SAVI = %Y#ACT_SAVI) = );
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:16   
      341     2488        %LSET LISTDIR = '0'B;
      342     2489        %LSET LISTEXP = '1'B;
      343     2490        %LSET LISTCOM = '0'B;
      344     2491        %LSET LISTSUB = '1'B;
      345     2492        %LSET STR = SUBSTR(CONCAT(TEXTCHAR(STCLASS),'   '),0,3);
      346     2493        %IF (STR = 'STA') OR (STR = 'CON') OR (STR = 'EXT');
      347     2494        %LSET INIT = CHARTEXT(' INIT');
      348     2495        %LSET ENIT = CHARTEXT('');
      349     2496        %ELSE;
      350     2497        %LSET INIT = CHARTEXT('/*');
      351     2498        %LSET ENIT = CHARTEXT('*/');
      352     2499        %ENDIF;
      353     2500        %IF LVL = 1;
      354     2501        DCL 1 NAME ALIGNED STCLASS,
      355     2502        %ELSE;
      356     2503        %IF TEXTCHAR(NAME) ~= '';
      357     2504        %(LVL) NAME,
      358     2505        %ENDIF;
      359     2506        %ENDIF;
      360     2507        %(LVL+1) %CHARTEXT('ERRCOD') UBIN(5) %INIT(%(ERRCOD-Y#E$X364_ILG_LOW))%ENIT UNAL,
      361     2508        /* ERRCOD = DEC(0-31).  Error code, if ACT is ERR...
      362     2509        */
      363     2510        %(LVL+1) %CHARTEXT('NXTSTT') UBIN(3) %INIT(NXTSTT)%ENIT UNAL,
      364     2511        /* NXTSTT = DEC(0-7).  Next state.
      365     2512        */
      366     2513        %(LVL+1) %CHARTEXT('ACT') UBIN(8) %INIT(ACT)%ENIT UNAL LAST
      367     2514        /* ACT = DEC(0-255).  Action to take.
      368     2515        */
      369     2516        %MEND;
      370     2517
      371     2518        %Y$EVTSTT (NAME = Y@EVTSTT, STCLASS = AUTO, LVL = 1, LAST = ";");
      372     2548
      373     2549        %EJECT;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:17   
      374     2550    1   DCL 1 Y_EVT_INT CONSTANT ALIGNED,
      375     2551        /*X* DDA = YES */
      376     2552        /*
      377     2553                     Hex ANS             Event    Function
      378     2554                  Format Format                                           */
      379     2555
      380     2556        %Y$DCLCHR /* .00 0/0   */ (EVT = ERR);
      381     2593        %Y$DCLCHR /* .01 0/1   */ (EVT = ERR);
      382     2630        %Y$DCLCHR /* .02 0/2   */ (EVT = ERR);
      383     2667        %Y$DCLCHR /* .03 0/3   */ (EVT = ERR);
      384     2704        %Y$DCLCHR /* .04 0/4   */ (EVT = ERR);
      385     2741        %Y$DCLCHR /* .05 0/5   */ (EVT = ERR);
      386     2778        %Y$DCLCHR /* .06 0/6   */ (EVT = ERR);
      387     2815        %Y$DCLCHR /* .07 0/7   */ (EVT = ERR);
      388     2852        %Y$DCLCHR /* .08 0/8   */ (EVT = ERR);
      389     2889        %Y$DCLCHR /* .09 0/9   */ (EVT = ERR);
      390     2926        %Y$DCLCHR /* .0A 0/10  */ (EVT = ERR);
      391     2963        %Y$DCLCHR /* .0B 0/11  */ (EVT = ERR);
      392     3000        %Y$DCLCHR /* .0C 0/12  */ (EVT = ERR);
      393     3037        %Y$DCLCHR /* .0D 0/13  */ (EVT = ERR);
      394     3074        %Y$DCLCHR /* .0E 0/14  */ (EVT = ERR);
      395     3111        %Y$DCLCHR /* .0F 0/15  */ (EVT = ERR);
      396     3148        %Y$DCLCHR /* .10 1/0   */ (EVT = ERR);
      397     3185        %Y$DCLCHR /* .11 1/1   */ (EVT = ERR);
      398     3222        %Y$DCLCHR /* .12 1/2   */ (EVT = ERR);
      399     3259        %Y$DCLCHR /* .13 1/3   */ (EVT = ERR);
      400     3296        %Y$DCLCHR /* .14 1/4   */ (EVT = ERR);
      401     3333        %Y$DCLCHR /* .15 1/5   */ (EVT = ERR);
      402     3370        %Y$DCLCHR /* .16 1/6   */ (EVT = ERR);
      403     3407        %Y$DCLCHR /* .17 1/7   */ (EVT = ERR);
      404     3444        %Y$DCLCHR /* .18 1/8   */ (EVT = ERR);
      405     3481        %Y$DCLCHR /* .19 1/9   */ (EVT = ERR);
      406     3518        %Y$DCLCHR /* .1A 1/10  */ (EVT = ERR);
      407     3555        %Y$DCLCHR /* .1B 1/11  */ (EVT = ESC);
      408     3592        %Y$DCLCHR /* .1C 1/12  */ (EVT = ERR);
      409     3629        %Y$DCLCHR /* .1D 1/13  */ (EVT = ERR);
      410     3666        %Y$DCLCHR /* .1E 1/14  */ (EVT = ERR);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:18   
      411     3703        %Y$DCLCHR /* .1F 1/15  */ (EVT = ERR);
      412     3740        %Y$DCLCHR /* .20 2/0   */ (EVT = I);
      413     3777        %Y$DCLCHR /* .21 2/1   */ (EVT = I);
      414     3814        %Y$DCLCHR /* .22 2/2   */ (EVT = I);
      415     3851        %Y$DCLCHR /* .23 2/3   */ (EVT = I);
      416     3888        %Y$DCLCHR /* .24 2/4   */ (EVT = I);
      417     3925        %Y$DCLCHR /* .25 2/5   */ (EVT = I);
      418     3962        %Y$DCLCHR /* .26 2/6   */ (EVT = I);
      419     3999        %Y$DCLCHR /* .27 2/7   */ (EVT = I);
      420     4036        %Y$DCLCHR /* .28 2/8   */ (EVT = I);
      421     4073        %Y$DCLCHR /* .29 2/9   */ (EVT = I);
      422     4110        %Y$DCLCHR /* .2A 2/10  */ (EVT = I);
      423     4147        %Y$DCLCHR /* .2B 2/11  */ (EVT = I);
      424     4184        %Y$DCLCHR /* .2C 2/12  */ (EVT = I);
      425     4221        %Y$DCLCHR /* .2D 2/13  */ (EVT = I);
      426     4258        %Y$DCLCHR /* .2E 2/14  */ (EVT = I);
      427     4295        %Y$DCLCHR /* .2F 2/15  */ (EVT = I);
      428     4332        %Y$DCLCHR /* .30 3/0   */ (EVT = P);
      429     4369        %Y$DCLCHR /* .31 3/1   */ (EVT = P);
      430     4406        %Y$DCLCHR /* .32 3/2   */ (EVT = P);
      431     4443        %Y$DCLCHR /* .33 3/3   */ (EVT = P);
      432     4480        %Y$DCLCHR /* .34 3/4   */ (EVT = P);
      433     4517        %Y$DCLCHR /* .35 3/5   */ (EVT = P);
      434     4554        %Y$DCLCHR /* .36 3/6   */ (EVT = P);
      435     4591        %Y$DCLCHR /* .37 3/7   */ (EVT = P);
      436     4628        %Y$DCLCHR /* .38 3/8   */ (EVT = P);
      437     4665        %Y$DCLCHR /* .39 3/9   */ (EVT = P);
      438     4702        %Y$DCLCHR /* .3A 3/10  */ (EVT = ERR);
      439     4739        %Y$DCLCHR /* .3B 3/11  */ (EVT = SEMCLN);
      440     4776        %Y$DCLCHR /* .3C 3/12  */ (EVT = EXPP);
      441     4813        %Y$DCLCHR /* .3D 3/13  */ (EVT = EXPP);
      442     4850        %Y$DCLCHR /* .3E 3/14  */ (EVT = EXPP);
      443     4887        %Y$DCLCHR /* .3F 3/15  */ (EVT = EXPP);
      444     4924        %Y$DCLCHR /* .40 4/0   */ (EVT = F_1, CTRSQN = Y#CTRFNC_ICH);
      445     4961        %Y$DCLCHR /* .41 4/1   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUU);
      446     4998        %Y$DCLCHR /* .42 4/2   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUD);
      447     5035        %Y$DCLCHR /* .43 4/3   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUF);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:19   
      448     5072        %Y$DCLCHR /* .44 4/4   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUB);
      449     5109        %Y$DCLCHR /* .45 4/5   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CNL);
      450     5146        %Y$DCLCHR /* .46 4/6   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CPL);
      451     5183        %Y$DCLCHR /* .47 4/7   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CHA);
      452     5220        %Y$DCLCHR /* .48 4/8   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUP);
      453     5257        %Y$DCLCHR /* .49 4/9   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CHT);
      454     5294        %Y$DCLCHR /* .4A 4/10  */ (EVT = F_1, CTRSQN = Y#CTRFNC_ED);
      455     5331        %Y$DCLCHR /* .4B 4/11  */ (EVT = F_1, CTRSQN = Y#CTRFNC_EL);
      456     5368        %Y$DCLCHR /* .4C 4/12  */ (EVT = F_1, CTRSQN = Y#CTRFNC_IL);
      457     5405        %Y$DCLCHR /* .4D 4/13  */ (EVT = F_1, CTRSQN = Y#CTRFNC_DL);
      458     5442        %Y$DCLCHR /* .4E 4/14  */ (EVT = F_1);
      459     5479        %Y$DCLCHR /* .4F 4/15  */ (EVT = F_1);
      460     5516        %Y$DCLCHR /* .50 5/0   */ (EVT = F_1, CTRSQN = Y#CTRFNC_DCH);
      461     5553        %Y$DCLCHR /* .51 5/1   */ (EVT = F_1, CTRSQN = Y#CTRFNC_SEM);
      462     5590        %Y$DCLCHR /* .52 5/2   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CPR);
      463     5627        %Y$DCLCHR /* .53 5/3   */ (EVT = F_1);
      464     5664        %Y$DCLCHR /* .54 5/4   */ (EVT = F_1);
      465     5701        %Y$DCLCHR /* .55 5/5   */ (EVT = F_1);
      466     5738        %Y$DCLCHR /* .56 5/6   */ (EVT = F_1);
      467     5775        %Y$DCLCHR /* .57 5/7   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CTC);
      468     5812        %Y$DCLCHR /* .58 5/8   */ (EVT = F_1, CTRSQN = Y#CTRFNC_ECH);
      469     5849        %Y$DCLCHR /* .59 5/9   */ (EVT = F_1);
      470     5886        %Y$DCLCHR /* .5A 5/10  */ (EVT = F_1);
      471     5923        %Y$DCLCHR /* .5B 5/11  */ (EVT = LFTBRK);
      472     5960        %Y$DCLCHR /* .5C 5/12  */ (EVT = F_1);
      473     5997        %Y$DCLCHR /* .5D 5/13  */ (EVT = F_1);
      474     6034        %Y$DCLCHR /* .5E 5/14  */ (EVT = F_1);
      475     6071        %Y$DCLCHR /* .5F 5/15  */ (EVT = F_1);
      476     6108        %Y$DCLCHR /* .60 6/0   */ (EVT = F_2, CTRSQN = Y#CTRFNC_HPA);
      477     6145        %Y$DCLCHR /* .61 6/1   */ (EVT = F_2, CTRSQN = Y#CTRFNC_HPR);
      478     6182        %Y$DCLCHR /* .62 6/2   */ (EVT = F_2, CTRSQN = Y#CTRFNC_REP);
      479     6219        %Y$DCLCHR /* .63 6/3   */ (EVT = F_2);
      480     6256        %Y$DCLCHR /* .64 6/4   */ (EVT = F_2, CTRSQN = Y#CTRFNC_VPA);
      481     6293        %Y$DCLCHR /* .65 6/5   */ (EVT = F_2, CTRSQN = Y#CTRFNC_VPR);
      482     6330        %Y$DCLCHR /* .66 6/6   */ (EVT = F_2, CTRSQN = Y#CTRFNC_HVP);
      483     6367        %Y$DCLCHR /* .67 6/7   */ (EVT = F_2, CTRSQN = Y#CTRFNC_TBC);
      484     6404        %Y$DCLCHR /* .68 6/8   */ (EVT = F_2, CTRSQN = Y#CTRFNC_SM);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:20   
      485     6441        %Y$DCLCHR /* .69 6/9   */ (EVT = F_2);
      486     6478        %Y$DCLCHR /* .6A 6/10  */ (EVT = F_2);
      487     6515        %Y$DCLCHR /* .6B 6/11  */ (EVT = F_2);
      488     6552        %Y$DCLCHR /* .6C 6/12  */ (EVT = F_2, CTRSQN = Y#CTRFNC_RM);
      489     6589        %Y$DCLCHR /* .6D 6/13  */ (EVT = F_2, CTRSQN = Y#CTRFNC_SGR);
      490     6626        %Y$DCLCHR /* .6E 6/14  */ (EVT = F_2);
      491     6663        %Y$DCLCHR /* .6F 6/15  */ (EVT = F_2, CTRSQN = Y#CTRFNC_DAQ);
      492     6700        %Y$DCLCHR /* .70 7/0   */ (EVT = F_2);
      493     6737        %Y$DCLCHR /* .71 7/1   */ (EVT = F_2);
      494     6774        %Y$DCLCHR /* .72 7/2   */ (EVT = F_2);
      495     6811        %Y$DCLCHR /* .73 7/3   */ (EVT = F_2);
      496     6848        %Y$DCLCHR /* .74 7/4   */ (EVT = F_2);
      497     6885        %Y$DCLCHR /* .75 7/5   */ (EVT = F_2);
      498     6922        %Y$DCLCHR /* .76 7/6   */ (EVT = F_2);
      499     6959        %Y$DCLCHR /* .77 7/7   */ (EVT = F_2);
      500     6996        %Y$DCLCHR /* .78 7/8   */ (EVT = F_2);
      501     7033        %Y$DCLCHR /* .79 7/9   */ (EVT = F_2);
      502     7070        %Y$DCLCHR /* .7A 7/10  */ (EVT = F_2);
      503     7107        %Y$DCLCHR /* .7B 7/11  */ (EVT = F_2);
      504     7144        %Y$DCLCHR /* .7C 7/12  */ (EVT = F_2);
      505     7181        %Y$DCLCHR /* .7D 7/13  */ (EVT = F_2);
      506     7218        %Y$DCLCHR /* .7E 7/14  */ (EVT = F_2);
      507     7255        %Y$DCLCHR /* .7F 7/15  */ (EVT = ERR);
      508     7292        %Y$DCLCHR /* .80 8/0   */ (EVT = CE);
      509     7329        %Y$DCLCHR /* .81 8/1   */ (EVT = CE);
      510     7366        %Y$DCLCHR /* .82 8/2   */ (EVT = CE);
      511     7403        %Y$DCLCHR /* .83 8/3   */ (EVT = CE);
      512     7440        %Y$DCLCHR /* .84 8/4   */ (EVT = CE,  INDCTR = Y#CTRFNC_IND);
      513     7477        %Y$DCLCHR /* .85 8/5   */ (EVT = CE,  INDCTR = Y#CTRFNC_NEL);
      514     7514        %Y$DCLCHR /* .86 8/6   */ (EVT = CE);
      515     7551        %Y$DCLCHR /* .87 8/7   */ (EVT = CE);
      516     7588        %Y$DCLCHR /* .88 8/8   */ (EVT = CE);
      517     7625        %Y$DCLCHR /* .89 8/9   */ (EVT = CE);
      518     7662        %Y$DCLCHR /* .8A 8/10  */ (EVT = CE);
      519     7699        %Y$DCLCHR /* .8B 8/11  */ (EVT = CE);
      520     7736        %Y$DCLCHR /* .8C 8/12  */ (EVT = CE);
      521     7773        %Y$DCLCHR /* .8D 8/13  */ (EVT = CE,  INDCTR = Y#CTRFNC_RI);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:21   
      522     7810        %Y$DCLCHR /* .8E 8/14  */ (EVT = CE);
      523     7847        %Y$DCLCHR /* .8F 8/15  */ (EVT = CE);
      524     7884        %Y$DCLCHR /* .90 9/0   */ (EVT = CE);
      525     7921        %Y$DCLCHR /* .91 9/1   */ (EVT = CE);
      526     7958        %Y$DCLCHR /* .92 9/2   */ (EVT = CE);
      527     7995        %Y$DCLCHR /* .93 9/3   */ (EVT = CE);
      528     8032        %Y$DCLCHR /* .94 9/4   */ (EVT = CE);
      529     8069        %Y$DCLCHR /* .95 9/5   */ (EVT = CE);
      530     8106        %Y$DCLCHR /* .96 9/6   */ (EVT = CE,  INDCTR = Y#CTRFNC_SPA);
      531     8143        %Y$DCLCHR /* .97 9/7   */ (EVT = CE,  INDCTR = Y#CTRFNC_EPA);
      532     8180        %Y$DCLCHR /* .98 9/8   */ (EVT = CE);
      533     8217        %Y$DCLCHR /* .99 9/9   */ (EVT = CE);
      534     8254        %Y$DCLCHR /* .9A 9/10  */ (EVT = CE);
      535     8291        %Y$DCLCHR /* .9B 9/11  */ (EVT = CE_CSI);
      536     8328        %Y$DCLCHR /* .9C 9/12  */ (EVT = CE);
      537     8365        %Y$DCLCHR /* .9D 9/13  */ (EVT = CE);
      538     8402        %Y$DCLCHR /* .9E 9/14  */ (EVT = CE);
      539     8439        %Y$DCLCHR /* .9F 9/15  */ (EVT = CE);
      540     8476        %Y$DCLCHR /* .A0 10/0  */ (EVT = ERR);
      541     8513        %Y$DCLCHR /* .A1 10/1  */ (EVT = ERR);
      542     8550        %Y$DCLCHR /* .A2 10/2  */ (EVT = ERR);
      543     8587        %Y$DCLCHR /* .A3 10/3  */ (EVT = ERR);
      544     8624        %Y$DCLCHR /* .A4 10/4  */ (EVT = ERR);
      545     8661        %Y$DCLCHR /* .A5 10/5  */ (EVT = ERR);
      546     8698        %Y$DCLCHR /* .A6 10/6  */ (EVT = ERR);
      547     8735        %Y$DCLCHR /* .A7 10/7  */ (EVT = ERR);
      548     8772        %Y$DCLCHR /* .A8 10/8  */ (EVT = ERR);
      549     8809        %Y$DCLCHR /* .A9 10/9  */ (EVT = ERR);
      550     8846        %Y$DCLCHR /* .AA 10/10 */ (EVT = ERR);
      551     8883        %Y$DCLCHR /* .AB 10/11 */ (EVT = ERR);
      552     8920        %Y$DCLCHR /* .AC 10/12 */ (EVT = ERR);
      553     8957        %Y$DCLCHR /* .AD 10/13 */ (EVT = ERR);
      554     8994        %Y$DCLCHR /* .AE 10/14 */ (EVT = ERR);
      555     9031        %Y$DCLCHR /* .AF 10/15 */ (EVT = ERR);
      556     9068        %Y$DCLCHR /* .B0 11/0  */ (EVT = ERR);
      557     9105        %Y$DCLCHR /* .B1 11/1  */ (EVT = ERR);
      558     9142        %Y$DCLCHR /* .B2 11/2  */ (EVT = ERR);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:22   
      559     9179        %Y$DCLCHR /* .B3 11/3  */ (EVT = ERR);
      560     9216        %Y$DCLCHR /* .B4 11/4  */ (EVT = ERR);
      561     9253        %Y$DCLCHR /* .B5 11/5  */ (EVT = ERR);
      562     9290        %Y$DCLCHR /* .B6 11/6  */ (EVT = ERR);
      563     9327        %Y$DCLCHR /* .B7 11/7  */ (EVT = ERR);
      564     9364        %Y$DCLCHR /* .B8 11/8  */ (EVT = ERR);
      565     9401        %Y$DCLCHR /* .B9 11/9  */ (EVT = ERR);
      566     9438        %Y$DCLCHR /* .BA 11/10 */ (EVT = ERR);
      567     9475        %Y$DCLCHR /* .BB 11/11 */ (EVT = ERR);
      568     9512        %Y$DCLCHR /* .BC 11/12 */ (EVT = ERR);
      569     9549        %Y$DCLCHR /* .BD 11/13 */ (EVT = ERR);
      570     9586        %Y$DCLCHR /* .BE 11/14 */ (EVT = ERR);
      571     9623        %Y$DCLCHR /* .BF 11/15 */ (EVT = ERR);
      572     9660        %Y$DCLCHR /* .C0 12/0  */ (EVT = ERR);
      573     9697        %Y$DCLCHR /* .C1 12/1  */ (EVT = ERR);
      574     9734        %Y$DCLCHR /* .C2 12/2  */ (EVT = ERR);
      575     9771        %Y$DCLCHR /* .C3 12/3  */ (EVT = ERR);
      576     9808        %Y$DCLCHR /* .C4 12/4  */ (EVT = ERR);
      577     9845        %Y$DCLCHR /* .C5 12/5  */ (EVT = ERR);
      578     9882        %Y$DCLCHR /* .C6 12/6  */ (EVT = ERR);
      579     9919        %Y$DCLCHR /* .C7 12/7  */ (EVT = ERR);
      580     9956        %Y$DCLCHR /* .C8 12/8  */ (EVT = ERR);
      581     9993        %Y$DCLCHR /* .C9 12/9  */ (EVT = ERR);
      582    10030        %Y$DCLCHR /* .CA 12/10 */ (EVT = ERR);
      583    10067        %Y$DCLCHR /* .CB 12/11 */ (EVT = ERR);
      584    10104        %Y$DCLCHR /* .CC 12/12 */ (EVT = ERR);
      585    10141        %Y$DCLCHR /* .CD 12/13 */ (EVT = ERR);
      586    10178        %Y$DCLCHR /* .CE 12/14 */ (EVT = ERR);
      587    10215        %Y$DCLCHR /* .CF 12/15 */ (EVT = ERR);
      588    10252        %Y$DCLCHR /* .D0 13/0  */ (EVT = ERR);
      589    10289        %Y$DCLCHR /* .D1 13/1  */ (EVT = ERR);
      590    10326        %Y$DCLCHR /* .D2 13/2  */ (EVT = ERR);
      591    10363        %Y$DCLCHR /* .D3 13/3  */ (EVT = ERR);
      592    10400        %Y$DCLCHR /* .D4 13/4  */ (EVT = ERR);
      593    10437        %Y$DCLCHR /* .D5 13/5  */ (EVT = ERR);
      594    10474        %Y$DCLCHR /* .D6 13/6  */ (EVT = ERR);
      595    10511        %Y$DCLCHR /* .D7 13/7  */ (EVT = ERR);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:23   
      596    10548        %Y$DCLCHR /* .D8 13/8  */ (EVT = ERR);
      597    10585        %Y$DCLCHR /* .D9 13/9  */ (EVT = ERR);
      598    10622        %Y$DCLCHR /* .DA 13/10 */ (EVT = ERR);
      599    10659        %Y$DCLCHR /* .DB 13/11 */ (EVT = ERR);
      600    10696        %Y$DCLCHR /* .DC 13/12 */ (EVT = ERR);
      601    10733        %Y$DCLCHR /* .DD 13/13 */ (EVT = ERR);
      602    10770        %Y$DCLCHR /* .DE 13/14 */ (EVT = ERR);
      603    10807        %Y$DCLCHR /* .DF 13/15 */ (EVT = ERR);
      604    10844        %Y$DCLCHR /* .E0 14/0  */ (EVT = ERR);
      605    10881        %Y$DCLCHR /* .E1 14/1  */ (EVT = ERR);
      606    10918        %Y$DCLCHR /* .E2 14/2  */ (EVT = ERR);
      607    10955        %Y$DCLCHR /* .E3 14/3  */ (EVT = ERR);
      608    10992        %Y$DCLCHR /* .E4 14/4  */ (EVT = ERR);
      609    11029        %Y$DCLCHR /* .E5 14/5  */ (EVT = ERR);
      610    11066        %Y$DCLCHR /* .E6 14/6  */ (EVT = ERR);
      611    11103        %Y$DCLCHR /* .E7 14/7  */ (EVT = ERR);
      612    11140        %Y$DCLCHR /* .E8 14/8  */ (EVT = ERR);
      613    11177        %Y$DCLCHR /* .E9 14/9  */ (EVT = ERR);
      614    11214        %Y$DCLCHR /* .EA 14/10 */ (EVT = ERR);
      615    11251        %Y$DCLCHR /* .EB 14/11 */ (EVT = ERR);
      616    11288        %Y$DCLCHR /* .EC 14/12 */ (EVT = ERR);
      617    11325        %Y$DCLCHR /* .ED 14/13 */ (EVT = ERR);
      618    11362        %Y$DCLCHR /* .EE 14/14 */ (EVT = ERR);
      619    11399        %Y$DCLCHR /* .EF 14/15 */ (EVT = ERR);
      620    11436        %Y$DCLCHR /* .F0 15/0  */ (EVT = ERR);
      621    11473        %Y$DCLCHR /* .F1 15/1  */ (EVT = ERR);
      622    11510        %Y$DCLCHR /* .F2 15/2  */ (EVT = ERR);
      623    11547        %Y$DCLCHR /* .F3 15/3  */ (EVT = ERR);
      624    11584        %Y$DCLCHR /* .F4 15/4  */ (EVT = ERR);
      625    11621        %Y$DCLCHR /* .F5 15/5  */ (EVT = ERR);
      626    11658        %Y$DCLCHR /* .F6 15/6  */ (EVT = ERR);
      627    11695        %Y$DCLCHR /* .F7 15/7  */ (EVT = ERR);
      628    11732        %Y$DCLCHR /* .F8 15/8  */ (EVT = ERR);
      629    11769        %Y$DCLCHR /* .F9 15/9  */ (EVT = ERR);
      630    11806        %Y$DCLCHR /* .FA 15/10 */ (EVT = ERR);
      631    11843        %Y$DCLCHR /* .FB 15/11 */ (EVT = ERR);
      632    11880        %Y$DCLCHR /* .FC 15/12 */ (EVT = ERR);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:24   
      633    11917        %Y$DCLCHR /* .FD 15/13 */ (EVT = ERR);
      634    11954        %Y$DCLCHR /* .FE 15/14 */ (EVT = ERR);
      635    11991        %Y$DCLCHR /* .FF 15/15 */ (EVT = ERR, LAST = ";");
      636    12028
      637    12029        /*X* PLM=3,CSU=3,ECU=3,IAD=3,IND=0 */
      638    12030
      639    12031        %Y$DCLCHR (NAME = Y_EVT, STCLASS = REDEF Y_EVT_INT,
      640    12032        LAST = ";", LVL = 1);
      641    12069    1   DCL Y_CTRSQNCHR_INT CHAR(%Y#CTRSQNCHR_CNT) CONSTANT INIT(%Y#CTRSQNCHR) UNAL;
      642    12070    1   DCL Y_CTRSQNCHR(0:%(Y#CTRSQNCHR_CNT-1)) REDEF Y_CTRSQNCHR_INT UBIN BYTE UNAL;
      643    12071
      644    12072    1   DCL Y_INDCTRCHR_INT CHAR(%Y#INDCTRCHR_CNT) CONSTANT INIT(%Y#INDCTRCHR) UNAL;
      645    12073    1   DCL Y_INDCTRCHR(0:%(Y#INDCTRCHR_CNT-1)) REDEF Y_INDCTRCHR_INT UBIN BYTE UNAL;
      646    12074        %EJECT;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:25   
      647    12075    1   DCL 1 Y_EVTSTT CONSTANT,
      648    12076
      649    12077        /*X* DDA = YES */
      650    12078
      651    12079        /*
      652    12080                     Current  Character        Action              Next
      653    12081                     state    received                             state */
      654    12082
      655    12083        %Y$EVTSTT /* RCVERR   CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12083            %E$X364_ILGCE_IN_CTRSQN);
      656    12113        %Y$EVTSTT /* RCVERR   CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             12113            %E$X364_ILGCE_CSIIN_CTRSQN);
      657    12143        %Y$EVTSTT /* RCVERR   ERR    */ (ACT = NO,     NXTSTT = WATCSI);
             12143            /* Was NXTSTT = RCVERR */
      658    12173        %Y$EVTSTT /* RCVERR   ESC    */ (ACT = ERREXT, NXTSTT = WATFE, ERRCOD =
             12173            %E$X364_ILGESCIN_CTRSQN);
      659    12203        %Y$EVTSTT /* RCVERR   EXPP   */ (ACT = NO,     NXTSTT = WATCSI);
             12203            /* Was NXTSTT = RCVERR */
      660    12233        %Y$EVTSTT /* RCVERR   F_1    */ (ACT = NO,     NXTSTT = WATCSI);
      661    12263        %Y$EVTSTT /* RCVERR   F_2    */ (ACT = NO,     NXTSTT = WATCSI);
      662    12293        %Y$EVTSTT /* RCVERR   I      */ (ACT = NO,     NXTSTT = WATCSI);
             12293            /* Was NXTSTT = RCVERR */
      663    12323        %Y$EVTSTT /* RCVERR   LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12323            %E$X364_ILGLFTBRKIN_CTRSQN);
      664    12353        %Y$EVTSTT /* RCVERR   P      */ (ACT = NO,     NXTSTT = WATCSI);
             12353            /* Was NXTSTT = RCVERR */
      665    12383        %Y$EVTSTT /* RCVERR   SEMCLN */ (ACT = NO,     NXTSTT = WATCSI);
             12383            /* Was NXTSTT = RCVERR */
      666    12413        %Y$EVTSTT /* RCVEXPP  CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12413            %E$X364_ILGCE_IN_CTRSQN);
      667    12443        %Y$EVTSTT /* RCVEXPP  CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             12443            %E$X364_ILGCE_CSIIN_CTRSQN);
      668    12473        %Y$EVTSTT /* RCVEXPP  ERR    */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             12473            %E$X364_ILGCHRIN_CTRSQN);  /* Was NXTSTT = RCVERR */
      669    12503        %Y$EVTSTT /* RCVEXPP  ESC    */ (ACT = ERREXT, NXTSTT = WATFE, ERRCOD =
             12503            %E$X364_ILGESCIN_CTRSQN);
      670    12533        %Y$EVTSTT /* RCVEXPP  EXPP   */ (ACT = NO,     NXTSTT = RCVEXPP);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:26   
      671    12563        %Y$EVTSTT /* RCVEXPP  F_1    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      672    12593        %Y$EVTSTT /* RCVEXPP  F_2    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      673    12623        %Y$EVTSTT /* RCVEXPP  I      */ (ACT = NO,     NXTSTT = RCVI);
      674    12653        %Y$EVTSTT /* RCVEXPP  LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12653            %E$X364_ILGLFTBRKIN_CTRSQN);
      675    12683        %Y$EVTSTT /* RCVEXPP  P      */ (ACT = NO,     NXTSTT = RCVEXPP);
      676    12713        %Y$EVTSTT /* RCVEXPP  SEMCLN */ (ACT = NO,     NXTSTT = WATTKN);
      677    12743        %Y$EVTSTT /* RCVI     CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12743            %E$X364_ILGCE_IN_CTRSQN);
      678    12773        %Y$EVTSTT /* RCVI     CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             12773            %E$X364_ILGCE_CSIIN_CTRSQN);
      679    12803        %Y$EVTSTT /* RCVI     ERR    */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             12803            %E$X364_ILGCHRIN_CTRSQN);  /* Was NXTSTT = RCVERR */
      680    12833        %Y$EVTSTT /* RCVI     ESC    */ (ACT = ERREXT, NXTSTT = WATFE, ERRCOD =
             12833            %E$X364_ILGESCIN_CTRSQN);
      681    12863        %Y$EVTSTT /* RCVI     EXPP   */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             12863            %E$X364_ILGEXPP_AFTI);  /* Was NXTSTT = RCVERR */
      682    12893        %Y$EVTSTT /* RCVI     F_1    */ (ACT = CTRSQN_I, NXTSTT = WATCSI);
      683    12923        %Y$EVTSTT /* RCVI     F_2    */ (ACT = CTRSQN_I, NXTSTT = WATCSI);
      684    12953        %Y$EVTSTT /* RCVI     I      */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12953            %E$X364_ILGI_AFTI);
      685    12983        %Y$EVTSTT /* RCVI     LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12983            %E$X364_ILGLFTBRKIN_CTRSQN);
      686    13013        %Y$EVTSTT /* RCVI     P      */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             13013            %E$X364_ILGP_AFTI);  /* Was NXTSTT = RCVERR */
      687    13043        %Y$EVTSTT /* RCVI     SEMCLN */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             13043            %E$X364_ILGSEMCLNAFTI);  /* Was NXTSTT = RCVERR */
      688    13073        %Y$EVTSTT /* RCVP     CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13073            %E$X364_ILGCE_AFTP);
      689    13103        %Y$EVTSTT /* RCVP     CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             13103            %E$X364_ILGCE_CSIAFTP);
      690    13133        %Y$EVTSTT /* RCVP     ERR    */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             13133            %E$X364_ILGCHRAFTP);  /* Was NXTSTT = RCVERR */
      691    13163        %Y$EVTSTT /* RCVP     ESC    */ (ACT = ERREXT, NXTSTT = WATFE, ERRCOD =
             13163            %E$X364_ILGESCAFTP);
      692    13193        %Y$EVTSTT /* RCVP     EXPP   */ (ACT = NO,     NXTSTT = RCVEXPP);
      693    13223        %Y$EVTSTT /* RCVP     F_1    */ (ACT = CTRSQN, NXTSTT = WATCSI);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:27   
      694    13253        %Y$EVTSTT /* RCVP     F_2    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      695    13283        %Y$EVTSTT /* RCVP     I      */ (ACT = NO,     NXTSTT = RCVI);
      696    13313        %Y$EVTSTT /* RCVP     LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13313            %E$X364_ILGLFTBRKAFTP);
      697    13343        %Y$EVTSTT /* RCVP     P      */ (ACT = ADDACM, NXTSTT = RCVP);
      698    13373        %Y$EVTSTT /* RCVP     SEMCLN */ (ACT = NO,     NXTSTT = WATTKN);
      699    13403        %Y$EVTSTT /* WATCSI   CE     */ (ACT = INDCTR_CE, NXTSTT = WATCSI);
      700    13433        %Y$EVTSTT /* WATCSI   CE_CSI */ (ACT = INT,    NXTSTT = WATTKN);
      701    13463        %Y$EVTSTT /* WATCSI   ERR    */ (ACT = PAS,    NXTSTT = WATCSI);
      702    13493        %Y$EVTSTT /* WATCSI   ESC    */ (ACT = OTP,    NXTSTT = WATFE);
      703    13523        %Y$EVTSTT /* WATCSI   EXPP   */ (ACT = PAS,    NXTSTT = WATCSI);
      704    13553        %Y$EVTSTT /* WATCSI   F_1    */ (ACT = PAS,    NXTSTT = WATCSI);
      705    13583        %Y$EVTSTT /* WATCSI   F_2    */ (ACT = PAS,    NXTSTT = WATCSI);
      706    13613        %Y$EVTSTT /* WATCSI   I      */ (ACT = PAS,    NXTSTT = WATCSI);
      707    13643        %Y$EVTSTT /* WATCSI   LFTBRK */ (ACT = PAS,    NXTSTT = WATCSI);
      708    13673        %Y$EVTSTT /* WATCSI   P      */ (ACT = PAS,    NXTSTT = WATCSI);
      709    13703        %Y$EVTSTT /* WATCSI   SEMCLN */ (ACT = PAS,    NXTSTT = WATCSI);
      710    13733        %Y$EVTSTT /* WATFE    CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13733            %E$X364_ILGCE_AFTESC);
      711    13763        %Y$EVTSTT /* WATFE    CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             13763            %E$X364_ILGCE_CSIAFTESC);
      712    13793        %Y$EVTSTT /* WATFE    ERR    */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13793            %E$X364_ILGCHRAFTESC);
      713    13823        %Y$EVTSTT /* WATFE    ESC    */ (ACT = INT,    NXTSTT = WATTKN);
      714    13853        %Y$EVTSTT /* WATFE    EXPP   */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13853            %E$X364_ILGEXPP_AFTESC);
      715    13883        %Y$EVTSTT /* WATFE    F_1    */ (ACT = INDCTR_FE, NXTSTT = WATCSI);
      716    13913        %Y$EVTSTT /* WATFE    F_2    */ (ACT = INDCTR_FE, NXTSTT = WATCSI);
      717    13943        %Y$EVTSTT /* WATFE    I      */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13943            %E$X364_ILGI_AFTESC);
      718    13973        %Y$EVTSTT /* WATFE    LFTBRK */ (ACT = INT,    NXTSTT = WATTKN);
      719    14003        %Y$EVTSTT /* WATFE    P      */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             14003            %E$X364_ILGCHRAFTESC);
      720    14033        %Y$EVTSTT /* WATFE    SEMCLN */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             14033            %E$X364_ILGSEMCLNAFTESC);
      721    14063        %Y$EVTSTT /* WATTKN   CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             14063            %E$X364_ILGCE_IN_CTRSQN);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:28   
      722    14093        %Y$EVTSTT /* WATTKN   CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             14093            %E$X364_ILGCE_CSIIN_CTRSQN);
      723    14123        %Y$EVTSTT /* WATTKN   ERR    */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             14123            %E$X364_ILGCHRIN_CTRSQN);  /* Was NXTSTT = RCVERR */
      724    14153        %Y$EVTSTT /* WATTKN   ESC    */ (ACT = ERREXT, NXTSTT = WATFE,  ERRCOD =
             14153            %E$X364_ILGESCIN_CTRSQN);
      725    14183        %Y$EVTSTT /* WATTKN   EXPP   */ (ACT = NO,     NXTSTT = RCVEXPP);
      726    14213        %Y$EVTSTT /* WATTKN   F_1    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      727    14243        %Y$EVTSTT /* WATTKN   F_2    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      728    14273        %Y$EVTSTT /* WATTKN   I      */ (ACT = SAVI,   NXTSTT = RCVI);
      729    14303        %Y$EVTSTT /* WATTKN   LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             14303            %E$X364_ILGLFTBRKIN_CTRSQN);
      730    14333        %Y$EVTSTT /* WATTKN   P      */ (ACT = OPNACM, NXTSTT = RCVP);
      731    14363        %Y$EVTSTT /* WATTKN   SEMCLN */ (ACT = ZERACM, NXTSTT = WATTKN,
      732    14364             LAST = ";");
      733    14394    1   DCL Y_EVTSTTA(0:%((Y#EVT_HI+1)*(Y#ST_HI+1)-1)) REDEF Y_EVTSTT BIT(16);
      734    14395
      735    14396    1   DCL Y_ANSGRPRND(0:9) BIT(8) CONSTANT UNAL INIT(
      736    14397    1    '0'B, %G#GRPRND_INCINT, %G#GRPRND_DCRINT, '0'B,
      737    14398    1    %G#GRPRND_UNDSCR, %G#GRPRND_SLWBLN, %G#GRPRND_FSTBLN, %G#GRPRND_RVRVID,
      738    14399    1    %G#GRPRND_HDN, '0'B);
      739    14400        /*X* PLM=3,CSU=3,ECU=3,IAD=3,IND=0 */
      740    14401        %KV$BOX(PAGE = YES, TITLE = "Entry");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:29   
             14419    1   /***************************************************************************
             14420    1    *                                                                         *
             14421    1    *                                   Entry                                 *
             14422    1    *                                                                         *
             14423    1    ***************************************************************************/

      741    14428    1      Y@BGNCHRX = -1;
      742    14429    1      KV@VDH_OTPLCL = PRM_VDH_OTPLCL;
      743    14430    1      Y@X364$ = %KV_MVD.LINLST$;
      744    14431    1      Y@SRD$ = KV$PTR.SRD$;
      745    14432    2      IF NOT %KV_VDI.USEOTPBFR THEN DO;
      746    14433        /*
      747    14434        Call the VDH-user with KV@USR_DAT when we have data.
      748    14435        */
      749    14436    2         KV@USR_DAT = KV_USR_DAT;
      750    14437    2         KV@USR_DAT.DAT__.ADR$ = KV@VDH_OTPLCL.BFR_.ADR$;
      751    14438    2         END;                              /* END IF USEOTPBFR                   */
      752    14439    1      Y@CHRX_HI = KV@VDH_OTPLCL.BFR_.BYTSIZ + KV@VDH_OTPLCL.BFR_.BYTX;
      753    14440
      754    14441    2      DO Y@CHRX = KV@VDH_OTPLCL.BFR_.BYTX TO Y@CHRX_HI-1;
      755    14442        /*
      756    14443        This loop is iterated for each character passed in
      757    14444        PRM_VDH_OTPLCL.
      758    14445
      759    14446        Create a pointer to the event/state table entry indicated
      760    14447        by our current state and the character we're analyzing.
      761    14448        */
      762    14449    2         Y@CHR = KV@VDH_OTPLCL.BFR_.ADR$->Y$CHR(Y@CHRX);
      763    14450    2         Y@EVTSTT = Y_EVTSTTA (%KV_X364.STT*(%Y#EVT_HI+1) + Y_EVT.EVT(Y@CHR));
      764    14451    2   Y$CASE_ACT:
      765    14452    3         DO CASE Y@EVTSTT.ACT;
      766    14453
      767    14454        %KV$BOX (PAGE = YES, TITLE = "Zero -> P-accumulator");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:30   
             14472    3   /***************************************************************************
             14473    3    *                                                                         *
             14474    3    *                           Zero -> P-accumulator                         *
             14475    3    *                                                                         *
             14476    3    ***************************************************************************/

      768    14481    3         CASE %Y#ACT_ZERACM;               /* Zero -> P-accumulator              */
      769    14482    4            IF %KV_X364.P_X >= %KV#X364_P_MAXX THEN DO;
      770    14483        /*
      771    14484        The array of P values is already full.  Can't accept any more.
      772    14485        */
      773    14486        /*E* ERROR:  KVO-%E$X364_P_CNTEXC-C
      774    14487        MESSAGE0:  Too many Pn values (numeric parameters) specified on ANS
      775    14488        X3.64 function.
      776    14489        MESSAGE1:  More than 16 Pn values (numeric parameters) were specified
      777    14490        on an ANS X3.64 function sent to an ANS X3.64 virtual device.
      778    14491        */
      779    14492                    %KV_VDOERR (COD = %%E$X364_P_CNTEXC);
      780    14508    4               EXIT Y$CASE_ACT;
      781    14509    4               END;                        /* END IF P_X >= %KV#X3.64_P_MAXX     */
      782    14510
      783    14511    3            %KV_X364.P_X = %KV_X364.P_X + 1;
      784    14512    3            %KV_X364.P_VAL(%KV_X364.P_X) = 0;
      785    14513        %KV$BOX (PAGE = YES, TITLE = "Add current P digit to P-accumulator");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:31   
             14531    3   /***************************************************************************
             14532    3    *                                                                         *
             14533    3    *                    Add current P digit to P-accumulator                 *
             14534    3    *                                                                         *
             14535    3    ***************************************************************************/

      786    14540    3         CASE %Y#ACT_ADDACM;          /* Add current P digit to P-accumulator    */
      787    14541    4            IF %KV_X364.P_VAL(%KV_X364.P_X) >= 3276 THEN DO;
      788    14542        /*
      789    14543        We can't add another digit to the P value without overflow.
      790    14544        */
      791    14545        /*E* ERROR:  KVO-%E$X364_P_MAXVALEXC-C
      792    14546        MESSAGE0:  Pn value (numeric parameter) specified on ANS
      793    14547        X3.64 function is > 32750
      794    14548        MESSAGE1:  The maximum value of a Pn value (numeric parameter) specified
      795    14549        on an ANS X3.64 function sent to an ANS X3.64 virtual device is 32759.
      796    14550        */
      797    14551                    %KV_VDOERR (COD = %%E$X364_P_MAXVALEXC);
      798    14567    4               EXIT Y$CASE_ACT;
      799    14568    4               END;                        /* END IF P_VAL >= 3276               */
      800    14569    3            %KV_X364.P_VAL(%KV_X364.P_X) = (%KV_X364.P_VAL(%KV_X364.P_X) * 10) + Y@CHR
             14569                     - %ASCBIN('0');
      801    14570        %KV$BOX (PAGE = YES, TITLE = "(Perform) control sequence (no I character)");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:32   
             14588    3   /***************************************************************************
             14589    3    *                                                                         *
             14590    3    *                (Perform) control sequence (no I character)              *
             14591    3    *                                                                         *
             14592    3    ***************************************************************************/

      802    14597    3         CASE %Y#ACT_CTRSQN;     /* (Perform) control sequence (no I character)  */
      803    14598    4            IF (Y@CHR < %Y#CTRSQNCHR_F_LOW) OR (Y@CHR > %Y#CTRSQNCHR_F_HI) THEN DO;
      804    14599        /*
      805    14600        The character identifying which F this is is out of the legal range.
      806    14601        */
      807    14602        /*E* ERROR:  KVO-%E$X364_ILGF_CHR-C
      808    14603        MESSAGE0:  An apparent ANS X3.64 control sequence has an illegal
      809    14604        F character.
      810    14605        MESSAGE1:  The F (identifying) character specified
      811    14606        on an ANS X3.64 function sent to an ANS X3.64 virtual device is illegal - there is n
             14606        o such function.
      812    14607        */
      813    14608                    %KV_VDOERR (COD = %%E$X364_ILGF_CHR);
      814    14624    4               EXIT Y$CASE_ACT;
      815    14625    4               END;
             14625                    /* END IF (Y@CHR < %Y#CTRSQNCHR_F_LOW) OR (Y@CHR > %Y#CTRSQNCHR_F_HI) */
      816    14626
      817    14627        /*
      818    14628        Use the identifier character to compute our function identifer number.
      819    14629        */
      820    14630    3            Y@FNC = Y_CTRSQNCHR(Y@CHR-%Y#CTRSQNCHR_F_LOW);
      821    14631    3            CALL Y$DO_FNC;
      822    14632        %KV$BOX (PAGE = YES, TITLE = "(Perform) control sequence, with I character");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:33   
             14650    3   /***************************************************************************
             14651    3    *                                                                         *
             14652    3    *                (Perform) control sequence, with I character             *
             14653    3    *                                                                         *
             14654    3    ***************************************************************************/

      823    14659    3         CASE %Y#ACT_CTRSQN_I;   /* (Perform) control sequence, with I character */
      824    14660        /*
      825    14661        We don't currently handler any ANS functions with I characters
      826    14662        */
      827    14663        /*N* What to do if we get an I char? */
      828    14664        %KV$BOX (PAGE = YES, TITLE = "Error");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:34   
             14682    3   /***************************************************************************
             14683    3    *                                                                         *
             14684    3    *                                   Error                                 *
             14685    3    *                                                                         *
             14686    3    ***************************************************************************/

      829    14691    3         CASE %Y#ACT_ERR;                  /* Error                              */
      830    14692                 %KV_VDOERR (COD = Y@EVTSTT.ERRCOD + %Y#E$X364_ILG_LOW);
      831    14708        %KV$BOX (PAGE = YES, TITLE = "Error, exit");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:35   
             14726    4   /***************************************************************************
             14727    4    *                                                                         *
             14728    4    *                                Error, exit                              *
             14729    4    *                                                                         *
             14730    4    ***************************************************************************/

      832    14735    3         CASE %Y#ACT_ERREXT;               /* Error, exit                        */
      833    14736                 %KV_VDOERR (COD = Y@EVTSTT.ERRCOD + %Y#E$X364_ILG_LOW);
      834    14752        /*N* do we need both ERR and ERREXT? */
      835    14753        %KV$BOX (PAGE = YES, TITLE = "(Perform) independent control, Ce form");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:36   
             14771    4   /***************************************************************************
             14772    4    *                                                                         *
             14773    4    *                   (Perform) independent control, Ce form                *
             14774    4    *                                                                         *
             14775    4    ***************************************************************************/

      836    14780    3         CASE %Y#ACT_INDCTR_CE;       /* (Perform) independent control, Ce form  */
      837    14781    4            IF (Y@CHR < %Y#INDCTRCHR_CE_LOW) OR (Y@CHR > %Y#INDCTRCHR_CE_HI) THEN DO;
      838    14782        /*
      839    14783        The character identifying which CE this is is out of the legal range.
      840    14784        */
      841    14785        /*E* ERROR:  KVO-E$X364_ILGCE_CHR-C
      842    14786        MESSAGE0:  An apparent ANS X3.64 CE independent control has an illegal
      843    14787        CE character.
      844    14788        MESSAGE1:  The CE (identifying) character specified
      845    14789        on an ANS X3.64 function sent to an ANS X3.64 virtual device is illegal - there is n
             14789        o such function.
      846    14790        */
      847    14791                    %KV_VDOERR (COD = %E$X364_ILGCE_CHR);
      848    14807    4               EXIT Y$CASE_ACT;
      849    14808    4               END;
             14808                  /* END IF (Y@CHR < %Y#INDCTRCHR_CE_LOW) OR (Y@CHR > %Y#INDCTRCHR_CE_HI) */
      850    14809
      851    14810        /*
      852    14811        Use the identifier character to compute our function identifer number.
      853    14812        */
      854    14813    3            Y@FNC = Y_INDCTRCHR(Y@CHR-%Y#INDCTRCHR_CE_LOW);
      855    14814    3            CALL Y$DO_FNC;
      856    14815        %KV$BOX (PAGE = YES, TITLE = "(Perform) independent control, Fe form");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:37   
             14833    3   /***************************************************************************
             14834    3    *                                                                         *
             14835    3    *                   (Perform) independent control, Fe form                *
             14836    3    *                                                                         *
             14837    3    ***************************************************************************/

      857    14842    3         CASE %Y#ACT_INDCTR_FE;       /* (Perform) independent control, Fe form  */
      858    14843    4            IF (Y@CHR < %Y#INDCTRCHR_FE_LOW) OR (Y@CHR > %Y#INDCTRCHR_FE_HI) THEN DO;
      859    14844        /*
      860    14845        The character identifying which FE this is is out of the legal range.
      861    14846        */
      862    14847        /*E* ERROR:  KVO-E$X364_ILGFE_CHR-C
      863    14848        MESSAGE0:  An apparent ANS X3.64 FE independent control has an illegal
      864    14849        FE character.
      865    14850        MESSAGE1:  The FE (identifying) character specified
      866    14851        on an ANS X3.64 function sent to an ANS X3.64 virtual device is illegal - there is n
             14851        o such function.
      867    14852        */
      868    14853                    %KV_VDOERR (COD = %E$X364_ILGFE_CHR);
      869    14869    4               EXIT Y$CASE_ACT;
      870    14870    4               END;
             14870                  /* END IF (Y@CHR < %Y#INDCTRCHR_FE_LOW) OR (Y@CHR > %Y#INDCTRCHR_FE_HI) */
      871    14871
      872    14872        /*
      873    14873        Use the identifier character to compute our function identifer number.
      874    14874        */
      875    14875    3            Y@FNC = Y_INDCTRCHR(Y@CHR-%Y#INDCTRCHR_FE_LOW);
      876    14876    3            CALL Y$DO_FNC;
      877    14877        %KV$BOX (PAGE = YES, TITLE = "Initialize (for receiving control sequence)");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:38   
             14895    3   /***************************************************************************
             14896    3    *                                                                         *
             14897    3    *                Initialize (for receiving control sequence)              *
             14898    3    *                                                                         *
             14899    3    ***************************************************************************/

      878    14904    3         CASE %Y#ACT_INT;        /* Initialize (for receiving control sequence)  */
      879    14905    3            CALL Y$OTP;
      880    14906    3            %KV_X364.P_VAL = KV_X364.P_VAL;
      881    14907    3            %KV_X364.P_X = -1;
      882    14908        %KV$BOX (PAGE = YES, TITLE = "No action");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:39   
             14926    3   /***************************************************************************
             14927    3    *                                                                         *
             14928    3    *                                 No action                               *
             14929    3    *                                                                         *
             14930    3    ***************************************************************************/

      883    14935    3         CASE %Y#ACT_NO;                   /* No action                          */
      884    14936        %KV$BOX (PAGE = YES, TITLE = "Open P-accumulator (receiving a P)");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:40   
             14954    3   /***************************************************************************
             14955    3    *                                                                         *
             14956    3    *                     Open P-accumulator (receiving a P)                  *
             14957    3    *                                                                         *
             14958    3    ***************************************************************************/

      885    14963    3         CASE %Y#ACT_OPNACM;               /* Open P-accumulator (receiving a P) */
      886    14964    4            IF %KV_X364.P_X >= %KV#X364_P_MAXX THEN DO;
      887    14965        /*
      888    14966        The array of P values is already full.  Can't accept any more.
      889    14967        */
      890    14968                    %KV_VDOERR (COD = %E$X364_P_CNTEXC);
      891    14984    4               EXIT Y$CASE_ACT;
      892    14985    4               END;                        /* END IF P_X >= %KV#X3.64_P_MAXX     */
      893    14986
      894    14987    3            %KV_X364.P_X = %KV_X364.P_X + 1;
      895    14988    3            %KV_X364.P_VAL(%KV_X364.P_X) = Y@CHR - %ASCBIN('0');
      896    14989        %KV$BOX (PAGE = YES, TITLE = "Output 'normal' (non-3.64) text");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:41   
             15007    3   /***************************************************************************
             15008    3    *                                                                         *
             15009    3    *                      Output 'normal' (non-3.64) text                    *
             15010    3    *                                                                         *
             15011    3    ***************************************************************************/

      897    15016    3         CASE %Y#ACT_OTP;                  /* Output 'normal' (non-3.64) text    */
      898    15017    3            CALL Y$OTP;
      899    15018        %KV$BOX (PAGE = YES, TITLE = "Pass ('normal' text to OTPLCL)");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:42   
             15036    3   /***************************************************************************
             15037    3    *                                                                         *
             15038    3    *                       Pass ('normal' text to OTPLCL)                    *
             15039    3    *                                                                         *
             15040    3    ***************************************************************************/

      900    15045    3         CASE %Y#ACT_PAS;                  /* Pass ('normal' text to OTPLCL)     */
      901    15046    3            IF Y@BGNCHRX < 0 THEN
      902    15047        /*
      903    15048        We don't have a current string of characters to be passed on as-is.
      904    15049        Start one.
      905    15050        */
      906    15051    3            Y@BGNCHRX = Y@CHRX;
      907    15052        %KV$BOX (PAGE = YES, TITLE = "Save I character");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:43   
             15070    3   /***************************************************************************
             15071    3    *                                                                         *
             15072    3    *                              Save I character                           *
             15073    3    *                                                                         *
             15074    3    ***************************************************************************/

      908    15079    3         CASE %Y#ACT_SAVI;                 /* Save I character                   */
      909    15080    3            Y@I_CHR = Y@CHR;
      910    15081    3         END;                              /* END CASE .ACT                      */
      911    15082    2         %KV_X364.STT = Y@EVTSTT.NXTSTT;
      912    15083    2         END;                         /* END DO FOR Y@CHRX = Y@CHRX TO Y@CHRX_HI */
      913    15084        /*
      914    15085        Output any non-3.64 string we may have been scanning over.
      915    15086        */
      916    15087    1      CALL Y$OTP;
      917    15088        %KV$BOX(PAGE = YES, TITLE = "Do ANS X3.64 function");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:44   
             15106    1   /***************************************************************************
             15107    1    *                                                                         *
             15108    1    *                           Do ANS X3.64 function                         *
             15109    1    *                                                                         *
             15110    1    ***************************************************************************/

      918    15115    1   Y$DO_FNC: PROC;
      919    15116    2   Y$DO_CASE_FNC:
      920    15117    3      DO CASE Y@FNC;
      921    15118        %KV$BOX (PAGE = YES, TITLE = "ANS function:  All position requests");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:45   
             15136    3   /***************************************************************************
             15137    3    *                                                                         *
             15138    3    *                    ANS function:  All position requests                 *
             15139    3    *                                                                         *
             15140    3    ***************************************************************************/

      922    15145    3      CASE %Y#CTRFNC_CNL,
      923    15146    3        %Y#CTRFNC_CPL,
      924    15147    3        %Y#CTRFNC_CUB,
      925    15148    3        %Y#CTRFNC_CUD,
      926    15149    3        %Y#CTRFNC_CUF,
      927    15150    3        %Y#CTRFNC_CUU,
      928    15151    3        %Y#CTRFNC_HPR,
      929    15152    3        %Y#CTRFNC_VPR,
      930    15153    3        %Y#CTRFNC_CUP,
      931    15154    3        %Y#CTRFNC_HVP,
      932    15155    3        %Y#CTRFNC_CHA,
      933    15156    3        %Y#CTRFNC_HPA,
      934    15157    3        %Y#CTRFNC_IND,
      935    15158    3        %Y#CTRFNC_RI,
      936    15159    3        %Y#CTRFNC_NEL,
      937    15160    3        %Y#CTRFNC_VPA;
      938    15161    3         KV@VDH_PST = KV_VDH_PST_ABS_VRT_NO_SCR;
      939    15162        /*
      940    15163           Fix up MVD.VRTLIN in case we've scrolled out of the window.
      941    15164        */
      942    15165    3         IF NOT %KV_SRD.VRTPSTOK THEN CALL KVO$PST (KV_VDH_PST_0_VRT);
      943    15166    3         %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.CRT.LIN;
      944    15167    3         %KV_MVD.VRTCLM = %KV_SRD.CRT.CLM-%KV_SRD.TOPLFT.CLM+1;
      945    15168    3         %KV_SRD.HI_NONBLN.CLM = %KV_SRD.SRDEND.CLM;
      946    15169    3         %KV_SRD.HI_NONBLN.LIN = %KV_SRD.SRDEND.LIN+%KV_SRD.DVCLINBIS;
      947    15170    3         %KV_MVD.VRTLIN =
      948    15171    3           %KV_SRD.CRTVRTLINPHSLIN+%KV_SRD.DVCLINBIS-%KV_SRD.TOPLFT.LIN+1;
      949    15172    3         KV@VDH_PST.PSTVAL.LIN = %KV_MVD.VRTLIN;
      950    15173    3         KV@VDH_PST.PSTVAL.CLM = %KV_MVD.VRTCLM;
      951    15174    3         IF %KV_X364.P_VAL(0)<=0 THEN %KV_X364.P_VAL(0) = 1;
      952    15175    4         DO CASE Y@FNC;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:46   
      953    15176    4         CASE %Y#CTRFNC_CNL;               /* Cursor Next Line                   */
      954    15177    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN+%KV_X364.P_VAL(0);
      955    15178    4            KV@VDH_PST.PSTVAL.CLM = 1;
      956    15179    4         CASE %Y#CTRFNC_CPL;               /* Cursor Previous Line               */
      957    15180    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN-%KV_X364.P_VAL(0);
      958    15181    4            KV@VDH_PST.PSTVAL.CLM = 1;
      959    15182    4         CASE %Y#CTRFNC_CUB;
      960    15183    4            KV@VDH_PST.PSTVAL.CLM = KV@VDH_PST.PSTVAL.CLM-%KV_X364.P_VAL(0);
      961    15184    4         CASE %Y#CTRFNC_CUD,%Y#CTRFNC_VPR;
      962    15185    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN+%KV_X364.P_VAL(0);
      963    15186    4         CASE %Y#CTRFNC_CUF,%Y#CTRFNC_HPR;
      964    15187    4            KV@VDH_PST.PSTVAL.CLM = KV@VDH_PST.PSTVAL.CLM+%KV_X364.P_VAL(0);
      965    15188    4         CASE %Y#CTRFNC_CUU;
      966    15189    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN-%KV_X364.P_VAL(0);
      967    15190    4         CASE %Y#CTRFNC_CUP,%Y#CTRFNC_HVP;
      968    15191    4            KV@VDH_PST.PSTVAL.LIN = %KV_X364.P_VAL(0);
      969    15192    4            KV@VDH_PST.PSTVAL.CLM = MAXIMUM(%KV_X364.P_VAL(1),1);
      970    15193    4         CASE %Y#CTRFNC_CHA,%Y#CTRFNC_HPA;
      971    15194    4            KV@VDH_PST.PSTVAL.CLM = %KV_X364.P_VAL(0);
      972    15195    4         CASE %Y#CTRFNC_IND;
      973    15196    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN+1;
      974    15197    4            KV@VDH_PST.VRTSCRENB = '1'B;
      975    15198    4            GOTO Y$NO_LIN_CHK;
      976    15199    4         CASE %Y#CTRFNC_RI;
      977    15200    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN-1;
      978    15201    4            IF KV@VDH_PST.PSTVAL.LIN=0
      979    15202    4              AND (NOT %KV_SRD.VRTSCR OR NOT %KV_SRD.SCROLL)
      980    15203    4            THEN KV@VDH_PST.PSTVAL.LIN = %KV_SRD.LNG;
      981    15204        /* KVO$GNRPST knows how to scroll up */
      982    15205    4            GOTO Y$NO_LIN_CHK;
      983    15206    4         CASE %Y#CTRFNC_NEL;
      984    15207    4            KV@VDH_PST.PSTVAL.CLM = 1;
      985    15208    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN+1;
      986    15209    4            KV@VDH_PST.VRTSCRENB = '1'B;
      987    15210    4            GOTO Y$NO_LIN_CHK;
      988    15211    4         CASE %Y#CTRFNC_VPA;
      989    15212    4            KV@VDH_PST.PSTVAL.LIN = %KV_X364.P_VAL(0);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:47   
      990    15213    4         END;                              /* CASE                               */
      991    15214
      992    15215        /* Check that the cursor stays in the window.*/
      993    15216
      994    15217    3         IF KV@VDH_PST.PSTVAL.LIN>%KV_SRD.LNG
      995    15218    3         THEN KV@VDH_PST.PSTVAL.LIN = %KV_SRD.LNG;
      996    15219    3         IF KV@VDH_PST.PSTVAL.LIN<=0
      997    15220    3         THEN KV@VDH_PST.PSTVAL.LIN = 1;
      998    15221    3   Y$NO_LIN_CHK:;
      999    15222    3         IF KV@VDH_PST.PSTVAL.CLM>%KV_SRD.WDT
     1000    15223    3         THEN KV@VDH_PST.PSTVAL.CLM = %KV_SRD.WDT;
     1001    15224    3         IF KV@VDH_PST.PSTVAL.CLM<=0
     1002    15225    3         THEN KV@VDH_PST.PSTVAL.CLM = 1;
     1003    15226    3         CALL KVO$PST (KV@VDH_PST);
     1004    15227        %KV$BOX (PAGE = YES, TITLE = "ANS function:  SGR");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:48   
             15245    3   /***************************************************************************
             15246    3    *                                                                         *
             15247    3    *                             ANS function:  SGR                          *
             15248    3    *                                                                         *
             15249    3    ***************************************************************************/

     1005    15254    3      CASE %Y#CTRFNC_SGR;
     1006    15255    3         KV@USR_SETATR = KV_USR_SETATR;
     1007    15256    4         DO WHILE %KV_X364.P_X>=0;
     1008    15257    4            IF %KV_X364.P_VAL(%KV_X364.P_X)>=1
     1009    15258    4              AND %KV_X364.P_VAL(%KV_X364.P_X)<=9
     1010    15259    4            THEN KV@USR_SETATR.GRPRND = KV@USR_SETATR.GRPRND |
     1011    15260    4              Y_ANSGRPRND (%KV_X364.P_VAL(%KV_X364.P_X));
     1012    15261    4            %KV_X364.P_X = %KV_X364.P_X-1;
     1013    15262    4            END;
     1014    15263    3         KV@USR_SETATR.PHSPST = %KV_SRD.CRT;
     1015    15264    3         %KV_STR.GRPRND = KV@USR_SETATR.GRPRND;
     1016    15265    3         CALL KVV$CALUSR (KV@USR_SETATR);
     1017    15266        %KV$BOX (PAGE = YES, TITLE = "ANS function:  ED/EL");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:49   
             15284    3   /***************************************************************************
             15285    3    *                                                                         *
             15286    3    *                            ANS function:  ED/EL                         *
             15287    3    *                                                                         *
             15288    3    ***************************************************************************/

     1018    15293    3      CASE %Y#CTRFNC_ED,%Y#CTRFNC_EL;
     1019    15294        /*
     1020    15295        Initialize KV@USR_ERS so we'd erase all of the current line.
     1021    15296        Then modify according to what we've actually been asked to do.
     1022    15297        */
     1023    15298    3         KV@USR_ERS = KV_USR_ERS;
     1024    15299    3         KV@USR_ERS.TOPLFT.CLM = %KV_SRD.TOPLFT.CLM;
     1025    15300    3         KV@USR_ERS.BGNPHSCLM = KV@USR_ERS.TOPLFT.CLM;
     1026    15301    3         KV@USR_ERS.BTMRHT.CLM = %KV_SRD.BTMRHT.CLM;
     1027    15302    3         KV@USR_ERS.ENDPHSCLM = KV@USR_ERS.BTMRHT.CLM;
     1028    15303    3         KV@USR_ERS.TOPLFT.LIN = %KV_SRD.CRT.LIN+%KV_SRD.DVCLINBIS;
     1029    15304    3         KV@USR_ERS.BTMRHT.LIN = KV@USR_ERS.TOPLFT.LIN;
     1030    15305    4         DO CASE %KV_X364.P_VAL(0)+1;
     1031    15306    4         CASE 0,1;
     1032    15307        /*
     1033    15308        Erase from current position to end of line/display.
     1034    15309        */
     1035    15310    4            KV@USR_ERS.BGNPHSCLM = %KV_SRD.CRT.CLM;
     1036    15311    4            IF Y@FNC = %Y#CTRFNC_ED THEN
     1037    15312        /*
     1038    15313        This is erase-display, so erase to the end of the SRD.
     1039    15314        */
     1040    15315    4            KV@USR_ERS.BTMRHT.LIN = %KV_SRD.BTMRHT.LIN;
     1041    15316    4         CASE 2;
     1042    15317        /*
     1043    15318        Erase from  beginning of line/display to current position.
     1044    15319        */
     1045    15320    4            KV@USR_ERS.ENDPHSCLM = %KV_SRD.CRT.CLM;
     1046    15321    4            IF KV@USR_ERS.ENDPHSCLM < KV@USR_ERS.BGNPHSCLM
     1047    15322    5              AND Y@FNC = %Y#CTRFNC_ED THEN DO;
     1048    15323        /*
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:50   
     1049    15324        Use a sensible value if it makes any sense to do so.
     1050    15325        */
     1051    15326    5               KV@USR_ERS.ENDPHSCLM = KV@USR_ERS.BTMRHT.CLM;
     1052    15327    5               KV@USR_ERS.TOPLFT.LIN = KV@USR_ERS.TOPLFT.LIN-1;
     1053    15328    5               END;
     1054    15329    4            IF Y@FNC = %Y#CTRFNC_ED THEN
     1055    15330        /*
     1056    15331        This is erase-display, so erase from the beginning of the SRD.
     1057    15332        */
     1058    15333    4            KV@USR_ERS.TOPLFT.LIN = %KV_SRD.TOPLFT.LIN;
     1059    15334    4         CASE 3;
     1060    15335        /*
     1061    15336        Erase entire line/display.
     1062    15337        */
     1063    15338    5            IF Y@FNC = %Y#CTRFNC_ED THEN DO;
     1064    15339        /*
     1065    15340        This is erase-display, so erase entire SRD.
     1066    15341        */
     1067    15342    5               KV@USR_ERS.TOPLFT.LIN = %KV_SRD.TOPLFT.LIN;
     1068    15343    5               KV@USR_ERS.BTMRHT.LIN = %KV_SRD.BTMRHT.LIN;
     1069    15344    5               END;                        /* END IF Y@FNC = %Y#CTRFNC_ED        */
     1070    15345    4         CASE ELSE;
     1071    15346        /*
     1072    15347        Illegal Pn.
     1073    15348        */
     1074    15349    4            EXIT Y$DO_CASE_FNC;
     1075    15350    4         END;                              /* END CASE %KV_X364.P_VAL(0)         */
     1076    15351    3         IF KV@USR_ERS.TOPLFT.LIN>KV@USR_ERS.BTMRHT.LIN
     1077    15352    3           OR KV@USR_ERS.TOPLFT.LIN=KV@USR_ERS.BTMRHT.LIN
     1078    15353    3           AND KV@USR_ERS.BGNPHSCLM>KV@USR_ERS.ENDPHSCLM
     1079    15354    3         THEN EXIT Y$DO_CASE_FNC;
     1080    15355    3         CALL KVV$CALUSR (KV@USR_ERS);
     1081    15356    3      END Y$DO_CASE_FNC;                   /* END CASE Y$DO_CASE_FNC             */
     1082    15357    2   END Y$DO_FNC;
     1083    15358        %KV$BOX(PAGE = YES, TITLE = "Call VDH-user with KV$VDH_OTPLCL/KV$USR_DAT");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:51   
             15376    2   /***************************************************************************
             15377    2    *                                                                         *
             15378    2    *                Call VDH-user with KV$VDH_OTPLCL/KV$USR_DAT              *
             15379    2    *                                                                         *
             15380    2    ***************************************************************************/

     1084    15385    1   Y$OTP: PROC;
     1085    15386    3      IF Y@BGNCHRX >= 0 THEN DO;
     1086    15387        /*
     1087    15388        There are characters to be output.
     1088    15389        */
     1089    15390              %KV$CHNPHSPSTMOD;
             15403    4                 IF KV$PTR.VDI$->KV$VDI.OTPCNDPND.PST ~= 0 THEN DO;
             15406    4                    CALL KVV$CALUSR_PST;
             15407    4                    END;
     1090    15414    3         %KV_SRD.HI_NONBLN = %KV_SRD.SRDEND;
     1091    15415    3         %KV_SRD.FLDEND = %KV_SRD.SRDEND;
     1092    15416    3         %KV_SRD.FLDEND.LIN = %KV_SRD.FLDEND.LIN-%KV_SRD.DVCLINBIS;
     1093    15417    3         %KV_SRD.HI_NONBLN.LIN = %KV_SRD.FLDEND.LIN;
     1094    15418    4         IF %KV_VDI.USEOTPBFR THEN DO;
     1095    15419        /*
     1096    15420        We're to use the output buffer vector mechanism to output the characters.
     1097    15421        */
     1098    15422    4            KV@VDH_OTPLCL.BFR_.BYTX = Y@BGNCHRX;
     1099    15423    4            KV@VDH_OTPLCL.BFR_.BYTSIZ = Y@CHRX - Y@BGNCHRX;
     1100    15424    4            CALL KVO$OTPLCL (KV@VDH_OTPLCL);
     1101    15425    4            END; ELSE DO;                  /* ELSE USEOTPBFR                     */
     1102    15426        /*
     1103    15427        Call the VDH-user with KV@USR_DAT.
     1104    15428        */
     1105    15429    4            KV@USR_DAT.DAT__.BYTX = Y@BGNCHRX;
     1106    15430    4            KV@USR_DAT.DAT__.DATBYTSIZ = Y@CHRX - Y@BGNCHRX;
     1107    15431    4            CALL KVV$CALUSR(KV@USR_DAT);
     1108    15432    4            END;                           /* END IF USEOTPBFR                   */
     1109    15433    3         Y@BGNCHRX = -1;
     1110    15434    3         END;                              /* END IF Y@BGNCHRX >= 0              */
     1111    15435    2   END Y$OTP;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:52   
     1112    15436    1   END KVO$X364;

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:53   
--  Include file information  --

   K_CP6_M.:E05TOU  is referenced.
   KV_ERRORS_C.:E05TOU  is referenced.
   KV_INT_M.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure KVO$X364.

   Procedure KVO$X364 requires 1041 words for executable code.
   Procedure KVO$X364 requires 50 words of local(AUTO) storage.

    No errors detected in file KVO$X364.:E05TSI    .

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:54   

 Object Unit name= KVO$X364                                   File name= KVO$X364.:E05TOU
 UTS= JUL 30 '97 02:12:17.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS    279    117  KVO$X364
    1   Proc  even  none  1041    411  KVO$X364
    2  RoData even  none     2      2  KVO$X364

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KVO$X364

  ****  Data defs  ****

 Sect HexLoc  Name                           Sect HexLoc  Name
    0      0  KV_X364

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KVO$PST
 yes     yes           Std       1 KVV$CALUSR
 yes     yes           Std       0 KVV$CALUSR_PST
         yes           Std       1 KVO$OTPLCL
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:55   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KV$PTR$                          r    KV_USR_DAT                       r    KV_USR_ERS
r    KV_USR_SETATR                    r    KV_VDH_PST_ABS_VRT_NO_SCR        r    KV_VDH_PST_0_VRT
r    G$ROS$
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:56   


        1        1        /*M* KVO$X364 VDH ANS X3.64 Virtual Device Output */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*     NSO,PLM=3,SQB=Y,AND=Y,ENI=0,SDI=3,MCL=10,CSI=0,ECI=0,IND=0,IAD=3 */
        8        8        /*N* WHAT ABOUT DMI/INT/EMI/RIS (6/0 - 6/3)? */
        9        9        /*N* BOUND POSITIONING (IN KVO$PST?) */
       10       10        KVO$X364: PROC (PRM_VDH_OTPLCL);

     10   1 000000  D380 0000 0000  xent KVO$X364        LNJ,B5   X6A_AUTO_1
          1 000003       0032 0001                       DC       50,1

       11       11        %INCLUDE KV_INT_M;
       12      154
       13      155        %KV$BOX(PAGE = YES, TITLE = "SYMREFs, ENTRY declarations.");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:57   
               173        /***************************************************************************
               174         *                                                                         *
               175         *                        SYMREFs, ENTRY declarations.                     *
               176         *                                                                         *
               177         ***************************************************************************/

       14      182        /*
       15      183        Declare external procedures CALLed.
       16      184        */
       17      185    1   DCL KVO$OTPLCL ENTRY(1);
       18      186    1   DCL KVO$PST ENTRY(1);
       19      187    1   DCL KVV$CALUSR ENTRY(1) ALTRET;
       20      188    1   DCL KVV$CALUSR_PST ENTRY ALTRET;
       21      189        %KV$BOX(PAGE = YES, TITLE =
               189            "INCLUDEs, EQUs, based structures, static data defined elsewhere.");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:58   
               207    1   /***************************************************************************
               208    1    *                                                                         *
               209    1    *      INCLUDEs, EQUs, based structures, static data defined elsewhere.   *
               210    1    *                                                                         *
               211    1    ***************************************************************************/

       22      216        %INCLUDE KV_ERRORS_C;
       23      276 S      %INCLUDE KV_GLBCNS_E;
       24      277
       25      278 S      %INCLUDE KV$GLB;
       26      279 S      %INCLUDE KV$GLBCTX;
       27      280        %KV$MVD;
       28      324        %KV$PTR;
       29      367        %KV$SRD (STCLASS = "BASED(Y@SRD$)");
       30      642        %EQU KV_SRD = CHARTEXT('KV$SRD');
       31      643        %KV$STR;
       32      730        %KV$VDI;
       33      801
       34      802 S      %INCLUDE KV$INT;
       35      803        %KV$X364 (STCLASS = "BASED(Y@X364$)");
       36      837        %EQU KV_X364 = CHARTEXT('KV$X364');
       37      838
       38      839 S      %INCLUDE KV$USR;
       39      840 S      %INCLUDE KV$VDH;
       40      841
       41      842        %KV$USR_DAT (NAME = KV_USR_DAT, STCLASS = SYMREF READONLY);
       42      926        %KV$USR_ERS (NAME = KV_USR_ERS, STCLASS = SYMREF READONLY);
       43     1030        %KV$USR_SETATR (NAME = KV_USR_SETATR, STCLASS = SYMREF READONLY);
       44     1153
       45     1154        %KV$VDH_OTPLCL (NAME = PRM_VDH_OTPLCL, STCLASS = PARAM);
       46     1227        %KV$VDH_PST (NAME = KV_VDH_PST_ABS_VRT_NO_SCR, STCLASS = SYMREF READONLY);
       47     1301        %KV$VDH_PST (NAME = KV_VDH_PST_0_VRT, STCLASS = SYMREF READONLY);
       48     1375
       49     1376        %INCLUDE K_CP6_M;
       50     1572        %G#GRPRND_E;
       51     1582
       52     1583    1   DCL Y$CHR(0:0) UBIN BYTE BASED CALIGNED;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:59   
       53     1584        %KV$BOX(PAGE = YES, TITLE = "Internal EQUs");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:60   
              1602    1   /***************************************************************************
              1603    1    *                                                                         *
              1604    1    *                               Internal EQUs                             *
              1605    1    *                                                                         *
              1606    1    ***************************************************************************/

       54     1611        /* EQUs for EVenTs.
       55     1612        */
       56     1613        %EQU Y#EVT_CE = 0;                      /* Ce character (not Ce CSI) received */
       57     1614        %EQU Y#EVT_CE_CSI = 1;                  /* Ce CSI character (.9B) received    */
       58     1615        %EQU Y#EVT_ERR = 2;           /* Illegal character received in 3.64 string    */
       59     1616        %EQU Y#EVT_ESC = 3;                     /* ESC character received             */
       60     1617        %EQU Y#EVT_EXPP = 4;                    /* Experimental P  character received */
       61     1618        %EQU Y#EVT_F_1 = 5;           /* F (final) character received (our group 1)   */
       62     1619        %EQU Y#EVT_F_2 = 6;           /* F (final) character received (our group 2)   */
       63     1620        %EQU Y#EVT_I = 7;                  /* I (intermediate) character received     */
       64     1621        %EQU Y#EVT_LFTBRK = 8;             /* Left bracket ([) character received     */
       65     1622        %EQU Y#EVT_P = 9;                       /* P  character received              */
       66     1623        %EQU Y#EVT_SEMCLN = 10;                 /* Semi-colon character received      */
       67     1624
       68     1625        %EQU Y#EVT_HI = 10;                     /* Hi value                           */
       69     1626
       70     1627        /*F* NAME:  KV_Y#STT_E
       71     1628        EQUs for STaTes.
       72     1629        The *K* comments show KV]DATMOD_..; .TRF makes it # in manual.
       73     1630        */
       74     1631        /*K* RCVERR
       75     1632        .TRF ]#
       76     1633        Y]STT_RCVERR        Received error.
       77     1634        .TRF ]]
       78     1635        */
       79     1636        %EQU Y#STT_RCVERR = 0;                  /* Received error                     */
       80     1637        /*K* RCVEXPP
       81     1638        .TRF ]#
       82     1639        Y]STT_RCVEXPP       Received experimental (private) P.
       83     1640        .TRF ]]
       84     1641        */
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:61   
       85     1642        %EQU Y#STT_RCVEXPP = 1;                 /* Received experimental (private) P  */
       86     1643        /*K* RCVI
       87     1644        .TRF ]#
       88     1645        Y]STT_RCVI          Received I (intermediate) character.
       89     1646        .TRF ]]
       90     1647        */
       91     1648        %EQU Y#STT_RCVI = 2;               /* Received I (intermediate) character     */
       92     1649        /*K* RCVP
       93     1650        .TRF ]#
       94     1651        Y]STT_RCVP          Received P character.
       95     1652        .TRF ]]
       96     1653        */
       97     1654        %EQU Y#STT_RCVP = 3;                    /* Received P  character              */
       98     1655        /*K* WATCSI
       99     1656        .TRF ]#
      100     1657        Y]STT_WATCSI        Waiting for CSI.
      101     1658        .TRF ]]
      102     1659        */
      103     1660        %EQU Y#STT_WATCSI = 4;                  /* Waiting for CSI                    */
      104     1661        /*K* WATFE
      105     1662        .TRF ]#
      106     1663        Y]STT_WATFE         Waiting for Fe (after receiving ESC).
      107     1664        .TRF ]]
      108     1665        */
      109     1666        %EQU Y#STT_WATFE = 5;              /* Waiting for Fe (after receiving ESC)    */
      110     1667        /*K* WATTKN
      111     1668        .TRF ]#
      112     1669        Y]STT_WATTKN        Waiting for token (F, P, ;, I) character.
      113     1670        .TRF ]]
      114     1671        */
      115     1672        %EQU Y#STT_WATTKN = 6;        /* Waiting for token (F, P,  ;, I) character    */
      116     1673
      117     1674        %EQU Y#ST_HI = 6;                       /* Hi value                           */
      118     1675
      119     1676        /* EQUs for ACTions.
      120     1677        */
      121     1678        %EQU Y#ACT_ZERACM = 0;                  /* Zero -> P-accumulator              */
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:62   
      122     1679        %EQU Y#ACT_ADDACM = 1;             /* Add current P  digit to P-accumulator   */
      123     1680        %EQU Y#ACT_CTRSQN = 2;        /* (Perform) control sequence (no I character)  */
      124     1681        %EQU Y#ACT_CTRSQN_I = 3;      /* (Perform) control sequence, with I character */
      125     1682        %EQU Y#ACT_ERR = 4;                     /* Error                              */
      126     1683        %EQU Y#ACT_ERREXT = 5;                  /* Error, exit                        */
      127     1684        %EQU Y#ACT_INDCTR_CE = 6;          /* (Perform) independent control, Ce form  */
      128     1685        %EQU Y#ACT_INDCTR_FE = 7;          /* (Perform) independent control, Fe form  */
      129     1686        %EQU Y#ACT_INT = 8;           /* Initialize (for receiving control sequence)  */
      130     1687        %EQU Y#ACT_NO = 9;                      /* No action                          */
      131     1688        %EQU Y#ACT_OPNACM = 10;                 /* Open P-accumulator (receiving a P) */
      132     1689        %EQU Y#ACT_OTP = 11;                    /* Output 'normal' (non-3.64) text    */
      133     1690        %EQU Y#ACT_PAS = 12;                    /* Pass ('normal' text to OTPLCL)     */
      134     1691        %EQU Y#ACT_SAVI = 13;                   /* Save I character                   */
      135     1692
      136     1693        /* EQUs declaring the function of independent controls and
      137     1694        control sequences.
      138     1695        */
      139     1696        %EQU Y#CTRFNC_CHA = 2;
      140     1697        %EQU Y#CTRFNC_CHT = 3;
      141     1698        %EQU Y#CTRFNC_CNL = 4;
      142     1699        %EQU Y#CTRFNC_CPL = 5;
      143     1700        %EQU Y#CTRFNC_CPR = 6;
      144     1701        %EQU Y#CTRFNC_CTC = 7;
      145     1702        %EQU Y#CTRFNC_CUB = 8;
      146     1703        %EQU Y#CTRFNC_CUD = 9;
      147     1704        %EQU Y#CTRFNC_CUF = 10;
      148     1705        %EQU Y#CTRFNC_CUP = 11;
      149     1706        %EQU Y#CTRFNC_CUU = 1;
      150     1707        %EQU Y#CTRFNC_DAQ = 12;
      151     1708        %EQU Y#CTRFNC_DCH = 13;
      152     1709        %EQU Y#CTRFNC_DL = 14;
      153     1710        %EQU Y#CTRFNC_ECH = 15;
      154     1711        %EQU Y#CTRFNC_ED = 16;
      155     1712        %EQU Y#CTRFNC_EL = 17;
      156     1713        %EQU Y#CTRFNC_EPA = 18;
      157     1714        %EQU Y#CTRFNC_HPA = 19;
      158     1715        %EQU Y#CTRFNC_HPR = 20;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:63   
      159     1716        %EQU Y#CTRFNC_HVP = 21;
      160     1717        %EQU Y#CTRFNC_ICH = 22;
      161     1718        %EQU Y#CTRFNC_IL = 23;
      162     1719        %EQU Y#CTRFNC_IND = 24;
      163     1720        %EQU Y#CTRFNC_NEL = 25;
      164     1721        %EQU Y#CTRFNC_REP = 26;
      165     1722        %EQU Y#CTRFNC_RI = 27;
      166     1723        %EQU Y#CTRFNC_RM = 28;
      167     1724        %EQU Y#CTRFNC_SEM = 29;
      168     1725        %EQU Y#CTRFNC_SGR = 30;
      169     1726        %EQU Y#CTRFNC_SM = 31;
      170     1727        %EQU Y#CTRFNC_SPA = 32;
      171     1728        %EQU Y#CTRFNC_TBC = 33;
      172     1729        %EQU Y#CTRFNC_VPA = 34;
      173     1730        %EQU Y#CTRFNC_VPR = 35;
      174     1731
      175     1732        %EQU Y#E$X364_ILG_LOW = 1420;           /* Low value for X3.64 parse errors   */
      176     1733        %KV$BOX(PAGE = YES, TITLE = "Static data contained within this PROCedure.");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:64   
              1751    1   /***************************************************************************
              1752    1    *                                                                         *
              1753    1    *                Static data contained within this PROCedure.             *
              1754    1    *                                                                         *
              1755    1    ***************************************************************************/

      177     1760        /*
      178     1761        Static (and constant) data contained within this procedure.
      179     1762        */
      180     1763        %KV$X364(NAME = KV_X364, STCLASS = CONSTANT SYMDEF);
      181     1797
      182     1798        %KV$BOX(PAGE = YES, TITLE = "AUTO variables.");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:65   
              1816    1   /***************************************************************************
              1817    1    *                                                                         *
              1818    1    *                              AUTO variables.                            *
              1819    1    *                                                                         *
              1820    1    ***************************************************************************/

      183     1825        /*
      184     1826        AUTO variables.
      185     1827        */
      186     1828        /*
      187     1829        Pointer to KV$X364 structure.
      188     1830        */
      189     1831    1   DCL Y@X364$ PTR AUTO;
      190     1832        /*
      191     1833        Pointer to KV$SRD, since we use it so much too.
      192     1834        */
      193     1835    1   DCL Y@SRD$ PTR;
      194     1836        /*
      195     1837        Character (currently being processed).
      196     1838        */
      197     1839    1   DCL Y@CHR SBIN AUTO;
      198     1840        /*
      199     1841        Function (currently being processed).
      200     1842        */
      201     1843    1   DCL Y@FNC UBIN AUTO;
      202     1844        /*
      203     1845        ANS I (intermediate) character, saved from the current control sequence.
      204     1846        */
      205     1847    1   DCL Y@I_CHR UBIN AUTO;
      206     1848        /*
      207     1849        Beginning character index.  Index in the PRM_VDH_OTPLCL.BFR_
      208     1850        character string to the beginning of the region of characters
      209     1851        that haven't been fully processed.
      210     1852        */
      211     1853    1   DCL Y@BGNCHRX SBIN AUTO;
      212     1854        /*
      213     1855        Character index.  Index in the PRM_VDH_OTPLCL.BFR_
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:66   
      214     1856        character string to the character currently being processed.
      215     1857        */
      216     1858    1   DCL Y@CHRX SBIN AUTO;
      217     1859        /*
      218     1860        Character index hi value.  Max value for Y@CHRX.
      219     1861        */
      220     1862    1   DCL Y@CHRX_HI SBIN AUTO;
      221     1863
      222     1864        %KV$USR_DAT (NAME = KV@USR_DAT, STCLASS = AUTO);
      223     1948
      224     1949        %KV$USR_ERS (NAME = KV@USR_ERS, STCLASS = AUTO);
      225     2053
      226     2054        %KV$USR_SETATR (NAME = KV@USR_SETATR, STCLASS = AUTO);
      227     2177
      228     2178        %KV$VDH_OTPLCL (NAME = KV@VDH_OTPLCL, STCLASS = AUTO);
      229     2251
      230     2252        %KV$VDH_PST (NAME = KV@VDH_PST, STCLASS = AUTO);
      231     2326
      232     2327        %KV$BOX(PAGE = YES, TITLE = "Y$DCLCHR MACRO");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:67   
              2345    1   /***************************************************************************
              2346    1    *                                                                         *
              2347    1    *                               Y$DCLCHR MACRO                            *
              2348    1    *                                                                         *
              2349    1    ***************************************************************************/

      233     2354        /* Declare the attributes of the characters we're parsing.
      234     2355        BEWARE the unusual defaults in the %MACRO definition.
      235     2356
      236     2357        */
      237     2358        %SET Y#CHR = 0;
      238     2359
      239     2360        %EQU Y#CTRSQNCHR_F_LOW = 64;       /* Control sequence F character low value  */
      240     2361        %EQU Y#CTRSQNCHR_F_HI = 127;       /* Control sequence F character hi value   */
      241     2362        %EQU Y#CTRSQNCHR_CNT = Y#CTRSQNCHR_F_HI - Y#CTRSQNCHR_F_LOW + 1;
              2362            /* Control sequence, count (of) */
      242     2363
      243     2364        %SET Y#CTRSQNCHR =
              2364            '0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF';
      244     2365
      245     2366        %EQU Y#INDCTRCHR_FE_LOW = 64;           /* Independent control Fe low value   */
      246     2367        %EQU Y#INDCTRCHR_FE_HI = 99;            /* Independent control Fe hi value    */
      247     2368        %EQU Y#INDCTRCHR_CNT = Y#INDCTRCHR_FE_HI - Y#INDCTRCHR_FE_LOW + 1;
              2368            /* Independent control, count (of) */
      248     2369
      249     2370        %EQU Y#INDCTRCHR_CE_LOW = 128;          /* Independent control Ce low value   */
      250     2371        %EQU Y#INDCTRCHR_CE_HI = 159;           /* Independent control Ce hi value    */
      251     2372
      252     2373        %SET Y#INDCTRCHR = '0123456789ABCDEF0123456789ABCDEF0123';
      253     2374
      254     2375        %MACRO Y$DCLCHR (NAME = *, STCLASS = CONSTANT, LAST = ",", LVL = 2,
      255     2376         EVT (
      256     2377         CE = %Y#EVT_CE,
      257     2378         CE_CSI = %Y#EVT_CE_CSI,
      258     2379         ERR = %Y#EVT_ERR,
      259     2380         ESC = %Y#EVT_ESC,
      260     2381         EXPP = %Y#EVT_EXPP,
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:68   
      261     2382         F_1 = %Y#EVT_F_1,
      262     2383         F_2 = %Y#EVT_F_2,
      263     2384         I = %Y#EVT_I,
      264     2385         LFTBRK = %Y#EVT_LFTBRK,
      265     2386         P = %Y#EVT_P,
      266     2387         SEMCLN = %Y#EVT_SEMCLN) = ,
      267     2388         CTRSQN = 0,
      268     2389         INDCTR = 0);
      269     2390        %LSET LISTEXP = '1'B;
      270     2391        %LSET LISTCOM = '0'B;
      271     2392        %LSET LISTSUB = '1'B;
      272     2393        %LSET STR = SUBSTR(CONCAT(TEXTCHAR(STCLASS),'   '),0,3);
      273     2394        %IF (STR = 'STA') OR (STR = 'CON') OR (STR = 'EXT');
      274     2395        %LSET INIT = CHARTEXT(' INIT');
      275     2396        %LSET ENIT = CHARTEXT('');
      276     2397        %ELSE;
      277     2398        %LSET INIT = CHARTEXT('/*');
      278     2399        %LSET ENIT = CHARTEXT('*/');
      279     2400        %ENDIF;
      280     2401        %IF LVL = 1;
      281     2402        DCL 1 NAME(0:255) STCLASS UNAL,
      282     2403        %ELSE;
      283     2404        %IF TEXTCHAR(NAME) ~= '';
      284     2405        %(LVL) NAME,
      285     2406        %ENDIF;
      286     2407        %ENDIF;
      287     2408        %(LVL+1) %CHARTEXT('EVT') UBIN(8) %INIT(EVT)%ENIT UNAL LAST
      288     2409        /* EVT = DEC(0-31).  Event code.
      289     2410        */
      290     2411
      291     2412        %IF INIT = CHARTEXT(' INIT');
      292     2413
      293     2414        %IF Y#CHR >= Y#CTRSQNCHR_F_LOW AND Y#CHR <= Y#CTRSQNCHR_F_HI;
      294     2415        %SET Y#CTRSQNCHR = CONCAT(
      295     2416         SUBSTR(Y#CTRSQNCHR, 0, Y#CHR-Y#CTRSQNCHR_F_LOW),
      296     2417         %BINASC(CTRSQN),
      297     2418         SUBSTR(Y#CTRSQNCHR, Y#CHR-Y#CTRSQNCHR_F_LOW+1));
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:69   
      298     2419        %ELSEIF Y#CHR >= Y#INDCTRCHR_CE_LOW AND Y#CHR <= Y#INDCTRCHR_CE_HI;
      299     2420        %SET Y#INDCTRCHR = CONCAT(
      300     2421         SUBSTR(Y#INDCTRCHR, 0, Y#CHR-Y#INDCTRCHR_CE_LOW),
      301     2422         %BINASC(INDCTR),
      302     2423         SUBSTR(Y#INDCTRCHR, Y#CHR-Y#INDCTRCHR_CE_LOW+1));
      303     2424        %ENDIF;
      304     2425
      305     2426        %SET Y#CHR = Y#CHR + 1;
      306     2427        %ENDIF;
      307     2428        %MEND;
      308     2429
      309     2430        %KV$BOX(PAGE = YES, TITLE = "Y$EVTSTT MACRO");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:70   
              2448    1   /***************************************************************************
              2449    1    *                                                                         *
              2450    1    *                               Y$EVTSTT MACRO                            *
              2451    1    *                                                                         *
              2452    1    ***************************************************************************/

      310     2457        /* Event/state table entry definition.
      311     2458        The event/state table is used to parse the text received in the message.
      312     2459
      313     2460        BEWARE the unusual defaults in the %MACRO definition.
      314     2461
      315     2462        */
      316     2463        %MACRO Y$EVTSTT (NAME = *, STCLASS = CONSTANT, LAST = ",", LVL = 2,
      317     2464         ERRCOD = Y#E$X364_ILG_LOW,
      318     2465         NXTSTT (
      319     2466         RCVERR = %Y#STT_RCVERR,
      320     2467         RCVEXPP = %Y#STT_RCVEXPP,
      321     2468         RCVI = %Y#STT_RCVI,
      322     2469         RCVP = %Y#STT_RCVP,
      323     2470         WATCSI = %Y#STT_WATCSI,
      324     2471         WATFE = %Y#STT_WATFE,
      325     2472         WATTKN = %Y#STT_WATTKN) = ,
      326     2473         ACT (
      327     2474         ZERACM = %Y#ACT_ZERACM,
      328     2475         ADDACM = %Y#ACT_ADDACM,
      329     2476         CTRSQN = %Y#ACT_CTRSQN,
      330     2477         CTRSQN_I = %Y#ACT_CTRSQN_I,
      331     2478         ERR = %Y#ACT_ERR,
      332     2479         ERREXT = %Y#ACT_ERREXT,
      333     2480         INDCTR_CE = %Y#ACT_INDCTR_CE,
      334     2481         INDCTR_FE = %Y#ACT_INDCTR_FE,
      335     2482         INT = %Y#ACT_INT,
      336     2483         NO = %Y#ACT_NO,
      337     2484         OPNACM = %Y#ACT_OPNACM,
      338     2485         OTP = %Y#ACT_OTP,
      339     2486         PAS = %Y#ACT_PAS,
      340     2487         SAVI = %Y#ACT_SAVI) = );
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:71   
      341     2488        %LSET LISTDIR = '0'B;
      342     2489        %LSET LISTEXP = '1'B;
      343     2490        %LSET LISTCOM = '0'B;
      344     2491        %LSET LISTSUB = '1'B;
      345     2492        %LSET STR = SUBSTR(CONCAT(TEXTCHAR(STCLASS),'   '),0,3);
      346     2493        %IF (STR = 'STA') OR (STR = 'CON') OR (STR = 'EXT');
      347     2494        %LSET INIT = CHARTEXT(' INIT');
      348     2495        %LSET ENIT = CHARTEXT('');
      349     2496        %ELSE;
      350     2497        %LSET INIT = CHARTEXT('/*');
      351     2498        %LSET ENIT = CHARTEXT('*/');
      352     2499        %ENDIF;
      353     2500        %IF LVL = 1;
      354     2501        DCL 1 NAME ALIGNED STCLASS,
      355     2502        %ELSE;
      356     2503        %IF TEXTCHAR(NAME) ~= '';
      357     2504        %(LVL) NAME,
      358     2505        %ENDIF;
      359     2506        %ENDIF;
      360     2507        %(LVL+1) %CHARTEXT('ERRCOD') UBIN(5) %INIT(%(ERRCOD-Y#E$X364_ILG_LOW))%ENIT UNAL,
      361     2508        /* ERRCOD = DEC(0-31).  Error code, if ACT is ERR...
      362     2509        */
      363     2510        %(LVL+1) %CHARTEXT('NXTSTT') UBIN(3) %INIT(NXTSTT)%ENIT UNAL,
      364     2511        /* NXTSTT = DEC(0-7).  Next state.
      365     2512        */
      366     2513        %(LVL+1) %CHARTEXT('ACT') UBIN(8) %INIT(ACT)%ENIT UNAL LAST
      367     2514        /* ACT = DEC(0-255).  Action to take.
      368     2515        */
      369     2516        %MEND;
      370     2517
      371     2518        %Y$EVTSTT (NAME = Y@EVTSTT, STCLASS = AUTO, LVL = 1, LAST = ";");
      372     2548
      373     2549        %EJECT;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:72   
      374     2550    1   DCL 1 Y_EVT_INT CONSTANT ALIGNED,
      375     2551        /*X* DDA = YES */
      376     2552        /*
      377     2553                     Hex ANS             Event    Function
      378     2554                  Format Format                                           */
      379     2555
      380     2556        %Y$DCLCHR /* .00 0/0   */ (EVT = ERR);
      381     2593        %Y$DCLCHR /* .01 0/1   */ (EVT = ERR);
      382     2630        %Y$DCLCHR /* .02 0/2   */ (EVT = ERR);
      383     2667        %Y$DCLCHR /* .03 0/3   */ (EVT = ERR);
      384     2704        %Y$DCLCHR /* .04 0/4   */ (EVT = ERR);
      385     2741        %Y$DCLCHR /* .05 0/5   */ (EVT = ERR);
      386     2778        %Y$DCLCHR /* .06 0/6   */ (EVT = ERR);
      387     2815        %Y$DCLCHR /* .07 0/7   */ (EVT = ERR);
      388     2852        %Y$DCLCHR /* .08 0/8   */ (EVT = ERR);
      389     2889        %Y$DCLCHR /* .09 0/9   */ (EVT = ERR);
      390     2926        %Y$DCLCHR /* .0A 0/10  */ (EVT = ERR);
      391     2963        %Y$DCLCHR /* .0B 0/11  */ (EVT = ERR);
      392     3000        %Y$DCLCHR /* .0C 0/12  */ (EVT = ERR);
      393     3037        %Y$DCLCHR /* .0D 0/13  */ (EVT = ERR);
      394     3074        %Y$DCLCHR /* .0E 0/14  */ (EVT = ERR);
      395     3111        %Y$DCLCHR /* .0F 0/15  */ (EVT = ERR);
      396     3148        %Y$DCLCHR /* .10 1/0   */ (EVT = ERR);
      397     3185        %Y$DCLCHR /* .11 1/1   */ (EVT = ERR);
      398     3222        %Y$DCLCHR /* .12 1/2   */ (EVT = ERR);
      399     3259        %Y$DCLCHR /* .13 1/3   */ (EVT = ERR);
      400     3296        %Y$DCLCHR /* .14 1/4   */ (EVT = ERR);
      401     3333        %Y$DCLCHR /* .15 1/5   */ (EVT = ERR);
      402     3370        %Y$DCLCHR /* .16 1/6   */ (EVT = ERR);
      403     3407        %Y$DCLCHR /* .17 1/7   */ (EVT = ERR);
      404     3444        %Y$DCLCHR /* .18 1/8   */ (EVT = ERR);
      405     3481        %Y$DCLCHR /* .19 1/9   */ (EVT = ERR);
      406     3518        %Y$DCLCHR /* .1A 1/10  */ (EVT = ERR);
      407     3555        %Y$DCLCHR /* .1B 1/11  */ (EVT = ESC);
      408     3592        %Y$DCLCHR /* .1C 1/12  */ (EVT = ERR);
      409     3629        %Y$DCLCHR /* .1D 1/13  */ (EVT = ERR);
      410     3666        %Y$DCLCHR /* .1E 1/14  */ (EVT = ERR);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:73   
      411     3703        %Y$DCLCHR /* .1F 1/15  */ (EVT = ERR);
      412     3740        %Y$DCLCHR /* .20 2/0   */ (EVT = I);
      413     3777        %Y$DCLCHR /* .21 2/1   */ (EVT = I);
      414     3814        %Y$DCLCHR /* .22 2/2   */ (EVT = I);
      415     3851        %Y$DCLCHR /* .23 2/3   */ (EVT = I);
      416     3888        %Y$DCLCHR /* .24 2/4   */ (EVT = I);
      417     3925        %Y$DCLCHR /* .25 2/5   */ (EVT = I);
      418     3962        %Y$DCLCHR /* .26 2/6   */ (EVT = I);
      419     3999        %Y$DCLCHR /* .27 2/7   */ (EVT = I);
      420     4036        %Y$DCLCHR /* .28 2/8   */ (EVT = I);
      421     4073        %Y$DCLCHR /* .29 2/9   */ (EVT = I);
      422     4110        %Y$DCLCHR /* .2A 2/10  */ (EVT = I);
      423     4147        %Y$DCLCHR /* .2B 2/11  */ (EVT = I);
      424     4184        %Y$DCLCHR /* .2C 2/12  */ (EVT = I);
      425     4221        %Y$DCLCHR /* .2D 2/13  */ (EVT = I);
      426     4258        %Y$DCLCHR /* .2E 2/14  */ (EVT = I);
      427     4295        %Y$DCLCHR /* .2F 2/15  */ (EVT = I);
      428     4332        %Y$DCLCHR /* .30 3/0   */ (EVT = P);
      429     4369        %Y$DCLCHR /* .31 3/1   */ (EVT = P);
      430     4406        %Y$DCLCHR /* .32 3/2   */ (EVT = P);
      431     4443        %Y$DCLCHR /* .33 3/3   */ (EVT = P);
      432     4480        %Y$DCLCHR /* .34 3/4   */ (EVT = P);
      433     4517        %Y$DCLCHR /* .35 3/5   */ (EVT = P);
      434     4554        %Y$DCLCHR /* .36 3/6   */ (EVT = P);
      435     4591        %Y$DCLCHR /* .37 3/7   */ (EVT = P);
      436     4628        %Y$DCLCHR /* .38 3/8   */ (EVT = P);
      437     4665        %Y$DCLCHR /* .39 3/9   */ (EVT = P);
      438     4702        %Y$DCLCHR /* .3A 3/10  */ (EVT = ERR);
      439     4739        %Y$DCLCHR /* .3B 3/11  */ (EVT = SEMCLN);
      440     4776        %Y$DCLCHR /* .3C 3/12  */ (EVT = EXPP);
      441     4813        %Y$DCLCHR /* .3D 3/13  */ (EVT = EXPP);
      442     4850        %Y$DCLCHR /* .3E 3/14  */ (EVT = EXPP);
      443     4887        %Y$DCLCHR /* .3F 3/15  */ (EVT = EXPP);
      444     4924        %Y$DCLCHR /* .40 4/0   */ (EVT = F_1, CTRSQN = Y#CTRFNC_ICH);
      445     4961        %Y$DCLCHR /* .41 4/1   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUU);
      446     4998        %Y$DCLCHR /* .42 4/2   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUD);
      447     5035        %Y$DCLCHR /* .43 4/3   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUF);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:74   
      448     5072        %Y$DCLCHR /* .44 4/4   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUB);
      449     5109        %Y$DCLCHR /* .45 4/5   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CNL);
      450     5146        %Y$DCLCHR /* .46 4/6   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CPL);
      451     5183        %Y$DCLCHR /* .47 4/7   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CHA);
      452     5220        %Y$DCLCHR /* .48 4/8   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CUP);
      453     5257        %Y$DCLCHR /* .49 4/9   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CHT);
      454     5294        %Y$DCLCHR /* .4A 4/10  */ (EVT = F_1, CTRSQN = Y#CTRFNC_ED);
      455     5331        %Y$DCLCHR /* .4B 4/11  */ (EVT = F_1, CTRSQN = Y#CTRFNC_EL);
      456     5368        %Y$DCLCHR /* .4C 4/12  */ (EVT = F_1, CTRSQN = Y#CTRFNC_IL);
      457     5405        %Y$DCLCHR /* .4D 4/13  */ (EVT = F_1, CTRSQN = Y#CTRFNC_DL);
      458     5442        %Y$DCLCHR /* .4E 4/14  */ (EVT = F_1);
      459     5479        %Y$DCLCHR /* .4F 4/15  */ (EVT = F_1);
      460     5516        %Y$DCLCHR /* .50 5/0   */ (EVT = F_1, CTRSQN = Y#CTRFNC_DCH);
      461     5553        %Y$DCLCHR /* .51 5/1   */ (EVT = F_1, CTRSQN = Y#CTRFNC_SEM);
      462     5590        %Y$DCLCHR /* .52 5/2   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CPR);
      463     5627        %Y$DCLCHR /* .53 5/3   */ (EVT = F_1);
      464     5664        %Y$DCLCHR /* .54 5/4   */ (EVT = F_1);
      465     5701        %Y$DCLCHR /* .55 5/5   */ (EVT = F_1);
      466     5738        %Y$DCLCHR /* .56 5/6   */ (EVT = F_1);
      467     5775        %Y$DCLCHR /* .57 5/7   */ (EVT = F_1, CTRSQN = Y#CTRFNC_CTC);
      468     5812        %Y$DCLCHR /* .58 5/8   */ (EVT = F_1, CTRSQN = Y#CTRFNC_ECH);
      469     5849        %Y$DCLCHR /* .59 5/9   */ (EVT = F_1);
      470     5886        %Y$DCLCHR /* .5A 5/10  */ (EVT = F_1);
      471     5923        %Y$DCLCHR /* .5B 5/11  */ (EVT = LFTBRK);
      472     5960        %Y$DCLCHR /* .5C 5/12  */ (EVT = F_1);
      473     5997        %Y$DCLCHR /* .5D 5/13  */ (EVT = F_1);
      474     6034        %Y$DCLCHR /* .5E 5/14  */ (EVT = F_1);
      475     6071        %Y$DCLCHR /* .5F 5/15  */ (EVT = F_1);
      476     6108        %Y$DCLCHR /* .60 6/0   */ (EVT = F_2, CTRSQN = Y#CTRFNC_HPA);
      477     6145        %Y$DCLCHR /* .61 6/1   */ (EVT = F_2, CTRSQN = Y#CTRFNC_HPR);
      478     6182        %Y$DCLCHR /* .62 6/2   */ (EVT = F_2, CTRSQN = Y#CTRFNC_REP);
      479     6219        %Y$DCLCHR /* .63 6/3   */ (EVT = F_2);
      480     6256        %Y$DCLCHR /* .64 6/4   */ (EVT = F_2, CTRSQN = Y#CTRFNC_VPA);
      481     6293        %Y$DCLCHR /* .65 6/5   */ (EVT = F_2, CTRSQN = Y#CTRFNC_VPR);
      482     6330        %Y$DCLCHR /* .66 6/6   */ (EVT = F_2, CTRSQN = Y#CTRFNC_HVP);
      483     6367        %Y$DCLCHR /* .67 6/7   */ (EVT = F_2, CTRSQN = Y#CTRFNC_TBC);
      484     6404        %Y$DCLCHR /* .68 6/8   */ (EVT = F_2, CTRSQN = Y#CTRFNC_SM);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:75   
      485     6441        %Y$DCLCHR /* .69 6/9   */ (EVT = F_2);
      486     6478        %Y$DCLCHR /* .6A 6/10  */ (EVT = F_2);
      487     6515        %Y$DCLCHR /* .6B 6/11  */ (EVT = F_2);
      488     6552        %Y$DCLCHR /* .6C 6/12  */ (EVT = F_2, CTRSQN = Y#CTRFNC_RM);
      489     6589        %Y$DCLCHR /* .6D 6/13  */ (EVT = F_2, CTRSQN = Y#CTRFNC_SGR);
      490     6626        %Y$DCLCHR /* .6E 6/14  */ (EVT = F_2);
      491     6663        %Y$DCLCHR /* .6F 6/15  */ (EVT = F_2, CTRSQN = Y#CTRFNC_DAQ);
      492     6700        %Y$DCLCHR /* .70 7/0   */ (EVT = F_2);
      493     6737        %Y$DCLCHR /* .71 7/1   */ (EVT = F_2);
      494     6774        %Y$DCLCHR /* .72 7/2   */ (EVT = F_2);
      495     6811        %Y$DCLCHR /* .73 7/3   */ (EVT = F_2);
      496     6848        %Y$DCLCHR /* .74 7/4   */ (EVT = F_2);
      497     6885        %Y$DCLCHR /* .75 7/5   */ (EVT = F_2);
      498     6922        %Y$DCLCHR /* .76 7/6   */ (EVT = F_2);
      499     6959        %Y$DCLCHR /* .77 7/7   */ (EVT = F_2);
      500     6996        %Y$DCLCHR /* .78 7/8   */ (EVT = F_2);
      501     7033        %Y$DCLCHR /* .79 7/9   */ (EVT = F_2);
      502     7070        %Y$DCLCHR /* .7A 7/10  */ (EVT = F_2);
      503     7107        %Y$DCLCHR /* .7B 7/11  */ (EVT = F_2);
      504     7144        %Y$DCLCHR /* .7C 7/12  */ (EVT = F_2);
      505     7181        %Y$DCLCHR /* .7D 7/13  */ (EVT = F_2);
      506     7218        %Y$DCLCHR /* .7E 7/14  */ (EVT = F_2);
      507     7255        %Y$DCLCHR /* .7F 7/15  */ (EVT = ERR);
      508     7292        %Y$DCLCHR /* .80 8/0   */ (EVT = CE);
      509     7329        %Y$DCLCHR /* .81 8/1   */ (EVT = CE);
      510     7366        %Y$DCLCHR /* .82 8/2   */ (EVT = CE);
      511     7403        %Y$DCLCHR /* .83 8/3   */ (EVT = CE);
      512     7440        %Y$DCLCHR /* .84 8/4   */ (EVT = CE,  INDCTR = Y#CTRFNC_IND);
      513     7477        %Y$DCLCHR /* .85 8/5   */ (EVT = CE,  INDCTR = Y#CTRFNC_NEL);
      514     7514        %Y$DCLCHR /* .86 8/6   */ (EVT = CE);
      515     7551        %Y$DCLCHR /* .87 8/7   */ (EVT = CE);
      516     7588        %Y$DCLCHR /* .88 8/8   */ (EVT = CE);
      517     7625        %Y$DCLCHR /* .89 8/9   */ (EVT = CE);
      518     7662        %Y$DCLCHR /* .8A 8/10  */ (EVT = CE);
      519     7699        %Y$DCLCHR /* .8B 8/11  */ (EVT = CE);
      520     7736        %Y$DCLCHR /* .8C 8/12  */ (EVT = CE);
      521     7773        %Y$DCLCHR /* .8D 8/13  */ (EVT = CE,  INDCTR = Y#CTRFNC_RI);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:76   
      522     7810        %Y$DCLCHR /* .8E 8/14  */ (EVT = CE);
      523     7847        %Y$DCLCHR /* .8F 8/15  */ (EVT = CE);
      524     7884        %Y$DCLCHR /* .90 9/0   */ (EVT = CE);
      525     7921        %Y$DCLCHR /* .91 9/1   */ (EVT = CE);
      526     7958        %Y$DCLCHR /* .92 9/2   */ (EVT = CE);
      527     7995        %Y$DCLCHR /* .93 9/3   */ (EVT = CE);
      528     8032        %Y$DCLCHR /* .94 9/4   */ (EVT = CE);
      529     8069        %Y$DCLCHR /* .95 9/5   */ (EVT = CE);
      530     8106        %Y$DCLCHR /* .96 9/6   */ (EVT = CE,  INDCTR = Y#CTRFNC_SPA);
      531     8143        %Y$DCLCHR /* .97 9/7   */ (EVT = CE,  INDCTR = Y#CTRFNC_EPA);
      532     8180        %Y$DCLCHR /* .98 9/8   */ (EVT = CE);
      533     8217        %Y$DCLCHR /* .99 9/9   */ (EVT = CE);
      534     8254        %Y$DCLCHR /* .9A 9/10  */ (EVT = CE);
      535     8291        %Y$DCLCHR /* .9B 9/11  */ (EVT = CE_CSI);
      536     8328        %Y$DCLCHR /* .9C 9/12  */ (EVT = CE);
      537     8365        %Y$DCLCHR /* .9D 9/13  */ (EVT = CE);
      538     8402        %Y$DCLCHR /* .9E 9/14  */ (EVT = CE);
      539     8439        %Y$DCLCHR /* .9F 9/15  */ (EVT = CE);
      540     8476        %Y$DCLCHR /* .A0 10/0  */ (EVT = ERR);
      541     8513        %Y$DCLCHR /* .A1 10/1  */ (EVT = ERR);
      542     8550        %Y$DCLCHR /* .A2 10/2  */ (EVT = ERR);
      543     8587        %Y$DCLCHR /* .A3 10/3  */ (EVT = ERR);
      544     8624        %Y$DCLCHR /* .A4 10/4  */ (EVT = ERR);
      545     8661        %Y$DCLCHR /* .A5 10/5  */ (EVT = ERR);
      546     8698        %Y$DCLCHR /* .A6 10/6  */ (EVT = ERR);
      547     8735        %Y$DCLCHR /* .A7 10/7  */ (EVT = ERR);
      548     8772        %Y$DCLCHR /* .A8 10/8  */ (EVT = ERR);
      549     8809        %Y$DCLCHR /* .A9 10/9  */ (EVT = ERR);
      550     8846        %Y$DCLCHR /* .AA 10/10 */ (EVT = ERR);
      551     8883        %Y$DCLCHR /* .AB 10/11 */ (EVT = ERR);
      552     8920        %Y$DCLCHR /* .AC 10/12 */ (EVT = ERR);
      553     8957        %Y$DCLCHR /* .AD 10/13 */ (EVT = ERR);
      554     8994        %Y$DCLCHR /* .AE 10/14 */ (EVT = ERR);
      555     9031        %Y$DCLCHR /* .AF 10/15 */ (EVT = ERR);
      556     9068        %Y$DCLCHR /* .B0 11/0  */ (EVT = ERR);
      557     9105        %Y$DCLCHR /* .B1 11/1  */ (EVT = ERR);
      558     9142        %Y$DCLCHR /* .B2 11/2  */ (EVT = ERR);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:77   
      559     9179        %Y$DCLCHR /* .B3 11/3  */ (EVT = ERR);
      560     9216        %Y$DCLCHR /* .B4 11/4  */ (EVT = ERR);
      561     9253        %Y$DCLCHR /* .B5 11/5  */ (EVT = ERR);
      562     9290        %Y$DCLCHR /* .B6 11/6  */ (EVT = ERR);
      563     9327        %Y$DCLCHR /* .B7 11/7  */ (EVT = ERR);
      564     9364        %Y$DCLCHR /* .B8 11/8  */ (EVT = ERR);
      565     9401        %Y$DCLCHR /* .B9 11/9  */ (EVT = ERR);
      566     9438        %Y$DCLCHR /* .BA 11/10 */ (EVT = ERR);
      567     9475        %Y$DCLCHR /* .BB 11/11 */ (EVT = ERR);
      568     9512        %Y$DCLCHR /* .BC 11/12 */ (EVT = ERR);
      569     9549        %Y$DCLCHR /* .BD 11/13 */ (EVT = ERR);
      570     9586        %Y$DCLCHR /* .BE 11/14 */ (EVT = ERR);
      571     9623        %Y$DCLCHR /* .BF 11/15 */ (EVT = ERR);
      572     9660        %Y$DCLCHR /* .C0 12/0  */ (EVT = ERR);
      573     9697        %Y$DCLCHR /* .C1 12/1  */ (EVT = ERR);
      574     9734        %Y$DCLCHR /* .C2 12/2  */ (EVT = ERR);
      575     9771        %Y$DCLCHR /* .C3 12/3  */ (EVT = ERR);
      576     9808        %Y$DCLCHR /* .C4 12/4  */ (EVT = ERR);
      577     9845        %Y$DCLCHR /* .C5 12/5  */ (EVT = ERR);
      578     9882        %Y$DCLCHR /* .C6 12/6  */ (EVT = ERR);
      579     9919        %Y$DCLCHR /* .C7 12/7  */ (EVT = ERR);
      580     9956        %Y$DCLCHR /* .C8 12/8  */ (EVT = ERR);
      581     9993        %Y$DCLCHR /* .C9 12/9  */ (EVT = ERR);
      582    10030        %Y$DCLCHR /* .CA 12/10 */ (EVT = ERR);
      583    10067        %Y$DCLCHR /* .CB 12/11 */ (EVT = ERR);
      584    10104        %Y$DCLCHR /* .CC 12/12 */ (EVT = ERR);
      585    10141        %Y$DCLCHR /* .CD 12/13 */ (EVT = ERR);
      586    10178        %Y$DCLCHR /* .CE 12/14 */ (EVT = ERR);
      587    10215        %Y$DCLCHR /* .CF 12/15 */ (EVT = ERR);
      588    10252        %Y$DCLCHR /* .D0 13/0  */ (EVT = ERR);
      589    10289        %Y$DCLCHR /* .D1 13/1  */ (EVT = ERR);
      590    10326        %Y$DCLCHR /* .D2 13/2  */ (EVT = ERR);
      591    10363        %Y$DCLCHR /* .D3 13/3  */ (EVT = ERR);
      592    10400        %Y$DCLCHR /* .D4 13/4  */ (EVT = ERR);
      593    10437        %Y$DCLCHR /* .D5 13/5  */ (EVT = ERR);
      594    10474        %Y$DCLCHR /* .D6 13/6  */ (EVT = ERR);
      595    10511        %Y$DCLCHR /* .D7 13/7  */ (EVT = ERR);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:78   
      596    10548        %Y$DCLCHR /* .D8 13/8  */ (EVT = ERR);
      597    10585        %Y$DCLCHR /* .D9 13/9  */ (EVT = ERR);
      598    10622        %Y$DCLCHR /* .DA 13/10 */ (EVT = ERR);
      599    10659        %Y$DCLCHR /* .DB 13/11 */ (EVT = ERR);
      600    10696        %Y$DCLCHR /* .DC 13/12 */ (EVT = ERR);
      601    10733        %Y$DCLCHR /* .DD 13/13 */ (EVT = ERR);
      602    10770        %Y$DCLCHR /* .DE 13/14 */ (EVT = ERR);
      603    10807        %Y$DCLCHR /* .DF 13/15 */ (EVT = ERR);
      604    10844        %Y$DCLCHR /* .E0 14/0  */ (EVT = ERR);
      605    10881        %Y$DCLCHR /* .E1 14/1  */ (EVT = ERR);
      606    10918        %Y$DCLCHR /* .E2 14/2  */ (EVT = ERR);
      607    10955        %Y$DCLCHR /* .E3 14/3  */ (EVT = ERR);
      608    10992        %Y$DCLCHR /* .E4 14/4  */ (EVT = ERR);
      609    11029        %Y$DCLCHR /* .E5 14/5  */ (EVT = ERR);
      610    11066        %Y$DCLCHR /* .E6 14/6  */ (EVT = ERR);
      611    11103        %Y$DCLCHR /* .E7 14/7  */ (EVT = ERR);
      612    11140        %Y$DCLCHR /* .E8 14/8  */ (EVT = ERR);
      613    11177        %Y$DCLCHR /* .E9 14/9  */ (EVT = ERR);
      614    11214        %Y$DCLCHR /* .EA 14/10 */ (EVT = ERR);
      615    11251        %Y$DCLCHR /* .EB 14/11 */ (EVT = ERR);
      616    11288        %Y$DCLCHR /* .EC 14/12 */ (EVT = ERR);
      617    11325        %Y$DCLCHR /* .ED 14/13 */ (EVT = ERR);
      618    11362        %Y$DCLCHR /* .EE 14/14 */ (EVT = ERR);
      619    11399        %Y$DCLCHR /* .EF 14/15 */ (EVT = ERR);
      620    11436        %Y$DCLCHR /* .F0 15/0  */ (EVT = ERR);
      621    11473        %Y$DCLCHR /* .F1 15/1  */ (EVT = ERR);
      622    11510        %Y$DCLCHR /* .F2 15/2  */ (EVT = ERR);
      623    11547        %Y$DCLCHR /* .F3 15/3  */ (EVT = ERR);
      624    11584        %Y$DCLCHR /* .F4 15/4  */ (EVT = ERR);
      625    11621        %Y$DCLCHR /* .F5 15/5  */ (EVT = ERR);
      626    11658        %Y$DCLCHR /* .F6 15/6  */ (EVT = ERR);
      627    11695        %Y$DCLCHR /* .F7 15/7  */ (EVT = ERR);
      628    11732        %Y$DCLCHR /* .F8 15/8  */ (EVT = ERR);
      629    11769        %Y$DCLCHR /* .F9 15/9  */ (EVT = ERR);
      630    11806        %Y$DCLCHR /* .FA 15/10 */ (EVT = ERR);
      631    11843        %Y$DCLCHR /* .FB 15/11 */ (EVT = ERR);
      632    11880        %Y$DCLCHR /* .FC 15/12 */ (EVT = ERR);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:79   
      633    11917        %Y$DCLCHR /* .FD 15/13 */ (EVT = ERR);
      634    11954        %Y$DCLCHR /* .FE 15/14 */ (EVT = ERR);
      635    11991        %Y$DCLCHR /* .FF 15/15 */ (EVT = ERR, LAST = ";");
      636    12028
      637    12029        /*X* PLM=3,CSU=3,ECU=3,IAD=3,IND=0 */
      638    12030
      639    12031        %Y$DCLCHR (NAME = Y_EVT, STCLASS = REDEF Y_EVT_INT,
      640    12032        LAST = ";", LVL = 1);
      641    12069    1   DCL Y_CTRSQNCHR_INT CHAR(%Y#CTRSQNCHR_CNT) CONSTANT INIT(%Y#CTRSQNCHR) UNAL;
      642    12070    1   DCL Y_CTRSQNCHR(0:%(Y#CTRSQNCHR_CNT-1)) REDEF Y_CTRSQNCHR_INT UBIN BYTE UNAL;
      643    12071
      644    12072    1   DCL Y_INDCTRCHR_INT CHAR(%Y#INDCTRCHR_CNT) CONSTANT INIT(%Y#INDCTRCHR) UNAL;
      645    12073    1   DCL Y_INDCTRCHR(0:%(Y#INDCTRCHR_CNT-1)) REDEF Y_INDCTRCHR_INT UBIN BYTE UNAL;
      646    12074        %EJECT;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:80   
      647    12075    1   DCL 1 Y_EVTSTT CONSTANT,
      648    12076
      649    12077        /*X* DDA = YES */
      650    12078
      651    12079        /*
      652    12080                     Current  Character        Action              Next
      653    12081                     state    received                             state */
      654    12082
      655    12083        %Y$EVTSTT /* RCVERR   CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12083            %E$X364_ILGCE_IN_CTRSQN);
      656    12113        %Y$EVTSTT /* RCVERR   CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             12113            %E$X364_ILGCE_CSIIN_CTRSQN);
      657    12143        %Y$EVTSTT /* RCVERR   ERR    */ (ACT = NO,     NXTSTT = WATCSI);
             12143            /* Was NXTSTT = RCVERR */
      658    12173        %Y$EVTSTT /* RCVERR   ESC    */ (ACT = ERREXT, NXTSTT = WATFE, ERRCOD =
             12173            %E$X364_ILGESCIN_CTRSQN);
      659    12203        %Y$EVTSTT /* RCVERR   EXPP   */ (ACT = NO,     NXTSTT = WATCSI);
             12203            /* Was NXTSTT = RCVERR */
      660    12233        %Y$EVTSTT /* RCVERR   F_1    */ (ACT = NO,     NXTSTT = WATCSI);
      661    12263        %Y$EVTSTT /* RCVERR   F_2    */ (ACT = NO,     NXTSTT = WATCSI);
      662    12293        %Y$EVTSTT /* RCVERR   I      */ (ACT = NO,     NXTSTT = WATCSI);
             12293            /* Was NXTSTT = RCVERR */
      663    12323        %Y$EVTSTT /* RCVERR   LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12323            %E$X364_ILGLFTBRKIN_CTRSQN);
      664    12353        %Y$EVTSTT /* RCVERR   P      */ (ACT = NO,     NXTSTT = WATCSI);
             12353            /* Was NXTSTT = RCVERR */
      665    12383        %Y$EVTSTT /* RCVERR   SEMCLN */ (ACT = NO,     NXTSTT = WATCSI);
             12383            /* Was NXTSTT = RCVERR */
      666    12413        %Y$EVTSTT /* RCVEXPP  CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12413            %E$X364_ILGCE_IN_CTRSQN);
      667    12443        %Y$EVTSTT /* RCVEXPP  CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             12443            %E$X364_ILGCE_CSIIN_CTRSQN);
      668    12473        %Y$EVTSTT /* RCVEXPP  ERR    */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             12473            %E$X364_ILGCHRIN_CTRSQN);  /* Was NXTSTT = RCVERR */
      669    12503        %Y$EVTSTT /* RCVEXPP  ESC    */ (ACT = ERREXT, NXTSTT = WATFE, ERRCOD =
             12503            %E$X364_ILGESCIN_CTRSQN);
      670    12533        %Y$EVTSTT /* RCVEXPP  EXPP   */ (ACT = NO,     NXTSTT = RCVEXPP);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:81   
      671    12563        %Y$EVTSTT /* RCVEXPP  F_1    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      672    12593        %Y$EVTSTT /* RCVEXPP  F_2    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      673    12623        %Y$EVTSTT /* RCVEXPP  I      */ (ACT = NO,     NXTSTT = RCVI);
      674    12653        %Y$EVTSTT /* RCVEXPP  LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12653            %E$X364_ILGLFTBRKIN_CTRSQN);
      675    12683        %Y$EVTSTT /* RCVEXPP  P      */ (ACT = NO,     NXTSTT = RCVEXPP);
      676    12713        %Y$EVTSTT /* RCVEXPP  SEMCLN */ (ACT = NO,     NXTSTT = WATTKN);
      677    12743        %Y$EVTSTT /* RCVI     CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12743            %E$X364_ILGCE_IN_CTRSQN);
      678    12773        %Y$EVTSTT /* RCVI     CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             12773            %E$X364_ILGCE_CSIIN_CTRSQN);
      679    12803        %Y$EVTSTT /* RCVI     ERR    */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             12803            %E$X364_ILGCHRIN_CTRSQN);  /* Was NXTSTT = RCVERR */
      680    12833        %Y$EVTSTT /* RCVI     ESC    */ (ACT = ERREXT, NXTSTT = WATFE, ERRCOD =
             12833            %E$X364_ILGESCIN_CTRSQN);
      681    12863        %Y$EVTSTT /* RCVI     EXPP   */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             12863            %E$X364_ILGEXPP_AFTI);  /* Was NXTSTT = RCVERR */
      682    12893        %Y$EVTSTT /* RCVI     F_1    */ (ACT = CTRSQN_I, NXTSTT = WATCSI);
      683    12923        %Y$EVTSTT /* RCVI     F_2    */ (ACT = CTRSQN_I, NXTSTT = WATCSI);
      684    12953        %Y$EVTSTT /* RCVI     I      */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12953            %E$X364_ILGI_AFTI);
      685    12983        %Y$EVTSTT /* RCVI     LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             12983            %E$X364_ILGLFTBRKIN_CTRSQN);
      686    13013        %Y$EVTSTT /* RCVI     P      */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             13013            %E$X364_ILGP_AFTI);  /* Was NXTSTT = RCVERR */
      687    13043        %Y$EVTSTT /* RCVI     SEMCLN */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             13043            %E$X364_ILGSEMCLNAFTI);  /* Was NXTSTT = RCVERR */
      688    13073        %Y$EVTSTT /* RCVP     CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13073            %E$X364_ILGCE_AFTP);
      689    13103        %Y$EVTSTT /* RCVP     CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             13103            %E$X364_ILGCE_CSIAFTP);
      690    13133        %Y$EVTSTT /* RCVP     ERR    */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             13133            %E$X364_ILGCHRAFTP);  /* Was NXTSTT = RCVERR */
      691    13163        %Y$EVTSTT /* RCVP     ESC    */ (ACT = ERREXT, NXTSTT = WATFE, ERRCOD =
             13163            %E$X364_ILGESCAFTP);
      692    13193        %Y$EVTSTT /* RCVP     EXPP   */ (ACT = NO,     NXTSTT = RCVEXPP);
      693    13223        %Y$EVTSTT /* RCVP     F_1    */ (ACT = CTRSQN, NXTSTT = WATCSI);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:82   
      694    13253        %Y$EVTSTT /* RCVP     F_2    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      695    13283        %Y$EVTSTT /* RCVP     I      */ (ACT = NO,     NXTSTT = RCVI);
      696    13313        %Y$EVTSTT /* RCVP     LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13313            %E$X364_ILGLFTBRKAFTP);
      697    13343        %Y$EVTSTT /* RCVP     P      */ (ACT = ADDACM, NXTSTT = RCVP);
      698    13373        %Y$EVTSTT /* RCVP     SEMCLN */ (ACT = NO,     NXTSTT = WATTKN);
      699    13403        %Y$EVTSTT /* WATCSI   CE     */ (ACT = INDCTR_CE, NXTSTT = WATCSI);
      700    13433        %Y$EVTSTT /* WATCSI   CE_CSI */ (ACT = INT,    NXTSTT = WATTKN);
      701    13463        %Y$EVTSTT /* WATCSI   ERR    */ (ACT = PAS,    NXTSTT = WATCSI);
      702    13493        %Y$EVTSTT /* WATCSI   ESC    */ (ACT = OTP,    NXTSTT = WATFE);
      703    13523        %Y$EVTSTT /* WATCSI   EXPP   */ (ACT = PAS,    NXTSTT = WATCSI);
      704    13553        %Y$EVTSTT /* WATCSI   F_1    */ (ACT = PAS,    NXTSTT = WATCSI);
      705    13583        %Y$EVTSTT /* WATCSI   F_2    */ (ACT = PAS,    NXTSTT = WATCSI);
      706    13613        %Y$EVTSTT /* WATCSI   I      */ (ACT = PAS,    NXTSTT = WATCSI);
      707    13643        %Y$EVTSTT /* WATCSI   LFTBRK */ (ACT = PAS,    NXTSTT = WATCSI);
      708    13673        %Y$EVTSTT /* WATCSI   P      */ (ACT = PAS,    NXTSTT = WATCSI);
      709    13703        %Y$EVTSTT /* WATCSI   SEMCLN */ (ACT = PAS,    NXTSTT = WATCSI);
      710    13733        %Y$EVTSTT /* WATFE    CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13733            %E$X364_ILGCE_AFTESC);
      711    13763        %Y$EVTSTT /* WATFE    CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             13763            %E$X364_ILGCE_CSIAFTESC);
      712    13793        %Y$EVTSTT /* WATFE    ERR    */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13793            %E$X364_ILGCHRAFTESC);
      713    13823        %Y$EVTSTT /* WATFE    ESC    */ (ACT = INT,    NXTSTT = WATTKN);
      714    13853        %Y$EVTSTT /* WATFE    EXPP   */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13853            %E$X364_ILGEXPP_AFTESC);
      715    13883        %Y$EVTSTT /* WATFE    F_1    */ (ACT = INDCTR_FE, NXTSTT = WATCSI);
      716    13913        %Y$EVTSTT /* WATFE    F_2    */ (ACT = INDCTR_FE, NXTSTT = WATCSI);
      717    13943        %Y$EVTSTT /* WATFE    I      */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             13943            %E$X364_ILGI_AFTESC);
      718    13973        %Y$EVTSTT /* WATFE    LFTBRK */ (ACT = INT,    NXTSTT = WATTKN);
      719    14003        %Y$EVTSTT /* WATFE    P      */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             14003            %E$X364_ILGCHRAFTESC);
      720    14033        %Y$EVTSTT /* WATFE    SEMCLN */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             14033            %E$X364_ILGSEMCLNAFTESC);
      721    14063        %Y$EVTSTT /* WATTKN   CE     */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             14063            %E$X364_ILGCE_IN_CTRSQN);
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:83   
      722    14093        %Y$EVTSTT /* WATTKN   CE_CSI */ (ACT = ERREXT, NXTSTT = WATTKN, ERRCOD =
             14093            %E$X364_ILGCE_CSIIN_CTRSQN);
      723    14123        %Y$EVTSTT /* WATTKN   ERR    */ (ACT = ERR,    NXTSTT = WATCSI, ERRCOD =
             14123            %E$X364_ILGCHRIN_CTRSQN);  /* Was NXTSTT = RCVERR */
      724    14153        %Y$EVTSTT /* WATTKN   ESC    */ (ACT = ERREXT, NXTSTT = WATFE,  ERRCOD =
             14153            %E$X364_ILGESCIN_CTRSQN);
      725    14183        %Y$EVTSTT /* WATTKN   EXPP   */ (ACT = NO,     NXTSTT = RCVEXPP);
      726    14213        %Y$EVTSTT /* WATTKN   F_1    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      727    14243        %Y$EVTSTT /* WATTKN   F_2    */ (ACT = CTRSQN, NXTSTT = WATCSI);
      728    14273        %Y$EVTSTT /* WATTKN   I      */ (ACT = SAVI,   NXTSTT = RCVI);
      729    14303        %Y$EVTSTT /* WATTKN   LFTBRK */ (ACT = ERREXT, NXTSTT = WATCSI, ERRCOD =
             14303            %E$X364_ILGLFTBRKIN_CTRSQN);
      730    14333        %Y$EVTSTT /* WATTKN   P      */ (ACT = OPNACM, NXTSTT = RCVP);
      731    14363        %Y$EVTSTT /* WATTKN   SEMCLN */ (ACT = ZERACM, NXTSTT = WATTKN,
      732    14364             LAST = ";");
      733    14394    1   DCL Y_EVTSTTA(0:%((Y#EVT_HI+1)*(Y#ST_HI+1)-1)) REDEF Y_EVTSTT BIT(16);
      734    14395
      735    14396    1   DCL Y_ANSGRPRND(0:9) BIT(8) CONSTANT UNAL INIT(
      736    14397    1    '0'B, %G#GRPRND_INCINT, %G#GRPRND_DCRINT, '0'B,
      737    14398    1    %G#GRPRND_UNDSCR, %G#GRPRND_SLWBLN, %G#GRPRND_FSTBLN, %G#GRPRND_RVRVID,
      738    14399    1    %G#GRPRND_HDN, '0'B);
      739    14400        /*X* PLM=3,CSU=3,ECU=3,IAD=3,IND=0 */
      740    14401        %KV$BOX(PAGE = YES, TITLE = "Entry");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:84   
             14419    1   /***************************************************************************
             14420    1    *                                                                         *
             14421    1    *                                   Entry                                 *
             14422    1    *                                                                         *
             14423    1    ***************************************************************************/

      741    14428    1      Y@BGNCHRX = -1;

  14428   1 000005  8947 000D                            LBT,'FFFF'X       Y@BGNCHRX,AUTO
  14428   1 000007       FFFF

      742    14429    1      KV@VDH_OTPLCL = PRM_VDH_OTPLCL;

  14429   1 000008  ACC7 0004                            LDB,B2   @PRM_VDH_OTPLCL,AUTO
          1 00000A  2C00                                 LDV,R2   0
          1 00000B  6C0A                                 LDV,R6   10
          1 00000C  BB87                                 LAB,B3   ,AUTO
          1 00000D  3C46                                 LDV,R3   70
          1 00000E  0008                                 MMM

      743    14430    1      Y@X364$ = %KV_MVD.LINLST$;

  14430   1 00000F  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          1 000012  DCC6 0006                            LDB,B5   6,B6
          1 000014  CCC5 0010                            LDB,B4   16,B5
          1 000016  CFC7 0006                            STB,B4   Y@X364$,AUTO

      744    14431    1      Y@SRD$ = KV$PTR.SRD$;

  14431   1 000018  9CC6 000A                            LDB,B1   10,B6
          1 00001A  9FC7 0008                            STB,B1   Y@SRD$,AUTO

      745    14432    2      IF NOT %KV_VDI.USEOTPBFR THEN DO;

  14432   1 00001C  DC86                                 LDB,B5   ,B6
          1 00001D  82C5 001D                            LB,'0200'X        29,B5
          1 00001F       0200
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:85   
          1 000020  0501 000D                            BBT      s:14439,PREL

      746    14433        /*
      747    14434        Call the VDH-user with KV@USR_DAT when we have data.
      748    14435        */
      749    14436    2         KV@USR_DAT = KV_USR_DAT;

  14436   1 000022  AB80 0000 0000  xsym                 LAB,B2   KV_USR_DAT
          1 000025  2C00                                 LDV,R2   0
          1 000026  6C10                                 LDV,R6   16
          1 000027  BB87                                 LAB,B3   ,AUTO
          1 000028  3C20                                 LDV,R3   32
          1 000029  0008                                 MMM

      750    14437    2         KV@USR_DAT.DAT__.ADR$ = KV@VDH_OTPLCL.BFR_.ADR$;

  14437   1 00002A  ECC7 0024                            LDB,B6   KV@VDH_OTPLCL+1,AUTO
          1 00002C  EFC7 0011                            STB,B6   KV@USR_DAT+1,AUTO

      751    14438    2         END;                              /* END IF USEOTPBFR                   */

      752    14439    1      Y@CHRX_HI = KV@VDH_OTPLCL.BFR_.BYTSIZ + KV@VDH_OTPLCL.BFR_.BYTX;

  14439   1 00002E  E847 0027                            LDR,R6   KV@VDH_OTPLCL+4,AUTO
          1 000030  EA47 0026                            ADD,R6   KV@VDH_OTPLCL+3,AUTO
          1 000032  EF47 000F                            STR,R6   Y@CHRX_HI,AUTO

      753    14440
      754    14441    2      DO Y@CHRX = KV@VDH_OTPLCL.BFR_.BYTX TO Y@CHRX_HI-1;

  14441   1 000034  D847 0026                            LDR,R5   KV@VDH_OTPLCL+3,AUTO
          1 000036  DF47 000E                            STR,R5   Y@CHRX,AUTO
          1 000038  0F81 0147                            B        s:15083+2,PREL

      755    14442        /*
      756    14443        This loop is iterated for each character passed in
      757    14444        PRM_VDH_OTPLCL.
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:86   
      758    14445
      759    14446        Create a pointer to the event/state table entry indicated
      760    14447        by our current state and the character we're analyzing.
      761    14448        */
      762    14449    2         Y@CHR = KV@VDH_OTPLCL.BFR_.ADR$->Y$CHR(Y@CHRX);

  14449   1 00003A  ECC7 0024                            LDB,B6   KV@VDH_OTPLCL+1,AUTO
          1 00003C  B847 000E                            LDR,R3   Y@CHRX,AUTO
          1 00003E  E2B6                                 LLH,R6   ,B6,R3
          1 00003F  EF47 000A                            STR,R6   Y@CHR,AUTO

      763    14450    2         Y@EVTSTT = Y_EVTSTTA (%KV_X364.STT*(%Y#EVT_HI+1) + Y_EVT.EVT(Y@CHR));

  14450   1 000041  DCC7 0006                            LDB,B5   Y@X364$,AUTO
          1 000043  D805                                 LDR,R5   ,B5
          1 000044  5F0B                                 MLV,R5   11
          1 000045  A856                                 LDR,R2   R6
          1 000046  C2A0 0000 0013  00                   LLH,R4   Y_EVT_INT,R2
          1 000049  DA54                                 ADD,R5   R4
          1 00004A  9855                                 LDR,R1   R5
          1 00004B  D810 0000 00C5  00                   LDR,R5   Y_EVTSTT,R1
          1 00004E  DF47 002C                            STR,R5   Y@EVTSTT,AUTO

      764    14451    2   Y$CASE_ACT:
      765    14452    3         DO CASE Y@EVTSTT.ACT;

  14452   1 000050  9847 002C            Y$CASE_ACT      LDR,R1   Y@EVTSTT,AUTO
          1 000052  9570 00FF                            AND,R1   255,IMO
          1 000054  1D0E                                 CMV,R1   14
          1 000055  0281 0120                            BGE      s:15082,PREL
          1 000057  B810 0000 005D  01                   LDR,R3   Y$CASE_ACT+13,R1
          1 00005A  83B0 0000 006B  01                   JMP      s:14482,R3
          1 00005D       0000                            DC       s:14482,PREL
          1 00005E       001C                            DC       s:14541,PREL
          1 00005F       0047                            DC       s:14598,PREL
          1 000060       010B                            DC       s:15082,PREL
          1 000061       0066                            DC       s:14698,PREL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:87   
          1 000062       0078                            DC       s:14742,PREL
          1 000063       008A                            DC       s:14781,PREL
          1 000064       00AB                            DC       s:14843,PREL
          1 000065       00CA                            DC       s:14905,PREL
          1 000066       010B                            DC       s:15082,PREL
          1 000067       00DD                            DC       s:14964,PREL
          1 000068       00FA                            DC       s:15017,PREL
          1 000069       00FF                            DC       s:15046,PREL
          1 00006A       0109                            DC       s:15080,PREL

      766    14453
      767    14454        %KV$BOX (PAGE = YES, TITLE = "Zero -> P-accumulator");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:88   
             14472    3   /***************************************************************************
             14473    3    *                                                                         *
             14474    3    *                           Zero -> P-accumulator                         *
             14475    3    *                                                                         *
             14476    3    ***************************************************************************/

      768    14481    3         CASE %Y#ACT_ZERACM;               /* Zero -> P-accumulator              */

      769    14482    4            IF %KV_X364.P_X >= %KV#X364_P_MAXX THEN DO;

  14482   1 00006B  E845 0001                            LDR,R6   1,B5
          1 00006D  6D10                                 CMV,R6   16
          1 00006E  0801 0010                            BAL      s:14511,PREL

      770    14483        /*
      771    14484        The array of P values is already full.  Can't accept any more.
      772    14485        */
      773    14486        /*E* ERROR:  KVO-%E$X364_P_CNTEXC-C
      774    14487        MESSAGE0:  Too many Pn values (numeric parameters) specified on ANS
      775    14488        X3.64 function.
      776    14489        MESSAGE1:  More than 16 Pn values (numeric parameters) were specified
      777    14490        on an ANS X3.64 function sent to an ANS X3.64 virtual device.
      778    14491        */
      779    14492                    %KV_VDOERR (COD = %%E$X364_P_CNTEXC);

  14498   1 000070  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 000073  BCC4 0004                            LDB,B3   4,B4
          1 000075  E843 0013                            LDR,R6   19,B3
          1 000077  6981 0005                            BNEZ,R6  s:14508,PREL

  14502   1 000079  E870 0587                            LDR,R6   1415,IMO
          1 00007B  EF43 0013                            STR,R6   19,B3

      780    14508    4               EXIT Y$CASE_ACT;

  14508   1 00007D  0F81 00F8                            B        s:15082,PREL

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:89   
      781    14509    4               END;                        /* END IF P_X >= %KV#X3.64_P_MAXX     */
      782    14510
      783    14511    3            %KV_X364.P_X = %KV_X364.P_X + 1;

  14511   1 00007F  8AC5 0001                            INC      1,B5

      784    14512    3            %KV_X364.P_VAL(%KV_X364.P_X) = 0;

  14512   1 000081  B845 0001                            LDR,R3   1,B5
          1 000083  3E02                                 ADV,R3   2
          1 000084  8735                                 CL       ,B5,R3
          1 000085  0F81 00F0                            B        s:15082,PREL

      785    14513        %KV$BOX (PAGE = YES, TITLE = "Add current P digit to P-accumulator");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:90   
             14531    3   /***************************************************************************
             14532    3    *                                                                         *
             14533    3    *                    Add current P digit to P-accumulator                 *
             14534    3    *                                                                         *
             14535    3    ***************************************************************************/

      786    14540    3         CASE %Y#ACT_ADDACM;          /* Add current P digit to P-accumulator    */

      787    14541    4            IF %KV_X364.P_VAL(%KV_X364.P_X) >= 3276 THEN DO;

  14541   1 000087  B845 0001                            LDR,R3   1,B5
          1 000089  BF47 0030                            STR,R3   Y@EVTSTT+4,AUTO
          1 00008B  3E02                                 ADV,R3   2
          1 00008C  B847 0030                            LDR,R3   Y@EVTSTT+4,AUTO
          1 00008E  3E02                                 ADV,R3   2
          1 00008F  E835                                 LDR,R6   ,B5,R3
          1 000090  E970 0CCC                            CMR,R6   3276,IMO
          1 000092  0801 0010                            BAL      s:14569,PREL

      788    14542        /*
      789    14543        We can't add another digit to the P value without overflow.
      790    14544        */
      791    14545        /*E* ERROR:  KVO-%E$X364_P_MAXVALEXC-C
      792    14546        MESSAGE0:  Pn value (numeric parameter) specified on ANS
      793    14547        X3.64 function is > 32750
      794    14548        MESSAGE1:  The maximum value of a Pn value (numeric parameter) specified
      795    14549        on an ANS X3.64 function sent to an ANS X3.64 virtual device is 32759.
      796    14550        */
      797    14551                    %KV_VDOERR (COD = %%E$X364_P_MAXVALEXC);

  14557   1 000094  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 000097  BCC4 0004                            LDB,B3   4,B4
          1 000099  E843 0013                            LDR,R6   19,B3
          1 00009B  6981 0005                            BNEZ,R6  s:14567,PREL

  14561   1 00009D  E870 0588                            LDR,R6   1416,IMO
          1 00009F  EF43 0013                            STR,R6   19,B3
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:91   

      798    14567    4               EXIT Y$CASE_ACT;

  14567   1 0000A1  0F81 00D4                            B        s:15082,PREL

      799    14568    4               END;                        /* END IF P_VAL >= 3276               */
      800    14569    3            %KV_X364.P_VAL(%KV_X364.P_X) = (%KV_X364.P_VAL(%KV_X364.P_X) * 10) + Y@CHR
             14569                     - %ASCBIN('0');

  14569   1 0000A3  B845 0001                            LDR,R3   1,B5
          1 0000A5  BF47 0030                            STR,R3   Y@EVTSTT+4,AUTO
          1 0000A7  3E02                                 ADV,R3   2
          1 0000A8  E835                                 LDR,R6   ,B5,R3
          1 0000A9  6F0A                                 MLV,R6   10
          1 0000AA  EA52                                 ADD,R6   R2
          1 0000AB  B847 0030                            LDR,R3   Y@EVTSTT+4,AUTO
          1 0000AD  3E02                                 ADV,R3   2
          1 0000AE  6ED0                                 ADV,R6   -48
          1 0000AF  EF35                                 STR,R6   ,B5,R3
          1 0000B0  0F81 00C5                            B        s:15082,PREL

      801    14570        %KV$BOX (PAGE = YES, TITLE = "(Perform) control sequence (no I character)");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:92   
             14588    3   /***************************************************************************
             14589    3    *                                                                         *
             14590    3    *                (Perform) control sequence (no I character)              *
             14591    3    *                                                                         *
             14592    3    ***************************************************************************/

      802    14597    3         CASE %Y#ACT_CTRSQN;     /* (Perform) control sequence (no I character)  */

      803    14598    4            IF (Y@CHR < %Y#CTRSQNCHR_F_LOW) OR (Y@CHR > %Y#CTRSQNCHR_F_HI) THEN DO;

  14598   1 0000B2  2D40                                 CMV,R2   64
          1 0000B3  0801 0004                            BAL      s:14614,PREL
          1 0000B5  2D7F                                 CMV,R2   127
          1 0000B6  0A81 0010                            BALE     s:14630,PREL

      804    14599        /*
      805    14600        The character identifying which F this is is out of the legal range.
      806    14601        */
      807    14602        /*E* ERROR:  KVO-%E$X364_ILGF_CHR-C
      808    14603        MESSAGE0:  An apparent ANS X3.64 control sequence has an illegal
      809    14604        F character.
      810    14605        MESSAGE1:  The F (identifying) character specified
      811    14606       on an ANS X3.64 function sent to an ANS X3.64 virtual device is illegal - there is n
             14606        o such function.
      812    14607        */
      813    14608                    %KV_VDOERR (COD = %%E$X364_ILGF_CHR);

  14614   1 0000B8  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 0000BB  BCC4 0004                            LDB,B3   4,B4
          1 0000BD  E843 0013                            LDR,R6   19,B3
          1 0000BF  6981 0005                            BNEZ,R6  s:14624,PREL

  14618   1 0000C1  E870 0589                            LDR,R6   1417,IMO
          1 0000C3  EF43 0013                            STR,R6   19,B3

      814    14624    4               EXIT Y$CASE_ACT;

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:93   
  14624   1 0000C5  0F81 00B0                            B        s:15082,PREL

      815    14625    4               END;
             14625                   /* END IF (Y@CHR < %Y#CTRSQNCHR_F_LOW) OR (Y@CHR > %Y#CTRSQNCHR_F_HI) */
      816    14626
      817    14627        /*
      818    14628        Use the identifier character to compute our function identifer number.
      819    14629        */
      820    14630    3            Y@FNC = Y_CTRSQNCHR(Y@CHR-%Y#CTRSQNCHR_F_LOW);

  14630   1 0000C7  E2A0 0000 0073  00                   LLH,R6   Y_EVT_INT+96,R2
          1 0000CA  EF47 000B                            STR,R6   Y@FNC,AUTO

      821    14631    3            CALL Y$DO_FNC;

  14631   1 0000CC  E3C0 00BE                            LNJ,B6   s:0,PREL
          1 0000CE       0001                            DC       s:14631+3,PREL
          1 0000CF  0F81 00A6                            B        s:15082,PREL

      822    14632        %KV$BOX (PAGE = YES, TITLE = "(Perform) control sequence, with I character");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:94   
             14650    3   /***************************************************************************
             14651    3    *                                                                         *
             14652    3    *                (Perform) control sequence, with I character             *
             14653    3    *                                                                         *
             14654    3    ***************************************************************************/

      823    14659    3         CASE %Y#ACT_CTRSQN_I;   /* (Perform) control sequence, with I character */

      824    14660        /*
      825    14661        We don't currently handler any ANS functions with I characters
      826    14662        */
      827    14663        /*N* What to do if we get an I char? */
      828    14664        %KV$BOX (PAGE = YES, TITLE = "Error");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:95   
             14682    3   /***************************************************************************
             14683    3    *                                                                         *
             14684    3    *                                   Error                                 *
             14685    3    *                                                                         *
             14686    3    ***************************************************************************/

      829    14691    3         CASE %Y#ACT_ERR;                  /* Error                              */

      830    14692                 %KV_VDOERR (COD = Y@EVTSTT.ERRCOD + %Y#E$X364_ILG_LOW);

  14698   1 0000D1  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 0000D4  BCC4 0004                            LDB,B3   4,B4
          1 0000D6  E843 0013                            LDR,R6   19,B3
          1 0000D8  6981 009D                            BNEZ,R6  s:15082,PREL

  14702   1 0000DA  E847 002C                            LDR,R6   Y@EVTSTT,AUTO
          1 0000DC  604B                                 SOR,R6   11
          1 0000DD  EA70 058C                            ADD,R6   1420,IMO
          1 0000DF  EF43 0013                            STR,R6   19,B3

  14706   1 0000E1  0F81 0094                            B        s:15082,PREL

      831    14708        %KV$BOX (PAGE = YES, TITLE = "Error, exit");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:96   
             14726    4   /***************************************************************************
             14727    4    *                                                                         *
             14728    4    *                                Error, exit                              *
             14729    4    *                                                                         *
             14730    4    ***************************************************************************/

      832    14735    3         CASE %Y#ACT_ERREXT;               /* Error, exit                        */

      833    14736                 %KV_VDOERR (COD = Y@EVTSTT.ERRCOD + %Y#E$X364_ILG_LOW);

  14742   1 0000E3  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 0000E6  BCC4 0004                            LDB,B3   4,B4
          1 0000E8  E843 0013                            LDR,R6   19,B3
          1 0000EA  6981 008B                            BNEZ,R6  s:15082,PREL

  14746   1 0000EC  E847 002C                            LDR,R6   Y@EVTSTT,AUTO
          1 0000EE  604B                                 SOR,R6   11
          1 0000EF  EA70 058C                            ADD,R6   1420,IMO
          1 0000F1  EF43 0013                            STR,R6   19,B3

  14750   1 0000F3  0F81 0082                            B        s:15082,PREL

      834    14752        /*N* do we need both ERR and ERREXT? */
      835    14753        %KV$BOX (PAGE = YES, TITLE = "(Perform) independent control, Ce form");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:97   
             14771    4   /***************************************************************************
             14772    4    *                                                                         *
             14773    4    *                   (Perform) independent control, Ce form                *
             14774    4    *                                                                         *
             14775    4    ***************************************************************************/

      836    14780    3         CASE %Y#ACT_INDCTR_CE;       /* (Perform) independent control, Ce form  */

      837    14781    4            IF (Y@CHR < %Y#INDCTRCHR_CE_LOW) OR (Y@CHR > %Y#INDCTRCHR_CE_HI) THEN DO;

  14781   1 0000F5  A970 0080                            CMR,R2   128,IMO
          1 0000F7  0801 0005                            BAL      s:14797,PREL
          1 0000F9  A970 009F                            CMR,R2   159,IMO
          1 0000FB  0A81 0010                            BALE     s:14813,PREL

      838    14782        /*
      839    14783        The character identifying which CE this is is out of the legal range.
      840    14784        */
      841    14785        /*E* ERROR:  KVO-E$X364_ILGCE_CHR-C
      842    14786        MESSAGE0:  An apparent ANS X3.64 CE independent control has an illegal
      843    14787        CE character.
      844    14788        MESSAGE1:  The CE (identifying) character specified
      845    14789       on an ANS X3.64 function sent to an ANS X3.64 virtual device is illegal - there is n
             14789        o such function.
      846    14790        */
      847    14791                    %KV_VDOERR (COD = %E$X364_ILGCE_CHR);

  14797   1 0000FD  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 000100  BCC4 0004                            LDB,B3   4,B4
          1 000102  E843 0013                            LDR,R6   19,B3
          1 000104  6981 0005                            BNEZ,R6  s:14807,PREL

  14801   1 000106  E870 058A                            LDR,R6   1418,IMO
          1 000108  EF43 0013                            STR,R6   19,B3

      848    14807    4               EXIT Y$CASE_ACT;

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:98   
  14807   1 00010A  0F81 006B                            B        s:15082,PREL

      849    14808    4               END;
             14808                 /* END IF (Y@CHR < %Y#INDCTRCHR_CE_LOW) OR (Y@CHR > %Y#INDCTRCHR_CE_HI) */
      850    14809
      851    14810        /*
      852    14811        Use the identifier character to compute our function identifer number.
      853    14812        */
      854    14813    3            Y@FNC = Y_INDCTRCHR(Y@CHR-%Y#INDCTRCHR_CE_LOW);

  14813   1 00010C  E2A0 0000 0073  00                   LLH,R6   Y_EVT_INT+96,R2
          1 00010F  EF47 000B                            STR,R6   Y@FNC,AUTO

      855    14814    3            CALL Y$DO_FNC;

  14814   1 000111  E3C0 0079                            LNJ,B6   s:0,PREL
          1 000113       0001                            DC       s:14814+3,PREL
          1 000114  0F81 0061                            B        s:15082,PREL

      856    14815        %KV$BOX (PAGE = YES, TITLE = "(Perform) independent control, Fe form");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:99   
             14833    3   /***************************************************************************
             14834    3    *                                                                         *
             14835    3    *                   (Perform) independent control, Fe form                *
             14836    3    *                                                                         *
             14837    3    ***************************************************************************/

      857    14842    3         CASE %Y#ACT_INDCTR_FE;       /* (Perform) independent control, Fe form  */

      858    14843    4            IF (Y@CHR < %Y#INDCTRCHR_FE_LOW) OR (Y@CHR > %Y#INDCTRCHR_FE_HI) THEN DO;

  14843   1 000116  2D40                                 CMV,R2   64
          1 000117  0801 0004                            BAL      s:14859,PREL
          1 000119  2D63                                 CMV,R2   99
          1 00011A  0A81 0010                            BALE     s:14875,PREL

      859    14844        /*
      860    14845        The character identifying which FE this is is out of the legal range.
      861    14846        */
      862    14847        /*E* ERROR:  KVO-E$X364_ILGFE_CHR-C
      863    14848        MESSAGE0:  An apparent ANS X3.64 FE independent control has an illegal
      864    14849        FE character.
      865    14850        MESSAGE1:  The FE (identifying) character specified
      866    14851       on an ANS X3.64 function sent to an ANS X3.64 virtual device is illegal - there is n
             14851        o such function.
      867    14852        */
      868    14853                    %KV_VDOERR (COD = %E$X364_ILGFE_CHR);

  14859   1 00011C  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 00011F  BCC4 0004                            LDB,B3   4,B4
          1 000121  E843 0013                            LDR,R6   19,B3
          1 000123  6981 0005                            BNEZ,R6  s:14869,PREL

  14863   1 000125  E870 058B                            LDR,R6   1419,IMO
          1 000127  EF43 0013                            STR,R6   19,B3

      869    14869    4               EXIT Y$CASE_ACT;

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:100  
  14869   1 000129  0F81 004C                            B        s:15082,PREL

      870    14870    4               END;
             14870                 /* END IF (Y@CHR < %Y#INDCTRCHR_FE_LOW) OR (Y@CHR > %Y#INDCTRCHR_FE_HI) */
      871    14871
      872    14872        /*
      873    14873        Use the identifier character to compute our function identifer number.
      874    14874        */
      875    14875    3            Y@FNC = Y_INDCTRCHR(Y@CHR-%Y#INDCTRCHR_FE_LOW);

  14875   1 00012B  E2A0 0000 0093  00                   LLH,R6   Y_CTRSQNCHR_INT,R2
          1 00012E  EF47 000B                            STR,R6   Y@FNC,AUTO

      876    14876    3            CALL Y$DO_FNC;

  14876   1 000130  E3C0 005A                            LNJ,B6   s:0,PREL
          1 000132       0001                            DC       s:14876+3,PREL
          1 000133  0F81 0042                            B        s:15082,PREL

      877    14877        %KV$BOX (PAGE = YES, TITLE = "Initialize (for receiving control sequence)");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:101  
             14895    3   /***************************************************************************
             14896    3    *                                                                         *
             14897    3    *                Initialize (for receiving control sequence)              *
             14898    3    *                                                                         *
             14899    3    ***************************************************************************/

      878    14904    3         CASE %Y#ACT_INT;        /* Initialize (for receiving control sequence)  */

      879    14905    3            CALL Y$OTP;

  14905   1 000135  E3C0 0278                            LNJ,B6   s:0,PREL
          1 000137       0001                            DC       s:14906,PREL

      880    14906    3            %KV_X364.P_VAL = KV_X364.P_VAL;

  14906   1 000138  AB80 0000 0000  00                   LAB,B2   KV_X364
          1 00013B  2C04                                 LDV,R2   4
          1 00013C  6C22                                 LDV,R6   34
          1 00013D  BCC7 0006                            LDB,B3   Y@X364$,AUTO
          1 00013F  3C04                                 LDV,R3   4
          1 000140  0008                                 MMM

      881    14907    3            %KV_X364.P_X = -1;

  14907   1 000141  ECC7 0006                            LDB,B6   Y@X364$,AUTO
          1 000143  8946 0001                            LBT,'FFFF'X       1,B6
          1 000145       FFFF
          1 000146  0F81 002F                            B        s:15082,PREL

      882    14908        %KV$BOX (PAGE = YES, TITLE = "No action");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:102  
             14926    3   /***************************************************************************
             14927    3    *                                                                         *
             14928    3    *                                 No action                               *
             14929    3    *                                                                         *
             14930    3    ***************************************************************************/

      883    14935    3         CASE %Y#ACT_NO;                   /* No action                          */

      884    14936        %KV$BOX (PAGE = YES, TITLE = "Open P-accumulator (receiving a P)");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:103  
             14954    3   /***************************************************************************
             14955    3    *                                                                         *
             14956    3    *                     Open P-accumulator (receiving a P)                  *
             14957    3    *                                                                         *
             14958    3    ***************************************************************************/

      885    14963    3         CASE %Y#ACT_OPNACM;               /* Open P-accumulator (receiving a P) */

      886    14964    4            IF %KV_X364.P_X >= %KV#X364_P_MAXX THEN DO;

  14964   1 000148  E845 0001                            LDR,R6   1,B5
          1 00014A  6D10                                 CMV,R6   16
          1 00014B  0801 0010                            BAL      s:14987,PREL

      887    14965        /*
      888    14966        The array of P values is already full.  Can't accept any more.
      889    14967        */
      890    14968                    %KV_VDOERR (COD = %E$X364_P_CNTEXC);

  14974   1 00014D  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 000150  BCC4 0004                            LDB,B3   4,B4
          1 000152  E843 0013                            LDR,R6   19,B3
          1 000154  6981 0005                            BNEZ,R6  s:14984,PREL

  14978   1 000156  E870 0587                            LDR,R6   1415,IMO
          1 000158  EF43 0013                            STR,R6   19,B3

      891    14984    4               EXIT Y$CASE_ACT;

  14984   1 00015A  0F81 001B                            B        s:15082,PREL

      892    14985    4               END;                        /* END IF P_X >= %KV#X3.64_P_MAXX     */
      893    14986
      894    14987    3            %KV_X364.P_X = %KV_X364.P_X + 1;

  14987   1 00015C  8AC5 0001                            INC      1,B5

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:104  
      895    14988    3            %KV_X364.P_VAL(%KV_X364.P_X) = Y@CHR - %ASCBIN('0');

  14988   1 00015E  B845 0001                            LDR,R3   1,B5
          1 000160  3E02                                 ADV,R3   2
          1 000161  2ED0                                 ADV,R2   -48
          1 000162  AF35                                 STR,R2   ,B5,R3
          1 000163  0F81 0012                            B        s:15082,PREL

      896    14989        %KV$BOX (PAGE = YES, TITLE = "Output 'normal' (non-3.64) text");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:105  
             15007    3   /***************************************************************************
             15008    3    *                                                                         *
             15009    3    *                      Output 'normal' (non-3.64) text                    *
             15010    3    *                                                                         *
             15011    3    ***************************************************************************/

      897    15016    3         CASE %Y#ACT_OTP;                  /* Output 'normal' (non-3.64) text    */

      898    15017    3            CALL Y$OTP;

  15017   1 000165  E3C0 0248                            LNJ,B6   s:0,PREL
          1 000167       0001                            DC       s:15017+3,PREL
          1 000168  0F81 000D                            B        s:15082,PREL

      899    15018        %KV$BOX (PAGE = YES, TITLE = "Pass ('normal' text to OTPLCL)");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:106  
             15036    3   /***************************************************************************
             15037    3    *                                                                         *
             15038    3    *                       Pass ('normal' text to OTPLCL)                    *
             15039    3    *                                                                         *
             15040    3    ***************************************************************************/

      900    15045    3         CASE %Y#ACT_PAS;                  /* Pass ('normal' text to OTPLCL)     */

      901    15046    3            IF Y@BGNCHRX < 0 THEN

  15046   1 00016A  E847 000D                            LDR,R6   Y@BGNCHRX,AUTO
          1 00016C  6881 0009                            BGEZ,R6  s:15082,PREL

      902    15047        /*
      903    15048        We don't have a current string of characters to be passed on as-is.
      904    15049        Start one.
      905    15050        */
      906    15051    3            Y@BGNCHRX = Y@CHRX;

  15051   1 00016E  E847 000E                            LDR,R6   Y@CHRX,AUTO
          1 000170  EF47 000D                            STR,R6   Y@BGNCHRX,AUTO
          1 000172  0F81 0003                            B        s:15082,PREL

      907    15052        %KV$BOX (PAGE = YES, TITLE = "Save I character");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:107  
             15070    3   /***************************************************************************
             15071    3    *                                                                         *
             15072    3    *                              Save I character                           *
             15073    3    *                                                                         *
             15074    3    ***************************************************************************/

      908    15079    3         CASE %Y#ACT_SAVI;                 /* Save I character                   */

      909    15080    3            Y@I_CHR = Y@CHR;

  15080   1 000174  AF47 000C                            STR,R2   Y@I_CHR,AUTO

      910    15081    3         END;                              /* END CASE .ACT                      */

      911    15082    2         %KV_X364.STT = Y@EVTSTT.NXTSTT;

  15082   1 000176  ECC7 0006                            LDB,B6   Y@X364$,AUTO
          1 000178  E847 002C                            LDR,R6   Y@EVTSTT,AUTO
          1 00017A  6048                                 SOR,R6   8
          1 00017B  E570 0007                            AND,R6   7,IMO
          1 00017D  EF06                                 STR,R6   ,B6

      912    15083    2         END;                         /* END DO FOR Y@CHRX = Y@CHRX TO Y@CHRX_HI */

  15083   1 00017E  8AC7 000E                            INC      Y@CHRX,AUTO
          1 000180  E847 000E                            LDR,R6   Y@CHRX,AUTO
          1 000182  E947 000F                            CMR,R6   Y@CHRX_HI,AUTO
          1 000184  0801 FEB5                            BAL      s:14449,PREL

      913    15084        /*
      914    15085        Output any non-3.64 string we may have been scanning over.
      915    15086        */
      916    15087    1      CALL Y$OTP;

  15087   1 000186  E3C0 0227                            LNJ,B6   s:0,PREL
          1 000188       0001                            DC       s:15087+3,PREL
          1 000189  0F81 0284                            B        s:15436,PREL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:108  

      917    15088        %KV$BOX(PAGE = YES, TITLE = "Do ANS X3.64 function");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:109  
             15106    1   /***************************************************************************
             15107    1    *                                                                         *
             15108    1    *                           Do ANS X3.64 function                         *
             15109    1    *                                                                         *
             15110    1    ***************************************************************************/

      918    15115    1   Y$DO_FNC: PROC;

  15115   1 00018B  EFC7 002E            Y$DO_FNC        STB,B6   Y@EVTSTT+2,AUTO

      919    15116    2   Y$DO_CASE_FNC:
      920    15117    3      DO CASE Y@FNC;

  15117   1 00018D  B847 000B            Y$DO_CASE_FNC   LDR,R3   Y@FNC,AUTO
          1 00018F  3D24                                 CMV,R3   36
          1 000190  0281 0219                            BGE      s:15357,PREL
          1 000192  A830 0000 0198  01                   LDR,R2   Y$DO_CASE_FNC+11,R3
          1 000195  83A0 0000 01BC  01                   JMP      s:15161,R2
          1 000198       01EE                            DC       s:15357,PREL
          1 000199       0000                            DC       s:15161,PREL
          1 00019A       0000                            DC       s:15161,PREL
          1 00019B       01EE                            DC       s:15357,PREL
          1 00019C       0000                            DC       s:15161,PREL
          1 00019D       0000                            DC       s:15161,PREL
          1 00019E       01EE                            DC       s:15357,PREL
          1 00019F       01EE                            DC       s:15357,PREL
          1 0001A0       0000                            DC       s:15161,PREL
          1 0001A1       0000                            DC       s:15161,PREL
          1 0001A2       0000                            DC       s:15161,PREL
          1 0001A3       0000                            DC       s:15161,PREL
          1 0001A4       01EE                            DC       s:15357,PREL
          1 0001A5       01EE                            DC       s:15357,PREL
          1 0001A6       01EE                            DC       s:15357,PREL
          1 0001A7       01EE                            DC       s:15357,PREL
          1 0001A8       016A                            DC       s:15298,PREL
          1 0001A9       016A                            DC       s:15298,PREL
          1 0001AA       01EE                            DC       s:15357,PREL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:110  
          1 0001AB       0000                            DC       s:15161,PREL
          1 0001AC       0000                            DC       s:15161,PREL
          1 0001AD       0000                            DC       s:15161,PREL
          1 0001AE       01EE                            DC       s:15357,PREL
          1 0001AF       01EE                            DC       s:15357,PREL
          1 0001B0       0000                            DC       s:15161,PREL
          1 0001B1       0000                            DC       s:15161,PREL
          1 0001B2       01EE                            DC       s:15357,PREL
          1 0001B3       0000                            DC       s:15161,PREL
          1 0001B4       01EE                            DC       s:15357,PREL
          1 0001B5       01EE                            DC       s:15357,PREL
          1 0001B6       0118                            DC       s:15255,PREL
          1 0001B7       01EE                            DC       s:15357,PREL
          1 0001B8       01EE                            DC       s:15357,PREL
          1 0001B9       01EE                            DC       s:15357,PREL
          1 0001BA       0000                            DC       s:15161,PREL
          1 0001BB       0000                            DC       s:15161,PREL

      921    15118        %KV$BOX (PAGE = YES, TITLE = "ANS function:  All position requests");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:111  
             15136    3   /***************************************************************************
             15137    3    *                                                                         *
             15138    3    *                    ANS function:  All position requests                 *
             15139    3    *                                                                         *
             15140    3    ***************************************************************************/

      922    15145    3      CASE %Y#CTRFNC_CNL,

      923    15146    3        %Y#CTRFNC_CPL,
      924    15147    3        %Y#CTRFNC_CUB,
      925    15148    3        %Y#CTRFNC_CUD,
      926    15149    3        %Y#CTRFNC_CUF,
      927    15150    3        %Y#CTRFNC_CUU,
      928    15151    3        %Y#CTRFNC_HPR,
      929    15152    3        %Y#CTRFNC_VPR,
      930    15153    3        %Y#CTRFNC_CUP,
      931    15154    3        %Y#CTRFNC_HVP,
      932    15155    3        %Y#CTRFNC_CHA,
      933    15156    3        %Y#CTRFNC_HPA,
      934    15157    3        %Y#CTRFNC_IND,
      935    15158    3        %Y#CTRFNC_RI,
      936    15159    3        %Y#CTRFNC_NEL,
      937    15160    3        %Y#CTRFNC_VPA;
      938    15161    3         KV@VDH_PST = KV_VDH_PST_ABS_VRT_NO_SCR;

  15161   1 0001BC  AB80 0000 0000  xsym                 LAB,B2   KV_VDH_PST_ABS_VRT_NO_SCR
          1 0001BF  2C00                                 LDV,R2   0
          1 0001C0  6C08                                 LDV,R6   8
          1 0001C1  BB87                                 LAB,B3   ,AUTO
          1 0001C2  3C50                                 LDV,R3   80
          1 0001C3  0008                                 MMM

      939    15162        /*
      940    15163           Fix up MVD.VRTLIN in case we've scrolled out of the window.
      941    15164        */
      942    15165    3         IF NOT %KV_SRD.VRTPSTOK THEN CALL KVO$PST (KV_VDH_PST_0_VRT);

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:112  
  15165   1 0001C4  ECC7 0008                            LDB,B6   Y@SRD$,AUTO
          1 0001C6  82C6 000E                            LB,'0010'X        14,B6
          1 0001C8       0010
          1 0001C9  0501 000A                            BBT      s:15166,PREL

  15165   1 0001CB  BB80 0000 0000  02                   LAB,B3   0
          1 0001CE  CBF0 0100                            LAB,B4   256,IMO
          1 0001D0  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 0001D3       0001                            DC       s:15166,PREL

      943    15166    3         %KV_SRD.CRTVRTLINPHSLIN = %KV_SRD.CRT.LIN;

  15166   1 0001D4  ECC7 0008                            LDB,B6   Y@SRD$,AUTO
          1 0001D6  E846 0015                            LDR,R6   21,B6
          1 0001D8  EF46 0013                            STR,R6   19,B6

      944    15167    3         %KV_MVD.VRTCLM = %KV_SRD.CRT.CLM-%KV_SRD.TOPLFT.CLM+1;

  15167   1 0001DA  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 0001DD  CCC5 0006                            LDB,B4   6,B5
          1 0001DF  D846 0016                            LDR,R5   22,B6
          1 0001E1  D246 000A                            SUB,R5   10,B6
          1 0001E3  5E01                                 ADV,R5   1
          1 0001E4  DF44 001B                            STR,R5   27,B4

      945    15168    3         %KV_SRD.HI_NONBLN.CLM = %KV_SRD.SRDEND.CLM;

  15168   1 0001E6  E846 001B                            LDR,R6   27,B6
          1 0001E8  EF46 0018                            STR,R6   24,B6

      946    15169    3         %KV_SRD.HI_NONBLN.LIN = %KV_SRD.SRDEND.LIN+%KV_SRD.DVCLINBIS;

  15169   1 0001EA  D846 001A                            LDR,R5   26,B6
          1 0001EC  DA46 0019                            ADD,R5   25,B6
          1 0001EE  DF46 0017                            STR,R5   23,B6

      947    15170    3         %KV_MVD.VRTLIN =
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:113  

  15170   1 0001F0  CCC5 0006                            LDB,B4   6,B5
          1 0001F2  C846 0013                            LDR,R4   19,B6
          1 0001F4  CA46 0019                            ADD,R4   25,B6
          1 0001F6  C246 0009                            SUB,R4   9,B6
          1 0001F8  4E01                                 ADV,R4   1
          1 0001F9  CF44 001A                            STR,R4   26,B4

      948    15171    3           %KV_SRD.CRTVRTLINPHSLIN+%KV_SRD.DVCLINBIS-%KV_SRD.TOPLFT.LIN+1;
      949    15172    3         KV@VDH_PST.PSTVAL.LIN = %KV_MVD.VRTLIN;

  15172   1 0001FB  CCC5 0006                            LDB,B4   6,B5
          1 0001FD  E844 001A                            LDR,R6   26,B4
          1 0001FF  EF47 002A                            STR,R6   KV@VDH_PST+2,AUTO

      950    15173    3         KV@VDH_PST.PSTVAL.CLM = %KV_MVD.VRTCLM;

  15173   1 000201  CCC5 0006                            LDB,B4   6,B5
          1 000203  D844 001B                            LDR,R5   27,B4
          1 000205  DF47 002B                            STR,R5   KV@VDH_PST+3,AUTO

      951    15174    3         IF %KV_X364.P_VAL(0)<=0 THEN %KV_X364.P_VAL(0) = 1;

  15174   1 000207  CCC7 0006                            LDB,B4   Y@X364$,AUTO
          1 000209  C844 0002                            LDR,R4   2,B4
          1 00020B  4A01 0004                            BGZ,R4   s:15175,PREL

  15174   1 00020D  4C01                                 LDV,R4   1
          1 00020E  CF44 0002                            STR,R4   2,B4

      952    15175    4         DO CASE Y@FNC;

  15175   1 000210  B847 000B                            LDR,R3   Y@FNC,AUTO
          1 000212  3D24                                 CMV,R3   36
          1 000213  0281 0092                            BGE      s:15217,PREL
          1 000215  A830 0000 021B  01                   LDR,R2   s:15175+11,R3
          1 000218  83A0 0000 023F  01                   JMP      s:15177,R2
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:114  
          1 00021B       0067                            DC       s:15217,PREL
          1 00021C       0026                            DC       s:15189,PREL
          1 00021D       003A                            DC       s:15194,PREL
          1 00021E       0067                            DC       s:15217,PREL
          1 00021F       0000                            DC       s:15177,PREL
          1 000220       0009                            DC       s:15180,PREL
          1 000221       0067                            DC       s:15217,PREL
          1 000222       0067                            DC       s:15217,PREL
          1 000223       0013                            DC       s:15183,PREL
          1 000224       001A                            DC       s:15185,PREL
          1 000225       0020                            DC       s:15187,PREL
          1 000226       002D                            DC       s:15191,PREL
          1 000227       0067                            DC       s:15217,PREL
          1 000228       0067                            DC       s:15217,PREL
          1 000229       0067                            DC       s:15217,PREL
          1 00022A       0067                            DC       s:15217,PREL
          1 00022B       0067                            DC       s:15217,PREL
          1 00022C       0067                            DC       s:15217,PREL
          1 00022D       0067                            DC       s:15217,PREL
          1 00022E       003A                            DC       s:15194,PREL
          1 00022F       0020                            DC       s:15187,PREL
          1 000230       002D                            DC       s:15191,PREL
          1 000231       0067                            DC       s:15217,PREL
          1 000232       0067                            DC       s:15217,PREL
          1 000233       003E                            DC       s:15196,PREL
          1 000234       005B                            DC       s:15207,PREL
          1 000235       0067                            DC       s:15217,PREL
          1 000236       0045                            DC       s:15200,PREL
          1 000237       0067                            DC       s:15217,PREL
          1 000238       0067                            DC       s:15217,PREL
          1 000239       0067                            DC       s:15217,PREL
          1 00023A       0067                            DC       s:15217,PREL
          1 00023B       0067                            DC       s:15217,PREL
          1 00023C       0067                            DC       s:15217,PREL
          1 00023D       0065                            DC       s:15212,PREL
          1 00023E       001A                            DC       s:15185,PREL

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:115  
      953    15176    4         CASE %Y#CTRFNC_CNL;               /* Cursor Next Line                   */

      954    15177    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN+%KV_X364.P_VAL(0);

  15177   1 00023F  CA47 002A                            ADD,R4   KV@VDH_PST+2,AUTO
          1 000241  CF47 002A                            STR,R4   KV@VDH_PST+2,AUTO

      955    15178    4            KV@VDH_PST.PSTVAL.CLM = 1;

  15178   1 000243  6C01                                 LDV,R6   1
          1 000244  EF47 002B                            STR,R6   KV@VDH_PST+3,AUTO
          1 000246  0F81 005F                            B        s:15217,PREL

      956    15179    4         CASE %Y#CTRFNC_CPL;               /* Cursor Previous Line               */

      957    15180    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN-%KV_X364.P_VAL(0);

  15180   1 000248  C247 002A                            SUB,R4   KV@VDH_PST+2,AUTO
          1 00024A  8254                                 NEG      R4
          1 00024B  CF47 002A                            STR,R4   KV@VDH_PST+2,AUTO

      958    15181    4            KV@VDH_PST.PSTVAL.CLM = 1;

  15181   1 00024D  6C01                                 LDV,R6   1
          1 00024E  EF47 002B                            STR,R6   KV@VDH_PST+3,AUTO
          1 000250  0F81 0055                            B        s:15217,PREL

      959    15182    4         CASE %Y#CTRFNC_CUB;

      960    15183    4            KV@VDH_PST.PSTVAL.CLM = KV@VDH_PST.PSTVAL.CLM-%KV_X364.P_VAL(0);

  15183   1 000252  C247 002B                            SUB,R4   KV@VDH_PST+3,AUTO
          1 000254  8254                                 NEG      R4
          1 000255  CF47 002B                            STR,R4   KV@VDH_PST+3,AUTO
          1 000257  0F81 004E                            B        s:15217,PREL

      961    15184    4         CASE %Y#CTRFNC_CUD,%Y#CTRFNC_VPR;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:116  

      962    15185    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN+%KV_X364.P_VAL(0);

  15185   1 000259  CA47 002A                            ADD,R4   KV@VDH_PST+2,AUTO
          1 00025B  CF47 002A                            STR,R4   KV@VDH_PST+2,AUTO
          1 00025D  0F81 0048                            B        s:15217,PREL

      963    15186    4         CASE %Y#CTRFNC_CUF,%Y#CTRFNC_HPR;

      964    15187    4            KV@VDH_PST.PSTVAL.CLM = KV@VDH_PST.PSTVAL.CLM+%KV_X364.P_VAL(0);

  15187   1 00025F  CA47 002B                            ADD,R4   KV@VDH_PST+3,AUTO
          1 000261  CF47 002B                            STR,R4   KV@VDH_PST+3,AUTO
          1 000263  0F81 0042                            B        s:15217,PREL

      965    15188    4         CASE %Y#CTRFNC_CUU;

      966    15189    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN-%KV_X364.P_VAL(0);

  15189   1 000265  C247 002A                            SUB,R4   KV@VDH_PST+2,AUTO
          1 000267  8254                                 NEG      R4
          1 000268  CF47 002A                            STR,R4   KV@VDH_PST+2,AUTO
          1 00026A  0F81 003B                            B        s:15217,PREL

      967    15190    4         CASE %Y#CTRFNC_CUP,%Y#CTRFNC_HVP;

      968    15191    4            KV@VDH_PST.PSTVAL.LIN = %KV_X364.P_VAL(0);

  15191   1 00026C  CF47 002A                            STR,R4   KV@VDH_PST+2,AUTO

      969    15192    4            KV@VDH_PST.PSTVAL.CLM = MAXIMUM(%KV_X364.P_VAL(1),1);

  15192   1 00026E  6C01                                 LDV,R6   1
          1 00026F  E944 0003                            CMR,R6   3,B4
          1 000271  0881 0003                            BAGE     s:15192+7,PREL
          1 000273  E844 0003                            LDR,R6   3,B4
          1 000275  EF47 002B                            STR,R6   KV@VDH_PST+3,AUTO
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:117  
          1 000277  0F81 002E                            B        s:15217,PREL

      970    15193    4         CASE %Y#CTRFNC_CHA,%Y#CTRFNC_HPA;

      971    15194    4            KV@VDH_PST.PSTVAL.CLM = %KV_X364.P_VAL(0);

  15194   1 000279  CF47 002B                            STR,R4   KV@VDH_PST+3,AUTO
          1 00027B  0F81 002A                            B        s:15217,PREL

      972    15195    4         CASE %Y#CTRFNC_IND;

      973    15196    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN+1;

  15196   1 00027D  8AC7 002A                            INC      KV@VDH_PST+2,AUTO

      974    15197    4            KV@VDH_PST.VRTSCRENB = '1'B;

  15197   1 00027F  8947 0029                            LBT,'0400'X       KV@VDH_PST+1,AUTO
  15197   1 000281       0400

      975    15198    4            GOTO Y$NO_LIN_CHK;

  15198   1 000282  0F81 0032                            B        s:15219,PREL

      976    15199    4         CASE %Y#CTRFNC_RI;

      977    15200    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN-1;

  15200   1 000284  88C7 002A                            DEC      KV@VDH_PST+2,AUTO

      978    15201    4            IF KV@VDH_PST.PSTVAL.LIN=0

  15201   1 000286  E847 002A                            LDR,R6   KV@VDH_PST+2,AUTO
          1 000288  6981 000F                            BNEZ,R6  s:15205,PREL
          1 00028A  82C6 001D                            LB,'4000'X        29,B6
          1 00028C       4000
          1 00028D  0581 0006                            BBF      s:15203,PREL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:118  
          1 00028F  82C6 000E                            LB,'0008'X        14,B6
          1 000291       0008
          1 000292  0501 0005                            BBT      s:15205,PREL

      979    15202    4              AND (NOT %KV_SRD.VRTSCR OR NOT %KV_SRD.SCROLL)
      980    15203    4            THEN KV@VDH_PST.PSTVAL.LIN = %KV_SRD.LNG;

  15203   1 000294  E2C6 000E                            LLH,R6   14,B6
          1 000296  EF47 002A                            STR,R6   KV@VDH_PST+2,AUTO

      981    15204        /* KVO$GNRPST knows how to scroll up */
      982    15205    4            GOTO Y$NO_LIN_CHK;

  15205   1 000298  0F81 001C                            B        s:15219,PREL

      983    15206    4         CASE %Y#CTRFNC_NEL;

      984    15207    4            KV@VDH_PST.PSTVAL.CLM = 1;

  15207   1 00029A  6C01                                 LDV,R6   1
          1 00029B  EF47 002B                            STR,R6   KV@VDH_PST+3,AUTO

      985    15208    4            KV@VDH_PST.PSTVAL.LIN = KV@VDH_PST.PSTVAL.LIN+1;

  15208   1 00029D  8AC7 002A                            INC      KV@VDH_PST+2,AUTO

      986    15209    4            KV@VDH_PST.VRTSCRENB = '1'B;

  15209   1 00029F  8947 0029                            LBT,'0400'X       KV@VDH_PST+1,AUTO
  15209   1 0002A1       0400

      987    15210    4            GOTO Y$NO_LIN_CHK;

  15210   1 0002A2  0F81 0012                            B        s:15219,PREL

      988    15211    4         CASE %Y#CTRFNC_VPA;

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:119  
      989    15212    4            KV@VDH_PST.PSTVAL.LIN = %KV_X364.P_VAL(0);

  15212   1 0002A4  CF47 002A                            STR,R4   KV@VDH_PST+2,AUTO

      990    15213    4         END;                              /* CASE                               */

      991    15214
      992    15215        /* Check that the cursor stays in the window.*/
      993    15216
      994    15217    3         IF KV@VDH_PST.PSTVAL.LIN>%KV_SRD.LNG

  15217   1 0002A6  E2C6 000E                            LLH,R6   14,B6
          1 0002A8  E947 002A                            CMR,R6   KV@VDH_PST+2,AUTO
          1 0002AA  0881 0003                            BAGE     s:15219,PREL

      995    15218    3         THEN KV@VDH_PST.PSTVAL.LIN = %KV_SRD.LNG;

  15218   1 0002AC  EF47 002A                            STR,R6   KV@VDH_PST+2,AUTO

      996    15219    3         IF KV@VDH_PST.PSTVAL.LIN<=0

  15219   1 0002AE  E847 002A                            LDR,R6   KV@VDH_PST+2,AUTO
          1 0002B0  6A01 0004                            BGZ,R6   s:15219,PREL

      997    15220    3         THEN KV@VDH_PST.PSTVAL.LIN = 1;

  15220   1 0002B2  6C01                                 LDV,R6   1
          1 0002B3  EF47 002A                            STR,R6   KV@VDH_PST+2,AUTO

  15219   1                              Y$NO_LIN_CHK    null
      998    15221    3   Y$NO_LIN_CHK:;
      999    15222    3         IF KV@VDH_PST.PSTVAL.CLM>%KV_SRD.WDT

  15222   1 0002B5  E847 002B            Y$NO_LIN_CHK    LDR,R6   KV@VDH_PST+3,AUTO
          1 0002B7  6801 0009                            BLZ,R6   s:15224,PREL
          1 0002B9  E946 000D                            CMR,R6   13,B6
          1 0002BB  0381 0005                            BLE      s:15224,PREL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:120  

     1000    15223    3         THEN KV@VDH_PST.PSTVAL.CLM = %KV_SRD.WDT;

  15223   1 0002BD  E846 000D                            LDR,R6   13,B6
          1 0002BF  EF47 002B                            STR,R6   KV@VDH_PST+3,AUTO

     1001    15224    3         IF KV@VDH_PST.PSTVAL.CLM<=0

  15224   1 0002C1  6A01 0004                            BGZ,R6   s:15226,PREL

     1002    15225    3         THEN KV@VDH_PST.PSTVAL.CLM = 1;

  15225   1 0002C3  6C01                                 LDV,R6   1
          1 0002C4  EF47 002B                            STR,R6   KV@VDH_PST+3,AUTO

     1003    15226    3         CALL KVO$PST (KV@VDH_PST);

  15226   1 0002C6  BBC7 0028                            LAB,B3   KV@VDH_PST,AUTO
          1 0002C8  BFC7 0030                            STB,B3   Y@EVTSTT+4,AUTO
          1 0002CA  BBC7 0030                            LAB,B3   Y@EVTSTT+4,AUTO
          1 0002CC  CBF0 0100                            LAB,B4   256,IMO
          1 0002CE  E380 0000 0000  xent                 LNJ,B6   KVO$PST
          1 0002D1       0001                            DC       s:15226+12,PREL
          1 0002D2  0F81 00D7                            B        s:15357,PREL

     1004    15227        %KV$BOX (PAGE = YES, TITLE = "ANS function:  SGR");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:121  
             15245    3   /***************************************************************************
             15246    3    *                                                                         *
             15247    3    *                             ANS function:  SGR                          *
             15248    3    *                                                                         *
             15249    3    ***************************************************************************/

     1005    15254    3      CASE %Y#CTRFNC_SGR;

     1006    15255    3         KV@USR_SETATR = KV_USR_SETATR;

  15255   1 0002D4  AB80 0000 0000  xsym                 LAB,B2   KV_USR_SETATR
          1 0002D7  2C00                                 LDV,R2   0
          1 0002D8  6C08                                 LDV,R6   8
          1 0002D9  BB87                                 LAB,B3   ,AUTO
          1 0002DA  3C3E                                 LDV,R3   62
          1 0002DB  0008                                 MMM

     1007    15256    4         DO WHILE %KV_X364.P_X>=0;

  15256   1 0002DC  ECC7 0006                            LDB,B6   Y@X364$,AUTO
          1 0002DE  E846 0001                            LDR,R6   1,B6
          1 0002E0  6801 0026                            BLZ,R6   s:15263,PREL

     1008    15257    4            IF %KV_X364.P_VAL(%KV_X364.P_X)>=1

  15257   1 0002E2  ECC7 0006                            LDB,B6   Y@X364$,AUTO
          1 0002E4  B846 0001                            LDR,R3   1,B6
          1 0002E6  3E02                                 ADV,R3   2
          1 0002E7  E836                                 LDR,R6   ,B6,R3
          1 0002E8  6D01                                 CMV,R6   1
          1 0002E9  0801 0018                            BAL      s:15261,PREL
          1 0002EB  B846 0001                            LDR,R3   1,B6
          1 0002ED  3E02                                 ADV,R3   2
          1 0002EE  E836                                 LDR,R6   ,B6,R3
          1 0002EF  6D09                                 CMV,R6   9
          1 0002F0  0A01 0011                            BAG      s:15261,PREL

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:122  
     1009    15258    4              AND %KV_X364.P_VAL(%KV_X364.P_X)<=9
     1010    15259    4            THEN KV@USR_SETATR.GRPRND = KV@USR_SETATR.GRPRND |

  15259   1 0002F2  B846 0001                            LDR,R3   1,B6
          1 0002F4  3E02                                 ADV,R3   2
          1 0002F5  A836                                 LDR,R2   ,B6,R3
          1 0002F6  E847 0022                            LDR,R6   KV@USR_SETATR+3,AUTO
          1 0002F8  6008                                 SOL,R6   8
          1 0002F9  D2A0 0000 0112  00                   LLH,R5   Y_ANSGRPRND,R2
          1 0002FC  5008                                 SOL,R5   8
          1 0002FD  E455                                 OR,R6    R5
          1 0002FE  6048                                 SOR,R6   8
          1 0002FF  EAC7 0022                            SRM,R6,'00FF'X    KV@USR_SETATR+3,AUTO
          1 000301       00FF

     1011    15260    4              Y_ANSGRPRND (%KV_X364.P_VAL(%KV_X364.P_X));
     1012    15261    4            %KV_X364.P_X = %KV_X364.P_X-1;

  15261   1 000302  88C6 0001                            DEC      1,B6

     1013    15262    4            END;

  15262   1 000304  E846 0001                            LDR,R6   1,B6
          1 000306  68DC                                 BGEZ,R6  s:15257,SPREL

     1014    15263    3         KV@USR_SETATR.PHSPST = %KV_SRD.CRT;

  15263   1 000307  DCC7 0008                            LDB,B5   Y@SRD$,AUTO
          1 000309  8CC5 0015                            LDI      21,B5
          1 00030B  8D47 0020                            SDI      KV@USR_SETATR+1,AUTO

     1015    15264    3         %KV_STR.GRPRND = KV@USR_SETATR.GRPRND;

  15264   1 00030D  CC80 0000 0000  xsym                 LDB,B4   KV$PTR$
          1 000310  BCC4 0004                            LDB,B3   4,B4
          1 000312  D847 0022                            LDR,R5   KV@USR_SETATR+3,AUTO
          1 000314  5008                                 SOL,R5   8
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:123  
          1 000315  5048                                 SOR,R5   8
          1 000316  D7C3 001F                            STH,R5   31,B3

     1016    15265    3         CALL KVV$CALUSR (KV@USR_SETATR);

  15265   1 000318  BBC7 001F                            LAB,B3   KV@USR_SETATR,AUTO
          1 00031A  BFC7 0030                            STB,B3   Y@EVTSTT+4,AUTO
          1 00031C  BBC7 0030                            LAB,B3   Y@EVTSTT+4,AUTO
          1 00031E  CBF0 0100                            LAB,B4   256,IMO
          1 000320  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR
          1 000323       0001                            DC       s:15265+12,PREL
          1 000324  0F81 0085                            B        s:15357,PREL

     1017    15266        %KV$BOX (PAGE = YES, TITLE = "ANS function:  ED/EL");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:124  
             15284    3   /***************************************************************************
             15285    3    *                                                                         *
             15286    3    *                            ANS function:  ED/EL                         *
             15287    3    *                                                                         *
             15288    3    ***************************************************************************/

     1018    15293    3      CASE %Y#CTRFNC_ED,%Y#CTRFNC_EL;

     1019    15294        /*
     1020    15295        Initialize KV@USR_ERS so we'd erase all of the current line.
     1021    15296        Then modify according to what we've actually been asked to do.
     1022    15297        */
     1023    15298    3         KV@USR_ERS = KV_USR_ERS;

  15298   1 000326  AB80 0000 0000  xsym                 LAB,B2   KV_USR_ERS
          1 000329  2C00                                 LDV,R2   0
          1 00032A  6C0E                                 LDV,R6   14
          1 00032B  BB87                                 LAB,B3   ,AUTO
          1 00032C  3C30                                 LDV,R3   48
          1 00032D  0008                                 MMM

     1024    15299    3         KV@USR_ERS.TOPLFT.CLM = %KV_SRD.TOPLFT.CLM;

  15299   1 00032E  ECC7 0008                            LDB,B6   Y@SRD$,AUTO
          1 000330  E846 000A                            LDR,R6   10,B6
          1 000332  EF47 001A                            STR,R6   KV@USR_ERS+2,AUTO

     1025    15300    3         KV@USR_ERS.BGNPHSCLM = KV@USR_ERS.TOPLFT.CLM;

  15300   1 000334  EF47 001D                            STR,R6   KV@USR_ERS+5,AUTO

     1026    15301    3         KV@USR_ERS.BTMRHT.CLM = %KV_SRD.BTMRHT.CLM;

  15301   1 000336  D846 000C                            LDR,R5   12,B6
          1 000338  DF47 001C                            STR,R5   KV@USR_ERS+4,AUTO

     1027    15302    3         KV@USR_ERS.ENDPHSCLM = KV@USR_ERS.BTMRHT.CLM;
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:125  

  15302   1 00033A  DF47 001E                            STR,R5   KV@USR_ERS+6,AUTO

     1028    15303    3         KV@USR_ERS.TOPLFT.LIN = %KV_SRD.CRT.LIN+%KV_SRD.DVCLINBIS;

  15303   1 00033C  C846 0015                            LDR,R4   21,B6
          1 00033E  CA46 0019                            ADD,R4   25,B6
          1 000340  CF47 0019                            STR,R4   KV@USR_ERS+1,AUTO

     1029    15304    3         KV@USR_ERS.BTMRHT.LIN = KV@USR_ERS.TOPLFT.LIN;

  15304   1 000342  CF47 001B                            STR,R4   KV@USR_ERS+3,AUTO

     1030    15305    4         DO CASE %KV_X364.P_VAL(0)+1;

  15305   1 000344  DCC7 0006                            LDB,B5   Y@X364$,AUTO
          1 000346  B845 0002                            LDR,R3   2,B5
          1 000348  3E01                                 ADV,R3   1
          1 000349  3D04                                 CMV,R3   4
          1 00034A  0281 0046                            BGE      s:15349,PREL
          1 00034C  A830 0000 0352  01                   LDR,R2   s:15305+14,R3
          1 00034F  83A0 0000 0356  01                   JMP      s:15310,R2
          1 000352       0000                            DC       s:15310,PREL
          1 000353       0000                            DC       s:15310,PREL
          1 000354       000F                            DC       s:15320,PREL
          1 000355       002C                            DC       s:15338,PREL

     1031    15306    4         CASE 0,1;

     1032    15307        /*
     1033    15308        Erase from current position to end of line/display.
     1034    15309        */
     1035    15310    4            KV@USR_ERS.BGNPHSCLM = %KV_SRD.CRT.CLM;

  15310   1 000356  E846 0016                            LDR,R6   22,B6
          1 000358  EF47 001D                            STR,R6   KV@USR_ERS+5,AUTO

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:126  
     1036    15311    4            IF Y@FNC = %Y#CTRFNC_ED THEN

  15311   1 00035A  B847 000B                            LDR,R3   Y@FNC,AUTO
          1 00035C  3D10                                 CMV,R3   16
          1 00035D  0981 0035                            BNE      s:15351,PREL

     1037    15312        /*
     1038    15313        This is erase-display, so erase to the end of the SRD.
     1039    15314        */
     1040    15315    4            KV@USR_ERS.BTMRHT.LIN = %KV_SRD.BTMRHT.LIN;

  15315   1 00035F  C846 000B                            LDR,R4   11,B6
          1 000361  CF47 001B                            STR,R4   KV@USR_ERS+3,AUTO
          1 000363  0F81 002F                            B        s:15351,PREL

     1041    15316    4         CASE 2;

     1042    15317        /*
     1043    15318        Erase from  beginning of line/display to current position.
     1044    15319        */
     1045    15320    4            KV@USR_ERS.ENDPHSCLM = %KV_SRD.CRT.CLM;

  15320   1 000365  D846 0016                            LDR,R5   22,B6
          1 000367  DF47 001E                            STR,R5   KV@USR_ERS+6,AUTO

     1046    15321    4            IF KV@USR_ERS.ENDPHSCLM < KV@USR_ERS.BGNPHSCLM

  15321   1 000369  D956                                 CMR,R5   R6
          1 00036A  0281 000C                            BGE      s:15329,PREL
          1 00036C  B847 000B                            LDR,R3   Y@FNC,AUTO
          1 00036E  3D10                                 CMV,R3   16
          1 00036F  0981 0007                            BNE      s:15329,PREL

     1047    15322    5              AND Y@FNC = %Y#CTRFNC_ED THEN DO;

     1048    15323        /*
     1049    15324        Use a sensible value if it makes any sense to do so.
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:127  
     1050    15325        */
     1051    15326    5               KV@USR_ERS.ENDPHSCLM = KV@USR_ERS.BTMRHT.CLM;

  15326   1 000371  D847 001C                            LDR,R5   KV@USR_ERS+4,AUTO
          1 000373  DF47 001E                            STR,R5   KV@USR_ERS+6,AUTO

     1052    15327    5               KV@USR_ERS.TOPLFT.LIN = KV@USR_ERS.TOPLFT.LIN-1;

  15327   1 000375  88C7 0019                            DEC      KV@USR_ERS+1,AUTO

     1053    15328    5               END;

     1054    15329    4            IF Y@FNC = %Y#CTRFNC_ED THEN

  15329   1 000377  B847 000B                            LDR,R3   Y@FNC,AUTO
          1 000379  3D10                                 CMV,R3   16
          1 00037A  0981 0018                            BNE      s:15351,PREL

     1055    15330        /*
     1056    15331        This is erase-display, so erase from the beginning of the SRD.
     1057    15332        */
     1058    15333    4            KV@USR_ERS.TOPLFT.LIN = %KV_SRD.TOPLFT.LIN;

  15333   1 00037C  A846 0009                            LDR,R2   9,B6
          1 00037E  AF47 0019                            STR,R2   KV@USR_ERS+1,AUTO
          1 000380  0F81 0012                            B        s:15351,PREL

     1059    15334    4         CASE 3;

     1060    15335        /*
     1061    15336        Erase entire line/display.
     1062    15337        */
     1063    15338    5            IF Y@FNC = %Y#CTRFNC_ED THEN DO;

  15338   1 000382  9847 000B                            LDR,R1   Y@FNC,AUTO
          1 000384  1D10                                 CMV,R1   16
          1 000385  0981 000D                            BNE      s:15351,PREL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:128  

     1064    15339        /*
     1065    15340        This is erase-display, so erase entire SRD.
     1066    15341        */
     1067    15342    5               KV@USR_ERS.TOPLFT.LIN = %KV_SRD.TOPLFT.LIN;

  15342   1 000387  C846 0009                            LDR,R4   9,B6
          1 000389  CF47 0019                            STR,R4   KV@USR_ERS+1,AUTO

     1068    15343    5               KV@USR_ERS.BTMRHT.LIN = %KV_SRD.BTMRHT.LIN;

  15343   1 00038B  B846 000B                            LDR,R3   11,B6
          1 00038D  BF47 001B                            STR,R3   KV@USR_ERS+3,AUTO

     1069    15344    5               END;                        /* END IF Y@FNC = %Y#CTRFNC_ED        */

  15344   1 00038F  0F81 0003                            B        s:15351,PREL

     1070    15345    4         CASE ELSE;

     1071    15346        /*
     1072    15347        Illegal Pn.
     1073    15348        */
     1074    15349    4            EXIT Y$DO_CASE_FNC;

  15349   1 000391  0F81 0018                            B        s:15357,PREL

     1075    15350    4         END;                              /* END CASE %KV_X364.P_VAL(0)         */

     1076    15351    3         IF KV@USR_ERS.TOPLFT.LIN>KV@USR_ERS.BTMRHT.LIN

  15351   1 000393  C847 0019                            LDR,R4   KV@USR_ERS+1,AUTO
          1 000395  C947 001B                            CMR,R4   KV@USR_ERS+3,AUTO
          1 000397  0A01 0012                            BAG      s:15357,PREL
          1 000399  0981 0004                            BNE      s:15355,PREL
          1 00039B  E955                                 CMR,R6   R5
          1 00039C  0301 000D                            BG       s:15357,PREL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:129  

     1077    15352    3           OR KV@USR_ERS.TOPLFT.LIN=KV@USR_ERS.BTMRHT.LIN
     1078    15353    3           AND KV@USR_ERS.BGNPHSCLM>KV@USR_ERS.ENDPHSCLM
     1079    15354    3         THEN EXIT Y$DO_CASE_FNC;
     1080    15355    3         CALL KVV$CALUSR (KV@USR_ERS);

  15355   1 00039E  CBC7 0018                            LAB,B4   KV@USR_ERS,AUTO
          1 0003A0  CFC7 0030                            STB,B4   Y@EVTSTT+4,AUTO
          1 0003A2  BBC7 0030                            LAB,B3   Y@EVTSTT+4,AUTO
          1 0003A4  CBF0 0100                            LAB,B4   256,IMO
          1 0003A6  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR
          1 0003A9       0001                            DC       s:15357,PREL

     1081    15356    3      END Y$DO_CASE_FNC;                   /* END CASE Y$DO_CASE_FNC             */

     1082    15357    2   END Y$DO_FNC;

  15357   1 0003AA  ECC7 002E                            LDB,B6   Y@EVTSTT+2,AUTO
          1 0003AC  C3C6 0001                            LNJ,B4   1,B6

     1083    15358        %KV$BOX(PAGE = YES, TITLE = "Call VDH-user with KV$VDH_OTPLCL/KV$USR_DAT");

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:130  
             15376    2   /***************************************************************************
             15377    2    *                                                                         *
             15378    2    *                Call VDH-user with KV$VDH_OTPLCL/KV$USR_DAT              *
             15379    2    *                                                                         *
             15380    2    ***************************************************************************/

     1084    15385    1   Y$OTP: PROC;

  15385   1 0003AE  EFC7 002E            Y$OTP           STB,B6   Y@EVTSTT+2,AUTO

     1085    15386    3      IF Y@BGNCHRX >= 0 THEN DO;

  15386   1 0003B0  E847 000D                            LDR,R6   Y@BGNCHRX,AUTO
          1 0003B2  6801 0057                            BLZ,R6   s:15435,PREL

     1086    15387        /*
     1087    15388        There are characters to be output.
     1088    15389        */
     1089    15390              %KV$CHNPHSPSTMOD;
             15403    4                 IF KV$PTR.VDI$->KV$VDI.OTPCNDPND.PST ~= 0 THEN DO;

  15403   1 0003B4  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 0003B7  CC85                                 LDB,B4   ,B5
          1 0003B8  D844 001A                            LDR,R5   26,B4
          1 0003BA  5901 0007                            BEZ,R5   s:15414,PREL

             15406    4                    CALL KVV$CALUSR_PST;

  15406   1 0003BC  CBF0 0000                            LAB,B4   0,IMO
          1 0003BE  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR_PST
          1 0003C1       0001                            DC       s:15414,PREL

             15407    4                    END;

     1090    15414    3         %KV_SRD.HI_NONBLN = %KV_SRD.SRDEND;

  15414   1 0003C2  ECC7 0008                            LDB,B6   Y@SRD$,AUTO
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:131  
          1 0003C4  8CC6 001A                            LDI      26,B6
          1 0003C6  8D46 0017                            SDI      23,B6

     1091    15415    3         %KV_SRD.FLDEND = %KV_SRD.SRDEND;

  15415   1 0003C8  8D46 0010                            SDI      16,B6

     1092    15416    3         %KV_SRD.FLDEND.LIN = %KV_SRD.FLDEND.LIN-%KV_SRD.DVCLINBIS;

  15416   1 0003CA  D846 0010                            LDR,R5   16,B6
          1 0003CC  D246 0019                            SUB,R5   25,B6
          1 0003CE  DF46 0010                            STR,R5   16,B6

     1093    15417    3         %KV_SRD.HI_NONBLN.LIN = %KV_SRD.FLDEND.LIN;

  15417   1 0003D0  DF46 0017                            STR,R5   23,B6

     1094    15418    4         IF %KV_VDI.USEOTPBFR THEN DO;

  15418   1 0003D2  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          1 0003D5  CC85                                 LDB,B4   ,B5
          1 0003D6  82C4 001D                            LB,'0200'X        29,B4
          1 0003D8       0200
          1 0003D9  0581 0018                            BBF      s:15429,PREL

     1095    15419        /*
     1096    15420        We're to use the output buffer vector mechanism to output the characters.
     1097    15421        */
     1098    15422    4            KV@VDH_OTPLCL.BFR_.BYTX = Y@BGNCHRX;

  15422   1 0003DB  C847 000D                            LDR,R4   Y@BGNCHRX,AUTO
          1 0003DD  CF47 0026                            STR,R4   KV@VDH_OTPLCL+3,AUTO

     1099    15423    4            KV@VDH_OTPLCL.BFR_.BYTSIZ = Y@CHRX - Y@BGNCHRX;

  15423   1 0003DF  C247 000E                            SUB,R4   Y@CHRX,AUTO
          1 0003E1  8254                                 NEG      R4
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:132  
          1 0003E2  CF47 0027                            STR,R4   KV@VDH_OTPLCL+4,AUTO

     1100    15424    4            CALL KVO$OTPLCL (KV@VDH_OTPLCL);

  15424   1 0003E4  CBC7 0023                            LAB,B4   KV@VDH_OTPLCL,AUTO
          1 0003E6  CFC7 0030                            STB,B4   Y@EVTSTT+4,AUTO
          1 0003E8  BBC7 0030                            LAB,B3   Y@EVTSTT+4,AUTO
          1 0003EA  CBF0 0100                            LAB,B4   256,IMO
          1 0003EC  E380 0000 0000  xent                 LNJ,B6   KVO$OTPLCL
          1 0003EF       0001                            DC       s:15425,PREL

     1101    15425    4            END; ELSE DO;                  /* ELSE USEOTPBFR                     */

  15425   1 0003F0  0F81 0016                            B        s:15433,PREL

     1102    15426        /*
     1103    15427        Call the VDH-user with KV@USR_DAT.
     1104    15428        */
     1105    15429    4            KV@USR_DAT.DAT__.BYTX = Y@BGNCHRX;

  15429   1 0003F2  C847 000D                            LDR,R4   Y@BGNCHRX,AUTO
          1 0003F4  CF47 0013                            STR,R4   KV@USR_DAT+3,AUTO

     1106    15430    4            KV@USR_DAT.DAT__.DATBYTSIZ = Y@CHRX - Y@BGNCHRX;

  15430   1 0003F6  C247 000E                            SUB,R4   Y@CHRX,AUTO
          1 0003F8  8254                                 NEG      R4
          1 0003F9  CF47 0014                            STR,R4   KV@USR_DAT+4,AUTO

     1107    15431    4            CALL KVV$CALUSR(KV@USR_DAT);

  15431   1 0003FB  CBC7 0010                            LAB,B4   KV@USR_DAT,AUTO
          1 0003FD  CFC7 0030                            STB,B4   Y@EVTSTT+4,AUTO
          1 0003FF  BBC7 0030                            LAB,B3   Y@EVTSTT+4,AUTO
          1 000401  CBF0 0100                            LAB,B4   256,IMO
          1 000403  E380 0000 0000  xent                 LNJ,B6   KVV$CALUSR
          1 000406       0001                            DC       s:15433,PREL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:133  

     1108    15432    4            END;                           /* END IF USEOTPBFR                   */

     1109    15433    3         Y@BGNCHRX = -1;

  15433   1 000407  8947 000D                            LBT,'FFFF'X       Y@BGNCHRX,AUTO
  15433   1 000409       FFFF

     1110    15434    3         END;                              /* END IF Y@BGNCHRX >= 0              */

     1111    15435    2   END Y$OTP;

  15435   1 00040A  ECC7 002E                            LDB,B6   Y@EVTSTT+2,AUTO
          1 00040C  C3C6 0001                            LNJ,B4   1,B6

     1112    15436    1   END KVO$X364;

  15436   1 00040E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:134  
--  Include file information  --

   K_CP6_M.:E05TOU  is referenced.
   KV_ERRORS_C.:E05TOU  is referenced.
   KV_INT_M.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  was found in the system file and is never referenced.
   KV_GLBCNS_E.:E05TOU  was found in the system file and is referenced.
   KV$VDO.:E05TOU  was found in the system file and is never referenced.
   KV$VDH.:E05TOU  was found in the system file and is referenced.
   KV$USR.:E05TOU  was found in the system file and is referenced.
   KV$SND.:E05TOU  was found in the system file and is never referenced.
   KV$INT.:E05TOU  was found in the system file and is referenced.
   KV$GLBCTX.:E05TOU  was found in the system file and is referenced.
   KV$GLB.:E05TOU  was found in the system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure KVO$X364.
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:135  

 **** Variables and constants ****

  ****  Section 000 RoData KVO$X364

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(304)   r     1 KV_X364
   112-0-0/b BIT (8)     r     1 Y_ANSGRPRND(0:9)
    93-0-0/c UBIN(8)     r     1 Y_CTRSQNCHR(0:63)
    93-0-0/c CHAR(64)    r     1 Y_CTRSQNCHR_INT           13-0-0/w STRC(8)     r     1 Y_EVT(0:255)
    C5-0-0/b STRC(1232)  r     1 Y_EVTSTT
    C5-0-0/b BIT (16)    r     1 Y_EVTSTTA(0:76)
    13-0-0/w STRC(2048)  r     1 Y_EVT_INT
    B3-0-0/c UBIN(8)     r     1 Y_INDCTRCHR(0:35)
    B3-0-0/c CHAR        r     1 Y_INDCTRCHR_INT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @PRM_VDH_OTPLCL           10-0-0/w STRC(128)   r     1 KV@USR_DAT
    18-0-0/w STRC(112)   r     1 KV@USR_ERS                1F-0-0/w STRC(64)    r     1 KV@USR_SETATR
    23-0-0/w STRC(80)    r     1 KV@VDH_OTPLCL             28-0-0/w STRC(64)    r     1 KV@VDH_PST
    *0-0-0/w STRC(80)    r     1 PRM_VDH_OTPLCL             D-0-0/w SBIN(16)    r     1 Y@BGNCHRX
     A-0-0/w SBIN(16)    r     1 Y@CHR                      E-0-0/w SBIN(16)    r     1 Y@CHRX
     F-0-0/w SBIN(16)    r     1 Y@CHRX_HI                 2C-0-0/w STRC(16)    r     1 Y@EVTSTT
     B-0-0/w UBIN(16)    r     1 Y@FNC                      C-0-0/w UBIN(16)    r     1 Y@I_CHR
     8-0-0/w PTR         r     1 Y@SRD$                     6-0-0/w PTR         r     1 Y@X364$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KV$PTR$                    0-0-0/w STRC(128)   r     1 KV_USR_DAT
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:136  
     0-0-0/w STRC(112)   r     1 KV_USR_ERS                 0-0-0/w STRC(64)    r     1 KV_USR_SETATR
     0-0-0/w STRC(64)    r     1 KV_VDH_PST_0_VRT
     0-0-0/w STRC(64)    r     1 KV_VDH_PST_ABS_VRT_NO_SCR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KV$MVD                     0-0-0/w STRC(480)   r     1 KV$PTR
     0-0-0/w STRC(496)   r     1 KV$SRD                     0-0-0/w STRC(512)   r     1 KV$STR
     0-0-0/w STRC(512)   r     1 KV$VDI                     0-0-0/w STRC(304)   r     1 KV$X364
     0-0-0/c UBIN(8)     r     1 Y$CHR(0:0)


   Procedure KVO$X364 requires 1041 words for executable code.
   Procedure KVO$X364 requires 50 words of local(AUTO) storage.

    No errors detected in file KVO$X364.:E05TSI    .
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:137  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:138  
          MINI XREF LISTING

KV$MVD.LINLST$
       305**DCL     14430>>ASSIGN
KV$MVD.VRTCLM
       319**DCL     15167<<ASSIGN  15173>>ASSIGN
KV$MVD.VRTLIN
       319**DCL     15170<<ASSIGN  15172>>ASSIGN
KV$PTR.INPCNDPND
       351**DCL       360--REDEF     364--REDEF
KV$PTR.LINLST$
       347**DCL       348--REDEF
KV$PTR.MVD$
       346**DCL     14430>>ASSIGN  15167>>ASSIGN  15170>>ASSIGN  15172>>ASSIGN  15173>>ASSIGN
KV$PTR.SRD$
       347**DCL     14431>>ASSIGN
KV$PTR.STR$
       345**DCL     14498>>IF      14502>>ASSIGN  14557>>IF      14561>>ASSIGN  14614>>IF      14618>>ASSIGN
     14698>>IF      14702>>ASSIGN  14742>>IF      14746>>ASSIGN  14797>>IF      14801>>ASSIGN  14859>>IF
     14863>>ASSIGN  14974>>IF      14978>>ASSIGN  15264>>ASSIGN
KV$PTR.VDI$
       345**DCL     14432>>IF      15403>>IF      15418>>IF
KV$PTR$
       339**DCL       345--IMP-PTR 14430>>ASSIGN  14431>>ASSIGN  14432>>IF      14498>>IF      14502>>ASSIGN
     14557>>IF      14561>>ASSIGN  14614>>IF      14618>>ASSIGN  14698>>IF      14702>>ASSIGN  14742>>IF
     14746>>ASSIGN  14797>>IF      14801>>ASSIGN  14859>>IF      14863>>ASSIGN  14974>>IF      14978>>ASSIGN
     15167>>ASSIGN  15170>>ASSIGN  15172>>ASSIGN  15173>>ASSIGN  15264>>ASSIGN  15403>>IF      15418>>IF
KV$SRD.BTMRHT
       484**DCL       489--REDEF
KV$SRD.BTMRHT.CLM
       486**DCL     15301>>ASSIGN
KV$SRD.BTMRHT.LIN
       486**DCL     15315>>ASSIGN  15343>>ASSIGN
KV$SRD.CRT
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:139  
       560**DCL       565--REDEF   15263>>ASSIGN
KV$SRD.CRT.CLM
       562**DCL     15167>>ASSIGN  15310>>ASSIGN  15320>>ASSIGN
KV$SRD.CRT.LIN
       562**DCL     15166>>ASSIGN  15303>>ASSIGN
KV$SRD.CRTVRTLINPHSLIN
       532**DCL     15166<<ASSIGN  15170>>ASSIGN
KV$SRD.DVCLINBIS
       602**DCL     15169>>ASSIGN  15170>>ASSIGN  15303>>ASSIGN  15416>>ASSIGN
KV$SRD.FLDEND
       524**DCL       529--REDEF   15415<<ASSIGN
KV$SRD.FLDEND.LIN
       526**DCL     15416<<ASSIGN  15416>>ASSIGN  15417>>ASSIGN
KV$SRD.HI_NONBLN
       594**DCL       599--REDEF   15414<<ASSIGN
KV$SRD.HI_NONBLN.CLM
       596**DCL     15168<<ASSIGN
KV$SRD.HI_NONBLN.LIN
       596**DCL     15169<<ASSIGN  15417<<ASSIGN
KV$SRD.LNG
       492**DCL     15203>>ASSIGN  15217>>IF      15218>>ASSIGN
KV$SRD.ORG
       416**DCL       421--REDEF
KV$SRD.SCROLL
       493**DCL     15201>>IF
KV$SRD.SRDEND
       629**DCL       634--REDEF   15414>>ASSIGN  15415>>ASSIGN
KV$SRD.SRDEND.CLM
       631**DCL     15168>>ASSIGN
KV$SRD.SRDEND.LIN
       631**DCL     15169>>ASSIGN
KV$SRD.TOPLFT
       450**DCL       455--REDEF
KV$SRD.TOPLFT.CLM
       452**DCL     15167>>ASSIGN  15299>>ASSIGN
KV$SRD.TOPLFT.LIN
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:140  
       452**DCL     15170>>ASSIGN  15333>>ASSIGN  15342>>ASSIGN
KV$SRD.VRTPSTOK
       493**DCL     15165>>IF
KV$SRD.VRTSCR
       638**DCL     15201>>IF
KV$SRD.WDT
       492**DCL     15222>>IF      15223>>ASSIGN
KV$STR.ERR.COD
       718**DCL     14498>>IF      14502<<ASSIGN  14557>>IF      14561<<ASSIGN  14614>>IF      14618<<ASSIGN
     14698>>IF      14702<<ASSIGN  14742>>IF      14746<<ASSIGN  14797>>IF      14801<<ASSIGN  14859>>IF
     14863<<ASSIGN  14974>>IF      14978<<ASSIGN
KV$STR.GRPRND
       728**DCL     15264<<ASSIGN
KV$VDI.OTPCNDPND.PST
       788**DCL     15403>>IF
KV$VDI.USEOTPBFR
       791**DCL     14432>>IF      15418>>IF
KV$X364.P_VAL
       835**DCL     14512<<ASSIGN  14541>>IF      14569<<ASSIGN  14569>>ASSIGN  14906<<ASSIGN  14988<<ASSIGN
     15174>>IF      15174<<ASSIGN  15177>>ASSIGN  15180>>ASSIGN  15183>>ASSIGN  15185>>ASSIGN  15187>>ASSIGN
     15189>>ASSIGN  15191>>ASSIGN  15192>>ASSIGN  15194>>ASSIGN  15212>>ASSIGN  15257>>IF      15257>>IF
     15259>>ASSIGN  15305>>DOCASE
KV$X364.P_X
       832**DCL     14482>>IF      14511<<ASSIGN  14511>>ASSIGN  14512>>ASSIGN  14541>>IF      14569>>ASSIGN
     14569>>ASSIGN  14907<<ASSIGN  14964>>IF      14987<<ASSIGN  14987>>ASSIGN  14988>>ASSIGN  15256>>DOWHILE
     15257>>IF      15257>>IF      15259>>ASSIGN  15261<<ASSIGN  15261>>ASSIGN
KV$X364.STT
       832**DCL     14450>>ASSIGN  15082<<ASSIGN
KV@USR_DAT
      1880**DCL     14436<<ASSIGN  15431<>CALL
KV@USR_DAT.DAT__.ADR$
      1936**DCL     14437<<ASSIGN
KV@USR_DAT.DAT__.BYTX
      1936**DCL     15429<<ASSIGN
KV@USR_DAT.DAT__.DATBYTSIZ
      1936**DCL     15430<<ASSIGN
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:141  
KV@USR_ERS
      1976**DCL     15298<<ASSIGN  15355<>CALL
KV@USR_ERS.BGNPHSCLM
      2051**DCL     15300<<ASSIGN  15310<<ASSIGN  15321>>IF      15351>>IF
KV@USR_ERS.BTMRHT
      2043**DCL      2048--REDEF
KV@USR_ERS.BTMRHT.CLM
      2045**DCL     15301<<ASSIGN  15302>>ASSIGN  15326>>ASSIGN
KV@USR_ERS.BTMRHT.LIN
      2045**DCL     15304<<ASSIGN  15315<<ASSIGN  15343<<ASSIGN  15351>>IF      15351>>IF
KV@USR_ERS.ENDPHSCLM
      2051**DCL     15302<<ASSIGN  15320<<ASSIGN  15321>>IF      15326<<ASSIGN  15351>>IF
KV@USR_ERS.TOPLFT
      2009**DCL      2014--REDEF
KV@USR_ERS.TOPLFT.CLM
      2011**DCL     15299<<ASSIGN  15300>>ASSIGN
KV@USR_ERS.TOPLFT.LIN
      2011**DCL     15303<<ASSIGN  15304>>ASSIGN  15327<<ASSIGN  15327>>ASSIGN  15333<<ASSIGN  15342<<ASSIGN
     15351>>IF      15351>>IF
KV@USR_SETATR
      2081**DCL     15255<<ASSIGN  15265<>CALL
KV@USR_SETATR.GRPRND
      2170**DCL     15259<<ASSIGN  15259>>ASSIGN  15264>>ASSIGN
KV@USR_SETATR.PHSPST
      2114**DCL      2119--REDEF   15263<<ASSIGN
KV@VDH_OTPLCL
      2214**DCL     14429<<ASSIGN  15424<>CALL
KV@VDH_OTPLCL.BFR_.ADR$
      2247**DCL     14437>>ASSIGN  14449>>ASSIGN
KV@VDH_OTPLCL.BFR_.BYTSIZ
      2247**DCL     14439>>ASSIGN  15423<<ASSIGN
KV@VDH_OTPLCL.BFR_.BYTX
      2247**DCL     14439>>ASSIGN  14441>>DOINDEX 15422<<ASSIGN
KV@VDH_PST
      2279**DCL     15161<<ASSIGN  15226<>CALL
KV@VDH_PST.PSTVAL
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:142  
      2317**DCL      2322--REDEF
KV@VDH_PST.PSTVAL.CLM
      2319**DCL     15173<<ASSIGN  15178<<ASSIGN  15181<<ASSIGN  15183<<ASSIGN  15183>>ASSIGN  15187<<ASSIGN
     15187>>ASSIGN  15192<<ASSIGN  15194<<ASSIGN  15207<<ASSIGN  15222>>IF      15223<<ASSIGN  15224>>IF
     15225<<ASSIGN
KV@VDH_PST.PSTVAL.LIN
      2319**DCL     15172<<ASSIGN  15177<<ASSIGN  15177>>ASSIGN  15180<<ASSIGN  15180>>ASSIGN  15185<<ASSIGN
     15185>>ASSIGN  15189<<ASSIGN  15189>>ASSIGN  15191<<ASSIGN  15196<<ASSIGN  15196>>ASSIGN  15200<<ASSIGN
     15200>>ASSIGN  15201>>IF      15203<<ASSIGN  15208<<ASSIGN  15208>>ASSIGN  15212<<ASSIGN  15217>>IF
     15218<<ASSIGN  15219>>IF      15220<<ASSIGN
KV@VDH_PST.VRTSCRENB
      2288**DCL     15197<<ASSIGN  15209<<ASSIGN
KVO$OTPLCL
       185**DCL-ENT 15424--CALL
KVO$PST
       186**DCL-ENT 15165--CALL    15226--CALL
KVV$CALUSR
       187**DCL-ENT 15265--CALL    15355--CALL    15431--CALL
KVV$CALUSR_PST
       188**DCL-ENT 15406--CALL
KV_USR_DAT
       858**DCL     14436>>ASSIGN
KV_USR_ERS
       953**DCL     15298>>ASSIGN
KV_USR_ERS.BTMRHT
      1020**DCL      1025--REDEF
KV_USR_ERS.TOPLFT
       986**DCL       991--REDEF
KV_USR_SETATR
      1057**DCL     15255>>ASSIGN
KV_USR_SETATR.PHSPST
      1090**DCL      1095--REDEF
KV_VDH_PST_0_VRT
      1328**DCL     15165<>CALL
KV_VDH_PST_0_VRT.PSTVAL
      1366**DCL      1371--REDEF
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:143  
KV_VDH_PST_ABS_VRT_NO_SCR
      1254**DCL     15161>>ASSIGN
KV_VDH_PST_ABS_VRT_NO_SCR.PSTVAL
      1292**DCL      1297--REDEF
KV_X364.P_VAL
      1795**DCL     14906>>ASSIGN
PRM_VDH_OTPLCL
      1190**DCL        10--PROC    14429>>ASSIGN
Y$CASE_ACT
     14452**LABEL   14508--EXIT    14567--EXIT    14624--EXIT    14807--EXIT    14869--EXIT    14984--EXIT
Y$CHR
      1583**DCL     14449>>ASSIGN
Y$DO_CASE_FNC IN PROCEDURE Y$DO_FNC
     15117**LABEL   15349--EXIT    15354--EXIT
Y$DO_FNC
     15115**PROC    14631--CALL    14814--CALL    14876--CALL
Y$NO_LIN_CHK IN PROCEDURE Y$DO_FNC
     15219**LABEL   15198--GOTO    15205--GOTO    15210--GOTO
Y$OTP
     15385**PROC    14905--CALL    15017--CALL    15087--CALL
Y@BGNCHRX
      1853**DCL     14428<<ASSIGN  15046>>IF      15051<<ASSIGN  15386>>IF      15422>>ASSIGN  15423>>ASSIGN
     15429>>ASSIGN  15430>>ASSIGN  15433<<ASSIGN
Y@CHR
      1839**DCL     14449<<ASSIGN  14450>>ASSIGN  14569>>ASSIGN  14598>>IF      14598>>IF      14630>>ASSIGN
     14781>>IF      14781>>IF      14813>>ASSIGN  14843>>IF      14843>>IF      14875>>ASSIGN  14988>>ASSIGN
     15080>>ASSIGN
Y@CHRX
      1858**DCL     14441<<DOINDEX 14449>>ASSIGN  15051>>ASSIGN  15423>>ASSIGN  15430>>ASSIGN
Y@CHRX_HI
      1862**DCL     14439<<ASSIGN  14441>>DOINDEX
Y@EVTSTT
      2532**DCL     14450<<ASSIGN
Y@EVTSTT.ACT
      2544**DCL     14452>>DOCASE
Y@EVTSTT.ERRCOD
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:144  
      2538**DCL     14702>>ASSIGN  14746>>ASSIGN
Y@EVTSTT.NXTSTT
      2541**DCL     15082>>ASSIGN
Y@FNC
      1843**DCL     14630<<ASSIGN  14813<<ASSIGN  14875<<ASSIGN  15117>>DOCASE  15175>>DOCASE  15311>>IF
     15321>>IF      15329>>IF      15338>>IF
Y@I_CHR
      1847**DCL     15080<<ASSIGN
Y@SRD$
      1835**DCL       388--IMP-PTR 14431<<ASSIGN  15165>>IF      15166>>ASSIGN  15166>>ASSIGN  15167>>ASSIGN
     15167>>ASSIGN  15168>>ASSIGN  15168>>ASSIGN  15169>>ASSIGN  15169>>ASSIGN  15169>>ASSIGN  15170>>ASSIGN
     15170>>ASSIGN  15170>>ASSIGN  15201>>IF      15201>>IF      15203>>ASSIGN  15217>>IF      15218>>ASSIGN
     15222>>IF      15223>>ASSIGN  15263>>ASSIGN  15299>>ASSIGN  15301>>ASSIGN  15303>>ASSIGN  15303>>ASSIGN
     15310>>ASSIGN  15315>>ASSIGN  15320>>ASSIGN  15333>>ASSIGN  15342>>ASSIGN  15343>>ASSIGN  15414>>ASSIGN
     15414>>ASSIGN  15415>>ASSIGN  15415>>ASSIGN  15416>>ASSIGN  15416>>ASSIGN  15416>>ASSIGN  15417>>ASSIGN
     15417>>ASSIGN
Y@X364$
      1831**DCL       823--IMP-PTR 14430<<ASSIGN  14450>>ASSIGN  14482>>IF      14511>>ASSIGN  14511>>ASSIGN
     14512>>ASSIGN  14512>>ASSIGN  14541>>IF      14541>>IF      14569>>ASSIGN  14569>>ASSIGN  14569>>ASSIGN
     14569>>ASSIGN  14906>>ASSIGN  14907>>ASSIGN  14964>>IF      14987>>ASSIGN  14987>>ASSIGN  14988>>ASSIGN
     14988>>ASSIGN  15082>>ASSIGN  15174>>IF      15174>>ASSIGN  15177>>ASSIGN  15180>>ASSIGN  15183>>ASSIGN
     15185>>ASSIGN  15187>>ASSIGN  15189>>ASSIGN  15191>>ASSIGN  15192>>ASSIGN  15194>>ASSIGN  15212>>ASSIGN
     15256>>DOWHILE 15257>>IF      15257>>IF      15257>>IF      15257>>IF      15259>>ASSIGN  15259>>ASSIGN
     15261>>ASSIGN  15261>>ASSIGN  15305>>DOCASE
Y_ANSGRPRND
     14396**DCL     15259>>ASSIGN
Y_CTRSQNCHR
     12070**DCL     14630>>ASSIGN
Y_CTRSQNCHR_INT
     12069**DCL     12070--REDEF
Y_EVT.EVT
     12051**DCL     14450>>ASSIGN
Y_EVTSTT
     12075**DCL     14394--REDEF
Y_EVTSTTA
     14394**DCL     14450>>ASSIGN
PL6.E3A0      #001=KVO$X364 File=KVO$X364.:E05TSI                                WED 07/30/97 02:12 Page:145  
Y_EVT_INT
      2550**DCL     12045--REDEF
Y_INDCTRCHR
     12073**DCL     14813>>ASSIGN  14875>>ASSIGN
Y_INDCTRCHR_INT
     12072**DCL     12073--REDEF
