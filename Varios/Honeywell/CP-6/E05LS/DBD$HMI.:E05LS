VERSION E05

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:1    
        1        1        /*M* DBD$HMI - Formats HMI context and the FEP Circular Queues */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ECU=0,ENU=0   */
        8        8
        9        9        /*F*    NAME: DBD$HMI
       10       10                PURPOSE: To process the HMI command for FEPs.
       11       11
       12       12        */
       13       13        DBD$HMI: PROC(TOP);
       14       14
       15       15        %INCLUDE CP_6;
       16     5574        %INCLUDE GH_SCHD_M;
       17     5718        %INCLUDE G$BOBCAT_M;
       18     5738        %INCLUDE DA_FORMAT_C;
       19     5980        %INCLUDE XU_MACRO_C;
       20     9086        %INCLUDE KNH_MACRO_C;
       21     9369
       22     9370        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
       23     9415        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
       24     9460
       25     9461    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       26     9462    1   DCL DAF$WRITE EPTR SYMREF;
       27     9463    1   DCL DAF$INIT ENTRY(1) ALTRET;
       28     9464    1   DCL DBB$HEXDUMP ENTRY(4);
       29     9465    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
       30     9466    1   DCL DBM$GETBOBCAT ENTRY(1) ALTRET;
       31     9467    1   DCL DBM$PACK1 ENTRY(2);
       32     9468    1   DCL DBM$PACK2 ENTRY(2);
       33     9469    1   DCL DBM$PACK4 ENTRY(2);
       34     9470
       35     9471        %REPORT (NAME=HMI_RPT1,TRUNC=YES,HEADER=YES,TITLE=
              9471            'FEP HMI - Host/Monitor Interface Table');
       36     9537
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:2    
       37     9538        %HEADER (LAST=NO,TEXT=
       38     9539        'HMI$   USR PP#   PPSZ  WAIT_$ W#  SFLGS RCQ_LOCK       SCQ_LOCK       LDCT#');
       39     9581        %HEADER (TEXT=
       40     9582        '------ --- ----- ----- ------ --- ----- -------------- -------------- -----');
       41     9624
       42     9625    1   DCL HMI_FMT1 CHAR(0) CONSTANT INIT(
       43     9626    1   '.%5ZH .%2ZH .%@4.32ZH .%@4.16ZH .%@5.32ZH %@3.16D .%@4.16ZH .%@8.32ZH %@4.16ZH .%@8
              9626        .32ZH %@4.16ZH %@5.16D');
       44     9627
       45     9628    1   DCL 1 HMI_RPT20 CHAR(0) CONSTANT INIT(
       46     9629    1   '       Receive CQ                    Send CQ                       Context area');
       47     9630    1   DCL 1 HMI_RPT21 CHAR(0) CONSTANT INIT(
       48     9631    1   'HMI$   Insert$ Remove$ WdSz  Offset  Insert$ Remove$ WdSz  Offset  WdSz  Offset');
       49     9632    1   DCL 1 HMI_RPT22 CHAR(0) CONSTANT INIT(
       50     9633    1   '------ ------- ------- ----- ------  ------- ------- ----- ------  ----- ------');
       51     9634    1   DCL HMI_FMT2 CHAR(0) CONSTANT INIT(
       52     9635    1   '.%5ZH .%5ZH  .%5ZH  .%4ZH .%@4.16ZH   .%5ZH  .%5ZH  .%4ZH .%@4.16ZH   .%@4.16ZH .%@
              9635        4.16ZH');
       53     9636
       54     9637
       55     9638    1   DCL BLANK_LINE CHAR(4) SYMREF;
       56     9639    1   DCL DB_BOBCAT$ UBIN SYMREF;
       57     9640    1   DCL DB_HANDQ$ UBIN SYMREF;
       58     9641    1   DCL DA_MAPERR BIT(36) SYMREF;
       59     9642
       60     9643    1   DCL B$BIT18 CHAR(2) BASED CALIGNED;
       61     9644
       62     9645    1   DCL PASS UBIN;
       63     9646    1   DCL ACTION UBIN;                        /*0-display all  1-display if in use*/
       64     9647    1   DCL ENTRY_TYPE UBIN;                    /*0-display  1-check in use and counts*/
       65     9648
       66     9649    1   DCL HMI# UBIN;
       67     9650    1   DCL HMI$ UBIN;
       68     9651    1   DCL USER# UBIN;
       69     9652    1   DCL SIZEW_HMI UBIN;
       70     9653    1   DCL THIS_HMI$ UBIN;
       71     9654    1   DCL TX UBIN;
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:3    
       72     9655    1   DCL I UBIN;
       73     9656    1   DCL SIZEW_USRT UBIN;
       74     9657    1   DCL USER$ UBIN;
       75     9658    1   DCL MUIS UBIN;
       76     9659    1   DCL THIS_USER$ UBIN;
       77     9660
       78     9661    1   DCL RCQ_I$ UBIN;
       79     9662    1   DCL RCQ_R$ UBIN;
       80     9663    1   DCL RCQ_WDSZ UBIN;
       81     9664    1   DCL RCQ_OFFSET UBIN;
       82     9665    1   DCL SCQ_I$ UBIN;
       83     9666    1   DCL SCQ_R$ UBIN;
       84     9667    1   DCL SCQ_WDSZ UBIN;
       85     9668    1   DCL SCQ_OFFSET UBIN;
       86     9669    1   DCL CTX_WDSZ UBIN;
       87     9670
       88     9671        %G$BOBCAT (FPTN=G$BOBCAT,STCLASS=AUTO);
       89     9684        %KNH$HMI (FPTN=KNH$HMI,STCLASS=AUTO);
       90     9691        %G$USER (FPTN=G$USER,STCLASS=AUTO);
       91     9702
       92     9703
       93     9704        %EJECT;
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:4    
       94     9705    1      ENTRY_TYPE=0/*display*/;
       95     9706    1      GOTO HMI_START;
       96     9707
       97     9708    1   DBD$HMI_CHECK: ENTRY(TOP);
       98     9709    1      ENTRY_TYPE=1/*check*/;
       99     9710    1      RETURN;
      100     9711
      101     9712    1   HMI_START: ;
      102     9713    1      CALL DBM$GETBOBCAT(G$BOBCAT);
      103     9714    1      CALL DBM$PACK2(G$BOBCAT.HMI#,HMI#);
      104     9715    1      CALL DBM$PACK4(G$BOBCAT.HMI$,HMI$);
      105     9716    1      SIZEW_HMI = (SIZEC(KNH$HMI)+1) / 2;
      106     9717
      107     9718    1      CALL DBM$PACK2(G$BOBCAT.MUIS,MUIS);
      108     9719    1      CALL DBM$PACK4(G$BOBCAT.USRT$,USER$);
      109     9720    1      SIZEW_USRT = (SIZEC(G$USER)+1) /2;
      110     9721
      111     9722    1      ACTION=1/*display if in use*/;
      112     9723
      113     9724    2      DO PASS=0 TO 1;
      114     9725    2           IF PASS=0
      115     9726    2           THEN CALL DAF$INIT(HMI_RPT1);
      116     9727    3           ELSE DO;
      117     9728    3                CALL DAF$WRITE(VECTOR(BLANK_LINE));
      118     9729    3                CALL DAF$WRITE(VECTOR(HMI_RPT20));
      119     9730    3                CALL DAF$WRITE(VECTOR(HMI_RPT21));
      120     9731    3                CALL DAF$WRITE(VECTOR(HMI_RPT22));
      121     9732    3                END;
      122     9733
      123     9734    2           IF TOP.NSUBLKS=0
      124     9735    3           THEN DO;
      125     9736
      126     9737    3   DISPLAY_LOOP: ;
      127     9738    4                DO I=0 TO HMI#-1;
      128     9739    4                     CALL DISP_HMI;
      129     9740    4                     END;
      130     9741    3                DA_MAPERR = '0'B;
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:5    
      131     9742    3                END;
      132     9743
      133     9744
      134     9745    3           ELSE DO;
      135     9746    4                DO TX=0 TO TOP.NSUBLKS-1;
      136     9747    4                     CALL DAA$VALUE(TOP.SUBLK$(TX)->OUT,I)
      137     9748    5                     WHENRETURN DO;
      138     9749    5                          IF I = 0
      139     9750    6                          THEN DO;
      140     9751    6                               ACTION=0/*display all*/;
      141     9752    6                               GOTO DISPLAY_LOOP;
      142     9753    6                               END;
      143     9754
      144     9755    5                          IF I <= MUIS
      145     9756    6                          THEN DO;
      146     9757    6                               THIS_USER$ = USER$ + (SIZEW_USRT * I);
      147     9758    6                               CALL DBM$GETMEM(THIS_USER$,G$USER,0,SIZEC(G$USER),,SIZEC
              9758                                        (G$USER));
      148     9759    6                               CALL DBM$PACK4(G$USER.HMI$,I);
      149     9760
      150     9761    6                               IF I ~= 0
      151     9762    6                               THEN CALL DISP_HMI;
      152     9763    6                               END/*do if i<= user#*/;
      153     9764
      154     9765    5                          END/*whenreturn do*/;
      155     9766
      156     9767    4                     END/*do TX=0 to TOP*/;
      157     9768    3                END/*else do*/;
      158     9769    2           END/*do pass=0 to 1*/;
      159     9770
      160     9771    1      CALL DAF$WRITE(VECTOR(BLANK_LINE));
      161     9772    1      RETURN;
      162     9773
      163     9774
      164     9775    1   DISP_HMI: PROC;
      165     9776    2      IF I < DB_BOBCAT$
      166     9777    2      THEN THIS_HMI$ = HMI$ + (SIZEW_HMI * I);
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:6    
      167     9778    3      ELSE DO;
      168     9779    3           THIS_HMI$ = I;
      169     9780    3           I = 0;
      170     9781    3           END;
      171     9782
      172     9783    2      CALL DBM$GETMEM(THIS_HMI$,KNH$HMI,0,SIZEC(KNH$HMI),,SIZEC(KNH$HMI));
      173     9784    2      CALL DBM$PACK2(KNH$HMI.USER#,USER#);
      174     9785    2      IF (ACTION=1) AND (USER#=0) THEN RETURN;
      175     9786
      176     9787    2      IF PASS=0
      177     9788    3      THEN DO;
      178     9789    3           CALL DAF$WRITE(VECTOR(HMI_FMT1),
      179     9790    3             VECTOR(THIS_HMI$),
      180     9791    3             VECTOR(USER#),
      181     9792    3             VECTOR(KNH$HMI.PP#),
      182     9793    3             VECTOR(KNH$HMI.PPSZ),
      183     9794    3             VECTOR(KNH$HMI.WAIT_HEAD$),
      184     9795    3             VECTOR(KNH$HMI.WAIT_COUNT),
      185     9796    3             VECTOR(ADDR(KNH$HMI.SCQ.BUSY)->B$BIT18),
      186     9797    3             VECTOR(KNH$HMI.RCQ.LOCK.WHO),
      187     9798    3             VECTOR(KNH$HMI.RCQ.LOCK.SREG),
      188     9799    3             VECTOR(KNH$HMI.SCQ.LOCK.WHO),
      189     9800    3             VECTOR(KNH$HMI.SCQ.LOCK.SREG),
      190     9801    3             VECTOR(KNH$HMI.LDCTS#));
      191     9802    3           END/*pass 0*/;
      192     9803
      193     9804    3      ELSE DO;
      194     9805    3           CALL DBM$PACK2(KNH$HMI.RCQ.IPTR,RCQ_I$);
      195     9806    3           CALL DBM$PACK2(KNH$HMI.RCQ.RPTR,RCQ_R$);
      196     9807    3           CALL DBM$PACK2(KNH$HMI.SCQ.IPTR,SCQ_I$);
      197     9808    3           CALL DBM$PACK2(KNH$HMI.SCQ.RPTR,SCQ_R$);
      198     9809    3           CALL DBM$PACK2(KNH$HMI.RCQ.SZ,RCQ_WDSZ);
      199     9810    3           CALL DBM$PACK2(KNH$HMI.SCQ.SZ,SCQ_WDSZ);
      200     9811    3           CALL DBM$PACK2(KNH$HMI.CTX.SZ,CTX_WDSZ);
      201     9812    3           CALL DBM$PACK2(KNH$HMI.RCQ.OFFSET,RCQ_OFFSET);
      202     9813    3           CALL DBM$PACK2(KNH$HMI.SCQ.OFFSET,SCQ_OFFSET);
      203     9814
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:7    
      204     9815    3           RCQ_I$ = (RCQ_I$ *2) + RCQ_OFFSET + DB_HANDQ$;
      205     9816    3           RCQ_R$ = (RCQ_R$ *2) + RCQ_OFFSET + DB_HANDQ$;
      206     9817    3           RCQ_WDSZ = (RCQ_WDSZ *2);
      207     9818    3           SCQ_I$ = (SCQ_I$ *2) + SCQ_OFFSET + DB_HANDQ$;
      208     9819    3           SCQ_R$ = (SCQ_R$ *2) + SCQ_OFFSET + DB_HANDQ$;
      209     9820    3           SCQ_WDSZ = (SCQ_WDSZ *2);
      210     9821
      211     9822    3           CALL DAF$WRITE(VECTOR(HMI_FMT2),
      212     9823    3             VECTOR(THIS_HMI$),
      213     9824    3             VECTOR(RCQ_I$),
      214     9825    3             VECTOR(RCQ_R$),
      215     9826    3             VECTOR(RCQ_WDSZ),
      216     9827    3             VECTOR(KNH$HMI.RCQ.OFFSET),
      217     9828    3             VECTOR(SCQ_I$),
      218     9829    3             VECTOR(SCQ_R$),
      219     9830    3             VECTOR(SCQ_WDSZ),
      220     9831    3             VECTOR(KNH$HMI.SCQ.OFFSET),
      221     9832    3             VECTOR(KNH$HMI.CTX.SZ),
      222     9833    3             VECTOR(KNH$HMI.CTX.OFFSET));
      223     9834
      224     9835    3           END/*pass 1*/;
      225     9836
      226     9837    2      RETURN;
      227     9838    2   END DISP_HMI;
      228     9839    1   END DBD$HMI;
      229     9840        %EOD;

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:8    
--  Include file information  --

   KNH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   GH_SCHD_M.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DBD$HMI.

   Procedure DBD$HMI requires 536 words for executable code.
   Procedure DBD$HMI requires 194 words of local(AUTO) storage.

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:9    

 Object Unit name= DBD$HMI                                    File name= DBD$HMI.:E05TOU
 UTS= JUL 29 '97 13:07:21.80 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    64    100  DBD$HMI
    2  RoData even  UTS    110    156  DBD$HMI
    3   Proc  even  none   536   1030  DBD$HMI
    4  RoData even  none    45     55  DBD$HMI

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  DBD$HMI
     3      4                  yes      Std        1  DBD$HMI_CHECK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DBM$GETBOBCAT
         yes           Std       2 DBM$PACK2
         yes           Std       2 DBM$PACK4
 yes     yes           Std      10 DBM$GETMEM
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std       3 DAA$VALUE
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:10   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  DAF$WRITE                             BLANK_LINE
     DB_BOBCAT$                            DB_HANDQ$                             DA_MAPERR
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:11   


        1        1        /*M* DBD$HMI - Formats HMI context and the FEP Circular Queues */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ECU=0,ENU=0   */
        8        8
        9        9        /*F*    NAME: DBD$HMI
       10       10                PURPOSE: To process the HMI command for FEPs.
       11       11
       12       12        */
       13       13        DBD$HMI: PROC(TOP);

     13  3 000000   000000 700200 xent  DBD$HMI      TSX0  ! X66_AUTO_1
         3 000001   000302 000001                    ZERO    194,1

       14       14
       15       15        %INCLUDE CP_6;
       16     5574        %INCLUDE GH_SCHD_M;
       17     5718        %INCLUDE G$BOBCAT_M;
       18     5738        %INCLUDE DA_FORMAT_C;
       19     5980        %INCLUDE XU_MACRO_C;
       20     9086        %INCLUDE KNH_MACRO_C;
       21     9369
       22     9370        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
       23     9415        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
       24     9460
       25     9461    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       26     9462    1   DCL DAF$WRITE EPTR SYMREF;
       27     9463    1   DCL DAF$INIT ENTRY(1) ALTRET;
       28     9464    1   DCL DBB$HEXDUMP ENTRY(4);
       29     9465    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
       30     9466    1   DCL DBM$GETBOBCAT ENTRY(1) ALTRET;
       31     9467    1   DCL DBM$PACK1 ENTRY(2);
       32     9468    1   DCL DBM$PACK2 ENTRY(2);
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:12   
       33     9469    1   DCL DBM$PACK4 ENTRY(2);
       34     9470
       35     9471        %REPORT (NAME=HMI_RPT1,TRUNC=YES,HEADER=YES,TITLE=
              9471            'FEP HMI - Host/Monitor Interface Table');
       36     9537
       37     9538        %HEADER (LAST=NO,TEXT=
       38     9539        'HMI$   USR PP#   PPSZ  WAIT_$ W#  SFLGS RCQ_LOCK       SCQ_LOCK       LDCT#');
       39     9581        %HEADER (TEXT=
       40     9582        '------ --- ----- ----- ------ --- ----- -------------- -------------- -----');
       41     9624
       42     9625    1   DCL HMI_FMT1 CHAR(0) CONSTANT INIT(
       43     9626    1  '.%5ZH .%2ZH .%@4.32ZH .%@4.16ZH .%@5.32ZH %@3.16D .%@4.16ZH .%@8.32ZH %@4.16ZH .%@8
              9626        .32ZH %@4.16ZH %@5.16D');
       44     9627
       45     9628    1   DCL 1 HMI_RPT20 CHAR(0) CONSTANT INIT(
       46     9629    1   '       Receive CQ                    Send CQ                       Context area');
       47     9630    1   DCL 1 HMI_RPT21 CHAR(0) CONSTANT INIT(
       48     9631    1   'HMI$   Insert$ Remove$ WdSz  Offset  Insert$ Remove$ WdSz  Offset  WdSz  Offset');
       49     9632    1   DCL 1 HMI_RPT22 CHAR(0) CONSTANT INIT(
       50     9633    1   '------ ------- ------- ----- ------  ------- ------- ----- ------  ----- ------');
       51     9634    1   DCL HMI_FMT2 CHAR(0) CONSTANT INIT(
       52     9635    1   '.%5ZH .%5ZH  .%5ZH  .%4ZH .%@4.16ZH   .%5ZH  .%5ZH  .%4ZH .%@4.16ZH  .%@4.16ZH .%@
              9635        4.16ZH');
       53     9636
       54     9637
       55     9638    1   DCL BLANK_LINE CHAR(4) SYMREF;
       56     9639    1   DCL DB_BOBCAT$ UBIN SYMREF;
       57     9640    1   DCL DB_HANDQ$ UBIN SYMREF;
       58     9641    1   DCL DA_MAPERR BIT(36) SYMREF;
       59     9642
       60     9643    1   DCL B$BIT18 CHAR(2) BASED CALIGNED;
       61     9644
       62     9645    1   DCL PASS UBIN;
       63     9646    1   DCL ACTION UBIN;                        /*0-display all  1-display if in use*/
       64     9647    1   DCL ENTRY_TYPE UBIN;                    /*0-display  1-check in use and counts*/
       65     9648
       66     9649    1   DCL HMI# UBIN;
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:13   
       67     9650    1   DCL HMI$ UBIN;
       68     9651    1   DCL USER# UBIN;
       69     9652    1   DCL SIZEW_HMI UBIN;
       70     9653    1   DCL THIS_HMI$ UBIN;
       71     9654    1   DCL TX UBIN;
       72     9655    1   DCL I UBIN;
       73     9656    1   DCL SIZEW_USRT UBIN;
       74     9657    1   DCL USER$ UBIN;
       75     9658    1   DCL MUIS UBIN;
       76     9659    1   DCL THIS_USER$ UBIN;
       77     9660
       78     9661    1   DCL RCQ_I$ UBIN;
       79     9662    1   DCL RCQ_R$ UBIN;
       80     9663    1   DCL RCQ_WDSZ UBIN;
       81     9664    1   DCL RCQ_OFFSET UBIN;
       82     9665    1   DCL SCQ_I$ UBIN;
       83     9666    1   DCL SCQ_R$ UBIN;
       84     9667    1   DCL SCQ_WDSZ UBIN;
       85     9668    1   DCL SCQ_OFFSET UBIN;
       86     9669    1   DCL CTX_WDSZ UBIN;
       87     9670
       88     9671        %G$BOBCAT (FPTN=G$BOBCAT,STCLASS=AUTO);
       89     9684        %KNH$HMI (FPTN=KNH$HMI,STCLASS=AUTO);
       90     9691        %G$USER (FPTN=G$USER,STCLASS=AUTO);
       91     9702
       92     9703
       93     9704        %EJECT;
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:14   
       94     9705    1      ENTRY_TYPE=0/*display*/;

   9705  3 000002   200006 450100                    STZ     ENTRY_TYPE,,AUTO

       95     9706    1      GOTO HMI_START;

   9706  3 000003   000011 710000 3                  TRA     HMI_START

       96     9707
       97     9708    1   DBD$HMI_CHECK: ENTRY(TOP);

   9708  3 000004   000000 700200 xent  DBD$HMI_CHE* TSX0  ! X66_AUTO_1
         3 000005   000302 000001                    ZERO    194,1

       98     9709    1      ENTRY_TYPE=1/*check*/;

   9709  3 000006   000001 235007                    LDA     1,DL
         3 000007   200006 755100                    STA     ENTRY_TYPE,,AUTO

       99     9710    1      RETURN;

   9710  3 000010   000000 702200 xent               TSX2  ! X66_ARET

   9709  3 000011                       HMI_START    null
      100     9711
      101     9712    1   HMI_START: ;
      102     9713    1      CALL DBM$GETBOBCAT(G$BOBCAT);

   9713  3 000011   200033 630500                    EPPR0   G$BOBCAT,,AUTO
         3 000012   200154 450500                    STP0    G$USER+15,,AUTO
         3 000013   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000014   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000015   000000 701000 xent               TSX1    DBM$GETBOBCAT
         3 000016   000000 011000                    NOP     0

      103     9714    1      CALL DBM$PACK2(G$BOBCAT.HMI#,HMI#);

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:15   
   9714  3 000017   200007 630500                    EPPR0   HMI#,,AUTO
         3 000020   200155 450500                    STP0    G$USER+16,,AUTO
         3 000021   200156 452500                    STP2    G$USER+17,,AUTO
         3 000022   200156 236100                    LDQ     G$USER+17,,AUTO
         3 000023   000000 036000 4                  ADLQ    0
         3 000024   200154 756100                    STQ     G$USER+15,,AUTO
         3 000025   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000026   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000027   000000 701000 xent               TSX1    DBM$PACK2
         3 000030   000000 011000                    NOP     0

      104     9715    1      CALL DBM$PACK4(G$BOBCAT.HMI$,HMI$);

   9715  3 000031   200010 630500                    EPPR0   HMI$,,AUTO
         3 000032   200155 450500                    STP0    G$USER+16,,AUTO
         3 000033   200057 631500                    EPPR1   G$BOBCAT+20,,AUTO
         3 000034   200154 451500                    STP1    G$USER+15,,AUTO
         3 000035   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000036   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000037   000000 701000 xent               TSX1    DBM$PACK4
         3 000040   000000 011000                    NOP     0

      105     9716    1      SIZEW_HMI = (SIZEC(KNH$HMI)+1) / 2;

   9716  3 000041   000031 235007                    LDA     25,DL
         3 000042   200012 755100                    STA     SIZEW_HMI,,AUTO

      106     9717
      107     9718    1      CALL DBM$PACK2(G$BOBCAT.MUIS,MUIS);

   9718  3 000043   200020 630500                    EPPR0   MUIS,,AUTO
         3 000044   200155 450500                    STP0    G$USER+16,,AUTO
         3 000045   200040 631500                    EPPR1   G$BOBCAT+5,,AUTO
         3 000046   200154 451500                    STP1    G$USER+15,,AUTO
         3 000047   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000050   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000051   000000 701000 xent               TSX1    DBM$PACK2
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:16   
         3 000052   000000 011000                    NOP     0

      108     9719    1      CALL DBM$PACK4(G$BOBCAT.USRT$,USER$);

   9719  3 000053   200017 630500                    EPPR0   USER$,,AUTO
         3 000054   200155 450500                    STP0    G$USER+16,,AUTO
         3 000055   200047 631500                    EPPR1   G$BOBCAT+12,,AUTO
         3 000056   200154 451500                    STP1    G$USER+15,,AUTO
         3 000057   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000060   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000061   000000 701000 xent               TSX1    DBM$PACK4
         3 000062   000000 011000                    NOP     0

      109     9720    1      SIZEW_USRT = (SIZEC(G$USER)+1) /2;

   9720  3 000063   000030 235007                    LDA     24,DL
         3 000064   200016 755100                    STA     SIZEW_USRT,,AUTO

      110     9721
      111     9722    1      ACTION=1/*display if in use*/;

   9722  3 000065   000001 236007                    LDQ     1,DL
         3 000066   200005 756100                    STQ     ACTION,,AUTO

      112     9723
      113     9724    2      DO PASS=0 TO 1;

   9724  3 000067   200004 450100                    STZ     PASS,,AUTO

      114     9725    2           IF PASS=0

   9725  3 000070   200004 235100                    LDA     PASS,,AUTO
         3 000071   000077 601000 3                  TNZ     s:9728

      115     9726    2           THEN CALL DAF$INIT(HMI_RPT1);

   9726  3 000072   000001 630400 4                  EPPR0   1
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:17   
         3 000073   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000074   000000 701000 xent               TSX1    DAF$INIT
         3 000075   000000 011000                    NOP     0
         3 000076   000123 710000 3                  TRA     s:9734

      116     9727    3           ELSE DO;

      117     9728    3                CALL DAF$WRITE(VECTOR(BLANK_LINE));

   9728  3 000077   000004 630400 4                  EPPR0   4
         3 000100   000000 220000 xsym               LDX0    DAF$WRITE
         3 000101   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000102   000000 701010                    TSX1    0,X0
         3 000103   000000 011000                    NOP     0

      118     9729    3                CALL DAF$WRITE(VECTOR(HMI_RPT20));

   9729  3 000104   000010 630400 4                  EPPR0   8
         3 000105   000000 220000 xsym               LDX0    DAF$WRITE
         3 000106   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000107   000000 701010                    TSX1    0,X0
         3 000110   000000 011000                    NOP     0

      119     9730    3                CALL DAF$WRITE(VECTOR(HMI_RPT21));

   9730  3 000111   000014 630400 4                  EPPR0   12
         3 000112   000000 220000 xsym               LDX0    DAF$WRITE
         3 000113   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000114   000000 701010                    TSX1    0,X0
         3 000115   000000 011000                    NOP     0

      120     9731    3                CALL DAF$WRITE(VECTOR(HMI_RPT22));

   9731  3 000116   000020 630400 4                  EPPR0   16
         3 000117   000000 220000 xsym               LDX0    DAF$WRITE
         3 000120   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000121   000000 701010                    TSX1    0,X0
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:18   
         3 000122   000000 011000                    NOP     0

      121     9732    3                END;

      122     9733
      123     9734    2           IF TOP.NSUBLKS=0

   9734  3 000123   200003 470500                    LDP0    @TOP,,AUTO
         3 000124   000001 220100                    LDX0    1,,PR0
         3 000125   000142 601000 3                  TNZ     s:9746

      124     9735    3           THEN DO;

   9731  3 000126                       DISPLAY_LOOP null
      125     9736
      126     9737    3   DISPLAY_LOOP: ;
      127     9738    4                DO I=0 TO HMI#-1;

   9738  3 000126   200015 450100                    STZ     I,,AUTO
         3 000127   000135 710000 3                  TRA     s:9740+3

      128     9739    4                     CALL DISP_HMI;

   9739  3 000130   000246 701000 3                  TSX1    DISP_HMI
         3 000131   000000 011000                    NOP     0

      129     9740    4                     END;

   9740  3 000132   200015 235100                    LDA     I,,AUTO
         3 000133   000001 035007                    ADLA    1,DL
         3 000134   200015 755100                    STA     I,,AUTO
         3 000135   200015 236100                    LDQ     I,,AUTO
         3 000136   200007 116100                    CMPQ    HMI#,,AUTO
         3 000137   000130 602000 3                  TNC     s:9739

      130     9741    3                DA_MAPERR = '0'B;

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:19   
   9741  3 000140   000000 450000 xsym               STZ     DA_MAPERR

      131     9742    3                END;

   9742  3 000141   000233 710000 3                  TRA     s:9769

      132     9743
      133     9744
      134     9745    3           ELSE DO;

      135     9746    4                DO TX=0 TO TOP.NSUBLKS-1;

   9746  3 000142   200014 450100                    STZ     TX,,AUTO
         3 000143   000225 710000 3                  TRA     s:9767+3

      136     9747    4                     CALL DAA$VALUE(TOP.SUBLK$(TX)->OUT,I)

   9747  3 000144   200003 470500                    LDP0    @TOP,,AUTO
         3 000145   200014 720100                    LXL0    TX,,AUTO
         3 000146   000003 471510                    LDP1    3,X0,PR0
         3 000147   200015 633500                    EPPR3   I,,AUTO
         3 000150   200155 453500                    STP3    G$USER+16,,AUTO
         3 000151   200154 451500                    STP1    G$USER+15,,AUTO
         3 000152   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000153   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000154   000000 701000 xent               TSX1    DAA$VALUE
         3 000155   000222 702000 3                  TSX2    s:9767

      137     9748    5                     WHENRETURN DO;

      138     9749    5                          IF I = 0

   9749  3 000156   200015 235100                    LDA     I,,AUTO
         3 000157   000162 601000 3                  TNZ     s:9755

      139     9750    6                          THEN DO;

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:20   
      140     9751    6                               ACTION=0/*display all*/;

   9751  3 000160   200005 450100                    STZ     ACTION,,AUTO

      141     9752    6                               GOTO DISPLAY_LOOP;

   9752  3 000161   000126 710000 3                  TRA     DISPLAY_LOOP

      142     9753    6                               END;
      143     9754
      144     9755    5                          IF I <= MUIS

   9755  3 000162   200020 236100                    LDQ     MUIS,,AUTO
         3 000163   200015 116100                    CMPQ    I,,AUTO
         3 000164   000222 602000 3                  TNC     s:9767

      145     9756    6                          THEN DO;

      146     9757    6                               THIS_USER$ = USER$ + (SIZEW_USRT * I);

   9757  3 000165   200016 236100                    LDQ     SIZEW_USRT,,AUTO
         3 000166   200015 402100                    MPY     I,,AUTO
         3 000167   200017 036100                    ADLQ    USER$,,AUTO
         3 000170   200021 756100                    STQ     THIS_USER$,,AUTO

      147     9758    6                              CALL DBM$GETMEM(THIS_USER$,G$USER,0,SIZEC(G$USER),,SIZEC
              9758                                        (G$USER));

   9758  3 000171   000022 236000 4                  LDQ     18
         3 000172   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000173   200160 757100                    STAQ    G$USER+19,,AUTO
         3 000174   000024 237000 4                  LDAQ    20
         3 000175   200156 757100                    STAQ    G$USER+17,,AUTO
         3 000176   200135 630500                    EPPR0   G$USER,,AUTO
         3 000177   200155 450500                    STP0    G$USER+16,,AUTO
         3 000200   200021 631500                    EPPR1   THIS_USER$,,AUTO
         3 000201   200154 451500                    STP1    G$USER+15,,AUTO
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:21   
         3 000202   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000203   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000204   000000 701000 xent               TSX1    DBM$GETMEM
         3 000205   000000 011000                    NOP     0

      148     9759    6                               CALL DBM$PACK4(G$USER.HMI$,I);

   9759  3 000206   200015 630500                    EPPR0   I,,AUTO
         3 000207   200155 450500                    STP0    G$USER+16,,AUTO
         3 000210   200147 631500                    EPPR1   G$USER+10,,AUTO
         3 000211   200154 451500                    STP1    G$USER+15,,AUTO
         3 000212   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000213   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000214   000000 701000 xent               TSX1    DBM$PACK4
         3 000215   000000 011000                    NOP     0

      149     9760
      150     9761    6                               IF I ~= 0

   9761  3 000216   200015 235100                    LDA     I,,AUTO
         3 000217   000222 600000 3                  TZE     s:9767

      151     9762    6                               THEN CALL DISP_HMI;

   9762  3 000220   000246 701000 3                  TSX1    DISP_HMI
         3 000221   000000 011000                    NOP     0

      152     9763    6                               END/*do if i<= user#*/;

      153     9764
      154     9765    5                          END/*whenreturn do*/;

      155     9766
      156     9767    4                     END/*do TX=0 to TOP*/;

   9767  3 000222   200014 235100                    LDA     TX,,AUTO
         3 000223   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:22   
         3 000224   200014 755100                    STA     TX,,AUTO
         3 000225   200003 470500                    LDP0    @TOP,,AUTO
         3 000226   000001 236100                    LDQ     1,,PR0
         3 000227   000022 772000                    QRL     18
         3 000230   200014 116100                    CMPQ    TX,,AUTO
         3 000231   000233 600000 3                  TZE     s:9769
         3 000232   000144 603000 3                  TRC     s:9747

      157     9768    3                END/*else do*/;

      158     9769    2           END/*do pass=0 to 1*/;

   9769  3 000233   200004 235100                    LDA     PASS,,AUTO
         3 000234   000001 035007                    ADLA    1,DL
         3 000235   200004 755100                    STA     PASS,,AUTO
         3 000236   000002 115007                    CMPA    2,DL
         3 000237   000070 602000 3                  TNC     s:9725

      159     9770
      160     9771    1      CALL DAF$WRITE(VECTOR(BLANK_LINE));

   9771  3 000240   000004 630400 4                  EPPR0   4
         3 000241   000000 220000 xsym               LDX0    DAF$WRITE
         3 000242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000243   000000 701010                    TSX1    0,X0
         3 000244   000000 011000                    NOP     0

      161     9772    1      RETURN;

   9772  3 000245   000000 702200 xent               TSX2  ! X66_ARET

      162     9773
      163     9774
      164     9775    1   DISP_HMI: PROC;

   9775  3 000246   200152 741300       DISP_HMI     STX1  ! G$USER+13,,AUTO

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:23   
      165     9776    2      IF I < DB_BOBCAT$

   9776  3 000247   200015 236100                    LDQ     I,,AUTO
         3 000250   000000 116000 xsym               CMPQ    DB_BOBCAT$
         3 000251   000256 603000 3                  TRC     s:9779

      166     9777    2      THEN THIS_HMI$ = HMI$ + (SIZEW_HMI * I);

   9777  3 000252   200012 402100                    MPY     SIZEW_HMI,,AUTO
         3 000253   200010 036100                    ADLQ    HMI$,,AUTO
         3 000254   200013 756100                    STQ     THIS_HMI$,,AUTO
         3 000255   000260 710000 3                  TRA     s:9783

      167     9778    3      ELSE DO;

      168     9779    3           THIS_HMI$ = I;

   9779  3 000256   200013 756100                    STQ     THIS_HMI$,,AUTO

      169     9780    3           I = 0;

   9780  3 000257   200015 450100                    STZ     I,,AUTO

      170     9781    3           END;

      171     9782
      172     9783    2      CALL DBM$GETMEM(THIS_HMI$,KNH$HMI,0,SIZEC(KNH$HMI),,SIZEC(KNH$HMI));

   9783  3 000260   000027 236000 4                  LDQ     23
         3 000261   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000262   200160 757100                    STAQ    G$USER+19,,AUTO
         3 000263   000030 237000 4                  LDAQ    24
         3 000264   200156 757100                    STAQ    G$USER+17,,AUTO
         3 000265   200120 630500                    EPPR0   KNH$HMI,,AUTO
         3 000266   200155 450500                    STP0    G$USER+16,,AUTO
         3 000267   200013 631500                    EPPR1   THIS_HMI$,,AUTO
         3 000270   200154 451500                    STP1    G$USER+15,,AUTO
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:24   
         3 000271   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000272   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000273   000000 701000 xent               TSX1    DBM$GETMEM
         3 000274   000000 011000                    NOP     0

      173     9784    2      CALL DBM$PACK2(KNH$HMI.USER#,USER#);

   9784  3 000275   200011 630500                    EPPR0   USER#,,AUTO
         3 000276   200155 450500                    STP0    G$USER+16,,AUTO
         3 000277   200132 631500                    EPPR1   KNH$HMI+10,,AUTO
         3 000300   200154 451500                    STP1    G$USER+15,,AUTO
         3 000301   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000302   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000303   000000 701000 xent               TSX1    DBM$PACK2
         3 000304   000000 011000                    NOP     0

      174     9785    2      IF (ACTION=1) AND (USER#=0) THEN RETURN;

   9785  3 000305   200005 235100                    LDA     ACTION,,AUTO
         3 000306   000001 115007                    CMPA    1,DL
         3 000307   000314 601000 3                  TNZ     s:9787
         3 000310   200011 236100                    LDQ     USER#,,AUTO
         3 000311   000314 601000 3                  TNZ     s:9787

   9785  3 000312   200152 221300                    LDX1  ! G$USER+13,,AUTO
         3 000313   000001 702211                    TSX2  ! 1,X1

      175     9786
      176     9787    2      IF PASS=0

   9787  3 000314   200004 236100                    LDQ     PASS,,AUTO
         3 000315   000502 601000 3                  TNZ     s:9805

      177     9788    3      THEN DO;

      178     9789    3           CALL DAF$WRITE(VECTOR(HMI_FMT1),
      179     9790    3             VECTOR(THIS_HMI$),
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:25   
      180     9791    3             VECTOR(USER#),
      181     9792    3             VECTOR(KNH$HMI.PP#),
      182     9793    3             VECTOR(KNH$HMI.PPSZ),
      183     9794    3             VECTOR(KNH$HMI.WAIT_HEAD$),
      184     9795    3             VECTOR(KNH$HMI.WAIT_COUNT),
      185     9796    3             VECTOR(ADDR(KNH$HMI.SCQ.BUSY)->B$BIT18),
      186     9797    3             VECTOR(KNH$HMI.RCQ.LOCK.WHO),
      187     9798    3             VECTOR(KNH$HMI.RCQ.LOCK.SREG),
      188     9799    3             VECTOR(KNH$HMI.SCQ.LOCK.WHO),
      189     9800    3             VECTOR(KNH$HMI.SCQ.LOCK.SREG),

   9800  3 000316   777640 235007                    LDA     -96,DL
         3 000317   200154 452500                    STP2    G$USER+15,,AUTO
         3 000320   200154 236100                    LDQ     G$USER+15,,AUTO
         3 000321   000013 036003                    ADLQ    11,DU
         3 000322   200156 757100                    STAQ    G$USER+17,,AUTO
         3 000323   777640 235007                    LDA     -96,DL
         3 000324   200160 452500                    STP2    G$USER+19,,AUTO
         3 000325   200160 236100                    LDQ     G$USER+19,,AUTO
         3 000326   000011 036003                    ADLQ    9,DU
         3 000327   200162 757100                    STAQ    G$USER+21,,AUTO
         3 000330   777640 235007                    LDA     -96,DL
         3 000331   200164 452500                    STP2    G$USER+23,,AUTO
         3 000332   200164 236100                    LDQ     G$USER+23,,AUTO
         3 000333   000034 036000 4                  ADLQ    28
         3 000334   200166 757100                    STAQ    G$USER+25,,AUTO
         3 000335   377640 235007                    LDA     130976,DL
         3 000336   200170 452500                    STP2    G$USER+27,,AUTO
         3 000337   200170 236100                    LDQ     G$USER+27,,AUTO
         3 000340   000035 036000 4                  ADLQ    29
         3 000341   200172 757100                    STAQ    G$USER+29,,AUTO
         3 000342   777640 235007                    LDA     -96,DL
         3 000343   200174 452500                    STP2    G$USER+31,,AUTO
         3 000344   200174 236100                    LDQ     G$USER+31,,AUTO
         3 000345   000036 036000 4                  ADLQ    30
         3 000346   200176 757100                    STAQ    G$USER+33,,AUTO
         3 000347   377640 235007                    LDA     130976,DL
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:26   
         3 000350   200200 452500                    STP2    G$USER+35,,AUTO
         3 000351   200200 236100                    LDQ     G$USER+35,,AUTO
         3 000352   000037 036000 4                  ADLQ    31
         3 000353   200202 757100                    STAQ    G$USER+37,,AUTO
         3 000354   377640 235007                    LDA     130976,DL
         3 000355   200204 452500                    STP2    G$USER+39,,AUTO
         3 000356   200204 236100                    LDQ     G$USER+39,,AUTO
         3 000357   000127 036003                    ADLQ    87,DU
         3 000360   200206 757100                    STAQ    G$USER+41,,AUTO
         3 000361   777640 235007                    LDA     -96,DL
         3 000362   200210 452500                    STP2    G$USER+43,,AUTO
         3 000363   200210 236100                    LDQ     G$USER+43,,AUTO
         3 000364   000122 036003                    ADLQ    82,DU
         3 000365   200212 757100                    STAQ    G$USER+45,,AUTO
         3 000366   377640 235007                    LDA     130976,DL
         3 000367   200214 452500                    STP2    G$USER+47,,AUTO
         3 000370   200214 236100                    LDQ     G$USER+47,,AUTO
         3 000371   000123 036003                    ADLQ    83,DU
         3 000372   200216 757100                    STAQ    G$USER+49,,AUTO
         3 000373   777640 235007                    LDA     -96,DL
         3 000374   200220 452500                    STP2    G$USER+51,,AUTO
         3 000375   200220 236100                    LDQ     G$USER+51,,AUTO
         3 000376   000040 036000 4                  ADLQ    32
         3 000377   200222 757100                    STAQ    G$USER+53,,AUTO
         3 000400   377640 235007                    LDA     130976,DL
         3 000401   200224 452500                    STP2    G$USER+55,,AUTO
         3 000402   200224 236100                    LDQ     G$USER+55,,AUTO
         3 000403   000041 036000 4                  ADLQ    33
         3 000404   200226 757100                    STAQ    G$USER+57,,AUTO
         3 000405   377640 235007                    LDA     130976,DL
         3 000406   200230 452500                    STP2    G$USER+59,,AUTO
         3 000407   200230 236100                    LDQ     G$USER+59,,AUTO
         3 000410   000134 036003                    ADLQ    92,DU
         3 000411   200234 757100                    STAQ    G$USER+63,,AUTO
         3 000412   200156 237100                    LDAQ    G$USER+17,,AUTO
         3 000413   200232 757100                    STAQ    G$USER+61,,AUTO
         3 000414   200162 237100                    LDAQ    G$USER+21,,AUTO
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:27   
         3 000415   200236 757100                    STAQ    G$USER+65,,AUTO
         3 000416   200166 237100                    LDAQ    G$USER+25,,AUTO
         3 000417   200240 757100                    STAQ    G$USER+67,,AUTO
         3 000420   200172 237100                    LDAQ    G$USER+29,,AUTO
         3 000421   200242 757100                    STAQ    G$USER+69,,AUTO
         3 000422   200176 237100                    LDAQ    G$USER+33,,AUTO
         3 000423   200244 757100                    STAQ    G$USER+71,,AUTO
         3 000424   200202 237100                    LDAQ    G$USER+37,,AUTO
         3 000425   200246 757100                    STAQ    G$USER+73,,AUTO
         3 000426   200206 237100                    LDAQ    G$USER+41,,AUTO
         3 000427   200250 757100                    STAQ    G$USER+75,,AUTO
         3 000430   200212 237100                    LDAQ    G$USER+45,,AUTO
         3 000431   200252 757100                    STAQ    G$USER+77,,AUTO
         3 000432   200216 237100                    LDAQ    G$USER+49,,AUTO
         3 000433   200254 757100                    STAQ    G$USER+79,,AUTO
         3 000434   200222 237100                    LDAQ    G$USER+53,,AUTO
         3 000435   200256 757100                    STAQ    G$USER+81,,AUTO
         3 000436   200226 237100                    LDAQ    G$USER+57,,AUTO
         3 000437   200260 757100                    STAQ    G$USER+83,,AUTO
         3 000440   200234 237100                    LDAQ    G$USER+63,,AUTO
         3 000441   200262 757100                    STAQ    G$USER+85,,AUTO
         3 000442   200262 630500                    EPPR0   G$USER+85,,AUTO
         3 000443   200300 450500                    STP0    G$USER+99,,AUTO
         3 000444   200260 631500                    EPPR1   G$USER+83,,AUTO
         3 000445   200277 451500                    STP1    G$USER+98,,AUTO
         3 000446   200256 633500                    EPPR3   G$USER+81,,AUTO
         3 000447   200276 453500                    STP3    G$USER+97,,AUTO
         3 000450   200254 634500                    EPPR4   G$USER+79,,AUTO
         3 000451   200275 454500                    STP4    G$USER+96,,AUTO
         3 000452   200252 635500                    EPPR5   G$USER+77,,AUTO
         3 000453   200274 455500                    STP5    G$USER+95,,AUTO
         3 000454   200250 636500                    EPPR6   G$USER+75,,AUTO
         3 000455   200273 456500                    STP6    G$USER+94,,AUTO
         3 000456   200246 637500                    EPPR7   G$USER+73,,AUTO
         3 000457   200272 457500                    STP7    G$USER+93,,AUTO
         3 000460   200244 630500                    EPPR0   G$USER+71,,AUTO
         3 000461   200271 450500                    STP0    G$USER+92,,AUTO
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:28   
         3 000462   200242 630500                    EPPR0   G$USER+69,,AUTO
         3 000463   200270 450500                    STP0    G$USER+91,,AUTO
         3 000464   200240 630500                    EPPR0   G$USER+67,,AUTO
         3 000465   200267 450500                    STP0    G$USER+90,,AUTO
         3 000466   200236 630500                    EPPR0   G$USER+65,,AUTO
         3 000467   200266 450500                    STP0    G$USER+89,,AUTO
         3 000470   200232 630500                    EPPR0   G$USER+61,,AUTO
         3 000471   200265 450500                    STP0    G$USER+88,,AUTO
         3 000472   000043 236000 4                  LDQ     35
         3 000473   200264 756100                    STQ     G$USER+87,,AUTO
         3 000474   200264 630500                    EPPR0   G$USER+87,,AUTO
         3 000475   000000 220000 xsym               LDX0    DAF$WRITE
         3 000476   000042 631400 4                  EPPR1   34
         3 000477   000000 701010                    TSX1    0,X0
         3 000500   000000 011000                    NOP     0

      190     9801    3             VECTOR(KNH$HMI.LDCTS#));
      191     9802    3           END/*pass 0*/;

   9802  3 000501   001026 710000 3                  TRA     s:9837

      192     9803
      193     9804    3      ELSE DO;

      194     9805    3           CALL DBM$PACK2(KNH$HMI.RCQ.IPTR,RCQ_I$);

   9805  3 000502   200022 630500                    EPPR0   RCQ_I$,,AUTO
         3 000503   200155 450500                    STP0    G$USER+16,,AUTO
         3 000504   200120 631500                    EPPR1   KNH$HMI,,AUTO
         3 000505   200154 451500                    STP1    G$USER+15,,AUTO
         3 000506   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000507   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000510   000000 701000 xent               TSX1    DBM$PACK2
         3 000511   000000 011000                    NOP     0

      195     9806    3           CALL DBM$PACK2(KNH$HMI.RCQ.RPTR,RCQ_R$);

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:29   
   9806  3 000512   200023 630500                    EPPR0   RCQ_R$,,AUTO
         3 000513   200155 450500                    STP0    G$USER+16,,AUTO
         3 000514   200156 452500                    STP2    G$USER+17,,AUTO
         3 000515   200156 236100                    LDQ     G$USER+17,,AUTO
         3 000516   000044 036000 4                  ADLQ    36
         3 000517   200154 756100                    STQ     G$USER+15,,AUTO
         3 000520   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000521   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000522   000000 701000 xent               TSX1    DBM$PACK2
         3 000523   000000 011000                    NOP     0

      196     9807    3           CALL DBM$PACK2(KNH$HMI.SCQ.IPTR,SCQ_I$);

   9807  3 000524   200026 630500                    EPPR0   SCQ_I$,,AUTO
         3 000525   200155 450500                    STP0    G$USER+16,,AUTO
         3 000526   200156 452500                    STP2    G$USER+17,,AUTO
         3 000527   200156 236100                    LDQ     G$USER+17,,AUTO
         3 000530   000045 036000 4                  ADLQ    37
         3 000531   200154 756100                    STQ     G$USER+15,,AUTO
         3 000532   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000533   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000534   000000 701000 xent               TSX1    DBM$PACK2
         3 000535   000000 011000                    NOP     0

      197     9808    3           CALL DBM$PACK2(KNH$HMI.SCQ.RPTR,SCQ_R$);

   9808  3 000536   200027 630500                    EPPR0   SCQ_R$,,AUTO
         3 000537   200155 450500                    STP0    G$USER+16,,AUTO
         3 000540   200124 631500                    EPPR1   KNH$HMI+4,,AUTO
         3 000541   200154 451500                    STP1    G$USER+15,,AUTO
         3 000542   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000543   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000544   000000 701000 xent               TSX1    DBM$PACK2
         3 000545   000000 011000                    NOP     0

      198     9809    3           CALL DBM$PACK2(KNH$HMI.RCQ.SZ,RCQ_WDSZ);

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:30   
   9809  3 000546   200024 630500                    EPPR0   RCQ_WDSZ,,AUTO
         3 000547   200155 450500                    STP0    G$USER+16,,AUTO
         3 000550   200121 631500                    EPPR1   KNH$HMI+1,,AUTO
         3 000551   200154 451500                    STP1    G$USER+15,,AUTO
         3 000552   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000553   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000554   000000 701000 xent               TSX1    DBM$PACK2
         3 000555   000000 011000                    NOP     0

      199     9810    3           CALL DBM$PACK2(KNH$HMI.SCQ.SZ,SCQ_WDSZ);

   9810  3 000556   200030 630500                    EPPR0   SCQ_WDSZ,,AUTO
         3 000557   200155 450500                    STP0    G$USER+16,,AUTO
         3 000560   200156 452500                    STP2    G$USER+17,,AUTO
         3 000561   200156 236100                    LDQ     G$USER+17,,AUTO
         3 000562   000046 036000 4                  ADLQ    38
         3 000563   200154 756100                    STQ     G$USER+15,,AUTO
         3 000564   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000565   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000566   000000 701000 xent               TSX1    DBM$PACK2
         3 000567   000000 011000                    NOP     0

      200     9811    3           CALL DBM$PACK2(KNH$HMI.CTX.SZ,CTX_WDSZ);

   9811  3 000570   200032 630500                    EPPR0   CTX_WDSZ,,AUTO
         3 000571   200155 450500                    STP0    G$USER+16,,AUTO
         3 000572   200130 631500                    EPPR1   KNH$HMI+8,,AUTO
         3 000573   200154 451500                    STP1    G$USER+15,,AUTO
         3 000574   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000575   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000576   000000 701000 xent               TSX1    DBM$PACK2
         3 000577   000000 011000                    NOP     0

      201     9812    3           CALL DBM$PACK2(KNH$HMI.RCQ.OFFSET,RCQ_OFFSET);

   9812  3 000600   200025 630500                    EPPR0   RCQ_OFFSET,,AUTO
         3 000601   200155 450500                    STP0    G$USER+16,,AUTO
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:31   
         3 000602   200156 452500                    STP2    G$USER+17,,AUTO
         3 000603   200156 236100                    LDQ     G$USER+17,,AUTO
         3 000604   000047 036000 4                  ADLQ    39
         3 000605   200154 756100                    STQ     G$USER+15,,AUTO
         3 000606   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000607   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000610   000000 701000 xent               TSX1    DBM$PACK2
         3 000611   000000 011000                    NOP     0

      202     9813    3           CALL DBM$PACK2(KNH$HMI.SCQ.OFFSET,SCQ_OFFSET);

   9813  3 000612   200031 630500                    EPPR0   SCQ_OFFSET,,AUTO
         3 000613   200155 450500                    STP0    G$USER+16,,AUTO
         3 000614   200125 631500                    EPPR1   KNH$HMI+5,,AUTO
         3 000615   200154 451500                    STP1    G$USER+15,,AUTO
         3 000616   200154 630500                    EPPR0   G$USER+15,,AUTO
         3 000617   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000620   000000 701000 xent               TSX1    DBM$PACK2
         3 000621   000000 011000                    NOP     0

      203     9814
      204     9815    3           RCQ_I$ = (RCQ_I$ *2) + RCQ_OFFSET + DB_HANDQ$;

   9815  3 000622   200022 236100                    LDQ     RCQ_I$,,AUTO
         3 000623   000001 736000                    QLS     1
         3 000624   200025 036100                    ADLQ    RCQ_OFFSET,,AUTO
         3 000625   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000626   200022 756100                    STQ     RCQ_I$,,AUTO

      205     9816    3           RCQ_R$ = (RCQ_R$ *2) + RCQ_OFFSET + DB_HANDQ$;

   9816  3 000627   200023 236100                    LDQ     RCQ_R$,,AUTO
         3 000630   000001 736000                    QLS     1
         3 000631   200025 036100                    ADLQ    RCQ_OFFSET,,AUTO
         3 000632   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000633   200023 756100                    STQ     RCQ_R$,,AUTO

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:32   
      206     9817    3           RCQ_WDSZ = (RCQ_WDSZ *2);

   9817  3 000634   200024 235100                    LDA     RCQ_WDSZ,,AUTO
         3 000635   000001 735000                    ALS     1
         3 000636   200024 755100                    STA     RCQ_WDSZ,,AUTO

      207     9818    3           SCQ_I$ = (SCQ_I$ *2) + SCQ_OFFSET + DB_HANDQ$;

   9818  3 000637   200026 236100                    LDQ     SCQ_I$,,AUTO
         3 000640   000001 736000                    QLS     1
         3 000641   200031 036100                    ADLQ    SCQ_OFFSET,,AUTO
         3 000642   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000643   200026 756100                    STQ     SCQ_I$,,AUTO

      208     9819    3           SCQ_R$ = (SCQ_R$ *2) + SCQ_OFFSET + DB_HANDQ$;

   9819  3 000644   200027 236100                    LDQ     SCQ_R$,,AUTO
         3 000645   000001 736000                    QLS     1
         3 000646   200031 036100                    ADLQ    SCQ_OFFSET,,AUTO
         3 000647   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000650   200027 756100                    STQ     SCQ_R$,,AUTO

      209     9820    3           SCQ_WDSZ = (SCQ_WDSZ *2);

   9820  3 000651   200030 235100                    LDA     SCQ_WDSZ,,AUTO
         3 000652   000001 735000                    ALS     1
         3 000653   200030 755100                    STA     SCQ_WDSZ,,AUTO

      210     9821
      211     9822    3           CALL DAF$WRITE(VECTOR(HMI_FMT2),
      212     9823    3             VECTOR(THIS_HMI$),
      213     9824    3             VECTOR(RCQ_I$),
      214     9825    3             VECTOR(RCQ_R$),
      215     9826    3             VECTOR(RCQ_WDSZ),
      216     9827    3             VECTOR(KNH$HMI.RCQ.OFFSET),
      217     9828    3             VECTOR(SCQ_I$),
      218     9829    3             VECTOR(SCQ_R$),
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:33   
      219     9830    3             VECTOR(SCQ_WDSZ),
      220     9831    3             VECTOR(KNH$HMI.SCQ.OFFSET),

   9831  3 000654   777640 235007                    LDA     -96,DL
         3 000655   200154 452500                    STP2    G$USER+15,,AUTO
         3 000656   200154 236100                    LDQ     G$USER+15,,AUTO
         3 000657   000013 036003                    ADLQ    11,DU
         3 000660   200156 757100                    STAQ    G$USER+17,,AUTO
         3 000661   777640 235007                    LDA     -96,DL
         3 000662   200160 452500                    STP2    G$USER+19,,AUTO
         3 000663   200160 236100                    LDQ     G$USER+19,,AUTO
         3 000664   000022 036003                    ADLQ    18,DU
         3 000665   200162 757100                    STAQ    G$USER+21,,AUTO
         3 000666   777640 235007                    LDA     -96,DL
         3 000667   200164 452500                    STP2    G$USER+23,,AUTO
         3 000670   200164 236100                    LDQ     G$USER+23,,AUTO
         3 000671   000023 036003                    ADLQ    19,DU
         3 000672   200166 757100                    STAQ    G$USER+25,,AUTO
         3 000673   777640 235007                    LDA     -96,DL
         3 000674   200170 452500                    STP2    G$USER+27,,AUTO
         3 000675   200170 236100                    LDQ     G$USER+27,,AUTO
         3 000676   000024 036003                    ADLQ    20,DU
         3 000677   200172 757100                    STAQ    G$USER+29,,AUTO
         3 000700   377640 235007                    LDA     130976,DL
         3 000701   200174 452500                    STP2    G$USER+31,,AUTO
         3 000702   200174 236100                    LDQ     G$USER+31,,AUTO
         3 000703   000047 036000 4                  ADLQ    39
         3 000704   200176 757100                    STAQ    G$USER+33,,AUTO
         3 000705   777640 235007                    LDA     -96,DL
         3 000706   200200 452500                    STP2    G$USER+35,,AUTO
         3 000707   200200 236100                    LDQ     G$USER+35,,AUTO
         3 000710   000026 036003                    ADLQ    22,DU
         3 000711   200202 757100                    STAQ    G$USER+37,,AUTO
         3 000712   777640 235007                    LDA     -96,DL
         3 000713   200204 452500                    STP2    G$USER+39,,AUTO
         3 000714   200204 236100                    LDQ     G$USER+39,,AUTO
         3 000715   000027 036003                    ADLQ    23,DU
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:34   
         3 000716   200206 757100                    STAQ    G$USER+41,,AUTO
         3 000717   777640 235007                    LDA     -96,DL
         3 000720   200210 452500                    STP2    G$USER+43,,AUTO
         3 000721   200210 236100                    LDQ     G$USER+43,,AUTO
         3 000722   000030 036003                    ADLQ    24,DU
         3 000723   200212 757100                    STAQ    G$USER+45,,AUTO
         3 000724   377640 235007                    LDA     130976,DL
         3 000725   200214 452500                    STP2    G$USER+47,,AUTO
         3 000726   200214 236100                    LDQ     G$USER+47,,AUTO
         3 000727   000125 036003                    ADLQ    85,DU
         3 000730   200216 757100                    STAQ    G$USER+49,,AUTO
         3 000731   377640 235007                    LDA     130976,DL
         3 000732   200220 452500                    STP2    G$USER+51,,AUTO
         3 000733   200220 236100                    LDQ     G$USER+51,,AUTO
         3 000734   000130 036003                    ADLQ    88,DU
         3 000735   200222 757100                    STAQ    G$USER+53,,AUTO
         3 000736   377640 235007                    LDA     130976,DL
         3 000737   200224 452500                    STP2    G$USER+55,,AUTO
         3 000740   200224 236100                    LDQ     G$USER+55,,AUTO
         3 000741   000052 036000 4                  ADLQ    42
         3 000742   200230 757100                    STAQ    G$USER+59,,AUTO
         3 000743   200156 237100                    LDAQ    G$USER+17,,AUTO
         3 000744   200226 757100                    STAQ    G$USER+57,,AUTO
         3 000745   200162 237100                    LDAQ    G$USER+21,,AUTO
         3 000746   200232 757100                    STAQ    G$USER+61,,AUTO
         3 000747   200166 237100                    LDAQ    G$USER+25,,AUTO
         3 000750   200234 757100                    STAQ    G$USER+63,,AUTO
         3 000751   200172 237100                    LDAQ    G$USER+29,,AUTO
         3 000752   200236 757100                    STAQ    G$USER+65,,AUTO
         3 000753   200176 237100                    LDAQ    G$USER+33,,AUTO
         3 000754   200240 757100                    STAQ    G$USER+67,,AUTO
         3 000755   200202 237100                    LDAQ    G$USER+37,,AUTO
         3 000756   200242 757100                    STAQ    G$USER+69,,AUTO
         3 000757   200206 237100                    LDAQ    G$USER+41,,AUTO
         3 000760   200244 757100                    STAQ    G$USER+71,,AUTO
         3 000761   200212 237100                    LDAQ    G$USER+45,,AUTO
         3 000762   200246 757100                    STAQ    G$USER+73,,AUTO
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:35   
         3 000763   200216 237100                    LDAQ    G$USER+49,,AUTO
         3 000764   200250 757100                    STAQ    G$USER+75,,AUTO
         3 000765   200222 237100                    LDAQ    G$USER+53,,AUTO
         3 000766   200252 757100                    STAQ    G$USER+77,,AUTO
         3 000767   200230 237100                    LDAQ    G$USER+59,,AUTO
         3 000770   200254 757100                    STAQ    G$USER+79,,AUTO
         3 000771   200254 630500                    EPPR0   G$USER+79,,AUTO
         3 000772   200271 450500                    STP0    G$USER+92,,AUTO
         3 000773   200252 631500                    EPPR1   G$USER+77,,AUTO
         3 000774   200270 451500                    STP1    G$USER+91,,AUTO
         3 000775   200250 633500                    EPPR3   G$USER+75,,AUTO
         3 000776   200267 453500                    STP3    G$USER+90,,AUTO
         3 000777   200246 634500                    EPPR4   G$USER+73,,AUTO
         3 001000   200266 454500                    STP4    G$USER+89,,AUTO
         3 001001   200244 635500                    EPPR5   G$USER+71,,AUTO
         3 001002   200265 455500                    STP5    G$USER+88,,AUTO
         3 001003   200242 636500                    EPPR6   G$USER+69,,AUTO
         3 001004   200264 456500                    STP6    G$USER+87,,AUTO
         3 001005   200240 637500                    EPPR7   G$USER+67,,AUTO
         3 001006   200263 457500                    STP7    G$USER+86,,AUTO
         3 001007   200236 630500                    EPPR0   G$USER+65,,AUTO
         3 001010   200262 450500                    STP0    G$USER+85,,AUTO
         3 001011   200234 630500                    EPPR0   G$USER+63,,AUTO
         3 001012   200261 450500                    STP0    G$USER+84,,AUTO
         3 001013   200232 630500                    EPPR0   G$USER+61,,AUTO
         3 001014   200260 450500                    STP0    G$USER+83,,AUTO
         3 001015   200226 630500                    EPPR0   G$USER+57,,AUTO
         3 001016   200257 450500                    STP0    G$USER+82,,AUTO
         3 001017   000054 236000 4                  LDQ     44
         3 001020   200256 756100                    STQ     G$USER+81,,AUTO
         3 001021   200256 630500                    EPPR0   G$USER+81,,AUTO
         3 001022   000000 220000 xsym               LDX0    DAF$WRITE
         3 001023   000053 631400 4                  EPPR1   43
         3 001024   000000 701010                    TSX1    0,X0
         3 001025   000000 011000                    NOP     0

      221     9832    3             VECTOR(KNH$HMI.CTX.SZ),
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:36   
      222     9833    3             VECTOR(KNH$HMI.CTX.OFFSET));
      223     9834
      224     9835    3           END/*pass 1*/;

      225     9836
      226     9837    2      RETURN;

   9837  3 001026   200152 221300                    LDX1  ! G$USER+13,,AUTO
         3 001027   000001 702211                    TSX2  ! 1,X1
      227     9838    2   END DISP_HMI;
      228     9839    1   END DBD$HMI;
      229     9840        %EOD;

PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:37   
--  Include file information  --

   KNH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   GH_SCHD_M.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DBD$HMI.
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:38   

 **** Variables and constants ****

  ****  Section 001  Data  DBD$HMI

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)   r     1 HMI_RPT1                  22-0-0/w STRC(144)   r     1 HMI_RPT1HD00
    51-0-0/w STRC(144)   r     1 HMI_RPT1HD01              10-0-0/c STRC(351)   r     1 HMI_RPT1TX00
    26-0-0/c STRC(684)   r     1 HMI_RPT1TX01              55-0-0/c STRC(684)   r     1 HMI_RPT1TX02

  ****  Section 002 RoData DBD$HMI

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(105)   r     1 HMI_FMT1                 127-0-0/c CHAR(89)    r     1 HMI_FMT2
    33-0-0/c CHAR(79)    r     1 HMI_RPT20                 57-0-0/c CHAR(79)    r     1 HMI_RPT21
   103-0-0/c CHAR(79)    r     1 HMI_RPT22

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP                       5-0-0/w UBIN        r     1 ACTION
    32-0-0/w UBIN        r     1 CTX_WDSZ                   6-0-0/w UBIN        r     1 ENTRY_TYPE
    33-0-0/w STRC(1908)  r     1 G$BOBCAT                 135-0-0/w STRC(432)   r     1 G$USER
     7-0-0/w UBIN        r     1 HMI#                      10-0-0/w UBIN        r     1 HMI$
    15-0-0/w UBIN        r     1 I                        120-0-0/c STRC(450)   r     1 KNH$HMI
    20-0-0/w UBIN        r     1 MUIS                       4-0-0/w UBIN        r     1 PASS
    22-0-0/w UBIN        r     1 RCQ_I$                    25-0-0/w UBIN        r     1 RCQ_OFFSET
    23-0-0/w UBIN        r     1 RCQ_R$                    24-0-0/w UBIN        r     1 RCQ_WDSZ
    26-0-0/w UBIN        r     1 SCQ_I$                    31-0-0/w UBIN        r     1 SCQ_OFFSET
    27-0-0/w UBIN        r     1 SCQ_R$                    30-0-0/w UBIN        r     1 SCQ_WDSZ
    12-0-0/w UBIN        r     1 SIZEW_HMI                 16-0-0/w UBIN        r     1 SIZEW_USRT
    13-0-0/w UBIN        r     1 THIS_HMI$                 21-0-0/w UBIN        r     1 THIS_USER$
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:39   
    *0-0-0/w STRC(144)   r     1 TOP                       14-0-0/w UBIN        r     1 TX
    11-0-0/w UBIN        r     1 USER#                     17-0-0/w UBIN        r     1 USER$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)     r     1 BLANK_LINE                 0-0-0/w EPTR        r     1 DAF$WRITE
     0-0-0/b BIT         r     1 DA_MAPERR                  0-0-0/w UBIN        r     1 DB_BOBCAT$
     0-0-0/w UBIN        r     1 DB_HANDQ$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(2)     r     1 B$BIT18                    0-0-0/w STRC(144)   r     1 OUT


   Procedure DBD$HMI requires 536 words for executable code.
   Procedure DBD$HMI requires 194 words of local(AUTO) storage.
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:41   
          MINI XREF LISTING

ACTION
      9646**DCL      9722<<ASSIGN   9751<<ASSIGN   9785>>IF
B$BIT18
      9643**DCL      9800--CALL
BLANK_LINE
      9638**DCL      9728--CALL     9771--CALL
CTX_WDSZ
      9669**DCL      9811<>CALL
DAA$VALUE
      9461**DCL-ENT  9747--CALL
DAF$INIT
      9463**DCL-ENT  9726--CALL
DAF$WRITE
      9462**DCL      9728>>CALL     9729>>CALL     9730>>CALL     9731>>CALL     9771>>CALL     9800>>CALL
      9831>>CALL
DA_MAPERR
      9641**DCL      9741<<ASSIGN
DBM$GETBOBCAT
      9466**DCL-ENT  9713--CALL
DBM$GETMEM
      9465**DCL-ENT  9758--CALL     9783--CALL
DBM$PACK2
      9468**DCL-ENT  9714--CALL     9718--CALL     9784--CALL     9805--CALL     9806--CALL     9807--CALL
      9808--CALL     9809--CALL     9810--CALL     9811--CALL     9812--CALL     9813--CALL
DBM$PACK4
      9469**DCL-ENT  9715--CALL     9719--CALL     9759--CALL
DB_BOBCAT$
      9639**DCL      9776>>IF
DB_HANDQ$
      9640**DCL      9815>>ASSIGN   9816>>ASSIGN   9818>>ASSIGN   9819>>ASSIGN
DISPLAY_LOOP
      9731**LABEL    9752--GOTO
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:42   
DISP_HMI
      9775**PROC     9739--CALL     9762--CALL
ENTRY_TYPE
      9647**DCL      9705<<ASSIGN   9709<<ASSIGN
G$BOBCAT
      9672**DCL      9713<>CALL
G$BOBCAT.HMI#
      9674**DCL      9714<>CALL
G$BOBCAT.HMI$
      9677**DCL      9715<>CALL
G$BOBCAT.MUIS
      9673**DCL      9718<>CALL
G$BOBCAT.USRT$
      9675**DCL      9719<>CALL
G$USER
      9696**DCL      9720--ASSIGN   9758<>CALL     9758--CALL     9758--CALL
G$USER.HMI$
      9700**DCL      9759<>CALL
G$USER.MISC
      9697**DCL      9697--REDEF
HMI#
      9649**DCL      9714<>CALL     9738>>DOINDEX
HMI$
      9650**DCL      9715<>CALL     9777>>ASSIGN
HMI_FMT1
      9625**DCL      9800--CALL
HMI_FMT2
      9634**DCL      9831--CALL
HMI_RPT1
      9488**DCL      9726<>CALL
HMI_RPT1HD00
      9556**DCL      9523--DCLINIT
HMI_RPT1HD01
      9599**DCL      9571--DCLINIT
HMI_RPT1TX00
      9531**DCL      9518--DCLINIT
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:43   
HMI_RPT1TX01
      9574**DCL      9564--DCLINIT
HMI_RPT1TX02
      9617**DCL      9607--DCLINIT
HMI_RPT20
      9628**DCL      9729--CALL
HMI_RPT21
      9630**DCL      9730--CALL
HMI_RPT22
      9632**DCL      9731--CALL
HMI_START
      9709**LABEL    9706--GOTO
I
      9655**DCL      9738<<DOINDEX  9747<>CALL     9749>>IF       9755>>IF       9757>>ASSIGN   9759<>CALL
      9761>>IF       9776>>IF       9777>>ASSIGN   9779>>ASSIGN   9780<<ASSIGN
KNH$HMI
      9685**DCL      9716--ASSIGN   9783<>CALL     9783--CALL     9783--CALL
KNH$HMI.CTX.OFFSET
      9687**DCL      9831--CALL
KNH$HMI.CTX.SZ
      9688**DCL      9811<>CALL     9831--CALL
KNH$HMI.LDCTS#
      9689**DCL      9800--CALL
KNH$HMI.PP#
      9688**DCL      9800--CALL
KNH$HMI.PPSZ
      9689**DCL      9800--CALL
KNH$HMI.RCQ.IPTR
      9685**DCL      9805<>CALL
KNH$HMI.RCQ.LOCK.SREG
      9686**DCL      9800--CALL
KNH$HMI.RCQ.LOCK.WHO
      9686**DCL      9800--CALL
KNH$HMI.RCQ.OFFSET
      9685**DCL      9812<>CALL     9831--CALL
KNH$HMI.RCQ.RPTR
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:44   
      9685**DCL      9806<>CALL
KNH$HMI.RCQ.SZ
      9685**DCL      9809<>CALL
KNH$HMI.SCQ.BUSY
      9687**DCL      9800--CALL
KNH$HMI.SCQ.IPTR
      9686**DCL      9807<>CALL
KNH$HMI.SCQ.LOCK.SREG
      9687**DCL      9800--CALL
KNH$HMI.SCQ.LOCK.WHO
      9687**DCL      9800--CALL
KNH$HMI.SCQ.OFFSET
      9686**DCL      9813<>CALL     9831--CALL
KNH$HMI.SCQ.RPTR
      9686**DCL      9808<>CALL
KNH$HMI.SCQ.SZ
      9686**DCL      9810<>CALL
KNH$HMI.USER#
      9688**DCL      9784<>CALL
KNH$HMI.WAIT_COUNT
      9688**DCL      9800--CALL
KNH$HMI.WAIT_HEAD$
      9688**DCL      9800--CALL
MUIS
      9658**DCL      9718<>CALL     9755>>IF
OUT
      9421**DCL      9747<>CALL
PASS
      9645**DCL      9724<<DOINDEX  9725>>IF       9787>>IF
RCQ_I$
      9661**DCL      9805<>CALL     9815<<ASSIGN   9815>>ASSIGN   9831--CALL
RCQ_OFFSET
      9664**DCL      9812<>CALL     9815>>ASSIGN   9816>>ASSIGN
RCQ_R$
      9662**DCL      9806<>CALL     9816<<ASSIGN   9816>>ASSIGN   9831--CALL
RCQ_WDSZ
PL6.E3A0      #001=DBD$HMI File=DBD$HMI.:E05TSI                                  TUE 07/29/97 13:07 Page:45   
      9663**DCL      9809<>CALL     9817<<ASSIGN   9817>>ASSIGN   9831--CALL
SCQ_I$
      9665**DCL      9807<>CALL     9818<<ASSIGN   9818>>ASSIGN   9831--CALL
SCQ_OFFSET
      9668**DCL      9813<>CALL     9818>>ASSIGN   9819>>ASSIGN
SCQ_R$
      9666**DCL      9808<>CALL     9819<<ASSIGN   9819>>ASSIGN   9831--CALL
SCQ_WDSZ
      9667**DCL      9810<>CALL     9820<<ASSIGN   9820>>ASSIGN   9831--CALL
SIZEW_HMI
      9652**DCL      9716<<ASSIGN   9777>>ASSIGN
SIZEW_USRT
      9656**DCL      9720<<ASSIGN   9757>>ASSIGN
THIS_HMI$
      9653**DCL      9777<<ASSIGN   9779<<ASSIGN   9783<>CALL     9800--CALL     9831--CALL
THIS_USER$
      9659**DCL      9757<<ASSIGN   9758<>CALL
TOP
      9376**DCL        13--PROC     9708--ENTRY
TOP.NSUBLKS
      9388**DCL      9734>>IF       9746>>DOINDEX
TOP.SUBLK$
      9409**DCL      9747>>CALL
TX
      9654**DCL      9746<<DOINDEX  9747>>CALL
USER#
      9651**DCL      9784<>CALL     9785>>IF       9800--CALL
USER$
      9657**DCL      9719<>CALL     9757>>ASSIGN

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:46   
      230        1        /*T***********************************************************/
      231        2        /*T*                                                         */
      232        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      233        4        /*T*                                                         */
      234        5        /*T***********************************************************/
      235        6        /*X* PLM=3,IND=5,ECU=0,ENU=0   */
      236        7
      237        8        /*F*    NAME: DBD$CQ
      238        9                PURPOSE: To format and display the FEP Circular Queues.
      239       10
      240       11        */
      241       12        DBD$CQ: PROC(TOP);
      242       13
      243       14        %INCLUDE CP_6;
      244     5573        %INCLUDE DA_FORMAT_C;
      245     5815        %INCLUDE XU_MACRO_C;
      246     8921        %INCLUDE KNH_MACRO_C;
      247     9204        %INCLUDE DA_CMD_C;
      248     9553
      249     9554        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
      250     9599        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
      251     9644
      252     9645    1   DCL DAA$VALUE ENTRY(3) ALTRET;
      253     9646    1   DCL DAF$WRITE EPTR SYMREF;
      254     9647    1   DCL DAF$INIT ENTRY(1) ALTRET;
      255     9648    1   DCL DBA$SELECTION ENTRY(3) ALTRET;
      256     9649    1   DCL DBB$HEXDUMP ENTRY(4);
      257     9650    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
      258     9651    1   DCL DBM$PACK1 ENTRY(2);
      259     9652    1   DCL DBM$PACK2 ENTRY(2);
      260     9653    1   DCL DBM$PACK4 ENTRY(2);
      261     9654
      262     9655        %REPORT (NAME=RCQ_RPT,TRUNC=NO,HEADER=NO,TITLE='FEP User RCQ display');
      263     9721        %REPORT (NAME=SCQ_RPT,TRUNC=NO,HEADER=NO,TITLE='FEP User SCQ display');
      264     9787
      265     9788    1   DCL 1 RCQ_RPT20 CHAR(0) CONSTANT INIT('FEP User .%2ZH Receive Circular Queue');
      266     9789    1   DCL 1 SCQ_RPT20 CHAR(0) CONSTANT INIT('FEP User .%2ZH Send Circular Queue');
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:47   
      267     9790    1   DCL 1 CQ_RPT21 CHAR(0) CONSTANT INIT(
      268     9791    1   'Insert$ Remove$ WdSz  Offset  Last$  Msgs#     Msg bytes Wrap');
      269     9792    1   DCL 1 CQ_RPT22 CHAR(0) CONSTANT INIT(
      270     9793    1   '------- ------- ----- ------  ------ --------- --------- ---------');
      271     9794    1   DCL CQ_FMT2 CHAR(0) CONSTANT INIT(
      272     9795    1   '.%5ZH  .%5ZH  .%4ZH .%4ZH   .%5ZH %9D %9D %9D %A');
      273     9796
      274     9797    1   DCL BLANK_LINE CHAR(4) SYMREF;
      275     9798    1   DCL DB_HANDQ$ UBIN SYMREF;
      276     9799    1   DCL DB_MUIS SBIN SYMREF;
      277     9800    1   DCL DA_MAPERR BIT(36) SYMREF;
      278     9801
      279     9802    1   DCL PASS UBIN;
      280     9803    1   DCL D_RCQ UBIN;
      281     9804    1   DCL D_SCQ UBIN;
      282     9805    1   DCL DOING_LAST UBIN;
      283     9806    1   DCL ACTION UBIN;                        /* 0 - RCQ     1 -RCQ                 */
      284     9807    1   DCL THIS_USER SBIN;
      285     9808
      286     9809    1   DCL CQ# UBIN;
      287     9810    1   DCL CQ$ UBIN;
      288     9811    1   DCL USER# SBIN;
      289     9812    1   DCL SIZEW_CQ UBIN;
      290     9813    1   DCL TX UBIN;
      291     9814    1   DCL I UBIN;
      292     9815
      293     9816    1   DCL INSERT$ UBIN;
      294     9817    1   DCL REMOVE$ UBIN;
      295     9818    1   DCL LAST$ UBIN;
      296     9819    1   DCL CQ_WDSZ UBIN;
      297     9820    1   DCL CQ_OFFSET UBIN;
      298     9821    1   DCL WAKE_UP CHAR(8);
      299     9822
      300     9823    1   DCL CTX_WDSZ UBIN;
      301     9824
      302     9825        %KNH$QHDR (FPTN=KNH$QHDR,STCLASS=AUTO);
      303     9838        %KNH$MESS (FPTN=KNH$MESS,STCLASS=AUTO);
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:48   
      304     9887        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:49   
      305     9888    1      D_RCQ = 1;
      306     9889    1      D_SCQ = 1;
      307     9890    1      GOTO BEGIN_CQS;
      308     9891
      309     9892    1   DBD$RCQ: ENTRY(TOP);
      310     9893    1      D_RCQ = 1;
      311     9894    1      D_SCQ = 0;
      312     9895    1      GOTO BEGIN_CQS;
      313     9896
      314     9897    1   DBD$SCQ: ENTRY(TOP);
      315     9898    1      D_RCQ = 0;
      316     9899    1      D_SCQ = 1;
      317     9900
      318     9901    1   BEGIN_CQS: ;
      319     9902    1      DOING_LAST = 0;
      320     9903    1      IF TOP.NSUBLKS ~= 0
      321     9904    2      THEN DO;
      322     9905    2           IF TOP.SUBLK$(TOP.NSUBLKS-1)->OUT.CODE = %DB_CQS_LAST
      323     9906    3           THEN DO;
      324     9907    3                DOING_LAST = 1;
      325     9908    3                TOP.NSUBLKS = TOP.NSUBLKS -1;
      326     9909    3                END;
      327     9910    2           END;
      328     9911
      329     9912    1      IF D_RCQ = 1
      330     9913    2      THEN DO;
      331     9914    2           CALL DAF$INIT(RCQ_RPT);
      332     9915    2           ACTION = 0;
      333     9916    2           CALL DISP_CQ;
      334     9917    2           END;
      335     9918
      336     9919    1      IF D_SCQ = 1
      337     9920    2      THEN DO;
      338     9921    2           CALL DAF$INIT(SCQ_RPT);
      339     9922    2           ACTION = 1;
      340     9923    2           CALL DISP_CQ;
      341     9924    2           END;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:50   
      342     9925
      343     9926        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:51   
      344     9927
      345     9928    1   DISP_CQ: PROC;
      346     9929    2      IF TOP.NSUBLKS=0
      347     9930    3      THEN DO;
      348     9931    4           DO USER#=-1 DOWNTO -DB_MUIS;
      349     9932    4                CALL DISPCQ;
      350     9933    4                END;
      351     9934    3           DA_MAPERR = '0'B;
      352     9935    3           END/*do all users*/;
      353     9936
      354     9937    3      ELSE DO;
      355     9938    4           DO I=0 TO TOP.NSUBLKS-1;
      356     9939    5                CALL DBA$SELECTION(TOP.SUBLK$(I)->OUT,USER#) WHENRETURN DO;
      357     9940    5                     CALL DISPCQ;
      358     9941    5                     END;
      359     9942    4                END;
      360     9943    3           END/*else do*/;
      361     9944
      362     9945    2      CALL DAF$WRITE(VECTOR(BLANK_LINE));
      363     9946
      364     9947    2      RETURN;
      365     9948    2   END DISP_CQ;
      366     9949        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:52   
      367     9950
      368     9951    1   DISPCQ: PROC;
      369     9952
      370     9953    2      IF USER# > 0
      371     9954    2      THEN THIS_USER = USER#;
      372     9955    2      ELSE THIS_USER = -USER#;
      373     9956
      374     9957    2      CALL DBM$GETMEM(DB_HANDQ$,KNH$QHDR,USER#,SIZEC(KNH$QHDR),,SIZEC(KNH$QHDR),,1,1,
              9957               256)
      375     9958    3      WHENALTRETURN DO; RETURN; END;
      376     9959                              /*N* Should search usrt.hmi$ */
      377     9960    2      WAKE_UP = ' ';
      378     9961
      379     9962
      380     9963    2      IF ACTION=0
      381     9964    3      THEN DO;
      382     9965    3           CALL DBM$PACK2(KNH$QHDR.RCQ.IPTR,INSERT$);
      383     9966    3           CALL DBM$PACK2(KNH$QHDR.RCQ.RPTR,REMOVE$);
      384     9967    3           CALL DBM$PACK2(KNH$QHDR.RCQ.SZ,CQ_WDSZ);
      385     9968    3           CALL DBM$PACK2(KNH$QHDR.RCQ.OFFSET,CQ_OFFSET);
      386     9969    3           CALL DBM$PACK2(KNH$QHDR.LAST_RCQPTR,LAST$);
      387     9970
      388     9971    3           INSERT$ = (INSERT$ *2) + CQ_OFFSET + DB_HANDQ$;
      389     9972    3           REMOVE$ = (REMOVE$ *2) + CQ_OFFSET + DB_HANDQ$;
      390     9973    3           LAST$ = (LAST$ *2) + CQ_OFFSET + DB_HANDQ$;
      391     9974    3           CQ_WDSZ = (CQ_WDSZ *2);
      392     9975
      393     9976    3           CALL DAF$WRITE(VECTOR(RCQ_RPT20) ,VECTOR(THIS_USER));
      394     9977    3           CALL DAF$WRITE(VECTOR(CQ_RPT21));
      395     9978    3           CALL DAF$WRITE(VECTOR(CQ_RPT22));
      396     9979    3           CALL DAF$WRITE(VECTOR(CQ_FMT2),
      397     9980    3             VECTOR(INSERT$),
      398     9981    3             VECTOR(REMOVE$),
      399     9982    3             VECTOR(CQ_WDSZ),
      400     9983    3             VECTOR(CQ_OFFSET),
      401     9984    3             VECTOR(LAST$),
      402     9985    3             VECTOR(KNH$QHDR.MSGS_RCQ),
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:53   
      403     9986    3             VECTOR(KNH$QHDR.MBC_RCQ),
      404     9987    3             VECTOR(KNH$QHDR.WRAP_RCQ),
      405     9988    3             VECTOR(WAKE_UP));
      406     9989
      407     9990    3           END/*action rcq*/;
      408     9991
      409     9992    3      ELSE DO;
      410     9993    3           CALL DBM$PACK2(KNH$QHDR.SCQ.IPTR,INSERT$);
      411     9994    3           CALL DBM$PACK2(KNH$QHDR.SCQ.RPTR,REMOVE$);
      412     9995    3           CALL DBM$PACK2(KNH$QHDR.SCQ.SZ,CQ_WDSZ);
      413     9996    3           CALL DBM$PACK2(KNH$QHDR.SCQ.OFFSET,CQ_OFFSET);
      414     9997    3           CALL DBM$PACK2(KNH$QHDR.LAST_SCQPTR,LAST$);
      415     9998
      416     9999    3           IF KNH$QHDR.CTX.WU = '1'B
      417    10000    3           THEN WAKE_UP = 'WakeUp  ';
      418    10001
      419    10002    3           INSERT$ = (INSERT$ *2) + CQ_OFFSET + DB_HANDQ$;
      420    10003    3           REMOVE$ = (REMOVE$ *2) + CQ_OFFSET + DB_HANDQ$;
      421    10004    3           LAST$ = (LAST$ *2) + CQ_OFFSET + DB_HANDQ$;
      422    10005    3           CQ_WDSZ = (CQ_WDSZ *2);
      423    10006
      424    10007    3           CALL DAF$WRITE(VECTOR(SCQ_RPT20) ,VECTOR(THIS_USER));
      425    10008    3           CALL DAF$WRITE(VECTOR(CQ_RPT21));
      426    10009    3           CALL DAF$WRITE(VECTOR(CQ_RPT22));
      427    10010    3           CALL DAF$WRITE(VECTOR(CQ_FMT2),
      428    10011    3             VECTOR(INSERT$),
      429    10012    3             VECTOR(REMOVE$),
      430    10013    3             VECTOR(CQ_WDSZ),
      431    10014    3             VECTOR(CQ_OFFSET),
      432    10015    3             VECTOR(LAST$),
      433    10016    3             VECTOR(KNH$QHDR.MSGS_SCQ),
      434    10017    3             VECTOR(KNH$QHDR.MBC_SCQ),
      435    10018    3             VECTOR(KNH$QHDR.WRAP_SCQ),
      436    10019    3             VECTOR(WAKE_UP));
      437    10020
      438    10021    3           END/*action scq*/;
      439    10022
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:54   
      440    10023    2      CALL DAF$WRITE(VECTOR(BLANK_LINE));
      441    10024
      442    10025    2      CALL DBD$CQ_MESSAGE;
      443    10026    2      RETURN;
      444    10027    2   END DISPCQ;
      445    10028        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:55   
      446    10029    1   DBD$CQ_MESSAGE: PROC ALTRET;
      447    10030
      448    10031
      449    10032                                                /* CONSTANT Data                      */
      450    10033
      451    10034    2   DCL CQM_RPT1 CHAR(0) CONSTANT INIT(
      452    10035    2   'Msg$   Function Rectype LDCT# User ID  Free  Last$  Fpt$   Fptsz Mess$  Msgsz');
      453    10036
      454    10037    2   DCL CQM_RPT2 CHAR(0) CONSTANT INIT(
      455    10038    2   '------ -------- ------- ----- --------- ---- ------ ------ ----- ------ -----');
      456    10039
      457    10040    2   DCL CQM_FMT1 CHAR(0) CONSTANT INIT(
      458    10041    2   '.%5ZH %A %@7.16D %@5.16D .%@8.32ZH %A .%5ZH .%5ZH .%4ZH .%5ZH .%4ZH');
      459    10042
      460    10043        %KN_NAMTXT_FCN;
      461    10065
      462    10066                                                /* AUTO Stroage                       */
      463    10067    2   DCL 1 FUNCTION,
      464    10068    2         2 X,
      465    10069    2           3 * CHAR(7) UNAL,
      466    10070    2           3 X CHAR(8) UNAL,
      467    10071    2         2 TXT REDEF X CHAR(15) CALIGNED;
      468    10072    2   DCL FREE CHAR(4);
      469    10073    2   DCL I UBIN;
      470    10074    2   DCL MESSAGE$ UBIN;
      471    10075    2   DCL MSG_LAST$ UBIN;
      472    10076    2   DCL FPT$ UBIN;
      473    10077    2   DCL MSG$ UBIN;
      474    10078    2   DCL FPTSZ UBIN;
      475    10079    2   DCL MSGSZ UBIN;
      476    10080    2   DCL MESS_SZ UBIN;
      477    10081    2   DCL HDRSZ UBIN;
      478    10082    2   DCL INIT$ UBIN;
      479    10083    2   DCL RESET$ UBIN;
      480    10084    2   DCL END_IT UBIN;
      481    10085
      482    10086        %KNH$MESS (STCLASS=AUTO);
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:56   
      483    10135
      484    10136        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:57   
      485    10137    2      IF DOING_LAST = 0
      486    10138    3      THEN DO;
      487    10139    3           IF REMOVE$ = INSERT$ THEN RETURN;
      488    10140    3           MESSAGE$ = REMOVE$;
      489    10141    3           END;
      490    10142    3      ELSE DO;
      491    10143    3           MESSAGE$ = LAST$;
      492    10144    3           END_IT = 0;
      493    10145    3           END;
      494    10146    2      INIT$ = DB_HANDQ$ + CQ_OFFSET;
      495    10147    2      RESET$ = DB_HANDQ$ + CQ_OFFSET + CQ_WDSZ;
      496    10148    2      HDRSZ = (SIZEC(KNH$MESS) +1) / 2;
      497    10149
      498    10150    2      CALL DAF$WRITE(VECTOR(CQM_RPT1));
      499    10151    2      CALL DAF$WRITE(VECTOR(CQM_RPT2));
      500    10152
      501    10153    3      DO WHILE (MESSAGE$ ~= INSERT$);
      502    10154
      503    10155    3           CALL DBM$GETMEM(MESSAGE$,KNH$MESS,USER#,SIZEC(KNH$MESS),,SIZEC(KNH$MESS),,1,
             10155                    0)
      504    10156    4           WHENALTRETURN DO; ALTRETURN; END;
      505    10157
      506    10158
      507    10159    3           IF KNH$MESS.FLAGS.FREE THEN FREE=' Yes'; ELSE FREE=' No ';
      508    10160    3           KNH$MESS.FLAGS.FREE = '0'B;
      509    10161
      510    10162    3           CALL DBM$PACK2(KNH$MESS.FUNCTION,I);
      511    10163    3           IF I <= %KN_FCN_MAX
      512    10164    3           THEN FUNCTION.TXT = KN_NAMTXT_FCN.TXT(I);
      513    10165    3           ELSE CALL BINCHAR(FUNCTION.X.X,I);
      514    10166
      515    10167    3           CALL DBM$PACK2(KNH$MESS.LAST_PTR,MSG_LAST$);
      516    10168    3           CALL DBM$PACK2(KNH$MESS.FPTSZ,FPTSZ);
      517    10169    3           CALL DBM$PACK2(KNH$MESS.MSGSZ,MSGSZ);
      518    10170
      519    10171    3           MSG_LAST$ = (MSG_LAST$ *2) + CQ_OFFSET + DB_HANDQ$;
      520    10172
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:58   
      521    10173    3           FPTSZ = (FPTSZ +1) /2;
      522    10174    3           MSGSZ = (MSGSZ +1) /2;
      523    10175    3           MESS_SZ =( (HDRSZ + FPTSZ + MSGSZ +1) /2) * 2;
      524    10176
      525    10177    3           IF FPTSZ = 0
      526    10178    3           THEN FPT$ = 0;
      527    10179    3           ELSE FPT$ = MESSAGE$ + HDRSZ;
      528    10180
      529    10181    3           IF MSGSZ = 0
      530    10182    3           THEN MSG$ = 0;
      531    10183    3           ELSE MSG$ = MESSAGE$ + HDRSZ + FPTSZ;
      532    10184
      533    10185    3           CALL DAF$WRITE(VECTOR(CQM_FMT1),
      534    10186    3             VECTOR(MESSAGE$), VECTOR(FUNCTION.X.X), VECTOR(KNH$MESS.RECTYPE),
      535    10187    3             VECTOR(KNH$MESS.LDCTX), VECTOR(KNH$MESS.UID), VECTOR(FREE),
      536    10188    3             VECTOR(MSG_LAST$), VECTOR(FPT$), VECTOR(FPTSZ),
      537    10189    3             VECTOR(MSG$), VECTOR(MSGSZ));
      538    10190
      539    10191    3           IF DOING_LAST = 0
      540    10192    4           THEN DO;
      541    10193    4                MESSAGE$ = MESSAGE$ + MESS_SZ;
      542    10194    4                IF MESSAGE$ >= RESET$
      543    10195    4                THEN MESSAGE$ = INIT$;
      544    10196    4                END;
      545    10197    4           ELSE DO;
      546    10198    4                IF MESSAGE$ = INIT$
      547    10199    4                THEN END_IT = 1;
      548    10200    4                MESSAGE$ = MSG_LAST$;
      549    10201    4                IF (END_IT = 1) AND (MESSAGE$ < INSERT$)
      550    10202    4                THEN RETURN;
      551    10203    4                END;
      552    10204
      553    10205    3           END/*do while*/;
      554    10206
      555    10207    2      CALL DAF$WRITE(VECTOR(BLANK_LINE));
      556    10208    2      RETURN;
      557    10209    2   END DBD$CQ_MESSAGE;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:59   
      558    10210    1   END DBD$CQ;

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:60   
--  Include file information  --

   DA_CMD_C.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DBD$CQ.

   Procedure DBD$CQ requires 792 words for executable code.
   Procedure DBD$CQ requires 144 words of local(AUTO) storage.

    No errors detected in file DBD$HMI.:E05TSI    .

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:61   

 Object Unit name= DBD$CQ                                     File name= DBD$HMI.:E05TOU
 UTS= JUL 29 '97 13:07:39.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    28     34  DBD$CQ
    2  RoData even  UTS    185    271  DBD$CQ
    3   Proc  even  none   792   1430  DBD$CQ
    4  RoData even  none    56     70  DBD$CQ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  DBD$CQ
     3      6                  yes      Std        1  DBD$RCQ
     3     14                  yes      Std        1  DBD$SCQ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std       3 DBA$SELECTION
 yes     yes           Std      10 DBM$GETMEM
         yes           Std       2 DBM$PACK2
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:62   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  DAF$WRITE                             BLANK_LINE
     DB_HANDQ$                             DB_MUIS                               DA_MAPERR
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:63   


      230        1        /*T***********************************************************/
      231        2        /*T*                                                         */
      232        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      233        4        /*T*                                                         */
      234        5        /*T***********************************************************/
      235        6        /*X* PLM=3,IND=5,ECU=0,ENU=0   */
      236        7
      237        8        /*F*    NAME: DBD$CQ
      238        9                PURPOSE: To format and display the FEP Circular Queues.
      239       10
      240       11        */
      241       12        DBD$CQ: PROC(TOP);

     12  3 000000   000000 700200 xent  DBD$CQ       TSX0  ! X66_AUTO_1
         3 000001   000220 000001                    ZERO    144,1

      242       13
      243       14        %INCLUDE CP_6;
      244     5573        %INCLUDE DA_FORMAT_C;
      245     5815        %INCLUDE XU_MACRO_C;
      246     8921        %INCLUDE KNH_MACRO_C;
      247     9204        %INCLUDE DA_CMD_C;
      248     9553
      249     9554        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
      250     9599        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
      251     9644
      252     9645    1   DCL DAA$VALUE ENTRY(3) ALTRET;
      253     9646    1   DCL DAF$WRITE EPTR SYMREF;
      254     9647    1   DCL DAF$INIT ENTRY(1) ALTRET;
      255     9648    1   DCL DBA$SELECTION ENTRY(3) ALTRET;
      256     9649    1   DCL DBB$HEXDUMP ENTRY(4);
      257     9650    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
      258     9651    1   DCL DBM$PACK1 ENTRY(2);
      259     9652    1   DCL DBM$PACK2 ENTRY(2);
      260     9653    1   DCL DBM$PACK4 ENTRY(2);
      261     9654
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:64   
      262     9655        %REPORT (NAME=RCQ_RPT,TRUNC=NO,HEADER=NO,TITLE='FEP User RCQ display');
      263     9721        %REPORT (NAME=SCQ_RPT,TRUNC=NO,HEADER=NO,TITLE='FEP User SCQ display');
      264     9787
      265     9788    1   DCL 1 RCQ_RPT20 CHAR(0) CONSTANT INIT('FEP User .%2ZH Receive Circular Queue');
      266     9789    1   DCL 1 SCQ_RPT20 CHAR(0) CONSTANT INIT('FEP User .%2ZH Send Circular Queue');
      267     9790    1   DCL 1 CQ_RPT21 CHAR(0) CONSTANT INIT(
      268     9791    1   'Insert$ Remove$ WdSz  Offset  Last$  Msgs#     Msg bytes Wrap');
      269     9792    1   DCL 1 CQ_RPT22 CHAR(0) CONSTANT INIT(
      270     9793    1   '------- ------- ----- ------  ------ --------- --------- ---------');
      271     9794    1   DCL CQ_FMT2 CHAR(0) CONSTANT INIT(
      272     9795    1   '.%5ZH  .%5ZH  .%4ZH .%4ZH   .%5ZH %9D %9D %9D %A');
      273     9796
      274     9797    1   DCL BLANK_LINE CHAR(4) SYMREF;
      275     9798    1   DCL DB_HANDQ$ UBIN SYMREF;
      276     9799    1   DCL DB_MUIS SBIN SYMREF;
      277     9800    1   DCL DA_MAPERR BIT(36) SYMREF;
      278     9801
      279     9802    1   DCL PASS UBIN;
      280     9803    1   DCL D_RCQ UBIN;
      281     9804    1   DCL D_SCQ UBIN;
      282     9805    1   DCL DOING_LAST UBIN;
      283     9806    1   DCL ACTION UBIN;                        /* 0 - RCQ     1 -RCQ                 */
      284     9807    1   DCL THIS_USER SBIN;
      285     9808
      286     9809    1   DCL CQ# UBIN;
      287     9810    1   DCL CQ$ UBIN;
      288     9811    1   DCL USER# SBIN;
      289     9812    1   DCL SIZEW_CQ UBIN;
      290     9813    1   DCL TX UBIN;
      291     9814    1   DCL I UBIN;
      292     9815
      293     9816    1   DCL INSERT$ UBIN;
      294     9817    1   DCL REMOVE$ UBIN;
      295     9818    1   DCL LAST$ UBIN;
      296     9819    1   DCL CQ_WDSZ UBIN;
      297     9820    1   DCL CQ_OFFSET UBIN;
      298     9821    1   DCL WAKE_UP CHAR(8);
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:65   
      299     9822
      300     9823    1   DCL CTX_WDSZ UBIN;
      301     9824
      302     9825        %KNH$QHDR (FPTN=KNH$QHDR,STCLASS=AUTO);
      303     9838        %KNH$MESS (FPTN=KNH$MESS,STCLASS=AUTO);
      304     9887        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:66   
      305     9888    1      D_RCQ = 1;

   9888  3 000002   000001 235007                    LDA     1,DL
         3 000003   200005 755100                    STA     D_RCQ,,AUTO

      306     9889    1      D_SCQ = 1;

   9889  3 000004   200006 755100                    STA     D_SCQ,,AUTO

      307     9890    1      GOTO BEGIN_CQS;

   9890  3 000005   000021 710000 3                  TRA     BEGIN_CQS

      308     9891
      309     9892    1   DBD$RCQ: ENTRY(TOP);

   9892  3 000006   000000 700200 xent  DBD$RCQ      TSX0  ! X66_AUTO_1
         3 000007   000220 000001                    ZERO    144,1

      310     9893    1      D_RCQ = 1;

   9893  3 000010   000001 235007                    LDA     1,DL
         3 000011   200005 755100                    STA     D_RCQ,,AUTO

      311     9894    1      D_SCQ = 0;

   9894  3 000012   200006 450100                    STZ     D_SCQ,,AUTO

      312     9895    1      GOTO BEGIN_CQS;

   9895  3 000013   000021 710000 3                  TRA     BEGIN_CQS

      313     9896
      314     9897    1   DBD$SCQ: ENTRY(TOP);

   9897  3 000014   000000 700200 xent  DBD$SCQ      TSX0  ! X66_AUTO_1
         3 000015   000220 000001                    ZERO    144,1
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:67   

      315     9898    1      D_RCQ = 0;

   9898  3 000016   200005 450100                    STZ     D_RCQ,,AUTO

      316     9899    1      D_SCQ = 1;

   9899  3 000017   000001 235007                    LDA     1,DL
         3 000020   200006 755100                    STA     D_SCQ,,AUTO

   9899  3 000021                       BEGIN_CQS    null
      317     9900
      318     9901    1   BEGIN_CQS: ;
      319     9902    1      DOING_LAST = 0;

   9902  3 000021   200007 450100                    STZ     DOING_LAST,,AUTO

      320     9903    1      IF TOP.NSUBLKS ~= 0

   9903  3 000022   200003 470500                    LDP0    @TOP,,AUTO
         3 000023   000001 220100                    LDX0    1,,PR0
         3 000024   000034 600000 3                  TZE     s:9912

      321     9904    2      THEN DO;

      322     9905    2           IF TOP.SUBLK$(TOP.NSUBLKS-1)->OUT.CODE = %DB_CQS_LAST

   9905  3 000025   000002 471510                    LDP1    2,X0,PR0
         3 000026   100000 721100                    LXL1    0,,PR1
         3 000027   023417 101003                    CMPX1   9999,DU
         3 000030   000034 601000 3                  TNZ     s:9912

      323     9906    3           THEN DO;

      324     9907    3                DOING_LAST = 1;

   9907  3 000031   200007 755100                    STA     DOING_LAST,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:68   

      325     9908    3                TOP.NSUBLKS = TOP.NSUBLKS -1;

   9908  3 000032   777777 622010                    EAX2    -1,X0
         3 000033   000001 742100                    STX2    1,,PR0

      326     9909    3                END;

      327     9910    2           END;

      328     9911
      329     9912    1      IF D_RCQ = 1

   9912  3 000034   200005 236100                    LDQ     D_RCQ,,AUTO
         3 000035   000001 116007                    CMPQ    1,DL
         3 000036   000046 601000 3                  TNZ     s:9919

      330     9913    2      THEN DO;

      331     9914    2           CALL DAF$INIT(RCQ_RPT);

   9914  3 000037   000000 630400 4                  EPPR0   0
         3 000040   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000041   000000 701000 xent               TSX1    DAF$INIT
         3 000042   000000 011000                    NOP     0

      332     9915    2           ACTION = 0;

   9915  3 000043   200010 450100                    STZ     ACTION,,AUTO

      333     9916    2           CALL DISP_CQ;

   9916  3 000044   000062 701000 3                  TSX1    DISP_CQ
         3 000045   000000 011000                    NOP     0

      334     9917    2           END;

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:69   
      335     9918
      336     9919    1      IF D_SCQ = 1

   9919  3 000046   200006 235100                    LDA     D_SCQ,,AUTO
         3 000047   000001 115007                    CMPA    1,DL
         3 000050   000061 601000 3                  TNZ     s:9924

      337     9920    2      THEN DO;

      338     9921    2           CALL DAF$INIT(SCQ_RPT);

   9921  3 000051   000001 630400 4                  EPPR0   1
         3 000052   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000053   000000 701000 xent               TSX1    DAF$INIT
         3 000054   000000 011000                    NOP     0

      339     9922    2           ACTION = 1;

   9922  3 000055   000001 235007                    LDA     1,DL
         3 000056   200010 755100                    STA     ACTION,,AUTO

      340     9923    2           CALL DISP_CQ;

   9923  3 000057   000062 701000 3                  TSX1    DISP_CQ
         3 000060   000000 011000                    NOP     0

      341     9924    2           END;

   9924  3 000061   001427 710000 3                  TRA     s:10210

      342     9925
      343     9926        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:70   
      344     9927
      345     9928    1   DISP_CQ: PROC;

   9928  3 000062   200050 741300       DISP_CQ      STX1  ! KNH$QHDR+16,,AUTO

      346     9929    2      IF TOP.NSUBLKS=0

   9929  3 000063   200003 470500                    LDP0    @TOP,,AUTO
         3 000064   000001 220100                    LDX0    1,,PR0
         3 000065   000102 601000 3                  TNZ     s:9938

      347     9930    3      THEN DO;

      348     9931    4           DO USER#=-1 DOWNTO -DB_MUIS;

   9931  3 000066   000001 335007                    LCA     1,DL
         3 000067   200014 755100                    STA     USER#,,AUTO
         3 000070   000075 710000 3                  TRA     s:9933+2

      349     9932    4                CALL DISPCQ;

   9932  3 000071   000140 701000 3                  TSX1    DISPCQ
         3 000072   000000 011000                    NOP     0

      350     9933    4                END;

   9933  3 000073   000001 336007                    LCQ     1,DL
         3 000074   200014 056100                    ASQ     USER#,,AUTO
         3 000075   000000 336000 xsym               LCQ     DB_MUIS
         3 000076   200014 116100                    CMPQ    USER#,,AUTO
         3 000077   000071 604400 3                  TMOZ    s:9932

      351     9934    3           DA_MAPERR = '0'B;

   9934  3 000100   000000 450000 xsym               STZ     DA_MAPERR

      352     9935    3           END/*do all users*/;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:71   

   9935  3 000101   000131 710000 3                  TRA     s:9945

      353     9936
      354     9937    3      ELSE DO;

      355     9938    4           DO I=0 TO TOP.NSUBLKS-1;

   9938  3 000102   200017 450100                    STZ     I,,AUTO
         3 000103   000123 710000 3                  TRA     s:9942+3

      356     9939    5                CALL DBA$SELECTION(TOP.SUBLK$(I)->OUT,USER#) WHENRETURN DO;

   9939  3 000104   200003 470500                    LDP0    @TOP,,AUTO
         3 000105   200017 720100                    LXL0    I,,AUTO
         3 000106   000003 471510                    LDP1    3,X0,PR0
         3 000107   200014 633500                    EPPR3   USER#,,AUTO
         3 000110   200103 453500                    STP3    KNH$MESS+5,,AUTO
         3 000111   200102 451500                    STP1    KNH$MESS+4,,AUTO
         3 000112   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000113   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000114   000000 701000 xent               TSX1    DBA$SELECTION
         3 000115   000120 702000 3                  TSX2    s:9942

      357     9940    5                     CALL DISPCQ;

   9940  3 000116   000140 701000 3                  TSX1    DISPCQ
         3 000117   000000 011000                    NOP     0

      358     9941    5                     END;

      359     9942    4                END;

   9942  3 000120   200017 235100                    LDA     I,,AUTO
         3 000121   000001 035007                    ADLA    1,DL
         3 000122   200017 755100                    STA     I,,AUTO
         3 000123   200003 470500                    LDP0    @TOP,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:72   
         3 000124   000001 236100                    LDQ     1,,PR0
         3 000125   000022 772000                    QRL     18
         3 000126   200017 116100                    CMPQ    I,,AUTO
         3 000127   000131 600000 3                  TZE     s:9945
         3 000130   000104 603000 3                  TRC     s:9939

      360     9943    3           END/*else do*/;

      361     9944
      362     9945    2      CALL DAF$WRITE(VECTOR(BLANK_LINE));

   9945  3 000131   000004 630400 4                  EPPR0   4
         3 000132   000000 220000 xsym               LDX0    DAF$WRITE
         3 000133   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000134   000000 701010                    TSX1    0,X0
         3 000135   000000 011000                    NOP     0

      363     9946
      364     9947    2      RETURN;

   9947  3 000136   200050 221300                    LDX1  ! KNH$QHDR+16,,AUTO
         3 000137   000001 702211                    TSX2  ! 1,X1

      365     9948    2   END DISP_CQ;
      366     9949        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:73   
      367     9950
      368     9951    1   DISPCQ: PROC;

   9951  3 000140   200052 741300       DISPCQ       STX1  ! KNH$QHDR+18,,AUTO

      369     9952
      370     9953    2      IF USER# > 0

   9953  3 000141   200014 235100                    LDA     USER#,,AUTO
         3 000142   000145 604400 3                  TMOZ    s:9955

      371     9954    2      THEN THIS_USER = USER#;

   9954  3 000143   200011 755100                    STA     THIS_USER,,AUTO
         3 000144   000147 710000 3                  TRA     s:9957

      372     9955    2      ELSE THIS_USER = -USER#;

   9955  3 000145   000000 531000                    NEG     0
         3 000146   200011 755100                    STA     THIS_USER,,AUTO

      373     9956
      374     9957    2      CALL DBM$GETMEM(DB_HANDQ$,KNH$QHDR,USER#,SIZEC(KNH$QHDR),,SIZEC(KNH$QHDR),,1,1,
              9957               256)

   9957  3 000147   000010 237000 4                  LDAQ    8
         3 000150   200112 757100                    STAQ    KNH$MESS+12,,AUTO
         3 000151   000010 236000 4                  LDQ     8
         3 000152   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000153   200110 757100                    STAQ    KNH$MESS+10,,AUTO
         3 000154   000012 236000 4                  LDQ     10
         3 000155   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000156   200106 757100                    STAQ    KNH$MESS+8,,AUTO
         3 000157   000012 236000 4                  LDQ     10
         3 000160   200105 756100                    STQ     KNH$MESS+7,,AUTO
         3 000161   200014 630500                    EPPR0   USER#,,AUTO
         3 000162   200104 450500                    STP0    KNH$MESS+6,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:74   
         3 000163   200030 631500                    EPPR1   KNH$QHDR,,AUTO
         3 000164   200103 451500                    STP1    KNH$MESS+5,,AUTO
         3 000165   000013 236000 4                  LDQ     11
         3 000166   200102 756100                    STQ     KNH$MESS+4,,AUTO
         3 000167   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000170   000005 631400 4                  EPPR1   5
         3 000171   000000 701000 xent               TSX1    DBM$GETMEM
         3 000172   000174 702000 3                  TSX2    s:9958
         3 000173   000176 710000 3                  TRA     s:9960

      375     9958    3      WHENALTRETURN DO; RETURN; END;

   9958  3 000174   200052 221300                    LDX1  ! KNH$QHDR+18,,AUTO
         3 000175   000001 702211                    TSX2  ! 1,X1

      376     9959                              /*N* Should search usrt.hmi$ */
      377     9960    2      WAKE_UP = ' ';

   9960  3 000176   000035 235000 xsym               LDA     B_VECTNIL+29
         3 000177   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 000200   200025 755100                    STA     WAKE_UP,,AUTO
         3 000201   200026 756100                    STQ     WAKE_UP+1,,AUTO

      378     9961
      379     9962
      380     9963    2      IF ACTION=0

   9963  3 000202   200010 235100                    LDA     ACTION,,AUTO
         3 000203   000463 601000 3                  TNZ     s:9993

      381     9964    3      THEN DO;

      382     9965    3           CALL DBM$PACK2(KNH$QHDR.RCQ.IPTR,INSERT$);

   9965  3 000204   200020 630500                    EPPR0   INSERT$,,AUTO
         3 000205   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000206   200030 631500                    EPPR1   KNH$QHDR,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:75   
         3 000207   200102 451500                    STP1    KNH$MESS+4,,AUTO
         3 000210   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000211   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000212   000000 701000 xent               TSX1    DBM$PACK2
         3 000213   000000 011000                    NOP     0

      383     9966    3           CALL DBM$PACK2(KNH$QHDR.RCQ.RPTR,REMOVE$);

   9966  3 000214   200021 630500                    EPPR0   REMOVE$,,AUTO
         3 000215   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000216   200104 452500                    STP2    KNH$MESS+6,,AUTO
         3 000217   200104 236100                    LDQ     KNH$MESS+6,,AUTO
         3 000220   000014 036000 4                  ADLQ    12
         3 000221   200102 756100                    STQ     KNH$MESS+4,,AUTO
         3 000222   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000223   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000224   000000 701000 xent               TSX1    DBM$PACK2
         3 000225   000000 011000                    NOP     0

      384     9967    3           CALL DBM$PACK2(KNH$QHDR.RCQ.SZ,CQ_WDSZ);

   9967  3 000226   200023 630500                    EPPR0   CQ_WDSZ,,AUTO
         3 000227   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000230   200031 631500                    EPPR1   KNH$QHDR+1,,AUTO
         3 000231   200102 451500                    STP1    KNH$MESS+4,,AUTO
         3 000232   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000233   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000234   000000 701000 xent               TSX1    DBM$PACK2
         3 000235   000000 011000                    NOP     0

      385     9968    3           CALL DBM$PACK2(KNH$QHDR.RCQ.OFFSET,CQ_OFFSET);

   9968  3 000236   200024 630500                    EPPR0   CQ_OFFSET,,AUTO
         3 000237   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000240   200104 452500                    STP2    KNH$MESS+6,,AUTO
         3 000241   200104 236100                    LDQ     KNH$MESS+6,,AUTO
         3 000242   000015 036000 4                  ADLQ    13
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:76   
         3 000243   200102 756100                    STQ     KNH$MESS+4,,AUTO
         3 000244   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000245   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000246   000000 701000 xent               TSX1    DBM$PACK2
         3 000247   000000 011000                    NOP     0

      386     9969    3           CALL DBM$PACK2(KNH$QHDR.LAST_RCQPTR,LAST$);

   9969  3 000250   200022 630500                    EPPR0   LAST$,,AUTO
         3 000251   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000252   200043 631500                    EPPR1   KNH$QHDR+11,,AUTO
         3 000253   200102 451500                    STP1    KNH$MESS+4,,AUTO
         3 000254   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000255   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000256   000000 701000 xent               TSX1    DBM$PACK2
         3 000257   000000 011000                    NOP     0

      387     9970
      388     9971    3           INSERT$ = (INSERT$ *2) + CQ_OFFSET + DB_HANDQ$;

   9971  3 000260   200020 236100                    LDQ     INSERT$,,AUTO
         3 000261   000001 736000                    QLS     1
         3 000262   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 000263   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000264   200020 756100                    STQ     INSERT$,,AUTO

      389     9972    3           REMOVE$ = (REMOVE$ *2) + CQ_OFFSET + DB_HANDQ$;

   9972  3 000265   200021 236100                    LDQ     REMOVE$,,AUTO
         3 000266   000001 736000                    QLS     1
         3 000267   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 000270   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000271   200021 756100                    STQ     REMOVE$,,AUTO

      390     9973    3           LAST$ = (LAST$ *2) + CQ_OFFSET + DB_HANDQ$;

   9973  3 000272   200022 236100                    LDQ     LAST$,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:77   
         3 000273   000001 736000                    QLS     1
         3 000274   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 000275   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000276   200022 756100                    STQ     LAST$,,AUTO

      391     9974    3           CQ_WDSZ = (CQ_WDSZ *2);

   9974  3 000277   200023 235100                    LDA     CQ_WDSZ,,AUTO
         3 000300   000001 735000                    ALS     1
         3 000301   200023 755100                    STA     CQ_WDSZ,,AUTO

      392     9975
      393     9976    3           CALL DAF$WRITE(VECTOR(RCQ_RPT20) ,VECTOR(THIS_USER));

   9976  3 000302   777640 235007                    LDA     -96,DL
         3 000303   200102 452500                    STP2    KNH$MESS+4,,AUTO
         3 000304   200102 236100                    LDQ     KNH$MESS+4,,AUTO
         3 000305   000011 036003                    ADLQ    9,DU
         3 000306   200104 757100                    STAQ    KNH$MESS+6,,AUTO
         3 000307   200104 630500                    EPPR0   KNH$MESS+6,,AUTO
         3 000310   200107 450500                    STP0    KNH$MESS+9,,AUTO
         3 000311   000020 236000 4                  LDQ     16
         3 000312   200106 756100                    STQ     KNH$MESS+8,,AUTO
         3 000313   200106 630500                    EPPR0   KNH$MESS+8,,AUTO
         3 000314   000000 220000 xsym               LDX0    DAF$WRITE
         3 000315   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000316   000000 701010                    TSX1    0,X0
         3 000317   000000 011000                    NOP     0

      394     9977    3           CALL DAF$WRITE(VECTOR(CQ_RPT21));

   9977  3 000320   000024 630400 4                  EPPR0   20
         3 000321   000000 220000 xsym               LDX0    DAF$WRITE
         3 000322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000323   000000 701010                    TSX1    0,X0
         3 000324   000000 011000                    NOP     0

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:78   
      395     9978    3           CALL DAF$WRITE(VECTOR(CQ_RPT22));

   9978  3 000325   000030 630400 4                  EPPR0   24
         3 000326   000000 220000 xsym               LDX0    DAF$WRITE
         3 000327   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000330   000000 701010                    TSX1    0,X0
         3 000331   000000 011000                    NOP     0

      396     9979    3           CALL DAF$WRITE(VECTOR(CQ_FMT2),
      397     9980    3             VECTOR(INSERT$),
      398     9981    3             VECTOR(REMOVE$),
      399     9982    3             VECTOR(CQ_WDSZ),
      400     9983    3             VECTOR(CQ_OFFSET),
      401     9984    3             VECTOR(LAST$),
      402     9985    3             VECTOR(KNH$QHDR.MSGS_RCQ),
      403     9986    3             VECTOR(KNH$QHDR.MBC_RCQ),
      404     9987    3             VECTOR(KNH$QHDR.WRAP_RCQ),

   9987  3 000332   777640 235007                    LDA     -96,DL
         3 000333   200102 452500                    STP2    KNH$MESS+4,,AUTO
         3 000334   200102 236100                    LDQ     KNH$MESS+4,,AUTO
         3 000335   000020 036003                    ADLQ    16,DU
         3 000336   200104 757100                    STAQ    KNH$MESS+6,,AUTO
         3 000337   777640 235007                    LDA     -96,DL
         3 000340   200106 452500                    STP2    KNH$MESS+8,,AUTO
         3 000341   200106 236100                    LDQ     KNH$MESS+8,,AUTO
         3 000342   000021 036003                    ADLQ    17,DU
         3 000343   200110 757100                    STAQ    KNH$MESS+10,,AUTO
         3 000344   777640 235007                    LDA     -96,DL
         3 000345   200112 452500                    STP2    KNH$MESS+12,,AUTO
         3 000346   200112 236100                    LDQ     KNH$MESS+12,,AUTO
         3 000347   000023 036003                    ADLQ    19,DU
         3 000350   200114 757100                    STAQ    KNH$MESS+14,,AUTO
         3 000351   777640 235007                    LDA     -96,DL
         3 000352   200116 452500                    STP2    KNH$MESS+16,,AUTO
         3 000353   200116 236100                    LDQ     KNH$MESS+16,,AUTO
         3 000354   000024 036003                    ADLQ    20,DU
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:79   
         3 000355   200120 757100                    STAQ    KNH$MESS+18,,AUTO
         3 000356   777640 235007                    LDA     -96,DL
         3 000357   200122 452500                    STP2    KNH$MESS+20,,AUTO
         3 000360   200122 236100                    LDQ     KNH$MESS+20,,AUTO
         3 000361   000022 036003                    ADLQ    18,DU
         3 000362   200124 757100                    STAQ    KNH$MESS+22,,AUTO
         3 000363   777640 235007                    LDA     -96,DL
         3 000364   200126 452500                    STP2    KNH$MESS+24,,AUTO
         3 000365   200126 236100                    LDQ     KNH$MESS+24,,AUTO
         3 000366   000040 036003                    ADLQ    32,DU
         3 000367   200130 757100                    STAQ    KNH$MESS+26,,AUTO
         3 000370   777640 235007                    LDA     -96,DL
         3 000371   200132 452500                    STP2    KNH$MESS+28,,AUTO
         3 000372   200132 236100                    LDQ     KNH$MESS+28,,AUTO
         3 000373   000041 036003                    ADLQ    33,DU
         3 000374   200134 757100                    STAQ    KNH$MESS+30,,AUTO
         3 000375   777640 235007                    LDA     -96,DL
         3 000376   200136 452500                    STP2    KNH$MESS+32,,AUTO
         3 000377   200136 236100                    LDQ     KNH$MESS+32,,AUTO
         3 000400   000042 036003                    ADLQ    34,DU
         3 000401   200140 757100                    STAQ    KNH$MESS+34,,AUTO
         3 000402   000034 235000 4                  LDA     28
         3 000403   200142 452500                    STP2    KNH$MESS+36,,AUTO
         3 000404   200142 236100                    LDQ     KNH$MESS+36,,AUTO
         3 000405   000025 036003                    ADLQ    21,DU
         3 000406   200146 757100                    STAQ    KNH$MESS+40,,AUTO
         3 000407   200104 237100                    LDAQ    KNH$MESS+6,,AUTO
         3 000410   200144 757100                    STAQ    KNH$MESS+38,,AUTO
         3 000411   200110 237100                    LDAQ    KNH$MESS+10,,AUTO
         3 000412   200150 757100                    STAQ    KNH$MESS+42,,AUTO
         3 000413   200114 237100                    LDAQ    KNH$MESS+14,,AUTO
         3 000414   200152 757100                    STAQ    KNH$MESS+44,,AUTO
         3 000415   200120 237100                    LDAQ    KNH$MESS+18,,AUTO
         3 000416   200154 757100                    STAQ    KNH$MESS+46,,AUTO
         3 000417   200124 237100                    LDAQ    KNH$MESS+22,,AUTO
         3 000420   200156 757100                    STAQ    KNH$MESS+48,,AUTO
         3 000421   200130 237100                    LDAQ    KNH$MESS+26,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:80   
         3 000422   200160 757100                    STAQ    KNH$MESS+50,,AUTO
         3 000423   200134 237100                    LDAQ    KNH$MESS+30,,AUTO
         3 000424   200162 757100                    STAQ    KNH$MESS+52,,AUTO
         3 000425   200140 237100                    LDAQ    KNH$MESS+34,,AUTO
         3 000426   200164 757100                    STAQ    KNH$MESS+54,,AUTO
         3 000427   200146 237100                    LDAQ    KNH$MESS+40,,AUTO
         3 000430   200166 757100                    STAQ    KNH$MESS+56,,AUTO
         3 000431   200166 630500                    EPPR0   KNH$MESS+56,,AUTO
         3 000432   200201 450500                    STP0    KNH$MESS+67,,AUTO
         3 000433   200164 631500                    EPPR1   KNH$MESS+54,,AUTO
         3 000434   200200 451500                    STP1    KNH$MESS+66,,AUTO
         3 000435   200162 633500                    EPPR3   KNH$MESS+52,,AUTO
         3 000436   200177 453500                    STP3    KNH$MESS+65,,AUTO
         3 000437   200160 634500                    EPPR4   KNH$MESS+50,,AUTO
         3 000440   200176 454500                    STP4    KNH$MESS+64,,AUTO
         3 000441   200156 635500                    EPPR5   KNH$MESS+48,,AUTO
         3 000442   200175 455500                    STP5    KNH$MESS+63,,AUTO
         3 000443   200154 636500                    EPPR6   KNH$MESS+46,,AUTO
         3 000444   200174 456500                    STP6    KNH$MESS+62,,AUTO
         3 000445   200152 637500                    EPPR7   KNH$MESS+44,,AUTO
         3 000446   200173 457500                    STP7    KNH$MESS+61,,AUTO
         3 000447   200150 630500                    EPPR0   KNH$MESS+42,,AUTO
         3 000450   200172 450500                    STP0    KNH$MESS+60,,AUTO
         3 000451   200144 630500                    EPPR0   KNH$MESS+38,,AUTO
         3 000452   200171 450500                    STP0    KNH$MESS+59,,AUTO
         3 000453   000035 236000 4                  LDQ     29
         3 000454   200170 756100                    STQ     KNH$MESS+58,,AUTO
         3 000455   200170 630500                    EPPR0   KNH$MESS+58,,AUTO
         3 000456   000000 220000 xsym               LDX0    DAF$WRITE
         3 000457   000005 631400 4                  EPPR1   5
         3 000460   000000 701010                    TSX1    0,X0
         3 000461   000000 011000                    NOP     0

      405     9988    3             VECTOR(WAKE_UP));
      406     9989
      407     9990    3           END/*action rcq*/;

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:81   
   9990  3 000462   000751 710000 3                  TRA     s:10023

      408     9991
      409     9992    3      ELSE DO;

      410     9993    3           CALL DBM$PACK2(KNH$QHDR.SCQ.IPTR,INSERT$);

   9993  3 000463   200020 630500                    EPPR0   INSERT$,,AUTO
         3 000464   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000465   200032 631500                    EPPR1   KNH$QHDR+2,,AUTO
         3 000466   200102 451500                    STP1    KNH$MESS+4,,AUTO
         3 000467   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000470   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000471   000000 701000 xent               TSX1    DBM$PACK2
         3 000472   000000 011000                    NOP     0

      411     9994    3           CALL DBM$PACK2(KNH$QHDR.SCQ.RPTR,REMOVE$);

   9994  3 000473   200021 630500                    EPPR0   REMOVE$,,AUTO
         3 000474   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000475   200104 452500                    STP2    KNH$MESS+6,,AUTO
         3 000476   200104 236100                    LDQ     KNH$MESS+6,,AUTO
         3 000477   000036 036000 4                  ADLQ    30
         3 000500   200102 756100                    STQ     KNH$MESS+4,,AUTO
         3 000501   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000502   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000503   000000 701000 xent               TSX1    DBM$PACK2
         3 000504   000000 011000                    NOP     0

      412     9995    3           CALL DBM$PACK2(KNH$QHDR.SCQ.SZ,CQ_WDSZ);

   9995  3 000505   200023 630500                    EPPR0   CQ_WDSZ,,AUTO
         3 000506   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000507   200033 631500                    EPPR1   KNH$QHDR+3,,AUTO
         3 000510   200102 451500                    STP1    KNH$MESS+4,,AUTO
         3 000511   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000512   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:82   
         3 000513   000000 701000 xent               TSX1    DBM$PACK2
         3 000514   000000 011000                    NOP     0

      413     9996    3           CALL DBM$PACK2(KNH$QHDR.SCQ.OFFSET,CQ_OFFSET);

   9996  3 000515   200024 630500                    EPPR0   CQ_OFFSET,,AUTO
         3 000516   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000517   200104 452500                    STP2    KNH$MESS+6,,AUTO
         3 000520   200104 236100                    LDQ     KNH$MESS+6,,AUTO
         3 000521   000037 036000 4                  ADLQ    31
         3 000522   200102 756100                    STQ     KNH$MESS+4,,AUTO
         3 000523   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000524   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000525   000000 701000 xent               TSX1    DBM$PACK2
         3 000526   000000 011000                    NOP     0

      414     9997    3           CALL DBM$PACK2(KNH$QHDR.LAST_SCQPTR,LAST$);

   9997  3 000527   200022 630500                    EPPR0   LAST$,,AUTO
         3 000530   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 000531   200104 452500                    STP2    KNH$MESS+6,,AUTO
         3 000532   200104 236100                    LDQ     KNH$MESS+6,,AUTO
         3 000533   000040 036000 4                  ADLQ    32
         3 000534   200102 756100                    STQ     KNH$MESS+4,,AUTO
         3 000535   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 000536   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000537   000000 701000 xent               TSX1    DBM$PACK2
         3 000540   000000 011000                    NOP     0

      415     9998
      416     9999    3           IF KNH$QHDR.CTX.WU = '1'B

   9999  3 000541   200034 236100                    LDQ     KNH$QHDR+4,,AUTO
         3 000542   000001 316007                    CANQ    1,DL
         3 000543   000547 600000 3                  TZE     s:10002

      417    10000    3           THEN WAKE_UP = 'WakeUp  ';
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:83   

  10000  3 000544   040100 100400                    MLR     fill='040'O
         3 000545   000265 000010 2                  ADSC9   KN_NAMTXT_FCN+60         cn=0,n=8
         3 000546   200025 000010                    ADSC9   WAKE_UP,,AUTO            cn=0,n=8

      418    10001
      419    10002    3           INSERT$ = (INSERT$ *2) + CQ_OFFSET + DB_HANDQ$;

  10002  3 000547   200020 236100                    LDQ     INSERT$,,AUTO
         3 000550   000001 736000                    QLS     1
         3 000551   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 000552   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000553   200020 756100                    STQ     INSERT$,,AUTO

      420    10003    3           REMOVE$ = (REMOVE$ *2) + CQ_OFFSET + DB_HANDQ$;

  10003  3 000554   200021 236100                    LDQ     REMOVE$,,AUTO
         3 000555   000001 736000                    QLS     1
         3 000556   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 000557   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000560   200021 756100                    STQ     REMOVE$,,AUTO

      421    10004    3           LAST$ = (LAST$ *2) + CQ_OFFSET + DB_HANDQ$;

  10004  3 000561   200022 236100                    LDQ     LAST$,,AUTO
         3 000562   000001 736000                    QLS     1
         3 000563   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 000564   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 000565   200022 756100                    STQ     LAST$,,AUTO

      422    10005    3           CQ_WDSZ = (CQ_WDSZ *2);

  10005  3 000566   200023 235100                    LDA     CQ_WDSZ,,AUTO
         3 000567   000001 735000                    ALS     1
         3 000570   200023 755100                    STA     CQ_WDSZ,,AUTO

      423    10006
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:84   
      424    10007    3           CALL DAF$WRITE(VECTOR(SCQ_RPT20) ,VECTOR(THIS_USER));

  10007  3 000571   777640 235007                    LDA     -96,DL
         3 000572   200102 452500                    STP2    KNH$MESS+4,,AUTO
         3 000573   200102 236100                    LDQ     KNH$MESS+4,,AUTO
         3 000574   000011 036003                    ADLQ    9,DU
         3 000575   200104 757100                    STAQ    KNH$MESS+6,,AUTO
         3 000576   200104 630500                    EPPR0   KNH$MESS+6,,AUTO
         3 000577   200107 450500                    STP0    KNH$MESS+9,,AUTO
         3 000600   000041 236000 4                  LDQ     33
         3 000601   200106 756100                    STQ     KNH$MESS+8,,AUTO
         3 000602   200106 630500                    EPPR0   KNH$MESS+8,,AUTO
         3 000603   000000 220000 xsym               LDX0    DAF$WRITE
         3 000604   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000605   000000 701010                    TSX1    0,X0
         3 000606   000000 011000                    NOP     0

      425    10008    3           CALL DAF$WRITE(VECTOR(CQ_RPT21));

  10008  3 000607   000024 630400 4                  EPPR0   20
         3 000610   000000 220000 xsym               LDX0    DAF$WRITE
         3 000611   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000612   000000 701010                    TSX1    0,X0
         3 000613   000000 011000                    NOP     0

      426    10009    3           CALL DAF$WRITE(VECTOR(CQ_RPT22));

  10009  3 000614   000030 630400 4                  EPPR0   24
         3 000615   000000 220000 xsym               LDX0    DAF$WRITE
         3 000616   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000617   000000 701010                    TSX1    0,X0
         3 000620   000000 011000                    NOP     0

      427    10010    3           CALL DAF$WRITE(VECTOR(CQ_FMT2),
      428    10011    3             VECTOR(INSERT$),
      429    10012    3             VECTOR(REMOVE$),
      430    10013    3             VECTOR(CQ_WDSZ),
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:85   
      431    10014    3             VECTOR(CQ_OFFSET),
      432    10015    3             VECTOR(LAST$),
      433    10016    3             VECTOR(KNH$QHDR.MSGS_SCQ),
      434    10017    3             VECTOR(KNH$QHDR.MBC_SCQ),
      435    10018    3             VECTOR(KNH$QHDR.WRAP_SCQ),

  10018  3 000621   777640 235007                    LDA     -96,DL
         3 000622   200102 452500                    STP2    KNH$MESS+4,,AUTO
         3 000623   200102 236100                    LDQ     KNH$MESS+4,,AUTO
         3 000624   000020 036003                    ADLQ    16,DU
         3 000625   200104 757100                    STAQ    KNH$MESS+6,,AUTO
         3 000626   777640 235007                    LDA     -96,DL
         3 000627   200106 452500                    STP2    KNH$MESS+8,,AUTO
         3 000630   200106 236100                    LDQ     KNH$MESS+8,,AUTO
         3 000631   000021 036003                    ADLQ    17,DU
         3 000632   200110 757100                    STAQ    KNH$MESS+10,,AUTO
         3 000633   777640 235007                    LDA     -96,DL
         3 000634   200112 452500                    STP2    KNH$MESS+12,,AUTO
         3 000635   200112 236100                    LDQ     KNH$MESS+12,,AUTO
         3 000636   000023 036003                    ADLQ    19,DU
         3 000637   200114 757100                    STAQ    KNH$MESS+14,,AUTO
         3 000640   777640 235007                    LDA     -96,DL
         3 000641   200116 452500                    STP2    KNH$MESS+16,,AUTO
         3 000642   200116 236100                    LDQ     KNH$MESS+16,,AUTO
         3 000643   000024 036003                    ADLQ    20,DU
         3 000644   200120 757100                    STAQ    KNH$MESS+18,,AUTO
         3 000645   777640 235007                    LDA     -96,DL
         3 000646   200122 452500                    STP2    KNH$MESS+20,,AUTO
         3 000647   200122 236100                    LDQ     KNH$MESS+20,,AUTO
         3 000650   000022 036003                    ADLQ    18,DU
         3 000651   200124 757100                    STAQ    KNH$MESS+22,,AUTO
         3 000652   777640 235007                    LDA     -96,DL
         3 000653   200126 452500                    STP2    KNH$MESS+24,,AUTO
         3 000654   200126 236100                    LDQ     KNH$MESS+24,,AUTO
         3 000655   000035 036003                    ADLQ    29,DU
         3 000656   200130 757100                    STAQ    KNH$MESS+26,,AUTO
         3 000657   777640 235007                    LDA     -96,DL
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:86   
         3 000660   200132 452500                    STP2    KNH$MESS+28,,AUTO
         3 000661   200132 236100                    LDQ     KNH$MESS+28,,AUTO
         3 000662   000036 036003                    ADLQ    30,DU
         3 000663   200134 757100                    STAQ    KNH$MESS+30,,AUTO
         3 000664   777640 235007                    LDA     -96,DL
         3 000665   200136 452500                    STP2    KNH$MESS+32,,AUTO
         3 000666   200136 236100                    LDQ     KNH$MESS+32,,AUTO
         3 000667   000037 036003                    ADLQ    31,DU
         3 000670   200140 757100                    STAQ    KNH$MESS+34,,AUTO
         3 000671   000034 235000 4                  LDA     28
         3 000672   200142 452500                    STP2    KNH$MESS+36,,AUTO
         3 000673   200142 236100                    LDQ     KNH$MESS+36,,AUTO
         3 000674   000025 036003                    ADLQ    21,DU
         3 000675   200146 757100                    STAQ    KNH$MESS+40,,AUTO
         3 000676   200104 237100                    LDAQ    KNH$MESS+6,,AUTO
         3 000677   200144 757100                    STAQ    KNH$MESS+38,,AUTO
         3 000700   200110 237100                    LDAQ    KNH$MESS+10,,AUTO
         3 000701   200150 757100                    STAQ    KNH$MESS+42,,AUTO
         3 000702   200114 237100                    LDAQ    KNH$MESS+14,,AUTO
         3 000703   200152 757100                    STAQ    KNH$MESS+44,,AUTO
         3 000704   200120 237100                    LDAQ    KNH$MESS+18,,AUTO
         3 000705   200154 757100                    STAQ    KNH$MESS+46,,AUTO
         3 000706   200124 237100                    LDAQ    KNH$MESS+22,,AUTO
         3 000707   200156 757100                    STAQ    KNH$MESS+48,,AUTO
         3 000710   200130 237100                    LDAQ    KNH$MESS+26,,AUTO
         3 000711   200160 757100                    STAQ    KNH$MESS+50,,AUTO
         3 000712   200134 237100                    LDAQ    KNH$MESS+30,,AUTO
         3 000713   200162 757100                    STAQ    KNH$MESS+52,,AUTO
         3 000714   200140 237100                    LDAQ    KNH$MESS+34,,AUTO
         3 000715   200164 757100                    STAQ    KNH$MESS+54,,AUTO
         3 000716   200146 237100                    LDAQ    KNH$MESS+40,,AUTO
         3 000717   200166 757100                    STAQ    KNH$MESS+56,,AUTO
         3 000720   200166 630500                    EPPR0   KNH$MESS+56,,AUTO
         3 000721   200201 450500                    STP0    KNH$MESS+67,,AUTO
         3 000722   200164 631500                    EPPR1   KNH$MESS+54,,AUTO
         3 000723   200200 451500                    STP1    KNH$MESS+66,,AUTO
         3 000724   200162 633500                    EPPR3   KNH$MESS+52,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:87   
         3 000725   200177 453500                    STP3    KNH$MESS+65,,AUTO
         3 000726   200160 634500                    EPPR4   KNH$MESS+50,,AUTO
         3 000727   200176 454500                    STP4    KNH$MESS+64,,AUTO
         3 000730   200156 635500                    EPPR5   KNH$MESS+48,,AUTO
         3 000731   200175 455500                    STP5    KNH$MESS+63,,AUTO
         3 000732   200154 636500                    EPPR6   KNH$MESS+46,,AUTO
         3 000733   200174 456500                    STP6    KNH$MESS+62,,AUTO
         3 000734   200152 637500                    EPPR7   KNH$MESS+44,,AUTO
         3 000735   200173 457500                    STP7    KNH$MESS+61,,AUTO
         3 000736   200150 630500                    EPPR0   KNH$MESS+42,,AUTO
         3 000737   200172 450500                    STP0    KNH$MESS+60,,AUTO
         3 000740   200144 630500                    EPPR0   KNH$MESS+38,,AUTO
         3 000741   200171 450500                    STP0    KNH$MESS+59,,AUTO
         3 000742   000035 236000 4                  LDQ     29
         3 000743   200170 756100                    STQ     KNH$MESS+58,,AUTO
         3 000744   200170 630500                    EPPR0   KNH$MESS+58,,AUTO
         3 000745   000000 220000 xsym               LDX0    DAF$WRITE
         3 000746   000005 631400 4                  EPPR1   5
         3 000747   000000 701010                    TSX1    0,X0
         3 000750   000000 011000                    NOP     0

      436    10019    3             VECTOR(WAKE_UP));
      437    10020
      438    10021    3           END/*action scq*/;

      439    10022
      440    10023    2      CALL DAF$WRITE(VECTOR(BLANK_LINE));

  10023  3 000751   000004 630400 4                  EPPR0   4
         3 000752   000000 220000 xsym               LDX0    DAF$WRITE
         3 000753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000754   000000 701010                    TSX1    0,X0
         3 000755   000000 011000                    NOP     0

      441    10024
      442    10025    2      CALL DBD$CQ_MESSAGE;

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:88   
  10025  3 000756   000762 701000 3                  TSX1    DBD$CQ_MESSAGE
         3 000757   000000 011000                    NOP     0

      443    10026    2      RETURN;

  10026  3 000760   200052 221300                    LDX1  ! KNH$QHDR+18,,AUTO
         3 000761   000001 702211                    TSX2  ! 1,X1

      444    10027    2   END DISPCQ;
      445    10028        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:89   
      446    10029    1   DBD$CQ_MESSAGE: PROC ALTRET;

  10029  3 000762   200054 741300       DBD$CQ_MESS* STX1  ! KNH$QHDR+20,,AUTO

      447    10030
      448    10031
      449    10032                                                /* CONSTANT Data                      */
      450    10033
      451    10034    2   DCL CQM_RPT1 CHAR(0) CONSTANT INIT(
      452    10035    2   'Msg$   Function Rectype LDCT# User ID  Free  Last$  Fpt$   Fptsz Mess$  Msgsz');
      453    10036
      454    10037    2   DCL CQM_RPT2 CHAR(0) CONSTANT INIT(
      455    10038    2   '------ -------- ------- ----- --------- ---- ------ ------ ----- ------ -----');
      456    10039
      457    10040    2   DCL CQM_FMT1 CHAR(0) CONSTANT INIT(
      458    10041    2   '.%5ZH %A %@7.16D %@5.16D .%@8.32ZH %A .%5ZH .%5ZH .%4ZH .%5ZH .%4ZH');
      459    10042
      460    10043        %KN_NAMTXT_FCN;
      461    10065
      462    10066                                                /* AUTO Stroage                       */
      463    10067    2   DCL 1 FUNCTION,
      464    10068    2         2 X,
      465    10069    2           3 * CHAR(7) UNAL,
      466    10070    2           3 X CHAR(8) UNAL,
      467    10071    2         2 TXT REDEF X CHAR(15) CALIGNED;
      468    10072    2   DCL FREE CHAR(4);
      469    10073    2   DCL I UBIN;
      470    10074    2   DCL MESSAGE$ UBIN;
      471    10075    2   DCL MSG_LAST$ UBIN;
      472    10076    2   DCL FPT$ UBIN;
      473    10077    2   DCL MSG$ UBIN;
      474    10078    2   DCL FPTSZ UBIN;
      475    10079    2   DCL MSGSZ UBIN;
      476    10080    2   DCL MESS_SZ UBIN;
      477    10081    2   DCL HDRSZ UBIN;
      478    10082    2   DCL INIT$ UBIN;
      479    10083    2   DCL RESET$ UBIN;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:90   
      480    10084    2   DCL END_IT UBIN;
      481    10085
      482    10086        %KNH$MESS (STCLASS=AUTO);
      483    10135
      484    10136        %EJECT;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:91   
      485    10137    2      IF DOING_LAST = 0

  10137  3 000763   200007 235100                    LDA     DOING_LAST,,AUTO
         3 000764   000773 601000 3                  TNZ     s:10143

      486    10138    3      THEN DO;

      487    10139    3           IF REMOVE$ = INSERT$ THEN RETURN;

  10139  3 000765   200021 236100                    LDQ     REMOVE$,,AUTO
         3 000766   200020 116100                    CMPQ    INSERT$,,AUTO
         3 000767   000771 601000 3                  TNZ     s:10140

  10139  3 000770   000001 702211                    TSX2  ! 1,X1

      488    10140    3           MESSAGE$ = REMOVE$;

  10140  3 000771   200063 756100                    STQ     MESSAGE$,,AUTO

      489    10141    3           END;

  10141  3 000772   000776 710000 3                  TRA     s:10146

      490    10142    3      ELSE DO;

      491    10143    3           MESSAGE$ = LAST$;

  10143  3 000773   200022 236100                    LDQ     LAST$,,AUTO
         3 000774   200063 756100                    STQ     MESSAGE$,,AUTO

      492    10144    3           END_IT = 0;

  10144  3 000775   200075 450100                    STZ     END_IT,,AUTO

      493    10145    3           END;

      494    10146    2      INIT$ = DB_HANDQ$ + CQ_OFFSET;
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:92   

  10146  3 000776   000000 236000 xsym               LDQ     DB_HANDQ$
         3 000777   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 001000   200073 756100                    STQ     INIT$,,AUTO

      495    10147    2      RESET$ = DB_HANDQ$ + CQ_OFFSET + CQ_WDSZ;

  10147  3 001001   000000 236000 xsym               LDQ     DB_HANDQ$
         3 001002   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 001003   200023 036100                    ADLQ    CQ_WDSZ,,AUTO
         3 001004   200074 756100                    STQ     RESET$,,AUTO

      496    10148    2      HDRSZ = (SIZEC(KNH$MESS) +1) / 2;

  10148  3 001005   000010 235007                    LDA     8,DL
         3 001006   200072 755100                    STA     HDRSZ,,AUTO

      497    10149
      498    10150    2      CALL DAF$WRITE(VECTOR(CQM_RPT1));

  10150  3 001007   000046 630400 4                  EPPR0   38
         3 001010   000000 220000 xsym               LDX0    DAF$WRITE
         3 001011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001012   000000 701010                    TSX1    0,X0
         3 001013   000000 011000                    NOP     0

      499    10151    2      CALL DAF$WRITE(VECTOR(CQM_RPT2));

  10151  3 001014   000052 630400 4                  EPPR0   42
         3 001015   000000 220000 xsym               LDX0    DAF$WRITE
         3 001016   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001017   000000 701010                    TSX1    0,X0
         3 001020   000000 011000                    NOP     0

      500    10152
      501    10153    3      DO WHILE (MESSAGE$ ~= INSERT$);

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:93   
  10153  3 001021   200063 236100                    LDQ     MESSAGE$,,AUTO
         3 001022   200020 116100                    CMPQ    INSERT$,,AUTO
         3 001023   001420 600000 3                  TZE     s:10207

      502    10154
      503    10155    3          CALL DBM$GETMEM(MESSAGE$,KNH$MESS,USER#,SIZEC(KNH$MESS),,SIZEC(KNH$MESS),,1,
             10155                    0)

  10155  3 001024   000055 236000 4                  LDQ     45
         3 001025   200112 756100                    STQ     KNH$MESS+12,,AUTO
         3 001026   000010 236000 4                  LDQ     8
         3 001027   000001 235000 xsym               LDA     B_VECTNIL+1
         3 001030   200110 757100                    STAQ    KNH$MESS+10,,AUTO
         3 001031   000056 236000 4                  LDQ     46
         3 001032   000001 235000 xsym               LDA     B_VECTNIL+1
         3 001033   200106 757100                    STAQ    KNH$MESS+8,,AUTO
         3 001034   000056 236000 4                  LDQ     46
         3 001035   200105 756100                    STQ     KNH$MESS+7,,AUTO
         3 001036   200014 630500                    EPPR0   USER#,,AUTO
         3 001037   200104 450500                    STP0    KNH$MESS+6,,AUTO
         3 001040   200076 631500                    EPPR1   KNH$MESS,,AUTO
         3 001041   200103 451500                    STP1    KNH$MESS+5,,AUTO
         3 001042   200063 633500                    EPPR3   MESSAGE$,,AUTO
         3 001043   200102 453500                    STP3    KNH$MESS+4,,AUTO
         3 001044   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 001045   000053 631400 4                  EPPR1   43
         3 001046   000000 701000 xent               TSX1    DBM$GETMEM
         3 001047   001051 702000 3                  TSX2    s:10156
         3 001050   001053 710000 3                  TRA     s:10159

      504    10156    4           WHENALTRETURN DO; ALTRETURN; END;

  10156  3 001051   200054 221300                    LDX1  ! KNH$QHDR+20,,AUTO
         3 001052   000000 702211                    TSX2  ! 0,X1

      505    10157
      506    10158
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:94   
      507    10159    3           IF KNH$MESS.FLAGS.FREE THEN FREE=' Yes'; ELSE FREE=' No ';

  10159  3 001053   200076 236100                    LDQ     KNH$MESS,,AUTO
         3 001054   200000 316003                    CANQ    65536,DU
         3 001055   001061 600000 3                  TZE     s:10159+6

  10159  3 001056   000267 236000 2                  LDQ     KN_NAMTXT_FCN+62
         3 001057   200061 756100                    STQ     FREE,,AUTO
         3 001060   001063 710000 3                  TRA     s:10160

  10159  3 001061   000270 236000 2                  LDQ     KN_NAMTXT_FCN+63
         3 001062   200061 756100                    STQ     FREE,,AUTO

      508    10160    3           KNH$MESS.FLAGS.FREE = '0'B;

  10160  3 001063   000057 236000 4                  LDQ     47
         3 001064   200076 356100                    ANSQ    KNH$MESS,,AUTO

      509    10161
      510    10162    3           CALL DBM$PACK2(KNH$MESS.FUNCTION,I);

  10162  3 001065   200062 630500                    EPPR0   I,,AUTO
         3 001066   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 001067   200076 631500                    EPPR1   KNH$MESS,,AUTO
         3 001070   200102 451500                    STP1    KNH$MESS+4,,AUTO
         3 001071   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 001072   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001073   000000 701000 xent               TSX1    DBM$PACK2
         3 001074   000000 011000                    NOP     0

      511    10163    3           IF I <= %KN_FCN_MAX

  10163  3 001075   200062 235100                    LDA     I,,AUTO
         3 001076   000020 115007                    CMPA    16,DL
         3 001077   001106 603000 3                  TRC     s:10165

      512    10164    3           THEN FUNCTION.TXT = KN_NAMTXT_FCN.TXT(I);
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:95   

  10164  3 001100   200062 236100                    LDQ     I,,AUTO
         3 001101   000017 402007                    MPY     15,DL
         3 001102   040100 100406                    MLR     fill='040'O
         3 001103   000171 000017 2                  ADSC9   KN_NAMTXT_FCN,Q          cn=0,n=15
         3 001104   200055 000017                    ADSC9   FUNCTION,,AUTO           cn=0,n=15
         3 001105   001113 710000 3                  TRA     s:10167

      513    10165    3           ELSE CALL BINCHAR(FUNCTION.X.X,I);

  10165  3 001106   000044 773000                    LRL     36
         3 001107   200102 757100                    STAQ    KNH$MESS+4,,AUTO
         3 001110   000100 301500                    BTD
         3 001111   200102 000010                    NDSC9   KNH$MESS+4,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         3 001112   200056 630010                    NDSC9   FUNCTION+1,,AUTO         cn=3,s=nosgn,sf=0,n=8

      514    10166
      515    10167    3           CALL DBM$PACK2(KNH$MESS.LAST_PTR,MSG_LAST$);

  10167  3 001113   200064 630500                    EPPR0   MSG_LAST$,,AUTO
         3 001114   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 001115   200104 452500                    STP2    KNH$MESS+6,,AUTO
         3 001116   200104 236100                    LDQ     KNH$MESS+6,,AUTO
         3 001117   000060 036000 4                  ADLQ    48
         3 001120   200102 756100                    STQ     KNH$MESS+4,,AUTO
         3 001121   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 001122   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001123   000000 701000 xent               TSX1    DBM$PACK2
         3 001124   000000 011000                    NOP     0

      516    10168    3           CALL DBM$PACK2(KNH$MESS.FPTSZ,FPTSZ);

  10168  3 001125   200067 630500                    EPPR0   FPTSZ,,AUTO
         3 001126   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 001127   200101 631500                    EPPR1   KNH$MESS+3,,AUTO
         3 001130   200102 451500                    STP1    KNH$MESS+4,,AUTO
         3 001131   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:96   
         3 001132   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001133   000000 701000 xent               TSX1    DBM$PACK2
         3 001134   000000 011000                    NOP     0

      517    10169    3           CALL DBM$PACK2(KNH$MESS.MSGSZ,MSGSZ);

  10169  3 001135   200070 630500                    EPPR0   MSGSZ,,AUTO
         3 001136   200103 450500                    STP0    KNH$MESS+5,,AUTO
         3 001137   200104 452500                    STP2    KNH$MESS+6,,AUTO
         3 001140   200104 236100                    LDQ     KNH$MESS+6,,AUTO
         3 001141   000061 036000 4                  ADLQ    49
         3 001142   200102 756100                    STQ     KNH$MESS+4,,AUTO
         3 001143   200102 630500                    EPPR0   KNH$MESS+4,,AUTO
         3 001144   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001145   000000 701000 xent               TSX1    DBM$PACK2
         3 001146   000000 011000                    NOP     0

      518    10170
      519    10171    3           MSG_LAST$ = (MSG_LAST$ *2) + CQ_OFFSET + DB_HANDQ$;

  10171  3 001147   200064 236100                    LDQ     MSG_LAST$,,AUTO
         3 001150   000001 736000                    QLS     1
         3 001151   200024 036100                    ADLQ    CQ_OFFSET,,AUTO
         3 001152   000000 036000 xsym               ADLQ    DB_HANDQ$
         3 001153   200064 756100                    STQ     MSG_LAST$,,AUTO

      520    10172
      521    10173    3           FPTSZ = (FPTSZ +1) /2;

  10173  3 001154   200067 236100                    LDQ     FPTSZ,,AUTO
         3 001155   000001 036007                    ADLQ    1,DL
         3 001156   000001 772000                    QRL     1
         3 001157   200067 756100                    STQ     FPTSZ,,AUTO

      522    10174    3           MSGSZ = (MSGSZ +1) /2;

  10174  3 001160   200070 236100                    LDQ     MSGSZ,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:97   
         3 001161   000001 036007                    ADLQ    1,DL
         3 001162   000001 772000                    QRL     1
         3 001163   200070 756100                    STQ     MSGSZ,,AUTO

      523    10175    3           MESS_SZ =( (HDRSZ + FPTSZ + MSGSZ +1) /2) * 2;

  10175  3 001164   200072 236100                    LDQ     HDRSZ,,AUTO
         3 001165   200067 036100                    ADLQ    FPTSZ,,AUTO
         3 001166   200070 036100                    ADLQ    MSGSZ,,AUTO
         3 001167   000001 036007                    ADLQ    1,DL
         3 001170   000001 772000                    QRL     1
         3 001171   000001 736000                    QLS     1
         3 001172   200071 756100                    STQ     MESS_SZ,,AUTO

      524    10176
      525    10177    3           IF FPTSZ = 0

  10177  3 001173   200067 235100                    LDA     FPTSZ,,AUTO
         3 001174   001177 601000 3                  TNZ     s:10179

      526    10178    3           THEN FPT$ = 0;

  10178  3 001175   200065 450100                    STZ     FPT$,,AUTO
         3 001176   001202 710000 3                  TRA     s:10181

      527    10179    3           ELSE FPT$ = MESSAGE$ + HDRSZ;

  10179  3 001177   200063 236100                    LDQ     MESSAGE$,,AUTO
         3 001200   200072 036100                    ADLQ    HDRSZ,,AUTO
         3 001201   200065 756100                    STQ     FPT$,,AUTO

      528    10180
      529    10181    3           IF MSGSZ = 0

  10181  3 001202   200070 236100                    LDQ     MSGSZ,,AUTO
         3 001203   001206 601000 3                  TNZ     s:10183

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:98   
      530    10182    3           THEN MSG$ = 0;

  10182  3 001204   200066 450100                    STZ     MSG$,,AUTO
         3 001205   001212 710000 3                  TRA     s:10188

      531    10183    3           ELSE MSG$ = MESSAGE$ + HDRSZ + FPTSZ;

  10183  3 001206   200063 236100                    LDQ     MESSAGE$,,AUTO
         3 001207   200072 036100                    ADLQ    HDRSZ,,AUTO
         3 001210   200067 036100                    ADLQ    FPTSZ,,AUTO
         3 001211   200066 756100                    STQ     MSG$,,AUTO

      532    10184
      533    10185    3           CALL DAF$WRITE(VECTOR(CQM_FMT1),
      534    10186    3             VECTOR(MESSAGE$), VECTOR(FUNCTION.X.X), VECTOR(KNH$MESS.RECTYPE),
      535    10187    3             VECTOR(KNH$MESS.LDCTX), VECTOR(KNH$MESS.UID), VECTOR(FREE),
      536    10188    3             VECTOR(MSG_LAST$), VECTOR(FPT$), VECTOR(FPTSZ),

  10188  3 001212   777640 235007                    LDA     -96,DL
         3 001213   200102 452500                    STP2    KNH$MESS+4,,AUTO
         3 001214   200102 236100                    LDQ     KNH$MESS+4,,AUTO
         3 001215   000063 036003                    ADLQ    51,DU
         3 001216   200104 757100                    STAQ    KNH$MESS+6,,AUTO
         3 001217   000034 235000 4                  LDA     28
         3 001220   200106 452500                    STP2    KNH$MESS+8,,AUTO
         3 001221   200106 236100                    LDQ     KNH$MESS+8,,AUTO
         3 001222   000064 036000 4                  ADLQ    52
         3 001223   200110 757100                    STAQ    KNH$MESS+10,,AUTO
         3 001224   377640 235007                    LDA     130976,DL
         3 001225   200112 452500                    STP2    KNH$MESS+12,,AUTO
         3 001226   200112 236100                    LDQ     KNH$MESS+12,,AUTO
         3 001227   000100 036003                    ADLQ    64,DU
         3 001230   200114 757100                    STAQ    KNH$MESS+14,,AUTO
         3 001231   377640 235007                    LDA     130976,DL
         3 001232   200116 452500                    STP2    KNH$MESS+16,,AUTO
         3 001233   200116 236100                    LDQ     KNH$MESS+16,,AUTO
         3 001234   000065 036000 4                  ADLQ    53
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:99   
         3 001235   200120 757100                    STAQ    KNH$MESS+18,,AUTO
         3 001236   777640 235007                    LDA     -96,DL
         3 001237   200122 452500                    STP2    KNH$MESS+20,,AUTO
         3 001240   200122 236100                    LDQ     KNH$MESS+20,,AUTO
         3 001241   000077 036003                    ADLQ    63,DU
         3 001242   200124 757100                    STAQ    KNH$MESS+22,,AUTO
         3 001243   777640 235007                    LDA     -96,DL
         3 001244   200126 452500                    STP2    KNH$MESS+24,,AUTO
         3 001245   200126 236100                    LDQ     KNH$MESS+24,,AUTO
         3 001246   000061 036003                    ADLQ    49,DU
         3 001247   200130 757100                    STAQ    KNH$MESS+26,,AUTO
         3 001250   777640 235007                    LDA     -96,DL
         3 001251   200132 452500                    STP2    KNH$MESS+28,,AUTO
         3 001252   200132 236100                    LDQ     KNH$MESS+28,,AUTO
         3 001253   000064 036003                    ADLQ    52,DU
         3 001254   200134 757100                    STAQ    KNH$MESS+30,,AUTO
         3 001255   777640 235007                    LDA     -96,DL
         3 001256   200136 452500                    STP2    KNH$MESS+32,,AUTO
         3 001257   200136 236100                    LDQ     KNH$MESS+32,,AUTO
         3 001260   000065 036003                    ADLQ    53,DU
         3 001261   200140 757100                    STAQ    KNH$MESS+34,,AUTO
         3 001262   777640 235007                    LDA     -96,DL
         3 001263   200142 452500                    STP2    KNH$MESS+36,,AUTO
         3 001264   200142 236100                    LDQ     KNH$MESS+36,,AUTO
         3 001265   000067 036003                    ADLQ    55,DU
         3 001266   200144 757100                    STAQ    KNH$MESS+38,,AUTO
         3 001267   777640 235007                    LDA     -96,DL
         3 001270   200146 452500                    STP2    KNH$MESS+40,,AUTO
         3 001271   200146 236100                    LDQ     KNH$MESS+40,,AUTO
         3 001272   000066 036003                    ADLQ    54,DU
         3 001273   200150 757100                    STAQ    KNH$MESS+42,,AUTO
         3 001274   777640 235007                    LDA     -96,DL
         3 001275   200152 452500                    STP2    KNH$MESS+44,,AUTO
         3 001276   200152 236100                    LDQ     KNH$MESS+44,,AUTO
         3 001277   000070 036003                    ADLQ    56,DU
         3 001300   200156 757100                    STAQ    KNH$MESS+48,,AUTO
         3 001301   200104 237100                    LDAQ    KNH$MESS+6,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:100  
         3 001302   200154 757100                    STAQ    KNH$MESS+46,,AUTO
         3 001303   200110 237100                    LDAQ    KNH$MESS+10,,AUTO
         3 001304   200160 757100                    STAQ    KNH$MESS+50,,AUTO
         3 001305   200114 237100                    LDAQ    KNH$MESS+14,,AUTO
         3 001306   200162 757100                    STAQ    KNH$MESS+52,,AUTO
         3 001307   200120 237100                    LDAQ    KNH$MESS+18,,AUTO
         3 001310   200164 757100                    STAQ    KNH$MESS+54,,AUTO
         3 001311   200124 237100                    LDAQ    KNH$MESS+22,,AUTO
         3 001312   200166 757100                    STAQ    KNH$MESS+56,,AUTO
         3 001313   200130 237100                    LDAQ    KNH$MESS+26,,AUTO
         3 001314   200170 757100                    STAQ    KNH$MESS+58,,AUTO
         3 001315   200134 237100                    LDAQ    KNH$MESS+30,,AUTO
         3 001316   200172 757100                    STAQ    KNH$MESS+60,,AUTO
         3 001317   200140 237100                    LDAQ    KNH$MESS+34,,AUTO
         3 001320   200174 757100                    STAQ    KNH$MESS+62,,AUTO
         3 001321   200144 237100                    LDAQ    KNH$MESS+38,,AUTO
         3 001322   200176 757100                    STAQ    KNH$MESS+64,,AUTO
         3 001323   200150 237100                    LDAQ    KNH$MESS+42,,AUTO
         3 001324   200200 757100                    STAQ    KNH$MESS+66,,AUTO
         3 001325   200156 237100                    LDAQ    KNH$MESS+48,,AUTO
         3 001326   200202 757100                    STAQ    KNH$MESS+68,,AUTO
         3 001327   200202 630500                    EPPR0   KNH$MESS+68,,AUTO
         3 001330   200217 450500                    STP0    KNH$MESS+81,,AUTO
         3 001331   200200 631500                    EPPR1   KNH$MESS+66,,AUTO
         3 001332   200216 451500                    STP1    KNH$MESS+80,,AUTO
         3 001333   200176 633500                    EPPR3   KNH$MESS+64,,AUTO
         3 001334   200215 453500                    STP3    KNH$MESS+79,,AUTO
         3 001335   200174 634500                    EPPR4   KNH$MESS+62,,AUTO
         3 001336   200214 454500                    STP4    KNH$MESS+78,,AUTO
         3 001337   200172 635500                    EPPR5   KNH$MESS+60,,AUTO
         3 001340   200213 455500                    STP5    KNH$MESS+77,,AUTO
         3 001341   200170 636500                    EPPR6   KNH$MESS+58,,AUTO
         3 001342   200212 456500                    STP6    KNH$MESS+76,,AUTO
         3 001343   200166 637500                    EPPR7   KNH$MESS+56,,AUTO
         3 001344   200211 457500                    STP7    KNH$MESS+75,,AUTO
         3 001345   200164 630500                    EPPR0   KNH$MESS+54,,AUTO
         3 001346   200210 450500                    STP0    KNH$MESS+74,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:101  
         3 001347   200162 630500                    EPPR0   KNH$MESS+52,,AUTO
         3 001350   200207 450500                    STP0    KNH$MESS+73,,AUTO
         3 001351   200160 630500                    EPPR0   KNH$MESS+50,,AUTO
         3 001352   200206 450500                    STP0    KNH$MESS+72,,AUTO
         3 001353   200154 630500                    EPPR0   KNH$MESS+46,,AUTO
         3 001354   200205 450500                    STP0    KNH$MESS+71,,AUTO
         3 001355   000067 236000 4                  LDQ     55
         3 001356   200204 756100                    STQ     KNH$MESS+70,,AUTO
         3 001357   200204 630500                    EPPR0   KNH$MESS+70,,AUTO
         3 001360   000000 220000 xsym               LDX0    DAF$WRITE
         3 001361   000066 631400 4                  EPPR1   54
         3 001362   000000 701010                    TSX1    0,X0
         3 001363   000000 011000                    NOP     0

      537    10189    3             VECTOR(MSG$), VECTOR(MSGSZ));
      538    10190
      539    10191    3           IF DOING_LAST = 0

  10191  3 001364   200007 235100                    LDA     DOING_LAST,,AUTO
         3 001365   001376 601000 3                  TNZ     s:10198

      540    10192    4           THEN DO;

      541    10193    4                MESSAGE$ = MESSAGE$ + MESS_SZ;

  10193  3 001366   200063 236100                    LDQ     MESSAGE$,,AUTO
         3 001367   200071 036100                    ADLQ    MESS_SZ,,AUTO
         3 001370   200063 756100                    STQ     MESSAGE$,,AUTO

      542    10194    4                IF MESSAGE$ >= RESET$

  10194  3 001371   200074 116100                    CMPQ    RESET$,,AUTO
         3 001372   001415 602000 3                  TNC     s:10205

      543    10195    4                THEN MESSAGE$ = INIT$;

  10195  3 001373   200073 235100                    LDA     INIT$,,AUTO
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:102  
         3 001374   200063 755100                    STA     MESSAGE$,,AUTO

      544    10196    4                END;

  10196  3 001375   001415 710000 3                  TRA     s:10205

      545    10197    4           ELSE DO;

      546    10198    4                IF MESSAGE$ = INIT$

  10198  3 001376   200063 236100                    LDQ     MESSAGE$,,AUTO
         3 001377   200073 116100                    CMPQ    INIT$,,AUTO
         3 001400   001403 601000 3                  TNZ     s:10200

      547    10199    4                THEN END_IT = 1;

  10199  3 001401   000001 235007                    LDA     1,DL
         3 001402   200075 755100                    STA     END_IT,,AUTO

      548    10200    4                MESSAGE$ = MSG_LAST$;

  10200  3 001403   200064 235100                    LDA     MSG_LAST$,,AUTO
         3 001404   200063 755100                    STA     MESSAGE$,,AUTO

      549    10201    4                IF (END_IT = 1) AND (MESSAGE$ < INSERT$)

  10201  3 001405   200075 236100                    LDQ     END_IT,,AUTO
         3 001406   000001 116007                    CMPQ    1,DL
         3 001407   001415 601000 3                  TNZ     s:10205
         3 001410   200063 236100                    LDQ     MESSAGE$,,AUTO
         3 001411   200020 116100                    CMPQ    INSERT$,,AUTO
         3 001412   001415 603000 3                  TRC     s:10205

      550    10202    4                THEN RETURN;

  10202  3 001413   200054 221300                    LDX1  ! KNH$QHDR+20,,AUTO
         3 001414   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:103  

      551    10203    4                END;
      552    10204
      553    10205    3           END/*do while*/;

  10205  3 001415   200063 236100                    LDQ     MESSAGE$,,AUTO
         3 001416   200020 116100                    CMPQ    INSERT$,,AUTO
         3 001417   001024 601000 3                  TNZ     s:10155

      554    10206
      555    10207    2      CALL DAF$WRITE(VECTOR(BLANK_LINE));

  10207  3 001420   000004 630400 4                  EPPR0   4
         3 001421   000000 220000 xsym               LDX0    DAF$WRITE
         3 001422   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001423   000000 701010                    TSX1    0,X0
         3 001424   000000 011000                    NOP     0

      556    10208    2      RETURN;

  10208  3 001425   200054 221300                    LDX1  ! KNH$QHDR+20,,AUTO
         3 001426   000001 702211                    TSX2  ! 1,X1

      557    10209    2   END DBD$CQ_MESSAGE;
      558    10210    1   END DBD$CQ;

  10210  3 001427   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:104  
--  Include file information  --

   DA_CMD_C.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DBD$CQ.
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:105  

 **** Variables and constants ****

  ****  Section 001  Data  DBD$CQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)   r     1 RCQ_RPT                   10-0-0/c STRC(189)   r     1 RCQ_RPTTX00
    16-0-0/w STRC(288)   r     1 SCQ_RPT                   26-0-0/c STRC(189)   r     1 SCQ_RPTTX00

  ****  Section 002 RoData DBD$CQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   150-0-0/c CHAR(67)    r     1 CQM_FMT1                 100-0-0/c CHAR(77)    r     1 CQM_RPT1
   124-0-0/c CHAR(77)    r     1 CQM_RPT2                  64-0-0/c CHAR(48)    r     1 CQ_FMT2
    23-0-0/c CHAR(61)    r     1 CQ_RPT21                  43-0-0/c CHAR(66)    r     1 CQ_RPT22
   171-0-0/c STRC(2160)  r     1 KN_NAMTXT_FCN              0-0-0/c CHAR(37)    r     1 RCQ_RPT20
    12-0-0/c CHAR(34)    r     1 SCQ_RPT20

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP                      10-0-0/w UBIN        r     1 ACTION
    24-0-0/w UBIN        r     1 CQ_OFFSET                 23-0-0/w UBIN        r     1 CQ_WDSZ
     7-0-0/w UBIN        r     1 DOING_LAST                 5-0-0/w UBIN        r     1 D_RCQ
     6-0-0/w UBIN        r     1 D_SCQ                     75-0-0/w UBIN        r     1 END_IT
    65-0-0/w UBIN        r     1 FPT$                      67-0-0/w UBIN        r     1 FPTSZ
    61-0-0/c CHAR(4)     r     1 FREE                      55-0-0/c STRC(135)   r     1 FUNCTION
    72-0-0/w UBIN        r     1 HDRSZ                     17-0-0/w UBIN        r     1 I
    62-0-0/w UBIN        r     1 I                         73-0-0/w UBIN        r     1 INIT$
    20-0-0/w UBIN        r     1 INSERT$                   76-0-0/c STRC(144)   r     1 KNH$MESS
    30-0-0/w STRC(432)   r     1 KNH$QHDR                  22-0-0/w UBIN        r     1 LAST$
    63-0-0/w UBIN        r     1 MESSAGE$                  71-0-0/w UBIN        r     1 MESS_SZ
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:106  
    66-0-0/w UBIN        r     1 MSG$                      70-0-0/w UBIN        r     1 MSGSZ
    64-0-0/w UBIN        r     1 MSG_LAST$                 21-0-0/w UBIN        r     1 REMOVE$
    74-0-0/w UBIN        r     1 RESET$                    11-0-0/w SBIN        r     1 THIS_USER
    *0-0-0/w STRC(144)   r     1 TOP                       14-0-0/w SBIN        r     1 USER#
    25-0-0/c CHAR(8)     r     1 WAKE_UP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)     r     1 BLANK_LINE                 0-0-0/w EPTR        r     1 DAF$WRITE
     0-0-0/b BIT         r     1 DA_MAPERR                  0-0-0/w UBIN        r     1 DB_HANDQ$
     0-0-0/w SBIN        r     1 DB_MUIS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT


   Procedure DBD$CQ requires 792 words for executable code.
   Procedure DBD$CQ requires 144 words of local(AUTO) storage.

    No errors detected in file DBD$HMI.:E05TSI    .
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:107  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:108  
          MINI XREF LISTING

ACTION
      9806**DCL      9915<<ASSIGN   9922<<ASSIGN   9963>>IF
BEGIN_CQS
      9899**LABEL    9890--GOTO     9895--GOTO
BLANK_LINE
      9797**DCL      9945--CALL    10023--CALL    10207--CALL
CQM_FMT1 IN PROCEDURE DBD$CQ_MESSAGE
     10040**DCL     10188--CALL
CQM_RPT1 IN PROCEDURE DBD$CQ_MESSAGE
     10034**DCL     10150--CALL
CQM_RPT2 IN PROCEDURE DBD$CQ_MESSAGE
     10037**DCL     10151--CALL
CQ_FMT2
      9794**DCL      9987--CALL    10018--CALL
CQ_OFFSET
      9820**DCL      9968<>CALL     9971>>ASSIGN   9972>>ASSIGN   9973>>ASSIGN   9987--CALL     9996<>CALL
     10002>>ASSIGN  10003>>ASSIGN  10004>>ASSIGN  10018--CALL    10146>>ASSIGN  10147>>ASSIGN  10171>>ASSIGN
CQ_RPT21
      9790**DCL      9977--CALL    10008--CALL
CQ_RPT22
      9792**DCL      9978--CALL    10009--CALL
CQ_WDSZ
      9819**DCL      9967<>CALL     9974<<ASSIGN   9974>>ASSIGN   9987--CALL     9995<>CALL    10005<<ASSIGN
     10005>>ASSIGN  10018--CALL    10147>>ASSIGN
DAF$INIT
      9647**DCL-ENT  9914--CALL     9921--CALL
DAF$WRITE
      9646**DCL      9945>>CALL     9976>>CALL     9977>>CALL     9978>>CALL     9987>>CALL    10007>>CALL
     10008>>CALL    10009>>CALL    10018>>CALL    10023>>CALL    10150>>CALL    10151>>CALL    10188>>CALL
     10207>>CALL
DA_MAPERR
      9800**DCL      9934<<ASSIGN
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:109  
DBA$SELECTION
      9648**DCL-ENT  9939--CALL
DBD$CQ_MESSAGE
     10029**PROC    10025--CALL
DBM$GETMEM
      9650**DCL-ENT  9957--CALL    10155--CALL
DBM$PACK2
      9652**DCL-ENT  9965--CALL     9966--CALL     9967--CALL     9968--CALL     9969--CALL     9993--CALL
      9994--CALL     9995--CALL     9996--CALL     9997--CALL    10162--CALL    10167--CALL    10168--CALL
     10169--CALL
DB_HANDQ$
      9798**DCL      9957<>CALL     9971>>ASSIGN   9972>>ASSIGN   9973>>ASSIGN  10002>>ASSIGN  10003>>ASSIGN
     10004>>ASSIGN  10146>>ASSIGN  10147>>ASSIGN  10171>>ASSIGN
DB_MUIS
      9799**DCL      9931>>DOINDEX
DISPCQ
      9951**PROC     9932--CALL     9940--CALL
DISP_CQ
      9928**PROC     9916--CALL     9923--CALL
DOING_LAST
      9805**DCL      9902<<ASSIGN   9907<<ASSIGN  10137>>IF      10191>>IF
D_RCQ
      9803**DCL      9888<<ASSIGN   9893<<ASSIGN   9898<<ASSIGN   9912>>IF
D_SCQ
      9804**DCL      9889<<ASSIGN   9894<<ASSIGN   9899<<ASSIGN   9919>>IF
END_IT IN PROCEDURE DBD$CQ_MESSAGE
     10084**DCL     10144<<ASSIGN  10199<<ASSIGN  10201>>IF
FPT$ IN PROCEDURE DBD$CQ_MESSAGE
     10076**DCL     10178<<ASSIGN  10179<<ASSIGN  10188--CALL
FPTSZ IN PROCEDURE DBD$CQ_MESSAGE
     10078**DCL     10168<>CALL    10173<<ASSIGN  10173>>ASSIGN  10175>>ASSIGN  10177>>IF      10183>>ASSIGN
     10188--CALL
FREE IN PROCEDURE DBD$CQ_MESSAGE
     10072**DCL     10159<<ASSIGN  10159<<ASSIGN  10188--CALL
FUNCTION.TXT IN PROCEDURE DBD$CQ_MESSAGE
     10071**DCL     10164<<ASSIGN
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:110  
FUNCTION.X IN PROCEDURE DBD$CQ_MESSAGE
     10068**DCL     10071--REDEF
FUNCTION.X.X IN PROCEDURE DBD$CQ_MESSAGE
     10070**DCL     10165<<CALLBLT 10188--CALL
HDRSZ IN PROCEDURE DBD$CQ_MESSAGE
     10081**DCL     10148<<ASSIGN  10175>>ASSIGN  10179>>ASSIGN  10183>>ASSIGN
I
      9814**DCL      9938<<DOINDEX  9939>>CALL
I IN PROCEDURE DBD$CQ_MESSAGE
     10073**DCL     10162<>CALL    10163>>IF      10164>>ASSIGN  10165>>CALLBLT
INIT$ IN PROCEDURE DBD$CQ_MESSAGE
     10082**DCL     10146<<ASSIGN  10195>>ASSIGN  10198>>IF
INSERT$
      9816**DCL      9965<>CALL     9971<<ASSIGN   9971>>ASSIGN   9987--CALL     9993<>CALL    10002<<ASSIGN
     10002>>ASSIGN  10018--CALL    10139>>IF      10153>>DOWHILE 10201>>IF
KNH$MESS.FUNCTION
      9851**DCL      9851--REDEF
KNH$MESS.UID
      9881**DCL      9881--REDEF    9881--REDEF
KNH$MESS IN PROCEDURE DBD$CQ_MESSAGE
     10099**DCL     10148--ASSIGN  10155<>CALL    10155--CALL    10155--CALL
KNH$MESS.FLAGS.FREE IN PROCEDURE DBD$CQ_MESSAGE
     10104**DCL     10159>>IF      10160<<ASSIGN
KNH$MESS.FPTSZ IN PROCEDURE DBD$CQ_MESSAGE
     10132**DCL     10168<>CALL
KNH$MESS.FUNCTION IN PROCEDURE DBD$CQ_MESSAGE
     10099**DCL     10099--REDEF   10162<>CALL
KNH$MESS.LAST_PTR IN PROCEDURE DBD$CQ_MESSAGE
     10132**DCL     10167<>CALL
KNH$MESS.LDCTX IN PROCEDURE DBD$CQ_MESSAGE
     10104**DCL     10188--CALL
KNH$MESS.MSGSZ IN PROCEDURE DBD$CQ_MESSAGE
     10133**DCL     10169<>CALL
KNH$MESS.RECTYPE IN PROCEDURE DBD$CQ_MESSAGE
     10132**DCL     10188--CALL
KNH$MESS.UID IN PROCEDURE DBD$CQ_MESSAGE
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:111  
     10129**DCL     10129--REDEF   10129--REDEF   10188--CALL
KNH$QHDR
      9826**DCL      9957<>CALL     9957--CALL     9957--CALL
KNH$QHDR.CTX.WU
      9834**DCL      9999>>IF
KNH$QHDR.LAST_RCQPTR
      9835**DCL      9969<>CALL
KNH$QHDR.LAST_SCQPTR
      9835**DCL      9997<>CALL
KNH$QHDR.MBC_RCQ
      9834**DCL      9987--CALL
KNH$QHDR.MBC_SCQ
      9834**DCL     10018--CALL
KNH$QHDR.MSGS_RCQ
      9834**DCL      9987--CALL
KNH$QHDR.MSGS_SCQ
      9834**DCL     10018--CALL
KNH$QHDR.RCQ
      9826**DCL      9826--REDEF
KNH$QHDR.RCQ.IPTR
      9826**DCL      9965<>CALL
KNH$QHDR.RCQ.OFFSET
      9826**DCL      9968<>CALL
KNH$QHDR.RCQ.RPTR
      9826**DCL      9966<>CALL
KNH$QHDR.RCQ.SZ
      9826**DCL      9967<>CALL
KNH$QHDR.SCQ.IPTR
      9827**DCL      9993<>CALL
KNH$QHDR.SCQ.OFFSET
      9827**DCL      9996<>CALL
KNH$QHDR.SCQ.RPTR
      9827**DCL      9994<>CALL
KNH$QHDR.SCQ.SZ
      9827**DCL      9995<>CALL
KNH$QHDR.WRAP_RCQ
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:112  
      9835**DCL      9987--CALL
KNH$QHDR.WRAP_SCQ
      9834**DCL     10018--CALL
KN_NAMTXT_FCN.TXT IN PROCEDURE DBD$CQ_MESSAGE
     10063**DCL     10164>>ASSIGN
KN_NAMTXT_FCN.TXT_INT IN PROCEDURE DBD$CQ_MESSAGE
     10057**DCL     10063--REDEF
LAST$
      9818**DCL      9969<>CALL     9973<<ASSIGN   9973>>ASSIGN   9987--CALL     9997<>CALL    10004<<ASSIGN
     10004>>ASSIGN  10018--CALL    10143>>ASSIGN
MESSAGE$ IN PROCEDURE DBD$CQ_MESSAGE
     10074**DCL     10140<<ASSIGN  10143<<ASSIGN  10153>>DOWHILE 10155<>CALL    10179>>ASSIGN  10183>>ASSIGN
     10188--CALL    10193<<ASSIGN  10193>>ASSIGN  10194>>IF      10195<<ASSIGN  10198>>IF      10200<<ASSIGN
     10201>>IF
MESS_SZ IN PROCEDURE DBD$CQ_MESSAGE
     10080**DCL     10175<<ASSIGN  10193>>ASSIGN
MSG$ IN PROCEDURE DBD$CQ_MESSAGE
     10077**DCL     10182<<ASSIGN  10183<<ASSIGN  10188--CALL
MSGSZ IN PROCEDURE DBD$CQ_MESSAGE
     10079**DCL     10169<>CALL    10174<<ASSIGN  10174>>ASSIGN  10175>>ASSIGN  10181>>IF      10188--CALL
MSG_LAST$ IN PROCEDURE DBD$CQ_MESSAGE
     10075**DCL     10167<>CALL    10171<<ASSIGN  10171>>ASSIGN  10188--CALL    10200>>ASSIGN
OUT
      9605**DCL      9939<>CALL
OUT.CODE
      9613**DCL      9905>>IF
RCQ_RPT
      9672**DCL      9914<>CALL
RCQ_RPT20
      9788**DCL      9976--CALL
RCQ_RPTTX00
      9715**DCL      9702--DCLINIT
REMOVE$
      9817**DCL      9966<>CALL     9972<<ASSIGN   9972>>ASSIGN   9987--CALL     9994<>CALL    10003<<ASSIGN
     10003>>ASSIGN  10018--CALL    10139>>IF      10140>>ASSIGN
RESET$ IN PROCEDURE DBD$CQ_MESSAGE
PL6.E3A0      #002=DBD$CQ File=DBD$HMI.:E05TSI                                   TUE 07/29/97 13:07 Page:113  
     10083**DCL     10147<<ASSIGN  10194>>IF
SCQ_RPT
      9738**DCL      9921<>CALL
SCQ_RPT20
      9789**DCL     10007--CALL
SCQ_RPTTX00
      9781**DCL      9768--DCLINIT
THIS_USER
      9807**DCL      9954<<ASSIGN   9955<<ASSIGN   9976--CALL    10007--CALL
TOP
      9560**DCL        12--PROC     9892--ENTRY    9897--ENTRY
TOP.NSUBLKS
      9572**DCL      9903>>IF       9905>>IF       9908<<ASSIGN   9908>>ASSIGN   9929>>IF       9938>>DOINDEX
TOP.SUBLK$
      9593**DCL      9905>>IF       9939>>CALL
USER#
      9811**DCL      9931<<DOINDEX  9939<>CALL     9953>>IF       9954>>ASSIGN   9955>>ASSIGN   9957<>CALL
     10155<>CALL
WAKE_UP
      9821**DCL      9960<<ASSIGN   9987--CALL    10000<<ASSIGN  10018--CALL
