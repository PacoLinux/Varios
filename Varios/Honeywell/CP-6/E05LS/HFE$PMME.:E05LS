VERSION E05

PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:1    
        1        1        /*M*   HFE$PMME         M$TRAP--M$STRAP  PROCESSOR  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0    */
        8        8        /*X* PLM=3,IND=5 */
        9        9        HFE$M$TRAP: PROC (V$);
       10       10
       11       11    1   DCL V$ PTR;
       12       12
       13       13                                                /*  AUTO                              */
       14       14    1   DCL FPT$ PTR;
       15       15    1   DCL I SBIN WORD;
       16       16    1   DCL FAULT_CODE UBIN(5);
       17       17    1   DCL ACTION UBIN WORD;
       18       18    1   DCL ECC UBIN(36);
       19       19    1   DCL 1 FINFO ALIGNED,
       20       20    1         2 FLTREG BIT(36),
       21       21    1         2 FCLASS SBIN WORD,
       22       22    1         2 JERR,
       23       23    1           3 FCG BIT(12) UNAL,
       24       24    1           3 MID BIT(6) UNAL,
       25       25    1           3 MON BIT(1) UNAL,
       26       26    1           3 CODE UBIN(14) UNAL,
       27       27    1           3 SEV UBIN(3) UNAL,
       28       28    1         2 P# SBIN WORD;
       29       29                                                /*  BASED STRUCTURES                  */
       30       30        %INCLUDE B$SS;
       31      209        %INCLUDE B$JIT_C;
       32      523        %B$JIT0;
       33      612        %U$JIT1X;
       34      615        %M$JIT2X;
       35      618        %F$JIT3X;
       36      621        %S$JIT4X;
       37      624        %J$JIT5X;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:2    
       38      627        %A$JIT6X;
       39      630        %INCLUDE UE_CP6;
       40     1321        %B$ECCBI;
       41     1324        %B$ECCB;
       42     1332        %INCLUDE UE$CP6V_C;
       43     1416        %FPT$TRAP_V;
       44     1422        %FPT$STRAP_V;
       45     1425                                                /*                                    */
       46     1426    1   DCL 1 PTC1 BASED,
       47     1427    1         2 ENTADDRS(0:3) EPTR,
       48     1428    1         2 FLAGS(0:17) BIT(2);
       49     1429                                                /*                                    */
       50     1430    1   DCL 1 PTC2 BASED ALIGNED,
       51     1431    1         2 ENTADDRS(0:3),
       52     1432    1           3 IC UBIN(18) UNAL,
       53     1433    1           3 EFLAGS BIT(18) UNAL,
       54     1434    1         2 FLAGS BIT(36);
       55     1435                                                /*  EXTERNAL DATA                     */
       56     1436        %INCLUDE B_MAGIC_C;
       57     1554        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
       58     1647    1   DCL B$JIT$ PTR SYMREF;
       59     1648    1   DCL B$PS1$ PTR SYMREF;
       60     1649    1   DCL HW_FLTIC_OK BIT(1) SYMREF;
       61     1650                                                /*  CONSTANT DATA                     */
       62     1651    1   DCL FLTREGS(0:31) BIT(3) UNAL CONSTANT INIT(
       63     1652    1            '7'O,'0'O,'0'O,'0'O,'7'O,'1'O,'0'O,'0'O,'7'O,'7'O,'4'O,
       64     1653    1            '7'O,'7'O,'0'O,'0'O,'7'O,'0'O,'7'O,'0'O,'7'O,'0'O,'0'O,
       65     1654    1            '7'O,'7'O,'7'O,'7'O,'7'O,'7'O,'7'O,'7'O,'7'O,'7'O    );
       66     1655                                      /* To check validity of FPT.V_ bit settings     */
       67     1656    1   DCL FLAG_TABLE(0:17)     BIT(1) UNAL CONSTANT INIT(
       68     1657    1       '1'B,'1'B,'1'B,'1'B,'1'B,'0'B,'0'B,'0'B,'1'B,'1'B,'1'B,
       69     1658    1       '1'B,'1'B,'1'B,'1'B,'1'B,'1'B,'1'B             );
       70     1659                                                /* EXTERNAL PROCEDURES                */
       71     1660    1   DCL HFB$VISIBLE ENTRY(4);
       72     1661    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
       73     1662    1   DCL JSE$ABORTM ENTRY(8);
       74     1663    1   DCL UDB$AUTO ENTRY(0);
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:3    
       75     1664    1   DCL SSU$DELTAGO ENTRY(3);
       76     1665    1   DCL UDB$CALCOMP ENTRY;
       77     1666                                                /*   STRING SUBSTITUTIONS             */
       78     1667        /* The SUBs for ACTION follow.
       79     1668           If they ever change, change the ones in HFA$FAULT and HFB$FPR also.
       80     1669        */
       81     1670        %SUB SCREECH=7/*SCREECH*/;
       82     1671        %SUB DELTAGO=6/*DELTAGO*/;
       83     1672        %SUB ABORTM=5/*ABORTM*/;
       84     1673        %SUB PGEFLT=4/*PGEFLT*/;
       85     1674        %SUB SEXIT=3/*SEXIT*/;
       86     1675        %SUB RLIEF=2/*RELIEF*/;
       87     1676        %SUB CNCFLT=1/*CNCFLT*/;
       88     1677        /*                                                */
       89     1678        %INCLUDE HF_ERRORS_C;
       90     1763        %SUB B$SS=B_MPT.SS$->B$SS;
       91     1764        %SUB B$ECCB=B_MPT.ECCB$->B$ECCB;
       92     1765        %SUB B$ECCBI=B_MPT.ECCB$->B$ECCBI;
       93     1766           %SUB NOT_USER_FAULT='700000000000'O;
       94     1767                                                /* TO SET JIT.ERR                     */
       95     1768        %SUB SEVERR=4;
       96     1769        %SUB SEVXXX=6;
       97     1770        %MACRO ERRCODE(NAME=ERRWD,SEV#=SEVERR,COD#=0);
       98     1771        DCL 1 NAME CONSTANT,
       99     1772              2 F BIT(12) UNAL INIT(FCG#),
      100     1773              2 M BIT(6) UNAL INIT(MID#),
      101     1774              2 MB BIT(1) UNAL INIT('1'B),
      102     1775              2 C UBIN(14) UNAL INIT(COD#),
      103     1776              2 S UBIN(3) UNAL INIT(SEV#);
      104     1777        %MEND;
      105     1778        %SUB FCG#='1006'O;
      106     1779        %SUB MID#='05'O;
      107     1780
      108     1781        %ERRCODE (NAME=EMPTC,COD#=%E$MISSING_PTC);
      109     1789        %ERRCODE (NAME=ENOTD,COD#=%E$NO_TD_PRIV);
      110     1797        %ERRCODE (NAME=EBADSTRAP,COD#=%E$BAD_STRAP_CODE);
      111     1805
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:4    
      112     1806        %EJECT;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:5    
      113     1807                                                /*****************************/
      114     1808                                                /*        M$TRAP                      */
      115     1809                                                /*****************************/
      116     1810    1      CALL HFF$NILERASE(1) ALTRET(NO_PTC);
      117     1811    1      ACTION=1;                            /*PTC SPECIFIED                       */
      118     1812    1      IF V$->FPT$TRAP_V.FLAGS.RESTORE  = '10'B
      119     1813    1      THEN FPT$ = B$PS1$;
      120     1814                                      /* Set to restore from PTC passed in the FPT    */
      121     1815    1      ELSE FPT$ = V$;
      122     1816                                      /*  Set to store from Value Block of the FPT    */
      123     1817                                                /*                                    */
      124     1818                                                /*                                    */
      125     1819    1   CHECK_TD: ;
      126     1820    1      IF ( (B$JIT$->B$JIT.PRIV.AUTH & %PR_TND#) ~= %PR_TND#) AND
      127     1821    1        (FPT$->FPT$TRAP_V.FLAGS.HARDWARE  = '10'B)
      128     1822    2      THEN DO;
      129     1823    2           B$JIT.ERR=ENOTD;
      130     1824    2           RETURN;
      131     1825        /*E*   ERROR:  HFE-E$NO_TD_PRIV-E
      132     1826               MESSAGE: T&D authorization required to take HARDWARE trap control.
      133     1827        */
      134     1828    2         END;
      135     1829                                                /*                                    */
      136     1830                                                /* VALIDATE THE FPT HERE              */
      137     1831                                                /*                                    */
      138     1832    1      IF ACTION=0 THEN GOTO FPT_TO_ECCB;
      139     1833                                                /* Go if PTC wasnt specified          */
      140     1834    1      IF V$->FPT$TRAP_V.FLAGS.RESTORE  = '10'B
      141     1835    2      THEN DO;                             /* Restore the ECCB from a PTC Block  */
      142     1836                                                /* Clean the ECCB                     */
      143     1837    3           DO I = 4 TO 7;
      144     1838    3                B$ECCBI.FLAGS(I) = '0'B;
      145     1839    3                B$ECCBI.ECIC(I) = 0;
      146     1840    3              END;
      147     1841    2           B$ECCB.FLTFLG='0'B;
      148     1842    2         END;                              /*DO IF RESTORE                       */
      149     1843                                                /*                                    */
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:6    
      150     1844                                                /*                                    */
      151     1845    2      ELSE DO;                             /* Return the PTC to the user         */
      152     1846    3           DO I = 0 TO 3;
      153     1847    3                IF B$ECCBI.FLAGS(I+4) = '1'B
      154     1848    4                THEN DO;
      155     1849    4                     B$PS1$->PTC2.ENTADDRS.IC(I) = B$ECCBI.ECIC(I+4);
      156     1850    4                     B$PS1$->PTC2.ENTADDRS.EFLAGS(I) ='0'B;
      157     1851    4                   END;                    /*DO IF TRAP '1'B                     */
      158     1852    3                ELSE B$PS1$->PTC1.ENTADDRS(I) = ENTADDR(NIL);
      159     1853    3              END;                         /*DO 0 TO 3                           */
      160     1854                                                /*                                    */
      161     1855    2           B$PS1$->PTC2.FLAGS='0'B;        /* Clean word 5                       */
      162     1856                                                /*                                    */
      163     1857    3           DO I = 0 TO 17;
      164     1858    3                IF FLAG_TABLE(I) = '1'B
      165     1859    3                THEN IF B$ECCBI.FLAGS(I+18) = '1'B
      166     1860    3                     THEN B$PS1$->PTC1.FLAGS(I) = '10'B;
      167     1861    3                     ELSE B$PS1$->PTC1.FLAGS(I) = '00'B;
      168     1862    3              END;                         /*DO 0 TO 17                          */
      169     1863    2         END;                              /* DO IF RETURN PTC                   */
      170     1864                                                /*                                    */
      171     1865        %EJECT;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:7    
      172     1866                                                /*                                    */
      173     1867    1   FPT_TO_ECCB: ;
      174     1868                                                /*                                    */
      175     1869                                 /* Copy transfer address from the FPT to the ECCB    */
      176     1870    2      DO I = 0 TO 3;
      177     1871    2           IF FPT$->PTC1.ENTADDRS(I) ~= ENTADDR(NIL)
      178     1872    3           THEN DO;
      179     1873    3                B$ECCBI.ECIC(I+4) = FPT$->PTC2.ENTADDRS.IC(I);
      180     1874    3                B$ECCBI.FLAGS(I+4) = '1'B;
      181     1875    3              END;
      182     1876    2         END;
      183     1877                                                /*                                    */
      184     1878                                      /*  Copy Fault Flags from the FPT to the ECCB   */
      185     1879    2      DO I = 0 TO 17;
      186     1880    2           IF FLAG_TABLE(I) = '1'B
      187     1881    2           THEN IF FPT$->PTC1.FLAGS(I) = '00'B
      188     1882    2                THEN B$ECCBI.FLAGS(I+18) = '0'B;
      189     1883    2                ELSE IF FPT$->PTC1.FLAGS(I) = '10'B
      190     1884    2                     THEN B$ECCBI.FLAGS(I+18) = '1'B;
      191     1885    2         END;
      192     1886    1      RETURN;
      193     1887                                                /*                                    */
      194     1888                                                /*                                    */
      195     1889    1   NO_PTC: ;
      196     1890    1      IF V$->FPT$TRAP_V.FLAGS.RESTORE = '10'B
      197     1891    2      THEN DO;
      198     1892    2           B$JIT.ERR=EMPTC;
      199     1893    2           RETURN;
      200     1894        /*E*   ERROR:  HFE-E$MISSING_PTC-E
      201     1895               MESSAGE:  Restore without PTC (M$TRAP)
      202     1896        */
      203     1897    2         END;
      204     1898    1      ACTION=0;                            /* PTC not specified                  */
      205     1899    1      FPT$=V$;
      206     1900    1      GOTO CHECK_TD;
      207     1901        %EJECT;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:8    
      208     1902                                                /*****************************/
      209     1903                                                /*        M$STRAP                     */
      210     1904                                                /*****************************/
      211     1905    1   HFE$M$STRAP:ENTRY (V$);
      212     1906    1      FAULT_CODE = V$->FPT$STRAP_V.STRAP;
      213     1907    1      FINFO.FLTREG = FLTREGS(FAULT_CODE);
      214     1908    1      IF (FINFO.FLTREG = NOT_USER_FAULT)    OR (FAULT_CODE > 21)
      215     1909    2      THEN DO;
      216     1910    2   BAD_STRAP: ;
      217     1911    2           B$JIT.ERR=EBADSTRAP;
      218     1912        /*E*   ERROR:  HFE-E$BAD_STRAP_CODE-E
      219     1913               MESSAGE: Not a user visible fault (M$STRAP).
      220     1914        */
      221     1915    2         END;
      222     1916    2      ELSE DO;
      223     1917    2           B$SS.FC = FAULT_CODE;
      224     1918    2           IF HW_FLTIC_OK THEN
      225     1919    2                B$SS.IC = B$SS.IC-2;
      226     1920    2           ELSE
      227     1921    2                B$SS.IC = B$SS.IC-1;
      228     1922                                                /*HFB$VISIBLE will back it one more   */
      229     1923    2           FINFO.P# =0;
      230     1924    2           FINFO.JERR=EBADSTRAP;           /*TO SET  FCG-MID                     */
      231     1925    2           FINFO.JERR.CODE=FAULT_CODE+500;
      232     1926    2           ACTION=0;
      233     1927    2           CALL HFB$VISIBLE(FINFO,ACTION,ECC);
      234     1928    3           DO CASE (ACTION);
      235     1929    3            CASE(SEXIT);
      236     1930    3              CALL UDB$CALCOMP;
      237     1931    3              CALL UDB$AUTO;
      238     1932    3            CASE(ABORTM);
      239     1933    3              CALL UDB$CALCOMP;
      240     1934    3              CALL JSE$ABORTM;
      241     1935    3            CASE(DELTAGO);
      242     1936    3              CALL UDB$CALCOMP;
      243     1937    3              CALL SSU$DELTAGO (ECC,FINFO);
      244     1938    3            CASE(ELSE);
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:9    
      245     1939    3              B$SS.IC=B$SS.IC+2;
      246     1940    3              GOTO BAD_STRAP;
      247     1941    3            END;
      248     1942    2         END;
      249     1943    1      RETURN;
      250     1944        %EJECT;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:10   
      251     1945                                                /*   HFE DEFAULT ERROR MESSAGES       */
      252     1946        /*E*   ERROR:  HFE-E$MEMORY-E
      253     1947               MESSAGE: (M$STRAP)  Memory fault
      254     1948        */
      255     1949        /*E*   ERROR:  HFE-E$MME-E
      256     1950               MESSAGE: (M$STRAP)  MME fault
      257     1951        */
      258     1952        /*E*   ERROR:  HFE-E$FAULT_TAG-E
      259     1953               MESSAGE: (M$STRAP)  Fault Tag fault
      260     1954        */
      261     1955        /*E*   ERROR:  HFE-E$COMMAND-E
      262     1956               MESSAGE: (M$STRAP)  Command fault
      263     1957        */
      264     1958        /*E*   ERROR:  HFE-E$DERAIL-E
      265     1959               MESSAGE: (M$STRAP)  Derail fault
      266     1960        */
      267     1961        /*E*   ERROR:  HFE-E$LOCKUP-E
      268     1962               MESSAGE: (M$STRAP)  Lockup fault
      269     1963        */
      270     1964        /*E*   ERROR:  HFE-E$PRTY-E
      271     1965               MESSAGE: (M$STRAP)  Parity Error fault
      272     1966        */
      273     1967        /*E*   ERROR:  HFE-E$IPR-E
      274     1968               MESSAGE: (M$STRAP)  Illegal Procedure fault
      275     1969        */
      276     1970        /*E*   ERROR:  HFE-E$OPNC-E
      277     1971               MESSAGE: (M$STRAP)  OP Not Complete fault
      278     1972        */
      279     1973        /*E*   ERROR:  HFE-E$OVERFLOW-E
      280     1974               MESSAGE: (M$STRAP)  Overflow fault
      281     1975        */
      282     1976        /*E*   ERROR:  HFE-E$DIVIDE_CHECK-E
      283     1977               MESSAGE: (M$STRAP)  Divide Check fault
      284     1978        */
      285     1979        /*E*   ERROR:  HFE-E$SECURITY_1-E
      286     1980               MESSAGE: (M$STRAP)  Security 1 fault
      287     1981        */
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:11   
      288     1982        /*E*   ERROR:  HFE-E$DLNK-E
      289     1983               MESSAGE: (M$STRAP)  Dynamic Link fault
      290     1984        */
      291     1985        /*E*   ERROR:  HFE-E$MISSING_SEGMENT-E
      292     1986               MESSAGE: (M$STRAP)  Missing Segment fault
      293     1987        */
      294     1988        /*E*   ERROR: HFE-E$MWSP-E
      295     1989               MESSAGE: (M$STRAP)  Missing Work Space fault
      296     1990        */
      297     1991        /*E*   ERROR:  HFE-E$MISSING_PAGE-E
      298     1992               MESSAGE: (M$STRAP)  Missing Page fault
      299     1993        */
      300     1994        /*E*   ERROR:  HFE-E$SECURITY_2-E
      301     1995               MESSAGE: (M$STRAP)  Security 2 fault
      302     1996        */
      303     1997    1   END HFE$M$TRAP;

PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:12   
--  Include file information  --

   HF_ERRORS_C.:E05TOU  is referenced.
   B_MAGIC_C.:E05TOU  is referenced.
   UE$CP6V_C.:E05TOU  is referenced.
   UE_CP6.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure HFE$M$TRAP.

   Procedure HFE$M$TRAP requires 320 words for executable code.
   Procedure HFE$M$TRAP requires 18 words of local(AUTO) storage.

    No errors detected in file HFE$PMME.:E05TSI    .

PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:13   

 Object Unit name= HFE$M$TRAP                                 File name= HFE$PMME.:E05TOU
 UTS= JUL 29 '97 22:24:31.00 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      9     11  HFE$M$TRAP
    1   Proc  even  none   320    500  HFE$M$TRAP
    2  RoData even  none     1      1  HFE$M$TRAP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  HFE$M$TRAP
     1    330                  yes      Std        1  HFE$M$STRAP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       0 UDB$CALCOMP
         yes           Std       4 HFB$VISIBLE
         yes           Std       0 UDB$AUTO
         yes           Std       3 SSU$DELTAGO
         yes           Std       8 JSE$ABORTM
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:14   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_MPT                                 B$JIT$                                B$PS1$
     HW_FLTIC_OK                           B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:15   


        1        1        /*M*   HFE$PMME         M$TRAP--M$STRAP  PROCESSOR  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0    */
        8        8        /*X* PLM=3,IND=5 */
        9        9        HFE$M$TRAP: PROC (V$);

      9  1 000000   000000 700200 xent  HFE$M$TRAP   TSX0  ! X66_AUTO_1
         1 000001   000022 000001                    ZERO    18,1

       10       10
       11       11    1   DCL V$ PTR;
       12       12
       13       13                                                /*  AUTO                              */
       14       14    1   DCL FPT$ PTR;
       15       15    1   DCL I SBIN WORD;
       16       16    1   DCL FAULT_CODE UBIN(5);
       17       17    1   DCL ACTION UBIN WORD;
       18       18    1   DCL ECC UBIN(36);
       19       19    1   DCL 1 FINFO ALIGNED,
       20       20    1         2 FLTREG BIT(36),
       21       21    1         2 FCLASS SBIN WORD,
       22       22    1         2 JERR,
       23       23    1           3 FCG BIT(12) UNAL,
       24       24    1           3 MID BIT(6) UNAL,
       25       25    1           3 MON BIT(1) UNAL,
       26       26    1           3 CODE UBIN(14) UNAL,
       27       27    1           3 SEV UBIN(3) UNAL,
       28       28    1         2 P# SBIN WORD;
       29       29                                                /*  BASED STRUCTURES                  */
       30       30        %INCLUDE B$SS;
       31      209        %INCLUDE B$JIT_C;
       32      523        %B$JIT0;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:16   
       33      612        %U$JIT1X;
       34      615        %M$JIT2X;
       35      618        %F$JIT3X;
       36      621        %S$JIT4X;
       37      624        %J$JIT5X;
       38      627        %A$JIT6X;
       39      630        %INCLUDE UE_CP6;
       40     1321        %B$ECCBI;
       41     1324        %B$ECCB;
       42     1332        %INCLUDE UE$CP6V_C;
       43     1416        %FPT$TRAP_V;
       44     1422        %FPT$STRAP_V;
       45     1425                                                /*                                    */
       46     1426    1   DCL 1 PTC1 BASED,
       47     1427    1         2 ENTADDRS(0:3) EPTR,
       48     1428    1         2 FLAGS(0:17) BIT(2);
       49     1429                                                /*                                    */
       50     1430    1   DCL 1 PTC2 BASED ALIGNED,
       51     1431    1         2 ENTADDRS(0:3),
       52     1432    1           3 IC UBIN(18) UNAL,
       53     1433    1           3 EFLAGS BIT(18) UNAL,
       54     1434    1         2 FLAGS BIT(36);
       55     1435                                                /*  EXTERNAL DATA                     */
       56     1436        %INCLUDE B_MAGIC_C;
       57     1554        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
       58     1647    1   DCL B$JIT$ PTR SYMREF;
       59     1648    1   DCL B$PS1$ PTR SYMREF;
       60     1649    1   DCL HW_FLTIC_OK BIT(1) SYMREF;
       61     1650                                                /*  CONSTANT DATA                     */
       62     1651    1   DCL FLTREGS(0:31) BIT(3) UNAL CONSTANT INIT(
       63     1652    1            '7'O,'0'O,'0'O,'0'O,'7'O,'1'O,'0'O,'0'O,'7'O,'7'O,'4'O,
       64     1653    1            '7'O,'7'O,'0'O,'0'O,'7'O,'0'O,'7'O,'0'O,'7'O,'0'O,'0'O,
       65     1654    1            '7'O,'7'O,'7'O,'7'O,'7'O,'7'O,'7'O,'7'O,'7'O,'7'O    );
       66     1655                                      /* To check validity of FPT.V_ bit settings     */
       67     1656    1   DCL FLAG_TABLE(0:17)     BIT(1) UNAL CONSTANT INIT(
       68     1657    1       '1'B,'1'B,'1'B,'1'B,'1'B,'0'B,'0'B,'0'B,'1'B,'1'B,'1'B,
       69     1658    1       '1'B,'1'B,'1'B,'1'B,'1'B,'1'B,'1'B             );
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:17   
       70     1659                                                /* EXTERNAL PROCEDURES                */
       71     1660    1   DCL HFB$VISIBLE ENTRY(4);
       72     1661    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
       73     1662    1   DCL JSE$ABORTM ENTRY(8);
       74     1663    1   DCL UDB$AUTO ENTRY(0);
       75     1664    1   DCL SSU$DELTAGO ENTRY(3);
       76     1665    1   DCL UDB$CALCOMP ENTRY;
       77     1666                                                /*   STRING SUBSTITUTIONS             */
       78     1667        /* The SUBs for ACTION follow.
       79     1668           If they ever change, change the ones in HFA$FAULT and HFB$FPR also.
       80     1669        */
       81     1670        %SUB SCREECH=7/*SCREECH*/;
       82     1671        %SUB DELTAGO=6/*DELTAGO*/;
       83     1672        %SUB ABORTM=5/*ABORTM*/;
       84     1673        %SUB PGEFLT=4/*PGEFLT*/;
       85     1674        %SUB SEXIT=3/*SEXIT*/;
       86     1675        %SUB RLIEF=2/*RELIEF*/;
       87     1676        %SUB CNCFLT=1/*CNCFLT*/;
       88     1677        /*                                                */
       89     1678        %INCLUDE HF_ERRORS_C;
       90     1763        %SUB B$SS=B_MPT.SS$->B$SS;
       91     1764        %SUB B$ECCB=B_MPT.ECCB$->B$ECCB;
       92     1765        %SUB B$ECCBI=B_MPT.ECCB$->B$ECCBI;
       93     1766           %SUB NOT_USER_FAULT='700000000000'O;
       94     1767                                                /* TO SET JIT.ERR                     */
       95     1768        %SUB SEVERR=4;
       96     1769        %SUB SEVXXX=6;
       97     1770        %MACRO ERRCODE(NAME=ERRWD,SEV#=SEVERR,COD#=0);
       98     1771        DCL 1 NAME CONSTANT,
       99     1772              2 F BIT(12) UNAL INIT(FCG#),
      100     1773              2 M BIT(6) UNAL INIT(MID#),
      101     1774              2 MB BIT(1) UNAL INIT('1'B),
      102     1775              2 C UBIN(14) UNAL INIT(COD#),
      103     1776              2 S UBIN(3) UNAL INIT(SEV#);
      104     1777        %MEND;
      105     1778        %SUB FCG#='1006'O;
      106     1779        %SUB MID#='05'O;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:18   
      107     1780
      108     1781        %ERRCODE (NAME=EMPTC,COD#=%E$MISSING_PTC);
      109     1789        %ERRCODE (NAME=ENOTD,COD#=%E$NO_TD_PRIV);
      110     1797        %ERRCODE (NAME=EBADSTRAP,COD#=%E$BAD_STRAP_CODE);
      111     1805
      112     1806        %EJECT;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:19   
      113     1807                                                /*****************************/
      114     1808                                                /*        M$TRAP                      */
      115     1809                                                /*****************************/
      116     1810    1      CALL HFF$NILERASE(1) ALTRET(NO_PTC);

   1810  1 000002   000000 630400 2                  EPPR0   0
         1 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000004   000000 701000 xent               TSX1    HFF$NILERASE
         1 000005   000312 702000 1                  TSX2    NO_PTC

      117     1811    1      ACTION=1;                            /*PTC SPECIFIED                       */

   1811  1 000006   000001 235007                    LDA     1,DL
         1 000007   200007 755100                    STA     ACTION,,AUTO

      118     1812    1      IF V$->FPT$TRAP_V.FLAGS.RESTORE  = '10'B

   1812  1 000010   200003 470500                    LDP0    @V$,,AUTO
         1 000011   000000 471500                    LDP1    0,,PR0
         1 000012   100004 236100                    LDQ     4,,PR1
         1 000013   000060 376003                    ANQ     48,DU
         1 000014   000040 116003                    CMPQ    32,DU
         1 000015   000021 601000 1                  TNZ     s:1815

      119     1813    1      THEN FPT$ = B$PS1$;

   1813  1 000016   000000 236000 xsym               LDQ     B$PS1$
         1 000017   200004 756100                    STQ     FPT$,,AUTO
         1 000020   000023 710000 1                  TRA     CHECK_TD

      120     1814                                      /* Set to restore from PTC passed in the FPT    */
      121     1815    1      ELSE FPT$ = V$;

   1815  1 000021   000000 236100                    LDQ     0,,PR0
         1 000022   200004 756100                    STQ     FPT$,,AUTO

   1812  1 000023                       CHECK_TD     null
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:20   
      122     1816                                      /*  Set to store from Value Block of the FPT    */
      123     1817                                                /*                                    */
      124     1818                                                /*                                    */
      125     1819    1   CHECK_TD: ;
      126     1820    1      IF ( (B$JIT$->B$JIT.PRIV.AUTH & %PR_TND#) ~= %PR_TND#) AND

   1820  1 000023   000000 470400 xsym               LDP0    B$JIT$
         1 000024   000014 236100                    LDQ     12,,PR0
         1 000025   000007 376000 0                  ANQ     EBADSTRAP+1
         1 000026   000007 116000 0                  CMPQ    EBADSTRAP+1
         1 000027   000040 600000 1                  TZE     s:1832
         1 000030   200004 471500                    LDP1    FPT$,,AUTO
         1 000031   100004 236100                    LDQ     4,,PR1
         1 000032   000014 376007                    ANQ     12,DL
         1 000033   000010 116007                    CMPQ    8,DL
         1 000034   000040 601000 1                  TNZ     s:1832

      127     1821    1        (FPT$->FPT$TRAP_V.FLAGS.HARDWARE  = '10'B)
      128     1822    2      THEN DO;

      129     1823    2           B$JIT.ERR=ENOTD;

   1823  1 000035   000005 236000 0                  LDQ     ENOTD
         1 000036   000012 756100                    STQ     10,,PR0

      130     1824    2           RETURN;

   1824  1 000037   000000 702200 xent               TSX2  ! X66_ARET

      131     1825        /*E*   ERROR:  HFE-E$NO_TD_PRIV-E
      132     1826               MESSAGE: T&D authorization required to take HARDWARE trap control.
      133     1827        */
      134     1828    2         END;
      135     1829                                                /*                                    */
      136     1830                                                /* VALIDATE THE FPT HERE              */
      137     1831                                                /*                                    */
      138     1832    1      IF ACTION=0 THEN GOTO FPT_TO_ECCB;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:21   

   1832  1 000040   200007 235100                    LDA     ACTION,,AUTO
         1 000041   000204 600000 1                  TZE     FPT_TO_ECCB

      139     1833                                                /* Go if PTC wasnt specified          */
      140     1834    1      IF V$->FPT$TRAP_V.FLAGS.RESTORE  = '10'B

   1834  1 000042   200003 471500                    LDP1    @V$,,AUTO
         1 000043   100000 473500                    LDP3    0,,PR1
         1 000044   300004 236100                    LDQ     4,,PR3
         1 000045   000060 376003                    ANQ     48,DU
         1 000046   000040 116003                    CMPQ    32,DU
         1 000047   000077 601000 1                  TNZ     s:1846

      141     1835    2      THEN DO;                             /* Restore the ECCB from a PTC Block  */

      142     1836                                                /* Clean the ECCB                     */
      143     1837    3           DO I = 4 TO 7;

   1837  1 000050   000004 236007                    LDQ     4,DL
         1 000051   200005 756100                    STQ     I,,AUTO

      144     1838    3                B$ECCBI.FLAGS(I) = '0'B;

   1838  1 000052   200005 235100                    LDA     I,,AUTO
         1 000053   000055 605000 1                  TPL     s:1838+3
         1 000054   000044 035003                    ADLA    36,DU
         1 000055   000005 470400 xsym               LDP0    B_MPT+5
         1 000056   003105 060400                    CSL     bolr='003'O
         1 000057   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 000060   000004 000001                    BDSC    4,A,PR0                  by=0,bit=0,n=1

      145     1839    3                B$ECCBI.ECIC(I) = 0;

   1839  1 000061   200005 235100                    LDA     I,,AUTO
         1 000062   000001 735000                    ALS     1
         1 000063   000005 470400 xsym               LDP0    B_MPT+5
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:22   
         1 000064   000105 101400                    MRL     fill='000'O
         1 000065   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         1 000066   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2

      146     1840    3              END;

   1840  1 000067   200005 054100                    AOS     I,,AUTO
         1 000070   200005 235100                    LDA     I,,AUTO
         1 000071   000007 115007                    CMPA    7,DL
         1 000072   000052 604400 1                  TMOZ    s:1838

      147     1841    2           B$ECCB.FLTFLG='0'B;

   1841  1 000073   000000 220003                    LDX0    0,DU
         1 000074   000005 470400 xsym               LDP0    B_MPT+5
         1 000075   000004 440100                    SXL0    4,,PR0

      148     1842    2         END;                              /*DO IF RESTORE                       */

   1842  1 000076   000204 710000 1                  TRA     FPT_TO_ECCB

      149     1843                                                /*                                    */
      150     1844                                                /*                                    */
      151     1845    2      ELSE DO;                             /* Return the PTC to the user         */

      152     1846    3           DO I = 0 TO 3;

   1846  1 000077   200005 450100                    STZ     I,,AUTO

      153     1847    3                IF B$ECCBI.FLAGS(I+4) = '1'B

   1847  1 000100   200005 235100                    LDA     I,,AUTO
         1 000101   000103 605000 1                  TPL     s:1847+3
         1 000102   000044 035003                    ADLA    36,DU
         1 000103   000005 470400 xsym               LDP0    B_MPT+5
         1 000104   000000 066505                    CMPB    filb='0'B
         1 000105   000004 040001                    BDSC    4,A,PR0                  by=0,bit=4,n=1
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:23   
         1 000106   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000107   000125 600000 1                  TZE     s:1852

      154     1848    4                THEN DO;

      155     1849    4                     B$PS1$->PTC2.ENTADDRS.IC(I) = B$ECCBI.ECIC(I+4);

   1849  1 000110   200005 235100                    LDA     I,,AUTO
         1 000111   000001 735000                    ALS     1
         1 000112   200005 236100                    LDQ     I,,AUTO
         1 000113   000002 736000                    QLS     2
         1 000114   000000 471400 xsym               LDP1    B$PS1$
         1 000115   000106 100505                    MLR     fill='000'O
         1 000116   000002 000002                    ADSC9   2,A,PR0                  cn=0,n=2
         1 000117   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2

      156     1850    4                     B$PS1$->PTC2.ENTADDRS.EFLAGS(I) ='0'B;

   1850  1 000120   000000 220003                    LDX0    0,DU
         1 000121   000000 470400 xsym               LDP0    B$PS1$
         1 000122   200005 721100                    LXL1    I,,AUTO
         1 000123   000000 440111                    SXL0    0,X1,PR0

      157     1851    4                   END;                    /*DO IF TRAP '1'B                     */

   1851  1 000124   000131 710000 1                  TRA     s:1853

      158     1852    3                ELSE B$PS1$->PTC1.ENTADDRS(I) = ENTADDR(NIL);

   1852  1 000125   000002 236000 xsym               LDQ     B_VECTNIL+2
         1 000126   000000 471400 xsym               LDP1    B$PS1$
         1 000127   200005 720100                    LXL0    I,,AUTO
         1 000130   100000 756110                    STQ     0,X0,PR1

      159     1853    3              END;                         /*DO 0 TO 3                           */

   1853  1 000131   200005 054100                    AOS     I,,AUTO
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:24   
         1 000132   200005 235100                    LDA     I,,AUTO
         1 000133   000003 115007                    CMPA    3,DL
         1 000134   000100 604400 1                  TMOZ    s:1847

      160     1854                                                /*                                    */
      161     1855    2           B$PS1$->PTC2.FLAGS='0'B;        /* Clean word 5                       */

   1855  1 000135   000000 470400 xsym               LDP0    B$PS1$
         1 000136   000004 450100                    STZ     4,,PR0

      162     1856                                                /*                                    */
      163     1857    3           DO I = 0 TO 17;

   1857  1 000137   200005 450100                    STZ     I,,AUTO

      164     1858    3                IF FLAG_TABLE(I) = '1'B

   1858  1 000140   200005 235100                    LDA     I,,AUTO
         1 000141   000143 605000 1                  TPL     s:1858+3
         1 000142   000044 035003                    ADLA    36,DU
         1 000143   000000 066405                    CMPB    filb='0'B
         1 000144   000003 000001 0                  BDSC    FLAG_TABLE,A             by=0,bit=0,n=1
         1 000145   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000146   000200 600000 1                  TZE     s:1862

      165     1859    3                THEN IF B$ECCBI.FLAGS(I+18) = '1'B

   1859  1 000147   200005 235100                    LDA     I,,AUTO
         1 000150   000152 605000 1                  TPL     s:1859+3
         1 000151   000044 035003                    ADLA    36,DU
         1 000152   000005 470400 xsym               LDP0    B_MPT+5
         1 000153   000000 066505                    CMPB    filb='0'B
         1 000154   000004 400001                    BDSC    4,A,PR0                  by=2,bit=0,n=1
         1 000155   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000156   000170 600000 1                  TZE     s:1861

      166     1860    3                     THEN B$PS1$->PTC1.FLAGS(I) = '10'B;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:25   

   1860  1 000157   200005 235100                    LDA     I,,AUTO
         1 000160   000001 735000                    ALS     1
         1 000161   000163 605000 1                  TPL     s:1860+4
         1 000162   000044 035003                    ADLA    36,DU
         1 000163   000000 471400 xsym               LDP1    B$PS1$
         1 000164   003105 060400                    CSL     bolr='003'O
         1 000165   000030 000002 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=2
         1 000166   100004 000002                    BDSC    4,A,PR1                  by=0,bit=0,n=2
         1 000167   000200 710000 1                  TRA     s:1862

      167     1861    3                     ELSE B$PS1$->PTC1.FLAGS(I) = '00'B;

   1861  1 000170   200005 235100                    LDA     I,,AUTO
         1 000171   000001 735000                    ALS     1
         1 000172   000174 605000 1                  TPL     s:1861+4
         1 000173   000044 035003                    ADLA    36,DU
         1 000174   000000 471400 xsym               LDP1    B$PS1$
         1 000175   003105 060400                    CSL     bolr='003'O
         1 000176   000002 000002 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=2
         1 000177   100004 000002                    BDSC    4,A,PR1                  by=0,bit=0,n=2

      168     1862    3              END;                         /*DO 0 TO 17                          */

   1862  1 000200   200005 054100                    AOS     I,,AUTO
         1 000201   200005 235100                    LDA     I,,AUTO
         1 000202   000021 115007                    CMPA    17,DL
         1 000203   000140 604400 1                  TMOZ    s:1858

      169     1863    2         END;                              /* DO IF RETURN PTC                   */

   1861  1 000204                       FPT_TO_ECCB  null
      170     1864                                                /*                                    */
      171     1865        %EJECT;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:26   
      172     1866                                                /*                                    */
      173     1867    1   FPT_TO_ECCB: ;
      174     1868                                                /*                                    */
      175     1869                                 /* Copy transfer address from the FPT to the ECCB    */
      176     1870    2      DO I = 0 TO 3;

   1870  1 000204   200005 450100                    STZ     I,,AUTO

      177     1871    2           IF FPT$->PTC1.ENTADDRS(I) ~= ENTADDR(NIL)

   1871  1 000205   200004 470500                    LDP0    FPT$,,AUTO
         1 000206   200005 720100                    LXL0    I,,AUTO
         1 000207   000000 236110                    LDQ     0,X0,PR0
         1 000210   000002 116000 xsym               CMPQ    B_VECTNIL+2
         1 000211   000231 600000 1                  TZE     s:1876

      178     1872    3           THEN DO;

      179     1873    3                B$ECCBI.ECIC(I+4) = FPT$->PTC2.ENTADDRS.IC(I);

   1873  1 000212   200005 235100                    LDA     I,,AUTO
         1 000213   000002 735000                    ALS     2
         1 000214   200005 236100                    LDQ     I,,AUTO
         1 000215   000001 736000                    QLS     1
         1 000216   000005 471400 xsym               LDP1    B_MPT+5
         1 000217   000106 100505                    MLR     fill='000'O
         1 000220   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         1 000221   100002 000002                    ADSC9   2,Q,PR1                  cn=0,n=2

      180     1874    3                B$ECCBI.FLAGS(I+4) = '1'B;

   1874  1 000222   200005 235100                    LDA     I,,AUTO
         1 000223   000225 605000 1                  TPL     s:1874+3
         1 000224   000044 035003                    ADLA    36,DU
         1 000225   000005 471400 xsym               LDP1    B_MPT+5
         1 000226   003105 060400                    CSL     bolr='003'O
         1 000227   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:27   
         1 000230   100004 040001                    BDSC    4,A,PR1                  by=0,bit=4,n=1

      181     1875    3              END;

      182     1876    2         END;

   1876  1 000231   200005 054100                    AOS     I,,AUTO
         1 000232   200005 235100                    LDA     I,,AUTO
         1 000233   000003 115007                    CMPA    3,DL
         1 000234   000205 604400 1                  TMOZ    s:1871

      183     1877                                                /*                                    */
      184     1878                                      /*  Copy Fault Flags from the FPT to the ECCB   */
      185     1879    2      DO I = 0 TO 17;

   1879  1 000235   200005 450100                    STZ     I,,AUTO

      186     1880    2           IF FLAG_TABLE(I) = '1'B

   1880  1 000236   200005 235100                    LDA     I,,AUTO
         1 000237   000241 605000 1                  TPL     s:1880+3
         1 000240   000044 035003                    ADLA    36,DU
         1 000241   000000 066405                    CMPB    filb='0'B
         1 000242   000003 000001 0                  BDSC    FLAG_TABLE,A             by=0,bit=0,n=1
         1 000243   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000244   000305 600000 1                  TZE     s:1885

      187     1881    2           THEN IF FPT$->PTC1.FLAGS(I) = '00'B

   1881  1 000245   200005 235100                    LDA     I,,AUTO
         1 000246   000001 735000                    ALS     1
         1 000247   000251 605000 1                  TPL     s:1881+4
         1 000250   000044 035003                    ADLA    36,DU
         1 000251   200004 470500                    LDP0    FPT$,,AUTO
         1 000252   000000 066505                    CMPB    filb='0'B
         1 000253   000004 000002                    BDSC    4,A,PR0                  by=0,bit=0,n=2
         1 000254   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:28   
         1 000255   000266 601000 1                  TNZ     s:1883

      188     1882    2                THEN B$ECCBI.FLAGS(I+18) = '0'B;

   1882  1 000256   200005 235100                    LDA     I,,AUTO
         1 000257   000261 605000 1                  TPL     s:1882+3
         1 000260   000044 035003                    ADLA    36,DU
         1 000261   000005 471400 xsym               LDP1    B_MPT+5
         1 000262   003105 060400                    CSL     bolr='003'O
         1 000263   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         1 000264   100004 400001                    BDSC    4,A,PR1                  by=2,bit=0,n=1
         1 000265   000305 710000 1                  TRA     s:1885

      189     1883    2                ELSE IF FPT$->PTC1.FLAGS(I) = '10'B

   1883  1 000266   200005 235100                    LDA     I,,AUTO
         1 000267   000001 735000                    ALS     1
         1 000270   000272 605000 1                  TPL     s:1883+4
         1 000271   000044 035003                    ADLA    36,DU
         1 000272   000000 066505                    CMPB    filb='0'B
         1 000273   000004 000002                    BDSC    4,A,PR0                  by=0,bit=0,n=2
         1 000274   000030 000022 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=18
         1 000275   000305 601000 1                  TNZ     s:1885

      190     1884    2                     THEN B$ECCBI.FLAGS(I+18) = '1'B;

   1884  1 000276   200005 235100                    LDA     I,,AUTO
         1 000277   000301 605000 1                  TPL     s:1884+3
         1 000300   000044 035003                    ADLA    36,DU
         1 000301   000005 471400 xsym               LDP1    B_MPT+5
         1 000302   003105 060400                    CSL     bolr='003'O
         1 000303   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         1 000304   100004 400001                    BDSC    4,A,PR1                  by=2,bit=0,n=1

      191     1885    2         END;

   1885  1 000305   200005 054100                    AOS     I,,AUTO
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:29   
         1 000306   200005 235100                    LDA     I,,AUTO
         1 000307   000021 115007                    CMPA    17,DL
         1 000310   000236 604400 1                  TMOZ    s:1880

      192     1886    1      RETURN;

   1886  1 000311   000000 702200 xent               TSX2  ! X66_ARET

   1883  1 000312                       NO_PTC       null
      193     1887                                                /*                                    */
      194     1888                                                /*                                    */
      195     1889    1   NO_PTC: ;
      196     1890    1      IF V$->FPT$TRAP_V.FLAGS.RESTORE = '10'B

   1890  1 000312   200003 470500                    LDP0    @V$,,AUTO
         1 000313   000000 471500                    LDP1    0,,PR0
         1 000314   100004 236100                    LDQ     4,,PR1
         1 000315   000060 376003                    ANQ     48,DU
         1 000316   000040 116003                    CMPQ    32,DU
         1 000317   000324 601000 1                  TNZ     s:1898

      197     1891    2      THEN DO;

      198     1892    2           B$JIT.ERR=EMPTC;

   1892  1 000320   000004 236000 0                  LDQ     EMPTC
         1 000321   000000 473400 xsym               LDP3    B$JIT$
         1 000322   300012 756100                    STQ     10,,PR3

      199     1893    2           RETURN;

   1893  1 000323   000000 702200 xent               TSX2  ! X66_ARET

      200     1894        /*E*   ERROR:  HFE-E$MISSING_PTC-E
      201     1895               MESSAGE:  Restore without PTC (M$TRAP)
      202     1896        */
      203     1897    2         END;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:30   
      204     1898    1      ACTION=0;                            /* PTC not specified                  */

   1898  1 000324   200007 450100                    STZ     ACTION,,AUTO

      205     1899    1      FPT$=V$;

   1899  1 000325   000000 236100                    LDQ     0,,PR0
         1 000326   200004 756100                    STQ     FPT$,,AUTO

      206     1900    1      GOTO CHECK_TD;

   1900  1 000327   000023 710000 1                  TRA     CHECK_TD

      207     1901        %EJECT;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:31   
      208     1902                                                /*****************************/
      209     1903                                                /*        M$STRAP                     */
      210     1904                                                /*****************************/
      211     1905    1   HFE$M$STRAP:ENTRY (V$);

   1905  1 000330   000000 700200 xent  HFE$M$STRAP  TSX0  ! X66_AUTO_1
         1 000331   000022 000001                    ZERO    18,1

      212     1906    1      FAULT_CODE = V$->FPT$STRAP_V.STRAP;

   1906  1 000332   200003 470500                    LDP0    @V$,,AUTO
         1 000333   000000 471500                    LDP1    0,,PR0
         1 000334   100000 236100                    LDQ     0,,PR1
         1 000335   000037 772000                    QRL     31
         1 000336   000037 736000                    QLS     31
         1 000337   200006 756100                    STQ     FAULT_CODE,,AUTO

      213     1907    1      FINFO.FLTREG = FLTREGS(FAULT_CODE);

   1907  1 000340   200006 236100                    LDQ     FAULT_CODE,,AUTO
         1 000341   000037 772000                    QRL     31
         1 000342   000003 402007                    MPY     3,DL
         1 000343   003100 060406                    CSL     bolr='003'O
         1 000344   000000 000003 0                  BDSC    FLTREGS,Q                by=0,bit=0,n=3
         1 000345   200011 000044                    BDSC    FINFO,,AUTO              by=0,bit=0,n=36

      214     1908    1      IF (FINFO.FLTREG = NOT_USER_FAULT)    OR (FAULT_CODE > 21)

   1908  1 000346   200011 236100                    LDQ     FINFO,,AUTO
         1 000347   000010 116000 0                  CMPQ    EBADSTRAP+2
         1 000350   000355 600000 1                  TZE     BAD_STRAP
         1 000351   200006 236100                    LDQ     FAULT_CODE,,AUTO
         1 000352   760000 376003                    ANQ     -8192,DU
         1 000353   540000 116003                    CMPQ    -81920,DU
         1 000354   000361 602000 1                  TNC     s:1917

      215     1909    2      THEN DO;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:32   

   1908  1 000355                       BAD_STRAP    null
      216     1910    2   BAD_STRAP: ;
      217     1911    2           B$JIT.ERR=EBADSTRAP;

   1911  1 000355   000006 236000 0                  LDQ     EBADSTRAP
         1 000356   000000 470400 xsym               LDP0    B$JIT$
         1 000357   000012 756100                    STQ     10,,PR0

      218     1912        /*E*   ERROR:  HFE-E$BAD_STRAP_CODE-E
      219     1913               MESSAGE: Not a user visible fault (M$STRAP).
      220     1914        */
      221     1915    2         END;

   1915  1 000360   000477 710000 1                  TRA     s:1943

      222     1916    2      ELSE DO;

      223     1917    2           B$SS.FC = FAULT_CODE;

   1917  1 000361   000000 471400 xsym               LDP1    B_MPT
         1 000362   200006 236100                    LDQ     FAULT_CODE,,AUTO
         1 000363   000014 772000                    QRL     12
         1 000364   100005 676100                    ERQ     5,,PR1
         1 000365   000076 376003                    ANQ     62,DU
         1 000366   100005 656100                    ERSQ    5,,PR1

      224     1918    2           IF HW_FLTIC_OK THEN

   1918  1 000367   000000 234000 xsym               SZN     HW_FLTIC_OK
         1 000370   000375 605000 1                  TPL     s:1921

      225     1919    2                B$SS.IC = B$SS.IC-2;

   1919  1 000371   100004 220100                    LDX0    4,,PR1
         1 000372   777776 621010                    EAX1    -2,X0
         1 000373   100004 741100                    STX1    4,,PR1
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:33   
         1 000374   000400 710000 1                  TRA     s:1923

      226     1920    2           ELSE
      227     1921    2                B$SS.IC = B$SS.IC-1;

   1921  1 000375   100004 220100                    LDX0    4,,PR1
         1 000376   777777 621010                    EAX1    -1,X0
         1 000377   100004 741100                    STX1    4,,PR1

      228     1922                                                /*HFB$VISIBLE will back it one more   */
      229     1923    2           FINFO.P# =0;

   1923  1 000400   200014 450100                    STZ     FINFO+3,,AUTO

      230     1924    2           FINFO.JERR=EBADSTRAP;           /*TO SET  FCG-MID                     */

   1924  1 000401   000006 236000 0                  LDQ     EBADSTRAP
         1 000402   200013 756100                    STQ     FINFO+2,,AUTO

      231     1925    2           FINFO.JERR.CODE=FAULT_CODE+500;

   1925  1 000403   200006 236100                    LDQ     FAULT_CODE,,AUTO
         1 000404   000037 772000                    QRL     31
         1 000405   000764 036007                    ADLQ    500,DL
         1 000406   000003 736000                    QLS     3
         1 000407   200013 676100                    ERQ     FINFO+2,,AUTO
         1 000410   377770 376007                    ANQ     131064,DL
         1 000411   200013 656100                    ERSQ    FINFO+2,,AUTO

      232     1926    2           ACTION=0;

   1926  1 000412   200007 450100                    STZ     ACTION,,AUTO

      233     1927    2           CALL HFB$VISIBLE(FINFO,ACTION,ECC);

   1927  1 000413   200010 633500                    EPPR3   ECC,,AUTO
         1 000414   200020 453500                    STP3    FINFO+7,,AUTO
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:34   
         1 000415   200007 634500                    EPPR4   ACTION,,AUTO
         1 000416   200017 454500                    STP4    FINFO+6,,AUTO
         1 000417   200011 635500                    EPPR5   FINFO,,AUTO
         1 000420   200016 455500                    STP5    FINFO+5,,AUTO
         1 000421   200016 630500                    EPPR0   FINFO+5,,AUTO
         1 000422   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000423   000000 701000 xent               TSX1    HFB$VISIBLE
         1 000424   000000 011000                    NOP     0

      234     1928    3           DO CASE (ACTION);

   1928  1 000425   200007 235100                    LDA     ACTION,,AUTO
         1 000426   000007 115007                    CMPA    7,DL
         1 000427   000431 602005 1                  TNC     s:1928+4,AL
         1 000430   000472 710000 1                  TRA     s:1939
         1 000431   000472 710000 1                  TRA     s:1939
         1 000432   000472 710000 1                  TRA     s:1939
         1 000433   000472 710000 1                  TRA     s:1939
         1 000434   000440 710000 1                  TRA     s:1930
         1 000435   000472 710000 1                  TRA     s:1939
         1 000436   000447 710000 1                  TRA     s:1933
         1 000437   000456 710000 1                  TRA     s:1936

      235     1929    3            CASE(SEXIT);

      236     1930    3              CALL UDB$CALCOMP;

   1930  1 000440   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000441   000000 701000 xent               TSX1    UDB$CALCOMP
         1 000442   000000 011000                    NOP     0

      237     1931    3              CALL UDB$AUTO;

   1931  1 000443   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000444   000000 701000 xent               TSX1    UDB$AUTO
         1 000445   000000 011000                    NOP     0
         1 000446   000477 710000 1                  TRA     s:1943
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:35   

      238     1932    3            CASE(ABORTM);

      239     1933    3              CALL UDB$CALCOMP;

   1933  1 000447   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000450   000000 701000 xent               TSX1    UDB$CALCOMP
         1 000451   000000 011000                    NOP     0

      240     1934    3              CALL JSE$ABORTM;

   1934  1 000452   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000453   000000 701000 xent               TSX1    JSE$ABORTM
         1 000454   000000 011000                    NOP     0
         1 000455   000477 710000 1                  TRA     s:1943

      241     1935    3            CASE(DELTAGO);

      242     1936    3              CALL UDB$CALCOMP;

   1936  1 000456   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000457   000000 701000 xent               TSX1    UDB$CALCOMP
         1 000460   000000 011000                    NOP     0

      243     1937    3              CALL SSU$DELTAGO (ECC,FINFO);

   1937  1 000461   200011 630500                    EPPR0   FINFO,,AUTO
         1 000462   200017 450500                    STP0    FINFO+6,,AUTO
         1 000463   200010 631500                    EPPR1   ECC,,AUTO
         1 000464   200016 451500                    STP1    FINFO+5,,AUTO
         1 000465   200016 630500                    EPPR0   FINFO+5,,AUTO
         1 000466   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000467   000000 701000 xent               TSX1    SSU$DELTAGO
         1 000470   000000 011000                    NOP     0
         1 000471   000477 710000 1                  TRA     s:1943

      244     1938    3            CASE(ELSE);
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:36   

      245     1939    3              B$SS.IC=B$SS.IC+2;

   1939  1 000472   000000 470400 xsym               LDP0    B_MPT
         1 000473   000004 220100                    LDX0    4,,PR0
         1 000474   000002 621010                    EAX1    2,X0
         1 000475   000004 741100                    STX1    4,,PR0

      246     1940    3              GOTO BAD_STRAP;

   1940  1 000476   000355 710000 1                  TRA     BAD_STRAP

      247     1941    3            END;

      248     1942    2         END;
      249     1943    1      RETURN;

   1943  1 000477   000000 702200 xent               TSX2  ! X66_ARET

FLTREGS
 Sect OctLoc
   0     000   700071 007747   700707 070077   777777 77****                    .9....8?....

FLAG_TABLE
 Sect OctLoc
   0     003   761777 0*****                                                    ....

EMPTC
 Sect OctLoc
   0     004   100605 410164                                                    @..t

ENOTD
 Sect OctLoc
   0     005   100605 410174                                                    @..|

EBADSTRAP
 Sect OctLoc
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:37   
   0     006   100605 410204                                                    @...

(unnamed)
 Sect OctLoc
   0     007   000000 000100   700000 000000                                    ...@....

(unnamed)
 Sect OctLoc
   2     000   000003 006000                                                    ....
      250     1944        %EJECT;
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:38   
      251     1945                                                /*   HFE DEFAULT ERROR MESSAGES       */
      252     1946        /*E*   ERROR:  HFE-E$MEMORY-E
      253     1947               MESSAGE: (M$STRAP)  Memory fault
      254     1948        */
      255     1949        /*E*   ERROR:  HFE-E$MME-E
      256     1950               MESSAGE: (M$STRAP)  MME fault
      257     1951        */
      258     1952        /*E*   ERROR:  HFE-E$FAULT_TAG-E
      259     1953               MESSAGE: (M$STRAP)  Fault Tag fault
      260     1954        */
      261     1955        /*E*   ERROR:  HFE-E$COMMAND-E
      262     1956               MESSAGE: (M$STRAP)  Command fault
      263     1957        */
      264     1958        /*E*   ERROR:  HFE-E$DERAIL-E
      265     1959               MESSAGE: (M$STRAP)  Derail fault
      266     1960        */
      267     1961        /*E*   ERROR:  HFE-E$LOCKUP-E
      268     1962               MESSAGE: (M$STRAP)  Lockup fault
      269     1963        */
      270     1964        /*E*   ERROR:  HFE-E$PRTY-E
      271     1965               MESSAGE: (M$STRAP)  Parity Error fault
      272     1966        */
      273     1967        /*E*   ERROR:  HFE-E$IPR-E
      274     1968               MESSAGE: (M$STRAP)  Illegal Procedure fault
      275     1969        */
      276     1970        /*E*   ERROR:  HFE-E$OPNC-E
      277     1971               MESSAGE: (M$STRAP)  OP Not Complete fault
      278     1972        */
      279     1973        /*E*   ERROR:  HFE-E$OVERFLOW-E
      280     1974               MESSAGE: (M$STRAP)  Overflow fault
      281     1975        */
      282     1976        /*E*   ERROR:  HFE-E$DIVIDE_CHECK-E
      283     1977               MESSAGE: (M$STRAP)  Divide Check fault
      284     1978        */
      285     1979        /*E*   ERROR:  HFE-E$SECURITY_1-E
      286     1980               MESSAGE: (M$STRAP)  Security 1 fault
      287     1981        */
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:39   
      288     1982        /*E*   ERROR:  HFE-E$DLNK-E
      289     1983               MESSAGE: (M$STRAP)  Dynamic Link fault
      290     1984        */
      291     1985        /*E*   ERROR:  HFE-E$MISSING_SEGMENT-E
      292     1986               MESSAGE: (M$STRAP)  Missing Segment fault
      293     1987        */
      294     1988        /*E*   ERROR: HFE-E$MWSP-E
      295     1989               MESSAGE: (M$STRAP)  Missing Work Space fault
      296     1990        */
      297     1991        /*E*   ERROR:  HFE-E$MISSING_PAGE-E
      298     1992               MESSAGE: (M$STRAP)  Missing Page fault
      299     1993        */
      300     1994        /*E*   ERROR:  HFE-E$SECURITY_2-E
      301     1995               MESSAGE: (M$STRAP)  Security 2 fault
      302     1996        */
      303     1997    1   END HFE$M$TRAP;

PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:40   
--  Include file information  --

   HF_ERRORS_C.:E05TOU  is referenced.
   B_MAGIC_C.:E05TOU  is referenced.
   UE$CP6V_C.:E05TOU  is referenced.
   UE_CP6.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure HFE$M$TRAP.
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:41   

 **** Variables and constants ****

  ****  Section 000 RoData HFE$M$TRAP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/b STRC        r     1 EBADSTRAP                  4-0-0/b STRC        r     1 EMPTC
     5-0-0/b STRC        r     1 ENOTD
     3-0-0/b BIT         r     1 FLAG_TABLE(0:17)
     0-0-0/b BIT (3)     r     1 FLTREGS(0:31)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @V$                        7-0-0/w UBIN        r     1 ACTION
    10-0-0/w UBIN        r     1 ECC                        6-0-0/w UBIN(5)     r     1 FAULT_CODE
    11-0-0/w STRC(144)   r     1 FINFO                      4-0-0/w PTR         r     1 FPT$
     5-0-0/w SBIN        r     1 I                         *0-0-0/w PTR         r     1 V$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS1$
     0-0-0/d STRC(432)   r     1 B_MPT                      0-0-0/b BIT         r     1 HW_FLTIC_OK

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 B$ECCB                     0-0-0/w STRC(180)   r     1 B$ECCBI
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(2304)  r     1 B$SS
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:42   
     0-0-0/d STRC(72)    r     1 FPT$STRAP_V                0-0-0/d STRC(216)   r     1 FPT$TRAP_V
     0-0-0/w STRC(180)   r     1 PTC1                       0-0-0/w STRC(180)   r     1 PTC2


   Procedure HFE$M$TRAP requires 320 words for executable code.
   Procedure HFE$M$TRAP requires 18 words of local(AUTO) storage.

    No errors detected in file HFE$PMME.:E05TSI    .
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:43   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:44   
          MINI XREF LISTING

ACTION
        17**DCL      1811<<ASSIGN   1832>>IF       1898<<ASSIGN   1926<<ASSIGN   1927<>CALL     1928>>DOCASE
B$ECCB.FLTFLG
      1328**DCL      1841<<ASSIGN
B$ECCBI.ECIC
      1322**DCL      1839<<ASSIGN   1849>>ASSIGN   1873<<ASSIGN
B$ECCBI.FLAGS
      1322**DCL      1838<<ASSIGN   1847>>IF       1859>>IF       1874<<ASSIGN   1882<<ASSIGN   1884<<ASSIGN
B$JIT.ERR
       529**DCL      1823<<ASSIGN   1892<<ASSIGN   1911<<ASSIGN
B$JIT.ERR.MID
       530**DCL       530--REDEF
B$JIT.PRIV.AUTH
       570**DCL      1820>>IF
B$JIT$
      1647**DCL       524--IMP-PTR  1820>>IF       1823>>ASSIGN   1892>>ASSIGN   1911>>ASSIGN
B$PS1$
      1648**DCL      1813>>ASSIGN   1849>>ASSIGN   1850>>ASSIGN   1852>>ASSIGN   1855>>ASSIGN   1860>>ASSIGN
      1861>>ASSIGN
B$SS.FC
        71**DCL      1917<<ASSIGN
B$SS.IC
        49**DCL      1919<<ASSIGN   1919>>ASSIGN   1921<<ASSIGN   1921>>ASSIGN   1939<<ASSIGN   1939>>ASSIGN
B$SS.RVA
        82**DCL        83--REDEF
BAD_STRAP
      1908**LABEL    1940--GOTO
B_MPT.AS
      1590**DCL      1593--REDEF
B_MPT.ASDESC
      1622**DCL      1626--REDEF
B_MPT.ECCB
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:45   
      1605**DCL      1608--REDEF
B_MPT.ECCB$
      1608**DCL      1838>>ASSIGN   1839>>ASSIGN   1841>>ASSIGN   1847>>IF       1849>>ASSIGN   1859>>IF
      1873>>ASSIGN   1874>>ASSIGN   1882>>ASSIGN   1884>>ASSIGN
B_MPT.ECCBDESC
      1640**DCL      1644--REDEF
B_MPT.LS
      1585**DCL      1588--REDEF
B_MPT.LSDESC
      1616**DCL      1620--REDEF
B_MPT.PS
      1595**DCL      1598--REDEF
B_MPT.PSDESC
      1628**DCL      1632--REDEF
B_MPT.SS
      1580**DCL      1583--REDEF
B_MPT.SS$
      1583**DCL      1917>>ASSIGN   1919>>ASSIGN   1919>>ASSIGN   1921>>ASSIGN   1921>>ASSIGN   1939>>ASSIGN
      1939>>ASSIGN
B_MPT.SSDESC
      1610**DCL      1614--REDEF
B_MPT.TCB
      1600**DCL      1603--REDEF
B_MPT.TCBDESC
      1634**DCL      1638--REDEF
CHECK_TD
      1812**LABEL    1900--GOTO
EBADSTRAP
      1798**DCL      1911>>ASSIGN   1924>>ASSIGN
ECC
        18**DCL      1927<>CALL     1937<>CALL
EMPTC
      1782**DCL      1892>>ASSIGN
ENOTD
      1790**DCL      1823>>ASSIGN
FAULT_CODE
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:46   
        16**DCL      1906<<ASSIGN   1907>>ASSIGN   1908>>IF       1917>>ASSIGN   1925>>ASSIGN
FINFO
        19**DCL      1927<>CALL     1937<>CALL
FINFO.FLTREG
        20**DCL      1907<<ASSIGN   1908>>IF
FINFO.JERR
        22**DCL      1924<<ASSIGN
FINFO.JERR.CODE
        26**DCL      1925<<ASSIGN
FINFO.P#
        28**DCL      1923<<ASSIGN
FLAG_TABLE
      1656**DCL      1858>>IF       1880>>IF
FLTREGS
      1651**DCL      1907>>ASSIGN
FPT$
        14**DCL      1813<<ASSIGN   1815<<ASSIGN   1820>>IF       1871>>IF       1873>>ASSIGN   1881>>IF
      1883>>IF       1899<<ASSIGN
FPT$STRAP_V.STRAP
      1423**DCL      1906>>ASSIGN
FPT$TRAP_V.FLAGS.HARDWARE
      1419**DCL      1820>>IF
FPT$TRAP_V.FLAGS.RESTORE
      1418**DCL      1812>>IF       1834>>IF       1890>>IF
FPT_TO_ECCB
      1861**LABEL    1832--GOTO
HFB$VISIBLE
      1660**DCL-ENT  1927--CALL
HFF$NILERASE
      1661**DCL-ENT  1810--CALL
HW_FLTIC_OK
      1649**DCL      1918>>IF
I
        15**DCL      1837<<DOINDEX  1838>>ASSIGN   1839>>ASSIGN   1846<<DOINDEX  1847>>IF       1849>>ASSIGN
      1849>>ASSIGN   1850>>ASSIGN   1852>>ASSIGN   1857<<DOINDEX  1858>>IF       1859>>IF       1860>>ASSIGN
      1861>>ASSIGN   1870<<DOINDEX  1871>>IF       1873>>ASSIGN   1873>>ASSIGN   1874>>ASSIGN   1879<<DOINDEX
PL6.E3A0      #001=HFE$M$TRAP File=HFE$PMME.:E05TSI                              TUE 07/29/97 22:24 Page:47   
      1880>>IF       1881>>IF       1882>>ASSIGN   1883>>IF       1884>>ASSIGN
JSE$ABORTM
      1662**DCL-ENT  1934--CALL
NO_PTC
      1883**LABEL    1810--CALLALT
PTC1.ENTADDRS
      1427**DCL      1852<<ASSIGN   1871>>IF
PTC1.FLAGS
      1428**DCL      1860<<ASSIGN   1861<<ASSIGN   1881>>IF       1883>>IF
PTC2.ENTADDRS.EFLAGS
      1433**DCL      1850<<ASSIGN
PTC2.ENTADDRS.IC
      1432**DCL      1849<<ASSIGN   1873>>ASSIGN
PTC2.FLAGS
      1434**DCL      1855<<ASSIGN
SSU$DELTAGO
      1664**DCL-ENT  1937--CALL
UDB$AUTO
      1663**DCL-ENT  1931--CALL
UDB$CALCOMP
      1665**DCL-ENT  1930--CALL     1933--CALL     1936--CALL
V$
        11**DCL         9--PROC     1812>>IF       1815>>ASSIGN   1834>>IF       1890>>IF       1899>>ASSIGN
      1905--ENTRY    1906>>ASSIGN
