VERSION E05

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:1    
        1        1        /*M* QQA$DCB_CON - Process DCB connect events */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$DCB_CON
        9        9
       10       10             PURPOSE:     To process *AUEV messages for DCB connect events
       11       11        */
       12       12        /*D* NAME:        QQA$DCB_CON
       13       13
       14       14             CALL:        CALL QQA$DCB_CON
       15       15
       16       16             INPUT:       The contents of the *AUEV message
       17       17
       18       18             OUTPUT:      None
       19       19
       20       20             DESCRIPTION: This code breaks down into two basic paths.
       21       21
       22       22                          When QQC$START_TPU issues a M$GJOB pmme it
       23       23                          builds a information block onto the linked
       24       24                          list of active TPUs.  When a DCB connects
       25       25                          to TPA is searches this list to see if TPA
       26       26                          was the one who started the user who is now
       27       27                          connecting.  If so, then it will M$ACTIVATE
       28       28                          the DCB.
       29       29
       30       30                          If on the other hand it is a 'stranger' then
       31       31                          TPA will check to see if DCBCON has been set
       32       32                          and will then perform the M$ACTIVATE.  TPA
       33       33                          then builds an information block about this
       34       34                          DCB that is connecting and adds it to the
       35       35                          linked list of DCBs that are thought to
       36       36                          be connected to the comgroup.
       37       37        */
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:2    
       38       38        %EJECT;
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:3    
       39       39        QQA$DCB_CON:
       40       40                PROC;
       41       41
       42       42        %INCLUDE Q_PAGE_C;
       43       74        %SET LISTEXP = '1'B;
       44       75        %PAGE(ARG="Includes");

                92        /***************************************************************************
                93         *                                                                         *
                94         *                                  Includes                               *
                95         *                                                                         *
                96         ***************************************************************************/

       45      100        %INCLUDE QQ_SUPER_C;
       46      155        %INCLUDE QQ_MACROS_C;
       47      580        %INCLUDE QQ_PERR_C;
       48      741        %INCLUDE Q_ERRCODE_C;
       49      764        %INCLUDE QQ_SUBS_C;
       50      956        %INCLUDE CP_6;
       51     1037        %INCLUDE B_ERRORS_C;
       52     2164        %INCLUDE QQ_DATA_R;
       53     2410        %PAGE(ARG="Externally defined routines");

              2427    1   /***************************************************************************
              2428    1    *                                                                         *
              2429    1    *                        Externally defined routines                      *
              2430    1    *                                                                         *
              2431    1    ***************************************************************************/

       54     2435    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       55     2436    1   DCL QQC$BLDMSG ENTRY(1);
       56     2437    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       57     2438    1   DCL QQC$SCREECH ENTRY;
       58     2439        %PAGE(ARG="Symrefs");

              2456    1   /***************************************************************************
              2457    1    *                                                                         *
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:4    
              2458    1    *                                  Symrefs                                *
              2459    1    *                                                                         *
              2460    1    ***************************************************************************/

       59     2464    1   DCL B$TCB$ PTR SYMREF;
       60     2465        %PAGE(ARG="DCBs");

              2482    1   /***************************************************************************
              2483    1    *                                                                         *
              2484    1    *                                    DCBs                                 *
              2485    1    *                                                                         *
              2486    1    ***************************************************************************/

       61     2490    1   DCL M$CG DCB;
       62     2491        %PAGE(ARG="Based");

              2508    1   /***************************************************************************
              2509    1    *                                                                         *
              2510    1    *                                   Based                                 *
              2511    1    *                                                                         *
              2512    1    ***************************************************************************/

       63     2516        %B$TCB;
       64     2519        %B$ALT;
       65     2527        %B$CGAURD(STCLASS="BASED(QQ_GLOBAL.CMDBUF$)", LAST=", ");
       66     2546        %B$CGAUCI(LVL=2, LAST=", ");
       67     2568        %QQ$LOGON(LVL=2);
       68     2604        %TPU$INFO;
       69     2633        %PAGE(ARG="Static");

              2650    1   /***************************************************************************
              2651    1    *                                                                         *
              2652    1    *                                   Static                                *
              2653    1    *                                                                         *
              2654    1    ***************************************************************************/

       70     2658    1   DCL UTS UBIN WORD STATIC;
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:5    
       71     2659
       72     2660    1   DCL STATION CHAR(8) STATIC;
       73     2661
       74     2662        %VLP_NAME(FPTN=TEXTC_STATION, STCLASS=STATIC, NAME='12345678');
       75     2689        %PAGE(ARG="Auto");

              2706    1   /***************************************************************************
              2707    1    *                                                                         *
              2708    1    *                                    Auto                                 *
              2709    1    *                                                                         *
              2710    1    ***************************************************************************/

       76     2714    1   DCL NEXT$ PTR;
       77     2715    1   DCL TAIL$ PTR;
       78     2716
       79     2717        %MSGBLK;
       80     2807        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:6    
              2824    1   /***************************************************************************
              2825    1    *                                                                         *
              2826    1    *                                Error codes                              *
              2827    1    *                                                                         *
              2828    1    ***************************************************************************/

       81     2832        %ERRCODE(NAME=CODE_ILLEGAL_DCB, CODE#=%E$ILLEGAL_DCB, FCG#=%FCG_QQ, MID#=%MID_A);
       82     2839        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
       83     2846
       84     2847        /*E*       ERROR: QQA-E$ILLEGAL_DCB-C
       85     2848
       86     2849                 MESSAGE: An illegal DCB has attempted to connect to
       87     2850                          the TP comgroup.  DCBCON is OFF.  The
       88     2851                          DCB's id is %U1
       89     2852             DESCRIPTION: The station of a DCB trying to connect to a TP
       90     2853                          comgroup must be of the form TPCP####.  In
       91     2854                          addition, we must be expecting him to connect
       92     2855                          (since we are the one who starts a TPU we
       93     2856                          know when one should be trying to connect).
       94     2857                          Other DCBs will be permitted to connect to the
       95     2858                          instance if DCBCON is ON.
       96     2859        */
       97     2860        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:7    
              2877    1   /***************************************************************************
              2878    1    *                                                                         *
              2879    1    *                                    FPTs                                 *
              2880    1    *                                                                         *
              2881    1    ***************************************************************************/

       98     2885        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
       99     2904
      100     2905        %FPT_ACTIVATE(DCB=M$CG, STATION=STATION, DISCONNECT=YES);
      101     2928        %PAGE(ARG="QQA$DCB_CON", PAGE=YES);

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:8    
              2945    1   /***************************************************************************
              2946    1    *                                                                         *
              2947    1    *                                QQA$DCB_CON                              *
              2948    1    *                                                                         *
              2949    1    ***************************************************************************/

      102     2953    1           CALL M$TIME(FPT_TIME);
      103     2954
      104     2955    1           NEXT$ = QQ_GLOBAL.TPU$;
      105     2956    1           STATION = B$CGAURD.STATION;
      106     2957
      107     2958    1           IF STATION = 'HOLDSTA' OR STATION = 'INFOSTA' OR
      108     2959    1               STATION = 'JRNLSTA' THEN
      109     2960    2             DO;
      110     2961    2               CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(MON_ERR);
      111     2962    2               GOTO RET;
      112     2963    2             END;
      113     2964
      114     2965    2           DO WHILE('1'B);
      115     2966
      116     2967    2             NEXT$ = NEXT$ -> TPU$INFO.FLINK$;
      117     2968    2             IF NEXT$ -> TPU$INFO.FLINK$ = ADDR(NIL) THEN
      118     2969    3               DO;
      119     2970    3                 GOTO NOT_FOUND;
      120     2971    3               END;
      121     2972
      122     2973    2             IF NEXT$ -> TPU$INFO.SYSID = B$CGAURD.B$CGAUCI.SYSID AND
      123     2974    2                 NEXT$ -> TPU$INFO.STATION = STATION THEN
      124     2975    3               DO;
      125     2976    3                 IF QQ_GLOBAL.TPU_CNT >= QQ_GLOBAL.TPUMAX THEN
      126     2977    4                   DO;
      127     2978    4                     GOTO DISCO;
      128     2979    4                   END;
      129     2980
      130     2981    3                 CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);
      131     2982    3                 NEXT$ -> TPU$INFO.UTS = UTS;
      132     2983    3                 NEXT$ -> TPU$INFO.FLAGS.CONNECT = '1'B;
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:9    
      133     2984    3                 GOTO RET;
      134     2985    3               END;
      135     2986    2           END /* WHILE */;
      136     2987
      137     2988    1   NOT_FOUND:
      138     2989    1           IF QQ_GLOBAL.STRANGER_CNT >= QQ_GLOBAL.STRANGERMAX THEN
      139     2990    2             DO;
      140     2991    2               GOTO DISCO;
      141     2992    2             END;
      142     2993
      143     2994    1           IF QQ_GLOBAL.DCBCON THEN
      144     2995    2             DO;
      145     2996    2               CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);
      146     2997
      147     2998    3               DO WHILE('0'B);
      148     2999
      149     3000    3   ACTIVATE_ERR:
      150     3001    3                 IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */THEN
      151     3002    4                   DO;
      152     3003    4                     GOTO MON_ERR;
      153     3004    4                   END;
      154     3005
      155     3006    3                 GOTO RET;
      156     3007    3               END /* NEVER */;
      157     3008
      158     3009    2               CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, SIZEW(TPU$INFO), T$) ALTRET(NO_MEM);
      159     3010
      160     3011    2               TPU$INFO.FLAGS = '0'B;
      161     3012    2               TPU$INFO.STATION = STATION;
      162     3013    2               TPU$INFO.TIMEOUT = 0;       /*  set to 0 by default               */
      163     3014    2               TPU$INFO.FLAGS.STRANGER = '1'B;
      164     3015    2               TPU$INFO.FLAGS.CONNECT = '1'B;
      165     3016    2               TPU$INFO.SYSID = B$CGAURD.B$CGAUCI.SYSID;
      166     3017    2               TPU$INFO.UTS = UTS;
      167     3018
      168     3019    2               TAIL$ = QQ_GLOBAL.TPU$ -> TPU$INFO.BLINK$;
      169     3020    2               TPU$INFO.FLINK$ = TAIL$;
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:10   
      170     3021    2               TPU$INFO.BLINK$ = TAIL$ -> TPU$INFO.BLINK$;
      171     3022    2               TAIL$ -> TPU$INFO.BLINK$ -> TPU$INFO.FLINK$ = T$;
      172     3023    2               TAIL$ -> TPU$INFO.BLINK$ = T$;
      173     3024    2               QQ_GLOBAL.STRANGER_CNT = QQ_GLOBAL.STRANGER_CNT + 1;
      174     3025
      175     3026    2               GOTO RET;
      176     3027    2             END;
      177     3028
      178     3029    1           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      179     3030    1           MSGBLK.ERRINFO.ERR(0) = CODE_ILLEGAL_DCB;
      180     3031    1           TEXTC_STATION.NAME# = STATION;
      181     3032    1           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);
      182     3033    1           CALL QQC$BLDMSG(MSGBLK);
      183     3034
      184     3035    1   DISCO:
      185     3036    1           CALL M$DEACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);
      186     3037
      187     3038    1   RET:
      188     3039    1           RETURN;
      189     3040
      190     3041    1   NO_MEM:
      191     3042    1           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;
      192     3043    1           GOTO SCREECH;
      193     3044
      194     3045    1   MON_ERR:
      195     3046    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      196     3047
      197     3048    1   SCREECH:
      198     3049    1           CALL QQC$SCREECH;
      199     3050
      200     3051    1   END QQA$DCB_CON;

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:11   
--  Include file information  --

   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUPER_C.:E05TOU  is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$DCB_CON.

   Procedure QQA$DCB_CON requires 160 words for executable code.
   Procedure QQA$DCB_CON requires 32 words of local(AUTO) storage.

    No errors detected in file QQA$DCB_CON.:E05TSI    .

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:12   

 Object Unit name= QQA$DCB_CON                                File name= QQA$DCB_CON.:E05TOU
 UTS= JUL 30 '97 05:21:55.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2   Data  even  none    34     42  QQA$DCB_CON
    3  RoData even  UTS      8     10  QQA$DCB_CON
    4   Proc  even  none   160    240  QQA$DCB_CON
    5  RoData even  none     6      6  QQA$DCB_CON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  QQA$DCB_CON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 QQC$GET_BLK
         yes           Std       1 QQC$BLDMSG_ERRBLK
         yes           Std       1 QQC$BLDMSG
         yes           Std       0 QQC$SCREECH
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_GLOBAL                             B$TCB$
     M$CG                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:14   


        1        1        /*M* QQA$DCB_CON - Process DCB connect events */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$DCB_CON
        9        9
       10       10             PURPOSE:     To process *AUEV messages for DCB connect events
       11       11        */
       12       12        /*D* NAME:        QQA$DCB_CON
       13       13
       14       14             CALL:        CALL QQA$DCB_CON
       15       15
       16       16             INPUT:       The contents of the *AUEV message
       17       17
       18       18             OUTPUT:      None
       19       19
       20       20             DESCRIPTION: This code breaks down into two basic paths.
       21       21
       22       22                          When QQC$START_TPU issues a M$GJOB pmme it
       23       23                          builds a information block onto the linked
       24       24                          list of active TPUs.  When a DCB connects
       25       25                          to TPA is searches this list to see if TPA
       26       26                          was the one who started the user who is now
       27       27                          connecting.  If so, then it will M$ACTIVATE
       28       28                          the DCB.
       29       29
       30       30                          If on the other hand it is a 'stranger' then
       31       31                          TPA will check to see if DCBCON has been set
       32       32                          and will then perform the M$ACTIVATE.  TPA
       33       33                          then builds an information block about this
       34       34                          DCB that is connecting and adds it to the
       35       35                          linked list of DCBs that are thought to
       36       36                          be connected to the comgroup.
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:15   
       37       37        */
       38       38        %EJECT;
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:16   
       39       39        QQA$DCB_CON:
       40       40                PROC;

     40  4 000000   000000 700200 xent  QQA$DCB_CON  TSX0  ! X66_AUTO_0
         4 000001   000040 000000                    ZERO    32,0

       41       41
       42       42        %INCLUDE Q_PAGE_C;
       43       74        %SET LISTEXP = '1'B;
       44       75        %PAGE(ARG="Includes");

                92        /***************************************************************************
                93         *                                                                         *
                94         *                                  Includes                               *
                95         *                                                                         *
                96         ***************************************************************************/

       45      100        %INCLUDE QQ_SUPER_C;
       46      155        %INCLUDE QQ_MACROS_C;
       47      580        %INCLUDE QQ_PERR_C;
       48      741        %INCLUDE Q_ERRCODE_C;
       49      764        %INCLUDE QQ_SUBS_C;
       50      956        %INCLUDE CP_6;
       51     1037        %INCLUDE B_ERRORS_C;
       52     2164        %INCLUDE QQ_DATA_R;
       53     2410        %PAGE(ARG="Externally defined routines");

              2427    1   /***************************************************************************
              2428    1    *                                                                         *
              2429    1    *                        Externally defined routines                      *
              2430    1    *                                                                         *
              2431    1    ***************************************************************************/

       54     2435    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       55     2436    1   DCL QQC$BLDMSG ENTRY(1);
       56     2437    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       57     2438    1   DCL QQC$SCREECH ENTRY;
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:17   
       58     2439        %PAGE(ARG="Symrefs");

              2456    1   /***************************************************************************
              2457    1    *                                                                         *
              2458    1    *                                  Symrefs                                *
              2459    1    *                                                                         *
              2460    1    ***************************************************************************/

       59     2464    1   DCL B$TCB$ PTR SYMREF;
       60     2465        %PAGE(ARG="DCBs");

              2482    1   /***************************************************************************
              2483    1    *                                                                         *
              2484    1    *                                    DCBs                                 *
              2485    1    *                                                                         *
              2486    1    ***************************************************************************/

       61     2490    1   DCL M$CG DCB;
       62     2491        %PAGE(ARG="Based");

              2508    1   /***************************************************************************
              2509    1    *                                                                         *
              2510    1    *                                   Based                                 *
              2511    1    *                                                                         *
              2512    1    ***************************************************************************/

       63     2516        %B$TCB;
       64     2519        %B$ALT;
       65     2527        %B$CGAURD(STCLASS="BASED(QQ_GLOBAL.CMDBUF$)", LAST=", ");
       66     2546        %B$CGAUCI(LVL=2, LAST=", ");
       67     2568        %QQ$LOGON(LVL=2);
       68     2604        %TPU$INFO;
       69     2633        %PAGE(ARG="Static");

              2650    1   /***************************************************************************
              2651    1    *                                                                         *
              2652    1    *                                   Static                                *
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:18   
              2653    1    *                                                                         *
              2654    1    ***************************************************************************/

       70     2658    1   DCL UTS UBIN WORD STATIC;
       71     2659
       72     2660    1   DCL STATION CHAR(8) STATIC;
       73     2661
       74     2662        %VLP_NAME(FPTN=TEXTC_STATION, STCLASS=STATIC, NAME='12345678');
       75     2689        %PAGE(ARG="Auto");

              2706    1   /***************************************************************************
              2707    1    *                                                                         *
              2708    1    *                                    Auto                                 *
              2709    1    *                                                                         *
              2710    1    ***************************************************************************/

       76     2714    1   DCL NEXT$ PTR;
       77     2715    1   DCL TAIL$ PTR;
       78     2716
       79     2717        %MSGBLK;
       80     2807        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:19   
              2824    1   /***************************************************************************
              2825    1    *                                                                         *
              2826    1    *                                Error codes                              *
              2827    1    *                                                                         *
              2828    1    ***************************************************************************/

       81     2832        %ERRCODE(NAME=CODE_ILLEGAL_DCB, CODE#=%E$ILLEGAL_DCB, FCG#=%FCG_QQ, MID#=%MID_A);
       82     2839        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
       83     2846
       84     2847        /*E*       ERROR: QQA-E$ILLEGAL_DCB-C
       85     2848
       86     2849                 MESSAGE: An illegal DCB has attempted to connect to
       87     2850                          the TP comgroup.  DCBCON is OFF.  The
       88     2851                          DCB's id is %U1
       89     2852             DESCRIPTION: The station of a DCB trying to connect to a TP
       90     2853                          comgroup must be of the form TPCP####.  In
       91     2854                          addition, we must be expecting him to connect
       92     2855                          (since we are the one who starts a TPU we
       93     2856                          know when one should be trying to connect).
       94     2857                          Other DCBs will be permitted to connect to the
       95     2858                          instance if DCBCON is ON.
       96     2859        */
       97     2860        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:20   
              2877    1   /***************************************************************************
              2878    1    *                                                                         *
              2879    1    *                                    FPTs                                 *
              2880    1    *                                                                         *
              2881    1    ***************************************************************************/

       98     2885        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
       99     2904
      100     2905        %FPT_ACTIVATE(DCB=M$CG, STATION=STATION, DISCONNECT=YES);
      101     2928        %PAGE(ARG="QQA$DCB_CON", PAGE=YES);

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:21   
              2945    1   /***************************************************************************
              2946    1    *                                                                         *
              2947    1    *                                QQA$DCB_CON                              *
              2948    1    *                                                                         *
              2949    1    ***************************************************************************/

      102     2953    1           CALL M$TIME(FPT_TIME);

   2953  4 000002   000006 630400 2                  EPPR0   FPT_TIME
         4 000003   020004 713400                    CLIMB   8196
         4 000004   402000 401760                    pmme    nvectors=5

      103     2954
      104     2955    1           NEXT$ = QQ_GLOBAL.TPU$;

   2955  4 000005   000155 236000 xsym               LDQ     QQ_GLOBAL+109
         4 000006   200004 756100                    STQ     NEXT$,,AUTO

      105     2956    1           STATION = B$CGAURD.STATION;

   2956  4 000007   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         4 000010   040000 100500                    MLR     fill='040'O
         4 000011   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         4 000012   000001 000010 2                  ADSC9   STATION                  cn=0,n=8

      106     2957
      107     2958    1           IF STATION = 'HOLDSTA' OR STATION = 'INFOSTA' OR

   2958  4 000013   040000 106400                    CMPC    fill='040'O
         4 000014   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000015   000002 000007 3                  ADSC9   CODE_NO_POOLMEM+1        cn=0,n=7
         4 000016   000027 600000 4                  TZE     s:2961
         4 000017   040000 106400                    CMPC    fill='040'O
         4 000020   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000021   000004 000007 3                  ADSC9   CODE_NO_POOLMEM+3        cn=0,n=7
         4 000022   000027 600000 4                  TZE     s:2961
         4 000023   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:22   
         4 000024   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000025   000006 000007 3                  ADSC9   CODE_NO_POOLMEM+5        cn=0,n=7
         4 000026   000034 601000 4                  TNZ     s:2967

      108     2959    1               STATION = 'JRNLSTA' THEN
      109     2960    2             DO;

      110     2961    2               CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(MON_ERR);

   2961  4 000027   000022 630400 2                  EPPR0   FPT_ACTIVATE
         4 000030   500000 713400                    CLIMB   alt,+32768
         4 000031   401400 401760                    pmme    nvectors=4
         4 000032   000230 702000 4                  TSX2    MON_ERR

      111     2962    2               GOTO RET;

   2962  4 000033   000224 710000 4                  TRA     RET

      112     2963    2             END;
      113     2964
      114     2965    2           DO WHILE('1'B);

      115     2966
      116     2967    2             NEXT$ = NEXT$ -> TPU$INFO.FLINK$;

   2967  4 000034   200004 470500                    LDP0    NEXT$,,AUTO
         4 000035   000001 236100                    LDQ     1,,PR0
         4 000036   200004 756100                    STQ     NEXT$,,AUTO

      117     2968    2             IF NEXT$ -> TPU$INFO.FLINK$ = ADDR(NIL) THEN

   2968  4 000037   200004 470500                    LDP0    NEXT$,,AUTO
         4 000040   000001 236100                    LDQ     1,,PR0
         4 000041   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000042   000044 601000 4                  TNZ     s:2973

      118     2969    3               DO;
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:23   

      119     2970    3                 GOTO NOT_FOUND;

   2970  4 000043   000074 710000 4                  TRA     NOT_FOUND

      120     2971    3               END;
      121     2972
      122     2973    2             IF NEXT$ -> TPU$INFO.SYSID = B$CGAURD.B$CGAUCI.SYSID AND

   2973  4 000044   000052 471400 xsym               LDP1    QQ_GLOBAL+42
         4 000045   100014 236100                    LDQ     12,,PR1
         4 000046   000011 772000                    QRL     9
         4 000047   777777 376007                    ANQ     -1,DL
         4 000050   000002 116100                    CMPQ    2,,PR0
         4 000051   000034 601000 4                  TNZ     s:2967
         4 000052   040000 106500                    CMPC    fill='040'O
         4 000053   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         4 000054   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000055   000034 601000 4                  TNZ     s:2967

      123     2974    2                 NEXT$ -> TPU$INFO.STATION = STATION THEN
      124     2975    3               DO;

      125     2976    3                 IF QQ_GLOBAL.TPU_CNT >= QQ_GLOBAL.TPUMAX THEN

   2976  4 000056   000036 236000 xsym               LDQ     QQ_GLOBAL+30
         4 000057   000026 116000 xsym               CMPQ    QQ_GLOBAL+22
         4 000060   000062 602000 4                  TNC     s:2981

      126     2977    4                   DO;

      127     2978    4                     GOTO DISCO;

   2978  4 000061   000220 710000 4                  TRA     DISCO

      128     2979    4                   END;
      129     2980
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:24   
      130     2981    3                 CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);

   2981  4 000062   000022 630400 2                  EPPR0   FPT_ACTIVATE
         4 000063   500000 713400                    CLIMB   alt,+32768
         4 000064   401400 401760                    pmme    nvectors=4
         4 000065   000107 702000 4                  TSX2    ACTIVATE_ERR

      131     2982    3                 NEXT$ -> TPU$INFO.UTS = UTS;

   2982  4 000066   200004 470500                    LDP0    NEXT$,,AUTO
         4 000067   000000 235000 2                  LDA     UTS
         4 000070   000003 755100                    STA     3,,PR0

      132     2983    3                 NEXT$ -> TPU$INFO.FLAGS.CONNECT = '1'B;

   2983  4 000071   400000 236003                    LDQ     -131072,DU
         4 000072   000011 256100                    ORSQ    9,,PR0

      133     2984    3                 GOTO RET;

   2984  4 000073   000224 710000 4                  TRA     RET

      134     2985    3               END;
      135     2986    2           END /* WHILE */;

      136     2987
      137     2988    1   NOT_FOUND:
      138     2989    1           IF QQ_GLOBAL.STRANGER_CNT >= QQ_GLOBAL.STRANGERMAX THEN

   2989  4 000074   000043 236000 xsym  NOT_FOUND    LDQ     QQ_GLOBAL+35
         4 000075   000030 116000 xsym               CMPQ    QQ_GLOBAL+24
         4 000076   000100 602000 4                  TNC     s:2994

      139     2990    2             DO;

      140     2991    2               GOTO DISCO;

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:25   
   2991  4 000077   000220 710000 4                  TRA     DISCO

      141     2992    2             END;
      142     2993
      143     2994    1           IF QQ_GLOBAL.DCBCON THEN

   2994  4 000100   000012 234000 xsym               SZN     QQ_GLOBAL+10
         4 000101   000174 605000 4                  TPL     s:3029

      144     2995    2             DO;

      145     2996    2               CALL M$ACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);

   2996  4 000102   000022 630400 2                  EPPR0   FPT_ACTIVATE
         4 000103   500000 713400                    CLIMB   alt,+32768
         4 000104   401400 401760                    pmme    nvectors=4
         4 000105   000107 702000 4                  TSX2    ACTIVATE_ERR

      146     2997
      147     2998    3               DO WHILE('0'B);

   2998  4 000106   000117 710000 4                  TRA     s:3009

      148     2999
      149     3000    3   ACTIVATE_ERR:
      150     3001    3                 IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */THEN

   3001  4 000107   000000 470400 xsym  ACTIVATE_ERR LDP0    B$TCB$
         4 000110   000000 471500                    LDP1    0,,PR0
         4 000111   100102 236100                    LDQ     66,,PR1
         4 000112   377770 376007                    ANQ     131064,DL
         4 000113   022020 116007                    CMPQ    9232,DL
         4 000114   000116 600000 4                  TZE     s:3006

      151     3002    4                   DO;

      152     3003    4                     GOTO MON_ERR;
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:26   

   3003  4 000115   000230 710000 4                  TRA     MON_ERR

      153     3004    4                   END;
      154     3005
      155     3006    3                 GOTO RET;

   3006  4 000116   000224 710000 4                  TRA     RET

      156     3007    3               END /* NEVER */;

      157     3008
      158     3009    2               CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, SIZEW(TPU$INFO), T$) ALTRET(NO_MEM);

   3009  4 000117   200003 630500                    EPPR0   T$,,AUTO
         4 000120   200036 450500                    STP0    MSGBLK+24,,AUTO
         4 000121   000000 237000 5                  LDAQ    0
         4 000122   200034 757100                    STAQ    MSGBLK+22,,AUTO
         4 000123   200034 630500                    EPPR0   MSGBLK+22,,AUTO
         4 000124   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000125   000000 701000 xent               TSX1    QQC$GET_BLK
         4 000126   000225 702000 4                  TSX2    NO_MEM

      159     3010
      160     3011    2               TPU$INFO.FLAGS = '0'B;

   3011  4 000127   200003 470500                    LDP0    T$,,AUTO
         4 000130   000002 236000 5                  LDQ     2
         4 000131   000011 356100                    ANSQ    9,,PR0

      161     3012    2               TPU$INFO.STATION = STATION;

   3012  4 000132   040100 100400                    MLR     fill='040'O
         4 000133   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000134   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

      162     3013    2               TPU$INFO.TIMEOUT = 0;       /*  set to 0 by default               */
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:27   

   3013  4 000135   000010 450100                    STZ     8,,PR0

      163     3014    2               TPU$INFO.FLAGS.STRANGER = '1'B;

   3014  4 000136   040000 236003                    LDQ     16384,DU
         4 000137   000011 256100                    ORSQ    9,,PR0

      164     3015    2               TPU$INFO.FLAGS.CONNECT = '1'B;

   3015  4 000140   400000 236003                    LDQ     -131072,DU
         4 000141   000011 256100                    ORSQ    9,,PR0

      165     3016    2               TPU$INFO.SYSID = B$CGAURD.B$CGAUCI.SYSID;

   3016  4 000142   000052 471400 xsym               LDP1    QQ_GLOBAL+42
         4 000143   100014 236100                    LDQ     12,,PR1
         4 000144   000011 772000                    QRL     9
         4 000145   777777 376007                    ANQ     -1,DL
         4 000146   000002 756100                    STQ     2,,PR0

      166     3017    2               TPU$INFO.UTS = UTS;

   3017  4 000147   200003 470500                    LDP0    T$,,AUTO
         4 000150   000000 235000 2                  LDA     UTS
         4 000151   000003 755100                    STA     3,,PR0

      167     3018
      168     3019    2               TAIL$ = QQ_GLOBAL.TPU$ -> TPU$INFO.BLINK$;

   3019  4 000152   000155 470400 xsym               LDP0    QQ_GLOBAL+109
         4 000153   000000 236100                    LDQ     0,,PR0
         4 000154   200005 756100                    STQ     TAIL$,,AUTO

      169     3020    2               TPU$INFO.FLINK$ = TAIL$;

   3020  4 000155   200003 471500                    LDP1    T$,,AUTO
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:28   
         4 000156   100001 756100                    STQ     1,,PR1

      170     3021    2               TPU$INFO.BLINK$ = TAIL$ -> TPU$INFO.BLINK$;

   3021  4 000157   200005 470500                    LDP0    TAIL$,,AUTO
         4 000160   000000 236100                    LDQ     0,,PR0
         4 000161   200003 471500                    LDP1    T$,,AUTO
         4 000162   100000 756100                    STQ     0,,PR1

      171     3022    2               TAIL$ -> TPU$INFO.BLINK$ -> TPU$INFO.FLINK$ = T$;

   3022  4 000163   000000 471500                    LDP1    0,,PR0
         4 000164   200003 236100                    LDQ     T$,,AUTO
         4 000165   100001 756100                    STQ     1,,PR1

      172     3023    2               TAIL$ -> TPU$INFO.BLINK$ = T$;

   3023  4 000166   200003 236100                    LDQ     T$,,AUTO
         4 000167   000000 756100                    STQ     0,,PR0

      173     3024    2               QQ_GLOBAL.STRANGER_CNT = QQ_GLOBAL.STRANGER_CNT + 1;

   3024  4 000170   000043 235000 xsym               LDA     QQ_GLOBAL+35
         4 000171   000001 035007                    ADLA    1,DL
         4 000172   000043 755000 xsym               STA     QQ_GLOBAL+35

      174     3025
      175     3026    2               GOTO RET;

   3026  4 000173   000224 710000 4                  TRA     RET

      176     3027    2             END;
      177     3028
      178     3029    1           CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3029  4 000174   200006 631500                    EPPR1   MSGBLK,,AUTO
         4 000175   200034 451500                    STP1    MSGBLK+22,,AUTO
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:29   
         4 000176   200034 630500                    EPPR0   MSGBLK+22,,AUTO
         4 000177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000200   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         4 000201   000000 011000                    NOP     0

      179     3030    1           MSGBLK.ERRINFO.ERR(0) = CODE_ILLEGAL_DCB;

   3030  4 000202   000000 236000 3                  LDQ     CODE_ILLEGAL_DCB
         4 000203   200014 756100                    STQ     MSGBLK+6,,AUTO

      180     3031    1           TEXTC_STATION.NAME# = STATION;

   3031  4 000204   040000 100400                    MLR     fill='040'O
         4 000205   000001 000010 2                  ADSC9   STATION                  cn=0,n=8
         4 000206   000003 200010 2                  ADSC9   TEXTC_STATION            cn=1,n=8

      181     3032    1           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);

   3032  4 000207   000100 100400                    MLR     fill='000'O
         4 000210   000004 000010 5                  ADSC9   4                        cn=0,n=8
         4 000211   200015 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      182     3033    1           CALL QQC$BLDMSG(MSGBLK);

   3033  4 000212   200006 630500                    EPPR0   MSGBLK,,AUTO
         4 000213   200034 450500                    STP0    MSGBLK+22,,AUTO
         4 000214   200034 630500                    EPPR0   MSGBLK+22,,AUTO
         4 000215   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000216   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000217   000000 011000                    NOP     0

      183     3034
      184     3035    1   DISCO:
      185     3036    1           CALL M$DEACTIVATE(FPT_ACTIVATE) ALTRET(ACTIVATE_ERR);

   3036  4 000220   000022 630400 2     DISCO        EPPR0   FPT_ACTIVATE
         4 000221   500001 713400                    CLIMB   alt,+32769
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:30   
         4 000222   401400 401760                    pmme    nvectors=4
         4 000223   000107 702000 4                  TSX2    ACTIVATE_ERR

      186     3037
      187     3038    1   RET:
      188     3039    1           RETURN;

   3039  4 000224   000000 702200 xent  RET          TSX2  ! X66_ARET

      189     3040
      190     3041    1   NO_MEM:
      191     3042    1           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;

   3042  4 000225   000001 236000 3     NO_MEM       LDQ     CODE_NO_POOLMEM
         4 000226   000000 756000 xsym               STQ     QQ_GLOBAL

      192     3043    1           GOTO SCREECH;

   3043  4 000227   000234 710000 4                  TRA     SCREECH

      193     3044
      194     3045    1   MON_ERR:
      195     3046    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   3046  4 000230   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         4 000231   000000 471500                    LDP1    0,,PR0
         4 000232   100102 236100                    LDQ     66,,PR1
         4 000233   000000 756000 xsym               STQ     QQ_GLOBAL

      196     3047
      197     3048    1   SCREECH:
      198     3049    1           CALL QQC$SCREECH;

   3049  4 000234   000002 631400 xsym  SCREECH      EPPR1   B_VECTNIL+2
         4 000235   000000 701000 xent               TSX1    QQC$SCREECH
         4 000236   000000 011000                    NOP     0

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:31   
      199     3050
      200     3051    1   END QQA$DCB_CON;

   3051  4 000237   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:32   
--  Include file information  --

   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUPER_C.:E05TOU  is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$DCB_CON.
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:33   

 **** Variables and constants ****

  ****  Section 002  Data  QQA$DCB_CON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/d STRC(576)   r     1 FPT_ACTIVATE               6-0-0/d STRC(432)   r     1 FPT_TIME
     1-0-0/c CHAR(8)     r     1 STATION                    3-0-0/c STRC(81)    r     1 TEXTC_STATION
     0-0-0/w UBIN        r     1 UTS

  ****  Section 003 RoData QQA$DCB_CON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 CODE_ILLEGAL_DCB           1-0-0/b STRC        r     1 CODE_NO_POOLMEM

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w STRC(738)   r     1 MSGBLK                     4-0-0/w PTR         r     1 NEXT$
     3-0-0/w PTR         r     1 T$                         5-0-0/w PTR         r     1 TAIL$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:34   

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(1548)  r     1 B$CGAURD
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0N  NULL        r     1 M$CG
     0-0-0/w STRC(361)   r     1 TPU$INFO


   Procedure QQA$DCB_CON requires 160 words for executable code.
   Procedure QQA$DCB_CON requires 32 words of local(AUTO) storage.

    No errors detected in file QQA$DCB_CON.:E05TSI    .
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:35   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:36   
          MINI XREF LISTING

ACTIVATE_ERR
      3001**LABEL    2981--CALLALT  2996--CALLALT  3036--CALLALT
B$ALT.CODE
      2521**DCL      2521--REDEF    2522--REDEF    2522--REDEF
B$ALT.ERR
      2522**DCL      3046>>ASSIGN
B$ALT.ERR.CODE
      2523**DCL      3001>>IF
B$ALT.ERR.ERR#
      2523**DCL      2523--REDEF
B$ALT.EVID
      2522**DCL      2522--REDEF    2522--REDEF
B$CGAURD.B$CGAUCI.ATTR
      2565**DCL      2565--REDEF
B$CGAURD.B$CGAUCI.SYSID
      2565**DCL      2973>>IF       3016>>ASSIGN
B$CGAURD.STATION
      2543**DCL      2543--REDEF    2956>>ASSIGN
B$TCB.ALT$
      2517**DCL      3001>>IF       3046>>ASSIGN
B$TCB$
      2464**DCL      3001>>IF       3046>>ASSIGN
CODE_ILLEGAL_DCB
      2833**DCL      3030>>ASSIGN
CODE_NO_POOLMEM
      2840**DCL      3042>>ASSIGN
DISCO
      3036**LABEL    2978--GOTO     2991--GOTO
FPT_ACTIVATE
      2916**DCL      2961<>CALL     2981<>CALL     2996<>CALL     3036<>CALL
FPT_ACTIVATE.V
      2917**DCL      2916--DCLINIT
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:37   
FPT_ACTIVATE.V.DVBYTE.REREAD#
      2919**DCL      2919--REDEF
FPT_TIME
      2896**DCL      2953<>CALL
FPT_TIME.V
      2900**DCL      2896--DCLINIT
M$ACTIVATE
       985**DCL-ENT  2961--CALL     2981--CALL     2996--CALL
M$DEACTIVATE
       985**DCL-ENT  3036--CALL
M$TIME
      1032**DCL-ENT  2953--CALL
MON_ERR
      3046**LABEL    2961--CALLALT  3003--GOTO
MSGBLK
      2718**DCL      3029<>CALL     3033<>CALL
MSGBLK.ERRINFO.ERR
      2796**DCL      3030<<ASSIGN
MSGBLK.ERRINFO.FIELD1
      2800**DCL      3032<<ASSIGN
NEXT$
      2714**DCL      2955<<ASSIGN   2967<<ASSIGN   2967>>ASSIGN   2968>>IF       2973>>IF       2973>>IF
      2982>>ASSIGN   2983>>ASSIGN
NOT_FOUND
      2989**LABEL    2970--GOTO
NO_MEM
      3042**LABEL    3009--CALLALT
QQC$BLDMSG
      2436**DCL-ENT  3033--CALL
QQC$BLDMSG_ERRBLK
      2435**DCL-ENT  3029--CALL
QQC$GET_BLK
      2437**DCL-ENT  3009--CALL
QQC$SCREECH
      2438**DCL-ENT  3049--CALL
QQ_GLOBAL.CMDBUF$
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:38   
      2181**DCL      2539--IMP-PTR  2956>>ASSIGN   2973>>IF       3016>>ASSIGN
QQ_GLOBAL.DCBCON
      2176**DCL      2994>>IF
QQ_GLOBAL.DS1$_BITS
      2184**DCL      2184--REDEF
QQ_GLOBAL.DS2$_BITS
      2184**DCL      2185--REDEF
QQ_GLOBAL.DS3$_BITS
      2185**DCL      2185--REDEF
QQ_GLOBAL.DS4$_BITS
      2185**DCL      2186--REDEF
QQ_GLOBAL.ERR
      2174**DCL      3042<<ASSIGN   3046<<ASSIGN
QQ_GLOBAL.POOL$
      2185**DCL      3009<>CALL
QQ_GLOBAL.STRANGERMAX
      2178**DCL      2989>>IF
QQ_GLOBAL.STRANGER_CNT
      2180**DCL      2989>>IF       3024<<ASSIGN   3024>>ASSIGN
QQ_GLOBAL.TPU$
      2186**DCL      2955>>ASSIGN   3019>>ASSIGN
QQ_GLOBAL.TPUMAX
      2178**DCL      2976>>IF
QQ_GLOBAL.TPU_CNT
      2179**DCL      2976>>IF
RET
      3039**LABEL    2962--GOTO     2984--GOTO     3006--GOTO     3026--GOTO
SCREECH
      3049**LABEL    3043--GOTO
STATION
      2660**DCL      2916--DCLINIT  2956<<ASSIGN   2958>>IF       2958>>IF       2958>>IF       2973>>IF
      3012>>ASSIGN   3031>>ASSIGN
T$
      2605**DCL      2606--IMP-PTR  3009<>CALL     3011>>ASSIGN   3012>>ASSIGN   3013>>ASSIGN   3014>>ASSIGN
      3015>>ASSIGN   3016>>ASSIGN   3017>>ASSIGN   3020>>ASSIGN   3021>>ASSIGN   3022>>ASSIGN   3023>>ASSIGN
TAIL$
PL6.E3A0      #001=QQA$DCB_CON File=QQA$DCB_CON.:E05TSI                          WED 07/30/97 05:21 Page:39   
      2715**DCL      3019<<ASSIGN   3020>>ASSIGN   3021>>ASSIGN   3022>>ASSIGN   3023>>ASSIGN
TEXTC_STATION
      2687**DCL      3032--ASSIGN
TEXTC_STATION.NAME#
      2687**DCL      3031<<ASSIGN
TPU$INFO
      2606**DCL      3009--CALL
TPU$INFO.BLINK$
      2607**DCL      3019>>ASSIGN   3021<<ASSIGN   3021>>ASSIGN   3022>>ASSIGN   3023<<ASSIGN
TPU$INFO.FLAGS
      2621**DCL      3011<<ASSIGN
TPU$INFO.FLAGS.CONNECT
      2623**DCL      2983<<ASSIGN   3015<<ASSIGN
TPU$INFO.FLAGS.STRANGER
      2629**DCL      3014<<ASSIGN
TPU$INFO.FLINK$
      2609**DCL      2967>>ASSIGN   2968>>IF       3020<<ASSIGN   3022<<ASSIGN
TPU$INFO.STATION
      2615**DCL      2973>>IF       3012<<ASSIGN
TPU$INFO.SYSID
      2611**DCL      2973>>IF       3016<<ASSIGN
TPU$INFO.TIMEOUT
      2619**DCL      3013<<ASSIGN
TPU$INFO.UTS
      2613**DCL      2982<<ASSIGN   3017<<ASSIGN
UTS
      2658**DCL      2900--DCLINIT  2982>>ASSIGN   3017>>ASSIGN
