VERSION E05

PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:1    
        1        1        /*M* NKP$PARTRTN Partition and return CG and resource devs - process MAKE keyin */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*F* NAME:         NKP$PART
       10       10             PURPOSE:      To partition a device.
       11       11        */
       12       12        NKP$PART: PROC (DCT,ERR) ALTRET;
       13       13        /**/
       14       14
       15       15
       16       16
       17       17        /**/
       18       18        /* INCLUDES */
       19       19        %INCLUDE FR_ERRORS_C;
       20       50        %INCLUDE UD_SEV_C;
       21       64        %INCLUDE NK$LDCT;
       22      166        %INCLUDE KC$CGBLK;
       23      214        %INCLUDE NI$TABLES;
       24      430        %INCLUDE NI_DATA_C ;
       25      543        %INCLUDE FR$RAT;
       26      596        %INCLUDE FR_DATA_R;
       27      628        %INCLUDE KC_SUBS_C;
       28      644        %INCLUDE OC_SUBS_C;
       29     1375        %INCLUDE NK_SUBS;
       30     1400        %INCLUDE JG_GHOSTS_C;
       31     1490
       32     1491
       33     1492
       34     1493        /**/
       35     1494        /* PARAMETERS */
       36     1495        /**/
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:2    
       37     1496        %NI$DCT (NAME=DCT,STCLASS="");
       38     1544    1   DCL ERR BIT(36) ALIGNED;
       39     1545
       40     1546
       41     1547
       42     1548        /**/
       43     1549        /* BASED STRUCTURES */
       44     1550        /**/
       45     1551        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
       46     1591        %NK$LDCT;
       47     1637
       48     1638
       49     1639
       50     1640        /**/
       51     1641        /* AUTO */
       52     1642        /**/
       53     1643    1   DCL LDCT$ PTR;
       54     1644    1   DCL RAT$ REDEF LDCT$ PTR;
       55     1645    1   DCL RA1$ PTR;
       56     1646    1   DCL MSG REDEF RA1$ UBIN WORD;
       57     1647    1   DCL RCD UBIN WORD;
       58     1648
       59     1649
       60     1650
       61     1651        /**/
       62     1652        /* CONSTANT */
       63     1653        /**/
       64     1654    1   DCL 1 INUSE CONSTANT ALIGNED,
       65     1655    1         2 FCG BIT(18) UNAL INIT('161320'O),
       66     1656    1         2 ERR UBIN(15) UNAL INIT(%E$PRTBSY),
       67     1657    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       68     1658    1   DCL 1 NLDT CONSTANT ALIGNED,
       69     1659    1         2 FCG BIT(18) UNAL INIT('161320'O),
       70     1660    1         2 ERR UBIN(15) UNAL INIT(%E$UPNLDT),
       71     1661    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       72     1662
       73     1663
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:3    
       74     1664
       75     1665        /**/
       76     1666        /* REFS */
       77     1667        /**/
       78     1668    1   DCL FMN$AVR       ENTRY(2);
       79     1669    1   DCL FRC$WAKU      ENTRY(1);
       80     1670    1   DCL FRZ$DSMT      ENTRY(1);
       81     1671    1   DCL KCD$DSCTRM    ENTRY(2);
       82     1672    1   DCL KCO$FINDSTA   ENTRY(4) ALTRET;
       83     1673    1   DCL NIO$SPINTCON  ENTRY(3) ALTRET;
       84     1674    1   DCL NKP$CHLST     ENTRY(2);
       85     1675    1   DCL OCI$MK_WR     ENTRY(7);
       86     1676    1   DCL SSS$BLOCK     ENTRY;
       87     1677
       88     1678    1   DCL S_PNO UBIN SYMREF;
       89     1679        %KC$CGID (FPTN=KC_OSID,STCLASS=SYMREF);
       90     1705        %KC$CGID (FPTN=KC_ISID,STCLASS=SYMREF);
       91     1731        %KC$CGID (FPTN=KC_OCID,STCLASS=SYMREF);
       92     1757
       93     1758
       94     1759
       95     1760        /**/
       96     1761        /* SUBS */
       97     1762        /**/
       98     1763        %INCLUDE FR_SUBS;
       99     1831        %INCLUDE CP_6_SUBS;
      100     2371        /**/
      101     2372        /**/
      102     2373    1         ERR='0'B;
      103     2374    1         IF DCT.STATUS.DOWN THEN RETURN;
      104     2375    1         IF S_PNO~=0 THEN CALL SSS$BLOCK;
      105     2376    1         IF DCT.DFLG.CONSOLE THEN
      106     2377    2           DO;
      107     2378    2           RCD=8;
      108     2379    2           CALL KCO$FINDSTA (LDCT$,KC_OCID,DCT.DEVNM,RCD) ALTRET (CKNCG);
      109     2380    2           GOTO CISRL;
      110     2381    2   CKNCG:  ;
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:4    
      111     2382    2           CALL NKP$CHLST(DCT,NK_PART);
      112     2383    2           RETURN;
      113     2384    2           END;
      114     2385    1         ELSE IF DCT.DFLG.SYMBIONT THEN
      115     2386    2            DO;
      116     2387    2            IF DCT.DFLG.INPUT THEN
      117     2388    3              DO;
      118     2389    3              RCD=8;
      119     2390    3              CALL KCO$FINDSTA (LDCT$,KC_ISID,DCT.DEVNM,RCD) ALTRET (CKNCG);
      120     2391    4                DO INHIBIT;
      121     2392    4   CISRL:       ;
      122     2393    4                IF LDCT$->LDCT.LKFLG.ACTIVE AND NOT DCT.DFLG.CONSOLE THEN GOTO IUERR;
      123     2394    4                CALL NIO$SPINTCON (DCT.DCTX,ENTADDR(NIL),LDCT$);
      124     2395    4                END;
      125     2396    3   DSCOUT:    ;
      126     2397    3              IF ~DCT.DFLG.CONSOLE THEN
      127     2398    3               DCT.RAT$->RAT.FLG.DOWN='1'B;
      128     2399    3              CALL KCD$DSCTRM (LDCT$->LDCT);
      129     2400    3              DCT.DFLG.CM='0'B;
      130     2401    3              END;
      131     2402    2            ELSE
      132     2403    3              DO;
      133     2404    3              RCD=8;
      134     2405    3              CALL KCO$FINDSTA (LDCT$,KC_OSID,DCT.DEVNM,RCD) ALTRET (CKNCG);
      135     2406    4                DO INHIBIT;
      136     2407    4                IF LDCT$->LDCT.DFLG.SYMBIONT THEN GOTO IUERR;
      137     2408    4                END;
      138     2409    3              GOTO DSCOUT;
      139     2410    3              END;
      140     2411    2            END;
      141     2412    1          ELSE
      142     2413    2            DO;
      143     2414    2            RAT$=DCT.RAT$;
      144     2415    2            RCD=RAT.RCOD;
      145     2416    2            IF RAT.RES.SISID=JG_PIG# AND RAT.REEL.ASID=0 AND
      146     2417    2            NOT RAT.FLG.MBIT.MTD AND
      147     2418    2            RAT.M1&%(ATTR_DD600#|ATTR_DD500#|ATTR_DD1000#|ATTR_DD1500#
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:5    
      148     2419    2            |ATTR_DD400#|ATTR_DD1100#) THEN
      149     2420                  /* Force PIG to let go of this DP.  We will partition later  (delayed). */
      150     2421    2             CALL FMN$AVR ( DCT.DCTX, %NI_AVR_PART ) ;
      151     2422    2            IF RAT.RES.SISID~=0 THEN
      152     2423    3              DO;
      153     2424    3              IF RCD=FR_NPOOL OR RAT.FLG.MBIT.MTD OR RAT.RES.RFLG.NOSLD THEN GOTO IUERR
              2424                       ;
      154     2425    3              RA1$=FR$HD$(RCD);
      155     2426    4                DO WHILE (RA1$~=ADDR(NIL));
      156     2427    4                IF RA1$->RAT.RES.SISID=0 AND
      157     2428    4                RA1$->RAT.FLG.DOWN='0'B AND
      158     2429    4                NOT RAT.RES.M2&~RA1$->RAT.M1 THEN
      159     2430    5                  DO;
      160     2431    5                  RAT.REEL.ASID=0;
      161     2432    5                  IF RAT.FLG.MBIT.SOL THEN CALL FRC$WAKU (RAT);
      162     2433    5                  RA1$->RAT.RES=RAT.RES;
      163     2434    5                  GOTO PROUT;
      164     2435    5                  END;
      165     2436    4                RA1$=RA1$->RAT.LNK$;
      166     2437    4                END;
      167     2438    3   IUERR:     ;
      168     2439    3              ERR=INUSE;  /* will be partitioned when released */
      169     2440    3              ALTRETURN;
      170     2441    3              END;
      171     2442    2   PROUT:   ;
      172     2443    2            IF RAT.FLG.RUP THEN CALL FRZ$DSMT (RAT);
      173     2444    2            RAT.RES='0'B;
      174     2445    2            RAT.FLG.DOWN='1'B;
      175     2446    2            FR_PRM$(0)->FR$PR(RCD)=FR_PRM$(0)->FR$PR(RCD)-1;
      176     2447    2            IF RAT.FLG.SYMBIONT THEN CALL NKP$CHLST(DCT,NK_PART);
      177     2448    2            END;
      178     2449    1         MSG=PART_MSG#;
      179     2450    1   MOUT: ;
      180     2451    1         RCD=DCT.DCTX;
      181     2452    1         CALL OCI$MK_WR (M_DEVC,MSG,0,0,0,RCD);
      182     2453    1   RTN:  ;
      183     2454    1         RETURN;
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:6    
      184     2455        /**/
      185     2456        /*F* NAME:         NKP$RTN
      186     2457             PURPOSE:      To return a partitioned device.
      187     2458        */
      188     2459    1   NKP$RTN: ENTRY (DCT,ERR) ALTRET;
      189     2460        /**/
      190     2461    1         ERR='0'B;
      191     2462    1         IF DCT.STATUS.DOWN='0'B THEN RETURN;
      192     2463    1         IF DCT.DFLG.CONSOLE OR DCT.DFLG.SYMBIONT THEN CALL NKP$CHLST (DCT,NK_NOCG);
      193     2464    1         ELSE
      194     2465    2           DO;
      195     2466    2           RAT$=DCT.RAT$;
      196     2467    2           RAT.FLG.DOWN='0'B;
      197     2468    2           RCD=RAT$->RAT.RCOD;
      198     2469    2           FR_PRM$(0)->FR$PR(RCD)=FR_PRM$(0)->FR$PR(RCD)+1;
      199     2470    2           IF RAT.FLG.SYMBIONT THEN CALL NKP$CHLST (DCT,NK_QTRM);
      200     2471    2           END;
      201     2472    1         IF DCT.DFLG.SYMBIONT
      202     2473    2         THEN DO;
      203     2474    2           RAT$=DCT.RAT$;
      204     2475    2           RAT.FLG.DOWN = '0'B;
      205     2476    2           END;
      206     2477    1         MSG=PRTN_MSG#;
      207     2478    1         GOTO MOUT;
      208     2479        /**/
      209     2480    1   END;
      210     2481        /**/
      211     2482        /**/
      212     2483        %EOD;

PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:7    
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KC_SUBS_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   FR_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure NKP$PART.

   Procedure NKP$PART requires 305 words for executable code.
   Procedure NKP$PART requires 14 words of local(AUTO) storage.

PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:8    

 Object Unit name= NKP$PART                                   File name= NKP$PARTRTN.:E05TOU
 UTS= JUL 30 '97 03:45:39.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      2      2  NKP$PART
    1   Proc  even  none   305    461  NKP$PART
    2  RoData even  none    13     15  NKP$PART

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  NKP$PART
     1    367          yes     yes      Std        2  NKP$RTN
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:9    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 SSS$BLOCK
         yes           Std       2 NKP$CHLST
         yes           Std       2 FMN$AVR
 yes     yes           Std       3 NIO$SPINTCON
         yes           Std       7 OCI$MK_WR
         yes           Std       1 FRZ$DSMT
 yes     yes           Std       4 KCO$FINDSTA
         yes           Std       2 KCD$DSCTRM
         yes           Std       1 FRC$WAKU
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     FR$HD$                                FR_PRM$                               S_PNO
     KC_OSID                               KC_ISID                               KC_OCID
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:10   


        1        1        /*M* NKP$PARTRTN Partition and return CG and resource devs - process MAKE keyin */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*F* NAME:         NKP$PART
       10       10             PURPOSE:      To partition a device.
       11       11        */
       12       12        NKP$PART: PROC (DCT,ERR) ALTRET;

     12  1 000000   000000 700200 xent  NKP$PART     TSX0  ! X66_AUTO_2
         1 000001   000016 000002                    ZERO    14,2

       13       13        /**/
       14       14
       15       15
       16       16
       17       17        /**/
       18       18        /* INCLUDES */
       19       19        %INCLUDE FR_ERRORS_C;
       20       50        %INCLUDE UD_SEV_C;
       21       64        %INCLUDE NK$LDCT;
       22      166        %INCLUDE KC$CGBLK;
       23      214        %INCLUDE NI$TABLES;
       24      430        %INCLUDE NI_DATA_C ;
       25      543        %INCLUDE FR$RAT;
       26      596        %INCLUDE FR_DATA_R;
       27      628        %INCLUDE KC_SUBS_C;
       28      644        %INCLUDE OC_SUBS_C;
       29     1375        %INCLUDE NK_SUBS;
       30     1400        %INCLUDE JG_GHOSTS_C;
       31     1490
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:11   
       32     1491
       33     1492
       34     1493        /**/
       35     1494        /* PARAMETERS */
       36     1495        /**/
       37     1496        %NI$DCT (NAME=DCT,STCLASS="");
       38     1544    1   DCL ERR BIT(36) ALIGNED;
       39     1545
       40     1546
       41     1547
       42     1548        /**/
       43     1549        /* BASED STRUCTURES */
       44     1550        /**/
       45     1551        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
       46     1591        %NK$LDCT;
       47     1637
       48     1638
       49     1639
       50     1640        /**/
       51     1641        /* AUTO */
       52     1642        /**/
       53     1643    1   DCL LDCT$ PTR;
       54     1644    1   DCL RAT$ REDEF LDCT$ PTR;
       55     1645    1   DCL RA1$ PTR;
       56     1646    1   DCL MSG REDEF RA1$ UBIN WORD;
       57     1647    1   DCL RCD UBIN WORD;
       58     1648
       59     1649
       60     1650
       61     1651        /**/
       62     1652        /* CONSTANT */
       63     1653        /**/
       64     1654    1   DCL 1 INUSE CONSTANT ALIGNED,
       65     1655    1         2 FCG BIT(18) UNAL INIT('161320'O),
       66     1656    1         2 ERR UBIN(15) UNAL INIT(%E$PRTBSY),
       67     1657    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       68     1658    1   DCL 1 NLDT CONSTANT ALIGNED,
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:12   
       69     1659    1         2 FCG BIT(18) UNAL INIT('161320'O),
       70     1660    1         2 ERR UBIN(15) UNAL INIT(%E$UPNLDT),
       71     1661    1         2 SEV UBIN(3) UNAL INIT(SEV_ERROR#);
       72     1662
       73     1663
       74     1664
       75     1665        /**/
       76     1666        /* REFS */
       77     1667        /**/
       78     1668    1   DCL FMN$AVR       ENTRY(2);
       79     1669    1   DCL FRC$WAKU      ENTRY(1);
       80     1670    1   DCL FRZ$DSMT      ENTRY(1);
       81     1671    1   DCL KCD$DSCTRM    ENTRY(2);
       82     1672    1   DCL KCO$FINDSTA   ENTRY(4) ALTRET;
       83     1673    1   DCL NIO$SPINTCON  ENTRY(3) ALTRET;
       84     1674    1   DCL NKP$CHLST     ENTRY(2);
       85     1675    1   DCL OCI$MK_WR     ENTRY(7);
       86     1676    1   DCL SSS$BLOCK     ENTRY;
       87     1677
       88     1678    1   DCL S_PNO UBIN SYMREF;
       89     1679        %KC$CGID (FPTN=KC_OSID,STCLASS=SYMREF);
       90     1705        %KC$CGID (FPTN=KC_ISID,STCLASS=SYMREF);
       91     1731        %KC$CGID (FPTN=KC_OCID,STCLASS=SYMREF);
       92     1757
       93     1758
       94     1759
       95     1760        /**/
       96     1761        /* SUBS */
       97     1762        /**/
       98     1763        %INCLUDE FR_SUBS;
       99     1831        %INCLUDE CP_6_SUBS;
      100     2371        /**/
      101     2372        /**/
      102     2373    1         ERR='0'B;

   2373  1 000002   200004 470500                    LDP0    @ERR,,AUTO
         1 000003   000000 450100                    STZ     0,,PR0
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:13   

      103     2374    1         IF DCT.STATUS.DOWN THEN RETURN;

   2374  1 000004   200003 471500                    LDP1    @DCT,,AUTO
         1 000005   100027 234100                    SZN     23,,PR1
         1 000006   000010 605000 1                  TPL     s:2375

   2374  1 000007   000000 702200 xent               TSX2  ! X66_ARET

      104     2375    1         IF S_PNO~=0 THEN CALL SSS$BLOCK;

   2375  1 000010   000000 235000 xsym               LDA     S_PNO
         1 000011   000015 600000 1                  TZE     s:2376

   2375  1 000012   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000013   000000 701000 xent               TSX1    SSS$BLOCK
         1 000014   000000 011000                    NOP     0

      105     2376    1         IF DCT.DFLG.CONSOLE THEN

   2376  1 000015   200003 470500                    LDP0    @DCT,,AUTO
         1 000016   000006 236100                    LDQ     6,,PR0
         1 000017   040000 316007                    CANQ    16384,DL
         1 000020   000051 600000 1                  TZE     s:2385

      106     2377    2           DO;

      107     2378    2           RCD=8;

   2378  1 000021   000010 235007                    LDA     8,DL
         1 000022   200007 755100                    STA     RCD,,AUTO

      108     2379    2           CALL KCO$FINDSTA (LDCT$,KC_OCID,DCT.DEVNM,RCD) ALTRET (CKNCG);

   2379  1 000023   200007 631500                    EPPR1   RCD,,AUTO
         1 000024   200013 451500                    STP1    RCD+4,,AUTO
         1 000025   200003 236100                    LDQ     @DCT,,AUTO
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:14   
         1 000026   000002 036003                    ADLQ    2,DU
         1 000027   200012 756100                    STQ     RCD+3,,AUTO
         1 000030   000000 236000 2                  LDQ     0
         1 000031   200011 756100                    STQ     RCD+2,,AUTO
         1 000032   200005 633500                    EPPR3   LDCT$,,AUTO
         1 000033   200010 453500                    STP3    RCD+1,,AUTO
         1 000034   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000035   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000036   000000 701000 xent               TSX1    KCO$FINDSTA
         1 000037   000041 702000 1                  TSX2    CKNCG

      109     2380    2           GOTO CISRL;

   2380  1 000040   000074 710000 1                  TRA     CISRL

   2378  1 000041                       CKNCG        null
      110     2381    2   CKNCG:  ;
      111     2382    2           CALL NKP$CHLST(DCT,NK_PART);

   2382  1 000041   000001 236000 2                  LDQ     1
         1 000042   200003 235100                    LDA     @DCT,,AUTO
         1 000043   200010 757100                    STAQ    RCD+1,,AUTO
         1 000044   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000045   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000046   000000 701000 xent               TSX1    NKP$CHLST
         1 000047   000000 011000                    NOP     0

      112     2383    2           RETURN;

   2383  1 000050   000000 702200 xent               TSX2  ! X66_ARET

      113     2384    2           END;
      114     2385    1         ELSE IF DCT.DFLG.SYMBIONT THEN

   2385  1 000051   020000 316007                    CANQ    8192,DL
         1 000052   000164 600000 1                  TZE     s:2414

PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:15   
      115     2386    2            DO;

      116     2387    2            IF DCT.DFLG.INPUT THEN

   2387  1 000053   400000 316007                    CANQ    -131072,DL
         1 000054   000140 600000 1                  TZE     s:2404

      117     2388    3              DO;

      118     2389    3              RCD=8;

   2389  1 000055   000010 235007                    LDA     8,DL
         1 000056   200007 755100                    STA     RCD,,AUTO

      119     2390    3              CALL KCO$FINDSTA (LDCT$,KC_ISID,DCT.DEVNM,RCD) ALTRET (CKNCG);

   2390  1 000057   200007 631500                    EPPR1   RCD,,AUTO
         1 000060   200013 451500                    STP1    RCD+4,,AUTO
         1 000061   200003 236100                    LDQ     @DCT,,AUTO
         1 000062   000002 036003                    ADLQ    2,DU
         1 000063   200012 756100                    STQ     RCD+3,,AUTO
         1 000064   000002 236000 2                  LDQ     2
         1 000065   200011 756100                    STQ     RCD+2,,AUTO
         1 000066   200005 633500                    EPPR3   LDCT$,,AUTO
         1 000067   200010 453500                    STP3    RCD+1,,AUTO
         1 000070   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000071   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000072   000000 701000 xent               TSX1    KCO$FINDSTA
         1 000073   000041 702000 1                  TSX2    CKNCG

      120     2391    4                DO INHIBIT;

   2390  1 000074                       CISRL        null
      121     2392    4   CISRL:       ;
      122     2393    4                IF LDCT$->LDCT.LKFLG.ACTIVE AND NOT DCT.DFLG.CONSOLE THEN GOTO IUERR;

   2393  1 000074   200005 470700                    LDP0  ! LDCT$,,AUTO
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:16   
         1 000075   000011 236300                    LDQ   ! 9,,PR0
         1 000076   000040 316203                    CANQ  ! 32,DU
         1 000077   000104 600200 1                  TZE   ! s:2394
         1 000100   200003 471700                    LDP1  ! @DCT,,AUTO
         1 000101   100006 236300                    LDQ   ! 6,,PR1
         1 000102   040000 316207                    CANQ  ! 16384,DL
         1 000103   000300 600200 1                  TZE   ! IUERR

      123     2394    4                CALL NIO$SPINTCON (DCT.DCTX,ENTADDR(NIL),LDCT$);

   2394  1 000104   200005 631700                    EPPR1 ! LDCT$,,AUTO
         1 000105   200012 451700                    STP1  ! RCD+3,,AUTO
         1 000106   000003 236200 2                  LDQ   ! 3
         1 000107   200011 756300                    STQ   ! RCD+2,,AUTO
         1 000110   200003 236300                    LDQ   ! @DCT,,AUTO
         1 000111   000006 036203                    ADLQ  ! 6,DU
         1 000112   200010 756300                    STQ   ! RCD+1,,AUTO
         1 000113   200010 630700                    EPPR0 ! RCD+1,,AUTO
         1 000114   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
         1 000115   000000 701200 xent               TSX1  ! NIO$SPINTCON
         1 000116   000000 011200                    NOP   ! 0

      124     2395    4                END;

   2392  1 000117                       DSCOUT       null
      125     2396    3   DSCOUT:    ;
      126     2397    3              IF ~DCT.DFLG.CONSOLE THEN

   2397  1 000117   200003 470500                    LDP0    @DCT,,AUTO
         1 000120   000006 236100                    LDQ     6,,PR0
         1 000121   000025 736000                    QLS     21
         1 000122   400000 376003                    ANQ     -131072,DU
         1 000123   400000 676003                    ERQ     -131072,DU
         1 000124   000130 600000 1                  TZE     s:2399

      127     2398    3               DCT.RAT$->RAT.FLG.DOWN='1'B;

PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:17   
   2398  1 000125   000005 471500                    LDP1    5,,PR0
         1 000126   000002 236007                    LDQ     2,DL
         1 000127   100010 256100                    ORSQ    8,,PR1

      128     2399    3              CALL KCD$DSCTRM (LDCT$->LDCT);

   2399  1 000130   200005 630500                    EPPR0   LDCT$,,AUTO
         1 000131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000132   000000 701000 xent               TSX1    KCD$DSCTRM
         1 000133   000000 011000                    NOP     0

      129     2400    3              DCT.DFLG.CM='0'B;

   2400  1 000134   200003 470500                    LDP0    @DCT,,AUTO
         1 000135   000004 236000 2                  LDQ     4
         1 000136   000006 356100                    ANSQ    6,,PR0

      130     2401    3              END;

   2401  1 000137   000342 710000 1                  TRA     s:2449

      131     2402    2            ELSE
      132     2403    3              DO;

      133     2404    3              RCD=8;

   2404  1 000140   000010 235007                    LDA     8,DL
         1 000141   200007 755100                    STA     RCD,,AUTO

      134     2405    3              CALL KCO$FINDSTA (LDCT$,KC_OSID,DCT.DEVNM,RCD) ALTRET (CKNCG);

   2405  1 000142   200007 631500                    EPPR1   RCD,,AUTO
         1 000143   200013 451500                    STP1    RCD+4,,AUTO
         1 000144   200003 236100                    LDQ     @DCT,,AUTO
         1 000145   000002 036003                    ADLQ    2,DU
         1 000146   200012 756100                    STQ     RCD+3,,AUTO
         1 000147   000005 236000 2                  LDQ     5
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:18   
         1 000150   200011 756100                    STQ     RCD+2,,AUTO
         1 000151   200005 633500                    EPPR3   LDCT$,,AUTO
         1 000152   200010 453500                    STP3    RCD+1,,AUTO
         1 000153   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000154   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000155   000000 701000 xent               TSX1    KCO$FINDSTA
         1 000156   000041 702000 1                  TSX2    CKNCG

      135     2406    4                DO INHIBIT;

      136     2407    4                IF LDCT$->LDCT.DFLG.SYMBIONT THEN GOTO IUERR;

   2407  1 000157   200005 470700                    LDP0  ! LDCT$,,AUTO
         1 000160   000006 236300                    LDQ   ! 6,,PR0
         1 000161   020000 316207                    CANQ  ! 8192,DL
         1 000162   000300 601200 1                  TNZ   ! IUERR

      137     2408    4                END;

      138     2409    3              GOTO DSCOUT;

   2409  1 000163   000117 710000 1                  TRA     DSCOUT

      139     2410    3              END;
      140     2411    2            END;
      141     2412    1          ELSE
      142     2413    2            DO;

      143     2414    2            RAT$=DCT.RAT$;

   2414  1 000164   000005 236100                    LDQ     5,,PR0
         1 000165   200005 756100                    STQ     LDCT$,,AUTO

      144     2415    2            RCD=RAT.RCOD;

   2415  1 000166   200005 471500                    LDP1    LDCT$,,AUTO
         1 000167   100003 236100                    LDQ     3,,PR1
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:19   
         1 000170   000027 772000                    QRL     23
         1 000171   000017 376007                    ANQ     15,DL
         1 000172   200007 756100                    STQ     RCD,,AUTO

      145     2416    2            IF RAT.RES.SISID=JG_PIG# AND RAT.REEL.ASID=0 AND

   2416  1 000173   100001 220100                    LDX0    1,,PR1
         1 000174   000007 100003                    CMPX0   7,DU
         1 000175   000217 601000 1                  TNZ     s:2422
         1 000176   100004 221100                    LDX1    4,,PR1
         1 000177   000217 601000 1                  TNZ     s:2422
         1 000200   100010 236100                    LDQ     8,,PR1
         1 000201   000400 316007                    CANQ    256,DL
         1 000202   000217 601000 1                  TNZ     s:2422
         1 000203   100006 222100                    LDX2    6,,PR1
         1 000204   167000 362003                    ANX2    60928,DU
         1 000205   000217 600000 1                  TZE     s:2422

      146     2417    2            NOT RAT.FLG.MBIT.MTD AND
      147     2418    2            RAT.M1&%(ATTR_DD600#|ATTR_DD500#|ATTR_DD1000#|ATTR_DD1500#
      148     2419    2            |ATTR_DD400#|ATTR_DD1100#) THEN
      149     2420                  /* Force PIG to let go of this DP.  We will partition later (delayed). */
      150     2421    2             CALL FMN$AVR ( DCT.DCTX, %NI_AVR_PART ) ;

   2421  1 000206   000006 236000 2                  LDQ     6
         1 000207   200011 756100                    STQ     RCD+2,,AUTO
         1 000210   200003 236100                    LDQ     @DCT,,AUTO
         1 000211   000006 036003                    ADLQ    6,DU
         1 000212   200010 756100                    STQ     RCD+1,,AUTO
         1 000213   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000214   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000215   000000 701000 xent               TSX1    FMN$AVR
         1 000216   000000 011000                    NOP     0

      151     2422    2            IF RAT.RES.SISID~=0 THEN

   2422  1 000217   200005 470500                    LDP0    LDCT$,,AUTO
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:20   
         1 000220   000001 220100                    LDX0    1,,PR0
         1 000221   000304 600000 1                  TZE     PROUT

      152     2423    3              DO;

      153     2424    3             IF RCD=FR_NPOOL OR RAT.FLG.MBIT.MTD OR RAT.RES.RFLG.NOSLD THEN GOTO IUERR
              2424                       ;

   2424  1 000222   200007 235100                    LDA     RCD,,AUTO
         1 000223   000002 115007                    CMPA    2,DL
         1 000224   000300 600000 1                  TZE     IUERR
         1 000225   000010 236100                    LDQ     8,,PR0
         1 000226   000400 316007                    CANQ    256,DL
         1 000227   000300 601000 1                  TNZ     IUERR
         1 000230   000003 236100                    LDQ     3,,PR0
         1 000231   010000 316003                    CANQ    4096,DU
         1 000232   000300 601000 1                  TNZ     IUERR

      154     2425    3              RA1$=FR$HD$(RCD);

   2425  1 000233   000000 236005 xsym               LDQ     FR$HD$,AL
         1 000234   200006 756100                    STQ     RA1$,,AUTO

      155     2426    4                DO WHILE (RA1$~=ADDR(NIL));

   2426  1 000235   000276 710000 1                  TRA     s:2437

      156     2427    4                IF RA1$->RAT.RES.SISID=0 AND

   2427  1 000236   200006 470500                    LDP0    RA1$,,AUTO
         1 000237   000001 220100                    LDX0    1,,PR0
         1 000240   000274 601000 1                  TNZ     s:2436
         1 000241   000010 236100                    LDQ     8,,PR0
         1 000242   000002 316007                    CANQ    2,DL
         1 000243   000274 601000 1                  TNZ     s:2436
         1 000244   000006 236100                    LDQ     6,,PR0
         1 000245   777777 376003                    ANQ     -1,DU
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:21   
         1 000246   777777 676003                    ERQ     -1,DU
         1 000247   000022 772000                    QRL     18
         1 000250   000000 621006                    EAX1    0,QL
         1 000251   200005 471500                    LDP1    LDCT$,,AUTO
         1 000252   100002 361100                    ANX1    2,,PR1
         1 000253   000274 601000 1                  TNZ     s:2436

      157     2428    4                RA1$->RAT.FLG.DOWN='0'B AND
      158     2429    4                NOT RAT.RES.M2&~RA1$->RAT.M1 THEN
      159     2430    5                  DO;

      160     2431    5                  RAT.REEL.ASID=0;

   2431  1 000254   000000 221003                    LDX1    0,DU
         1 000255   100004 741100                    STX1    4,,PR1

      161     2432    5                  IF RAT.FLG.MBIT.SOL THEN CALL FRC$WAKU (RAT);

   2432  1 000256   200005 470500                    LDP0    LDCT$,,AUTO
         1 000257   000010 236100                    LDQ     8,,PR0
         1 000260   000100 316007                    CANQ    64,DL
         1 000261   000266 600000 1                  TZE     s:2433

   2432  1 000262   200005 630500                    EPPR0   LDCT$,,AUTO
         1 000263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000264   000000 701000 xent               TSX1    FRC$WAKU
         1 000265   000000 011000                    NOP     0

      162     2433    5                  RA1$->RAT.RES=RAT.RES;

   2433  1 000266   200005 470500                    LDP0    LDCT$,,AUTO
         1 000267   200006 471500                    LDP1    RA1$,,AUTO
         1 000270   000100 100500                    MLR     fill='000'O
         1 000271   000001 000011                    ADSC9   1,,PR0                   cn=0,n=9
         1 000272   100001 000011                    ADSC9   1,,PR1                   cn=0,n=9

      163     2434    5                  GOTO PROUT;
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:22   

   2434  1 000273   000304 710000 1                  TRA     PROUT

      164     2435    5                  END;
      165     2436    4                RA1$=RA1$->RAT.LNK$;

   2436  1 000274   000000 236100                    LDQ     0,,PR0
         1 000275   200006 756100                    STQ     RA1$,,AUTO

      166     2437    4                END;

   2437  1 000276   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000277   000236 601000 1                  TNZ     s:2427

   2431  1 000300                       IUERR        null
      167     2438    3   IUERR:     ;
      168     2439    3              ERR=INUSE;  /* will be partitioned when released */

   2439  1 000300   000000 236000 0                  LDQ     INUSE
         1 000301   200004 470500                    LDP0    @ERR,,AUTO
         1 000302   000000 756100                    STQ     0,,PR0

      169     2440    3              ALTRETURN;

   2440  1 000303   000000 702200 xent               TSX2  ! X66_AALT

   2432  1 000304                       PROUT        null
      170     2441    3              END;
      171     2442    2   PROUT:   ;
      172     2443    2            IF RAT.FLG.RUP THEN CALL FRZ$DSMT (RAT);

   2443  1 000304   200005 470500                    LDP0    LDCT$,,AUTO
         1 000305   000010 236100                    LDQ     8,,PR0
         1 000306   000004 316007                    CANQ    4,DL
         1 000307   000314 600000 1                  TZE     s:2444

   2443  1 000310   200005 630500                    EPPR0   LDCT$,,AUTO
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:23   
         1 000311   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000312   000000 701000 xent               TSX1    FRZ$DSMT
         1 000313   000000 011000                    NOP     0

      173     2444    2            RAT.RES='0'B;

   2444  1 000314   200005 470500                    LDP0    LDCT$,,AUTO
         1 000315   000100 100400                    MLR     fill='000'O
         1 000316   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000317   000001 000011                    ADSC9   1,,PR0                   cn=0,n=9

      174     2445    2            RAT.FLG.DOWN='1'B;

   2445  1 000320   200005 470500                    LDP0    LDCT$,,AUTO
         1 000321   000002 236007                    LDQ     2,DL
         1 000322   000010 256100                    ORSQ    8,,PR0

      175     2446    2            FR_PRM$(0)->FR$PR(RCD)=FR_PRM$(0)->FR$PR(RCD)-1;

   2446  1 000323   000000 471400 xsym               LDP1    FR_PRM$
         1 000324   200007 720100                    LXL0    RCD,,AUTO
         1 000325   000001 336007                    LCQ     1,DL
         1 000326   100000 056110                    ASQ     0,X0,PR1

      176     2447    2            IF RAT.FLG.SYMBIONT THEN CALL NKP$CHLST(DCT,NK_PART);

   2447  1 000327   200005 470500                    LDP0    LDCT$,,AUTO
         1 000330   000010 236100                    LDQ     8,,PR0
         1 000331   000001 316007                    CANQ    1,DL
         1 000332   000342 600000 1                  TZE     s:2449

   2447  1 000333   000001 236000 2                  LDQ     1
         1 000334   200003 235100                    LDA     @DCT,,AUTO
         1 000335   200010 757100                    STAQ    RCD+1,,AUTO
         1 000336   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000337   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000340   000000 701000 xent               TSX1    NKP$CHLST
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:24   
         1 000341   000000 011000                    NOP     0

      177     2448    2            END;

      178     2449    1         MSG=PART_MSG#;

   2449  1 000342   000037 235007                    LDA     31,DL
         1 000343   200006 755100                    STA     RA1$,,AUTO

   2449  1 000344                       MOUT         null
      179     2450    1   MOUT: ;
      180     2451    1         RCD=DCT.DCTX;

   2451  1 000344   200003 470500                    LDP0    @DCT,,AUTO
         1 000345   000006 236100                    LDQ     6,,PR0
         1 000346   000025 772000                    QRL     21
         1 000347   200007 756100                    STQ     RCD,,AUTO

      181     2452    1         CALL OCI$MK_WR (M_DEVC,MSG,0,0,0,RCD);

   2452  1 000350   200007 631500                    EPPR1   RCD,,AUTO
         1 000351   200015 451500                    STP1    RCD+6,,AUTO
         1 000352   000003 236000 2                  LDQ     3
         1 000353   200014 756100                    STQ     RCD+5,,AUTO
         1 000354   000010 237000 2                  LDAQ    8
         1 000355   200012 757100                    STAQ    RCD+3,,AUTO
         1 000356   200006 633500                    EPPR3   RA1$,,AUTO
         1 000357   200011 453500                    STP3    RCD+2,,AUTO
         1 000360   000012 236000 2                  LDQ     10
         1 000361   200010 756100                    STQ     RCD+1,,AUTO
         1 000362   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000363   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000364   000000 701000 xent               TSX1    OCI$MK_WR
         1 000365   000000 011000                    NOP     0

   2451  1 000366                       RTN          null
      182     2453    1   RTN:  ;
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:25   
      183     2454    1         RETURN;

   2454  1 000366   000000 702200 xent               TSX2  ! X66_ARET

      184     2455        /**/
      185     2456        /*F* NAME:         NKP$RTN
      186     2457             PURPOSE:      To return a partitioned device.
      187     2458        */
      188     2459    1   NKP$RTN: ENTRY (DCT,ERR) ALTRET;

   2459  1 000367   000000 700200 xent  NKP$RTN      TSX0  ! X66_AUTO_2
         1 000370   000016 000002                    ZERO    14,2

      189     2460        /**/
      190     2461    1         ERR='0'B;

   2461  1 000371   200004 470500                    LDP0    @ERR,,AUTO
         1 000372   000000 450100                    STZ     0,,PR0

      191     2462    1         IF DCT.STATUS.DOWN='0'B THEN RETURN;

   2462  1 000373   200003 471500                    LDP1    @DCT,,AUTO
         1 000374   100027 234100                    SZN     23,,PR1
         1 000375   000377 604000 1                  TMI     s:2463

   2462  1 000376   000000 702200 xent               TSX2  ! X66_ARET

      192     2463    1         IF DCT.DFLG.CONSOLE OR DCT.DFLG.SYMBIONT THEN CALL NKP$CHLST (DCT,NK_NOCG);

   2463  1 000377   100006 236100                    LDQ     6,,PR1
         1 000400   040000 316007                    CANQ    16384,DL
         1 000401   000404 601000 1                  TNZ     s:2463+5
         1 000402   020000 316007                    CANQ    8192,DL
         1 000403   000414 600000 1                  TZE     s:2466

   2463  1 000404   000013 236000 2                  LDQ     11
         1 000405   200003 235100                    LDA     @DCT,,AUTO
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:26   
         1 000406   200010 757100                    STAQ    RCD+1,,AUTO
         1 000407   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000410   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000411   000000 701000 xent               TSX1    NKP$CHLST
         1 000412   000000 011000                    NOP     0
         1 000413   000445 710000 1                  TRA     s:2472

      193     2464    1         ELSE
      194     2465    2           DO;

      195     2466    2           RAT$=DCT.RAT$;

   2466  1 000414   100005 236100                    LDQ     5,,PR1
         1 000415   200005 756100                    STQ     LDCT$,,AUTO

      196     2467    2           RAT.FLG.DOWN='0'B;

   2467  1 000416   200005 473500                    LDP3    LDCT$,,AUTO
         1 000417   000014 236000 2                  LDQ     12
         1 000420   300010 356100                    ANSQ    8,,PR3

      197     2468    2           RCD=RAT$->RAT.RCOD;

   2468  1 000421   300003 236100                    LDQ     3,,PR3
         1 000422   000027 772000                    QRL     23
         1 000423   000017 376007                    ANQ     15,DL
         1 000424   200007 756100                    STQ     RCD,,AUTO

      198     2469    2           FR_PRM$(0)->FR$PR(RCD)=FR_PRM$(0)->FR$PR(RCD)+1;

   2469  1 000425   000000 474400 xsym               LDP4    FR_PRM$
         1 000426   200007 720100                    LXL0    RCD,,AUTO
         1 000427   400000 235106                    LDA     0,QL,PR4
         1 000430   000001 035007                    ADLA    1,DL
         1 000431   400000 755110                    STA     0,X0,PR4

      199     2470    2           IF RAT.FLG.SYMBIONT THEN CALL NKP$CHLST (DCT,NK_QTRM);
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:27   

   2470  1 000432   200005 473500                    LDP3    LDCT$,,AUTO
         1 000433   300010 236100                    LDQ     8,,PR3
         1 000434   000001 316007                    CANQ    1,DL
         1 000435   000445 600000 1                  TZE     s:2472

   2470  1 000436   000006 236000 2                  LDQ     6
         1 000437   200003 235100                    LDA     @DCT,,AUTO
         1 000440   200010 757100                    STAQ    RCD+1,,AUTO
         1 000441   200010 630500                    EPPR0   RCD+1,,AUTO
         1 000442   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000443   000000 701000 xent               TSX1    NKP$CHLST
         1 000444   000000 011000                    NOP     0

      200     2471    2           END;

      201     2472    1         IF DCT.DFLG.SYMBIONT

   2472  1 000445   200003 470500                    LDP0    @DCT,,AUTO
         1 000446   000006 236100                    LDQ     6,,PR0
         1 000447   020000 316007                    CANQ    8192,DL
         1 000450   000456 600000 1                  TZE     s:2477

      202     2473    2         THEN DO;

      203     2474    2           RAT$=DCT.RAT$;

   2474  1 000451   000005 236100                    LDQ     5,,PR0
         1 000452   200005 756100                    STQ     LDCT$,,AUTO

      204     2475    2           RAT.FLG.DOWN = '0'B;

   2475  1 000453   200005 471500                    LDP1    LDCT$,,AUTO
         1 000454   000014 236000 2                  LDQ     12
         1 000455   100010 356100                    ANSQ    8,,PR1

      205     2476    2           END;
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:28   

      206     2477    1         MSG=PRTN_MSG#;

   2477  1 000456   000040 235007                    LDA     32,DL
         1 000457   200006 755100                    STA     RA1$,,AUTO

      207     2478    1         GOTO MOUT;

   2478  1 000460   000344 710000 1                  TRA     MOUT

INUSE
 Sect OctLoc
   0     000   161320 012354                                                    q...

(unnamed)
 Sect OctLoc
   0     001   161320 012364                                                    q...

(unnamed)
 Sect OctLoc
   2     000   000000 006000   000011 006000   000000 006000   000002 006000    ................
   2     004   777777 677777   000000 006000   000005 006000   100000 000000    ............@...
   2     010   000002 006000   000002 006000   000007 006000   000010 006000    ................
   2     014   777777 777775                                                    ....
      208     2479        /**/
      209     2480    1   END;
      210     2481        /**/
      211     2482        /**/
      212     2483        %EOD;

PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:29   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KC_SUBS_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   NI_DATA_C.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   FR_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure NKP$PART.
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:30   

 **** Variables and constants ****

  ****  Section 000 RoData NKP$PART

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 INUSE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DCT                       4-0-0/w PTR         r     1 @ERR
    *0-0-0/w STRC(1332)  r     1 DCT                       *0-0-0/w BIT         r     1 ERR
     5-0-0/w PTR         r     1 LDCT$                      6-0-0/w UBIN        r     1 MSG
     6-0-0/w PTR         r     1 RA1$                       5-0-0/w PTR         r     1 RAT$
     7-0-0/w UBIN        r     1 RCD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 FR$HD$(0:3)
     0-0-0/w PTR         r     1 FR_PRM$(0:0)
     0-0-0/w STRC(432)   r     1 KC_ISID                    0-0-0/w STRC(432)   r     1 KC_OCID
     0-0-0/w STRC(432)   r     1 KC_OSID                    0-0-0/w UBIN        r     1 S_PNO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 FR$PR(0:0)                 0-0-0/d STRC(864)   r     1 NK$LDCT
     0-0-0/w STRC(324)   r     1 RAT
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:31   


   Procedure NKP$PART requires 305 words for executable code.
   Procedure NKP$PART requires 14 words of local(AUTO) storage.
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:32   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:33   
          MINI XREF LISTING

CISRL
      2390**LABEL    2380--GOTO
CKNCG
      2378**LABEL    2379--CALLALT  2390--CALLALT  2405--CALLALT
DCT
      1505**DCL        12--PROC     2382<>CALL     2447<>CALL     2459--ENTRY    2463<>CALL     2470<>CALL
DCT.DCTX
      1506**DCL      2394<>CALL     2421<>CALL     2451>>ASSIGN
DCT.DEVNM
      1505**DCL      2379<>CALL     2390<>CALL     2405<>CALL
DCT.DFLG.CM
      1508**DCL      2400<<ASSIGN
DCT.DFLG.CONSOLE
      1508**DCL      2376>>IF       2393>>IF       2397>>IF       2463>>IF
DCT.DFLG.INPUT
      1507**DCL      2387>>IF
DCT.DFLG.SYMBIONT
      1509**DCL      2385>>IF       2463>>IF       2472>>IF
DCT.DP
      1525**DCL      1532--REDEF    1535--REDEF    1536--REDEF    1538--REDEF    1538--REDEF    1539--REDEF
      1540--REDEF    1540--REDEF
DCT.MPC.IOCHANX
      1533**DCL      1533--REDEF
DCT.RAT$
      1506**DCL      2398>>ASSIGN   2414>>ASSIGN   2466>>ASSIGN   2474>>ASSIGN
DCT.STATUS.DOWN
      1522**DCL      2374>>IF       2462>>IF
DSCOUT
      2392**LABEL    2409--GOTO
ERR
      1544**DCL        12--PROC     2373<<ASSIGN   2439<<ASSIGN   2459--ENTRY    2461<<ASSIGN
FMN$AVR
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:34   
      1668**DCL-ENT  2421--CALL
FR$HD$
       605**DCL      2425>>ASSIGN
FR$PR
       611**DCL      2446<<ASSIGN   2446>>ASSIGN   2469<<ASSIGN   2469>>ASSIGN
FRC$WAKU
      1669**DCL-ENT  2432--CALL
FRZ$DSMT
      1670**DCL-ENT  2443--CALL
FR_PRM$
       612**DCL      2446>>ASSIGN   2446>>ASSIGN   2469>>ASSIGN   2469>>ASSIGN
INUSE
      1654**DCL      2439>>ASSIGN
IUERR
      2431**LABEL    2393--GOTO     2407--GOTO     2424--GOTO
KCD$DSCTRM
      1671**DCL-ENT  2399--CALL
KCO$FINDSTA
      1672**DCL-ENT  2379--CALL     2390--CALL     2405--CALL
KC_ISID
      1720**DCL      2390<>CALL
KC_OCID
      1746**DCL      2379<>CALL
KC_OSID
      1694**DCL      2405<>CALL
LDCT$
      1643**DCL      1644--REDEF    2379<>CALL     2390<>CALL     2393>>IF       2394<>CALL     2399>>CALL
      2405<>CALL     2407>>IF
MOUT
      2449**LABEL    2478--GOTO
MSG
      1646**DCL      2449<<ASSIGN   2452<>CALL     2477<<ASSIGN
NIO$SPINTCON
      1673**DCL-ENT  2394--CALL
NK$LDCT
      1604**DCL      2399<>CALL
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:35   
NK$LDCT.DDT$
      1606**DCL      1606--REDEF
NK$LDCT.DFLG.SYMBIONT
      1609**DCL      2407>>IF
NK$LDCT.IOQ$
      1605**DCL      1606--REDEF
NK$LDCT.LDCTX
      1607**DCL      1607--REDEF
NK$LDCT.LKFLG.ABORTED
      1619**DCL      1620--REDEF
NK$LDCT.LKFLG.ACTIVE
      1623**DCL      2393>>IF
NK$LDCT.RLCID.LDCTX
      1629**DCL      1629--REDEF
NK$LDCT.STA$
      1625**DCL      1626--REDEF
NK$LDCT.SYMB$
      1604**DCL      1604--REDEF    1604--REDEF    1605--REDEF
NKP$CHLST
      1674**DCL-ENT  2382--CALL     2447--CALL     2463--CALL     2470--CALL
OCI$MK_WR
      1675**DCL-ENT  2452--CALL
PROUT
      2432**LABEL    2434--GOTO
RA1$
      1645**DCL      1646--REDEF    2425<<ASSIGN   2426>>DOWHILE  2427>>IF       2427>>IF       2427>>IF
      2433>>ASSIGN   2436<<ASSIGN   2436>>ASSIGN
RAT
      1553**DCL      2432<>CALL     2443<>CALL
RAT.FLG.DOWN
      1588**DCL      2398<<ASSIGN   2427>>IF       2445<<ASSIGN   2467<<ASSIGN   2475<<ASSIGN
RAT.FLG.MBIT.MTD
      1581**DCL      2416>>IF       2424>>IF
RAT.FLG.MBIT.SOL
      1583**DCL      2432>>IF
RAT.FLG.RUP
PL6.E3A0      #001=NKP$PART File=NKP$PARTRTN.:E05TSI                             WED 07/30/97 03:45 Page:36   
      1587**DCL      2443>>IF
RAT.FLG.SYMBIONT
      1589**DCL      2447>>IF       2470>>IF
RAT.LNK$
      1554**DCL      2436>>ASSIGN
RAT.M1
      1575**DCL      2416>>IF       2427>>IF
RAT.RCOD
      1566**DCL      2415>>ASSIGN   2468>>ASSIGN
RAT.REEL.ASID
      1573**DCL      2416>>IF       2431<<ASSIGN
RAT.RES
      1555**DCL      2433<<ASSIGN   2433>>ASSIGN   2444<<ASSIGN
RAT.RES.M2
      1558**DCL      2427>>IF
RAT.RES.RFLG.NOSLD
      1563**DCL      2424>>IF
RAT.RES.SISID
      1556**DCL      2416>>IF       2422>>IF       2427>>IF
RAT$
      1644**DCL      1553--IMP-PTR  2414<<ASSIGN   2415>>ASSIGN   2416>>IF       2416>>IF       2416>>IF
      2416>>IF       2422>>IF       2424>>IF       2424>>IF       2427>>IF       2431>>ASSIGN   2432>>IF
      2432>>CALL     2433>>ASSIGN   2443>>IF       2443>>CALL     2444>>ASSIGN   2445>>ASSIGN   2447>>IF
      2466<<ASSIGN   2467>>ASSIGN   2468>>ASSIGN   2470>>IF       2474<<ASSIGN   2475>>ASSIGN
RCD
      1647**DCL      2378<<ASSIGN   2379<>CALL     2389<<ASSIGN   2390<>CALL     2404<<ASSIGN   2405<>CALL
      2415<<ASSIGN   2424>>IF       2425>>ASSIGN   2446>>ASSIGN   2446>>ASSIGN   2451<<ASSIGN   2452<>CALL
      2468<<ASSIGN   2469>>ASSIGN   2469>>ASSIGN
SSS$BLOCK
      1676**DCL-ENT  2375--CALL
S_PNO
      1678**DCL      2375>>IF

PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:37   
      213        1        /*T***********************************************************/
      214        2        /*T*                                                         */
      215        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      216        4        /*T*                                                         */
      217        5        /*T***********************************************************/
      218        6        /**/
      219        7        /*F* NAME:         NKP$CHLST
      220        8        */
      221        9        NKP$CHLST: PROC (DCT,RESCOD);
      222       10
      223       11
      224       12
      225       13        /**/
      226       14        /* INCLUDES */
      227       15        /**/
      228       16        %INCLUDE NK$LDCT;
      229      118        %INCLUDE NI$TABLES;
      230      334        %INCLUDE KC$CGBLK;
      231      382        %INCLUDE KC_DATA_R;
      232      395        %INCLUDE SS_SCHED_C;
      233      628        %INCLUDE EL_SUBS_C;
      234      712        %INCLUDE NK_SUBS;
      235      737
      236      738
      237      739
      238      740        /**/
      239      741        /* PARAMETERS */
      240      742        /**/
      241      743        %NI$DCT (NAME=DCT,STCLASS="");
      242      791    1   DCL RESCOD UBIN;
      243      792
      244      793
      245      794
      246      795        /**/
      247      796        /* BASED STRUCTURES */
      248      797        /**/
      249      798        %NK$LDCT;
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:38   
      250      844
      251      845
      252      846
      253      847        /**/
      254      848        /* AUTO */
      255      849        /**/
      256      850        %KC$CGID (FPTN=UPRT,STCLASS="",LAST=",");
      257      876    1         2 STATION CHAR(8);
      258      877    1   DCL LDCT$ PTR;
      259      878    1   DCL TMP UBIN;
      260      879
      261      880
      262      881
      263      882        /**/
      264      883        /* REFS */
      265      884        /**/
      266      885    1   DCL ELA$SYSLOG    ENTRY(6) ALTRET;
      267      886    1   DCL KCL$ININT     ENTRY(3);
      268      887    1   DCL KCL$OCINT     ENTRY(3);
      269      888    1   DCL NIO$SPINTCON  ENTRY(3) ALTRET;
      270      889    1   DCL SSR$REG       ENTRY(3) ALTRET;
      271      890        %KC$CGID (FPTN=KC_OCID,STCLASS=SYMREF);
      272      916        %KC$CGID (FPTN=KC_OSID,STCLASS=SYMREF);
      273      942        %KC$CGID (FPTN=KC_ISID,STCLASS=SYMREF);
      274      968        /**/
      275      969        /**/
      276      970    2           DO INHIBIT;
      277      971    2           LDCT$=KC_NOCG$;
      278      972    3             DO WHILE (LDCT$~=ADDR(NIL));
      279      973    3             IF LDCT$->LDCT.RLCID.NODE=0
      280      974    3             AND LDCT$->LDCT.RLCID.LDCTX=DCT.DCTX THEN GOTO FOUND;
      281      975    3             LDCT$=LDCT$->LDCT.LNK$;
      282      976    3             END;
      283      977    2           END;
      284      978    1         RETURN;
      285      979    1   FOUND:;
      286      980    1         LDCT$->LDCT.RESCOD=RESCOD;
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:39   
      287      981    1         IF RESCOD~=NK_NOCG THEN RETURN;
      288      982    1         DCT.DFLG.CM='1'B;
      289      983    1         IF DCT.DFLG.CONSOLE THEN
      290      984    2           DO;
      291      985    2           UPRT=KC_OCID;
      292      986    2           CALL NIO$SPINTCON (DCT.DCTX,ENTADDR(KCL$OCINT),LDCT$);
      293      987    2           END;
      294      988    1         ELSE IF DCT.DFLG.INPUT THEN
      295      989    2            DO;
      296      990    2            UPRT=KC_ISID;
      297      991    2            CALL NIO$SPINTCON (DCT.DCTX,ENTADDR(KCL$ININT),LDCT$);
      298      992    2            END;
      299      993    1          ELSE UPRT=KC_OSID;
      300      994    1         UPRT.STATION=LDCT$->LDCT.DEVNM;
      301      995    1   ELFGO:;
      302      996    1         CALL ELA$SYSLOG (EL_UPRT,UPRT,SIZEW(UPRT),'0'B,2,TMP) ALTRET (ELFWT);
      303      997    1         RETURN;
      304      998    1   ELFWT:;
      305      999    1         CALL SSR$REG (%SS_SL,ADDR(NIL),1);
      306     1000    1         GOTO ELFGO;
      307     1001        /**/
      308     1002    1   END;
      309     1003        /**/
      310     1004        /**/
      311     1005        %EOD;

PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:40   
--  Include file information  --

   NK_SUBS.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure NKP$CHLST.

   Procedure NKP$CHLST requires 107 words for executable code.
   Procedure NKP$CHLST requires 28 words of local(AUTO) storage.

PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:41   

 Object Unit name= NKP$CHLST                                  File name= NKP$PARTRTN.:E05TOU
 UTS= JUL 30 '97 03:46:04.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   107    153  NKP$CHLST
    1  RoData even  none     8     10  NKP$CHLST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  NKP$CHLST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 KCL$OCINT
 yes     yes           Std       3 NIO$SPINTCON
         yes           Std       3 KCL$ININT
 yes     yes           Std       3 SSR$REG
 yes     yes           Std       6 ELA$SYSLOG
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:42   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KC_NOCG$                              KC_OCID                               KC_OSID
     KC_ISID                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:43   


      213        1        /*T***********************************************************/
      214        2        /*T*                                                         */
      215        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      216        4        /*T*                                                         */
      217        5        /*T***********************************************************/
      218        6        /**/
      219        7        /*F* NAME:         NKP$CHLST
      220        8        */
      221        9        NKP$CHLST: PROC (DCT,RESCOD);

      9  0 000000   000000 700200 xent  NKP$CHLST    TSX0  ! X66_AUTO_2
         0 000001   000034 000002                    ZERO    28,2

      222       10
      223       11
      224       12
      225       13        /**/
      226       14        /* INCLUDES */
      227       15        /**/
      228       16        %INCLUDE NK$LDCT;
      229      118        %INCLUDE NI$TABLES;
      230      334        %INCLUDE KC$CGBLK;
      231      382        %INCLUDE KC_DATA_R;
      232      395        %INCLUDE SS_SCHED_C;
      233      628        %INCLUDE EL_SUBS_C;
      234      712        %INCLUDE NK_SUBS;
      235      737
      236      738
      237      739
      238      740        /**/
      239      741        /* PARAMETERS */
      240      742        /**/
      241      743        %NI$DCT (NAME=DCT,STCLASS="");
      242      791    1   DCL RESCOD UBIN;
      243      792
      244      793
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:44   
      245      794
      246      795        /**/
      247      796        /* BASED STRUCTURES */
      248      797        /**/
      249      798        %NK$LDCT;
      250      844
      251      845
      252      846
      253      847        /**/
      254      848        /* AUTO */
      255      849        /**/
      256      850        %KC$CGID (FPTN=UPRT,STCLASS="",LAST=",");
      257      876    1         2 STATION CHAR(8);
      258      877    1   DCL LDCT$ PTR;
      259      878    1   DCL TMP UBIN;
      260      879
      261      880
      262      881
      263      882        /**/
      264      883        /* REFS */
      265      884        /**/
      266      885    1   DCL ELA$SYSLOG    ENTRY(6) ALTRET;
      267      886    1   DCL KCL$ININT     ENTRY(3);
      268      887    1   DCL KCL$OCINT     ENTRY(3);
      269      888    1   DCL NIO$SPINTCON  ENTRY(3) ALTRET;
      270      889    1   DCL SSR$REG       ENTRY(3) ALTRET;
      271      890        %KC$CGID (FPTN=KC_OCID,STCLASS=SYMREF);
      272      916        %KC$CGID (FPTN=KC_OSID,STCLASS=SYMREF);
      273      942        %KC$CGID (FPTN=KC_ISID,STCLASS=SYMREF);
      274      968        /**/
      275      969        /**/
      276      970    2           DO INHIBIT;

      277      971    2           LDCT$=KC_NOCG$;

    971  0 000002   000000 236200 xsym               LDQ   ! KC_NOCG$
         0 000003   200023 756300                    STQ   ! LDCT$,,AUTO
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:45   

      278      972    3             DO WHILE (LDCT$~=ADDR(NIL));

    972  0 000004   000023 710200 0                  TRA   ! s:976

      279      973    3             IF LDCT$->LDCT.RLCID.NODE=0

    973  0 000005   200023 470700                    LDP0  ! LDCT$,,AUTO
         0 000006   000015 236300                    LDQ   ! 13,,PR0
         0 000007   777000 316203                    CANQ  ! -512,DU
         0 000010   000021 601200 0                  TNZ   ! s:975
         0 000011   200003 471700                    LDP1  ! @DCT,,AUTO
         0 000012   100006 236300                    LDQ   ! 6,,PR1
         0 000013   000025 772200                    QRL   ! 21
         0 000014   200026 756300                    STQ   ! TMP+2,,AUTO
         0 000015   000015 236300                    LDQ   ! 13,,PR0
         0 000016   777777 376207                    ANQ   ! -1,DL
         0 000017   200026 116300                    CMPQ  ! TMP+2,,AUTO
         0 000020   000026 600200 0                  TZE   ! FOUND

      280      974    3             AND LDCT$->LDCT.RLCID.LDCTX=DCT.DCTX THEN GOTO FOUND;
      281      975    3             LDCT$=LDCT$->LDCT.LNK$;

    975  0 000021   000004 236300                    LDQ   ! 4,,PR0
         0 000022   200023 756300                    STQ   ! LDCT$,,AUTO

      282      976    3             END;

    976  0 000023   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         0 000024   000005 601200 0                  TNZ   ! s:973

      283      977    2           END;

      284      978    1         RETURN;

    978  0 000025   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:46   
      285      979    1   FOUND:;

    979  0 000026                       FOUND        null
      286      980    1         LDCT$->LDCT.RESCOD=RESCOD;

    980  0 000026   200004 473500                    LDP3    @RESCOD,,AUTO
         0 000027   300000 236100                    LDQ     0,,PR3
         0 000030   000006 676100                    ERQ     6,,PR0
         0 000031   000017 376007                    ANQ     15,DL
         0 000032   000006 656100                    ERSQ    6,,PR0

      287      981    1         IF RESCOD~=NK_NOCG THEN RETURN;

    981  0 000033   300000 235100                    LDA     0,,PR3
         0 000034   000006 115007                    CMPA    6,DL
         0 000035   000037 600000 0                  TZE     s:982

    981  0 000036   000000 702200 xent               TSX2  ! X66_ARET

      288      982    1         DCT.DFLG.CM='1'B;

    982  0 000037   100000 236007                    LDQ     32768,DL
         0 000040   100006 256100                    ORSQ    6,,PR1

      289      983    1         IF DCT.DFLG.CONSOLE THEN

    983  0 000041   100006 236100                    LDQ     6,,PR1
         0 000042   040000 316007                    CANQ    16384,DL
         0 000043   000065 600000 0                  TZE     s:988

      290      984    2           DO;

      291      985    2           UPRT=KC_OCID;

    985  0 000044   000100 100400                    MLR     fill='000'O
         0 000045   000000 000060 xsym               ADSC9   KC_OCID                  cn=0,n=48
         0 000046   200005 000070                    ADSC9   UPRT,,AUTO               cn=0,n=56
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:47   

      292      986    2           CALL NIO$SPINTCON (DCT.DCTX,ENTADDR(KCL$OCINT),LDCT$);

    986  0 000047   000000 636000 xent               EAQ     KCL$OCINT
         0 000050   200026 756100                    STQ     TMP+2,,AUTO
         0 000051   200023 630500                    EPPR0   LDCT$,,AUTO
         0 000052   200031 450500                    STP0    TMP+5,,AUTO
         0 000053   200026 634500                    EPPR4   TMP+2,,AUTO
         0 000054   200030 454500                    STP4    TMP+4,,AUTO
         0 000055   200003 236100                    LDQ     @DCT,,AUTO
         0 000056   000006 036003                    ADLQ    6,DU
         0 000057   200027 756100                    STQ     TMP+3,,AUTO
         0 000060   200027 630500                    EPPR0   TMP+3,,AUTO
         0 000061   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000062   000000 701000 xent               TSX1    NIO$SPINTCON
         0 000063   000000 011000                    NOP     0

      293      987    2           END;

    987  0 000064   000113 710000 0                  TRA     s:994

      294      988    1         ELSE IF DCT.DFLG.INPUT THEN

    988  0 000065   400000 316007                    CANQ    -131072,DL
         0 000066   000110 600000 0                  TZE     s:993

      295      989    2            DO;

      296      990    2            UPRT=KC_ISID;

    990  0 000067   000100 100400                    MLR     fill='000'O
         0 000070   000000 000060 xsym               ADSC9   KC_ISID                  cn=0,n=48
         0 000071   200005 000070                    ADSC9   UPRT,,AUTO               cn=0,n=56

      297      991    2            CALL NIO$SPINTCON (DCT.DCTX,ENTADDR(KCL$ININT),LDCT$);

    991  0 000072   000000 636000 xent               EAQ     KCL$ININT
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:48   
         0 000073   200026 756100                    STQ     TMP+2,,AUTO
         0 000074   200023 630500                    EPPR0   LDCT$,,AUTO
         0 000075   200031 450500                    STP0    TMP+5,,AUTO
         0 000076   200026 634500                    EPPR4   TMP+2,,AUTO
         0 000077   200030 454500                    STP4    TMP+4,,AUTO
         0 000100   200003 236100                    LDQ     @DCT,,AUTO
         0 000101   000006 036003                    ADLQ    6,DU
         0 000102   200027 756100                    STQ     TMP+3,,AUTO
         0 000103   200027 630500                    EPPR0   TMP+3,,AUTO
         0 000104   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000105   000000 701000 xent               TSX1    NIO$SPINTCON
         0 000106   000000 011000                    NOP     0

      298      992    2            END;

    992  0 000107   000113 710000 0                  TRA     s:994

      299      993    1          ELSE UPRT=KC_OSID;

    993  0 000110   000100 100400                    MLR     fill='000'O
         0 000111   000000 000060 xsym               ADSC9   KC_OSID                  cn=0,n=48
         0 000112   200005 000070                    ADSC9   UPRT,,AUTO               cn=0,n=56

      300      994    1         UPRT.STATION=LDCT$->LDCT.DEVNM;

    994  0 000113   200023 470500                    LDP0    LDCT$,,AUTO
         0 000114   000002 237100                    LDAQ    2,,PR0
         0 000115   200021 755100                    STA     UPRT+12,,AUTO
         0 000116   200022 756100                    STQ     UPRT+13,,AUTO

    994  0 000117                       ELFGO        null
      301      995    1   ELFGO:;
      302      996    1         CALL ELA$SYSLOG (EL_UPRT,UPRT,SIZEW(UPRT),'0'B,2,TMP) ALTRET (ELFWT);

    996  0 000117   200024 630500                    EPPR0   TMP,,AUTO
         0 000120   200033 450500                    STP0    TMP+7,,AUTO
         0 000121   000001 236000 1                  LDQ     1
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:49   
         0 000122   200032 756100                    STQ     TMP+6,,AUTO
         0 000123   000002 237000 1                  LDAQ    2
         0 000124   200030 757100                    STAQ    TMP+4,,AUTO
         0 000125   200005 631500                    EPPR1   UPRT,,AUTO
         0 000126   200027 451500                    STP1    TMP+3,,AUTO
         0 000127   000004 236000 1                  LDQ     4
         0 000130   200026 756100                    STQ     TMP+2,,AUTO
         0 000131   200026 630500                    EPPR0   TMP+2,,AUTO
         0 000132   000024 631400 xsym               EPPR1   B_VECTNIL+20
         0 000133   000000 701000 xent               TSX1    ELA$SYSLOG
         0 000134   000136 702000 0                  TSX2    ELFWT

      303      997    1         RETURN;

    997  0 000135   000000 702200 xent               TSX2  ! X66_ARET

    994  0 000136                       ELFWT        null
      304      998    1   ELFWT:;
      305      999    1         CALL SSR$REG (%SS_SL,ADDR(NIL),1);

    999  0 000136   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000137   200026 756100                    STQ     TMP+2,,AUTO
         0 000140   000006 236000 1                  LDQ     6
         0 000141   200031 756100                    STQ     TMP+5,,AUTO
         0 000142   200026 630500                    EPPR0   TMP+2,,AUTO
         0 000143   200030 450500                    STP0    TMP+4,,AUTO
         0 000144   000007 236000 1                  LDQ     7
         0 000145   200027 756100                    STQ     TMP+3,,AUTO
         0 000146   200027 630500                    EPPR0   TMP+3,,AUTO
         0 000147   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000150   000000 701000 xent               TSX1    SSR$REG
         0 000151   000000 011000                    NOP     0

      306     1000    1         GOTO ELFGO;

   1000  0 000152   000117 710000 0                  TRA     ELFGO

PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:50   
(unnamed)
 Sect OctLoc
   1     000   000000 000016   000004 006000   000000 006000   000002 006000    ................
   1     004   000011 006000   000000 000031   000003 006000   000005 006000    ................
      307     1001        /**/
      308     1002    1   END;
      309     1003        /**/
      310     1004        /**/
      311     1005        %EOD;

PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:51   
--  Include file information  --

   NK_SUBS.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   KC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure NKP$CHLST.
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:52   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DCT                       4-0-0/w PTR         r     1 @RESCOD
    *0-0-0/w STRC(1332)  r     1 DCT                       23-0-0/w PTR         r     1 LDCT$
    *0-0-0/w UBIN        r     1 RESCOD                    24-0-0/w UBIN        r     1 TMP
     5-0-0/w STRC(504)   r     1 UPRT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 KC_ISID                    0-0-0/w PTR         r     1 KC_NOCG$
     0-0-0/w STRC(432)   r     1 KC_OCID                    0-0-0/w STRC(432)   r     1 KC_OSID

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(864)   r     1 NK$LDCT


   Procedure NKP$CHLST requires 107 words for executable code.
   Procedure NKP$CHLST requires 28 words of local(AUTO) storage.
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:53   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:54   
          MINI XREF LISTING

DCT
       752**DCL         9--PROC
DCT.DCTX
       753**DCL       973>>IF        986<>CALL      991<>CALL
DCT.DFLG.CM
       755**DCL       982<<ASSIGN
DCT.DFLG.CONSOLE
       755**DCL       983>>IF
DCT.DFLG.INPUT
       754**DCL       988>>IF
DCT.DP
       772**DCL       779--REDEF     782--REDEF     783--REDEF     785--REDEF     785--REDEF     786--REDEF
       787--REDEF     787--REDEF
DCT.MPC.IOCHANX
       780**DCL       780--REDEF
ELA$SYSLOG
       885**DCL-ENT   996--CALL
ELFGO
       994**LABEL    1000--GOTO
ELFWT
       994**LABEL     996--CALLALT
FOUND
       979**LABEL     974--GOTO
KCL$ININT
       886**DCL-ENT   991--CALL
KCL$OCINT
       887**DCL-ENT   986--CALL
KC_ISID
       957**DCL       990>>ASSIGN
KC_NOCG$
       393**DCL       971>>ASSIGN
KC_OCID
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:55   
       905**DCL       985>>ASSIGN
KC_OSID
       931**DCL       993>>ASSIGN
LDCT$
       877**DCL       971<<ASSIGN    972>>DOWHILE   973>>IF        973>>IF        975<<ASSIGN    975>>ASSIGN
       980>>ASSIGN    986<>CALL      991<>CALL      994>>ASSIGN
NIO$SPINTCON
       888**DCL-ENT   986--CALL      991--CALL
NK$LDCT.DDT$
       813**DCL       813--REDEF
NK$LDCT.DEVNM
       813**DCL       994>>ASSIGN
NK$LDCT.IOQ$
       812**DCL       813--REDEF
NK$LDCT.LDCTX
       814**DCL       814--REDEF
NK$LDCT.LKFLG.ABORTED
       826**DCL       827--REDEF
NK$LDCT.LNK$
       813**DCL       975>>ASSIGN
NK$LDCT.RESCOD
       819**DCL       980<<ASSIGN
NK$LDCT.RLCID.LDCTX
       836**DCL       836--REDEF     973>>IF
NK$LDCT.RLCID.NODE
       835**DCL       973>>IF
NK$LDCT.STA$
       832**DCL       833--REDEF
NK$LDCT.SYMB$
       811**DCL       811--REDEF     811--REDEF     812--REDEF
RESCOD
       791**DCL         9--PROC      980>>ASSIGN    981>>IF
SSR$REG
       889**DCL-ENT   999--CALL
TMP
       878**DCL       996<>CALL
PL6.E3A0      #002=NKP$CHLST File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:56   
UPRT
       865**DCL       985<<ASSIGN    990<<ASSIGN    993<<ASSIGN    996<>CALL      996--CALL
UPRT.STATION
       876**DCL       994<<ASSIGN

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:57   
      312        1        /*T***********************************************************/
      313        2        /*T*                                                         */
      314        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      315        4        /*T*                                                         */
      316        5        /*T***********************************************************/
      317        6        /**/
      318        7        /*F* NAME:         NKP$KEYIN
      319        8             PURPOSE:      To process the MAKE keyins
      320        9        */
      321       10        NKP$KEYIN: PROC (KMSG) ALTRET;
      322       11
      323       12
      324       13
      325       14        /**/
      326       15        /* INCLUDES */
      327       16        /**/
      328       17        %INCLUDE NK$LDCT;
      329      119        %INCLUDE KC$CGBLK;
      330      167        %INCLUDE NI$TABLES;
      331      383        %INCLUDE FR$RAT;
      332      436        %INCLUDE NK_LDCT_R;
      333      445        %INCLUDE FR_DATA_R;
      334      477        %INCLUDE OC_SUBS_C;
      335     1208        %INCLUDE NK_SUBS;
      336     1233
      337     1234
      338     1235
      339     1236        /**/
      340     1237        /* PARAMETERS */
      341     1238        /**/
      342     1239    1   DCL 1 KMSG ALIGNED,
      343     1240    1         2 KIN# UBIN(18) UNAL,
      344     1241    1         2 CADDR BIT(18) UNAL,
      345     1242    1         2 DEV CHAR(8),
      346     1243    1         2 DTW REDEF DEV,
      347     1244    1           3 D CHAR(4),
      348     1245    1           3 TW CHAR(4);
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:58   
      349     1246
      350     1247
      351     1248
      352     1249        /**/
      353     1250        /* BASED STRUCTURES */
      354     1251        /**/
      355     1252        %NI$DCT (NAME=DCT);
      356     1300        %NK$LDCT;
      357     1346        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
      358     1386
      359     1387
      360     1388
      361     1389        /**/
      362     1390        /* AUTO */
      363     1391        /**/
      364     1392    1   DCL ERCOD UBIN WORD;
      365     1393    1   DCL RCD REDEF ERCOD UBIN WORD;
      366     1394    1   DCL DCTX UBIN WORD;
      367     1395    1   DCL LDCT$ PTR;
      368     1396    1   DCL RAT$ PTR;
      369     1397    1   DCL CADDR BIT(36) ALIGNED;
      370     1398    1   DCL DCT$ PTR;
      371     1399
      372     1400
      373     1401
      374     1402        /**/
      375     1403        /* REFS */
      376     1404        /**/
      377     1405    1   DCL KCD$DSCTRM    ENTRY(2);
      378     1406    1   DCL KCO$FINDSTA   ENTRY(4) ALTRET;
      379     1407    1   DCL NIO$SPINTCON  ENTRY(3) ALTRET;
      380     1408    1   DCL NKP$CHLST     ENTRY(2);
      381     1409    1   DCL OCI$MK_WR     ENTRY(7);
      382     1410    1   DCL OCZ$DEV_DCT   ENTRY(3) ALTRET;
      383     1411
      384     1412        %KC$CGID (FPTN=KC_ISID,STCLASS=SYMREF);
      385     1438        %KC$CGID (FPTN=KC_OSID,STCLASS=SYMREF);
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:59   
      386     1464
      387     1465
      388     1466
      389     1467        /**/
      390     1468        /* SUBS */
      391     1469        /**/
      392     1470        %SUB ER_NLCL=0/*NLCL*/;     /* LP01 IS NOT A LOCAL DEVICE */
      393     1471        %SUB ER_NOWSY=1/*NOWSY*/;   /* LP01 IS ALREADY SYMBIONT */
      394     1472        %SUB ER_CNTSY=2/*CNTSY*/;   /* LP01 CANNOT BE SYMBIONT */
      395     1473        %SUB ER_USED=3/*USED*/;     /* LP01 IS IN USE */
      396     1474        %SUB ER_SYOK=4/*SYOK*/;     /* LP01 IS NOW SYMBIONT */
      397     1475        %SUB ER_SYOKP=5/*SYOKP*/;   /* LP01 IS NOW SYMBIONT PARTITIONED */
      398     1476        %SUB ER_NTSYM=6/*NTSYM*/;   /* LP01 IS NOT SYMBIONT */
      399     1477        %SUB ER_RSOK=7/*RSOK*/;     /* LP01 IS NOW A RESOURCE */
      400     1478        %SUB ER_RSOKP=8/*RSOKP*/;   /* LP01 IS NOW A PARTITIONED RESOURCE */
      401     1479
      402     1480        %INCLUDE FR_SUBS;
      403     1548        /**/
      404     1549        /**/
      405     1550    1         CALL OCZ$DEV_DCT (KMSG.DEV,DCTX,KMSG.CADDR) ALTRET (RTN);
      406     1551    1         DCT$=NK$LDCT$(DCTX);
      407     1552    2           DO CASE (KMSG.KIN#);
      408     1553    2             CASE (KEY_MAKSYM#);
      409     1554    2               IF DCT$->DCT.DFLG.SYMBIONT THEN
      410     1555    3                 DO;
      411     1556    3                 ERCOD=ER_NOWSY;
      412     1557    3                 GOTO ERRMSG;
      413     1558    3                 END;
      414     1559    2               RAT$=DCT$->DCT.RAT$;
      415     1560    2               IF RAT$=ADDR(NIL) THEN GOTO NOSYM;
      416     1561    2               IF NOT RAT.FLG.SYMBIONT THEN
      417     1562    3                 DO;
      418     1563    3   NOSYM:        ;
      419     1564    3                 ERCOD=ER_CNTSY;
      420     1565    3                 GOTO ERRMSG;
      421     1566    3                 END;
      422     1567    2               IF RAT.RES.SISID~=0 THEN
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:60   
      423     1568    3                 DO;
      424     1569    3   INUSE:        ;
      425     1570    3                 ERCOD=ER_USED;
      426     1571    3                 GOTO ERRMSG;
      427     1572    3                 END;
      428     1573    2               DCT$->DCT.DFLG.SYMBIONT='1'B;
      429     1574    2               RAT.RES.RFLG.NOSLD='1'B;
      430     1575    2               RAT.RES.SISID=1;
      431     1576    2               IF DCT$->DCT.STATUS.DOWN='0'B THEN
      432     1577    3                 DO;
      433     1578    3                 RCD=RAT.RCOD;
      434     1579    3                 FR_PRM$(0)->FR$PR(RCD)=FR_PRM$(0)->FR$PR(RCD)-1;
      435     1580    3                 CALL NKP$CHLST (DCT$->DCT,NK_NOCG);
      436     1581    3                 ERCOD=ER_SYOK;
      437     1582    3                 END;
      438     1583    2               ELSE ERCOD=ER_SYOKP;
      439     1584    2             CASE (KEY_MAKRES#);
      440     1585    2               IF DCT$->DCT.DFLG.SYMBIONT='0'B THEN
      441     1586    3                 DO;
      442     1587    3   NTSYM:        ;
      443     1588    3                 ERCOD=ER_NTSYM;
      444     1589    3                 GOTO ERRMSG;
      445     1590    3                 END;
      446     1591    2               RAT$=DCT$->DCT.RAT$;
      447     1592    2               IF DCT$->DCT.STATUS.DOWN THEN
      448     1593    3                 DO;
      449     1594    3                 RAT.RES.RFLG.NOSLD='0'B;
      450     1595    3                 RAT.RES.SISID=0;
      451     1596    3                 DCT$->DCT.DFLG.SYMBIONT='0'B;
      452     1597    3                 ERCOD=ER_RSOKP;
      453     1598    3                 END;
      454     1599    2               ELSE
      455     1600    3                 DO;
      456     1601    3                 IF DCT$->DCT.DFLG.INPUT THEN
      457     1602    4                   DO;
      458     1603    4                   RCD=8;
      459     1604    4                   CALL KCO$FINDSTA (LDCT$,KC_ISID,DCT$->DCT.DEVNM,RCD) ALTRET (NTSYM);
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:61   
      460     1605    4                   IF LDCT$->LDCT.LKFLG.ACTIVE THEN GOTO INUSE;
      461     1606    4                   CALL NIO$SPINTCON (DCT$->DCT.DCTX,ENTADDR(NIL),LDCT$);
      462     1607    4                   END;
      463     1608    3                 ELSE
      464     1609    4                   DO;
      465     1610    4                   RCD=8;
      466     1611    4                   CALL KCO$FINDSTA (LDCT$,KC_OSID,DCT$->DCT.DEVNM,RCD) ALTRET (NTSYM);
      467     1612    4                   IF LDCT$->LDCT.DFLG.SYMBIONT THEN GOTO INUSE;
      468     1613    4                   END;
      469     1614    3                 CALL KCD$DSCTRM (LDCT$->LDCT);
      470     1615    3                 DCT$->DCT.DFLG.SYMBIONT='0'B;
      471     1616    3                 RAT.RES.RFLG.NOSLD='0'B;
      472     1617    3                 RAT.RES.SISID=0;
      473     1618    3                 DCT$->DCT.DFLG.CM='0'B;
      474     1619    3                 RAT$=DCT$->DCT.RAT$;
      475     1620    3                 RCD=RAT.RCOD;
      476     1621    3                 FR_PRM$(0)->FR$PR(RCD)=FR_PRM$(0)->FR$PR(RCD)+1;
      477     1622    3                 ERCOD=ER_RSOK;
      478     1623    3                 END;
      479     1624    2             CASE (ELSE);
      480     1625    2               ALTRETURN;
      481     1626    2           END;
      482     1627    1         CADDR=M_UR;
      483     1628    1   WRTOP:;
      484     1629    1         CALL OCI$MK_WR (CADDR,SYRS_MSG#,1,'004'O,ERCOD,DCTX);
      485     1630    1   RTN:  ;
      486     1631    1         RETURN;
      487     1632    1   ERRMSG:;
      488     1633    1         CADDR=KMSG.CADDR;
      489     1634    1         GOTO WRTOP;
      490     1635        /**/
      491     1636    1   END;
      492     1637        /**/
      493     1638        /**/

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:62   
--  Include file information  --

   FR_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure NKP$KEYIN.

   Procedure NKP$KEYIN requires 205 words for executable code.
   Procedure NKP$KEYIN requires 16 words of local(AUTO) storage.

    No errors detected in file NKP$PARTRTN.:E05TSI    .

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:63   

 Object Unit name= NKP$KEYIN                                  File name= NKP$PARTRTN.:E05TOU
 UTS= JUL 30 '97 03:46:16.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   205    315  NKP$KEYIN
    1  RoData even  none    12     14  NKP$KEYIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        1  NKP$KEYIN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 OCZ$DEV_DCT
         yes           Std       2 NKP$CHLST
 yes     yes           Std       3 NIO$SPINTCON
         yes           Std       7 OCI$MK_WR
 yes     yes           Std       4 KCO$FINDSTA
         yes           Std       2 KCD$DSCTRM
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:64   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                               FR_PRM$                               KC_ISID
     KC_OSID                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:65   


      312        1        /*T***********************************************************/
      313        2        /*T*                                                         */
      314        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      315        4        /*T*                                                         */
      316        5        /*T***********************************************************/
      317        6        /**/
      318        7        /*F* NAME:         NKP$KEYIN
      319        8             PURPOSE:      To process the MAKE keyins
      320        9        */
      321       10        NKP$KEYIN: PROC (KMSG) ALTRET;

     10  0 000000   000000 700200 xent  NKP$KEYIN    TSX0  ! X66_AUTO_1
         0 000001   000020 000001                    ZERO    16,1

      322       11
      323       12
      324       13
      325       14        /**/
      326       15        /* INCLUDES */
      327       16        /**/
      328       17        %INCLUDE NK$LDCT;
      329      119        %INCLUDE KC$CGBLK;
      330      167        %INCLUDE NI$TABLES;
      331      383        %INCLUDE FR$RAT;
      332      436        %INCLUDE NK_LDCT_R;
      333      445        %INCLUDE FR_DATA_R;
      334      477        %INCLUDE OC_SUBS_C;
      335     1208        %INCLUDE NK_SUBS;
      336     1233
      337     1234
      338     1235
      339     1236        /**/
      340     1237        /* PARAMETERS */
      341     1238        /**/
      342     1239    1   DCL 1 KMSG ALIGNED,
      343     1240    1         2 KIN# UBIN(18) UNAL,
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:66   
      344     1241    1         2 CADDR BIT(18) UNAL,
      345     1242    1         2 DEV CHAR(8),
      346     1243    1         2 DTW REDEF DEV,
      347     1244    1           3 D CHAR(4),
      348     1245    1           3 TW CHAR(4);
      349     1246
      350     1247
      351     1248
      352     1249        /**/
      353     1250        /* BASED STRUCTURES */
      354     1251        /**/
      355     1252        %NI$DCT (NAME=DCT);
      356     1300        %NK$LDCT;
      357     1346        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
      358     1386
      359     1387
      360     1388
      361     1389        /**/
      362     1390        /* AUTO */
      363     1391        /**/
      364     1392    1   DCL ERCOD UBIN WORD;
      365     1393    1   DCL RCD REDEF ERCOD UBIN WORD;
      366     1394    1   DCL DCTX UBIN WORD;
      367     1395    1   DCL LDCT$ PTR;
      368     1396    1   DCL RAT$ PTR;
      369     1397    1   DCL CADDR BIT(36) ALIGNED;
      370     1398    1   DCL DCT$ PTR;
      371     1399
      372     1400
      373     1401
      374     1402        /**/
      375     1403        /* REFS */
      376     1404        /**/
      377     1405    1   DCL KCD$DSCTRM    ENTRY(2);
      378     1406    1   DCL KCO$FINDSTA   ENTRY(4) ALTRET;
      379     1407    1   DCL NIO$SPINTCON  ENTRY(3) ALTRET;
      380     1408    1   DCL NKP$CHLST     ENTRY(2);
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:67   
      381     1409    1   DCL OCI$MK_WR     ENTRY(7);
      382     1410    1   DCL OCZ$DEV_DCT   ENTRY(3) ALTRET;
      383     1411
      384     1412        %KC$CGID (FPTN=KC_ISID,STCLASS=SYMREF);
      385     1438        %KC$CGID (FPTN=KC_OSID,STCLASS=SYMREF);
      386     1464
      387     1465
      388     1466
      389     1467        /**/
      390     1468        /* SUBS */
      391     1469        /**/
      392     1470        %SUB ER_NLCL=0/*NLCL*/;     /* LP01 IS NOT A LOCAL DEVICE */
      393     1471        %SUB ER_NOWSY=1/*NOWSY*/;   /* LP01 IS ALREADY SYMBIONT */
      394     1472        %SUB ER_CNTSY=2/*CNTSY*/;   /* LP01 CANNOT BE SYMBIONT */
      395     1473        %SUB ER_USED=3/*USED*/;     /* LP01 IS IN USE */
      396     1474        %SUB ER_SYOK=4/*SYOK*/;     /* LP01 IS NOW SYMBIONT */
      397     1475        %SUB ER_SYOKP=5/*SYOKP*/;   /* LP01 IS NOW SYMBIONT PARTITIONED */
      398     1476        %SUB ER_NTSYM=6/*NTSYM*/;   /* LP01 IS NOT SYMBIONT */
      399     1477        %SUB ER_RSOK=7/*RSOK*/;     /* LP01 IS NOW A RESOURCE */
      400     1478        %SUB ER_RSOKP=8/*RSOKP*/;   /* LP01 IS NOW A PARTITIONED RESOURCE */
      401     1479
      402     1480        %INCLUDE FR_SUBS;
      403     1548        /**/
      404     1549        /**/
      405     1550    1         CALL OCZ$DEV_DCT (KMSG.DEV,DCTX,KMSG.CADDR) ALTRET (RTN);

   1550  0 000002   200003 236100                    LDQ     @KMSG,,AUTO
         0 000003   400000 036007                    ADLQ    -131072,DL
         0 000004   200014 756100                    STQ     DCT$+3,,AUTO
         0 000005   200005 630500                    EPPR0   DCTX,,AUTO
         0 000006   200013 450500                    STP0    DCT$+2,,AUTO
         0 000007   200003 236100                    LDQ     @KMSG,,AUTO
         0 000010   000001 036003                    ADLQ    1,DU
         0 000011   200012 756100                    STQ     DCT$+1,,AUTO
         0 000012   200012 630500                    EPPR0   DCT$+1,,AUTO
         0 000013   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000014   000000 701000 xent               TSX1    OCZ$DEV_DCT
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:68   
         0 000015   000307 702000 0                  TSX2    RTN

      406     1551    1         DCT$=NK$LDCT$(DCTX);

   1551  0 000016   000000 470400 xsym               LDP0    N$DCT$$
         0 000017   200005 720100                    LXL0    DCTX,,AUTO
         0 000020   000000 236110                    LDQ     0,X0,PR0
         0 000021   200011 756100                    STQ     DCT$,,AUTO

      407     1552    2           DO CASE (KMSG.KIN#);

   1552  0 000022   200003 471500                    LDP1    @KMSG,,AUTO
         0 000023   100000 221100                    LDX1    0,,PR1
         0 000024   000003 101003                    CMPX1   3,DU
         0 000025   000027 602011 0                  TNC     s:1552+5,X1
         0 000026   000266 710000 0                  TRA     s:1625
         0 000027   000266 710000 0                  TRA     s:1625
         0 000030   000032 710000 0                  TRA     s:1554
         0 000031   000117 710000 0                  TRA     s:1585

      408     1553    2             CASE (KEY_MAKSYM#);

      409     1554    2               IF DCT$->DCT.DFLG.SYMBIONT THEN

   1554  0 000032   200011 473500                    LDP3    DCT$,,AUTO
         0 000033   300006 236100                    LDQ     6,,PR3
         0 000034   020000 316007                    CANQ    8192,DL
         0 000035   000041 600000 0                  TZE     s:1559

      410     1555    3                 DO;

      411     1556    3                 ERCOD=ER_NOWSY;

   1556  0 000036   000001 235007                    LDA     1,DL
         0 000037   200004 755100                    STA     ERCOD,,AUTO

      412     1557    3                 GOTO ERRMSG;
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:69   

   1557  0 000040   000310 710000 0                  TRA     ERRMSG

      413     1558    3                 END;
      414     1559    2               RAT$=DCT$->DCT.RAT$;

   1559  0 000041   300005 236100                    LDQ     5,,PR3
         0 000042   200007 756100                    STQ     RAT$,,AUTO

      415     1560    2               IF RAT$=ADDR(NIL) THEN GOTO NOSYM;

   1560  0 000043   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000044   000051 600000 0                  TZE     NOSYM

      416     1561    2               IF NOT RAT.FLG.SYMBIONT THEN

   1561  0 000045   200007 474500                    LDP4    RAT$,,AUTO
         0 000046   400010 236100                    LDQ     8,,PR4
         0 000047   000001 316007                    CANQ    1,DL
         0 000050   000054 601000 0                  TNZ     s:1567

      417     1562    3                 DO;

   1556  0 000051                       NOSYM        null
      418     1563    3   NOSYM:        ;
      419     1564    3                 ERCOD=ER_CNTSY;

   1564  0 000051   000002 235007                    LDA     2,DL
         0 000052   200004 755100                    STA     ERCOD,,AUTO

      420     1565    3                 GOTO ERRMSG;

   1565  0 000053   000310 710000 0                  TRA     ERRMSG

      421     1566    3                 END;
      422     1567    2               IF RAT.RES.SISID~=0 THEN

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:70   
   1567  0 000054   400001 222100                    LDX2    1,,PR4
         0 000055   000061 600000 0                  TZE     s:1573

      423     1568    3                 DO;

   1565  0 000056                       INUSE        null
      424     1569    3   INUSE:        ;
      425     1570    3                 ERCOD=ER_USED;

   1570  0 000056   000003 235007                    LDA     3,DL
         0 000057   200004 755100                    STA     ERCOD,,AUTO

      426     1571    3                 GOTO ERRMSG;

   1571  0 000060   000310 710000 0                  TRA     ERRMSG

      427     1572    3                 END;
      428     1573    2               DCT$->DCT.DFLG.SYMBIONT='1'B;

   1573  0 000061   020000 236007                    LDQ     8192,DL
         0 000062   300006 256100                    ORSQ    6,,PR3

      429     1574    2               RAT.RES.RFLG.NOSLD='1'B;

   1574  0 000063   010000 236003                    LDQ     4096,DU
         0 000064   400003 256100                    ORSQ    3,,PR4

      430     1575    2               RAT.RES.SISID=1;

   1575  0 000065   000001 220003                    LDX0    1,DU
         0 000066   400001 740100                    STX0    1,,PR4

      431     1576    2               IF DCT$->DCT.STATUS.DOWN='0'B THEN

   1576  0 000067   300027 234100                    SZN     23,,PR3
         0 000070   000114 604000 0                  TMI     s:1583

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:71   
      432     1577    3                 DO;

      433     1578    3                 RCD=RAT.RCOD;

   1578  0 000071   400003 236100                    LDQ     3,,PR4
         0 000072   000027 772000                    QRL     23
         0 000073   000017 376007                    ANQ     15,DL
         0 000074   200004 756100                    STQ     ERCOD,,AUTO

      434     1579    3                 FR_PRM$(0)->FR$PR(RCD)=FR_PRM$(0)->FR$PR(RCD)-1;

   1579  0 000075   000000 475400 xsym               LDP5    FR_PRM$
         0 000076   200004 721100                    LXL1    ERCOD,,AUTO
         0 000077   500000 235106                    LDA     0,QL,PR5
         0 000100   000001 135007                    SBLA    1,DL
         0 000101   500000 755111                    STA     0,X1,PR5

      435     1580    3                 CALL NKP$CHLST (DCT$->DCT,NK_NOCG);

   1580  0 000102   000000 236000 1                  LDQ     0
         0 000103   200011 235100                    LDA     DCT$,,AUTO
         0 000104   200012 757100                    STAQ    DCT$+1,,AUTO
         0 000105   200012 630500                    EPPR0   DCT$+1,,AUTO
         0 000106   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000107   000000 701000 xent               TSX1    NKP$CHLST
         0 000110   000000 011000                    NOP     0

      436     1581    3                 ERCOD=ER_SYOK;

   1581  0 000111   000004 235007                    LDA     4,DL
         0 000112   200004 755100                    STA     ERCOD,,AUTO

      437     1582    3                 END;

   1582  0 000113   000267 710000 0                  TRA     s:1627

      438     1583    2               ELSE ERCOD=ER_SYOKP;
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:72   

   1583  0 000114   000005 235007                    LDA     5,DL
         0 000115   200004 755100                    STA     ERCOD,,AUTO
         0 000116   000267 710000 0                  TRA     s:1627

      439     1584    2             CASE (KEY_MAKRES#);

      440     1585    2               IF DCT$->DCT.DFLG.SYMBIONT='0'B THEN

   1585  0 000117   200011 473500                    LDP3    DCT$,,AUTO
         0 000120   300006 236100                    LDQ     6,,PR3
         0 000121   020000 316007                    CANQ    8192,DL
         0 000122   000126 601000 0                  TNZ     s:1591

      441     1586    3                 DO;

   1583  0 000123                       NTSYM        null
      442     1587    3   NTSYM:        ;
      443     1588    3                 ERCOD=ER_NTSYM;

   1588  0 000123   000006 235007                    LDA     6,DL
         0 000124   200004 755100                    STA     ERCOD,,AUTO

      444     1589    3                 GOTO ERRMSG;

   1589  0 000125   000310 710000 0                  TRA     ERRMSG

      445     1590    3                 END;
      446     1591    2               RAT$=DCT$->DCT.RAT$;

   1591  0 000126   300005 236100                    LDQ     5,,PR3
         0 000127   200007 756100                    STQ     RAT$,,AUTO

      447     1592    2               IF DCT$->DCT.STATUS.DOWN THEN

   1592  0 000130   300027 234100                    SZN     23,,PR3
         0 000131   000144 605000 0                  TPL     s:1601
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:73   

      448     1593    3                 DO;

      449     1594    3                 RAT.RES.RFLG.NOSLD='0'B;

   1594  0 000132   200007 474500                    LDP4    RAT$,,AUTO
         0 000133   000001 236000 1                  LDQ     1
         0 000134   400003 356100                    ANSQ    3,,PR4

      450     1595    3                 RAT.RES.SISID=0;

   1595  0 000135   000000 220003                    LDX0    0,DU
         0 000136   400001 740100                    STX0    1,,PR4

      451     1596    3                 DCT$->DCT.DFLG.SYMBIONT='0'B;

   1596  0 000137   000002 236000 1                  LDQ     2
         0 000140   300006 356100                    ANSQ    6,,PR3

      452     1597    3                 ERCOD=ER_RSOKP;

   1597  0 000141   000010 235007                    LDA     8,DL
         0 000142   200004 755100                    STA     ERCOD,,AUTO

      453     1598    3                 END;

   1598  0 000143   000267 710000 0                  TRA     s:1627

      454     1599    2               ELSE
      455     1600    3                 DO;

      456     1601    3                 IF DCT$->DCT.DFLG.INPUT THEN

   1601  0 000144   300006 236100                    LDQ     6,,PR3
         0 000145   400000 316007                    CANQ    -131072,DL
         0 000146   000206 600000 0                  TZE     s:1610

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:74   
      457     1602    4                   DO;

      458     1603    4                   RCD=8;

   1603  0 000147   000010 235007                    LDA     8,DL
         0 000150   200004 755100                    STA     ERCOD,,AUTO

      459     1604    4                  CALL KCO$FINDSTA (LDCT$,KC_ISID,DCT$->DCT.DEVNM,RCD) ALTRET (NTSYM);

   1604  0 000151   200004 634500                    EPPR4   ERCOD,,AUTO
         0 000152   200015 454500                    STP4    DCT$+4,,AUTO
         0 000153   200011 236100                    LDQ     DCT$,,AUTO
         0 000154   000002 036003                    ADLQ    2,DU
         0 000155   200014 756100                    STQ     DCT$+3,,AUTO
         0 000156   000003 236000 1                  LDQ     3
         0 000157   200013 756100                    STQ     DCT$+2,,AUTO
         0 000160   200006 635500                    EPPR5   LDCT$,,AUTO
         0 000161   200012 455500                    STP5    DCT$+1,,AUTO
         0 000162   200012 630500                    EPPR0   DCT$+1,,AUTO
         0 000163   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000164   000000 701000 xent               TSX1    KCO$FINDSTA
         0 000165   000123 702000 0                  TSX2    NTSYM

      460     1605    4                   IF LDCT$->LDCT.LKFLG.ACTIVE THEN GOTO INUSE;

   1605  0 000166   200006 470500                    LDP0    LDCT$,,AUTO
         0 000167   000011 236100                    LDQ     9,,PR0
         0 000170   000040 316003                    CANQ    32,DU
         0 000171   000056 601000 0                  TNZ     INUSE

      461     1606    4                   CALL NIO$SPINTCON (DCT$->DCT.DCTX,ENTADDR(NIL),LDCT$);

   1606  0 000172   200006 631500                    EPPR1   LDCT$,,AUTO
         0 000173   200014 451500                    STP1    DCT$+3,,AUTO
         0 000174   000004 236000 1                  LDQ     4
         0 000175   200013 756100                    STQ     DCT$+2,,AUTO
         0 000176   200011 236100                    LDQ     DCT$,,AUTO
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:75   
         0 000177   000006 036003                    ADLQ    6,DU
         0 000200   200012 756100                    STQ     DCT$+1,,AUTO
         0 000201   200012 630500                    EPPR0   DCT$+1,,AUTO
         0 000202   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000203   000000 701000 xent               TSX1    NIO$SPINTCON
         0 000204   000000 011000                    NOP     0

      462     1607    4                   END;

   1607  0 000205   000231 710000 0                  TRA     s:1614

      463     1608    3                 ELSE
      464     1609    4                   DO;

      465     1610    4                   RCD=8;

   1610  0 000206   000010 235007                    LDA     8,DL
         0 000207   200004 755100                    STA     ERCOD,,AUTO

      466     1611    4                  CALL KCO$FINDSTA (LDCT$,KC_OSID,DCT$->DCT.DEVNM,RCD) ALTRET (NTSYM);

   1611  0 000210   200004 634500                    EPPR4   ERCOD,,AUTO
         0 000211   200015 454500                    STP4    DCT$+4,,AUTO
         0 000212   200011 236100                    LDQ     DCT$,,AUTO
         0 000213   000002 036003                    ADLQ    2,DU
         0 000214   200014 756100                    STQ     DCT$+3,,AUTO
         0 000215   000005 236000 1                  LDQ     5
         0 000216   200013 756100                    STQ     DCT$+2,,AUTO
         0 000217   200006 635500                    EPPR5   LDCT$,,AUTO
         0 000220   200012 455500                    STP5    DCT$+1,,AUTO
         0 000221   200012 630500                    EPPR0   DCT$+1,,AUTO
         0 000222   000022 631400 xsym               EPPR1   B_VECTNIL+18
         0 000223   000000 701000 xent               TSX1    KCO$FINDSTA
         0 000224   000123 702000 0                  TSX2    NTSYM

      467     1612    4                   IF LDCT$->LDCT.DFLG.SYMBIONT THEN GOTO INUSE;

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:76   
   1612  0 000225   200006 470500                    LDP0    LDCT$,,AUTO
         0 000226   000006 236100                    LDQ     6,,PR0
         0 000227   020000 316007                    CANQ    8192,DL
         0 000230   000056 601000 0                  TNZ     INUSE

      468     1613    4                   END;

      469     1614    3                 CALL KCD$DSCTRM (LDCT$->LDCT);

   1614  0 000231   200006 630500                    EPPR0   LDCT$,,AUTO
         0 000232   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000233   000000 701000 xent               TSX1    KCD$DSCTRM
         0 000234   000000 011000                    NOP     0

      470     1615    3                 DCT$->DCT.DFLG.SYMBIONT='0'B;

   1615  0 000235   200011 470500                    LDP0    DCT$,,AUTO
         0 000236   000002 236000 1                  LDQ     2
         0 000237   000006 356100                    ANSQ    6,,PR0

      471     1616    3                 RAT.RES.RFLG.NOSLD='0'B;

   1616  0 000240   200007 471500                    LDP1    RAT$,,AUTO
         0 000241   000001 236000 1                  LDQ     1
         0 000242   100003 356100                    ANSQ    3,,PR1

      472     1617    3                 RAT.RES.SISID=0;

   1617  0 000243   000000 220003                    LDX0    0,DU
         0 000244   100001 740100                    STX0    1,,PR1

      473     1618    3                 DCT$->DCT.DFLG.CM='0'B;

   1618  0 000245   000006 236000 1                  LDQ     6
         0 000246   000006 356100                    ANSQ    6,,PR0

      474     1619    3                 RAT$=DCT$->DCT.RAT$;
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:77   

   1619  0 000247   000005 236100                    LDQ     5,,PR0
         0 000250   200007 756100                    STQ     RAT$,,AUTO

      475     1620    3                 RCD=RAT.RCOD;

   1620  0 000251   200007 471500                    LDP1    RAT$,,AUTO
         0 000252   100003 236100                    LDQ     3,,PR1
         0 000253   000027 772000                    QRL     23
         0 000254   000017 376007                    ANQ     15,DL
         0 000255   200004 756100                    STQ     ERCOD,,AUTO

      476     1621    3                 FR_PRM$(0)->FR$PR(RCD)=FR_PRM$(0)->FR$PR(RCD)+1;

   1621  0 000256   000000 473400 xsym               LDP3    FR_PRM$
         0 000257   200004 721100                    LXL1    ERCOD,,AUTO
         0 000260   300000 235106                    LDA     0,QL,PR3
         0 000261   000001 035007                    ADLA    1,DL
         0 000262   300000 755111                    STA     0,X1,PR3

      477     1622    3                 ERCOD=ER_RSOK;

   1622  0 000263   000007 235007                    LDA     7,DL
         0 000264   200004 755100                    STA     ERCOD,,AUTO

      478     1623    3                 END;

   1623  0 000265   000267 710000 0                  TRA     s:1627

      479     1624    2             CASE (ELSE);

      480     1625    2               ALTRETURN;

   1625  0 000266   000000 702200 xent               TSX2  ! X66_AALT

      481     1626    2           END;

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:78   
      482     1627    1         CADDR=M_UR;

   1627  0 000267   100000 236003                    LDQ     32768,DU
         0 000270   200010 756100                    STQ     CADDR,,AUTO

   1627  0 000271                       WRTOP        null
      483     1628    1   WRTOP:;
      484     1629    1         CALL OCI$MK_WR (CADDR,SYRS_MSG#,1,'004'O,ERCOD,DCTX);

   1629  0 000271   200005 630500                    EPPR0   DCTX,,AUTO
         0 000272   200017 450500                    STP0    DCT$+6,,AUTO
         0 000273   200004 631500                    EPPR1   ERCOD,,AUTO
         0 000274   200016 451500                    STP1    DCT$+5,,AUTO
         0 000275   000012 237000 1                  LDAQ    10
         0 000276   200014 757100                    STAQ    DCT$+3,,AUTO
         0 000277   000011 236000 1                  LDQ     9
         0 000300   200013 756100                    STQ     DCT$+2,,AUTO
         0 000301   200010 633500                    EPPR3   CADDR,,AUTO
         0 000302   200012 453500                    STP3    DCT$+1,,AUTO
         0 000303   200012 630500                    EPPR0   DCT$+1,,AUTO
         0 000304   000024 631400 xsym               EPPR1   B_VECTNIL+20
         0 000305   000000 701000 xent               TSX1    OCI$MK_WR
         0 000306   000000 011000                    NOP     0

   1627  0 000307                       RTN          null
      485     1630    1   RTN:  ;
      486     1631    1         RETURN;

   1631  0 000307   000000 702200 xent               TSX2  ! X66_ARET

   1627  0 000310                       ERRMSG       null
      487     1632    1   ERRMSG:;
      488     1633    1         CADDR=KMSG.CADDR;

   1633  0 000310   200003 470500                    LDP0    @KMSG,,AUTO
         0 000311   000000 236100                    LDQ     0,,PR0
         0 000312   000022 736000                    QLS     18
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:79   
         0 000313   200010 756100                    STQ     CADDR,,AUTO

      489     1634    1         GOTO WRTOP;

   1634  0 000314   000271 710000 0                  TRA     WRTOP

(unnamed)
 Sect OctLoc
   1     000   000010 006000   767777 777777   777777 757777   000000 006000    ................
   1     004   000002 006000   000000 006000   777777 677777   000000 000424    ................
   1     010   004000 000000   000007 006000   000003 006000   000010 006000    ................
      490     1635        /**/
      491     1636    1   END;
      492     1637        /**/
      493     1638        /**/

PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:80   
--  Include file information  --

   FR_SUBS.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   FR$RAT.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
      No diagnostics issued in procedure NKP$KEYIN.
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:81   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @KMSG                     10-0-0/w BIT         r     1 CADDR
    11-0-0/w PTR         r     1 DCT$                       5-0-0/w UBIN        r     1 DCTX
     4-0-0/w UBIN        r     1 ERCOD                     *0-0-0/w STRC(108)   r     1 KMSG
     6-0-0/w PTR         r     1 LDCT$                      7-0-0/w PTR         r     1 RAT$
     4-0-0/w UBIN        r     1 RCD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 FR_PRM$(0:0)
     0-0-0/w STRC(432)   r     1 KC_ISID                    0-0-0/w STRC(432)   r     1 KC_OSID
     0-0-0/w PTR         r     1 N$DCT$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1332)  r     1 DCT                        0-0-0/w SBIN        r     1 FR$PR(0:0)
     0-0-0/d STRC(864)   r     1 NK$LDCT
     0-0-0/w PTR         r     1 NK$LDCT$(0:0)
     0-0-0/w STRC(324)   r     1 RAT


   Procedure NKP$KEYIN requires 205 words for executable code.
   Procedure NKP$KEYIN requires 16 words of local(AUTO) storage.
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:82   

    No errors detected in file NKP$PARTRTN.:E05TSI    .
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:84   
          MINI XREF LISTING

CADDR
      1397**DCL      1627<<ASSIGN   1629<>CALL     1633<<ASSIGN
DCT
      1261**DCL      1580<>CALL
DCT.DCTX
      1262**DCL      1606<>CALL
DCT.DEVNM
      1261**DCL      1604<>CALL     1611<>CALL
DCT.DFLG.CM
      1264**DCL      1618<<ASSIGN
DCT.DFLG.INPUT
      1263**DCL      1601>>IF
DCT.DFLG.SYMBIONT
      1265**DCL      1554>>IF       1573<<ASSIGN   1585>>IF       1596<<ASSIGN   1615<<ASSIGN
DCT.DP
      1281**DCL      1288--REDEF    1291--REDEF    1292--REDEF    1294--REDEF    1294--REDEF    1295--REDEF
      1296--REDEF    1296--REDEF
DCT.MPC.IOCHANX
      1289**DCL      1289--REDEF
DCT.RAT$
      1262**DCL      1559>>ASSIGN   1591>>ASSIGN   1619>>ASSIGN
DCT.STATUS.DOWN
      1278**DCL      1576>>IF       1592>>IF
DCT$
      1398**DCL      1551<<ASSIGN   1554>>IF       1559>>ASSIGN   1573>>ASSIGN   1576>>IF       1580>>CALL
      1585>>IF       1591>>ASSIGN   1592>>IF       1596>>ASSIGN   1601>>IF       1604>>CALL     1606>>CALL
      1611>>CALL     1615>>ASSIGN   1618>>ASSIGN   1619>>ASSIGN
DCTX
      1394**DCL      1550<>CALL     1551>>ASSIGN   1629<>CALL
ERCOD
      1392**DCL      1393--REDEF    1556<<ASSIGN   1564<<ASSIGN   1570<<ASSIGN   1581<<ASSIGN   1583<<ASSIGN
      1588<<ASSIGN   1597<<ASSIGN   1622<<ASSIGN   1629<>CALL
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:85   
ERRMSG
      1627**LABEL    1557--GOTO     1565--GOTO     1571--GOTO     1589--GOTO
FR$PR
       460**DCL      1579<<ASSIGN   1579>>ASSIGN   1621<<ASSIGN   1621>>ASSIGN
FR_PRM$
       461**DCL      1579>>ASSIGN   1579>>ASSIGN   1621>>ASSIGN   1621>>ASSIGN
INUSE
      1565**LABEL    1605--GOTO     1612--GOTO
KCD$DSCTRM
      1405**DCL-ENT  1614--CALL
KCO$FINDSTA
      1406**DCL-ENT  1604--CALL     1611--CALL
KC_ISID
      1427**DCL      1604<>CALL
KC_OSID
      1453**DCL      1611<>CALL
KMSG
      1239**DCL        10--PROC
KMSG.CADDR
      1241**DCL      1550<>CALL     1633>>ASSIGN
KMSG.DEV
      1242**DCL      1243--REDEF    1550<>CALL
KMSG.KIN#
      1240**DCL      1552>>DOCASE
LDCT$
      1395**DCL      1604<>CALL     1605>>IF       1606<>CALL     1611<>CALL     1612>>IF       1614>>CALL
N$DCT$$
       443**DCL       443--IMP-PTR  1551>>ASSIGN
NIO$SPINTCON
      1407**DCL-ENT  1606--CALL
NK$LDCT
      1313**DCL      1614<>CALL
NK$LDCT.DDT$
      1315**DCL      1315--REDEF
NK$LDCT.DFLG.SYMBIONT
      1318**DCL      1612>>IF
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:86   
NK$LDCT.IOQ$
      1314**DCL      1315--REDEF
NK$LDCT.LDCTX
      1316**DCL      1316--REDEF
NK$LDCT.LKFLG.ABORTED
      1328**DCL      1329--REDEF
NK$LDCT.LKFLG.ACTIVE
      1332**DCL      1605>>IF
NK$LDCT.RLCID.LDCTX
      1338**DCL      1338--REDEF
NK$LDCT.STA$
      1334**DCL      1335--REDEF
NK$LDCT.SYMB$
      1313**DCL      1313--REDEF    1313--REDEF    1314--REDEF
NK$LDCT$
       443**DCL      1551>>ASSIGN
NKP$CHLST
      1408**DCL-ENT  1580--CALL
NOSYM
      1556**LABEL    1560--GOTO
NTSYM
      1583**LABEL    1604--CALLALT  1611--CALLALT
OCI$MK_WR
      1409**DCL-ENT  1629--CALL
OCZ$DEV_DCT
      1410**DCL-ENT  1550--CALL
RAT.FLG.SYMBIONT
      1384**DCL      1561>>IF
RAT.RCOD
      1361**DCL      1578>>ASSIGN   1620>>ASSIGN
RAT.RES.RFLG.NOSLD
      1358**DCL      1574<<ASSIGN   1594<<ASSIGN   1616<<ASSIGN
RAT.RES.SISID
      1351**DCL      1567>>IF       1575<<ASSIGN   1595<<ASSIGN   1617<<ASSIGN
RAT$
      1396**DCL      1348--IMP-PTR  1559<<ASSIGN   1560>>IF       1561>>IF       1567>>IF       1574>>ASSIGN
PL6.E3A0      #003=NKP$KEYIN File=NKP$PARTRTN.:E05TSI                            WED 07/30/97 03:46 Page:87   
      1575>>ASSIGN   1578>>ASSIGN   1591<<ASSIGN   1594>>ASSIGN   1595>>ASSIGN   1616>>ASSIGN   1617>>ASSIGN
      1619<<ASSIGN   1620>>ASSIGN
RCD
      1393**DCL      1578<<ASSIGN   1579>>ASSIGN   1579>>ASSIGN   1603<<ASSIGN   1604<>CALL     1610<<ASSIGN
      1611<>CALL     1620<<ASSIGN   1621>>ASSIGN   1621>>ASSIGN
RTN
      1627**LABEL    1550--CALLALT
WRTOP
      1627**LABEL    1634--GOTO
