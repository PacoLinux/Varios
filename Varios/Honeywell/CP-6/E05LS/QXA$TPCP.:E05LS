VERSION E05

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:1    
        1        1        /*M* QXA$TPCP - TPCP major processing routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QXA$TPCP:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44
       14       45        %PAGE(ARG="Includes");

                62        /***************************************************************************
                63         *                                                                         *
                64         *                                  Includes                               *
                65         *                                                                         *
                66         ***************************************************************************/

       15       70        %INCLUDE QQ_MACROS_C;
       16      495        %INCLUDE QT_SUBS_C;
       17      579        %INCLUDE QX_MACROS_C;
       18      714        %INCLUDE QX_DATA_R;
       19      724        %INCLUDE QX_PERR_C;
       20      734        %INCLUDE Q_ERRCODE_C;
       21      757        %INCLUDE QT_MACROS_C;
       22      915        %INCLUDE Q_SCODE_C;
       23      926        %INCLUDE CP_6;
       24     1007        %INCLUDE AS_SUPER_C;
       25     1442        %INCLUDE OC_SUBS_C;
       26     2173        %INCLUDE CP_6_SUBS;
       27     2713        %INCLUDE B_ERRORS_C;
       28     3840        %INCLUDE B$JIT;
       29     4130        %INCLUDE FM$FIT;
       30     4351        %INCLUDE AZ_SUBS_C;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:2    
       31     4420        %INCLUDE AZ_MACRO_C;
       32     7007        %INCLUDE JS$CP6V_C;
       33     7070        %INCLUDE CXG_ENTRY;
       34     7082        %INCLUDE XU_MACRO_C;
       35    10188        %INCLUDE CX_SUBS_C;
       36    10201        %INCLUDE CX_MACROS_M;
       37    10252        %PAGE(ARG="Externally defined routines");

             10269    1   /***************************************************************************
             10270    1    *                                                                         *
             10271    1    *                        Externally defined routines                      *
             10272    1    *                                                                         *
             10273    1    ***************************************************************************/

       38    10277    1   DCL AZA$LOGOFF ENTRY(1) ALTRET;
       39    10278    1   DCL QXA$XCON ENTRY ASYNC;
       40    10279    1   DCL QXC$SCREECH ENTRY(3);
       41    10280    1   DCL QXC$BLDMSG ENTRY(1);
       42    10281    1   DCL QXC$BLDMSG_ERRBLK ENTRY(1);
       43    10282    1   DCL QXA$INIT ENTRY;
       44    10283    1   DCL X$PRE_PROCESS ENTRY(1) ALTRET;
       45    10284    1   DCL CXC$COMMAND ENTRY(2) ALTRET;
       46    10285        %PAGE(ARG="Symrefs");

             10302    1   /***************************************************************************
             10303    1    *                                                                         *
             10304    1    *                                  Symrefs                                *
             10305    1    *                                                                         *
             10306    1    ***************************************************************************/

       47    10310    1   DCL B$JIT$ PTR SYMREF;
       48    10311    1   DCL B$TCB$ PTR SYMREF;
       49    10312    1   DCL B$PS0$ PTR SYMREF READONLY;         /* pointer to PARAMETER STACK         */
       50    10313    1   DCL B$PS1$ PTR SYMREF READONLY;         /* pointer to PARAMETER STACK         */
       51    10314        %PAGE(ARG="Based");

             10331    1   /***************************************************************************
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:3    
             10332    1    *                                                                         *
             10333    1    *                                   Based                                 *
             10334    1    *                                                                         *
             10335    1    ***************************************************************************/

       52    10339        %F$DCB;
       53    10396        %QT$ENTRY(STCLASS="BASED(QX_GLOBAL.QT$ENTRY$)");
       54    10450        %AS_USERS(STR_NAME=AS$USERS, STCLASS="BASED(QX_GLOBAL.QT$ENTRY$)");
       55    10628        %QT$SETBITS;
       56    10649        %B$TCB;
       57    10652        %B$ALT;
       58    10660        %FPT$YC_V(FPTN=FPTV$YC);
       59    10663
       60    10664    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       61    10665
       62    10666    1   DCL BASED$WORD BIT(36) UNAL BASED;
       63    10667
       64    10668    1   DCL BUFFER_MSG1  CHAR(124) DALIGNED BASED (GLOBAL_PTRS.BUFFER$);
       65    10669
       66    10670        %FPT_OPEN(FPTN=AMR$FPT_OPEN, STCLASS="BASED(AMR$FPT_OPEN$)",
       67    10671        PFMT=PTR, VECTOR=ADDR);
       68    10780        %PAGE(ARG="Constants");

             10797    1   /***************************************************************************
             10798    1    *                                                                         *
             10799    1    *                                 Constants                               *
             10800    1    *                                                                         *
             10801    1    ***************************************************************************/

       69    10805        %HDR_FLAGS(FPTN=HDR_FLAGS_UNDEF_XACT, STCLASS=CONSTANT, TYPE=YES,
       70    10806        ID=YES, SOA=YES, TIME=YES, MSG=UNDEF_XACT,
       71    10807        LVL=1, LAST=";");
       72    10842
       73    10843        %HDR_FLAGS(FPTN=HDR_FLAGS_TPAP_ABORT, STCLASS=CONSTANT, TYPE=YES,
       74    10844        ID=YES, SOA=YES, TIME=YES, MSG=TPAP_ABORT, USRERR=YES, USRDCB=YES,
       75    10845        USRIC=YES,
       76    10846        LVL=1, LAST=";");
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:4    
       77    10881
       78    10882        %HDR_FLAGS(FPTN=HDR_FLAGS_YCPMME_ABORT, STCLASS=CONSTANT, TYPE=YES,
       79    10883        ID=YES, SOA=YES, TIME=YES, MSG=YCPMME_ABORT,
       80    10884        USRIC=YES,
       81    10885        LVL=1, LAST=";");
       82    10920
       83    10921        %VLP_SETSTA(FPTN=VLP_SETSTA_UNLOCKED, STCLASS=CONSTANT, WAS=YES);
       84    10949
       85    10950        %VLP_SETSTA(FPTN=VLP_SETSTA_LOCKED, STCLASS=CONSTANT, ILOCK=YES,
       86    10951        ILATCH=YES, OLOCK=YES, OLATCH=YES, EOFNONE=YES, WAS=YES);
       87    10979        %VLP_STATION(STCLASS=CONSTANT, LATCH=YES);
       88    11006
       89    11007        %XUG_INIT(WSEG=7,PREPROCESS=YES,PREPROCESSOR=X$PRE_PROCESS,
       90    11008        PP_PROCNAME=IBEX_NAME,PROCNAME=IBEX_NAME,PROCACCT=COLONSYS,
       91    11009        CMDSZ=256,ECHO=NEVER_ECHO,SYNTAX=NO,COMMANDS=NO,
       92    11010        ADAPT=NIL,
       93    11011        STCLASS=CONSTANT);
       94    11424
       95    11425        %VLP_NAME(FPTN=IBEX_NAME, NAME='IBEX', STCLASS=CONSTANT);
       96    11452        %VLP_ACCT(FPTN=COLONSYS, ACCT=':SYS', STCLASS=CONSTANT);
       97    11465
       98    11466        %FPT_RELDCB(FPTN=FPT_RELDCB_CPSL, STCLASS=CONSTANT);
       99    11480        %FPT_GETDCB(FPTN=FPT_GETDCB_CPSL, STCLASS=CONSTANT);
      100    11495        %PAGE(ARG="Auto");

             11512    1   /***************************************************************************
             11513    1    *                                                                         *
             11514    1    *                                    Auto                                 *
             11515    1    *                                                                         *
             11516    1    ***************************************************************************/

      101    11520
      102    11521    1   DCL CHAR_STRING_SIZE UBIN WORD;
      103    11522    1   DCL I UBIN WORD;
      104    11523    1   DCL BLANK_POS UBIN WORD;
      105    11524    1   DCL SPACE_NEEDED UBIN WORD;
      106    11525    1   DCL CHAR_STRING CHAR(8) ALIGNED;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:5    
      107    11526
      108    11527        %GLOBAL_PTRS;
      109    11620    1   DCL M$UC$ PTR;
      110    11621    1   DCL M$TPCP$ PTR;
      111    11622    1   DCL SETSTA$ PTR;
      112    11623    1   DCL REC$ PTR;
      113    11624    1   DCL AMR$FPT_OPEN$ PTR;
      114    11625
      115    11626    1   DCL 1 PTR$_BITS,
      116    11627    1         2 WORDS UBIN(18) UNAL,
      117    11628    1         2 * UBIN(18) UNAL;
      118    11629
      119    11630        %LOGOFF$PARAM(NAME=LOGOFF_PARAM, STCLASS=AUTO);
      120    11671        %MSGBLK;
      121    11761    1   DCL 1 ERR,
      122    11762    1         2 FCG BIT(12) UNAL,
      123    11763    1         2 MID BIT(6) UNAL,
      124    11764    1         2 MON BIT(1) UNAL,
      125    11765    1         2 CODE UBIN(14) UNAL,
      126    11766    1         2 SEV UBIN(3) UNAL;
      127    11767        %CPSL_COMMAND_PARAMETERS;
      128    11785
      129    11786
      130    11787        %XUG_INIT(NAME=XUG$INIT, STCLASS=AUTO);
      131    12200
      132    12201        %FPT_RELDCB(FPTN=FPT$RELDCB_CPSL, STCLASS=AUTO);
      133    12215        %FPT_GETDCB(FPTN=FPT$GETDCB_CPSL, STCLASS=AUTO);
      134    12230        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:6    
             12247    1   /***************************************************************************
             12248    1    *                                                                         *
             12249    1    *                                Error codes                              *
             12250    1    *                                                                         *
             12251    1    ***************************************************************************/

      135    12255        %ERRCODE(NAME=CODE_INVALID_CMD, CODE#=%E$INVALID_CMD, FCG#=%FCG_QX, MID#=%MID_A);
      136    12262        %ERRCODE(NAME=CODE_MISSING_REC, CODE#=%E$MISSING_REC, FCG#=%FCG_QX, MID#=%MID_A);
      137    12269        %ERRCODE(NAME=CODE_NO_CP_CMD, CODE#=%E$NO_CP_CMD, FCG#=%FCG_QX, MID#=%MID_A);
      138    12276
      139    12277        /*E* ERROR:       QXA-E$INVALID_CMD-C
      140    12278
      141    12279             MESSAGE:     Commands may not be passed to TPCP via the
      142    12280                          M$YC monitor service.
      143    12281             DESCRIPTION: TPCP checks the contents of the command buffer
      144    12282                          against a list a valid commands.  The command
      145    12283                          that was passed down was invalid.
      146    12284        */
      147    12285        /*E* ERROR:       QXA-E$MISSING_REC-C
      148    12286
      149    12287             MESSAGE:     A transaction in the comgroup could not be
      150    12288                          processed because it was not defined in the
      151    12289                          TRADER file.  The transaction has been held.
      152    12290             DESCRIPTION: All transactions that are to be processed must
      153    12291                          be defined in the TRADER file.  No record
      154    12292                          defining this transaction could be found.
      155    12293        */
      156    12294        /*E* ERROR:       QXA-E$NO_CP_CMD-C
      157    12295
      158    12296             MESSAGE:     The CP_CMD option on the M$LINK and M$LDTRC pmme
      159    12297                          cannot be processed by TPCP.
      160    12298             DESCRIPTION: TPCP is not set up at this time to handle parsing
      161    12299                          of the command line.  An altreturn will be taken.
      162    12300        */
      163    12301        %PAGE(ARG="Screech codes",PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:7    
             12318    1   /***************************************************************************
             12319    1    *                                                                         *
             12320    1    *                               Screech codes                             *
             12321    1    *                                                                         *
             12322    1    ***************************************************************************/

      164    12326        /*S* SCREECH_CODE: QXA-S$MON_ALT
      165    12327
      166    12328             TYPE:        SNAP
      167    12329
      168    12330             MESSAGE:     An unexpected monitor ALTRET was received by
      169    12331                          TPCP.
      170    12332             REMARKS:     Any unexpected monitor ALTRET received by TPCP
      171    12333                          will cause a SNAP screech.
      172    12334        */
      173    12335        %PAGE(ARG="G L O B A L   D A T A", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:8    
             12352    1   /***************************************************************************
             12353    1    *                                                                         *
             12354    1    *                           G L O B A L   D A T A                         *
             12355    1    *                                                                         *
             12356    1    ***************************************************************************/

      174    12360        %GLOBAL_PTRS(FPTN=GLOBAL$PTRS, STCLASS="BASED(QX_GLOBAL.GLOBAL$PTRS$)");
      175    12453        %PAGE(ARG="FPTs");

             12470    1   /***************************************************************************
             12471    1    *                                                                         *
             12472    1    *                                    FPTs                                 *
             12473    1    *                                                                         *
             12474    1    ***************************************************************************/

      176    12478        %FPT_READ(FPTN=FPT$READ_KEY,
      177    12479        STCLASS="BASED(GLOBAL_PTRS.FPT$READ_KEY$)");
      178    12518
      179    12519        %FPT_WRITE(FPTN=FPT$WRITE_KEY,
      180    12520        STCLASS="BASED(GLOBAL_PTRS.FPT$WRITE_KEY$)");
      181    12551
      182    12552        %FPT_GETDCB(FPTN=FPT$GETDCB,
      183    12553        STCLASS="BASED(GLOBAL_PTRS.FPT$GETDCB$)");
      184    12568
      185    12569        %FPT_RELDCB(FPTN=FPT$RELDCB,
      186    12570        STCLASS="BASED(GLOBAL_PTRS.FPT$RELDCB$)");
      187    12584
      188    12585        %FPT_CPEXIT(STCLASS=CONSTANT);
      189    12611        %FPT_CPEXIT(FPTN=FPT$CPEXIT,
      190    12612        STCLASS="BASED(GLOBAL_PTRS.FPT$CPEXIT$)");
      191    12638
      192    12639        %FPT_GDS(FPTN=FPT$GDS,
      193    12640        STCLASS="BASED(GLOBAL_PTRS.FPT$GDS$)");
      194    12656
      195    12657        %FPT_FID(FPTN=FPT$FID,
      196    12658        STCLASS="BASED(GLOBAL_PTRS.FPT$FID$)");
      197    12681
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:9    
      198    12682        %FPT_OPEN(FPTN=FPT$OPEN_FILE,
      199    12683        STCLASS="BASED(GLOBAL_PTRS.FPT$OPEN_FILE$)");
      200    12792
      201    12793        %FPT_DELREC(FPTN=FPT$DELREC,
      202    12794        STCLASS="BASED(GLOBAL_PTRS.FPT$DELREC$)");
      203    12813
      204    12814        %FPT_CLOSE(FPTN=FPT$CLOSE,
      205    12815        STCLASS="BASED(GLOBAL_PTRS.FPT$CLOSE$)");
      206    12857
      207    12858        %FPT_UNLATCH(FPTN=FPT$UNLATCH,
      208    12859        STCLASS="BASED(GLOBAL_PTRS.FPT$UNLATCH$)");
      209    12876
      210    12877        %FPT_READ(FPTN=FPT$READ_CG,
      211    12878        STCLASS="BASED(GLOBAL_PTRS.FPT$READ_CG$)");
      212    12917
      213    12918        %FPT_WRITE(FPTN=FPT$WRITE_CG,
      214    12919        STCLASS="BASED(GLOBAL_PTRS.FPT$WRITE_CG$)");
      215    12950
      216    12951        %FPT_OPEN(FPTN=FPT$OPEN_CG,
      217    12952        STCLASS="BASED(GLOBAL_PTRS.FPT$OPEN_CG$)");
      218    13061
      219    13062        %FPT_OCMSG(FPTN=FPT$OCMSG,
      220    13063        STCLASS="BASED(GLOBAL_PTRS.FPT$OCMSG$)");
      221    13079
      222    13080        %FPT_TIME(FPTN=FPT$TIME,
      223    13081        STCLASS="BASED(GLOBAL_PTRS.FPT$TIME$)");
      224    13100
      225    13101        %FPT_KEYIN(FPTN=FPT$KEYIN,
      226    13102        STCLASS="BASED(GLOBAL_PTRS.FPT$KEYIN$)");
      227    13121
      228    13122        %FPT_ERRMSG(FPTN=FPT$ERRMSG,
      229    13123        STCLASS="BASED(GLOBAL_PTRS.FPT$ERRMSG$)");
      230    13150
      231    13151        %XUG_GETCMD(NAME=XUG$GETCMD,
      232    13152        STCLASS="BASED(GLOBAL_PTRS.XUG$GETCMD$)");
      233    13490        %PAGE(ARG="VLPs");

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:10   
             13507    1   /***************************************************************************
             13508    1    *                                                                         *
             13509    1    *                                    VLPs                                 *
             13510    1    *                                                                         *
             13511    1    ***************************************************************************/

      234    13515        %VLP_NAME(FPTN=VLP$NAME,
      235    13516        STCLASS="BASED(GLOBAL_PTRS.VLP$NAME$) DALIGNED", LEN=31);
      236    13543
      237    13544        %VLP_ACCT(FPTN=VLP$ACCT,
      238    13545        STCLASS="BASED(GLOBAL_PTRS.VLP$ACCT$) DALIGNED");
      239    13558
      240    13559        %VLP_PASS(FPTN=VLP$PASS,
      241    13560        STCLASS="BASED(GLOBAL_PTRS.VLP$PASS$) DALIGNED");
      242    13573
      243    13574        %VLP_SN(FPTN=VLP$SN,
      244    13575        STCLASS="BASED(GLOBAL_PTRS.VLP$SN$)");
      245    13588
      246    13589        %VLP_WSN(FPTN=VLP$WSN,
      247    13590        STCLASS="BASED(GLOBAL_PTRS.VLP$WSN$) DALIGNED");
      248    13603
      249    13604        %VLP_NAME(FPTN=VLP$KEY,
      250    13605        STCLASS="BASED(GLOBAL_PTRS.VLP$KEY$) DALIGNED", LEN=31);
      251    13632
      252    13633    1   DCL VLP$DCBNUM UBIN WORD DALIGNED
      253    13634    1   BASED(GLOBAL_PTRS.VLP$DCBNUM$);
      254    13635
      255    13636        %VLP_NAME(FPTN=VLP$LKEY,
      256    13637        STCLASS="BASED(GLOBAL_PTRS.VLP$LKEY$) DALIGNED", LEN=1);
      257    13664
      258    13665        %VLP_NAME(FPTN=VLP$DEBUGGER,
      259    13666        STCLASS="BASED(GLOBAL_PTRS.VLP$DEBUGGER$) DALIGNED", LEN=15);
      260    13693
      261    13694        %VLP_NAME(FPTN=VLP$MSGTYP,
      262    13695        STCLASS="BASED(GLOBAL_PTRS.VLP$MSGTYP$) DALIGNED", LEN=8);
      263    13722
      264    13723        %VLP_NAME(FPTN=VLP$NAME_TRADER,
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:11   
      265    13724        STCLASS="BASED(GLOBAL_PTRS.VLP$NAME_TRADER$) DALIGNED", LEN=31);
      266    13751
      267    13752        %VLP_ACCT(FPTN=VLP$ACCT_TRADER,
      268    13753        STCLASS="BASED(GLOBAL_PTRS.VLP$ACCT_TRADER$) DALIGNED");
      269    13766
      270    13767        %FM$FIT(FM$FIT=VLP$IFPARAM_PASS_TRADER,
      271    13768        N=1,
      272    13769        BASED="BASED(GLOBAL_PTRS.VLP$IFPARAM_PASS_TRADER$)");
      273    13772
      274    13773        %CODE07(CODE07=VLP$CODE07_PASS_TRADER,
      275    13774        BASED="BASED(GLOBAL_PTRS.VLP$CODE07_PASS_TRADER$)");
      276    13777
      277    13778        %VLP_SN(FPTN=VLP$SN_TRADER,
      278    13779        STCLASS="BASED(GLOBAL_PTRS.VLP$SN_TRADER$)");
      279    13792
      280    13793        %VLP_VECTOR(FPTN=VLP$VECTOR,
      281    13794        STCLASS="BASED(GLOBAL_PTRS.VLP$VECTOR$)");
      282    13809
      283    13810        %VLP_NAME(FPTN=VLP$FID,
      284    13811        STCLASS="BASED(GLOBAL_PTRS.VLP$FID$) DALIGNED", LEN=99);
      285    13838
      286    13839        %VLP_STATION(FPTN=VLP$STATION,
      287    13840        STCLASS="BASED(GLOBAL_PTRS.VLP$STATION$)");
      288    13867
      289    13868        %VLP_SETSTA(FPTN=VLP$SETSTA,
      290    13869        STCLASS="BASED(GLOBAL_PTRS.VLP$SETSTA$)");
      291    13897
      292    13898        %VLP_VECTOR(FPTN=VLP$GDS,
      293    13899        STCLASS="BASED(GLOBAL_PTRS.VLP$GDS$)");
      294    13914
      295    13915    1   DCL VLP$ASN UBIN WORD DALIGNED BASED(GLOBAL_PTRS.VLP$ASN$);
      296    13916        %PAGE(ARG="VLRs");

             13933    1   /***************************************************************************
             13934    1    *                                                                         *
             13935    1    *                                    VLRs                                 *
             13936    1    *                                                                         *
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:12   
             13937    1    ***************************************************************************/

      297    13941
      298    13942    1   DCL VLP$TIME CHAR(11) DALIGNED
      299    13943    1   BASED(GLOBAL_PTRS.VLP$TIME$);
      300    13944        %VLR_FID(FPTN=VLR$FID,
      301    13945        STCLASS="BASED(GLOBAL_PTRS.VLR$FID$)");
      302    13964        %PAGE(ARG="QX$GLOBAL");

             13981    1   /***************************************************************************
             13982    1    *                                                                         *
             13983    1    *                                 QX$GLOBAL                               *
             13984    1    *                                                                         *
             13985    1    ***************************************************************************/

      303    13989        %QX$GLOBAL;
      304    14012        %PAGE(ARG="QXA$TPCP", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:13   
             14029    1   /***************************************************************************
             14030    1    *                                                                         *
             14031    1    *                                  QXA$TPCP                               *
             14032    1    *                                                                         *
             14033    1    ***************************************************************************/

      305    14037    1           IF B$JIT.CPFLAGS1 & '000000200000'O /* CP_INITIALIZE# */ THEN
      306    14038    2             DO;
      307    14039    2               CALL QXA$INIT;
      308    14040    2             END;
      309    14041
      310    14042    1           GLOBAL_PTRS = GLOBAL$PTRS;
      311    14043
      312    14044    1           M$UC$ = DCBADDR(3 /* M$UC# */);
      313    14045    1           FPT$CPEXIT = FPT_CPEXIT;
      314    14046    1           FPT$CPEXIT.V_ = VECTOR(FPT$CPEXIT.V);
      315    14047
      316    14048    1           IF B$JIT.CPFLAGS1 & '000004000000'O /* CP_LASTCP# */ THEN
      317    14049    2             DO;
      318    14050    2               GOTO EXITT;
      319    14051    2             END;
      320    14052
      321    14053    1           M$TPCP$ = DCBADDR(5 /* M$IBEX# */);
      322    14054    1           IF M$TPCP$ = ADDR(NIL) THEN
      323    14055    2             DO;
      324    14056    2               CALL M$GETDCB(FPT$GETDCB) ALTRET(MON_ERR);
      325    14057    2               M$TPCP$ = DCBADDR(5 /* M$IBEX# */);
      326    14058    2             END;
      327    14059
      328    14060    1           IF B$JIT.CPFLAGS1 & '400000000000'O /* CP_LOGOFF# */ OR
      329    14061    1               B$JIT.CPFLAGS1 & '000000000002'O /* CP_SCREECH# */ THEN
      330    14062    2             DO;
      331    14063    2               IF B$JIT.CPFLAGS1 & '200000000000'O /* CP_JSTEP# */ THEN
      332    14064    3                 DO;
      333    14065    3                   QX$GLOBAL.EXITING = '1'B;
      334    14066    3                 END;
      335    14067    2               ELSE
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:14   
      336    14068    3                 DO;
      337    14069    3                   FPT$CPEXIT.V.QUIT# = '1'B;
      338    14070    3                 END;
      339    14071    2               GOTO CLEAN_UP;
      340    14072    2             END;
      341    14073
      342    14074    1           IF B$JIT.CPFLAGS1 & '020000000000'O /* CP_YCPMME# */ THEN
      343    14075    2             DO;
      344    14076    2               CALL YC_PMME;
      345    14077    2             END;
      346    14078
      347    14079    1           IF B$JIT.CPFLAGS1 & '004000000000'O /* CP_LNKPMME# */ THEN
      348    14080    2             DO;
      349    14081    2               CALL LNK_PMME;
      350    14082    2               GOTO CLEAN_UP;
      351    14083    2             END;
      352    14084
      353    14085    1           IF B$JIT.USRRNST ~= '0'B THEN
      354    14086    2             DO;
      355    14087    2               B$JIT.USRRNST = '0'B;
      356    14088    2               CALL USER_ABORTED;
      357    14089    2             END;
      358    14090
      359    14091    1           IF B$JIT.CPFLAGS1 & '200000000000'O /* %CP_JSTEP# */ THEN
      360    14092    2             DO;
      361    14093    2               CALL GET_NEXT_XACTION;
      362    14094    2             END;
      363    14095
      364    14096    1   CLEAN_UP:
      365    14097    1           IF QX$GLOBAL.EXITING THEN
      366    14098    2             DO;
      367    14099    2               CALL ACCOUNTING;
      368    14100
      369    14101    2               FPT$OCMSG.V.MSG# = TPUSEROFF_MSG#;
      370    14102    2               IF B$JIT.CPFLAGS1 & '000000000002'O /* CP_SCREECH# */ THEN
      371    14103    3                 DO;
      372    14104    3                   FPT$OCMSG.V.SUBC# = 1;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:15   
      373    14105    3                 END;
      374    14106    2               CALL M$OCMSG(FPT$OCMSG) ALTRET(MON_ERR);
      375    14107    2             END;
      376    14108
      377    14109    1           CALL M$RELDCB(FPT$RELDCB) ALTRET(MON_ERR);
      378    14110
      379    14111                                 /*  check to see if M$IBEX1 needs to be released     */
      380    14112    1           IF DCBADDR(6) ~= ADDR(NIL) THEN
      381    14113    2             DO;
      382    14114    2               FPT$RELDCB_CPSL = FPT_RELDCB_CPSL;
      383    14115    2               FPT$RELDCB_CPSL.V_ = VECTOR(FPT$RELDCB_CPSL.V);
      384    14116    2               FPT$RELDCB_CPSL.V.DCB# = 6 /* M$IBEX1# */;
      385    14117    2               CALL M$RELDCB(FPT$RELDCB_CPSL) ALTRET(MON_ERR);
      386    14118    2             END;
      387    14119
      388    14120    1   EXITT:
      389    14121    1           CALL M$CPEXIT(FPT$CPEXIT) ALTRET(MON_ERR);
      390    14122
      391    14123    1   MON_ERR:
      392    14124    1           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      393    14125    1           CALL QXC$SCREECH(750, '01'O, 5);
      394    14126                %PAGE(ARG="GET_NEXT_XACTION", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:16   
             14143    1   /***************************************************************************
             14144    1    *                                                                         *
             14145    1    *                              GET_NEXT_XACTION                           *
             14146    1    *                                                                         *
             14147    1    ***************************************************************************/

      395    14151    1   GET_NEXT_XACTION:
      396    14152    1           PROC;
      397    14153
      398    14154    2           CHAR_STRING_SIZE = 7;
      399    14155    2           PINCRC(ADDR(B$JIT.CCBUF), B$JIT.CCARS) -> CHAR$STRING ='(empty)';
      400    14156
      401    14157                 /*  TPA went away -- M$UC was closed and scrubbed, so
      402    14158                     SETSTA$ will be addr(nil) -- EXIT!!!
      403    14159                 */
      404    14160    2           IF M$UC$ -> F$DCB.SETSTA$ = ADDR(NIL) THEN
      405    14161    3             DO;
      406    14162
      407    14163    3               QX$GLOBAL.EXITING = '1'B;
      408    14164    3               GOTO RET;
      409    14165
      410    14166    3             END;
      411    14167    2           VLP$SETSTA = VLP_SETSTA_UNLOCKED;
      412    14168    2           VLP$SETSTA.MYSTATION# = M$UC$ -> F$DCB.SETSTA$ ->
      413    14169    2               VLP$SETSTA.MYSTATION#;
      414    14170    2           QX$GLOBAL.SETSTA_LOCKED = '0'B;
      415    14171
      416    14172                                 /* If TPA goes away before activating him we will    */
      417    14173                                                /* get a E$NDCBCG error               */
      418    14174
      419    14175    2           CALL M$OPEN(FPT$OPEN_CG) ALTRET(OPEN_ERR);
      420    14176
      421    14177    3           DO WHILE('0'B);
      422    14178
      423    14179    3   OPEN_ERR:
      424    14180    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 876 /* E$NDCBCG */ OR
      425    14181    3                 B$JIT.STEPS > 0 THEN
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:17   
      426    14182    4               DO;
      427    14183    4                 GOTO MON_ERR;
      428    14184    4               END;
      429    14185
      430    14186    3             QX$GLOBAL.EXITING = '1'B;
      431    14187    3             GOTO RET;
      432    14188    3           END /* NEVER */;
      433    14189
      434    14190    2   READ_CG:
      435    14191    2           VLP$STATION = VLP_STATION;
      436    14192    2           VLP$STATION.MSGTYP# = VLP$MSGTYP.NAME#;
      437    14193    2           CHAR_STRING = VLP$MSGTYP.NAME#;
      438    14194
      439    14195    2           IF QX$GLOBAL.NOW THEN
      440    14196    3             DO;
      441    14197    3               GOTO SET_VLP_TRADER;
      442    14198    3             END;
      443    14199
      444    14200    2           CALL M$READ(FPT$READ_CG) ALTRET(READ_CG_ERR);
      445    14201
      446    14202    3           DO WHILE('0'B);
      447    14203
      448    14204    3   READ_CG_ERR:
      449    14205    3             ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      450    14206    3             IF ERR.CODE = 6 /* E$EOF */ OR ERR.CODE = 13 /* E$DACTR */ OR
      451    14207    3                 ERR.CODE = 892 /* E$CGORAU */ THEN
      452    14208    4               DO;
      453    14209    4                 QX$GLOBAL.EXITING = '1'B;
      454    14210    4                 GOTO RET;
      455    14211    4               END;
      456    14212
      457    14213    3             IF ERR.CODE ~= 7 /* E$LD */ THEN
      458    14214    4               DO;
      459    14215    4                 GOTO MON_ERR;
      460    14216    4               END;
      461    14217    3           END /* NEVER */;
      462    14218
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:18   
      463    14219    2   SET_VLP_TRADER:
      464    14220    2           IF NOT M$TPCP$ -> F$DCB.FCD# THEN
      465    14221    3             DO;
      466    14222    3               VLP$NAME = VLP$NAME_TRADER;
      467    14223    3               VLP$ACCT = VLP$ACCT_TRADER;
      468    14224    3               ADDR(FPT$OPEN_FILE.IFPARAM_) -> VLP$VECTOR.PTR$ =
      469    14225    3                   ADDR(VLP$IFPARAM_PASS_TRADER);
      470    14226    3               ADDR(FPT$OPEN_FILE.IFPARAM_) -> VLP$VECTOR.W1.VSIZE# =
      471    14227    3                   SIZEV(VLP$IFPARAM_PASS_TRADER) +
      472    14228    3                   SIZEC(VLP$CODE07_PASS_TRADER);
      473    14229    3               VLP$SN = VLP$SN_TRADER;
      474    14230    3               CALL M$OPEN(FPT$OPEN_FILE) ALTRET(MON_ERR);
      475    14231    3             END;
      476    14232
      477    14233    2           IF QX$GLOBAL.NOW THEN
      478    14234    3             DO;
      479    14235    3               CALL CONCAT(VLP$KEY.NAME#,CHAR_STRING,'_E');
      480    14236    3             END;
      481    14237    2           ELSE
      482    14238    3             DO;
      483    14239    3               CALL CONCAT(VLP$KEY.NAME#,
      484    14240    3                   M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGTYP#,
      485    14241    3                   '_E');
      486    14242    3             END;
      487    14243    2           VLP$KEY.L# = 10;
      488    14244
      489    14245    2   READ_TRADER:
      490    14246    2           CALL M$READ(FPT$READ_KEY) ALTRET(READ_TRADER_ERR);
      491    14247    2           CALL M$CLOSE(FPT$CLOSE) ALTRET(MON_ERR);
      492    14248
      493    14249    3           DO WHILE('0'B);
      494    14250
      495    14251    3   READ_TRADER_ERR:
      496    14252    3             ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      497    14253    3             IF ERR.CODE = 7 /* E$LD */ THEN
      498    14254    4               DO;
      499    14255    4                 CALL M$GDS(FPT$GDS) ALTRET(MON_ERR);
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:19   
      500    14256    4                 CHAR_STRING_SIZE = VLP$GDS.W1.VSIZE# + 1;
      501    14257    4                 FPT$READ_KEY.BUF_ = VECTOR(QX_GLOBAL.QT$ENTRY$ -> CHAR$STRING);
      502    14258    4                 GOTO READ_TRADER;
      503    14259    4               END;
      504    14260
      505    14261    3             IF ERR.CODE = 66 /* E$NOKEY */ AND
      506    14262    3                 NOT QX$GLOBAL.NOW THEN
      507    14263    4               DO;
      508    14264        /* PUT THE XACTION ON HOLD */
      509    14265    4                 CALL M$UNLATCH(FPT$UNLATCH) ALTRET(MON_ERR);
      510    14266    4                 CALL QXC$BLDMSG_ERRBLK(MSGBLK);
      511    14267    4                 MSGBLK.FLAGS.HDR = HDR_FLAGS_UNDEF_XACT;
      512    14268    4                 MSGBLK.ERRINFO.ERR(0) = CODE_MISSING_REC;
      513    14269    4                 CALL QXC$BLDMSG(MSGBLK);
      514    14270    4                 GOTO READ_CG;
      515    14271    4               END;
      516    14272
      517    14273    3             GOTO MON_ERR;
      518    14274    3           END /* NEVER */;
      519    14275
      520    14276    2           VLP$SETSTA = VLP_SETSTA_LOCKED;
      521    14277    2           IF QX$GLOBAL.NOW THEN
      522    14278    3             DO;
      523    14279    3               VLP$SETSTA.ISTA.IMSGTYP# = CHAR_STRING;
      524    14280    3               VLP$SETSTA.MYSTATION# = M$UC$ -> F$DCB.SETSTA$ ->
      525    14281    3                   VLP$SETSTA.MYSTATION#;
      526    14282    3               QX$GLOBAL.NOW = '0'B;
      527    14283    3             END;
      528    14284    2           ELSE
      529    14285    3             DO;
      530    14286    3               VLP$SETSTA.ISTA.IMSGTYP# =
      531    14287    3                   M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGTYP#;
      532    14288    3             END;
      533    14289
      534    14290    2           IF NOT QT$ENTRY.FLAGS.NEW_LOCK THEN
      535    14291    3             DO;
      536    14292    3               VLP$SETSTA.ISTA.ILOCK# = '0'B;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:20   
      537    14293    3               VLP$SETSTA.OSTA.OLOCK# = '0'B;
      538    14294    3             END;
      539    14295
      540    14296    2           IF QX$GLOBAL.PERM OR (QX$GLOBAL.SEMIPERM AND
      541    14297    2               (QX$GLOBAL.TIMEOUT > 0)) THEN
      542    14298    3             DO;
      543    14299    3               VLP$SETSTA.ISTA.EOFNONE# = '0'B;
      544    14300    3               VLP$SETSTA.ISTA.EOFONE# = '0'B;
      545    14301    3               IF QX$GLOBAL.TIMEOUT > 0 THEN /* TIMEOUT option specified         */
      546    14302    3                 VLP$SETSTA.ISTA.EOFTIME# = 60 * QX$GLOBAL.TIMEOUT;
      547    14303                            /* TIMEOUT is expressed in minutes, EOFTIME# in seconds   */
      548    14304
      549    14305    3             END;
      550    14306
      551    14307
      552    14308    2           CALL M$OPEN(FPT$OPEN_CG) ALTRET(MON_ERR);
      553    14309    2           QX$GLOBAL.SETSTA_LOCKED = '1'B;
      554    14310
      555    14311    2           IF QX$GLOBAL.SETS OR QT$ENTRY.FLAGS.DCBS_SET THEN
      556    14312    3             DO;
      557    14313    3               CALL BUILD_STARA ALTRET(MON_ERR);
      558    14314    3             END;
      559    14315
      560    14316    2           FPT$CPEXIT.NAME_ = VECTOR(VLP$NAME);
      561    14317    2           VLP$NAME = QT$ENTRY.TPAP.NAME;
      562    14318    2           B$JIT.CCARS = QT$ENTRY.TPAP.NAME.COUNT;
      563    14319    2           B$JIT.CCDISP = QT$ENTRY.TPAP.NAME.COUNT;
      564    14320    2           B$JIT.CCBUF = QT$ENTRY.TPAP.NAME.TEXT;
      565    14321    2           FPT$CPEXIT.ACCT_ = VECTOR(VLP$ACCT);
      566    14322    2           VLP$ACCT.ACCT# = QT$ENTRY.TPAP.ACCT;
      567    14323    2           FPT$CPEXIT.PASS_ = VECTOR(VLP$PASS);
      568    14324    2           VLP$PASS.PASS# = QT$ENTRY.TPAP.PASS;
      569    14325
      570    14326    2           IF QT$ENTRY.TPAP.SN ~= ' ' THEN
      571    14327    3             DO;
      572    14328    3               FPT$CPEXIT.PSID_ = VECTOR(VLP$SN);
      573    14329    3               VLP$SN.SN#(0) = QT$ENTRY.TPAP.SN;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:21   
      574    14330    3             END;
      575    14331
      576    14332    2           IF QT$ENTRY.DEBUGGER.COUNT ~= 0 THEN
      577    14333    3             DO;
      578    14334    3               FPT$CPEXIT.DEBUG_ = VECTOR(VLP$DEBUGGER);
      579    14335    3               VLP$DEBUGGER = QT$ENTRY.DEBUGGER;
      580    14336    3             END;
      581    14337
      582    14338    2           IF QT$ENTRY.FLAGS.MESSAGE THEN
      583    14339    3             DO;
      584    14340    3               QX$GLOBAL.MESSAGE = '1'B;
      585    14341    3             END;
      586    14342    2           ELSE
      587    14343    3             DO;
      588    14344    3               QX$GLOBAL.MESSAGE = '0'B;
      589    14345    3             END;
      590    14346
      591    14347    2   RET:
      592    14348    2           IF M$TPCP$ -> F$DCB.FCD# THEN
      593    14349    3             DO;
      594    14350    3               CALL M$CLOSE(FPT$CLOSE) ALTRET(MON_ERR);
      595    14351    3             END;
      596    14352
      597    14353    2           RETURN;
      598    14354
      599    14355    2   MON_ERR:
      600    14356    2           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      601    14357    2           CALL QXC$SCREECH(750, '01'O, 5);
      602    14358    2   END GET_NEXT_XACTION;
      603    14359                %PAGE(ARG="BUILD_STARA", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:22   
             14376    2   /***************************************************************************
             14377    2    *                                                                         *
             14378    2    *                                BUILD_STARA                              *
             14379    2    *                                                                         *
             14380    2    ***************************************************************************/

      604    14384    1   BUILD_STARA:
      605    14385    1           PROC ALTRET;
      606    14386
      607    14387    2           VLP$NAME.L# = 2;
      608    14388    2           VLP$NAME.NAME# = '*A';
      609    14389    2           VLP$ACCT.ACCT# = ' ';
      610    14390    2           FPT$OPEN_FILE.IFPARAM_ = VECTOR(NIL);
      611    14391    2           VLP$SN.SN#(0) = ' ';
      612    14392    2           CALL M$OPEN(FPT$OPEN_FILE) ALTRET(MON_ERR);
      613    14393
      614    14394        /***
      615    14395         *** Delete any old 'SET' commands that are left
      616    14396         ***/
      617    14397
      618    14398    2           IF QX$GLOBAL.SETS THEN
      619    14399    3             DO;
      620    14400    3               QX$GLOBAL.SETS = '0'B;
      621    14401    3               VLP$KEY = '001000'O;
      622    14402    3               CALL M$DELREC(FPT$DELREC) ALTRET(MON_ERR);
      623    14403    3             END;
      624    14404
      625    14405    2           IF QT$ENTRY.FLAGS.DCBS_SET THEN
      626    14406    3             DO;
      627    14407    3               QX$GLOBAL.SETS = '1'B;
      628    14408
      629    14409    3               REC$ = PINCRW(QX_GLOBAL.QT$ENTRY$, SIZEW(QT$ENTRY));
      630    14410    4               DO I = 1 TO QT$ENTRY.SET_COUNT;
      631    14411    4                 VLP$KEY = REC$ -> QT$SETBITS.DCBNAME;
      632    14412    4                 FPT$WRITE_KEY.BUF_.BUF$ =
      633    14413    4                     ADDR(REC$ -> QT$SETBITS.ASN_MERGE.TEXT);
      634    14414
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:23   
      635    14415    4                 FPT$WRITE_KEY.BUF_.BOUND =
      636    14416    4                     REC$ -> QT$SETBITS.ASN_MERGE.COUNT - 1;
      637    14417
      638    14418    4                 IF (QX$GLOBAL.SEMIPERM OR QX$GLOBAL.PERM) THEN
      639    14419    5                   DO;
      640    14420    5                     AMR$FPT_OPEN$ = ADDR(REC$ -> QT$SETBITS.ASN_MERGE.TEXT);
      641    14421    5                     PTR$_BITS = PINCRC(AMR$FPT_OPEN$,
      642    14422    5                         POFFC(ADDR(AMR$FPT_OPEN.SETSTA_), AMR$FPT_OPEN$)) ->
             14422                                  BASED$WORD;
      643    14423
      644    14424    5                     IF PTR$_BITS.WORDS ~= 0 THEN
      645    14425    6                       DO;
      646    14426    6                         SETSTA$ = PINCRC(AMR$FPT_OPEN$, PTR$_BITS.WORDS * 4);
      647    14427    6                         VLP$SETSTA = SETSTA$ -> VLP$SETSTA;
      648    14428
      649    14429    6                         VLP$SETSTA.ISTA.EOFNONE# = '0'B;
      650    14430    6                         VLP$SETSTA.ISTA.EOFONE# = '0'B;
      651    14431
      652    14432    6                         IF QX$GLOBAL.SEMIPERM THEN
      653    14433    7                           DO;
      654    14434    7                             VLP$SETSTA.ISTA.EOFNONE# = '1'B;
      655    14435    7                           END;
      656    14436
      657    14437    6                         IF QX$GLOBAL.TIMEOUT > 0 THEN
      658    14438    7                           DO;             /* TIMEOUT option specified on TRANS  */
      659    14439    7                             VLP$SETSTA.ISTA.EOFNONE# = '0'B;
      660    14440    7                             VLP$SETSTA.ISTA.EOFTIME# = 60 * QX$GLOBAL.TIMEOUT;
      661    14441                                 /* TIMEOUT expressed in minutes, EOFTIME# in seconds */
      662    14442    7                           END;
      663    14443
      664    14444    6                         SETSTA$ -> VLP$SETSTA = VLP$SETSTA;
      665    14445    6                       END;
      666    14446    5                   END;
      667    14447
      668    14448    4                 REC$ = PINCRW(REC$, SIZEW(REC$ -> QT$SETBITS));
      669    14449
      670    14450    4                 CALL M$WRITE(FPT$WRITE_KEY) ALTRET(MON_ERR);
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:24   
      671    14451    4               END;
      672    14452    3             END;
      673    14453
      674    14454    2           CALL M$CLOSE(FPT$CLOSE) ALTRET(MON_ERR);
      675    14455
      676    14456    2           RETURN;
      677    14457
      678    14458    2   MON_ERR:
      679    14459    2           ALTRETURN;
      680    14460
      681    14461    2   END BUILD_STARA;
      682    14462                %PAGE(ARG="USER_ABORTED", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:25   
             14479    2   /***************************************************************************
             14480    2    *                                                                         *
             14481    2    *                                USER_ABORTED                             *
             14482    2    *                                                                         *
             14483    2    ***************************************************************************/

      683    14487    1   USER_ABORTED:
      684    14488    1           PROC;
      685    14489
      686    14490    2           IF B$JIT.CPFLAGS1 & '100000000000'O /* CP_RUND# */ THEN
      687    14491    3             DO;
      688    14492    3               FPT$CPEXIT.V.QUIT# = '1'B;
      689    14493    3             END;
      690    14494
      691    14495    2           CALL QXC$BLDMSG_ERRBLK(MSGBLK);
      692    14496    2           MSGBLK.ERRINFO.ERR(0) = B$JIT.USRERR;
      693    14497    2           MSGBLK.ERRINFO.DCB#(0) = B$JIT.USRDCB;
      694    14498    2           MSGBLK.FLAGS.HDR = HDR_FLAGS_TPAP_ABORT;
      695    14499
      696    14500    2           IF QT$ENTRY.FLAGS.MESSAGE THEN
      697    14501    3             DO;
      698    14502    3               MSGBLK.FLAGS.DEST.STATION = '1'B;
      699    14503    3             END;
      700    14504
      701    14505    2           CALL QXC$BLDMSG(MSGBLK);
      702    14506
      703    14507    2           CALL M$UNLATCH(FPT$UNLATCH) ALTRET(UNLATCH_ERR);
      704    14508
      705    14509    3           DO WHILE('0'B);
      706    14510
      707    14511    3   UNLATCH_ERR:
      708    14512    3             ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      709    14513    3             IF ERR.CODE ~= 1141 /* E$CULUSR */ AND
      710    14514    3                 ERR.CODE ~= 1138 /* E$CGNTUL */ THEN
      711    14515    4               DO;
      712    14516    4                 B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      713    14517    4                 CALL QXC$SCREECH(750, '01'O, 5);
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:26   
      714    14518    4               END;
      715    14519    3           END /* NEVER */;
      716    14520
      717    14521    2   RET:
      718    14522    2           RETURN;
      719    14523    2   END USER_ABORTED;
      720    14524                %PAGE(ARG="YC_PMME", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:27   
             14541    2   /***************************************************************************
             14542    2    *                                                                         *
             14543    2    *                                  YC_PMME                                *
             14544    2    *                                                                         *
             14545    2    ***************************************************************************/

      721    14549    1   YC_PMME:
      722    14550    1           PROC;
      723    14551
      724    14552                                      /*  initialize INIT and CPSL_COMMAND_PARAMS     */
      725    14553    2           XUG$INIT   = XUG_INIT;
      726    14554    2           CPSL_COMMAND_PARAMETERS = '0'B;
      727    14555                /*
      728    14556                    dont let CXC, CXX routines report any errors they
      729    14557                    detect to the user, just put stuff in CPSL macro
      730    14558                */
      731    14559    2           CPSL_COMMAND_PARAMETERS.FLAGS.INHIBIT_ERRMSG = '1'B;
      732    14560                                                /*  initialize GETCMD structure       */
      733    14561
      734    14562    2           IF XUG$GETCMD.WORK$ = ADDR(NIL) THEN
      735    14563    2             CALL CXG$INIT(XUG$GETCMD, XUG$INIT) ALTRET(MON_ERR);
      736    14564                                                /*  fill in user stuff                */
      737    14565    2           QX$GLOBAL.SKIP_ERRS = '0'B;     /* print all errors                   */
      738    14566    2           CHAR_STRING_SIZE = B$JIT.YC0SZ + 1;
      739    14567    2           XUG$GETCMD.TEXT_ = VECTOR(B$PS0$ -> CHAR$STRING);
      740    14568    2           QX$GLOBAL.SKIP_ERRS = B$PS1$ -> FPTV$YC.NOERR;
      741    14569
      742    14570                                      /*  initialize GETDCB and RELDCB structures     */
      743    14571    2           FPT$GETDCB_CPSL = FPT_GETDCB_CPSL;
      744    14572    2           FPT$RELDCB_CPSL = FPT_RELDCB_CPSL;
      745    14573                /*  get WORK_DCB# for CXC$COMMAND, set DCBNUM
      746    14574                    vector to that of CPSL_COMMAND_PARAMETERS.WORK_DCB#
      747    14575                    for the GETDCB
      748    14576                */
      749    14577    2           FPT$GETDCB_CPSL.V_ = VECTOR(FPT$GETDCB_CPSL.V);
      750    14578    2           FPT$GETDCB_CPSL.DCBNUM_ = VECTOR(CPSL_COMMAND_PARAMETERS.WORK_DCB#);
      751    14579    2           FPT$GETDCB_CPSL.V.DCB# = 6 /* M$IBEX1# */;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:28   
      752    14580    2           IF DCBADDR(6) = ADDR(NIL) THEN
      753    14581    3             DO;
      754    14582    3               CALL M$GETDCB(FPT$GETDCB_CPSL) ALTRET(MON_ERR);
      755    14583    3             END;
      756    14584    2           CALL CXC$COMMAND(XUG$GETCMD,CPSL_COMMAND_PARAMETERS)
      757    14585    3           WHENRETURN DO;
      758    14586    3               FPT$CPEXIT.V.CONT# = '1'B;  /*  resume                            */
      759    14587    3             END;
      760    14588    3           WHENALTRETURN DO;
      761    14589    3               FPT$CPEXIT.V.ALTRTN# = '1'B;
      762    14590                                                /*  stuff error info into CPEXIT      */
      763    14591    3               FPT$CPEXIT.V.JERR = CPSL_COMMAND_PARAMETERS.ERRCODE;
      764    14592                                                /*  should we print to the DO fid???  */
      765    14593    3               IF ~QX$GLOBAL.SKIP_ERRS THEN
      766    14594    4                 DO;
      767    14595
      768    14596    4                   CALL QXC$BLDMSG_ERRBLK(MSGBLK);
      769    14597    4                   MSGBLK.ERRINFO.ERR(0) = CPSL_COMMAND_PARAMETERS.ERRCODE;
      770    14598    4                   MSGBLK.FLAGS.DEST.MCT = '0'B; /* don't send to MCT            */
      771    14599    4                   MSGBLK.FLAGS.DEST.DODCB = '1'B; /* send to DO fid only        */
      772    14600    4                   MSGBLK.ERRINFO.DCB#(0) = CPSL_COMMAND_PARAMETERS.ERR_DCB#;
      773    14601    4                   MSGBLK.FLAGS.HDR = HDR_FLAGS_YCPMME_ABORT;
      774    14602
      775    14603    4                   IF QX$GLOBAL.MESSAGE THEN
      776    14604    5                     DO;
      777    14605
      778    14606    5                       MSGBLK.FLAGS.DEST.STATION = '1'B;
      779    14607
      780    14608    5                     END;
      781    14609    4                   CALL QXC$BLDMSG(MSGBLK);
      782    14610
      783    14611    4                   CALL M$UNLATCH(FPT$UNLATCH) WHENALTRETURN
      784    14612    5                     DO;
      785    14613    5                       ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      786    14614    5                       IF ERR.CODE ~= 1141 /* E$CULUSR */ AND
      787    14615    5                           ERR.CODE ~= 1138 /* E$CGNTUL */ THEN
      788    14616    6                         DO;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:29   
      789    14617    6                           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      790    14618    6                           CALL QXC$SCREECH(750, '01'O, 5);
      791    14619    6                         END;
      792    14620    5                     END;
      793    14621    4                 END;                      /*  write to DO fid                   */
      794    14622    3             END;                          /* altret to CXC$COMMAND              */
      795    14623
      796    14624                                                /*  dont forget to release the dcb    */
      797    14625    2           FPT$RELDCB_CPSL.V_ = VECTOR(FPT$RELDCB_CPSL.V);
      798    14626    2           FPT$RELDCB_CPSL.V.DCB# = 6 /* M$IBEX1# */;
      799    14627    2           CALL M$RELDCB(FPT$RELDCB_CPSL) ALTRET(MON_ERR);
      800    14628
      801    14629    2           RETURN;
      802    14630
      803    14631
      804    14632    2   MON_ERR:
      805    14633    2           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      806    14634    2           CALL QXC$SCREECH(750, '01'O, 5);
      807    14635    2   END YC_PMME;
      808    14636
      809    14637                %PAGE(ARG="LINK_PMME", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:30   
             14654    2   /***************************************************************************
             14655    2    *                                                                         *
             14656    2    *                                 LINK_PMME                               *
             14657    2    *                                                                         *
             14658    2    ***************************************************************************/

      810    14662    1   LNK_PMME:
      811    14663    1           PROC;
      812    14664
      813    14665    2           FPT$CPEXIT.V.ALTRTN# = '1'B;
      814    14666    2           FPT$CPEXIT.V.JERR = CODE_NO_CP_CMD;
      815    14667
      816    14668    2           RETURN;
      817    14669    2   END LNK_PMME;
      818    14670                %PAGE(ARG="ACCOUNTING", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:31   
             14687    2   /***************************************************************************
             14688    2    *                                                                         *
             14689    2    *                                 ACCOUNTING                              *
             14690    2    *                                                                         *
             14691    2    ***************************************************************************/

      819    14695    1   ACCOUNTING:
      820    14696    1           PROC;
      821    14697
      822    14698    2           LOGOFF_PARAM.CODE = 2;
      823    14699    2           LOGOFF_PARAM.DCB1 = 5 /* M$IBEX# */;
      824    14700    2           CALL AZA$LOGOFF(LOGOFF_PARAM) ALTRET(LOGOFF_ERR);
      825    14701
      826    14702    3           DO WHILE('0'B);
      827    14703
      828    14704    3   LOGOFF_ERR:
      829    14705            /* Call M$ERRMSG to fill in the message before sending it to
      830    14706               the Console.   FPT$KEYIN is setup in QXA$INIT    */
      831    14707    3             CALL QXC$BLDMSG_ERRBLK(MSGBLK);
      832    14708    3             FPT$ERRMSG.BUF_ = VECTOR (BUFFER_MSG1);
      833    14709    3             FPT$ERRMSG.CODE_ = VECTOR (MSGBLK.ERRINFO.ERR(0));
      834    14710    3             FPT$ERRMSG.V.DCB# = MSGBLK.ERRINFO.DCB#(0);
      835    14711    3             CALL M$ERRMSG(FPT$ERRMSG) ALTRET (IGNORE);
      836    14712    3   IGNORE:   ;
      837    14713    3             CALL M$KEYIN(FPT$KEYIN) ALTRET (IGNORE2);
      838    14714    3   IGNORE2:  ;
      839    14715    3             FPT$OCMSG.V.MSG# = TP_ACCT_MSG#;
      840    14716    3             CALL M$OCMSG(FPT$OCMSG) ALTRET(MON_ERR);
      841    14717    3           END /* NEVER */;
      842    14718
      843    14719    2           IF NOT B$JIT.CPFLAGS1 & '000010000000'O /* CP_LASTCPEXISTS# */THEN
      844    14720    3             DO;
      845    14721    3               GOTO RET;
      846    14722    3             END;
      847    14723
      848    14724    2           B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 & '000004000000'O /* CP_LASTCP# */;
      849    14725
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:32   
      850    14726    2           VLP$NAME.L# = 6;
      851    14727    2           VLP$NAME.NAME# = ':USERS';
      852    14728    2           VLP$ACCT.ACCT# = ':SYS';
      853    14729    2           FPT$OPEN_FILE.IFPARAM_ = VECTOR(NIL);
      854    14730    2           VLP$SN.SN#(0) = ' ';
      855    14731    2           CALL M$OPEN(FPT$OPEN_FILE) ALTRET(MON_ERR);
      856    14732
      857    14733    2           CALL CONCAT(VLP$KEY.NAME#, B$JIT.ACCN, B$JIT.UNAME);
      858    14734    2           CALL INDEX(BLANK_POS, ' ', B$JIT.UNAME) ALTRET(NO_BLANK);
      859    14735    2           BLANK_POS = BLANK_POS + 1;
      860    14736
      861    14737    2   NO_BLANK:
      862    14738    2           VLP$KEY.L# = 8 + BLANK_POS;
      863    14739    2           CALL M$READ(FPT$READ_KEY) ALTRET(READ_ERR);
      864    14740
      865    14741    3           DO WHILE('0'B);
      866    14742
      867    14743    3   READ_ERR:
      868    14744    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 66 /* E$NOKEY */ THEN
      869    14745    4               DO;
      870    14746    4                 GOTO MON_ERR;
      871    14747    4               END;
      872    14748
      873    14749    3             GOTO RET;
      874    14750    3           END /* NEVER */;
      875    14751
      876    14752    2           VLP$NAME = AS$USERS.LASTCPROC.NAME(4 /* M_TP# */ - 1);
      877    14753    2           FPT$CPEXIT.NAME_ = VECTOR(VLP$NAME);
      878    14754    2           VLP$ACCT.ACCT# = ':SYS';
      879    14755    2           FPT$CPEXIT.ACCT_ = VECTOR(VLP$ACCT);
      880    14756
      881    14757    2   RET:
      882    14758    2           IF M$TPCP$ -> F$DCB.FCD# THEN
      883    14759    3             DO;
      884    14760    3               CALL M$CLOSE(FPT$CLOSE) ALTRET(MON_ERR);
      885    14761    3             END;
      886    14762
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:33   
      887    14763    2           RETURN;
      888    14764
      889    14765    2   MON_ERR:
      890    14766    2           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      891    14767    2           CALL QXC$SCREECH(750, '01'O, 5);
      892    14768
      893    14769    2   END ACCOUNTING;
      894    14770    1   END QXA$TPCP;

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:34   
--  Include file information  --

   CX_MACROS_M.:E05TOU  is referenced.
   CX_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CXG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   JS$CP6V_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_SCODE_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QX_PERR_C.:E05TOU  is referenced.
   QX_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QX_MACROS_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QXA$TPCP.

   Procedure QXA$TPCP requires 1015 words for executable code.
   Procedure QXA$TPCP requires 150 words of local(AUTO) storage.

    No errors detected in file QXA$TPCP.:E05TSI    .
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:35   

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:36   

 Object Unit name= QXA$TPCP                                   File name= QXA$TPCP.:E05TOU
 UTS= JUL 30 '97 05:53:30.72 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    118    166  QXA$TPCP
    2   Proc  even  none  1015   1767  QXA$TPCP
    3  RoData even  none    17     21  QXA$TPCP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  QXA$TPCP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 X$PRE_PROCESS
         yes           Std       3 QXC$SCREECH
         yes           Std       0 QXA$INIT
         yes           Std       1 QXC$BLDMSG
         yes           Std       1 QXC$BLDMSG_ERRBLK
 yes     yes           Std       2 CXG$INIT
 yes     yes           Std       2 CXC$COMMAND
 yes     yes           Std       1 AZA$LOGOFF
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:37   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    QX_GLOBAL                             M$UC                                  B$JIT$
     B$TCB$                           r    B$PS0$                           r    B$PS1$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:38   


        1        1        /*M* QXA$TPCP - TPCP major processing routine */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QXA$TPCP:
        9        9                PROC;

      9  2 000000   000000 700200 xent  QXA$TPCP     TSX0  ! X66_AUTO_0
         2 000001   000226 000000                    ZERO    150,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44
       14       45        %PAGE(ARG="Includes");

                62        /***************************************************************************
                63         *                                                                         *
                64         *                                  Includes                               *
                65         *                                                                         *
                66         ***************************************************************************/

       15       70        %INCLUDE QQ_MACROS_C;
       16      495        %INCLUDE QT_SUBS_C;
       17      579        %INCLUDE QX_MACROS_C;
       18      714        %INCLUDE QX_DATA_R;
       19      724        %INCLUDE QX_PERR_C;
       20      734        %INCLUDE Q_ERRCODE_C;
       21      757        %INCLUDE QT_MACROS_C;
       22      915        %INCLUDE Q_SCODE_C;
       23      926        %INCLUDE CP_6;
       24     1007        %INCLUDE AS_SUPER_C;
       25     1442        %INCLUDE OC_SUBS_C;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:39   
       26     2173        %INCLUDE CP_6_SUBS;
       27     2713        %INCLUDE B_ERRORS_C;
       28     3840        %INCLUDE B$JIT;
       29     4130        %INCLUDE FM$FIT;
       30     4351        %INCLUDE AZ_SUBS_C;
       31     4420        %INCLUDE AZ_MACRO_C;
       32     7007        %INCLUDE JS$CP6V_C;
       33     7070        %INCLUDE CXG_ENTRY;
       34     7082        %INCLUDE XU_MACRO_C;
       35    10188        %INCLUDE CX_SUBS_C;
       36    10201        %INCLUDE CX_MACROS_M;
       37    10252        %PAGE(ARG="Externally defined routines");

             10269    1   /***************************************************************************
             10270    1    *                                                                         *
             10271    1    *                        Externally defined routines                      *
             10272    1    *                                                                         *
             10273    1    ***************************************************************************/

       38    10277    1   DCL AZA$LOGOFF ENTRY(1) ALTRET;
       39    10278    1   DCL QXA$XCON ENTRY ASYNC;
       40    10279    1   DCL QXC$SCREECH ENTRY(3);
       41    10280    1   DCL QXC$BLDMSG ENTRY(1);
       42    10281    1   DCL QXC$BLDMSG_ERRBLK ENTRY(1);
       43    10282    1   DCL QXA$INIT ENTRY;
       44    10283    1   DCL X$PRE_PROCESS ENTRY(1) ALTRET;
       45    10284    1   DCL CXC$COMMAND ENTRY(2) ALTRET;
       46    10285        %PAGE(ARG="Symrefs");

             10302    1   /***************************************************************************
             10303    1    *                                                                         *
             10304    1    *                                  Symrefs                                *
             10305    1    *                                                                         *
             10306    1    ***************************************************************************/

       47    10310    1   DCL B$JIT$ PTR SYMREF;
       48    10311    1   DCL B$TCB$ PTR SYMREF;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:40   
       49    10312    1   DCL B$PS0$ PTR SYMREF READONLY;         /* pointer to PARAMETER STACK         */
       50    10313    1   DCL B$PS1$ PTR SYMREF READONLY;         /* pointer to PARAMETER STACK         */
       51    10314        %PAGE(ARG="Based");

             10331    1   /***************************************************************************
             10332    1    *                                                                         *
             10333    1    *                                   Based                                 *
             10334    1    *                                                                         *
             10335    1    ***************************************************************************/

       52    10339        %F$DCB;
       53    10396        %QT$ENTRY(STCLASS="BASED(QX_GLOBAL.QT$ENTRY$)");
       54    10450        %AS_USERS(STR_NAME=AS$USERS, STCLASS="BASED(QX_GLOBAL.QT$ENTRY$)");
       55    10628        %QT$SETBITS;
       56    10649        %B$TCB;
       57    10652        %B$ALT;
       58    10660        %FPT$YC_V(FPTN=FPTV$YC);
       59    10663
       60    10664    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       61    10665
       62    10666    1   DCL BASED$WORD BIT(36) UNAL BASED;
       63    10667
       64    10668    1   DCL BUFFER_MSG1  CHAR(124) DALIGNED BASED (GLOBAL_PTRS.BUFFER$);
       65    10669
       66    10670        %FPT_OPEN(FPTN=AMR$FPT_OPEN, STCLASS="BASED(AMR$FPT_OPEN$)",
       67    10671        PFMT=PTR, VECTOR=ADDR);
       68    10780        %PAGE(ARG="Constants");

             10797    1   /***************************************************************************
             10798    1    *                                                                         *
             10799    1    *                                 Constants                               *
             10800    1    *                                                                         *
             10801    1    ***************************************************************************/

       69    10805        %HDR_FLAGS(FPTN=HDR_FLAGS_UNDEF_XACT, STCLASS=CONSTANT, TYPE=YES,
       70    10806        ID=YES, SOA=YES, TIME=YES, MSG=UNDEF_XACT,
       71    10807        LVL=1, LAST=";");
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:41   
       72    10842
       73    10843        %HDR_FLAGS(FPTN=HDR_FLAGS_TPAP_ABORT, STCLASS=CONSTANT, TYPE=YES,
       74    10844        ID=YES, SOA=YES, TIME=YES, MSG=TPAP_ABORT, USRERR=YES, USRDCB=YES,
       75    10845        USRIC=YES,
       76    10846        LVL=1, LAST=";");
       77    10881
       78    10882        %HDR_FLAGS(FPTN=HDR_FLAGS_YCPMME_ABORT, STCLASS=CONSTANT, TYPE=YES,
       79    10883        ID=YES, SOA=YES, TIME=YES, MSG=YCPMME_ABORT,
       80    10884        USRIC=YES,
       81    10885        LVL=1, LAST=";");
       82    10920
       83    10921        %VLP_SETSTA(FPTN=VLP_SETSTA_UNLOCKED, STCLASS=CONSTANT, WAS=YES);
       84    10949
       85    10950        %VLP_SETSTA(FPTN=VLP_SETSTA_LOCKED, STCLASS=CONSTANT, ILOCK=YES,
       86    10951        ILATCH=YES, OLOCK=YES, OLATCH=YES, EOFNONE=YES, WAS=YES);
       87    10979        %VLP_STATION(STCLASS=CONSTANT, LATCH=YES);
       88    11006
       89    11007        %XUG_INIT(WSEG=7,PREPROCESS=YES,PREPROCESSOR=X$PRE_PROCESS,
       90    11008        PP_PROCNAME=IBEX_NAME,PROCNAME=IBEX_NAME,PROCACCT=COLONSYS,
       91    11009        CMDSZ=256,ECHO=NEVER_ECHO,SYNTAX=NO,COMMANDS=NO,
       92    11010        ADAPT=NIL,
       93    11011        STCLASS=CONSTANT);
       94    11424
       95    11425        %VLP_NAME(FPTN=IBEX_NAME, NAME='IBEX', STCLASS=CONSTANT);
       96    11452        %VLP_ACCT(FPTN=COLONSYS, ACCT=':SYS', STCLASS=CONSTANT);
       97    11465
       98    11466        %FPT_RELDCB(FPTN=FPT_RELDCB_CPSL, STCLASS=CONSTANT);
       99    11480        %FPT_GETDCB(FPTN=FPT_GETDCB_CPSL, STCLASS=CONSTANT);
      100    11495        %PAGE(ARG="Auto");

             11512    1   /***************************************************************************
             11513    1    *                                                                         *
             11514    1    *                                    Auto                                 *
             11515    1    *                                                                         *
             11516    1    ***************************************************************************/

      101    11520
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:42   
      102    11521    1   DCL CHAR_STRING_SIZE UBIN WORD;
      103    11522    1   DCL I UBIN WORD;
      104    11523    1   DCL BLANK_POS UBIN WORD;
      105    11524    1   DCL SPACE_NEEDED UBIN WORD;
      106    11525    1   DCL CHAR_STRING CHAR(8) ALIGNED;
      107    11526
      108    11527        %GLOBAL_PTRS;
      109    11620    1   DCL M$UC$ PTR;
      110    11621    1   DCL M$TPCP$ PTR;
      111    11622    1   DCL SETSTA$ PTR;
      112    11623    1   DCL REC$ PTR;
      113    11624    1   DCL AMR$FPT_OPEN$ PTR;
      114    11625
      115    11626    1   DCL 1 PTR$_BITS,
      116    11627    1         2 WORDS UBIN(18) UNAL,
      117    11628    1         2 * UBIN(18) UNAL;
      118    11629
      119    11630        %LOGOFF$PARAM(NAME=LOGOFF_PARAM, STCLASS=AUTO);
      120    11671        %MSGBLK;
      121    11761    1   DCL 1 ERR,
      122    11762    1         2 FCG BIT(12) UNAL,
      123    11763    1         2 MID BIT(6) UNAL,
      124    11764    1         2 MON BIT(1) UNAL,
      125    11765    1         2 CODE UBIN(14) UNAL,
      126    11766    1         2 SEV UBIN(3) UNAL;
      127    11767        %CPSL_COMMAND_PARAMETERS;
      128    11785
      129    11786
      130    11787        %XUG_INIT(NAME=XUG$INIT, STCLASS=AUTO);
      131    12200
      132    12201        %FPT_RELDCB(FPTN=FPT$RELDCB_CPSL, STCLASS=AUTO);
      133    12215        %FPT_GETDCB(FPTN=FPT$GETDCB_CPSL, STCLASS=AUTO);
      134    12230        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:43   
             12247    1   /***************************************************************************
             12248    1    *                                                                         *
             12249    1    *                                Error codes                              *
             12250    1    *                                                                         *
             12251    1    ***************************************************************************/

      135    12255        %ERRCODE(NAME=CODE_INVALID_CMD, CODE#=%E$INVALID_CMD, FCG#=%FCG_QX, MID#=%MID_A);
      136    12262        %ERRCODE(NAME=CODE_MISSING_REC, CODE#=%E$MISSING_REC, FCG#=%FCG_QX, MID#=%MID_A);
      137    12269        %ERRCODE(NAME=CODE_NO_CP_CMD, CODE#=%E$NO_CP_CMD, FCG#=%FCG_QX, MID#=%MID_A);
      138    12276
      139    12277        /*E* ERROR:       QXA-E$INVALID_CMD-C
      140    12278
      141    12279             MESSAGE:     Commands may not be passed to TPCP via the
      142    12280                          M$YC monitor service.
      143    12281             DESCRIPTION: TPCP checks the contents of the command buffer
      144    12282                          against a list a valid commands.  The command
      145    12283                          that was passed down was invalid.
      146    12284        */
      147    12285        /*E* ERROR:       QXA-E$MISSING_REC-C
      148    12286
      149    12287             MESSAGE:     A transaction in the comgroup could not be
      150    12288                          processed because it was not defined in the
      151    12289                          TRADER file.  The transaction has been held.
      152    12290             DESCRIPTION: All transactions that are to be processed must
      153    12291                          be defined in the TRADER file.  No record
      154    12292                          defining this transaction could be found.
      155    12293        */
      156    12294        /*E* ERROR:       QXA-E$NO_CP_CMD-C
      157    12295
      158    12296             MESSAGE:     The CP_CMD option on the M$LINK and M$LDTRC pmme
      159    12297                          cannot be processed by TPCP.
      160    12298             DESCRIPTION: TPCP is not set up at this time to handle parsing
      161    12299                          of the command line.  An altreturn will be taken.
      162    12300        */
      163    12301        %PAGE(ARG="Screech codes",PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:44   
             12318    1   /***************************************************************************
             12319    1    *                                                                         *
             12320    1    *                               Screech codes                             *
             12321    1    *                                                                         *
             12322    1    ***************************************************************************/

      164    12326        /*S* SCREECH_CODE: QXA-S$MON_ALT
      165    12327
      166    12328             TYPE:        SNAP
      167    12329
      168    12330             MESSAGE:     An unexpected monitor ALTRET was received by
      169    12331                          TPCP.
      170    12332             REMARKS:     Any unexpected monitor ALTRET received by TPCP
      171    12333                          will cause a SNAP screech.
      172    12334        */
      173    12335        %PAGE(ARG="G L O B A L   D A T A", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:45   
             12352    1   /***************************************************************************
             12353    1    *                                                                         *
             12354    1    *                           G L O B A L   D A T A                         *
             12355    1    *                                                                         *
             12356    1    ***************************************************************************/

      174    12360        %GLOBAL_PTRS(FPTN=GLOBAL$PTRS, STCLASS="BASED(QX_GLOBAL.GLOBAL$PTRS$)");
      175    12453        %PAGE(ARG="FPTs");

             12470    1   /***************************************************************************
             12471    1    *                                                                         *
             12472    1    *                                    FPTs                                 *
             12473    1    *                                                                         *
             12474    1    ***************************************************************************/

      176    12478        %FPT_READ(FPTN=FPT$READ_KEY,
      177    12479        STCLASS="BASED(GLOBAL_PTRS.FPT$READ_KEY$)");
      178    12518
      179    12519        %FPT_WRITE(FPTN=FPT$WRITE_KEY,
      180    12520        STCLASS="BASED(GLOBAL_PTRS.FPT$WRITE_KEY$)");
      181    12551
      182    12552        %FPT_GETDCB(FPTN=FPT$GETDCB,
      183    12553        STCLASS="BASED(GLOBAL_PTRS.FPT$GETDCB$)");
      184    12568
      185    12569        %FPT_RELDCB(FPTN=FPT$RELDCB,
      186    12570        STCLASS="BASED(GLOBAL_PTRS.FPT$RELDCB$)");
      187    12584
      188    12585        %FPT_CPEXIT(STCLASS=CONSTANT);
      189    12611        %FPT_CPEXIT(FPTN=FPT$CPEXIT,
      190    12612        STCLASS="BASED(GLOBAL_PTRS.FPT$CPEXIT$)");
      191    12638
      192    12639        %FPT_GDS(FPTN=FPT$GDS,
      193    12640        STCLASS="BASED(GLOBAL_PTRS.FPT$GDS$)");
      194    12656
      195    12657        %FPT_FID(FPTN=FPT$FID,
      196    12658        STCLASS="BASED(GLOBAL_PTRS.FPT$FID$)");
      197    12681
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:46   
      198    12682        %FPT_OPEN(FPTN=FPT$OPEN_FILE,
      199    12683        STCLASS="BASED(GLOBAL_PTRS.FPT$OPEN_FILE$)");
      200    12792
      201    12793        %FPT_DELREC(FPTN=FPT$DELREC,
      202    12794        STCLASS="BASED(GLOBAL_PTRS.FPT$DELREC$)");
      203    12813
      204    12814        %FPT_CLOSE(FPTN=FPT$CLOSE,
      205    12815        STCLASS="BASED(GLOBAL_PTRS.FPT$CLOSE$)");
      206    12857
      207    12858        %FPT_UNLATCH(FPTN=FPT$UNLATCH,
      208    12859        STCLASS="BASED(GLOBAL_PTRS.FPT$UNLATCH$)");
      209    12876
      210    12877        %FPT_READ(FPTN=FPT$READ_CG,
      211    12878        STCLASS="BASED(GLOBAL_PTRS.FPT$READ_CG$)");
      212    12917
      213    12918        %FPT_WRITE(FPTN=FPT$WRITE_CG,
      214    12919        STCLASS="BASED(GLOBAL_PTRS.FPT$WRITE_CG$)");
      215    12950
      216    12951        %FPT_OPEN(FPTN=FPT$OPEN_CG,
      217    12952        STCLASS="BASED(GLOBAL_PTRS.FPT$OPEN_CG$)");
      218    13061
      219    13062        %FPT_OCMSG(FPTN=FPT$OCMSG,
      220    13063        STCLASS="BASED(GLOBAL_PTRS.FPT$OCMSG$)");
      221    13079
      222    13080        %FPT_TIME(FPTN=FPT$TIME,
      223    13081        STCLASS="BASED(GLOBAL_PTRS.FPT$TIME$)");
      224    13100
      225    13101        %FPT_KEYIN(FPTN=FPT$KEYIN,
      226    13102        STCLASS="BASED(GLOBAL_PTRS.FPT$KEYIN$)");
      227    13121
      228    13122        %FPT_ERRMSG(FPTN=FPT$ERRMSG,
      229    13123        STCLASS="BASED(GLOBAL_PTRS.FPT$ERRMSG$)");
      230    13150
      231    13151        %XUG_GETCMD(NAME=XUG$GETCMD,
      232    13152        STCLASS="BASED(GLOBAL_PTRS.XUG$GETCMD$)");
      233    13490        %PAGE(ARG="VLPs");

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:47   
             13507    1   /***************************************************************************
             13508    1    *                                                                         *
             13509    1    *                                    VLPs                                 *
             13510    1    *                                                                         *
             13511    1    ***************************************************************************/

      234    13515        %VLP_NAME(FPTN=VLP$NAME,
      235    13516        STCLASS="BASED(GLOBAL_PTRS.VLP$NAME$) DALIGNED", LEN=31);
      236    13543
      237    13544        %VLP_ACCT(FPTN=VLP$ACCT,
      238    13545        STCLASS="BASED(GLOBAL_PTRS.VLP$ACCT$) DALIGNED");
      239    13558
      240    13559        %VLP_PASS(FPTN=VLP$PASS,
      241    13560        STCLASS="BASED(GLOBAL_PTRS.VLP$PASS$) DALIGNED");
      242    13573
      243    13574        %VLP_SN(FPTN=VLP$SN,
      244    13575        STCLASS="BASED(GLOBAL_PTRS.VLP$SN$)");
      245    13588
      246    13589        %VLP_WSN(FPTN=VLP$WSN,
      247    13590        STCLASS="BASED(GLOBAL_PTRS.VLP$WSN$) DALIGNED");
      248    13603
      249    13604        %VLP_NAME(FPTN=VLP$KEY,
      250    13605        STCLASS="BASED(GLOBAL_PTRS.VLP$KEY$) DALIGNED", LEN=31);
      251    13632
      252    13633    1   DCL VLP$DCBNUM UBIN WORD DALIGNED
      253    13634    1   BASED(GLOBAL_PTRS.VLP$DCBNUM$);
      254    13635
      255    13636        %VLP_NAME(FPTN=VLP$LKEY,
      256    13637        STCLASS="BASED(GLOBAL_PTRS.VLP$LKEY$) DALIGNED", LEN=1);
      257    13664
      258    13665        %VLP_NAME(FPTN=VLP$DEBUGGER,
      259    13666        STCLASS="BASED(GLOBAL_PTRS.VLP$DEBUGGER$) DALIGNED", LEN=15);
      260    13693
      261    13694        %VLP_NAME(FPTN=VLP$MSGTYP,
      262    13695        STCLASS="BASED(GLOBAL_PTRS.VLP$MSGTYP$) DALIGNED", LEN=8);
      263    13722
      264    13723        %VLP_NAME(FPTN=VLP$NAME_TRADER,
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:48   
      265    13724        STCLASS="BASED(GLOBAL_PTRS.VLP$NAME_TRADER$) DALIGNED", LEN=31);
      266    13751
      267    13752        %VLP_ACCT(FPTN=VLP$ACCT_TRADER,
      268    13753        STCLASS="BASED(GLOBAL_PTRS.VLP$ACCT_TRADER$) DALIGNED");
      269    13766
      270    13767        %FM$FIT(FM$FIT=VLP$IFPARAM_PASS_TRADER,
      271    13768        N=1,
      272    13769        BASED="BASED(GLOBAL_PTRS.VLP$IFPARAM_PASS_TRADER$)");
      273    13772
      274    13773        %CODE07(CODE07=VLP$CODE07_PASS_TRADER,
      275    13774        BASED="BASED(GLOBAL_PTRS.VLP$CODE07_PASS_TRADER$)");
      276    13777
      277    13778        %VLP_SN(FPTN=VLP$SN_TRADER,
      278    13779        STCLASS="BASED(GLOBAL_PTRS.VLP$SN_TRADER$)");
      279    13792
      280    13793        %VLP_VECTOR(FPTN=VLP$VECTOR,
      281    13794        STCLASS="BASED(GLOBAL_PTRS.VLP$VECTOR$)");
      282    13809
      283    13810        %VLP_NAME(FPTN=VLP$FID,
      284    13811        STCLASS="BASED(GLOBAL_PTRS.VLP$FID$) DALIGNED", LEN=99);
      285    13838
      286    13839        %VLP_STATION(FPTN=VLP$STATION,
      287    13840        STCLASS="BASED(GLOBAL_PTRS.VLP$STATION$)");
      288    13867
      289    13868        %VLP_SETSTA(FPTN=VLP$SETSTA,
      290    13869        STCLASS="BASED(GLOBAL_PTRS.VLP$SETSTA$)");
      291    13897
      292    13898        %VLP_VECTOR(FPTN=VLP$GDS,
      293    13899        STCLASS="BASED(GLOBAL_PTRS.VLP$GDS$)");
      294    13914
      295    13915    1   DCL VLP$ASN UBIN WORD DALIGNED BASED(GLOBAL_PTRS.VLP$ASN$);
      296    13916        %PAGE(ARG="VLRs");

             13933    1   /***************************************************************************
             13934    1    *                                                                         *
             13935    1    *                                    VLRs                                 *
             13936    1    *                                                                         *
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:49   
             13937    1    ***************************************************************************/

      297    13941
      298    13942    1   DCL VLP$TIME CHAR(11) DALIGNED
      299    13943    1   BASED(GLOBAL_PTRS.VLP$TIME$);
      300    13944        %VLR_FID(FPTN=VLR$FID,
      301    13945        STCLASS="BASED(GLOBAL_PTRS.VLR$FID$)");
      302    13964        %PAGE(ARG="QX$GLOBAL");

             13981    1   /***************************************************************************
             13982    1    *                                                                         *
             13983    1    *                                 QX$GLOBAL                               *
             13984    1    *                                                                         *
             13985    1    ***************************************************************************/

      303    13989        %QX$GLOBAL;
      304    14012        %PAGE(ARG="QXA$TPCP", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:50   
             14029    1   /***************************************************************************
             14030    1    *                                                                         *
             14031    1    *                                  QXA$TPCP                               *
             14032    1    *                                                                         *
             14033    1    ***************************************************************************/

      305    14037    1           IF B$JIT.CPFLAGS1 & '000000200000'O /* CP_INITIALIZE# */ THEN

  14037  2 000002   000000 470400 xsym               LDP0    B$JIT$
         2 000003   000143 236100                    LDQ     99,,PR0
         2 000004   000152 376000 1                  ANQ     FPT_CPEXIT+14
         2 000005   000011 600000 2                  TZE     s:14042

      306    14038    2             DO;

      307    14039    2               CALL QXA$INIT;

  14039  2 000006   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000007   000000 701000 xent               TSX1    QXA$INIT
         2 000010   000000 011000                    NOP     0

      308    14040    2             END;

      309    14041
      310    14042    1           GLOBAL_PTRS = GLOBAL$PTRS;

  14042  2 000011   000000 470400 xsym               LDP0    QX_GLOBAL
         2 000012   000100 100500                    MLR     fill='000'O
         2 000013   000000 000264                    ADSC9   0,,PR0                   cn=0,n=180
         2 000014   200012 000264                    ADSC9   GLOBAL_PTRS,,AUTO        cn=0,n=180

      311    14043
      312    14044    1           M$UC$ = DCBADDR(3 /* M$UC# */);

  14044  2 000015   000000 471400 3                  LDP1    0
         2 000016   100000 473500                    LDP3    0,,PR1
         2 000017   300003 236100                    LDQ     3,,PR3
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:51   
         2 000020   200070 756100                    STQ     M$UC$,,AUTO

      313    14045    1           FPT$CPEXIT = FPT_CPEXIT;

  14045  2 000021   200046 474500                    LDP4    GLOBAL_PTRS+28,,AUTO
         2 000022   000100 100400                    MLR     fill='000'O
         2 000023   000134 000070 1                  ADSC9   FPT_CPEXIT               cn=0,n=56
         2 000024   400000 000070                    ADSC9   0,,PR4                   cn=0,n=56

      314    14046    1           FPT$CPEXIT.V_ = VECTOR(FPT$CPEXIT.V);

  14046  2 000025   000001 235000 3                  LDA     1
         2 000026   200046 236100                    LDQ     GLOBAL_PTRS+28,,AUTO
         2 000027   000014 036003                    ADLQ    12,DU
         2 000030   400012 757100                    STAQ    10,,PR4

      315    14047
      316    14048    1           IF B$JIT.CPFLAGS1 & '000004000000'O /* CP_LASTCP# */ THEN

  14048  2 000031   000000 475400 xsym               LDP5    B$JIT$
         2 000032   500143 236100                    LDQ     99,,PR5
         2 000033   000022 376000 xsym               ANQ     B_VECTNIL+18
         2 000034   000036 600000 2                  TZE     s:14053

      317    14049    2             DO;

      318    14050    2               GOTO EXITT;

  14050  2 000035   000175 710000 2                  TRA     EXITT

      319    14051    2             END;
      320    14052
      321    14053    1           M$TPCP$ = DCBADDR(5 /* M$IBEX# */);

  14053  2 000036   300005 236100                    LDQ     5,,PR3
         2 000037   200071 756100                    STQ     M$TPCP$,,AUTO

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:52   
      322    14054    1           IF M$TPCP$ = ADDR(NIL) THEN

  14054  2 000040   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000041   000052 601000 2                  TNZ     s:14060

      323    14055    2             DO;

      324    14056    2               CALL M$GETDCB(FPT$GETDCB) ALTRET(MON_ERR);

  14056  2 000042   200044 470500                    LDP0    GLOBAL_PTRS+26,,AUTO
         2 000043   460002 713400                    CLIMB   alt,+24578
         2 000044   401000 401760                    pmme    nvectors=3
         2 000045   000201 702000 2                  TSX2    MON_ERR

      325    14057    2               M$TPCP$ = DCBADDR(5 /* M$IBEX# */);

  14057  2 000046   000000 470400 3                  LDP0    0
         2 000047   000000 471500                    LDP1    0,,PR0
         2 000050   100005 236100                    LDQ     5,,PR1
         2 000051   200071 756100                    STQ     M$TPCP$,,AUTO

      326    14058    2             END;

      327    14059
      328    14060    1           IF B$JIT.CPFLAGS1 & '400000000000'O /* CP_LOGOFF# */ OR

  14060  2 000052   000000 470400 xsym               LDP0    B$JIT$
         2 000053   000143 236100                    LDQ     99,,PR0
         2 000054   000030 376000 xsym               ANQ     B_VECTNIL+24
         2 000055   000061 601000 2                  TNZ     s:14063
         2 000056   000143 236100                    LDQ     99,,PR0
         2 000057   000004 376000 xsym               ANQ     B_VECTNIL+4
         2 000060   000074 600000 2                  TZE     s:14074

      329    14061    1               B$JIT.CPFLAGS1 & '000000000002'O /* CP_SCREECH# */ THEN
      330    14062    2             DO;

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:53   
      331    14063    2               IF B$JIT.CPFLAGS1 & '200000000000'O /* CP_JSTEP# */ THEN

  14063  2 000061   000143 236100                    LDQ     99,,PR0
         2 000062   000153 376000 1                  ANQ     FPT_CPEXIT+15
         2 000063   000070 600000 2                  TZE     s:14069

      332    14064    3                 DO;

      333    14065    3                   QX$GLOBAL.EXITING = '1'B;

  14065  2 000064   400000 236003                    LDQ     -131072,DU
         2 000065   200066 471500                    LDP1    GLOBAL_PTRS+44,,AUTO
         2 000066   100003 756100                    STQ     3,,PR1

      334    14066    3                 END;

  14066  2 000067   000073 710000 2                  TRA     s:14071

      335    14067    2               ELSE
      336    14068    3                 DO;

      337    14069    3                   FPT$CPEXIT.V.QUIT# = '1'B;

  14069  2 000070   200046 471500                    LDP1    GLOBAL_PTRS+28,,AUTO
         2 000071   200000 236003                    LDQ     65536,DU
         2 000072   100014 256100                    ORSQ    12,,PR1

      338    14070    3                 END;

      339    14071    2               GOTO CLEAN_UP;

  14071  2 000073   000125 710000 2                  TRA     CLEAN_UP

      340    14072    2             END;
      341    14073
      342    14074    1           IF B$JIT.CPFLAGS1 & '020000000000'O /* CP_YCPMME# */ THEN

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:54   
  14074  2 000074   000143 236100                    LDQ     99,,PR0
         2 000075   000154 376000 1                  ANQ     FPT_CPEXIT+16
         2 000076   000101 600000 2                  TZE     s:14079

      343    14075    2             DO;

      344    14076    2               CALL YC_PMME;

  14076  2 000077   001270 701000 2                  TSX1    YC_PMME
         2 000100   000000 011000                    NOP     0

      345    14077    2             END;

      346    14078
      347    14079    1           IF B$JIT.CPFLAGS1 & '004000000000'O /* CP_LNKPMME# */ THEN

  14079  2 000101   000000 470400 xsym               LDP0    B$JIT$
         2 000102   000143 236100                    LDQ     99,,PR0
         2 000103   000155 376000 1                  ANQ     FPT_CPEXIT+17
         2 000104   000110 600000 2                  TZE     s:14085

      348    14080    2             DO;

      349    14081    2               CALL LNK_PMME;

  14081  2 000105   001534 701000 2                  TSX1    LNK_PMME
         2 000106   000000 011000                    NOP     0

      350    14082    2               GOTO CLEAN_UP;

  14082  2 000107   000125 710000 2                  TRA     CLEAN_UP

      351    14083    2             END;
      352    14084
      353    14085    1           IF B$JIT.USRRNST ~= '0'B THEN

  14085  2 000110   000145 236100                    LDQ     101,,PR0
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:55   
         2 000111   777000 316007                    CANQ    -512,DL
         2 000112   000117 600000 2                  TZE     s:14091

      354    14086    2             DO;

      355    14087    2               B$JIT.USRRNST = '0'B;

  14087  2 000113   000000 236003                    LDQ     0,DU
         2 000114   000145 552110                    STBQ    101,'10'O,PR0

      356    14088    2               CALL USER_ABORTED;

  14088  2 000115   001174 701000 2                  TSX1    USER_ABORTED
         2 000116   000000 011000                    NOP     0

      357    14089    2             END;

      358    14090
      359    14091    1           IF B$JIT.CPFLAGS1 & '200000000000'O /* %CP_JSTEP# */ THEN

  14091  2 000117   000000 470400 xsym               LDP0    B$JIT$
         2 000120   000143 236100                    LDQ     99,,PR0
         2 000121   000153 376000 1                  ANQ     FPT_CPEXIT+15
         2 000122   000125 600000 2                  TZE     CLEAN_UP

      360    14092    2             DO;

      361    14093    2               CALL GET_NEXT_XACTION;

  14093  2 000123   000213 701000 2                  TSX1    GET_NEXT_XACTION
         2 000124   000000 011000                    NOP     0

      362    14094    2             END;

      363    14095
      364    14096    1   CLEAN_UP:
      365    14097    1           IF QX$GLOBAL.EXITING THEN
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:56   

  14097  2 000125   200066 470500       CLEAN_UP     LDP0    GLOBAL_PTRS+44,,AUTO
         2 000126   000003 234100                    SZN     3,,PR0
         2 000127   000146 605000 2                  TPL     s:14109

      366    14098    2             DO;

      367    14099    2               CALL ACCOUNTING;

  14099  2 000130   001544 701000 2                  TSX1    ACCOUNTING
         2 000131   000000 011000                    NOP     0

      368    14100
      369    14101    2               FPT$OCMSG.V.MSG# = TPUSEROFF_MSG#;

  14101  2 000132   000330 235007                    LDA     216,DL
         2 000133   200061 470500                    LDP0    GLOBAL_PTRS+39,,AUTO
         2 000134   000006 755100                    STA     6,,PR0

      370    14102    2               IF B$JIT.CPFLAGS1 & '000000000002'O /* CP_SCREECH# */ THEN

  14102  2 000135   000000 471400 xsym               LDP1    B$JIT$
         2 000136   100143 236100                    LDQ     99,,PR1
         2 000137   000004 376000 xsym               ANQ     B_VECTNIL+4
         2 000140   000143 600000 2                  TZE     s:14106

      371    14103    3                 DO;

      372    14104    3                   FPT$OCMSG.V.SUBC# = 1;

  14104  2 000141   000001 236003                    LDQ     1,DU
         2 000142   000007 552120                    STBQ    7,'20'O,PR0

      373    14105    3                 END;

      374    14106    2               CALL M$OCMSG(FPT$OCMSG) ALTRET(MON_ERR);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:57   
  14106  2 000143   520001 713400                    CLIMB   alt,+40961
         2 000144   401000 401760                    pmme    nvectors=3
         2 000145   000201 702000 2                  TSX2    MON_ERR

      375    14107    2             END;

      376    14108
      377    14109    1           CALL M$RELDCB(FPT$RELDCB) ALTRET(MON_ERR);

  14109  2 000146   200045 470500                    LDP0    GLOBAL_PTRS+27,,AUTO
         2 000147   460003 713400                    CLIMB   alt,+24579
         2 000150   400000 401760                    pmme    nvectors=1
         2 000151   000201 702000 2                  TSX2    MON_ERR

      378    14110
      379    14111                                 /*  check to see if M$IBEX1 needs to be released     */
      380    14112    1           IF DCBADDR(6) ~= ADDR(NIL) THEN

  14112  2 000152   000000 470400 3                  LDP0    0
         2 000153   000000 471500                    LDP1    0,,PR0
         2 000154   100006 236100                    LDQ     6,,PR1
         2 000155   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000156   000175 600000 2                  TZE     EXITT

      381    14113    2             DO;

      382    14114    2               FPT$RELDCB_CPSL = FPT_RELDCB_CPSL;

  14114  2 000157   000100 100400                    MLR     fill='000'O
         2 000160   000114 000020 1                  ADSC9   FPT_RELDCB_CPSL          cn=0,n=16
         2 000161   200204 000020                    ADSC9   FPT$RELDCB_CPSL,,AUTO    cn=0,n=16

      383    14115    2               FPT$RELDCB_CPSL.V_ = VECTOR(FPT$RELDCB_CPSL.V);

  14115  2 000162   000001 235000 3                  LDA     1
         2 000163   200224 452500                    STP2    FPT$GETDCB_CPSL+12,,AUTO
         2 000164   200224 236100                    LDQ     FPT$GETDCB_CPSL+12,,AUTO
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:58   
         2 000165   000206 036003                    ADLQ    134,DU
         2 000166   200204 757100                    STAQ    FPT$RELDCB_CPSL,,AUTO

      384    14116    2               FPT$RELDCB_CPSL.V.DCB# = 6 /* M$IBEX1# */;

  14116  2 000167   000006 220003                    LDX0    6,DU
         2 000170   200206 740100                    STX0    FPT$RELDCB_CPSL+2,,AUTO

      385    14117    2               CALL M$RELDCB(FPT$RELDCB_CPSL) ALTRET(MON_ERR);

  14117  2 000171   200204 630500                    EPPR0   FPT$RELDCB_CPSL,,AUTO
         2 000172   460003 713400                    CLIMB   alt,+24579
         2 000173   400000 401760                    pmme    nvectors=1
         2 000174   000201 702000 2                  TSX2    MON_ERR

      386    14118    2             END;

      387    14119
      388    14120    1   EXITT:
      389    14121    1           CALL M$CPEXIT(FPT$CPEXIT) ALTRET(MON_ERR);

  14121  2 000175   200046 470500       EXITT        LDP0    GLOBAL_PTRS+28,,AUTO
         2 000176   400012 713400                    CLIMB   alt,+10
         2 000177   402400 401760                    pmme    nvectors=6
         2 000200   000201 702000 2                  TSX2    MON_ERR

      390    14122
      391    14123    1   MON_ERR:
      392    14124    1           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14124  2 000201   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         2 000202   000000 471500                    LDP1    0,,PR0
         2 000203   100102 236100                    LDQ     66,,PR1
         2 000204   000000 473400 xsym               LDP3    B$JIT$
         2 000205   300144 756100                    STQ     100,,PR3

      393    14125    1           CALL QXC$SCREECH(750, '01'O, 5);
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:59   

  14125  2 000206   000004 630400 3                  EPPR0   4
         2 000207   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000210   000000 701000 xent               TSX1    QXC$SCREECH
         2 000211   000000 011000                    NOP     0
         2 000212   001766 710000 2                  TRA     s:14770

      394    14126                %PAGE(ARG="GET_NEXT_XACTION", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:60   
             14143    1   /***************************************************************************
             14144    1    *                                                                         *
             14145    1    *                              GET_NEXT_XACTION                           *
             14146    1    *                                                                         *
             14147    1    ***************************************************************************/

      395    14151    1   GET_NEXT_XACTION:

  14151  2 000213   200220 741300       GET_NEXT_XA* STX1  ! FPT$GETDCB_CPSL+8,,AUTO

      396    14152    1           PROC;
      397    14153
      398    14154    2           CHAR_STRING_SIZE = 7;

  14154  2 000214   000007 235007                    LDA     7,DL
         2 000215   200003 755100                    STA     CHAR_STRING_SIZE,,AUTO

      399    14155    2           PINCRC(ADDR(B$JIT.CCBUF), B$JIT.CCARS) -> CHAR$STRING ='(empty)';

  14155  2 000216   000000 470400 xsym               LDP0    B$JIT$
         2 000217   000032 236100                    LDQ     26,,PR0
         2 000220   000022 732000                    QRS     18
         2 000221   000000 620005                    EAX0    0,AL
         2 000222   040146 100400                    MLR     fill='040'O
         2 000223   000156 000007 1                  ADSC9   FPT_CPEXIT+18            cn=0,n=7
         2 000224   000033 000010                    ADSC9   27,Q,PR0                 cn=0,n=*X0

      400    14156
      401    14157                 /*  TPA went away -- M$UC was closed and scrubbed, so
      402    14158                     SETSTA$ will be addr(nil) -- EXIT!!!
      403    14159                 */
      404    14160    2           IF M$UC$ -> F$DCB.SETSTA$ = ADDR(NIL) THEN

  14160  2 000225   200070 470500                    LDP0    M$UC$,,AUTO
         2 000226   000006 236100                    LDQ     6,,PR0
         2 000227   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000230   000235 601000 2                  TNZ     s:14167
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:61   

      405    14161    3             DO;

      406    14162
      407    14163    3               QX$GLOBAL.EXITING = '1'B;

  14163  2 000231   400000 236003                    LDQ     -131072,DU
         2 000232   200066 471500                    LDP1    GLOBAL_PTRS+44,,AUTO
         2 000233   100003 756100                    STQ     3,,PR1

      408    14164    3               GOTO RET;

  14164  2 000234   000717 710000 2                  TRA     RET

      409    14165
      410    14166    3             END;
      411    14167    2           VLP$SETSTA = VLP_SETSTA_UNLOCKED;

  14167  2 000235   200034 471500                    LDP1    GLOBAL_PTRS+18,,AUTO
         2 000236   000100 100400                    MLR     fill='000'O
         2 000237   000003 000060 1                  ADSC9   VLP_SETSTA_UNLOCKED      cn=0,n=48
         2 000240   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      412    14168    2           VLP$SETSTA.MYSTATION# = M$UC$ -> F$DCB.SETSTA$ ->

  14168  2 000241   000006 473500                    LDP3    6,,PR0
         2 000242   040100 100500                    MLR     fill='040'O
         2 000243   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         2 000244   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8

      413    14169    2               VLP$SETSTA.MYSTATION#;
      414    14170    2           QX$GLOBAL.SETSTA_LOCKED = '0'B;

  14170  2 000245   200066 473500                    LDP3    GLOBAL_PTRS+44,,AUTO
         2 000246   300001 450100                    STZ     1,,PR3

      415    14171
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:62   
      416    14172                                 /* If TPA goes away before activating him we will    */
      417    14173                                                /* get a E$NDCBCG error               */
      418    14174
      419    14175    2           CALL M$OPEN(FPT$OPEN_CG) ALTRET(OPEN_ERR);

  14175  2 000247   200060 470500                    LDP0    GLOBAL_PTRS+38,,AUTO
         2 000250   450000 713400                    CLIMB   alt,open
         2 000251   410400 401760                    pmme    nvectors=18
         2 000252   000254 702000 2                  TSX2    OPEN_ERR

      420    14176
      421    14177    3           DO WHILE('0'B);

  14177  2 000253   000272 710000 2                  TRA     READ_CG

      422    14178
      423    14179    3   OPEN_ERR:
      424    14180    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 876 /* E$NDCBCG */ OR

  14180  2 000254   000000 470400 xsym  OPEN_ERR     LDP0    B$TCB$
         2 000255   000000 471500                    LDP1    0,,PR0
         2 000256   100102 236100                    LDQ     66,,PR1
         2 000257   377770 376007                    ANQ     131064,DL
         2 000260   015540 116007                    CMPQ    7008,DL
         2 000261   000265 601000 2                  TNZ     s:14183
         2 000262   000000 473400 xsym               LDP3    B$JIT$
         2 000263   300315 720100                    LXL0    205,,PR3
         2 000264   000266 604400 2                  TMOZ    s:14186

      425    14181    3                 B$JIT.STEPS > 0 THEN
      426    14182    4               DO;

      427    14183    4                 GOTO MON_ERR;

  14183  2 000265   000731 710000 2                  TRA     MON_ERR

      428    14184    4               END;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:63   
      429    14185
      430    14186    3             QX$GLOBAL.EXITING = '1'B;

  14186  2 000266   400000 236003                    LDQ     -131072,DU
         2 000267   200066 474500                    LDP4    GLOBAL_PTRS+44,,AUTO
         2 000270   400003 756100                    STQ     3,,PR4

      431    14187    3             GOTO RET;

  14187  2 000271   000717 710000 2                  TRA     RET

      432    14188    3           END /* NEVER */;

      433    14189
      434    14190    2   READ_CG:
      435    14191    2           VLP$STATION = VLP_STATION;

  14191  2 000272   200033 470500       READ_CG      LDP0    GLOBAL_PTRS+17,,AUTO
         2 000273   000100 100400                    MLR     fill='000'O
         2 000274   000033 000040 1                  ADSC9   VLP_STATION              cn=0,n=32
         2 000275   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32

      436    14192    2           VLP$STATION.MSGTYP# = VLP$MSGTYP.NAME#;

  14192  2 000276   200023 471500                    LDP1    GLOBAL_PTRS+9,,AUTO
         2 000277   040100 100500                    MLR     fill='040'O
         2 000300   100000 200010                    ADSC9   0,,PR1                   cn=1,n=8
         2 000301   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

      437    14193    2           CHAR_STRING = VLP$MSGTYP.NAME#;

  14193  2 000302   040100 100500                    MLR     fill='040'O
         2 000303   100000 200010                    ADSC9   0,,PR1                   cn=1,n=8
         2 000304   200007 000010                    ADSC9   CHAR_STRING,,AUTO        cn=0,n=8

      438    14194
      439    14195    2           IF QX$GLOBAL.NOW THEN
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:64   

  14195  2 000305   200066 473500                    LDP3    GLOBAL_PTRS+44,,AUTO
         2 000306   300006 234100                    SZN     6,,PR3
         2 000307   000311 605000 2                  TPL     s:14200

      440    14196    3             DO;

      441    14197    3               GOTO SET_VLP_TRADER;

  14197  2 000310   000341 710000 2                  TRA     SET_VLP_TRADER

      442    14198    3             END;
      443    14199
      444    14200    2           CALL M$READ(FPT$READ_CG) ALTRET(READ_CG_ERR);

  14200  2 000311   200055 470500                    LDP0    GLOBAL_PTRS+35,,AUTO
         2 000312   440000 713400                    CLIMB   alt,read
         2 000313   401400 401760                    pmme    nvectors=4
         2 000314   000316 702000 2                  TSX2    READ_CG_ERR

      445    14201
      446    14202    3           DO WHILE('0'B);

  14202  2 000315   000341 710000 2                  TRA     SET_VLP_TRADER

      447    14203
      448    14204    3   READ_CG_ERR:
      449    14205    3             ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14205  2 000316   000000 470400 xsym  READ_CG_ERR  LDP0    B$TCB$
         2 000317   000000 471500                    LDP1    0,,PR0
         2 000320   100102 236100                    LDQ     66,,PR1
         2 000321   200131 756100                    STQ     ERR,,AUTO

      450    14206    3             IF ERR.CODE = 6 /* E$EOF */ OR ERR.CODE = 13 /* E$DACTR */ OR

  14206  2 000322   200131 236100                    LDQ     ERR,,AUTO
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:65   
         2 000323   377770 376007                    ANQ     131064,DL
         2 000324   000060 116007                    CMPQ    48,DL
         2 000325   000332 600000 2                  TZE     s:14209
         2 000326   000150 116007                    CMPQ    104,DL
         2 000327   000332 600000 2                  TZE     s:14209
         2 000330   015740 116007                    CMPQ    7136,DL
         2 000331   000336 601000 2                  TNZ     s:14213

      451    14207    3                 ERR.CODE = 892 /* E$CGORAU */ THEN
      452    14208    4               DO;

      453    14209    4                 QX$GLOBAL.EXITING = '1'B;

  14209  2 000332   400000 236003                    LDQ     -131072,DU
         2 000333   200066 473500                    LDP3    GLOBAL_PTRS+44,,AUTO
         2 000334   300003 756100                    STQ     3,,PR3

      454    14210    4                 GOTO RET;

  14210  2 000335   000717 710000 2                  TRA     RET

      455    14211    4               END;
      456    14212
      457    14213    3             IF ERR.CODE ~= 7 /* E$LD */ THEN

  14213  2 000336   000070 116007                    CMPQ    56,DL
         2 000337   000341 600000 2                  TZE     SET_VLP_TRADER

      458    14214    4               DO;

      459    14215    4                 GOTO MON_ERR;

  14215  2 000340   000731 710000 2                  TRA     MON_ERR

      460    14216    4               END;
      461    14217    3           END /* NEVER */;

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:66   
      462    14218
      463    14219    2   SET_VLP_TRADER:
      464    14220    2           IF NOT M$TPCP$ -> F$DCB.FCD# THEN

  14220  2 000341   200071 470500       SET_VLP_TRA* LDP0    M$TPCP$,,AUTO
         2 000342   000031 236100                    LDQ     25,,PR0
         2 000343   020000 316007                    CANQ    8192,DL
         2 000344   000376 601000 2                  TNZ     s:14233

      465    14221    3             DO;

      466    14222    3               VLP$NAME = VLP$NAME_TRADER;

  14222  2 000345   200024 471500                    LDP1    GLOBAL_PTRS+10,,AUTO
         2 000346   200012 473500                    LDP3    GLOBAL_PTRS,,AUTO
         2 000347   000100 100500                    MLR     fill='000'O
         2 000350   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
         2 000351   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32

      467    14223    3               VLP$ACCT = VLP$ACCT_TRADER;

  14223  2 000352   200025 474500                    LDP4    GLOBAL_PTRS+11,,AUTO
         2 000353   400000 237100                    LDAQ    0,,PR4
         2 000354   200013 475500                    LDP5    GLOBAL_PTRS+1,,AUTO
         2 000355   500000 757100                    STAQ    0,,PR5

      468    14224    3               ADDR(FPT$OPEN_FILE.IFPARAM_) -> VLP$VECTOR.PTR$ =

  14224  2 000356   200026 236100                    LDQ     GLOBAL_PTRS+12,,AUTO
         2 000357   200051 476500                    LDP6    GLOBAL_PTRS+31,,AUTO
         2 000360   600027 756100                    STQ     23,,PR6

      469    14225    3                   ADDR(VLP$IFPARAM_PASS_TRADER);
      470    14226    3               ADDR(FPT$OPEN_FILE.IFPARAM_) -> VLP$VECTOR.W1.VSIZE# =

  14226  2 000361   600026 236100                    LDQ     22,,PR6
         2 000362   177777 376007                    ANQ     65535,DL
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:67   
         2 000363   000007 276000 3                  ORQ     7
         2 000364   600026 756100                    STQ     22,,PR6

      471    14227    3                   SIZEV(VLP$IFPARAM_PASS_TRADER) +
      472    14228    3                   SIZEC(VLP$CODE07_PASS_TRADER);
      473    14229    3               VLP$SN = VLP$SN_TRADER;

  14229  2 000365   200030 477500                    LDP7    GLOBAL_PTRS+14,,AUTO
         2 000366   200015 470500                    LDP0    GLOBAL_PTRS+3,,AUTO
         2 000367   000100 100500                    MLR     fill='000'O
         2 000370   700000 000012                    ADSC9   0,,PR7                   cn=0,n=10
         2 000371   000000 000012                    ADSC9   0,,PR0                   cn=0,n=10

      474    14230    3               CALL M$OPEN(FPT$OPEN_FILE) ALTRET(MON_ERR);

  14230  2 000372   600000 630500                    EPPR0   0,,PR6
         2 000373   450000 713400                    CLIMB   alt,open
         2 000374   410400 401760                    pmme    nvectors=18
         2 000375   000731 702000 2                  TSX2    MON_ERR

      475    14231    3             END;

      476    14232
      477    14233    2           IF QX$GLOBAL.NOW THEN

  14233  2 000376   200066 470500                    LDP0    GLOBAL_PTRS+44,,AUTO
         2 000377   000006 234100                    SZN     6,,PR0
         2 000400   000411 605000 2                  TPL     s:14239

      478    14234    3             DO;

      479    14235    3               CALL CONCAT(VLP$KEY.NAME#,CHAR_STRING,'_E');

  14235  2 000401   200017 471500                    LDP1    GLOBAL_PTRS+5,,AUTO
         2 000402   040100 100500                    MLR     fill='040'O
         2 000403   200007 000010                    ADSC9   CHAR_STRING,,AUTO        cn=0,n=8
         2 000404   100000 200010                    ADSC9   0,,PR1                   cn=1,n=8
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:68   
         2 000405   040100 100400                    MLR     fill='040'O
         2 000406   000160 000002 1                  ADSC9   FPT_CPEXIT+20            cn=0,n=2
         2 000407   100002 200027                    ADSC9   2,,PR1                   cn=1,n=23

      480    14236    3             END;

  14236  2 000410   000422 710000 2                  TRA     s:14243

      481    14237    2           ELSE
      482    14238    3             DO;

      483    14239    3               CALL CONCAT(VLP$KEY.NAME#,

  14239  2 000411   200070 471500                    LDP1    M$UC$,,AUTO
         2 000412   100007 473500                    LDP3    7,,PR1
         2 000413   200017 474500                    LDP4    GLOBAL_PTRS+5,,AUTO
         2 000414   040100 100500                    MLR     fill='040'O
         2 000415   300002 000010                    ADSC9   2,,PR3                   cn=0,n=8
         2 000416   400000 200010                    ADSC9   0,,PR4                   cn=1,n=8
         2 000417   040100 100400                    MLR     fill='040'O
         2 000420   000160 000002 1                  ADSC9   FPT_CPEXIT+20            cn=0,n=2
         2 000421   400002 200027                    ADSC9   2,,PR4                   cn=1,n=23

      484    14240    3                   M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGTYP#,
      485    14241    3                   '_E');
      486    14242    3             END;

      487    14243    2           VLP$KEY.L# = 10;

  14243  2 000422   200017 470500                    LDP0    GLOBAL_PTRS+5,,AUTO
         2 000423   012000 236003                    LDQ     5120,DU
         2 000424   000000 552140                    STBQ    0,'40'O,PR0

      488    14244
      489    14245    2   READ_TRADER:
      490    14246    2           CALL M$READ(FPT$READ_KEY) ALTRET(READ_TRADER_ERR);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:69   
  14246  2 000425   200042 470500       READ_TRADER  LDP0    GLOBAL_PTRS+24,,AUTO
         2 000426   440000 713400                    CLIMB   alt,read
         2 000427   401400 401760                    pmme    nvectors=4
         2 000430   000436 702000 2                  TSX2    READ_TRADER_ERR

      491    14247    2           CALL M$CLOSE(FPT$CLOSE) ALTRET(MON_ERR);

  14247  2 000431   200053 470500                    LDP0    GLOBAL_PTRS+33,,AUTO
         2 000432   450001 713400                    CLIMB   alt,close
         2 000433   406000 401760                    pmme    nvectors=13
         2 000434   000731 702000 2                  TSX2    MON_ERR

      492    14248
      493    14249    3           DO WHILE('0'B);

  14249  2 000435   000523 710000 2                  TRA     s:14276

      494    14250
      495    14251    3   READ_TRADER_ERR:
      496    14252    3             ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14252  2 000436   000000 470400 xsym  READ_TRADER* LDP0    B$TCB$
         2 000437   000000 471500                    LDP1    0,,PR0
         2 000440   100102 236100                    LDQ     66,,PR1
         2 000441   200131 756100                    STQ     ERR,,AUTO

      497    14253    3             IF ERR.CODE = 7 /* E$LD */ THEN

  14253  2 000442   200131 236100                    LDQ     ERR,,AUTO
         2 000443   377770 376007                    ANQ     131064,DL
         2 000444   000070 116007                    CMPQ    56,DL
         2 000445   000466 601000 2                  TNZ     s:14261

      498    14254    4               DO;

      499    14255    4                 CALL M$GDS(FPT$GDS) ALTRET(MON_ERR);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:70   
  14255  2 000446   200047 470500                    LDP0    GLOBAL_PTRS+29,,AUTO
         2 000447   430001 713400                    CLIMB   alt,gds
         2 000450   400400 401760                    pmme    nvectors=2
         2 000451   000731 702000 2                  TSX2    MON_ERR

      500    14256    4                 CHAR_STRING_SIZE = VLP$GDS.W1.VSIZE# + 1;

  14256  2 000452   200035 470500                    LDP0    GLOBAL_PTRS+19,,AUTO
         2 000453   000000 236100                    LDQ     0,,PR0
         2 000454   000020 772000                    QRL     16
         2 000455   000001 036007                    ADLQ    1,DL
         2 000456   200003 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      501    14257    4                 FPT$READ_KEY.BUF_ = VECTOR(QX_GLOBAL.QT$ENTRY$ -> CHAR$STRING);

  14257  2 000457   200003 235100                    LDA     CHAR_STRING_SIZE,,AUTO
         2 000460   000020 735000                    ALS     16
         2 000461   000140 135007                    SBLA    96,DL
         2 000462   000001 236000 xsym               LDQ     QX_GLOBAL+1
         2 000463   200042 471500                    LDP1    GLOBAL_PTRS+24,,AUTO
         2 000464   100004 757100                    STAQ    4,,PR1

      502    14258    4                 GOTO READ_TRADER;

  14258  2 000465   000425 710000 2                  TRA     READ_TRADER

      503    14259    4               END;
      504    14260
      505    14261    3             IF ERR.CODE = 66 /* E$NOKEY */ AND

  14261  2 000466   001020 116007                    CMPQ    528,DL
         2 000467   000522 601000 2                  TNZ     s:14273
         2 000470   200066 473500                    LDP3    GLOBAL_PTRS+44,,AUTO
         2 000471   300006 234100                    SZN     6,,PR3
         2 000472   000522 604000 2                  TMI     s:14273

      506    14262    3                 NOT QX$GLOBAL.NOW THEN
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:71   
      507    14263    4               DO;

      508    14264        /* PUT THE XACTION ON HOLD */
      509    14265    4                 CALL M$UNLATCH(FPT$UNLATCH) ALTRET(MON_ERR);

  14265  2 000473   200054 470500                    LDP0    GLOBAL_PTRS+34,,AUTO
         2 000474   500002 713400                    CLIMB   alt,+32770
         2 000475   401000 401760                    pmme    nvectors=3
         2 000476   000731 702000 2                  TSX2    MON_ERR

      510    14266    4                 CALL QXC$BLDMSG_ERRBLK(MSGBLK);

  14266  2 000477   200104 630500                    EPPR0   MSGBLK,,AUTO
         2 000500   200224 450500                    STP0    FPT$GETDCB_CPSL+12,,AUTO
         2 000501   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 000502   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000503   000000 701000 xent               TSX1    QXC$BLDMSG_ERRBLK
         2 000504   000000 011000                    NOP     0

      511    14267    4                 MSGBLK.FLAGS.HDR = HDR_FLAGS_UNDEF_XACT;

  14267  2 000505   000000 236000 1                  LDQ     HDR_FLAGS_UNDEF_XACT
         2 000506   200106 676100                    ERQ     MSGBLK+2,,AUTO
         2 000507   777600 376003                    ANQ     -128,DU
         2 000510   200106 656100                    ERSQ    MSGBLK+2,,AUTO

      512    14268    4                 MSGBLK.ERRINFO.ERR(0) = CODE_MISSING_REC;

  14268  2 000511   000131 236000 1                  LDQ     CODE_MISSING_REC
         2 000512   200112 756100                    STQ     MSGBLK+6,,AUTO

      513    14269    4                 CALL QXC$BLDMSG(MSGBLK);

  14269  2 000513   200104 630500                    EPPR0   MSGBLK,,AUTO
         2 000514   200224 450500                    STP0    FPT$GETDCB_CPSL+12,,AUTO
         2 000515   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 000516   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:72   
         2 000517   000000 701000 xent               TSX1    QXC$BLDMSG
         2 000520   000000 011000                    NOP     0

      514    14270    4                 GOTO READ_CG;

  14270  2 000521   000272 710000 2                  TRA     READ_CG

      515    14271    4               END;
      516    14272
      517    14273    3             GOTO MON_ERR;

  14273  2 000522   000731 710000 2                  TRA     MON_ERR

      518    14274    3           END /* NEVER */;

      519    14275
      520    14276    2           VLP$SETSTA = VLP_SETSTA_LOCKED;

  14276  2 000523   200034 470500                    LDP0    GLOBAL_PTRS+18,,AUTO
         2 000524   000100 100400                    MLR     fill='000'O
         2 000525   000017 000060 1                  ADSC9   VLP_SETSTA_LOCKED        cn=0,n=48
         2 000526   000000 000060                    ADSC9   0,,PR0                   cn=0,n=48

      521    14277    2           IF QX$GLOBAL.NOW THEN

  14277  2 000527   200066 471500                    LDP1    GLOBAL_PTRS+44,,AUTO
         2 000530   100006 234100                    SZN     6,,PR1
         2 000531   000544 605000 2                  TPL     s:14286

      522    14278    3             DO;

      523    14279    3               VLP$SETSTA.ISTA.IMSGTYP# = CHAR_STRING;

  14279  2 000532   040100 100500                    MLR     fill='040'O
         2 000533   200007 000010                    ADSC9   CHAR_STRING,,AUTO        cn=0,n=8
         2 000534   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:73   
      524    14280    3               VLP$SETSTA.MYSTATION# = M$UC$ -> F$DCB.SETSTA$ ->

  14280  2 000535   200070 473500                    LDP3    M$UC$,,AUTO
         2 000536   300006 474500                    LDP4    6,,PR3
         2 000537   040100 100500                    MLR     fill='040'O
         2 000540   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         2 000541   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

      525    14281    3                   VLP$SETSTA.MYSTATION#;
      526    14282    3               QX$GLOBAL.NOW = '0'B;

  14282  2 000542   100006 450100                    STZ     6,,PR1

      527    14283    3             END;

  14283  2 000543   000551 710000 2                  TRA     s:14290

      528    14284    2           ELSE
      529    14285    3             DO;

      530    14286    3               VLP$SETSTA.ISTA.IMSGTYP# =

  14286  2 000544   200070 473500                    LDP3    M$UC$,,AUTO
         2 000545   300007 474500                    LDP4    7,,PR3
         2 000546   040100 100500                    MLR     fill='040'O
         2 000547   400002 000010                    ADSC9   2,,PR4                   cn=0,n=8
         2 000550   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

      531    14287    3                   M$UC$ -> F$DCB.LASTSTA$ -> VLP$STATION.MSGTYP#;
      532    14288    3             END;

      533    14289
      534    14290    2           IF NOT QT$ENTRY.FLAGS.NEW_LOCK THEN

  14290  2 000551   000001 474400 xsym               LDP4    QX_GLOBAL+1
         2 000552   400000 236100                    LDQ     0,,PR4
         2 000553   100000 316003                    CANQ    32768,DU
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:74   
         2 000554   000560 601000 2                  TNZ     s:14296

      535    14291    3             DO;

      536    14292    3               VLP$SETSTA.ISTA.ILOCK# = '0'B;

  14292  2 000555   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 000556   000006 356100                    ANSQ    6,,PR0

      537    14293    3               VLP$SETSTA.OSTA.OLOCK# = '0'B;

  14293  2 000557   000013 356100                    ANSQ    11,,PR0

      538    14294    3             END;

      539    14295
      540    14296    2           IF QX$GLOBAL.PERM OR (QX$GLOBAL.SEMIPERM AND

  14296  2 000560   100005 234100                    SZN     5,,PR1
         2 000561   000566 604000 2                  TMI     s:14299
         2 000562   100004 234100                    SZN     4,,PR1
         2 000563   000600 605000 2                  TPL     s:14308
         2 000564   100007 235100                    LDA     7,,PR1
         2 000565   000600 600000 2                  TZE     s:14308

      541    14297    2               (QX$GLOBAL.TIMEOUT > 0)) THEN
      542    14298    3             DO;

      543    14299    3               VLP$SETSTA.ISTA.EOFNONE# = '0'B;

  14299  2 000566   000010 236000 3                  LDQ     8
         2 000567   000006 356100                    ANSQ    6,,PR0

      544    14300    3               VLP$SETSTA.ISTA.EOFONE# = '0'B;

  14300  2 000570   000011 236000 3                  LDQ     9
         2 000571   000006 356100                    ANSQ    6,,PR0
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:75   

      545    14301    3               IF QX$GLOBAL.TIMEOUT > 0 THEN /* TIMEOUT option specified         */

  14301  2 000572   100007 235100                    LDA     7,,PR1
         2 000573   000600 600000 2                  TZE     s:14308

      546    14302    3                 VLP$SETSTA.ISTA.EOFTIME# = 60 * QX$GLOBAL.TIMEOUT;

  14302  2 000574   100007 236100                    LDQ     7,,PR1
         2 000575   000074 402007                    MPY     60,DL
         2 000576   000000 620006                    EAX0    0,QL
         2 000577   000006 440100                    SXL0    6,,PR0

      547    14303                            /* TIMEOUT is expressed in minutes, EOFTIME# in seconds   */
      548    14304
      549    14305    3             END;

      550    14306
      551    14307
      552    14308    2           CALL M$OPEN(FPT$OPEN_CG) ALTRET(MON_ERR);

  14308  2 000600   200060 470500                    LDP0    GLOBAL_PTRS+38,,AUTO
         2 000601   450000 713400                    CLIMB   alt,open
         2 000602   410400 401760                    pmme    nvectors=18
         2 000603   000731 702000 2                  TSX2    MON_ERR

      553    14309    2           QX$GLOBAL.SETSTA_LOCKED = '1'B;

  14309  2 000604   400000 236003                    LDQ     -131072,DU
         2 000605   200066 470500                    LDP0    GLOBAL_PTRS+44,,AUTO
         2 000606   000001 756100                    STQ     1,,PR0

      554    14310
      555    14311    2           IF QX$GLOBAL.SETS OR QT$ENTRY.FLAGS.DCBS_SET THEN

  14311  2 000607   000000 234100                    SZN     0,,PR0
         2 000610   000614 604000 2                  TMI     s:14313
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:76   
         2 000611   000001 471400 xsym               LDP1    QX_GLOBAL+1
         2 000612   100000 234100                    SZN     0,,PR1
         2 000613   000616 605000 2                  TPL     s:14316

      556    14312    3             DO;

      557    14313    3               CALL BUILD_STARA ALTRET(MON_ERR);

  14313  2 000614   000744 701000 2                  TSX1    BUILD_STARA
         2 000615   000731 702000 2                  TSX2    MON_ERR

      558    14314    3             END;

      559    14315
      560    14316    2           FPT$CPEXIT.NAME_ = VECTOR(VLP$NAME);

  14316  2 000616   000012 235000 3                  LDA     10
         2 000617   200012 236100                    LDQ     GLOBAL_PTRS,,AUTO
         2 000620   200046 470500                    LDP0    GLOBAL_PTRS+28,,AUTO
         2 000621   000000 757100                    STAQ    0,,PR0

      561    14317    2           VLP$NAME = QT$ENTRY.TPAP.NAME;

  14317  2 000622   000001 471400 xsym               LDP1    QX_GLOBAL+1
         2 000623   200012 473500                    LDP3    GLOBAL_PTRS,,AUTO
         2 000624   000100 100500                    MLR     fill='000'O
         2 000625   100003 000040                    ADSC9   3,,PR1                   cn=0,n=32
         2 000626   300000 000040                    ADSC9   0,,PR3                   cn=0,n=32

      562    14318    2           B$JIT.CCARS = QT$ENTRY.TPAP.NAME.COUNT;

  14318  2 000627   100003 236100                    LDQ     3,,PR1
         2 000630   000033 772000                    QRL     27
         2 000631   000000 620006                    EAX0    0,QL
         2 000632   000000 474400 xsym               LDP4    B$JIT$
         2 000633   400032 740100                    STX0    26,,PR4

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:77   
      563    14319    2           B$JIT.CCDISP = QT$ENTRY.TPAP.NAME.COUNT;

  14319  2 000634   100003 236100                    LDQ     3,,PR1
         2 000635   000033 772000                    QRL     27
         2 000636   000000 621006                    EAX1    0,QL
         2 000637   400032 441100                    SXL1    26,,PR4

      564    14320    2           B$JIT.CCBUF = QT$ENTRY.TPAP.NAME.TEXT;

  14320  2 000640   040100 100500                    MLR     fill='040'O
         2 000641   100003 200037                    ADSC9   3,,PR1                   cn=1,n=31
         2 000642   400033 000400                    ADSC9   27,,PR4                  cn=0,n=256

      565    14321    2           FPT$CPEXIT.ACCT_ = VECTOR(VLP$ACCT);

  14321  2 000643   000001 235000 3                  LDA     1
         2 000644   200013 236100                    LDQ     GLOBAL_PTRS+1,,AUTO
         2 000645   000002 757100                    STAQ    2,,PR0

      566    14322    2           VLP$ACCT.ACCT# = QT$ENTRY.TPAP.ACCT;

  14322  2 000646   200013 475500                    LDP5    GLOBAL_PTRS+1,,AUTO
         2 000647   040100 100500                    MLR     fill='040'O
         2 000650   100013 000010                    ADSC9   11,,PR1                  cn=0,n=8
         2 000651   500000 000010                    ADSC9   0,,PR5                   cn=0,n=8

      567    14323    2           FPT$CPEXIT.PASS_ = VECTOR(VLP$PASS);

  14323  2 000652   000001 235000 3                  LDA     1
         2 000653   200014 236100                    LDQ     GLOBAL_PTRS+2,,AUTO
         2 000654   000004 757100                    STAQ    4,,PR0

      568    14324    2           VLP$PASS.PASS# = QT$ENTRY.TPAP.PASS;

  14324  2 000655   200014 474500                    LDP4    GLOBAL_PTRS+2,,AUTO
         2 000656   040100 100500                    MLR     fill='040'O
         2 000657   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:78   
         2 000660   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8

      569    14325
      570    14326    2           IF QT$ENTRY.TPAP.SN ~= ' ' THEN

  14326  2 000661   040000 106500                    CMPC    fill='040'O
         2 000662   100017 000006                    ADSC9   15,,PR1                  cn=0,n=6
         2 000663   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000664   000674 600000 2                  TZE     s:14332

      571    14327    3             DO;

      572    14328    3               FPT$CPEXIT.PSID_ = VECTOR(VLP$SN);

  14328  2 000665   000013 235000 3                  LDA     11
         2 000666   200015 236100                    LDQ     GLOBAL_PTRS+3,,AUTO
         2 000667   000006 757100                    STAQ    6,,PR0

      573    14329    3               VLP$SN.SN#(0) = QT$ENTRY.TPAP.SN;

  14329  2 000670   200015 476500                    LDP6    GLOBAL_PTRS+3,,AUTO
         2 000671   040100 100500                    MLR     fill='040'O
         2 000672   100017 000006                    ADSC9   15,,PR1                  cn=0,n=6
         2 000673   600001 000006                    ADSC9   1,,PR6                   cn=0,n=6

      574    14330    3             END;

      575    14331
      576    14332    2           IF QT$ENTRY.DEBUGGER.COUNT ~= 0 THEN

  14332  2 000674   100020 236100                    LDQ     16,,PR1
         2 000675   777000 316007                    CANQ    -512,DL
         2 000676   000706 600000 2                  TZE     s:14338

      577    14333    3             DO;

      578    14334    3               FPT$CPEXIT.DEBUG_ = VECTOR(VLP$DEBUGGER);
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:79   

  14334  2 000677   000013 235000 3                  LDA     11
         2 000700   200022 236100                    LDQ     GLOBAL_PTRS+8,,AUTO
         2 000701   000010 757100                    STAQ    8,,PR0

      579    14335    3               VLP$DEBUGGER = QT$ENTRY.DEBUGGER;

  14335  2 000702   200022 476500                    LDP6    GLOBAL_PTRS+8,,AUTO
         2 000703   000100 100500                    MLR     fill='000'O
         2 000704   100020 400014                    ADSC9   16,,PR1                  cn=2,n=12
         2 000705   600000 000020                    ADSC9   0,,PR6                   cn=0,n=16

      580    14336    3             END;

      581    14337
      582    14338    2           IF QT$ENTRY.FLAGS.MESSAGE THEN

  14338  2 000706   100000 236100                    LDQ     0,,PR1
         2 000707   040000 316003                    CANQ    16384,DU
         2 000710   000715 600000 2                  TZE     s:14344

      583    14339    3             DO;

      584    14340    3               QX$GLOBAL.MESSAGE = '1'B;

  14340  2 000711   400000 236003                    LDQ     -131072,DU
         2 000712   200066 476500                    LDP6    GLOBAL_PTRS+44,,AUTO
         2 000713   600002 756100                    STQ     2,,PR6

      585    14341    3             END;

  14341  2 000714   000717 710000 2                  TRA     RET

      586    14342    2           ELSE
      587    14343    3             DO;

      588    14344    3               QX$GLOBAL.MESSAGE = '0'B;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:80   

  14344  2 000715   200066 476500                    LDP6    GLOBAL_PTRS+44,,AUTO
         2 000716   600002 450100                    STZ     2,,PR6

      589    14345    3             END;

      590    14346
      591    14347    2   RET:
      592    14348    2           IF M$TPCP$ -> F$DCB.FCD# THEN

  14348  2 000717   200071 470500       RET          LDP0    M$TPCP$,,AUTO
         2 000720   000031 236100                    LDQ     25,,PR0
         2 000721   020000 316007                    CANQ    8192,DL
         2 000722   000727 600000 2                  TZE     s:14353

      593    14349    3             DO;

      594    14350    3               CALL M$CLOSE(FPT$CLOSE) ALTRET(MON_ERR);

  14350  2 000723   200053 470500                    LDP0    GLOBAL_PTRS+33,,AUTO
         2 000724   450001 713400                    CLIMB   alt,close
         2 000725   406000 401760                    pmme    nvectors=13
         2 000726   000731 702000 2                  TSX2    MON_ERR

      595    14351    3             END;

      596    14352
      597    14353    2           RETURN;

  14353  2 000727   200220 221300                    LDX1  ! FPT$GETDCB_CPSL+8,,AUTO
         2 000730   000001 702211                    TSX2  ! 1,X1

      598    14354
      599    14355    2   MON_ERR:
      600    14356    2           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14356  2 000731   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:81   
         2 000732   000000 471500                    LDP1    0,,PR0
         2 000733   100102 236100                    LDQ     66,,PR1
         2 000734   000000 473400 xsym               LDP3    B$JIT$
         2 000735   300144 756100                    STQ     100,,PR3

      601    14357    2           CALL QXC$SCREECH(750, '01'O, 5);

  14357  2 000736   000004 630400 3                  EPPR0   4
         2 000737   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000740   000000 701000 xent               TSX1    QXC$SCREECH
         2 000741   000000 011000                    NOP     0

      602    14358    2   END GET_NEXT_XACTION;

  14358  2 000742   200220 221300                    LDX1  ! FPT$GETDCB_CPSL+8,,AUTO
         2 000743   000001 702211                    TSX2  ! 1,X1

      603    14359                %PAGE(ARG="BUILD_STARA", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:82   
             14376    2   /***************************************************************************
             14377    2    *                                                                         *
             14378    2    *                                BUILD_STARA                              *
             14379    2    *                                                                         *
             14380    2    ***************************************************************************/

      604    14384    1   BUILD_STARA:

  14384  2 000744   200222 741300       BUILD_STARA  STX1  ! FPT$GETDCB_CPSL+10,,AUTO

      605    14385    1           PROC ALTRET;
      606    14386
      607    14387    2           VLP$NAME.L# = 2;

  14387  2 000745   200012 470500                    LDP0    GLOBAL_PTRS,,AUTO
         2 000746   002000 236003                    LDQ     1024,DU
         2 000747   000000 552140                    STBQ    0,'40'O,PR0

      608    14388    2           VLP$NAME.NAME# = '*A';

  14388  2 000750   040100 100400                    MLR     fill='040'O
         2 000751   000161 000002 1                  ADSC9   FPT_CPEXIT+21            cn=0,n=2
         2 000752   000000 200037                    ADSC9   0,,PR0                   cn=1,n=31

      609    14389    2           VLP$ACCT.ACCT# = ' ';

  14389  2 000753   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000754   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000755   200013 471500                    LDP1    GLOBAL_PTRS+1,,AUTO
         2 000756   100000 757100                    STAQ    0,,PR1

      610    14390    2           FPT$OPEN_FILE.IFPARAM_ = VECTOR(NIL);

  14390  2 000757   000014 237000 3                  LDAQ    12
         2 000760   200051 473500                    LDP3    GLOBAL_PTRS+31,,AUTO
         2 000761   300026 757100                    STAQ    22,,PR3

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:83   
      611    14391    2           VLP$SN.SN#(0) = ' ';

  14391  2 000762   200015 474500                    LDP4    GLOBAL_PTRS+3,,AUTO
         2 000763   040100 100400                    MLR     fill='040'O
         2 000764   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000765   400001 000006                    ADSC9   1,,PR4                   cn=0,n=6

      612    14392    2           CALL M$OPEN(FPT$OPEN_FILE) ALTRET(MON_ERR);

  14392  2 000766   300000 630500                    EPPR0   0,,PR3
         2 000767   450000 713400                    CLIMB   alt,open
         2 000770   410400 401760                    pmme    nvectors=18
         2 000771   001172 702000 2                  TSX2    MON_ERR

      613    14393
      614    14394        /***
      615    14395         *** Delete any old 'SET' commands that are left
      616    14396         ***/
      617    14397
      618    14398    2           IF QX$GLOBAL.SETS THEN

  14398  2 000772   200066 470500                    LDP0    GLOBAL_PTRS+44,,AUTO
         2 000773   000000 234100                    SZN     0,,PR0
         2 000774   001006 605000 2                  TPL     s:14405

      619    14399    3             DO;

      620    14400    3               QX$GLOBAL.SETS = '0'B;

  14400  2 000775   000000 450100                    STZ     0,,PR0

      621    14401    3               VLP$KEY = '001000'O;

  14401  2 000776   200017 471500                    LDP1    GLOBAL_PTRS+5,,AUTO
         2 000777   000100 100400                    MLR     fill='000'O
         2 001000   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
         2 001001   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:84   

      622    14402    3               CALL M$DELREC(FPT$DELREC) ALTRET(MON_ERR);

  14402  2 001002   200052 470500                    LDP0    GLOBAL_PTRS+32,,AUTO
         2 001003   440002 713400                    CLIMB   alt,+16386
         2 001004   401400 401760                    pmme    nvectors=4
         2 001005   001172 702000 2                  TSX2    MON_ERR

      623    14403    3             END;

      624    14404
      625    14405    2           IF QT$ENTRY.FLAGS.DCBS_SET THEN

  14405  2 001006   000001 470400 xsym               LDP0    QX_GLOBAL+1
         2 001007   000000 234100                    SZN     0,,PR0
         2 001010   001164 605000 2                  TPL     s:14454

      626    14406    3             DO;

      627    14407    3               QX$GLOBAL.SETS = '1'B;

  14407  2 001011   400000 236003                    LDQ     -131072,DU
         2 001012   200066 471500                    LDP1    GLOBAL_PTRS+44,,AUTO
         2 001013   100000 756100                    STQ     0,,PR1

      628    14408
      629    14409    3               REC$ = PINCRW(QX_GLOBAL.QT$ENTRY$, SIZEW(QT$ENTRY));

  14409  2 001014   000001 236000 xsym               LDQ     QX_GLOBAL+1
         2 001015   000032 036003                    ADLQ    26,DU
         2 001016   200073 756100                    STQ     REC$,,AUTO

      630    14410    4               DO I = 1 TO QT$ENTRY.SET_COUNT;

  14410  2 001017   000001 235007                    LDA     1,DL
         2 001020   200004 755100                    STA     I,,AUTO
         2 001021   001156 710000 2                  TRA     s:14451+3
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:85   

      631    14411    4                 VLP$KEY = REC$ -> QT$SETBITS.DCBNAME;

  14411  2 001022   200073 470500                    LDP0    REC$,,AUTO
         2 001023   200017 471500                    LDP1    GLOBAL_PTRS+5,,AUTO
         2 001024   000100 100500                    MLR     fill='000'O
         2 001025   000003 000040                    ADSC9   3,,PR0                   cn=0,n=32
         2 001026   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      632    14412    4                 FPT$WRITE_KEY.BUF_.BUF$ =

  14412  2 001027   200073 236100                    LDQ     REC$,,AUTO
         2 001030   000016 036000 3                  ADLQ    14
         2 001031   200043 473500                    LDP3    GLOBAL_PTRS+25,,AUTO
         2 001032   300005 756100                    STQ     5,,PR3

      633    14413    4                     ADDR(REC$ -> QT$SETBITS.ASN_MERGE.TEXT);
      634    14414
      635    14415    4                 FPT$WRITE_KEY.BUF_.BOUND =

  14415  2 001033   000100 101500                    MRL     fill='000'O
         2 001034   000013 000001                    ADSC9   11,,PR0                  cn=0,n=1
         2 001035   200224 000004                    ADSC9   FPT$GETDCB_CPSL+12,,AUTO cn=0,n=4
         2 001036   200224 236100                    LDQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001037   000001 136007                    SBLQ    1,DL
         2 001040   000020 736000                    QLS     16
         2 001041   300004 676100                    ERQ     4,,PR3
         2 001042   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001043   300004 656100                    ERSQ    4,,PR3

      636    14416    4                     REC$ -> QT$SETBITS.ASN_MERGE.COUNT - 1;
      637    14417
      638    14418    4                 IF (QX$GLOBAL.SEMIPERM OR QX$GLOBAL.PERM) THEN

  14418  2 001044   200066 474500                    LDP4    GLOBAL_PTRS+44,,AUTO
         2 001045   400004 234100                    SZN     4,,PR4
         2 001046   001051 604000 2                  TMI     s:14420
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:86   
         2 001047   400005 234100                    SZN     5,,PR4
         2 001050   001132 605000 2                  TPL     s:14448

      639    14419    5                   DO;

      640    14420    5                     AMR$FPT_OPEN$ = ADDR(REC$ -> QT$SETBITS.ASN_MERGE.TEXT);

  14420  2 001051   200073 236100                    LDQ     REC$,,AUTO
         2 001052   000016 036000 3                  ADLQ    14
         2 001053   200074 756100                    STQ     AMR$FPT_OPEN$,,AUTO

      641    14421    5                     PTR$_BITS = PINCRC(AMR$FPT_OPEN$,

  14421  2 001054   000002 036003                    ADLQ    2,DU
         2 001055   000020 772000                    QRL     16
         2 001056   200224 756100                    STQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001057   200074 236100                    LDQ     AMR$FPT_OPEN$,,AUTO
         2 001060   000020 772000                    QRL     16
         2 001061   200225 756100                    STQ     FPT$GETDCB_CPSL+13,,AUTO
         2 001062   200224 236100                    LDQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001063   200225 136100                    SBLQ    FPT$GETDCB_CPSL+13,,AUTO
         2 001064   000011 402007                    MPY     9,DL
         2 001065   000000 116003                    CMPQ    0,DU
         2 001066   001070 605000 2                  TPL     s:14421+12
         2 001067   000044 036003                    ADLQ    36,DU
         2 001070   200074 475500                    LDP5    AMR$FPT_OPEN$,,AUTO
         2 001071   003100 060506                    CSL     bolr='003'O
         2 001072   500000 000044                    BDSC    0,Q,PR5                  by=0,bit=0,n=36
         2 001073   200075 000044                    BDSC    PTR$_BITS,,AUTO          by=0,bit=0,n=36

      642    14422    5                         POFFC(ADDR(AMR$FPT_OPEN.SETSTA_), AMR$FPT_OPEN$)) ->
             14422                                  BASED$WORD;
      643    14423
      644    14424    5                     IF PTR$_BITS.WORDS ~= 0 THEN

  14424  2 001074   200075 220100                    LDX0    PTR$_BITS,,AUTO
         2 001075   001132 600000 2                  TZE     s:14448
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:87   

      645    14425    6                       DO;

      646    14426    6                         SETSTA$ = PINCRC(AMR$FPT_OPEN$, PTR$_BITS.WORDS * 4);

  14426  2 001076   200075 236100                    LDQ     PTR$_BITS,,AUTO
         2 001077   777777 376003                    ANQ     -1,DU
         2 001100   200074 036100                    ADLQ    AMR$FPT_OPEN$,,AUTO
         2 001101   200072 756100                    STQ     SETSTA$,,AUTO

      647    14427    6                         VLP$SETSTA = SETSTA$ -> VLP$SETSTA;

  14427  2 001102   200072 476500                    LDP6    SETSTA$,,AUTO
         2 001103   200034 477500                    LDP7    GLOBAL_PTRS+18,,AUTO
         2 001104   000100 100500                    MLR     fill='000'O
         2 001105   600000 000060                    ADSC9   0,,PR6                   cn=0,n=48
         2 001106   700000 000060                    ADSC9   0,,PR7                   cn=0,n=48

      648    14428
      649    14429    6                         VLP$SETSTA.ISTA.EOFNONE# = '0'B;

  14429  2 001107   000010 236000 3                  LDQ     8
         2 001110   700006 356100                    ANSQ    6,,PR7

      650    14430    6                         VLP$SETSTA.ISTA.EOFONE# = '0'B;

  14430  2 001111   000011 236000 3                  LDQ     9
         2 001112   700006 356100                    ANSQ    6,,PR7

      651    14431
      652    14432    6                         IF QX$GLOBAL.SEMIPERM THEN

  14432  2 001113   400004 234100                    SZN     4,,PR4
         2 001114   001117 605000 2                  TPL     s:14437

      653    14433    7                           DO;

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:88   
      654    14434    7                             VLP$SETSTA.ISTA.EOFNONE# = '1'B;

  14434  2 001115   040000 236003                    LDQ     16384,DU
         2 001116   700006 256100                    ORSQ    6,,PR7

      655    14435    7                           END;

      656    14436
      657    14437    6                         IF QX$GLOBAL.TIMEOUT > 0 THEN

  14437  2 001117   400007 235100                    LDA     7,,PR4
         2 001120   001127 600000 2                  TZE     s:14444

      658    14438    7                           DO;             /* TIMEOUT option specified on TRANS  */

      659    14439    7                             VLP$SETSTA.ISTA.EOFNONE# = '0'B;

  14439  2 001121   000010 236000 3                  LDQ     8
         2 001122   700006 356100                    ANSQ    6,,PR7

      660    14440    7                             VLP$SETSTA.ISTA.EOFTIME# = 60 * QX$GLOBAL.TIMEOUT;

  14440  2 001123   400007 236100                    LDQ     7,,PR4
         2 001124   000074 402007                    MPY     60,DL
         2 001125   000000 621006                    EAX1    0,QL
         2 001126   700006 441100                    SXL1    6,,PR7

      661    14441                                 /* TIMEOUT expressed in minutes, EOFTIME# in seconds */
      662    14442    7                           END;

      663    14443
      664    14444    6                         SETSTA$ -> VLP$SETSTA = VLP$SETSTA;

  14444  2 001127   000100 100500                    MLR     fill='000'O
         2 001130   700000 000060                    ADSC9   0,,PR7                   cn=0,n=48
         2 001131   600000 000060                    ADSC9   0,,PR6                   cn=0,n=48

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:89   
      665    14445    6                       END;

      666    14446    5                   END;

      667    14447
      668    14448    4                 REC$ = PINCRW(REC$, SIZEW(REC$ -> QT$SETBITS));

  14448  2 001132   000100 101500                    MRL     fill='000'O
         2 001133   000013 000001                    ADSC9   11,,PR0                  cn=0,n=1
         2 001134   200224 000002                    ADSC9   FPT$GETDCB_CPSL+12,,AUTO cn=0,n=2
         2 001135   200224 220100                    LDX0    FPT$GETDCB_CPSL+12,,AUTO
         2 001136   000055 621010                    EAX1    45,X0
         2 001137   000000 636011                    EAQ     0,X1
         2 001140   000022 772000                    QRL     18
         2 001141   000011 402007                    MPY     9,DL
         2 001142   000043 036007                    ADLQ    35,DL
         2 001143   000044 506007                    DIV     36,DL
         2 001144   000022 736000                    QLS     18
         2 001145   200073 036100                    ADLQ    REC$,,AUTO
         2 001146   200073 756100                    STQ     REC$,,AUTO

      669    14449
      670    14450    4                 CALL M$WRITE(FPT$WRITE_KEY) ALTRET(MON_ERR);

  14450  2 001147   300000 630500                    EPPR0   0,,PR3
         2 001150   440001 713400                    CLIMB   alt,write
         2 001151   401400 401760                    pmme    nvectors=4
         2 001152   001172 702000 2                  TSX2    MON_ERR

      671    14451    4               END;

  14451  2 001153   200004 235100                    LDA     I,,AUTO
         2 001154   000001 035007                    ADLA    1,DL
         2 001155   200004 755100                    STA     I,,AUTO
         2 001156   000001 470400 xsym               LDP0    QX_GLOBAL+1
         2 001157   000023 236100                    LDQ     19,,PR0
         2 001160   000011 772000                    QRL     9
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:90   
         2 001161   000777 376007                    ANQ     511,DL
         2 001162   200004 116100                    CMPQ    I,,AUTO
         2 001163   001022 603000 2                  TRC     s:14411

      672    14452    3             END;

      673    14453
      674    14454    2           CALL M$CLOSE(FPT$CLOSE) ALTRET(MON_ERR);

  14454  2 001164   200053 470500                    LDP0    GLOBAL_PTRS+33,,AUTO
         2 001165   450001 713400                    CLIMB   alt,close
         2 001166   406000 401760                    pmme    nvectors=13
         2 001167   001172 702000 2                  TSX2    MON_ERR

      675    14455
      676    14456    2           RETURN;

  14456  2 001170   200222 221300                    LDX1  ! FPT$GETDCB_CPSL+10,,AUTO
         2 001171   000001 702211                    TSX2  ! 1,X1

      677    14457
      678    14458    2   MON_ERR:
      679    14459    2           ALTRETURN;

  14459  2 001172   200222 221300       MON_ERR      LDX1  ! FPT$GETDCB_CPSL+10,,AUTO
         2 001173   000000 702211                    TSX2  ! 0,X1

      680    14460
      681    14461    2   END BUILD_STARA;
      682    14462                %PAGE(ARG="USER_ABORTED", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:91   
             14479    2   /***************************************************************************
             14480    2    *                                                                         *
             14481    2    *                                USER_ABORTED                             *
             14482    2    *                                                                         *
             14483    2    ***************************************************************************/

      683    14487    1   USER_ABORTED:

  14487  2 001174   200220 741300       USER_ABORTED STX1  ! FPT$GETDCB_CPSL+8,,AUTO

      684    14488    1           PROC;
      685    14489
      686    14490    2           IF B$JIT.CPFLAGS1 & '100000000000'O /* CP_RUND# */ THEN

  14490  2 001175   000000 470400 xsym               LDP0    B$JIT$
         2 001176   000143 236100                    LDQ     99,,PR0
         2 001177   000162 376000 1                  ANQ     FPT_CPEXIT+22
         2 001200   001204 600000 2                  TZE     s:14495

      687    14491    3             DO;

      688    14492    3               FPT$CPEXIT.V.QUIT# = '1'B;

  14492  2 001201   200046 471500                    LDP1    GLOBAL_PTRS+28,,AUTO
         2 001202   200000 236003                    LDQ     65536,DU
         2 001203   100014 256100                    ORSQ    12,,PR1

      689    14493    3             END;

      690    14494
      691    14495    2           CALL QXC$BLDMSG_ERRBLK(MSGBLK);

  14495  2 001204   200104 631500                    EPPR1   MSGBLK,,AUTO
         2 001205   200224 451500                    STP1    FPT$GETDCB_CPSL+12,,AUTO
         2 001206   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 001207   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001210   000000 701000 xent               TSX1    QXC$BLDMSG_ERRBLK
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:92   
         2 001211   000000 011000                    NOP     0

      692    14496    2           MSGBLK.ERRINFO.ERR(0) = B$JIT.USRERR;

  14496  2 001212   000000 470400 xsym               LDP0    B$JIT$
         2 001213   000144 236100                    LDQ     100,,PR0
         2 001214   200112 756100                    STQ     MSGBLK+6,,AUTO

      693    14497    2           MSGBLK.ERRINFO.DCB#(0) = B$JIT.USRDCB;

  14497  2 001215   000153 236100                    LDQ     107,,PR0
         2 001216   000033 736000                    QLS     27
         2 001217   200113 552140                    STBQ    MSGBLK+7,'40'O,AUTO

      694    14498    2           MSGBLK.FLAGS.HDR = HDR_FLAGS_TPAP_ABORT;

  14498  2 001220   000001 236000 1                  LDQ     HDR_FLAGS_TPAP_ABORT
         2 001221   200106 676100                    ERQ     MSGBLK+2,,AUTO
         2 001222   777600 376003                    ANQ     -128,DU
         2 001223   200106 656100                    ERSQ    MSGBLK+2,,AUTO

      695    14499
      696    14500    2           IF QT$ENTRY.FLAGS.MESSAGE THEN

  14500  2 001224   000001 471400 xsym               LDP1    QX_GLOBAL+1
         2 001225   100000 236100                    LDQ     0,,PR1
         2 001226   040000 316003                    CANQ    16384,DU
         2 001227   001232 600000 2                  TZE     s:14505

      697    14501    3             DO;

      698    14502    3               MSGBLK.FLAGS.DEST.STATION = '1'B;

  14502  2 001230   000100 236003                    LDQ     64,DU
         2 001231   200106 256100                    ORSQ    MSGBLK+2,,AUTO

      699    14503    3             END;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:93   

      700    14504
      701    14505    2           CALL QXC$BLDMSG(MSGBLK);

  14505  2 001232   200104 633500                    EPPR3   MSGBLK,,AUTO
         2 001233   200224 453500                    STP3    FPT$GETDCB_CPSL+12,,AUTO
         2 001234   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 001235   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001236   000000 701000 xent               TSX1    QXC$BLDMSG
         2 001237   000000 011000                    NOP     0

      702    14506
      703    14507    2           CALL M$UNLATCH(FPT$UNLATCH) ALTRET(UNLATCH_ERR);

  14507  2 001240   200054 470500                    LDP0    GLOBAL_PTRS+34,,AUTO
         2 001241   500002 713400                    CLIMB   alt,+32770
         2 001242   401000 401760                    pmme    nvectors=3
         2 001243   001245 702000 2                  TSX2    UNLATCH_ERR

      704    14508
      705    14509    3           DO WHILE('0'B);

  14509  2 001244   001266 710000 2                  TRA     RET

      706    14510
      707    14511    3   UNLATCH_ERR:
      708    14512    3             ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14512  2 001245   000000 470400 xsym  UNLATCH_ERR  LDP0    B$TCB$
         2 001246   000000 471500                    LDP1    0,,PR0
         2 001247   100102 236100                    LDQ     66,,PR1
         2 001250   200131 756100                    STQ     ERR,,AUTO

      709    14513    3             IF ERR.CODE ~= 1141 /* E$CULUSR */ AND

  14513  2 001251   200131 236100                    LDQ     ERR,,AUTO
         2 001252   377770 376007                    ANQ     131064,DL
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:94   
         2 001253   021650 116007                    CMPQ    9128,DL
         2 001254   001266 600000 2                  TZE     RET
         2 001255   021620 116007                    CMPQ    9104,DL
         2 001256   001266 600000 2                  TZE     RET

      710    14514    3                 ERR.CODE ~= 1138 /* E$CGNTUL */ THEN
      711    14515    4               DO;

      712    14516    4                 B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14516  2 001257   100102 236100                    LDQ     66,,PR1
         2 001260   000000 473400 xsym               LDP3    B$JIT$
         2 001261   300144 756100                    STQ     100,,PR3

      713    14517    4                 CALL QXC$SCREECH(750, '01'O, 5);

  14517  2 001262   000004 630400 3                  EPPR0   4
         2 001263   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001264   000000 701000 xent               TSX1    QXC$SCREECH
         2 001265   000000 011000                    NOP     0

      714    14518    4               END;

      715    14519    3           END /* NEVER */;

      716    14520
      717    14521    2   RET:
      718    14522    2           RETURN;

  14522  2 001266   200220 221300       RET          LDX1  ! FPT$GETDCB_CPSL+8,,AUTO
         2 001267   000001 702211                    TSX2  ! 1,X1

      719    14523    2   END USER_ABORTED;
      720    14524                %PAGE(ARG="YC_PMME", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:95   
             14541    2   /***************************************************************************
             14542    2    *                                                                         *
             14543    2    *                                  YC_PMME                                *
             14544    2    *                                                                         *
             14545    2    ***************************************************************************/

      721    14549    1   YC_PMME:

  14549  2 001270   200220 741300       YC_PMME      STX1  ! FPT$GETDCB_CPSL+8,,AUTO

      722    14550    1           PROC;
      723    14551
      724    14552                                      /*  initialize INIT and CPSL_COMMAND_PARAMS     */
      725    14553    2           XUG$INIT   = XUG_INIT;

  14553  2 001271   000100 100400                    MLR     fill='000'O
         2 001272   000044 000220 1                  ADSC9   XUG_INIT                 cn=0,n=144
         2 001273   200140 000220                    ADSC9   XUG$INIT,,AUTO           cn=0,n=144

      726    14554    2           CPSL_COMMAND_PARAMETERS = '0'B;

  14554  2 001274   000100 100400                    MLR     fill='000'O
         2 001275   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001276   200132 000024                    ADSC9   CPSL_COMMAND_PARAMETERS,,AUTO cn=0,n=20

      727    14555                /*
      728    14556                    dont let CXC, CXX routines report any errors they
      729    14557                    detect to the user, just put stuff in CPSL macro
      730    14558                */
      731    14559    2           CPSL_COMMAND_PARAMETERS.FLAGS.INHIBIT_ERRMSG = '1'B;

  14559  2 001277   200000 236003                    LDQ     65536,DU
         2 001300   200133 256100                    ORSQ    CPSL_COMMAND_PARAMETERS+1,,AUTO

      732    14560                                                /*  initialize GETCMD structure       */
      733    14561
      734    14562    2           IF XUG$GETCMD.WORK$ = ADDR(NIL) THEN
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:96   

  14562  2 001301   200065 470500                    LDP0    GLOBAL_PTRS+43,,AUTO
         2 001302   000004 236100                    LDQ     4,,PR0
         2 001303   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001304   001315 601000 2                  TNZ     s:14565

      735    14563    2             CALL CXG$INIT(XUG$GETCMD, XUG$INIT) ALTRET(MON_ERR);

  14563  2 001305   200140 631500                    EPPR1   XUG$INIT,,AUTO
         2 001306   200225 451500                    STP1    FPT$GETDCB_CPSL+13,,AUTO
         2 001307   200065 236100                    LDQ     GLOBAL_PTRS+43,,AUTO
         2 001310   200224 756100                    STQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001311   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 001312   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001313   000000 701000 xent               TSX1    CXG$INIT
         2 001314   001521 702000 2                  TSX2    MON_ERR

      736    14564                                                /*  fill in user stuff                */
      737    14565    2           QX$GLOBAL.SKIP_ERRS = '0'B;     /* print all errors                   */

  14565  2 001315   200066 470500                    LDP0    GLOBAL_PTRS+44,,AUTO
         2 001316   000010 450100                    STZ     8,,PR0

      738    14566    2           CHAR_STRING_SIZE = B$JIT.YC0SZ + 1;

  14566  2 001317   000000 471400 xsym               LDP1    B$JIT$
         2 001320   100146 236100                    LDQ     102,,PR1
         2 001321   000022 772000                    QRL     18
         2 001322   000001 036007                    ADLQ    1,DL
         2 001323   200003 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      739    14567    2           XUG$GETCMD.TEXT_ = VECTOR(B$PS0$ -> CHAR$STRING);

  14567  2 001324   200003 235100                    LDA     CHAR_STRING_SIZE,,AUTO
         2 001325   000020 735000                    ALS     16
         2 001326   000140 135007                    SBLA    96,DL
         2 001327   000000 236000 xsym               LDQ     B$PS0$
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:97   
         2 001330   200065 473500                    LDP3    GLOBAL_PTRS+43,,AUTO
         2 001331   300034 757100                    STAQ    28,,PR3

      740    14568    2           QX$GLOBAL.SKIP_ERRS = B$PS1$ -> FPTV$YC.NOERR;

  14568  2 001332   000000 474400 xsym               LDP4    B$PS1$
         2 001333   400000 236100                    LDQ     0,,PR4
         2 001334   000001 736000                    QLS     1
         2 001335   400000 376003                    ANQ     -131072,DU
         2 001336   000010 756100                    STQ     8,,PR0

      741    14569
      742    14570                                      /*  initialize GETDCB and RELDCB structures     */
      743    14571    2           FPT$GETDCB_CPSL = FPT_GETDCB_CPSL;

  14571  2 001337   000100 100400                    MLR     fill='000'O
         2 001340   000120 000040 1                  ADSC9   FPT_GETDCB_CPSL          cn=0,n=32
         2 001341   200210 000040                    ADSC9   FPT$GETDCB_CPSL,,AUTO    cn=0,n=32

      744    14572    2           FPT$RELDCB_CPSL = FPT_RELDCB_CPSL;

  14572  2 001342   000100 100400                    MLR     fill='000'O
         2 001343   000114 000020 1                  ADSC9   FPT_RELDCB_CPSL          cn=0,n=16
         2 001344   200204 000020                    ADSC9   FPT$RELDCB_CPSL,,AUTO    cn=0,n=16

      745    14573                /*  get WORK_DCB# for CXC$COMMAND, set DCBNUM
      746    14574                    vector to that of CPSL_COMMAND_PARAMETERS.WORK_DCB#
      747    14575                    for the GETDCB
      748    14576                */
      749    14577    2           FPT$GETDCB_CPSL.V_ = VECTOR(FPT$GETDCB_CPSL.V);

  14577  2 001345   000001 235000 3                  LDA     1
         2 001346   200224 452500                    STP2    FPT$GETDCB_CPSL+12,,AUTO
         2 001347   200224 236100                    LDQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001350   000216 036003                    ADLQ    142,DU
         2 001351   200210 757100                    STAQ    FPT$GETDCB_CPSL,,AUTO

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:98   
      750    14578    2           FPT$GETDCB_CPSL.DCBNUM_ = VECTOR(CPSL_COMMAND_PARAMETERS.WORK_DCB#);

  14578  2 001352   777640 235007                    LDA     -96,DL
         2 001353   200224 452500                    STP2    FPT$GETDCB_CPSL+12,,AUTO
         2 001354   200224 236100                    LDQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001355   000132 036003                    ADLQ    90,DU
         2 001356   200214 757100                    STAQ    FPT$GETDCB_CPSL+4,,AUTO

      751    14579    2           FPT$GETDCB_CPSL.V.DCB# = 6 /* M$IBEX1# */;

  14579  2 001357   000006 220003                    LDX0    6,DU
         2 001360   200216 740100                    STX0    FPT$GETDCB_CPSL+6,,AUTO

      752    14580    2           IF DCBADDR(6) = ADDR(NIL) THEN

  14580  2 001361   000000 475400 3                  LDP5    0
         2 001362   500000 476500                    LDP6    0,,PR5
         2 001363   600006 236100                    LDQ     6,,PR6
         2 001364   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001365   001372 601000 2                  TNZ     s:14584

      753    14581    3             DO;

      754    14582    3               CALL M$GETDCB(FPT$GETDCB_CPSL) ALTRET(MON_ERR);

  14582  2 001366   200210 630500                    EPPR0   FPT$GETDCB_CPSL,,AUTO
         2 001367   460002 713400                    CLIMB   alt,+24578
         2 001370   401000 401760                    pmme    nvectors=3
         2 001371   001521 702000 2                  TSX2    MON_ERR

      755    14583    3             END;

      756    14584    2           CALL CXC$COMMAND(XUG$GETCMD,CPSL_COMMAND_PARAMETERS)

  14584  2 001372   200132 630500                    EPPR0   CPSL_COMMAND_PARAMETERS,,AUTO
         2 001373   200225 450500                    STP0    FPT$GETDCB_CPSL+13,,AUTO
         2 001374   200065 236100                    LDQ     GLOBAL_PTRS+43,,AUTO
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:99   
         2 001375   200224 756100                    STQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001376   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 001377   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001400   000000 701000 xent               TSX1    CXC$COMMAND
         2 001401   001406 702000 2                  TSX2    s:14589

      757    14585    3           WHENRETURN DO;

      758    14586    3               FPT$CPEXIT.V.CONT# = '1'B;  /*  resume                            */

  14586  2 001402   200046 470500                    LDP0    GLOBAL_PTRS+28,,AUTO
         2 001403   400000 236003                    LDQ     -131072,DU
         2 001404   000014 256100                    ORSQ    12,,PR0

      759    14587    3             END;

  14587  2 001405   001504 710000 2                  TRA     s:14625

      760    14588    3           WHENALTRETURN DO;

      761    14589    3               FPT$CPEXIT.V.ALTRTN# = '1'B;

  14589  2 001406   200046 470500                    LDP0    GLOBAL_PTRS+28,,AUTO
         2 001407   100000 236003                    LDQ     32768,DU
         2 001410   000014 256100                    ORSQ    12,,PR0

      762    14590                                                /*  stuff error info into CPEXIT      */
      763    14591    3               FPT$CPEXIT.V.JERR = CPSL_COMMAND_PARAMETERS.ERRCODE;

  14591  2 001411   200134 236100                    LDQ     CPSL_COMMAND_PARAMETERS+2,,AUTO
         2 001412   000015 756100                    STQ     13,,PR0

      764    14592                                                /*  should we print to the DO fid???  */
      765    14593    3               IF ~QX$GLOBAL.SKIP_ERRS THEN

  14593  2 001413   200066 471500                    LDP1    GLOBAL_PTRS+44,,AUTO
         2 001414   100010 236100                    LDQ     8,,PR1
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:100  
         2 001415   400000 376003                    ANQ     -131072,DU
         2 001416   400000 676003                    ERQ     -131072,DU
         2 001417   001504 600000 2                  TZE     s:14625

      766    14594    4                 DO;

      767    14595
      768    14596    4                   CALL QXC$BLDMSG_ERRBLK(MSGBLK);

  14596  2 001420   200104 633500                    EPPR3   MSGBLK,,AUTO
         2 001421   200224 453500                    STP3    FPT$GETDCB_CPSL+12,,AUTO
         2 001422   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 001423   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001424   000000 701000 xent               TSX1    QXC$BLDMSG_ERRBLK
         2 001425   000000 011000                    NOP     0

      769    14597    4                   MSGBLK.ERRINFO.ERR(0) = CPSL_COMMAND_PARAMETERS.ERRCODE;

  14597  2 001426   200134 236100                    LDQ     CPSL_COMMAND_PARAMETERS+2,,AUTO
         2 001427   200112 756100                    STQ     MSGBLK+6,,AUTO

      770    14598    4                   MSGBLK.FLAGS.DEST.MCT = '0'B; /* don't send to MCT            */

  14598  2 001430   000017 236000 3                  LDQ     15
         2 001431   200106 356100                    ANSQ    MSGBLK+2,,AUTO

      771    14599    4                   MSGBLK.FLAGS.DEST.DODCB = '1'B; /* send to DO fid only        */

  14599  2 001432   000010 236003                    LDQ     8,DU
         2 001433   200106 256100                    ORSQ    MSGBLK+2,,AUTO

      772    14600    4                   MSGBLK.ERRINFO.DCB#(0) = CPSL_COMMAND_PARAMETERS.ERR_DCB#;

  14600  2 001434   200136 236100                    LDQ     CPSL_COMMAND_PARAMETERS+4,,AUTO
         2 001435   000033 736000                    QLS     27
         2 001436   200113 552140                    STBQ    MSGBLK+7,'40'O,AUTO

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:101  
      773    14601    4                   MSGBLK.FLAGS.HDR = HDR_FLAGS_YCPMME_ABORT;

  14601  2 001437   000002 236000 1                  LDQ     HDR_FLAGS_YCPMME_ABORT
         2 001440   200106 676100                    ERQ     MSGBLK+2,,AUTO
         2 001441   777600 376003                    ANQ     -128,DU
         2 001442   200106 656100                    ERSQ    MSGBLK+2,,AUTO

      774    14602
      775    14603    4                   IF QX$GLOBAL.MESSAGE THEN

  14603  2 001443   200066 470500                    LDP0    GLOBAL_PTRS+44,,AUTO
         2 001444   000002 234100                    SZN     2,,PR0
         2 001445   001450 605000 2                  TPL     s:14609

      776    14604    5                     DO;

      777    14605
      778    14606    5                       MSGBLK.FLAGS.DEST.STATION = '1'B;

  14606  2 001446   000100 236003                    LDQ     64,DU
         2 001447   200106 256100                    ORSQ    MSGBLK+2,,AUTO

      779    14607
      780    14608    5                     END;

      781    14609    4                   CALL QXC$BLDMSG(MSGBLK);

  14609  2 001450   200104 631500                    EPPR1   MSGBLK,,AUTO
         2 001451   200224 451500                    STP1    FPT$GETDCB_CPSL+12,,AUTO
         2 001452   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 001453   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001454   000000 701000 xent               TSX1    QXC$BLDMSG
         2 001455   000000 011000                    NOP     0

      782    14610
      783    14611    4                   CALL M$UNLATCH(FPT$UNLATCH) WHENALTRETURN

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:102  
  14611  2 001456   200054 470500                    LDP0    GLOBAL_PTRS+34,,AUTO
         2 001457   500002 713400                    CLIMB   alt,+32770
         2 001460   401000 401760                    pmme    nvectors=3
         2 001461   001463 702000 2                  TSX2    s:14613
         2 001462   001504 710000 2                  TRA     s:14625

      784    14612    5                     DO;

      785    14613    5                       ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14613  2 001463   000000 470400 xsym               LDP0    B$TCB$
         2 001464   000000 471500                    LDP1    0,,PR0
         2 001465   100102 236100                    LDQ     66,,PR1
         2 001466   200131 756100                    STQ     ERR,,AUTO

      786    14614    5                       IF ERR.CODE ~= 1141 /* E$CULUSR */ AND

  14614  2 001467   200131 236100                    LDQ     ERR,,AUTO
         2 001470   377770 376007                    ANQ     131064,DL
         2 001471   021650 116007                    CMPQ    9128,DL
         2 001472   001504 600000 2                  TZE     s:14625
         2 001473   021620 116007                    CMPQ    9104,DL
         2 001474   001504 600000 2                  TZE     s:14625

      787    14615    5                           ERR.CODE ~= 1138 /* E$CGNTUL */ THEN
      788    14616    6                         DO;

      789    14617    6                           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14617  2 001475   100102 236100                    LDQ     66,,PR1
         2 001476   000000 473400 xsym               LDP3    B$JIT$
         2 001477   300144 756100                    STQ     100,,PR3

      790    14618    6                           CALL QXC$SCREECH(750, '01'O, 5);

  14618  2 001500   000004 630400 3                  EPPR0   4
         2 001501   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:103  
         2 001502   000000 701000 xent               TSX1    QXC$SCREECH
         2 001503   000000 011000                    NOP     0

      791    14619    6                         END;

      792    14620    5                     END;

      793    14621    4                 END;                      /*  write to DO fid                   */

      794    14622    3             END;                          /* altret to CXC$COMMAND              */

      795    14623
      796    14624                                                /*  dont forget to release the dcb    */
      797    14625    2           FPT$RELDCB_CPSL.V_ = VECTOR(FPT$RELDCB_CPSL.V);

  14625  2 001504   000001 235000 3                  LDA     1
         2 001505   200224 452500                    STP2    FPT$GETDCB_CPSL+12,,AUTO
         2 001506   200224 236100                    LDQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001507   000206 036003                    ADLQ    134,DU
         2 001510   200204 757100                    STAQ    FPT$RELDCB_CPSL,,AUTO

      798    14626    2           FPT$RELDCB_CPSL.V.DCB# = 6 /* M$IBEX1# */;

  14626  2 001511   000006 220003                    LDX0    6,DU
         2 001512   200206 740100                    STX0    FPT$RELDCB_CPSL+2,,AUTO

      799    14627    2           CALL M$RELDCB(FPT$RELDCB_CPSL) ALTRET(MON_ERR);

  14627  2 001513   200204 630500                    EPPR0   FPT$RELDCB_CPSL,,AUTO
         2 001514   460003 713400                    CLIMB   alt,+24579
         2 001515   400000 401760                    pmme    nvectors=1
         2 001516   001521 702000 2                  TSX2    MON_ERR

      800    14628
      801    14629    2           RETURN;

  14629  2 001517   200220 221300                    LDX1  ! FPT$GETDCB_CPSL+8,,AUTO
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:104  
         2 001520   000001 702211                    TSX2  ! 1,X1

      802    14630
      803    14631
      804    14632    2   MON_ERR:
      805    14633    2           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14633  2 001521   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         2 001522   000000 471500                    LDP1    0,,PR0
         2 001523   100102 236100                    LDQ     66,,PR1
         2 001524   000000 473400 xsym               LDP3    B$JIT$
         2 001525   300144 756100                    STQ     100,,PR3

      806    14634    2           CALL QXC$SCREECH(750, '01'O, 5);

  14634  2 001526   000004 630400 3                  EPPR0   4
         2 001527   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001530   000000 701000 xent               TSX1    QXC$SCREECH
         2 001531   000000 011000                    NOP     0

      807    14635    2   END YC_PMME;

  14635  2 001532   200220 221300                    LDX1  ! FPT$GETDCB_CPSL+8,,AUTO
         2 001533   000001 702211                    TSX2  ! 1,X1

      808    14636
      809    14637                %PAGE(ARG="LINK_PMME", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:105  
             14654    2   /***************************************************************************
             14655    2    *                                                                         *
             14656    2    *                                 LINK_PMME                               *
             14657    2    *                                                                         *
             14658    2    ***************************************************************************/

      810    14662    1   LNK_PMME:

  14662  2 001534   200220 741300       LNK_PMME     STX1  ! FPT$GETDCB_CPSL+8,,AUTO

      811    14663    1           PROC;
      812    14664
      813    14665    2           FPT$CPEXIT.V.ALTRTN# = '1'B;

  14665  2 001535   200046 470500                    LDP0    GLOBAL_PTRS+28,,AUTO
         2 001536   100000 236003                    LDQ     32768,DU
         2 001537   000014 256100                    ORSQ    12,,PR0

      814    14666    2           FPT$CPEXIT.V.JERR = CODE_NO_CP_CMD;

  14666  2 001540   000132 236000 1                  LDQ     CODE_NO_CP_CMD
         2 001541   000015 756100                    STQ     13,,PR0

      815    14667
      816    14668    2           RETURN;

  14668  2 001542   200220 221300                    LDX1  ! FPT$GETDCB_CPSL+8,,AUTO
         2 001543   000001 702211                    TSX2  ! 1,X1

      817    14669    2   END LNK_PMME;
      818    14670                %PAGE(ARG="ACCOUNTING", PAGE=YES);

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:106  
             14687    2   /***************************************************************************
             14688    2    *                                                                         *
             14689    2    *                                 ACCOUNTING                              *
             14690    2    *                                                                         *
             14691    2    ***************************************************************************/

      819    14695    1   ACCOUNTING:

  14695  2 001544   200220 741300       ACCOUNTING   STX1  ! FPT$GETDCB_CPSL+8,,AUTO

      820    14696    1           PROC;
      821    14697
      822    14698    2           LOGOFF_PARAM.CODE = 2;

  14698  2 001545   000002 235007                    LDA     2,DL
         2 001546   200076 755100                    STA     LOGOFF_PARAM,,AUTO

      823    14699    2           LOGOFF_PARAM.DCB1 = 5 /* M$IBEX# */;

  14699  2 001547   000005 220003                    LDX0    5,DU
         2 001550   200100 740100                    STX0    LOGOFF_PARAM+2,,AUTO

      824    14700    2           CALL AZA$LOGOFF(LOGOFF_PARAM) ALTRET(LOGOFF_ERR);

  14700  2 001551   200076 630500                    EPPR0   LOGOFF_PARAM,,AUTO
         2 001552   200224 450500                    STP0    FPT$GETDCB_CPSL+12,,AUTO
         2 001553   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 001554   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001555   000000 701000 xent               TSX1    AZA$LOGOFF
         2 001556   001560 702000 2                  TSX2    LOGOFF_ERR

      825    14701
      826    14702    3           DO WHILE('0'B);

  14702  2 001557   001620 710000 2                  TRA     s:14719

      827    14703
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:107  
      828    14704    3   LOGOFF_ERR:
      829    14705            /* Call M$ERRMSG to fill in the message before sending it to
      830    14706               the Console.   FPT$KEYIN is setup in QXA$INIT    */
      831    14707    3             CALL QXC$BLDMSG_ERRBLK(MSGBLK);

  14707  2 001560   200104 630500       LOGOFF_ERR   EPPR0   MSGBLK,,AUTO
         2 001561   200224 450500                    STP0    FPT$GETDCB_CPSL+12,,AUTO
         2 001562   200224 630500                    EPPR0   FPT$GETDCB_CPSL+12,,AUTO
         2 001563   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001564   000000 701000 xent               TSX1    QXC$BLDMSG_ERRBLK
         2 001565   000000 011000                    NOP     0

      832    14708    3             FPT$ERRMSG.BUF_ = VECTOR (BUFFER_MSG1);

  14708  2 001566   000020 235000 3                  LDA     16
         2 001567   200064 236100                    LDQ     GLOBAL_PTRS+42,,AUTO
         2 001570   200057 470500                    LDP0    GLOBAL_PTRS+37,,AUTO
         2 001571   000004 757100                    STAQ    4,,PR0

      833    14709    3             FPT$ERRMSG.CODE_ = VECTOR (MSGBLK.ERRINFO.ERR(0));

  14709  2 001572   777640 235007                    LDA     -96,DL
         2 001573   200224 452500                    STP2    FPT$GETDCB_CPSL+12,,AUTO
         2 001574   200224 236100                    LDQ     FPT$GETDCB_CPSL+12,,AUTO
         2 001575   000112 036003                    ADLQ    74,DU
         2 001576   000002 757100                    STAQ    2,,PR0

      834    14710    3             FPT$ERRMSG.V.DCB# = MSGBLK.ERRINFO.DCB#(0);

  14710  2 001577   200113 236100                    LDQ     MSGBLK+7,,AUTO
         2 001600   000033 772000                    QRL     27
         2 001601   000000 620006                    EAX0    0,QL
         2 001602   000026 740100                    STX0    22,,PR0

      835    14711    3             CALL M$ERRMSG(FPT$ERRMSG) ALTRET (IGNORE);

  14711  2 001603   420000 713400                    CLIMB   alt,+8192
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:108  
         2 001604   405000 401760                    pmme    nvectors=11
         2 001605   001606 702000 2                  TSX2    IGNORE

  14710  2 001606                       IGNORE       null
      836    14712    3   IGNORE:   ;
      837    14713    3             CALL M$KEYIN(FPT$KEYIN) ALTRET (IGNORE2);

  14713  2 001606   200063 470500                    LDP0    GLOBAL_PTRS+41,,AUTO
         2 001607   520000 713400                    CLIMB   alt,+40960
         2 001610   401400 401760                    pmme    nvectors=4
         2 001611   001612 702000 2                  TSX2    IGNORE2

  14710  2 001612                       IGNORE2      null
      838    14714    3   IGNORE2:  ;
      839    14715    3             FPT$OCMSG.V.MSG# = TP_ACCT_MSG#;

  14715  2 001612   000331 235007                    LDA     217,DL
         2 001613   200061 470500                    LDP0    GLOBAL_PTRS+39,,AUTO
         2 001614   000006 755100                    STA     6,,PR0

      840    14716    3             CALL M$OCMSG(FPT$OCMSG) ALTRET(MON_ERR);

  14716  2 001615   520001 713400                    CLIMB   alt,+40961
         2 001616   401000 401760                    pmme    nvectors=3
         2 001617   001753 702000 2                  TSX2    MON_ERR

      841    14717    3           END /* NEVER */;

      842    14718
      843    14719    2           IF NOT B$JIT.CPFLAGS1 & '000010000000'O /* CP_LASTCPEXISTS# */THEN

  14719  2 001620   000000 470400 xsym               LDP0    B$JIT$
         2 001621   000143 236100                    LDQ     99,,PR0
         2 001622   000026 376000 xsym               ANQ     B_VECTNIL+22
         2 001623   001625 601000 2                  TNZ     s:14724

      844    14720    3             DO;
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:109  

      845    14721    3               GOTO RET;

  14721  2 001624   001741 710000 2                  TRA     RET

      846    14722    3             END;
      847    14723
      848    14724    2           B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 & '000004000000'O /* CP_LASTCP# */;

  14724  2 001625   000143 236100                    LDQ     99,,PR0
         2 001626   000022 376000 xsym               ANQ     B_VECTNIL+18
         2 001627   000143 756100                    STQ     99,,PR0

      849    14725
      850    14726    2           VLP$NAME.L# = 6;

  14726  2 001630   200012 471500                    LDP1    GLOBAL_PTRS,,AUTO
         2 001631   006000 236003                    LDQ     3072,DU
         2 001632   100000 552140                    STBQ    0,'40'O,PR1

      851    14727    2           VLP$NAME.NAME# = ':USERS';

  14727  2 001633   040100 100400                    MLR     fill='040'O
         2 001634   000163 000006 1                  ADSC9   FPT_CPEXIT+23            cn=0,n=6
         2 001635   100000 200037                    ADSC9   0,,PR1                   cn=1,n=31

      852    14728    2           VLP$ACCT.ACCT# = ':SYS';

  14728  2 001636   000165 235000 1                  LDA     FPT_CPEXIT+25
         2 001637   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 001640   200013 470500                    LDP0    GLOBAL_PTRS+1,,AUTO
         2 001641   000000 757100                    STAQ    0,,PR0

      853    14729    2           FPT$OPEN_FILE.IFPARAM_ = VECTOR(NIL);

  14729  2 001642   000014 237000 3                  LDAQ    12
         2 001643   200051 473500                    LDP3    GLOBAL_PTRS+31,,AUTO
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:110  
         2 001644   300026 757100                    STAQ    22,,PR3

      854    14730    2           VLP$SN.SN#(0) = ' ';

  14730  2 001645   200015 474500                    LDP4    GLOBAL_PTRS+3,,AUTO
         2 001646   040100 100400                    MLR     fill='040'O
         2 001647   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001650   400001 000006                    ADSC9   1,,PR4                   cn=0,n=6

      855    14731    2           CALL M$OPEN(FPT$OPEN_FILE) ALTRET(MON_ERR);

  14731  2 001651   300000 630500                    EPPR0   0,,PR3
         2 001652   450000 713400                    CLIMB   alt,open
         2 001653   410400 401760                    pmme    nvectors=18
         2 001654   001753 702000 2                  TSX2    MON_ERR

      856    14732
      857    14733    2           CALL CONCAT(VLP$KEY.NAME#, B$JIT.ACCN, B$JIT.UNAME);

  14733  2 001655   000000 470400 xsym               LDP0    B$JIT$
         2 001656   200017 471500                    LDP1    GLOBAL_PTRS+5,,AUTO
         2 001657   040100 100500                    MLR     fill='040'O
         2 001660   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 001661   100000 200010                    ADSC9   0,,PR1                   cn=1,n=8
         2 001662   000000 470400 xsym               LDP0    B$JIT$
         2 001663   040100 100500                    MLR     fill='040'O
         2 001664   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 001665   100002 200027                    ADSC9   2,,PR1                   cn=1,n=23

      858    14734    2           CALL INDEX(BLANK_POS, ' ', B$JIT.UNAME) ALTRET(NO_BLANK);

  14734  2 001666   000000 470400 xsym               LDP0    B$JIT$
         2 001667   000000 124500                    SCM     mask='000'O
         2 001670   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 001671   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001672   200005 000100                    ARG     BLANK_POS,,AUTO
         2 001673   001677 606400 2                  TTN     NO_BLANK
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:111  

      859    14735    2           BLANK_POS = BLANK_POS + 1;

  14735  2 001674   200005 235100                    LDA     BLANK_POS,,AUTO
         2 001675   000001 035007                    ADLA    1,DL
         2 001676   200005 755100                    STA     BLANK_POS,,AUTO

      860    14736
      861    14737    2   NO_BLANK:
      862    14738    2           VLP$KEY.L# = 8 + BLANK_POS;

  14738  2 001677   200017 470500       NO_BLANK     LDP0    GLOBAL_PTRS+5,,AUTO
         2 001700   200005 236100                    LDQ     BLANK_POS,,AUTO
         2 001701   000010 036007                    ADLQ    8,DL
         2 001702   000033 736000                    QLS     27
         2 001703   000000 552140                    STBQ    0,'40'O,PR0

      863    14739    2           CALL M$READ(FPT$READ_KEY) ALTRET(READ_ERR);

  14739  2 001704   200042 470500                    LDP0    GLOBAL_PTRS+24,,AUTO
         2 001705   440000 713400                    CLIMB   alt,read
         2 001706   401400 401760                    pmme    nvectors=4
         2 001707   001711 702000 2                  TSX2    READ_ERR

      864    14740
      865    14741    3           DO WHILE('0'B);

  14741  2 001710   001721 710000 2                  TRA     s:14752

      866    14742
      867    14743    3   READ_ERR:
      868    14744    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 66 /* E$NOKEY */ THEN

  14744  2 001711   000000 470400 xsym  READ_ERR     LDP0    B$TCB$
         2 001712   000000 471500                    LDP1    0,,PR0
         2 001713   100102 236100                    LDQ     66,,PR1
         2 001714   377770 376007                    ANQ     131064,DL
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:112  
         2 001715   001020 116007                    CMPQ    528,DL
         2 001716   001720 600000 2                  TZE     s:14749

      869    14745    4               DO;

      870    14746    4                 GOTO MON_ERR;

  14746  2 001717   001753 710000 2                  TRA     MON_ERR

      871    14747    4               END;
      872    14748
      873    14749    3             GOTO RET;

  14749  2 001720   001741 710000 2                  TRA     RET

      874    14750    3           END /* NEVER */;

      875    14751
      876    14752    2           VLP$NAME = AS$USERS.LASTCPROC.NAME(4 /* M_TP# */ - 1);

  14752  2 001721   000001 470400 xsym               LDP0    QX_GLOBAL+1
         2 001722   200012 471500                    LDP1    GLOBAL_PTRS,,AUTO
         2 001723   000100 100500                    MLR     fill='000'O
         2 001724   000215 000040                    ADSC9   141,,PR0                 cn=0,n=32
         2 001725   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      877    14753    2           FPT$CPEXIT.NAME_ = VECTOR(VLP$NAME);

  14753  2 001726   000012 235000 3                  LDA     10
         2 001727   200012 236100                    LDQ     GLOBAL_PTRS,,AUTO
         2 001730   200046 473500                    LDP3    GLOBAL_PTRS+28,,AUTO
         2 001731   300000 757100                    STAQ    0,,PR3

      878    14754    2           VLP$ACCT.ACCT# = ':SYS';

  14754  2 001732   000165 235000 1                  LDA     FPT_CPEXIT+25
         2 001733   000035 236000 xsym               LDQ     B_VECTNIL+29
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:113  
         2 001734   200013 474500                    LDP4    GLOBAL_PTRS+1,,AUTO
         2 001735   400000 757100                    STAQ    0,,PR4

      879    14755    2           FPT$CPEXIT.ACCT_ = VECTOR(VLP$ACCT);

  14755  2 001736   000001 235000 3                  LDA     1
         2 001737   200013 236100                    LDQ     GLOBAL_PTRS+1,,AUTO
         2 001740   300002 757100                    STAQ    2,,PR3

      880    14756
      881    14757    2   RET:
      882    14758    2           IF M$TPCP$ -> F$DCB.FCD# THEN

  14758  2 001741   200071 470500       RET          LDP0    M$TPCP$,,AUTO
         2 001742   000031 236100                    LDQ     25,,PR0
         2 001743   020000 316007                    CANQ    8192,DL
         2 001744   001751 600000 2                  TZE     s:14763

      883    14759    3             DO;

      884    14760    3               CALL M$CLOSE(FPT$CLOSE) ALTRET(MON_ERR);

  14760  2 001745   200053 470500                    LDP0    GLOBAL_PTRS+33,,AUTO
         2 001746   450001 713400                    CLIMB   alt,close
         2 001747   406000 401760                    pmme    nvectors=13
         2 001750   001753 702000 2                  TSX2    MON_ERR

      885    14761    3             END;

      886    14762
      887    14763    2           RETURN;

  14763  2 001751   200220 221300                    LDX1  ! FPT$GETDCB_CPSL+8,,AUTO
         2 001752   000001 702211                    TSX2  ! 1,X1

      888    14764
      889    14765    2   MON_ERR:
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:114  
      890    14766    2           B$JIT.USRERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

  14766  2 001753   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         2 001754   000000 471500                    LDP1    0,,PR0
         2 001755   100102 236100                    LDQ     66,,PR1
         2 001756   000000 473400 xsym               LDP3    B$JIT$
         2 001757   300144 756100                    STQ     100,,PR3

      891    14767    2           CALL QXC$SCREECH(750, '01'O, 5);

  14767  2 001760   000004 630400 3                  EPPR0   4
         2 001761   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001762   000000 701000 xent               TSX1    QXC$SCREECH
         2 001763   000000 011000                    NOP     0

      892    14768
      893    14769    2   END ACCOUNTING;

  14769  2 001764   200220 221300                    LDX1  ! FPT$GETDCB_CPSL+8,,AUTO
         2 001765   000001 702211                    TSX2  ! 1,X1

      894    14770    1   END QXA$TPCP;

  14770  2 001766   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:115  
--  Include file information  --

   CX_MACROS_M.:E05TOU  is referenced.
   CX_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CXG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   JS$CP6V_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_SCODE_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QX_PERR_C.:E05TOU  is referenced.
   QX_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QX_MACROS_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QXA$TPCP.
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:116  

 **** Variables and constants ****

  ****  Section 001 RoData QXA$TPCP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   131-0-0/b STRC        r     1 CODE_MISSING_REC         132-0-0/b STRC        r     1 CODE_NO_CP_CMD
   112-0-0/c STRC(72)    r     1 COLONSYS                 134-0-0/d STRC(504)   r     1 FPT_CPEXIT
   120-0-0/d STRC(288)   r     1 FPT_GETDCB_CPSL          114-0-0/d STRC(144)   r     1 FPT_RELDCB_CPSL
     1-0-0/b STRC(11)    r     1 HDR_FLAGS_TPAP_ABORT       0-0-0/b STRC(11)    r     1 HDR_FLAGS_UNDEF_XACT
     2-0-0/b STRC(11)    r     1 HDR_FLAGS_YCPMME_ABORT
   110-0-0/c STRC(45)    r     1 IBEX_NAME                 17-0-0/w STRC(432)   r     1 VLP_SETSTA_LOCKED
     3-0-0/w STRC(432)   r     1 VLP_SETSTA_UNLOCKED       33-0-0/w STRC(288)   r     1 VLP_STATION
    44-0-0/d STRC(1296)  r     1 XUG_INIT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    74-0-0/w PTR         r     1 AMR$FPT_OPEN$              5-0-0/w UBIN        r     1 BLANK_POS
     7-0-0/w CHAR(8)     r     1 CHAR_STRING                3-0-0/w UBIN        r     1 CHAR_STRING_SIZE
   132-0-0/w STRC(180)   r     1 CPSL_COMMAND_PARAMETERS
   131-0-0/b STRC        r     1 ERR                      210-0-0/d STRC(288)   r     1 FPT$GETDCB_CPSL
   204-0-0/d STRC(144)   r     1 FPT$RELDCB_CPSL           12-0-0/d STRC(1620)  r     1 GLOBAL_PTRS
     4-0-0/w UBIN        r     1 I                         76-0-0/w STRC(216)   r     1 LOGOFF_PARAM
    71-0-0/w PTR         r     1 M$TPCP$                   70-0-0/w PTR         r     1 M$UC$
   104-0-0/w STRC(738)   r     1 MSGBLK                    75-0-0/b STRC        r     1 PTR$_BITS
    73-0-0/w PTR         r     1 REC$                      72-0-0/w PTR         r     1 SETSTA$
   140-0-0/d STRC(1296)  r     1 XUG$INIT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:117  
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w STRC(72)    r     1 QX_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1440)  r     1 AMR$FPT_OPEN               0-0-0/w STRC(18576) r     1 AS$USERS
     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/b BIT         r     1 BASED$WORD
     0-0-0/d CHAR(124)   r     1 BUFFER_MSG1                0-0-0/c ACHR        r     1 CHAR$STRING
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(1080)  r     1 FPT$CLOSE
     0-0-0/d STRC(504)   r     1 FPT$CPEXIT                 0-0-0/d STRC(360)   r     1 FPT$DELREC
     0-0-0/d STRC(936)   r     1 FPT$ERRMSG                 0-0-0/d STRC(216)   r     1 FPT$GDS
     0-0-0/d STRC(288)   r     1 FPT$GETDCB                 0-0-0/d STRC(504)   r     1 FPT$KEYIN
     0-0-0/d STRC(360)   r     1 FPT$OCMSG                  0-0-0/d STRC(2088)  r     1 FPT$OPEN_CG
     0-0-0/d STRC(2088)  r     1 FPT$OPEN_FILE              0-0-0/d STRC(504)   r     1 FPT$READ_CG
     0-0-0/d STRC(504)   r     1 FPT$READ_KEY               0-0-0/d STRC(144)   r     1 FPT$RELDCB
     0-0-0/d STRC(360)   r     1 FPT$UNLATCH                0-0-0/d STRC(432)   r     1 FPT$WRITE_KEY
     0-0-0/d STRC        r     1 FPTV$YC                    0-0-0/d STRC(1620)  r     1 GLOBAL$PTRS
     0-0-0/w STRC(936)   r     1 QT$ENTRY                   0-0-0/c ASTR(405)   r     1 QT$SETBITS
     0-0-0/w STRC(2016)  r     1 QX$GLOBAL                  0-0-0/d STRC(72)    r     1 VLP$ACCT
     0-0-0/d STRC(72)    r     1 VLP$ACCT_TRADER
     0-0-0/w STRC(72)    r     1 VLP$CODE07_PASS_TRADER
     0-0-0/d STRC(144)   r     1 VLP$DEBUGGER               0-0-0/d STRC(72)    r     1 VLP$GDS
     0-0-0/w STRC(72)    r     1 VLP$IFPARAM_PASS_TRADER
     0-0-0/d STRC(288)   r     1 VLP$KEY                    0-0-0/d STRC(81)    r     1 VLP$MSGTYP
     0-0-0/d STRC(288)   r     1 VLP$NAME                   0-0-0/d STRC(288)   r     1 VLP$NAME_TRADER
     0-0-0/d STRC(72)    r     1 VLP$PASS                   0-0-0/w STRC(432)   r     1 VLP$SETSTA
     0-0-0/d STRC(90)    r     1 VLP$SN                     0-0-0/d STRC(90)    r     1 VLP$SN_TRADER
     0-0-0/w STRC(288)   r     1 VLP$STATION                0-0-0/d STRC(72)    r     1 VLP$VECTOR
     0-0-0/d STRC(1512)  r     1 XUG$GETCMD

PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:118  

   Procedure QXA$TPCP requires 1015 words for executable code.
   Procedure QXA$TPCP requires 150 words of local(AUTO) storage.

    No errors detected in file QXA$TPCP.:E05TSI    .
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:119  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:120  
          MINI XREF LISTING

ACCOUNTING
     14696**PROC    14099--CALL
AMR$FPT_OPEN.ACSVEH_
     10738**DCL     10739--REDEF
AMR$FPT_OPEN.ALTKEYS_
     10744**DCL     10745--REDEF   10745--REDEF
AMR$FPT_OPEN.HDR_
     10743**DCL     10744--REDEF
AMR$FPT_OPEN.SETSTA_
     10737**DCL     14421--ASSIGN
AMR$FPT_OPEN.TAB_
     10742**DCL     10743--REDEF
AMR$FPT_OPEN.UHL_
     10736**DCL     10737--REDEF   10737--REDEF
AMR$FPT_OPEN.V.FSN#
     10776**DCL     10776--REDEF   10776--REDEF
AMR$FPT_OPEN.WSN_
     10742**DCL     10742--REDEF
AMR$FPT_OPEN$
     11624**DCL     10736--IMP-PTR 14420<<ASSIGN  14421>>ASSIGN  14421>>ASSIGN  14421>>ASSIGN  14426>>ASSIGN
AS$USERS.BANNER_PERM
     10578**DCL     10579--REDEF
AS$USERS.BUDGET.MACCT
     10483**DCL     10487--REDEF
AS$USERS.BUDGET.MAX_PROJECTS
     10496**DCL     10499--REDEF
AS$USERS.BUDGET.PACCUM
     10479**DCL     10481--REDEF
AS$USERS.BUDGET.PMAXC
     10474**DCL     10476--REDEF
AS$USERS.LASTCPROC.NAME
     10537**DCL     14752>>ASSIGN
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:121  
AS$USERS.SETUP_CHRA.TXT
     10594**DCL     10595--REDEF   10596--REDEF
AZA$LOGOFF
     10277**DCL-ENT 14700--CALL
B$ALT.CODE
     10654**DCL     10654--REDEF   10655--REDEF   10655--REDEF
B$ALT.ERR
     10655**DCL     14124>>ASSIGN  14205>>ASSIGN  14252>>ASSIGN  14356>>ASSIGN  14512>>ASSIGN  14516>>ASSIGN
     14613>>ASSIGN  14617>>ASSIGN  14633>>ASSIGN  14766>>ASSIGN
B$ALT.ERR.CODE
     10656**DCL     14180>>IF      14744>>IF
B$ALT.ERR.ERR#
     10656**DCL     10656--REDEF
B$ALT.EVID
     10655**DCL     10655--REDEF   10655--REDEF
B$JIT.ACCN
      3854**DCL     14733>>CALLBLT
B$JIT.CCARS
      3942**DCL     14155>>ASSIGN  14318<<ASSIGN
B$JIT.CCBUF
      3942**DCL     14155--ASSIGN  14320<<ASSIGN
B$JIT.CCDISP
      3942**DCL     14319<<ASSIGN
B$JIT.CPFLAGS1
      3943**DCL     14037>>IF      14048>>IF      14060>>IF      14060>>IF      14063>>IF      14074>>IF
     14079>>IF      14091>>IF      14102>>IF      14490>>IF      14719>>IF      14724<<ASSIGN  14724>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      3948**DCL      3948--REDEF
B$JIT.ERR.MID
      3855**DCL      3855--REDEF
B$JIT.JRESPEAK
      4016**DCL      4017--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      4125**DCL      4125--REDEF    4126--REDEF
B$JIT.PNR
      4029**DCL      4029--REDEF
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:122  
B$JIT.STEPS
      4075**DCL     14180>>IF
B$JIT.TSLINE
      4123**DCL      4124--REDEF
B$JIT.UNAME
      3854**DCL     14733>>CALLBLT 14734>>CALLBLT
B$JIT.USRDCB
      4003**DCL     14497>>ASSIGN
B$JIT.USRERR
      3990**DCL     14124<<ASSIGN  14356<<ASSIGN  14496>>ASSIGN  14516<<ASSIGN  14617<<ASSIGN  14633<<ASSIGN
     14766<<ASSIGN
B$JIT.USRRNST
      3990**DCL     14085>>IF      14087<<ASSIGN
B$JIT.YC0SZ
      3991**DCL     14566>>ASSIGN
B$JIT$
     10310**DCL      3849--IMP-PTR 14037>>IF      14048>>IF      14060>>IF      14060>>IF      14063>>IF
     14074>>IF      14079>>IF      14085>>IF      14087>>ASSIGN  14091>>IF      14102>>IF      14124>>ASSIGN
     14155>>ASSIGN  14155>>ASSIGN  14180>>IF      14318>>ASSIGN  14319>>ASSIGN  14320>>ASSIGN  14356>>ASSIGN
     14490>>IF      14496>>ASSIGN  14497>>ASSIGN  14516>>ASSIGN  14566>>ASSIGN  14617>>ASSIGN  14633>>ASSIGN
     14719>>IF      14724>>ASSIGN  14724>>ASSIGN  14733>>CALLBLT 14733>>CALLBLT 14734>>CALLBLT 14766>>ASSIGN
B$PS0$
     10312**DCL     14567>>ASSIGN
B$PS1$
     10313**DCL     14568>>ASSIGN
B$TCB.ALT$
     10650**DCL     14124>>ASSIGN  14180>>IF      14205>>ASSIGN  14252>>ASSIGN  14356>>ASSIGN  14512>>ASSIGN
     14516>>ASSIGN  14613>>ASSIGN  14617>>ASSIGN  14633>>ASSIGN  14744>>IF      14766>>ASSIGN
B$TCB$
     10311**DCL     14124>>ASSIGN  14180>>IF      14205>>ASSIGN  14252>>ASSIGN  14356>>ASSIGN  14512>>ASSIGN
     14516>>ASSIGN  14613>>ASSIGN  14617>>ASSIGN  14633>>ASSIGN  14744>>IF      14766>>ASSIGN
BASED$WORD
     10666**DCL     14421>>ASSIGN
BLANK_POS
     11523**DCL     14734<<CALLBLT 14735<<ASSIGN  14735>>ASSIGN  14738>>ASSIGN
BUFFER_MSG1
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:123  
     10668**DCL     14708--ASSIGN
BUILD_STARA
     14385**PROC    14313--CALL
CHAR$STRING
     10664**DCL     14155<<ASSIGN  14257--ASSIGN  14567--ASSIGN
CHAR_STRING
     11525**DCL     14193<<ASSIGN  14235>>CALLBLT 14279>>ASSIGN
CHAR_STRING_SIZE
     11521**DCL     10664--IMP-SIZ 14154<<ASSIGN  14155>>ASSIGN  14256<<ASSIGN  14257>>ASSIGN  14566<<ASSIGN
     14567>>ASSIGN
CLEAN_UP
     14097**LABEL   14071--GOTO    14082--GOTO
CODE_MISSING_REC
     12263**DCL     14268>>ASSIGN
CODE_NO_CP_CMD
     12270**DCL     14666>>ASSIGN
COLONSYS
     11463**DCL     11143--DCLINIT
CPSL_COMMAND_PARAMETERS
     11768**DCL     14554<<ASSIGN  14584<>CALL
CPSL_COMMAND_PARAMETERS.ERRCODE
     11776**DCL     14591>>ASSIGN  14597>>ASSIGN
CPSL_COMMAND_PARAMETERS.ERR_DCB#
     11783**DCL     14600>>ASSIGN
CPSL_COMMAND_PARAMETERS.FLAGS.INHIBIT_ERRMSG
     11772**DCL     14559<<ASSIGN
CPSL_COMMAND_PARAMETERS.WORK_DCB#
     11769**DCL     14578--ASSIGN
CXC$COMMAND
     10284**DCL-ENT 14584--CALL
CXG$INIT
      7077**DCL-ENT 14563--CALL
ERR
     11761**DCL     14205<<ASSIGN  14252<<ASSIGN  14512<<ASSIGN  14613<<ASSIGN
ERR.CODE
     11765**DCL     14206>>IF      14206>>IF      14206>>IF      14213>>IF      14253>>IF      14261>>IF
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:124  
     14513>>IF      14513>>IF      14614>>IF      14614>>IF
EXITT
     14121**LABEL   14050--GOTO
F$DCB.ACTPOS
     10372**DCL     10372--REDEF
F$DCB.ARS#
     10346**DCL     10346--REDEF
F$DCB.ATTR
     10365**DCL     10366--REDEF
F$DCB.BORROW
     10380**DCL     10380--REDEF   10380--REDEF   10380--REDEF
F$DCB.DCBNAME.L
     10394**DCL     10394--IMP-SIZ
F$DCB.EOMCHAR#
     10350**DCL     10350--REDEF
F$DCB.FCD#
     10359**DCL     14220>>IF      14348>>IF      14758>>IF
F$DCB.FLDID
     10375**DCL     10375--REDEF
F$DCB.FORM$
     10369**DCL     10369--REDEF
F$DCB.FSECT
     10385**DCL     10385--REDEF
F$DCB.FSN#
     10362**DCL     10362--REDEF   10362--REDEF   10363--REDEF
F$DCB.HEADER$
     10368**DCL     10368--REDEF
F$DCB.IXTNSIZE#
     10366**DCL     10366--REDEF
F$DCB.LASTSTA$
     10355**DCL     10355--REDEF   14239>>CALLBLT 14286>>ASSIGN
F$DCB.LVL
     10381**DCL     10381--REDEF
F$DCB.NAME#.C
     10356**DCL     10356--REDEF
F$DCB.NOEOF
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:125  
     10378**DCL     10378--REDEF
F$DCB.NRECS#
     10367**DCL     10367--REDEF
F$DCB.NRECX
     10386**DCL     10386--REDEF
F$DCB.OHDR
     10378**DCL     10378--REDEF
F$DCB.ORG#
     10361**DCL     10361--REDEF
F$DCB.PRECNO
     10384**DCL     10384--REDEF
F$DCB.RCSZ
     10390**DCL     10390--REDEF
F$DCB.RES#
     10357**DCL     10357--REDEF
F$DCB.SETSTA$
     10355**DCL     14160>>IF      14168>>ASSIGN  14280>>ASSIGN
F$DCB.SETX
     10369**DCL     10369--REDEF
F$DCB.TAB$
     10369**DCL     10369--REDEF
F$DCB.TDA
     10383**DCL     10384--REDEF
F$DCB.WSN#
     10357**DCL     10357--REDEF
FPT$CLOSE
     12838**DCL     14247<>CALL    14350<>CALL    14454<>CALL    14760<>CALL
FPT$CLOSE.SN_
     12838**DCL     12838--REDEF
FPT$CLOSE.UTL_
     12839**DCL     12839--REDEF
FPT$CLOSE.V.EXPIRE#
     12853**DCL     12853--REDEF
FPT$CLOSE.V.TYPE#
     12851**DCL     12851--REDEF
FPT$CLOSE.V.XTNSIZE#
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:126  
     12848**DCL     12848--REDEF   12850--REDEF
FPT$CPEXIT
     12625**DCL     14045<<ASSIGN  14121<>CALL
FPT$CPEXIT.ACCT_
     12627**DCL     14321<<ASSIGN  14755<<ASSIGN
FPT$CPEXIT.DEBUG_
     12628**DCL     14334<<ASSIGN
FPT$CPEXIT.NAME_
     12627**DCL     14316<<ASSIGN  14753<<ASSIGN
FPT$CPEXIT.PASS_
     12627**DCL     14323<<ASSIGN
FPT$CPEXIT.PSID_
     12627**DCL     14328<<ASSIGN
FPT$CPEXIT.V
     12628**DCL     14046--ASSIGN
FPT$CPEXIT.V.ALTRTN#
     12633**DCL     14589<<ASSIGN  14665<<ASSIGN
FPT$CPEXIT.V.CONT#
     12633**DCL     14586<<ASSIGN
FPT$CPEXIT.V.JERR
     12635**DCL     14591<<ASSIGN  14666<<ASSIGN
FPT$CPEXIT.V.QUIT#
     12633**DCL     14069<<ASSIGN  14492<<ASSIGN
FPT$CPEXIT.V_
     12628**DCL     14046<<ASSIGN
FPT$DELREC
     12805**DCL     14402<>CALL
FPT$ERRMSG
     13134**DCL     14711<>CALL
FPT$ERRMSG.BUF_
     13134**DCL     14708<<ASSIGN
FPT$ERRMSG.CODE_
     13134**DCL     14709<<ASSIGN
FPT$ERRMSG.V.DCB#
     13138**DCL     14710<<ASSIGN
FPT$GDS
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:127  
     12651**DCL     14255<>CALL
FPT$GETDCB
     12564**DCL     14056<>CALL
FPT$GETDCB_CPSL
     12226**DCL     14571<<ASSIGN  14582<>CALL
FPT$GETDCB_CPSL.DCBNUM_
     12226**DCL     14578<<ASSIGN
FPT$GETDCB_CPSL.V
     12227**DCL     14577--ASSIGN
FPT$GETDCB_CPSL.V.DCB#
     12227**DCL     14579<<ASSIGN
FPT$GETDCB_CPSL.V_
     12226**DCL     14577<<ASSIGN
FPT$KEYIN
     13113**DCL     14713<>CALL
FPT$OCMSG
     13074**DCL     14106<>CALL    14716<>CALL
FPT$OCMSG.V.MSG#
     13075**DCL     14101<<ASSIGN  14715<<ASSIGN
FPT$OCMSG.V.SUBC#
     13076**DCL     14104<<ASSIGN
FPT$OPEN_CG
     13017**DCL     14175<>CALL    14308<>CALL
FPT$OPEN_CG.ACSVEH_
     13019**DCL     13020--REDEF
FPT$OPEN_CG.ALTKEYS_
     13025**DCL     13026--REDEF   13026--REDEF
FPT$OPEN_CG.HDR_
     13024**DCL     13025--REDEF
FPT$OPEN_CG.TAB_
     13023**DCL     13024--REDEF
FPT$OPEN_CG.UHL_
     13017**DCL     13018--REDEF   13018--REDEF
FPT$OPEN_CG.V.FSN#
     13057**DCL     13057--REDEF   13057--REDEF
FPT$OPEN_CG.WSN_
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:128  
     13023**DCL     13023--REDEF
FPT$OPEN_FILE
     12748**DCL     14230<>CALL    14392<>CALL    14731<>CALL
FPT$OPEN_FILE.ACSVEH_
     12750**DCL     12751--REDEF
FPT$OPEN_FILE.ALTKEYS_
     12756**DCL     12757--REDEF   12757--REDEF
FPT$OPEN_FILE.HDR_
     12755**DCL     12756--REDEF
FPT$OPEN_FILE.IFPARAM_
     12753**DCL     14224--ASSIGN  14226--ASSIGN  14390<<ASSIGN  14729<<ASSIGN
FPT$OPEN_FILE.TAB_
     12754**DCL     12755--REDEF
FPT$OPEN_FILE.UHL_
     12748**DCL     12749--REDEF   12749--REDEF
FPT$OPEN_FILE.V.FSN#
     12788**DCL     12788--REDEF   12788--REDEF
FPT$OPEN_FILE.WSN_
     12754**DCL     12754--REDEF
FPT$READ_CG
     12895**DCL     14200<>CALL
FPT$READ_CG.STATION_
     12898**DCL     12899--REDEF
FPT$READ_CG.V.DVBYTE.REREAD#
     12910**DCL     12910--REDEF
FPT$READ_CG.V.INDX#
     12908**DCL     12908--REDEF
FPT$READ_KEY
     12496**DCL     14246<>CALL    14739<>CALL
FPT$READ_KEY.BUF_
     12498**DCL     14257<<ASSIGN
FPT$READ_KEY.STATION_
     12499**DCL     12500--REDEF
FPT$READ_KEY.V.DVBYTE.REREAD#
     12511**DCL     12511--REDEF
FPT$READ_KEY.V.INDX#
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:129  
     12509**DCL     12509--REDEF
FPT$RELDCB
     12581**DCL     14109<>CALL
FPT$RELDCB_CPSL
     12212**DCL     14114<<ASSIGN  14117<>CALL    14572<<ASSIGN  14627<>CALL
FPT$RELDCB_CPSL.V
     12212**DCL     14115--ASSIGN  14625--ASSIGN
FPT$RELDCB_CPSL.V.DCB#
     12212**DCL     14116<<ASSIGN  14626<<ASSIGN
FPT$RELDCB_CPSL.V_
     12212**DCL     14115<<ASSIGN  14625<<ASSIGN
FPT$UNLATCH
     12870**DCL     14265<>CALL    14507<>CALL    14611<>CALL
FPT$WRITE_CG.STATION_
     12938**DCL     12938--REDEF
FPT$WRITE_CG.V.DVBYTE.VFC#
     12945**DCL     12945--REDEF
FPT$WRITE_KEY
     12537**DCL     14450<>CALL
FPT$WRITE_KEY.BUF_.BOUND
     12537**DCL     14415<<ASSIGN
FPT$WRITE_KEY.BUF_.BUF$
     12539**DCL     14412<<ASSIGN
FPT$WRITE_KEY.STATION_
     12539**DCL     12539--REDEF
FPT$WRITE_KEY.V.DVBYTE.VFC#
     12546**DCL     12546--REDEF
FPTV$YC.NOERR
     10661**DCL     14568>>ASSIGN
FPT_CPEXIT
     12598**DCL     14045>>ASSIGN
FPT_CPEXIT.V
     12601**DCL     12601--DCLINIT
FPT_GETDCB_CPSL
     11491**DCL     14571>>ASSIGN
FPT_GETDCB_CPSL.V
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:130  
     11492**DCL     11491--DCLINIT
FPT_RELDCB_CPSL
     11477**DCL     14114>>ASSIGN  14572>>ASSIGN
FPT_RELDCB_CPSL.V
     11477**DCL     11477--DCLINIT
GET_NEXT_XACTION
     14152**PROC    14093--CALL
GLOBAL$PTRS
     12361**DCL     14042>>ASSIGN
GLOBAL_PTRS
     11528**DCL     14042<<ASSIGN
GLOBAL_PTRS.BUFFER$
     11613**DCL     10668--IMP-PTR 14708>>ASSIGN
GLOBAL_PTRS.FPT$CLOSE$
     11595**DCL     12838--IMP-PTR 14247>>CALL    14350>>CALL    14454>>CALL    14760>>CALL
GLOBAL_PTRS.FPT$CPEXIT$
     11585**DCL     12625--IMP-PTR 14045>>ASSIGN  14046>>ASSIGN  14046>>ASSIGN  14069>>ASSIGN  14121>>CALL
     14316>>ASSIGN  14321>>ASSIGN  14323>>ASSIGN  14328>>ASSIGN  14334>>ASSIGN  14492>>ASSIGN  14586>>ASSIGN
     14589>>ASSIGN  14591>>ASSIGN  14665>>ASSIGN  14666>>ASSIGN  14753>>ASSIGN  14755>>ASSIGN
GLOBAL_PTRS.FPT$DELREC$
     11593**DCL     12805--IMP-PTR 14402>>CALL
GLOBAL_PTRS.FPT$ERRMSG$
     11603**DCL     13134--IMP-PTR 14708>>ASSIGN  14709>>ASSIGN  14710>>ASSIGN  14711>>CALL
GLOBAL_PTRS.FPT$FID$
     11589**DCL     12669--IMP-PTR
GLOBAL_PTRS.FPT$GDS$
     11587**DCL     12651--IMP-PTR 14255>>CALL
GLOBAL_PTRS.FPT$GETDCB$
     11581**DCL     12564--IMP-PTR 14056>>CALL
GLOBAL_PTRS.FPT$KEYIN$
     11611**DCL     13113--IMP-PTR 14713>>CALL
GLOBAL_PTRS.FPT$OCMSG$
     11607**DCL     13074--IMP-PTR 14101>>ASSIGN  14104>>ASSIGN  14106>>CALL    14715>>ASSIGN  14716>>CALL
GLOBAL_PTRS.FPT$OPEN_CG$
     11605**DCL     13017--IMP-PTR 14175>>CALL    14308>>CALL
GLOBAL_PTRS.FPT$OPEN_FILE$
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:131  
     11591**DCL     12748--IMP-PTR 14224>>ASSIGN  14226>>ASSIGN  14230>>CALL    14390>>ASSIGN  14392>>CALL
     14729>>ASSIGN  14731>>CALL
GLOBAL_PTRS.FPT$READ_CG$
     11599**DCL     12895--IMP-PTR 14200>>CALL
GLOBAL_PTRS.FPT$READ_KEY$
     11577**DCL     12496--IMP-PTR 14246>>CALL    14257>>ASSIGN  14739>>CALL
GLOBAL_PTRS.FPT$RELDCB$
     11583**DCL     12581--IMP-PTR 14109>>CALL
GLOBAL_PTRS.FPT$TIME$
     11609**DCL     13092--IMP-PTR
GLOBAL_PTRS.FPT$UNLATCH$
     11597**DCL     12870--IMP-PTR 14265>>CALL    14507>>CALL    14611>>CALL
GLOBAL_PTRS.FPT$WRITE_CG$
     11601**DCL     12936--IMP-PTR
GLOBAL_PTRS.FPT$WRITE_KEY$
     11579**DCL     12537--IMP-PTR 14412>>ASSIGN  14415>>ASSIGN  14450>>CALL
GLOBAL_PTRS.QX$GLOBAL$
     11617**DCL     13990--IMP-PTR 14065>>ASSIGN  14097>>IF      14163>>ASSIGN  14170>>ASSIGN  14186>>ASSIGN
     14195>>IF      14209>>ASSIGN  14233>>IF      14261>>IF      14277>>IF      14282>>ASSIGN  14296>>IF
     14296>>IF      14296>>IF      14301>>IF      14302>>ASSIGN  14309>>ASSIGN  14311>>IF      14340>>ASSIGN
     14344>>ASSIGN  14398>>IF      14400>>ASSIGN  14407>>ASSIGN  14418>>IF      14418>>IF      14432>>IF
     14437>>IF      14440>>ASSIGN  14565>>ASSIGN  14568>>ASSIGN  14593>>IF      14603>>IF
GLOBAL_PTRS.VLP$ACCT$
     11531**DCL     13556--IMP-PTR 14223>>ASSIGN  14321>>ASSIGN  14322>>ASSIGN  14389>>ASSIGN  14728>>ASSIGN
     14754>>ASSIGN  14755>>ASSIGN
GLOBAL_PTRS.VLP$ACCT_TRADER$
     11551**DCL     13764--IMP-PTR 14223>>ASSIGN
GLOBAL_PTRS.VLP$ASN$
     11569**DCL     13915--IMP-PTR
GLOBAL_PTRS.VLP$CODE07_PASS_TRADER$
     11555**DCL     13775--IMP-PTR
GLOBAL_PTRS.VLP$DCBNUM$
     11541**DCL     13633--IMP-PTR
GLOBAL_PTRS.VLP$DEBUGGER$
     11545**DCL     13691--IMP-PTR 14334>>ASSIGN  14335>>ASSIGN
GLOBAL_PTRS.VLP$FID$
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:132  
     11561**DCL     13836--IMP-PTR
GLOBAL_PTRS.VLP$GDS$
     11567**DCL     13910--IMP-PTR 14256>>ASSIGN
GLOBAL_PTRS.VLP$IFPARAM_PASS_TRADER$
     11553**DCL     13770--IMP-PTR 14224>>ASSIGN
GLOBAL_PTRS.VLP$KEY$
     11539**DCL     13630--IMP-PTR 14235>>CALLBLT 14239>>CALLBLT 14243>>ASSIGN  14401>>ASSIGN  14411>>ASSIGN
     14733>>CALLBLT 14738>>ASSIGN
GLOBAL_PTRS.VLP$LKEY$
     11543**DCL     13662--IMP-PTR
GLOBAL_PTRS.VLP$MSGTYP$
     11547**DCL     13720--IMP-PTR 14192>>ASSIGN  14193>>ASSIGN
GLOBAL_PTRS.VLP$NAME$
     11529**DCL     13541--IMP-PTR 14222>>ASSIGN  14316>>ASSIGN  14317>>ASSIGN  14387>>ASSIGN  14388>>ASSIGN
     14726>>ASSIGN  14727>>ASSIGN  14752>>ASSIGN  14753>>ASSIGN
GLOBAL_PTRS.VLP$NAME_TRADER$
     11549**DCL     13749--IMP-PTR 14222>>ASSIGN
GLOBAL_PTRS.VLP$PASS$
     11533**DCL     13571--IMP-PTR 14323>>ASSIGN  14324>>ASSIGN
GLOBAL_PTRS.VLP$SETSTA$
     11565**DCL     13881--IMP-PTR 14167>>ASSIGN  14168>>ASSIGN  14276>>ASSIGN  14279>>ASSIGN  14280>>ASSIGN
     14286>>ASSIGN  14292>>ASSIGN  14293>>ASSIGN  14299>>ASSIGN  14300>>ASSIGN  14302>>ASSIGN  14427>>ASSIGN
     14429>>ASSIGN  14430>>ASSIGN  14434>>ASSIGN  14439>>ASSIGN  14440>>ASSIGN  14444>>ASSIGN
GLOBAL_PTRS.VLP$SN$
     11535**DCL     13586--IMP-PTR 14229>>ASSIGN  14328>>ASSIGN  14329>>ASSIGN  14391>>ASSIGN  14730>>ASSIGN
GLOBAL_PTRS.VLP$SN_TRADER$
     11557**DCL     13790--IMP-PTR 14229>>ASSIGN
GLOBAL_PTRS.VLP$STATION$
     11563**DCL     13852--IMP-PTR 14191>>ASSIGN  14192>>ASSIGN
GLOBAL_PTRS.VLP$TIME$
     11571**DCL     13942--IMP-PTR
GLOBAL_PTRS.VLP$VECTOR$
     11559**DCL     13805--IMP-PTR
GLOBAL_PTRS.VLP$WSN$
     11537**DCL     13601--IMP-PTR
GLOBAL_PTRS.VLR$FID$
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:133  
     11573**DCL     13956--IMP-PTR
GLOBAL_PTRS.XUG$GETCMD$
     11615**DCL     13165--IMP-PTR 14562>>IF      14563>>CALL    14567>>ASSIGN  14584>>CALL
HDR_FLAGS_TPAP_ABORT
     10858**DCL     14498>>ASSIGN
HDR_FLAGS_UNDEF_XACT
     10819**DCL     14267>>ASSIGN
HDR_FLAGS_YCPMME_ABORT
     10897**DCL     14601>>ASSIGN
I
     11522**DCL     14410<<DOINDEX
IBEX_NAME
     11450**DCL     11138--DCLINIT 11178--DCLINIT
IGNORE IN PROCEDURE ACCOUNTING
     14710**LABEL   14711--CALLALT
IGNORE2 IN PROCEDURE ACCOUNTING
     14710**LABEL   14713--CALLALT
LNK_PMME
     14663**PROC    14081--CALL
LOGOFF_ERR IN PROCEDURE ACCOUNTING
     14707**LABEL   14700--CALLALT
LOGOFF_PARAM
     11635**DCL     14700<>CALL
LOGOFF_PARAM.CODE
     11636**DCL     14698<<ASSIGN
LOGOFF_PARAM.DCB1
     11647**DCL     14699<<ASSIGN
M$CLOSE
       935**DCL-ENT 14247--CALL    14350--CALL    14454--CALL    14760--CALL
M$CPEXIT
       949**DCL-ENT 14121--CALL
M$DELREC
       937**DCL-ENT 14402--CALL
M$ERRMSG
       998**DCL-ENT 14711--CALL
M$GDS
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:134  
       970**DCL-ENT 14255--CALL
M$GETDCB
       941**DCL-ENT 14056--CALL    14582--CALL
M$KEYIN
       940**DCL-ENT 14713--CALL
M$OCMSG
       999**DCL-ENT 14106--CALL    14716--CALL
M$OPEN
       935**DCL-ENT 14175--CALL    14230--CALL    14308--CALL    14392--CALL    14731--CALL
M$READ
       936**DCL-ENT 14200--CALL    14246--CALL    14739--CALL
M$RELDCB
       941**DCL-ENT 14109--CALL    14117--CALL    14627--CALL
M$TPCP$
     11621**DCL     14053<<ASSIGN  14054>>IF      14057<<ASSIGN  14220>>IF      14348>>IF      14758>>IF
M$UC$
     11620**DCL     14044<<ASSIGN  14160>>IF      14168>>ASSIGN  14239>>CALLBLT 14280>>ASSIGN  14286>>ASSIGN
M$UNLATCH
       955**DCL-ENT 14265--CALL    14507--CALL    14611--CALL
M$WRITE
       936**DCL-ENT 14450--CALL
MON_ERR
     14124**LABEL   14056--CALLALT 14106--CALLALT 14109--CALLALT 14117--CALLALT 14121--CALLALT
MON_ERR IN PROCEDURE ACCOUNTING
     14766**LABEL   14716--CALLALT 14731--CALLALT 14746--GOTO    14760--CALLALT
MON_ERR IN PROCEDURE BUILD_STARA
     14459**LABEL   14392--CALLALT 14402--CALLALT 14450--CALLALT 14454--CALLALT
MON_ERR IN PROCEDURE GET_NEXT_XACTION
     14356**LABEL   14183--GOTO    14215--GOTO    14230--CALLALT 14247--CALLALT 14255--CALLALT 14265--CALLALT
     14273--GOTO    14308--CALLALT 14313--CALLALT 14350--CALLALT
MON_ERR IN PROCEDURE YC_PMME
     14633**LABEL   14563--CALLALT 14582--CALLALT 14627--CALLALT
MSGBLK
     11672**DCL     14266<>CALL    14269<>CALL    14495<>CALL    14505<>CALL    14596<>CALL    14609<>CALL
     14707<>CALL
MSGBLK.ERRINFO.DCB#
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:135  
     11752**DCL     14497<<ASSIGN  14600<<ASSIGN  14710>>ASSIGN
MSGBLK.ERRINFO.ERR
     11750**DCL     14268<<ASSIGN  14496<<ASSIGN  14597<<ASSIGN  14709--ASSIGN
MSGBLK.FLAGS.DEST.DODCB
     11720**DCL     14599<<ASSIGN
MSGBLK.FLAGS.DEST.MCT
     11718**DCL     14598<<ASSIGN
MSGBLK.FLAGS.DEST.STATION
     11714**DCL     14502<<ASSIGN  14606<<ASSIGN
MSGBLK.FLAGS.HDR
     11691**DCL     14267<<ASSIGN  14498<<ASSIGN  14601<<ASSIGN
NO_BLANK IN PROCEDURE ACCOUNTING
     14738**LABEL   14734--CALLALT
OPEN_ERR IN PROCEDURE GET_NEXT_XACTION
     14180**LABEL   14175--CALLALT
PTR$_BITS
     11626**DCL     14421<<ASSIGN
PTR$_BITS.WORDS
     11627**DCL     14424>>IF      14426>>ASSIGN
QT$ENTRY
     10407**DCL     14409--ASSIGN
QT$ENTRY.DEBUGGER
     10438**DCL     14335>>ASSIGN
QT$ENTRY.DEBUGGER.COUNT
     10440**DCL     14332>>IF
QT$ENTRY.FLAGS.DCBS_SET
     10410**DCL     14311>>IF      14405>>IF
QT$ENTRY.FLAGS.MESSAGE
     10416**DCL     14338>>IF      14500>>IF
QT$ENTRY.FLAGS.NEW_LOCK
     10414**DCL     14290>>IF
QT$ENTRY.SET_COUNT
     10443**DCL     14410>>DOINDEX
QT$ENTRY.TPAP.ACCT
     10432**DCL     14322>>ASSIGN
QT$ENTRY.TPAP.NAME
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:136  
     10428**DCL     14317>>ASSIGN
QT$ENTRY.TPAP.NAME.COUNT
     10430**DCL     14318>>ASSIGN  14319>>ASSIGN
QT$ENTRY.TPAP.NAME.TEXT
     10431**DCL     14320>>ASSIGN
QT$ENTRY.TPAP.PASS
     10434**DCL     14324>>ASSIGN
QT$ENTRY.TPAP.SN
     10436**DCL     14326>>IF      14329>>ASSIGN
QT$SETBITS
     10629**DCL     14448--ASSIGN
QT$SETBITS.ASN_MERGE.COUNT
     10646**DCL     10647--IMP-SIZ 14415>>ASSIGN  14448>>ASSIGN
QT$SETBITS.ASN_MERGE.TEXT
     10647**DCL     14412--ASSIGN  14420--ASSIGN
QT$SETBITS.DCBNAME
     10640**DCL     14411>>ASSIGN
QX$GLOBAL.EXITING
     13997**DCL     14065<<ASSIGN  14097>>IF      14163<<ASSIGN  14186<<ASSIGN  14209<<ASSIGN
QX$GLOBAL.MESSAGE
     13995**DCL     14340<<ASSIGN  14344<<ASSIGN  14603>>IF
QX$GLOBAL.NOW
     14003**DCL     14195>>IF      14233>>IF      14261>>IF      14277>>IF      14282<<ASSIGN
QX$GLOBAL.PERM
     14001**DCL     14296>>IF      14418>>IF
QX$GLOBAL.SEMIPERM
     13999**DCL     14296>>IF      14418>>IF      14432>>IF
QX$GLOBAL.SETS
     13991**DCL     14311>>IF      14398>>IF      14400<<ASSIGN  14407<<ASSIGN
QX$GLOBAL.SETSTA_LOCKED
     13993**DCL     14170<<ASSIGN  14309<<ASSIGN
QX$GLOBAL.SKIP_ERRS
     14007**DCL     14565<<ASSIGN  14568<<ASSIGN  14593>>IF
QX$GLOBAL.TIMEOUT
     14005**DCL     14296>>IF      14301>>IF      14302>>ASSIGN  14437>>IF      14440>>ASSIGN
QXA$INIT
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:137  
     10282**DCL-ENT 14039--CALL
QXC$BLDMSG
     10280**DCL-ENT 14269--CALL    14505--CALL    14609--CALL
QXC$BLDMSG_ERRBLK
     10281**DCL-ENT 14266--CALL    14495--CALL    14596--CALL    14707--CALL
QXC$SCREECH
     10279**DCL-ENT 14125--CALL    14357--CALL    14517--CALL    14618--CALL    14634--CALL    14767--CALL
QX_GLOBAL.DS2$_BITS
       722**DCL       722--REDEF
QX_GLOBAL.DS4$_BITS
       722**DCL       723--REDEF
QX_GLOBAL.GLOBAL$PTRS$
       722**DCL     12361--IMP-PTR 14042>>ASSIGN
QX_GLOBAL.QT$ENTRY$
       723**DCL     10407--IMP-PTR 10463--IMP-PTR 14257>>ASSIGN  14290>>IF      14311>>IF      14317>>ASSIGN
     14318>>ASSIGN  14319>>ASSIGN  14320>>ASSIGN  14322>>ASSIGN  14324>>ASSIGN  14326>>IF      14329>>ASSIGN
     14332>>IF      14335>>ASSIGN  14338>>IF      14405>>IF      14409>>ASSIGN  14410>>DOINDEX 14500>>IF
     14752>>ASSIGN
READ_CG IN PROCEDURE GET_NEXT_XACTION
     14191**LABEL   14270--GOTO
READ_CG_ERR IN PROCEDURE GET_NEXT_XACTION
     14205**LABEL   14200--CALLALT
READ_ERR IN PROCEDURE ACCOUNTING
     14744**LABEL   14739--CALLALT
READ_TRADER IN PROCEDURE GET_NEXT_XACTION
     14246**LABEL   14258--GOTO
READ_TRADER_ERR IN PROCEDURE GET_NEXT_XACTION
     14252**LABEL   14246--CALLALT
REC$
     11623**DCL     14409<<ASSIGN  14411>>ASSIGN  14412>>ASSIGN  14415>>ASSIGN  14420>>ASSIGN  14448<<ASSIGN
     14448>>ASSIGN  14448>>ASSIGN  14448>>ASSIGN
RET IN PROCEDURE ACCOUNTING
     14758**LABEL   14721--GOTO    14749--GOTO
RET IN PROCEDURE GET_NEXT_XACTION
     14348**LABEL   14164--GOTO    14187--GOTO    14210--GOTO
SETSTA$
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:138  
     11622**DCL     14426<<ASSIGN  14427>>ASSIGN  14444>>ASSIGN
SET_VLP_TRADER IN PROCEDURE GET_NEXT_XACTION
     14220**LABEL   14197--GOTO
UNLATCH_ERR IN PROCEDURE USER_ABORTED
     14512**LABEL   14507--CALLALT
USER_ABORTED
     14488**PROC    14088--CALL
VLP$ACCT
     13556**DCL     14223<<ASSIGN  14321--ASSIGN  14755--ASSIGN
VLP$ACCT.ACCT#
     13556**DCL     14322<<ASSIGN  14389<<ASSIGN  14728<<ASSIGN  14754<<ASSIGN
VLP$ACCT_TRADER
     13764**DCL     14223>>ASSIGN
VLP$CODE07_PASS_TRADER
     13775**DCL     14226--ASSIGN
VLP$DEBUGGER
     13691**DCL     14334--ASSIGN  14335<<ASSIGN
VLP$GDS.W1.VSIZE#
     13910**DCL     14256>>ASSIGN
VLP$GDS.W2
     13911**DCL     13912--REDEF
VLP$IFPARAM_PASS_TRADER
     13770**DCL     14224--ASSIGN  14226--ASSIGN
VLP$KEY
     13630**DCL     14401<<ASSIGN  14411<<ASSIGN
VLP$KEY.L#
     13630**DCL     14243<<ASSIGN  14738<<ASSIGN
VLP$KEY.NAME#
     13630**DCL     14235<<CALLBLT 14239<<CALLBLT 14733<<CALLBLT
VLP$MSGTYP.NAME#
     13720**DCL     14192>>ASSIGN  14193>>ASSIGN
VLP$NAME
     13541**DCL     14222<<ASSIGN  14316--ASSIGN  14317<<ASSIGN  14752<<ASSIGN  14753--ASSIGN
VLP$NAME.L#
     13541**DCL     14387<<ASSIGN  14726<<ASSIGN
VLP$NAME.NAME#
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:139  
     13541**DCL     14388<<ASSIGN  14727<<ASSIGN
VLP$NAME_TRADER
     13749**DCL     14222>>ASSIGN
VLP$PASS
     13571**DCL     14323--ASSIGN
VLP$PASS.PASS#
     13571**DCL     14324<<ASSIGN
VLP$SETSTA
     13881**DCL     14167<<ASSIGN  14276<<ASSIGN  14427<<ASSIGN  14427>>ASSIGN  14444<<ASSIGN  14444>>ASSIGN
VLP$SETSTA.ISTA.EOFNONE#
     13887**DCL     14299<<ASSIGN  14429<<ASSIGN  14434<<ASSIGN  14439<<ASSIGN
VLP$SETSTA.ISTA.EOFONE#
     13887**DCL     14300<<ASSIGN  14430<<ASSIGN
VLP$SETSTA.ISTA.EOFTIME#
     13889**DCL     14302<<ASSIGN  14440<<ASSIGN
VLP$SETSTA.ISTA.ILOCK#
     13886**DCL     14292<<ASSIGN
VLP$SETSTA.ISTA.IMSGTYP#
     13886**DCL     14279<<ASSIGN  14286<<ASSIGN
VLP$SETSTA.MYSTATION#
     13885**DCL     14168<<ASSIGN  14168>>ASSIGN  14280<<ASSIGN  14280>>ASSIGN
VLP$SETSTA.OSTA.OLOCK#
     13891**DCL     14293<<ASSIGN
VLP$SN
     13586**DCL     14229<<ASSIGN  14328--ASSIGN
VLP$SN.SN#
     13586**DCL     14329<<ASSIGN  14391<<ASSIGN  14730<<ASSIGN
VLP$SN_TRADER
     13790**DCL     14229>>ASSIGN
VLP$STATION
     13852**DCL     14191<<ASSIGN
VLP$STATION.MSGIDXT
     13862**DCL     13865--REDEF
VLP$STATION.MSGTYP#
     13856**DCL     14192<<ASSIGN  14239>>CALLBLT 14286>>ASSIGN
VLP$VECTOR.PTR$
PL6.E3A0      #001=QXA$TPCP File=QXA$TPCP.:E05TSI                                WED 07/30/97 05:53 Page:140  
     13807**DCL     14224<<ASSIGN
VLP$VECTOR.W1.VSIZE#
     13805**DCL     14226<<ASSIGN
VLP$VECTOR.W2
     13806**DCL     13807--REDEF
VLP_SETSTA_LOCKED
     10963**DCL     14276>>ASSIGN
VLP_SETSTA_UNLOCKED
     10933**DCL     14167>>ASSIGN
VLP_STATION
     10991**DCL     14191>>ASSIGN
VLP_STATION.MSGIDXT
     11001**DCL     11004--REDEF
X$PRE_PROCESS
     10283**DCL-ENT 11129--DCLINIT
XUG$GETCMD
     13165**DCL     14563<>CALL    14584<>CALL
XUG$GETCMD.OUT$
     13170**DCL     13176--REDEF
XUG$GETCMD.TEXT_
     13428**DCL     14567<<ASSIGN
XUG$GETCMD.WORK$
     13198**DCL     14562>>IF
XUG$INIT
     11809**DCL     14553<<ASSIGN  14563<>CALL
XUG_INIT
     11033**DCL     14553>>ASSIGN
YC_PMME
     14550**PROC    14076--CALL
