VERSION E05

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:1    
        1        1        /*M* DPM$PLOVER - main procedure for PLOVER. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        DPM$PLOVER:   PROC  MAIN;
        8        8
        9        9
       10       10        /********************************************************************/
       11       11        /*        Include files           Include files                     */
       12       12        /********************************************************************/
       13       13
       14       14        %INCLUDE  DP_SUBS_C;
       15       76        %INCLUDE  DP_PERR_C;
       16      103        %INCLUDE  DP_MACRO_C;
       17      124        %INCLUDE  XU_MACRO_C;
       18     3230        %INCLUDE  XU_FORMAT_C;
       19     3392        %INCLUDE  XUF_ENTRY;
       20     3400        %INCLUDE  XUH_MACRO_C;
       21     3484        %INCLUDE  XUR_ENTRY;
       22     3516        %INCLUDE  CP_6;
       23     3597        %INCLUDE  B$JIT;
       24     3887        %INCLUDE  B_ERRORS_C;
       25     5014        %INCLUDE  CP_6_SUBS;
       26     5554        %INCLUDE  B$OBJECT_C;
       27     8984        %INCLUDE  B_MICROPS_C;
       28     9156
       29     9157        /********************************************************************/
       30     9158        /*        'FPTs'                  'FPTs'                            */
       31     9159        /********************************************************************/
       32     9160
       33     9161        %FPT_EXIT( FPTN=SET_STEPCC_TO_4, STEPCC=4 , STCLASS = CONSTANT );
       34     9176        %FPT_TIME( FPTN=GET_PLOVER_UTS, SOURCE=CLOCK, DEST=UTS, TSTAMP=PLOVER_UTS , STCLASS
              9176            = CONSTANT );
       35     9195        %FPT_TIME( FPTN=TIME_UTS, SOURCE=LOCAL, DATE=DATE, TIME=TIME, DEST=UTS, TSTAMP=UTS ,
              9195            STCLASS = CONSTANT );
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:2    
       36     9214        %FPT_TIME( FPTN=UTS_TIME, SOURCE=UTS, DATE=DATE, TIME=TIME, DEST=LOCAL, TSTAMP=UTS ,
              9214            STCLASS = CONSTANT );
       37     9233        %FPT_CLOSE( FPTN=CLOSE_SI, DCB=M$SI, DISP=SAVE , STCLASS = CONSTANT );
       38     9275        %VLP_NAME;
       39     9302        %VLP_ACCT;
       40     9315        %VLP_PASS;
       41     9328        %VLP_SN( N=9 );
       42     9341        %VLP_WSN;
       43     9354        %VLR_FID;
       44     9373
       45     9374        /********************************************************************/
       46     9375        /*        X$FORMAT stuff          X$FORMAT stuff                    */
       47     9376        /********************************************************************/
       48     9377
       49     9378        %F_FDS(NAME=F_FDS, STCLASS=STATIC, DCB=M$LO, BUF=OUT_BUF, TRUNC=NO, WRAPTAB=4);
       50     9491    1   DCL OUT_BUF CHAR(80) STATIC INIT(' ');
       51     9492
       52     9493        /********************************************************************/
       53     9494        /*        XUH$HELP stuff          XUH$HELP stuff                    */
       54     9495        /********************************************************************/
       55     9496
       56     9497        %XUH_PARAM( NAME=XUH_PARAM, PROCNAME=PLOVER, PROCACCT=SYS_ACCT,
       57     9498                    OUTDCB1=M$LO, OUTDCB2=M$DO, STCLASS=STATIC );
       58     9559        %VLP_NAME( FPTN=PLOVER, NAME='PLOVER', LEN=6, STCLASS=CONSTANT );
       59     9586        %VLP_ACCT( FPTN=SYS_ACCT, ACCT=':SYS', STCLASS = CONSTANT );
       60     9599
       61     9600        /********************************************************************/
       62     9601        /*        XUR$GETCMD stuff        XUR$GETCMD stuff                  */
       63     9602        /********************************************************************/
       64     9603
       65     9604        %XUR_INIT( NAME=XUR_INIT, STCLASS=STATIC, PCB=P_PCB, SYNTAX=YES );
       66     9703    1   DCL U$$ EPTR CONSTANT INIT( ENTADDR(DPM$PARSE_U$) );
       67     9704    1   DCL DPM$PARSE_U$ ENTRY(1);
       68     9705
       69     9706        /********************************************************************/
       70     9707        /*        X$PARSE  stuff          X$PARSE  stuff                    */
       71     9708        /********************************************************************/
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:3    
       72     9709
       73     9710        %P_PCB( NAME=P_PCB, STCLASS=STATIC );
       74     9909        %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(OUT$)" );
       75     9954        %PARSE$SYM( NAME=OUT$SYM, STCLASS="BASED(BLK$)" );
       76     9992
       77     9993        /********************************************************************/
       78     9994        /*        B$OBJECT_C stuff        B$OBJECT_C stuff                  */
       79     9995        /********************************************************************/
       80     9996
       81     9997        %B$RECORDSUBS;
       82    10025        %B$HEADKEY( NAME=OU_KEY, STCLASS=STATIC );
       83    10037        %B$HEADKEY( NAME=HEAD_KEY, STCLASS=STATIC );
       84    10049        %B$PLOVERKEY( STCLASS="BASED(OU_KEY$)" );
       85    10079        %B$PLOVERKEY( NAME=PLOVER_KEY, STCLASS=STATIC );
       86    10109        %B$OUHEAD( NAME=HEAD_RECORD, STCLASS=STATIC );
       87    10227        %B$PLOVERBIRTH( NAME=PLOVER_BIRTH, STCLASS=STATIC );
       88    10249        %B$PLOVERBIRTH( STCLASS="BASED(TXT$)" );
       89    10271        %B$PLOVERBIRTHKEY( NAME=PLOVER_BIRTH_KEY, STCLASS=STATIC );
       90    10294        %B$PLOVERBIRTHKEY( STCLASS="BASED(OU_KEY$)" );
       91    10317
       92    10318        /********************************************************************/
       93    10319        /*        'DCBs'                  'DCBs'                            */
       94    10320        /********************************************************************/
       95    10321
       96    10322    1   DCL M$SI DCB;
       97    10323    1   DCL M$LO DCB;
       98    10324    1   DCL M$DO DCB;
       99    10325    1   DCL M$OF DCB;
      100    10326
      101    10327        /********************************************************************/
      102    10328        /*        Global based data       global based data                 */
      103    10329        /********************************************************************/
      104    10330
      105    10331        %F$DCB;
      106    10388        %B$TCB( STCLASS="BASED(B$TCB$)" );
      107    10391        %B$ALT;
      108    10399    1   DCL BASED$TEXT CHAR(CNT) BASED;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:4    
      109    10400
      110    10401        /********************************************************************/
      111    10402        /*        Global static data      global static data                */
      112    10403        /********************************************************************/
      113    10404
      114    10405    1   DCL DATE CHAR(8) STATIC;
      115    10406    1   DCL TIME CHAR(11) STATIC;
      116    10407    1   DCL DATE_TIME CHAR(21) STATIC;
      117    10408    1   DCL READ_FILE BIT(1) STATIC INIT('0'B);
      118    10409    1   DCL OU_ASSOCIATED BIT(1) STATIC INIT('0'B);
      119    10410    1   DCL OUF_ASSOCIATED BIT(1) STATIC INIT('0'B);
      120    10411    1   DCL NUM_ERRORS SBIN WORD STATIC INIT( 0 );
      121    10412    1   DCL COMP_UTS UBIN WORD STATIC;
      122    10413    1   DCL PLOVER_UTS UBIN WORD STATIC;
      123    10414    1   DCL UTS UBIN WORD STATIC;
      124    10415    1   DCL CMD SBIN WORD STATIC INIT( PLOVER_VAL );
      125    10416    1   DCL TXT CHAR(256) STATIC;
      126    10417    1   DCL CNT SBIN WORD STATIC;
      127    10418    1   DCL NUM_SECTS SBIN WORD STATIC;
      128    10419    1   DCL PLOVER_BIRTH_ARS# UBIN STATIC INIT (52);
      129    10420
      130    10421        /********************************************************************/
      131    10422        /*        Global constant data      global constant data            */
      132    10423        /********************************************************************/
      133    10424
      134    10425    1   DCL PROMPT CHAR(0) CONSTANT INIT('>>');
      135    10426    1   DCL TXT$ PTR CONSTANT INIT(ADDR(TXT));
      136    10427    1   DCL OU_KEY$ PTR CONSTANT INIT(ADDR(OU_KEY));
      137    10428
      138    10429        /********************************************************************/
      139    10430        /*        Symref data             Symref data                       */
      140    10431        /********************************************************************/
      141    10432
      142    10433    1   DCL B$JIT$ PTR SYMREF;
      143    10434    1   DCL B$TCB$ PTR SYMREF;
      144    10435    1   DCL 1 B_VERSION ALIGNED SYMREF,
      145    10436    1         2 COUNT UBIN BYTE UNAL,
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:5    
      146    10437    1         2 TEXT  CHAR(6)   UNAL;
      147    10438    1   DCL INVOKE_CMD SBIN WORD SYMREF;
      148    10439    1   DCL PLOVER_COMMANDS SBIN WORD SYMREF;
      149    10440
      150    10441        /********************************************************************/
      151    10442        /*        Global auto data        global auto data                  */
      152    10443        /********************************************************************/
      153    10444
      154    10445    1   DCL OUT$ PTR;
      155    10446    1   DCL 1 PARSERR REDEF OUT$,
      156    10447    1         2 FCG BIT(12) UNAL,
      157    10448    1         2 MID BIT(6) UNAL,
      158    10449    1         2 MON BIT(1) UNAL,
      159    10450    1         2 CODE UBIN(14) UNAL,
      160    10451    1         2 SEV UBIN(3) UNAL;
      161    10452    1   DCL M$OF$ PTR;
      162    10453    1   DCL M$SI$ PTR;
      163    10454    1   DCL BLK$ PTR;
      164    10455    1   DCL MORE BIT(1);
      165    10456    1   DCL DEVICE_CMD_FILE BIT(1);
      166    10457    1   DCL DO_CMD BIT(1);
      167    10458    1   DCL I SBIN WORD;
      168    10459    1   DCL PLOVER_BIRTH_SIZE UBIN;
      169    10460    1   DCL 1 OU_NAME,
      170    10461    1         2 COUNT SBIN BYTE UNAL,
      171    10462    1         2 TEXT CHAR(31) UNAL;
      172    10463    1   DCL 1 FIELD1 ALIGNED,
      173    10464    1         2 COUNT UBIN BYTE UNAL,
      174    10465    1         2 TEXT CHAR(31);
      175    10466    1   DCL 1 FIELD2 ALIGNED,
      176    10467    1         2 COUNT UBIN BYTE UNAL,
      177    10468    1         2 TEXT CHAR(31);
      178    10469    1   DCL 1 FIELD3 ALIGNED,
      179    10470    1         2 COUNT UBIN BYTE UNAL,
      180    10471    1         2 TEXT CHAR(31);
      181    10472        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:6    
      182    10473    1         CALL XUR$SETDCBS( DCBNUM(M$SI), DCBNUM(M$LO) );
      183    10474    1         CALL XUR$INIT( XUR_INIT );
      184    10475    1         M$OF$ = DCBADDR(DCBNUM(M$OF));
      185    10476    1         M$SI$ = DCBADDR(DCBNUM(M$SI));
      186    10477    1         TXT = B$JIT.CCBUF;
      187    10478    1         CNT = B$JIT.CCARS;
      188    10479    1         CALL XUR$GETCMD(INVOKE_CMD, OUT$, ,TXT,CNT,U$$)
      189    10480    2         WHENALTRETURN DO;
      190    10481    2             CALL XUR$ERRPTR( , DCBNUM(M$DO) );
      191    10482    2             CALL XUR$ERRMSG( PARSERR );
      192    10483    2             CALL M$EXIT( SET_STEPCC_TO_4 );
      193    10484    2             END;
      194    10485    1         CALL PLOVER_COMMAND;
      195    10486    1         IF NOT M$SI$->F$DCB.FCD# THEN CALL OPEN_CMD_FILE;
      196    10487    1         DEVICE_CMD_FILE = ( M$SI$->F$DCB.ASN# = %DEVICE# );
      197    10488    1         MORE = '1'B;
      198    10489    1         DO_CMD = '1'B;
      199    10490    2         DO WHILE( MORE );
      200    10491    2             CALL XUR$GETCMD(PLOVER_COMMANDS, OUT$, VECTOR(PROMPT), , , U$$ ) ALTRET(
             10491                      PARSE_ERR);
      201    10492    2             CMD = P$NODE.CODE;
      202    10493    3             DO CASE( CMD );
      203    10494    3               CASE( END_VAL );
      204    10495    3                 MORE = '0'B;
      205    10496
      206    10497    3               CASE( BLANK_VAL );
      207    10498
      208    10499    3               CASE( HELP_VAL );
      209    10500    3                 XUH_PARAM.HELP$ = P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);
      210    10501    3                 XUH_PARAM.TOPICS# = '0'B;
      211    10502    3                 CALL XUR$HELP( XUH_PARAM );
      212    10503
      213    10504    3               CASE( QUEST_VAL );
      214    10505    3                 CALL XUR$MOREMSG( XUH_PARAM );
      215    10506
      216    10507    3               CASE( DQUEST_VAL );
      217    10508    3                 CALL XUR$ALLMSG( XUH_PARAM );
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:7    
      218    10509
      219    10510    3               CASE( PLOVER_VAL );
      220    10511    3                 CALL PLOVER_COMMAND         ALTRET( READ_ERR );
      221    10512    3                 DO_CMD = '1'B;
      222    10513
      223    10514    3               CASE( MODIFY_VAL, DEFINE_VAL, SCHEMA_VAL, KILL_VAL, ECHO_VAL,
      224    10515    3                     STORE_VAL, PREV_VAL, NEXT_VAL, OPEN_VAL, COPY_VAL, STAR_VAL,
      225    10516    3                     SYNTAX_VAL, ALTVAR_VAL, FIND_VAL );
      226    10517    3                 IF DO_CMD THEN CALL RUM_COMMAND ALTRET( CMD_ERR );
      227    10518
      228    10519    3               CASE( LIST_VAL );
      229    10520    3                 IF DO_CMD THEN CALL LIST_COMMAND ALTRET( CMD_ERR );
      230    10521
      231    10522    3               CASE( DELETE_VAL );
      232    10523    4                 IF DO_CMD THEN DO;
      233    10524    4                     CALL DELETE_COMMAND         ALTRET( CMD_ERR );
      234    10525    4                     PLOVER_BIRTH.IPATCH = 0;
      235    10526    4                     PLOVER_BIRTH.DPATCH = 0;
      236    10527    4                     END;
      237    10528
      238    10529    3               CASE( SYMDEF_VAL );
      239    10530    3                 IF DO_CMD THEN CALL SYMDEF_COMMAND ALTRET( CMD_ERR );
      240    10531
      241    10532    3               CASE( ENTREF_VAL );
      242    10533    3                 IF DO_CMD THEN CALL ENTREF_COMMAND ALTRET( CMD_ERR );
      243    10534
      244    10535    3               CASE( EXT_VAL );
      245    10536    3                 IF DO_CMD THEN CALL EXTERNAL_COMMAND ALTRET( CMD_ERR );
      246    10537
      247    10538    3               CASE( READ_VAL );
      248    10539    3                 IF DO_CMD THEN CALL READ_COMMAND( P$NODE.SUBLK$(0) ) ALTRET(READ_ERR);
      249    10540
      250    10541    3               CASE( IPTCH_VAL ,DPTCH_VAL, RESET_VAL );
      251    10542    3                 IF DO_CMD THEN CALL IDPATCH_COMMAND( P$NODE.SUBLK$(0),CMD ) ALTRET (
             10542                          CMD_ERR);
      252    10543
      253    10544    3               END;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:8    
      254    10545    3             DO WHILE( '0'B );
      255    10546    3   PARSE_ERR:    IF PARSERR.MON  AND  PARSERR.CODE = %E$EOF THEN
      256    10547    3                     IF NOT READ_FILE THEN MORE = '0'B;
      257    10548    4                     ELSE DO;
      258    10549    4                         CALL XUR$ERRMSG( PARSERR, DCBNUM(M$SI) );
      259    10550    4                         READ_FILE = '0'B;
      260    10551    4   READ_ERR:             IF DEVICE_CMD_FILE THEN CALL OPEN_CMD_FILE;
      261    10552    4                         ELSE MORE = '0'B;
      262    10553    4                         DO_CMD = '1'B;
      263    10554    4                         END;
      264    10555    4                 ELSE DO;
      265    10556    4                     IF PARSERR.MON THEN
      266    10557    4                         MORE = '0'B;
      267    10558    5                     ELSE DO;
      268    10559        /*E*  ERROR:  DPM-E$BAD_COMMAND_LINE-C
      269    10560              MESSAGE: This command is invalid, and will be ignored.
      270    10561        */
      271    10562                              %SCREAM( ERR#=E$BAD_COMMAND_LINE );
      272    10572    5                         CALL XUR$ERRPTR( , DCBNUM(M$DO) );
      273    10573    6                         IF READ_FILE THEN DO;
      274    10574    6                             DO_CMD = '0'B;
      275    10575        /*E*  ERROR:  DPM-E$IGNORE_CMDS-C
      276    10576          MESSAGE: Commands in this file will not be executed until the next PLOVER command.
      277    10577        */
      278    10578                                  %SCREAM( ERR#=E$IGNORE_CMDS );
      279    10588    6                             END;
      280    10589    5                         END;
      281    10590    4                     CALL XUR$ERRMSG( PARSERR, DCBNUM(M$SI) );
      282    10591    4   CMD_ERR:          NUM_ERRORS = NUM_ERRORS + 1;
      283    10592    4                     END;
      284    10593    3                 END;
      285    10594    2             END;
      286    10595
      287    10596    1         CALL XUR$CLOSE_DCBS;
      288    10597
      289    10598    2         IF NUM_ERRORS > 0 THEN DO;
      290    10599    2             CALL M$EXIT( SET_STEPCC_TO_4 );
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:9    
      291    10600    2             END;
      292    10601        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:10   
      293    10602    1   OPEN_CMD_FILE: PROC;
      294    10603
      295    10604        %FPT_OPEN( DCB=M$SI, ASN=DEVICE, RES='ME', SCRUB=YES, REASSIGN=YES );
      296    10713
      297    10714    3         IF M$SI$->F$DCB.FCD# THEN CALL M$CLOSE( CLOSE_SI ) WHENALTRETURN DO; END;
      298    10715    2         CALL M$OPEN( FPT_OPEN )
      299    10716    3         WHENALTRETURN DO;
      300    10717    3             CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$SI) );
      301    10718    3             CALL M$EXIT( SET_STEPCC_TO_4 );
      302    10719    3             END;
      303    10720
      304    10721    2   END OPEN_CMD_FILE;
      305    10722        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:11   
      306    10723    1   WRITE_LO: PROC( BUF, BUF_SIZE );
      307    10724
      308    10725    2   DCL BUF CHAR(BUF_SIZE);
      309    10726    2   DCL BUF_SIZE SBIN WORD;
      310    10727
      311    10728        %FPT_WRITE( DCB=M$LO );
      312    10759
      313    10760    2         FPT_WRITE.BUF_ = VECTOR( BUF );
      314    10761    2         CALL M$WRITE( FPT_WRITE );
      315    10762    2         RETURN;
      316    10763
      317    10764    2   END WRITE_LO;
      318    10765        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:12   
      319    10766        /*I*  NAME:        OPEN_OF
      320    10767              PURPOSE:     Opens the object unit file for PLOVERing.
      321    10768              CALL:        CALL OPEN_OF  ALTRET
      322    10769              DATA:        BLK$->OUT$SYM.TEXT is the fid for the file.
      323    10770              DESCRIPTION: M$FID is called to convert the fid into name,
      324    10771                           account, etc.  If the fid is valid, M$OPEN is
      325    10772                           called to open the file. The altreturn is taken
      326    10773                           if there are any errors.
      327    10774        */
      328    10775    1   OPEN_OF: PROC ALTRET;
      329    10776
      330    10777        %FPT_OPEN( DCB=M$OF, ASN=FILE, ORG=KEYED, FUN=UPDATE, ACS=DIRECT, SCRUB=YES );
      331    10886        %FPT_CLOSE(DCB=M$OF, DISP=SAVE );
      332    10928        %FPT_FID( NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS, SN=VLP_SN, WSN=VLP_WSN,
      333    10929                  ASN=FPT_OPEN.V.ASN#, RES=FPT_OPEN.V.RES#, RESULTS=VLR_FID );
      334    10952
      335    10953
      336    10954    2         OUF_ASSOCIATED = '0'B;
      337    10955    2         OU_ASSOCIATED  = '0'B;
      338    10956    2         FPT_FID.TEXTFID_ = VECTOR( OUT$SYM.TEXT );
      339    10957    2         CALL M$FID( FPT_FID ) ALTRET( FID_ERR );
      340    10958    3         IF FPT_OPEN.V.ASN# ~= %FILE#  OR  NOT VLR_FID.NAME THEN DO;
      341    10959        /*E*  ERROR:  DPM-E$NOT_A_FILE-C
      342    10960              MESSAGE: Specfied PLOVER fid is not a file.
      343    10961        */
      344    10962                  %SCREAM( ERR#=E$NOT_A_FILE );
      345    10972    3             ALTRETURN;
      346    10973    3             END;
      347    10974    2         FPT_OPEN.NAME_ = VECTOR(VLP_NAME);
      348    10975    2         IF VLR_FID.ACCT THEN
      349    10976    2             FPT_OPEN.ACCT_ = VECTOR(VLP_ACCT);
      350    10977    2         ELSE
      351    10978    2             FPT_OPEN.ACCT_ = VECTOR(NIL);
      352    10979    2         IF VLR_FID.PASS THEN
      353    10980    2             FPT_OPEN.PASS_ = VECTOR(VLP_PASS);
      354    10981    2         ELSE
      355    10982    2             FPT_OPEN.PASS_ = VECTOR(NIL);
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:13   
      356    10983    2         IF VLR_FID.SN THEN
      357    10984    2             FPT_OPEN.SN_ = VECTOR(VLP_SN);
      358    10985    2         ELSE
      359    10986    2             FPT_OPEN.SN_ = VECTOR(NIL);
      360    10987    2         IF VLR_FID.WSN THEN
      361    10988    2             FPT_OPEN.WSN_ = VECTOR(VLP_WSN);
      362    10989    2         ELSE
      363    10990    2             FPT_OPEN.WSN_ = VECTOR(NIL);
      364    10991    2         IF M$OF$ -> F$DCB.FCD# THEN CALL M$CLOSE(FPT_CLOSE) ALTRET(OPEN_FILE);
      365    10992    2   OPEN_FILE:
      366    10993    2         CALL M$OPEN( FPT_OPEN ) ALTRET( OPEN_ERR );
      367    10994    3         IF M$OF$ -> F$DCB.ORG# ~= %KEYED# THEN DO;
      368    10995        /*E*  ERROR:  DPM-E$NOT_AN_OUF-C
      369    10996              MESSAGE: Specified PLOVER fid is not an OU file.
      370    10997        */
      371    10998                  %SCREAM( ERR#=E$NOT_AN_OUF );
      372    11008    3             ALTRETURN;
      373    11009    3             END;
      374    11010    2         OUF_ASSOCIATED = '1'B;
      375    11011    2         RETURN;
      376    11012
      377    11013    2   FID_ERR:
      378    11014    2         CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR );
      379    11015    2         ALTRETURN;
      380    11016
      381    11017    2   OPEN_ERR:
      382    11018    2         CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF) );
      383    11019    2         ALTRETURN;
      384    11020
      385    11021    2   END OPEN_OF;
      386    11022        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:14   
      387    11023        /*I*  NAME:        FIND_OU
      388    11024              PURPOSE:     Trys to find an object unit in the file being PLOVERed
      389    11025              CALL:        CALL FIND_OU  ALTRET
      390    11026              DATA:        BLK$->OUT$SYM.TEXT is the name of the object unit.
      391    11027              DESCRIPTION: READ_OU is called to read the head record for the
      392    11028                           object unit.  If the head record does not exist,
      393    11029                           then the object unit does not exist in the file and
      394    11030                           the altreturn is taken.  READ_OU is called again to
      395    11031                           read the PLOVER BIRTH record for the object unit
      396    11032                           into B$PLOVERBIRTH. If the PLOVER BIRTH record does
      397    11033                           not exist then B$PLOVERBIRTH is initialized. Also,
      398    11034                           if the current command is a PLOVER command, several
      399    11035                           global variables are set.
      400    11036        */
      401    11037    1   FIND_OU: PROC ALTRET;
      402    11038
      403    11039
      404    11040    2         HEAD_KEY.KEYSIZ = OUT$SYM.COUNT + 1;
      405    11041    2         HEAD_KEY.TEXT   = OUT$SYM.TEXT;
      406    11042    2         CALL READ_OU( VECTOR(HEAD_KEY), VECTOR(HEAD_RECORD) ) ALTRET( NO_HEAD );
      407    11043    2         B$PLOVERBIRTHKEY = PLOVER_BIRTH_KEY;
      408    11044    2         B$PLOVERBIRTHKEY.UTS    = HEAD_RECORD.UTS;
      409    11045    2         CALL READ_OU( VECTOR(B$PLOVERBIRTHKEY), VECTOR(TXT) ) ALTRET(NONE);
      410    11046    2         PLOVER_BIRTH_SIZE = M$OF$->F$DCB.ARS#;
      411    11047    3         IF PLOVER_BIRTH_SIZE ~= PLOVER_BIRTH_ARS# THEN DO;
      412    11048    3            B$PLOVERBIRTH.IPATCH = 0;
      413    11049    3            B$PLOVERBIRTH.DPATCH = 0;
      414    11050    3            END;
      415    11051    3         DO WHILE( '0'B );
      416    11052    3   NONE:     B$PLOVERBIRTH               = '0'B;
      417    11053    3             B$PLOVERBIRTH.OU_NAME.COUNT = OUT$SYM.COUNT;
      418    11054    3             B$PLOVERBIRTH.OU_NAME.TEXT  = OUT$SYM.TEXT;
      419    11055    3             B$PLOVERBIRTH.CREATE_UTS    = HEAD_RECORD.UTS;
      420    11056    3             END;
      421    11057    3         IF CMD = PLOVER_VAL THEN DO;
      422    11058    3             COMP_UTS         = HEAD_RECORD.UTS;
      423    11059    3             NUM_SECTS        = -1;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:15   
      424    11060    3             PLOVER_BIRTH_KEY = B$PLOVERBIRTHKEY;
      425    11061    3             PLOVER_BIRTH     = B$PLOVERBIRTH;
      426    11062    3             OU_ASSOCIATED    = '1'B;
      427    11063    3             END;
      428    11064    2         RETURN;
      429    11065
      430    11066    2   NO_HEAD:
      431    11067    3         IF B$TCB.ALT$->B$ALT.ERR.ERR# = %E$NOKEY THEN DO;
      432    11068        /*E*  ERROR:  DPM-E$OU_NOT_FOUND-C
      433    11069              MESSAGE: Object unit "%U1" not found.
      434    11070        */
      435    11071    3             FIELD1.COUNT = OUT$SYM.COUNT;
      436    11072    3             FIELD1.TEXT  = OUT$SYM.TEXT;
      437    11073                  %SCREAM( ERR#=E$OU_NOT_FOUND, F1=FIELD1 );
      438    11083    3             END;
      439    11084    2         ELSE
      440    11085    2             CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF) );
      441    11086    2         IF CMD = PLOVER_VAL THEN OU_ASSOCIATED = '0'B;
      442    11087    2         ALTRETURN;
      443    11088
      444    11089    2   END FIND_OU;
      445    11090        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:16   
      446    11091    1   READ_OU: PROC( KEY_, BUF_, ARS ) ALTRET;
      447    11092
      448    11093    2   DCL KEY_ BIT(72) ALIGNED;
      449    11094    2   DCL BUF_ BIT(72) ALIGNED;
      450    11095    2   DCL ARS  UBIN WORD;
      451    11096
      452    11097        %FPT_READ( DCB=M$OF, KEYS=YES );
      453    11136
      454    11137    2         FPT_READ.KEY_ = KEY_;
      455    11138    2         FPT_READ.BUF_ = BUF_;
      456    11139    2         CALL M$READ( FPT_READ ) ALTRET( ALT );
      457    11140    2         IF ADDR(ARS) ~= ADDR(NIL) THEN ARS = M$OF$->F$DCB.ARS#;
      458    11141    2         RETURN;
      459    11142
      460    11143    2   ALT:  ALTRETURN;
      461    11144
      462    11145    2   END READ_OU;
      463    11146        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:17   
      464    11147    1   READ_OU_SEQ: PROC( KEY_, BUF_, ARS ) ALTRET;
      465    11148
      466    11149
      467    11150    2   DCL KEY_ BIT(72) ALIGNED;
      468    11151    2   DCL BUF_ BIT(72) ALIGNED;
      469    11152    2   DCL ARS  UBIN WORD;
      470    11153
      471    11154        %FPT_READ( DCB=M$OF, KEYR=YES, KEYS=NO );
      472    11193
      473    11194    2         FPT_READ.KEY_ = KEY_;
      474    11195    2         FPT_READ.BUF_ = BUF_;
      475    11196    2         CALL M$READ( FPT_READ ) ALTRET( ALT );
      476    11197    2         ARS = M$OF$ -> F$DCB.ARS#;
      477    11198    2         RETURN;
      478    11199
      479    11200    2   ALT:  ALTRETURN;
      480    11201
      481    11202    2   END READ_OU_SEQ;
      482    11203        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:18   
      483    11204    1   WRITE_OU: PROC( KEY_, BUF_ ) ALTRET;
      484    11205
      485    11206
      486    11207    2   DCL KEY_ BIT(72) ALIGNED;
      487    11208    2   DCL BUF_ BIT(72) ALIGNED;
      488    11209
      489    11210        %FPT_WRITE( DCB=M$OF );
      490    11241
      491    11242
      492    11243    2         FPT_WRITE.KEY_ = KEY_;
      493    11244    2         FPT_WRITE.BUF_ = BUF_;
      494    11245    2         CALL M$WRITE( FPT_WRITE ) ALTRET( ALT );
      495    11246    2         RETURN;
      496    11247
      497    11248    2   ALT:  ALTRETURN;
      498    11249
      499    11250    2   END WRITE_OU;
      500    11251        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:19   
      501    11252    1   CHECK_UTS: PROC( PTR$ )   ALTRET;
      502    11253
      503    11254
      504    11255    2   DCL PTR$ PTR;
      505    11256    2   DCL I UBIN WORD;
      506    11257    2   DCL VAL UBIN WORD;
      507    11258    2   DCL MAX(0:6) UBIN WORD CONSTANT INIT(12,31,99,23,59,59,99);
      508    11259    2   DCL SEP(0:6) CHAR(1) CONSTANT INIT('/','/',' ',':',':','.',' ');
      509    11260
      510    11261    2         OUT$ = PTR$;
      511    11262    3         DO I = 0 TO 6;
      512    11263    3             BLK$ = P$NODE.SUBLK$(I);
      513    11264    3             CALL CHARBIN( VAL, OUT$SYM.TEXT );
      514    11265    4             IF VAL > MAX(I) THEN DO;
      515    11266        /*E*  ERROR:  DPM-E$UTS_FIELD_TOO_BIG-C
      516    11267              MESSAGE: "%U1" field of UTS is too big
      517    11268        */
      518    11269    4                 FIELD1.COUNT = OUT$SYM.COUNT;
      519    11270    4                 FIELD1.TEXT  = OUT$SYM.TEXT;
      520    11271                      %SCREAM( ERR#=E$UTS_FIELD_TOO_BIG, F1=FIELD1 );
      521    11281    4                 END;
      522    11282    3             IF OUT$SYM.COUNT = 1 THEN
      523    11283    3                 CALL INSERT( DATE_TIME, I*3, 3, '0', OUT$SYM.TEXT, SEP(I) );
      524    11284    3             ELSE
      525    11285    3                 CALL INSERT( DATE_TIME, I*3, 3, OUT$SYM.TEXT, SEP(I) );
      526    11286    3             END;
      527    11287    2         DATE = SUBSTR(DATE_TIME,0,8);
      528    11288    2         TIME = SUBSTR(DATE_TIME,9,11);
      529    11289    2         CALL M$TIME( TIME_UTS ) ALTRET( BAD_TIME );
      530    11290    3         IF CMD = PLOVER_VAL  AND  UTS ~= COMP_UTS THEN DO;
      531    11291    4             IF '0'B THEN DO;
      532    11292    4   BAD_TIME:     CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR );
      533    11293    4                 IF CMD ~= PLOVER_VAL THEN ALTRETURN;
      534    11294    4                 END;
      535    11295    4             ELSE DO;
      536    11296        /*E*  ERROR:  DPM-E$UTS_VIOLATION-C
      537    11297              MESSAGE: UTS violation.
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:20   
      538    11298        */
      539    11299                      %SCREAM( ERR#=E$UTS_VIOLATION );
      540    11309    4                 END;
      541    11310    3             OU_ASSOCIATED  = '0'B;
      542    11311    3             ALTRETURN;
      543    11312    3             END;
      544    11313
      545    11314    2   END CHECK_UTS;
      546    11315        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:21   
      547    11316    1   PLOVER_COMMAND:   PROC   ALTRET;
      548    11317
      549    11318    2   DCL I SBIN WORD;
      550    11319    2   DCL J SBIN WORD;
      551    11320    2   DCL OU_SPECIFIED BIT(1);
      552    11321    2   DCL OUF_SPECIFIED BIT(1);
      553    11322    2   DCL UTS_BLK$ PTR;
      554    11323    2   DCL READ_BLK$ PTR;
      555    11324
      556    11325    2         I = P$NODE.NSUBLKS - 1;
      557    11326    2         READ_BLK$ = ADDR(NIL);
      558    11327    3         IF I > 0 THEN DO;
      559    11328    3             OUF_SPECIFIED = '0'B;
      560    11329    3             OU_SPECIFIED  = '0'B;
      561    11330    3             UTS_BLK$  = ADDR(NIL);
      562    11331    4             DO J = 1 TO I;
      563    11332    4                 BLK$ = P_PCB.OUT$ -> P$NODE.SUBLK$(J);
      564    11333    5                 DO CASE( OUT$SYM.CODE );
      565    11334    5                   CASE( OU_FILE_VAL );
      566    11335    5                     OUF_SPECIFIED = '1'B;
      567    11336    5                     CALL OPEN_OF ALTRET( ERR1 );
      568    11337    5                   CASE( CMD_FILE_VAL );
      569    11338    5                     READ_BLK$ = BLK$;
      570    11339    5                   CASE( OU_NAME_VAL );
      571    11340    5                     OU_SPECIFIED = '1'B;
      572    11341    6                     IF OUF_ASSOCIATED THEN DO;
      573    11342    6                         OU_NAME.COUNT = OUT$SYM.COUNT;
      574    11343    6                         OU_NAME.TEXT  = OUT$SYM.TEXT;
      575    11344    6                         CALL FIND_OU  ALTRET( ERR1 );
      576    11345    6                         END;
      577    11346    5                     ELSE
      578    11347    6                         IF NOT OUF_SPECIFIED THEN DO;
      579    11348                                  %SCREAM( ERR#=E$NO_FILE );
      580    11358    6   ERR1:                     NUM_ERRORS = NUM_ERRORS + 1;
      581    11359    6                             END;
      582    11360    5                   CASE( UTS_TIME_VAL );
      583    11361    5                     UTS_BLK$ = BLK$;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:22   
      584    11362    4                   END;   /* DO CASE( P$NODE.CODE ): */;
      585    11363    4                 END;     /* DO J = 1 TO I; */
      586    11364    3             IF UTS_BLK$ ~= ADDR(NIL) THEN
      587    11365    4                 IF OU_SPECIFIED THEN DO;
      588    11366    4                     IF OU_ASSOCIATED THEN CALL CHECK_UTS( UTS_BLK$ ) ALTRET(ERR2);
      589    11367    4                     END;
      590    11368    4                 ELSE DO;
      591    11369        /*E*  ERROR:  DPM-E$UTS_BUT_NO_OU-C
      592    11370              MESSAGE: UTS specified but no OU named.
      593    11371              MESSAGE1: If you specify UTS, you must also specify OU.
      594    11372        */
      595    11373                          %SCREAM( ERR#=E$UTS_BUT_NO_OU );
      596    11383    4   ERR2:             NUM_ERRORS = NUM_ERRORS + 1;
      597    11384    4                     END;
      598    11385    4             IF OU_SPECIFIED  AND  OU_ASSOCIATED THEN DO;
      599    11386    4                 CALL M$TIME( GET_PLOVER_UTS );
      600    11387    4                 PLOVER_KEY.UTS  = COMP_UTS;
      601    11388    4                 PLOVER_KEY.PUTS = PLOVER_UTS;
      602    11389    4                 PLOVER_KEY.SEQ  = 0;
      603    11390    4                 END;
      604    11391    3             END;         /* IF I > 0 THEN DO; */
      605    11392
      606    11393    2         IF OUF_ASSOCIATED THEN
      607    11394    3             IF OU_ASSOCIATED THEN DO;
      608    11395        /*E*  ERROR:  DPM-E$PLOVER1-C
      609    11396              MESSAGE:PLOVER %U2 here  (File=%FN  -  Object unit=%U1)
      610    11397        */
      611    11398                      %SCREAM( ERR#=E$PLOVER1, DCB#=M$OF, F1=OU_NAME, F2=B_VERSION );
      612    11408    3                 END;
      613    11409    3             ELSE DO;
      614    11410        /*E*  ERROR:  DPM-E$PLOVER2-C
      615    11411              MESSAGE:PLOVER %U2 here  (File=%FN  -  No object unit named)
      616    11412        */
      617    11413                      %SCREAM( ERR#=E$PLOVER2, DCB#=M$OF, F2=B_VERSION );
      618    11423    3                 END;
      619    11424    2         ELSE
      620    11425    3             IF OU_ASSOCIATED THEN DO;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:23   
      621    11426        /*E*  ERROR:  DPM-E$PLOVER3-C
      622    11427              MESSAGE:PLOVER %U2 here  (No file named  -  Object unit=%U1)
      623    11428        */
      624    11429                      %SCREAM( ERR#=E$PLOVER3, F1=OU_NAME, F2=B_VERSION );
      625    11439    3                 END;
      626    11440    3             ELSE DO;
      627    11441        /*E*  ERROR:  DPM-E$PLOVER4-C
      628    11442              MESSAGE:PLOVER %U2 here  (No file named  -  No object unit named)
      629    11443        */
      630    11444                      %SCREAM( ERR#=E$PLOVER4, F2=B_VERSION );
      631    11454    3                 END;
      632    11455
      633    11456    3         IF READ_BLK$ ~= ADDR(NIL) THEN DO;
      634    11457    3             CALL READ_COMMAND( READ_BLK$ ) ALTRET( ALT_ERR );
      635    11458    4             DO WHILE( '0'B );
      636    11459    4   ALT_ERR:      NUM_ERRORS = NUM_ERRORS + 1;
      637    11460    4                 ALTRETURN;
      638    11461    4                 END;
      639    11462    3             END;
      640    11463    2   END PLOVER_COMMAND;
      641    11464        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:24   
      642    11465    1   RUM_COMMAND:  PROC ALTRET;
      643    11466
      644    11467    3         IF NOT OUF_ASSOCIATED THEN DO;
      645    11468        /*E*  ERROR:  DPM-E$NO_FILE-C
      646    11469              MESSAGE: No file named
      647    11470              MESSAGE1: A command has been issued without a file open for PLOVERing
      648    11471        */
      649    11472                  %SCREAM( ERR#=E$NO_FILE );
      650    11482    3             ALTRETURN;
      651    11483    3             END;
      652    11484    3         IF NOT OU_ASSOCIATED THEN DO;
      653    11485        /*E*  ERROR:  DPM-E$NO_OBJECT_UNIT-C
      654    11486              MESSAGE: No object unit named.
      655    11487              MESSAGE1: An object unit must be specified for this command.
      656    11488        */
      657    11489                  %SCREAM( ERR#=E$NO_OBJECT_UNIT );
      658    11499    3             ALTRETURN;
      659    11500    3             END;
      660    11501    2         CNT = P_PCB.NCHARS;
      661    11502    3         IF CNT > 256 THEN DO;
      662    11503        /*E*  ERROR:  DPM-E$CMD_TOO_LONG-C
      663    11504              MESSAGE: Command too long
      664    11505              MESSAGE1: A command can be at most 256 characters long.
      665    11506        */
      666    11507                  %SCREAM( ERR#=E$CMD_TOO_LONG );
      667    11517    3             ALTRETURN;
      668    11518    3             END;
      669    11519    2         TXT = P_PCB.TEXT$ -> BASED$TEXT;
      670    11520    2         CALL WRITE_PLOVER_REC       ALTRET( ALT );
      671    11521    3         IF P$NODE.CODE = MODIFY_VAL THEN DO;
      672    11522    4           DO CASE( P$NODE.SUBLK$(0)->P$NODE.CODE);
      673    11523    4             CASE (IPSYM1_VAL);
      674    11524    4               PLOVER_BIRTH.IPATCH = PLOVER_BIRTH.IPATCH + 1;
      675    11525    4             CASE (IPSYM2_VAL);
      676    11526    4               PLOVER_BIRTH.IPATCH = PLOVER_BIRTH.IPATCH + 2;
      677    11527    4             CASE (DPSYM1_VAL);
      678    11528    4               PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + 1;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:25   
      679    11529    4             CASE (DPSYM2_VAL);
      680    11530    4               PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + 2;
      681    11531    4             CASE (ELSE);
      682    11532    4               GOTO RET;
      683    11533    4             END;
      684    11534    3           END;
      685    11535    2         CALL WRITE_OU (VECTOR(PLOVER_BIRTH_KEY),VECTOR(PLOVER_BIRTH)) ALTRET (ALTR);
      686    11536    2   RET:  RETURN;
      687    11537    2   ALTR: CALL XUR$ERRMSG(B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF));
      688    11538    2         ALTRETURN;
      689    11539
      690    11540    2   ALT:  ALTRETURN;
      691    11541
      692    11542    2   END RUM_COMMAND;
      693    11543        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:26   
      694    11544    1   WRITE_PLOVER_REC:  PROC       ALTRET;
      695    11545
      696    11546    2         PLOVER_KEY.SEQ = PLOVER_KEY.SEQ + 1;
      697    11547    2         CALL WRITE_OU( VECTOR(PLOVER_KEY), VECTOR(SUBSTR(TXT,0,CNT)) ) ALTRET(
             11547                  WRITE_ERR);
      698    11548    3         IF PLOVER_BIRTH.PLOVER_UTS ~= PLOVER_UTS THEN DO;
      699    11549    3             PLOVER_BIRTH.PLOVER_UTS = PLOVER_UTS;
      700    11550    3             PLOVER_BIRTH.COUNT = PLOVER_BIRTH.COUNT + 1;
      701    11551    3             CALL WRITE_OU( VECTOR(PLOVER_BIRTH_KEY), VECTOR(PLOVER_BIRTH) ) ALTRET(
             11551                      WRITE_ERR);
      702    11552    3             END;
      703    11553    2         RETURN;
      704    11554
      705    11555    2   WRITE_ERR:
      706    11556    2         CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF) );
      707    11557    2         ALTRETURN;
      708    11558
      709    11559    2   END WRITE_PLOVER_REC;
      710    11560        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:27   
      711    11561    1   LIST_COMMAND: PROC  ALTRET;
      712    11562
      713    11563
      714    11564    2   DCL SEQ SBIN WORD;
      715    11565    2   DCL COMP_UTS SBIN WORD;
      716    11566    2   DCL PLOVER_UTS SBIN WORD;
      717    11567    2   DCL LAST_UTS SBIN WORD;
      718    11568    2   DCL COUNT SBIN WORD;
      719    11569
      720    11570    3         IF NOT OUF_ASSOCIATED THEN DO;
      721    11571        /*    ERROR:  DPM-E$NO_FILE-C
      722    11572              MESSAGE: No file named
      723    11573              MESSAGE1: A command has been issued without a file open for PLOVERing
      724    11574        */
      725    11575                  %SCREAM( ERR#=E$NO_FILE );
      726    11585    3             ALTRETURN;
      727    11586    3             END;
      728    11587    2         COUNT = 0;
      729    11588    3         IF P$NODE.NSUBLKS = 0 THEN DO;   /* List all PLOVER records */
      730    11589    3             B$PLOVERKEY = PLOVER_KEY;
      731    11590    3             B$PLOVERKEY.KEYSIZ = 1;
      732    11591    3             CALL READ_OU( VECTOR(OU_KEY), VECTOR(TXT) );
      733    11592    3             CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(DONE);
      734    11593    4             DO WHILE( B$PLOVERKEY.NOTHD = PLOVER_KEY.NOTHD );
      735    11594    4                 IF OU_KEY.KEYSIZ = PLOVER_BIRTH_KEY.KEYSIZ THEN
      736    11595                                                  /* Found a PLOVER BIRTH record */
      737    11596    4                     CALL LIST_PLOVER_BIRTH;
      738    11597    4                 ELSE
      739    11598    4                     CALL LIST_PLOVER;
      740    11599    4                 CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(DONE);
      741    11600    4                 END;
      742    11601    4   DONE:     IF COUNT = 0 THEN DO;
      743    11602        /*E*  ERROR:  DPM-E$NOTHING_TO_LIST-C
      744    11603              MESSAGE: Nothing to list.
      745    11604        */
      746    11605    4   NONE:
      747    11606                      %SCREAM( ERR#=E$NOTHING_TO_LIST );
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:28   
      748    11616    4                 END;
      749    11617    3             END;
      750    11618    3         ELSE DO;
      751    11619    3             BLK$ = P$NODE.SUBLK$(0);
      752    11620    3             CALL FIND_OU    ALTRET(FINISHED);
      753    11621    3             CALL LIST_PLOVER_BIRTH;
      754    11622    3             IF B$PLOVERBIRTH.COUNT = 0 THEN RETURN;
      755    11623    4             IF P$NODE.NSUBLKS = 1 THEN DO;
      756    11624    4                 CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(FINISHED);
      757    11625    5                 DO WHILE( B$PLOVERKEY.KEYSIZ = PLOVER_KEY.KEYSIZ
      758    11626    5                         AND  B$PLOVERKEY.NOTHD = PLOVER_KEY.NOTHD
      759    11627    5                         AND  B$PLOVERKEY.UTS   = COMP_UTS );
      760    11628    5                     CALL LIST_PLOVER;
      761    11629    5                     CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(
             11629                              FINISHED);
      762    11630    5                     END;
      763    11631    4                 END;
      764    11632    4             ELSE DO;
      765    11633    4                 BLK$ = P$NODE.SUBLK$(1);
      766    11634    4                 CALL CHECK_UTS( BLK$ ) ALTRET(FINISHED);
      767    11635    4                 B$PLOVERKEY = PLOVER_KEY;
      768    11636    4                 PLOVER_UTS = UTS;
      769    11637    4                 B$PLOVERKEY.PUTS = PLOVER_UTS;
      770    11638    4                 B$PLOVERKEY.SEQ  = 1;
      771    11639    4                 CALL READ_OU( VECTOR(B$PLOVERKEY), VECTOR(TXT), CNT ) ALTRET(NONE);
      772    11640    5                 DO WHILE( B$PLOVERKEY.KEYSIZ  = PLOVER_KEY.KEYSIZ
      773    11641    5                         AND B$PLOVERKEY.TYPE  = %TYPPLOVER
      774    11642    5                         AND  B$PLOVERKEY.UTS  = COMP_UTS
      775    11643    5                         AND  B$PLOVERKEY.PUTS = PLOVER_UTS );
      776    11644    5                     CALL LIST_PLOVER;
      777    11645    5                     CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT) ALTRET(
             11645                              FINISHED);
      778    11646    5                     END;
      779    11647    4                 END;
      780    11648    3   FINISHED:
      781    11649    3             END;
      782    11650    2         RETURN;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:29   
      783    11651
      784    11652        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:30   
      785    11653    2   LIST_PLOVER_BIRTH:    PROC;
      786    11654
      787    11655    3   DCL OU_FMT CHAR(0) CONSTANT INIT('Object unit = %>A');
      788    11656    3   DCL CREATION_UTS_FMT CHAR(0) CONSTANT INIT('%>A %>A Creation UTS');
      789    11657    3   DCL PLOVERED_UTS_FMT CHAR(0) CONSTANT INIT
      790    11658    3                                ('%>A %>A Last PLOVERed (%<D times)');
      791    11659    3   DCL IPATCH_FMT CHAR (0) CONSTANT INIT ('IPATCH value set to %<D');
      792    11660    3   DCL DPATCH_FMT CHAR (0) CONSTANT INIT ('DPATCH value set to %<D');
      793    11661
      794    11662    3         COMP_UTS = B$PLOVERBIRTH.CREATE_UTS;
      795    11663    3         LAST_UTS = COMP_UTS;
      796    11664    3         COUNT = COUNT + 1;
      797    11665    3         CALL X$WRITE( F_FDS, VECTOR(OU_FMT), VECTOR(B$PLOVERBIRTH.OU_NAME.TEXT) );
      798    11666    3         UTS = B$PLOVERBIRTH.CREATE_UTS;
      799    11667    3         CALL M$TIME( UTS_TIME );
      800    11668        /*    IF PLOVER_BIRTH_SIZE ~= PLOVER_BIRTH_ARS# THEN DO;
      801    11669                 B$PLOVERBIRTH.IPATCH = 0;
      802    11670                 B$PLOVERBIRTH.DPATCH = 0;
      803    11671                 END;*/
      804    11672    3         CALL X$WRITE( F_FDS, VECTOR(CREATION_UTS_FMT), VECTOR(DATE),VECTOR(TIME));
      805    11673    3         CALL X$WRITE( F_FDS, VECTOR(IPATCH_FMT), VECTOR(B$PLOVERBIRTH.IPATCH));
      806    11674    3         CALL X$WRITE( F_FDS, VECTOR(DPATCH_FMT), VECTOR(B$PLOVERBIRTH.DPATCH));
      807    11675    3         IF B$PLOVERBIRTH.COUNT = 0 THEN
      808    11676    3             CALL WRITE_LO( 'None', 4 );
      809    11677    4         ELSE DO;
      810    11678    4             UTS = B$PLOVERBIRTH.PLOVER_UTS;
      811    11679    4             CALL M$TIME( UTS_TIME );
      812    11680    4             CALL X$WRITE( F_FDS, VECTOR(PLOVERED_UTS_FMT),
      813    11681    4                     VECTOR(DATE), VECTOR(TIME), VECTOR(B$PLOVERBIRTH.COUNT));
      814    11682    4             END;
      815    11683
      816    11684    3   END LIST_PLOVER_BIRTH;
      817    11685        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:31   
      818    11686    2   LIST_PLOVER:  PROC;
      819    11687
      820    11688    3   DCL FMT CHAR(0) CONSTANT INIT('%5.ZD %>A');
      821    11689
      822    11690    4         IF B$PLOVERKEY.PUTS ~= LAST_UTS THEN DO;
      823    11691    4             LAST_UTS = B$PLOVERKEY.PUTS;
      824    11692    4             UTS = LAST_UTS;
      825    11693    4             CALL M$TIME( UTS_TIME );
      826    11694    4             CALL CONCAT( OUT_BUF, DATE, ' ', TIME );
      827    11695    4             CALL WRITE_LO( OUT_BUF, 21 );
      828    11696    4             SEQ = 0;
      829    11697    4             END;
      830    11698    3         SEQ = SEQ + 1;
      831    11699    3         CALL X$WRITE( F_FDS, VECTOR(FMT), VECTOR(SEQ), VECTOR(SUBSTR(TXT,0,CNT)));
      832    11700
      833    11701    3   END LIST_PLOVER;
      834    11702
      835    11703    2   END LIST_COMMAND;
      836    11704        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:32   
      837    11705    1   DELETE_COMMAND: PROC  ALTRET;
      838    11706
      839    11707
      840    11708        %FPT_DELREC( DCB=M$OF, KEY=KEY1, LKEY=KEY2 );
      841    11727        %B$PLOVERKEY( NAME=KEY1, STCLASS=STATIC );
      842    11757        %B$PLOVERKEY( NAME=KEY2, STCLASS=STATIC );
      843    11787
      844    11788
      845    11789
      846    11790    3         IF NOT OUF_ASSOCIATED THEN DO;
      847    11791        /*    ERROR:  DPM-E$NO_FILE-C
      848    11792              MESSAGE: No file named
      849    11793              MESSAGE1: A command has been issued without a file open for PLOVERing
      850    11794        */
      851    11795                  %SCREAM( ERR#=E$NO_FILE );
      852    11805    3             ALTRETURN;
      853    11806    3             END;
      854    11807    3         IF P$NODE.NSUBLKS = 0 THEN DO;   /* Delete all PLOVER records */
      855    11808    3             B$PLOVERKEY = PLOVER_KEY;
      856    11809    3             B$PLOVERKEY.KEYSIZ = 1;
      857    11810    3             CALL READ_OU( VECTOR(OU_KEY), VECTOR(TXT) );
      858    11811    3             CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(NONE);
      859    11812    4             IF B$PLOVERKEY.NOTHD = PLOVER_KEY.NOTHD THEN DO;
      860    11813    4                 KEY1.KEYSIZ  = 1;
      861    11814    4                 KEY2.KEYSIZ  = PLOVER_KEY.KEYSIZ;
      862    11815    4                 KEY2.TYPE    = %TYPPLOVER;
      863    11816    4                 KEY2.UTS     = BITBIN('777777777777'O);
      864    11817    4                 KEY2.PUTS    = BITBIN('777777777777'O);
      865    11818    4                 KEY2.SEQ     = BITBIN('777777777777'O);
      866    11819    4                 CALL M$DELREC( FPT_DELREC );
      867    11820        /*E*  ERROR:  DPM-E$ALL_PLOVERS_DEL-C
      868    11821              MESSAGE: All PLOVER records deleted
      869    11822        */
      870    11823                      %SCREAM( ERR#=E$ALL_PLOVERS_DEL );
      871    11833    4                 END;
      872    11834    4             ELSE DO;
      873    11835        /*E*  ERROR:  DPM-E$NOTHING_TO_DEL-C
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:33   
      874    11836              MESSAGE: Nothing to delete
      875    11837        */
      876    11838    4   NONE:
      877    11839                      %SCREAM( ERR#=E$NOTHING_TO_DEL );
      878    11849    4                 RETURN;
      879    11850    4                 END;
      880    11851    3             END;
      881    11852    3         ELSE DO;
      882    11853    3             BLK$ = P$NODE.SUBLK$(0);
      883    11854    3             CALL FIND_OU ALTRET(EXIT#);
      884    11855    4             IF P$NODE.NSUBLKS = 1 THEN DO;
      885    11856    5                 IF B$PLOVERBIRTH.COUNT = 0 THEN DO;
      886    11857                          %SCREAM( ERR#=E$NOTHING_TO_DEL );
      887    11867    5                     RETURN;
      888    11868    5                     END;
      889    11869    5                 ELSE DO;
      890    11870    5                     KEY1      = B$PLOVERBIRTHKEY;
      891    11871    5                     KEY2      = PLOVER_KEY;
      892    11872    5                     KEY2.UTS  = B$PLOVERBIRTH.CREATE_UTS;
      893    11873    5                     KEY2.PUTS = B$PLOVERBIRTH.PLOVER_UTS;
      894    11874    5                     KEY2.SEQ  = BITBIN('777777777777'O);
      895    11875    5                     CALL M$DELREC( FPT_DELREC );
      896    11876        /*E*  ERROR:  DPM-E$ALL_OU_PLOVERS_DEL-C
      897    11877              MESSAGE: All PLOVER records for object unit %U1 deleted
      898    11878        */
      899    11879    5                     BLK$ = P_PCB.OUT$ -> P$NODE.SUBLK$(0);
      900    11880    5                     FIELD1.COUNT = OUT$SYM.COUNT;
      901    11881    5                     FIELD1.TEXT  = OUT$SYM.TEXT;
      902    11882                          %SCREAM( ERR#=E$ALL_OU_PLOVERS_DEL, F1=FIELD1 );
      903    11892    5                     END;
      904    11893    4                 END;
      905    11894    4             ELSE DO;
      906    11895    4                 BLK$ = P$NODE.SUBLK$(1);
      907    11896    4                 CALL CHECK_UTS( BLK$ ) ALTRET(EXIT#);
      908    11897    4                 KEY1      = PLOVER_KEY;
      909    11898    4                 KEY1.UTS  = B$PLOVERBIRTH.CREATE_UTS;
      910    11899    4                 KEY1.PUTS = UTS;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:34   
      911    11900    4                 KEY1.SEQ  = 1;
      912    11901    4                 CALL READ_OU( VECTOR(KEY1), VECTOR(TXT) ) ALTRET(NONE);
      913    11902    4                 KEY2 = KEY1;
      914    11903    4                 KEY2.SEQ = BITBIN('777777777777'O);
      915    11904    4                 CALL M$DELREC( FPT_DELREC );
      916    11905        /*E*  ERROR: DPM-E$ALL_UTS_PLOVERS_DEL-C
      917    11906            MESSAGE: All records PLOVERed at %U1 on %U2 for object unit %U3
      918    11907                     have been deleted.
      919    11908        */
      920    11909    4                 BLK$ = P_PCB.OUT$ -> P$NODE.SUBLK$(0);
      921    11910    4                 FIELD3.COUNT = OUT$SYM.COUNT;
      922    11911    4                 FIELD3.TEXT  = OUT$SYM.TEXT;
      923    11912    4                 FIELD1.COUNT = 11;
      924    11913    4                 FIELD1.TEXT  = TIME;
      925    11914    4                 FIELD2.COUNT = 8;
      926    11915    4                 FIELD2.TEXT  = DATE;
      927    11916                      %SCREAM( ERR#=E$ALL_UTS_PLOVERS_DEL, F1=FIELD1, F2=FIELD2, F3=FIELD3 )
             11916                          ;
      928    11926    4                 END;
      929    11927    3             END;
      930    11928
      931    11929    2         IF OU_ASSOCIATED  AND
      932    11930    2                 (P$NODE.NSUBLKS = 0  OR  B$PLOVERBIRTH = PLOVER_BIRTH )
      933    11931    3         THEN DO;
      934    11932    3             CALL M$TIME( GET_PLOVER_UTS );
      935    11933    3             PLOVER_KEY.PUTS         = PLOVER_UTS;
      936    11934    3             PLOVER_KEY.SEQ          = 0;
      937    11935    3             PLOVER_BIRTH.PLOVER_UTS = 0;
      938    11936    3             IF P$NODE.NSUBLKS <= 1 THEN
      939    11937    3                 PLOVER_BIRTH.COUNT = 0;
      940    11938    3             END;
      941    11939
      942    11940    2   EXIT#: RETURN;
      943    11941
      944    11942    2   END DELETE_COMMAND;
      945    11943        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:35   
      946    11944    1   SYMDEF_COMMAND:  PROC ALTRET;
      947    11945
      948    11946
      949    11947    2   DCL SECT# SBIN WORD;
      950    11948
      951    11949    3         IF NOT OUF_ASSOCIATED THEN DO;
      952    11950        /*    ERROR:  DPM-E$NO_FILE-C
      953    11951              MESSAGE: No file named
      954    11952              MESSAGE1: A command has been issued without a file open for PLOVERing
      955    11953        */
      956    11954                  %SCREAM( ERR#=E$NO_FILE );
      957    11964    3             ALTRETURN;
      958    11965    3             END;
      959    11966    3         IF NOT OU_ASSOCIATED THEN DO;
      960    11967        /*    ERROR:  DPM-E$NO_OBJECT_UNIT-C
      961    11968              MESSAGE: No object unit named.
      962    11969              MESSAGE1: An object unit must be specified for this command.
      963    11970        */
      964    11971                  %SCREAM( ERR#=E$NO_OBJECT_UNIT );
      965    11981    3             ALTRETURN;
      966    11982    3             END;
      967    11983    2         BLK$ = P$NODE.SUBLK$(1);
      968    11984    2         CALL CHARBIN ( SECT#, OUT$SYM.TEXT ) ;
      969    11985    2         IF NUM_SECTS < 0 THEN CALL GET_NUM_SECTS ALTRET(ALT);
      970    11986    3         IF SECT# >= NUM_SECTS THEN DO;
      971    11987        /*E*  ERROR:  DPM-E$SECT_DOES_NOT_EXIST-C
      972    11988              MESSAGE: Section %U1 does not exist in object unit %U2.
      973    11989        */
      974    11990    3             FIELD1.COUNT = OUT$SYM.COUNT;
      975    11991    3             FIELD1.TEXT  = OUT$SYM.TEXT;
      976    11992                  %SCREAM( ERR#=E$SECT_DOES_NOT_EXIST, F1=FIELD1, F2=OU_NAME );
      977    12002    3             ALTRETURN;
      978    12003    3             END;
      979    12004    2         CALL CONCAT( TXT, 'SYMDEF ', P$NODE.SUBLK$(0)->OUT$SYM.TEXT, ' ', OUT$SYM.TEXT
             12004                  ) ;
      980    12005    2         CNT = OUT$SYM.COUNT + P$NODE.SUBLK$(0)->OUT$SYM.COUNT + 8 ;
      981    12006    2         CALL WRITE_PLOVER_REC       ALTRET( ALT );
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:36   
      982    12007    2         RETURN;
      983    12008
      984    12009    2   ALT:  ALTRETURN;
      985    12010
      986    12011    2   END SYMDEF_COMMAND;
      987    12012        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:37   
      988    12013    1   GET_NUM_SECTS:   PROC    ALTRET;
      989    12014
      990    12015        %B$OUKEY( NAME=SECTION_KEY, STCLASS=STATIC );
      991    12051        %B$SECTION( STCLASS=BASED );
      992    12110        %FPT_GDS( RESULTS=GDSVEC, SEGSIZE=1024, STCLASS=CONSTANT );
      993    12126    2   DCL 1 GDSVEC STATIC DALIGNED,
      994    12127    2         2 BOUNDW UBIN HALF UNAL INIT(0),
      995    12128    2         2 * UBIN HALF UNAL INIT(0),
      996    12129    2         2 PTR$ PTR INIT( ADDR(NIL) );
      997    12130    2   DCL 1 BUFVEC STATIC DALIGNED,
      998    12131    2         2 BOUND UBIN(20) UNAL INIT(0),
      999    12132    2         2 * BIT(16) UNAL INIT('0'B),
     1000    12133    2         2 PTR$ PTR INIT( ADDR(NIL) );
     1001    12134    2   DCL ARS UBIN WORD;
     1002    12135
     1003    12136
     1004    12137    3         IF BUFVEC.PTR$ = ADDR(NIL) THEN DO;
     1005    12138    3             CALL M$GDS( FPT_GDS ) ALTRET( GDS_ERR );
     1006    12139    3             BUFVEC = GDSVEC;
     1007    12140    3             END;
     1008    12141    2         SECTION_KEY.UTS  = COMP_UTS;
     1009    12142    2         SECTION_KEY.TYPE = %TYPSECT;
     1010    12143    2         SECTION_KEY.PAGE = 0;
     1011    12144    2         NUM_SECTS = 0;
     1012    12145    3         DO WHILE( '1'B );
     1013    12146    3             CALL READ_OU( VECTOR(SECTION_KEY), BUFVEC, ARS )
     1014    12147    4             WHENRETURN DO;
     1015    12148    4                 NUM_SECTS = NUM_SECTS + ( ARS / SIZEC(B$SECTION) );
     1016    12149    4                 SECTION_KEY.PAGE = SECTION_KEY.PAGE + 1;
     1017    12150    4                 END;
     1018    12151    4             WHENALTRETURN DO;
     1019    12152    4                 IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY THEN RETURN;
     1020    12153    5                 IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$LD THEN DO;
     1021    12154    5                     CALL M$GDS( FPT_GDS )
     1022    12155    6                     WHENALTRETURN DO;
     1023    12156    6   GDS_ERR:              CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR );
     1024    12157    6                         ALTRETURN;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:38   
     1025    12158    6                         END;
     1026    12159    5                     BUFVEC.BOUND = BUFVEC.BOUND + 4096;
     1027    12160    5                     END;
     1028    12161    5                 ELSE DO;
     1029    12162    5                     CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF) );
     1030    12163    5                     ALTRETURN;
     1031    12164    5                     END;
     1032    12165    4                 END;
     1033    12166    3             END;
     1034    12167
     1035    12168    2   END GET_NUM_SECTS;
     1036    12169        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:39   
     1037    12170    1   ENTREF_COMMAND:  PROC ALTRET;
     1038    12171
     1039    12172
     1040    12173    3         IF NOT OUF_ASSOCIATED THEN DO;
     1041    12174        /*    ERROR:  DPM-E$NO_FILE-C
     1042    12175              MESSAGE: No file named
     1043    12176              MESSAGE1: A command has been issued without a file open for PLOVERing
     1044    12177        */
     1045    12178                  %SCREAM( ERR#=E$NO_FILE );
     1046    12188    3             ALTRETURN;
     1047    12189    3             END;
     1048    12190    3         IF NOT OU_ASSOCIATED THEN DO;
     1049    12191        /*    ERROR:  DPM-E$NO_OBJECT_UNIT-C
     1050    12192              MESSAGE: No object unit named.
     1051    12193              MESSAGE1: An object unit must be specified for this command.
     1052    12194        */
     1053    12195                  %SCREAM( ERR#=E$NO_OBJECT_UNIT );
     1054    12205    3             ALTRETURN;
     1055    12206    3             END;
     1056    12207    2         BLK$ = P$NODE.SUBLK$(0);
     1057    12208    2         CALL CONCAT( TXT, 'ENTREF ', OUT$SYM.TEXT );
     1058    12209    2         CNT = OUT$SYM.COUNT + 7;
     1059    12210    2         CALL WRITE_PLOVER_REC       ALTRET( ALT );
     1060    12211    2         RETURN;
     1061    12212
     1062    12213    2   ALT:  ALTRETURN;
     1063    12214
     1064    12215    2   END ENTREF_COMMAND;
     1065    12216        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:40   
     1066    12217    1   EXTERNAL_COMMAND:  PROC   ALTRET;
     1067    12218
     1068    12219    2   DCL PATCH_SPACE CHAR(3);
     1069    12220
     1070    12221
     1071    12222    3         IF NOT OUF_ASSOCIATED THEN DO;
     1072    12223                  %SCREAM( ERR#=E$NO_FILE);
     1073    12233    3             ALTRETURN;
     1074    12234    3             END;
     1075    12235    3         IF NOT OU_ASSOCIATED THEN DO;
     1076    12236                  %SCREAM( ERR#=E$NO_OBJECT_UNIT );
     1077    12246    3             ALTRETURN;
     1078    12247    3             END;
     1079    12248    3         IF P$NODE.SUBLK$(1)->OUT$SYM.CODE = IPATCH_VAL THEN DO;
     1080    12249    3             PATCH_SPACE = ' @,';
     1081    12250    3             CALL CHARBIN (CNT, P$NODE.SUBLK$(2)->OUT$SYM.TEXT);
     1082    12251    3             PLOVER_BIRTH.IPATCH = PLOVER_BIRTH.IPATCH + CNT;
     1083    12252    3             CALL WRITE_OU (VECTOR(PLOVER_BIRTH_KEY),VECTOR(PLOVER_BIRTH)) ALTRET (ALT)
             12252                      ;
     1084    12253    3             END;
     1085    12254    3         ELSE DO;
     1086    12255    3             PATCH_SPACE = ' #,';
     1087    12256    3             CALL CHARBIN (CNT, P$NODE.SUBLK$(2)->OUT$SYM.TEXT);
     1088    12257    3             PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + CNT;
     1089    12258    3             CALL WRITE_OU (VECTOR(PLOVER_BIRTH_KEY),VECTOR(PLOVER_BIRTH)) ALTRET (ALT)
             12258                      ;
     1090    12259    3             END;
     1091    12260    2         CALL CONCAT( TXT, 'EXTERNAL ', P$NODE.SUBLK$(0)->OUT$SYM.TEXT,
     1092    12261    2                 PATCH_SPACE, P$NODE.SUBLK$(2)->OUT$SYM.TEXT );
     1093    12262    2         CNT = P$NODE.SUBLK$(0)->OUT$SYM.COUNT + P$NODE.SUBLK$(2)->OUT$SYM.COUNT + 12;
     1094    12263    2         CALL WRITE_PLOVER_REC       ALTRET( ALT );
     1095    12264    2         RETURN;
     1096    12265
     1097    12266    2   ALT:  ALTRETURN;
     1098    12267
     1099    12268    2   END EXTERNAL_COMMAND;
     1100    12269        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:41   
     1101    12270    1   READ_COMMAND:  PROC( PTR$ )  ALTRET;
     1102    12271
     1103    12272    2   DCL PTR$ PTR;
     1104    12273
     1105    12274        %FPT_OPEN( DCB=M$SI, FUN=IN, SCRUB=YES );
     1106    12383        %FPT_FID( NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS, SN=VLP_SN, WSN=VLP_WSN,
     1107    12384                  ASN=FPT_OPEN.V.ASN#, RES=FPT_OPEN.V.RES#, RESULTS=VLR_FID );
     1108    12407
     1109    12408
     1110    12409    2         BLK$ = PTR$;
     1111    12410    2         FPT_FID.TEXTFID_ = VECTOR( OUT$SYM.TEXT );
     1112    12411    2         CALL M$FID( FPT_FID ) ALTRET( FID_ERR );
     1113    12412    2         IF VLR_FID.NAME THEN
     1114    12413    2             FPT_OPEN.NAME_ = VECTOR(VLP_NAME);
     1115    12414    2         ELSE
     1116    12415    2             FPT_OPEN.NAME_ = VECTOR(NIL);
     1117    12416    2         IF VLR_FID.ACCT THEN
     1118    12417    2             FPT_OPEN.ACCT_ = VECTOR(VLP_ACCT);
     1119    12418    2         ELSE
     1120    12419    2             FPT_OPEN.ACCT_ = VECTOR(NIL);
     1121    12420    2         IF VLR_FID.PASS THEN
     1122    12421    2             FPT_OPEN.PASS_ = VECTOR(VLP_PASS);
     1123    12422    2         ELSE
     1124    12423    2             FPT_OPEN.PASS_ = VECTOR(NIL);
     1125    12424    2         IF VLR_FID.SN THEN
     1126    12425    2             FPT_OPEN.SN_ = VECTOR(VLP_SN);
     1127    12426    2         ELSE
     1128    12427    2             FPT_OPEN.SN_ = VECTOR(NIL);
     1129    12428    2         IF VLR_FID.WSN THEN
     1130    12429    2             FPT_OPEN.WSN_ = VECTOR(VLP_WSN);
     1131    12430    2         ELSE
     1132    12431    2             FPT_OPEN.WSN_ = VECTOR(NIL);
     1133    12432    2         IF M$SI$->F$DCB.FCD# THEN CALL M$CLOSE(CLOSE_SI) ALTRET(OPEN_FILE);
     1134    12433    2   OPEN_FILE:
     1135    12434    2         CALL M$OPEN( FPT_OPEN ) ALTRET( OPEN_ERR );
     1136    12435    2         READ_FILE = '1'B;
     1137    12436    2         RETURN;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:42   
     1138    12437
     1139    12438    2   FID_ERR:
     1140    12439    2         CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR );
     1141    12440
     1142    12441    3         DO WHILE( '0'B );
     1143    12442    3   OPEN_ERR: CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$SI) );
     1144    12443    3             END;
     1145    12444
     1146    12445    2         NUM_ERRORS = NUM_ERRORS + 1;
     1147    12446    2         ALTRETURN;
     1148    12447
     1149    12448    2   END READ_COMMAND;
     1150    12449        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:43   
     1151    12450    1   IDPATCH_COMMAND: PROC (PTR$,CODE) ALTRET;
     1152    12451
     1153    12452    2   DCL PTR$ PTR;
     1154    12453    2   DCL CODE SBIN;
     1155    12454    2   DCL TEMP SBIN;
     1156    12455
     1157    12456    3          IF NOT OUF_ASSOCIATED THEN DO;
     1158    12457        /*     ERROR: DPM-E$NO_FILE-C
     1159    12458               MESSAGE: No file named
     1160    12459               MESSAGE1: A command has been isuued without a file open for PLOVERing
     1161    12460                   PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + TEMP;
     1162    12461                   END;
     1163    12462        */
     1164    12463                   %SCREAM( ERR#=E$NO_FILE );
     1165    12473    3              ALTRETURN;
     1166    12474    3              END;
     1167    12475    3          IF NOT OU_ASSOCIATED THEN DO;
     1168    12476        /*     ERROR: DPM-E$NO_OBJECT_UNIT-C
     1169    12477               MESSAGE: No object unit named
     1170    12478               MESSAGE1: An object unit must be specified for this command.
     1171    12479        */
     1172    12480                   %SCREAM( ERR#=E$NO_OBJECT_UNIT );
     1173    12490    3              ALTRETURN;
     1174    12491    3              END;
     1175    12492
     1176    12493    3          DO CASE (CODE);
     1177    12494    3             CASE (RESET_VAL);
     1178    12495    4                IF P$NODE.NSUBLKS ~= 0 THEN DO;
     1179    12496    4                   OUT$ = PTR$;
     1180    12497    4                   IF P$NODE.CODE = RIPATCH_VAL THEN
     1181    12498    4                      PLOVER_BIRTH.IPATCH = 0;
     1182    12499    4                   ELSE
     1183    12500    4                      PLOVER_BIRTH.DPATCH = 0;
     1184    12501    4                   END;
     1185    12502    4                ELSE DO;
     1186    12503    4                   PLOVER_BIRTH.IPATCH = 0;
     1187    12504    4                   PLOVER_BIRTH.DPATCH = 0;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:44   
     1188    12505    4                   END;
     1189    12506
     1190    12507    3             CASE (IPTCH_VAL, DPTCH_VAL);
     1191    12508    3                BLK$ = PTR$;
     1192    12509    4                IF CODE = IPTCH_VAL THEN DO;
     1193    12510    4                   CALL CHARBIN (TEMP, OUT$SYM.TEXT);
     1194    12511    4                   PLOVER_BIRTH.IPATCH = PLOVER_BIRTH.IPATCH + TEMP;
     1195    12512    4                   END;
     1196    12513    4                ELSE DO;
     1197    12514    4                   CALL CHARBIN (TEMP, OUT$SYM.TEXT);
     1198    12515    4                   PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + TEMP;
     1199    12516    4                   END;
     1200    12517    3                END;
     1201    12518    2          CALL WRITE_OU (VECTOR(PLOVER_BIRTH_KEY),VECTOR(PLOVER_BIRTH)) ALTRET (ALTR);
     1202    12519    2          RETURN;
     1203    12520
     1204    12521    2   ALTR:  CALL XUR$ERRMSG(B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF));
     1205    12522    2          ALTRETURN;
     1206    12523
     1207    12524    2   END IDPATCH_COMMAND;
     1208    12525        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:45   
     1209    12526    1   END DPM$PLOVER;
     1210    12527        %EOD;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:46   
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DP_MACRO_C.:E05TOU  is referenced.
   DP_PERR_C.:E05TOU  is referenced.
   DP_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DPM$PLOVER.

   Procedure DPM$PLOVER requires 2583 words for executable code.
   Procedure DPM$PLOVER requires 90 words of local(AUTO) storage.

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:47   

 Object Unit name= DPM$PLOVER                                 File name= DPM$PLOVER.:E05TOU
 UTS= JUL 29 '97 14:44:27.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    161    241  DPM$PLOVER
    2   Data  even  none   682   1252  DPM$PLOVER
    3   DCB   even  none     0      0  M$SI
    4   DCB   even  none     0      0  M$LO
    5   DCB   even  none     0      0  M$DO
    6   DCB   even  none     0      0  M$OF
    7   Proc  even  none  2583   5027  DPM$PLOVER
    8  RoData even  none   139    213  DPM$PLOVER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     7      0   yes            yes      Main       0  DPM$PLOVER
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:48   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XTX$ADAPT
         yes           Std       1 DPM$PARSE_U$
 yes     yes           Std       6 XUR$GETCMD
 yes     yes           Std       4 XUR$SETDCBS
 yes     yes           Std       1 XUR$MOREMSG
         yes           Std       2 XUR$CLOSE_DCBS
 yes     yes           Std       1 XUR$HELP
 yes     yes           Std       1 XUR$ALLMSG
 yes     yes           Std       3 XUR$INIT
 yes     yes           Std       2 XUR$ERRPTR
 yes     yes           Std       7 XUR$ERRMSG
         yes           Std      22 X$WRITE
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MAUTO
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$SI                                  M$LO
     M$DO                                  M$OF                                  B$JIT$
     B$TCB$                                B_VERSION                             INVOKE_CMD
     PLOVER_COMMANDS                       B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:49   


        1        1        /*M* DPM$PLOVER - main procedure for PLOVER. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        DPM$PLOVER:   PROC  MAIN;

      7  7 000000   000000 700200 xent  DPM$PLOVER   TSX0  ! X66_MAUTO
         7 000001   000132 000000                    ZERO    90,0

        8        8
        9        9
       10       10        /********************************************************************/
       11       11        /*        Include files           Include files                     */
       12       12        /********************************************************************/
       13       13
       14       14        %INCLUDE  DP_SUBS_C;
       15       76        %INCLUDE  DP_PERR_C;
       16      103        %INCLUDE  DP_MACRO_C;
       17      124        %INCLUDE  XU_MACRO_C;
       18     3230        %INCLUDE  XU_FORMAT_C;
       19     3392        %INCLUDE  XUF_ENTRY;
       20     3400        %INCLUDE  XUH_MACRO_C;
       21     3484        %INCLUDE  XUR_ENTRY;
       22     3516        %INCLUDE  CP_6;
       23     3597        %INCLUDE  B$JIT;
       24     3887        %INCLUDE  B_ERRORS_C;
       25     5014        %INCLUDE  CP_6_SUBS;
       26     5554        %INCLUDE  B$OBJECT_C;
       27     8984        %INCLUDE  B_MICROPS_C;
       28     9156
       29     9157        /********************************************************************/
       30     9158        /*        'FPTs'                  'FPTs'                            */
       31     9159        /********************************************************************/
       32     9160
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:50   
       33     9161        %FPT_EXIT( FPTN=SET_STEPCC_TO_4, STEPCC=4 , STCLASS = CONSTANT );
       34     9176        %FPT_TIME( FPTN=GET_PLOVER_UTS, SOURCE=CLOCK, DEST=UTS, TSTAMP=PLOVER_UTS , STCLASS
              9176            = CONSTANT );
       35     9195       %FPT_TIME( FPTN=TIME_UTS, SOURCE=LOCAL, DATE=DATE, TIME=TIME, DEST=UTS, TSTAMP=UTS ,
              9195            STCLASS = CONSTANT );
       36     9214       %FPT_TIME( FPTN=UTS_TIME, SOURCE=UTS, DATE=DATE, TIME=TIME, DEST=LOCAL, TSTAMP=UTS ,
              9214            STCLASS = CONSTANT );
       37     9233        %FPT_CLOSE( FPTN=CLOSE_SI, DCB=M$SI, DISP=SAVE , STCLASS = CONSTANT );
       38     9275        %VLP_NAME;
       39     9302        %VLP_ACCT;
       40     9315        %VLP_PASS;
       41     9328        %VLP_SN( N=9 );
       42     9341        %VLP_WSN;
       43     9354        %VLR_FID;
       44     9373
       45     9374        /********************************************************************/
       46     9375        /*        X$FORMAT stuff          X$FORMAT stuff                    */
       47     9376        /********************************************************************/
       48     9377
       49     9378        %F_FDS(NAME=F_FDS, STCLASS=STATIC, DCB=M$LO, BUF=OUT_BUF, TRUNC=NO, WRAPTAB=4);
       50     9491    1   DCL OUT_BUF CHAR(80) STATIC INIT(' ');
       51     9492
       52     9493        /********************************************************************/
       53     9494        /*        XUH$HELP stuff          XUH$HELP stuff                    */
       54     9495        /********************************************************************/
       55     9496
       56     9497        %XUH_PARAM( NAME=XUH_PARAM, PROCNAME=PLOVER, PROCACCT=SYS_ACCT,
       57     9498                    OUTDCB1=M$LO, OUTDCB2=M$DO, STCLASS=STATIC );
       58     9559        %VLP_NAME( FPTN=PLOVER, NAME='PLOVER', LEN=6, STCLASS=CONSTANT );
       59     9586        %VLP_ACCT( FPTN=SYS_ACCT, ACCT=':SYS', STCLASS = CONSTANT );
       60     9599
       61     9600        /********************************************************************/
       62     9601        /*        XUR$GETCMD stuff        XUR$GETCMD stuff                  */
       63     9602        /********************************************************************/
       64     9603
       65     9604        %XUR_INIT( NAME=XUR_INIT, STCLASS=STATIC, PCB=P_PCB, SYNTAX=YES );
       66     9703    1   DCL U$$ EPTR CONSTANT INIT( ENTADDR(DPM$PARSE_U$) );
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:51   
       67     9704    1   DCL DPM$PARSE_U$ ENTRY(1);
       68     9705
       69     9706        /********************************************************************/
       70     9707        /*        X$PARSE  stuff          X$PARSE  stuff                    */
       71     9708        /********************************************************************/
       72     9709
       73     9710        %P_PCB( NAME=P_PCB, STCLASS=STATIC );
       74     9909        %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(OUT$)" );
       75     9954        %PARSE$SYM( NAME=OUT$SYM, STCLASS="BASED(BLK$)" );
       76     9992
       77     9993        /********************************************************************/
       78     9994        /*        B$OBJECT_C stuff        B$OBJECT_C stuff                  */
       79     9995        /********************************************************************/
       80     9996
       81     9997        %B$RECORDSUBS;
       82    10025        %B$HEADKEY( NAME=OU_KEY, STCLASS=STATIC );
       83    10037        %B$HEADKEY( NAME=HEAD_KEY, STCLASS=STATIC );
       84    10049        %B$PLOVERKEY( STCLASS="BASED(OU_KEY$)" );
       85    10079        %B$PLOVERKEY( NAME=PLOVER_KEY, STCLASS=STATIC );
       86    10109        %B$OUHEAD( NAME=HEAD_RECORD, STCLASS=STATIC );
       87    10227        %B$PLOVERBIRTH( NAME=PLOVER_BIRTH, STCLASS=STATIC );
       88    10249        %B$PLOVERBIRTH( STCLASS="BASED(TXT$)" );
       89    10271        %B$PLOVERBIRTHKEY( NAME=PLOVER_BIRTH_KEY, STCLASS=STATIC );
       90    10294        %B$PLOVERBIRTHKEY( STCLASS="BASED(OU_KEY$)" );
       91    10317
       92    10318        /********************************************************************/
       93    10319        /*        'DCBs'                  'DCBs'                            */
       94    10320        /********************************************************************/
       95    10321
       96    10322    1   DCL M$SI DCB;
       97    10323    1   DCL M$LO DCB;
       98    10324    1   DCL M$DO DCB;
       99    10325    1   DCL M$OF DCB;
      100    10326
      101    10327        /********************************************************************/
      102    10328        /*        Global based data       global based data                 */
      103    10329        /********************************************************************/
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:52   
      104    10330
      105    10331        %F$DCB;
      106    10388        %B$TCB( STCLASS="BASED(B$TCB$)" );
      107    10391        %B$ALT;
      108    10399    1   DCL BASED$TEXT CHAR(CNT) BASED;
      109    10400
      110    10401        /********************************************************************/
      111    10402        /*        Global static data      global static data                */
      112    10403        /********************************************************************/
      113    10404
      114    10405    1   DCL DATE CHAR(8) STATIC;
      115    10406    1   DCL TIME CHAR(11) STATIC;
      116    10407    1   DCL DATE_TIME CHAR(21) STATIC;
      117    10408    1   DCL READ_FILE BIT(1) STATIC INIT('0'B);
      118    10409    1   DCL OU_ASSOCIATED BIT(1) STATIC INIT('0'B);
      119    10410    1   DCL OUF_ASSOCIATED BIT(1) STATIC INIT('0'B);
      120    10411    1   DCL NUM_ERRORS SBIN WORD STATIC INIT( 0 );
      121    10412    1   DCL COMP_UTS UBIN WORD STATIC;
      122    10413    1   DCL PLOVER_UTS UBIN WORD STATIC;
      123    10414    1   DCL UTS UBIN WORD STATIC;
      124    10415    1   DCL CMD SBIN WORD STATIC INIT( PLOVER_VAL );
      125    10416    1   DCL TXT CHAR(256) STATIC;
      126    10417    1   DCL CNT SBIN WORD STATIC;
      127    10418    1   DCL NUM_SECTS SBIN WORD STATIC;
      128    10419    1   DCL PLOVER_BIRTH_ARS# UBIN STATIC INIT (52);
      129    10420
      130    10421        /********************************************************************/
      131    10422        /*        Global constant data      global constant data            */
      132    10423        /********************************************************************/
      133    10424
      134    10425    1   DCL PROMPT CHAR(0) CONSTANT INIT('>>');
      135    10426    1   DCL TXT$ PTR CONSTANT INIT(ADDR(TXT));
      136    10427    1   DCL OU_KEY$ PTR CONSTANT INIT(ADDR(OU_KEY));
      137    10428
      138    10429        /********************************************************************/
      139    10430        /*        Symref data             Symref data                       */
      140    10431        /********************************************************************/
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:53   
      141    10432
      142    10433    1   DCL B$JIT$ PTR SYMREF;
      143    10434    1   DCL B$TCB$ PTR SYMREF;
      144    10435    1   DCL 1 B_VERSION ALIGNED SYMREF,
      145    10436    1         2 COUNT UBIN BYTE UNAL,
      146    10437    1         2 TEXT  CHAR(6)   UNAL;
      147    10438    1   DCL INVOKE_CMD SBIN WORD SYMREF;
      148    10439    1   DCL PLOVER_COMMANDS SBIN WORD SYMREF;
      149    10440
      150    10441        /********************************************************************/
      151    10442        /*        Global auto data        global auto data                  */
      152    10443        /********************************************************************/
      153    10444
      154    10445    1   DCL OUT$ PTR;
      155    10446    1   DCL 1 PARSERR REDEF OUT$,
      156    10447    1         2 FCG BIT(12) UNAL,
      157    10448    1         2 MID BIT(6) UNAL,
      158    10449    1         2 MON BIT(1) UNAL,
      159    10450    1         2 CODE UBIN(14) UNAL,
      160    10451    1         2 SEV UBIN(3) UNAL;
      161    10452    1   DCL M$OF$ PTR;
      162    10453    1   DCL M$SI$ PTR;
      163    10454    1   DCL BLK$ PTR;
      164    10455    1   DCL MORE BIT(1);
      165    10456    1   DCL DEVICE_CMD_FILE BIT(1);
      166    10457    1   DCL DO_CMD BIT(1);
      167    10458    1   DCL I SBIN WORD;
      168    10459    1   DCL PLOVER_BIRTH_SIZE UBIN;
      169    10460    1   DCL 1 OU_NAME,
      170    10461    1         2 COUNT SBIN BYTE UNAL,
      171    10462    1         2 TEXT CHAR(31) UNAL;
      172    10463    1   DCL 1 FIELD1 ALIGNED,
      173    10464    1         2 COUNT UBIN BYTE UNAL,
      174    10465    1         2 TEXT CHAR(31);
      175    10466    1   DCL 1 FIELD2 ALIGNED,
      176    10467    1         2 COUNT UBIN BYTE UNAL,
      177    10468    1         2 TEXT CHAR(31);
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:54   
      178    10469    1   DCL 1 FIELD3 ALIGNED,
      179    10470    1         2 COUNT UBIN BYTE UNAL,
      180    10471    1         2 TEXT CHAR(31);
      181    10472        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:55   
      182    10473    1         CALL XUR$SETDCBS( DCBNUM(M$SI), DCBNUM(M$LO) );

  10473  7 000002   000000 236007 xsym               LDQ     M$SI,DL
         7 000003   200072 756100                    STQ     @ARS+1,,AUTO
         7 000004   000000 236007 xsym               LDQ     M$LO,DL
         7 000005   200072 235100                    LDA     @ARS+1,,AUTO
         7 000006   200073 755100                    STA     @ARS+2,,AUTO
         7 000007   200074 756100                    STQ     @ARS+3,,AUTO
         7 000010   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 000011   200077 450500                    STP0    @ARS+6,,AUTO
         7 000012   200073 631500                    EPPR1   @ARS+2,,AUTO
         7 000013   200076 451500                    STP1    @ARS+5,,AUTO
         7 000014   200076 630500                    EPPR0   @ARS+5,,AUTO
         7 000015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000016   000000 701000 xent               TSX1    XUR$SETDCBS
         7 000017   000000 011000                    NOP     0

      183    10474    1         CALL XUR$INIT( XUR_INIT );

  10474  7 000020   000000 630400 8                  EPPR0   0
         7 000021   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000022   000000 701000 xent               TSX1    XUR$INIT
         7 000023   000000 011000                    NOP     0

      184    10475    1         M$OF$ = DCBADDR(DCBNUM(M$OF));

  10475  7 000024   000000 236007 xsym               LDQ     M$OF,DL
         7 000025   000001 470400 8                  LDP0    1
         7 000026   000000 471500                    LDP1    0,,PR0
         7 000027   100000 236106                    LDQ     0,QL,PR1
         7 000030   200004 756100                    STQ     M$OF$,,AUTO

      185    10476    1         M$SI$ = DCBADDR(DCBNUM(M$SI));

  10476  7 000031   000000 236007 xsym               LDQ     M$SI,DL
         7 000032   100000 236106                    LDQ     0,QL,PR1
         7 000033   200005 756100                    STQ     M$SI$,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:56   

      186    10477    1         TXT = B$JIT.CCBUF;

  10477  7 000034   000000 473400 xsym               LDP3    B$JIT$
         7 000035   040000 100500                    MLR     fill='040'O
         7 000036   300033 000400                    ADSC9   27,,PR3                  cn=0,n=256
         7 000037   000437 000400 2                  ADSC9   TXT                      cn=0,n=256

      187    10478    1         CNT = B$JIT.CCARS;

  10478  7 000040   300032 236100                    LDQ     26,,PR3
         7 000041   000022 732000                    QRS     18
         7 000042   000537 756000 2                  STQ     CNT

      188    10479    1         CALL XUR$GETCMD(INVOKE_CMD, OUT$, ,TXT,CNT,U$$)

  10479  7 000043   000002 237000 8                  LDAQ    2
         7 000044   200076 757100                    STAQ    @ARS+5,,AUTO
         7 000045   000004 236000 8                  LDQ     4
         7 000046   000001 235000 xsym               LDA     B_VECTNIL+1
         7 000047   200074 757100                    STAQ    @ARS+3,,AUTO
         7 000050   200003 634500                    EPPR4   OUT$,,AUTO
         7 000051   200073 454500                    STP4    @ARS+2,,AUTO
         7 000052   000005 236000 8                  LDQ     5
         7 000053   200072 756100                    STQ     @ARS+1,,AUTO
         7 000054   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000055   000024 631400 xsym               EPPR1   B_VECTNIL+20
         7 000056   000000 701000 xent               TSX1    XUR$GETCMD
         7 000057   000061 702000 7                  TSX2    s:10481
         7 000060   000104 710000 7                  TRA     s:10485

      189    10480    2         WHENALTRETURN DO;

      190    10481    2             CALL XUR$ERRPTR( , DCBNUM(M$DO) );

  10481  7 000061   000000 236007 xsym               LDQ     M$DO,DL
         7 000062   200072 756100                    STQ     @ARS+1,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:57   
         7 000063   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000064   200075 450500                    STP0    @ARS+4,,AUTO
         7 000065   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 000066   200074 756100                    STQ     @ARS+3,,AUTO
         7 000067   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 000070   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000071   000000 701000 xent               TSX1    XUR$ERRPTR
         7 000072   000000 011000                    NOP     0

      191    10482    2             CALL XUR$ERRMSG( PARSERR );

  10482  7 000073   200003 630500                    EPPR0   OUT$,,AUTO
         7 000074   200072 450500                    STP0    @ARS+1,,AUTO
         7 000075   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000077   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000100   000000 011000                    NOP     0

      192    10483    2             CALL M$EXIT( SET_STEPCC_TO_4 );

  10483  7 000101   000000 630400 1                  EPPR0   SET_STEPCC_TO_4
         7 000102   000001 713400                    CLIMB   exit
         7 000103   400400 401760                    pmme    nvectors=2

      193    10484    2             END;

      194    10485    1         CALL PLOVER_COMMAND;

  10485  7 000104   001547 701000 7                  TSX1    PLOVER_COMMAND
         7 000105   000000 011000                    NOP     0

      195    10486    1         IF NOT M$SI$->F$DCB.FCD# THEN CALL OPEN_CMD_FILE;

  10486  7 000106   200005 470500                    LDP0    M$SI$,,AUTO
         7 000107   000031 236100                    LDQ     25,,PR0
         7 000110   020000 316007                    CANQ    8192,DL
         7 000111   000114 601000 7                  TNZ     s:10487
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:58   

  10486  7 000112   000502 701000 7                  TSX1    OPEN_CMD_FILE
         7 000113   000000 011000                    NOP     0

      196    10487    1         DEVICE_CMD_FILE = ( M$SI$->F$DCB.ASN# = %DEVICE# );

  10487  7 000114   400000 220003                    LDX0    -131072,DU
         7 000115   200005 470500                    LDP0    M$SI$,,AUTO
         7 000116   000032 236100                    LDQ     26,,PR0
         7 000117   777000 376007                    ANQ     -512,DL
         7 000120   003000 116007                    CMPQ    1536,DL
         7 000121   000123 600000 7                  TZE     s:10487+7
         7 000122   000000 220003                    LDX0    0,DU
         7 000123   000000 636010                    EAQ     0,X0
         7 000124   200010 756100                    STQ     DEVICE_CMD_FILE,,AUTO

      197    10488    1         MORE = '1'B;

  10488  7 000125   400000 236003                    LDQ     -131072,DU
         7 000126   200007 756100                    STQ     MORE,,AUTO

      198    10489    1         DO_CMD = '1'B;

  10489  7 000127   200011 756100                    STQ     DO_CMD,,AUTO

      199    10490    2         DO WHILE( MORE );

  10490  7 000130   200007 234100                    SZN     MORE,,AUTO
         7 000131   000471 605000 7                  TPL     s:10596

      200    10491    2             CALL XUR$GETCMD(PLOVER_COMMANDS, OUT$, VECTOR(PROMPT), , , U$$ ) ALTRET(
             10491                      PARSE_ERR);

  10491  7 000132   000003 236000 8                  LDQ     3
         7 000133   000001 235000 xsym               LDA     B_VECTNIL+1
         7 000134   200076 757100                    STAQ    @ARS+5,,AUTO
         7 000135   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:59   
         7 000136   000010 235000 8                  LDA     8
         7 000137   200074 757100                    STAQ    @ARS+3,,AUTO
         7 000140   200003 630500                    EPPR0   OUT$,,AUTO
         7 000141   200073 450500                    STP0    @ARS+2,,AUTO
         7 000142   000011 236000 8                  LDQ     9
         7 000143   200072 756100                    STQ     @ARS+1,,AUTO
         7 000144   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000145   000024 631400 xsym               EPPR1   B_VECTNIL+20
         7 000146   000000 701000 xent               TSX1    XUR$GETCMD
         7 000147   000333 702000 7                  TSX2    PARSE_ERR

      201    10492    2             CMD = P$NODE.CODE;

  10492  7 000150   200003 470500                    LDP0    OUT$,,AUTO
         7 000151   000000 236100                    LDQ     0,,PR0
         7 000152   777777 376007                    ANQ     -1,DL
         7 000153   000436 756000 2                  STQ     CMD

      202    10493    3             DO CASE( CMD );

  10493  7 000154   000037 116007                    CMPQ    31,DL
         7 000155   000157 602006 7                  TNC     s:10493+3,QL
         7 000156   000332 710000 7                  TRA     s:10545
         7 000157   000332 710000 7                  TRA     s:10545
         7 000160   000251 710000 7                  TRA     s:10517
         7 000161   000251 710000 7                  TRA     s:10517
         7 000162   000277 710000 7                  TRA     s:10533
         7 000163   000263 710000 7                  TRA     s:10523
         7 000164   000251 710000 7                  TRA     s:10517
         7 000165   000256 710000 7                  TRA     s:10520
         7 000166   000332 710000 7                  TRA     s:10545
         7 000167   000216 710000 7                  TRA     s:10495
         7 000170   000244 710000 7                  TRA     s:10511
         7 000171   000272 710000 7                  TRA     s:10530
         7 000172   000220 710000 7                  TRA     s:10500
         7 000173   000232 710000 7                  TRA     s:10505
         7 000174   000237 710000 7                  TRA     s:10508
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:60   
         7 000175   000251 710000 7                  TRA     s:10517
         7 000176   000251 710000 7                  TRA     s:10517
         7 000177   000251 710000 7                  TRA     s:10517
         7 000200   000304 710000 7                  TRA     s:10536
         7 000201   000251 710000 7                  TRA     s:10517
         7 000202   000251 710000 7                  TRA     s:10517
         7 000203   000251 710000 7                  TRA     s:10517
         7 000204   000251 710000 7                  TRA     s:10517
         7 000205   000332 710000 7                  TRA     s:10545
         7 000206   000251 710000 7                  TRA     s:10517
         7 000207   000251 710000 7                  TRA     s:10517
         7 000210   000251 710000 7                  TRA     s:10517
         7 000211   000311 710000 7                  TRA     s:10539
         7 000212   000251 710000 7                  TRA     s:10517
         7 000213   000321 710000 7                  TRA     s:10542
         7 000214   000321 710000 7                  TRA     s:10542
         7 000215   000321 710000 7                  TRA     s:10542

      203    10494    3               CASE( END_VAL );

      204    10495    3                 MORE = '0'B;

  10495  7 000216   200007 450100                    STZ     MORE,,AUTO
         7 000217   000332 710000 7                  TRA     s:10545

      205    10496
      206    10497    3               CASE( BLANK_VAL );

      207    10498
      208    10499    3               CASE( HELP_VAL );

      209    10500    3                 XUH_PARAM.HELP$ = P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0);

  10500  7 000220   000003 471500                    LDP1    3,,PR0
         7 000221   100003 236100                    LDQ     3,,PR1
         7 000222   000143 756000 2                  STQ     XUH_PARAM+9

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:61   
      210    10501    3                 XUH_PARAM.TOPICS# = '0'B;

  10501  7 000223   000012 236000 8                  LDQ     10
         7 000224   000144 356000 2                  ANSQ    XUH_PARAM+10

      211    10502    3                 CALL XUR$HELP( XUH_PARAM );

  10502  7 000225   000013 630400 8                  EPPR0   11
         7 000226   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000227   000000 701000 xent               TSX1    XUR$HELP
         7 000230   000000 011000                    NOP     0
         7 000231   000332 710000 7                  TRA     s:10545

      212    10503
      213    10504    3               CASE( QUEST_VAL );

      214    10505    3                 CALL XUR$MOREMSG( XUH_PARAM );

  10505  7 000232   000013 630400 8                  EPPR0   11
         7 000233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000234   000000 701000 xent               TSX1    XUR$MOREMSG
         7 000235   000000 011000                    NOP     0
         7 000236   000332 710000 7                  TRA     s:10545

      215    10506
      216    10507    3               CASE( DQUEST_VAL );

      217    10508    3                 CALL XUR$ALLMSG( XUH_PARAM );

  10508  7 000237   000013 630400 8                  EPPR0   11
         7 000240   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000241   000000 701000 xent               TSX1    XUR$ALLMSG
         7 000242   000000 011000                    NOP     0
         7 000243   000332 710000 7                  TRA     s:10545

      218    10509
      219    10510    3               CASE( PLOVER_VAL );
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:62   

      220    10511    3                 CALL PLOVER_COMMAND         ALTRET( READ_ERR );

  10511  7 000244   001547 701000 7                  TSX1    PLOVER_COMMAND
         7 000245   000361 702000 7                  TSX2    READ_ERR

      221    10512    3                 DO_CMD = '1'B;

  10512  7 000246   400000 236003                    LDQ     -131072,DU
         7 000247   200011 756100                    STQ     DO_CMD,,AUTO
         7 000250   000332 710000 7                  TRA     s:10545

      222    10513
      223    10514    3               CASE( MODIFY_VAL, DEFINE_VAL, SCHEMA_VAL, KILL_VAL, ECHO_VAL,

      224    10515    3                     STORE_VAL, PREV_VAL, NEXT_VAL, OPEN_VAL, COPY_VAL, STAR_VAL,
      225    10516    3                     SYNTAX_VAL, ALTVAR_VAL, FIND_VAL );
      226    10517    3                 IF DO_CMD THEN CALL RUM_COMMAND ALTRET( CMD_ERR );

  10517  7 000251   200011 234100                    SZN     DO_CMD,,AUTO
         7 000252   000332 605000 7                  TPL     s:10545

  10517  7 000253   002126 701000 7                  TSX1    RUM_COMMAND
         7 000254   000466 702000 7                  TSX2    CMD_ERR
         7 000255   000332 710000 7                  TRA     s:10545

      227    10518
      228    10519    3               CASE( LIST_VAL );

      229    10520    3                 IF DO_CMD THEN CALL LIST_COMMAND ALTRET( CMD_ERR );

  10520  7 000256   200011 234100                    SZN     DO_CMD,,AUTO
         7 000257   000332 605000 7                  TPL     s:10545

  10520  7 000260   002407 701000 7                  TSX1    LIST_COMMAND
         7 000261   000466 702000 7                  TSX2    CMD_ERR
         7 000262   000332 710000 7                  TRA     s:10545
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:63   

      230    10521
      231    10522    3               CASE( DELETE_VAL );

      232    10523    4                 IF DO_CMD THEN DO;

  10523  7 000263   200011 234100                    SZN     DO_CMD,,AUTO
         7 000264   000332 605000 7                  TPL     s:10545

      233    10524    4                     CALL DELETE_COMMAND         ALTRET( CMD_ERR );

  10524  7 000265   003125 701000 7                  TSX1    DELETE_COMMAND
         7 000266   000466 702000 7                  TSX2    CMD_ERR

      234    10525    4                     PLOVER_BIRTH.IPATCH = 0;

  10525  7 000267   000410 450000 2                  STZ     PLOVER_BIRTH+11

      235    10526    4                     PLOVER_BIRTH.DPATCH = 0;

  10526  7 000270   000411 450000 2                  STZ     PLOVER_BIRTH+12

      236    10527    4                     END;

  10527  7 000271   000332 710000 7                  TRA     s:10545

      237    10528
      238    10529    3               CASE( SYMDEF_VAL );

      239    10530    3                 IF DO_CMD THEN CALL SYMDEF_COMMAND ALTRET( CMD_ERR );

  10530  7 000272   200011 234100                    SZN     DO_CMD,,AUTO
         7 000273   000332 605000 7                  TPL     s:10545

  10530  7 000274   003615 701000 7                  TSX1    SYMDEF_COMMAND
         7 000275   000466 702000 7                  TSX2    CMD_ERR
         7 000276   000332 710000 7                  TRA     s:10545
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:64   

      240    10531
      241    10532    3               CASE( ENTREF_VAL );

      242    10533    3                 IF DO_CMD THEN CALL ENTREF_COMMAND ALTRET( CMD_ERR );

  10533  7 000277   200011 234100                    SZN     DO_CMD,,AUTO
         7 000300   000332 605000 7                  TPL     s:10545

  10533  7 000301   004167 701000 7                  TSX1    ENTREF_COMMAND
         7 000302   000466 702000 7                  TSX2    CMD_ERR
         7 000303   000332 710000 7                  TRA     s:10545

      243    10534
      244    10535    3               CASE( EXT_VAL );

      245    10536    3                 IF DO_CMD THEN CALL EXTERNAL_COMMAND ALTRET( CMD_ERR );

  10536  7 000304   200011 234100                    SZN     DO_CMD,,AUTO
         7 000305   000332 605000 7                  TPL     s:10545

  10536  7 000306   004270 701000 7                  TSX1    EXTERNAL_COMMAND
         7 000307   000466 702000 7                  TSX2    CMD_ERR
         7 000310   000332 710000 7                  TRA     s:10545

      246    10537
      247    10538    3               CASE( READ_VAL );

      248    10539    3                IF DO_CMD THEN CALL READ_COMMAND( P$NODE.SUBLK$(0) ) ALTRET(READ_ERR);

  10539  7 000311   200011 234100                    SZN     DO_CMD,,AUTO
         7 000312   000332 605000 7                  TPL     s:10545

  10539  7 000313   200003 236100                    LDQ     OUT$,,AUTO
         7 000314   000003 036003                    ADLQ    3,DU
         7 000315   200065 756100                    STQ     @BUF_+1,,AUTO
         7 000316   004503 701000 7                  TSX1    READ_COMMAND
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:65   
         7 000317   000361 702000 7                  TSX2    READ_ERR
         7 000320   000332 710000 7                  TRA     s:10545

      249    10540
      250    10541    3               CASE( IPTCH_VAL ,DPTCH_VAL, RESET_VAL );

      251    10542    3                 IF DO_CMD THEN CALL IDPATCH_COMMAND( P$NODE.SUBLK$(0),CMD ) ALTRET (
             10542                          CMD_ERR);

  10542  7 000321   200011 234100                    SZN     DO_CMD,,AUTO
         7 000322   000332 605000 7                  TPL     s:10545

  10542  7 000323   000014 236000 8                  LDQ     12
         7 000324   200056 756100                    STQ     @PTR$+1,,AUTO
         7 000325   200003 236100                    LDQ     OUT$,,AUTO
         7 000326   000003 036003                    ADLQ    3,DU
         7 000327   200055 756100                    STQ     FIELD3+9,,AUTO
         7 000330   004642 701000 7                  TSX1    IDPATCH_COMMAND
         7 000331   000466 702000 7                  TSX2    CMD_ERR

      252    10543
      253    10544    3               END;

      254    10545    3             DO WHILE( '0'B );

  10545  7 000332   000467 710000 7                  TRA     s:10594

      255    10546    3   PARSE_ERR:    IF PARSERR.MON  AND  PARSERR.CODE = %E$EOF THEN

  10546  7 000333   200003 236100       PARSE_ERR    LDQ     OUT$,,AUTO
         7 000334   400000 316007                    CANQ    -131072,DL
         7 000335   000372 600000 7                  TZE     s:10556
         7 000336   200003 236100                    LDQ     OUT$,,AUTO
         7 000337   377770 376007                    ANQ     131064,DL
         7 000340   000060 116007                    CMPQ    48,DL
         7 000341   000372 601000 7                  TNZ     s:10556

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:66   
      256    10547    3                     IF NOT READ_FILE THEN MORE = '0'B;

  10547  7 000342   000427 234000 2                  SZN     READ_FILE
         7 000343   000346 604000 7                  TMI     s:10549

  10547  7 000344   200007 450100                    STZ     MORE,,AUTO
         7 000345   000467 710000 7                  TRA     s:10594

      257    10548    4                     ELSE DO;

      258    10549    4                         CALL XUR$ERRMSG( PARSERR, DCBNUM(M$SI) );

  10549  7 000346   000000 236007 xsym               LDQ     M$SI,DL
         7 000347   200072 756100                    STQ     @ARS+1,,AUTO
         7 000350   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000351   200075 450500                    STP0    @ARS+4,,AUTO
         7 000352   200003 631500                    EPPR1   OUT$,,AUTO
         7 000353   200074 451500                    STP1    @ARS+3,,AUTO
         7 000354   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 000355   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000356   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000357   000000 011000                    NOP     0

      259    10550    4                         READ_FILE = '0'B;

  10550  7 000360   000427 450000 2                  STZ     READ_FILE

      260    10551    4   READ_ERR:             IF DEVICE_CMD_FILE THEN CALL OPEN_CMD_FILE;

  10551  7 000361   200010 234100       READ_ERR     SZN     DEVICE_CMD_FILE,,AUTO
         7 000362   000366 605000 7                  TPL     s:10552

  10551  7 000363   000502 701000 7                  TSX1    OPEN_CMD_FILE
         7 000364   000000 011000                    NOP     0
         7 000365   000367 710000 7                  TRA     s:10553

      261    10552    4                         ELSE MORE = '0'B;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:67   

  10552  7 000366   200007 450100                    STZ     MORE,,AUTO

      262    10553    4                         DO_CMD = '1'B;

  10553  7 000367   400000 236003                    LDQ     -131072,DU
         7 000370   200011 756100                    STQ     DO_CMD,,AUTO

      263    10554    4                         END;

  10554  7 000371   000467 710000 7                  TRA     s:10594

      264    10555    4                 ELSE DO;

      265    10556    4                     IF PARSERR.MON THEN

  10556  7 000372   200003 236100                    LDQ     OUT$,,AUTO
         7 000373   400000 316007                    CANQ    -131072,DL
         7 000374   000377 600000 7                  TZE     s:10569

      266    10557    4                         MORE = '0'B;

  10557  7 000375   200007 450100                    STZ     MORE,,AUTO
         7 000376   000454 710000 7                  TRA     s:10590

      267    10558    5                     ELSE DO;

      268    10559        /*E*  ERROR:  DPM-E$BAD_COMMAND_LINE-C
      269    10560              MESSAGE: This command is invalid, and will be ignored.
      270    10561        */
      271    10562                              %SCREAM( ERR#=E$BAD_COMMAND_LINE );

  10569  7 000377   000000 236007 xsym               LDQ     M$DO,DL
         7 000400   200072 756100                    STQ     @ARS+1,,AUTO
         7 000401   000020 237000 8                  LDAQ    16
         7 000402   200100 757100                    STAQ    @ARS+7,,AUTO
         7 000403   000022 237000 8                  LDAQ    18
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:68   
         7 000404   200076 757100                    STAQ    @ARS+5,,AUTO
         7 000405   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000406   200075 450500                    STP0    @ARS+4,,AUTO
         7 000407   000021 236000 8                  LDQ     17
         7 000410   200074 756100                    STQ     @ARS+3,,AUTO
         7 000411   000024 236000 8                  LDQ     20
         7 000412   200073 756100                    STQ     @ARS+2,,AUTO
         7 000413   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 000414   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 000415   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000416   000000 011000                    NOP     0

      272    10572    5                         CALL XUR$ERRPTR( , DCBNUM(M$DO) );

  10572  7 000417   000000 236007 xsym               LDQ     M$DO,DL
         7 000420   200072 756100                    STQ     @ARS+1,,AUTO
         7 000421   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000422   200075 450500                    STP0    @ARS+4,,AUTO
         7 000423   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 000424   200074 756100                    STQ     @ARS+3,,AUTO
         7 000425   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 000426   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000427   000000 701000 xent               TSX1    XUR$ERRPTR
         7 000430   000000 011000                    NOP     0

      273    10573    6                         IF READ_FILE THEN DO;

  10573  7 000431   000427 234000 2                  SZN     READ_FILE
         7 000432   000454 605000 7                  TPL     s:10590

      274    10574    6                             DO_CMD = '0'B;

  10574  7 000433   200011 450100                    STZ     DO_CMD,,AUTO

      275    10575        /*E*  ERROR:  DPM-E$IGNORE_CMDS-C
      276    10576         MESSAGE: Commands in this file will not be executed until the next PLOVER command.
      277    10577        */
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:69   
      278    10578                                  %SCREAM( ERR#=E$IGNORE_CMDS );

  10585  7 000434   000000 236007 xsym               LDQ     M$DO,DL
         7 000435   200072 756100                    STQ     @ARS+1,,AUTO
         7 000436   000020 237000 8                  LDAQ    16
         7 000437   200100 757100                    STAQ    @ARS+7,,AUTO
         7 000440   000022 237000 8                  LDAQ    18
         7 000441   200076 757100                    STAQ    @ARS+5,,AUTO
         7 000442   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000443   200075 450500                    STP0    @ARS+4,,AUTO
         7 000444   000021 236000 8                  LDQ     17
         7 000445   200074 756100                    STQ     @ARS+3,,AUTO
         7 000446   000025 236000 8                  LDQ     21
         7 000447   200073 756100                    STQ     @ARS+2,,AUTO
         7 000450   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 000451   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 000452   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000453   000000 011000                    NOP     0

      279    10588    6                             END;

      280    10589    5                         END;

      281    10590    4                     CALL XUR$ERRMSG( PARSERR, DCBNUM(M$SI) );

  10590  7 000454   000000 236007 xsym               LDQ     M$SI,DL
         7 000455   200072 756100                    STQ     @ARS+1,,AUTO
         7 000456   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000457   200075 450500                    STP0    @ARS+4,,AUTO
         7 000460   200003 631500                    EPPR1   OUT$,,AUTO
         7 000461   200074 451500                    STP1    @ARS+3,,AUTO
         7 000462   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 000463   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000464   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000465   000000 011000                    NOP     0

      282    10591    4   CMD_ERR:          NUM_ERRORS = NUM_ERRORS + 1;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:70   

  10591  7 000466   000432 054000 2     CMD_ERR      AOS     NUM_ERRORS

      283    10592    4                     END;

      284    10593    3                 END;

      285    10594    2             END;

  10594  7 000467   200007 234100                    SZN     MORE,,AUTO
         7 000470   000132 604000 7                  TMI     s:10491

      286    10595
      287    10596    1         CALL XUR$CLOSE_DCBS;

  10596  7 000471   000002 631400 xsym               EPPR1   B_VECTNIL+2
         7 000472   000000 701000 xent               TSX1    XUR$CLOSE_DCBS
         7 000473   000000 011000                    NOP     0

      288    10597
      289    10598    2         IF NUM_ERRORS > 0 THEN DO;

  10598  7 000474   000432 235000 2                  LDA     NUM_ERRORS
         7 000475   000501 604400 7                  TMOZ    s:10600

      290    10599    2             CALL M$EXIT( SET_STEPCC_TO_4 );

  10599  7 000476   000000 630400 1                  EPPR0   SET_STEPCC_TO_4
         7 000477   000001 713400                    CLIMB   exit
         7 000500   400400 401760                    pmme    nvectors=2

      291    10600    2             END;

  10600  7 000501   005026 710000 7                  TRA     s:12526

      292    10601        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:71   
      293    10602    1   OPEN_CMD_FILE: PROC;

  10602  7 000502   200054 741300       OPEN_CMD_FI* STX1  ! FIELD3+8,,AUTO

      294    10603
      295    10604        %FPT_OPEN( DCB=M$SI, ASN=DEVICE, RES='ME', SCRUB=YES, REASSIGN=YES );
      296    10713
      297    10714    3         IF M$SI$->F$DCB.FCD# THEN CALL M$CLOSE( CLOSE_SI ) WHENALTRETURN DO; END;

  10714  7 000503   200005 470500                    LDP0    M$SI$,,AUTO
         7 000504   000031 236100                    LDQ     25,,PR0
         7 000505   020000 316007                    CANQ    8192,DL
         7 000506   000514 600000 7                  TZE     s:10715

  10714  7 000507   000052 630400 1                  EPPR0   CLOSE_SI
         7 000510   450001 713400                    CLIMB   alt,close
         7 000511   406000 401760                    pmme    nvectors=13
         7 000512   000514 702000 7                  TSX2    s:10715
         7 000513   000514 710000 7                  TRA     s:10715

      298    10715    2         CALL M$OPEN( FPT_OPEN )

  10715  7 000514   000542 630400 2                  EPPR0   FPT_OPEN
         7 000515   450000 713400                    CLIMB   alt,open
         7 000516   410400 401760                    pmme    nvectors=18
         7 000517   000521 702000 7                  TSX2    s:10717
         7 000520   000540 710000 7                  TRA     s:10721

      299    10716    3         WHENALTRETURN DO;

      300    10717    3             CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$SI) );

  10717  7 000521   000000 470400 xsym               LDP0    B$TCB$
         7 000522   000000 471500                    LDP1    0,,PR0
         7 000523   000000 236007 xsym               LDQ     M$SI,DL
         7 000524   200072 756100                    STQ     @ARS+1,,AUTO
         7 000525   200072 633500                    EPPR3   @ARS+1,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:72   
         7 000526   200075 453500                    STP3    @ARS+4,,AUTO
         7 000527   100102 634500                    EPPR4   66,,PR1
         7 000530   200074 454500                    STP4    @ARS+3,,AUTO
         7 000531   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 000532   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000533   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000534   000000 011000                    NOP     0

      301    10718    3             CALL M$EXIT( SET_STEPCC_TO_4 );

  10718  7 000535   000000 630400 1                  EPPR0   SET_STEPCC_TO_4
         7 000536   000001 713400                    CLIMB   exit
         7 000537   400400 401760                    pmme    nvectors=2

      302    10719    3             END;

      303    10720
      304    10721    2   END OPEN_CMD_FILE;

  10721  7 000540   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 000541   000001 702211                    TSX2  ! 1,X1

      305    10722        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:73   
      306    10723    1   WRITE_LO: PROC( BUF, BUF_SIZE );

  10723  7 000542   200064 741300       WRITE_LO     STX1  ! @KEY_+1,,AUTO

      307    10724
      308    10725    2   DCL BUF CHAR(BUF_SIZE);
      309    10726    2   DCL BUF_SIZE SBIN WORD;
      310    10727
      311    10728        %FPT_WRITE( DCB=M$LO );
      312    10759
      313    10760    2         FPT_WRITE.BUF_ = VECTOR( BUF );

  10760  7 000543   200066 470500                    LDP0    @BUF_SIZE,,AUTO
         7 000544   000000 720100                    LXL0    0,,PR0
         7 000545   000000 635010                    EAA     0,X0
         7 000546   000002 731000                    ARS     2
         7 000547   000140 135007                    SBLA    96,DL
         7 000550   200065 236100                    LDQ     @BUF,,AUTO
         7 000551   000640 757000 2                  STAQ    FPT_WRITE+4

      314    10761    2         CALL M$WRITE( FPT_WRITE );

  10761  7 000552   000634 630400 2                  EPPR0   FPT_WRITE
         7 000553   040001 713400                    CLIMB   write
         7 000554   401400 401760                    pmme    nvectors=4

      315    10762    2         RETURN;

  10762  7 000555   200064 221300                    LDX1  ! @KEY_+1,,AUTO
         7 000556   000001 702211                    TSX2  ! 1,X1

      316    10763
      317    10764    2   END WRITE_LO;
      318    10765        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:74   
      319    10766        /*I*  NAME:        OPEN_OF
      320    10767              PURPOSE:     Opens the object unit file for PLOVERing.
      321    10768              CALL:        CALL OPEN_OF  ALTRET
      322    10769              DATA:        BLK$->OUT$SYM.TEXT is the fid for the file.
      323    10770              DESCRIPTION: M$FID is called to convert the fid into name,
      324    10771                           account, etc.  If the fid is valid, M$OPEN is
      325    10772                           called to open the file. The altreturn is taken
      326    10773                           if there are any errors.
      327    10774        */
      328    10775    1   OPEN_OF: PROC ALTRET;

  10775  7 000557   200064 741300       OPEN_OF      STX1  ! @KEY_+1,,AUTO

      329    10776
      330    10777        %FPT_OPEN( DCB=M$OF, ASN=FILE, ORG=KEYED, FUN=UPDATE, ACS=DIRECT, SCRUB=YES );
      331    10886        %FPT_CLOSE(DCB=M$OF, DISP=SAVE );
      332    10928        %FPT_FID( NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS, SN=VLP_SN, WSN=VLP_WSN,
      333    10929                  ASN=FPT_OPEN.V.ASN#, RES=FPT_OPEN.V.RES#, RESULTS=VLR_FID );
      334    10952
      335    10953
      336    10954    2         OUF_ASSOCIATED = '0'B;

  10954  7 000560   000431 450000 2                  STZ     OUF_ASSOCIATED

      337    10955    2         OU_ASSOCIATED  = '0'B;

  10955  7 000561   000430 450000 2                  STZ     OU_ASSOCIATED

      338    10956    2         FPT_FID.TEXTFID_ = VECTOR( OUT$SYM.TEXT );

  10956  7 000562   200006 470500                    LDP0    BLK$,,AUTO
         7 000563   000004 236100                    LDQ     4,,PR0
         7 000564   000033 772000                    QRL     27
         7 000565   000064 737000                    LLS     52
         7 000566   000140 135007                    SBLA    96,DL
         7 000567   200006 236100                    LDQ     BLK$,,AUTO
         7 000570   000026 036000 8                  ADLQ    22
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:75   
         7 000571   001002 757000 2                  STAQ    FPT_FID+2

      339    10957    2         CALL M$FID( FPT_FID ) ALTRET( FID_ERR );

  10957  7 000572   001000 630400 2                  EPPR0   FPT_FID
         7 000573   420001 713400                    CLIMB   alt,+8193
         7 000574   404400 401760                    pmme    nvectors=10
         7 000575   000737 702000 7                  TSX2    FID_ERR

      340    10958    3         IF FPT_OPEN.V.ASN# ~= %FILE#  OR  NOT VLR_FID.NAME THEN DO;

  10958  7 000576   000715 236000 2                  LDQ     FPT_OPEN+37
         7 000577   000777 376007                    ANQ     511,DL
         7 000600   000001 116007                    CMPQ    1,DL
         7 000601   000604 601000 7                  TNZ     s:10969
         7 000602   000036 234000 2                  SZN     VLR_FID
         7 000603   000626 604000 7                  TMI     s:10974

      341    10959        /*E*  ERROR:  DPM-E$NOT_A_FILE-C
      342    10960              MESSAGE: Specfied PLOVER fid is not a file.
      343    10961        */
      344    10962                  %SCREAM( ERR#=E$NOT_A_FILE );

  10969  7 000604   000000 236007 xsym               LDQ     M$DO,DL
         7 000605   200072 756100                    STQ     @ARS+1,,AUTO
         7 000606   000020 237000 8                  LDAQ    16
         7 000607   200100 757100                    STAQ    @ARS+7,,AUTO
         7 000610   000022 237000 8                  LDAQ    18
         7 000611   200076 757100                    STAQ    @ARS+5,,AUTO
         7 000612   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000613   200075 450500                    STP0    @ARS+4,,AUTO
         7 000614   000021 236000 8                  LDQ     17
         7 000615   200074 756100                    STQ     @ARS+3,,AUTO
         7 000616   000027 236000 8                  LDQ     23
         7 000617   200073 756100                    STQ     @ARS+2,,AUTO
         7 000620   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 000621   000025 631400 xsym               EPPR1   B_VECTNIL+21
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:76   
         7 000622   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000623   000000 011000                    NOP     0

      345    10972    3             ALTRETURN;

  10972  7 000624   200064 221300                    LDX1  ! @KEY_+1,,AUTO
         7 000625   000000 702211                    TSX2  ! 0,X1

      346    10973    3             END;
      347    10974    2         FPT_OPEN.NAME_ = VECTOR(VLP_NAME);

  10974  7 000626   000030 237000 8                  LDAQ    24
         7 000627   000656 757000 2                  STAQ    FPT_OPEN+6

      348    10975    2         IF VLR_FID.ACCT THEN

  10975  7 000630   000036 236000 2                  LDQ     VLR_FID
         7 000631   200000 316003                    CANQ    65536,DU
         7 000632   000636 600000 7                  TZE     s:10978

      349    10976    2             FPT_OPEN.ACCT_ = VECTOR(VLP_ACCT);

  10976  7 000633   000032 237000 8                  LDAQ    26
         7 000634   000674 757000 2                  STAQ    FPT_OPEN+20
         7 000635   000640 710000 7                  TRA     s:10979

      350    10977    2         ELSE
      351    10978    2             FPT_OPEN.ACCT_ = VECTOR(NIL);

  10978  7 000636   000016 237000 8                  LDAQ    14
         7 000637   000674 757000 2                  STAQ    FPT_OPEN+20

      352    10979    2         IF VLR_FID.PASS THEN

  10979  7 000640   000036 236000 2                  LDQ     VLR_FID
         7 000641   100000 316003                    CANQ    32768,DU
         7 000642   000646 600000 7                  TZE     s:10982
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:77   

      353    10980    2             FPT_OPEN.PASS_ = VECTOR(VLP_PASS);

  10980  7 000643   000034 237000 8                  LDAQ    28
         7 000644   000660 757000 2                  STAQ    FPT_OPEN+8
         7 000645   000650 710000 7                  TRA     s:10983

      354    10981    2         ELSE
      355    10982    2             FPT_OPEN.PASS_ = VECTOR(NIL);

  10982  7 000646   000016 237000 8                  LDAQ    14
         7 000647   000660 757000 2                  STAQ    FPT_OPEN+8

      356    10983    2         IF VLR_FID.SN THEN

  10983  7 000650   000036 236000 2                  LDQ     VLR_FID
         7 000651   040000 316003                    CANQ    16384,DU
         7 000652   000656 600000 7                  TZE     s:10986

      357    10984    2             FPT_OPEN.SN_ = VECTOR(VLP_SN);

  10984  7 000653   000036 237000 8                  LDAQ    30
         7 000654   000652 757000 2                  STAQ    FPT_OPEN+2
         7 000655   000660 710000 7                  TRA     s:10987

      358    10985    2         ELSE
      359    10986    2             FPT_OPEN.SN_ = VECTOR(NIL);

  10986  7 000656   000016 237000 8                  LDAQ    14
         7 000657   000652 757000 2                  STAQ    FPT_OPEN+2

      360    10987    2         IF VLR_FID.WSN THEN

  10987  7 000660   000036 236000 2                  LDQ     VLR_FID
         7 000661   020000 316003                    CANQ    8192,DU
         7 000662   000666 600000 7                  TZE     s:10990

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:78   
      361    10988    2             FPT_OPEN.WSN_ = VECTOR(VLP_WSN);

  10988  7 000663   000040 237000 8                  LDAQ    32
         7 000664   000702 757000 2                  STAQ    FPT_OPEN+26
         7 000665   000670 710000 7                  TRA     s:10991

      362    10989    2         ELSE
      363    10990    2             FPT_OPEN.WSN_ = VECTOR(NIL);

  10990  7 000666   000016 237000 8                  LDAQ    14
         7 000667   000702 757000 2                  STAQ    FPT_OPEN+26

      364    10991    2         IF M$OF$ -> F$DCB.FCD# THEN CALL M$CLOSE(FPT_CLOSE) ALTRET(OPEN_FILE);

  10991  7 000670   200004 470500                    LDP0    M$OF$,,AUTO
         7 000671   000031 236100                    LDQ     25,,PR0
         7 000672   020000 316007                    CANQ    8192,DL
         7 000673   000700 600000 7                  TZE     OPEN_FILE

  10991  7 000674   000742 630400 2                  EPPR0   FPT_CLOSE
         7 000675   450001 713400                    CLIMB   alt,close
         7 000676   406000 401760                    pmme    nvectors=13
         7 000677   000700 702000 7                  TSX2    OPEN_FILE

      365    10992    2   OPEN_FILE:
      366    10993    2         CALL M$OPEN( FPT_OPEN ) ALTRET( OPEN_ERR );

  10993  7 000700   000650 630400 2     OPEN_FILE    EPPR0   FPT_OPEN
         7 000701   450000 713400                    CLIMB   alt,open
         7 000702   410400 401760                    pmme    nvectors=18
         7 000703   000751 702000 7                  TSX2    OPEN_ERR

      367    10994    3         IF M$OF$ -> F$DCB.ORG# ~= %KEYED# THEN DO;

  10994  7 000704   200004 470500                    LDP0    M$OF$,,AUTO
         7 000705   000032 236100                    LDQ     26,,PR0
         7 000706   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:79   
         7 000707   002000 116003                    CMPQ    1024,DU
         7 000710   000733 600000 7                  TZE     s:11010

      368    10995        /*E*  ERROR:  DPM-E$NOT_AN_OUF-C
      369    10996              MESSAGE: Specified PLOVER fid is not an OU file.
      370    10997        */
      371    10998                  %SCREAM( ERR#=E$NOT_AN_OUF );

  11005  7 000711   000000 236007 xsym               LDQ     M$DO,DL
         7 000712   200072 756100                    STQ     @ARS+1,,AUTO
         7 000713   000020 237000 8                  LDAQ    16
         7 000714   200100 757100                    STAQ    @ARS+7,,AUTO
         7 000715   000022 237000 8                  LDAQ    18
         7 000716   200076 757100                    STAQ    @ARS+5,,AUTO
         7 000717   200072 631500                    EPPR1   @ARS+1,,AUTO
         7 000720   200075 451500                    STP1    @ARS+4,,AUTO
         7 000721   000021 236000 8                  LDQ     17
         7 000722   200074 756100                    STQ     @ARS+3,,AUTO
         7 000723   000042 236000 8                  LDQ     34
         7 000724   200073 756100                    STQ     @ARS+2,,AUTO
         7 000725   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 000726   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 000727   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000730   000000 011000                    NOP     0

      372    11008    3             ALTRETURN;

  11008  7 000731   200064 221300                    LDX1  ! @KEY_+1,,AUTO
         7 000732   000000 702211                    TSX2  ! 0,X1

      373    11009    3             END;
      374    11010    2         OUF_ASSOCIATED = '1'B;

  11010  7 000733   400000 236003                    LDQ     -131072,DU
         7 000734   000431 756000 2                  STQ     OUF_ASSOCIATED

      375    11011    2         RETURN;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:80   

  11011  7 000735   200064 221300                    LDX1  ! @KEY_+1,,AUTO
         7 000736   000001 702211                    TSX2  ! 1,X1

      376    11012
      377    11013    2   FID_ERR:
      378    11014    2         CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR );

  11014  7 000737   000000 470400 xsym  FID_ERR      LDP0    B$TCB$
         7 000740   000000 471500                    LDP1    0,,PR0
         7 000741   100102 633500                    EPPR3   66,,PR1
         7 000742   200072 453500                    STP3    @ARS+1,,AUTO
         7 000743   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 000744   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 000745   000000 701000 xent               TSX1    XUR$ERRMSG
         7 000746   000000 011000                    NOP     0

      379    11015    2         ALTRETURN;

  11015  7 000747   200064 221300                    LDX1  ! @KEY_+1,,AUTO
         7 000750   000000 702211                    TSX2  ! 0,X1

      380    11016
      381    11017    2   OPEN_ERR:
      382    11018    2         CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF) );

  11018  7 000751   000000 470400 xsym  OPEN_ERR     LDP0    B$TCB$
         7 000752   000000 471500                    LDP1    0,,PR0
         7 000753   000000 236007 xsym               LDQ     M$OF,DL
         7 000754   200072 756100                    STQ     @ARS+1,,AUTO
         7 000755   200072 633500                    EPPR3   @ARS+1,,AUTO
         7 000756   200075 453500                    STP3    @ARS+4,,AUTO
         7 000757   100102 634500                    EPPR4   66,,PR1
         7 000760   200074 454500                    STP4    @ARS+3,,AUTO
         7 000761   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 000762   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 000763   000000 701000 xent               TSX1    XUR$ERRMSG
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:81   
         7 000764   000000 011000                    NOP     0

      383    11019    2         ALTRETURN;

  11019  7 000765   200064 221300                    LDX1  ! @KEY_+1,,AUTO
         7 000766   000000 702211                    TSX2  ! 0,X1

      384    11020
      385    11021    2   END OPEN_OF;
      386    11022        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:82   
      387    11023        /*I*  NAME:        FIND_OU
      388    11024              PURPOSE:     Trys to find an object unit in the file being PLOVERed
      389    11025              CALL:        CALL FIND_OU  ALTRET
      390    11026              DATA:        BLK$->OUT$SYM.TEXT is the name of the object unit.
      391    11027              DESCRIPTION: READ_OU is called to read the head record for the
      392    11028                           object unit.  If the head record does not exist,
      393    11029                           then the object unit does not exist in the file and
      394    11030                           the altreturn is taken.  READ_OU is called again to
      395    11031                           read the PLOVER BIRTH record for the object unit
      396    11032                           into B$PLOVERBIRTH. If the PLOVER BIRTH record does
      397    11033                           not exist then B$PLOVERBIRTH is initialized. Also,
      398    11034                           if the current command is a PLOVER command, several
      399    11035                           global variables are set.
      400    11036        */
      401    11037    1   FIND_OU: PROC ALTRET;

  11037  7 000767   200064 741300       FIND_OU      STX1  ! @KEY_+1,,AUTO

      402    11038
      403    11039
      404    11040    2         HEAD_KEY.KEYSIZ = OUT$SYM.COUNT + 1;

  11040  7 000770   200006 470500                    LDP0    BLK$,,AUTO
         7 000771   000004 236100                    LDQ     4,,PR0
         7 000772   000033 772000                    QRL     27
         7 000773   000001 036007                    ADLQ    1,DL
         7 000774   000033 736000                    QLS     27
         7 000775   000323 552040 2                  STBQ    HEAD_KEY,'40'O

      405    11041    2         HEAD_KEY.TEXT   = OUT$SYM.TEXT;

  11041  7 000776   000004 236100                    LDQ     4,,PR0
         7 000777   000033 772000                    QRL     27
         7 001000   000000 620006                    EAX0    0,QL
         7 001001   040000 100540                    MLR     fill='040'O
         7 001002   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         7 001003   000323 400037 2                  ADSC9   HEAD_KEY                 cn=2,n=31
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:83   

      406    11042    2         CALL READ_OU( VECTOR(HEAD_KEY), VECTOR(HEAD_RECORD) ) ALTRET( NO_HEAD );

  11042  7 001004   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 001005   000050 235000 8                  LDA     40
         7 001006   200070 757100                    STAQ    VAL+1,,AUTO
         7 001007   000051 236000 8                  LDQ     41
         7 001010   200067 756100                    STQ     I+1,,AUTO
         7 001011   001202 701000 7                  TSX1    READ_OU
         7 001012   001111 702000 7                  TSX2    NO_HEAD

      407    11043    2         B$PLOVERBIRTHKEY = PLOVER_BIRTH_KEY;

  11043  7 001013   000117 470400 1                  LDP0    OU_KEY$
         7 001014   000100 100400                    MLR     fill='000'O
         7 001015   000412 000006 2                  ADSC9   PLOVER_BIRTH_KEY         cn=0,n=6
         7 001016   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6

      408    11044    2         B$PLOVERBIRTHKEY.UTS    = HEAD_RECORD.UTS;

  11044  7 001017   000100 100400                    MLR     fill='000'O
         7 001020   000340 000004 2                  ADSC9   HEAD_RECORD              cn=0,n=4
         7 001021   000000 400004                    ADSC9   0,,PR0                   cn=2,n=4

      409    11045    2         CALL READ_OU( VECTOR(B$PLOVERBIRTHKEY), VECTOR(TXT) ) ALTRET(NONE);

  11045  7 001022   000032 235000 8                  LDA     26
         7 001023   000117 236000 1                  LDQ     OU_KEY$
         7 001024   200124 757100                    STAQ    @ARS+27,,AUTO
         7 001025   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 001026   000054 235000 8                  LDA     44
         7 001027   200070 757100                    STAQ    VAL+1,,AUTO
         7 001030   200124 631500                    EPPR1   @ARS+27,,AUTO
         7 001031   200067 451500                    STP1    I+1,,AUTO
         7 001032   001202 701000 7                  TSX1    READ_OU
         7 001033   001046 702000 7                  TSX2    NONE

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:84   
      410    11046    2         PLOVER_BIRTH_SIZE = M$OF$->F$DCB.ARS#;

  11046  7 001034   200004 470500                    LDP0    M$OF$,,AUTO
         7 001035   000000 235100                    LDA     0,,PR0
         7 001036   200013 755100                    STA     PLOVER_BIRTH_SIZE,,AUTO

      411    11047    3         IF PLOVER_BIRTH_SIZE ~= PLOVER_BIRTH_ARS# THEN DO;

  11047  7 001037   200013 236100                    LDQ     PLOVER_BIRTH_SIZE,,AUTO
         7 001040   000541 116000 2                  CMPQ    PLOVER_BIRTH_ARS#
         7 001041   001045 600000 7                  TZE     s:11051

      412    11048    3            B$PLOVERBIRTH.IPATCH = 0;

  11048  7 001042   000116 471400 1                  LDP1    TXT$
         7 001043   100013 450100                    STZ     11,,PR1

      413    11049    3            B$PLOVERBIRTH.DPATCH = 0;

  11049  7 001044   100014 450100                    STZ     12,,PR1

      414    11050    3            END;

      415    11051    3         DO WHILE( '0'B );

  11051  7 001045   001066 710000 7                  TRA     s:11057

      416    11052    3   NONE:     B$PLOVERBIRTH               = '0'B;

  11052  7 001046   000116 470400 1     NONE         LDP0    TXT$
         7 001047   000100 100400                    MLR     fill='000'O
         7 001050   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         7 001051   000000 000064                    ADSC9   0,,PR0                   cn=0,n=52

      417    11053    3             B$PLOVERBIRTH.OU_NAME.COUNT = OUT$SYM.COUNT;

  11053  7 001052   200006 471500                    LDP1    BLK$,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:85   
         7 001053   100004 236100                    LDQ     4,,PR1
         7 001054   000000 552140                    STBQ    0,'40'O,PR0

      418    11054    3             B$PLOVERBIRTH.OU_NAME.TEXT  = OUT$SYM.TEXT;

  11054  7 001055   200006 471500                    LDP1    BLK$,,AUTO
         7 001056   100004 236100                    LDQ     4,,PR1
         7 001057   000033 772000                    QRL     27
         7 001060   000000 620006                    EAX0    0,QL
         7 001061   040100 100540                    MLR     fill='040'O
         7 001062   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         7 001063   000000 200037                    ADSC9   0,,PR0                   cn=1,n=31

      419    11055    3             B$PLOVERBIRTH.CREATE_UTS    = HEAD_RECORD.UTS;

  11055  7 001064   000340 235000 2                  LDA     HEAD_RECORD
         7 001065   000010 755100                    STA     8,,PR0

      420    11056    3             END;

      421    11057    3         IF CMD = PLOVER_VAL THEN DO;

  11057  7 001066   000436 235000 2                  LDA     CMD
         7 001067   000011 115007                    CMPA    9,DL
         7 001070   001107 601000 7                  TNZ     s:11064

      422    11058    3             COMP_UTS         = HEAD_RECORD.UTS;

  11058  7 001071   000340 236000 2                  LDQ     HEAD_RECORD
         7 001072   000433 756000 2                  STQ     COMP_UTS

      423    11059    3             NUM_SECTS        = -1;

  11059  7 001073   000001 335007                    LCA     1,DL
         7 001074   000540 755000 2                  STA     NUM_SECTS

      424    11060    3             PLOVER_BIRTH_KEY = B$PLOVERBIRTHKEY;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:86   

  11060  7 001075   000117 470400 1                  LDP0    OU_KEY$
         7 001076   000000 100500                    MLR     fill='000'O
         7 001077   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         7 001100   000412 000006 2                  ADSC9   PLOVER_BIRTH_KEY         cn=0,n=6

      425    11061    3             PLOVER_BIRTH     = B$PLOVERBIRTH;

  11061  7 001101   000116 471400 1                  LDP1    TXT$
         7 001102   000000 100500                    MLR     fill='000'O
         7 001103   100000 000064                    ADSC9   0,,PR1                   cn=0,n=52
         7 001104   000375 000064 2                  ADSC9   PLOVER_BIRTH             cn=0,n=52

      426    11062    3             OU_ASSOCIATED    = '1'B;

  11062  7 001105   400000 236003                    LDQ     -131072,DU
         7 001106   000430 756000 2                  STQ     OU_ASSOCIATED

      427    11063    3             END;

      428    11064    2         RETURN;

  11064  7 001107   200064 221300                    LDX1  ! @KEY_+1,,AUTO
         7 001110   000001 702211                    TSX2  ! 1,X1

      429    11065
      430    11066    2   NO_HEAD:
      431    11067    3         IF B$TCB.ALT$->B$ALT.ERR.ERR# = %E$NOKEY THEN DO;

  11067  7 001111   000000 470400 xsym  NO_HEAD      LDP0    B$TCB$
         7 001112   000000 471500                    LDP1    0,,PR0
         7 001113   100102 236100                    LDQ     66,,PR1
         7 001114   377770 376007                    ANQ     131064,DL
         7 001115   001020 116007                    CMPQ    528,DL
         7 001116   001162 601000 7                  TNZ     s:11085

      432    11068        /*E*  ERROR:  DPM-E$OU_NOT_FOUND-C
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:87   
      433    11069              MESSAGE: Object unit "%U1" not found.
      434    11070        */
      435    11071    3             FIELD1.COUNT = OUT$SYM.COUNT;

  11071  7 001117   200006 473500                    LDP3    BLK$,,AUTO
         7 001120   300004 236100                    LDQ     4,,PR3
         7 001121   200024 552140                    STBQ    FIELD1,'40'O,AUTO

      436    11072    3             FIELD1.TEXT  = OUT$SYM.TEXT;

  11072  7 001122   300004 236100                    LDQ     4,,PR3
         7 001123   000033 772000                    QRL     27
         7 001124   000000 620006                    EAX0    0,QL
         7 001125   040100 100540                    MLR     fill='040'O
         7 001126   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         7 001127   200024 200037                    ADSC9   FIELD1,,AUTO             cn=1,n=31

      437    11073                  %SCREAM( ERR#=E$OU_NOT_FOUND, F1=FIELD1 );

  11080  7 001130   000000 236007 xsym               LDQ     M$DO,DL
         7 001131   000030 235000 8                  LDA     24
         7 001132   200072 452500                    STP2    @ARS+1,,AUTO
         7 001133   200073 756100                    STQ     @ARS+2,,AUTO
         7 001134   200072 236100                    LDQ     @ARS+1,,AUTO
         7 001135   000024 036003                    ADLQ    20,DU
         7 001136   200076 757100                    STAQ    @ARS+5,,AUTO
         7 001137   200073 235100                    LDA     @ARS+2,,AUTO
         7 001140   200074 755100                    STA     @ARS+3,,AUTO
         7 001141   200076 237100                    LDAQ    @ARS+5,,AUTO
         7 001142   200100 757100                    STAQ    @ARS+7,,AUTO
         7 001143   000021 236000 8                  LDQ     17
         7 001144   200110 756100                    STQ     @ARS+15,,AUTO
         7 001145   000022 237000 8                  LDAQ    18
         7 001146   200106 757100                    STAQ    @ARS+13,,AUTO
         7 001147   200100 631500                    EPPR1   @ARS+7,,AUTO
         7 001150   200105 451500                    STP1    @ARS+12,,AUTO
         7 001151   200074 634500                    EPPR4   @ARS+3,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:88   
         7 001152   200104 454500                    STP4    @ARS+11,,AUTO
         7 001153   000056 237000 8                  LDAQ    46
         7 001154   200102 757100                    STAQ    @ARS+9,,AUTO
         7 001155   200102 630500                    EPPR0   @ARS+9,,AUTO
         7 001156   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 001157   000000 701000 xent               TSX1    XUR$ERRMSG
         7 001160   000000 011000                    NOP     0

      438    11083    3             END;

  11083  7 001161   001174 710000 7                  TRA     s:11086

      439    11084    2         ELSE
      440    11085    2             CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF) );

  11085  7 001162   000000 236007 xsym               LDQ     M$OF,DL
         7 001163   200072 756100                    STQ     @ARS+1,,AUTO
         7 001164   200072 633500                    EPPR3   @ARS+1,,AUTO
         7 001165   200075 453500                    STP3    @ARS+4,,AUTO
         7 001166   100102 634500                    EPPR4   66,,PR1
         7 001167   200074 454500                    STP4    @ARS+3,,AUTO
         7 001170   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 001171   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 001172   000000 701000 xent               TSX1    XUR$ERRMSG
         7 001173   000000 011000                    NOP     0

      441    11086    2         IF CMD = PLOVER_VAL THEN OU_ASSOCIATED = '0'B;

  11086  7 001174   000436 235000 2                  LDA     CMD
         7 001175   000011 115007                    CMPA    9,DL
         7 001176   001200 601000 7                  TNZ     s:11087

  11086  7 001177   000430 450000 2                  STZ     OU_ASSOCIATED

      442    11087    2         ALTRETURN;

  11087  7 001200   200064 221300                    LDX1  ! @KEY_+1,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:89   
         7 001201   000000 702211                    TSX2  ! 0,X1

      443    11088
      444    11089    2   END FIND_OU;
      445    11090        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:90   
      446    11091    1   READ_OU: PROC( KEY_, BUF_, ARS ) ALTRET;

  11091  7 001202   200066 741300       READ_OU      STX1  ! @BUF_SIZE,,AUTO

      447    11092
      448    11093    2   DCL KEY_ BIT(72) ALIGNED;
      449    11094    2   DCL BUF_ BIT(72) ALIGNED;
      450    11095    2   DCL ARS  UBIN WORD;
      451    11096
      452    11097        %FPT_READ( DCB=M$OF, KEYS=YES );
      453    11136
      454    11137    2         FPT_READ.KEY_ = KEY_;

  11137  7 001203   200067 470500                    LDP0    @KEY_,,AUTO
         7 001204   000000 100500                    MLR     fill='000'O
         7 001205   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         7 001206   001032 000010 2                  ADSC9   FPT_READ+2               cn=0,n=8

      455    11138    2         FPT_READ.BUF_ = BUF_;

  11138  7 001207   200070 471500                    LDP1    @BUF_,,AUTO
         7 001210   000000 100500                    MLR     fill='000'O
         7 001211   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         7 001212   001034 000010 2                  ADSC9   FPT_READ+4               cn=0,n=8

      456    11139    2         CALL M$READ( FPT_READ ) ALTRET( ALT );

  11139  7 001213   001030 630400 2                  EPPR0   FPT_READ
         7 001214   440000 713400                    CLIMB   alt,read
         7 001215   401400 401760                    pmme    nvectors=4
         7 001216   001230 702000 7                  TSX2    ALT

      457    11140    2         IF ADDR(ARS) ~= ADDR(NIL) THEN ARS = M$OF$->F$DCB.ARS#;

  11140  7 001217   200071 236100                    LDQ     @ARS,,AUTO
         7 001220   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 001221   001226 600000 7                  TZE     s:11141
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:91   

  11140  7 001222   200004 470500                    LDP0    M$OF$,,AUTO
         7 001223   000000 235100                    LDA     0,,PR0
         7 001224   200071 471500                    LDP1    @ARS,,AUTO
         7 001225   100000 755100                    STA     0,,PR1

      458    11141    2         RETURN;

  11141  7 001226   200066 221300                    LDX1  ! @BUF_SIZE,,AUTO
         7 001227   000001 702211                    TSX2  ! 1,X1

      459    11142
      460    11143    2   ALT:  ALTRETURN;

  11143  7 001230   200066 221300       ALT          LDX1  ! @BUF_SIZE,,AUTO
         7 001231   000000 702211                    TSX2  ! 0,X1

      461    11144
      462    11145    2   END READ_OU;
      463    11146        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:92   
      464    11147    1   READ_OU_SEQ: PROC( KEY_, BUF_, ARS ) ALTRET;

  11147  7 001232   200062 741300       READ_OU_SEQ  STX1  ! COUNT+1,,AUTO

      465    11148
      466    11149
      467    11150    2   DCL KEY_ BIT(72) ALIGNED;
      468    11151    2   DCL BUF_ BIT(72) ALIGNED;
      469    11152    2   DCL ARS  UBIN WORD;
      470    11153
      471    11154        %FPT_READ( DCB=M$OF, KEYR=YES, KEYS=NO );
      472    11193
      473    11194    2         FPT_READ.KEY_ = KEY_;

  11194  7 001233   200063 470500                    LDP0    @KEY_,,AUTO
         7 001234   000000 100500                    MLR     fill='000'O
         7 001235   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         7 001236   001050 000010 2                  ADSC9   FPT_READ+2               cn=0,n=8

      474    11195    2         FPT_READ.BUF_ = BUF_;

  11195  7 001237   200064 471500                    LDP1    @BUF_,,AUTO
         7 001240   000000 100500                    MLR     fill='000'O
         7 001241   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         7 001242   001052 000010 2                  ADSC9   FPT_READ+4               cn=0,n=8

      475    11196    2         CALL M$READ( FPT_READ ) ALTRET( ALT );

  11196  7 001243   001046 630400 2                  EPPR0   FPT_READ
         7 001244   440000 713400                    CLIMB   alt,read
         7 001245   401400 401760                    pmme    nvectors=4
         7 001246   001255 702000 7                  TSX2    ALT

      476    11197    2         ARS = M$OF$ -> F$DCB.ARS#;

  11197  7 001247   200004 470500                    LDP0    M$OF$,,AUTO
         7 001250   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:93   
         7 001251   200065 471500                    LDP1    @ARS,,AUTO
         7 001252   100000 755100                    STA     0,,PR1

      477    11198    2         RETURN;

  11198  7 001253   200062 221300                    LDX1  ! COUNT+1,,AUTO
         7 001254   000001 702211                    TSX2  ! 1,X1

      478    11199
      479    11200    2   ALT:  ALTRETURN;

  11200  7 001255   200062 221300       ALT          LDX1  ! COUNT+1,,AUTO
         7 001256   000000 702211                    TSX2  ! 0,X1

      480    11201
      481    11202    2   END READ_OU_SEQ;
      482    11203        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:94   
      483    11204    1   WRITE_OU: PROC( KEY_, BUF_ ) ALTRET;

  11204  7 001257   200060 741300       WRITE_OU     STX1  ! TEMP+1,,AUTO

      484    11205
      485    11206
      486    11207    2   DCL KEY_ BIT(72) ALIGNED;
      487    11208    2   DCL BUF_ BIT(72) ALIGNED;
      488    11209
      489    11210        %FPT_WRITE( DCB=M$OF );
      490    11241
      491    11242
      492    11243    2         FPT_WRITE.KEY_ = KEY_;

  11243  7 001260   200061 470500                    LDP0    @KEY_,,AUTO
         7 001261   000000 100500                    MLR     fill='000'O
         7 001262   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         7 001263   001066 000010 2                  ADSC9   FPT_WRITE+2              cn=0,n=8

      493    11244    2         FPT_WRITE.BUF_ = BUF_;

  11244  7 001264   200062 471500                    LDP1    @BUF_,,AUTO
         7 001265   000000 100500                    MLR     fill='000'O
         7 001266   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         7 001267   001070 000010 2                  ADSC9   FPT_WRITE+4              cn=0,n=8

      494    11245    2         CALL M$WRITE( FPT_WRITE ) ALTRET( ALT );

  11245  7 001270   001064 630400 2                  EPPR0   FPT_WRITE
         7 001271   440001 713400                    CLIMB   alt,write
         7 001272   401400 401760                    pmme    nvectors=4
         7 001273   001276 702000 7                  TSX2    ALT

      495    11246    2         RETURN;

  11246  7 001274   200060 221300                    LDX1  ! TEMP+1,,AUTO
         7 001275   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:95   

      496    11247
      497    11248    2   ALT:  ALTRETURN;

  11248  7 001276   200060 221300       ALT          LDX1  ! TEMP+1,,AUTO
         7 001277   000000 702211                    TSX2  ! 0,X1

      498    11249
      499    11250    2   END WRITE_OU;
      500    11251        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:96   
      501    11252    1   CHECK_UTS: PROC( PTR$ )   ALTRET;

  11252  7 001300   200064 741300       CHECK_UTS    STX1  ! @BUF_,,AUTO

      502    11253
      503    11254
      504    11255    2   DCL PTR$ PTR;
      505    11256    2   DCL I UBIN WORD;
      506    11257    2   DCL VAL UBIN WORD;
      507    11258    2   DCL MAX(0:6) UBIN WORD CONSTANT INIT(12,31,99,23,59,59,99);
      508    11259    2   DCL SEP(0:6) CHAR(1) CONSTANT INIT('/','/',' ',':',':','.',' ');
      509    11260
      510    11261    2         OUT$ = PTR$;

  11261  7 001301   200065 470500                    LDP0    @PTR$,,AUTO
         7 001302   000000 236100                    LDQ     0,,PR0
         7 001303   200003 756100                    STQ     OUT$,,AUTO

      511    11262    3         DO I = 0 TO 6;

  11262  7 001304   200066 450100                    STZ     I,,AUTO

      512    11263    3             BLK$ = P$NODE.SUBLK$(I);

  11263  7 001305   200003 470500                    LDP0    OUT$,,AUTO
         7 001306   200066 720100                    LXL0    I,,AUTO
         7 001307   000003 236110                    LDQ     3,X0,PR0
         7 001310   200006 756100                    STQ     BLK$,,AUTO

      513    11264    3             CALL CHARBIN( VAL, OUT$SYM.TEXT );

  11264  7 001311   200006 471500                    LDP1    BLK$,,AUTO
         7 001312   100004 236100                    LDQ     4,,PR1
         7 001313   000033 772000                    QRL     27
         7 001314   000000 621006                    EAX1    0,QL
         7 001315   000100 305540                    DTB
         7 001316   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:97   
         7 001317   200072 000010                    NDSC9   @ARS+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         7 001320   200073 235100                    LDA     @ARS+2,,AUTO
         7 001321   200067 755100                    STA     VAL,,AUTO

      514    11265    4             IF VAL > MAX(I) THEN DO;

  11265  7 001322   000120 236010 1                  LDQ     MAX,X0
         7 001323   200067 116100                    CMPQ    VAL,,AUTO
         7 001324   001366 603000 7                  TRC     s:11282

      515    11266        /*E*  ERROR:  DPM-E$UTS_FIELD_TOO_BIG-C
      516    11267              MESSAGE: "%U1" field of UTS is too big
      517    11268        */
      518    11269    4                 FIELD1.COUNT = OUT$SYM.COUNT;

  11269  7 001325   100004 236100                    LDQ     4,,PR1
         7 001326   200024 552140                    STBQ    FIELD1,'40'O,AUTO

      519    11270    4                 FIELD1.TEXT  = OUT$SYM.TEXT;

  11270  7 001327   100004 236100                    LDQ     4,,PR1
         7 001330   000033 772000                    QRL     27
         7 001331   000000 621006                    EAX1    0,QL
         7 001332   040100 100540                    MLR     fill='040'O
         7 001333   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         7 001334   200024 200037                    ADSC9   FIELD1,,AUTO             cn=1,n=31

      520    11271                      %SCREAM( ERR#=E$UTS_FIELD_TOO_BIG, F1=FIELD1 );

  11278  7 001335   000000 236007 xsym               LDQ     M$DO,DL
         7 001336   000030 235000 8                  LDA     24
         7 001337   200072 452500                    STP2    @ARS+1,,AUTO
         7 001340   200073 756100                    STQ     @ARS+2,,AUTO
         7 001341   200072 236100                    LDQ     @ARS+1,,AUTO
         7 001342   000024 036003                    ADLQ    20,DU
         7 001343   200076 757100                    STAQ    @ARS+5,,AUTO
         7 001344   200073 235100                    LDA     @ARS+2,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:98   
         7 001345   200074 755100                    STA     @ARS+3,,AUTO
         7 001346   200076 237100                    LDAQ    @ARS+5,,AUTO
         7 001347   200100 757100                    STAQ    @ARS+7,,AUTO
         7 001350   000021 236000 8                  LDQ     17
         7 001351   200110 756100                    STQ     @ARS+15,,AUTO
         7 001352   000022 237000 8                  LDAQ    18
         7 001353   200106 757100                    STAQ    @ARS+13,,AUTO
         7 001354   200100 633500                    EPPR3   @ARS+7,,AUTO
         7 001355   200105 453500                    STP3    @ARS+12,,AUTO
         7 001356   200074 634500                    EPPR4   @ARS+3,,AUTO
         7 001357   200104 454500                    STP4    @ARS+11,,AUTO
         7 001360   000060 237000 8                  LDAQ    48
         7 001361   200102 757100                    STAQ    @ARS+9,,AUTO
         7 001362   200102 630500                    EPPR0   @ARS+9,,AUTO
         7 001363   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 001364   000000 701000 xent               TSX1    XUR$ERRMSG
         7 001365   000000 011000                    NOP     0

      521    11281    4                 END;

      522    11282    3             IF OUT$SYM.COUNT = 1 THEN

  11282  7 001366   200006 470500                    LDP0    BLK$,,AUTO
         7 001367   000004 236100                    LDQ     4,,PR0
         7 001370   777000 376003                    ANQ     -512,DU
         7 001371   001000 116003                    CMPQ    512,DU
         7 001372   001427 601000 7                  TNZ     s:11285

      523    11283    3                 CALL INSERT( DATE_TIME, I*3, 3, '0', OUT$SYM.TEXT, SEP(I) );

  11283  7 001373   000004 236100                    LDQ     4,,PR0
         7 001374   000033 772000                    QRL     27
         7 001375   000000 620006                    EAX0    0,QL
         7 001376   200066 236100                    LDQ     I,,AUTO
         7 001377   000003 402007                    MPY     3,DL
         7 001400   040006 100400                    MLR     fill='040'O
         7 001401   000062 000001 8                  ADSC9   50                       cn=0,n=1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:99   
         7 001402   000421 000001 2                  ADSC9   DATE_TIME,Q              cn=0,n=1
         7 001403   040006 100540                    MLR     fill='040'O
         7 001404   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         7 001405   000421 200002 2                  ADSC9   DATE_TIME,Q              cn=1,n=2
         7 001406   000000 636010                    EAQ     0,X0
         7 001407   000022 772000                    QRL     18
         7 001410   000002 116007                    CMPQ    2,DL
         7 001411   001426 603000 7                  TRC     s:11283+27
         7 001412   000000 635010                    EAA     0,X0
         7 001413   000022 771000                    ARL     18
         7 001414   200072 755100                    STA     @ARS+1,,AUTO
         7 001415   200066 236100                    LDQ     I,,AUTO
         7 001416   000003 402007                    MPY     3,DL
         7 001417   200072 036100                    ADLQ    @ARS+1,,AUTO
         7 001420   777775 620010                    EAX0    -3,X0
         7 001421   777777 660003                    ERX0    -1,DU
         7 001422   200066 235100                    LDA     I,,AUTO
         7 001423   040046 100405                    MLR     fill='040'O
         7 001424   000127 000001 1                  ADSC9   SEP,A                    cn=0,n=1
         7 001425   000421 200010 2                  ADSC9   DATE_TIME,Q              cn=1,n=*X0
         7 001426   001457 710000 7                  TRA     s:11286

      524    11284    3             ELSE
      525    11285    3                 CALL INSERT( DATE_TIME, I*3, 3, OUT$SYM.TEXT, SEP(I) );

  11285  7 001427   000004 236100                    LDQ     4,,PR0
         7 001430   000033 772000                    QRL     27
         7 001431   000000 620006                    EAX0    0,QL
         7 001432   200066 236100                    LDQ     I,,AUTO
         7 001433   000003 402007                    MPY     3,DL
         7 001434   040006 100540                    MLR     fill='040'O
         7 001435   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         7 001436   000421 000003 2                  ADSC9   DATE_TIME,Q              cn=0,n=3
         7 001437   000000 636010                    EAQ     0,X0
         7 001440   000022 772000                    QRL     18
         7 001441   000003 116007                    CMPQ    3,DL
         7 001442   001457 603000 7                  TRC     s:11286
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:100  
         7 001443   000000 635010                    EAA     0,X0
         7 001444   000022 771000                    ARL     18
         7 001445   200072 755100                    STA     @ARS+1,,AUTO
         7 001446   200066 236100                    LDQ     I,,AUTO
         7 001447   000003 402007                    MPY     3,DL
         7 001450   200072 036100                    ADLQ    @ARS+1,,AUTO
         7 001451   777774 620010                    EAX0    -4,X0
         7 001452   777777 660003                    ERX0    -1,DU
         7 001453   200066 235100                    LDA     I,,AUTO
         7 001454   040046 100405                    MLR     fill='040'O
         7 001455   000127 000001 1                  ADSC9   SEP,A                    cn=0,n=1
         7 001456   000421 000010 2                  ADSC9   DATE_TIME,Q              cn=0,n=*X0

      526    11286    3             END;

  11286  7 001457   200066 235100                    LDA     I,,AUTO
         7 001460   000001 035007                    ADLA    1,DL
         7 001461   200066 755100                    STA     I,,AUTO
         7 001462   000007 115007                    CMPA    7,DL
         7 001463   001305 602000 7                  TNC     s:11263

      527    11287    2         DATE = SUBSTR(DATE_TIME,0,8);

  11287  7 001464   040000 100400                    MLR     fill='040'O
         7 001465   000421 000010 2                  ADSC9   DATE_TIME                cn=0,n=8
         7 001466   000414 000010 2                  ADSC9   DATE                     cn=0,n=8

      528    11288    2         TIME = SUBSTR(DATE_TIME,9,11);

  11288  7 001467   040000 100400                    MLR     fill='040'O
         7 001470   000423 200013 2                  ADSC9   DATE_TIME+2              cn=1,n=11
         7 001471   000416 000013 2                  ADSC9   TIME                     cn=0,n=11

      529    11289    2         CALL M$TIME( TIME_UTS ) ALTRET( BAD_TIME );

  11289  7 001472   000022 630400 1                  EPPR0   TIME_UTS
         7 001473   420004 713400                    CLIMB   alt,+8196
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:101  
         7 001474   402000 401760                    pmme    nvectors=5
         7 001475   001505 702000 7                  TSX2    BAD_TIME

      530    11290    3         IF CMD = PLOVER_VAL  AND  UTS ~= COMP_UTS THEN DO;

  11290  7 001476   000436 235000 2                  LDA     CMD
         7 001477   000011 115007                    CMPA    9,DL
         7 001500   001545 601000 7                  TNZ     s:11314
         7 001501   000435 236000 2                  LDQ     UTS
         7 001502   000433 116000 2                  CMPQ    COMP_UTS
         7 001503   001545 600000 7                  TZE     s:11314

      531    11291    4             IF '0'B THEN DO;

  11291  7 001504   001522 710000 7                  TRA     s:11306

      532    11292    4   BAD_TIME:     CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR );

  11292  7 001505   000000 470400 xsym  BAD_TIME     LDP0    B$TCB$
         7 001506   000000 471500                    LDP1    0,,PR0
         7 001507   100102 633500                    EPPR3   66,,PR1
         7 001510   200072 453500                    STP3    @ARS+1,,AUTO
         7 001511   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 001512   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 001513   000000 701000 xent               TSX1    XUR$ERRMSG
         7 001514   000000 011000                    NOP     0

      533    11293    4                 IF CMD ~= PLOVER_VAL THEN ALTRETURN;

  11293  7 001515   000436 235000 2                  LDA     CMD
         7 001516   000011 115007                    CMPA    9,DL
         7 001517   001542 600000 7                  TZE     s:11310

  11293  7 001520   200064 221300                    LDX1  ! @BUF_,,AUTO
         7 001521   000000 702211                    TSX2  ! 0,X1

      534    11294    4                 END;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:102  
      535    11295    4             ELSE DO;

      536    11296        /*E*  ERROR:  DPM-E$UTS_VIOLATION-C
      537    11297              MESSAGE: UTS violation.
      538    11298        */
      539    11299                      %SCREAM( ERR#=E$UTS_VIOLATION );

  11306  7 001522   000000 236007 xsym               LDQ     M$DO,DL
         7 001523   200072 756100                    STQ     @ARS+1,,AUTO
         7 001524   000020 237000 8                  LDAQ    16
         7 001525   200100 757100                    STAQ    @ARS+7,,AUTO
         7 001526   000022 237000 8                  LDAQ    18
         7 001527   200076 757100                    STAQ    @ARS+5,,AUTO
         7 001530   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 001531   200075 450500                    STP0    @ARS+4,,AUTO
         7 001532   000021 236000 8                  LDQ     17
         7 001533   200074 756100                    STQ     @ARS+3,,AUTO
         7 001534   000063 236000 8                  LDQ     51
         7 001535   200073 756100                    STQ     @ARS+2,,AUTO
         7 001536   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 001537   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 001540   000000 701000 xent               TSX1    XUR$ERRMSG
         7 001541   000000 011000                    NOP     0

      540    11309    4                 END;

      541    11310    3             OU_ASSOCIATED  = '0'B;

  11310  7 001542   000430 450000 2                  STZ     OU_ASSOCIATED

      542    11311    3             ALTRETURN;

  11311  7 001543   200064 221300                    LDX1  ! @BUF_,,AUTO
         7 001544   000000 702211                    TSX2  ! 0,X1

      543    11312    3             END;
      544    11313
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:103  
      545    11314    2   END CHECK_UTS;

  11314  7 001545   200064 221300                    LDX1  ! @BUF_,,AUTO
         7 001546   000001 702211                    TSX2  ! 1,X1

      546    11315        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:104  
      547    11316    1   PLOVER_COMMAND:   PROC   ALTRET;

  11316  7 001547   200054 741300       PLOVER_COMM* STX1  ! FIELD3+8,,AUTO

      548    11317
      549    11318    2   DCL I SBIN WORD;
      550    11319    2   DCL J SBIN WORD;
      551    11320    2   DCL OU_SPECIFIED BIT(1);
      552    11321    2   DCL OUF_SPECIFIED BIT(1);
      553    11322    2   DCL UTS_BLK$ PTR;
      554    11323    2   DCL READ_BLK$ PTR;
      555    11324
      556    11325    2         I = P$NODE.NSUBLKS - 1;

  11325  7 001550   200003 470500                    LDP0    OUT$,,AUTO
         7 001551   000001 236100                    LDQ     1,,PR0
         7 001552   000022 772000                    QRL     18
         7 001553   000001 136007                    SBLQ    1,DL
         7 001554   200055 756100                    STQ     I,,AUTO

      557    11326    2         READ_BLK$ = ADDR(NIL);

  11326  7 001555   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 001556   200062 756100                    STQ     READ_BLK$,,AUTO

      558    11327    3         IF I > 0 THEN DO;

  11327  7 001557   200055 235100                    LDA     I,,AUTO
         7 001560   001744 604400 7                  TMOZ    s:11393

      559    11328    3             OUF_SPECIFIED = '0'B;

  11328  7 001561   200060 450100                    STZ     OUF_SPECIFIED,,AUTO

      560    11329    3             OU_SPECIFIED  = '0'B;

  11329  7 001562   200057 450100                    STZ     OU_SPECIFIED,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:105  

      561    11330    3             UTS_BLK$  = ADDR(NIL);

  11330  7 001563   200061 756100                    STQ     UTS_BLK$,,AUTO

      562    11331    4             DO J = 1 TO I;

  11331  7 001564   000001 235007                    LDA     1,DL
         7 001565   200056 755100                    STA     J,,AUTO
         7 001566   001664 710000 7                  TRA     s:11363+1

      563    11332    4                 BLK$ = P_PCB.OUT$ -> P$NODE.SUBLK$(J);

  11332  7 001567   000277 470400 2                  LDP0    P_PCB+3
         7 001570   200056 720100                    LXL0    J,,AUTO
         7 001571   000003 236110                    LDQ     3,X0,PR0
         7 001572   200006 756100                    STQ     BLK$,,AUTO

      564    11333    5                 DO CASE( OUT$SYM.CODE );

  11333  7 001573   200006 471500                    LDP1    BLK$,,AUTO
         7 001574   100000 236100                    LDQ     0,,PR1
         7 001575   777777 376007                    ANQ     -1,DL
         7 001576   000310 136007                    SBLQ    200,DL
         7 001577   000004 116007                    CMPQ    4,DL
         7 001600   001602 602006 7                  TNC     s:11333+7,QL
         7 001601   001663 710000 7                  TRA     s:11363
         7 001602   001606 710000 7                  TRA     s:11335
         7 001603   001613 710000 7                  TRA     s:11338
         7 001604   001616 710000 7                  TRA     s:11340
         7 001605   001661 710000 7                  TRA     s:11361

      565    11334    5                   CASE( OU_FILE_VAL );

      566    11335    5                     OUF_SPECIFIED = '1'B;

  11335  7 001606   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:106  
         7 001607   200060 756100                    STQ     OUF_SPECIFIED,,AUTO

      567    11336    5                     CALL OPEN_OF ALTRET( ERR1 );

  11336  7 001610   000557 701000 7                  TSX1    OPEN_OF
         7 001611   001657 702000 7                  TSX2    ERR1
         7 001612   001663 710000 7                  TRA     s:11363

      568    11337    5                   CASE( CMD_FILE_VAL );

      569    11338    5                     READ_BLK$ = BLK$;

  11338  7 001613   200006 236100                    LDQ     BLK$,,AUTO
         7 001614   200062 756100                    STQ     READ_BLK$,,AUTO
         7 001615   001663 710000 7                  TRA     s:11363

      570    11339    5                   CASE( OU_NAME_VAL );

      571    11340    5                     OU_SPECIFIED = '1'B;

  11340  7 001616   400000 236003                    LDQ     -131072,DU
         7 001617   200057 756100                    STQ     OU_SPECIFIED,,AUTO

      572    11341    6                     IF OUF_ASSOCIATED THEN DO;

  11341  7 001620   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 001621   001635 605000 7                  TPL     s:11347

      573    11342    6                         OU_NAME.COUNT = OUT$SYM.COUNT;

  11342  7 001622   100004 236100                    LDQ     4,,PR1
         7 001623   200014 552140                    STBQ    OU_NAME,'40'O,AUTO

      574    11343    6                         OU_NAME.TEXT  = OUT$SYM.TEXT;

  11343  7 001624   100004 236100                    LDQ     4,,PR1
         7 001625   000033 772000                    QRL     27
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:107  
         7 001626   000000 621006                    EAX1    0,QL
         7 001627   040100 100540                    MLR     fill='040'O
         7 001630   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         7 001631   200014 200037                    ADSC9   OU_NAME,,AUTO            cn=1,n=31

      575    11344    6                         CALL FIND_OU  ALTRET( ERR1 );

  11344  7 001632   000767 701000 7                  TSX1    FIND_OU
         7 001633   001657 702000 7                  TSX2    ERR1

      576    11345    6                         END;

  11345  7 001634   001663 710000 7                  TRA     s:11363

      577    11346    5                     ELSE
      578    11347    6                         IF NOT OUF_SPECIFIED THEN DO;

  11347  7 001635   200060 234100                    SZN     OUF_SPECIFIED,,AUTO
         7 001636   001663 604000 7                  TMI     s:11363

      579    11348                                  %SCREAM( ERR#=E$NO_FILE );

  11355  7 001637   000000 236007 xsym               LDQ     M$DO,DL
         7 001640   200072 756100                    STQ     @ARS+1,,AUTO
         7 001641   000020 237000 8                  LDAQ    16
         7 001642   200100 757100                    STAQ    @ARS+7,,AUTO
         7 001643   000022 237000 8                  LDAQ    18
         7 001644   200076 757100                    STAQ    @ARS+5,,AUTO
         7 001645   200072 633500                    EPPR3   @ARS+1,,AUTO
         7 001646   200075 453500                    STP3    @ARS+4,,AUTO
         7 001647   000021 236000 8                  LDQ     17
         7 001650   200074 756100                    STQ     @ARS+3,,AUTO
         7 001651   000064 236000 8                  LDQ     52
         7 001652   200073 756100                    STQ     @ARS+2,,AUTO
         7 001653   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 001654   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 001655   000000 701000 xent               TSX1    XUR$ERRMSG
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:108  
         7 001656   000000 011000                    NOP     0

      580    11358    6   ERR1:                     NUM_ERRORS = NUM_ERRORS + 1;

  11358  7 001657   000432 054000 2     ERR1         AOS     NUM_ERRORS

      581    11359    6                             END;

  11359  7 001660   001663 710000 7                  TRA     s:11363

      582    11360    5                   CASE( UTS_TIME_VAL );

      583    11361    5                     UTS_BLK$ = BLK$;

  11361  7 001661   200006 236100                    LDQ     BLK$,,AUTO
         7 001662   200061 756100                    STQ     UTS_BLK$,,AUTO

      584    11362    4                   END;   /* DO CASE( P$NODE.CODE ): */;

      585    11363    4                 END;     /* DO J = 1 TO I; */

  11363  7 001663   200056 054100                    AOS     J,,AUTO
         7 001664   200056 236100                    LDQ     J,,AUTO
         7 001665   200055 116100                    CMPQ    I,,AUTO
         7 001666   001567 604400 7                  TMOZ    s:11332

      586    11364    3             IF UTS_BLK$ ~= ADDR(NIL) THEN

  11364  7 001667   200061 236100                    LDQ     UTS_BLK$,,AUTO
         7 001670   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 001671   001724 600000 7                  TZE     s:11385

      587    11365    4                 IF OU_SPECIFIED THEN DO;

  11365  7 001672   200057 234100                    SZN     OU_SPECIFIED,,AUTO
         7 001673   001703 605000 7                  TPL     s:11380

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:109  
      588    11366    4                     IF OU_ASSOCIATED THEN CALL CHECK_UTS( UTS_BLK$ ) ALTRET(ERR2);

  11366  7 001674   000430 234000 2                  SZN     OU_ASSOCIATED
         7 001675   001724 605000 7                  TPL     s:11385

  11366  7 001676   200061 630500                    EPPR0   UTS_BLK$,,AUTO
         7 001677   200065 450500                    STP0    @PTR$,,AUTO
         7 001700   001300 701000 7                  TSX1    CHECK_UTS
         7 001701   001723 702000 7                  TSX2    ERR2

      589    11367    4                     END;

  11367  7 001702   001724 710000 7                  TRA     s:11385

      590    11368    4                 ELSE DO;

      591    11369        /*E*  ERROR:  DPM-E$UTS_BUT_NO_OU-C
      592    11370              MESSAGE: UTS specified but no OU named.
      593    11371              MESSAGE1: If you specify UTS, you must also specify OU.
      594    11372        */
      595    11373                          %SCREAM( ERR#=E$UTS_BUT_NO_OU );

  11380  7 001703   000000 236007 xsym               LDQ     M$DO,DL
         7 001704   200072 756100                    STQ     @ARS+1,,AUTO
         7 001705   000020 237000 8                  LDAQ    16
         7 001706   200100 757100                    STAQ    @ARS+7,,AUTO
         7 001707   000022 237000 8                  LDAQ    18
         7 001710   200076 757100                    STAQ    @ARS+5,,AUTO
         7 001711   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 001712   200075 450500                    STP0    @ARS+4,,AUTO
         7 001713   000021 236000 8                  LDQ     17
         7 001714   200074 756100                    STQ     @ARS+3,,AUTO
         7 001715   000065 236000 8                  LDQ     53
         7 001716   200073 756100                    STQ     @ARS+2,,AUTO
         7 001717   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 001720   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 001721   000000 701000 xent               TSX1    XUR$ERRMSG
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:110  
         7 001722   000000 011000                    NOP     0

      596    11383    4   ERR2:             NUM_ERRORS = NUM_ERRORS + 1;

  11383  7 001723   000432 054000 2     ERR2         AOS     NUM_ERRORS

      597    11384    4                     END;

      598    11385    4             IF OU_SPECIFIED  AND  OU_ASSOCIATED THEN DO;

  11385  7 001724   200057 234100                    SZN     OU_SPECIFIED,,AUTO
         7 001725   001744 605000 7                  TPL     s:11393
         7 001726   000430 234000 2                  SZN     OU_ASSOCIATED
         7 001727   001744 605000 7                  TPL     s:11393

      599    11386    4                 CALL M$TIME( GET_PLOVER_UTS );

  11386  7 001730   000006 630400 1                  EPPR0   GET_PLOVER_UTS
         7 001731   020004 713400                    CLIMB   8196
         7 001732   402000 401760                    pmme    nvectors=5

      600    11387    4                 PLOVER_KEY.UTS  = COMP_UTS;

  11387  7 001733   000000 100400                    MLR     fill='000'O
         7 001734   000433 000004 2                  ADSC9   COMP_UTS                 cn=0,n=4
         7 001735   000334 400004 2                  ADSC9   PLOVER_KEY               cn=2,n=4

      601    11388    4                 PLOVER_KEY.PUTS = PLOVER_UTS;

  11388  7 001736   000000 100400                    MLR     fill='000'O
         7 001737   000434 000004 2                  ADSC9   PLOVER_UTS               cn=0,n=4
         7 001740   000335 600004 2                  ADSC9   PLOVER_KEY+1             cn=3,n=4

      602    11389    4                 PLOVER_KEY.SEQ  = 0;

  11389  7 001741   000000 101400                    MRL     fill='000'O
         7 001742   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:111  
         7 001743   000336 600002 2                  ADSC9   PLOVER_KEY+2             cn=3,n=2

      603    11390    4                 END;

      604    11391    3             END;         /* IF I > 0 THEN DO; */

      605    11392
      606    11393    2         IF OUF_ASSOCIATED THEN

  11393  7 001744   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 001745   002035 605000 7                  TPL     s:11425

      607    11394    3             IF OU_ASSOCIATED THEN DO;

  11394  7 001746   000430 234000 2                  SZN     OU_ASSOCIATED
         7 001747   002010 605000 7                  TPL     s:11420

      608    11395        /*E*  ERROR:  DPM-E$PLOVER1-C
      609    11396              MESSAGE:PLOVER %U2 here  (File=%FN  -  Object unit=%U1)
      610    11397        */
      611    11398                      %SCREAM( ERR#=E$PLOVER1, DCB#=M$OF, F1=OU_NAME, F2=B_VERSION );

  11405  7 001750   000000 236007 xsym               LDQ     M$OF,DL
         7 001751   200072 756100                    STQ     @ARS+1,,AUTO
         7 001752   000000 236007 xsym               LDQ     M$DO,DL
         7 001753   000030 235000 8                  LDA     24
         7 001754   200073 452500                    STP2    @ARS+2,,AUTO
         7 001755   200074 756100                    STQ     @ARS+3,,AUTO
         7 001756   200073 236100                    LDQ     @ARS+2,,AUTO
         7 001757   000014 036003                    ADLQ    12,DU
         7 001760   200076 757100                    STAQ    @ARS+5,,AUTO
         7 001761   200072 235100                    LDA     @ARS+1,,AUTO
         7 001762   200075 755100                    STA     @ARS+4,,AUTO
         7 001763   200074 235100                    LDA     @ARS+3,,AUTO
         7 001764   200100 755100                    STA     @ARS+7,,AUTO
         7 001765   200076 237100                    LDAQ    @ARS+5,,AUTO
         7 001766   200102 757100                    STAQ    @ARS+9,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:112  
         7 001767   000021 236000 8                  LDQ     17
         7 001770   200112 756100                    STQ     @ARS+17,,AUTO
         7 001771   000070 237000 8                  LDAQ    56
         7 001772   200110 757100                    STAQ    @ARS+15,,AUTO
         7 001773   200102 630500                    EPPR0   @ARS+9,,AUTO
         7 001774   200107 450500                    STP0    @ARS+14,,AUTO
         7 001775   200100 631500                    EPPR1   @ARS+7,,AUTO
         7 001776   200106 451500                    STP1    @ARS+13,,AUTO
         7 001777   200075 633500                    EPPR3   @ARS+4,,AUTO
         7 002000   200105 453500                    STP3    @ARS+12,,AUTO
         7 002001   000072 236000 8                  LDQ     58
         7 002002   200104 756100                    STQ     @ARS+11,,AUTO
         7 002003   200104 630500                    EPPR0   @ARS+11,,AUTO
         7 002004   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 002005   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002006   000000 011000                    NOP     0

      612    11408    3                 END;

  11408  7 002007   002111 710000 7                  TRA     s:11456

      613    11409    3             ELSE DO;

      614    11410        /*E*  ERROR:  DPM-E$PLOVER2-C
      615    11411              MESSAGE:PLOVER %U2 here  (File=%FN  -  No object unit named)
      616    11412        */
      617    11413                      %SCREAM( ERR#=E$PLOVER2, DCB#=M$OF, F2=B_VERSION );

  11420  7 002010   000000 236007 xsym               LDQ     M$OF,DL
         7 002011   200072 756100                    STQ     @ARS+1,,AUTO
         7 002012   000000 236007 xsym               LDQ     M$DO,DL
         7 002013   200072 235100                    LDA     @ARS+1,,AUTO
         7 002014   200073 755100                    STA     @ARS+2,,AUTO
         7 002015   200074 756100                    STQ     @ARS+3,,AUTO
         7 002016   000020 237000 8                  LDAQ    16
         7 002017   200102 757100                    STAQ    @ARS+9,,AUTO
         7 002020   000074 237000 8                  LDAQ    60
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:113  
         7 002021   200100 757100                    STAQ    @ARS+7,,AUTO
         7 002022   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 002023   200077 450500                    STP0    @ARS+6,,AUTO
         7 002024   200073 631500                    EPPR1   @ARS+2,,AUTO
         7 002025   200076 451500                    STP1    @ARS+5,,AUTO
         7 002026   000076 236000 8                  LDQ     62
         7 002027   200075 756100                    STQ     @ARS+4,,AUTO
         7 002030   200075 630500                    EPPR0   @ARS+4,,AUTO
         7 002031   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 002032   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002033   000000 011000                    NOP     0

      618    11423    3                 END;

  11423  7 002034   002111 710000 7                  TRA     s:11456

      619    11424    2         ELSE
      620    11425    3             IF OU_ASSOCIATED THEN DO;

  11425  7 002035   000430 234000 2                  SZN     OU_ASSOCIATED
         7 002036   002071 605000 7                  TPL     s:11451

      621    11426        /*E*  ERROR:  DPM-E$PLOVER3-C
      622    11427              MESSAGE:PLOVER %U2 here  (No file named  -  Object unit=%U1)
      623    11428        */
      624    11429                      %SCREAM( ERR#=E$PLOVER3, F1=OU_NAME, F2=B_VERSION );

  11436  7 002037   000000 236007 xsym               LDQ     M$DO,DL
         7 002040   000030 235000 8                  LDA     24
         7 002041   200072 452500                    STP2    @ARS+1,,AUTO
         7 002042   200073 756100                    STQ     @ARS+2,,AUTO
         7 002043   200072 236100                    LDQ     @ARS+1,,AUTO
         7 002044   000014 036003                    ADLQ    12,DU
         7 002045   200076 757100                    STAQ    @ARS+5,,AUTO
         7 002046   200073 235100                    LDA     @ARS+2,,AUTO
         7 002047   200074 755100                    STA     @ARS+3,,AUTO
         7 002050   200076 237100                    LDAQ    @ARS+5,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:114  
         7 002051   200100 757100                    STAQ    @ARS+7,,AUTO
         7 002052   000021 236000 8                  LDQ     17
         7 002053   200110 756100                    STQ     @ARS+15,,AUTO
         7 002054   000070 237000 8                  LDAQ    56
         7 002055   200106 757100                    STAQ    @ARS+13,,AUTO
         7 002056   200100 630500                    EPPR0   @ARS+7,,AUTO
         7 002057   200105 450500                    STP0    @ARS+12,,AUTO
         7 002060   200074 631500                    EPPR1   @ARS+3,,AUTO
         7 002061   200104 451500                    STP1    @ARS+11,,AUTO
         7 002062   000100 237000 8                  LDAQ    64
         7 002063   200102 757100                    STAQ    @ARS+9,,AUTO
         7 002064   200102 630500                    EPPR0   @ARS+9,,AUTO
         7 002065   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 002066   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002067   000000 011000                    NOP     0

      625    11439    3                 END;

  11439  7 002070   002111 710000 7                  TRA     s:11456

      626    11440    3             ELSE DO;

      627    11441        /*E*  ERROR:  DPM-E$PLOVER4-C
      628    11442              MESSAGE:PLOVER %U2 here  (No file named  -  No object unit named)
      629    11443        */
      630    11444                      %SCREAM( ERR#=E$PLOVER4, F2=B_VERSION );

  11451  7 002071   000000 236007 xsym               LDQ     M$DO,DL
         7 002072   200072 756100                    STQ     @ARS+1,,AUTO
         7 002073   000020 237000 8                  LDAQ    16
         7 002074   200100 757100                    STAQ    @ARS+7,,AUTO
         7 002075   000074 237000 8                  LDAQ    60
         7 002076   200076 757100                    STAQ    @ARS+5,,AUTO
         7 002077   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 002100   200075 450500                    STP0    @ARS+4,,AUTO
         7 002101   000021 236000 8                  LDQ     17
         7 002102   200074 756100                    STQ     @ARS+3,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:115  
         7 002103   000102 236000 8                  LDQ     66
         7 002104   200073 756100                    STQ     @ARS+2,,AUTO
         7 002105   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 002106   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 002107   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002110   000000 011000                    NOP     0

      631    11454    3                 END;

      632    11455
      633    11456    3         IF READ_BLK$ ~= ADDR(NIL) THEN DO;

  11456  7 002111   200062 236100                    LDQ     READ_BLK$,,AUTO
         7 002112   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 002113   002124 600000 7                  TZE     s:11463

      634    11457    3             CALL READ_COMMAND( READ_BLK$ ) ALTRET( ALT_ERR );

  11457  7 002114   200062 630500                    EPPR0   READ_BLK$,,AUTO
         7 002115   200065 450500                    STP0    @PTR$,,AUTO
         7 002116   004503 701000 7                  TSX1    READ_COMMAND
         7 002117   002121 702000 7                  TSX2    ALT_ERR

      635    11458    4             DO WHILE( '0'B );

  11458  7 002120   002124 710000 7                  TRA     s:11463

      636    11459    4   ALT_ERR:      NUM_ERRORS = NUM_ERRORS + 1;

  11459  7 002121   000432 054000 2     ALT_ERR      AOS     NUM_ERRORS

      637    11460    4                 ALTRETURN;

  11460  7 002122   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002123   000000 702211                    TSX2  ! 0,X1

      638    11461    4                 END;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:116  

      639    11462    3             END;
      640    11463    2   END PLOVER_COMMAND;

  11463  7 002124   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002125   000001 702211                    TSX2  ! 1,X1

      641    11464        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:117  
      642    11465    1   RUM_COMMAND:  PROC ALTRET;

  11465  7 002126   200054 741300       RUM_COMMAND  STX1  ! FIELD3+8,,AUTO

      643    11466
      644    11467    3         IF NOT OUF_ASSOCIATED THEN DO;

  11467  7 002127   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 002130   002153 604000 7                  TMI     s:11484

      645    11468        /*E*  ERROR:  DPM-E$NO_FILE-C
      646    11469              MESSAGE: No file named
      647    11470              MESSAGE1: A command has been issued without a file open for PLOVERing
      648    11471        */
      649    11472                  %SCREAM( ERR#=E$NO_FILE );

  11479  7 002131   000000 236007 xsym               LDQ     M$DO,DL
         7 002132   200072 756100                    STQ     @ARS+1,,AUTO
         7 002133   000020 237000 8                  LDAQ    16
         7 002134   200100 757100                    STAQ    @ARS+7,,AUTO
         7 002135   000022 237000 8                  LDAQ    18
         7 002136   200076 757100                    STAQ    @ARS+5,,AUTO
         7 002137   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 002140   200075 450500                    STP0    @ARS+4,,AUTO
         7 002141   000021 236000 8                  LDQ     17
         7 002142   200074 756100                    STQ     @ARS+3,,AUTO
         7 002143   000064 236000 8                  LDQ     52
         7 002144   200073 756100                    STQ     @ARS+2,,AUTO
         7 002145   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 002146   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 002147   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002150   000000 011000                    NOP     0

      650    11482    3             ALTRETURN;

  11482  7 002151   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002152   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:118  

      651    11483    3             END;
      652    11484    3         IF NOT OU_ASSOCIATED THEN DO;

  11484  7 002153   000430 234000 2                  SZN     OU_ASSOCIATED
         7 002154   002177 604000 7                  TMI     s:11501

      653    11485        /*E*  ERROR:  DPM-E$NO_OBJECT_UNIT-C
      654    11486              MESSAGE: No object unit named.
      655    11487              MESSAGE1: An object unit must be specified for this command.
      656    11488        */
      657    11489                  %SCREAM( ERR#=E$NO_OBJECT_UNIT );

  11496  7 002155   000000 236007 xsym               LDQ     M$DO,DL
         7 002156   200072 756100                    STQ     @ARS+1,,AUTO
         7 002157   000020 237000 8                  LDAQ    16
         7 002160   200100 757100                    STAQ    @ARS+7,,AUTO
         7 002161   000022 237000 8                  LDAQ    18
         7 002162   200076 757100                    STAQ    @ARS+5,,AUTO
         7 002163   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 002164   200075 450500                    STP0    @ARS+4,,AUTO
         7 002165   000021 236000 8                  LDQ     17
         7 002166   200074 756100                    STQ     @ARS+3,,AUTO
         7 002167   000103 236000 8                  LDQ     67
         7 002170   200073 756100                    STQ     @ARS+2,,AUTO
         7 002171   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 002172   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 002173   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002174   000000 011000                    NOP     0

      658    11499    3             ALTRETURN;

  11499  7 002175   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002176   000000 702211                    TSX2  ! 0,X1

      659    11500    3             END;
      660    11501    2         CNT = P_PCB.NCHARS;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:119  

  11501  7 002177   000305 235000 2                  LDA     P_PCB+9
         7 002200   000537 755000 2                  STA     CNT

      661    11502    3         IF CNT > 256 THEN DO;

  11502  7 002201   000400 115007                    CMPA    256,DL
         7 002202   002225 604400 7                  TMOZ    s:11519

      662    11503        /*E*  ERROR:  DPM-E$CMD_TOO_LONG-C
      663    11504              MESSAGE: Command too long
      664    11505              MESSAGE1: A command can be at most 256 characters long.
      665    11506        */
      666    11507                  %SCREAM( ERR#=E$CMD_TOO_LONG );

  11514  7 002203   000000 236007 xsym               LDQ     M$DO,DL
         7 002204   200072 756100                    STQ     @ARS+1,,AUTO
         7 002205   000020 237000 8                  LDAQ    16
         7 002206   200100 757100                    STAQ    @ARS+7,,AUTO
         7 002207   000022 237000 8                  LDAQ    18
         7 002210   200076 757100                    STAQ    @ARS+5,,AUTO
         7 002211   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 002212   200075 450500                    STP0    @ARS+4,,AUTO
         7 002213   000021 236000 8                  LDQ     17
         7 002214   200074 756100                    STQ     @ARS+3,,AUTO
         7 002215   000104 236000 8                  LDQ     68
         7 002216   200073 756100                    STQ     @ARS+2,,AUTO
         7 002217   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 002220   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 002221   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002222   000000 011000                    NOP     0

      667    11517    3             ALTRETURN;

  11517  7 002223   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002224   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:120  
      668    11518    3             END;
      669    11519    2         TXT = P_PCB.TEXT$ -> BASED$TEXT;

  11519  7 002225   000274 470400 2                  LDP0    P_PCB
         7 002226   000000 620005                    EAX0    0,AL
         7 002227   040000 100540                    MLR     fill='040'O
         7 002230   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         7 002231   000437 000400 2                  ADSC9   TXT                      cn=0,n=256

      670    11520    2         CALL WRITE_PLOVER_REC       ALTRET( ALT );

  11520  7 002232   002324 701000 7                  TSX1    WRITE_PLOVER_REC
         7 002233   002322 702000 7                  TSX2    ALT

      671    11521    3         IF P$NODE.CODE = MODIFY_VAL THEN DO;

  11521  7 002234   200003 470500                    LDP0    OUT$,,AUTO
         7 002235   000000 720100                    LXL0    0,,PR0
         7 002236   000001 100003                    CMPX0   1,DU
         7 002237   002274 601000 7                  TNZ     s:11535

      672    11522    4           DO CASE( P$NODE.SUBLK$(0)->P$NODE.CODE);

  11522  7 002240   000003 471500                    LDP1    3,,PR0
         7 002241   100000 236100                    LDQ     0,,PR1
         7 002242   777777 376007                    ANQ     -1,DL
         7 002243   000326 136007                    SBLQ    214,DL
         7 002244   000004 116007                    CMPQ    4,DL
         7 002245   002247 602006 7                  TNC     s:11522+7,QL
         7 002246   002273 710000 7                  TRA     s:11532
         7 002247   002253 710000 7                  TRA     s:11524
         7 002250   002257 710000 7                  TRA     s:11526
         7 002251   002263 710000 7                  TRA     s:11528
         7 002252   002267 710000 7                  TRA     s:11530

      673    11523    4             CASE (IPSYM1_VAL);

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:121  
      674    11524    4               PLOVER_BIRTH.IPATCH = PLOVER_BIRTH.IPATCH + 1;

  11524  7 002253   000410 235000 2                  LDA     PLOVER_BIRTH+11
         7 002254   000001 035007                    ADLA    1,DL
         7 002255   000410 755000 2                  STA     PLOVER_BIRTH+11
         7 002256   002274 710000 7                  TRA     s:11535

      675    11525    4             CASE (IPSYM2_VAL);

      676    11526    4               PLOVER_BIRTH.IPATCH = PLOVER_BIRTH.IPATCH + 2;

  11526  7 002257   000410 235000 2                  LDA     PLOVER_BIRTH+11
         7 002260   000002 035007                    ADLA    2,DL
         7 002261   000410 755000 2                  STA     PLOVER_BIRTH+11
         7 002262   002274 710000 7                  TRA     s:11535

      677    11527    4             CASE (DPSYM1_VAL);

      678    11528    4               PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + 1;

  11528  7 002263   000411 235000 2                  LDA     PLOVER_BIRTH+12
         7 002264   000001 035007                    ADLA    1,DL
         7 002265   000411 755000 2                  STA     PLOVER_BIRTH+12
         7 002266   002274 710000 7                  TRA     s:11535

      679    11529    4             CASE (DPSYM2_VAL);

      680    11530    4               PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + 2;

  11530  7 002267   000411 235000 2                  LDA     PLOVER_BIRTH+12
         7 002270   000002 035007                    ADLA    2,DL
         7 002271   000411 755000 2                  STA     PLOVER_BIRTH+12
         7 002272   002274 710000 7                  TRA     s:11535

      681    11531    4             CASE (ELSE);

      682    11532    4               GOTO RET;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:122  

  11532  7 002273   002302 710000 7                  TRA     RET

      683    11533    4             END;

      684    11534    3           END;
      685    11535    2         CALL WRITE_OU (VECTOR(PLOVER_BIRTH_KEY),VECTOR(PLOVER_BIRTH)) ALTRET (ALTR);

  11535  7 002274   000112 236000 8                  LDQ     74
         7 002275   200062 756100                    STQ     READ_BLK$,,AUTO
         7 002276   000113 236000 8                  LDQ     75
         7 002277   200061 756100                    STQ     UTS_BLK$,,AUTO
         7 002300   001257 701000 7                  TSX1    WRITE_OU
         7 002301   002304 702000 7                  TSX2    ALTR

      686    11536    2   RET:  RETURN;

  11536  7 002302   200054 221300       RET          LDX1  ! FIELD3+8,,AUTO
         7 002303   000001 702211                    TSX2  ! 1,X1

      687    11537    2   ALTR: CALL XUR$ERRMSG(B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF));

  11537  7 002304   000000 470400 xsym  ALTR         LDP0    B$TCB$
         7 002305   000000 471500                    LDP1    0,,PR0
         7 002306   000000 236007 xsym               LDQ     M$OF,DL
         7 002307   200072 756100                    STQ     @ARS+1,,AUTO
         7 002310   200072 633500                    EPPR3   @ARS+1,,AUTO
         7 002311   200075 453500                    STP3    @ARS+4,,AUTO
         7 002312   100102 634500                    EPPR4   66,,PR1
         7 002313   200074 454500                    STP4    @ARS+3,,AUTO
         7 002314   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 002315   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 002316   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002317   000000 011000                    NOP     0

      688    11538    2         ALTRETURN;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:123  
  11538  7 002320   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002321   000000 702211                    TSX2  ! 0,X1

      689    11539
      690    11540    2   ALT:  ALTRETURN;

  11540  7 002322   200054 221300       ALT          LDX1  ! FIELD3+8,,AUTO
         7 002323   000000 702211                    TSX2  ! 0,X1

      691    11541
      692    11542    2   END RUM_COMMAND;
      693    11543        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:124  
      694    11544    1   WRITE_PLOVER_REC:  PROC       ALTRET;

  11544  7 002324   200056 741300       WRITE_PLOVE* STX1  ! J,,AUTO

      695    11545
      696    11546    2         PLOVER_KEY.SEQ = PLOVER_KEY.SEQ + 1;

  11546  7 002325   000336 235000 2                  LDA     PLOVER_KEY+2
         7 002326   000337 236000 2                  LDQ     PLOVER_KEY+3
         7 002327   000033 773000                    LRL     27
         7 002330   777777 376007                    ANQ     -1,DL
         7 002331   000001 036007                    ADLQ    1,DL
         7 002332   200072 756100                    STQ     @ARS+1,,AUTO
         7 002333   000000 101500                    MRL     fill='000'O
         7 002334   200072 000004                    ADSC9   @ARS+1,,AUTO             cn=0,n=4
         7 002335   000336 600002 2                  ADSC9   PLOVER_KEY+2             cn=3,n=2

      697    11547    2         CALL WRITE_OU( VECTOR(PLOVER_KEY), VECTOR(SUBSTR(TXT,0,CNT)) ) ALTRET(
             11547                  WRITE_ERR);

  11547  7 002336   000537 235000 2                  LDA     CNT
         7 002337   000020 735000                    ALS     16
         7 002340   000140 135007                    SBLA    96,DL
         7 002341   000004 236000 8                  LDQ     4
         7 002342   200126 757100                    STAQ    @ARS+29,,AUTO
         7 002343   200126 630500                    EPPR0   @ARS+29,,AUTO
         7 002344   200062 450500                    STP0    READ_BLK$,,AUTO
         7 002345   000116 236000 8                  LDQ     78
         7 002346   200061 756100                    STQ     UTS_BLK$,,AUTO
         7 002347   001257 701000 7                  TSX1    WRITE_OU
         7 002350   002371 702000 7                  TSX2    WRITE_ERR

      698    11548    3         IF PLOVER_BIRTH.PLOVER_UTS ~= PLOVER_UTS THEN DO;

  11548  7 002351   000406 236000 2                  LDQ     PLOVER_BIRTH+9
         7 002352   000434 116000 2                  CMPQ    PLOVER_UTS
         7 002353   002367 600000 7                  TZE     s:11553
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:125  

      699    11549    3             PLOVER_BIRTH.PLOVER_UTS = PLOVER_UTS;

  11549  7 002354   000434 235000 2                  LDA     PLOVER_UTS
         7 002355   000406 755000 2                  STA     PLOVER_BIRTH+9

      700    11550    3             PLOVER_BIRTH.COUNT = PLOVER_BIRTH.COUNT + 1;

  11550  7 002356   000407 236000 2                  LDQ     PLOVER_BIRTH+10
         7 002357   000001 036007                    ADLQ    1,DL
         7 002360   000407 756000 2                  STQ     PLOVER_BIRTH+10

      701    11551    3             CALL WRITE_OU( VECTOR(PLOVER_BIRTH_KEY), VECTOR(PLOVER_BIRTH) ) ALTRET(
             11551                      WRITE_ERR);

  11551  7 002361   000112 236000 8                  LDQ     74
         7 002362   200062 756100                    STQ     READ_BLK$,,AUTO
         7 002363   000113 236000 8                  LDQ     75
         7 002364   200061 756100                    STQ     UTS_BLK$,,AUTO
         7 002365   001257 701000 7                  TSX1    WRITE_OU
         7 002366   002371 702000 7                  TSX2    WRITE_ERR

      702    11552    3             END;

      703    11553    2         RETURN;

  11553  7 002367   200056 221300                    LDX1  ! J,,AUTO
         7 002370   000001 702211                    TSX2  ! 1,X1

      704    11554
      705    11555    2   WRITE_ERR:
      706    11556    2         CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF) );

  11556  7 002371   000000 470400 xsym  WRITE_ERR    LDP0    B$TCB$
         7 002372   000000 471500                    LDP1    0,,PR0
         7 002373   000000 236007 xsym               LDQ     M$OF,DL
         7 002374   200072 756100                    STQ     @ARS+1,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:126  
         7 002375   200072 633500                    EPPR3   @ARS+1,,AUTO
         7 002376   200075 453500                    STP3    @ARS+4,,AUTO
         7 002377   100102 634500                    EPPR4   66,,PR1
         7 002400   200074 454500                    STP4    @ARS+3,,AUTO
         7 002401   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 002402   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 002403   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002404   000000 011000                    NOP     0

      707    11557    2         ALTRETURN;

  11557  7 002405   200056 221300                    LDX1  ! J,,AUTO
         7 002406   000000 702211                    TSX2  ! 0,X1

      708    11558
      709    11559    2   END WRITE_PLOVER_REC;
      710    11560        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:127  
      711    11561    1   LIST_COMMAND: PROC  ALTRET;

  11561  7 002407   200054 741300       LIST_COMMAND STX1  ! FIELD3+8,,AUTO

      712    11562
      713    11563
      714    11564    2   DCL SEQ SBIN WORD;
      715    11565    2   DCL COMP_UTS SBIN WORD;
      716    11566    2   DCL PLOVER_UTS SBIN WORD;
      717    11567    2   DCL LAST_UTS SBIN WORD;
      718    11568    2   DCL COUNT SBIN WORD;
      719    11569
      720    11570    3         IF NOT OUF_ASSOCIATED THEN DO;

  11570  7 002410   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 002411   002434 604000 7                  TMI     s:11587

      721    11571        /*    ERROR:  DPM-E$NO_FILE-C
      722    11572              MESSAGE: No file named
      723    11573              MESSAGE1: A command has been issued without a file open for PLOVERing
      724    11574        */
      725    11575                  %SCREAM( ERR#=E$NO_FILE );

  11582  7 002412   000000 236007 xsym               LDQ     M$DO,DL
         7 002413   200072 756100                    STQ     @ARS+1,,AUTO
         7 002414   000020 237000 8                  LDAQ    16
         7 002415   200100 757100                    STAQ    @ARS+7,,AUTO
         7 002416   000022 237000 8                  LDAQ    18
         7 002417   200076 757100                    STAQ    @ARS+5,,AUTO
         7 002420   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 002421   200075 450500                    STP0    @ARS+4,,AUTO
         7 002422   000021 236000 8                  LDQ     17
         7 002423   200074 756100                    STQ     @ARS+3,,AUTO
         7 002424   000064 236000 8                  LDQ     52
         7 002425   200073 756100                    STQ     @ARS+2,,AUTO
         7 002426   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 002427   000025 631400 xsym               EPPR1   B_VECTNIL+21
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:128  
         7 002430   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002431   000000 011000                    NOP     0

      726    11585    3             ALTRETURN;

  11585  7 002432   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002433   000000 702211                    TSX2  ! 0,X1

      727    11586    3             END;
      728    11587    2         COUNT = 0;

  11587  7 002434   200061 450100                    STZ     COUNT,,AUTO

      729    11588    3         IF P$NODE.NSUBLKS = 0 THEN DO;   /* List all PLOVER records */

  11588  7 002435   200003 470500                    LDP0    OUT$,,AUTO
         7 002436   000001 220100                    LDX0    1,,PR0
         7 002437   002537 601000 7                  TNZ     s:11619

      730    11589    3             B$PLOVERKEY = PLOVER_KEY;

  11589  7 002440   000117 471400 1                  LDP1    OU_KEY$
         7 002441   000100 100400                    MLR     fill='000'O
         7 002442   000334 000015 2                  ADSC9   PLOVER_KEY               cn=0,n=13
         7 002443   100000 000015                    ADSC9   0,,PR1                   cn=0,n=13

      731    11590    3             B$PLOVERKEY.KEYSIZ = 1;

  11590  7 002444   001000 236003                    LDQ     512,DU
         7 002445   100000 552140                    STBQ    0,'40'O,PR1

      732    11591    3             CALL READ_OU( VECTOR(OU_KEY), VECTOR(TXT) );

  11591  7 002446   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 002447   000054 235000 8                  LDA     44
         7 002450   200070 757100                    STAQ    @BUF_,,AUTO
         7 002451   000122 236000 8                  LDQ     82
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:129  
         7 002452   200067 756100                    STQ     VAL,,AUTO
         7 002453   001202 701000 7                  TSX1    READ_OU
         7 002454   000000 011000                    NOP     0

      733    11592    3             CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(DONE);

  11592  7 002455   000054 237000 8                  LDAQ    44
         7 002456   200064 757100                    STAQ    @BUF_,,AUTO
         7 002457   000122 236000 8                  LDQ     82
         7 002460   200063 756100                    STQ     @KEY_,,AUTO
         7 002461   001232 701000 7                  TSX1    READ_OU_SEQ
         7 002462   002514 702000 7                  TSX2    DONE

      734    11593    4             DO WHILE( B$PLOVERKEY.NOTHD = PLOVER_KEY.NOTHD );

  11593  7 002463   000117 470400 1                  LDP0    OU_KEY$
         7 002464   000000 236100                    LDQ     0,,PR0
         7 002465   000334 676000 2                  ERQ     PLOVER_KEY
         7 002466   000777 376003                    ANQ     511,DU
         7 002467   002514 601000 7                  TNZ     DONE

      735    11594    4                 IF OU_KEY.KEYSIZ = PLOVER_BIRTH_KEY.KEYSIZ THEN

  11594  7 002470   000312 236000 2                  LDQ     OU_KEY
         7 002471   000412 676000 2                  ERQ     PLOVER_BIRTH_KEY
         7 002472   777000 376003                    ANQ     -512,DU
         7 002473   002477 601000 7                  TNZ     s:11598

      736    11595                                                  /* Found a PLOVER BIRTH record */
      737    11596    4                     CALL LIST_PLOVER_BIRTH;

  11596  7 002474   002713 701000 7                  TSX1    LIST_PLOVER_BIRTH
         7 002475   000000 011000                    NOP     0
         7 002476   002501 710000 7                  TRA     s:11599

      738    11597    4                 ELSE
      739    11598    4                     CALL LIST_PLOVER;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:130  

  11598  7 002477   003036 701000 7                  TSX1    LIST_PLOVER
         7 002500   000000 011000                    NOP     0

      740    11599    4                 CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(DONE);

  11599  7 002501   000054 237000 8                  LDAQ    44
         7 002502   200064 757100                    STAQ    @BUF_,,AUTO
         7 002503   000122 236000 8                  LDQ     82
         7 002504   200063 756100                    STQ     @KEY_,,AUTO
         7 002505   001232 701000 7                  TSX1    READ_OU_SEQ
         7 002506   002514 702000 7                  TSX2    DONE

      741    11600    4                 END;

  11600  7 002507   000117 470400 1                  LDP0    OU_KEY$
         7 002510   000000 236100                    LDQ     0,,PR0
         7 002511   000334 676000 2                  ERQ     PLOVER_KEY
         7 002512   000777 376003                    ANQ     511,DU
         7 002513   002470 600000 7                  TZE     s:11594

      742    11601    4   DONE:     IF COUNT = 0 THEN DO;

  11601  7 002514   200061 235100       DONE         LDA     COUNT,,AUTO
         7 002515   002711 601000 7                  TNZ     FINISHED

      743    11602        /*E*  ERROR:  DPM-E$NOTHING_TO_LIST-C
      744    11603              MESSAGE: Nothing to list.
      745    11604        */
      746    11605    4   NONE:
      747    11606                      %SCREAM( ERR#=E$NOTHING_TO_LIST );

  11613  7 002516   000000 236007 xsym  NONE         LDQ     M$DO,DL
         7 002517   200072 756100                    STQ     @ARS+1,,AUTO
         7 002520   000020 237000 8                  LDAQ    16
         7 002521   200100 757100                    STAQ    @ARS+7,,AUTO
         7 002522   000022 237000 8                  LDAQ    18
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:131  
         7 002523   200076 757100                    STAQ    @ARS+5,,AUTO
         7 002524   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 002525   200075 450500                    STP0    @ARS+4,,AUTO
         7 002526   000021 236000 8                  LDQ     17
         7 002527   200074 756100                    STQ     @ARS+3,,AUTO
         7 002530   000123 236000 8                  LDQ     83
         7 002531   200073 756100                    STQ     @ARS+2,,AUTO
         7 002532   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 002533   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 002534   000000 701000 xent               TSX1    XUR$ERRMSG
         7 002535   000000 011000                    NOP     0

      748    11616    4                 END;

      749    11617    3             END;

  11617  7 002536   002711 710000 7                  TRA     FINISHED

      750    11618    3         ELSE DO;

      751    11619    3             BLK$ = P$NODE.SUBLK$(0);

  11619  7 002537   000003 236100                    LDQ     3,,PR0
         7 002540   200006 756100                    STQ     BLK$,,AUTO

      752    11620    3             CALL FIND_OU    ALTRET(FINISHED);

  11620  7 002541   000767 701000 7                  TSX1    FIND_OU
         7 002542   002711 702000 7                  TSX2    FINISHED

      753    11621    3             CALL LIST_PLOVER_BIRTH;

  11621  7 002543   002713 701000 7                  TSX1    LIST_PLOVER_BIRTH
         7 002544   000000 011000                    NOP     0

      754    11622    3             IF B$PLOVERBIRTH.COUNT = 0 THEN RETURN;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:132  
  11622  7 002545   000116 470400 1                  LDP0    TXT$
         7 002546   000012 235100                    LDA     10,,PR0
         7 002547   002552 601000 7                  TNZ     s:11623

  11622  7 002550   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002551   000001 702211                    TSX2  ! 1,X1

      755    11623    4             IF P$NODE.NSUBLKS = 1 THEN DO;

  11623  7 002552   200003 471500                    LDP1    OUT$,,AUTO
         7 002553   100001 220100                    LDX0    1,,PR1
         7 002554   000001 100003                    CMPX0   1,DU
         7 002555   002616 601000 7                  TNZ     s:11633

      756    11624    4                CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(FINISHED);

  11624  7 002556   000054 237000 8                  LDAQ    44
         7 002557   200064 757100                    STAQ    @BUF_,,AUTO
         7 002560   000122 236000 8                  LDQ     82
         7 002561   200063 756100                    STQ     @KEY_,,AUTO
         7 002562   001232 701000 7                  TSX1    READ_OU_SEQ
         7 002563   002711 702000 7                  TSX2    FINISHED

      757    11625    5                 DO WHILE( B$PLOVERKEY.KEYSIZ = PLOVER_KEY.KEYSIZ

  11625  7 002564   002575 710000 7                  TRA     s:11630

      758    11626    5                         AND  B$PLOVERKEY.NOTHD = PLOVER_KEY.NOTHD
      759    11627    5                         AND  B$PLOVERKEY.UTS   = COMP_UTS );
      760    11628    5                     CALL LIST_PLOVER;

  11628  7 002565   003036 701000 7                  TSX1    LIST_PLOVER
         7 002566   000000 011000                    NOP     0

      761    11629    5                     CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(
             11629                              FINISHED);

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:133  
  11629  7 002567   000054 237000 8                  LDAQ    44
         7 002570   200064 757100                    STAQ    @BUF_,,AUTO
         7 002571   000122 236000 8                  LDQ     82
         7 002572   200063 756100                    STQ     @KEY_,,AUTO
         7 002573   001232 701000 7                  TSX1    READ_OU_SEQ
         7 002574   002711 702000 7                  TSX2    FINISHED

      762    11630    5                     END;

  11630  7 002575   000117 470400 1                  LDP0    OU_KEY$
         7 002576   000000 236100                    LDQ     0,,PR0
         7 002577   000334 676000 2                  ERQ     PLOVER_KEY
         7 002600   777000 376003                    ANQ     -512,DU
         7 002601   002615 601000 7                  TNZ     s:11631
         7 002602   000000 236100                    LDQ     0,,PR0
         7 002603   000334 676000 2                  ERQ     PLOVER_KEY
         7 002604   000777 376003                    ANQ     511,DU
         7 002605   002615 601000 7                  TNZ     s:11631
         7 002606   000000 235100                    LDA     0,,PR0
         7 002607   000001 236100                    LDQ     1,,PR0
         7 002610   000022 773000                    LRL     18
         7 002611   000000 116003                    CMPQ    0,DU
         7 002612   002615 604000 7                  TMI     s:11631
         7 002613   200056 116100                    CMPQ    COMP_UTS,,AUTO
         7 002614   002565 600000 7                  TZE     s:11628

      763    11631    4                 END;

  11631  7 002615   002711 710000 7                  TRA     FINISHED

      764    11632    4             ELSE DO;

      765    11633    4                 BLK$ = P$NODE.SUBLK$(1);

  11633  7 002616   100004 236100                    LDQ     4,,PR1
         7 002617   200006 756100                    STQ     BLK$,,AUTO

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:134  
      766    11634    4                 CALL CHECK_UTS( BLK$ ) ALTRET(FINISHED);

  11634  7 002620   200006 633500                    EPPR3   BLK$,,AUTO
         7 002621   200065 453500                    STP3    @PTR$,,AUTO
         7 002622   001300 701000 7                  TSX1    CHECK_UTS
         7 002623   002711 702000 7                  TSX2    FINISHED

      767    11635    4                 B$PLOVERKEY = PLOVER_KEY;

  11635  7 002624   000117 470400 1                  LDP0    OU_KEY$
         7 002625   000100 100400                    MLR     fill='000'O
         7 002626   000334 000015 2                  ADSC9   PLOVER_KEY               cn=0,n=13
         7 002627   000000 000015                    ADSC9   0,,PR0                   cn=0,n=13

      768    11636    4                 PLOVER_UTS = UTS;

  11636  7 002630   000435 235000 2                  LDA     UTS
         7 002631   200057 755100                    STA     PLOVER_UTS,,AUTO

      769    11637    4                 B$PLOVERKEY.PUTS = PLOVER_UTS;

  11637  7 002632   000100 100500                    MLR     fill='000'O
         7 002633   200057 000004                    ADSC9   PLOVER_UTS,,AUTO         cn=0,n=4
         7 002634   000001 600004                    ADSC9   1,,PR0                   cn=3,n=4

      770    11638    4                 B$PLOVERKEY.SEQ  = 1;

  11638  7 002635   000100 101400                    MRL     fill='000'O
         7 002636   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         7 002637   000002 600002                    ADSC9   2,,PR0                   cn=3,n=2

      771    11639    4                 CALL READ_OU( VECTOR(B$PLOVERKEY), VECTOR(TXT), CNT ) ALTRET(NONE);

  11639  7 002640   000114 235000 8                  LDA     76
         7 002641   000117 236000 1                  LDQ     OU_KEY$
         7 002642   200130 757100                    STAQ    @ARS+31,,AUTO
         7 002643   000054 237000 8                  LDAQ    44
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:135  
         7 002644   200070 757100                    STAQ    @BUF_,,AUTO
         7 002645   200130 631500                    EPPR1   @ARS+31,,AUTO
         7 002646   200067 451500                    STP1    VAL,,AUTO
         7 002647   001202 701000 7                  TSX1    READ_OU
         7 002650   002516 702000 7                  TSX2    NONE

      772    11640    5                 DO WHILE( B$PLOVERKEY.KEYSIZ  = PLOVER_KEY.KEYSIZ

  11640  7 002651   002662 710000 7                  TRA     s:11646

      773    11641    5                         AND B$PLOVERKEY.TYPE  = %TYPPLOVER
      774    11642    5                         AND  B$PLOVERKEY.UTS  = COMP_UTS
      775    11643    5                         AND  B$PLOVERKEY.PUTS = PLOVER_UTS );
      776    11644    5                     CALL LIST_PLOVER;

  11644  7 002652   003036 701000 7                  TSX1    LIST_PLOVER
         7 002653   000000 011000                    NOP     0

      777    11645    5                     CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT) ALTRET(
             11645                              FINISHED);

  11645  7 002654   000054 237000 8                  LDAQ    44
         7 002655   200064 757100                    STAQ    @BUF_,,AUTO
         7 002656   000122 236000 8                  LDQ     82
         7 002657   200063 756100                    STQ     @KEY_,,AUTO
         7 002660   001232 701000 7                  TSX1    READ_OU_SEQ
         7 002661   002711 702000 7                  TSX2    FINISHED

      778    11646    5                     END;

  11646  7 002662   000117 470400 1                  LDP0    OU_KEY$
         7 002663   000000 236100                    LDQ     0,,PR0
         7 002664   000334 676000 2                  ERQ     PLOVER_KEY
         7 002665   777000 376003                    ANQ     -512,DU
         7 002666   002711 601000 7                  TNZ     FINISHED
         7 002667   000001 236100                    LDQ     1,,PR0
         7 002670   777000 376007                    ANQ     -512,DL
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:136  
         7 002671   026000 116007                    CMPQ    11264,DL
         7 002672   002711 601000 7                  TNZ     FINISHED
         7 002673   000000 235100                    LDA     0,,PR0
         7 002674   000001 236100                    LDQ     1,,PR0
         7 002675   000022 773000                    LRL     18
         7 002676   000000 116003                    CMPQ    0,DU
         7 002677   002711 604000 7                  TMI     FINISHED
         7 002700   200056 116100                    CMPQ    COMP_UTS,,AUTO
         7 002701   002711 601000 7                  TNZ     FINISHED
         7 002702   000001 235100                    LDA     1,,PR0
         7 002703   000002 236100                    LDQ     2,,PR0
         7 002704   000011 773000                    LRL     9
         7 002705   000000 116003                    CMPQ    0,DU
         7 002706   002711 604000 7                  TMI     FINISHED
         7 002707   200057 116100                    CMPQ    PLOVER_UTS,,AUTO
         7 002710   002652 600000 7                  TZE     s:11644

      779    11647    4                 END;

      780    11648    3   FINISHED:
      781    11649    3             END;

  11649  7 002711                       FINISHED     null
      782    11650    2         RETURN;

  11650  7 002711   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 002712   000001 702211                    TSX2  ! 1,X1

      783    11651
      784    11652        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:137  
      785    11653    2   LIST_PLOVER_BIRTH:    PROC;

  11653  7 002713   200062 741300       LIST_PLOVER* STX1  ! READ_BLK$,,AUTO

      786    11654
      787    11655    3   DCL OU_FMT CHAR(0) CONSTANT INIT('Object unit = %>A');
      788    11656    3   DCL CREATION_UTS_FMT CHAR(0) CONSTANT INIT('%>A %>A Creation UTS');
      789    11657    3   DCL PLOVERED_UTS_FMT CHAR(0) CONSTANT INIT
      790    11658    3                                ('%>A %>A Last PLOVERed (%<D times)');
      791    11659    3   DCL IPATCH_FMT CHAR (0) CONSTANT INIT ('IPATCH value set to %<D');
      792    11660    3   DCL DPATCH_FMT CHAR (0) CONSTANT INIT ('DPATCH value set to %<D');
      793    11661
      794    11662    3         COMP_UTS = B$PLOVERBIRTH.CREATE_UTS;

  11662  7 002714   000116 470400 1                  LDP0    TXT$
         7 002715   000010 235100                    LDA     8,,PR0
         7 002716   200056 755100                    STA     COMP_UTS,,AUTO

      795    11663    3         LAST_UTS = COMP_UTS;

  11663  7 002717   200060 755100                    STA     LAST_UTS,,AUTO

      796    11664    3         COUNT = COUNT + 1;

  11664  7 002720   200061 054100                    AOS     COUNT,,AUTO

      797    11665    3         CALL X$WRITE( F_FDS, VECTOR(OU_FMT), VECTOR(B$PLOVERBIRTH.OU_NAME.TEXT) );

  11665  7 002721   000126 235000 8                  LDA     86
         7 002722   000116 236000 1                  LDQ     TXT$
         7 002723   200000 036007                    ADLQ    65536,DL
         7 002724   200072 757100                    STAQ    @ARS+1,,AUTO
         7 002725   200072 631500                    EPPR1   @ARS+1,,AUTO
         7 002726   200076 451500                    STP1    @ARS+5,,AUTO
         7 002727   000130 237000 8                  LDAQ    88
         7 002730   200074 757100                    STAQ    @ARS+3,,AUTO
         7 002731   200074 630500                    EPPR0   @ARS+3,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:138  
         7 002732   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 002733   000000 701000 xent               TSX1    X$WRITE
         7 002734   000000 011000                    NOP     0

      798    11666    3         UTS = B$PLOVERBIRTH.CREATE_UTS;

  11666  7 002735   000116 470400 1                  LDP0    TXT$
         7 002736   000010 235100                    LDA     8,,PR0
         7 002737   000435 755000 2                  STA     UTS

      799    11667    3         CALL M$TIME( UTS_TIME );

  11667  7 002740   000036 630400 1                  EPPR0   UTS_TIME
         7 002741   020004 713400                    CLIMB   8196
         7 002742   402000 401760                    pmme    nvectors=5

      800    11668        /*    IF PLOVER_BIRTH_SIZE ~= PLOVER_BIRTH_ARS# THEN DO;
      801    11669                 B$PLOVERBIRTH.IPATCH = 0;
      802    11670                 B$PLOVERBIRTH.DPATCH = 0;
      803    11671                 END;*/
      804    11672    3         CALL X$WRITE( F_FDS, VECTOR(CREATION_UTS_FMT), VECTOR(DATE),VECTOR(TIME));

  11672  7 002743   000140 630400 8                  EPPR0   96
         7 002744   000022 631400 xsym               EPPR1   B_VECTNIL+18
         7 002745   000000 701000 xent               TSX1    X$WRITE
         7 002746   000000 011000                    NOP     0

      805    11673    3         CALL X$WRITE( F_FDS, VECTOR(IPATCH_FMT), VECTOR(B$PLOVERBIRTH.IPATCH));

  11673  7 002747   777640 235007                    LDA     -96,DL
         7 002750   000116 236000 1                  LDQ     TXT$
         7 002751   000013 036003                    ADLQ    11,DU
         7 002752   200072 757100                    STAQ    @ARS+1,,AUTO
         7 002753   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 002754   200076 450500                    STP0    @ARS+5,,AUTO
         7 002755   000146 237000 8                  LDAQ    102
         7 002756   200074 757100                    STAQ    @ARS+3,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:139  
         7 002757   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 002760   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 002761   000000 701000 xent               TSX1    X$WRITE
         7 002762   000000 011000                    NOP     0

      806    11674    3         CALL X$WRITE( F_FDS, VECTOR(DPATCH_FMT), VECTOR(B$PLOVERBIRTH.DPATCH));

  11674  7 002763   777640 235007                    LDA     -96,DL
         7 002764   000116 236000 1                  LDQ     TXT$
         7 002765   000014 036003                    ADLQ    12,DU
         7 002766   200072 757100                    STAQ    @ARS+1,,AUTO
         7 002767   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 002770   200076 450500                    STP0    @ARS+5,,AUTO
         7 002771   000152 237000 8                  LDAQ    106
         7 002772   200074 757100                    STAQ    @ARS+3,,AUTO
         7 002773   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 002774   000021 631400 xsym               EPPR1   B_VECTNIL+17
         7 002775   000000 701000 xent               TSX1    X$WRITE
         7 002776   000000 011000                    NOP     0

      807    11675    3         IF B$PLOVERBIRTH.COUNT = 0 THEN

  11675  7 002777   000116 470400 1                  LDP0    TXT$
         7 003000   000012 235100                    LDA     10,,PR0
         7 003001   003011 601000 7                  TNZ     s:11678

      808    11676    3             CALL WRITE_LO( 'None', 4 );

  11676  7 003002   000127 236000 8                  LDQ     87
         7 003003   200066 756100                    STQ     I,,AUTO
         7 003004   000154 236000 8                  LDQ     108
         7 003005   200065 756100                    STQ     @PTR$,,AUTO
         7 003006   000542 701000 7                  TSX1    WRITE_LO
         7 003007   000000 011000                    NOP     0
         7 003010   003034 710000 7                  TRA     s:11684

      809    11677    4         ELSE DO;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:140  

      810    11678    4             UTS = B$PLOVERBIRTH.PLOVER_UTS;

  11678  7 003011   000011 235100                    LDA     9,,PR0
         7 003012   000435 755000 2                  STA     UTS

      811    11679    4             CALL M$TIME( UTS_TIME );

  11679  7 003013   000036 630400 1                  EPPR0   UTS_TIME
         7 003014   020004 713400                    CLIMB   8196
         7 003015   402000 401760                    pmme    nvectors=5

      812    11680    4             CALL X$WRITE( F_FDS, VECTOR(PLOVERED_UTS_FMT),

  11680  7 003016   777640 235007                    LDA     -96,DL
         7 003017   000116 236000 1                  LDQ     TXT$
         7 003020   000012 036003                    ADLQ    10,DU
         7 003021   200072 757100                    STAQ    @ARS+1,,AUTO
         7 003022   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 003023   200100 450500                    STP0    @ARS+7,,AUTO
         7 003024   000142 237000 8                  LDAQ    98
         7 003025   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003026   000160 237000 8                  LDAQ    112
         7 003027   200074 757100                    STAQ    @ARS+3,,AUTO
         7 003030   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 003031   000023 631400 xsym               EPPR1   B_VECTNIL+19
         7 003032   000000 701000 xent               TSX1    X$WRITE
         7 003033   000000 011000                    NOP     0

      813    11681    4                     VECTOR(DATE), VECTOR(TIME), VECTOR(B$PLOVERBIRTH.COUNT));
      814    11682    4             END;

      815    11683
      816    11684    3   END LIST_PLOVER_BIRTH;

  11684  7 003034   200062 221300                    LDX1  ! READ_BLK$,,AUTO
         7 003035   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:141  

      817    11685        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:142  
      818    11686    2   LIST_PLOVER:  PROC;

  11686  7 003036   200062 741300       LIST_PLOVER  STX1  ! READ_BLK$,,AUTO

      819    11687
      820    11688    3   DCL FMT CHAR(0) CONSTANT INIT('%5.ZD %>A');
      821    11689
      822    11690    4         IF B$PLOVERKEY.PUTS ~= LAST_UTS THEN DO;

  11690  7 003037   000117 470400 1                  LDP0    OU_KEY$
         7 003040   000001 235100                    LDA     1,,PR0
         7 003041   000002 236100                    LDQ     2,,PR0
         7 003042   000011 773000                    LRL     9
         7 003043   000000 116003                    CMPQ    0,DU
         7 003044   003047 604000 7                  TMI     s:11691
         7 003045   200060 116100                    CMPQ    LAST_UTS,,AUTO
         7 003046   003072 600000 7                  TZE     s:11698

      823    11691    4             LAST_UTS = B$PLOVERKEY.PUTS;

  11691  7 003047   200060 756100                    STQ     LAST_UTS,,AUTO

      824    11692    4             UTS = LAST_UTS;

  11692  7 003050   000435 756000 2                  STQ     UTS

      825    11693    4             CALL M$TIME( UTS_TIME );

  11693  7 003051   000036 630400 1                  EPPR0   UTS_TIME
         7 003052   020004 713400                    CLIMB   8196
         7 003053   402000 401760                    pmme    nvectors=5

      826    11694    4             CALL CONCAT( OUT_BUF, DATE, ' ', TIME );

  11694  7 003054   000414 237000 2                  LDAQ    DATE
         7 003055   000106 757000 2                  STAQ    OUT_BUF
         7 003056   040000 236003                    LDQ     16384,DU
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:143  
         7 003057   000110 756000 2                  STQ     OUT_BUF+2
         7 003060   040000 100400                    MLR     fill='040'O
         7 003061   000416 000013 2                  ADSC9   TIME                     cn=0,n=11
         7 003062   000110 200107 2                  ADSC9   OUT_BUF+2                cn=1,n=71

      827    11695    4             CALL WRITE_LO( OUT_BUF, 21 );

  11695  7 003063   000163 236000 8                  LDQ     115
         7 003064   200066 756100                    STQ     I,,AUTO
         7 003065   000164 236000 8                  LDQ     116
         7 003066   200065 756100                    STQ     @PTR$,,AUTO
         7 003067   000542 701000 7                  TSX1    WRITE_LO
         7 003070   000000 011000                    NOP     0

      828    11696    4             SEQ = 0;

  11696  7 003071   200055 450100                    STZ     SEQ,,AUTO

      829    11697    4             END;

      830    11698    3         SEQ = SEQ + 1;

  11698  7 003072   200055 054100                    AOS     SEQ,,AUTO

      831    11699    3         CALL X$WRITE( F_FDS, VECTOR(FMT), VECTOR(SEQ), VECTOR(SUBSTR(TXT,0,CNT)));

  11699  7 003073   777640 235007                    LDA     -96,DL
         7 003074   200072 452500                    STP2    @ARS+1,,AUTO
         7 003075   200072 236100                    LDQ     @ARS+1,,AUTO
         7 003076   000055 036003                    ADLQ    45,DU
         7 003077   200074 757100                    STAQ    @ARS+3,,AUTO
         7 003100   000537 235000 2                  LDA     CNT
         7 003101   000020 735000                    ALS     16
         7 003102   000140 135007                    SBLA    96,DL
         7 003103   000004 236000 8                  LDQ     4
         7 003104   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003105   200074 237100                    LDAQ    @ARS+3,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:144  
         7 003106   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003107   200100 237100                    LDAQ    @ARS+7,,AUTO
         7 003110   200102 757100                    STAQ    @ARS+9,,AUTO
         7 003111   200102 630500                    EPPR0   @ARS+9,,AUTO
         7 003112   200107 450500                    STP0    @ARS+14,,AUTO
         7 003113   200076 631500                    EPPR1   @ARS+5,,AUTO
         7 003114   200106 451500                    STP1    @ARS+13,,AUTO
         7 003115   000170 237000 8                  LDAQ    120
         7 003116   200104 757100                    STAQ    @ARS+11,,AUTO
         7 003117   200104 630500                    EPPR0   @ARS+11,,AUTO
         7 003120   000022 631400 xsym               EPPR1   B_VECTNIL+18
         7 003121   000000 701000 xent               TSX1    X$WRITE
         7 003122   000000 011000                    NOP     0

      832    11700
      833    11701    3   END LIST_PLOVER;

  11701  7 003123   200062 221300                    LDX1  ! READ_BLK$,,AUTO
         7 003124   000001 702211                    TSX2  ! 1,X1

      834    11702
      835    11703    2   END LIST_COMMAND;
      836    11704        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:145  
      837    11705    1   DELETE_COMMAND: PROC  ALTRET;

  11705  7 003125   200054 741300       DELETE_COMM* STX1  ! FIELD3+8,,AUTO

      838    11706
      839    11707
      840    11708        %FPT_DELREC( DCB=M$OF, KEY=KEY1, LKEY=KEY2 );
      841    11727        %B$PLOVERKEY( NAME=KEY1, STCLASS=STATIC );
      842    11757        %B$PLOVERKEY( NAME=KEY2, STCLASS=STATIC );
      843    11787
      844    11788
      845    11789
      846    11790    3         IF NOT OUF_ASSOCIATED THEN DO;

  11790  7 003126   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 003127   003152 604000 7                  TMI     s:11807

      847    11791        /*    ERROR:  DPM-E$NO_FILE-C
      848    11792              MESSAGE: No file named
      849    11793              MESSAGE1: A command has been issued without a file open for PLOVERing
      850    11794        */
      851    11795                  %SCREAM( ERR#=E$NO_FILE );

  11802  7 003130   000000 236007 xsym               LDQ     M$DO,DL
         7 003131   200072 756100                    STQ     @ARS+1,,AUTO
         7 003132   000020 237000 8                  LDAQ    16
         7 003133   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003134   000022 237000 8                  LDAQ    18
         7 003135   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003136   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 003137   200075 450500                    STP0    @ARS+4,,AUTO
         7 003140   000021 236000 8                  LDQ     17
         7 003141   200074 756100                    STQ     @ARS+3,,AUTO
         7 003142   000064 236000 8                  LDQ     52
         7 003143   200073 756100                    STQ     @ARS+2,,AUTO
         7 003144   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 003145   000025 631400 xsym               EPPR1   B_VECTNIL+21
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:146  
         7 003146   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003147   000000 011000                    NOP     0

      852    11805    3             ALTRETURN;

  11805  7 003150   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 003151   000000 702211                    TSX2  ! 0,X1

      853    11806    3             END;
      854    11807    3         IF P$NODE.NSUBLKS = 0 THEN DO;   /* Delete all PLOVER records */

  11807  7 003152   200003 470500                    LDP0    OUT$,,AUTO
         7 003153   000001 220100                    LDX0    1,,PR0
         7 003154   003272 601000 7                  TNZ     s:11853

      855    11808    3             B$PLOVERKEY = PLOVER_KEY;

  11808  7 003155   000117 471400 1                  LDP1    OU_KEY$
         7 003156   000100 100400                    MLR     fill='000'O
         7 003157   000334 000015 2                  ADSC9   PLOVER_KEY               cn=0,n=13
         7 003160   100000 000015                    ADSC9   0,,PR1                   cn=0,n=13

      856    11809    3             B$PLOVERKEY.KEYSIZ = 1;

  11809  7 003161   001000 236003                    LDQ     512,DU
         7 003162   100000 552140                    STBQ    0,'40'O,PR1

      857    11810    3             CALL READ_OU( VECTOR(OU_KEY), VECTOR(TXT) );

  11810  7 003163   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 003164   000054 235000 8                  LDA     44
         7 003165   200070 757100                    STAQ    @BUF_,,AUTO
         7 003166   000122 236000 8                  LDQ     82
         7 003167   200067 756100                    STQ     VAL,,AUTO
         7 003170   001202 701000 7                  TSX1    READ_OU
         7 003171   000000 011000                    NOP     0

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:147  
      858    11811    3             CALL READ_OU_SEQ( VECTOR(OU_KEY), VECTOR(TXT), CNT ) ALTRET(NONE);

  11811  7 003172   000054 237000 8                  LDAQ    44
         7 003173   200064 757100                    STAQ    @BUF_,,AUTO
         7 003174   000122 236000 8                  LDQ     82
         7 003175   200063 756100                    STQ     @KEY_,,AUTO
         7 003176   001232 701000 7                  TSX1    READ_OU_SEQ
         7 003177   003250 702000 7                  TSX2    NONE

      859    11812    4             IF B$PLOVERKEY.NOTHD = PLOVER_KEY.NOTHD THEN DO;

  11812  7 003200   000117 470400 1                  LDP0    OU_KEY$
         7 003201   000000 236100                    LDQ     0,,PR0
         7 003202   000334 676000 2                  ERQ     PLOVER_KEY
         7 003203   000777 376003                    ANQ     511,DU
         7 003204   003250 601000 7                  TNZ     NONE

      860    11813    4                 KEY1.KEYSIZ  = 1;

  11813  7 003205   001000 236003                    LDQ     512,DU
         7 003206   001112 552040 2                  STBQ    KEY1,'40'O

      861    11814    4                 KEY2.KEYSIZ  = PLOVER_KEY.KEYSIZ;

  11814  7 003207   000334 236000 2                  LDQ     PLOVER_KEY
         7 003210   001116 552040 2                  STBQ    KEY2,'40'O

      862    11815    4                 KEY2.TYPE    = %TYPPLOVER;

  11815  7 003211   026000 236007                    LDQ     11264,DL
         7 003212   001117 552010 2                  STBQ    KEY2+1,'10'O

      863    11816    4                 KEY2.UTS     = BITBIN('777777777777'O);

  11816  7 003213   000000 100400                    MLR     fill='000'O
         7 003214   000027 000004 xsym               ADSC9   B_VECTNIL+23             cn=0,n=4
         7 003215   001116 400004 2                  ADSC9   KEY2                     cn=2,n=4
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:148  

      864    11817    4                 KEY2.PUTS    = BITBIN('777777777777'O);

  11817  7 003216   000000 100400                    MLR     fill='000'O
         7 003217   000027 000004 xsym               ADSC9   B_VECTNIL+23             cn=0,n=4
         7 003220   001117 600004 2                  ADSC9   KEY2+1                   cn=3,n=4

      865    11818    4                 KEY2.SEQ     = BITBIN('777777777777'O);

  11818  7 003221   000000 101400                    MRL     fill='000'O
         7 003222   000027 000004 xsym               ADSC9   B_VECTNIL+23             cn=0,n=4
         7 003223   001120 600002 2                  ADSC9   KEY2+2                   cn=3,n=2

      866    11819    4                 CALL M$DELREC( FPT_DELREC );

  11819  7 003224   001100 630400 2                  EPPR0   FPT_DELREC
         7 003225   040002 713400                    CLIMB   16386
         7 003226   401400 401760                    pmme    nvectors=4

      867    11820        /*E*  ERROR:  DPM-E$ALL_PLOVERS_DEL-C
      868    11821              MESSAGE: All PLOVER records deleted
      869    11822        */
      870    11823                      %SCREAM( ERR#=E$ALL_PLOVERS_DEL );

  11830  7 003227   000000 236007 xsym               LDQ     M$DO,DL
         7 003230   200072 756100                    STQ     @ARS+1,,AUTO
         7 003231   000020 237000 8                  LDAQ    16
         7 003232   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003233   000022 237000 8                  LDAQ    18
         7 003234   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003235   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 003236   200075 450500                    STP0    @ARS+4,,AUTO
         7 003237   000021 236000 8                  LDQ     17
         7 003240   200074 756100                    STQ     @ARS+3,,AUTO
         7 003241   000172 236000 8                  LDQ     122
         7 003242   200073 756100                    STQ     @ARS+2,,AUTO
         7 003243   200073 630500                    EPPR0   @ARS+2,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:149  
         7 003244   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 003245   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003246   000000 011000                    NOP     0

      871    11833    4                 END;

  11833  7 003247   003562 710000 7                  TRA     s:11929

      872    11834    4             ELSE DO;

      873    11835        /*E*  ERROR:  DPM-E$NOTHING_TO_DEL-C
      874    11836              MESSAGE: Nothing to delete
      875    11837        */
      876    11838    4   NONE:
      877    11839                      %SCREAM( ERR#=E$NOTHING_TO_DEL );

  11846  7 003250   000000 236007 xsym  NONE         LDQ     M$DO,DL
         7 003251   200072 756100                    STQ     @ARS+1,,AUTO
         7 003252   000020 237000 8                  LDAQ    16
         7 003253   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003254   000022 237000 8                  LDAQ    18
         7 003255   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003256   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 003257   200075 450500                    STP0    @ARS+4,,AUTO
         7 003260   000021 236000 8                  LDQ     17
         7 003261   200074 756100                    STQ     @ARS+3,,AUTO
         7 003262   000173 236000 8                  LDQ     123
         7 003263   200073 756100                    STQ     @ARS+2,,AUTO
         7 003264   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 003265   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 003266   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003267   000000 011000                    NOP     0

      878    11849    4                 RETURN;

  11849  7 003270   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 003271   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:150  

      879    11850    4                 END;
      880    11851    3             END;
      881    11852    3         ELSE DO;

      882    11853    3             BLK$ = P$NODE.SUBLK$(0);

  11853  7 003272   000003 236100                    LDQ     3,,PR0
         7 003273   200006 756100                    STQ     BLK$,,AUTO

      883    11854    3             CALL FIND_OU ALTRET(EXIT#);

  11854  7 003274   000767 701000 7                  TSX1    FIND_OU
         7 003275   003613 702000 7                  TSX2    EXIT#

      884    11855    4             IF P$NODE.NSUBLKS = 1 THEN DO;

  11855  7 003276   200003 470500                    LDP0    OUT$,,AUTO
         7 003277   000001 220100                    LDX0    1,,PR0
         7 003300   000001 100003                    CMPX0   1,DU
         7 003301   003420 601000 7                  TNZ     s:11895

      885    11856    5                 IF B$PLOVERBIRTH.COUNT = 0 THEN DO;

  11856  7 003302   000116 471400 1                  LDP1    TXT$
         7 003303   100012 235100                    LDA     10,,PR1
         7 003304   003327 601000 7                  TNZ     s:11870

      886    11857                          %SCREAM( ERR#=E$NOTHING_TO_DEL );

  11864  7 003305   000000 236007 xsym               LDQ     M$DO,DL
         7 003306   200072 756100                    STQ     @ARS+1,,AUTO
         7 003307   000020 237000 8                  LDAQ    16
         7 003310   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003311   000022 237000 8                  LDAQ    18
         7 003312   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003313   200072 633500                    EPPR3   @ARS+1,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:151  
         7 003314   200075 453500                    STP3    @ARS+4,,AUTO
         7 003315   000021 236000 8                  LDQ     17
         7 003316   200074 756100                    STQ     @ARS+3,,AUTO
         7 003317   000173 236000 8                  LDQ     123
         7 003320   200073 756100                    STQ     @ARS+2,,AUTO
         7 003321   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 003322   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 003323   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003324   000000 011000                    NOP     0

      887    11867    5                     RETURN;

  11867  7 003325   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 003326   000001 702211                    TSX2  ! 1,X1

      888    11868    5                     END;
      889    11869    5                 ELSE DO;

      890    11870    5                     KEY1      = B$PLOVERBIRTHKEY;

  11870  7 003327   000117 473400 1                  LDP3    OU_KEY$
         7 003330   000000 100500                    MLR     fill='000'O
         7 003331   300000 000006                    ADSC9   0,,PR3                   cn=0,n=6
         7 003332   001112 000015 2                  ADSC9   KEY1                     cn=0,n=13

      891    11871    5                     KEY2      = PLOVER_KEY;

  11871  7 003333   000000 100400                    MLR     fill='000'O
         7 003334   000334 000015 2                  ADSC9   PLOVER_KEY               cn=0,n=13
         7 003335   001116 000015 2                  ADSC9   KEY2                     cn=0,n=13

      892    11872    5                     KEY2.UTS  = B$PLOVERBIRTH.CREATE_UTS;

  11872  7 003336   000000 100500                    MLR     fill='000'O
         7 003337   100010 000004                    ADSC9   8,,PR1                   cn=0,n=4
         7 003340   001116 400004 2                  ADSC9   KEY2                     cn=2,n=4

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:152  
      893    11873    5                     KEY2.PUTS = B$PLOVERBIRTH.PLOVER_UTS;

  11873  7 003341   000000 100500                    MLR     fill='000'O
         7 003342   100011 000004                    ADSC9   9,,PR1                   cn=0,n=4
         7 003343   001117 600004 2                  ADSC9   KEY2+1                   cn=3,n=4

      894    11874    5                     KEY2.SEQ  = BITBIN('777777777777'O);

  11874  7 003344   000000 101400                    MRL     fill='000'O
         7 003345   000027 000004 xsym               ADSC9   B_VECTNIL+23             cn=0,n=4
         7 003346   001120 600002 2                  ADSC9   KEY2+2                   cn=3,n=2

      895    11875    5                     CALL M$DELREC( FPT_DELREC );

  11875  7 003347   001100 630400 2                  EPPR0   FPT_DELREC
         7 003350   040002 713400                    CLIMB   16386
         7 003351   401400 401760                    pmme    nvectors=4

      896    11876        /*E*  ERROR:  DPM-E$ALL_OU_PLOVERS_DEL-C
      897    11877              MESSAGE: All PLOVER records for object unit %U1 deleted
      898    11878        */
      899    11879    5                     BLK$ = P_PCB.OUT$ -> P$NODE.SUBLK$(0);

  11879  7 003352   000277 470400 2                  LDP0    P_PCB+3
         7 003353   000003 236100                    LDQ     3,,PR0
         7 003354   200006 756100                    STQ     BLK$,,AUTO

      900    11880    5                     FIELD1.COUNT = OUT$SYM.COUNT;

  11880  7 003355   200006 471500                    LDP1    BLK$,,AUTO
         7 003356   100004 236100                    LDQ     4,,PR1
         7 003357   200024 552140                    STBQ    FIELD1,'40'O,AUTO

      901    11881    5                     FIELD1.TEXT  = OUT$SYM.TEXT;

  11881  7 003360   100004 236100                    LDQ     4,,PR1
         7 003361   000033 772000                    QRL     27
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:153  
         7 003362   000000 620006                    EAX0    0,QL
         7 003363   040100 100540                    MLR     fill='040'O
         7 003364   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         7 003365   200024 200037                    ADSC9   FIELD1,,AUTO             cn=1,n=31

      902    11882                          %SCREAM( ERR#=E$ALL_OU_PLOVERS_DEL, F1=FIELD1 );

  11889  7 003366   000000 236007 xsym               LDQ     M$DO,DL
         7 003367   000030 235000 8                  LDA     24
         7 003370   200072 452500                    STP2    @ARS+1,,AUTO
         7 003371   200073 756100                    STQ     @ARS+2,,AUTO
         7 003372   200072 236100                    LDQ     @ARS+1,,AUTO
         7 003373   000024 036003                    ADLQ    20,DU
         7 003374   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003375   200073 235100                    LDA     @ARS+2,,AUTO
         7 003376   200074 755100                    STA     @ARS+3,,AUTO
         7 003377   200076 237100                    LDAQ    @ARS+5,,AUTO
         7 003400   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003401   000021 236000 8                  LDQ     17
         7 003402   200110 756100                    STQ     @ARS+15,,AUTO
         7 003403   000022 237000 8                  LDAQ    18
         7 003404   200106 757100                    STAQ    @ARS+13,,AUTO
         7 003405   200100 633500                    EPPR3   @ARS+7,,AUTO
         7 003406   200105 453500                    STP3    @ARS+12,,AUTO
         7 003407   200074 634500                    EPPR4   @ARS+3,,AUTO
         7 003410   200104 454500                    STP4    @ARS+11,,AUTO
         7 003411   000174 237000 8                  LDAQ    124
         7 003412   200102 757100                    STAQ    @ARS+9,,AUTO
         7 003413   200102 630500                    EPPR0   @ARS+9,,AUTO
         7 003414   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 003415   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003416   000000 011000                    NOP     0

      903    11892    5                     END;

      904    11893    4                 END;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:154  
  11893  7 003417   003562 710000 7                  TRA     s:11929

      905    11894    4             ELSE DO;

      906    11895    4                 BLK$ = P$NODE.SUBLK$(1);

  11895  7 003420   000004 236100                    LDQ     4,,PR0
         7 003421   200006 756100                    STQ     BLK$,,AUTO

      907    11896    4                 CALL CHECK_UTS( BLK$ ) ALTRET(EXIT#);

  11896  7 003422   200006 631500                    EPPR1   BLK$,,AUTO
         7 003423   200065 451500                    STP1    @PTR$,,AUTO
         7 003424   001300 701000 7                  TSX1    CHECK_UTS
         7 003425   003613 702000 7                  TSX2    EXIT#

      908    11897    4                 KEY1      = PLOVER_KEY;

  11897  7 003426   000000 100400                    MLR     fill='000'O
         7 003427   000334 000015 2                  ADSC9   PLOVER_KEY               cn=0,n=13
         7 003430   001112 000015 2                  ADSC9   KEY1                     cn=0,n=13

      909    11898    4                 KEY1.UTS  = B$PLOVERBIRTH.CREATE_UTS;

  11898  7 003431   000116 470400 1                  LDP0    TXT$
         7 003432   000000 100500                    MLR     fill='000'O
         7 003433   000010 000004                    ADSC9   8,,PR0                   cn=0,n=4
         7 003434   001112 400004 2                  ADSC9   KEY1                     cn=2,n=4

      910    11899    4                 KEY1.PUTS = UTS;

  11899  7 003435   000000 100400                    MLR     fill='000'O
         7 003436   000435 000004 2                  ADSC9   UTS                      cn=0,n=4
         7 003437   001113 600004 2                  ADSC9   KEY1+1                   cn=3,n=4

      911    11900    4                 KEY1.SEQ  = 1;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:155  
  11900  7 003440   000000 101400                    MRL     fill='000'O
         7 003441   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         7 003442   001114 600002 2                  ADSC9   KEY1+2                   cn=3,n=2

      912    11901    4                 CALL READ_OU( VECTOR(KEY1), VECTOR(TXT) ) ALTRET(NONE);

  11901  7 003443   000001 236000 xsym               LDQ     B_VECTNIL+1
         7 003444   000054 235000 8                  LDA     44
         7 003445   200070 757100                    STAQ    @BUF_,,AUTO
         7 003446   000200 236000 8                  LDQ     128
         7 003447   200067 756100                    STQ     VAL,,AUTO
         7 003450   001202 701000 7                  TSX1    READ_OU
         7 003451   003250 702000 7                  TSX2    NONE

      913    11902    4                 KEY2 = KEY1;

  11902  7 003452   000000 100400                    MLR     fill='000'O
         7 003453   001112 000015 2                  ADSC9   KEY1                     cn=0,n=13
         7 003454   001116 000015 2                  ADSC9   KEY2                     cn=0,n=13

      914    11903    4                 KEY2.SEQ = BITBIN('777777777777'O);

  11903  7 003455   000000 101400                    MRL     fill='000'O
         7 003456   000027 000004 xsym               ADSC9   B_VECTNIL+23             cn=0,n=4
         7 003457   001120 600002 2                  ADSC9   KEY2+2                   cn=3,n=2

      915    11904    4                 CALL M$DELREC( FPT_DELREC );

  11904  7 003460   001100 630400 2                  EPPR0   FPT_DELREC
         7 003461   040002 713400                    CLIMB   16386
         7 003462   401400 401760                    pmme    nvectors=4

      916    11905        /*E*  ERROR: DPM-E$ALL_UTS_PLOVERS_DEL-C
      917    11906            MESSAGE: All records PLOVERed at %U1 on %U2 for object unit %U3
      918    11907                     have been deleted.
      919    11908        */
      920    11909    4                 BLK$ = P_PCB.OUT$ -> P$NODE.SUBLK$(0);
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:156  

  11909  7 003463   000277 470400 2                  LDP0    P_PCB+3
         7 003464   000003 236100                    LDQ     3,,PR0
         7 003465   200006 756100                    STQ     BLK$,,AUTO

      921    11910    4                 FIELD3.COUNT = OUT$SYM.COUNT;

  11910  7 003466   200006 471500                    LDP1    BLK$,,AUTO
         7 003467   100004 236100                    LDQ     4,,PR1
         7 003470   200044 552140                    STBQ    FIELD3,'40'O,AUTO

      922    11911    4                 FIELD3.TEXT  = OUT$SYM.TEXT;

  11911  7 003471   100004 236100                    LDQ     4,,PR1
         7 003472   000033 772000                    QRL     27
         7 003473   000000 620006                    EAX0    0,QL
         7 003474   040100 100540                    MLR     fill='040'O
         7 003475   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         7 003476   200044 200037                    ADSC9   FIELD3,,AUTO             cn=1,n=31

      923    11912    4                 FIELD1.COUNT = 11;

  11912  7 003477   013000 236003                    LDQ     5632,DU
         7 003500   200024 552140                    STBQ    FIELD1,'40'O,AUTO

      924    11913    4                 FIELD1.TEXT  = TIME;

  11913  7 003501   040100 100400                    MLR     fill='040'O
         7 003502   000416 000013 2                  ADSC9   TIME                     cn=0,n=11
         7 003503   200024 200037                    ADSC9   FIELD1,,AUTO             cn=1,n=31

      925    11914    4                 FIELD2.COUNT = 8;

  11914  7 003504   010000 236003                    LDQ     4096,DU
         7 003505   200034 552140                    STBQ    FIELD2,'40'O,AUTO

      926    11915    4                 FIELD2.TEXT  = DATE;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:157  

  11915  7 003506   040100 100400                    MLR     fill='040'O
         7 003507   000414 000010 2                  ADSC9   DATE                     cn=0,n=8
         7 003510   200034 200037                    ADSC9   FIELD2,,AUTO             cn=1,n=31

      927    11916                     %SCREAM( ERR#=E$ALL_UTS_PLOVERS_DEL, F1=FIELD1, F2=FIELD2, F3=FIELD3 )
             11916                          ;

  11923  7 003511   000000 236007 xsym               LDQ     M$DO,DL
         7 003512   000030 235000 8                  LDA     24
         7 003513   200072 452500                    STP2    @ARS+1,,AUTO
         7 003514   200073 756100                    STQ     @ARS+2,,AUTO
         7 003515   200072 236100                    LDQ     @ARS+1,,AUTO
         7 003516   000024 036003                    ADLQ    20,DU
         7 003517   200074 757100                    STAQ    @ARS+3,,AUTO
         7 003520   000030 235000 8                  LDA     24
         7 003521   200076 452500                    STP2    @ARS+5,,AUTO
         7 003522   200076 236100                    LDQ     @ARS+5,,AUTO
         7 003523   000034 036003                    ADLQ    28,DU
         7 003524   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003525   000030 235000 8                  LDA     24
         7 003526   200102 452500                    STP2    @ARS+9,,AUTO
         7 003527   200102 236100                    LDQ     @ARS+9,,AUTO
         7 003530   000044 036003                    ADLQ    36,DU
         7 003531   200104 757100                    STAQ    @ARS+11,,AUTO
         7 003532   200073 235100                    LDA     @ARS+2,,AUTO
         7 003533   200103 755100                    STA     @ARS+10,,AUTO
         7 003534   200074 237100                    LDAQ    @ARS+3,,AUTO
         7 003535   200106 757100                    STAQ    @ARS+13,,AUTO
         7 003536   200100 237100                    LDAQ    @ARS+7,,AUTO
         7 003537   200110 757100                    STAQ    @ARS+15,,AUTO
         7 003540   200104 237100                    LDAQ    @ARS+11,,AUTO
         7 003541   200112 757100                    STAQ    @ARS+17,,AUTO
         7 003542   000021 236000 8                  LDQ     17
         7 003543   200122 756100                    STQ     @ARS+25,,AUTO
         7 003544   200112 633500                    EPPR3   @ARS+17,,AUTO
         7 003545   200121 453500                    STP3    @ARS+24,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:158  
         7 003546   200110 634500                    EPPR4   @ARS+15,,AUTO
         7 003547   200120 454500                    STP4    @ARS+23,,AUTO
         7 003550   200106 635500                    EPPR5   @ARS+13,,AUTO
         7 003551   200117 455500                    STP5    @ARS+22,,AUTO
         7 003552   200103 636500                    EPPR6   @ARS+10,,AUTO
         7 003553   200116 456500                    STP6    @ARS+21,,AUTO
         7 003554   000202 237000 8                  LDAQ    130
         7 003555   200114 757100                    STAQ    @ARS+19,,AUTO
         7 003556   200114 630500                    EPPR0   @ARS+19,,AUTO
         7 003557   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 003560   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003561   000000 011000                    NOP     0

      928    11926    4                 END;

      929    11927    3             END;

      930    11928
      931    11929    2         IF OU_ASSOCIATED  AND

  11929  7 003562   000430 234000 2                  SZN     OU_ASSOCIATED
         7 003563   003613 605000 7                  TPL     EXIT#
         7 003564   200003 470500                    LDP0    OUT$,,AUTO
         7 003565   000001 220100                    LDX0    1,,PR0
         7 003566   003574 600000 7                  TZE     s:11932
         7 003567   000116 471400 1                  LDP1    TXT$
         7 003570   000000 106500                    CMPC    fill='000'O
         7 003571   100000 000064                    ADSC9   0,,PR1                   cn=0,n=52
         7 003572   000375 000064 2                  ADSC9   PLOVER_BIRTH             cn=0,n=52
         7 003573   003613 601000 7                  TNZ     EXIT#

      932    11930    2                 (P$NODE.NSUBLKS = 0  OR  B$PLOVERBIRTH = PLOVER_BIRTH )
      933    11931    3         THEN DO;

      934    11932    3             CALL M$TIME( GET_PLOVER_UTS );

  11932  7 003574   000006 630400 1                  EPPR0   GET_PLOVER_UTS
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:159  
         7 003575   020004 713400                    CLIMB   8196
         7 003576   402000 401760                    pmme    nvectors=5

      935    11933    3             PLOVER_KEY.PUTS         = PLOVER_UTS;

  11933  7 003577   000000 100400                    MLR     fill='000'O
         7 003600   000434 000004 2                  ADSC9   PLOVER_UTS               cn=0,n=4
         7 003601   000335 600004 2                  ADSC9   PLOVER_KEY+1             cn=3,n=4

      936    11934    3             PLOVER_KEY.SEQ          = 0;

  11934  7 003602   000000 101400                    MRL     fill='000'O
         7 003603   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         7 003604   000336 600002 2                  ADSC9   PLOVER_KEY+2             cn=3,n=2

      937    11935    3             PLOVER_BIRTH.PLOVER_UTS = 0;

  11935  7 003605   000406 450000 2                  STZ     PLOVER_BIRTH+9

      938    11936    3             IF P$NODE.NSUBLKS <= 1 THEN

  11936  7 003606   200003 470500                    LDP0    OUT$,,AUTO
         7 003607   000001 220100                    LDX0    1,,PR0
         7 003610   000002 100003                    CMPX0   2,DU
         7 003611   003613 603000 7                  TRC     EXIT#

      939    11937    3                 PLOVER_BIRTH.COUNT = 0;

  11937  7 003612   000407 450000 2                  STZ     PLOVER_BIRTH+10

      940    11938    3             END;

      941    11939
      942    11940    2   EXIT#: RETURN;

  11940  7 003613   200054 221300       EXIT#        LDX1  ! FIELD3+8,,AUTO
         7 003614   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:160  

      943    11941
      944    11942    2   END DELETE_COMMAND;
      945    11943        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:161  
      946    11944    1   SYMDEF_COMMAND:  PROC ALTRET;

  11944  7 003615   200054 741300       SYMDEF_COMM* STX1  ! FIELD3+8,,AUTO

      947    11945
      948    11946
      949    11947    2   DCL SECT# SBIN WORD;
      950    11948
      951    11949    3         IF NOT OUF_ASSOCIATED THEN DO;

  11949  7 003616   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 003617   003642 604000 7                  TMI     s:11966

      952    11950        /*    ERROR:  DPM-E$NO_FILE-C
      953    11951              MESSAGE: No file named
      954    11952              MESSAGE1: A command has been issued without a file open for PLOVERing
      955    11953        */
      956    11954                  %SCREAM( ERR#=E$NO_FILE );

  11961  7 003620   000000 236007 xsym               LDQ     M$DO,DL
         7 003621   200072 756100                    STQ     @ARS+1,,AUTO
         7 003622   000020 237000 8                  LDAQ    16
         7 003623   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003624   000022 237000 8                  LDAQ    18
         7 003625   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003626   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 003627   200075 450500                    STP0    @ARS+4,,AUTO
         7 003630   000021 236000 8                  LDQ     17
         7 003631   200074 756100                    STQ     @ARS+3,,AUTO
         7 003632   000064 236000 8                  LDQ     52
         7 003633   200073 756100                    STQ     @ARS+2,,AUTO
         7 003634   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 003635   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 003636   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003637   000000 011000                    NOP     0

      957    11964    3             ALTRETURN;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:162  

  11964  7 003640   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 003641   000000 702211                    TSX2  ! 0,X1

      958    11965    3             END;
      959    11966    3         IF NOT OU_ASSOCIATED THEN DO;

  11966  7 003642   000430 234000 2                  SZN     OU_ASSOCIATED
         7 003643   003666 604000 7                  TMI     s:11983

      960    11967        /*    ERROR:  DPM-E$NO_OBJECT_UNIT-C
      961    11968              MESSAGE: No object unit named.
      962    11969              MESSAGE1: An object unit must be specified for this command.
      963    11970        */
      964    11971                  %SCREAM( ERR#=E$NO_OBJECT_UNIT );

  11978  7 003644   000000 236007 xsym               LDQ     M$DO,DL
         7 003645   200072 756100                    STQ     @ARS+1,,AUTO
         7 003646   000020 237000 8                  LDAQ    16
         7 003647   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003650   000022 237000 8                  LDAQ    18
         7 003651   200076 757100                    STAQ    @ARS+5,,AUTO
         7 003652   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 003653   200075 450500                    STP0    @ARS+4,,AUTO
         7 003654   000021 236000 8                  LDQ     17
         7 003655   200074 756100                    STQ     @ARS+3,,AUTO
         7 003656   000103 236000 8                  LDQ     67
         7 003657   200073 756100                    STQ     @ARS+2,,AUTO
         7 003660   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 003661   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 003662   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003663   000000 011000                    NOP     0

      965    11981    3             ALTRETURN;

  11981  7 003664   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 003665   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:163  

      966    11982    3             END;
      967    11983    2         BLK$ = P$NODE.SUBLK$(1);

  11983  7 003666   200003 470500                    LDP0    OUT$,,AUTO
         7 003667   000004 236100                    LDQ     4,,PR0
         7 003670   200006 756100                    STQ     BLK$,,AUTO

      968    11984    2         CALL CHARBIN ( SECT#, OUT$SYM.TEXT ) ;

  11984  7 003671   200006 471500                    LDP1    BLK$,,AUTO
         7 003672   100004 236100                    LDQ     4,,PR1
         7 003673   000033 772000                    QRL     27
         7 003674   000000 620006                    EAX0    0,QL
         7 003675   000100 305540                    DTB
         7 003676   100004 230010                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X0
         7 003677   200055 000004                    NDSC9   SECT#,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      969    11985    2         IF NUM_SECTS < 0 THEN CALL GET_NUM_SECTS ALTRET(ALT);

  11985  7 003700   000540 235000 2                  LDA     NUM_SECTS
         7 003701   003704 605000 7                  TPL     s:11986

  11985  7 003702   004047 701000 7                  TSX1    GET_NUM_SECTS
         7 003703   004045 702000 7                  TSX2    ALT

      970    11986    3         IF SECT# >= NUM_SECTS THEN DO;

  11986  7 003704   200055 236100                    LDQ     SECT#,,AUTO
         7 003705   000540 116000 2                  CMPQ    NUM_SECTS
         7 003706   003764 604000 7                  TMI     s:12004

      971    11987        /*E*  ERROR:  DPM-E$SECT_DOES_NOT_EXIST-C
      972    11988              MESSAGE: Section %U1 does not exist in object unit %U2.
      973    11989        */
      974    11990    3             FIELD1.COUNT = OUT$SYM.COUNT;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:164  
  11990  7 003707   200006 470500                    LDP0    BLK$,,AUTO
         7 003710   000004 236100                    LDQ     4,,PR0
         7 003711   200024 552140                    STBQ    FIELD1,'40'O,AUTO

      975    11991    3             FIELD1.TEXT  = OUT$SYM.TEXT;

  11991  7 003712   000004 236100                    LDQ     4,,PR0
         7 003713   000033 772000                    QRL     27
         7 003714   000000 620006                    EAX0    0,QL
         7 003715   040100 100540                    MLR     fill='040'O
         7 003716   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         7 003717   200024 200037                    ADSC9   FIELD1,,AUTO             cn=1,n=31

      976    11992                  %SCREAM( ERR#=E$SECT_DOES_NOT_EXIST, F1=FIELD1, F2=OU_NAME );

  11999  7 003720   000000 236007 xsym               LDQ     M$DO,DL
         7 003721   000030 235000 8                  LDA     24
         7 003722   200072 452500                    STP2    @ARS+1,,AUTO
         7 003723   200073 756100                    STQ     @ARS+2,,AUTO
         7 003724   200072 236100                    LDQ     @ARS+1,,AUTO
         7 003725   000024 036003                    ADLQ    20,DU
         7 003726   200074 757100                    STAQ    @ARS+3,,AUTO
         7 003727   000030 235000 8                  LDA     24
         7 003730   200076 452500                    STP2    @ARS+5,,AUTO
         7 003731   200076 236100                    LDQ     @ARS+5,,AUTO
         7 003732   000014 036003                    ADLQ    12,DU
         7 003733   200100 757100                    STAQ    @ARS+7,,AUTO
         7 003734   200073 235100                    LDA     @ARS+2,,AUTO
         7 003735   200077 755100                    STA     @ARS+6,,AUTO
         7 003736   200074 237100                    LDAQ    @ARS+3,,AUTO
         7 003737   200102 757100                    STAQ    @ARS+9,,AUTO
         7 003740   200100 237100                    LDAQ    @ARS+7,,AUTO
         7 003741   200104 757100                    STAQ    @ARS+11,,AUTO
         7 003742   000021 236000 8                  LDQ     17
         7 003743   200114 756100                    STQ     @ARS+19,,AUTO
         7 003744   000020 236000 8                  LDQ     16
         7 003745   200113 756100                    STQ     @ARS+18,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:165  
         7 003746   200104 631500                    EPPR1   @ARS+11,,AUTO
         7 003747   200112 451500                    STP1    @ARS+17,,AUTO
         7 003750   200102 633500                    EPPR3   @ARS+9,,AUTO
         7 003751   200111 453500                    STP3    @ARS+16,,AUTO
         7 003752   200077 634500                    EPPR4   @ARS+6,,AUTO
         7 003753   200110 454500                    STP4    @ARS+15,,AUTO
         7 003754   000204 237000 8                  LDAQ    132
         7 003755   200106 757100                    STAQ    @ARS+13,,AUTO
         7 003756   200106 630500                    EPPR0   @ARS+13,,AUTO
         7 003757   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 003760   000000 701000 xent               TSX1    XUR$ERRMSG
         7 003761   000000 011000                    NOP     0

      977    12002    3             ALTRETURN;

  12002  7 003762   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 003763   000000 702211                    TSX2  ! 0,X1

      978    12003    3             END;
      979    12004    2        CALL CONCAT( TXT, 'SYMDEF ', P$NODE.SUBLK$(0)->OUT$SYM.TEXT, ' ', OUT$SYM.TEXT
             12004                  ) ;

  12004  7 003764   200003 470500                    LDP0    OUT$,,AUTO
         7 003765   000003 471500                    LDP1    3,,PR0
         7 003766   100004 236100                    LDQ     4,,PR1
         7 003767   000033 772000                    QRL     27
         7 003770   200006 473500                    LDP3    BLK$,,AUTO
         7 003771   000000 620006                    EAX0    0,QL
         7 003772   300004 236100                    LDQ     4,,PR3
         7 003773   000033 772000                    QRL     27
         7 003774   040000 100400                    MLR     fill='040'O
         7 003775   000230 000007 1                  ADSC9   FPT_GDS+28               cn=0,n=7
         7 003776   000437 000007 2                  ADSC9   TXT                      cn=0,n=7
         7 003777   040000 100540                    MLR     fill='040'O
         7 004000   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         7 004001   000440 600371 2                  ADSC9   TXT+1                    cn=3,n=249
         7 004002   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:166  
         7 004003   000000 636010                    EAQ     0,X0
         7 004004   000022 772000                    QRL     18
         7 004005   000371 116007                    CMPQ    249,DL
         7 004006   004030 603000 7                  TRC     s:12005
         7 004007   200072 740100                    STX0    @ARS+1,,AUTO
         7 004010   777406 620010                    EAX0    -250,X0
         7 004011   777777 660003                    ERX0    -1,DU
         7 004012   200072 235100                    LDA     @ARS+1,,AUTO
         7 004013   000022 771000                    ARL     18
         7 004014   040045 100400                    MLR     fill='040'O
         7 004015   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         7 004016   000440 600010 2                  ADSC9   TXT+1,A                  cn=3,n=*X0
         7 004017   200072 236100                    LDQ     @ARS+1,,AUTO
         7 004020   000022 772000                    QRL     18
         7 004021   000370 116007                    CMPQ    248,DL
         7 004022   004030 603000 7                  TRC     s:12005
         7 004023   777407 620006                    EAX0    -249,QL
         7 004024   777777 660003                    ERX0    -1,DU
         7 004025   040046 100540                    MLR     fill='040'O
         7 004026   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         7 004027   000441 000010 2                  ADSC9   TXT+2,Q                  cn=0,n=*X0

      980    12005    2         CNT = OUT$SYM.COUNT + P$NODE.SUBLK$(0)->OUT$SYM.COUNT + 8 ;

  12005  7 004030   000003 471500                    LDP1    3,,PR0
         7 004031   100004 236100                    LDQ     4,,PR1
         7 004032   000033 772000                    QRL     27
         7 004033   200072 756100                    STQ     @ARS+1,,AUTO
         7 004034   300004 236100                    LDQ     4,,PR3
         7 004035   000033 772000                    QRL     27
         7 004036   200072 036100                    ADLQ    @ARS+1,,AUTO
         7 004037   000010 036007                    ADLQ    8,DL
         7 004040   000537 756000 2                  STQ     CNT

      981    12006    2         CALL WRITE_PLOVER_REC       ALTRET( ALT );

  12006  7 004041   002324 701000 7                  TSX1    WRITE_PLOVER_REC
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:167  
         7 004042   004045 702000 7                  TSX2    ALT

      982    12007    2         RETURN;

  12007  7 004043   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 004044   000001 702211                    TSX2  ! 1,X1

      983    12008
      984    12009    2   ALT:  ALTRETURN;

  12009  7 004045   200054 221300       ALT          LDX1  ! FIELD3+8,,AUTO
         7 004046   000000 702211                    TSX2  ! 0,X1

      985    12010
      986    12011    2   END SYMDEF_COMMAND;
      987    12012        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:168  
      988    12013    1   GET_NUM_SECTS:   PROC    ALTRET;

  12013  7 004047   200056 741300       GET_NUM_SEC* STX1  ! COMP_UTS,,AUTO

      989    12014
      990    12015        %B$OUKEY( NAME=SECTION_KEY, STCLASS=STATIC );
      991    12051        %B$SECTION( STCLASS=BASED );
      992    12110        %FPT_GDS( RESULTS=GDSVEC, SEGSIZE=1024, STCLASS=CONSTANT );
      993    12126    2   DCL 1 GDSVEC STATIC DALIGNED,
      994    12127    2         2 BOUNDW UBIN HALF UNAL INIT(0),
      995    12128    2         2 * UBIN HALF UNAL INIT(0),
      996    12129    2         2 PTR$ PTR INIT( ADDR(NIL) );
      997    12130    2   DCL 1 BUFVEC STATIC DALIGNED,
      998    12131    2         2 BOUND UBIN(20) UNAL INIT(0),
      999    12132    2         2 * BIT(16) UNAL INIT('0'B),
     1000    12133    2         2 PTR$ PTR INIT( ADDR(NIL) );
     1001    12134    2   DCL ARS UBIN WORD;
     1002    12135
     1003    12136
     1004    12137    3         IF BUFVEC.PTR$ = ADDR(NIL) THEN DO;

  12137  7 004050   001127 236000 2                  LDQ     BUFVEC+1
         7 004051   000001 116000 xsym               CMPQ    B_VECTNIL+1
         7 004052   004061 601000 7                  TNZ     s:12141

     1005    12138    3             CALL M$GDS( FPT_GDS ) ALTRET( GDS_ERR );

  12138  7 004053   000174 630400 1                  EPPR0   FPT_GDS
         7 004054   430001 713400                    CLIMB   alt,gds
         7 004055   400400 401760                    pmme    nvectors=2
         7 004056   004130 702000 7                  TSX2    GDS_ERR

     1006    12139    3             BUFVEC = GDSVEC;

  12139  7 004057   001124 237000 2                  LDAQ    GDSVEC
         7 004060   001126 757000 2                  STAQ    BUFVEC

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:169  
     1007    12140    3             END;

     1008    12141    2         SECTION_KEY.UTS  = COMP_UTS;

  12141  7 004061   000000 100400                    MLR     fill='000'O
         7 004062   000433 000004 2                  ADSC9   COMP_UTS                 cn=0,n=4
         7 004063   001122 400004 2                  ADSC9   SECTION_KEY              cn=2,n=4

     1009    12142    2         SECTION_KEY.TYPE = %TYPSECT;

  12142  7 004064   003000 236007                    LDQ     1536,DL
         7 004065   001123 552010 2                  STBQ    SECTION_KEY+1,'10'O

     1010    12143    2         SECTION_KEY.PAGE = 0;

  12143  7 004066   000000 236003                    LDQ     0,DU
         7 004067   001123 552004 2                  STBQ    SECTION_KEY+1,'04'O

     1011    12144    2         NUM_SECTS = 0;

  12144  7 004070   000540 450000 2                  STZ     NUM_SECTS

     1012    12145    3         DO WHILE( '1'B );

     1013    12146    3             CALL READ_OU( VECTOR(SECTION_KEY), BUFVEC, ARS )

  12146  7 004071   200057 630500                    EPPR0   ARS,,AUTO
         7 004072   200071 450500                    STP0    @ARS,,AUTO
         7 004073   000210 236000 8                  LDQ     136
         7 004074   200070 756100                    STQ     @BUF_,,AUTO
         7 004075   000211 236000 8                  LDQ     137
         7 004076   200067 756100                    STQ     VAL,,AUTO
         7 004077   001202 701000 7                  TSX1    READ_OU
         7 004100   004111 702000 7                  TSX2    s:12152

     1014    12147    4             WHENRETURN DO;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:170  
     1015    12148    4                 NUM_SECTS = NUM_SECTS + ( ARS / SIZEC(B$SECTION) );

  12148  7 004101   200057 236100                    LDQ     ARS,,AUTO
         7 004102   000003 772000                    QRL     3
         7 004103   000540 036000 2                  ADLQ    NUM_SECTS
         7 004104   000540 756000 2                  STQ     NUM_SECTS

     1016    12149    4                 SECTION_KEY.PAGE = SECTION_KEY.PAGE + 1;

  12149  7 004105   001123 236000 2                  LDQ     SECTION_KEY+1
         7 004106   000001 036007                    ADLQ    1,DL
         7 004107   001123 552004 2                  STBQ    SECTION_KEY+1,'04'O

     1017    12150    4                 END;

  12150  7 004110   004166 710000 7                  TRA     s:12166

     1018    12151    4             WHENALTRETURN DO;

     1019    12152    4                 IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY THEN RETURN;

  12152  7 004111   000000 470400 xsym               LDP0    B$TCB$
         7 004112   000000 471500                    LDP1    0,,PR0
         7 004113   100102 236100                    LDQ     66,,PR1
         7 004114   377770 376007                    ANQ     131064,DL
         7 004115   001020 116007                    CMPQ    528,DL
         7 004116   004121 601000 7                  TNZ     s:12153

  12152  7 004117   200056 221300                    LDX1  ! COMP_UTS,,AUTO
         7 004120   000001 702211                    TSX2  ! 1,X1

     1020    12153    5                 IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$LD THEN DO;

  12153  7 004121   000070 116007                    CMPQ    56,DL
         7 004122   004152 601000 7                  TNZ     s:12162

     1021    12154    5                     CALL M$GDS( FPT_GDS )
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:171  

  12154  7 004123   000174 630400 1                  EPPR0   FPT_GDS
         7 004124   430001 713400                    CLIMB   alt,gds
         7 004125   400400 401760                    pmme    nvectors=2
         7 004126   004130 702000 7                  TSX2    GDS_ERR
         7 004127   004142 710000 7                  TRA     s:12159

     1022    12155    6                     WHENALTRETURN DO;

     1023    12156    6   GDS_ERR:              CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR );

  12156  7 004130   000000 470400 xsym  GDS_ERR      LDP0    B$TCB$
         7 004131   000000 471500                    LDP1    0,,PR0
         7 004132   100102 633500                    EPPR3   66,,PR1
         7 004133   200072 453500                    STP3    @ARS+1,,AUTO
         7 004134   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 004135   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 004136   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004137   000000 011000                    NOP     0

     1024    12157    6                         ALTRETURN;

  12157  7 004140   200056 221300                    LDX1  ! COMP_UTS,,AUTO
         7 004141   000000 702211                    TSX2  ! 0,X1

     1025    12158    6                         END;
     1026    12159    5                     BUFVEC.BOUND = BUFVEC.BOUND + 4096;

  12159  7 004142   001126 236000 2                  LDQ     BUFVEC
         7 004143   000020 772000                    QRL     16
         7 004144   010000 036007                    ADLQ    4096,DL
         7 004145   000020 736000                    QLS     16
         7 004146   001126 676000 2                  ERQ     BUFVEC
         7 004147   000034 376000 xsym               ANQ     B_VECTNIL+28
         7 004150   001126 656000 2                  ERSQ    BUFVEC

     1027    12160    5                     END;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:172  

  12160  7 004151   004166 710000 7                  TRA     s:12166

     1028    12161    5                 ELSE DO;

     1029    12162    5                     CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF) );

  12162  7 004152   000000 236007 xsym               LDQ     M$OF,DL
         7 004153   200072 756100                    STQ     @ARS+1,,AUTO
         7 004154   200072 633500                    EPPR3   @ARS+1,,AUTO
         7 004155   200075 453500                    STP3    @ARS+4,,AUTO
         7 004156   100102 634500                    EPPR4   66,,PR1
         7 004157   200074 454500                    STP4    @ARS+3,,AUTO
         7 004160   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 004161   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 004162   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004163   000000 011000                    NOP     0

     1030    12163    5                     ALTRETURN;

  12163  7 004164   200056 221300                    LDX1  ! COMP_UTS,,AUTO
         7 004165   000000 702211                    TSX2  ! 0,X1

     1031    12164    5                     END;
     1032    12165    4                 END;
     1033    12166    3             END;

  12166  7 004166   004071 710000 7                  TRA     s:12146

     1034    12167
     1035    12168    2   END GET_NUM_SECTS;
     1036    12169        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:173  
     1037    12170    1   ENTREF_COMMAND:  PROC ALTRET;

  12170  7 004167   200054 741300       ENTREF_COMM* STX1  ! FIELD3+8,,AUTO

     1038    12171
     1039    12172
     1040    12173    3         IF NOT OUF_ASSOCIATED THEN DO;

  12173  7 004170   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 004171   004214 604000 7                  TMI     s:12190

     1041    12174        /*    ERROR:  DPM-E$NO_FILE-C
     1042    12175              MESSAGE: No file named
     1043    12176              MESSAGE1: A command has been issued without a file open for PLOVERing
     1044    12177        */
     1045    12178                  %SCREAM( ERR#=E$NO_FILE );

  12185  7 004172   000000 236007 xsym               LDQ     M$DO,DL
         7 004173   200072 756100                    STQ     @ARS+1,,AUTO
         7 004174   000020 237000 8                  LDAQ    16
         7 004175   200100 757100                    STAQ    @ARS+7,,AUTO
         7 004176   000022 237000 8                  LDAQ    18
         7 004177   200076 757100                    STAQ    @ARS+5,,AUTO
         7 004200   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 004201   200075 450500                    STP0    @ARS+4,,AUTO
         7 004202   000021 236000 8                  LDQ     17
         7 004203   200074 756100                    STQ     @ARS+3,,AUTO
         7 004204   000064 236000 8                  LDQ     52
         7 004205   200073 756100                    STQ     @ARS+2,,AUTO
         7 004206   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 004207   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 004210   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004211   000000 011000                    NOP     0

     1046    12188    3             ALTRETURN;

  12188  7 004212   200054 221300                    LDX1  ! FIELD3+8,,AUTO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:174  
         7 004213   000000 702211                    TSX2  ! 0,X1

     1047    12189    3             END;
     1048    12190    3         IF NOT OU_ASSOCIATED THEN DO;

  12190  7 004214   000430 234000 2                  SZN     OU_ASSOCIATED
         7 004215   004240 604000 7                  TMI     s:12207

     1049    12191        /*    ERROR:  DPM-E$NO_OBJECT_UNIT-C
     1050    12192              MESSAGE: No object unit named.
     1051    12193              MESSAGE1: An object unit must be specified for this command.
     1052    12194        */
     1053    12195                  %SCREAM( ERR#=E$NO_OBJECT_UNIT );

  12202  7 004216   000000 236007 xsym               LDQ     M$DO,DL
         7 004217   200072 756100                    STQ     @ARS+1,,AUTO
         7 004220   000020 237000 8                  LDAQ    16
         7 004221   200100 757100                    STAQ    @ARS+7,,AUTO
         7 004222   000022 237000 8                  LDAQ    18
         7 004223   200076 757100                    STAQ    @ARS+5,,AUTO
         7 004224   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 004225   200075 450500                    STP0    @ARS+4,,AUTO
         7 004226   000021 236000 8                  LDQ     17
         7 004227   200074 756100                    STQ     @ARS+3,,AUTO
         7 004230   000103 236000 8                  LDQ     67
         7 004231   200073 756100                    STQ     @ARS+2,,AUTO
         7 004232   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 004233   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 004234   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004235   000000 011000                    NOP     0

     1054    12205    3             ALTRETURN;

  12205  7 004236   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 004237   000000 702211                    TSX2  ! 0,X1

     1055    12206    3             END;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:175  
     1056    12207    2         BLK$ = P$NODE.SUBLK$(0);

  12207  7 004240   200003 470500                    LDP0    OUT$,,AUTO
         7 004241   000003 236100                    LDQ     3,,PR0
         7 004242   200006 756100                    STQ     BLK$,,AUTO

     1057    12208    2         CALL CONCAT( TXT, 'ENTREF ', OUT$SYM.TEXT );

  12208  7 004243   200006 471500                    LDP1    BLK$,,AUTO
         7 004244   100004 236100                    LDQ     4,,PR1
         7 004245   000033 772000                    QRL     27
         7 004246   040000 100400                    MLR     fill='040'O
         7 004247   000232 000007 1                  ADSC9   FPT_GDS+30               cn=0,n=7
         7 004250   000437 000007 2                  ADSC9   TXT                      cn=0,n=7
         7 004251   000000 620006                    EAX0    0,QL
         7 004252   040000 100540                    MLR     fill='040'O
         7 004253   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         7 004254   000440 600371 2                  ADSC9   TXT+1                    cn=3,n=249

     1058    12209    2         CNT = OUT$SYM.COUNT + 7;

  12209  7 004255   200006 470500                    LDP0    BLK$,,AUTO
         7 004256   000004 236100                    LDQ     4,,PR0
         7 004257   000033 772000                    QRL     27
         7 004260   000007 036007                    ADLQ    7,DL
         7 004261   000537 756000 2                  STQ     CNT

     1059    12210    2         CALL WRITE_PLOVER_REC       ALTRET( ALT );

  12210  7 004262   002324 701000 7                  TSX1    WRITE_PLOVER_REC
         7 004263   004266 702000 7                  TSX2    ALT

     1060    12211    2         RETURN;

  12211  7 004264   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 004265   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:176  
     1061    12212
     1062    12213    2   ALT:  ALTRETURN;

  12213  7 004266   200054 221300       ALT          LDX1  ! FIELD3+8,,AUTO
         7 004267   000000 702211                    TSX2  ! 0,X1

     1063    12214
     1064    12215    2   END ENTREF_COMMAND;
     1065    12216        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:177  
     1066    12217    1   EXTERNAL_COMMAND:  PROC   ALTRET;

  12217  7 004270   200054 741300       EXTERNAL_CO* STX1  ! FIELD3+8,,AUTO

     1067    12218
     1068    12219    2   DCL PATCH_SPACE CHAR(3);
     1069    12220
     1070    12221
     1071    12222    3         IF NOT OUF_ASSOCIATED THEN DO;

  12222  7 004271   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 004272   004315 604000 7                  TMI     s:12235

     1072    12223                  %SCREAM( ERR#=E$NO_FILE);

  12230  7 004273   000000 236007 xsym               LDQ     M$DO,DL
         7 004274   200072 756100                    STQ     @ARS+1,,AUTO
         7 004275   000020 237000 8                  LDAQ    16
         7 004276   200100 757100                    STAQ    @ARS+7,,AUTO
         7 004277   000022 237000 8                  LDAQ    18
         7 004300   200076 757100                    STAQ    @ARS+5,,AUTO
         7 004301   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 004302   200075 450500                    STP0    @ARS+4,,AUTO
         7 004303   000021 236000 8                  LDQ     17
         7 004304   200074 756100                    STQ     @ARS+3,,AUTO
         7 004305   000064 236000 8                  LDQ     52
         7 004306   200073 756100                    STQ     @ARS+2,,AUTO
         7 004307   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 004310   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 004311   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004312   000000 011000                    NOP     0

     1073    12233    3             ALTRETURN;

  12233  7 004313   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 004314   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:178  
     1074    12234    3             END;
     1075    12235    3         IF NOT OU_ASSOCIATED THEN DO;

  12235  7 004315   000430 234000 2                  SZN     OU_ASSOCIATED
         7 004316   004341 604000 7                  TMI     s:12248

     1076    12236                  %SCREAM( ERR#=E$NO_OBJECT_UNIT );

  12243  7 004317   000000 236007 xsym               LDQ     M$DO,DL
         7 004320   200072 756100                    STQ     @ARS+1,,AUTO
         7 004321   000020 237000 8                  LDAQ    16
         7 004322   200100 757100                    STAQ    @ARS+7,,AUTO
         7 004323   000022 237000 8                  LDAQ    18
         7 004324   200076 757100                    STAQ    @ARS+5,,AUTO
         7 004325   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 004326   200075 450500                    STP0    @ARS+4,,AUTO
         7 004327   000021 236000 8                  LDQ     17
         7 004330   200074 756100                    STQ     @ARS+3,,AUTO
         7 004331   000103 236000 8                  LDQ     67
         7 004332   200073 756100                    STQ     @ARS+2,,AUTO
         7 004333   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 004334   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 004335   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004336   000000 011000                    NOP     0

     1077    12246    3             ALTRETURN;

  12246  7 004337   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 004340   000000 702211                    TSX2  ! 0,X1

     1078    12247    3             END;
     1079    12248    3         IF P$NODE.SUBLK$(1)->OUT$SYM.CODE = IPATCH_VAL THEN DO;

  12248  7 004341   200003 470500                    LDP0    OUT$,,AUTO
         7 004342   000004 471500                    LDP1    4,,PR0
         7 004343   100000 720100                    LXL0    0,,PR1
         7 004344   000315 100003                    CMPX0   205,DU
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:179  
         7 004345   004373 601000 7                  TNZ     s:12255

     1080    12249    3             PATCH_SPACE = ' @,';

  12249  7 004346   000234 236000 1                  LDQ     FPT_GDS+32
         7 004347   000212 376000 8                  ANQ     138
         7 004350   000040 276007                    ORQ     32,DL
         7 004351   200055 756100                    STQ     PATCH_SPACE,,AUTO

     1081    12250    3             CALL CHARBIN (CNT, P$NODE.SUBLK$(2)->OUT$SYM.TEXT);

  12250  7 004352   000005 473500                    LDP3    5,,PR0
         7 004353   300004 236100                    LDQ     4,,PR3
         7 004354   000033 772000                    QRL     27
         7 004355   000000 622006                    EAX2    0,QL
         7 004356   000000 305540                    DTB
         7 004357   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         7 004360   000537 000004 2                  NDSC9   CNT                      cn=0,s=lsgnf,sf=0,n=4

     1082    12251    3             PLOVER_BIRTH.IPATCH = PLOVER_BIRTH.IPATCH + CNT;

  12251  7 004361   000410 236000 2                  LDQ     PLOVER_BIRTH+11
         7 004362   000537 036000 2                  ADLQ    CNT
         7 004363   000410 756000 2                  STQ     PLOVER_BIRTH+11

     1083    12252    3            CALL WRITE_OU (VECTOR(PLOVER_BIRTH_KEY),VECTOR(PLOVER_BIRTH)) ALTRET (ALT)
             12252                      ;

  12252  7 004364   000112 236000 8                  LDQ     74
         7 004365   200062 756100                    STQ     READ_BLK$,,AUTO
         7 004366   000113 236000 8                  LDQ     75
         7 004367   200061 756100                    STQ     COUNT,,AUTO
         7 004370   001257 701000 7                  TSX1    WRITE_OU
         7 004371   004501 702000 7                  TSX2    ALT

     1084    12253    3             END;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:180  
  12253  7 004372   004417 710000 7                  TRA     s:12260

     1085    12254    3         ELSE DO;

     1086    12255    3             PATCH_SPACE = ' #,';

  12255  7 004373   000235 236000 1                  LDQ     FPT_GDS+33
         7 004374   000212 376000 8                  ANQ     138
         7 004375   000040 276007                    ORQ     32,DL
         7 004376   200055 756100                    STQ     PATCH_SPACE,,AUTO

     1087    12256    3             CALL CHARBIN (CNT, P$NODE.SUBLK$(2)->OUT$SYM.TEXT);

  12256  7 004377   000005 473500                    LDP3    5,,PR0
         7 004400   300004 236100                    LDQ     4,,PR3
         7 004401   000033 772000                    QRL     27
         7 004402   000000 622006                    EAX2    0,QL
         7 004403   000000 305540                    DTB
         7 004404   300004 230012                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X2
         7 004405   000537 000004 2                  NDSC9   CNT                      cn=0,s=lsgnf,sf=0,n=4

     1088    12257    3             PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + CNT;

  12257  7 004406   000411 236000 2                  LDQ     PLOVER_BIRTH+12
         7 004407   000537 036000 2                  ADLQ    CNT
         7 004410   000411 756000 2                  STQ     PLOVER_BIRTH+12

     1089    12258    3            CALL WRITE_OU (VECTOR(PLOVER_BIRTH_KEY),VECTOR(PLOVER_BIRTH)) ALTRET (ALT)
             12258                      ;

  12258  7 004411   000112 236000 8                  LDQ     74
         7 004412   200062 756100                    STQ     READ_BLK$,,AUTO
         7 004413   000113 236000 8                  LDQ     75
         7 004414   200061 756100                    STQ     COUNT,,AUTO
         7 004415   001257 701000 7                  TSX1    WRITE_OU
         7 004416   004501 702000 7                  TSX2    ALT

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:181  
     1090    12259    3             END;

     1091    12260    2         CALL CONCAT( TXT, 'EXTERNAL ', P$NODE.SUBLK$(0)->OUT$SYM.TEXT,

  12260  7 004417   200003 470500                    LDP0    OUT$,,AUTO
         7 004420   000003 471500                    LDP1    3,,PR0
         7 004421   100004 236100                    LDQ     4,,PR1
         7 004422   000033 772000                    QRL     27
         7 004423   000005 473500                    LDP3    5,,PR0
         7 004424   000000 620006                    EAX0    0,QL
         7 004425   300004 236100                    LDQ     4,,PR3
         7 004426   000033 772000                    QRL     27
         7 004427   040000 100400                    MLR     fill='040'O
         7 004430   000236 000011 1                  ADSC9   FPT_GDS+34               cn=0,n=9
         7 004431   000437 000011 2                  ADSC9   TXT                      cn=0,n=9
         7 004432   040000 100540                    MLR     fill='040'O
         7 004433   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         7 004434   000441 200367 2                  ADSC9   TXT+2                    cn=1,n=247
         7 004435   000000 621006                    EAX1    0,QL
         7 004436   000000 636010                    EAQ     0,X0
         7 004437   000022 772000                    QRL     18
         7 004440   000367 116007                    CMPQ    247,DL
         7 004441   004463 603000 7                  TRC     s:12262
         7 004442   200072 740100                    STX0    @ARS+1,,AUTO
         7 004443   777410 620010                    EAX0    -248,X0
         7 004444   777777 660003                    ERX0    -1,DU
         7 004445   200072 235100                    LDA     @ARS+1,,AUTO
         7 004446   000022 771000                    ARL     18
         7 004447   040045 100500                    MLR     fill='040'O
         7 004450   200055 000003                    ADSC9   PATCH_SPACE,,AUTO        cn=0,n=3
         7 004451   000441 200010 2                  ADSC9   TXT+2,A                  cn=1,n=*X0
         7 004452   200072 236100                    LDQ     @ARS+1,,AUTO
         7 004453   000022 772000                    QRL     18
         7 004454   000364 116007                    CMPQ    244,DL
         7 004455   004463 603000 7                  TRC     s:12262
         7 004456   777413 620006                    EAX0    -245,QL
         7 004457   777777 660003                    ERX0    -1,DU
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:182  
         7 004460   040046 100540                    MLR     fill='040'O
         7 004461   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         7 004462   000442 000010 2                  ADSC9   TXT+3,Q                  cn=0,n=*X0

     1092    12261    2                 PATCH_SPACE, P$NODE.SUBLK$(2)->OUT$SYM.TEXT );
     1093    12262    2         CNT = P$NODE.SUBLK$(0)->OUT$SYM.COUNT + P$NODE.SUBLK$(2)->OUT$SYM.COUNT + 12;

  12262  7 004463   000003 471500                    LDP1    3,,PR0
         7 004464   000005 473500                    LDP3    5,,PR0
         7 004465   300004 236100                    LDQ     4,,PR3
         7 004466   000033 772000                    QRL     27
         7 004467   200072 756100                    STQ     @ARS+1,,AUTO
         7 004470   100004 236100                    LDQ     4,,PR1
         7 004471   000033 772000                    QRL     27
         7 004472   200072 036100                    ADLQ    @ARS+1,,AUTO
         7 004473   000014 036007                    ADLQ    12,DL
         7 004474   000537 756000 2                  STQ     CNT

     1094    12263    2         CALL WRITE_PLOVER_REC       ALTRET( ALT );

  12263  7 004475   002324 701000 7                  TSX1    WRITE_PLOVER_REC
         7 004476   004501 702000 7                  TSX2    ALT

     1095    12264    2         RETURN;

  12264  7 004477   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 004500   000001 702211                    TSX2  ! 1,X1

     1096    12265
     1097    12266    2   ALT:  ALTRETURN;

  12266  7 004501   200054 221300       ALT          LDX1  ! FIELD3+8,,AUTO
         7 004502   000000 702211                    TSX2  ! 0,X1

     1098    12267
     1099    12268    2   END EXTERNAL_COMMAND;
     1100    12269        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:183  
     1101    12270    1   READ_COMMAND:  PROC( PTR$ )  ALTRET;

  12270  7 004503   200064 741300       READ_COMMAND STX1  ! @BUF_,,AUTO

     1102    12271
     1103    12272    2   DCL PTR$ PTR;
     1104    12273
     1105    12274        %FPT_OPEN( DCB=M$SI, FUN=IN, SCRUB=YES );
     1106    12383        %FPT_FID( NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS, SN=VLP_SN, WSN=VLP_WSN,
     1107    12384                  ASN=FPT_OPEN.V.ASN#, RES=FPT_OPEN.V.RES#, RESULTS=VLR_FID );
     1108    12407
     1109    12408
     1110    12409    2         BLK$ = PTR$;

  12409  7 004504   200065 470500                    LDP0    @PTR$,,AUTO
         7 004505   000000 236100                    LDQ     0,,PR0
         7 004506   200006 756100                    STQ     BLK$,,AUTO

     1111    12410    2         FPT_FID.TEXTFID_ = VECTOR( OUT$SYM.TEXT );

  12410  7 004507   200006 471500                    LDP1    BLK$,,AUTO
         7 004510   100004 236100                    LDQ     4,,PR1
         7 004511   000033 772000                    QRL     27
         7 004512   000064 737000                    LLS     52
         7 004513   000140 135007                    SBLA    96,DL
         7 004514   200006 236100                    LDQ     BLK$,,AUTO
         7 004515   000026 036000 8                  ADLQ    22
         7 004516   001224 757000 2                  STAQ    FPT_FID+2

     1112    12411    2         CALL M$FID( FPT_FID ) ALTRET( FID_ERR );

  12411  7 004517   001222 630400 2                  EPPR0   FPT_FID
         7 004520   420001 713400                    CLIMB   alt,+8193
         7 004521   404400 401760                    pmme    nvectors=10
         7 004522   004612 702000 7                  TSX2    FID_ERR

     1113    12412    2         IF VLR_FID.NAME THEN
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:184  

  12412  7 004523   000036 234000 2                  SZN     VLR_FID
         7 004524   004530 605000 7                  TPL     s:12415

     1114    12413    2             FPT_OPEN.NAME_ = VECTOR(VLP_NAME);

  12413  7 004525   000030 237000 8                  LDAQ    24
         7 004526   001136 757000 2                  STAQ    FPT_OPEN+6
         7 004527   004532 710000 7                  TRA     s:12416

     1115    12414    2         ELSE
     1116    12415    2             FPT_OPEN.NAME_ = VECTOR(NIL);

  12415  7 004530   000016 237000 8                  LDAQ    14
         7 004531   001136 757000 2                  STAQ    FPT_OPEN+6

     1117    12416    2         IF VLR_FID.ACCT THEN

  12416  7 004532   000036 236000 2                  LDQ     VLR_FID
         7 004533   200000 316003                    CANQ    65536,DU
         7 004534   004540 600000 7                  TZE     s:12419

     1118    12417    2             FPT_OPEN.ACCT_ = VECTOR(VLP_ACCT);

  12417  7 004535   000032 237000 8                  LDAQ    26
         7 004536   001154 757000 2                  STAQ    FPT_OPEN+20
         7 004537   004542 710000 7                  TRA     s:12420

     1119    12418    2         ELSE
     1120    12419    2             FPT_OPEN.ACCT_ = VECTOR(NIL);

  12419  7 004540   000016 237000 8                  LDAQ    14
         7 004541   001154 757000 2                  STAQ    FPT_OPEN+20

     1121    12420    2         IF VLR_FID.PASS THEN

  12420  7 004542   000036 236000 2                  LDQ     VLR_FID
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:185  
         7 004543   100000 316003                    CANQ    32768,DU
         7 004544   004550 600000 7                  TZE     s:12423

     1122    12421    2             FPT_OPEN.PASS_ = VECTOR(VLP_PASS);

  12421  7 004545   000034 237000 8                  LDAQ    28
         7 004546   001140 757000 2                  STAQ    FPT_OPEN+8
         7 004547   004552 710000 7                  TRA     s:12424

     1123    12422    2         ELSE
     1124    12423    2             FPT_OPEN.PASS_ = VECTOR(NIL);

  12423  7 004550   000016 237000 8                  LDAQ    14
         7 004551   001140 757000 2                  STAQ    FPT_OPEN+8

     1125    12424    2         IF VLR_FID.SN THEN

  12424  7 004552   000036 236000 2                  LDQ     VLR_FID
         7 004553   040000 316003                    CANQ    16384,DU
         7 004554   004560 600000 7                  TZE     s:12427

     1126    12425    2             FPT_OPEN.SN_ = VECTOR(VLP_SN);

  12425  7 004555   000036 237000 8                  LDAQ    30
         7 004556   001132 757000 2                  STAQ    FPT_OPEN+2
         7 004557   004562 710000 7                  TRA     s:12428

     1127    12426    2         ELSE
     1128    12427    2             FPT_OPEN.SN_ = VECTOR(NIL);

  12427  7 004560   000016 237000 8                  LDAQ    14
         7 004561   001132 757000 2                  STAQ    FPT_OPEN+2

     1129    12428    2         IF VLR_FID.WSN THEN

  12428  7 004562   000036 236000 2                  LDQ     VLR_FID
         7 004563   020000 316003                    CANQ    8192,DU
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:186  
         7 004564   004570 600000 7                  TZE     s:12431

     1130    12429    2             FPT_OPEN.WSN_ = VECTOR(VLP_WSN);

  12429  7 004565   000040 237000 8                  LDAQ    32
         7 004566   001162 757000 2                  STAQ    FPT_OPEN+26
         7 004567   004572 710000 7                  TRA     s:12432

     1131    12430    2         ELSE
     1132    12431    2             FPT_OPEN.WSN_ = VECTOR(NIL);

  12431  7 004570   000016 237000 8                  LDAQ    14
         7 004571   001162 757000 2                  STAQ    FPT_OPEN+26

     1133    12432    2         IF M$SI$->F$DCB.FCD# THEN CALL M$CLOSE(CLOSE_SI) ALTRET(OPEN_FILE);

  12432  7 004572   200005 470500                    LDP0    M$SI$,,AUTO
         7 004573   000031 236100                    LDQ     25,,PR0
         7 004574   020000 316007                    CANQ    8192,DL
         7 004575   004602 600000 7                  TZE     OPEN_FILE

  12432  7 004576   000052 630400 1                  EPPR0   CLOSE_SI
         7 004577   450001 713400                    CLIMB   alt,close
         7 004600   406000 401760                    pmme    nvectors=13
         7 004601   004602 702000 7                  TSX2    OPEN_FILE

     1134    12433    2   OPEN_FILE:
     1135    12434    2         CALL M$OPEN( FPT_OPEN ) ALTRET( OPEN_ERR );

  12434  7 004602   001130 630400 2     OPEN_FILE    EPPR0   FPT_OPEN
         7 004603   450000 713400                    CLIMB   alt,open
         7 004604   410400 401760                    pmme    nvectors=18
         7 004605   004623 702000 7                  TSX2    OPEN_ERR

     1136    12435    2         READ_FILE = '1'B;

  12435  7 004606   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:187  
         7 004607   000427 756000 2                  STQ     READ_FILE

     1137    12436    2         RETURN;

  12436  7 004610   200064 221300                    LDX1  ! @BUF_,,AUTO
         7 004611   000001 702211                    TSX2  ! 1,X1

     1138    12437
     1139    12438    2   FID_ERR:
     1140    12439    2         CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR );

  12439  7 004612   000000 470400 xsym  FID_ERR      LDP0    B$TCB$
         7 004613   000000 471500                    LDP1    0,,PR0
         7 004614   100102 633500                    EPPR3   66,,PR1
         7 004615   200072 453500                    STP3    @ARS+1,,AUTO
         7 004616   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 004617   000017 631400 xsym               EPPR1   B_VECTNIL+15
         7 004620   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004621   000000 011000                    NOP     0

     1141    12440
     1142    12441    3         DO WHILE( '0'B );

  12441  7 004622   004637 710000 7                  TRA     s:12445

     1143    12442    3   OPEN_ERR: CALL XUR$ERRMSG( B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$SI) );

  12442  7 004623   000000 470400 xsym  OPEN_ERR     LDP0    B$TCB$
         7 004624   000000 471500                    LDP1    0,,PR0
         7 004625   000000 236007 xsym               LDQ     M$SI,DL
         7 004626   200072 756100                    STQ     @ARS+1,,AUTO
         7 004627   200072 633500                    EPPR3   @ARS+1,,AUTO
         7 004630   200075 453500                    STP3    @ARS+4,,AUTO
         7 004631   100102 634500                    EPPR4   66,,PR1
         7 004632   200074 454500                    STP4    @ARS+3,,AUTO
         7 004633   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 004634   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:188  
         7 004635   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004636   000000 011000                    NOP     0

     1144    12443    3             END;

     1145    12444
     1146    12445    2         NUM_ERRORS = NUM_ERRORS + 1;

  12445  7 004637   000432 054000 2                  AOS     NUM_ERRORS

     1147    12446    2         ALTRETURN;

  12446  7 004640   200064 221300                    LDX1  ! @BUF_,,AUTO
         7 004641   000000 702211                    TSX2  ! 0,X1

     1148    12447
     1149    12448    2   END READ_COMMAND;
     1150    12449        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:189  
     1151    12450    1   IDPATCH_COMMAND: PROC (PTR$,CODE) ALTRET;

  12450  7 004642   200054 741300       IDPATCH_COM* STX1  ! FIELD3+8,,AUTO

     1152    12451
     1153    12452    2   DCL PTR$ PTR;
     1154    12453    2   DCL CODE SBIN;
     1155    12454    2   DCL TEMP SBIN;
     1156    12455
     1157    12456    3          IF NOT OUF_ASSOCIATED THEN DO;

  12456  7 004643   000431 234000 2                  SZN     OUF_ASSOCIATED
         7 004644   004667 604000 7                  TMI     s:12475

     1158    12457        /*     ERROR: DPM-E$NO_FILE-C
     1159    12458               MESSAGE: No file named
     1160    12459               MESSAGE1: A command has been isuued without a file open for PLOVERing
     1161    12460                   PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + TEMP;
     1162    12461                   END;
     1163    12462        */
     1164    12463                   %SCREAM( ERR#=E$NO_FILE );

  12470  7 004645   000000 236007 xsym               LDQ     M$DO,DL
         7 004646   200072 756100                    STQ     @ARS+1,,AUTO
         7 004647   000020 237000 8                  LDAQ    16
         7 004650   200100 757100                    STAQ    @ARS+7,,AUTO
         7 004651   000022 237000 8                  LDAQ    18
         7 004652   200076 757100                    STAQ    @ARS+5,,AUTO
         7 004653   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 004654   200075 450500                    STP0    @ARS+4,,AUTO
         7 004655   000021 236000 8                  LDQ     17
         7 004656   200074 756100                    STQ     @ARS+3,,AUTO
         7 004657   000064 236000 8                  LDQ     52
         7 004660   200073 756100                    STQ     @ARS+2,,AUTO
         7 004661   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 004662   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 004663   000000 701000 xent               TSX1    XUR$ERRMSG
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:190  
         7 004664   000000 011000                    NOP     0

     1165    12473    3              ALTRETURN;

  12473  7 004665   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 004666   000000 702211                    TSX2  ! 0,X1

     1166    12474    3              END;
     1167    12475    3          IF NOT OU_ASSOCIATED THEN DO;

  12475  7 004667   000430 234000 2                  SZN     OU_ASSOCIATED
         7 004670   004713 604000 7                  TMI     s:12493

     1168    12476        /*     ERROR: DPM-E$NO_OBJECT_UNIT-C
     1169    12477               MESSAGE: No object unit named
     1170    12478               MESSAGE1: An object unit must be specified for this command.
     1171    12479        */
     1172    12480                   %SCREAM( ERR#=E$NO_OBJECT_UNIT );

  12487  7 004671   000000 236007 xsym               LDQ     M$DO,DL
         7 004672   200072 756100                    STQ     @ARS+1,,AUTO
         7 004673   000020 237000 8                  LDAQ    16
         7 004674   200100 757100                    STAQ    @ARS+7,,AUTO
         7 004675   000022 237000 8                  LDAQ    18
         7 004676   200076 757100                    STAQ    @ARS+5,,AUTO
         7 004677   200072 630500                    EPPR0   @ARS+1,,AUTO
         7 004700   200075 450500                    STP0    @ARS+4,,AUTO
         7 004701   000021 236000 8                  LDQ     17
         7 004702   200074 756100                    STQ     @ARS+3,,AUTO
         7 004703   000103 236000 8                  LDQ     67
         7 004704   200073 756100                    STQ     @ARS+2,,AUTO
         7 004705   200073 630500                    EPPR0   @ARS+2,,AUTO
         7 004706   000025 631400 xsym               EPPR1   B_VECTNIL+21
         7 004707   000000 701000 xent               TSX1    XUR$ERRMSG
         7 004710   000000 011000                    NOP     0

     1173    12490    3              ALTRETURN;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:191  

  12490  7 004711   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 004712   000000 702211                    TSX2  ! 0,X1

     1174    12491    3              END;
     1175    12492
     1176    12493    3          DO CASE (CODE);

  12493  7 004713   200056 470500                    LDP0    @CODE,,AUTO
         7 004714   000000 235100                    LDA     0,,PR0
         7 004715   000034 135007                    SBLA    28,DL
         7 004716   000003 115007                    CMPA    3,DL
         7 004717   004721 602005 7                  TNC     s:12493+6,AL
         7 004720   005000 710000 7                  TRA     s:12518
         7 004721   004745 710000 7                  TRA     s:12508
         7 004722   004745 710000 7                  TRA     s:12508
         7 004723   004724 710000 7                  TRA     s:12495

     1177    12494    3             CASE (RESET_VAL);

     1178    12495    4                IF P$NODE.NSUBLKS ~= 0 THEN DO;

  12495  7 004724   200003 471500                    LDP1    OUT$,,AUTO
         7 004725   100001 220100                    LDX0    1,,PR1
         7 004726   004742 600000 7                  TZE     s:12503

     1179    12496    4                   OUT$ = PTR$;

  12496  7 004727   200055 473500                    LDP3    @PTR$,,AUTO
         7 004730   300000 236100                    LDQ     0,,PR3
         7 004731   200003 756100                    STQ     OUT$,,AUTO

     1180    12497    4                   IF P$NODE.CODE = RIPATCH_VAL THEN

  12497  7 004732   200003 471500                    LDP1    OUT$,,AUTO
         7 004733   100000 720100                    LXL0    0,,PR1
         7 004734   000324 100003                    CMPX0   212,DU
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:192  
         7 004735   004740 601000 7                  TNZ     s:12500

     1181    12498    4                      PLOVER_BIRTH.IPATCH = 0;

  12498  7 004736   000410 450000 2                  STZ     PLOVER_BIRTH+11
         7 004737   005000 710000 7                  TRA     s:12518

     1182    12499    4                   ELSE
     1183    12500    4                      PLOVER_BIRTH.DPATCH = 0;

  12500  7 004740   000411 450000 2                  STZ     PLOVER_BIRTH+12

     1184    12501    4                   END;

  12501  7 004741   005000 710000 7                  TRA     s:12518

     1185    12502    4                ELSE DO;

     1186    12503    4                   PLOVER_BIRTH.IPATCH = 0;

  12503  7 004742   000410 450000 2                  STZ     PLOVER_BIRTH+11

     1187    12504    4                   PLOVER_BIRTH.DPATCH = 0;

  12504  7 004743   000411 450000 2                  STZ     PLOVER_BIRTH+12

     1188    12505    4                   END;

  12505  7 004744   005000 710000 7                  TRA     s:12518

     1189    12506
     1190    12507    3             CASE (IPTCH_VAL, DPTCH_VAL);

     1191    12508    3                BLK$ = PTR$;

  12508  7 004745   200055 471500                    LDP1    @PTR$,,AUTO
         7 004746   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:193  
         7 004747   200006 756100                    STQ     BLK$,,AUTO

     1192    12509    4                IF CODE = IPTCH_VAL THEN DO;

  12509  7 004750   000000 235100                    LDA     0,,PR0
         7 004751   000034 115007                    CMPA    28,DL
         7 004752   004766 601000 7                  TNZ     s:12514

     1193    12510    4                   CALL CHARBIN (TEMP, OUT$SYM.TEXT);

  12510  7 004753   200006 473500                    LDP3    BLK$,,AUTO
         7 004754   300004 236100                    LDQ     4,,PR3
         7 004755   000033 772000                    QRL     27
         7 004756   000000 620006                    EAX0    0,QL
         7 004757   000100 305540                    DTB
         7 004760   300004 230010                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
         7 004761   200057 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4

     1194    12511    4                   PLOVER_BIRTH.IPATCH = PLOVER_BIRTH.IPATCH + TEMP;

  12511  7 004762   000410 236000 2                  LDQ     PLOVER_BIRTH+11
         7 004763   200057 036100                    ADLQ    TEMP,,AUTO
         7 004764   000410 756000 2                  STQ     PLOVER_BIRTH+11

     1195    12512    4                   END;

  12512  7 004765   005000 710000 7                  TRA     s:12518

     1196    12513    4                ELSE DO;

     1197    12514    4                   CALL CHARBIN (TEMP, OUT$SYM.TEXT);

  12514  7 004766   200006 473500                    LDP3    BLK$,,AUTO
         7 004767   300004 236100                    LDQ     4,,PR3
         7 004770   000033 772000                    QRL     27
         7 004771   000000 620006                    EAX0    0,QL
         7 004772   000100 305540                    DTB
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:194  
         7 004773   300004 230010                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
         7 004774   200057 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4

     1198    12515    4                   PLOVER_BIRTH.DPATCH = PLOVER_BIRTH.DPATCH + TEMP;

  12515  7 004775   000411 236000 2                  LDQ     PLOVER_BIRTH+12
         7 004776   200057 036100                    ADLQ    TEMP,,AUTO
         7 004777   000411 756000 2                  STQ     PLOVER_BIRTH+12

     1199    12516    4                   END;

     1200    12517    3                END;

     1201    12518    2          CALL WRITE_OU (VECTOR(PLOVER_BIRTH_KEY),VECTOR(PLOVER_BIRTH)) ALTRET (ALTR);

  12518  7 005000   000112 236000 8                  LDQ     74
         7 005001   200062 756100                    STQ     READ_BLK$,,AUTO
         7 005002   000113 236000 8                  LDQ     75
         7 005003   200061 756100                    STQ     COUNT,,AUTO
         7 005004   001257 701000 7                  TSX1    WRITE_OU
         7 005005   005010 702000 7                  TSX2    ALTR

     1202    12519    2          RETURN;

  12519  7 005006   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 005007   000001 702211                    TSX2  ! 1,X1

     1203    12520
     1204    12521    2   ALTR:  CALL XUR$ERRMSG(B$TCB.ALT$->B$ALT.ERR, DCBNUM(M$OF));

  12521  7 005010   000000 470400 xsym  ALTR         LDP0    B$TCB$
         7 005011   000000 471500                    LDP1    0,,PR0
         7 005012   000000 236007 xsym               LDQ     M$OF,DL
         7 005013   200072 756100                    STQ     @ARS+1,,AUTO
         7 005014   200072 633500                    EPPR3   @ARS+1,,AUTO
         7 005015   200075 453500                    STP3    @ARS+4,,AUTO
         7 005016   100102 634500                    EPPR4   66,,PR1
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:195  
         7 005017   200074 454500                    STP4    @ARS+3,,AUTO
         7 005020   200074 630500                    EPPR0   @ARS+3,,AUTO
         7 005021   000020 631400 xsym               EPPR1   B_VECTNIL+16
         7 005022   000000 701000 xent               TSX1    XUR$ERRMSG
         7 005023   000000 011000                    NOP     0

     1205    12522    2          ALTRETURN;

  12522  7 005024   200054 221300                    LDX1  ! FIELD3+8,,AUTO
         7 005025   000000 702211                    TSX2  ! 0,X1

     1206    12523
     1207    12524    2   END IDPATCH_COMMAND;
     1208    12525        %EJECT;
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:196  
     1209    12526    1   END DPM$PLOVER;

  12526  7 005026   000000 702200 xent               TSX2  ! X66_MARET
     1210    12527        %EOD;

PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:197  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XUR_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XUF_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DP_MACRO_C.:E05TOU  is referenced.
   DP_PERR_C.:E05TOU  is referenced.
   DP_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DPM$PLOVER.
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:198  

 **** Variables and constants ****

  ****  Section 001 RoData DPM$PLOVER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    52-0-0/d STRC(1080)  r     1 CLOSE_SI                 136-0-0/c CHAR(20)    r     1 CREATION_UTS_FMT
   162-0-0/c CHAR(23)    r     1 DPATCH_FMT               170-0-0/c CHAR(9)     r     1 FMT
   174-0-0/d STRC(216)   r     1 FPT_GDS                    6-0-0/d STRC(432)   r     1 GET_PLOVER_UTS
   154-0-0/c CHAR(23)    r     1 IPATCH_FMT               120-0-0/w UBIN        r     1 MAX(0:6)
   131-0-0/c CHAR(17)    r     1 OU_FMT                   117-0-0/w PTR         r     1 OU_KEY$
   110-0-0/c STRC(63)    r     1 PLOVER                   143-0-0/c CHAR(33)    r     1 PLOVERED_UTS_FMT
   115-0-0/c CHAR(2)     r     1 PROMPT                   127-0-0/c CHAR        r     1 SEP(0:6)
     0-0-0/d STRC(216)   r     1 SET_STEPCC_TO_4          112-0-0/c STRC(72)    r     1 SYS_ACCT
    22-0-0/d STRC(432)   r     1 TIME_UTS                 116-0-0/w PTR         r     1 TXT$
   114-0-0/w EPTR        r     1 U$$                       36-0-0/d STRC(432)   r     1 UTS_TIME

  ****  Section 002  Data  DPM$PLOVER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1126-0-0/d STRC(72)    r     1 BUFVEC                   436-0-0/w SBIN        r     1 CMD
   537-0-0/w SBIN        r     1 CNT                      433-0-0/w UBIN        r     1 COMP_UTS
   414-0-0/c CHAR(8)     r     1 DATE                     421-0-0/c CHAR(21)    r     1 DATE_TIME
   742-0-0/d STRC(1080)  r     1 FPT_CLOSE               1100-0-0/d STRC(360)   r     1 FPT_DELREC
  1000-0-0/d STRC(864)   r     1 FPT_FID                 1222-0-0/d STRC(864)   r     1 FPT_FID
   542-0-0/d STRC(2088)  r     1 FPT_OPEN                 650-0-0/d STRC(2088)  r     1 FPT_OPEN
  1130-0-0/d STRC(2088)  r     1 FPT_OPEN                1030-0-0/d STRC(504)   r     1 FPT_READ
  1046-0-0/d STRC(504)   r     1 FPT_READ                 634-0-0/d STRC(432)   r     1 FPT_WRITE
  1064-0-0/d STRC(432)   r     1 FPT_WRITE                 50-0-0/w STRC(1080)  r     1 F_FDS
  1124-0-0/d STRC(72)    r     1 GDSVEC                   323-0-0/w STRC(297)   r     1 HEAD_KEY
   340-0-0/w STRC(1044)  r     1 HEAD_RECORD             1112-0-0/w STRC(117)   r     1 KEY1
  1116-0-0/w STRC(117)   r     1 KEY2                     432-0-0/w SBIN        r     1 NUM_ERRORS
   540-0-0/w SBIN        r     1 NUM_SECTS                431-0-0/b BIT         r     1 OUF_ASSOCIATED
   106-0-0/c CHAR(80)    r     1 OUT_BUF                  430-0-0/b BIT         r     1 OU_ASSOCIATED
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:199  
   312-0-0/w STRC(297)   r     1 OU_KEY                   375-0-0/w STRC(468)   r     1 PLOVER_BIRTH
   541-0-0/w UBIN        r     1 PLOVER_BIRTH_ARS#        412-0-0/w STRC(54)    r     1 PLOVER_BIRTH_KEY
   334-0-0/w STRC(117)   r     1 PLOVER_KEY               434-0-0/w UBIN        r     1 PLOVER_UTS
   274-0-0/w STRC(504)   r     1 P_PCB                    427-0-0/b BIT         r     1 READ_FILE
  1122-0-0/w STRC(72)    r     1 SECTION_KEY              416-0-0/c CHAR(11)    r     1 TIME
   437-0-0/c CHAR(256)   r     1 TXT                      435-0-0/w UBIN        r     1 UTS
    10-0-0/c STRC(72)    r     1 VLP_ACCT                   0-0-0/c STRC(288)   r     1 VLP_NAME
    12-0-0/c STRC(72)    r     1 VLP_PASS                  14-0-0/d STRC(522)   r     1 VLP_SN
    34-0-0/c STRC(72)    r     1 VLP_WSN                   36-0-0/d STRC(324)   r     1 VLR_FID
   132-0-0/d STRC(2052)  r     1 XUH_PARAM                224-0-0/d STRC(1404)  r     1 XUR_INIT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    71-0-0/w PTR         r     1 @ARS                      65-0-0/w PTR         r     1 @ARS
    65-0-0/w PTR         r     1 @BUF                      70-0-0/w PTR         r     1 @BUF_
    64-0-0/w PTR         r     1 @BUF_                     62-0-0/w PTR         r     1 @BUF_
    66-0-0/w PTR         r     1 @BUF_SIZE                 56-0-0/w PTR         r     1 @CODE
    67-0-0/w PTR         r     1 @KEY_                     63-0-0/w PTR         r     1 @KEY_
    61-0-0/w PTR         r     1 @KEY_                     65-0-0/w PTR         r     1 @PTR$
    65-0-0/w PTR         r     1 @PTR$                     55-0-0/w PTR         r     1 @PTR$
    *0-0-0/w UBIN        r     1 ARS                       *0-0-0/w UBIN        r     1 ARS
    57-0-0/w UBIN        r     1 ARS                        6-0-0/w PTR         r     1 BLK$
    *0-0-0/c ACHR        r     1 BUF                       *0-0-0/w BIT (72)    r     1 BUF_
    *0-0-0/w BIT (72)    r     1 BUF_                      *0-0-0/w BIT (72)    r     1 BUF_
    *0-0-0/w SBIN        r     1 BUF_SIZE                  *0-0-0/w SBIN        r     1 CODE
    56-0-0/w SBIN        r     1 COMP_UTS                  61-0-0/w SBIN        r     1 COUNT
    10-0-0/b BIT         r     1 DEVICE_CMD_FILE           11-0-0/b BIT         r     1 DO_CMD
    24-0-0/w STRC(288)   r     1 FIELD1                    34-0-0/w STRC(288)   r     1 FIELD2
    44-0-0/w STRC(288)   r     1 FIELD3                    66-0-0/w UBIN        r     1 I
    55-0-0/w SBIN        r     1 I                         56-0-0/w SBIN        r     1 J
    *0-0-0/w BIT (72)    r     1 KEY_                      *0-0-0/w BIT (72)    r     1 KEY_
    *0-0-0/w BIT (72)    r     1 KEY_                      60-0-0/w SBIN        r     1 LAST_UTS
     4-0-0/w PTR         r     1 M$OF$                      5-0-0/w PTR         r     1 M$SI$
     7-0-0/b BIT         r     1 MORE                      60-0-0/b BIT         r     1 OUF_SPECIFIED
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:200  
     3-0-0/w PTR         r     1 OUT$                      14-0-0/c STRC(288)   r     1 OU_NAME
    57-0-0/b BIT         r     1 OU_SPECIFIED               3-0-0/w STRC        r     1 PARSERR
    55-0-0/c CHAR(3)     r     1 PATCH_SPACE               13-0-0/w UBIN        r     1 PLOVER_BIRTH_SIZE
    57-0-0/w SBIN        r     1 PLOVER_UTS                *0-0-0/w PTR         r     1 PTR$
    *0-0-0/w PTR         r     1 PTR$                      *0-0-0/w PTR         r     1 PTR$
    62-0-0/w PTR         r     1 READ_BLK$                 55-0-0/w SBIN        r     1 SECT#
    55-0-0/w SBIN        r     1 SEQ                       57-0-0/w SBIN        r     1 TEMP
    61-0-0/w PTR         r     1 UTS_BLK$                  67-0-0/w UBIN        r     1 VAL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w STRC(63)    r     1 B_VERSION                  0-0-0/w SBIN        r     1 INVOKE_CMD
     0-0-0/w SBIN        r     1 PLOVER_COMMANDS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(468)   r     1 B$PLOVERBIRTH              0-0-0/w STRC(54)    r     1 B$PLOVERBIRTHKEY
     0-0-0/w STRC(117)   r     1 B$PLOVERKEY                0-0-0/w STRC(72)    r     1 B$SECTION
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 BASED$TEXT
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$OF
     0-0-0N  NULL        r     1 M$SI                       0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE


   Procedure DPM$PLOVER requires 2583 words for executable code.
   Procedure DPM$PLOVER requires 90 words of local(AUTO) storage.
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:201  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:202  
          MINI XREF LISTING

ALT IN PROCEDURE ENTREF_COMMAND
     12213**LABEL   12210--CALLALT
ALT IN PROCEDURE EXTERNAL_COMMAND
     12266**LABEL   12252--CALLALT 12258--CALLALT 12263--CALLALT
ALT IN PROCEDURE READ_OU
     11143**LABEL   11139--CALLALT
ALT IN PROCEDURE READ_OU_SEQ
     11200**LABEL   11196--CALLALT
ALT IN PROCEDURE RUM_COMMAND
     11540**LABEL   11520--CALLALT
ALT IN PROCEDURE SYMDEF_COMMAND
     12009**LABEL   11985--CALLALT 12006--CALLALT
ALT IN PROCEDURE WRITE_OU
     11248**LABEL   11245--CALLALT
ALTR IN PROCEDURE IDPATCH_COMMAND
     12521**LABEL   12518--CALLALT
ALTR IN PROCEDURE RUM_COMMAND
     11537**LABEL   11535--CALLALT
ALT_ERR IN PROCEDURE PLOVER_COMMAND
     11459**LABEL   11457--CALLALT
ARS IN PROCEDURE GET_NUM_SECTS
     12134**DCL     12146<>CALL    12148>>ASSIGN
ARS IN PROCEDURE READ_OU
     11095**DCL     11091--PROC    11140--IF      11140<<ASSIGN
ARS IN PROCEDURE READ_OU_SEQ
     11152**DCL     11147--PROC    11197<<ASSIGN
B$ALT.CODE
     10393**DCL     10393--REDEF   10394--REDEF   10394--REDEF
B$ALT.ERR
     10394**DCL     10717<>CALL    11014<>CALL    11018<>CALL    11085<>CALL    11292<>CALL    11537<>CALL
     11556<>CALL    12156<>CALL    12162<>CALL    12439<>CALL    12442<>CALL    12521<>CALL
B$ALT.ERR.CODE
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:203  
     10395**DCL     12152>>IF      12153>>IF
B$ALT.ERR.ERR#
     10395**DCL     10395--REDEF   11067>>IF
B$ALT.EVID
     10394**DCL     10394--REDEF   10394--REDEF
B$JIT.CCARS
      3699**DCL     10478>>ASSIGN
B$JIT.CCBUF
      3699**DCL     10477>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      3705**DCL      3705--REDEF
B$JIT.ERR.MID
      3612**DCL      3612--REDEF
B$JIT.JRESPEAK
      3773**DCL      3774--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      3882**DCL      3882--REDEF    3883--REDEF
B$JIT.PNR
      3786**DCL      3786--REDEF
B$JIT.TSLINE
      3880**DCL      3881--REDEF
B$JIT$
     10433**DCL      3606--IMP-PTR 10477>>ASSIGN  10478>>ASSIGN
B$PLOVERBIRTH
     10250**DCL     11052<<ASSIGN  11061>>ASSIGN  11929>>IF
B$PLOVERBIRTH.COUNT
     10264**DCL     11622>>IF      11675>>IF      11680--CALL    11856>>IF
B$PLOVERBIRTH.CREATE_UTS
     10258**DCL     11055<<ASSIGN  11662>>ASSIGN  11666>>ASSIGN  11872>>ASSIGN  11898>>ASSIGN
B$PLOVERBIRTH.DPATCH
     10268**DCL     11049<<ASSIGN  11674--CALL
B$PLOVERBIRTH.IPATCH
     10266**DCL     11048<<ASSIGN  11673--CALL
B$PLOVERBIRTH.OU_NAME.COUNT
     10253**DCL     11053<<ASSIGN
B$PLOVERBIRTH.OU_NAME.TEXT
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:204  
     10255**DCL     11054<<ASSIGN  11665--CALL
B$PLOVERBIRTH.PLOVER_UTS
     10261**DCL     11678>>ASSIGN  11873>>ASSIGN
B$PLOVERBIRTHKEY
     10307**DCL     11043<<ASSIGN  11045--CALL    11060>>ASSIGN  11870>>ASSIGN
B$PLOVERBIRTHKEY.UTS
     10313**DCL     11044<<ASSIGN
B$PLOVERKEY
     10062**DCL     11589<<ASSIGN  11635<<ASSIGN  11639--CALL    11808<<ASSIGN
B$PLOVERKEY.KEYSIZ
     10063**DCL     11590<<ASSIGN  11625>>DOWHILE 11640>>DOWHILE 11809<<ASSIGN
B$PLOVERKEY.NOTHD
     10066**DCL     11593>>DOWHILE 11625>>DOWHILE 11812>>IF
B$PLOVERKEY.PUTS
     10073**DCL     11637<<ASSIGN  11640>>DOWHILE 11690>>IF      11691>>ASSIGN
B$PLOVERKEY.SEQ
     10076**DCL     11638<<ASSIGN
B$PLOVERKEY.TYPE
     10071**DCL     11640>>DOWHILE
B$PLOVERKEY.UTS
     10068**DCL     11625>>DOWHILE 11640>>DOWHILE
B$SECTION IN PROCEDURE GET_NUM_SECTS
     12052**DCL     12148--ASSIGN
B$SECTION.MBZ IN PROCEDURE GET_NUM_SECTS
     12099**DCL     12101--REDEF   12105--REDEF
B$TCB.ALT$
     10389**DCL     10717>>CALL    11014>>CALL    11018>>CALL    11067>>IF      11085>>CALL    11292>>CALL
     11537>>CALL    11556>>CALL    12152>>IF      12153>>IF      12156>>CALL    12162>>CALL    12439>>CALL
     12442>>CALL    12521>>CALL
B$TCB$
     10434**DCL     10389--IMP-PTR 10717>>CALL    11014>>CALL    11018>>CALL    11067>>IF      11085>>CALL
     11292>>CALL    11537>>CALL    11556>>CALL    12152>>IF      12153>>IF      12156>>CALL    12162>>CALL
     12439>>CALL    12442>>CALL    12521>>CALL
BAD_TIME IN PROCEDURE CHECK_UTS
     11292**LABEL   11289--CALLALT
BASED$TEXT
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:205  
     10399**DCL     11519>>ASSIGN
BLK$
     10454**DCL      9961--IMP-PTR 10956>>ASSIGN  10956>>ASSIGN  11040>>ASSIGN  11041>>ASSIGN  11041>>ASSIGN
     11053>>ASSIGN  11054>>ASSIGN  11054>>ASSIGN  11071>>ASSIGN  11072>>ASSIGN  11072>>ASSIGN  11263<<ASSIGN
     11264>>CALLBLT 11264>>CALLBLT 11269>>ASSIGN  11270>>ASSIGN  11270>>ASSIGN  11282>>IF      11283>>CALLBLT
     11283>>CALLBLT 11285>>CALLBLT 11285>>CALLBLT 11332<<ASSIGN  11333>>DOCASE  11338>>ASSIGN  11342>>ASSIGN
     11343>>ASSIGN  11343>>ASSIGN  11361>>ASSIGN  11619<<ASSIGN  11633<<ASSIGN  11634<>CALL    11853<<ASSIGN
     11879<<ASSIGN  11880>>ASSIGN  11881>>ASSIGN  11881>>ASSIGN  11895<<ASSIGN  11896<>CALL    11909<<ASSIGN
     11910>>ASSIGN  11911>>ASSIGN  11911>>ASSIGN  11983<<ASSIGN  11984>>CALLBLT 11984>>CALLBLT 11990>>ASSIGN
     11991>>ASSIGN  11991>>ASSIGN  12004>>CALLBLT 12004>>CALLBLT 12005>>ASSIGN  12207<<ASSIGN  12208>>CALLBLT
     12208>>CALLBLT 12209>>ASSIGN  12409<<ASSIGN  12410>>ASSIGN  12410>>ASSIGN  12508<<ASSIGN  12510>>CALLBLT
     12510>>CALLBLT 12514>>CALLBLT 12514>>CALLBLT
BUF IN PROCEDURE WRITE_LO
     10725**DCL     10723--PROC    10760--ASSIGN
BUFVEC IN PROCEDURE GET_NUM_SECTS
     12130**DCL     12139<<ASSIGN  12146<>CALL
BUFVEC.BOUND IN PROCEDURE GET_NUM_SECTS
     12131**DCL     12159<<ASSIGN  12159>>ASSIGN
BUFVEC.PTR$ IN PROCEDURE GET_NUM_SECTS
     12133**DCL     12137>>IF
BUF_ IN PROCEDURE READ_OU
     11094**DCL     11091--PROC    11138>>ASSIGN
BUF_ IN PROCEDURE READ_OU_SEQ
     11151**DCL     11147--PROC    11195>>ASSIGN
BUF_ IN PROCEDURE WRITE_OU
     11208**DCL     11204--PROC    11244>>ASSIGN
BUF_SIZE IN PROCEDURE WRITE_LO
     10726**DCL     10723--PROC    10725--IMP-SIZ 10760>>ASSIGN
B_VERSION
     10435**DCL     11405--CALL    11420--CALL    11436--CALL    11451--CALL
CHECK_UTS
     11252**PROC    11366--CALL    11634--CALL    11896--CALL
CLOSE_SI
      9256**DCL     10714<>CALL    12432<>CALL
CLOSE_SI.SN_
      9256**DCL      9256--REDEF
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:206  
CLOSE_SI.UTL_
      9257**DCL      9257--REDEF
CLOSE_SI.V
      9261**DCL      9256--DCLINIT
CLOSE_SI.V.EXPIRE#
      9271**DCL      9271--REDEF
CLOSE_SI.V.TYPE#
      9269**DCL      9269--REDEF
CLOSE_SI.V.XTNSIZE#
      9266**DCL      9266--REDEF    9268--REDEF
CMD
     10415**DCL     10492<<ASSIGN  10493>>DOCASE  10542<>CALL    11057>>IF      11086>>IF      11290>>IF
     11293>>IF
CMD_ERR
     10591**LABEL   10517--CALLALT 10520--CALLALT 10524--CALLALT 10530--CALLALT 10533--CALLALT 10536--CALLALT
     10542--CALLALT
CNT
     10417**DCL     10399--IMP-SIZ 10478<<ASSIGN  10479<>CALL    11501<<ASSIGN  11502>>IF      11519>>ASSIGN
     11547>>CALL    11592<>CALL    11599<>CALL    11624<>CALL    11629<>CALL    11639<>CALL    11645<>CALL
     11699>>CALL    11811<>CALL    12005<<ASSIGN  12209<<ASSIGN  12250<<CALLBLT 12251>>ASSIGN  12256<<CALLBLT
     12257>>ASSIGN  12262<<ASSIGN
CODE IN PROCEDURE IDPATCH_COMMAND
     12453**DCL     12450--PROC    12493>>DOCASE  12509>>IF
COMP_UTS
     10412**DCL     11058<<ASSIGN  11290>>IF      11387>>ASSIGN  12141>>ASSIGN
COMP_UTS IN PROCEDURE LIST_COMMAND
     11565**DCL     11625>>DOWHILE 11640>>DOWHILE 11662<<ASSIGN  11663>>ASSIGN
COUNT IN PROCEDURE LIST_COMMAND
     11568**DCL     11587<<ASSIGN  11601>>IF      11664<<ASSIGN  11664>>ASSIGN
CREATION_UTS_FMT IN PROCEDURE LIST_PLOVER_BIRTH
     11656**DCL     11672--CALL
DATE
     10405**DCL      9206--DCLINIT  9207--DCLINIT  9225--DCLINIT  9226--DCLINIT 11287<<ASSIGN  11672--CALL
     11680--CALL    11694>>CALLBLT 11915>>ASSIGN
DATE_TIME
     10407**DCL     11283<<CALLBLT 11285<<CALLBLT 11287>>ASSIGN  11288>>ASSIGN
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:207  
DELETE_COMMAND
     11705**PROC    10524--CALL
DEVICE_CMD_FILE
     10456**DCL     10487<<ASSIGN  10551>>IF
DONE IN PROCEDURE LIST_COMMAND
     11601**LABEL   11592--CALLALT 11599--CALLALT
DO_CMD
     10457**DCL     10489<<ASSIGN  10512<<ASSIGN  10517>>IF      10520>>IF      10523>>IF      10530>>IF
     10533>>IF      10536>>IF      10539>>IF      10542>>IF      10553<<ASSIGN  10574<<ASSIGN
DPATCH_FMT IN PROCEDURE LIST_PLOVER_BIRTH
     11660**DCL     11674--CALL
DPM$PARSE_U$
      9704**DCL-ENT  9703--DCLINIT
ENTREF_COMMAND
     12170**PROC    10533--CALL
ERR1 IN PROCEDURE PLOVER_COMMAND
     11358**LABEL   11336--CALLALT 11344--CALLALT
ERR2 IN PROCEDURE PLOVER_COMMAND
     11383**LABEL   11366--CALLALT
EXIT# IN PROCEDURE DELETE_COMMAND
     11940**LABEL   11854--CALLALT 11896--CALLALT
EXTERNAL_COMMAND
     12217**PROC    10536--CALL
F$DCB.ACTPOS
     10364**DCL     10364--REDEF
F$DCB.ARS#
     10338**DCL     10338--REDEF   11046>>ASSIGN  11140>>ASSIGN  11197>>ASSIGN
F$DCB.ASN#
     10353**DCL     10487>>ASSIGN
F$DCB.ATTR
     10357**DCL     10358--REDEF
F$DCB.BORROW
     10372**DCL     10372--REDEF   10372--REDEF   10372--REDEF
F$DCB.DCBNAME.L
     10386**DCL     10386--IMP-SIZ
F$DCB.EOMCHAR#
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:208  
     10342**DCL     10342--REDEF
F$DCB.FCD#
     10351**DCL     10486>>IF      10714>>IF      10991>>IF      12432>>IF
F$DCB.FLDID
     10367**DCL     10367--REDEF
F$DCB.FORM$
     10361**DCL     10361--REDEF
F$DCB.FSECT
     10377**DCL     10377--REDEF
F$DCB.FSN#
     10354**DCL     10354--REDEF   10354--REDEF   10355--REDEF
F$DCB.HEADER$
     10360**DCL     10360--REDEF
F$DCB.IXTNSIZE#
     10358**DCL     10358--REDEF
F$DCB.LASTSTA$
     10347**DCL     10347--REDEF
F$DCB.LVL
     10373**DCL     10373--REDEF
F$DCB.NAME#.C
     10348**DCL     10348--REDEF
F$DCB.NOEOF
     10370**DCL     10370--REDEF
F$DCB.NRECS#
     10359**DCL     10359--REDEF
F$DCB.NRECX
     10378**DCL     10378--REDEF
F$DCB.OHDR
     10370**DCL     10370--REDEF
F$DCB.ORG#
     10353**DCL     10353--REDEF   10994>>IF
F$DCB.PRECNO
     10376**DCL     10376--REDEF
F$DCB.RCSZ
     10382**DCL     10382--REDEF
F$DCB.RES#
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:209  
     10349**DCL     10349--REDEF
F$DCB.SETX
     10361**DCL     10361--REDEF
F$DCB.TAB$
     10361**DCL     10361--REDEF
F$DCB.TDA
     10375**DCL     10376--REDEF
F$DCB.WSN#
     10349**DCL     10349--REDEF
FID_ERR IN PROCEDURE OPEN_OF
     11014**LABEL   10957--CALLALT
FID_ERR IN PROCEDURE READ_COMMAND
     12439**LABEL   12411--CALLALT
FIELD1
     10463**DCL     11080--CALL    11278--CALL    11889--CALL    11923--CALL    11999--CALL
FIELD1.COUNT
     10464**DCL     11071<<ASSIGN  11269<<ASSIGN  11880<<ASSIGN  11912<<ASSIGN  11990<<ASSIGN
FIELD1.TEXT
     10465**DCL     11072<<ASSIGN  11270<<ASSIGN  11881<<ASSIGN  11913<<ASSIGN  11991<<ASSIGN
FIELD2
     10466**DCL     11923--CALL
FIELD2.COUNT
     10467**DCL     11914<<ASSIGN
FIELD2.TEXT
     10468**DCL     11915<<ASSIGN
FIELD3
     10469**DCL     11923--CALL
FIELD3.COUNT
     10470**DCL     11910<<ASSIGN
FIELD3.TEXT
     10471**DCL     11911<<ASSIGN
FIND_OU
     11037**PROC    11344--CALL    11620--CALL    11854--CALL
FINISHED IN PROCEDURE LIST_COMMAND
     11649**LABEL   11620--CALLALT 11624--CALLALT 11629--CALLALT 11634--CALLALT 11645--CALLALT
FMT IN PROCEDURE LIST_PLOVER
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:210  
     11688**DCL     11699--CALL
FPT_CLOSE IN PROCEDURE OPEN_OF
     10909**DCL     10991<>CALL
FPT_CLOSE.SN_ IN PROCEDURE OPEN_OF
     10909**DCL     10909--REDEF
FPT_CLOSE.UTL_ IN PROCEDURE OPEN_OF
     10910**DCL     10910--REDEF
FPT_CLOSE.V IN PROCEDURE OPEN_OF
     10914**DCL     10909--DCLINIT
FPT_CLOSE.V.EXPIRE# IN PROCEDURE OPEN_OF
     10924**DCL     10924--REDEF
FPT_CLOSE.V.TYPE# IN PROCEDURE OPEN_OF
     10922**DCL     10922--REDEF
FPT_CLOSE.V.XTNSIZE# IN PROCEDURE OPEN_OF
     10919**DCL     10919--REDEF   10921--REDEF
FPT_DELREC IN PROCEDURE DELETE_COMMAND
     11719**DCL     11819<>CALL    11875<>CALL    11904<>CALL
FPT_DELREC.V IN PROCEDURE DELETE_COMMAND
     11722**DCL     11719--DCLINIT
FPT_FID IN PROCEDURE OPEN_OF
     10940**DCL     10957<>CALL
FPT_FID.TEXTFID_ IN PROCEDURE OPEN_OF
     10940**DCL     10956<<ASSIGN
FPT_FID.V IN PROCEDURE OPEN_OF
     10944**DCL     10940--DCLINIT
FPT_FID IN PROCEDURE READ_COMMAND
     12395**DCL     12411<>CALL
FPT_FID.TEXTFID_ IN PROCEDURE READ_COMMAND
     12395**DCL     12410<<ASSIGN
FPT_FID.V IN PROCEDURE READ_COMMAND
     12399**DCL     12395--DCLINIT
FPT_GDS IN PROCEDURE GET_NUM_SECTS
     12121**DCL     12138<>CALL    12154<>CALL
FPT_GDS.V IN PROCEDURE GET_NUM_SECTS
     12121**DCL     12121--DCLINIT
FPT_OPEN IN PROCEDURE OPEN_CMD_FILE
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:211  
     10669**DCL     10715<>CALL
FPT_OPEN.ACSVEH_ IN PROCEDURE OPEN_CMD_FILE
     10671**DCL     10672--REDEF
FPT_OPEN.ALTKEYS_ IN PROCEDURE OPEN_CMD_FILE
     10677**DCL     10678--REDEF   10678--REDEF
FPT_OPEN.HDR_ IN PROCEDURE OPEN_CMD_FILE
     10676**DCL     10677--REDEF
FPT_OPEN.TAB_ IN PROCEDURE OPEN_CMD_FILE
     10675**DCL     10676--REDEF
FPT_OPEN.UHL_ IN PROCEDURE OPEN_CMD_FILE
     10669**DCL     10670--REDEF   10670--REDEF
FPT_OPEN.V IN PROCEDURE OPEN_CMD_FILE
     10678**DCL     10669--DCLINIT
FPT_OPEN.V.FSN# IN PROCEDURE OPEN_CMD_FILE
     10709**DCL     10709--REDEF   10709--REDEF
FPT_OPEN.WSN_ IN PROCEDURE OPEN_CMD_FILE
     10675**DCL     10675--REDEF
FPT_OPEN IN PROCEDURE OPEN_OF
     10842**DCL     10993<>CALL
FPT_OPEN.ACCT_ IN PROCEDURE OPEN_OF
     10846**DCL     10976<<ASSIGN  10978<<ASSIGN
FPT_OPEN.ACSVEH_ IN PROCEDURE OPEN_OF
     10844**DCL     10845--REDEF
FPT_OPEN.ALTKEYS_ IN PROCEDURE OPEN_OF
     10850**DCL     10851--REDEF   10851--REDEF
FPT_OPEN.HDR_ IN PROCEDURE OPEN_OF
     10849**DCL     10850--REDEF
FPT_OPEN.NAME_ IN PROCEDURE OPEN_OF
     10843**DCL     10974<<ASSIGN
FPT_OPEN.PASS_ IN PROCEDURE OPEN_OF
     10844**DCL     10980<<ASSIGN  10982<<ASSIGN
FPT_OPEN.SN_ IN PROCEDURE OPEN_OF
     10842**DCL     10984<<ASSIGN  10986<<ASSIGN
FPT_OPEN.TAB_ IN PROCEDURE OPEN_OF
     10848**DCL     10849--REDEF
FPT_OPEN.UHL_ IN PROCEDURE OPEN_OF
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:212  
     10842**DCL     10843--REDEF   10843--REDEF
FPT_OPEN.V IN PROCEDURE OPEN_OF
     10851**DCL     10842--DCLINIT
FPT_OPEN.V.ASN# IN PROCEDURE OPEN_OF
     10861**DCL     10943--DCLINIT 10958>>IF
FPT_OPEN.V.FSN# IN PROCEDURE OPEN_OF
     10882**DCL     10882--REDEF   10882--REDEF
FPT_OPEN.V.RES# IN PROCEDURE OPEN_OF
     10866**DCL     10943--DCLINIT
FPT_OPEN.WSN_ IN PROCEDURE OPEN_OF
     10848**DCL     10848--REDEF   10988<<ASSIGN  10990<<ASSIGN
FPT_OPEN IN PROCEDURE READ_COMMAND
     12339**DCL     12434<>CALL
FPT_OPEN.ACCT_ IN PROCEDURE READ_COMMAND
     12343**DCL     12417<<ASSIGN  12419<<ASSIGN
FPT_OPEN.ACSVEH_ IN PROCEDURE READ_COMMAND
     12341**DCL     12342--REDEF
FPT_OPEN.ALTKEYS_ IN PROCEDURE READ_COMMAND
     12347**DCL     12348--REDEF   12348--REDEF
FPT_OPEN.HDR_ IN PROCEDURE READ_COMMAND
     12346**DCL     12347--REDEF
FPT_OPEN.NAME_ IN PROCEDURE READ_COMMAND
     12340**DCL     12413<<ASSIGN  12415<<ASSIGN
FPT_OPEN.PASS_ IN PROCEDURE READ_COMMAND
     12341**DCL     12421<<ASSIGN  12423<<ASSIGN
FPT_OPEN.SN_ IN PROCEDURE READ_COMMAND
     12339**DCL     12425<<ASSIGN  12427<<ASSIGN
FPT_OPEN.TAB_ IN PROCEDURE READ_COMMAND
     12345**DCL     12346--REDEF
FPT_OPEN.UHL_ IN PROCEDURE READ_COMMAND
     12339**DCL     12340--REDEF   12340--REDEF
FPT_OPEN.V IN PROCEDURE READ_COMMAND
     12348**DCL     12339--DCLINIT
FPT_OPEN.V.ASN# IN PROCEDURE READ_COMMAND
     12358**DCL     12398--DCLINIT
FPT_OPEN.V.FSN# IN PROCEDURE READ_COMMAND
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:213  
     12379**DCL     12379--REDEF   12379--REDEF
FPT_OPEN.V.RES# IN PROCEDURE READ_COMMAND
     12363**DCL     12398--DCLINIT
FPT_OPEN.WSN_ IN PROCEDURE READ_COMMAND
     12345**DCL     12345--REDEF   12429<<ASSIGN  12431<<ASSIGN
FPT_READ IN PROCEDURE READ_OU
     11114**DCL     11139<>CALL
FPT_READ.BUF_ IN PROCEDURE READ_OU
     11116**DCL     11138<<ASSIGN
FPT_READ.KEY_ IN PROCEDURE READ_OU
     11114**DCL     11137<<ASSIGN
FPT_READ.STATION_ IN PROCEDURE READ_OU
     11117**DCL     11118--REDEF
FPT_READ.V IN PROCEDURE READ_OU
     11118**DCL     11114--DCLINIT
FPT_READ.V.DVBYTE.REREAD# IN PROCEDURE READ_OU
     11129**DCL     11129--REDEF
FPT_READ.V.INDX# IN PROCEDURE READ_OU
     11127**DCL     11127--REDEF
FPT_READ IN PROCEDURE READ_OU_SEQ
     11171**DCL     11196<>CALL
FPT_READ.BUF_ IN PROCEDURE READ_OU_SEQ
     11173**DCL     11195<<ASSIGN
FPT_READ.KEY_ IN PROCEDURE READ_OU_SEQ
     11171**DCL     11194<<ASSIGN
FPT_READ.STATION_ IN PROCEDURE READ_OU_SEQ
     11174**DCL     11175--REDEF
FPT_READ.V IN PROCEDURE READ_OU_SEQ
     11175**DCL     11171--DCLINIT
FPT_READ.V.DVBYTE.REREAD# IN PROCEDURE READ_OU_SEQ
     11186**DCL     11186--REDEF
FPT_READ.V.INDX# IN PROCEDURE READ_OU_SEQ
     11184**DCL     11184--REDEF
FPT_WRITE IN PROCEDURE WRITE_LO
     10745**DCL     10761<>CALL
FPT_WRITE.BUF_ IN PROCEDURE WRITE_LO
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:214  
     10745**DCL     10760<<ASSIGN
FPT_WRITE.STATION_ IN PROCEDURE WRITE_LO
     10747**DCL     10747--REDEF
FPT_WRITE.V IN PROCEDURE WRITE_LO
     10748**DCL     10745--DCLINIT
FPT_WRITE.V.DVBYTE.VFC# IN PROCEDURE WRITE_LO
     10754**DCL     10754--REDEF
FPT_WRITE IN PROCEDURE WRITE_OU
     11227**DCL     11245<>CALL
FPT_WRITE.BUF_ IN PROCEDURE WRITE_OU
     11227**DCL     11244<<ASSIGN
FPT_WRITE.KEY_ IN PROCEDURE WRITE_OU
     11227**DCL     11243<<ASSIGN
FPT_WRITE.STATION_ IN PROCEDURE WRITE_OU
     11229**DCL     11229--REDEF
FPT_WRITE.V IN PROCEDURE WRITE_OU
     11230**DCL     11227--DCLINIT
FPT_WRITE.V.DVBYTE.VFC# IN PROCEDURE WRITE_OU
     11236**DCL     11236--REDEF
F_FDS
      9392**DCL     11665<>CALL    11672<>CALL    11673<>CALL    11674<>CALL    11680<>CALL    11699<>CALL
GDSVEC IN PROCEDURE GET_NUM_SECTS
     12126**DCL     12121--DCLINIT 12139>>ASSIGN
GDS_ERR IN PROCEDURE GET_NUM_SECTS
     12156**LABEL   12138--CALLALT
GET_NUM_SECTS
     12013**PROC    11985--CALL
GET_PLOVER_UTS
      9187**DCL     11386<>CALL    11932<>CALL
GET_PLOVER_UTS.V
      9191**DCL      9187--DCLINIT
HEAD_KEY
     10038**DCL     11042--CALL
HEAD_KEY.KEYSIZ
     10039**DCL     11040<<ASSIGN
HEAD_KEY.TEXT
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:215  
     10044**DCL     11041<<ASSIGN
HEAD_RECORD
     10110**DCL     11042--CALL
HEAD_RECORD.UTS
     10111**DCL     11044>>ASSIGN  11055>>ASSIGN  11058>>ASSIGN
HEAD_RECORD.VERSION
     10128**DCL     10130--REDEF
I IN PROCEDURE CHECK_UTS
     11256**DCL     11262<<DOINDEX 11263>>ASSIGN  11265>>IF      11283>>CALLBLT 11283>>CALLBLT 11285>>CALLBLT
     11285>>CALLBLT
I IN PROCEDURE PLOVER_COMMAND
     11318**DCL     11325<<ASSIGN  11327>>IF      11331>>DOINDEX
IDPATCH_COMMAND
     12450**PROC    10542--CALL
INVOKE_CMD
     10438**DCL     10479<>CALL
IPATCH_FMT IN PROCEDURE LIST_PLOVER_BIRTH
     11659**DCL     11673--CALL
J IN PROCEDURE PLOVER_COMMAND
     11319**DCL     11331<<DOINDEX 11332>>ASSIGN
KEY1 IN PROCEDURE DELETE_COMMAND
     11740**DCL     11719--DCLINIT 11720--DCLINIT 11870<<ASSIGN  11897<<ASSIGN  11901--CALL    11902>>ASSIGN
KEY1.KEYSIZ IN PROCEDURE DELETE_COMMAND
     11741**DCL     11813<<ASSIGN
KEY1.PUTS IN PROCEDURE DELETE_COMMAND
     11751**DCL     11899<<ASSIGN
KEY1.SEQ IN PROCEDURE DELETE_COMMAND
     11754**DCL     11900<<ASSIGN
KEY1.UTS IN PROCEDURE DELETE_COMMAND
     11746**DCL     11898<<ASSIGN
KEY2 IN PROCEDURE DELETE_COMMAND
     11770**DCL     11721--DCLINIT 11722--DCLINIT 11871<<ASSIGN  11902<<ASSIGN
KEY2.KEYSIZ IN PROCEDURE DELETE_COMMAND
     11771**DCL     11814<<ASSIGN
KEY2.PUTS IN PROCEDURE DELETE_COMMAND
     11781**DCL     11817<<ASSIGN  11873<<ASSIGN
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:216  
KEY2.SEQ IN PROCEDURE DELETE_COMMAND
     11784**DCL     11818<<ASSIGN  11874<<ASSIGN  11903<<ASSIGN
KEY2.TYPE IN PROCEDURE DELETE_COMMAND
     11779**DCL     11815<<ASSIGN
KEY2.UTS IN PROCEDURE DELETE_COMMAND
     11776**DCL     11816<<ASSIGN  11872<<ASSIGN
KEY_ IN PROCEDURE READ_OU
     11093**DCL     11091--PROC    11137>>ASSIGN
KEY_ IN PROCEDURE READ_OU_SEQ
     11150**DCL     11147--PROC    11194>>ASSIGN
KEY_ IN PROCEDURE WRITE_OU
     11207**DCL     11204--PROC    11243>>ASSIGN
LAST_UTS IN PROCEDURE LIST_COMMAND
     11567**DCL     11663<<ASSIGN  11690>>IF      11691<<ASSIGN  11692>>ASSIGN
LIST_COMMAND
     11561**PROC    10520--CALL
LIST_PLOVER IN PROCEDURE LIST_COMMAND
     11686**PROC    11598--CALL    11628--CALL    11644--CALL
LIST_PLOVER_BIRTH IN PROCEDURE LIST_COMMAND
     11653**PROC    11596--CALL    11621--CALL
M$CLOSE
      3525**DCL-ENT 10714--CALL    10991--CALL    12432--CALL
M$DELREC
      3527**DCL-ENT 11819--CALL    11875--CALL    11904--CALL
M$DO
     10324**DCL     10481<>CALL    10569<>CALL    10572<>CALL    10585<>CALL    10969<>CALL    11005<>CALL
     11080<>CALL    11278<>CALL    11306<>CALL    11355<>CALL    11380<>CALL    11405<>CALL    11420<>CALL
     11436<>CALL    11451<>CALL    11479<>CALL    11496<>CALL    11514<>CALL    11582<>CALL    11613<>CALL
     11802<>CALL    11830<>CALL    11846<>CALL    11864<>CALL    11889<>CALL    11923<>CALL    11961<>CALL
     11978<>CALL    11999<>CALL    12185<>CALL    12202<>CALL    12230<>CALL    12243<>CALL    12470<>CALL
     12487<>CALL
M$EXIT
      3537**DCL-ENT 10483--CALL    10599--CALL    10718--CALL
M$FID
      3588**DCL-ENT 10957--CALL    12411--CALL
M$GDS
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:217  
      3560**DCL-ENT 12138--CALL    12154--CALL
M$LO
     10323**DCL     10473<>CALL
M$OF
     10325**DCL     10475--ASSIGN  11018<>CALL    11085<>CALL    11405<>CALL    11420<>CALL    11537<>CALL
     11556<>CALL    12162<>CALL    12521<>CALL
M$OF$
     10452**DCL     10475<<ASSIGN  10991>>IF      10994>>IF      11046>>ASSIGN  11140>>ASSIGN  11197>>ASSIGN
M$OPEN
      3525**DCL-ENT 10715--CALL    10993--CALL    12434--CALL
M$READ
      3526**DCL-ENT 11139--CALL    11196--CALL
M$SI
     10322**DCL     10473<>CALL    10476--ASSIGN  10549<>CALL    10590<>CALL    10717<>CALL    12442<>CALL
M$SI$
     10453**DCL     10476<<ASSIGN  10486>>IF      10487>>ASSIGN  10714>>IF      12432>>IF
M$TIME
      3592**DCL-ENT 11289--CALL    11386--CALL    11667--CALL    11679--CALL    11693--CALL    11932--CALL
M$WRITE
      3526**DCL-ENT 10761--CALL    11245--CALL
MAX IN PROCEDURE CHECK_UTS
     11258**DCL     11265>>IF
MORE
     10455**DCL     10488<<ASSIGN  10490>>DOWHILE 10495<<ASSIGN  10547<<ASSIGN  10552<<ASSIGN  10557<<ASSIGN
NONE IN PROCEDURE DELETE_COMMAND
     11846**LABEL   11811--CALLALT 11901--CALLALT
NONE IN PROCEDURE FIND_OU
     11052**LABEL   11045--CALLALT
NONE IN PROCEDURE LIST_COMMAND
     11613**LABEL   11639--CALLALT
NO_HEAD IN PROCEDURE FIND_OU
     11067**LABEL   11042--CALLALT
NUM_ERRORS
     10411**DCL     10591<<ASSIGN  10591>>ASSIGN  10598>>IF      11358<<ASSIGN  11358>>ASSIGN  11383<<ASSIGN
     11383>>ASSIGN  11459<<ASSIGN  11459>>ASSIGN  12445<<ASSIGN  12445>>ASSIGN
NUM_SECTS
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:218  
     10418**DCL     11059<<ASSIGN  11985>>IF      11986>>IF      12144<<ASSIGN  12148<<ASSIGN  12148>>ASSIGN
OPEN_CMD_FILE
     10602**PROC    10486--CALL    10551--CALL
OPEN_ERR IN PROCEDURE OPEN_OF
     11018**LABEL   10993--CALLALT
OPEN_ERR IN PROCEDURE READ_COMMAND
     12442**LABEL   12434--CALLALT
OPEN_FILE IN PROCEDURE OPEN_OF
     10993**LABEL   10991--CALLALT
OPEN_FILE IN PROCEDURE READ_COMMAND
     12434**LABEL   12432--CALLALT
OPEN_OF
     10775**PROC    11336--CALL
OUF_ASSOCIATED
     10410**DCL     10954<<ASSIGN  11010<<ASSIGN  11341>>IF      11393>>IF      11467>>IF      11570>>IF
     11790>>IF      11949>>IF      12173>>IF      12222>>IF      12456>>IF
OUF_SPECIFIED IN PROCEDURE PLOVER_COMMAND
     11321**DCL     11328<<ASSIGN  11335<<ASSIGN  11347>>IF
OUT$
     10445**DCL      9915--IMP-PTR 10446--REDEF   10479<>CALL    10491<>CALL    10492>>ASSIGN  10500>>ASSIGN
     10539>>CALL    10542>>CALL    11261<<ASSIGN  11263>>ASSIGN  11325>>ASSIGN  11521>>IF      11522>>DOCASE
     11588>>IF      11619>>ASSIGN  11623>>IF      11633>>ASSIGN  11807>>IF      11853>>ASSIGN  11855>>IF
     11895>>ASSIGN  11929>>IF      11936>>IF      11983>>ASSIGN  12004>>CALLBLT 12004>>CALLBLT 12005>>ASSIGN
     12207>>ASSIGN  12248>>IF      12250>>CALLBLT 12250>>CALLBLT 12256>>CALLBLT 12256>>CALLBLT 12260>>CALLBLT
     12260>>CALLBLT 12260>>CALLBLT 12260>>CALLBLT 12262>>ASSIGN  12262>>ASSIGN  12495>>IF      12496<<ASSIGN
     12497>>IF
OUT$SYM.CODE
      9967**DCL     11333>>DOCASE  12248>>IF
OUT$SYM.COUNT
      9984**DCL      9987--IMP-SIZ 10956>>ASSIGN  11040>>ASSIGN  11041>>ASSIGN  11053>>ASSIGN  11054>>ASSIGN
     11071>>ASSIGN  11072>>ASSIGN  11264>>CALLBLT 11269>>ASSIGN  11270>>ASSIGN  11282>>IF      11283>>CALLBLT
     11285>>CALLBLT 11342>>ASSIGN  11343>>ASSIGN  11880>>ASSIGN  11881>>ASSIGN  11910>>ASSIGN  11911>>ASSIGN
     11984>>CALLBLT 11990>>ASSIGN  11991>>ASSIGN  12004>>CALLBLT 12004>>CALLBLT 12005>>ASSIGN  12005>>ASSIGN
     12208>>CALLBLT 12209>>ASSIGN  12250>>CALLBLT 12256>>CALLBLT 12260>>CALLBLT 12260>>CALLBLT 12262>>ASSIGN
     12262>>ASSIGN  12410>>ASSIGN  12510>>CALLBLT 12514>>CALLBLT
OUT$SYM.TEXT
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:219  
      9987**DCL     10956--ASSIGN  11041>>ASSIGN  11054>>ASSIGN  11072>>ASSIGN  11264>>CALLBLT 11270>>ASSIGN
     11283>>CALLBLT 11285>>CALLBLT 11343>>ASSIGN  11881>>ASSIGN  11911>>ASSIGN  11984>>CALLBLT 11991>>ASSIGN
     12004>>CALLBLT 12004>>CALLBLT 12208>>CALLBLT 12250>>CALLBLT 12256>>CALLBLT 12260>>CALLBLT 12260>>CALLBLT
     12410--ASSIGN  12510>>CALLBLT 12514>>CALLBLT
OUT_BUF
      9491**DCL      9410--DCLINIT  9412--DCLINIT 11694<<CALLBLT 11695<>CALL
OU_ASSOCIATED
     10409**DCL     10955<<ASSIGN  11062<<ASSIGN  11086<<ASSIGN  11310<<ASSIGN  11366>>IF      11385>>IF
     11394>>IF      11425>>IF      11484>>IF      11929>>IF      11966>>IF      12190>>IF      12235>>IF
     12475>>IF
OU_FMT IN PROCEDURE LIST_PLOVER_BIRTH
     11655**DCL     11665--CALL
OU_KEY
     10026**DCL     10427--DCLINIT 11591--CALL    11592--CALL    11599--CALL    11624--CALL    11629--CALL
     11645--CALL    11810--CALL    11811--CALL
OU_KEY.KEYSIZ
     10027**DCL     11594>>IF
OU_KEY$
     10427**DCL     10062--IMP-PTR 10307--IMP-PTR 11043>>ASSIGN  11044>>ASSIGN  11045>>CALL    11060>>ASSIGN
     11589>>ASSIGN  11590>>ASSIGN  11593>>DOWHILE 11625>>DOWHILE 11625>>DOWHILE 11625>>DOWHILE 11635>>ASSIGN
     11637>>ASSIGN  11638>>ASSIGN  11639>>CALL    11640>>DOWHILE 11640>>DOWHILE 11640>>DOWHILE 11640>>DOWHILE
     11690>>IF      11691>>ASSIGN  11808>>ASSIGN  11809>>ASSIGN  11812>>IF      11870>>ASSIGN
OU_NAME
     10460**DCL     11405--CALL    11436--CALL    11999--CALL
OU_NAME.COUNT
     10461**DCL     11342<<ASSIGN
OU_NAME.TEXT
     10462**DCL     11343<<ASSIGN
OU_SPECIFIED IN PROCEDURE PLOVER_COMMAND
     11320**DCL     11329<<ASSIGN  11340<<ASSIGN  11365>>IF      11385>>IF
P$NODE.CODE
      9923**DCL     10492>>ASSIGN  11521>>IF      11522>>DOCASE  12497>>IF
P$NODE.NSUBLKS
      9927**DCL     11325>>ASSIGN  11588>>IF      11623>>IF      11807>>IF      11855>>IF      11929>>IF
     11936>>IF      12495>>IF
P$NODE.SUBLK$
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:220  
      9948**DCL     10500>>ASSIGN  10500>>ASSIGN  10539<>CALL    10542<>CALL    11263>>ASSIGN  11332>>ASSIGN
     11522>>DOCASE  11619>>ASSIGN  11633>>ASSIGN  11853>>ASSIGN  11879>>ASSIGN  11895>>ASSIGN  11909>>ASSIGN
     11983>>ASSIGN  12004>>CALLBLT 12004>>CALLBLT 12005>>ASSIGN  12207>>ASSIGN  12248>>IF      12250>>CALLBLT
     12250>>CALLBLT 12256>>CALLBLT 12256>>CALLBLT 12260>>CALLBLT 12260>>CALLBLT 12260>>CALLBLT 12260>>CALLBLT
     12262>>ASSIGN  12262>>ASSIGN
PARSERR
     10446**DCL     10482<>CALL    10549<>CALL    10590<>CALL
PARSERR.CODE
     10450**DCL     10546>>IF
PARSERR.MON
     10449**DCL     10546>>IF      10556>>IF
PARSE_ERR
     10546**LABEL   10491--CALLALT
PATCH_SPACE IN PROCEDURE EXTERNAL_COMMAND
     12219**DCL     12249<<ASSIGN  12255<<ASSIGN  12260>>CALLBLT
PLOVER
      9584**DCL      9522--DCLINIT
PLOVERED_UTS_FMT IN PROCEDURE LIST_PLOVER_BIRTH
     11657**DCL     11680--CALL
PLOVER_BIRTH
     10228**DCL     11061<<ASSIGN  11535--CALL    11551--CALL    11929>>IF      12252--CALL    12258--CALL
     12518--CALL
PLOVER_BIRTH.COUNT
     10242**DCL     11550<<ASSIGN  11550>>ASSIGN  11937<<ASSIGN
PLOVER_BIRTH.DPATCH
     10246**DCL     10526<<ASSIGN  11528<<ASSIGN  11528>>ASSIGN  11530<<ASSIGN  11530>>ASSIGN  12257<<ASSIGN
     12257>>ASSIGN  12500<<ASSIGN  12504<<ASSIGN  12515<<ASSIGN  12515>>ASSIGN
PLOVER_BIRTH.IPATCH
     10244**DCL     10525<<ASSIGN  11524<<ASSIGN  11524>>ASSIGN  11526<<ASSIGN  11526>>ASSIGN  12251<<ASSIGN
     12251>>ASSIGN  12498<<ASSIGN  12503<<ASSIGN  12511<<ASSIGN  12511>>ASSIGN
PLOVER_BIRTH.PLOVER_UTS
     10239**DCL     11548>>IF      11549<<ASSIGN  11935<<ASSIGN
PLOVER_BIRTH_ARS#
     10419**DCL     11047>>IF
PLOVER_BIRTH_KEY
     10284**DCL     11043>>ASSIGN  11060<<ASSIGN  11535--CALL    11551--CALL    12252--CALL    12258--CALL
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:221  
     12518--CALL
PLOVER_BIRTH_KEY.KEYSIZ
     10285**DCL     11594>>IF
PLOVER_BIRTH_SIZE
     10459**DCL     11046<<ASSIGN  11047>>IF
PLOVER_COMMAND
     11316**PROC    10485--CALL    10511--CALL
PLOVER_COMMANDS
     10439**DCL     10491<>CALL
PLOVER_KEY
     10092**DCL     11547--CALL    11589>>ASSIGN  11635>>ASSIGN  11808>>ASSIGN  11871>>ASSIGN  11897>>ASSIGN
PLOVER_KEY.KEYSIZ
     10093**DCL     11625>>DOWHILE 11640>>DOWHILE 11814>>ASSIGN
PLOVER_KEY.NOTHD
     10096**DCL     11593>>DOWHILE 11625>>DOWHILE 11812>>IF
PLOVER_KEY.PUTS
     10103**DCL     11388<<ASSIGN  11933<<ASSIGN
PLOVER_KEY.SEQ
     10106**DCL     11389<<ASSIGN  11546<<ASSIGN  11546>>ASSIGN  11934<<ASSIGN
PLOVER_KEY.UTS
     10098**DCL     11387<<ASSIGN
PLOVER_UTS
     10413**DCL      9191--DCLINIT 11388>>ASSIGN  11548>>IF      11549>>ASSIGN  11933>>ASSIGN
PLOVER_UTS IN PROCEDURE LIST_COMMAND
     11566**DCL     11636<<ASSIGN  11637>>ASSIGN  11640>>DOWHILE
PROMPT
     10425**DCL     10491--CALL
PTR$ IN PROCEDURE CHECK_UTS
     11255**DCL     11252--PROC    11261>>ASSIGN
PTR$ IN PROCEDURE IDPATCH_COMMAND
     12452**DCL     12450--PROC    12496>>ASSIGN  12508>>ASSIGN
PTR$ IN PROCEDURE READ_COMMAND
     12272**DCL     12270--PROC    12409>>ASSIGN
P_PCB
      9728**DCL      9639--DCLINIT
P_PCB.NCHARS
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:222  
      9875**DCL     11501>>ASSIGN
P_PCB.OUT$
      9741**DCL     11332>>ASSIGN  11879>>ASSIGN  11909>>ASSIGN
P_PCB.TEXT$
      9729**DCL     11519>>ASSIGN
READ_BLK$ IN PROCEDURE PLOVER_COMMAND
     11323**DCL     11326<<ASSIGN  11338<<ASSIGN  11456>>IF      11457<>CALL
READ_COMMAND
     12270**PROC    10539--CALL    11457--CALL
READ_ERR
     10551**LABEL   10511--CALLALT 10539--CALLALT
READ_FILE
     10408**DCL     10547>>IF      10550<<ASSIGN  10573>>IF      12435<<ASSIGN
READ_OU
     11091**PROC    11042--CALL    11045--CALL    11591--CALL    11639--CALL    11810--CALL    11901--CALL
     12146--CALL
READ_OU_SEQ
     11147**PROC    11592--CALL    11599--CALL    11624--CALL    11629--CALL    11645--CALL    11811--CALL
RET IN PROCEDURE RUM_COMMAND
     11536**LABEL   11532--GOTO
RUM_COMMAND
     11465**PROC    10517--CALL
SECT# IN PROCEDURE SYMDEF_COMMAND
     11947**DCL     11984<<CALLBLT 11986>>IF
SECTION_KEY IN PROCEDURE GET_NUM_SECTS
     12016**DCL     12146--CALL
SECTION_KEY.PAGE IN PROCEDURE GET_NUM_SECTS
     12043**DCL     12143<<ASSIGN  12149<<ASSIGN  12149>>ASSIGN
SECTION_KEY.TYPE IN PROCEDURE GET_NUM_SECTS
     12025**DCL     12142<<ASSIGN
SECTION_KEY.UTS IN PROCEDURE GET_NUM_SECTS
     12022**DCL     12141<<ASSIGN
SEP IN PROCEDURE CHECK_UTS
     11259**DCL     11283>>CALLBLT 11285>>CALLBLT
SEQ IN PROCEDURE LIST_COMMAND
     11564**DCL     11696<<ASSIGN  11698<<ASSIGN  11698>>ASSIGN  11699--CALL
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:223  
SET_STEPCC_TO_4
      9172**DCL     10483<>CALL    10599<>CALL    10718<>CALL
SET_STEPCC_TO_4.V
      9172**DCL      9172--DCLINIT
SET_STEPCC_TO_4.V.STEPCC#
      9173**DCL      9173--REDEF
SYMDEF_COMMAND
     11944**PROC    10530--CALL
SYS_ACCT
      9597**DCL      9523--DCLINIT
TEMP IN PROCEDURE IDPATCH_COMMAND
     12454**DCL     12510<<CALLBLT 12511>>ASSIGN  12514<<CALLBLT 12515>>ASSIGN
TIME
     10406**DCL      9208--DCLINIT  9209--DCLINIT  9227--DCLINIT  9228--DCLINIT 11288<<ASSIGN  11672--CALL
     11680--CALL    11694>>CALLBLT 11913>>ASSIGN
TIME_UTS
      9206**DCL     11289<>CALL
TIME_UTS.V
      9210**DCL      9206--DCLINIT
TXT
     10416**DCL     10426--DCLINIT 10477<<ASSIGN  10479<>CALL    11045--CALL    11519<<ASSIGN  11547--CALL
     11591--CALL    11592--CALL    11599--CALL    11624--CALL    11629--CALL    11639--CALL    11645--CALL
     11699--CALL    11810--CALL    11811--CALL    11901--CALL    12004<<CALLBLT 12208<<CALLBLT 12260<<CALLBLT
TXT$
     10426**DCL     10250--IMP-PTR 11048>>ASSIGN  11049>>ASSIGN  11052>>ASSIGN  11053>>ASSIGN  11054>>ASSIGN
     11055>>ASSIGN  11061>>ASSIGN  11622>>IF      11662>>ASSIGN  11665>>CALL    11666>>ASSIGN  11673>>CALL
     11674>>CALL    11675>>IF      11678>>ASSIGN  11680>>CALL    11856>>IF      11872>>ASSIGN  11873>>ASSIGN
     11898>>ASSIGN  11929>>IF
U$$
      9703**DCL     10479<>CALL    10491<>CALL
UTS
     10414**DCL      9210--DCLINIT  9229--DCLINIT 11290>>IF      11636>>ASSIGN  11666<<ASSIGN  11678<<ASSIGN
     11692<<ASSIGN  11899>>ASSIGN
UTS_BLK$ IN PROCEDURE PLOVER_COMMAND
     11322**DCL     11330<<ASSIGN  11361<<ASSIGN  11364>>IF      11366<>CALL
UTS_TIME
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:224  
      9225**DCL     11667<>CALL    11679<>CALL    11693<>CALL
UTS_TIME.V
      9229**DCL      9225--DCLINIT
VAL IN PROCEDURE CHECK_UTS
     11257**DCL     11264<<CALLBLT 11265>>IF
VLP_ACCT
      9313**DCL     10941--DCLINIT 10976--ASSIGN  12396--DCLINIT 12417--ASSIGN
VLP_NAME
      9300**DCL     10941--DCLINIT 10974--ASSIGN  12396--DCLINIT 12413--ASSIGN
VLP_PASS
      9326**DCL     10942--DCLINIT 10980--ASSIGN  12397--DCLINIT 12421--ASSIGN
VLP_SN
      9339**DCL     10942--DCLINIT 10984--ASSIGN  12397--DCLINIT 12425--ASSIGN
VLP_WSN
      9352**DCL     10942--DCLINIT 10988--ASSIGN  12397--DCLINIT 12429--ASSIGN
VLR_FID
      9365**DCL     10944--DCLINIT 12399--DCLINIT
VLR_FID.ACCT
      9365**DCL     10975>>IF      12416>>IF
VLR_FID.NAME
      9365**DCL     10958>>IF      12412>>IF
VLR_FID.PASS
      9365**DCL     10979>>IF      12420>>IF
VLR_FID.SN
      9365**DCL     10983>>IF      12424>>IF
VLR_FID.WSN
      9365**DCL     10987>>IF      12428>>IF
WRITE_ERR IN PROCEDURE WRITE_PLOVER_REC
     11556**LABEL   11547--CALLALT 11551--CALLALT
WRITE_LO
     10723**PROC    11676--CALL    11695--CALL
WRITE_OU
     11204**PROC    11535--CALL    11547--CALL    11551--CALL    12252--CALL    12258--CALL    12518--CALL
WRITE_PLOVER_REC
     11544**PROC    11520--CALL    12006--CALL    12210--CALL    12263--CALL
X$WRITE
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:225  
      3398**DCL-ENT 11665--CALL    11672--CALL    11673--CALL    11674--CALL    11680--CALL    11699--CALL
XTX$ADAPT
      9621**DCL-ENT  9700--DCLINIT
XUH_PARAM
      9518**DCL     10502<>CALL    10505<>CALL    10508<>CALL
XUH_PARAM.HELP$
      9528**DCL     10500<<ASSIGN
XUH_PARAM.TOPICS#
      9532**DCL     10501<<ASSIGN
XUR$ALLMSG
      3510**DCL-ENT 10508--CALL
XUR$CLOSE_DCBS
      3502**DCL-ENT 10596--CALL
XUR$ERRMSG
      3499**DCL-ENT 10482--CALL    10549--CALL    10569--CALL    10585--CALL    10590--CALL    10717--CALL
     10969--CALL    11005--CALL    11014--CALL    11018--CALL    11080--CALL    11085--CALL    11278--CALL
     11292--CALL    11306--CALL    11355--CALL    11380--CALL    11405--CALL    11420--CALL    11436--CALL
     11451--CALL    11479--CALL    11496--CALL    11514--CALL    11537--CALL    11556--CALL    11582--CALL
     11613--CALL    11802--CALL    11830--CALL    11846--CALL    11864--CALL    11889--CALL    11923--CALL
     11961--CALL    11978--CALL    11999--CALL    12156--CALL    12162--CALL    12185--CALL    12202--CALL
     12230--CALL    12243--CALL    12439--CALL    12442--CALL    12470--CALL    12487--CALL    12521--CALL
XUR$ERRPTR
      3492**DCL-ENT 10481--CALL    10572--CALL
XUR$GETCMD
      3491**DCL-ENT 10479--CALL    10491--CALL
XUR$HELP
      3508**DCL-ENT 10502--CALL
XUR$INIT
      3496**DCL-ENT 10474--CALL
XUR$MOREMSG
      3509**DCL-ENT 10505--CALL
XUR$SETDCBS
      3495**DCL-ENT 10473--CALL
XUR_INIT
      9626**DCL     10474<>CALL
XUR_INIT.WORKR_
PL6.E3A0      #001=DPM$PLOVER File=DPM$PLOVER.:E05TSI                            TUE 07/29/97 14:44 Page:226  
      9640**DCL      9641--REDEF

PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:227  
     1211        1        /*M* DPM$PARSE_U$ - U$ routine used by X$PARSE.    */
     1212        2        /*T***********************************************************/
     1213        3        /*T*                                                         */
     1214        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1215        5        /*T*                                                         */
     1216        6        /*T***********************************************************/
     1217        7        /*P* NAME:        DPM$PARSE_U$
     1218        8             PURPOSE:     U$ routine used by X$PARSE
     1219        9             DESCRIPTION: Right now the only thing that this routine does is
     1220       10                          allow 'PL/OVER' to be the literal for PLOVER and
     1221       11                          'P/REV' to be the literal for the RUM command PREV.
     1222       12        */
     1223       13        DPM$PARSE_U$: PROC( PARSE_PARAM );
     1224       14
     1225       15        %INCLUDE XU_MACRO_C;
     1226     3121        %INCLUDE XU_SUBS_C;
     1227     3213        %INCLUDE DP_SUBS_C;
     1228     3275
     1229     3276        %PARSE$PARAM( NAME=PARSE_PARAM, STCLASS=" " );
     1230     3357
     1231     3358    1   DCL PLOVER_CMD BIT(1) STATIC INIT( '0'B );
     1232     3359
     1233     3360    2         DO CASE( PARSE_PARAM.TYPE );
     1234     3361    2           CASE( %PRE# );
     1235     3362    2             IF PARSE_PARAM.CODE = PREV_VAL THEN
     1236     3363    3                 IF PLOVER_CMD THEN DO;
     1237     3364    3                     PARSE_PARAM.REJECT  = '1'B;
     1238     3365    3                     PARSE_PARAM.CHARPOS = 0;
     1239     3366    3                     END;
     1240     3367    2                 ELSE  PARSE_PARAM.ACCEPT = '1'B;
     1241     3368    3             ELSE DO;
     1242     3369    3                 PLOVER_CMD = '0'B;
     1243     3370    3                 PARSE_PARAM.ACCEPT = '1'B;
     1244     3371    3                 END;
     1245     3372    2           CASE( %SUCC# );
     1246     3373    2             PLOVER_CMD = '1'B;
     1247     3374    2             PARSE_PARAM.ACCEPT = '1'B;
PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:228  
     1248     3375    2           END;
     1249     3376
     1250     3377    1   END DPM$PARSE_U$;

PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:229  
--  Include file information  --

   DP_SUBS_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DPM$PARSE_U$.

   Procedure DPM$PARSE_U$ requires 32 words for executable code.
   Procedure DPM$PARSE_U$ requires 4 words of local(AUTO) storage.

    No errors detected in file DPM$PLOVER.:E05TSI    .

PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:230  

 Object Unit name= DPM$PARSE_U$                               File name= DPM$PLOVER.:E05TOU
 UTS= JUL 29 '97 14:45:27.16 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     1      1  DPM$PARSE_U$
    1   Proc  even  none    32     40  DPM$PARSE_U$

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  DPM$PARSE_U$

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:231  


     1211        1        /*M* DPM$PARSE_U$ - U$ routine used by X$PARSE.    */
     1212        2        /*T***********************************************************/
     1213        3        /*T*                                                         */
     1214        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1215        5        /*T*                                                         */
     1216        6        /*T***********************************************************/
     1217        7        /*P* NAME:        DPM$PARSE_U$
     1218        8             PURPOSE:     U$ routine used by X$PARSE
     1219        9             DESCRIPTION: Right now the only thing that this routine does is
     1220       10                          allow 'PL/OVER' to be the literal for PLOVER and
     1221       11                          'P/REV' to be the literal for the RUM command PREV.
     1222       12        */
     1223       13        DPM$PARSE_U$: PROC( PARSE_PARAM );

     13  1 000000   000000 700200 xent  DPM$PARSE_U$ TSX0  ! X66_AUTO_1
         1 000001   000004 000001                    ZERO    4,1

     1224       14
     1225       15        %INCLUDE XU_MACRO_C;
     1226     3121        %INCLUDE XU_SUBS_C;
     1227     3213        %INCLUDE DP_SUBS_C;
     1228     3275
     1229     3276        %PARSE$PARAM( NAME=PARSE_PARAM, STCLASS=" " );
     1230     3357
     1231     3358    1   DCL PLOVER_CMD BIT(1) STATIC INIT( '0'B );
     1232     3359
     1233     3360    2         DO CASE( PARSE_PARAM.TYPE );

   3360  1 000002   200003 470500                    LDP0    @PARSE_PARAM,,AUTO
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000033 772000                    QRL     27
         1 000005   000003 116007                    CMPQ    3,DL
         1 000006   000010 602006 1                  TNC     s:3360+6,QL
         1 000007   000037 710000 1                  TRA     s:3377
         1 000010   000037 710000 1                  TRA     s:3377
         1 000011   000013 710000 1                  TRA     s:3362
PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:232  
         1 000012   000033 710000 1                  TRA     s:3373

     1234     3361    2           CASE( %PRE# );

     1235     3362    2             IF PARSE_PARAM.CODE = PREV_VAL THEN

   3362  1 000013   000000 720100                    LXL0    0,,PR0
         1 000014   000022 100003                    CMPX0   18,DU
         1 000015   000027 601000 1                  TNZ     s:3369

     1236     3363    3                 IF PLOVER_CMD THEN DO;

   3363  1 000016   000000 234000 0                  SZN     PLOVER_CMD
         1 000017   000024 605000 1                  TPL     s:3367

     1237     3364    3                     PARSE_PARAM.REJECT  = '1'B;

   3364  1 000020   000200 236003                    LDQ     128,DU
         1 000021   000000 256100                    ORSQ    0,,PR0

     1238     3365    3                     PARSE_PARAM.CHARPOS = 0;

   3365  1 000022   000004 450100                    STZ     4,,PR0

     1239     3366    3                     END;

   3366  1 000023   000037 710000 1                  TRA     s:3377

     1240     3367    2                 ELSE  PARSE_PARAM.ACCEPT = '1'B;

   3367  1 000024   000400 236003                    LDQ     256,DU
         1 000025   000000 256100                    ORSQ    0,,PR0
         1 000026   000037 710000 1                  TRA     s:3377

     1241     3368    3             ELSE DO;

     1242     3369    3                 PLOVER_CMD = '0'B;
PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:233  

   3369  1 000027   000000 450000 0                  STZ     PLOVER_CMD

     1243     3370    3                 PARSE_PARAM.ACCEPT = '1'B;

   3370  1 000030   000400 236003                    LDQ     256,DU
         1 000031   000000 256100                    ORSQ    0,,PR0

     1244     3371    3                 END;

   3371  1 000032   000037 710000 1                  TRA     s:3377

     1245     3372    2           CASE( %SUCC# );

     1246     3373    2             PLOVER_CMD = '1'B;

   3373  1 000033   400000 236003                    LDQ     -131072,DU
         1 000034   000000 756000 0                  STQ     PLOVER_CMD

     1247     3374    2             PARSE_PARAM.ACCEPT = '1'B;

   3374  1 000035   000400 236003                    LDQ     256,DU
         1 000036   000000 256100                    ORSQ    0,,PR0

     1248     3375    2           END;

     1249     3376
     1250     3377    1   END DPM$PARSE_U$;

   3377  1 000037   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:234  
--  Include file information  --

   DP_SUBS_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DPM$PARSE_U$.
PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:235  

 **** Variables and constants ****

  ****  Section 000  Data  DPM$PARSE_U$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 PLOVER_CMD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARSE_PARAM              *0-0-0/w STRC(270)   r     1 PARSE_PARAM


   Procedure DPM$PARSE_U$ requires 32 words for executable code.
   Procedure DPM$PARSE_U$ requires 4 words of local(AUTO) storage.

    No errors detected in file DPM$PLOVER.:E05TSI    .
PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:236  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=DPM$PARSE_U$ File=DPM$PLOVER.:E05TSI                          TUE 07/29/97 14:45 Page:237  
          MINI XREF LISTING

PARSE_PARAM
      3295**DCL        13--PROC
PARSE_PARAM.ACCEPT
      3302**DCL      3367<<ASSIGN   3370<<ASSIGN   3374<<ASSIGN
PARSE_PARAM.CHARPOS
      3333**DCL      3365<<ASSIGN
PARSE_PARAM.CODE
      3316**DCL      3362>>IF
PARSE_PARAM.REJECT
      3307**DCL      3364<<ASSIGN
PARSE_PARAM.TYPE
      3296**DCL      3360>>DOCASE
PLOVER_CMD
      3358**DCL      3363>>IF       3369<<ASSIGN   3373<<ASSIGN
