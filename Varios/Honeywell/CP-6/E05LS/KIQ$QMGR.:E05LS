VERSION E05

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:1    
        1        1        /*M* KIQ$QMGR - Manage Host circular queues  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8
        9        9        /*P*
       10       10             NAME: KIQ$QMGR
       11       11             PURPOSE: This module contains all the routine to handle the
       12       12                      host to fron end interface.
       13       13         */
       14       14
       15       15
       16       16        KIQ$ISCAN: PROC (FEI);
       17       17
       18       18        /*F* NAME: KIQ$ISCAN
       19       19             PURPOSE: This routine does the initial scaning of a message
       20       20                      received from a front end and perform the necessary
       21       21                      link layer function.
       22       22             DESCRIPTION: On an interupt from a front end this routine is called
       23       23                          by KIQ$FEINT with the FEI of the FEP. KIQ$ISCAN then
       24       24                          scans the circular queues for any messages that are
       25       25                          waiting and checks them for a link layer function. If
       26       26                          the message is data for a user it is then passed on
       27       27                          to KIN$NETWORK to do the processing. KIN$NETWORK will
       28       28                          return if the message was handled or ALTRET if it can
       29       29                          not handle the message right now. There are two errors
       30       30                          that KIN$NETWORK can specify: K$WAIT_READ say to keep
       31       31                          scanning the queue and there will be a read function
       32       32                          to pick up the message later or K$DEFER_IO which says
       33       33                          to recall KIN$NETWORK at a later time with this message.
       34       34         */
       35       35
       36       36        %PLIST;
       37       37        %INCLUDE KI$QHDR;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:2    
       38      189        %INCLUDE KI$MHDR;
       39      330        %INCLUDE KI_DATA_R;
       40      356        %INCLUDE KI_MACROS_C;
       41      964        %INCLUDE KJ_FCNS_C;
       42      991        %INCLUDE KI_SUBS_C;
       43     1127        %INCLUDE K_SUBS_C;
       44     1160        %INCLUDE K$RWPARM;
       45     1546        %INCLUDE HF_LOCK_C;
       46     1560
       47     1561        %KI$QMHDR;
       48     1610        %K$RWPARM (NAME=K$RWPARM);
       49     1926        %KI$FEI (STCLASS="BASED(FEI$)");
       50     2010
       51     2011
       52     2012    1   DCL FEI UBIN(36);
       53     2013    1   DCL FEI$ PTR;
       54     2014    1   DCL ICQ$ PTR;
       55     2015    1   DCL IP$ PTR;
       56     2016    1   DCL TEMP1 SBIN WORD;
       57     2017    1   DCL MSIZW UBIN(36);
       58     2018    1   DCL MYIP SBIN WORD;
       59     2019    1   DCL SVMYI SBIN WORD;
       60     2020    1   DCL SCANSZ SBIN;
       61     2021
       62     2022    1   DCL TIPTR SBIN WORD;
       63     2023    1   DCL TRPTR SBIN WORD;
       64     2024    1   DCL STEMP2 SBIN WORD;
       65     2025    1   DCL IPP$ PTR;
       66     2026
       67     2027
       68     2028        /* Entry references */
       69     2029    1   DCL KIQ$FEABT ENTRY(2);
       70     2030    1   DCL KIN$RECV ENTRY(1) ALTRET;
       71     2031
       72     2032        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
       73     2348
       74     2349        %LIST;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:3    
       75     2350
       76     2351        /*X* DMR,PLM=5,IND=3,CTI=2,SDI=5,MCL=10,CSI=1,DTI=2,DCI=3,ECI=0,AND */
       77     2352
       78     2353        %EJECT ;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:4    
       79     2354
       80     2355    1        FEI$ = KI$FEI$(FEI);
       81     2356    1        ICQ$=KI$FEI.ICQ$;
       82     2357    1        SVMYI=ICQ$->KI$QHDR.MYIPTR;
       83     2358    1        TEMP1 = ICQ$->KI$QHDR.QSIZE ;
       84     2359
       85     2360        /* Compute the size of the queue that needs to be scanned */
       86     2361    1        SCANSZ = ICQ$->KI$QHDR.IPTR - SVMYI;
       87     2362        /* Check to see if there is anything in the queue to scan */
       88     2363    1        IF SCANSZ > 0 THEN
       89     2364    1           GOTO L_ENTER_LUP ;
       90     2365    1        IF SCANSZ < 0
       91     2366    1        THEN
       92     2367    2          DO ;
       93     2368    2             SCANSZ = SCANSZ + TEMP1 ;
       94     2369    2             IF SCANSZ > 0 THEN
       95     2370    2                GOTO L_ENTER_LUP ;
       96     2371    2             IF SCANSZ < 0
       97     2372    2             THEN
       98     2373    3               DO ;
       99     2374    3   L_FEABT:
      100     2375    3                  CALL KIQ$FEABT (FEI,KIER_MFMT);
      101     2376    3                  RETURN;
      102     2377    3               END;
      103     2378
      104     2379    2          END ;
      105     2380
      106     2381    1        KI$FEI.FROZEN  = '0'B;
      107     2382
      108     2383    1   L_RELQ_OUT:
      109     2384    1        CALL KIQQ$RELQ ;
      110     2385    1        RETURN;
      111     2386
      112     2387        %EJECT ;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:5    
      113     2388    1   L_RENTER_LUP:
      114     2389    1        SVMYI=MYIP;
      115     2390    1   L_ENTER_LUP:
      116     2391    1        IP$=PINCRW(ICQ$,SVMYI+SIZEW(KI$QHDR));
      117     2392    1        MSIZW = ( 256*IP$->KI$QMHDR.MSGSZB.TOP + IP$->KI$QMHDR.MSGSZB.BOT
      118     2393    1          + 3 + 4*SIZEW(KI$QMHDR) ) / 4 ;
      119     2394    1        MYIP=SVMYI+MSIZW;
      120     2395    1        IF MYIP >= TEMP1 THEN
      121     2396    2          DO ;
      122     2397    2             CALL KIQQ$RELQ ;
      123     2398    2             MYIP=0;
      124     2399    2             IP$->KI$QMHDR.ACTSZ=MSIZW;
      125     2400    2             ICQ$->KI$QHDR.MYIPTR=0;
      126     2401    2          END;
      127     2402    1        ELSE
      128     2403    2          DO ;
      129     2404    2             ICQ$->KI$QHDR.MYIPTR=MYIP;
      130     2405    2             IP$->KI$QMHDR.ACTSZ=MSIZW;
      131     2406    2          END ;
      132     2407    2        IF IP$->KI$QMHDR.FEI# ~= FEI THEN DO;
      133     2408    2             IP$->KI$QMHDR.UID_R.TOP = IP$->KI$QMHDR.OFFSET;
      134     2409    2             IP$->KI$QMHDR.UID_R.BOT = IP$->KI$QMHDR.SIZE;
      135     2410        /* save lastiptr before the Q code can trash it then trash offset */
      136     2411        /*and size so they dont cause problems*/
      137     2412    2             IP$->KI$QMHDR.OFFSET = 0;
      138     2413    2             IP$->KI$QMHDR.SIZE = 0;
      139     2414    2          END;
      140     2415    1        IF IP$->KI$QMHDR.FUNCTION = %KJ_FCN_IDATA THEN
      141     2416    2          DO ;
      142     2417    2             K$RWPARM = K_RWPARM_CON;
      143     2418    2             K$RWPARM.IP$ = IP$;
      144     2419    2             IP$->KI$QMHDR.FEI# = FEI;
      145     2420    2             K$RWPARM.NHDR$ = PINCRC(IP$,SIZEC(KI$QMHDR));
      146     2421    2             K$RWPARM.NHDRSZ = IP$->KI$QMHDR.MSGSZB.TOP*256 + IP$->KI$QMHDR.MSGSZB.BOT;
      147     2422    2             K$RWPARM.FUNCTION = %K_RECV;
      148     2423    2             K$RWPARM.FEX = FEI;
      149     2424    2             CALL KIN$RECV (K$RWPARM) ALTRET(GETOUT);
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:6    
      150     2425
      151     2426    2   L_LUUP:
      152     2427    2             IP$->KI$QMHDR.FREFLG='1'B;
      153     2428    2   L_LUUP1:
      154     2429    2             SCANSZ = SCANSZ - MSIZW;
      155     2430    2             IF SCANSZ > 0 THEN
      156     2431    2                GOTO L_RENTER_LUP ;
      157     2432    2             KI$FEI.FROZEN  = '0'B;
      158     2433    3             IF SCANSZ = 0 THEN DO;
      159     2434    3                  GOTO L_RELQ_OUT ;
      160     2435    3               END;
      161     2436    2             GOTO L_FEABT ;
      162     2437
      163     2438    2          END ;
      164     2439
      165     2440    1        IF IP$->KI$QMHDR.FUNCTION = %KJ_FCN_NOPI THEN
      166     2441    2          DO ;
      167     2442    2             IP$->KI$QMHDR.FREFLG='1'B;
      168     2443    2             IP$->KI$QMHDR.FEI# = FEI;
      169     2444    2             GOTO L_LUUP1 ;
      170     2445    2          END ;
      171     2446    1        ELSE
      172     2447    1           IF IP$->KI$QMHDR.FUNCTION = %KJ_FCN_TIM
      173     2448    2           THEN DO;
      174     2449    2                KI$FEI.TCNT = KI$FEI.TCNT + 1;
      175     2450    2                IP$->KI$QMHDR.FEI# = FEI;
      176     2451    2             END;
      177     2452
      178     2453    1           ELSE
      179     2454
      180     2455    1              CALL KIQ$FEABT(FEI,KIER_BFCN);
      181     2456    1        GOTO L_LUUP ;
      182     2457
      183     2458    1   GETOUT: ;
      184     2459
      185     2460        /* Some error has occured the three errors that are legal are
      186     2461             K$BAD_LDCTX - KIS$SESSION sez crash the FEP for dump analysis
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:7    
      187     2462             K$DEFER_IO - tells to stop scanning
      188     2463             K$WAIT_READ - Continue scanning but wait for a read on the currennt message
      189     2464         */
      190     2465    1        IF K$RWPARM.ERR ~= %K$WAIT_READ
      191     2466    1        THEN
      192     2467    2          DO ;
      193     2468    2             IF K$RWPARM.ERR = %K$BAD_LDCTX THEN
      194     2469    2                GOTO L_FEABT;              /* crash the sucker !NOW! */
      195     2470    2             KI$FEI.FROZEN  = '1'B;
      196     2471    2             ICQ$->KI$QHDR.MYIPTR=SVMYI;
      197     2472    2             GOTO L_RELQ_OUT ;
      198     2473    2          END;
      199     2474    1        SCANSZ = SCANSZ - MSIZW;
      200     2475    1        CALL KIQQ$RELQ ;
      201     2476    1        IF MYIP~=ICQ$->KI$QHDR.IPTR
      202     2477    1        THEN
      203     2478    2          DO ;
      204     2479    2             IF SCANSZ > 0 THEN
      205     2480    2                GOTO L_RENTER_LUP ;
      206     2481    2             IF SCANSZ < 0 THEN
      207     2482    2                GOTO L_FEABT ;
      208     2483
      209     2484    2          END ;
      210     2485    1        RETURN;
      211     2486
      212     2487
      213     2488
      214     2489        %EJECT ;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:8    
      215     2490
      216     2491
      217     2492    1   KIQ$RELQ: ENTRY (FEI) ;
      218     2493
      219     2494        /*F*
      220     2495             NAME: KIQ$RELQ
      221     2496             PURPOSE:
      222     2497                  KIQ$RELQ updates the removal pointer to the first not processed
      223     2498                  message.
      224     2499             DESCRIPTION:
      225     2500                  The input circular queue is scanned from the removal pointer
      226     2501                  to MYIPTR updating the remove pointer to the first nonprocessed
      227     2502                  message.
      228     2503        */
      229     2504
      230     2505    1        FEI$ = KI$FEI$(FEI);
      231     2506    1        ICQ$=KI$FEI.ICQ$;
      232     2507    1        TEMP1 = ICQ$->KI$QHDR.QSIZE ;
      233     2508    1        CALL KIQQ$RELQ ;
      234     2509    1        RETURN ;
      235     2510
      236     2511        %EJECT ;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:9    
      237     2512    1   KIQQ$RELQ: PROC ;
      238     2513             %LOCK (G#="ICQ$->KI$QHDR.GATE");
              2514    2   CALL HFC$LOCK(G# G);
      239     2516
      240     2517    2        TIPTR=ICQ$->KI$QHDR.MYIPTR;
      241     2518    2        STEMP2 = TIPTR ;
      242     2519    2        TRPTR=ICQ$->KI$QHDR.RPTR;
      243     2520    2        IF TIPTR<TRPTR THEN
      244     2521    2           TIPTR=TEMP1 ;
      245     2522    2        IF TRPTR >= TIPTR THEN
      246     2523    3          DO ;
      247     2524    3             ICQ$->KI$QHDR.RPTR=TRPTR;
      248     2525    3             GOTO UNLK ;
      249     2526    3          END ;
      250     2527
      251     2528    2        IPP$=PINCRW(ICQ$,TRPTR+SIZEW(KI$QHDR));
      252     2529    2   L_LUUP:
      253     2530    2        IF IPP$->KI$QMHDR.FREFLG='0'B THEN
      254     2531    3          DO ;
      255     2532    3             ICQ$->KI$QHDR.RPTR=TRPTR;
      256     2533    3             GOTO UNLK ;
      257     2534    3          END ;
      258     2535    2        TRPTR=TRPTR+IPP$->KI$QMHDR.ACTSZ;
      259     2536    2        IF TRPTR>=TEMP1 THEN
      260     2537    3          DO ;
      261     2538    3             TRPTR=0;
      262     2539    3             TIPTR=STEMP2;
      263     2540    3          END;
      264     2541    2        IF TRPTR < TIPTR THEN
      265     2542    3          DO ;
      266     2543    3             IPP$=PINCRW(ICQ$,TRPTR+SIZEW(KI$QHDR));
      267     2544    3             GOTO L_LUUP ;
      268     2545    3          END ;
      269     2546    2        ICQ$->KI$QHDR.RPTR=TRPTR;
      270     2547    2   UNLK: ;
      271     2548             %UNLOCK (G#="ICQ$->KI$QHDR.GATE");
              2549    2   CALL HFC$UNLOCK(G# G);
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:10   
      272     2551    2        RETURN;
      273     2552
      274     2553
      275     2554    2   END KIQQ$RELQ ;
      276     2555
      277     2556
      278     2557    1   END KIQ$ISCAN;
      279     2558
      280     2559        %EOD;

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:11   
--  Include file information  --

   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI$MHDR.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$ISCAN.

   Procedure KIQ$ISCAN requires 283 words for executable code.
   Procedure KIQ$ISCAN requires 60 words of local(AUTO) storage.

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:12   

 Object Unit name= KIQ$ISCAN                                  File name= KIQ$QMGR.:E05TOU
 UTS= JUL 30 '97 00:37:39.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   283    433  KIQ$ISCAN
    1  RoData even  none     3      3  KIQ$ISCAN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  KIQ$ISCAN
     0    303                  yes      Std        1  KIQ$RELQ

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 KIQ$FEABT
 yes     yes           Std       1 KIN$RECV
         yes           Std       1 HFC$LOCK
         yes           Std       1 HFC$UNLOCK
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KI_FEI$$                              K_RWPARM_CON                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:14   


        1        1        /*M* KIQ$QMGR - Manage Host circular queues  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CTI=5,SDI=5,MCL=10,CSI=0,ECI=0 */
        8        8
        9        9        /*P*
       10       10             NAME: KIQ$QMGR
       11       11             PURPOSE: This module contains all the routine to handle the
       12       12                      host to fron end interface.
       13       13         */
       14       14
       15       15
       16       16        KIQ$ISCAN: PROC (FEI);

     16  0 000000   000000 700200 xent  KIQ$ISCAN    TSX0  ! X66_AUTO_1
         0 000001   000074 000001                    ZERO    60,1

       17       17
       18       18        /*F* NAME: KIQ$ISCAN
       19       19             PURPOSE: This routine does the initial scaning of a message
       20       20                      received from a front end and perform the necessary
       21       21                      link layer function.
       22       22             DESCRIPTION: On an interupt from a front end this routine is called
       23       23                          by KIQ$FEINT with the FEI of the FEP. KIQ$ISCAN then
       24       24                          scans the circular queues for any messages that are
       25       25                          waiting and checks them for a link layer function. If
       26       26                          the message is data for a user it is then passed on
       27       27                          to KIN$NETWORK to do the processing. KIN$NETWORK will
       28       28                          return if the message was handled or ALTRET if it can
       29       29                          not handle the message right now. There are two errors
       30       30                          that KIN$NETWORK can specify: K$WAIT_READ say to keep
       31       31                          scanning the queue and there will be a read function
       32       32                          to pick up the message later or K$DEFER_IO which says
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:15   
       33       33                          to recall KIN$NETWORK at a later time with this message.
       34       34         */
       35       35
       36       36        %PLIST;
       37       37        %INCLUDE KI$QHDR;
       38      189        %INCLUDE KI$MHDR;
       39      330        %INCLUDE KI_DATA_R;
       40      356        %INCLUDE KI_MACROS_C;
       41      964        %INCLUDE KJ_FCNS_C;
       42      991        %INCLUDE KI_SUBS_C;
       43     1127        %INCLUDE K_SUBS_C;
       44     1160        %INCLUDE K$RWPARM;
       45     1546        %INCLUDE HF_LOCK_C;
       46     1560
       47     1561        %KI$QMHDR;
       48     1610        %K$RWPARM (NAME=K$RWPARM);
       49     1926        %KI$FEI (STCLASS="BASED(FEI$)");
       50     2010
       51     2011
       52     2012    1   DCL FEI UBIN(36);
       53     2013    1   DCL FEI$ PTR;
       54     2014    1   DCL ICQ$ PTR;
       55     2015    1   DCL IP$ PTR;
       56     2016    1   DCL TEMP1 SBIN WORD;
       57     2017    1   DCL MSIZW UBIN(36);
       58     2018    1   DCL MYIP SBIN WORD;
       59     2019    1   DCL SVMYI SBIN WORD;
       60     2020    1   DCL SCANSZ SBIN;
       61     2021
       62     2022    1   DCL TIPTR SBIN WORD;
       63     2023    1   DCL TRPTR SBIN WORD;
       64     2024    1   DCL STEMP2 SBIN WORD;
       65     2025    1   DCL IPP$ PTR;
       66     2026
       67     2027
       68     2028        /* Entry references */
       69     2029    1   DCL KIQ$FEABT ENTRY(2);
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:16   
       70     2030    1   DCL KIN$RECV ENTRY(1) ALTRET;
       71     2031
       72     2032        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
       73     2348
       74     2349        %LIST;
       75     2350
       76     2351        /*X* DMR,PLM=5,IND=3,CTI=2,SDI=5,MCL=10,CSI=1,DTI=2,DCI=3,ECI=0,AND */
       77     2352
       78     2353        %EJECT ;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:17   
       79     2354
       80     2355    1        FEI$ = KI$FEI$(FEI);

   2355  0 000002   200003 470500                    LDP0    @FEI,,AUTO
         0 000003   000000 720100                    LXL0    0,,PR0
         0 000004   000000 471400 xsym               LDP1    KI_FEI$$
         0 000005   100000 236110                    LDQ     0,X0,PR1
         0 000006   200054 756100                    STQ     FEI$,,AUTO

       81     2356    1        ICQ$=KI$FEI.ICQ$;

   2356  0 000007   200054 473500                    LDP3    FEI$,,AUTO
         0 000010   300004 236100                    LDQ     4,,PR3
         0 000011   200055 756100                    STQ     ICQ$,,AUTO

       82     2357    1        SVMYI=ICQ$->KI$QHDR.MYIPTR;

   2357  0 000012   200055 474500                    LDP4    ICQ$,,AUTO
         0 000013   400010 235100                    LDA     8,,PR4
         0 000014   200062 755100                    STA     SVMYI,,AUTO

       83     2358    1        TEMP1 = ICQ$->KI$QHDR.QSIZE ;

   2358  0 000015   400005 236100                    LDQ     5,,PR4
         0 000016   000004 772000                    QRL     4
         0 000017   200057 756100                    STQ     TEMP1,,AUTO

       84     2359
       85     2360        /* Compute the size of the queue that needs to be scanned */
       86     2361    1        SCANSZ = ICQ$->KI$QHDR.IPTR - SVMYI;

   2361  0 000020   400012 236100                    LDQ     10,,PR4
         0 000021   000004 772000                    QRL     4
         0 000022   200062 136100                    SBLQ    SVMYI,,AUTO
         0 000023   200063 756100                    STQ     SCANSZ,,AUTO

       87     2362        /* Check to see if there is anything in the queue to scan */
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:18   
       88     2363    1        IF SCANSZ > 0 THEN

   2363  0 000024   000051 605400 0                  TPNZ    L_ENTER_LUP

       89     2364    1           GOTO L_ENTER_LUP ;
       90     2365    1        IF SCANSZ < 0

   2365  0 000025   000042 605000 0                  TPL     s:2381

       91     2366    1        THEN
       92     2367    2          DO ;

       93     2368    2             SCANSZ = SCANSZ + TEMP1 ;

   2368  0 000026   200057 036100                    ADLQ    TEMP1,,AUTO
         0 000027   200063 756100                    STQ     SCANSZ,,AUTO

       94     2369    2             IF SCANSZ > 0 THEN

   2369  0 000030   000051 605400 0                  TPNZ    L_ENTER_LUP

       95     2370    2                GOTO L_ENTER_LUP ;
       96     2371    2             IF SCANSZ < 0

   2371  0 000031   000042 605000 0                  TPL     s:2381

       97     2372    2             THEN
       98     2373    3               DO ;

       99     2374    3   L_FEABT:
      100     2375    3                  CALL KIQ$FEABT (FEI,KIER_MFMT);

   2375  0 000032   000000 236000 1     L_FEABT      LDQ     0
         0 000033   200003 235100                    LDA     @FEI,,AUTO
         0 000034   200072 757100                    STAQ    IPP$+3,,AUTO
         0 000035   200072 630500                    EPPR0   IPP$+3,,AUTO
         0 000036   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:19   
         0 000037   000000 701000 xent               TSX1    KIQ$FEABT
         0 000040   000000 011000                    NOP     0

      101     2376    3                  RETURN;

   2376  0 000041   000000 702200 xent               TSX2  ! X66_ARET

      102     2377    3               END;
      103     2378
      104     2379    2          END ;
      105     2380
      106     2381    1        KI$FEI.FROZEN  = '0'B;

   2381  0 000042   000031 236000 xsym               LDQ     B_VECTNIL+25
         0 000043   300007 356100                    ANSQ    7,,PR3

      107     2382
      108     2383    1   L_RELQ_OUT:
      109     2384    1        CALL KIQQ$RELQ ;

   2384  0 000044   000324 701000 0     L_RELQ_OUT   TSX1    KIQQ$RELQ
         0 000045   000000 011000                    NOP     0

      110     2385    1        RETURN;

   2385  0 000046   000000 702200 xent               TSX2  ! X66_ARET

      111     2386
      112     2387        %EJECT ;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:20   
      113     2388    1   L_RENTER_LUP:
      114     2389    1        SVMYI=MYIP;

   2389  0 000047   200061 235100       L_RENTER_LUP LDA     MYIP,,AUTO
         0 000050   200062 755100                    STA     SVMYI,,AUTO

      115     2390    1   L_ENTER_LUP:
      116     2391    1        IP$=PINCRW(ICQ$,SVMYI+SIZEW(KI$QHDR));

   2391  0 000051   200062 236100       L_ENTER_LUP  LDQ     SVMYI,,AUTO
         0 000052   000022 736000                    QLS     18
         0 000053   000020 036003                    ADLQ    16,DU
         0 000054   200055 036100                    ADLQ    ICQ$,,AUTO
         0 000055   200056 756100                    STQ     IP$,,AUTO

      117     2392    1        MSIZW = ( 256*IP$->KI$QMHDR.MSGSZB.TOP + IP$->KI$QMHDR.MSGSZB.BOT

   2392  0 000056   200056 470500                    LDP0    IP$,,AUTO
         0 000057   000003 236100                    LDQ     3,,PR0
         0 000060   000377 376007                    ANQ     255,DL
         0 000061   200072 756100                    STQ     IPP$+3,,AUTO
         0 000062   000003 236100                    LDQ     3,,PR0
         0 000063   000001 772000                    QRL     1
         0 000064   177400 376007                    ANQ     65280,DL
         0 000065   200072 036100                    ADLQ    IPP$+3,,AUTO
         0 000066   000023 036007                    ADLQ    19,DL
         0 000067   000002 772000                    QRL     2
         0 000070   200060 756100                    STQ     MSIZW,,AUTO

      118     2393    1          + 3 + 4*SIZEW(KI$QMHDR) ) / 4 ;
      119     2394    1        MYIP=SVMYI+MSIZW;

   2394  0 000071   200062 036100                    ADLQ    SVMYI,,AUTO
         0 000072   200061 756100                    STQ     MYIP,,AUTO

      120     2395    1        IF MYIP >= TEMP1 THEN

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:21   
   2395  0 000073   200057 116100                    CMPQ    TEMP1,,AUTO
         0 000074   000106 604000 0                  TMI     s:2404

      121     2396    2          DO ;

      122     2397    2             CALL KIQQ$RELQ ;

   2397  0 000075   000324 701000 0                  TSX1    KIQQ$RELQ
         0 000076   000000 011000                    NOP     0

      123     2398    2             MYIP=0;

   2398  0 000077   200061 450100                    STZ     MYIP,,AUTO

      124     2399    2             IP$->KI$QMHDR.ACTSZ=MSIZW;

   2399  0 000100   200060 720100                    LXL0    MSIZW,,AUTO
         0 000101   200056 470500                    LDP0    IP$,,AUTO
         0 000102   000000 440100                    SXL0    0,,PR0

      125     2400    2             ICQ$->KI$QHDR.MYIPTR=0;

   2400  0 000103   200055 471500                    LDP1    ICQ$,,AUTO
         0 000104   100010 450100                    STZ     8,,PR1

      126     2401    2          END;

   2401  0 000105   000112 710000 0                  TRA     s:2407

      127     2402    1        ELSE
      128     2403    2          DO ;

      129     2404    2             ICQ$->KI$QHDR.MYIPTR=MYIP;

   2404  0 000106   200055 471500                    LDP1    ICQ$,,AUTO
         0 000107   100010 756100                    STQ     8,,PR1

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:22   
      130     2405    2             IP$->KI$QMHDR.ACTSZ=MSIZW;

   2405  0 000110   200060 720100                    LXL0    MSIZW,,AUTO
         0 000111   000000 440100                    SXL0    0,,PR0

      131     2406    2          END ;

      132     2407    2        IF IP$->KI$QMHDR.FEI# ~= FEI THEN DO;

   2407  0 000112   200003 473500                    LDP3    @FEI,,AUTO
         0 000113   000000 236100                    LDQ     0,,PR0
         0 000114   000033 772000                    QRL     27
         0 000115   000377 376007                    ANQ     255,DL
         0 000116   300000 116100                    CMPQ    0,,PR3
         0 000117   000127 600000 0                  TZE     s:2415

      133     2408    2             IP$->KI$QMHDR.UID_R.TOP = IP$->KI$QMHDR.OFFSET;

   2408  0 000120   000001 221100                    LDX1    1,,PR0
         0 000121   000002 741100                    STX1    2,,PR0

      134     2409    2             IP$->KI$QMHDR.UID_R.BOT = IP$->KI$QMHDR.SIZE;

   2409  0 000122   000001 722100                    LXL2    1,,PR0
         0 000123   000002 442100                    SXL2    2,,PR0

      135     2410        /* save lastiptr before the Q code can trash it then trash offset */
      136     2411        /*and size so they dont cause problems*/
      137     2412    2             IP$->KI$QMHDR.OFFSET = 0;

   2412  0 000124   000000 223003                    LDX3    0,DU
         0 000125   000001 743100                    STX3    1,,PR0

      138     2413    2             IP$->KI$QMHDR.SIZE = 0;

   2413  0 000126   000001 443100                    SXL3    1,,PR0

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:23   
      139     2414    2          END;

      140     2415    1        IF IP$->KI$QMHDR.FUNCTION = %KJ_FCN_IDATA THEN

   2415  0 000127   000000 236100                    LDQ     0,,PR0
         0 000130   000777 376003                    ANQ     511,DU
         0 000131   000005 116003                    CMPQ    5,DU
         0 000132   000210 601000 0                  TNZ     s:2440

      141     2416    2          DO ;

      142     2417    2             K$RWPARM = K_RWPARM_CON;

   2417  0 000133   000100 100400                    MLR     fill='000'O
         0 000134   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         0 000135   200004 000234                    ADSC9   K$RWPARM,,AUTO           cn=0,n=156

      143     2418    2             K$RWPARM.IP$ = IP$;

   2418  0 000136   200056 236100                    LDQ     IP$,,AUTO
         0 000137   200016 756100                    STQ     K$RWPARM+10,,AUTO

      144     2419    2             IP$->KI$QMHDR.FEI# = FEI;

   2419  0 000140   300000 236100                    LDQ     0,,PR3
         0 000141   000033 736000                    QLS     27
         0 000142   000000 676100                    ERQ     0,,PR0
         0 000143   377000 376003                    ANQ     130560,DU
         0 000144   000000 656100                    ERSQ    0,,PR0

      145     2420    2             K$RWPARM.NHDR$ = PINCRC(IP$,SIZEC(KI$QMHDR));

   2420  0 000145   200056 236100                    LDQ     IP$,,AUTO
         0 000146   000004 036003                    ADLQ    4,DU
         0 000147   200032 756100                    STQ     K$RWPARM+22,,AUTO

      146     2421    2            K$RWPARM.NHDRSZ = IP$->KI$QMHDR.MSGSZB.TOP*256 + IP$->KI$QMHDR.MSGSZB.BOT;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:24   

   2421  0 000150   000003 236100                    LDQ     3,,PR0
         0 000151   000377 376007                    ANQ     255,DL
         0 000152   200072 756100                    STQ     IPP$+3,,AUTO
         0 000153   000003 236100                    LDQ     3,,PR0
         0 000154   000001 772000                    QRL     1
         0 000155   177400 376007                    ANQ     65280,DL
         0 000156   200072 036100                    ADLQ    IPP$+3,,AUTO
         0 000157   200033 756100                    STQ     K$RWPARM+23,,AUTO

      147     2422    2             K$RWPARM.FUNCTION = %K_RECV;

   2422  0 000160   000005 235007                    LDA     5,DL
         0 000161   200024 755100                    STA     K$RWPARM+16,,AUTO

      148     2423    2             K$RWPARM.FEX = FEI;

   2423  0 000162   300000 235100                    LDA     0,,PR3
         0 000163   200025 755100                    STA     K$RWPARM+17,,AUTO

      149     2424    2             CALL KIN$RECV (K$RWPARM) ALTRET(GETOUT);

   2424  0 000164   200004 634500                    EPPR4   K$RWPARM,,AUTO
         0 000165   200072 454500                    STP4    IPP$+3,,AUTO
         0 000166   200072 630500                    EPPR0   IPP$+3,,AUTO
         0 000167   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000170   000000 701000 xent               TSX1    KIN$RECV
         0 000171   000251 702000 0                  TSX2    GETOUT

      150     2425
      151     2426    2   L_LUUP:
      152     2427    2             IP$->KI$QMHDR.FREFLG='1'B;

   2427  0 000172   200056 470500       L_LUUP       LDP0    IP$,,AUTO
         0 000173   400000 236003                    LDQ     -131072,DU
         0 000174   000000 256100                    ORSQ    0,,PR0

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:25   
      153     2428    2   L_LUUP1:
      154     2429    2             SCANSZ = SCANSZ - MSIZW;

   2429  0 000175   200063 236100       L_LUUP1      LDQ     SCANSZ,,AUTO
         0 000176   200060 136100                    SBLQ    MSIZW,,AUTO
         0 000177   200063 756100                    STQ     SCANSZ,,AUTO

      155     2430    2             IF SCANSZ > 0 THEN

   2430  0 000200   000047 605400 0                  TPNZ    L_RENTER_LUP

      156     2431    2                GOTO L_RENTER_LUP ;
      157     2432    2             KI$FEI.FROZEN  = '0'B;

   2432  0 000201   200054 470500                    LDP0    FEI$,,AUTO
         0 000202   000031 236000 xsym               LDQ     B_VECTNIL+25
         0 000203   000007 356100                    ANSQ    7,,PR0

      158     2433    3             IF SCANSZ = 0 THEN DO;

   2433  0 000204   200063 235100                    LDA     SCANSZ,,AUTO
         0 000205   000207 601000 0                  TNZ     s:2436

      159     2434    3                  GOTO L_RELQ_OUT ;

   2434  0 000206   000044 710000 0                  TRA     L_RELQ_OUT

      160     2435    3               END;
      161     2436    2             GOTO L_FEABT ;

   2436  0 000207   000032 710000 0                  TRA     L_FEABT

      162     2437
      163     2438    2          END ;
      164     2439
      165     2440    1        IF IP$->KI$QMHDR.FUNCTION = %KJ_FCN_NOPI THEN

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:26   
   2440  0 000210   000000 236100                    LDQ     0,,PR0
         0 000211   000777 316003                    CANQ    511,DU
         0 000212   000223 601000 0                  TNZ     s:2447

      166     2441    2          DO ;

      167     2442    2             IP$->KI$QMHDR.FREFLG='1'B;

   2442  0 000213   400000 236003                    LDQ     -131072,DU
         0 000214   000000 256100                    ORSQ    0,,PR0

      168     2443    2             IP$->KI$QMHDR.FEI# = FEI;

   2443  0 000215   300000 236100                    LDQ     0,,PR3
         0 000216   000033 736000                    QLS     27
         0 000217   000000 676100                    ERQ     0,,PR0
         0 000220   377000 376003                    ANQ     130560,DU
         0 000221   000000 656100                    ERSQ    0,,PR0

      169     2444    2             GOTO L_LUUP1 ;

   2444  0 000222   000175 710000 0                  TRA     L_LUUP1

      170     2445    2          END ;
      171     2446    1        ELSE
      172     2447    1           IF IP$->KI$QMHDR.FUNCTION = %KJ_FCN_TIM

   2447  0 000223   000000 236100                    LDQ     0,,PR0
         0 000224   000777 376003                    ANQ     511,DU
         0 000225   000041 116003                    CMPQ    33,DU
         0 000226   000241 601000 0                  TNZ     s:2455

      173     2448    2           THEN DO;

      174     2449    2                KI$FEI.TCNT = KI$FEI.TCNT + 1;

   2449  0 000227   200054 474500                    LDP4    FEI$,,AUTO
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:27   
         0 000230   400002 721100                    LXL1    2,,PR4
         0 000231   000001 622011                    EAX2    1,X1
         0 000232   400002 442100                    SXL2    2,,PR4

      175     2450    2                IP$->KI$QMHDR.FEI# = FEI;

   2450  0 000233   300000 236100                    LDQ     0,,PR3
         0 000234   000033 736000                    QLS     27
         0 000235   000000 676100                    ERQ     0,,PR0
         0 000236   377000 376003                    ANQ     130560,DU
         0 000237   000000 656100                    ERSQ    0,,PR0

      176     2451    2             END;

   2451  0 000240   000250 710000 0                  TRA     s:2456

      177     2452
      178     2453    1           ELSE
      179     2454
      180     2455    1              CALL KIQ$FEABT(FEI,KIER_BFCN);

   2455  0 000241   000001 236000 1                  LDQ     1
         0 000242   200003 235100                    LDA     @FEI,,AUTO
         0 000243   200072 757100                    STAQ    IPP$+3,,AUTO
         0 000244   200072 630500                    EPPR0   IPP$+3,,AUTO
         0 000245   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000246   000000 701000 xent               TSX1    KIQ$FEABT
         0 000247   000000 011000                    NOP     0

      181     2456    1        GOTO L_LUUP ;

   2456  0 000250   000172 710000 0                  TRA     L_LUUP

   2449  0 000251                       GETOUT       null
      182     2457
      183     2458    1   GETOUT: ;
      184     2459
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:28   
      185     2460        /* Some error has occured the three errors that are legal are
      186     2461             K$BAD_LDCTX - KIS$SESSION sez crash the FEP for dump analysis
      187     2462             K$DEFER_IO - tells to stop scanning
      188     2463             K$WAIT_READ - Continue scanning but wait for a read on the currennt message
      189     2464         */
      190     2465    1        IF K$RWPARM.ERR ~= %K$WAIT_READ

   2465  0 000251   200017 235100                    LDA     K$RWPARM+11,,AUTO
         0 000252   000006 115007                    CMPA    6,DL
         0 000253   000265 600000 0                  TZE     s:2474

      191     2466    1        THEN
      192     2467    2          DO ;

      193     2468    2             IF K$RWPARM.ERR = %K$BAD_LDCTX THEN

   2468  0 000254   000011 115007                    CMPA    9,DL
         0 000255   000032 600000 0                  TZE     L_FEABT

      194     2469    2                GOTO L_FEABT;              /* crash the sucker !NOW! */
      195     2470    2             KI$FEI.FROZEN  = '1'B;

   2470  0 000256   200054 470500                    LDP0    FEI$,,AUTO
         0 000257   400000 236003                    LDQ     -131072,DU
         0 000260   000007 256100                    ORSQ    7,,PR0

      196     2471    2             ICQ$->KI$QHDR.MYIPTR=SVMYI;

   2471  0 000261   200062 235100                    LDA     SVMYI,,AUTO
         0 000262   200055 471500                    LDP1    ICQ$,,AUTO
         0 000263   100010 755100                    STA     8,,PR1

      197     2472    2             GOTO L_RELQ_OUT ;

   2472  0 000264   000044 710000 0                  TRA     L_RELQ_OUT

      198     2473    2          END;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:29   
      199     2474    1        SCANSZ = SCANSZ - MSIZW;

   2474  0 000265   200063 236100                    LDQ     SCANSZ,,AUTO
         0 000266   200060 136100                    SBLQ    MSIZW,,AUTO
         0 000267   200063 756100                    STQ     SCANSZ,,AUTO

      200     2475    1        CALL KIQQ$RELQ ;

   2475  0 000270   000324 701000 0                  TSX1    KIQQ$RELQ
         0 000271   000000 011000                    NOP     0

      201     2476    1        IF MYIP~=ICQ$->KI$QHDR.IPTR

   2476  0 000272   200055 470500                    LDP0    ICQ$,,AUTO
         0 000273   000012 236100                    LDQ     10,,PR0
         0 000274   000004 772000                    QRL     4
         0 000275   200061 116100                    CMPQ    MYIP,,AUTO
         0 000276   000302 600000 0                  TZE     s:2485

      202     2477    1        THEN
      203     2478    2          DO ;

      204     2479    2             IF SCANSZ > 0 THEN

   2479  0 000277   200063 235100                    LDA     SCANSZ,,AUTO
         0 000300   000047 605400 0                  TPNZ    L_RENTER_LUP

      205     2480    2                GOTO L_RENTER_LUP ;
      206     2481    2             IF SCANSZ < 0 THEN

   2481  0 000301   000032 604000 0                  TMI     L_FEABT

      207     2482    2                GOTO L_FEABT ;
      208     2483
      209     2484    2          END ;

      210     2485    1        RETURN;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:30   

   2485  0 000302   000000 702200 xent               TSX2  ! X66_ARET

      211     2486
      212     2487
      213     2488
      214     2489        %EJECT ;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:31   
      215     2490
      216     2491
      217     2492    1   KIQ$RELQ: ENTRY (FEI) ;

   2492  0 000303   000000 700200 xent  KIQ$RELQ     TSX0  ! X66_AUTO_1
         0 000304   000074 000001                    ZERO    60,1

      218     2493
      219     2494        /*F*
      220     2495             NAME: KIQ$RELQ
      221     2496             PURPOSE:
      222     2497                  KIQ$RELQ updates the removal pointer to the first not processed
      223     2498                  message.
      224     2499             DESCRIPTION:
      225     2500                  The input circular queue is scanned from the removal pointer
      226     2501                  to MYIPTR updating the remove pointer to the first nonprocessed
      227     2502                  message.
      228     2503        */
      229     2504
      230     2505    1        FEI$ = KI$FEI$(FEI);

   2505  0 000305   200003 470500                    LDP0    @FEI,,AUTO
         0 000306   000000 720100                    LXL0    0,,PR0
         0 000307   000000 471400 xsym               LDP1    KI_FEI$$
         0 000310   100000 236110                    LDQ     0,X0,PR1
         0 000311   200054 756100                    STQ     FEI$,,AUTO

      231     2506    1        ICQ$=KI$FEI.ICQ$;

   2506  0 000312   200054 473500                    LDP3    FEI$,,AUTO
         0 000313   300004 236100                    LDQ     4,,PR3
         0 000314   200055 756100                    STQ     ICQ$,,AUTO

      232     2507    1        TEMP1 = ICQ$->KI$QHDR.QSIZE ;

   2507  0 000315   200055 474500                    LDP4    ICQ$,,AUTO
         0 000316   400005 236100                    LDQ     5,,PR4
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:32   
         0 000317   000004 772000                    QRL     4
         0 000320   200057 756100                    STQ     TEMP1,,AUTO

      233     2508    1        CALL KIQQ$RELQ ;

   2508  0 000321   000324 701000 0                  TSX1    KIQQ$RELQ
         0 000322   000000 011000                    NOP     0

      234     2509    1        RETURN ;

   2509  0 000323   000000 702200 xent               TSX2  ! X66_ARET

      235     2510
      236     2511        %EJECT ;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:33   
      237     2512    1   KIQQ$RELQ: PROC ;

   2512  0 000324   200070 741300       KIQQ$RELQ    STX1  ! IPP$+1,,AUTO

      238     2513             %LOCK (G#="ICQ$->KI$QHDR.GATE");
              2514    2   CALL HFC$LOCK(G# G);

   2514  0 000325   200055 236100                    LDQ     ICQ$,,AUTO
         0 000326   000006 036003                    ADLQ    6,DU
         0 000327   200072 756100                    STQ     IPP$+3,,AUTO
         0 000330   200072 630500                    EPPR0   IPP$+3,,AUTO
         0 000331   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000332   000000 701000 xent               TSX1    HFC$LOCK
         0 000333   000000 011000                    NOP     0

      239     2516
      240     2517    2        TIPTR=ICQ$->KI$QHDR.MYIPTR;

   2517  0 000334   200055 470500                    LDP0    ICQ$,,AUTO
         0 000335   000010 235100                    LDA     8,,PR0
         0 000336   200064 755100                    STA     TIPTR,,AUTO

      241     2518    2        STEMP2 = TIPTR ;

   2518  0 000337   200066 755100                    STA     STEMP2,,AUTO

      242     2519    2        TRPTR=ICQ$->KI$QHDR.RPTR;

   2519  0 000340   000011 236100                    LDQ     9,,PR0
         0 000341   000004 772000                    QRL     4
         0 000342   200065 756100                    STQ     TRPTR,,AUTO

      243     2520    2        IF TIPTR<TRPTR THEN

   2520  0 000343   200064 116100                    CMPQ    TIPTR,,AUTO
         0 000344   000347 604400 0                  TMOZ    s:2522

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:34   
      244     2521    2           TIPTR=TEMP1 ;

   2521  0 000345   200057 235100                    LDA     TEMP1,,AUTO
         0 000346   200064 755100                    STA     TIPTR,,AUTO

      245     2522    2        IF TRPTR >= TIPTR THEN

   2522  0 000347   200064 116100                    CMPQ    TIPTR,,AUTO
         0 000350   000356 604000 0                  TMI     s:2528

      246     2523    3          DO ;

      247     2524    3             ICQ$->KI$QHDR.RPTR=TRPTR;

   2524  0 000351   000004 736000                    QLS     4
         0 000352   000011 676100                    ERQ     9,,PR0
         0 000353   000002 376000 1                  ANQ     2
         0 000354   000011 656100                    ERSQ    9,,PR0

      248     2525    3             GOTO UNLK ;

   2525  0 000355   000422 710000 0                  TRA     UNLK

      249     2526    3          END ;
      250     2527
      251     2528    2        IPP$=PINCRW(ICQ$,TRPTR+SIZEW(KI$QHDR));

   2528  0 000356   000022 736000                    QLS     18
         0 000357   000020 036003                    ADLQ    16,DU
         0 000360   200055 036100                    ADLQ    ICQ$,,AUTO
         0 000361   200067 756100                    STQ     IPP$,,AUTO

      252     2529    2   L_LUUP:
      253     2530    2        IF IPP$->KI$QMHDR.FREFLG='0'B THEN

   2530  0 000362   200067 470500       L_LUUP       LDP0    IPP$,,AUTO
         0 000363   000000 234100                    SZN     0,,PR0
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:35   
         0 000364   000374 604000 0                  TMI     s:2535

      254     2531    3          DO ;

      255     2532    3             ICQ$->KI$QHDR.RPTR=TRPTR;

   2532  0 000365   200055 471500                    LDP1    ICQ$,,AUTO
         0 000366   200065 236100                    LDQ     TRPTR,,AUTO
         0 000367   000004 736000                    QLS     4
         0 000370   100011 676100                    ERQ     9,,PR1
         0 000371   000002 376000 1                  ANQ     2
         0 000372   100011 656100                    ERSQ    9,,PR1

      256     2533    3             GOTO UNLK ;

   2533  0 000373   000422 710000 0                  TRA     UNLK

      257     2534    3          END ;
      258     2535    2        TRPTR=TRPTR+IPP$->KI$QMHDR.ACTSZ;

   2535  0 000374   000000 236100                    LDQ     0,,PR0
         0 000375   777777 376007                    ANQ     -1,DL
         0 000376   200065 036100                    ADLQ    TRPTR,,AUTO
         0 000377   200065 756100                    STQ     TRPTR,,AUTO

      259     2536    2        IF TRPTR>=TEMP1 THEN

   2536  0 000400   200057 116100                    CMPQ    TEMP1,,AUTO
         0 000401   000405 604000 0                  TMI     s:2541

      260     2537    3          DO ;

      261     2538    3             TRPTR=0;

   2538  0 000402   200065 450100                    STZ     TRPTR,,AUTO

      262     2539    3             TIPTR=STEMP2;
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:36   

   2539  0 000403   200066 235100                    LDA     STEMP2,,AUTO
         0 000404   200064 755100                    STA     TIPTR,,AUTO

      263     2540    3          END;

      264     2541    2        IF TRPTR < TIPTR THEN

   2541  0 000405   200065 236100                    LDQ     TRPTR,,AUTO
         0 000406   200064 116100                    CMPQ    TIPTR,,AUTO
         0 000407   000415 605000 0                  TPL     s:2546

      265     2542    3          DO ;

      266     2543    3             IPP$=PINCRW(ICQ$,TRPTR+SIZEW(KI$QHDR));

   2543  0 000410   000022 736000                    QLS     18
         0 000411   000020 036003                    ADLQ    16,DU
         0 000412   200055 036100                    ADLQ    ICQ$,,AUTO
         0 000413   200067 756100                    STQ     IPP$,,AUTO

      267     2544    3             GOTO L_LUUP ;

   2544  0 000414   000362 710000 0                  TRA     L_LUUP

      268     2545    3          END ;
      269     2546    2        ICQ$->KI$QHDR.RPTR=TRPTR;

   2546  0 000415   200055 471500                    LDP1    ICQ$,,AUTO
         0 000416   000004 736000                    QLS     4
         0 000417   100011 676100                    ERQ     9,,PR1
         0 000420   000002 376000 1                  ANQ     2
         0 000421   100011 656100                    ERSQ    9,,PR1

   2546  0 000422                       UNLK         null
      270     2547    2   UNLK: ;
      271     2548             %UNLOCK (G#="ICQ$->KI$QHDR.GATE");
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:37   
              2549    2   CALL HFC$UNLOCK(G# G);

   2549  0 000422   200055 236100                    LDQ     ICQ$,,AUTO
         0 000423   000006 036003                    ADLQ    6,DU
         0 000424   200072 756100                    STQ     IPP$+3,,AUTO
         0 000425   200072 630500                    EPPR0   IPP$+3,,AUTO
         0 000426   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000427   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000430   000000 011000                    NOP     0

      272     2551    2        RETURN;

   2551  0 000431   200070 221300                    LDX1  ! IPP$+1,,AUTO
         0 000432   000001 702211                    TSX2  ! 1,X1

(unnamed)
 Sect OctLoc
   1     000   000012 006000   000013 006000   777777 777760                    ............
      273     2552
      274     2553
      275     2554    2   END KIQQ$RELQ ;
      276     2555
      277     2556
      278     2557    1   END KIQ$ISCAN;
      279     2558
      280     2559        %EOD;

PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:38   
--  Include file information  --

   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI$MHDR.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$ISCAN.
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:39   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FEI                      *0-0-0/w UBIN        r     1 FEI
    54-0-0/w PTR         r     1 FEI$                      55-0-0/w PTR         r     1 ICQ$
    56-0-0/w PTR         r     1 IP$                       67-0-0/w PTR         r     1 IPP$
     4-0-0/d STRC(1404)  r     1 K$RWPARM                  60-0-0/w UBIN        r     1 MSIZW
    61-0-0/w SBIN        r     1 MYIP                      63-0-0/w SBIN        r     1 SCANSZ
    66-0-0/w SBIN        r     1 STEMP2                    62-0-0/w SBIN        r     1 SVMYI
    57-0-0/w SBIN        r     1 TEMP1                     64-0-0/w SBIN        r     1 TIPTR
    65-0-0/w SBIN        r     1 TRPTR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KI_FEI$$                   0-0-0/d STRC(1404)  r     1 K_RWPARM_CON

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/d STRC(576)   r     1 KI$QHDR                    0-0-0/w STRC(144)   r     1 KI$QMHDR


   Procedure KIQ$ISCAN requires 283 words for executable code.
   Procedure KIQ$ISCAN requires 60 words of local(AUTO) storage.
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:41   
          MINI XREF LISTING

FEI
      2012**DCL        16--PROC     2355>>ASSIGN   2375<>CALL     2407>>IF       2419>>ASSIGN   2423>>ASSIGN
      2443>>ASSIGN   2450>>ASSIGN   2455<>CALL     2492--ENTRY    2505>>ASSIGN
FEI$
      2013**DCL      1939--IMP-PTR  2355<<ASSIGN   2356>>ASSIGN   2381>>ASSIGN   2432>>ASSIGN   2449>>ASSIGN
      2449>>ASSIGN   2470>>ASSIGN   2505<<ASSIGN   2506>>ASSIGN
GETOUT
      2449**LABEL    2424--CALLALT
HFC$LOCK
      1559**DCL-ENT  2514--CALL
HFC$UNLOCK
      1559**DCL-ENT  2549--CALL
ICQ$
      2014**DCL      2356<<ASSIGN   2357>>ASSIGN   2358>>ASSIGN   2361>>ASSIGN   2391>>ASSIGN   2400>>ASSIGN
      2404>>ASSIGN   2471>>ASSIGN   2476>>IF       2506<<ASSIGN   2507>>ASSIGN   2514>>CALL     2517>>ASSIGN
      2519>>ASSIGN   2524>>ASSIGN   2528>>ASSIGN   2532>>ASSIGN   2543>>ASSIGN   2546>>ASSIGN   2549>>CALL
IP$
      2015**DCL      2391<<ASSIGN   2392>>ASSIGN   2392>>ASSIGN   2399>>ASSIGN   2405>>ASSIGN   2407>>IF
      2408>>ASSIGN   2408>>ASSIGN   2409>>ASSIGN   2409>>ASSIGN   2412>>ASSIGN   2413>>ASSIGN   2415>>IF
      2418>>ASSIGN   2419>>ASSIGN   2420>>ASSIGN   2421>>ASSIGN   2421>>ASSIGN   2427>>ASSIGN   2440>>IF
      2442>>ASSIGN   2443>>ASSIGN   2447>>IF       2450>>ASSIGN
IPP$
      2025**DCL      2528<<ASSIGN   2530>>IF       2535>>ASSIGN   2543<<ASSIGN
K$RWPARM
      1631**DCL      2417<<ASSIGN   2424<>CALL
K$RWPARM.BLKREC
      1657**DCL      1682--REDEF
K$RWPARM.BLKREC.BLKU#
      1658**DCL      1660--REDEF
K$RWPARM.BLKREC.RECU#
      1670**DCL      1672--REDEF
K$RWPARM.DVE.DVBYTE.VFC
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:42   
      1697**DCL      1698--REDEF
K$RWPARM.DVE.EOMCHAR
      1705**DCL      1709--REDEF
K$RWPARM.ERR
      1769**DCL      1774--REDEF    2465>>IF       2468>>IF
K$RWPARM.FC
      1733**DCL      1734--REDEF
K$RWPARM.FEX
      1815**DCL      2423<<ASSIGN
K$RWPARM.FLDID
      1915**DCL      1916--REDEF
K$RWPARM.FPT$
      1796**DCL      1803--REDEF
K$RWPARM.FUNCTION
      1810**DCL      2422<<ASSIGN
K$RWPARM.IP$
      1761**DCL      2418<<ASSIGN
K$RWPARM.KEYTYPE
      1922**DCL      1923--REDEF
K$RWPARM.MSG$
      1632**DCL      1638--REDEF
K$RWPARM.MSGID
      1744**DCL      1749--REDEF
K$RWPARM.MSGIDXT
      1757**DCL      1761--REDEF
K$RWPARM.NHDR$
      1847**DCL      2420<<ASSIGN
K$RWPARM.NHDRSZ
      1851**DCL      2421<<ASSIGN
K$RWPARM.ORG
      1893**DCL      1894--REDEF
K$RWPARM.THDRSZ
      1837**DCL      1841--REDEF
K$RWPARM.VDOFLGS
      1895**DCL      1906--REDEF
KI$FEI.BD$
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:43   
      1974**DCL      1975--REDEF
KI$FEI.BDAD.WADDR
      1976**DCL      1977--REDEF
KI$FEI.FROZEN
      1969**DCL      2381<<ASSIGN   2432<<ASSIGN   2470<<ASSIGN
KI$FEI.ICQ$
      1961**DCL      2356>>ASSIGN   2506>>ASSIGN
KI$FEI.RCVPB
      1990**DCL      1991--REDEF
KI$FEI.TCNT
      1951**DCL      2449<<ASSIGN   2449>>ASSIGN
KI$FEI$
       342**DCL      2355>>ASSIGN   2505>>ASSIGN
KI$QHDR
        66**DCL      2391--ASSIGN   2528--ASSIGN   2543--ASSIGN
KI$QHDR.GATE
        88**DCL      2514<>CALL     2549<>CALL
KI$QHDR.IPTR
        92**DCL      2361>>ASSIGN   2476>>IF
KI$QHDR.MYIPTR
        89**DCL      2357>>ASSIGN   2400<<ASSIGN   2404<<ASSIGN   2471<<ASSIGN   2517>>ASSIGN
KI$QHDR.QSIZE
        86**DCL      2358>>ASSIGN   2507>>ASSIGN
KI$QHDR.RPTR
        90**DCL      2519>>ASSIGN   2524<<ASSIGN   2532<<ASSIGN   2546<<ASSIGN
KI$QMHDR
      1562**DCL      2392--ASSIGN   2420--ASSIGN
KI$QMHDR.ACTSZ
      1584**DCL      2399<<ASSIGN   2405<<ASSIGN   2535>>ASSIGN
KI$QMHDR.FEI#
      1564**DCL      2407>>IF       2419<<ASSIGN   2443<<ASSIGN   2450<<ASSIGN
KI$QMHDR.FPTSZ
      1597**DCL      1598--REDEF
KI$QMHDR.FREFLG
      1563**DCL      2427<<ASSIGN   2442<<ASSIGN   2530>>IF
KI$QMHDR.FUNCTION
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:44   
      1565**DCL      2415>>IF       2440>>IF       2447>>IF
KI$QMHDR.MSGSZ
      1603**DCL      1604--REDEF
KI$QMHDR.MSGSZB.BOT
      1608**DCL      2392>>ASSIGN   2421>>ASSIGN
KI$QMHDR.MSGSZB.TOP
      1606**DCL      2392>>ASSIGN   2421>>ASSIGN
KI$QMHDR.OFFSET
      1591**DCL      2408>>ASSIGN   2412<<ASSIGN
KI$QMHDR.SIZE
      1592**DCL      2409>>ASSIGN   2413<<ASSIGN
KI$QMHDR.UID
      1593**DCL      1594--REDEF
KI$QMHDR.UID_R.BOT
      1596**DCL      2409<<ASSIGN
KI$QMHDR.UID_R.TOP
      1595**DCL      2408<<ASSIGN
KIN$RECV
      2030**DCL-ENT  2424--CALL
KIQ$FEABT
      2029**DCL-ENT  2375--CALL     2455--CALL
KIQQ$RELQ
      2512**PROC     2384--CALL     2397--CALL     2475--CALL     2508--CALL
KI_FEI$$
       341**DCL       342--IMP-PTR  2355>>ASSIGN   2505>>ASSIGN
K_RWPARM_CON
      2053**DCL      2417>>ASSIGN
K_RWPARM_CON.BLKREC
      2079**DCL      2104--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      2080**DCL      2082--REDEF
K_RWPARM_CON.BLKREC.RECU#
      2092**DCL      2094--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      2119**DCL      2120--REDEF
K_RWPARM_CON.DVE.EOMCHAR
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:45   
      2127**DCL      2131--REDEF
K_RWPARM_CON.ERR
      2191**DCL      2196--REDEF
K_RWPARM_CON.FC
      2155**DCL      2156--REDEF
K_RWPARM_CON.FLDID
      2337**DCL      2338--REDEF
K_RWPARM_CON.FPT$
      2218**DCL      2225--REDEF
K_RWPARM_CON.KEYTYPE
      2344**DCL      2345--REDEF
K_RWPARM_CON.MSG$
      2054**DCL      2060--REDEF
K_RWPARM_CON.MSGID
      2166**DCL      2171--REDEF
K_RWPARM_CON.MSGIDXT
      2179**DCL      2183--REDEF
K_RWPARM_CON.ORG
      2315**DCL      2316--REDEF
K_RWPARM_CON.THDRSZ
      2259**DCL      2263--REDEF
K_RWPARM_CON.VDOFLGS
      2317**DCL      2328--REDEF
L_ENTER_LUP
      2391**LABEL    2364--GOTO     2370--GOTO
L_FEABT
      2375**LABEL    2436--GOTO     2469--GOTO     2482--GOTO
L_LUUP
      2427**LABEL    2456--GOTO
L_LUUP IN PROCEDURE KIQQ$RELQ
      2530**LABEL    2544--GOTO
L_LUUP1
      2429**LABEL    2444--GOTO
L_RELQ_OUT
      2384**LABEL    2434--GOTO     2472--GOTO
L_RENTER_LUP
PL6.E3A0      #001=KIQ$ISCAN File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:37 Page:46   
      2389**LABEL    2431--GOTO     2480--GOTO
MSIZW
      2017**DCL      2392<<ASSIGN   2394>>ASSIGN   2399>>ASSIGN   2405>>ASSIGN   2429>>ASSIGN   2474>>ASSIGN
MYIP
      2018**DCL      2389>>ASSIGN   2394<<ASSIGN   2395>>IF       2398<<ASSIGN   2404>>ASSIGN   2476>>IF
SCANSZ
      2020**DCL      2361<<ASSIGN   2363>>IF       2365>>IF       2368<<ASSIGN   2368>>ASSIGN   2369>>IF
      2371>>IF       2429<<ASSIGN   2429>>ASSIGN   2430>>IF       2433>>IF       2474<<ASSIGN   2474>>ASSIGN
      2479>>IF       2481>>IF
STEMP2
      2024**DCL      2518<<ASSIGN   2539>>ASSIGN
SVMYI
      2019**DCL      2357<<ASSIGN   2361>>ASSIGN   2389<<ASSIGN   2391>>ASSIGN   2394>>ASSIGN   2471>>ASSIGN
TEMP1
      2016**DCL      2358<<ASSIGN   2368>>ASSIGN   2395>>IF       2507<<ASSIGN   2521>>ASSIGN   2536>>IF
TIPTR
      2022**DCL      2517<<ASSIGN   2518>>ASSIGN   2520>>IF       2521<<ASSIGN   2522>>IF       2539<<ASSIGN
      2541>>IF
TRPTR
      2023**DCL      2519<<ASSIGN   2520>>IF       2522>>IF       2524>>ASSIGN   2528>>ASSIGN   2532>>ASSIGN
      2535<<ASSIGN   2535>>ASSIGN   2536>>IF       2538<<ASSIGN   2541>>IF       2543>>ASSIGN   2546>>ASSIGN
UNLK IN PROCEDURE KIQQ$RELQ
      2546**LABEL    2525--GOTO     2533--GOTO

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:47   
      281        1        /*T***********************************************************/
      282        2        /*T*                                                         */
      283        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      284        4        /*T*                                                         */
      285        5        /*T***********************************************************/
      286        6
      287        7
      288        8        KIQ$LINK: PROC (K$RWPARM,INTFUNC) ALTRET;
      289        9
      290       10        /*F* NAME: KIQ$LINK
      291       11             PURPOSE:
      292       12                  To handle the link interface to NETWORK.
      293       13             DESCRIPTION:
      294       14                  KIN$NETWORK call KIQ$LINK whenever is has a specific link
      295       15                  function to perform. KIQ$LINK will perform the function on
      296       16                  a given link.
      297       17        */
      298       18
      299       19        %PLIST;
      300       20        %INCLUDE KI_DATA_R;
      301       46        %INCLUDE KI_MACROS_C;
      302      654        %INCLUDE KI$QHDR;
      303      806        %INCLUDE KI$MHDR;
      304      947        %INCLUDE B$USER;
      305     1163        %B$USERREFS;
      306     1167        %INCLUDE HF_LOCK_C;
      307     1181        %INCLUDE NK_SUBS;
      308     1206        %INCLUDE KI_SUBS_C;
      309     1342        %INCLUDE K$RWPARM;
      310     1728        %INCLUDE KJ_FCNS_C;
      311     1755        %INCLUDE K_SUBS_C;
      312     1788        %INCLUDE S_WSPTD_R;
      313     1804        %INCLUDE NK$LDCT;
      314     1906
      315     1907        %KI$QMHDR;
      316     1956        %K$RWPARM (NAME=K$RWPARM);
      317     2272        %KI$FEI (STCLASS="BASED(FEI$)");
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:48   
      318     2356    1   DCL INTFUNC UBIN;
      319     2357
      320     2358    1   DCL FUNCTION UBIN;
      321     2359    1   DCL OCQ$ PTR;
      322     2360    1   DCL FEI UBIN;
      323     2361    1   DCL FEI$ PTR;
      324     2362    1   DCL FEILCL UBIN HALF ALIGNED ;
      325     2363    1   DCL OP$ PTR;
      326     2364    1   DCL MSIZ UBIN WORD;
      327     2365    1   DCL MSIZS REDEF MSIZ SBIN;
      328     2366    1   DCL 1 MZ REDEF MSIZ,
      329     2367    1            2 * UBIN(20) UNAL,
      330     2368    1            2 TOP UBIN(8) UNAL,
      331     2369    1            2 BOT UBIN(8) UNAL;
      332     2370    1   DCL MSIZW UBIN WORD;
      333     2371    1   DCL TRPTR UBIN WORD;
      334     2372    1   DCL IP UBIN WORD;
      335     2373    1   DCL SIZT UBIN WORD;
      336     2374    1   DCL 1 SZT REDEF SIZT,
      337     2375    1            2 * UBIN(20) UNAL,
      338     2376    1            2 TOP UBIN(8) UNAL,
      339     2377    1            2 BOT UBIN(8) UNAL;
      340     2378    1   DCL 1 B$MESS BASED(OP$),
      341     2379    1            2 TEXT CHAR(MSIZ);
      342     2380    1   DCL NHDR CHAR(K$RWPARM.NHDRSZ) BASED CALIGNED;
      343     2381    1   DCL THDR CHAR(K$RWPARM.THDRSZ) BASED CALIGNED;
      344     2382    1   DCL SHDR CHAR(K$RWPARM.SHDRSZ) BASED CALIGNED;
      345     2383    1   DCL UHDR CHAR(K$RWPARM.UHDRSZ) BASED CALIGNED;
      346     2384    1   DCL MESS CHAR(K$RWPARM.MSGSZ) BASED CALIGNED;
      347     2385    1   DCL TRAN CHAR(512) BASED ALIGNED;
      348     2386        %NK$LDCT(STCLASS="BASED(K$RWPARM.LDCT$)") ;
      349     2432    1   DCL TSIZ UBIN;
      350     2433    1   DCL CUTS UBIN;
      351     2434    1   DCL IUTS UBIN;
      352     2435
      353     2436        %KI_CCMD (NAME=INTL6,STCLASS=CONSTANT,CMD=KIOP_INTL6,L66I=%KJ_IPARM_OCQ);
      354     2464
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:49   
      355     2465        /* Entry references */
      356     2466    1   DCL HFF$TRAPALT ENTRY ALTRET;
      357     2467    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
      358     2468    1   DCL KIQ$RELQ ENTRY(1);
      359     2469    1   DCL KQX$BINWR ENTRY(3);
      360     2470    1   DCL NIS$DCCON ENTRY(3);
      361     2471    1   DCL SSS$SYSTIME ENTRY(1);
      362     2472
      363     2473    1   DCL S_TIMR UBIN SYMREF;
      364     2474
      365     2475        /*X* DMR,PLM=5,IND=3,CTI=2,SDI=5,MCL=10,CSI=1,DTI=2,DCI=3,ECI=0,AND */
      366     2476
      367     2477
      368     2478    1        FEI$ = KI$FEI$(K$RWPARM.FEX);
      369     2479             %LOCK (G=KI$FEI.LOCK);             /* Inhibit */
      370     2482
      371     2483        /* Map onto the CQ */
      372     2484    1        IF KI$FEI.PTPPNO# ~= 0
      373     2485    1        THEN
      374     2486    1           CALL MMS$WSQMAP(KI$FEI.PTPPNO#);
      375     2487        /* The function code determines what we need to do */
      376     2488
      377     2489    1        IF KI$FEI.FEST = KIST_DN OR
      378     2490    1          KI$FEI.FEST = KIST_MASKED OR
      379     2491    2          KI$FEI.FEST = KIST_DMP THEN DO ;
      380     2492                  %UNLOCK (G=KI$FEI.LOCK);
      381     2495    2             K$RWPARM.ERR = %K$FEP_DOWN;
      382     2496    2             ALTRETURN;
      383     2497    2          END ;
      384     2498
      385     2499    1        IF K$RWPARM.FUNCTION ~= %K_WRITE
      386     2500    2        THEN DO;
      387     2501    3             DO CASE (K$RWPARM.FUNCTION);
      388     2502
      389     2503    3              CASE (%K_CONNECT);
      390     2504
      391     2505    3              CASE (%K_DISCONNECT);
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:50   
      392     2506
      393     2507    3              CASE (%K_READDONE);
      394     2508    3                K$RWPARM.IP$->KI$QMHDR.FREFLG = '1'B;
      395     2509    3                CALL KIQ$RELQ(K$RWPARM.FEX);
      396     2510
      397     2511
      398     2512    3              CASE (ELSE);
      399     2513    3             END;
      400     2514                  %UNLOCK (G=KI$FEI.LOCK);
      401     2517    2             RETURN;
      402     2518
      403     2519    2          END ;
      404     2520
      405     2521
      406     2522    1        OCQ$=KI$FEI.OCQ$;
      407     2523    1        FEILCL = K$RWPARM.FEX;
      408     2524             %LOCK (G#="OCQ$->KI$QHDR.GATE");
      409     2527             %UNLOCK (G=KI$FEI.LOCK);
      410     2530
      411     2531    1        IF OCQ$->KI$QHDR.FLG.FULL
      412     2532    1        THEN
      413     2533    2          DO ;
      414     2534    2             K$RWPARM.ERR = %K$QFULL;
      415     2535    2             GOTO L_FULL ;
      416     2536    2          END ;
      417     2537
      418     2538    1        IF ADDR(NIL) = K$RWPARM.NHDR$ THEN
      419     2539    2          DO ;
      420     2540    2             K$RWPARM.NHDRSZ = 0 ;
      421     2541    2             K$RWPARM.THDRSZ = 0 ;
      422     2542    2             K$RWPARM.SHDRSZ = 0 ;
      423     2543    2          END ;
      424     2544    1        IF ADDR(NIL) = K$RWPARM.UHDR$ THEN
      425     2545    1           K$RWPARM.UHDRSZ = 0 ;
      426     2546    1        IF ADDR(NIL) = K$RWPARM.MSG$ THEN
      427     2547    1           K$RWPARM.MSGSZ = 0 ;
      428     2548    1        MSIZ = SIZEC(KI$QMHDR) + K$RWPARM.NHDRSZ +
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:51   
      429     2549    1          K$RWPARM.THDRSZ + K$RWPARM.SHDRSZ +
      430     2550    1          K$RWPARM.UHDRSZ + K$RWPARM.MSGSZ ;
      431     2551    1        MSIZW=(MSIZ+3)/4;
      432     2552    2        IF MSIZW > OCQ$->KI$QHDR.QSIZE THEN DO;
      433     2553                  %UNLOCK (G#="OCQ$->KI$QHDR.GATE");
      434     2556    2             K$RWPARM.ERR = %K$Q2SMALL;
      435     2557                /* '32' below is slop to allow a few TIME msgs if needed */
      436     2558    2             K$RWPARM.MSG_ERRCODE = BINBIT(4*(32+MSIZW-OCQ$->KI$QHDR.QSIZE),36);
      437     2559                /* now make KIA lop off that many bytes from MSGSZ */
      438     2560    2             ALTRETURN;
      439     2561    2          END;
      440     2562    1        TRPTR=OCQ$->KI$QHDR.RPTR;
      441     2563    1        IP=OCQ$->KI$QHDR.IPTR;
      442     2564    1        IF IP < TRPTR THEN
      443     2565    1           IF IP+MSIZW < TRPTR THEN
      444     2566    1              GOTO L_IT_FITS ;
      445     2567    1           ELSE
      446     2568    1              GOTO SETFUL ;
      447     2569
      448     2570    1        IF OCQ$->KI$QHDR.QSIZE-IP-MSIZW > SIZEW(KI$QMHDR) THEN
      449     2571    1           GOTO L_IT_FITS ;
      450     2572
      451     2573    1        IF TRPTR=0 THEN GOTO SETFUL;
      452     2574    1        OP$=PINCRW(OCQ$,IP+SIZEW(KI$QHDR));
      453     2575    1        OP$->KI$QMHDR = '0'B;
      454     2576    1        SIZT=(OCQ$->KI$QHDR.QSIZE-IP)*4 - SIZEC(KI$QMHDR);
      455     2577    1        OP$->KI$QMHDR.MSGSZ = 512*SZT.TOP + SZT.BOT ;
      456     2578    1        OP$->KI$QMHDR.FUNCTION=%KJ_FCN_NOP;
      457     2579    1        OCQ$->KI$QHDR.IPTR=0;
      458     2580    1        IP=0;
      459     2581    1        IF TRPTR <= MSIZW THEN
      460     2582    2          DO ;
      461     2583    2   SETFUL:   ;
      462     2584    2             OCQ$->KI$QHDR.FLG.FULL='1'B;
      463     2585    2             KI$FEI.LST_RPTR  = OCQ$->KI$QHDR.RPTR;
      464     2586    2   L_FULL:
      465     2587    2             K$RWPARM.ERR = %K$QFULL;
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:52   
      466     2588    2             IF K$RWPARM.LDCT$~= ADDR(NIL) AND NK$LDCT.LNK$ = ADDR(NIL) THEN
      467     2589    2                IF S_TIMR ~= 2 /* MON EXEC */ OR
      468     2590    2                  ( NK$LDCT.RESCOD ~= %NK_RES AND
      469     2591    2                  NK$LDCT.RESCOD ~= %NK_TSFPRG AND
      470     2592    3                  NK$LDCT.RESCOD ~= %NK_TSTRM ) THEN DO ;
      471     2593    3                     NK$LDCT.LNK$ = KI$FEI.QFLHD$ ;
      472     2594    3                     KI$FEI.QFLHD$ = K$RWPARM.LDCT$ ;
      473     2595    3                  END ;
      474     2596                  %UNLOCK (G#="OCQ$->KI$QHDR.GATE");
      475     2599    2             IF ADDR( INTFUNC) ~= ADDR( NIL) THEN
      476     2600    2                IF INTFUNC = %KJ_FCN_TIM THEN
      477     2601    2                   GOTO TIMCHK;
      478     2602    2             ALTRETURN;
      479     2603    2          END;
      480     2604
      481     2605    1   L_IT_FITS:
      482     2606    1        OP$=PINCRW(OCQ$,IP+SIZEW(KI$QHDR));
      483     2607    1        B$MESS = '0'B;
      484     2608    1        MSIZS = MSIZS - SIZEC(KI$QMHDR);
      485     2609    1        OP$->KI$QMHDR.MSGSZ = 512*MZ.TOP + MZ.BOT ;
      486     2610    1        IF ADDR(INTFUNC) ~= ADDR(NIL)
      487     2611    1        THEN
      488     2612    1           OP$->KI$QMHDR.FUNCTION = INTFUNC;
      489     2613    1        ELSE
      490     2614    1           OP$->KI$QMHDR.FUNCTION = %KJ_FCN_ODATA;
      491     2615    1        OP$->KI$QMHDR.UID = OCQ$->KI$QHDR.LAST_PTR;
      492     2616    1        OP$ = PINCRC(OP$,SIZEC(KI$QMHDR));
      493     2617
      494     2618    1        IF K$RWPARM.NHDRSZ ~= 0
      495     2619    1        THEN
      496     2620    2          DO ;
      497     2621    2             OP$->NHDR = K$RWPARM.NHDR$->NHDR;
      498     2622    2             OP$ = PINCRC(OP$,K$RWPARM.NHDRSZ);
      499     2623    2             IF K$RWPARM.THDRSZ ~= 0
      500     2624    3             THEN DO;
      501     2625    3                  OP$->THDR = K$RWPARM.THDR$->THDR;
      502     2626    3                  OP$ = PINCRC(OP$,K$RWPARM.THDRSZ);
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:53   
      503     2627    3               END;
      504     2628    2             OP$->SHDR = K$RWPARM.SHDR$->SHDR;
      505     2629    2             OP$ = PINCRC(OP$,K$RWPARM.SHDRSZ);
      506     2630    2          END;
      507     2631    1        IF K$RWPARM.UHDRSZ ~= 0
      508     2632    1        THEN
      509     2633    2          DO ;
      510     2634    2             OP$->UHDR = K$RWPARM.UHDR$->UHDR;
      511     2635    2             OP$ = PINCRC(OP$,K$RWPARM.UHDRSZ);
      512     2636    2          END;
      513     2637    1        IF K$RWPARM.MSGSZ ~= 0
      514     2638    1        THEN
      515     2639    2          DO ;
      516     2640    2             CALL HFF$TRAPALT ALTRET (BAD_BUFFER);
      517     2641    2             IF K$RWPARM.DVE.DVBYTE.BIN    /* Binary write */
      518     2642    2             THEN
      519     2643    2                CALL KQX$BINWR(K$RWPARM.MSG$,OP$,K$RWPARM.MSGSZ);
      520     2644    2             ELSE
      521     2645    2                IF K$RWPARM.TRANS$ = ADDR(NIL)
      522     2646    2                THEN
      523     2647    2                   OP$->MESS = K$RWPARM.MSG$->MESS;
      524     2648    2                ELSE
      525     2649    2                   CALL XLATE(OP$->MESS,K$RWPARM.TRANS$->TRAN,K$RWPARM.MSG$->MESS);
      526     2650    2          END;
      527     2651
      528     2652        /* Done processing the message let the FEP see it */
      529     2653    1        OCQ$->KI$QHDR.LAST_PTR = OCQ$->KI$QHDR.IPTR;
      530     2654    1        OCQ$->KI$QHDR.IPTR=OCQ$->KI$QHDR.IPTR + MSIZW;
      531     2655
      532     2656        /* Check to see if it is time to interupt the FEP yet */
      533     2657    1   TIMCHK:
      534     2658    1        CALL SSS$SYSTIME (CUTS);
      535     2659    1        IUTS = KI$FEI.IUTS;
      536     2660    1        KI$FEI.MSI  = KI$FEI.MSI  + 1;
      537     2661
      538     2662    1        IF (KI$FEI.MSI >= KI_MBI AND CUTS >= KI_MNTBI+IUTS) OR
      539     2663    1          CUTS > KI_MXTBI+IUTS THEN
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:54   
      540     2664    2          DO ;
      541     2665    2             KI$FEI.MSI  = 0;
      542     2666    2             KI$FEI.IUTS  = CUTS;
      543     2667    2             IF OCQ$->KI$QHDR.L6_FLAGS.IOIP = '0'B
      544     2668    2               AND OCQ$->KI$QHDR.CCMD = '0'B
      545     2669    3             THEN DO;
      546     2670    3                  OCQ$->KI$QHDR.CCMD=INTL6;
      547     2671    3                  CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);
      548     2672    3               END;
      549     2673    2          END;
      550     2674
      551     2675    1        IF K$RWPARM.ERR = %K$QFULL THEN
      552     2676    1           IF ADDR( INTFUNC) ~= ADDR( NIL) AND INTFUNC = %KJ_FCN_TIM THEN
      553     2677    1              ALTRETURN;              /* TIM msg; QHDR.GATE already unlocked */
      554     2678             %UNLOCK (G#="OCQ$->KI$QHDR.GATE");
      555     2681    1        RETURN;
      556     2682
      557     2683    1   BAD_BUFFER: ;
      558     2684             %UNLOCK (G#="OCQ$->KI$QHDR.GATE");
      559     2687    1        K$RWPARM.ERR = %K$BAD_BUFFER;
      560     2688    1        ALTRETURN;
      561     2689
      562     2690
      563     2691
      564     2692    1   END KIQ$LINK;
      565     2693        %EOD;

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:55   
--  Include file information  --

   NK$LDCT.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   KI$MHDR.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$LINK.

   Procedure KIQ$LINK requires 456 words for executable code.
   Procedure KIQ$LINK requires 24 words of local(AUTO) storage.

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:56   

 Object Unit name= KIQ$LINK                                   File name= KIQ$QMGR.:E05TOU
 UTS= JUL 30 '97 00:38:05.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  KIQ$LINK
    1   Proc  even  none   456    710  KIQ$LINK
    2  RoData even  none     2      2  KIQ$LINK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  KIQ$LINK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 MMS$WSQMAP
         yes           Std       1 HFC$UNLOCK
         yes           Std       1 KIQ$RELQ
         yes           Std       1 SSS$SYSTIME
 yes     yes           Std       0 HFF$TRAPALT
         yes           Std       3 NIS$DCCON
         yes           Std       3 KQX$BINWR
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:57   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KI_FEI$$                              KI_MBI                                KI_MXTBI
     KI_MNTBI                              S_TIMR                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:58   


      281        1        /*T***********************************************************/
      282        2        /*T*                                                         */
      283        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      284        4        /*T*                                                         */
      285        5        /*T***********************************************************/
      286        6
      287        7
      288        8        KIQ$LINK: PROC (K$RWPARM,INTFUNC) ALTRET;

      8  1 000000   000000 700200 xent  KIQ$LINK     TSX0  ! X66_AUTO_2
         1 000001   000030 000002                    ZERO    24,2

      289        9
      290       10        /*F* NAME: KIQ$LINK
      291       11             PURPOSE:
      292       12                  To handle the link interface to NETWORK.
      293       13             DESCRIPTION:
      294       14                  KIN$NETWORK call KIQ$LINK whenever is has a specific link
      295       15                  function to perform. KIQ$LINK will perform the function on
      296       16                  a given link.
      297       17        */
      298       18
      299       19        %PLIST;
      300       20        %INCLUDE KI_DATA_R;
      301       46        %INCLUDE KI_MACROS_C;
      302      654        %INCLUDE KI$QHDR;
      303      806        %INCLUDE KI$MHDR;
      304      947        %INCLUDE B$USER;
      305     1163        %B$USERREFS;
      306     1167        %INCLUDE HF_LOCK_C;
      307     1181        %INCLUDE NK_SUBS;
      308     1206        %INCLUDE KI_SUBS_C;
      309     1342        %INCLUDE K$RWPARM;
      310     1728        %INCLUDE KJ_FCNS_C;
      311     1755        %INCLUDE K_SUBS_C;
      312     1788        %INCLUDE S_WSPTD_R;
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:59   
      313     1804        %INCLUDE NK$LDCT;
      314     1906
      315     1907        %KI$QMHDR;
      316     1956        %K$RWPARM (NAME=K$RWPARM);
      317     2272        %KI$FEI (STCLASS="BASED(FEI$)");
      318     2356    1   DCL INTFUNC UBIN;
      319     2357
      320     2358    1   DCL FUNCTION UBIN;
      321     2359    1   DCL OCQ$ PTR;
      322     2360    1   DCL FEI UBIN;
      323     2361    1   DCL FEI$ PTR;
      324     2362    1   DCL FEILCL UBIN HALF ALIGNED ;
      325     2363    1   DCL OP$ PTR;
      326     2364    1   DCL MSIZ UBIN WORD;
      327     2365    1   DCL MSIZS REDEF MSIZ SBIN;
      328     2366    1   DCL 1 MZ REDEF MSIZ,
      329     2367    1            2 * UBIN(20) UNAL,
      330     2368    1            2 TOP UBIN(8) UNAL,
      331     2369    1            2 BOT UBIN(8) UNAL;
      332     2370    1   DCL MSIZW UBIN WORD;
      333     2371    1   DCL TRPTR UBIN WORD;
      334     2372    1   DCL IP UBIN WORD;
      335     2373    1   DCL SIZT UBIN WORD;
      336     2374    1   DCL 1 SZT REDEF SIZT,
      337     2375    1            2 * UBIN(20) UNAL,
      338     2376    1            2 TOP UBIN(8) UNAL,
      339     2377    1            2 BOT UBIN(8) UNAL;
      340     2378    1   DCL 1 B$MESS BASED(OP$),
      341     2379    1            2 TEXT CHAR(MSIZ);
      342     2380    1   DCL NHDR CHAR(K$RWPARM.NHDRSZ) BASED CALIGNED;
      343     2381    1   DCL THDR CHAR(K$RWPARM.THDRSZ) BASED CALIGNED;
      344     2382    1   DCL SHDR CHAR(K$RWPARM.SHDRSZ) BASED CALIGNED;
      345     2383    1   DCL UHDR CHAR(K$RWPARM.UHDRSZ) BASED CALIGNED;
      346     2384    1   DCL MESS CHAR(K$RWPARM.MSGSZ) BASED CALIGNED;
      347     2385    1   DCL TRAN CHAR(512) BASED ALIGNED;
      348     2386        %NK$LDCT(STCLASS="BASED(K$RWPARM.LDCT$)") ;
      349     2432    1   DCL TSIZ UBIN;
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:60   
      350     2433    1   DCL CUTS UBIN;
      351     2434    1   DCL IUTS UBIN;
      352     2435
      353     2436        %KI_CCMD (NAME=INTL6,STCLASS=CONSTANT,CMD=KIOP_INTL6,L66I=%KJ_IPARM_OCQ);
      354     2464
      355     2465        /* Entry references */
      356     2466    1   DCL HFF$TRAPALT ENTRY ALTRET;
      357     2467    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
      358     2468    1   DCL KIQ$RELQ ENTRY(1);
      359     2469    1   DCL KQX$BINWR ENTRY(3);
      360     2470    1   DCL NIS$DCCON ENTRY(3);
      361     2471    1   DCL SSS$SYSTIME ENTRY(1);
      362     2472
      363     2473    1   DCL S_TIMR UBIN SYMREF;
      364     2474
      365     2475        /*X* DMR,PLM=5,IND=3,CTI=2,SDI=5,MCL=10,CSI=1,DTI=2,DCI=3,ECI=0,AND */
      366     2476
      367     2477
      368     2478    1        FEI$ = KI$FEI$(K$RWPARM.FEX);

   2478  1 000002   200003 470500                    LDP0    @K$RWPARM,,AUTO
         1 000003   000021 720100                    LXL0    17,,PR0
         1 000004   000000 471400 xsym               LDP1    KI_FEI$$
         1 000005   100000 236110                    LDQ     0,X0,PR1
         1 000006   200010 756100                    STQ     FEI$,,AUTO

      369     2479             %LOCK (G=KI$FEI.LOCK);             /* Inhibit */

   2480  1 000007   200010 630500                    EPPR0   FEI$,,AUTO
         1 000010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000011   000000 701000 xent               TSX1    HFC$LOCK
         1 000012   000000 011000                    NOP     0

      370     2482
      371     2483        /* Map onto the CQ */
      372     2484    1        IF KI$FEI.PTPPNO# ~= 0

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:61   
   2484  1 000013   200010 470500                    LDP0    FEI$,,AUTO
         1 000014   000014 235100                    LDA     12,,PR0
         1 000015   000025 600000 1                  TZE     s:2489

      373     2485    1        THEN
      374     2486    1           CALL MMS$WSQMAP(KI$FEI.PTPPNO#);

   2486  1 000016   200010 236100                    LDQ     FEI$,,AUTO
         1 000017   000014 036003                    ADLQ    12,DU
         1 000020   200024 756100                    STQ     IUTS+2,,AUTO
         1 000021   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000023   000000 701000 xent               TSX1    MMS$WSQMAP
         1 000024   000000 011000                    NOP     0

      375     2487        /* The function code determines what we need to do */
      376     2488
      377     2489    1        IF KI$FEI.FEST = KIST_DN OR

   2489  1 000025   200010 470500                    LDP0    FEI$,,AUTO
         1 000026   000002 236100                    LDQ     2,,PR0
         1 000027   000777 316003                    CANQ    511,DU
         1 000030   000037 600000 1                  TZE     s:2493
         1 000031   000002 236100                    LDQ     2,,PR0
         1 000032   000777 376003                    ANQ     511,DU
         1 000033   000007 116003                    CMPQ    7,DU
         1 000034   000037 600000 1                  TZE     s:2493
         1 000035   000005 116003                    CMPQ    5,DU
         1 000036   000047 601000 1                  TNZ     s:2499

      378     2490    1          KI$FEI.FEST = KIST_MASKED OR
      379     2491    2          KI$FEI.FEST = KIST_DMP THEN DO ;

      380     2492                  %UNLOCK (G=KI$FEI.LOCK);

   2493  1 000037   200010 630500                    EPPR0   FEI$,,AUTO
         1 000040   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:62   
         1 000041   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000042   000000 011000                    NOP     0

      381     2495    2             K$RWPARM.ERR = %K$FEP_DOWN;

   2495  1 000043   000005 235007                    LDA     5,DL
         1 000044   200003 470500                    LDP0    @K$RWPARM,,AUTO
         1 000045   000013 755100                    STA     11,,PR0

      382     2496    2             ALTRETURN;

   2496  1 000046   000000 702200 xent               TSX2  ! X66_AALT

      383     2497    2          END ;
      384     2498
      385     2499    1        IF K$RWPARM.FUNCTION ~= %K_WRITE

   2499  1 000047   200003 471500                    LDP1    @K$RWPARM,,AUTO
         1 000050   100020 235100                    LDA     16,,PR1
         1 000051   000001 115007                    CMPA    1,DL
         1 000052   000110 600000 1                  TZE     s:2522

      386     2500    2        THEN DO;

      387     2501    3             DO CASE (K$RWPARM.FUNCTION);

   2501  1 000053   000012 115007                    CMPA    10,DL
         1 000054   000056 602005 1                  TNC     s:2501+3,AL
         1 000055   000103 710000 1                  TRA     s:2515
         1 000056   000103 710000 1                  TRA     s:2515
         1 000057   000103 710000 1                  TRA     s:2515
         1 000060   000103 710000 1                  TRA     s:2515
         1 000061   000103 710000 1                  TRA     s:2515
         1 000062   000103 710000 1                  TRA     s:2515
         1 000063   000103 710000 1                  TRA     s:2515
         1 000064   000103 710000 1                  TRA     s:2515
         1 000065   000103 710000 1                  TRA     s:2515
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:63   
         1 000066   000103 710000 1                  TRA     s:2515
         1 000067   000070 710000 1                  TRA     s:2508

      388     2502
      389     2503    3              CASE (%K_CONNECT);

      390     2504
      391     2505    3              CASE (%K_DISCONNECT);

      392     2506
      393     2507    3              CASE (%K_READDONE);

      394     2508    3                K$RWPARM.IP$->KI$QMHDR.FREFLG = '1'B;

   2508  1 000070   100012 473500                    LDP3    10,,PR1
         1 000071   400000 236003                    LDQ     -131072,DU
         1 000072   300000 256100                    ORSQ    0,,PR3

      395     2509    3                CALL KIQ$RELQ(K$RWPARM.FEX);

   2509  1 000073   200003 236100                    LDQ     @K$RWPARM,,AUTO
         1 000074   000021 036003                    ADLQ    17,DU
         1 000075   200024 756100                    STQ     IUTS+2,,AUTO
         1 000076   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000077   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000100   000000 701000 xent               TSX1    KIQ$RELQ
         1 000101   000000 011000                    NOP     0
         1 000102   000103 710000 1                  TRA     s:2515

      396     2510
      397     2511
      398     2512    3              CASE (ELSE);

      399     2513    3             END;

      400     2514                  %UNLOCK (G=KI$FEI.LOCK);

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:64   
   2515  1 000103   200010 630500                    EPPR0   FEI$,,AUTO
         1 000104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000105   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000106   000000 011000                    NOP     0

      401     2517    2             RETURN;

   2517  1 000107   000000 702200 xent               TSX2  ! X66_ARET

      402     2518
      403     2519    2          END ;
      404     2520
      405     2521
      406     2522    1        OCQ$=KI$FEI.OCQ$;

   2522  1 000110   000003 236100                    LDQ     3,,PR0
         1 000111   200006 756100                    STQ     OCQ$,,AUTO

      407     2523    1        FEILCL = K$RWPARM.FEX;

   2523  1 000112   100021 720100                    LXL0    17,,PR1
         1 000113   200011 740100                    STX0    FEILCL,,AUTO

      408     2524             %LOCK (G#="OCQ$->KI$QHDR.GATE");

   2525  1 000114   000006 036003                    ADLQ    6,DU
         1 000115   200024 756100                    STQ     IUTS+2,,AUTO
         1 000116   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000117   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000120   000000 701000 xent               TSX1    HFC$LOCK
         1 000121   000000 011000                    NOP     0

      409     2527             %UNLOCK (G=KI$FEI.LOCK);

   2528  1 000122   200010 630500                    EPPR0   FEI$,,AUTO
         1 000123   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000124   000000 701000 xent               TSX1    HFC$UNLOCK
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:65   
         1 000125   000000 011000                    NOP     0

      410     2530
      411     2531    1        IF OCQ$->KI$QHDR.FLG.FULL

   2531  1 000126   200006 470500                    LDP0    OCQ$,,AUTO
         1 000127   000013 430100                    FSZN    11,,PR0
         1 000130   000135 605000 1                  TPL     s:2538

      412     2532    1        THEN
      413     2533    2          DO ;

      414     2534    2             K$RWPARM.ERR = %K$QFULL;

   2534  1 000131   000001 235007                    LDA     1,DL
         1 000132   200003 471500                    LDP1    @K$RWPARM,,AUTO
         1 000133   100013 755100                    STA     11,,PR1

      415     2535    2             GOTO L_FULL ;

   2535  1 000134   000311 710000 1                  TRA     L_FULL

      416     2536    2          END ;
      417     2537
      418     2538    1        IF ADDR(NIL) = K$RWPARM.NHDR$ THEN

   2538  1 000135   200003 471500                    LDP1    @K$RWPARM,,AUTO
         1 000136   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000137   100026 116100                    CMPQ    22,,PR1
         1 000140   000144 601000 1                  TNZ     s:2544

      419     2539    2          DO ;

      420     2540    2             K$RWPARM.NHDRSZ = 0 ;

   2540  1 000141   100027 450100                    STZ     23,,PR1

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:66   
      421     2541    2             K$RWPARM.THDRSZ = 0 ;

   2541  1 000142   100025 450100                    STZ     21,,PR1

      422     2542    2             K$RWPARM.SHDRSZ = 0 ;

   2542  1 000143   100023 450100                    STZ     19,,PR1

      423     2543    2          END ;

      424     2544    1        IF ADDR(NIL) = K$RWPARM.UHDR$ THEN

   2544  1 000144   100014 116100                    CMPQ    12,,PR1
         1 000145   000147 601000 1                  TNZ     s:2546

      425     2545    1           K$RWPARM.UHDRSZ = 0 ;

   2545  1 000146   100015 450100                    STZ     13,,PR1

      426     2546    1        IF ADDR(NIL) = K$RWPARM.MSG$ THEN

   2546  1 000147   100000 116100                    CMPQ    0,,PR1
         1 000150   000152 601000 1                  TNZ     s:2548

      427     2547    1           K$RWPARM.MSGSZ = 0 ;

   2547  1 000151   100001 450100                    STZ     1,,PR1

      428     2548    1        MSIZ = SIZEC(KI$QMHDR) + K$RWPARM.NHDRSZ +

   2548  1 000152   100027 236100                    LDQ     23,,PR1
         1 000153   100025 036100                    ADLQ    21,,PR1
         1 000154   100023 036100                    ADLQ    19,,PR1
         1 000155   100015 036100                    ADLQ    13,,PR1
         1 000156   100001 036100                    ADLQ    1,,PR1
         1 000157   000020 036007                    ADLQ    16,DL
         1 000160   200013 756100                    STQ     MSIZ,,AUTO
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:67   

      429     2549    1          K$RWPARM.THDRSZ + K$RWPARM.SHDRSZ +
      430     2550    1          K$RWPARM.UHDRSZ + K$RWPARM.MSGSZ ;
      431     2551    1        MSIZW=(MSIZ+3)/4;

   2551  1 000161   000003 036007                    ADLQ    3,DL
         1 000162   000002 772000                    QRL     2
         1 000163   200014 756100                    STQ     MSIZW,,AUTO

      432     2552    2        IF MSIZW > OCQ$->KI$QHDR.QSIZE THEN DO;

   2552  1 000164   000005 236100                    LDQ     5,,PR0
         1 000165   000004 772000                    QRL     4
         1 000166   200014 116100                    CMPQ    MSIZW,,AUTO
         1 000167   000214 603000 1                  TRC     s:2562

      433     2553                  %UNLOCK (G#="OCQ$->KI$QHDR.GATE");

   2554  1 000170   200006 236100                    LDQ     OCQ$,,AUTO
         1 000171   000006 036003                    ADLQ    6,DU
         1 000172   200024 756100                    STQ     IUTS+2,,AUTO
         1 000173   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000174   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000175   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000176   000000 011000                    NOP     0

      434     2556    2             K$RWPARM.ERR = %K$Q2SMALL;

   2556  1 000177   000007 235007                    LDA     7,DL
         1 000200   200003 470500                    LDP0    @K$RWPARM,,AUTO
         1 000201   000013 755100                    STA     11,,PR0

      435     2557                /* '32' below is slop to allow a few TIME msgs if needed */
      436     2558    2             K$RWPARM.MSG_ERRCODE = BINBIT(4*(32+MSIZW-OCQ$->KI$QHDR.QSIZE),36);

   2558  1 000202   200006 471500                    LDP1    OCQ$,,AUTO
         1 000203   100005 236100                    LDQ     5,,PR1
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:68   
         1 000204   000004 772000                    QRL     4
         1 000205   200024 756100                    STQ     IUTS+2,,AUTO
         1 000206   200014 236100                    LDQ     MSIZW,,AUTO
         1 000207   200024 136100                    SBLQ    IUTS+2,,AUTO
         1 000210   000002 736000                    QLS     2
         1 000211   000200 036007                    ADLQ    128,DL
         1 000212   000037 756100                    STQ     31,,PR0

      437     2559                /* now make KIA lop off that many bytes from MSGSZ */
      438     2560    2             ALTRETURN;

   2560  1 000213   000000 702200 xent               TSX2  ! X66_AALT

      439     2561    2          END;
      440     2562    1        TRPTR=OCQ$->KI$QHDR.RPTR;

   2562  1 000214   000011 236100                    LDQ     9,,PR0
         1 000215   000004 772000                    QRL     4
         1 000216   200015 756100                    STQ     TRPTR,,AUTO

      441     2563    1        IP=OCQ$->KI$QHDR.IPTR;

   2563  1 000217   000012 236100                    LDQ     10,,PR0
         1 000220   000004 772000                    QRL     4
         1 000221   200016 756100                    STQ     IP,,AUTO

      442     2564    1        IF IP < TRPTR THEN

   2564  1 000222   200015 116100                    CMPQ    TRPTR,,AUTO
         1 000223   000230 603000 1                  TRC     s:2570

      443     2565    1           IF IP+MSIZW < TRPTR THEN

   2565  1 000224   200014 036100                    ADLQ    MSIZW,,AUTO
         1 000225   200015 116100                    CMPQ    TRPTR,,AUTO
         1 000226   000361 602000 1                  TNC     L_IT_FITS

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:69   
      444     2566    1              GOTO L_IT_FITS ;
      445     2567    1           ELSE
      446     2568    1              GOTO SETFUL ;

   2568  1 000227   000302 710000 1                  TRA     SETFUL

      447     2569
      448     2570    1        IF OCQ$->KI$QHDR.QSIZE-IP-MSIZW > SIZEW(KI$QMHDR) THEN

   2570  1 000230   000005 236100                    LDQ     5,,PR0
         1 000231   000004 772000                    QRL     4
         1 000232   200016 136100                    SBLQ    IP,,AUTO
         1 000233   200014 136100                    SBLQ    MSIZW,,AUTO
         1 000234   000004 116007                    CMPQ    4,DL
         1 000235   000361 605400 1                  TPNZ    L_IT_FITS

      449     2571    1           GOTO L_IT_FITS ;
      450     2572
      451     2573    1        IF TRPTR=0 THEN GOTO SETFUL;

   2573  1 000236   200015 235100                    LDA     TRPTR,,AUTO
         1 000237   000302 600000 1                  TZE     SETFUL

      452     2574    1        OP$=PINCRW(OCQ$,IP+SIZEW(KI$QHDR));

   2574  1 000240   200016 236100                    LDQ     IP,,AUTO
         1 000241   000022 736000                    QLS     18
         1 000242   000020 036003                    ADLQ    16,DU
         1 000243   200006 036100                    ADLQ    OCQ$,,AUTO
         1 000244   200012 756100                    STQ     OP$,,AUTO

      453     2575    1        OP$->KI$QMHDR = '0'B;

   2575  1 000245   200012 473500                    LDP3    OP$,,AUTO
         1 000246   000100 100400                    MLR     fill='000'O
         1 000247   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000250   300000 000020                    ADSC9   0,,PR3                   cn=0,n=16
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:70   

      454     2576    1        SIZT=(OCQ$->KI$QHDR.QSIZE-IP)*4 - SIZEC(KI$QMHDR);

   2576  1 000251   000005 236100                    LDQ     5,,PR0
         1 000252   000004 772000                    QRL     4
         1 000253   200016 136100                    SBLQ    IP,,AUTO
         1 000254   000002 736000                    QLS     2
         1 000255   000020 136007                    SBLQ    16,DL
         1 000256   200017 756100                    STQ     SIZT,,AUTO

      455     2577    1        OP$->KI$QMHDR.MSGSZ = 512*SZT.TOP + SZT.BOT ;

   2577  1 000257   200017 236100                    LDQ     SIZT,,AUTO
         1 000260   000377 376007                    ANQ     255,DL
         1 000261   200024 756100                    STQ     IUTS+2,,AUTO
         1 000262   200017 236100                    LDQ     SIZT,,AUTO
         1 000263   000001 736000                    QLS     1
         1 000264   377000 376007                    ANQ     130560,DL
         1 000265   200024 036100                    ADLQ    IUTS+2,,AUTO
         1 000266   000000 620006                    EAX0    0,QL
         1 000267   200012 473500                    LDP3    OP$,,AUTO
         1 000270   300003 440100                    SXL0    3,,PR3

      456     2578    1        OP$->KI$QMHDR.FUNCTION=%KJ_FCN_NOP;

   2578  1 000271   200012 473500                    LDP3    OP$,,AUTO
         1 000272   000040 236003                    LDQ     32,DU
         1 000273   300000 552120                    STBQ    0,'20'O,PR3

      457     2579    1        OCQ$->KI$QHDR.IPTR=0;

   2579  1 000274   000017 236007                    LDQ     15,DL
         1 000275   000012 356100                    ANSQ    10,,PR0

      458     2580    1        IP=0;

   2580  1 000276   200016 450100                    STZ     IP,,AUTO
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:71   

      459     2581    1        IF TRPTR <= MSIZW THEN

   2581  1 000277   200014 236100                    LDQ     MSIZW,,AUTO
         1 000300   200015 116100                    CMPQ    TRPTR,,AUTO
         1 000301   000361 602000 1                  TNC     L_IT_FITS

      460     2582    2          DO ;

   2578  1 000302                       SETFUL       null
      461     2583    2   SETFUL:   ;
      462     2584    2             OCQ$->KI$QHDR.FLG.FULL='1'B;

   2584  1 000302   001000 236003                    LDQ     512,DU
         1 000303   000013 256100                    ORSQ    11,,PR0

      463     2585    2             KI$FEI.LST_RPTR  = OCQ$->KI$QHDR.RPTR;

   2585  1 000304   000011 236100                    LDQ     9,,PR0
         1 000305   000004 772000                    QRL     4
         1 000306   000000 620006                    EAX0    0,QL
         1 000307   200010 473500                    LDP3    FEI$,,AUTO
         1 000310   300013 440100                    SXL0    11,,PR3

      464     2586    2   L_FULL:
      465     2587    2             K$RWPARM.ERR = %K$QFULL;

   2587  1 000311   000001 235007       L_FULL       LDA     1,DL
         1 000312   100013 755100                    STA     11,,PR1

      466     2588    2             IF K$RWPARM.LDCT$~= ADDR(NIL) AND NK$LDCT.LNK$ = ADDR(NIL) THEN

   2588  1 000313   100016 236100                    LDQ     14,,PR1
         1 000314   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000315   000342 600000 1                  TZE     s:2597
         1 000316   100016 473500                    LDP3    14,,PR1
         1 000317   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:72   
         1 000320   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000321   000342 601000 1                  TNZ     s:2597

      467     2589    2                IF S_TIMR ~= 2 /* MON EXEC */ OR

   2589  1 000322   000000 235000 xsym               LDA     S_TIMR
         1 000323   000002 115007                    CMPA    2,DL
         1 000324   000335 601000 1                  TNZ     s:2593
         1 000325   300006 236100                    LDQ     6,,PR3
         1 000326   000017 376007                    ANQ     15,DL
         1 000327   000013 116007                    CMPQ    11,DL
         1 000330   000342 600000 1                  TZE     s:2597
         1 000331   000010 116007                    CMPQ    8,DL
         1 000332   000342 600000 1                  TZE     s:2597
         1 000333   000001 116007                    CMPQ    1,DL
         1 000334   000342 600000 1                  TZE     s:2597

      468     2590    2                  ( NK$LDCT.RESCOD ~= %NK_RES AND
      469     2591    2                  NK$LDCT.RESCOD ~= %NK_TSFPRG AND
      470     2592    3                  NK$LDCT.RESCOD ~= %NK_TSTRM ) THEN DO ;

      471     2593    3                     NK$LDCT.LNK$ = KI$FEI.QFLHD$ ;

   2593  1 000335   200010 474500                    LDP4    FEI$,,AUTO
         1 000336   400017 236100                    LDQ     15,,PR4
         1 000337   300004 756100                    STQ     4,,PR3

      472     2594    3                     KI$FEI.QFLHD$ = K$RWPARM.LDCT$ ;

   2594  1 000340   100016 236100                    LDQ     14,,PR1
         1 000341   400017 756100                    STQ     15,,PR4

      473     2595    3                  END ;

      474     2596                  %UNLOCK (G#="OCQ$->KI$QHDR.GATE");

   2597  1 000342   200006 236100                    LDQ     OCQ$,,AUTO
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:73   
         1 000343   000006 036003                    ADLQ    6,DU
         1 000344   200024 756100                    STQ     IUTS+2,,AUTO
         1 000345   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000346   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000347   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000350   000000 011000                    NOP     0

      475     2599    2             IF ADDR( INTFUNC) ~= ADDR( NIL) THEN

   2599  1 000351   200004 236100                    LDQ     @INTFUNC,,AUTO
         1 000352   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000353   000360 600000 1                  TZE     s:2602

      476     2600    2                IF INTFUNC = %KJ_FCN_TIM THEN

   2600  1 000354   200004 470500                    LDP0    @INTFUNC,,AUTO
         1 000355   000000 235100                    LDA     0,,PR0
         1 000356   000041 115007                    CMPA    33,DL
         1 000357   000573 600000 1                  TZE     TIMCHK

      477     2601    2                   GOTO TIMCHK;
      478     2602    2             ALTRETURN;

   2602  1 000360   000000 702200 xent               TSX2  ! X66_AALT

      479     2603    2          END;
      480     2604
      481     2605    1   L_IT_FITS:
      482     2606    1        OP$=PINCRW(OCQ$,IP+SIZEW(KI$QHDR));

   2606  1 000361   200016 236100       L_IT_FITS    LDQ     IP,,AUTO
         1 000362   000022 736000                    QLS     18
         1 000363   000020 036003                    ADLQ    16,DU
         1 000364   200006 036100                    ADLQ    OCQ$,,AUTO
         1 000365   200012 756100                    STQ     OP$,,AUTO

      483     2607    1        B$MESS = '0'B;
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:74   

   2607  1 000366   200012 473500                    LDP3    OP$,,AUTO
         1 000367   200013 720100                    LXL0    MSIZ,,AUTO
         1 000370   000140 100400                    MLR     fill='000'O
         1 000371   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000372   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      484     2608    1        MSIZS = MSIZS - SIZEC(KI$QMHDR);

   2608  1 000373   000020 336007                    LCQ     16,DL
         1 000374   200013 056100                    ASQ     MSIZ,,AUTO

      485     2609    1        OP$->KI$QMHDR.MSGSZ = 512*MZ.TOP + MZ.BOT ;

   2609  1 000375   200013 236100                    LDQ     MSIZ,,AUTO
         1 000376   000377 376007                    ANQ     255,DL
         1 000377   200024 756100                    STQ     IUTS+2,,AUTO
         1 000400   200013 236100                    LDQ     MSIZ,,AUTO
         1 000401   000001 736000                    QLS     1
         1 000402   377000 376007                    ANQ     130560,DL
         1 000403   200024 036100                    ADLQ    IUTS+2,,AUTO
         1 000404   000000 620006                    EAX0    0,QL
         1 000405   200012 473500                    LDP3    OP$,,AUTO
         1 000406   300003 440100                    SXL0    3,,PR3

      486     2610    1        IF ADDR(INTFUNC) ~= ADDR(NIL)

   2610  1 000407   200004 236100                    LDQ     @INTFUNC,,AUTO
         1 000410   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000411   000420 600000 1                  TZE     s:2614

      487     2611    1        THEN
      488     2612    1           OP$->KI$QMHDR.FUNCTION = INTFUNC;

   2612  1 000412   200004 473500                    LDP3    @INTFUNC,,AUTO
         1 000413   200012 474500                    LDP4    OP$,,AUTO
         1 000414   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:75   
         1 000415   000022 736000                    QLS     18
         1 000416   400000 552120                    STBQ    0,'20'O,PR4
         1 000417   000423 710000 1                  TRA     s:2615

      489     2613    1        ELSE
      490     2614    1           OP$->KI$QMHDR.FUNCTION = %KJ_FCN_ODATA;

   2614  1 000420   200012 473500                    LDP3    OP$,,AUTO
         1 000421   000043 236003                    LDQ     35,DU
         1 000422   300000 552120                    STBQ    0,'20'O,PR3

      491     2615    1        OP$->KI$QMHDR.UID = OCQ$->KI$QHDR.LAST_PTR;

   2615  1 000423   200012 473500                    LDP3    OP$,,AUTO
         1 000424   000015 236100                    LDQ     13,,PR0
         1 000425   000004 772000                    QRL     4
         1 000426   300002 756100                    STQ     2,,PR3

      492     2616    1        OP$ = PINCRC(OP$,SIZEC(KI$QMHDR));

   2616  1 000427   200012 236100                    LDQ     OP$,,AUTO
         1 000430   000004 036003                    ADLQ    4,DU
         1 000431   200012 756100                    STQ     OP$,,AUTO

      493     2617
      494     2618    1        IF K$RWPARM.NHDRSZ ~= 0

   2618  1 000432   100027 235100                    LDA     23,,PR1
         1 000433   000474 600000 1                  TZE     s:2631

      495     2619    1        THEN
      496     2620    2          DO ;

      497     2621    2             OP$->NHDR = K$RWPARM.NHDR$->NHDR;

   2621  1 000434   100027 720100                    LXL0    23,,PR1
         1 000435   100026 473500                    LDP3    22,,PR1
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:76   
         1 000436   200012 474500                    LDP4    OP$,,AUTO
         1 000437   040140 100540                    MLR     fill='040'O
         1 000440   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000441   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

      498     2622    2             OP$ = PINCRC(OP$,K$RWPARM.NHDRSZ);

   2622  1 000442   100027 236100                    LDQ     23,,PR1
         1 000443   000020 736000                    QLS     16
         1 000444   200012 036100                    ADLQ    OP$,,AUTO
         1 000445   200012 756100                    STQ     OP$,,AUTO

      499     2623    2             IF K$RWPARM.THDRSZ ~= 0

   2623  1 000446   100025 235100                    LDA     21,,PR1
         1 000447   000462 600000 1                  TZE     s:2628

      500     2624    3             THEN DO;

      501     2625    3                  OP$->THDR = K$RWPARM.THDR$->THDR;

   2625  1 000450   100025 720100                    LXL0    21,,PR1
         1 000451   100024 473500                    LDP3    20,,PR1
         1 000452   200012 474500                    LDP4    OP$,,AUTO
         1 000453   040140 100540                    MLR     fill='040'O
         1 000454   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000455   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

      502     2626    3                  OP$ = PINCRC(OP$,K$RWPARM.THDRSZ);

   2626  1 000456   100025 236100                    LDQ     21,,PR1
         1 000457   000020 736000                    QLS     16
         1 000460   200012 036100                    ADLQ    OP$,,AUTO
         1 000461   200012 756100                    STQ     OP$,,AUTO

      503     2627    3               END;

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:77   
      504     2628    2             OP$->SHDR = K$RWPARM.SHDR$->SHDR;

   2628  1 000462   100023 720100                    LXL0    19,,PR1
         1 000463   100022 473500                    LDP3    18,,PR1
         1 000464   200012 474500                    LDP4    OP$,,AUTO
         1 000465   040140 100540                    MLR     fill='040'O
         1 000466   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000467   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

      505     2629    2             OP$ = PINCRC(OP$,K$RWPARM.SHDRSZ);

   2629  1 000470   100023 236100                    LDQ     19,,PR1
         1 000471   000020 736000                    QLS     16
         1 000472   200012 036100                    ADLQ    OP$,,AUTO
         1 000473   200012 756100                    STQ     OP$,,AUTO

      506     2630    2          END;

      507     2631    1        IF K$RWPARM.UHDRSZ ~= 0

   2631  1 000474   100015 235100                    LDA     13,,PR1
         1 000475   000510 600000 1                  TZE     s:2637

      508     2632    1        THEN
      509     2633    2          DO ;

      510     2634    2             OP$->UHDR = K$RWPARM.UHDR$->UHDR;

   2634  1 000476   100015 720100                    LXL0    13,,PR1
         1 000477   100014 473500                    LDP3    12,,PR1
         1 000500   200012 474500                    LDP4    OP$,,AUTO
         1 000501   040140 100540                    MLR     fill='040'O
         1 000502   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000503   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

      511     2635    2             OP$ = PINCRC(OP$,K$RWPARM.UHDRSZ);

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:78   
   2635  1 000504   100015 236100                    LDQ     13,,PR1
         1 000505   000020 736000                    QLS     16
         1 000506   200012 036100                    ADLQ    OP$,,AUTO
         1 000507   200012 756100                    STQ     OP$,,AUTO

      512     2636    2          END;

      513     2637    1        IF K$RWPARM.MSGSZ ~= 0

   2637  1 000510   100001 235100                    LDA     1,,PR1
         1 000511   000557 600000 1                  TZE     s:2653

      514     2638    1        THEN
      515     2639    2          DO ;

      516     2640    2             CALL HFF$TRAPALT ALTRET (BAD_BUFFER);

   2640  1 000512   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000513   000000 701000 xent               TSX1    HFF$TRAPALT
         1 000514   000675 702000 1                  TSX2    BAD_BUFFER

      517     2641    2             IF K$RWPARM.DVE.DVBYTE.BIN    /* Binary write */

   2641  1 000515   200003 470500                    LDP0    @K$RWPARM,,AUTO
         1 000516   000010 236100                    LDQ     8,,PR0
         1 000517   040000 316003                    CANQ    16384,DU
         1 000520   000535 600000 1                  TZE     s:2645

      518     2642    2             THEN
      519     2643    2                CALL KQX$BINWR(K$RWPARM.MSG$,OP$,K$RWPARM.MSGSZ);

   2643  1 000521   200003 236100                    LDQ     @K$RWPARM,,AUTO
         1 000522   000001 036003                    ADLQ    1,DU
         1 000523   200026 756100                    STQ     IUTS+4,,AUTO
         1 000524   200012 631500                    EPPR1   OP$,,AUTO
         1 000525   200025 451500                    STP1    IUTS+3,,AUTO
         1 000526   200003 236100                    LDQ     @K$RWPARM,,AUTO
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:79   
         1 000527   200024 756100                    STQ     IUTS+2,,AUTO
         1 000530   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000531   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000532   000000 701000 xent               TSX1    KQX$BINWR
         1 000533   000000 011000                    NOP     0
         1 000534   000557 710000 1                  TRA     s:2653

      520     2644    2             ELSE
      521     2645    2                IF K$RWPARM.TRANS$ = ADDR(NIL)

   2645  1 000535   000031 236100                    LDQ     25,,PR0
         1 000536   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000537   000547 601000 1                  TNZ     s:2649

      522     2646    2                THEN
      523     2647    2                   OP$->MESS = K$RWPARM.MSG$->MESS;

   2647  1 000540   000001 720100                    LXL0    1,,PR0
         1 000541   000000 471500                    LDP1    0,,PR0
         1 000542   200012 473500                    LDP3    OP$,,AUTO
         1 000543   040140 100540                    MLR     fill='040'O
         1 000544   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 000545   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000546   000557 710000 1                  TRA     s:2653

      524     2648    2                ELSE
      525     2649    2                   CALL XLATE(OP$->MESS,K$RWPARM.TRANS$->TRAN,K$RWPARM.MSG$->MESS);

   2649  1 000547   000001 720100                    LXL0    1,,PR0
         1 000550   000031 471500                    LDP1    25,,PR0
         1 000551   000000 473500                    LDP3    0,,PR0
         1 000552   200012 474500                    LDP4    OP$,,AUTO
         1 000553   040140 160540                    MVT     fill='040'O
         1 000554   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000555   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
         1 000556   100000 000100                    ARG     0,,PR1

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:80   
      526     2650    2          END;

      527     2651
      528     2652        /* Done processing the message let the FEP see it */
      529     2653    1        OCQ$->KI$QHDR.LAST_PTR = OCQ$->KI$QHDR.IPTR;

   2653  1 000557   200006 470500                    LDP0    OCQ$,,AUTO
         1 000560   000012 236100                    LDQ     10,,PR0
         1 000561   000015 676100                    ERQ     13,,PR0
         1 000562   000000 376000 2                  ANQ     0
         1 000563   000015 656100                    ERSQ    13,,PR0

      530     2654    1        OCQ$->KI$QHDR.IPTR=OCQ$->KI$QHDR.IPTR + MSIZW;

   2654  1 000564   000012 236100                    LDQ     10,,PR0
         1 000565   000004 772000                    QRL     4
         1 000566   200014 036100                    ADLQ    MSIZW,,AUTO
         1 000567   000004 736000                    QLS     4
         1 000570   000012 676100                    ERQ     10,,PR0
         1 000571   000000 376000 2                  ANQ     0
         1 000572   000012 656100                    ERSQ    10,,PR0

      531     2655
      532     2656        /* Check to see if it is time to interupt the FEP yet */
      533     2657    1   TIMCHK:
      534     2658    1        CALL SSS$SYSTIME (CUTS);

   2658  1 000573   200021 630500       TIMCHK       EPPR0   CUTS,,AUTO
         1 000574   200024 450500                    STP0    IUTS+2,,AUTO
         1 000575   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000576   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000577   000000 701000 xent               TSX1    SSS$SYSTIME
         1 000600   000000 011000                    NOP     0

      535     2659    1        IUTS = KI$FEI.IUTS;

   2659  1 000601   200010 470500                    LDP0    FEI$,,AUTO
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:81   
         1 000602   000006 235100                    LDA     6,,PR0
         1 000603   200022 755100                    STA     IUTS,,AUTO

      536     2660    1        KI$FEI.MSI  = KI$FEI.MSI  + 1;

   2660  1 000604   000007 720100                    LXL0    7,,PR0
         1 000605   000001 621010                    EAX1    1,X0
         1 000606   000007 441100                    SXL1    7,,PR0

      537     2661
      538     2662    1        IF (KI$FEI.MSI >= KI_MBI AND CUTS >= KI_MNTBI+IUTS) OR

   2662  1 000607   000000 101000 xsym               CMPX1   KI_MBI
         1 000610   000616 602000 1                  TNC     s:2662+7
         1 000611   000000 236000 xsym               LDQ     KI_MNTBI
         1 000612   200022 036100                    ADLQ    IUTS,,AUTO
         1 000613   200021 116100                    CMPQ    CUTS,,AUTO
         1 000614   000622 602000 1                  TNC     s:2665
         1 000615   000622 600000 1                  TZE     s:2665
         1 000616   000000 236000 xsym               LDQ     KI_MXTBI
         1 000617   200022 036100                    ADLQ    IUTS,,AUTO
         1 000620   200021 116100                    CMPQ    CUTS,,AUTO
         1 000621   000651 603000 1                  TRC     s:2675

      539     2663    1          CUTS > KI_MXTBI+IUTS THEN
      540     2664    2          DO ;

      541     2665    2             KI$FEI.MSI  = 0;

   2665  1 000622   000000 220003                    LDX0    0,DU
         1 000623   000007 440100                    SXL0    7,,PR0

      542     2666    2             KI$FEI.IUTS  = CUTS;

   2666  1 000624   200021 236100                    LDQ     CUTS,,AUTO
         1 000625   000006 756100                    STQ     6,,PR0

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:82   
      543     2667    2             IF OCQ$->KI$QHDR.L6_FLAGS.IOIP = '0'B

   2667  1 000626   200006 471500                    LDP1    OCQ$,,AUTO
         1 000627   100002 234100                    SZN     2,,PR1
         1 000630   000651 604000 1                  TMI     s:2675
         1 000631   100000 235100                    LDA     0,,PR1
         1 000632   000651 601000 1                  TNZ     s:2675

      544     2668    2               AND OCQ$->KI$QHDR.CCMD = '0'B
      545     2669    3             THEN DO;

      546     2670    3                  OCQ$->KI$QHDR.CCMD=INTL6;

   2670  1 000633   000000 236000 0                  LDQ     INTL6
         1 000634   100000 756100                    STQ     0,,PR1

      547     2671    3                  CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);

   2671  1 000635   200010 236100                    LDQ     FEI$,,AUTO
         1 000636   000005 036003                    ADLQ    5,DU
         1 000637   200026 756100                    STQ     IUTS+4,,AUTO
         1 000640   000001 236000 2                  LDQ     1
         1 000641   200025 756100                    STQ     IUTS+3,,AUTO
         1 000642   200010 236100                    LDQ     FEI$,,AUTO
         1 000643   000002 036003                    ADLQ    2,DU
         1 000644   200024 756100                    STQ     IUTS+2,,AUTO
         1 000645   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000646   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000647   000000 701000 xent               TSX1    NIS$DCCON
         1 000650   000000 011000                    NOP     0

      548     2672    3               END;

      549     2673    2          END;

      550     2674
      551     2675    1        IF K$RWPARM.ERR = %K$QFULL THEN
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:83   

   2675  1 000651   200003 470500                    LDP0    @K$RWPARM,,AUTO
         1 000652   000013 235100                    LDA     11,,PR0
         1 000653   000001 115007                    CMPA    1,DL
         1 000654   000665 601000 1                  TNZ     s:2679

      552     2676    1           IF ADDR( INTFUNC) ~= ADDR( NIL) AND INTFUNC = %KJ_FCN_TIM THEN

   2676  1 000655   200004 236100                    LDQ     @INTFUNC,,AUTO
         1 000656   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000657   000665 600000 1                  TZE     s:2679
         1 000660   200004 471500                    LDP1    @INTFUNC,,AUTO
         1 000661   100000 235100                    LDA     0,,PR1
         1 000662   000041 115007                    CMPA    33,DL
         1 000663   000665 601000 1                  TNZ     s:2679

      553     2677    1              ALTRETURN;              /* TIM msg; QHDR.GATE already unlocked */

   2677  1 000664   000000 702200 xent               TSX2  ! X66_AALT

      554     2678             %UNLOCK (G#="OCQ$->KI$QHDR.GATE");

   2679  1 000665   200006 236100                    LDQ     OCQ$,,AUTO
         1 000666   000006 036003                    ADLQ    6,DU
         1 000667   200024 756100                    STQ     IUTS+2,,AUTO
         1 000670   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000671   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000672   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000673   000000 011000                    NOP     0

      555     2681    1        RETURN;

   2681  1 000674   000000 702200 xent               TSX2  ! X66_ARET

   2675  1 000675                       BAD_BUFFER   null
      556     2682
      557     2683    1   BAD_BUFFER: ;
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:84   
      558     2684             %UNLOCK (G#="OCQ$->KI$QHDR.GATE");

   2685  1 000675   200006 236100                    LDQ     OCQ$,,AUTO
         1 000676   000006 036003                    ADLQ    6,DU
         1 000677   200024 756100                    STQ     IUTS+2,,AUTO
         1 000700   200024 630500                    EPPR0   IUTS+2,,AUTO
         1 000701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000702   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000703   000000 011000                    NOP     0

      559     2687    1        K$RWPARM.ERR = %K$BAD_BUFFER;

   2687  1 000704   000002 235007                    LDA     2,DL
         1 000705   200003 470500                    LDP0    @K$RWPARM,,AUTO
         1 000706   000013 755100                    STA     11,,PR0

      560     2688    1        ALTRETURN;

   2688  1 000707   000000 702200 xent               TSX2  ! X66_AALT

INTL6
 Sect OctLoc
   0     000   000000 000171                                                    ...y

(unnamed)
 Sect OctLoc
   2     000   777777 777760   000002 006000                                    ........
      561     2689
      562     2690
      563     2691
      564     2692    1   END KIQ$LINK;
      565     2693        %EOD;

PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:85   
--  Include file information  --

   NK$LDCT.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   KI$MHDR.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$LINK.
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:86   

 **** Variables and constants ****

  ****  Section 000 RoData KIQ$LINK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 INTL6

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @INTFUNC                   3-0-0/w PTR         r     1 @K$RWPARM
    21-0-0/w UBIN        r     1 CUTS                      10-0-0/w PTR         r     1 FEI$
    11-0-0/w UBIN(18)    r     1 FEILCL                    *0-0-0/w UBIN        r     1 INTFUNC
    16-0-0/w UBIN        r     1 IP                        22-0-0/w UBIN        r     1 IUTS
    *0-0-0/d STRC(1404)  r     1 K$RWPARM                  13-0-0/w UBIN        r     1 MSIZ
    13-0-0/w SBIN        r     1 MSIZS                     14-0-0/w UBIN        r     1 MSIZW
    13-0-0/w STRC        r     1 MZ                         6-0-0/w PTR         r     1 OCQ$
    12-0-0/w PTR         r     1 OP$                       17-0-0/w UBIN        r     1 SIZT
    17-0-0/w STRC        r     1 SZT                       15-0-0/w UBIN        r     1 TRPTR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KI_FEI$$                   0-0-0/w UBIN(18)    r     1 KI_MBI
     0-0-0/w UBIN        r     1 KI_MNTBI                   0-0-0/w UBIN        r     1 KI_MXTBI
     0-0-0/w UBIN        r     1 S_TIMR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:87   

     0-0-0/c ASTR(0)     r     1 B$MESS                     0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/d STRC(576)   r     1 KI$QHDR                    0-0-0/w STRC(144)   r     1 KI$QMHDR
     0-0-0/c ACHR        r     1 MESS                       0-0-0/c ACHR        r     1 NHDR
     0-0-0/d STRC(864)   r     1 NK$LDCT                    0-0-0/c ACHR        r     1 SHDR
     0-0-0/c ACHR        r     1 THDR                       0-0-0/w CHAR(512)   r     1 TRAN
     0-0-0/c ACHR        r     1 UHDR


   Procedure KIQ$LINK requires 456 words for executable code.
   Procedure KIQ$LINK requires 24 words of local(AUTO) storage.
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:88   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:89   
          MINI XREF LISTING

B$DO.ECCINFO
      1098**DCL      1099--REDEF
B$MESS
      2378**DCL      2607<<ASSIGN
B$U.MISC
      1077**DCL      1078--REDEF
B$USER.MISC
      1153**DCL      1154--REDEF
BAD_BUFFER
      2675**LABEL    2640--CALLALT
CUTS
      2433**DCL      2658<>CALL     2662>>IF       2662>>IF       2666>>ASSIGN
FEI$
      2361**DCL      2285--IMP-PTR  2478<<ASSIGN   2480>>CALL     2484>>IF       2486>>CALL     2489>>IF
      2489>>IF       2489>>IF       2493>>CALL     2515>>CALL     2522>>ASSIGN   2528>>CALL     2585>>ASSIGN
      2593>>ASSIGN   2594>>ASSIGN   2659>>ASSIGN   2660>>ASSIGN   2660>>ASSIGN   2662>>IF       2665>>ASSIGN
      2666>>ASSIGN   2671>>CALL     2671>>CALL
FEILCL
      2362**DCL      2523<<ASSIGN
HFC$LOCK
      1180**DCL-ENT  2480--CALL     2525--CALL
HFC$UNLOCK
      1180**DCL-ENT  2493--CALL     2515--CALL     2528--CALL     2554--CALL     2597--CALL     2679--CALL
      2685--CALL
HFF$TRAPALT
      2466**DCL-ENT  2640--CALL
INTFUNC
      2356**DCL         8--PROC     2599--IF       2600>>IF       2610--IF       2612>>ASSIGN   2676--IF
      2676>>IF
INTL6
      2445**DCL      2670>>ASSIGN
INTL6.L66INT
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:90   
      2453**DCL      2454--REDEF    2458--REDEF
INTL6.L6INT
      2451**DCL      2452--REDEF
IP
      2372**DCL      2563<<ASSIGN   2564>>IF       2565>>IF       2570>>IF       2574>>ASSIGN   2576>>ASSIGN
      2580<<ASSIGN   2606>>ASSIGN
IUTS
      2434**DCL      2659<<ASSIGN   2662>>IF       2662>>IF
K$RWPARM
      1977**DCL         8--PROC
K$RWPARM.BLKREC
      2003**DCL      2028--REDEF
K$RWPARM.BLKREC.BLKU#
      2004**DCL      2006--REDEF
K$RWPARM.BLKREC.RECU#
      2016**DCL      2018--REDEF
K$RWPARM.DVE.DVBYTE.BIN
      2045**DCL      2641>>IF
K$RWPARM.DVE.DVBYTE.VFC
      2043**DCL      2044--REDEF
K$RWPARM.DVE.EOMCHAR
      2051**DCL      2055--REDEF
K$RWPARM.ERR
      2115**DCL      2120--REDEF    2495<<ASSIGN   2534<<ASSIGN   2556<<ASSIGN   2587<<ASSIGN   2675>>IF
      2687<<ASSIGN
K$RWPARM.FC
      2079**DCL      2080--REDEF
K$RWPARM.FEX
      2161**DCL      2478>>ASSIGN   2509<>CALL     2523>>ASSIGN
K$RWPARM.FLDID
      2261**DCL      2262--REDEF
K$RWPARM.FPT$
      2142**DCL      2149--REDEF
K$RWPARM.FUNCTION
      2156**DCL      2499>>IF       2501>>DOCASE
K$RWPARM.IP$
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:91   
      2107**DCL      2508>>ASSIGN
K$RWPARM.KEYTYPE
      2268**DCL      2269--REDEF
K$RWPARM.LDCT$
      2138**DCL      2399--IMP-PTR  2588>>IF       2588>>IF       2589>>IF       2589>>IF       2589>>IF
      2593>>ASSIGN   2594>>ASSIGN
K$RWPARM.MSG$
      1978**DCL      1984--REDEF    2546>>IF       2643<>CALL     2647>>ASSIGN   2649>>CALLBLT
K$RWPARM.MSGID
      2090**DCL      2095--REDEF
K$RWPARM.MSGIDXT
      2103**DCL      2107--REDEF
K$RWPARM.MSGSZ
      1985**DCL      2384--IMP-SIZ  2547<<ASSIGN   2548>>ASSIGN   2637>>IF       2643<>CALL     2647>>ASSIGN
      2647>>ASSIGN   2649>>CALLBLT  2649>>CALLBLT
K$RWPARM.MSG_ERRCODE
      2238**DCL      2558<<ASSIGN
K$RWPARM.NHDR$
      2193**DCL      2538>>IF       2621>>ASSIGN
K$RWPARM.NHDRSZ
      2197**DCL      2380--IMP-SIZ  2540<<ASSIGN   2548>>ASSIGN   2618>>IF       2621>>ASSIGN   2621>>ASSIGN
      2622>>ASSIGN
K$RWPARM.ORG
      2239**DCL      2240--REDEF
K$RWPARM.SHDR$
      2171**DCL      2628>>ASSIGN
K$RWPARM.SHDRSZ
      2175**DCL      2382--IMP-SIZ  2542<<ASSIGN   2548>>ASSIGN   2628>>ASSIGN   2628>>ASSIGN   2629>>ASSIGN
K$RWPARM.THDR$
      2179**DCL      2625>>ASSIGN
K$RWPARM.THDRSZ
      2183**DCL      2187--REDEF    2381--IMP-SIZ  2541<<ASSIGN   2548>>ASSIGN   2623>>IF       2625>>ASSIGN
      2625>>ASSIGN   2626>>ASSIGN
K$RWPARM.TRANS$
      2202**DCL      2645>>IF       2649>>CALLBLT
K$RWPARM.UHDR$
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:92   
      2128**DCL      2544>>IF       2634>>ASSIGN
K$RWPARM.UHDRSZ
      2133**DCL      2383--IMP-SIZ  2545<<ASSIGN   2548>>ASSIGN   2631>>IF       2634>>ASSIGN   2634>>ASSIGN
      2635>>ASSIGN
K$RWPARM.VDOFLGS
      2241**DCL      2252--REDEF
KI$FEI.BD$
      2320**DCL      2321--REDEF
KI$FEI.BDAD.WADDR
      2322**DCL      2323--REDEF
KI$FEI.FECH
      2287**DCL      2671<>CALL
KI$FEI.FEST
      2290**DCL      2489>>IF       2489>>IF       2489>>IF
KI$FEI.FEWSQ
      2313**DCL      2671<>CALL
KI$FEI.IUTS
      2314**DCL      2659>>ASSIGN   2666<<ASSIGN
KI$FEI.LOCK
      2286**DCL      2480<>CALL     2493<>CALL     2515<>CALL     2528<>CALL
KI$FEI.LST_RPTR
      2334**DCL      2585<<ASSIGN
KI$FEI.MSI
      2319**DCL      2660<<ASSIGN   2660>>ASSIGN   2662>>IF       2665<<ASSIGN
KI$FEI.OCQ$
      2301**DCL      2522>>ASSIGN
KI$FEI.PTPPNO#
      2335**DCL      2484>>IF       2486<>CALL
KI$FEI.QFLHD$
      2349**DCL      2593>>ASSIGN   2594<<ASSIGN
KI$FEI.RCVPB
      2336**DCL      2337--REDEF
KI$FEI$
        32**DCL      2478>>ASSIGN
KI$QHDR
       683**DCL      2574--ASSIGN   2606--ASSIGN
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:93   
KI$QHDR.CCMD
       684**DCL      2667>>IF       2670<<ASSIGN
KI$QHDR.FLG.FULL
       714**DCL      2531>>IF       2584<<ASSIGN
KI$QHDR.GATE
       705**DCL      2525<>CALL     2554<>CALL     2597<>CALL     2679<>CALL     2685<>CALL
KI$QHDR.IPTR
       709**DCL      2563>>ASSIGN   2579<<ASSIGN   2653>>ASSIGN   2654<<ASSIGN   2654>>ASSIGN
KI$QHDR.L6_FLAGS.IOIP
       696**DCL      2667>>IF
KI$QHDR.LAST_PTR
       720**DCL      2615>>ASSIGN   2653<<ASSIGN
KI$QHDR.QSIZE
       703**DCL      2552>>IF       2558>>ASSIGN   2570>>IF       2576>>ASSIGN
KI$QHDR.RPTR
       707**DCL      2562>>ASSIGN   2585>>ASSIGN
KI$QMHDR
      1908**DCL      2548--ASSIGN   2570--IF       2575<<ASSIGN   2576--ASSIGN   2608--ASSIGN   2616--ASSIGN
KI$QMHDR.FPTSZ
      1943**DCL      1944--REDEF
KI$QMHDR.FREFLG
      1909**DCL      2508<<ASSIGN
KI$QMHDR.FUNCTION
      1911**DCL      2578<<ASSIGN   2612<<ASSIGN   2614<<ASSIGN
KI$QMHDR.MSGSZ
      1949**DCL      1950--REDEF    2577<<ASSIGN   2609<<ASSIGN
KI$QMHDR.UID
      1939**DCL      1940--REDEF    2615<<ASSIGN
KIQ$RELQ
      2468**DCL-ENT  2509--CALL
KI_FEI$$
        31**DCL        32--IMP-PTR  2478>>ASSIGN
KI_MBI
        41**DCL      2662>>IF
KI_MNTBI
        43**DCL      2662>>IF
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:94   
KI_MXTBI
        42**DCL      2662>>IF
KQX$BINWR
      2469**DCL-ENT  2643--CALL
L_FULL
      2587**LABEL    2535--GOTO
L_IT_FITS
      2606**LABEL    2566--GOTO     2571--GOTO
MESS
      2384**DCL      2647<<ASSIGN   2647>>ASSIGN   2649<<CALLBLT  2649>>CALLBLT
MMS$WSQMAP
      2467**DCL-ENT  2486--CALL
MSIZ
      2364**DCL      2365--REDEF    2366--REDEF    2379--IMP-SIZ  2548<<ASSIGN   2551>>ASSIGN   2607>>ASSIGN
MSIZS
      2365**DCL      2608<<ASSIGN   2608>>ASSIGN
MSIZW
      2370**DCL      2551<<ASSIGN   2552>>IF       2558>>ASSIGN   2565>>IF       2570>>IF       2581>>IF
      2654>>ASSIGN
MZ.BOT
      2369**DCL      2609>>ASSIGN
MZ.TOP
      2368**DCL      2609>>ASSIGN
NHDR
      2380**DCL      2621<<ASSIGN   2621>>ASSIGN
NIS$DCCON
      2470**DCL-ENT  2671--CALL
NK$LDCT.DDT$
      2401**DCL      2401--REDEF
NK$LDCT.IOQ$
      2400**DCL      2401--REDEF
NK$LDCT.LDCTX
      2402**DCL      2402--REDEF
NK$LDCT.LKFLG.ABORTED
      2414**DCL      2415--REDEF
NK$LDCT.LNK$
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:95   
      2401**DCL      2588>>IF       2593<<ASSIGN
NK$LDCT.RESCOD
      2407**DCL      2589>>IF       2589>>IF       2589>>IF
NK$LDCT.RLCID.LDCTX
      2424**DCL      2424--REDEF
NK$LDCT.STA$
      2420**DCL      2421--REDEF
NK$LDCT.SYMB$
      2399**DCL      2399--REDEF    2399--REDEF    2400--REDEF
OCQ$
      2359**DCL      2522<<ASSIGN   2525>>CALL     2531>>IF       2552>>IF       2554>>CALL     2558>>ASSIGN
      2562>>ASSIGN   2563>>ASSIGN   2570>>IF       2574>>ASSIGN   2576>>ASSIGN   2579>>ASSIGN   2584>>ASSIGN
      2585>>ASSIGN   2597>>CALL     2606>>ASSIGN   2615>>ASSIGN   2653>>ASSIGN   2653>>ASSIGN   2654>>ASSIGN
      2654>>ASSIGN   2667>>IF       2667>>IF       2670>>ASSIGN   2679>>CALL     2685>>CALL
OP$
      2363**DCL      2378--IMP-PTR  2574<<ASSIGN   2575>>ASSIGN   2577>>ASSIGN   2578>>ASSIGN   2606<<ASSIGN
      2607>>ASSIGN   2609>>ASSIGN   2612>>ASSIGN   2614>>ASSIGN   2615>>ASSIGN   2616<<ASSIGN   2616>>ASSIGN
      2621>>ASSIGN   2622<<ASSIGN   2622>>ASSIGN   2625>>ASSIGN   2626<<ASSIGN   2626>>ASSIGN   2628>>ASSIGN
      2629<<ASSIGN   2629>>ASSIGN   2634>>ASSIGN   2635<<ASSIGN   2635>>ASSIGN   2643<>CALL     2647>>ASSIGN
      2649>>CALLBLT
SETFUL
      2578**LABEL    2568--GOTO     2573--GOTO
SHDR
      2382**DCL      2628<<ASSIGN   2628>>ASSIGN
SIZT
      2373**DCL      2374--REDEF    2576<<ASSIGN
SSS$SYSTIME
      2471**DCL-ENT  2658--CALL
SZT.BOT
      2377**DCL      2577>>ASSIGN
SZT.TOP
      2376**DCL      2577>>ASSIGN
S_TIMR
      2473**DCL      2589>>IF
THDR
      2381**DCL      2625<<ASSIGN   2625>>ASSIGN
PL6.E3A0      #002=KIQ$LINK File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:38 Page:96   
TIMCHK
      2658**LABEL    2601--GOTO
TRAN
      2385**DCL      2649>>CALLBLT
TRPTR
      2371**DCL      2562<<ASSIGN   2564>>IF       2565>>IF       2573>>IF       2581>>IF
UHDR
      2383**DCL      2634<<ASSIGN   2634>>ASSIGN

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:97   
      566        1        /*M* KIQ$FEINT FEP interrupt and timer routines*/
      567        2        /*T***********************************************************/
      568        3        /*T*                                                         */
      569        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      570        5        /*T*                                                         */
      571        6        /*T***********************************************************/
      572        7
      573        8
      574        9        KIQ$FEINT: PROC (DQH,LEV,FAULT);
      575       10
      576       11        /*F* NAME: KIQ$FEINT
      577       12             PURPOSE:
      578       13                  To handle interupts from the front end.
      579       14             DESCRIPTION:
      580       15                  KIQ$FEINT is the interrupt receiver for the L6 FEP.  There
      581       16                  are two interrupt levels recognized in D00 and three in
      582       17                  prior versions.
      583       18                     Versions D00 and beyond:
      584       19                        ICQ - While in the running state this interrupt is
      585       20                              used to tell the HOST that data has been put
      586       21                              into the HOST's input circular queue or that
      587       22                              the FEP is OK.  While the FEP is booting this
      588       23                              interrupt level is used to say that a screech
      589       24                              has occurred in the FEP.  This is true until
      590       25                              COUPLER has initialized the L6 coupler.
      591       26                        IOQ - During the boot process this level signals that
      592       27                              the LCP-6 monitor and the BOOTTIME handlers have
      593       28                              been downloaded.  It also signals that dumping
      594       29                              is complete.  It also signals that COUPLER has
      595       30                              initialized the L6 coupler.  During normal
      596       31                              operations it signals a screech in the FEP.
      597       32                     Versions C01 and earlier:
      598       33                        ICQ - This level is used to signal data in the HOST's
      599       34                              input circular queue and that the FEP is OK.
      600       35                        IOQ - This level signals that booting or dumping is
      601       36                              complete or that COUPLER has initialized the
      602       37                              L6 coupler.
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:98   
      603       38                        COP - This level signals that a screech has occurred
      604       39                              in the FEP.
      605       40        */
      606       41
      607       42        %PLIST;
      608       43        %INCLUDE UE_CP6;
      609      734        %INCLUDE KI_DATA_R;
      610      760        %INCLUDE KI_MACROS_C;
      611     1368        %INCLUDE KI$QHDR;
      612     1520        %INCLUDE NI$TABLES;
      613     1736        %INCLUDE EL$TABLES;
      614     2059        %INCLUDE S_WSPTD_R;
      615     2075        %INCLUDE EL_SUBS_C;
      616     2159        %INCLUDE KI_SUBS_C;
      617     2295        %INCLUDE HF_LOCK_C;
      618     2309        %INCLUDE SS_SCHED_C;
      619     2542        %INCLUDE KL_MACRO_C;
      620     5894        %INCLUDE KL_AFCN_C;
      621     5995        %INCLUDE K_SUBS_C;
      622     6028        %INCLUDE K$RWPARM;
      623     6414        %INCLUDE NK$LDCT;
      624     6516        %INCLUDE NK_SUBS;
      625     6541        %INCLUDE JG_GHOSTS_C;
      626     6631
      627     6632        %EL$FEPFLT (NAME=FFLT,STCLASS="");
      628     6635        %KL_FEPST (STCLASS="");
      629     6670        %K$RWPARM (NAME=K$RWPARM);
      630     6986        %NK$LDCT (NAME=BLDCT);
      631     7032
      632     7033
      633     7034    1   DCL LEV UBIN(18);
      634     7035    1   DCL LEVLCL UBIN(18);
      635     7036    1   DCL 1 FAULT,
      636     7037    1            2 WORD0 UBIN WORD,
      637     7038    1            2 WORD1 UBIN WORD;
      638     7039    1   DCL OCQ$ PTR;
      639     7040    1   DCL QQQ$ PTR ;
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:99   
      640     7041    1   DCL LDCT$ PTR;
      641     7042        %NI$DQH (NAME=DQH,STCLASS="");
      642     7065    1   DCL FEI UBIN(36);
      643     7066    1   DCL FEI$ PTR;
      644     7067
      645     7068
      646     7069        /* Based */
      647     7070        %KI$FEI (STCLASS="BASED(FEI$)");
      648     7154        /* Entry references */
      649     7155    1   DCL KIQ$ISCAN ENTRY(1);
      650     7156    1   DCL SC_BADRCD ENTRY CONV(2,0);
      651     7157    1   DCL KCF$QNF ENTRY(1);
      652     7158    1   DCL KIQ$FEABT ENTRY(2);
      653     7159    1   DCL KIQ$FESTRT ENTRY(1);
      654     7160    1   DCL KIN$RECV ENTRY(1) ALTRET;
      655     7161    1   DCL KIQ$TMQNF ENTRY(1);
      656     7162    1   DCL NIS$DCCON ENTRY(3);
      657     7163    1   DCL KIQ$DMPINT ENTRY(1);
      658     7164    1   DCL ELA$SYSLOG ENTRY(6) ALTRET;
      659     7165    1   DCL SSV$EVENT ENTRY(7);
      660     7166    1   DCL SSR$RUE ENTRY(4);
      661     7167    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
      662     7168    1   DCL MMS$VREL ENTRY(2) ALTRET;
      663     7169    1   DCL KUB$WRITE ENTRY(3) ALTRET;
      664     7170        %B$TDIO (NAME=B$TDIO,STCLASS=AUTO,PARONLY=1);
      665     7179        %SUB_EXC;
      666     7226
      667     7227        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
      668     7543        %EJECT;
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:100  
      669     7544
      670     7545    2        DO INHIBIT; /* Don't allow any more interrupts here - may overflow TSTACK */
      671     7546                %LOCK (G=KI_LOCK);
      672     7549    2        END;
      673     7550    1        FEI=DQH.FEX;
      674     7551    1        FEI$ = KI$FEI$(FEI);
      675     7552    1        IF KI$FEI.OCQ$ = ADDR(NIL) OR KI$FEI.ICQ$ = ADDR(NIL) THEN
      676     7553    1           GOTO MASK_IT;         /* Got an interrupt before ITX could set up FEI */
      677     7554    1        CALL MMS$WSQMAP (KI$FEI.PTPPNO#);
      678     7555    1        IF DQH.STATUS.DOWN AND DQH.STATUS.TND~=0 THEN
      679     7556    2          DO ;
      680     7557    2             B$TDIO = '0'B;
      681     7558    2             IF ADDR(FAULT) ~= ADDR(NIL) THEN
      682     7559    2                B$TDIO.STATUS = FAULT;
      683     7560    2             B$TDIO.P#=SIZEW(B$TDIO)-1;
      684     7561    2             KI$FEI.TCNT  = KITM_TOK;
      685     7562    2             B$TDIO.INTLVL=LEV;
      686     7563    2             CALL SSV$EVENT(DQH.USER#,7,%SUBC_IO#,DQH.EVENTINFO,0,ADDR(B$TDIO));
      687     7564                  %UNLOCK (G=KI_LOCK);
      688     7567    2             RETURN;
      689     7568    2          END;
      690     7569    1        IF ADDR(FAULT)~=ADDR(NIL) THEN
      691     7570    2          DO ;
      692     7571    2             FFLT.DEVADDR=KI$FEI.FECH ;
      693     7572    2             FFLT.FEP#=FEI;
      694     7573    2             FFLT.FAULT = FAULT.WORD0;
      695     7574    2             CALL ELA$SYSLOG (EL_FEPFLT,FFLT,SIZEW(FFLT),'0'B,1,OCQ$);
      696     7575    2          END;
      697     7576    1        OCQ$=KI$FEI.OCQ$;
      698     7577        /* If a fault occured clear it by issuing a connect */
      699     7578    1        IF ADDR(FAULT)~=ADDR(NIL) THEN
      700     7579    1           CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);
      701     7580    1        LEVLCL = LEV ;
      702     7581    1        IF (((KI$FEI.FEST ~= KIST_DN AND KI$FEI.FEST ~= KIST_STOPPING) OR
      703     7582    1          (LEVLCL = FE_IOQINT AND KI$FEI.PBST.PROB ~= KIER_BCMD)) AND
      704     7583    1          KI$FEI.FEST ~= KIST_MASKED)
      705     7584    1        THEN
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:101  
      706     7585    1           IF ADDR(FAULT)~=ADDR(NIL)
      707     7586    1           THEN
      708     7587    2             DO ;
      709     7588    2                CALL KIQ$FEABT (FEI,KIER_DCFT);
      710     7589    2             END;
      711     7590    1           ELSE
      712     7591    2             DO CASE (LEVLCL);
      713     7592
      714     7593
      715     7594    2              CASE(FE_IOQINT);             /* Read L6 memory complete            */
      716     7595    2                IF KI$FEI.FEST = KIST_RUN OR
      717     7596    2                  KI$FEI.FEST = KIST_TOK OR
      718     7597    2                  KI$FEI.FEST = KIST_QFL OR
      719     7598    2                  KI$FEI.FEST = KIST_DB
      720     7599    2                THEN
      721     7600    2                   CALL KIQ$FEABT ( FEI , KIER_FESC ) ;
      722     7601    2                ELSE IF KI$FEI.FEST = KIST_BT /* Fep is booting */
      723     7602    2                   THEN
      724     7603    2                      CALL KIQ$FEABT (FEI,KIER_FREQ);
      725     7604    2                   ELSE
      726     7605    2                      IF KI$FEI.FEST ~=KIST_DMP
      727     7606    2                      THEN
      728     7607    3                        DO ;
      729     7608    3                           IF KI$FEI.FEST ~= KIST_DN
      730     7609    3                           THEN
      731     7610    3                              CALL KIQ$FEABT (FEI,KIER_FREQ);
      732     7611    3                           CALL KIQ$FESTRT (FEI);
      733     7612    3                        END;
      734     7613    2                      ELSE
      735     7614    2                         CALL KIQ$DMPINT(FEI);
      736     7615
      737     7616
      738     7617    2              CASE(FE_ICQINT);             /* Scan the circular queue            */
      739     7618    2                IF KI$FEI.FEST = KIST_BT OR
      740     7619    2                  KI$FEI.FEST = KIST_DN
      741     7620    3                THEN DO ;
      742     7621    3                     CALL KIQ$FEABT ( FEI , KIER_FESC ) ;
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:102  
      743     7622    3                     GOTO GETOUT ;
      744     7623    3                  END ;
      745     7624    2                ELSE IF KI$FEI.FEST ~=KIST_DMP AND KI$FEI.FEST  ~= KIST_TOK
      746     7625    2                   THEN
      747     7626    2                      CALL KIQ$ISCAN (FEI);
      748     7627    2                   ELSE
      749     7628    2                      IF KI$FEI.FEST = KIST_TOK
      750     7629    2                      THEN
      751     7630    3                        DO ;
      752     7631    3                           KL_FEPST.FEP = KI$FEI.FEP#;
      753     7632    3                           KL_FEPST.FCN = IGA_FEPST;
      754     7633    3                           KL_FEPST.PROB = KIER_OK;
      755     7634    3                           KL_FEPST.STATE = KIST_RUN;
      756     7635    3                           CALL KUB$WRITE (KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN')
      757     7636    3                           WHENALTRETURN
      758     7637    4                             DO ;
      759     7638                                     %UNLOCK (G=KI_LOCK);
      760     7641    4                                RETURN;
      761     7642    4                             END;
      762     7643    3                           K$RWPARM = K_RWPARM_CON;
      763     7644    3                           K$RWPARM.FUNCTION = %K_CONNECT;
      764     7645    3                           K$RWPARM.FEX = FEI;
      765     7646    3                           CALL KIN$RECV(K$RWPARM)
      766     7647    4                           WHENALTRETURN DO;
      767     7648                                     %UNLOCK (G=KI_LOCK);
      768     7651    4                                RETURN;
      769     7652    4                             END;
      770     7653    3                           KI$FEI.FEST =KIST_RUN;
      771     7654    3                           KI$FEI.TCNT = KI$FEI.TIMEOUT.RUN;
      772     7655    3                           KI$FEI.PBST.PROB =KIER_OK;
      773     7656    3                           KI$FEI.PBST.STATE =KIST_RUN;
      774     7657    3                           KI$FEI.SEQ = KI$FEI.SEQ + 1;
      775     7658    3                           IF KI$FEI.BDU# ~=0 THEN
      776     7659    4                             DO ;
      777     7660    4                                KI$FEI.BDARS =OCQ$->KI$QHDR.BDCTL.MLCPZ*1024/4;
      778     7661    4                                CALL MMS$VREL (KI$FEI.FEWSQ ,KI$FEI.BD$ );
      779     7662    4                                IF KI$FEI.BDU# ~= JG_FROG# /* FROG */
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:103  
      780     7663    4                                THEN CALL SSR$RUE (%SS_UQA,KI$FEI.BDU# );
      781     7664    4                             END;
      782     7665    3                        END;
      783     7666    2                IF OCQ$->KI$QHDR.FLG.FULL ~= '0'B AND OCQ$->KI$QHDR.RPTR ~= KI$FEI.
              7666                         LST_RPTR
      784     7667    2                THEN
      785     7668    3                  DO ;
      786     7669                          %LOCK (G="OCQ$->KI$QHDR.GATE");
      787     7672    3                     OCQ$->KI$QHDR.FLG.FULL='0'B;
      788     7673
      789     7674    3                     LDCT$ = KI$FEI.QFLHD$  ;
      790     7675    3                     KI$FEI.QFLHD$  = ADDR(NIL) ;
      791     7676                          %UNLOCK (G="OCQ$->KI$QHDR.GATE");
      792     7679
      793     7680    4                     DO WHILE ( LDCT$ ~= ADDR(NIL) ) ;
      794     7681
      795     7682    4                        QQQ$ = LDCT$->BLDCT.LNK$ ;
      796     7683    4                        LDCT$->BLDCT.LNK$ = ADDR(NIL) ;
      797     7684    5                        DO CASE (LDCT$->BLDCT.RESCOD ) ;
      798     7685
      799     7686    5                         CASE(NK_TSTRM,NK_TSFPRG,NK_RES) ;
      800     7687    5                           CALL SSR$RUE(%SS_CUB,LDCT$->BLDCT.USER) ;
      801     7688
      802     7689    5                         CASE(NK_CGTRM,NK_CGFPRG,NK_NOCG,NK_TRMPTH) ;
      803     7690    5                           CALL KCF$QNF(LDCT$->BLDCT) ;
      804     7691
      805     7692    5                         CASE (ELSE) ;
      806     7693    5                           CALL SC_BADRCD ;
      807     7694
      808     7695    5                        END ;
      809     7696    4                        LDCT$ = QQQ$ ;
      810     7697    4                     END ;
      811     7698
      812     7699    3                     CALL SSR$RUE(%SS_CBA);
      813     7700
      814     7701    3                  END;
      815     7702    2                IF KI$FEI.FEST = KIST_QFL
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:104  
      816     7703    2                THEN
      817     7704    2                   CALL KIQ$TMQNF(FEI);
      818     7705
      819     7706
      820     7707    2              CASE(FE_COPINT);             /* Software check */
      821     7708    2                CALL KIQ$FEABT (FEI,KIER_FESC);
      822     7709
      823     7710
      824     7711    2              CASE(ELSE);
      825     7712    2                CALL KIQ$FEABT (FEI,KIER_BINT);
      826     7713    2             END;
      827     7714        /*   Interrupt from FEP in KIST_DN so the channel will be masked
      828     7715             to shut him up.
      829     7716              */
      830     7717    2        ELSE DO ;
      831     7718    2   MASK_IT:  ;
      832     7719    2             CALL NIS$DCCON (KI$FEI.FECH ,'4'O,KI$FEI.FEWSQ);
      833     7720    2             KI$FEI.FEST = KIST_MASKED ;
      834     7721    2          END ;
      835     7722    1   GETOUT:
      836     7723             %UNLOCK (G=KI_LOCK);
      837     7726    1        RETURN;
      838     7727
      839     7728    1   END KIQ$FEINT;
      840     7729
      841     7730
      842     7731        %EOD;

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:105  
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   UE_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure KIQ$FEINT.

   Procedure KIQ$FEINT requires 474 words for executable code.
   Procedure KIQ$FEINT requires 80 words of local(AUTO) storage.

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:106  

 Object Unit name= KIQ$FEINT                                  File name= KIQ$QMGR.:E05TOU
 UTS= JUL 30 '97 00:38:42.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      2      2  KIQ$FEINT
    1   Proc  even  none   474    732  KIQ$FEINT
    2  RoData even  none    25     31  KIQ$FEINT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  KIQ$FEINT
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:107  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 MMS$WSQMAP
         yes           Std       7 SSV$EVENT
         yes           Std       1 HFC$UNLOCK
         yes           Std       2 KIQ$FEABT
         yes           Std       1 KIQ$DMPINT
 yes     yes           Std       1 KIN$RECV
 yes     yes           Std       2 MMS$VREL
         yes           Std       1 KIQ$TMQNF
 yes     yes           Std       6 ELA$SYSLOG
         yes           Std       3 NIS$DCCON
         yes           Std       1 KIQ$ISCAN
         yes           Std       1 KCF$QNF
         yes           Std       1 KIQ$FESTRT
 yes     yes           Std       3 KUB$WRITE
         yes           Std       4 SSR$RUE
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_BADRCD                             KI_FEI$$                              KI_LOCK
     K_RWPARM_CON                          B_VECTNIL
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:108  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ASLENTSID                             ISSID
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:109  


      566        1        /*M* KIQ$FEINT FEP interrupt and timer routines*/
      567        2        /*T***********************************************************/
      568        3        /*T*                                                         */
      569        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      570        5        /*T*                                                         */
      571        6        /*T***********************************************************/
      572        7
      573        8
      574        9        KIQ$FEINT: PROC (DQH,LEV,FAULT);

      9  1 000000   000000 700200 xent  KIQ$FEINT    TSX0  ! X66_AUTO_3
         1 000001   000120 000003                    ZERO    80,3

      575       10
      576       11        /*F* NAME: KIQ$FEINT
      577       12             PURPOSE:
      578       13                  To handle interupts from the front end.
      579       14             DESCRIPTION:
      580       15                  KIQ$FEINT is the interrupt receiver for the L6 FEP.  There
      581       16                  are two interrupt levels recognized in D00 and three in
      582       17                  prior versions.
      583       18                     Versions D00 and beyond:
      584       19                        ICQ - While in the running state this interrupt is
      585       20                              used to tell the HOST that data has been put
      586       21                              into the HOST's input circular queue or that
      587       22                              the FEP is OK.  While the FEP is booting this
      588       23                              interrupt level is used to say that a screech
      589       24                              has occurred in the FEP.  This is true until
      590       25                              COUPLER has initialized the L6 coupler.
      591       26                        IOQ - During the boot process this level signals that
      592       27                              the LCP-6 monitor and the BOOTTIME handlers have
      593       28                              been downloaded.  It also signals that dumping
      594       29                              is complete.  It also signals that COUPLER has
      595       30                              initialized the L6 coupler.  During normal
      596       31                              operations it signals a screech in the FEP.
      597       32                     Versions C01 and earlier:
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:110  
      598       33                        ICQ - This level is used to signal data in the HOST's
      599       34                              input circular queue and that the FEP is OK.
      600       35                        IOQ - This level signals that booting or dumping is
      601       36                              complete or that COUPLER has initialized the
      602       37                              L6 coupler.
      603       38                        COP - This level signals that a screech has occurred
      604       39                              in the FEP.
      605       40        */
      606       41
      607       42        %PLIST;
      608       43        %INCLUDE UE_CP6;
      609      734        %INCLUDE KI_DATA_R;
      610      760        %INCLUDE KI_MACROS_C;
      611     1368        %INCLUDE KI$QHDR;
      612     1520        %INCLUDE NI$TABLES;
      613     1736        %INCLUDE EL$TABLES;
      614     2059        %INCLUDE S_WSPTD_R;
      615     2075        %INCLUDE EL_SUBS_C;
      616     2159        %INCLUDE KI_SUBS_C;
      617     2295        %INCLUDE HF_LOCK_C;
      618     2309        %INCLUDE SS_SCHED_C;
      619     2542        %INCLUDE KL_MACRO_C;
      620     5894        %INCLUDE KL_AFCN_C;
      621     5995        %INCLUDE K_SUBS_C;
      622     6028        %INCLUDE K$RWPARM;
      623     6414        %INCLUDE NK$LDCT;
      624     6516        %INCLUDE NK_SUBS;
      625     6541        %INCLUDE JG_GHOSTS_C;
      626     6631
      627     6632        %EL$FEPFLT (NAME=FFLT,STCLASS="");
      628     6635        %KL_FEPST (STCLASS="");
      629     6670        %K$RWPARM (NAME=K$RWPARM);
      630     6986        %NK$LDCT (NAME=BLDCT);
      631     7032
      632     7033
      633     7034    1   DCL LEV UBIN(18);
      634     7035    1   DCL LEVLCL UBIN(18);
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:111  
      635     7036    1   DCL 1 FAULT,
      636     7037    1            2 WORD0 UBIN WORD,
      637     7038    1            2 WORD1 UBIN WORD;
      638     7039    1   DCL OCQ$ PTR;
      639     7040    1   DCL QQQ$ PTR ;
      640     7041    1   DCL LDCT$ PTR;
      641     7042        %NI$DQH (NAME=DQH,STCLASS="");
      642     7065    1   DCL FEI UBIN(36);
      643     7066    1   DCL FEI$ PTR;
      644     7067
      645     7068
      646     7069        /* Based */
      647     7070        %KI$FEI (STCLASS="BASED(FEI$)");
      648     7154        /* Entry references */
      649     7155    1   DCL KIQ$ISCAN ENTRY(1);
      650     7156    1   DCL SC_BADRCD ENTRY CONV(2,0);
      651     7157    1   DCL KCF$QNF ENTRY(1);
      652     7158    1   DCL KIQ$FEABT ENTRY(2);
      653     7159    1   DCL KIQ$FESTRT ENTRY(1);
      654     7160    1   DCL KIN$RECV ENTRY(1) ALTRET;
      655     7161    1   DCL KIQ$TMQNF ENTRY(1);
      656     7162    1   DCL NIS$DCCON ENTRY(3);
      657     7163    1   DCL KIQ$DMPINT ENTRY(1);
      658     7164    1   DCL ELA$SYSLOG ENTRY(6) ALTRET;
      659     7165    1   DCL SSV$EVENT ENTRY(7);
      660     7166    1   DCL SSR$RUE ENTRY(4);
      661     7167    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
      662     7168    1   DCL MMS$VREL ENTRY(2) ALTRET;
      663     7169    1   DCL KUB$WRITE ENTRY(3) ALTRET;
      664     7170        %B$TDIO (NAME=B$TDIO,STCLASS=AUTO,PARONLY=1);
      665     7179        %SUB_EXC;
      666     7226
      667     7227        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
      668     7543        %EJECT;
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:112  
      669     7544
      670     7545    2        DO INHIBIT; /* Don't allow any more interrupts here - may overflow TSTACK */

      671     7546                %LOCK (G=KI_LOCK);

   7547  1 000002   000000 630600 2                  EPPR0 ! 0
         1 000003   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 000004   000000 701200 xent               TSX1  ! HFC$LOCK
         1 000005   000000 011200                    NOP   ! 0

      672     7549    2        END;

      673     7550    1        FEI=DQH.FEX;

   7550  1 000006   200003 470500                    LDP0    @DQH,,AUTO
         1 000007   000001 236100                    LDQ     1,,PR0
         1 000010   000006 772000                    QRL     6
         1 000011   000077 376007                    ANQ     63,DL
         1 000012   200070 756100                    STQ     FEI,,AUTO

      674     7551    1        FEI$ = KI$FEI$(FEI);

   7551  1 000013   000000 471400 xsym               LDP1    KI_FEI$$
         1 000014   100000 236106                    LDQ     0,QL,PR1
         1 000015   200071 756100                    STQ     FEI$,,AUTO

      675     7552    1        IF KI$FEI.OCQ$ = ADDR(NIL) OR KI$FEI.ICQ$ = ADDR(NIL) THEN

   7552  1 000016   200071 473500                    LDP3    FEI$,,AUTO
         1 000017   300003 236100                    LDQ     3,,PR3
         1 000020   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000021   000706 600000 1                  TZE     MASK_IT
         1 000022   300004 236100                    LDQ     4,,PR3
         1 000023   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000024   000706 600000 1                  TZE     MASK_IT

      676     7553    1           GOTO MASK_IT;         /* Got an interrupt before ITX could set up FEI */
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:113  
      677     7554    1        CALL MMS$WSQMAP (KI$FEI.PTPPNO#);

   7554  1 000025   200071 236100                    LDQ     FEI$,,AUTO
         1 000026   000014 036003                    ADLQ    12,DU
         1 000027   200110 756100                    STQ     B$TDIO+14,,AUTO
         1 000030   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000032   000000 701000 xent               TSX1    MMS$WSQMAP
         1 000033   000000 011000                    NOP     0

      678     7555    1        IF DQH.STATUS.DOWN AND DQH.STATUS.TND~=0 THEN

   7555  1 000034   200003 470500                    LDP0    @DQH,,AUTO
         1 000035   000001 236100                    LDQ     1,,PR0
         1 000036   200000 316003                    CANQ    65536,DU
         1 000037   000115 600000 1                  TZE     s:7569
         1 000040   074000 316003                    CANQ    30720,DU
         1 000041   000115 600000 1                  TZE     s:7569

      679     7556    2          DO ;

      680     7557    2             B$TDIO = '0'B;

   7557  1 000042   000100 100400                    MLR     fill='000'O
         1 000043   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 000044   200072 000064                    ADSC9   B$TDIO,,AUTO             cn=0,n=52

      681     7558    2             IF ADDR(FAULT) ~= ADDR(NIL) THEN

   7558  1 000045   200005 236100                    LDQ     @FAULT,,AUTO
         1 000046   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000047   000054 600000 1                  TZE     s:7560

      682     7559    2                B$TDIO.STATUS = FAULT;

   7559  1 000050   200005 471500                    LDP1    @FAULT,,AUTO
         1 000051   000100 100500                    MLR     fill='000'O
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:114  
         1 000052   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000053   200074 000010                    ADSC9   B$TDIO+2,,AUTO           cn=0,n=8

      683     7560    2             B$TDIO.P#=SIZEW(B$TDIO)-1;

   7560  1 000054   000014 235007                    LDA     12,DL
         1 000055   200072 755100                    STA     B$TDIO,,AUTO

      684     7561    2             KI$FEI.TCNT  = KITM_TOK;

   7561  1 000056   000003 220003                    LDX0    3,DU
         1 000057   200071 471500                    LDP1    FEI$,,AUTO
         1 000060   100002 440100                    SXL0    2,,PR1

      685     7562    2             B$TDIO.INTLVL=LEV;

   7562  1 000061   200004 473500                    LDP3    @LEV,,AUTO
         1 000062   300000 236100                    LDQ     0,,PR3
         1 000063   000022 772000                    QRL     18
         1 000064   200073 756100                    STQ     B$TDIO+1,,AUTO

      686     7563    2             CALL SSV$EVENT(DQH.USER#,7,%SUBC_IO#,DQH.EVENTINFO,0,ADDR(B$TDIO));

   7563  1 000065   200072 634500                    EPPR4   B$TDIO,,AUTO
         1 000066   200110 454500                    STP4    B$TDIO+14,,AUTO
         1 000067   200110 635500                    EPPR5   B$TDIO+14,,AUTO
         1 000070   200117 455500                    STP5    B$TDIO+21,,AUTO
         1 000071   000001 236000 2                  LDQ     1
         1 000072   200116 756100                    STQ     B$TDIO+20,,AUTO
         1 000073   200003 236100                    LDQ     @DQH,,AUTO
         1 000074   000017 036003                    ADLQ    15,DU
         1 000075   000002 235000 2                  LDA     2
         1 000076   200114 757100                    STAQ    B$TDIO+18,,AUTO
         1 000077   000003 236000 2                  LDQ     3
         1 000100   200113 756100                    STQ     B$TDIO+17,,AUTO
         1 000101   200003 236100                    LDQ     @DQH,,AUTO
         1 000102   000004 036000 2                  ADLQ    4
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:115  
         1 000103   200112 756100                    STQ     B$TDIO+16,,AUTO
         1 000104   200112 630500                    EPPR0   B$TDIO+16,,AUTO
         1 000105   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000106   000000 701000 xent               TSX1    SSV$EVENT
         1 000107   000000 011000                    NOP     0

      687     7564                  %UNLOCK (G=KI_LOCK);

   7565  1 000110   000000 630400 2                  EPPR0   0
         1 000111   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000112   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000113   000000 011000                    NOP     0

      688     7567    2             RETURN;

   7567  1 000114   000000 702200 xent               TSX2  ! X66_ARET

      689     7568    2          END;
      690     7569    1        IF ADDR(FAULT)~=ADDR(NIL) THEN

   7569  1 000115   200005 236100                    LDQ     @FAULT,,AUTO
         1 000116   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000117   000146 600000 1                  TZE     s:7576

      691     7570    2          DO ;

      692     7571    2             FFLT.DEVADDR=KI$FEI.FECH ;

   7571  1 000120   200071 471500                    LDP1    FEI$,,AUTO
         1 000121   100002 236100                    LDQ     2,,PR1
         1 000122   200006 552140                    STBQ    FFLT,'40'O,AUTO

      693     7572    2             FFLT.FEP#=FEI;

   7572  1 000123   200070 236100                    LDQ     FEI,,AUTO
         1 000124   200006 552134                    STBQ    FFLT,'34'O,AUTO

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:116  
      694     7573    2             FFLT.FAULT = FAULT.WORD0;

   7573  1 000125   200005 473500                    LDP3    @FAULT,,AUTO
         1 000126   300000 235100                    LDA     0,,PR3
         1 000127   200007 755100                    STA     FFLT+1,,AUTO

      695     7574    2             CALL ELA$SYSLOG (EL_FEPFLT,FFLT,SIZEW(FFLT),'0'B,1,OCQ$);

   7574  1 000130   200065 634500                    EPPR4   OCQ$,,AUTO
         1 000131   200115 454500                    STP4    B$TDIO+19,,AUTO
         1 000132   000002 236000 2                  LDQ     2
         1 000133   200114 756100                    STQ     B$TDIO+18,,AUTO
         1 000134   000006 237000 2                  LDAQ    6
         1 000135   200112 757100                    STAQ    B$TDIO+16,,AUTO
         1 000136   200006 635500                    EPPR5   FFLT,,AUTO
         1 000137   200111 455500                    STP5    B$TDIO+15,,AUTO
         1 000140   000010 236000 2                  LDQ     8
         1 000141   200110 756100                    STQ     B$TDIO+14,,AUTO
         1 000142   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000143   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000144   000000 701000 xent               TSX1    ELA$SYSLOG
         1 000145   000000 011000                    NOP     0

      696     7575    2          END;

      697     7576    1        OCQ$=KI$FEI.OCQ$;

   7576  1 000146   200071 470500                    LDP0    FEI$,,AUTO
         1 000147   000003 236100                    LDQ     3,,PR0
         1 000150   200065 756100                    STQ     OCQ$,,AUTO

      698     7577        /* If a fault occured clear it by issuing a connect */
      699     7578    1        IF ADDR(FAULT)~=ADDR(NIL) THEN

   7578  1 000151   200005 236100                    LDQ     @FAULT,,AUTO
         1 000152   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000153   000170 600000 1                  TZE     s:7580
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:117  

      700     7579    1           CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);

   7579  1 000154   200071 236100                    LDQ     FEI$,,AUTO
         1 000155   000005 036003                    ADLQ    5,DU
         1 000156   200112 756100                    STQ     B$TDIO+16,,AUTO
         1 000157   000001 236000 2                  LDQ     1
         1 000160   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000161   200071 236100                    LDQ     FEI$,,AUTO
         1 000162   000002 036003                    ADLQ    2,DU
         1 000163   200110 756100                    STQ     B$TDIO+14,,AUTO
         1 000164   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000165   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000166   000000 701000 xent               TSX1    NIS$DCCON
         1 000167   000000 011000                    NOP     0

      701     7580    1        LEVLCL = LEV ;

   7580  1 000170   200004 470500                    LDP0    @LEV,,AUTO
         1 000171   000000 220100                    LDX0    0,,PR0
         1 000172   200064 740100                    STX0    LEVLCL,,AUTO

      702     7581    1        IF (((KI$FEI.FEST ~= KIST_DN AND KI$FEI.FEST ~= KIST_STOPPING) OR

   7581  1 000173   200071 471500                    LDP1    FEI$,,AUTO
         1 000174   100002 236100                    LDQ     2,,PR1
         1 000175   000777 316003                    CANQ    511,DU
         1 000176   000203 600000 1                  TZE     s:7581+8
         1 000177   100002 236100                    LDQ     2,,PR1
         1 000200   000777 376003                    ANQ     511,DU
         1 000201   000010 116003                    CMPQ    8,DU
         1 000202   000210 601000 1                  TNZ     s:7581+13
         1 000203   000001 100003                    CMPX0   1,DU
         1 000204   000706 601000 1                  TNZ     MASK_IT
         1 000205   100015 221100                    LDX1    13,,PR1
         1 000206   000013 101003                    CMPX1   11,DU
         1 000207   000706 600000 1                  TZE     MASK_IT
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:118  
         1 000210   100002 236100                    LDQ     2,,PR1
         1 000211   000777 376003                    ANQ     511,DU
         1 000212   000007 116003                    CMPQ    7,DU
         1 000213   000706 600000 1                  TZE     MASK_IT

      703     7582    1          (LEVLCL = FE_IOQINT AND KI$FEI.PBST.PROB ~= KIER_BCMD)) AND
      704     7583    1          KI$FEI.FEST ~= KIST_MASKED)
      705     7584    1        THEN
      706     7585    1           IF ADDR(FAULT)~=ADDR(NIL)

   7585  1 000214   200005 236100                    LDQ     @FAULT,,AUTO
         1 000215   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000216   000230 600000 1                  TZE     s:7591

      707     7586    1           THEN
      708     7587    2             DO ;

      709     7588    2                CALL KIQ$FEABT (FEI,KIER_DCFT);

   7588  1 000217   000011 236000 2                  LDQ     9
         1 000220   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000221   200070 633500                    EPPR3   FEI,,AUTO
         1 000222   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000223   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000224   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000225   000000 701000 xent               TSX1    KIQ$FEABT
         1 000226   000000 011000                    NOP     0

      710     7589    2             END;

   7589  1 000227   000725 710000 1                  TRA     GETOUT

      711     7590    1           ELSE
      712     7591    2             DO CASE (LEVLCL);

   7591  1 000230   000004 100003                    CMPX0   4,DU
         1 000231   000233 602010 1                  TNC     s:7591+3,X0
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:119  
         1 000232   000675 710000 1                  TRA     s:7712
         1 000233   000675 710000 1                  TRA     s:7712
         1 000234   000237 710000 1                  TRA     s:7595
         1 000235   000664 710000 1                  TRA     s:7708
         1 000236   000330 710000 1                  TRA     s:7618

      713     7592
      714     7593
      715     7594    2              CASE(FE_IOQINT);             /* Read L6 memory complete            */

      716     7595    2                IF KI$FEI.FEST = KIST_RUN OR

   7595  1 000237   100002 236100                    LDQ     2,,PR1
         1 000240   000777 376003                    ANQ     511,DU
         1 000241   000002 116003                    CMPQ    2,DU
         1 000242   000251 600000 1                  TZE     s:7600
         1 000243   000001 116003                    CMPQ    1,DU
         1 000244   000251 600000 1                  TZE     s:7600
         1 000245   000003 116003                    CMPQ    3,DU
         1 000246   000251 600000 1                  TZE     s:7600
         1 000247   000004 116003                    CMPQ    4,DU
         1 000250   000262 601000 1                  TNZ     s:7601

      717     7596    2                  KI$FEI.FEST = KIST_TOK OR
      718     7597    2                  KI$FEI.FEST = KIST_QFL OR
      719     7598    2                  KI$FEI.FEST = KIST_DB
      720     7599    2                THEN
      721     7600    2                   CALL KIQ$FEABT ( FEI , KIER_FESC ) ;

   7600  1 000251   000012 236000 2                  LDQ     10
         1 000252   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000253   200070 633500                    EPPR3   FEI,,AUTO
         1 000254   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000255   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000256   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000257   000000 701000 xent               TSX1    KIQ$FEABT
         1 000260   000000 011000                    NOP     0
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:120  
         1 000261   000725 710000 1                  TRA     GETOUT

      722     7601    2                ELSE IF KI$FEI.FEST = KIST_BT /* Fep is booting */

   7601  1 000262   000006 116003                    CMPQ    6,DU
         1 000263   000275 601000 1                  TNZ     s:7605

      723     7602    2                   THEN
      724     7603    2                      CALL KIQ$FEABT (FEI,KIER_FREQ);

   7603  1 000264   000014 236000 2                  LDQ     12
         1 000265   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000266   200070 633500                    EPPR3   FEI,,AUTO
         1 000267   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000270   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000271   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000272   000000 701000 xent               TSX1    KIQ$FEABT
         1 000273   000000 011000                    NOP     0
         1 000274   000725 710000 1                  TRA     GETOUT

      725     7604    2                   ELSE
      726     7605    2                      IF KI$FEI.FEST ~=KIST_DMP

   7605  1 000275   000005 116003                    CMPQ    5,DU
         1 000276   000321 600000 1                  TZE     s:7614

      727     7606    2                      THEN
      728     7607    3                        DO ;

      729     7608    3                           IF KI$FEI.FEST ~= KIST_DN

   7608  1 000277   100002 236100                    LDQ     2,,PR1
         1 000300   000777 316003                    CANQ    511,DU
         1 000301   000312 600000 1                  TZE     s:7611

      730     7609    3                           THEN
      731     7610    3                              CALL KIQ$FEABT (FEI,KIER_FREQ);
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:121  

   7610  1 000302   000014 236000 2                  LDQ     12
         1 000303   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000304   200070 633500                    EPPR3   FEI,,AUTO
         1 000305   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000306   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000307   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000310   000000 701000 xent               TSX1    KIQ$FEABT
         1 000311   000000 011000                    NOP     0

      732     7611    3                           CALL KIQ$FESTRT (FEI);

   7611  1 000312   200070 630500                    EPPR0   FEI,,AUTO
         1 000313   200110 450500                    STP0    B$TDIO+14,,AUTO
         1 000314   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000315   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000316   000000 701000 xent               TSX1    KIQ$FESTRT
         1 000317   000000 011000                    NOP     0

      733     7612    3                        END;

   7612  1 000320   000725 710000 1                  TRA     GETOUT

      734     7613    2                      ELSE
      735     7614    2                         CALL KIQ$DMPINT(FEI);

   7614  1 000321   200070 633500                    EPPR3   FEI,,AUTO
         1 000322   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000323   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000324   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000325   000000 701000 xent               TSX1    KIQ$DMPINT
         1 000326   000000 011000                    NOP     0
         1 000327   000725 710000 1                  TRA     GETOUT

      736     7615
      737     7616
      738     7617    2              CASE(FE_ICQINT);             /* Scan the circular queue            */
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:122  

      739     7618    2                IF KI$FEI.FEST = KIST_BT OR

   7618  1 000330   100002 236100                    LDQ     2,,PR1
         1 000331   000777 376003                    ANQ     511,DU
         1 000332   000006 116003                    CMPQ    6,DU
         1 000333   000337 600000 1                  TZE     s:7621
         1 000334   100002 236100                    LDQ     2,,PR1
         1 000335   000777 316003                    CANQ    511,DU
         1 000336   000350 601000 1                  TNZ     s:7624

      740     7619    2                  KI$FEI.FEST = KIST_DN
      741     7620    3                THEN DO ;

      742     7621    3                     CALL KIQ$FEABT ( FEI , KIER_FESC ) ;

   7621  1 000337   000012 236000 2                  LDQ     10
         1 000340   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000341   200070 633500                    EPPR3   FEI,,AUTO
         1 000342   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000343   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000344   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000345   000000 701000 xent               TSX1    KIQ$FEABT
         1 000346   000000 011000                    NOP     0

      743     7622    3                     GOTO GETOUT ;

   7622  1 000347   000725 710000 1                  TRA     GETOUT

      744     7623    3                  END ;
      745     7624    2                ELSE IF KI$FEI.FEST ~=KIST_DMP AND KI$FEI.FEST  ~= KIST_TOK

   7624  1 000350   100002 236100                    LDQ     2,,PR1
         1 000351   000777 376003                    ANQ     511,DU
         1 000352   000005 116003                    CMPQ    5,DU
         1 000353   000365 600000 1                  TZE     s:7628
         1 000354   000001 116003                    CMPQ    1,DU
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:123  
         1 000355   000365 600000 1                  TZE     s:7628

      746     7625    2                   THEN
      747     7626    2                      CALL KIQ$ISCAN (FEI);

   7626  1 000356   200070 633500                    EPPR3   FEI,,AUTO
         1 000357   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000360   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000361   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000362   000000 701000 xent               TSX1    KIQ$ISCAN
         1 000363   000000 011000                    NOP     0
         1 000364   000527 710000 1                  TRA     s:7666

      748     7627    2                   ELSE
      749     7628    2                      IF KI$FEI.FEST = KIST_TOK

   7628  1 000365   000001 116003                    CMPQ    1,DU
         1 000366   000527 601000 1                  TNZ     s:7666

      750     7629    2                      THEN
      751     7630    3                        DO ;

      752     7631    3                           KL_FEPST.FEP = KI$FEI.FEP#;

   7631  1 000367   100012 236100                    LDQ     10,,PR1
         1 000370   000011 736000                    QLS     9
         1 000371   200010 552120                    STBQ    KL_FEPST,'20'O,AUTO

      753     7632    3                           KL_FEPST.FCN = IGA_FEPST;

   7632  1 000372   040000 236003                    LDQ     16384,DU
         1 000373   200010 552140                    STBQ    KL_FEPST,'40'O,AUTO

      754     7633    3                           KL_FEPST.PROB = KIER_OK;

   7633  1 000374   000000 221003                    LDX1    0,DU
         1 000375   200010 441100                    SXL1    KL_FEPST,,AUTO
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:124  

      755     7634    3                           KL_FEPST.STATE = KIST_RUN;

   7634  1 000376   000002 222003                    LDX2    2,DU
         1 000377   200011 742100                    STX2    KL_FEPST+1,,AUTO

      756     7635    3                           CALL KUB$WRITE (KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN')

   7635  1 000400   000016 236000 2                  LDQ     14
         1 000401   200112 756100                    STQ     B$TDIO+16,,AUTO
         1 000402   000017 236000 2                  LDQ     15
         1 000403   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000404   200010 633500                    EPPR3   KL_FEPST,,AUTO
         1 000405   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000406   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000407   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000410   000000 701000 xent               TSX1    KUB$WRITE
         1 000411   000413 702000 1                  TSX2    s:7639
         1 000412   000420 710000 1                  TRA     s:7643

      757     7636    3                           WHENALTRETURN
      758     7637    4                             DO ;

      759     7638                                     %UNLOCK (G=KI_LOCK);

   7639  1 000413   000000 630400 2                  EPPR0   0
         1 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000415   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000416   000000 011000                    NOP     0

      760     7641    4                                RETURN;

   7641  1 000417   000000 702200 xent               TSX2  ! X66_ARET

      761     7642    4                             END;
      762     7643    3                           K$RWPARM = K_RWPARM_CON;

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:125  
   7643  1 000420   000100 100400                    MLR     fill='000'O
         1 000421   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000422   200014 000234                    ADSC9   K$RWPARM,,AUTO           cn=0,n=156

      763     7644    3                           K$RWPARM.FUNCTION = %K_CONNECT;

   7644  1 000423   000003 235007                    LDA     3,DL
         1 000424   200034 755100                    STA     K$RWPARM+16,,AUTO

      764     7645    3                           K$RWPARM.FEX = FEI;

   7645  1 000425   200070 236100                    LDQ     FEI,,AUTO
         1 000426   200035 756100                    STQ     K$RWPARM+17,,AUTO

      765     7646    3                           CALL KIN$RECV(K$RWPARM)

   7646  1 000427   200014 630500                    EPPR0   K$RWPARM,,AUTO
         1 000430   200110 450500                    STP0    B$TDIO+14,,AUTO
         1 000431   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000432   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000433   000000 701000 xent               TSX1    KIN$RECV
         1 000434   000436 702000 1                  TSX2    s:7649
         1 000435   000443 710000 1                  TRA     s:7653

      766     7647    4                           WHENALTRETURN DO;

      767     7648                                     %UNLOCK (G=KI_LOCK);

   7649  1 000436   000000 630400 2                  EPPR0   0
         1 000437   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000440   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000441   000000 011000                    NOP     0

      768     7651    4                                RETURN;

   7651  1 000442   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:126  
      769     7652    4                             END;
      770     7653    3                           KI$FEI.FEST =KIST_RUN;

   7653  1 000443   200071 470500                    LDP0    FEI$,,AUTO
         1 000444   000002 236003                    LDQ     2,DU
         1 000445   000002 552120                    STBQ    2,'20'O,PR0

      771     7654    3                           KI$FEI.TCNT = KI$FEI.TIMEOUT.RUN;

   7654  1 000446   000020 236100                    LDQ     16,,PR0
         1 000447   000011 772000                    QRL     9
         1 000450   000777 376007                    ANQ     511,DL
         1 000451   000000 620006                    EAX0    0,QL
         1 000452   000002 440100                    SXL0    2,,PR0

      772     7655    3                           KI$FEI.PBST.PROB =KIER_OK;

   7655  1 000453   000000 221003                    LDX1    0,DU
         1 000454   000015 741100                    STX1    13,,PR0

      773     7656    3                           KI$FEI.PBST.STATE =KIST_RUN;

   7656  1 000455   000002 222003                    LDX2    2,DU
         1 000456   000015 442100                    SXL2    13,,PR0

      774     7657    3                           KI$FEI.SEQ = KI$FEI.SEQ + 1;

   7657  1 000457   000007 236100                    LDQ     7,,PR0
         1 000460   000033 772000                    QRL     27
         1 000461   000177 376007                    ANQ     127,DL
         1 000462   000001 036007                    ADLQ    1,DL
         1 000463   000033 736000                    QLS     27
         1 000464   000007 676100                    ERQ     7,,PR0
         1 000465   177000 376003                    ANQ     65024,DU
         1 000466   000007 656100                    ERSQ    7,,PR0

      775     7658    3                           IF KI$FEI.BDU# ~=0 THEN
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:127  

   7658  1 000467   000007 236100                    LDQ     7,,PR0
         1 000470   000777 316003                    CANQ    511,DU
         1 000471   000527 600000 1                  TZE     s:7666

      776     7659    4                             DO ;

      777     7660    4                                KI$FEI.BDARS =OCQ$->KI$QHDR.BDCTL.MLCPZ*1024/4;

   7660  1 000472   200065 471500                    LDP1    OCQ$,,AUTO
         1 000473   100001 236100                    LDQ     1,,PR1
         1 000474   000010 736000                    QLS     8
         1 000475   177400 376007                    ANQ     65280,DL
         1 000476   000000 623006                    EAX3    0,QL
         1 000477   000011 443100                    SXL3    9,,PR0

      778     7661    4                                CALL MMS$VREL (KI$FEI.FEWSQ ,KI$FEI.BD$ );

   7661  1 000500   200071 236100                    LDQ     FEI$,,AUTO
         1 000501   000010 036003                    ADLQ    8,DU
         1 000502   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000503   200071 236100                    LDQ     FEI$,,AUTO
         1 000504   000005 036003                    ADLQ    5,DU
         1 000505   200110 756100                    STQ     B$TDIO+14,,AUTO
         1 000506   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000507   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000510   000000 701000 xent               TSX1    MMS$VREL
         1 000511   000000 011000                    NOP     0

      779     7662    4                                IF KI$FEI.BDU# ~= JG_FROG# /* FROG */

   7662  1 000512   200071 470500                    LDP0    FEI$,,AUTO
         1 000513   000007 236100                    LDQ     7,,PR0
         1 000514   000777 376003                    ANQ     511,DU
         1 000515   000010 116003                    CMPQ    8,DU
         1 000516   000527 600000 1                  TZE     s:7666

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:128  
      780     7663    4                                THEN CALL SSR$RUE (%SS_UQA,KI$FEI.BDU# );

   7663  1 000517   200071 236100                    LDQ     FEI$,,AUTO
         1 000520   000021 036000 2                  ADLQ    17
         1 000521   000022 235000 2                  LDA     18
         1 000522   200110 757100                    STAQ    B$TDIO+14,,AUTO
         1 000523   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000524   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000525   000000 701000 xent               TSX1    SSR$RUE
         1 000526   000000 011000                    NOP     0

      781     7664    4                             END;

      782     7665    3                        END;

      783     7666    2                IF OCQ$->KI$QHDR.FLG.FULL ~= '0'B AND OCQ$->KI$QHDR.RPTR ~= KI$FEI.
              7666                         LST_RPTR

   7666  1 000527   200065 470500                    LDP0    OCQ$,,AUTO
         1 000530   000013 430100                    FSZN    11,,PR0
         1 000531   000650 605000 1                  TPL     s:7702
         1 000532   200071 471500                    LDP1    FEI$,,AUTO
         1 000533   100013 236100                    LDQ     11,,PR1
         1 000534   777777 376007                    ANQ     -1,DL
         1 000535   200110 756100                    STQ     B$TDIO+14,,AUTO
         1 000536   000011 236100                    LDQ     9,,PR0
         1 000537   000004 772000                    QRL     4
         1 000540   200110 116100                    CMPQ    B$TDIO+14,,AUTO
         1 000541   000650 600000 1                  TZE     s:7702

      784     7667    2                THEN
      785     7668    3                  DO ;

      786     7669                          %LOCK (G="OCQ$->KI$QHDR.GATE");

   7670  1 000542   200065 236100                    LDQ     OCQ$,,AUTO
         1 000543   000006 036003                    ADLQ    6,DU
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:129  
         1 000544   200110 756100                    STQ     B$TDIO+14,,AUTO
         1 000545   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000546   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000547   000000 701000 xent               TSX1    HFC$LOCK
         1 000550   000000 011000                    NOP     0

      787     7672    3                     OCQ$->KI$QHDR.FLG.FULL='0'B;

   7672  1 000551   200065 470500                    LDP0    OCQ$,,AUTO
         1 000552   000023 236000 2                  LDQ     19
         1 000553   000013 356100                    ANSQ    11,,PR0

      788     7673
      789     7674    3                     LDCT$ = KI$FEI.QFLHD$  ;

   7674  1 000554   200071 470500                    LDP0    FEI$,,AUTO
         1 000555   000017 236100                    LDQ     15,,PR0
         1 000556   200067 756100                    STQ     LDCT$,,AUTO

      790     7675    3                     KI$FEI.QFLHD$  = ADDR(NIL) ;

   7675  1 000557   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000560   000017 756100                    STQ     15,,PR0

      791     7676                          %UNLOCK (G="OCQ$->KI$QHDR.GATE");

   7677  1 000561   200065 236100                    LDQ     OCQ$,,AUTO
         1 000562   000006 036003                    ADLQ    6,DU
         1 000563   200110 756100                    STQ     B$TDIO+14,,AUTO
         1 000564   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000565   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000566   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000567   000000 011000                    NOP     0

      792     7679
      793     7680    4                     DO WHILE ( LDCT$ ~= ADDR(NIL) ) ;

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:130  
   7680  1 000570   000641 710000 1                  TRA     s:7697

      794     7681
      795     7682    4                        QQQ$ = LDCT$->BLDCT.LNK$ ;

   7682  1 000571   200067 470500                    LDP0    LDCT$,,AUTO
         1 000572   000004 236100                    LDQ     4,,PR0
         1 000573   200066 756100                    STQ     QQQ$,,AUTO

      796     7683    4                        LDCT$->BLDCT.LNK$ = ADDR(NIL) ;

   7683  1 000574   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000575   000004 756100                    STQ     4,,PR0

      797     7684    5                        DO CASE (LDCT$->BLDCT.RESCOD ) ;

   7684  1 000576   000006 720100                    LXL0    6,,PR0
         1 000577   000017 360003                    ANX0    15,DU
         1 000600   000014 100003                    CMPX0   12,DU
         1 000601   000603 602010 1                  TNC     s:7684+5,X0
         1 000602   000635 710000 1                  TRA     s:7693
         1 000603   000635 710000 1                  TRA     s:7693
         1 000604   000617 710000 1                  TRA     s:7687
         1 000605   000630 710000 1                  TRA     s:7690
         1 000606   000635 710000 1                  TRA     s:7693
         1 000607   000635 710000 1                  TRA     s:7693
         1 000610   000630 710000 1                  TRA     s:7690
         1 000611   000630 710000 1                  TRA     s:7690
         1 000612   000635 710000 1                  TRA     s:7693
         1 000613   000617 710000 1                  TRA     s:7687
         1 000614   000630 710000 1                  TRA     s:7690
         1 000615   000635 710000 1                  TRA     s:7693
         1 000616   000617 710000 1                  TRA     s:7687

      798     7685
      799     7686    5                         CASE(NK_TSTRM,NK_TSFPRG,NK_RES) ;

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:131  
      800     7687    5                           CALL SSR$RUE(%SS_CUB,LDCT$->BLDCT.USER) ;

   7687  1 000617   200067 236100                    LDQ     LDCT$,,AUTO
         1 000620   000021 036000 2                  ADLQ    17
         1 000621   000024 235000 2                  LDA     20
         1 000622   200110 757100                    STAQ    B$TDIO+14,,AUTO
         1 000623   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000624   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000625   000000 701000 xent               TSX1    SSR$RUE
         1 000626   000000 011000                    NOP     0
         1 000627   000637 710000 1                  TRA     s:7696

      801     7688
      802     7689    5                         CASE(NK_CGTRM,NK_CGFPRG,NK_NOCG,NK_TRMPTH) ;

      803     7690    5                           CALL KCF$QNF(LDCT$->BLDCT) ;

   7690  1 000630   200067 630500                    EPPR0   LDCT$,,AUTO
         1 000631   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000632   000000 701000 xent               TSX1    KCF$QNF
         1 000633   000000 011000                    NOP     0
         1 000634   000637 710000 1                  TRA     s:7696

      804     7691
      805     7692    5                         CASE (ELSE) ;

      806     7693    5                           CALL SC_BADRCD ;

   7693  1 000635   000000 713400 xsym               CLIMB   SC_BADRCD
         1 000636   000000 600000 xsid               climb   nvectors=         0

      807     7694
      808     7695    5                        END ;

      809     7696    4                        LDCT$ = QQQ$ ;

   7696  1 000637   200066 236100                    LDQ     QQQ$,,AUTO
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:132  
         1 000640   200067 756100                    STQ     LDCT$,,AUTO

      810     7697    4                     END ;

   7697  1 000641   200067 236100                    LDQ     LDCT$,,AUTO
         1 000642   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000643   000571 601000 1                  TNZ     s:7682

      811     7698
      812     7699    3                     CALL SSR$RUE(%SS_CBA);

   7699  1 000644   000026 630400 2                  EPPR0   22
         1 000645   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000646   000000 701000 xent               TSX1    SSR$RUE
         1 000647   000000 011000                    NOP     0

      813     7700
      814     7701    3                  END;

      815     7702    2                IF KI$FEI.FEST = KIST_QFL

   7702  1 000650   200071 470500                    LDP0    FEI$,,AUTO
         1 000651   000002 236100                    LDQ     2,,PR0
         1 000652   000777 376003                    ANQ     511,DU
         1 000653   000003 116003                    CMPQ    3,DU
         1 000654   000725 601000 1                  TNZ     GETOUT

      816     7703    2                THEN
      817     7704    2                   CALL KIQ$TMQNF(FEI);

   7704  1 000655   200070 631500                    EPPR1   FEI,,AUTO
         1 000656   200110 451500                    STP1    B$TDIO+14,,AUTO
         1 000657   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000660   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000661   000000 701000 xent               TSX1    KIQ$TMQNF
         1 000662   000000 011000                    NOP     0
         1 000663   000725 710000 1                  TRA     GETOUT
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:133  

      818     7705
      819     7706
      820     7707    2              CASE(FE_COPINT);             /* Software check */

      821     7708    2                CALL KIQ$FEABT (FEI,KIER_FESC);

   7708  1 000664   000012 236000 2                  LDQ     10
         1 000665   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000666   200070 633500                    EPPR3   FEI,,AUTO
         1 000667   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000670   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000671   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000672   000000 701000 xent               TSX1    KIQ$FEABT
         1 000673   000000 011000                    NOP     0
         1 000674   000725 710000 1                  TRA     GETOUT

      822     7709
      823     7710
      824     7711    2              CASE(ELSE);

      825     7712    2                CALL KIQ$FEABT (FEI,KIER_BINT);

   7712  1 000675   000027 236000 2                  LDQ     23
         1 000676   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000677   200070 633500                    EPPR3   FEI,,AUTO
         1 000700   200110 453500                    STP3    B$TDIO+14,,AUTO
         1 000701   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000702   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000703   000000 701000 xent               TSX1    KIQ$FEABT
         1 000704   000000 011000                    NOP     0

      826     7713    2             END;

   7713  1 000705   000725 710000 1                  TRA     GETOUT

      827     7714        /*   Interrupt from FEP in KIST_DN so the channel will be masked
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:134  
      828     7715             to shut him up.
      829     7716              */
      830     7717    2        ELSE DO ;

   7717  1 000706                       MASK_IT      null
      831     7718    2   MASK_IT:  ;
      832     7719    2             CALL NIS$DCCON (KI$FEI.FECH ,'4'O,KI$FEI.FEWSQ);

   7719  1 000706   200071 236100                    LDQ     FEI$,,AUTO
         1 000707   000005 036003                    ADLQ    5,DU
         1 000710   200112 756100                    STQ     B$TDIO+16,,AUTO
         1 000711   000030 236000 2                  LDQ     24
         1 000712   200111 756100                    STQ     B$TDIO+15,,AUTO
         1 000713   200071 236100                    LDQ     FEI$,,AUTO
         1 000714   000002 036003                    ADLQ    2,DU
         1 000715   200110 756100                    STQ     B$TDIO+14,,AUTO
         1 000716   200110 630500                    EPPR0   B$TDIO+14,,AUTO
         1 000717   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000720   000000 701000 xent               TSX1    NIS$DCCON
         1 000721   000000 011000                    NOP     0

      833     7720    2             KI$FEI.FEST = KIST_MASKED ;

   7720  1 000722   200071 470500                    LDP0    FEI$,,AUTO
         1 000723   000007 236003                    LDQ     7,DU
         1 000724   000002 552120                    STBQ    2,'20'O,PR0

      834     7721    2          END ;

      835     7722    1   GETOUT:
      836     7723             %UNLOCK (G=KI_LOCK);

   7724  1 000725   000000 630400 2     GETOUT       EPPR0   0
         1 000726   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000727   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000730   000000 011000                    NOP     0

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:135  
      837     7726    1        RETURN;

   7726  1 000731   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   0     000   110114 120101   104115 111116                                    HLPADMIN

(unnamed)
 Sect OctLoc
   2     000   000000 006000   000002 006000   000003 006000   000011 006000    ................
   2     004   000020 200000   000000 000316   000004 006000   000002 006000    ................
   2     010   000005 006000   000014 006000   000006 006000   000000 000020    ................
   2     014   000013 006000   000000 000016   000000 006000   000015 006000    ................
   2     020   000000 000034   000007 200000   000020 006000   776777 777777    ................
   2     024   000012 006000   000000 000077   000025 006000   000010 006000    .......?........
   2     030   000030 006000                                                    ....
      838     7727
      839     7728    1   END KIQ$FEINT;
      840     7729
      841     7730
      842     7731        %EOD;

PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:136  
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   UE_CP6.:E05TOU  is referenced.
      No diagnostics issued in procedure KIQ$FEINT.
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:137  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DQH                       5-0-0/w PTR         r     1 @FAULT
     4-0-0/w PTR         r     1 @LEV                      72-0-0/w STRC(468)   r     1 B$TDIO
    *0-0-0/w STRC(648)   r     1 DQH                       *0-0-0/w STRC(72)    r     1 FAULT
    70-0-0/w UBIN        r     1 FEI                       71-0-0/w PTR         r     1 FEI$
     6-0-0/w STRC(72)    r     1 FFLT                      14-0-0/d STRC(1404)  r     1 K$RWPARM
    10-0-0/w STRC(126)   r     1 KL_FEPST                  67-0-0/w PTR         r     1 LDCT$
    *0-0-0/w UBIN(18)    r     1 LEV                       64-0-0/w UBIN(18)    r     1 LEVLCL
    65-0-0/w PTR         r     1 OCQ$                      66-0-0/w PTR         r     1 QQQ$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KI_FEI$$                   0-0-0/b BIT (72)    r     1 KI_LOCK
     0-0-0/d STRC(1404)  r     1 K_RWPARM_CON

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(864)   r     1 BLDCT                      0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/d STRC(576)   r     1 KI$QHDR


   Procedure KIQ$FEINT requires 474 words for executable code.
   Procedure KIQ$FEINT requires 80 words of local(AUTO) storage.
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:138  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:139  
          MINI XREF LISTING

B$TDIO
      7174**DCL      7557<<ASSIGN   7560--ASSIGN   7563--CALL
B$TDIO.FLPW
      7176**DCL      7176--REDEF
B$TDIO.INTLVL
      7176**DCL      7562<<ASSIGN
B$TDIO.P#
      7176**DCL      7560<<ASSIGN
B$TDIO.STATUS
      7176**DCL      7559<<ASSIGN
BLDCT
      6999**DCL      7690<>CALL
BLDCT.DDT$
      7001**DCL      7001--REDEF
BLDCT.IOQ$
      7000**DCL      7001--REDEF
BLDCT.LDCTX
      7002**DCL      7002--REDEF
BLDCT.LKFLG.ABORTED
      7014**DCL      7015--REDEF
BLDCT.LNK$
      7001**DCL      7682>>ASSIGN   7683<<ASSIGN
BLDCT.RESCOD
      7007**DCL      7684>>DOCASE
BLDCT.RLCID.LDCTX
      7024**DCL      7024--REDEF
BLDCT.STA$
      7020**DCL      7021--REDEF
BLDCT.SYMB$
      6999**DCL      6999--REDEF    6999--REDEF    7000--REDEF
BLDCT.USER
      7009**DCL      7687<>CALL
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:140  
DQH
      7051**DCL         9--PROC
DQH.EVENTINFO
      7059**DCL      7563<>CALL
DQH.FEX
      7054**DCL      7550>>ASSIGN
DQH.IOCHANX
      7053**DCL      7054--REDEF
DQH.MBX$
      7062**DCL      7063--REDEF
DQH.STATUS.DOWN
      7051**DCL      7555>>IF
DQH.STATUS.TND
      7052**DCL      7555>>IF
DQH.USER#
      7061**DCL      7563<>CALL
ELA$SYSLOG
      7164**DCL-ENT  7574--CALL
FAULT
      7036**DCL         9--PROC     7558--IF       7559>>ASSIGN   7569--IF       7578--IF       7585--IF
FAULT.WORD0
      7037**DCL      7573>>ASSIGN
FEI
      7065**DCL      7550<<ASSIGN   7551>>ASSIGN   7572>>ASSIGN   7588<>CALL     7600<>CALL     7603<>CALL
      7610<>CALL     7611<>CALL     7614<>CALL     7621<>CALL     7626<>CALL     7645>>ASSIGN   7704<>CALL
      7708<>CALL     7712<>CALL
FEI$
      7066**DCL      7083--IMP-PTR  7551<<ASSIGN   7552>>IF       7552>>IF       7554>>CALL     7561>>ASSIGN
      7571>>ASSIGN   7576>>ASSIGN   7579>>CALL     7579>>CALL     7581>>IF       7581>>IF       7581>>IF
      7581>>IF       7595>>IF       7595>>IF       7595>>IF       7595>>IF       7601>>IF       7605>>IF
      7608>>IF       7618>>IF       7618>>IF       7624>>IF       7624>>IF       7628>>IF       7631>>ASSIGN
      7653>>ASSIGN   7654>>ASSIGN   7654>>ASSIGN   7655>>ASSIGN   7656>>ASSIGN   7657>>ASSIGN   7657>>ASSIGN
      7658>>IF       7660>>ASSIGN   7661>>CALL     7661>>CALL     7662>>IF       7663>>CALL     7666>>IF
      7674>>ASSIGN   7675>>ASSIGN   7702>>IF       7719>>CALL     7719>>CALL     7720>>ASSIGN
FFLT
      6633**DCL      7574<>CALL     7574--CALL
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:141  
FFLT.DEVADDR
      6633**DCL      7571<<ASSIGN
FFLT.FAULT
      6633**DCL      7573<<ASSIGN
FFLT.FEP#
      6633**DCL      7572<<ASSIGN
GETOUT
      7724**LABEL    7622--GOTO
HFC$LOCK
      2308**DCL-ENT  7547--CALL     7670--CALL
HFC$UNLOCK
      2308**DCL-ENT  7565--CALL     7639--CALL     7649--CALL     7677--CALL     7724--CALL
K$RWPARM
      6691**DCL      7643<<ASSIGN   7646<>CALL
K$RWPARM.BLKREC
      6717**DCL      6742--REDEF
K$RWPARM.BLKREC.BLKU#
      6718**DCL      6720--REDEF
K$RWPARM.BLKREC.RECU#
      6730**DCL      6732--REDEF
K$RWPARM.DVE.DVBYTE.VFC
      6757**DCL      6758--REDEF
K$RWPARM.DVE.EOMCHAR
      6765**DCL      6769--REDEF
K$RWPARM.ERR
      6829**DCL      6834--REDEF
K$RWPARM.FC
      6793**DCL      6794--REDEF
K$RWPARM.FEX
      6875**DCL      7645<<ASSIGN
K$RWPARM.FLDID
      6975**DCL      6976--REDEF
K$RWPARM.FPT$
      6856**DCL      6863--REDEF
K$RWPARM.FUNCTION
      6870**DCL      7644<<ASSIGN
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:142  
K$RWPARM.KEYTYPE
      6982**DCL      6983--REDEF
K$RWPARM.MSG$
      6692**DCL      6698--REDEF
K$RWPARM.MSGID
      6804**DCL      6809--REDEF
K$RWPARM.MSGIDXT
      6817**DCL      6821--REDEF
K$RWPARM.ORG
      6953**DCL      6954--REDEF
K$RWPARM.THDRSZ
      6897**DCL      6901--REDEF
K$RWPARM.VDOFLGS
      6955**DCL      6966--REDEF
KCF$QNF
      7157**DCL-ENT  7690--CALL
KI$FEI.BD$
      7118**DCL      7119--REDEF    7661<>CALL
KI$FEI.BDAD.WADDR
      7120**DCL      7121--REDEF
KI$FEI.BDARS
      7126**DCL      7660<<ASSIGN
KI$FEI.BDU#
      7116**DCL      7658>>IF       7662>>IF       7663<>CALL
KI$FEI.FECH
      7085**DCL      7571>>ASSIGN   7579<>CALL     7719<>CALL
KI$FEI.FEP#
      7128**DCL      7631>>ASSIGN
KI$FEI.FEST
      7088**DCL      7581>>IF       7581>>IF       7581>>IF       7595>>IF       7595>>IF       7595>>IF
      7595>>IF       7601>>IF       7605>>IF       7608>>IF       7618>>IF       7618>>IF       7624>>IF
      7624>>IF       7628>>IF       7653<<ASSIGN   7702>>IF       7720<<ASSIGN
KI$FEI.FEWSQ
      7111**DCL      7579<>CALL     7661<>CALL     7719<>CALL
KI$FEI.ICQ$
      7105**DCL      7552>>IF
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:143  
KI$FEI.LST_RPTR
      7132**DCL      7666>>IF
KI$FEI.OCQ$
      7099**DCL      7552>>IF       7576>>ASSIGN
KI$FEI.PBST.PROB
      7136**DCL      7581>>IF       7655<<ASSIGN
KI$FEI.PBST.STATE
      7140**DCL      7656<<ASSIGN
KI$FEI.PTPPNO#
      7133**DCL      7554<>CALL
KI$FEI.QFLHD$
      7147**DCL      7674>>ASSIGN   7675<<ASSIGN
KI$FEI.RCVPB
      7134**DCL      7135--REDEF
KI$FEI.SEQ
      7115**DCL      7657<<ASSIGN   7657>>ASSIGN
KI$FEI.TCNT
      7095**DCL      7561<<ASSIGN   7654<<ASSIGN
KI$FEI.TIMEOUT.RUN
      7151**DCL      7654>>ASSIGN
KI$FEI$
       746**DCL      7551>>ASSIGN
KI$QHDR.BDCTL.MLCPZ
      1408**DCL      7660>>ASSIGN
KI$QHDR.FLG.FULL
      1428**DCL      7666>>IF       7672<<ASSIGN
KI$QHDR.GATE
      1419**DCL      7670<>CALL     7677<>CALL
KI$QHDR.RPTR
      1421**DCL      7666>>IF
KIN$RECV
      7160**DCL-ENT  7646--CALL
KIQ$DMPINT
      7163**DCL-ENT  7614--CALL
KIQ$FEABT
      7158**DCL-ENT  7588--CALL     7600--CALL     7603--CALL     7610--CALL     7621--CALL     7708--CALL
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:144  
      7712--CALL
KIQ$FESTRT
      7159**DCL-ENT  7611--CALL
KIQ$ISCAN
      7155**DCL-ENT  7626--CALL
KIQ$TMQNF
      7161**DCL-ENT  7704--CALL
KI_FEI$$
       745**DCL       746--IMP-PTR  7551>>ASSIGN
KI_LOCK
       758**DCL      7547<>CALL     7565<>CALL     7639<>CALL     7649<>CALL     7724<>CALL
KL_FEPST
      6648**DCL      7635<>CALL     7635--CALL
KL_FEPST.FCN
      6649**DCL      7632<<ASSIGN
KL_FEPST.FEP
      6651**DCL      7631<<ASSIGN
KL_FEPST.PROB
      6662**DCL      7633<<ASSIGN
KL_FEPST.STATE
      6663**DCL      7634<<ASSIGN
KUB$WRITE
      7169**DCL-ENT  7635--CALL
K_RWPARM_CON
      7248**DCL      7643>>ASSIGN
K_RWPARM_CON.BLKREC
      7274**DCL      7299--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      7275**DCL      7277--REDEF
K_RWPARM_CON.BLKREC.RECU#
      7287**DCL      7289--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      7314**DCL      7315--REDEF
K_RWPARM_CON.DVE.EOMCHAR
      7322**DCL      7326--REDEF
K_RWPARM_CON.ERR
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:145  
      7386**DCL      7391--REDEF
K_RWPARM_CON.FC
      7350**DCL      7351--REDEF
K_RWPARM_CON.FLDID
      7532**DCL      7533--REDEF
K_RWPARM_CON.FPT$
      7413**DCL      7420--REDEF
K_RWPARM_CON.KEYTYPE
      7539**DCL      7540--REDEF
K_RWPARM_CON.MSG$
      7249**DCL      7255--REDEF
K_RWPARM_CON.MSGID
      7361**DCL      7366--REDEF
K_RWPARM_CON.MSGIDXT
      7374**DCL      7378--REDEF
K_RWPARM_CON.ORG
      7510**DCL      7511--REDEF
K_RWPARM_CON.THDRSZ
      7454**DCL      7458--REDEF
K_RWPARM_CON.VDOFLGS
      7512**DCL      7523--REDEF
LDCT$
      7041**DCL      7674<<ASSIGN   7680>>DOWHILE  7682>>ASSIGN   7683>>ASSIGN   7684>>DOCASE   7687>>CALL
      7690>>CALL     7696<<ASSIGN
LEV
      7034**DCL         9--PROC     7562>>ASSIGN   7580>>ASSIGN
LEVLCL
      7035**DCL      7580<<ASSIGN   7581>>IF       7591>>DOCASE
MASK_IT
      7717**LABEL    7553--GOTO
MMS$VREL
      7168**DCL-ENT  7661--CALL
MMS$WSQMAP
      7167**DCL-ENT  7554--CALL
NIS$DCCON
      7162**DCL-ENT  7579--CALL     7719--CALL
PL6.E3A0      #003=KIQ$FEINT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:38 Page:146  
OCQ$
      7039**DCL      7574<>CALL     7576<<ASSIGN   7660>>ASSIGN   7666>>IF       7666>>IF       7670>>CALL
      7672>>ASSIGN   7677>>CALL
QQQ$
      7040**DCL      7682<<ASSIGN   7696>>ASSIGN
SC_BADRCD
      7156**DCL-ENT  7693--CALL
SSR$RUE
      7166**DCL-ENT  7663--CALL     7687--CALL     7699--CALL
SSV$EVENT
      7165**DCL-ENT  7563--CALL

PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:147  
      843        1        /*T***********************************************************/
      844        2        /*T*                                                         */
      845        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      846        4        /*T*                                                         */
      847        5        /*T***********************************************************/
      848        6
      849        7
      850        8        KIQ$TMLP: PROC(FEPX);
      851        9
      852       10
      853       11        %INCLUDE KI$MHDR;
      854      152        %INCLUDE KI$QHDR;
      855      304        %INCLUDE KI_DATA_R;
      856      330        %INCLUDE KI_MACROS_C;
      857      938        %INCLUDE KI_SUBS_C;
      858     1074        %INCLUDE NK_SUBS;
      859     1099        %INCLUDE K$RWPARM;
      860     1485        %INCLUDE K_SUBS_C;
      861     1518        %INCLUDE HF_LOCK_C;
      862     1532        %INCLUDE KJ_FCNS_C;
      863     1559
      864     1560        %KI$MHDRT (STCLASS="");
      865     1566        %K$RWPARM (NAME=K$RWPARM);
      866     1882
      867     1883    1   DCL KIQ$LINK ENTRY(2) ALTRET;
      868     1884    1   DCL FEPX UBIN WORD;
      869     1885    1   DCL FEI UBIN WORD;
      870     1886    1   DCL FEI$ PTR;
      871     1887    1   DCL SSC$MONTIMR ENTRY(3);
      872     1888    1   DCL UMT$IDT ENTRY(2) ALTRET;
      873     1889    1   DCL KIQ$FEABT ENTRY(2);
      874     1890    1   DCL SSS$SYSTIME ENTRY(1);
      875     1891    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
      876     1892
      877     1893        %KI$FEI (STCLASS="BASED(FEI$)");
      878     1977
      879     1978        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:148  
      880     2294
      881     2295        %EJECT;
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:149  
      882     2296             %LOCK (G=KI_LOCK);
      883     2299
      884     2300    2        DO FEI=1 TO KI_MXFE;
      885     2301
      886     2302    2           FEI$ = KI$FEI$(FEI);
      887     2303    2           CALL MMS$WSQMAP(KI$FEI.PTPPNO#);
      888     2304
      889     2305    3           DO CASE(KI$FEI.FEST );
      890     2306
      891     2307
      892     2308    3            CASE ( KIST_DN ) ;
      893     2309    4              IF KI$FEI.PBST.PROB = KIER_FREQ THEN DO ;
      894     2310    4                   KI$FEI.TCNT = KI$FEI.TCNT - 1 ;
      895     2311    4                   IF KI$FEI.TCNT <= 0 THEN
      896     2312    4                      CALL KIQ$FEABT ( FEI , KIER_TO ) ;
      897     2313    4                END ;
      898     2314
      899     2315
      900     2316    3            CASE ( KIST_STOPPING , KIST_MASKED ) ;
      901     2317
      902     2318
      903     2319    3            CASE(KIST_DB);
      904     2320    3              KI$FEI.TCNT =KI$FEI.TCNT -1;
      905     2321    3              IF KI$FEI.TCNT >0
      906     2322    3              THEN
      907     2323    3                 CALL TIMO ALTRET (NO_COUNT);
      908     2324    3              ELSE
      909     2325    3   NO_COUNT:     KI$FEI.TCNT =KI$FEI.TCNT +1;
      910     2326
      911     2327
      912     2328    3            CASE(KIST_DMP,KIST_TOK,KIST_BT);
      913     2329    3              KI$FEI.TCNT =KI$FEI.TCNT -1;
      914     2330    3              IF KI$FEI.TCNT <=0
      915     2331    3              THEN
      916     2332    3                 CALL KIQ$FEABT (FEI,KIER_TO);
      917     2333
      918     2334
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:150  
      919     2335    3            CASE(KIST_QFL);
      920     2336    3              KI$FEI.TCNT =KI$FEI.TCNT -1;
      921     2337    3              IF KI$FEI.TCNT <=0 AND NOT KI$FEI.NOTIME
      922     2338    3              THEN
      923     2339    3                 CALL KIQ$FEABT (FEI,KIER_QFL);
      924     2340
      925     2341
      926     2342    3            CASE(KIST_RUN);
      927     2343    3              KI$FEI.TCNT =KI$FEI.TCNT -1;
      928     2344    3              IF NOT (KI$FEI.FROZEN ) AND NOT KI$FEI.NOTIME
      929     2345    3              THEN
      930     2346    3                 IF KI$FEI.TCNT <=0
      931     2347    3                 THEN
      932     2348    3                    CALL KIQ$FEABT (FEI,KIER_TO);
      933     2349    3              IF KI$FEI.OCQ$->KI$QHDR.FLG.FULL AND KI$FEI.TCNT <KITM_RUN-1
      934     2350    3              THEN
      935     2351    3                 IF NOT KI$FEI.NOTIME
      936     2352    3                 THEN
      937     2353    3                    GOTO QFL;
      938     2354    3              CALL TIMO ALTRET (QFL);
      939     2355    3           END;
      940     2356    2   NXTFE:  ;
      941     2357    2        END;
      942     2358    1        CALL SSC$MONTIMR (SEC5,ENTADDR(KIQ$TMLP),FEI);
      943     2359             %UNLOCK (G=KI_LOCK);
      944     2362    1        RETURN;
      945     2363
      946     2364    1   QFL: ;
      947     2365    1        IF KI$FEI.FEST ~=KIST_DN THEN
      948     2366    2          DO ;
      949     2367    2             KI$FEI.FEST =KIST_QFL;
      950     2368    2             KI$FEI.TCNT =KITM_QFL;
      951     2369    2          END;
      952     2370    1        GOTO NXTFE;
      953     2371
      954     2372    1   KIQ$TMQNF: ENTRY(FEPX);
      955     2373
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:151  
      956     2374    1        FEI=FEPX;
      957     2375    1        FEI$ = KI$FEI$(FEI);
      958     2376    1        CALL TIMO ALTRET (RTN);
      959     2377    1        KI$FEI.FEST =KIST_RUN;
      960     2378    1        KI$FEI.TCNT = KI$FEI.TIMEOUT.RUN;
      961     2379    1   RTN: ;
      962     2380    1        RETURN;
      963     2381
      964     2382
      965     2383    1   TIMO: PROC ALTRET;
      966     2384
      967     2385    2        KI$MHDRT.BLNK=' ';
      968     2386    2        CALL UMT$IDT (KI$MHDRT.DATE,KI$MHDRT.TIME);
      969     2387    2        K$RWPARM = K_RWPARM_CON;
      970     2388    2        K$RWPARM.UHDRSZ = LENGTHC(KI$MHDRT);
      971     2389    2        K$RWPARM.UHDR$ = ADDR(KI$MHDRT);
      972     2390
      973     2391    2        K$RWPARM.FUNCTION = %K_WRITE;
      974     2392    2        K$RWPARM.FEX = FEI;
      975     2393    2        CALL KIQ$LINK (K$RWPARM,%KJ_FCN_TIM) ALTRET(ALTRT);
      976     2394    2        RETURN;
      977     2395
      978     2396    2   ALTRT: ;
      979     2397    2        ALTRETURN;
      980     2398    2   END TIMO;
      981     2399
      982     2400    1   END KIQ$TMLP;
      983     2401
      984     2402
      985     2403        %EOD;

PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:152  
--  Include file information  --

   KJ_FCNS_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   KI$MHDR.:E05TOU  is referenced.
      No diagnostics issued in procedure KIQ$TMLP.

   Procedure KIQ$TMLP requires 206 words for executable code.
   Procedure KIQ$TMLP requires 56 words of local(AUTO) storage.

PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:153  

 Object Unit name= KIQ$TMLP                                   File name= KIQ$QMGR.:E05TOU
 UTS= JUL 30 '97 00:39:31.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   206    316  KIQ$TMLP
    1  RoData even  none     8     10  KIQ$TMLP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  KIQ$TMLP
     0    227                  yes      Std        1  KIQ$TMQNF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 MMS$WSQMAP
         yes           Std       2 KIQ$FEABT
         yes           Std       3 SSC$MONTIMR
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       2 UMT$IDT
 yes     yes           Std       2 KIQ$LINK
         yes           Std       1 KIQ$TMLP
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:154  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KI_FEI$$                              KI_MXFE                               KI_LOCK
     K_RWPARM_CON                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:155  


      843        1        /*T***********************************************************/
      844        2        /*T*                                                         */
      845        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      846        4        /*T*                                                         */
      847        5        /*T***********************************************************/
      848        6
      849        7
      850        8        KIQ$TMLP: PROC(FEPX);

      8  0 000000   000000 700200 xent  KIQ$TMLP     TSX0  ! X66_AUTO_1
         0 000001   000070 000001                    ZERO    56,1

      851        9
      852       10
      853       11        %INCLUDE KI$MHDR;
      854      152        %INCLUDE KI$QHDR;
      855      304        %INCLUDE KI_DATA_R;
      856      330        %INCLUDE KI_MACROS_C;
      857      938        %INCLUDE KI_SUBS_C;
      858     1074        %INCLUDE NK_SUBS;
      859     1099        %INCLUDE K$RWPARM;
      860     1485        %INCLUDE K_SUBS_C;
      861     1518        %INCLUDE HF_LOCK_C;
      862     1532        %INCLUDE KJ_FCNS_C;
      863     1559
      864     1560        %KI$MHDRT (STCLASS="");
      865     1566        %K$RWPARM (NAME=K$RWPARM);
      866     1882
      867     1883    1   DCL KIQ$LINK ENTRY(2) ALTRET;
      868     1884    1   DCL FEPX UBIN WORD;
      869     1885    1   DCL FEI UBIN WORD;
      870     1886    1   DCL FEI$ PTR;
      871     1887    1   DCL SSC$MONTIMR ENTRY(3);
      872     1888    1   DCL UMT$IDT ENTRY(2) ALTRET;
      873     1889    1   DCL KIQ$FEABT ENTRY(2);
      874     1890    1   DCL SSS$SYSTIME ENTRY(1);
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:156  
      875     1891    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
      876     1892
      877     1893        %KI$FEI (STCLASS="BASED(FEI$)");
      878     1977
      879     1978        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
      880     2294
      881     2295        %EJECT;
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:157  
      882     2296             %LOCK (G=KI_LOCK);

   2297  0 000002   000000 630400 1                  EPPR0   0
         0 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000004   000000 701000 xent               TSX1    HFC$LOCK
         0 000005   000000 011000                    NOP     0

      883     2299
      884     2300    2        DO FEI=1 TO KI_MXFE;

   2300  0 000006   000001 235007                    LDA     1,DL
         0 000007   200060 755100                    STA     FEI,,AUTO
         0 000010   000172 710000 0                  TRA     NXTFE+3

      885     2301
      886     2302    2           FEI$ = KI$FEI$(FEI);

   2302  0 000011   000000 470400 xsym               LDP0    KI_FEI$$
         0 000012   200060 720100                    LXL0    FEI,,AUTO
         0 000013   000000 236110                    LDQ     0,X0,PR0
         0 000014   200061 756100                    STQ     FEI$,,AUTO

      887     2303    2           CALL MMS$WSQMAP(KI$FEI.PTPPNO#);

   2303  0 000015   000014 036003                    ADLQ    12,DU
         0 000016   200064 756100                    STQ     FEI$+3,,AUTO
         0 000017   200064 630500                    EPPR0   FEI$+3,,AUTO
         0 000020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000021   000000 701000 xent               TSX1    MMS$WSQMAP
         0 000022   000000 011000                    NOP     0

      888     2304
      889     2305    3           DO CASE(KI$FEI.FEST );

   2305  0 000023   200061 470500                    LDP0    FEI$,,AUTO
         0 000024   000002 220100                    LDX0    2,,PR0
         0 000025   000777 360003                    ANX0    511,DU
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:158  
         0 000026   000007 100003                    CMPX0   7,DU
         0 000027   000031 602010 0                  TNC     s:2305+6,X0
         0 000030   000167 710000 0                  TRA     NXTFE
         0 000031   000040 710000 0                  TRA     s:2309
         0 000032   000074 710000 0                  TRA     s:2329
         0 000033   000131 710000 0                  TRA     s:2343
         0 000034   000111 710000 0                  TRA     s:2336
         0 000035   000060 710000 0                  TRA     s:2320
         0 000036   000074 710000 0                  TRA     s:2329
         0 000037   000074 710000 0                  TRA     s:2329

      890     2306
      891     2307
      892     2308    3            CASE ( KIST_DN ) ;

      893     2309    4              IF KI$FEI.PBST.PROB = KIER_FREQ THEN DO ;

   2309  0 000040   000015 221100                    LDX1    13,,PR0
         0 000041   000020 101003                    CMPX1   16,DU
         0 000042   000167 601000 0                  TNZ     NXTFE

      894     2310    4                   KI$FEI.TCNT = KI$FEI.TCNT - 1 ;

   2310  0 000043   000002 722100                    LXL2    2,,PR0
         0 000044   777777 623012                    EAX3    -1,X2
         0 000045   000002 443100                    SXL3    2,,PR0

      895     2311    4                   IF KI$FEI.TCNT <= 0 THEN

   2311  0 000046   000167 605400 0                  TPNZ    NXTFE

      896     2312    4                      CALL KIQ$FEABT ( FEI , KIER_TO ) ;

   2312  0 000047   000001 236000 1                  LDQ     1
         0 000050   200065 756100                    STQ     FEI$+4,,AUTO
         0 000051   200060 631500                    EPPR1   FEI,,AUTO
         0 000052   200064 451500                    STP1    FEI$+3,,AUTO
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:159  
         0 000053   200064 630500                    EPPR0   FEI$+3,,AUTO
         0 000054   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000055   000000 701000 xent               TSX1    KIQ$FEABT
         0 000056   000000 011000                    NOP     0

      897     2313    4                END ;

   2313  0 000057   000167 710000 0                  TRA     NXTFE

      898     2314
      899     2315
      900     2316    3            CASE ( KIST_STOPPING , KIST_MASKED ) ;

      901     2317
      902     2318
      903     2319    3            CASE(KIST_DB);

      904     2320    3              KI$FEI.TCNT =KI$FEI.TCNT -1;

   2320  0 000060   000002 721100                    LXL1    2,,PR0
         0 000061   777777 622011                    EAX2    -1,X1
         0 000062   000002 442100                    SXL2    2,,PR0

      905     2321    3              IF KI$FEI.TCNT >0

   2321  0 000063   000067 604400 0                  TMOZ    NO_COUNT

      906     2322    3              THEN
      907     2323    3                 CALL TIMO ALTRET (NO_COUNT);

   2323  0 000064   000252 701000 0                  TSX1    TIMO
         0 000065   000067 702000 0                  TSX2    NO_COUNT
         0 000066   000167 710000 0                  TRA     NXTFE

      908     2324    3              ELSE
      909     2325    3   NO_COUNT:     KI$FEI.TCNT =KI$FEI.TCNT +1;

PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:160  
   2325  0 000067   200061 470500       NO_COUNT     LDP0    FEI$,,AUTO
         0 000070   000002 720100                    LXL0    2,,PR0
         0 000071   000001 621010                    EAX1    1,X0
         0 000072   000002 441100                    SXL1    2,,PR0
         0 000073   000167 710000 0                  TRA     NXTFE

      910     2326
      911     2327
      912     2328    3            CASE(KIST_DMP,KIST_TOK,KIST_BT);

      913     2329    3              KI$FEI.TCNT =KI$FEI.TCNT -1;

   2329  0 000074   000002 721100                    LXL1    2,,PR0
         0 000075   777777 622011                    EAX2    -1,X1
         0 000076   000002 442100                    SXL2    2,,PR0

      914     2330    3              IF KI$FEI.TCNT <=0

   2330  0 000077   000167 605400 0                  TPNZ    NXTFE

      915     2331    3              THEN
      916     2332    3                 CALL KIQ$FEABT (FEI,KIER_TO);

   2332  0 000100   000001 236000 1                  LDQ     1
         0 000101   200065 756100                    STQ     FEI$+4,,AUTO
         0 000102   200060 631500                    EPPR1   FEI,,AUTO
         0 000103   200064 451500                    STP1    FEI$+3,,AUTO
         0 000104   200064 630500                    EPPR0   FEI$+3,,AUTO
         0 000105   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000106   000000 701000 xent               TSX1    KIQ$FEABT
         0 000107   000000 011000                    NOP     0
         0 000110   000167 710000 0                  TRA     NXTFE

      917     2333
      918     2334
      919     2335    3            CASE(KIST_QFL);

PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:161  
      920     2336    3              KI$FEI.TCNT =KI$FEI.TCNT -1;

   2336  0 000111   000002 721100                    LXL1    2,,PR0
         0 000112   777777 622011                    EAX2    -1,X1
         0 000113   000002 442100                    SXL2    2,,PR0

      921     2337    3              IF KI$FEI.TCNT <=0 AND NOT KI$FEI.NOTIME

   2337  0 000114   000167 605400 0                  TPNZ    NXTFE
         0 000115   000007 236100                    LDQ     7,,PR0
         0 000116   200000 316003                    CANQ    65536,DU
         0 000117   000167 601000 0                  TNZ     NXTFE

      922     2338    3              THEN
      923     2339    3                 CALL KIQ$FEABT (FEI,KIER_QFL);

   2339  0 000120   000002 236000 1                  LDQ     2
         0 000121   200065 756100                    STQ     FEI$+4,,AUTO
         0 000122   200060 631500                    EPPR1   FEI,,AUTO
         0 000123   200064 451500                    STP1    FEI$+3,,AUTO
         0 000124   200064 630500                    EPPR0   FEI$+3,,AUTO
         0 000125   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000126   000000 701000 xent               TSX1    KIQ$FEABT
         0 000127   000000 011000                    NOP     0
         0 000130   000167 710000 0                  TRA     NXTFE

      924     2340
      925     2341
      926     2342    3            CASE(KIST_RUN);

      927     2343    3              KI$FEI.TCNT =KI$FEI.TCNT -1;

   2343  0 000131   000002 721100                    LXL1    2,,PR0
         0 000132   777777 622011                    EAX2    -1,X1
         0 000133   000002 442100                    SXL2    2,,PR0

      928     2344    3              IF NOT (KI$FEI.FROZEN ) AND NOT KI$FEI.NOTIME
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:162  

   2344  0 000134   000007 234100                    SZN     7,,PR0
         0 000135   000153 604000 0                  TMI     s:2349
         0 000136   000007 236100                    LDQ     7,,PR0
         0 000137   200000 316003                    CANQ    65536,DU
         0 000140   000153 601000 0                  TNZ     s:2349

      929     2345    3              THEN
      930     2346    3                 IF KI$FEI.TCNT <=0

   2346  0 000141   000000 102003                    CMPX2   0,DU
         0 000142   000153 605400 0                  TPNZ    s:2349

      931     2347    3                 THEN
      932     2348    3                    CALL KIQ$FEABT (FEI,KIER_TO);

   2348  0 000143   000001 236000 1                  LDQ     1
         0 000144   200065 756100                    STQ     FEI$+4,,AUTO
         0 000145   200060 631500                    EPPR1   FEI,,AUTO
         0 000146   200064 451500                    STP1    FEI$+3,,AUTO
         0 000147   200064 630500                    EPPR0   FEI$+3,,AUTO
         0 000150   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000151   000000 701000 xent               TSX1    KIQ$FEABT
         0 000152   000000 011000                    NOP     0

      933     2349    3              IF KI$FEI.OCQ$->KI$QHDR.FLG.FULL AND KI$FEI.TCNT <KITM_RUN-1

   2349  0 000153   200061 470500                    LDP0    FEI$,,AUTO
         0 000154   000003 471500                    LDP1    3,,PR0
         0 000155   100013 430100                    FSZN    11,,PR1
         0 000156   000165 605000 0                  TPL     s:2354
         0 000157   000002 720100                    LXL0    2,,PR0
         0 000160   000013 100003                    CMPX0   11,DU
         0 000161   000165 605000 0                  TPL     s:2354

      934     2350    3              THEN
      935     2351    3                 IF NOT KI$FEI.NOTIME
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:163  

   2351  0 000162   000007 236100                    LDQ     7,,PR0
         0 000163   200000 316003                    CANQ    65536,DU
         0 000164   000216 600000 0                  TZE     QFL

      936     2352    3                 THEN
      937     2353    3                    GOTO QFL;
      938     2354    3              CALL TIMO ALTRET (QFL);

   2354  0 000165   000252 701000 0                  TSX1    TIMO
         0 000166   000216 702000 0                  TSX2    QFL

      939     2355    3           END;

   2348  0 000167                       NXTFE        null
      940     2356    2   NXTFE:  ;
      941     2357    2        END;

   2357  0 000167   200060 235100                    LDA     FEI,,AUTO
         0 000170   000001 035007                    ADLA    1,DL
         0 000171   200060 755100                    STA     FEI,,AUTO
         0 000172   000000 236000 xsym               LDQ     KI_MXFE
         0 000173   200060 116100                    CMPQ    FEI,,AUTO
         0 000174   000011 603000 0                  TRC     s:2302

      942     2358    1        CALL SSC$MONTIMR (SEC5,ENTADDR(KIQ$TMLP),FEI);

   2358  0 000175   000000 636000 0                  EAQ     s:8
         0 000176   200064 756100                    STQ     FEI$+3,,AUTO
         0 000177   200060 630500                    EPPR0   FEI,,AUTO
         0 000200   200067 450500                    STP0    FEI$+6,,AUTO
         0 000201   200064 631500                    EPPR1   FEI$+3,,AUTO
         0 000202   200066 451500                    STP1    FEI$+5,,AUTO
         0 000203   000004 236000 1                  LDQ     4
         0 000204   200065 756100                    STQ     FEI$+4,,AUTO
         0 000205   200065 630500                    EPPR0   FEI$+4,,AUTO
         0 000206   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:164  
         0 000207   000000 701000 xent               TSX1    SSC$MONTIMR
         0 000210   000000 011000                    NOP     0

      943     2359             %UNLOCK (G=KI_LOCK);

   2360  0 000211   000000 630400 1                  EPPR0   0
         0 000212   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000213   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000214   000000 011000                    NOP     0

      944     2362    1        RETURN;

   2362  0 000215   000000 702200 xent               TSX2  ! X66_ARET

   2354  0 000216                       QFL          null
      945     2363
      946     2364    1   QFL: ;
      947     2365    1        IF KI$FEI.FEST ~=KIST_DN THEN

   2365  0 000216   200061 470500                    LDP0    FEI$,,AUTO
         0 000217   000002 236100                    LDQ     2,,PR0
         0 000220   000777 316003                    CANQ    511,DU
         0 000221   000226 600000 0                  TZE     s:2370

      948     2366    2          DO ;

      949     2367    2             KI$FEI.FEST =KIST_QFL;

   2367  0 000222   000003 236003                    LDQ     3,DU
         0 000223   000002 552120                    STBQ    2,'20'O,PR0

      950     2368    2             KI$FEI.TCNT =KITM_QFL;

   2368  0 000224   000006 220003                    LDX0    6,DU
         0 000225   000002 440100                    SXL0    2,,PR0

      951     2369    2          END;
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:165  

      952     2370    1        GOTO NXTFE;

   2370  0 000226   000167 710000 0                  TRA     NXTFE

      953     2371
      954     2372    1   KIQ$TMQNF: ENTRY(FEPX);

   2372  0 000227   000000 700200 xent  KIQ$TMQNF    TSX0  ! X66_AUTO_1
         0 000230   000070 000001                    ZERO    56,1

      955     2373
      956     2374    1        FEI=FEPX;

   2374  0 000231   200003 470500                    LDP0    @FEPX,,AUTO
         0 000232   000000 235100                    LDA     0,,PR0
         0 000233   200060 755100                    STA     FEI,,AUTO

      957     2375    1        FEI$ = KI$FEI$(FEI);

   2375  0 000234   000000 471400 xsym               LDP1    KI_FEI$$
         0 000235   100000 236105                    LDQ     0,AL,PR1
         0 000236   200061 756100                    STQ     FEI$,,AUTO

      958     2376    1        CALL TIMO ALTRET (RTN);

   2376  0 000237   000252 701000 0                  TSX1    TIMO
         0 000240   000251 702000 0                  TSX2    RTN

      959     2377    1        KI$FEI.FEST =KIST_RUN;

   2377  0 000241   200061 470500                    LDP0    FEI$,,AUTO
         0 000242   000002 236003                    LDQ     2,DU
         0 000243   000002 552120                    STBQ    2,'20'O,PR0

      960     2378    1        KI$FEI.TCNT = KI$FEI.TIMEOUT.RUN;

PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:166  
   2378  0 000244   000020 236100                    LDQ     16,,PR0
         0 000245   000011 772000                    QRL     9
         0 000246   000777 376007                    ANQ     511,DL
         0 000247   000000 620006                    EAX0    0,QL
         0 000250   000002 440100                    SXL0    2,,PR0

   2378  0 000251                       RTN          null
      961     2379    1   RTN: ;
      962     2380    1        RETURN;

   2380  0 000251   000000 702200 xent               TSX2  ! X66_ARET

      963     2381
      964     2382
      965     2383    1   TIMO: PROC ALTRET;

   2383  0 000252   200062 741300       TIMO         STX1  ! FEI$+1,,AUTO

      966     2384
      967     2385    2        KI$MHDRT.BLNK=' ';

   2385  0 000253   000040 236003                    LDQ     32,DU
         0 000254   200005 552120                    STBQ    KI$MHDRT+1,'20'O,AUTO

      968     2386    2        CALL UMT$IDT (KI$MHDRT.DATE,KI$MHDRT.TIME);

   2386  0 000255   200004 630500                    EPPR0   KI$MHDRT,,AUTO
         0 000256   200065 450500                    STP0    FEI$+4,,AUTO
         0 000257   200066 452500                    STP2    FEI$+5,,AUTO
         0 000260   200066 236100                    LDQ     FEI$+5,,AUTO
         0 000261   000005 036000 1                  ADLQ    5
         0 000262   200064 756100                    STQ     FEI$+3,,AUTO
         0 000263   200064 630500                    EPPR0   FEI$+3,,AUTO
         0 000264   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000265   000000 701000 xent               TSX1    UMT$IDT
         0 000266   000000 011000                    NOP     0

PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:167  
      969     2387    2        K$RWPARM = K_RWPARM_CON;

   2387  0 000267   000100 100400                    MLR     fill='000'O
         0 000270   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         0 000271   200010 000234                    ADSC9   K$RWPARM,,AUTO           cn=0,n=156

      970     2388    2        K$RWPARM.UHDRSZ = LENGTHC(KI$MHDRT);

   2388  0 000272   000016 235007                    LDA     14,DL
         0 000273   200025 755100                    STA     K$RWPARM+13,,AUTO

      971     2389    2        K$RWPARM.UHDR$ = ADDR(KI$MHDRT);

   2389  0 000274   200004 630500                    EPPR0   KI$MHDRT,,AUTO
         0 000275   200024 450500                    STP0    K$RWPARM+12,,AUTO

      972     2390
      973     2391    2        K$RWPARM.FUNCTION = %K_WRITE;

   2391  0 000276   000001 236007                    LDQ     1,DL
         0 000277   200030 756100                    STQ     K$RWPARM+16,,AUTO

      974     2392    2        K$RWPARM.FEX = FEI;

   2392  0 000300   200060 235100                    LDA     FEI,,AUTO
         0 000301   200031 755100                    STA     K$RWPARM+17,,AUTO

      975     2393    2        CALL KIQ$LINK (K$RWPARM,%KJ_FCN_TIM) ALTRET(ALTRT);

   2393  0 000302   000007 236000 1                  LDQ     7
         0 000303   200065 756100                    STQ     FEI$+4,,AUTO
         0 000304   200010 631500                    EPPR1   K$RWPARM,,AUTO
         0 000305   200064 451500                    STP1    FEI$+3,,AUTO
         0 000306   200064 630500                    EPPR0   FEI$+3,,AUTO
         0 000307   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000310   000000 701000 xent               TSX1    KIQ$LINK
         0 000311   000314 702000 0                  TSX2    ALTRT
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:168  

      976     2394    2        RETURN;

   2394  0 000312   200062 221300                    LDX1  ! FEI$+1,,AUTO
         0 000313   000001 702211                    TSX2  ! 1,X1

   2392  0 000314                       ALTRT        null
      977     2395
      978     2396    2   ALTRT: ;
      979     2397    2        ALTRETURN;

   2397  0 000314   200062 221300                    LDX1  ! FEI$+1,,AUTO
         0 000315   000000 702211                    TSX2  ! 0,X1

(unnamed)
 Sect OctLoc
   1     000   000000 006000   000003 006000   000004 006000   000000 000764    ................
   1     004   000003 006000   000005 400000   000000 000041   000006 006000    ...........!....
      980     2398    2   END TIMO;
      981     2399
      982     2400    1   END KIQ$TMLP;
      983     2401
      984     2402
      985     2403        %EOD;

PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:169  
--  Include file information  --

   KJ_FCNS_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   KI$MHDR.:E05TOU  is referenced.
      No diagnostics issued in procedure KIQ$TMLP.
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:170  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FEPX                     60-0-0/w UBIN        r     1 FEI
    61-0-0/w PTR         r     1 FEI$                      *0-0-0/w UBIN        r     1 FEPX
    10-0-0/d STRC(1404)  r     1 K$RWPARM                   4-0-0/c STRC(126)   r     1 KI$MHDRT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KI_FEI$$                   0-0-0/b BIT (72)    r     1 KI_LOCK
     0-0-0/w UBIN        r     1 KI_MXFE                    0-0-0/d STRC(1404)  r     1 K_RWPARM_CON

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/d STRC(576)   r     1 KI$QHDR


   Procedure KIQ$TMLP requires 206 words for executable code.
   Procedure KIQ$TMLP requires 56 words of local(AUTO) storage.
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:171  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:172  
          MINI XREF LISTING

ALTRT IN PROCEDURE TIMO
      2392**LABEL    2393--CALLALT
FEI
      1885**DCL      2300<<DOINDEX  2302>>ASSIGN   2312<>CALL     2332<>CALL     2339<>CALL     2348<>CALL
      2358<>CALL     2374<<ASSIGN   2375>>ASSIGN   2392>>ASSIGN
FEI$
      1886**DCL      1906--IMP-PTR  2302<<ASSIGN   2303>>CALL     2305>>DOCASE   2309>>IF       2310>>ASSIGN
      2310>>ASSIGN   2311>>IF       2320>>ASSIGN   2320>>ASSIGN   2321>>IF       2325>>ASSIGN   2325>>ASSIGN
      2329>>ASSIGN   2329>>ASSIGN   2330>>IF       2336>>ASSIGN   2336>>ASSIGN   2337>>IF       2337>>IF
      2343>>ASSIGN   2343>>ASSIGN   2344>>IF       2344>>IF       2346>>IF       2349>>IF       2349>>IF
      2351>>IF       2365>>IF       2367>>ASSIGN   2368>>ASSIGN   2375<<ASSIGN   2377>>ASSIGN   2378>>ASSIGN
      2378>>ASSIGN
FEPX
      1884**DCL         8--PROC     2372--ENTRY    2374>>ASSIGN
HFC$LOCK
      1531**DCL-ENT  2297--CALL
HFC$UNLOCK
      1531**DCL-ENT  2360--CALL
K$RWPARM
      1587**DCL      2387<<ASSIGN   2393<>CALL
K$RWPARM.BLKREC
      1613**DCL      1638--REDEF
K$RWPARM.BLKREC.BLKU#
      1614**DCL      1616--REDEF
K$RWPARM.BLKREC.RECU#
      1626**DCL      1628--REDEF
K$RWPARM.DVE.DVBYTE.VFC
      1653**DCL      1654--REDEF
K$RWPARM.DVE.EOMCHAR
      1661**DCL      1665--REDEF
K$RWPARM.ERR
      1725**DCL      1730--REDEF
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:173  
K$RWPARM.FC
      1689**DCL      1690--REDEF
K$RWPARM.FEX
      1771**DCL      2392<<ASSIGN
K$RWPARM.FLDID
      1871**DCL      1872--REDEF
K$RWPARM.FPT$
      1752**DCL      1759--REDEF
K$RWPARM.FUNCTION
      1766**DCL      2391<<ASSIGN
K$RWPARM.KEYTYPE
      1878**DCL      1879--REDEF
K$RWPARM.MSG$
      1588**DCL      1594--REDEF
K$RWPARM.MSGID
      1700**DCL      1705--REDEF
K$RWPARM.MSGIDXT
      1713**DCL      1717--REDEF
K$RWPARM.ORG
      1849**DCL      1850--REDEF
K$RWPARM.THDRSZ
      1793**DCL      1797--REDEF
K$RWPARM.UHDR$
      1738**DCL      2389<<ASSIGN
K$RWPARM.UHDRSZ
      1743**DCL      2388<<ASSIGN
K$RWPARM.VDOFLGS
      1851**DCL      1862--REDEF
KI$FEI.BD$
      1941**DCL      1942--REDEF
KI$FEI.BDAD.WADDR
      1943**DCL      1944--REDEF
KI$FEI.FEST
      1911**DCL      2305>>DOCASE   2365>>IF       2367<<ASSIGN   2377<<ASSIGN
KI$FEI.FROZEN
      1936**DCL      2344>>IF
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:174  
KI$FEI.NOTIME
      1937**DCL      2337>>IF       2344>>IF       2351>>IF
KI$FEI.OCQ$
      1922**DCL      2349>>IF
KI$FEI.PBST.PROB
      1959**DCL      2309>>IF
KI$FEI.PTPPNO#
      1956**DCL      2303<>CALL
KI$FEI.RCVPB
      1957**DCL      1958--REDEF
KI$FEI.TCNT
      1918**DCL      2310<<ASSIGN   2310>>ASSIGN   2311>>IF       2320<<ASSIGN   2320>>ASSIGN   2321>>IF
      2325<<ASSIGN   2325>>ASSIGN   2329<<ASSIGN   2329>>ASSIGN   2330>>IF       2336<<ASSIGN   2336>>ASSIGN
      2337>>IF       2343<<ASSIGN   2343>>ASSIGN   2346>>IF       2349>>IF       2368<<ASSIGN   2378<<ASSIGN
KI$FEI.TIMEOUT.RUN
      1974**DCL      2378>>ASSIGN
KI$FEI$
       316**DCL      2302>>ASSIGN   2375>>ASSIGN
KI$MHDRT
      1561**DCL      2388--ASSIGN   2389--ASSIGN
KI$MHDRT.BLNK
      1563**DCL      2385<<ASSIGN
KI$MHDRT.DATE
      1564**DCL      2386<>CALL
KI$MHDRT.TIME
      1562**DCL      2386<>CALL
KI$QHDR.FLG.FULL
       212**DCL      2349>>IF
KIQ$FEABT
      1889**DCL-ENT  2312--CALL     2332--CALL     2339--CALL     2348--CALL
KIQ$LINK
      1883**DCL-ENT  2393--CALL
KIQ$TMLP
         8**PROC     2358--CALL
KI_FEI$$
       315**DCL       316--IMP-PTR  2302>>ASSIGN   2375>>ASSIGN
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:175  
KI_LOCK
       328**DCL      2297<>CALL     2360<>CALL
KI_MXFE
       324**DCL      2300>>DOINDEX
K_RWPARM_CON
      1999**DCL      2387>>ASSIGN
K_RWPARM_CON.BLKREC
      2025**DCL      2050--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      2026**DCL      2028--REDEF
K_RWPARM_CON.BLKREC.RECU#
      2038**DCL      2040--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      2065**DCL      2066--REDEF
K_RWPARM_CON.DVE.EOMCHAR
      2073**DCL      2077--REDEF
K_RWPARM_CON.ERR
      2137**DCL      2142--REDEF
K_RWPARM_CON.FC
      2101**DCL      2102--REDEF
K_RWPARM_CON.FLDID
      2283**DCL      2284--REDEF
K_RWPARM_CON.FPT$
      2164**DCL      2171--REDEF
K_RWPARM_CON.KEYTYPE
      2290**DCL      2291--REDEF
K_RWPARM_CON.MSG$
      2000**DCL      2006--REDEF
K_RWPARM_CON.MSGID
      2112**DCL      2117--REDEF
K_RWPARM_CON.MSGIDXT
      2125**DCL      2129--REDEF
K_RWPARM_CON.ORG
      2261**DCL      2262--REDEF
K_RWPARM_CON.THDRSZ
      2205**DCL      2209--REDEF
PL6.E3A0      #004=KIQ$TMLP File=KIQ$QMGR.:E05TSI                                WED 07/30/97 00:39 Page:176  
K_RWPARM_CON.VDOFLGS
      2263**DCL      2274--REDEF
MMS$WSQMAP
      1891**DCL-ENT  2303--CALL
NO_COUNT
      2325**LABEL    2323--CALLALT
NXTFE
      2348**LABEL    2370--GOTO
QFL
      2354**LABEL    2353--GOTO     2354--CALLALT
RTN
      2378**LABEL    2376--CALLALT
SSC$MONTIMR
      1887**DCL-ENT  2358--CALL
TIMO
      2383**PROC     2323--CALL     2354--CALL     2376--CALL
UMT$IDT
      1888**DCL-ENT  2386--CALL

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:177  
      986        1        /*T***********************************************************/
      987        2        /*T*                                                         */
      988        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      989        4        /*T*                                                         */
      990        5        /*T***********************************************************/
      991        6
      992        7
      993        8        /*M* KIQ$FEINIT Frontend recovery and reboot routines (historically misnamed) */
      994        9
      995       10
      996       11        KIQ$FEBOOT: PROC(FEI,MLCPDUMP);
      997       12
      998       13        /*K* NAME: KIQ$FEBOOT
      999       14             PURPOSE:
     1000       15                  To perform a boot on a given FEP.
     1001       16             DESCRIPTION:
     1002       17                  KIQ$FEBOOT will perform an boot order on a coupler, initialize
     1003       18                  the circular queues, and send an RUOK message to a given fep.
     1004       19        */
     1005       20
     1006       21        %INCLUDE HF_LOCK_C;
     1007       35        %INCLUDE KI$QHDR;
     1008      187        %INCLUDE KI_DATA_R;
     1009      213        %INCLUDE KI_MACROS_C;
     1010      821        %INCLUDE SS_SCHED_C;
     1011     1054        %INCLUDE S_WSPTD_R;
     1012     1070        %INCLUDE KI_SUBS_C;
     1013     1206        %INCLUDE NK_SUBS;
     1014     1231        %INCLUDE K$RWPARM;
     1015     1617        %INCLUDE K_SUBS_C;
     1016     1650        %INCLUDE KJ_FCNS_C;
     1017     1677        %INCLUDE JG_GHOSTS_C;
     1018     1767        %INCLUDE FP_MACRO_C;
     1019     2039        %INCLUDE NI_DATA_R;
     1020     2476        %INCLUDE NK$LDCT;
     1021     2578
     1022     2579        %KI$CCMD;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:178  
     1023     2594        %KI$CTCW;
     1024     2602        %KI$FEI (STCLASS="BASED(FEI$)");
     1025     2686        %KI_CCMD(NAME=BOOT6,CMD=KIOP_BOOTL6);
     1026     2714        %KI_CTCW(NAME=BOOT4K,L6AD=0,TB=B,CNT=0);
     1027     2723        %KI_CCMD(NAME=INTL6,STCLASS=CONSTANT,CMD=KIOP_INTL6,L66I=%KJ_IPARM_INIT);
     1028     2751        %FP$OPCI (STCLASS=BASED);
     1029     2761        %NK$LDCT;
     1030     2807
     1031     2808    1   DCL FEI UBIN WORD;
     1032     2809    1   DCL FEI$ PTR;
     1033     2810    1   DCL FP_OPCI$$ PTR SYMREF;
     1034     2811    1   DCL F$ PTR;
     1035     2812    1   DCL LDCTX UBIN HALF;
     1036     2813    1   DCL FEILCL UBIN WORD;
     1037     2814    1   DCL S_CUN UBIN WORD SYMREF;
     1038     2815        %K$RWPARM (NAME=K$RWPARM);
     1039     3131    1   DCL MLCPDUMP BIT(1) UNAL;
     1040     3132    1   DCL OCQ$ PTR;
     1041     3133    1   DCL KIQ$LINK ENTRY(2) ALTRET;
     1042     3134    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
     1043     3135    1   DCL NIS$DCCON ENTRY(3);
     1044     3136    1   DCL SSS$SYSTIME ENTRY(1);
     1045     3137    1   DCL SSR$REG ENTRY(3) ALTRET;
     1046     3138    1   DCL UBNBSD UBIN BASED;
     1047     3139
     1048     3140        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
     1049     3456    1   DCL K_NODE# UBIN SYMREF;
     1050     3457        %EJECT;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:179  
     1051     3458    1        FEILCL = FEI ;
     1052     3459    1        FEI$ = KI$FEI$(FEILCL);
     1053     3460
     1054     3461             %LOCK (G=KI$FEI.LOCK);
     1055     3464    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);
     1056     3465    1        CALL KIQ$QINIT(FEILCL);
     1057     3466        /* Mask the local FEP so it cannot write into the circular queue
     1058     3467             while it is being initialized
     1059     3468         */
     1060     3469    1        CALL NIS$DCCON (KI$FEI.FECH ,'4'O,KI$FEI.FEWSQ);
     1061     3470
     1062     3471    1        KI$FEI.PBST.PROB  = KIER_OK;
     1063     3472    1        KI$FEI.PBST.STATE  = KIST_MASKED ;
     1064     3473    1        KI$FEI.BD$ ->KI$CTCW = BOOT4K;
     1065     3474    1        OCQ$ = KI$FEI.OCQ$;
     1066     3475    1        OCQ$->KI$QHDR.BDCTL='0'B;
     1067     3476    1        OCQ$->KI$QHDR.BDCTL.MDBFK=(ADDR(KI$FEI.BDSZ )->UBNBSD+1023)/1024;
     1068     3477    1        OCQ$->KI$QHDR.BDCTL.BTPG#=KI$FEI.BDAD.PGA.PAGE ;
     1069     3478    1        OCQ$->KI$QHDR.BDCTL.MLCPDUMP=MLCPDUMP;
     1070     3479    1        OCQ$->KI$QHDR.CCMD=BOOT6;
     1071     3480    1        ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.ADB18=KI$FEI.BDAD.WADDR ;
     1072     3481    1        KI$FEI.TCNT = KI$FEI.TIMEOUT.BOOT;
     1073     3482    1        KI$FEI.FEST  = KIST_BT;
     1074     3483    1        CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);
     1075     3484
     1076     3485             %UNLOCK (G=KI$FEI.LOCK);
     1077     3488
     1078     3489    1        IF S_CUN ~= JG_FROG#               /* FROG */
     1079     3490    1        THEN CALL SSR$REG(%SS_QA);
     1080     3491    1        RETURN;
     1081     3492        %EJECT;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:180  
     1082     3493    1   KIQ$FESTRT: ENTRY(FEI);
     1083     3494    1        FEILCL = FEI ;
     1084     3495
     1085     3496        /*F*
     1086     3497             NAME: KIQ$FESTART
     1087     3498             PURPOSE:
     1088     3499                  To start a given fep.
     1089     3500             DESCRIPTION:
     1090     3501                  KIQ$FESTRT will initialize the circular queues, unmask the
     1091     3502                  copuler, and then send an RUOK to the fep.
     1092     3503        */
     1093     3504
     1094     3505    1        FEI$ = KI$FEI$ (FEILCL);
     1095     3506             %LOCK (G=KI$FEI.LOCK);
     1096     3509    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);
     1097     3510    1        CALL KIQ$QINIT(FEILCL);
     1098     3511    1        KI$FEI.PBST.PROB  = KIER_OK;
     1099     3512    1        KI$FEI.PBST.STATE  = KIST_DN;
     1100     3513    1        KI$FEI.OCQ$->KI$QHDR.CCMD=INTL6;
     1101     3514    1        KI$FEI.FEST  = KIST_TOK;
     1102     3515    1        KI$FEI.TCNT = KITM_TOK;
     1103     3516    1        K$RWPARM = K_RWPARM_CON;
     1104     3517    1        K$RWPARM.FUNCTION = %K_WRITE;
     1105     3518    1        K$RWPARM.FEX = FEI;
     1106     3519
     1107     3520    1        F$ = FP_OPCI$$;
     1108     3521    2        DO WHILE (F$ ~= ADDR(NIL));
     1109     3522    3           IF (F$->FP$OPCI.FEI# = FEILCL) THEN DO;
     1110     3523                   /* If this is an OSAR, send its admin LDCT index in the
     1111     3524                   RUOK message and set its LDCT state to not down     */
     1112     3525    3                N$DCT$(F$->FP$OPCI.LDCTX)->NK$LDCT.DFLG.FEDN = '0'B;
     1113     3526    3                LDCTX = (F$->FP$OPCI.LDCTX/256) * 512 +
     1114     3527    3                  MOD (F$->FP$OPCI.LDCTX,256);
     1115     3528    3                K$RWPARM.MSG$ = ADDR (LDCTX);
     1116     3529    3                K$RWPARM.MSGSZ = SIZEC (LDCTX);
     1117     3530    3                EXIT;
     1118     3531    3             END;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:181  
     1119     3532    2           F$ = F$->FP$OPCI.LNK$;
     1120     3533    2        END;
     1121     3534    1        CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);
     1122     3535             %UNLOCK (G=KI$FEI.LOCK);
     1123     3538    1        CALL KIQ$LINK(K$RWPARM,%KJ_FCN_RUOK);
     1124     3539    1        RETURN;
     1125     3540        %EJECT;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:182  
     1126     3541    1   KIQ$QINIT: ENTRY (FEI);
     1127     3542    1        FEILCL = FEI ;
     1128     3543    1        FEI$ = KI$FEI$(FEILCL);
     1129     3544
     1130     3545        /*F*
     1131     3546             NAME: KIQ$INIT
     1132     3547             PURPOSE:
     1133     3548                  To initialize the circular queues for a given FEP.
     1134     3549             DESCRIPTION:
     1135     3550                  KIQ$QINIT is called to initialize the queues for a given fep.
     1136     3551        */
     1137     3552
     1138     3553    1        KI$FEI.FROZEN  = '0'B;
     1139     3554    1        KI$FEI.MSI  = 0;
     1140     3555    1        CALL SSS$SYSTIME (KI$FEI.IUTS );
     1141     3556    1        OCQ$=KI$FEI.ICQ$;
     1142     3557    1        CALL CLRQ;
     1143     3558    1        OCQ$=KI$FEI.OCQ$;
     1144     3559    1        CALL CLRQ;
     1145     3560    1        RETURN;
     1146     3561
     1147     3562    1   CLRQ: PROC;
     1148     3563    2        OCQ$->KI$QHDR.GATE='1'B;
     1149     3564    2        OCQ$->KI$QHDR.INTLOCK=0;
     1150     3565    2        OCQ$->KI$QHDR.MYIPTR=0;
     1151     3566    2        OCQ$->KI$QHDR.RPTR=0;
     1152     3567    2        OCQ$->KI$QHDR.IPTR=0;
     1153     3568    2        OCQ$->KI$QHDR.FLG='0'B;
     1154     3569    2        OCQ$->KI$QHDR.HOST_NODE# = K_NODE#;
     1155     3570    2        OCQ$->KI$QHDR.LAST_PTR = 0;
     1156     3571    2        RETURN;
     1157     3572    2   END CLRQ;
     1158     3573
     1159     3574    1   END KIQ$FEBOOT;
     1160     3575        %EOD;

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:183  
--  Include file information  --

   NK$LDCT.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FP_MACRO_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$FEBOOT.

   Procedure KIQ$FEBOOT requires 250 words for executable code.
   Procedure KIQ$FEBOOT requires 58 words of local(AUTO) storage.

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:184  

 Object Unit name= KIQ$FEBOOT                                 File name= KIQ$QMGR.:E05TOU
 UTS= JUL 30 '97 00:39:49.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      3      3  KIQ$FEBOOT
    1   Proc  even  none   250    372  KIQ$FEBOOT
    2  RoData even  none     7      7  KIQ$FEBOOT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  KIQ$FEBOOT
     1    143                  yes      Std        1  KIQ$FESTRT
     1    310                  yes      Std        1  KIQ$QINIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 MMS$WSQMAP
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       3 SSR$REG
 yes     yes           Std       2 KIQ$LINK
         yes           Std       1 SSS$SYSTIME
         yes           Std       3 NIS$DCCON
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:185  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KI_FEI$$                              N$DCT$$                               N$FQ$
     NI$FQ$                                NI$IBUF$                              NI$RP$
     FP_OPCI$$                             S_CUN                                 K_RWPARM_CON
     K_NODE#                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:186  


      986        1        /*T***********************************************************/
      987        2        /*T*                                                         */
      988        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      989        4        /*T*                                                         */
      990        5        /*T***********************************************************/
      991        6
      992        7
      993        8        /*M* KIQ$FEINIT Frontend recovery and reboot routines (historically misnamed) */
      994        9
      995       10
      996       11        KIQ$FEBOOT: PROC(FEI,MLCPDUMP);

     11  1 000000   000000 700200 xent  KIQ$FEBOOT   TSX0  ! X66_AUTO_2
         1 000001   000072 000002                    ZERO    58,2

      997       12
      998       13        /*K* NAME: KIQ$FEBOOT
      999       14             PURPOSE:
     1000       15                  To perform a boot on a given FEP.
     1001       16             DESCRIPTION:
     1002       17                  KIQ$FEBOOT will perform an boot order on a coupler, initialize
     1003       18                  the circular queues, and send an RUOK message to a given fep.
     1004       19        */
     1005       20
     1006       21        %INCLUDE HF_LOCK_C;
     1007       35        %INCLUDE KI$QHDR;
     1008      187        %INCLUDE KI_DATA_R;
     1009      213        %INCLUDE KI_MACROS_C;
     1010      821        %INCLUDE SS_SCHED_C;
     1011     1054        %INCLUDE S_WSPTD_R;
     1012     1070        %INCLUDE KI_SUBS_C;
     1013     1206        %INCLUDE NK_SUBS;
     1014     1231        %INCLUDE K$RWPARM;
     1015     1617        %INCLUDE K_SUBS_C;
     1016     1650        %INCLUDE KJ_FCNS_C;
     1017     1677        %INCLUDE JG_GHOSTS_C;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:187  
     1018     1767        %INCLUDE FP_MACRO_C;
     1019     2039        %INCLUDE NI_DATA_R;
     1020     2476        %INCLUDE NK$LDCT;
     1021     2578
     1022     2579        %KI$CCMD;
     1023     2594        %KI$CTCW;
     1024     2602        %KI$FEI (STCLASS="BASED(FEI$)");
     1025     2686        %KI_CCMD(NAME=BOOT6,CMD=KIOP_BOOTL6);
     1026     2714        %KI_CTCW(NAME=BOOT4K,L6AD=0,TB=B,CNT=0);
     1027     2723        %KI_CCMD(NAME=INTL6,STCLASS=CONSTANT,CMD=KIOP_INTL6,L66I=%KJ_IPARM_INIT);
     1028     2751        %FP$OPCI (STCLASS=BASED);
     1029     2761        %NK$LDCT;
     1030     2807
     1031     2808    1   DCL FEI UBIN WORD;
     1032     2809    1   DCL FEI$ PTR;
     1033     2810    1   DCL FP_OPCI$$ PTR SYMREF;
     1034     2811    1   DCL F$ PTR;
     1035     2812    1   DCL LDCTX UBIN HALF;
     1036     2813    1   DCL FEILCL UBIN WORD;
     1037     2814    1   DCL S_CUN UBIN WORD SYMREF;
     1038     2815        %K$RWPARM (NAME=K$RWPARM);
     1039     3131    1   DCL MLCPDUMP BIT(1) UNAL;
     1040     3132    1   DCL OCQ$ PTR;
     1041     3133    1   DCL KIQ$LINK ENTRY(2) ALTRET;
     1042     3134    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
     1043     3135    1   DCL NIS$DCCON ENTRY(3);
     1044     3136    1   DCL SSS$SYSTIME ENTRY(1);
     1045     3137    1   DCL SSR$REG ENTRY(3) ALTRET;
     1046     3138    1   DCL UBNBSD UBIN BASED;
     1047     3139
     1048     3140        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
     1049     3456    1   DCL K_NODE# UBIN SYMREF;
     1050     3457        %EJECT;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:188  
     1051     3458    1        FEILCL = FEI ;

   3458  1 000002   200003 470500                    LDP0    @FEI,,AUTO
         1 000003   000000 235100                    LDA     0,,PR0
         1 000004   200010 755100                    STA     FEILCL,,AUTO

     1052     3459    1        FEI$ = KI$FEI$(FEILCL);

   3459  1 000005   000000 471400 xsym               LDP1    KI_FEI$$
         1 000006   100000 236105                    LDQ     0,AL,PR1
         1 000007   200005 756100                    STQ     FEI$,,AUTO

     1053     3460
     1054     3461             %LOCK (G=KI$FEI.LOCK);

   3462  1 000010   200005 630500                    EPPR0   FEI$,,AUTO
         1 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000012   000000 701000 xent               TSX1    HFC$LOCK
         1 000013   000000 011000                    NOP     0

     1055     3464    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);

   3464  1 000014   200005 236100                    LDQ     FEI$,,AUTO
         1 000015   000014 036003                    ADLQ    12,DU
         1 000016   200066 756100                    STQ     OCQ$+4,,AUTO
         1 000017   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000021   000000 701000 xent               TSX1    MMS$WSQMAP
         1 000022   000000 011000                    NOP     0

     1056     3465    1        CALL KIQ$QINIT(FEILCL);

   3465  1 000023   200010 630500                    EPPR0   FEILCL,,AUTO
         1 000024   200066 450500                    STP0    OCQ$+4,,AUTO
         1 000025   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000026   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000027   000310 701000 1                  TSX1    s:3541
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:189  
         1 000030   000000 011000                    NOP     0

     1057     3466        /* Mask the local FEP so it cannot write into the circular queue
     1058     3467             while it is being initialized
     1059     3468         */
     1060     3469    1        CALL NIS$DCCON (KI$FEI.FECH ,'4'O,KI$FEI.FEWSQ);

   3469  1 000031   200005 236100                    LDQ     FEI$,,AUTO
         1 000032   000005 036003                    ADLQ    5,DU
         1 000033   200070 756100                    STQ     OCQ$+6,,AUTO
         1 000034   000000 236000 2                  LDQ     0
         1 000035   200067 756100                    STQ     OCQ$+5,,AUTO
         1 000036   200005 236100                    LDQ     FEI$,,AUTO
         1 000037   000002 036003                    ADLQ    2,DU
         1 000040   200066 756100                    STQ     OCQ$+4,,AUTO
         1 000041   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000042   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000043   000000 701000 xent               TSX1    NIS$DCCON
         1 000044   000000 011000                    NOP     0

     1061     3470
     1062     3471    1        KI$FEI.PBST.PROB  = KIER_OK;

   3471  1 000045   000000 220003                    LDX0    0,DU
         1 000046   200005 470500                    LDP0    FEI$,,AUTO
         1 000047   000015 740100                    STX0    13,,PR0

     1063     3472    1        KI$FEI.PBST.STATE  = KIST_MASKED ;

   3472  1 000050   000007 221003                    LDX1    7,DU
         1 000051   000015 441100                    SXL1    13,,PR0

     1064     3473    1        KI$FEI.BD$ ->KI$CTCW = BOOT4K;

   3473  1 000052   000010 471500                    LDP1    8,,PR0
         1 000053   000001 236000 0                  LDQ     BOOT4K
         1 000054   100000 756100                    STQ     0,,PR1
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:190  

     1065     3474    1        OCQ$ = KI$FEI.OCQ$;

   3474  1 000055   000003 236100                    LDQ     3,,PR0
         1 000056   200062 756100                    STQ     OCQ$,,AUTO

     1066     3475    1        OCQ$->KI$QHDR.BDCTL='0'B;

   3475  1 000057   200062 471500                    LDP1    OCQ$,,AUTO
         1 000060   100001 450100                    STZ     1,,PR1

     1067     3476    1        OCQ$->KI$QHDR.BDCTL.MDBFK=(ADDR(KI$FEI.BDSZ )->UBNBSD+1023)/1024;

   3476  1 000061   000011 236100                    LDQ     9,,PR0
         1 000062   001777 036007                    ADLQ    1023,DL
         1 000063   000012 772000                    QRL     10
         1 000064   000011 736000                    QLS     9
         1 000065   100001 676100                    ERQ     1,,PR1
         1 000066   377000 376007                    ANQ     130560,DL
         1 000067   100001 656100                    ERSQ    1,,PR1

     1068     3477    1        OCQ$->KI$QHDR.BDCTL.BTPG#=KI$FEI.BDAD.PGA.PAGE ;

   3477  1 000070   000010 236100                    LDQ     8,,PR0
         1 000071   000012 772000                    QRL     10
         1 000072   100001 676100                    ERQ     1,,PR1
         1 000073   000377 376003                    ANQ     255,DU
         1 000074   100001 656100                    ERSQ    1,,PR1

     1069     3478    1        OCQ$->KI$QHDR.BDCTL.MLCPDUMP=MLCPDUMP;

   3478  1 000075   200004 473500                    LDP3    @MLCPDUMP,,AUTO
         1 000076   003100 060500                    CSL     bolr='003'O
         1 000077   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
         1 000100   100001 010001                    BDSC    1,,PR1                   by=0,bit=1,n=1

     1070     3479    1        OCQ$->KI$QHDR.CCMD=BOOT6;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:191  

   3479  1 000101   000000 236000 0                  LDQ     BOOT6
         1 000102   100000 756100                    STQ     0,,PR1

     1071     3480    1        ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.ADB18=KI$FEI.BDAD.WADDR ;

   3480  1 000103   000010 222100                    LDX2    8,,PR0
         1 000104   100000 742100                    STX2    0,,PR1

     1072     3481    1        KI$FEI.TCNT = KI$FEI.TIMEOUT.BOOT;

   3481  1 000105   000020 236100                    LDQ     16,,PR0
         1 000106   000033 772000                    QRL     27
         1 000107   000000 623006                    EAX3    0,QL
         1 000110   000002 443100                    SXL3    2,,PR0

     1073     3482    1        KI$FEI.FEST  = KIST_BT;

   3482  1 000111   000006 236003                    LDQ     6,DU
         1 000112   000002 552120                    STBQ    2,'20'O,PR0

     1074     3483    1        CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);

   3483  1 000113   200005 236100                    LDQ     FEI$,,AUTO
         1 000114   000005 036003                    ADLQ    5,DU
         1 000115   200070 756100                    STQ     OCQ$+6,,AUTO
         1 000116   000001 236000 2                  LDQ     1
         1 000117   200067 756100                    STQ     OCQ$+5,,AUTO
         1 000120   200005 236100                    LDQ     FEI$,,AUTO
         1 000121   000002 036003                    ADLQ    2,DU
         1 000122   200066 756100                    STQ     OCQ$+4,,AUTO
         1 000123   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000124   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000125   000000 701000 xent               TSX1    NIS$DCCON
         1 000126   000000 011000                    NOP     0

     1075     3484
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:192  
     1076     3485             %UNLOCK (G=KI$FEI.LOCK);

   3486  1 000127   200005 630500                    EPPR0   FEI$,,AUTO
         1 000130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000131   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000132   000000 011000                    NOP     0

     1077     3488
     1078     3489    1        IF S_CUN ~= JG_FROG#               /* FROG */

   3489  1 000133   000000 235000 xsym               LDA     S_CUN
         1 000134   000010 115007                    CMPA    8,DL
         1 000135   000142 600000 1                  TZE     s:3491

     1079     3490    1        THEN CALL SSR$REG(%SS_QA);

   3490  1 000136   000003 630400 2                  EPPR0   3
         1 000137   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000140   000000 701000 xent               TSX1    SSR$REG
         1 000141   000000 011000                    NOP     0

     1080     3491    1        RETURN;

   3491  1 000142   000000 702200 xent               TSX2  ! X66_ARET

     1081     3492        %EJECT;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:193  
     1082     3493    1   KIQ$FESTRT: ENTRY(FEI);

   3493  1 000143   000000 700200 xent  KIQ$FESTRT   TSX0  ! X66_AUTO_2
         1 000144   000072 000002                    ZERO    58,2

     1083     3494    1        FEILCL = FEI ;

   3494  1 000145   200003 470500                    LDP0    @FEI,,AUTO
         1 000146   000000 235100                    LDA     0,,PR0
         1 000147   200010 755100                    STA     FEILCL,,AUTO

     1084     3495
     1085     3496        /*F*
     1086     3497             NAME: KIQ$FESTART
     1087     3498             PURPOSE:
     1088     3499                  To start a given fep.
     1089     3500             DESCRIPTION:
     1090     3501                  KIQ$FESTRT will initialize the circular queues, unmask the
     1091     3502                  copuler, and then send an RUOK to the fep.
     1092     3503        */
     1093     3504
     1094     3505    1        FEI$ = KI$FEI$ (FEILCL);

   3505  1 000150   000000 471400 xsym               LDP1    KI_FEI$$
         1 000151   100000 236105                    LDQ     0,AL,PR1
         1 000152   200005 756100                    STQ     FEI$,,AUTO

     1095     3506             %LOCK (G=KI$FEI.LOCK);

   3507  1 000153   200005 630500                    EPPR0   FEI$,,AUTO
         1 000154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000155   000000 701000 xent               TSX1    HFC$LOCK
         1 000156   000000 011000                    NOP     0

     1096     3509    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);

   3509  1 000157   200005 236100                    LDQ     FEI$,,AUTO
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:194  
         1 000160   000014 036003                    ADLQ    12,DU
         1 000161   200066 756100                    STQ     OCQ$+4,,AUTO
         1 000162   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000163   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000164   000000 701000 xent               TSX1    MMS$WSQMAP
         1 000165   000000 011000                    NOP     0

     1097     3510    1        CALL KIQ$QINIT(FEILCL);

   3510  1 000166   200010 630500                    EPPR0   FEILCL,,AUTO
         1 000167   200066 450500                    STP0    OCQ$+4,,AUTO
         1 000170   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000171   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000172   000310 701000 1                  TSX1    s:3541
         1 000173   000000 011000                    NOP     0

     1098     3511    1        KI$FEI.PBST.PROB  = KIER_OK;

   3511  1 000174   000000 220003                    LDX0    0,DU
         1 000175   200005 470500                    LDP0    FEI$,,AUTO
         1 000176   000015 740100                    STX0    13,,PR0

     1099     3512    1        KI$FEI.PBST.STATE  = KIST_DN;

   3512  1 000177   000015 440100                    SXL0    13,,PR0

     1100     3513    1        KI$FEI.OCQ$->KI$QHDR.CCMD=INTL6;

   3513  1 000200   000003 471500                    LDP1    3,,PR0
         1 000201   000002 236000 0                  LDQ     INTL6
         1 000202   100000 756100                    STQ     0,,PR1

     1101     3514    1        KI$FEI.FEST  = KIST_TOK;

   3514  1 000203   000001 236003                    LDQ     1,DU
         1 000204   000002 552120                    STBQ    2,'20'O,PR0

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:195  
     1102     3515    1        KI$FEI.TCNT = KITM_TOK;

   3515  1 000205   000003 221003                    LDX1    3,DU
         1 000206   000002 441100                    SXL1    2,,PR0

     1103     3516    1        K$RWPARM = K_RWPARM_CON;

   3516  1 000207   000100 100400                    MLR     fill='000'O
         1 000210   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000211   200012 000234                    ADSC9   K$RWPARM,,AUTO           cn=0,n=156

     1104     3517    1        K$RWPARM.FUNCTION = %K_WRITE;

   3517  1 000212   000001 235007                    LDA     1,DL
         1 000213   200032 755100                    STA     K$RWPARM+16,,AUTO

     1105     3518    1        K$RWPARM.FEX = FEI;

   3518  1 000214   200003 471500                    LDP1    @FEI,,AUTO
         1 000215   100000 235100                    LDA     0,,PR1
         1 000216   200033 755100                    STA     K$RWPARM+17,,AUTO

     1106     3519
     1107     3520    1        F$ = FP_OPCI$$;

   3520  1 000217   000000 236000 xsym               LDQ     FP_OPCI$$
         1 000220   200006 756100                    STQ     F$,,AUTO

     1108     3521    2        DO WHILE (F$ ~= ADDR(NIL));

   3521  1 000221   000255 710000 1                  TRA     s:3533

     1109     3522    3           IF (F$->FP$OPCI.FEI# = FEILCL) THEN DO;

   3522  1 000222   200006 470500                    LDP0    F$,,AUTO
         1 000223   000001 236100                    LDQ     1,,PR0
         1 000224   200010 116100                    CMPQ    FEILCL,,AUTO
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:196  
         1 000225   000253 601000 1                  TNZ     s:3532

     1110     3523                   /* If this is an OSAR, send its admin LDCT index in the
     1111     3524                   RUOK message and set its LDCT state to not down     */
     1112     3525    3                N$DCT$(F$->FP$OPCI.LDCTX)->NK$LDCT.DFLG.FEDN = '0'B;

   3525  1 000226   000002 720100                    LXL0    2,,PR0
         1 000227   000000 471400 xsym               LDP1    N$DCT$$
         1 000230   100000 473510                    LDP3    0,X0,PR1
         1 000231   000004 236000 2                  LDQ     4
         1 000232   300006 356100                    ANSQ    6,,PR3

     1113     3526    3                LDCTX = (F$->FP$OPCI.LDCTX/256) * 512 +

   3526  1 000233   000002 236100                    LDQ     2,,PR0
         1 000234   000010 772000                    QRL     8
         1 000235   200066 756100                    STQ     OCQ$+4,,AUTO
         1 000236   000002 236100                    LDQ     2,,PR0
         1 000237   000377 376007                    ANQ     255,DL
         1 000240   200067 756100                    STQ     OCQ$+5,,AUTO
         1 000241   200066 236100                    LDQ     OCQ$+4,,AUTO
         1 000242   000011 736000                    QLS     9
         1 000243   200067 036100                    ADLQ    OCQ$+5,,AUTO
         1 000244   000000 620006                    EAX0    0,QL
         1 000245   200007 740100                    STX0    LDCTX,,AUTO

     1114     3527    3                  MOD (F$->FP$OPCI.LDCTX,256);
     1115     3528    3                K$RWPARM.MSG$ = ADDR (LDCTX);

   3528  1 000246   200007 633500                    EPPR3   LDCTX,,AUTO
         1 000247   200012 453500                    STP3    K$RWPARM,,AUTO

     1116     3529    3                K$RWPARM.MSGSZ = SIZEC (LDCTX);

   3529  1 000250   000004 235007                    LDA     4,DL
         1 000251   200013 755100                    STA     K$RWPARM+1,,AUTO

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:197  
     1117     3530    3                EXIT;

   3530  1 000252   000253 710000 1                  TRA     s:3532

     1118     3531    3             END;
     1119     3532    2           F$ = F$->FP$OPCI.LNK$;

   3532  1 000253   000000 236100                    LDQ     0,,PR0
         1 000254   200006 756100                    STQ     F$,,AUTO

     1120     3533    2        END;

   3533  1 000255   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000256   000222 601000 1                  TNZ     s:3522

     1121     3534    1        CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);

   3534  1 000257   200005 236100                    LDQ     FEI$,,AUTO
         1 000260   000005 036003                    ADLQ    5,DU
         1 000261   200070 756100                    STQ     OCQ$+6,,AUTO
         1 000262   000001 236000 2                  LDQ     1
         1 000263   200067 756100                    STQ     OCQ$+5,,AUTO
         1 000264   200005 236100                    LDQ     FEI$,,AUTO
         1 000265   000002 036003                    ADLQ    2,DU
         1 000266   200066 756100                    STQ     OCQ$+4,,AUTO
         1 000267   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000270   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000271   000000 701000 xent               TSX1    NIS$DCCON
         1 000272   000000 011000                    NOP     0

     1122     3535             %UNLOCK (G=KI$FEI.LOCK);

   3536  1 000273   200005 630500                    EPPR0   FEI$,,AUTO
         1 000274   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000275   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000276   000000 011000                    NOP     0

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:198  
     1123     3538    1        CALL KIQ$LINK(K$RWPARM,%KJ_FCN_RUOK);

   3538  1 000277   000006 236000 2                  LDQ     6
         1 000300   200067 756100                    STQ     OCQ$+5,,AUTO
         1 000301   200012 630500                    EPPR0   K$RWPARM,,AUTO
         1 000302   200066 450500                    STP0    OCQ$+4,,AUTO
         1 000303   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000304   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000305   000000 701000 xent               TSX1    KIQ$LINK
         1 000306   000000 011000                    NOP     0

     1124     3539    1        RETURN;

   3539  1 000307   000000 702200 xent               TSX2  ! X66_ARET

     1125     3540        %EJECT;
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:199  
     1126     3541    1   KIQ$QINIT: ENTRY (FEI);

   3541  1 000310   000000 700200 xent  KIQ$QINIT    TSX0  ! X66_AUTO_2
         1 000311   000072 000002                    ZERO    58,2

     1127     3542    1        FEILCL = FEI ;

   3542  1 000312   200003 470500                    LDP0    @FEI,,AUTO
         1 000313   000000 235100                    LDA     0,,PR0
         1 000314   200010 755100                    STA     FEILCL,,AUTO

     1128     3543    1        FEI$ = KI$FEI$(FEILCL);

   3543  1 000315   000000 471400 xsym               LDP1    KI_FEI$$
         1 000316   100000 236105                    LDQ     0,AL,PR1
         1 000317   200005 756100                    STQ     FEI$,,AUTO

     1129     3544
     1130     3545        /*F*
     1131     3546             NAME: KIQ$INIT
     1132     3547             PURPOSE:
     1133     3548                  To initialize the circular queues for a given FEP.
     1134     3549             DESCRIPTION:
     1135     3550                  KIQ$QINIT is called to initialize the queues for a given fep.
     1136     3551        */
     1137     3552
     1138     3553    1        KI$FEI.FROZEN  = '0'B;

   3553  1 000320   200005 473500                    LDP3    FEI$,,AUTO
         1 000321   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 000322   300007 356100                    ANSQ    7,,PR3

     1139     3554    1        KI$FEI.MSI  = 0;

   3554  1 000323   000000 220003                    LDX0    0,DU
         1 000324   300007 440100                    SXL0    7,,PR3

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:200  
     1140     3555    1        CALL SSS$SYSTIME (KI$FEI.IUTS );

   3555  1 000325   200005 236100                    LDQ     FEI$,,AUTO
         1 000326   000006 036003                    ADLQ    6,DU
         1 000327   200066 756100                    STQ     OCQ$+4,,AUTO
         1 000330   200066 630500                    EPPR0   OCQ$+4,,AUTO
         1 000331   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000332   000000 701000 xent               TSX1    SSS$SYSTIME
         1 000333   000000 011000                    NOP     0

     1141     3556    1        OCQ$=KI$FEI.ICQ$;

   3556  1 000334   200005 470500                    LDP0    FEI$,,AUTO
         1 000335   000004 236100                    LDQ     4,,PR0
         1 000336   200062 756100                    STQ     OCQ$,,AUTO

     1142     3557    1        CALL CLRQ;

   3557  1 000337   000347 701000 1                  TSX1    CLRQ
         1 000340   000000 011000                    NOP     0

     1143     3558    1        OCQ$=KI$FEI.OCQ$;

   3558  1 000341   200005 470500                    LDP0    FEI$,,AUTO
         1 000342   000003 236100                    LDQ     3,,PR0
         1 000343   200062 756100                    STQ     OCQ$,,AUTO

     1144     3559    1        CALL CLRQ;

   3559  1 000344   000347 701000 1                  TSX1    CLRQ
         1 000345   000000 011000                    NOP     0

     1145     3560    1        RETURN;

   3560  1 000346   000000 702200 xent               TSX2  ! X66_ARET

     1146     3561
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:201  
     1147     3562    1   CLRQ: PROC;

   3562  1 000347   200064 741300       CLRQ         STX1  ! OCQ$+2,,AUTO

     1148     3563    2        OCQ$->KI$QHDR.GATE='1'B;

   3563  1 000350   400000 235003                    LDA     -131072,DU
         1 000351   000000 236003                    LDQ     0,DU
         1 000352   200062 470500                    LDP0    OCQ$,,AUTO
         1 000353   000006 757100                    STAQ    6,,PR0

     1149     3564    2        OCQ$->KI$QHDR.INTLOCK=0;

   3564  1 000354   000004 450100                    STZ     4,,PR0

     1150     3565    2        OCQ$->KI$QHDR.MYIPTR=0;

   3565  1 000355   000010 450100                    STZ     8,,PR0

     1151     3566    2        OCQ$->KI$QHDR.RPTR=0;

   3566  1 000356   000017 236007                    LDQ     15,DL
         1 000357   000011 356100                    ANSQ    9,,PR0

     1152     3567    2        OCQ$->KI$QHDR.IPTR=0;

   3567  1 000360   000012 356100                    ANSQ    10,,PR0

     1153     3568    2        OCQ$->KI$QHDR.FLG='0'B;

   3568  1 000361   000000 236003                    LDQ     0,DU
         1 000362   000013 752160                    STCQ    11,'60'O,PR0

     1154     3569    2        OCQ$->KI$QHDR.HOST_NODE# = K_NODE#;

   3569  1 000363   000000 236000 xsym               LDQ     K_NODE#
         1 000364   000033 736000                    QLS     27
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:202  
         1 000365   000003 552140                    STBQ    3,'40'O,PR0

     1155     3570    2        OCQ$->KI$QHDR.LAST_PTR = 0;

   3570  1 000366   000017 236007                    LDQ     15,DL
         1 000367   000015 356100                    ANSQ    13,,PR0

     1156     3571    2        RETURN;

   3571  1 000370   200064 221300                    LDX1  ! OCQ$+2,,AUTO
         1 000371   000001 702211                    TSX2  ! 1,X1

BOOT6
 Sect OctLoc
   0     000   000000 000072                                                    ...:

BOOT4K
 Sect OctLoc
   0     001   100000 000000                                                    @...

INTL6
 Sect OctLoc
   0     002   000000 000271                                                    ....

(unnamed)
 Sect OctLoc
   2     000   000030 006000   000002 006000   000000 000033   000002 006000    ................
   2     004   777777 777757   000000 000042   000005 006000                    ......."....
     1157     3572    2   END CLRQ;
     1158     3573
     1159     3574    1   END KIQ$FEBOOT;
     1160     3575        %EOD;

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:203  
--  Include file information  --

   NK$LDCT.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   N$REQ.:E05TOU  is referenced.
   NI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FP_MACRO_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$FEBOOT.
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:204  

 **** Variables and constants ****

  ****  Section 000 RoData KIQ$FEBOOT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/w STRC        r     1 BOOT4K                     0-0-0/w STRC        r     1 BOOT6
     2-0-0/w STRC        r     1 INTL6

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FEI                       4-0-0/w PTR         r     1 @MLCPDUMP
     6-0-0/w PTR         r     1 F$                        *0-0-0/w UBIN        r     1 FEI
     5-0-0/w PTR         r     1 FEI$                      10-0-0/w UBIN        r     1 FEILCL
    12-0-0/d STRC(1404)  r     1 K$RWPARM                   7-0-0/w UBIN(18)    r     1 LDCTX
    *0-0-0/b BIT         r     1 MLCPDUMP                  62-0-0/w PTR         r     1 OCQ$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 FP_OPCI$$                  0-0-0/w PTR         r     1 KI_FEI$$
     0-0-0/w UBIN        r     1 K_NODE#                    0-0-0/d STRC(1404)  r     1 K_RWPARM_CON
     0-0-0/w PTR         r     1 N$DCT$$                    0-0-0/w PTR         r     1 N$FQ$
     0-0-0/w PTR         r     1 NI$FQ$                     0-0-0/w PTR         r     1 NI$IBUF$
     0-0-0/w PTR         r     1 NI$RP$                     0-0-0/w UBIN        r     1 S_CUN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:205  
     0-0-0/w STRC(108)   r     1 FP$OPCI                    0-0-0/w STRC        r     1 KI$CCMD
     0-0-0/w STRC        r     1 KI$CTCW                    0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/d STRC(576)   r     1 KI$QHDR                    0-0-0/w PTR         r     1 N$DCT$(0:0)
     0-0-0/d STRC(864)   r     1 NK$LDCT                    0-0-0/w UBIN        r     1 UBNBSD


   Procedure KIQ$FEBOOT requires 250 words for executable code.
   Procedure KIQ$FEBOOT requires 58 words of local(AUTO) storage.
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:206  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:207  
          MINI XREF LISTING

BOOT4K
      2715**DCL      3473>>ASSIGN
BOOT6
      2695**DCL      3479>>ASSIGN
BOOT6.L66INT
      2703**DCL      2704--REDEF    2708--REDEF
BOOT6.L6INT
      2701**DCL      2702--REDEF
CLRQ
      3562**PROC     3557--CALL     3559--CALL
F$
      2811**DCL      3520<<ASSIGN   3521>>DOWHILE  3522>>IF       3525>>ASSIGN   3526>>ASSIGN   3526>>ASSIGN
      3532<<ASSIGN   3532>>ASSIGN
FEI
      2808**DCL        11--PROC     3458>>ASSIGN   3493--ENTRY    3494>>ASSIGN   3518>>ASSIGN   3541--ENTRY
      3542>>ASSIGN
FEI$
      2809**DCL      2615--IMP-PTR  3459<<ASSIGN   3462>>CALL     3464>>CALL     3469>>CALL     3469>>CALL
      3471>>ASSIGN   3472>>ASSIGN   3473>>ASSIGN   3474>>ASSIGN   3476>>ASSIGN   3477>>ASSIGN   3480>>ASSIGN
      3481>>ASSIGN   3481>>ASSIGN   3482>>ASSIGN   3483>>CALL     3483>>CALL     3486>>CALL     3505<<ASSIGN
      3507>>CALL     3509>>CALL     3511>>ASSIGN   3512>>ASSIGN   3513>>ASSIGN   3514>>ASSIGN   3515>>ASSIGN
      3534>>CALL     3534>>CALL     3536>>CALL     3543<<ASSIGN   3553>>ASSIGN   3554>>ASSIGN   3555>>CALL
      3556>>ASSIGN   3558>>ASSIGN
FEILCL
      2813**DCL      3458<<ASSIGN   3459>>ASSIGN   3465<>CALL     3494<<ASSIGN   3505>>ASSIGN   3510<>CALL
      3522>>IF       3542<<ASSIGN   3543>>ASSIGN
FP$OPCI.FEI#
      2758**DCL      3522>>IF
FP$OPCI.LDCTX
      2759**DCL      3525>>ASSIGN   3526>>ASSIGN   3526>>ASSIGN
FP$OPCI.LNK$
      2757**DCL      3532>>ASSIGN
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:208  
FP_OPCI$$
      2810**DCL      3520>>ASSIGN
HFC$LOCK
        34**DCL-ENT  3462--CALL     3507--CALL
HFC$UNLOCK
        34**DCL-ENT  3486--CALL     3536--CALL
INTL6
      2732**DCL      3513>>ASSIGN
INTL6.L66INT
      2740**DCL      2741--REDEF    2745--REDEF
INTL6.L6INT
      2738**DCL      2739--REDEF
K$RWPARM
      2836**DCL      3516<<ASSIGN   3538<>CALL
K$RWPARM.BLKREC
      2862**DCL      2887--REDEF
K$RWPARM.BLKREC.BLKU#
      2863**DCL      2865--REDEF
K$RWPARM.BLKREC.RECU#
      2875**DCL      2877--REDEF
K$RWPARM.DVE.DVBYTE.VFC
      2902**DCL      2903--REDEF
K$RWPARM.DVE.EOMCHAR
      2910**DCL      2914--REDEF
K$RWPARM.ERR
      2974**DCL      2979--REDEF
K$RWPARM.FC
      2938**DCL      2939--REDEF
K$RWPARM.FEX
      3020**DCL      3518<<ASSIGN
K$RWPARM.FLDID
      3120**DCL      3121--REDEF
K$RWPARM.FPT$
      3001**DCL      3008--REDEF
K$RWPARM.FUNCTION
      3015**DCL      3517<<ASSIGN
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:209  
K$RWPARM.KEYTYPE
      3127**DCL      3128--REDEF
K$RWPARM.MSG$
      2837**DCL      2843--REDEF    3528<<ASSIGN
K$RWPARM.MSGID
      2949**DCL      2954--REDEF
K$RWPARM.MSGIDXT
      2962**DCL      2966--REDEF
K$RWPARM.MSGSZ
      2844**DCL      3529<<ASSIGN
K$RWPARM.ORG
      3098**DCL      3099--REDEF
K$RWPARM.THDRSZ
      3042**DCL      3046--REDEF
K$RWPARM.VDOFLGS
      3100**DCL      3111--REDEF
KI$CCMD.ADB18
      2581**DCL      3480<<ASSIGN
KI$CCMD.L66INT
      2589**DCL      2590--REDEF    2591--REDEF
KI$CCMD.L6INT
      2586**DCL      2588--REDEF
KI$CTCW
      2595**DCL      3473<<ASSIGN
KI$FEI.BD$
      2650**DCL      2651--REDEF    3473>>ASSIGN
KI$FEI.BDAD.PGA.PAGE
      2654**DCL      3477>>ASSIGN
KI$FEI.BDAD.WADDR
      2652**DCL      2653--REDEF    3480>>ASSIGN
KI$FEI.BDSZ
      2657**DCL      3476--ASSIGN
KI$FEI.FECH
      2617**DCL      3469<>CALL     3483<>CALL     3534<>CALL
KI$FEI.FEST
      2620**DCL      3482<<ASSIGN   3514<<ASSIGN
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:210  
KI$FEI.FEWSQ
      2643**DCL      3469<>CALL     3483<>CALL     3534<>CALL
KI$FEI.FROZEN
      2645**DCL      3553<<ASSIGN
KI$FEI.ICQ$
      2637**DCL      3556>>ASSIGN
KI$FEI.IUTS
      2644**DCL      3555<>CALL
KI$FEI.LOCK
      2616**DCL      3462<>CALL     3486<>CALL     3507<>CALL     3536<>CALL
KI$FEI.MSI
      2649**DCL      3554<<ASSIGN
KI$FEI.OCQ$
      2631**DCL      3474>>ASSIGN   3513>>ASSIGN   3558>>ASSIGN
KI$FEI.PBST.PROB
      2668**DCL      3471<<ASSIGN   3511<<ASSIGN
KI$FEI.PBST.STATE
      2672**DCL      3472<<ASSIGN   3512<<ASSIGN
KI$FEI.PTPPNO#
      2665**DCL      3464<>CALL     3509<>CALL
KI$FEI.RCVPB
      2666**DCL      2667--REDEF
KI$FEI.TCNT
      2627**DCL      3481<<ASSIGN   3515<<ASSIGN
KI$FEI.TIMEOUT.BOOT
      2681**DCL      3481>>ASSIGN
KI$FEI$
       199**DCL      3459>>ASSIGN   3505>>ASSIGN   3543>>ASSIGN
KI$QHDR.BDCTL
        66**DCL      3475<<ASSIGN
KI$QHDR.BDCTL.BTPG#
        71**DCL      3477<<ASSIGN
KI$QHDR.BDCTL.MDBFK
        73**DCL      3476<<ASSIGN
KI$QHDR.BDCTL.MLCPDUMP
        68**DCL      3478<<ASSIGN
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:211  
KI$QHDR.CCMD
        65**DCL      3479<<ASSIGN   3480--ASSIGN   3513<<ASSIGN
KI$QHDR.FLG
        92**DCL      3568<<ASSIGN
KI$QHDR.GATE
        86**DCL      3563<<ASSIGN
KI$QHDR.HOST_NODE#
        79**DCL      3569<<ASSIGN
KI$QHDR.INTLOCK
        83**DCL      3564<<ASSIGN
KI$QHDR.IPTR
        90**DCL      3567<<ASSIGN
KI$QHDR.LAST_PTR
       101**DCL      3570<<ASSIGN
KI$QHDR.MYIPTR
        87**DCL      3565<<ASSIGN
KI$QHDR.RPTR
        88**DCL      3566<<ASSIGN
KIQ$LINK
      3133**DCL-ENT  3538--CALL
KIQ$QINIT
      3541**ENTRY    3465--CALL     3510--CALL
KI_FEI$$
       198**DCL       199--IMP-PTR  3459>>ASSIGN   3505>>ASSIGN   3543>>ASSIGN
K_NODE#
      3456**DCL      3569>>ASSIGN
K_RWPARM_CON
      3161**DCL      3516>>ASSIGN
K_RWPARM_CON.BLKREC
      3187**DCL      3212--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      3188**DCL      3190--REDEF
K_RWPARM_CON.BLKREC.RECU#
      3200**DCL      3202--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      3227**DCL      3228--REDEF
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:212  
K_RWPARM_CON.DVE.EOMCHAR
      3235**DCL      3239--REDEF
K_RWPARM_CON.ERR
      3299**DCL      3304--REDEF
K_RWPARM_CON.FC
      3263**DCL      3264--REDEF
K_RWPARM_CON.FLDID
      3445**DCL      3446--REDEF
K_RWPARM_CON.FPT$
      3326**DCL      3333--REDEF
K_RWPARM_CON.KEYTYPE
      3452**DCL      3453--REDEF
K_RWPARM_CON.MSG$
      3162**DCL      3168--REDEF
K_RWPARM_CON.MSGID
      3274**DCL      3279--REDEF
K_RWPARM_CON.MSGIDXT
      3287**DCL      3291--REDEF
K_RWPARM_CON.ORG
      3423**DCL      3424--REDEF
K_RWPARM_CON.THDRSZ
      3367**DCL      3371--REDEF
K_RWPARM_CON.VDOFLGS
      3425**DCL      3436--REDEF
LDCTX
      2812**DCL      3526<<ASSIGN   3528--ASSIGN   3529--ASSIGN
MLCPDUMP
      3131**DCL        11--PROC     3478>>ASSIGN
MMS$WSQMAP
      3134**DCL-ENT  3464--CALL     3509--CALL
N$DCT$
      2471**DCL      3525>>ASSIGN
N$DCT$$
      2337**DCL      2471--IMP-PTR  3525>>ASSIGN
N$FQ$
      2337**DCL      2472--IMP-PTR
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:213  
N$REQ_INIT.BUFADDR
      2356**DCL      2357--REDEF    2357--REDEF
N$REQ_INIT.DLA.DRELADDR
      2348**DCL      2348--REDEF
N$REQ_INIT.DVE.EOMCHAR
      2385**DCL      2386--REDEF
N$REQ_INIT.EAINFO
      2379**DCL      2379--REDEF
N$REQ_INIT.EAINFOX
      2379**DCL      2380--REDEF
N$REQ_INIT.EVNTINFO
      2380**DCL      2380--REDEF
N$REQ_INIT.STATUS
      2361**DCL      2367--REDEF
NI$FQ$
      2397**DCL      2473--IMP-PTR
NI$IBUF$
      2397**DCL      2473--IMP-PTR
NI$IMXMBX_INIT.PAGED_BASE
      2407**DCL      2408--REDEF    2408--REDEF
NI$IMXMBX_INIT.SIZE
      2409**DCL      2409--REDEF
NI$REQ_INIT.DCW
      2431**DCL      2434--REDEF
NI$REQ_INIT.DCW.TALLY
      2432**DCL      2432--REDEF
NI$REQ_INIT.IDCW.EXTA
      2434**DCL      2434--REDEF
NI$REQ_INIT.PCW
      2436**DCL      2440--REDEF
NI$REQ_INIT.SEEK
      2441**DCL      2442--REDEF    2443--REDEF
NI$RP$
      2445**DCL      2475--IMP-PTR
NIS$DCCON
      3135**DCL-ENT  3469--CALL     3483--CALL     3534--CALL
PL6.E3A0      #005=KIQ$FEBOOT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:39 Page:214  
NI_MBX_INIT.DCW.CONTROL.AE
      2467**DCL      2467--REDEF
NI_MBX_INIT.LPW.CONTROL.AE
      2463**DCL      2463--REDEF
NK$LDCT.DDT$
      2776**DCL      2776--REDEF
NK$LDCT.DFLG.FEDN
      2782**DCL      3525<<ASSIGN
NK$LDCT.IOQ$
      2775**DCL      2776--REDEF
NK$LDCT.LDCTX
      2777**DCL      2777--REDEF
NK$LDCT.LKFLG.ABORTED
      2789**DCL      2790--REDEF
NK$LDCT.RLCID.LDCTX
      2799**DCL      2799--REDEF
NK$LDCT.STA$
      2795**DCL      2796--REDEF
NK$LDCT.SYMB$
      2774**DCL      2774--REDEF    2774--REDEF    2775--REDEF
OCQ$
      3132**DCL      3474<<ASSIGN   3475>>ASSIGN   3476>>ASSIGN   3477>>ASSIGN   3478>>ASSIGN   3479>>ASSIGN
      3480>>ASSIGN   3556<<ASSIGN   3558<<ASSIGN   3563>>ASSIGN   3564>>ASSIGN   3565>>ASSIGN   3566>>ASSIGN
      3567>>ASSIGN   3568>>ASSIGN   3569>>ASSIGN   3570>>ASSIGN
SSR$REG
      3137**DCL-ENT  3490--CALL
SSS$SYSTIME
      3136**DCL-ENT  3555--CALL
S_CUN
      2814**DCL      3489>>IF
UBNBSD
      3138**DCL      3476>>ASSIGN

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:215  
     1161        1        /*T***********************************************************/
     1162        2        /*T*                                                         */
     1163        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1164        4        /*T*                                                         */
     1165        5        /*T***********************************************************/
     1166        6
     1167        7
     1168        8        KIQ$FEABT: PROC (FEI,PROB);
     1169        9
     1170       10        /*F*
     1171       11             NAME: KIQ$FEABT
     1172       12             PURPOSE:
     1173       13                  To abort processing on a given fep.
     1174       14             DESCRIPTION:
     1175       15                  KIQ$FEABT will terminate processing for a given fep. The reasons
     1176       16                  are defined by the PROB. If the FEP was in a running state
     1177       17                  KIQ$FEABT will call KIN$NETWORK report the link is down.
     1178       18        */
     1179       19
     1180       20        %INCLUDE KI$QHDR;
     1181      172        %INCLUDE KL_MACRO_C;
     1182     3524        %INCLUDE KL_AFCN_C;
     1183     3625        %INCLUDE EL$TABLES;
     1184     3948        %INCLUDE S_WSPTD_R;
     1185     3964        %INCLUDE KI_DATA_R;
     1186     3990        %INCLUDE KI_MACROS_C;
     1187     4598        %INCLUDE SS_SCHED_C;
     1188     4831        %INCLUDE HF_LOCK_C;
     1189     4845        %INCLUDE KI_SUBS_C;
     1190     4981        %INCLUDE KL_SUBS_C;
     1191     5035        %INCLUDE EL_SUBS_C;
     1192     5119        %INCLUDE NK_SUBS;
     1193     5144        %INCLUDE K$RWPARM;
     1194     5530        %INCLUDE HF_DATA_R;
     1195     5573        %INCLUDE K_SUBS_C;
     1196     5606        %INCLUDE KJ_FCNS_C;
     1197     5633        %INCLUDE JG_GHOSTS_C;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:216  
     1198     5723
     1199     5724        %KI_CCMD(NAME=INTL6,CMD=KIOP_INTL6,L66I=%KJ_IPARM_SCR);
     1200     5752        %KI$CCMD;
     1201     5767        %KL_ACCTNG (STCLASS="");
     1202     5781        %EL$FECRASH (NAME=FCR,STCLASS="");
     1203     5786        %KL_FEPST(STCLASS="");
     1204     5821        %KI$FEI (STCLASS="BASED(FEI$)");
     1205     5905
     1206     5906
     1207     5907    1   DCL IT_CP6UP UBIN SYMREF ;
     1208     5908    1   DCL FEI UBIN WORD;
     1209     5909    1   DCL FEI$ PTR;
     1210     5910    1   DCL PROB UBIN WORD;
     1211     5911    1   DCL TDCT$ PTR;
     1212     5912    1   DCL ICQ$ PTR;
     1213     5913    1   DCL OCQ$ PTR;
     1214     5914    1   DCL TEMP UBIN WORD;
     1215     5915    1   DCL TLOCK BIT(72);
     1216     5916    1   DCL RFEI UBIN;
     1217     5917    1   DCL LOGREMDN BIT(1) ALIGNED;
     1218     5918    1   DCL STOPFLG BIT(36) ALIGNED;
     1219     5919    1   DCL 1 BFEV CONSTANT ALIGNED,
     1220     5920    1            2 PROB UBIN HALF UNAL INIT(KIER_NOBT),
     1221     5921    1            2 STATE UBIN HALF UNAL INIT(KIST_DN);
     1222     5922    1   DCL 1 DFEV CONSTANT ALIGNED,
     1223     5923    1            2 PROB UBIN HALF UNAL INIT(KIER_NOBT),
     1224     5924    1            2 STATE UBIN HALF UNAL INIT(KIST_DMP);
     1225     5925        %K$RWPARM (NAME=K$RWPARM);
     1226     6241
     1227     6242        /* Entry point references */
     1228     6243    1   DCL MMS$VREL ENTRY(2) ALTRET;
     1229     6244    1   DCL KUB$WRITE ENTRY(3) ALTRET;
     1230     6245    1   DCL NIS$DCCON ENTRY(3);
     1231     6246    1   DCL KIN$CONV_NODE ENTRY(3) ALTRET;
     1232     6247    1   DCL KIN$RECV ENTRY(1) ALTRET;
     1233     6248    1   DCL KCD$DSCTRM ENTRY(2);
     1234     6249    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:217  
     1235     6250    1   DCL SSR$RUE ENTRY(4);
     1236     6251    1   DCL ELA$SYSLOG ENTRY(6) ALTRET;
     1237     6252    1   DCL SSC$MONTIMR ENTRY(3);
     1238     6253
     1239     6254    1   DCL SC_BADRCD ENTRY CONV(2,0);
     1240     6255
     1241     6256        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);
     1242     6572
     1243     6573        %EJECT;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:218  
     1244     6574
     1245     6575    1   FEABT: ;
     1246     6576    1        STOPFLG='0'B;
     1247     6577    1   ABT: ;
     1248     6578    1        FEI$ = KI$FEI$(FEI);
     1249     6579    1        IF KI$FEI.FEST = KIST_MASKED THEN
     1250     6580    1           RETURN ;
     1251     6581    1        ICQ$=KI$FEI.ICQ$;
     1252     6582    1        OCQ$=KI$FEI.OCQ$;
     1253     6583    1        TLOCK='1'B;
     1254     6584             %LOCK (G=TLOCK);                   /* INHIBIT */
     1255     6587    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);
     1256     6588             %LOCK (G#="OCQ$->KI$QHDR.GATE");
     1257     6591    1        KI$FEI.PBST.PROB =PROB;
     1258     6592
     1259     6593        /* If the state was booting dont interupt the L6 */
     1260     6594    1        IF PROB ~= KIER_FREQ
     1261     6595    1        THEN
     1262     6596    2          DO ;
     1263     6597    2             OCQ$->KI$QHDR.CCMD=INTL6;
     1264     6598    3             DO CASE (PROB);
     1265     6599
     1266     6600    3              CASE (KIER_TO,KIER_QFL);
     1267     6601    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = %KJ_IPARM_TO;
     1268     6602
     1269     6603    3              CASE (KIER_BDLN,KIER_MFMT,KIER_BFCN);
     1270     6604    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = %KJ_IPARM_BADMSG;
     1271     6605
     1272     6606    3              CASE (KIER_DCFT,KIER_BINT);
     1273     6607    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = %KJ_IPARM_FLT;
     1274     6608
     1275     6609    3              CASE (KIER_BCMD);
     1276     6610    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = %KJ_IPARM_OREQ;
     1277     6611
     1278     6612    3              CASE ( KIER_STOP ) ;
     1279     6613                            /* The effect of the following is to send a KJ_IPARM_CNOP */
     1280     6614    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = 0 ;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:219  
     1281     6615    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6INT = 1 ;
     1282     6616    3                STOPFLG = '0'B ;
     1283     6617
     1284     6618    3              CASE ( KIER_PART ) ;
     1285     6619    3                STOPFLG = '1'B ;
     1286     6620
     1287     6621    3             END;
     1288     6622    2             CALL NIS$DCCON (KI$FEI.FECH ,STOPFLG,KI$FEI.FEWSQ);
     1289     6623    2          END;
     1290     6624
     1291     6625    1        ICQ$->KI$QHDR.INTLOCK=1;
     1292     6626    1        OCQ$->KI$QHDR.INTLOCK=1;
     1293     6627    1        KI$FEI.QFLHD$ =ADDR(NIL);
     1294     6628    1        KI$FEI.PBST.STATE =KI$FEI.FEST ;
     1295     6629    1        IF STOPFLG THEN
     1296     6630    1           KI$FEI.FEST = KIST_MASKED ;
     1297     6631    1        ELSE IF PROB = KIER_STOP THEN
     1298     6632    1              KI$FEI.FEST = KIST_STOPPING ;
     1299     6633    1           ELSE
     1300     6634    1              KI$FEI.FEST = KIST_DN ;
     1301     6635             %UNLOCK (G#="OCQ$->KI$QHDR.GATE");
     1302     6638    1        IF PROB = KIER_STOP THEN
     1303     6639    1           CALL SSC$MONTIMR ( SEC5 , ENTADDR(KIQ$MASKFEP) , FEI ) ;
     1304     6640    2        DO CASE (KI$FEI.PBST.STATE );
     1305     6641    2         CASE (KIST_RUN,KIST_QFL,KIST_DB);
     1306     6642    2           K$RWPARM = K_RWPARM_CON;
     1307     6643    2           K$RWPARM.FUNCTION = %K_REPDISC;
     1308     6644    2           K$RWPARM.FEX = FEI;
     1309     6645    2           CALL KIN$RECV(K$RWPARM);
     1310     6646    2           KL_ACCTNG.FEX=KI$FEI.FEP#;
     1311     6647    2           IF STOPFLG
     1312     6648    2           THEN KL_ACCTNG.REASON=%KLDR_STOP;
     1313     6649    2           ELSE KL_ACCTNG.REASON=%KLDR_FCRSH;
     1314     6650    3           CALL ELA$SYSLOG (EL_FEGN,KL_ACCTNG,1,'0'B,2,TEMP) WHENALTRETURN DO ;
     1315     6651    3                CALL SSC$MONTIMR ( SEC5 , ENTADDR ( KIQ$LGFEDN ) , KL_ACCTNG ) ;
     1316     6652    3             END ;
     1317     6653    2         CASE (KIST_TOK);
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:220  
     1318     6654    2         CASE (KIST_BT);
     1319     6655    2           IF KI$FEI.BDU# ~= 0
     1320     6656    2           THEN
     1321     6657    3             DO ;
     1322     6658    3                KI$FEI.BDARS =OCQ$->KI$QHDR.BDCTL.MLCPZ*1024/4;
     1323     6659    3                CALL MMS$VREL (KI$FEI.FEWSQ ,KI$FEI.BD$ );
     1324     6660    3                IF KI$FEI.BDU# ~= JG_FROG# /* FROG */
     1325     6661    3                THEN CALL SSR$RUE (%SS_UQA,KI$FEI.BDU# );
     1326     6662    3                KI$FEI.BDU# =0;
     1327     6663    3             END;
     1328     6664    2         CASE (KIST_DMP);
     1329     6665    2           CALL MMS$VREL (KI$FEI.FEWSQ ,KI$FEI.BD$ );
     1330     6666    2           CALL SSR$RUE (%SS_UQA,KI$FEI.BDU# );
     1331     6667    2        END;
     1332     6668
     1333     6669    1        KL_FEPST.FEP = KI$FEI.FEP#;
     1334     6670    1        KL_FEPST.FCN = IGA_FEPST;
     1335     6671    1        KL_FEPST.PROB = KI$FEI.PBST.PROB ;
     1336     6672    1        KL_FEPST.STATE = KI$FEI.PBST.STATE ;
     1337     6673    1        CALL KUB$WRITE (KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN') WHENALTRETURN
     1338     6674    2          DO ;
     1339     6675    2             CALL SSC$MONTIMR (SEC5,ENTADDR(KIQ$TELL),FEI);
     1340     6676    2          END;
     1341     6677    1        FCR.FENM.PROBLEM=KI$FEI.PBST.PROB ;
     1342     6678    1        FCR.FENM.STATE=KI$FEI.PBST.STATE ;
     1343     6679    1        FCR.FENM.FEP#=KI$FEI.FEP#;
     1344     6680    1        CALL KIN$CONV_NODE(FCR.FENM.NODENAME,FCR.FENM.FEP#);
     1345     6681    1        FCR.FENM.CRASH# = KI$FEI.SEQ;
     1346     6682    1        FCR.FENM.DEVADDR=KI$FEI.FECH ;
     1347     6683    1        CALL ELA$SYSLOG (EL_FEPCRASH,FCR,SIZEW(FCR),'0'B,1,TEMP);
     1348     6684             %UNLOCK (G=TLOCK);
     1349     6687    1        RETURN;
     1350     6688
     1351     6689    1   KIQ$FESTOP: ENTRY (FEI,PROB);
     1352     6690
     1353     6691    1        STOPFLG='1'B;
     1354     6692    1        GOTO ABT;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:221  
     1355     6693
     1356     6694    1   KIQ$MASKFEP: ENTRY ( FEI ) ;
     1357     6695
     1358     6696        /* This entry should only be used by KIQ$FEABT for stopping FEPs.
     1359     6697           It is entered after a 5 second wait so that COUPLER has a chance
     1360     6698           to read the CNOP command before the channel is masked. */
     1361     6699
     1362     6700    1        FEI$ = KI$FEI$ ( FEI ) ;
     1363     6701             %LOCK ( G = KI$FEI.LOCK ) ;
     1364     6704    1        IF KI$FEI.FEST = KIST_STOPPING
     1365     6705    2        THEN DO ;
     1366     6706    2             CALL NIS$DCCON ( KI$FEI.FECH , '4'O , KI$FEI.FEWSQ ) ;
     1367     6707    2             KI$FEI.FEST = KIST_MASKED ;
     1368     6708    2          END ;
     1369     6709             %UNLOCK ( G = KI$FEI.LOCK ) ;
     1370     6712    1        RETURN ;
     1371     6713
     1372     6714    1   KIQ$PARTFEP: ENTRY (FEI,PROB);
     1373     6715
     1374     6716    1        FEI$ = KI$FEI$(FEI);
     1375     6717    2        IF IT_CP6UP = 0 THEN DO ;
     1376     6718    2             KI$FEI.PBST.PROB = KIER_PART ;
     1377     6719    2             KI$FEI.FEST = KIST_DN ;
     1378     6720    2          END ;
     1379     6721    2        ELSE DO ;
     1380     6722    2             IF KI$FEI.FEST ~= KIST_DN AND KI$FEI.FEST ~= KIST_MASKED THEN
     1381     6723    2                GOTO FEABT ;
     1382     6724    2             KI$FEI.FEST = KIST_MASKED;
              6724                      /* mask the feps to keep rload int from getting through */
     1383     6725    2             KI$FEI.PBST.PROB =KIER_PART;
     1384     6726    2             KL_FEPST.FEP = KI$FEI.FEP#;
     1385     6727    2             KL_FEPST.FCN = IGA_FEPST;
     1386     6728    2             KL_FEPST.PROB = KIER_PART;
     1387     6729    3             CALL KUB$WRITE(KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN') WHENALTRETURN DO ;
     1388     6730    3                  CALL SSC$MONTIMR (SEC5,ENTADDR(KIQ$TELL),FEI) ;
     1389     6731    3               END ;
     1390     6732    2          END ;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:222  
     1391     6733    1        RETURN;
     1392     6734
     1393     6735    1   KIQ$UPRTFEP: ENTRY (FEI);
     1394     6736
     1395     6737    1        FEI$ = KI$FEI$(FEI);
     1396     6738    1        IF KI$FEI.PBST.PROB ~=KIER_PART THEN RETURN;
     1397     6739    1        KI$FEI.PBST.PROB =KIER_UPRT;
     1398     6740    1        KL_FEPST.FEP = KI$FEI.FEP#;
     1399     6741    1        KL_FEPST.FCN = IGA_FEPST;
     1400     6742    1        KL_FEPST.PROB = KIER_UPRT;
     1401     6743    1        KL_FEPST.STATE = KIER_OK;
     1402     6744    1        IF HW_IMX THEN
     1403     6745    1           CALL NIS$DCCON (KI$FEI.FECH,'2'O,KI$FEI.FEWSQ); /* INIT DIRECT CHANNEL */
     1404     6746    1        CALL KUB$WRITE (KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN');
     1405     6747    1        KI$FEI.PBST.PROB =KIER_OK;
     1406     6748    1        RETURN;
     1407     6749
     1408     6750
     1409     6751    1   KIQ$TELL: ENTRY (FEI);
     1410     6752    1        FEI$ = KI$FEI$(FEI);
     1411     6753    1        KL_FEPST.FEP = KI$FEI.FEP#;
     1412     6754    1        KL_FEPST.FCN = IGA_FEPST;
     1413     6755    1        KL_FEPST.PROB = KI$FEI.PBST.PROB ;
     1414     6756    1        KL_FEPST.STATE = KI$FEI.PBST.STATE ;
     1415     6757    1        CALL KUB$WRITE (KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN') WHENALTRETURN
     1416     6758    2          DO ;
     1417     6759    2             CALL SSC$MONTIMR (SEC5,ENTADDR(KIQ$TELL),FEI);
     1418     6760    2          END;
     1419     6761    1        RETURN;
     1420     6762
     1421     6763
     1422     6764    1   KIQ$LGFEDN: ENTRY (FEI);
     1423     6765
     1424     6766    2        CALL ELA$SYSLOG (EL_FEGN,FEI,1,'0'B,2,TEMP) WHENALTRETURN DO ;
     1425     6767    2             CALL SSC$MONTIMR ( SEC5 , ENTADDR(KIQ$LGFEDN) , FEI ) ;
     1426     6768    2          END ;
     1427     6769    1        RETURN;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:223  
     1428     6770
     1429     6771
     1430     6772
     1431     6773
     1432     6774
     1433     6775    1   END KIQ$FEABT;
     1434     6776        %EOD;

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:224  
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   K$RWPARM.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   KL_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$FEABT.

   Procedure KIQ$FEABT requires 574 words for executable code.
   Procedure KIQ$FEABT requires 78 words of local(AUTO) storage.

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:225  

 Object Unit name= KIQ$FEABT                                  File name= KIQ$QMGR.:E05TOU
 UTS= JUL 30 '97 00:40:22.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      5      5  KIQ$FEABT
    1   Proc  even  none   574   1076  KIQ$FEABT
    2  RoData even  none    22     26  KIQ$FEABT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  KIQ$FEABT
     1    544                  yes      Std        2  KIQ$FESTOP
     1    551                  yes      Std        1  KIQ$MASKFEP
     1    615                  yes      Std        2  KIQ$PARTFEP
     1    706                  yes      Std        1  KIQ$UPRTFEP
     1    770                  yes      Std        1  KIQ$TELL
     1   1041                  yes      Std        1  KIQ$LGFEDN
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:226  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 MMS$WSQMAP
         yes           Std       3 NIS$DCCON
         yes           Std       1 HFC$UNLOCK
         yes           Std       3 SSC$MONTIMR
 yes     yes           Std       1 KIN$RECV
 yes     yes           Std       6 ELA$SYSLOG
 yes     yes           Std       2 MMS$VREL
 yes     yes           Std       3 KIN$CONV_NODE
         yes           Std       4 SSR$RUE
 yes     yes           Std       3 KUB$WRITE
         yes           Std       1 KIQ$MASKFEP
         yes           Std       1 KIQ$LGFEDN
         yes           Std       1 KIQ$TELL
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KI_FEI$$                              HW_IMX                                IT_CP6UP
     K_RWPARM_CON                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:227  


     1161        1        /*T***********************************************************/
     1162        2        /*T*                                                         */
     1163        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1164        4        /*T*                                                         */
     1165        5        /*T***********************************************************/
     1166        6
     1167        7
     1168        8        KIQ$FEABT: PROC (FEI,PROB);

      8  1 000000   000000 700200 xent  KIQ$FEABT    TSX0  ! X66_AUTO_2
         1 000001   000116 000002                    ZERO    78,2

     1169        9
     1170       10        /*F*
     1171       11             NAME: KIQ$FEABT
     1172       12             PURPOSE:
     1173       13                  To abort processing on a given fep.
     1174       14             DESCRIPTION:
     1175       15                  KIQ$FEABT will terminate processing for a given fep. The reasons
     1176       16                  are defined by the PROB. If the FEP was in a running state
     1177       17                  KIQ$FEABT will call KIN$NETWORK report the link is down.
     1178       18        */
     1179       19
     1180       20        %INCLUDE KI$QHDR;
     1181      172        %INCLUDE KL_MACRO_C;
     1182     3524        %INCLUDE KL_AFCN_C;
     1183     3625        %INCLUDE EL$TABLES;
     1184     3948        %INCLUDE S_WSPTD_R;
     1185     3964        %INCLUDE KI_DATA_R;
     1186     3990        %INCLUDE KI_MACROS_C;
     1187     4598        %INCLUDE SS_SCHED_C;
     1188     4831        %INCLUDE HF_LOCK_C;
     1189     4845        %INCLUDE KI_SUBS_C;
     1190     4981        %INCLUDE KL_SUBS_C;
     1191     5035        %INCLUDE EL_SUBS_C;
     1192     5119        %INCLUDE NK_SUBS;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:228  
     1193     5144        %INCLUDE K$RWPARM;
     1194     5530        %INCLUDE HF_DATA_R;
     1195     5573        %INCLUDE K_SUBS_C;
     1196     5606        %INCLUDE KJ_FCNS_C;
     1197     5633        %INCLUDE JG_GHOSTS_C;
     1198     5723
     1199     5724        %KI_CCMD(NAME=INTL6,CMD=KIOP_INTL6,L66I=%KJ_IPARM_SCR);
     1200     5752        %KI$CCMD;
     1201     5767        %KL_ACCTNG (STCLASS="");
     1202     5781        %EL$FECRASH (NAME=FCR,STCLASS="");
     1203     5786        %KL_FEPST(STCLASS="");
     1204     5821        %KI$FEI (STCLASS="BASED(FEI$)");
     1205     5905
     1206     5906
     1207     5907    1   DCL IT_CP6UP UBIN SYMREF ;
     1208     5908    1   DCL FEI UBIN WORD;
     1209     5909    1   DCL FEI$ PTR;
     1210     5910    1   DCL PROB UBIN WORD;
     1211     5911    1   DCL TDCT$ PTR;
     1212     5912    1   DCL ICQ$ PTR;
     1213     5913    1   DCL OCQ$ PTR;
     1214     5914    1   DCL TEMP UBIN WORD;
     1215     5915    1   DCL TLOCK BIT(72);
     1216     5916    1   DCL RFEI UBIN;
     1217     5917    1   DCL LOGREMDN BIT(1) ALIGNED;
     1218     5918    1   DCL STOPFLG BIT(36) ALIGNED;
     1219     5919    1   DCL 1 BFEV CONSTANT ALIGNED,
     1220     5920    1            2 PROB UBIN HALF UNAL INIT(KIER_NOBT),
     1221     5921    1            2 STATE UBIN HALF UNAL INIT(KIST_DN);
     1222     5922    1   DCL 1 DFEV CONSTANT ALIGNED,
     1223     5923    1            2 PROB UBIN HALF UNAL INIT(KIER_NOBT),
     1224     5924    1            2 STATE UBIN HALF UNAL INIT(KIST_DMP);
     1225     5925        %K$RWPARM (NAME=K$RWPARM);
     1226     6241
     1227     6242        /* Entry point references */
     1228     6243    1   DCL MMS$VREL ENTRY(2) ALTRET;
     1229     6244    1   DCL KUB$WRITE ENTRY(3) ALTRET;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:229  
     1230     6245    1   DCL NIS$DCCON ENTRY(3);
     1231     6246    1   DCL KIN$CONV_NODE ENTRY(3) ALTRET;
     1232     6247    1   DCL KIN$RECV ENTRY(1) ALTRET;
     1233     6248    1   DCL KCD$DSCTRM ENTRY(2);
     1234     6249    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
     1235     6250    1   DCL SSR$RUE ENTRY(4);
     1236     6251    1   DCL ELA$SYSLOG ENTRY(6) ALTRET;
     1237     6252    1   DCL SSC$MONTIMR ENTRY(3);
     1238     6253
     1239     6254    1   DCL SC_BADRCD ENTRY CONV(2,0);
     1240     6255
     1241     6256        %K$RWPARM (NAME=K_RWPARM_CON, STCLASS=SYMREF);

   6570  1 000002                       FEABT        null
     1242     6572
     1243     6573        %EJECT;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:230  
     1244     6574
     1245     6575    1   FEABT: ;
     1246     6576    1        STOPFLG='0'B;

   6576  1 000002   200036 450100                    STZ     STOPFLG,,AUTO

   6576  1 000003                       ABT          null
     1247     6577    1   ABT: ;
     1248     6578    1        FEI$ = KI$FEI$(FEI);

   6578  1 000003   200003 470500                    LDP0    @FEI,,AUTO
         1 000004   000000 720100                    LXL0    0,,PR0
         1 000005   000000 471400 xsym               LDP1    KI_FEI$$
         1 000006   100000 236110                    LDQ     0,X0,PR1
         1 000007   200025 756100                    STQ     FEI$,,AUTO

     1249     6579    1        IF KI$FEI.FEST = KIST_MASKED THEN

   6579  1 000010   200025 473500                    LDP3    FEI$,,AUTO
         1 000011   300002 236100                    LDQ     2,,PR3
         1 000012   000777 376003                    ANQ     511,DU
         1 000013   000007 116003                    CMPQ    7,DU
         1 000014   000016 601000 1                  TNZ     s:6581

     1250     6580    1           RETURN ;

   6580  1 000015   000000 702200 xent               TSX2  ! X66_ARET

     1251     6581    1        ICQ$=KI$FEI.ICQ$;

   6581  1 000016   300004 236100                    LDQ     4,,PR3
         1 000017   200027 756100                    STQ     ICQ$,,AUTO

     1252     6582    1        OCQ$=KI$FEI.OCQ$;

   6582  1 000020   300003 236100                    LDQ     3,,PR3
         1 000021   200030 756100                    STQ     OCQ$,,AUTO
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:231  

     1253     6583    1        TLOCK='1'B;

   6583  1 000022   400000 235003                    LDA     -131072,DU
         1 000023   000000 236003                    LDQ     0,DU
         1 000024   200032 757100                    STAQ    TLOCK,,AUTO

     1254     6584             %LOCK (G=TLOCK);                   /* INHIBIT */

   6585  1 000025   200032 634500                    EPPR4   TLOCK,,AUTO
         1 000026   200110 454500                    STP4    K$RWPARM+40,,AUTO
         1 000027   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000031   000000 701000 xent               TSX1    HFC$LOCK
         1 000032   000000 011000                    NOP     0

     1255     6587    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);

   6587  1 000033   200025 236100                    LDQ     FEI$,,AUTO
         1 000034   000014 036003                    ADLQ    12,DU
         1 000035   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000036   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000037   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000040   000000 701000 xent               TSX1    MMS$WSQMAP
         1 000041   000000 011000                    NOP     0

     1256     6588             %LOCK (G#="OCQ$->KI$QHDR.GATE");

   6589  1 000042   200030 236100                    LDQ     OCQ$,,AUTO
         1 000043   000006 036003                    ADLQ    6,DU
         1 000044   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000045   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000047   000000 701000 xent               TSX1    HFC$LOCK
         1 000050   000000 011000                    NOP     0

     1257     6591    1        KI$FEI.PBST.PROB =PROB;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:232  

   6591  1 000051   200004 470500                    LDP0    @PROB,,AUTO
         1 000052   000000 720100                    LXL0    0,,PR0
         1 000053   200025 471500                    LDP1    FEI$,,AUTO
         1 000054   100015 740100                    STX0    13,,PR1

     1258     6592
     1259     6593        /* If the state was booting dont interupt the L6 */
     1260     6594    1        IF PROB ~= KIER_FREQ

   6594  1 000055   000000 235100                    LDA     0,,PR0
         1 000056   000020 115007                    CMPA    16,DL
         1 000057   000156 600000 1                  TZE     s:6625

     1261     6595    1        THEN
     1262     6596    2          DO ;

     1263     6597    2             OCQ$->KI$QHDR.CCMD=INTL6;

   6597  1 000060   000000 236000 0                  LDQ     INTL6
         1 000061   200030 473500                    LDP3    OCQ$,,AUTO
         1 000062   300000 756100                    STQ     0,,PR3

     1264     6598    3             DO CASE (PROB);

   6598  1 000063   000000 235100                    LDA     0,,PR0
         1 000064   000017 115007                    CMPA    15,DL
         1 000065   000067 602005 1                  TNC     s:6598+4,AL
         1 000066   000142 710000 1                  TRA     s:6622
         1 000067   000142 710000 1                  TRA     s:6622
         1 000070   000106 710000 1                  TRA     s:6601
         1 000071   000106 710000 1                  TRA     s:6601
         1 000072   000142 710000 1                  TRA     s:6622
         1 000073   000142 710000 1                  TRA     s:6622
         1 000074   000142 710000 1                  TRA     s:6622
         1 000075   000120 710000 1                  TRA     s:6607
         1 000076   000113 710000 1                  TRA     s:6604
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:233  
         1 000077   000113 710000 1                  TRA     s:6604
         1 000100   000113 710000 1                  TRA     s:6604
         1 000101   000120 710000 1                  TRA     s:6607
         1 000102   000125 710000 1                  TRA     s:6610
         1 000103   000142 710000 1                  TRA     s:6622
         1 000104   000130 710000 1                  TRA     s:6614
         1 000105   000140 710000 1                  TRA     s:6619

     1265     6599
     1266     6600    3              CASE (KIER_TO,KIER_QFL);

     1267     6601    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = %KJ_IPARM_TO;

   6601  1 000106   300000 236100                    LDQ     0,,PR3
         1 000107   000000 376000 2                  ANQ     0
         1 000110   000400 276007                    ORQ     256,DL
         1 000111   300000 756100                    STQ     0,,PR3
         1 000112   000142 710000 1                  TRA     s:6622

     1268     6602
     1269     6603    3              CASE (KIER_BDLN,KIER_MFMT,KIER_BFCN);

     1270     6604    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = %KJ_IPARM_BADMSG;

   6604  1 000113   300000 236100                    LDQ     0,,PR3
         1 000114   000000 376000 2                  ANQ     0
         1 000115   000500 276007                    ORQ     320,DL
         1 000116   300000 756100                    STQ     0,,PR3
         1 000117   000142 710000 1                  TRA     s:6622

     1271     6605
     1272     6606    3              CASE (KIER_DCFT,KIER_BINT);

     1273     6607    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = %KJ_IPARM_FLT;

   6607  1 000120   300000 236100                    LDQ     0,,PR3
         1 000121   000000 376000 2                  ANQ     0
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:234  
         1 000122   000600 276007                    ORQ     384,DL
         1 000123   300000 756100                    STQ     0,,PR3
         1 000124   000142 710000 1                  TRA     s:6622

     1274     6608
     1275     6609    3              CASE (KIER_BCMD);

     1276     6610    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = %KJ_IPARM_OREQ;

   6610  1 000125   000700 236007                    LDQ     448,DL
         1 000126   300000 256100                    ORSQ    0,,PR3
         1 000127   000142 710000 1                  TRA     s:6622

     1277     6611
     1278     6612    3              CASE ( KIER_STOP ) ;

     1279     6613                            /* The effect of the following is to send a KJ_IPARM_CNOP */
     1280     6614    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6PARM = 0 ;

   6614  1 000130   000000 236000 2                  LDQ     0
         1 000131   300000 356100                    ANSQ    0,,PR3

     1281     6615    3                ADDR(OCQ$->KI$QHDR.CCMD)->KI$CCMD.L6INT = 1 ;

   6615  1 000132   300000 236100                    LDQ     0,,PR3
         1 000133   000001 376000 2                  ANQ     1
         1 000134   001000 276007                    ORQ     512,DL
         1 000135   300000 756100                    STQ     0,,PR3

     1282     6616    3                STOPFLG = '0'B ;

   6616  1 000136   200036 450100                    STZ     STOPFLG,,AUTO
         1 000137   000142 710000 1                  TRA     s:6622

     1283     6617
     1284     6618    3              CASE ( KIER_PART ) ;

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:235  
     1285     6619    3                STOPFLG = '1'B ;

   6619  1 000140   400000 236003                    LDQ     -131072,DU
         1 000141   200036 756100                    STQ     STOPFLG,,AUTO

     1286     6620
     1287     6621    3             END;

     1288     6622    2             CALL NIS$DCCON (KI$FEI.FECH ,STOPFLG,KI$FEI.FEWSQ);

   6622  1 000142   200025 236100                    LDQ     FEI$,,AUTO
         1 000143   000005 036003                    ADLQ    5,DU
         1 000144   200112 756100                    STQ     K$RWPARM+42,,AUTO
         1 000145   200036 634500                    EPPR4   STOPFLG,,AUTO
         1 000146   200111 454500                    STP4    K$RWPARM+41,,AUTO
         1 000147   200025 236100                    LDQ     FEI$,,AUTO
         1 000150   000002 036003                    ADLQ    2,DU
         1 000151   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000152   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000153   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000154   000000 701000 xent               TSX1    NIS$DCCON
         1 000155   000000 011000                    NOP     0

     1289     6623    2          END;

     1290     6624
     1291     6625    1        ICQ$->KI$QHDR.INTLOCK=1;

   6625  1 000156   000001 235007                    LDA     1,DL
         1 000157   200027 470500                    LDP0    ICQ$,,AUTO
         1 000160   000004 755100                    STA     4,,PR0

     1292     6626    1        OCQ$->KI$QHDR.INTLOCK=1;

   6626  1 000161   200030 471500                    LDP1    OCQ$,,AUTO
         1 000162   100004 755100                    STA     4,,PR1

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:236  
     1293     6627    1        KI$FEI.QFLHD$ =ADDR(NIL);

   6627  1 000163   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000164   200025 473500                    LDP3    FEI$,,AUTO
         1 000165   300017 756100                    STQ     15,,PR3

     1294     6628    1        KI$FEI.PBST.STATE =KI$FEI.FEST ;

   6628  1 000166   300002 220100                    LDX0    2,,PR3
         1 000167   000777 360003                    ANX0    511,DU
         1 000170   300015 440100                    SXL0    13,,PR3

     1295     6629    1        IF STOPFLG THEN

   6629  1 000171   200036 235100                    LDA     STOPFLG,,AUTO
         1 000172   000176 600000 1                  TZE     s:6631

     1296     6630    1           KI$FEI.FEST = KIST_MASKED ;

   6630  1 000173   000007 236003                    LDQ     7,DU
         1 000174   300002 552120                    STBQ    2,'20'O,PR3
         1 000175   000207 710000 1                  TRA     s:6636

     1297     6631    1        ELSE IF PROB = KIER_STOP THEN

   6631  1 000176   200004 474500                    LDP4    @PROB,,AUTO
         1 000177   400000 235100                    LDA     0,,PR4
         1 000200   000015 115007                    CMPA    13,DL
         1 000201   000205 601000 1                  TNZ     s:6634

     1298     6632    1              KI$FEI.FEST = KIST_STOPPING ;

   6632  1 000202   000010 236003                    LDQ     8,DU
         1 000203   300002 552120                    STBQ    2,'20'O,PR3
         1 000204   000207 710000 1                  TRA     s:6636

     1299     6633    1           ELSE
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:237  
     1300     6634    1              KI$FEI.FEST = KIST_DN ;

   6634  1 000205   000000 236003                    LDQ     0,DU
         1 000206   300002 552120                    STBQ    2,'20'O,PR3

     1301     6635             %UNLOCK (G#="OCQ$->KI$QHDR.GATE");

   6636  1 000207   200030 236100                    LDQ     OCQ$,,AUTO
         1 000210   000006 036003                    ADLQ    6,DU
         1 000211   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000212   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000214   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000215   000000 011000                    NOP     0

     1302     6638    1        IF PROB = KIER_STOP THEN

   6638  1 000216   200004 470500                    LDP0    @PROB,,AUTO
         1 000217   000000 235100                    LDA     0,,PR0
         1 000220   000015 115007                    CMPA    13,DL
         1 000221   000236 601000 1                  TNZ     s:6640

     1303     6639    1           CALL SSC$MONTIMR ( SEC5 , ENTADDR(KIQ$MASKFEP) , FEI ) ;

   6639  1 000222   000551 636000 1                  EAQ     s:6694
         1 000223   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000224   200003 236100                    LDQ     @FEI,,AUTO
         1 000225   200113 756100                    STQ     K$RWPARM+43,,AUTO
         1 000226   200110 631500                    EPPR1   K$RWPARM+40,,AUTO
         1 000227   200112 451500                    STP1    K$RWPARM+42,,AUTO
         1 000230   000003 236000 2                  LDQ     3
         1 000231   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000232   200111 630500                    EPPR0   K$RWPARM+41,,AUTO
         1 000233   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000234   000000 701000 xent               TSX1    SSC$MONTIMR
         1 000235   000000 011000                    NOP     0

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:238  
     1304     6640    2        DO CASE (KI$FEI.PBST.STATE );

   6640  1 000236   200025 470500                    LDP0    FEI$,,AUTO
         1 000237   000015 720100                    LXL0    13,,PR0
         1 000240   000007 100003                    CMPX0   7,DU
         1 000241   000243 602010 1                  TNC     s:6640+5,X0
         1 000242   000425 710000 1                  TRA     s:6669
         1 000243   000425 710000 1                  TRA     s:6669
         1 000244   000425 710000 1                  TRA     s:6669
         1 000245   000252 710000 1                  TRA     s:6642
         1 000246   000252 710000 1                  TRA     s:6642
         1 000247   000252 710000 1                  TRA     s:6642
         1 000250   000403 710000 1                  TRA     s:6665
         1 000251   000337 710000 1                  TRA     s:6655

     1305     6641    2         CASE (KIST_RUN,KIST_QFL,KIST_DB);

     1306     6642    2           K$RWPARM = K_RWPARM_CON;

   6642  1 000252   000100 100400                    MLR     fill='000'O
         1 000253   000000 000234 xsym               ADSC9   K_RWPARM_CON             cn=0,n=156
         1 000254   200040 000234                    ADSC9   K$RWPARM,,AUTO           cn=0,n=156

     1307     6643    2           K$RWPARM.FUNCTION = %K_REPDISC;

   6643  1 000255   000007 235007                    LDA     7,DL
         1 000256   200060 755100                    STA     K$RWPARM+16,,AUTO

     1308     6644    2           K$RWPARM.FEX = FEI;

   6644  1 000257   200003 471500                    LDP1    @FEI,,AUTO
         1 000260   100000 235100                    LDA     0,,PR1
         1 000261   200061 755100                    STA     K$RWPARM+17,,AUTO

     1309     6645    2           CALL KIN$RECV(K$RWPARM);

   6645  1 000262   200040 633500                    EPPR3   K$RWPARM,,AUTO
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:239  
         1 000263   200110 453500                    STP3    K$RWPARM+40,,AUTO
         1 000264   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000265   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000266   000000 701000 xent               TSX1    KIN$RECV
         1 000267   000000 011000                    NOP     0

     1310     6646    2           KL_ACCTNG.FEX=KI$FEI.FEP#;

   6646  1 000270   200025 470500                    LDP0    FEI$,,AUTO
         1 000271   000012 236100                    LDQ     10,,PR0
         1 000272   000022 736000                    QLS     18
         1 000273   200005 552140                    STBQ    KL_ACCTNG,'40'O,AUTO

     1311     6647    2           IF STOPFLG

   6647  1 000274   200036 235100                    LDA     STOPFLG,,AUTO
         1 000275   000301 600000 1                  TZE     s:6649

     1312     6648    2           THEN KL_ACCTNG.REASON=%KLDR_STOP;

   6648  1 000276   000012 236003                    LDQ     10,DU
         1 000277   200005 552120                    STBQ    KL_ACCTNG,'20'O,AUTO
         1 000300   000303 710000 1                  TRA     s:6650

     1313     6649    2           ELSE KL_ACCTNG.REASON=%KLDR_FCRSH;

   6649  1 000301   000004 236003                    LDQ     4,DU
         1 000302   200005 552120                    STBQ    KL_ACCTNG,'20'O,AUTO

     1314     6650    3           CALL ELA$SYSLOG (EL_FEGN,KL_ACCTNG,1,'0'B,2,TEMP) WHENALTRETURN DO ;

   6650  1 000303   200031 631500                    EPPR1   TEMP,,AUTO
         1 000304   200115 451500                    STP1    K$RWPARM+45,,AUTO
         1 000305   000004 236000 2                  LDQ     4
         1 000306   200114 756100                    STQ     K$RWPARM+44,,AUTO
         1 000307   000006 237000 2                  LDAQ    6
         1 000310   200112 757100                    STAQ    K$RWPARM+42,,AUTO
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:240  
         1 000311   200005 633500                    EPPR3   KL_ACCTNG,,AUTO
         1 000312   200111 453500                    STP3    K$RWPARM+41,,AUTO
         1 000313   000010 236000 2                  LDQ     8
         1 000314   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000315   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000316   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000317   000000 701000 xent               TSX1    ELA$SYSLOG
         1 000320   000322 702000 1                  TSX2    s:6651
         1 000321   000336 710000 1                  TRA     s:6652

     1315     6651    3                CALL SSC$MONTIMR ( SEC5 , ENTADDR ( KIQ$LGFEDN ) , KL_ACCTNG ) ;

   6651  1 000322   001041 636000 1                  EAQ     s:6764
         1 000323   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000324   200005 630500                    EPPR0   KL_ACCTNG,,AUTO
         1 000325   200113 450500                    STP0    K$RWPARM+43,,AUTO
         1 000326   200110 631500                    EPPR1   K$RWPARM+40,,AUTO
         1 000327   200112 451500                    STP1    K$RWPARM+42,,AUTO
         1 000330   000003 236000 2                  LDQ     3
         1 000331   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000332   200111 630500                    EPPR0   K$RWPARM+41,,AUTO
         1 000333   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000334   000000 701000 xent               TSX1    SSC$MONTIMR
         1 000335   000000 011000                    NOP     0

     1316     6652    3             END ;

   6652  1 000336   000425 710000 1                  TRA     s:6669

     1317     6653    2         CASE (KIST_TOK);

     1318     6654    2         CASE (KIST_BT);

     1319     6655    2           IF KI$FEI.BDU# ~= 0

   6655  1 000337   000007 236100                    LDQ     7,,PR0
         1 000340   000777 316003                    CANQ    511,DU
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:241  
         1 000341   000425 600000 1                  TZE     s:6669

     1320     6656    2           THEN
     1321     6657    3             DO ;

     1322     6658    3                KI$FEI.BDARS =OCQ$->KI$QHDR.BDCTL.MLCPZ*1024/4;

   6658  1 000342   200030 471500                    LDP1    OCQ$,,AUTO
         1 000343   100001 236100                    LDQ     1,,PR1
         1 000344   000010 736000                    QLS     8
         1 000345   177400 376007                    ANQ     65280,DL
         1 000346   000000 621006                    EAX1    0,QL
         1 000347   000011 441100                    SXL1    9,,PR0

     1323     6659    3                CALL MMS$VREL (KI$FEI.FEWSQ ,KI$FEI.BD$ );

   6659  1 000350   200025 236100                    LDQ     FEI$,,AUTO
         1 000351   000010 036003                    ADLQ    8,DU
         1 000352   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000353   200025 236100                    LDQ     FEI$,,AUTO
         1 000354   000005 036003                    ADLQ    5,DU
         1 000355   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000356   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000357   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000360   000000 701000 xent               TSX1    MMS$VREL
         1 000361   000000 011000                    NOP     0

     1324     6660    3                IF KI$FEI.BDU# ~= JG_FROG# /* FROG */

   6660  1 000362   200025 470500                    LDP0    FEI$,,AUTO
         1 000363   000007 236100                    LDQ     7,,PR0
         1 000364   000777 376003                    ANQ     511,DU
         1 000365   000010 116003                    CMPQ    8,DU
         1 000366   000377 600000 1                  TZE     s:6662

     1325     6661    3                THEN CALL SSR$RUE (%SS_UQA,KI$FEI.BDU# );

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:242  
   6661  1 000367   200025 236100                    LDQ     FEI$,,AUTO
         1 000370   000012 036000 2                  ADLQ    10
         1 000371   000013 235000 2                  LDA     11
         1 000372   200110 757100                    STAQ    K$RWPARM+40,,AUTO
         1 000373   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000374   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000375   000000 701000 xent               TSX1    SSR$RUE
         1 000376   000000 011000                    NOP     0

     1326     6662    3                KI$FEI.BDU# =0;

   6662  1 000377   200025 470500                    LDP0    FEI$,,AUTO
         1 000400   000000 236003                    LDQ     0,DU
         1 000401   000007 552120                    STBQ    7,'20'O,PR0

     1327     6663    3             END;

   6663  1 000402   000425 710000 1                  TRA     s:6669

     1328     6664    2         CASE (KIST_DMP);

     1329     6665    2           CALL MMS$VREL (KI$FEI.FEWSQ ,KI$FEI.BD$ );

   6665  1 000403   200025 236100                    LDQ     FEI$,,AUTO
         1 000404   000010 036003                    ADLQ    8,DU
         1 000405   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000406   200025 236100                    LDQ     FEI$,,AUTO
         1 000407   000005 036003                    ADLQ    5,DU
         1 000410   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000411   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000412   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000413   000000 701000 xent               TSX1    MMS$VREL
         1 000414   000000 011000                    NOP     0

     1330     6666    2           CALL SSR$RUE (%SS_UQA,KI$FEI.BDU# );

   6666  1 000415   200025 236100                    LDQ     FEI$,,AUTO
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:243  
         1 000416   000012 036000 2                  ADLQ    10
         1 000417   000013 235000 2                  LDA     11
         1 000420   200110 757100                    STAQ    K$RWPARM+40,,AUTO
         1 000421   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000422   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000423   000000 701000 xent               TSX1    SSR$RUE
         1 000424   000000 011000                    NOP     0

     1331     6667    2        END;

     1332     6668
     1333     6669    1        KL_FEPST.FEP = KI$FEI.FEP#;

   6669  1 000425   200025 470500                    LDP0    FEI$,,AUTO
         1 000426   000012 236100                    LDQ     10,,PR0
         1 000427   000011 736000                    QLS     9
         1 000430   200021 552120                    STBQ    KL_FEPST,'20'O,AUTO

     1334     6670    1        KL_FEPST.FCN = IGA_FEPST;

   6670  1 000431   040000 236003                    LDQ     16384,DU
         1 000432   200021 552140                    STBQ    KL_FEPST,'40'O,AUTO

     1335     6671    1        KL_FEPST.PROB = KI$FEI.PBST.PROB ;

   6671  1 000433   000015 220100                    LDX0    13,,PR0
         1 000434   200021 440100                    SXL0    KL_FEPST,,AUTO

     1336     6672    1        KL_FEPST.STATE = KI$FEI.PBST.STATE ;

   6672  1 000435   000015 721100                    LXL1    13,,PR0
         1 000436   200022 741100                    STX1    KL_FEPST+1,,AUTO

     1337     6673    1        CALL KUB$WRITE (KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN') WHENALTRETURN

   6673  1 000437   000015 236000 2                  LDQ     13
         1 000440   200112 756100                    STQ     K$RWPARM+42,,AUTO
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:244  
         1 000441   000016 236000 2                  LDQ     14
         1 000442   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000443   200021 631500                    EPPR1   KL_FEPST,,AUTO
         1 000444   200110 451500                    STP1    K$RWPARM+40,,AUTO
         1 000445   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000446   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000447   000000 701000 xent               TSX1    KUB$WRITE
         1 000450   000452 702000 1                  TSX2    s:6675
         1 000451   000466 710000 1                  TRA     s:6677

     1338     6674    2          DO ;

     1339     6675    2             CALL SSC$MONTIMR (SEC5,ENTADDR(KIQ$TELL),FEI);

   6675  1 000452   000770 636000 1                  EAQ     s:6751
         1 000453   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000454   200003 236100                    LDQ     @FEI,,AUTO
         1 000455   200113 756100                    STQ     K$RWPARM+43,,AUTO
         1 000456   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000457   200112 450500                    STP0    K$RWPARM+42,,AUTO
         1 000460   000003 236000 2                  LDQ     3
         1 000461   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000462   200111 630500                    EPPR0   K$RWPARM+41,,AUTO
         1 000463   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000464   000000 701000 xent               TSX1    SSC$MONTIMR
         1 000465   000000 011000                    NOP     0

     1340     6676    2          END;

     1341     6677    1        FCR.FENM.PROBLEM=KI$FEI.PBST.PROB ;

   6677  1 000466   200025 470500                    LDP0    FEI$,,AUTO
         1 000467   000015 236100                    LDQ     13,,PR0
         1 000470   000011 772000                    QRL     9
         1 000471   200014 552110                    STBQ    FCR,'10'O,AUTO

     1342     6678    1        FCR.FENM.STATE=KI$FEI.PBST.STATE ;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:245  

   6678  1 000472   000015 236100                    LDQ     13,,PR0
         1 000473   200014 552104                    STBQ    FCR,'04'O,AUTO

     1343     6679    1        FCR.FENM.FEP#=KI$FEI.FEP#;

   6679  1 000474   000012 236100                    LDQ     10,,PR0
         1 000475   000011 772000                    QRL     9
         1 000476   000777 376007                    ANQ     511,DL
         1 000477   200015 756100                    STQ     FCR+1,,AUTO

     1344     6680    1        CALL KIN$CONV_NODE(FCR.FENM.NODENAME,FCR.FENM.FEP#);

   6680  1 000500   200015 631500                    EPPR1   FCR+1,,AUTO
         1 000501   200111 451500                    STP1    K$RWPARM+41,,AUTO
         1 000502   200016 633500                    EPPR3   FCR+2,,AUTO
         1 000503   200110 453500                    STP3    K$RWPARM+40,,AUTO
         1 000504   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000505   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000506   000000 701000 xent               TSX1    KIN$CONV_NODE
         1 000507   000000 011000                    NOP     0

     1345     6681    1        FCR.FENM.CRASH# = KI$FEI.SEQ;

   6681  1 000510   200025 470500                    LDP0    FEI$,,AUTO
         1 000511   000007 236100                    LDQ     7,,PR0
         1 000512   177000 376003                    ANQ     65024,DU
         1 000513   000011 772000                    QRL     9
         1 000514   200014 552120                    STBQ    FCR,'20'O,AUTO

     1346     6682    1        FCR.FENM.DEVADDR=KI$FEI.FECH ;

   6682  1 000515   000002 236100                    LDQ     2,,PR0
         1 000516   200014 552140                    STBQ    FCR,'40'O,AUTO

     1347     6683    1        CALL ELA$SYSLOG (EL_FEPCRASH,FCR,SIZEW(FCR),'0'B,1,TEMP);

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:246  
   6683  1 000517   200031 631500                    EPPR1   TEMP,,AUTO
         1 000520   200115 451500                    STP1    K$RWPARM+45,,AUTO
         1 000521   000006 236000 2                  LDQ     6
         1 000522   200114 756100                    STQ     K$RWPARM+44,,AUTO
         1 000523   000020 237000 2                  LDAQ    16
         1 000524   200112 757100                    STAQ    K$RWPARM+42,,AUTO
         1 000525   200014 633500                    EPPR3   FCR,,AUTO
         1 000526   200111 453500                    STP3    K$RWPARM+41,,AUTO
         1 000527   000022 236000 2                  LDQ     18
         1 000530   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000531   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000532   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 000533   000000 701000 xent               TSX1    ELA$SYSLOG
         1 000534   000000 011000                    NOP     0

     1348     6684             %UNLOCK (G=TLOCK);

   6685  1 000535   200032 630500                    EPPR0   TLOCK,,AUTO
         1 000536   200110 450500                    STP0    K$RWPARM+40,,AUTO
         1 000537   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000540   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000541   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000542   000000 011000                    NOP     0

     1349     6687    1        RETURN;

   6687  1 000543   000000 702200 xent               TSX2  ! X66_ARET

     1350     6688
     1351     6689    1   KIQ$FESTOP: ENTRY (FEI,PROB);

   6689  1 000544   000000 700200 xent  KIQ$FESTOP   TSX0  ! X66_AUTO_2
         1 000545   000116 000002                    ZERO    78,2

     1352     6690
     1353     6691    1        STOPFLG='1'B;

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:247  
   6691  1 000546   400000 236003                    LDQ     -131072,DU
         1 000547   200036 756100                    STQ     STOPFLG,,AUTO

     1354     6692    1        GOTO ABT;

   6692  1 000550   000003 710000 1                  TRA     ABT

     1355     6693
     1356     6694    1   KIQ$MASKFEP: ENTRY ( FEI ) ;

   6694  1 000551   000000 700200 xent  KIQ$MASKFEP  TSX0  ! X66_AUTO_2
         1 000552   000116 000002                    ZERO    78,2

     1357     6695
     1358     6696        /* This entry should only be used by KIQ$FEABT for stopping FEPs.
     1359     6697           It is entered after a 5 second wait so that COUPLER has a chance
     1360     6698           to read the CNOP command before the channel is masked. */
     1361     6699
     1362     6700    1        FEI$ = KI$FEI$ ( FEI ) ;

   6700  1 000553   200003 470500                    LDP0    @FEI,,AUTO
         1 000554   000000 720100                    LXL0    0,,PR0
         1 000555   000000 471400 xsym               LDP1    KI_FEI$$
         1 000556   100000 236110                    LDQ     0,X0,PR1
         1 000557   200025 756100                    STQ     FEI$,,AUTO

     1363     6701             %LOCK ( G = KI$FEI.LOCK ) ;

   6702  1 000560   200025 630500                    EPPR0   FEI$,,AUTO
         1 000561   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000562   000000 701000 xent               TSX1    HFC$LOCK
         1 000563   000000 011000                    NOP     0

     1364     6704    1        IF KI$FEI.FEST = KIST_STOPPING

   6704  1 000564   200025 470500                    LDP0    FEI$,,AUTO
         1 000565   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:248  
         1 000566   000777 376003                    ANQ     511,DU
         1 000567   000010 116003                    CMPQ    8,DU
         1 000570   000610 601000 1                  TNZ     s:6710

     1365     6705    2        THEN DO ;

     1366     6706    2             CALL NIS$DCCON ( KI$FEI.FECH , '4'O , KI$FEI.FEWSQ ) ;

   6706  1 000571   200025 236100                    LDQ     FEI$,,AUTO
         1 000572   000005 036003                    ADLQ    5,DU
         1 000573   200112 756100                    STQ     K$RWPARM+42,,AUTO
         1 000574   000023 236000 2                  LDQ     19
         1 000575   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000576   200025 236100                    LDQ     FEI$,,AUTO
         1 000577   000002 036003                    ADLQ    2,DU
         1 000600   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000601   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000602   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000603   000000 701000 xent               TSX1    NIS$DCCON
         1 000604   000000 011000                    NOP     0

     1367     6707    2             KI$FEI.FEST = KIST_MASKED ;

   6707  1 000605   200025 470500                    LDP0    FEI$,,AUTO
         1 000606   000007 236003                    LDQ     7,DU
         1 000607   000002 552120                    STBQ    2,'20'O,PR0

     1368     6708    2          END ;

     1369     6709             %UNLOCK ( G = KI$FEI.LOCK ) ;

   6710  1 000610   200025 630500                    EPPR0   FEI$,,AUTO
         1 000611   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000612   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000613   000000 011000                    NOP     0

     1370     6712    1        RETURN ;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:249  

   6712  1 000614   000000 702200 xent               TSX2  ! X66_ARET

     1371     6713
     1372     6714    1   KIQ$PARTFEP: ENTRY (FEI,PROB);

   6714  1 000615   000000 700200 xent  KIQ$PARTFEP  TSX0  ! X66_AUTO_2
         1 000616   000116 000002                    ZERO    78,2

     1373     6715
     1374     6716    1        FEI$ = KI$FEI$(FEI);

   6716  1 000617   200003 470500                    LDP0    @FEI,,AUTO
         1 000620   000000 720100                    LXL0    0,,PR0
         1 000621   000000 471400 xsym               LDP1    KI_FEI$$
         1 000622   100000 236110                    LDQ     0,X0,PR1
         1 000623   200025 756100                    STQ     FEI$,,AUTO

     1375     6717    2        IF IT_CP6UP = 0 THEN DO ;

   6717  1 000624   000000 235000 xsym               LDA     IT_CP6UP
         1 000625   000634 601000 1                  TNZ     s:6722

     1376     6718    2             KI$FEI.PBST.PROB = KIER_PART ;

   6718  1 000626   000016 221003                    LDX1    14,DU
         1 000627   200025 473500                    LDP3    FEI$,,AUTO
         1 000630   300015 741100                    STX1    13,,PR3

     1377     6719    2             KI$FEI.FEST = KIST_DN ;

   6719  1 000631   000000 236003                    LDQ     0,DU
         1 000632   300002 552120                    STBQ    2,'20'O,PR3

     1378     6720    2          END ;

   6720  1 000633   000705 710000 1                  TRA     s:6733
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:250  

     1379     6721    2        ELSE DO ;

     1380     6722    2             IF KI$FEI.FEST ~= KIST_DN AND KI$FEI.FEST ~= KIST_MASKED THEN

   6722  1 000634   200025 473500                    LDP3    FEI$,,AUTO
         1 000635   300002 236100                    LDQ     2,,PR3
         1 000636   000777 316003                    CANQ    511,DU
         1 000637   000644 600000 1                  TZE     s:6724
         1 000640   300002 236100                    LDQ     2,,PR3
         1 000641   000777 376003                    ANQ     511,DU
         1 000642   000007 116003                    CMPQ    7,DU
         1 000643   000002 601000 1                  TNZ     FEABT

     1381     6723    2                GOTO FEABT ;
     1382     6724    2             KI$FEI.FEST = KIST_MASKED;
              6724                      /* mask the feps to keep rload int from getting through */

   6724  1 000644   000007 236003                    LDQ     7,DU
         1 000645   300002 552120                    STBQ    2,'20'O,PR3

     1383     6725    2             KI$FEI.PBST.PROB =KIER_PART;

   6725  1 000646   000016 220003                    LDX0    14,DU
         1 000647   300015 740100                    STX0    13,,PR3

     1384     6726    2             KL_FEPST.FEP = KI$FEI.FEP#;

   6726  1 000650   300012 236100                    LDQ     10,,PR3
         1 000651   000011 736000                    QLS     9
         1 000652   200021 552120                    STBQ    KL_FEPST,'20'O,AUTO

     1385     6727    2             KL_FEPST.FCN = IGA_FEPST;

   6727  1 000653   040000 236003                    LDQ     16384,DU
         1 000654   200021 552140                    STBQ    KL_FEPST,'40'O,AUTO

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:251  
     1386     6728    2             KL_FEPST.PROB = KIER_PART;

   6728  1 000655   200021 440100                    SXL0    KL_FEPST,,AUTO

     1387     6729    3             CALL KUB$WRITE(KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN') WHENALTRETURN DO ;

   6729  1 000656   000015 236000 2                  LDQ     13
         1 000657   200112 756100                    STQ     K$RWPARM+42,,AUTO
         1 000660   000016 236000 2                  LDQ     14
         1 000661   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000662   200021 634500                    EPPR4   KL_FEPST,,AUTO
         1 000663   200110 454500                    STP4    K$RWPARM+40,,AUTO
         1 000664   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000665   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000666   000000 701000 xent               TSX1    KUB$WRITE
         1 000667   000671 702000 1                  TSX2    s:6730
         1 000670   000705 710000 1                  TRA     s:6733

     1388     6730    3                  CALL SSC$MONTIMR (SEC5,ENTADDR(KIQ$TELL),FEI) ;

   6730  1 000671   000770 636000 1                  EAQ     s:6751
         1 000672   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000673   200003 236100                    LDQ     @FEI,,AUTO
         1 000674   200113 756100                    STQ     K$RWPARM+43,,AUTO
         1 000675   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000676   200112 450500                    STP0    K$RWPARM+42,,AUTO
         1 000677   000003 236000 2                  LDQ     3
         1 000700   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000701   200111 630500                    EPPR0   K$RWPARM+41,,AUTO
         1 000702   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000703   000000 701000 xent               TSX1    SSC$MONTIMR
         1 000704   000000 011000                    NOP     0

     1389     6731    3               END ;

     1390     6732    2          END ;

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:252  
     1391     6733    1        RETURN;

   6733  1 000705   000000 702200 xent               TSX2  ! X66_ARET

     1392     6734
     1393     6735    1   KIQ$UPRTFEP: ENTRY (FEI);

   6735  1 000706   000000 700200 xent  KIQ$UPRTFEP  TSX0  ! X66_AUTO_2
         1 000707   000116 000002                    ZERO    78,2

     1394     6736
     1395     6737    1        FEI$ = KI$FEI$(FEI);

   6737  1 000710   200003 470500                    LDP0    @FEI,,AUTO
         1 000711   000000 720100                    LXL0    0,,PR0
         1 000712   000000 471400 xsym               LDP1    KI_FEI$$
         1 000713   100000 236110                    LDQ     0,X0,PR1
         1 000714   200025 756100                    STQ     FEI$,,AUTO

     1396     6738    1        IF KI$FEI.PBST.PROB ~=KIER_PART THEN RETURN;

   6738  1 000715   200025 473500                    LDP3    FEI$,,AUTO
         1 000716   300015 221100                    LDX1    13,,PR3
         1 000717   000016 101003                    CMPX1   14,DU
         1 000720   000722 600000 1                  TZE     s:6739

   6738  1 000721   000000 702200 xent               TSX2  ! X66_ARET

     1397     6739    1        KI$FEI.PBST.PROB =KIER_UPRT;

   6739  1 000722   000017 222003                    LDX2    15,DU
         1 000723   300015 742100                    STX2    13,,PR3

     1398     6740    1        KL_FEPST.FEP = KI$FEI.FEP#;

   6740  1 000724   300012 236100                    LDQ     10,,PR3
         1 000725   000011 736000                    QLS     9
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:253  
         1 000726   200021 552120                    STBQ    KL_FEPST,'20'O,AUTO

     1399     6741    1        KL_FEPST.FCN = IGA_FEPST;

   6741  1 000727   040000 236003                    LDQ     16384,DU
         1 000730   200021 552140                    STBQ    KL_FEPST,'40'O,AUTO

     1400     6742    1        KL_FEPST.PROB = KIER_UPRT;

   6742  1 000731   200021 442100                    SXL2    KL_FEPST,,AUTO

     1401     6743    1        KL_FEPST.STATE = KIER_OK;

   6743  1 000732   000000 220003                    LDX0    0,DU
         1 000733   200022 740100                    STX0    KL_FEPST+1,,AUTO

     1402     6744    1        IF HW_IMX THEN

   6744  1 000734   000000 234000 xsym               SZN     HW_IMX
         1 000735   000752 605000 1                  TPL     s:6746

     1403     6745    1           CALL NIS$DCCON (KI$FEI.FECH,'2'O,KI$FEI.FEWSQ); /* INIT DIRECT CHANNEL */

   6745  1 000736   200025 236100                    LDQ     FEI$,,AUTO
         1 000737   000005 036003                    ADLQ    5,DU
         1 000740   200112 756100                    STQ     K$RWPARM+42,,AUTO
         1 000741   000025 236000 2                  LDQ     21
         1 000742   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000743   200025 236100                    LDQ     FEI$,,AUTO
         1 000744   000002 036003                    ADLQ    2,DU
         1 000745   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 000746   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000747   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000750   000000 701000 xent               TSX1    NIS$DCCON
         1 000751   000000 011000                    NOP     0

     1404     6746    1        CALL KUB$WRITE (KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN');
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:254  

   6746  1 000752   000015 236000 2                  LDQ     13
         1 000753   200112 756100                    STQ     K$RWPARM+42,,AUTO
         1 000754   000016 236000 2                  LDQ     14
         1 000755   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 000756   200021 630500                    EPPR0   KL_FEPST,,AUTO
         1 000757   200110 450500                    STP0    K$RWPARM+40,,AUTO
         1 000760   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 000761   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000762   000000 701000 xent               TSX1    KUB$WRITE
         1 000763   000000 011000                    NOP     0

     1405     6747    1        KI$FEI.PBST.PROB =KIER_OK;

   6747  1 000764   000000 220003                    LDX0    0,DU
         1 000765   200025 470500                    LDP0    FEI$,,AUTO
         1 000766   000015 740100                    STX0    13,,PR0

     1406     6748    1        RETURN;

   6748  1 000767   000000 702200 xent               TSX2  ! X66_ARET

     1407     6749
     1408     6750
     1409     6751    1   KIQ$TELL: ENTRY (FEI);

   6751  1 000770   000000 700200 xent  KIQ$TELL     TSX0  ! X66_AUTO_2
         1 000771   000116 000002                    ZERO    78,2

     1410     6752    1        FEI$ = KI$FEI$(FEI);

   6752  1 000772   200003 470500                    LDP0    @FEI,,AUTO
         1 000773   000000 720100                    LXL0    0,,PR0
         1 000774   000000 471400 xsym               LDP1    KI_FEI$$
         1 000775   100000 236110                    LDQ     0,X0,PR1
         1 000776   200025 756100                    STQ     FEI$,,AUTO

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:255  
     1411     6753    1        KL_FEPST.FEP = KI$FEI.FEP#;

   6753  1 000777   200025 473500                    LDP3    FEI$,,AUTO
         1 001000   300012 236100                    LDQ     10,,PR3
         1 001001   000011 736000                    QLS     9
         1 001002   200021 552120                    STBQ    KL_FEPST,'20'O,AUTO

     1412     6754    1        KL_FEPST.FCN = IGA_FEPST;

   6754  1 001003   040000 236003                    LDQ     16384,DU
         1 001004   200021 552140                    STBQ    KL_FEPST,'40'O,AUTO

     1413     6755    1        KL_FEPST.PROB = KI$FEI.PBST.PROB ;

   6755  1 001005   300015 220100                    LDX0    13,,PR3
         1 001006   200021 440100                    SXL0    KL_FEPST,,AUTO

     1414     6756    1        KL_FEPST.STATE = KI$FEI.PBST.STATE ;

   6756  1 001007   300015 721100                    LXL1    13,,PR3
         1 001010   200022 741100                    STX1    KL_FEPST+1,,AUTO

     1415     6757    1        CALL KUB$WRITE (KL_FEPST,LENGTHC(KL_FEPST),'HLPADMIN') WHENALTRETURN

   6757  1 001011   000015 236000 2                  LDQ     13
         1 001012   200112 756100                    STQ     K$RWPARM+42,,AUTO
         1 001013   000016 236000 2                  LDQ     14
         1 001014   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 001015   200021 634500                    EPPR4   KL_FEPST,,AUTO
         1 001016   200110 454500                    STP4    K$RWPARM+40,,AUTO
         1 001017   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 001020   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001021   000000 701000 xent               TSX1    KUB$WRITE
         1 001022   001024 702000 1                  TSX2    s:6759
         1 001023   001040 710000 1                  TRA     s:6761

     1416     6758    2          DO ;
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:256  

     1417     6759    2             CALL SSC$MONTIMR (SEC5,ENTADDR(KIQ$TELL),FEI);

   6759  1 001024   000770 636000 1                  EAQ     s:6751
         1 001025   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 001026   200003 236100                    LDQ     @FEI,,AUTO
         1 001027   200113 756100                    STQ     K$RWPARM+43,,AUTO
         1 001030   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 001031   200112 450500                    STP0    K$RWPARM+42,,AUTO
         1 001032   000003 236000 2                  LDQ     3
         1 001033   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 001034   200111 630500                    EPPR0   K$RWPARM+41,,AUTO
         1 001035   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001036   000000 701000 xent               TSX1    SSC$MONTIMR
         1 001037   000000 011000                    NOP     0

     1418     6760    2          END;

     1419     6761    1        RETURN;

   6761  1 001040   000000 702200 xent               TSX2  ! X66_ARET

     1420     6762
     1421     6763
     1422     6764    1   KIQ$LGFEDN: ENTRY (FEI);

   6764  1 001041   000000 700200 xent  KIQ$LGFEDN   TSX0  ! X66_AUTO_2
         1 001042   000116 000002                    ZERO    78,2

     1423     6765
     1424     6766    2        CALL ELA$SYSLOG (EL_FEGN,FEI,1,'0'B,2,TEMP) WHENALTRETURN DO ;

   6766  1 001043   200031 630500                    EPPR0   TEMP,,AUTO
         1 001044   200115 450500                    STP0    K$RWPARM+45,,AUTO
         1 001045   000004 236000 2                  LDQ     4
         1 001046   200114 756100                    STQ     K$RWPARM+44,,AUTO
         1 001047   000006 237000 2                  LDAQ    6
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:257  
         1 001050   200112 757100                    STAQ    K$RWPARM+42,,AUTO
         1 001051   200003 236100                    LDQ     @FEI,,AUTO
         1 001052   000010 235000 2                  LDA     8
         1 001053   200110 757100                    STAQ    K$RWPARM+40,,AUTO
         1 001054   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 001055   000024 631400 xsym               EPPR1   B_VECTNIL+20
         1 001056   000000 701000 xent               TSX1    ELA$SYSLOG
         1 001057   001061 702000 1                  TSX2    s:6767
         1 001060   001075 710000 1                  TRA     s:6769

     1425     6767    2             CALL SSC$MONTIMR ( SEC5 , ENTADDR(KIQ$LGFEDN) , FEI ) ;

   6767  1 001061   001041 636000 1                  EAQ     s:6764
         1 001062   200110 756100                    STQ     K$RWPARM+40,,AUTO
         1 001063   200003 236100                    LDQ     @FEI,,AUTO
         1 001064   200113 756100                    STQ     K$RWPARM+43,,AUTO
         1 001065   200110 630500                    EPPR0   K$RWPARM+40,,AUTO
         1 001066   200112 450500                    STP0    K$RWPARM+42,,AUTO
         1 001067   000003 236000 2                  LDQ     3
         1 001070   200111 756100                    STQ     K$RWPARM+41,,AUTO
         1 001071   200111 630500                    EPPR0   K$RWPARM+41,,AUTO
         1 001072   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001073   000000 701000 xent               TSX1    SSC$MONTIMR
         1 001074   000000 011000                    NOP     0

     1426     6768    2          END ;

     1427     6769    1        RETURN;

   6769  1 001075   000000 702200 xent               TSX2  ! X66_ARET

INTL6
 Sect OctLoc
   0     000   000000 000371                                                    ....

(unnamed)
 Sect OctLoc
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:258  
   0     001   000003 000000   000003 000005   110114 120101   104115 111116    ........HLPADMIN

(unnamed)
 Sect OctLoc
   2     000   777777 777077   777777 770777   000000 000764   000002 006000    ...?............
   2     004   000004 006000   000000 000000   000003 006000   000002 006000    ................
   2     010   000006 006000   000000 000034   000007 200000   000011 006000    ................
   2     014   000000 000016   000003 006000   000014 006000   000000 000460    ................
   2     020   000007 006000   000002 006000   000017 006000   000030 006000    ................
   2     024   200000 000000   000024 006000                                    ........
     1428     6770
     1429     6771
     1430     6772
     1431     6773
     1432     6774
     1433     6775    1   END KIQ$FEABT;
     1434     6776        %EOD;

PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:259  
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   KJ_FCNS_C.:E05TOU  is referenced.
   K_SUBS_C.:E05TOU  is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   K$RWPARM.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   KL_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   EL$TABLES.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$FEABT.
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:260  

 **** Variables and constants ****

  ****  Section 000 RoData KIQ$FEABT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 INTL6

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FEI                       4-0-0/w PTR         r     1 @PROB
    14-0-0/w STRC(180)   r     1 FCR                       *0-0-0/w UBIN        r     1 FEI
    25-0-0/w PTR         r     1 FEI$                      27-0-0/w PTR         r     1 ICQ$
    40-0-0/d STRC(1404)  r     1 K$RWPARM                   5-0-0/w STRC(252)   r     1 KL_ACCTNG
    21-0-0/w STRC(126)   r     1 KL_FEPST                  30-0-0/w PTR         r     1 OCQ$
    *0-0-0/w UBIN        r     1 PROB                      36-0-0/w BIT         r     1 STOPFLG
    31-0-0/w UBIN        r     1 TEMP                      32-0-0/b BIT (72)    r     1 TLOCK

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT         r     1 HW_IMX                     0-0-0/w UBIN        r     1 IT_CP6UP
     0-0-0/w PTR         r     1 KI_FEI$$                   0-0-0/d STRC(1404)  r     1 K_RWPARM_CON

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 KI$CCMD                    0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:261  
     0-0-0/d STRC(576)   r     1 KI$QHDR


   Procedure KIQ$FEABT requires 574 words for executable code.
   Procedure KIQ$FEABT requires 78 words of local(AUTO) storage.
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:262  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:263  
          MINI XREF LISTING

ABT
      6576**LABEL    6692--GOTO
ELA$SYSLOG
      6251**DCL-ENT  6650--CALL     6683--CALL     6766--CALL
FCR
      5782**DCL      6683<>CALL     6683--CALL
FCR.FENM.CRASH#
      5782**DCL      6681<<ASSIGN
FCR.FENM.DEVADDR
      5782**DCL      6682<<ASSIGN
FCR.FENM.FEP#
      5783**DCL      6679<<ASSIGN   6680<>CALL
FCR.FENM.NODENAME
      5783**DCL      6680<>CALL
FCR.FENM.PROBLEM
      5782**DCL      6677<<ASSIGN
FCR.FENM.STATE
      5782**DCL      6678<<ASSIGN
FEABT
      6570**LABEL    6723--GOTO
FEI
      5908**DCL         8--PROC     6578>>ASSIGN   6639<>CALL     6644>>ASSIGN   6675<>CALL     6689--ENTRY
      6694--ENTRY    6700>>ASSIGN   6714--ENTRY    6716>>ASSIGN   6730<>CALL     6735--ENTRY    6737>>ASSIGN
      6751--ENTRY    6752>>ASSIGN   6759<>CALL     6764--ENTRY    6766<>CALL     6767<>CALL
FEI$
      5909**DCL      5834--IMP-PTR  6578<<ASSIGN   6579>>IF       6581>>ASSIGN   6582>>ASSIGN   6587>>CALL
      6591>>ASSIGN   6622>>CALL     6622>>CALL     6627>>ASSIGN   6628>>ASSIGN   6628>>ASSIGN   6630>>ASSIGN
      6632>>ASSIGN   6634>>ASSIGN   6640>>DOCASE   6646>>ASSIGN   6655>>IF       6658>>ASSIGN   6659>>CALL
      6659>>CALL     6660>>IF       6661>>CALL     6662>>ASSIGN   6665>>CALL     6665>>CALL     6666>>CALL
      6669>>ASSIGN   6671>>ASSIGN   6672>>ASSIGN   6677>>ASSIGN   6678>>ASSIGN   6679>>ASSIGN   6681>>ASSIGN
      6682>>ASSIGN   6700<<ASSIGN   6702>>CALL     6704>>IF       6706>>CALL     6706>>CALL     6707>>ASSIGN
      6710>>CALL     6716<<ASSIGN   6718>>ASSIGN   6719>>ASSIGN   6722>>IF       6722>>IF       6724>>ASSIGN
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:264  
      6725>>ASSIGN   6726>>ASSIGN   6737<<ASSIGN   6738>>IF       6739>>ASSIGN   6740>>ASSIGN   6745>>CALL
      6745>>CALL     6747>>ASSIGN   6752<<ASSIGN   6753>>ASSIGN   6755>>ASSIGN   6756>>ASSIGN
HFC$LOCK
      4844**DCL-ENT  6585--CALL     6589--CALL     6702--CALL
HFC$UNLOCK
      4844**DCL-ENT  6636--CALL     6685--CALL     6710--CALL
HW_IMX
      5572**DCL      6744>>IF
ICQ$
      5912**DCL      6581<<ASSIGN   6625>>ASSIGN
INTL6
      5733**DCL      6597>>ASSIGN
INTL6.L66INT
      5741**DCL      5742--REDEF    5746--REDEF
INTL6.L6INT
      5739**DCL      5740--REDEF
IT_CP6UP
      5907**DCL      6717>>IF
K$RWPARM
      5946**DCL      6642<<ASSIGN   6645<>CALL
K$RWPARM.BLKREC
      5972**DCL      5997--REDEF
K$RWPARM.BLKREC.BLKU#
      5973**DCL      5975--REDEF
K$RWPARM.BLKREC.RECU#
      5985**DCL      5987--REDEF
K$RWPARM.DVE.DVBYTE.VFC
      6012**DCL      6013--REDEF
K$RWPARM.DVE.EOMCHAR
      6020**DCL      6024--REDEF
K$RWPARM.ERR
      6084**DCL      6089--REDEF
K$RWPARM.FC
      6048**DCL      6049--REDEF
K$RWPARM.FEX
      6130**DCL      6644<<ASSIGN
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:265  
K$RWPARM.FLDID
      6230**DCL      6231--REDEF
K$RWPARM.FPT$
      6111**DCL      6118--REDEF
K$RWPARM.FUNCTION
      6125**DCL      6643<<ASSIGN
K$RWPARM.KEYTYPE
      6237**DCL      6238--REDEF
K$RWPARM.MSG$
      5947**DCL      5953--REDEF
K$RWPARM.MSGID
      6059**DCL      6064--REDEF
K$RWPARM.MSGIDXT
      6072**DCL      6076--REDEF
K$RWPARM.ORG
      6208**DCL      6209--REDEF
K$RWPARM.THDRSZ
      6152**DCL      6156--REDEF
K$RWPARM.VDOFLGS
      6210**DCL      6221--REDEF
KI$CCMD.L66INT
      5762**DCL      5763--REDEF    5764--REDEF
KI$CCMD.L6INT
      5759**DCL      5761--REDEF    6615<<ASSIGN
KI$CCMD.L6PARM
      5763**DCL      6601<<ASSIGN   6604<<ASSIGN   6607<<ASSIGN   6610<<ASSIGN   6614<<ASSIGN
KI$FEI.BD$
      5869**DCL      5870--REDEF    6659<>CALL     6665<>CALL
KI$FEI.BDAD.WADDR
      5871**DCL      5872--REDEF
KI$FEI.BDARS
      5877**DCL      6658<<ASSIGN
KI$FEI.BDU#
      5867**DCL      6655>>IF       6660>>IF       6661<>CALL     6662<<ASSIGN   6666<>CALL
KI$FEI.FECH
      5836**DCL      6622<>CALL     6682>>ASSIGN   6706<>CALL     6745<>CALL
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:266  
KI$FEI.FEP#
      5879**DCL      6646>>ASSIGN   6669>>ASSIGN   6679>>ASSIGN   6726>>ASSIGN   6740>>ASSIGN   6753>>ASSIGN
KI$FEI.FEST
      5839**DCL      6579>>IF       6628>>ASSIGN   6630<<ASSIGN   6632<<ASSIGN   6634<<ASSIGN   6704>>IF
      6707<<ASSIGN   6719<<ASSIGN   6722>>IF       6722>>IF       6724<<ASSIGN
KI$FEI.FEWSQ
      5862**DCL      6622<>CALL     6659<>CALL     6665<>CALL     6706<>CALL     6745<>CALL
KI$FEI.ICQ$
      5856**DCL      6581>>ASSIGN
KI$FEI.LOCK
      5835**DCL      6702<>CALL     6710<>CALL
KI$FEI.OCQ$
      5850**DCL      6582>>ASSIGN
KI$FEI.PBST.PROB
      5887**DCL      6591<<ASSIGN   6671>>ASSIGN   6677>>ASSIGN   6718<<ASSIGN   6725<<ASSIGN   6738>>IF
      6739<<ASSIGN   6747<<ASSIGN   6755>>ASSIGN
KI$FEI.PBST.STATE
      5891**DCL      6628<<ASSIGN   6640>>DOCASE   6672>>ASSIGN   6678>>ASSIGN   6756>>ASSIGN
KI$FEI.PTPPNO#
      5884**DCL      6587<>CALL
KI$FEI.QFLHD$
      5898**DCL      6627<<ASSIGN
KI$FEI.RCVPB
      5885**DCL      5886--REDEF
KI$FEI.SEQ
      5866**DCL      6681>>ASSIGN
KI$FEI$
      3976**DCL      6578>>ASSIGN   6700>>ASSIGN   6716>>ASSIGN   6737>>ASSIGN   6752>>ASSIGN
KI$QHDR.BDCTL.MLCPZ
        60**DCL      6658>>ASSIGN
KI$QHDR.CCMD
        50**DCL      6597<<ASSIGN   6601--ASSIGN   6604--ASSIGN   6607--ASSIGN   6610--ASSIGN   6614--ASSIGN
      6615--ASSIGN
KI$QHDR.GATE
        71**DCL      6589<>CALL     6636<>CALL
KI$QHDR.INTLOCK
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:267  
        68**DCL      6625<<ASSIGN   6626<<ASSIGN
KIN$CONV_NODE
      6246**DCL-ENT  6680--CALL
KIN$RECV
      6247**DCL-ENT  6645--CALL
KIQ$LGFEDN
      6764**ENTRY    6651--CALL     6767--CALL
KIQ$MASKFEP
      6694**ENTRY    6639--CALL
KIQ$TELL
      6751**ENTRY    6675--CALL     6730--CALL     6759--CALL
KI_FEI$$
      3975**DCL      3976--IMP-PTR  6578>>ASSIGN   6700>>ASSIGN   6716>>ASSIGN   6737>>ASSIGN   6752>>ASSIGN
KL_ACCTNG
      5768**DCL      6650<>CALL     6651<>CALL
KL_ACCTNG.DEVNM
      5772**DCL      5773--REDEF
KL_ACCTNG.FEX
      5769**DCL      6646<<ASSIGN
KL_ACCTNG.REASON
      5770**DCL      6648<<ASSIGN   6649<<ASSIGN
KL_FEPST
      5799**DCL      6673<>CALL     6673--CALL     6729<>CALL     6729--CALL     6746<>CALL     6746--CALL
      6757<>CALL     6757--CALL
KL_FEPST.FCN
      5800**DCL      6670<<ASSIGN   6727<<ASSIGN   6741<<ASSIGN   6754<<ASSIGN
KL_FEPST.FEP
      5802**DCL      6669<<ASSIGN   6726<<ASSIGN   6740<<ASSIGN   6753<<ASSIGN
KL_FEPST.PROB
      5813**DCL      6671<<ASSIGN   6728<<ASSIGN   6742<<ASSIGN   6755<<ASSIGN
KL_FEPST.STATE
      5814**DCL      6672<<ASSIGN   6743<<ASSIGN   6756<<ASSIGN
KUB$WRITE
      6244**DCL-ENT  6673--CALL     6729--CALL     6746--CALL     6757--CALL
K_RWPARM_CON
      6277**DCL      6642>>ASSIGN
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:268  
K_RWPARM_CON.BLKREC
      6303**DCL      6328--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      6304**DCL      6306--REDEF
K_RWPARM_CON.BLKREC.RECU#
      6316**DCL      6318--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      6343**DCL      6344--REDEF
K_RWPARM_CON.DVE.EOMCHAR
      6351**DCL      6355--REDEF
K_RWPARM_CON.ERR
      6415**DCL      6420--REDEF
K_RWPARM_CON.FC
      6379**DCL      6380--REDEF
K_RWPARM_CON.FLDID
      6561**DCL      6562--REDEF
K_RWPARM_CON.FPT$
      6442**DCL      6449--REDEF
K_RWPARM_CON.KEYTYPE
      6568**DCL      6569--REDEF
K_RWPARM_CON.MSG$
      6278**DCL      6284--REDEF
K_RWPARM_CON.MSGID
      6390**DCL      6395--REDEF
K_RWPARM_CON.MSGIDXT
      6403**DCL      6407--REDEF
K_RWPARM_CON.ORG
      6539**DCL      6540--REDEF
K_RWPARM_CON.THDRSZ
      6483**DCL      6487--REDEF
K_RWPARM_CON.VDOFLGS
      6541**DCL      6552--REDEF
MMS$VREL
      6243**DCL-ENT  6659--CALL     6665--CALL
MMS$WSQMAP
      6249**DCL-ENT  6587--CALL
PL6.E3A0      #006=KIQ$FEABT File=KIQ$QMGR.:E05TSI                               WED 07/30/97 00:40 Page:269  
NIS$DCCON
      6245**DCL-ENT  6622--CALL     6706--CALL     6745--CALL
OCQ$
      5913**DCL      6582<<ASSIGN   6589>>CALL     6597>>ASSIGN   6601>>ASSIGN   6604>>ASSIGN   6607>>ASSIGN
      6610>>ASSIGN   6614>>ASSIGN   6615>>ASSIGN   6626>>ASSIGN   6636>>CALL     6658>>ASSIGN
PROB
      5910**DCL         8--PROC     6591>>ASSIGN   6594>>IF       6598>>DOCASE   6631>>IF       6638>>IF
      6689--ENTRY    6714--ENTRY
SSC$MONTIMR
      6252**DCL-ENT  6639--CALL     6651--CALL     6675--CALL     6730--CALL     6759--CALL     6767--CALL
SSR$RUE
      6250**DCL-ENT  6661--CALL     6666--CALL
STOPFLG
      5918**DCL      6576<<ASSIGN   6616<<ASSIGN   6619<<ASSIGN   6622<>CALL     6629>>IF       6647>>IF
      6691<<ASSIGN
TEMP
      5914**DCL      6650<>CALL     6683<>CALL     6766<>CALL
TLOCK
      5915**DCL      6583<<ASSIGN   6585<>CALL     6685<>CALL

PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:270  
     1435        1        /*T***********************************************************/
     1436        2        /*T*                                                         */
     1437        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1438        4        /*T*                                                         */
     1439        5        /*T***********************************************************/
     1440        6
     1441        7
     1442        8        KIQ$DMPINT: PROC (FEI);
     1443        9
     1444       10
     1445       11        %INCLUDE HF_LOCK_C;
     1446       25        %INCLUDE KI$QHDR;
     1447      177        %INCLUDE KI_DATA_R;
     1448      203        %INCLUDE KI_MACROS_C;
     1449      811        %INCLUDE S_WSPTD_R;
     1450      827        %INCLUDE SS_SCHED_C;
     1451     1060        %INCLUDE KI_SUBS_C;
     1452     1196
     1453     1197        %KI$CTCW (NAME=CTCW);
     1454     1205        %KI$CCMD (NAME=CCMD);
     1455     1220        %KI_CTCW(NAME=DMPTCW,TB=T);
     1456     1229        %KI_CCMD(NAME=DUMPL6,CMD=KIOP_DUMPL6);
     1457     1257        %KI$FEI (STCLASS="BASED(FEI$)");
     1458     1341
     1459     1342
     1460     1343    1   DCL FEI UBIN WORD;
     1461     1344    1   DCL FEI$ PTR;
     1462     1345    1   DCL OCQ$ PTR;
     1463     1346    1   DCL DMP$ PTR;
     1464     1347    1   DCL 1 DMPR REDEF DMP$ ALIGNED,
     1465     1348    1            2 WADDR UBIN(18) UNAL,
     1466     1349    1            2 * UBIN(18) UNAL;
     1467     1350    1   DCL MVSZ UBIN WORD;
     1468     1351    1   DCL MOVEE CHAR(MVSZ) BASED ALIGNED;
     1469     1352    1   DCL 1 MOVOR BASED ALIGNED,
     1470     1353    1            2 TCW UBIN WORD,
     1471     1354    1            2 DMP CHAR(MVSZ);
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:271  
     1472     1355    1   DCL REG_FLG BIT(1) ALIGNED;
     1473     1356    1   DCL SSR$REG ENTRY(3) ALTRET;
     1474     1357    1   DCL SSR$RUE ENTRY(4);
     1475     1358    1   DCL MMS$VREL ENTRY(2) ALTRET;
     1476     1359    1   DCL NIS$DCCON ENTRY(3);
     1477     1360    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
     1478     1361
     1479     1362
     1480     1363        /*X* DMR,PLM=5,IND=3,CTI=2,SDI=5,MCL=10,CSI=1,DTI=2,DCI=3,ECI=0,AND */
     1481     1364
     1482     1365
     1483     1366    1        FEI$ = KI$FEI$(FEI);
     1484     1367             %LOCK (G=KI$FEI.LOCK);
     1485     1370    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);
     1486     1371    2        DO INHIBIT;
     1487     1372    2           KI$FEI.FEST =KIST_DN;
     1488     1373    2        END;
     1489     1374    1        MVSZ=KI$FEI.BDCUR *4;
     1490     1375    1        DMP$=PINCRW(KI$FEI.BD$ ,KI$FEI.BDARS );
     1491     1376    1        DMP$->MOVEE=DMP$->MOVOR.DMP;
     1492     1377    1        KI$FEI.BDARS =KI$FEI.BDARS +KI$FEI.BDCUR ;
     1493     1378    1        IF KI$FEI.BDSZ <=KI$FEI.BDARS +SIZEW(CTCW) THEN
     1494     1379    2          DO ;
     1495     1380    2             CALL MMS$VREL (KI$FEI.FEWSQ ,KI$FEI.BD$ );
     1496     1381    2             CALL SSR$RUE (%SS_UQA,KI$FEI.BDU# );
     1497     1382                  %UNLOCK(G=KI$FEI.LOCK);
     1498     1385    2             RETURN;
     1499     1386    2          END;
     1500     1387    1        REG_FLG = '0'B;
     1501     1388    1        GOTO DUMPGO;
     1502     1389
     1503     1390    1   KIQ$DUMPGO: ENTRY (FEI);
     1504     1391
     1505     1392    1        REG_FLG = '1'B;
     1506     1393    1        FEI$ = KI$FEI$(FEI);
     1507     1394             %LOCK (G=KI$FEI.LOCK);
     1508     1397    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:272  
     1509     1398    1   DUMPGO: OCQ$=KI$FEI.OCQ$;
     1510     1399    1        IF KI$FEI.BDSZ -KI$FEI.BDARS >4096 THEN KI$FEI.BDCUR =4096;
     1511     1400    1        ELSE KI$FEI.BDCUR =KI$FEI.BDSZ -KI$FEI.BDARS -SIZEW(CTCW);
     1512     1401    1        DMP$=PINCRW(KI$FEI.BD$ ,KI$FEI.BDARS );
     1513     1402    1        DMP$->CTCW=DMPTCW;
     1514     1403    1        DMP$->CTCW.L6ADD=(KI$FEI.BDARS /KI_TSHFT)+KI$FEI.DSTAD ;
     1515     1404    1        DMP$->CTCW.TALLY=KI$FEI.BDCUR ;
     1516     1405    1        OCQ$->KI$QHDR.CCMD=DUMPL6;
     1517     1406    1        ADDR(OCQ$->KI$QHDR.CCMD)->CCMD.ADB18=DMPR.WADDR;
     1518     1407    1        KI$FEI.TCNT = KI$FEI.TIMEOUT.DUMP;
     1519     1408    1        KI$FEI.FEST =KIST_DMP;
     1520     1409    1        CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);
     1521     1410             %UNLOCK (G=KI$FEI.LOCK);
     1522     1413    1        IF REG_FLG THEN CALL SSR$REG(%SS_QA);
     1523     1414    1        KI$FEI.BDU# = 0;
     1524     1415    1        RETURN;
     1525     1416
     1526     1417    1   END;
     1527     1418
     1528     1419
     1529     1420        %EOD;

PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:273  
--  Include file information  --

   KI_SUBS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$DMPINT.

   Procedure KIQ$DMPINT requires 169 words for executable code.
   Procedure KIQ$DMPINT requires 14 words of local(AUTO) storage.

PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:274  

 Object Unit name= KIQ$DMPINT                                 File name= KIQ$QMGR.:E05TOU
 UTS= JUL 30 '97 00:41:10.16 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      2      2  KIQ$DMPINT
    1   Proc  even  none   169    251  KIQ$DMPINT
    2  RoData even  none     7      7  KIQ$DMPINT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KIQ$DMPINT
     1    107                  yes      Std        1  KIQ$DUMPGO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 HFC$LOCK
 yes     yes           Std       1 MMS$WSQMAP
 yes     yes           Std       2 MMS$VREL
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       3 SSR$REG
         yes           Std       3 NIS$DCCON
         yes           Std       4 SSR$RUE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:275  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KI_FEI$$                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:276  


     1435        1        /*T***********************************************************/
     1436        2        /*T*                                                         */
     1437        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1438        4        /*T*                                                         */
     1439        5        /*T***********************************************************/
     1440        6
     1441        7
     1442        8        KIQ$DMPINT: PROC (FEI);

      8  1 000000   000000 700200 xent  KIQ$DMPINT   TSX0  ! X66_AUTO_1
         1 000001   000016 000001                    ZERO    14,1

     1443        9
     1444       10
     1445       11        %INCLUDE HF_LOCK_C;
     1446       25        %INCLUDE KI$QHDR;
     1447      177        %INCLUDE KI_DATA_R;
     1448      203        %INCLUDE KI_MACROS_C;
     1449      811        %INCLUDE S_WSPTD_R;
     1450      827        %INCLUDE SS_SCHED_C;
     1451     1060        %INCLUDE KI_SUBS_C;
     1452     1196
     1453     1197        %KI$CTCW (NAME=CTCW);
     1454     1205        %KI$CCMD (NAME=CCMD);
     1455     1220        %KI_CTCW(NAME=DMPTCW,TB=T);
     1456     1229        %KI_CCMD(NAME=DUMPL6,CMD=KIOP_DUMPL6);
     1457     1257        %KI$FEI (STCLASS="BASED(FEI$)");
     1458     1341
     1459     1342
     1460     1343    1   DCL FEI UBIN WORD;
     1461     1344    1   DCL FEI$ PTR;
     1462     1345    1   DCL OCQ$ PTR;
     1463     1346    1   DCL DMP$ PTR;
     1464     1347    1   DCL 1 DMPR REDEF DMP$ ALIGNED,
     1465     1348    1            2 WADDR UBIN(18) UNAL,
     1466     1349    1            2 * UBIN(18) UNAL;
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:277  
     1467     1350    1   DCL MVSZ UBIN WORD;
     1468     1351    1   DCL MOVEE CHAR(MVSZ) BASED ALIGNED;
     1469     1352    1   DCL 1 MOVOR BASED ALIGNED,
     1470     1353    1            2 TCW UBIN WORD,
     1471     1354    1            2 DMP CHAR(MVSZ);
     1472     1355    1   DCL REG_FLG BIT(1) ALIGNED;
     1473     1356    1   DCL SSR$REG ENTRY(3) ALTRET;
     1474     1357    1   DCL SSR$RUE ENTRY(4);
     1475     1358    1   DCL MMS$VREL ENTRY(2) ALTRET;
     1476     1359    1   DCL NIS$DCCON ENTRY(3);
     1477     1360    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
     1478     1361
     1479     1362
     1480     1363        /*X* DMR,PLM=5,IND=3,CTI=2,SDI=5,MCL=10,CSI=1,DTI=2,DCI=3,ECI=0,AND */
     1481     1364
     1482     1365
     1483     1366    1        FEI$ = KI$FEI$(FEI);

   1366  1 000002   200003 470500                    LDP0    @FEI,,AUTO
         1 000003   000000 720100                    LXL0    0,,PR0
         1 000004   000000 471400 xsym               LDP1    KI_FEI$$
         1 000005   100000 236110                    LDQ     0,X0,PR1
         1 000006   200004 756100                    STQ     FEI$,,AUTO

     1484     1367             %LOCK (G=KI$FEI.LOCK);

   1368  1 000007   200004 630500                    EPPR0   FEI$,,AUTO
         1 000010   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000011   000000 701000 xent               TSX1    HFC$LOCK
         1 000012   000000 011000                    NOP     0

     1485     1370    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);

   1370  1 000013   200004 236100                    LDQ     FEI$,,AUTO
         1 000014   000014 036003                    ADLQ    12,DU
         1 000015   200012 756100                    STQ     REG_FLG+2,,AUTO
         1 000016   200012 630500                    EPPR0   REG_FLG+2,,AUTO
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:278  
         1 000017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000020   000000 701000 xent               TSX1    MMS$WSQMAP
         1 000021   000000 011000                    NOP     0

     1486     1371    2        DO INHIBIT;

     1487     1372    2           KI$FEI.FEST =KIST_DN;

   1372  1 000022   200004 470700                    LDP0  ! FEI$,,AUTO
         1 000023   000000 236203                    LDQ   ! 0,DU
         1 000024   000002 552320                    STBQ  ! 2,'20'O,PR0

     1488     1373    2        END;

     1489     1374    1        MVSZ=KI$FEI.BDCUR *4;

   1374  1 000025   000012 236100                    LDQ     10,,PR0
         1 000026   000020 732000                    QRS     16
         1 000027   000000 376000 2                  ANQ     0
         1 000030   200007 756100                    STQ     MVSZ,,AUTO

     1490     1375    1        DMP$=PINCRW(KI$FEI.BD$ ,KI$FEI.BDARS );

   1375  1 000031   000011 720100                    LXL0    9,,PR0
         1 000032   000010 471500                    LDP1    8,,PR0
         1 000033   100000 633510                    EPPR3   0,X0,PR1
         1 000034   200006 453500                    STP3    DMP$,,AUTO

     1491     1376    1        DMP$->MOVEE=DMP$->MOVOR.DMP;

   1376  1 000035   000000 621006                    EAX1    0,QL
         1 000036   200007 722100                    LXL2    MVSZ,,AUTO
         1 000037   040140 100540                    MLR     fill='040'O
         1 000040   300001 000011                    ADSC9   1,,PR3                   cn=0,n=*X1
         1 000041   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2

     1492     1377    1        KI$FEI.BDARS =KI$FEI.BDARS +KI$FEI.BDCUR ;
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:279  

   1377  1 000042   000012 236100                    LDQ     10,,PR0
         1 000043   000022 732000                    QRS     18
         1 000044   200012 756100                    STQ     REG_FLG+2,,AUTO
         1 000045   000011 236100                    LDQ     9,,PR0
         1 000046   000022 736000                    QLS     18
         1 000047   000022 732000                    QRS     18
         1 000050   200012 036100                    ADLQ    REG_FLG+2,,AUTO
         1 000051   000000 620006                    EAX0    0,QL
         1 000052   000011 440100                    SXL0    9,,PR0

     1493     1378    1        IF KI$FEI.BDSZ <=KI$FEI.BDARS +SIZEW(CTCW) THEN

   1378  1 000053   000001 621010                    EAX1    1,X0
         1 000054   000011 101100                    CMPX1   9,,PR0
         1 000055   000105 604000 1                  TMI     s:1387

     1494     1379    2          DO ;

     1495     1380    2             CALL MMS$VREL (KI$FEI.FEWSQ ,KI$FEI.BD$ );

   1380  1 000056   200004 236100                    LDQ     FEI$,,AUTO
         1 000057   000010 036003                    ADLQ    8,DU
         1 000060   200013 756100                    STQ     REG_FLG+3,,AUTO
         1 000061   200004 236100                    LDQ     FEI$,,AUTO
         1 000062   000005 036003                    ADLQ    5,DU
         1 000063   200012 756100                    STQ     REG_FLG+2,,AUTO
         1 000064   200012 630500                    EPPR0   REG_FLG+2,,AUTO
         1 000065   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000066   000000 701000 xent               TSX1    MMS$VREL
         1 000067   000000 011000                    NOP     0

     1496     1381    2             CALL SSR$RUE (%SS_UQA,KI$FEI.BDU# );

   1381  1 000070   200004 236100                    LDQ     FEI$,,AUTO
         1 000071   000002 036000 2                  ADLQ    2
         1 000072   000003 235000 2                  LDA     3
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:280  
         1 000073   200012 757100                    STAQ    REG_FLG+2,,AUTO
         1 000074   200012 630500                    EPPR0   REG_FLG+2,,AUTO
         1 000075   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000076   000000 701000 xent               TSX1    SSR$RUE
         1 000077   000000 011000                    NOP     0

     1497     1382                  %UNLOCK(G=KI$FEI.LOCK);

   1383  1 000100   200004 630500                    EPPR0   FEI$,,AUTO
         1 000101   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000102   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000103   000000 011000                    NOP     0

     1498     1385    2             RETURN;

   1385  1 000104   000000 702200 xent               TSX2  ! X66_ARET

     1499     1386    2          END;
     1500     1387    1        REG_FLG = '0'B;

   1387  1 000105   200010 450100                    STZ     REG_FLG,,AUTO

     1501     1388    1        GOTO DUMPGO;

   1388  1 000106   000133 710000 1                  TRA     DUMPGO

     1502     1389
     1503     1390    1   KIQ$DUMPGO: ENTRY (FEI);

   1390  1 000107   000000 700200 xent  KIQ$DUMPGO   TSX0  ! X66_AUTO_1
         1 000110   000016 000001                    ZERO    14,1

     1504     1391
     1505     1392    1        REG_FLG = '1'B;

   1392  1 000111   400000 236003                    LDQ     -131072,DU
         1 000112   200010 756100                    STQ     REG_FLG,,AUTO
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:281  

     1506     1393    1        FEI$ = KI$FEI$(FEI);

   1393  1 000113   200003 470500                    LDP0    @FEI,,AUTO
         1 000114   000000 720100                    LXL0    0,,PR0
         1 000115   000000 471400 xsym               LDP1    KI_FEI$$
         1 000116   100000 236110                    LDQ     0,X0,PR1
         1 000117   200004 756100                    STQ     FEI$,,AUTO

     1507     1394             %LOCK (G=KI$FEI.LOCK);

   1395  1 000120   200004 630500                    EPPR0   FEI$,,AUTO
         1 000121   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000122   000000 701000 xent               TSX1    HFC$LOCK
         1 000123   000000 011000                    NOP     0

     1508     1397    1        CALL MMS$WSQMAP(KI$FEI.PTPPNO#);

   1397  1 000124   200004 236100                    LDQ     FEI$,,AUTO
         1 000125   000014 036003                    ADLQ    12,DU
         1 000126   200012 756100                    STQ     REG_FLG+2,,AUTO
         1 000127   200012 630500                    EPPR0   REG_FLG+2,,AUTO
         1 000130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000131   000000 701000 xent               TSX1    MMS$WSQMAP
         1 000132   000000 011000                    NOP     0

     1509     1398    1   DUMPGO: OCQ$=KI$FEI.OCQ$;

   1398  1 000133   200004 470500       DUMPGO       LDP0    FEI$,,AUTO
         1 000134   000003 236100                    LDQ     3,,PR0
         1 000135   200005 756100                    STQ     OCQ$,,AUTO

     1510     1399    1        IF KI$FEI.BDSZ -KI$FEI.BDARS >4096 THEN KI$FEI.BDCUR =4096;

   1399  1 000136   000011 236100                    LDQ     9,,PR0
         1 000137   000022 736000                    QLS     18
         1 000140   000022 732000                    QRS     18
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:282  
         1 000141   200012 756100                    STQ     REG_FLG+2,,AUTO
         1 000142   000011 236100                    LDQ     9,,PR0
         1 000143   000022 732000                    QRS     18
         1 000144   200012 136100                    SBLQ    REG_FLG+2,,AUTO
         1 000145   010000 116007                    CMPQ    4096,DL
         1 000146   000152 604400 1                  TMOZ    s:1400

   1399  1 000147   010000 220003                    LDX0    4096,DU
         1 000150   000012 740100                    STX0    10,,PR0
         1 000151   000163 710000 1                  TRA     s:1401

     1511     1400    1        ELSE KI$FEI.BDCUR =KI$FEI.BDSZ -KI$FEI.BDARS -SIZEW(CTCW);

   1400  1 000152   000011 236100                    LDQ     9,,PR0
         1 000153   000022 736000                    QLS     18
         1 000154   000022 732000                    QRS     18
         1 000155   200012 756100                    STQ     REG_FLG+2,,AUTO
         1 000156   000011 236100                    LDQ     9,,PR0
         1 000157   000022 732000                    QRS     18
         1 000160   200012 136100                    SBLQ    REG_FLG+2,,AUTO
         1 000161   777777 620006                    EAX0    -1,QL
         1 000162   000012 740100                    STX0    10,,PR0

     1512     1401    1        DMP$=PINCRW(KI$FEI.BD$ ,KI$FEI.BDARS );

   1401  1 000163   000011 721100                    LXL1    9,,PR0
         1 000164   000010 471500                    LDP1    8,,PR0
         1 000165   100000 633511                    EPPR3   0,X1,PR1
         1 000166   200006 453500                    STP3    DMP$,,AUTO

     1513     1402    1        DMP$->CTCW=DMPTCW;

   1402  1 000167   000000 236000 0                  LDQ     DMPTCW
         1 000170   300000 756100                    STQ     0,,PR3

     1514     1403    1        DMP$->CTCW.L6ADD=(KI$FEI.BDARS /KI_TSHFT)+KI$FEI.DSTAD ;

PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:283  
   1403  1 000171   000011 236100                    LDQ     9,,PR0
         1 000172   000022 736000                    QLS     18
         1 000173   000022 732000                    QRS     18
         1 000174   000200 506007                    DIV     128,DL
         1 000175   000016 036100                    ADLQ    14,,PR0
         1 000176   000022 736000                    QLS     18
         1 000177   300000 676100                    ERQ     0,,PR3
         1 000200   077777 376003                    ANQ     32767,DU
         1 000201   300000 656100                    ERSQ    0,,PR3

     1515     1404    1        DMP$->CTCW.TALLY=KI$FEI.BDCUR ;

   1404  1 000202   000012 236100                    LDQ     10,,PR0
         1 000203   000022 772000                    QRL     18
         1 000204   300000 752103                    STCQ    0,'03'O,PR3

     1516     1405    1        OCQ$->KI$QHDR.CCMD=DUMPL6;

   1405  1 000205   000001 236000 0                  LDQ     DUMPL6
         1 000206   200005 471500                    LDP1    OCQ$,,AUTO
         1 000207   100000 756100                    STQ     0,,PR1

     1517     1406    1        ADDR(OCQ$->KI$QHDR.CCMD)->CCMD.ADB18=DMPR.WADDR;

   1406  1 000210   200006 220100                    LDX0    DMP$,,AUTO
         1 000211   100000 740100                    STX0    0,,PR1

     1518     1407    1        KI$FEI.TCNT = KI$FEI.TIMEOUT.DUMP;

   1407  1 000212   000020 221100                    LDX1    16,,PR0
         1 000213   000777 361003                    ANX1    511,DU
         1 000214   000002 441100                    SXL1    2,,PR0

     1519     1408    1        KI$FEI.FEST =KIST_DMP;

   1408  1 000215   000005 236003                    LDQ     5,DU
         1 000216   000002 552120                    STBQ    2,'20'O,PR0
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:284  

     1520     1409    1        CALL NIS$DCCON (KI$FEI.FECH ,'0'O,KI$FEI.FEWSQ);

   1409  1 000217   200004 236100                    LDQ     FEI$,,AUTO
         1 000220   000005 036003                    ADLQ    5,DU
         1 000221   200014 756100                    STQ     REG_FLG+4,,AUTO
         1 000222   000004 236000 2                  LDQ     4
         1 000223   200013 756100                    STQ     REG_FLG+3,,AUTO
         1 000224   200004 236100                    LDQ     FEI$,,AUTO
         1 000225   000002 036003                    ADLQ    2,DU
         1 000226   200012 756100                    STQ     REG_FLG+2,,AUTO
         1 000227   200012 630500                    EPPR0   REG_FLG+2,,AUTO
         1 000230   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000231   000000 701000 xent               TSX1    NIS$DCCON
         1 000232   000000 011000                    NOP     0

     1521     1410             %UNLOCK (G=KI$FEI.LOCK);

   1411  1 000233   200004 630500                    EPPR0   FEI$,,AUTO
         1 000234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000235   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000236   000000 011000                    NOP     0

     1522     1413    1        IF REG_FLG THEN CALL SSR$REG(%SS_QA);

   1413  1 000237   200010 234100                    SZN     REG_FLG,,AUTO
         1 000240   000245 605000 1                  TPL     s:1414

   1413  1 000241   000006 630400 2                  EPPR0   6
         1 000242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000243   000000 701000 xent               TSX1    SSR$REG
         1 000244   000000 011000                    NOP     0

     1523     1414    1        KI$FEI.BDU# = 0;

   1414  1 000245   200004 470500                    LDP0    FEI$,,AUTO
         1 000246   000000 236003                    LDQ     0,DU
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:285  
         1 000247   000007 552120                    STBQ    7,'20'O,PR0

     1524     1415    1        RETURN;

   1415  1 000250   000000 702200 xent               TSX2  ! X66_ARET

DMPTCW
 Sect OctLoc
   0     000   100000 400000                                                    @...

DUMPL6
 Sect OctLoc
   0     001   000000 000075                                                    ...=

(unnamed)
 Sect OctLoc
   2     000   777777 777774   000000 000034   000007 200000   000001 006000    ................
   2     004   000002 006000   000000 000033   000005 006000                    ............
     1525     1416
     1526     1417    1   END;
     1527     1418
     1528     1419
     1529     1420        %EOD;

PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:286  
--  Include file information  --

   KI_SUBS_C.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   S_WSPTD_R.:E05TOU  cannot be made into a system file and is referenced.
   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KI$QHDR.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$DMPINT.
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:287  

 **** Variables and constants ****

  ****  Section 000 RoData KIQ$DMPINT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 DMPTCW                     1-0-0/w STRC        r     1 DUMPL6

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FEI                       6-0-0/w PTR         r     1 DMP$
     6-0-0/w STRC        r     1 DMPR                      *0-0-0/w UBIN        r     1 FEI
     4-0-0/w PTR         r     1 FEI$                       7-0-0/w UBIN        r     1 MVSZ
     5-0-0/w PTR         r     1 OCQ$                      10-0-0/w BIT         r     1 REG_FLG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KI_FEI$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 CCMD                       0-0-0/w STRC        r     1 CTCW
     0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)
     0-0-0/d STRC(576)   r     1 KI$QHDR                    0-0-0/w ACHR        r     1 MOVEE
     0-0-0/w ASTR        r     1 MOVOR

PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:288  

   Procedure KIQ$DMPINT requires 169 words for executable code.
   Procedure KIQ$DMPINT requires 14 words of local(AUTO) storage.
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:289  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:290  
          MINI XREF LISTING

CCMD.ADB18
      1207**DCL      1406<<ASSIGN
CCMD.L66INT
      1215**DCL      1216--REDEF    1217--REDEF
CCMD.L6INT
      1212**DCL      1214--REDEF
CTCW
      1198**DCL      1378--IF       1400--ASSIGN   1402<<ASSIGN
CTCW.L6ADD
      1200**DCL      1403<<ASSIGN
CTCW.TALLY
      1203**DCL      1404<<ASSIGN
DMP$
      1346**DCL      1347--REDEF    1375<<ASSIGN   1376>>ASSIGN   1376>>ASSIGN   1401<<ASSIGN   1402>>ASSIGN
      1403>>ASSIGN   1404>>ASSIGN
DMPR.WADDR
      1348**DCL      1406>>ASSIGN
DMPTCW
      1221**DCL      1402>>ASSIGN
DUMPGO
      1398**LABEL    1388--GOTO
DUMPL6
      1238**DCL      1405>>ASSIGN
DUMPL6.L66INT
      1246**DCL      1247--REDEF    1251--REDEF
DUMPL6.L6INT
      1244**DCL      1245--REDEF
FEI
      1343**DCL         8--PROC     1366>>ASSIGN   1390--ENTRY    1393>>ASSIGN
FEI$
      1344**DCL      1270--IMP-PTR  1366<<ASSIGN   1368>>CALL     1370>>CALL     1372>>ASSIGN   1374>>ASSIGN
      1375>>ASSIGN   1375>>ASSIGN   1377>>ASSIGN   1377>>ASSIGN   1377>>ASSIGN   1378>>IF       1378>>IF
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:291  
      1380>>CALL     1380>>CALL     1381>>CALL     1383>>CALL     1393<<ASSIGN   1395>>CALL     1397>>CALL
      1398>>ASSIGN   1399>>IF       1399>>IF       1399>>ASSIGN   1400>>ASSIGN   1400>>ASSIGN   1400>>ASSIGN
      1401>>ASSIGN   1401>>ASSIGN   1403>>ASSIGN   1403>>ASSIGN   1404>>ASSIGN   1407>>ASSIGN   1407>>ASSIGN
      1408>>ASSIGN   1409>>CALL     1409>>CALL     1411>>CALL     1414>>ASSIGN
HFC$LOCK
        24**DCL-ENT  1368--CALL     1395--CALL
HFC$UNLOCK
        24**DCL-ENT  1383--CALL     1411--CALL
KI$FEI.BD$
      1305**DCL      1306--REDEF    1375>>ASSIGN   1380<>CALL     1401>>ASSIGN
KI$FEI.BDAD.WADDR
      1307**DCL      1308--REDEF
KI$FEI.BDARS
      1313**DCL      1375>>ASSIGN   1377<<ASSIGN   1377>>ASSIGN   1378>>IF       1399>>IF       1400>>ASSIGN
      1401>>ASSIGN   1403>>ASSIGN
KI$FEI.BDCUR
      1314**DCL      1374>>ASSIGN   1377>>ASSIGN   1399<<ASSIGN   1400<<ASSIGN   1404>>ASSIGN
KI$FEI.BDSZ
      1312**DCL      1378>>IF       1399>>IF       1400>>ASSIGN
KI$FEI.BDU#
      1303**DCL      1381<>CALL     1414<<ASSIGN
KI$FEI.DSTAD
      1333**DCL      1403>>ASSIGN
KI$FEI.FECH
      1272**DCL      1409<>CALL
KI$FEI.FEST
      1275**DCL      1372<<ASSIGN   1408<<ASSIGN
KI$FEI.FEWSQ
      1298**DCL      1380<>CALL     1409<>CALL
KI$FEI.LOCK
      1271**DCL      1368<>CALL     1383<>CALL     1395<>CALL     1411<>CALL
KI$FEI.OCQ$
      1286**DCL      1398>>ASSIGN
KI$FEI.PTPPNO#
      1320**DCL      1370<>CALL     1397<>CALL
KI$FEI.RCVPB
PL6.E3A0      #007=KIQ$DMPINT File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:292  
      1321**DCL      1322--REDEF
KI$FEI.TCNT
      1282**DCL      1407<<ASSIGN
KI$FEI.TIMEOUT.DUMP
      1337**DCL      1407>>ASSIGN
KI$FEI$
       189**DCL      1366>>ASSIGN   1393>>ASSIGN
KI$QHDR.CCMD
        55**DCL      1405<<ASSIGN   1406--ASSIGN
KI_FEI$$
       188**DCL       189--IMP-PTR  1366>>ASSIGN   1393>>ASSIGN
MMS$VREL
      1358**DCL-ENT  1380--CALL
MMS$WSQMAP
      1360**DCL-ENT  1370--CALL     1397--CALL
MOVEE
      1351**DCL      1376<<ASSIGN
MOVOR.DMP
      1354**DCL      1376>>ASSIGN
MVSZ
      1350**DCL      1351--IMP-SIZ  1354--IMP-SIZ  1374<<ASSIGN   1376>>ASSIGN   1376>>ASSIGN
NIS$DCCON
      1359**DCL-ENT  1409--CALL
OCQ$
      1345**DCL      1398<<ASSIGN   1405>>ASSIGN   1406>>ASSIGN
REG_FLG
      1355**DCL      1387<<ASSIGN   1392<<ASSIGN   1413>>IF
SSR$REG
      1356**DCL-ENT  1413--CALL
SSR$RUE
      1357**DCL-ENT  1381--CALL

PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:293  
     1530        1        /*T***********************************************************/
     1531        2        /*T*                                                         */
     1532        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1533        4        /*T*                                                         */
     1534        5        /*T***********************************************************/
     1535        6        KIQ$MAPFEP: PROC (FEI);
     1536        7
     1537        8        %INCLUDE KI_DATA_R;
     1538       34        %INCLUDE KI_MACROS_C;
     1539      642
     1540      643    1   DCL FEI UBIN BYTE CALIGNED;
     1541      644
     1542      645        %KI$FEI;
     1543      729
     1544      730    1   DCL PPNO UBIN;
     1545      731
     1546      732    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
     1547      733
     1548      734    1        PPNO = KI$FEI$(FEI)->KI$FEI.PTPPNO#;
     1549      735    1        IF PPNO ~= 0
     1550      736    1        THEN
     1551      737    1           CALL MMS$WSQMAP(PPNO);
     1552      738    1        RETURN;
     1553      739    1   END KIQ$MAPFEP;
     1554      740
     1555      741

PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:294  
--  Include file information  --

   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$MAPFEP.

   Procedure KIQ$MAPFEP requires 19 words for executable code.
   Procedure KIQ$MAPFEP requires 8 words of local(AUTO) storage.

    No errors detected in file KIQ$QMGR.:E05TSI    .

PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:295  

 Object Unit name= KIQ$MAPFEP                                 File name= KIQ$QMGR.:E05TOU
 UTS= JUL 30 '97 00:41:29.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    19     23  KIQ$MAPFEP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  KIQ$MAPFEP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 MMS$WSQMAP
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KI_FEI$$                              B_VECTNIL
PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:296  


     1530        1        /*T***********************************************************/
     1531        2        /*T*                                                         */
     1532        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1533        4        /*T*                                                         */
     1534        5        /*T***********************************************************/
     1535        6        KIQ$MAPFEP: PROC (FEI);

      6  0 000000   000000 700200 xent  KIQ$MAPFEP   TSX0  ! X66_AUTO_1
         0 000001   000010 000001                    ZERO    8,1

     1536        7
     1537        8        %INCLUDE KI_DATA_R;
     1538       34        %INCLUDE KI_MACROS_C;
     1539      642
     1540      643    1   DCL FEI UBIN BYTE CALIGNED;
     1541      644
     1542      645        %KI$FEI;
     1543      729
     1544      730    1   DCL PPNO UBIN;
     1545      731
     1546      732    1   DCL MMS$WSQMAP ENTRY(1) ALTRET;
     1547      733
     1548      734    1        PPNO = KI$FEI$(FEI)->KI$FEI.PTPPNO#;

    734  0 000002   200003 470500                    LDP0    @FEI,,AUTO
         0 000003   000100 101500                    MRL     fill='000'O
         0 000004   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         0 000005   200006 000002                    ADSC9   PPNO+2,,AUTO             cn=0,n=2
         0 000006   200006 220100                    LDX0    PPNO+2,,AUTO
         0 000007   000000 471400 xsym               LDP1    KI_FEI$$
         0 000010   100000 473510                    LDP3    0,X0,PR1
         0 000011   300014 235100                    LDA     12,,PR3
         0 000012   200004 755100                    STA     PPNO,,AUTO

     1549      735    1        IF PPNO ~= 0

PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:297  
    735  0 000013   000022 600000 0                  TZE     s:738

     1550      736    1        THEN
     1551      737    1           CALL MMS$WSQMAP(PPNO);

    737  0 000014   200004 633500                    EPPR3   PPNO,,AUTO
         0 000015   200006 453500                    STP3    PPNO+2,,AUTO
         0 000016   200006 630500                    EPPR0   PPNO+2,,AUTO
         0 000017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000020   000000 701000 xent               TSX1    MMS$WSQMAP
         0 000021   000000 011000                    NOP     0

     1552      738    1        RETURN;

    738  0 000022   000000 702200 xent               TSX2  ! X66_ARET
     1553      739    1   END KIQ$MAPFEP;
     1554      740
     1555      741

PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:298  
--  Include file information  --

   KI_MACROS_C.:E05TOU  is referenced.
   KI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KIQ$MAPFEP.
PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:299  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FEI                      *0-0-0/c UBIN(9)     r     1 FEI
     4-0-0/w UBIN        r     1 PPNO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KI_FEI$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(612)   r     1 KI$FEI
     0-0-0/w PTR         r     1 KI$FEI$(0:0)


   Procedure KIQ$MAPFEP requires 19 words for executable code.
   Procedure KIQ$MAPFEP requires 8 words of local(AUTO) storage.

    No errors detected in file KIQ$QMGR.:E05TSI    .
PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:300  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=KIQ$MAPFEP File=KIQ$QMGR.:E05TSI                              WED 07/30/97 00:41 Page:301  
          MINI XREF LISTING

FEI
       643**DCL         6--PROC      734>>ASSIGN
KI$FEI.BD$
       693**DCL       694--REDEF
KI$FEI.BDAD.WADDR
       695**DCL       696--REDEF
KI$FEI.PTPPNO#
       708**DCL       734>>ASSIGN
KI$FEI.RCVPB
       709**DCL       710--REDEF
KI$FEI$
        20**DCL       734>>ASSIGN
KI_FEI$$
        19**DCL        20--IMP-PTR   734>>ASSIGN
MMS$WSQMAP
       732**DCL-ENT   737--CALL
PPNO
       730**DCL       734<<ASSIGN    735>>IF        737<>CALL
