VERSION E05

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        IAD$DATE: PROC ALTRET;
        7        7
        8        8
        9        9
       10       10        %INCLUDE CP_6;
       11     5569        %INCLUDE CP_6_SUBS;
       12     6109        %INCLUDE IA_SUBS_C;
       13     6179        %INCLUDE IA_DAT_R;
       14     6197        %INCLUDE XU_MACRO_C;
       15     9303        %INCLUDE B$JIT_C;
       16     9617
       17     9618    1   DCL IAM$CYCLE ENTRY;
       18     9619    1   DCL IAM$LEAP ENTRY;
       19     9620
       20     9621    1   DCL GOOSE_OUT$ PTR SYMREF;     /* Set to ONLINE_GETCMD.OUT$ in IAA$MAIN. */
       21     9622
       22     9623
       23     9624             %PARSE$OUT (NAME=OUT$BLK,STCLASS=BASED);
       24     9669             %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
       25     9707
       26     9708    1   DCL M$DO DCB;
       27     9709
       28     9710    1   DCL NNNN CHAR(10) CALIGNED STATIC INIT (' ');
       29     9711    1   DCL IJ1 CHAR(3) CALIGNED STATIC INIT (' ');
       30     9712    1   DCL IJ2 CHAR(3) CALIGNED STATIC INIT (' ');
       31     9713    1   DCL IY1 CHAR(4) CALIGNED STATIC INIT (' ');
       32     9714    1   DCL IY2 CHAR(4) CALIGNED STATIC INIT (' ');
       33     9715    1   DCL IM1 CHAR(2) CALIGNED STATIC INIT (' ');
       34     9716    1   DCL IM2 CHAR(2) CALIGNED STATIC INIT (' ');
       35     9717    1   DCL ID1 CHAR(2) CALIGNED STATIC INIT (' ');
       36     9718    1   DCL ID2 CHAR(2) CALIGNED STATIC INIT (' ');
       37     9719    1   DCL II1 CHAR(4) CALIGNED STATIC INIT ('0');
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:2    
       38     9720    1   DCL EVAL_CASE UBIN BYTE STATIC ALIGNED INIT (0);
       39     9721    1   DCL BY1 UBIN WORD STATIC ALIGNED INIT (0000);
       40     9722    1   DCL BY1S REDEF BY1 SBIN;
       41     9723    1   DCL BY2 UBIN WORD STATIC ALIGNED INIT (0000);
       42     9724    1   DCL BY2S REDEF BY2 SBIN;
       43     9725    1   DCL BM1 UBIN WORD STATIC ALIGNED INIT (00);
       44     9726    1   DCL BM2 UBIN WORD STATIC ALIGNED INIT (00);
       45     9727    1   DCL BD1 UBIN WORD STATIC ALIGNED INIT (00);
       46     9728    1   DCL BD2 UBIN WORD STATIC ALIGNED INIT (00);
       47     9729    1   DCL BI1 SBIN WORD STATIC ALIGNED INIT (0);
       48     9730
       49     9731    1   DCL PTR$ PTR;
       50     9732
       51     9733    1   DCL RESULT SBIN WORD STATIC ALIGNED INIT (0);
       52     9734    1   DCL OY CHAR(4) STATIC INIT (' ');
       53     9735    1   DCL OD CHAR(2) STATIC CALIGNED INIT (' ');
       54     9736    1   DCL OM CHAR(2) STATIC CALIGNED INIT (' ');
       55     9737    1   DCL COUNT SBIN WORD STATIC ALIGNED INIT (0);
       56     9738    1   DCL LENGTH SBIN WORD STATIC ALIGNED INIT (0);
       57     9739    1   DCL BNNNN UBIN WORD STATIC ALIGNED INIT (0);
       58     9740    1   DCL SUBS UBIN WORD STATIC ALIGNED INIT (0);
       59     9741    1   DCL OJULIAN CHAR(4) STATIC CALIGNED INIT (' ');
       60     9742    1   DCL X UBIN WORD STATIC ALIGNED INIT (0);
       61     9743    1   DCL DATE_STATUS BIT(1) STATIC ALIGNED INIT ('0'B);
       62     9744    1   DCL TYPE CHAR(1) STATIC CALIGNED INIT (' ');
       63     9745
       64     9746    1   DCL SLASH CHAR(10) STATIC CALIGNED INIT ('  /  /    ');
       65     9747    1   DCL O_WEEK_OF_MONTH CHAR (2) STATIC CALIGNED INIT (' ');
       66     9748    1   DCL O_WEEK_OF_YEAR CHAR (2) STATIC CALIGNED INIT (' ');
       67     9749
       68     9750
       69     9751             %FPT_WRITE     (FPTN=WRITE_OUT,
       70     9752                                 DCB=M$DO,
       71     9753                                 BUF=MESS_BUF,
       72     9754                                 WAIT=YES);
       73     9785
       74     9786
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:3    
       75     9787
       76     9788        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:4    
       77     9789
       78     9790    1             LEAP = %NO#;
       79     9791
       80     9792    2        DO CASE (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE);
       81     9793
       82     9794    2             CASE (1);
       83     9795    2                  IJ1 = ' ';
       84     9796    2                  IY1 = ' ';
       85     9797    2                  TYPE = 'J';
       86     9798    2                  EVAL_CASE = 1;
       87     9799    2                  CALL INSERT (IJ1,
       88     9800    2                                 LENGTHC (IJ1) -
       89     9801    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0)
              9801                                          -> OUT$SYM.COUNT),
       90     9802    2                                 ,
       91     9803    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0)
              9803                                          -> OUT$SYM.TEXT);
       92     9804    2                  CALL INSERT (IY1,
       93     9805    2                                 LENGTHC (IY1) -
       94     9806    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(1)
              9806                                          -> OUT$SYM.COUNT),
       95     9807    2                                 ,
       96     9808    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(1)
              9808                                          -> OUT$SYM.TEXT);
       97     9809
       98     9810    2                  IF SUBSTR (IY1, 0, 2) = '  ' AND SUBSTR (IY1, 2, 2) >= '78'
       99     9811    2                  THEN
      100     9812    2                     CALL INSERT (IY1, 0, 2, '19');
      101     9813    2                  ELSE
      102     9814    2                  IF SUBSTR (IY1, 0, 2) = '  '
      103     9815    2                  THEN
      104     9816    2                     CALL INSERT (IY1, 0, 2, '20');
      105     9817
      106     9818    2        CALL CHARBIN (BY1, IY1);
      107     9819    2        TEMP_YEARS = BY1;
      108     9820    2        CALL IAM$LEAP;
      109     9821    2                  CALL CHARBIN (TEMP_JUL, IJ1);
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:5    
      110     9822    2                  CALL GET$MDY_J;
      111     9823    2                  BM1 = TEMP_MONTHS;
      112     9824    2                  BD1 = TEMP_DAYS;
      113     9825    2                  SUBS = GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.NSUBLKS;
      114     9826    2                  IF SUBS > 2
      115     9827    2                  THEN
      116     9828    2                       CALL GET$REST;
      117     9829    2             CASE (2);
      118     9830    2                  EVAL_CASE = 2;
      119     9831    2                  TYPE = 'M';
      120     9832    2                  IY1 =  ' ';
      121     9833    2                  IM1 = ' ';
      122     9834    2                  ID1 = ' ';
      123     9835    2                  CALL INSERT (IM1,
      124     9836    2                                 LENGTHC (IM1) -
      125     9837    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0)
              9837                                          -> OUT$SYM.COUNT),
      126     9838    2                                 ,
      127     9839    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0)
              9839                                          -> OUT$SYM.TEXT);
      128     9840    2                  CALL INSERT (ID1,
      129     9841    2                                 LENGTHC (ID1) -
      130     9842    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(1)
              9842                                          -> OUT$SYM.COUNT),
      131     9843    2                                 ,
      132     9844    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(1)
              9844                                          -> OUT$SYM.TEXT);
      133     9845    2                  CALL INSERT (IY1,
      134     9846    2                                 LENGTHC (IY1) -
      135     9847    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(2)
              9847                                          -> OUT$SYM.COUNT),
      136     9848    2                                 ,
      137     9849    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(2)
              9849                                          -> OUT$SYM.TEXT);
      138     9850
      139     9851    2                  IF SUBSTR (IY1, 0, 2) = '  ' AND SUBSTR (IY1, 2, 2) >= '78'
      140     9852    2                  THEN
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:6    
      141     9853    2                     CALL INSERT (IY1, 0, 2, '19');
      142     9854    2                  ELSE
      143     9855    2                  IF SUBSTR (IY1, 0, 2) = '  '
      144     9856    2                  THEN
      145     9857    2                     CALL INSERT (IY1, 0, 2, '20');
      146     9858    2                  CALL CHARBIN (BM1, IM1);
      147     9859    2                  CALL CHARBIN (BD1, ID1);
      148     9860    2                  CALL CHARBIN (BY1, IY1);
      149     9861    2                  SUBS = GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.NSUBLKS;
      150     9862    2                  IF  SUBS > 3
      151     9863    2                  THEN
      152     9864    2                       CALL GET$REST;
      153     9865    2                  END;
      154     9866    1                  CALL BREAKDOWN;
      155     9867    1          IF DATE_STATUS
      156     9868    1          THEN
      157     9869    1            ALTRETURN;
      158     9870    1          ELSE
      159     9871    1                  RETURN;
      160     9872        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:7    
      161     9873    1   GET$REST: PROC;
      162     9874    2        IF TYPE = 'J'
      163     9875    2        THEN
      164     9876    2           PTR$ = GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(2);
      165     9877    2        ELSE
      166     9878    2            PTR$ = GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(3);
      167     9879    3        DO CASE (PTR$ -> OUT$BLK.CODE);
      168     9880    3             CASE (12);
      169     9881    3                   EVAL_CASE = 3;
      170     9882    3                  NNNN = ' ';
      171     9883    3                  CALL INSERT (NNNN,
      172     9884    3                                 LENGTHC (NNNN) -
      173     9885    3                                 (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
      174     9886
      175     9887    3                                 ,
      176     9888    3                                 PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      177     9889    3                  CALL CHARBIN (BNNNN, NNNN);
      178     9890
      179     9891    3             CASE (13);
      180     9892    3                  EVAL_CASE = 4;
      181     9893    3                  NNNN = ' ';
      182     9894    3                  CALL INSERT (NNNN,
      183     9895    3                                 LENGTHC (NNNN) -
      184     9896    3                                 (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
      185     9897    3                                 ,
      186     9898    3                                 PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      187     9899
      188     9900    3                  CALL CHARBIN (BNNNN, NNNN);
      189     9901
      190     9902    3             CASE (10);
      191     9903    3                  EVAL_CASE = 5;
      192     9904    3                  IJ2 = '   ';
      193     9905    3                  IY2 = '    ';
      194     9906    3                  CALL INSERT (IJ2,
      195     9907    3                                 LENGTHC (IJ2) -
      196     9908    3                                 (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
      197     9909    3                                 ,
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:8    
      198     9910    3                                 PTR$ -> OUT$BLK.SUBLK$(0) ->  OUT$SYM.TEXT);
      199     9911    3                  CALL INSERT (IY2,
      200     9912    3                                 LENGTHC (IY2) -
      201     9913    3                                 (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
      202     9914    3                                 ,
      203     9915    3                                 PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      204     9916
      205     9917    3             IF SUBSTR (IY2, 0, 2) = '  ' AND SUBSTR (IY2, 2, 2) >= '78'
      206     9918    3             THEN
      207     9919    3                  CALL INSERT (IY2, 0, 2, '19');
      208     9920    3                  ELSE
      209     9921    3                  IF SUBSTR (IY2, 0, 2) = '  '
      210     9922    3                  THEN
      211     9923    3                     CALL INSERT (IY2, 0, 2, '20');
      212     9924
      213     9925    3        CALL CHARBIN (BY2, IY2);
      214     9926    3        TEMP_YEARS = BY2;
      215     9927    3        CALL IAM$LEAP;
      216     9928    3             CALL CHARBIN (TEMP_JUL, IJ2);
      217     9929    3             CALL GET$MDY_J;
      218     9930    3             BM2 = TEMP_MONTHS;
      219     9931    3             BD2 = TEMP_DAYS;
      220     9932
      221     9933    3             IF PTR$ -> OUT$BLK.NSUBLKS > 2
      222     9934    3             THEN
      223     9935    4               DO;
      224     9936    5                  DO CASE (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.CODE);
      225     9937    5                       CASE (26);
      226     9938    5                            EVAL_CASE = 6;
      227     9939    5                       CASE (27);
      228     9940    5                            EVAL_CASE = 7;
      229     9941    5                       END;
      230     9942    4                  II1 = ' ';
      231     9943    4                  CALL INSERT (II1,
      232     9944    4                                 LENGTHC (II1) -
      233     9945    4                                 (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.SUBLK$(0) ->
              9945                                          OUT$SYM.COUNT),
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:9    
      234     9946    4                                 ,
      235     9947    4                                 PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.SUBLK$(0) ->
              9947                                          OUT$SYM.TEXT);
      236     9948    4                  CALL CHARBIN (BI1, II1);
      237     9949    4                  END;
      238     9950
      239     9951
      240     9952    3             CASE (11);
      241     9953    3                  EVAL_CASE = 5;
      242     9954    3                  IY2 = '    ';
      243     9955    3                  IM2 = '  ';
      244     9956    3                  ID2 = '  ';
      245     9957    3                  CALL INSERT (IM2,
      246     9958    3                                 LENGTHC (IM2) -
      247     9959    3                                 (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
      248     9960    3                                 ,
      249     9961    3                                 PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      250     9962    3                  CALL INSERT (ID2,
      251     9963    3                                 LENGTHC (ID2) -
      252     9964    3                                 (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
      253     9965    3                                 ,
      254     9966    3                                 PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      255     9967    3                  CALL INSERT (IY2,
      256     9968    3                                 LENGTHC (IY2) -
      257     9969    3                                 (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$SYM.COUNT),
      258     9970    3                                 ,
      259     9971    3                                 PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$SYM.TEXT);
      260     9972
      261     9973    3                IF SUBSTR (IY2, 0, 2) = '  ' AND SUBSTR (IY2, 2, 2) >= '78'
      262     9974    3                THEN
      263     9975    3                     CALL INSERT (IY2, 0, 2, '19');
      264     9976    3                  ELSE
      265     9977    3                  IF SUBSTR (IY2, 0, 2) = '  '
      266     9978    3                  THEN
      267     9979    3                     CALL INSERT (IY2, 0, 2, '20');
      268     9980
      269     9981    3                CALL CHARBIN (BY2, IY2);
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:10   
      270     9982    3                CALL CHARBIN (BM2, IM2);
      271     9983    3                CALL CHARBIN (BD2, ID2);
      272     9984
      273     9985    3             IF PTR$ -> OUT$BLK.NSUBLKS > 3
      274     9986    3             THEN
      275     9987    4               DO;
      276     9988    5                  DO CASE (PTR$ -> OUT$BLK.SUBLK$(3) -> OUT$BLK.CODE);
      277     9989    5                       CASE (26);
      278     9990    5                            EVAL_CASE = 6;
      279     9991    5                       CASE (27);
      280     9992    5                            EVAL_CASE = 7;
      281     9993    5                       END;
      282     9994    4                  II1 = ' ';
      283     9995    4                  CALL INSERT (II1,
      284     9996    4                                 LENGTHC (II1) -
      285     9997    4                                 (PTR$ -> OUT$BLK.SUBLK$(3) -> OUT$BLK.SUBLK$(0) ->
              9997                                          OUT$SYM.COUNT),
      286     9998    4                                 ,
      287     9999    4                                 PTR$ -> OUT$BLK.SUBLK$(3) -> OUT$BLK.SUBLK$(0) ->
              9999                                          OUT$SYM.TEXT);
      288    10000    4                  CALL CHARBIN (BI1, II1);
      289    10001    4                  END;
      290    10002
      291    10003    3               END;
      292    10004    2   END GET$REST;
      293    10005        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:11   
      294    10006    1   BREAKDOWN: PROC;
      295    10007
      296    10008
      297    10009    2        TEMP_MONTHS = BM1;
      298    10010    2        TEMP_DAYS = BD1;
      299    10011    2        TEMP_YEARS = BY1;
      300    10012    2        CALL IAM$LEAP;
      301    10013    2        CALL VALIDATE;
      302    10014    2        IF DATE_STATUS
      303    10015    2        THEN
      304    10016    2             RETURN;
      305    10017    2        CALL IAM$CYCLE;
      306    10018    2        CYCLE_DAYS_LAST = TOTAL_DAYS;
      307    10019
      308    10020    3        DO CASE (EVAL_CASE);
      309    10021    3             CASE (3);
      310    10022    3                  JULIAN = JULIAN + BNNNN;
      311    10023    3                  IF JULIAN > 365 + BITBIN (LEAP)
      312    10024    3                  THEN
      313    10025    4                    DO WHILE JULIAN > 365 + BITBIN (LEAP);
      314    10026    4                       JULIAN = JULIAN - (365 + BITBIN (LEAP));
      315    10027    4                       TEMP_YEARS = TEMP_YEARS + 1;
      316    10028    4                       CALL IAM$LEAP;
      317    10029    4                       END;
      318    10030
      319    10031    3                  TEMP_JUL = JULIAN;
      320    10032    3                  CALL GET$MDY_J;
      321    10033    3                  BY1 = TEMP_YEARS;
      322    10034    3                  BM1 = TEMP_MONTHS;
      323    10035    3                  BD1 = TEMP_DAYS;
      324    10036    3                  CALL IAM$CYCLE;
      325    10037    3                  CALL SEND$OUT;
      326    10038
      327    10039
      328    10040    3             CASE (4);
      329    10041    3                  JULIAN = JULIAN - BNNNN;
      330    10042    3                  IF JULIAN <= 0
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:12   
      331    10043    3                  THEN
      332    10044    4                    DO WHILE JULIAN <= 0;
      333    10045    4                       TEMP_YEARS = TEMP_YEARS - 1;
      334    10046    4                       CALL IAM$LEAP;
      335    10047    4                       JULIAN = JULIAN + 365 + BITBIN (LEAP);
      336    10048    4                       END;
      337    10049
      338    10050    3                  TEMP_JUL = JULIAN;
      339    10051    3                  CALL GET$MDY_J;
      340    10052    3                  BY1 = TEMP_YEARS;
      341    10053    3                  BM1 = TEMP_MONTHS;
      342    10054    3                  BD1 = TEMP_DAYS;
      343    10055    3                  CALL IAM$CYCLE;
      344    10056    3                  CALL SEND$OUT;
      345    10057
      346    10058
      347    10059
      348    10060    3             CASE (5,6,7);
      349    10061    3                  TEMP_YEARS = BY2;
      350    10062    3                  TEMP_MONTHS = BM2;
      351    10063    3                  TEMP_DAYS = BD2;
      352    10064    3                  CALL IAM$LEAP;
      353    10065    3                  CALL VALIDATE;
      354    10066    3                  IF DATE_STATUS
      355    10067    3                  THEN
      356    10068    3                       RETURN;
      357    10069    3                  CALL IAM$CYCLE;
      358    10070
      359    10071    3                  IF (BY1/400) = (BY2 / 400)
      360    10072    3                  THEN
      361    10073    4                    DO;
      362    10074    4                       IF TOTAL_DAYS = CYCLE_DAYS_LAST
      363    10075    4                       THEN
      364    10076    5                         DO;
      365    10077    5                            RESULT = 0;
      366    10078    5                            END;
      367    10079    4                       ELSE
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:13   
      368    10080    5                         DO;
      369    10081    5                            IF TOTAL_DAYS > CYCLE_DAYS_LAST
      370    10082    5                            THEN
      371    10083    6                              DO;
      372    10084    6                                 RESULT = TOTAL_DAYS - CYCLE_DAYS_LAST;
      373    10085    6                                 END;
      374    10086    5                            ELSE
      375    10087    5                              RESULT = CYCLE_DAYS_LAST - TOTAL_DAYS;
      376    10088    5                            END;
      377    10089    4                       END;
      378    10090
      379    10091    3                  IF (BY1 / 400) < (BY2 / 400)
      380    10092    3                  THEN
      381    10093    3                       RESULT = ((((BY2S /400) - 1) - (BY1S / 400)) * (146097))
      382    10094    3                                 + TOTAL_DAYS + ((146097) - CYCLE_DAYS_LAST);
      383    10095
      384    10096    3                  IF (BY1 / 400) > (BY2 / 400)
      385    10097    3                  THEN
      386    10098    3                       RESULT = ((((BY1S / 400) - 1) - (BY2S / 400)) * (146097))
      387    10099    3                                 + CYCLE_DAYS_LAST - ((146097) - TOTAL_DAYS);
      388    10100
      389    10101
      390    10102    3                  MESS_BUF = 'Difference = ';
      391    10103    3                  CALL BINCHAR (NNNN, RESULT);
      392    10104    3                  X = 0;
      393    10105    3                  LENGTH = 10;
      394    10106    4                  DO UNTIL X = 9;
      395    10107    4                       IF SUBSTR (NNNN, X, 1) = '0'
      396    10108    4                       THEN
      397    10109    5                         DO;
      398    10110    5                            X = X + 1;
      399    10111    5                            LENGTH = LENGTH - 1;
      400    10112    5                            END;
      401    10113    4                       ELSE
      402    10114    5                         DO;
      403    10115    5                            X = 9;
      404    10116    5                            END;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:14   
      405    10117    4                       END;
      406    10118    3                  CALL INSERT (MESS_BUF, 13, LENGTH,
      407    10119    3                       SUBSTR (NNNN, LENGTHC (NNNN) - LENGTH, LENGTH));
      408    10120
      409    10121
      410    10122    3                  CALL INSERT (MESS_BUF, 13 + LENGTH + 1, 4, 'Days');
      411    10123
      412    10124    3                  CALL M$WRITE (WRITE_OUT);
      413    10125
      414    10126    3                  IF EVAL_CASE = 6 OR EVAL_CASE = 7
      415    10127    3                  THEN
      416    10128    4                    DO;
      417    10129    4                       IF EVAL_CASE = 6
      418    10130    4                       THEN
      419    10131    4                            RESULT = (RESULT * 24 * 60) / BI1;
      420    10132    4                       ELSE
      421    10133    4                            RESULT = RESULT / BI1;
      422    10134    4                       MESS_BUF = 'Intervals  = ';
      423    10135    4                       CALL BINCHAR (NNNN, RESULT);
      424    10136    4                       X = 0;
      425    10137    4                       LENGTH = 10;
      426    10138    5                       DO UNTIL X = 9;
      427    10139    5                            IF SUBSTR (NNNN, X, 1) = '0'
      428    10140    5                            THEN
      429    10141    6                              DO;
      430    10142    6                                 X = X + 1;
      431    10143    6                                 LENGTH = LENGTH - 1;
      432    10144    6                                 END;
      433    10145    5                            ELSE
      434    10146    6                              DO;
      435    10147    6                                 X = 9;
      436    10148    6                                 END;
      437    10149    5                            END;
      438    10150    4                        CALL INSERT (MESS_BUF, 13, LENGTH,
      439    10151    4                            SUBSTR (NNNN, LENGTHC (NNNN) - LENGTH, LENGTH));
      440    10152    4                       CALL M$WRITE (WRITE_OUT);
      441    10153    4                       END;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:15   
      442    10154
      443    10155
      444    10156    3             CASE (ELSE);
      445    10157    3                  CALL SEND$OUT;
      446    10158
      447    10159    3             END;
      448    10160
      449    10161    2   END BREAKDOWN;
      450    10162        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:16   
      451    10163    1   GET$MDY_J: PROC;
      452    10164
      453    10165    2        TEMP_DAYS = 0;
      454    10166    2        TEMP_MONTHS = 0;
      455    10167    3        DO UNTIL TEMP_DAYS > 0;
      456    10168    3             TEMP_MONTHS = TEMP_MONTHS + 1;
      457    10169    3             IF TEMP_JUL <= (JUL_TABLE (TEMP_MONTHS)
      458    10170    3                  + BITBIN ((TEMP_MONTHS > 1) & (LEAP)))
      459    10171    3             THEN
      460    10172    3                  TEMP_DAYS = TEMP_JUL - (JUL_TABLE (TEMP_MONTHS - 1)
      461    10173    3                       + BITBIN ((TEMP_MONTHS > 2) & (LEAP)));
      462    10174    3             END;
      463    10175    2   END GET$MDY_J;
      464    10176        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:17   
      465    10177    1   VALIDATE: PROC;
      466    10178
      467    10179    2        DATE_STATUS = %NO#;           /*  Assume Date is OK  */
      468    10180    2        IF TEMP_MONTHS ~= 0
      469    10181    2        THEN
      470    10182    3          DO;
      471    10183    3             IF TEMP_MONTHS > 12 OR TEMP_DAYS < 1
      472    10184    3             OR
      473    10185    3             TEMP_DAYS > (JUL_TABLE (TEMP_MONTHS)
      474    10186    3                  - JUL_TABLE (TEMP_MONTHS - 1)
      475    10187    3                  + BITBIN ((TEMP_MONTHS > 1) & (LEAP)))
      476    10188    3             THEN
      477    10189    3                  DATE_STATUS = %YES#;
      478    10190    3             END;
      479    10191    2        ELSE
      480    10192    2             DATE_STATUS = %YES#;
      481    10193
      482    10194    2        RETURN;
      483    10195
      484    10196    2   END VALIDATE;
      485    10197        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:18   
      486    10198
      487    10199    1   SEND$OUT: PROC;
      488    10200
      489    10201    2        CALL BINCHAR (OY, BY1);
      490    10202    2        CALL BINCHAR (OM, BM1);
      491    10203    2        CALL BINCHAR (OD, BD1);
      492    10204    2        CALL BINCHAR (O_WEEK_OF_MONTH, WEEK_OF_MONTH);
      493    10205    2        CALL BINCHAR (O_WEEK_OF_YEAR, WEEK_OF_YEAR);
      494    10206    2        CALL BINCHAR (OJULIAN, JULIAN);
      495    10207
      496    10208
      497    10209    2        MESS_BUF = ' ';
      498    10210    2        CALL INDEX (LENGTH, 'y', DAYNAME);
      499    10211    2        COUNT = LENGTH+1;
      500    10212    2        CALL INSERT (MESS_BUF, 0, LENGTH + 1, DAYNAME);
      501    10213    2        CALL INSERT (MESS_BUF, COUNT, 2, ', ');
      502    10214    2        COUNT = COUNT + 2;
      503    10215
      504    10216    2        CALL INDEX (LENGTH, ' ', MONTHNAME);
      505    10217    2        CALL INSERT (MESS_BUF, COUNT, LENGTH, MONTHNAME);
      506    10218    2        COUNT = COUNT + LENGTH;
      507    10219    2        CALL INSERT (MESS_BUF, COUNT, 1, ' ');
      508    10220    2        COUNT = COUNT + 1;
      509    10221    2        IF BD1 < 10
      510    10222    2        THEN
      511    10223    3          DO;
      512    10224    3             CALL INSERT (MESS_BUF, COUNT - 1, 4, OD, ', ');
      513    10225    3             CALL INSERT (MESS_BUF, COUNT - 1, 1, ' ');
      514    10226    3             COUNT = COUNT + 3;
      515    10227    3             END;
      516    10228    2        ELSE
      517    10229    3          DO;
      518    10230    3             CALL INSERT (MESS_BUF, COUNT, 4, OD, ', ');
      519    10231    3             COUNT = COUNT + 4;
      520    10232    3             END;
      521    10233    2        CALL INSERT (MESS_BUF, COUNT, 1, ' ');
      522    10234    2        CALL INSERT (MESS_BUF, COUNT, 4, OY);
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:19   
      523    10235    2        CALL M$WRITE (WRITE_OUT);
      524    10236    2        IF TYPE = 'J'
      525    10237    2        THEN
      526    10238    3          DO;
      527    10239    3             CALL INSERT (SLASH, 0, 2, OM);
      528    10240    3             CALL INSERT (SLASH, 3, 2, OD);
      529    10241    3             CALL INSERT (SLASH, 6, 4, OY);
      530    10242    3             IF BM1 < 10
      531    10243    3             THEN
      532    10244    3                  CALL INSERT (SLASH, 0, 1, ' ');
      533    10245    3             IF BD1 < 10
      534    10246    3             THEN
      535    10247    3                  CALL INSERT (SLASH, 3, 1, ' ');
      536    10248    3             MESS_BUF = SLASH;
      537    10249    3             CALL M$WRITE (WRITE_OUT);
      538    10250    3             END;
      539    10251    2        ELSE
      540    10252    3          DO;
      541    10253    3            CALL CONCAT (MESS_BUF, 'Julian day..............');
      542    10254    3            X = 0;
      543    10255    3            LENGTH = 4;
      544    10256    4            DO UNTIL X = 2;
      545    10257    4                 IF SUBSTR (OJULIAN, X, 1) = '0'
      546    10258    4                 THEN
      547    10259    5                   DO;
      548    10260    5                      X = X + 1;
      549    10261    5                      LENGTH = LENGTH - 1;
      550    10262    5                      END;
      551    10263    4                 ELSE
      552    10264    4                      X = 2;
      553    10265    4                 END;
      554    10266    3            CALL INSERT (MESS_BUF, 24, LENGTH,
      555    10267    3                      SUBSTR (OJULIAN, LENGTHC (OJULIAN) - LENGTH, LENGTH));
      556    10268    3            CALL M$WRITE (WRITE_OUT);
      557    10269    3             END;
      558    10270    2        CALL CONCAT (MESS_BUF, 'Week of year............');
      559    10271    2        LENGTH = 2;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:20   
      560    10272    2        IF SUBSTR (O_WEEK_OF_YEAR, 0, 1) = '0'
      561    10273    2        THEN
      562    10274    2             LENGTH = LENGTH - 1;
      563    10275    2        CALL INSERT (MESS_BUF, 24, LENGTH,
      564    10276    2                  SUBSTR (O_WEEK_OF_YEAR, LENGTHC (O_WEEK_OF_YEAR) - LENGTH, LENGTH));
      565    10277    2        CALL M$WRITE (WRITE_OUT);
      566    10278    2        CALL CONCAT (MESS_BUF, 'Week of month...........');
      567    10279    2        LENGTH = 2;
      568    10280    2        IF SUBSTR (O_WEEK_OF_MONTH, 0, 1) = '0'
      569    10281    2        THEN
      570    10282    2             LENGTH = LENGTH - 1;
      571    10283    2        CALL INSERT (MESS_BUF, 24, LENGTH,
      572    10284    2                  SUBSTR (O_WEEK_OF_MONTH, LENGTHC (O_WEEK_OF_MONTH) - LENGTH, LENGTH))
             10284                           ;
      573    10285    2        CALL M$WRITE (WRITE_OUT);
      574    10286                                                /**/
      575    10287                                                /**/
      576    10288    2        IF LEAP
      577    10289    2        THEN
      578    10290    2            MESS_BUF = 'Leap year...............Yes';
      579    10291    2        ELSE
      580    10292    2            MESS_BUF = 'Leap year...............No';
      581    10293    2        CALL M$WRITE (WRITE_OUT);
      582    10294
      583    10295    2   END SEND$OUT;
      584    10296    1   END IAD$DATE;
      585    10297

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:21   
--  Include file information  --

   B$JIT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   IA_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   IA_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure IAD$DATE.

   Procedure IAD$DATE requires 1020 words for executable code.
   Procedure IAD$DATE requires 10 words of local(AUTO) storage.

    No errors detected in file IAD$DATE.:E05TSI    .

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:22   

 Object Unit name= IAD$DATE                                   File name= IAD$DATE.:E05TOU
 UTS= JUL 29 '97 22:25:34.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$DO
    2   Data  even  none    50     62  IAD$DATE
    3  RoData even  UTS     46     56  IAD$DATE
    4   Proc  even  none  1020   1774  IAD$DATE
    5  RoData even  none     5      5  IAD$DATE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        0  IAD$DATE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 IAM$LEAP
         yes           Std       0 IAM$CYCLE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:23   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  DAYNAME                               MONTHNAME
     JUL_TABLE                             MESS_BUF                              TEMP_DAYS
     TEMP_MONTHS                           TEMP_YEARS                            TEMP_JUL
     JULIAN                                CYCLE_DAYS_LAST                       TOTAL_DAYS
     WEEK_OF_MONTH                         WEEK_OF_YEAR                          LEAP
     GOOSE_OUT$                            M$DO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:24   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        IAD$DATE: PROC ALTRET;

      6  4 000000   000000 700200 xent  IAD$DATE     TSX0  ! X66_AUTO_0
         4 000001   000012 000000                    ZERO    10,0

        7        7
        8        8
        9        9
       10       10        %INCLUDE CP_6;
       11     5569        %INCLUDE CP_6_SUBS;
       12     6109        %INCLUDE IA_SUBS_C;
       13     6179        %INCLUDE IA_DAT_R;
       14     6197        %INCLUDE XU_MACRO_C;
       15     9303        %INCLUDE B$JIT_C;
       16     9617
       17     9618    1   DCL IAM$CYCLE ENTRY;
       18     9619    1   DCL IAM$LEAP ENTRY;
       19     9620
       20     9621    1   DCL GOOSE_OUT$ PTR SYMREF;     /* Set to ONLINE_GETCMD.OUT$ in IAA$MAIN. */
       21     9622
       22     9623
       23     9624             %PARSE$OUT (NAME=OUT$BLK,STCLASS=BASED);
       24     9669             %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
       25     9707
       26     9708    1   DCL M$DO DCB;
       27     9709
       28     9710    1   DCL NNNN CHAR(10) CALIGNED STATIC INIT (' ');
       29     9711    1   DCL IJ1 CHAR(3) CALIGNED STATIC INIT (' ');
       30     9712    1   DCL IJ2 CHAR(3) CALIGNED STATIC INIT (' ');
       31     9713    1   DCL IY1 CHAR(4) CALIGNED STATIC INIT (' ');
       32     9714    1   DCL IY2 CHAR(4) CALIGNED STATIC INIT (' ');
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:25   
       33     9715    1   DCL IM1 CHAR(2) CALIGNED STATIC INIT (' ');
       34     9716    1   DCL IM2 CHAR(2) CALIGNED STATIC INIT (' ');
       35     9717    1   DCL ID1 CHAR(2) CALIGNED STATIC INIT (' ');
       36     9718    1   DCL ID2 CHAR(2) CALIGNED STATIC INIT (' ');
       37     9719    1   DCL II1 CHAR(4) CALIGNED STATIC INIT ('0');
       38     9720    1   DCL EVAL_CASE UBIN BYTE STATIC ALIGNED INIT (0);
       39     9721    1   DCL BY1 UBIN WORD STATIC ALIGNED INIT (0000);
       40     9722    1   DCL BY1S REDEF BY1 SBIN;
       41     9723    1   DCL BY2 UBIN WORD STATIC ALIGNED INIT (0000);
       42     9724    1   DCL BY2S REDEF BY2 SBIN;
       43     9725    1   DCL BM1 UBIN WORD STATIC ALIGNED INIT (00);
       44     9726    1   DCL BM2 UBIN WORD STATIC ALIGNED INIT (00);
       45     9727    1   DCL BD1 UBIN WORD STATIC ALIGNED INIT (00);
       46     9728    1   DCL BD2 UBIN WORD STATIC ALIGNED INIT (00);
       47     9729    1   DCL BI1 SBIN WORD STATIC ALIGNED INIT (0);
       48     9730
       49     9731    1   DCL PTR$ PTR;
       50     9732
       51     9733    1   DCL RESULT SBIN WORD STATIC ALIGNED INIT (0);
       52     9734    1   DCL OY CHAR(4) STATIC INIT (' ');
       53     9735    1   DCL OD CHAR(2) STATIC CALIGNED INIT (' ');
       54     9736    1   DCL OM CHAR(2) STATIC CALIGNED INIT (' ');
       55     9737    1   DCL COUNT SBIN WORD STATIC ALIGNED INIT (0);
       56     9738    1   DCL LENGTH SBIN WORD STATIC ALIGNED INIT (0);
       57     9739    1   DCL BNNNN UBIN WORD STATIC ALIGNED INIT (0);
       58     9740    1   DCL SUBS UBIN WORD STATIC ALIGNED INIT (0);
       59     9741    1   DCL OJULIAN CHAR(4) STATIC CALIGNED INIT (' ');
       60     9742    1   DCL X UBIN WORD STATIC ALIGNED INIT (0);
       61     9743    1   DCL DATE_STATUS BIT(1) STATIC ALIGNED INIT ('0'B);
       62     9744    1   DCL TYPE CHAR(1) STATIC CALIGNED INIT (' ');
       63     9745
       64     9746    1   DCL SLASH CHAR(10) STATIC CALIGNED INIT ('  /  /    ');
       65     9747    1   DCL O_WEEK_OF_MONTH CHAR (2) STATIC CALIGNED INIT (' ');
       66     9748    1   DCL O_WEEK_OF_YEAR CHAR (2) STATIC CALIGNED INIT (' ');
       67     9749
       68     9750
       69     9751             %FPT_WRITE     (FPTN=WRITE_OUT,
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:26   
       70     9752                                 DCB=M$DO,
       71     9753                                 BUF=MESS_BUF,
       72     9754                                 WAIT=YES);
       73     9785
       74     9786
       75     9787
       76     9788        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:27   
       77     9789
       78     9790    1             LEAP = %NO#;

   9790  4 000002   000000 450000 xsym               STZ     LEAP

       79     9791
       80     9792    2        DO CASE (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE);

   9792  4 000003   000000 470400 xsym               LDP0    GOOSE_OUT$
         4 000004   000003 471500                    LDP1    3,,PR0
         4 000005   100000 720100                    LXL0    0,,PR1
         4 000006   000003 100003                    CMPX0   3,DU
         4 000007   000011 602010 4                  TNC     s:9792+6,X0
         4 000010   000246 710000 4                  TRA     s:9866
         4 000011   000246 710000 4                  TRA     s:9866
         4 000012   000014 710000 4                  TRA     s:9795
         4 000013   000125 710000 4                  TRA     s:9830

       81     9793
       82     9794    2             CASE (1);

       83     9795    2                  IJ1 = ' ';

   9795  4 000014   000000 236000 5                  LDQ     0
         4 000015   000003 756000 2                  STQ     IJ1

       84     9796    2                  IY1 = ' ';

   9796  4 000016   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000017   000005 756000 2                  STQ     IY1

       85     9797    2                  TYPE = 'J';

   9797  4 000020   112000 236003                    LDQ     37888,DU
         4 000021   000037 756000 2                  STQ     TYPE

       86     9798    2                  EVAL_CASE = 1;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:28   

   9798  4 000022   001000 236003                    LDQ     512,DU
         4 000023   000014 756000 2                  STQ     EVAL_CASE

       87     9799    2                  CALL INSERT (IJ1,

   9799  4 000024   100003 473500                    LDP3    3,,PR1
         4 000025   300004 236100                    LDQ     4,,PR3
         4 000026   000033 772000                    QRL     27
         4 000027   000000 621006                    EAX1    0,QL
         4 000030   000000 635011                    EAA     0,X1
         4 000031   000022 771000                    ARL     18
         4 000032   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000033   000001 035007                    ADLA    1,DL
         4 000034   000000 622006                    EAX2    0,QL
         4 000035   040045 100540                    MLR     fill='040'O
         4 000036   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 000037   000003 600012 2                  ADSC9   IJ1,A                    cn=3,n=*X2

       88     9800    2                                 LENGTHC (IJ1) -
       89     9801    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0)
              9801                                          -> OUT$SYM.COUNT),
       90     9802    2                                 ,
       91     9803    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0)
              9803                                          -> OUT$SYM.TEXT);
       92     9804    2                  CALL INSERT (IY1,

   9804  4 000040   100004 474500                    LDP4    4,,PR1
         4 000041   400004 236100                    LDQ     4,,PR4
         4 000042   000033 772000                    QRL     27
         4 000043   000000 622006                    EAX2    0,QL
         4 000044   000000 635012                    EAA     0,X2
         4 000045   000022 771000                    ARL     18
         4 000046   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000047   000001 035007                    ADLA    1,DL
         4 000050   000000 623006                    EAX3    0,QL
         4 000051   040045 100540                    MLR     fill='040'O
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:29   
         4 000052   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         4 000053   000006 000013 2                  ADSC9   IY2,A                    cn=0,n=*X3

       93     9805    2                                 LENGTHC (IY1) -
       94     9806    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(1)
              9806                                          -> OUT$SYM.COUNT),
       95     9807    2                                 ,
       96     9808    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(1)
              9808                                          -> OUT$SYM.TEXT);
       97     9809
       98     9810    2                  IF SUBSTR (IY1, 0, 2) = '  ' AND SUBSTR (IY1, 2, 2) >= '78'

   9810  4 000054   000005 223000 2                  LDX3    IY1
         4 000055   000000 103000 3                  CMPX3   0
         4 000056   000065 601000 4                  TNZ     s:9814
         4 000057   000005 724000 2                  LXL4    IY1
         4 000060   000001 104000 3                  CMPX4   1
         4 000061   000065 602000 4                  TNC     s:9814

       99     9811    2                  THEN
      100     9812    2                     CALL INSERT (IY1, 0, 2, '19');

   9812  4 000062   000002 225000 3                  LDX5    2
         4 000063   000005 745000 2                  STX5    IY1
         4 000064   000071 710000 4                  TRA     s:9818

      101     9813    2                  ELSE
      102     9814    2                  IF SUBSTR (IY1, 0, 2) = '  '

   9814  4 000065   000000 103000 3                  CMPX3   0
         4 000066   000071 601000 4                  TNZ     s:9818

      103     9815    2                  THEN
      104     9816    2                     CALL INSERT (IY1, 0, 2, '20');

   9816  4 000067   000003 224000 3                  LDX4    3
         4 000070   000005 744000 2                  STX4    IY1
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:30   

      105     9817
      106     9818    2        CALL CHARBIN (BY1, IY1);

   9818  4 000071   000100 305400                    DTB
         4 000072   000005 030004 2                  NDSC9   IY1                      cn=0,s=nosgn,sf=0,n=4
         4 000073   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000074   200011 235100                    LDA     PTR$+6,,AUTO
         4 000075   000015 755000 2                  STA     BY1

      107     9819    2        TEMP_YEARS = BY1;

   9819  4 000076   000000 755000 xsym               STA     TEMP_YEARS

      108     9820    2        CALL IAM$LEAP;

   9820  4 000077   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000100   000000 701000 xent               TSX1    IAM$LEAP
         4 000101   000000 011000                    NOP     0

      109     9821    2                  CALL CHARBIN (TEMP_JUL, IJ1);

   9821  4 000102   000000 305400                    DTB
         4 000103   000003 030003 2                  NDSC9   IJ1                      cn=0,s=nosgn,sf=0,n=3
         4 000104   000000 000004 xsym               NDSC9   TEMP_JUL                 cn=0,s=lsgnf,sf=0,n=4

      110     9822    2                  CALL GET$MDY_J;

   9822  4 000105   001336 701000 4                  TSX1    GET$MDY_J
         4 000106   000000 011000                    NOP     0

      111     9823    2                  BM1 = TEMP_MONTHS;

   9823  4 000107   000000 235000 xsym               LDA     TEMP_MONTHS
         4 000110   000017 755000 2                  STA     BM1

      112     9824    2                  BD1 = TEMP_DAYS;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:31   

   9824  4 000111   000000 236000 xsym               LDQ     TEMP_DAYS
         4 000112   000021 756000 2                  STQ     BD1

      113     9825    2                  SUBS = GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.NSUBLKS;

   9825  4 000113   000000 470400 xsym               LDP0    GOOSE_OUT$
         4 000114   000003 471500                    LDP1    3,,PR0
         4 000115   100001 236100                    LDQ     1,,PR1
         4 000116   000022 772000                    QRL     18
         4 000117   000033 756000 2                  STQ     SUBS

      114     9826    2                  IF SUBS > 2

   9826  4 000120   000003 116007                    CMPQ    3,DL
         4 000121   000246 602000 4                  TNC     s:9866

      115     9827    2                  THEN
      116     9828    2                       CALL GET$REST;

   9828  4 000122   000254 701000 4                  TSX1    GET$REST
         4 000123   000000 011000                    NOP     0
         4 000124   000246 710000 4                  TRA     s:9866

      117     9829    2             CASE (2);

      118     9830    2                  EVAL_CASE = 2;

   9830  4 000125   002000 236003                    LDQ     1024,DU
         4 000126   000014 756000 2                  STQ     EVAL_CASE

      119     9831    2                  TYPE = 'M';

   9831  4 000127   115000 236003                    LDQ     39424,DU
         4 000130   000037 756000 2                  STQ     TYPE

      120     9832    2                  IY1 =  ' ';
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:32   

   9832  4 000131   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000132   000005 756000 2                  STQ     IY1

      121     9833    2                  IM1 = ' ';

   9833  4 000133   040040 221003                    LDX1    16416,DU
         4 000134   000007 741000 2                  STX1    IM1

      122     9834    2                  ID1 = ' ';

   9834  4 000135   000011 741000 2                  STX1    ID1

      123     9835    2                  CALL INSERT (IM1,

   9835  4 000136   100003 473500                    LDP3    3,,PR1
         4 000137   300004 236100                    LDQ     4,,PR3
         4 000140   000033 772000                    QRL     27
         4 000141   000000 622006                    EAX2    0,QL
         4 000142   000000 635012                    EAA     0,X2
         4 000143   000022 771000                    ARL     18
         4 000144   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000145   000001 035007                    ADLA    1,DL
         4 000146   000000 623006                    EAX3    0,QL
         4 000147   040045 100540                    MLR     fill='040'O
         4 000150   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 000151   000007 400013 2                  ADSC9   IM1,A                    cn=2,n=*X3

      124     9836    2                                 LENGTHC (IM1) -
      125     9837    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0)
              9837                                          -> OUT$SYM.COUNT),
      126     9838    2                                 ,
      127     9839    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(0)
              9839                                          -> OUT$SYM.TEXT);
      128     9840    2                  CALL INSERT (ID1,

   9840  4 000152   100004 474500                    LDP4    4,,PR1
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:33   
         4 000153   400004 236100                    LDQ     4,,PR4
         4 000154   000033 772000                    QRL     27
         4 000155   000000 623006                    EAX3    0,QL
         4 000156   000000 635013                    EAA     0,X3
         4 000157   000022 771000                    ARL     18
         4 000160   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000161   000001 035007                    ADLA    1,DL
         4 000162   000000 624006                    EAX4    0,QL
         4 000163   040045 100540                    MLR     fill='040'O
         4 000164   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         4 000165   000011 400014 2                  ADSC9   ID1,A                    cn=2,n=*X4

      129     9841    2                                 LENGTHC (ID1) -
      130     9842    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(1)
              9842                                          -> OUT$SYM.COUNT),
      131     9843    2                                 ,
      132     9844    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(1)
              9844                                          -> OUT$SYM.TEXT);
      133     9845    2                  CALL INSERT (IY1,

   9845  4 000166   100005 475500                    LDP5    5,,PR1
         4 000167   500004 236100                    LDQ     4,,PR5
         4 000170   000033 772000                    QRL     27
         4 000171   000000 624006                    EAX4    0,QL
         4 000172   000000 635014                    EAA     0,X4
         4 000173   000022 771000                    ARL     18
         4 000174   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000175   000001 035007                    ADLA    1,DL
         4 000176   000000 625006                    EAX5    0,QL
         4 000177   040045 100540                    MLR     fill='040'O
         4 000200   500004 200014                    ADSC9   4,,PR5                   cn=1,n=*X4
         4 000201   000006 000015 2                  ADSC9   IY2,A                    cn=0,n=*X5

      134     9846    2                                 LENGTHC (IY1) -
      135     9847    2                                 (GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(2)
              9847                                          -> OUT$SYM.COUNT),
      136     9848    2                                 ,
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:34   
      137     9849    2                                 GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(2)
              9849                                          -> OUT$SYM.TEXT);
      138     9850
      139     9851    2                  IF SUBSTR (IY1, 0, 2) = '  ' AND SUBSTR (IY1, 2, 2) >= '78'

   9851  4 000202   000005 225000 2                  LDX5    IY1
         4 000203   000000 105000 3                  CMPX5   0
         4 000204   000213 601000 4                  TNZ     s:9855
         4 000205   000005 726000 2                  LXL6    IY1
         4 000206   000001 106000 3                  CMPX6   1
         4 000207   000213 602000 4                  TNC     s:9855

      140     9852    2                  THEN
      141     9853    2                     CALL INSERT (IY1, 0, 2, '19');

   9853  4 000210   000002 227000 3                  LDX7    2
         4 000211   000005 747000 2                  STX7    IY1
         4 000212   000217 710000 4                  TRA     s:9858

      142     9854    2                  ELSE
      143     9855    2                  IF SUBSTR (IY1, 0, 2) = '  '

   9855  4 000213   000000 105000 3                  CMPX5   0
         4 000214   000217 601000 4                  TNZ     s:9858

      144     9856    2                  THEN
      145     9857    2                     CALL INSERT (IY1, 0, 2, '20');

   9857  4 000215   000003 226000 3                  LDX6    3
         4 000216   000005 746000 2                  STX6    IY1

      146     9858    2                  CALL CHARBIN (BM1, IM1);

   9858  4 000217   000100 305400                    DTB
         4 000220   000007 030002 2                  NDSC9   IM1                      cn=0,s=nosgn,sf=0,n=2
         4 000221   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000222   200011 235100                    LDA     PTR$+6,,AUTO
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:35   
         4 000223   000017 755000 2                  STA     BM1

      147     9859    2                  CALL CHARBIN (BD1, ID1);

   9859  4 000224   000100 305400                    DTB
         4 000225   000011 030002 2                  NDSC9   ID1                      cn=0,s=nosgn,sf=0,n=2
         4 000226   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000227   200011 236100                    LDQ     PTR$+6,,AUTO
         4 000230   000021 756000 2                  STQ     BD1

      148     9860    2                  CALL CHARBIN (BY1, IY1);

   9860  4 000231   000100 305400                    DTB
         4 000232   000005 030004 2                  NDSC9   IY1                      cn=0,s=nosgn,sf=0,n=4
         4 000233   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000234   200011 235100                    LDA     PTR$+6,,AUTO
         4 000235   000015 755000 2                  STA     BY1

      149     9861    2                  SUBS = GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.NSUBLKS;

   9861  4 000236   000003 471500                    LDP1    3,,PR0
         4 000237   100001 236100                    LDQ     1,,PR1
         4 000240   000022 772000                    QRL     18
         4 000241   000033 756000 2                  STQ     SUBS

      150     9862    2                  IF  SUBS > 3

   9862  4 000242   000004 116007                    CMPQ    4,DL
         4 000243   000246 602000 4                  TNC     s:9866

      151     9863    2                  THEN
      152     9864    2                       CALL GET$REST;

   9864  4 000244   000254 701000 4                  TSX1    GET$REST
         4 000245   000000 011000                    NOP     0

      153     9865    2                  END;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:36   

      154     9866    1                  CALL BREAKDOWN;

   9866  4 000246   000701 701000 4                  TSX1    BREAKDOWN
         4 000247   000000 011000                    NOP     0

      155     9867    1          IF DATE_STATUS

   9867  4 000250   000036 234000 2                  SZN     DATE_STATUS
         4 000251   000253 605000 4                  TPL     s:9871

      156     9868    1          THEN
      157     9869    1            ALTRETURN;

   9869  4 000252   000000 702200 xent               TSX2  ! X66_AALT

      158     9870    1          ELSE
      159     9871    1                  RETURN;

   9871  4 000253   000000 702200 xent               TSX2  ! X66_ARET

      160     9872        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:37   
      161     9873    1   GET$REST: PROC;

   9873  4 000254   200004 741300       GET$REST     STX1  ! PTR$+1,,AUTO

      162     9874    2        IF TYPE = 'J'

   9874  4 000255   000037 236000 2                  LDQ     TYPE
         4 000256   777000 376003                    ANQ     -512,DU
         4 000257   112000 116003                    CMPQ    37888,DU
         4 000260   000266 601000 4                  TNZ     s:9878

      163     9875    2        THEN
      164     9876    2           PTR$ = GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(2);

   9876  4 000261   000000 470400 xsym               LDP0    GOOSE_OUT$
         4 000262   000003 471500                    LDP1    3,,PR0
         4 000263   100005 236100                    LDQ     5,,PR1
         4 000264   200003 756100                    STQ     PTR$,,AUTO
         4 000265   000272 710000 4                  TRA     s:9879

      165     9877    2        ELSE
      166     9878    2            PTR$ = GOOSE_OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.SUBLK$(3);

   9878  4 000266   000000 470400 xsym               LDP0    GOOSE_OUT$
         4 000267   000003 471500                    LDP1    3,,PR0
         4 000270   100006 236100                    LDQ     6,,PR1
         4 000271   200003 756100                    STQ     PTR$,,AUTO

      167     9879    3        DO CASE (PTR$ -> OUT$BLK.CODE);

   9879  4 000272   200003 473500                    LDP3    PTR$,,AUTO
         4 000273   300000 236100                    LDQ     0,,PR3
         4 000274   777777 376007                    ANQ     -1,DL
         4 000275   000012 136007                    SBLQ    10,DL
         4 000276   000004 116007                    CMPQ    4,DL
         4 000277   000301 602006 4                  TNC     s:9879+7,QL
         4 000300   000677 710000 4                  TRA     s:10004
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:38   
         4 000301   000363 710000 4                  TRA     s:9903
         4 000302   000526 710000 4                  TRA     s:9953
         4 000303   000305 710000 4                  TRA     s:9881
         4 000304   000334 710000 4                  TRA     s:9892

      168     9880    3             CASE (12);

      169     9881    3                   EVAL_CASE = 3;

   9881  4 000305   003000 236003                    LDQ     1536,DU
         4 000306   000014 756000 2                  STQ     EVAL_CASE

      170     9882    3                  NNNN = ' ';

   9882  4 000307   040000 100400                    MLR     fill='040'O
         4 000310   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000311   000000 000012 2                  ADSC9   NNNN                     cn=0,n=10

      171     9883    3                  CALL INSERT (NNNN,

   9883  4 000312   300003 474500                    LDP4    3,,PR3
         4 000313   400004 236100                    LDQ     4,,PR4
         4 000314   000033 772000                    QRL     27
         4 000315   000000 620006                    EAX0    0,QL
         4 000316   000000 635010                    EAA     0,X0
         4 000317   000022 771000                    ARL     18
         4 000320   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000321   000001 035007                    ADLA    1,DL
         4 000322   000000 622006                    EAX2    0,QL
         4 000323   040045 100540                    MLR     fill='040'O
         4 000324   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         4 000325   000002 400012 2                  ADSC9   NNNN+2,A                 cn=2,n=*X2

      172     9884    3                                 LENGTHC (NNNN) -
      173     9885    3                                 (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
      174     9886
      175     9887    3                                 ,
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:39   
      176     9888    3                                 PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      177     9889    3                  CALL CHARBIN (BNNNN, NNNN);

   9889  4 000326   000100 305400                    DTB
         4 000327   000000 030012 2                  NDSC9   NNNN                     cn=0,s=nosgn,sf=0,n=10
         4 000330   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000331   200011 235100                    LDA     PTR$+6,,AUTO
         4 000332   000032 755000 2                  STA     BNNNN
         4 000333   000677 710000 4                  TRA     s:10004

      178     9890
      179     9891    3             CASE (13);

      180     9892    3                  EVAL_CASE = 4;

   9892  4 000334   004000 236003                    LDQ     2048,DU
         4 000335   000014 756000 2                  STQ     EVAL_CASE

      181     9893    3                  NNNN = ' ';

   9893  4 000336   040000 100400                    MLR     fill='040'O
         4 000337   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000340   000000 000012 2                  ADSC9   NNNN                     cn=0,n=10

      182     9894    3                  CALL INSERT (NNNN,

   9894  4 000341   300003 474500                    LDP4    3,,PR3
         4 000342   400004 236100                    LDQ     4,,PR4
         4 000343   000033 772000                    QRL     27
         4 000344   000000 620006                    EAX0    0,QL
         4 000345   000000 635010                    EAA     0,X0
         4 000346   000022 771000                    ARL     18
         4 000347   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000350   000001 035007                    ADLA    1,DL
         4 000351   000000 622006                    EAX2    0,QL
         4 000352   040045 100540                    MLR     fill='040'O
         4 000353   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:40   
         4 000354   000002 400012 2                  ADSC9   NNNN+2,A                 cn=2,n=*X2

      183     9895    3                                 LENGTHC (NNNN) -
      184     9896    3                                 (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
      185     9897    3                                 ,
      186     9898    3                                 PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      187     9899
      188     9900    3                  CALL CHARBIN (BNNNN, NNNN);

   9900  4 000355   000100 305400                    DTB
         4 000356   000000 030012 2                  NDSC9   NNNN                     cn=0,s=nosgn,sf=0,n=10
         4 000357   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000360   200011 235100                    LDA     PTR$+6,,AUTO
         4 000361   000032 755000 2                  STA     BNNNN
         4 000362   000677 710000 4                  TRA     s:10004

      189     9901
      190     9902    3             CASE (10);

      191     9903    3                  EVAL_CASE = 5;

   9903  4 000363   005000 236003                    LDQ     2560,DU
         4 000364   000014 756000 2                  STQ     EVAL_CASE

      192     9904    3                  IJ2 = '   ';

   9904  4 000365   000000 236000 3                  LDQ     0
         4 000366   000001 376000 5                  ANQ     1
         4 000367   000040 276007                    ORQ     32,DL
         4 000370   000004 756000 2                  STQ     IJ2

      193     9905    3                  IY2 = '    ';

   9905  4 000371   000000 236000 3                  LDQ     0
         4 000372   000006 756000 2                  STQ     IY2

      194     9906    3                  CALL INSERT (IJ2,
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:41   

   9906  4 000373   300003 474500                    LDP4    3,,PR3
         4 000374   400004 236100                    LDQ     4,,PR4
         4 000375   000033 772000                    QRL     27
         4 000376   000000 620006                    EAX0    0,QL
         4 000377   000000 635010                    EAA     0,X0
         4 000400   000022 771000                    ARL     18
         4 000401   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000402   000001 035007                    ADLA    1,DL
         4 000403   000000 622006                    EAX2    0,QL
         4 000404   040045 100540                    MLR     fill='040'O
         4 000405   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         4 000406   000004 600012 2                  ADSC9   IJ2,A                    cn=3,n=*X2

      195     9907    3                                 LENGTHC (IJ2) -
      196     9908    3                                 (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
      197     9909    3                                 ,
      198     9910    3                                 PTR$ -> OUT$BLK.SUBLK$(0) ->  OUT$SYM.TEXT);
      199     9911    3                  CALL INSERT (IY2,

   9911  4 000407   300004 475500                    LDP5    4,,PR3
         4 000410   500004 236100                    LDQ     4,,PR5
         4 000411   000033 772000                    QRL     27
         4 000412   000000 622006                    EAX2    0,QL
         4 000413   000000 635012                    EAA     0,X2
         4 000414   000022 771000                    ARL     18
         4 000415   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000416   000001 035007                    ADLA    1,DL
         4 000417   000000 623006                    EAX3    0,QL
         4 000420   040045 100540                    MLR     fill='040'O
         4 000421   500004 200012                    ADSC9   4,,PR5                   cn=1,n=*X2
         4 000422   000007 000013 2                  ADSC9   IM1,A                    cn=0,n=*X3

      200     9912    3                                 LENGTHC (IY2) -
      201     9913    3                                 (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
      202     9914    3                                 ,
      203     9915    3                                 PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:42   
      204     9916
      205     9917    3             IF SUBSTR (IY2, 0, 2) = '  ' AND SUBSTR (IY2, 2, 2) >= '78'

   9917  4 000423   000006 223000 2                  LDX3    IY2
         4 000424   000000 103000 3                  CMPX3   0
         4 000425   000434 601000 4                  TNZ     s:9921
         4 000426   000006 724000 2                  LXL4    IY2
         4 000427   000001 104000 3                  CMPX4   1
         4 000430   000434 602000 4                  TNC     s:9921

      206     9918    3             THEN
      207     9919    3                  CALL INSERT (IY2, 0, 2, '19');

   9919  4 000431   000002 225000 3                  LDX5    2
         4 000432   000006 745000 2                  STX5    IY2
         4 000433   000440 710000 4                  TRA     s:9925

      208     9920    3                  ELSE
      209     9921    3                  IF SUBSTR (IY2, 0, 2) = '  '

   9921  4 000434   000000 103000 3                  CMPX3   0
         4 000435   000440 601000 4                  TNZ     s:9925

      210     9922    3                  THEN
      211     9923    3                     CALL INSERT (IY2, 0, 2, '20');

   9923  4 000436   000003 224000 3                  LDX4    3
         4 000437   000006 744000 2                  STX4    IY2

      212     9924
      213     9925    3        CALL CHARBIN (BY2, IY2);

   9925  4 000440   000100 305400                    DTB
         4 000441   000006 030004 2                  NDSC9   IY2                      cn=0,s=nosgn,sf=0,n=4
         4 000442   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000443   200011 235100                    LDA     PTR$+6,,AUTO
         4 000444   000016 755000 2                  STA     BY2
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:43   

      214     9926    3        TEMP_YEARS = BY2;

   9926  4 000445   000000 755000 xsym               STA     TEMP_YEARS

      215     9927    3        CALL IAM$LEAP;

   9927  4 000446   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000447   000000 701000 xent               TSX1    IAM$LEAP
         4 000450   000000 011000                    NOP     0

      216     9928    3             CALL CHARBIN (TEMP_JUL, IJ2);

   9928  4 000451   000000 305400                    DTB
         4 000452   000004 030003 2                  NDSC9   IJ2                      cn=0,s=nosgn,sf=0,n=3
         4 000453   000000 000004 xsym               NDSC9   TEMP_JUL                 cn=0,s=lsgnf,sf=0,n=4

      217     9929    3             CALL GET$MDY_J;

   9929  4 000454   001336 701000 4                  TSX1    GET$MDY_J
         4 000455   000000 011000                    NOP     0

      218     9930    3             BM2 = TEMP_MONTHS;

   9930  4 000456   000000 235000 xsym               LDA     TEMP_MONTHS
         4 000457   000020 755000 2                  STA     BM2

      219     9931    3             BD2 = TEMP_DAYS;

   9931  4 000460   000000 236000 xsym               LDQ     TEMP_DAYS
         4 000461   000022 756000 2                  STQ     BD2

      220     9932
      221     9933    3             IF PTR$ -> OUT$BLK.NSUBLKS > 2

   9933  4 000462   200003 470500                    LDP0    PTR$,,AUTO
         4 000463   000001 220100                    LDX0    1,,PR0
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:44   
         4 000464   000003 100003                    CMPX0   3,DU
         4 000465   000677 602000 4                  TNC     s:10004

      222     9934    3             THEN
      223     9935    4               DO;

      224     9936    5                  DO CASE (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.CODE);

   9936  4 000466   000005 471500                    LDP1    5,,PR0
         4 000467   100000 236100                    LDQ     0,,PR1
         4 000470   777777 376007                    ANQ     -1,DL
         4 000471   000032 136007                    SBLQ    26,DL
         4 000472   000002 116007                    CMPQ    2,DL
         4 000473   000475 602006 4                  TNC     s:9936+7,QL
         4 000474   000504 710000 4                  TRA     s:9942
         4 000475   000477 710000 4                  TRA     s:9938
         4 000476   000502 710000 4                  TRA     s:9940

      225     9937    5                       CASE (26);

      226     9938    5                            EVAL_CASE = 6;

   9938  4 000477   006000 236003                    LDQ     3072,DU
         4 000500   000014 756000 2                  STQ     EVAL_CASE
         4 000501   000504 710000 4                  TRA     s:9942

      227     9939    5                       CASE (27);

      228     9940    5                            EVAL_CASE = 7;

   9940  4 000502   007000 236003                    LDQ     3584,DU
         4 000503   000014 756000 2                  STQ     EVAL_CASE

      229     9941    5                       END;

      230     9942    4                  II1 = ' ';

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:45   
   9942  4 000504   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000505   000013 756000 2                  STQ     II1

      231     9943    4                  CALL INSERT (II1,

   9943  4 000506   100003 473500                    LDP3    3,,PR1
         4 000507   300004 236100                    LDQ     4,,PR3
         4 000510   000033 772000                    QRL     27
         4 000511   000000 621006                    EAX1    0,QL
         4 000512   000000 635011                    EAA     0,X1
         4 000513   000022 771000                    ARL     18
         4 000514   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000515   000001 035007                    ADLA    1,DL
         4 000516   000000 622006                    EAX2    0,QL
         4 000517   040045 100540                    MLR     fill='040'O
         4 000520   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 000521   000014 000012 2                  ADSC9   EVAL_CASE,A              cn=0,n=*X2

      232     9944    4                                 LENGTHC (II1) -
      233     9945    4                                 (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.SUBLK$(0) ->
              9945                                          OUT$SYM.COUNT),
      234     9946    4                                 ,
      235     9947    4                                 PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$BLK.SUBLK$(0) ->
              9947                                          OUT$SYM.TEXT);
      236     9948    4                  CALL CHARBIN (BI1, II1);

   9948  4 000522   000000 305400                    DTB
         4 000523   000013 030004 2                  NDSC9   II1                      cn=0,s=nosgn,sf=0,n=4
         4 000524   000023 000004 2                  NDSC9   BI1                      cn=0,s=lsgnf,sf=0,n=4

      237     9949    4                  END;

   9949  4 000525   000677 710000 4                  TRA     s:10004

      238     9950
      239     9951
      240     9952    3             CASE (11);
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:46   

      241     9953    3                  EVAL_CASE = 5;

   9953  4 000526   005000 236003                    LDQ     2560,DU
         4 000527   000014 756000 2                  STQ     EVAL_CASE

      242     9954    3                  IY2 = '    ';

   9954  4 000530   000000 236000 3                  LDQ     0
         4 000531   000006 756000 2                  STQ     IY2

      243     9955    3                  IM2 = '  ';

   9955  4 000532   000000 220000 3                  LDX0    0
         4 000533   000010 740000 2                  STX0    IM2

      244     9956    3                  ID2 = '  ';

   9956  4 000534   000012 740000 2                  STX0    ID2

      245     9957    3                  CALL INSERT (IM2,

   9957  4 000535   300003 474500                    LDP4    3,,PR3
         4 000536   400004 236100                    LDQ     4,,PR4
         4 000537   000033 772000                    QRL     27
         4 000540   000000 622006                    EAX2    0,QL
         4 000541   000000 635012                    EAA     0,X2
         4 000542   000022 771000                    ARL     18
         4 000543   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000544   000001 035007                    ADLA    1,DL
         4 000545   000000 623006                    EAX3    0,QL
         4 000546   040045 100540                    MLR     fill='040'O
         4 000547   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         4 000550   000010 400013 2                  ADSC9   IM2,A                    cn=2,n=*X3

      246     9958    3                                 LENGTHC (IM2) -
      247     9959    3                                 (PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT),
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:47   
      248     9960    3                                 ,
      249     9961    3                                 PTR$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      250     9962    3                  CALL INSERT (ID2,

   9962  4 000551   300004 475500                    LDP5    4,,PR3
         4 000552   500004 236100                    LDQ     4,,PR5
         4 000553   000033 772000                    QRL     27
         4 000554   000000 623006                    EAX3    0,QL
         4 000555   000000 635013                    EAA     0,X3
         4 000556   000022 771000                    ARL     18
         4 000557   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000560   000001 035007                    ADLA    1,DL
         4 000561   000000 624006                    EAX4    0,QL
         4 000562   040045 100540                    MLR     fill='040'O
         4 000563   500004 200013                    ADSC9   4,,PR5                   cn=1,n=*X3
         4 000564   000012 400014 2                  ADSC9   ID2,A                    cn=2,n=*X4

      251     9963    3                                 LENGTHC (ID2) -
      252     9964    3                                 (PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT),
      253     9965    3                                 ,
      254     9966    3                                 PTR$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      255     9967    3                  CALL INSERT (IY2,

   9967  4 000565   300005 476500                    LDP6    5,,PR3
         4 000566   600004 236100                    LDQ     4,,PR6
         4 000567   000033 772000                    QRL     27
         4 000570   000000 624006                    EAX4    0,QL
         4 000571   000000 635014                    EAA     0,X4
         4 000572   000022 771000                    ARL     18
         4 000573   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000574   000001 035007                    ADLA    1,DL
         4 000575   000000 625006                    EAX5    0,QL
         4 000576   040045 100540                    MLR     fill='040'O
         4 000577   600004 200014                    ADSC9   4,,PR6                   cn=1,n=*X4
         4 000600   000007 000015 2                  ADSC9   IM1,A                    cn=0,n=*X5

      256     9968    3                                 LENGTHC (IY2) -
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:48   
      257     9969    3                                 (PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$SYM.COUNT),
      258     9970    3                                 ,
      259     9971    3                                 PTR$ -> OUT$BLK.SUBLK$(2) -> OUT$SYM.TEXT);
      260     9972
      261     9973    3                IF SUBSTR (IY2, 0, 2) = '  ' AND SUBSTR (IY2, 2, 2) >= '78'

   9973  4 000601   000006 225000 2                  LDX5    IY2
         4 000602   000000 105000 3                  CMPX5   0
         4 000603   000612 601000 4                  TNZ     s:9977
         4 000604   000006 726000 2                  LXL6    IY2
         4 000605   000001 106000 3                  CMPX6   1
         4 000606   000612 602000 4                  TNC     s:9977

      262     9974    3                THEN
      263     9975    3                     CALL INSERT (IY2, 0, 2, '19');

   9975  4 000607   000002 227000 3                  LDX7    2
         4 000610   000006 747000 2                  STX7    IY2
         4 000611   000616 710000 4                  TRA     s:9981

      264     9976    3                  ELSE
      265     9977    3                  IF SUBSTR (IY2, 0, 2) = '  '

   9977  4 000612   000000 105000 3                  CMPX5   0
         4 000613   000616 601000 4                  TNZ     s:9981

      266     9978    3                  THEN
      267     9979    3                     CALL INSERT (IY2, 0, 2, '20');

   9979  4 000614   000003 226000 3                  LDX6    3
         4 000615   000006 746000 2                  STX6    IY2

      268     9980
      269     9981    3                CALL CHARBIN (BY2, IY2);

   9981  4 000616   000100 305400                    DTB
         4 000617   000006 030004 2                  NDSC9   IY2                      cn=0,s=nosgn,sf=0,n=4
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:49   
         4 000620   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000621   200011 235100                    LDA     PTR$+6,,AUTO
         4 000622   000016 755000 2                  STA     BY2

      270     9982    3                CALL CHARBIN (BM2, IM2);

   9982  4 000623   000100 305400                    DTB
         4 000624   000010 030002 2                  NDSC9   IM2                      cn=0,s=nosgn,sf=0,n=2
         4 000625   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000626   200011 236100                    LDQ     PTR$+6,,AUTO
         4 000627   000020 756000 2                  STQ     BM2

      271     9983    3                CALL CHARBIN (BD2, ID2);

   9983  4 000630   000100 305400                    DTB
         4 000631   000012 030002 2                  NDSC9   ID2                      cn=0,s=nosgn,sf=0,n=2
         4 000632   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000633   200011 235100                    LDA     PTR$+6,,AUTO
         4 000634   000022 755000 2                  STA     BD2

      272     9984
      273     9985    3             IF PTR$ -> OUT$BLK.NSUBLKS > 3

   9985  4 000635   300001 222100                    LDX2    1,,PR3
         4 000636   000004 102003                    CMPX2   4,DU
         4 000637   000677 602000 4                  TNC     s:10004

      274     9986    3             THEN
      275     9987    4               DO;

      276     9988    5                  DO CASE (PTR$ -> OUT$BLK.SUBLK$(3) -> OUT$BLK.CODE);

   9988  4 000640   300006 471500                    LDP1    6,,PR3
         4 000641   100000 236100                    LDQ     0,,PR1
         4 000642   777777 376007                    ANQ     -1,DL
         4 000643   000032 136007                    SBLQ    26,DL
         4 000644   000002 116007                    CMPQ    2,DL
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:50   
         4 000645   000647 602006 4                  TNC     s:9988+7,QL
         4 000646   000656 710000 4                  TRA     s:9994
         4 000647   000651 710000 4                  TRA     s:9990
         4 000650   000654 710000 4                  TRA     s:9992

      277     9989    5                       CASE (26);

      278     9990    5                            EVAL_CASE = 6;

   9990  4 000651   006000 236003                    LDQ     3072,DU
         4 000652   000014 756000 2                  STQ     EVAL_CASE
         4 000653   000656 710000 4                  TRA     s:9994

      279     9991    5                       CASE (27);

      280     9992    5                            EVAL_CASE = 7;

   9992  4 000654   007000 236003                    LDQ     3584,DU
         4 000655   000014 756000 2                  STQ     EVAL_CASE

      281     9993    5                       END;

      282     9994    4                  II1 = ' ';

   9994  4 000656   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000657   000013 756000 2                  STQ     II1

      283     9995    4                  CALL INSERT (II1,

   9995  4 000660   100003 474500                    LDP4    3,,PR1
         4 000661   400004 236100                    LDQ     4,,PR4
         4 000662   000033 772000                    QRL     27
         4 000663   000000 623006                    EAX3    0,QL
         4 000664   000000 635013                    EAA     0,X3
         4 000665   000022 771000                    ARL     18
         4 000666   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000667   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:51   
         4 000670   000000 624006                    EAX4    0,QL
         4 000671   040045 100540                    MLR     fill='040'O
         4 000672   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
         4 000673   000014 000014 2                  ADSC9   EVAL_CASE,A              cn=0,n=*X4

      284     9996    4                                 LENGTHC (II1) -
      285     9997    4                                 (PTR$ -> OUT$BLK.SUBLK$(3) -> OUT$BLK.SUBLK$(0) ->
              9997                                          OUT$SYM.COUNT),
      286     9998    4                                 ,
      287     9999    4                                 PTR$ -> OUT$BLK.SUBLK$(3) -> OUT$BLK.SUBLK$(0) ->
              9999                                          OUT$SYM.TEXT);
      288    10000    4                  CALL CHARBIN (BI1, II1);

  10000  4 000674   000000 305400                    DTB
         4 000675   000013 030004 2                  NDSC9   II1                      cn=0,s=nosgn,sf=0,n=4
         4 000676   000023 000004 2                  NDSC9   BI1                      cn=0,s=lsgnf,sf=0,n=4

      289    10001    4                  END;

      290    10002
      291    10003    3               END;

      292    10004    2   END GET$REST;

  10004  4 000677   200004 221300                    LDX1  ! PTR$+1,,AUTO
         4 000700   000001 702211                    TSX2  ! 1,X1

      293    10005        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:52   
      294    10006    1   BREAKDOWN: PROC;

  10006  4 000701   200004 741300       BREAKDOWN    STX1  ! PTR$+1,,AUTO

      295    10007
      296    10008
      297    10009    2        TEMP_MONTHS = BM1;

  10009  4 000702   000017 235000 2                  LDA     BM1
         4 000703   000000 755000 xsym               STA     TEMP_MONTHS

      298    10010    2        TEMP_DAYS = BD1;

  10010  4 000704   000021 236000 2                  LDQ     BD1
         4 000705   000000 756000 xsym               STQ     TEMP_DAYS

      299    10011    2        TEMP_YEARS = BY1;

  10011  4 000706   000015 235000 2                  LDA     BY1
         4 000707   000000 755000 xsym               STA     TEMP_YEARS

      300    10012    2        CALL IAM$LEAP;

  10012  4 000710   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000711   000000 701000 xent               TSX1    IAM$LEAP
         4 000712   000000 011000                    NOP     0

      301    10013    2        CALL VALIDATE;

  10013  4 000713   001404 701000 4                  TSX1    VALIDATE
         4 000714   000000 011000                    NOP     0

      302    10014    2        IF DATE_STATUS

  10014  4 000715   000036 234000 2                  SZN     DATE_STATUS
         4 000716   000721 605000 4                  TPL     s:10017

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:53   
      303    10015    2        THEN
      304    10016    2             RETURN;

  10016  4 000717   200004 221300                    LDX1  ! PTR$+1,,AUTO
         4 000720   000001 702211                    TSX2  ! 1,X1

      305    10017    2        CALL IAM$CYCLE;

  10017  4 000721   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000722   000000 701000 xent               TSX1    IAM$CYCLE
         4 000723   000000 011000                    NOP     0

      306    10018    2        CYCLE_DAYS_LAST = TOTAL_DAYS;

  10018  4 000724   000000 235000 xsym               LDA     TOTAL_DAYS
         4 000725   000000 755000 xsym               STA     CYCLE_DAYS_LAST

      307    10019
      308    10020    3        DO CASE (EVAL_CASE);

  10020  4 000726   000014 236000 2                  LDQ     EVAL_CASE
         4 000727   000033 772000                    QRL     27
         4 000730   000010 116007                    CMPQ    8,DL
         4 000731   000733 602006 4                  TNC     s:10020+5,QL
         4 000732   001332 710000 4                  TRA     s:10157
         4 000733   001332 710000 4                  TRA     s:10157
         4 000734   001332 710000 4                  TRA     s:10157
         4 000735   001332 710000 4                  TRA     s:10157
         4 000736   000743 710000 4                  TRA     s:10022
         4 000737   001016 710000 4                  TRA     s:10041
         4 000740   001055 710000 4                  TRA     s:10061
         4 000741   001055 710000 4                  TRA     s:10061
         4 000742   001055 710000 4                  TRA     s:10061

      309    10021    3             CASE (3);

      310    10022    3                  JULIAN = JULIAN + BNNNN;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:54   

  10022  4 000743   000000 236000 xsym               LDQ     JULIAN
         4 000744   000032 036000 2                  ADLQ    BNNNN
         4 000745   000000 756000 xsym               STQ     JULIAN

      311    10023    3                  IF JULIAN > 365 + BITBIN (LEAP)

  10023  4 000746   000000 236000 xsym               LDQ     LEAP
         4 000747   000043 772000                    QRL     35
         4 000750   000555 036007                    ADLQ    365,DL
         4 000751   000776 604000 4                  TMI     s:10031
         4 000752   000000 116000 xsym               CMPQ    JULIAN
         4 000753   000776 605000 4                  TPL     s:10031

      312    10024    3                  THEN
      313    10025    4                    DO WHILE JULIAN > 365 + BITBIN (LEAP);

  10025  4 000754   000770 710000 4                  TRA     s:10029

      314    10026    4                       JULIAN = JULIAN - (365 + BITBIN (LEAP));

  10026  4 000755   000000 236000 xsym               LDQ     LEAP
         4 000756   000043 772000                    QRL     35
         4 000757   200010 756100                    STQ     PTR$+5,,AUTO
         4 000760   000000 236000 xsym               LDQ     JULIAN
         4 000761   200010 136100                    SBLQ    PTR$+5,,AUTO
         4 000762   000555 136007                    SBLQ    365,DL
         4 000763   000000 756000 xsym               STQ     JULIAN

      315    10027    4                       TEMP_YEARS = TEMP_YEARS + 1;

  10027  4 000764   000000 054000 xsym               AOS     TEMP_YEARS

      316    10028    4                       CALL IAM$LEAP;

  10028  4 000765   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000766   000000 701000 xent               TSX1    IAM$LEAP
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:55   
         4 000767   000000 011000                    NOP     0

      317    10029    4                       END;

  10029  4 000770   000000 236000 xsym               LDQ     LEAP
         4 000771   000043 772000                    QRL     35
         4 000772   000555 036007                    ADLQ    365,DL
         4 000773   000776 604000 4                  TMI     s:10031
         4 000774   000000 116000 xsym               CMPQ    JULIAN
         4 000775   000755 604000 4                  TMI     s:10026

      318    10030
      319    10031    3                  TEMP_JUL = JULIAN;

  10031  4 000776   000000 235000 xsym               LDA     JULIAN
         4 000777   000000 755000 xsym               STA     TEMP_JUL

      320    10032    3                  CALL GET$MDY_J;

  10032  4 001000   001336 701000 4                  TSX1    GET$MDY_J
         4 001001   000000 011000                    NOP     0

      321    10033    3                  BY1 = TEMP_YEARS;

  10033  4 001002   000000 235000 xsym               LDA     TEMP_YEARS
         4 001003   000015 755000 2                  STA     BY1

      322    10034    3                  BM1 = TEMP_MONTHS;

  10034  4 001004   000000 236000 xsym               LDQ     TEMP_MONTHS
         4 001005   000017 756000 2                  STQ     BM1

      323    10035    3                  BD1 = TEMP_DAYS;

  10035  4 001006   000000 235000 xsym               LDA     TEMP_DAYS
         4 001007   000021 755000 2                  STA     BD1

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:56   
      324    10036    3                  CALL IAM$CYCLE;

  10036  4 001010   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001011   000000 701000 xent               TSX1    IAM$CYCLE
         4 001012   000000 011000                    NOP     0

      325    10037    3                  CALL SEND$OUT;

  10037  4 001013   001444 701000 4                  TSX1    SEND$OUT
         4 001014   000000 011000                    NOP     0
         4 001015   001334 710000 4                  TRA     s:10161

      326    10038
      327    10039
      328    10040    3             CASE (4);

      329    10041    3                  JULIAN = JULIAN - BNNNN;

  10041  4 001016   000000 236000 xsym               LDQ     JULIAN
         4 001017   000032 136000 2                  SBLQ    BNNNN
         4 001020   000000 756000 xsym               STQ     JULIAN

      330    10042    3                  IF JULIAN <= 0

  10042  4 001021   001036 605400 4                  TPNZ    s:10050

      331    10043    3                  THEN
      332    10044    4                    DO WHILE JULIAN <= 0;

  10044  4 001022   001036 605400 4                  TPNZ    s:10050

      333    10045    4                       TEMP_YEARS = TEMP_YEARS - 1;

  10045  4 001023   000001 336007                    LCQ     1,DL
         4 001024   000000 056000 xsym               ASQ     TEMP_YEARS

      334    10046    4                       CALL IAM$LEAP;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:57   

  10046  4 001025   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001026   000000 701000 xent               TSX1    IAM$LEAP
         4 001027   000000 011000                    NOP     0

      335    10047    4                       JULIAN = JULIAN + 365 + BITBIN (LEAP);

  10047  4 001030   000000 236000 xsym               LDQ     LEAP
         4 001031   000043 772000                    QRL     35
         4 001032   000000 036000 xsym               ADLQ    JULIAN
         4 001033   000555 036007                    ADLQ    365,DL
         4 001034   000000 756000 xsym               STQ     JULIAN

      336    10048    4                       END;

  10048  4 001035   001023 604400 4                  TMOZ    s:10045

      337    10049
      338    10050    3                  TEMP_JUL = JULIAN;

  10050  4 001036   000000 756000 xsym               STQ     TEMP_JUL

      339    10051    3                  CALL GET$MDY_J;

  10051  4 001037   001336 701000 4                  TSX1    GET$MDY_J
         4 001040   000000 011000                    NOP     0

      340    10052    3                  BY1 = TEMP_YEARS;

  10052  4 001041   000000 235000 xsym               LDA     TEMP_YEARS
         4 001042   000015 755000 2                  STA     BY1

      341    10053    3                  BM1 = TEMP_MONTHS;

  10053  4 001043   000000 236000 xsym               LDQ     TEMP_MONTHS
         4 001044   000017 756000 2                  STQ     BM1

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:58   
      342    10054    3                  BD1 = TEMP_DAYS;

  10054  4 001045   000000 235000 xsym               LDA     TEMP_DAYS
         4 001046   000021 755000 2                  STA     BD1

      343    10055    3                  CALL IAM$CYCLE;

  10055  4 001047   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001050   000000 701000 xent               TSX1    IAM$CYCLE
         4 001051   000000 011000                    NOP     0

      344    10056    3                  CALL SEND$OUT;

  10056  4 001052   001444 701000 4                  TSX1    SEND$OUT
         4 001053   000000 011000                    NOP     0
         4 001054   001334 710000 4                  TRA     s:10161

      345    10057
      346    10058
      347    10059
      348    10060    3             CASE (5,6,7);

      349    10061    3                  TEMP_YEARS = BY2;

  10061  4 001055   000016 235000 2                  LDA     BY2
         4 001056   000000 755000 xsym               STA     TEMP_YEARS

      350    10062    3                  TEMP_MONTHS = BM2;

  10062  4 001057   000020 235000 2                  LDA     BM2
         4 001060   000000 755000 xsym               STA     TEMP_MONTHS

      351    10063    3                  TEMP_DAYS = BD2;

  10063  4 001061   000022 235000 2                  LDA     BD2
         4 001062   000000 755000 xsym               STA     TEMP_DAYS

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:59   
      352    10064    3                  CALL IAM$LEAP;

  10064  4 001063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001064   000000 701000 xent               TSX1    IAM$LEAP
         4 001065   000000 011000                    NOP     0

      353    10065    3                  CALL VALIDATE;

  10065  4 001066   001404 701000 4                  TSX1    VALIDATE
         4 001067   000000 011000                    NOP     0

      354    10066    3                  IF DATE_STATUS

  10066  4 001070   000036 234000 2                  SZN     DATE_STATUS
         4 001071   001074 605000 4                  TPL     s:10069

      355    10067    3                  THEN
      356    10068    3                       RETURN;

  10068  4 001072   200004 221300                    LDX1  ! PTR$+1,,AUTO
         4 001073   000001 702211                    TSX2  ! 1,X1

      357    10069    3                  CALL IAM$CYCLE;

  10069  4 001074   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001075   000000 701000 xent               TSX1    IAM$CYCLE
         4 001076   000000 011000                    NOP     0

      358    10070
      359    10071    3                  IF (BY1/400) = (BY2 / 400)

  10071  4 001077   000015 236000 2                  LDQ     BY1
         4 001100   000001 772000                    QRL     1
         4 001101   000310 506007                    DIV     200,DL
         4 001102   200010 756100                    STQ     PTR$+5,,AUTO
         4 001103   000016 236000 2                  LDQ     BY2
         4 001104   000001 772000                    QRL     1
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:60   
         4 001105   000310 506007                    DIV     200,DL
         4 001106   200010 116100                    CMPQ    PTR$+5,,AUTO
         4 001107   001131 601000 4                  TNZ     s:10091

      360    10072    3                  THEN
      361    10073    4                    DO;

      362    10074    4                       IF TOTAL_DAYS = CYCLE_DAYS_LAST

  10074  4 001110   000000 236000 xsym               LDQ     TOTAL_DAYS
         4 001111   001116 604000 4                  TMI     s:10081
         4 001112   000000 116000 xsym               CMPQ    CYCLE_DAYS_LAST
         4 001113   001116 601000 4                  TNZ     s:10081

      363    10075    4                       THEN
      364    10076    5                         DO;

      365    10077    5                            RESULT = 0;

  10077  4 001114   000024 450000 2                  STZ     RESULT

      366    10078    5                            END;

  10078  4 001115   001131 710000 4                  TRA     s:10091

      367    10079    4                       ELSE
      368    10080    5                         DO;

      369    10081    5                            IF TOTAL_DAYS > CYCLE_DAYS_LAST

  10081  4 001116   000000 116003                    CMPQ    0,DU
         4 001117   001126 604000 4                  TMI     s:10087
         4 001120   000000 116000 xsym               CMPQ    CYCLE_DAYS_LAST
         4 001121   001126 602000 4                  TNC     s:10087
         4 001122   001126 600000 4                  TZE     s:10087

      370    10082    5                            THEN
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:61   
      371    10083    6                              DO;

      372    10084    6                                 RESULT = TOTAL_DAYS - CYCLE_DAYS_LAST;

  10084  4 001123   000000 136000 xsym               SBLQ    CYCLE_DAYS_LAST
         4 001124   000024 756000 2                  STQ     RESULT

      373    10085    6                                 END;

  10085  4 001125   001131 710000 4                  TRA     s:10091

      374    10086    5                            ELSE
      375    10087    5                              RESULT = CYCLE_DAYS_LAST - TOTAL_DAYS;

  10087  4 001126   000000 236000 xsym               LDQ     CYCLE_DAYS_LAST
         4 001127   000000 136000 xsym               SBLQ    TOTAL_DAYS
         4 001130   000024 756000 2                  STQ     RESULT

      376    10088    5                            END;

      377    10089    4                       END;

      378    10090
      379    10091    3                  IF (BY1 / 400) < (BY2 / 400)

  10091  4 001131   000015 236000 2                  LDQ     BY1
         4 001132   000001 772000                    QRL     1
         4 001133   000310 506007                    DIV     200,DL
         4 001134   200010 756100                    STQ     PTR$+5,,AUTO
         4 001135   000016 236000 2                  LDQ     BY2
         4 001136   000001 772000                    QRL     1
         4 001137   000310 506007                    DIV     200,DL
         4 001140   200010 116100                    CMPQ    PTR$+5,,AUTO
         4 001141   001157 602000 4                  TNC     s:10096
         4 001142   001157 600000 4                  TZE     s:10096

      380    10092    3                  THEN
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:62   
      381    10093    3                       RESULT = ((((BY2S /400) - 1) - (BY1S / 400)) * (146097))

  10093  4 001143   000016 236000 2                  LDQ     BY2
         4 001144   000620 506007                    DIV     400,DL
         4 001145   200010 756100                    STQ     PTR$+5,,AUTO
         4 001146   000015 236000 2                  LDQ     BY1
         4 001147   000620 506007                    DIV     400,DL
         4 001150   200011 756100                    STQ     PTR$+6,,AUTO
         4 001151   200010 236100                    LDQ     PTR$+5,,AUTO
         4 001152   200011 136100                    SBLQ    PTR$+6,,AUTO
         4 001153   435261 402007                    MPY     -116047,DL
         4 001154   000000 036000 xsym               ADLQ    TOTAL_DAYS
         4 001155   000000 136000 xsym               SBLQ    CYCLE_DAYS_LAST
         4 001156   000024 756000 2                  STQ     RESULT

      382    10094    3                                 + TOTAL_DAYS + ((146097) - CYCLE_DAYS_LAST);
      383    10095
      384    10096    3                  IF (BY1 / 400) > (BY2 / 400)

  10096  4 001157   000015 236000 2                  LDQ     BY1
         4 001160   000001 772000                    QRL     1
         4 001161   000310 506007                    DIV     200,DL
         4 001162   200010 756100                    STQ     PTR$+5,,AUTO
         4 001163   000016 236000 2                  LDQ     BY2
         4 001164   000001 772000                    QRL     1
         4 001165   000310 506007                    DIV     200,DL
         4 001166   200010 116100                    CMPQ    PTR$+5,,AUTO
         4 001167   001205 603000 4                  TRC     s:10102

      385    10097    3                  THEN
      386    10098    3                       RESULT = ((((BY1S / 400) - 1) - (BY2S / 400)) * (146097))

  10098  4 001170   000015 236000 2                  LDQ     BY1
         4 001171   000620 506007                    DIV     400,DL
         4 001172   200010 756100                    STQ     PTR$+5,,AUTO
         4 001173   000016 236000 2                  LDQ     BY2
         4 001174   000620 506007                    DIV     400,DL
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:63   
         4 001175   200011 756100                    STQ     PTR$+6,,AUTO
         4 001176   200010 236100                    LDQ     PTR$+5,,AUTO
         4 001177   200011 136100                    SBLQ    PTR$+6,,AUTO
         4 001200   435261 402007                    MPY     -116047,DL
         4 001201   000000 036000 xsym               ADLQ    CYCLE_DAYS_LAST
         4 001202   000000 036000 xsym               ADLQ    TOTAL_DAYS
         4 001203   000002 136000 5                  SBLQ    2
         4 001204   000024 756000 2                  STQ     RESULT

      387    10099    3                                 + CYCLE_DAYS_LAST - ((146097) - TOTAL_DAYS);
      388    10100
      389    10101
      390    10102    3                  MESS_BUF = 'Difference = ';

  10102  4 001205   040000 100400                    MLR     fill='040'O
         4 001206   000004 000015 3                  ADSC9   4                        cn=0,n=13
         4 001207   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256

      391    10103    3                  CALL BINCHAR (NNNN, RESULT);

  10103  4 001210   000000 301400                    BTD
         4 001211   000024 000004 2                  NDSC9   RESULT                   cn=0,s=lsgnf,sf=0,n=4
         4 001212   000000 030012 2                  NDSC9   NNNN                     cn=0,s=nosgn,sf=0,n=10

      392    10104    3                  X = 0;

  10104  4 001213   000035 450000 2                  STZ     X

      393    10105    3                  LENGTH = 10;

  10105  4 001214   000012 235007                    LDA     10,DL
         4 001215   000031 755000 2                  STA     LENGTH

      394    10106    4                  DO UNTIL X = 9;

      395    10107    4                       IF SUBSTR (NNNN, X, 1) = '0'

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:64   
  10107  4 001216   000035 235000 2                  LDA     X
         4 001217   040000 106405                    CMPC    fill='040'O
         4 001220   000000 000001 2                  ADSC9   NNNN,A                   cn=0,n=1
         4 001221   000003 000001 5                  ADSC9   3                        cn=0,n=1
         4 001222   001230 601000 4                  TNZ     s:10115

      396    10108    4                       THEN
      397    10109    5                         DO;

      398    10110    5                            X = X + 1;

  10110  4 001223   000001 035007                    ADLA    1,DL
         4 001224   000035 755000 2                  STA     X

      399    10111    5                            LENGTH = LENGTH - 1;

  10111  4 001225   000001 336007                    LCQ     1,DL
         4 001226   000031 056000 2                  ASQ     LENGTH

      400    10112    5                            END;

  10112  4 001227   001232 710000 4                  TRA     s:10117

      401    10113    4                       ELSE
      402    10114    5                         DO;

      403    10115    5                            X = 9;

  10115  4 001230   000011 236007                    LDQ     9,DL
         4 001231   000035 756000 2                  STQ     X

      404    10116    5                            END;

      405    10117    4                       END;

  10117  4 001232   000035 235000 2                  LDA     X
         4 001233   000011 115007                    CMPA    9,DL
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:65   
         4 001234   001216 601000 4                  TNZ     s:10107

      406    10118    3                  CALL INSERT (MESS_BUF, 13, LENGTH,

  10118  4 001235   000031 336000 2                  LCQ     LENGTH
         4 001236   000031 720000 2                  LXL0    LENGTH
         4 001237   040040 100446                    MLR     fill='040'O
         4 001240   000002 400010 2                  ADSC9   NNNN+2,Q                 cn=2,n=*X0
         4 001241   000003 200010 xsym               ADSC9   MESS_BUF+3               cn=1,n=*X0

      407    10119    3                       SUBSTR (NNNN, LENGTHC (NNNN) - LENGTH, LENGTH));
      408    10120
      409    10121
      410    10122    3                  CALL INSERT (MESS_BUF, 13 + LENGTH + 1, 4, 'Days');

  10122  4 001242   000031 235000 2                  LDA     LENGTH
         4 001243   040005 100400                    MLR     fill='040'O
         4 001244   000010 000004 3                  ADSC9   8                        cn=0,n=4
         4 001245   000003 400004 xsym               ADSC9   MESS_BUF+3,A             cn=2,n=4

      411    10123
      412    10124    3                  CALL M$WRITE (WRITE_OUT);

  10124  4 001246   000046 630400 2                  EPPR0   WRITE_OUT
         4 001247   040001 713400                    CLIMB   write
         4 001250   401400 401760                    pmme    nvectors=4

      413    10125
      414    10126    3                  IF EVAL_CASE = 6 OR EVAL_CASE = 7

  10126  4 001251   000014 236000 2                  LDQ     EVAL_CASE
         4 001252   777000 376003                    ANQ     -512,DU
         4 001253   006000 116003                    CMPQ    3072,DU
         4 001254   001257 600000 4                  TZE     s:10129
         4 001255   007000 116003                    CMPQ    3584,DU
         4 001256   001334 601000 4                  TNZ     s:10161

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:66   
      415    10127    3                  THEN
      416    10128    4                    DO;

      417    10129    4                       IF EVAL_CASE = 6

  10129  4 001257   006000 116003                    CMPQ    3072,DU
         4 001260   001266 601000 4                  TNZ     s:10133

      418    10130    4                       THEN
      419    10131    4                            RESULT = (RESULT * 24 * 60) / BI1;

  10131  4 001261   000024 236000 2                  LDQ     RESULT
         4 001262   002640 402007                    MPY     1440,DL
         4 001263   000023 506000 2                  DIV     BI1
         4 001264   000024 756000 2                  STQ     RESULT
         4 001265   001271 710000 4                  TRA     s:10134

      420    10132    4                       ELSE
      421    10133    4                            RESULT = RESULT / BI1;

  10133  4 001266   000024 236000 2                  LDQ     RESULT
         4 001267   000023 506000 2                  DIV     BI1
         4 001270   000024 756000 2                  STQ     RESULT

      422    10134    4                       MESS_BUF = 'Intervals  = ';

  10134  4 001271   040000 100400                    MLR     fill='040'O
         4 001272   000011 000015 3                  ADSC9   9                        cn=0,n=13
         4 001273   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256

      423    10135    4                       CALL BINCHAR (NNNN, RESULT);

  10135  4 001274   000000 301400                    BTD
         4 001275   000024 000004 2                  NDSC9   RESULT                   cn=0,s=lsgnf,sf=0,n=4
         4 001276   000000 030012 2                  NDSC9   NNNN                     cn=0,s=nosgn,sf=0,n=10

      424    10136    4                       X = 0;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:67   

  10136  4 001277   000035 450000 2                  STZ     X

      425    10137    4                       LENGTH = 10;

  10137  4 001300   000012 235007                    LDA     10,DL
         4 001301   000031 755000 2                  STA     LENGTH

      426    10138    5                       DO UNTIL X = 9;

      427    10139    5                            IF SUBSTR (NNNN, X, 1) = '0'

  10139  4 001302   000035 235000 2                  LDA     X
         4 001303   040000 106405                    CMPC    fill='040'O
         4 001304   000000 000001 2                  ADSC9   NNNN,A                   cn=0,n=1
         4 001305   000003 000001 5                  ADSC9   3                        cn=0,n=1
         4 001306   001314 601000 4                  TNZ     s:10147

      428    10140    5                            THEN
      429    10141    6                              DO;

      430    10142    6                                 X = X + 1;

  10142  4 001307   000001 035007                    ADLA    1,DL
         4 001310   000035 755000 2                  STA     X

      431    10143    6                                 LENGTH = LENGTH - 1;

  10143  4 001311   000001 336007                    LCQ     1,DL
         4 001312   000031 056000 2                  ASQ     LENGTH

      432    10144    6                                 END;

  10144  4 001313   001316 710000 4                  TRA     s:10149

      433    10145    5                            ELSE
      434    10146    6                              DO;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:68   

      435    10147    6                                 X = 9;

  10147  4 001314   000011 236007                    LDQ     9,DL
         4 001315   000035 756000 2                  STQ     X

      436    10148    6                                 END;

      437    10149    5                            END;

  10149  4 001316   000035 235000 2                  LDA     X
         4 001317   000011 115007                    CMPA    9,DL
         4 001320   001302 601000 4                  TNZ     s:10139

      438    10150    4                        CALL INSERT (MESS_BUF, 13, LENGTH,

  10150  4 001321   000031 336000 2                  LCQ     LENGTH
         4 001322   000031 720000 2                  LXL0    LENGTH
         4 001323   040040 100446                    MLR     fill='040'O
         4 001324   000002 400010 2                  ADSC9   NNNN+2,Q                 cn=2,n=*X0
         4 001325   000003 200010 xsym               ADSC9   MESS_BUF+3               cn=1,n=*X0

      439    10151    4                            SUBSTR (NNNN, LENGTHC (NNNN) - LENGTH, LENGTH));
      440    10152    4                       CALL M$WRITE (WRITE_OUT);

  10152  4 001326   000046 630400 2                  EPPR0   WRITE_OUT
         4 001327   040001 713400                    CLIMB   write
         4 001330   401400 401760                    pmme    nvectors=4

      441    10153    4                       END;

  10153  4 001331   001334 710000 4                  TRA     s:10161

      442    10154
      443    10155
      444    10156    3             CASE (ELSE);

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:69   
      445    10157    3                  CALL SEND$OUT;

  10157  4 001332   001444 701000 4                  TSX1    SEND$OUT
         4 001333   000000 011000                    NOP     0

      446    10158
      447    10159    3             END;

      448    10160
      449    10161    2   END BREAKDOWN;

  10161  4 001334   200004 221300                    LDX1  ! PTR$+1,,AUTO
         4 001335   000001 702211                    TSX2  ! 1,X1

      450    10162        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:70   
      451    10163    1   GET$MDY_J: PROC;

  10163  4 001336   200006 741300       GET$MDY_J    STX1  ! PTR$+3,,AUTO

      452    10164
      453    10165    2        TEMP_DAYS = 0;

  10165  4 001337   000000 450000 xsym               STZ     TEMP_DAYS

      454    10166    2        TEMP_MONTHS = 0;

  10166  4 001340   000000 450000 xsym               STZ     TEMP_MONTHS

      455    10167    3        DO UNTIL TEMP_DAYS > 0;

      456    10168    3             TEMP_MONTHS = TEMP_MONTHS + 1;

  10168  4 001341   000000 054000 xsym               AOS     TEMP_MONTHS

      457    10169    3             IF TEMP_JUL <= (JUL_TABLE (TEMP_MONTHS)

  10169  4 001342   400000 220003                    LDX0    -131072,DU
         4 001343   000000 235000 xsym               LDA     TEMP_MONTHS
         4 001344   000001 115007                    CMPA    1,DL
         4 001345   001347 605400 4                  TPNZ    s:10169+5
         4 001346   000000 220003                    LDX0    0,DU
         4 001347   000000 236000 xsym               LDQ     LEAP
         4 001350   400000 376003                    ANQ     -131072,DU
         4 001351   200010 756100                    STQ     PTR$+5,,AUTO
         4 001352   000000 636010                    EAQ     0,X0
         4 001353   200010 376100                    ANQ     PTR$+5,,AUTO
         4 001354   000043 772000                    QRL     35
         4 001355   000000 036005 xsym               ADLQ    JUL_TABLE,AL
         4 001356   000000 116000 xsym               CMPQ    TEMP_JUL
         4 001357   001400 604000 4                  TMI     s:10174

      458    10170    3                  + BITBIN ((TEMP_MONTHS > 1) & (LEAP)))
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:71   
      459    10171    3             THEN
      460    10172    3                  TEMP_DAYS = TEMP_JUL - (JUL_TABLE (TEMP_MONTHS - 1)

  10172  4 001360   400000 220003                    LDX0    -131072,DU
         4 001361   000000 235000 xsym               LDA     TEMP_MONTHS
         4 001362   000002 115007                    CMPA    2,DL
         4 001363   001365 605400 4                  TPNZ    s:10172+5
         4 001364   000000 220003                    LDX0    0,DU
         4 001365   000000 236000 xsym               LDQ     LEAP
         4 001366   400000 376003                    ANQ     -131072,DU
         4 001367   200010 756100                    STQ     PTR$+5,,AUTO
         4 001370   000000 636010                    EAQ     0,X0
         4 001371   200010 376100                    ANQ     PTR$+5,,AUTO
         4 001372   000043 772000                    QRL     35
         4 001373   777777 036005 xsym               ADLQ    JUL_TABLE-1,AL
         4 001374   200011 756100                    STQ     PTR$+6,,AUTO
         4 001375   000000 236000 xsym               LDQ     TEMP_JUL
         4 001376   200011 136100                    SBLQ    PTR$+6,,AUTO
         4 001377   000000 756000 xsym               STQ     TEMP_DAYS

      461    10173    3                       + BITBIN ((TEMP_MONTHS > 2) & (LEAP)));
      462    10174    3             END;

  10174  4 001400   000000 235000 xsym               LDA     TEMP_DAYS
         4 001401   001341 604400 4                  TMOZ    s:10168

      463    10175    2   END GET$MDY_J;

  10175  4 001402   200006 221300                    LDX1  ! PTR$+3,,AUTO
         4 001403   000001 702211                    TSX2  ! 1,X1

      464    10176        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:72   
      465    10177    1   VALIDATE: PROC;

  10177  4 001404   200006 741300       VALIDATE     STX1  ! PTR$+3,,AUTO

      466    10178
      467    10179    2        DATE_STATUS = %NO#;           /*  Assume Date is OK  */

  10179  4 001405   000036 450000 2                  STZ     DATE_STATUS

      468    10180    2        IF TEMP_MONTHS ~= 0

  10180  4 001406   000000 235000 xsym               LDA     TEMP_MONTHS
         4 001407   001441 600000 4                  TZE     s:10192

      469    10181    2        THEN
      470    10182    3          DO;

      471    10183    3             IF TEMP_MONTHS > 12 OR TEMP_DAYS < 1

  10183  4 001410   000014 115007                    CMPA    12,DL
         4 001411   001436 605400 4                  TPNZ    s:10189
         4 001412   000000 236000 xsym               LDQ     TEMP_DAYS
         4 001413   001436 604400 4                  TMOZ    s:10189
         4 001414   000000 720000 xsym               LXL0    TEMP_MONTHS
         4 001415   000000 236010 xsym               LDQ     JUL_TABLE,X0
         4 001416   777777 136005 xsym               SBLQ    JUL_TABLE-1,AL
         4 001417   400000 222003                    LDX2    -131072,DU
         4 001420   000000 235000 xsym               LDA     TEMP_MONTHS
         4 001421   000001 115007                    CMPA    1,DL
         4 001422   001424 605400 4                  TPNZ    s:10183+12
         4 001423   000000 222003                    LDX2    0,DU
         4 001424   200010 756100                    STQ     PTR$+5,,AUTO
         4 001425   000000 236000 xsym               LDQ     LEAP
         4 001426   400000 376003                    ANQ     -131072,DU
         4 001427   200011 756100                    STQ     PTR$+6,,AUTO
         4 001430   000000 636012                    EAQ     0,X2
         4 001431   200011 376100                    ANQ     PTR$+6,,AUTO
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:73   
         4 001432   000043 772000                    QRL     35
         4 001433   200010 036100                    ADLQ    PTR$+5,,AUTO
         4 001434   000000 116000 xsym               CMPQ    TEMP_DAYS
         4 001435   001443 605000 4                  TPL     s:10194

      472    10184    3             OR
      473    10185    3             TEMP_DAYS > (JUL_TABLE (TEMP_MONTHS)
      474    10186    3                  - JUL_TABLE (TEMP_MONTHS - 1)
      475    10187    3                  + BITBIN ((TEMP_MONTHS > 1) & (LEAP)))
      476    10188    3             THEN
      477    10189    3                  DATE_STATUS = %YES#;

  10189  4 001436   400000 236003                    LDQ     -131072,DU
         4 001437   000036 756000 2                  STQ     DATE_STATUS

      478    10190    3             END;

  10190  4 001440   001443 710000 4                  TRA     s:10194

      479    10191    2        ELSE
      480    10192    2             DATE_STATUS = %YES#;

  10192  4 001441   400000 236003                    LDQ     -131072,DU
         4 001442   000036 756000 2                  STQ     DATE_STATUS

      481    10193
      482    10194    2        RETURN;

  10194  4 001443   000001 702211                    TSX2  ! 1,X1

      483    10195
      484    10196    2   END VALIDATE;
      485    10197        %EJECT;
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:74   
      486    10198
      487    10199    1   SEND$OUT: PROC;

  10199  4 001444   200006 741300       SEND$OUT     STX1  ! PTR$+3,,AUTO

      488    10200
      489    10201    2        CALL BINCHAR (OY, BY1);

  10201  4 001445   000015 235000 2                  LDA     BY1
         4 001446   000044 773000                    LRL     36
         4 001447   200010 757100                    STAQ    PTR$+5,,AUTO
         4 001450   000000 301500                    BTD
         4 001451   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001452   000025 030004 2                  NDSC9   OY                       cn=0,s=nosgn,sf=0,n=4

      490    10202    2        CALL BINCHAR (OM, BM1);

  10202  4 001453   000017 235000 2                  LDA     BM1
         4 001454   000044 773000                    LRL     36
         4 001455   200010 757100                    STAQ    PTR$+5,,AUTO
         4 001456   000000 301500                    BTD
         4 001457   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001460   000027 030002 2                  NDSC9   OM                       cn=0,s=nosgn,sf=0,n=2

      491    10203    2        CALL BINCHAR (OD, BD1);

  10203  4 001461   000021 235000 2                  LDA     BD1
         4 001462   000044 773000                    LRL     36
         4 001463   200010 757100                    STAQ    PTR$+5,,AUTO
         4 001464   000000 301500                    BTD
         4 001465   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001466   000026 030002 2                  NDSC9   OD                       cn=0,s=nosgn,sf=0,n=2

      492    10204    2        CALL BINCHAR (O_WEEK_OF_MONTH, WEEK_OF_MONTH);

  10204  4 001467   000000 235000 xsym               LDA     WEEK_OF_MONTH
         4 001470   000044 773000                    LRL     36
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:75   
         4 001471   200010 757100                    STAQ    PTR$+5,,AUTO
         4 001472   000000 301500                    BTD
         4 001473   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001474   000043 030002 2                  NDSC9   O_WEEK_OF_MONTH          cn=0,s=nosgn,sf=0,n=2

      493    10205    2        CALL BINCHAR (O_WEEK_OF_YEAR, WEEK_OF_YEAR);

  10205  4 001475   000000 235000 xsym               LDA     WEEK_OF_YEAR
         4 001476   000044 773000                    LRL     36
         4 001477   200010 757100                    STAQ    PTR$+5,,AUTO
         4 001500   000000 301500                    BTD
         4 001501   200010 000010                    NDSC9   PTR$+5,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 001502   000044 030002 2                  NDSC9   O_WEEK_OF_YEAR           cn=0,s=nosgn,sf=0,n=2

      494    10206    2        CALL BINCHAR (OJULIAN, JULIAN);

  10206  4 001503   000000 301400                    BTD
         4 001504   000000 000004 xsym               NDSC9   JULIAN                   cn=0,s=lsgnf,sf=0,n=4
         4 001505   000034 030004 2                  NDSC9   OJULIAN                  cn=0,s=nosgn,sf=0,n=4

      495    10207
      496    10208
      497    10209    2        MESS_BUF = ' ';

  10209  4 001506   040000 100400                    MLR     fill='040'O
         4 001507   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001510   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256

      498    10210    2        CALL INDEX (LENGTH, 'y', DAYNAME);

  10210  4 001511   000000 124400                    SCM     mask='000'O
         4 001512   000000 000011 xsym               ADSC9   DAYNAME                  cn=0,n=9
         4 001513   000004 000001 5                  ADSC9   4                        cn=0,n=1
         4 001514   000031 000000 2                  ARG     LENGTH

      499    10211    2        COUNT = LENGTH+1;

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:76   
  10211  4 001515   000031 235000 2                  LDA     LENGTH
         4 001516   000001 035007                    ADLA    1,DL
         4 001517   000030 755000 2                  STA     COUNT

      500    10212    2        CALL INSERT (MESS_BUF, 0, LENGTH + 1, DAYNAME);

  10212  4 001520   000000 620005                    EAX0    0,AL
         4 001521   040040 100400                    MLR     fill='040'O
         4 001522   000000 000011 xsym               ADSC9   DAYNAME                  cn=0,n=9
         4 001523   000000 000010 xsym               ADSC9   MESS_BUF                 cn=0,n=*X0

      501    10213    2        CALL INSERT (MESS_BUF, COUNT, 2, ', ');

  10213  4 001524   000030 235000 2                  LDA     COUNT
         4 001525   040005 100400                    MLR     fill='040'O
         4 001526   000015 000002 3                  ADSC9   13                       cn=0,n=2
         4 001527   000000 000002 xsym               ADSC9   MESS_BUF,A               cn=0,n=2

      502    10214    2        COUNT = COUNT + 2;

  10214  4 001530   000002 236007                    LDQ     2,DL
         4 001531   000030 056000 2                  ASQ     COUNT

      503    10215
      504    10216    2        CALL INDEX (LENGTH, ' ', MONTHNAME);

  10216  4 001532   000000 124400                    SCM     mask='000'O
         4 001533   000000 000011 xsym               ADSC9   MONTHNAME                cn=0,n=9
         4 001534   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001535   000031 000000 2                  ARG     LENGTH

      505    10217    2        CALL INSERT (MESS_BUF, COUNT, LENGTH, MONTHNAME);

  10217  4 001536   000031 720000 2                  LXL0    LENGTH
         4 001537   000030 235000 2                  LDA     COUNT
         4 001540   040045 100400                    MLR     fill='040'O
         4 001541   000000 000011 xsym               ADSC9   MONTHNAME                cn=0,n=9
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:77   
         4 001542   000000 000010 xsym               ADSC9   MESS_BUF,A               cn=0,n=*X0

      506    10218    2        COUNT = COUNT + LENGTH;

  10218  4 001543   000030 236000 2                  LDQ     COUNT
         4 001544   000031 036000 2                  ADLQ    LENGTH
         4 001545   000030 756000 2                  STQ     COUNT

      507    10219    2        CALL INSERT (MESS_BUF, COUNT, 1, ' ');

  10219  4 001546   040006 100400                    MLR     fill='040'O
         4 001547   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001550   000000 000001 xsym               ADSC9   MESS_BUF,Q               cn=0,n=1

      508    10220    2        COUNT = COUNT + 1;

  10220  4 001551   000030 054000 2                  AOS     COUNT

      509    10221    2        IF BD1 < 10

  10221  4 001552   000021 235000 2                  LDA     BD1
         4 001553   000012 115007                    CMPA    10,DL
         4 001554   001573 603000 4                  TRC     s:10230

      510    10222    2        THEN
      511    10223    3          DO;

      512    10224    3             CALL INSERT (MESS_BUF, COUNT - 1, 4, OD, ', ');

  10224  4 001555   000030 236000 2                  LDQ     COUNT
         4 001556   040006 100400                    MLR     fill='040'O
         4 001557   000026 000002 2                  ADSC9   OD                       cn=0,n=2
         4 001560   777777 600002 xsym               ADSC9   MESS_BUF-1,Q             cn=3,n=2
         4 001561   040006 100400                    MLR     fill='040'O
         4 001562   000015 000002 3                  ADSC9   13                       cn=0,n=2
         4 001563   000000 200002 xsym               ADSC9   MESS_BUF,Q               cn=1,n=2

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:78   
      513    10225    3             CALL INSERT (MESS_BUF, COUNT - 1, 1, ' ');

  10225  4 001564   000030 235000 2                  LDA     COUNT
         4 001565   040005 100400                    MLR     fill='040'O
         4 001566   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001567   777777 600001 xsym               ADSC9   MESS_BUF-1,A             cn=3,n=1

      514    10226    3             COUNT = COUNT + 3;

  10226  4 001570   000003 236007                    LDQ     3,DL
         4 001571   000030 056000 2                  ASQ     COUNT

      515    10227    3             END;

  10227  4 001572   001604 710000 4                  TRA     s:10233

      516    10228    2        ELSE
      517    10229    3          DO;

      518    10230    3             CALL INSERT (MESS_BUF, COUNT, 4, OD, ', ');

  10230  4 001573   000030 236000 2                  LDQ     COUNT
         4 001574   040006 100400                    MLR     fill='040'O
         4 001575   000026 000002 2                  ADSC9   OD                       cn=0,n=2
         4 001576   000000 000002 xsym               ADSC9   MESS_BUF,Q               cn=0,n=2
         4 001577   040006 100400                    MLR     fill='040'O
         4 001600   000015 000002 3                  ADSC9   13                       cn=0,n=2
         4 001601   000000 400002 xsym               ADSC9   MESS_BUF,Q               cn=2,n=2

      519    10231    3             COUNT = COUNT + 4;

  10231  4 001602   000004 236007                    LDQ     4,DL
         4 001603   000030 056000 2                  ASQ     COUNT

      520    10232    3             END;

      521    10233    2        CALL INSERT (MESS_BUF, COUNT, 1, ' ');
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:79   

  10233  4 001604   000030 235000 2                  LDA     COUNT
         4 001605   040005 100400                    MLR     fill='040'O
         4 001606   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001607   000000 000001 xsym               ADSC9   MESS_BUF,A               cn=0,n=1

      522    10234    2        CALL INSERT (MESS_BUF, COUNT, 4, OY);

  10234  4 001610   040005 100400                    MLR     fill='040'O
         4 001611   000025 000004 2                  ADSC9   OY                       cn=0,n=4
         4 001612   000000 000004 xsym               ADSC9   MESS_BUF,A               cn=0,n=4

      523    10235    2        CALL M$WRITE (WRITE_OUT);

  10235  4 001613   000046 630400 2                  EPPR0   WRITE_OUT
         4 001614   040001 713400                    CLIMB   write
         4 001615   401400 401760                    pmme    nvectors=4

      524    10236    2        IF TYPE = 'J'

  10236  4 001616   000037 236000 2                  LDQ     TYPE
         4 001617   777000 376003                    ANQ     -512,DU
         4 001620   112000 116003                    CMPQ    37888,DU
         4 001621   001653 601000 4                  TNZ     s:10253

      525    10237    2        THEN
      526    10238    3          DO;

      527    10239    3             CALL INSERT (SLASH, 0, 2, OM);

  10239  4 001622   000027 220000 2                  LDX0    OM
         4 001623   000040 740000 2                  STX0    SLASH

      528    10240    3             CALL INSERT (SLASH, 3, 2, OD);

  10240  4 001624   040000 100400                    MLR     fill='040'O
         4 001625   000026 000002 2                  ADSC9   OD                       cn=0,n=2
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:80   
         4 001626   000040 600002 2                  ADSC9   SLASH                    cn=3,n=2

      529    10241    3             CALL INSERT (SLASH, 6, 4, OY);

  10241  4 001627   040000 100400                    MLR     fill='040'O
         4 001630   000025 000004 2                  ADSC9   OY                       cn=0,n=4
         4 001631   000041 400004 2                  ADSC9   SLASH+1                  cn=2,n=4

      530    10242    3             IF BM1 < 10

  10242  4 001632   000017 235000 2                  LDA     BM1
         4 001633   000012 115007                    CMPA    10,DL
         4 001634   001637 603000 4                  TRC     s:10245

      531    10243    3             THEN
      532    10244    3                  CALL INSERT (SLASH, 0, 1, ' ');

  10244  4 001635   040000 236003                    LDQ     16384,DU
         4 001636   000040 552040 2                  STBQ    SLASH,'40'O

      533    10245    3             IF BD1 < 10

  10245  4 001637   000021 236000 2                  LDQ     BD1
         4 001640   000012 116007                    CMPQ    10,DL
         4 001641   001644 603000 4                  TRC     s:10248

      534    10246    3             THEN
      535    10247    3                  CALL INSERT (SLASH, 3, 1, ' ');

  10247  4 001642   000040 236007                    LDQ     32,DL
         4 001643   000040 552004 2                  STBQ    SLASH,'04'O

      536    10248    3             MESS_BUF = SLASH;

  10248  4 001644   040000 100400                    MLR     fill='040'O
         4 001645   000040 000012 2                  ADSC9   SLASH                    cn=0,n=10
         4 001646   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:81   

      537    10249    3             CALL M$WRITE (WRITE_OUT);

  10249  4 001647   000046 630400 2                  EPPR0   WRITE_OUT
         4 001650   040001 713400                    CLIMB   write
         4 001651   401400 401760                    pmme    nvectors=4

      538    10250    3             END;

  10250  4 001652   001710 710000 4                  TRA     s:10270

      539    10251    2        ELSE
      540    10252    3          DO;

      541    10253    3            CALL CONCAT (MESS_BUF, 'Julian day..............');

  10253  4 001653   040000 100400                    MLR     fill='040'O
         4 001654   000016 000030 3                  ADSC9   14                       cn=0,n=24
         4 001655   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256

      542    10254    3            X = 0;

  10254  4 001656   000035 450000 2                  STZ     X

      543    10255    3            LENGTH = 4;

  10255  4 001657   000004 235007                    LDA     4,DL
         4 001660   000031 755000 2                  STA     LENGTH

      544    10256    4            DO UNTIL X = 2;

      545    10257    4                 IF SUBSTR (OJULIAN, X, 1) = '0'

  10257  4 001661   000035 235000 2                  LDA     X
         4 001662   040000 106405                    CMPC    fill='040'O
         4 001663   000034 000001 2                  ADSC9   OJULIAN,A                cn=0,n=1
         4 001664   000003 000001 5                  ADSC9   3                        cn=0,n=1
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:82   
         4 001665   001673 601000 4                  TNZ     s:10264

      546    10258    4                 THEN
      547    10259    5                   DO;

      548    10260    5                      X = X + 1;

  10260  4 001666   000001 035007                    ADLA    1,DL
         4 001667   000035 755000 2                  STA     X

      549    10261    5                      LENGTH = LENGTH - 1;

  10261  4 001670   000001 336007                    LCQ     1,DL
         4 001671   000031 056000 2                  ASQ     LENGTH

      550    10262    5                      END;

  10262  4 001672   001675 710000 4                  TRA     s:10265

      551    10263    4                 ELSE
      552    10264    4                      X = 2;

  10264  4 001673   000002 236007                    LDQ     2,DL
         4 001674   000035 756000 2                  STQ     X

      553    10265    4                 END;

  10265  4 001675   000035 235000 2                  LDA     X
         4 001676   000002 115007                    CMPA    2,DL
         4 001677   001661 601000 4                  TNZ     s:10257

      554    10266    3            CALL INSERT (MESS_BUF, 24, LENGTH,

  10266  4 001700   000031 336000 2                  LCQ     LENGTH
         4 001701   000031 720000 2                  LXL0    LENGTH
         4 001702   040040 100446                    MLR     fill='040'O
         4 001703   000035 000010 2                  ADSC9   X,Q                      cn=0,n=*X0
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:83   
         4 001704   000006 000010 xsym               ADSC9   MESS_BUF+6               cn=0,n=*X0

      555    10267    3                      SUBSTR (OJULIAN, LENGTHC (OJULIAN) - LENGTH, LENGTH));
      556    10268    3            CALL M$WRITE (WRITE_OUT);

  10268  4 001705   000046 630400 2                  EPPR0   WRITE_OUT
         4 001706   040001 713400                    CLIMB   write
         4 001707   401400 401760                    pmme    nvectors=4

      557    10269    3             END;

      558    10270    2        CALL CONCAT (MESS_BUF, 'Week of year............');

  10270  4 001710   040000 100400                    MLR     fill='040'O
         4 001711   000024 000030 3                  ADSC9   20                       cn=0,n=24
         4 001712   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256

      559    10271    2        LENGTH = 2;

  10271  4 001713   000002 235007                    LDA     2,DL
         4 001714   000031 755000 2                  STA     LENGTH

      560    10272    2        IF SUBSTR (O_WEEK_OF_YEAR, 0, 1) = '0'

  10272  4 001715   000044 236000 2                  LDQ     O_WEEK_OF_YEAR
         4 001716   777000 376003                    ANQ     -512,DU
         4 001717   060000 116003                    CMPQ    24576,DU
         4 001720   001723 601000 4                  TNZ     s:10275

      561    10273    2        THEN
      562    10274    2             LENGTH = LENGTH - 1;

  10274  4 001721   000001 336007                    LCQ     1,DL
         4 001722   000031 056000 2                  ASQ     LENGTH

      563    10275    2        CALL INSERT (MESS_BUF, 24, LENGTH,

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:84   
  10275  4 001723   000031 336000 2                  LCQ     LENGTH
         4 001724   000031 720000 2                  LXL0    LENGTH
         4 001725   040040 100446                    MLR     fill='040'O
         4 001726   000044 400010 2                  ADSC9   O_WEEK_OF_YEAR,Q         cn=2,n=*X0
         4 001727   000006 000010 xsym               ADSC9   MESS_BUF+6               cn=0,n=*X0

      564    10276    2                  SUBSTR (O_WEEK_OF_YEAR, LENGTHC (O_WEEK_OF_YEAR) - LENGTH, LENGTH));
      565    10277    2        CALL M$WRITE (WRITE_OUT);

  10277  4 001730   000046 630400 2                  EPPR0   WRITE_OUT
         4 001731   040001 713400                    CLIMB   write
         4 001732   401400 401760                    pmme    nvectors=4

      566    10278    2        CALL CONCAT (MESS_BUF, 'Week of month...........');

  10278  4 001733   040000 100400                    MLR     fill='040'O
         4 001734   000032 000030 3                  ADSC9   26                       cn=0,n=24
         4 001735   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256

      567    10279    2        LENGTH = 2;

  10279  4 001736   000002 235007                    LDA     2,DL
         4 001737   000031 755000 2                  STA     LENGTH

      568    10280    2        IF SUBSTR (O_WEEK_OF_MONTH, 0, 1) = '0'

  10280  4 001740   000043 236000 2                  LDQ     O_WEEK_OF_MONTH
         4 001741   777000 376003                    ANQ     -512,DU
         4 001742   060000 116003                    CMPQ    24576,DU
         4 001743   001746 601000 4                  TNZ     s:10283

      569    10281    2        THEN
      570    10282    2             LENGTH = LENGTH - 1;

  10282  4 001744   000001 336007                    LCQ     1,DL
         4 001745   000031 056000 2                  ASQ     LENGTH

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:85   
      571    10283    2        CALL INSERT (MESS_BUF, 24, LENGTH,

  10283  4 001746   000031 336000 2                  LCQ     LENGTH
         4 001747   000031 720000 2                  LXL0    LENGTH
         4 001750   040040 100446                    MLR     fill='040'O
         4 001751   000043 400010 2                  ADSC9   O_WEEK_OF_MONTH,Q        cn=2,n=*X0
         4 001752   000006 000010 xsym               ADSC9   MESS_BUF+6               cn=0,n=*X0

      572    10284    2                 SUBSTR (O_WEEK_OF_MONTH, LENGTHC (O_WEEK_OF_MONTH) - LENGTH, LENGTH))
             10284                           ;
      573    10285    2        CALL M$WRITE (WRITE_OUT);

  10285  4 001753   000046 630400 2                  EPPR0   WRITE_OUT
         4 001754   040001 713400                    CLIMB   write
         4 001755   401400 401760                    pmme    nvectors=4

      574    10286                                                /**/
      575    10287                                                /**/
      576    10288    2        IF LEAP

  10288  4 001756   000000 234000 xsym               SZN     LEAP
         4 001757   001764 605000 4                  TPL     s:10292

      577    10289    2        THEN
      578    10290    2            MESS_BUF = 'Leap year...............Yes';

  10290  4 001760   040000 100400                    MLR     fill='040'O
         4 001761   000040 000033 3                  ADSC9   32                       cn=0,n=27
         4 001762   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256
         4 001763   001767 710000 4                  TRA     s:10293

      579    10291    2        ELSE
      580    10292    2            MESS_BUF = 'Leap year...............No';

  10292  4 001764   040000 100400                    MLR     fill='040'O
         4 001765   000047 000032 3                  ADSC9   39                       cn=0,n=26
         4 001766   000000 000400 xsym               ADSC9   MESS_BUF                 cn=0,n=256
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:86   

      581    10293    2        CALL M$WRITE (WRITE_OUT);

  10293  4 001767   000046 630400 2                  EPPR0   WRITE_OUT
         4 001770   040001 713400                    CLIMB   write
         4 001771   401400 401760                    pmme    nvectors=4

      582    10294
      583    10295    2   END SEND$OUT;

  10295  4 001772   200006 221300                    LDX1  ! PTR$+3,,AUTO
         4 001773   000001 702211                    TSX2  ! 1,X1
      584    10296    1   END IAD$DATE;
      585    10297

PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:87   
--  Include file information  --

   B$JIT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   IA_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   IA_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure IAD$DATE.
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:88   

 **** Variables and constants ****

  ****  Section 002  Data  IAD$DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    21-0-0/w UBIN        r     1 BD1                       22-0-0/w UBIN        r     1 BD2
    23-0-0/w SBIN        r     1 BI1                       17-0-0/w UBIN        r     1 BM1
    20-0-0/w UBIN        r     1 BM2                       32-0-0/w UBIN        r     1 BNNNN
    15-0-0/w UBIN        r     1 BY1                       15-0-0/w SBIN        r     1 BY1S
    16-0-0/w UBIN        r     1 BY2                       16-0-0/w SBIN        r     1 BY2S
    30-0-0/w SBIN        r     1 COUNT                     36-0-0/w BIT         r     1 DATE_STATUS
    14-0-0/w UBIN(9)     r     1 EVAL_CASE                 11-0-0/c CHAR(2)     r     1 ID1
    12-0-0/c CHAR(2)     r     1 ID2                       13-0-0/c CHAR(4)     r     1 II1
     3-0-0/c CHAR(3)     r     1 IJ1                        4-0-0/c CHAR(3)     r     1 IJ2
     7-0-0/c CHAR(2)     r     1 IM1                       10-0-0/c CHAR(2)     r     1 IM2
     5-0-0/c CHAR(4)     r     1 IY1                        6-0-0/c CHAR(4)     r     1 IY2
    31-0-0/w SBIN        r     1 LENGTH                     0-0-0/c CHAR(10)    r     1 NNNN
    26-0-0/c CHAR(2)     r     1 OD                        34-0-0/c CHAR(4)     r     1 OJULIAN
    27-0-0/c CHAR(2)     r     1 OM                        25-0-0/c CHAR(4)     r     1 OY
    43-0-0/c CHAR(2)     r     1 O_WEEK_OF_MONTH           44-0-0/c CHAR(2)     r     1 O_WEEK_OF_YEAR
    24-0-0/w SBIN        r     1 RESULT                    40-0-0/c CHAR(10)    r     1 SLASH
    33-0-0/w UBIN        r     1 SUBS                      37-0-0/c CHAR        r     1 TYPE
    46-0-0/d STRC(432)   r     1 WRITE_OUT                 35-0-0/w UBIN        r     1 X

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 PTR$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:89   

     0-0-0/w UBIN        r     1 CYCLE_DAYS_LAST            0-0-0/c CHAR(9)     r     1 DAYNAME
     0-0-0/w PTR         r     1 GOOSE_OUT$                 0-0-0/w SBIN        r     1 JULIAN
     0-0-0/w SBIN        r     1 JUL_TABLE(0:12)
     0-0-0/w BIT         r     1 LEAP                       0-0-0/c CHAR(256)   r     1 MESS_BUF
     0-0-0/c CHAR(9)     r     1 MONTHNAME                  0-0-0/w SBIN        r     1 TEMP_DAYS
     0-0-0/w SBIN        r     1 TEMP_JUL                   0-0-0/w SBIN        r     1 TEMP_MONTHS
     0-0-0/w SBIN        r     1 TEMP_YEARS                 0-0-0/w SBIN        r     1 TOTAL_DAYS
     0-0-0/w UBIN        r     1 WEEK_OF_MONTH              0-0-0/w UBIN        r     1 WEEK_OF_YEAR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$DO                       0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure IAD$DATE requires 1020 words for executable code.
   Procedure IAD$DATE requires 10 words of local(AUTO) storage.

    No errors detected in file IAD$DATE.:E05TSI    .
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:90   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:91   
          MINI XREF LISTING

BD1
      9727**DCL      9824<<ASSIGN   9859<<CALLBLT 10010>>ASSIGN  10035<<ASSIGN  10054<<ASSIGN  10203>>CALLBLT
     10221>>IF      10245>>IF
BD2
      9728**DCL      9931<<ASSIGN   9983<<CALLBLT 10063>>ASSIGN
BI1
      9729**DCL      9948<<CALLBLT 10000<<CALLBLT 10131>>ASSIGN  10133>>ASSIGN
BM1
      9725**DCL      9823<<ASSIGN   9858<<CALLBLT 10009>>ASSIGN  10034<<ASSIGN  10053<<ASSIGN  10202>>CALLBLT
     10242>>IF
BM2
      9726**DCL      9930<<ASSIGN   9982<<CALLBLT 10062>>ASSIGN
BNNNN
      9739**DCL      9889<<CALLBLT  9900<<CALLBLT 10022>>ASSIGN  10041>>ASSIGN
BREAKDOWN
     10006**PROC     9866--CALL
BY1
      9721**DCL      9722--REDEF    9818<<CALLBLT  9819>>ASSIGN   9860<<CALLBLT 10011>>ASSIGN  10033<<ASSIGN
     10052<<ASSIGN  10071>>IF      10091>>IF      10096>>IF      10201>>CALLBLT
BY1S
      9722**DCL     10093>>ASSIGN  10098>>ASSIGN
BY2
      9723**DCL      9724--REDEF    9925<<CALLBLT  9926>>ASSIGN   9981<<CALLBLT 10061>>ASSIGN  10071>>IF
     10091>>IF      10096>>IF
BY2S
      9724**DCL     10093>>ASSIGN  10098>>ASSIGN
COUNT
      9737**DCL     10211<<ASSIGN  10213>>CALLBLT 10214<<ASSIGN  10214>>ASSIGN  10217>>CALLBLT 10218<<ASSIGN
     10218>>ASSIGN  10219>>CALLBLT 10220<<ASSIGN  10220>>ASSIGN  10224>>CALLBLT 10225>>CALLBLT 10226<<ASSIGN
     10226>>ASSIGN  10230>>CALLBLT 10231<<ASSIGN  10231>>ASSIGN  10233>>CALLBLT 10234>>CALLBLT
CYCLE_DAYS_LAST
      6192**DCL     10018<<ASSIGN  10074>>IF      10081>>IF      10084>>ASSIGN  10087>>ASSIGN  10093>>ASSIGN
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:92   
     10098>>ASSIGN
DATE_STATUS
      9743**DCL      9867>>IF      10014>>IF      10066>>IF      10179<<ASSIGN  10189<<ASSIGN  10192<<ASSIGN
DAYNAME
      6187**DCL     10210>>CALLBLT 10212>>CALLBLT
EVAL_CASE
      9720**DCL      9798<<ASSIGN   9830<<ASSIGN   9881<<ASSIGN   9892<<ASSIGN   9903<<ASSIGN   9938<<ASSIGN
      9940<<ASSIGN   9953<<ASSIGN   9990<<ASSIGN   9992<<ASSIGN  10020>>DOCASE  10126>>IF      10126>>IF
     10129>>IF
GET$MDY_J
     10163**PROC     9822--CALL     9929--CALL    10032--CALL    10051--CALL
GET$REST
      9873**PROC     9828--CALL     9864--CALL
GOOSE_OUT$
      9621**DCL      9792>>DOCASE   9799>>CALLBLT  9799>>CALLBLT  9799>>CALLBLT  9804>>CALLBLT  9804>>CALLBLT
      9804>>CALLBLT  9825>>ASSIGN   9835>>CALLBLT  9835>>CALLBLT  9835>>CALLBLT  9840>>CALLBLT  9840>>CALLBLT
      9840>>CALLBLT  9845>>CALLBLT  9845>>CALLBLT  9845>>CALLBLT  9861>>ASSIGN   9876>>ASSIGN   9878>>ASSIGN
IAM$CYCLE
      9618**DCL-ENT 10017--CALL    10036--CALL    10055--CALL    10069--CALL
IAM$LEAP
      9619**DCL-ENT  9820--CALL     9927--CALL    10012--CALL    10028--CALL    10046--CALL    10064--CALL
ID1
      9717**DCL      9834<<ASSIGN   9840<<CALLBLT  9840--CALLBLT  9859>>CALLBLT
ID2
      9718**DCL      9956<<ASSIGN   9962<<CALLBLT  9962--CALLBLT  9983>>CALLBLT
II1
      9719**DCL      9942<<ASSIGN   9943<<CALLBLT  9943--CALLBLT  9948>>CALLBLT  9994<<ASSIGN   9995<<CALLBLT
      9995--CALLBLT 10000>>CALLBLT
IJ1
      9711**DCL      9795<<ASSIGN   9799<<CALLBLT  9799--CALLBLT  9821>>CALLBLT
IJ2
      9712**DCL      9904<<ASSIGN   9906<<CALLBLT  9906--CALLBLT  9928>>CALLBLT
IM1
      9715**DCL      9833<<ASSIGN   9835<<CALLBLT  9835--CALLBLT  9858>>CALLBLT
IM2
      9716**DCL      9955<<ASSIGN   9957<<CALLBLT  9957--CALLBLT  9982>>CALLBLT
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:93   
IY1
      9713**DCL      9796<<ASSIGN   9804<<CALLBLT  9804--CALLBLT  9810>>IF       9810>>IF       9812<<CALLBLT
      9814>>IF       9816<<CALLBLT  9818>>CALLBLT  9832<<ASSIGN   9845<<CALLBLT  9845--CALLBLT  9851>>IF
      9851>>IF       9853<<CALLBLT  9855>>IF       9857<<CALLBLT  9860>>CALLBLT
IY2
      9714**DCL      9905<<ASSIGN   9911<<CALLBLT  9911--CALLBLT  9917>>IF       9917>>IF       9919<<CALLBLT
      9921>>IF       9923<<CALLBLT  9925>>CALLBLT  9954<<ASSIGN   9967<<CALLBLT  9967--CALLBLT  9973>>IF
      9973>>IF       9975<<CALLBLT  9977>>IF       9979<<CALLBLT  9981>>CALLBLT
JULIAN
      6190**DCL     10022<<ASSIGN  10022>>ASSIGN  10023>>IF      10025>>DOWHILE 10026<<ASSIGN  10026>>ASSIGN
     10031>>ASSIGN  10041<<ASSIGN  10041>>ASSIGN  10042>>IF      10044>>DOWHILE 10047<<ASSIGN  10047>>ASSIGN
     10050>>ASSIGN  10206>>CALLBLT
JUL_TABLE
      6188**DCL     10169>>IF      10172>>ASSIGN  10183>>IF      10183>>IF
LEAP
      6195**DCL      9790<<ASSIGN  10023>>IF      10025>>DOWHILE 10026>>ASSIGN  10047>>ASSIGN  10169>>IF
     10172>>ASSIGN  10183>>IF      10288>>IF
LENGTH
      9738**DCL     10105<<ASSIGN  10111<<ASSIGN  10111>>ASSIGN  10118>>CALLBLT 10118>>CALLBLT 10118>>CALLBLT
     10122>>CALLBLT 10137<<ASSIGN  10143<<ASSIGN  10143>>ASSIGN  10150>>CALLBLT 10150>>CALLBLT 10150>>CALLBLT
     10210<<CALLBLT 10211>>ASSIGN  10212>>CALLBLT 10216<<CALLBLT 10217>>CALLBLT 10218>>ASSIGN  10255<<ASSIGN
     10261<<ASSIGN  10261>>ASSIGN  10266>>CALLBLT 10266>>CALLBLT 10266>>CALLBLT 10271<<ASSIGN  10274<<ASSIGN
     10274>>ASSIGN  10275>>CALLBLT 10275>>CALLBLT 10275>>CALLBLT 10279<<ASSIGN  10282<<ASSIGN  10282>>ASSIGN
     10283>>CALLBLT 10283>>CALLBLT 10283>>CALLBLT
M$WRITE
      5498**DCL-ENT 10124--CALL    10152--CALL    10235--CALL    10249--CALL    10268--CALL    10277--CALL
     10285--CALL    10293--CALL
MESS_BUF
      6188**DCL      6188--REDEF    9772--DCLINIT  9773--DCLINIT 10102<<ASSIGN  10118<<CALLBLT 10122<<CALLBLT
     10134<<ASSIGN  10150<<CALLBLT 10209<<ASSIGN  10212<<CALLBLT 10213<<CALLBLT 10217<<CALLBLT 10219<<CALLBLT
     10224<<CALLBLT 10225<<CALLBLT 10230<<CALLBLT 10233<<CALLBLT 10234<<CALLBLT 10248<<ASSIGN  10253<<CALLBLT
     10266<<CALLBLT 10270<<CALLBLT 10275<<CALLBLT 10278<<CALLBLT 10283<<CALLBLT 10290<<ASSIGN  10292<<ASSIGN
MONTHNAME
      6187**DCL     10216>>CALLBLT 10217>>CALLBLT
NNNN
      9710**DCL      9882<<ASSIGN   9883<<CALLBLT  9883--CALLBLT  9889>>CALLBLT  9893<<ASSIGN   9894<<CALLBLT
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:94   
      9894--CALLBLT  9900>>CALLBLT 10103<<CALLBLT 10107>>IF      10118>>CALLBLT 10118--CALLBLT 10135<<CALLBLT
     10139>>IF      10150>>CALLBLT 10150--CALLBLT
OD
      9735**DCL     10203<<CALLBLT 10224>>CALLBLT 10230>>CALLBLT 10240>>CALLBLT
OJULIAN
      9741**DCL     10206<<CALLBLT 10257>>IF      10266>>CALLBLT 10266--CALLBLT
OM
      9736**DCL     10202<<CALLBLT 10239>>CALLBLT
OUT$BLK.CODE
      9638**DCL      9792>>DOCASE   9879>>DOCASE   9936>>DOCASE   9988>>DOCASE
OUT$BLK.NSUBLKS
      9642**DCL      9825>>ASSIGN   9861>>ASSIGN   9933>>IF       9985>>IF
OUT$BLK.SUBLK$
      9663**DCL      9792>>DOCASE   9799>>CALLBLT  9799>>CALLBLT  9799>>CALLBLT  9799>>CALLBLT  9799>>CALLBLT
      9799>>CALLBLT  9804>>CALLBLT  9804>>CALLBLT  9804>>CALLBLT  9804>>CALLBLT  9804>>CALLBLT  9804>>CALLBLT
      9825>>ASSIGN   9835>>CALLBLT  9835>>CALLBLT  9835>>CALLBLT  9835>>CALLBLT  9835>>CALLBLT  9835>>CALLBLT
      9840>>CALLBLT  9840>>CALLBLT  9840>>CALLBLT  9840>>CALLBLT  9840>>CALLBLT  9840>>CALLBLT  9845>>CALLBLT
      9845>>CALLBLT  9845>>CALLBLT  9845>>CALLBLT  9845>>CALLBLT  9845>>CALLBLT  9861>>ASSIGN   9876>>ASSIGN
      9876>>ASSIGN   9878>>ASSIGN   9878>>ASSIGN   9883>>CALLBLT  9883>>CALLBLT  9883>>CALLBLT  9894>>CALLBLT
      9894>>CALLBLT  9894>>CALLBLT  9906>>CALLBLT  9906>>CALLBLT  9906>>CALLBLT  9911>>CALLBLT  9911>>CALLBLT
      9911>>CALLBLT  9936>>DOCASE   9943>>CALLBLT  9943>>CALLBLT  9943>>CALLBLT  9943>>CALLBLT  9943>>CALLBLT
      9943>>CALLBLT  9957>>CALLBLT  9957>>CALLBLT  9957>>CALLBLT  9962>>CALLBLT  9962>>CALLBLT  9962>>CALLBLT
      9967>>CALLBLT  9967>>CALLBLT  9967>>CALLBLT  9988>>DOCASE   9995>>CALLBLT  9995>>CALLBLT  9995>>CALLBLT
      9995>>CALLBLT  9995>>CALLBLT  9995>>CALLBLT
OUT$SYM.COUNT
      9699**DCL      9702--IMP-SIZ  9799>>CALLBLT  9799>>CALLBLT  9804>>CALLBLT  9804>>CALLBLT  9835>>CALLBLT
      9835>>CALLBLT  9840>>CALLBLT  9840>>CALLBLT  9845>>CALLBLT  9845>>CALLBLT  9883>>CALLBLT  9883>>CALLBLT
      9894>>CALLBLT  9894>>CALLBLT  9906>>CALLBLT  9906>>CALLBLT  9911>>CALLBLT  9911>>CALLBLT  9943>>CALLBLT
      9943>>CALLBLT  9957>>CALLBLT  9957>>CALLBLT  9962>>CALLBLT  9962>>CALLBLT  9967>>CALLBLT  9967>>CALLBLT
      9995>>CALLBLT  9995>>CALLBLT
OUT$SYM.TEXT
      9702**DCL      9799>>CALLBLT  9804>>CALLBLT  9835>>CALLBLT  9840>>CALLBLT  9845>>CALLBLT  9883>>CALLBLT
      9894>>CALLBLT  9906>>CALLBLT  9911>>CALLBLT  9943>>CALLBLT  9957>>CALLBLT  9962>>CALLBLT  9967>>CALLBLT
      9995>>CALLBLT
OY
      9734**DCL     10201<<CALLBLT 10234>>CALLBLT 10241>>CALLBLT
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:95   
O_WEEK_OF_MONTH
      9747**DCL     10204<<CALLBLT 10280>>IF      10283>>CALLBLT 10283--CALLBLT
O_WEEK_OF_YEAR
      9748**DCL     10205<<CALLBLT 10272>>IF      10275>>CALLBLT 10275--CALLBLT
PTR$
      9731**DCL      9876<<ASSIGN   9878<<ASSIGN   9879>>DOCASE   9883>>CALLBLT  9883>>CALLBLT  9883>>CALLBLT
      9894>>CALLBLT  9894>>CALLBLT  9894>>CALLBLT  9906>>CALLBLT  9906>>CALLBLT  9906>>CALLBLT  9911>>CALLBLT
      9911>>CALLBLT  9911>>CALLBLT  9933>>IF       9936>>DOCASE   9943>>CALLBLT  9943>>CALLBLT  9943>>CALLBLT
      9957>>CALLBLT  9957>>CALLBLT  9957>>CALLBLT  9962>>CALLBLT  9962>>CALLBLT  9962>>CALLBLT  9967>>CALLBLT
      9967>>CALLBLT  9967>>CALLBLT  9985>>IF       9988>>DOCASE   9995>>CALLBLT  9995>>CALLBLT  9995>>CALLBLT
RESULT
      9733**DCL     10077<<ASSIGN  10084<<ASSIGN  10087<<ASSIGN  10093<<ASSIGN  10098<<ASSIGN  10103>>CALLBLT
     10131<<ASSIGN  10131>>ASSIGN  10133<<ASSIGN  10133>>ASSIGN  10135>>CALLBLT
SEND$OUT
     10199**PROC    10037--CALL    10056--CALL    10157--CALL
SLASH
      9746**DCL     10239<<CALLBLT 10240<<CALLBLT 10241<<CALLBLT 10244<<CALLBLT 10247<<CALLBLT 10248>>ASSIGN
SUBS
      9740**DCL      9825<<ASSIGN   9826>>IF       9861<<ASSIGN   9862>>IF
TEMP_DAYS
      6189**DCL      9824>>ASSIGN   9931>>ASSIGN  10010<<ASSIGN  10035>>ASSIGN  10054>>ASSIGN  10063<<ASSIGN
     10165<<ASSIGN  10167>>DOUNTIL 10172<<ASSIGN  10183>>IF      10183>>IF
TEMP_JUL
      6190**DCL      9821<<CALLBLT  9928<<CALLBLT 10031<<ASSIGN  10050<<ASSIGN  10169>>IF      10172>>ASSIGN
TEMP_MONTHS
      6189**DCL      9823>>ASSIGN   9930>>ASSIGN  10009<<ASSIGN  10034>>ASSIGN  10053>>ASSIGN  10062<<ASSIGN
     10166<<ASSIGN  10168<<ASSIGN  10168>>ASSIGN  10169>>IF      10169>>IF      10172>>ASSIGN  10172>>ASSIGN
     10180>>IF      10183>>IF      10183>>IF      10183>>IF      10183>>IF
TEMP_YEARS
      6190**DCL      9819<<ASSIGN   9926<<ASSIGN  10011<<ASSIGN  10027<<ASSIGN  10027>>ASSIGN  10033>>ASSIGN
     10045<<ASSIGN  10045>>ASSIGN  10052>>ASSIGN  10061<<ASSIGN
TOTAL_DAYS
      6193**DCL     10018>>ASSIGN  10074>>IF      10081>>IF      10084>>ASSIGN  10087>>ASSIGN  10093>>ASSIGN
     10098>>ASSIGN
TYPE
      9744**DCL      9797<<ASSIGN   9831<<ASSIGN   9874>>IF      10236>>IF
PL6.E3A0      #001=IAD$DATE File=IAD$DATE.:E05TSI                                TUE 07/29/97 22:25 Page:96   
VALIDATE
     10177**PROC    10013--CALL    10065--CALL
WEEK_OF_MONTH
      6195**DCL     10204>>CALLBLT
WEEK_OF_YEAR
      6195**DCL     10205>>CALLBLT
WRITE_OUT
      9771**DCL     10124<>CALL    10152<>CALL    10235<>CALL    10249<>CALL    10268<>CALL    10277<>CALL
     10285<>CALL    10293<>CALL
WRITE_OUT.STATION_
      9773**DCL      9773--REDEF
WRITE_OUT.V
      9774**DCL      9771--DCLINIT
WRITE_OUT.V.DVBYTE.VFC#
      9780**DCL      9780--REDEF
X
      9742**DCL     10104<<ASSIGN  10106>>DOUNTIL 10107>>IF      10110<<ASSIGN  10110>>ASSIGN  10115<<ASSIGN
     10136<<ASSIGN  10138>>DOUNTIL 10139>>IF      10142<<ASSIGN  10142>>ASSIGN  10147<<ASSIGN  10254<<ASSIGN
     10256>>DOUNTIL 10257>>IF      10260<<ASSIGN  10260>>ASSIGN  10264<<ASSIGN
