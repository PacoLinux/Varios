VERSION E05

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:1    
        1        1        /*M* QTC$READ_TRADER - Read a record from the TRADER file */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTC$READ_TRADER:
        9        9                PROC(P_MSGTYP, P_TYPE, P_FOUND_MSGTYP) ALTRET;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE QT_DATA_R;
       15       83        %INCLUDE QT_SUBS_C;
       16      167        %INCLUDE QT_MACROS_C;
       17      325        %INCLUDE QT_PERR_C;
       18      376        %INCLUDE Q_ERRCODE_C;
       19      399        %INCLUDE CP_6;
       20      480        %INCLUDE B_ERRORS_C;
       21     1607        %PAGE(ARG="Parameters");

              1624    1   /***************************************************************************
              1625    1    *                                                                         *
              1626    1    *                                 Parameters                              *
              1627    1    *                                                                         *
              1628    1    ***************************************************************************/

       22     1632    1   DCL P_MSGTYP CHAR(8);
       23     1633    1   DCL P_TYPE UBIN WORD;
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:2    
       24     1634    1   DCL P_FOUND_MSGTYP CHAR(8);
       25     1635        %PAGE(ARG="Externally defined routines");

              1652    1   /***************************************************************************
              1653    1    *                                                                         *
              1654    1    *                        Externally defined routines                      *
              1655    1    *                                                                         *
              1656    1    ***************************************************************************/

       26     1660    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       27     1661    1   DCL QTC$MON_ERR ENTRY(1);
       28     1662    1   DCL QTC$GETMEM ENTRY(2);
       29     1663    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       30     1664    1   DCL QTC$WRITE_TRADER ENTRY(2);
       31     1665        %PAGE(ARG="Symrefs");

              1682    1   /***************************************************************************
              1683    1    *                                                                         *
              1684    1    *                                  Symrefs                                *
              1685    1    *                                                                         *
              1686    1    ***************************************************************************/

       32     1690    1   DCL B$TCB$ PTR SYMREF;
       33     1691        %PAGE(ARG="DCBs");

              1708    1   /***************************************************************************
              1709    1    *                                                                         *
              1710    1    *                                    DCBs                                 *
              1711    1    *                                                                         *
              1712    1    ***************************************************************************/

       34     1716    1   DCL M$TRADER DCB;
       35     1717    1   DCL M$TRADER_SEQ DCB;
       36     1718        %PAGE(ARG="Based");

              1735    1   /***************************************************************************
              1736    1    *                                                                         *
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:3    
              1737    1    *                                   Based                                 *
              1738    1    *                                                                         *
              1739    1    ***************************************************************************/

       37     1743        %B$TCB;
       38     1746        %B$ALT;
       39     1754        %QT$ENTRY;
       40     1808        %PAGE(ARG="Static");

              1825    1   /***************************************************************************
              1826    1    *                                                                         *
              1827    1    *                                   Static                                *
              1828    1    *                                                                         *
              1829    1    ***************************************************************************/

       41     1833    1   DCL WILD_FLAG BIT(1) ALIGNED STATIC;
       42     1834
       43     1835    1   DCL SUFFIX CHAR(2) STATIC;
       44     1836
       45     1837        %VLP_NAME(FPTN=TEXTC_MSGTYP, NAME='12345678');
       46     1864    1   DCL 1 KEY STATIC,
       47     1865    1         2 * UBIN(9) UNAL INIT(10),
       48     1866    1         2 MSGTYP CHAR(8),
       49     1867    1         2 SUFFIX CHAR(2);
       50     1868        %PAGE(ARG="Auto");

              1885    1   /***************************************************************************
              1886    1    *                                                                         *
              1887    1    *                                    Auto                                 *
              1888    1    *                                                                         *
              1889    1    ***************************************************************************/

       51     1893    1   DCL POS UBIN WORD;
       52     1894        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:4    
              1911    1   /***************************************************************************
              1912    1    *                                                                         *
              1913    1    *                                Error codes                              *
              1914    1    *                                                                         *
              1915    1    ***************************************************************************/

       53     1919        %ERRCODE(NAME=CODE_SL, CODE#=%E$SL, FCG#=%FCG_QT, MID#=%MID_C);
       54     1926        /*E*       ERROR: QTC-E$SL-C
       55     1927
       56     1928                 MESSAGE: Internal error.  SETS lost for type %U1.
       57     1929             DESCRIPTION: For some reason the text of the set commands
       58     1930                          for this msgtyp can't be read.
       59     1931        */
       60     1932        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:5    
              1949    1   /***************************************************************************
              1950    1    *                                                                         *
              1951    1    *                                    FPTs                                 *
              1952    1    *                                                                         *
              1953    1    ***************************************************************************/

       61     1957        %FPT_READ(FPTN=FPT_READ_KEY, DCB=M$TRADER, KEYS=YES, KEY=KEY);
       62     1996
       63     1997        %FPT_READ(FPTN=FPT_READ_SEQ, DCB=M$TRADER_SEQ, KEYR=YES, KEY=KEY);
       64     2036
       65     2037        %FPT_PFIL(DCB=M$TRADER_SEQ, BOF=YES);
       66     2052        %PAGE(ARG="QTC$READ_TRADER", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:6    
              2069    1   /***************************************************************************
              2070    1    *                                                                         *
              2071    1    *                              QTC$READ_TRADER                            *
              2072    1    *                                                                         *
              2073    1    ***************************************************************************/

       67     2077    1           IF NOT QT_GLOBAL.FIRST_READ AND NOT WILD_FLAG THEN
       68     2078    2             DO;
       69     2079    2               GOTO ALT;
       70     2080    2             END;
       71     2081
       72     2082    1           IF QT_GLOBAL.FIRST_READ THEN
       73     2083    2             DO;
       74     2084    2               QT_GLOBAL.FIRST_READ = '0'B;
       75     2085
       76     2086    2               IF P_TYPE = 1 /* TYPE_E */ THEN
       77     2087    3                 DO;
       78     2088    3                   SUFFIX = '_E';
       79     2089    3                 END;
       80     2090    2               ELSE
       81     2091    3                 DO;
       82     2092    3                   SUFFIX = '_F';
       83     2093    3                 END;
       84     2094
       85     2095    2               WILD_FLAG = '0'B;
       86     2096    2               CALL INDEX(POS, '?', P_MSGTYP) ALTRET(NO_Q);
       87     2097    2               WILD_FLAG = '1'B;
       88     2098
       89     2099    2               CALL M$PFIL(FPT_PFIL) ALTRET(MON_ERR);
       90     2100    2             END;
       91     2101    1   NO_Q:
       92     2102    1           IF WILD_FLAG THEN
       93     2103    2             DO;
       94     2104    2               CALL READ_SEQ ALTRET(ALT);
       95     2105    2             END;
       96     2106    1           ELSE
       97     2107    2             DO;
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:7    
       98     2108    2               CALL READ_KEY ALTRET(ALT);
       99     2109    2             END;
      100     2110
      101     2111    1           P_FOUND_MSGTYP = KEY.MSGTYP;
      102     2112
      103     2113    1           IF P_TYPE = 1 /* TYPE_E */ AND
      104     2114    1               QT$ENTRY.SET_COUNT > 0 THEN
      105     2115    2             DO;
      106     2116    2               KEY.SUFFIX = '_S';
      107     2117
      108     2118    2   READ_SETTEXT:
      109     2119    2               FPT_READ_KEY.BUF_.BUF$ = QT_GLOBAL.QT$SETTEXT$;
      110     2120    2               FPT_READ_KEY.BUF_.BOUND = QT_GLOBAL.QT$SETTEXT_SIZE - 1;
      111     2121
      112     2122    2               CALL M$READ(FPT_READ_KEY) ALTRET(READ_SETTEXT_ERR);
      113     2123
      114     2124    3               DO WHILE('0'B);
      115     2125
      116     2126    3   READ_SETTEXT_ERR:
      117     2127    3                 IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 7 /* E$LD */ THEN
      118     2128    4                   DO;
      119     2129    4                     CALL QTC$GETMEM(QT_GLOBAL.QT$SETTEXT$, QT_GLOBAL.QT$SETTEXT_SIZE);
      120     2130    4                     GOTO READ_SETTEXT;
      121     2131    4                   END;
      122     2132
      123     2133    3                 IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 66 /* E$NOKEY */ THEN
      124     2134    4                   DO;
      125     2135    4                     GOTO MON_ERR;
      126     2136    4                   END;
      127     2137
      128     2138    3                 QT$ENTRY.FLAGS.DCBS_SET = '0'B;
      129     2139    3                 QT$ENTRY.SET_COUNT = 0;
      130     2140    3                 QT_CMDBLK.MINOR_ERR = CODE_SL;
      131     2141    3                 TEXTC_MSGTYP.NAME# = KEY.MSGTYP;
      132     2142    3                 CALL XUR$ERRMSG(CODE_SL, , , VECTOR(TEXTC_MSGTYP));
      133     2143    3                 CALL QTC$WRITE_TRADER(KEY.MSGTYP, 1 /* TYPE_E */);
      134     2144    3               END /* NEVER */;
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:8    
      135     2145    2             END;
      136     2146
      137     2147    1           RETURN;
      138     2148
      139     2149    1   ALT:
      140     2150    1           ALTRETURN;
      141     2151
      142     2152    1   MON_ERR:
      143     2153    1           CALL QTC$MON_ERR('1'B);
      144     2154                %PAGE(ARG="READ_SEQ", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:9    
              2171    1   /***************************************************************************
              2172    1    *                                                                         *
              2173    1    *                                  READ_SEQ                               *
              2174    1    *                                                                         *
              2175    1    ***************************************************************************/

      145     2179    1   READ_SEQ:
      146     2180    1           PROC ALTRET;
      147     2181
      148     2182    3           DO WHILE('1'B);
      149     2183    3             FPT_READ_SEQ.BUF_.BUF$ = QT_GLOBAL.QT$ENTRY$;
      150     2184    3             FPT_READ_SEQ.BUF_.BOUND = QT_GLOBAL.QT$ENTRY_SIZE - 1;
      151     2185    3             CALL M$READ(FPT_READ_SEQ) ALTRET(READ_SEQ_ERR);
      152     2186
      153     2187    4             DO WHILE('0'B);
      154     2188
      155     2189    4   READ_SEQ_ERR:
      156     2190    4               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 6 /* E$EOF */ THEN
      157     2191    5                 DO;
      158     2192    5                   GOTO ALT;
      159     2193    5                 END;
      160     2194
      161     2195    4               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 7 /* E$LD */ THEN
      162     2196    5                 DO;
      163     2197    5                   GOTO MON_ERR;
      164     2198    5                 END;
      165     2199
      166     2200    4               CALL QTC$GETMEM(QT_GLOBAL.QT$ENTRY$, QT_GLOBAL.QT$ENTRY_SIZE);
      167     2201    4               FPT_READ_KEY.BUF_.BUF$ = QT_GLOBAL.QT$ENTRY$;
      168     2202    4               FPT_READ_KEY.BUF_.BOUND = QT_GLOBAL.QT$ENTRY_SIZE - 1;
      169     2203    4               CALL M$READ(FPT_READ_KEY) ALTRET(READ_SEQ_ERR);
      170     2204    4             END /* NEVER */;
      171     2205
      172     2206    3             IF KEY.SUFFIX ~= SUFFIX THEN
      173     2207    4               DO;
      174     2208    4                 GOTO LOOP;
      175     2209    4               END;
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:10   
      176     2210
      177     2211    3             CALL QQC$WILD_COMP(P_MSGTYP, KEY.MSGTYP) ALTRET(LOOP);
      178     2212    3             GOTO RET;
      179     2213
      180     2214    3   LOOP:
      181     2215    3           END /* WHILE */;
      182     2216
      183     2217    2   RET:
      184     2218    2           RETURN;
      185     2219
      186     2220    2   ALT:
      187     2221    2           ALTRETURN;
      188     2222
      189     2223    2   MON_ERR:
      190     2224    2           CALL QTC$MON_ERR('1'B);
      191     2225
      192     2226    2   END READ_SEQ;
      193     2227                %PAGE(ARG="READ_KEY", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:11   
              2244    2   /***************************************************************************
              2245    2    *                                                                         *
              2246    2    *                                  READ_KEY                               *
              2247    2    *                                                                         *
              2248    2    ***************************************************************************/

      194     2252    1   READ_KEY:
      195     2253    1           PROC ALTRET;
      196     2254
      197     2255    2           KEY.MSGTYP = P_MSGTYP;
      198     2256    2           KEY.SUFFIX = SUFFIX;
      199     2257
      200     2258    2   READ:
      201     2259    2           FPT_READ_KEY.BUF_.BUF$ = QT_GLOBAL.QT$ENTRY$;
      202     2260    2           FPT_READ_KEY.BUF_.BOUND = QT_GLOBAL.QT$ENTRY_SIZE - 1;
      203     2261
      204     2262    2           CALL M$READ(FPT_READ_KEY) ALTRET(READ_KEY_ERR);
      205     2263
      206     2264    3           DO WHILE('0'B);
      207     2265
      208     2266    3   READ_KEY_ERR:
      209     2267    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 7 /* E$LD */ THEN
      210     2268    4               DO;
      211     2269    4                 CALL QTC$GETMEM(QT_GLOBAL.QT$ENTRY$, QT_GLOBAL.QT$ENTRY_SIZE);
      212     2270    4                 GOTO READ;
      213     2271    4               END;
      214     2272
      215     2273    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 66 /* E$NOKEY */ THEN
      216     2274    4               DO;
      217     2275    4                 GOTO ALT;
      218     2276    4               END;
      219     2277
      220     2278    3             CALL QTC$MON_ERR('1'B);
      221     2279    3           END /* NEVER */;
      222     2280
      223     2281    2           RETURN;
      224     2282
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:12   
      225     2283    2   ALT:
      226     2284    2           ALTRETURN;
      227     2285
      228     2286    2   END READ_KEY;
      229     2287    1   END QTC$READ_TRADER;

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:13   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QT_PERR_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTC$READ_TRADER.

   Procedure QTC$READ_TRADER requires 221 words for executable code.
   Procedure QTC$READ_TRADER requires 14 words of local(AUTO) storage.

    No errors detected in file QTC$READ_TRADER.:E05TSI    .

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:14   

 Object Unit name= QTC$READ_TRADER                            File name= QTC$READ_TRADER.:E05TOU
 UTS= JUL 30 '97 05:51:23.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$TRADER
    2   DCB   even  none     0      0  M$TRADER_SEQ
    3   Data  even  none    40     50  QTC$READ_TRADER
    4  RoData even  UTS      4      4  QTC$READ_TRADER
    5   Proc  even  none   221    335  QTC$READ_TRADER
    6  RoData even  none    13     15  QTC$READ_TRADER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        3  QTC$READ_TRADER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 QTC$GETMEM
         yes           Std       1 QTC$MON_ERR
         yes           Std       2 QTC$WRITE_TRADER
 yes     yes           Std       7 XUR$ERRMSG
 yes     yes           Std       2 QQC$WILD_COMP
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:15   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QT_GLOBAL                             QT_CMDBLK                             M$UC
     B$TCB$                                M$TRADER                              M$TRADER_SEQ
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:16   


        1        1        /*M* QTC$READ_TRADER - Read a record from the TRADER file */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTC$READ_TRADER:
        9        9                PROC(P_MSGTYP, P_TYPE, P_FOUND_MSGTYP) ALTRET;

      9  5 000000   000000 700200 xent  QTC$READ_TR* TSX0  ! X66_AUTO_3
         5 000001   000016 000003                    ZERO    14,3

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE QT_DATA_R;
       15       83        %INCLUDE QT_SUBS_C;
       16      167        %INCLUDE QT_MACROS_C;
       17      325        %INCLUDE QT_PERR_C;
       18      376        %INCLUDE Q_ERRCODE_C;
       19      399        %INCLUDE CP_6;
       20      480        %INCLUDE B_ERRORS_C;
       21     1607        %PAGE(ARG="Parameters");

              1624    1   /***************************************************************************
              1625    1    *                                                                         *
              1626    1    *                                 Parameters                              *
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:17   
              1627    1    *                                                                         *
              1628    1    ***************************************************************************/

       22     1632    1   DCL P_MSGTYP CHAR(8);
       23     1633    1   DCL P_TYPE UBIN WORD;
       24     1634    1   DCL P_FOUND_MSGTYP CHAR(8);
       25     1635        %PAGE(ARG="Externally defined routines");

              1652    1   /***************************************************************************
              1653    1    *                                                                         *
              1654    1    *                        Externally defined routines                      *
              1655    1    *                                                                         *
              1656    1    ***************************************************************************/

       26     1660    1   DCL QQC$WILD_COMP ENTRY(2) ALTRET;
       27     1661    1   DCL QTC$MON_ERR ENTRY(1);
       28     1662    1   DCL QTC$GETMEM ENTRY(2);
       29     1663    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       30     1664    1   DCL QTC$WRITE_TRADER ENTRY(2);
       31     1665        %PAGE(ARG="Symrefs");

              1682    1   /***************************************************************************
              1683    1    *                                                                         *
              1684    1    *                                  Symrefs                                *
              1685    1    *                                                                         *
              1686    1    ***************************************************************************/

       32     1690    1   DCL B$TCB$ PTR SYMREF;
       33     1691        %PAGE(ARG="DCBs");

              1708    1   /***************************************************************************
              1709    1    *                                                                         *
              1710    1    *                                    DCBs                                 *
              1711    1    *                                                                         *
              1712    1    ***************************************************************************/

       34     1716    1   DCL M$TRADER DCB;
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:18   
       35     1717    1   DCL M$TRADER_SEQ DCB;
       36     1718        %PAGE(ARG="Based");

              1735    1   /***************************************************************************
              1736    1    *                                                                         *
              1737    1    *                                   Based                                 *
              1738    1    *                                                                         *
              1739    1    ***************************************************************************/

       37     1743        %B$TCB;
       38     1746        %B$ALT;
       39     1754        %QT$ENTRY;
       40     1808        %PAGE(ARG="Static");

              1825    1   /***************************************************************************
              1826    1    *                                                                         *
              1827    1    *                                   Static                                *
              1828    1    *                                                                         *
              1829    1    ***************************************************************************/

       41     1833    1   DCL WILD_FLAG BIT(1) ALIGNED STATIC;
       42     1834
       43     1835    1   DCL SUFFIX CHAR(2) STATIC;
       44     1836
       45     1837        %VLP_NAME(FPTN=TEXTC_MSGTYP, NAME='12345678');
       46     1864    1   DCL 1 KEY STATIC,
       47     1865    1         2 * UBIN(9) UNAL INIT(10),
       48     1866    1         2 MSGTYP CHAR(8),
       49     1867    1         2 SUFFIX CHAR(2);
       50     1868        %PAGE(ARG="Auto");

              1885    1   /***************************************************************************
              1886    1    *                                                                         *
              1887    1    *                                    Auto                                 *
              1888    1    *                                                                         *
              1889    1    ***************************************************************************/

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:19   
       51     1893    1   DCL POS UBIN WORD;
       52     1894        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:20   
              1911    1   /***************************************************************************
              1912    1    *                                                                         *
              1913    1    *                                Error codes                              *
              1914    1    *                                                                         *
              1915    1    ***************************************************************************/

       53     1919        %ERRCODE(NAME=CODE_SL, CODE#=%E$SL, FCG#=%FCG_QT, MID#=%MID_C);
       54     1926        /*E*       ERROR: QTC-E$SL-C
       55     1927
       56     1928                 MESSAGE: Internal error.  SETS lost for type %U1.
       57     1929             DESCRIPTION: For some reason the text of the set commands
       58     1930                          for this msgtyp can't be read.
       59     1931        */
       60     1932        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:21   
              1949    1   /***************************************************************************
              1950    1    *                                                                         *
              1951    1    *                                    FPTs                                 *
              1952    1    *                                                                         *
              1953    1    ***************************************************************************/

       61     1957        %FPT_READ(FPTN=FPT_READ_KEY, DCB=M$TRADER, KEYS=YES, KEY=KEY);
       62     1996
       63     1997        %FPT_READ(FPTN=FPT_READ_SEQ, DCB=M$TRADER_SEQ, KEYR=YES, KEY=KEY);
       64     2036
       65     2037        %FPT_PFIL(DCB=M$TRADER_SEQ, BOF=YES);
       66     2052        %PAGE(ARG="QTC$READ_TRADER", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:22   
              2069    1   /***************************************************************************
              2070    1    *                                                                         *
              2071    1    *                              QTC$READ_TRADER                            *
              2072    1    *                                                                         *
              2073    1    ***************************************************************************/

       67     2077    1           IF NOT QT_GLOBAL.FIRST_READ AND NOT WILD_FLAG THEN

   2077  5 000002   000002 234000 xsym               SZN     QT_GLOBAL+2
         5 000003   000007 604000 5                  TMI     s:2082
         5 000004   000000 234000 3                  SZN     WILD_FLAG
         5 000005   000007 604000 5                  TMI     s:2082

       68     2078    2             DO;

       69     2079    2               GOTO ALT;

   2079  5 000006   000153 710000 5                  TRA     ALT

       70     2080    2             END;
       71     2081
       72     2082    1           IF QT_GLOBAL.FIRST_READ THEN

   2082  5 000007   000002 234000 xsym               SZN     QT_GLOBAL+2
         5 000010   000040 605000 5                  TPL     NO_Q

       73     2083    2             DO;

       74     2084    2               QT_GLOBAL.FIRST_READ = '0'B;

   2084  5 000011   000002 450000 xsym               STZ     QT_GLOBAL+2

       75     2085
       76     2086    2               IF P_TYPE = 1 /* TYPE_E */ THEN

   2086  5 000012   200004 470500                    LDP0    @P_TYPE,,AUTO
         5 000013   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:23   
         5 000014   000001 115007                    CMPA    1,DL
         5 000015   000021 601000 5                  TNZ     s:2092

       77     2087    3                 DO;

       78     2088    3                   SUFFIX = '_E';

   2088  5 000016   000001 220000 4                  LDX0    CODE_SL+1
         5 000017   000001 740000 3                  STX0    SUFFIX

       79     2089    3                 END;

   2089  5 000020   000023 710000 5                  TRA     s:2095

       80     2090    2               ELSE
       81     2091    3                 DO;

       82     2092    3                   SUFFIX = '_F';

   2092  5 000021   000002 220000 4                  LDX0    CODE_SL+2
         5 000022   000001 740000 3                  STX0    SUFFIX

       83     2093    3                 END;

       84     2094
       85     2095    2               WILD_FLAG = '0'B;

   2095  5 000023   000000 450000 3                  STZ     WILD_FLAG

       86     2096    2               CALL INDEX(POS, '?', P_MSGTYP) ALTRET(NO_Q);

   2096  5 000024   200003 471500                    LDP1    @P_MSGTYP,,AUTO
         5 000025   000000 124500                    SCM     mask='000'O
         5 000026   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         5 000027   000000 000001 6                  ADSC9   0                        cn=0,n=1
         5 000030   200006 000100                    ARG     POS,,AUTO
         5 000031   000040 606400 5                  TTN     NO_Q
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:24   

       87     2097    2               WILD_FLAG = '1'B;

   2097  5 000032   400000 236003                    LDQ     -131072,DU
         5 000033   000000 756000 3                  STQ     WILD_FLAG

       88     2098
       89     2099    2               CALL M$PFIL(FPT_PFIL) ALTRET(MON_ERR);

   2099  5 000034   000044 630400 3                  EPPR0   FPT_PFIL
         5 000035   440004 713400                    CLIMB   alt,+16388
         5 000036   400000 401760                    pmme    nvectors=1
         5 000037   000154 702000 5                  TSX2    MON_ERR

       90     2100    2             END;

       91     2101    1   NO_Q:
       92     2102    1           IF WILD_FLAG THEN

   2102  5 000040   000000 234000 3     NO_Q         SZN     WILD_FLAG
         5 000041   000045 605000 5                  TPL     s:2108

       93     2103    2             DO;

       94     2104    2               CALL READ_SEQ ALTRET(ALT);

   2104  5 000042   000161 701000 5                  TSX1    READ_SEQ
         5 000043   000153 702000 5                  TSX2    ALT

       95     2105    2             END;

   2105  5 000044   000047 710000 5                  TRA     s:2111

       96     2106    1           ELSE
       97     2107    2             DO;

       98     2108    2               CALL READ_KEY ALTRET(ALT);
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:25   

   2108  5 000045   000261 701000 5                  TSX1    READ_KEY
         5 000046   000153 702000 5                  TSX2    ALT

       99     2109    2             END;

      100     2110
      101     2111    1           P_FOUND_MSGTYP = KEY.MSGTYP;

   2111  5 000047   200005 470500                    LDP0    @P_FOUND_MSGTYP,,AUTO
         5 000050   040100 100400                    MLR     fill='040'O
         5 000051   000005 200010 3                  ADSC9   KEY                      cn=1,n=8
         5 000052   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

      102     2112
      103     2113    1           IF P_TYPE = 1 /* TYPE_E */ AND

   2113  5 000053   200004 471500                    LDP1    @P_TYPE,,AUTO
         5 000054   100000 235100                    LDA     0,,PR1
         5 000055   000001 115007                    CMPA    1,DL
         5 000056   000152 601000 5                  TNZ     s:2147
         5 000057   000031 473400 xsym               LDP3    QT_GLOBAL+25
         5 000060   300023 236100                    LDQ     19,,PR3
         5 000061   777000 316007                    CANQ    -512,DL
         5 000062   000152 600000 5                  TZE     s:2147

      104     2114    1               QT$ENTRY.SET_COUNT > 0 THEN
      105     2115    2             DO;

      106     2116    2               KEY.SUFFIX = '_S';

   2116  5 000063   000003 236000 4                  LDQ     CODE_SL+3
         5 000064   000011 772000                    QRL     9
         5 000065   000007 552030 3                  STBQ    KEY+2,'30'O

      107     2117
      108     2118    2   READ_SETTEXT:
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:26   
      109     2119    2               FPT_READ_KEY.BUF_.BUF$ = QT_GLOBAL.QT$SETTEXT$;

   2119  5 000066   000032 236000 xsym  READ_SETTEXT LDQ     QT_GLOBAL+26
         5 000067   000015 756000 3                  STQ     FPT_READ_KEY+5

      110     2120    2               FPT_READ_KEY.BUF_.BOUND = QT_GLOBAL.QT$SETTEXT_SIZE - 1;

   2120  5 000070   000037 236000 xsym               LDQ     QT_GLOBAL+31
         5 000071   000001 136007                    SBLQ    1,DL
         5 000072   000020 736000                    QLS     16
         5 000073   000014 676000 3                  ERQ     FPT_READ_KEY+4
         5 000074   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000075   000014 656000 3                  ERSQ    FPT_READ_KEY+4

      111     2121
      112     2122    2               CALL M$READ(FPT_READ_KEY) ALTRET(READ_SETTEXT_ERR);

   2122  5 000076   000010 630400 3                  EPPR0   FPT_READ_KEY
         5 000077   440000 713400                    CLIMB   alt,read
         5 000100   401400 401760                    pmme    nvectors=4
         5 000101   000103 702000 5                  TSX2    READ_SETTEXT_ERR

      113     2123
      114     2124    3               DO WHILE('0'B);

   2124  5 000102   000152 710000 5                  TRA     s:2147

      115     2125
      116     2126    3   READ_SETTEXT_ERR:
      117     2127    3                 IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 7 /* E$LD */ THEN

   2127  5 000103   000000 470400 xsym  READ_SETTEX* LDP0    B$TCB$
         5 000104   000000 471500                    LDP1    0,,PR0
         5 000105   100102 236100                    LDQ     66,,PR1
         5 000106   377770 376007                    ANQ     131064,DL
         5 000107   000070 116007                    CMPQ    56,DL
         5 000110   000116 601000 5                  TNZ     s:2133
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:27   

      118     2128    4                   DO;

      119     2129    4                    CALL QTC$GETMEM(QT_GLOBAL.QT$SETTEXT$, QT_GLOBAL.QT$SETTEXT_SIZE);

   2129  5 000111   000001 630400 6                  EPPR0   1
         5 000112   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000113   000000 701000 xent               TSX1    QTC$GETMEM
         5 000114   000000 011000                    NOP     0

      120     2130    4                     GOTO READ_SETTEXT;

   2130  5 000115   000066 710000 5                  TRA     READ_SETTEXT

      121     2131    4                   END;
      122     2132
      123     2133    3                 IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 66 /* E$NOKEY */ THEN

   2133  5 000116   001020 116007                    CMPQ    528,DL
         5 000117   000121 600000 5                  TZE     s:2138

      124     2134    4                   DO;

      125     2135    4                     GOTO MON_ERR;

   2135  5 000120   000154 710000 5                  TRA     MON_ERR

      126     2136    4                   END;
      127     2137
      128     2138    3                 QT$ENTRY.FLAGS.DCBS_SET = '0'B;

   2138  5 000121   000031 473400 xsym               LDP3    QT_GLOBAL+25
         5 000122   000031 236000 xsym               LDQ     B_VECTNIL+25
         5 000123   300000 356100                    ANSQ    0,,PR3

      129     2139    3                 QT$ENTRY.SET_COUNT = 0;

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:28   
   2139  5 000124   000031 470400 xsym               LDP0    QT_GLOBAL+25
         5 000125   000000 236003                    LDQ     0,DU
         5 000126   000023 552110                    STBQ    19,'10'O,PR0

      130     2140    3                 QT_CMDBLK.MINOR_ERR = CODE_SL;

   2140  5 000127   000000 236000 4                  LDQ     CODE_SL
         5 000130   000001 756000 xsym               STQ     QT_CMDBLK+1

      131     2141    3                 TEXTC_MSGTYP.NAME# = KEY.MSGTYP;

   2141  5 000131   040000 100400                    MLR     fill='040'O
         5 000132   000005 200010 3                  ADSC9   KEY                      cn=1,n=8
         5 000133   000002 200010 3                  ADSC9   TEXTC_MSGTYP             cn=1,n=8

      132     2142    3                 CALL XUR$ERRMSG(CODE_SL, , , VECTOR(TEXTC_MSGTYP));

   2142  5 000134   000006 236000 6                  LDQ     6
         5 000135   000001 235000 xsym               LDA     B_VECTNIL+1
         5 000136   200014 757100                    STAQ    POS+6,,AUTO
         5 000137   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 000140   000007 235000 6                  LDA     7
         5 000141   200012 757100                    STAQ    POS+4,,AUTO
         5 000142   200012 630500                    EPPR0   POS+4,,AUTO
         5 000143   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 000144   000000 701000 xent               TSX1    XUR$ERRMSG
         5 000145   000000 011000                    NOP     0

      133     2143    3                 CALL QTC$WRITE_TRADER(KEY.MSGTYP, 1 /* TYPE_E */);

   2143  5 000146   000010 630400 6                  EPPR0   8
         5 000147   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000150   000000 701000 xent               TSX1    QTC$WRITE_TRADER
         5 000151   000000 011000                    NOP     0

      134     2144    3               END /* NEVER */;

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:29   
      135     2145    2             END;

      136     2146
      137     2147    1           RETURN;

   2147  5 000152   000000 702200 xent               TSX2  ! X66_ARET

      138     2148
      139     2149    1   ALT:
      140     2150    1           ALTRETURN;

   2150  5 000153   000000 702200 xent  ALT          TSX2  ! X66_AALT

      141     2151
      142     2152    1   MON_ERR:
      143     2153    1           CALL QTC$MON_ERR('1'B);

   2153  5 000154   000012 630400 6     MON_ERR      EPPR0   10
         5 000155   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000156   000000 701000 xent               TSX1    QTC$MON_ERR
         5 000157   000000 011000                    NOP     0
         5 000160   000334 710000 5                  TRA     s:2287

      144     2154                %PAGE(ARG="READ_SEQ", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:30   
              2171    1   /***************************************************************************
              2172    1    *                                                                         *
              2173    1    *                                  READ_SEQ                               *
              2174    1    *                                                                         *
              2175    1    ***************************************************************************/

      145     2179    1   READ_SEQ:

   2179  5 000161   200010 741300       READ_SEQ     STX1  ! POS+2,,AUTO

      146     2180    1           PROC ALTRET;
      147     2181
      148     2182    3           DO WHILE('1'B);

      149     2183    3             FPT_READ_SEQ.BUF_.BUF$ = QT_GLOBAL.QT$ENTRY$;

   2183  5 000162   000031 236000 xsym               LDQ     QT_GLOBAL+25
         5 000163   000033 756000 3                  STQ     FPT_READ_SEQ+5

      150     2184    3             FPT_READ_SEQ.BUF_.BOUND = QT_GLOBAL.QT$ENTRY_SIZE - 1;

   2184  5 000164   000036 236000 xsym               LDQ     QT_GLOBAL+30
         5 000165   000001 136007                    SBLQ    1,DL
         5 000166   000020 736000                    QLS     16
         5 000167   000032 676000 3                  ERQ     FPT_READ_SEQ+4
         5 000170   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000171   000032 656000 3                  ERSQ    FPT_READ_SEQ+4

      151     2185    3             CALL M$READ(FPT_READ_SEQ) ALTRET(READ_SEQ_ERR);

   2185  5 000172   000026 630400 3                  EPPR0   FPT_READ_SEQ
         5 000173   440000 713400                    CLIMB   alt,read
         5 000174   401400 401760                    pmme    nvectors=4
         5 000175   000177 702000 5                  TSX2    READ_SEQ_ERR

      152     2186
      153     2187    4             DO WHILE('0'B);
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:31   

   2187  5 000176   000231 710000 5                  TRA     s:2206

      154     2188
      155     2189    4   READ_SEQ_ERR:
      156     2190    4               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 6 /* E$EOF */ THEN

   2190  5 000177   000000 470400 xsym  READ_SEQ_ERR LDP0    B$TCB$
         5 000200   000000 471500                    LDP1    0,,PR0
         5 000201   100102 236100                    LDQ     66,,PR1
         5 000202   377770 376007                    ANQ     131064,DL
         5 000203   000060 116007                    CMPQ    48,DL
         5 000204   000206 601000 5                  TNZ     s:2195

      157     2191    5                 DO;

      158     2192    5                   GOTO ALT;

   2192  5 000205   000251 710000 5                  TRA     ALT

      159     2193    5                 END;
      160     2194
      161     2195    4               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 7 /* E$LD */ THEN

   2195  5 000206   000070 116007                    CMPQ    56,DL
         5 000207   000211 600000 5                  TZE     s:2200

      162     2196    5                 DO;

      163     2197    5                   GOTO MON_ERR;

   2197  5 000210   000253 710000 5                  TRA     MON_ERR

      164     2198    5                 END;
      165     2199
      166     2200    4               CALL QTC$GETMEM(QT_GLOBAL.QT$ENTRY$, QT_GLOBAL.QT$ENTRY_SIZE);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:32   
   2200  5 000211   000013 630400 6                  EPPR0   11
         5 000212   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000213   000000 701000 xent               TSX1    QTC$GETMEM
         5 000214   000000 011000                    NOP     0

      167     2201    4               FPT_READ_KEY.BUF_.BUF$ = QT_GLOBAL.QT$ENTRY$;

   2201  5 000215   000031 236000 xsym               LDQ     QT_GLOBAL+25
         5 000216   000015 756000 3                  STQ     FPT_READ_KEY+5

      168     2202    4               FPT_READ_KEY.BUF_.BOUND = QT_GLOBAL.QT$ENTRY_SIZE - 1;

   2202  5 000217   000036 236000 xsym               LDQ     QT_GLOBAL+30
         5 000220   000001 136007                    SBLQ    1,DL
         5 000221   000020 736000                    QLS     16
         5 000222   000014 676000 3                  ERQ     FPT_READ_KEY+4
         5 000223   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000224   000014 656000 3                  ERSQ    FPT_READ_KEY+4

      169     2203    4               CALL M$READ(FPT_READ_KEY) ALTRET(READ_SEQ_ERR);

   2203  5 000225   000010 630400 3                  EPPR0   FPT_READ_KEY
         5 000226   440000 713400                    CLIMB   alt,read
         5 000227   401400 401760                    pmme    nvectors=4
         5 000230   000177 702000 5                  TSX2    READ_SEQ_ERR

      170     2204    4             END /* NEVER */;

      171     2205
      172     2206    3             IF KEY.SUFFIX ~= SUFFIX THEN

   2206  5 000231   040000 106400                    CMPC    fill='040'O
         5 000232   000007 200002 3                  ADSC9   KEY+2                    cn=1,n=2
         5 000233   000001 000002 3                  ADSC9   SUFFIX                   cn=0,n=2
         5 000234   000236 600000 5                  TZE     s:2211

      173     2207    4               DO;
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:33   

      174     2208    4                 GOTO LOOP;

   2208  5 000235   000246 710000 5                  TRA     LOOP

      175     2209    4               END;
      176     2210
      177     2211    3             CALL QQC$WILD_COMP(P_MSGTYP, KEY.MSGTYP) ALTRET(LOOP);

   2211  5 000236   000010 236000 6                  LDQ     8
         5 000237   200003 235100                    LDA     @P_MSGTYP,,AUTO
         5 000240   200012 757100                    STAQ    POS+4,,AUTO
         5 000241   200012 630500                    EPPR0   POS+4,,AUTO
         5 000242   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000243   000000 701000 xent               TSX1    QQC$WILD_COMP
         5 000244   000246 702000 5                  TSX2    LOOP

      178     2212    3             GOTO RET;

   2212  5 000245   000247 710000 5                  TRA     RET

      179     2213
      180     2214    3   LOOP:
      181     2215    3           END /* WHILE */;

   2215  5 000246   000162 710000 5     LOOP         TRA     s:2183

      182     2216
      183     2217    2   RET:
      184     2218    2           RETURN;

   2218  5 000247   200010 221300       RET          LDX1  ! POS+2,,AUTO
         5 000250   000001 702211                    TSX2  ! 1,X1

      185     2219
      186     2220    2   ALT:
      187     2221    2           ALTRETURN;
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:34   

   2221  5 000251   200010 221300       ALT          LDX1  ! POS+2,,AUTO
         5 000252   000000 702211                    TSX2  ! 0,X1

      188     2222
      189     2223    2   MON_ERR:
      190     2224    2           CALL QTC$MON_ERR('1'B);

   2224  5 000253   000012 630400 6     MON_ERR      EPPR0   10
         5 000254   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000255   000000 701000 xent               TSX1    QTC$MON_ERR
         5 000256   000000 011000                    NOP     0

      191     2225
      192     2226    2   END READ_SEQ;

   2226  5 000257   200010 221300                    LDX1  ! POS+2,,AUTO
         5 000260   000001 702211                    TSX2  ! 1,X1

      193     2227                %PAGE(ARG="READ_KEY", PAGE=YES);

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:35   
              2244    2   /***************************************************************************
              2245    2    *                                                                         *
              2246    2    *                                  READ_KEY                               *
              2247    2    *                                                                         *
              2248    2    ***************************************************************************/

      194     2252    1   READ_KEY:

   2252  5 000261   200010 741300       READ_KEY     STX1  ! POS+2,,AUTO

      195     2253    1           PROC ALTRET;
      196     2254
      197     2255    2           KEY.MSGTYP = P_MSGTYP;

   2255  5 000262   200003 470500                    LDP0    @P_MSGTYP,,AUTO
         5 000263   040000 100500                    MLR     fill='040'O
         5 000264   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000265   000005 200010 3                  ADSC9   KEY                      cn=1,n=8

      198     2256    2           KEY.SUFFIX = SUFFIX;

   2256  5 000266   000001 236000 3                  LDQ     SUFFIX
         5 000267   000011 772000                    QRL     9
         5 000270   000007 552030 3                  STBQ    KEY+2,'30'O

      199     2257
      200     2258    2   READ:
      201     2259    2           FPT_READ_KEY.BUF_.BUF$ = QT_GLOBAL.QT$ENTRY$;

   2259  5 000271   000031 236000 xsym  READ         LDQ     QT_GLOBAL+25
         5 000272   000015 756000 3                  STQ     FPT_READ_KEY+5

      202     2260    2           FPT_READ_KEY.BUF_.BOUND = QT_GLOBAL.QT$ENTRY_SIZE - 1;

   2260  5 000273   000036 236000 xsym               LDQ     QT_GLOBAL+30
         5 000274   000001 136007                    SBLQ    1,DL
         5 000275   000020 736000                    QLS     16
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:36   
         5 000276   000014 676000 3                  ERQ     FPT_READ_KEY+4
         5 000277   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000300   000014 656000 3                  ERSQ    FPT_READ_KEY+4

      203     2261
      204     2262    2           CALL M$READ(FPT_READ_KEY) ALTRET(READ_KEY_ERR);

   2262  5 000301   000010 630400 3                  EPPR0   FPT_READ_KEY
         5 000302   440000 713400                    CLIMB   alt,read
         5 000303   401400 401760                    pmme    nvectors=4
         5 000304   000306 702000 5                  TSX2    READ_KEY_ERR

      205     2263
      206     2264    3           DO WHILE('0'B);

   2264  5 000305   000330 710000 5                  TRA     s:2281

      207     2265
      208     2266    3   READ_KEY_ERR:
      209     2267    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 7 /* E$LD */ THEN

   2267  5 000306   000000 470400 xsym  READ_KEY_ERR LDP0    B$TCB$
         5 000307   000000 471500                    LDP1    0,,PR0
         5 000310   100102 236100                    LDQ     66,,PR1
         5 000311   377770 376007                    ANQ     131064,DL
         5 000312   000070 116007                    CMPQ    56,DL
         5 000313   000321 601000 5                  TNZ     s:2273

      210     2268    4               DO;

      211     2269    4                 CALL QTC$GETMEM(QT_GLOBAL.QT$ENTRY$, QT_GLOBAL.QT$ENTRY_SIZE);

   2269  5 000314   000013 630400 6                  EPPR0   11
         5 000315   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000316   000000 701000 xent               TSX1    QTC$GETMEM
         5 000317   000000 011000                    NOP     0

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:37   
      212     2270    4                 GOTO READ;

   2270  5 000320   000271 710000 5                  TRA     READ

      213     2271    4               END;
      214     2272
      215     2273    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 66 /* E$NOKEY */ THEN

   2273  5 000321   001020 116007                    CMPQ    528,DL
         5 000322   000324 601000 5                  TNZ     s:2278

      216     2274    4               DO;

      217     2275    4                 GOTO ALT;

   2275  5 000323   000332 710000 5                  TRA     ALT

      218     2276    4               END;
      219     2277
      220     2278    3             CALL QTC$MON_ERR('1'B);

   2278  5 000324   000012 630400 6                  EPPR0   10
         5 000325   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000326   000000 701000 xent               TSX1    QTC$MON_ERR
         5 000327   000000 011000                    NOP     0

      221     2279    3           END /* NEVER */;

      222     2280
      223     2281    2           RETURN;

   2281  5 000330   200010 221300                    LDX1  ! POS+2,,AUTO
         5 000331   000001 702211                    TSX2  ! 1,X1

      224     2282
      225     2283    2   ALT:
      226     2284    2           ALTRETURN;
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:38   

   2284  5 000332   200010 221300       ALT          LDX1  ! POS+2,,AUTO
         5 000333   000000 702211                    TSX2  ! 0,X1

      227     2285
      228     2286    2   END READ_KEY;
      229     2287    1   END QTC$READ_TRADER;

   2287  5 000334   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:39   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QT_PERR_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTC$READ_TRADER.
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:40   

 **** Variables and constants ****

  ****  Section 003  Data  QTC$READ_TRADER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    44-0-0/d STRC(144)   r     1 FPT_PFIL                  10-0-0/d STRC(504)   r     1 FPT_READ_KEY
    26-0-0/d STRC(504)   r     1 FPT_READ_SEQ               5-0-0/c STRC(99)    r     1 KEY
     1-0-0/c CHAR(2)     r     1 SUFFIX                     2-0-0/c STRC(81)    r     1 TEXTC_MSGTYP
     0-0-0/w BIT         r     1 WILD_FLAG

  ****  Section 004 RoData QTC$READ_TRADER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 CODE_SL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @P_FOUND_MSGTYP            3-0-0/w PTR         r     1 @P_MSGTYP
     4-0-0/w PTR         r     1 @P_TYPE                    6-0-0/w UBIN        r     1 POS
    *0-0-0/c CHAR(8)     r     1 P_FOUND_MSGTYP            *0-0-0/c CHAR(8)     r     1 P_MSGTYP
    *0-0-0/w UBIN        r     1 P_TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(261)   r     1 QT_CMDBLK
     0-0-0/w STRC(1872)  r     1 QT_GLOBAL

PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:41   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 M$TRADER                   0-0-0N  NULL        r     1 M$TRADER_SEQ
     0-0-0/w STRC(936)   r     1 QT$ENTRY


   Procedure QTC$READ_TRADER requires 221 words for executable code.
   Procedure QTC$READ_TRADER requires 14 words of local(AUTO) storage.

    No errors detected in file QTC$READ_TRADER.:E05TSI    .
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:42   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:43   
          MINI XREF LISTING

ALT
      2150**LABEL    2079--GOTO     2104--CALLALT  2108--CALLALT
ALT IN PROCEDURE READ_KEY
      2284**LABEL    2275--GOTO
ALT IN PROCEDURE READ_SEQ
      2221**LABEL    2192--GOTO
B$ALT.CODE
      1748**DCL      1748--REDEF    1749--REDEF    1749--REDEF
B$ALT.ERR.CODE
      1750**DCL      2127>>IF       2133>>IF       2190>>IF       2195>>IF       2267>>IF       2273>>IF
B$ALT.ERR.ERR#
      1750**DCL      1750--REDEF
B$ALT.EVID
      1749**DCL      1749--REDEF    1749--REDEF
B$TCB.ALT$
      1744**DCL      2127>>IF       2133>>IF       2190>>IF       2195>>IF       2267>>IF       2273>>IF
B$TCB$
      1690**DCL      2127>>IF       2133>>IF       2190>>IF       2195>>IF       2267>>IF       2273>>IF
CODE_SL
      1920**DCL      2140>>ASSIGN   2142<>CALL
FPT_PFIL
      2048**DCL      2099<>CALL
FPT_PFIL.V
      2048**DCL      2048--DCLINIT
FPT_READ_KEY
      1974**DCL      2122<>CALL     2203<>CALL     2262<>CALL
FPT_READ_KEY.BUF_.BOUND
      1976**DCL      2120<<ASSIGN   2202<<ASSIGN   2260<<ASSIGN
FPT_READ_KEY.BUF_.BUF$
      1977**DCL      2119<<ASSIGN   2201<<ASSIGN   2259<<ASSIGN
FPT_READ_KEY.STATION_
      1977**DCL      1978--REDEF
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:44   
FPT_READ_KEY.V
      1978**DCL      1974--DCLINIT
FPT_READ_KEY.V.DVBYTE.REREAD#
      1989**DCL      1989--REDEF
FPT_READ_KEY.V.INDX#
      1987**DCL      1987--REDEF
FPT_READ_SEQ
      2014**DCL      2185<>CALL
FPT_READ_SEQ.BUF_.BOUND
      2016**DCL      2184<<ASSIGN
FPT_READ_SEQ.BUF_.BUF$
      2017**DCL      2183<<ASSIGN
FPT_READ_SEQ.STATION_
      2017**DCL      2018--REDEF
FPT_READ_SEQ.V
      2018**DCL      2014--DCLINIT
FPT_READ_SEQ.V.DVBYTE.REREAD#
      2029**DCL      2029--REDEF
FPT_READ_SEQ.V.INDX#
      2027**DCL      2027--REDEF
KEY
      1864**DCL      1974--DCLINIT  1975--DCLINIT  2014--DCLINIT  2015--DCLINIT
KEY.MSGTYP
      1866**DCL      2111>>ASSIGN   2141>>ASSIGN   2143<>CALL     2211<>CALL     2255<<ASSIGN
KEY.SUFFIX
      1867**DCL      2116<<ASSIGN   2206>>IF       2256<<ASSIGN
LOOP IN PROCEDURE READ_SEQ
      2215**LABEL    2208--GOTO     2211--CALLALT
M$PFIL
       410**DCL-ENT  2099--CALL
M$READ
       409**DCL-ENT  2122--CALL     2185--CALL     2203--CALL     2262--CALL
MON_ERR
      2153**LABEL    2099--CALLALT  2135--GOTO
MON_ERR IN PROCEDURE READ_SEQ
      2224**LABEL    2197--GOTO
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:45   
NO_Q
      2102**LABEL    2096--CALLALT
POS
      1893**DCL      2096<<CALLBLT
P_FOUND_MSGTYP
      1634**DCL         8--PROC     2111<<ASSIGN
P_MSGTYP
      1632**DCL         8--PROC     2096>>CALLBLT  2211<>CALL     2255>>ASSIGN
P_TYPE
      1633**DCL         8--PROC     2086>>IF       2113>>IF
QQC$WILD_COMP
      1660**DCL-ENT  2211--CALL
QT$ENTRY.FLAGS.DCBS_SET
      1768**DCL      2138<<ASSIGN
QT$ENTRY.SET_COUNT
      1801**DCL      2113>>IF       2139<<ASSIGN
QTC$GETMEM
      1662**DCL-ENT  2129--CALL     2200--CALL     2269--CALL
QTC$MON_ERR
      1661**DCL-ENT  2153--CALL     2224--CALL     2278--CALL
QTC$WRITE_TRADER
      1664**DCL-ENT  2143--CALL
QT_CMDBLK.MINOR_ERR
        80**DCL      2140<<ASSIGN
QT_CMDBLK.OUT$
        80**DCL        81--REDEF
QT_GLOBAL.FIRST_READ
        77**DCL      2077>>IF       2082>>IF       2084<<ASSIGN
QT_GLOBAL.QT$ENTRY$
        78**DCL      1765--IMP-PTR  2113>>IF       2138>>ASSIGN   2139>>ASSIGN   2183>>ASSIGN   2200<>CALL
      2201>>ASSIGN   2259>>ASSIGN   2269<>CALL
QT_GLOBAL.QT$ENTRY_SIZE
        79**DCL      2184>>ASSIGN   2200<>CALL     2202>>ASSIGN   2260>>ASSIGN   2269<>CALL
QT_GLOBAL.QT$SETTEXT$
        78**DCL      2119>>ASSIGN   2129<>CALL
QT_GLOBAL.QT$SETTEXT_SIZE
PL6.E3A0      #001=QTC$READ_TRADER File=QTC$READ_TRADER.:E05TSI                  WED 07/30/97 05:51 Page:46   
        79**DCL      2120>>ASSIGN   2129<>CALL
READ IN PROCEDURE READ_KEY
      2259**LABEL    2270--GOTO
READ_KEY
      2253**PROC     2108--CALL
READ_KEY_ERR IN PROCEDURE READ_KEY
      2267**LABEL    2262--CALLALT
READ_SEQ
      2180**PROC     2104--CALL
READ_SEQ_ERR IN PROCEDURE READ_SEQ
      2190**LABEL    2185--CALLALT  2203--CALLALT
READ_SETTEXT
      2119**LABEL    2130--GOTO
READ_SETTEXT_ERR
      2127**LABEL    2122--CALLALT
RET IN PROCEDURE READ_SEQ
      2218**LABEL    2212--GOTO
SUFFIX
      1835**DCL      2088<<ASSIGN   2092<<ASSIGN   2206>>IF       2256>>ASSIGN
TEXTC_MSGTYP
      1862**DCL      2142--CALL
TEXTC_MSGTYP.NAME#
      1862**DCL      2141<<ASSIGN
WILD_FLAG
      1833**DCL      2077>>IF       2095<<ASSIGN   2097<<ASSIGN   2102>>IF
XUR$ERRMSG
      1663**DCL-ENT  2142--CALL
