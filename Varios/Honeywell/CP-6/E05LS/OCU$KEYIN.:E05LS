VERSION E05

PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:1    
        1        1        /*M* OCU$KEYIN  coordinate I/O between users and operators' consoles */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* */
        8        8        /*P*  NAME: OCU$KEYIN
        9        9              PURPOSE: To coordinate I/O between users and
       10       10                       operators' consoles.
       11       11                                                                  */
       12       12        /*M* OCU$PMME - Process the M$KEYIN PMME  */
       13       13        /*X* */
       14       14        /*F* NAME: OCU$PMME
       15       15             PURPOSE: To process the M$KEYIN PMME
       16       16             DESCRIPTION: I/O between the user and operators' consoles is
       17       17                          performed via dcb#7 through the Central System
       18       18                          COMGROUP.  In the case of a write, a message
       19       19                          header is appended to the front of the message
       20       20                          with a canned message number specified and the
       21       21                          write is performed wait or not as indicated in the
       22       22                          fpt.  The requested operation being a read implies
       23       23                          that a message is written with wait specified
       24       24                          informing KEYIN of a pending read, after which the
       25       25                          read itself is performed with wait or not as requested
       26       26                          in the fpt.  If the operation is a keyin, the message
       27       27                          setup is similar to the message setup for a write,
       28       28                          with the exception that 'keyin' is the requested
       29       29                          operation and the message is written with wait.  The
       30       30                          following read is then done as it is for a simple read.
       31       31             INTERFACE: KCI$RWCGS, HFF$DSIZ, HGG$NILERASE, UDB$PMMEXIT
       32       32                                                                                     */
       33       33        OCU$PMME: PROC ALTRET;
       34       34          %INCLUDE CP_6_SUBS;
       35      574          %INCLUDE F$CP6V_C;
       36      800        %INCLUDE KC$CP6V_C;
       37      920          %INCLUDE F_FPTCODE_C;
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:2    
       38      956          %INCLUDE F_ERRORS_C;
       39     1196        %INCLUDE KI_ERRORS_C;
       40     1281          %INCLUDE F$JIT_C;
       41     1711          %INCLUDE B$ROSEG;
       42     1774          %INCLUDE NK$LDCT;
       43     1876            %NK$LDCT;
       44     1922          %INCLUDE NK_LDCT_R;
       45     1931          %INCLUDE B$TABLES_C;
       46     2039            %B$XL_UR;
       47     2043          %INCLUDE OC$MESSHD_C;
       48     2064          %INCLUDE OC_MESSHD_C;
       49     2117          %INCLUDE OC_SUBS_C;
       50     2848          %INCLUDE OCU_DATA_R;
       51     2859             %INCLUDE OCI_DATA_R;
       52     2871          %INCLUDE F$DCB;
       53     2920        %VLP$STATION_V (FPTN=VSTA);
       54     2932        %VLP$SETSTA_V (FPTN=VSETSTA);
       55     2944            %FPT$KEYIN_V;
       56     2948            %OC_MESSHD_W (NAME=CMHD,STCLASS=CONSTANT,MSG=WR_MSG#,NPARMS=5);
       57     2961    1         2 LEN (0:4) UBIN BYTE UNAL INIT (LENGTHC(OC_MESSHD.READID),
       58     2962    1           LENGTHC(OC_MESSHD.SZR),
       59     2963    1           LENGTHC(OC_MESSHD.ACCN),
       60     2964    1           LENGTHC(OC_MESSHD.UNAME),
       61     2965    1           0);
       62     2966                %OC$MESSHD (NAME=OC_MESSHD,STCLASS="");
       63     2980    1         2 LEN (0:4) UBIN BYTE UNAL,
       64     2981    1         2 READID UBIN HALF UNAL,
       65     2982    1         2 SZR UBIN BYTE UNAL,
       66     2983    1         2 ACCN CHAR(8) UNAL,
       67     2984    1         2 UNAME CHAR(12) UNAL,
       68     2985    1         2 MESS CHAR(92) CALIGNED;
       69     2986        /*
       70     2987                    DCLS
       71     2988                                         */
       72     2989    1   DCL FCN UBIN WORD;
       73     2990    1   DCL SIZE UBIN WORD;
       74     2991    1   DCL SZR UBIN WORD;
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:3    
       75     2992    1   DCL DCB$ PTR;
       76     2993    1   DCL UDCB$ PTR;
       77     2994    1   DCL 1 RESULTS BASED,
       78     2995    1         2 TYC BIT(36),
       79     2996    1         2 ARS SBIN WORD;
       80     2997    1   DCL STRING CHAR(SIZE) BASED;
       81     2998    1   DCL B$PS0$ PTR SYMREF;
       82     2999    1   DCL B$PS1$ PTR SYMREF;
       83     3000    1   DCL B$PS2$ PTR SYMREF;
       84     3001    1   DCL B$PS3$ PTR SYMREF;
       85     3002    1   DCL B$JIT$ PTR SYMREF;
       86     3003    1   DCL B$ROSEG$ PTR SYMREF;
       87     3004        /**/
       88     3005    1   DCL FMF$TYC ENTRY(2);
       89     3006    1   DCL KCI$RWCGS ENTRY(4) ALTRET;
       90     3007    1   DCL HFF$DSIZ ENTRY(2) ALTRET;
       91     3008    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
       92     3009    1   DCL NKA$EVENT ENTRY(2);
       93     3010    1   DCL OCU$GETMOC ENTRY ALTRET;
       94     3011    1   DCL UDB$PMMEXIT ENTRY;
       95     3012        /*I* NAME: ERROR
       96     3013             PURPOSE: To record an error in JIT.ERR
       97     3014             CALL: CALL ERROR (CODE);
       98     3015             DESCRIPTION: JIT.ERR.FCG and JIT.ERR.MID are
       99     3016                          set to indicate 'OCU', JIT.ERR.CODE is
      100     3017                          set to CODE, and the PMME is exited
      101     3018                                                                        */
      102     3019    1   ERROR:  PROC (CODE);
      103     3020    2   DCL CODE UBIN WORD;
      104     3021                                                /**/
      105     3022    2           B$JIT.ERR = OCU_ERR;
      106     3023    2           B$JIT.ERR.CODE = CODE;
      107     3024        /**/
      108     3025    2   ERROR0: ENTRY;
      109     3026        /**/
      110     3027    2           IF B$PS0$ -> FPT$KEYIN_V.WAIT THEN
      111     3028    3           DO;
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:4    
      112     3029    3              CALL HFF$NILERASE (3) ALTRET (EOUT);
      113     3030    3              B$PS3$ -> RESULTS.TYC = DCB$ -> F$DCB.TYC(DCB$->F$DCB.WAIT);
      114     3031    3              B$PS3$ -> RESULTS.ARS = DCB$ -> F$DCB.ARS; /* set ARS              */
      115     3032    3   EOUT:      ;
      116     3033    3              IF B$JIT.ERR.CODE=0 AND DCB$->F$DCB.TYC(DCB$->F$DCB.WAIT)
      117     3034    3                &(~%TYC_EGV) THEN
      118     3035    3                 CALL FMF$TYC(DCB$->F$DCB.TYC(DCB$->F$DCB.WAIT),B$JIT.ERR);
      119     3036    3              END;
      120     3037        /**/
      121     3038    2           CALL UDB$PMMEXIT;
      122     3039    2   END ERROR;
      123     3040        /*
      124     3041                        Begin main
      125     3042                                               */
      126     3043                                      /* Prevent pre-CSCG users from doing M$KEYIN    */
      127     3044    1           IF OCI_BOOT
      128     3045    1           THEN
      129     3046    1              CALL UDB$PMMEXIT;
      130     3047                                                /**/
      131     3048                                      /* If nowait was specified with
      132     3049                                         a results field (which is an
      133     3050                                         illegal combination), then
      134     3051                                         altreturn. */
      135     3052                                                /**/
      136     3053                                                /**/
      137     3054    1           IF B$PS0$ -> FPT$KEYIN_V.WAIT = '0'B
      138     3055    1           THEN
      139     3056    2           DO;
      140     3057    2              CALL HFF$NILERASE (3) ALTRET (CONTINUE);
      141     3058    2              CALL ERROR (%E$NWRESULT);
      142     3059    2              END;
      143     3060                                                /**/
      144     3061    1   CONTINUE:;
      145     3062                                                /**/
      146     3063    1           DCB$=DCBADDR(%M$UC#);           /* IN CASE NO_GO CALLS ERROR          */
      147     3064    1           CALL OCU$GETMOC ALTRET (NO_GO);
      148     3065    1           DCB$ = DCBADDR (%M$OC#);
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:5    
      149     3066    1           DCB$->F$DCB.LASTSTA$->VSTA.STATION='KEYIN';
      150     3067                          /*    Set WAS since some ghosts
      151     3068                           *    use this PMME before KEYIN
      152     3069                           *    comes alive, and we want
      153     3070                           *    him to get the message,
      154     3071                           *    now don't we?
      155     3072                           */
      156     3073    1           DCB$->F$DCB.SETSTA$->VSETSTA.OSTA.WAS='1'B;
      157     3074    1           DCB$ -> F$DCB.UB$ = ADDR (OC_MESSHD);
      158     3075    1           OC_MESSHD=CMHD;                 /* SET INITIAL VALUES                 */
      159     3076    1           OC_MESSHD.ACCN = B$JIT.ACCN; /* save account for message on console   */
      160     3077    1           OC_MESSHD.SYSID = B$JIT.SYSID;
      161     3078    1           OC_MESSHD.UNAME=B$JIT.UNAME;
      162     3079    1           FCN = 0;
      163     3080    1           CALL HFF$DSIZ (B$PS1$, SIZE) ALTRET (NO_WRITE); /* get size of buffer */
      164     3081    1           FCN=1;
      165     3082    1           IF SIZE > SIZEC (OC_MESSHD.MESS)
      166     3083    1           THEN
      167     3084    2           DO;
      168     3085    2              SIZE = SIZEC (OC_MESSHD.MESS);
      169     3086    2              END;
      170     3087    1           OC_MESSHD.LEN(4) = SIZE;
      171     3088    1           CALL XLATE (OC_MESSHD.MESS,B$XL_UR,B$PS1$->STRING);
      172     3089    1   NO_WRITE:
      173     3090    1           CALL HFF$DSIZ (B$PS2$,SZR) ALTRET (NO_READ);
      174     3091    1           IF SZR = 0
      175     3092    1           THEN
      176     3093    2           DO;
      177     3094    2              GOTO NO_READ;
      178     3095    2              END;
      179     3096                                                /**/
      180     3097    1           IF SZR <= 120
      181     3098    1           THEN
      182     3099    2           DO;
      183     3100    2              OC_MESSHD.SZR = SZR;
      184     3101    2              END;
      185     3102    1           ELSE
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:6    
      186     3103    2           DO;
      187     3104    2              OC_MESSHD.SZR = 120;
      188     3105    2              END;
      189     3106                                                /**/
      190     3107    1           FCN = FCN + 2;
      191     3108    1           IF DCB$ -> F$DCB.FCN(0) THEN
      192     3109        /*E* ERROR: OCU-E$TWONWIO-A
      193     3110             MESSAGE: Simultaneous M$KEYIN operations not permitted
      194     3111             DESCRIPTION: The user has issued an M$KEYIN while
      195     3112                          he still has one outstanding
      196     3113                                                                     */
      197     3114    1              CALL ERROR (%E$TWONWIO);
      198     3115    1   NO_READ:
      199     3116    2           IF FCN = 0 THEN DO;
      200     3117        /*E* ERROR: OCU-E$KEYIN-A
      201     3118             MESSAGE: No message or reply buffer specified
      202     3119             DESCRIPTION: The user has executed an M$KEYIN PMME
      203     3120                          with no message or reply buffer
      204     3121                          specified in his fpt
      205     3122                                                                         */
      206     3123    2              B$JIT.ERR = OCU_ERR;
      207     3124    2              CALL UDB$PMMEXIT;
      208     3125    2              END;
      209     3126    1           DCB$ -> F$DCB.UBYTES = SIZE + SIZEC (OC_MESSHD) - SIZEC (OC_MESSHD.MESS);
              3126                    /* header + message */
      210     3127    1           OC_MESSHD.FCN = OCU_FCN (FCN);
      211     3128                                                /**/
      212     3129    1           IF B$PS0$ -> FPT$KEYIN_V.WHO = 0 /* WSN                               */
      213     3130    1           THEN
      214     3131    2           DO;
      215     3132    2              OC_MESSHD.CADDR = OCU_CADDR (B$PS0$ -> FPT$KEYIN_V.OCTYPE);
      216     3133    2              IF OC_MESSHD.CADDR & M_DEVC
      217     3134    2              THEN
      218     3135    3              DO;
      219     3136    3                 OC_MESSHD.WSN = 'XX000000';
      220     3137    3                 END;
      221     3138    2              ELSE
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:7    
      222     3139    3              DO;
      223     3140    3                 OC_MESSHD.WSN = B$PS0$ -> FPT$KEYIN_V.WSN;
      224     3141    3                 IF OC_MESSHD.WSN = ' '
      225     3142    3                 THEN
      226     3143    4                 DO;
      227     3144    4                    OC_MESSHD.WSN = B$JIT.WOO;
      228     3145    4                    END;
      229     3146    3                 END;
      230     3147    2              END;
      231     3148    1           ELSE
      232     3149    1              IF B$PS0$ -> FPT$KEYIN_V.DCB# <= B$ROSEG$ -> B$ROSEG.NUMDCBS THEN
      233     3150    2              DO;
      234     3151    2                 UDCB$ = DCBADDR (B$PS0$ -> FPT$KEYIN_V.DCB#);
      235     3152    2                 IF UDCB$ ~= ADDR (NIL) THEN
      236     3153    2                    IF UDCB$ -> F$DCB.FCD = '1'B THEN /* dcb is open             */
      237     3154    2                       IF UDCB$ -> F$DCB.ASN = 3 THEN /* device                  */
      238     3155    3                       DO;
      239     3156    3                          OC_MESSHD.CADDR = M_DEVC; /* address device console    */
      240     3157    3                          OC_MESSHD.DEVNM = NK$LDCT$ (UDCB$ -> F$DCB.LDCTX) -> NK$LDCT.
              3157                                   DEVNM;
      241     3158    3                          END;
      242     3159    2                       ELSE
      243     3160        /*E* ERROR: OCU-E$NOTDEVICE-A
      244     3161             MESSAGE: DCB for M$KEYIN must be assigned to a device
      245     3162             DESCRIPTION: The user has requested communication with
      246     3163                          a device console but has supplied a non-device
      247     3164                          dcb.                                            */
      248     3165    2                          CALL ERROR (%E$NOTDEVICE);
      249     3166    2                    ELSE
      250     3167        /*E* ERROR: OCU-E$NOTOPEN-A
      251     3168             MESSAGE: DCB in M$KEYIN must be open to device
      252     3169             DESCRIPTION: The user has requested communication with
      253     3170                          a device console but has supplied a
      254     3171                          closed dcb.                            */
      255     3172    2                       CALL ERROR (%E$NOTOPEN);
      256     3173    2                 ELSE
      257     3174        /*E* ERROR: OCU-E$NODCBKI-A
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:8    
      258     3175             MESSAGE: Illegal device DCB number specified for console communication.
      259     3176             DESCRIPTION: The user has requested communication with
      260     3177                          a device console but has supplied an
      261     3178                          illegal dcb number.                           */
      262     3179    2                    CALL ERROR (%E$NODCBKI);
      263     3180    2                 END;
      264     3181    1              ELSE
      265     3182    1                 CALL ERROR (%E$NODCBKI);
      266     3183                                                /**/
      267     3184                                                /**/
      268     3185    1           DCB$->F$DCB.TYC='0'B;
      269     3186    1           DCB$ -> F$DCB.WAIT=BITBIN(B$PS0$->FPT$KEYIN_V.WAIT);
      270     3187    1           IF FCN = 1
      271     3188    1           THEN
      272     3189    2           DO;
      273     3190    2              CALL KCI$RWCGS (MFC_WRITE, 0, 'A', B$PS0$ -> FPT$KEYIN_V.EVENT)
      274     3191    2                ALTRET (NO_GO);
      275     3192    2              END;
      276     3193    1           ELSE                            /* read | keyin                       */
      277     3194    2           DO;
      278     3195    2              CALL KCI$RWCGS (MFC_WRITE, 0, 'A', 0) ALTRET(NO_GO);
      279     3196    2              DCB$->F$DCB.UBYTES=SZR;
      280     3197    2              DCB$ -> F$DCB.UB$ = B$PS2$;
      281     3198    2              CALL KCI$RWCGS (MFC_READ, 0, ' ', B$PS0$->FPT$KEYIN_V.EVENT);
      282     3199                                                /**/
      283     3200    2              IF B$JIT.ERR.CODE = %E$BYDR
      284     3201    2              THEN
      285     3202    3              DO;
      286     3203    3                 OC_MESSHD.FCN=OC_XRD;
      287     3204    3                 OC_MESSHD.MSG#=XRD_MSG#;
      288     3205    3                 DCB$->F$DCB.UB$=ADDR(OC_MESSHD);
      289     3206    3                 DCB$->F$DCB.UBYTES=SIZEC(OC_MESSHD)-SIZEC(OC_MESSHD.MESS);
      290     3207    3                 CALL KCI$RWCGS (MFC_WRITE,0,'A',0);
      291     3208    3                 GOTO OUT;
      292     3209    3                 END;
      293     3210    2              END;
      294     3211        /**/
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:9    
      295     3212    1   NO_GO:  ;
      296     3213    1           CALL ERROR0;                    /* Set results and JIT.ERR            */
      297     3214        /**/
      298     3215    1   OUT:    ;
      299     3216    1           CALL UDB$PMMEXIT;
      300     3217        /**/
      301     3218    1   END OCU$PMME;
      302     3219        %EOD;

PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:10   
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   OCI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure OCU$PMME.

   Procedure OCU$PMME requires 322 words for executable code.
   Procedure OCU$PMME requires 50 words of local(AUTO) storage.

PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:11   

 Object Unit name= OCU$PMME                                   File name= OCU$KEYIN.:E05TOU
 UTS= JUL 30 '97 04:07:43.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     11     13  OCU$PMME
    1   Proc  even  none   322    502  OCU$PMME
    2  RoData even  none    28     34  OCU$PMME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  OCU$PMME

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       0 OCU$GETMOC
         yes           Std       0 UDB$PMMEXIT
 yes     yes           Std       1 HFF$NILERASE
 yes     yes           Std       2 HFF$DSIZ
 yes     yes           Std       4 KCI$RWCGS
         yes           Std       2 FMF$TYC
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:12   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                          r    B$XL_UR$                         r    OCU_FCN
r    OCU_ERR                          r    OCU_CADDR                        r    OCI_ROUTINE
     OCI_BOOT                              B$PS0$                                B$PS1$
     B$PS2$                                B$PS3$                                B$JIT$
     B$ROSEG$                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:13   


        1        1        /*M* OCU$KEYIN  coordinate I/O between users and operators' consoles */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* */
        8        8        /*P*  NAME: OCU$KEYIN
        9        9              PURPOSE: To coordinate I/O between users and
       10       10                       operators' consoles.
       11       11                                                                  */
       12       12        /*M* OCU$PMME - Process the M$KEYIN PMME  */
       13       13        /*X* */
       14       14        /*F* NAME: OCU$PMME
       15       15             PURPOSE: To process the M$KEYIN PMME
       16       16             DESCRIPTION: I/O between the user and operators' consoles is
       17       17                          performed via dcb#7 through the Central System
       18       18                          COMGROUP.  In the case of a write, a message
       19       19                          header is appended to the front of the message
       20       20                          with a canned message number specified and the
       21       21                          write is performed wait or not as indicated in the
       22       22                          fpt.  The requested operation being a read implies
       23       23                          that a message is written with wait specified
       24       24                          informing KEYIN of a pending read, after which the
       25       25                          read itself is performed with wait or not as requested
       26       26                          in the fpt.  If the operation is a keyin, the message
       27       27                          setup is similar to the message setup for a write,
       28       28                          with the exception that 'keyin' is the requested
       29       29                          operation and the message is written with wait.  The
       30       30                          following read is then done as it is for a simple read.
       31       31             INTERFACE: KCI$RWCGS, HFF$DSIZ, HGG$NILERASE, UDB$PMMEXIT
       32       32                                                                                     */
       33       33        OCU$PMME: PROC ALTRET;

     33  1 000000   000000 700200 xent  OCU$PMME     TSX0  ! X66_AUTO_0
         1 000001   000062 000000                    ZERO    50,0
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:14   
         1 000002   000074 710000 1                  TRA     s:3044

       34       34          %INCLUDE CP_6_SUBS;
       35      574          %INCLUDE F$CP6V_C;
       36      800        %INCLUDE KC$CP6V_C;
       37      920          %INCLUDE F_FPTCODE_C;
       38      956          %INCLUDE F_ERRORS_C;
       39     1196        %INCLUDE KI_ERRORS_C;
       40     1281          %INCLUDE F$JIT_C;
       41     1711          %INCLUDE B$ROSEG;
       42     1774          %INCLUDE NK$LDCT;
       43     1876            %NK$LDCT;
       44     1922          %INCLUDE NK_LDCT_R;
       45     1931          %INCLUDE B$TABLES_C;
       46     2039            %B$XL_UR;
       47     2043          %INCLUDE OC$MESSHD_C;
       48     2064          %INCLUDE OC_MESSHD_C;
       49     2117          %INCLUDE OC_SUBS_C;
       50     2848          %INCLUDE OCU_DATA_R;
       51     2859             %INCLUDE OCI_DATA_R;
       52     2871          %INCLUDE F$DCB;
       53     2920        %VLP$STATION_V (FPTN=VSTA);
       54     2932        %VLP$SETSTA_V (FPTN=VSETSTA);
       55     2944            %FPT$KEYIN_V;
       56     2948            %OC_MESSHD_W (NAME=CMHD,STCLASS=CONSTANT,MSG=WR_MSG#,NPARMS=5);
       57     2961    1         2 LEN (0:4) UBIN BYTE UNAL INIT (LENGTHC(OC_MESSHD.READID),
       58     2962    1           LENGTHC(OC_MESSHD.SZR),
       59     2963    1           LENGTHC(OC_MESSHD.ACCN),
       60     2964    1           LENGTHC(OC_MESSHD.UNAME),
       61     2965    1           0);
       62     2966                %OC$MESSHD (NAME=OC_MESSHD,STCLASS="");
       63     2980    1         2 LEN (0:4) UBIN BYTE UNAL,
       64     2981    1         2 READID UBIN HALF UNAL,
       65     2982    1         2 SZR UBIN BYTE UNAL,
       66     2983    1         2 ACCN CHAR(8) UNAL,
       67     2984    1         2 UNAME CHAR(12) UNAL,
       68     2985    1         2 MESS CHAR(92) CALIGNED;
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:15   
       69     2986        /*
       70     2987                    DCLS
       71     2988                                         */
       72     2989    1   DCL FCN UBIN WORD;
       73     2990    1   DCL SIZE UBIN WORD;
       74     2991    1   DCL SZR UBIN WORD;
       75     2992    1   DCL DCB$ PTR;
       76     2993    1   DCL UDCB$ PTR;
       77     2994    1   DCL 1 RESULTS BASED,
       78     2995    1         2 TYC BIT(36),
       79     2996    1         2 ARS SBIN WORD;
       80     2997    1   DCL STRING CHAR(SIZE) BASED;
       81     2998    1   DCL B$PS0$ PTR SYMREF;
       82     2999    1   DCL B$PS1$ PTR SYMREF;
       83     3000    1   DCL B$PS2$ PTR SYMREF;
       84     3001    1   DCL B$PS3$ PTR SYMREF;
       85     3002    1   DCL B$JIT$ PTR SYMREF;
       86     3003    1   DCL B$ROSEG$ PTR SYMREF;
       87     3004        /**/
       88     3005    1   DCL FMF$TYC ENTRY(2);
       89     3006    1   DCL KCI$RWCGS ENTRY(4) ALTRET;
       90     3007    1   DCL HFF$DSIZ ENTRY(2) ALTRET;
       91     3008    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
       92     3009    1   DCL NKA$EVENT ENTRY(2);
       93     3010    1   DCL OCU$GETMOC ENTRY ALTRET;
       94     3011    1   DCL UDB$PMMEXIT ENTRY;
       95     3012        /*I* NAME: ERROR
       96     3013             PURPOSE: To record an error in JIT.ERR
       97     3014             CALL: CALL ERROR (CODE);
       98     3015             DESCRIPTION: JIT.ERR.FCG and JIT.ERR.MID are
       99     3016                          set to indicate 'OCU', JIT.ERR.CODE is
      100     3017                          set to CODE, and the PMME is exited
      101     3018                                                                        */
      102     3019    1   ERROR:  PROC (CODE);

   3019  1 000003   200054 741300       ERROR        STX1  ! UDCB$+2,,AUTO

PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:16   
      103     3020    2   DCL CODE UBIN WORD;
      104     3021                                                /**/
      105     3022    2           B$JIT.ERR = OCU_ERR;

   3022  1 000004   000000 236000 xsym               LDQ     OCU_ERR
         1 000005   000000 470400 xsym               LDP0    B$JIT$
         1 000006   000012 756100                    STQ     10,,PR0

      106     3023    2           B$JIT.ERR.CODE = CODE;

   3023  1 000007   200055 471500                    LDP1    @CODE,,AUTO
         1 000010   100000 236100                    LDQ     0,,PR1
         1 000011   000003 736000                    QLS     3
         1 000012   000012 676100                    ERQ     10,,PR0
         1 000013   377770 376007                    ANQ     131064,DL
         1 000014   000012 656100                    ERSQ    10,,PR0
         1 000015   000017 710000 1                  TRA     s:3027

      107     3024        /**/
      108     3025    2   ERROR0: ENTRY;

   3025  1 000016   200054 741300       ERROR0       STX1  ! UDCB$+2,,AUTO

      109     3026        /**/
      110     3027    2           IF B$PS0$ -> FPT$KEYIN_V.WAIT THEN

   3027  1 000017   000000 470400 xsym               LDP0    B$PS0$
         1 000020   000003 234100                    SZN     3,,PR0
         1 000021   000067 605000 1                  TPL     s:3038

      111     3028    3           DO;

      112     3029    3              CALL HFF$NILERASE (3) ALTRET (EOUT);

   3029  1 000022   000000 630400 2                  EPPR0   0
         1 000023   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000024   000000 701000 xent               TSX1    HFF$NILERASE
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:17   
         1 000025   000040 702000 1                  TSX2    EOUT

      113     3030    3              B$PS3$ -> RESULTS.TYC = DCB$ -> F$DCB.TYC(DCB$->F$DCB.WAIT);

   3030  1 000026   200051 470500                    LDP0    DCB$,,AUTO
         1 000027   000064 236100                    LDQ     52,,PR0
         1 000030   000004 772000                    QRL     4
         1 000031   000001 376007                    ANQ     1,DL
         1 000032   000001 236106                    LDQ     1,QL,PR0
         1 000033   000000 471400 xsym               LDP1    B$PS3$
         1 000034   100000 756100                    STQ     0,,PR1

      114     3031    3              B$PS3$ -> RESULTS.ARS = DCB$ -> F$DCB.ARS; /* set ARS              */

   3031  1 000035   000000 471400 xsym               LDP1    B$PS3$
         1 000036   000000 235100                    LDA     0,,PR0
         1 000037   100001 755100                    STA     1,,PR1

   3031  1 000040                       EOUT         null
      115     3032    3   EOUT:      ;
      116     3033    3              IF B$JIT.ERR.CODE=0 AND DCB$->F$DCB.TYC(DCB$->F$DCB.WAIT)

   3033  1 000040   000000 470400 xsym               LDP0    B$JIT$
         1 000041   000012 236100                    LDQ     10,,PR0
         1 000042   377770 316007                    CANQ    131064,DL
         1 000043   000067 601000 1                  TNZ     s:3038
         1 000044   200051 471500                    LDP1    DCB$,,AUTO
         1 000045   100064 236100                    LDQ     52,,PR1
         1 000046   000004 772000                    QRL     4
         1 000047   000001 376007                    ANQ     1,DL
         1 000050   000000 620006                    EAX0    0,QL
         1 000051   000030 236000 xsym               LDQ     B_VECTNIL+24
         1 000052   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000053   100001 376110                    ANQ     1,X0,PR1
         1 000054   000067 600000 1                  TZE     s:3038

      117     3034    3                &(~%TYC_EGV) THEN
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:18   
      118     3035    3                 CALL FMF$TYC(DCB$->F$DCB.TYC(DCB$->F$DCB.WAIT),B$JIT.ERR);

   3035  1 000055   000000 236000 xsym               LDQ     B$JIT$
         1 000056   000012 036003                    ADLQ    10,DU
         1 000057   200057 756100                    STQ     @CODE+2,,AUTO
         1 000060   000001 636010                    EAQ     1,X0
         1 000061   200051 036100                    ADLQ    DCB$,,AUTO
         1 000062   200056 756100                    STQ     @CODE+1,,AUTO
         1 000063   200056 630500                    EPPR0   @CODE+1,,AUTO
         1 000064   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000065   000000 701000 xent               TSX1    FMF$TYC
         1 000066   000000 011000                    NOP     0

      119     3036    3              END;

      120     3037        /**/
      121     3038    2           CALL UDB$PMMEXIT;

   3038  1 000067   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000070   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 000071   000000 011000                    NOP     0

      122     3039    2   END ERROR;

   3039  1 000072   200054 221300                    LDX1  ! UDCB$+2,,AUTO
         1 000073   000001 702211                    TSX2  ! 1,X1

      123     3040        /*
      124     3041                        Begin main
      125     3042                                               */
      126     3043                                      /* Prevent pre-CSCG users from doing M$KEYIN    */
      127     3044    1           IF OCI_BOOT

   3044  1 000074   000000 234000 xsym               SZN     OCI_BOOT
         1 000075   000101 605000 1                  TPL     s:3054

      128     3045    1           THEN
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:19   
      129     3046    1              CALL UDB$PMMEXIT;

   3046  1 000076   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000077   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 000100   000000 011000                    NOP     0

      130     3047                                                /**/
      131     3048                                      /* If nowait was specified with
      132     3049                                         a results field (which is an
      133     3050                                         illegal combination), then
      134     3051                                         altreturn. */
      135     3052                                                /**/
      136     3053                                                /**/
      137     3054    1           IF B$PS0$ -> FPT$KEYIN_V.WAIT = '0'B

   3054  1 000101   000000 470400 xsym               LDP0    B$PS0$
         1 000102   000003 234100                    SZN     3,,PR0
         1 000103   000114 604000 1                  TMI     CONTINUE

      138     3055    1           THEN
      139     3056    2           DO;

      140     3057    2              CALL HFF$NILERASE (3) ALTRET (CONTINUE);

   3057  1 000104   000000 630400 2                  EPPR0   0
         1 000105   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000106   000000 701000 xent               TSX1    HFF$NILERASE
         1 000107   000114 702000 1                  TSX2    CONTINUE

      141     3058    2              CALL ERROR (%E$NWRESULT);

   3058  1 000110   000002 236000 2                  LDQ     2
         1 000111   200055 756100                    STQ     UDCB$+3,,AUTO
         1 000112   000003 701000 1                  TSX1    ERROR
         1 000113   000000 011000                    NOP     0

      142     3059    2              END;
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:20   

   3054  1 000114                       CONTINUE     null
      143     3060                                                /**/
      144     3061    1   CONTINUE:;
      145     3062                                                /**/
      146     3063    1           DCB$=DCBADDR(%M$UC#);           /* IN CASE NO_GO CALLS ERROR          */

   3063  1 000114   000003 470400 2                  LDP0    3
         1 000115   000000 471500                    LDP1    0,,PR0
         1 000116   100003 236100                    LDQ     3,,PR1
         1 000117   200051 756100                    STQ     DCB$,,AUTO

      147     3064    1           CALL OCU$GETMOC ALTRET (NO_GO);

   3064  1 000120   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000121   000000 701000 xent               TSX1    OCU$GETMOC
         1 000122   000474 702000 1                  TSX2    NO_GO

      148     3065    1           DCB$ = DCBADDR (%M$OC#);

   3065  1 000123   000003 470400 2                  LDP0    3
         1 000124   000000 471500                    LDP1    0,,PR0
         1 000125   100007 236100                    LDQ     7,,PR1
         1 000126   200051 756100                    STQ     DCB$,,AUTO

      149     3066    1           DCB$->F$DCB.LASTSTA$->VSTA.STATION='KEYIN';

   3066  1 000127   200051 473500                    LDP3    DCB$,,AUTO
         1 000130   300007 474500                    LDP4    7,,PR3
         1 000131   040100 100400                    MLR     fill='040'O
         1 000132   000007 000005 0                  ADSC9   CMHD+7                   cn=0,n=5
         1 000133   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8

      150     3067                          /*    Set WAS since some ghosts
      151     3068                           *    use this PMME before KEYIN
      152     3069                           *    comes alive, and we want
      153     3070                           *    him to get the message,
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:21   
      154     3071                           *    now don't we?
      155     3072                           */
      156     3073    1           DCB$->F$DCB.SETSTA$->VSETSTA.OSTA.WAS='1'B;

   3073  1 000134   300006 474500                    LDP4    6,,PR3
         1 000135   001000 236003                    LDQ     512,DU
         1 000136   400013 256100                    ORSQ    11,,PR4

      157     3074    1           DCB$ -> F$DCB.UB$ = ADDR (OC_MESSHD);

   3074  1 000137   200003 634500                    EPPR4   OC_MESSHD,,AUTO
         1 000140   300075 454500                    STP4    61,,PR3

      158     3075    1           OC_MESSHD=CMHD;                 /* SET INITIAL VALUES                 */

   3075  1 000141   000100 100400                    MLR     fill='000'O
         1 000142   000000 000031 0                  ADSC9   CMHD                     cn=0,n=25
         1 000143   200003 000214                    ADSC9   OC_MESSHD,,AUTO          cn=0,n=140

      159     3076    1           OC_MESSHD.ACCN = B$JIT.ACCN; /* save account for message on console   */

   3076  1 000144   000000 475400 xsym               LDP5    B$JIT$
         1 000145   040100 100500                    MLR     fill='040'O
         1 000146   500001 000010                    ADSC9   1,,PR5                   cn=0,n=8
         1 000147   200012 000010                    ADSC9   OC_MESSHD+7,,AUTO        cn=0,n=8

      160     3077    1           OC_MESSHD.SYSID = B$JIT.SYSID;

   3077  1 000150   500000 720100                    LXL0    0,,PR5
         1 000151   200004 740100                    STX0    OC_MESSHD+1,,AUTO

      161     3078    1           OC_MESSHD.UNAME=B$JIT.UNAME;

   3078  1 000152   040100 100500                    MLR     fill='040'O
         1 000153   500003 000014                    ADSC9   3,,PR5                   cn=0,n=12
         1 000154   200014 000014                    ADSC9   OC_MESSHD+9,,AUTO        cn=0,n=12

PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:22   
      162     3079    1           FCN = 0;

   3079  1 000155   200046 450100                    STZ     FCN,,AUTO

      163     3080    1           CALL HFF$DSIZ (B$PS1$, SIZE) ALTRET (NO_WRITE); /* get size of buffer */

   3080  1 000156   200047 636500                    EPPR6   SIZE,,AUTO
         1 000157   200057 456500                    STP6    @CODE+2,,AUTO
         1 000160   000004 236000 2                  LDQ     4
         1 000161   200056 756100                    STQ     @CODE+1,,AUTO
         1 000162   200056 630500                    EPPR0   @CODE+1,,AUTO
         1 000163   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000164   000000 701000 xent               TSX1    HFF$DSIZ
         1 000165   000207 702000 1                  TSX2    NO_WRITE

      164     3081    1           FCN=1;

   3081  1 000166   000001 235007                    LDA     1,DL
         1 000167   200046 755100                    STA     FCN,,AUTO

      165     3082    1           IF SIZE > SIZEC (OC_MESSHD.MESS)

   3082  1 000170   200047 236100                    LDQ     SIZE,,AUTO
         1 000171   000135 116007                    CMPQ    93,DL
         1 000172   000175 602000 1                  TNC     s:3087

      166     3083    1           THEN
      167     3084    2           DO;

      168     3085    2              SIZE = SIZEC (OC_MESSHD.MESS);

   3085  1 000173   000134 235007                    LDA     92,DL
         1 000174   200047 755100                    STA     SIZE,,AUTO

      169     3086    2              END;

      170     3087    1           OC_MESSHD.LEN(4) = SIZE;
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:23   

   3087  1 000175   200047 236100                    LDQ     SIZE,,AUTO
         1 000176   000033 736000                    QLS     27
         1 000177   200011 552140                    STBQ    OC_MESSHD+6,'40'O,AUTO

      171     3088    1           CALL XLATE (OC_MESSHD.MESS,B$XL_UR,B$PS1$->STRING);

   3088  1 000200   000000 470400 xsym               LDP0    B$PS1$
         1 000201   200047 720100                    LXL0    SIZE,,AUTO
         1 000202   000000 471400 xsym               LDP1    B$XL_UR$
         1 000203   040100 160540                    MVT     fill='040'O
         1 000204   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 000205   200017 000134                    ADSC9   OC_MESSHD+12,,AUTO       cn=0,n=92
         1 000206   100000 000100                    ARG     0,,PR1

      172     3089    1   NO_WRITE:
      173     3090    1           CALL HFF$DSIZ (B$PS2$,SZR) ALTRET (NO_READ);

   3090  1 000207   200050 630500       NO_WRITE     EPPR0   SZR,,AUTO
         1 000210   200057 450500                    STP0    @CODE+2,,AUTO
         1 000211   000005 236000 2                  LDQ     5
         1 000212   200056 756100                    STQ     @CODE+1,,AUTO
         1 000213   200056 630500                    EPPR0   @CODE+1,,AUTO
         1 000214   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000215   000000 701000 xent               TSX1    HFF$DSIZ
         1 000216   000244 702000 1                  TSX2    NO_READ

      174     3091    1           IF SZR = 0

   3091  1 000217   200050 235100                    LDA     SZR,,AUTO
         1 000220   000222 601000 1                  TNZ     s:3097

      175     3092    1           THEN
      176     3093    2           DO;

      177     3094    2              GOTO NO_READ;

PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:24   
   3094  1 000221   000244 710000 1                  TRA     NO_READ

      178     3095    2              END;
      179     3096                                                /**/
      180     3097    1           IF SZR <= 120

   3097  1 000222   000171 115007                    CMPA    121,DL
         1 000223   000227 603000 1                  TRC     s:3104

      181     3098    1           THEN
      182     3099    2           DO;

      183     3100    2              OC_MESSHD.SZR = SZR;

   3100  1 000224   200050 236100                    LDQ     SZR,,AUTO
         1 000225   200011 552104                    STBQ    OC_MESSHD+6,'04'O,AUTO

      184     3101    2              END;

   3101  1 000226   000231 710000 1                  TRA     s:3107

      185     3102    1           ELSE
      186     3103    2           DO;

      187     3104    2              OC_MESSHD.SZR = 120;

   3104  1 000227   000170 236007                    LDQ     120,DL
         1 000230   200011 552104                    STBQ    OC_MESSHD+6,'04'O,AUTO

      188     3105    2              END;

      189     3106                                                /**/
      190     3107    1           FCN = FCN + 2;

   3107  1 000231   200046 236100                    LDQ     FCN,,AUTO
         1 000232   000002 036007                    ADLQ    2,DL
         1 000233   200046 756100                    STQ     FCN,,AUTO
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:25   

      191     3108    1           IF DCB$ -> F$DCB.FCN(0) THEN

   3108  1 000234   200051 470500                    LDP0    DCB$,,AUTO
         1 000235   000074 236100                    LDQ     60,,PR0
         1 000236   777000 316003                    CANQ    -512,DU
         1 000237   000244 600000 1                  TZE     NO_READ

      192     3109        /*E* ERROR: OCU-E$TWONWIO-A
      193     3110             MESSAGE: Simultaneous M$KEYIN operations not permitted
      194     3111             DESCRIPTION: The user has issued an M$KEYIN while
      195     3112                          he still has one outstanding
      196     3113                                                                     */
      197     3114    1              CALL ERROR (%E$TWONWIO);

   3114  1 000240   000007 236000 2                  LDQ     7
         1 000241   200055 756100                    STQ     UDCB$+3,,AUTO
         1 000242   000003 701000 1                  TSX1    ERROR
         1 000243   000000 011000                    NOP     0

      198     3115    1   NO_READ:
      199     3116    2           IF FCN = 0 THEN DO;

   3116  1 000244   200046 235100       NO_READ      LDA     FCN,,AUTO
         1 000245   000254 601000 1                  TNZ     s:3126

      200     3117        /*E* ERROR: OCU-E$KEYIN-A
      201     3118             MESSAGE: No message or reply buffer specified
      202     3119             DESCRIPTION: The user has executed an M$KEYIN PMME
      203     3120                          with no message or reply buffer
      204     3121                          specified in his fpt
      205     3122                                                                         */
      206     3123    2              B$JIT.ERR = OCU_ERR;

   3123  1 000246   000000 236000 xsym               LDQ     OCU_ERR
         1 000247   000000 470400 xsym               LDP0    B$JIT$
         1 000250   000012 756100                    STQ     10,,PR0
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:26   

      207     3124    2              CALL UDB$PMMEXIT;

   3124  1 000251   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000252   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 000253   000000 011000                    NOP     0

      208     3125    2              END;

      209     3126    1           DCB$ -> F$DCB.UBYTES = SIZE + SIZEC (OC_MESSHD) - SIZEC (OC_MESSHD.MESS);
              3126                    /* header + message */

   3126  1 000254   200051 470500                    LDP0    DCB$,,AUTO
         1 000255   200047 235100                    LDA     SIZE,,AUTO
         1 000256   000060 035007                    ADLA    48,DL
         1 000257   000076 755100                    STA     62,,PR0

      210     3127    1           OC_MESSHD.FCN = OCU_FCN (FCN);

   3127  1 000260   200046 720100                    LXL0    FCN,,AUTO
         1 000261   000000 236010 xsym               LDQ     OCU_FCN,X0
         1 000262   700000 376003                    ANQ     -32768,DU
         1 000263   000041 772000                    QRL     33
         1 000264   200004 552104                    STBQ    OC_MESSHD+1,'04'O,AUTO

      211     3128                                                /**/
      212     3129    1           IF B$PS0$ -> FPT$KEYIN_V.WHO = 0 /* WSN                               */

   3129  1 000265   000000 471400 xsym               LDP1    B$PS0$
         1 000266   100003 236100                    LDQ     3,,PR1
         1 000267   000777 316003                    CANQ    511,DU
         1 000270   000320 601000 1                  TNZ     s:3149

      213     3130    1           THEN
      214     3131    2           DO;

      215     3132    2              OC_MESSHD.CADDR = OCU_CADDR (B$PS0$ -> FPT$KEYIN_V.OCTYPE);
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:27   

   3132  1 000271   100003 236100                    LDQ     3,,PR1
         1 000272   000033 772000                    QRL     27
         1 000273   000017 376007                    ANQ     15,DL
         1 000274   000001 736000                    QLS     1
         1 000275   000100 100406                    MLR     fill='000'O
         1 000276   000000 000002 xsym               ADSC9   OCU_CADDR,Q              cn=0,n=2
         1 000277   200003 000002                    ADSC9   OC_MESSHD,,AUTO          cn=0,n=2

      216     3133    2              IF OC_MESSHD.CADDR & M_DEVC

   3133  1 000300   200003 221100                    LDX1    OC_MESSHD,,AUTO
         1 000301   100000 361003                    ANX1    32768,DU
         1 000302   000307 600000 1                  TZE     s:3140

      217     3134    2              THEN
      218     3135    3              DO;

      219     3136    3                 OC_MESSHD.WSN = 'XX000000';

   3136  1 000303   040100 100400                    MLR     fill='040'O
         1 000304   000011 000010 0                  ADSC9   CMHD+9                   cn=0,n=8
         1 000305   200006 000010                    ADSC9   OC_MESSHD+3,,AUTO        cn=0,n=8

      220     3137    3                 END;

   3137  1 000306   000376 710000 1                  TRA     s:3185

      221     3138    2              ELSE
      222     3139    3              DO;

      223     3140    3                 OC_MESSHD.WSN = B$PS0$ -> FPT$KEYIN_V.WSN;

   3140  1 000307   100000 237100                    LDAQ    0,,PR1
         1 000310   200006 757100                    STAQ    OC_MESSHD+3,,AUTO

      224     3141    3                 IF OC_MESSHD.WSN = ' '
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:28   

   3141  1 000311   200006 237100                    LDAQ    OC_MESSHD+3,,AUTO
         1 000312   000010 117000 2                  CMPAQ   8
         1 000313   000376 601000 1                  TNZ     s:3185

      225     3142    3                 THEN
      226     3143    4                 DO;

      227     3144    4                    OC_MESSHD.WSN = B$JIT.WOO;

   3144  1 000314   000000 473400 xsym               LDP3    B$JIT$
         1 000315   300010 237100                    LDAQ    8,,PR3
         1 000316   200006 757100                    STAQ    OC_MESSHD+3,,AUTO

      228     3145    4                    END;

      229     3146    3                 END;

      230     3147    2              END;

   3147  1 000317   000376 710000 1                  TRA     s:3185

      231     3148    1           ELSE
      232     3149    1              IF B$PS0$ -> FPT$KEYIN_V.DCB# <= B$ROSEG$ -> B$ROSEG.NUMDCBS THEN

   3149  1 000320   100003 721100                    LXL1    3,,PR1
         1 000321   000000 473400 xsym               LDP3    B$ROSEG$
         1 000322   300002 101100                    CMPX1   2,,PR3
         1 000323   000325 600000 1                  TZE     s:3151
         1 000324   000372 603000 1                  TRC     s:3182

      233     3150    2              DO;

      234     3151    2                 UDCB$ = DCBADDR (B$PS0$ -> FPT$KEYIN_V.DCB#);

   3151  1 000325   000003 474400 2                  LDP4    3
         1 000326   400000 475500                    LDP5    0,,PR4
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:29   
         1 000327   500000 236111                    LDQ     0,X1,PR5
         1 000330   200052 756100                    STQ     UDCB$,,AUTO

      235     3152    2                 IF UDCB$ ~= ADDR (NIL) THEN

   3152  1 000331   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000332   000365 600000 1                  TZE     s:3179

      236     3153    2                    IF UDCB$ -> F$DCB.FCD = '1'B THEN /* dcb is open             */

   3153  1 000333   200052 476500                    LDP6    UDCB$,,AUTO
         1 000334   600031 236100                    LDQ     25,,PR6
         1 000335   020000 316007                    CANQ    8192,DL
         1 000336   000360 600000 1                  TZE     s:3172

      237     3154    2                       IF UDCB$ -> F$DCB.ASN = 3 THEN /* device                  */

   3154  1 000337   600032 236100                    LDQ     26,,PR6
         1 000340   777000 376007                    ANQ     -512,DL
         1 000341   003000 116007                    CMPQ    1536,DL
         1 000342   000353 601000 1                  TNZ     s:3165

      238     3155    3                       DO;

      239     3156    3                          OC_MESSHD.CADDR = M_DEVC; /* address device console    */

   3156  1 000343   100000 222003                    LDX2    32768,DU
         1 000344   200003 742100                    STX2    OC_MESSHD,,AUTO

      240     3157    3                         OC_MESSHD.DEVNM = NK$LDCT$ (UDCB$ -> F$DCB.LDCTX) -> NK$LDCT.
              3157                                   DEVNM;

   3157  1 000345   600051 223100                    LDX3    41,,PR6
         1 000346   000000 477400 xsym               LDP7    N$DCT$$
         1 000347   700000 470513                    LDP0    0,X3,PR7
         1 000350   000002 237100                    LDAQ    2,,PR0
         1 000351   200006 757100                    STAQ    OC_MESSHD+3,,AUTO
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:30   

      241     3158    3                          END;

   3158  1 000352   000376 710000 1                  TRA     s:3185

      242     3159    2                       ELSE
      243     3160        /*E* ERROR: OCU-E$NOTDEVICE-A
      244     3161             MESSAGE: DCB for M$KEYIN must be assigned to a device
      245     3162             DESCRIPTION: The user has requested communication with
      246     3163                          a device console but has supplied a non-device
      247     3164                          dcb.                                            */
      248     3165    2                          CALL ERROR (%E$NOTDEVICE);

   3165  1 000353   000013 236000 2                  LDQ     11
         1 000354   200055 756100                    STQ     UDCB$+3,,AUTO
         1 000355   000003 701000 1                  TSX1    ERROR
         1 000356   000000 011000                    NOP     0
         1 000357   000376 710000 1                  TRA     s:3185

      249     3166    2                    ELSE
      250     3167        /*E* ERROR: OCU-E$NOTOPEN-A
      251     3168             MESSAGE: DCB in M$KEYIN must be open to device
      252     3169             DESCRIPTION: The user has requested communication with
      253     3170                          a device console but has supplied a
      254     3171                          closed dcb.                            */
      255     3172    2                       CALL ERROR (%E$NOTOPEN);

   3172  1 000360   000015 236000 2                  LDQ     13
         1 000361   200055 756100                    STQ     UDCB$+3,,AUTO
         1 000362   000003 701000 1                  TSX1    ERROR
         1 000363   000000 011000                    NOP     0
         1 000364   000376 710000 1                  TRA     s:3185

      256     3173    2                 ELSE
      257     3174        /*E* ERROR: OCU-E$NODCBKI-A
      258     3175             MESSAGE: Illegal device DCB number specified for console communication.
      259     3176             DESCRIPTION: The user has requested communication with
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:31   
      260     3177                          a device console but has supplied an
      261     3178                          illegal dcb number.                           */
      262     3179    2                    CALL ERROR (%E$NODCBKI);

   3179  1 000365   000017 236000 2                  LDQ     15
         1 000366   200055 756100                    STQ     UDCB$+3,,AUTO
         1 000367   000003 701000 1                  TSX1    ERROR
         1 000370   000000 011000                    NOP     0

      263     3180    2                 END;

   3180  1 000371   000376 710000 1                  TRA     s:3185

      264     3181    1              ELSE
      265     3182    1                 CALL ERROR (%E$NODCBKI);

   3182  1 000372   000017 236000 2                  LDQ     15
         1 000373   200055 756100                    STQ     UDCB$+3,,AUTO
         1 000374   000003 701000 1                  TSX1    ERROR
         1 000375   000000 011000                    NOP     0

      266     3183                                                /**/
      267     3184                                                /**/
      268     3185    1           DCB$->F$DCB.TYC='0'B;

   3185  1 000376   200051 470500                    LDP0    DCB$,,AUTO
         1 000377   000001 450100                    STZ     1,,PR0
         1 000400   000002 450100                    STZ     2,,PR0

      269     3186    1           DCB$ -> F$DCB.WAIT=BITBIN(B$PS0$->FPT$KEYIN_V.WAIT);

   3186  1 000401   000000 471400 xsym               LDP1    B$PS0$
         1 000402   100003 236100                    LDQ     3,,PR1
         1 000403   000043 772000                    QRL     35
         1 000404   000004 736000                    QLS     4
         1 000405   000064 676100                    ERQ     52,,PR0
         1 000406   000020 376007                    ANQ     16,DL
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:32   
         1 000407   000064 656100                    ERSQ    52,,PR0

      270     3187    1           IF FCN = 1

   3187  1 000410   200046 235100                    LDA     FCN,,AUTO
         1 000411   000001 115007                    CMPA    1,DL
         1 000412   000426 601000 1                  TNZ     s:3195

      271     3188    1           THEN
      272     3189    2           DO;

      273     3190    2              CALL KCI$RWCGS (MFC_WRITE, 0, 'A', B$PS0$ -> FPT$KEYIN_V.EVENT)

   3190  1 000413   000000 236000 xsym               LDQ     B$PS0$
         1 000414   000002 036003                    ADLQ    2,DU
         1 000415   000021 235000 2                  LDA     17
         1 000416   200060 757100                    STAQ    @CODE+3,,AUTO
         1 000417   000022 237000 2                  LDAQ    18
         1 000420   200056 757100                    STAQ    @CODE+1,,AUTO
         1 000421   200056 630500                    EPPR0   @CODE+1,,AUTO
         1 000422   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000423   000000 701000 xent               TSX1    KCI$RWCGS
         1 000424   000474 702000 1                  TSX2    NO_GO

      274     3191    2                ALTRET (NO_GO);
      275     3192    2              END;

   3192  1 000425   000474 710000 1                  TRA     NO_GO

      276     3193    1           ELSE                            /* read | keyin                       */
      277     3194    2           DO;

      278     3195    2              CALL KCI$RWCGS (MFC_WRITE, 0, 'A', 0) ALTRET(NO_GO);

   3195  1 000426   000024 630400 2                  EPPR0   20
         1 000427   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000430   000000 701000 xent               TSX1    KCI$RWCGS
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:33   
         1 000431   000474 702000 1                  TSX2    NO_GO

      279     3196    2              DCB$->F$DCB.UBYTES=SZR;

   3196  1 000432   200051 470500                    LDP0    DCB$,,AUTO
         1 000433   200050 235100                    LDA     SZR,,AUTO
         1 000434   000076 755100                    STA     62,,PR0

      280     3197    2              DCB$ -> F$DCB.UB$ = B$PS2$;

   3197  1 000435   000000 236000 xsym               LDQ     B$PS2$
         1 000436   000075 756100                    STQ     61,,PR0

      281     3198    2              CALL KCI$RWCGS (MFC_READ, 0, ' ', B$PS0$->FPT$KEYIN_V.EVENT);

   3198  1 000437   000000 236000 xsym               LDQ     B$PS0$
         1 000440   000002 036003                    ADLQ    2,DU
         1 000441   000030 235000 2                  LDA     24
         1 000442   200060 757100                    STAQ    @CODE+3,,AUTO
         1 000443   000032 237000 2                  LDAQ    26
         1 000444   200056 757100                    STAQ    @CODE+1,,AUTO
         1 000445   200056 630500                    EPPR0   @CODE+1,,AUTO
         1 000446   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000447   000000 701000 xent               TSX1    KCI$RWCGS
         1 000450   000000 011000                    NOP     0

      282     3199                                                /**/
      283     3200    2              IF B$JIT.ERR.CODE = %E$BYDR

   3200  1 000451   000000 470400 xsym               LDP0    B$JIT$
         1 000452   000012 236100                    LDQ     10,,PR0
         1 000453   377770 376007                    ANQ     131064,DL
         1 000454   020430 116007                    CMPQ    8472,DL
         1 000455   000474 601000 1                  TNZ     NO_GO

      284     3201    2              THEN
      285     3202    3              DO;
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:34   

      286     3203    3                 OC_MESSHD.FCN=OC_XRD;

   3203  1 000456   000005 236007                    LDQ     5,DL
         1 000457   200004 552104                    STBQ    OC_MESSHD+1,'04'O,AUTO

      287     3204    3                 OC_MESSHD.MSG#=XRD_MSG#;

   3204  1 000460   000770 220003                    LDX0    504,DU
         1 000461   200003 440100                    SXL0    OC_MESSHD,,AUTO

      288     3205    3                 DCB$->F$DCB.UB$=ADDR(OC_MESSHD);

   3205  1 000462   200003 631500                    EPPR1   OC_MESSHD,,AUTO
         1 000463   200051 473500                    LDP3    DCB$,,AUTO
         1 000464   300075 451500                    STP1    61,,PR3

      289     3206    3                 DCB$->F$DCB.UBYTES=SIZEC(OC_MESSHD)-SIZEC(OC_MESSHD.MESS);

   3206  1 000465   000060 235007                    LDA     48,DL
         1 000466   300076 755100                    STA     62,,PR3

      290     3207    3                 CALL KCI$RWCGS (MFC_WRITE,0,'A',0);

   3207  1 000467   000024 630400 2                  EPPR0   20
         1 000470   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000471   000000 701000 xent               TSX1    KCI$RWCGS
         1 000472   000000 011000                    NOP     0

      291     3208    3                 GOTO OUT;

   3208  1 000473   000476 710000 1                  TRA     OUT

   3205  1 000474                       NO_GO        null
      292     3209    3                 END;
      293     3210    2              END;
      294     3211        /**/
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:35   
      295     3212    1   NO_GO:  ;
      296     3213    1           CALL ERROR0;                    /* Set results and JIT.ERR            */

   3213  1 000474   000016 701000 1                  TSX1    ERROR0
         1 000475   000000 011000                    NOP     0

   3213  1 000476                       OUT          null
      297     3214        /**/
      298     3215    1   OUT:    ;
      299     3216    1           CALL UDB$PMMEXIT;

   3216  1 000476   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000477   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 000500   000000 011000                    NOP     0

      300     3217        /**/
      301     3218    1   END OCU$PMME;

   3218  1 000501   000000 702200 xent               TSX2  ! X66_ARET

CMHD
 Sect OctLoc
   0     000   000000 000764   ****** 005003   000*** ******   040040 040040    ............
   0     004   040040 040040   002001 010014   000*** ******                        ........

(unnamed)
 Sect OctLoc
   0     007   113105 131111   116040 040040   130130 060060   060060 060060    KEYIN   XX000000

(unnamed)
 Sect OctLoc
   2     000   000005 006000   000000 001364   000001 006000   000000 006003    ................
   2     004   000000 006000   000000 006000   000000 001362   000006 006000    ................
   2     010   040040 040040   040040 040040   000000 001357   000012 006000            ........
   2     014   000000 001360   000014 006000   000000 001361   000016 006000    ................
   2     020   101040 040040   000020 006000   000003 006000   000002 006000    A   ............
   2     024   000003 006000   000002 006000   000020 006000   000002 006000    ................
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:36   
   2     030   000035 006000   000000 000000   000002 006000   000002 006000    ................
      302     3219        %EOD;

PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:37   
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   OCI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   NK$LDCT.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure OCU$PMME.
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:38   

 **** Variables and constants ****

  ****  Section 000 RoData OCU$PMME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(225)   r     1 CMHD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    55-0-0/w PTR         r     1 @CODE                     *0-0-0/w UBIN        r     1 CODE
    51-0-0/w PTR         r     1 DCB$                      46-0-0/w UBIN        r     1 FCN
     3-0-0/c STRC(1260)  r     1 OC_MESSHD                 47-0-0/w UBIN        r     1 SIZE
    50-0-0/w UBIN        r     1 SZR                       52-0-0/w PTR         r     1 UDCB$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS2$
     0-0-0/w PTR         r     1 B$PS3$                     0-0-0/w PTR         r     1 B$ROSEG$
     0-0-0/w PTR         r     1 B$XL_UR$                   0-0-0/w PTR         r     1 N$DCT$$
     0-0-0/w BIT         r     1 OCI_BOOT
     0-0-0/w EPTR        r     1 OCI_ROUTINE(0:8191)
     0-0-0/b BIT (18)    r     1 OCU_CADDR(0:15)
     0-0-0/b STRC        r     1 OCU_ERR
     0-0-0/w UBIN(3)     r     1 OCU_FCN(0:3)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:39   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(3024)  r     1 B$ROSEG
     0-0-0/d STRC(4608)  r     1 B$XL_UR                    0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(216)   r     1 FPT$KEYIN_V                0-0-0/d STRC(864)   r     1 NK$LDCT
     0-0-0/w PTR         r     1 NK$LDCT$(0:0)
     0-0-0/w STRC(72)    r     1 RESULTS                    0-0-0/c ACHR        r     1 STRING
     0-0-0/w STRC(432)   r     1 VSETSTA                    0-0-0/w STRC(288)   r     1 VSTA


   Procedure OCU$PMME requires 322 words for executable code.
   Procedure OCU$PMME requires 50 words of local(AUTO) storage.
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:41   
          MINI XREF LISTING

B$JIT.ACCN
      1608**DCL      3076>>ASSIGN
B$JIT.ERR
      1608**DCL      3022<<ASSIGN   3035<>CALL     3123<<ASSIGN
B$JIT.ERR.CODE
      1609**DCL      3023<<ASSIGN   3033>>IF       3200>>IF
B$JIT.ERR.MID
      1609**DCL      1609--REDEF
B$JIT.SYSID
      1608**DCL      3077>>ASSIGN
B$JIT.UNAME
      1608**DCL      3078>>ASSIGN
B$JIT.WOO
      1608**DCL      3144>>ASSIGN
B$JIT$
      3002**DCL      1603--IMP-PTR  3022>>ASSIGN   3023>>ASSIGN   3033>>IF       3035>>CALL     3076>>ASSIGN
      3077>>ASSIGN   3078>>ASSIGN   3123>>ASSIGN   3144>>ASSIGN   3200>>IF
B$PS0$
      2998**DCL      3027>>IF       3054>>IF       3129>>IF       3132>>ASSIGN   3140>>ASSIGN   3149>>IF
      3151>>ASSIGN   3186>>ASSIGN   3190>>CALL     3198>>CALL
B$PS1$
      2999**DCL      3080<>CALL     3088>>CALLBLT
B$PS2$
      3000**DCL      3090<>CALL     3197>>ASSIGN
B$PS3$
      3001**DCL      3030>>ASSIGN   3031>>ASSIGN
B$ROSEG.NUMDCBS
      1724**DCL      3149>>IF
B$ROSEG$
      3003**DCL      3149>>IF
B$XL_UR
      2041**DCL      3088>>CALLBLT
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:42   
B$XL_UR$
      2040**DCL      2041--IMP-PTR  3088>>CALLBLT
CMHD
      2949**DCL      3075>>ASSIGN
CMHD.FLAGS
      2956**DCL      2957--REDEF
CMHD.MSGID
      2952**DCL      2953--REDEF
CODE IN PROCEDURE ERROR
      3020**DCL      3019--PROC     3023>>ASSIGN
CONTINUE
      3054**LABEL    3057--CALLALT
DCB$
      2992**DCL      3030>>ASSIGN   3030>>ASSIGN   3031>>ASSIGN   3033>>IF       3033>>IF       3035>>CALL
      3035>>CALL     3063<<ASSIGN   3065<<ASSIGN   3066>>ASSIGN   3073>>ASSIGN   3074>>ASSIGN   3108>>IF
      3126>>ASSIGN   3185>>ASSIGN   3186>>ASSIGN   3196>>ASSIGN   3197>>ASSIGN   3205>>ASSIGN   3206>>ASSIGN
EOUT IN PROCEDURE ERROR
      3031**LABEL    3029--CALLALT
ERROR
      3019**PROC     3058--CALL     3114--CALL     3165--CALL     3172--CALL     3179--CALL     3182--CALL
ERROR0 IN PROCEDURE ERROR
      3025**ENTRY    3213--CALL
F$DCB.ACTPOS
      2897**DCL      2897--REDEF
F$DCB.ARS
      2872**DCL      2872--REDEF    3031>>ASSIGN
F$DCB.ASN
      2887**DCL      3154>>IF
F$DCB.ATTR
      2890**DCL      2891--REDEF
F$DCB.BORROW
      2905**DCL      2905--REDEF    2905--REDEF    2905--REDEF
F$DCB.DCBNAME.L
      2919**DCL      2919--IMP-SIZ
F$DCB.EOMCHAR
      2876**DCL      2876--REDEF
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:43   
F$DCB.FCD
      2885**DCL      3153>>IF
F$DCB.FCN
      2909**DCL      3108>>IF
F$DCB.FLDID
      2900**DCL      2900--REDEF
F$DCB.FORM$
      2894**DCL      2894--REDEF
F$DCB.FSECT
      2910**DCL      2910--REDEF
F$DCB.FSN
      2887**DCL      2887--REDEF    2887--REDEF    2888--REDEF
F$DCB.HEADER$
      2893**DCL      2893--REDEF
F$DCB.IXTNSIZE
      2891**DCL      2891--REDEF
F$DCB.LASTSTA$
      2881**DCL      2881--REDEF    3066>>ASSIGN
F$DCB.LDCTX
      2894**DCL      3157>>ASSIGN
F$DCB.LVL
      2906**DCL      2906--REDEF
F$DCB.NAME.C
      2881**DCL      2881--REDEF
F$DCB.NOEOF
      2902**DCL      2902--REDEF
F$DCB.NRECS
      2892**DCL      2892--REDEF
F$DCB.NRECX
      2911**DCL      2911--REDEF
F$DCB.OHDR
      2903**DCL      2903--REDEF
F$DCB.ORG
      2886**DCL      2886--REDEF
F$DCB.PRECNO
      2909**DCL      2909--REDEF
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:44   
F$DCB.RCSZ
      2914**DCL      2914--REDEF
F$DCB.RES
      2882**DCL      2882--REDEF
F$DCB.SETSTA$
      2881**DCL      3073>>ASSIGN
F$DCB.SETX
      2894**DCL      2894--REDEF
F$DCB.TAB$
      2893**DCL      2894--REDEF
F$DCB.TDA
      2908**DCL      2908--REDEF
F$DCB.TYC
      2872**DCL      3030>>ASSIGN   3033>>IF       3035<>CALL     3185<<ASSIGN
F$DCB.UB$
      2910**DCL      3074<<ASSIGN   3197<<ASSIGN   3205<<ASSIGN
F$DCB.UBYTES
      2910**DCL      3126<<ASSIGN   3196<<ASSIGN   3206<<ASSIGN
F$DCB.WAIT
      2904**DCL      3030>>ASSIGN   3033>>IF       3035>>CALL     3186<<ASSIGN
F$DCB.WSN
      2883**DCL      2883--REDEF
FCN
      2989**DCL      3079<<ASSIGN   3081<<ASSIGN   3107<<ASSIGN   3107>>ASSIGN   3116>>IF       3127>>ASSIGN
      3187>>IF
FMF$TYC
      3005**DCL-ENT  3035--CALL
FPT$KEYIN_V.DCB#
      2945**DCL      3149>>IF       3151--ASSIGN
FPT$KEYIN_V.EVENT
      2945**DCL      3190<>CALL     3198<>CALL
FPT$KEYIN_V.OCTYPE
      2945**DCL      3132>>ASSIGN
FPT$KEYIN_V.WAIT
      2945**DCL      3027>>IF       3054>>IF       3186>>ASSIGN
FPT$KEYIN_V.WHO
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:45   
      2945**DCL      3129>>IF
FPT$KEYIN_V.WSN
      2945**DCL      3140>>ASSIGN
HFF$DSIZ
      3007**DCL-ENT  3080--CALL     3090--CALL
HFF$NILERASE
      3008**DCL-ENT  3029--CALL     3057--CALL
KCI$RWCGS
      3006**DCL-ENT  3190--CALL     3195--CALL     3198--CALL     3207--CALL
N$DCT$$
      1929**DCL      1929--IMP-PTR  3157>>ASSIGN
NK$LDCT.DDT$
      1891**DCL      1891--REDEF
NK$LDCT.DEVNM
      1891**DCL      3157>>ASSIGN
NK$LDCT.IOQ$
      1890**DCL      1891--REDEF
NK$LDCT.LDCTX
      1892**DCL      1892--REDEF
NK$LDCT.LKFLG.ABORTED
      1904**DCL      1905--REDEF
NK$LDCT.RLCID.LDCTX
      1914**DCL      1914--REDEF
NK$LDCT.STA$
      1910**DCL      1911--REDEF
NK$LDCT.SYMB$
      1889**DCL      1889--REDEF    1889--REDEF    1890--REDEF
NK$LDCT$
      1929**DCL      3157>>ASSIGN
NO_GO
      3205**LABEL    3064--CALLALT  3190--CALLALT  3195--CALLALT
NO_READ
      3116**LABEL    3090--CALLALT  3094--GOTO
NO_WRITE
      3090**LABEL    3080--CALLALT
OCI_BOOT
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:46   
      2870**DCL      3044>>IF
OCU$GETMOC
      3010**DCL-ENT  3064--CALL
OCU_CADDR
      2858**DCL      3132>>ASSIGN
OCU_ERR
      2856**DCL      3022>>ASSIGN   3123>>ASSIGN
OCU_FCN
      2856**DCL      3127>>ASSIGN
OC_MESSHD
      2967**DCL      3074--ASSIGN   3075<<ASSIGN   3126--ASSIGN   3205--ASSIGN   3206--ASSIGN
OC_MESSHD.ACCN
      2983**DCL      2963--DCLINIT  3076<<ASSIGN
OC_MESSHD.CADDR
      2968**DCL      3132<<ASSIGN   3133>>IF       3156<<ASSIGN
OC_MESSHD.DEVNM
      2978**DCL      3157<<ASSIGN
OC_MESSHD.FCN
      2973**DCL      3127<<ASSIGN   3203<<ASSIGN
OC_MESSHD.FLAGS
      2974**DCL      2975--REDEF
OC_MESSHD.LEN
      2980**DCL      3087<<ASSIGN
OC_MESSHD.MESS
      2985**DCL      3082--IF       3085--ASSIGN   3088<<CALLBLT  3126--ASSIGN   3206--ASSIGN
OC_MESSHD.MSG#
      2969**DCL      3204<<ASSIGN
OC_MESSHD.MSGID
      2970**DCL      2971--REDEF
OC_MESSHD.READID
      2981**DCL      2961--DCLINIT
OC_MESSHD.SYSID
      2971**DCL      3077<<ASSIGN
OC_MESSHD.SZR
      2982**DCL      2962--DCLINIT  3100<<ASSIGN   3104<<ASSIGN
OC_MESSHD.UNAME
PL6.E3A0      #001=OCU$PMME File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:07 Page:47   
      2984**DCL      2964--DCLINIT  3078<<ASSIGN
OC_MESSHD.WSN
      2977**DCL      2978--REDEF    3136<<ASSIGN   3140<<ASSIGN   3141>>IF       3144<<ASSIGN
OUT
      3213**LABEL    3208--GOTO
RESULTS.ARS
      2996**DCL      3031<<ASSIGN
RESULTS.TYC
      2995**DCL      3030<<ASSIGN
SIZE
      2990**DCL      2997--IMP-SIZ  3080<>CALL     3082>>IF       3085<<ASSIGN   3087>>ASSIGN   3088>>CALLBLT
      3126>>ASSIGN
STRING
      2997**DCL      3088>>CALLBLT
SZR
      2991**DCL      3090<>CALL     3091>>IF       3097>>IF       3100>>ASSIGN   3196>>ASSIGN
UDB$PMMEXIT
      3011**DCL-ENT  3038--CALL     3046--CALL     3124--CALL     3216--CALL
UDCB$
      2993**DCL      3151<<ASSIGN   3152>>IF       3153>>IF       3154>>IF       3157>>ASSIGN
VSETSTA.OSTA.WAS
      2941**DCL      3073<<ASSIGN
VSTA.MSGIDXT
      2928**DCL      2930--REDEF
VSTA.STATION
      2926**DCL      3066<<ASSIGN

PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:48   
      303        1        /*M* OCU$RWUC  M$UC/console interface for operator ghosts */
      304        2        /*T***********************************************************/
      305        3        /*T*                                                         */
      306        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      307        5        /*T*                                                         */
      308        6        /*T***********************************************************/
      309        7        /*X* */
      310        8        /*F* NAME:  OCU$RWUC
      311        9             PURPOSE:  To provide the interface between operator's
      312       10                       consoles and M$UC I/O from operator ghosts.
      313       11             DESCRIPTION:  A KEYIN message is constructed with appropriate
      314       12                           parameters and FCN code, and the message is
      315       13                           written to KEYIN through the Central System
      316       14                           COMGROUP. If the operation is a read, a read
      317       15                           to KEYIN with the station name of the operator
      318       16                           ghost specified is then performed.
      319       17                                                                              */
      320       18        /*D* NAME: OCU$RWUC
      321       19             CALL:  CALL OCU$RWUC (FCN, WAIT, EVENT);
      322       20             INTERFACE:  KCI$RWCGS
      323       21             DESCRIPTION:  A KEYIN message header is set up with a FCN
      324       22                           of OC_RD or OC_WR as is appropriate for
      325       23                           the desired I/O operation.  A parameter
      326       24                           count of two is set in the header, and
      327       25                           the length and value of the first parameter
      328       26                           are set to eight and the account of the
      329       27                           ghost, respectively.
      330       28                           If the operation is a read, the second
      331       29                           parameter is assigned the number of bytes
      332       30                           to be read, whereas if the operation is a write
      333       31                           the second parameter is assigned the message to
      334       32                           be output.
      335       33                           The message is then written to KEYIN through
      336       34                           the Central System COMGROUP.
      337       35                           If the operation is a read, a read to KEYIN is
      338       36                           then performed via M$UC.
      339       37                                                                         */
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:49   
      340       38        OCU$RWUC: PROC(FCN, DVBYTE, VFC, EVENT) ALTRET;
      341       39    1   DCL VFC CHAR(1) UNAL;
      342       40    1   DCL FCN UBIN WORD;
      343       41    1   DCL DVBYTE BIT(9) UNAL;
      344       42    1   DCL EVENT UBIN WORD;
      345       43        /**/
      346       44    1   DCL KCI$RWCGS ENTRY(4) ALTRET;
      347       45    1   DCL HFF$TRAPALT ENTRY ALTRET;
      348       46    1   DCL NKA$EVENT ENTRY(2);
      349       47    1   DCL FMO$GETPFB ENTRY(1);
      350       48    1   DCL DCB$ PTR;
      351       49    1   DCL UB$ PTR;
      352       50    1   DCL SIZE UBIN WORD;
      353       51    1   DCL UBYTES UBIN WORD;
      354       52    1   DCL WAIT UBIN;
      355       53    1   DCL 1 NM,
      356       54    1         2 X CHAR(8) UNAL,
      357       55    1         2 CA REDEF X,
      358       56    1           3 * CHAR(4) UNAL,
      359       57    1           3 * UBIN HALF UNAL,
      360       58    1           3 DDR BIT(18) UNAL;
      361       59        /**/
      362       60    1   DCL STRING CHAR(UBYTES) BASED (UB$);
      363       61        /**/
      364       62    1   DCL B$JIT$ PTR SYMREF;
      365       63        %INCLUDE F_ERRORS_C;
      366      303    1   DCL 1 BDFUNC CONSTANT ALIGNED,
      367      304    1         2 MID BIT(18) UNAL INIT('170325'O),
      368      305    1         2 ERR UBIN(15) UNAL INIT(%E$NKFUNC),
      369      306    1         2 SEV UBIN(3) UNAL INIT(0);
      370      307        /**/
      371      308        %INCLUDE B$JIT_C;
      372      622        %B$JIT0;
      373      711        %U$JIT1X;
      374      714        %M$JIT2X;
      375      717        %F$JIT3;
      376      722        %S$JIT4X;
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:50   
      377      725        %J$JIT5X;
      378      728        %A$JIT6;
      379      738          %INCLUDE F_FPTCODE_C;
      380      774          %INCLUDE NK$LDCT;
      381      876          %INCLUDE CP_6_SUBS;
      382     1416          %INCLUDE NK_LDCT_R;
      383     1425        %INCLUDE OC_SUBS_C;
      384     2156          %INCLUDE OC$MESSHD_C;
      385     2177          %INCLUDE OC_MESSHD_C;
      386     2230             %MACRO F$DCB (BASED=BASED);
      387     2231          %INCLUDE F$DCB;
      388     2280          %MEND;
      389     2281            %F$DCB (BASED="BASED(DCB$)");
      390     2331            %NK$LDCT;
      391     2377            %OC_MESSHD_D (NAME=CMHD,STCLASS=CONSTANT,MSG=OGWR_MSG#,NPARMS=2);
      392     2390    1         2 LEN (0:1) UBIN BYTE UNAL INIT(LENGTHC(OC_MESSHD.RSZ),0);
      393     2391                %OC$MESSHD (NAME=OC_MESSHD,STCLASS="");
      394     2405    1         2 LEN (0:1) UBIN BYTE UNAL,
      395     2406    1         2 RSZ UBIN HALF UNAL,
      396     2407    1         2 MESS CHAR(110) UNAL;
      397     2408        /*
      398     2409                     Begin main
      399     2410                                         */
      400     2411    1           DCB$ = B$JIT$ -> B$JIT.DCB$;
      401     2412    1           UB$ = F$DCB.UB$;
      402     2413    1           UBYTES = F$DCB.UBYTES;
      403     2414    1           F$DCB.UB$ = ADDR (OC_MESSHD);
      404     2415    1           NM.X = NK$LDCT$ (F$DCB.LDCTX) -> NK$LDCT.DEVNM;
      405     2416    1           OC_MESSHD=CMHD;
      406     2417    1           OC_MESSHD.CADDR = NM.CA.DDR;
      407     2418    1           OC_MESSHD.SYSID = B$JIT$ -> B$JIT.SYSID;
      408     2419    2           DO CASE (FCN);
      409     2420    2            CASE (MFC_WRITE,MFC_WRUR,MFC_WRBIN,MFC_WRURUC,MFC_TCTL);
      410     2421    2              OC_MESSHD.FCN = OC_WR;
      411     2422    2              IF UBYTES > SIZEC (OC_MESSHD.MESS) THEN
      412     2423    2                 SIZE = SIZEC (OC_MESSHD.MESS);
      413     2424    2              ELSE
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:51   
      414     2425    2                 SIZE = UBYTES;
      415     2426    2              OC_MESSHD.LEN(1) = SIZE;
      416     2427    2              CALL HFF$TRAPALT ALTRET (BADWBUF);
      417     2428    2              OC_MESSHD.MESS = STRING;
      418     2429    2              F$DCB.UBYTES = SIZE + SIZEC (OC_MESSHD) - SIZEC (OC_MESSHD.MESS);
      419     2430    2              CALL KCI$RWCGS (MFC_WRITE, DVBYTE, VFC, EVENT) ALTRET (ERR);
      420     2431    2            CASE (MFC_READ);
      421     2432    2              OC_MESSHD.FCN = OC_RD;
      422     2433    2              OC_MESSHD.RSZ=UBYTES;
      423     2434    2              CALL FMO$GETPFB (SIZE);
      424     2435    2              OC_MESSHD.PFB=SIZE;
      425     2436    2              F$DCB.UBYTES = SIZEC (OC_MESSHD) - SIZEC (OC_MESSHD.MESS);
      426     2437    2              CALL KCI$RWCGS (MFC_WRITE, 0, 'A', 0) ALTRET(ERR);
      427     2438    2              F$DCB.UB$ = UB$;
      428     2439    2              F$DCB.UBYTES = UBYTES;
      429     2440    2              CALL KCI$RWCGS (MFC_READ, DVBYTE, VFC, EVENT) ALTRET (ERR);
      430     2441    2              B$JIT.INTER=B$JIT.INTER+1;
      431     2442    2            CASE (ELSE);
      432     2443    2              B$JIT.ERR=BDFUNC;
      433     2444        /*E*  ERROR:         OCU-E$NKFUNC-C
      434     2445              MESSAGE:       Illegal function on a console ghost
      435     2446              MESSAGE1:      Console Ghosts cannot perform all functions
      436     2447                             that are legal on a timesharing terminal.  You
      437     2448                             tried an illegal one.  Ignoring this error may
      438     2449                             well be the correct solution for your program.
      439     2450              DESCRIPTION:   Usually a 'get' type terminal control PMME that
      440     2451                             won't make it through KEYIN.                            */
      441     2452    2              ALTRETURN;
      442     2453    2            END;
      443     2454    1           RETURN;
      444     2455    1   BADWBUF:;
      445     2456    1           IF F$DCB.WAIT=1 THEN F$DCB.TYC(1)=%TYC_MTRAP;
      446     2457    1           ELSE IF EVENT=0 THEN F$DCB.TYC(0)=F$DCB.TYC(0)|%TYC_MTRAP;
      447     2458    1              ELSE CALL NKA$EVENT (%TYC_MTRAP,EVENT);
      448     2459    1   ERR:    ALTRETURN;
      449     2460    1   END OCU$RWUC;
      450     2461        /**/
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:52   
      451     2462        /**/
      452     2463        %EOD;

PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:53   
--  Include file information  --

   F$DCB.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure OCU$RWUC.

   Procedure OCU$RWUC requires 145 words for executable code.
   Procedure OCU$RWUC requires 52 words of local(AUTO) storage.

PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:54   

 Object Unit name= OCU$RWUC                                   File name= OCU$KEYIN.:E05TOU
 UTS= JUL 30 '97 04:08:18.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      8     10  OCU$RWUC
    1   Proc  even  none   145    221  OCU$RWUC
    2  RoData even  none     7      7  OCU$RWUC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        4  OCU$RWUC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 HFF$TRAPALT
 yes     yes           Std       4 KCI$RWCGS
         yes           Std       1 FMO$GETPFB
         yes           Std       2 NKA$EVENT
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:55   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                N$DCT$$                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:56   


      303        1        /*M* OCU$RWUC  M$UC/console interface for operator ghosts */
      304        2        /*T***********************************************************/
      305        3        /*T*                                                         */
      306        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      307        5        /*T*                                                         */
      308        6        /*T***********************************************************/
      309        7        /*X* */
      310        8        /*F* NAME:  OCU$RWUC
      311        9             PURPOSE:  To provide the interface between operator's
      312       10                       consoles and M$UC I/O from operator ghosts.
      313       11             DESCRIPTION:  A KEYIN message is constructed with appropriate
      314       12                           parameters and FCN code, and the message is
      315       13                           written to KEYIN through the Central System
      316       14                           COMGROUP. If the operation is a read, a read
      317       15                           to KEYIN with the station name of the operator
      318       16                           ghost specified is then performed.
      319       17                                                                              */
      320       18        /*D* NAME: OCU$RWUC
      321       19             CALL:  CALL OCU$RWUC (FCN, WAIT, EVENT);
      322       20             INTERFACE:  KCI$RWCGS
      323       21             DESCRIPTION:  A KEYIN message header is set up with a FCN
      324       22                           of OC_RD or OC_WR as is appropriate for
      325       23                           the desired I/O operation.  A parameter
      326       24                           count of two is set in the header, and
      327       25                           the length and value of the first parameter
      328       26                           are set to eight and the account of the
      329       27                           ghost, respectively.
      330       28                           If the operation is a read, the second
      331       29                           parameter is assigned the number of bytes
      332       30                           to be read, whereas if the operation is a write
      333       31                           the second parameter is assigned the message to
      334       32                           be output.
      335       33                           The message is then written to KEYIN through
      336       34                           the Central System COMGROUP.
      337       35                           If the operation is a read, a read to KEYIN is
      338       36                           then performed via M$UC.
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:57   
      339       37                                                                         */
      340       38        OCU$RWUC: PROC(FCN, DVBYTE, VFC, EVENT) ALTRET;

     38  1 000000   000000 700200 xent  OCU$RWUC     TSX0  ! X66_AUTO_4
         1 000001   000064 000004                    ZERO    52,4

      341       39    1   DCL VFC CHAR(1) UNAL;
      342       40    1   DCL FCN UBIN WORD;
      343       41    1   DCL DVBYTE BIT(9) UNAL;
      344       42    1   DCL EVENT UBIN WORD;
      345       43        /**/
      346       44    1   DCL KCI$RWCGS ENTRY(4) ALTRET;
      347       45    1   DCL HFF$TRAPALT ENTRY ALTRET;
      348       46    1   DCL NKA$EVENT ENTRY(2);
      349       47    1   DCL FMO$GETPFB ENTRY(1);
      350       48    1   DCL DCB$ PTR;
      351       49    1   DCL UB$ PTR;
      352       50    1   DCL SIZE UBIN WORD;
      353       51    1   DCL UBYTES UBIN WORD;
      354       52    1   DCL WAIT UBIN;
      355       53    1   DCL 1 NM,
      356       54    1         2 X CHAR(8) UNAL,
      357       55    1         2 CA REDEF X,
      358       56    1           3 * CHAR(4) UNAL,
      359       57    1           3 * UBIN HALF UNAL,
      360       58    1           3 DDR BIT(18) UNAL;
      361       59        /**/
      362       60    1   DCL STRING CHAR(UBYTES) BASED (UB$);
      363       61        /**/
      364       62    1   DCL B$JIT$ PTR SYMREF;
      365       63        %INCLUDE F_ERRORS_C;
      366      303    1   DCL 1 BDFUNC CONSTANT ALIGNED,
      367      304    1         2 MID BIT(18) UNAL INIT('170325'O),
      368      305    1         2 ERR UBIN(15) UNAL INIT(%E$NKFUNC),
      369      306    1         2 SEV UBIN(3) UNAL INIT(0);
      370      307        /**/
      371      308        %INCLUDE B$JIT_C;
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:58   
      372      622        %B$JIT0;
      373      711        %U$JIT1X;
      374      714        %M$JIT2X;
      375      717        %F$JIT3;
      376      722        %S$JIT4X;
      377      725        %J$JIT5X;
      378      728        %A$JIT6;
      379      738          %INCLUDE F_FPTCODE_C;
      380      774          %INCLUDE NK$LDCT;
      381      876          %INCLUDE CP_6_SUBS;
      382     1416          %INCLUDE NK_LDCT_R;
      383     1425        %INCLUDE OC_SUBS_C;
      384     2156          %INCLUDE OC$MESSHD_C;
      385     2177          %INCLUDE OC_MESSHD_C;
      386     2230             %MACRO F$DCB (BASED=BASED);
      387     2231          %INCLUDE F$DCB;
      388     2280          %MEND;
      389     2281            %F$DCB (BASED="BASED(DCB$)");
      390     2331            %NK$LDCT;
      391     2377            %OC_MESSHD_D (NAME=CMHD,STCLASS=CONSTANT,MSG=OGWR_MSG#,NPARMS=2);
      392     2390    1         2 LEN (0:1) UBIN BYTE UNAL INIT(LENGTHC(OC_MESSHD.RSZ),0);
      393     2391                %OC$MESSHD (NAME=OC_MESSHD,STCLASS="");
      394     2405    1         2 LEN (0:1) UBIN BYTE UNAL,
      395     2406    1         2 RSZ UBIN HALF UNAL,
      396     2407    1         2 MESS CHAR(110) UNAL;
      397     2408        /*
      398     2409                     Begin main
      399     2410                                         */
      400     2411    1           DCB$ = B$JIT$ -> B$JIT.DCB$;

   2411  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200007 756100                    STQ     DCB$,,AUTO

      401     2412    1           UB$ = F$DCB.UB$;

   2412  1 000005   200007 471500                    LDP1    DCB$,,AUTO
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:59   
         1 000006   100075 236100                    LDQ     61,,PR1
         1 000007   200010 756100                    STQ     UB$,,AUTO

      402     2413    1           UBYTES = F$DCB.UBYTES;

   2413  1 000010   100076 235100                    LDA     62,,PR1
         1 000011   200012 755100                    STA     UBYTES,,AUTO

      403     2414    1           F$DCB.UB$ = ADDR (OC_MESSHD);

   2414  1 000012   200016 633500                    EPPR3   OC_MESSHD,,AUTO
         1 000013   100075 453500                    STP3    61,,PR1

      404     2415    1           NM.X = NK$LDCT$ (F$DCB.LDCTX) -> NK$LDCT.DEVNM;

   2415  1 000014   100051 220100                    LDX0    41,,PR1
         1 000015   000000 474400 xsym               LDP4    N$DCT$$
         1 000016   400000 475510                    LDP5    0,X0,PR4
         1 000017   500002 237100                    LDAQ    2,,PR5
         1 000020   200014 757100                    STAQ    NM,,AUTO

      405     2416    1           OC_MESSHD=CMHD;

   2416  1 000021   000100 100400                    MLR     fill='000'O
         1 000022   000001 000026 0                  ADSC9   CMHD                     cn=0,n=22
         1 000023   200016 000206                    ADSC9   OC_MESSHD,,AUTO          cn=0,n=134

      406     2417    1           OC_MESSHD.CADDR = NM.CA.DDR;

   2417  1 000024   200015 720100                    LXL0    NM+1,,AUTO
         1 000025   200016 740100                    STX0    OC_MESSHD,,AUTO

      407     2418    1           OC_MESSHD.SYSID = B$JIT$ -> B$JIT.SYSID;

   2418  1 000026   000000 721100                    LXL1    0,,PR0
         1 000027   200017 741100                    STX1    OC_MESSHD+1,,AUTO

PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:60   
      408     2419    2           DO CASE (FCN);

   2419  1 000030   200003 475500                    LDP5    @FCN,,AUTO
         1 000031   500000 235100                    LDA     0,,PR5
         1 000032   000016 115007                    CMPA    14,DL
         1 000033   000035 602005 1                  TNC     s:2419+5,AL
         1 000034   000166 710000 1                  TRA     s:2443
         1 000035   000116 710000 1                  TRA     s:2432
         1 000036   000053 710000 1                  TRA     s:2421
         1 000037   000166 710000 1                  TRA     s:2443
         1 000040   000166 710000 1                  TRA     s:2443
         1 000041   000166 710000 1                  TRA     s:2443
         1 000042   000166 710000 1                  TRA     s:2443
         1 000043   000166 710000 1                  TRA     s:2443
         1 000044   000166 710000 1                  TRA     s:2443
         1 000045   000166 710000 1                  TRA     s:2443
         1 000046   000166 710000 1                  TRA     s:2443
         1 000047   000053 710000 1                  TRA     s:2421
         1 000050   000053 710000 1                  TRA     s:2421
         1 000051   000053 710000 1                  TRA     s:2421
         1 000052   000053 710000 1                  TRA     s:2421

      409     2420    2            CASE (MFC_WRITE,MFC_WRUR,MFC_WRBIN,MFC_WRURUC,MFC_TCTL);

      410     2421    2              OC_MESSHD.FCN = OC_WR;

   2421  1 000053   000003 236007                    LDQ     3,DL
         1 000054   200017 552104                    STBQ    OC_MESSHD+1,'04'O,AUTO

      411     2422    2              IF UBYTES > SIZEC (OC_MESSHD.MESS) THEN

   2422  1 000055   200012 235100                    LDA     UBYTES,,AUTO
         1 000056   000157 115007                    CMPA    111,DL
         1 000057   000063 602000 1                  TNC     s:2425

      412     2423    2                 SIZE = SIZEC (OC_MESSHD.MESS);

PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:61   
   2423  1 000060   000156 235007                    LDA     110,DL
         1 000061   200011 755100                    STA     SIZE,,AUTO
         1 000062   000064 710000 1                  TRA     s:2426

      413     2424    2              ELSE
      414     2425    2                 SIZE = UBYTES;

   2425  1 000063   200011 755100                    STA     SIZE,,AUTO

      415     2426    2              OC_MESSHD.LEN(1) = SIZE;

   2426  1 000064   200011 236100                    LDQ     SIZE,,AUTO
         1 000065   000022 736000                    QLS     18
         1 000066   200023 552120                    STBQ    OC_MESSHD+5,'20'O,AUTO

      416     2427    2              CALL HFF$TRAPALT ALTRET (BADWBUF);

   2427  1 000067   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000070   000000 701000 xent               TSX1    HFF$TRAPALT
         1 000071   000172 702000 1                  TSX2    BADWBUF

      417     2428    2              OC_MESSHD.MESS = STRING;

   2428  1 000072   200010 470500                    LDP0    UB$,,AUTO
         1 000073   200012 720100                    LXL0    UBYTES,,AUTO
         1 000074   040100 100540                    MLR     fill='040'O
         1 000075   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 000076   200024 000156                    ADSC9   OC_MESSHD+6,,AUTO        cn=0,n=110

      418     2429    2              F$DCB.UBYTES = SIZE + SIZEC (OC_MESSHD) - SIZEC (OC_MESSHD.MESS);

   2429  1 000077   200007 471500                    LDP1    DCB$,,AUTO
         1 000100   200011 235100                    LDA     SIZE,,AUTO
         1 000101   000030 035007                    ADLA    24,DL
         1 000102   100076 755100                    STA     62,,PR1

      419     2430    2              CALL KCI$RWCGS (MFC_WRITE, DVBYTE, VFC, EVENT) ALTRET (ERR);
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:62   

   2430  1 000103   200006 236100                    LDQ     @EVENT,,AUTO
         1 000104   200005 235100                    LDA     @VFC,,AUTO
         1 000105   200062 757100                    STAQ    OC_MESSHD+36,,AUTO
         1 000106   200004 236100                    LDQ     @DVBYTE,,AUTO
         1 000107   000000 235000 2                  LDA     0
         1 000110   200060 757100                    STAQ    OC_MESSHD+34,,AUTO
         1 000111   200060 630500                    EPPR0   OC_MESSHD+34,,AUTO
         1 000112   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000113   000000 701000 xent               TSX1    KCI$RWCGS
         1 000114   000220 702000 1                  TSX2    ERR
         1 000115   000171 710000 1                  TRA     s:2454

      420     2431    2            CASE (MFC_READ);

      421     2432    2              OC_MESSHD.FCN = OC_RD;

   2432  1 000116   000000 236003                    LDQ     0,DU
         1 000117   200017 552104                    STBQ    OC_MESSHD+1,'04'O,AUTO

      422     2433    2              OC_MESSHD.RSZ=UBYTES;

   2433  1 000120   200012 721100                    LXL1    UBYTES,,AUTO
         1 000121   200023 441100                    SXL1    OC_MESSHD+5,,AUTO

      423     2434    2              CALL FMO$GETPFB (SIZE);

   2434  1 000122   200011 636500                    EPPR6   SIZE,,AUTO
         1 000123   200060 456500                    STP6    OC_MESSHD+34,,AUTO
         1 000124   200060 630500                    EPPR0   OC_MESSHD+34,,AUTO
         1 000125   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000126   000000 701000 xent               TSX1    FMO$GETPFB
         1 000127   000000 011000                    NOP     0

      424     2435    2              OC_MESSHD.PFB=SIZE;

   2435  1 000130   200011 236100                    LDQ     SIZE,,AUTO
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:63   
         1 000131   000033 736000                    QLS     27
         1 000132   200020 552140                    STBQ    OC_MESSHD+2,'40'O,AUTO

      425     2436    2              F$DCB.UBYTES = SIZEC (OC_MESSHD) - SIZEC (OC_MESSHD.MESS);

   2436  1 000133   000030 235007                    LDA     24,DL
         1 000134   200007 470500                    LDP0    DCB$,,AUTO
         1 000135   000076 755100                    STA     62,,PR0

      426     2437    2              CALL KCI$RWCGS (MFC_WRITE, 0, 'A', 0) ALTRET(ERR);

   2437  1 000136   000002 630400 2                  EPPR0   2
         1 000137   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000140   000000 701000 xent               TSX1    KCI$RWCGS
         1 000141   000220 702000 1                  TSX2    ERR

      427     2438    2              F$DCB.UB$ = UB$;

   2438  1 000142   200010 236100                    LDQ     UB$,,AUTO
         1 000143   200007 470500                    LDP0    DCB$,,AUTO
         1 000144   000075 756100                    STQ     61,,PR0

      428     2439    2              F$DCB.UBYTES = UBYTES;

   2439  1 000145   200012 235100                    LDA     UBYTES,,AUTO
         1 000146   000076 755100                    STA     62,,PR0

      429     2440    2              CALL KCI$RWCGS (MFC_READ, DVBYTE, VFC, EVENT) ALTRET (ERR);

   2440  1 000147   200006 236100                    LDQ     @EVENT,,AUTO
         1 000150   200005 235100                    LDA     @VFC,,AUTO
         1 000151   200062 757100                    STAQ    OC_MESSHD+36,,AUTO
         1 000152   200004 236100                    LDQ     @DVBYTE,,AUTO
         1 000153   000003 235000 2                  LDA     3
         1 000154   200060 757100                    STAQ    OC_MESSHD+34,,AUTO
         1 000155   200060 630500                    EPPR0   OC_MESSHD+34,,AUTO
         1 000156   000022 631400 xsym               EPPR1   B_VECTNIL+18
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:64   
         1 000157   000000 701000 xent               TSX1    KCI$RWCGS
         1 000160   000220 702000 1                  TSX2    ERR

      430     2441    2              B$JIT.INTER=B$JIT.INTER+1;

   2441  1 000161   000000 470400 xsym               LDP0    B$JIT$
         1 000162   000325 720100                    LXL0    213,,PR0
         1 000163   000001 621010                    EAX1    1,X0
         1 000164   000325 441100                    SXL1    213,,PR0
         1 000165   000171 710000 1                  TRA     s:2454

      431     2442    2            CASE (ELSE);

      432     2443    2              B$JIT.ERR=BDFUNC;

   2443  1 000166   000000 236000 0                  LDQ     BDFUNC
         1 000167   000012 756100                    STQ     10,,PR0

      433     2444        /*E*  ERROR:         OCU-E$NKFUNC-C
      434     2445              MESSAGE:       Illegal function on a console ghost
      435     2446              MESSAGE1:      Console Ghosts cannot perform all functions
      436     2447                             that are legal on a timesharing terminal.  You
      437     2448                             tried an illegal one.  Ignoring this error may
      438     2449                             well be the correct solution for your program.
      439     2450              DESCRIPTION:   Usually a 'get' type terminal control PMME that
      440     2451                             won't make it through KEYIN.                            */
      441     2452    2              ALTRETURN;

   2452  1 000170   000000 702200 xent               TSX2  ! X66_AALT

      442     2453    2            END;

      443     2454    1           RETURN;

   2454  1 000171   000000 702200 xent               TSX2  ! X66_ARET

   2442  1 000172                       BADWBUF      null
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:65   
      444     2455    1   BADWBUF:;
      445     2456    1           IF F$DCB.WAIT=1 THEN F$DCB.TYC(1)=%TYC_MTRAP;

   2456  1 000172   200007 470500                    LDP0    DCB$,,AUTO
         1 000173   000064 236100                    LDQ     52,,PR0
         1 000174   000020 376007                    ANQ     16,DL
         1 000175   000020 116007                    CMPQ    16,DL
         1 000176   000202 601000 1                  TNZ     s:2457

   2456  1 000177   000007 236000 0                  LDQ     CMHD+6
         1 000200   000002 756100                    STQ     2,,PR0
         1 000201   000220 710000 1                  TRA     ERR

      446     2457    1           ELSE IF EVENT=0 THEN F$DCB.TYC(0)=F$DCB.TYC(0)|%TYC_MTRAP;

   2457  1 000202   200006 471500                    LDP1    @EVENT,,AUTO
         1 000203   100000 235100                    LDA     0,,PR1
         1 000204   000211 601000 1                  TNZ     s:2458

   2457  1 000205   000001 236100                    LDQ     1,,PR0
         1 000206   000007 276000 0                  ORQ     CMHD+6
         1 000207   000001 756100                    STQ     1,,PR0
         1 000210   000220 710000 1                  TRA     ERR

      447     2458    1              ELSE CALL NKA$EVENT (%TYC_MTRAP,EVENT);

   2458  1 000211   200006 236100                    LDQ     @EVENT,,AUTO
         1 000212   000006 235000 2                  LDA     6
         1 000213   200060 757100                    STAQ    OC_MESSHD+34,,AUTO
         1 000214   200060 630500                    EPPR0   OC_MESSHD+34,,AUTO
         1 000215   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000216   000000 701000 xent               TSX1    NKA$EVENT
         1 000217   000000 011000                    NOP     0

      448     2459    1   ERR:    ALTRETURN;

   2459  1 000220   000000 702200 xent  ERR          TSX2  ! X66_AALT
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:66   

BDFUNC
 Sect OctLoc
   0     000   170325 013630                                                    x...

CMHD
 Sect OctLoc
   0     001   000000 000766   ****** 002003   000*** ******   040040 040040    ............
   0     005   040040 040040   002000 ******                                        ....

(unnamed)
 Sect OctLoc
   0     007   000100 000000                                                    .@..

(unnamed)
 Sect OctLoc
   2     000   000003 006000   101040 040040   000003 006000   000002 006000    ....A   ........
   2     004   000001 006000   000002 006000   000007 006000                    ............
      449     2460    1   END OCU$RWUC;
      450     2461        /**/
      451     2462        /**/
      452     2463        %EOD;

PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:67   
--  Include file information  --

   F$DCB.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure OCU$RWUC.
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:68   

 **** Variables and constants ****

  ****  Section 000 RoData OCU$RWUC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 BDFUNC                     1-0-0/c STRC(198)   r     1 CMHD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DVBYTE                    6-0-0/w PTR         r     1 @EVENT
     3-0-0/w PTR         r     1 @FCN                       5-0-0/w PTR         r     1 @VFC
     7-0-0/w PTR         r     1 DCB$                      *0-0-0/b BIT (9)     r     1 DVBYTE
    *0-0-0/w UBIN        r     1 EVENT                     *0-0-0/w UBIN        r     1 FCN
    14-0-0/c STRC(72)    r     1 NM                        16-0-0/c STRC(1206)  r     1 OC_MESSHD
    11-0-0/w UBIN        r     1 SIZE                      10-0-0/w PTR         r     1 UB$
    12-0-0/w UBIN        r     1 UBYTES                    *0-0-0/c CHAR        r     1 VFC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 N$DCT$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(864)   r     1 NK$LDCT
     0-0-0/w PTR         r     1 NK$LDCT$(0:0)
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:69   
     0-0-0/c ACHR        r     1 STRING


   Procedure OCU$RWUC requires 145 words for executable code.
   Procedure OCU$RWUC requires 52 words of local(AUTO) storage.
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:70   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:71   
          MINI XREF LISTING

B$JIT.DCB$
       718**DCL      2411>>ASSIGN
B$JIT.ERR
       628**DCL      2443<<ASSIGN
B$JIT.ERR.MID
       629**DCL       629--REDEF
B$JIT.INTER
       729**DCL      2441<<ASSIGN   2441>>ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
       733**DCL       733--REDEF     734--REDEF
B$JIT.SYSID
       628**DCL      2418>>ASSIGN
B$JIT.TSLINE
       731**DCL       732--REDEF
B$JIT$
        62**DCL       623--IMP-PTR  2411>>ASSIGN   2418>>ASSIGN   2441>>ASSIGN   2441>>ASSIGN   2443>>ASSIGN
BADWBUF
      2442**LABEL    2427--CALLALT
BDFUNC
       303**DCL      2443>>ASSIGN
CMHD
      2378**DCL      2416>>ASSIGN
CMHD.FLAGS
      2385**DCL      2386--REDEF
CMHD.MSGID
      2381**DCL      2382--REDEF
DCB$
        48**DCL      2282--IMP-PTR  2411<<ASSIGN   2412>>ASSIGN   2413>>ASSIGN   2414>>ASSIGN   2415>>ASSIGN
      2429>>ASSIGN   2436>>ASSIGN   2438>>ASSIGN   2439>>ASSIGN   2456>>IF       2456>>ASSIGN   2457>>ASSIGN
      2457>>ASSIGN
DVBYTE
        41**DCL        38--PROC     2430<>CALL     2440<>CALL
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:72   
ERR
      2459**LABEL    2430--CALLALT  2437--CALLALT  2440--CALLALT
EVENT
        42**DCL        38--PROC     2430<>CALL     2440<>CALL     2457>>IF       2458<>CALL
F$DCB.ACTPOS
      2307**DCL      2307--REDEF
F$DCB.ARS
      2282**DCL      2282--REDEF
F$DCB.ATTR
      2300**DCL      2301--REDEF
F$DCB.BORROW
      2315**DCL      2315--REDEF    2315--REDEF    2315--REDEF
F$DCB.DCBNAME.L
      2329**DCL      2329--IMP-SIZ
F$DCB.EOMCHAR
      2286**DCL      2286--REDEF
F$DCB.FLDID
      2310**DCL      2310--REDEF
F$DCB.FORM$
      2304**DCL      2304--REDEF
F$DCB.FSECT
      2320**DCL      2320--REDEF
F$DCB.FSN
      2297**DCL      2297--REDEF    2297--REDEF    2298--REDEF
F$DCB.HEADER$
      2303**DCL      2303--REDEF
F$DCB.IXTNSIZE
      2301**DCL      2301--REDEF
F$DCB.LASTSTA$
      2291**DCL      2291--REDEF
F$DCB.LDCTX
      2304**DCL      2415>>ASSIGN
F$DCB.LVL
      2316**DCL      2316--REDEF
F$DCB.NAME.C
      2291**DCL      2291--REDEF
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:73   
F$DCB.NOEOF
      2312**DCL      2312--REDEF
F$DCB.NRECS
      2302**DCL      2302--REDEF
F$DCB.NRECX
      2321**DCL      2321--REDEF
F$DCB.OHDR
      2313**DCL      2313--REDEF
F$DCB.ORG
      2296**DCL      2296--REDEF
F$DCB.PRECNO
      2319**DCL      2319--REDEF
F$DCB.RCSZ
      2324**DCL      2324--REDEF
F$DCB.RES
      2292**DCL      2292--REDEF
F$DCB.SETX
      2304**DCL      2304--REDEF
F$DCB.TAB$
      2303**DCL      2304--REDEF
F$DCB.TDA
      2318**DCL      2318--REDEF
F$DCB.TYC
      2282**DCL      2456<<ASSIGN   2457<<ASSIGN   2457>>ASSIGN
F$DCB.UB$
      2320**DCL      2412>>ASSIGN   2414<<ASSIGN   2438<<ASSIGN
F$DCB.UBYTES
      2320**DCL      2413>>ASSIGN   2429<<ASSIGN   2436<<ASSIGN   2439<<ASSIGN
F$DCB.WAIT
      2314**DCL      2456>>IF
F$DCB.WSN
      2293**DCL      2293--REDEF
FCN
        40**DCL        38--PROC     2419>>DOCASE
FMO$GETPFB
        47**DCL-ENT  2434--CALL
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:74   
HFF$TRAPALT
        45**DCL-ENT  2427--CALL
KCI$RWCGS
        44**DCL-ENT  2430--CALL     2437--CALL     2440--CALL
N$DCT$$
      1423**DCL      1423--IMP-PTR  2415>>ASSIGN
NK$LDCT.DDT$
      2346**DCL      2346--REDEF
NK$LDCT.DEVNM
      2346**DCL      2415>>ASSIGN
NK$LDCT.IOQ$
      2345**DCL      2346--REDEF
NK$LDCT.LDCTX
      2347**DCL      2347--REDEF
NK$LDCT.LKFLG.ABORTED
      2359**DCL      2360--REDEF
NK$LDCT.RLCID.LDCTX
      2369**DCL      2369--REDEF
NK$LDCT.STA$
      2365**DCL      2366--REDEF
NK$LDCT.SYMB$
      2344**DCL      2344--REDEF    2344--REDEF    2345--REDEF
NK$LDCT$
      1423**DCL      2415>>ASSIGN
NKA$EVENT
        46**DCL-ENT  2458--CALL
NM.CA.DDR
        58**DCL      2417>>ASSIGN
NM.X
        54**DCL        55--REDEF    2415<<ASSIGN
OC_MESSHD
      2392**DCL      2414--ASSIGN   2416<<ASSIGN   2429--ASSIGN   2436--ASSIGN
OC_MESSHD.CADDR
      2393**DCL      2417<<ASSIGN
OC_MESSHD.FCN
      2398**DCL      2421<<ASSIGN   2432<<ASSIGN
PL6.E3A0      #002=OCU$RWUC File=OCU$KEYIN.:E05TSI                               WED 07/30/97 04:08 Page:75   
OC_MESSHD.FLAGS
      2399**DCL      2400--REDEF
OC_MESSHD.LEN
      2405**DCL      2426<<ASSIGN
OC_MESSHD.MESS
      2407**DCL      2422--IF       2423--ASSIGN   2428<<ASSIGN   2429--ASSIGN   2436--ASSIGN
OC_MESSHD.MSGID
      2395**DCL      2396--REDEF
OC_MESSHD.PFB
      2400**DCL      2435<<ASSIGN
OC_MESSHD.RSZ
      2406**DCL      2390--DCLINIT  2433<<ASSIGN
OC_MESSHD.SYSID
      2396**DCL      2418<<ASSIGN
OC_MESSHD.WSN
      2402**DCL      2403--REDEF
SIZE
        50**DCL      2423<<ASSIGN   2425<<ASSIGN   2426>>ASSIGN   2429>>ASSIGN   2434<>CALL     2435>>ASSIGN
STRING
        60**DCL      2428>>ASSIGN
UB$
        49**DCL        60--IMP-PTR  2412<<ASSIGN   2428>>ASSIGN   2438>>ASSIGN
UBYTES
        51**DCL        60--IMP-SIZ  2413<<ASSIGN   2422>>IF       2425>>ASSIGN   2428>>ASSIGN   2433>>ASSIGN
      2439>>ASSIGN
VFC
        39**DCL        38--PROC     2430<>CALL     2440<>CALL

PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:76   
      453        1        /*T***********************************************************/
      454        2        /*T*                                                         */
      455        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      456        4        /*T*                                                         */
      457        5        /*T***********************************************************/
      458        6        /**/
      459        7        /**/
      460        8        OCU$OCMSG: PROC (FPTCODE);
      461        9        /**/
      462       10        /**/
      463       11        %INCLUDE B$JIT_C;
      464      325        %INCLUDE UM_ERRORS_C;
      465      359        %B$JIT0;
      466      448        %U$JIT1X;
      467      451        %M$JIT2X;
      468      454        %F$JIT3X;
      469      457        %S$JIT4X;
      470      460        %J$JIT5X;
      471      463        %A$JIT6;
      472      473        %INCLUDE F$DCB;
      473      522        %INCLUDE UM$CP6V_C;
      474      709        %INCLUDE OCU_DATA_R;
      475      720        %INCLUDE CP_6_SUBS;
      476     1260        /**/
      477     1261        %FPT$OCMSG_V;
      478     1264        /**/
      479     1265        /**/
      480     1266    1   DCL FPTCODE UBIN WORD;
      481     1267    1   DCL OCMLNG (0:13) UBIN BYTE CALIGNED CONSTANT INIT(LENGTHC(OCMSG.ACCT),
      482     1268    1                                                 LENGTHC(OCMSG.UNAME),
      483     1269    1                                                 LENGTHC(OCMSG.MODE),
      484     1270    1                                                 LENGTHC(OCMSG.USR#),
      485     1271    1                                                 LENGTHC(OCMSG.SUBC),
      486     1272    1                                                 LENGTHC(OCMSG.FEP#),
      487     1273    1                                                 LENGTHC(OCMSG.PORT#),
      488     1274    1                                                 LENGTHC(OCMSG.NODENAME#),
      489     1275    1                                                 LENGTHC(OCMSG.LEV#),
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:77   
      490     1276    1                                                 LENGTHC(OCMSG.TTYP#),
      491     1277    1                                                 LENGTHC(OCMSG.SUBDEV#),
      492     1278    1                                                 LENGTHC(OCMSG.SUBSUBDEV#),
      493     1279    1                                                  0,
      494     1280    1                                                  0);
      495     1281    1   DCL OCLENS (0:13) UBIN BYTE CALIGNED;   /* IN AUTO                            */
      496     1282    1   DCL 1 OCMSG ALIGNED,
      497     1283    1         2 ACCT CHAR(8),
      498     1284    1         2 UNAME CHAR(12),
      499     1285    1         2 MODE UBIN(9) UNAL,
      500     1286    1         2 USR# UBIN(9) UNAL,
      501     1287    1         2 SUBC UBIN(9) UNAL,
      502     1288    1         2 FEP# UBIN(9) UNAL,
      503     1289    1         2 PORT# UBIN(18) UNAL,
      504     1290    1         2 NODENAME# CHAR(8) UNAL,
      505     1291    1         2 LEV# UBIN(9) UNAL,
      506     1292    1         2 TTYP# UBIN(9) UNAL,
      507     1293    1         2 SUBDEV# UBIN(18) UNAL,
      508     1294    1         2 SUBSUBDEV# UBIN(18) CALIGNED,
      509     1295    1         2 JLS_TEXT CHAR(64) CALIGNED;     /* You're immortal, Lance             */
      510     1296    1   DCL CADDR BIT(36) ALIGNED;
      511     1297    1   DCL MODE REDEF CADDR UBIN WORD;
      512     1298    1   DCL FEX UBIN;
      513     1299    1   DCL TEMP$ PTR;
      514     1300    1   DCL CHAR_TEMPLATE CHAR(FEX) BASED(TEMP$);
      515     1301    1   DCL B$JIT$ PTR SYMREF;
      516     1302    1   DCL S_CUN UBIN WORD SYMREF;
      517     1303    1   DCL B$PS0$ PTR SYMREF;
      518     1304    1   DCL B$PS1$ PTR SYMREF;
      519     1305    1   DCL B$PS2$ PTR SYMREF;
      520     1306    1   DCL OCI$MK_WR ENTRY(7);
      521     1307    1   DCL KIN$CONV_NODE ENTRY(3) ALTRET;
      522     1308    1   DCL HFF$DSIZ ENTRY(2) ALTRET;
      523     1309    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      524     1310        /**/
      525     1311        /**/
      526     1312    1           OCMSG.ACCT=B$JIT.ACCN;
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:78   
      527     1313    1           OCMSG.UNAME=B$JIT.UNAME;
      528     1314    1           MODE=B$JIT.MODE;
      529     1315    1           OCMSG.MODE=MODE;
      530     1316    2           IF MODE=%M_INT# THEN DO;
      531     1317    2              IF DCBADDR(%M$UC#)->F$DCB.ASN~=%DEVICE# THEN OCMSG.MODE=5;
      532     1318    3              ELSE DO;
      533     1319    3                 OCMSG.FEP#=B$JIT.TSLINE.FEX;
      534     1320    3                 OCMSG.PORT#=B$JIT.TSLINE.PORT;
      535     1321    3                 FEX = OCMSG.FEP#;
      536     1322    3                 CALL KIN$CONV_NODE (OCMSG.NODENAME#,FEX);
      537     1323    3                 OCMSG.LEV# = B$JIT.TSLINE.LEV;
      538     1324    3                 OCMSG.TTYP# = B$JIT.TSLINE.TTYP;
      539     1325    3                 OCMSG.SUBDEV# = B$JIT.TSLINE.SUBDEVICE;
      540     1326    3                 OCMSG.SUBSUBDEV# = B$JIT.TSLINE.SUBSUBDEVICE;
      541     1327    3                 END;
      542     1328    2              END;
      543     1329    1           OCLENS = OCMLNG;
      544     1330    1           TEMP$ = ADDR(OCMSG.JLS_TEXT);
      545     1331    1           CALL HFF$NILERASE(1)
      546     1332    1           WHENRETURN
      547     1333    2           DO;
      548     1334    2              CALL HFF$DSIZ(1,FEX);
      549     1335    2              IF FEX>31
      550     1336    2              THEN
      551     1337    3              DO;
      552     1338    3                 B$JIT.ERR=OCU_ERR;
      553     1339    3                 B$JIT.ERR.CODE=%E$BADOCMSG1;
      554     1340        /*E* ERROR:         OCU-E$BADOCMSG1-E
      555     1341             MESSAGE:       M$OCMSG user text 1 too large
      556     1342             MESSAGE1:      The maximum number of characters that can be passed
      557     1343                            through an M$OCMSG user text field is 31.
      558     1344        */
      559     1345    3                 RETURN;
      560     1346    3                 END;
      561     1347    2              OCLENS(12)=FEX;
      562     1348    2              TEMP$ -> CHAR_TEMPLATE = B$PS1$-> CHAR_TEMPLATE;
      563     1349    2              TEMP$ = PINCRC(TEMP$,FEX);
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:79   
      564     1350    2              END;
      565     1351    1           WHENALTRETURN
      566     1352    2           DO;
      567     1353    2              OCLENS(12) = 0;
      568     1354    2              END;
      569     1355
      570     1356    1           CALL HFF$NILERASE(2)
      571     1357    1           WHENRETURN
      572     1358    2           DO;
      573     1359    2              CALL HFF$DSIZ(2,FEX);
      574     1360    2              IF FEX>31
      575     1361    2              THEN
      576     1362    3              DO;
      577     1363    3                 B$JIT.ERR=OCU_ERR;
      578     1364    3                 B$JIT.ERR.CODE=%E$BADOCMSG2;
      579     1365        /*E* ERROR:         OCU-E$BADOCMSG2-E
      580     1366             MESSAGE:       M$OCMSG user text 2 too large
      581     1367             MESSAGE2:      The maximum number of characters that can be passed
      582     1368                            through an M$OCMSG user text field is 31.
      583     1369        */
      584     1370    3                 RETURN;
      585     1371    3                 END;
      586     1372
      587     1373    2              OCLENS(13)=FEX;
      588     1374    2              TEMP$ -> CHAR_TEMPLATE = B$PS2$-> CHAR_TEMPLATE;
      589     1375    2              END;
      590     1376    1           WHENALTRETURN
      591     1377    2           DO;
      592     1378    2              OCLENS(13) = 0;
      593     1379    2              END;
      594     1380    1           OCMSG.USR#=S_CUN;
      595     1381    1           OCMSG.SUBC=B$PS0$->FPT$OCMSG_V.SUBC;
      596     1382    1           CADDR=OCU_CADDR(B$PS0$->FPT$OCMSG_V.OCTYPE);
      597     1383    1           CALL OCI$MK_WR (CADDR,B$PS0$->FPT$OCMSG_V.MSG,
      598     1384    1             LENGTHC(OCLENS),OCLENS,OCMSG,,B$JIT.WOO);
      599     1385    1           RETURN;
      600     1386        /**/
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:80   
      601     1387    1   END;
      602     1388        /**/
      603     1389        %EOD;

PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:81   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   OCU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   UM$CP6V_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   UM_ERRORS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure OCU$OCMSG.

   Procedure OCU$OCMSG requires 169 words for executable code.
   Procedure OCU$OCMSG requires 46 words of local(AUTO) storage.

PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:82   

 Object Unit name= OCU$OCMSG                                  File name= OCU$KEYIN.:E05TOU
 UTS= JUL 30 '97 04:08:44.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      4      4  OCU$OCMSG
    1   Proc  even  none   169    251  OCU$OCMSG
    2  RoData even  none     7      7  OCU$OCMSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  OCU$OCMSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 KIN$CONV_NODE
 yes     yes           Std       1 HFF$NILERASE
 yes     yes           Std       2 HFF$DSIZ
         yes           Std       7 OCI$MK_WR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:83   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    OCU_ERR                          r    OCU_CADDR                             B$JIT$
     S_CUN                                 B$PS0$                                B$PS1$
     B$PS2$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:84   


      453        1        /*T***********************************************************/
      454        2        /*T*                                                         */
      455        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      456        4        /*T*                                                         */
      457        5        /*T***********************************************************/
      458        6        /**/
      459        7        /**/
      460        8        OCU$OCMSG: PROC (FPTCODE);

      8  1 000000   000000 700200 xent  OCU$OCMSG    TSX0  ! X66_AUTO_1
         1 000001   000056 000001                    ZERO    46,1

      461        9        /**/
      462       10        /**/
      463       11        %INCLUDE B$JIT_C;
      464      325        %INCLUDE UM_ERRORS_C;
      465      359        %B$JIT0;
      466      448        %U$JIT1X;
      467      451        %M$JIT2X;
      468      454        %F$JIT3X;
      469      457        %S$JIT4X;
      470      460        %J$JIT5X;
      471      463        %A$JIT6;
      472      473        %INCLUDE F$DCB;
      473      522        %INCLUDE UM$CP6V_C;
      474      709        %INCLUDE OCU_DATA_R;
      475      720        %INCLUDE CP_6_SUBS;
      476     1260        /**/
      477     1261        %FPT$OCMSG_V;
      478     1264        /**/
      479     1265        /**/
      480     1266    1   DCL FPTCODE UBIN WORD;
      481     1267    1   DCL OCMLNG (0:13) UBIN BYTE CALIGNED CONSTANT INIT(LENGTHC(OCMSG.ACCT),
      482     1268    1                                                 LENGTHC(OCMSG.UNAME),
      483     1269    1                                                 LENGTHC(OCMSG.MODE),
      484     1270    1                                                 LENGTHC(OCMSG.USR#),
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:85   
      485     1271    1                                                 LENGTHC(OCMSG.SUBC),
      486     1272    1                                                 LENGTHC(OCMSG.FEP#),
      487     1273    1                                                 LENGTHC(OCMSG.PORT#),
      488     1274    1                                                 LENGTHC(OCMSG.NODENAME#),
      489     1275    1                                                 LENGTHC(OCMSG.LEV#),
      490     1276    1                                                 LENGTHC(OCMSG.TTYP#),
      491     1277    1                                                 LENGTHC(OCMSG.SUBDEV#),
      492     1278    1                                                 LENGTHC(OCMSG.SUBSUBDEV#),
      493     1279    1                                                  0,
      494     1280    1                                                  0);
      495     1281    1   DCL OCLENS (0:13) UBIN BYTE CALIGNED;   /* IN AUTO                            */
      496     1282    1   DCL 1 OCMSG ALIGNED,
      497     1283    1         2 ACCT CHAR(8),
      498     1284    1         2 UNAME CHAR(12),
      499     1285    1         2 MODE UBIN(9) UNAL,
      500     1286    1         2 USR# UBIN(9) UNAL,
      501     1287    1         2 SUBC UBIN(9) UNAL,
      502     1288    1         2 FEP# UBIN(9) UNAL,
      503     1289    1         2 PORT# UBIN(18) UNAL,
      504     1290    1         2 NODENAME# CHAR(8) UNAL,
      505     1291    1         2 LEV# UBIN(9) UNAL,
      506     1292    1         2 TTYP# UBIN(9) UNAL,
      507     1293    1         2 SUBDEV# UBIN(18) UNAL,
      508     1294    1         2 SUBSUBDEV# UBIN(18) CALIGNED,
      509     1295    1         2 JLS_TEXT CHAR(64) CALIGNED;     /* You're immortal, Lance             */
      510     1296    1   DCL CADDR BIT(36) ALIGNED;
      511     1297    1   DCL MODE REDEF CADDR UBIN WORD;
      512     1298    1   DCL FEX UBIN;
      513     1299    1   DCL TEMP$ PTR;
      514     1300    1   DCL CHAR_TEMPLATE CHAR(FEX) BASED(TEMP$);
      515     1301    1   DCL B$JIT$ PTR SYMREF;
      516     1302    1   DCL S_CUN UBIN WORD SYMREF;
      517     1303    1   DCL B$PS0$ PTR SYMREF;
      518     1304    1   DCL B$PS1$ PTR SYMREF;
      519     1305    1   DCL B$PS2$ PTR SYMREF;
      520     1306    1   DCL OCI$MK_WR ENTRY(7);
      521     1307    1   DCL KIN$CONV_NODE ENTRY(3) ALTRET;
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:86   
      522     1308    1   DCL HFF$DSIZ ENTRY(2) ALTRET;
      523     1309    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      524     1310        /**/
      525     1311        /**/
      526     1312    1           OCMSG.ACCT=B$JIT.ACCN;

   1312  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   040100 100500                    MLR     fill='040'O
         1 000004   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         1 000005   200010 000010                    ADSC9   OCMSG,,AUTO              cn=0,n=8

      527     1313    1           OCMSG.UNAME=B$JIT.UNAME;

   1313  1 000006   040100 100500                    MLR     fill='040'O
         1 000007   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         1 000010   200012 000014                    ADSC9   OCMSG+2,,AUTO            cn=0,n=12

      528     1314    1           MODE=B$JIT.MODE;

   1314  1 000011   000000 236100                    LDQ     0,,PR0
         1 000012   000040 772000                    QRL     32
         1 000013   200042 756100                    STQ     CADDR,,AUTO

      529     1315    1           OCMSG.MODE=MODE;

   1315  1 000014   000033 736000                    QLS     27
         1 000015   200015 552140                    STBQ    OCMSG+5,'40'O,AUTO

      530     1316    2           IF MODE=%M_INT# THEN DO;

   1316  1 000016   200042 235100                    LDA     CADDR,,AUTO
         1 000017   000003 115007                    CMPA    3,DL
         1 000020   000070 601000 1                  TNZ     s:1329

      531     1317    2              IF DCBADDR(%M$UC#)->F$DCB.ASN~=%DEVICE# THEN OCMSG.MODE=5;

   1317  1 000021   000000 471400 2                  LDP1    0
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:87   
         1 000022   100000 473500                    LDP3    0,,PR1
         1 000023   300003 474500                    LDP4    3,,PR3
         1 000024   400032 236100                    LDQ     26,,PR4
         1 000025   777000 376007                    ANQ     -512,DL
         1 000026   003000 116007                    CMPQ    1536,DL
         1 000027   000033 600000 1                  TZE     s:1319

   1317  1 000030   005000 236003                    LDQ     2560,DU
         1 000031   200015 552140                    STBQ    OCMSG+5,'40'O,AUTO
         1 000032   000070 710000 1                  TRA     s:1329

      532     1318    3              ELSE DO;

      533     1319    3                 OCMSG.FEP#=B$JIT.TSLINE.FEX;

   1319  1 000033   000337 236100                    LDQ     223,,PR0
         1 000034   000033 772000                    QRL     27
         1 000035   200015 552104                    STBQ    OCMSG+5,'04'O,AUTO

      534     1320    3                 OCMSG.PORT#=B$JIT.TSLINE.PORT;

   1320  1 000036   000337 720100                    LXL0    223,,PR0
         1 000037   200016 740100                    STX0    OCMSG+6,,AUTO

      535     1321    3                 FEX = OCMSG.FEP#;

   1321  1 000040   200015 236100                    LDQ     OCMSG+5,,AUTO
         1 000041   000777 376007                    ANQ     511,DL
         1 000042   200043 756100                    STQ     FEX,,AUTO

      536     1322    3                 CALL KIN$CONV_NODE (OCMSG.NODENAME#,FEX);

   1322  1 000043   200043 635500                    EPPR5   FEX,,AUTO
         1 000044   200047 455500                    STP5    TEMP$+3,,AUTO
         1 000045   200050 452500                    STP2    TEMP$+4,,AUTO
         1 000046   200050 236100                    LDQ     TEMP$+4,,AUTO
         1 000047   000001 036000 2                  ADLQ    1
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:88   
         1 000050   200046 756100                    STQ     TEMP$+2,,AUTO
         1 000051   200046 630500                    EPPR0   TEMP$+2,,AUTO
         1 000052   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000053   000000 701000 xent               TSX1    KIN$CONV_NODE
         1 000054   000000 011000                    NOP     0

      537     1323    3                 OCMSG.LEV# = B$JIT.TSLINE.LEV;

   1323  1 000055   000000 470400 xsym               LDP0    B$JIT$
         1 000056   000340 236100                    LDQ     224,,PR0
         1 000057   000022 772000                    QRL     18
         1 000060   200020 552110                    STBQ    OCMSG+8,'10'O,AUTO

      538     1324    3                 OCMSG.TTYP# = B$JIT.TSLINE.TTYP;

   1324  1 000061   000340 236100                    LDQ     224,,PR0
         1 000062   000022 772000                    QRL     18
         1 000063   200020 552104                    STBQ    OCMSG+8,'04'O,AUTO

      539     1325    3                 OCMSG.SUBDEV# = B$JIT.TSLINE.SUBDEVICE;

   1325  1 000064   000340 720100                    LXL0    224,,PR0
         1 000065   200021 740100                    STX0    OCMSG+9,,AUTO

      540     1326    3                 OCMSG.SUBSUBDEV# = B$JIT.TSLINE.SUBSUBDEVICE;

   1326  1 000066   000341 221100                    LDX1    225,,PR0
         1 000067   200021 441100                    SXL1    OCMSG+9,,AUTO

      541     1327    3                 END;

      542     1328    2              END;

      543     1329    1           OCLENS = OCMLNG;

   1329  1 000070   000100 100400                    MLR     fill='000'O
         1 000071   000000 000016 0                  ADSC9   OCMLNG                   cn=0,n=14
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:89   
         1 000072   200004 000016                    ADSC9   OCLENS,,AUTO             cn=0,n=14

      544     1330    1           TEMP$ = ADDR(OCMSG.JLS_TEXT);

   1330  1 000073   200022 631500                    EPPR1   OCMSG+10,,AUTO
         1 000074   200044 451500                    STP1    TEMP$,,AUTO

      545     1331    1           CALL HFF$NILERASE(1)

   1331  1 000075   000002 630400 2                  EPPR0   2
         1 000076   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000077   000000 701000 xent               TSX1    HFF$NILERASE
         1 000100   000142 702000 1                  TSX2    s:1353

      546     1332    1           WHENRETURN
      547     1333    2           DO;

      548     1334    2              CALL HFF$DSIZ(1,FEX);

   1334  1 000101   200043 630500                    EPPR0   FEX,,AUTO
         1 000102   200047 450500                    STP0    TEMP$+3,,AUTO
         1 000103   000002 236000 2                  LDQ     2
         1 000104   200046 756100                    STQ     TEMP$+2,,AUTO
         1 000105   200046 630500                    EPPR0   TEMP$+2,,AUTO
         1 000106   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000107   000000 701000 xent               TSX1    HFF$DSIZ
         1 000110   000000 011000                    NOP     0

      549     1335    2              IF FEX>31

   1335  1 000111   200043 235100                    LDA     FEX,,AUTO
         1 000112   000040 115007                    CMPA    32,DL
         1 000113   000123 602000 1                  TNC     s:1347

      550     1336    2              THEN
      551     1337    3              DO;

PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:90   
      552     1338    3                 B$JIT.ERR=OCU_ERR;

   1338  1 000114   000000 236000 xsym               LDQ     OCU_ERR
         1 000115   000000 470400 xsym               LDP0    B$JIT$
         1 000116   000012 756100                    STQ     10,,PR0

      553     1339    3                 B$JIT.ERR.CODE=%E$BADOCMSG1;

   1339  1 000117   000003 376000 2                  ANQ     3
         1 000120   014760 276007                    ORQ     6640,DL
         1 000121   000012 756100                    STQ     10,,PR0

      554     1340        /*E* ERROR:         OCU-E$BADOCMSG1-E
      555     1341             MESSAGE:       M$OCMSG user text 1 too large
      556     1342             MESSAGE1:      The maximum number of characters that can be passed
      557     1343                            through an M$OCMSG user text field is 31.
      558     1344        */
      559     1345    3                 RETURN;

   1345  1 000122   000000 702200 xent               TSX2  ! X66_ARET

      560     1346    3                 END;
      561     1347    2              OCLENS(12)=FEX;

   1347  1 000123   200043 236100                    LDQ     FEX,,AUTO
         1 000124   000033 736000                    QLS     27
         1 000125   200007 552140                    STBQ    OCLENS+3,'40'O,AUTO

      562     1348    2              TEMP$ -> CHAR_TEMPLATE = B$PS1$-> CHAR_TEMPLATE;

   1348  1 000126   000000 470400 xsym               LDP0    B$PS1$
         1 000127   000000 620005                    EAX0    0,AL
         1 000130   200044 471500                    LDP1    TEMP$,,AUTO
         1 000131   200043 721100                    LXL1    FEX,,AUTO
         1 000132   040140 100540                    MLR     fill='040'O
         1 000133   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 000134   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:91   

      563     1349    2              TEMP$ = PINCRC(TEMP$,FEX);

   1349  1 000135   200043 236100                    LDQ     FEX,,AUTO
         1 000136   000020 736000                    QLS     16
         1 000137   200044 036100                    ADLQ    TEMP$,,AUTO
         1 000140   200044 756100                    STQ     TEMP$,,AUTO

      564     1350    2              END;

   1350  1 000141   000144 710000 1                  TRA     s:1356

      565     1351    1           WHENALTRETURN
      566     1352    2           DO;

      567     1353    2              OCLENS(12) = 0;

   1353  1 000142   000000 236003                    LDQ     0,DU
         1 000143   200007 552140                    STBQ    OCLENS+3,'40'O,AUTO

      568     1354    2              END;

      569     1355
      570     1356    1           CALL HFF$NILERASE(2)

   1356  1 000144   000004 630400 2                  EPPR0   4
         1 000145   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000146   000000 701000 xent               TSX1    HFF$NILERASE
         1 000147   000205 702000 1                  TSX2    s:1378

      571     1357    1           WHENRETURN
      572     1358    2           DO;

      573     1359    2              CALL HFF$DSIZ(2,FEX);

   1359  1 000150   200043 630500                    EPPR0   FEX,,AUTO
         1 000151   200047 450500                    STP0    TEMP$+3,,AUTO
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:92   
         1 000152   000004 236000 2                  LDQ     4
         1 000153   200046 756100                    STQ     TEMP$+2,,AUTO
         1 000154   200046 630500                    EPPR0   TEMP$+2,,AUTO
         1 000155   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000156   000000 701000 xent               TSX1    HFF$DSIZ
         1 000157   000000 011000                    NOP     0

      574     1360    2              IF FEX>31

   1360  1 000160   200043 235100                    LDA     FEX,,AUTO
         1 000161   000040 115007                    CMPA    32,DL
         1 000162   000172 602000 1                  TNC     s:1373

      575     1361    2              THEN
      576     1362    3              DO;

      577     1363    3                 B$JIT.ERR=OCU_ERR;

   1363  1 000163   000000 236000 xsym               LDQ     OCU_ERR
         1 000164   000000 470400 xsym               LDP0    B$JIT$
         1 000165   000012 756100                    STQ     10,,PR0

      578     1364    3                 B$JIT.ERR.CODE=%E$BADOCMSG2;

   1364  1 000166   000003 376000 2                  ANQ     3
         1 000167   014770 276007                    ORQ     6648,DL
         1 000170   000012 756100                    STQ     10,,PR0

      579     1365        /*E* ERROR:         OCU-E$BADOCMSG2-E
      580     1366             MESSAGE:       M$OCMSG user text 2 too large
      581     1367             MESSAGE2:      The maximum number of characters that can be passed
      582     1368                            through an M$OCMSG user text field is 31.
      583     1369        */
      584     1370    3                 RETURN;

   1370  1 000171   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:93   
      585     1371    3                 END;
      586     1372
      587     1373    2              OCLENS(13)=FEX;

   1373  1 000172   200043 236100                    LDQ     FEX,,AUTO
         1 000173   000022 736000                    QLS     18
         1 000174   200007 552120                    STBQ    OCLENS+3,'20'O,AUTO

      588     1374    2              TEMP$ -> CHAR_TEMPLATE = B$PS2$-> CHAR_TEMPLATE;

   1374  1 000175   000000 470400 xsym               LDP0    B$PS2$
         1 000176   000000 620005                    EAX0    0,AL
         1 000177   200044 471500                    LDP1    TEMP$,,AUTO
         1 000200   200043 721100                    LXL1    FEX,,AUTO
         1 000201   040140 100540                    MLR     fill='040'O
         1 000202   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 000203   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      589     1375    2              END;

   1375  1 000204   000207 710000 1                  TRA     s:1380

      590     1376    1           WHENALTRETURN
      591     1377    2           DO;

      592     1378    2              OCLENS(13) = 0;

   1378  1 000205   000000 236003                    LDQ     0,DU
         1 000206   200007 552120                    STBQ    OCLENS+3,'20'O,AUTO

      593     1379    2              END;

      594     1380    1           OCMSG.USR#=S_CUN;

   1380  1 000207   000000 236000 xsym               LDQ     S_CUN
         1 000210   000022 736000                    QLS     18
         1 000211   200015 552120                    STBQ    OCMSG+5,'20'O,AUTO
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:94   

      595     1381    1           OCMSG.SUBC=B$PS0$->FPT$OCMSG_V.SUBC;

   1381  1 000212   000000 470400 xsym               LDP0    B$PS0$
         1 000213   000001 236100                    LDQ     1,,PR0
         1 000214   000011 772000                    QRL     9
         1 000215   200015 552110                    STBQ    OCMSG+5,'10'O,AUTO

      596     1382    1           CADDR=OCU_CADDR(B$PS0$->FPT$OCMSG_V.OCTYPE);

   1382  1 000216   000001 236100                    LDQ     1,,PR0
         1 000217   000033 772000                    QRL     27
         1 000220   000017 376007                    ANQ     15,DL
         1 000221   000001 736000                    QLS     1
         1 000222   000100 100406                    MLR     fill='000'O
         1 000223   000000 000002 xsym               ADSC9   OCU_CADDR,Q              cn=0,n=2
         1 000224   200042 000004                    ADSC9   CADDR,,AUTO              cn=0,n=4

      597     1383    1           CALL OCI$MK_WR (CADDR,B$PS0$->FPT$OCMSG_V.MSG,

   1383  1 000225   000000 236000 xsym               LDQ     B$JIT$
         1 000226   000010 036003                    ADLQ    8,DU
         1 000227   200054 756100                    STQ     TEMP$+8,,AUTO
         1 000230   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000231   200053 756100                    STQ     TEMP$+7,,AUTO
         1 000232   200010 631500                    EPPR1   OCMSG,,AUTO
         1 000233   200052 451500                    STP1    TEMP$+6,,AUTO
         1 000234   200004 633500                    EPPR3   OCLENS,,AUTO
         1 000235   200051 453500                    STP3    TEMP$+5,,AUTO
         1 000236   000006 236000 2                  LDQ     6
         1 000237   200050 756100                    STQ     TEMP$+4,,AUTO
         1 000240   000000 236000 xsym               LDQ     B$PS0$
         1 000241   200047 756100                    STQ     TEMP$+3,,AUTO
         1 000242   200042 634500                    EPPR4   CADDR,,AUTO
         1 000243   200046 454500                    STP4    TEMP$+2,,AUTO
         1 000244   200046 630500                    EPPR0   TEMP$+2,,AUTO
         1 000245   000025 631400 xsym               EPPR1   B_VECTNIL+21
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:95   
         1 000246   000000 701000 xent               TSX1    OCI$MK_WR
         1 000247   000000 011000                    NOP     0

      598     1384    1             LENGTHC(OCLENS),OCLENS,OCMSG,,B$JIT.WOO);
      599     1385    1           RETURN;

   1385  1 000250   000000 702200 xent               TSX2  ! X66_ARET

OCMLNG
 Sect OctLoc
   0     000   010014 001001   001001 002010   001001 002002   000000 ******    ................

(unnamed)
 Sect OctLoc
   2     000   000000 006003   000016 400000   000003 006000   777777 400007    ................
   2     004   000004 006000   000000 000016   000005 006000                    ............
      600     1386        /**/
      601     1387    1   END;
      602     1388        /**/
      603     1389        %EOD;

PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:96   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   OCU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   UM$CP6V_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   UM_ERRORS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure OCU$OCMSG.
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:97   

 **** Variables and constants ****

  ****  Section 000 RoData OCU$OCMSG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c UBIN(9)     r     1 OCMLNG(0:13)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPTCODE                  42-0-0/w BIT         r     1 CADDR
    43-0-0/w UBIN        r     1 FEX                       *0-0-0/w UBIN        r     1 FPTCODE
    42-0-0/w UBIN        r     1 MODE                       4-0-0/c UBIN(9)     r     1 OCLENS(0:13)
    10-0-0/w STRC(936)   r     1 OCMSG                     44-0-0/w PTR         r     1 TEMP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS2$
     0-0-0/b BIT (18)    r     1 OCU_CADDR(0:15)
     0-0-0/b STRC        r     1 OCU_ERR                    0-0-0/w UBIN        r     1 S_CUN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/c ACHR        r     1 CHAR_TEMPLATE
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(144)   r     1 FPT$OCMSG_V

PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:98   

   Procedure OCU$OCMSG requires 169 words for executable code.
   Procedure OCU$OCMSG requires 46 words of local(AUTO) storage.
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:99   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:100  
          MINI XREF LISTING

B$JIT.ACCN
       365**DCL      1312>>ASSIGN
B$JIT.ERR
       365**DCL      1338<<ASSIGN   1363<<ASSIGN
B$JIT.ERR.CODE
       366**DCL      1339<<ASSIGN   1364<<ASSIGN
B$JIT.ERR.MID
       366**DCL       366--REDEF
B$JIT.MODE
       360**DCL      1314>>ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
       468**DCL       468--REDEF     469--REDEF
B$JIT.TSLINE
       466**DCL       467--REDEF
B$JIT.TSLINE.FEX
       466**DCL      1319>>ASSIGN
B$JIT.TSLINE.LEV
       467**DCL      1323>>ASSIGN
B$JIT.TSLINE.PORT
       466**DCL      1320>>ASSIGN
B$JIT.TSLINE.SUBDEVICE
       467**DCL      1325>>ASSIGN
B$JIT.TSLINE.SUBSUBDEVICE
       467**DCL      1326>>ASSIGN
B$JIT.TSLINE.TTYP
       467**DCL      1324>>ASSIGN
B$JIT.UNAME
       365**DCL      1313>>ASSIGN
B$JIT.WOO
       365**DCL      1383<>CALL
B$JIT$
      1301**DCL       360--IMP-PTR  1312>>ASSIGN   1313>>ASSIGN   1314>>ASSIGN   1319>>ASSIGN   1320>>ASSIGN
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:101  
      1323>>ASSIGN   1324>>ASSIGN   1325>>ASSIGN   1326>>ASSIGN   1338>>ASSIGN   1339>>ASSIGN   1363>>ASSIGN
      1364>>ASSIGN   1383>>CALL
B$PS0$
      1303**DCL      1381>>ASSIGN   1382>>ASSIGN   1383>>CALL
B$PS1$
      1304**DCL      1348>>ASSIGN
B$PS2$
      1305**DCL      1374>>ASSIGN
CADDR
      1296**DCL      1297--REDEF    1382<<ASSIGN   1383<>CALL
CHAR_TEMPLATE
      1300**DCL      1348<<ASSIGN   1348>>ASSIGN   1374<<ASSIGN   1374>>ASSIGN
F$DCB.ACTPOS
       499**DCL       499--REDEF
F$DCB.ARS
       474**DCL       474--REDEF
F$DCB.ASN
       489**DCL      1317>>IF
F$DCB.ATTR
       492**DCL       493--REDEF
F$DCB.BORROW
       507**DCL       507--REDEF     507--REDEF     507--REDEF
F$DCB.DCBNAME.L
       521**DCL       521--IMP-SIZ
F$DCB.EOMCHAR
       478**DCL       478--REDEF
F$DCB.FLDID
       502**DCL       502--REDEF
F$DCB.FORM$
       496**DCL       496--REDEF
F$DCB.FSECT
       512**DCL       512--REDEF
F$DCB.FSN
       489**DCL       489--REDEF     489--REDEF     490--REDEF
F$DCB.HEADER$
       495**DCL       495--REDEF
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:102  
F$DCB.IXTNSIZE
       493**DCL       493--REDEF
F$DCB.LASTSTA$
       483**DCL       483--REDEF
F$DCB.LVL
       508**DCL       508--REDEF
F$DCB.NAME.C
       483**DCL       483--REDEF
F$DCB.NOEOF
       504**DCL       504--REDEF
F$DCB.NRECS
       494**DCL       494--REDEF
F$DCB.NRECX
       513**DCL       513--REDEF
F$DCB.OHDR
       505**DCL       505--REDEF
F$DCB.ORG
       488**DCL       488--REDEF
F$DCB.PRECNO
       511**DCL       511--REDEF
F$DCB.RCSZ
       516**DCL       516--REDEF
F$DCB.RES
       484**DCL       484--REDEF
F$DCB.SETX
       496**DCL       496--REDEF
F$DCB.TAB$
       495**DCL       496--REDEF
F$DCB.TDA
       510**DCL       510--REDEF
F$DCB.WSN
       485**DCL       485--REDEF
FEX
      1298**DCL      1300--IMP-SIZ  1321<<ASSIGN   1322<>CALL     1334<>CALL     1335>>IF       1347>>ASSIGN
      1348>>ASSIGN   1348>>ASSIGN   1349>>ASSIGN   1359<>CALL     1360>>IF       1373>>ASSIGN   1374>>ASSIGN
      1374>>ASSIGN
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:103  
FPT$OCMSG_V.MSG
      1262**DCL      1383<>CALL
FPT$OCMSG_V.OCTYPE
      1262**DCL      1382>>ASSIGN
FPT$OCMSG_V.SUBC
      1262**DCL      1381>>ASSIGN
FPTCODE
      1266**DCL         8--PROC
HFF$DSIZ
      1308**DCL-ENT  1334--CALL     1359--CALL
HFF$NILERASE
      1309**DCL-ENT  1331--CALL     1356--CALL
KIN$CONV_NODE
      1307**DCL-ENT  1322--CALL
MODE
      1297**DCL      1314<<ASSIGN   1315>>ASSIGN   1316>>IF
OCI$MK_WR
      1306**DCL-ENT  1383--CALL
OCLENS
      1281**DCL      1329<<ASSIGN   1347<<ASSIGN   1353<<ASSIGN   1373<<ASSIGN   1378<<ASSIGN   1383--CALL
      1383<>CALL
OCMLNG
      1267**DCL      1329>>ASSIGN
OCMSG
      1282**DCL      1383<>CALL
OCMSG.ACCT
      1283**DCL      1267--DCLINIT  1312<<ASSIGN
OCMSG.FEP#
      1288**DCL      1272--DCLINIT  1319<<ASSIGN   1321>>ASSIGN
OCMSG.JLS_TEXT
      1295**DCL      1330--ASSIGN
OCMSG.LEV#
      1291**DCL      1275--DCLINIT  1323<<ASSIGN
OCMSG.MODE
      1285**DCL      1269--DCLINIT  1315<<ASSIGN   1317<<ASSIGN
OCMSG.NODENAME#
PL6.E3A0      #003=OCU$OCMSG File=OCU$KEYIN.:E05TSI                              WED 07/30/97 04:08 Page:104  
      1290**DCL      1274--DCLINIT  1322<>CALL
OCMSG.PORT#
      1289**DCL      1273--DCLINIT  1320<<ASSIGN
OCMSG.SUBC
      1287**DCL      1271--DCLINIT  1381<<ASSIGN
OCMSG.SUBDEV#
      1293**DCL      1277--DCLINIT  1325<<ASSIGN
OCMSG.SUBSUBDEV#
      1294**DCL      1278--DCLINIT  1326<<ASSIGN
OCMSG.TTYP#
      1292**DCL      1276--DCLINIT  1324<<ASSIGN
OCMSG.UNAME
      1284**DCL      1268--DCLINIT  1313<<ASSIGN
OCMSG.USR#
      1286**DCL      1270--DCLINIT  1380<<ASSIGN
OCU_CADDR
       719**DCL      1382>>ASSIGN
OCU_ERR
       717**DCL      1338>>ASSIGN   1363>>ASSIGN
S_CUN
      1302**DCL      1380>>ASSIGN
TEMP$
      1299**DCL      1300--IMP-PTR  1330<<ASSIGN   1348>>ASSIGN   1349<<ASSIGN   1349>>ASSIGN   1374>>ASSIGN

PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:105  
      604        1        /*T***********************************************************/
      605        2        /*T*                                                         */
      606        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      607        4        /*T*                                                         */
      608        5        /*T***********************************************************/
      609        6        /**/
      610        7        /**/
      611        8        OCU$GETMOC: PROC ALTRET;
      612        9        /**/
      613       10        /**/
      614       11        %INCLUDE CP_6;
      615     5570        %INCLUDE F$DCB;
      616     5619        %INCLUDE F$JIT_C;
      617     6049        %INCLUDE OCU_DATA_R;
      618     6060        %INCLUDE CP_6_SUBS;
      619     6600        /**/
      620     6601        /**/
      621     6602        %FPT_GETDCB (DCBNAME=OCU_DCBNAME,DCB=%M$OC#);
      622     6617        /**/
      623     6618        /**/
      624     6619    1   DCL B$JIT$ PTR SYMREF;
      625     6620    1   DCL M$MGETDCB ENTRY(1) ALTRET;
      626     6621    1   DCL FMM$DFLOPNP ENTRY;
      627     6622        /**/
      628     6623        /**/
      629     6624    1           B$JIT.DCB$=DCBADDR(%M$OC#);
      630     6625    2           IF B$JIT.DCB$~=ADDR(NIL) THEN DO;
      631     6626    2              IF B$JIT.DCB$->F$DCB.FCD THEN RETURN;
      632     6627    2              ELSE GOTO TRYOPN;
      633     6628    2              END;
      634     6629    1           CALL M$MGETDCB (FPT_GETDCB) ALTRET (ALTRT);
      635     6630    1           B$JIT.DCB$=DCBADDR(%M$OC#);
      636     6631    1   TRYOPN: ;
      637     6632    1           B$JIT.DCB$->F$DCB.ASN=%COMGROUP#;
      638     6633    1           B$JIT.DCB$->F$DCB.NAME=OCU_COMGROUP;
      639     6634    1           B$JIT.DCB$->F$DCB.ACCT=':SYS';
      640     6635    1           B$JIT.DCB$->F$DCB.PSN=' ';
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:106  
      641     6636    1           B$JIT.DCB$->F$DCB.FUN=%UPDATE#;
      642     6637    1           B$JIT.ERR='0'B;
      643     6638    1           CALL FMM$DFLOPNP;
      644     6639    1           IF B$JIT.ERR~='0'B THEN GOTO ALTRT;
      645     6640    1           B$JIT.DCB$=DCBADDR(%M$OC#);
      646     6641    1           B$JIT.DCB$->F$DCB.FFLG.EXEC='1'B;
      647     6642    1           RETURN;
      648     6643    1   ALTRT:  ;
      649     6644    1           ALTRETURN;
      650     6645        /**/
      651     6646    1   END;
      652     6647        /**/
      653     6648        /**/

PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:107  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   OCU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure OCU$GETMOC.

   Procedure OCU$GETMOC requires 57 words for executable code.
   Procedure OCU$GETMOC requires 4 words of local(AUTO) storage.

    No errors detected in file OCU$KEYIN.:E05TSI    .

PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:108  

 Object Unit name= OCU$GETMOC                                 File name= OCU$KEYIN.:E05TOU
 UTS= JUL 30 '97 04:09:03.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none     8     10  OCU$GETMOC
    2  RoData even  UTS      1      1  OCU$GETMOC
    3   Proc  even  none    57     71  OCU$GETMOC
    4  RoData even  none     2      2  OCU$GETMOC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        0  OCU$GETMOC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 M$MGETDCB
         yes           Std       0 FMM$DFLOPNP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:109  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    OCU_DCBNAME                      r    OCU_COMGROUP
     B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:110  


      604        1        /*T***********************************************************/
      605        2        /*T*                                                         */
      606        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      607        4        /*T*                                                         */
      608        5        /*T***********************************************************/
      609        6        /**/
      610        7        /**/
      611        8        OCU$GETMOC: PROC ALTRET;

      8  3 000000   000000 700200 xent  OCU$GETMOC   TSX0  ! X66_AUTO_0
         3 000001   000004 000000                    ZERO    4,0

      612        9        /**/
      613       10        /**/
      614       11        %INCLUDE CP_6;
      615     5570        %INCLUDE F$DCB;
      616     5619        %INCLUDE F$JIT_C;
      617     6049        %INCLUDE OCU_DATA_R;
      618     6060        %INCLUDE CP_6_SUBS;
      619     6600        /**/
      620     6601        /**/
      621     6602        %FPT_GETDCB (DCBNAME=OCU_DCBNAME,DCB=%M$OC#);
      622     6617        /**/
      623     6618        /**/
      624     6619    1   DCL B$JIT$ PTR SYMREF;
      625     6620    1   DCL M$MGETDCB ENTRY(1) ALTRET;
      626     6621    1   DCL FMM$DFLOPNP ENTRY;
      627     6622        /**/
      628     6623        /**/
      629     6624    1           B$JIT.DCB$=DCBADDR(%M$OC#);

   6624  3 000002   000000 470400 4                  LDP0    0
         3 000003   000000 471500                    LDP1    0,,PR0
         3 000004   100007 236100                    LDQ     7,,PR1
         3 000005   000000 473400 xsym               LDP3    B$JIT$
         3 000006   300232 756100                    STQ     154,,PR3
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:111  

      630     6625    2           IF B$JIT.DCB$~=ADDR(NIL) THEN DO;

   6625  3 000007   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000010   000016 600000 3                  TZE     s:6629

      631     6626    2              IF B$JIT.DCB$->F$DCB.FCD THEN RETURN;

   6626  3 000011   300232 474500                    LDP4    154,,PR3
         3 000012   400031 236100                    LDQ     25,,PR4
         3 000013   020000 316007                    CANQ    8192,DL
         3 000014   000027 600000 3                  TZE     TRYOPN

   6626  3 000015   000000 702200 xent               TSX2  ! X66_ARET

      632     6627    2              ELSE GOTO TRYOPN;
      633     6628    2              END;
      634     6629    1           CALL M$MGETDCB (FPT_GETDCB) ALTRET (ALTRT);

   6629  3 000016   000001 630400 4                  EPPR0   1
         3 000017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000020   000000 701000 xent               TSX1    M$MGETDCB
         3 000021   000070 702000 3                  TSX2    ALTRT

      635     6630    1           B$JIT.DCB$=DCBADDR(%M$OC#);

   6630  3 000022   000000 470400 4                  LDP0    0
         3 000023   000000 471500                    LDP1    0,,PR0
         3 000024   100007 236100                    LDQ     7,,PR1
         3 000025   000000 473400 xsym               LDP3    B$JIT$
         3 000026   300232 756100                    STQ     154,,PR3

   6630  3 000027                       TRYOPN       null
      636     6631    1   TRYOPN: ;
      637     6632    1           B$JIT.DCB$->F$DCB.ASN=%COMGROUP#;

   6632  3 000027   300232 474500                    LDP4    154,,PR3
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:112  
         3 000030   004000 236007                    LDQ     2048,DL
         3 000031   400032 552110                    STBQ    26,'10'O,PR4

      638     6633    1           B$JIT.DCB$->F$DCB.NAME=OCU_COMGROUP;

   6633  3 000032   300232 474500                    LDP4    154,,PR3
         3 000033   000100 100400                    MLR     fill='000'O
         3 000034   000000 000005 xsym               ADSC9   OCU_COMGROUP             cn=0,n=5
         3 000035   400010 000040                    ADSC9   8,,PR4                   cn=0,n=32

      639     6634    1           B$JIT.DCB$->F$DCB.ACCT=':SYS';

   6634  3 000036   300232 474500                    LDP4    154,,PR3
         3 000037   000000 235000 2                  LDA     0
         3 000040   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 000041   400020 757100                    STAQ    16,,PR4

      640     6635    1           B$JIT.DCB$->F$DCB.PSN=' ';

   6635  3 000042   300232 474500                    LDP4    154,,PR3
         3 000043   040100 100400                    MLR     fill='040'O
         3 000044   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000045   400024 000006                    ADSC9   20,,PR4                  cn=0,n=6

      641     6636    1           B$JIT.DCB$->F$DCB.FUN=%UPDATE#;

   6636  3 000046   300232 474500                    LDP4    154,,PR3
         3 000047   000001 236003                    LDQ     1,DU
         3 000050   400032 552120                    STBQ    26,'20'O,PR4

      642     6637    1           B$JIT.ERR='0'B;

   6637  3 000051   300012 450100                    STZ     10,,PR3

      643     6638    1           CALL FMM$DFLOPNP;

   6638  3 000052   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:113  
         3 000053   000000 701000 xent               TSX1    FMM$DFLOPNP
         3 000054   000000 011000                    NOP     0

      644     6639    1           IF B$JIT.ERR~='0'B THEN GOTO ALTRT;

   6639  3 000055   000000 470400 xsym               LDP0    B$JIT$
         3 000056   000012 235100                    LDA     10,,PR0
         3 000057   000070 601000 3                  TNZ     ALTRT

      645     6640    1           B$JIT.DCB$=DCBADDR(%M$OC#);

   6640  3 000060   000000 471400 4                  LDP1    0
         3 000061   100000 473500                    LDP3    0,,PR1
         3 000062   300007 236100                    LDQ     7,,PR3
         3 000063   000232 756100                    STQ     154,,PR0

      646     6641    1           B$JIT.DCB$->F$DCB.FFLG.EXEC='1'B;

   6641  3 000064   000232 474500                    LDP4    154,,PR0
         3 000065   002000 236003                    LDQ     1024,DU
         3 000066   400004 256100                    ORSQ    4,,PR4

      647     6642    1           RETURN;

   6642  3 000067   000000 702200 xent               TSX2  ! X66_ARET

   6641  3 000070                       ALTRT        null
      648     6643    1   ALTRT:  ;
      649     6644    1           ALTRETURN;

   6644  3 000070   000000 702200 xent               TSX2  ! X66_AALT

FPT_GETDCB
 Sect OctLoc
   1     000   000001 777640   000006 006000   000001 177640   000000 006000    ................
   1     004   000000 177640   000000 006014   000007 000000   000000 000000    ................

PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:114  
(unnamed)
 Sect OctLoc
   2     000   072123 131123                                                    :SYS

(unnamed)
 Sect OctLoc
   4     000   000000 006003   000000 006000                                    ........
      650     6645        /**/
      651     6646    1   END;
      652     6647        /**/
      653     6648        /**/

PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:115  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   OCU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure OCU$GETMOC.
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:116  

 **** Variables and constants ****

  ****  Section 001  Data  OCU$GETMOC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)   r     1 FPT_GETDCB

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/c STRC(45)    r     1 OCU_COMGROUP
     0-0-0/c STRC(45)    r     1 OCU_DCBNAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure OCU$GETMOC requires 57 words for executable code.
   Procedure OCU$GETMOC requires 4 words of local(AUTO) storage.

    No errors detected in file OCU$KEYIN.:E05TSI    .
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:117  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:118  
          MINI XREF LISTING

ALTRT
      6641**LABEL    6629--CALLALT  6639--GOTO
B$JIT.DCB$
      6036**DCL      6624<<ASSIGN   6625>>IF       6626>>IF       6630<<ASSIGN   6632>>ASSIGN   6633>>ASSIGN
      6634>>ASSIGN   6635>>ASSIGN   6636>>ASSIGN   6640<<ASSIGN   6641>>ASSIGN
B$JIT.ERR
      5946**DCL      6637<<ASSIGN   6639>>IF
B$JIT.ERR.MID
      5947**DCL      5947--REDEF
B$JIT$
      6619**DCL      5941--IMP-PTR  6624>>ASSIGN   6625>>IF       6626>>IF       6630>>ASSIGN   6632>>ASSIGN
      6633>>ASSIGN   6634>>ASSIGN   6635>>ASSIGN   6636>>ASSIGN   6637>>ASSIGN   6639>>IF       6640>>ASSIGN
      6641>>ASSIGN
F$DCB.ACCT
      5581**DCL      6634<<ASSIGN
F$DCB.ACTPOS
      5596**DCL      5596--REDEF
F$DCB.ARS
      5571**DCL      5571--REDEF
F$DCB.ASN
      5586**DCL      6632<<ASSIGN
F$DCB.ATTR
      5589**DCL      5590--REDEF
F$DCB.BORROW
      5604**DCL      5604--REDEF    5604--REDEF    5604--REDEF
F$DCB.DCBNAME.L
      5618**DCL      5618--IMP-SIZ
F$DCB.EOMCHAR
      5575**DCL      5575--REDEF
F$DCB.FCD
      5584**DCL      6626>>IF
F$DCB.FFLG.EXEC
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:119  
      5576**DCL      6641<<ASSIGN
F$DCB.FLDID
      5599**DCL      5599--REDEF
F$DCB.FORM$
      5593**DCL      5593--REDEF
F$DCB.FSECT
      5609**DCL      5609--REDEF
F$DCB.FSN
      5586**DCL      5586--REDEF    5586--REDEF    5587--REDEF
F$DCB.FUN
      5585**DCL      6636<<ASSIGN
F$DCB.HEADER$
      5592**DCL      5592--REDEF
F$DCB.IXTNSIZE
      5590**DCL      5590--REDEF
F$DCB.LASTSTA$
      5580**DCL      5580--REDEF
F$DCB.LVL
      5605**DCL      5605--REDEF
F$DCB.NAME
      5580**DCL      6633<<ASSIGN
F$DCB.NAME.C
      5580**DCL      5580--REDEF
F$DCB.NOEOF
      5601**DCL      5601--REDEF
F$DCB.NRECS
      5591**DCL      5591--REDEF
F$DCB.NRECX
      5610**DCL      5610--REDEF
F$DCB.OHDR
      5602**DCL      5602--REDEF
F$DCB.ORG
      5585**DCL      5585--REDEF
F$DCB.PRECNO
      5608**DCL      5608--REDEF
F$DCB.PSN
PL6.E3A0      #004=OCU$GETMOC File=OCU$KEYIN.:E05TSI                             WED 07/30/97 04:09 Page:120  
      5581**DCL      6635<<ASSIGN
F$DCB.RCSZ
      5613**DCL      5613--REDEF
F$DCB.RES
      5581**DCL      5581--REDEF
F$DCB.SETX
      5593**DCL      5593--REDEF
F$DCB.TAB$
      5592**DCL      5593--REDEF
F$DCB.TDA
      5607**DCL      5607--REDEF
F$DCB.WSN
      5582**DCL      5582--REDEF
FMM$DFLOPNP
      6621**DCL-ENT  6638--CALL
FPT_GETDCB
      6613**DCL      6629<>CALL
FPT_GETDCB.V
      6614**DCL      6613--DCLINIT
M$MGETDCB
      6620**DCL-ENT  6629--CALL
OCU_COMGROUP
      6058**DCL      6633>>ASSIGN
OCU_DCBNAME
      6058**DCL      6613--DCLINIT
TRYOPN
      6630**LABEL    6627--GOTO
