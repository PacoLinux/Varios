VERSION E05

PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:1    
        1        1        /*M* ASR$R_WSN - processes REMOVE WSN command.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10                                                              /**/
       11       11        ASR$R_WSN: PROC ;
       12       12
       13       13        /********************************************************************/
       14       14        /*   Include files   include files   include files   include files   */
       15       15        /*********************************************************************/
       16       16                                                              /**/
       17       17        %INCLUDE    CP_6 ;
       18     5576        %INCLUDE    CP_6_SUBS ;
       19     6116        %INCLUDE    B_ERRORS_C ;
       20     7243        %INCLUDE    AS_ENTRIES_M ;
       21     8293        %INCLUDE    AS_SUPER_C ;
       22     8728        %INCLUDE    AS_SUBS_C  ;
       23    10142        %INCLUDE    AS_MAC_C   ;
       24    10222        %INCLUDE    KL_SUPER_C ;
       25    13124        %INCLUDE    XU_MACRO_C ;
       26    16230        %INCLUDE    XU_FORMAT_C ;
       27    16392        %INCLUDE    AS_PERR_C ;
       28    16994        %INCLUDE    AS_SUPER_R ;
       29    20010
       30    20011        /*********************************************************************/
       31    20012        /*   Auto data       auto data       auto data       auto data       */
       32    20013        /*********************************************************************/
       33    20014                                                              /**/
       34    20015    1   DCL WSNHDR$ PTR ;
       35    20016    1   DCL WSNCVT$ PTR ;
       36    20017    1   DCL WSNDEV$ PTR ;
       37    20018    1   DCL DEVWSN$ PTR ;
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:2    
       38    20019    1   DCL TWSNREC$ PTR ;
       39    20020    1   DCL ARS UBIN WORD ;
       40    20021    1   DCL I UBIN WORD ;
       41    20022    1   DCL J UBIN WORD ;
       42    20023    1   DCL K UBIN WORD ;
       43    20024    1   DCL TWSN# UBIN WORD ;
       44    20025    1   DCL TWSNC CHAR(4) ;
       45    20026    1   DCL NUM_WSNS UBIN WORD ;
       46    20027    1   DCL BLK$ PTR ;
       47    20028    1   DCL FOUND BIT(1) ;
       48    20029    1   DCL R_T_WSN BIT(1) ;
       49    20030
       50    20031        /*********************************************************************/
       51    20032        /*   Static data     static data     static data     static data     */
       52    20033        /*********************************************************************/
       53    20034                                                              /**/
       54    20035    1   DCL 1 WSN_KEY ALIGNED STATIC ,
       55    20036    1          2 CNT UBIN BYTE UNAL INIT( 9 ),
       56    20037    1          2 TXT UNAL ,
       57    20038    1             3 ACCT CHAR(8) UNAL INIT(' ') ,
       58    20039    1             3 ASTR CHAR(1) UNAL INIT('*') ;
       59    20040    1   DCL 1 WSNDEV_KEY ALIGNED STATIC ,
       60    20041    1          2 CNT UBIN BYTE UNAL INIT( 15),
       61    20042    1          2 ACCT CHAR(8) UNAL INIT(' '),
       62    20043    1          2 DEV CHAR(7) UNAL INIT('DEVICES');
       63    20044    1   DCL 1 DEVWSN_KEY ALIGNED STATIC ,
       64    20045    1          2 CNT UBIN BYTE UNAL INIT( 12),
       65    20046    1          2 ACCT CHAR(8) UNAL INIT(' '),
       66    20047    1          2 WSN CHAR(4) UNAL INIT('WSNS') ;
       67    20048
       68    20049        /********************************************************************/
       69    20050        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       70    20051        /*********************************************************************/
       71    20052                                                              /**/
       72    20053        %ASW$DELREC_WSN ;
       73    20056        %ASB$GETSEG ;
       74    20059        %ASW$ENQ_WSN ;
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:3    
       75    20062        %ASW$DEQ_WSN ;
       76    20065        %ASW$READ_WSN ;
       77    20068        %ASH$ERROR ;
       78    20071        %ASH$WARN ;
       79    20074        %ASH$INFO ;
       80    20077        %ASB$READ_HLP ;
       81    20080        %ASB$WRITE_HLP ;
       82    20083        %ASB$ENQ_HLP ;
       83    20086        %ASB$DEQ_HLP ;
       84    20089
       85    20090        /*********************************************************************/
       86    20091        /*   Local based     local based     local based     local based     */
       87    20092        /*********************************************************************/
       88    20093                                                              /**/
       89    20094            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       90    20095                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       91    20140              %PARSE$SYM( NAME = OUT$SYM ,
       92    20141                          STCLASS="BASED(BLK$)") ;
       93    20179              %KL_WSNHDR(  NAME = KL$WSNHDR ,
       94    20180                            STCLASS="BASED( DSEG2$ )") ;
       95    20191              %KL_WSNDEV(  NAME = KL$WSNDEV ,
       96    20192                            STCLASS="BASED( WSNDEV$ )") ;
       97    20197              %KL_WSNDEV( NAME = KL$DEVWSN ,
       98    20198                          STCLASS="BASED( DEVWSN$ )") ;
       99    20203
      100    20204        /*********************************************************************/
      101    20205        /*   Procedure       procedure       procedure       procedure       */
      102    20206        /*********************************************************************/
      103    20207                                                              /**/
      104    20208        /*
      105    20209            ***            Begin procedure                    ***
      106    20210        */
      107    20211                                                              /* Did we get data SEG.? */
      108    20212    1   IF NOT DSEG_FLG
      109    20213    1   THEN                                           /* No, get them. */
      110    20214    1      CALL ASB$GETSEG WHENALTRETURN
      111    20215    2      DO ;
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:4    
      112    20216              %SCREAM( ERR#=E$GETSEGERR , LEVEL=ERROR, MID='R' );
      113    20231    2         RETURN ;
      114    20232    2         END ;
      115    20233                                                              /* Pick up wsn name */
      116    20234    1   BLK$ = P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      117    20235    1   IF OUT$SYM.COUNT > 8
      118    20236    2   THEN DO ;
      119    20237        /*E*  ERROR:    ASR-E$WSNNAMETOOBIG-C
      120    20238              MESSAGE0: WSN name too big.
      121    20239              MESSAGE1: WSN name can be at most 8 characters.
      122    20240        */
      123    20241           %SCREAM( ERR#=E$WSNNAMETOOBIG , LEVEL=ERROR, MID='R' );
      124    20256    2      RETURN ;
      125    20257    2      END ;  /* Then do */
      126    20258    1   USERS_KEY = WSN_KEY ;
      127    20259    1   USERS_KEY.COUNT = 9 ;
      128    20260    1   USERS_KEY.UKEY.ACCT = OUT$SYM.TEXT ;
      129    20261                                                              /**/
      130    20262    1   WSN_KEY = USERS_KEY ;
      131    20263    1   ARS = DSEG2SIZE ;
      132    20264    1   CALL ASW$READ_WSN ( DSEG2$, ARS ) ALTRET (DELREC_ERR);
      133    20265    2   IF NOT KL$WSNHDR.INDIRECT# THEN DO;
      134    20266                            /**/
      135    20267                            /* Delete wsn name from device record  */
      136    20268                            /**/
      137    20269    2      WSNDEV_KEY.ACCT = WSN_KEY.TXT.ACCT ;
      138    20270    2      USERS_KEY = WSNDEV_KEY ;
      139    20271    2      WSNDEV$ = PINCRW( DSEG2$, 50) ;
      140    20272    2      ARS = DSEG2SIZE - 50 * 4 ;
      141    20273    2      CALL ASW$ENQ_WSN ALTRET (ENQ_ERR);
      142    20274    2      CALL ASW$READ_WSN ( WSNDEV$, ARS) ALTRET(DELREC_ERR);
      143    20275    3      DO I = 0 TO KL$WSNDEV.NDEV-1;
      144    20276    3         DEVWSN_KEY.ACCT = KL$WSNDEV.DEV(I) ;
      145    20277    3         USERS_KEY = DEVWSN_KEY ;
      146    20278    3         CALL ASB$ENQ_HLP ALTRET(ENQ_ERR) ;
      147    20279    3         DEVWSN$ = PINCRW( DSEG2$, 1000) ;
      148    20280    3         ARS = DSEG2SIZE - 1000* 4;
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:5    
      149    20281    3         CALL ASB$READ_HLP (DEVWSN$, ARS) ALTRET ( DEVWSN_ERR ) ;
      150    20282    4         DO J = 0 TO KL$DEVWSN.NDEV - 1 ;
      151    20283    4            IF KL$DEVWSN.DEV(J) = WSNDEV_KEY.ACCT
      152    20284    5            THEN DO;
      153    20285    6               DO K = J TO KL$DEVWSN.NDEV-2 ;
      154    20286    6                  KL$DEVWSN.DEV(K) = KL$DEVWSN.DEV(K+1) ;
      155    20287    6                  END; /* Do k */
      156    20288    5               KL$DEVWSN.NDEV = KL$DEVWSN.NDEV - 1 ;
      157    20289    5               ARS = ARS - LENGTHC( KL$DEVWSN.DEV(0)) ;
      158    20290    5               J = KL$DEVWSN.NDEV ;
      159    20291    5               END ; /*  Then do */
      160    20292    4            END ; /*  Do j */
      161    20293                /**/
      162    20294    3         CALL ASB$WRITE_HLP (DEVWSN$, ARS );
      163    20295    3   DEVWSN_ERR:
      164    20296    3         CALL ASB$DEQ_HLP ALTRET (ENQ_ERR);
      165    20297    3         END ; /*  Do i */
      166    20298    2      USERS_KEY = WSNDEV_KEY ;
      167    20299    2      CALL ASW$DELREC_WSN ALTRET(DELREC_ERR);
      168    20300    2      CALL ASW$DEQ_WSN ;
      169    20301    2      END; /*  Not INDIRECT#  */
      170    20302    1   USERS_KEY = WSN_KEY ;
      171    20303                                                              /* Delete wsn */
      172    20304    1   CALL ASW$ENQ_WSN ALTRET( ENQ_ERR ) ;
      173    20305    2   IF '0'B THEN DO ;
      174    20306    2   ENQ_ERR: ;
      175    20307    2      CALL ASH$ERROR( ERR_CODE ) ;
      176    20308    2      RETURN ;
      177    20309    2      END ;
      178    20310    1   CALL ASW$DELREC_WSN  ALTRET( DELREC_ERR ) ;
      179    20311    1   CALL ASW$DEQ_WSN ;
      180    20312    2   IF '0'B THEN DO ;
      181    20313    2   DELREC_ERR: ;
      182    20314    2      IF MERR_CODE.CODE = %E$NOKEY
      183    20315    3      THEN DO ;
      184    20316        /*E*      ERROR:    ASR-E$WSNNOEXIST-C
      185    20317                  MESSAGE0: WSN does not exist.
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:6    
      186    20318                  MESSAGE1: WSN %%U1 %does not exist.
      187    20319        */
      188    20320    3         CALL INDEX( I, AS_BLANK, WSN_KEY.TXT.ACCT ) ;
      189    20321    3         AS_FIELD1.COUNT = I ;
      190    20322    3         AS_FIELD1.TEXT = WSN_KEY.TXT.ACCT ;
      191    20323              %SCREAM( ERR#=E$WSNNOEXIST , LEVEL=WARN, MID='R' );
      192    20338    3         END ; /* Then do */
      193    20339    2      ELSE
      194    20340    2         CALL ASH$ERROR( ERR_CODE, WSN_KEY ) ;
      195    20341    2      CALL ASW$DEQ_WSN ;
      196    20342    2      RETURN ;
      197    20343    2      END ;
      198    20344        /*E*  ERROR:    ASR-E$WSNREMOVED-C
      199    20345              MESSAGE0: WSN %%U1 %removed.
      200    20346        */
      201    20347    1   CALL INDEX( I, AS_BLANK, WSN_KEY.TXT.ACCT ) ;
      202    20348    1   AS_FIELD1.COUNT = I ;
      203    20349    1   AS_FIELD1.TEXT = WSN_KEY.TXT.ACCT ;
      204    20350        %SCREAM( ERR#=E$WSNREMOVED , LEVEL=INFO, MID='R' );
      205    20365                                                              /**/
      206    20366    1   RETURN ;
      207    20367                                                              /**/
      208    20368    1   END   ASR$R_WSN ;

PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:7    
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ASR$R_WSN.

   Procedure ASR$R_WSN requires 239 words for executable code.
   Procedure ASR$R_WSN requires 20 words of local(AUTO) storage.

    No errors detected in file ASR$REMOVE_WSN.:E05TSI    .

PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:8    

 Object Unit name= ASR$R_WSN                                  File name= ASR$REMOVE_WSN.:E05TOU
 UTS= JUL 29 '97 10:52:00.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    11     13  ASR$R_WSN
    3  RoData even  UTS      4      4  ASR$R_WSN
    4   Proc  even  none   239    357  ASR$R_WSN
    5  RoData even  none     8     10  ASR$R_WSN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  ASR$R_WSN
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:9    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       2 ASW$READ_WSN
 yes     yes           Std       2 ASB$WRITE_HLP
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$ERROR
 yes     yes           Std       0 ASB$ENQ_HLP
 yes     yes           Std       3 ASB$READ_HLP
 yes     yes           Std       0 ASW$DELREC_WSN
         yes           Std       2 ASH$INFO
 yes     yes           Std       0 ASB$DEQ_HLP
         yes           Std       2 ASH$WARN
 yes     yes           Std       0 ASW$ENQ_WSN
 yes     yes           Std       0 ASW$DEQ_WSN
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_MODE
r    AS_FE_MODE                            M$LO                                  USERS_KEY
     NODE$                                 ERR_CODE                              AS_FIELD1
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG_FLG                              DSEG2$                                DSEG2SIZE
     B_VECTNIL
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:10   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:11   


        1        1        /*M* ASR$R_WSN - processes REMOVE WSN command.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10                                                              /**/
       11       11        ASR$R_WSN: PROC ;

     11  4 000000   000000 700200 xent  ASR$R_WSN    TSX0  ! X66_AUTO_0
         4 000001   000024 000000                    ZERO    20,0

       12       12
       13       13        /********************************************************************/
       14       14        /*   Include files   include files   include files   include files   */
       15       15        /*********************************************************************/
       16       16                                                              /**/
       17       17        %INCLUDE    CP_6 ;
       18     5576        %INCLUDE    CP_6_SUBS ;
       19     6116        %INCLUDE    B_ERRORS_C ;
       20     7243        %INCLUDE    AS_ENTRIES_M ;
       21     8293        %INCLUDE    AS_SUPER_C ;
       22     8728        %INCLUDE    AS_SUBS_C  ;
       23    10142        %INCLUDE    AS_MAC_C   ;
       24    10222        %INCLUDE    KL_SUPER_C ;
       25    13124        %INCLUDE    XU_MACRO_C ;
       26    16230        %INCLUDE    XU_FORMAT_C ;
       27    16392        %INCLUDE    AS_PERR_C ;
       28    16994        %INCLUDE    AS_SUPER_R ;
       29    20010
       30    20011        /*********************************************************************/
       31    20012        /*   Auto data       auto data       auto data       auto data       */
       32    20013        /*********************************************************************/
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:12   
       33    20014                                                              /**/
       34    20015    1   DCL WSNHDR$ PTR ;
       35    20016    1   DCL WSNCVT$ PTR ;
       36    20017    1   DCL WSNDEV$ PTR ;
       37    20018    1   DCL DEVWSN$ PTR ;
       38    20019    1   DCL TWSNREC$ PTR ;
       39    20020    1   DCL ARS UBIN WORD ;
       40    20021    1   DCL I UBIN WORD ;
       41    20022    1   DCL J UBIN WORD ;
       42    20023    1   DCL K UBIN WORD ;
       43    20024    1   DCL TWSN# UBIN WORD ;
       44    20025    1   DCL TWSNC CHAR(4) ;
       45    20026    1   DCL NUM_WSNS UBIN WORD ;
       46    20027    1   DCL BLK$ PTR ;
       47    20028    1   DCL FOUND BIT(1) ;
       48    20029    1   DCL R_T_WSN BIT(1) ;
       49    20030
       50    20031        /*********************************************************************/
       51    20032        /*   Static data     static data     static data     static data     */
       52    20033        /*********************************************************************/
       53    20034                                                              /**/
       54    20035    1   DCL 1 WSN_KEY ALIGNED STATIC ,
       55    20036    1          2 CNT UBIN BYTE UNAL INIT( 9 ),
       56    20037    1          2 TXT UNAL ,
       57    20038    1             3 ACCT CHAR(8) UNAL INIT(' ') ,
       58    20039    1             3 ASTR CHAR(1) UNAL INIT('*') ;
       59    20040    1   DCL 1 WSNDEV_KEY ALIGNED STATIC ,
       60    20041    1          2 CNT UBIN BYTE UNAL INIT( 15),
       61    20042    1          2 ACCT CHAR(8) UNAL INIT(' '),
       62    20043    1          2 DEV CHAR(7) UNAL INIT('DEVICES');
       63    20044    1   DCL 1 DEVWSN_KEY ALIGNED STATIC ,
       64    20045    1          2 CNT UBIN BYTE UNAL INIT( 12),
       65    20046    1          2 ACCT CHAR(8) UNAL INIT(' '),
       66    20047    1          2 WSN CHAR(4) UNAL INIT('WSNS') ;
       67    20048
       68    20049        /********************************************************************/
       69    20050        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:13   
       70    20051        /*********************************************************************/
       71    20052                                                              /**/
       72    20053        %ASW$DELREC_WSN ;
       73    20056        %ASB$GETSEG ;
       74    20059        %ASW$ENQ_WSN ;
       75    20062        %ASW$DEQ_WSN ;
       76    20065        %ASW$READ_WSN ;
       77    20068        %ASH$ERROR ;
       78    20071        %ASH$WARN ;
       79    20074        %ASH$INFO ;
       80    20077        %ASB$READ_HLP ;
       81    20080        %ASB$WRITE_HLP ;
       82    20083        %ASB$ENQ_HLP ;
       83    20086        %ASB$DEQ_HLP ;
       84    20089
       85    20090        /*********************************************************************/
       86    20091        /*   Local based     local based     local based     local based     */
       87    20092        /*********************************************************************/
       88    20093                                                              /**/
       89    20094            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       90    20095                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       91    20140              %PARSE$SYM( NAME = OUT$SYM ,
       92    20141                          STCLASS="BASED(BLK$)") ;
       93    20179              %KL_WSNHDR(  NAME = KL$WSNHDR ,
       94    20180                            STCLASS="BASED( DSEG2$ )") ;
       95    20191              %KL_WSNDEV(  NAME = KL$WSNDEV ,
       96    20192                            STCLASS="BASED( WSNDEV$ )") ;
       97    20197              %KL_WSNDEV( NAME = KL$DEVWSN ,
       98    20198                          STCLASS="BASED( DEVWSN$ )") ;
       99    20203
      100    20204        /*********************************************************************/
      101    20205        /*   Procedure       procedure       procedure       procedure       */
      102    20206        /*********************************************************************/
      103    20207                                                              /**/
      104    20208        /*
      105    20209            ***            Begin procedure                    ***
      106    20210        */
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:14   
      107    20211                                                              /* Did we get data SEG.? */
      108    20212    1   IF NOT DSEG_FLG

  20212  4 000002   000000 234000 xsym               SZN     DSEG_FLG
         4 000003   000015 604000 4                  TMI     s:20234

      109    20213    1   THEN                                           /* No, get them. */
      110    20214    1      CALL ASB$GETSEG WHENALTRETURN

  20214  4 000004   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000005   000000 701000 xent               TSX1    ASB$GETSEG
         4 000006   000010 702000 4                  TSX2    s:20228
         4 000007   000015 710000 4                  TRA     s:20234

      111    20215    2      DO ;

      112    20216              %SCREAM( ERR#=E$GETSEGERR , LEVEL=ERROR, MID='R' );

  20228  4 000010   000000 630400 5                  EPPR0   0
         4 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000012   000000 701000 xent               TSX1    ASH$ERROR
         4 000013   000000 011000                    NOP     0

      113    20231    2         RETURN ;

  20231  4 000014   000000 702200 xent               TSX2  ! X66_ARET

      114    20232    2         END ;
      115    20233                                                              /* Pick up wsn name */
      116    20234    1   BLK$ = P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;

  20234  4 000015   000000 470400 xsym               LDP0    NODE$
         4 000016   000003 471500                    LDP1    3,,PR0
         4 000017   100003 236100                    LDQ     3,,PR1
         4 000020   200017 756100                    STQ     BLK$,,AUTO

      117    20235    1   IF OUT$SYM.COUNT > 8
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:15   

  20235  4 000021   200017 473500                    LDP3    BLK$,,AUTO
         4 000022   300004 236100                    LDQ     4,,PR3
         4 000023   777000 376003                    ANQ     -512,DU
         4 000024   011000 116003                    CMPQ    4608,DU
         4 000025   000033 602000 4                  TNC     s:20258

      118    20236    2   THEN DO ;

      119    20237        /*E*  ERROR:    ASR-E$WSNNAMETOOBIG-C
      120    20238              MESSAGE0: WSN name too big.
      121    20239              MESSAGE1: WSN name can be at most 8 characters.
      122    20240        */
      123    20241           %SCREAM( ERR#=E$WSNNAMETOOBIG , LEVEL=ERROR, MID='R' );

  20253  4 000026   000001 630400 5                  EPPR0   1
         4 000027   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000030   000000 701000 xent               TSX1    ASH$ERROR
         4 000031   000000 011000                    NOP     0

      124    20256    2      RETURN ;

  20256  4 000032   000000 702200 xent               TSX2  ! X66_ARET

      125    20257    2      END ;  /* Then do */
      126    20258    1   USERS_KEY = WSN_KEY ;

  20258  4 000033   000000 100400                    MLR     fill='000'O
         4 000034   000000 000012 2                  ADSC9   WSN_KEY                  cn=0,n=10
         4 000035   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      127    20259    1   USERS_KEY.COUNT = 9 ;

  20259  4 000036   011000 236003                    LDQ     4608,DU
         4 000037   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      128    20260    1   USERS_KEY.UKEY.ACCT = OUT$SYM.TEXT ;
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:16   

  20260  4 000040   300004 236100                    LDQ     4,,PR3
         4 000041   000033 772000                    QRL     27
         4 000042   000000 620006                    EAX0    0,QL
         4 000043   040000 100540                    MLR     fill='040'O
         4 000044   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000045   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8

      129    20261                                                              /**/
      130    20262    1   WSN_KEY = USERS_KEY ;

  20262  4 000046   000000 100400                    MLR     fill='000'O
         4 000047   000000 000012 xsym               ADSC9   USERS_KEY                cn=0,n=10
         4 000050   000000 000012 2                  ADSC9   WSN_KEY                  cn=0,n=10

      131    20263    1   ARS = DSEG2SIZE ;

  20263  4 000051   000000 235000 xsym               LDA     DSEG2SIZE
         4 000052   200010 755100                    STA     ARS,,AUTO

      132    20264    1   CALL ASW$READ_WSN ( DSEG2$, ARS ) ALTRET (DELREC_ERR);

  20264  4 000053   200010 631500                    EPPR1   ARS,,AUTO
         4 000054   200023 451500                    STP1    BLK$+4,,AUTO
         4 000055   000002 236000 5                  LDQ     2
         4 000056   200022 756100                    STQ     BLK$+3,,AUTO
         4 000057   200022 630500                    EPPR0   BLK$+3,,AUTO
         4 000060   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000061   000000 701000 xent               TSX1    ASW$READ_WSN
         4 000062   000305 702000 4                  TSX2    DELREC_ERR

      133    20265    2   IF NOT KL$WSNHDR.INDIRECT# THEN DO;

  20265  4 000063   000000 470400 xsym               LDP0    DSEG2$
         4 000064   000000 234100                    SZN     0,,PR0
         4 000065   000262 604000 4                  TMI     s:20302

PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:17   
      134    20266                            /**/
      135    20267                            /* Delete wsn name from device record  */
      136    20268                            /**/
      137    20269    2      WSNDEV_KEY.ACCT = WSN_KEY.TXT.ACCT ;

  20269  4 000066   040000 100400                    MLR     fill='040'O
         4 000067   000000 200010 2                  ADSC9   WSN_KEY                  cn=1,n=8
         4 000070   000003 200010 2                  ADSC9   WSNDEV_KEY               cn=1,n=8

      138    20270    2      USERS_KEY = WSNDEV_KEY ;

  20270  4 000071   000000 100400                    MLR     fill='000'O
         4 000072   000003 000020 2                  ADSC9   WSNDEV_KEY               cn=0,n=16
         4 000073   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      139    20271    2      WSNDEV$ = PINCRW( DSEG2$, 50) ;

  20271  4 000074   000000 236000 xsym               LDQ     DSEG2$
         4 000075   000062 036003                    ADLQ    50,DU
         4 000076   200005 756100                    STQ     WSNDEV$,,AUTO

      140    20272    2      ARS = DSEG2SIZE - 50 * 4 ;

  20272  4 000077   000000 235000 xsym               LDA     DSEG2SIZE
         4 000100   000310 135007                    SBLA    200,DL
         4 000101   200010 755100                    STA     ARS,,AUTO

      141    20273    2      CALL ASW$ENQ_WSN ALTRET (ENQ_ERR);

  20273  4 000102   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000103   000000 701000 xent               TSX1    ASW$ENQ_WSN
         4 000104   000271 702000 4                  TSX2    ENQ_ERR

      142    20274    2      CALL ASW$READ_WSN ( WSNDEV$, ARS) ALTRET(DELREC_ERR);

  20274  4 000105   200010 630500                    EPPR0   ARS,,AUTO
         4 000106   200023 450500                    STP0    BLK$+4,,AUTO
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:18   
         4 000107   200005 631500                    EPPR1   WSNDEV$,,AUTO
         4 000110   200022 451500                    STP1    BLK$+3,,AUTO
         4 000111   200022 630500                    EPPR0   BLK$+3,,AUTO
         4 000112   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000113   000000 701000 xent               TSX1    ASW$READ_WSN
         4 000114   000305 702000 4                  TSX2    DELREC_ERR

      143    20275    3      DO I = 0 TO KL$WSNDEV.NDEV-1;

  20275  4 000115   200011 450100                    STZ     I,,AUTO
         4 000116   000245 710000 4                  TRA     s:20297+3

      144    20276    3         DEVWSN_KEY.ACCT = KL$WSNDEV.DEV(I) ;

  20276  4 000117   200011 235100                    LDA     I,,AUTO
         4 000120   000003 735000                    ALS     3
         4 000121   200005 470500                    LDP0    WSNDEV$,,AUTO
         4 000122   040000 100505                    MLR     fill='040'O
         4 000123   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         4 000124   000007 200010 2                  ADSC9   DEVWSN_KEY               cn=1,n=8

      145    20277    3         USERS_KEY = DEVWSN_KEY ;

  20277  4 000125   000000 100400                    MLR     fill='000'O
         4 000126   000007 000015 2                  ADSC9   DEVWSN_KEY               cn=0,n=13
         4 000127   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      146    20278    3         CALL ASB$ENQ_HLP ALTRET(ENQ_ERR) ;

  20278  4 000130   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000131   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000132   000271 702000 4                  TSX2    ENQ_ERR

      147    20279    3         DEVWSN$ = PINCRW( DSEG2$, 1000) ;

  20279  4 000133   000000 236000 xsym               LDQ     DSEG2$
         4 000134   001750 036003                    ADLQ    1000,DU
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:19   
         4 000135   200006 756100                    STQ     DEVWSN$,,AUTO

      148    20280    3         ARS = DSEG2SIZE - 1000* 4;

  20280  4 000136   000000 235000 xsym               LDA     DSEG2SIZE
         4 000137   007640 135007                    SBLA    4000,DL
         4 000140   200010 755100                    STA     ARS,,AUTO

      149    20281    3         CALL ASB$READ_HLP (DEVWSN$, ARS) ALTRET ( DEVWSN_ERR ) ;

  20281  4 000141   200010 630500                    EPPR0   ARS,,AUTO
         4 000142   200023 450500                    STP0    BLK$+4,,AUTO
         4 000143   200006 631500                    EPPR1   DEVWSN$,,AUTO
         4 000144   200022 451500                    STP1    BLK$+3,,AUTO
         4 000145   200022 630500                    EPPR0   BLK$+3,,AUTO
         4 000146   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000147   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000150   000237 702000 4                  TSX2    DEVWSN_ERR

      150    20282    4         DO J = 0 TO KL$DEVWSN.NDEV - 1 ;

  20282  4 000151   200012 450100                    STZ     J,,AUTO
         4 000152   000223 710000 4                  TRA     s:20292+3

      151    20283    4            IF KL$DEVWSN.DEV(J) = WSNDEV_KEY.ACCT

  20283  4 000153   200012 235100                    LDA     J,,AUTO
         4 000154   000003 735000                    ALS     3
         4 000155   200006 470500                    LDP0    DEVWSN$,,AUTO
         4 000156   040000 106505                    CMPC    fill='040'O
         4 000157   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         4 000160   000003 200010 2                  ADSC9   WSNDEV_KEY               cn=1,n=8
         4 000161   000220 601000 4                  TNZ     s:20292

      152    20284    5            THEN DO;

      153    20285    6               DO K = J TO KL$DEVWSN.NDEV-2 ;
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:20   

  20285  4 000162   200012 236100                    LDQ     J,,AUTO
         4 000163   200013 756100                    STQ     K,,AUTO
         4 000164   000201 710000 4                  TRA     s:20287+3

      154    20286    6                  KL$DEVWSN.DEV(K) = KL$DEVWSN.DEV(K+1) ;

  20286  4 000165   200013 235100                    LDA     K,,AUTO
         4 000166   000001 735000                    ALS     1
         4 000167   200013 236100                    LDQ     K,,AUTO
         4 000170   000003 736000                    QLS     3
         4 000171   000002 735000                    ALS     2
         4 000172   200006 470500                    LDP0    DEVWSN$,,AUTO
         4 000173   040105 100506                    MLR     fill='040'O
         4 000174   000003 000010                    ADSC9   3,Q,PR0                  cn=0,n=8
         4 000175   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8

      155    20287    6                  END; /* Do k */

  20287  4 000176   200013 235100                    LDA     K,,AUTO
         4 000177   000001 035007                    ADLA    1,DL
         4 000200   200013 755100                    STA     K,,AUTO
         4 000201   200006 470500                    LDP0    DEVWSN$,,AUTO
         4 000202   000000 236100                    LDQ     0,,PR0
         4 000203   000002 136007                    SBLQ    2,DL
         4 000204   000207 604000 4                  TMI     s:20288
         4 000205   200013 116100                    CMPQ    K,,AUTO
         4 000206   000165 603000 4                  TRC     s:20286

      156    20288    5               KL$DEVWSN.NDEV = KL$DEVWSN.NDEV - 1 ;

  20288  4 000207   000000 235100                    LDA     0,,PR0
         4 000210   000001 135007                    SBLA    1,DL
         4 000211   000000 755100                    STA     0,,PR0

      157    20289    5               ARS = ARS - LENGTHC( KL$DEVWSN.DEV(0)) ;

PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:21   
  20289  4 000212   200010 235100                    LDA     ARS,,AUTO
         4 000213   000010 135007                    SBLA    8,DL
         4 000214   200010 755100                    STA     ARS,,AUTO

      158    20290    5               J = KL$DEVWSN.NDEV ;

  20290  4 000215   200006 470500                    LDP0    DEVWSN$,,AUTO
         4 000216   000000 235100                    LDA     0,,PR0
         4 000217   200012 755100                    STA     J,,AUTO

      159    20291    5               END ; /*  Then do */

      160    20292    4            END ; /*  Do j */

  20292  4 000220   200012 235100                    LDA     J,,AUTO
         4 000221   000001 035007                    ADLA    1,DL
         4 000222   200012 755100                    STA     J,,AUTO
         4 000223   200006 470500                    LDP0    DEVWSN$,,AUTO
         4 000224   200012 236100                    LDQ     J,,AUTO
         4 000225   000000 116100                    CMPQ    0,,PR0
         4 000226   000153 602000 4                  TNC     s:20283

      161    20293                /**/
      162    20294    3         CALL ASB$WRITE_HLP (DEVWSN$, ARS );

  20294  4 000227   200010 631500                    EPPR1   ARS,,AUTO
         4 000230   200023 451500                    STP1    BLK$+4,,AUTO
         4 000231   200006 633500                    EPPR3   DEVWSN$,,AUTO
         4 000232   200022 453500                    STP3    BLK$+3,,AUTO
         4 000233   200022 630500                    EPPR0   BLK$+3,,AUTO
         4 000234   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000235   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000236   000000 011000                    NOP     0

      163    20295    3   DEVWSN_ERR:
      164    20296    3         CALL ASB$DEQ_HLP ALTRET (ENQ_ERR);

PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:22   
  20296  4 000237   000002 631400 xsym  DEVWSN_ERR   EPPR1   B_VECTNIL+2
         4 000240   000000 701000 xent               TSX1    ASB$DEQ_HLP
         4 000241   000271 702000 4                  TSX2    ENQ_ERR

      165    20297    3         END ; /*  Do i */

  20297  4 000242   200011 235100                    LDA     I,,AUTO
         4 000243   000001 035007                    ADLA    1,DL
         4 000244   200011 755100                    STA     I,,AUTO
         4 000245   200005 470500                    LDP0    WSNDEV$,,AUTO
         4 000246   200011 236100                    LDQ     I,,AUTO
         4 000247   000000 116100                    CMPQ    0,,PR0
         4 000250   000117 602000 4                  TNC     s:20276

      166    20298    2      USERS_KEY = WSNDEV_KEY ;

  20298  4 000251   000000 100400                    MLR     fill='000'O
         4 000252   000003 000020 2                  ADSC9   WSNDEV_KEY               cn=0,n=16
         4 000253   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      167    20299    2      CALL ASW$DELREC_WSN ALTRET(DELREC_ERR);

  20299  4 000254   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000255   000000 701000 xent               TSX1    ASW$DELREC_WSN
         4 000256   000305 702000 4                  TSX2    DELREC_ERR

      168    20300    2      CALL ASW$DEQ_WSN ;

  20300  4 000257   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000260   000000 701000 xent               TSX1    ASW$DEQ_WSN
         4 000261   000000 011000                    NOP     0

      169    20301    2      END; /*  Not INDIRECT#  */

      170    20302    1   USERS_KEY = WSN_KEY ;

  20302  4 000262   000000 100400                    MLR     fill='000'O
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:23   
         4 000263   000000 000012 2                  ADSC9   WSN_KEY                  cn=0,n=10
         4 000264   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      171    20303                                                              /* Delete wsn */
      172    20304    1   CALL ASW$ENQ_WSN ALTRET( ENQ_ERR ) ;

  20304  4 000265   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000266   000000 701000 xent               TSX1    ASW$ENQ_WSN
         4 000267   000271 702000 4                  TSX2    ENQ_ERR

      173    20305    2   IF '0'B THEN DO ;

  20305  4 000270   000276 710000 4                  TRA     s:20310

  20298  4 000271                       ENQ_ERR      null
      174    20306    2   ENQ_ERR: ;
      175    20307    2      CALL ASH$ERROR( ERR_CODE ) ;

  20307  4 000271   000003 630400 5                  EPPR0   3
         4 000272   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000273   000000 701000 xent               TSX1    ASH$ERROR
         4 000274   000000 011000                    NOP     0

      176    20308    2      RETURN ;

  20308  4 000275   000000 702200 xent               TSX2  ! X66_ARET

      177    20309    2      END ;
      178    20310    1   CALL ASW$DELREC_WSN  ALTRET( DELREC_ERR ) ;

  20310  4 000276   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000277   000000 701000 xent               TSX1    ASW$DELREC_WSN
         4 000300   000305 702000 4                  TSX2    DELREC_ERR

      179    20311    1   CALL ASW$DEQ_WSN ;

  20311  4 000301   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:24   
         4 000302   000000 701000 xent               TSX1    ASW$DEQ_WSN
         4 000303   000000 011000                    NOP     0

      180    20312    2   IF '0'B THEN DO ;

  20312  4 000304   000340 710000 4                  TRA     s:20347

  20308  4 000305                       DELREC_ERR   null
      181    20313    2   DELREC_ERR: ;
      182    20314    2      IF MERR_CODE.CODE = %E$NOKEY

  20314  4 000305   000000 236000 xsym               LDQ     ERR_CODE
         4 000306   377770 376007                    ANQ     131064,DL
         4 000307   001020 116007                    CMPQ    528,DL
         4 000310   000330 601000 4                  TNZ     s:20340

      183    20315    3      THEN DO ;

      184    20316        /*E*      ERROR:    ASR-E$WSNNOEXIST-C
      185    20317                  MESSAGE0: WSN does not exist.
      186    20318                  MESSAGE1: WSN %%U1 %does not exist.
      187    20319        */
      188    20320    3         CALL INDEX( I, AS_BLANK, WSN_KEY.TXT.ACCT ) ;

  20320  4 000311   000000 124400                    SCM     mask='000'O
         4 000312   000000 200010 2                  ADSC9   WSN_KEY                  cn=1,n=8
         4 000313   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000314   200011 000100                    ARG     I,,AUTO

      189    20321    3         AS_FIELD1.COUNT = I ;

  20321  4 000315   200011 236100                    LDQ     I,,AUTO
         4 000316   000033 736000                    QLS     27
         4 000317   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      190    20322    3         AS_FIELD1.TEXT = WSN_KEY.TXT.ACCT ;

PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:25   
  20322  4 000320   040000 100400                    MLR     fill='040'O
         4 000321   000000 200010 2                  ADSC9   WSN_KEY                  cn=1,n=8
         4 000322   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      191    20323              %SCREAM( ERR#=E$WSNNOEXIST , LEVEL=WARN, MID='R' );

  20333  4 000323   000004 630400 5                  EPPR0   4
         4 000324   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000325   000000 701000 xent               TSX1    ASH$WARN
         4 000326   000000 011000                    NOP     0

      192    20338    3         END ; /* Then do */

  20338  4 000327   000334 710000 4                  TRA     s:20341

      193    20339    2      ELSE
      194    20340    2         CALL ASH$ERROR( ERR_CODE, WSN_KEY ) ;

  20340  4 000330   000005 630400 5                  EPPR0   5
         4 000331   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000332   000000 701000 xent               TSX1    ASH$ERROR
         4 000333   000000 011000                    NOP     0

      195    20341    2      CALL ASW$DEQ_WSN ;

  20341  4 000334   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000335   000000 701000 xent               TSX1    ASW$DEQ_WSN
         4 000336   000000 011000                    NOP     0

      196    20342    2      RETURN ;

  20342  4 000337   000000 702200 xent               TSX2  ! X66_ARET

      197    20343    2      END ;
      198    20344        /*E*  ERROR:    ASR-E$WSNREMOVED-C
      199    20345              MESSAGE0: WSN %%U1 %removed.
      200    20346        */
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:26   
      201    20347    1   CALL INDEX( I, AS_BLANK, WSN_KEY.TXT.ACCT ) ;

  20347  4 000340   000000 124400                    SCM     mask='000'O
         4 000341   000000 200010 2                  ADSC9   WSN_KEY                  cn=1,n=8
         4 000342   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000343   200011 000100                    ARG     I,,AUTO

      202    20348    1   AS_FIELD1.COUNT = I ;

  20348  4 000344   200011 236100                    LDQ     I,,AUTO
         4 000345   000033 736000                    QLS     27
         4 000346   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      203    20349    1   AS_FIELD1.TEXT = WSN_KEY.TXT.ACCT ;

  20349  4 000347   040000 100400                    MLR     fill='040'O
         4 000350   000000 200010 2                  ADSC9   WSN_KEY                  cn=1,n=8
         4 000351   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      204    20350        %SCREAM( ERR#=E$WSNREMOVED , LEVEL=INFO, MID='R' );

  20358  4 000352   000007 630400 5                  EPPR0   7
         4 000353   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000354   000000 701000 xent               TSX1    ASH$INFO
         4 000355   000000 011000                    NOP     0

      205    20365                                                              /**/
      206    20366    1   RETURN ;

  20366  4 000356   000000 702200 xent               TSX2  ! X66_ARET
      207    20367                                                              /**/
      208    20368    1   END   ASR$R_WSN ;

PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:27   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ASR$R_WSN.
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:28   

 **** Variables and constants ****

  ****  Section 002  Data  ASR$R_WSN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w STRC(117)   r     1 DEVWSN_KEY                 3-0-0/w STRC(144)   r     1 WSNDEV_KEY
     0-0-0/w STRC(90)    r     1 WSN_KEY

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w UBIN        r     1 ARS                       17-0-0/w PTR         r     1 BLK$
     6-0-0/w PTR         r     1 DEVWSN$                   11-0-0/w UBIN        r     1 I
    12-0-0/w UBIN        r     1 J                         13-0-0/w UBIN        r     1 K
     5-0-0/w PTR         r     1 WSNDEV$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w UBIN        r     1 DSEG2SIZE
     0-0-0/b BIT         r     1 DSEG_FLG                   0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)   r     1 KL$DEVWSN                  0-0-0/w STRC(108)   r     1 KL$WSNDEV
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:29   
     0-0-0/w STRC(180)   r     1 KL$WSNHDR                  0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE


   Procedure ASR$R_WSN requires 239 words for executable code.
   Procedure ASR$R_WSN requires 20 words of local(AUTO) storage.

    No errors detected in file ASR$REMOVE_WSN.:E05TSI    .
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:30   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:31   
          MINI XREF LISTING

ARS
     20020**DCL     20263<<ASSIGN  20264<>CALL    20272<<ASSIGN  20274<>CALL    20280<<ASSIGN  20281<>CALL
     20289<<ASSIGN  20289>>ASSIGN  20294<>CALL
ASA_BRKS_LOC
     17158**DCL     17158--REDEF
ASB$DEQ_HLP
     20087**DCL-ENT 20296--CALL
ASB$ENQ_HLP
     20084**DCL-ENT 20278--CALL
ASB$GETSEG
     20057**DCL-ENT 20214--CALL
ASB$READ_HLP
     20078**DCL-ENT 20281--CALL
ASB$WRITE_HLP
     20081**DCL-ENT 20294--CALL
ASH$ERROR
     20069**DCL-ENT 20228--CALL    20253--CALL    20307--CALL    20340--CALL
ASH$INFO
     20075**DCL-ENT 20358--CALL
ASH$WARN
     20072**DCL-ENT 20333--CALL
ASW$DELREC_WSN
     20054**DCL-ENT 20299--CALL    20310--CALL
ASW$DEQ_WSN
     20063**DCL-ENT 20300--CALL    20311--CALL    20341--CALL
ASW$ENQ_WSN
     20060**DCL-ENT 20273--CALL    20304--CALL
ASW$READ_WSN
     20066**DCL-ENT 20264--CALL    20274--CALL
AS_BLANK
     17018**DCL     20320>>CALLBLT 20347>>CALLBLT
AS_DEFAULT.BANNER_PERM
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:32   
     17851**DCL     17852--REDEF
AS_DEFAULT.BUDGET.MACCT
     17756**DCL     17760--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     17769**DCL     17772--REDEF
AS_DEFAULT.BUDGET.PACCUM
     17752**DCL     17754--REDEF
AS_DEFAULT.BUDGET.PMAXC
     17747**DCL     17749--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     17867**DCL     17868--REDEF   17869--REDEF
AS_DEFAULT_DREC.PASSWORD
     19121**DCL     19125--REDEF
AS_DEFAULT_DREC.RENAME
     19144**DCL     19145--REDEF
AS_DFLT.BANNER_PERM
     17673**DCL     17674--REDEF
AS_DFLT.BUDGET.MACCT
     17578**DCL     17582--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     17591**DCL     17594--REDEF
AS_DFLT.BUDGET.PACCUM
     17574**DCL     17576--REDEF
AS_DFLT.BUDGET.PMAXC
     17569**DCL     17571--REDEF
AS_DFLT.SETUP_CHRA.TXT
     17689**DCL     17690--REDEF   17691--REDEF
AS_FE_MODE
     17024**DCL     17025--REDEF
AS_FIELD1.COUNT
     17155**DCL     20321<<ASSIGN  20348<<ASSIGN
AS_FIELD1.TEXT
     17155**DCL     20322<<ASSIGN  20349<<ASSIGN
AS_MODE
     17021**DCL     17023--REDEF
AS_MOD_USER.ACCESS
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:33   
     19886**DCL     19887--REDEF
AS_MOD_USER.BANNER
     19873**DCL     19874--REDEF
AS_MOD_USER.BANNER_PERM
     19875**DCL     19876--REDEF
AS_MOD_USER.BILL
     19881**DCL     19882--REDEF
AS_MOD_USER.CPROC
     19877**DCL     19878--REDEF
AS_MOD_USER.FEBILL
     19957**DCL     19958--REDEF
AS_MOD_USER.FECXTMEM
     19974**DCL     19975--REDEF
AS_MOD_USER.FEMINTS
     19959**DCL     19960--REDEF
AS_MOD_USER.FEMMEM
     19970**DCL     19971--REDEF
AS_MOD_USER.FEMTIME
     19968**DCL     19969--REDEF
AS_MOD_USER.FEPPRIV
     19965**DCL     19967--REDEF
AS_MOD_USER.FEPRIV
     19962**DCL     19964--REDEF
AS_MOD_USER.FORCE_BIT
     19871**DCL     19872--REDEF
AS_MOD_USER.KEY
     19953**DCL     19955--REDEF
AS_MOD_USER.LASTCPROC
     19879**DCL     19880--REDEF
AS_MOD_USER.LIMITS.DO_
     19927**DCL     19928--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     19943**DCL     19944--REDEF
AS_MOD_USER.LIMITS.LO
     19923**DCL     19924--REDEF
AS_MOD_USER.LIMITS.MEM
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:34   
     19919**DCL     19920--REDEF
AS_MOD_USER.LIMITS.MPRIO
     19947**DCL     19948--REDEF
AS_MOD_USER.LIMITS.PDIS
     19935**DCL     19936--REDEF
AS_MOD_USER.LIMITS.PO
     19931**DCL     19932--REDEF
AS_MOD_USER.LIMITS.TDIS
     19939**DCL     19940--REDEF
AS_MOD_USER.LIMITS.TIME
     19915**DCL     19916--REDEF
AS_MOD_USER.MAXENQ
     19896**DCL     19897--REDEF
AS_MOD_USER.PERM_BIT
     19869**DCL     19870--REDEF
AS_MOD_USER.PPRIV
     19891**DCL     19893--REDEF
AS_MOD_USER.PRIOB
     19898**DCL     19899--REDEF
AS_MOD_USER.PRIV
     19888**DCL     19890--REDEF
AS_MOD_USER.QUAN
     19894**DCL     19895--REDEF
AS_MOD_USER.SETUP
     19867**DCL     19868--REDEF
AS_PROJECT.BANNER_PERM
     18207**DCL     18208--REDEF
AS_PROJECT.BUDGET.MACCT
     18112**DCL     18116--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     18125**DCL     18128--REDEF
AS_PROJECT.BUDGET.PACCUM
     18108**DCL     18110--REDEF
AS_PROJECT.BUDGET.PMAXC
     18103**DCL     18105--REDEF
AS_PROJECT.SETUP_CHRA.TXT
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:35   
     18223**DCL     18224--REDEF   18225--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     18385**DCL     18386--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     18290**DCL     18294--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     18303**DCL     18306--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     18286**DCL     18288--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     18281**DCL     18283--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     18401**DCL     18402--REDEF   18403--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     19607**DCL     19611--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     19630**DCL     19631--REDEF
AS_PROJECT_DREC.PASSWORD
     19445**DCL     19449--REDEF
AS_PROJECT_DREC.RENAME
     19468**DCL     19469--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     18029**DCL     18030--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     17934**DCL     17938--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     17947**DCL     17950--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     17930**DCL     17932--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     17925**DCL     17927--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     18045**DCL     18046--REDEF   18047--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     19283**DCL     19287--REDEF
AS_PROJ_ADMIN_DREC.RENAME
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:36   
     19306**DCL     19307--REDEF
AS_USERS.BANNER_PERM
     17495**DCL     17496--REDEF
AS_USERS.BUDGET.MACCT
     17400**DCL     17404--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     17413**DCL     17416--REDEF
AS_USERS.BUDGET.PACCUM
     17396**DCL     17398--REDEF
AS_USERS.BUDGET.PMAXC
     17391**DCL     17393--REDEF
AS_USERS.SETUP_CHRA.TXT
     17511**DCL     17512--REDEF   17513--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     18563**DCL     18564--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     18468**DCL     18472--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     18481**DCL     18484--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     18464**DCL     18466--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     18459**DCL     18461--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     18579**DCL     18580--REDEF   18581--REDEF
BLK$
     20027**DCL     20148--IMP-PTR 20234<<ASSIGN  20235>>IF      20260>>ASSIGN  20260>>ASSIGN
DELREC_ERR
     20308**LABEL   20264--CALLALT 20274--CALLALT 20299--CALLALT 20310--CALLALT
DEVWSN$
     20018**DCL     20199--IMP-PTR 20279<<ASSIGN  20281<>CALL    20282>>DOINDEX 20283>>IF      20285>>DOINDEX
     20286>>ASSIGN  20286>>ASSIGN  20288>>ASSIGN  20288>>ASSIGN  20290>>ASSIGN  20294<>CALL
DEVWSN_ERR
     20296**LABEL   20281--CALLALT
DEVWSN_KEY
     20044**DCL     20277>>ASSIGN
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:37   
DEVWSN_KEY.ACCT
     20046**DCL     20276<<ASSIGN
DSEG2$
     17160**DCL     20181--IMP-PTR 20264<>CALL    20265>>IF      20271>>ASSIGN  20279>>ASSIGN
DSEG2SIZE
     17160**DCL     20263>>ASSIGN  20272>>ASSIGN  20280>>ASSIGN
DSEG_FLG
     17159**DCL     20212>>IF
ENQ_ERR
     20298**LABEL   20273--CALLALT 20278--CALLALT 20296--CALLALT 20304--CALLALT
ERR_CODE
     17153**DCL     17154--REDEF   20307<>CALL    20340<>CALL
I
     20021**DCL     20275<<DOINDEX 20276>>ASSIGN  20320<<CALLBLT 20321>>ASSIGN  20347<<CALLBLT 20348>>ASSIGN
J
     20022**DCL     20282<<DOINDEX 20283>>IF      20285>>DOINDEX 20290<<ASSIGN
K
     20023**DCL     20285<<DOINDEX 20286>>ASSIGN  20286>>ASSIGN
KL$DEVWSN.DEV
     20201**DCL     20283>>IF      20286<<ASSIGN  20286>>ASSIGN  20289--ASSIGN
KL$DEVWSN.NDEV
     20200**DCL     20282>>DOINDEX 20285>>DOINDEX 20288<<ASSIGN  20288>>ASSIGN  20290>>ASSIGN
KL$WSNDEV.DEV
     20195**DCL     20276>>ASSIGN
KL$WSNDEV.NDEV
     20194**DCL     20275>>DOINDEX
KL$WSNHDR.INDIRECT#
     20182**DCL     20265>>IF
KL_DEFAULT.PASSWORD
     19769**DCL     19773--REDEF
KL_DEFAULT.RENAME
     19792**DCL     19793--REDEF
KL_DFLT.PASSWORD
     18959**DCL     18963--REDEF
KL_DFLT.RENAME
     18982**DCL     18983--REDEF
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:38   
KL_DREC.PASSWORD
     18797**DCL     18801--REDEF
KL_DREC.RENAME
     18820**DCL     18821--REDEF
KL_DREC_CNT.PASSWORD
     18684**DCL     18688--REDEF
KL_DREC_CNT.RENAME
     18707**DCL     18708--REDEF
MERR_CODE.CODE
     17154**DCL     20314>>IF
NODE$
     17151**DCL     20101--IMP-PTR 20234>>ASSIGN
OUT$SYM.COUNT
     20171**DCL     20174--IMP-SIZ 20235>>IF      20260>>ASSIGN
OUT$SYM.TEXT
     20174**DCL     20260>>ASSIGN
P$NODE.SUBLK$
     20134**DCL     20234>>ASSIGN  20234>>ASSIGN
PROJ_KEY.TEXT
     17031**DCL     17031--REDEF
PROJ_KEY.TXT.PROJECT
     17031**DCL     17031--REDEF
REMEM_VAR
     17157**DCL     17157--REDEF
REM_FCMD
     17157**DCL     17158--REDEF
USERS_KEY
     17028**DCL     20258<<ASSIGN  20262>>ASSIGN  20270<<ASSIGN  20277<<ASSIGN  20298<<ASSIGN  20302<<ASSIGN
USERS_KEY.COUNT
     17028**DCL     20259<<ASSIGN
USERS_KEY.TEXT
     17028**DCL     17029--REDEF   17029--REDEF   17029--REDEF   17030--REDEF
USERS_KEY.UKEY.ACCT
     17029**DCL     20260<<ASSIGN
WSNDEV$
     20017**DCL     20193--IMP-PTR 20271<<ASSIGN  20274<>CALL    20275>>DOINDEX 20276>>ASSIGN
PL6.E3A0      #001=ASR$R_WSN File=ASR$REMOVE_WSN.:E05TSI                         TUE 07/29/97 10:52 Page:39   
WSNDEV_KEY
     20040**DCL     20270>>ASSIGN  20298>>ASSIGN
WSNDEV_KEY.ACCT
     20042**DCL     20269<<ASSIGN  20283>>IF
WSN_KEY
     20035**DCL     20258>>ASSIGN  20262<<ASSIGN  20302>>ASSIGN  20340<>CALL
WSN_KEY.TXT.ACCT
     20038**DCL     20269>>ASSIGN  20320>>CALLBLT 20322>>ASSIGN  20347>>CALLBLT 20349>>ASSIGN
