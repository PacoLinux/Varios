VERSION E05

PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:1    
        1        1        /*M* ASB$SEARCH:  Searches and finds a specified record/information.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        /**/
       10       10        /*  ASB$SEARCH:  This module consists of procedures:
       11       11                         ASB$FIND_NUM
       12       12                         ASB$FIND_TWSN_INDEX
       13       13                         ASB$WILD_MATCH
       14       14                         ASB$GET
       15       15                            Entry: ASB$INIT_GET_NEXT
       16       16                            Entry: ASB$GET_NEXT
       17       17                         ASB$ACCT_OK
       18       18                         ASB$CHECK_TYPE
       19       19        */
       20       20        ASB$FIND_NUM: PROC( TWSN$, TYPE, NUM ) ALTRET ;
       21       21        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:2    
       22       22        /*********************************************************************/
       23       23        /*   Parameters      parameters      parameters      parameters      */
       24       24        /*********************************************************************/
       25       25                                                              /**/
       26       26    1   DCL TWSN$ PTR ;
       27       27    1   DCL TYPE CHAR(2) ;
       28       28    1   DCL NUM CHAR(2) ;
       29       29        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:3    
       30       30        /*********************************************************************/
       31       31        /*   Include files   include files   include files   include files   */
       32       32        /*********************************************************************/
       33       33                                                              /**/
       34       34        %INCLUDE           AS_ENTRIES_M   ;
       35     1084        %INCLUDE           AS_SUPER_C     ;
       36     1519        %INCLUDE           AS_PERR_C      ;
       37     2121        %INCLUDE           AS_SUBS_C      ;
       38     3535        %INCLUDE           AS_MAC_C       ;
       39     3615        %INCLUDE           KL_SUPER_C     ;
       40     6517        %INCLUDE           XU_MACRO_C     ;
       41     9623        %INCLUDE           XU_FORMAT_C    ;
       42     9785        %INCLUDE           AS_SUPER_R     ;
       43    12801        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:4    
       44    12802        /*********************************************************************/
       45    12803        /*   Auto data       auto data       auto data       auto data       */
       46    12804        /*********************************************************************/
       47    12805                                                              /**/
       48    12806    1   DCL I UBIN WORD ;
       49    12807    1   DCL J UBIN WORD ;
       50    12808    1   DCL SUBS UBIN WORD ;
       51    12809    1   DCL NUMA(0:99) CHAR(1) UNAL ;
       52    12810    1   DCL NUMR REDEF NUMA CHAR(100) ;
       53    12811    1   DCL CHRS CHAR(1) ;
       54    12812    1   DCL INDX UBIN WORD ;
       55    12813        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:5    
       56    12814        /*********************************************************************/
       57    12815        /*   Local based     local based     local based     local based     */
       58    12816        /*********************************************************************/
       59    12817                                                              /**/
       60    12818        %LIST ;
       61    12819              %KL_TWSNREC(  NAME = KL$TWSNREC ,
       62    12820                            STCLASS="BASED( TWSN$ )");
             12821    1   DCL 1 NAME STCLASS ALIGNED,
             12822    1         2 WSN CHAR(8),          /* WSN name if any assigned   */
             12823    1         2 STATION CHAR(8),      /* Station name */
             12824    1         2 NDEV UBIN WORD,         /* NUMBER OF DEVICES IN DEVS */
             12825    1         2 DEVS (0:0),             /* DEVICE INFORMATION */
             12826    1           3 TYP CHAR(2) UNAL,     /* DEVICE TYPE ('LP') */
             12827    1           3 NUM CHAR(2) UNAL,     /* NUMBER WITHIN TYPE ('01') */
             12828    1           3 ATTR BIT(18) UNAL,    /* ATTRS FROM PROFILE HEADER */
             12829    1           3 DDEV BIT(9) UNAL,     /* FROM PROFILE HEADER.DDEV */
             12830    1           3 IO,            /* FROM PROFILE HEADER.IO */
             12831    1             4 INPUT BIT(1),
             12832    1             4 OUTPUT BIT(1),
             12833    1           3 TDEV BIT(1),        /* IF SET, IT IS SUBDEV FOR TERMINAL */
             12834    1           3 IOM_CONNECTED BIT(1), /* This is an IOM connect device */
             12835    1           3 RESOUCE_DEVICE BIT(1),   /* This is a resource device */
             12836    1           3 * BIT(4),
             12837    1           3 FNAME CHAR(6),   /* FNAME FROM DREC.OSINFO OR BLANKS */
             12838    1           3 * CHAR(2),
             12839    1           3 ACCT CHAR(8) UNAL,    /* LOGON ACCOUNT IF ANY */
             12840    1           3 TERM CHAR(8) UNAL,   /* TERMINAL OR STATION NAME */
             12841    1           3 PNAME,                /* DEFAULT PROFILE */
             12842    1             4 CNT UBIN BYTE UNAL,
             12843    1             4 TXT CHAR(11) UNAL;
       63    12845        %PLIST ;
       64    12846        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:6    
       65    12847        /*********************************************************************/
       66    12848        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       67    12849        /*********************************************************************/
       68    12850                                                              /**/
       69    12851        %ASH$ERROR ;
       70    12854        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:7    
       71    12855        /*********************************************************************/
       72    12856        /*   Procedure       procedure       procedure       procedure       */
       73    12857        /*********************************************************************/
       74    12858                                                              /**/
       75    12859        /*
       76    12860            ***            Begin procedure                    ***
       77    12861        */
       78    12862                                                              /*  Zero numa out.  */
       79    12863    1   NUMA = '0'B ;
       80    12864    1   SUBS = KL$TWSNREC.NDEV ;
       81    12865                                                              /**/
       82    12866    2   DO J = 0 TO SUBS - 1 ;
       83    12867    2      IF KL$TWSNREC.DEVS.TYP(J) = TYPE
       84    12868    2      THEN
       85    12869    3      DO ;                                /* One of this type. */
       86    12870    3         CALL CHARBIN( I, KL$TWSNREC.DEVS.NUM(J) ) ;
       87    12871    3         NUMA(I) = 'U' ;
       88    12872    3         END ; /* Then do */
       89    12873    2      END ; /* Do j */
       90    12874                                                              /**/
       91    12875    1   CHRS = BITASC( '0'B ) ;
       92    12876    1   CALL INDEX( INDX, CHRS, NUMR, 1 ) ALTRET( NONE ) ;
       93    12877    1   CALL BINCHAR( NUM, INDX ) ;
       94    12878    1   RETURN ;
       95    12879                                                              /**/
       96    12880    1   NONE: ;
       97    12881        /*E*  ERROR:    ASB-E$UNABLE_FIND_NUMBER-C
       98    12882              MESSAGE:  Unable to find a number for type% %U1%.
       99    12883        */
      100    12884    1   AS_FIELD1.COUNT = 2 ;
      101    12885    1   AS_FIELD1.TEXT = TYPE ;
      102    12886        %SCREAM( ERR#=E$UNABLE_FIND_NUMBER, LEVEL=ERROR, MID='B' );
      103    12901    1   ALTRETURN ;
      104    12902                                                              /**/
      105    12903    1   END   ASB$FIND_NUM ;
      106    12904        %EOD ;

PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:8    
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$FIND_NUM.

   Procedure ASB$FIND_NUM requires 61 words for executable code.
   Procedure ASB$FIND_NUM requires 38 words of local(AUTO) storage.

PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:9    

 Object Unit name= ASB$FIND_NUM                               File name= ASB$SEARCH.:E05TOU
 UTS= JUL 29 '97 09:27:19.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      1      1  ASB$FIND_NUM
    2   Proc  even  none    61     75  ASB$FIND_NUM
    3  RoData even  none     2      2  ASB$FIND_NUM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        3  ASB$FIND_NUM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:10   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:11   


        1        1        /*M* ASB$SEARCH:  Searches and finds a specified record/information.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        /**/
       10       10        /*  ASB$SEARCH:  This module consists of procedures:
       11       11                         ASB$FIND_NUM
       12       12                         ASB$FIND_TWSN_INDEX
       13       13                         ASB$WILD_MATCH
       14       14                         ASB$GET
       15       15                            Entry: ASB$INIT_GET_NEXT
       16       16                            Entry: ASB$GET_NEXT
       17       17                         ASB$ACCT_OK
       18       18                         ASB$CHECK_TYPE
       19       19        */
       20       20        ASB$FIND_NUM: PROC( TWSN$, TYPE, NUM ) ALTRET ;

     20  2 000000   000000 700200 xent  ASB$FIND_NUM TSX0  ! X66_AUTO_3
         2 000001   000046 000003                    ZERO    38,3

       21       21        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:12   
       22       22        /*********************************************************************/
       23       23        /*   Parameters      parameters      parameters      parameters      */
       24       24        /*********************************************************************/
       25       25                                                              /**/
       26       26    1   DCL TWSN$ PTR ;
       27       27    1   DCL TYPE CHAR(2) ;
       28       28    1   DCL NUM CHAR(2) ;
       29       29        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:13   
       30       30        /*********************************************************************/
       31       31        /*   Include files   include files   include files   include files   */
       32       32        /*********************************************************************/
       33       33                                                              /**/
       34       34        %INCLUDE           AS_ENTRIES_M   ;
       35     1084        %INCLUDE           AS_SUPER_C     ;
       36     1519        %INCLUDE           AS_PERR_C      ;
       37     2121        %INCLUDE           AS_SUBS_C      ;
       38     3535        %INCLUDE           AS_MAC_C       ;
       39     3615        %INCLUDE           KL_SUPER_C     ;
       40     6517        %INCLUDE           XU_MACRO_C     ;
       41     9623        %INCLUDE           XU_FORMAT_C    ;
       42     9785        %INCLUDE           AS_SUPER_R     ;
       43    12801        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:14   
       44    12802        /*********************************************************************/
       45    12803        /*   Auto data       auto data       auto data       auto data       */
       46    12804        /*********************************************************************/
       47    12805                                                              /**/
       48    12806    1   DCL I UBIN WORD ;
       49    12807    1   DCL J UBIN WORD ;
       50    12808    1   DCL SUBS UBIN WORD ;
       51    12809    1   DCL NUMA(0:99) CHAR(1) UNAL ;
       52    12810    1   DCL NUMR REDEF NUMA CHAR(100) ;
       53    12811    1   DCL CHRS CHAR(1) ;
       54    12812    1   DCL INDX UBIN WORD ;
       55    12813        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:15   
       56    12814        /*********************************************************************/
       57    12815        /*   Local based     local based     local based     local based     */
       58    12816        /*********************************************************************/
       59    12817                                                              /**/
       60    12818        %LIST ;
       61    12819              %KL_TWSNREC(  NAME = KL$TWSNREC ,
       62    12820                            STCLASS="BASED( TWSN$ )");
             12821    1   DCL 1 NAME STCLASS ALIGNED,
             12822    1         2 WSN CHAR(8),          /* WSN name if any assigned   */
             12823    1         2 STATION CHAR(8),      /* Station name */
             12824    1         2 NDEV UBIN WORD,         /* NUMBER OF DEVICES IN DEVS */
             12825    1         2 DEVS (0:0),             /* DEVICE INFORMATION */
             12826    1           3 TYP CHAR(2) UNAL,     /* DEVICE TYPE ('LP') */
             12827    1           3 NUM CHAR(2) UNAL,     /* NUMBER WITHIN TYPE ('01') */
             12828    1           3 ATTR BIT(18) UNAL,    /* ATTRS FROM PROFILE HEADER */
             12829    1           3 DDEV BIT(9) UNAL,     /* FROM PROFILE HEADER.DDEV */
             12830    1           3 IO,            /* FROM PROFILE HEADER.IO */
             12831    1             4 INPUT BIT(1),
             12832    1             4 OUTPUT BIT(1),
             12833    1           3 TDEV BIT(1),        /* IF SET, IT IS SUBDEV FOR TERMINAL */
             12834    1           3 IOM_CONNECTED BIT(1), /* This is an IOM connect device */
             12835    1           3 RESOUCE_DEVICE BIT(1),   /* This is a resource device */
             12836    1           3 * BIT(4),
             12837    1           3 FNAME CHAR(6),   /* FNAME FROM DREC.OSINFO OR BLANKS */
             12838    1           3 * CHAR(2),
             12839    1           3 ACCT CHAR(8) UNAL,    /* LOGON ACCOUNT IF ANY */
             12840    1           3 TERM CHAR(8) UNAL,   /* TERMINAL OR STATION NAME */
             12841    1           3 PNAME,                /* DEFAULT PROFILE */
             12842    1             4 CNT UBIN BYTE UNAL,
             12843    1             4 TXT CHAR(11) UNAL;
       63    12845        %PLIST ;
       64    12846        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:16   
       65    12847        /*********************************************************************/
       66    12848        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       67    12849        /*********************************************************************/
       68    12850                                                              /**/
       69    12851        %ASH$ERROR ;
       70    12854        %EJECT ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:17   
       71    12855        /*********************************************************************/
       72    12856        /*   Procedure       procedure       procedure       procedure       */
       73    12857        /*********************************************************************/
       74    12858                                                              /**/
       75    12859        /*
       76    12860            ***            Begin procedure                    ***
       77    12861        */
       78    12862                                                              /*  Zero numa out.  */
       79    12863    1   NUMA = '0'B ;

  12863  2 000002   000100 100400                    MLR     fill='000'O
         2 000003   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000004   200011 000144                    ADSC9   NUMA,,AUTO               cn=0,n=100

       80    12864    1   SUBS = KL$TWSNREC.NDEV ;

  12864  2 000005   200003 470500                    LDP0    @TWSN$,,AUTO
         2 000006   000000 471500                    LDP1    0,,PR0
         2 000007   100004 235100                    LDA     4,,PR1
         2 000010   200010 755100                    STA     SUBS,,AUTO

       81    12865                                                              /**/
       82    12866    2   DO J = 0 TO SUBS - 1 ;

  12866  2 000011   200007 450100                    STZ     J,,AUTO
         2 000012   000037 710000 2                  TRA     s:12873+3

       83    12867    2      IF KL$TWSNREC.DEVS.TYP(J) = TYPE

  12867  2 000013   200003 470500                    LDP0    @TWSN$,,AUTO
         2 000014   000000 471500                    LDP1    0,,PR0
         2 000015   200007 236100                    LDQ     J,,AUTO
         2 000016   000054 402007                    MPY     44,DL
         2 000017   200004 473500                    LDP3    @TYPE,,AUTO
         2 000020   040100 106506                    CMPC    fill='040'O
         2 000021   100005 000002                    ADSC9   5,Q,PR1                  cn=0,n=2
         2 000022   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:18   
         2 000023   000034 601000 2                  TNZ     s:12873

       84    12868    2      THEN
       85    12869    3      DO ;                                /* One of this type. */

       86    12870    3         CALL CHARBIN( I, KL$TWSNREC.DEVS.NUM(J) ) ;

  12870  2 000024   000100 305506                    DTB
         2 000025   100005 430002                    NDSC9   5,Q,PR1                  cn=2,s=nosgn,sf=0,n=2
         2 000026   200044 000010                    NDSC9   INDX+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 000027   200045 235100                    LDA     INDX+2,,AUTO
         2 000030   200006 755100                    STA     I,,AUTO

       87    12871    3         NUMA(I) = 'U' ;

  12871  2 000031   040105 100400                    MLR     fill='040'O
         2 000032   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000033   200011 000001                    ADSC9   NUMA,A,AUTO              cn=0,n=1

       88    12872    3         END ; /* Then do */

       89    12873    2      END ; /* Do j */

  12873  2 000034   200007 235100                    LDA     J,,AUTO
         2 000035   000001 035007                    ADLA    1,DL
         2 000036   200007 755100                    STA     J,,AUTO
         2 000037   200007 236100                    LDQ     J,,AUTO
         2 000040   200010 116100                    CMPQ    SUBS,,AUTO
         2 000041   000013 602000 2                  TNC     s:12867

       90    12874                                                              /**/
       91    12875    1   CHRS = BITASC( '0'B ) ;

  12875  2 000042   000000 236003                    LDQ     0,DU
         2 000043   200042 756100                    STQ     CHRS,,AUTO

       92    12876    1   CALL INDEX( INDX, CHRS, NUMR, 1 ) ALTRET( NONE ) ;
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:19   

  12876  2 000044   000100 124500                    SCM     mask='000'O
         2 000045   200011 200143                    ADSC9   NUMA,,AUTO               cn=1,n=99
         2 000046   200042 000001                    ADSC9   CHRS,,AUTO               cn=0,n=1
         2 000047   200043 000100                    ARG     INDX,,AUTO
         2 000050   200043 054100                    AOS     INDX,,AUTO
         2 000051   000062 606400 2                  TTN     NONE

       93    12877    1   CALL BINCHAR( NUM, INDX ) ;

  12877  2 000052   200043 235100                    LDA     INDX,,AUTO
         2 000053   000044 773000                    LRL     36
         2 000054   200044 757100                    STAQ    INDX+1,,AUTO
         2 000055   200005 471500                    LDP1    @NUM,,AUTO
         2 000056   000100 301500                    BTD
         2 000057   200044 000010                    NDSC9   INDX+1,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 000060   100000 030002                    NDSC9   0,,PR1                   cn=0,s=nosgn,sf=0,n=2

       94    12878    1   RETURN ;

  12878  2 000061   000000 702200 xent               TSX2  ! X66_ARET

  12877  2 000062                       NONE         null
       95    12879                                                              /**/
       96    12880    1   NONE: ;
       97    12881        /*E*  ERROR:    ASB-E$UNABLE_FIND_NUMBER-C
       98    12882              MESSAGE:  Unable to find a number for type% %U1%.
       99    12883        */
      100    12884    1   AS_FIELD1.COUNT = 2 ;

  12884  2 000062   002000 236003                    LDQ     1024,DU
         2 000063   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      101    12885    1   AS_FIELD1.TEXT = TYPE ;

  12885  2 000064   200004 470500                    LDP0    @TYPE,,AUTO
         2 000065   040000 100500                    MLR     fill='040'O
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:20   
         2 000066   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         2 000067   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      102    12886        %SCREAM( ERR#=E$UNABLE_FIND_NUMBER, LEVEL=ERROR, MID='B' );

  12898  2 000070   000001 630400 3                  EPPR0   1
         2 000071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000072   000000 701000 xent               TSX1    ASH$ERROR
         2 000073   000000 011000                    NOP     0

      103    12901    1   ALTRETURN ;

  12901  2 000074   000000 702200 xent               TSX2  ! X66_AALT
      104    12902                                                              /**/
      105    12903    1   END   ASB$FIND_NUM ;
      106    12904        %EOD ;

PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:21   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$FIND_NUM.
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:22   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @NUM                       3-0-0/w PTR         r     1 @TWSN$
     4-0-0/w PTR         r     1 @TYPE                     42-0-0/c CHAR        r     1 CHRS
     6-0-0/w UBIN        r     1 I                         43-0-0/w UBIN        r     1 INDX
     7-0-0/w UBIN        r     1 J                         *0-0-0/c CHAR(2)     r     1 NUM
    11-0-0/c CHAR        r     1 NUMA(0:99)                11-0-0/c CHAR(100)   r     1 NUMR
    10-0-0/w UBIN        r     1 SUBS                      *0-0-0/w PTR         r     1 TWSN$
    *0-0-0/c CHAR(2)     r     1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 KL$TWSNREC


   Procedure ASB$FIND_NUM requires 61 words for executable code.
   Procedure ASB$FIND_NUM requires 38 words of local(AUTO) storage.
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:23   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:24   
          MINI XREF LISTING

ASA_BRKS_LOC
      9949**DCL      9949--REDEF
ASH$ERROR
     12852**DCL-ENT 12898--CALL
AS_DEFAULT.BANNER_PERM
     10642**DCL     10643--REDEF
AS_DEFAULT.BUDGET.MACCT
     10547**DCL     10551--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10560**DCL     10563--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10543**DCL     10545--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10538**DCL     10540--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10658**DCL     10659--REDEF   10660--REDEF
AS_DEFAULT_DREC.PASSWORD
     11912**DCL     11916--REDEF
AS_DEFAULT_DREC.RENAME
     11935**DCL     11936--REDEF
AS_DFLT.BANNER_PERM
     10464**DCL     10465--REDEF
AS_DFLT.BUDGET.MACCT
     10369**DCL     10373--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10382**DCL     10385--REDEF
AS_DFLT.BUDGET.PACCUM
     10365**DCL     10367--REDEF
AS_DFLT.BUDGET.PMAXC
     10360**DCL     10362--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10480**DCL     10481--REDEF   10482--REDEF
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:25   
AS_FE_MODE
      9815**DCL      9816--REDEF
AS_FIELD1.COUNT
      9946**DCL     12884<<ASSIGN
AS_FIELD1.TEXT
      9946**DCL     12885<<ASSIGN
AS_MODE
      9812**DCL      9814--REDEF
AS_MOD_USER.ACCESS
     12677**DCL     12678--REDEF
AS_MOD_USER.BANNER
     12664**DCL     12665--REDEF
AS_MOD_USER.BANNER_PERM
     12666**DCL     12667--REDEF
AS_MOD_USER.BILL
     12672**DCL     12673--REDEF
AS_MOD_USER.CPROC
     12668**DCL     12669--REDEF
AS_MOD_USER.FEBILL
     12748**DCL     12749--REDEF
AS_MOD_USER.FECXTMEM
     12765**DCL     12766--REDEF
AS_MOD_USER.FEMINTS
     12750**DCL     12751--REDEF
AS_MOD_USER.FEMMEM
     12761**DCL     12762--REDEF
AS_MOD_USER.FEMTIME
     12759**DCL     12760--REDEF
AS_MOD_USER.FEPPRIV
     12756**DCL     12758--REDEF
AS_MOD_USER.FEPRIV
     12753**DCL     12755--REDEF
AS_MOD_USER.FORCE_BIT
     12662**DCL     12663--REDEF
AS_MOD_USER.KEY
     12744**DCL     12746--REDEF
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:26   
AS_MOD_USER.LASTCPROC
     12670**DCL     12671--REDEF
AS_MOD_USER.LIMITS.DO_
     12718**DCL     12719--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12734**DCL     12735--REDEF
AS_MOD_USER.LIMITS.LO
     12714**DCL     12715--REDEF
AS_MOD_USER.LIMITS.MEM
     12710**DCL     12711--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12738**DCL     12739--REDEF
AS_MOD_USER.LIMITS.PDIS
     12726**DCL     12727--REDEF
AS_MOD_USER.LIMITS.PO
     12722**DCL     12723--REDEF
AS_MOD_USER.LIMITS.TDIS
     12730**DCL     12731--REDEF
AS_MOD_USER.LIMITS.TIME
     12706**DCL     12707--REDEF
AS_MOD_USER.MAXENQ
     12687**DCL     12688--REDEF
AS_MOD_USER.PERM_BIT
     12660**DCL     12661--REDEF
AS_MOD_USER.PPRIV
     12682**DCL     12684--REDEF
AS_MOD_USER.PRIOB
     12689**DCL     12690--REDEF
AS_MOD_USER.PRIV
     12679**DCL     12681--REDEF
AS_MOD_USER.QUAN
     12685**DCL     12686--REDEF
AS_MOD_USER.SETUP
     12658**DCL     12659--REDEF
AS_PROJECT.BANNER_PERM
     10998**DCL     10999--REDEF
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:27   
AS_PROJECT.BUDGET.MACCT
     10903**DCL     10907--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10916**DCL     10919--REDEF
AS_PROJECT.BUDGET.PACCUM
     10899**DCL     10901--REDEF
AS_PROJECT.BUDGET.PMAXC
     10894**DCL     10896--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11014**DCL     11015--REDEF   11016--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11176**DCL     11177--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11081**DCL     11085--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11094**DCL     11097--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11077**DCL     11079--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11072**DCL     11074--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11192**DCL     11193--REDEF   11194--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12398**DCL     12402--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12421**DCL     12422--REDEF
AS_PROJECT_DREC.PASSWORD
     12236**DCL     12240--REDEF
AS_PROJECT_DREC.RENAME
     12259**DCL     12260--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10820**DCL     10821--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10725**DCL     10729--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10738**DCL     10741--REDEF
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:28   
AS_PROJ_ADMIN.BUDGET.PACCUM
     10721**DCL     10723--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10716**DCL     10718--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10836**DCL     10837--REDEF   10838--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12074**DCL     12078--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12097**DCL     12098--REDEF
AS_USERS.BANNER_PERM
     10286**DCL     10287--REDEF
AS_USERS.BUDGET.MACCT
     10191**DCL     10195--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10204**DCL     10207--REDEF
AS_USERS.BUDGET.PACCUM
     10187**DCL     10189--REDEF
AS_USERS.BUDGET.PMAXC
     10182**DCL     10184--REDEF
AS_USERS.SETUP_CHRA.TXT
     10302**DCL     10303--REDEF   10304--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11354**DCL     11355--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11259**DCL     11263--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11272**DCL     11275--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11255**DCL     11257--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11250**DCL     11252--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11370**DCL     11371--REDEF   11372--REDEF
CHRS
     12811**DCL     12875<<ASSIGN  12876>>CALLBLT
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:29   
ERR_CODE
      9944**DCL      9945--REDEF
I
     12806**DCL     12870<<CALLBLT 12871>>ASSIGN
INDX
     12812**DCL     12876<<CALLBLT 12877>>CALLBLT
J
     12807**DCL     12866<<DOINDEX 12867>>IF      12870>>CALLBLT
KL$TWSNREC.DEVS.NUM
     12827**DCL     12870>>CALLBLT
KL$TWSNREC.DEVS.TYP
     12826**DCL     12867>>IF
KL$TWSNREC.NDEV
     12824**DCL     12864>>ASSIGN
KL_DEFAULT.PASSWORD
     12560**DCL     12564--REDEF
KL_DEFAULT.RENAME
     12583**DCL     12584--REDEF
KL_DFLT.PASSWORD
     11750**DCL     11754--REDEF
KL_DFLT.RENAME
     11773**DCL     11774--REDEF
KL_DREC.PASSWORD
     11588**DCL     11592--REDEF
KL_DREC.RENAME
     11611**DCL     11612--REDEF
KL_DREC_CNT.PASSWORD
     11475**DCL     11479--REDEF
KL_DREC_CNT.RENAME
     11498**DCL     11499--REDEF
NONE
     12877**LABEL   12876--CALLALT
NUM
        28**DCL        20--PROC    12877<<CALLBLT
NUMA
     12809**DCL     12810--REDEF   12863<<ASSIGN  12871<<ASSIGN
PL6.E3A0      #001=ASB$FIND_NUM File=ASB$SEARCH.:E05TSI                          TUE 07/29/97 09:27 Page:30   
NUMR
     12810**DCL     12876>>CALLBLT
PROJ_KEY.TEXT
      9822**DCL      9822--REDEF
PROJ_KEY.TXT.PROJECT
      9822**DCL      9822--REDEF
REMEM_VAR
      9948**DCL      9948--REDEF
REM_FCMD
      9948**DCL      9949--REDEF
SUBS
     12808**DCL     12864<<ASSIGN  12866>>DOINDEX
TWSN$
        26**DCL        20--PROC    12821--IMP-PTR 12864>>ASSIGN  12867>>IF      12870>>CALLBLT
TYPE
        27**DCL        20--PROC    12867>>IF      12885>>ASSIGN
USERS_KEY.TEXT
      9819**DCL      9820--REDEF    9820--REDEF    9820--REDEF    9821--REDEF

PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:31   
      107        1        /*M* ASB$FIND_TWSN_INDEX - finds an index into a TWSN record. */
      108        2        /*T***********************************************************/
      109        3        /*T*                                                         */
      110        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      111        5        /*T*                                                         */
      112        6        /*T***********************************************************/
      113        7
      114        8        /*P*  NAME:       ASB$FIND_TWSN_INDEX
      115        9              PURPOSE:    Finds the TWSN record index for a device or console.
      116       10        */
      117       11
      118       12        /*D*  NAME:       ASB$FIND_TWSN_INDEX
      119       13              PURPOSE:    Finds the TWSN record index for a console or device.
      120       14              CALL:    CALL ASB$FIND_TWSN_INDEX(TREC$,DREC$,TWSNR$,TERM_FLG,
      121       15                                                DEVICE1, TWSN_INDEX) ALTRET(LABEL);
      122       16              INPUT:      TREC$ - pointer to device record for the terminal the
      123       17                                 device/console is associated with.
      124       18                          DREC$ - pointer to device record for the device/console.
      125       19                          TWSNR$ - pointer to TWSN record.
      126       20                          TERM_FLG  - '1'B => looking for a terminal device's
      127       21                                      TWSN index.
      128       22                          DEVICE1   - name of the device.
      129       23              OUTPUT:     TWSN_INDEX - the TWSN record index for the device/console.
      130       24              DESCRIPTION:
      131       25                  The procedure finds the index into TWSN record for the
      132       26                  device or console and returns it in TWSN_INDEX.  If it can't
      133       27                  find the index the procedure issues an error and altreturns.
      134       28        */
      135       29
      136       30        ASB$FIND_TWSN_INDEX: PROC( TREC$, DREC$, TWSNR$, TERM_FLG, DEVICE1, TWSN_INDEX )
                30            ALTRET ;
      137       31
      138       32        /********************************************************************/
      139       33        /*        Include files   include files   include files             */
      140       34        /********************************************************************/
      141       35
      142       36        %INCLUDE           KC$CGBLK       ;
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:32   
      143       84        %INCLUDE           AS_ENTRIES_M   ;
      144     1134        %INCLUDE           AS_SUPER_C     ;
      145     1569        %INCLUDE           AS_PERR_C      ;
      146     2171        %INCLUDE           AS_SUBS_C      ;
      147     3585        %INCLUDE           AS_MAC_C       ;
      148     3665        %INCLUDE           KL_SUPER_C     ;
      149     6567        %INCLUDE           XU_MACRO_C     ;
      150     9673        %INCLUDE           XU_FORMAT_C    ;
      151     9835        %INCLUDE           AS_SUPER_R     ;
      152    12851
      153    12852        /*******************************************************************/
      154    12853        /*    Parameters      parameters      parameters      parameters   */
      155    12854        /*******************************************************************/
      156    12855
      157    12856    1   DCL TREC$ PTR ;
      158    12857    1   DCL DREC$ PTR ;
      159    12858    1   DCL TWSNR$ PTR ;
      160    12859    1   DCL TERM_FLG BIT(1) ALIGNED;
      161    12860    1   DCL DEVICE1 CHAR(8) ;
      162    12861    1   DCL TWSN_INDEX UBIN ;
      163    12862
      164    12863        /*******************************************************************/
      165    12864        /*    Based data      based data      based data      based data   */
      166    12865        /*******************************************************************/
      167    12866
      168    12867        %KL_DREC( NAME=KL$TREC, STCLASS="BASED(TREC$)", LAST="," ) ;
      169    12980        %KL_GJOB( NAME=GJOB, LVL=2, LAST=";", STCLASS=BASED );
      170    13004
      171    13005        %KL_DREC( NAME=KL$DREC, STCLASS="BASED(DREC$)", LAST="," ) ;
      172    13118        %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST=";" );
      173    13144
      174    13145        %KL_TWSNREC( NAME=KL$TWSNREC, STCLASS="BASED(TWSNR$)" ) ;
      175    13170
      176    13171        /******************************************************************/
      177    13172        /*    Auto data       auto data       auto data       auto data   */
      178    13173        /******************************************************************/
      179    13174
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:33   
      180    13175    1   DCL DEVICE2 CHAR(8) ;
      181    13176    1   DCL I UBIN ;
      182    13177    1   DCL SS# UBIN ;
      183    13178
      184    13179
      185    13180        /*****************************************************************/
      186    13181        /*    Entry       entry       entry       entry       entry      */
      187    13182        /*****************************************************************/
      188    13183
      189    13184        %ASH$ERROR ;
      190    13187
      191    13188        /******************************************************************/
      192    13189        /*    Procedure       procedure       procedure       procedure   */
      193    13190        /******************************************************************/
      194    13191
      195    13192
      196    13193    1   IF TERM_FLG
      197    13194    2   THEN DO;                    /* Find twsn index for a terminal device */
      198    13195    3      DO I = 0 TO KL$TWSNREC.NDEV-1;
      199    13196    3         CALL CONCAT( DEVICE2, KL$TWSNREC.DEVS.TYP(I),
      200    13197    3              KL$TWSNREC.DEVS.NUM(I) ) ;
      201    13198    4         IF DEVICE1 = DEVICE2 THEN DO ;
      202    13199    4            TWSN_INDEX = I ;
      203    13200    4            RETURN ;
      204    13201    4            END ;
      205    13202    3         END;
      206    13203    2      END;
      207    13204    2   ELSE DO ;
      208    13205    2      SS# = 0 ;
      209    13206    3      DO I = 0 TO KL$TWSNREC.NDEV-1 ;
      210    13207        /**********
      211    13208                      If KL$TREC.KL_SS.CNT(SS#) ~= 0
      212    13209                              and  KL$TREC.KL_SS.SGN.TYPE(SS#) = KL$TWSNREC.DEVS.TYP(I)
      213    13210                              and  KL$TREC.KL_SS.SGN.NUM(SS#) = KL$TWSNREC.DEVS.NUM(I)
      214    13211                      then
      215    13212                          SS# = SS# + 1 ;
      216    13213                      else do ;
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:34   
      217    13214        **********/
      218    13215    4         IF DEVICE1 = KL$TWSNREC.DEVS.ACCT(I) THEN DO ;
      219    13216    4            TWSN_INDEX = I ;
      220    13217    4            RETURN ;
      221    13218    4            END ;
      222    13219    3         END ;
      223    13220    2      END ;
      224    13221
      225    13222        /*E* ERROR:   ASB-E$CANT_FIND_IN_TWSN_REC-C
      226    13223             MESSAGE: Unable to find %U1 in TWSN%U2 record.
      227    13224        */
      228    13225    1   CALL INDEX( I, AS_BLANK, DEVICE1 ) ;
      229    13226    1   AS_FIELD1.COUNT = I ;
      230    13227    1   AS_FIELD1.TEXT  = DEVICE1 ;
      231    13228    1   AS_FIELD2.COUNT = 4 ;
      232    13229    1   AS_FIELD2.TEXT  = KL$TREC.TWSN# ;
      233    13230        %SCREAM( ERR#=E$CANT_FIND_IN_TWSN_REC, LEVEL=ERROR, MID='B' ) ;
      234    13245    1   ALTRETURN ;
      235    13246
      236    13247
      237    13248    1   END ASB$FIND_TWSN_INDEX ;
      238    13249        %EOD ;

PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:35   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$FIND_TWSN_INDEX.

   Procedure ASB$FIND_TWSN_INDEX requires 83 words for executable code.
   Procedure ASB$FIND_TWSN_INDEX requires 14 words of local(AUTO) storage.

PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:36   

 Object Unit name= ASB$FIND_TWSN_INDEX                        File name= ASB$SEARCH.:E05TOU
 UTS= JUL 29 '97 09:28:19.08 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      1      1  ASB$FIND_TWSN_INDEX
    2   Proc  even  none    83    123  ASB$FIND_TWSN_INDEX
    3  RoData even  none     1      1  ASB$FIND_TWSN_INDEX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        6  ASB$FIND_TWSN_INDEX

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:37   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  ERR_CODE                              AS_FIELD1
     AS_FIELD2                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:38   


      107        1        /*M* ASB$FIND_TWSN_INDEX - finds an index into a TWSN record. */
      108        2        /*T***********************************************************/
      109        3        /*T*                                                         */
      110        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      111        5        /*T*                                                         */
      112        6        /*T***********************************************************/
      113        7
      114        8        /*P*  NAME:       ASB$FIND_TWSN_INDEX
      115        9              PURPOSE:    Finds the TWSN record index for a device or console.
      116       10        */
      117       11
      118       12        /*D*  NAME:       ASB$FIND_TWSN_INDEX
      119       13              PURPOSE:    Finds the TWSN record index for a console or device.
      120       14              CALL:    CALL ASB$FIND_TWSN_INDEX(TREC$,DREC$,TWSNR$,TERM_FLG,
      121       15                                                DEVICE1, TWSN_INDEX) ALTRET(LABEL);
      122       16              INPUT:      TREC$ - pointer to device record for the terminal the
      123       17                                 device/console is associated with.
      124       18                          DREC$ - pointer to device record for the device/console.
      125       19                          TWSNR$ - pointer to TWSN record.
      126       20                          TERM_FLG  - '1'B => looking for a terminal device's
      127       21                                      TWSN index.
      128       22                          DEVICE1   - name of the device.
      129       23              OUTPUT:     TWSN_INDEX - the TWSN record index for the device/console.
      130       24              DESCRIPTION:
      131       25                  The procedure finds the index into TWSN record for the
      132       26                  device or console and returns it in TWSN_INDEX.  If it can't
      133       27                  find the index the procedure issues an error and altreturns.
      134       28        */
      135       29
      136       30        ASB$FIND_TWSN_INDEX: PROC( TREC$, DREC$, TWSNR$, TERM_FLG, DEVICE1, TWSN_INDEX )
                30            ALTRET ;

     30  2 000000   000000 700200 xent  ASB$FIND_TW* TSX0  ! X66_AUTO_N
         2 000001   000016 000006                    ZERO    14,6

      137       31
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:39   
      138       32        /********************************************************************/
      139       33        /*        Include files   include files   include files             */
      140       34        /********************************************************************/
      141       35
      142       36        %INCLUDE           KC$CGBLK       ;
      143       84        %INCLUDE           AS_ENTRIES_M   ;
      144     1134        %INCLUDE           AS_SUPER_C     ;
      145     1569        %INCLUDE           AS_PERR_C      ;
      146     2171        %INCLUDE           AS_SUBS_C      ;
      147     3585        %INCLUDE           AS_MAC_C       ;
      148     3665        %INCLUDE           KL_SUPER_C     ;
      149     6567        %INCLUDE           XU_MACRO_C     ;
      150     9673        %INCLUDE           XU_FORMAT_C    ;
      151     9835        %INCLUDE           AS_SUPER_R     ;
      152    12851
      153    12852        /*******************************************************************/
      154    12853        /*    Parameters      parameters      parameters      parameters   */
      155    12854        /*******************************************************************/
      156    12855
      157    12856    1   DCL TREC$ PTR ;
      158    12857    1   DCL DREC$ PTR ;
      159    12858    1   DCL TWSNR$ PTR ;
      160    12859    1   DCL TERM_FLG BIT(1) ALIGNED;
      161    12860    1   DCL DEVICE1 CHAR(8) ;
      162    12861    1   DCL TWSN_INDEX UBIN ;
      163    12862
      164    12863        /*******************************************************************/
      165    12864        /*    Based data      based data      based data      based data   */
      166    12865        /*******************************************************************/
      167    12866
      168    12867        %KL_DREC( NAME=KL$TREC, STCLASS="BASED(TREC$)", LAST="," ) ;
      169    12980        %KL_GJOB( NAME=GJOB, LVL=2, LAST=";", STCLASS=BASED );
      170    13004
      171    13005        %KL_DREC( NAME=KL$DREC, STCLASS="BASED(DREC$)", LAST="," ) ;
      172    13118        %KC$CGID( FPTN=KC$CGID, STCLASS=STCLASS, LVL=2, LAST=";" );
      173    13144
      174    13145        %KL_TWSNREC( NAME=KL$TWSNREC, STCLASS="BASED(TWSNR$)" ) ;
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:40   
      175    13170
      176    13171        /******************************************************************/
      177    13172        /*    Auto data       auto data       auto data       auto data   */
      178    13173        /******************************************************************/
      179    13174
      180    13175    1   DCL DEVICE2 CHAR(8) ;
      181    13176    1   DCL I UBIN ;
      182    13177    1   DCL SS# UBIN ;
      183    13178
      184    13179
      185    13180        /*****************************************************************/
      186    13181        /*    Entry       entry       entry       entry       entry      */
      187    13182        /*****************************************************************/
      188    13183
      189    13184        %ASH$ERROR ;
      190    13187
      191    13188        /******************************************************************/
      192    13189        /*    Procedure       procedure       procedure       procedure   */
      193    13190        /******************************************************************/
      194    13191
      195    13192
      196    13193    1   IF TERM_FLG

  13193  2 000002   200006 470500                    LDP0    @TERM_FLG,,AUTO
         2 000003   000000 234100                    SZN     0,,PR0
         2 000004   000044 605000 2                  TPL     s:13205

      197    13194    2   THEN DO;                    /* Find twsn index for a terminal device */

      198    13195    3      DO I = 0 TO KL$TWSNREC.NDEV-1;

  13195  2 000005   200013 450100                    STZ     I,,AUTO
         2 000006   000036 710000 2                  TRA     s:13202+3

      199    13196    3         CALL CONCAT( DEVICE2, KL$TWSNREC.DEVS.TYP(I),

  13196  2 000007   200005 470500                    LDP0    @TWSNR$,,AUTO
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:41   
         2 000010   000000 471500                    LDP1    0,,PR0
         2 000011   200013 236100                    LDQ     I,,AUTO
         2 000012   000013 402007                    MPY     11,DL
         2 000013   100005 220106                    LDX0    5,QL,PR1
         2 000014   200011 740100                    STX0    DEVICE2,,AUTO
         2 000015   200013 236100                    LDQ     I,,AUTO
         2 000016   000054 402007                    MPY     44,DL
         2 000017   040100 100506                    MLR     fill='040'O
         2 000020   100005 400002                    ADSC9   5,Q,PR1                  cn=2,n=2
         2 000021   200011 400006                    ADSC9   DEVICE2,,AUTO            cn=2,n=6

      200    13197    3              KL$TWSNREC.DEVS.NUM(I) ) ;
      201    13198    4         IF DEVICE1 = DEVICE2 THEN DO ;

  13198  2 000022   200007 470500                    LDP0    @DEVICE1,,AUTO
         2 000023   040100 106500                    CMPC    fill='040'O
         2 000024   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         2 000025   200011 000010                    ADSC9   DEVICE2,,AUTO            cn=0,n=8
         2 000026   000033 601000 2                  TNZ     s:13202

      202    13199    4            TWSN_INDEX = I ;

  13199  2 000027   200010 471500                    LDP1    @TWSN_INDEX,,AUTO
         2 000030   200013 235100                    LDA     I,,AUTO
         2 000031   100000 755100                    STA     0,,PR1

      203    13200    4            RETURN ;

  13200  2 000032   000000 702200 xent               TSX2  ! X66_ARET

      204    13201    4            END ;
      205    13202    3         END;

  13202  2 000033   200013 235100                    LDA     I,,AUTO
         2 000034   000001 035007                    ADLA    1,DL
         2 000035   200013 755100                    STA     I,,AUTO
         2 000036   200005 470500                    LDP0    @TWSNR$,,AUTO
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:42   
         2 000037   000000 471500                    LDP1    0,,PR0
         2 000040   200013 236100                    LDQ     I,,AUTO
         2 000041   100004 116100                    CMPQ    4,,PR1
         2 000042   000007 602000 2                  TNC     s:13196

      206    13203    2      END;

  13203  2 000043   000074 710000 2                  TRA     s:13225

      207    13204    2   ELSE DO ;

      208    13205    2      SS# = 0 ;

  13205  2 000044   200014 450100                    STZ     SS#,,AUTO

      209    13206    3      DO I = 0 TO KL$TWSNREC.NDEV-1 ;

  13206  2 000045   200013 450100                    STZ     I,,AUTO
         2 000046   000067 710000 2                  TRA     s:13219+3

      210    13207        /**********
      211    13208                      If KL$TREC.KL_SS.CNT(SS#) ~= 0
      212    13209                              and  KL$TREC.KL_SS.SGN.TYPE(SS#) = KL$TWSNREC.DEVS.TYP(I)
      213    13210                              and  KL$TREC.KL_SS.SGN.NUM(SS#) = KL$TWSNREC.DEVS.NUM(I)
      214    13211                      then
      215    13212                          SS# = SS# + 1 ;
      216    13213                      else do ;
      217    13214        **********/
      218    13215    4         IF DEVICE1 = KL$TWSNREC.DEVS.ACCT(I) THEN DO ;

  13215  2 000047   200005 470500                    LDP0    @TWSNR$,,AUTO
         2 000050   000000 471500                    LDP1    0,,PR0
         2 000051   200013 236100                    LDQ     I,,AUTO
         2 000052   000054 402007                    MPY     44,DL
         2 000053   200007 473500                    LDP3    @DEVICE1,,AUTO
         2 000054   040106 106500                    CMPC    fill='040'O
         2 000055   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:43   
         2 000056   100011 000010                    ADSC9   9,Q,PR1                  cn=0,n=8
         2 000057   000064 601000 2                  TNZ     s:13219

      219    13216    4            TWSN_INDEX = I ;

  13216  2 000060   200010 474500                    LDP4    @TWSN_INDEX,,AUTO
         2 000061   200013 235100                    LDA     I,,AUTO
         2 000062   400000 755100                    STA     0,,PR4

      220    13217    4            RETURN ;

  13217  2 000063   000000 702200 xent               TSX2  ! X66_ARET

      221    13218    4            END ;
      222    13219    3         END ;

  13219  2 000064   200013 235100                    LDA     I,,AUTO
         2 000065   000001 035007                    ADLA    1,DL
         2 000066   200013 755100                    STA     I,,AUTO
         2 000067   200005 470500                    LDP0    @TWSNR$,,AUTO
         2 000070   000000 471500                    LDP1    0,,PR0
         2 000071   200013 236100                    LDQ     I,,AUTO
         2 000072   100004 116100                    CMPQ    4,,PR1
         2 000073   000047 602000 2                  TNC     s:13215

      223    13220    2      END ;

      224    13221
      225    13222        /*E* ERROR:   ASB-E$CANT_FIND_IN_TWSN_REC-C
      226    13223             MESSAGE: Unable to find %U1 in TWSN%U2 record.
      227    13224        */
      228    13225    1   CALL INDEX( I, AS_BLANK, DEVICE1 ) ;

  13225  2 000074   200007 473500                    LDP3    @DEVICE1,,AUTO
         2 000075   000000 124500                    SCM     mask='000'O
         2 000076   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         2 000077   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:44   
         2 000100   200013 000100                    ARG     I,,AUTO

      229    13226    1   AS_FIELD1.COUNT = I ;

  13226  2 000101   200013 236100                    LDQ     I,,AUTO
         2 000102   000033 736000                    QLS     27
         2 000103   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      230    13227    1   AS_FIELD1.TEXT  = DEVICE1 ;

  13227  2 000104   040000 100500                    MLR     fill='040'O
         2 000105   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         2 000106   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      231    13228    1   AS_FIELD2.COUNT = 4 ;

  13228  2 000107   004000 236003                    LDQ     2048,DU
         2 000110   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      232    13229    1   AS_FIELD2.TEXT  = KL$TREC.TWSN# ;

  13229  2 000111   200003 471500                    LDP1    @TREC$,,AUTO
         2 000112   100000 474500                    LDP4    0,,PR1
         2 000113   040000 100500                    MLR     fill='040'O
         2 000114   400001 000004                    ADSC9   1,,PR4                   cn=0,n=4
         2 000115   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      233    13230        %SCREAM( ERR#=E$CANT_FIND_IN_TWSN_REC, LEVEL=ERROR, MID='B' ) ;

  13242  2 000116   000000 630400 3                  EPPR0   0
         2 000117   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000120   000000 701000 xent               TSX1    ASH$ERROR
         2 000121   000000 011000                    NOP     0

      234    13245    1   ALTRETURN ;

  13245  2 000122   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:45   
      235    13246
      236    13247
      237    13248    1   END ASB$FIND_TWSN_INDEX ;
      238    13249        %EOD ;

PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:46   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$FIND_TWSN_INDEX.
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:47   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @DEVICE1                   4-0-0/w PTR         r     1 @DREC$
     6-0-0/w PTR         r     1 @TERM_FLG                  3-0-0/w PTR         r     1 @TREC$
     5-0-0/w PTR         r     1 @TWSNR$                   10-0-0/w PTR         r     1 @TWSN_INDEX
    *0-0-0/c CHAR(8)     r     1 DEVICE1                   11-0-0/c CHAR(8)     r     1 DEVICE2
    *0-0-0/w PTR         r     1 DREC$                     13-0-0/w UBIN        r     1 I
    14-0-0/w UBIN        r     1 SS#                       *0-0-0/w BIT         r     1 TERM_FLG
    *0-0-0/w PTR         r     1 TREC$                     *0-0-0/w PTR         r     1 TWSNR$
    *0-0-0/w UBIN        r     1 TWSN_INDEX

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w STRC(369)   r     1 AS_FIELD2

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1584)  r     1 KL$TREC                    0-0-0/w STRC(576)   r     1 KL$TWSNREC


   Procedure ASB$FIND_TWSN_INDEX requires 83 words for executable code.
   Procedure ASB$FIND_TWSN_INDEX requires 14 words of local(AUTO) storage.
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:48   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:49   
          MINI XREF LISTING

ASA_BRKS_LOC
      9999**DCL      9999--REDEF
ASH$ERROR
     13185**DCL-ENT 13242--CALL
AS_BLANK
      9859**DCL     13225>>CALLBLT
AS_DEFAULT.BANNER_PERM
     10692**DCL     10693--REDEF
AS_DEFAULT.BUDGET.MACCT
     10597**DCL     10601--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10610**DCL     10613--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10593**DCL     10595--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10588**DCL     10590--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10708**DCL     10709--REDEF   10710--REDEF
AS_DEFAULT_DREC.PASSWORD
     11962**DCL     11966--REDEF
AS_DEFAULT_DREC.RENAME
     11985**DCL     11986--REDEF
AS_DFLT.BANNER_PERM
     10514**DCL     10515--REDEF
AS_DFLT.BUDGET.MACCT
     10419**DCL     10423--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10432**DCL     10435--REDEF
AS_DFLT.BUDGET.PACCUM
     10415**DCL     10417--REDEF
AS_DFLT.BUDGET.PMAXC
     10410**DCL     10412--REDEF
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:50   
AS_DFLT.SETUP_CHRA.TXT
     10530**DCL     10531--REDEF   10532--REDEF
AS_FE_MODE
      9865**DCL      9866--REDEF
AS_FIELD1.COUNT
      9996**DCL     13226<<ASSIGN
AS_FIELD1.TEXT
      9996**DCL     13227<<ASSIGN
AS_FIELD2.COUNT
      9996**DCL     13228<<ASSIGN
AS_FIELD2.TEXT
      9996**DCL     13229<<ASSIGN
AS_MODE
      9862**DCL      9864--REDEF
AS_MOD_USER.ACCESS
     12727**DCL     12728--REDEF
AS_MOD_USER.BANNER
     12714**DCL     12715--REDEF
AS_MOD_USER.BANNER_PERM
     12716**DCL     12717--REDEF
AS_MOD_USER.BILL
     12722**DCL     12723--REDEF
AS_MOD_USER.CPROC
     12718**DCL     12719--REDEF
AS_MOD_USER.FEBILL
     12798**DCL     12799--REDEF
AS_MOD_USER.FECXTMEM
     12815**DCL     12816--REDEF
AS_MOD_USER.FEMINTS
     12800**DCL     12801--REDEF
AS_MOD_USER.FEMMEM
     12811**DCL     12812--REDEF
AS_MOD_USER.FEMTIME
     12809**DCL     12810--REDEF
AS_MOD_USER.FEPPRIV
     12806**DCL     12808--REDEF
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:51   
AS_MOD_USER.FEPRIV
     12803**DCL     12805--REDEF
AS_MOD_USER.FORCE_BIT
     12712**DCL     12713--REDEF
AS_MOD_USER.KEY
     12794**DCL     12796--REDEF
AS_MOD_USER.LASTCPROC
     12720**DCL     12721--REDEF
AS_MOD_USER.LIMITS.DO_
     12768**DCL     12769--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12784**DCL     12785--REDEF
AS_MOD_USER.LIMITS.LO
     12764**DCL     12765--REDEF
AS_MOD_USER.LIMITS.MEM
     12760**DCL     12761--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12788**DCL     12789--REDEF
AS_MOD_USER.LIMITS.PDIS
     12776**DCL     12777--REDEF
AS_MOD_USER.LIMITS.PO
     12772**DCL     12773--REDEF
AS_MOD_USER.LIMITS.TDIS
     12780**DCL     12781--REDEF
AS_MOD_USER.LIMITS.TIME
     12756**DCL     12757--REDEF
AS_MOD_USER.MAXENQ
     12737**DCL     12738--REDEF
AS_MOD_USER.PERM_BIT
     12710**DCL     12711--REDEF
AS_MOD_USER.PPRIV
     12732**DCL     12734--REDEF
AS_MOD_USER.PRIOB
     12739**DCL     12740--REDEF
AS_MOD_USER.PRIV
     12729**DCL     12731--REDEF
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:52   
AS_MOD_USER.QUAN
     12735**DCL     12736--REDEF
AS_MOD_USER.SETUP
     12708**DCL     12709--REDEF
AS_PROJECT.BANNER_PERM
     11048**DCL     11049--REDEF
AS_PROJECT.BUDGET.MACCT
     10953**DCL     10957--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10966**DCL     10969--REDEF
AS_PROJECT.BUDGET.PACCUM
     10949**DCL     10951--REDEF
AS_PROJECT.BUDGET.PMAXC
     10944**DCL     10946--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11064**DCL     11065--REDEF   11066--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11226**DCL     11227--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11131**DCL     11135--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11144**DCL     11147--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11127**DCL     11129--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11122**DCL     11124--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11242**DCL     11243--REDEF   11244--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12448**DCL     12452--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12471**DCL     12472--REDEF
AS_PROJECT_DREC.PASSWORD
     12286**DCL     12290--REDEF
AS_PROJECT_DREC.RENAME
     12309**DCL     12310--REDEF
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:53   
AS_PROJ_ADMIN.BANNER_PERM
     10870**DCL     10871--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10775**DCL     10779--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10788**DCL     10791--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10771**DCL     10773--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10766**DCL     10768--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10886**DCL     10887--REDEF   10888--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12124**DCL     12128--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12147**DCL     12148--REDEF
AS_USERS.BANNER_PERM
     10336**DCL     10337--REDEF
AS_USERS.BUDGET.MACCT
     10241**DCL     10245--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10254**DCL     10257--REDEF
AS_USERS.BUDGET.PACCUM
     10237**DCL     10239--REDEF
AS_USERS.BUDGET.PMAXC
     10232**DCL     10234--REDEF
AS_USERS.SETUP_CHRA.TXT
     10352**DCL     10353--REDEF   10354--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11404**DCL     11405--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11309**DCL     11313--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11322**DCL     11325--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11305**DCL     11307--REDEF
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:54   
AS_USERS_CONSTANT.BUDGET.PMAXC
     11300**DCL     11302--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11420**DCL     11421--REDEF   11422--REDEF
DEVICE1
     12860**DCL        30--PROC    13198>>IF      13215>>IF      13225>>CALLBLT 13227>>ASSIGN
DEVICE2
     13175**DCL     13196<<CALLBLT 13198>>IF
DREC$
     12857**DCL        30--PROC    13018--IMP-PTR
ERR_CODE
      9994**DCL      9995--REDEF
I
     13176**DCL     13195<<DOINDEX 13196>>CALLBLT 13196>>CALLBLT 13199>>ASSIGN  13206<<DOINDEX 13215>>IF
     13216>>ASSIGN  13225<<CALLBLT 13226>>ASSIGN
KL$DREC.PASSWORD
     13076**DCL     13080--REDEF
KL$DREC.RENAME
     13099**DCL     13100--REDEF
KL$TREC.PASSWORD
     12938**DCL     12942--REDEF
KL$TREC.RENAME
     12961**DCL     12962--REDEF
KL$TREC.TWSN#
     12935**DCL     13229>>ASSIGN
KL$TWSNREC.DEVS.ACCT
     13164**DCL     13215>>IF
KL$TWSNREC.DEVS.NUM
     13152**DCL     13196>>CALLBLT
KL$TWSNREC.DEVS.TYP
     13151**DCL     13196>>CALLBLT
KL$TWSNREC.NDEV
     13149**DCL     13195>>DOINDEX 13206>>DOINDEX
KL_DEFAULT.PASSWORD
     12610**DCL     12614--REDEF
KL_DEFAULT.RENAME
PL6.E3A0      #002=ASB$FIND_TWSN_INDEX File=ASB$SEARCH.:E05TSI                   TUE 07/29/97 09:28 Page:55   
     12633**DCL     12634--REDEF
KL_DFLT.PASSWORD
     11800**DCL     11804--REDEF
KL_DFLT.RENAME
     11823**DCL     11824--REDEF
KL_DREC.PASSWORD
     11638**DCL     11642--REDEF
KL_DREC.RENAME
     11661**DCL     11662--REDEF
KL_DREC_CNT.PASSWORD
     11525**DCL     11529--REDEF
KL_DREC_CNT.RENAME
     11548**DCL     11549--REDEF
PROJ_KEY.TEXT
      9872**DCL      9872--REDEF
PROJ_KEY.TXT.PROJECT
      9872**DCL      9872--REDEF
REMEM_VAR
      9998**DCL      9998--REDEF
REM_FCMD
      9998**DCL      9999--REDEF
SS#
     13177**DCL     13205<<ASSIGN
TERM_FLG
     12859**DCL        30--PROC    13193>>IF
TREC$
     12856**DCL        30--PROC    12880--IMP-PTR 13229>>ASSIGN
TWSNR$
     12858**DCL        30--PROC    13146--IMP-PTR 13195>>DOINDEX 13196>>CALLBLT 13196>>CALLBLT 13206>>DOINDEX
     13215>>IF
TWSN_INDEX
     12861**DCL        30--PROC    13199<<ASSIGN  13216<<ASSIGN
USERS_KEY.TEXT
      9869**DCL      9870--REDEF    9870--REDEF    9870--REDEF    9871--REDEF

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:56   
      239        1        /*T***********************************************************/
      240        2        /*T*                                                         */
      241        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      242        4        /*T*                                                         */
      243        5        /*T***********************************************************/
      244        6        ASB$GET: PROC( PROJ_FLAG,P_CODE,USERS_REC1, DREC1$, USERS_REC2, DREC2$) ALTRET;
      245        7
      246        8        /********************************************************************/
      247        9        /*    Include files   include files   include files   include files */
      248       10        /********************************************************************/
      249       11
      250       12        %INCLUDE           B_ERRORS_C     ;
      251     1139        %INCLUDE           AS_ENTRIES_M   ;
      252     2189        %INCLUDE           AS_SUPER_C     ;
      253     2624        %INCLUDE           AS_PERR_C      ;
      254     3226        %INCLUDE           AS_SUBS_C      ;
      255     4640        %INCLUDE           AS_MAC_C       ;
      256     4720        %INCLUDE           KL_SUPER_C     ;
      257     7622        %INCLUDE           XU_MACRO_C     ;
      258    10728        %INCLUDE           XU_FORMAT_C    ;
      259    10890        %INCLUDE           AS_SUPER_R     ;
      260    13906
      261    13907        /********************************************************************/
      262    13908        /*    Parameters      parameters      parameters      parameters    */
      263    13909        /********************************************************************/
      264    13910
      265    13911    1   DCL PROJ_FLAG BIT(1) ALIGNED;
      266    13912    1   DCL P_CODE UBIN WORD ;
      267    13913        %AS_USERS( STR_NAME=USERS_REC1, STCLASS=" " );
      268    14091    1   DCL DREC1$ PTR ;
      269    14092        %AS_USERS( STR_NAME=USERS_REC2, STCLASS=" " );
      270    14270    1   DCL DREC2$ PTR ;
      271    14271
      272    14272        /*******************************************************************/
      273    14273        /*    Static data     static data     static data     static data  */
      274    14274        /*******************************************************************/
      275    14275
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:57   
      276    14276    1   DCL PROJECT_FLG BIT(1)  STATIC ;
      277    14277    1   DCL PROJ_ADMIN_FLG BIT(1) STATIC ;
      278    14278    1   DCL FIRST_TIME BIT(1) STATIC ;
      279    14279    1   DCL TYPE UBIN WORD STATIC ;
      280    14280    1   DCL SIZEC_DREC UBIN CONSTANT INIT( SIZEC(KL_DREC_CNT) ) ;
      281    14281    1   DCL 1 LAST_KEY STATIC ,
      282    14282    1          2 COUNT UBIN BYTE UNAL,
      283    14283    1          2 TXTC CHAR(41) ,
      284    14284    1          2 SKEY REDEF TXTC,
      285    14285    1             3 PROJ UBIN BYTE UNAL,
      286    14286    1             3 CREATOR CHAR(20) UNAL,
      287    14287    1             3 USER CHAR(20) UNAL;
      288    14288
      289    14289
      290    14290        /********************************************************************/
      291    14291        /*    Auto data       auto data       auto data       auto data     */
      292    14292        /********************************************************************/
      293    14293
      294    14294    1   DCL I SBIN ;
      295    14295    1   DCL J SBIN ;
      296    14296    1   DCL ARS_TEMP SBIN ;
      297    14297    1   DCL ACCT CHAR(8) ;
      298    14298    1   DCL NAME CHAR(12) ;
      299    14299    1   DCL LEN UBIN ;
      300    14300    1   DCL 1 TEMP_KEY,
      301    14301    1          2 COUNT UBIN BYTE UNAL,
      302    14302    1          2 TEXT CHAR(20);
      303    14303    1   DCL ACCT_LEN      UBIN;
      304    14304    1   DCL MATCH_LEN     UBIN;
      305    14305    1   DCL NAME_LEN      UBIN;
      306    14306        %AS_USERS( STR_NAME=TEMP_USERS, STCLASS=AUTO );
      307    14484
      308    14485        /*******************************************************************/
      309    14486        /*    Entry       entry       entry       entry       entry        */
      310    14487        /******************************************************************/
      311    14488
      312    14489        %ASB$READ_USERS ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:58   
      313    14492        %ASB$READ_HLP ;
      314    14495        %ASB$READ_USERS_SEQ ;
      315    14498        %ASB$WILD_MATCH ;
      316    14501        %ASB$PREC_USERS ;
      317    14504        %ASB$PREC_AND_SKIP_USERS ;
      318    14507        %ASB$ENQ ;
      319    14510        %ASB$DEQ ;
      320    14513        %ASA$ERROR ;
      321    14516
      322    14517
      323    14518        /********************************************************************/
      324    14519        /*    Procedure       procedure       procedure       procedure     */
      325    14520        /*******************************************************************/
      326    14521
      327    14522
      328    14523                                                  /*
      329    14524                                                      Read the records from :USERS
      330    14525                                                      and :HLP.
      331    14526                                                  */
      332    14527    1   CALL ASB$ENQ ALTRET(ENQ_ERR);
      333    14528    1   ENQDEQ_FLG = AS_TRUE ;
      334    14529    1   CALL ASB$READ_USERS( USERS_REC1 ) ALTRET( USERS_DOESNT_EXIST ) ;
      335    14530    1   ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;
      336    14531    1   IF ADDR(DREC1$) ~= ADDR(NIL) THEN
      337    14532    1      CALL ASB$READ_HLP( DREC1$,ARS_TEMP ) ALTRET( HLP_DOESNT_EXIST ) ;
      338    14533                                                  /*
      339    14534                                                      Make sure user can execute
      340    14535                                                      the command with this record
      341    14536                                                  */
      342    14537    1   IF ADDR(P_CODE) ~= ADDR(NIL) THEN
      343    14538    2      IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;
      344    14539    3         DO SELECT( P_CODE ) ;
      345    14540    3            SELECT( %LIST_PROJECT_VAL );
      346    14541    3            IF SUBSTR(USERS_KEY.TXTC,0,USERS_KEY.COUNT)
      347    14542    3                 ~= AS_PROJECT_ADMIN.TEXT
      348    14543    3            THEN GOTO CHECK_IN_PROJ;
      349    14544    3            SELECT( MODIFY_VAL, R_USER_VAL, R_PROJ_VAL, %LIST_USER_VAL,
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:59   
      350    14545    3                 MOD_USER_TO_PROJ_VAL, MOD_PROJ_TO_USER_VAL );
      351    14546    3   CHECK_IN_PROJ: IF USERS_REC1.BUDGET.MACCT_.TEXT ~= AS_PROJECT_ADMIN.TEXT
      352    14547    4            THEN DO;
      353    14548    4               CALL ASB$DEQ ;
      354    14549    4               ALTRETURN;
      355    14550    4               END;
      356    14551    3            SELECT( UNTIE_USER_VAL,UNTIE_PROJ_VAL,TIE_USER_VAL,TIE_PROJ_VAL );
      357    14552    3            TEMP_KEY = USERS_KEY;
      358    14553    3            TEMP_USERS = USERS_REC1;
      359    14554    4            DO WHILE( TEMP_USERS.BUDGET.MACCT ~= AS_PROJECT_ADMIN
      360    14555    4                 AND  TEMP_USERS.BUDGET.MACCT ~= AS_NONE );
      361    14556    4               USERS_KEY = TEMP_USERS.BUDGET.MACCT;
      362    14557    4               CALL ASB$READ_USERS( TEMP_USERS ) ALTRET(USERS_DOESNT_EXIST);
      363    14558    4               END;
      364    14559    3            USERS_KEY = TEMP_KEY;
      365    14560    4            IF TEMP_USERS.BUDGET.MACCT = AS_NONE THEN DO;
      366    14561    4               CALL ASA$ERROR( USERS_KEY, E$NOT_BELOW, PROJ_FLAG );
      367    14562    4               CALL ASB$DEQ ;
      368    14563    4               ALTRETURN;
      369    14564    4               END;
      370    14565    3            END;      /* End do case */
      371    14566    2         END;        /* End then do */
      372    14567                                                  /*
      373    14568                                                      Read the default record for the
      374    14569                                                      project.           */
      375    14570    2   IF PROJ_FLAG THEN DO;
      376    14571    2      USERS_KEY.COUNT = 21 ;
      377    14572    2      USERS_KEY.UKEY.S = 'S' ;
      378    14573    2      CALL ASB$ENQ ALTRET(ENQ_ERR) ;
      379    14574    2      CALL ASB$READ_USERS( USERS_REC2 ) ALTRET( USERS_DOESNT_EXIST ) ;
      380    14575    2      IF USERS_REC2.BUDGET.PMAXC < 0 THEN USERS_REC2.BUDGET.PMAXC = 0;
      381    14576    3      IF ADDR(DREC2$) ~= ADDR(NIL) THEN DO;
      382    14577    3         ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;
      383    14578    3         CALL ASB$READ_HLP( DREC2$, ARS_TEMP ) ALTRET( HLP_DOESNT_EXIST ) ;
      384    14579    3         END;
      385    14580    2      CALL ASB$DEQ ;
      386    14581    2      END ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:60   
      387    14582
      388    14583    1   CALL ASB$DEQ ;
      389    14584    1   RETURN ;
      390    14585
      391    14586                                                          /* Errors */
      392    14587    1   USERS_DOESNT_EXIST:
      393    14588    1   CALL ASB$DEQ ;
      394    14589    1   CALL ASB$DEQ ;
      395    14590    1   CALL ASA$ERROR( USERS_KEY, E$DOESNT_EXIST, PROJ_FLAG ) ;
      396    14591    1   ALTRETURN ;
      397    14592
      398    14593    1   HLP_DOESNT_EXIST:
      399    14594    1   CALL ASB$DEQ ;
      400    14595    1   CALL ASB$DEQ ;
      401    14596    1   CALL ASA$ERROR( USERS_KEY, E$DOESNT_EXIST, PROJ_FLAG ) ;
      402    14597    1   ENQ_ERR:
      403    14598    1   ALTRETURN;
      404    14599
      405    14600        %EJECT ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:61   
      406    14601    1   ASB$INIT_GET_NEXT: ENTRY( PROJ_FLAG, P_CODE ) ALTRET ;
      407    14602
      408    14603    1   PROJECT_FLG = PROJ_FLAG ;
      409    14604    1   PROJ_ADMIN_FLG = ( AS_PROJECT_ADMIN ~= AS_NONE ) ;
      410    14605    1   TYPE = P_CODE ;
      411    14606    1   FIRST_TIME = AS_TRUE ;
      412    14607
      413    14608    1   IF NOT PROJ_ADMIN_FLG
      414    14609    2   THEN DO ;                       /* System administrator */
      415    14610    2      IF PROJ_FLAG
      416    14611    3      THEN DO ;                   /* Project */
      417    14612    3         LAST_KEY.COUNT = 1 ;
      418    14613    3         LAST_KEY.SKEY.PROJ = 1 ;
      419    14614    3         END ;
      420    14615    3      ELSE DO;                    /* Not project */
      421    14616    3         CALL INDEX (I, '?', AS_ACCT_MATCH);
      422    14617    3         IF I = 0
      423    14618    4         THEN DO ;
      424    14619    4            LAST_KEY.COUNT = 1 ;
      425    14620    4            LAST_KEY.TXTC = AS_BLANK ;
      426    14621    4            END;
      427    14622    4         ELSE DO ;
      428    14623    4            LAST_KEY.TXTC = SUBSTR( AS_ACCT_MATCH, 0, I);
      429    14624    4            LAST_KEY.COUNT = I ;
      430    14625    4            END ;
      431    14626    3         CALL INDEX (J, '?', AS_NAME_MATCH)
      432    14627    4         WHENRETURN DO;
      433    14628    4            CALL INSERT( LAST_KEY.TXTC, 8, ,SUBSTR(AS_NAME_MATCH,0,J));
      434    14629    4            LAST_KEY.COUNT = 8 + J ;
      435    14630    4            END ;
      436    14631    4         WHENALTRETURN DO;
      437    14632    4            CALL INDEX (J, ' ', AS_NAME_MATCH);
      438    14633    4            CALL INSERT( LAST_KEY.TXTC, 8, ,SUBSTR(AS_NAME_MATCH,0,J));
      439    14634    4            LAST_KEY.COUNT = 8 + J ;
      440    14635    4            END ;
      441    14636    3         END;
      442    14637    2      END ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:62   
      443    14638    2   ELSE DO ;                           /* Project administrator */
      444    14639    2      LAST_KEY.SKEY.PROJ = BITBIN( PROJECT_FLG ) ;
      445    14640    2      LAST_KEY.SKEY.CREATOR = AS_PROJECT_ADMIN.TEXT ;
      446    14641    2      CALL INDEX (I, '?', AS_ACCT_MATCH);
      447    14642    2      CALL INDEX (J, '?', AS_NAME_MATCH);
      448    14643    2      IF I = 0
      449    14644    3      THEN DO;
      450    14645    3         LAST_KEY.SKEY.USER = AS_BLANK ;
      451    14646    3         LAST_KEY.COUNT = 22 ;
      452    14647    3         END ;
      453    14648    3      ELSE DO ;
      454    14649    3         LAST_KEY.SKEY.USER = SUBSTR(AS_ACCT_MATCH, 0, I ) ;
      455    14650    3         LAST_KEY.COUNT = 21 + I ;
      456    14651    3         IF (I = 0) AND (J > 0)
      457    14652    4         THEN DO ;
      458    14653    4            CALL INSERT( LAST_KEY.SKEY.USER, 8, ,
      459    14654    4                 SUBSTR(AS_NAME_MATCH,0,J) ) ;
      460    14655    4            LAST_KEY.COUNT = 29 + J ;
      461    14656    4            END ;
      462    14657    3         END ;
      463    14658    2      END ;
      464    14659
      465    14660
      466    14661    1   RETURN ;
      467    14662
      468    14663        %EJECT ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:63   
      469    14664    1   ASB$GET_NEXT: ENTRY ALTRET ;
      470    14665
      471    14666    1   USERS_KEY = LAST_KEY ;
      472    14667    2   IF FIRST_TIME THEN DO ;         /* Position to first key */
      473    14668    2      FIRST_TIME = AS_FALSE ;
      474    14669    2      CALL ASB$PREC_USERS ;
      475    14670    2      END ;
      476    14671    2   ELSE DO ;
      477    14672    3      DO SELECT( TYPE ) ;
      478    14673    3         SELECT( R_USER_VAL, R_PROJ_VAL ) ;
      479    14674    3         CALL ASB$PREC_USERS    /* Position to last key */
      480    14675    4         WHENRETURN DO;
      481    14676    5            IF USERS_KEY = LAST_KEY THEN DO;
      482    14677    5               CALL ASB$PREC_AND_SKIP_USERS;
      483    14678    5               END;
      484    14679    4            END;
      485    14680    3         SELECT( ELSE );
      486    14681                                         /* Postion to last key and skip 1 record */
      487    14682    3      CALL ASB$PREC_AND_SKIP_USERS ;
      488    14683    3         END ;
      489    14684    2      END ;
      490    14685
      491    14686    2   DO WHILE( '1'B ) ;
      492    14687
      493    14688    2   READ_NEXT:
      494    14689    2      CALL ASB$READ_USERS_SEQ( AS_USERS ) ALTRET( NONE ) ;
      495    14690    2      IF NOT PROJ_ADMIN_FLG  AND  NOT PROJECT_FLG
      496    14691    3      THEN DO ;
      497    14692    3         IF USERS_KEY.COUNT > 20 THEN GOTO READ_NEXT ;
      498    14693    3         ACCT = SUBSTR( USERS_KEY.TXTC, 0, 8 ) ;
      499    14694    3         NAME = SUBSTR( USERS_KEY.TXTC, 8, USERS_KEY.COUNT-8 ) ;
      500    14695    3         CALL INDEX (ACCT_LEN, ' ', ACCT);
      501    14696    3         IF ACCT_LEN = 0 THEN ACCT_LEN = 1;
      502    14697    3         CALL INDEX (MATCH_LEN, ' ', AS_ACCT_MATCH);
      503    14698    3         IF MATCH_LEN = 0 THEN MATCH_LEN = 1;
      504    14699    3         CALL ASB$WILD_MATCH(ACCT_LEN, ACCT, MATCH_LEN, AS_ACCT_MATCH) ALTRET(FAILED);
      505    14700    3         CALL INDEX (NAME_LEN, ' ', NAME);
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:64   
      506    14701    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;
      507    14702    3         CALL INDEX (MATCH_LEN, ' ', AS_NAME_MATCH);
      508    14703    3         IF MATCH_LEN = 0 THEN MATCH_LEN = 1;
      509    14704    3         CALL ASB$WILD_MATCH(NAME_LEN, NAME, MATCH_LEN, AS_NAME_MATCH ) ALTRET(FAILED);
      510    14705    3         ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;
      511    14706    3         CALL ASB$READ_HLP( KL_DREC$,ARS_TEMP ) ALTRET( CANT_READ_HLP );
      512    14707    3         LAST_KEY = USERS_KEY;
      513    14708    3         RETURN ;
      514    14709    3         END ;
      515    14710    3      ELSE DO ;
      516    14711    3         IF USERS_KEY.COUNT < 22 THEN ALTRETURN ;
      517    14712    3         IF USERS_KEY.SKEY.PROJ ~= BITBIN(PROJECT_FLG) THEN ALTRETURN ;
      518    14713    3         IF USERS_KEY.SKEY.CREATOR ~= AS_PROJECT_ADMIN.TEXT
      519    14714    3              AND  PROJ_ADMIN_FLG
      520    14715    3         THEN ALTRETURN ;
      521    14716    3         LAST_KEY = USERS_KEY ;
      522    14717    3         ACCT = SUBSTR( USERS_KEY.SKEY.USER, 0, 8 ) ;
      523    14718    3         NAME = SUBSTR( USERS_KEY.SKEY.USER, 8, 12 ) ;
      524    14719    3         CALL INDEX (ACCT_LEN, ' ', ACCT);
      525    14720    3         IF ACCT_LEN = 0 THEN ACCT_LEN = 1;
      526    14721    3         CALL INDEX (MATCH_LEN, ' ', AS_ACCT_MATCH);
      527    14722    3         IF MATCH_LEN = 0 THEN MATCH_LEN = 1;
      528    14723    3         CALL ASB$WILD_MATCH(ACCT_LEN, ACCT, MATCH_LEN, AS_ACCT_MATCH ) ALTRET(FAILED);
      529    14724    3         CALL INDEX (NAME_LEN, ' ', NAME);
      530    14725    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;
      531    14726    3         CALL INDEX (MATCH_LEN, ' ', AS_NAME_MATCH);
      532    14727    3         IF MATCH_LEN = 0 THEN MATCH_LEN = 1;
      533    14728    3         CALL ASB$WILD_MATCH(NAME_LEN, NAME, MATCH_LEN, AS_NAME_MATCH ) ALTRET(FAILED);
      534    14729    3         CALL INDEX( I, AS_BLANK, SUBSTR(USERS_KEY.SKEY.USER,8) ) ;
      535    14730    3         USERS_KEY.COUNT = 8 + I ;
      536    14731    3         USERS_KEY.TXTC = LAST_KEY.SKEY.USER ;
      537    14732    3         IF PROJECT_FLG
      538    14733    4         THEN DO;
      539    14734    4            CALL ASB$READ_USERS(AS_PROJECT) WHENALTRETURN
      540    14735    5            DO;
      541    14736    5               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_USERS, PROJECT_FLG ) ;
      542    14737    5               END; /*  Whenaltreturn  */
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:65   
      543    14738    4            ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;
      544    14739    4            CALL ASB$READ_HLP(AS_PROJECT_DREC$,ARS_TEMP) WHENALTRETURN
      545    14740    5            DO;
      546    14741    5               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP, PROJECT_FLG ) ;
      547    14742    5               END; /*  Whenaltreturn  */
      548    14743    4            USERS_KEY.COUNT = 21;
      549    14744    4            USERS_KEY.UKEY.S = 'S';
      550    14745    4            CALL ASB$READ_USERS(AS_PROJECT_DFLT) WHENALTRETURN
      551    14746    5            DO;
      552    14747    5               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_USERS, PROJECT_FLG ) ;
      553    14748    5               END; /*  Whenaltreturn  */
      554    14749    4            IF AS_PROJECT_DFLT.BUDGET.PMAXC < 0 THEN AS_PROJECT_DFLT.BUDGET.PMAXC = 0;
      555    14750    4            ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;
      556    14751    4            CALL ASB$READ_HLP(AS_PROJECT_DFLT_DREC$,ARS_TEMP) WHENALTRETURN
      557    14752    5            DO;
      558    14753    5               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP, PROJECT_FLG ) ;
      559    14754    5               END; /*  Whenaltreturn  */
      560    14755    4            IF TYPE = R_PROJ_VAL THEN USERS_KEY = LAST_KEY;
      561    14756    4            END;
      562    14757    4         ELSE DO;
      563    14758    4            CALL ASB$READ_USERS( AS_USERS ) ALTRET(CANT_READ_USERS);
      564    14759    4            ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;
      565    14760    4            CALL ASB$READ_HLP  ( KL_DREC$ ,ARS_TEMP) ALTRET(CANT_READ_HLP);
      566    14761    4            END ;
      567    14762    3         RETURN ;
      568    14763    3         END ;
      569    14764    2   FAILED:
      570    14765    2      IF PROJECT_FLG AND NOT PROJ_ADMIN_FLG THEN GOTO READ_NEXT;
      571    14766    2      CALL INDEX (LEN, '?', AS_ACCT_MATCH);
      572    14767    3      IF LEN ~= 0 THEN DO;
      573    14768    3         IF SUBSTR (ACCT, 0, LEN) ~= SUBSTR (AS_ACCT_MATCH, 0, LEN) THEN
      574    14769    3            ALTRETURN;
      575    14770    4         ELSE DO;
      576    14771    4            CALL INDEX (NAME_LEN, '?', AS_NAME_MATCH);
      577    14772    4            IF LEN = LENGTHC(AS_ACCT_MATCH) AND NAME_LEN ~= 0
      578    14773    5            THEN DO;
      579    14774    5               IF SUBSTR(NAME, 0, NAME_LEN) > SUBSTR(AS_NAME_MATCH, 0, NAME_LEN)
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:66   
      580    14775    5               THEN
      581    14776    5                  ALTRETURN;
      582    14777    5               END;
      583    14778    4            END;
      584    14779    3         END;
      585    14780    2      END ;    /* Do forever */
      586    14781
      587    14782    1   CANT_READ_USERS:
      588    14783    1   CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_USERS, PROJECT_FLG ) ;
      589    14784    1   ALTRETURN;
      590    14785
      591    14786    1   CANT_READ_HLP:
      592    14787    1   CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP, PROJECT_FLG ) ;
      593    14788
      594    14789
      595    14790    1   NONE:
      596    14791    1   ALTRETURN ;
      597    14792
      598    14793    1   END ASB$GET ;
      599    14794        %EOD ;

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:67   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$GET.

   Procedure ASB$GET requires 666 words for executable code.
   Procedure ASB$GET requires 548 words of local(AUTO) storage.

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:68   

 Object Unit name= ASB$GET                                    File name= ASB$SEARCH.:E05TOU
 UTS= JUL 29 '97 09:29:34.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   Data  even  none    15     17  ASB$GET
    2  RoData even  UTS      1      1  ASB$GET
    3   Proc  even  none   666   1232  ASB$GET
    4  RoData even  none    22     26  ASB$GET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        6  ASB$GET
     3    306          yes     yes      Std        2  ASB$INIT_GET_NEXT
     3    475          yes     yes      Std        0  ASB$GET_NEXT
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:69   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       0 ASB$ENQ
 yes     yes           Std       1 ASB$READ_USERS
 yes     yes           Std       0 ASB$PREC_USERS
 yes     yes           Std       0 ASB$DEQ
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       3 ASA$ERROR
 yes     yes           Std       0 ASB$PREC_AND_SKIP_USERS
 yes     yes           Std       1 ASB$READ_USERS_SEQ
 yes     yes           Std       4 ASB$WILD_MATCH
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_TRUE                          r    AS_FALSE
r    AS_NONE                          r    AS_MODE                          r    AS_FE_MODE
r    KL_DREC$                         r    AS_PROJECT_DREC$                 r    AS_PROJECT_DFLT_DREC$
     M$LO                                  USERS_KEY                             ERR_CODE
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     ENQDEQ_FLG                            AS_PROJECT_ADMIN                      AS_ACCT_MATCH
     AS_NAME_MATCH                         AS_USERS                              AS_PROJECT
     AS_PROJECT_DFLT                       KL_DREC_CNT                           KL_DREC
     B_VECTNIL
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:70   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:71   


      239        1        /*T***********************************************************/
      240        2        /*T*                                                         */
      241        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      242        4        /*T*                                                         */
      243        5        /*T***********************************************************/
      244        6        ASB$GET: PROC( PROJ_FLAG,P_CODE,USERS_REC1, DREC1$, USERS_REC2, DREC2$) ALTRET;

      6  3 000000   000000 700200 xent  ASB$GET      TSX0  ! X66_AUTO_N
         3 000001   001044 000006                    ZERO    548,6

      245        7
      246        8        /********************************************************************/
      247        9        /*    Include files   include files   include files   include files */
      248       10        /********************************************************************/
      249       11
      250       12        %INCLUDE           B_ERRORS_C     ;
      251     1139        %INCLUDE           AS_ENTRIES_M   ;
      252     2189        %INCLUDE           AS_SUPER_C     ;
      253     2624        %INCLUDE           AS_PERR_C      ;
      254     3226        %INCLUDE           AS_SUBS_C      ;
      255     4640        %INCLUDE           AS_MAC_C       ;
      256     4720        %INCLUDE           KL_SUPER_C     ;
      257     7622        %INCLUDE           XU_MACRO_C     ;
      258    10728        %INCLUDE           XU_FORMAT_C    ;
      259    10890        %INCLUDE           AS_SUPER_R     ;
      260    13906
      261    13907        /********************************************************************/
      262    13908        /*    Parameters      parameters      parameters      parameters    */
      263    13909        /********************************************************************/
      264    13910
      265    13911    1   DCL PROJ_FLAG BIT(1) ALIGNED;
      266    13912    1   DCL P_CODE UBIN WORD ;
      267    13913        %AS_USERS( STR_NAME=USERS_REC1, STCLASS=" " );
      268    14091    1   DCL DREC1$ PTR ;
      269    14092        %AS_USERS( STR_NAME=USERS_REC2, STCLASS=" " );
      270    14270    1   DCL DREC2$ PTR ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:72   
      271    14271
      272    14272        /*******************************************************************/
      273    14273        /*    Static data     static data     static data     static data  */
      274    14274        /*******************************************************************/
      275    14275
      276    14276    1   DCL PROJECT_FLG BIT(1)  STATIC ;
      277    14277    1   DCL PROJ_ADMIN_FLG BIT(1) STATIC ;
      278    14278    1   DCL FIRST_TIME BIT(1) STATIC ;
      279    14279    1   DCL TYPE UBIN WORD STATIC ;
      280    14280    1   DCL SIZEC_DREC UBIN CONSTANT INIT( SIZEC(KL_DREC_CNT) ) ;
      281    14281    1   DCL 1 LAST_KEY STATIC ,
      282    14282    1          2 COUNT UBIN BYTE UNAL,
      283    14283    1          2 TXTC CHAR(41) ,
      284    14284    1          2 SKEY REDEF TXTC,
      285    14285    1             3 PROJ UBIN BYTE UNAL,
      286    14286    1             3 CREATOR CHAR(20) UNAL,
      287    14287    1             3 USER CHAR(20) UNAL;
      288    14288
      289    14289
      290    14290        /********************************************************************/
      291    14291        /*    Auto data       auto data       auto data       auto data     */
      292    14292        /********************************************************************/
      293    14293
      294    14294    1   DCL I SBIN ;
      295    14295    1   DCL J SBIN ;
      296    14296    1   DCL ARS_TEMP SBIN ;
      297    14297    1   DCL ACCT CHAR(8) ;
      298    14298    1   DCL NAME CHAR(12) ;
      299    14299    1   DCL LEN UBIN ;
      300    14300    1   DCL 1 TEMP_KEY,
      301    14301    1          2 COUNT UBIN BYTE UNAL,
      302    14302    1          2 TEXT CHAR(20);
      303    14303    1   DCL ACCT_LEN      UBIN;
      304    14304    1   DCL MATCH_LEN     UBIN;
      305    14305    1   DCL NAME_LEN      UBIN;
      306    14306        %AS_USERS( STR_NAME=TEMP_USERS, STCLASS=AUTO );
      307    14484
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:73   
      308    14485        /*******************************************************************/
      309    14486        /*    Entry       entry       entry       entry       entry        */
      310    14487        /******************************************************************/
      311    14488
      312    14489        %ASB$READ_USERS ;
      313    14492        %ASB$READ_HLP ;
      314    14495        %ASB$READ_USERS_SEQ ;
      315    14498        %ASB$WILD_MATCH ;
      316    14501        %ASB$PREC_USERS ;
      317    14504        %ASB$PREC_AND_SKIP_USERS ;
      318    14507        %ASB$ENQ ;
      319    14510        %ASB$DEQ ;
      320    14513        %ASA$ERROR ;
      321    14516
      322    14517
      323    14518        /********************************************************************/
      324    14519        /*    Procedure       procedure       procedure       procedure     */
      325    14520        /*******************************************************************/
      326    14521
      327    14522
      328    14523                                                  /*
      329    14524                                                      Read the records from :USERS
      330    14525                                                      and :HLP.
      331    14526                                                  */
      332    14527    1   CALL ASB$ENQ ALTRET(ENQ_ERR);

  14527  3 000002   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000003   000000 701000 xent               TSX1    ASB$ENQ
         3 000004   000305 702000 3                  TSX2    ENQ_ERR

      333    14528    1   ENQDEQ_FLG = AS_TRUE ;

  14528  3 000005   000000 236000 xsym               LDQ     AS_TRUE
         3 000006   400000 376003                    ANQ     -131072,DU
         3 000007   000000 756000 xsym               STQ     ENQDEQ_FLG

      334    14529    1   CALL ASB$READ_USERS( USERS_REC1 ) ALTRET( USERS_DOESNT_EXIST ) ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:74   

  14529  3 000010   200005 630500                    EPPR0   @USERS_REC1,,AUTO
         3 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000012   000000 701000 xent               TSX1    ASB$READ_USERS
         3 000013   000250 702000 3                  TSX2    USERS_DOESNT_EXIST

      335    14530    1   ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;

  14530  3 000014   000000 235000 2                  LDA     SIZEC_DREC
         3 000015   001144 035007                    ADLA    612,DL
         3 000016   200013 755100                    STA     ARS_TEMP,,AUTO

      336    14531    1   IF ADDR(DREC1$) ~= ADDR(NIL) THEN

  14531  3 000017   200006 236100                    LDQ     @DREC1$,,AUTO
         3 000020   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000021   000031 600000 3                  TZE     s:14537

      337    14532    1      CALL ASB$READ_HLP( DREC1$,ARS_TEMP ) ALTRET( HLP_DOESNT_EXIST ) ;

  14532  3 000022   200013 630500                    EPPR0   ARS_TEMP,,AUTO
         3 000023   201041 450500                    STP0    TEMP_USERS+518,,AUTO
         3 000024   201040 756100                    STQ     TEMP_USERS+517,,AUTO
         3 000025   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000026   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000027   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000030   000267 702000 3                  TSX2    HLP_DOESNT_EXIST

      338    14533                                                  /*
      339    14534                                                      Make sure user can execute
      340    14535                                                      the command with this record
      341    14536                                                  */
      342    14537    1   IF ADDR(P_CODE) ~= ADDR(NIL) THEN

  14537  3 000031   200004 236100                    LDQ     @P_CODE,,AUTO
         3 000032   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000033   000202 600000 3                  TZE     s:14570
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:75   

      343    14538    2      IF AS_PROJECT_ADMIN ~= AS_NONE THEN DO;

  14538  3 000034   000000 106400                    CMPC    fill='000'O
         3 000035   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         3 000036   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         3 000037   000202 600000 3                  TZE     s:14570

      344    14539    3         DO SELECT( P_CODE ) ;

  14539  3 000040   200004 470500                    LDP0    @P_CODE,,AUTO
         3 000041   000000 236100                    LDQ     0,,PR0
         3 000042   000101 116007                    CMPQ    65,DL
         3 000043   000064 602000 3                  TNC     s:14539+20
         3 000044   000126 600000 3                  TZE     s:14552
         3 000045   000105 116007                    CMPQ    69,DL
         3 000046   000053 602000 3                  TNC     s:14539+11
         3 000047   000115 600000 3                  TZE     CHECK_IN_PROJ
         3 000050   000106 116007                    CMPQ    70,DL
         3 000051   000202 601000 3                  TNZ     s:14570
         3 000052   000115 710000 3                  TRA     CHECK_IN_PROJ
         3 000053   000103 116007                    CMPQ    67,DL
         3 000054   000061 602000 3                  TNC     s:14539+17
         3 000055   000126 600000 3                  TZE     s:14552
         3 000056   000104 116007                    CMPQ    68,DL
         3 000057   000202 601000 3                  TNZ     s:14570
         3 000060   000126 710000 3                  TRA     s:14552
         3 000061   000102 116007                    CMPQ    66,DL
         3 000062   000202 601000 3                  TNZ     s:14570
         3 000063   000126 710000 3                  TRA     s:14552
         3 000064   000044 116007                    CMPQ    36,DL
         3 000065   000076 602000 3                  TNC     s:14539+30
         3 000066   000115 600000 3                  TZE     CHECK_IN_PROJ
         3 000067   000062 116007                    CMPQ    50,DL
         3 000070   000073 602000 3                  TNC     s:14539+27
         3 000071   000115 600000 3                  TZE     CHECK_IN_PROJ
         3 000072   000202 710000 3                  TRA     s:14570
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:76   
         3 000073   000053 116007                    CMPQ    43,DL
         3 000074   000202 601000 3                  TNZ     s:14570
         3 000075   000115 710000 3                  TRA     CHECK_IN_PROJ
         3 000076   000010 116007                    CMPQ    8,DL
         3 000077   000102 602000 3                  TNC     s:14539+34
         3 000100   000105 600000 3                  TZE     s:14541
         3 000101   000202 710000 3                  TRA     s:14570
         3 000102   000007 116007                    CMPQ    7,DL
         3 000103   000202 601000 3                  TNZ     s:14570
         3 000104   000115 710000 3                  TRA     CHECK_IN_PROJ

      345    14540    3            SELECT( %LIST_PROJECT_VAL );

      346    14541    3            IF SUBSTR(USERS_KEY.TXTC,0,USERS_KEY.COUNT)

  14541  3 000105   000000 236000 xsym               LDQ     USERS_KEY
         3 000106   000033 772000                    QRL     27
         3 000107   000000 620006                    EAX0    0,QL
         3 000110   040000 106440                    CMPC    fill='040'O
         3 000111   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         3 000112   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 000113   000115 601000 3                  TNZ     CHECK_IN_PROJ
         3 000114   000202 710000 3                  TRA     s:14570

      347    14542    3                 ~= AS_PROJECT_ADMIN.TEXT
      348    14543    3            THEN GOTO CHECK_IN_PROJ;
      349    14544    3            SELECT( MODIFY_VAL, R_USER_VAL, R_PROJ_VAL, %LIST_USER_VAL,

      350    14545    3                 MOD_USER_TO_PROJ_VAL, MOD_PROJ_TO_USER_VAL );
      351    14546    3   CHECK_IN_PROJ: IF USERS_REC1.BUDGET.MACCT_.TEXT ~= AS_PROJECT_ADMIN.TEXT

  14546  3 000115   200005 471500       CHECK_IN_PR* LDP1    @USERS_REC1,,AUTO
         3 000116   040000 106500                    CMPC    fill='040'O
         3 000117   100012 200024                    ADSC9   10,,PR1                  cn=1,n=20
         3 000120   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 000121   000202 600000 3                  TZE     s:14570

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:77   
      352    14547    4            THEN DO;

      353    14548    4               CALL ASB$DEQ ;

  14548  3 000122   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000123   000000 701000 xent               TSX1    ASB$DEQ
         3 000124   000000 011000                    NOP     0

      354    14549    4               ALTRETURN;

  14549  3 000125   000000 702200 xent               TSX2  ! X66_AALT

      355    14550    4               END;
      356    14551    3            SELECT( UNTIE_USER_VAL,UNTIE_PROJ_VAL,TIE_USER_VAL,TIE_PROJ_VAL );

      357    14552    3            TEMP_KEY = USERS_KEY;

  14552  3 000126   000100 100400                    MLR     fill='000'O
         3 000127   000000 000025 xsym               ADSC9   USERS_KEY                cn=0,n=21
         3 000130   200022 000025                    ADSC9   TEMP_KEY,,AUTO           cn=0,n=21

      358    14553    3            TEMP_USERS = USERS_REC1;

  14553  3 000131   200005 471500                    LDP1    @USERS_REC1,,AUTO
         3 000132   000100 100500                    MLR     fill='000'O
         3 000133   100000 004020                    ADSC9   0,,PR1                   cn=0,n=2064
         3 000134   200033 004020                    ADSC9   TEMP_USERS,,AUTO         cn=0,n=2064

      359    14554    4            DO WHILE( TEMP_USERS.BUDGET.MACCT ~= AS_PROJECT_ADMIN

  14554  3 000135   000147 710000 3                  TRA     s:14558

      360    14555    4                 AND  TEMP_USERS.BUDGET.MACCT ~= AS_NONE );
      361    14556    4               USERS_KEY = TEMP_USERS.BUDGET.MACCT;

  14556  3 000136   000000 100500                    MLR     fill='000'O
         3 000137   200045 000025                    ADSC9   TEMP_USERS+10,,AUTO      cn=0,n=21
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:78   
         3 000140   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      362    14557    4               CALL ASB$READ_USERS( TEMP_USERS ) ALTRET(USERS_DOESNT_EXIST);

  14557  3 000141   200033 630500                    EPPR0   TEMP_USERS,,AUTO
         3 000142   201040 450500                    STP0    TEMP_USERS+517,,AUTO
         3 000143   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000144   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000145   000000 701000 xent               TSX1    ASB$READ_USERS
         3 000146   000250 702000 3                  TSX2    USERS_DOESNT_EXIST

      363    14558    4               END;

  14558  3 000147   000000 106500                    CMPC    fill='000'O
         3 000150   200045 000025                    ADSC9   TEMP_USERS+10,,AUTO      cn=0,n=21
         3 000151   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         3 000152   000157 600000 3                  TZE     s:14559
         3 000153   000000 106500                    CMPC    fill='000'O
         3 000154   200045 000025                    ADSC9   TEMP_USERS+10,,AUTO      cn=0,n=21
         3 000155   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         3 000156   000136 601000 3                  TNZ     s:14556

      364    14559    3            USERS_KEY = TEMP_KEY;

  14559  3 000157   000000 100500                    MLR     fill='000'O
         3 000160   200022 000025                    ADSC9   TEMP_KEY,,AUTO           cn=0,n=21
         3 000161   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      365    14560    4            IF TEMP_USERS.BUDGET.MACCT = AS_NONE THEN DO;

  14560  3 000162   000000 106500                    CMPC    fill='000'O
         3 000163   200045 000025                    ADSC9   TEMP_USERS+10,,AUTO      cn=0,n=21
         3 000164   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         3 000165   000202 601000 3                  TNZ     s:14570

      366    14561    4               CALL ASA$ERROR( USERS_KEY, E$NOT_BELOW, PROJ_FLAG );

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:79   
  14561  3 000166   200003 236100                    LDQ     @PROJ_FLAG,,AUTO
         3 000167   201042 756100                    STQ     TEMP_USERS+519,,AUTO
         3 000170   000002 237000 4                  LDAQ    2
         3 000171   201040 757100                    STAQ    TEMP_USERS+517,,AUTO
         3 000172   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000173   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000174   000000 701000 xent               TSX1    ASA$ERROR
         3 000175   000000 011000                    NOP     0

      367    14562    4               CALL ASB$DEQ ;

  14562  3 000176   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000177   000000 701000 xent               TSX1    ASB$DEQ
         3 000200   000000 011000                    NOP     0

      368    14563    4               ALTRETURN;

  14563  3 000201   000000 702200 xent               TSX2  ! X66_AALT

      369    14564    4               END;
      370    14565    3            END;      /* End do case */

      371    14566    2         END;        /* End then do */
      372    14567                                                  /*
      373    14568                                                      Read the default record for the
      374    14569                                                      project.           */
      375    14570    2   IF PROJ_FLAG THEN DO;

  14570  3 000202   200003 470500                    LDP0    @PROJ_FLAG,,AUTO
         3 000203   000000 234100                    SZN     0,,PR0
         3 000204   000244 605000 3                  TPL     s:14583

      376    14571    2      USERS_KEY.COUNT = 21 ;

  14571  3 000205   025000 236003                    LDQ     10752,DU
         3 000206   000000 552040 xsym               STBQ    USERS_KEY,'40'O

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:80   
      377    14572    2      USERS_KEY.UKEY.S = 'S' ;

  14572  3 000207   000123 236003                    LDQ     83,DU
         3 000210   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

      378    14573    2      CALL ASB$ENQ ALTRET(ENQ_ERR) ;

  14573  3 000211   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000212   000000 701000 xent               TSX1    ASB$ENQ
         3 000213   000305 702000 3                  TSX2    ENQ_ERR

      379    14574    2      CALL ASB$READ_USERS( USERS_REC2 ) ALTRET( USERS_DOESNT_EXIST ) ;

  14574  3 000214   200007 630500                    EPPR0   @USERS_REC2,,AUTO
         3 000215   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000216   000000 701000 xent               TSX1    ASB$READ_USERS
         3 000217   000250 702000 3                  TSX2    USERS_DOESNT_EXIST

      380    14575    2      IF USERS_REC2.BUDGET.PMAXC < 0 THEN USERS_REC2.BUDGET.PMAXC = 0;

  14575  3 000220   200007 470500                    LDP0    @USERS_REC2,,AUTO
         3 000221   000010 235100                    LDA     8,,PR0
         3 000222   000224 605000 3                  TPL     s:14576

  14575  3 000223   000010 450100                    STZ     8,,PR0

      381    14576    3      IF ADDR(DREC2$) ~= ADDR(NIL) THEN DO;

  14576  3 000224   200010 236100                    LDQ     @DREC2$,,AUTO
         3 000225   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000226   000241 600000 3                  TZE     s:14580

      382    14577    3         ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;

  14577  3 000227   000000 235000 2                  LDA     SIZEC_DREC
         3 000230   001144 035007                    ADLA    612,DL
         3 000231   200013 755100                    STA     ARS_TEMP,,AUTO
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:81   

      383    14578    3         CALL ASB$READ_HLP( DREC2$, ARS_TEMP ) ALTRET( HLP_DOESNT_EXIST ) ;

  14578  3 000232   200013 631500                    EPPR1   ARS_TEMP,,AUTO
         3 000233   201041 451500                    STP1    TEMP_USERS+518,,AUTO
         3 000234   201040 756100                    STQ     TEMP_USERS+517,,AUTO
         3 000235   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000236   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000237   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000240   000267 702000 3                  TSX2    HLP_DOESNT_EXIST

      384    14579    3         END;

      385    14580    2      CALL ASB$DEQ ;

  14580  3 000241   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000242   000000 701000 xent               TSX1    ASB$DEQ
         3 000243   000000 011000                    NOP     0

      386    14581    2      END ;

      387    14582
      388    14583    1   CALL ASB$DEQ ;

  14583  3 000244   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000245   000000 701000 xent               TSX1    ASB$DEQ
         3 000246   000000 011000                    NOP     0

      389    14584    1   RETURN ;

  14584  3 000247   000000 702200 xent               TSX2  ! X66_ARET

      390    14585
      391    14586                                                          /* Errors */
      392    14587    1   USERS_DOESNT_EXIST:
      393    14588    1   CALL ASB$DEQ ;

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:82   
  14588  3 000250   000002 631400 xsym  USERS_DOESN* EPPR1   B_VECTNIL+2
         3 000251   000000 701000 xent               TSX1    ASB$DEQ
         3 000252   000000 011000                    NOP     0

      394    14589    1   CALL ASB$DEQ ;

  14589  3 000253   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000254   000000 701000 xent               TSX1    ASB$DEQ
         3 000255   000000 011000                    NOP     0

      395    14590    1   CALL ASA$ERROR( USERS_KEY, E$DOESNT_EXIST, PROJ_FLAG ) ;

  14590  3 000256   200003 236100                    LDQ     @PROJ_FLAG,,AUTO
         3 000257   201042 756100                    STQ     TEMP_USERS+519,,AUTO
         3 000260   000004 237000 4                  LDAQ    4
         3 000261   201040 757100                    STAQ    TEMP_USERS+517,,AUTO
         3 000262   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000263   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000264   000000 701000 xent               TSX1    ASA$ERROR
         3 000265   000000 011000                    NOP     0

      396    14591    1   ALTRETURN ;

  14591  3 000266   000000 702200 xent               TSX2  ! X66_AALT

      397    14592
      398    14593    1   HLP_DOESNT_EXIST:
      399    14594    1   CALL ASB$DEQ ;

  14594  3 000267   000002 631400 xsym  HLP_DOESNT_* EPPR1   B_VECTNIL+2
         3 000270   000000 701000 xent               TSX1    ASB$DEQ
         3 000271   000000 011000                    NOP     0

      400    14595    1   CALL ASB$DEQ ;

  14595  3 000272   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000273   000000 701000 xent               TSX1    ASB$DEQ
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:83   
         3 000274   000000 011000                    NOP     0

      401    14596    1   CALL ASA$ERROR( USERS_KEY, E$DOESNT_EXIST, PROJ_FLAG ) ;

  14596  3 000275   200003 236100                    LDQ     @PROJ_FLAG,,AUTO
         3 000276   201042 756100                    STQ     TEMP_USERS+519,,AUTO
         3 000277   000004 237000 4                  LDAQ    4
         3 000300   201040 757100                    STAQ    TEMP_USERS+517,,AUTO
         3 000301   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000302   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000303   000000 701000 xent               TSX1    ASA$ERROR
         3 000304   000000 011000                    NOP     0

      402    14597    1   ENQ_ERR:
      403    14598    1   ALTRETURN;

  14598  3 000305   000000 702200 xent  ENQ_ERR      TSX2  ! X66_AALT

      404    14599
      405    14600        %EJECT ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:84   
      406    14601    1   ASB$INIT_GET_NEXT: ENTRY( PROJ_FLAG, P_CODE ) ALTRET ;

  14601  3 000306   000000 700200 xent  ASB$INIT_GE* TSX0  ! X66_AUTO_N
         3 000307   001044 000006                    ZERO    548,6

      407    14602
      408    14603    1   PROJECT_FLG = PROJ_FLAG ;

  14603  3 000310   200003 470500                    LDP0    @PROJ_FLAG,,AUTO
         3 000311   000000 236100                    LDQ     0,,PR0
         3 000312   400000 376003                    ANQ     -131072,DU
         3 000313   000000 756000 1                  STQ     PROJECT_FLG

      409    14604    1   PROJ_ADMIN_FLG = ( AS_PROJECT_ADMIN ~= AS_NONE ) ;

  14604  3 000314   400000 220003                    LDX0    -131072,DU
         3 000315   000000 106400                    CMPC    fill='000'O
         3 000316   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         3 000317   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         3 000320   000322 601000 3                  TNZ     s:14604+6
         3 000321   000000 220003                    LDX0    0,DU
         3 000322   000000 636010                    EAQ     0,X0
         3 000323   000001 756000 1                  STQ     PROJ_ADMIN_FLG

      410    14605    1   TYPE = P_CODE ;

  14605  3 000324   200004 471500                    LDP1    @P_CODE,,AUTO
         3 000325   100000 235100                    LDA     0,,PR1
         3 000326   000003 755000 1                  STA     TYPE

      411    14606    1   FIRST_TIME = AS_TRUE ;

  14606  3 000327   000000 236000 xsym               LDQ     AS_TRUE
         3 000330   400000 376003                    ANQ     -131072,DU
         3 000331   000002 756000 1                  STQ     FIRST_TIME

      412    14607
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:85   
      413    14608    1   IF NOT PROJ_ADMIN_FLG

  14608  3 000332   000001 234000 1                  SZN     PROJ_ADMIN_FLG
         3 000333   000421 604000 3                  TMI     s:14639

      414    14609    2   THEN DO ;                       /* System administrator */

      415    14610    2      IF PROJ_FLAG

  14610  3 000334   000000 234100                    SZN     0,,PR0
         3 000335   000343 605000 3                  TPL     s:14616

      416    14611    3      THEN DO ;                   /* Project */

      417    14612    3         LAST_KEY.COUNT = 1 ;

  14612  3 000336   001000 236003                    LDQ     512,DU
         3 000337   000004 552040 1                  STBQ    LAST_KEY,'40'O

      418    14613    3         LAST_KEY.SKEY.PROJ = 1 ;

  14613  3 000340   000001 236003                    LDQ     1,DU
         3 000341   000004 552020 1                  STBQ    LAST_KEY,'20'O

      419    14614    3         END ;

  14614  3 000342   000474 710000 3                  TRA     s:14661

      420    14615    3      ELSE DO;                    /* Not project */

      421    14616    3         CALL INDEX (I, '?', AS_ACCT_MATCH);

  14616  3 000343   000000 124400                    SCM     mask='000'O
         3 000344   000000 000010 xsym               ADSC9   AS_ACCT_MATCH            cn=0,n=8
         3 000345   000001 000001 4                  ADSC9   1                        cn=0,n=1
         3 000346   200011 000100                    ARG     I,,AUTO

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:86   
      422    14617    3         IF I = 0

  14617  3 000347   200011 235100                    LDA     I,,AUTO
         3 000350   000357 601000 3                  TNZ     s:14623

      423    14618    4         THEN DO ;

      424    14619    4            LAST_KEY.COUNT = 1 ;

  14619  3 000351   001000 236003                    LDQ     512,DU
         3 000352   000004 552040 1                  STBQ    LAST_KEY,'40'O

      425    14620    4            LAST_KEY.TXTC = AS_BLANK ;

  14620  3 000353   040000 100400                    MLR     fill='040'O
         3 000354   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000355   000004 200051 1                  ADSC9   LAST_KEY                 cn=1,n=41

      426    14621    4            END;

  14621  3 000356   000366 710000 3                  TRA     s:14626

      427    14622    4         ELSE DO ;

      428    14623    4            LAST_KEY.TXTC = SUBSTR( AS_ACCT_MATCH, 0, I);

  14623  3 000357   000000 620005                    EAX0    0,AL
         3 000360   040000 100440                    MLR     fill='040'O
         3 000361   000000 000010 xsym               ADSC9   AS_ACCT_MATCH            cn=0,n=*X0
         3 000362   000004 200051 1                  ADSC9   LAST_KEY                 cn=1,n=41

      429    14624    4            LAST_KEY.COUNT = I ;

  14624  3 000363   200011 236100                    LDQ     I,,AUTO
         3 000364   000033 736000                    QLS     27
         3 000365   000004 552040 1                  STBQ    LAST_KEY,'40'O

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:87   
      430    14625    4            END ;

      431    14626    3         CALL INDEX (J, '?', AS_NAME_MATCH)

  14626  3 000366   000000 124400                    SCM     mask='000'O
         3 000367   000000 000014 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=12
         3 000370   000001 000001 4                  ADSC9   1                        cn=0,n=1
         3 000371   200012 000100                    ARG     J,,AUTO
         3 000372   000404 606400 3                  TTN     s:14632

      432    14627    4         WHENRETURN DO;

      433    14628    4            CALL INSERT( LAST_KEY.TXTC, 8, ,SUBSTR(AS_NAME_MATCH,0,J));

  14628  3 000373   200012 720100                    LXL0    J,,AUTO
         3 000374   040000 100440                    MLR     fill='040'O
         3 000375   000000 000010 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=*X0
         3 000376   000006 200041 1                  ADSC9   LAST_KEY+2               cn=1,n=33

      434    14629    4            LAST_KEY.COUNT = 8 + J ;

  14629  3 000377   200012 236100                    LDQ     J,,AUTO
         3 000400   000010 036007                    ADLQ    8,DL
         3 000401   000033 736000                    QLS     27
         3 000402   000004 552040 1                  STBQ    LAST_KEY,'40'O

      435    14630    4            END ;

  14630  3 000403   000420 710000 3                  TRA     s:14637

      436    14631    4         WHENALTRETURN DO;

      437    14632    4            CALL INDEX (J, ' ', AS_NAME_MATCH);

  14632  3 000404   000000 124400                    SCM     mask='000'O
         3 000405   000000 000014 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=12
         3 000406   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:88   
         3 000407   200012 000100                    ARG     J,,AUTO

      438    14633    4            CALL INSERT( LAST_KEY.TXTC, 8, ,SUBSTR(AS_NAME_MATCH,0,J));

  14633  3 000410   200012 720100                    LXL0    J,,AUTO
         3 000411   040000 100440                    MLR     fill='040'O
         3 000412   000000 000010 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=*X0
         3 000413   000006 200041 1                  ADSC9   LAST_KEY+2               cn=1,n=33

      439    14634    4            LAST_KEY.COUNT = 8 + J ;

  14634  3 000414   200012 236100                    LDQ     J,,AUTO
         3 000415   000010 036007                    ADLQ    8,DL
         3 000416   000033 736000                    QLS     27
         3 000417   000004 552040 1                  STBQ    LAST_KEY,'40'O

      440    14635    4            END ;

      441    14636    3         END;

      442    14637    2      END ;

  14637  3 000420   000474 710000 3                  TRA     s:14661

      443    14638    2   ELSE DO ;                           /* Project administrator */

      444    14639    2      LAST_KEY.SKEY.PROJ = BITBIN( PROJECT_FLG ) ;

  14639  3 000421   000000 236000 1                  LDQ     PROJECT_FLG
         3 000422   000043 772000                    QRL     35
         3 000423   000022 736000                    QLS     18
         3 000424   000004 552020 1                  STBQ    LAST_KEY,'20'O

      445    14640    2      LAST_KEY.SKEY.CREATOR = AS_PROJECT_ADMIN.TEXT ;

  14640  3 000425   040000 100400                    MLR     fill='040'O
         3 000426   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:89   
         3 000427   000004 400024 1                  ADSC9   LAST_KEY                 cn=2,n=20

      446    14641    2      CALL INDEX (I, '?', AS_ACCT_MATCH);

  14641  3 000430   000000 124400                    SCM     mask='000'O
         3 000431   000000 000010 xsym               ADSC9   AS_ACCT_MATCH            cn=0,n=8
         3 000432   000001 000001 4                  ADSC9   1                        cn=0,n=1
         3 000433   200011 000100                    ARG     I,,AUTO

      447    14642    2      CALL INDEX (J, '?', AS_NAME_MATCH);

  14642  3 000434   000000 124400                    SCM     mask='000'O
         3 000435   000000 000014 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=12
         3 000436   000001 000001 4                  ADSC9   1                        cn=0,n=1
         3 000437   200012 000100                    ARG     J,,AUTO

      448    14643    2      IF I = 0

  14643  3 000440   200011 236100                    LDQ     I,,AUTO
         3 000441   000450 601000 3                  TNZ     s:14649

      449    14644    3      THEN DO;

      450    14645    3         LAST_KEY.SKEY.USER = AS_BLANK ;

  14645  3 000442   040000 100400                    MLR     fill='040'O
         3 000443   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000444   000011 400024 1                  ADSC9   LAST_KEY+5               cn=2,n=20

      451    14646    3         LAST_KEY.COUNT = 22 ;

  14646  3 000445   026000 236003                    LDQ     11264,DU
         3 000446   000004 552040 1                  STBQ    LAST_KEY,'40'O

      452    14647    3         END ;

  14647  3 000447   000474 710000 3                  TRA     s:14661
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:90   

      453    14648    3      ELSE DO ;

      454    14649    3         LAST_KEY.SKEY.USER = SUBSTR(AS_ACCT_MATCH, 0, I ) ;

  14649  3 000450   000000 620006                    EAX0    0,QL
         3 000451   040000 100440                    MLR     fill='040'O
         3 000452   000000 000010 xsym               ADSC9   AS_ACCT_MATCH            cn=0,n=*X0
         3 000453   000011 400024 1                  ADSC9   LAST_KEY+5               cn=2,n=20

      455    14650    3         LAST_KEY.COUNT = 21 + I ;

  14650  3 000454   200011 236100                    LDQ     I,,AUTO
         3 000455   000025 036007                    ADLQ    21,DL
         3 000456   000033 736000                    QLS     27
         3 000457   000004 552040 1                  STBQ    LAST_KEY,'40'O

      456    14651    3         IF (I = 0) AND (J > 0)

  14651  3 000460   200011 236100                    LDQ     I,,AUTO
         3 000461   000474 601000 3                  TNZ     s:14661
         3 000462   200012 235100                    LDA     J,,AUTO
         3 000463   000474 604400 3                  TMOZ    s:14661

      457    14652    4         THEN DO ;

      458    14653    4            CALL INSERT( LAST_KEY.SKEY.USER, 8, ,

  14653  3 000464   000000 620005                    EAX0    0,AL
         3 000465   040000 100440                    MLR     fill='040'O
         3 000466   000000 000010 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=*X0
         3 000467   000013 400014 1                  ADSC9   LAST_KEY+7               cn=2,n=12

      459    14654    4                 SUBSTR(AS_NAME_MATCH,0,J) ) ;
      460    14655    4            LAST_KEY.COUNT = 29 + J ;

  14655  3 000470   200012 236100                    LDQ     J,,AUTO
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:91   
         3 000471   000035 036007                    ADLQ    29,DL
         3 000472   000033 736000                    QLS     27
         3 000473   000004 552040 1                  STBQ    LAST_KEY,'40'O

      461    14656    4            END ;

      462    14657    3         END ;

      463    14658    2      END ;

      464    14659
      465    14660
      466    14661    1   RETURN ;

  14661  3 000474   000000 702200 xent               TSX2  ! X66_ARET

      467    14662
      468    14663        %EJECT ;
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:92   
      469    14664    1   ASB$GET_NEXT: ENTRY ALTRET ;

  14664  3 000475   000000 700200 xent  ASB$GET_NEXT TSX0  ! X66_AUTO_N
         3 000476   001044 000006                    ZERO    548,6

      470    14665
      471    14666    1   USERS_KEY = LAST_KEY ;

  14666  3 000477   000000 100400                    MLR     fill='000'O
         3 000500   000004 000052 1                  ADSC9   LAST_KEY                 cn=0,n=42
         3 000501   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      472    14667    2   IF FIRST_TIME THEN DO ;         /* Position to first key */

  14667  3 000502   000002 234000 1                  SZN     FIRST_TIME
         3 000503   000513 605000 3                  TPL     s:14672

      473    14668    2      FIRST_TIME = AS_FALSE ;

  14668  3 000504   000000 236000 xsym               LDQ     AS_FALSE
         3 000505   400000 376003                    ANQ     -131072,DU
         3 000506   000002 756000 1                  STQ     FIRST_TIME

      474    14669    2      CALL ASB$PREC_USERS ;

  14669  3 000507   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000510   000000 701000 xent               TSX1    ASB$PREC_USERS
         3 000511   000000 011000                    NOP     0

      475    14670    2      END ;

  14670  3 000512   000540 710000 3                  TRA     READ_NEXT

      476    14671    2   ELSE DO ;

      477    14672    3      DO SELECT( TYPE ) ;

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:93   
  14672  3 000513   000003 236000 1                  LDQ     TYPE
         3 000514   000053 116007                    CMPQ    43,DL
         3 000515   000535 602000 3                  TNC     s:14682
         3 000516   000522 600000 3                  TZE     s:14674
         3 000517   000062 116007                    CMPQ    50,DL
         3 000520   000535 601000 3                  TNZ     s:14682
         3 000521   000522 710000 3                  TRA     s:14674

      478    14673    3         SELECT( R_USER_VAL, R_PROJ_VAL ) ;

      479    14674    3         CALL ASB$PREC_USERS    /* Position to last key */

  14674  3 000522   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000523   000000 701000 xent               TSX1    ASB$PREC_USERS
         3 000524   000534 702000 3                  TSX2    s:14679

      480    14675    4         WHENRETURN DO;

      481    14676    5            IF USERS_KEY = LAST_KEY THEN DO;

  14676  3 000525   000000 106400                    CMPC    fill='000'O
         3 000526   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         3 000527   000004 000052 1                  ADSC9   LAST_KEY                 cn=0,n=42
         3 000530   000534 601000 3                  TNZ     s:14679

      482    14677    5               CALL ASB$PREC_AND_SKIP_USERS;

  14677  3 000531   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000532   000000 701000 xent               TSX1    ASB$PREC_AND_SKIP_USERS
         3 000533   000000 011000                    NOP     0

      483    14678    5               END;

      484    14679    4            END;

  14679  3 000534   000540 710000 3                  TRA     READ_NEXT

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:94   
      485    14680    3         SELECT( ELSE );

      486    14681                                         /* Postion to last key and skip 1 record */
      487    14682    3      CALL ASB$PREC_AND_SKIP_USERS ;

  14682  3 000535   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000536   000000 701000 xent               TSX1    ASB$PREC_AND_SKIP_USERS
         3 000537   000000 011000                    NOP     0

      488    14683    3         END ;

      489    14684    2      END ;

      490    14685
      491    14686    2   DO WHILE( '1'B ) ;

      492    14687
      493    14688    2   READ_NEXT:
      494    14689    2      CALL ASB$READ_USERS_SEQ( AS_USERS ) ALTRET( NONE ) ;

  14689  3 000540   000006 630400 4     READ_NEXT    EPPR0   6
         3 000541   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000542   000000 701000 xent               TSX1    ASB$READ_USERS_SEQ
         3 000543   001231 702000 3                  TSX2    NONE

      495    14690    2      IF NOT PROJ_ADMIN_FLG  AND  NOT PROJECT_FLG

  14690  3 000544   000001 234000 1                  SZN     PROJ_ADMIN_FLG
         3 000545   000674 604000 3                  TMI     s:14711
         3 000546   000000 234000 1                  SZN     PROJECT_FLG
         3 000547   000674 604000 3                  TMI     s:14711

      496    14691    3      THEN DO ;

      497    14692    3         IF USERS_KEY.COUNT > 20 THEN GOTO READ_NEXT ;

  14692  3 000550   000000 236000 xsym               LDQ     USERS_KEY
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:95   
         3 000551   777000 376003                    ANQ     -512,DU
         3 000552   025000 116003                    CMPQ    10752,DU
         3 000553   000540 603000 3                  TRC     READ_NEXT

      498    14693    3         ACCT = SUBSTR( USERS_KEY.TXTC, 0, 8 ) ;

  14693  3 000554   040100 100400                    MLR     fill='040'O
         3 000555   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         3 000556   200014 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

      499    14694    3         NAME = SUBSTR( USERS_KEY.TXTC, 8, USERS_KEY.COUNT-8 ) ;

  14694  3 000557   000000 236000 xsym               LDQ     USERS_KEY
         3 000560   000033 772000                    QRL     27
         3 000561   777770 620006                    EAX0    -8,QL
         3 000562   040100 100440                    MLR     fill='040'O
         3 000563   000002 200010 xsym               ADSC9   USERS_KEY+2              cn=1,n=*X0
         3 000564   200016 000014                    ADSC9   NAME,,AUTO               cn=0,n=12

      500    14695    3         CALL INDEX (ACCT_LEN, ' ', ACCT);

  14695  3 000565   000000 124500                    SCM     mask='000'O
         3 000566   200014 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         3 000567   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000570   200030 000100                    ARG     ACCT_LEN,,AUTO

      501    14696    3         IF ACCT_LEN = 0 THEN ACCT_LEN = 1;

  14696  3 000571   200030 235100                    LDA     ACCT_LEN,,AUTO
         3 000572   000575 601000 3                  TNZ     s:14697

  14696  3 000573   000001 235007                    LDA     1,DL
         3 000574   200030 755100                    STA     ACCT_LEN,,AUTO

      502    14697    3         CALL INDEX (MATCH_LEN, ' ', AS_ACCT_MATCH);

  14697  3 000575   000000 124400                    SCM     mask='000'O
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:96   
         3 000576   000000 000010 xsym               ADSC9   AS_ACCT_MATCH            cn=0,n=8
         3 000577   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000600   200031 000100                    ARG     MATCH_LEN,,AUTO

      503    14698    3         IF MATCH_LEN = 0 THEN MATCH_LEN = 1;

  14698  3 000601   200031 235100                    LDA     MATCH_LEN,,AUTO
         3 000602   000605 601000 3                  TNZ     s:14699

  14698  3 000603   000001 235007                    LDA     1,DL
         3 000604   200031 755100                    STA     MATCH_LEN,,AUTO

      504    14699    3         CALL ASB$WILD_MATCH(ACCT_LEN, ACCT, MATCH_LEN, AS_ACCT_MATCH) ALTRET(FAILED);

  14699  3 000605   000007 236000 4                  LDQ     7
         3 000606   201043 756100                    STQ     TEMP_USERS+520,,AUTO
         3 000607   200031 630500                    EPPR0   MATCH_LEN,,AUTO
         3 000610   201042 450500                    STP0    TEMP_USERS+519,,AUTO
         3 000611   200014 631500                    EPPR1   ACCT,,AUTO
         3 000612   201041 451500                    STP1    TEMP_USERS+518,,AUTO
         3 000613   200030 633500                    EPPR3   ACCT_LEN,,AUTO
         3 000614   201040 453500                    STP3    TEMP_USERS+517,,AUTO
         3 000615   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000616   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000617   000000 701000 xent               TSX1    ASB$WILD_MATCH
         3 000620   001157 702000 3                  TSX2    FAILED

      505    14700    3         CALL INDEX (NAME_LEN, ' ', NAME);

  14700  3 000621   000000 124500                    SCM     mask='000'O
         3 000622   200016 000014                    ADSC9   NAME,,AUTO               cn=0,n=12
         3 000623   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000624   200032 000100                    ARG     NAME_LEN,,AUTO

      506    14701    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;

  14701  3 000625   200032 235100                    LDA     NAME_LEN,,AUTO
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:97   
         3 000626   000631 601000 3                  TNZ     s:14702

  14701  3 000627   000001 236007                    LDQ     1,DL
         3 000630   200032 756100                    STQ     NAME_LEN,,AUTO

      507    14702    3         CALL INDEX (MATCH_LEN, ' ', AS_NAME_MATCH);

  14702  3 000631   000000 124400                    SCM     mask='000'O
         3 000632   000000 000014 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=12
         3 000633   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000634   200031 000100                    ARG     MATCH_LEN,,AUTO

      508    14703    3         IF MATCH_LEN = 0 THEN MATCH_LEN = 1;

  14703  3 000635   200031 235100                    LDA     MATCH_LEN,,AUTO
         3 000636   000641 601000 3                  TNZ     s:14704

  14703  3 000637   000001 236007                    LDQ     1,DL
         3 000640   200031 756100                    STQ     MATCH_LEN,,AUTO

      509    14704    3        CALL ASB$WILD_MATCH(NAME_LEN, NAME, MATCH_LEN, AS_NAME_MATCH ) ALTRET(FAILED);

  14704  3 000641   000010 236000 4                  LDQ     8
         3 000642   201043 756100                    STQ     TEMP_USERS+520,,AUTO
         3 000643   200031 630500                    EPPR0   MATCH_LEN,,AUTO
         3 000644   201042 450500                    STP0    TEMP_USERS+519,,AUTO
         3 000645   200016 631500                    EPPR1   NAME,,AUTO
         3 000646   201041 451500                    STP1    TEMP_USERS+518,,AUTO
         3 000647   200032 633500                    EPPR3   NAME_LEN,,AUTO
         3 000650   201040 453500                    STP3    TEMP_USERS+517,,AUTO
         3 000651   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000652   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000653   000000 701000 xent               TSX1    ASB$WILD_MATCH
         3 000654   001157 702000 3                  TSX2    FAILED

      510    14705    3         ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:98   
  14705  3 000655   000000 235000 2                  LDA     SIZEC_DREC
         3 000656   001144 035007                    ADLA    612,DL
         3 000657   200013 755100                    STA     ARS_TEMP,,AUTO

      511    14706    3         CALL ASB$READ_HLP( KL_DREC$,ARS_TEMP ) ALTRET( CANT_READ_HLP );

  14706  3 000660   200013 630500                    EPPR0   ARS_TEMP,,AUTO
         3 000661   201041 450500                    STP0    TEMP_USERS+518,,AUTO
         3 000662   000011 236000 4                  LDQ     9
         3 000663   201040 756100                    STQ     TEMP_USERS+517,,AUTO
         3 000664   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000665   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000666   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000667   001225 702000 3                  TSX2    CANT_READ_HLP

      512    14707    3         LAST_KEY = USERS_KEY;

  14707  3 000670   000000 100400                    MLR     fill='000'O
         3 000671   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         3 000672   000004 000052 1                  ADSC9   LAST_KEY                 cn=0,n=42

      513    14708    3         RETURN ;

  14708  3 000673   000000 702200 xent               TSX2  ! X66_ARET

      514    14709    3         END ;
      515    14710    3      ELSE DO ;

      516    14711    3         IF USERS_KEY.COUNT < 22 THEN ALTRETURN ;

  14711  3 000674   000000 236000 xsym               LDQ     USERS_KEY
         3 000675   777000 376003                    ANQ     -512,DU
         3 000676   026000 116003                    CMPQ    11264,DU
         3 000677   000701 603000 3                  TRC     s:14712

  14711  3 000700   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:99   
      517    14712    3         IF USERS_KEY.SKEY.PROJ ~= BITBIN(PROJECT_FLG) THEN ALTRETURN ;

  14712  3 000701   000000 236000 1                  LDQ     PROJECT_FLG
         3 000702   000043 772000                    QRL     35
         3 000703   201040 756100                    STQ     TEMP_USERS+517,,AUTO
         3 000704   000000 236000 xsym               LDQ     USERS_KEY
         3 000705   000022 772000                    QRL     18
         3 000706   000777 376007                    ANQ     511,DL
         3 000707   201040 116100                    CMPQ    TEMP_USERS+517,,AUTO
         3 000710   000712 600000 3                  TZE     s:14713

  14712  3 000711   000000 702200 xent               TSX2  ! X66_AALT

      518    14713    3         IF USERS_KEY.SKEY.CREATOR ~= AS_PROJECT_ADMIN.TEXT

  14713  3 000712   040000 106400                    CMPC    fill='040'O
         3 000713   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20
         3 000714   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 000715   000721 600000 3                  TZE     s:14716
         3 000716   000001 234000 1                  SZN     PROJ_ADMIN_FLG
         3 000717   000721 605000 3                  TPL     s:14716

      519    14714    3              AND  PROJ_ADMIN_FLG
      520    14715    3         THEN ALTRETURN ;

  14715  3 000720   000000 702200 xent               TSX2  ! X66_AALT

      521    14716    3         LAST_KEY = USERS_KEY ;

  14716  3 000721   000000 100400                    MLR     fill='000'O
         3 000722   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         3 000723   000004 000052 1                  ADSC9   LAST_KEY                 cn=0,n=42

      522    14717    3         ACCT = SUBSTR( USERS_KEY.SKEY.USER, 0, 8 ) ;

  14717  3 000724   040100 100400                    MLR     fill='040'O
         3 000725   000005 400010 xsym               ADSC9   USERS_KEY+5              cn=2,n=8
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:100  
         3 000726   200014 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

      523    14718    3         NAME = SUBSTR( USERS_KEY.SKEY.USER, 8, 12 ) ;

  14718  3 000727   040100 100400                    MLR     fill='040'O
         3 000730   000007 400014 xsym               ADSC9   USERS_KEY+7              cn=2,n=12
         3 000731   200016 000014                    ADSC9   NAME,,AUTO               cn=0,n=12

      524    14719    3         CALL INDEX (ACCT_LEN, ' ', ACCT);

  14719  3 000732   000000 124500                    SCM     mask='000'O
         3 000733   200014 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         3 000734   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000735   200030 000100                    ARG     ACCT_LEN,,AUTO

      525    14720    3         IF ACCT_LEN = 0 THEN ACCT_LEN = 1;

  14720  3 000736   200030 235100                    LDA     ACCT_LEN,,AUTO
         3 000737   000742 601000 3                  TNZ     s:14721

  14720  3 000740   000001 235007                    LDA     1,DL
         3 000741   200030 755100                    STA     ACCT_LEN,,AUTO

      526    14721    3         CALL INDEX (MATCH_LEN, ' ', AS_ACCT_MATCH);

  14721  3 000742   000000 124400                    SCM     mask='000'O
         3 000743   000000 000010 xsym               ADSC9   AS_ACCT_MATCH            cn=0,n=8
         3 000744   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000745   200031 000100                    ARG     MATCH_LEN,,AUTO

      527    14722    3         IF MATCH_LEN = 0 THEN MATCH_LEN = 1;

  14722  3 000746   200031 235100                    LDA     MATCH_LEN,,AUTO
         3 000747   000752 601000 3                  TNZ     s:14723

  14722  3 000750   000001 235007                    LDA     1,DL
         3 000751   200031 755100                    STA     MATCH_LEN,,AUTO
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:101  

      528    14723    3        CALL ASB$WILD_MATCH(ACCT_LEN, ACCT, MATCH_LEN, AS_ACCT_MATCH ) ALTRET(FAILED);

  14723  3 000752   000007 236000 4                  LDQ     7
         3 000753   201043 756100                    STQ     TEMP_USERS+520,,AUTO
         3 000754   200031 630500                    EPPR0   MATCH_LEN,,AUTO
         3 000755   201042 450500                    STP0    TEMP_USERS+519,,AUTO
         3 000756   200014 631500                    EPPR1   ACCT,,AUTO
         3 000757   201041 451500                    STP1    TEMP_USERS+518,,AUTO
         3 000760   200030 633500                    EPPR3   ACCT_LEN,,AUTO
         3 000761   201040 453500                    STP3    TEMP_USERS+517,,AUTO
         3 000762   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 000763   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000764   000000 701000 xent               TSX1    ASB$WILD_MATCH
         3 000765   001157 702000 3                  TSX2    FAILED

      529    14724    3         CALL INDEX (NAME_LEN, ' ', NAME);

  14724  3 000766   000000 124500                    SCM     mask='000'O
         3 000767   200016 000014                    ADSC9   NAME,,AUTO               cn=0,n=12
         3 000770   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000771   200032 000100                    ARG     NAME_LEN,,AUTO

      530    14725    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;

  14725  3 000772   200032 235100                    LDA     NAME_LEN,,AUTO
         3 000773   000776 601000 3                  TNZ     s:14726

  14725  3 000774   000001 236007                    LDQ     1,DL
         3 000775   200032 756100                    STQ     NAME_LEN,,AUTO

      531    14726    3         CALL INDEX (MATCH_LEN, ' ', AS_NAME_MATCH);

  14726  3 000776   000000 124400                    SCM     mask='000'O
         3 000777   000000 000014 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=12
         3 001000   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001001   200031 000100                    ARG     MATCH_LEN,,AUTO
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:102  

      532    14727    3         IF MATCH_LEN = 0 THEN MATCH_LEN = 1;

  14727  3 001002   200031 235100                    LDA     MATCH_LEN,,AUTO
         3 001003   001006 601000 3                  TNZ     s:14728

  14727  3 001004   000001 236007                    LDQ     1,DL
         3 001005   200031 756100                    STQ     MATCH_LEN,,AUTO

      533    14728    3        CALL ASB$WILD_MATCH(NAME_LEN, NAME, MATCH_LEN, AS_NAME_MATCH ) ALTRET(FAILED);

  14728  3 001006   000010 236000 4                  LDQ     8
         3 001007   201043 756100                    STQ     TEMP_USERS+520,,AUTO
         3 001010   200031 630500                    EPPR0   MATCH_LEN,,AUTO
         3 001011   201042 450500                    STP0    TEMP_USERS+519,,AUTO
         3 001012   200016 631500                    EPPR1   NAME,,AUTO
         3 001013   201041 451500                    STP1    TEMP_USERS+518,,AUTO
         3 001014   200032 633500                    EPPR3   NAME_LEN,,AUTO
         3 001015   201040 453500                    STP3    TEMP_USERS+517,,AUTO
         3 001016   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 001017   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001020   000000 701000 xent               TSX1    ASB$WILD_MATCH
         3 001021   001157 702000 3                  TSX2    FAILED

      534    14729    3         CALL INDEX( I, AS_BLANK, SUBSTR(USERS_KEY.SKEY.USER,8) ) ;

  14729  3 001022   000000 124400                    SCM     mask='000'O
         3 001023   000007 400014 xsym               ADSC9   USERS_KEY+7              cn=2,n=12
         3 001024   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 001025   200011 000100                    ARG     I,,AUTO

      535    14730    3         USERS_KEY.COUNT = 8 + I ;

  14730  3 001026   200011 236100                    LDQ     I,,AUTO
         3 001027   000010 036007                    ADLQ    8,DL
         3 001030   000033 736000                    QLS     27
         3 001031   000000 552040 xsym               STBQ    USERS_KEY,'40'O
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:103  

      536    14731    3         USERS_KEY.TXTC = LAST_KEY.SKEY.USER ;

  14731  3 001032   040000 100400                    MLR     fill='040'O
         3 001033   000011 400024 1                  ADSC9   LAST_KEY+5               cn=2,n=20
         3 001034   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      537    14732    3         IF PROJECT_FLG

  14732  3 001035   000000 234000 1                  SZN     PROJECT_FLG
         3 001036   001137 605000 3                  TPL     s:14758

      538    14733    4         THEN DO;

      539    14734    4            CALL ASB$READ_USERS(AS_PROJECT) WHENALTRETURN

  14734  3 001037   000012 630400 4                  EPPR0   10
         3 001040   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001041   000000 701000 xent               TSX1    ASB$READ_USERS
         3 001042   001044 702000 3                  TSX2    s:14736
         3 001043   001050 710000 3                  TRA     s:14738

      540    14735    5            DO;

      541    14736    5               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_USERS, PROJECT_FLG ) ;

  14736  3 001044   000014 630400 4                  EPPR0   12
         3 001045   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001046   000000 701000 xent               TSX1    ASA$ERROR
         3 001047   000000 011000                    NOP     0

      542    14737    5               END; /*  Whenaltreturn  */

      543    14738    4            ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;

  14738  3 001050   000000 235000 2                  LDA     SIZEC_DREC
         3 001051   001144 035007                    ADLA    612,DL
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:104  
         3 001052   200013 755100                    STA     ARS_TEMP,,AUTO

      544    14739    4            CALL ASB$READ_HLP(AS_PROJECT_DREC$,ARS_TEMP) WHENALTRETURN

  14739  3 001053   200013 630500                    EPPR0   ARS_TEMP,,AUTO
         3 001054   201041 450500                    STP0    TEMP_USERS+518,,AUTO
         3 001055   000017 236000 4                  LDQ     15
         3 001056   201040 756100                    STQ     TEMP_USERS+517,,AUTO
         3 001057   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 001060   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001061   000000 701000 xent               TSX1    ASB$READ_HLP
         3 001062   001064 702000 3                  TSX2    s:14741
         3 001063   001070 710000 3                  TRA     s:14743

      545    14740    5            DO;

      546    14741    5               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP, PROJECT_FLG ) ;

  14741  3 001064   000021 630400 4                  EPPR0   17
         3 001065   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001066   000000 701000 xent               TSX1    ASA$ERROR
         3 001067   000000 011000                    NOP     0

      547    14742    5               END; /*  Whenaltreturn  */

      548    14743    4            USERS_KEY.COUNT = 21;

  14743  3 001070   025000 236003                    LDQ     10752,DU
         3 001071   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      549    14744    4            USERS_KEY.UKEY.S = 'S';

  14744  3 001072   000123 236003                    LDQ     83,DU
         3 001073   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

      550    14745    4            CALL ASB$READ_USERS(AS_PROJECT_DFLT) WHENALTRETURN

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:105  
  14745  3 001074   000024 630400 4                  EPPR0   20
         3 001075   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001076   000000 701000 xent               TSX1    ASB$READ_USERS
         3 001077   001101 702000 3                  TSX2    s:14747
         3 001100   001105 710000 3                  TRA     s:14749

      551    14746    5            DO;

      552    14747    5               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_USERS, PROJECT_FLG ) ;

  14747  3 001101   000014 630400 4                  EPPR0   12
         3 001102   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001103   000000 701000 xent               TSX1    ASA$ERROR
         3 001104   000000 011000                    NOP     0

      553    14748    5               END; /*  Whenaltreturn  */

      554    14749    4            IF AS_PROJECT_DFLT.BUDGET.PMAXC < 0 THEN AS_PROJECT_DFLT.BUDGET.PMAXC = 0;

  14749  3 001105   000010 235000 xsym               LDA     AS_PROJECT_DFLT+8
         3 001106   001110 605000 3                  TPL     s:14750

  14749  3 001107   000010 450000 xsym               STZ     AS_PROJECT_DFLT+8

      555    14750    4            ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;

  14750  3 001110   000000 235000 2                  LDA     SIZEC_DREC
         3 001111   001144 035007                    ADLA    612,DL
         3 001112   200013 755100                    STA     ARS_TEMP,,AUTO

      556    14751    4            CALL ASB$READ_HLP(AS_PROJECT_DFLT_DREC$,ARS_TEMP) WHENALTRETURN

  14751  3 001113   200013 630500                    EPPR0   ARS_TEMP,,AUTO
         3 001114   201041 450500                    STP0    TEMP_USERS+518,,AUTO
         3 001115   000025 236000 4                  LDQ     21
         3 001116   201040 756100                    STQ     TEMP_USERS+517,,AUTO
         3 001117   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:106  
         3 001120   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001121   000000 701000 xent               TSX1    ASB$READ_HLP
         3 001122   001124 702000 3                  TSX2    s:14753
         3 001123   001130 710000 3                  TRA     s:14755

      557    14752    5            DO;

      558    14753    5               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP, PROJECT_FLG ) ;

  14753  3 001124   000021 630400 4                  EPPR0   17
         3 001125   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001126   000000 701000 xent               TSX1    ASA$ERROR
         3 001127   000000 011000                    NOP     0

      559    14754    5               END; /*  Whenaltreturn  */

      560    14755    4            IF TYPE = R_PROJ_VAL THEN USERS_KEY = LAST_KEY;

  14755  3 001130   000003 235000 1                  LDA     TYPE
         3 001131   000062 115007                    CMPA    50,DL
         3 001132   001156 601000 3                  TNZ     s:14762

  14755  3 001133   000000 100400                    MLR     fill='000'O
         3 001134   000004 000052 1                  ADSC9   LAST_KEY                 cn=0,n=42
         3 001135   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      561    14756    4            END;

  14756  3 001136   001156 710000 3                  TRA     s:14762

      562    14757    4         ELSE DO;

      563    14758    4            CALL ASB$READ_USERS( AS_USERS ) ALTRET(CANT_READ_USERS);

  14758  3 001137   000006 630400 4                  EPPR0   6
         3 001140   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001141   000000 701000 xent               TSX1    ASB$READ_USERS
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:107  
         3 001142   001220 702000 3                  TSX2    CANT_READ_USERS

      564    14759    4            ARS_TEMP = SIZEC_DREC + (SIZEW(KL_DREC.KL_DREC_FEBLK)*4) ;

  14759  3 001143   000000 235000 2                  LDA     SIZEC_DREC
         3 001144   001144 035007                    ADLA    612,DL
         3 001145   200013 755100                    STA     ARS_TEMP,,AUTO

      565    14760    4            CALL ASB$READ_HLP  ( KL_DREC$ ,ARS_TEMP) ALTRET(CANT_READ_HLP);

  14760  3 001146   200013 630500                    EPPR0   ARS_TEMP,,AUTO
         3 001147   201041 450500                    STP0    TEMP_USERS+518,,AUTO
         3 001150   000011 236000 4                  LDQ     9
         3 001151   201040 756100                    STQ     TEMP_USERS+517,,AUTO
         3 001152   201040 630500                    EPPR0   TEMP_USERS+517,,AUTO
         3 001153   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001154   000000 701000 xent               TSX1    ASB$READ_HLP
         3 001155   001225 702000 3                  TSX2    CANT_READ_HLP

      566    14761    4            END ;

      567    14762    3         RETURN ;

  14762  3 001156   000000 702200 xent               TSX2  ! X66_ARET

      568    14763    3         END ;
      569    14764    2   FAILED:
      570    14765    2      IF PROJECT_FLG AND NOT PROJ_ADMIN_FLG THEN GOTO READ_NEXT;

  14765  3 001157   000000 234000 1     FAILED       SZN     PROJECT_FLG
         3 001160   001163 605000 3                  TPL     s:14766
         3 001161   000001 234000 1                  SZN     PROJ_ADMIN_FLG
         3 001162   000540 605000 3                  TPL     READ_NEXT

      571    14766    2      CALL INDEX (LEN, '?', AS_ACCT_MATCH);

  14766  3 001163   000000 124400                    SCM     mask='000'O
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:108  
         3 001164   000000 000010 xsym               ADSC9   AS_ACCT_MATCH            cn=0,n=8
         3 001165   000001 000001 4                  ADSC9   1                        cn=0,n=1
         3 001166   200021 000100                    ARG     LEN,,AUTO

      572    14767    3      IF LEN ~= 0 THEN DO;

  14767  3 001167   200021 235100                    LDA     LEN,,AUTO
         3 001170   000540 600000 3                  TZE     READ_NEXT

      573    14768    3         IF SUBSTR (ACCT, 0, LEN) ~= SUBSTR (AS_ACCT_MATCH, 0, LEN) THEN

  14768  3 001171   000000 620005                    EAX0    0,AL
         3 001172   200021 721100                    LXL1    LEN,,AUTO
         3 001173   040040 106540                    CMPC    fill='040'O
         3 001174   200014 000010                    ADSC9   ACCT,,AUTO               cn=0,n=*X0
         3 001175   000000 000011 xsym               ADSC9   AS_ACCT_MATCH            cn=0,n=*X1
         3 001176   001200 600000 3                  TZE     s:14771

      574    14769    3            ALTRETURN;

  14769  3 001177   000000 702200 xent               TSX2  ! X66_AALT

      575    14770    4         ELSE DO;

      576    14771    4            CALL INDEX (NAME_LEN, '?', AS_NAME_MATCH);

  14771  3 001200   000000 124400                    SCM     mask='000'O
         3 001201   000000 000014 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=12
         3 001202   000001 000001 4                  ADSC9   1                        cn=0,n=1
         3 001203   200032 000100                    ARG     NAME_LEN,,AUTO

      577    14772    4            IF LEN = LENGTHC(AS_ACCT_MATCH) AND NAME_LEN ~= 0

  14772  3 001204   200021 235100                    LDA     LEN,,AUTO
         3 001205   000010 115007                    CMPA    8,DL
         3 001206   000540 601000 3                  TNZ     READ_NEXT
         3 001207   200032 236100                    LDQ     NAME_LEN,,AUTO
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:109  
         3 001210   000540 600000 3                  TZE     READ_NEXT

      578    14773    5            THEN DO;

      579    14774    5               IF SUBSTR(NAME, 0, NAME_LEN) > SUBSTR(AS_NAME_MATCH, 0, NAME_LEN)

  14774  3 001211   000000 620006                    EAX0    0,QL
         3 001212   200032 722100                    LXL2    NAME_LEN,,AUTO
         3 001213   040140 106440                    CMPC    fill='040'O
         3 001214   000000 000010 xsym               ADSC9   AS_NAME_MATCH            cn=0,n=*X0
         3 001215   200016 000012                    ADSC9   NAME,,AUTO               cn=0,n=*X2
         3 001216   000540 603000 3                  TRC     READ_NEXT

      580    14775    5               THEN
      581    14776    5                  ALTRETURN;

  14776  3 001217   000000 702200 xent               TSX2  ! X66_AALT

      582    14777    5               END;
      583    14778    4            END;
      584    14779    3         END;
      585    14780    2      END ;    /* Do forever */

      586    14781
      587    14782    1   CANT_READ_USERS:
      588    14783    1   CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_USERS, PROJECT_FLG ) ;

  14783  3 001220   000014 630400 4     CANT_READ_U* EPPR0   12
         3 001221   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001222   000000 701000 xent               TSX1    ASA$ERROR
         3 001223   000000 011000                    NOP     0

      589    14784    1   ALTRETURN;

  14784  3 001224   000000 702200 xent               TSX2  ! X66_AALT

      590    14785
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:110  
      591    14786    1   CANT_READ_HLP:
      592    14787    1   CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP, PROJECT_FLG ) ;

  14787  3 001225   000021 630400 4     CANT_READ_H* EPPR0   17
         3 001226   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001227   000000 701000 xent               TSX1    ASA$ERROR
         3 001230   000000 011000                    NOP     0

      593    14788
      594    14789
      595    14790    1   NONE:
      596    14791    1   ALTRETURN ;

  14791  3 001231   000000 702200 xent  NONE         TSX2  ! X66_AALT
      597    14792
      598    14793    1   END ASB$GET ;
      599    14794        %EOD ;

PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:111  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$GET.
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:112  

 **** Variables and constants ****

  ****  Section 001  Data  ASB$GET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/b BIT         r     1 FIRST_TIME                 4-0-0/c STRC(378)   r     1 LAST_KEY
     0-0-0/b BIT         r     1 PROJECT_FLG                1-0-0/b BIT         r     1 PROJ_ADMIN_FLG
     3-0-0/w UBIN        r     1 TYPE

  ****  Section 002 RoData ASB$GET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 SIZEC_DREC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @DREC1$                   10-0-0/w PTR         r     1 @DREC2$
     3-0-0/w PTR         r     1 @PROJ_FLAG                 4-0-0/w PTR         r     1 @P_CODE
     5-0-0/w PTR         r     1 @USERS_REC1                7-0-0/w PTR         r     1 @USERS_REC2
    14-0-0/c CHAR(8)     r     1 ACCT                      30-0-0/w UBIN        r     1 ACCT_LEN
    13-0-0/w SBIN        r     1 ARS_TEMP                  *0-0-0/w PTR         r     1 DREC1$
    *0-0-0/w PTR         r     1 DREC2$                    11-0-0/w SBIN        r     1 I
    12-0-0/w SBIN        r     1 J                         21-0-0/w UBIN        r     1 LEN
    31-0-0/w UBIN        r     1 MATCH_LEN                 16-0-0/c CHAR(12)    r     1 NAME
    32-0-0/w UBIN        r     1 NAME_LEN                  *0-0-0/w BIT         r     1 PROJ_FLAG
    *0-0-0/w UBIN        r     1 P_CODE                    22-0-0/c STRC(189)   r     1 TEMP_KEY
    33-0-0/w STRC(18576) r     1 TEMP_USERS                *0-0-0/w STRC(18576) r     1 USERS_REC1
    *0-0-0/w STRC(18576) r     1 USERS_REC2

  ****  SYMREF variables  ****
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:113  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)     r     1 AS_ACCT_MATCH              0-0-0/c CHAR        r     1 AS_BLANK
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/c CHAR(12)    r     1 AS_NAME_MATCH
     0-0-0/c STRC(189)   r     1 AS_NONE                    0-0-0/w STRC(18576) r     1 AS_PROJECT
     0-0-0/c STRC(189)   r     1 AS_PROJECT_ADMIN           0-0-0/w STRC(18576) r     1 AS_PROJECT_DFLT
     0-0-0/w PTR         r     1 AS_PROJECT_DFLT_DREC$
     0-0-0/w PTR         r     1 AS_PROJECT_DREC$           0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w STRC(18576) r     1 AS_USERS                   0-0-0/b BIT         r     1 ENQDEQ_FLG
     0-0-0/w STRC(6084)  r     1 KL_DREC                    0-0-0/w PTR         r     1 KL_DREC$
     0-0-0/w STRC(576)   r     1 KL_DREC_CNT                0-0-0/c STRC(378)   r     1 USERS_KEY


   Procedure ASB$GET requires 666 words for executable code.
   Procedure ASB$GET requires 548 words of local(AUTO) storage.
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:114  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:115  
          MINI XREF LISTING

ACCT
     14297**DCL     14693<<ASSIGN  14695>>CALLBLT 14699<>CALL    14717<<ASSIGN  14719>>CALLBLT 14723<>CALL
     14768>>IF
ACCT_LEN
     14303**DCL     14695<<CALLBLT 14696>>IF      14696<<ASSIGN  14699<>CALL    14719<<CALLBLT 14720>>IF
     14720<<ASSIGN  14723<>CALL
ARS_TEMP
     14296**DCL     14530<<ASSIGN  14532<>CALL    14577<<ASSIGN  14578<>CALL    14705<<ASSIGN  14706<>CALL
     14738<<ASSIGN  14739<>CALL    14750<<ASSIGN  14751<>CALL    14759<<ASSIGN  14760<>CALL
ASA$ERROR
     14514**DCL-ENT 14561--CALL    14590--CALL    14596--CALL    14736--CALL    14741--CALL    14747--CALL
     14753--CALL    14783--CALL    14787--CALL
ASA_BRKS_LOC
     11054**DCL     11054--REDEF
ASB$DEQ
     14511**DCL-ENT 14548--CALL    14562--CALL    14580--CALL    14583--CALL    14588--CALL    14589--CALL
     14594--CALL    14595--CALL
ASB$ENQ
     14508**DCL-ENT 14527--CALL    14573--CALL
ASB$PREC_AND_SKIP_USERS
     14505**DCL-ENT 14677--CALL    14682--CALL
ASB$PREC_USERS
     14502**DCL-ENT 14669--CALL    14674--CALL
ASB$READ_HLP
     14493**DCL-ENT 14532--CALL    14578--CALL    14706--CALL    14739--CALL    14751--CALL    14760--CALL
ASB$READ_USERS
     14490**DCL-ENT 14529--CALL    14557--CALL    14574--CALL    14734--CALL    14745--CALL    14758--CALL
ASB$READ_USERS_SEQ
     14496**DCL-ENT 14689--CALL
ASB$WILD_MATCH
     14499**DCL-ENT 14699--CALL    14704--CALL    14723--CALL    14728--CALL
AS_ACCT_MATCH
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:116  
     11059**DCL     14616>>CALLBLT 14623>>ASSIGN  14641>>CALLBLT 14649>>ASSIGN  14697>>CALLBLT 14699<>CALL
     14721>>CALLBLT 14723<>CALL    14766>>CALLBLT 14768>>IF      14772--IF
AS_BLANK
     10914**DCL     14620>>ASSIGN  14645>>ASSIGN  14729>>CALLBLT
AS_DEFAULT.BANNER_PERM
     11747**DCL     11748--REDEF
AS_DEFAULT.BUDGET.MACCT
     11652**DCL     11656--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11665**DCL     11668--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11648**DCL     11650--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11643**DCL     11645--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11763**DCL     11764--REDEF   11765--REDEF
AS_DEFAULT_DREC.PASSWORD
     13017**DCL     13021--REDEF
AS_DEFAULT_DREC.RENAME
     13040**DCL     13041--REDEF
AS_DFLT.BANNER_PERM
     11569**DCL     11570--REDEF
AS_DFLT.BUDGET.MACCT
     11474**DCL     11478--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11487**DCL     11490--REDEF
AS_DFLT.BUDGET.PACCUM
     11470**DCL     11472--REDEF
AS_DFLT.BUDGET.PMAXC
     11465**DCL     11467--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11585**DCL     11586--REDEF   11587--REDEF
AS_FALSE
     10914**DCL     14668>>ASSIGN
AS_FE_MODE
     10920**DCL     10921--REDEF
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:117  
AS_MODE
     10917**DCL     10919--REDEF
AS_MOD_USER.ACCESS
     13782**DCL     13783--REDEF
AS_MOD_USER.BANNER
     13769**DCL     13770--REDEF
AS_MOD_USER.BANNER_PERM
     13771**DCL     13772--REDEF
AS_MOD_USER.BILL
     13777**DCL     13778--REDEF
AS_MOD_USER.CPROC
     13773**DCL     13774--REDEF
AS_MOD_USER.FEBILL
     13853**DCL     13854--REDEF
AS_MOD_USER.FECXTMEM
     13870**DCL     13871--REDEF
AS_MOD_USER.FEMINTS
     13855**DCL     13856--REDEF
AS_MOD_USER.FEMMEM
     13866**DCL     13867--REDEF
AS_MOD_USER.FEMTIME
     13864**DCL     13865--REDEF
AS_MOD_USER.FEPPRIV
     13861**DCL     13863--REDEF
AS_MOD_USER.FEPRIV
     13858**DCL     13860--REDEF
AS_MOD_USER.FORCE_BIT
     13767**DCL     13768--REDEF
AS_MOD_USER.KEY
     13849**DCL     13851--REDEF
AS_MOD_USER.LASTCPROC
     13775**DCL     13776--REDEF
AS_MOD_USER.LIMITS.DO_
     13823**DCL     13824--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13839**DCL     13840--REDEF
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:118  
AS_MOD_USER.LIMITS.LO
     13819**DCL     13820--REDEF
AS_MOD_USER.LIMITS.MEM
     13815**DCL     13816--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13843**DCL     13844--REDEF
AS_MOD_USER.LIMITS.PDIS
     13831**DCL     13832--REDEF
AS_MOD_USER.LIMITS.PO
     13827**DCL     13828--REDEF
AS_MOD_USER.LIMITS.TDIS
     13835**DCL     13836--REDEF
AS_MOD_USER.LIMITS.TIME
     13811**DCL     13812--REDEF
AS_MOD_USER.MAXENQ
     13792**DCL     13793--REDEF
AS_MOD_USER.PERM_BIT
     13765**DCL     13766--REDEF
AS_MOD_USER.PPRIV
     13787**DCL     13789--REDEF
AS_MOD_USER.PRIOB
     13794**DCL     13795--REDEF
AS_MOD_USER.PRIV
     13784**DCL     13786--REDEF
AS_MOD_USER.QUAN
     13790**DCL     13791--REDEF
AS_MOD_USER.SETUP
     13763**DCL     13764--REDEF
AS_NAME_MATCH
     11059**DCL     14626>>CALLBLT 14628>>CALLBLT 14632>>CALLBLT 14633>>CALLBLT 14642>>CALLBLT 14653>>CALLBLT
     14702>>CALLBLT 14704<>CALL    14726>>CALLBLT 14728<>CALL    14771>>CALLBLT 14774>>IF
AS_NONE
     10915**DCL     14538>>IF      14554>>DOWHILE 14560>>IF      14604>>ASSIGN
AS_PROJECT
     11988**DCL     14734<>CALL
AS_PROJECT.BANNER_PERM
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:119  
     12103**DCL     12104--REDEF
AS_PROJECT.BUDGET.MACCT
     12008**DCL     12012--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12021**DCL     12024--REDEF
AS_PROJECT.BUDGET.PACCUM
     12004**DCL     12006--REDEF
AS_PROJECT.BUDGET.PMAXC
     11999**DCL     12001--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12119**DCL     12120--REDEF   12121--REDEF
AS_PROJECT_ADMIN
     11058**DCL     14538>>IF      14554>>DOWHILE 14604>>ASSIGN
AS_PROJECT_ADMIN.TEXT
     11058**DCL     14541>>IF      14546>>IF      14640>>ASSIGN  14713>>IF
AS_PROJECT_DFLT
     12166**DCL     14745<>CALL
AS_PROJECT_DFLT.BANNER_PERM
     12281**DCL     12282--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12186**DCL     12190--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12199**DCL     12202--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12182**DCL     12184--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12177**DCL     12179--REDEF   14749>>IF      14749<<ASSIGN
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12297**DCL     12298--REDEF   12299--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13503**DCL     13507--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13526**DCL     13527--REDEF
AS_PROJECT_DFLT_DREC$
     10924**DCL     14751<>CALL
AS_PROJECT_DREC.PASSWORD
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:120  
     13341**DCL     13345--REDEF
AS_PROJECT_DREC.RENAME
     13364**DCL     13365--REDEF
AS_PROJECT_DREC$
     10923**DCL     14739<>CALL
AS_PROJ_ADMIN.BANNER_PERM
     11925**DCL     11926--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11830**DCL     11834--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11843**DCL     11846--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11826**DCL     11828--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11821**DCL     11823--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     11941**DCL     11942--REDEF   11943--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13179**DCL     13183--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13202**DCL     13203--REDEF
AS_TRUE
     10914**DCL     14528>>ASSIGN  14606>>ASSIGN
AS_USERS
     11276**DCL     14689<>CALL    14758<>CALL
AS_USERS.BANNER_PERM
     11391**DCL     11392--REDEF
AS_USERS.BUDGET.MACCT
     11296**DCL     11300--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11309**DCL     11312--REDEF
AS_USERS.BUDGET.PACCUM
     11292**DCL     11294--REDEF
AS_USERS.BUDGET.PMAXC
     11287**DCL     11289--REDEF
AS_USERS.SETUP_CHRA.TXT
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:121  
     11407**DCL     11408--REDEF   11409--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12459**DCL     12460--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12364**DCL     12368--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12377**DCL     12380--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12360**DCL     12362--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12355**DCL     12357--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12475**DCL     12476--REDEF   12477--REDEF
CANT_READ_HLP
     14787**LABEL   14706--CALLALT 14760--CALLALT
CANT_READ_USERS
     14783**LABEL   14758--CALLALT
CHECK_IN_PROJ
     14546**LABEL   14543--GOTO
DREC1$
     14091**DCL         6--PROC    14531--IF      14532<>CALL
DREC2$
     14270**DCL         6--PROC    14576--IF      14578<>CALL
ENQDEQ_FLG
     11057**DCL     14528<<ASSIGN
ENQ_ERR
     14598**LABEL   14527--CALLALT 14573--CALLALT
ERR_CODE
     11049**DCL     11050--REDEF
FAILED
     14765**LABEL   14699--CALLALT 14704--CALLALT 14723--CALLALT 14728--CALLALT
FIRST_TIME
     14278**DCL     14606<<ASSIGN  14667>>IF      14668<<ASSIGN
HLP_DOESNT_EXIST
     14594**LABEL   14532--CALLALT 14578--CALLALT
I
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:122  
     14294**DCL     14616<<CALLBLT 14617>>IF      14623>>ASSIGN  14624>>ASSIGN  14641<<CALLBLT 14643>>IF
     14649>>ASSIGN  14650>>ASSIGN  14651>>IF      14729<<CALLBLT 14730>>ASSIGN
J
     14295**DCL     14626<<CALLBLT 14628>>CALLBLT 14629>>ASSIGN  14632<<CALLBLT 14633>>CALLBLT 14634>>ASSIGN
     14642<<CALLBLT 14651>>IF      14653>>CALLBLT 14655>>ASSIGN
KL_DEFAULT.PASSWORD
     13665**DCL     13669--REDEF
KL_DEFAULT.RENAME
     13688**DCL     13689--REDEF
KL_DFLT.PASSWORD
     12855**DCL     12859--REDEF
KL_DFLT.RENAME
     12878**DCL     12879--REDEF
KL_DREC.KL_DREC_FEBLK
     12751**DCL     14530--ASSIGN  14577--ASSIGN  14705--ASSIGN  14738--ASSIGN  14750--ASSIGN  14759--ASSIGN
KL_DREC.PASSWORD
     12693**DCL     12697--REDEF
KL_DREC.RENAME
     12716**DCL     12717--REDEF
KL_DREC$
     10922**DCL     14706<>CALL    14760<>CALL
KL_DREC_CNT
     12522**DCL     14280--DCLINIT
KL_DREC_CNT.PASSWORD
     12580**DCL     12584--REDEF
KL_DREC_CNT.RENAME
     12603**DCL     12604--REDEF
LAST_KEY
     14281**DCL     14666>>ASSIGN  14676>>IF      14707<<ASSIGN  14716<<ASSIGN  14755>>ASSIGN
LAST_KEY.COUNT
     14282**DCL     14612<<ASSIGN  14619<<ASSIGN  14624<<ASSIGN  14629<<ASSIGN  14634<<ASSIGN  14646<<ASSIGN
     14650<<ASSIGN  14655<<ASSIGN
LAST_KEY.SKEY.CREATOR
     14286**DCL     14640<<ASSIGN
LAST_KEY.SKEY.PROJ
     14285**DCL     14613<<ASSIGN  14639<<ASSIGN
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:123  
LAST_KEY.SKEY.USER
     14287**DCL     14645<<ASSIGN  14649<<ASSIGN  14653<<CALLBLT 14731>>ASSIGN
LAST_KEY.TXTC
     14283**DCL     14284--REDEF   14620<<ASSIGN  14623<<ASSIGN  14628<<CALLBLT 14633<<CALLBLT
LEN
     14299**DCL     14766<<CALLBLT 14767>>IF      14768>>IF      14768>>IF      14772>>IF
MATCH_LEN
     14304**DCL     14697<<CALLBLT 14698>>IF      14698<<ASSIGN  14699<>CALL    14702<<CALLBLT 14703>>IF
     14703<<ASSIGN  14704<>CALL    14721<<CALLBLT 14722>>IF      14722<<ASSIGN  14723<>CALL    14726<<CALLBLT
     14727>>IF      14727<<ASSIGN  14728<>CALL
NAME
     14298**DCL     14694<<ASSIGN  14700>>CALLBLT 14704<>CALL    14718<<ASSIGN  14724>>CALLBLT 14728<>CALL
     14774>>IF
NAME_LEN
     14305**DCL     14700<<CALLBLT 14701>>IF      14701<<ASSIGN  14704<>CALL    14724<<CALLBLT 14725>>IF
     14725<<ASSIGN  14728<>CALL    14771<<CALLBLT 14772>>IF      14774>>IF      14774>>IF
NONE
     14791**LABEL   14689--CALLALT
PROJECT_FLG
     14276**DCL     14603<<ASSIGN  14639>>ASSIGN  14690>>IF      14712>>IF      14732>>IF      14736<>CALL
     14741<>CALL    14747<>CALL    14753<>CALL    14765>>IF      14783<>CALL    14787<>CALL
PROJ_ADMIN_FLG
     14277**DCL     14604<<ASSIGN  14608>>IF      14690>>IF      14713>>IF      14765>>IF
PROJ_FLAG
     13911**DCL         6--PROC    14561<>CALL    14570>>IF      14590<>CALL    14596<>CALL    14601--ENTRY
     14603>>ASSIGN  14610>>IF
PROJ_KEY.TEXT
     10927**DCL     10927--REDEF
PROJ_KEY.TXT.PROJECT
     10927**DCL     10927--REDEF
P_CODE
     13912**DCL         6--PROC    14537--IF      14539>>DOSELCT 14601--ENTRY   14605>>ASSIGN
READ_NEXT
     14689**LABEL   14692--GOTO    14765--GOTO
REMEM_VAR
     11053**DCL     11053--REDEF
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:124  
REM_FCMD
     11053**DCL     11054--REDEF
SIZEC_DREC
     14280**DCL     14530>>ASSIGN  14577>>ASSIGN  14705>>ASSIGN  14738>>ASSIGN  14750>>ASSIGN  14759>>ASSIGN
TEMP_KEY
     14300**DCL     14552<<ASSIGN  14559>>ASSIGN
TEMP_USERS
     14319**DCL     14553<<ASSIGN  14557<>CALL
TEMP_USERS.BANNER_PERM
     14434**DCL     14435--REDEF
TEMP_USERS.BUDGET.MACCT
     14339**DCL     14343--REDEF   14554>>DOWHILE 14554>>DOWHILE 14556>>ASSIGN  14560>>IF
TEMP_USERS.BUDGET.MAX_PROJECTS
     14352**DCL     14355--REDEF
TEMP_USERS.BUDGET.PACCUM
     14335**DCL     14337--REDEF
TEMP_USERS.BUDGET.PMAXC
     14330**DCL     14332--REDEF
TEMP_USERS.SETUP_CHRA.TXT
     14450**DCL     14451--REDEF   14452--REDEF
TYPE
     14279**DCL     14605<<ASSIGN  14672>>DOSELCT 14755>>IF
USERS_DOESNT_EXIST
     14588**LABEL   14529--CALLALT 14557--CALLALT 14574--CALLALT
USERS_KEY
     10924**DCL     14552>>ASSIGN  14556<<ASSIGN  14559<<ASSIGN  14561<>CALL    14590<>CALL    14596<>CALL
     14666<<ASSIGN  14676>>IF      14707>>ASSIGN  14716>>ASSIGN  14736<>CALL    14741<>CALL    14747<>CALL
     14753<>CALL    14755<<ASSIGN  14783<>CALL    14787<>CALL
USERS_KEY.COUNT
     10924**DCL     14541>>IF      14571<<ASSIGN  14692>>IF      14694>>ASSIGN  14711>>IF      14730<<ASSIGN
     14743<<ASSIGN
USERS_KEY.SKEY.CREATOR
     10926**DCL     14713>>IF
USERS_KEY.SKEY.PROJ
     10926**DCL     14712>>IF
USERS_KEY.SKEY.USER
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:125  
     10926**DCL     14717>>ASSIGN  14718>>ASSIGN  14729>>CALLBLT
USERS_KEY.TEXT
     10924**DCL     10925--REDEF   10925--REDEF   10925--REDEF   10926--REDEF
USERS_KEY.TXTC
     10925**DCL     14541>>IF      14693>>ASSIGN  14694>>ASSIGN  14731<<ASSIGN
USERS_KEY.UKEY.S
     10926**DCL     14572<<ASSIGN  14744<<ASSIGN
USERS_REC1
     13926**DCL         6--PROC    14529<>CALL    14553>>ASSIGN
USERS_REC1.BANNER_PERM
     14041**DCL     14042--REDEF
USERS_REC1.BUDGET.MACCT
     13946**DCL     13950--REDEF
USERS_REC1.BUDGET.MACCT_.TEXT
     13952**DCL     14546>>IF
USERS_REC1.BUDGET.MAX_PROJECTS
     13959**DCL     13962--REDEF
USERS_REC1.BUDGET.PACCUM
     13942**DCL     13944--REDEF
USERS_REC1.BUDGET.PMAXC
     13937**DCL     13939--REDEF
USERS_REC1.SETUP_CHRA.TXT
     14057**DCL     14058--REDEF   14059--REDEF
USERS_REC2
     14105**DCL         6--PROC    14574<>CALL
USERS_REC2.BANNER_PERM
     14220**DCL     14221--REDEF
USERS_REC2.BUDGET.MACCT
     14125**DCL     14129--REDEF
USERS_REC2.BUDGET.MAX_PROJECTS
     14138**DCL     14141--REDEF
USERS_REC2.BUDGET.PACCUM
     14121**DCL     14123--REDEF
USERS_REC2.BUDGET.PMAXC
     14116**DCL     14118--REDEF   14575>>IF      14575<<ASSIGN
USERS_REC2.SETUP_CHRA.TXT
PL6.E3A0      #003=ASB$GET File=ASB$SEARCH.:E05TSI                               TUE 07/29/97 09:29 Page:126  
     14236**DCL     14237--REDEF   14238--REDEF

PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:127  
      600        1        /*T***********************************************************/
      601        2        /*T*                                                         */
      602        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      603        4        /*T*                                                         */
      604        5        /*T***********************************************************/
      605        6        ASB$ACCT_OK: PROC( ACCT, PACKSET, KEY, HSET_OPT, P_PROJ_REC$ ) ALTRET;
      606        7
      607        8        %INCLUDE           AS_ENTRIES_M   ;
      608     1058        %INCLUDE           AS_SUPER_C     ;
      609     1493        %INCLUDE           AS_PERR_C      ;
      610     2095        %INCLUDE           AS_SUBS_C      ;
      611     3509        %INCLUDE           AS_MAC_C       ;
      612     3589        %INCLUDE           KL_SUPER_C     ;
      613     6491        %INCLUDE           XU_MACRO_C     ;
      614     9597        %INCLUDE           XU_FORMAT_C    ;
      615     9759        %INCLUDE           AS_SUPER_R     ;
      616    12775
      617    12776    1   DCL ACCT     CHAR(8);
      618    12777    1   DCL PACKSET  CHAR(6);
      619    12778    1   DCL 1 KEY,
      620    12779    1          2 CNT UBIN BYTE UNAL,
      621    12780    1          2 TXT CHAR(20)   UNAL;
      622    12781    1   DCL HSET_OPT BIT(1) ALIGNED;
      623    12782    1   DCL P_PROJ_REC$ PTR;
      624    12783
      625    12784    1   DCL PROJ_REC$ PTR;
      626    12785    1   DCL SKELETON CHAR(8);
      627    12786    1   DCL I SBIN;
      628    12787    1   DCL ACCT_LEN     UBIN;
      629    12788    1   DCL SKEL_LEN     UBIN;
      630    12789
      631    12790        %AS$PROJ_HEADER( STCLASS="BASED(PROJ_REC$)" );
      632    12819
      633    12820        %ASB$READ_PROJ ;
      634    12823        %ASB$WILD_MATCH ;
      635    12826        %ASH$ERROR ;
      636    12829        %ASH$INFO ;
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:128  
      637    12832        %ASA$KEYCONV ;
      638    12835
      639    12836
      640    12837
      641    12838    1   IF ADDR(P_PROJ_REC$) ~= ADDR(NIL)
      642    12839    1   THEN PROJ_REC$ = P_PROJ_REC$;
      643    12840    2   ELSE DO;                /* Have to read the :PROJ record */
      644    12841    2      PROJ_REC$ = AS_PROJ_HEADER$;
      645    12842    2      PROJ_KEY.TXT.PROJECT = KEY.TXT;
      646    12843    2      PROJ_KEY.TXT.PACKSET = PACKSET;
      647    12844    2      CALL INDEX( I, AS_BLANK, PROJ_KEY.TEXT, 20 );
      648    12845    2      PROJ_KEY.COUNT = I;
      649    12846    2      I = SIZEC( AS$PROJ_HEADER );
      650    12847    2      CALL ASB$READ_PROJ( PROJ_REC$, I ) ALTRET( READ_PROJ_ERR );
      651    12848    2      END;
      652    12849    1   SKELETON = AS$PROJ_HEADER.SKELETON;
      653    12850    1   CALL INDEX (ACCT_LEN, ' ', ACCT);
      654    12851    1   IF ACCT_LEN = 0 THEN ACCT_LEN = 1;
      655    12852    1   CALL INDEX (SKEL_LEN, ' ', SKELETON);
      656    12853    1   IF SKEL_LEN = 0 THEN SKEL_LEN = 1;
      657    12854    1   CALL ASB$WILD_MATCH( ACCT_LEN, ACCT, SKEL_LEN, SKELETON ) ALTRET( NO_MATCH );
      658    12855    1   RETURN;
      659    12856
      660    12857
      661    12858    1   NO_MATCH:;
      662    12859    1   CALL INDEX( I, AS_BLANK, ACCT );
      663    12860    1   AS_FIELD1.COUNT = I;
      664    12861    1   AS_FIELD1.TEXT  = ACCT;
      665    12862    1   AS_FIELD2.COUNT = PROJ_KEY.COUNT - 20;
      666    12863    1   AS_FIELD2.TEXT  = PACKSET;
      667    12864    1   CALL INDEX( I, AS_BLANK, SKELETON );
      668    12865    1   AS_FIELD3.COUNT = I;
      669    12866    1   AS_FIELD3.TEXT  = SKELETON;
      670    12867    2   IF ADDR(HSET_OPT) ~= ADDR(NIL) THEN DO;
      671    12868    3      IF HSET_OPT THEN DO;
      672    12869        /*E* ERROR:   ASB-E$HSET_IGNORED-C
      673    12870             MESSAGE: HSET option ignored.
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:129  
      674    12871        */
      675    12872              %SCREAM( ERR#=E$HSET_IGNORED, MID='B', LEVEL=INFO );
      676    12887    3         END;
      677    12888    2      ELSE
      678    12889    3         IF AS_CR_MOD_PROJ = %CR_PROJ_USER THEN DO;
      679    12890        /*E* ERROR:   ASB-E$USER_NOT_CREATED-C
      680    12891             MESSAGE: User not created.
      681    12892        */
      682    12893                 %SCREAM( ERR#=E$USER_NOT_CREATED, MID='B', LEVEL=INFO );
      683    12908    3            END;
      684    12909    3         ELSE DO;
      685    12910        /*E* ERROR:   ASB-E$PROJECT_NOT_CREATED-C
      686    12911             MESSAGE: Project not created.
      687    12912        */
      688    12913                 %SCREAM( ERR#=E$PROJECT_NOT_CREATED, MID='B', LEVEL=INFO );
      689    12928    3            END;
      690    12929        /*E* ERROR:   ASB-E$BAD_ACCT_NAME1-C
      691    12930        MESSAGE: "%U1" is inconsistent with the account skeleton( "%U3" ) for
      692    12931        */
      693    12932        /*E* ERROR:   ASB-E$BAD_ACCT_NAME2-C
      694    12933        MESSAGE: project "%U1" packset DP#%U2.
      695    12934        MESSAGE1: Project %U1 requires that all users with home packset DP#%U2
      696    12935                  must have an account of the form, "%U3".
      697    12936        */
      698    12937           %SCREAM( ERR#=E$BAD_ACCT_NAME1, MID='B', LEVEL=INFO );
      699    12952    2      CALL ASA$KEYCONV( KEY, AS_FIELD1 );
      700    12953           %SCREAM( ERR#=E$BAD_ACCT_NAME2, MID='B', LEVEL=ERROR );
      701    12968    2      END;
      702    12969    2   ELSE DO;
      703    12970        /*E* ERROR:   ASA-E$BAD_ACCT_NAME3-C
      704    12971        MESSAGE: project %U1 packset DP#%U2.
      705    12972        MESSAGE1: Project %U1 requires that all accounts on packset DP#%U2
      706    12973                  must be of the form, "%U3".
      707    12974        */
      708    12975           %SCREAM( ERR#=E$BAD_ACCT_NAME1, LEVEL=INFO, MID='B' );
      709    12990    2      CALL ASA$KEYCONV( KEY, AS_FIELD1 );
      710    12991           %SCREAM( ERR#=E$BAD_ACCT_NAME3, LEVEL=ERROR, MID='B' );
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:130  
      711    13006    2      END;
      712    13007    1   ALTRETURN;
      713    13008
      714    13009        /*E* ERROR: ASB-E$UNABLE_TO_READ_PROJ-C
      715    13010        MESSAGE: Unable to read the record "%U1" from the :PROJ file.
      716    13011        */
      717    13012    1   READ_PROJ_ERR:
      718    13013    1   CALL ASH$ERROR( ERR_CODE );
      719    13014    1   AS_FIELD1 = PROJ_KEY;
      720    13015        %SCREAM(ERR#=E$UNABLE_TO_READ_PROJ,MID='B',LEVEL=INFO);
      721    13030    1   ALTRETURN;
      722    13031
      723    13032    1   END ASB$ACCT_OK;
      724    13033        %EOD;

PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:131  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$ACCT_OK.

   Procedure ASB$ACCT_OK requires 169 words for executable code.
   Procedure ASB$ACCT_OK requires 18 words of local(AUTO) storage.

PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:132  

 Object Unit name= ASB$ACCT_OK                                File name= ASB$SEARCH.:E05TOU
 UTS= JUL 29 '97 09:32:01.64 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      7      7  ASB$ACCT_OK
    2   Proc  even  none   169    251  ASB$ACCT_OK
    3  RoData even  none     9     11  ASB$ACCT_OK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        5  ASB$ACCT_OK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       3 ASB$READ_PROJ
 yes     yes           Std       4 ASB$WILD_MATCH
         yes           Std       2 ASH$INFO
         yes           Std       2 ASA$KEYCONV
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:133  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  PROJ_KEY                              ERR_CODE
     AS_FIELD1                             AS_FIELD2                             AS_FIELD3
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     AS_PROJ_HEADER$                       AS_CR_MOD_PROJ                        B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:134  


      600        1        /*T***********************************************************/
      601        2        /*T*                                                         */
      602        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      603        4        /*T*                                                         */
      604        5        /*T***********************************************************/
      605        6        ASB$ACCT_OK: PROC( ACCT, PACKSET, KEY, HSET_OPT, P_PROJ_REC$ ) ALTRET;

      6  2 000000   000000 700200 xent  ASB$ACCT_OK  TSX0  ! X66_AUTO_5
         2 000001   000022 000005                    ZERO    18,5

      606        7
      607        8        %INCLUDE           AS_ENTRIES_M   ;
      608     1058        %INCLUDE           AS_SUPER_C     ;
      609     1493        %INCLUDE           AS_PERR_C      ;
      610     2095        %INCLUDE           AS_SUBS_C      ;
      611     3509        %INCLUDE           AS_MAC_C       ;
      612     3589        %INCLUDE           KL_SUPER_C     ;
      613     6491        %INCLUDE           XU_MACRO_C     ;
      614     9597        %INCLUDE           XU_FORMAT_C    ;
      615     9759        %INCLUDE           AS_SUPER_R     ;
      616    12775
      617    12776    1   DCL ACCT     CHAR(8);
      618    12777    1   DCL PACKSET  CHAR(6);
      619    12778    1   DCL 1 KEY,
      620    12779    1          2 CNT UBIN BYTE UNAL,
      621    12780    1          2 TXT CHAR(20)   UNAL;
      622    12781    1   DCL HSET_OPT BIT(1) ALIGNED;
      623    12782    1   DCL P_PROJ_REC$ PTR;
      624    12783
      625    12784    1   DCL PROJ_REC$ PTR;
      626    12785    1   DCL SKELETON CHAR(8);
      627    12786    1   DCL I SBIN;
      628    12787    1   DCL ACCT_LEN     UBIN;
      629    12788    1   DCL SKEL_LEN     UBIN;
      630    12789
      631    12790        %AS$PROJ_HEADER( STCLASS="BASED(PROJ_REC$)" );
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:135  
      632    12819
      633    12820        %ASB$READ_PROJ ;
      634    12823        %ASB$WILD_MATCH ;
      635    12826        %ASH$ERROR ;
      636    12829        %ASH$INFO ;
      637    12832        %ASA$KEYCONV ;
      638    12835
      639    12836
      640    12837
      641    12838    1   IF ADDR(P_PROJ_REC$) ~= ADDR(NIL)

  12838  2 000002   200007 236100                    LDQ     @P_PROJ_REC$,,AUTO
         2 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000004   000011 600000 2                  TZE     s:12841

      642    12839    1   THEN PROJ_REC$ = P_PROJ_REC$;

  12839  2 000005   200007 470500                    LDP0    @P_PROJ_REC$,,AUTO
         2 000006   000000 236100                    LDQ     0,,PR0
         2 000007   200010 756100                    STQ     PROJ_REC$,,AUTO
         2 000010   000046 710000 2                  TRA     s:12849

      643    12840    2   ELSE DO;                /* Have to read the :PROJ record */

      644    12841    2      PROJ_REC$ = AS_PROJ_HEADER$;

  12841  2 000011   000000 236000 xsym               LDQ     AS_PROJ_HEADER$
         2 000012   200010 756100                    STQ     PROJ_REC$,,AUTO

      645    12842    2      PROJ_KEY.TXT.PROJECT = KEY.TXT;

  12842  2 000013   200005 470500                    LDP0    @KEY,,AUTO
         2 000014   040000 100500                    MLR     fill='040'O
         2 000015   000000 200024                    ADSC9   0,,PR0                   cn=1,n=20
         2 000016   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

      646    12843    2      PROJ_KEY.TXT.PACKSET = PACKSET;
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:136  

  12843  2 000017   200004 471500                    LDP1    @PACKSET,,AUTO
         2 000020   040000 100500                    MLR     fill='040'O
         2 000021   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         2 000022   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

      647    12844    2      CALL INDEX( I, AS_BLANK, PROJ_KEY.TEXT, 20 );

  12844  2 000023   000000 124400                    SCM     mask='000'O
         2 000024   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         2 000025   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000026   200013 000100                    ARG     I,,AUTO
         2 000027   000024 236007                    LDQ     20,DL
         2 000030   200013 056100                    ASQ     I,,AUTO

      648    12845    2      PROJ_KEY.COUNT = I;

  12845  2 000031   200013 236100                    LDQ     I,,AUTO
         2 000032   000033 736000                    QLS     27
         2 000033   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      649    12846    2      I = SIZEC( AS$PROJ_HEADER );

  12846  2 000034   000060 235007                    LDA     48,DL
         2 000035   200013 755100                    STA     I,,AUTO

      650    12847    2      CALL ASB$READ_PROJ( PROJ_REC$, I ) ALTRET( READ_PROJ_ERR );

  12847  2 000036   200013 633500                    EPPR3   I,,AUTO
         2 000037   200017 453500                    STP3    SKEL_LEN+2,,AUTO
         2 000040   200010 634500                    EPPR4   PROJ_REC$,,AUTO
         2 000041   200016 454500                    STP4    SKEL_LEN+1,,AUTO
         2 000042   200016 630500                    EPPR0   SKEL_LEN+1,,AUTO
         2 000043   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000044   000000 701000 xent               TSX1    ASB$READ_PROJ
         2 000045   000235 702000 2                  TSX2    READ_PROJ_ERR

PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:137  
      651    12848    2      END;

      652    12849    1   SKELETON = AS$PROJ_HEADER.SKELETON;

  12849  2 000046   200010 470500                    LDP0    PROJ_REC$,,AUTO
         2 000047   040100 100500                    MLR     fill='040'O
         2 000050   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         2 000051   200011 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8

      653    12850    1   CALL INDEX (ACCT_LEN, ' ', ACCT);

  12850  2 000052   200003 471500                    LDP1    @ACCT,,AUTO
         2 000053   000000 124500                    SCM     mask='000'O
         2 000054   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         2 000055   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000056   200014 000100                    ARG     ACCT_LEN,,AUTO

      654    12851    1   IF ACCT_LEN = 0 THEN ACCT_LEN = 1;

  12851  2 000057   200014 235100                    LDA     ACCT_LEN,,AUTO
         2 000060   000063 601000 2                  TNZ     s:12852

  12851  2 000061   000001 236007                    LDQ     1,DL
         2 000062   200014 756100                    STQ     ACCT_LEN,,AUTO

      655    12852    1   CALL INDEX (SKEL_LEN, ' ', SKELETON);

  12852  2 000063   000000 124500                    SCM     mask='000'O
         2 000064   200011 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8
         2 000065   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000066   200015 000100                    ARG     SKEL_LEN,,AUTO

      656    12853    1   IF SKEL_LEN = 0 THEN SKEL_LEN = 1;

  12853  2 000067   200015 235100                    LDA     SKEL_LEN,,AUTO
         2 000070   000073 601000 2                  TNZ     s:12854

PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:138  
  12853  2 000071   000001 236007                    LDQ     1,DL
         2 000072   200015 756100                    STQ     SKEL_LEN,,AUTO

      657    12854    1   CALL ASB$WILD_MATCH( ACCT_LEN, ACCT, SKEL_LEN, SKELETON ) ALTRET( NO_MATCH );

  12854  2 000073   200011 633500                    EPPR3   SKELETON,,AUTO
         2 000074   200021 453500                    STP3    SKEL_LEN+4,,AUTO
         2 000075   200015 634500                    EPPR4   SKEL_LEN,,AUTO
         2 000076   200020 454500                    STP4    SKEL_LEN+3,,AUTO
         2 000077   200003 236100                    LDQ     @ACCT,,AUTO
         2 000100   200017 756100                    STQ     SKEL_LEN+2,,AUTO
         2 000101   200014 635500                    EPPR5   ACCT_LEN,,AUTO
         2 000102   200016 455500                    STP5    SKEL_LEN+1,,AUTO
         2 000103   200016 630500                    EPPR0   SKEL_LEN+1,,AUTO
         2 000104   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000105   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000106   000110 702000 2                  TSX2    NO_MATCH

      658    12855    1   RETURN;

  12855  2 000107   000000 702200 xent               TSX2  ! X66_ARET

  12853  2 000110                       NO_MATCH     null
      659    12856
      660    12857
      661    12858    1   NO_MATCH:;
      662    12859    1   CALL INDEX( I, AS_BLANK, ACCT );

  12859  2 000110   200003 470500                    LDP0    @ACCT,,AUTO
         2 000111   000000 124500                    SCM     mask='000'O
         2 000112   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         2 000113   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000114   200013 000100                    ARG     I,,AUTO

      663    12860    1   AS_FIELD1.COUNT = I;

  12860  2 000115   200013 236100                    LDQ     I,,AUTO
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:139  
         2 000116   000033 736000                    QLS     27
         2 000117   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      664    12861    1   AS_FIELD1.TEXT  = ACCT;

  12861  2 000120   040000 100500                    MLR     fill='040'O
         2 000121   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         2 000122   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      665    12862    1   AS_FIELD2.COUNT = PROJ_KEY.COUNT - 20;

  12862  2 000123   000000 236000 xsym               LDQ     PROJ_KEY
         2 000124   000033 772000                    QRL     27
         2 000125   000024 136007                    SBLQ    20,DL
         2 000126   000033 736000                    QLS     27
         2 000127   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      666    12863    1   AS_FIELD2.TEXT  = PACKSET;

  12863  2 000130   200004 471500                    LDP1    @PACKSET,,AUTO
         2 000131   040000 100500                    MLR     fill='040'O
         2 000132   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         2 000133   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      667    12864    1   CALL INDEX( I, AS_BLANK, SKELETON );

  12864  2 000134   000000 124500                    SCM     mask='000'O
         2 000135   200011 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8
         2 000136   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000137   200013 000100                    ARG     I,,AUTO

      668    12865    1   AS_FIELD3.COUNT = I;

  12865  2 000140   200013 236100                    LDQ     I,,AUTO
         2 000141   000033 736000                    QLS     27
         2 000142   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:140  
      669    12866    1   AS_FIELD3.TEXT  = SKELETON;

  12866  2 000143   040000 100500                    MLR     fill='040'O
         2 000144   200011 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8
         2 000145   000000 200050 xsym               ADSC9   AS_FIELD3                cn=1,n=40

      670    12867    2   IF ADDR(HSET_OPT) ~= ADDR(NIL) THEN DO;

  12867  2 000146   200006 236100                    LDQ     @HSET_OPT,,AUTO
         2 000147   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000150   000215 600000 2                  TZE     s:12983

      671    12868    3      IF HSET_OPT THEN DO;

  12868  2 000151   200006 473500                    LDP3    @HSET_OPT,,AUTO
         2 000152   300000 234100                    SZN     0,,PR3
         2 000153   000161 605000 2                  TPL     s:12889

      672    12869        /*E* ERROR:   ASB-E$HSET_IGNORED-C
      673    12870             MESSAGE: HSET option ignored.
      674    12871        */
      675    12872              %SCREAM( ERR#=E$HSET_IGNORED, MID='B', LEVEL=INFO );

  12880  2 000154   000000 630400 3                  EPPR0   0
         2 000155   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000156   000000 701000 xent               TSX1    ASH$INFO
         2 000157   000000 011000                    NOP     0

      676    12887    3         END;

  12887  2 000160   000175 710000 2                  TRA     s:12945

      677    12888    2      ELSE
      678    12889    3         IF AS_CR_MOD_PROJ = %CR_PROJ_USER THEN DO;

  12889  2 000161   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         2 000162   000001 115007                    CMPA    1,DL
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:141  
         2 000163   000171 601000 2                  TNZ     s:12921

      679    12890        /*E* ERROR:   ASB-E$USER_NOT_CREATED-C
      680    12891             MESSAGE: User not created.
      681    12892        */
      682    12893                 %SCREAM( ERR#=E$USER_NOT_CREATED, MID='B', LEVEL=INFO );

  12901  2 000164   000001 630400 3                  EPPR0   1
         2 000165   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000166   000000 701000 xent               TSX1    ASH$INFO
         2 000167   000000 011000                    NOP     0

      683    12908    3            END;

  12908  2 000170   000175 710000 2                  TRA     s:12945

      684    12909    3         ELSE DO;

      685    12910        /*E* ERROR:   ASB-E$PROJECT_NOT_CREATED-C
      686    12911             MESSAGE: Project not created.
      687    12912        */
      688    12913                 %SCREAM( ERR#=E$PROJECT_NOT_CREATED, MID='B', LEVEL=INFO );

  12921  2 000171   000002 630400 3                  EPPR0   2
         2 000172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000173   000000 701000 xent               TSX1    ASH$INFO
         2 000174   000000 011000                    NOP     0

      689    12928    3            END;

      690    12929        /*E* ERROR:   ASB-E$BAD_ACCT_NAME1-C
      691    12930        MESSAGE: "%U1" is inconsistent with the account skeleton( "%U3" ) for
      692    12931        */
      693    12932        /*E* ERROR:   ASB-E$BAD_ACCT_NAME2-C
      694    12933        MESSAGE: project "%U1" packset DP#%U2.
      695    12934        MESSAGE1: Project %U1 requires that all users with home packset DP#%U2
      696    12935                  must have an account of the form, "%U3".
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:142  
      697    12936        */
      698    12937           %SCREAM( ERR#=E$BAD_ACCT_NAME1, MID='B', LEVEL=INFO );

  12945  2 000175   000003 630400 3                  EPPR0   3
         2 000176   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000177   000000 701000 xent               TSX1    ASH$INFO
         2 000200   000000 011000                    NOP     0

      699    12952    2      CALL ASA$KEYCONV( KEY, AS_FIELD1 );

  12952  2 000201   000004 236000 3                  LDQ     4
         2 000202   200005 235100                    LDA     @KEY,,AUTO
         2 000203   200016 757100                    STAQ    SKEL_LEN+1,,AUTO
         2 000204   200016 630500                    EPPR0   SKEL_LEN+1,,AUTO
         2 000205   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000206   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000207   000000 011000                    NOP     0

      700    12953           %SCREAM( ERR#=E$BAD_ACCT_NAME2, MID='B', LEVEL=ERROR );

  12965  2 000210   000005 630400 3                  EPPR0   5
         2 000211   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000212   000000 701000 xent               TSX1    ASH$ERROR
         2 000213   000000 011000                    NOP     0

      701    12968    2      END;

  12968  2 000214   000234 710000 2                  TRA     s:13007

      702    12969    2   ELSE DO;

      703    12970        /*E* ERROR:   ASA-E$BAD_ACCT_NAME3-C
      704    12971        MESSAGE: project %U1 packset DP#%U2.
      705    12972        MESSAGE1: Project %U1 requires that all accounts on packset DP#%U2
      706    12973                  must be of the form, "%U3".
      707    12974        */
      708    12975           %SCREAM( ERR#=E$BAD_ACCT_NAME1, LEVEL=INFO, MID='B' );
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:143  

  12983  2 000215   000003 630400 3                  EPPR0   3
         2 000216   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000217   000000 701000 xent               TSX1    ASH$INFO
         2 000220   000000 011000                    NOP     0

      709    12990    2      CALL ASA$KEYCONV( KEY, AS_FIELD1 );

  12990  2 000221   000004 236000 3                  LDQ     4
         2 000222   200005 235100                    LDA     @KEY,,AUTO
         2 000223   200016 757100                    STAQ    SKEL_LEN+1,,AUTO
         2 000224   200016 630500                    EPPR0   SKEL_LEN+1,,AUTO
         2 000225   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000226   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000227   000000 011000                    NOP     0

      710    12991           %SCREAM( ERR#=E$BAD_ACCT_NAME3, LEVEL=ERROR, MID='B' );

  13003  2 000230   000006 630400 3                  EPPR0   6
         2 000231   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000232   000000 701000 xent               TSX1    ASH$ERROR
         2 000233   000000 011000                    NOP     0

      711    13006    2      END;

      712    13007    1   ALTRETURN;

  13007  2 000234   000000 702200 xent               TSX2  ! X66_AALT

      713    13008
      714    13009        /*E* ERROR: ASB-E$UNABLE_TO_READ_PROJ-C
      715    13010        MESSAGE: Unable to read the record "%U1" from the :PROJ file.
      716    13011        */
      717    13012    1   READ_PROJ_ERR:
      718    13013    1   CALL ASH$ERROR( ERR_CODE );

  13013  2 000235   000007 630400 3     READ_PROJ_E* EPPR0   7
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:144  
         2 000236   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000237   000000 701000 xent               TSX1    ASH$ERROR
         2 000240   000000 011000                    NOP     0

      719    13014    1   AS_FIELD1 = PROJ_KEY;

  13014  2 000241   000000 100400                    MLR     fill='000'O
         2 000242   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27
         2 000243   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      720    13015        %SCREAM(ERR#=E$UNABLE_TO_READ_PROJ,MID='B',LEVEL=INFO);

  13023  2 000244   000010 630400 3                  EPPR0   8
         2 000245   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000246   000000 701000 xent               TSX1    ASH$INFO
         2 000247   000000 011000                    NOP     0

      721    13030    1   ALTRETURN;

  13030  2 000250   000000 702200 xent               TSX2  ! X66_AALT
      722    13031
      723    13032    1   END ASB$ACCT_OK;
      724    13033        %EOD;

PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:145  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$ACCT_OK.
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:146  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ACCT                      6-0-0/w PTR         r     1 @HSET_OPT
     5-0-0/w PTR         r     1 @KEY                       4-0-0/w PTR         r     1 @PACKSET
     7-0-0/w PTR         r     1 @P_PROJ_REC$              *0-0-0/c CHAR(8)     r     1 ACCT
    14-0-0/w UBIN        r     1 ACCT_LEN                  *0-0-0/w BIT         r     1 HSET_OPT
    13-0-0/w SBIN        r     1 I                         *0-0-0/c STRC(189)   r     1 KEY
    *0-0-0/c CHAR(6)     r     1 PACKSET                   10-0-0/w PTR         r     1 PROJ_REC$
    *0-0-0/w PTR         r     1 P_PROJ_REC$               11-0-0/c CHAR(8)     r     1 SKELETON
    15-0-0/w UBIN        r     1 SKEL_LEN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(369)   r     1 AS_FIELD3                  0-0-0/w PTR         r     1 AS_PROJ_HEADER$
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c STRC(243)   r     1 PROJ_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 AS$PROJ_HEADER


   Procedure ASB$ACCT_OK requires 169 words for executable code.
   Procedure ASB$ACCT_OK requires 18 words of local(AUTO) storage.
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:147  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:148  
          MINI XREF LISTING

ACCT
     12776**DCL         6--PROC    12850>>CALLBLT 12854<>CALL    12859>>CALLBLT 12861>>ASSIGN
ACCT_LEN
     12787**DCL     12850<<CALLBLT 12851>>IF      12851<<ASSIGN  12854<>CALL
AS$PROJ_HEADER
     12800**DCL     12846--ASSIGN
AS$PROJ_HEADER.SKELETON
     12813**DCL     12849>>ASSIGN
ASA$KEYCONV
     12833**DCL-ENT 12952--CALL    12990--CALL
ASA_BRKS_LOC
      9923**DCL      9923--REDEF
ASB$READ_PROJ
     12821**DCL-ENT 12847--CALL
ASB$WILD_MATCH
     12824**DCL-ENT 12854--CALL
ASH$ERROR
     12827**DCL-ENT 12965--CALL    13003--CALL    13013--CALL
ASH$INFO
     12830**DCL-ENT 12880--CALL    12901--CALL    12921--CALL    12945--CALL    12983--CALL    13023--CALL
AS_BLANK
      9783**DCL     12844>>CALLBLT 12859>>CALLBLT 12864>>CALLBLT
AS_CR_MOD_PROJ
      9931**DCL     12889>>IF
AS_DEFAULT.BANNER_PERM
     10616**DCL     10617--REDEF
AS_DEFAULT.BUDGET.MACCT
     10521**DCL     10525--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10534**DCL     10537--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10517**DCL     10519--REDEF
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:149  
AS_DEFAULT.BUDGET.PMAXC
     10512**DCL     10514--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10632**DCL     10633--REDEF   10634--REDEF
AS_DEFAULT_DREC.PASSWORD
     11886**DCL     11890--REDEF
AS_DEFAULT_DREC.RENAME
     11909**DCL     11910--REDEF
AS_DFLT.BANNER_PERM
     10438**DCL     10439--REDEF
AS_DFLT.BUDGET.MACCT
     10343**DCL     10347--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10356**DCL     10359--REDEF
AS_DFLT.BUDGET.PACCUM
     10339**DCL     10341--REDEF
AS_DFLT.BUDGET.PMAXC
     10334**DCL     10336--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10454**DCL     10455--REDEF   10456--REDEF
AS_FE_MODE
      9789**DCL      9790--REDEF
AS_FIELD1
      9919**DCL     12952<>CALL    12990<>CALL    13014<<ASSIGN
AS_FIELD1.COUNT
      9920**DCL     12860<<ASSIGN
AS_FIELD1.TEXT
      9920**DCL     12861<<ASSIGN
AS_FIELD2.COUNT
      9920**DCL     12862<<ASSIGN
AS_FIELD2.TEXT
      9920**DCL     12863<<ASSIGN
AS_FIELD3.COUNT
      9921**DCL     12865<<ASSIGN
AS_FIELD3.TEXT
      9921**DCL     12866<<ASSIGN
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:150  
AS_MODE
      9786**DCL      9788--REDEF
AS_MOD_USER.ACCESS
     12651**DCL     12652--REDEF
AS_MOD_USER.BANNER
     12638**DCL     12639--REDEF
AS_MOD_USER.BANNER_PERM
     12640**DCL     12641--REDEF
AS_MOD_USER.BILL
     12646**DCL     12647--REDEF
AS_MOD_USER.CPROC
     12642**DCL     12643--REDEF
AS_MOD_USER.FEBILL
     12722**DCL     12723--REDEF
AS_MOD_USER.FECXTMEM
     12739**DCL     12740--REDEF
AS_MOD_USER.FEMINTS
     12724**DCL     12725--REDEF
AS_MOD_USER.FEMMEM
     12735**DCL     12736--REDEF
AS_MOD_USER.FEMTIME
     12733**DCL     12734--REDEF
AS_MOD_USER.FEPPRIV
     12730**DCL     12732--REDEF
AS_MOD_USER.FEPRIV
     12727**DCL     12729--REDEF
AS_MOD_USER.FORCE_BIT
     12636**DCL     12637--REDEF
AS_MOD_USER.KEY
     12718**DCL     12720--REDEF
AS_MOD_USER.LASTCPROC
     12644**DCL     12645--REDEF
AS_MOD_USER.LIMITS.DO_
     12692**DCL     12693--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12708**DCL     12709--REDEF
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:151  
AS_MOD_USER.LIMITS.LO
     12688**DCL     12689--REDEF
AS_MOD_USER.LIMITS.MEM
     12684**DCL     12685--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12712**DCL     12713--REDEF
AS_MOD_USER.LIMITS.PDIS
     12700**DCL     12701--REDEF
AS_MOD_USER.LIMITS.PO
     12696**DCL     12697--REDEF
AS_MOD_USER.LIMITS.TDIS
     12704**DCL     12705--REDEF
AS_MOD_USER.LIMITS.TIME
     12680**DCL     12681--REDEF
AS_MOD_USER.MAXENQ
     12661**DCL     12662--REDEF
AS_MOD_USER.PERM_BIT
     12634**DCL     12635--REDEF
AS_MOD_USER.PPRIV
     12656**DCL     12658--REDEF
AS_MOD_USER.PRIOB
     12663**DCL     12664--REDEF
AS_MOD_USER.PRIV
     12653**DCL     12655--REDEF
AS_MOD_USER.QUAN
     12659**DCL     12660--REDEF
AS_MOD_USER.SETUP
     12632**DCL     12633--REDEF
AS_PROJECT.BANNER_PERM
     10972**DCL     10973--REDEF
AS_PROJECT.BUDGET.MACCT
     10877**DCL     10881--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10890**DCL     10893--REDEF
AS_PROJECT.BUDGET.PACCUM
     10873**DCL     10875--REDEF
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:152  
AS_PROJECT.BUDGET.PMAXC
     10868**DCL     10870--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     10988**DCL     10989--REDEF   10990--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11150**DCL     11151--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11055**DCL     11059--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11068**DCL     11071--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11051**DCL     11053--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11046**DCL     11048--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11166**DCL     11167--REDEF   11168--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12372**DCL     12376--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12395**DCL     12396--REDEF
AS_PROJECT_DREC.PASSWORD
     12210**DCL     12214--REDEF
AS_PROJECT_DREC.RENAME
     12233**DCL     12234--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10794**DCL     10795--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10699**DCL     10703--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10712**DCL     10715--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10695**DCL     10697--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10690**DCL     10692--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10810**DCL     10811--REDEF   10812--REDEF
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:153  
AS_PROJ_ADMIN_DREC.PASSWORD
     12048**DCL     12052--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12071**DCL     12072--REDEF
AS_PROJ_HEADER$
      9929**DCL     12841>>ASSIGN
AS_USERS.BANNER_PERM
     10260**DCL     10261--REDEF
AS_USERS.BUDGET.MACCT
     10165**DCL     10169--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10178**DCL     10181--REDEF
AS_USERS.BUDGET.PACCUM
     10161**DCL     10163--REDEF
AS_USERS.BUDGET.PMAXC
     10156**DCL     10158--REDEF
AS_USERS.SETUP_CHRA.TXT
     10276**DCL     10277--REDEF   10278--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11328**DCL     11329--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11233**DCL     11237--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11246**DCL     11249--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11229**DCL     11231--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11224**DCL     11226--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11344**DCL     11345--REDEF   11346--REDEF
ERR_CODE
      9918**DCL      9919--REDEF   13013<>CALL
HSET_OPT
     12781**DCL         6--PROC    12867--IF      12868>>IF
I
     12786**DCL     12844<<CALLBLT 12845>>ASSIGN  12846<<ASSIGN  12847<>CALL    12859<<CALLBLT 12860>>ASSIGN
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:154  
     12864<<CALLBLT 12865>>ASSIGN
KEY
     12778**DCL         6--PROC    12952<>CALL    12990<>CALL
KEY.TXT
     12780**DCL     12842>>ASSIGN
KL_DEFAULT.PASSWORD
     12534**DCL     12538--REDEF
KL_DEFAULT.RENAME
     12557**DCL     12558--REDEF
KL_DFLT.PASSWORD
     11724**DCL     11728--REDEF
KL_DFLT.RENAME
     11747**DCL     11748--REDEF
KL_DREC.PASSWORD
     11562**DCL     11566--REDEF
KL_DREC.RENAME
     11585**DCL     11586--REDEF
KL_DREC_CNT.PASSWORD
     11449**DCL     11453--REDEF
KL_DREC_CNT.RENAME
     11472**DCL     11473--REDEF
NO_MATCH
     12853**LABEL   12854--CALLALT
PACKSET
     12777**DCL         6--PROC    12843>>ASSIGN  12863>>ASSIGN
PROJ_KEY
      9795**DCL     13014>>ASSIGN
PROJ_KEY.COUNT
      9796**DCL     12845<<ASSIGN  12862>>ASSIGN
PROJ_KEY.TEXT
      9796**DCL      9796--REDEF   12844>>CALLBLT
PROJ_KEY.TXT.PACKSET
      9797**DCL     12843<<ASSIGN
PROJ_KEY.TXT.PROJECT
      9796**DCL      9796--REDEF   12842<<ASSIGN
PROJ_REC$
PL6.E3A0      #004=ASB$ACCT_OK File=ASB$SEARCH.:E05TSI                           TUE 07/29/97 09:32 Page:155  
     12784**DCL     12800--IMP-PTR 12839<<ASSIGN  12841<<ASSIGN  12847<>CALL    12849>>ASSIGN
P_PROJ_REC$
     12782**DCL         6--PROC    12838--IF      12839>>ASSIGN
READ_PROJ_ERR
     13013**LABEL   12847--CALLALT
REMEM_VAR
      9922**DCL      9922--REDEF
REM_FCMD
      9922**DCL      9923--REDEF
SKELETON
     12785**DCL     12849<<ASSIGN  12852>>CALLBLT 12854<>CALL    12864>>CALLBLT 12866>>ASSIGN
SKEL_LEN
     12788**DCL     12852<<CALLBLT 12853>>IF      12853<<ASSIGN  12854<>CALL
USERS_KEY.TEXT
      9793**DCL      9794--REDEF    9794--REDEF    9794--REDEF    9795--REDEF

PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:156  
      725        1        /*T***********************************************************/
      726        2        /*T*                                                         */
      727        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      728        4        /*T*                                                         */
      729        5        /*T***********************************************************/
      730        6        ASB$CHECK_TYPE: PROC( HLP$, HLP_SIZEC, EXPECTED_TYPE, CREATE, HLP_NAME ) ALTRET;
      731        7
      732        8        /********************************************************************/
      733        9        /*    Include files   include files   include files   include files */
      734       10        /********************************************************************/
      735       11
      736       12        %INCLUDE           AS_SSUBS_C    ;
      737      104        %INCLUDE           KC$CGBLK      ;
      738      152        %INCLUDE           AS_ENTRIES_M   ;
      739     1202        %INCLUDE           AS_SUPER_C     ;
      740     1637        %INCLUDE           AS_PERR_C      ;
      741     2239        %INCLUDE           AS_SUBS_C      ;
      742     3653        %INCLUDE           AS_MAC_C       ;
      743     3733        %INCLUDE           KL_SUPER_C     ;
      744     6635        %INCLUDE           XU_MACRO_C     ;
      745     9741        %INCLUDE           XU_FORMAT_C    ;
      746     9903        %INCLUDE           AS_SUPER_R     ;
      747    12919
      748    12920        /********************************************************************/
      749    12921        /*    Parameters      parameters      parameters      parameters    */
      750    12922        /********************************************************************/
      751    12923
      752    12924    1   DCL HLP$          PTR;                /* Ptr to :HLP record (KL$DREC) */
      753    12925    1   DCL HLP_SIZEC     UBIN;               /* Size of :HLP record in bytes */
      754    12926    1   DCL EXPECTED_TYPE UBIN;        /* Type of :HLP record that is expected (optional) */
      755    12927    1   DCL CREATE BIT(1) ALIGNED;  /* Were trying to create the :HLP record (optional) */
      756    12928    1   DCL 1 HLP_NAME,                       /* Name of :HLP record (optional) */
      757    12929    1          2 COUNT UBIN BYTE UNAL,
      758    12930    1          2 TEXT CHAR(8)   UNAL;
      759    12931
      760    12932        /*******************************************************************/
      761    12933        /*    Constant data   constant data   constant data   constant data */
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:157  
      762    12934        /********************************************************************/
      763    12935
      764    12936    1   DCL 1 HLP_TYPE_TEXTC(0:12) CONSTANT,
      765    12937    1          2 COUNT UBIN BYTE UNAL INIT(1, 4, 7, 8, 7, 6, 6, 6, 4, 4, 7, 6, 6 ),
      766    12938    1          2 TEXT CHAR(8) UNAL INIT(' ',
      767    12939    1                                  'user',
      768    12940    1                                  'station',
      769    12941    1                                  'terminal',
      770    12942    1                                  'console',
      771    12943    1                                  'device',
      772    12944    1                                  'device',
      773    12945    1                                  'device',
      774    12946    1                                  'line',
      775    12947    1                                  'link',
      776    12948    1                                  'vir cir',
      777    12949    1                                  'device',
      778    12950    1                                  'device' );
      779    12951
      780    12952        /*******************************************************************/
      781    12953        /*    Auto data       auto data       auto data       auto data     */
      782    12954        /********************************************************************/
      783    12955
      784    12956    1   DCL HLP_TYPE UBIN;
      785    12957    1   DCL NAME CHAR(31);
      786    12958    1   DCL ACCT CHAR(8);
      787    12959
      788    12960        /*******************************************************************/
      789    12961        /*    Based data      based data      based data      based data    */
      790    12962        /********************************************************************/
      791    12963
      792    12964        %KL_DREC( NAME=KL$DREC, LAST=",", STCLASS="BASED(HLP$)" );
      793    13077        %KC$CGID( FPTN=CGID, LVL=2, LAST=";", STCLASS=BASED );
      794    13103
      795    13104        /*******************************************************************/
      796    13105        /*    Entry       entry       entry       entry       entry        */
      797    13106        /******************************************************************/
      798    13107
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:158  
      799    13108        %ASB$WRITE_HLP ;
      800    13111        %ASH$ERROR ;
      801    13114
      802    13115
      803    13116        /********************************************************************/
      804    13117        /*    Procedure       procedure       procedure       procedure     */
      805    13118        /*******************************************************************/
      806    13119
      807    13120
      808    13121    1   IF ( (KL$DREC.SUPER = AS_UNDEF#) AND
      809    13122    1        (KL$DREC.ATYP ~= 0) )
      810    13123    2   THEN DO;
      811    13124    3      DO SELECT( KL$DREC.ATYP );
      812    13125    3         SELECT( %KLAT_STA# );
      813    13126    3         KL$DREC.SUPER = AS_STAT#;
      814    13127    3         SELECT( %KLAT_TS# );
      815    13128    3         KL$DREC.SUPER = AS_TS#;
      816    13129    3         SELECT( %KLAT_TRM# );
      817    13130    3         KL$DREC.SUPER = AS_TERM#;
      818    13131    3         SELECT( %KLAT_CG# );
      819    13132    3         IF KL$DREC.FLAGS.USETP THEN
      820    13133    3            KL$DREC.SUPER = AS_TP_DEV#;
      821    13134    4         ELSE DO;
      822    13135    4            NAME = KL$DREC.CGID.NAME#.TXT;
      823    13136    4            ACCT = KL$DREC.CGID.ACCT#;
      824    13137    4            IF NAME = 'OCCG' AND ACCT = ':SYS' THEN
      825    13138    4               KL$DREC.SUPER = AS_CON#;
      826    13139    4            ELSE
      827    13140    4               IF NAME = 'ISCG' AND ACCT = ':SYS' THEN
      828    13141    4                  KL$DREC.SUPER = AS_IN_DEV#;
      829    13142    4               ELSE
      830    13143    4                  IF NAME = 'OSCG' AND ACCT = ':SYS' THEN
      831    13144    4                     KL$DREC.SUPER = AS_OUT_DEV#;
      832    13145    4                  ELSE
      833    13146    4                     KL$DREC.SUPER = AS_CG_DEV#;
      834    13147    4            END;
      835    13148    3         SELECT( %KLAT_LINE# );
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:159  
      836    13149    3         KL$DREC.SUPER = AS_LINE#;
      837    13150    3         SELECT( %KLAT_LNKLINE# );
      838    13151    3         KL$DREC.SUPER = AS_LNK#;
      839    13152    3         SELECT( %KLAT_RES# ) ;
      840    13153    3         KL$DREC.SUPER = AS_RES_DEV# ;
      841    13154    3         END;
      842    13155    2      CALL ASB$WRITE_HLP( HLP$, HLP_SIZEC );
      843    13156    2      END;
      844    13157
      845    13158
      846    13159    2   IF ADDR(EXPECTED_TYPE) ~= ADDR(NIL) THEN DO;
      847    13160    2      HLP_TYPE = KL$DREC.SUPER;
      848    13161    3      IF HLP_TYPE_TEXTC(HLP_TYPE) ~= HLP_TYPE_TEXTC(EXPECTED_TYPE) THEN DO;
      849    13162    4         IF ADDR(CREATE) ~= ADDR(NIL) THEN DO;
      850    13163    4            AS_FIELD1 = HLP_NAME;
      851    13164    4            AS_FIELD2 = HLP_TYPE_TEXTC(HLP_TYPE);
      852    13165    4            AS_FIELD3 = HLP_TYPE_TEXTC(EXPECTED_TYPE);
      853    13166    5            IF CREATE THEN DO;
      854    13167        /*E*  ERROR:  ASB-E$HLP_WRONG_TYPE1-C
      855    13168              MESSAGE: %U1 already exists and is a %U2 not a %U3.
      856    13169        */
      857    13170                    %SCREAM( ERR#=E$HLP_WRONG_TYPE1, LEVEL=ERROR, MID='B' );
      858    13185    5               END;
      859    13186    5            ELSE DO;
      860    13187        /*E*  ERROR:  AS-E$HLP_WRONG_TYPE2-C
      861    13188              MESSAGE: %U1 is a %U2 type definition, not a %U3 type.
      862    13189        */
      863    13190                    %SCREAM( ERR#=E$HLP_WRONG_TYPE2, LEVEL=ERROR, MID='B' );
      864    13205    5               END;
      865    13206    4            END;
      866    13207    3         ALTRETURN;
      867    13208    3         END;
      868    13209    2      END;
      869    13210
      870    13211
      871    13212    1   END ASB$CHECK_TYPE;
      872    13213        %EOD;
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:160  

PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:161  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$CHECK_TYPE.

   Procedure ASB$CHECK_TYPE requires 156 words for executable code.
   Procedure ASB$CHECK_TYPE requires 22 words of local(AUTO) storage.

PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:162  

 Object Unit name= ASB$CHECK_TYPE                             File name= ASB$SEARCH.:E05TOU
 UTS= JUL 29 '97 09:34:17.00 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     36     44  ASB$CHECK_TYPE
    2   Proc  even  none   156    234  ASB$CHECK_TYPE
    3  RoData even  none     2      2  ASB$CHECK_TYPE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        5  ASB$CHECK_TYPE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       2 ASB$WRITE_HLP
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_5
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:163  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     AS_FIELD3                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:164  


      725        1        /*T***********************************************************/
      726        2        /*T*                                                         */
      727        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      728        4        /*T*                                                         */
      729        5        /*T***********************************************************/
      730        6        ASB$CHECK_TYPE: PROC( HLP$, HLP_SIZEC, EXPECTED_TYPE, CREATE, HLP_NAME ) ALTRET;

      6  2 000000   000000 700200 xent  ASB$CHECK_T* TSX0  ! X66_AUTO_5
         2 000001   000026 000005                    ZERO    22,5

      731        7
      732        8        /********************************************************************/
      733        9        /*    Include files   include files   include files   include files */
      734       10        /********************************************************************/
      735       11
      736       12        %INCLUDE           AS_SSUBS_C    ;
      737      104        %INCLUDE           KC$CGBLK      ;
      738      152        %INCLUDE           AS_ENTRIES_M   ;
      739     1202        %INCLUDE           AS_SUPER_C     ;
      740     1637        %INCLUDE           AS_PERR_C      ;
      741     2239        %INCLUDE           AS_SUBS_C      ;
      742     3653        %INCLUDE           AS_MAC_C       ;
      743     3733        %INCLUDE           KL_SUPER_C     ;
      744     6635        %INCLUDE           XU_MACRO_C     ;
      745     9741        %INCLUDE           XU_FORMAT_C    ;
      746     9903        %INCLUDE           AS_SUPER_R     ;
      747    12919
      748    12920        /********************************************************************/
      749    12921        /*    Parameters      parameters      parameters      parameters    */
      750    12922        /********************************************************************/
      751    12923
      752    12924    1   DCL HLP$          PTR;                /* Ptr to :HLP record (KL$DREC) */
      753    12925    1   DCL HLP_SIZEC     UBIN;               /* Size of :HLP record in bytes */
      754    12926    1   DCL EXPECTED_TYPE UBIN;       /* Type of :HLP record that is expected (optional) */
      755    12927    1   DCL CREATE BIT(1) ALIGNED;  /* Were trying to create the :HLP record (optional) */
      756    12928    1   DCL 1 HLP_NAME,                       /* Name of :HLP record (optional) */
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:165  
      757    12929    1          2 COUNT UBIN BYTE UNAL,
      758    12930    1          2 TEXT CHAR(8)   UNAL;
      759    12931
      760    12932        /*******************************************************************/
      761    12933        /*    Constant data   constant data   constant data   constant data */
      762    12934        /********************************************************************/
      763    12935
      764    12936    1   DCL 1 HLP_TYPE_TEXTC(0:12) CONSTANT,
      765    12937    1          2 COUNT UBIN BYTE UNAL INIT(1, 4, 7, 8, 7, 6, 6, 6, 4, 4, 7, 6, 6 ),
      766    12938    1          2 TEXT CHAR(8) UNAL INIT(' ',
      767    12939    1                                  'user',
      768    12940    1                                  'station',
      769    12941    1                                  'terminal',
      770    12942    1                                  'console',
      771    12943    1                                  'device',
      772    12944    1                                  'device',
      773    12945    1                                  'device',
      774    12946    1                                  'line',
      775    12947    1                                  'link',
      776    12948    1                                  'vir cir',
      777    12949    1                                  'device',
      778    12950    1                                  'device' );
      779    12951
      780    12952        /*******************************************************************/
      781    12953        /*    Auto data       auto data       auto data       auto data     */
      782    12954        /********************************************************************/
      783    12955
      784    12956    1   DCL HLP_TYPE UBIN;
      785    12957    1   DCL NAME CHAR(31);
      786    12958    1   DCL ACCT CHAR(8);
      787    12959
      788    12960        /*******************************************************************/
      789    12961        /*    Based data      based data      based data      based data    */
      790    12962        /********************************************************************/
      791    12963
      792    12964        %KL_DREC( NAME=KL$DREC, LAST=",", STCLASS="BASED(HLP$)" );
      793    13077        %KC$CGID( FPTN=CGID, LVL=2, LAST=";", STCLASS=BASED );
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:166  
      794    13103
      795    13104        /*******************************************************************/
      796    13105        /*    Entry       entry       entry       entry       entry        */
      797    13106        /******************************************************************/
      798    13107
      799    13108        %ASB$WRITE_HLP ;
      800    13111        %ASH$ERROR ;
      801    13114
      802    13115
      803    13116        /********************************************************************/
      804    13117        /*    Procedure       procedure       procedure       procedure     */
      805    13118        /*******************************************************************/
      806    13119
      807    13120
      808    13121    1   IF ( (KL$DREC.SUPER = AS_UNDEF#) AND

  13121  2 000002   200003 470500                    LDP0    @HLP$,,AUTO
         2 000003   000000 471500                    LDP1    0,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   000777 316007                    CANQ    511,DL
         2 000006   000152 601000 2                  TNZ     s:13159
         2 000007   777000 316003                    CANQ    -512,DU
         2 000010   000152 600000 2                  TZE     s:13159

      809    13122    1        (KL$DREC.ATYP ~= 0) )
      810    13123    2   THEN DO;

      811    13124    3      DO SELECT( KL$DREC.ATYP );

  13124  2 000011   100000 236100                    LDQ     0,,PR1
         2 000012   000033 772000                    QRL     27
         2 000013   000004 116007                    CMPQ    4,DL
         2 000014   000025 602000 2                  TNC     s:13124+12
         2 000015   000053 600000 2                  TZE     s:13130
         2 000016   000005 116007                    CMPQ    5,DL
         2 000017   000146 602000 2                  TNC     s:13155
         2 000020   000136 600000 2                  TZE     s:13149
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:167  
         2 000021   000033 736000                    QLS     27
         2 000022   006000 116003                    CMPQ    3072,DU
         2 000023   000146 601000 2                  TNZ     s:13155
         2 000024   000141 710000 2                  TRA     s:13151
         2 000025   100000 236100                    LDQ     0,,PR1
         2 000026   000033 772000                    QRL     27
         2 000027   000001 116007                    CMPQ    1,DL
         2 000030   000041 602000 2                  TNC     s:13124+24
         2 000031   000050 600000 2                  TZE     s:13128
         2 000032   000002 116007                    CMPQ    2,DL
         2 000033   000146 602000 2                  TNC     s:13155
         2 000034   000056 600000 2                  TZE     s:13132
         2 000035   000033 736000                    QLS     27
         2 000036   003000 116003                    CMPQ    1536,DU
         2 000037   000146 601000 2                  TNZ     s:13155
         2 000040   000144 710000 2                  TRA     s:13153
         2 000041   100000 236100                    LDQ     0,,PR1
         2 000042   777000 316003                    CANQ    -512,DU
         2 000043   000045 600000 2                  TZE     s:13126
         2 000044   000146 710000 2                  TRA     s:13155

      812    13125    3         SELECT( %KLAT_STA# );

      813    13126    3         KL$DREC.SUPER = AS_STAT#;

  13126  2 000045   000002 236007                    LDQ     2,DL
         2 000046   100000 552104                    STBQ    0,'04'O,PR1
         2 000047   000146 710000 2                  TRA     s:13155

      814    13127    3         SELECT( %KLAT_TS# );

      815    13128    3         KL$DREC.SUPER = AS_TS#;

  13128  2 000050   000001 236007                    LDQ     1,DL
         2 000051   100000 552104                    STBQ    0,'04'O,PR1
         2 000052   000146 710000 2                  TRA     s:13155

PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:168  
      816    13129    3         SELECT( %KLAT_TRM# );

      817    13130    3         KL$DREC.SUPER = AS_TERM#;

  13130  2 000053   000003 236007                    LDQ     3,DL
         2 000054   100000 552104                    STBQ    0,'04'O,PR1
         2 000055   000146 710000 2                  TRA     s:13155

      818    13131    3         SELECT( %KLAT_CG# );

      819    13132    3         IF KL$DREC.FLAGS.USETP THEN

  13132  2 000056   100000 236100                    LDQ     0,,PR1
         2 000057   000010 316003                    CANQ    8,DU
         2 000060   000064 600000 2                  TZE     s:13135

      820    13133    3            KL$DREC.SUPER = AS_TP_DEV#;

  13133  2 000061   000007 236007                    LDQ     7,DL
         2 000062   100000 552104                    STBQ    0,'04'O,PR1
         2 000063   000146 710000 2                  TRA     s:13155

      821    13134    4         ELSE DO;

      822    13135    4            NAME = KL$DREC.CGID.NAME#.TXT;

  13135  2 000064   040100 100500                    MLR     fill='040'O
         2 000065   100024 200037                    ADSC9   20,,PR1                  cn=1,n=31
         2 000066   200011 000037                    ADSC9   NAME,,AUTO               cn=0,n=31

      823    13136    4            ACCT = KL$DREC.CGID.ACCT#;

  13136  2 000067   040100 100500                    MLR     fill='040'O
         2 000070   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         2 000071   200021 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

      824    13137    4            IF NAME = 'OCCG' AND ACCT = ':SYS' THEN
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:169  

  13137  2 000072   040000 106500                    CMPC    fill='040'O
         2 000073   200011 000037                    ADSC9   NAME,,AUTO               cn=0,n=31
         2 000074   000036 000004 1                  ADSC9   HLP_TYPE_TEXTC+30        cn=0,n=4
         2 000075   000105 601000 2                  TNZ     s:13140
         2 000076   040000 106500                    CMPC    fill='040'O
         2 000077   200021 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         2 000100   000037 000004 1                  ADSC9   HLP_TYPE_TEXTC+31        cn=0,n=4
         2 000101   000105 601000 2                  TNZ     s:13140

      825    13138    4               KL$DREC.SUPER = AS_CON#;

  13138  2 000102   000004 236007                    LDQ     4,DL
         2 000103   100000 552104                    STBQ    0,'04'O,PR1
         2 000104   000146 710000 2                  TRA     s:13155

      826    13139    4            ELSE
      827    13140    4               IF NAME = 'ISCG' AND ACCT = ':SYS' THEN

  13140  2 000105   040000 106500                    CMPC    fill='040'O
         2 000106   200011 000037                    ADSC9   NAME,,AUTO               cn=0,n=31
         2 000107   000040 000004 1                  ADSC9   HLP_TYPE_TEXTC+32        cn=0,n=4
         2 000110   000120 601000 2                  TNZ     s:13143
         2 000111   040000 106500                    CMPC    fill='040'O
         2 000112   200021 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         2 000113   000037 000004 1                  ADSC9   HLP_TYPE_TEXTC+31        cn=0,n=4
         2 000114   000120 601000 2                  TNZ     s:13143

      828    13141    4                  KL$DREC.SUPER = AS_IN_DEV#;

  13141  2 000115   000005 236007                    LDQ     5,DL
         2 000116   100000 552104                    STBQ    0,'04'O,PR1
         2 000117   000146 710000 2                  TRA     s:13155

      829    13142    4               ELSE
      830    13143    4                  IF NAME = 'OSCG' AND ACCT = ':SYS' THEN

PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:170  
  13143  2 000120   040000 106500                    CMPC    fill='040'O
         2 000121   200011 000037                    ADSC9   NAME,,AUTO               cn=0,n=31
         2 000122   000041 000004 1                  ADSC9   HLP_TYPE_TEXTC+33        cn=0,n=4
         2 000123   000133 601000 2                  TNZ     s:13146
         2 000124   040000 106500                    CMPC    fill='040'O
         2 000125   200021 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         2 000126   000037 000004 1                  ADSC9   HLP_TYPE_TEXTC+31        cn=0,n=4
         2 000127   000133 601000 2                  TNZ     s:13146

      831    13144    4                     KL$DREC.SUPER = AS_OUT_DEV#;

  13144  2 000130   000006 236007                    LDQ     6,DL
         2 000131   100000 552104                    STBQ    0,'04'O,PR1
         2 000132   000146 710000 2                  TRA     s:13155

      832    13145    4                  ELSE
      833    13146    4                     KL$DREC.SUPER = AS_CG_DEV#;

  13146  2 000133   000013 236007                    LDQ     11,DL
         2 000134   100000 552104                    STBQ    0,'04'O,PR1

      834    13147    4            END;

  13147  2 000135   000146 710000 2                  TRA     s:13155

      835    13148    3         SELECT( %KLAT_LINE# );

      836    13149    3         KL$DREC.SUPER = AS_LINE#;

  13149  2 000136   000010 236007                    LDQ     8,DL
         2 000137   100000 552104                    STBQ    0,'04'O,PR1
         2 000140   000146 710000 2                  TRA     s:13155

      837    13150    3         SELECT( %KLAT_LNKLINE# );

      838    13151    3         KL$DREC.SUPER = AS_LNK#;

PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:171  
  13151  2 000141   000011 236007                    LDQ     9,DL
         2 000142   100000 552104                    STBQ    0,'04'O,PR1
         2 000143   000146 710000 2                  TRA     s:13155

      839    13152    3         SELECT( %KLAT_RES# ) ;

      840    13153    3         KL$DREC.SUPER = AS_RES_DEV# ;

  13153  2 000144   000014 236007                    LDQ     12,DL
         2 000145   100000 552104                    STBQ    0,'04'O,PR1

      841    13154    3         END;

      842    13155    2      CALL ASB$WRITE_HLP( HLP$, HLP_SIZEC );

  13155  2 000146   200003 630500                    EPPR0   @HLP$,,AUTO
         2 000147   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000150   000000 701000 xent               TSX1    ASB$WRITE_HLP
         2 000151   000000 011000                    NOP     0

      843    13156    2      END;

      844    13157
      845    13158
      846    13159    2   IF ADDR(EXPECTED_TYPE) ~= ADDR(NIL) THEN DO;

  13159  2 000152   200005 236100                    LDQ     @EXPECTED_TYPE,,AUTO
         2 000153   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000154   000233 600000 2                  TZE     s:13212

      847    13160    2      HLP_TYPE = KL$DREC.SUPER;

  13160  2 000155   200003 470500                    LDP0    @HLP$,,AUTO
         2 000156   000000 471500                    LDP1    0,,PR0
         2 000157   100000 236100                    LDQ     0,,PR1
         2 000160   000777 376007                    ANQ     511,DL
         2 000161   200010 756100                    STQ     HLP_TYPE,,AUTO
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:172  

      848    13161    3      IF HLP_TYPE_TEXTC(HLP_TYPE) ~= HLP_TYPE_TEXTC(EXPECTED_TYPE) THEN DO;

  13161  2 000162   200005 473500                    LDP3    @EXPECTED_TYPE,,AUTO
         2 000163   300000 236100                    LDQ     0,,PR3
         2 000164   000011 402007                    MPY     9,DL
         2 000165   200024 756100                    STQ     ACCT+3,,AUTO
         2 000166   200010 236100                    LDQ     HLP_TYPE,,AUTO
         2 000167   000011 402007                    MPY     9,DL
         2 000170   200024 235100                    LDA     ACCT+3,,AUTO
         2 000171   000005 106406                    CMPC    fill='000'O
         2 000172   000000 000011 1                  ADSC9   HLP_TYPE_TEXTC,Q         cn=0,n=9
         2 000173   000000 000011 1                  ADSC9   HLP_TYPE_TEXTC,A         cn=0,n=9
         2 000174   000233 600000 2                  TZE     s:13212

      849    13162    4         IF ADDR(CREATE) ~= ADDR(NIL) THEN DO;

  13162  2 000175   200006 236100                    LDQ     @CREATE,,AUTO
         2 000176   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000177   000232 600000 2                  TZE     s:13207

      850    13163    4            AS_FIELD1 = HLP_NAME;

  13163  2 000200   200007 471500                    LDP1    @HLP_NAME,,AUTO
         2 000201   000000 100500                    MLR     fill='000'O
         2 000202   100000 000011                    ADSC9   0,,PR1                   cn=0,n=9
         2 000203   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      851    13164    4            AS_FIELD2 = HLP_TYPE_TEXTC(HLP_TYPE);

  13164  2 000204   200010 236100                    LDQ     HLP_TYPE,,AUTO
         2 000205   000011 402007                    MPY     9,DL
         2 000206   000000 100406                    MLR     fill='000'O
         2 000207   000000 000011 1                  ADSC9   HLP_TYPE_TEXTC,Q         cn=0,n=9
         2 000210   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

      852    13165    4            AS_FIELD3 = HLP_TYPE_TEXTC(EXPECTED_TYPE);
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:173  

  13165  2 000211   300000 236100                    LDQ     0,,PR3
         2 000212   000011 402007                    MPY     9,DL
         2 000213   000000 100406                    MLR     fill='000'O
         2 000214   000000 000011 1                  ADSC9   HLP_TYPE_TEXTC,Q         cn=0,n=9
         2 000215   000000 000051 xsym               ADSC9   AS_FIELD3                cn=0,n=41

      853    13166    5            IF CREATE THEN DO;

  13166  2 000216   200006 474500                    LDP4    @CREATE,,AUTO
         2 000217   400000 234100                    SZN     0,,PR4
         2 000220   000226 605000 2                  TPL     s:13202

      854    13167        /*E*  ERROR:  ASB-E$HLP_WRONG_TYPE1-C
      855    13168              MESSAGE: %U1 already exists and is a %U2 not a %U3.
      856    13169        */
      857    13170                    %SCREAM( ERR#=E$HLP_WRONG_TYPE1, LEVEL=ERROR, MID='B' );

  13182  2 000221   000000 630400 3                  EPPR0   0
         2 000222   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000223   000000 701000 xent               TSX1    ASH$ERROR
         2 000224   000000 011000                    NOP     0

      858    13185    5               END;

  13185  2 000225   000232 710000 2                  TRA     s:13207

      859    13186    5            ELSE DO;

      860    13187        /*E*  ERROR:  AS-E$HLP_WRONG_TYPE2-C
      861    13188              MESSAGE: %U1 is a %U2 type definition, not a %U3 type.
      862    13189        */
      863    13190                    %SCREAM( ERR#=E$HLP_WRONG_TYPE2, LEVEL=ERROR, MID='B' );

  13202  2 000226   000001 630400 3                  EPPR0   1
         2 000227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000230   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:174  
         2 000231   000000 011000                    NOP     0

      864    13205    5               END;

      865    13206    4            END;

      866    13207    3         ALTRETURN;

  13207  2 000232   000000 702200 xent               TSX2  ! X66_AALT

      867    13208    3         END;
      868    13209    2      END;
      869    13210
      870    13211
      871    13212    1   END ASB$CHECK_TYPE;

  13212  2 000233   000000 702200 xent               TSX2  ! X66_ARET
      872    13213        %EOD;

PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:175  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$CHECK_TYPE.
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:176  

 **** Variables and constants ****

  ****  Section 001 RoData ASB$CHECK_TYPE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(81)    r     1 HLP_TYPE_TEXTC(0:12)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @CREATE                    5-0-0/w PTR         r     1 @EXPECTED_TYPE
     3-0-0/w PTR         r     1 @HLP$                      7-0-0/w PTR         r     1 @HLP_NAME
     4-0-0/w PTR         r     1 @HLP_SIZEC                21-0-0/c CHAR(8)     r     1 ACCT
    *0-0-0/w BIT         r     1 CREATE                    *0-0-0/w UBIN        r     1 EXPECTED_TYPE
    *0-0-0/w PTR         r     1 HLP$                      *0-0-0/c STRC(81)    r     1 HLP_NAME
    *0-0-0/w UBIN        r     1 HLP_SIZEC                 10-0-0/w UBIN        r     1 HLP_TYPE
    11-0-0/c CHAR(31)    r     1 NAME

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(369)   r     1 AS_FIELD3

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1008)  r     1 KL$DREC

PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:177  

   Procedure ASB$CHECK_TYPE requires 156 words for executable code.
   Procedure ASB$CHECK_TYPE requires 22 words of local(AUTO) storage.
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:178  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:179  
          MINI XREF LISTING

ACCT
     12958**DCL     13136<<ASSIGN  13137>>IF      13140>>IF      13143>>IF
ASA_BRKS_LOC
     10067**DCL     10067--REDEF
ASB$WRITE_HLP
     13109**DCL-ENT 13155--CALL
ASH$ERROR
     13112**DCL-ENT 13182--CALL    13202--CALL
AS_DEFAULT.BANNER_PERM
     10760**DCL     10761--REDEF
AS_DEFAULT.BUDGET.MACCT
     10665**DCL     10669--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10678**DCL     10681--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10661**DCL     10663--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10656**DCL     10658--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10776**DCL     10777--REDEF   10778--REDEF
AS_DEFAULT_DREC.PASSWORD
     12030**DCL     12034--REDEF
AS_DEFAULT_DREC.RENAME
     12053**DCL     12054--REDEF
AS_DFLT.BANNER_PERM
     10582**DCL     10583--REDEF
AS_DFLT.BUDGET.MACCT
     10487**DCL     10491--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10500**DCL     10503--REDEF
AS_DFLT.BUDGET.PACCUM
     10483**DCL     10485--REDEF
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:180  
AS_DFLT.BUDGET.PMAXC
     10478**DCL     10480--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10598**DCL     10599--REDEF   10600--REDEF
AS_FE_MODE
      9933**DCL      9934--REDEF
AS_FIELD1
     10063**DCL     13163<<ASSIGN
AS_FIELD2
     10064**DCL     13164<<ASSIGN
AS_FIELD3
     10064**DCL     13165<<ASSIGN
AS_MODE
      9930**DCL      9932--REDEF
AS_MOD_USER.ACCESS
     12795**DCL     12796--REDEF
AS_MOD_USER.BANNER
     12782**DCL     12783--REDEF
AS_MOD_USER.BANNER_PERM
     12784**DCL     12785--REDEF
AS_MOD_USER.BILL
     12790**DCL     12791--REDEF
AS_MOD_USER.CPROC
     12786**DCL     12787--REDEF
AS_MOD_USER.FEBILL
     12866**DCL     12867--REDEF
AS_MOD_USER.FECXTMEM
     12883**DCL     12884--REDEF
AS_MOD_USER.FEMINTS
     12868**DCL     12869--REDEF
AS_MOD_USER.FEMMEM
     12879**DCL     12880--REDEF
AS_MOD_USER.FEMTIME
     12877**DCL     12878--REDEF
AS_MOD_USER.FEPPRIV
     12874**DCL     12876--REDEF
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:181  
AS_MOD_USER.FEPRIV
     12871**DCL     12873--REDEF
AS_MOD_USER.FORCE_BIT
     12780**DCL     12781--REDEF
AS_MOD_USER.KEY
     12862**DCL     12864--REDEF
AS_MOD_USER.LASTCPROC
     12788**DCL     12789--REDEF
AS_MOD_USER.LIMITS.DO_
     12836**DCL     12837--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12852**DCL     12853--REDEF
AS_MOD_USER.LIMITS.LO
     12832**DCL     12833--REDEF
AS_MOD_USER.LIMITS.MEM
     12828**DCL     12829--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12856**DCL     12857--REDEF
AS_MOD_USER.LIMITS.PDIS
     12844**DCL     12845--REDEF
AS_MOD_USER.LIMITS.PO
     12840**DCL     12841--REDEF
AS_MOD_USER.LIMITS.TDIS
     12848**DCL     12849--REDEF
AS_MOD_USER.LIMITS.TIME
     12824**DCL     12825--REDEF
AS_MOD_USER.MAXENQ
     12805**DCL     12806--REDEF
AS_MOD_USER.PERM_BIT
     12778**DCL     12779--REDEF
AS_MOD_USER.PPRIV
     12800**DCL     12802--REDEF
AS_MOD_USER.PRIOB
     12807**DCL     12808--REDEF
AS_MOD_USER.PRIV
     12797**DCL     12799--REDEF
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:182  
AS_MOD_USER.QUAN
     12803**DCL     12804--REDEF
AS_MOD_USER.SETUP
     12776**DCL     12777--REDEF
AS_PROJECT.BANNER_PERM
     11116**DCL     11117--REDEF
AS_PROJECT.BUDGET.MACCT
     11021**DCL     11025--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     11034**DCL     11037--REDEF
AS_PROJECT.BUDGET.PACCUM
     11017**DCL     11019--REDEF
AS_PROJECT.BUDGET.PMAXC
     11012**DCL     11014--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11132**DCL     11133--REDEF   11134--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11294**DCL     11295--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11199**DCL     11203--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11212**DCL     11215--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11195**DCL     11197--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11190**DCL     11192--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11310**DCL     11311--REDEF   11312--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12516**DCL     12520--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12539**DCL     12540--REDEF
AS_PROJECT_DREC.PASSWORD
     12354**DCL     12358--REDEF
AS_PROJECT_DREC.RENAME
     12377**DCL     12378--REDEF
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:183  
AS_PROJ_ADMIN.BANNER_PERM
     10938**DCL     10939--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10843**DCL     10847--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10856**DCL     10859--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10839**DCL     10841--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10834**DCL     10836--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10954**DCL     10955--REDEF   10956--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12192**DCL     12196--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12215**DCL     12216--REDEF
AS_USERS.BANNER_PERM
     10404**DCL     10405--REDEF
AS_USERS.BUDGET.MACCT
     10309**DCL     10313--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10322**DCL     10325--REDEF
AS_USERS.BUDGET.PACCUM
     10305**DCL     10307--REDEF
AS_USERS.BUDGET.PMAXC
     10300**DCL     10302--REDEF
AS_USERS.SETUP_CHRA.TXT
     10420**DCL     10421--REDEF   10422--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11472**DCL     11473--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11377**DCL     11381--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11390**DCL     11393--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11373**DCL     11375--REDEF
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:184  
AS_USERS_CONSTANT.BUDGET.PMAXC
     11368**DCL     11370--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11488**DCL     11489--REDEF   11490--REDEF
CREATE
     12927**DCL         6--PROC    13162--IF      13166>>IF
ERR_CODE
     10062**DCL     10063--REDEF
EXPECTED_TYPE
     12926**DCL         6--PROC    13159--IF      13161>>IF      13165>>ASSIGN
HLP$
     12924**DCL         6--PROC    12977--IMP-PTR 13121>>IF      13121>>IF      13124>>DOSELCT 13126>>ASSIGN
     13128>>ASSIGN  13130>>ASSIGN  13132>>IF      13133>>ASSIGN  13135>>ASSIGN  13136>>ASSIGN  13138>>ASSIGN
     13141>>ASSIGN  13144>>ASSIGN  13146>>ASSIGN  13149>>ASSIGN  13151>>ASSIGN  13153>>ASSIGN  13155<>CALL
     13160>>ASSIGN
HLP_NAME
     12928**DCL         6--PROC    13163>>ASSIGN
HLP_SIZEC
     12925**DCL         6--PROC    13155<>CALL
HLP_TYPE
     12956**DCL     13160<<ASSIGN  13161>>IF      13164>>ASSIGN
HLP_TYPE_TEXTC
     12936**DCL     13161>>IF      13161>>IF      13164>>ASSIGN  13165>>ASSIGN
KL$DREC.ATYP
     12982**DCL     13121>>IF      13124>>DOSELCT
KL$DREC.CGID.ACCT#
     13096**DCL     13136>>ASSIGN
KL$DREC.CGID.NAME#.TXT
     13101**DCL     13135>>ASSIGN
KL$DREC.FLAGS.USETP
     13006**DCL     13132>>IF
KL$DREC.PASSWORD
     13035**DCL     13039--REDEF
KL$DREC.RENAME
     13058**DCL     13059--REDEF
KL$DREC.SUPER
PL6.E3A0      #005=ASB$CHECK_TYPE File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:34 Page:185  
     13029**DCL     13121>>IF      13126<<ASSIGN  13128<<ASSIGN  13130<<ASSIGN  13133<<ASSIGN  13138<<ASSIGN
     13141<<ASSIGN  13144<<ASSIGN  13146<<ASSIGN  13149<<ASSIGN  13151<<ASSIGN  13153<<ASSIGN  13160>>ASSIGN
KL_DEFAULT.PASSWORD
     12678**DCL     12682--REDEF
KL_DEFAULT.RENAME
     12701**DCL     12702--REDEF
KL_DFLT.PASSWORD
     11868**DCL     11872--REDEF
KL_DFLT.RENAME
     11891**DCL     11892--REDEF
KL_DREC.PASSWORD
     11706**DCL     11710--REDEF
KL_DREC.RENAME
     11729**DCL     11730--REDEF
KL_DREC_CNT.PASSWORD
     11593**DCL     11597--REDEF
KL_DREC_CNT.RENAME
     11616**DCL     11617--REDEF
NAME
     12957**DCL     13135<<ASSIGN  13137>>IF      13140>>IF      13143>>IF
PROJ_KEY.TEXT
      9940**DCL      9940--REDEF
PROJ_KEY.TXT.PROJECT
      9940**DCL      9940--REDEF
REMEM_VAR
     10066**DCL     10066--REDEF
REM_FCMD
     10066**DCL     10067--REDEF
USERS_KEY.TEXT
      9937**DCL      9938--REDEF    9938--REDEF    9938--REDEF    9939--REDEF

PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:186  
      873        1        /*T***********************************************************/
      874        2        /*T*                                                         */
      875        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      876        4        /*T*                                                         */
      877        5        /*T***********************************************************/
      878        6        ASB$WILD_MATCH: PROC( STR_LEN, STRING, MATCH_LEN, MATCH )  ALTRET ;
      879        7
      880        8        /*D* NAME:    ASB$WILD_MATCH
      881        9           CALL:    CALL ASB$WILD_MATCH( STR_LEN, STRING, MATCH_LEN, MATCH ) ALTRET(LABEL) ;
      882       10             INPUT:   STR_LEN - length of STRING.
      883       11                      STRING  - character string to be compared to MATCH.
      884       12                      MATCH_LEN - length of MATCH.
      885       13                      MATCH   - character string with possible wildcarding.
      886       14             OUTPUT:  Nothing.
      887       15             DESCRIPTION:
      888       16                  ASB$WILD_MATCH is a pass through routine to the shared library
      889       17                  for the XUW services.
      890       18                  If X$WILDCMP altrets with anything other than a no match
      891       19                  error, ASB$MATCH reports an error.  If X$WILDCMP altrets
      892       20                  ASB$MATCH altrets.  If X$WILDCMP returns normally, then
      893       21                  ASB$MATCH returns normally.  A normal return means ASB$MATCH
      894       22                  found a match between the string and the pattern.  If
      895       23                  ASB$MATCH altreturns then no match was found.
      896       24        */
      897       25
      898       26        /********************************************************************/
      899       27        /*    Parameters      parameters      parameters      parameters    */
      900       28        /********************************************************************/
      901       29
      902       30    1   DCL STR_LEN UBIN ;
      903       31    1   DCL MATCH_LEN UBIN ;
      904       32    1   DCL STRING CHAR(STR_LEN) ;
      905       33    1   DCL MATCH  CHAR(MATCH_LEN) ;
      906       34
      907       35        /********************************************************************/
      908       36        /*    includes        includes        includes        includes      */
      909       37        /********************************************************************/
PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:187  
      910       38
      911       39        %INCLUDE XUW_MACRO_C;
      912      174        %INCLUDE XU_PERR_C;
      913      365
      914      366           %XUW_ENTRIES;
      915      378           %XUW_WILDCARD (STCLASS = STATIC);
      916      474
      917      475        /********************************************************************/
      918      476        /*              static data       static data       static data     */
      919      477        /********************************************************************/
      920      478
      921      479    1   DCL I   UBIN;
      922      480
      923      481        /********************************************************************/
      924      482        /*    Procedure       procedure       procedure       procedure     */
      925      483        /********************************************************************/
      926      484
      927      485    1   CALL INDEX (I, '?', MATCH)
      928      486    2   WHENRETURN DO;
      929      487    2      XUW_WILDCARD.INPUT_ = VECTOR (STRING);
      930      488    2      XUW_WILDCARD.PATTERN_ = VECTOR (MATCH);
      931      489    2      CALL X$WILDCMP (XUW_WILDCARD)
      932      490    3      WHENRETURN DO;
      933      491    3         RETURN;
      934      492    3         END;
      935      493    3      WHENALTRETURN DO;
      936      494    3         ALTRETURN;
      937      495    3         END;
      938      496    2      END;
      939      497    2   WHENALTRETURN DO;
      940      498    2      IF (SUBSTR (STRING, 0, STR_LEN) = SUBSTR (MATCH, 0, MATCH_LEN))
      941      499    3      THEN DO;
      942      500    3         RETURN;
      943      501    3         END;
      944      502    3      ELSE DO;
      945      503    3         ALTRETURN;
      946      504    3         END;
PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:188  
      947      505    2      END;
      948      506    1   END ASB$WILD_MATCH;

PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:189  
--  Include file information  --

   XU_PERR_C.:E05TOU  is referenced.
   XUW_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$WILD_MATCH.

   Procedure ASB$WILD_MATCH requires 41 words for executable code.
   Procedure ASB$WILD_MATCH requires 8 words of local(AUTO) storage.

    No errors detected in file ASB$SEARCH.:E05TSI    .

PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:190  

 Object Unit name= ASB$WILD_MATCH                             File name= ASB$SEARCH.:E05TOU
 UTS= JUL 29 '97 09:36:30.72 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    12     14  ASB$WILD_MATCH
    1   Proc  even  none    41     51  ASB$WILD_MATCH
    2  RoData even  none     2      2  ASB$WILD_MATCH

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        4  ASB$WILD_MATCH

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 X$WILDCMP
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:191  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:192  


      873        1        /*T***********************************************************/
      874        2        /*T*                                                         */
      875        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      876        4        /*T*                                                         */
      877        5        /*T***********************************************************/
      878        6        ASB$WILD_MATCH: PROC( STR_LEN, STRING, MATCH_LEN, MATCH )  ALTRET ;

      6  1 000000   000000 700200 xent  ASB$WILD_MA* TSX0  ! X66_AUTO_4
         1 000001   000010 000004                    ZERO    8,4

      879        7
      880        8        /*D* NAME:    ASB$WILD_MATCH
      881        9           CALL:   CALL ASB$WILD_MATCH( STR_LEN, STRING, MATCH_LEN, MATCH ) ALTRET(LABEL) ;
      882       10             INPUT:   STR_LEN - length of STRING.
      883       11                      STRING  - character string to be compared to MATCH.
      884       12                      MATCH_LEN - length of MATCH.
      885       13                      MATCH   - character string with possible wildcarding.
      886       14             OUTPUT:  Nothing.
      887       15             DESCRIPTION:
      888       16                  ASB$WILD_MATCH is a pass through routine to the shared library
      889       17                  for the XUW services.
      890       18                  If X$WILDCMP altrets with anything other than a no match
      891       19                  error, ASB$MATCH reports an error.  If X$WILDCMP altrets
      892       20                  ASB$MATCH altrets.  If X$WILDCMP returns normally, then
      893       21                  ASB$MATCH returns normally.  A normal return means ASB$MATCH
      894       22                  found a match between the string and the pattern.  If
      895       23                  ASB$MATCH altreturns then no match was found.
      896       24        */
      897       25
      898       26        /********************************************************************/
      899       27        /*    Parameters      parameters      parameters      parameters    */
      900       28        /********************************************************************/
      901       29
      902       30    1   DCL STR_LEN UBIN ;
      903       31    1   DCL MATCH_LEN UBIN ;
      904       32    1   DCL STRING CHAR(STR_LEN) ;
PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:193  
      905       33    1   DCL MATCH  CHAR(MATCH_LEN) ;
      906       34
      907       35        /********************************************************************/
      908       36        /*    includes        includes        includes        includes      */
      909       37        /********************************************************************/
      910       38
      911       39        %INCLUDE XUW_MACRO_C;
      912      174        %INCLUDE XU_PERR_C;
      913      365
      914      366           %XUW_ENTRIES;
      915      378           %XUW_WILDCARD (STCLASS = STATIC);
      916      474
      917      475        /********************************************************************/
      918      476        /*              static data       static data       static data     */
      919      477        /********************************************************************/
      920      478
      921      479    1   DCL I   UBIN;
      922      480
      923      481        /********************************************************************/
      924      482        /*    Procedure       procedure       procedure       procedure     */
      925      483        /********************************************************************/
      926      484
      927      485    1   CALL INDEX (I, '?', MATCH)

    485  1 000002   200005 470500                    LDP0    @MATCH_LEN,,AUTO
         1 000003   000000 720100                    LXL0    0,,PR0
         1 000004   200006 471500                    LDP1    @MATCH,,AUTO
         1 000005   000000 124540                    SCM     mask='000'O
         1 000006   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         1 000007   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000010   200007 000100                    ARG     I,,AUTO
         1 000011   000035 606400 1                  TTN     s:498

      928      486    2   WHENRETURN DO;

      929      487    2      XUW_WILDCARD.INPUT_ = VECTOR (STRING);

PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:194  
    487  1 000012   200003 473500                    LDP3    @STR_LEN,,AUTO
         1 000013   300000 721100                    LXL1    0,,PR3
         1 000014   000000 635011                    EAA     0,X1
         1 000015   000002 771000                    ARL     2
         1 000016   000140 135007                    SBLA    96,DL
         1 000017   200004 236100                    LDQ     @STRING,,AUTO
         1 000020   000002 757000 0                  STAQ    XUW_WILDCARD+2

      930      488    2      XUW_WILDCARD.PATTERN_ = VECTOR (MATCH);

    488  1 000021   000000 720100                    LXL0    0,,PR0
         1 000022   000000 635010                    EAA     0,X0
         1 000023   000002 771000                    ARL     2
         1 000024   000140 135007                    SBLA    96,DL
         1 000025   200006 236100                    LDQ     @MATCH,,AUTO
         1 000026   000000 757000 0                  STAQ    XUW_WILDCARD

      931      489    2      CALL X$WILDCMP (XUW_WILDCARD)

    489  1 000027   000001 630400 2                  EPPR0   1
         1 000030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000031   000000 701000 xent               TSX1    X$WILDCMP
         1 000032   000034 702000 1                  TSX2    s:494

      932      490    3      WHENRETURN DO;

      933      491    3         RETURN;

    491  1 000033   000000 702200 xent               TSX2  ! X66_ARET

      934      492    3         END;
      935      493    3      WHENALTRETURN DO;

      936      494    3         ALTRETURN;

    494  1 000034   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:195  
      937      495    3         END;
      938      496    2      END;
      939      497    2   WHENALTRETURN DO;

      940      498    2      IF (SUBSTR (STRING, 0, STR_LEN) = SUBSTR (MATCH, 0, MATCH_LEN))

    498  1 000035   200003 470500                    LDP0    @STR_LEN,,AUTO
         1 000036   000000 720100                    LXL0    0,,PR0
         1 000037   200005 471500                    LDP1    @MATCH_LEN,,AUTO
         1 000040   100000 721100                    LXL1    0,,PR1
         1 000041   200004 473500                    LDP3    @STRING,,AUTO
         1 000042   200006 474500                    LDP4    @MATCH,,AUTO
         1 000043   040140 106540                    CMPC    fill='040'O
         1 000044   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         1 000045   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         1 000046   000050 601000 1                  TNZ     s:503

      941      499    3      THEN DO;

      942      500    3         RETURN;

    500  1 000047   000000 702200 xent               TSX2  ! X66_ARET

      943      501    3         END;
      944      502    3      ELSE DO;

      945      503    3         ALTRETURN;

    503  1 000050   000000 702200 xent               TSX2  ! X66_AALT
      946      504    3         END;
      947      505    2      END;
      948      506    1   END ASB$WILD_MATCH;

PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:196  
--  Include file information  --

   XU_PERR_C.:E05TOU  is referenced.
   XUW_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASB$WILD_MATCH.
PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:197  

 **** Variables and constants ****

  ****  Section 000  Data  ASB$WILD_MATCH

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 XUW_WILDCARD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @MATCH                     5-0-0/w PTR         r     1 @MATCH_LEN
     4-0-0/w PTR         r     1 @STRING                    3-0-0/w PTR         r     1 @STR_LEN
     7-0-0/w UBIN        r     1 I                         *0-0-0/c ACHR        r     1 MATCH
    *0-0-0/w UBIN        r     1 MATCH_LEN                 *0-0-0/c ACHR        r     1 STRING
    *0-0-0/w UBIN        r     1 STR_LEN


   Procedure ASB$WILD_MATCH requires 41 words for executable code.
   Procedure ASB$WILD_MATCH requires 8 words of local(AUTO) storage.

    No errors detected in file ASB$SEARCH.:E05TSI    .
PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:198  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=ASB$WILD_MATCH File=ASB$SEARCH.:E05TSI                        TUE 07/29/97 09:36 Page:199  
          MINI XREF LISTING

I
       479**DCL       485<<CALLBLT
MATCH
        33**DCL         6--PROC      485>>CALLBLT   488--ASSIGN    498>>IF
MATCH_LEN
        31**DCL         6--PROC       33--IMP-SIZ   485>>CALLBLT   488>>ASSIGN    498>>IF        498>>IF
STRING
        32**DCL         6--PROC      487--ASSIGN    498>>IF
STR_LEN
        30**DCL         6--PROC       32--IMP-SIZ   487>>ASSIGN    498>>IF        498>>IF
X$WILDCMP
       369**DCL-ENT   489--CALL
XUW_WILDCARD
       440**DCL       489<>CALL
XUW_WILDCARD.INPUT_
       446**DCL       487<<ASSIGN
XUW_WILDCARD.PATTERN_
       441**DCL       488<<ASSIGN
