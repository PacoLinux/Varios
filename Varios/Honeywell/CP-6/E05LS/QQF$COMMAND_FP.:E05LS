VERSION E05

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 1
         1       1       *M* QQF$COMMAND_FP - TP Command Forms Program
         2       2       *T***********************************************************
         3       3       *T*                                                         *
         4       4       *T* Copyright (c) Bull HN Information Systems Inc., 1997    *
         5       5       *T*                                                         *
         6       6       *T***********************************************************
         7       7        IDENTIFICATION DIVISION.
         8       8       *------------------------
         9       9        PROGRAM-ID.  COMMAND-FP.
        10      10
        11      11        ENVIRONMENT DIVISION.
        12      12       *---------------------
        13      13        INPUT-OUTPUT SECTION.
        14      14       *---------------------
        15      15        FILE-CONTROL.
        16      16       *-------------
        17      17            SELECT XACTION      ASSIGN TO COMMUNICATIONS
        18      18                                TYPE IS XACTION-MSGTYP.
        19      19            SELECT SCREEN ASSIGN TO TERMINAL-IO.
        20      20            SELECT MSGG         ASSIGN TO COMMUNICATIONS
        21      21                                TYPE IS MSGG-MSGTYP
        22      22                                RECEIVES REPORT ON INPUT.
        23      23            SELECT PAGE-1-TTY   ASSIGN TO TERMINAL-IO.
        24      24            SELECT PAGE-2-TTY   ASSIGN TO TERMINAL-IO.
        25      25
        26      26        DATA DIVISION.
        27      27       *--------------
        28      28        FILE SECTION.
        29      29       *-------------
        30      30        FD  XACTION.
        31      31       *------------
        32      32        01 BEGIN-XACTION.
        33      33           02 FILLER                                 PIC X(03).
        34      34           02 BEGIN-MSGTYP                           PIC X(08).
        35      35           02 FILLER                                 PIC X(72).
        36      36
        37      37        01 WRITE-XACTION.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 2
        38      38           02 FUNCTION                               PIC 9(03).
        39      39           02 TEXT                                   PIC X(80).
        40      40
        41      41        01 COMMAND-XACTION.
        42      42           02 TEXT                                   PIC X(80).
        43      43           02 FILLER                                 PIC X(03).
        44      44
        45      45        FD  MSGG.
        46      46       *---------
        47      47        01 MSGG-RECORD.
        48      48           02 FILLER                                 PIC X(03).
        49      49           02 TEXT                                   PIC X(80).
        50      50
        51      51        FD SCREEN
        52      52       *---------
        53      53            FRAMES ARE TITLES,
        54      54                       COMMAND-INPUT,
        55      55                       MSG-OUTPUT.
        56      56
        57      57        FD PAGE-1-TTY
        58      58       *-------------
        59      59            FRAMES ARE TITLES-TTY,
        60      60                       COMMAND-INPUT-TTY,
        61      61                       MSG-OUTPUT-ON-PAGE-1-TTY.
        62      62
        63      63        FD PAGE-2-TTY
        64      64       *-------------
        65      65            FRAME IS MSG-OUTPUT-ON-PAGE-2-TTY.
        66      66
        67      67        WORKING-STORAGE SECTION.
        68      68       *------------------------
        69      69        01 CLEAR-COMMAND-SW            PIC X.
        70      70           88 CLEAR-COMMAND            VALUE  IS "Y".
        71      71        01 SAVE-COMMAND                PIC X(79) FIELD COMMAND.
        72      72        01 SAVE-COMMAND-TTY            PIC X(79) FIELD COMMAND-TTY.
        73      73        01 SAVE-MESSAGE                PIC X(80).
        74      74        01 MESSAGE-WINDOW.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 3
        75      75           02 MESSAGE-DETAILS OCCURS 16 TIMES.
        76      76              03 MESSAGE-LINE          PIC X(80) FIELD A-LINE.
        77      77        01 MESSAGE-WINDOW-PAGE-1.
        78      78           02 MESSAGE-DETAILS OCCURS 20 TIMES.
        79      79             03 MESSAGE-LINE-ON-PAGE-1 PIC X(80) FIELD A-LINE-ON-PAGE-1.
        80      80        01 MESSAGE-WINDOW-PAGE-2.
        81      81           02 MESSAGE-DETAILS OCCURS 24 TIMES.
        82      82             03 MESSAGE-LINE-ON-PAGE-2 PIC X(80) FIELD A-LINE-ON-PAGE-2.
        83      83        01 TITLES-UP-FLAG              PIC 9(01) VALUE 0.
        84      84       *01 STAND-ALONE-PRINTER-FLAG    PIC 9(01) VALUE 0.
        85      85        01 MORE-MSGS-FLAG              PIC 9(01) VALUE 0.
        86      86        01 LINES-DISPLAYED             PIC 9(02) VALUE 0.
        87      87        01 XACTION-MSGTYP              PIC X(08).
        88      88        01 MSGG-MSGTYP                 PIC X(08) VALUE "MSGG".
        89      89        01 FIRST-TIME-THROUGH-FLAG     PIC 9(01) VALUE 1.
        90      90        88 FIRST-TIME-THROUGH                    VALUE 1.
        91      91        01 FIRST-READ-FLAG             PIC 9(01) VALUE 1.
        92      92        88 FIRST-READ                            VALUE 1.
        93      93        01 GOT-HEADER-FLAG             PIC 9(01) VALUE 0.
        94      94        88 GOT-HEADER                            VALUE 1.
        95      95        01 STARTUP-FLAG                PIC 9(01) VALUE 1.
        96      96        88 STARTUP                               VALUE 1.
        97      97        01 ALREADY-BEEN-PROMPTED-FLAG  PIC 9(01) VALUE 0.
        98      98        88 ALREADY-BEEN-PROMPTED                 VALUE 1.
        99      99        01 PAGE-1-TTY-IS-OPEN-FLAG     PIC 9(01) VALUE 0.
       100     100        88 PAGE-1-TTY-IS-OPEN                    VALUE 1.
       101     101        01 PAGE-2-TTY-IS-OPEN-FLAG     PIC 9(01) VALUE 0.
       102     102        88 PAGE-2-TTY-IS-OPEN                    VALUE 1.
       103     103        01 TERMINAL-INFO.
       104     104           02 FILLER                   PIC X(30).
       105     105           02 NODE-PORT                PIC X(08).
       106     106           02 FILLER                   PIC X(01).
       107     107           02 DEVICE-TYPE              PIC 9.
       108     108           88 DEVICE-IS-HARDCOPY       VALUE 1.
       109     109           02 CONTROLLER-DEVICE        PIC X(08).
       110     110        01 LINE-INFO-BUF.
       111     111           02 T-NODE-PORT              PIC X(08).
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 4
       112     112           02 T-CONTROLLER-DEVICE      PIC X(08).
       113     113
       114     114        FRAME SECTION.
       115     115       *--------------
       116     116        FR TITLES.
       117     117       *----------
       118     118        01 CONSTANT-TITLES-RECORD      OUTPUT.
       119     119           02 FILLER                   PIC X(26) POSITION IS 1, 1
       120     120              CONSTANT VALUE "CP6 Transaction Processing".
       121     121           02 FILLER                   PIC X(01) POSITION IS 3, 1
       122     122              CONSTANT VALUE IS "?".
       123     123
       124     124        FR COMMAND-INPUT.
       125     125       *-----------------
       126     126        01 COMMAND-RECORD              INPUT.
       127     127           02 COMMAND                  PIC X(72) POSITION IS 3, 3
       128     128                                       ENTRY-REQUIRED.
       129     129
       130     130        FR MSG-OUTPUT
       131     131       *-------------
       132     132            ORIGIN IS LINE 5 COLUMN 1.
       133     133
       134     134        01 DETAIL-LINES                OUTPUT.
       135     135           02 DETAIL-ITEMS REPEATS 16 TIMES.
       136     136              03 A-LINE                PIC X(80) POSITION IS 1, 1.
       137     137
       138     138        FR MSG-OUTPUT-ON-PAGE-1-TTY
       139     139       *---------------------------
       140     140             ORIGIN IS LINE 4 COLUMN 1.
       141     141        01 A-SPACE                     OUTPUT
       142     142                                       PIC X(01) POSITION IS 1, 1
       143     143              CONSTANT VALUE SPACE.
       144     144        01 DETAIL-LINES-ON-PAGE-1      OUTPUT.
       145     145           02 DETAIL-ITEMS REPEATS 20 TIMES.
       146     146              03 A-LINE-ON-PAGE-1      PIC X(72) POSITION IS 2, 1.
       147     147
       148     148        FR MSG-OUTPUT-ON-PAGE-2-TTY.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 5
       149     149       *----------------------------
       150     150        01 DETAIL-LINES-ON-PAGE-2      OUTPUT.
       151     151           02 DETAIL-ITEMS REPEATS 24 TIMES.
       152     152              03 A-LINE-ON-PAGE-2      PIC X(72) POSITION IS 1, 1.
       153     153
       154     154        FR TITLES-TTY.
       155     155       *--------------
       156     156        01 CP6-LOGO                    OUTPUT
       157     157                                       PIC X(26) POSITION IS 1, 1
       158     158              CONSTANT VALUE "CP6 Transaction Processing".
       159     159        01 PROMPT-TTY                  OUTPUT
       160     160                                       PIC X(01) POSITION IS 3, 1
       161     161              CONSTANT VALUE IS "?".
       162     162
       163     163        FR COMMAND-INPUT-TTY.
       164     164       *---------------------
       165     165        01 COMMAND-RECORD-TTY          I-O.
       166     166           02 COMMAND-TTY              PIC X(70) POSITION IS 3, 3
       167     167                                       ENTRY-REQUIRED.

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 6
       168     168       /
       169     169        PROCEDURE DIVISION.
       170     170       *-------------------
       171     171        000-INIT.
       172     172       *---------
       173     173
       174     174       * ACCEPT x FROM TERMINAL-ATTRIBUTES.
       175     175       * IF blorp MOVE 1 TO STAND-ALONE-PRINTER-FLAG.
       176     176       *
       177     177            OPEN I-O XACTION, MSGG.
       178     178            ACCEPT TERMINAL-INFO FROM TERMINAL-ATTRIBUTES.
       179     179            MOVE "*IAMRDY" TO XACTION-MSGTYP.
       180     180            MOVE NODE-PORT TO T-NODE-PORT.
       181     181            MOVE CONTROLLER-DEVICE TO T-CONTROLLER-DEVICE.
       182     182            MOVE LINE-INFO-BUF TO COMMAND-XACTION.
       183     183            WRITE COMMAND-XACTION.
       184     184            IF DEVICE-IS-HARDCOPY
       185     185              GO TO 100-READ-TPA-TTY.
       186     186
       187     187        100-READ-TPA.
       188     188       *-------------
       189     189            MOVE SPACES TO WRITE-XACTION.
       190     190            PERFORM 150-READ-XACTION.
       191     191
       192     192            GO TO 200-BEGIN,
       193     193              300-DONT-CLEAR-LINE-PRINT-MSG,
       194     194              600-READ-COMMAND,
       195     195              700-REPORT-STATIONMAX,
       196     196              400-PRINT-MSG,
       197     197              DEPENDING ON FUNCTION IN WRITE-XACTION.
       198     198
       199     199        150-READ-XACTION.
       200     200       *-----------------
       201     201            IF (FIRST-READ) OR (STARTUP)
       202     202               READ XACTION
       203     203               MOVE 0 TO FIRST-READ-FLAG
       204     204            ELSE
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 7
       205     205               READ XACTION NO DATA
       206     206                  GO TO 600-READ-COMMAND.
       207     207
       208     208
       209     209
       210     210        200-BEGIN.
       211     211       *----------
       212     212       *    LOAD BEGIN-MSGTYP IN BEGIN-XACTION BY TYPE
       213     213       *      NO PROGRAM GO TO 600-READ-COMMAND.
       214     214       *
       215     215       *    For C00, just exit.
       216     216       *    TPA takes care of the rest.
       217     217       *    Trust me.
       218     218            IF (STARTUP) AND (GOT-HEADER)
       219     219                STOP "Hit return to continue".
       220     220            STOP RUN.
       221     221
       222     222        300-DONT-CLEAR-LINE-PRINT-MSG.
       223     223       *-------------------------
       224     224            MOVE "N" TO CLEAR-COMMAND-SW.
       225     225       *
       226     226       * The side efect of the "GO TO" is that the NEXT
       227     227       * line to be executed is 400-PRINT-MSG, which is
       228     228       * exactly where I was going to "GO TO".
       229     229
       230     230        400-PRINT-MSG.
       231     231       *--------------
       232     232            IF (STARTUP)
       233     233               MOVE 1 TO GOT-HEADER-FLAG.
       234     234            PERFORM 800-TITLE-SETUP.
       235     235            MOVE TEXT IN WRITE-XACTION TO SAVE-MESSAGE.
       236     236            PERFORM 800-PRINT-LINE.
       237     237            GO TO 100-READ-TPA.
       238     238
       239     239        600-READ-COMMAND.
       240     240       *-----------------
       241     241
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 8
       242     242       *
       243     243       * IF STAND-ALONE-PRINTER-FLAG
       244     244       *   MOVE "*RAS" TO XACTION-MSGTYP
       245     245       *   WRITE COMMAND-XACTION
       246     246       * GO TO 100-READ-TPA.
       247     247       *
       248     248       *  We have received permission from TPA to accept commands
       249     249       *  therefore we are done with STARTUP.
       250     250               MOVE 0 TO STARTUP-FLAG.
       251     251            PERFORM 800-TITLE-SETUP.
       252     252            MOVE 1 TO MORE-MSGS-FLAG.
       253     253            PERFORM 800-GET-PRINT-MSG THRU
       254     254                800-GET-PRINT-MSG-EXIT UNTIL
       255     255                MORE-MSGS-FLAG = 0.
       256     256
       257     257            ENABLE INPUT COMMAND-INPUT.
       258     258            IF CLEAR-COMMAND THEN
       259     259               CLEAR INPUT COMMAND-INPUT.
       260     260            MOVE "Y" TO CLEAR-COMMAND-SW.
       261     261            ACCEPT COMMAND.
       262     262            VERIFY SAVE-COMMAND.
       263     263            DISABLE INPUT COMMAND.
       264     264            CLEAR I-O FOR MSG-OUTPUT.
       265     265            MOVE 0 TO LINES-DISPLAYED.
       266     266            MOVE "*TPCMD" TO XACTION-MSGTYP.
       267     267            MOVE SAVE-COMMAND TO TEXT IN COMMAND-XACTION.
       268     268            WRITE COMMAND-XACTION.
       269     269            MOVE 1 TO FIRST-READ-FLAG.
       270     270            GO TO 100-READ-TPA.
       271     271
       272     272
       273     273        700-REPORT-STATIONMAX.
       274     274       *----------------------
       275     275            STOP PAUSING FOR 1 SECONDS
       276     276                 POSTING
       277     277                 "No more TP users allowed.  Maximum station count exceed
       278     278       -          "ed.".
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 9
       279     279            STOP RUN.
       280     280
       281     281        800-TITLE-SETUP.
       282     282       *----------------
       283     283            IF TITLES-UP-FLAG = 0
       284     284              OPEN I-O SCREEN
       285     285              ACTIVATE SCREEN
       286     286              MOVE 1 TO TITLES-UP-FLAG
       287     287              DISABLE INPUT COMMAND-INPUT
       288     288              WRITE CONSTANT-TITLES-RECORD.
       289     289
       290     290        800-PRINT-LINE.
       291     291       *--------------
       292     292            ADD 1 TO LINES-DISPLAYED.
       293     293            IF LINES-DISPLAYED = 17
       294     294              MOVE 1 TO LINES-DISPLAYED
       295     295              STOP "Hit return to continue"
       296     296              CLEAR I-O FOR MSG-OUTPUT.
       297     297
       298     298            MOVE SAVE-MESSAGE TO MESSAGE-LINE(LINES-DISPLAYED).
       299     299            PRESENT MESSAGE-LINE(LINES-DISPLAYED).
       300     300            WRITE DETAIL-LINES.
       301     301
       302     302        800-GET-PRINT-MSG.
       303     303       *------------------
       304     304            MOVE SPACES TO MSGG-RECORD.
       305     305            READ MSGG NO DATA
       306     306              MOVE 0 TO MORE-MSGS-FLAG
       307     307              GO TO 800-GET-PRINT-MSG-EXIT.
       308     308
       309     309            MOVE TEXT IN MSGG-RECORD TO SAVE-MESSAGE.
       310     310            PERFORM 800-PRINT-LINE.
       311     311
       312     312        800-GET-PRINT-MSG-EXIT.
       313     313       *-----------------------
       314     314            EXIT.
       315     315
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 10
       316     316        100-READ-TPA-TTY.
       317     317       *-----------------
       318     318            MOVE SPACES TO WRITE-XACTION.
       319     319            PERFORM 150-READ-XACTION-TTY.
       320     320
       321     321            GO TO 200-BEGIN-TTY,
       322     322              400-PRINT-MSG-TTY,
       323     323              600-READ-COMMAND-TTY,
       324     324              700-REPORT-STATIONMAX-TTY,
       325     325              DEPENDING ON FUNCTION IN WRITE-XACTION.
       326     326
       327     327        150-READ-XACTION-TTY.
       328     328       *---------------------
       329     329            IF (FIRST-READ) OR (STARTUP)
       330     330               READ XACTION
       331     331               MOVE 0 TO FIRST-READ-FLAG
       332     332            ELSE
       333     333               READ XACTION NO DATA
       334     334                  GO TO 600-READ-COMMAND-TTY.
       335     335
       336     336
       337     337
       338     338        200-BEGIN-TTY.
       339     339       *--------------
       340     340       *    LOAD BEGIN-MSGTYP IN BEGIN-XACTION BY TYPE
       341     341       *      NO PROGRAM GO TO 600-READ-COMMAND-TTY.
       342     342            IF (STARTUP) AND (GOT-HEADER)
       343     343                STOP "Hit return to continue".
       344     344            STOP RUN.
       345     345
       346     346        400-PRINT-MSG-TTY.
       347     347       *------------------
       348     348            IF (STARTUP)
       349     349               MOVE 1 TO GOT-HEADER-FLAG.
       350     350            PERFORM 800-TITLE-SETUP-TTY.
       351     351            MOVE TEXT IN WRITE-XACTION TO SAVE-MESSAGE.
       352     352            PERFORM 800-PRINT-LINE-TTY.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 11
       353     353            GO TO 100-READ-TPA-TTY.
       354     354
       355     355        600-READ-COMMAND-TTY.
       356     356       *---------------------
       357     357
       358     358       *
       359     359       * IF STAND-ALONE-PRINTER-FLAG
       360     360       *   MOVE "*RAS" TO XACTION-MSGTYP
       361     361       *   WRITE COMMAND-XACTION
       362     362       * GO TO 100-READ-TPA-TTY.
       363     363       *
       364     364       *  We have received permission from TPA to accept commands
       365     365       *  therefore we are done with STARTUP.
       366     366               MOVE 0 TO STARTUP-FLAG.
       367     367            PERFORM 800-TITLE-SETUP-TTY.
       368     368            MOVE 1 TO MORE-MSGS-FLAG.
       369     369            PERFORM 800-GET-PRINT-MSG-TTY THRU
       370     370                800-GET-PRINT-MSG-EXIT-TTY UNTIL
       371     371                MORE-MSGS-FLAG = 0.
       372     372            IF NOT PAGE-1-TTY-IS-OPEN
       373     373            THEN
       374     374              MOVE 1 TO PAGE-1-TTY-IS-OPEN-FLAG
       375     375              MOVE 0 TO LINES-DISPLAYED
       376     376              IF PAGE-2-TTY-IS-OPEN
       377     377              THEN
       378     378                MOVE 0 TO PAGE-2-TTY-IS-OPEN-FLAG
       379     379                WRITE PAGE
       380     380                CLOSE PAGE-2-TTY
       381     381                OPEN I-O PAGE-1-TTY
       382     382                ACTIVATE PAGE-1-TTY
       383     383              ELSE
       384     384                OPEN I-O PAGE-1-TTY
       385     385                ACTIVATE PAGE-1-TTY.
       386     386            IF LINES-DISPLAYED > 0 AND NOT ALREADY-BEEN-PROMPTED
       387     387            THEN
       388     388              WRITE PAGE.
       389     389            WRITE PROMPT-TTY.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 12
       390     390            ENABLE INPUT COMMAND-INPUT-TTY.
       391     391            ACCEPT COMMAND-TTY.
       392     392            VERIFY SAVE-COMMAND-TTY.
       393     393            MOVE 1 TO ALREADY-BEEN-PROMPTED-FLAG.
       394     394            CLEAR ALL I-O FOR CP6-LOGO,
       395     395                              PROMPT-TTY,
       396     396                              DETAIL-LINES-ON-PAGE-1.
       397     397            MOVE 0 TO LINES-DISPLAYED.
       398     398            DISABLE INPUT COMMAND-TTY.
       399     399            MOVE "*TPCMD" TO XACTION-MSGTYP.
       400     400            MOVE SAVE-COMMAND-TTY TO TEXT IN COMMAND-XACTION.
       401     401            WRITE COMMAND-XACTION.
       402     402            MOVE 1 TO FIRST-READ-FLAG.
       403     403            GO TO 100-READ-TPA-TTY.
       404     404
       405     405
       406     406        700-REPORT-STATIONMAX-TTY.
       407     407       *--------------------------
       408     408            STOP PAUSING FOR 1 SECONDS
       409     409                 POSTING
       410     410                 "No more TP users allowed.  Maximum station count exceed
       411     411       -          "ed.".
       412     412            STOP RUN.
       413     413
       414     414        800-TITLE-SETUP-TTY.
       415     415       *--------------------
       416     416            IF FIRST-TIME-THROUGH
       417     417            THEN
       418     418              MOVE 0 TO FIRST-TIME-THROUGH-FLAG
       419     419              OPEN I-O PAGE-1-TTY
       420     420              MOVE 1 TO PAGE-1-TTY-IS-OPEN-FLAG
       421     421              ACTIVATE PAGE-1-TTY
       422     422              WRITE CP6-LOGO
       423     423              DISABLE INPUT COMMAND-INPUT-TTY.
       424     424
       425     425        800-PRINT-LINE-TTY.
       426     426       *------------------
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 13
       427     427            IF LINES-DISPLAYED = 0
       428     428            THEN
       429     429              WRITE A-SPACE.
       430     430            ADD 1 TO LINES-DISPLAYED.
       431     431            IF PAGE-1-TTY-IS-OPEN
       432     432            THEN
       433     433              IF LINES-DISPLAYED = 21
       434     434              THEN
       435     435                MOVE 1 TO LINES-DISPLAYED
       436     436                WRITE PAGE
       437     437                CLOSE PAGE-1-TTY
       438     438                MOVE 0 TO PAGE-1-TTY-IS-OPEN-FLAG
       439     439                OPEN OUTPUT PAGE-2-TTY
       440     440                MOVE 1 TO PAGE-2-TTY-IS-OPEN-FLAG
       441     441                ACTIVATE PAGE-2-TTY
       442     442                PERFORM 800-WRITE-TO-PAGE-2-TTY
       443     443              ELSE
       444     444                PERFORM 800-WRITE-TO-PAGE-1-TTY
       445     445            ELSE
       446     446              IF PAGE-2-TTY-IS-OPEN
       447     447              THEN
       448     448                IF LINES-DISPLAYED = 25
       449     449                THEN
       450     450                  MOVE 1 TO LINES-DISPLAYED
       451     451                  WRITE PAGE
       452     452                  PERFORM 800-WRITE-TO-PAGE-2-TTY
       453     453                ELSE
       454     454                  PERFORM 800-WRITE-TO-PAGE-2-TTY.
       455     455
       456     456        800-WRITE-TO-PAGE-1-TTY.
       457     457       *------------------------
       458     458            MOVE SAVE-MESSAGE TO MESSAGE-LINE-ON-PAGE-1
       459     459                                 (LINES-DISPLAYED).
       460     460            PRESENT MESSAGE-LINE-ON-PAGE-1 (LINES-DISPLAYED).
       461     461            WRITE DETAIL-LINES-ON-PAGE-1.
       462     462
       463     463        800-WRITE-TO-PAGE-2-TTY.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 14
       464     464       *------------------------
       465     465            MOVE SAVE-MESSAGE TO MESSAGE-LINE-ON-PAGE-2
       466     466                                 (LINES-DISPLAYED).
       467     467            PRESENT MESSAGE-LINE-ON-PAGE-2 (LINES-DISPLAYED).
       468     468            WRITE DETAIL-LINES-ON-PAGE-2.
       469     469
       470     470        800-GET-PRINT-MSG-TTY.
       471     471       *----------------------
       472     472            MOVE SPACES TO MSGG-RECORD.
       473     473            READ MSGG NO DATA
       474     474              MOVE 0 TO MORE-MSGS-FLAG
       475     475              GO TO 800-GET-PRINT-MSG-EXIT-TTY.
       476     476
       477     477            MOVE TEXT IN MSGG-RECORD TO SAVE-MESSAGE.
       478     478            PERFORM 800-PRINT-LINE-TTY.
       479     479
       480     480        800-GET-PRINT-MSG-EXIT-TTY.
       481     481       *---------------------------
       482     482            EXIT.

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 15
         1       1       *M* QQF$COMMAND_FP - TP Command Forms Program
         2       2       *T***********************************************************
         3       3       *T*                                                         *
         4       4       *T* Copyright (c) Bull HN Information Systems Inc., 1997    *
         5       5       *T*                                                         *
         6       6       *T***********************************************************
         7       7        IDENTIFICATION DIVISION.
         8       8       *------------------------
         9       9        PROGRAM-ID.  COMMAND-FP.
        10      10
        11      11        ENVIRONMENT DIVISION.
        12      12       *---------------------
        13      13        INPUT-OUTPUT SECTION.
        14      14       *---------------------
        15      15        FILE-CONTROL.
        16      16       *-------------
        17      17            SELECT XACTION      ASSIGN TO COMMUNICATIONS
        18      18                                TYPE IS XACTION-MSGTYP.
        19      19            SELECT SCREEN ASSIGN TO TERMINAL-IO.
        20      20            SELECT MSGG         ASSIGN TO COMMUNICATIONS
        21      21                                TYPE IS MSGG-MSGTYP
        22      22                                RECEIVES REPORT ON INPUT.
        23      23            SELECT PAGE-1-TTY   ASSIGN TO TERMINAL-IO.
        24      24            SELECT PAGE-2-TTY   ASSIGN TO TERMINAL-IO.
        25      25
        26      26        DATA DIVISION.

                                    00B5 p  <-------  DEFINE  CURRENT-FORM
                            p 00B5  0003              DATA    X'0003'
                            p 00B6  001E              DATA    X'001E'
                            p 00B7  0001 d            ADRL    data+X'0001'

                                    00B8 p  <-------  DEFINE  CURRENT-FRAME
                            p 00B8  0003              DATA    X'0003'
                            p 00B9  001E              DATA    X'001E'
                            p 00BA  0010 d            ADRL    data+X'0010'

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 16
                                    00BB p  <-------  DEFINE  CURRENT-FIELD
                            p 00BB  0003              DATA    X'0003'
                            p 00BC  001E              DATA    X'001E'
                            p 00BD  001F d            ADRL    data+X'001F'

                                    00BE p  <-------  DEFINE  RETRY
                            p 00BE  0000              DATA    X'0000'
                            p 00BF  0100              DATA    X'0100'
                            p 00C0  002E d            ADRL    data+X'002E'

                                    00C1 p  <-------  DEFINE  VERIFY_BUFFER_1
                            p 00C1  0003              DATA    X'0003'
                            p 00C2  0051              DATA    X'0051'
                            p 00C3  002F d            ADRL    data+X'002F'

        27      27       *--------------
        28      28        FILE SECTION.
        29      29       *-------------
        30      30        FD  XACTION.
        31      31       *------------
        32      32        01 BEGIN-XACTION.
        33      33           02 FILLER                                 PIC X(03).
        34      34           02 BEGIN-MSGTYP                           PIC X(08).
        35      35           02 FILLER                                 PIC X(72).
        36      36
        37      37        01 WRITE-XACTION.

                                    00C4 p  <-------  DEFINE  WRITE-XACTION
                            p 00C4  0003              DATA    X'0003'
                            p 00C5  0053              DATA    X'0053'
                            p 00C6  0058 d            ADRL    data+X'0058'

        38      38           02 FUNCTION                               PIC 9(03).

                                    00C7 p  <-------  DEFINE  FUNCTION
                            p 00C7  0000              DATA    X'0000'
                            p 00C8  0300              DATA    X'0300'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 17
                            p 00C9  0058 d            ADRL    data+X'0058'

        39      39           02 TEXT                                   PIC X(80).

                                    00CA p  <-------  DEFINE  TEXT
                            p 00CA  0003              DATA    X'0003'
                            p 00CB  8050              DATA    X'8050'       ' P'
                            p 00CC  0059 d            ADRL    data+X'0059'

        40      40
        41      41        01 COMMAND-XACTION.

                                    00CD p  <-------  DEFINE  COMMAND-XACTION
                            p 00CD  0003              DATA    X'0003'
                            p 00CE  0053              DATA    X'0053'
                            p 00CF  0058 d            ADRL    data+X'0058'

        42      42           02 TEXT                                   PIC X(80).

                                    00D0 p  <-------  DEFINE  TEXT
                            p 00D0  0003              DATA    X'0003'
                            p 00D1  0050              DATA    X'0050'
                            p 00D2  0058 d            ADRL    data+X'0058'

        43      43           02 FILLER                                 PIC X(03).
        44      44
        45      45        FD  MSGG.
        46      46       *---------
        47      47        01 MSGG-RECORD.

                                    00D3 p  <-------  DEFINE  MSGG-RECORD
                            p 00D3  0003              DATA    X'0003'
                            p 00D4  0053              DATA    X'0053'
                            p 00D5  0082 d            ADRL    data+X'0082'

        48      48           02 FILLER                                 PIC X(03).
        49      49           02 TEXT                                   PIC X(80).
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 18

                                    00D6 p  <-------  DEFINE  TEXT
                            p 00D6  0003              DATA    X'0003'
                            p 00D7  8050              DATA    X'8050'       ' P'
                            p 00D8  0083 d            ADRL    data+X'0083'

        50      50
        51      51        FD SCREEN
        52      52       *---------
        53      53            FRAMES ARE TITLES,
        54      54                       COMMAND-INPUT,
        55      55                       MSG-OUTPUT.
        56      56
        57      57        FD PAGE-1-TTY
        58      58       *-------------
        59      59            FRAMES ARE TITLES-TTY,
        60      60                       COMMAND-INPUT-TTY,
        61      61                       MSG-OUTPUT-ON-PAGE-1-TTY.
        62      62
        63      63        FD PAGE-2-TTY
        64      64       *-------------
        65      65            FRAME IS MSG-OUTPUT-ON-PAGE-2-TTY.
        66      66
        67      67        WORKING-STORAGE SECTION.
        68      68       *------------------------
        69      69        01 CLEAR-COMMAND-SW            PIC X.

                                    00D9 p  <-------  DEFINE  CLEAR-COMMAND-SW
                            p 00D9  0003              DATA    X'0003'
                            p 00DA  0001              DATA    X'0001'
                            p 00DB  09B2 d            ADRL    data+X'09B2'

        70      70           88 CLEAR-COMMAND            VALUE  IS "Y".
        71      71        01 SAVE-COMMAND                PIC X(79) FIELD COMMAND.

                                    00DC p  <-------  DEFINE  SAVE-COMMAND
                            p 00DC  0003              DATA    X'0003'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 19
                            p 00DD  004F              DATA    X'004F'
                            p 00DE  09B3 d            ADRL    data+X'09B3'

        72      72        01 SAVE-COMMAND-TTY            PIC X(79) FIELD COMMAND-TTY.

                                    00DF p  <-------  DEFINE  SAVE-COMMAND-TTY
                            p 00DF  0003              DATA    X'0003'
                            p 00E0  004F              DATA    X'004F'
                            p 00E1  09DB d            ADRL    data+X'09DB'

        73      73        01 SAVE-MESSAGE                PIC X(80).

                                    00E2 p  <-------  DEFINE  SAVE-MESSAGE
                            p 00E2  0003              DATA    X'0003'
                            p 00E3  0050              DATA    X'0050'
                            p 00E4  0A03 d            ADRL    data+X'0A03'

        74      74        01 MESSAGE-WINDOW.
        75      75           02 MESSAGE-DETAILS OCCURS 16 TIMES.
        76      76              03 MESSAGE-LINE          PIC X(80) FIELD A-LINE.

                                    00E5 p  <-------  DEFINE  MESSAGE-LINE
                            p 00E5  0013              DATA    X'0013'
                            p 00E6  0050              DATA    X'0050'
                            p 00E7  0A2B d            ADRL    data+X'0A2B'
                            p 00E8  0010              DATA    X'0010'
                            p 00E9  0050              DATA    X'0050'

        77      77        01 MESSAGE-WINDOW-PAGE-1.
        78      78           02 MESSAGE-DETAILS OCCURS 20 TIMES.
        79      79             03 MESSAGE-LINE-ON-PAGE-1 PIC X(80) FIELD A-LINE-ON-PAGE-1.

                                    00EA p  <-------  DEFINE  MESSAGE-LINE-ON-PAGE-1
                            p 00EA  0013              DATA    X'0013'
                            p 00EB  0050              DATA    X'0050'
                            p 00EC  0CAB d            ADRL    data+X'0CAB'
                            p 00ED  0014              DATA    X'0014'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 20
                            p 00EE  0050              DATA    X'0050'

        80      80        01 MESSAGE-WINDOW-PAGE-2.
        81      81           02 MESSAGE-DETAILS OCCURS 24 TIMES.
        82      82             03 MESSAGE-LINE-ON-PAGE-2 PIC X(80) FIELD A-LINE-ON-PAGE-2.

                                    00EF p  <-------  DEFINE  MESSAGE-LINE-ON-PAGE-2
                            p 00EF  0013              DATA    X'0013'
                            p 00F0  0050              DATA    X'0050'
                            p 00F1  0FCB d            ADRL    data+X'0FCB'
                            p 00F2  0018              DATA    X'0018'
                            p 00F3  0050              DATA    X'0050'

        83      83        01 TITLES-UP-FLAG              PIC 9(01) VALUE 0.

                                    00F4 p  <-------  DEFINE  TITLES-UP-FLAG
                            p 00F4  0000              DATA    X'0000'
                            p 00F5  0100              DATA    X'0100'
                            p 00F6  138B d            ADRL    data+X'138B'

        84      84       *01 STAND-ALONE-PRINTER-FLAG    PIC 9(01) VALUE 0.
        85      85        01 MORE-MSGS-FLAG              PIC 9(01) VALUE 0.

                                    00F7 p  <-------  DEFINE  MORE-MSGS-FLAG
                            p 00F7  0000              DATA    X'0000'
                            p 00F8  0100              DATA    X'0100'
                            p 00F9  138C d            ADRL    data+X'138C'

        86      86        01 LINES-DISPLAYED             PIC 9(02) VALUE 0.

                                    00FA p  <-------  DEFINE  LINES-DISPLAYED
                            p 00FA  0000              DATA    X'0000'
                            p 00FB  0200              DATA    X'0200'
                            p 00FC  138D d            ADRL    data+X'138D'

        87      87        01 XACTION-MSGTYP              PIC X(08).

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 21
                                    00FD p  <-------  DEFINE  XACTION-MSGTYP
                            p 00FD  0003              DATA    X'0003'
                            p 00FE  0008              DATA    X'0008'
                            p 00FF  138E d            ADRL    data+X'138E'

        88      88        01 MSGG-MSGTYP                 PIC X(08) VALUE "MSGG".

                                    0100 p  <-------  DEFINE  MSGG-MSGTYP
                            p 0100  0003              DATA    X'0003'
                            p 0101  0008              DATA    X'0008'
                            p 0102  1392 d            ADRL    data+X'1392'

        89      89        01 FIRST-TIME-THROUGH-FLAG     PIC 9(01) VALUE 1.

                                    0103 p  <-------  DEFINE  FIRST-TIME-THROUGH-FLAG
                            p 0103  0000              DATA    X'0000'
                            p 0104  0100              DATA    X'0100'
                            p 0105  1396 d            ADRL    data+X'1396'

        90      90        88 FIRST-TIME-THROUGH                    VALUE 1.
        91      91        01 FIRST-READ-FLAG             PIC 9(01) VALUE 1.

                                    0106 p  <-------  DEFINE  FIRST-READ-FLAG
                            p 0106  0000              DATA    X'0000'
                            p 0107  0100              DATA    X'0100'
                            p 0108  1397 d            ADRL    data+X'1397'

        92      92        88 FIRST-READ                            VALUE 1.
        93      93        01 GOT-HEADER-FLAG             PIC 9(01) VALUE 0.

                                    0109 p  <-------  DEFINE  GOT-HEADER-FLAG
                            p 0109  0000              DATA    X'0000'
                            p 010A  0100              DATA    X'0100'
                            p 010B  1398 d            ADRL    data+X'1398'

        94      94        88 GOT-HEADER                            VALUE 1.
        95      95        01 STARTUP-FLAG                PIC 9(01) VALUE 1.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 22

                                    010C p  <-------  DEFINE  STARTUP-FLAG
                            p 010C  0000              DATA    X'0000'
                            p 010D  0100              DATA    X'0100'
                            p 010E  1399 d            ADRL    data+X'1399'

        96      96        88 STARTUP                               VALUE 1.
        97      97        01 ALREADY-BEEN-PROMPTED-FLAG  PIC 9(01) VALUE 0.

                                    010F p  <-------  DEFINE  ALREADY-BEEN-PROMPTED-FLAG
                            p 010F  0000              DATA    X'0000'
                            p 0110  0100              DATA    X'0100'
                            p 0111  139A d            ADRL    data+X'139A'

        98      98        88 ALREADY-BEEN-PROMPTED                 VALUE 1.
        99      99        01 PAGE-1-TTY-IS-OPEN-FLAG     PIC 9(01) VALUE 0.

                                    0112 p  <-------  DEFINE  PAGE-1-TTY-IS-OPEN-FLAG
                            p 0112  0000              DATA    X'0000'
                            p 0113  0100              DATA    X'0100'
                            p 0114  139B d            ADRL    data+X'139B'

       100     100        88 PAGE-1-TTY-IS-OPEN                    VALUE 1.
       101     101        01 PAGE-2-TTY-IS-OPEN-FLAG     PIC 9(01) VALUE 0.

                                    0115 p  <-------  DEFINE  PAGE-2-TTY-IS-OPEN-FLAG
                            p 0115  0000              DATA    X'0000'
                            p 0116  0100              DATA    X'0100'
                            p 0117  139C d            ADRL    data+X'139C'

       102     102        88 PAGE-2-TTY-IS-OPEN                    VALUE 1.
       103     103        01 TERMINAL-INFO.

                                    0118 p  <-------  DEFINE  TERMINAL-INFO
                            p 0118  0003              DATA    X'0003'
                            p 0119  0030              DATA    X'0030'
                            p 011A  139D d            ADRL    data+X'139D'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 23

       104     104           02 FILLER                   PIC X(30).
       105     105           02 NODE-PORT                PIC X(08).

                                    011B p  <-------  DEFINE  NODE-PORT
                            p 011B  0003              DATA    X'0003'
                            p 011C  0008              DATA    X'0008'
                            p 011D  13AC d            ADRL    data+X'13AC'

       106     106           02 FILLER                   PIC X(01).
       107     107           02 DEVICE-TYPE              PIC 9.

                                    011E p  <-------  DEFINE  DEVICE-TYPE
                            p 011E  0000              DATA    X'0000'
                            p 011F  8100              DATA    X'8100'
                            p 0120  13B0 d            ADRL    data+X'13B0'

       108     108           88 DEVICE-IS-HARDCOPY       VALUE 1.
       109     109           02 CONTROLLER-DEVICE        PIC X(08).

                                    0121 p  <-------  DEFINE  CONTROLLER-DEVICE
                            p 0121  0003              DATA    X'0003'
                            p 0122  0008              DATA    X'0008'
                            p 0123  13B1 d            ADRL    data+X'13B1'

       110     110        01 LINE-INFO-BUF.

                                    0124 p  <-------  DEFINE  LINE-INFO-BUF
                            p 0124  0003              DATA    X'0003'
                            p 0125  0010              DATA    X'0010'
                            p 0126  13B5 d            ADRL    data+X'13B5'

       111     111           02 T-NODE-PORT              PIC X(08).

                                    0127 p  <-------  DEFINE  T-NODE-PORT
                            p 0127  0003              DATA    X'0003'
                            p 0128  0008              DATA    X'0008'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 24
                            p 0129  13B5 d            ADRL    data+X'13B5'

       112     112           02 T-CONTROLLER-DEVICE      PIC X(08).

                                    012A p  <-------  DEFINE  T-CONTROLLER-DEVICE
                            p 012A  0003              DATA    X'0003'
                            p 012B  0008              DATA    X'0008'
                            p 012C  13B9 d            ADRL    data+X'13B9'

       113     113
       114     114        FRAME SECTION.
       115     115       *--------------
       116     116        FR TITLES.
       117     117       *----------
       118     118        01 CONSTANT-TITLES-RECORD      OUTPUT.

                                    012D p  <-------  DEFINE  TITLES
                            p 012D  000A              DATA    X'000A'
                            p 012E  0001              DATA    X'0001'
                            p 012F  0001              DATA    X'0001'
                            p 0130  0000 f            ADRL    CONSTANT-TITLES-RECORD
                            p 0131  0000              DATA    X'0000'
                            p 0132  0001 f            ADRL    SCREEN
                            p 0133  13BD d            ADRL    data+X'13BD'
                            p 0134  0002 f            ADRL    symb23
                            p 0135  0654    symb23    DATA    X'0654'       '.T'
                            p 0136  4954              DATA    X'4954'       'IT'
                            p 0137  4C45              DATA    X'4C45'       'LE'
                            p 0138  5320              DATA    X'5320'       'S '
                            d 13BD  0000              DATA    X'0000'*12
                            d 13C9  0000              DATA    X'0000'

                                    0139 p  <-------  DEFINE  CONSTANT-TITLES-RECORD
                            p 0139  6009    fref0000  DATA    X'6009'
                            p 013A  0000              DATA    X'0000'*2
                            p 013C  0003 f            ADRL    filr1
                            p 013D  0000              ADRL    nil
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 25
                            p 013E  012D p            ADRL    TITLES
                            p 013F  13CA d            ADRL    data+X'13CA'
                            p 0140  0004 f            ADRL    symb72
                            p 0141  1643    symb72    DATA    X'1643'       '.C'
                            p 0142  4F4E              DATA    X'4F4E'       'ON'
                            p 0143  5354              DATA    X'5354'       'ST'
                            p 0144  414E              DATA    X'414E'       'AN'
                            p 0145  542D              DATA    X'542D'       'T-'
                            p 0146  5449              DATA    X'5449'       'TI'
                            p 0147  544C              DATA    X'544C'       'TL'
                            p 0148  4553              DATA    X'4553'       'ES'
                            p 0149  2D52              DATA    X'2D52'       '-R'
                            p 014A  4543              DATA    X'4543'       'EC'
                            p 014B  4F52              DATA    X'4F52'       'OR'
                            p 014C  4420              DATA    X'4420'       'D '
                            d 13CA  0000              DATA    X'0000'*2

       119     119           02 FILLER                   PIC X(26) POSITION IS 1, 1
                            p 014D  48C3    filr1     DATA    X'48C3'       'HC'
                            p 014E  001A              DATA    X'001A'
                            p 014F  0098 p            ADRL    proc+X'0098'
                            p 0150  0000              ADRL    nil
                            p 0151  0005 f            ADRL    filr2
                            p 0152  0139 p            ADRL    CONSTANT-TITLES-RECORD
                            p 0153  13CC d            ADRL    data+X'13CC'

                            p 0154  0006 f            ADRL    fref0006
                            p 0155  0001              DATA    X'0001'
                            p 0156  0001              DATA    X'0001'
                            p 0157  0005              DATA    X'0005'
                            p 0158  0000              DATA    X'0000'
                            p 0159  0646    fref0006  DATA    X'0646'       '.F'
                            p 015A  494C              DATA    X'494C'       'IL'
                            p 015B  4C45              DATA    X'4C45'       'LE'
                            p 015C  5220              DATA    X'5220'       'R '
                            d 13CC  0000              DATA    X'0000'*2
                            d 13CE  0000              DATA    X'0000'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 26

       120     120              CONSTANT VALUE "CP6 Transaction Processing".
       121     121           02 FILLER                   PIC X(01) POSITION IS 3, 1
                            p 015D  48C3    filr2     DATA    X'48C3'       'HC'
                            p 015E  0001              DATA    X'0001'
                            p 015F  00A5 p            ADRL    proc+X'00A5'
                            p 0160  0000              ADRL    nil
                            p 0161  0000              ADRL    nil
                            p 0162  0139 p            ADRL    CONSTANT-TITLES-RECORD
                            p 0163  13CF d            ADRL    data+X'13CF'
                            p 0164  0159 p            ADRL    proc+X'0159'
                            p 0165  0003              DATA    X'0003'
                            p 0166  0001              DATA    X'0001'
                            p 0167  0005              DATA    X'0005'
                            p 0168  0000              DATA    X'0000'
                            d 13CF  0000              DATA    X'0000'*2
                            d 13D1  0000              DATA    X'0000'
       122     122              CONSTANT VALUE IS "?".
       123     123
       124     124        FR COMMAND-INPUT.
       125     125       *-----------------
       126     126        01 COMMAND-RECORD              INPUT.

                                    0169 p  <-------  DEFINE  COMMAND-INPUT
                            p 0169  000A              DATA    X'000A'
                            p 016A  0001              DATA    X'0001'
                            p 016B  8001              DATA    X'8001'
                            p 016C  0007 f            ADRL    COMMAND-RECORD
                            p 016D  0000              DATA    X'0000'
                            p 016E  0001 f            ADRL    SCREEN
                            p 016F  13D2 d            ADRL    data+X'13D2'
                            p 0170  0008 f            ADRL    symb24
                            p 0171  0D43    symb24    DATA    X'0D43'       '.C'
                            p 0172  4F4D              DATA    X'4F4D'       'OM'
                            p 0173  4D41              DATA    X'4D41'       'MA'
                            p 0174  4E44              DATA    X'4E44'       'ND'
                            p 0175  2D49              DATA    X'2D49'       '-I'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 27
                            p 0176  4E50              DATA    X'4E50'       'NP'
                            p 0177  5554              DATA    X'5554'       'UT'
                            d 13D2  0000              DATA    X'0000'*12
                            d 13DE  0000              DATA    X'0000'

                                    0178 p  <-------  DEFINE  COMMAND-RECORD
                            p 0178  6009    fref0007  DATA    X'6009'
                            p 0179  0000              DATA    X'0000'*2
                            p 017B  0009 f            ADRL    COMMAND
                            p 017C  0000              ADRL    nil
                            p 017D  0169 p            ADRL    COMMAND-INPUT
                            p 017E  13DF d            ADRL    data+X'13DF'
                            p 017F  000A f            ADRL    symb73
                            p 0180  0E43    symb73    DATA    X'0E43'       '.C'
                            p 0181  4F4D              DATA    X'4F4D'       'OM'
                            p 0182  4D41              DATA    X'4D41'       'MA'
                            p 0183  4E44              DATA    X'4E44'       'ND'
                            p 0184  2D52              DATA    X'2D52'       '-R'
                            p 0185  4543              DATA    X'4543'       'EC'
                            p 0186  4F52              DATA    X'4F52'       'OR'
                            p 0187  4420              DATA    X'4420'       'D '
                            d 13DF  0000              DATA    X'0000'*2

       127     127           02 COMMAND                  PIC X(72) POSITION IS 3, 3

                                    0188 p  <-------  DEFINE  COMMAND
                            p 0188  3083    fref0009  DATA    X'3083'       '0 '
                            p 0189  0048              DATA    X'0048'
                            p 018A  00AC d            ADRL    data+X'00AC'
                            p 018B  0000              ADRL    nil
                            p 018C  0000              ADRL    nil
                            p 018D  0178 p            ADRL    COMMAND-RECORD
                            p 018E  13E1 d            ADRL    data+X'13E1'
                            p 018F  000B f            ADRL    symb33
                            p 0190  0003              DATA    X'0003'
                            p 0191  0003              DATA    X'0003'
                            p 0192  0004              DATA    X'0004'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 28
                            p 0193  0000              DATA    X'0000'
                            p 0194  0743    symb33    DATA    X'0743'       '.C'
                            p 0195  4F4D              DATA    X'4F4D'       'OM'
                            p 0196  4D41              DATA    X'4D41'       'MA'
                            p 0197  4E44              DATA    X'4E44'       'ND'
                            d 13E1  0000              DATA    X'0000'*2
                            d 13E3  0000              DATA    X'0000'

       128     128                                       ENTRY-REQUIRED.
       129     129
       130     130        FR MSG-OUTPUT
       131     131       *-------------
       132     132            ORIGIN IS LINE 5 COLUMN 1.
       133     133
       134     134        01 DETAIL-LINES                OUTPUT.

                                    0198 p  <-------  DEFINE  MSG-OUTPUT
                            p 0198  000A              DATA    X'000A'
                            p 0199  0005              DATA    X'0005'
                            p 019A  8001              DATA    X'8001'
                            p 019B  000C f            ADRL    DETAIL-LINES
                            p 019C  0000              DATA    X'0000'
                            p 019D  0001 f            ADRL    SCREEN
                            p 019E  13E4 d            ADRL    data+X'13E4'
                            p 019F  000D f            ADRL    symb25
                            p 01A0  0A4D    symb25    DATA    X'0A4D'       '.M'
                            p 01A1  5347              DATA    X'5347'       'SG'
                            p 01A2  2D4F              DATA    X'2D4F'       '-O'
                            p 01A3  5554              DATA    X'5554'       'UT'
                            p 01A4  5055              DATA    X'5055'       'PU'
                            p 01A5  5420              DATA    X'5420'       'T '
                            d 13E4  0000              DATA    X'0000'*12
                            d 13F0  0000              DATA    X'0000'

                                    01A6 p  <-------  DEFINE  DETAIL-LINES
                            p 01A6  6009    fref000C  DATA    X'6009'
                            p 01A7  0000              DATA    X'0000'*2
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 29
                            p 01A9  000E f            ADRL    DETAIL-ITEMS
                            p 01AA  0000              ADRL    nil
                            p 01AB  0198 p            ADRL    MSG-OUTPUT
                            p 01AC  13F1 d            ADRL    data+X'13F1'
                            p 01AD  000F f            ADRL    symb74
                            p 01AE  0C44    symb74    DATA    X'0C44'       '.D'
                            p 01AF  4554              DATA    X'4554'       'ET'
                            p 01B0  4149              DATA    X'4149'       'AI'
                            p 01B1  4C2D              DATA    X'4C2D'       'L-'
                            p 01B2  4C49              DATA    X'4C49'       'LI'
                            p 01B3  4E45              DATA    X'4E45'       'NE'
                            p 01B4  5320              DATA    X'5320'       'S '
                            d 13F1  0000              DATA    X'0000'*2

       135     135           02 DETAIL-ITEMS REPEATS 16 TIMES.

                                    01B5 p  <-------  DEFINE  DETAIL-ITEMS
                            p 01B5  6018    fref000E  DATA    X'6018'
                            p 01B6  0010              DATA    X'0010'
                            p 01B7  0000              DATA    X'0000'
                            p 01B8  0010 f            ADRL    A-LINE
                            p 01B9  0000              ADRL    nil
                            p 01BA  01A6 p            ADRL    DETAIL-LINES
                            p 01BB  13F3 d            ADRL    data+X'13F3'
                            p 01BC  0011 f            ADRL    symb75
                            p 01BD  0C44    symb75    DATA    X'0C44'       '.D'
                            p 01BE  4554              DATA    X'4554'       'ET'
                            p 01BF  4149              DATA    X'4149'       'AI'
                            p 01C0  4C2D              DATA    X'4C2D'       'L-'
                            p 01C1  4954              DATA    X'4954'       'IT'
                            p 01C2  454D              DATA    X'454D'       'EM'
                            p 01C3  5320              DATA    X'5320'       'S '
                            d 13F3  0000              DATA    X'0000'*2

       136     136              03 A-LINE                PIC X(80) POSITION IS 1, 1.

                                    01C4 p  <-------  DEFINE  A-LINE
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 30
                            p 01C4  4093    fref0010  DATA    X'4093'       '@ '
                            p 01C5  0050              DATA    X'0050'
                            p 01C6  00D0 d            ADRL    data+X'00D0'
                            p 01C7  0000              ADRL    nil
                            p 01C8  0000              ADRL    nil
                            p 01C9  01B5 p            ADRL    DETAIL-ITEMS
                            p 01CA  13F5 d            ADRL    data+X'13F5'
                            p 01CB  0012 f            ADRL    symb40
                            p 01CC  0001              DATA    X'0001'
                            p 01CD  0001              DATA    X'0001'
                            p 01CE  0005              DATA    X'0005'
                            p 01CF  0010              DATA    X'0010'
                            p 01D0  0050              DATA    X'0050'
                            p 01D1  0000              DATA    X'0000'
                            p 01D2  0641    symb40    DATA    X'0641'       '.A'
                            p 01D3  2D4C              DATA    X'2D4C'       '-L'
                            p 01D4  494E              DATA    X'494E'       'IN'
                            p 01D5  4520              DATA    X'4520'       'E '
                            d 13F5  0000              DATA    X'0000'*2
                            d 13F7  0000              DATA    X'0000'*16

       137     137
       138     138        FR MSG-OUTPUT-ON-PAGE-1-TTY
       139     139       *---------------------------
       140     140             ORIGIN IS LINE 4 COLUMN 1.
       141     141        01 A-SPACE                     OUTPUT

                                    01D6 p  <-------  DEFINE  MSG-OUTPUT-ON-PAGE-1-TTY
                            p 01D6  000A              DATA    X'000A'
                            p 01D7  0004              DATA    X'0004'
                            p 01D8  0001              DATA    X'0001'
                            p 01D9  0013 f            ADRL    A-SPACE
                            p 01DA  0000              DATA    X'0000'
                            p 01DB  0014 f            ADRL    PAGE-1-TTY
                            p 01DC  1407 d            ADRL    data+X'1407'
                            p 01DD  0015 f            ADRL    symb28
                            p 01DE  184D    symb28    DATA    X'184D'       '.M'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 31
                            p 01DF  5347              DATA    X'5347'       'SG'
                            p 01E0  2D4F              DATA    X'2D4F'       '-O'
                            p 01E1  5554              DATA    X'5554'       'UT'
                            p 01E2  5055              DATA    X'5055'       'PU'
                            p 01E3  542D              DATA    X'542D'       'T-'
                            p 01E4  4F4E              DATA    X'4F4E'       'ON'
                            p 01E5  2D50              DATA    X'2D50'       '-P'
                            p 01E6  4147              DATA    X'4147'       'AG'
                            p 01E7  452D              DATA    X'452D'       'E-'
                            p 01E8  312D              DATA    X'312D'       '1-'
                            p 01E9  5454              DATA    X'5454'       'TT'
                            p 01EA  5920              DATA    X'5920'       'Y '
                            d 1407  0000              DATA    X'0000'*12
                            d 1413  0000              DATA    X'0000'

                                    01EB p  <-------  DEFINE  A-SPACE
                            p 01EB  48C3    fref0013  DATA    X'48C3'       'HC'
                            p 01EC  0001              DATA    X'0001'
                            p 01ED  00A6 p            ADRL    proc+X'00A6'
                            p 01EE  0000              ADRL    nil
                            p 01EF  0016 f            ADRL    DETAIL-LINES-ON-PAGE-1
                            p 01F0  01D6 p            ADRL    MSG-OUTPUT-ON-PAGE-1-TTY
                            p 01F1  1414 d            ADRL    data+X'1414'
                            p 01F2  0017 f            ADRL    symb76
                            p 01F3  0001              DATA    X'0001'
                            p 01F4  0001              DATA    X'0001'
                            p 01F5  0005              DATA    X'0005'
                            p 01F6  0000              DATA    X'0000'
                            p 01F7  0741    symb76    DATA    X'0741'       '.A'
                            p 01F8  2D53              DATA    X'2D53'       '-S'
                            p 01F9  5041              DATA    X'5041'       'PA'
                            p 01FA  4345              DATA    X'4345'       'CE'
                            d 1414  0000              DATA    X'0000'*2
                            d 1416  0000              DATA    X'0000'

       142     142                                       PIC X(01) POSITION IS 1, 1
       143     143              CONSTANT VALUE SPACE.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 32
       144     144        01 DETAIL-LINES-ON-PAGE-1      OUTPUT.

                                    01FB p  <-------  DEFINE  DETAIL-LINES-ON-PAGE-1
                            p 01FB  6009    fref0016  DATA    X'6009'
                            p 01FC  0000              DATA    X'0000'*2
                            p 01FE  0018 f            ADRL    DETAIL-ITEMS
                            p 01FF  0000              ADRL    nil
                            p 0200  01D6 p            ADRL    MSG-OUTPUT-ON-PAGE-1-TTY
                            p 0201  1417 d            ADRL    data+X'1417'
                            p 0202  0019 f            ADRL    symb77
                            p 0203  1644    symb77    DATA    X'1644'       '.D'
                            p 0204  4554              DATA    X'4554'       'ET'
                            p 0205  4149              DATA    X'4149'       'AI'
                            p 0206  4C2D              DATA    X'4C2D'       'L-'
                            p 0207  4C49              DATA    X'4C49'       'LI'
                            p 0208  4E45              DATA    X'4E45'       'NE'
                            p 0209  532D              DATA    X'532D'       'S-'
                            p 020A  4F4E              DATA    X'4F4E'       'ON'
                            p 020B  2D50              DATA    X'2D50'       '-P'
                            p 020C  4147              DATA    X'4147'       'AG'
                            p 020D  452D              DATA    X'452D'       'E-'
                            p 020E  3120              DATA    X'3120'       '1 '
                            d 1417  0000              DATA    X'0000'*2

       145     145           02 DETAIL-ITEMS REPEATS 20 TIMES.

                                    020F p  <-------  DEFINE  DETAIL-ITEMS
                            p 020F  6018    fref0018  DATA    X'6018'
                            p 0210  0014              DATA    X'0014'
                            p 0211  0000              DATA    X'0000'
                            p 0212  001A f            ADRL    A-LINE-ON-PAGE-1
                            p 0213  0000              ADRL    nil
                            p 0214  01FB p            ADRL    DETAIL-LINES-ON-PAGE-1
                            p 0215  1419 d            ADRL    data+X'1419'
                            p 0216  01BD p            ADRL    symb75
                            d 1419  0000              DATA    X'0000'*2

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 33
       146     146              03 A-LINE-ON-PAGE-1      PIC X(72) POSITION IS 2, 1.

                                    0217 p  symb75    EQU     $$
                            p 0217  4093              DATA    X'4093' N-PAGE'@ '
                            p 0218  0048              DATA    X'0048'
                            p 0219  0382 d            ADRL    data+X'0382'
                            p 021A  0000              ADRL    nil
                            p 021B  0000              ADRL    nil
                            p 021C  020F p            ADRL    DETAIL-ITEMS
                            p 021D  141B d            ADRL    data+X'141B'
                            p 021E  001B f            ADRL    symb43
                            p 021F  0002              DATA    X'0002'
                            p 0220  0001              DATA    X'0001'
                            p 0221  0005              DATA    X'0005'
                            p 0222  0014              DATA    X'0014'
                            p 0223  0048              DATA    X'0048'
                            p 0224  0000              DATA    X'0000'
                            p 0225  1041    symb43    DATA    X'1041'       '.A'
                            p 0226  2D4C              DATA    X'2D4C'       '-L'
                            p 0227  494E              DATA    X'494E'       'IN'
                            p 0228  452D              DATA    X'452D'       'E-'
                            p 0229  4F4E              DATA    X'4F4E'       'ON'
                            p 022A  2D50              DATA    X'2D50'       '-P'
                            p 022B  4147              DATA    X'4147'       'AG'
                            p 022C  452D              DATA    X'452D'       'E-'
                            p 022D  3120              DATA    X'3120'       '1 '
                            d 141B  0000              DATA    X'0000'*2
                            d 141D  0000              DATA    X'0000'*20

       147     147
       148     148        FR MSG-OUTPUT-ON-PAGE-2-TTY.
       149     149       *----------------------------
       150     150        01 DETAIL-LINES-ON-PAGE-2      OUTPUT.

                                    022E p  <-------  DEFINE  MSG-OUTPUT-ON-PAGE-2-TTY
                            p 022E  000A              DATA    X'000A'
                            p 022F  0001              DATA    X'0001'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 34
                            p 0230  0001              DATA    X'0001'
                            p 0231  001C f            ADRL    DETAIL-LINES-ON-PAGE-2
                            p 0232  0000              DATA    X'0000'
                            p 0233  001D f            ADRL    PAGE-2-TTY
                            p 0234  1431 d            ADRL    data+X'1431'
                            p 0235  001E f            ADRL    symb29
                            p 0236  184D    symb29    DATA    X'184D'       '.M'
                            p 0237  5347              DATA    X'5347'       'SG'
                            p 0238  2D4F              DATA    X'2D4F'       '-O'
                            p 0239  5554              DATA    X'5554'       'UT'
                            p 023A  5055              DATA    X'5055'       'PU'
                            p 023B  542D              DATA    X'542D'       'T-'
                            p 023C  4F4E              DATA    X'4F4E'       'ON'
                            p 023D  2D50              DATA    X'2D50'       '-P'
                            p 023E  4147              DATA    X'4147'       'AG'
                            p 023F  452D              DATA    X'452D'       'E-'
                            p 0240  322D              DATA    X'322D'       '2-'
                            p 0241  5454              DATA    X'5454'       'TT'
                            p 0242  5920              DATA    X'5920'       'Y '
                            d 1431  0000              DATA    X'0000'*12
                            d 143D  0000              DATA    X'0000'

                                    0243 p  <-------  DEFINE  DETAIL-LINES-ON-PAGE-2
                            p 0243  6009    fref001C  DATA    X'6009'
                            p 0244  0000              DATA    X'0000'*2
                            p 0246  001F f            ADRL    DETAIL-ITEMS
                            p 0247  0000              ADRL    nil
                            p 0248  022E p            ADRL    MSG-OUTPUT-ON-PAGE-2-TTY
                            p 0249  143E d            ADRL    data+X'143E'
                            p 024A  0020 f            ADRL    symb78
                            p 024B  1644    symb78    DATA    X'1644'       '.D'
                            p 024C  4554              DATA    X'4554'       'ET'
                            p 024D  4149              DATA    X'4149'       'AI'
                            p 024E  4C2D              DATA    X'4C2D'       'L-'
                            p 024F  4C49              DATA    X'4C49'       'LI'
                            p 0250  4E45              DATA    X'4E45'       'NE'
                            p 0251  532D              DATA    X'532D'       'S-'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 35
                            p 0252  4F4E              DATA    X'4F4E'       'ON'
                            p 0253  2D50              DATA    X'2D50'       '-P'
                            p 0254  4147              DATA    X'4147'       'AG'
                            p 0255  452D              DATA    X'452D'       'E-'
                            p 0256  3220              DATA    X'3220'       '2 '
                            d 143E  0000              DATA    X'0000'*2

       151     151           02 DETAIL-ITEMS REPEATS 24 TIMES.

                                    0257 p  <-------  DEFINE  DETAIL-ITEMS
                            p 0257  6018    fref001F  DATA    X'6018'
                            p 0258  0018              DATA    X'0018'
                            p 0259  0000              DATA    X'0000'
                            p 025A  0021 f            ADRL    A-LINE-ON-PAGE-2
                            p 025B  0000              ADRL    nil
                            p 025C  0243 p            ADRL    DETAIL-LINES-ON-PAGE-2
                            p 025D  1440 d            ADRL    data+X'1440'
                            p 025E  01BD p            ADRL    symb75
                            d 1440  0000              DATA    X'0000'*2

       152     152              03 A-LINE-ON-PAGE-2      PIC X(72) POSITION IS 1, 1.

                                    025F p  symb75    EQU     $$
                            p 025F  4093              DATA    X'4093' N-PAGE'@ '
                            p 0260  0048              DATA    X'0048'
                            p 0261  0652 d            ADRL    data+X'0652'
                            p 0262  0000              ADRL    nil
                            p 0263  0000              ADRL    nil
                            p 0264  0257 p            ADRL    DETAIL-ITEMS
                            p 0265  1442 d            ADRL    data+X'1442'
                            p 0266  0022 f            ADRL    symb46
                            p 0267  0001              DATA    X'0001'
                            p 0268  0001              DATA    X'0001'
                            p 0269  0005              DATA    X'0005'
                            p 026A  0018              DATA    X'0018'
                            p 026B  0048              DATA    X'0048'
                            p 026C  0000              DATA    X'0000'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 36
                            p 026D  1041    symb46    DATA    X'1041'       '.A'
                            p 026E  2D4C              DATA    X'2D4C'       '-L'
                            p 026F  494E              DATA    X'494E'       'IN'
                            p 0270  452D              DATA    X'452D'       'E-'
                            p 0271  4F4E              DATA    X'4F4E'       'ON'
                            p 0272  2D50              DATA    X'2D50'       '-P'
                            p 0273  4147              DATA    X'4147'       'AG'
                            p 0274  452D              DATA    X'452D'       'E-'
                            p 0275  3220              DATA    X'3220'       '2 '
                            d 1442  0000              DATA    X'0000'*2
                            d 1444  0000              DATA    X'0000'*24

       153     153
       154     154        FR TITLES-TTY.
       155     155       *--------------
       156     156        01 CP6-LOGO                    OUTPUT

                                    0276 p  <-------  DEFINE  TITLES-TTY
                            p 0276  000A              DATA    X'000A'
                            p 0277  0001              DATA    X'0001'
                            p 0278  0001              DATA    X'0001'
                            p 0279  0023 f            ADRL    CP6-LOGO
                            p 027A  0000              DATA    X'0000'
                            p 027B  0014 f            ADRL    PAGE-1-TTY
                            p 027C  145C d            ADRL    data+X'145C'
                            p 027D  0024 f            ADRL    symb26
                            p 027E  0A54    symb26    DATA    X'0A54'       '.T'
                            p 027F  4954              DATA    X'4954'       'IT'
                            p 0280  4C45              DATA    X'4C45'       'LE'
                            p 0281  532D              DATA    X'532D'       'S-'
                            p 0282  5454              DATA    X'5454'       'TT'
                            p 0283  5920              DATA    X'5920'       'Y '
                            d 145C  0000              DATA    X'0000'*12
                            d 1468  0000              DATA    X'0000'

                                    0284 p  <-------  DEFINE  CP6-LOGO
                            p 0284  48C3    fref0023  DATA    X'48C3'       'HC'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 37
                            p 0285  001A              DATA    X'001A'
                            p 0286  00A7 p            ADRL    proc+X'00A7'
                            p 0287  0000              ADRL    nil
                            p 0288  0025 f            ADRL    PROMPT-TTY
                            p 0289  0276 p            ADRL    TITLES-TTY
                            p 028A  1469 d            ADRL    data+X'1469'
                            p 028B  0026 f            ADRL    symb79
                            p 028C  0001              DATA    X'0001'
                            p 028D  0001              DATA    X'0001'
                            p 028E  0005              DATA    X'0005'
                            p 028F  0000              DATA    X'0000'
                            p 0290  0843    symb79    DATA    X'0843'       '.C'
                            p 0291  5036              DATA    X'5036'       'P6'
                            p 0292  2D4C              DATA    X'2D4C'       '-L'
                            p 0293  4F47              DATA    X'4F47'       'OG'
                            p 0294  4F20              DATA    X'4F20'       'O '
                            d 1469  0000              DATA    X'0000'*2
                            d 146B  0000              DATA    X'0000'

       157     157                                       PIC X(26) POSITION IS 1, 1
       158     158              CONSTANT VALUE "CP6 Transaction Processing".
       159     159        01 PROMPT-TTY                  OUTPUT

                                    0295 p  <-------  DEFINE  PROMPT-TTY
                            p 0295  48C3    fref0025  DATA    X'48C3'       'HC'
                            p 0296  0001              DATA    X'0001'
                            p 0297  00B4 p            ADRL    proc+X'00B4'
                            p 0298  0000              ADRL    nil
                            p 0299  0000              ADRL    nil
                            p 029A  0276 p            ADRL    TITLES-TTY
                            p 029B  146C d            ADRL    data+X'146C'
                            p 029C  0027 f            ADRL    symb80
                            p 029D  0003              DATA    X'0003'
                            p 029E  0001              DATA    X'0001'
                            p 029F  0005              DATA    X'0005'
                            p 02A0  0000              DATA    X'0000'
                            p 02A1  0A50    symb80    DATA    X'0A50'       '.P'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 38
                            p 02A2  524F              DATA    X'524F'       'RO'
                            p 02A3  4D50              DATA    X'4D50'       'MP'
                            p 02A4  542D              DATA    X'542D'       'T-'
                            p 02A5  5454              DATA    X'5454'       'TT'
                            p 02A6  5920              DATA    X'5920'       'Y '
                            d 146C  0000              DATA    X'0000'*2
                            d 146E  0000              DATA    X'0000'

       160     160                                       PIC X(01) POSITION IS 3, 1
       161     161              CONSTANT VALUE IS "?".
       162     162
       163     163        FR COMMAND-INPUT-TTY.
       164     164       *---------------------
       165     165        01 COMMAND-RECORD-TTY          I-O.

                                    02A7 p  <-------  DEFINE  COMMAND-INPUT-TTY
                            p 02A7  000A              DATA    X'000A'
                            p 02A8  0001              DATA    X'0001'
                            p 02A9  8001              DATA    X'8001'
                            p 02AA  0028 f            ADRL    COMMAND-RECORD-TTY
                            p 02AB  0000              DATA    X'0000'
                            p 02AC  0014 f            ADRL    PAGE-1-TTY
                            p 02AD  146F d            ADRL    data+X'146F'
                            p 02AE  0029 f            ADRL    symb27
                            p 02AF  1143    symb27    DATA    X'1143'       '.C'
                            p 02B0  4F4D              DATA    X'4F4D'       'OM'
                            p 02B1  4D41              DATA    X'4D41'       'MA'
                            p 02B2  4E44              DATA    X'4E44'       'ND'
                            p 02B3  2D49              DATA    X'2D49'       '-I'
                            p 02B4  4E50              DATA    X'4E50'       'NP'
                            p 02B5  5554              DATA    X'5554'       'UT'
                            p 02B6  2D54              DATA    X'2D54'       '-T'
                            p 02B7  5459              DATA    X'5459'       'TY'
                            d 146F  0000              DATA    X'0000'*12
                            d 147B  0000              DATA    X'0000'

                                    02B8 p  <-------  DEFINE  COMMAND-RECORD-TTY
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 39
                            p 02B8  6009    fref0028  DATA    X'6009'
                            p 02B9  0000              DATA    X'0000'*2
                            p 02BB  002A f            ADRL    COMMAND-TTY
                            p 02BC  0000              ADRL    nil
                            p 02BD  02A7 p            ADRL    COMMAND-INPUT-TTY
                            p 02BE  147C d            ADRL    data+X'147C'
                            p 02BF  002B f            ADRL    symb81
                            p 02C0  1243    symb81    DATA    X'1243'       '.C'
                            p 02C1  4F4D              DATA    X'4F4D'       'OM'
                            p 02C2  4D41              DATA    X'4D41'       'MA'
                            p 02C3  4E44              DATA    X'4E44'       'ND'
                            p 02C4  2D52              DATA    X'2D52'       '-R'
                            p 02C5  4543              DATA    X'4543'       'EC'
                            p 02C6  4F52              DATA    X'4F52'       'OR'
                            p 02C7  442D              DATA    X'442D'       'D-'
                            p 02C8  5454              DATA    X'5454'       'TT'
                            p 02C9  5920              DATA    X'5920'       'Y '
                            d 147C  0000              DATA    X'0000'*2

       166     166           02 COMMAND-TTY              PIC X(70) POSITION IS 3, 3

                                    02CA p  <-------  DEFINE  COMMAND-TTY
                            p 02CA  7083    fref002A  DATA    X'7083'       'p '
                            p 02CB  0046              DATA    X'0046'
                            p 02CC  035E d            ADRL    data+X'035E'
                            p 02CD  0000              ADRL    nil
                            p 02CE  0000              ADRL    nil
                            p 02CF  02B8 p            ADRL    COMMAND-RECORD-TTY
                            p 02D0  147E d            ADRL    data+X'147E'
                            p 02D1  002C f            ADRL    symb35
                            p 02D2  0003              DATA    X'0003'
                            p 02D3  0003              DATA    X'0003'
                            p 02D4  0004              DATA    X'0004'
                            p 02D5  0000              DATA    X'0000'
                            p 02D6  0B43    symb35    DATA    X'0B43'       '.C'
                            p 02D7  4F4D              DATA    X'4F4D'       'OM'
                            p 02D8  4D41              DATA    X'4D41'       'MA'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 40
                            p 02D9  4E44              DATA    X'4E44'       'ND'
                            p 02DA  2D54              DATA    X'2D54'       '-T'
                            p 02DB  5459              DATA    X'5459'       'TY'
                            d 147E  0000              DATA    X'0000'*2
                            d 1480  0000              DATA    X'0000'

                                    02DC p  <-------  DEFINE  CLEAR-COMMAND
                            p 02DC  0001              DATA    X'0001'
                            p 02DD  0001 p            ADRL    ltrl0

                                    02DE p  <-------  DEFINE  FIRST-TIME-THROUGH
                            p 02DE  0001              DATA    X'0001'
                            p 02DF  0005 p            ADRL    ltrl1

                                    02E0 p  <-------  DEFINE  FIRST-READ
                            p 02E0  0001              DATA    X'0001'
                            p 02E1  0005 p            ADRL    ltrl1

                                    02E2 p  <-------  DEFINE  GOT-HEADER
                            p 02E2  0001              DATA    X'0001'
                            p 02E3  0005 p            ADRL    ltrl1

                                    02E4 p  <-------  DEFINE  STARTUP
                            p 02E4  0001              DATA    X'0001'
                            p 02E5  0005 p            ADRL    ltrl1

                                    02E6 p  <-------  DEFINE  ALREADY-BEEN-PROMPTED
                            p 02E6  0001              DATA    X'0001'
                            p 02E7  0005 p            ADRL    ltrl1

                                    02E8 p  <-------  DEFINE  PAGE-1-TTY-IS-OPEN
                            p 02E8  0001              DATA    X'0001'
                            p 02E9  0005 p            ADRL    ltrl1

                                    02EA p  <-------  DEFINE  PAGE-2-TTY-IS-OPEN
                            p 02EA  0001              DATA    X'0001'
                            p 02EB  0005 p            ADRL    ltrl1
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 41

                                    02EC p  <-------  DEFINE  DEVICE-IS-HARDCOPY
                            p 02EC  0001              DATA    X'0001'
                            p 02ED  0005 p            ADRL    ltrl1

                                    02EE p  <-------  DEFINE  XACTION
                            p 02EE  000C              DATA    X'000C'
                            p 02EF  0053              DATA    X'0053'
                            p 02F0  0058 d            ADRL    data+X'0058'
                            p 02F1  0000              DATA    X'0000'
                            p 02F2  0000              DATA    X'0000'
                            p 02F3  0000              DATA    X'0000'
                            p 02F4  1481 d            ADRL    data+X'1481'
                            p 02F5  002D f            ADRL    symb1
                            p 02F6  0000              REF     dcb#
                            p 02F7  0000              ADRL    nil
                            p 02F8  0000              DATA    X'0000'
                            p 02F9  00FD p            ADRL    proc+X'00FD'
                            p 02FA  0758    symb1     DATA    X'0758'       '.X'
                            p 02FB  4143              DATA    X'4143'       'AC'
                            p 02FC  5449              DATA    X'5449'       'TI'
                            p 02FD  4F4E              DATA    X'4F4E'       'ON'
                            d 1481  0000              DATA    X'0000'*8
                            d 1489  0000              DATA    X'0000'

                                    02FE p  <-------  DEFINE  SCREEN
                            p 02FE  000B    fref0001  DATA    X'000B'
                            p 02FF  0003              DATA    X'0003'
                            p 0300  0000              ADRL    nil
                            p 0301  0000              ADRL    nil
                            p 0302  0000              DATA    X'0000'
                            p 0303  0000              DATA    X'0000'
                            p 0304  148A d            ADRL    data+X'148A'
                            p 0305  002E f            ADRL    symb3
                            p 0306  0000              REF     dcb#
                            p 0307  0000              ADRL    nil
                            p 0308  0000              ADRL    nil
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 42
                            p 0309  0198 p            ADRL    MSG-OUTPUT
                            p 030A  0169 p            ADRL    COMMAND-INPUT
                            p 030B  012D p            ADRL    TITLES
                            p 030C  0653    symb3     DATA    X'0653'       '.S'
                            p 030D  4352              DATA    X'4352'       'CR'
                            p 030E  4545              DATA    X'4545'       'EE'
                            p 030F  4E20              DATA    X'4E20'       'N '
                            d 148A  0000              DATA    X'0000'*8
                            d 1492  0000              DATA    X'0000'

                                    0310 p  <-------  DEFINE  MSGG
                            p 0310  010C              DATA    X'010C'
                            p 0311  0053              DATA    X'0053'
                            p 0312  0082 d            ADRL    data+X'0082'
                            p 0313  0000              DATA    X'0000'
                            p 0314  0000              DATA    X'0000'
                            p 0315  0000              DATA    X'0000'
                            p 0316  1493 d            ADRL    data+X'1493'
                            p 0317  002F f            ADRL    symb4
                            p 0318  0000              REF     dcb#
                            p 0319  0000              ADRL    nil
                            p 031A  0000              DATA    X'0000'
                            p 031B  0100 p            ADRL    proc+X'0100'
                            p 031C  044D    symb4     DATA    X'044D'       '.M'
                            p 031D  5347              DATA    X'5347'       'SG'
                            p 031E  4720              DATA    X'4720'       'G '
                            d 1493  0000              DATA    X'0000'*8
                            d 149B  0000              DATA    X'0000'

                                    031F p  <-------  DEFINE  PAGE-1-TTY
                            p 031F  000B    fref0014  DATA    X'000B'
                            p 0320  0003              DATA    X'0003'
                            p 0321  0000              ADRL    nil
                            p 0322  0000              ADRL    nil
                            p 0323  0000              DATA    X'0000'
                            p 0324  0000              DATA    X'0000'
                            p 0325  149C d            ADRL    data+X'149C'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 43
                            p 0326  0030 f            ADRL    symb6
                            p 0327  0000              REF     dcb#
                            p 0328  0000              ADRL    nil
                            p 0329  0000              ADRL    nil
                            p 032A  01D6 p            ADRL    MSG-OUTPUT-ON-PAGE-1-TTY
                            p 032B  02A7 p            ADRL    COMMAND-INPUT-TTY
                            p 032C  0276 p            ADRL    TITLES-TTY
                            p 032D  0A50    symb6     DATA    X'0A50'       '.P'
                            p 032E  4147              DATA    X'4147'       'AG'
                            p 032F  452D              DATA    X'452D'       'E-'
                            p 0330  312D              DATA    X'312D'       '1-'
                            p 0331  5454              DATA    X'5454'       'TT'
                            p 0332  5920              DATA    X'5920'       'Y '
                            d 149C  0000              DATA    X'0000'*8
                            d 14A4  0000              DATA    X'0000'

                                    0333 p  <-------  DEFINE  PAGE-2-TTY
                            p 0333  000B    fref001D  DATA    X'000B'
                            p 0334  0001              DATA    X'0001'
                            p 0335  0000              ADRL    nil
                            p 0336  0000              ADRL    nil
                            p 0337  0000              DATA    X'0000'
                            p 0338  0000              DATA    X'0000'
                            p 0339  14A5 d            ADRL    data+X'14A5'
                            p 033A  0031 f            ADRL    symb7
                            p 033B  0000              REF     dcb#
                            p 033C  0000              ADRL    nil
                            p 033D  0000              ADRL    nil
                            p 033E  022E p            ADRL    MSG-OUTPUT-ON-PAGE-2-TTY
                            p 033F  0A50    symb7     DATA    X'0A50'       '.P'
                            p 0340  4147              DATA    X'4147'       'AG'
                            p 0341  452D              DATA    X'452D'       'E-'
                            p 0342  322D              DATA    X'322D'       '2-'
                            p 0343  5454              DATA    X'5454'       'TT'
                            p 0344  5920              DATA    X'5920'       'Y '
                            d 14A5  0000              DATA    X'0000'*8
                            d 14AD  0000              DATA    X'0000'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 44


       167     167                                       ENTRY-REQUIRED.

       168     168       /

       169     169        PROCEDURE DIVISION.

       170     170       *-------------------

       171     171        000-INIT.
                            p 0345  0300              DATA    X'0300'
                            p 0346  00000000 d        ADDR    data+X'0000'
                            p 0348  00000000 p        ADDR    proc+X'0000'
                            p 034A  0000              DATA    X'0000'
                            p 034B  00B5 p            ADRL    CURRENT-FORM
                            p 034C  00B8 p            ADRL    CURRENT-FRAME
                            p 034D  00BB p            ADRL    CURRENT-FIELD
                            p 034E  00BE p            ADRL    RETRY
                            p 034F  00C1 p            ADRL    VERIFY_BUFFER_1
                            p 0350  0000              ADRL    nil
                            p 0351  0000              ADRL    nil
                            p 0352  0000              ADRL    nil
                            p 0353  4530              DATA    X'4530'       'E0'
                            p 0354  3220              DATA    X'3220'       '2 '
                            p 0355  0000              ADRL    nil
                            p 0356  0000              ADRL    nil
                            p 0357  0000              ADRL    nil
                            p 0358  0000              REF     dcb#
                            p 0359  0000              REF     dcb#
                            p 035A  0053              DATA    X'0053'
                                    0001 e  oops0     EQU     COMMAND-FP
                            e 0001  D380              LNJ,B5  ext
                            e 0002  00000000 x        ADDR    X6A_MAUTO
                            e 0004  000A              DATA    X'000A'
                            e 0005  0000              DATA    X'0000'
                            e 0006  BBC7              LAB,B3  IMO,B7
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 45
                            e 0007  0000              DATA    X'0000'
                            e 0008  BFC7              STB,B3  IMO,B7
                            e 0009  0004              DATA    X'0004'
                            e 000A  BB80              LAB,B3  ext
                            e 000B  0000035B p        ADDR    proc+X'035B'
                            e 000D  BFC7              STB,B3  IMO,B7
                            e 000E  0002              DATA    X'0002'
                            e 000F  BB80              LAB,B3  ext
                            e 0010  00000346 p        ADDR    proc+X'0346'
                            e 0012  BFC7              STB,B3  IMO,B7
                            e 0013  0000              DATA    X'0000'
                            e 0014  BBC7              LAB,B3  IMO,B7
                            e 0015  0000              DATA    X'0000'
                            e 0016  CB80              LAB,B4  ext
                            e 0017  00000345 p        ADDR    proc+X'0345'
                            e 0019  E380              LNJ,B6  ext
                            e 001A  00000000 x        ADDR    QAT$TALLYHO
                            e 001C  0001              DATA    X'0001'
                            e 001D  C380              LNJ,B4  ext
                            e 001E  00000000 x        ADDR    X6A_MARET

                                    035B p  <-------  DEFINE  000-INIT


       172     172       *---------

       173     173

       174     174       * ACCEPT x FROM TERMINAL-ATTRIBUTES.

       175     175       * IF blorp MOVE 1 TO STAND-ALONE-PRINTER-FLAG.

       176     176       *

       177     177            OPEN I-O XACTION, MSGG.
                            p 035B  0031              VECT    C_OPEN
                            p 035C  6002              DATA    X'6002'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 46
                            p 035D  02EE p            ADRL    XACTION
                            p 035E  0310 p            ADRL    MSGG

       178     178            ACCEPT TERMINAL-INFO FROM TERMINAL-ATTRIBUTES.
                            p 035F  0000              VECT    C_ACCPT
                            p 0360  A000              DATA    X'A000'
                            p 0361  0118 p            ADRL    TERMINAL-INFO

       179     179            MOVE "*IAMRDY" TO XACTION-MSGTYP.
                            p 0362  0012              VECT    C_MOVA
                            p 0363  0009 p            ADRL    ltrl2
                            p 0364  00FD p            ADRL    XACTION-MSGTYP

       180     180            MOVE NODE-PORT TO T-NODE-PORT.
                            p 0365  0012              VECT    C_MOVA
                            p 0366  011B p            ADRL    NODE-PORT
                            p 0367  0127 p            ADRL    T-NODE-PORT

       181     181            MOVE CONTROLLER-DEVICE TO T-CONTROLLER-DEVICE.
                            p 0368  0012              VECT    C_MOVA
                            p 0369  0121 p            ADRL    CONTROLLER-DEVICE
                            p 036A  012A p            ADRL    T-CONTROLLER-DEVICE

       182     182            MOVE LINE-INFO-BUF TO COMMAND-XACTION.
                            p 036B  0011              VECT    C_MOVG
                            p 036C  0124 p            ADRL    LINE-INFO-BUF
                            p 036D  00CD p            ADRL    COMMAND-XACTION
                            p 036E  8053              DATA    X'8053'       ' S'

       183     183            WRITE COMMAND-XACTION.
                            p 036F  0040              VECT    C_WRTRAN
                            p 0370  02EE p            ADRL    XACTION
                            p 0371  0053              DATA    X'0053'

       184     184            IF DEVICE-IS-HARDCOPY
                            p 0372  000D              VECT    C_IFCNDN
                            p 0373  011E p            ADRL    DEVICE-TYPE
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 47
                            p 0374  02EC p            ADRL    DEVICE-IS-HARDCOPY
                            p 0375  0000              DATA    X'0000'
                            p 0376  0032 f            ADRL    jump1

       185     185              GO TO 100-READ-TPA-TTY.
                            p 0377  0008              VECT    C_GOTO
                            p 0378  0033 f            ADRL    100-READ-TPA-TTY

       186     186

       187     187        100-READ-TPA.

                                    0379 p  jump1     EQU     $$


       188     188       *-------------

       189     189            MOVE SPACES TO WRITE-XACTION.
                            p 0379  0012              VECT    C_MOVA  -TPA
                            p 037A  0010 p            ADRL    ltrl3
                            p 037B  00C4 p            ADRL    WRITE-XACTION

       190     190            PERFORM 150-READ-XACTION.
                            p 037C  001B              VECT    C_PERFM
                            p 037D  0034 f            ADRL    150-READ-XACTION
                            p 037E  0035 f            ADRL    perf0
                            p 037F  0000              DATA    X'0000'

       191     191

       192     192            GO TO 200-BEGIN,
                            p 0380  0052              VECT    C_CNVNBT
                            p 0381  00C7 p            ADRL    FUNCTION
                            p 0382  0036 f            ADRL    temp0
                            p 0383  0009              VECT    C_GOTODP
                            p 0384  0036 f            ADRL    temp0
                            p 0385  0005              DATA    X'0005'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 48
                            p 0386  0037 f            ADRL    200-BEGIN
                            p 0387  0038 f            ADRL    300-DONT-CLEAR-LINE-PRINT-MSG
                            p 0388  0039 f            ADRL    600-READ-COMMAND
                            p 0389  003A f            ADRL    700-REPORT-STATIONMAX
                            p 038A  003B f            ADRL    400-PRINT-MSG

       193     193              300-DONT-CLEAR-LINE-PRINT-MSG,

       194     194              600-READ-COMMAND,

       195     195              700-REPORT-STATIONMAX,

       196     196              400-PRINT-MSG,

       197     197              DEPENDING ON FUNCTION IN WRITE-XACTION.

       198     198

       199     199        150-READ-XACTION.

                                    038B p  <-------  DEFINE  150-READ-XACTION


       200     200       *-----------------

       201     201            IF (FIRST-READ) OR (STARTUP)
                            p 038B  000D    fref0034  VECT    C_IFCNDN
                            p 038C  0106 p            ADRL    FIRST-READ-FLAG
                            p 038D  02E0 p            ADRL    FIRST-READ
                            p 038E  0010              DATA    X'0010'
                            p 038F  003C f            ADRL    jump2
                            p 0390  000D              VECT    C_IFCNDN
                            p 0391  010C p            ADRL    STARTUP-FLAG
                            p 0392  02E4 p            ADRL    STARTUP
                            p 0393  0000              DATA    X'0000'
                            p 0394  003D f            ADRL    jump3

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 49
       202     202               READ XACTION
                            p 0395  0035    jump2     VECT    C_RDTRAN
                            p 0396  02EE p            ADRL    XACTION
                            p 0397  0000              DATA    X'0000'

       203     203               MOVE 0 TO FIRST-READ-FLAG
                            p 0398  0013              VECT    C_MOVN
                            p 0399  0014 p            ADRL    ltrl4
                            p 039A  0106 p            ADRL    FIRST-READ-FLAG

       204     204            ELSE

       205     205               READ XACTION NO DATA
                            p 039B  0008              VECT    C_GOTO
                            p 039C  003E f            ADRL    jump4
                            p 039D  0035    jump3     VECT    C_RDTRAN
                            p 039E  02EE p            ADRL    XACTION
                            p 039F  0001              DATA    X'0001'
                            p 03A0  005E              VECT    C_JND
                            p 03A1  003F f            ADRL    jump5

       206     206                  GO TO 600-READ-COMMAND.
                            p 03A2  0008              VECT    C_GOTO
                            p 03A3  0039 f            ADRL    600-READ-COMMAND

                                    03A4 p  jump5     EQU     $$


       207     207

       208     208

       209     209

       210     210        200-BEGIN.
                            p 03A4  001D    jump4     VECT    C_PERFMT
                            p 03A5  0035 f            ADRL    perf0
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 50

                                    03A6 p  <-------  DEFINE  200-BEGIN


       211     211       *----------

       212     212       *    LOAD BEGIN-MSGTYP IN BEGIN-XACTION BY TYPE

       213     213       *      NO PROGRAM GO TO 600-READ-COMMAND.

       214     214       *

       215     215       *    For C00, just exit.

       216     216       *    TPA takes care of the rest.

       217     217       *    Trust me.

       218     218            IF (STARTUP) AND (GOT-HEADER)
                            p 03A6  000D    fref0037  VECT    C_IFCNDN
                            p 03A7  010C p            ADRL    STARTUP-FLAG
                            p 03A8  02E4 p            ADRL    STARTUP
                            p 03A9  0000              DATA    X'0000'
                            p 03AA  0040 f            ADRL    jump6
                            p 03AB  000D              VECT    C_IFCNDN
                            p 03AC  0109 p            ADRL    GOT-HEADER-FLAG
                            p 03AD  02E2 p            ADRL    GOT-HEADER
                            p 03AE  0000              DATA    X'0000'
                            p 03AF  0040 f            ADRL    jump6

       219     219                STOP "Hit return to continue".
                            p 03B0  0026              VECT    C_STOPLT
                            p 03B1  0004              DATA    X'0004'
                            p 03B2  0000              DATA    X'0000'
                            p 03B3  0018 p            ADRL    ltrl5

       220     220            STOP RUN.
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 51
                            p 03B4  0025    jump6     VECT    C_STOP

       221     221

       222     222        300-DONT-CLEAR-LINE-PRINT-MSG.

                                    03B5 p  <-------  DEFINE  300-DONT-CLEAR-LINE-PRINT-MSG


       223     223       *-------------------------

       224     224            MOVE "N" TO CLEAR-COMMAND-SW.
                            p 03B5  0012    fref0038  VECT    C_MOVA
                            p 03B6  0026 p            ADRL    ltrl6
                            p 03B7  00D9 p            ADRL    CLEAR-COMMAND-SW

       225     225       *

       226     226       * The side efect of the "GO TO" is that the NEXT

       227     227       * line to be executed is 400-PRINT-MSG, which is

       228     228       * exactly where I was going to "GO TO".

       229     229

       230     230        400-PRINT-MSG.

                                    03B8 p  <-------  DEFINE  400-PRINT-MSG


       231     231       *--------------

       232     232            IF (STARTUP)
                            p 03B8  000D    fref003B  VECT    C_IFCNDN
                            p 03B9  010C p            ADRL    STARTUP-FLAG
                            p 03BA  02E4 p            ADRL    STARTUP
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 52
                            p 03BB  0000              DATA    X'0000'
                            p 03BC  0041 f            ADRL    jump7

       233     233               MOVE 1 TO GOT-HEADER-FLAG.
                            p 03BD  0013              VECT    C_MOVN
                            p 03BE  0005 p            ADRL    ltrl1
                            p 03BF  0109 p            ADRL    GOT-HEADER-FLAG

       234     234            PERFORM 800-TITLE-SETUP.
                            p 03C0  001B    jump7     VECT    C_PERFM
                            p 03C1  0042 f            ADRL    800-TITLE-SETUP
                            p 03C2  0043 f            ADRL    perf1
                            p 03C3  0000              DATA    X'0000'

       235     235            MOVE TEXT IN WRITE-XACTION TO SAVE-MESSAGE.
                            p 03C4  0012              VECT    C_MOVA
                            p 03C5  00CA p            ADRL    TEXT
                            p 03C6  00E2 p            ADRL    SAVE-MESSAGE

       236     236            PERFORM 800-PRINT-LINE.
                            p 03C7  001B              VECT    C_PERFM
                            p 03C8  0044 f            ADRL    800-PRINT-LINE
                            p 03C9  0045 f            ADRL    perf2
                            p 03CA  0000              DATA    X'0000'

       237     237            GO TO 100-READ-TPA.
                            p 03CB  0008              VECT    C_GOTO
                            p 03CC  0379 p            ADRL    100-READ-TPA

       238     238

       239     239        600-READ-COMMAND.

                                    03CD p  <-------  DEFINE  600-READ-COMMAND


       240     240       *-----------------
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 53

       241     241

       242     242       *

       243     243       * IF STAND-ALONE-PRINTER-FLAG

       244     244       *   MOVE "*RAS" TO XACTION-MSGTYP

       245     245       *   WRITE COMMAND-XACTION

       246     246       * GO TO 100-READ-TPA.

       247     247       *

       248     248       *  We have received permission from TPA to accept commands

       249     249       *  therefore we are done with STARTUP.

       250     250               MOVE 0 TO STARTUP-FLAG.
                            p 03CD  0013    fref0039  VECT    C_MOVN
                            p 03CE  0014 p            ADRL    ltrl4
                            p 03CF  010C p            ADRL    STARTUP-FLAG

       251     251            PERFORM 800-TITLE-SETUP.
                            p 03D0  001B              VECT    C_PERFM
                            p 03D1  0042 f            ADRL    800-TITLE-SETUP
                            p 03D2  0043 f            ADRL    perf1
                            p 03D3  0000              DATA    X'0000'

       252     252            MOVE 1 TO MORE-MSGS-FLAG.
                            p 03D4  0013              VECT    C_MOVN
                            p 03D5  0005 p            ADRL    ltrl1
                            p 03D6  00F7 p            ADRL    MORE-MSGS-FLAG

       253     253            PERFORM 800-GET-PRINT-MSG THRU
                            p 03D7  000A    jump8     VECT    C_IFRELN
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 54
                            p 03D8  00F7 p            ADRL    MORE-MSGS-FLAG
                            p 03D9  0014 p            ADRL    ltrl4
                            p 03DA  0012              DATA    X'0012'
                            p 03DB  0046 f            ADRL    jump9
                            p 03DC  001B              VECT    C_PERFM
                            p 03DD  0047 f            ADRL    800-GET-PRINT-MSG
                            p 03DE  0048 f            ADRL    perf3
                            p 03DF  0000              DATA    X'0000'
                            p 03E0  0008              VECT    C_GOTO
                            p 03E1  03D7 p            ADRL    jump8

       254     254                800-GET-PRINT-MSG-EXIT UNTIL

       255     255                MORE-MSGS-FLAG = 0.

       256     256

       257     257            ENABLE INPUT COMMAND-INPUT.
                            p 03E2  002E    jump9     VECT    C_ENABL
                            p 03E3  2001              DATA    X'2001'
                            p 03E4  0169 p            ADRL    COMMAND-INPUT

       258     258            IF CLEAR-COMMAND THEN
                            p 03E5  000E              VECT    C_IFCNDA
                            p 03E6  00D9 p            ADRL    CLEAR-COMMAND-SW
                            p 03E7  02DC p            ADRL    CLEAR-COMMAND
                            p 03E8  0000              DATA    X'0000'
                            p 03E9  0049 f            ADRL    jump10

       259     259               CLEAR INPUT COMMAND-INPUT.
                            p 03EA  0044              VECT    C_CLEAR
                            p 03EB  2001              DATA    X'2001'
                            p 03EC  0169 p            ADRL    COMMAND-INPUT

       260     260            MOVE "Y" TO CLEAR-COMMAND-SW.
                            p 03ED  0012    jump10    VECT    C_MOVA
                            p 03EE  0001 p            ADRL    ltrl0
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 55
                            p 03EF  00D9 p            ADRL    CLEAR-COMMAND-SW

       261     261            ACCEPT COMMAND.
                            p 03F0  0000              VECT    C_ACCPT
                            p 03F1  0001              DATA    X'0001'
                            p 03F2  0188 p            ADRL    COMMAND

       262     262            VERIFY SAVE-COMMAND.
                            p 03F3  0043              VECT    C_VERIFY
                            p 03F4  0001              DATA    X'0001'
                            p 03F5  0188 p            ADRL    COMMAND
                            p 03F6  00DC p            ADRL    SAVE-COMMAND

       263     263            DISABLE INPUT COMMAND.
                            p 03F7  002F              VECT    C_DSABL
                            p 03F8  2001              DATA    X'2001'
                            p 03F9  0188 p            ADRL    COMMAND

       264     264            CLEAR I-O FOR MSG-OUTPUT.
                            p 03FA  0044              VECT    C_CLEAR
                            p 03FB  6001              DATA    X'6001'
                            p 03FC  0198 p            ADRL    MSG-OUTPUT

       265     265            MOVE 0 TO LINES-DISPLAYED.
                            p 03FD  0013              VECT    C_MOVN
                            p 03FE  0014 p            ADRL    ltrl4
                            p 03FF  00FA p            ADRL    LINES-DISPLAYED

       266     266            MOVE "*TPCMD" TO XACTION-MSGTYP.
                            p 0400  0012              VECT    C_MOVA
                            p 0401  002A p            ADRL    ltrl7
                            p 0402  00FD p            ADRL    XACTION-MSGTYP

       267     267            MOVE SAVE-COMMAND TO TEXT IN COMMAND-XACTION.
                            p 0403  0012              VECT    C_MOVA
                            p 0404  00DC p            ADRL    SAVE-COMMAND
                            p 0405  00D0 p            ADRL    TEXT
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 56

       268     268            WRITE COMMAND-XACTION.
                            p 0406  0040              VECT    C_WRTRAN
                            p 0407  02EE p            ADRL    XACTION
                            p 0408  0053              DATA    X'0053'

       269     269            MOVE 1 TO FIRST-READ-FLAG.
                            p 0409  0013              VECT    C_MOVN
                            p 040A  0005 p            ADRL    ltrl1
                            p 040B  0106 p            ADRL    FIRST-READ-FLAG

       270     270            GO TO 100-READ-TPA.
                            p 040C  0008              VECT    C_GOTO
                            p 040D  0379 p            ADRL    100-READ-TPA

       271     271

       272     272

       273     273        700-REPORT-STATIONMAX.

                                    040E p  <-------  DEFINE  700-REPORT-STATIONMAX


       274     274       *----------------------

       275     275            STOP PAUSING FOR 1 SECONDS
                            p 040E  0026    fref003A  VECT    C_STOPLT
                            p 040F  0003              DATA    X'0003'
                            p 0410  0005 p            ADRL    ltrl1
                            p 0411  0030 p            ADRL    ltrl8

       276     276                 POSTING

       277     277                 "No more TP users allowed.  Maximum station count exceed

       278     278       -          "ed.".
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 57

       279     279            STOP RUN.
                            p 0412  0025              VECT    C_STOP

       280     280

       281     281        800-TITLE-SETUP.

                                    0413 p  <-------  DEFINE  800-TITLE-SETUP


       282     282       *----------------

       283     283            IF TITLES-UP-FLAG = 0
                            p 0413  000A    fref0042  VECT    C_IFRELN
                            p 0414  00F4 p            ADRL    TITLES-UP-FLAG
                            p 0415  0014 p            ADRL    ltrl4
                            p 0416  0002              DATA    X'0002'
                            p 0417  004A f            ADRL    jump11

       284     284              OPEN I-O SCREEN
                            p 0418  0031              VECT    C_OPEN
                            p 0419  6001              DATA    X'6001'
                            p 041A  02FE p            ADRL    SCREEN

       285     285              ACTIVATE SCREEN
                            p 041B  002B              VECT    C_ACTIV
                            p 041C  0001              DATA    X'0001'
                            p 041D  02FE p            ADRL    SCREEN

       286     286              MOVE 1 TO TITLES-UP-FLAG
                            p 041E  0013              VECT    C_MOVN
                            p 041F  0005 p            ADRL    ltrl1
                            p 0420  00F4 p            ADRL    TITLES-UP-FLAG

       287     287              DISABLE INPUT COMMAND-INPUT
                            p 0421  002F              VECT    C_DSABL
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 58
                            p 0422  2001              DATA    X'2001'
                            p 0423  0169 p            ADRL    COMMAND-INPUT

       288     288              WRITE CONSTANT-TITLES-RECORD.
                            p 0424  0041              VECT    C_WRFORM
                            p 0425  0000              DATA    X'0000'
                            p 0426  0139 p            ADRL    CONSTANT-TITLES-RECORD

       289     289

       290     290        800-PRINT-LINE.
                            p 0427  001D    jump11    VECT    C_PERFMT
                            p 0428  0043 f            ADRL    perf1

                                    0429 p  <-------  DEFINE  800-PRINT-LINE


       291     291       *--------------

       292     292            ADD 1 TO LINES-DISPLAYED.
                            p 0429  0003    fref0044  VECT    C_ADD
                            p 042A  0005 p            ADRL    ltrl1
                            p 042B  00FA p            ADRL    LINES-DISPLAYED

       293     293            IF LINES-DISPLAYED = 17
                            p 042C  000A              VECT    C_IFRELN
                            p 042D  00FA p            ADRL    LINES-DISPLAYED
                            p 042E  0050 p            ADRL    ltrl9
                            p 042F  0002              DATA    X'0002'
                            p 0430  004B f            ADRL    jump12

       294     294              MOVE 1 TO LINES-DISPLAYED
                            p 0431  0013              VECT    C_MOVN
                            p 0432  0005 p            ADRL    ltrl1
                            p 0433  00FA p            ADRL    LINES-DISPLAYED

       295     295              STOP "Hit return to continue"
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 59
                            p 0434  0026              VECT    C_STOPLT
                            p 0435  0004              DATA    X'0004'
                            p 0436  0000              DATA    X'0000'
                            p 0437  0054 p            ADRL    ltrl10

       296     296              CLEAR I-O FOR MSG-OUTPUT.
                            p 0438  0044              VECT    C_CLEAR
                            p 0439  6001              DATA    X'6001'
                            p 043A  0198 p            ADRL    MSG-OUTPUT

       297     297

       298     298            MOVE SAVE-MESSAGE TO MESSAGE-LINE(LINES-DISPLAYED).
                            p 043B  0052    jump12    VECT    C_CNVNBT
                            p 043C  00FA p            ADRL    LINES-DISPLAYED
                            p 043D  0036 f            ADRL    temp0
                            p 043E  004B              VECT    C_SUBSCR
                            p 043F  00E5 p            ADRL    MESSAGE-LINE
                            p 0440  0036 f            ADRL    temp0
                            p 0441  004C f            ADRL    dumy0
                            p 0442  0012              VECT    C_MOVA
                            p 0443  00E2 p            ADRL    SAVE-MESSAGE
                            p 0444  004C f            ADRL    dumy0

       299     299            PRESENT MESSAGE-LINE(LINES-DISPLAYED).
                            p 0445  0052              VECT    C_CNVNBT
                            p 0446  00FA p            ADRL    LINES-DISPLAYED
                            p 0447  0036 f            ADRL    temp0
                            p 0448  004B              VECT    C_SUBSCR
                            p 0449  00E5 p            ADRL    MESSAGE-LINE
                            p 044A  0036 f            ADRL    temp0
                            p 044B  004C f            ADRL    dumy0
                            p 044C  004B              VECT    C_SUBSCR
                            p 044D  01C4 p            ADRL    A-LINE
                            p 044E  0036 f            ADRL    temp0
                            p 044F  004D f            ADRL    dumy1
                            p 0450  0042              VECT    C_PRESNT
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 60
                            p 0451  0001              DATA    X'0001'
                            p 0452  004C f            ADRL    dumy0
                            p 0453  004D f            ADRL    dumy1

       300     300            WRITE DETAIL-LINES.
                            p 0454  0041              VECT    C_WRFORM
                            p 0455  0000              DATA    X'0000'
                            p 0456  01A6 p            ADRL    DETAIL-LINES

       301     301

       302     302        800-GET-PRINT-MSG.
                            p 0457  001D              VECT    C_PERFMT
                            p 0458  0045 f            ADRL    perf2

                                    0459 p  <-------  DEFINE  800-GET-PRINT-MSG


       303     303       *------------------

       304     304            MOVE SPACES TO MSGG-RECORD.
                            p 0459  0012    fref0047  VECT    C_MOVA
                            p 045A  0010 p            ADRL    ltrl3
                            p 045B  00D3 p            ADRL    MSGG-RECORD

       305     305            READ MSGG NO DATA
                            p 045C  0035              VECT    C_RDTRAN
                            p 045D  0310 p            ADRL    MSGG
                            p 045E  0001              DATA    X'0001'
                            p 045F  005E              VECT    C_JND
                            p 0460  004E f            ADRL    jump13

       306     306              MOVE 0 TO MORE-MSGS-FLAG
                            p 0461  0013              VECT    C_MOVN
                            p 0462  0014 p            ADRL    ltrl4
                            p 0463  00F7 p            ADRL    MORE-MSGS-FLAG

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 61
       307     307              GO TO 800-GET-PRINT-MSG-EXIT.
                            p 0464  0008              VECT    C_GOTO
                            p 0465  004F f            ADRL    800-GET-PRINT-MSG-EXIT

       308     308

       309     309            MOVE TEXT IN MSGG-RECORD TO SAVE-MESSAGE.
                            p 0466  0012    jump13    VECT    C_MOVA
                            p 0467  00D6 p            ADRL    TEXT
                            p 0468  00E2 p            ADRL    SAVE-MESSAGE

       310     310            PERFORM 800-PRINT-LINE.
                            p 0469  001B              VECT    C_PERFM
                            p 046A  0429 p            ADRL    800-PRINT-LINE
                            p 046B  0045 f            ADRL    perf2
                            p 046C  0000              DATA    X'0000'

       311     311

       312     312        800-GET-PRINT-MSG-EXIT.

                                    046D p  <-------  DEFINE  800-GET-PRINT-MSG-EXIT


       313     313       *-----------------------

       314     314            EXIT.

       315     315

       316     316        100-READ-TPA-TTY.
                            p 046D  001D    fref004F  VECT    C_PERFMT
                            p 046E  0048 f            ADRL    perf3

                                    046F p  <-------  DEFINE  100-READ-TPA-TTY


WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 62
       317     317       *-----------------

       318     318            MOVE SPACES TO WRITE-XACTION.
                            p 046F  0012    fref0033  VECT    C_MOVA
                            p 0470  0010 p            ADRL    ltrl3
                            p 0471  00C4 p            ADRL    WRITE-XACTION

       319     319            PERFORM 150-READ-XACTION-TTY.
                            p 0472  001B              VECT    C_PERFM
                            p 0473  0050 f            ADRL    150-READ-XACTION-TTY
                            p 0474  0051 f            ADRL    perf4
                            p 0475  0000              DATA    X'0000'

       320     320

       321     321            GO TO 200-BEGIN-TTY,
                            p 0476  0052              VECT    C_CNVNBT
                            p 0477  00C7 p            ADRL    FUNCTION
                            p 0478  0036 f            ADRL    temp0
                            p 0479  0009              VECT    C_GOTODP
                            p 047A  0036 f            ADRL    temp0
                            p 047B  0004              DATA    X'0004'
                            p 047C  0052 f            ADRL    200-BEGIN-TTY
                            p 047D  0053 f            ADRL    400-PRINT-MSG-TTY
                            p 047E  0054 f            ADRL    600-READ-COMMAND-TTY
                            p 047F  0055 f            ADRL    700-REPORT-STATIONMAX-TTY

       322     322              400-PRINT-MSG-TTY,

       323     323              600-READ-COMMAND-TTY,

       324     324              700-REPORT-STATIONMAX-TTY,

       325     325              DEPENDING ON FUNCTION IN WRITE-XACTION.

       326     326

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 63
       327     327        150-READ-XACTION-TTY.

                                    0480 p  <-------  DEFINE  150-READ-XACTION-TTY


       328     328       *---------------------

       329     329            IF (FIRST-READ) OR (STARTUP)
                            p 0480  000D    fref0050  VECT    C_IFCNDN
                            p 0481  0106 p            ADRL    FIRST-READ-FLAG
                            p 0482  02E0 p            ADRL    FIRST-READ
                            p 0483  0010              DATA    X'0010'
                            p 0484  0056 f            ADRL    jump14
                            p 0485  000D              VECT    C_IFCNDN
                            p 0486  010C p            ADRL    STARTUP-FLAG
                            p 0487  02E4 p            ADRL    STARTUP
                            p 0488  0000              DATA    X'0000'
                            p 0489  0057 f            ADRL    jump15

       330     330               READ XACTION
                            p 048A  0035    jump14    VECT    C_RDTRAN
                            p 048B  02EE p            ADRL    XACTION
                            p 048C  0000              DATA    X'0000'

       331     331               MOVE 0 TO FIRST-READ-FLAG
                            p 048D  0013              VECT    C_MOVN
                            p 048E  0014 p            ADRL    ltrl4
                            p 048F  0106 p            ADRL    FIRST-READ-FLAG

       332     332            ELSE

       333     333               READ XACTION NO DATA
                            p 0490  0008              VECT    C_GOTO
                            p 0491  0058 f            ADRL    jump16
                            p 0492  0035    jump15    VECT    C_RDTRAN
                            p 0493  02EE p            ADRL    XACTION
                            p 0494  0001              DATA    X'0001'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 64
                            p 0495  005E              VECT    C_JND
                            p 0496  0059 f            ADRL    jump17

       334     334                  GO TO 600-READ-COMMAND-TTY.
                            p 0497  0008              VECT    C_GOTO
                            p 0498  0054 f            ADRL    600-READ-COMMAND-TTY

                                    0499 p  jump17    EQU     $$


       335     335

       336     336

       337     337

       338     338        200-BEGIN-TTY.
                            p 0499  001D    jump16    VECT    C_PERFMT
                            p 049A  0051 f            ADRL    perf4

                                    049B p  <-------  DEFINE  200-BEGIN-TTY


       339     339       *--------------

       340     340       *    LOAD BEGIN-MSGTYP IN BEGIN-XACTION BY TYPE

       341     341       *      NO PROGRAM GO TO 600-READ-COMMAND-TTY.

       342     342            IF (STARTUP) AND (GOT-HEADER)
                            p 049B  000D    fref0052  VECT    C_IFCNDN
                            p 049C  010C p            ADRL    STARTUP-FLAG
                            p 049D  02E4 p            ADRL    STARTUP
                            p 049E  0000              DATA    X'0000'
                            p 049F  005A f            ADRL    jump18
                            p 04A0  000D              VECT    C_IFCNDN
                            p 04A1  0109 p            ADRL    GOT-HEADER-FLAG
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 65
                            p 04A2  02E2 p            ADRL    GOT-HEADER
                            p 04A3  0000              DATA    X'0000'
                            p 04A4  005A f            ADRL    jump18

       343     343                STOP "Hit return to continue".
                            p 04A5  0026              VECT    C_STOPLT
                            p 04A6  0004              DATA    X'0004'
                            p 04A7  0000              DATA    X'0000'
                            p 04A8  0062 p            ADRL    ltrl11

       344     344            STOP RUN.
                            p 04A9  0025    jump18    VECT    C_STOP

       345     345

       346     346        400-PRINT-MSG-TTY.

                                    04AA p  <-------  DEFINE  400-PRINT-MSG-TTY


       347     347       *------------------

       348     348            IF (STARTUP)
                            p 04AA  000D    fref0053  VECT    C_IFCNDN
                            p 04AB  010C p            ADRL    STARTUP-FLAG
                            p 04AC  02E4 p            ADRL    STARTUP
                            p 04AD  0000              DATA    X'0000'
                            p 04AE  005B f            ADRL    jump19

       349     349               MOVE 1 TO GOT-HEADER-FLAG.
                            p 04AF  0013              VECT    C_MOVN
                            p 04B0  0005 p            ADRL    ltrl1
                            p 04B1  0109 p            ADRL    GOT-HEADER-FLAG

       350     350            PERFORM 800-TITLE-SETUP-TTY.
                            p 04B2  001B    jump19    VECT    C_PERFM
                            p 04B3  005C f            ADRL    800-TITLE-SETUP-TTY
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 66
                            p 04B4  005D f            ADRL    perf5
                            p 04B5  0000              DATA    X'0000'

       351     351            MOVE TEXT IN WRITE-XACTION TO SAVE-MESSAGE.
                            p 04B6  0012              VECT    C_MOVA
                            p 04B7  00CA p            ADRL    TEXT
                            p 04B8  00E2 p            ADRL    SAVE-MESSAGE

       352     352            PERFORM 800-PRINT-LINE-TTY.
                            p 04B9  001B              VECT    C_PERFM
                            p 04BA  005E f            ADRL    800-PRINT-LINE-TTY
                            p 04BB  005F f            ADRL    perf6
                            p 04BC  0000              DATA    X'0000'

       353     353            GO TO 100-READ-TPA-TTY.
                            p 04BD  0008              VECT    C_GOTO
                            p 04BE  046F p            ADRL    100-READ-TPA-TTY

       354     354

       355     355        600-READ-COMMAND-TTY.

                                    04BF p  <-------  DEFINE  600-READ-COMMAND-TTY


       356     356       *---------------------

       357     357

       358     358       *

       359     359       * IF STAND-ALONE-PRINTER-FLAG

       360     360       *   MOVE "*RAS" TO XACTION-MSGTYP

       361     361       *   WRITE COMMAND-XACTION

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 67
       362     362       * GO TO 100-READ-TPA-TTY.

       363     363       *

       364     364       *  We have received permission from TPA to accept commands

       365     365       *  therefore we are done with STARTUP.

       366     366               MOVE 0 TO STARTUP-FLAG.
                            p 04BF  0013    fref0054  VECT    C_MOVN
                            p 04C0  0014 p            ADRL    ltrl4
                            p 04C1  010C p            ADRL    STARTUP-FLAG

       367     367            PERFORM 800-TITLE-SETUP-TTY.
                            p 04C2  001B              VECT    C_PERFM
                            p 04C3  005C f            ADRL    800-TITLE-SETUP-TTY
                            p 04C4  005D f            ADRL    perf5
                            p 04C5  0000              DATA    X'0000'

       368     368            MOVE 1 TO MORE-MSGS-FLAG.
                            p 04C6  0013              VECT    C_MOVN
                            p 04C7  0005 p            ADRL    ltrl1
                            p 04C8  00F7 p            ADRL    MORE-MSGS-FLAG

       369     369            PERFORM 800-GET-PRINT-MSG-TTY THRU
                            p 04C9  000A    jump20    VECT    C_IFRELN
                            p 04CA  00F7 p            ADRL    MORE-MSGS-FLAG
                            p 04CB  0014 p            ADRL    ltrl4
                            p 04CC  0012              DATA    X'0012'
                            p 04CD  0060 f            ADRL    jump21
                            p 04CE  001B              VECT    C_PERFM
                            p 04CF  0061 f            ADRL    800-GET-PRINT-MSG-TTY
                            p 04D0  0062 f            ADRL    perf7
                            p 04D1  0000              DATA    X'0000'
                            p 04D2  0008              VECT    C_GOTO
                            p 04D3  04C9 p            ADRL    jump20

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 68
       370     370                800-GET-PRINT-MSG-EXIT-TTY UNTIL

       371     371                MORE-MSGS-FLAG = 0.

       372     372            IF NOT PAGE-1-TTY-IS-OPEN
                            p 04D4  000D    jump21    VECT    C_IFCNDN
                            p 04D5  0112 p            ADRL    PAGE-1-TTY-IS-OPEN-FLAG
                            p 04D6  02E8 p            ADRL    PAGE-1-TTY-IS-OPEN
                            p 04D7  0010              DATA    X'0010'
                            p 04D8  0063 f            ADRL    jump22

       373     373            THEN

       374     374              MOVE 1 TO PAGE-1-TTY-IS-OPEN-FLAG
                            p 04D9  0013              VECT    C_MOVN
                            p 04DA  0005 p            ADRL    ltrl1
                            p 04DB  0112 p            ADRL    PAGE-1-TTY-IS-OPEN-FLAG

       375     375              MOVE 0 TO LINES-DISPLAYED
                            p 04DC  0013              VECT    C_MOVN
                            p 04DD  0014 p            ADRL    ltrl4
                            p 04DE  00FA p            ADRL    LINES-DISPLAYED

       376     376              IF PAGE-2-TTY-IS-OPEN
                            p 04DF  000D              VECT    C_IFCNDN
                            p 04E0  0115 p            ADRL    PAGE-2-TTY-IS-OPEN-FLAG
                            p 04E1  02EA p            ADRL    PAGE-2-TTY-IS-OPEN
                            p 04E2  0000              DATA    X'0000'
                            p 04E3  0064 f            ADRL    jump23

       377     377              THEN

       378     378                MOVE 0 TO PAGE-2-TTY-IS-OPEN-FLAG
                            p 04E4  0013              VECT    C_MOVN
                            p 04E5  0014 p            ADRL    ltrl4
                            p 04E6  0115 p            ADRL    PAGE-2-TTY-IS-OPEN-FLAG

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 69
       379     379                WRITE PAGE
                            p 04E7  0041              VECT    C_WRFORM
                            p 04E8  8000              DATA    X'8000'
                            p 04E9  0000              DATA    X'0000'

       380     380                CLOSE PAGE-2-TTY
                            p 04EA  002A              VECT    C_CLOSE
                            p 04EB  0001              DATA    X'0001'
                            p 04EC  0000              DATA    X'0000'
                            p 04ED  0333 p            ADRL    PAGE-2-TTY

       381     381                OPEN I-O PAGE-1-TTY
                            p 04EE  0031              VECT    C_OPEN
                            p 04EF  6001              DATA    X'6001'
                            p 04F0  031F p            ADRL    PAGE-1-TTY

       382     382                ACTIVATE PAGE-1-TTY
                            p 04F1  002B              VECT    C_ACTIV
                            p 04F2  0001              DATA    X'0001'
                            p 04F3  031F p            ADRL    PAGE-1-TTY

       383     383              ELSE

       384     384                OPEN I-O PAGE-1-TTY
                            p 04F4  0008              VECT    C_GOTO
                            p 04F5  0065 f            ADRL    jump24
                            p 04F6  0031    jump23    VECT    C_OPEN
                            p 04F7  6001              DATA    X'6001'
                            p 04F8  031F p            ADRL    PAGE-1-TTY

       385     385                ACTIVATE PAGE-1-TTY.
                            p 04F9  002B              VECT    C_ACTIV
                            p 04FA  0001              DATA    X'0001'
                            p 04FB  031F p            ADRL    PAGE-1-TTY

                                    04FC p  jump24    EQU     $$

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 70

       386     386            IF LINES-DISPLAYED > 0 AND NOT ALREADY-BEEN-PROMPTED
                            p 04FC  000A    jump22    VECT    C_IFRELN
                            p 04FD  00FA p            ADRL    LINES-DISPLAYED
                            p 04FE  0014 p            ADRL    ltrl4
                            p 04FF  0000              DATA    X'0000'
                            p 0500  0066 f            ADRL    jump25
                            p 0501  000D              VECT    C_IFCNDN
                            p 0502  010F p            ADRL    ALREADY-BEEN-PROMPTED-FLAG
                            p 0503  02E6 p            ADRL    ALREADY-BEEN-PROMPTED
                            p 0504  0010              DATA    X'0010'
                            p 0505  0066 f            ADRL    jump25

       387     387            THEN

       388     388              WRITE PAGE.
                            p 0506  0041              VECT    C_WRFORM
                            p 0507  8000              DATA    X'8000'
                            p 0508  0000              DATA    X'0000'

       389     389            WRITE PROMPT-TTY.
                            p 0509  0041    jump25    VECT    C_WRFORM
                            p 050A  0000              DATA    X'0000'
                            p 050B  0295 p            ADRL    PROMPT-TTY

       390     390            ENABLE INPUT COMMAND-INPUT-TTY.
                            p 050C  002E              VECT    C_ENABL
                            p 050D  2001              DATA    X'2001'
                            p 050E  02A7 p            ADRL    COMMAND-INPUT-TTY

       391     391            ACCEPT COMMAND-TTY.
                            p 050F  0000              VECT    C_ACCPT
                            p 0510  0001              DATA    X'0001'
                            p 0511  02CA p            ADRL    COMMAND-TTY

       392     392            VERIFY SAVE-COMMAND-TTY.
                            p 0512  0043              VECT    C_VERIFY
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 71
                            p 0513  0001              DATA    X'0001'
                            p 0514  02CA p            ADRL    COMMAND-TTY
                            p 0515  00DF p            ADRL    SAVE-COMMAND-TTY

       393     393            MOVE 1 TO ALREADY-BEEN-PROMPTED-FLAG.
                            p 0516  0013              VECT    C_MOVN
                            p 0517  0005 p            ADRL    ltrl1
                            p 0518  010F p            ADRL    ALREADY-BEEN-PROMPTED-FLAG

       394     394            CLEAR ALL I-O FOR CP6-LOGO,
                            p 0519  0044              VECT    C_CLEAR
                            p 051A  E003              DATA    X'E003'
                            p 051B  0284 p            ADRL    CP6-LOGO
                            p 051C  0295 p            ADRL    PROMPT-TTY
                            p 051D  01FB p            ADRL    DETAIL-LINES-ON-PAGE-1

       395     395                              PROMPT-TTY,

       396     396                              DETAIL-LINES-ON-PAGE-1.

       397     397            MOVE 0 TO LINES-DISPLAYED.
                            p 051E  0013              VECT    C_MOVN
                            p 051F  0014 p            ADRL    ltrl4
                            p 0520  00FA p            ADRL    LINES-DISPLAYED

       398     398            DISABLE INPUT COMMAND-TTY.
                            p 0521  002F              VECT    C_DSABL
                            p 0522  2001              DATA    X'2001'
                            p 0523  02CA p            ADRL    COMMAND-TTY

       399     399            MOVE "*TPCMD" TO XACTION-MSGTYP.
                            p 0524  0012              VECT    C_MOVA
                            p 0525  002A p            ADRL    ltrl7
                            p 0526  00FD p            ADRL    XACTION-MSGTYP

       400     400            MOVE SAVE-COMMAND-TTY TO TEXT IN COMMAND-XACTION.
                            p 0527  0012              VECT    C_MOVA
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 72
                            p 0528  00DF p            ADRL    SAVE-COMMAND-TTY
                            p 0529  00D0 p            ADRL    TEXT

       401     401            WRITE COMMAND-XACTION.
                            p 052A  0040              VECT    C_WRTRAN
                            p 052B  02EE p            ADRL    XACTION
                            p 052C  0053              DATA    X'0053'

       402     402            MOVE 1 TO FIRST-READ-FLAG.
                            p 052D  0013              VECT    C_MOVN
                            p 052E  0005 p            ADRL    ltrl1
                            p 052F  0106 p            ADRL    FIRST-READ-FLAG

       403     403            GO TO 100-READ-TPA-TTY.
                            p 0530  0008              VECT    C_GOTO
                            p 0531  046F p            ADRL    100-READ-TPA-TTY

       404     404

       405     405

       406     406        700-REPORT-STATIONMAX-TTY.

                                    0532 p  <-------  DEFINE  700-REPORT-STATIONMAX-TTY


       407     407       *--------------------------

       408     408            STOP PAUSING FOR 1 SECONDS
                            p 0532  0026    fref0055  VECT    C_STOPLT
                            p 0533  0003              DATA    X'0003'
                            p 0534  0005 p            ADRL    ltrl1
                            p 0535  0070 p            ADRL    ltrl12

       409     409                 POSTING

       410     410                 "No more TP users allowed.  Maximum station count exceed
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 73

       411     411       -          "ed.".

       412     412            STOP RUN.
                            p 0536  0025              VECT    C_STOP

       413     413

       414     414        800-TITLE-SETUP-TTY.

                                    0537 p  <-------  DEFINE  800-TITLE-SETUP-TTY


       415     415       *--------------------

       416     416            IF FIRST-TIME-THROUGH
                            p 0537  000D    fref005C  VECT    C_IFCNDN
                            p 0538  0103 p            ADRL    FIRST-TIME-THROUGH-FLAG
                            p 0539  02DE p            ADRL    FIRST-TIME-THROUGH
                            p 053A  0000              DATA    X'0000'
                            p 053B  0067 f            ADRL    jump26

       417     417            THEN

       418     418              MOVE 0 TO FIRST-TIME-THROUGH-FLAG
                            p 053C  0013              VECT    C_MOVN
                            p 053D  0014 p            ADRL    ltrl4
                            p 053E  0103 p            ADRL    FIRST-TIME-THROUGH-FLAG

       419     419              OPEN I-O PAGE-1-TTY
                            p 053F  0031              VECT    C_OPEN
                            p 0540  6001              DATA    X'6001'
                            p 0541  031F p            ADRL    PAGE-1-TTY

       420     420              MOVE 1 TO PAGE-1-TTY-IS-OPEN-FLAG
                            p 0542  0013              VECT    C_MOVN
                            p 0543  0005 p            ADRL    ltrl1
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 74
                            p 0544  0112 p            ADRL    PAGE-1-TTY-IS-OPEN-FLAG

       421     421              ACTIVATE PAGE-1-TTY
                            p 0545  002B              VECT    C_ACTIV
                            p 0546  0001              DATA    X'0001'
                            p 0547  031F p            ADRL    PAGE-1-TTY

       422     422              WRITE CP6-LOGO
                            p 0548  0041              VECT    C_WRFORM
                            p 0549  0000              DATA    X'0000'
                            p 054A  0284 p            ADRL    CP6-LOGO

       423     423              DISABLE INPUT COMMAND-INPUT-TTY.
                            p 054B  002F              VECT    C_DSABL
                            p 054C  2001              DATA    X'2001'
                            p 054D  02A7 p            ADRL    COMMAND-INPUT-TTY

       424     424

       425     425        800-PRINT-LINE-TTY.
                            p 054E  001D    jump26    VECT    C_PERFMT
                            p 054F  005D f            ADRL    perf5

                                    0550 p  <-------  DEFINE  800-PRINT-LINE-TTY


       426     426       *------------------

       427     427            IF LINES-DISPLAYED = 0
                            p 0550  000A    fref005E  VECT    C_IFRELN
                            p 0551  00FA p            ADRL    LINES-DISPLAYED
                            p 0552  0014 p            ADRL    ltrl4
                            p 0553  0002              DATA    X'0002'
                            p 0554  0068 f            ADRL    jump27

       428     428            THEN

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 75
       429     429              WRITE A-SPACE.
                            p 0555  0041              VECT    C_WRFORM
                            p 0556  0000              DATA    X'0000'
                            p 0557  01EB p            ADRL    A-SPACE

       430     430            ADD 1 TO LINES-DISPLAYED.
                            p 0558  0003    jump27    VECT    C_ADD
                            p 0559  0005 p            ADRL    ltrl1
                            p 055A  00FA p            ADRL    LINES-DISPLAYED

       431     431            IF PAGE-1-TTY-IS-OPEN
                            p 055B  000D              VECT    C_IFCNDN
                            p 055C  0112 p            ADRL    PAGE-1-TTY-IS-OPEN-FLAG
                            p 055D  02E8 p            ADRL    PAGE-1-TTY-IS-OPEN
                            p 055E  0000              DATA    X'0000'
                            p 055F  0069 f            ADRL    jump28

       432     432            THEN

       433     433              IF LINES-DISPLAYED = 21
                            p 0560  000A              VECT    C_IFRELN
                            p 0561  00FA p            ADRL    LINES-DISPLAYED
                            p 0562  0090 p            ADRL    ltrl13
                            p 0563  0002              DATA    X'0002'
                            p 0564  006A f            ADRL    jump29

       434     434              THEN

       435     435                MOVE 1 TO LINES-DISPLAYED
                            p 0565  0013              VECT    C_MOVN
                            p 0566  0005 p            ADRL    ltrl1
                            p 0567  00FA p            ADRL    LINES-DISPLAYED

       436     436                WRITE PAGE
                            p 0568  0041              VECT    C_WRFORM
                            p 0569  8000              DATA    X'8000'
                            p 056A  0000              DATA    X'0000'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 76

       437     437                CLOSE PAGE-1-TTY
                            p 056B  002A              VECT    C_CLOSE
                            p 056C  0001              DATA    X'0001'
                            p 056D  0000              DATA    X'0000'
                            p 056E  031F p            ADRL    PAGE-1-TTY

       438     438                MOVE 0 TO PAGE-1-TTY-IS-OPEN-FLAG
                            p 056F  0013              VECT    C_MOVN
                            p 0570  0014 p            ADRL    ltrl4
                            p 0571  0112 p            ADRL    PAGE-1-TTY-IS-OPEN-FLAG

       439     439                OPEN OUTPUT PAGE-2-TTY
                            p 0572  0031              VECT    C_OPEN
                            p 0573  4001              DATA    X'4001'
                            p 0574  0333 p            ADRL    PAGE-2-TTY

       440     440                MOVE 1 TO PAGE-2-TTY-IS-OPEN-FLAG
                            p 0575  0013              VECT    C_MOVN
                            p 0576  0005 p            ADRL    ltrl1
                            p 0577  0115 p            ADRL    PAGE-2-TTY-IS-OPEN-FLAG

       441     441                ACTIVATE PAGE-2-TTY
                            p 0578  002B              VECT    C_ACTIV
                            p 0579  0001              DATA    X'0001'
                            p 057A  0333 p            ADRL    PAGE-2-TTY

       442     442                PERFORM 800-WRITE-TO-PAGE-2-TTY
                            p 057B  001B              VECT    C_PERFM
                            p 057C  006B f            ADRL    800-WRITE-TO-PAGE-2-TTY
                            p 057D  006C f            ADRL    perf8
                            p 057E  0000              DATA    X'0000'

       443     443              ELSE

       444     444                PERFORM 800-WRITE-TO-PAGE-1-TTY
                            p 057F  0008              VECT    C_GOTO
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 77
                            p 0580  006D f            ADRL    jump30
                            p 0581  001B    jump29    VECT    C_PERFM
                            p 0582  006E f            ADRL    800-WRITE-TO-PAGE-1-TTY
                            p 0583  006F f            ADRL    perf9
                            p 0584  0000              DATA    X'0000'

       445     445            ELSE

       446     446              IF PAGE-2-TTY-IS-OPEN
                            p 0585  0008              VECT    C_GOTO
                            p 0586  006D f            ADRL    jump30
                            p 0587  000D    jump28    VECT    C_IFCNDN
                            p 0588  0115 p            ADRL    PAGE-2-TTY-IS-OPEN-FLAG
                            p 0589  02EA p            ADRL    PAGE-2-TTY-IS-OPEN
                            p 058A  0000              DATA    X'0000'
                            p 058B  0070 f            ADRL    jump31

       447     447              THEN

       448     448                IF LINES-DISPLAYED = 25
                            p 058C  000A              VECT    C_IFRELN
                            p 058D  00FA p            ADRL    LINES-DISPLAYED
                            p 058E  0094 p            ADRL    ltrl14
                            p 058F  0002              DATA    X'0002'
                            p 0590  0071 f            ADRL    jump32

       449     449                THEN

       450     450                  MOVE 1 TO LINES-DISPLAYED
                            p 0591  0013              VECT    C_MOVN
                            p 0592  0005 p            ADRL    ltrl1
                            p 0593  00FA p            ADRL    LINES-DISPLAYED

       451     451                  WRITE PAGE
                            p 0594  0041              VECT    C_WRFORM
                            p 0595  8000              DATA    X'8000'
                            p 0596  0000              DATA    X'0000'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 78

       452     452                  PERFORM 800-WRITE-TO-PAGE-2-TTY
                            p 0597  001B              VECT    C_PERFM
                            p 0598  006B f            ADRL    800-WRITE-TO-PAGE-2-TTY
                            p 0599  006C f            ADRL    perf8
                            p 059A  0000              DATA    X'0000'

       453     453                ELSE

       454     454                  PERFORM 800-WRITE-TO-PAGE-2-TTY.
                            p 059B  0008              VECT    C_GOTO
                            p 059C  006D f            ADRL    jump30
                            p 059D  001B    jump32    VECT    C_PERFM
                            p 059E  006B f            ADRL    800-WRITE-TO-PAGE-2-TTY
                            p 059F  006C f            ADRL    perf8
                            p 05A0  0000              DATA    X'0000'

                                    05A1 p  jump31    EQU     $$


       455     455

       456     456        800-WRITE-TO-PAGE-1-TTY.
                            p 05A1  001D    jump30    VECT    C_PERFMT
                            p 05A2  005F f            ADRL    perf6

                                    05A3 p  <-------  DEFINE  800-WRITE-TO-PAGE-1-TTY


       457     457       *------------------------

       458     458            MOVE SAVE-MESSAGE TO MESSAGE-LINE-ON-PAGE-1
                            p 05A3  0052    fref006E  VECT    C_CNVNBT
                            p 05A4  00FA p            ADRL    LINES-DISPLAYED
                            p 05A5  0036 f            ADRL    temp0
                            p 05A6  004B              VECT    C_SUBSCR
                            p 05A7  00EA p            ADRL    MESSAGE-LINE-ON-PAGE-1
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 79
                            p 05A8  0036 f            ADRL    temp0
                            p 05A9  004C f            ADRL    dumy0
                            p 05AA  0012              VECT    C_MOVA
                            p 05AB  00E2 p            ADRL    SAVE-MESSAGE
                            p 05AC  004C f            ADRL    dumy0

       459     459                                 (LINES-DISPLAYED).

       460     460            PRESENT MESSAGE-LINE-ON-PAGE-1 (LINES-DISPLAYED).
                            p 05AD  0052              VECT    C_CNVNBT
                            p 05AE  00FA p            ADRL    LINES-DISPLAYED
                            p 05AF  0036 f            ADRL    temp0
                            p 05B0  004B              VECT    C_SUBSCR
                            p 05B1  00EA p            ADRL    MESSAGE-LINE-ON-PAGE-1
                            p 05B2  0036 f            ADRL    temp0
                            p 05B3  004C f            ADRL    dumy0
                            p 05B4  004B              VECT    C_SUBSCR
                            p 05B5  0217 p            ADRL    A-LINE-ON-PAGE-1
                            p 05B6  0036 f            ADRL    temp0
                            p 05B7  004D f            ADRL    dumy1
                            p 05B8  0042              VECT    C_PRESNT
                            p 05B9  0001              DATA    X'0001'
                            p 05BA  004C f            ADRL    dumy0
                            p 05BB  004D f            ADRL    dumy1

       461     461            WRITE DETAIL-LINES-ON-PAGE-1.
                            p 05BC  0041              VECT    C_WRFORM
                            p 05BD  0000              DATA    X'0000'
                            p 05BE  01FB p            ADRL    DETAIL-LINES-ON-PAGE-1

       462     462

       463     463        800-WRITE-TO-PAGE-2-TTY.
                            p 05BF  001D              VECT    C_PERFMT
                            p 05C0  006F f            ADRL    perf9

                                    05C1 p  <-------  DEFINE  800-WRITE-TO-PAGE-2-TTY
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 80


       464     464       *------------------------

       465     465            MOVE SAVE-MESSAGE TO MESSAGE-LINE-ON-PAGE-2
                            p 05C1  0052    fref006B  VECT    C_CNVNBT
                            p 05C2  00FA p            ADRL    LINES-DISPLAYED
                            p 05C3  0036 f            ADRL    temp0
                            p 05C4  004B              VECT    C_SUBSCR
                            p 05C5  00EF p            ADRL    MESSAGE-LINE-ON-PAGE-2
                            p 05C6  0036 f            ADRL    temp0
                            p 05C7  004C f            ADRL    dumy0
                            p 05C8  0012              VECT    C_MOVA
                            p 05C9  00E2 p            ADRL    SAVE-MESSAGE
                            p 05CA  004C f            ADRL    dumy0

       466     466                                 (LINES-DISPLAYED).

       467     467            PRESENT MESSAGE-LINE-ON-PAGE-2 (LINES-DISPLAYED).
                            p 05CB  0052              VECT    C_CNVNBT
                            p 05CC  00FA p            ADRL    LINES-DISPLAYED
                            p 05CD  0036 f            ADRL    temp0
                            p 05CE  004B              VECT    C_SUBSCR
                            p 05CF  00EF p            ADRL    MESSAGE-LINE-ON-PAGE-2
                            p 05D0  0036 f            ADRL    temp0
                            p 05D1  004C f            ADRL    dumy0
                            p 05D2  004B              VECT    C_SUBSCR
                            p 05D3  025F p            ADRL    A-LINE-ON-PAGE-2
                            p 05D4  0036 f            ADRL    temp0
                            p 05D5  004D f            ADRL    dumy1
                            p 05D6  0042              VECT    C_PRESNT
                            p 05D7  0001              DATA    X'0001'
                            p 05D8  004C f            ADRL    dumy0
                            p 05D9  004D f            ADRL    dumy1

       468     468            WRITE DETAIL-LINES-ON-PAGE-2.
                            p 05DA  0041              VECT    C_WRFORM
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 81
                            p 05DB  0000              DATA    X'0000'
                            p 05DC  0243 p            ADRL    DETAIL-LINES-ON-PAGE-2

       469     469

       470     470        800-GET-PRINT-MSG-TTY.
                            p 05DD  001D              VECT    C_PERFMT
                            p 05DE  006C f            ADRL    perf8

                                    05DF p  <-------  DEFINE  800-GET-PRINT-MSG-TTY


       471     471       *----------------------

       472     472            MOVE SPACES TO MSGG-RECORD.
                            p 05DF  0012    fref0061  VECT    C_MOVA
                            p 05E0  0010 p            ADRL    ltrl3
                            p 05E1  00D3 p            ADRL    MSGG-RECORD

       473     473            READ MSGG NO DATA
                            p 05E2  0035              VECT    C_RDTRAN
                            p 05E3  0310 p            ADRL    MSGG
                            p 05E4  0001              DATA    X'0001'
                            p 05E5  005E              VECT    C_JND
                            p 05E6  0072 f            ADRL    jump33

       474     474              MOVE 0 TO MORE-MSGS-FLAG
                            p 05E7  0013              VECT    C_MOVN
                            p 05E8  0014 p            ADRL    ltrl4
                            p 05E9  00F7 p            ADRL    MORE-MSGS-FLAG

       475     475              GO TO 800-GET-PRINT-MSG-EXIT-TTY.
                            p 05EA  0008              VECT    C_GOTO
                            p 05EB  0073 f            ADRL    800-GET-PRINT-MSG-EXIT-TTY

       476     476

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 82
       477     477            MOVE TEXT IN MSGG-RECORD TO SAVE-MESSAGE.
                            p 05EC  0012    jump33    VECT    C_MOVA
                            p 05ED  00D6 p            ADRL    TEXT
                            p 05EE  00E2 p            ADRL    SAVE-MESSAGE

       478     478            PERFORM 800-PRINT-LINE-TTY.
                            p 05EF  001B              VECT    C_PERFM
                            p 05F0  0550 p            ADRL    800-PRINT-LINE-TTY
                            p 05F1  005F f            ADRL    perf6
                            p 05F2  0000              DATA    X'0000'

       479     479

       480     480        800-GET-PRINT-MSG-EXIT-TTY.

                                    05F3 p  <-------  DEFINE  800-GET-PRINT-MSG-EXIT-TTY


       481     481       *---------------------------

       482     482            EXIT.
                            p 05F3  001D    fref0073  VECT    C_PERFMT
                            p 05F4  0062 f            ADRL    perf7
                            p 05F5  0025              VECT    C_STOP
                            p 05F6  8200    temp0     DATA    X'8200'
                            p 05F7  0000              DATA    X'0000'
                            p 05F8  14AE d            ADRL    data+X'14AE'
                            d 14AE  0200              DATA    X'0200'
                            d 14AF  0000              DATA    X'0000'
                            d 14B0  14B1 d            ADRL    data+X'14B1'
                            d 14B1  0000              DATA    X'0000'*9
                            p 05F9  8000    dumy0     DATA    X'8000'
                            p 05FA  0000              DATA    X'0000'
                            p 05FB  14BA d            ADRL    data+X'14BA'
                            d 14BA  0000              DATA    X'0000'
                            d 14BB  0000              DATA    X'0000'
                            d 14BC  14BD d            ADRL    data+X'14BD'
WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 83
                            d 14BD  0000              DATA    X'0000'*17
                            p 05FC  8000    dumy1     DATA    X'8000'
                            p 05FD  0000              DATA    X'0000'
                            p 05FE  14CE d            ADRL    data+X'14CE'
                            d 14CE  0000              DATA    X'0000'
                            d 14CF  0000              DATA    X'0000'
                            d 14D0  14D1 d            ADRL    data+X'14D1'
                            d 14D1  0000              DATA    X'0000'*17
                            d 14E2  0000    perf0     DATA    X'0000'*4
                            d 14E6  0000    perf1     DATA    X'0000'*4
                            d 14EA  0000    perf2     DATA    X'0000'*4
                            d 14EE  0000    perf3     DATA    X'0000'*4
                            d 14F2  0000    perf4     DATA    X'0000'*4
                            d 14F6  0000    perf5     DATA    X'0000'*4
                            d 14FA  0000    perf6     DATA    X'0000'*4
                            d 14FE  0000    perf7     DATA    X'0000'*4
                            d 1502  0000    perf8     DATA    X'0000'*4
                            d 1506  0000    perf9     DATA    X'0000'*4
                            d 150A  0000              DATA    X'0000'
                            d 0000  150B              DATA    X'150B'
                            p 0000  05FF              DATA    X'05FF'

WED 07/30/97 05:43:27.32    Program COMMAND-FP                       Honeywell CP-6 FPL E02          Page 84
                          * * Storage allocation map * *

    Start loc          End loc           Words                Area allocated

     X'0001'           X'0057'            87                  Special registers
     X'0058'           X'0081'            42                  XACTION
                                          0                   SCREEN
     X'0082'           X'00AB'            42                  MSGG
                                          0                   PAGE-1-TTY
                                          0                   PAGE-2-TTY
                                          0                   TITLES
     X'00AC'           X'00CF'            36                  COMMAND-INPUT
     X'00D0'           X'034F'            640                 MSG-OUTPUT
     X'0350'           X'035D'            14                  TITLES-TTY
     X'035E'           X'0380'            35                  COMMAND-INPUT-TTY
     X'0381'           X'0651'            721                 MSG-OUTPUT-ON-PAGE-1-TTY
     X'0652'           X'09B1'            864                 MSG-OUTPUT-ON-PAGE-2-TTY
     X'09B2'           X'13BC'            2571                Working-storage
     X'13BD'           X'150A'            334                 Run-time scratch

  Errors:         none
  Procedure size: 05FF
  Data size:      150B

