VERSION E05

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:1    
        1        1        /*M* OCN$KEYIN KEYINs routine to parse and process keyins */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,SQB,AND,ENI=0,SDI=3,CSI=0,ECI=0,IND=0,IAD=3,MOC,MEC,CLM=0,MCL=1,EXM=0 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*
       10       10         ###    ###   #   #   #   #   #  #####  #   #   ###   #   #
       11       11        #   #  #   #  #   #  ###  #  #   #      #   #    #    #   #
       12       12        #   #  #      ##  # # #   # #    #       # #     #    ##  #
       13       13        #   #  #      # # #  ###  ##     ####     #      #    # # #
       14       14        #   #  #      #  ##   # # # #    #        #      #    #  ##
       15       15        #   #  #   #  #   #  ###  #  #   #        #      #    #   #
       16       16         ###    ###   #   #   #   #   #  #####    #     ###   #   #
       17       17                                                                   */
       18       18
       19       19        OCN$KEYIN: PROC(KEY_BUF,KEYSIZE,KEY_STA);
       20       20
       21       21    1   DCL KEY_BUF CHAR(KEYSIZE) UNAL; /* BUFFER FOR KEYIN                           */
       22       22    1   DCL KEY_STA CHAR (8) UNAL;
       23       23    1   DCL KEYSIZE UBIN WORD;
       24       24
       25       25    1   DCL OCL$STATUS ENTRY(1);
       26       26    1   DCL OCP$FINDCX ENTRY(2);
       27       27    1   DCL OCP$OCCG ENTRY;
       28       28    1   DCL OCP$PENDRMV ENTRY(1);
       29       29    1   DCL OCS$SYNTAX ENTRY;
       30       30    1   DCL OCO$IWRITE ENTRY(8);
       31       31    1   DCL OCW$WRITE ENTRY(5);
       32       32    1   DCL OCL$LISTIT ENTRY(9);
       33       33    1   DCL OCL$HOFF ENTRY(1);
       34       34    1   DCL OCL$HON ENTRY(1);
       35       35    1   DCL OCL$RLS ENTRY(2);
       36       36    1   DCL OCR$SREAD ENTRY(2);
       37       37    1   DCL OCR$CREAD ENTRY (1);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:2    
       38       38
       39       39    1   DCL M$CSCG DCB;
       40       40    1   DCL M$OCCG DCB;
       41       41
       42       42    1   DCL I STATIC UBIN WORD;
       43       43    1   DCL ZI STATIC UBIN WORD;
       44       44    1   DCL J STATIC SBIN WORD;
       45       45    1   DCL INDEX_ UBIN WORD;
       46       46    1   DCL PASS_INDEX UBIN WORD STATIC ALIGNED INIT (0);
       47       47    1   DCL SIZE UBIN WORD;
       48       48    1   DCL PTR$ PTR;
       49       49    1   DCL TXTC$ PTR;
       50       50    1   DCL NEXT$ PTR STATIC;
       51       51    1   DCL H1_PTR$ PTR;
       52       52    1   DCL H2_PTR$ PTR;
       53       53    1   DCL H3_PTR$ PTR;
       54       54    1   DCL HELP_FLAG BIT(1) STATIC CALIGNED;
       55       55    1   DCL 1 GHST_TEMPLAT STATIC,
       56       56    1          2 * CHAR(4) UNAL INIT ('GHST'),
       57       57    1          2 SYSID UBIN(18) UNAL INIT(0),
       58       58    1          2 CADDR UBIN(18) UNAL INIT(0);
       59       59    1   DCL GHST_TEMPLATC REDEF GHST_TEMPLAT CHAR(8) ;
       60       60    1   DCL FOUND BIT(1) STATIC ALIGNED;
       61       61    1   DCL NOT_FOUND BIT(1) STATIC ALIGNED;
       62       62    1   DCL CADDR BIT(18) STATIC ALIGNED;
       63       63    1   DCL HELP_INDEX UBIN WORD STATIC;
       64       64    1   DCL HELP_ASN UBIN WORD STATIC;
       65       65    1   DCL WORD_ UBIN WORD STATIC ALIGNED;
       66       66    1   DCL BLOCK UBIN (9) STATIC;
       67       67    1   DCL 1 TP_INSTRUCTION STATIC CALIGNED,
       68       68    1          2 * UBIN BYTE CALIGNED INIT (0),
       69       69    1          2 KEY_NUM UBIN BYTE CALIGNED INIT (0),
       70       70    1          2 ATTR UBIN HALF CALIGNED INIT (0),
       71       71    1          2 LENGTH UBIN BYTE CALIGNED INIT (0),
       72       72    1          2 INSTRUCT CHAR (95) CALIGNED INIT (' ');
       73       73
       74       74 S      %INCLUDE B$JIT_C;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:3    
       75       75        %INCLUDE CP_6;
       76      156        %INCLUDE B_SEGIDS_C;
       77      695        %INCLUDE OC$PEND;
       78      740        %INCLUDE OCS_SUBS_C;
       79      957        %INCLUDE OC_SUBS_C;
       80     1688        %INCLUDE OCD_SUBS_C;
       81     1706        %INCLUDE OCI_SUBS_C;
       82     1804        %INCLUDE JG_GHOSTS_C;
       83     1894        %INCLUDE EL$TABLES;
       84     2217        %INCLUDE EL_SUBS_C;
       85     2301        %INCLUDE OCP_DATA_R;
       86     2318        %INCLUDE OC_DAT_R;
       87     2479        %INCLUDE OCS_DATA_R;
       88     2496        %INCLUDE OCD_DATA_R;
       89     2509        %INCLUDE PC_MACRO_C;
       90     2535        %INCLUDE QQ_MACROS_C;
       91     2960
       92     2961        %B$JIT0;
       93     3050        %U$JIT1;
       94     3124        %A$JIT6X;
       95     3127    1   DCL B$JIT$ PTR SYMREF;
       96     3128    1   DCL B$TCB$ PTR SYMREF;
       97     3129        %B$TCB;
       98     3132        %B$ALT;
       99     3140    1   DCL 1 ERROR STATIC,
      100     3141    1          2 * CHAR(1) INIT(' ') UNAL,
      101     3142    1          2 NUM CHAR(2) UNAL;
      102     3143    1   DCL 1 TEXT BASED,
      103     3144    1          2 CNT UBIN BYTE UNAL,
      104     3145    1          2 C CHAR(TEXT.CNT) UNAL;
      105     3146    1   DCL 1 OC$MESSAGE BASED,
      106     3147    1          2 MK_VECT UBIN BYTE UNAL,
      107     3148    1          2 KEYIN# UBIN BYTE UNAL,
      108     3149    1          2 CADDR BIT(18) UNAL,
      109     3150    1          2 TEXT CHAR (%(140 /* CSCG_MAXMC# */ - 4)) UNAL;
      110     3151
      111     3152    1   DCL 1 OC$SETACCT BASED,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:4    
      112     3153    1          2 * UBIN WORD UNAL,
      113     3154    1          2 ACCT CHAR(8) UNAL;
      114     3155    1   DCL 1 OC$AUTO BASED,
      115     3156    1          2 * UBIN WORD UNAL,
      116     3157    1          2 HOUR UBIN BYTE CALIGNED,
      117     3158    1          2 MIN UBIN BYTE CALIGNED;
      118     3159    1   DCL 1 OC$HELP1 BASED CALIGNED,
      119     3160    1          2 * UBIN WORD CALIGNED,
      120     3161    1          2 DASH UBIN BYTE UNAL;
      121     3162    1   DCL 1 HELP_OUTPUT (0:0) BASED,
      122     3163    1          2 LINE CHAR(79) CALIGNED;
      123     3164    1   DCL 1 OC$READ$ BASED,
      124     3165    1          2 * UBIN WORD UNAL,
      125     3166    1          2 LOGON CHAR(8) UNAL,
      126     3167    1          2 STATION CHAR(8) UNAL;
      127     3168    1   DCL 1 OC$TERMSEND BASED,
      128     3169    1          2 * UBIN WORD UNAL,
      129     3170    1          2 TERM CHAR(8) UNAL,
      130     3171    1          2 SIZE UBIN(9) UNAL,
      131     3172    1          2 MESSAGE CHAR(OC$TERMSEND.SIZE);
      132     3173
      133     3174    1   DCL 1 OC$COMM BASED,
      134     3175    1          2 * UBIN WORD UNAL,
      135     3176    1          2 DEVICE CHAR(4) UNAL,
      136     3177    1          2 AT_TERM CHAR(8) UNAL,
      137     3178    1          2 TERM CHAR(8) UNAL,
      138     3179    1          2 COUNT UBIN BYTE UNAL,
      139     3180    1          2 TEXT CHAR(OC$COMM.COUNT) UNAL;
      140     3181
      141     3182    1   DCL 1 OC$NAT BASED,
      142     3183    1          2 * UBIN WORD UNAL,
      143     3184    1          2 LANG CHAR(1) UNAL;
      144     3185
      145     3186    1   DCL 1 OC$PROFILE BASED CALIGNED,
      146     3187    1          2 * UBIN WORD CALIGNED,
      147     3188    1          2 P_COUNT UBIN BYTE CALIGNED,
      148     3189    1          2 P_NAME CHAR (11) CALIGNED;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:5    
      149     3190
      150     3191    1   DCL 1 OC$PWIDTH BASED CALIGNED,
      151     3192    1          2 * UBIN WORD CALIGNED,
      152     3193    1          2 PWIDTH UBIN WORD CALIGNED;
      153     3194
      154     3195    1   DCL 1 OC$STARTTP BASED CALIGNED,
      155     3196    1          2 * UBIN WORD CALIGNED,
      156     3197    1          2 ACCT CHAR(8) CALIGNED,
      157     3198    1          2 I_CNT UBIN BYTE CALIGNED,
      158     3199    1          2 INSTANCE CHAR(OC$STARTTP.I_CNT) CALIGNED;
      159     3200
      160     3201    1   DCL 1 OC$TPPASS BASED CALIGNED,
      161     3202    1          2 PASS CHAR(8) CALIGNED;
      162     3203
      163     3204    1   DCL 1 OC$TPSEND BASED CALIGNED,
      164     3205    1          2 * UBIN HALF CALIGNED,
      165     3206    1          2 ATTR UBIN HALF CALIGNED,
      166     3207    1          2 TP_STA CHAR(8) CALIGNED,
      167     3208    1          2 TP_LEN UBIN BYTE CALIGNED,
      168     3209    1          2 TP_CMD CHAR(OC$TPSEND.TP_LEN) CALIGNED;
      169     3210
      170     3211    1   DCL BIG_BUF BASED CHAR(140) CALIGNED;
      171     3212
      172     3213    1   DCL 1 GENKEYIN_MSGB STATIC CALIGNED,
      173     3214    1          2 ERR UBIN WORD UNAL INIT (0),
      174     3215    1          2 ERROR REDEF ERR BIT(36) UNAL,
      175     3216    1          2 CODE UBIN BYTE UNAL INIT (0);
      176     3217
      177     3218    1   DCL 1 GENKEYIN_MSGC STATIC CALIGNED,
      178     3219    1          2 * UBIN BYTE UNAL INIT(4),
      179     3220    1          2 * UBIN BYTE UNAL INIT(1);
      180     3221
      181     3222    1   DCL 1 REGULAR_READB STATIC,
      182     3223    1          2 * UBIN BYTE UNAL INIT (2),
      183     3224    1          2 * UBIN BYTE UNAL INIT (2),
      184     3225    1          2 * UBIN BYTE UNAL INIT (8);
      185     3226
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:6    
      186     3227    1   DCL 1 REGULAR_READC STATIC,
      187     3228    1          2 * UBIN(18) UNAL INIT(0),
      188     3229    1          2 SIZER UBIN(18) UNAL,
      189     3230    1          2 ACCT CHAR(8) UNAL;
      190     3231
      191     3232    1   DCL 1 GHST_READB STATIC,
      192     3233    1          2 * UBIN BYTE UNAL INIT(2);
      193     3234
      194     3235    1   DCL 1 GHST_READC STATIC,
      195     3236    1          2 COUNT_ UBIN HALF UNAL;
      196     3237
      197     3238    1   DCL 1 MASTER_WRITE STATIC UNAL,
      198     3239    1          2 TERM CHAR(8) UNAL,
      199     3240    1          2 MESS CHAR(80) UNAL;
      200     3241
      201     3242    1   DCL 1 MASTER_WRITEC STATIC UNAL,
      202     3243    1          2 * UBIN BYTE UNAL INIT(8),
      203     3244    1          2 SIZE UBIN BYTE UNAL INIT(0);
      204     3245
      205     3246    1   DCL BYTES_ UBIN BYTE STATIC UNAL;
      206     3247
      207     3248    1   DCL 1 INFO_WRITEC STATIC UNAL,
      208     3249    1          2 * UBIN BYTE UNAL INIT(1),
      209     3250    1          2 * UBIN BYTE UNAL INIT(4);
      210     3251
      211     3252    1   DCL 1 INFO_WRITEB STATIC UNAL,
      212     3253    1          2 CODE UBIN BYTE UNAL,
      213     3254    1          2 INFO UBIN WORD UNAL;
      214     3255
      215     3256    1   DCL 1 TELL_WRITEC STATIC UNAL,
      216     3257    1          2 * UBIN BYTE UNAL INIT(4),
      217     3258    1          2 * UBIN BYTE UNAL INIT(8),
      218     3259    1          2 SIZE UBIN BYTE UNAL INIT(0);
      219     3260
      220     3261    1   DCL 1 TELL_WRITEB STATIC UNAL,
      221     3262    1          2 CONSOLE CHAR(4) UNAL,
      222     3263    1          2 TERM CHAR(8) UNAL,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:7    
      223     3264    1          2 TEXT CHAR(80) UNAL;
      224     3265
      225     3266    1   DCL 1 PROFMSGC STATIC UNAL,
      226     3267    1          2 * UBIN BYTE UNAL INIT(4),
      227     3268    1          2 * UBIN BYTE UNAL INIT(1);
      228     3269
      229     3270    1   DCL 1 PROFMSGB STATIC UNAL,
      230     3271    1          2 ERR UBIN WORD UNAL INIT(0),
      231     3272    1          2 ERROR REDEF ERR BIT(36) UNAL,
      232     3273    1          2 CODE UBIN BYTE UNAL INIT(0);
      233     3274
      234     3275    1   DCL 1 PWIDTH_MSGC STATIC CALIGNED,
      235     3276    1          2 * UBIN BYTE CALIGNED INIT(4);
      236     3277
      237     3278    1   DCL 1 PWIDTH_MSGB STATIC CALIGNED,
      238     3279    1          2 PWIDTH UBIN WORD CALIGNED;
      239     3280
      240     3281    1   DCL 1 HELP_MSGB STATIC CALIGNED,
      241     3282    1          2 HMSG CHAR (79) CALIGNED INIT (' '),
      242     3283    1          2 ERR UBIN WORD UNAL INIT (0),
      243     3284    1          2 ERROR REDEF ERR BIT(36) UNAL,
      244     3285    1          2 CODE UBIN BYTE UNAL INIT (0);
      245     3286
      246     3287    1   DCL 1 HELP_MSGC STATIC CALIGNED,
      247     3288    1          2 * UBIN BYTE CALIGNED INIT (79),
      248     3289    1          2 * UBIN BYTE UNAL INIT (4),
      249     3290    1          2 * UBIN BYTE UNAL INIT (1);
      250     3291
      251     3292    1   DCL 1 LPWSN_MSGC STATIC CALIGNED,
      252     3293    1          2 * UBIN BYTE CALIGNED INIT(8);
      253     3294
      254     3295    1   DCL 1 LPWSN_MSGB STATIC CALIGNED,
      255     3296    1          2 LPWSN CHAR(8) CALIGNED INIT(' ');
      256     3297
      257     3298    1   DCL 1 GJOB_INT_MSGB STATIC CALIGNED,
      258     3299    1          2 ERR UBIN WORD UNAL INIT (0),
      259     3300    1          2 ERROR REDEF ERR BIT (36) UNAL,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:8    
      260     3301    1          2 CODE UBIN BYTE UNAL INIT (0);
      261     3302
      262     3303    1   DCL 1 GJOB_INT_MSGC STATIC CALIGNED,
      263     3304    1          2 * UBIN BYTE UNAL INIT (4),
      264     3305    1          2 * UBIN BYTE UNAL INIT (1);
      265     3306
      266     3307    1   DCL 1 STA_MSGB STATIC CALIGNED,
      267     3308    1          2 STATION CHAR (8) CALIGNED INIT (' '),
      268     3309    1          2 CODE UBIN BYTE UNAL INIT (0);
      269     3310
      270     3311    1   DCL 1 STA_MSGC STATIC CALIGNED,
      271     3312    1          2 * UBIN BYTE UNAL INIT (8),
      272     3313    1          2 * UBIN BYTE UNAL INIT (1);
      273     3314
      274     3315    1   DCL 1 ZAP_PHASE_MSGB STATIC CALIGNED,
      275     3316    1          2 PHASE UBIN BYTE UNAL INIT (0),
      276     3317    1          2 TIME CHAR (11) UNAL INIT (' '),
      277     3318    1          2 MING UBIN WORD UNAL;
      278     3319
      279     3320    1   DCL 1 ZAP_PHASE_MSGC STATIC CALIGNED,
      280     3321    1          2 * UBIN BYTE UNAL INIT (1),
      281     3322    1          2 * UBIN BYTE UNAL INIT (11),
      282     3323    1          2 * UBIN BYTE UNAL INIT (4);
      283     3324
      284     3325    1   DCL 1 TP_MSGB STATIC CALIGNED,
      285     3326    1          2 ERR UBIN WORD UNAL INIT (0),
      286     3327    1          2 ERROR REDEF ERR BIT (36),
      287     3328    1          2 CODE UBIN BYTE UNAL,
      288     3329    1          2 TPNAME CHAR(8) UNAL;
      289     3330
      290     3331    1   DCL 1 TP_MSGC STATIC CALIGNED,
      291     3332    1          2 * UBIN BYTE UNAL INIT(4),
      292     3333    1          2 * UBIN BYTE UNAL INIT(1),
      293     3334    1          2 * UBIN BYTE UNAL INIT (8);
      294     3335
      295     3336    1   DCL 1 STATS_WRITEB STATIC UNAL,
      296     3337    1          2 SUB_MESS# UBIN BYTE UNAL,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:9    
      297     3338    1          2 GHOST_ACTIVE UBIN BYTE UNAL,
      298     3339    1          2 HIST UBIN BYTE UNAL,
      299     3340    1          2 ACCT_HR UBIN BYTE UNAL,
      300     3341    1          2 ACCT_MIN UBIN BYTE UNAL,
      301     3342    1          2 HIST_HR UBIN BYTE UNAL,
      302     3343    1          2 HIST_MIN UBIN BYTE UNAL,
      303     3344    1          2 UPPER UBIN BYTE UNAL,
      304     3345    1          2 TIME UBIN BYTE UNAL,
      305     3346    1          2 NATLANG CHAR(1) UNAL,
      306     3347    1          2 SYSRACCT CHAR(8) UNAL,
      307     3348    1          2 MYREADA CHAR (8) UNAL,
      308     3349    1          2 MXPRIO UBIN BYTE UNAL,
      309     3350    1          2 I_SYS BIT(9) UNAL,
      310     3351    1          2 I_DEV BIT(9) UNAL,
      311     3352    1          2 I_ADMN BIT(9) UNAL,
      312     3353    1          2 I_DLTA BIT(9) UNAL,
      313     3354    1          2 I_LIB BIT(9) UNAL,
      314     3355    1          2 I_COMM BIT(9) UNAL,
      315     3356    1          2 O_SYS BIT(9) UNAL,
      316     3357    1          2 O_DEV BIT(9) UNAL,
      317     3358    1          2 O_ADMN BIT(9) UNAL,
      318     3359    1          2 O_DLTA BIT(9) UNAL,
      319     3360    1          2 O_LIB BIT(9) UNAL,
      320     3361    1          2 O_COMM BIT(9) UNAL,
      321     3362    1          2 NAME CHAR(4) UNAL,
      322     3363    1          2 LGN CHAR(8) UNAL INIT(' '),
      323     3364    1          2 TERM CHAR(8) UNAL,
      324     3365    1          2 WSN CHAR(8) UNAL,
      325     3366    1          2 PROF CHAR(11) UNAL,
      326     3367    1          2 LPWSN CHAR(8) UNAL,
      327     3368    1          2 SIZE UBIN BYTE UNAL,
      328     3369    1          2 I_TP BIT(9) UNAL,
      329     3370    1          2 O_TP BIT(9) UNAL;
      330     3371    1   DCL 1 STATS_WRITEC STATIC UNAL,
      331     3372    1          2 * UBIN BYTE UNAL INIT(1),
      332     3373    1          2 * UBIN BYTE UNAL INIT(1),
      333     3374    1          2 * UBIN BYTE UNAL INIT(1),
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:10   
      334     3375    1          2 * UBIN BYTE UNAL INIT(1),
      335     3376    1          2 * UBIN BYTE UNAL INIT(1),
      336     3377    1          2 * UBIN BYTE UNAL INIT(1),
      337     3378    1          2 * UBIN BYTE UNAL INIT(1),
      338     3379    1          2 * UBIN BYTE UNAL INIT(1),
      339     3380    1          2 * UBIN BYTE UNAL INIT(1),
      340     3381    1          2 * UBIN BYTE UNAL INIT(1),
      341     3382    1          2 * UBIN BYTE UNAL INIT(8),
      342     3383    1          2 * UBIN BYTE UNAL INIT(8),
      343     3384    1          2 * UBIN BYTE UNAL INIT(1),
      344     3385    1          2 * UBIN BYTE UNAL INIT(1),
      345     3386    1          2 * UBIN BYTE UNAL INIT(1),
      346     3387    1          2 * UBIN BYTE UNAL INIT(1),
      347     3388    1          2 * UBIN BYTE UNAL INIT(1),
      348     3389    1          2 * UBIN BYTE UNAL INIT(1),
      349     3390    1          2 * UBIN BYTE UNAL INIT(1),
      350     3391    1          2 * UBIN BYTE UNAL INIT(1),
      351     3392    1          2 * UBIN BYTE UNAL INIT(1),
      352     3393    1          2 * UBIN BYTE UNAL INIT(1),
      353     3394    1          2 * UBIN BYTE UNAL INIT(1),
      354     3395    1          2 * UBIN BYTE UNAL INIT(1),
      355     3396    1          2 * UBIN BYTE UNAL INIT(1),
      356     3397    1          2 * UBIN BYTE UNAL INIT(4),
      357     3398    1          2 * UBIN BYTE UNAL INIT(8),
      358     3399    1          2 * UBIN BYTE UNAL INIT(8),
      359     3400    1          2 * UBIN BYTE UNAL INIT(8),
      360     3401    1          2 * UBIN BYTE UNAL INIT(11),
      361     3402    1          2 * UBIN BYTE UNAL INIT(8),
      362     3403    1          2 * UBIN BYTE UNAL INIT(1),
      363     3404    1          2 * UBIN BYTE UNAL INIT(1),
      364     3405    1          2 * UBIN BYTE UNAL INIT(1);
      365     3406
      366     3407    1   DCL 1 HDR_WRITEC STATIC CALIGNED,
      367     3408    1          2 * UBIN BYTE CALIGNED INIT(1),
      368     3409    1          2 CNT UBIN BYTE CALIGNED;
      369     3410
      370     3411    1   DCL 1 HDR_WRITEB STATIC CALIGNED,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:11   
      371     3412    1          2 FLAG UBIN BYTE CALIGNED,
      372     3413    1          2 HEAD CHAR(60) CALIGNED;
      373     3414
      374     3415    1   DCL 1 MSTR_WRITEC STATIC UNAL,
      375     3416    1          2 * UBIN BYTE UNAL INIT(8);
      376     3417
      377     3418    1   DCL 1 MSTR_WRITEB STATIC UNAL,
      378     3419    1          2 TERM_NAME CHAR(8) UNAL;
      379     3420
      380     3421    1   DCL MSG# UBIN HALF STATIC UNAL;
      381     3422    1   DCL NP# UBIN BYTE STATIC UNAL;
      382     3423    1   DCL PFB SBIN WORD STATIC ALIGNED;
      383     3424
      384     3425    1   DCL TIX2 STATIC SBIN WORD ALIGNED;
      385     3426    1   DCL TIX1 STATIC SBIN WORD ALIGNED;
      386     3427    1   DCL TEMP2 STATIC UBIN WORD ALIGNED;
      387     3428    1   DCL 1 OCN_ATTRS STATIC ALIGNED,
      388     3429    1          2 INPUT_ BIT(18) UNAL,
      389     3430    1          2 OUTPUT_ BIT(18) UNAL;
      390     3431    1   DCL OCN_ATTR REDEF OCN_ATTRS BIT(36) ALIGNED;
      391     3432
      392     3433    1   DCL PROF_BUFFER (0:1500) UBIN BYTE CALIGNED;
      393     3434         /* The following SUBs are for the
      394     3435              buffer editing function for the
      395     3436              main system consoles                                                    */
      396     3437        %SUB CHAR_BS# =" 8 /* CHAR_BS# */";
      397     3438        %SUB CHAR_DEL# ="127 /* CHAR_DEL# */";
      398     3439        %SUB CHAR_LC_A# ="97 /* CHAR_LC_A# */";
      399     3440        %SUB CHAR_LC_Z# ="122 /* CHAR_LC_Z# */";
      400     3441        %SUB CHAR_UC_A# ="65 /* CHAR_UC_A */";
      401     3442
      402     3443         /*
      403     3444              %SUB for internal
      404     3445              "reasonable" length                                                     */
      405     3446        %SUB MSG_TOOBIG# = "60 /* MSG_TOOBIG# */";
      406     3447        %OC$MESSHD (DELIM=";");
      407     3461    1   DCL 1 CSCG_EVID ALIGNED STATIC,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:12   
      408     3462    1          2 CADDR BIT(18) UNAL,
      409     3463    1          2 * UBIN(18) UNAL INIT(4 /* OC_WRDN_O */);
      410     3464
      411     3465        %EL$OPER (NAME=EL_OPERBUF,
      412     3466         STCLASS=STATIC);
      413     3469    1   DCL OOPS_MSG CONSTANT CHAR(0) UNAL
      414     3470    1   INIT(' KEYIN nodes not available  -  use ESCAPE-type keyins only');
      415     3471
      416     3472        %JG_GHOSTS (FPTN=JG_GHOSTS,
      417     3473         ARRAY=YES,
      418     3474         STCLASS=STATIC);
      419     3512
      420     3513        %INCLUDE XU_PERR_C;
      421     3704
      422     3705        %VLP_STATION (FPTN=STA,
      423     3706         WAS=NO);
      424     3733
      425     3734        %FPT_WRITE (FPTN=WR_STA,
      426     3735         DCB=M$CSCG,
      427     3736         STATION=STA,
      428     3737         BUF=OC_PARAM,
      429     3738         BP=YES,
      430     3739         EVENT=OC_WRDN_O);
      431     3770
      432     3771        %FPT_WRITE (FPTN=REPLY,
      433     3772         DCB=M$CSCG,
      434     3773         STATION=STA,
      435     3774         BP=YES,
      436     3775         EVENT=OC_WRDN_O);
      437     3806
      438     3807        %FPT_WRITE (FPTN=OOPS_WRITE,
      439     3808         DCB=M$OCCG,
      440     3809         STATION=STA,
      441     3810         BUF=OOPS_MSG);
      442     3841
      443     3842        %FPT_ACTIVATE (FPTN=DEACT,
      444     3843         DCB=M$OCCG,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:13   
      445     3844         STATION=STA,
      446     3845         FLUSH=YES,
      447     3846         DISCONNECT=YES);
      448     3869
      449     3870        %FPT_DISPLAY (FPTN=GET_INFO,
      450     3871         RESULTS=INFO_ARRAY);
      451     3884
      452     3885        %VLR_DISPLAY(FPTN=INFO_ARRAY);
      453     3899
      454     3900        %FPT_MONINFO (FPTN=GET_HEADY_STUFF,
      455     3901         HEADER=MYHEADER);
      456     3916
      457     3917        %VLR_HEADER (FPTN=MYHEADER);
      458     3931
      459     3932
      460     3933        %PC$HDR(STCLASS="BASED(B$DS7$)");
      461     3937        %PC$INSTANCE(STCLASS="BASED(INSTANCE$)");
      462     3987        %FPT_OPEN (FPTN=OPEN_TP_CNTRL,
      463     3988         DCB=M$TP,
      464     3989         FUN=UPDATE,
      465     3990         ORG=RANDOM,
      466     3991         ACS=DS7,
      467     3992         ASN=FILE,
      468     3993         EXIST=OLDFILE,
      469     3994         SHARE=ALL,
      470     3995         CTG=YES,
      471     3996         ACCT=SYSACCT,
      472     3997         NAME=TP_CNTRL_D);
      473     4106        %VLP_NAME (FPTN=TP_CNTRL_D,
      474     4107         NAME='TP_CNTRL_D');
      475     4134        %FPT_CLOSE (FPTN=CLOSE_TP_FILE,
      476     4135         DCB=M$TP,
      477     4136         DISP=SAVE);
      478     4178        %VLP_ACCT (FPTN = SYSACCT,
      479     4179         ACCT = ':SYS');
      480     4192
      481     4193    1   DCL M$TP DCB;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:14   
      482     4194    1   DCL INSTANCE$ PTR;
      483     4195
      484     4196    1   DCL B$DS7$ PTR SYMREF;
      485     4197
      486     4198
      487     4199
      488     4200        %INCLUDE SS_SCHED_C;
      489     4433        %INCLUDE CP_6_SUBS;
      490     4973
      491     4974         /* These FPTs are for the console
      492     4975              ghost event handling                                                    */
      493     4976
      494     4977        %FPT_RUE (FPTN=KILL_GHOST,
      495     4978         EVENT=%SS_ABRT);
      496     4992
      497     4993        %FPT_RUE (FPTN=BREAK_GHOST,
      498     4994         EVENT=%SS_CBK);
      499     5008
      500     5009        %FPT_RUE (FPTN=CONTROLY_GHOST,
      501     5010         EVENT=%SS_CEC);
      502     5024
      503     5025        %FPT_ACTIVATE (FPTN=END_O_FILE,
      504     5026         STCLASS=CONSTANT,
      505     5027         STATION=STA,
      506     5028         DCB=M$CSCG,
      507     5029         ABTREAD=%TYC_EOF);
      508     5052
      509     5053        %FPT_TIME (FPTN=GET_SECS,
      510     5054         SOURCE=CLOCK,
      511     5055         DEST=ANS,
      512     5056         TIME=TIME_BUF);
      513     5075
      514     5076    1   DCL TIME_BUF CHAR(8) STATIC UNAL;
      515     5077
      516     5078        %FPT_WRSYSLOG (FPTN=WR_ERSEND,
      517     5079         ENTRY=EL_OPERBUF,
      518     5080         SIZE="SIZEW(EL_OPERBUF)",
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:15   
      519     5081         MMINHIB=NO,
      520     5082         FILENUM=ERRLOG,
      521     5083         TYPE=EL_OPER);
      522     5098
      523     5099        %FPT_PROFILE (FPTN=NEW_PROF,
      524     5100         PROFILE=PROF_NAME,
      525     5101         DCB=M$OCCG);
      526     5122
      527     5123        %VLP_NAME (FPTN=PROF_NAME);
      528     5150        %VLP_NAME (FPTN=HELP_NAME,
      529     5151         NAME='KEYIN');
      530     5178
      531     5179        %VLP_ACCT (FPTN=HELP_ACCT,
      532     5180         ACCT=':SYS');
      533     5193
      534     5194        %VLP_PASS (FPTN=HELP_PASS,
      535     5195         PASS=' ');
      536     5208
      537     5209        %FPT_HELP (FPTN=OCN_HELP,
      538     5210         PROCNAME=HELP_NAME,
      539     5211         PROCACCT=HELP_ACCT,
      540     5212         PROCPASS=HELP_PASS,
      541     5213         KEY1=KEY1,
      542     5214         KEY2=KEY2,
      543     5215         STCLASS=STATIC);
      544     5236
      545     5237        %FPT_GDS (FPTN=GDS_HELP_BUF,
      546     5238         RESULTS=VLP_HELP_RESULTS,
      547     5239         SEGSIZE=2000);
      548     5255
      549     5256        %VLP_VECTOR (FPTN=VLP_HELP_RESULTS);
      550     5271        %FPT_FDS (FPTN=FDS_HELP_BUF,
      551     5272         RESULTS=VLP_HELP_RESULTS,
      552     5273         SEGSIZE=2000);
      553     5288
      554     5289         /* Reserve a maximum length
      555     5290            of 31. Assign actual
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:16   
      556     5291            length when text is
      557     5292            placed in NAME.                                                           */
      558     5293        %VLP_NAME (FPTN=KEY1,
      559     5294         LEN=31,
      560     5295         NAME=' ');
      561     5322
      562     5323        %VLP_NAME (FPTN=KEY2,
      563     5324         LEN=31,
      564     5325         NAME=' ');
      565     5352
      566     5353
      567     5354        %FPT_MONINFO (FPTN=GET_LADC_FLAG,
      568     5355         STCLASS=CONSTANT,
      569     5356         MONINFO=GJOB);
      570     5371
      571     5372        %VLR_MONINFO (FPTN=GJOB,
      572     5373         STCLASS=STATIC);
      573     5391
      574     5392        %FPT_GJOB (FPTN=FPT_GJOB,
      575     5393         NAME=GJOB_NAME);
      576     5410
      577     5411        %VLP_NAME (FPTN=GJOB_NAME);
      578     5438        %VLP_ACCT (FPTN=GJOB_ACCT);
      579     5451        %VLP_PASS (FPTN=GJOB_PASS);
      580     5464        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:17   
      581     5465
      582     5466        /*
      583     5467                    Begin  O C N $ K E Y I N  main
      584     5468                                                       */
      585     5469
      586     5470         /* ignore esc f, read complete,
      587     5471              etc                                                                     */
      588     5472    1      IF OC_QUEUE.ERR.CODE(OC_QHEAD) ~= 0
      589     5473    1      THEN
      590     5474    1      RETURN;
      591     5475    1      OC_KEYINBUF$ = ADDR(KEY_BUF);
      592     5476    1      OCS_KSIZE = KEYSIZE;
      593     5477    1      STA.STATION#=KEY_STA;
      594     5478         /* Attempt to find this console..
      595     5479              if we can't find him...just
      596     5480              return                                                                  */
      597     5481    1      INDEX_ = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
      598     5482    1      CALL OCP$FINDCX (INDEX_, STA.STATION#);
      599     5483    1      IF INDEX_ = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */
      600     5484    1      THEN
      601     5485    1      RETURN;
      602     5486    1      IF (OC_CONSOLE.ATTR(INDEX_) & '002000'O /* K_SLAVE */) ~= '0'B
      603     5487    1      THEN
      604     5488    2      DO;
      605     5489    2         NP# = 2;
      606     5490    2         MSG# = 389 /* FROMMSTR_MSG# */;
      607     5491    2         MASTER_WRITE.TERM = OC_CONSOLE.TERM_NAME(INDEX_);
      608     5492    2         MASTER_WRITE.MESS = KEY_BUF;
      609     5493    2         IF OCS_KSIZE > SIZEC(MASTER_WRITE.MESS)
      610     5494    2         THEN
      611     5495    2         MASTER_WRITEC.SIZE = SIZEC(MASTER_WRITE.MESS);
      612     5496    2         ELSE
      613     5497    2         MASTER_WRITEC.SIZE = OCS_KSIZE;
      614     5498    2         CALL OCO$IWRITE ('004000'O /* M_COMM */, MSG#, NP#, MASTER_WRITEC,
      615     5499    2           MASTER_WRITE, 0, OCP_NON_STA, 0);
      616     5500    2         RETURN;
      617     5501    2      END; /* DO IF MASTER TERMINAL SUBMISSION                                   */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:18   
      618     5502
      619     5503    1      OC_CONSOLE.TRANSAC_LAST_MIN(INDEX_) = '1'B /*TRUE#*/;
      620     5504
      621     5505    1      IF ~OC_KEY_GOOD
      622     5506    1      THEN
      623     5507    2      DO;
      624     5508    2         CALL M$WRITE (OOPS_WRITE) ALTRET (NO_OOPS_ALT);
      625     5509    2   NO_OOPS_ALT: ;
      626     5510    2         RETURN;
      627     5511    2      END; /* DO IF NO KEYIN FILE                                                */
      628     5512
      629     5513         /* This little chunk is for handling
      630     5514              the special case of deactivated
      631     5515              central console                                                         */
      632     5516    1      IF ~OC_CONSOLE.ACTIVE(INDEX_)
      633     5517    1      THEN
      634     5518    1      OC_CONSOLE.ACTIVE(INDEX_) = '1'B /*TRUE#*/;
      635     5519
      636     5520    1      OCS_CINDEX = INDEX_;
      637     5521         /* Set CID bit                                                               */
      638     5522    1      OC_CADDR = BINBIT (OC_CONSOLE.CID(INDEX_) + BITBIN ('400000'O), 18);
      639     5523    1      OC_FIRST = '1'B /*TRUE#*/;
      640     5524
      641     5525    1      IF OCS_KSIZE < 2
      642     5526    1      THEN
      643     5527    1      GOTO PARSE_IT;
      644     5528
      645     5529    2      DO WHILE (SUBSTR(OC_KEYINBUF$->BIG_BUF,
      646     5530    2        OCS_KSIZE-1,1) = ' ');
      647     5531    2         OCS_KSIZE = OCS_KSIZE - 1;
      648     5532
      649     5533    2         IF OCS_KSIZE < 2
      650     5534    2         THEN
      651     5535    2         GOTO PARSE_IT;
      652     5536    2      END;
      653     5537
      654     5538    1   PARSE_IT: ;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:19   
      655     5539
      656     5540         /* If shifting is not neat on this
      657     5541              terminal, perform the backspace
      658     5542              and null edit function, and
      659     5543              shift the lower case stuff                                              */
      660     5544
      661     5545    1      IF OC_CONSOLE.SHIFT(INDEX_)
      662     5546    1      THEN
      663     5547    1      CALL MY_XLATE (OC_KEYINBUF$, OCS_KSIZE);
      664     5548
      665     5549    1      IF OCS_KSIZE = 0
      666     5550    1      THEN
      667     5551    1      RETURN;
      668     5552
      669     5553    1      CALL OCS$SYNTAX;
      670     5554
      671     5555    1      IF OCS_ERRCODE ~= 0
      672     5556    1      THEN
      673     5557    2      DO;
      674     5558    2         MSG# = 386 /* PARSERR_MSG# */;
      675     5559    2         NP# = 4;
      676     5560    2         CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
      677     5561    2           OCS_ERRMSGC, OCS_ERRMSGB,
      678     5562    2           0, OCP_NON_STA, 0);
      679     5563    2         IF ADDR(OC_KEYINBUF) ~= OC_KEYINBUF$ AND OC_CONSOLE.X_DCBNUM(INDEX_) ~= 0
      680     5564    2         THEN
      681     5565    2         CALL OCR$CREAD(INDEX_); /* CANCEL READ FILE ONB ERROR                   */
      682     5566    2         RETURN;
      683     5567    2      END;
      684     5568
      685     5569    1      IF OC_KEYIN# = 0 /* Blank line or CR                                       */
      686     5570    1      THEN
      687     5571    1      RETURN;
      688     5572
      689     5573    1      IF OC_LIST
      690     5574    1      THEN
      691     5575    2      DO;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:20   
      692     5576
      693     5577         /* Blank the passwords on GHOST keyins
      694     5578            before writing them to :OCHIST                                            */
      695     5579
      696     5580    2         IF OC_KEYIN# = 4 /* KEY_KGHOST# */
      697     5581    2         THEN
      698     5582    3         DO;
      699     5583    3            CALL INDEX (PASS_INDEX,
      700     5584    3              ',',
      701     5585    3              KEY_BUF,
      702     5586    3              0);
      703     5587    3            CALL INDEX (PASS_INDEX,
      704     5588    3              ',',
      705     5589    3              KEY_BUF,
      706     5590    3              PASS_INDEX + 1);
      707     5591    3            IF PASS_INDEX < OCS_KSIZE
      708     5592    3            THEN
      709     5593    4            DO;
      710     5594    4               CALL INSERT (KEY_BUF,
      711     5595    4                 PASS_INDEX + 1,
      712     5596    4                 8,
      713     5597    4                 '        ');
      714     5598    4            END;
      715     5599    3         END;
      716     5600    2         MSG# = 1024 /* LGST_MSG# */;
      717     5601    2         CALL OCL$LISTIT (0, 1 /* OCI_INPUT# */, MSG#, OCP_NON_STA,
      718     5602    2           INDEX_, OCS_KSIZE, KEY_BUF, ,);
      719     5603    2      END; /* DO LOGGING                                                         */
      720     5604
      721     5605         /* Illegal on this console?                                                  */
      722     5606    1      OCN_ATTRS.INPUT_ = OC_CONSOLE.ATTR_INPUT(INDEX_);
      723     5607    1      OCN_ATTRS.OUTPUT_ = OC_CONSOLE.ATTR_OUTPUT(INDEX_);
      724     5608
      725     5609         /* If this keyin is from GOOSE, assign
      726     5610            GOOSE output attributes before the
      727     5611            legality check.  The GOOSE console
      728     5612            normally has SYSTEM output attributes
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:21   
      729     5613            because all GOOSE messages go to
      730     5614            SYSTEM consoles.                                                          */
      731     5615
      732     5616    1      IF INDEX_ = 0
      733     5617    1      THEN
      734     5618    1      OCN_ATTRS.OUTPUT_ = '000400'O /* M_GOOSE */;
      735     5619    1      ELSE
      736     5620    1      OCN_ATTRS.OUTPUT_ = OC_CONSOLE.ATTR_OUTPUT(INDEX_);
      737     5621
      738     5622    1      IF (OCS_ATTR & OCN_ATTR) = '0'B
      739     5623    1      THEN
      740     5624    2      DO;
      741     5625    2         CALL WRITE_ERR(16);
      742     5626    2         IF ADDR(OC_KEYINBUF) ~= OC_KEYINBUF$ AND OC_CONSOLE.X_DCBNUM(INDEX_) ~= 0
      743     5627    2         THEN
      744     5628    2         CALL OCR$CREAD(INDEX_); /* CANCEL READ FILE ONB ERROR                   */
      745     5629    2         RETURN;
      746     5630    2      END;
      747     5631        /* CHECK IF THE FIRST COMMAND IN A READ FILE IS  A READ$ */
      748     5632    1      IF OC_CONSOLE.FIRST_READ(INDEX_)
      749     5633    1        AND ADDR(OC_KEYINBUF) ~= OC_KEYINBUF$
      750     5634    1        AND OC_CONSOLE.X_DCBNUM(INDEX_) ~= 0
      751     5635    2      THEN DO;
      752     5636    2         IF OC_KEYIN# ~= 40 /* KEY_READ$# */
      753     5637    2           AND OC_KEYIN# ~= 41 /* KEY_READ$# */
      754     5638    2         THEN
      755     5639    3         DO;
      756     5640    3            CALL WRITE_ERR(29);
      757     5641    3            CALL OCR$CREAD(INDEX_);
      758     5642    3            RETURN;
      759     5643    3         END;
      760     5644    2         OC_CONSOLE.FIRST_READ(INDEX_) = '0'B /*FALSE#*/;
      761     5645    2      END;
      762     5646        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:22   
      763     5647
      764     5648         /* Build the final structure from
      765     5649              the passed struct and the
      766     5650              vectors, keyin# and CADDR                                               */
      767     5651    1      PTR$ = ADDR (OC_PARAM);
      768     5652    1      PTR$ -> OC$MESSAGE.MK_VECT = OCS_VECTOR;
      769     5653    1      PTR$ -> OC$MESSAGE.KEYIN# = OC_KEYIN#;
      770     5654    1      PTR$ -> OC$MESSAGE.CADDR = OC_CADDR;
      771     5655    1      PTR$ -> OC$MESSAGE.TEXT = OCS_STRUCTC;
      772     5656    1      WR_STA.BUF_.BOUND = OCS_SSIZE + 4 /* SIZE_KNHDR# */ - 1;
      773     5657
      774     5658         /* Perform the KEYIN for each
      775     5659              station that was gotten from
      776     5660              the keyin definition                                                    */
      777     5661    2      DO J = 0 TO (OCS_NAMES - 1);
      778     5662
      779     5663    2         STA.STATION# = OCS_STA(J);
      780     5664    2         IF (STA.STATION# = 'KEYIN') /* internal keyin                           */
      781     5665    2         THEN
      782     5666    3         DO;
      783     5667    4            DO CASE (OC_PARAM1.KEYIN#);
      784     5668
      785     5669        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:23   
      786     5670    4            CASE (1 /* KEY_READREPLY# */);
      787     5671    4               NEXT$ = OCP_USED_HEAD$;
      788     5672    4               FOUND = '0'B /*FALSE#*/;
      789     5673    5               DO WHILE (~FOUND AND NEXT$ ~= ADDR (NIL));
      790     5674    5                  IF NEXT$ -> OC$PEND.SYSID = OC_PARAM1.READID
      791     5675    5                  THEN
      792     5676    5                  FOUND = '1'B /*TRUE#*/;
      793     5677    5                  ELSE
      794     5678    5                  NEXT$ = NEXT$ -> OC$PEND.LINK$;
      795     5679    5               END;
      796     5680    4               IF FOUND
      797     5681    4               THEN
      798     5682    5               DO;
      799     5683    5                  FOUND = '0'B /*FALSE#*/;
      800     5684    5                  CADDR = NEXT$ -> OC$PEND.CADDR;
      801     5685         /* Addressed by attributes?                                                  */
      802     5686    5                  IF (CADDR & '400000'O) = '0'B
      803     5687    5                  THEN
      804     5688    6                  DO;
      805     5689    6                     IF OC_CONSOLE.ATTR(INDEX_) & '200000'O /* M_SYS  */
      806     5690    6                     THEN
      807     5691    6                     FOUND = '1'B /*TRUE#*/;
      808     5692    6                     ELSE
      809     5693    7                     DO;
      810     5694    7                        OCN_ATTRS.OUTPUT_ = OC_CONSOLE.ATTR(INDEX_) & ~'040000'O
              5694                                 /* M_ADMIN */;
      811     5695    7                        IF OCN_ATTRS.OUTPUT_
      812     5696    7                        THEN
      813     5697    7                        FOUND = '1'B /*TRUE#*/;
      814     5698    7                        ELSE
      815     5699    7                        IF OC_CONSOLE.ATTR(INDEX_) & '040000'O /* M_ADMIN */
      816     5700    7                        THEN
      817     5701    8                        DO;
      818     5702    8                           CALL INDEX(I, '?', OC_CONSOLE.WSN(I));
      819     5703    8                           IF SUBSTR(OC_CONSOLE.WSN(INDEX_),0,I) =
      820     5704    8                             SUBSTR(NEXT$ -> OC$PEND.WSN, 0, I)
      821     5705    8                           THEN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:24   
      822     5706    8                           FOUND = '1'B /*TRUE#*/;
      823     5707    8                        END; /* DO IF ADMIN                                      */
      824     5708    7                     END; /* DO IF NOT SYSTEM                                    */
      825     5709
      826     5710    6                  END; /* DO IF attr addressed                                   */
      827     5711    5                  ELSE
      828     5712    5                  IF CADDR = OC_CADDR
      829     5713    5                  THEN
      830     5714    5                  FOUND = '1'B /*TRUE#*/;
      831     5715    5                  IF FOUND
      832     5716    5                  THEN
      833     5717    6                  DO;
      834     5718    6                     IF OC_PARAM1.COUNT = 0
      835     5719    6                     THEN
      836     5720    7                     DO;
      837     5721    7                        REPLY.BUF_.BOUND = 0;
      838     5722    7                        REPLY.BUF_.BUF$ = ADDR(NIL);
      839     5723    7                     END;
      840     5724    6                     ELSE
      841     5725    7                     DO;
      842     5726    7                        REPLY.BUF_.BOUND = OC_PARAM1.COUNT - 1;
      843     5727    7                        REPLY.BUF_.BUF$ = ADDR (OC_PARAM1.REPLY);
      844     5728    7                     END;
      845     5729
      846     5730    6                     STA.STATION# = NEXT$ -> OC$PEND.STATION;
      847     5731    7                     CALL M$WRITE (REPLY) WHENALTRETURN DO; END;
      848     5732    6                     CALL OCP$PENDRMV (NEXT$);
      849     5733    6                  END;
      850     5734    5                  ELSE /* not this console's read                                */
      851     5735    5                  CALL WRITE_ERR(15);
      852     5736    5               END;
      853     5737    4               ELSE /* entry doesn't exist                                       */
      854     5738    4               CALL WRITE_ERR(14);
      855     5739
      856     5740        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:25   
      857     5741         /* OFF or BYE keyin... disconnect
      858     5742              the console                                                             */
      859     5743    4            CASE (2 /* KEY_OFFBYE# */);
      860     5744    4               STA.STATION#=KEY_STA;
      861     5745
      862     5746    4   KILL_STATION: ;
      863     5747         /* Deactivate the requesting console
      864     5748              ALTRET implies LOCAL device or
      865     5749              therefore the main console.
      866     5750              Just clear active in that case
      867     5751                                        */
      868     5752    4               IF SUBSTR (OC_CONSOLE.STATION(INDEX_), 0, 2) = 'SC'
      869     5753    4               THEN
      870     5754    5               DO;
      871     5755
      872     5756
      873     5757         /* If he's got a console ghost, kill
      874     5758              it via operator X'd event                                               */
      875     5759    5                  IF OC_CONSOLE.GHST(INDEX_)
      876     5760    5                  THEN
      877     5761    6                  DO;
      878     5762    6                     KILL_GHOST.V.USER# = OC_CONSOLE.SYSID(INDEX_);
      879     5763    6                     OC_CONSOLE.SYSID(INDEX_) = 0;
      880     5764    6                     OC_CONSOLE.GHST(INDEX_) = '0'B /*FALSE#*/;
      881     5765    6                     OC_CONSOLE.GHSTRD(INDEX_) = '0'B /*FALSE#*/;
      882     5766    7                     CALL M$RUE (KILL_GHOST) WHENALTRETURN DO; END;
      883     5767    6                  END;
      884     5768
      885     5769    5                  OC_CONSOLE.ACTIVE(INDEX_) = '0'B /*FALSE#*/;
      886     5770    5               END;
      887     5771    5               CALL M$DEACTIVATE (DEACT) WHENALTRETURN DO; END;
      888     5772
      889     5773
      890     5774        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:26   
      891     5775    4            CASE (3 /* KEY_GHSTREAD# */);
      892     5776         /* IF READ NOT PENDING "ERROR"                                               */
      893     5777    4               IF OC_CONSOLE.SYSID(INDEX_) = 0
      894     5778    4                 OR NOT OC_CONSOLE.GHSTRD(INDEX_)
      895     5779    4               THEN
      896     5780    5               DO;
      897     5781    5                  CALL WRITE_ERR(14);
      898     5782    5                  RETURN;
      899     5783    5               END; /* DO IF NO READ PENDING                                     */
      900     5784
      901     5785    4               GHST_TEMPLAT.CADDR = BITBIN(OC_CADDR);
      902     5786    4               GHST_TEMPLAT.SYSID = OC_CONSOLE.SYSID(INDEX_);
      903     5787    4               STA.STATION# = GHST_TEMPLATC;
      904     5788    4               OC_CONSOLE.GHSTRD(INDEX_) = '0'B /*FALSE#*/;
      905     5789
      906     5790    4               IF OC_PARAM1.COUNT = 0
      907     5791    4               THEN
      908     5792    5               DO;
      909     5793    5                  REPLY.BUF_.BOUND = 0;
      910     5794    5                  REPLY.BUF_.BUF$ = ADDR(NIL);
      911     5795    5               END;
      912     5796    4               ELSE
      913     5797    5               DO;
      914     5798    5                  REPLY.BUF_.BOUND = OC_PARAM1.COUNT - 1;
      915     5799    5                  REPLY.BUF_.BUF$ = ADDR (OC_PARAM1.REPLY);
      916     5800    5               END;
      917     5801
      918     5802    5               CALL M$WRITE (REPLY) WHENALTRETURN DO; END;
      919     5803        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:27   
      920     5804         /* HANDLE GHOST initiating keyin                                             */
      921     5805    4            CASE (4 /* KEY_KGHOST# */);
      922     5806    4               IF NOT OC_CONSOLE.GHST(INDEX_)
      923     5807    4               THEN
      924     5808    5               DO;
      925     5809    5                  OC_CONSOLE.GHST(INDEX_) = '1'B /*TRUE#*/;
      926     5810    5                  OC_PARAM1.KEYIN# = 2 /* KEY_GHOST# */;
      927     5811    5                  STA.STATION# = 'SLUG';
      928     5812    5                  GOTO WRITE_IT_OUT;
      929     5813    5               END;
      930     5814    4               ELSE
      931     5815    4               CALL WRITE_ERR(13);
      932     5816        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:28   
      933     5817    4            CASE (23 /* KEY_ZAPKEYIN# */);
      934     5818         /* ZAP! --- TAKE ME DOWN                                                     */
      935     5819
      936     5820    4               IF OC_ZIP
      937     5821    4               THEN
      938     5822    4               RETURN;
      939     5823
      940     5824         /* Send a message to SLUG.
      941     5825            If we get a response that says
      942     5826            its ok to ZAP (meaning that DINGO
      943     5827            has finished) send a message to
      944     5828            MONKEY to disallow new users.
      945     5829            MONKEY will send a message to SLUG
      946     5830            to stop the FEPs, then SLUG will
      947     5831            report back to KEYIN.                                                     */
      948     5832
      949     5833    4               OCD_ZAP_SAVE.CONS_STA = OC_CONSOLE.STATION (INDEX_);
      950     5834    4               OCD_ZAP_SAVE.MESSAGE = OC_PARAM$ -> OC$MESSAGE;
      951     5835    4               OCD_ZAP_SAVE.CSCG_EVID.CADDR = OC_CADDR;
      952     5836
      953     5837    4               OC_PARAM$ -> OC$MESSAGE.KEYIN# = 16 /* KEY_OKTOZAP# */;
      954     5838
      955     5839    4               STA.STATION# = 'SLUG    ';
      956     5840
      957     5841    4               GOTO WRITE_IT_OUT;
      958     5842        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:29   
      959     5843    4            CASE (5 /* KEY_BRK# */);
              5843                     /* Simulate BREAK event for c.ghost                 */
      960     5844
      961     5845    4               IF OC_CONSOLE.SYSID(INDEX_) ~= 0
      962     5846    4               THEN
      963     5847    5               DO;
      964     5848    5                  BREAK_GHOST.V.USER# = OC_CONSOLE.SYSID(INDEX_);
      965     5849    5                  CALL M$RUE (BREAK_GHOST) ALTRET (NO_BREAK);
      966     5850    5               END;
      967     5851    4               ELSE
      968     5852    4               CALL WRITE_ERR(12);
      969     5853
      970     5854    5               DO WHILE ('0'B /*FALSE#*/);
      971     5855    5   NO_BREAK:      ;
      972     5856    5                  CALL WRITE_ERR(11);
      973     5857    5               END; /* DO WHILE (ALTRET)                                         */
      974     5858
      975     5859        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:30   
      976     5860         /* Simulate CONTROL-Y event                                                  */
      977     5861    4            CASE (6 /* KEY_CY# */);
      978     5862
      979     5863    4               IF OC_CONSOLE.SYSID(INDEX_) ~= 0
      980     5864    4               THEN
      981     5865    5               DO;
      982     5866    5                  CONTROLY_GHOST.V.USER# = OC_CONSOLE.SYSID(INDEX_);
      983     5867    5                  CALL M$RUE (CONTROLY_GHOST) ALTRET (NO_CY);
      984     5868    5               END;
      985     5869    4               ELSE
      986     5870    4               CALL WRITE_ERR(12);
      987     5871
      988     5872    5               DO WHILE ('0'B /*FALSE#*/);
      989     5873    5   NO_CY:         ;
      990     5874    5                  CALL WRITE_ERR(10);
      991     5875    5               END; /* DO WHILE (ALTRET)                                         */
      992     5876        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:31   
      993     5877    4            CASE (7 /* KEY_ESCF# */);
      994     5878    4               IF OC_CONSOLE.SYSID(INDEX_) ~= 0
      995     5879    4               THEN
      996     5880    5               DO;
      997     5881    5                  GHST_TEMPLAT.CADDR = BITBIN(OC_CADDR);
      998     5882    5                  GHST_TEMPLAT.SYSID = OC_CONSOLE.SYSID(INDEX_);
      999     5883    5                  STA.STATION# = GHST_TEMPLATC;
     1000     5884    5                  CALL M$ACTIVATE (END_O_FILE) ALTRET (NO_EOF);
     1001     5885    5               END; /* DO IF SYSID ASSOCIATED                                    */
     1002     5886    4               ELSE
     1003     5887    4               CALL WRITE_ERR(12);
     1004     5888
     1005     5889    5               DO WHILE ('0'B /*FALSE#*/);
     1006     5890    5   NO_EOF:        ;
     1007     5891    5                  CALL WRITE_ERR(9);
     1008     5892    5               END; /* DO WHILE (ALTRET)                                         */
     1009     5893        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:32   
     1010     5894         /* Request UPSHIFT function                                                  */
     1011     5895    4            CASE (8 /* KEY_UCON# */);
     1012     5896    4               IF OC_CONSOLE.SHIFT(INDEX_)
     1013     5897    4               THEN
     1014     5898    4               CALL WRITE_ERR(8);
     1015     5899    4               ELSE
     1016     5900    5               DO;
     1017     5901    5                  OC_CONSOLE.SHIFT(INDEX_) = '1'B /*TRUE#*/;
     1018     5902    5                  CALL WRITE_ERR(7);
     1019     5903    5               END;
     1020     5904        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:33   
     1021     5905         /* Request UPSHIFT deactivation                                              */
     1022     5906
     1023     5907    4            CASE (9 /* KEY_UCOFF */);
     1024     5908
     1025     5909    4               IF OC_CONSOLE.SHIFT(INDEX_)
     1026     5910    4               THEN
     1027     5911    5               DO;
     1028     5912    5                  OC_CONSOLE.SHIFT(INDEX_) = '0'B /*FALSE#*/;
     1029     5913    5                  CALL WRITE_ERR(5);
     1030     5914    5               END;
     1031     5915    4               ELSE
     1032     5916    4               CALL WRITE_ERR(6);
     1033     5917        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:34   
     1034     5918         /* Request PENDING READS list                                                */
     1035     5919
     1036     5920    4            CASE (10 /* KEY_PEND# */);
     1037     5921
     1038     5922    4               NOT_FOUND = '1'B /*TRUE#*/;
     1039     5923    4               IF OC_CONSOLE.GHSTRD(INDEX_)
     1040     5924    4               THEN
     1041     5925    5               DO;
     1042     5926    6                  DO I = 0 TO 2;
     1043     5927    6                     IF ADDR(OC_CONSOLE.PROMPTS(INDEX_))->
     1044     5928    6                       PROMPT_TABLE.LAST_READ(I)
     1045     5929    6                     THEN
     1046     5930    7                     DO;
     1047     5931    7                        GHST_READC.COUNT_ =
     1048     5932    7                          ADDR(OC_CONSOLE.PROMPTS(INDEX_))->
     1049     5933    7                          PROMPT_TABLE.SIZER(I);
     1050     5934    7                        NP# = 1;
     1051     5935    7                        MSG# = 503 /* OGRD_MSG# */;
     1052     5936    7                        CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     1053     5937    7                          GHST_READB, GHST_READC, 0, OCP_NON_STA,
     1054     5938    7                          I+1);
     1055     5939    7                        NOT_FOUND = '0'B /*FALSE#*/;
     1056     5940    7                     END; /* IF FOUND                                            */
     1057     5941    6                  END; /* DO I                                                   */
     1058     5942    5               END; /* IF GHSTRD                                                 */
     1059     5943
     1060     5944    4               NEXT$ = OCP_USED_HEAD$;
     1061     5945    4               MSG# = 501 /* RD_MSG# */;
     1062     5946    4               NP# = 3;
     1063     5947
     1064     5948    5               DO WHILE (NEXT$ ~= ADDR(NIL));
     1065     5949
     1066     5950         /* If direct addressed, check
     1067     5951              against direct addr of request
     1068     5952              console, if attr addressed
     1069     5953              make exhaustive check                                                   */
     1070     5954
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:35   
     1071     5955    5                  IF NEXT$ -> OC$PEND.CADDR = OC_CADDR
     1072     5956    5                  THEN
     1073     5957    5                  GOTO PRO_CEED;
     1074     5958
     1075     5959    5                  ELSE
     1076     5960    6                  DO;
     1077     5961
     1078     5962    6                     CALL INDEX (I, '?', OC_CONSOLE.WSN(INDEX_));
     1079     5963
     1080     5964    6                     IF OC_CONSOLE.ATTR(INDEX_) & '200000'O /* M_SYS  */
     1081     5965    6                     THEN
     1082     5966    6                     GOTO PRO_CEED;
     1083     5967
     1084     5968    6                     CADDR = (NEXT$ -> OC$PEND.CADDR) &
     1085     5969    6                       OC_CONSOLE.ATTR(INDEX_);
     1086     5970
     1087     5971    6                     IF CADDR & '004000'O /* M_COMM */
     1088     5972    6                     THEN
     1089     5973    6                     GOTO PRO_CEED;
     1090     5974
     1091     5975    6                     IF CADDR & '040000'O /* M_ADMIN */
     1092     5976    6                       AND
     1093     5977    6                       OC_CONSOLE.ATTR_INPUT(INDEX_) & '040000'O /* K_ADMIN */
     1094     5978    6                       AND
     1095     5979    6                       SUBSTR(OC_CONSOLE.WSN(INDEX_), 0, I) =
     1096     5980    6                       SUBSTR(NEXT$ -> OC$PEND.WSN, 0, I)
     1097     5981    6                     THEN
     1098     5982    6                     GOTO PRO_CEED;
     1099     5983
     1100     5984    6                     IF CADDR & '100000'O /* M_DEVC  */
     1101     5985    6                       AND
     1102     5986    6                       NEXT$ -> OC$PEND.DEV.TWSN =
     1103     5987    6                       OC_CONSOLE.STATIONR.SECND_HALF(INDEX_)
     1104     5988    6                     THEN
     1105     5989    6                     GOTO PRO_CEED;
     1106     5990
     1107     5991    6                  END; /* DO IF ATTR ADDRESSED                                   */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:36   
     1108     5992
     1109     5993    6                  DO WHILE ('0'B /*FALSE#*/);
              5993                           /* Loop to handle found reads               */
     1110     5994
     1111     5995    6   PRO_CEED:         ;
     1112     5996
     1113     5997    6                     IF NEXT$ -> OC$PEND.SIZEB_MSG ~= 0
     1114     5998    6                     THEN
     1115     5999    7                     DO;
     1116     6000    7                        MSG# = 385 /* PENDMSG_MSG# */;
     1117     6001    7                        WORD_ = NEXT$ -> OC$PEND.SIZEB_MSG;
     1118     6002    7                        CALL OCW$WRITE (
     1119     6003    7                          NEXT$ -> OC$PEND.MESSAGE,
     1120     6004    7                          WORD_,
     1121     6005    7                          OC_CADDR,
     1122     6006    7                          OCP_NON_STA,
     1123     6007    7                          ADDR (ADDR(NEXT$) -> OC$PEND.MESSAGE)
     1124     6008    7                          -> OC$MESSHD.MSG#);
     1125     6009    7                        MSG# = 501 /* RD_MSG# */;
     1126     6010    7                     END;
     1127     6011    6                     REGULAR_READC.SIZER = NEXT$ -> OC$PEND.SIZER;
     1128     6012    6                     REGULAR_READC.ACCT = NEXT$ -> OC$PEND.ACCN;
     1129     6013    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     1130     6014    6                       REGULAR_READB, REGULAR_READC,
     1131     6015    6                       NEXT$ -> OC$PEND.SYSID,
     1132     6016    6                       OCP_NON_STA, 0);
     1133     6017    6                     NOT_FOUND = '0'B /*FALSE#*/;
     1134     6018    6                  END; /* DO  WHILE found                                        */
     1135     6019
     1136     6020    5                  NEXT$ = NEXT$ -> OC$PEND.LINK$;
     1137     6021
     1138     6022    5               END; /* DO WHILE MORE                                             */
     1139     6023
     1140     6024         /* Handle the case of "none to
     1141     6025              speak of "                                                              */
     1142     6026    4               IF NOT_FOUND
     1143     6027    4               THEN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:37   
     1144     6028    5               DO;
     1145     6029    5                  MSG# = 395 /* NO_PEND_MSG# */;
     1146     6030    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, 0,0,0,0,
     1147     6031    5                    OCP_NON_STA,0);
     1148     6032    5               END; /* DO IF none found                                          */
     1149     6033
     1150     6034        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:38   
     1151     6035
     1152     6036         /* Process HELP request                                                      */
     1153     6037
     1154     6038    4            CASE (12 /* KEY_HELP# */);
     1155     6039
     1156     6040    4               OC_CONSOLE.VLR_HELP (INDEX_) = '0'B;
     1157     6041    4               OCN_HELP.V.LIST# = '0'B;
     1158     6042    4               OCN_HELP.V.ALL# = '0'B;
     1159     6043    4               OCN_HELP.V.MORE# = '0'B;
     1160     6044    4               OCN_HELP.V.RANGE# = '0'B;
     1161     6045    4               OCN_HELP.RESULTS_ = VECTOR (OC_CONSOLE.VLR_HELP (INDEX_));
     1162     6046    4               OCN_HELP.V.LANG# = B$JIT$ -> B$JIT.LANG;
     1163     6047    4               MSG# = 393 /* HELP_MSG# */;
     1164     6048    4               NP# = 3;
     1165     6049    4               HELP_MSGB.CODE = 0;
     1166     6050    4               IF OC_PARAM$->OC$HELP1.DASH = 1
     1167     6051    4                 OR OC_PARAM$->OC$HELP1.DASH = 3
     1168     6052    4                 OR OC_PARAM$->OC$HELP1.DASH = 5
     1169     6053    4                 OR OC_PARAM$->OC$HELP1.DASH = 7
     1170     6054    4                 OR OC_PARAM$->OC$HELP1.DASH = 9
     1171     6055    4               THEN
     1172     6056    5               DO;
     1173     6057    5                  HELP_FLAG = '1'B;
     1174     6058    5                  H1_PTR$ = PINCRC(ADDR(OC_PARAM$->OC$HELP1.DASH),1);
     1175     6059    5                  H2_PTR$ = PINCRC(H1_PTR$, H1_PTR$->TEXT.CNT + 1);
     1176     6060    5                  H3_PTR$ = PINCRC(H2_PTR$, H2_PTR$->TEXT.CNT + 1);
     1177     6061    5               END;
     1178     6062    4               ELSE
     1179     6063    5               DO;
     1180     6064    5                  HELP_FLAG = '0'B;
     1181     6065    5                  H2_PTR$ = PINCRC(ADDR(OC_PARAM$->OC$HELP1.DASH),1);
     1182     6066    5                  H3_PTR$ = PINCRC(H2_PTR$, H2_PTR$->TEXT.CNT + 1);
     1183     6067    5               END;
     1184     6068
     1185     6069    4               IF HELP_FLAG = '1'B
     1186     6070    4               THEN
     1187     6071    5               DO;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:39   
     1188     6072    5                  IF H1_PTR$->TEXT.C ~= 'KEYIN'
     1189     6073    5                  THEN
     1190     6074    6                  DO;
     1191     6075    6                     HELP_MSGB.CODE = 2;
     1192     6076    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1193     6077    6                       HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1194     6078    6                     RETURN;
     1195     6079    6                  END;
     1196     6080    5               END;
     1197     6081
     1198     6082    4               KEY1.L# = 0;
     1199     6083    4               IF H2_PTR$->TEXT.CNT ~= 0
     1200     6084    4               THEN
     1201     6085    5               DO;
     1202     6086    5                  KEY1.L# = H2_PTR$->TEXT.CNT;
     1203     6087    5                  KEY1.NAME# = SUBSTR (H2_PTR$->TEXT.C,
     1204     6088    5                    0,
     1205     6089    5                    KEY1.L#);
     1206     6090    5               END;
     1207     6091
     1208     6092    4               KEY2.L# = 0;
     1209     6093    4               IF H3_PTR$->TEXT.CNT ~= 0
     1210     6094    4               THEN
     1211     6095    5               DO;
     1212     6096    5                  KEY2.L# = H3_PTR$->TEXT.CNT;
     1213     6097    5                  KEY2.NAME# = SUBSTR (H3_PTR$->TEXT.C,
     1214     6098    5                    0,
     1215     6099    5                    KEY2.L#);
     1216     6100    5               END;
     1217     6101
     1218     6102    4               IF OC_PARAM$->OC$HELP1.DASH = 1
     1219     6103    4                 OR OC_PARAM$->OC$HELP1.DASH = 2
     1220     6104    4                 OR OC_PARAM$->OC$HELP1.DASH = 5
     1221     6105    4                 OR OC_PARAM$->OC$HELP1.DASH = 6
     1222     6106    4               THEN
     1223     6107    5               DO;
     1224     6108    5                  HELP_MSGB.CODE = 3;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:40   
     1225     6109    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1226     6110    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1227     6111    5                  RETURN;
     1228     6112    5               END;
     1229     6113
     1230     6114    4               IF OC_PARAM$->OC$HELP1.DASH = 1
     1231     6115    4                 OR OC_PARAM$->OC$HELP1.DASH = 2
     1232     6116    4                 OR OC_PARAM$->OC$HELP1.DASH = 3
     1233     6117    4                 OR OC_PARAM$->OC$HELP1.DASH = 4
     1234     6118    4               THEN
     1235     6119    5               DO;
     1236     6120    5                  OCN_HELP.V.LIST# = '1'B;
     1237     6121    5               END;
     1238     6122
     1239     6123    4               IF OC_PARAM$->OC$HELP1.DASH = 0
     1240     6124    4               THEN
     1241     6125    5               DO;
     1242     6126    5                  KEY1.L# = 0;
     1243     6127    5                  KEY2.L# = 0;
     1244     6128    5                  OCN_HELP.V.LIST# = '0'B;
     1245     6129    5                  OCN_HELP.V.RANGE# = '0'B;
     1246     6130    5               END;
     1247     6131
     1248     6132
     1249     6133    4               VLP_HELP_RESULTS.PTR$ = ADDR(NIL);
     1250     6134    4               CALL M$GDS (GDS_HELP_BUF)
     1251     6135    5               WHENALTRETURN DO;
     1252     6136    5                  HELP_MSGB.CODE = 4;
     1253     6137    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1254     6138    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1255     6139    5                  RETURN;
     1256     6140    5               END;
     1257     6141
     1258     6142    4               OCN_HELP.BUF_ = VLP_HELP_RESULTS;
     1259     6143
     1260     6144    4               CALL M$HELP (OCN_HELP) ALTRET (NO_HELP);
     1261     6145
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:41   
     1262     6146    4               IF OC_CONSOLE.VLR_HELP.RECCNT(INDEX_) > 0
     1263     6147    4               THEN
     1264     6148    5               DO HELP_INDEX = 0 TO (OC_CONSOLE.VLR_HELP.RECCNT (INDEX_) - 1);
     1265     6149    5                  HELP_MSGB.HMSG = VLP_HELP_RESULTS.PTR$->HELP_OUTPUT.LINE (HELP_INDEX)
              6149                           ;
     1266     6150    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1267     6151    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1268     6152    5               END;
     1269     6153    5               ELSE DO;
     1270     6154    5   NO_HELP:       ;
     1271     6155    5                  HELP_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     1272     6156    5                  HELP_MSGB.CODE = 1;
     1273     6157    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1274     6158    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1275     6159    5               END;
     1276     6160
     1277     6161    4               CALL M$FDS (FDS_HELP_BUF)
     1278     6162    5               WHENALTRETURN DO; END;
     1279     6163    4               RETURN;
     1280     6164
     1281     6165        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:42   
     1282     6166    4            CASE (43 /* KEY_HELP2# */);
     1283     6167    4               MSG# = 393 /* HELP_MSG# */;
     1284     6168    4               NP# = 3;
     1285     6169    4               HELP_MSGB.CODE = 0;
     1286     6170    4               OCN_HELP.RESULTS_ = VECTOR (OC_CONSOLE.VLR_HELP (INDEX_));
     1287     6171    4               OCN_HELP.V.MORE# = '1'B;
     1288     6172
     1289     6173
     1290     6174    4               VLP_HELP_RESULTS.PTR$ = ADDR(NIL);
     1291     6175    4               CALL M$GDS (GDS_HELP_BUF)
     1292     6176    5               WHENALTRETURN DO;
     1293     6177    5                  HELP_MSGB.CODE = 4;
     1294     6178    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1295     6179    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1296     6180    5                  RETURN;
     1297     6181    5               END;
     1298     6182
     1299     6183    4               OCN_HELP.BUF_ = VLP_HELP_RESULTS;
     1300     6184
     1301     6185    4               CALL M$HELP (OCN_HELP) ALTRET (NO_MORE_HELP);
     1302     6186    4               IF OC_CONSOLE.VLR_HELP.RECCNT(INDEX_) > 0
     1303     6187    4               THEN
     1304     6188    5               DO HELP_INDEX = 0 TO (OC_CONSOLE.VLR_HELP.RECCNT (INDEX_) - 1);
     1305     6189    5                  HELP_MSGB.HMSG = VLP_HELP_RESULTS.PTR$->HELP_OUTPUT.LINE (HELP_INDEX)
              6189                           ;
     1306     6190    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1307     6191    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1308     6192    5               END;
     1309     6193
     1310     6194    5               ELSE DO;
     1311     6195    5   NO_MORE_HELP:
     1312     6196    5                  HELP_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     1313     6197    5                  HELP_MSGB.CODE = 5;
     1314     6198    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1315     6199    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1316     6200    5               END;
     1317     6201    4   DONE_HELPING: CALL M$FDS (FDS_HELP_BUF)
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:43   
     1318     6202    5               WHENALTRETURN DO; END;
     1319     6203    4               RETURN;
     1320     6204        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:44   
     1321     6205    4            CASE (44 /* KEY_HELP3# */);
     1322     6206    4               MSG# = 393 /* HELP_MSG# */;
     1323     6207    4               NP# = 3;
     1324     6208    4               HELP_MSGB.CODE = 0;
     1325     6209    4               OCN_HELP.RESULTS_ = VECTOR (OC_CONSOLE.VLR_HELP (INDEX_));
     1326     6210    4               OCN_HELP.V.ALL# = '1'B;
     1327     6211
     1328     6212
     1329     6213    4               VLP_HELP_RESULTS.PTR$ = ADDR(NIL);
     1330     6214    4               CALL M$GDS (GDS_HELP_BUF)
     1331     6215    5               WHENALTRETURN DO;
     1332     6216    5                  HELP_MSGB.CODE = 4;
     1333     6217    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1334     6218    5                    HELP_MSGB, ' ', 0);
     1335     6219    5                  RETURN;
     1336     6220    5               END;
     1337     6221
     1338     6222    4               OCN_HELP.BUF_ = VLP_HELP_RESULTS;
     1339     6223
     1340     6224    4               CALL M$HELP (OCN_HELP) ALTRET (NO_MORE_HELP);
     1341     6225    4               IF OC_CONSOLE.VLR_HELP.RECCNT(INDEX_) = 0
     1342     6226    4               THEN
     1343     6227    4               GOTO NO_MORE_HELP;
     1344     6228    5               DO HELP_INDEX = 0 TO (OC_CONSOLE.VLR_HELP.RECCNT (INDEX_) - 1);
     1345     6229    5                  HELP_MSGB.HMSG = VLP_HELP_RESULTS.PTR$ -> HELP_OUTPUT.LINE (
              6229                           HELP_INDEX);
     1346     6230    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
     1347     6231    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1348     6232    5               END;
     1349     6233
     1350     6234    4               GOTO DONE_HELPING;
     1351     6235        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:45   
     1352     6236        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:46   
     1353     6237         /* Handle request to enter text in
     1354     6238              ERRFILE                                                                 */
     1355     6239    4            CASE (11 /* KEY_ERSEND# */);
     1356     6240
     1357     6241    4               EL_OPERBUF.STATION = OC_CONSOLE.STATION(INDEX_);
     1358     6242    4               EL_OPERBUF.ATTR = OC_CONSOLE.ATTR(INDEX_);
     1359     6243    4               EL_OPERBUF.MESSAGE = ' ';
     1360     6244    4               ADDR(EL_OPERBUF.MESSAGE) -> BIG_BUF =
     1361     6245    4                 ADDR(ADDR(OC_PARAM) -> OC$MESSAGE.TEXT) -> TEXT.C;
     1362     6246
     1363     6247    4               CALL M$WRSYSLOG (WR_ERSEND) ALTRET (ERSEND1);
     1364     6248
     1365     6249    5               DO WHILE ('0'B);
     1366     6250    5   ERSEND1:
     1367     6251    5                  MSG# = 383 /* GENKEYIN_MSG# */;
     1368     6252    5                  NP# = 2;
     1369     6253    5                  GENKEYIN_MSGB.CODE = 0;
     1370     6254    5                  GENKEYIN_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     1371     6255    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     1372     6256    5                    GENKEYIN_MSGC, GENKEYIN_MSGB, 0, ' ', 0);
     1373     6257    5               END;
     1374     6258
     1375     6259        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:47   
     1376     6260    4            CASE(17 /* KEY_TIMON# */);
              6260                     /* TURN TIME PRINTING ON                           */
     1377     6261
     1378     6262    4               IF OC_CONSOLE.DONT_TIME(INDEX_)
     1379     6263    4               THEN
     1380     6264    5               DO;
     1381     6265    5                  OC_CONSOLE.DONT_TIME(INDEX_) = '0'B /*FALSE#*/;
     1382     6266    5                  CALL WRITE_ERR(17);
     1383     6267    5               END;
     1384     6268    4               ELSE
     1385     6269    4               CALL WRITE_ERR(18);
     1386     6270
     1387     6271    4            CASE(18 /* KEY_TIMOFF# */);
     1388     6272
     1389     6273    4               IF OC_CONSOLE.DONT_TIME(INDEX_)
     1390     6274    4               THEN
     1391     6275    4               CALL WRITE_ERR(19);
     1392     6276    4               ELSE
     1393     6277    5               DO;
     1394     6278    5                  OC_CONSOLE.DONT_TIME(INDEX_) = '1'B /*TRUE#*/;
     1395     6279    5                  CALL WRITE_ERR(20);
     1396     6280    5               END;
     1397     6281
     1398     6282        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:48   
     1399     6283         /* Send input text to the selected
     1400     6284              master terminal station                                                 */
     1401     6285
     1402     6286    4            CASE(21 /* KEY_TERMSEND# */);
     1403     6287
     1404     6288    4               FOUND = '0'B /*FALSE#*/;
     1405     6289    5               DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1406     6290    5                  IF OC_CONSOLE.ACTIVE(I)
     1407     6291    5                  THEN
     1408     6292    5                  IF OC_CONSOLE.TERM_NAME(I) =
     1409     6293    5                    OC_PARAM$ -> OC$TERMSEND.TERM
     1410     6294    5                  THEN
     1411     6295    5                  IF (OC_CONSOLE.ATTR(I) &
     1412     6296    5                    '002000'O /* K_SLAVE */) ~= '0'B /*FALSE#*/
     1413     6297    5                  THEN
     1414     6298    6                  DO;
     1415     6299    6                     FOUND = '1'B /*TRUE#*/;
     1416     6300    6                     NP# = 1;
     1417     6301    6                     MSG# = 388 /* TOMASTER_MSG# */;
     1418     6302    6                     BYTES_ = OC_PARAM$ -> OC$TERMSEND.SIZE;
     1419     6303    6                     CALL OCO$IWRITE (
     1420     6304    6                       BINBIT(OC_CONSOLE.CID(I)+BITBIN('400000'O),18),
     1421     6305    6                       MSG#,NP#,BYTES_,
     1422     6306    6                       OC_PARAM$->OC$TERMSEND.MESSAGE,
     1423     6307    6                       0,OCP_NON_STA,0);
     1424     6308    6                     RETURN;
     1425     6309    6                  END; /* DO IF FOUND                                            */
     1426     6310
     1427     6311    5               END; /* DO I = 0 TO MAX_CONS                                      */
     1428     6312
     1429     6313    4               IF ~FOUND
     1430     6314    4               THEN
     1431     6315    4               CALL WRITE_ERR (21);
     1432     6316
     1433     6317        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:49   
     1434     6318
     1435     6319    4            CASE (16 /* KEY_XCONS# */);
     1436     6320
     1437     6321    4               I = 4;
     1438     6322    4               CALL MY_XLATE (ADDR(OC_PARAM$->OC$COMM.DEVICE), I);
     1439     6323
     1440     6324    4               IF OC_PARAM$ -> OC$COMM.TERM = ' '
     1441     6325    4               THEN
     1442     6326    4               OC_PARAM$ -> OC$COMM.TERM =
     1443     6327    4                 OC_CONSOLE.TERM_NAME (INDEX_);
     1444     6328
     1445     6329    4               IF OC_PARAM$ -> OC$COMM.AT_TERM = ' '
     1446     6330    4               THEN
     1447     6331    4               OC_PARAM$ -> OC$COMM.AT_TERM =
     1448     6332    4                 OC_PARAM$ -> OC$COMM.TERM;
     1449     6333
     1450     6334    4               FOUND = '0'B /*FALSE#*/;
     1451     6335    5               DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1452     6336    5                  IF OC_CONSOLE.ACTIVE(I)
     1453     6337    5                    AND
     1454     6338    5                    ((OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)
     1455     6339    5                    = '0'B /*FALSE#*/)
     1456     6340    5                    AND
     1457     6341    5                    OC_CONSOLE.STATIONR.FIRST_HALF(I) =
     1458     6342    5                    OC_PARAM$ -> OC$COMM.DEVICE
     1459     6343    5                    AND
     1460     6344    5                    (OC_CONSOLE.TERM_NAME(I) =
     1461     6345    5                    OC_PARAM$ ->
     1462     6346    5                    OC$COMM.AT_TERM)
     1463     6347    5                  THEN
     1464     6348    6                  DO;
     1465     6349    6                     FOUND = '1'B /*TRUE#*/;
     1466     6350    6                     IF OC_CONSOLE.ATTR(I) & '200000'O /* M_SYS  */
     1467     6351    6                       AND
     1468     6352    6                       (OC_CONSOLE.ATTR(INDEX_) & '000004'O /* K_IOMCON */)
     1469     6353    6                       = '0'B /*FALSE#*/
     1470     6354    6                     THEN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:50   
     1471     6355    6                     CALL WRITE_ERR(23);
     1472     6356    6                     ELSE
     1473     6357    7                     DO;
     1474     6358    7                        STA.STATION# = OC_CONSOLE.STATION (I);
     1475     6359    7                        CALL M$DEACTIVATE (DEACT)
     1476     6360    8                        WHENALTRETURN DO; END;
     1477     6361    7                     END; /* DO IF FOUND                                         */
     1478     6362    6                     I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
     1479     6363    6                  END; /* DO IF FOUND                                            */
     1480     6364    5               END; /* DO I                                                      */
     1481     6365    4               IF ~FOUND
     1482     6366    4               THEN
     1483     6367    4               CALL WRITE_ERR(26);
     1484     6368
     1485     6369        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:51   
     1486     6370    4            CASE (19 /* KEY_TELL# */);
     1487     6371
     1488     6372    4               I = 4;
     1489     6373    4               CALL MY_XLATE (ADDR(OC_PARAM$->OC$COMM.DEVICE), I);
     1490     6374    4               FOUND = '1'B /*TRUE#*/;
     1491     6375
     1492     6376    4               IF OC_PARAM$ -> OC$COMM.TERM = ' '
     1493     6377    4               THEN
     1494     6378    4               OC_PARAM$ -> OC$COMM.TERM =
     1495     6379    4                 OC_CONSOLE.TERM_NAME (INDEX_);
     1496     6380
     1497     6381    4               IF OC_PARAM$ -> OC$COMM.AT_TERM = ' '
     1498     6382    4               THEN
     1499     6383    4               OC_PARAM$ -> OC$COMM.AT_TERM =
     1500     6384    4                 OC_PARAM$ -> OC$COMM.TERM;
     1501     6385
     1502     6386    4               IF OC_PARAM$ -> OC$COMM.COUNT >
     1503     6387    4                 SIZEC (TELL_WRITEB.TEXT)
     1504     6388    4               THEN
     1505     6389    4               CALL WRITE_ERR(25);
     1506     6390    4               ELSE
     1507     6391    5               DO;
     1508     6392    5                  FOUND = '0'B /*FALSE#*/;
     1509     6393    6                  DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1510     6394    6                     IF OC_CONSOLE.ACTIVE(I)
     1511     6395    6                     THEN
     1512     6396    6                     IF OC_CONSOLE.STATIONR.FIRST_HALF(I) =
     1513     6397    6                       OC_PARAM$ -> OC$COMM.DEVICE
     1514     6398    6                     THEN
     1515     6399    6                     IF OC_CONSOLE.TERM_NAME(I) =
     1516     6400    6                       OC_PARAM$ ->
     1517     6401    6                       OC$COMM.AT_TERM
     1518     6402    6                     THEN
     1519     6403    6                     IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)
     1520     6404    6                       ='0'B
     1521     6405    6                     THEN
     1522     6406    7                     DO;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:52   
     1523     6407    7                        FOUND = %YES#;
     1524     6408    7                        TELL_WRITEC.SIZE =
     1525     6409    7                          OC_PARAM$ ->
     1526     6410    7                          OC$COMM.COUNT;
     1527     6411    7                        TELL_WRITEB.TEXT =
     1528     6412    7                          OC_PARAM$ ->
     1529     6413    7                          OC$COMM.TEXT;
     1530     6414    7                        TELL_WRITEB.TERM =
     1531     6415    7                          OC_CONSOLE.TERM_NAME(INDEX_);
     1532     6416    7                        TELL_WRITEB.CONSOLE =
     1533     6417    7                          OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1534     6418    7                        MSG# = 387 /* FROMTERM_MSG# */;
     1535     6419    7                        NP# = 3;
     1536     6420    7                        CALL OCO$IWRITE (
     1537     6421    7                          BINBIT(OC_CONSOLE.CID(I)+BITBIN('400000'O),18),
     1538     6422    7                          MSG#, NP#, TELL_WRITEC, TELL_WRITEB,
     1539     6423    7                          0, OCP_NON_STA, 0);
     1540     6424    7                        I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;
     1541     6425    7                     END; /* DO IF FOUND                                         */
     1542     6426    6                  END; /* DO I                                                   */
     1543     6427    5               END; /* DO IF SIZE OKAY                                           */
     1544     6428    4               IF ~FOUND
     1545     6429    4               THEN
     1546     6430    4               CALL WRITE_ERR(26);
     1547     6431
     1548     6432        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:53   
     1549     6433
     1550     6434    4            CASE (22 /* KEY_MSG# */);
     1551     6435         /* Blind "TELL" to system consoles                                           */
     1552     6436
     1553     6437    4               IF OC_PARAM$ -> OC$COMM.COUNT >
     1554     6438    4                 SIZEC (TELL_WRITEB.TEXT)
     1555     6439    4               THEN
     1556     6440    4               CALL WRITE_ERR(25);
     1557     6441    4               ELSE
     1558     6442    5               DO; /* Size of text is O.K.                                       */
     1559     6443    5                  FOUND = '0'B /*FALSE#*/;
     1560     6444    5                  NP# = 3;
     1561     6445    5                  MSG# = 387 /* FROMTERM_MSG# */;
     1562     6446    5                  TELL_WRITEC.SIZE = OC_PARAM$ -> OC$COMM.COUNT;
     1563     6447    5                  TELL_WRITEB.TEXT = OC_PARAM$ -> OC$COMM.TEXT;
     1564     6448    5                  TELL_WRITEB.TERM = OC_CONSOLE.TERM_NAME(INDEX_);
     1565     6449    5                  TELL_WRITEB.CONSOLE =
     1566     6450    5                    OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1567     6451    6                  DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1568     6452    6                     IF OC_CONSOLE.ACTIVE(I)
     1569     6453    6                       AND
     1570     6454    6                       ((OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)
     1571     6455    6                       ='0'B)
     1572     6456    6                       AND
     1573     6457    6                       (INDEX_ ~= I)
     1574     6458    6                       AND
     1575     6459    6                       (OC_CONSOLE.ATTR(I) & '200000'O /* K_SYS  */)
     1576     6460    6                     THEN
     1577     6461    7                     DO;
     1578     6462    7                        CALL OCO$IWRITE (
     1579     6463    7                          BINBIT(OC_CONSOLE.CID(I)+
     1580     6464    7                          BITBIN('400000'O),18),
     1581     6465    7                          MSG#, NP#, TELL_WRITEC,
     1582     6466    7                          TELL_WRITEB, 0, OCP_NON_STA,
     1583     6467    7                          0);
     1584     6468    7                        FOUND = '1'B /*TRUE#*/;
     1585     6469    7                     END; /* DO IF CONS O.K.                                     */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:54   
     1586     6470    6                  END; /* DO I                                                   */
     1587     6471
     1588     6472    5                  IF ~FOUND
     1589     6473    5                  THEN
     1590     6474    5                  CALL WRITE_ERR (27);
     1591     6475
     1592     6476    5               END; /* DO IF SIZE OKAY                                           */
     1593     6477
     1594     6478        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:55   
     1595     6479
     1596     6480    4            CASE (20 /* KEY_TELLALL# */);
     1597     6481
     1598     6482    4               FOUND = '0'B /*FALSE#*/;
     1599     6483
     1600     6484    4               IF OC_PARAM$ -> OC$COMM.COUNT >
     1601     6485    4                 SIZEC (TELL_WRITEB.TEXT)
     1602     6486    4               THEN
     1603     6487    4               CALL WRITE_ERR(25);
     1604     6488    4               ELSE
     1605     6489    5               DO;
     1606     6490    5                  NP# = 3;
     1607     6491    5                  MSG# = 387 /* FROMTERM_MSG# */;
     1608     6492    5                  TELL_WRITEC.SIZE = OC_PARAM$ -> OC$COMM.COUNT;
     1609     6493    5                  TELL_WRITEB.TEXT = OC_PARAM$ -> OC$COMM.TEXT;
     1610     6494    5                  TELL_WRITEB.TERM = OC_CONSOLE.TERM_NAME(INDEX_);
     1611     6495    5                  TELL_WRITEB.CONSOLE =
     1612     6496    5                    OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1613     6497    6                  DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1614     6498    6                     IF OC_CONSOLE.ACTIVE(I)
     1615     6499    6                     THEN
     1616     6500    6                     IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)
     1617     6501    6                       ='0'B
     1618     6502    6                     THEN
     1619     6503    6                     IF INDEX_ ~= I
     1620     6504    6                     THEN
     1621     6505    7                     DO;
     1622     6506    7                        CALL OCO$IWRITE (
     1623     6507    7                          BINBIT(OC_CONSOLE.CID(I)+
     1624     6508    7                          BITBIN('400000'O),18),
     1625     6509    7                          MSG#, NP#, TELL_WRITEC,
     1626     6510    7                          TELL_WRITEB, 0,
     1627     6511    7                          OCP_NON_STA, 0);
     1628     6512    7                        FOUND = '1'B /*TRUE#*/;
     1629     6513    7                     END; /* DO IF GOOD CONS                                     */
     1630     6514    6                  END; /* DO I                                                   */
     1631     6515    5                  IF ~FOUND
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:56   
     1632     6516    5                  THEN
     1633     6517    5                  CALL WRITE_ERR(27);
     1634     6518    5               END; /* DO IF SIZE OKAY                                           */
     1635     6519
     1636     6520        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:57   
     1637     6521
     1638     6522    4            CASE (15 /* KEY_INFO# */);
     1639     6523
     1640     6524    4               CALL M$DISPLAY(GET_INFO);
     1641     6525
     1642     6526    4               MSG# = 397 /* INFO_MSG# */;
     1643     6527    4               NP# = 2;
     1644     6528
     1645     6529    5               DO I = 0 TO 3;
     1646     6530
     1647     6531    6                  DO CASE (I);
     1648     6532    6                  CASE (3);
     1649     6533    6                     ;
     1650     6534    6                  CASE (1);
     1651     6535    6                     INFO_WRITEB.INFO = INFO_ARRAY.ETMF;
     1652     6536    6                  CASE(2);
     1653     6537    6                     INFO_WRITEB.INFO = INFO_ARRAY.RESP;
     1654     6538    6                  CASE (0);
     1655     6539    6                     INFO_WRITEB.INFO = INFO_ARRAY.USERS;
     1656     6540    6                  END; /* CASE (I)                                               */
     1657     6541
     1658     6542    5                  INFO_WRITEB.CODE = I;
     1659     6543
     1660     6544    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     1661     6545    5                    INFO_WRITEC, INFO_WRITEB, 0,
     1662     6546    5                    OCP_NON_STA, 0);
     1663     6547    5               END; /* DO I = 0 TO N                                             */
     1664     6548
     1665     6549        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:58   
     1666     6550
     1667     6551    4            CASE (13 /* KEY_CONS# */); /* Handle request to display
     1668     6552         currently logged-on
     1669     6553         consoles                                                                     */
     1670     6554    4               NP# = 30;
     1671     6555    4               MSG# = 398 /* CONSOLE_MSG# */;
     1672     6556
     1673     6557    5               DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1674     6558
     1675     6559    5                  IF OC_CONSOLE.ACTIVE(I)
     1676     6560    5                  THEN
     1677     6561    5                  IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)='0'B /*FALSE#*/
     1678     6562    5                  THEN
     1679     6563    6                  DO;
     1680     6564    6                     STATS_WRITEB.NAME =
     1681     6565    6                       OC_CONSOLE.STATIONR.FIRST_HALF(I);
     1682     6566    6                     STATS_WRITEB.TERM =
     1683     6567    6                       OC_CONSOLE.TERM_NAME(I);
     1684     6568
     1685     6569    6                     STATS_WRITEB.LGN =
     1686     6570    6                       OC_CONSOLE.LOGON(I);
     1687     6571
     1688     6572    6                     STATS_WRITEB.WSN = OC_CONSOLE.WSN(I);
     1689     6573    6                     IF I = INDEX_
     1690     6574    6                     THEN
     1691     6575    6                     STATS_WRITEB.SUB_MESS# = 1;
     1692     6576    6                     ELSE
     1693     6577    6                     STATS_WRITEB.SUB_MESS# = 0;
     1694     6578
     1695     6579    6                     STATS_WRITEB.MXPRIO = OC_CONSOLE.MXPRIO (I);
     1696     6580
     1697     6581    6                     STATS_WRITEB.I_SYS = OC_CONSOLE.ATTR_INPUT (I) & '200000'O
              6581                              /* M_SYS  */;
     1698     6582
     1699     6583    6                     STATS_WRITEB.I_DEV = OC_CONSOLE.ATTR_INPUT (I) & '100000'O
              6583                              /* M_DEVC  */;
     1700     6584
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:59   
     1701     6585    6                     STATS_WRITEB.I_ADMN = OC_CONSOLE.ATTR_INPUT (I) & '040000'O
              6585                              /* M_ADMIN */;
     1702     6586
     1703     6587    6                     STATS_WRITEB.I_DLTA = OC_CONSOLE.ATTR_INPUT (I) & '020000'O
              6587                              /* M_DLTA  */;
     1704     6588
     1705     6589    6                     STATS_WRITEB.I_LIB = OC_CONSOLE.ATTR_INPUT (I) & '010000'O
              6589                              /* M_LIBRN */;
     1706     6590
     1707     6591    6                     STATS_WRITEB.I_COMM = OC_CONSOLE.ATTR_INPUT (I) & '004000'O
              6591                              /* M_COMM */;
     1708     6592
     1709     6593    6                     STATS_WRITEB.I_TP = OC_CONSOLE.ATTR_INPUT (I) & '001000'O
              6593                              /* M_TP */;
     1710     6594
     1711     6595    6                     STATS_WRITEB.O_SYS = OC_CONSOLE.ATTR_OUTPUT (I) & '200000'O
              6595                              /* M_SYS  */;
     1712     6596
     1713     6597    6                     STATS_WRITEB.O_DEV = OC_CONSOLE.ATTR_OUTPUT (I) & '100000'O
              6597                              /* M_DEVC  */;
     1714     6598
     1715     6599    6                     STATS_WRITEB.O_ADMN = OC_CONSOLE.ATTR_OUTPUT (I) & '040000'O
              6599                              /* M_ADMIN */;
     1716     6600
     1717     6601    6                     STATS_WRITEB.O_DLTA = OC_CONSOLE.ATTR_OUTPUT (I) & '020000'O
              6601                              /* M_DLTA  */;
     1718     6602
     1719     6603    6                     STATS_WRITEB.O_LIB = OC_CONSOLE.ATTR_OUTPUT (I) & '010000'O
              6603                              /* M_LIBRN */;
     1720     6604
     1721     6605    6                     STATS_WRITEB.O_COMM = OC_CONSOLE.ATTR_OUTPUT (I) & '004000'O
              6605                              /* M_COMM */;
     1722     6606
     1723     6607    6                     STATS_WRITEB.O_TP = OC_CONSOLE.ATTR_OUTPUT (I) & '001000'O
              6607                              /* M_TP */;
     1724     6608
     1725     6609    6                     CALL OCO$IWRITE(OC_CADDR, MSG#, NP#,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:60   
     1726     6610    6                       STATS_WRITEC, STATS_WRITEB, 0,
     1727     6611    6                       OCP_NON_STA, 0);
     1728     6612
     1729     6613    6                  END; /* DO IF FOUND                                            */
     1730     6614    5               END; /* DO I                                                      */
     1731     6615
     1732     6616        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:61   
     1733     6617
     1734     6618    4            CASE (14 /* KEY_MAST# */);
     1735     6619         /* Handle request to display
     1736     6620              Master terminal names                                                   */
     1737     6621    4               FOUND = '0'B /*FALSE#*/;
     1738     6622    4               NP# = 1;
     1739     6623    4               MSG# = 399 /* MASTER_MSG# */;
     1740     6624
     1741     6625    5               DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;
     1742     6626
     1743     6627    5                  IF OC_CONSOLE.ACTIVE(I)
     1744     6628    5                  THEN
     1745     6629    5                  IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)
     1746     6630    5                    ~= '0'B /*FALSE#*/
     1747     6631    5                  THEN
     1748     6632    6                  DO;
     1749     6633    6                     MSTR_WRITEB.TERM_NAME =
     1750     6634    6                       OC_CONSOLE.TERM_NAME(I);
     1751     6635    6                     CALL OCO$IWRITE(OC_CADDR,MSG#, NP#,
     1752     6636    6                       MSTR_WRITEC, MSTR_WRITEB, 0,
     1753     6637    6                       OCP_NON_STA, 0);
     1754     6638    6                     FOUND = '1'B /*TRUE#*/;
     1755     6639    6                  END; /* DO IF FOUND                                            */
     1756     6640    5               END; /* DO I                                                      */
     1757     6641    4               IF ~FOUND
     1758     6642    4               THEN
     1759     6643    4               CALL WRITE_ERR(24);
     1760     6644
     1761     6645        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:62   
     1762     6646    4            CASE (24 /* KEY_HISTON# */);
     1763     6647         /* HISTORY LOGGING ON REQUEST                                                */
     1764     6648    4               CALL OCL$HON (OC_CADDR);
     1765     6649
     1766     6650
     1767     6651    4            CASE (25 /* KEY_HISTOFF# */);
     1768     6652         /* HISTORY LOGGING OFF REQUEST                                               */
     1769     6653    4               CALL OCL$HOFF (OC_CADDR);
     1770     6654
     1771     6655
     1772     6656    4            CASE (26 /* KEY_RELEASE# */);
     1773     6657         /* REQUEST TO RELEASE FILE AND START ANEW                                    */
     1774     6658    4               CALL OCL$RLS (OC_CADDR, OC_PARAM$ -> OC$MESSAGE.TEXT);
     1775     6659
     1776     6660        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:63   
     1777     6661
     1778     6662    4            CASE (27 /* KEY_XEQ# */);
     1779     6663         /* REQUEST FOR A READ FILE                                                   */
     1780     6664    4               CALL OCR$SREAD (INDEX_, OC_PARAM$ -> OC$MESSAGE.TEXT);
     1781     6665
     1782     6666    4            CASE (28 /* KEY_CANXEQ# */);
     1783     6667    4               CALL OCR$CREAD(INDEX_);
     1784     6668
     1785     6669    4            CASE (38 /* KEY_XEQAR# */);
     1786     6670    4               OC_DEF_ACCT = ':SYS    ';
     1787     6671
     1788     6672    4            CASE (37 /* KEY_MYXEQR# */);
     1789     6673    4               OC_CONSOLE.ACCT(INDEX_) = '        ';
     1790     6674
     1791     6675    4            CASE (29 /* KEY_XEQA# */);
     1792     6676    4               OC_DEF_ACCT = OC_PARAM$ -> OC$SETACCT.ACCT;
     1793     6677
     1794     6678    4            CASE (30 /* KEY_MYXEQ# */);
     1795     6679    4               OC_CONSOLE.ACCT(INDEX_) = OC_PARAM$ -> OC$SETACCT.ACCT;
     1796     6680        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:64   
     1797     6681    4            CASE (31 /* KEY_TURNLG# */);
     1798     6682    4               OC_ACCT_SAVE.ACTIVE = '1'B /*TRUE#*/;
     1799     6683    4               IF OCS_SSIZE ~= 2 /* CHECK IF TIME WAS NOT SPECIFIED              */
     1800     6684    4               THEN
     1801     6685    5               DO;
     1802     6686    5                  OC_ACCT_SAVE.HOUR = 23 /* TURN_HOUR# */;
     1803     6687    5                  OC_ACCT_SAVE.MIN = 59 /* TURN_MIN# */;
     1804     6688    5               END;
     1805     6689    4               ELSE
     1806     6690    5               DO;
     1807     6691    5                  OC_ACCT_SAVE.HOUR = OC_PARAM$ -> OC$AUTO.HOUR;
     1808     6692    5                  OC_ACCT_SAVE.MIN = OC_PARAM$ -> OC$AUTO.MIN;
     1809     6693    5               END;
     1810     6694    4               CALL OCL$STATUS(1 /* OCN_UPDAT_ACCT# */);
     1811     6695
     1812     6696    4            CASE (32 /* KEY_TURNHT# */);
     1813     6697    4               OC_HIST_SAVE.ACTIVE = '1'B /*TRUE#*/;
     1814     6698    4               IF OCS_SSIZE ~= 2 /* CHECK IF TIME WAS NOT SPECIFIED              */
     1815     6699    4               THEN
     1816     6700    5               DO;
     1817     6701    5                  OC_HIST_SAVE.HOUR = 23 /* TURN_HOUR# */;
     1818     6702    5                  OC_HIST_SAVE.MIN = 59 /* TURN_MIN# */;
     1819     6703    5               END;
     1820     6704    4               ELSE
     1821     6705    5               DO;
     1822     6706    5                  OC_HIST_SAVE.HOUR = OC_PARAM$ -> OC$AUTO.HOUR;
     1823     6707    5                  OC_HIST_SAVE.MIN = OC_PARAM$ -> OC$AUTO.MIN;
     1824     6708    5               END;
     1825     6709    4               CALL OCL$STATUS(2 /* OCN_UPDAT_HIST# */);
     1826     6710
     1827     6711    4            CASE (33 /* KEY_TURNALL# */);
     1828     6712    4               OC_ACCT_SAVE.ACTIVE = '1'B /*TRUE#*/;
     1829     6713    4               IF OCS_SSIZE ~= 2 /* CHECK IF TIME WAS NOT SPECIFIED              */
     1830     6714    4               THEN
     1831     6715    5               DO;
     1832     6716    5                  OC_HIST_SAVE.HOUR = 23 /* TURN_HOUR# */;
     1833     6717    5                  OC_HIST_SAVE.MIN = 59 /* TURN_MIN# */;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:65   
     1834     6718    5                  OC_ACCT_SAVE.HOUR = 23 /* TURN_HOUR# */;
     1835     6719    5                  OC_ACCT_SAVE.MIN = 59 /* TURN_MIN# */;
     1836     6720    5               END;
     1837     6721    4               ELSE
     1838     6722    5               DO;
     1839     6723    5                  OC_HIST_SAVE.HOUR = OC_PARAM$ -> OC$AUTO.HOUR;
     1840     6724    5                  OC_HIST_SAVE.MIN = OC_PARAM$ -> OC$AUTO.MIN;
     1841     6725    5                  OC_ACCT_SAVE.HOUR = OC_PARAM$ -> OC$AUTO.HOUR;
     1842     6726    5                  OC_ACCT_SAVE.MIN = OC_PARAM$ -> OC$AUTO.MIN;
     1843     6727    5               END;
     1844     6728    4               OC_HIST_SAVE.ACTIVE = '1'B /*TRUE#*/;
     1845     6729    4               CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */);
     1846     6730
     1847     6731    4            CASE (34 /* KEY_DTURNLG# */);
     1848     6732    4               OC_ACCT_SAVE.ACTIVE = '0'B /*FALSE#*/;
     1849     6733    4               CALL OCL$STATUS(1 /* OCN_UPDAT_ACCT# */);
     1850     6734
     1851     6735    4            CASE (35 /* KEY_DTURNHT# */);
     1852     6736    4               OC_HIST_SAVE.ACTIVE = '0'B /*FALSE#*/;
     1853     6737    4               CALL OCL$STATUS(2 /* OCN_UPDAT_HIST# */);
     1854     6738
     1855     6739    4            CASE (36 /* KEY_DTURNALL# */);
     1856     6740    4               OC_ACCT_SAVE.ACTIVE = '0'B /*FALSE#*/;
     1857     6741    4               OC_HIST_SAVE.ACTIVE = '0'B /*FALSE#*/;
     1858     6742    4               CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */);
     1859     6743        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:66   
     1860     6744    4            CASE (39 /* KEY_NATLANG# */);
     1861     6745    4               OC_CONSOLE.NATLANG(INDEX_) = OC_PARAM$ -> OC$NAT.LANG;
     1862     6746    4               CALL WRITE_ERR(28);
     1863     6747        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:67   
     1864     6748        /* THESE NEXT CASE HANDLE READ$ COMMAND */
     1865     6749    4            CASE (40 /* KEY_READ$# */);
     1866     6750    4               IF OCS_SSIZE ~= 0 AND
     1867     6751    4                 OC_PARAM$ -> OC$READ$.LOGON ~= OC_CONSOLE.LOGON(INDEX_)
     1868     6752    4               THEN
     1869     6753    5               DO;
     1870     6754    5                  CALL WRITE_ERR(30);
     1871     6755    5                  CALL OCR$CREAD(INDEX_);
     1872     6756    5               END;
     1873     6757    4            CASE (41 /* KEY_READ$# */);
     1874     6758
     1875     6759    4               I = 4;
     1876     6760    4               IF OC_PARAM$ -> OC$COMM.DEVICE = '    '
     1877     6761    4               THEN
     1878     6762    4               OC_PARAM$ -> OC$COMM.DEVICE = OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1879     6763    4               ELSE
     1880     6764    4               CALL MY_XLATE (ADDR(OC_PARAM$->OC$COMM.DEVICE), I);
     1881     6765
     1882     6766    4               IF OC_PARAM$ -> OC$COMM.TERM = ' '
     1883     6767    4               THEN
     1884     6768    4               OC_PARAM$ -> OC$COMM.TERM =
     1885     6769    4                 OC_CONSOLE.TERM_NAME (INDEX_);
     1886     6770
     1887     6771    4               IF OC_PARAM$ -> OC$COMM.AT_TERM = ' '
     1888     6772    4               THEN
     1889     6773    4               OC_PARAM$ -> OC$COMM.AT_TERM =
     1890     6774    4                 OC_PARAM$ -> OC$COMM.TERM;
     1891     6775
     1892     6776    4               IF
     1893     6777    4                 OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_) ~=
     1894     6778    4                 OC_PARAM$ -> OC$COMM.DEVICE
     1895     6779    4                 OR
     1896     6780    4                 (OC_CONSOLE.TERM_NAME(INDEX_) ~=
     1897     6781    4                 OC_PARAM$ ->
     1898     6782    4                 OC$COMM.AT_TERM)
     1899     6783    4               THEN
     1900     6784    5               DO;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:68   
     1901     6785    5                  CALL WRITE_ERR(30);
     1902     6786    5                  CALL OCR$CREAD(INDEX_);
     1903     6787    5               END;
     1904     6788        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:69   
     1905     6789    4            CASE (42 /* KEY_STATUS# */);
              6789                     /* STATUS COMMAND                                */
     1906     6790
     1907     6791    4               STATS_WRITEB.NAME =
     1908     6792    4                 OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1909     6793    4               STATS_WRITEB.TERM =
     1910     6794    4                 OC_CONSOLE.TERM_NAME(INDEX_);
     1911     6795
     1912     6796    4               STATS_WRITEB.LGN =
     1913     6797    4                 OC_CONSOLE.LOGON(INDEX_);
     1914     6798
     1915     6799    4               STATS_WRITEB.WSN = OC_CONSOLE.WSN(INDEX_);
     1916     6800
     1917     6801    4               MSG# = 373 /* STAT_MSG# */;
     1918     6802    4               NP# = 32;
     1919     6803         /*                                                                           */
     1920     6804    4               STATS_WRITEB.GHOST_ACTIVE = BITBIN(OC_CONSOLE.GHST(INDEX_));
     1921     6805
     1922     6806    4               STATS_WRITEB.HIST = BITBIN(OC_LIST);
     1923     6807
     1924     6808    4               IF OC_ACCT_SAVE.ACTIVE
     1925     6809    4               THEN
     1926     6810    5               DO;
     1927     6811    5                  STATS_WRITEB.ACCT_HR = OC_ACCT_SAVE.HOUR;
     1928     6812    5                  STATS_WRITEB.ACCT_MIN = OC_ACCT_SAVE.MIN;
     1929     6813    5               END;
     1930     6814    4               ELSE
     1931     6815    4               STATS_WRITEB.ACCT_HR = 99;
     1932     6816
     1933     6817    4               IF OC_HIST_SAVE.ACTIVE
     1934     6818    4               THEN
     1935     6819    5               DO;
     1936     6820    5                  STATS_WRITEB.HIST_HR = OC_HIST_SAVE.HOUR;
     1937     6821    5                  STATS_WRITEB.HIST_MIN = OC_HIST_SAVE.MIN;
     1938     6822    5               END;
     1939     6823    4               ELSE
     1940     6824    4               STATS_WRITEB.HIST_HR = 99;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:70   
     1941     6825
     1942     6826    4               STATS_WRITEB.UPPER = BITBIN(OC_CONSOLE.SHIFT(INDEX_));
     1943     6827    4               STATS_WRITEB.TIME = BITBIN(OC_CONSOLE.DONT_TIME (INDEX_));
     1944     6828    4               STATS_WRITEB.NATLANG = OC_CONSOLE.NATLANG (INDEX_);
     1945     6829    4               STATS_WRITEB.SYSRACCT = OC_DEF_ACCT;
     1946     6830    4               STATS_WRITEB.MYREADA = OC_CONSOLE.ACCT(INDEX_);
     1947     6831
     1948     6832    4               IF STATS_WRITEB.MYREADA = '        '
     1949     6833    4               THEN
     1950     6834    4               STATS_WRITEB.MYREADA = STATS_WRITEB.SYSRACCT;
     1951     6835
     1952     6836    4               STATS_WRITEB.MXPRIO = OC_CONSOLE.MXPRIO (INDEX_);
     1953     6837
     1954     6838    4               STATS_WRITEB.I_SYS = OC_CONSOLE.ATTR_INPUT (INDEX_) & '200000'O
              6838                        /* M_SYS  */;
     1955     6839
     1956     6840    4               STATS_WRITEB.I_DEV = OC_CONSOLE.ATTR_INPUT (INDEX_) & '100000'O
              6840                        /* M_DEVC  */;
     1957     6841
     1958     6842    4               STATS_WRITEB.I_ADMN = OC_CONSOLE.ATTR_INPUT (INDEX_) & '040000'O
              6842                        /* M_ADMIN */;
     1959     6843
     1960     6844    4               STATS_WRITEB.I_DLTA = OC_CONSOLE.ATTR_INPUT (INDEX_) & '020000'O
              6844                        /* M_DLTA  */;
     1961     6845
     1962     6846    4               STATS_WRITEB.I_LIB = OC_CONSOLE.ATTR_INPUT (INDEX_) & '010000'O
              6846                        /* M_LIBRN */;
     1963     6847
     1964     6848    4               STATS_WRITEB.I_COMM = OC_CONSOLE.ATTR_INPUT (INDEX_) & '004000'O
              6848                        /* M_COMM */;
     1965     6849
     1966     6850    4               STATS_WRITEB.I_TP = OC_CONSOLE.ATTR_INPUT (INDEX_) & '001000'O
              6850                        /* M_TP */;
     1967     6851
     1968     6852    4               STATS_WRITEB.O_SYS = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '200000'O
              6852                        /* M_SYS  */;
     1969     6853
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:71   
     1970     6854    4               STATS_WRITEB.O_DEV = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '100000'O
              6854                        /* M_DEVC  */;
     1971     6855
     1972     6856    4               STATS_WRITEB.O_ADMN = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '040000'O
              6856                        /* M_ADMIN */;
     1973     6857
     1974     6858    4               STATS_WRITEB.O_DLTA = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '020000'O
              6858                        /* M_DLTA  */;
     1975     6859
     1976     6860    4               STATS_WRITEB.O_LIB = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '010000'O
              6860                        /* M_LIBRN */;
     1977     6861
     1978     6862    4               STATS_WRITEB.O_COMM = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '004000'O
              6862                        /* M_COMM */;
     1979     6863
     1980     6864    4               STATS_WRITEB.O_TP = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '001000'O
              6864                        /* M_TP */;
     1981     6865
     1982     6866    4               STATS_WRITEB.PROF = OC_CONSOLE.PROFILE.TXT (INDEX_);
     1983     6867
     1984     6868    4               STATS_WRITEB.LPWSN = OC_CONSOLE.LP_WSN (INDEX_);
     1985     6869
     1986     6870    4               STATS_WRITEB.SIZE = 0;
     1987     6871    4               IF OC_CONSOLE.GHSTRD(INDEX_)
     1988     6872    4               THEN
     1989     6873    5               DO;
     1990     6874    6                  DO I = 0 TO 2;
     1991     6875    6                     IF ADDR(OC_CONSOLE.PROMPTS(INDEX_))->
     1992     6876    6                       PROMPT_TABLE.LAST_READ(I)
     1993     6877    6                     THEN
     1994     6878    7                     DO;
     1995     6879    7                        STATS_WRITEB.SIZE =
     1996     6880    7                          ADDR(OC_CONSOLE.PROMPTS(INDEX_))->
     1997     6881    7                          PROMPT_TABLE.SIZER(I);
     1998     6882    7                        PFB = I + 1;
     1999     6883    7                     END; /* IF FOUND                                            */
     2000     6884    6                  END; /* DO I                                                   */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:72   
     2001     6885    5               END; /* IF GHSTRD                                                 */
     2002     6886    5               DO STATS_WRITEB.SUB_MESS# = 0 TO 5;
     2003     6887
     2004     6888    5                  CALL OCO$IWRITE(OC_CADDR, MSG#, NP#,
     2005     6889    5                    STATS_WRITEC, STATS_WRITEB, 0,
     2006     6890    5                    OCP_NON_STA, PFB);
     2007     6891    5               END;
     2008     6892    4               CALL M$MONINFO (GET_HEADY_STUFF)
     2009     6893    4               WHENRETURN
     2010     6894    5               DO;
     2011     6895    5                  NP# = 2;
     2012     6896    5                  MSG# = 365 /* HEADER_MSG#*/;
     2013     6897    5                  IF MYHEADER.CNT > 60 /* MSG_TOOBIG# */
     2014     6898    5                  THEN
     2015     6899    6                  DO;
     2016     6900    6                     HDR_WRITEC.CNT=60 /* MSG_TOOBIG# */;
     2017     6901    6                     HDR_WRITEB.FLAG=0;
     2018     6902    6                     HDR_WRITEB.HEAD=SUBSTR(MYHEADER.HEADER#,0,60 /* MSG_TOOBIG# */);
     2019     6903    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2020     6904    6                       HDR_WRITEC, HDR_WRITEB, 0,
     2021     6905    6                       OCP_NON_STA, 0);
     2022     6906    6                     HDR_WRITEC.CNT=MYHEADER.CNT-60 /* MSG_TOOBIG# */;
     2023     6907    6                     HDR_WRITEB.FLAG=1;
     2024     6908    6                     HDR_WRITEB.HEAD=SUBSTR(MYHEADER.HEADER#,60 /* MSG_TOOBIG# */,
     2025     6909    6                       MYHEADER.CNT-60 /* MSG_TOOBIG# */);
     2026     6910    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2027     6911    6                       HDR_WRITEC, HDR_WRITEB, 0,
     2028     6912    6                       OCP_NON_STA, 0);
     2029     6913    6                  END; /* DO IF MSG > REASONABLE LENGTH                          */
     2030     6914    5                  ELSE
     2031     6915    6                  DO;
     2032     6916    6                     HDR_WRITEC.CNT = MYHEADER.CNT;
     2033     6917    6                     HDR_WRITEB.FLAG=0;
     2034     6918    6                     HDR_WRITEB.HEAD=SUBSTR(MYHEADER.HEADER#,0,MYHEADER.CNT);
     2035     6919    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2036     6920    6                       HDR_WRITEC, HDR_WRITEB, 0,
     2037     6921    6                       OCP_NON_STA, 0);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:73   
     2038     6922    6                  END; /* DO IF MSG < REASONABLE LENGTH                          */
     2039     6923    5               END; /* DO WHENRETURN                                             */
     2040     6924        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:74   
     2041     6925    4            CASE (45 /* KEY_PROFILE# */);
              6925                     /* PROFILE COMMAND                              */
     2042     6926    4               PROF_NAME.L# = OC_PARAM$ -> OC$PROFILE.P_COUNT;
     2043     6927    4               PROF_NAME.NAME# =
     2044     6928    4                 SUBSTR (OC_PARAM$->OC$PROFILE.P_NAME,
     2045     6929    4                 0,
     2046     6930    4                 PROF_NAME.L#);
     2047     6931    4               IF PROF_NAME = OC_CONSOLE.PROFILE (INDEX_)
     2048     6932    4               THEN
     2049     6933    5               DO;
     2050     6934    5                  CALL WRITE_ERR(31);
     2051     6935    5                  RETURN;
     2052     6936    5               END;
     2053     6937
     2054     6938    4               IF OC_CONSOLE.LOGON (INDEX_) = ' '
     2055     6939    4               THEN
     2056     6940    5               DO;
     2057     6941    5                  CALL WRITE_ERR(32);
     2058     6942    5                  RETURN;
     2059     6943    5               END;
     2060     6944
     2061     6945    4               NEW_PROF.BUF_ = VECTOR (PROF_BUFFER);
     2062     6946    4               NEW_PROF.STATION_ =
     2063     6947    4                 VECTOR (OC_CONSOLE.STATION (INDEX_));
     2064     6948
     2065     6949    4               CALL M$PROFILE (NEW_PROF)
     2066     6950    4                 ALTRET (BAD_PROF);
     2067     6951
     2068     6952    4               OC_CONSOLE.PROFILE (INDEX_) = PROF_NAME;
     2069     6953
     2070     6954    5               DO WHILE ('0'B);
     2071     6955    5   BAD_PROF:      ;
     2072     6956    5                  MSG# = 374 /* PROFILE_MSG# */;
     2073     6957    5                  NP# = 2;
     2074     6958    5                  PROFMSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     2075     6959    5                  IF PROF_NAME.L# > 11
     2076     6960    5                    OR
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:75   
     2077     6961    5                    PROF_NAME.L# = 0
     2078     6962    5                  THEN
     2079     6963    5                  PROFMSGB.CODE = 0;
     2080     6964    5                  ELSE
     2081     6965    5                  PROFMSGB.CODE = 1;
     2082     6966
     2083     6967    5                  CALL OCO$IWRITE (OC_CADDR,MSG#,NP#,
     2084     6968    5                    PROFMSGC,PROFMSGB,0,' ',0);
     2085     6969    5               END;
     2086     6970
     2087     6971    4               RETURN;
     2088     6972        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:76   
     2089     6973
     2090     6974         /* Allow the operator to (attempt
     2091     6975              to) change his LPWSN for DOG
     2092     6976              displays                                                                */
     2093     6977    4            CASE (46 /* KEY_LPWSN# */);
     2094     6978
     2095     6979    4               IF ((OCN_ATTRS.INPUT_ & '200000'O /* M_SYS  */) ~= '0'B)
     2096     6980    4                 OR
     2097     6981    4                 ((OCN_ATTRS.OUTPUT_ & '200000'O /* M_SYS  */) ~= '0'B)
     2098     6982    4               THEN
     2099     6983    4               GOTO LP_WSN_OK;
     2100     6984
     2101     6985
     2102     6986    4               CALL INDEX (I, '?', OC_CONSOLE.WSN(INDEX_));
     2103     6987    4               IF I = 8
     2104     6988    4                 OR
     2105     6989    4                 (SUBSTR(OC_CONSOLE.WSN(INDEX_),0,I) ~=
     2106     6990    4                 SUBSTR(OC_PARAM$ -> OC$SETACCT.ACCT, 0, I))
     2107     6991    4               THEN
     2108     6992    5               DO;
     2109     6993    5                  CALL WRITE_ERR (33);
     2110     6994    5                  GOTO ENDLPWSN_CASE;
     2111     6995    5               END; /* DO IF NOT_OKAY                                            */
     2112     6996
     2113     6997
     2114     6998    4   LP_WSN_OK:  ;
     2115     6999
     2116     7000    4               CALL INDEX (I,
     2117     7001    4                 '?',
     2118     7002    4                 OC_PARAM$ -> OC$SETACCT.ACCT);
     2119     7003
     2120     7004    4               IF I ~= 8
     2121     7005    4               THEN
     2122     7006    5               DO;
     2123     7007    5                  CALL WRITE_ERR (33);
     2124     7008    5                  GOTO ENDLPWSN_CASE;
     2125     7009    5               END;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:77   
     2126     7010
     2127     7011    4               OC_CONSOLE.LP_WSN(INDEX_) =
     2128     7012    4                 OC_PARAM$ -> OC$SETACCT.ACCT;
     2129     7013    4               LPWSN_MSGB.LPWSN =
     2130     7014    4                 OC_PARAM$ -> OC$SETACCT.ACCT;
     2131     7015
     2132     7016    4               MSG# = 376 /* LPWSN_MSG# */;
     2133     7017
     2134     7018    4               NP# = 1;
     2135     7019
     2136     7020    4               CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2137     7021    4                 LPWSN_MSGC, LPWSN_MSGB, 0, OCP_NON_STA, 0);
     2138     7022
     2139     7023
     2140     7024    4   ENDLPWSN_CASE: ;
     2141     7025
     2142     7026        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:78   
     2143     7027
     2144     7028
     2145     7029         /* Allow an operator at a SYSTEM
     2146     7030              console to set maximum platen
     2147     7031              width on IOM connected
     2148     7032              consoles                                                                */
     2149     7033    4            CASE (47 /* KEY_PWIDTH# */);
     2150     7034
     2151     7035    4               IF OC_PARAM$ -> OC$PWIDTH.PWIDTH > 132
     2152     7036    4                 OR
     2153     7037    4                 OC_PARAM$ -> OC$PWIDTH.PWIDTH < 72
     2154     7038    4               THEN
     2155     7039    5               DO;
     2156     7040    5                  CALL WRITE_ERR (35);
     2157     7041    5                  GOTO ENDPWIDTH_CASE;
     2158     7042    5               END;
     2159     7043
     2160     7044    4               OC_PLATEN_WIDTH = OC_PARAM$ -> OC$PWIDTH.PWIDTH;
     2161     7045
     2162     7046    4               PWIDTH_MSGB.PWIDTH = OC_PARAM$ -> OC$PWIDTH.PWIDTH;
     2163     7047
     2164     7048    4               NP# = 1;
     2165     7049    4               MSG# = 375 /* PWIDTH_MSG# */;
     2166     7050
     2167     7051    4               CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#,
     2168     7052    4                 PWIDTH_MSGC, PWIDTH_MSGB,
     2169     7053    4                 0, OCP_NON_STA, 0);
     2170     7054
     2171     7055    4   ENDPWIDTH_CASE: ;
     2172     7056
     2173     7057        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:79   
     2174     7058
     2175     7059
     2176     7060         /* If LADCFLG# is set (which
     2177     7061            means the installation is
     2178     7062            LADC) then ghost jobs may
     2179     7063            be invoked from the console.
     2180     7064                        */
     2181     7065
     2182     7066    4            CASE (48 /* KEY_GJOB# */);
     2183     7067
     2184     7068    4               CALL M$MONINFO (GET_LADC_FLAG)
     2185     7069    4                 ALTRET (KEEP_GOING1);
     2186     7070    4   KEEP_GOING1: ;
     2187     7071    4               IF GJOB.LADCFLG# ~= 0
     2188     7072    4               THEN
     2189     7073    5               DO;
     2190     7074    5                  FPT_GJOB.ACCT_ = VECTOR(NIL);
     2191     7075    5                  FPT_GJOB.PASS_ = VECTOR(NIL);
     2192     7076    5                  PTR$ = PINCRW (OC_PARAM$, 1);
     2193     7077    5                  GJOB_NAME.L# = PTR$ -> TEXT.CNT;
     2194     7078    5                  GJOB_NAME.NAME# =
     2195     7079    5                    SUBSTR (PTR$ -> TEXT.C, 0, PTR$ -> TEXT.CNT);
     2196     7080    5                  PTR$ = PINCRC (PTR$, (PTR$ -> TEXT.CNT + 1));
     2197     7081    5                  IF SUBSTR (PTR$ -> TEXT.C, 0, PTR$ -> TEXT.CNT) = ' '
     2198     7082    5                  THEN
     2199     7083    6                  DO;
     2200     7084    6                     FPT_GJOB.CCBUF_ = VECTOR (NIL);
     2201     7085    6                  END;
     2202     7086    5                  ELSE
     2203     7087    6                  DO;
     2204     7088    6                     FPT_GJOB.CCBUF_ = VECTOR (SUBSTR
     2205     7089    6                       (PTR$ -> TEXT.C, 0, PTR$ -> TEXT.CNT));
     2206     7090    6                  END;
     2207     7091
     2208     7092         /* Do not allow SLUG to
     2209     7093            log this ghost on                                                         */
     2210     7094
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:80   
     2211     7095    5                  FPT_GJOB.V.SLEAZE# = '1'B;
     2212     7096
     2213     7097    5                  CALL M$GJOB (FPT_GJOB)
     2214     7098    5                    ALTRET (GJOB_TROUBLE);
     2215     7099
     2216     7100    5               END;
     2217     7101    4               ELSE
     2218     7102    5               DO;
     2219     7103    5                  CALL WRITE_ERR(36);
     2220     7104    5               END;
     2221     7105
     2222     7106    5               DO WHILE ('0'B);
     2223     7107    5   GJOB_TROUBLE:
     2224     7108    5                  MSG# = 377 /* GJOB_MSG# */;
     2225     7109    5                  NP# = 2;
     2226     7110    5                  GJOB_INT_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     2227     7111    5                  GJOB_INT_MSGB.CODE = 0;
     2228     7112    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2229     7113    5                    GJOB_INT_MSGC, GJOB_INT_MSGB, 0, ' ', 0);
     2230     7114    5               END;
     2231     7115        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:81   
     2232     7116
     2233     7117    4            CASE (49 /* KEY_ZAPPHASE# */);
     2234     7118
     2235     7119    4               MSG# = 379 /* ZAPPHASE_MSG# */;
     2236     7120    4               NP# = 3;
     2237     7121
     2238     7122    4               IF ~OC_ZIP
     2239     7123    4               THEN
     2240     7124    5               DO;
     2241     7125    5                  ZAP_PHASE_MSGB.PHASE = 0;
     2242     7126    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2243     7127    5                    ZAP_PHASE_MSGC, ZAP_PHASE_MSGB, 0, ' ', 0);
     2244     7128    5                  GOTO END_ZAPPHASE_CASE;
     2245     7129    5               END;
     2246     7130
     2247     7131    4               ZAP_PHASE_MSGB.PHASE = OCD_ZAPPHASE;
     2248     7132    4               ZAP_PHASE_MSGB.TIME = OCD_ZAPTIME;
     2249     7133
     2250     7134    4               CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2251     7135    4                 ZAP_PHASE_MSGC, ZAP_PHASE_MSGB, 0, ' ', 0);
     2252     7136
     2253     7137         /* If not waiting for MING
     2254     7138            ghosts, go to end of case                                                 */
     2255     7139
     2256     7140    4               IF OCD_ZAPPHASE ~= 4 /* OCD_MING# */
     2257     7141    4               THEN
     2258     7142    4               GOTO END_ZAPPHASE_CASE;
     2259     7143
     2260     7144    5               DO ZI = 0 TO 15/*JG_MING#    */;
     2261     7145    5                  IF ~OCD_GHOSTS.BACK (ZI)
     2262     7146    5                    AND ZI <= 3
     2263     7147    5                  THEN
     2264     7148    6                  DO;
     2265     7149    6                     ZAP_PHASE_MSGB.PHASE = 6;
     2266     7150    6                     ZAP_PHASE_MSGB.MING = ZI;
     2267     7151    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2268     7152    6                       ZAP_PHASE_MSGC, ZAP_PHASE_MSGB, 0, ' ', 0);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:82   
     2269     7153    6                  END;
     2270     7154    5               END;
     2271     7155
     2272     7156    4   END_ZAPPHASE_CASE:;
     2273     7157        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:83   
     2274     7158    4            CASE (50 /* KEY_STARTTP# */);
     2275     7159
     2276     7160    4               MSG# = 382 /* STARTTP_MSG# */;
     2277     7161    4               NP# = 3;
     2278     7162
     2279     7163    4               GJOB_ACCT.ACCT# = OC_PARAM$ -> OC$STARTTP.ACCT;
     2280     7164    4               FPT_GJOB.ACCT_ = VECTOR (GJOB_ACCT);
     2281     7165
     2282     7166    4               GJOB_NAME.L# = OC_PARAM$ -> OC$STARTTP.I_CNT;
     2283     7167    4               GJOB_NAME.NAME# = OC_PARAM$ -> OC$STARTTP.INSTANCE;
     2284     7168    4               TP_MSGB.TPNAME = ' ';
     2285     7169    4               TP_MSGB.TPNAME = OC_PARAM$ -> OC$STARTTP.ACCT;
     2286     7170
     2287     7171    4               PTR$ = PINCRC (OC_PARAM$,
     2288     7172    4                 4
     2289     7173    4                 + LENGTHC (OC_PARAM$ -> OC$STARTTP.ACCT)
     2290     7174    4                 + LENGTHC (OC_PARAM$ -> OC$STARTTP.I_CNT)
     2291     7175    4                 + OC_PARAM$ -> OC$STARTTP.I_CNT);
     2292     7176
     2293     7177    4               IF PTR$ -> OC$TPPASS.PASS ~= ' '
     2294     7178    4               THEN
     2295     7179    5               DO;
     2296     7180    5                  GJOB_PASS.PASS# = PTR$ -> OC$TPPASS.PASS;
     2297     7181    5                  FPT_GJOB.PASS_ = VECTOR (GJOB_PASS);
     2298     7182    5               END;
     2299     7183    4               ELSE
     2300     7184    5               DO;
     2301     7185    5                  FPT_GJOB.PASS_ = VECTOR (NIL);
     2302     7186    5               END;
     2303     7187
     2304     7188    4               FPT_GJOB.CCBUF_ = VECTOR (NIL);
     2305     7189
     2306     7190         /* Allow SLUG to log the instance on                                         */
     2307     7191
     2308     7192    4               FPT_GJOB.V.SLEAZE# = '0'B;
     2309     7193
     2310     7194    4               CALL M$GJOB (FPT_GJOB) ALTRET (NO_START);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:84   
     2311     7195
     2312     7196    4               TP_MSGB.CODE = 0;
     2313     7197    4               CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2314     7198    4                 TP_MSGC, TP_MSGB, 0, ' ', 0);
     2315     7199
     2316     7200    5               DO WHILE ('0'B);
     2317     7201    5   NO_START:      ;
     2318     7202    5                  TP_MSGB.ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
     2319     7203    5                  TP_MSGB.CODE = 1;
     2320     7204    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2321     7205    5                    TP_MSGC, TP_MSGB, 0, ' ', 0);
     2322     7206    5               END;
     2323     7207
     2324     7208    4   END_STARTTP_CASE: ;
     2325     7209        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:85   
     2326     7210    4            CASE (51 /* KEY_TPSLASH# */,52 /* KEY_TPHEADER# */);
     2327     7211
     2328     7212    4               MSG# = 378 /* STATION_MSG# */;
     2329     7213    4               NP# = 2;
     2330     7214    4               STA_MSGB.CODE = 1;
     2331     7215    4               STA_MSGB.STATION = OC_PARAM$ -> OC$TPSEND.TP_STA;
     2332     7216
     2333     7217    5               DO I = 0 TO ((LENGTHC (JG_GHOSTS)) / 8);
     2334     7218    5                  IF OC_PARAM$ -> OC$TPSEND.TP_STA = JG_GHOSTS (I)
     2335     7219    5                  THEN
     2336     7220    6                  DO;
     2337     7221    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2338     7222    6                       STA_MSGC, STA_MSGB, 0, ' ', 0);
     2339     7223    6                     RETURN;
     2340     7224    6                  END;
     2341     7225    5               END;
     2342     7226
     2343     7227         /* Check other illegal TP stations, i.e..
     2344     7228            M$KEYINs, Console Ghosts, RHESUS,
     2345     7229            and MONKEY.                                                               */
     2346     7230
     2347     7231    4               IF SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_STA, 0, 2) = '**'
     2348     7232    4                 OR
     2349     7233    4                 SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_STA, 0, 4) = 'GHST'
     2350     7234    4                 OR
     2351     7235    4                 SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_STA, 0, 6) = 'RHESUS'
     2352     7236    4                 OR
     2353     7237    4                 SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_STA, 0, 6) = 'MONKEY'
     2354     7238    4               THEN
     2355     7239    5               DO;
     2356     7240    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2357     7241    5                    STA_MSGC, STA_MSGB, 0, ' ', 0);
     2358     7242    5                  RETURN;
     2359     7243    5               END;
     2360     7244         /*   Check for '?'
     2361     7245              (Prohibited: cannot
     2362     7246              wildcard station name.)                                                 */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:86   
     2363     7247    4               CALL INDEX(I,'?',OC_PARAM$ -> OC$TPSEND.TP_STA)
     2364     7248    4                 ALTRET (TP_SEND_IT);
     2365     7249         /* Not ALTRETing means '?'
     2366     7250           was found, so error.                                                       */
     2367     7251    4               CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2368     7252    4                 STA_MSGC, STA_MSGB, 0, ' ', 0);
     2369     7253    4               RETURN;
     2370     7254    4   TP_SEND_IT:
     2371     7255
     2372     7256    5               IF OC_PARAM1.KEYIN# = 51 /* KEY_TPSLASH# */ THEN DO;
     2373     7257         /* Send message                                                              */
     2374     7258
     2375     7259    5                  CSCG_EVID.CADDR = OC_CADDR;
     2376     7260    5                  WR_STA.V.EVENT# = BITBIN (CSCG_EVID);
     2377     7261    5                  STA.STATION# = OC_PARAM$ -> OC$TPSEND.TP_STA;
     2378     7262    5                  TP_INSTRUCTION.ATTR = OC_PARAM$ -> OC$TPSEND.ATTR;
     2379     7263    5                  TP_INSTRUCTION.KEY_NUM = 2 /* KEY_TPSEND# */;
     2380     7264    5                  TP_INSTRUCTION.LENGTH = OC_PARAM$ -> OC$TPSEND.TP_LEN;
     2381     7265    5                  TP_INSTRUCTION.INSTRUCT
     2382     7266    5                    = SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_CMD, 0, 94);
     2383     7267
     2384     7268    5                  WR_STA.BUF_.BUF$ = ADDR (TP_INSTRUCTION);
     2385     7269    5                  WR_STA.BUF_.BOUND = (LENGTHC (TP_INSTRUCTION.ATTR) +
     2386     7270    5                    LENGTHC (TP_INSTRUCTION.KEY_NUM) +
     2387     7271    5                    1 + /* Remaining portion of first word.                      */
     2388     7272    5                    LENGTHC (TP_INSTRUCTION.LENGTH) +
     2389     7273    5                    TP_INSTRUCTION.LENGTH);
     2390     7274    5                  CALL M$WRITE (WR_STA) ALTRET (TP_TROUBLE);
     2391     7275    5                  WR_STA.BUF_.BUF$ = ADDR (OC_PARAM);
     2392     7276
     2393     7277    6                  DO WHILE ('0'B);
     2394     7278    6   TP_TROUBLE:
     2395     7279    6                     WR_STA.BUF_.BUF$ = ADDR (OC_PARAM);
     2396     7280    6                     GOTO ARRGH;
     2397     7281    6                  END;
     2398     7282    5               END;
     2399     7283    5               ELSE DO ; /* must be a TPHEADER keyin                             */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:87   
     2400     7284    5                  FOUND = '0'B;
     2401     7285    5                  CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(SKIPIT);
     2402     7286    5                  INSTANCE$=PINCRW(B$DS7$,SIZEW(PC$HDR));
     2403     7287    6                  DO I = 1 TO PC$HDR.CURINSTANCES;
     2404     7288    6                     IF (NOT PC$INSTANCE.FLAGS.DELETED) AND
     2405     7289    6                       (PC$INSTANCE.INSTANCE_NAME =
     2406     7290    6                       OC_PARAM$ -> OC$TPSEND.TP_STA) THEN
     2407     7291    7                     DO;
     2408     7292    7                        J = MINIMUM (80,OC_PARAM$ -> OC$TPSEND.TP_LEN);
     2409     7293    7                        PC$INSTANCE.HDR.CNT = J ;
     2410     7294    7                        PC$INSTANCE.HDR.MSG =
     2411     7295    7                          OC_PARAM$ -> OC$TPSEND.TP_CMD ;
     2412     7296    7                        PC$INSTANCE.FLAGS.HEADER = ( J > 0) ;
     2413     7297    7                        FOUND = '1'B;
     2414     7298    7                        GOTO DONE;
     2415     7299    7                     END;
     2416     7300    6                     INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));
     2417     7301    6                  END;
     2418     7302    5   DONE:          CALL M$CLOSE(CLOSE_TP_FILE) ALTRET(SKIPIT);
     2419     7303
     2420     7304    5   SKIPIT:        IF NOT FOUND THEN
     2421     7305    6                  DO;
     2422     7306    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2423     7307    6                       STA_MSGC, STA_MSGB, 0, ' ', 0);
     2424     7308    6                     RETURN;
     2425     7309    6                  END;
     2426     7310    5               END;
     2427     7311        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:88   
     2428     7312    4            CASE (ELSE); /* CASE BUCKET                                          */
     2429     7313    4               CALL WRITE_ERR(99);
     2430     7314    4   END_CASE:   ;
     2431     7315    4            END; /* CASE (OC_PARAM1.KEYIN#)                                      */
     2432     7316    3         END; /* STA = 'KEYIN'                                                   */
     2433     7317    2         ELSE /* write parameters to correct station                             */
     2434     7318    3         DO;
     2435     7319    3   WRITE_IT_OUT: ;
     2436     7320    3            IF ~OC_ZIP /* IF ZAP IS IN PROGRESS                                  */
     2437     7321    3              OR /* DONT SEND KEYINS TO                                          */
     2438     7322    3              STA.STATION# = 'MONKEY' /* ANYONE BUT MONKEY                       */
     2439     7323    3            THEN
     2440     7324    4            DO;
     2441     7325    4               CSCG_EVID.CADDR = OC_CADDR;
     2442     7326    4               WR_STA.V.EVENT# = BITBIN(CSCG_EVID);
     2443     7327    4               CALL M$WRITE (WR_STA) ALTRET (ARRGH);
     2444     7328
     2445     7329    5               DO WHILE ('0'B /*FALSE#*/);
     2446     7330    5   ARRGH:         ;
     2447     7331    5                  MSG# = 378 /* STATION_MSG# */;
     2448     7332    5                  NP# = 2;
     2449     7333    5                  STA_MSGB.CODE = 0;
     2450     7334    5                  STA_MSGB.STATION = STA.STATION#;
     2451     7335    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
     2452     7336    5                    STA_MSGC, STA_MSGB, 0, ' ', 0);
     2453     7337    5               END; /* DO WHILE (ALTRET)                                         */
     2454     7338    4            END; /* DO IF OKAY TO SEND IT                                        */
     2455     7339    3         END; /* DO IF STA ~= 'KEYIN'                                            */
     2456     7340
     2457     7341    2   IGNORE: ;
     2458     7342
     2459     7343    2      END; /* DO J = 0 TO NUM_STATIONS                                           */
     2460     7344
     2461     7345    1      RETURN;
     2462     7346        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:89   
     2463     7347
     2464     7348        /*
     2465     7349             Internal routine WRITE_ERR
     2466     7350                                                */
     2467     7351    1   WRITE_ERR: PROC (OPTION_);
     2468     7352    2   DCL OPTION_ UBIN WORD;
     2469     7353
     2470     7354
     2471     7355    2      NP# = 1;
     2472     7356    2      MSG# = 396 /* GENL_ERR_MSG# */;
     2473     7357    2      GHST_READC.COUNT_ = OPTION_;
     2474     7358
     2475     7359    2      CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, GHST_READB,
     2476     7360    2        GHST_READC, 0, OCP_NON_STA, 0);
     2477     7361    2      RETURN;
     2478     7362    2   END WRITE_ERR;
     2479     7363
     2480     7364        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:90   
     2481     7365        /*
     2482     7366             Internal routine MY_XLATE
     2483     7367                                                                          */
     2484     7368
     2485     7369    1   MY_XLATE: PROC (MPTR$, MCOUNT);
     2486     7370
     2487     7371    2   DCL MPTR$ PTR;
     2488     7372    2   DCL MCOUNT SBIN;
     2489     7373
     2490     7374    2      TIX2 = -1;
     2491     7375
     2492     7376    3      DO TIX1 = 0 TO MCOUNT - 1;
     2493     7377    3         TEMP2 = ASCBIN (SUBSTR (MPTR$ -> BIG_BUF,TIX1, 1));
     2494     7378    3         IF (TEMP2 ~= 127 /* CHAR_DEL# */)
     2495     7379    3           AND
     2496     7380    3           (TEMP2 ~=  8 /* CHAR_BS# */)
     2497     7381    3         THEN
     2498     7382    4         DO;
     2499     7383    4            TIX2 = TIX2 + 1;
     2500     7384    4            IF (TEMP2 >= 97 /* CHAR_LC_A# */ )
     2501     7385    4              AND
     2502     7386    4              (TEMP2 <= 122 /* CHAR_LC_Z# */ )
     2503     7387    4            THEN
     2504     7388    4            TEMP2 = TEMP2 -
     2505     7389    4              97 /* CHAR_LC_A# */ + 65 /* CHAR_UC_A */;
     2506     7390    4            CALL INSERT (MPTR$->BIG_BUF,
     2507     7391    4              TIX2,1,BINASC(TEMP2));
     2508     7392    4         END; /* DO IF NOT DEL OR BS                                             */
     2509     7393
     2510     7394    3         ELSE
     2511     7395    4         DO;
     2512     7396    4            IF TIX2 > -1
     2513     7397    4            THEN
     2514     7398    4            TIX2 = TIX2 - 1;
     2515     7399    4         END; /* DO IF DEL OR BS                                                 */
     2516     7400    3      END; /* DO TIX1 = 0 TO N-1                                                 */
     2517     7401    2      MCOUNT = TIX2 + 1;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:91   
     2518     7402
     2519     7403    2      RETURN; /* FROM MY_XLATE                                                   */
     2520     7404    2   END MY_XLATE;
     2521     7405
     2522     7406    1   END OCN$KEYIN;
     2523     7407        %EOD;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:92   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   OCD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OCD_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCS_SUBS_C.:E05TOU  is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCN$KEYIN.

   Procedure OCN$KEYIN requires 3509 words for executable code.
   Procedure OCN$KEYIN requires 408 words of local(AUTO) storage.

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:93   

 Object Unit name= OCN$KEYIN                                  File name= OCN$KEYIN.:E05TOU
 UTS= JUL 30 '97 04:01:04.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$CSCG
    1   DCB   even  none     0      0  M$OCCG
    2   Data  even  none   658   1222  OCN$KEYIN
    3   DCB   even  none     0      0  M$UC
    4  RoData even  UTS     60     74  OCN$KEYIN
    5   DCB   even  none     0      0  M$TP
    6   Proc  even  none  3509   6665  OCN$KEYIN
    7  RoData even  none   267    413  OCN$KEYIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        3  OCN$KEYIN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:94   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 OCP$FINDCX
         yes           Std       8 OCO$IWRITE
         yes           Std       1 OCL$HOFF
         yes           Std       9 OCL$LISTIT
         yes           Std       1 OCL$HON
         yes           Std       5 OCW$WRITE
         yes           Std       1 OCL$STATUS
         yes           Std       0 OCS$SYNTAX
         yes           Std       1 OCR$CREAD
         yes           Std       2 OCL$RLS
         yes           Std       2 OCR$SREAD
         yes           Std       1 OCP$PENDRMV
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:95   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$CSCG                                M$OCCG                                M$UC
     OCP_FREE_HEAD                         OCP_USED_HEAD                         OCP_USED_TAIL
     OCP_NON_STA                           OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_KEYIN#                             OC_QHEAD
     OC_KEYINBUF                           OC_QUEUE                              OC_PARAM
     OC_CONSOLE$                           OC_MAXCONSOLE                         OC_KEYINBUF$
     OC_PARAM$                             OC_CADDR                              OC_FIRST
     OC_DIR                                OC_INTBIT                             OC_MASK
     OC_KEY_GOOD                           OC_ZIP                                OC_LIST
     OC_DEF_ACCT                           OC_HIST_SAVE                          OC_ACCT_SAVE
     OC_PLATEN_WIDTH                       OCS_STRUCTURE                         OCS_SSIZE
     OCS_KSIZE                             OCS_STA                               OCS_NAMES
     OCS_ATTR                              OCS_ERRCODE                           OCS_CINDEX
     OCS_VECTOR                            OCS_ERRMSGC                           OCS_ERRMSGB
     OCD_GHOSTS                            OCD_ZAPPHASE                          OCD_ZAPTIME
     OCD_ZAP_SAVE                          B$JIT$                                B$TCB$
     M$TP                                  B$DS7$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:96   


        1        1        /*M* OCN$KEYIN KEYINs routine to parse and process keyins */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,SQB,AND,ENI=0,SDI=3,CSI=0,ECI=0,IND=0,IAD=3,MOC,MEC,CLM=0,MCL=1,EXM=0 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*
       10       10         ###    ###   #   #   #   #   #  #####  #   #   ###   #   #
       11       11        #   #  #   #  #   #  ###  #  #   #      #   #    #    #   #
       12       12        #   #  #      ##  # # #   # #    #       # #     #    ##  #
       13       13        #   #  #      # # #  ###  ##     ####     #      #    # # #
       14       14        #   #  #      #  ##   # # # #    #        #      #    #  ##
       15       15        #   #  #   #  #   #  ###  #  #   #        #      #    #   #
       16       16         ###    ###   #   #   #   #   #  #####    #     ###   #   #
       17       17                                                                   */
       18       18
       19       19        OCN$KEYIN: PROC(KEY_BUF,KEYSIZE,KEY_STA);

     19  6 000000   000000 700200 xent  OCN$KEYIN    TSX0  ! X66_AUTO_3
         6 000001   000630 000003                    ZERO    408,3

       20       20
       21       21    1   DCL KEY_BUF CHAR(KEYSIZE) UNAL; /* BUFFER FOR KEYIN                           */
       22       22    1   DCL KEY_STA CHAR (8) UNAL;
       23       23    1   DCL KEYSIZE UBIN WORD;
       24       24
       25       25    1   DCL OCL$STATUS ENTRY(1);
       26       26    1   DCL OCP$FINDCX ENTRY(2);
       27       27    1   DCL OCP$OCCG ENTRY;
       28       28    1   DCL OCP$PENDRMV ENTRY(1);
       29       29    1   DCL OCS$SYNTAX ENTRY;
       30       30    1   DCL OCO$IWRITE ENTRY(8);
       31       31    1   DCL OCW$WRITE ENTRY(5);
       32       32    1   DCL OCL$LISTIT ENTRY(9);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:97   
       33       33    1   DCL OCL$HOFF ENTRY(1);
       34       34    1   DCL OCL$HON ENTRY(1);
       35       35    1   DCL OCL$RLS ENTRY(2);
       36       36    1   DCL OCR$SREAD ENTRY(2);
       37       37    1   DCL OCR$CREAD ENTRY (1);
       38       38
       39       39    1   DCL M$CSCG DCB;
       40       40    1   DCL M$OCCG DCB;
       41       41
       42       42    1   DCL I STATIC UBIN WORD;
       43       43    1   DCL ZI STATIC UBIN WORD;
       44       44    1   DCL J STATIC SBIN WORD;
       45       45    1   DCL INDEX_ UBIN WORD;
       46       46    1   DCL PASS_INDEX UBIN WORD STATIC ALIGNED INIT (0);
       47       47    1   DCL SIZE UBIN WORD;
       48       48    1   DCL PTR$ PTR;
       49       49    1   DCL TXTC$ PTR;
       50       50    1   DCL NEXT$ PTR STATIC;
       51       51    1   DCL H1_PTR$ PTR;
       52       52    1   DCL H2_PTR$ PTR;
       53       53    1   DCL H3_PTR$ PTR;
       54       54    1   DCL HELP_FLAG BIT(1) STATIC CALIGNED;
       55       55    1   DCL 1 GHST_TEMPLAT STATIC,
       56       56    1          2 * CHAR(4) UNAL INIT ('GHST'),
       57       57    1          2 SYSID UBIN(18) UNAL INIT(0),
       58       58    1          2 CADDR UBIN(18) UNAL INIT(0);
       59       59    1   DCL GHST_TEMPLATC REDEF GHST_TEMPLAT CHAR(8) ;
       60       60    1   DCL FOUND BIT(1) STATIC ALIGNED;
       61       61    1   DCL NOT_FOUND BIT(1) STATIC ALIGNED;
       62       62    1   DCL CADDR BIT(18) STATIC ALIGNED;
       63       63    1   DCL HELP_INDEX UBIN WORD STATIC;
       64       64    1   DCL HELP_ASN UBIN WORD STATIC;
       65       65    1   DCL WORD_ UBIN WORD STATIC ALIGNED;
       66       66    1   DCL BLOCK UBIN (9) STATIC;
       67       67    1   DCL 1 TP_INSTRUCTION STATIC CALIGNED,
       68       68    1          2 * UBIN BYTE CALIGNED INIT (0),
       69       69    1          2 KEY_NUM UBIN BYTE CALIGNED INIT (0),
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:98   
       70       70    1          2 ATTR UBIN HALF CALIGNED INIT (0),
       71       71    1          2 LENGTH UBIN BYTE CALIGNED INIT (0),
       72       72    1          2 INSTRUCT CHAR (95) CALIGNED INIT (' ');
       73       73
       74       74 S      %INCLUDE B$JIT_C;
       75       75        %INCLUDE CP_6;
       76      156        %INCLUDE B_SEGIDS_C;
       77      695        %INCLUDE OC$PEND;
       78      740        %INCLUDE OCS_SUBS_C;
       79      957        %INCLUDE OC_SUBS_C;
       80     1688        %INCLUDE OCD_SUBS_C;
       81     1706        %INCLUDE OCI_SUBS_C;
       82     1804        %INCLUDE JG_GHOSTS_C;
       83     1894        %INCLUDE EL$TABLES;
       84     2217        %INCLUDE EL_SUBS_C;
       85     2301        %INCLUDE OCP_DATA_R;
       86     2318        %INCLUDE OC_DAT_R;
       87     2479        %INCLUDE OCS_DATA_R;
       88     2496        %INCLUDE OCD_DATA_R;
       89     2509        %INCLUDE PC_MACRO_C;
       90     2535        %INCLUDE QQ_MACROS_C;
       91     2960
       92     2961        %B$JIT0;
       93     3050        %U$JIT1;
       94     3124        %A$JIT6X;
       95     3127    1   DCL B$JIT$ PTR SYMREF;
       96     3128    1   DCL B$TCB$ PTR SYMREF;
       97     3129        %B$TCB;
       98     3132        %B$ALT;
       99     3140    1   DCL 1 ERROR STATIC,
      100     3141    1          2 * CHAR(1) INIT(' ') UNAL,
      101     3142    1          2 NUM CHAR(2) UNAL;
      102     3143    1   DCL 1 TEXT BASED,
      103     3144    1          2 CNT UBIN BYTE UNAL,
      104     3145    1          2 C CHAR(TEXT.CNT) UNAL;
      105     3146    1   DCL 1 OC$MESSAGE BASED,
      106     3147    1          2 MK_VECT UBIN BYTE UNAL,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:99   
      107     3148    1          2 KEYIN# UBIN BYTE UNAL,
      108     3149    1          2 CADDR BIT(18) UNAL,
      109     3150    1          2 TEXT CHAR (%(140 /* CSCG_MAXMC# */ - 4)) UNAL;
      110     3151
      111     3152    1   DCL 1 OC$SETACCT BASED,
      112     3153    1          2 * UBIN WORD UNAL,
      113     3154    1          2 ACCT CHAR(8) UNAL;
      114     3155    1   DCL 1 OC$AUTO BASED,
      115     3156    1          2 * UBIN WORD UNAL,
      116     3157    1          2 HOUR UBIN BYTE CALIGNED,
      117     3158    1          2 MIN UBIN BYTE CALIGNED;
      118     3159    1   DCL 1 OC$HELP1 BASED CALIGNED,
      119     3160    1          2 * UBIN WORD CALIGNED,
      120     3161    1          2 DASH UBIN BYTE UNAL;
      121     3162    1   DCL 1 HELP_OUTPUT (0:0) BASED,
      122     3163    1          2 LINE CHAR(79) CALIGNED;
      123     3164    1   DCL 1 OC$READ$ BASED,
      124     3165    1          2 * UBIN WORD UNAL,
      125     3166    1          2 LOGON CHAR(8) UNAL,
      126     3167    1          2 STATION CHAR(8) UNAL;
      127     3168    1   DCL 1 OC$TERMSEND BASED,
      128     3169    1          2 * UBIN WORD UNAL,
      129     3170    1          2 TERM CHAR(8) UNAL,
      130     3171    1          2 SIZE UBIN(9) UNAL,
      131     3172    1          2 MESSAGE CHAR(OC$TERMSEND.SIZE);
      132     3173
      133     3174    1   DCL 1 OC$COMM BASED,
      134     3175    1          2 * UBIN WORD UNAL,
      135     3176    1          2 DEVICE CHAR(4) UNAL,
      136     3177    1          2 AT_TERM CHAR(8) UNAL,
      137     3178    1          2 TERM CHAR(8) UNAL,
      138     3179    1          2 COUNT UBIN BYTE UNAL,
      139     3180    1          2 TEXT CHAR(OC$COMM.COUNT) UNAL;
      140     3181
      141     3182    1   DCL 1 OC$NAT BASED,
      142     3183    1          2 * UBIN WORD UNAL,
      143     3184    1          2 LANG CHAR(1) UNAL;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:100  
      144     3185
      145     3186    1   DCL 1 OC$PROFILE BASED CALIGNED,
      146     3187    1          2 * UBIN WORD CALIGNED,
      147     3188    1          2 P_COUNT UBIN BYTE CALIGNED,
      148     3189    1          2 P_NAME CHAR (11) CALIGNED;
      149     3190
      150     3191    1   DCL 1 OC$PWIDTH BASED CALIGNED,
      151     3192    1          2 * UBIN WORD CALIGNED,
      152     3193    1          2 PWIDTH UBIN WORD CALIGNED;
      153     3194
      154     3195    1   DCL 1 OC$STARTTP BASED CALIGNED,
      155     3196    1          2 * UBIN WORD CALIGNED,
      156     3197    1          2 ACCT CHAR(8) CALIGNED,
      157     3198    1          2 I_CNT UBIN BYTE CALIGNED,
      158     3199    1          2 INSTANCE CHAR(OC$STARTTP.I_CNT) CALIGNED;
      159     3200
      160     3201    1   DCL 1 OC$TPPASS BASED CALIGNED,
      161     3202    1          2 PASS CHAR(8) CALIGNED;
      162     3203
      163     3204    1   DCL 1 OC$TPSEND BASED CALIGNED,
      164     3205    1          2 * UBIN HALF CALIGNED,
      165     3206    1          2 ATTR UBIN HALF CALIGNED,
      166     3207    1          2 TP_STA CHAR(8) CALIGNED,
      167     3208    1          2 TP_LEN UBIN BYTE CALIGNED,
      168     3209    1          2 TP_CMD CHAR(OC$TPSEND.TP_LEN) CALIGNED;
      169     3210
      170     3211    1   DCL BIG_BUF BASED CHAR(140) CALIGNED;
      171     3212
      172     3213    1   DCL 1 GENKEYIN_MSGB STATIC CALIGNED,
      173     3214    1          2 ERR UBIN WORD UNAL INIT (0),
      174     3215    1          2 ERROR REDEF ERR BIT(36) UNAL,
      175     3216    1          2 CODE UBIN BYTE UNAL INIT (0);
      176     3217
      177     3218    1   DCL 1 GENKEYIN_MSGC STATIC CALIGNED,
      178     3219    1          2 * UBIN BYTE UNAL INIT(4),
      179     3220    1          2 * UBIN BYTE UNAL INIT(1);
      180     3221
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:101  
      181     3222    1   DCL 1 REGULAR_READB STATIC,
      182     3223    1          2 * UBIN BYTE UNAL INIT (2),
      183     3224    1          2 * UBIN BYTE UNAL INIT (2),
      184     3225    1          2 * UBIN BYTE UNAL INIT (8);
      185     3226
      186     3227    1   DCL 1 REGULAR_READC STATIC,
      187     3228    1          2 * UBIN(18) UNAL INIT(0),
      188     3229    1          2 SIZER UBIN(18) UNAL,
      189     3230    1          2 ACCT CHAR(8) UNAL;
      190     3231
      191     3232    1   DCL 1 GHST_READB STATIC,
      192     3233    1          2 * UBIN BYTE UNAL INIT(2);
      193     3234
      194     3235    1   DCL 1 GHST_READC STATIC,
      195     3236    1          2 COUNT_ UBIN HALF UNAL;
      196     3237
      197     3238    1   DCL 1 MASTER_WRITE STATIC UNAL,
      198     3239    1          2 TERM CHAR(8) UNAL,
      199     3240    1          2 MESS CHAR(80) UNAL;
      200     3241
      201     3242    1   DCL 1 MASTER_WRITEC STATIC UNAL,
      202     3243    1          2 * UBIN BYTE UNAL INIT(8),
      203     3244    1          2 SIZE UBIN BYTE UNAL INIT(0);
      204     3245
      205     3246    1   DCL BYTES_ UBIN BYTE STATIC UNAL;
      206     3247
      207     3248    1   DCL 1 INFO_WRITEC STATIC UNAL,
      208     3249    1          2 * UBIN BYTE UNAL INIT(1),
      209     3250    1          2 * UBIN BYTE UNAL INIT(4);
      210     3251
      211     3252    1   DCL 1 INFO_WRITEB STATIC UNAL,
      212     3253    1          2 CODE UBIN BYTE UNAL,
      213     3254    1          2 INFO UBIN WORD UNAL;
      214     3255
      215     3256    1   DCL 1 TELL_WRITEC STATIC UNAL,
      216     3257    1          2 * UBIN BYTE UNAL INIT(4),
      217     3258    1          2 * UBIN BYTE UNAL INIT(8),
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:102  
      218     3259    1          2 SIZE UBIN BYTE UNAL INIT(0);
      219     3260
      220     3261    1   DCL 1 TELL_WRITEB STATIC UNAL,
      221     3262    1          2 CONSOLE CHAR(4) UNAL,
      222     3263    1          2 TERM CHAR(8) UNAL,
      223     3264    1          2 TEXT CHAR(80) UNAL;
      224     3265
      225     3266    1   DCL 1 PROFMSGC STATIC UNAL,
      226     3267    1          2 * UBIN BYTE UNAL INIT(4),
      227     3268    1          2 * UBIN BYTE UNAL INIT(1);
      228     3269
      229     3270    1   DCL 1 PROFMSGB STATIC UNAL,
      230     3271    1          2 ERR UBIN WORD UNAL INIT(0),
      231     3272    1          2 ERROR REDEF ERR BIT(36) UNAL,
      232     3273    1          2 CODE UBIN BYTE UNAL INIT(0);
      233     3274
      234     3275    1   DCL 1 PWIDTH_MSGC STATIC CALIGNED,
      235     3276    1          2 * UBIN BYTE CALIGNED INIT(4);
      236     3277
      237     3278    1   DCL 1 PWIDTH_MSGB STATIC CALIGNED,
      238     3279    1          2 PWIDTH UBIN WORD CALIGNED;
      239     3280
      240     3281    1   DCL 1 HELP_MSGB STATIC CALIGNED,
      241     3282    1          2 HMSG CHAR (79) CALIGNED INIT (' '),
      242     3283    1          2 ERR UBIN WORD UNAL INIT (0),
      243     3284    1          2 ERROR REDEF ERR BIT(36) UNAL,
      244     3285    1          2 CODE UBIN BYTE UNAL INIT (0);
      245     3286
      246     3287    1   DCL 1 HELP_MSGC STATIC CALIGNED,
      247     3288    1          2 * UBIN BYTE CALIGNED INIT (79),
      248     3289    1          2 * UBIN BYTE UNAL INIT (4),
      249     3290    1          2 * UBIN BYTE UNAL INIT (1);
      250     3291
      251     3292    1   DCL 1 LPWSN_MSGC STATIC CALIGNED,
      252     3293    1          2 * UBIN BYTE CALIGNED INIT(8);
      253     3294
      254     3295    1   DCL 1 LPWSN_MSGB STATIC CALIGNED,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:103  
      255     3296    1          2 LPWSN CHAR(8) CALIGNED INIT(' ');
      256     3297
      257     3298    1   DCL 1 GJOB_INT_MSGB STATIC CALIGNED,
      258     3299    1          2 ERR UBIN WORD UNAL INIT (0),
      259     3300    1          2 ERROR REDEF ERR BIT (36) UNAL,
      260     3301    1          2 CODE UBIN BYTE UNAL INIT (0);
      261     3302
      262     3303    1   DCL 1 GJOB_INT_MSGC STATIC CALIGNED,
      263     3304    1          2 * UBIN BYTE UNAL INIT (4),
      264     3305    1          2 * UBIN BYTE UNAL INIT (1);
      265     3306
      266     3307    1   DCL 1 STA_MSGB STATIC CALIGNED,
      267     3308    1          2 STATION CHAR (8) CALIGNED INIT (' '),
      268     3309    1          2 CODE UBIN BYTE UNAL INIT (0);
      269     3310
      270     3311    1   DCL 1 STA_MSGC STATIC CALIGNED,
      271     3312    1          2 * UBIN BYTE UNAL INIT (8),
      272     3313    1          2 * UBIN BYTE UNAL INIT (1);
      273     3314
      274     3315    1   DCL 1 ZAP_PHASE_MSGB STATIC CALIGNED,
      275     3316    1          2 PHASE UBIN BYTE UNAL INIT (0),
      276     3317    1          2 TIME CHAR (11) UNAL INIT (' '),
      277     3318    1          2 MING UBIN WORD UNAL;
      278     3319
      279     3320    1   DCL 1 ZAP_PHASE_MSGC STATIC CALIGNED,
      280     3321    1          2 * UBIN BYTE UNAL INIT (1),
      281     3322    1          2 * UBIN BYTE UNAL INIT (11),
      282     3323    1          2 * UBIN BYTE UNAL INIT (4);
      283     3324
      284     3325    1   DCL 1 TP_MSGB STATIC CALIGNED,
      285     3326    1          2 ERR UBIN WORD UNAL INIT (0),
      286     3327    1          2 ERROR REDEF ERR BIT (36),
      287     3328    1          2 CODE UBIN BYTE UNAL,
      288     3329    1          2 TPNAME CHAR(8) UNAL;
      289     3330
      290     3331    1   DCL 1 TP_MSGC STATIC CALIGNED,
      291     3332    1          2 * UBIN BYTE UNAL INIT(4),
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:104  
      292     3333    1          2 * UBIN BYTE UNAL INIT(1),
      293     3334    1          2 * UBIN BYTE UNAL INIT (8);
      294     3335
      295     3336    1   DCL 1 STATS_WRITEB STATIC UNAL,
      296     3337    1          2 SUB_MESS# UBIN BYTE UNAL,
      297     3338    1          2 GHOST_ACTIVE UBIN BYTE UNAL,
      298     3339    1          2 HIST UBIN BYTE UNAL,
      299     3340    1          2 ACCT_HR UBIN BYTE UNAL,
      300     3341    1          2 ACCT_MIN UBIN BYTE UNAL,
      301     3342    1          2 HIST_HR UBIN BYTE UNAL,
      302     3343    1          2 HIST_MIN UBIN BYTE UNAL,
      303     3344    1          2 UPPER UBIN BYTE UNAL,
      304     3345    1          2 TIME UBIN BYTE UNAL,
      305     3346    1          2 NATLANG CHAR(1) UNAL,
      306     3347    1          2 SYSRACCT CHAR(8) UNAL,
      307     3348    1          2 MYREADA CHAR (8) UNAL,
      308     3349    1          2 MXPRIO UBIN BYTE UNAL,
      309     3350    1          2 I_SYS BIT(9) UNAL,
      310     3351    1          2 I_DEV BIT(9) UNAL,
      311     3352    1          2 I_ADMN BIT(9) UNAL,
      312     3353    1          2 I_DLTA BIT(9) UNAL,
      313     3354    1          2 I_LIB BIT(9) UNAL,
      314     3355    1          2 I_COMM BIT(9) UNAL,
      315     3356    1          2 O_SYS BIT(9) UNAL,
      316     3357    1          2 O_DEV BIT(9) UNAL,
      317     3358    1          2 O_ADMN BIT(9) UNAL,
      318     3359    1          2 O_DLTA BIT(9) UNAL,
      319     3360    1          2 O_LIB BIT(9) UNAL,
      320     3361    1          2 O_COMM BIT(9) UNAL,
      321     3362    1          2 NAME CHAR(4) UNAL,
      322     3363    1          2 LGN CHAR(8) UNAL INIT(' '),
      323     3364    1          2 TERM CHAR(8) UNAL,
      324     3365    1          2 WSN CHAR(8) UNAL,
      325     3366    1          2 PROF CHAR(11) UNAL,
      326     3367    1          2 LPWSN CHAR(8) UNAL,
      327     3368    1          2 SIZE UBIN BYTE UNAL,
      328     3369    1          2 I_TP BIT(9) UNAL,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:105  
      329     3370    1          2 O_TP BIT(9) UNAL;
      330     3371    1   DCL 1 STATS_WRITEC STATIC UNAL,
      331     3372    1          2 * UBIN BYTE UNAL INIT(1),
      332     3373    1          2 * UBIN BYTE UNAL INIT(1),
      333     3374    1          2 * UBIN BYTE UNAL INIT(1),
      334     3375    1          2 * UBIN BYTE UNAL INIT(1),
      335     3376    1          2 * UBIN BYTE UNAL INIT(1),
      336     3377    1          2 * UBIN BYTE UNAL INIT(1),
      337     3378    1          2 * UBIN BYTE UNAL INIT(1),
      338     3379    1          2 * UBIN BYTE UNAL INIT(1),
      339     3380    1          2 * UBIN BYTE UNAL INIT(1),
      340     3381    1          2 * UBIN BYTE UNAL INIT(1),
      341     3382    1          2 * UBIN BYTE UNAL INIT(8),
      342     3383    1          2 * UBIN BYTE UNAL INIT(8),
      343     3384    1          2 * UBIN BYTE UNAL INIT(1),
      344     3385    1          2 * UBIN BYTE UNAL INIT(1),
      345     3386    1          2 * UBIN BYTE UNAL INIT(1),
      346     3387    1          2 * UBIN BYTE UNAL INIT(1),
      347     3388    1          2 * UBIN BYTE UNAL INIT(1),
      348     3389    1          2 * UBIN BYTE UNAL INIT(1),
      349     3390    1          2 * UBIN BYTE UNAL INIT(1),
      350     3391    1          2 * UBIN BYTE UNAL INIT(1),
      351     3392    1          2 * UBIN BYTE UNAL INIT(1),
      352     3393    1          2 * UBIN BYTE UNAL INIT(1),
      353     3394    1          2 * UBIN BYTE UNAL INIT(1),
      354     3395    1          2 * UBIN BYTE UNAL INIT(1),
      355     3396    1          2 * UBIN BYTE UNAL INIT(1),
      356     3397    1          2 * UBIN BYTE UNAL INIT(4),
      357     3398    1          2 * UBIN BYTE UNAL INIT(8),
      358     3399    1          2 * UBIN BYTE UNAL INIT(8),
      359     3400    1          2 * UBIN BYTE UNAL INIT(8),
      360     3401    1          2 * UBIN BYTE UNAL INIT(11),
      361     3402    1          2 * UBIN BYTE UNAL INIT(8),
      362     3403    1          2 * UBIN BYTE UNAL INIT(1),
      363     3404    1          2 * UBIN BYTE UNAL INIT(1),
      364     3405    1          2 * UBIN BYTE UNAL INIT(1);
      365     3406
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:106  
      366     3407    1   DCL 1 HDR_WRITEC STATIC CALIGNED,
      367     3408    1          2 * UBIN BYTE CALIGNED INIT(1),
      368     3409    1          2 CNT UBIN BYTE CALIGNED;
      369     3410
      370     3411    1   DCL 1 HDR_WRITEB STATIC CALIGNED,
      371     3412    1          2 FLAG UBIN BYTE CALIGNED,
      372     3413    1          2 HEAD CHAR(60) CALIGNED;
      373     3414
      374     3415    1   DCL 1 MSTR_WRITEC STATIC UNAL,
      375     3416    1          2 * UBIN BYTE UNAL INIT(8);
      376     3417
      377     3418    1   DCL 1 MSTR_WRITEB STATIC UNAL,
      378     3419    1          2 TERM_NAME CHAR(8) UNAL;
      379     3420
      380     3421    1   DCL MSG# UBIN HALF STATIC UNAL;
      381     3422    1   DCL NP# UBIN BYTE STATIC UNAL;
      382     3423    1   DCL PFB SBIN WORD STATIC ALIGNED;
      383     3424
      384     3425    1   DCL TIX2 STATIC SBIN WORD ALIGNED;
      385     3426    1   DCL TIX1 STATIC SBIN WORD ALIGNED;
      386     3427    1   DCL TEMP2 STATIC UBIN WORD ALIGNED;
      387     3428    1   DCL 1 OCN_ATTRS STATIC ALIGNED,
      388     3429    1          2 INPUT_ BIT(18) UNAL,
      389     3430    1          2 OUTPUT_ BIT(18) UNAL;
      390     3431    1   DCL OCN_ATTR REDEF OCN_ATTRS BIT(36) ALIGNED;
      391     3432
      392     3433    1   DCL PROF_BUFFER (0:1500) UBIN BYTE CALIGNED;
      393     3434         /* The following SUBs are for the
      394     3435              buffer editing function for the
      395     3436              main system consoles                                                    */
      396     3437        %SUB CHAR_BS# =" 8 /* CHAR_BS# */";
      397     3438        %SUB CHAR_DEL# ="127 /* CHAR_DEL# */";
      398     3439        %SUB CHAR_LC_A# ="97 /* CHAR_LC_A# */";
      399     3440        %SUB CHAR_LC_Z# ="122 /* CHAR_LC_Z# */";
      400     3441        %SUB CHAR_UC_A# ="65 /* CHAR_UC_A */";
      401     3442
      402     3443         /*
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:107  
      403     3444              %SUB for internal
      404     3445              "reasonable" length                                                     */
      405     3446        %SUB MSG_TOOBIG# = "60 /* MSG_TOOBIG# */";
      406     3447        %OC$MESSHD (DELIM=";");
      407     3461    1   DCL 1 CSCG_EVID ALIGNED STATIC,
      408     3462    1          2 CADDR BIT(18) UNAL,
      409     3463    1          2 * UBIN(18) UNAL INIT(4 /* OC_WRDN_O */);
      410     3464
      411     3465        %EL$OPER (NAME=EL_OPERBUF,
      412     3466         STCLASS=STATIC);
      413     3469    1   DCL OOPS_MSG CONSTANT CHAR(0) UNAL
      414     3470    1   INIT(' KEYIN nodes not available  -  use ESCAPE-type keyins only');
      415     3471
      416     3472        %JG_GHOSTS (FPTN=JG_GHOSTS,
      417     3473         ARRAY=YES,
      418     3474         STCLASS=STATIC);
      419     3512
      420     3513        %INCLUDE XU_PERR_C;
      421     3704
      422     3705        %VLP_STATION (FPTN=STA,
      423     3706         WAS=NO);
      424     3733
      425     3734        %FPT_WRITE (FPTN=WR_STA,
      426     3735         DCB=M$CSCG,
      427     3736         STATION=STA,
      428     3737         BUF=OC_PARAM,
      429     3738         BP=YES,
      430     3739         EVENT=OC_WRDN_O);
      431     3770
      432     3771        %FPT_WRITE (FPTN=REPLY,
      433     3772         DCB=M$CSCG,
      434     3773         STATION=STA,
      435     3774         BP=YES,
      436     3775         EVENT=OC_WRDN_O);
      437     3806
      438     3807        %FPT_WRITE (FPTN=OOPS_WRITE,
      439     3808         DCB=M$OCCG,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:108  
      440     3809         STATION=STA,
      441     3810         BUF=OOPS_MSG);
      442     3841
      443     3842        %FPT_ACTIVATE (FPTN=DEACT,
      444     3843         DCB=M$OCCG,
      445     3844         STATION=STA,
      446     3845         FLUSH=YES,
      447     3846         DISCONNECT=YES);
      448     3869
      449     3870        %FPT_DISPLAY (FPTN=GET_INFO,
      450     3871         RESULTS=INFO_ARRAY);
      451     3884
      452     3885        %VLR_DISPLAY(FPTN=INFO_ARRAY);
      453     3899
      454     3900        %FPT_MONINFO (FPTN=GET_HEADY_STUFF,
      455     3901         HEADER=MYHEADER);
      456     3916
      457     3917        %VLR_HEADER (FPTN=MYHEADER);
      458     3931
      459     3932
      460     3933        %PC$HDR(STCLASS="BASED(B$DS7$)");
      461     3937        %PC$INSTANCE(STCLASS="BASED(INSTANCE$)");
      462     3987        %FPT_OPEN (FPTN=OPEN_TP_CNTRL,
      463     3988         DCB=M$TP,
      464     3989         FUN=UPDATE,
      465     3990         ORG=RANDOM,
      466     3991         ACS=DS7,
      467     3992         ASN=FILE,
      468     3993         EXIST=OLDFILE,
      469     3994         SHARE=ALL,
      470     3995         CTG=YES,
      471     3996         ACCT=SYSACCT,
      472     3997         NAME=TP_CNTRL_D);
      473     4106        %VLP_NAME (FPTN=TP_CNTRL_D,
      474     4107         NAME='TP_CNTRL_D');
      475     4134        %FPT_CLOSE (FPTN=CLOSE_TP_FILE,
      476     4135         DCB=M$TP,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:109  
      477     4136         DISP=SAVE);
      478     4178        %VLP_ACCT (FPTN = SYSACCT,
      479     4179         ACCT = ':SYS');
      480     4192
      481     4193    1   DCL M$TP DCB;
      482     4194    1   DCL INSTANCE$ PTR;
      483     4195
      484     4196    1   DCL B$DS7$ PTR SYMREF;
      485     4197
      486     4198
      487     4199
      488     4200        %INCLUDE SS_SCHED_C;
      489     4433        %INCLUDE CP_6_SUBS;
      490     4973
      491     4974         /* These FPTs are for the console
      492     4975              ghost event handling                                                    */
      493     4976
      494     4977        %FPT_RUE (FPTN=KILL_GHOST,
      495     4978         EVENT=%SS_ABRT);
      496     4992
      497     4993        %FPT_RUE (FPTN=BREAK_GHOST,
      498     4994         EVENT=%SS_CBK);
      499     5008
      500     5009        %FPT_RUE (FPTN=CONTROLY_GHOST,
      501     5010         EVENT=%SS_CEC);
      502     5024
      503     5025        %FPT_ACTIVATE (FPTN=END_O_FILE,
      504     5026         STCLASS=CONSTANT,
      505     5027         STATION=STA,
      506     5028         DCB=M$CSCG,
      507     5029         ABTREAD=%TYC_EOF);
      508     5052
      509     5053        %FPT_TIME (FPTN=GET_SECS,
      510     5054         SOURCE=CLOCK,
      511     5055         DEST=ANS,
      512     5056         TIME=TIME_BUF);
      513     5075
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:110  
      514     5076    1   DCL TIME_BUF CHAR(8) STATIC UNAL;
      515     5077
      516     5078        %FPT_WRSYSLOG (FPTN=WR_ERSEND,
      517     5079         ENTRY=EL_OPERBUF,
      518     5080         SIZE="SIZEW(EL_OPERBUF)",
      519     5081         MMINHIB=NO,
      520     5082         FILENUM=ERRLOG,
      521     5083         TYPE=EL_OPER);
      522     5098
      523     5099        %FPT_PROFILE (FPTN=NEW_PROF,
      524     5100         PROFILE=PROF_NAME,
      525     5101         DCB=M$OCCG);
      526     5122
      527     5123        %VLP_NAME (FPTN=PROF_NAME);
      528     5150        %VLP_NAME (FPTN=HELP_NAME,
      529     5151         NAME='KEYIN');
      530     5178
      531     5179        %VLP_ACCT (FPTN=HELP_ACCT,
      532     5180         ACCT=':SYS');
      533     5193
      534     5194        %VLP_PASS (FPTN=HELP_PASS,
      535     5195         PASS=' ');
      536     5208
      537     5209        %FPT_HELP (FPTN=OCN_HELP,
      538     5210         PROCNAME=HELP_NAME,
      539     5211         PROCACCT=HELP_ACCT,
      540     5212         PROCPASS=HELP_PASS,
      541     5213         KEY1=KEY1,
      542     5214         KEY2=KEY2,
      543     5215         STCLASS=STATIC);
      544     5236
      545     5237        %FPT_GDS (FPTN=GDS_HELP_BUF,
      546     5238         RESULTS=VLP_HELP_RESULTS,
      547     5239         SEGSIZE=2000);
      548     5255
      549     5256        %VLP_VECTOR (FPTN=VLP_HELP_RESULTS);
      550     5271        %FPT_FDS (FPTN=FDS_HELP_BUF,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:111  
      551     5272         RESULTS=VLP_HELP_RESULTS,
      552     5273         SEGSIZE=2000);
      553     5288
      554     5289         /* Reserve a maximum length
      555     5290            of 31. Assign actual
      556     5291            length when text is
      557     5292            placed in NAME.                                                           */
      558     5293        %VLP_NAME (FPTN=KEY1,
      559     5294         LEN=31,
      560     5295         NAME=' ');
      561     5322
      562     5323        %VLP_NAME (FPTN=KEY2,
      563     5324         LEN=31,
      564     5325         NAME=' ');
      565     5352
      566     5353
      567     5354        %FPT_MONINFO (FPTN=GET_LADC_FLAG,
      568     5355         STCLASS=CONSTANT,
      569     5356         MONINFO=GJOB);
      570     5371
      571     5372        %VLR_MONINFO (FPTN=GJOB,
      572     5373         STCLASS=STATIC);
      573     5391
      574     5392        %FPT_GJOB (FPTN=FPT_GJOB,
      575     5393         NAME=GJOB_NAME);
      576     5410
      577     5411        %VLP_NAME (FPTN=GJOB_NAME);
      578     5438        %VLP_ACCT (FPTN=GJOB_ACCT);
      579     5451        %VLP_PASS (FPTN=GJOB_PASS);
      580     5464        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:112  
      581     5465
      582     5466        /*
      583     5467                    Begin  O C N $ K E Y I N  main
      584     5468                                                       */
      585     5469
      586     5470         /* ignore esc f, read complete,
      587     5471              etc                                                                     */
      588     5472    1      IF OC_QUEUE.ERR.CODE(OC_QHEAD) ~= 0

   5472  6 000002   000000 236000 xsym               LDQ     OC_QHEAD
         6 000003   000017 402007                    MPY     15,DL
         6 000004   000002 236006 xsym               LDQ     OC_QUEUE+2,QL
         6 000005   377770 316007                    CANQ    131064,DL
         6 000006   000010 600000 6                  TZE     s:5475

      589     5473    1      THEN
      590     5474    1      RETURN;

   5474  6 000007   000000 702200 xent               TSX2  ! X66_ARET

      591     5475    1      OC_KEYINBUF$ = ADDR(KEY_BUF);

   5475  6 000010   200003 236100                    LDQ     @KEY_BUF,,AUTO
         6 000011   000000 756000 xsym               STQ     OC_KEYINBUF$

      592     5476    1      OCS_KSIZE = KEYSIZE;

   5476  6 000012   200004 470500                    LDP0    @KEYSIZE,,AUTO
         6 000013   000000 235100                    LDA     0,,PR0
         6 000014   000000 755000 xsym               STA     OCS_KSIZE

      593     5477    1      STA.STATION#=KEY_STA;

   5477  6 000015   200005 471500                    LDP1    @KEY_STA,,AUTO
         6 000016   040000 100500                    MLR     fill='040'O
         6 000017   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 000020   000452 000010 2                  ADSC9   STA                      cn=0,n=8
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:113  

      594     5478         /* Attempt to find this console..
      595     5479              if we can't find him...just
      596     5480              return                                                                  */
      597     5481    1      INDEX_ = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   5481  6 000021   000000 235000 xsym               LDA     OC_MAXCONSOLE
         6 000022   000022 771000                    ARL     18
         6 000023   000001 035007                    ADLA    1,DL
         6 000024   200006 755100                    STA     INDEX_,,AUTO

      598     5482    1      CALL OCP$FINDCX (INDEX_, STA.STATION#);

   5482  6 000025   000000 236000 7                  LDQ     0
         6 000026   200613 756100                    STQ     @MCOUNT+3,,AUTO
         6 000027   200006 633500                    EPPR3   INDEX_,,AUTO
         6 000030   200612 453500                    STP3    @MCOUNT+2,,AUTO
         6 000031   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 000032   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000033   000000 701000 xent               TSX1    OCP$FINDCX
         6 000034   000000 011000                    NOP     0

      599     5483    1      IF INDEX_ = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */

   5483  6 000035   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         6 000036   000022 772000                    QRL     18
         6 000037   000001 036007                    ADLQ    1,DL
         6 000040   200006 116100                    CMPQ    INDEX_,,AUTO
         6 000041   000043 601000 6                  TNZ     s:5486

      600     5484    1      THEN
      601     5485    1      RETURN;

   5485  6 000042   000000 702200 xent               TSX2  ! X66_ARET

      602     5486    1      IF (OC_CONSOLE.ATTR(INDEX_) & '002000'O /* K_SLAVE */) ~= '0'B

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:114  
   5486  6 000043   200006 236100                    LDQ     INDEX_,,AUTO
         6 000044   000076 402007                    MPY     62,DL
         6 000045   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 000046   000013 220106                    LDX0    11,QL,PR0
         6 000047   002000 360003                    ANX0    1024,DU
         6 000050   000106 600000 6                  TZE     s:5503

      603     5487    1      THEN
      604     5488    2      DO;

      605     5489    2         NP# = 2;

   5489  6 000051   002000 236003                    LDQ     1024,DU
         6 000052   000311 756000 2                  STQ     NP#

      606     5490    2         MSG# = 389 /* FROMMSTR_MSG# */;

   5490  6 000053   000605 220003                    LDX0    389,DU
         6 000054   000310 740000 2                  STX0    MSG#

      607     5491    2         MASTER_WRITE.TERM = OC_CONSOLE.TERM_NAME(INDEX_);

   5491  6 000055   200006 236100                    LDQ     INDEX_,,AUTO
         6 000056   000370 402007                    MPY     248,DL
         6 000057   040000 100506                    MLR     fill='040'O
         6 000060   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         6 000061   000062 000010 2                  ADSC9   MASTER_WRITE             cn=0,n=8

      608     5492    2         MASTER_WRITE.MESS = KEY_BUF;

   5492  6 000062   200004 471500                    LDP1    @KEYSIZE,,AUTO
         6 000063   100000 721100                    LXL1    0,,PR1
         6 000064   200003 473500                    LDP3    @KEY_BUF,,AUTO
         6 000065   040000 100540                    MLR     fill='040'O
         6 000066   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         6 000067   000064 000120 2                  ADSC9   MASTER_WRITE+2           cn=0,n=80

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:115  
      609     5493    2         IF OCS_KSIZE > SIZEC(MASTER_WRITE.MESS)

   5493  6 000070   000000 235000 xsym               LDA     OCS_KSIZE
         6 000071   000121 115007                    CMPA    81,DL
         6 000072   000076 602000 6                  TNC     s:5497

      610     5494    2         THEN
      611     5495    2         MASTER_WRITEC.SIZE = SIZEC(MASTER_WRITE.MESS);

   5495  6 000073   000120 236003                    LDQ     80,DU
         6 000074   000110 552020 2                  STBQ    MASTER_WRITEC,'20'O
         6 000075   000101 710000 6                  TRA     s:5498

      612     5496    2         ELSE
      613     5497    2         MASTER_WRITEC.SIZE = OCS_KSIZE;

   5497  6 000076   000000 236000 xsym               LDQ     OCS_KSIZE
         6 000077   000022 736000                    QLS     18
         6 000100   000110 552020 2                  STBQ    MASTER_WRITEC,'20'O

      614     5498    2         CALL OCO$IWRITE ('004000'O /* M_COMM */, MSG#, NP#, MASTER_WRITEC,

   5498  6 000101   000002 630400 7                  EPPR0   2
         6 000102   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 000103   000000 701000 xent               TSX1    OCO$IWRITE
         6 000104   000000 011000                    NOP     0

      615     5499    2           MASTER_WRITE, 0, OCP_NON_STA, 0);
      616     5500    2         RETURN;

   5500  6 000105   000000 702200 xent               TSX2  ! X66_ARET

      617     5501    2      END; /* DO IF MASTER TERMINAL SUBMISSION                                   */
      618     5502
      619     5503    1      OC_CONSOLE.TRANSAC_LAST_MIN(INDEX_) = '1'B /*TRUE#*/;

   5503  6 000106   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:116  
         6 000107   020000 236007                    LDQ     8192,DL
         6 000110   000017 256110                    ORSQ    15,X0,PR0

      620     5504
      621     5505    1      IF ~OC_KEY_GOOD

   5505  6 000111   000000 236000 xsym               LDQ     OC_KEY_GOOD
         6 000112   400000 376003                    ANQ     -131072,DU
         6 000113   400000 676003                    ERQ     -131072,DU
         6 000114   000122 600000 6                  TZE     s:5516

      622     5506    1      THEN
      623     5507    2      DO;

      624     5508    2         CALL M$WRITE (OOPS_WRITE) ALTRET (NO_OOPS_ALT);

   5508  6 000115   000512 630400 2                  EPPR0   OOPS_WRITE
         6 000116   440001 713400                    CLIMB   alt,write
         6 000117   401400 401760                    pmme    nvectors=4
         6 000120   000121 702000 6                  TSX2    NO_OOPS_ALT

   5508  6 000121                       NO_OOPS_ALT  null
      625     5509    2   NO_OOPS_ALT: ;
      626     5510    2         RETURN;

   5510  6 000121   000000 702200 xent               TSX2  ! X66_ARET

      627     5511    2      END; /* DO IF NO KEYIN FILE                                                */
      628     5512
      629     5513         /* This little chunk is for handling
      630     5514              the special case of deactivated
      631     5515              central console                                                         */
      632     5516    1      IF ~OC_CONSOLE.ACTIVE(INDEX_)

   5516  6 000122   200006 236100                    LDQ     INDEX_,,AUTO
         6 000123   000076 402007                    MPY     62,DL
         6 000124   000000 470400 xsym               LDP0    OC_CONSOLE$
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:117  
         6 000125   000017 236106                    LDQ     15,QL,PR0
         6 000126   000027 736000                    QLS     23
         6 000127   400000 376003                    ANQ     -131072,DU
         6 000130   400000 676003                    ERQ     -131072,DU
         6 000131   000137 600000 6                  TZE     s:5520

      633     5517    1      THEN
      634     5518    1      OC_CONSOLE.ACTIVE(INDEX_) = '1'B /*TRUE#*/;

   5518  6 000132   200006 236100                    LDQ     INDEX_,,AUTO
         6 000133   000076 402007                    MPY     62,DL
         6 000134   000000 620006                    EAX0    0,QL
         6 000135   010000 236007                    LDQ     4096,DL
         6 000136   000017 256110                    ORSQ    15,X0,PR0

      635     5519
      636     5520    1      OCS_CINDEX = INDEX_;

   5520  6 000137   200006 235100                    LDA     INDEX_,,AUTO
         6 000140   000000 755000 xsym               STA     OCS_CINDEX

      637     5521         /* Set CID bit                                                               */
      638     5522    1      OC_CADDR = BINBIT (OC_CONSOLE.CID(INDEX_) + BITBIN ('400000'O), 18);

   5522  6 000141   200006 236100                    LDQ     INDEX_,,AUTO
         6 000142   000076 402007                    MPY     62,DL
         6 000143   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 000144   000012 236106                    LDQ     10,QL,PR0
         6 000145   000022 772000                    QRL     18
         6 000146   400000 036007                    ADLQ    -131072,DL
         6 000147   000022 736000                    QLS     18
         6 000150   000022 772000                    QRL     18
         6 000151   000000 620006                    EAX0    0,QL
         6 000152   000000 740000 xsym               STX0    OC_CADDR

      639     5523    1      OC_FIRST = '1'B /*TRUE#*/;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:118  
   5523  6 000153   400000 236003                    LDQ     -131072,DU
         6 000154   000000 756000 xsym               STQ     OC_FIRST

      640     5524
      641     5525    1      IF OCS_KSIZE < 2

   5525  6 000155   000000 235000 xsym               LDA     OCS_KSIZE
         6 000156   000002 115007                    CMPA    2,DL
         6 000157   000173 602000 6                  TNC     PARSE_IT

      642     5526    1      THEN
      643     5527    1      GOTO PARSE_IT;
      644     5528
      645     5529    2      DO WHILE (SUBSTR(OC_KEYINBUF$->BIG_BUF,

   5529  6 000160   000166 710000 6                  TRA     s:5536

      646     5530    2        OCS_KSIZE-1,1) = ' ');
      647     5531    2         OCS_KSIZE = OCS_KSIZE - 1;

   5531  6 000161   000000 235000 xsym               LDA     OCS_KSIZE
         6 000162   000001 135007                    SBLA    1,DL
         6 000163   000000 755000 xsym               STA     OCS_KSIZE

      648     5532
      649     5533    2         IF OCS_KSIZE < 2

   5533  6 000164   000002 115007                    CMPA    2,DL
         6 000165   000173 602000 6                  TNC     PARSE_IT

      650     5534    2         THEN
      651     5535    2         GOTO PARSE_IT;
      652     5536    2      END;

   5536  6 000166   000000 470400 xsym               LDP0    OC_KEYINBUF$
         6 000167   040000 106505                    CMPC    fill='040'O
         6 000170   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:119  
         6 000171   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000172   000161 600000 6                  TZE     s:5531

   5531  6 000173                       PARSE_IT     null
      653     5537
      654     5538    1   PARSE_IT: ;
      655     5539
      656     5540         /* If shifting is not neat on this
      657     5541              terminal, perform the backspace
      658     5542              and null edit function, and
      659     5543              shift the lower case stuff                                              */
      660     5544
      661     5545    1      IF OC_CONSOLE.SHIFT(INDEX_)

   5545  6 000173   200006 236100                    LDQ     INDEX_,,AUTO
         6 000174   000076 402007                    MPY     62,DL
         6 000175   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 000176   000017 236106                    LDQ     15,QL,PR0
         6 000177   100000 316007                    CANQ    32768,DL
         6 000200   000207 600000 6                  TZE     s:5549

      662     5546    1      THEN
      663     5547    1      CALL MY_XLATE (OC_KEYINBUF$, OCS_KSIZE);

   5547  6 000201   000012 236000 7                  LDQ     10
         6 000202   200610 756100                    STQ     @MPTR$+1,,AUTO
         6 000203   000013 236000 7                  LDQ     11
         6 000204   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 000205   006606 701000 6                  TSX1    MY_XLATE
         6 000206   000000 011000                    NOP     0

      664     5548
      665     5549    1      IF OCS_KSIZE = 0

   5549  6 000207   000000 235000 xsym               LDA     OCS_KSIZE
         6 000210   000212 601000 6                  TNZ     s:5553

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:120  
      666     5550    1      THEN
      667     5551    1      RETURN;

   5551  6 000211   000000 702200 xent               TSX2  ! X66_ARET

      668     5552
      669     5553    1      CALL OCS$SYNTAX;

   5553  6 000212   000002 631400 xsym               EPPR1   B_VECTNIL+2
         6 000213   000000 701000 xent               TSX1    OCS$SYNTAX
         6 000214   000000 011000                    NOP     0

      670     5554
      671     5555    1      IF OCS_ERRCODE ~= 0

   5555  6 000215   000000 235000 xsym               LDA     OCS_ERRCODE
         6 000216   000246 600000 6                  TZE     s:5569

      672     5556    1      THEN
      673     5557    2      DO;

      674     5558    2         MSG# = 386 /* PARSERR_MSG# */;

   5558  6 000217   000602 220003                    LDX0    386,DU
         6 000220   000310 740000 2                  STX0    MSG#

      675     5559    2         NP# = 4;

   5559  6 000221   004000 236003                    LDQ     2048,DU
         6 000222   000311 756000 2                  STQ     NP#

      676     5560    2         CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   5560  6 000223   000014 630400 7                  EPPR0   12
         6 000224   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 000225   000000 701000 xent               TSX1    OCO$IWRITE
         6 000226   000000 011000                    NOP     0
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:121  

      677     5561    2           OCS_ERRMSGC, OCS_ERRMSGB,
      678     5562    2           0, OCP_NON_STA, 0);
      679     5563    2         IF ADDR(OC_KEYINBUF) ~= OC_KEYINBUF$ AND OC_CONSOLE.X_DCBNUM(INDEX_) ~= 0

   5563  6 000227   000024 236000 7                  LDQ     20
         6 000230   000000 116000 xsym               CMPQ    OC_KEYINBUF$
         6 000231   000245 600000 6                  TZE     s:5566
         6 000232   200006 236100                    LDQ     INDEX_,,AUTO
         6 000233   000076 402007                    MPY     62,DL
         6 000234   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 000235   000015 720106                    LXL0    13,QL,PR0
         6 000236   000245 600000 6                  TZE     s:5566

      680     5564    2         THEN
      681     5565    2         CALL OCR$CREAD(INDEX_); /* CANCEL READ FILE ONB ERROR                   */

   5565  6 000237   200006 631500                    EPPR1   INDEX_,,AUTO
         6 000240   200612 451500                    STP1    @MCOUNT+2,,AUTO
         6 000241   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 000242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000243   000000 701000 xent               TSX1    OCR$CREAD
         6 000244   000000 011000                    NOP     0

      682     5566    2         RETURN;

   5566  6 000245   000000 702200 xent               TSX2  ! X66_ARET

      683     5567    2      END;
      684     5568
      685     5569    1      IF OC_KEYIN# = 0 /* Blank line or CR                                       */

   5569  6 000246   000000 236000 xsym               LDQ     OC_KEYIN#
         6 000247   000251 601000 6                  TNZ     s:5573

      686     5570    1      THEN
      687     5571    1      RETURN;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:122  

   5571  6 000250   000000 702200 xent               TSX2  ! X66_ARET

      688     5572
      689     5573    1      IF OC_LIST

   5573  6 000251   000000 234000 xsym               SZN     OC_LIST
         6 000252   000326 605000 6                  TPL     s:5606

      690     5574    1      THEN
      691     5575    2      DO;

      692     5576
      693     5577         /* Blank the passwords on GHOST keyins
      694     5578            before writing them to :OCHIST                                            */
      695     5579
      696     5580    2         IF OC_KEYIN# = 4 /* KEY_KGHOST# */

   5580  6 000253   000004 116007                    CMPQ    4,DL
         6 000254   000306 601000 6                  TNZ     s:5600

      697     5581    2         THEN
      698     5582    3         DO;

      699     5583    3            CALL INDEX (PASS_INDEX,

   5583  6 000255   200004 470500                    LDP0    @KEYSIZE,,AUTO
         6 000256   000000 720100                    LXL0    0,,PR0
         6 000257   200003 471500                    LDP1    @KEY_BUF,,AUTO
         6 000260   000000 124540                    SCM     mask='000'O
         6 000261   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         6 000262   000025 000001 7                  ADSC9   21                       cn=0,n=1
         6 000263   000003 000000 2                  ARG     PASS_INDEX

      700     5584    3              ',',
      701     5585    3              KEY_BUF,
      702     5586    3              0);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:123  
      703     5587    3            CALL INDEX (PASS_INDEX,

   5587  6 000264   000000 636010                    EAQ     0,X0
         6 000265   000022 772000                    QRL     18
         6 000266   000003 136000 2                  SBLQ    PASS_INDEX
         6 000267   777777 621006                    EAX1    -1,QL
         6 000270   000003 236000 2                  LDQ     PASS_INDEX
         6 000271   000001 036007                    ADLQ    1,DL
         6 000272   000003 235000 2                  LDA     PASS_INDEX
         6 000273   000000 124545                    SCM     mask='000'O
         6 000274   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
         6 000275   000025 000001 7                  ADSC9   21                       cn=0,n=1
         6 000276   000003 000000 2                  ARG     PASS_INDEX
         6 000277   000003 056000 2                  ASQ     PASS_INDEX

      704     5588    3              ',',
      705     5589    3              KEY_BUF,
      706     5590    3              PASS_INDEX + 1);
      707     5591    3            IF PASS_INDEX < OCS_KSIZE

   5591  6 000300   000003 236000 2                  LDQ     PASS_INDEX
         6 000301   000000 116000 xsym               CMPQ    OCS_KSIZE
         6 000302   000306 603000 6                  TRC     s:5600

      708     5592    3            THEN
      709     5593    4            DO;

      710     5594    4               CALL INSERT (KEY_BUF,

   5594  6 000303   040106 100400                    MLR     fill='040'O
         6 000304   000054 000010 4                  ADSC9   GET_LADC_FLAG+12         cn=0,n=8
         6 000305   100000 200010                    ADSC9   0,Q,PR1                  cn=1,n=8

      711     5595    4                 PASS_INDEX + 1,
      712     5596    4                 8,
      713     5597    4                 '        ');
      714     5598    4            END;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:124  

      715     5599    3         END;

      716     5600    2         MSG# = 1024 /* LGST_MSG# */;

   5600  6 000306   002000 220003                    LDX0    1024,DU
         6 000307   000310 740000 2                  STX0    MSG#

      717     5601    2         CALL OCL$LISTIT (0, 1 /* OCI_INPUT# */, MSG#, OCP_NON_STA,

   5601  6 000310   200003 236100                    LDQ     @KEY_BUF,,AUTO
         6 000311   200620 756100                    STQ     @MCOUNT+8,,AUTO
         6 000312   000012 236000 7                  LDQ     10
         6 000313   200617 756100                    STQ     @MCOUNT+7,,AUTO
         6 000314   200006 630500                    EPPR0   INDEX_,,AUTO
         6 000315   200616 450500                    STP0    @MCOUNT+6,,AUTO
         6 000316   000026 237000 7                  LDAQ    22
         6 000317   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 000320   000030 237000 7                  LDAQ    24
         6 000321   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 000322   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 000323   000025 631400 xsym               EPPR1   B_VECTNIL+21
         6 000324   000000 701000 xent               TSX1    OCL$LISTIT
         6 000325   000000 011000                    NOP     0

      718     5602    2           INDEX_, OCS_KSIZE, KEY_BUF, ,);
      719     5603    2      END; /* DO LOGGING                                                         */

      720     5604
      721     5605         /* Illegal on this console?                                                  */
      722     5606    1      OCN_ATTRS.INPUT_ = OC_CONSOLE.ATTR_INPUT(INDEX_);

   5606  6 000326   200006 236100                    LDQ     INDEX_,,AUTO
         6 000327   000076 402007                    MPY     62,DL
         6 000330   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 000331   000013 220106                    LDX0    11,QL,PR0
         6 000332   000316 740000 2                  STX0    OCN_ATTRS
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:125  

      723     5607    1      OCN_ATTRS.OUTPUT_ = OC_CONSOLE.ATTR_OUTPUT(INDEX_);

   5607  6 000333   000014 221106                    LDX1    12,QL,PR0
         6 000334   000316 441000 2                  SXL1    OCN_ATTRS

      724     5608
      725     5609         /* If this keyin is from GOOSE, assign
      726     5610            GOOSE output attributes before the
      727     5611            legality check.  The GOOSE console
      728     5612            normally has SYSTEM output attributes
      729     5613            because all GOOSE messages go to
      730     5614            SYSTEM consoles.                                                          */
      731     5615
      732     5616    1      IF INDEX_ = 0

   5616  6 000335   200006 235100                    LDA     INDEX_,,AUTO
         6 000336   000342 601000 6                  TNZ     s:5620

      733     5617    1      THEN
      734     5618    1      OCN_ATTRS.OUTPUT_ = '000400'O /* M_GOOSE */;

   5618  6 000337   000400 222003                    LDX2    256,DU
         6 000340   000316 442000 2                  SXL2    OCN_ATTRS
         6 000341   000343 710000 6                  TRA     s:5622

      735     5619    1      ELSE
      736     5620    1      OCN_ATTRS.OUTPUT_ = OC_CONSOLE.ATTR_OUTPUT(INDEX_);

   5620  6 000342   000316 441000 2                  SXL1    OCN_ATTRS

      737     5621
      738     5622    1      IF (OCS_ATTR & OCN_ATTR) = '0'B

   5622  6 000343   000000 236000 xsym               LDQ     OCS_ATTR
         6 000344   000316 376000 2                  ANQ     OCN_ATTRS
         6 000345   000371 601000 6                  TNZ     s:5632
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:126  

      739     5623    1      THEN
      740     5624    2      DO;

      741     5625    2         CALL WRITE_ERR(16);

   5625  6 000346   000033 236000 7                  LDQ     27
         6 000347   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 000350   006570 701000 6                  TSX1    WRITE_ERR
         6 000351   000000 011000                    NOP     0

      742     5626    2         IF ADDR(OC_KEYINBUF) ~= OC_KEYINBUF$ AND OC_CONSOLE.X_DCBNUM(INDEX_) ~= 0

   5626  6 000352   000024 236000 7                  LDQ     20
         6 000353   000000 116000 xsym               CMPQ    OC_KEYINBUF$
         6 000354   000370 600000 6                  TZE     s:5629
         6 000355   200006 236100                    LDQ     INDEX_,,AUTO
         6 000356   000076 402007                    MPY     62,DL
         6 000357   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 000360   000015 720106                    LXL0    13,QL,PR0
         6 000361   000370 600000 6                  TZE     s:5629

      743     5627    2         THEN
      744     5628    2         CALL OCR$CREAD(INDEX_); /* CANCEL READ FILE ONB ERROR                   */

   5628  6 000362   200006 631500                    EPPR1   INDEX_,,AUTO
         6 000363   200612 451500                    STP1    @MCOUNT+2,,AUTO
         6 000364   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 000365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000366   000000 701000 xent               TSX1    OCR$CREAD
         6 000367   000000 011000                    NOP     0

      745     5629    2         RETURN;

   5629  6 000370   000000 702200 xent               TSX2  ! X66_ARET

      746     5630    2      END;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:127  
      747     5631        /* CHECK IF THE FIRST COMMAND IN A READ FILE IS  A READ$ */
      748     5632    1      IF OC_CONSOLE.FIRST_READ(INDEX_)

   5632  6 000371   200006 236100                    LDQ     INDEX_,,AUTO
         6 000372   000076 402007                    MPY     62,DL
         6 000373   000017 236106                    LDQ     15,QL,PR0
         6 000374   002000 316007                    CANQ    1024,DL
         6 000375   000430 600000 6                  TZE     s:5651
         6 000376   000024 236000 7                  LDQ     20
         6 000377   000000 116000 xsym               CMPQ    OC_KEYINBUF$
         6 000400   000430 600000 6                  TZE     s:5651
         6 000401   200006 236100                    LDQ     INDEX_,,AUTO
         6 000402   000076 402007                    MPY     62,DL
         6 000403   000015 721106                    LXL1    13,QL,PR0
         6 000404   000430 600000 6                  TZE     s:5651

      749     5633    1        AND ADDR(OC_KEYINBUF) ~= OC_KEYINBUF$
      750     5634    1        AND OC_CONSOLE.X_DCBNUM(INDEX_) ~= 0
      751     5635    2      THEN DO;

      752     5636    2         IF OC_KEYIN# ~= 40 /* KEY_READ$# */

   5636  6 000405   000000 235000 xsym               LDA     OC_KEYIN#
         6 000406   000050 115007                    CMPA    40,DL
         6 000407   000425 600000 6                  TZE     s:5644
         6 000410   000051 115007                    CMPA    41,DL
         6 000411   000425 600000 6                  TZE     s:5644

      753     5637    2           AND OC_KEYIN# ~= 41 /* KEY_READ$# */
      754     5638    2         THEN
      755     5639    3         DO;

      756     5640    3            CALL WRITE_ERR(29);

   5640  6 000412   000035 236000 7                  LDQ     29
         6 000413   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 000414   006570 701000 6                  TSX1    WRITE_ERR
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:128  
         6 000415   000000 011000                    NOP     0

      757     5641    3            CALL OCR$CREAD(INDEX_);

   5641  6 000416   200006 630500                    EPPR0   INDEX_,,AUTO
         6 000417   200612 450500                    STP0    @MCOUNT+2,,AUTO
         6 000420   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 000421   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000422   000000 701000 xent               TSX1    OCR$CREAD
         6 000423   000000 011000                    NOP     0

      758     5642    3            RETURN;

   5642  6 000424   000000 702200 xent               TSX2  ! X66_ARET

      759     5643    3         END;
      760     5644    2         OC_CONSOLE.FIRST_READ(INDEX_) = '0'B /*FALSE#*/;

   5644  6 000425   000000 622006                    EAX2    0,QL
         6 000426   000036 236000 7                  LDQ     30
         6 000427   000017 356112                    ANSQ    15,X2,PR0

      761     5645    2      END;

      762     5646        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:129  
      763     5647
      764     5648         /* Build the final structure from
      765     5649              the passed struct and the
      766     5650              vectors, keyin# and CADDR                                               */
      767     5651    1      PTR$ = ADDR (OC_PARAM);

   5651  6 000430   000037 236000 7                  LDQ     31
         6 000431   200010 756100                    STQ     PTR$,,AUTO

      768     5652    1      PTR$ -> OC$MESSAGE.MK_VECT = OCS_VECTOR;

   5652  6 000432   200010 470500                    LDP0    PTR$,,AUTO
         6 000433   000100 101400                    MRL     fill='000'O
         6 000434   000000 000004 xsym               ADSC9   OCS_VECTOR               cn=0,n=4
         6 000435   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      769     5653    1      PTR$ -> OC$MESSAGE.KEYIN# = OC_KEYIN#;

   5653  6 000436   000100 101400                    MRL     fill='000'O
         6 000437   000000 000004 xsym               ADSC9   OC_KEYIN#                cn=0,n=4
         6 000440   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1

      770     5654    1      PTR$ -> OC$MESSAGE.CADDR = OC_CADDR;

   5654  6 000441   000100 100400                    MLR     fill='000'O
         6 000442   000000 000002 xsym               ADSC9   OC_CADDR                 cn=0,n=2
         6 000443   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2

      771     5655    1      PTR$ -> OC$MESSAGE.TEXT = OCS_STRUCTC;

   5655  6 000444   040100 100400                    MLR     fill='040'O
         6 000445   000000 000210 xsym               ADSC9   OCS_STRUCTURE            cn=0,n=136
         6 000446   000001 000210                    ADSC9   1,,PR0                   cn=0,n=136

      772     5656    1      WR_STA.BUF_.BOUND = OCS_SSIZE + 4 /* SIZE_KNHDR# */ - 1;

   5656  6 000447   000000 236000 xsym               LDQ     OCS_SSIZE
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:130  
         6 000450   000003 036007                    ADLQ    3,DL
         6 000451   000020 736000                    QLS     16
         6 000452   000466 676000 2                  ERQ     WR_STA+4
         6 000453   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 000454   000466 656000 2                  ERSQ    WR_STA+4

      773     5657
      774     5658         /* Perform the KEYIN for each
      775     5659              station that was gotten from
      776     5660              the keyin definition                                                    */
      777     5661    2      DO J = 0 TO (OCS_NAMES - 1);

   5661  6 000455   000002 450000 2                  STZ     J
         6 000456   006563 710000 6                  TRA     IGNORE+1

      778     5662
      779     5663    2         STA.STATION# = OCS_STA(J);

   5663  6 000457   000002 235000 2                  LDA     J
         6 000460   000003 735000                    ALS     3
         6 000461   040000 100405                    MLR     fill='040'O
         6 000462   000000 000010 xsym               ADSC9   OCS_STA,A                cn=0,n=8
         6 000463   000452 000010 2                  ADSC9   STA                      cn=0,n=8

      780     5664    2         IF (STA.STATION# = 'KEYIN') /* internal keyin                           */

   5664  6 000464   040000 106400                    CMPC    fill='040'O
         6 000465   000452 000010 2                  ADSC9   STA                      cn=0,n=8
         6 000466   000056 000005 4                  ADSC9   GET_LADC_FLAG+14         cn=0,n=5
         6 000467   006525 601000 6                  TNZ     WRITE_IT_OUT

      781     5665    2         THEN
      782     5666    3         DO;

      783     5667    4            DO CASE (OC_PARAM1.KEYIN#);

   5667  6 000470   000000 220000 xsym               LDX0    OC_PARAM
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:131  
         6 000471   000065 100003                    CMPX0   53,DU
         6 000472   000474 602010 6                  TNC     s:5667+4,X0
         6 000473   006520 710000 6                  TRA     s:7313
         6 000474   006520 710000 6                  TRA     s:7313
         6 000475   000561 710000 6                  TRA     s:5671
         6 000476   000740 710000 6                  TRA     s:5744
         6 000477   001020 710000 6                  TRA     s:5777
         6 000500   001104 710000 6                  TRA     s:5806
         6 000501   001160 710000 6                  TRA     s:5845
         6 000502   001205 710000 6                  TRA     s:5863
         6 000503   001232 710000 6                  TRA     s:5878
         6 000504   001270 710000 6                  TRA     s:5896
         6 000505   001315 710000 6                  TRA     s:5909
         6 000506   001342 710000 6                  TRA     s:5922
         6 000507   002657 710000 6                  TRA     s:6241
         6 000510   001606 710000 6                  TRA     s:6040
         6 000511   004040 710000 6                  TRA     s:6554
         6 000512   004267 710000 6                  TRA     s:6621
         6 000513   003771 710000 6                  TRA     s:6524
         6 000514   003112 710000 6                  TRA     s:6321
         6 000515   002726 710000 6                  TRA     s:6262
         6 000516   002753 710000 6                  TRA     s:6273
         6 000517   003260 710000 6                  TRA     s:6372
         6 000520   003632 710000 6                  TRA     s:6482
         6 000521   003000 710000 6                  TRA     s:6288
         6 000522   003470 710000 6                  TRA     s:6437
         6 000523   001132 710000 6                  TRA     s:5820
         6 000524   004345 710000 6                  TRA     s:6648
         6 000525   004352 710000 6                  TRA     s:6653
         6 000526   004357 710000 6                  TRA     s:6658
         6 000527   004370 710000 6                  TRA     s:6664
         6 000530   004402 710000 6                  TRA     s:6667
         6 000531   004426 710000 6                  TRA     s:6676
         6 000532   004433 710000 6                  TRA     s:6679
         6 000533   004444 710000 6                  TRA     s:6682
         6 000534   004474 710000 6                  TRA     s:6697
         6 000535   004524 710000 6                  TRA     s:6712
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:132  
         6 000536   004571 710000 6                  TRA     s:6732
         6 000537   004600 710000 6                  TRA     s:6736
         6 000540   004607 710000 6                  TRA     s:6740
         6 000541   004415 710000 6                  TRA     s:6673
         6 000542   004411 710000 6                  TRA     s:6670
         6 000543   004617 710000 6                  TRA     s:6745
         6 000544   004634 710000 6                  TRA     s:6750
         6 000545   004661 710000 6                  TRA     s:6759
         6 000546   004760 710000 6                  TRA     s:6791
         6 000547   002354 710000 6                  TRA     s:6167
         6 000550   002542 710000 6                  TRA     s:6206
         6 000551   005431 710000 6                  TRA     s:6926
         6 000552   005550 710000 6                  TRA     s:6979
         6 000553   005645 710000 6                  TRA     s:7035
         6 000554   005706 710000 6                  TRA     s:7068
         6 000555   006042 710000 6                  TRA     s:7119
         6 000556   006126 710000 6                  TRA     s:7160
         6 000557   006237 710000 6                  TRA     s:7212
         6 000560   006237 710000 6                  TRA     s:7212

      784     5668
      785     5669        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:133  
      786     5670    4            CASE (1 /* KEY_READREPLY# */);

      787     5671    4               NEXT$ = OCP_USED_HEAD$;

   5671  6 000561   000000 236000 xsym               LDQ     OCP_USED_HEAD
         6 000562   000004 756000 2                  STQ     NEXT$

      788     5672    4               FOUND = '0'B /*FALSE#*/;

   5672  6 000563   000010 450000 2                  STZ     FOUND

      789     5673    5               DO WHILE (~FOUND AND NEXT$ ~= ADDR (NIL));

   5673  6 000564   000576 710000 6                  TRA     s:5679

      790     5674    5                  IF NEXT$ -> OC$PEND.SYSID = OC_PARAM1.READID

   5674  6 000565   000004 470400 2                  LDP0    NEXT$
         6 000566   000003 720100                    LXL0    3,,PR0
         6 000567   000001 100000 xsym               CMPX0   OC_PARAM+1
         6 000570   000574 601000 6                  TNZ     s:5678

      791     5675    5                  THEN
      792     5676    5                  FOUND = '1'B /*TRUE#*/;

   5676  6 000571   400000 236003                    LDQ     -131072,DU
         6 000572   000010 756000 2                  STQ     FOUND
         6 000573   000576 710000 6                  TRA     s:5679

      793     5677    5                  ELSE
      794     5678    5                  NEXT$ = NEXT$ -> OC$PEND.LINK$;

   5678  6 000574   000000 236100                    LDQ     0,,PR0
         6 000575   000004 756000 2                  STQ     NEXT$

      795     5679    5               END;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:134  
   5679  6 000576   000010 236000 2                  LDQ     FOUND
         6 000577   400000 376003                    ANQ     -131072,DU
         6 000600   400000 676003                    ERQ     -131072,DU
         6 000601   000605 600000 6                  TZE     s:5680
         6 000602   000004 236000 2                  LDQ     NEXT$
         6 000603   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000604   000565 601000 6                  TNZ     s:5674

      796     5680    4               IF FOUND

   5680  6 000605   000010 234000 2                  SZN     FOUND
         6 000606   000733 605000 6                  TPL     s:5738

      797     5681    4               THEN
      798     5682    5               DO;

      799     5683    5                  FOUND = '0'B /*FALSE#*/;

   5683  6 000607   000010 450000 2                  STZ     FOUND

      800     5684    5                  CADDR = NEXT$ -> OC$PEND.CADDR;

   5684  6 000610   000004 470400 2                  LDP0    NEXT$
         6 000611   000002 220100                    LDX0    2,,PR0
         6 000612   000012 740000 2                  STX0    CADDR

      801     5685         /* Addressed by attributes?                                                  */
      802     5686    5                  IF (CADDR & '400000'O) = '0'B

   5686  6 000613   400000 360003                    ANX0    -131072,DU
         6 000614   000660 601000 6                  TNZ     s:5712

      803     5687    5                  THEN
      804     5688    6                  DO;

      805     5689    6                     IF OC_CONSOLE.ATTR(INDEX_) & '200000'O /* M_SYS  */

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:135  
   5689  6 000615   200006 236100                    LDQ     INDEX_,,AUTO
         6 000616   000076 402007                    MPY     62,DL
         6 000617   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 000620   100013 220106                    LDX0    11,QL,PR1
         6 000621   200000 360003                    ANX0    65536,DU
         6 000622   000626 600000 6                  TZE     s:5694

      806     5690    6                     THEN
      807     5691    6                     FOUND = '1'B /*TRUE#*/;

   5691  6 000623   400000 236003                    LDQ     -131072,DU
         6 000624   000010 756000 2                  STQ     FOUND
         6 000625   000665 710000 6                  TRA     s:5715

      808     5692    6                     ELSE
      809     5693    7                     DO;

      810     5694    7                        OCN_ATTRS.OUTPUT_ = OC_CONSOLE.ATTR(INDEX_) & ~'040000'O
              5694                                 /* M_ADMIN */;

   5694  6 000626   100013 220106                    LDX0    11,QL,PR1
         6 000627   737777 360003                    ANX0    -16385,DU
         6 000630   000316 440000 2                  SXL0    OCN_ATTRS

      811     5695    7                        IF OCN_ATTRS.OUTPUT_

   5695  6 000631   000635 600000 6                  TZE     s:5699

      812     5696    7                        THEN
      813     5697    7                        FOUND = '1'B /*TRUE#*/;

   5697  6 000632   400000 236003                    LDQ     -131072,DU
         6 000633   000010 756000 2                  STQ     FOUND
         6 000634   000665 710000 6                  TRA     s:5715

      814     5698    7                        ELSE
      815     5699    7                        IF OC_CONSOLE.ATTR(INDEX_) & '040000'O /* M_ADMIN */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:136  

   5699  6 000635   100013 221106                    LDX1    11,QL,PR1
         6 000636   040000 361003                    ANX1    16384,DU
         6 000637   000665 600000 6                  TZE     s:5715

      816     5700    7                        THEN
      817     5701    8                        DO;

      818     5702    8                           CALL INDEX(I, '?', OC_CONSOLE.WSN(I));

   5702  6 000640   000000 236000 2                  LDQ     I
         6 000641   000370 402007                    MPY     248,DL
         6 000642   000000 124506                    SCM     mask='000'O
         6 000643   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         6 000644   000040 000001 7                  ADSC9   32                       cn=0,n=1
         6 000645   000000 000000 2                  ARG     I

      819     5703    8                           IF SUBSTR(OC_CONSOLE.WSN(INDEX_),0,I) =

   5703  6 000646   200006 236100                    LDQ     INDEX_,,AUTO
         6 000647   000370 402007                    MPY     248,DL
         6 000650   000000 721000 2                  LXL1    I
         6 000651   040140 106546                    CMPC    fill='040'O
         6 000652   100004 000011                    ADSC9   4,Q,PR1                  cn=0,n=*X1
         6 000653   000006 000011                    ADSC9   6,,PR0                   cn=0,n=*X1
         6 000654   000665 601000 6                  TNZ     s:5715

      820     5704    8                             SUBSTR(NEXT$ -> OC$PEND.WSN, 0, I)
      821     5705    8                           THEN
      822     5706    8                           FOUND = '1'B /*TRUE#*/;

   5706  6 000655   400000 236003                    LDQ     -131072,DU
         6 000656   000010 756000 2                  STQ     FOUND

      823     5707    8                        END; /* DO IF ADMIN                                      */

      824     5708    7                     END; /* DO IF NOT SYSTEM                                    */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:137  

      825     5709
      826     5710    6                  END; /* DO IF attr addressed                                   */

   5710  6 000657   000665 710000 6                  TRA     s:5715

      827     5711    5                  ELSE
      828     5712    5                  IF CADDR = OC_CADDR

   5712  6 000660   000012 220000 2                  LDX0    CADDR
         6 000661   000000 100000 xsym               CMPX0   OC_CADDR
         6 000662   000665 601000 6                  TNZ     s:5715

      829     5713    5                  THEN
      830     5714    5                  FOUND = '1'B /*TRUE#*/;

   5714  6 000663   400000 236003                    LDQ     -131072,DU
         6 000664   000010 756000 2                  STQ     FOUND

      831     5715    5                  IF FOUND

   5715  6 000665   000010 234000 2                  SZN     FOUND
         6 000666   000726 605000 6                  TPL     s:5735

      832     5716    5                  THEN
      833     5717    6                  DO;

      834     5718    6                     IF OC_PARAM1.COUNT = 0

   5718  6 000667   000001 236000 xsym               LDQ     OC_PARAM+1
         6 000670   777000 316007                    CANQ    -512,DL
         6 000671   000677 601000 6                  TNZ     s:5726

      835     5719    6                     THEN
      836     5720    7                     DO;

      837     5721    7                        REPLY.BUF_.BOUND = 0;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:138  

   5721  6 000672   177777 236007                    LDQ     65535,DL
         6 000673   000502 356000 2                  ANSQ    REPLY+4

      838     5722    7                        REPLY.BUF_.BUF$ = ADDR(NIL);

   5722  6 000674   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 000675   000503 756000 2                  STQ     REPLY+5

      839     5723    7                     END;

   5723  6 000676   000711 710000 6                  TRA     s:5730

      840     5724    6                     ELSE
      841     5725    7                     DO;

      842     5726    7                        REPLY.BUF_.BOUND = OC_PARAM1.COUNT - 1;

   5726  6 000677   000001 236000 xsym               LDQ     OC_PARAM+1
         6 000700   000011 772000                    QRL     9
         6 000701   000777 376007                    ANQ     511,DL
         6 000702   000001 136007                    SBLQ    1,DL
         6 000703   000020 736000                    QLS     16
         6 000704   000502 676000 2                  ERQ     REPLY+4
         6 000705   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 000706   000502 656000 2                  ERSQ    REPLY+4

      843     5727    7                        REPLY.BUF_.BUF$ = ADDR (OC_PARAM1.REPLY);

   5727  6 000707   000041 236000 7                  LDQ     33
         6 000710   000503 756000 2                  STQ     REPLY+5

      844     5728    7                     END;

      845     5729
      846     5730    6                     STA.STATION# = NEXT$ -> OC$PEND.STATION;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:139  
   5730  6 000711   040000 100500                    MLR     fill='040'O
         6 000712   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         6 000713   000452 000010 2                  ADSC9   STA                      cn=0,n=8

      847     5731    7                     CALL M$WRITE (REPLY) WHENALTRETURN DO; END;

   5731  6 000714   000476 630400 2                  EPPR0   REPLY
         6 000715   440001 713400                    CLIMB   alt,write
         6 000716   401400 401760                    pmme    nvectors=4
         6 000717   000721 702000 6                  TSX2    s:5732
         6 000720   000721 710000 6                  TRA     s:5732

      848     5732    6                     CALL OCP$PENDRMV (NEXT$);

   5732  6 000721   000042 630400 7                  EPPR0   34
         6 000722   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000723   000000 701000 xent               TSX1    OCP$PENDRMV
         6 000724   000000 011000                    NOP     0

      849     5733    6                  END;

   5733  6 000725   006562 710000 6                  TRA     IGNORE

      850     5734    5                  ELSE /* not this console's read                                */
      851     5735    5                  CALL WRITE_ERR(15);

   5735  6 000726   000044 236000 7                  LDQ     36
         6 000727   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 000730   006570 701000 6                  TSX1    WRITE_ERR
         6 000731   000000 011000                    NOP     0

      852     5736    5               END;

   5736  6 000732   006562 710000 6                  TRA     IGNORE

      853     5737    4               ELSE /* entry doesn't exist                                       */
      854     5738    4               CALL WRITE_ERR(14);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:140  

   5738  6 000733   000046 236000 7                  LDQ     38
         6 000734   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 000735   006570 701000 6                  TSX1    WRITE_ERR
         6 000736   000000 011000                    NOP     0
         6 000737   006562 710000 6                  TRA     IGNORE

      855     5739
      856     5740        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:141  
      857     5741         /* OFF or BYE keyin... disconnect
      858     5742              the console                                                             */
      859     5743    4            CASE (2 /* KEY_OFFBYE# */);

      860     5744    4               STA.STATION#=KEY_STA;

   5744  6 000740   200005 470500                    LDP0    @KEY_STA,,AUTO
         6 000741   040000 100500                    MLR     fill='040'O
         6 000742   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000743   000452 000010 2                  ADSC9   STA                      cn=0,n=8

   5744  6 000744                       KILL_STATION null
      861     5745
      862     5746    4   KILL_STATION: ;
      863     5747         /* Deactivate the requesting console
      864     5748              ALTRET implies LOCAL device or
      865     5749              therefore the main console.
      866     5750              Just clear active in that case
      867     5751                                        */
      868     5752    4               IF SUBSTR (OC_CONSOLE.STATION(INDEX_), 0, 2) = 'SC'

   5752  6 000744   200006 236100                    LDQ     INDEX_,,AUTO
         6 000745   000076 402007                    MPY     62,DL
         6 000746   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 000747   100000 221106                    LDX1    0,QL,PR1
         6 000750   000060 101000 4                  CMPX1   GET_LADC_FLAG+16
         6 000751   001012 601000 6                  TNZ     s:5771

      869     5753    4               THEN
      870     5754    5               DO;

      871     5755
      872     5756
      873     5757         /* If he's got a console ghost, kill
      874     5758              it via operator X'd event                                               */
      875     5759    5                  IF OC_CONSOLE.GHST(INDEX_)

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:142  
   5759  6 000752   100017 236106                    LDQ     15,QL,PR1
         6 000753   400000 316007                    CANQ    -131072,DL
         6 000754   001004 600000 6                  TZE     s:5769

      876     5760    5                  THEN
      877     5761    6                  DO;

      878     5762    6                     KILL_GHOST.V.USER# = OC_CONSOLE.SYSID(INDEX_);

   5762  6 000755   200006 236100                    LDQ     INDEX_,,AUTO
         6 000756   000076 402007                    MPY     62,DL
         6 000757   100012 721106                    LXL1    10,QL,PR1
         6 000760   000774 741000 2                  STX1    KILL_GHOST+2

      879     5763    6                     OC_CONSOLE.SYSID(INDEX_) = 0;

   5763  6 000761   000000 222003                    LDX2    0,DU
         6 000762   100012 442106                    SXL2    10,QL,PR1

      880     5764    6                     OC_CONSOLE.GHST(INDEX_) = '0'B /*FALSE#*/;

   5764  6 000763   200006 236100                    LDQ     INDEX_,,AUTO
         6 000764   000076 402007                    MPY     62,DL
         6 000765   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 000766   000000 620006                    EAX0    0,QL
         6 000767   000047 236000 7                  LDQ     39
         6 000770   100017 356110                    ANSQ    15,X0,PR1

      881     5765    6                     OC_CONSOLE.GHSTRD(INDEX_) = '0'B /*FALSE#*/;

   5765  6 000771   200006 236100                    LDQ     INDEX_,,AUTO
         6 000772   000076 402007                    MPY     62,DL
         6 000773   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 000774   000000 620006                    EAX0    0,QL
         6 000775   000050 236000 7                  LDQ     40
         6 000776   100017 356110                    ANSQ    15,X0,PR1

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:143  
      882     5766    7                     CALL M$RUE (KILL_GHOST) WHENALTRETURN DO; END;

   5766  6 000777   000772 630400 2                  EPPR0   KILL_GHOST
         6 001000   420020 713400                    CLIMB   alt,+8208
         6 001001   400000 401760                    pmme    nvectors=1
         6 001002   001004 702000 6                  TSX2    s:5769
         6 001003   001004 710000 6                  TRA     s:5769

      883     5767    6                  END;

      884     5768
      885     5769    5                  OC_CONSOLE.ACTIVE(INDEX_) = '0'B /*FALSE#*/;

   5769  6 001004   200006 236100                    LDQ     INDEX_,,AUTO
         6 001005   000076 402007                    MPY     62,DL
         6 001006   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001007   000000 620006                    EAX0    0,QL
         6 001010   000051 236000 7                  LDQ     41
         6 001011   000017 356110                    ANSQ    15,X0,PR0

      886     5770    5               END;

      887     5771    5               CALL M$DEACTIVATE (DEACT) WHENALTRETURN DO; END;

   5771  6 001012   000526 630400 2                  EPPR0   DEACT
         6 001013   500001 713400                    CLIMB   alt,+32769
         6 001014   401400 401760                    pmme    nvectors=4
         6 001015   001017 702000 6                  TSX2    s:5771+5
         6 001016   001017 710000 6                  TRA     s:5771+5

   5771  6 001017   006562 710000 6                  TRA     IGNORE

      888     5772
      889     5773
      890     5774        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:144  
      891     5775    4            CASE (3 /* KEY_GHSTREAD# */);

      892     5776         /* IF READ NOT PENDING "ERROR"                                               */
      893     5777    4               IF OC_CONSOLE.SYSID(INDEX_) = 0

   5777  6 001020   200006 236100                    LDQ     INDEX_,,AUTO
         6 001021   000076 402007                    MPY     62,DL
         6 001022   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001023   000012 721106                    LXL1    10,QL,PR0
         6 001024   001030 600000 6                  TZE     s:5781
         6 001025   000017 236106                    LDQ     15,QL,PR0
         6 001026   200000 316007                    CANQ    65536,DL
         6 001027   001035 601000 6                  TNZ     s:5785

      894     5778    4                 OR NOT OC_CONSOLE.GHSTRD(INDEX_)
      895     5779    4               THEN
      896     5780    5               DO;

      897     5781    5                  CALL WRITE_ERR(14);

   5781  6 001030   000046 236000 7                  LDQ     38
         6 001031   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001032   006570 701000 6                  TSX1    WRITE_ERR
         6 001033   000000 011000                    NOP     0

      898     5782    5                  RETURN;

   5782  6 001034   000000 702200 xent               TSX2  ! X66_ARET

      899     5783    5               END; /* DO IF NO READ PENDING                                     */
      900     5784
      901     5785    4               GHST_TEMPLAT.CADDR = BITBIN(OC_CADDR);

   5785  6 001035   000000 236000 xsym               LDQ     OC_CADDR
         6 001036   000022 772000                    QRL     18
         6 001037   000000 621006                    EAX1    0,QL
         6 001040   000007 441000 2                  SXL1    GHST_TEMPLAT+1
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:145  

      902     5786    4               GHST_TEMPLAT.SYSID = OC_CONSOLE.SYSID(INDEX_);

   5786  6 001041   200006 236100                    LDQ     INDEX_,,AUTO
         6 001042   000076 402007                    MPY     62,DL
         6 001043   000012 722106                    LXL2    10,QL,PR0
         6 001044   000007 742000 2                  STX2    GHST_TEMPLAT+1

      903     5787    4               STA.STATION# = GHST_TEMPLATC;

   5787  6 001045   000006 237000 2                  LDAQ    GHST_TEMPLAT
         6 001046   000452 757000 2                  STAQ    STA

      904     5788    4               OC_CONSOLE.GHSTRD(INDEX_) = '0'B /*FALSE#*/;

   5788  6 001047   200006 236100                    LDQ     INDEX_,,AUTO
         6 001050   000076 402007                    MPY     62,DL
         6 001051   000000 623006                    EAX3    0,QL
         6 001052   000050 236000 7                  LDQ     40
         6 001053   000017 356113                    ANSQ    15,X3,PR0

      905     5789
      906     5790    4               IF OC_PARAM1.COUNT = 0

   5790  6 001054   000001 236000 xsym               LDQ     OC_PARAM+1
         6 001055   777000 316007                    CANQ    -512,DL
         6 001056   001064 601000 6                  TNZ     s:5798

      907     5791    4               THEN
      908     5792    5               DO;

      909     5793    5                  REPLY.BUF_.BOUND = 0;

   5793  6 001057   177777 236007                    LDQ     65535,DL
         6 001060   000502 356000 2                  ANSQ    REPLY+4

      910     5794    5                  REPLY.BUF_.BUF$ = ADDR(NIL);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:146  

   5794  6 001061   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 001062   000503 756000 2                  STQ     REPLY+5

      911     5795    5               END;

   5795  6 001063   001076 710000 6                  TRA     s:5802

      912     5796    4               ELSE
      913     5797    5               DO;

      914     5798    5                  REPLY.BUF_.BOUND = OC_PARAM1.COUNT - 1;

   5798  6 001064   000001 236000 xsym               LDQ     OC_PARAM+1
         6 001065   000011 772000                    QRL     9
         6 001066   000777 376007                    ANQ     511,DL
         6 001067   000001 136007                    SBLQ    1,DL
         6 001070   000020 736000                    QLS     16
         6 001071   000502 676000 2                  ERQ     REPLY+4
         6 001072   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 001073   000502 656000 2                  ERSQ    REPLY+4

      915     5799    5                  REPLY.BUF_.BUF$ = ADDR (OC_PARAM1.REPLY);

   5799  6 001074   000041 236000 7                  LDQ     33
         6 001075   000503 756000 2                  STQ     REPLY+5

      916     5800    5               END;

      917     5801
      918     5802    5               CALL M$WRITE (REPLY) WHENALTRETURN DO; END;

   5802  6 001076   000476 630400 2                  EPPR0   REPLY
         6 001077   440001 713400                    CLIMB   alt,write
         6 001100   401400 401760                    pmme    nvectors=4
         6 001101   001103 702000 6                  TSX2    s:5802+5
         6 001102   001103 710000 6                  TRA     s:5802+5
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:147  

   5802  6 001103   006562 710000 6                  TRA     IGNORE

      919     5803        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:148  
      920     5804         /* HANDLE GHOST initiating keyin                                             */
      921     5805    4            CASE (4 /* KEY_KGHOST# */);

      922     5806    4               IF NOT OC_CONSOLE.GHST(INDEX_)

   5806  6 001104   200006 236100                    LDQ     INDEX_,,AUTO
         6 001105   000076 402007                    MPY     62,DL
         6 001106   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001107   000017 236106                    LDQ     15,QL,PR0
         6 001110   400000 316007                    CANQ    -131072,DL
         6 001111   001125 601000 6                  TNZ     s:5815

      923     5807    4               THEN
      924     5808    5               DO;

      925     5809    5                  OC_CONSOLE.GHST(INDEX_) = '1'B /*TRUE#*/;

   5809  6 001112   200006 236100                    LDQ     INDEX_,,AUTO
         6 001113   000076 402007                    MPY     62,DL
         6 001114   000000 621006                    EAX1    0,QL
         6 001115   400000 236007                    LDQ     -131072,DL
         6 001116   000017 256111                    ORSQ    15,X1,PR0

      926     5810    5                  OC_PARAM1.KEYIN# = 2 /* KEY_GHOST# */;

   5810  6 001117   000002 220003                    LDX0    2,DU
         6 001120   000000 740000 xsym               STX0    OC_PARAM

      927     5811    5                  STA.STATION# = 'SLUG';

   5811  6 001121   000061 235000 4                  LDA     GET_LADC_FLAG+17
         6 001122   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 001123   000452 757000 2                  STAQ    STA

      928     5812    5                  GOTO WRITE_IT_OUT;

   5812  6 001124   006525 710000 6                  TRA     WRITE_IT_OUT
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:149  

      929     5813    5               END;
      930     5814    4               ELSE
      931     5815    4               CALL WRITE_ERR(13);

   5815  6 001125   000053 236000 7                  LDQ     43
         6 001126   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001127   006570 701000 6                  TSX1    WRITE_ERR
         6 001130   000000 011000                    NOP     0
         6 001131   006562 710000 6                  TRA     IGNORE

      932     5816        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:150  
      933     5817    4            CASE (23 /* KEY_ZAPKEYIN# */);

      934     5818         /* ZAP! --- TAKE ME DOWN                                                     */
      935     5819
      936     5820    4               IF OC_ZIP

   5820  6 001132   000000 234000 xsym               SZN     OC_ZIP
         6 001133   001135 605000 6                  TPL     s:5833

      937     5821    4               THEN
      938     5822    4               RETURN;

   5822  6 001134   000000 702200 xent               TSX2  ! X66_ARET

      939     5823
      940     5824         /* Send a message to SLUG.
      941     5825            If we get a response that says
      942     5826            its ok to ZAP (meaning that DINGO
      943     5827            has finished) send a message to
      944     5828            MONKEY to disallow new users.
      945     5829            MONKEY will send a message to SLUG
      946     5830            to stop the FEPs, then SLUG will
      947     5831            report back to KEYIN.                                                     */
      948     5832
      949     5833    4               OCD_ZAP_SAVE.CONS_STA = OC_CONSOLE.STATION (INDEX_);

   5833  6 001135   200006 236100                    LDQ     INDEX_,,AUTO
         6 001136   000370 402007                    MPY     248,DL
         6 001137   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001140   040000 100506                    MLR     fill='040'O
         6 001141   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         6 001142   000000 000010 xsym               ADSC9   OCD_ZAP_SAVE             cn=0,n=8

      950     5834    4               OCD_ZAP_SAVE.MESSAGE = OC_PARAM$ -> OC$MESSAGE;

   5834  6 001143   000000 471400 xsym               LDP1    OC_PARAM$
         6 001144   000000 100500                    MLR     fill='000'O
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:151  
         6 001145   100000 000214                    ADSC9   0,,PR1                   cn=0,n=140
         6 001146   000002 200214 xsym               ADSC9   OCD_ZAP_SAVE+2           cn=1,n=140

      951     5835    4               OCD_ZAP_SAVE.CSCG_EVID.CADDR = OC_CADDR;

   5835  6 001147   000000 236000 xsym               LDQ     OC_CADDR
         6 001150   000011 772000                    QRL     9
         6 001151   000045 552030 xsym               STBQ    OCD_ZAP_SAVE+37,'30'O

      952     5836
      953     5837    4               OC_PARAM$ -> OC$MESSAGE.KEYIN# = 16 /* KEY_OKTOZAP# */;

   5837  6 001152   000100 101400                    MRL     fill='000'O
         6 001153   000032 000004 7                  ADSC9   26                       cn=0,n=4
         6 001154   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1

      954     5838
      955     5839    4               STA.STATION# = 'SLUG    ';

   5839  6 001155   000062 237000 4                  LDAQ    GET_LADC_FLAG+18
         6 001156   000452 757000 2                  STAQ    STA

      956     5840
      957     5841    4               GOTO WRITE_IT_OUT;

   5841  6 001157   006525 710000 6                  TRA     WRITE_IT_OUT

      958     5842        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:152  
      959     5843    4            CASE (5 /* KEY_BRK# */);
              5843                     /* Simulate BREAK event for c.ghost                 */

      960     5844
      961     5845    4               IF OC_CONSOLE.SYSID(INDEX_) ~= 0

   5845  6 001160   200006 236100                    LDQ     INDEX_,,AUTO
         6 001161   000076 402007                    MPY     62,DL
         6 001162   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001163   000012 721106                    LXL1    10,QL,PR0
         6 001164   001173 600000 6                  TZE     s:5852

      962     5846    4               THEN
      963     5847    5               DO;

      964     5848    5                  BREAK_GHOST.V.USER# = OC_CONSOLE.SYSID(INDEX_);

   5848  6 001165   001000 741000 2                  STX1    BREAK_GHOST+2

      965     5849    5                  CALL M$RUE (BREAK_GHOST) ALTRET (NO_BREAK);

   5849  6 001166   000776 630400 2                  EPPR0   BREAK_GHOST
         6 001167   420020 713400                    CLIMB   alt,+8208
         6 001170   400000 401760                    pmme    nvectors=1
         6 001171   001200 702000 6                  TSX2    NO_BREAK

      966     5850    5               END;

   5850  6 001172   001177 710000 6                  TRA     s:5854

      967     5851    4               ELSE
      968     5852    4               CALL WRITE_ERR(12);

   5852  6 001173   000055 236000 7                  LDQ     45
         6 001174   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001175   006570 701000 6                  TSX1    WRITE_ERR
         6 001176   000000 011000                    NOP     0
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:153  

      969     5853
      970     5854    5               DO WHILE ('0'B /*FALSE#*/);

   5854  6 001177   006562 710000 6                  TRA     IGNORE

   5851  6 001200                       NO_BREAK     null
      971     5855    5   NO_BREAK:      ;
      972     5856    5                  CALL WRITE_ERR(11);

   5856  6 001200   000056 236000 7                  LDQ     46
         6 001201   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001202   006570 701000 6                  TSX1    WRITE_ERR
         6 001203   000000 011000                    NOP     0

      973     5857    5               END; /* DO WHILE (ALTRET)                                         */

   5857  6 001204   006562 710000 6                  TRA     IGNORE

      974     5858
      975     5859        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:154  
      976     5860         /* Simulate CONTROL-Y event                                                  */
      977     5861    4            CASE (6 /* KEY_CY# */);

      978     5862
      979     5863    4               IF OC_CONSOLE.SYSID(INDEX_) ~= 0

   5863  6 001205   200006 236100                    LDQ     INDEX_,,AUTO
         6 001206   000076 402007                    MPY     62,DL
         6 001207   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001210   000012 721106                    LXL1    10,QL,PR0
         6 001211   001220 600000 6                  TZE     s:5870

      980     5864    4               THEN
      981     5865    5               DO;

      982     5866    5                  CONTROLY_GHOST.V.USER# = OC_CONSOLE.SYSID(INDEX_);

   5866  6 001212   001004 741000 2                  STX1    CONTROLY_GHOST+2

      983     5867    5                  CALL M$RUE (CONTROLY_GHOST) ALTRET (NO_CY);

   5867  6 001213   001002 630400 2                  EPPR0   CONTROLY_GHOST
         6 001214   420020 713400                    CLIMB   alt,+8208
         6 001215   400000 401760                    pmme    nvectors=1
         6 001216   001225 702000 6                  TSX2    NO_CY

      984     5868    5               END;

   5868  6 001217   001224 710000 6                  TRA     s:5872

      985     5869    4               ELSE
      986     5870    4               CALL WRITE_ERR(12);

   5870  6 001220   000055 236000 7                  LDQ     45
         6 001221   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001222   006570 701000 6                  TSX1    WRITE_ERR
         6 001223   000000 011000                    NOP     0
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:155  

      987     5871
      988     5872    5               DO WHILE ('0'B /*FALSE#*/);

   5872  6 001224   006562 710000 6                  TRA     IGNORE

   5869  6 001225                       NO_CY        null
      989     5873    5   NO_CY:         ;
      990     5874    5                  CALL WRITE_ERR(10);

   5874  6 001225   000057 236000 7                  LDQ     47
         6 001226   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001227   006570 701000 6                  TSX1    WRITE_ERR
         6 001230   000000 011000                    NOP     0

      991     5875    5               END; /* DO WHILE (ALTRET)                                         */

   5875  6 001231   006562 710000 6                  TRA     IGNORE

      992     5876        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:156  
      993     5877    4            CASE (7 /* KEY_ESCF# */);

      994     5878    4               IF OC_CONSOLE.SYSID(INDEX_) ~= 0

   5878  6 001232   200006 236100                    LDQ     INDEX_,,AUTO
         6 001233   000076 402007                    MPY     62,DL
         6 001234   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001235   000012 721106                    LXL1    10,QL,PR0
         6 001236   001256 600000 6                  TZE     s:5887

      995     5879    4               THEN
      996     5880    5               DO;

      997     5881    5                  GHST_TEMPLAT.CADDR = BITBIN(OC_CADDR);

   5881  6 001237   000000 236000 xsym               LDQ     OC_CADDR
         6 001240   000022 772000                    QRL     18
         6 001241   000000 621006                    EAX1    0,QL
         6 001242   000007 441000 2                  SXL1    GHST_TEMPLAT+1

      998     5882    5                  GHST_TEMPLAT.SYSID = OC_CONSOLE.SYSID(INDEX_);

   5882  6 001243   200006 236100                    LDQ     INDEX_,,AUTO
         6 001244   000076 402007                    MPY     62,DL
         6 001245   000012 722106                    LXL2    10,QL,PR0
         6 001246   000007 742000 2                  STX2    GHST_TEMPLAT+1

      999     5883    5                  STA.STATION# = GHST_TEMPLATC;

   5883  6 001247   000006 237000 2                  LDAQ    GHST_TEMPLAT
         6 001250   000452 757000 2                  STAQ    STA

     1000     5884    5                  CALL M$ACTIVATE (END_O_FILE) ALTRET (NO_EOF);

   5884  6 001251   000020 630400 4                  EPPR0   END_O_FILE
         6 001252   500000 713400                    CLIMB   alt,+32768
         6 001253   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:157  
         6 001254   001263 702000 6                  TSX2    NO_EOF

     1001     5885    5               END; /* DO IF SYSID ASSOCIATED                                    */

   5885  6 001255   001262 710000 6                  TRA     s:5889

     1002     5886    4               ELSE
     1003     5887    4               CALL WRITE_ERR(12);

   5887  6 001256   000055 236000 7                  LDQ     45
         6 001257   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001260   006570 701000 6                  TSX1    WRITE_ERR
         6 001261   000000 011000                    NOP     0

     1004     5888
     1005     5889    5               DO WHILE ('0'B /*FALSE#*/);

   5889  6 001262   006562 710000 6                  TRA     IGNORE

   5886  6 001263                       NO_EOF       null
     1006     5890    5   NO_EOF:        ;
     1007     5891    5                  CALL WRITE_ERR(9);

   5891  6 001263   000060 236000 7                  LDQ     48
         6 001264   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001265   006570 701000 6                  TSX1    WRITE_ERR
         6 001266   000000 011000                    NOP     0

     1008     5892    5               END; /* DO WHILE (ALTRET)                                         */

   5892  6 001267   006562 710000 6                  TRA     IGNORE

     1009     5893        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:158  
     1010     5894         /* Request UPSHIFT function                                                  */
     1011     5895    4            CASE (8 /* KEY_UCON# */);

     1012     5896    4               IF OC_CONSOLE.SHIFT(INDEX_)

   5896  6 001270   200006 236100                    LDQ     INDEX_,,AUTO
         6 001271   000076 402007                    MPY     62,DL
         6 001272   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001273   000017 236106                    LDQ     15,QL,PR0
         6 001274   100000 316007                    CANQ    32768,DL
         6 001275   001303 600000 6                  TZE     s:5901

     1013     5897    4               THEN
     1014     5898    4               CALL WRITE_ERR(8);

   5898  6 001276   000061 236000 7                  LDQ     49
         6 001277   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001300   006570 701000 6                  TSX1    WRITE_ERR
         6 001301   000000 011000                    NOP     0
         6 001302   006562 710000 6                  TRA     IGNORE

     1015     5899    4               ELSE
     1016     5900    5               DO;

     1017     5901    5                  OC_CONSOLE.SHIFT(INDEX_) = '1'B /*TRUE#*/;

   5901  6 001303   200006 236100                    LDQ     INDEX_,,AUTO
         6 001304   000076 402007                    MPY     62,DL
         6 001305   000000 621006                    EAX1    0,QL
         6 001306   100000 236007                    LDQ     32768,DL
         6 001307   000017 256111                    ORSQ    15,X1,PR0

     1018     5902    5                  CALL WRITE_ERR(7);

   5902  6 001310   000062 236000 7                  LDQ     50
         6 001311   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001312   006570 701000 6                  TSX1    WRITE_ERR
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:159  
         6 001313   000000 011000                    NOP     0

     1019     5903    5               END;

   5903  6 001314   006562 710000 6                  TRA     IGNORE

     1020     5904        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:160  
     1021     5905         /* Request UPSHIFT deactivation                                              */
     1022     5906
     1023     5907    4            CASE (9 /* KEY_UCOFF */);

     1024     5908
     1025     5909    4               IF OC_CONSOLE.SHIFT(INDEX_)

   5909  6 001315   200006 236100                    LDQ     INDEX_,,AUTO
         6 001316   000076 402007                    MPY     62,DL
         6 001317   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001320   000017 236106                    LDQ     15,QL,PR0
         6 001321   100000 316007                    CANQ    32768,DL
         6 001322   001335 600000 6                  TZE     s:5916

     1026     5910    4               THEN
     1027     5911    5               DO;

     1028     5912    5                  OC_CONSOLE.SHIFT(INDEX_) = '0'B /*FALSE#*/;

   5912  6 001323   200006 236100                    LDQ     INDEX_,,AUTO
         6 001324   000076 402007                    MPY     62,DL
         6 001325   000000 621006                    EAX1    0,QL
         6 001326   000063 236000 7                  LDQ     51
         6 001327   000017 356111                    ANSQ    15,X1,PR0

     1029     5913    5                  CALL WRITE_ERR(5);

   5913  6 001330   000064 236000 7                  LDQ     52
         6 001331   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001332   006570 701000 6                  TSX1    WRITE_ERR
         6 001333   000000 011000                    NOP     0

     1030     5914    5               END;

   5914  6 001334   006562 710000 6                  TRA     IGNORE

     1031     5915    4               ELSE
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:161  
     1032     5916    4               CALL WRITE_ERR(6);

   5916  6 001335   000065 236000 7                  LDQ     53
         6 001336   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 001337   006570 701000 6                  TSX1    WRITE_ERR
         6 001340   000000 011000                    NOP     0
         6 001341   006562 710000 6                  TRA     IGNORE

     1033     5917        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:162  
     1034     5918         /* Request PENDING READS list                                                */
     1035     5919
     1036     5920    4            CASE (10 /* KEY_PEND# */);

     1037     5921
     1038     5922    4               NOT_FOUND = '1'B /*TRUE#*/;

   5922  6 001342   400000 236003                    LDQ     -131072,DU
         6 001343   000011 756000 2                  STQ     NOT_FOUND

     1039     5923    4               IF OC_CONSOLE.GHSTRD(INDEX_)

   5923  6 001344   200006 236100                    LDQ     INDEX_,,AUTO
         6 001345   000076 402007                    MPY     62,DL
         6 001346   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001347   000017 236106                    LDQ     15,QL,PR0
         6 001350   200000 316007                    CANQ    65536,DL
         6 001351   001433 600000 6                  TZE     s:5944

     1040     5924    4               THEN
     1041     5925    5               DO;

     1042     5926    6                  DO I = 0 TO 2;

   5926  6 001352   000000 450000 2                  STZ     I

     1043     5927    6                     IF ADDR(OC_CONSOLE.PROMPTS(INDEX_))->

   5927  6 001353   000000 236000 2                  LDQ     I
         6 001354   000042 402007                    MPY     34,DL
         6 001355   200612 756100                    STQ     @MCOUNT+2,,AUTO
         6 001356   200006 236100                    LDQ     INDEX_,,AUTO
         6 001357   000370 402007                    MPY     248,DL
         6 001360   200612 036100                    ADLQ    @MCOUNT+2,,AUTO
         6 001361   000011 402007                    MPY     9,DL
         6 001362   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001363   000000 066506                    CMPB    filb='0'B
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:163  
         6 001364   000022 000001                    BDSC    18,Q,PR0                 by=0,bit=0,n=1
         6 001365   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 001366   001426 600000 6                  TZE     s:5941

     1044     5928    6                       PROMPT_TABLE.LAST_READ(I)
     1045     5929    6                     THEN
     1046     5930    7                     DO;

     1047     5931    7                        GHST_READC.COUNT_ =

   5931  6 001367   000000 236000 2                  LDQ     I
         6 001370   000042 402007                    MPY     34,DL
         6 001371   200612 756100                    STQ     @MCOUNT+2,,AUTO
         6 001372   200006 236100                    LDQ     INDEX_,,AUTO
         6 001373   000370 402007                    MPY     248,DL
         6 001374   200612 036100                    ADLQ    @MCOUNT+2,,AUTO
         6 001375   000000 100506                    MLR     fill='000'O
         6 001376   000032 000002                    ADSC9   26,Q,PR0                 cn=0,n=2
         6 001377   000061 000002 2                  ADSC9   GHST_READC               cn=0,n=2

     1048     5932    7                          ADDR(OC_CONSOLE.PROMPTS(INDEX_))->
     1049     5933    7                          PROMPT_TABLE.SIZER(I);
     1050     5934    7                        NP# = 1;

   5934  6 001400   001000 236003                    LDQ     512,DU
         6 001401   000311 756000 2                  STQ     NP#

     1051     5935    7                        MSG# = 503 /* OGRD_MSG# */;

   5935  6 001402   000767 220003                    LDX0    503,DU
         6 001403   000310 740000 2                  STX0    MSG#

     1052     5936    7                        CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   5936  6 001404   000000 235000 2                  LDA     I
         6 001405   000001 035007                    ADLA    1,DL
         6 001406   200612 755100                    STA     @MCOUNT+2,,AUTO
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:164  
         6 001407   200612 631500                    EPPR1   @MCOUNT+2,,AUTO
         6 001410   200623 451500                    STP1    @MCOUNT+11,,AUTO
         6 001411   000010 236000 7                  LDQ     8
         6 001412   200622 756100                    STQ     @MCOUNT+10,,AUTO
         6 001413   000066 237000 7                  LDAQ    54
         6 001414   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 001415   000070 237000 7                  LDAQ    56
         6 001416   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 001417   000014 237000 7                  LDAQ    12
         6 001420   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 001421   200614 630500                    EPPR0   @MCOUNT+4,,AUTO
         6 001422   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 001423   000000 701000 xent               TSX1    OCO$IWRITE
         6 001424   000000 011000                    NOP     0

     1053     5937    7                          GHST_READB, GHST_READC, 0, OCP_NON_STA,
     1054     5938    7                          I+1);
     1055     5939    7                        NOT_FOUND = '0'B /*FALSE#*/;

   5939  6 001425   000011 450000 2                  STZ     NOT_FOUND

     1056     5940    7                     END; /* IF FOUND                                            */

     1057     5941    6                  END; /* DO I                                                   */

   5941  6 001426   000000 235000 2                  LDA     I
         6 001427   000001 035007                    ADLA    1,DL
         6 001430   000000 755000 2                  STA     I
         6 001431   000003 115007                    CMPA    3,DL
         6 001432   001353 602000 6                  TNC     s:5927

     1058     5942    5               END; /* IF GHSTRD                                                 */

     1059     5943
     1060     5944    4               NEXT$ = OCP_USED_HEAD$;

   5944  6 001433   000000 236000 xsym               LDQ     OCP_USED_HEAD
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:165  
         6 001434   000004 756000 2                  STQ     NEXT$

     1061     5945    4               MSG# = 501 /* RD_MSG# */;

   5945  6 001435   000765 220003                    LDX0    501,DU
         6 001436   000310 740000 2                  STX0    MSG#

     1062     5946    4               NP# = 3;

   5946  6 001437   003000 236003                    LDQ     1536,DU
         6 001440   000311 756000 2                  STQ     NP#

     1063     5947
     1064     5948    5               DO WHILE (NEXT$ ~= ADDR(NIL));

   5948  6 001441   001572 710000 6                  TRA     s:6022

     1065     5949
     1066     5950         /* If direct addressed, check
     1067     5951              against direct addr of request
     1068     5952              console, if attr addressed
     1069     5953              make exhaustive check                                                   */
     1070     5954
     1071     5955    5                  IF NEXT$ -> OC$PEND.CADDR = OC_CADDR

   5955  6 001442   000004 470400 2                  LDP0    NEXT$
         6 001443   000002 220100                    LDX0    2,,PR0
         6 001444   000000 100000 xsym               CMPX0   OC_CADDR
         6 001445   001514 600000 6                  TZE     PRO_CEED

     1072     5956    5                  THEN
     1073     5957    5                  GOTO PRO_CEED;
     1074     5958
     1075     5959    5                  ELSE
     1076     5960    6                  DO;

     1077     5961
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:166  
     1078     5962    6                     CALL INDEX (I, '?', OC_CONSOLE.WSN(INDEX_));

   5962  6 001446   200006 236100                    LDQ     INDEX_,,AUTO
         6 001447   000370 402007                    MPY     248,DL
         6 001450   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 001451   000000 124506                    SCM     mask='000'O
         6 001452   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=8
         6 001453   000040 000001 7                  ADSC9   32                       cn=0,n=1
         6 001454   000000 000000 2                  ARG     I

     1079     5963
     1080     5964    6                     IF OC_CONSOLE.ATTR(INDEX_) & '200000'O /* M_SYS  */

   5964  6 001455   200006 236100                    LDQ     INDEX_,,AUTO
         6 001456   000076 402007                    MPY     62,DL
         6 001457   100013 221106                    LDX1    11,QL,PR1
         6 001460   200000 361003                    ANX1    65536,DU
         6 001461   001514 601000 6                  TNZ     PRO_CEED

     1081     5965    6                     THEN
     1082     5966    6                     GOTO PRO_CEED;
     1083     5967
     1084     5968    6                     CADDR = (NEXT$ -> OC$PEND.CADDR) &

   5968  6 001462   100013 360106                    ANX0    11,QL,PR1
         6 001463   000012 740000 2                  STX0    CADDR

     1085     5969    6                       OC_CONSOLE.ATTR(INDEX_);
     1086     5970
     1087     5971    6                     IF CADDR & '004000'O /* M_COMM */

   5971  6 001464   004000 360003                    ANX0    2048,DU
         6 001465   001514 601000 6                  TNZ     PRO_CEED

     1088     5972    6                     THEN
     1089     5973    6                     GOTO PRO_CEED;
     1090     5974
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:167  
     1091     5975    6                     IF CADDR & '040000'O /* M_ADMIN */

   5975  6 001466   000012 220000 2                  LDX0    CADDR
         6 001467   040000 360003                    ANX0    16384,DU
         6 001470   001503 600000 6                  TZE     s:5984
         6 001471   100013 220106                    LDX0    11,QL,PR1
         6 001472   040000 360003                    ANX0    16384,DU
         6 001473   001503 600000 6                  TZE     s:5984
         6 001474   200006 236100                    LDQ     INDEX_,,AUTO
         6 001475   000370 402007                    MPY     248,DL
         6 001476   000000 720000 2                  LXL0    I
         6 001477   040140 106546                    CMPC    fill='040'O
         6 001500   100004 000010                    ADSC9   4,Q,PR1                  cn=0,n=*X0
         6 001501   000006 000010                    ADSC9   6,,PR0                   cn=0,n=*X0
         6 001502   001514 600000 6                  TZE     PRO_CEED

     1092     5976    6                       AND
     1093     5977    6                       OC_CONSOLE.ATTR_INPUT(INDEX_) & '040000'O /* K_ADMIN */
     1094     5978    6                       AND
     1095     5979    6                       SUBSTR(OC_CONSOLE.WSN(INDEX_), 0, I) =
     1096     5980    6                       SUBSTR(NEXT$ -> OC$PEND.WSN, 0, I)
     1097     5981    6                     THEN
     1098     5982    6                     GOTO PRO_CEED;
     1099     5983
     1100     5984    6                     IF CADDR & '100000'O /* M_DEVC  */

   5984  6 001503   000012 220000 2                  LDX0    CADDR
         6 001504   100000 360003                    ANX0    32768,DU
         6 001505   001513 600000 6                  TZE     s:5993
         6 001506   200006 236100                    LDQ     INDEX_,,AUTO
         6 001507   000076 402007                    MPY     62,DL
         6 001510   100001 236106                    LDQ     1,QL,PR1
         6 001511   000007 116100                    CMPQ    7,,PR0
         6 001512   001514 600000 6                  TZE     PRO_CEED

     1101     5985    6                       AND
     1102     5986    6                       NEXT$ -> OC$PEND.DEV.TWSN =
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:168  
     1103     5987    6                       OC_CONSOLE.STATIONR.SECND_HALF(INDEX_)
     1104     5988    6                     THEN
     1105     5989    6                     GOTO PRO_CEED;
     1106     5990
     1107     5991    6                  END; /* DO IF ATTR ADDRESSED                                   */

     1108     5992
     1109     5993    6                  DO WHILE ('0'B /*FALSE#*/);
              5993                           /* Loop to handle found reads               */

   5993  6 001513   001567 710000 6                  TRA     s:6020

   5984  6 001514                       PRO_CEED     null
     1110     5994
     1111     5995    6   PRO_CEED:         ;
     1112     5996
     1113     5997    6                     IF NEXT$ -> OC$PEND.SIZEB_MSG ~= 0

   5997  6 001514   000001 720100                    LXL0    1,,PR0
         6 001515   001542 600000 6                  TZE     s:6011

     1114     5998    6                     THEN
     1115     5999    7                     DO;

     1116     6000    7                        MSG# = 385 /* PENDMSG_MSG# */;

   6000  6 001516   000601 221003                    LDX1    385,DU
         6 001517   000310 741000 2                  STX1    MSG#

     1117     6001    7                        WORD_ = NEXT$ -> OC$PEND.SIZEB_MSG;

   6001  6 001520   000001 236100                    LDQ     1,,PR0
         6 001521   777777 376007                    ANQ     -1,DL
         6 001522   000015 756000 2                  STQ     WORD_

     1118     6002    7                        CALL OCW$WRITE (

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:169  
   6002  6 001523   000072 236000 7                  LDQ     58
         6 001524   200616 756100                    STQ     @MCOUNT+6,,AUTO
         6 001525   000074 237000 7                  LDAQ    60
         6 001526   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 001527   000076 236000 7                  LDQ     62
         6 001530   200613 756100                    STQ     @MCOUNT+3,,AUTO
         6 001531   000004 236000 2                  LDQ     NEXT$
         6 001532   000012 036003                    ADLQ    10,DU
         6 001533   200612 756100                    STQ     @MCOUNT+2,,AUTO
         6 001534   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 001535   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 001536   000000 701000 xent               TSX1    OCW$WRITE
         6 001537   000000 011000                    NOP     0

     1119     6003    7                          NEXT$ -> OC$PEND.MESSAGE,
     1120     6004    7                          WORD_,
     1121     6005    7                          OC_CADDR,
     1122     6006    7                          OCP_NON_STA,
     1123     6007    7                          ADDR (ADDR(NEXT$) -> OC$PEND.MESSAGE)
     1124     6008    7                          -> OC$MESSHD.MSG#);
     1125     6009    7                        MSG# = 501 /* RD_MSG# */;

   6009  6 001540   000765 220003                    LDX0    501,DU
         6 001541   000310 740000 2                  STX0    MSG#

     1126     6010    7                     END;

     1127     6011    6                     REGULAR_READC.SIZER = NEXT$ -> OC$PEND.SIZER;

   6011  6 001542   000004 470400 2                  LDP0    NEXT$
         6 001543   000002 720100                    LXL0    2,,PR0
         6 001544   000055 440000 2                  SXL0    REGULAR_READC

     1128     6012    6                     REGULAR_READC.ACCT = NEXT$ -> OC$PEND.ACCN;

   6012  6 001545   040000 100500                    MLR     fill='040'O
         6 001546   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:170  
         6 001547   000056 000010 2                  ADSC9   REGULAR_READC+1          cn=0,n=8

     1129     6013    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   6013  6 001550   000010 237000 7                  LDAQ    8
         6 001551   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 001552   000004 236000 2                  LDQ     NEXT$
         6 001553   000077 036000 7                  ADLQ    63
         6 001554   000100 235000 7                  LDA     64
         6 001555   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 001556   000102 237000 7                  LDAQ    66
         6 001557   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 001560   000014 237000 7                  LDAQ    12
         6 001561   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 001562   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 001563   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 001564   000000 701000 xent               TSX1    OCO$IWRITE
         6 001565   000000 011000                    NOP     0

     1130     6014    6                       REGULAR_READB, REGULAR_READC,
     1131     6015    6                       NEXT$ -> OC$PEND.SYSID,
     1132     6016    6                       OCP_NON_STA, 0);
     1133     6017    6                     NOT_FOUND = '0'B /*FALSE#*/;

   6017  6 001566   000011 450000 2                  STZ     NOT_FOUND

     1134     6018    6                  END; /* DO  WHILE found                                        */

     1135     6019
     1136     6020    5                  NEXT$ = NEXT$ -> OC$PEND.LINK$;

   6020  6 001567   000004 470400 2                  LDP0    NEXT$
         6 001570   000000 236100                    LDQ     0,,PR0
         6 001571   000004 756000 2                  STQ     NEXT$

     1137     6021
     1138     6022    5               END; /* DO WHILE MORE                                             */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:171  

   6022  6 001572   000004 236000 2                  LDQ     NEXT$
         6 001573   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 001574   001442 601000 6                  TNZ     s:5955

     1139     6023
     1140     6024         /* Handle the case of "none to
     1141     6025              speak of "                                                              */
     1142     6026    4               IF NOT_FOUND

   6026  6 001575   000011 234000 2                  SZN     NOT_FOUND
         6 001576   006562 605000 6                  TPL     IGNORE

     1143     6027    4               THEN
     1144     6028    5               DO;

     1145     6029    5                  MSG# = 395 /* NO_PEND_MSG# */;

   6029  6 001577   000613 220003                    LDX0    395,DU
         6 001600   000310 740000 2                  STX0    MSG#

     1146     6030    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, 0,0,0,0,

   6030  6 001601   000104 630400 7                  EPPR0   68
         6 001602   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 001603   000000 701000 xent               TSX1    OCO$IWRITE
         6 001604   000000 011000                    NOP     0

     1147     6031    5                    OCP_NON_STA,0);
     1148     6032    5               END; /* DO IF none found                                          */

   6032  6 001605   006562 710000 6                  TRA     IGNORE

     1149     6033
     1150     6034        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:172  
     1151     6035
     1152     6036         /* Process HELP request                                                      */
     1153     6037
     1154     6038    4            CASE (12 /* KEY_HELP# */);

     1155     6039
     1156     6040    4               OC_CONSOLE.VLR_HELP (INDEX_) = '0'B;

   6040  6 001606   200006 236100                    LDQ     INDEX_,,AUTO
         6 001607   000370 402007                    MPY     248,DL
         6 001610   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 001611   000106 100400                    MLR     fill='000'O
         6 001612   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         6 001613   000054 000070                    ADSC9   44,Q,PR0                 cn=0,n=56

     1157     6041    4               OCN_HELP.V.LIST# = '0'B;

   6041  6 001614   000114 236000 7                  LDQ     76
         6 001615   001107 356000 2                  ANSQ    OCN_HELP+19

     1158     6042    4               OCN_HELP.V.ALL# = '0'B;

   6042  6 001616   000115 236000 7                  LDQ     77
         6 001617   001107 356000 2                  ANSQ    OCN_HELP+19

     1159     6043    4               OCN_HELP.V.MORE# = '0'B;

   6043  6 001620   000116 236000 7                  LDQ     78
         6 001621   001107 356000 2                  ANSQ    OCN_HELP+19

     1160     6044    4               OCN_HELP.V.RANGE# = '0'B;

   6044  6 001622   000117 236000 7                  LDQ     79
         6 001623   001107 356000 2                  ANSQ    OCN_HELP+19

     1161     6045    4               OCN_HELP.RESULTS_ = VECTOR (OC_CONSOLE.VLR_HELP (INDEX_));

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:173  
   6045  6 001624   000120 235000 7                  LDA     80
         6 001625   200006 236100                    LDQ     INDEX_,,AUTO
         6 001626   200612 755100                    STA     @MCOUNT+2,,AUTO
         6 001627   000076 402003                    MPY     62,DU
         6 001630   000054 036003                    ADLQ    44,DU
         6 001631   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 001632   200612 235100                    LDA     @MCOUNT+2,,AUTO
         6 001633   001102 757000 2                  STAQ    OCN_HELP+14

     1162     6046    4               OCN_HELP.V.LANG# = B$JIT$ -> B$JIT.LANG;

   6046  6 001634   000000 470400 xsym               LDP0    B$JIT$
         6 001635   000145 236100                    LDQ     101,,PR0
         6 001636   000033 736000                    QLS     27
         6 001637   001107 552040 2                  STBQ    OCN_HELP+19,'40'O

     1163     6047    4               MSG# = 393 /* HELP_MSG# */;

   6047  6 001640   000611 220003                    LDX0    393,DU
         6 001641   000310 740000 2                  STX0    MSG#

     1164     6048    4               NP# = 3;

   6048  6 001642   003000 236003                    LDQ     1536,DU
         6 001643   000311 756000 2                  STQ     NP#

     1165     6049    4               HELP_MSGB.CODE = 0;

   6049  6 001644   000000 236003                    LDQ     0,DU
         6 001645   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1166     6050    4               IF OC_PARAM$->OC$HELP1.DASH = 1

   6050  6 001646   000000 471400 xsym               LDP1    OC_PARAM$
         6 001647   000100 101500                    MRL     fill='000'O
         6 001650   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 001651   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:174  
         6 001652   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 001653   000001 116007                    CMPQ    1,DL
         6 001654   001705 600000 6                  TZE     s:6057
         6 001655   000100 101500                    MRL     fill='000'O
         6 001656   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 001657   200613 000004                    ADSC9   @MCOUNT+3,,AUTO          cn=0,n=4
         6 001660   200613 236100                    LDQ     @MCOUNT+3,,AUTO
         6 001661   000003 116007                    CMPQ    3,DL
         6 001662   001705 600000 6                  TZE     s:6057
         6 001663   000100 101500                    MRL     fill='000'O
         6 001664   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 001665   200614 000004                    ADSC9   @MCOUNT+4,,AUTO          cn=0,n=4
         6 001666   200614 236100                    LDQ     @MCOUNT+4,,AUTO
         6 001667   000005 116007                    CMPQ    5,DL
         6 001670   001705 600000 6                  TZE     s:6057
         6 001671   000100 101500                    MRL     fill='000'O
         6 001672   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 001673   200615 000004                    ADSC9   @MCOUNT+5,,AUTO          cn=0,n=4
         6 001674   200615 236100                    LDQ     @MCOUNT+5,,AUTO
         6 001675   000007 116007                    CMPQ    7,DL
         6 001676   001705 600000 6                  TZE     s:6057
         6 001677   000100 101500                    MRL     fill='000'O
         6 001700   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 001701   200616 000004                    ADSC9   @MCOUNT+6,,AUTO          cn=0,n=4
         6 001702   200616 236100                    LDQ     @MCOUNT+6,,AUTO
         6 001703   000011 116007                    CMPQ    9,DL
         6 001704   001735 601000 6                  TNZ     s:6064

     1167     6051    4                 OR OC_PARAM$->OC$HELP1.DASH = 3
     1168     6052    4                 OR OC_PARAM$->OC$HELP1.DASH = 5
     1169     6053    4                 OR OC_PARAM$->OC$HELP1.DASH = 7
     1170     6054    4                 OR OC_PARAM$->OC$HELP1.DASH = 9
     1171     6055    4               THEN
     1172     6056    5               DO;

     1173     6057    5                  HELP_FLAG = '1'B;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:175  
   6057  6 001705   400000 236003                    LDQ     -131072,DU
         6 001706   000005 756000 2                  STQ     HELP_FLAG

     1174     6058    5                  H1_PTR$ = PINCRC(ADDR(OC_PARAM$->OC$HELP1.DASH),1);

   6058  6 001707   000000 236000 xsym               LDQ     OC_PARAM$
         6 001710   000121 036000 7                  ADLQ    81
         6 001711   200012 756100                    STQ     H1_PTR$,,AUTO

     1175     6059    5                  H2_PTR$ = PINCRC(H1_PTR$, H1_PTR$->TEXT.CNT + 1);

   6059  6 001712   200012 473500                    LDP3    H1_PTR$,,AUTO
         6 001713   000100 101500                    MRL     fill='000'O
         6 001714   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 001715   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 001716   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 001717   000020 736000                    QLS     16
         6 001720   200000 036007                    ADLQ    65536,DL
         6 001721   200012 036100                    ADLQ    H1_PTR$,,AUTO
         6 001722   200013 756100                    STQ     H2_PTR$,,AUTO

     1176     6060    5                  H3_PTR$ = PINCRC(H2_PTR$, H2_PTR$->TEXT.CNT + 1);

   6060  6 001723   200013 474500                    LDP4    H2_PTR$,,AUTO
         6 001724   000100 101500                    MRL     fill='000'O
         6 001725   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 001726   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 001727   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 001730   000020 736000                    QLS     16
         6 001731   200000 036007                    ADLQ    65536,DL
         6 001732   200013 036100                    ADLQ    H2_PTR$,,AUTO
         6 001733   200014 756100                    STQ     H3_PTR$,,AUTO

     1177     6061    5               END;

   6061  6 001734   001752 710000 6                  TRA     s:6069

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:176  
     1178     6062    4               ELSE
     1179     6063    5               DO;

     1180     6064    5                  HELP_FLAG = '0'B;

   6064  6 001735   000005 450000 2                  STZ     HELP_FLAG

     1181     6065    5                  H2_PTR$ = PINCRC(ADDR(OC_PARAM$->OC$HELP1.DASH),1);

   6065  6 001736   000000 236000 xsym               LDQ     OC_PARAM$
         6 001737   000121 036000 7                  ADLQ    81
         6 001740   200013 756100                    STQ     H2_PTR$,,AUTO

     1182     6066    5                  H3_PTR$ = PINCRC(H2_PTR$, H2_PTR$->TEXT.CNT + 1);

   6066  6 001741   200013 473500                    LDP3    H2_PTR$,,AUTO
         6 001742   000100 101500                    MRL     fill='000'O
         6 001743   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 001744   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 001745   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 001746   000020 736000                    QLS     16
         6 001747   200000 036007                    ADLQ    65536,DL
         6 001750   200013 036100                    ADLQ    H2_PTR$,,AUTO
         6 001751   200014 756100                    STQ     H3_PTR$,,AUTO

     1183     6067    5               END;

     1184     6068
     1185     6069    4               IF HELP_FLAG = '1'B

   6069  6 001752   000005 234000 2                  SZN     HELP_FLAG
         6 001753   002010 605000 6                  TPL     s:6082

     1186     6070    4               THEN
     1187     6071    5               DO;

     1188     6072    5                  IF H1_PTR$->TEXT.C ~= 'KEYIN'
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:177  

   6072  6 001754   200012 473500                    LDP3    H1_PTR$,,AUTO
         6 001755   000100 101500                    MRL     fill='000'O
         6 001756   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 001757   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 001760   200612 221100                    LDX1    @MCOUNT+2,,AUTO
         6 001761   040000 106540                    CMPC    fill='040'O
         6 001762   300000 200011                    ADSC9   0,,PR3                   cn=1,n=*X1
         6 001763   000056 000005 4                  ADSC9   GET_LADC_FLAG+14         cn=0,n=5
         6 001764   002010 600000 6                  TZE     s:6082

     1189     6073    5                  THEN
     1190     6074    6                  DO;

     1191     6075    6                     HELP_MSGB.CODE = 2;

   6075  6 001765   000002 236007                    LDQ     2,DL
         6 001766   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1192     6076    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6076  6 001767   000122 237000 7                  LDAQ    82
         6 001770   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 001771   200006 236100                    LDQ     INDEX_,,AUTO
         6 001772   000076 402003                    MPY     62,DU
         6 001773   000124 036000 7                  ADLQ    84
         6 001774   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 001775   000125 235000 7                  LDA     85
         6 001776   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 001777   000126 237000 7                  LDAQ    86
         6 002000   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002001   000014 237000 7                  LDAQ    12
         6 002002   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002003   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 002004   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002005   000000 701000 xent               TSX1    OCO$IWRITE
         6 002006   000000 011000                    NOP     0
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:178  

     1193     6077    6                       HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1194     6078    6                     RETURN;

   6078  6 002007   000000 702200 xent               TSX2  ! X66_ARET

     1195     6079    6                  END;
     1196     6080    5               END;
     1197     6081
     1198     6082    4               KEY1.L# = 0;

   6082  6 002010   000000 236003                    LDQ     0,DU
         6 002011   001130 552040 2                  STBQ    KEY1,'40'O

     1199     6083    4               IF H2_PTR$->TEXT.CNT ~= 0

   6083  6 002012   200013 473500                    LDP3    H2_PTR$,,AUTO
         6 002013   000100 101500                    MRL     fill='000'O
         6 002014   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 002015   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 002016   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 002017   000000 116003                    CMPQ    0,DU
         6 002020   002036 600000 6                  TZE     s:6092

     1200     6084    4               THEN
     1201     6085    5               DO;

     1202     6086    5                  KEY1.L# = H2_PTR$->TEXT.CNT;

   6086  6 002021   000000 100500                    MLR     fill='000'O
         6 002022   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         6 002023   001130 000001 2                  ADSC9   KEY1                     cn=0,n=1

     1203     6087    5                  KEY1.NAME# = SUBSTR (H2_PTR$->TEXT.C,

   6087  6 002024   000100 101500                    MRL     fill='000'O
         6 002025   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:179  
         6 002026   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 002027   200612 221100                    LDX1    @MCOUNT+2,,AUTO
         6 002030   001130 236000 2                  LDQ     KEY1
         6 002031   000033 772000                    QRL     27
         6 002032   000000 622006                    EAX2    0,QL
         6 002033   040000 100540                    MLR     fill='040'O
         6 002034   300000 200012                    ADSC9   0,,PR3                   cn=1,n=*X2
         6 002035   001130 200037 2                  ADSC9   KEY1                     cn=1,n=31

     1204     6088    5                    0,
     1205     6089    5                    KEY1.L#);
     1206     6090    5               END;

     1207     6091
     1208     6092    4               KEY2.L# = 0;

   6092  6 002036   000000 236003                    LDQ     0,DU
         6 002037   001140 552040 2                  STBQ    KEY2,'40'O

     1209     6093    4               IF H3_PTR$->TEXT.CNT ~= 0

   6093  6 002040   200014 474500                    LDP4    H3_PTR$,,AUTO
         6 002041   000100 101500                    MRL     fill='000'O
         6 002042   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 002043   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 002044   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 002045   000000 116003                    CMPQ    0,DU
         6 002046   002064 600000 6                  TZE     s:6102

     1210     6094    4               THEN
     1211     6095    5               DO;

     1212     6096    5                  KEY2.L# = H3_PTR$->TEXT.CNT;

   6096  6 002047   000000 100500                    MLR     fill='000'O
         6 002050   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 002051   001140 000001 2                  ADSC9   KEY2                     cn=0,n=1
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:180  

     1213     6097    5                  KEY2.NAME# = SUBSTR (H3_PTR$->TEXT.C,

   6097  6 002052   000100 101500                    MRL     fill='000'O
         6 002053   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         6 002054   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 002055   200612 221100                    LDX1    @MCOUNT+2,,AUTO
         6 002056   001140 236000 2                  LDQ     KEY2
         6 002057   000033 772000                    QRL     27
         6 002060   000000 622006                    EAX2    0,QL
         6 002061   040000 100540                    MLR     fill='040'O
         6 002062   400000 200012                    ADSC9   0,,PR4                   cn=1,n=*X2
         6 002063   001140 200037 2                  ADSC9   KEY2                     cn=1,n=31

     1214     6098    5                    0,
     1215     6099    5                    KEY2.L#);
     1216     6100    5               END;

     1217     6101
     1218     6102    4               IF OC_PARAM$->OC$HELP1.DASH = 1

   6102  6 002064   000100 101500                    MRL     fill='000'O
         6 002065   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002066   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 002067   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 002070   000001 116007                    CMPQ    1,DL
         6 002071   002114 600000 6                  TZE     s:6108
         6 002072   000100 101500                    MRL     fill='000'O
         6 002073   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002074   200613 000004                    ADSC9   @MCOUNT+3,,AUTO          cn=0,n=4
         6 002075   200613 236100                    LDQ     @MCOUNT+3,,AUTO
         6 002076   000002 116007                    CMPQ    2,DL
         6 002077   002114 600000 6                  TZE     s:6108
         6 002100   000100 101500                    MRL     fill='000'O
         6 002101   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002102   200614 000004                    ADSC9   @MCOUNT+4,,AUTO          cn=0,n=4
         6 002103   200614 236100                    LDQ     @MCOUNT+4,,AUTO
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:181  
         6 002104   000005 116007                    CMPQ    5,DL
         6 002105   002114 600000 6                  TZE     s:6108
         6 002106   000100 101500                    MRL     fill='000'O
         6 002107   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002110   200615 000004                    ADSC9   @MCOUNT+5,,AUTO          cn=0,n=4
         6 002111   200615 236100                    LDQ     @MCOUNT+5,,AUTO
         6 002112   000006 116007                    CMPQ    6,DL
         6 002113   002137 601000 6                  TNZ     s:6114

     1219     6103    4                 OR OC_PARAM$->OC$HELP1.DASH = 2
     1220     6104    4                 OR OC_PARAM$->OC$HELP1.DASH = 5
     1221     6105    4                 OR OC_PARAM$->OC$HELP1.DASH = 6
     1222     6106    4               THEN
     1223     6107    5               DO;

     1224     6108    5                  HELP_MSGB.CODE = 3;

   6108  6 002114   000003 236007                    LDQ     3,DL
         6 002115   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1225     6109    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6109  6 002116   000122 237000 7                  LDAQ    82
         6 002117   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 002120   200006 236100                    LDQ     INDEX_,,AUTO
         6 002121   000076 402003                    MPY     62,DU
         6 002122   000124 036000 7                  ADLQ    84
         6 002123   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002124   000125 235000 7                  LDA     85
         6 002125   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 002126   000126 237000 7                  LDAQ    86
         6 002127   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002130   000014 237000 7                  LDAQ    12
         6 002131   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002132   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 002133   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002134   000000 701000 xent               TSX1    OCO$IWRITE
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:182  
         6 002135   000000 011000                    NOP     0

     1226     6110    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1227     6111    5                  RETURN;

   6111  6 002136   000000 702200 xent               TSX2  ! X66_ARET

     1228     6112    5               END;
     1229     6113
     1230     6114    4               IF OC_PARAM$->OC$HELP1.DASH = 1

   6114  6 002137   000100 101500                    MRL     fill='000'O
         6 002140   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002141   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 002142   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 002143   000001 116007                    CMPQ    1,DL
         6 002144   002167 600000 6                  TZE     s:6120
         6 002145   000100 101500                    MRL     fill='000'O
         6 002146   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002147   200613 000004                    ADSC9   @MCOUNT+3,,AUTO          cn=0,n=4
         6 002150   200613 236100                    LDQ     @MCOUNT+3,,AUTO
         6 002151   000002 116007                    CMPQ    2,DL
         6 002152   002167 600000 6                  TZE     s:6120
         6 002153   000100 101500                    MRL     fill='000'O
         6 002154   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002155   200614 000004                    ADSC9   @MCOUNT+4,,AUTO          cn=0,n=4
         6 002156   200614 236100                    LDQ     @MCOUNT+4,,AUTO
         6 002157   000003 116007                    CMPQ    3,DL
         6 002160   002167 600000 6                  TZE     s:6120
         6 002161   000100 101500                    MRL     fill='000'O
         6 002162   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002163   200615 000004                    ADSC9   @MCOUNT+5,,AUTO          cn=0,n=4
         6 002164   200615 236100                    LDQ     @MCOUNT+5,,AUTO
         6 002165   000004 116007                    CMPQ    4,DL
         6 002166   002171 601000 6                  TNZ     s:6123

     1231     6115    4                 OR OC_PARAM$->OC$HELP1.DASH = 2
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:183  
     1232     6116    4                 OR OC_PARAM$->OC$HELP1.DASH = 3
     1233     6117    4                 OR OC_PARAM$->OC$HELP1.DASH = 4
     1234     6118    4               THEN
     1235     6119    5               DO;

     1236     6120    5                  OCN_HELP.V.LIST# = '1'B;

   6120  6 002167   000010 236007                    LDQ     8,DL
         6 002170   001107 256000 2                  ORSQ    OCN_HELP+19

     1237     6121    5               END;

     1238     6122
     1239     6123    4               IF OC_PARAM$->OC$HELP1.DASH = 0

   6123  6 002171   000100 101500                    MRL     fill='000'O
         6 002172   100001 000001                    ADSC9   1,,PR1                   cn=0,n=1
         6 002173   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 002174   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 002175   000000 116003                    CMPQ    0,DU
         6 002176   002206 601000 6                  TNZ     s:6133

     1240     6124    4               THEN
     1241     6125    5               DO;

     1242     6126    5                  KEY1.L# = 0;

   6126  6 002177   000000 236003                    LDQ     0,DU
         6 002200   001130 552040 2                  STBQ    KEY1,'40'O

     1243     6127    5                  KEY2.L# = 0;

   6127  6 002201   001140 552040 2                  STBQ    KEY2,'40'O

     1244     6128    5                  OCN_HELP.V.LIST# = '0'B;

   6128  6 002202   000114 236000 7                  LDQ     76
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:184  
         6 002203   001107 356000 2                  ANSQ    OCN_HELP+19

     1245     6129    5                  OCN_HELP.V.RANGE# = '0'B;

   6129  6 002204   000117 236000 7                  LDQ     79
         6 002205   001107 356000 2                  ANSQ    OCN_HELP+19

     1246     6130    5               END;

     1247     6131
     1248     6132
     1249     6133    4               VLP_HELP_RESULTS.PTR$ = ADDR(NIL);

   6133  6 002206   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002207   001121 756000 2                  STQ     VLP_HELP_RESULTS+1

     1250     6134    4               CALL M$GDS (GDS_HELP_BUF)

   6134  6 002210   001112 630400 2                  EPPR0   GDS_HELP_BUF
         6 002211   430001 713400                    CLIMB   alt,gds
         6 002212   400400 401760                    pmme    nvectors=2
         6 002213   002215 702000 6                  TSX2    s:6136
         6 002214   002240 710000 6                  TRA     s:6142

     1251     6135    5               WHENALTRETURN DO;

     1252     6136    5                  HELP_MSGB.CODE = 4;

   6136  6 002215   000004 236007                    LDQ     4,DL
         6 002216   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1253     6137    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6137  6 002217   000122 237000 7                  LDAQ    82
         6 002220   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 002221   200006 236100                    LDQ     INDEX_,,AUTO
         6 002222   000076 402003                    MPY     62,DU
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:185  
         6 002223   000124 036000 7                  ADLQ    84
         6 002224   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002225   000125 235000 7                  LDA     85
         6 002226   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 002227   000126 237000 7                  LDAQ    86
         6 002230   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002231   000014 237000 7                  LDAQ    12
         6 002232   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002233   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 002234   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002235   000000 701000 xent               TSX1    OCO$IWRITE
         6 002236   000000 011000                    NOP     0

     1254     6138    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1255     6139    5                  RETURN;

   6139  6 002237   000000 702200 xent               TSX2  ! X66_ARET

     1256     6140    5               END;
     1257     6141
     1258     6142    4               OCN_HELP.BUF_ = VLP_HELP_RESULTS;

   6142  6 002240   001120 237000 2                  LDAQ    VLP_HELP_RESULTS
         6 002241   001072 757000 2                  STAQ    OCN_HELP+6

     1259     6143
     1260     6144    4               CALL M$HELP (OCN_HELP) ALTRET (NO_HELP);

   6144  6 002242   001064 630400 2                  EPPR0   OCN_HELP
         6 002243   420024 713400                    CLIMB   alt,+8212
         6 002244   404000 401760                    pmme    nvectors=9
         6 002245   002317 702000 6                  TSX2    NO_HELP

     1261     6145
     1262     6146    4               IF OC_CONSOLE.VLR_HELP.RECCNT(INDEX_) > 0

   6146  6 002246   200006 236100                    LDQ     INDEX_,,AUTO
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:186  
         6 002247   000076 402007                    MPY     62,DL
         6 002250   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002251   000055 720106                    LXL0    45,QL,PR0
         6 002252   002317 600000 6                  TZE     NO_HELP

     1263     6147    4               THEN
     1264     6148    5               DO HELP_INDEX = 0 TO (OC_CONSOLE.VLR_HELP.RECCNT (INDEX_) - 1);

   6148  6 002253   000013 450000 2                  STZ     HELP_INDEX
         6 002254   002306 710000 6                  TRA     s:6152+3

     1265     6149    5                 HELP_MSGB.HMSG = VLP_HELP_RESULTS.PTR$->HELP_OUTPUT.LINE (HELP_INDEX)
              6149                           ;

   6149  6 002255   000013 236000 2                  LDQ     HELP_INDEX
         6 002256   000117 402007                    MPY     79,DL
         6 002257   001121 470400 2                  LDP0    VLP_HELP_RESULTS+1
         6 002260   040000 100506                    MLR     fill='040'O
         6 002261   000000 000117                    ADSC9   0,Q,PR0                  cn=0,n=79
         6 002262   000152 000117 2                  ADSC9   HELP_MSGB                cn=0,n=79

     1266     6150    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6150  6 002263   000122 237000 7                  LDAQ    82
         6 002264   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 002265   200006 236100                    LDQ     INDEX_,,AUTO
         6 002266   000076 402003                    MPY     62,DU
         6 002267   000124 036000 7                  ADLQ    84
         6 002270   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002271   000125 235000 7                  LDA     85
         6 002272   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 002273   000126 237000 7                  LDAQ    86
         6 002274   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002275   000014 237000 7                  LDAQ    12
         6 002276   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002277   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 002300   000026 631400 xsym               EPPR1   B_VECTNIL+22
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:187  
         6 002301   000000 701000 xent               TSX1    OCO$IWRITE
         6 002302   000000 011000                    NOP     0

     1267     6151    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1268     6152    5               END;

   6152  6 002303   000013 235000 2                  LDA     HELP_INDEX
         6 002304   000001 035007                    ADLA    1,DL
         6 002305   000013 755000 2                  STA     HELP_INDEX
         6 002306   200006 236100                    LDQ     INDEX_,,AUTO
         6 002307   000076 402007                    MPY     62,DL
         6 002310   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002311   000055 236106                    LDQ     45,QL,PR0
         6 002312   777777 376007                    ANQ     -1,DL
         6 002313   000013 116000 2                  CMPQ    HELP_INDEX
         6 002314   002316 600000 6                  TZE     s:6152+11
         6 002315   002255 603000 6                  TRC     s:6149
         6 002316   002346 710000 6                  TRA     s:6161

     1269     6153    5               ELSE DO;

   6149  6 002317                       NO_HELP      null
     1270     6154    5   NO_HELP:       ;
     1271     6155    5                  HELP_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   6155  6 002317   000000 470400 xsym               LDP0    B$TCB$
         6 002320   000000 471500                    LDP1    0,,PR0
         6 002321   000000 100500                    MLR     fill='000'O
         6 002322   100102 000004                    ADSC9   66,,PR1                  cn=0,n=4
         6 002323   000175 600004 2                  ADSC9   HELP_MSGB+19             cn=3,n=4

     1272     6156    5                  HELP_MSGB.CODE = 1;

   6156  6 002324   000001 236007                    LDQ     1,DL
         6 002325   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1273     6157    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:188  

   6157  6 002326   000122 237000 7                  LDAQ    82
         6 002327   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 002330   200006 236100                    LDQ     INDEX_,,AUTO
         6 002331   000076 402003                    MPY     62,DU
         6 002332   000124 036000 7                  ADLQ    84
         6 002333   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002334   000125 235000 7                  LDA     85
         6 002335   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 002336   000126 237000 7                  LDAQ    86
         6 002337   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002340   000014 237000 7                  LDAQ    12
         6 002341   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002342   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 002343   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002344   000000 701000 xent               TSX1    OCO$IWRITE
         6 002345   000000 011000                    NOP     0

     1274     6158    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1275     6159    5               END;

     1276     6160
     1277     6161    4               CALL M$FDS (FDS_HELP_BUF)

   6161  6 002346   001122 630400 2                  EPPR0   FDS_HELP_BUF
         6 002347   430002 713400                    CLIMB   alt,fds
         6 002350   400400 401760                    pmme    nvectors=2
         6 002351   002353 702000 6                  TSX2    s:6163
         6 002352   002353 710000 6                  TRA     s:6163

     1278     6162    5               WHENALTRETURN DO; END;

     1279     6163    4               RETURN;

   6163  6 002353   000000 702200 xent               TSX2  ! X66_ARET

     1280     6164
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:189  
     1281     6165        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:190  
     1282     6166    4            CASE (43 /* KEY_HELP2# */);

     1283     6167    4               MSG# = 393 /* HELP_MSG# */;

   6167  6 002354   000611 221003                    LDX1    393,DU
         6 002355   000310 741000 2                  STX1    MSG#

     1284     6168    4               NP# = 3;

   6168  6 002356   003000 236003                    LDQ     1536,DU
         6 002357   000311 756000 2                  STQ     NP#

     1285     6169    4               HELP_MSGB.CODE = 0;

   6169  6 002360   000000 236003                    LDQ     0,DU
         6 002361   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1286     6170    4               OCN_HELP.RESULTS_ = VECTOR (OC_CONSOLE.VLR_HELP (INDEX_));

   6170  6 002362   000120 235000 7                  LDA     80
         6 002363   200006 236100                    LDQ     INDEX_,,AUTO
         6 002364   200612 755100                    STA     @MCOUNT+2,,AUTO
         6 002365   000076 402003                    MPY     62,DU
         6 002366   000054 036003                    ADLQ    44,DU
         6 002367   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002370   200612 235100                    LDA     @MCOUNT+2,,AUTO
         6 002371   001102 757000 2                  STAQ    OCN_HELP+14

     1287     6171    4               OCN_HELP.V.MORE# = '1'B;

   6171  6 002372   000002 236007                    LDQ     2,DL
         6 002373   001107 256000 2                  ORSQ    OCN_HELP+19

     1288     6172
     1289     6173
     1290     6174    4               VLP_HELP_RESULTS.PTR$ = ADDR(NIL);

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:191  
   6174  6 002374   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002375   001121 756000 2                  STQ     VLP_HELP_RESULTS+1

     1291     6175    4               CALL M$GDS (GDS_HELP_BUF)

   6175  6 002376   001112 630400 2                  EPPR0   GDS_HELP_BUF
         6 002377   430001 713400                    CLIMB   alt,gds
         6 002400   400400 401760                    pmme    nvectors=2
         6 002401   002403 702000 6                  TSX2    s:6177
         6 002402   002426 710000 6                  TRA     s:6183

     1292     6176    5               WHENALTRETURN DO;

     1293     6177    5                  HELP_MSGB.CODE = 4;

   6177  6 002403   000004 236007                    LDQ     4,DL
         6 002404   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1294     6178    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6178  6 002405   000122 237000 7                  LDAQ    82
         6 002406   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 002407   200006 236100                    LDQ     INDEX_,,AUTO
         6 002410   000076 402003                    MPY     62,DU
         6 002411   000124 036000 7                  ADLQ    84
         6 002412   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002413   000125 235000 7                  LDA     85
         6 002414   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 002415   000126 237000 7                  LDAQ    86
         6 002416   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002417   000014 237000 7                  LDAQ    12
         6 002420   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002421   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 002422   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002423   000000 701000 xent               TSX1    OCO$IWRITE
         6 002424   000000 011000                    NOP     0

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:192  
     1295     6179    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1296     6180    5                  RETURN;

   6180  6 002425   000000 702200 xent               TSX2  ! X66_ARET

     1297     6181    5               END;
     1298     6182
     1299     6183    4               OCN_HELP.BUF_ = VLP_HELP_RESULTS;

   6183  6 002426   001120 237000 2                  LDAQ    VLP_HELP_RESULTS
         6 002427   001072 757000 2                  STAQ    OCN_HELP+6

     1300     6184
     1301     6185    4               CALL M$HELP (OCN_HELP) ALTRET (NO_MORE_HELP);

   6185  6 002430   001064 630400 2                  EPPR0   OCN_HELP
         6 002431   420024 713400                    CLIMB   alt,+8212
         6 002432   404000 401760                    pmme    nvectors=9
         6 002433   002505 702000 6                  TSX2    NO_MORE_HELP

     1302     6186    4               IF OC_CONSOLE.VLR_HELP.RECCNT(INDEX_) > 0

   6186  6 002434   200006 236100                    LDQ     INDEX_,,AUTO
         6 002435   000076 402007                    MPY     62,DL
         6 002436   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002437   000055 720106                    LXL0    45,QL,PR0
         6 002440   002505 600000 6                  TZE     NO_MORE_HELP

     1303     6187    4               THEN
     1304     6188    5               DO HELP_INDEX = 0 TO (OC_CONSOLE.VLR_HELP.RECCNT (INDEX_) - 1);

   6188  6 002441   000013 450000 2                  STZ     HELP_INDEX
         6 002442   002474 710000 6                  TRA     s:6192+3

     1305     6189    5                 HELP_MSGB.HMSG = VLP_HELP_RESULTS.PTR$->HELP_OUTPUT.LINE (HELP_INDEX)
              6189                           ;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:193  
   6189  6 002443   000013 236000 2                  LDQ     HELP_INDEX
         6 002444   000117 402007                    MPY     79,DL
         6 002445   001121 470400 2                  LDP0    VLP_HELP_RESULTS+1
         6 002446   040000 100506                    MLR     fill='040'O
         6 002447   000000 000117                    ADSC9   0,Q,PR0                  cn=0,n=79
         6 002450   000152 000117 2                  ADSC9   HELP_MSGB                cn=0,n=79

     1306     6190    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6190  6 002451   000122 237000 7                  LDAQ    82
         6 002452   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 002453   200006 236100                    LDQ     INDEX_,,AUTO
         6 002454   000076 402003                    MPY     62,DU
         6 002455   000124 036000 7                  ADLQ    84
         6 002456   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002457   000125 235000 7                  LDA     85
         6 002460   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 002461   000126 237000 7                  LDAQ    86
         6 002462   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002463   000014 237000 7                  LDAQ    12
         6 002464   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002465   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 002466   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002467   000000 701000 xent               TSX1    OCO$IWRITE
         6 002470   000000 011000                    NOP     0

     1307     6191    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1308     6192    5               END;

   6192  6 002471   000013 235000 2                  LDA     HELP_INDEX
         6 002472   000001 035007                    ADLA    1,DL
         6 002473   000013 755000 2                  STA     HELP_INDEX
         6 002474   200006 236100                    LDQ     INDEX_,,AUTO
         6 002475   000076 402007                    MPY     62,DL
         6 002476   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002477   000055 236106                    LDQ     45,QL,PR0
         6 002500   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:194  
         6 002501   000013 116000 2                  CMPQ    HELP_INDEX
         6 002502   002504 600000 6                  TZE     s:6192+11
         6 002503   002443 603000 6                  TRC     s:6189
         6 002504   002534 710000 6                  TRA     DONE_HELPING

     1309     6193
     1310     6194    5               ELSE DO;

     1311     6195    5   NO_MORE_HELP:
     1312     6196    5                  HELP_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   6196  6 002505   000000 470400 xsym  NO_MORE_HELP LDP0    B$TCB$
         6 002506   000000 471500                    LDP1    0,,PR0
         6 002507   000000 100500                    MLR     fill='000'O
         6 002510   100102 000004                    ADSC9   66,,PR1                  cn=0,n=4
         6 002511   000175 600004 2                  ADSC9   HELP_MSGB+19             cn=3,n=4

     1313     6197    5                  HELP_MSGB.CODE = 5;

   6197  6 002512   000005 236007                    LDQ     5,DL
         6 002513   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1314     6198    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6198  6 002514   000122 237000 7                  LDAQ    82
         6 002515   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 002516   200006 236100                    LDQ     INDEX_,,AUTO
         6 002517   000076 402003                    MPY     62,DU
         6 002520   000124 036000 7                  ADLQ    84
         6 002521   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002522   000125 235000 7                  LDA     85
         6 002523   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 002524   000126 237000 7                  LDAQ    86
         6 002525   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002526   000014 237000 7                  LDAQ    12
         6 002527   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002530   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:195  
         6 002531   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002532   000000 701000 xent               TSX1    OCO$IWRITE
         6 002533   000000 011000                    NOP     0

     1315     6199    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1316     6200    5               END;

     1317     6201    4   DONE_HELPING: CALL M$FDS (FDS_HELP_BUF)

   6201  6 002534   001122 630400 2     DONE_HELPING EPPR0   FDS_HELP_BUF
         6 002535   430002 713400                    CLIMB   alt,fds
         6 002536   400400 401760                    pmme    nvectors=2
         6 002537   002541 702000 6                  TSX2    s:6203
         6 002540   002541 710000 6                  TRA     s:6203

     1318     6202    5               WHENALTRETURN DO; END;

     1319     6203    4               RETURN;

   6203  6 002541   000000 702200 xent               TSX2  ! X66_ARET

     1320     6204        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:196  
     1321     6205    4            CASE (44 /* KEY_HELP3# */);

     1322     6206    4               MSG# = 393 /* HELP_MSG# */;

   6206  6 002542   000611 221003                    LDX1    393,DU
         6 002543   000310 741000 2                  STX1    MSG#

     1323     6207    4               NP# = 3;

   6207  6 002544   003000 236003                    LDQ     1536,DU
         6 002545   000311 756000 2                  STQ     NP#

     1324     6208    4               HELP_MSGB.CODE = 0;

   6208  6 002546   000000 236003                    LDQ     0,DU
         6 002547   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1325     6209    4               OCN_HELP.RESULTS_ = VECTOR (OC_CONSOLE.VLR_HELP (INDEX_));

   6209  6 002550   000120 235000 7                  LDA     80
         6 002551   200006 236100                    LDQ     INDEX_,,AUTO
         6 002552   200612 755100                    STA     @MCOUNT+2,,AUTO
         6 002553   000076 402003                    MPY     62,DU
         6 002554   000054 036003                    ADLQ    44,DU
         6 002555   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002556   200612 235100                    LDA     @MCOUNT+2,,AUTO
         6 002557   001102 757000 2                  STAQ    OCN_HELP+14

     1326     6210    4               OCN_HELP.V.ALL# = '1'B;

   6210  6 002560   000004 236007                    LDQ     4,DL
         6 002561   001107 256000 2                  ORSQ    OCN_HELP+19

     1327     6211
     1328     6212
     1329     6213    4               VLP_HELP_RESULTS.PTR$ = ADDR(NIL);

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:197  
   6213  6 002562   000001 236000 xsym               LDQ     B_VECTNIL+1
         6 002563   001121 756000 2                  STQ     VLP_HELP_RESULTS+1

     1330     6214    4               CALL M$GDS (GDS_HELP_BUF)

   6214  6 002564   001112 630400 2                  EPPR0   GDS_HELP_BUF
         6 002565   430001 713400                    CLIMB   alt,gds
         6 002566   400400 401760                    pmme    nvectors=2
         6 002567   002571 702000 6                  TSX2    s:6216
         6 002570   002600 710000 6                  TRA     s:6222

     1331     6215    5               WHENALTRETURN DO;

     1332     6216    5                  HELP_MSGB.CODE = 4;

   6216  6 002571   000004 236007                    LDQ     4,DL
         6 002572   000176 552004 2                  STBQ    HELP_MSGB+20,'04'O

     1333     6217    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6217  6 002573   000130 630400 7                  EPPR0   88
         6 002574   000025 631400 xsym               EPPR1   B_VECTNIL+21
         6 002575   000000 701000 xent               TSX1    OCO$IWRITE
         6 002576   000000 011000                    NOP     0

     1334     6218    5                    HELP_MSGB, ' ', 0);
     1335     6219    5                  RETURN;

   6219  6 002577   000000 702200 xent               TSX2  ! X66_ARET

     1336     6220    5               END;
     1337     6221
     1338     6222    4               OCN_HELP.BUF_ = VLP_HELP_RESULTS;

   6222  6 002600   001120 237000 2                  LDAQ    VLP_HELP_RESULTS
         6 002601   001072 757000 2                  STAQ    OCN_HELP+6

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:198  
     1339     6223
     1340     6224    4               CALL M$HELP (OCN_HELP) ALTRET (NO_MORE_HELP);

   6224  6 002602   001064 630400 2                  EPPR0   OCN_HELP
         6 002603   420024 713400                    CLIMB   alt,+8212
         6 002604   404000 401760                    pmme    nvectors=9
         6 002605   002505 702000 6                  TSX2    NO_MORE_HELP

     1341     6225    4               IF OC_CONSOLE.VLR_HELP.RECCNT(INDEX_) = 0

   6225  6 002606   200006 236100                    LDQ     INDEX_,,AUTO
         6 002607   000076 402007                    MPY     62,DL
         6 002610   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002611   000055 720106                    LXL0    45,QL,PR0
         6 002612   002505 600000 6                  TZE     NO_MORE_HELP

     1342     6226    4               THEN
     1343     6227    4               GOTO NO_MORE_HELP;
     1344     6228    5               DO HELP_INDEX = 0 TO (OC_CONSOLE.VLR_HELP.RECCNT (INDEX_) - 1);

   6228  6 002613   000013 450000 2                  STZ     HELP_INDEX
         6 002614   002646 710000 6                  TRA     s:6232+3

     1345     6229    5                  HELP_MSGB.HMSG = VLP_HELP_RESULTS.PTR$ -> HELP_OUTPUT.LINE (
              6229                           HELP_INDEX);

   6229  6 002615   000013 236000 2                  LDQ     HELP_INDEX
         6 002616   000117 402007                    MPY     79,DL
         6 002617   001121 470400 2                  LDP0    VLP_HELP_RESULTS+1
         6 002620   040000 100506                    MLR     fill='040'O
         6 002621   000000 000117                    ADSC9   0,Q,PR0                  cn=0,n=79
         6 002622   000152 000117 2                  ADSC9   HELP_MSGB                cn=0,n=79

     1346     6230    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, HELP_MSGC,

   6230  6 002623   000122 237000 7                  LDAQ    82
         6 002624   200620 757100                    STAQ    @MCOUNT+8,,AUTO
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:199  
         6 002625   200006 236100                    LDQ     INDEX_,,AUTO
         6 002626   000076 402003                    MPY     62,DU
         6 002627   000124 036000 7                  ADLQ    84
         6 002630   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 002631   000125 235000 7                  LDA     85
         6 002632   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 002633   000126 237000 7                  LDAQ    86
         6 002634   200614 757100                    STAQ    @MCOUNT+4,,AUTO
         6 002635   000014 237000 7                  LDAQ    12
         6 002636   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 002637   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 002640   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002641   000000 701000 xent               TSX1    OCO$IWRITE
         6 002642   000000 011000                    NOP     0

     1347     6231    5                    HELP_MSGB, OC_CONSOLE.SYSID (INDEX_), ' ', 0);
     1348     6232    5               END;

   6232  6 002643   000013 235000 2                  LDA     HELP_INDEX
         6 002644   000001 035007                    ADLA    1,DL
         6 002645   000013 755000 2                  STA     HELP_INDEX
         6 002646   200006 236100                    LDQ     INDEX_,,AUTO
         6 002647   000076 402007                    MPY     62,DL
         6 002650   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002651   000055 236106                    LDQ     45,QL,PR0
         6 002652   777777 376007                    ANQ     -1,DL
         6 002653   000013 116000 2                  CMPQ    HELP_INDEX
         6 002654   002656 600000 6                  TZE     s:6234
         6 002655   002615 603000 6                  TRC     s:6229

     1349     6233
     1350     6234    4               GOTO DONE_HELPING;

   6234  6 002656   002534 710000 6                  TRA     DONE_HELPING

     1351     6235        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:200  
     1352     6236        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:201  
     1353     6237         /* Handle request to enter text in
     1354     6238              ERRFILE                                                                 */
     1355     6239    4            CASE (11 /* KEY_ERSEND# */);

     1356     6240
     1357     6241    4               EL_OPERBUF.STATION = OC_CONSOLE.STATION(INDEX_);

   6241  6 002657   200006 236100                    LDQ     INDEX_,,AUTO
         6 002660   000370 402007                    MPY     248,DL
         6 002661   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002662   040000 100506                    MLR     fill='040'O
         6 002663   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         6 002664   000320 000010 2                  ADSC9   EL_OPERBUF               cn=0,n=8

     1358     6242    4               EL_OPERBUF.ATTR = OC_CONSOLE.ATTR(INDEX_);

   6242  6 002665   200006 236100                    LDQ     INDEX_,,AUTO
         6 002666   000076 402007                    MPY     62,DL
         6 002667   000013 221106                    LDX1    11,QL,PR0
         6 002670   000326 741000 2                  STX1    EL_OPERBUF+6

     1359     6243    4               EL_OPERBUF.MESSAGE = ' ';

   6243  6 002671   040000 100400                    MLR     fill='040'O
         6 002672   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002673   000327 000214 2                  ADSC9   EL_OPERBUF+7             cn=0,n=140

     1360     6244    4               ADDR(EL_OPERBUF.MESSAGE) -> BIG_BUF =

   6244  6 002674   000001 236000 xsym               LDQ     OC_PARAM+1
         6 002675   000033 772000                    QRL     27
         6 002676   000000 622006                    EAX2    0,QL
         6 002677   040000 100440                    MLR     fill='040'O
         6 002700   000001 200012 xsym               ADSC9   OC_PARAM+1               cn=1,n=*X2
         6 002701   000327 000214 2                  ADSC9   EL_OPERBUF+7             cn=0,n=140

     1361     6245    4                 ADDR(ADDR(OC_PARAM) -> OC$MESSAGE.TEXT) -> TEXT.C;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:202  
     1362     6246
     1363     6247    4               CALL M$WRSYSLOG (WR_ERSEND) ALTRET (ERSEND1);

   6247  6 002702   001024 630400 2                  EPPR0   WR_ERSEND
         6 002703   470001 713400                    CLIMB   alt,+28673
         6 002704   400400 401760                    pmme    nvectors=2
         6 002705   002707 702000 6                  TSX2    ERSEND1

     1364     6248
     1365     6249    5               DO WHILE ('0'B);

   6249  6 002706   006562 710000 6                  TRA     IGNORE

     1366     6250    5   ERSEND1:
     1367     6251    5                  MSG# = 383 /* GENKEYIN_MSG# */;

   6251  6 002707   000577 220003       ERSEND1      LDX0    383,DU
         6 002710   000310 740000 2                  STX0    MSG#

     1368     6252    5                  NP# = 2;

   6252  6 002711   002000 236003                    LDQ     1024,DU
         6 002712   000311 756000 2                  STQ     NP#

     1369     6253    5                  GENKEYIN_MSGB.CODE = 0;

   6253  6 002713   000000 236003                    LDQ     0,DU
         6 002714   000052 552040 2                  STBQ    GENKEYIN_MSGB+1,'40'O

     1370     6254    5                  GENKEYIN_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   6254  6 002715   000000 470400 xsym               LDP0    B$TCB$
         6 002716   000000 471500                    LDP1    0,,PR0
         6 002717   100102 236100                    LDQ     66,,PR1
         6 002720   000051 756000 2                  STQ     GENKEYIN_MSGB

     1371     6255    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:203  

   6255  6 002721   000137 630400 7                  EPPR0   95
         6 002722   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 002723   000000 701000 xent               TSX1    OCO$IWRITE
         6 002724   000000 011000                    NOP     0

     1372     6256    5                    GENKEYIN_MSGC, GENKEYIN_MSGB, 0, ' ', 0);
     1373     6257    5               END;

   6257  6 002725   006562 710000 6                  TRA     IGNORE

     1374     6258
     1375     6259        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:204  
     1376     6260    4            CASE(17 /* KEY_TIMON# */);
              6260                     /* TURN TIME PRINTING ON                           */

     1377     6261
     1378     6262    4               IF OC_CONSOLE.DONT_TIME(INDEX_)

   6262  6 002726   200006 236100                    LDQ     INDEX_,,AUTO
         6 002727   000076 402007                    MPY     62,DL
         6 002730   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002731   000017 236106                    LDQ     15,QL,PR0
         6 002732   004000 316007                    CANQ    2048,DL
         6 002733   002746 600000 6                  TZE     s:6269

     1379     6263    4               THEN
     1380     6264    5               DO;

     1381     6265    5                  OC_CONSOLE.DONT_TIME(INDEX_) = '0'B /*FALSE#*/;

   6265  6 002734   200006 236100                    LDQ     INDEX_,,AUTO
         6 002735   000076 402007                    MPY     62,DL
         6 002736   000000 621006                    EAX1    0,QL
         6 002737   000147 236000 7                  LDQ     103
         6 002740   000017 356111                    ANSQ    15,X1,PR0

     1382     6266    5                  CALL WRITE_ERR(17);

   6266  6 002741   000151 236000 7                  LDQ     105
         6 002742   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 002743   006570 701000 6                  TSX1    WRITE_ERR
         6 002744   000000 011000                    NOP     0

     1383     6267    5               END;

   6267  6 002745   006562 710000 6                  TRA     IGNORE

     1384     6268    4               ELSE
     1385     6269    4               CALL WRITE_ERR(18);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:205  

   6269  6 002746   000153 236000 7                  LDQ     107
         6 002747   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 002750   006570 701000 6                  TSX1    WRITE_ERR
         6 002751   000000 011000                    NOP     0
         6 002752   006562 710000 6                  TRA     IGNORE

     1386     6270
     1387     6271    4            CASE(18 /* KEY_TIMOFF# */);

     1388     6272
     1389     6273    4               IF OC_CONSOLE.DONT_TIME(INDEX_)

   6273  6 002753   200006 236100                    LDQ     INDEX_,,AUTO
         6 002754   000076 402007                    MPY     62,DL
         6 002755   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 002756   000017 236106                    LDQ     15,QL,PR0
         6 002757   004000 316007                    CANQ    2048,DL
         6 002760   002766 600000 6                  TZE     s:6278

     1390     6274    4               THEN
     1391     6275    4               CALL WRITE_ERR(19);

   6275  6 002761   000155 236000 7                  LDQ     109
         6 002762   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 002763   006570 701000 6                  TSX1    WRITE_ERR
         6 002764   000000 011000                    NOP     0
         6 002765   006562 710000 6                  TRA     IGNORE

     1392     6276    4               ELSE
     1393     6277    5               DO;

     1394     6278    5                  OC_CONSOLE.DONT_TIME(INDEX_) = '1'B /*TRUE#*/;

   6278  6 002766   200006 236100                    LDQ     INDEX_,,AUTO
         6 002767   000076 402007                    MPY     62,DL
         6 002770   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:206  
         6 002771   004000 236007                    LDQ     2048,DL
         6 002772   000017 256111                    ORSQ    15,X1,PR0

     1395     6279    5                  CALL WRITE_ERR(20);

   6279  6 002773   000157 236000 7                  LDQ     111
         6 002774   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 002775   006570 701000 6                  TSX1    WRITE_ERR
         6 002776   000000 011000                    NOP     0

     1396     6280    5               END;

   6280  6 002777   006562 710000 6                  TRA     IGNORE

     1397     6281
     1398     6282        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:207  
     1399     6283         /* Send input text to the selected
     1400     6284              master terminal station                                                 */
     1401     6285
     1402     6286    4            CASE(21 /* KEY_TERMSEND# */);

     1403     6287
     1404     6288    4               FOUND = '0'B /*FALSE#*/;

   6288  6 003000   000010 450000 2                  STZ     FOUND

     1405     6289    5               DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   6289  6 003001   000001 236007                    LDQ     1,DL
         6 003002   000000 756000 2                  STQ     I
         6 003003   003075 710000 6                  TRA     s:6311+3

     1406     6290    5                  IF OC_CONSOLE.ACTIVE(I)

   6290  6 003004   000000 236000 2                  LDQ     I
         6 003005   000076 402007                    MPY     62,DL
         6 003006   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 003007   000017 236106                    LDQ     15,QL,PR0
         6 003010   010000 316007                    CANQ    4096,DL
         6 003011   003072 600000 6                  TZE     s:6311

     1407     6291    5                  THEN
     1408     6292    5                  IF OC_CONSOLE.TERM_NAME(I) =

   6292  6 003012   000000 236000 2                  LDQ     I
         6 003013   000370 402007                    MPY     248,DL
         6 003014   000000 471400 xsym               LDP1    OC_PARAM$
         6 003015   040100 106506                    CMPC    fill='040'O
         6 003016   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         6 003017   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         6 003020   003072 601000 6                  TNZ     s:6311

     1409     6293    5                    OC_PARAM$ -> OC$TERMSEND.TERM
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:208  
     1410     6294    5                  THEN
     1411     6295    5                  IF (OC_CONSOLE.ATTR(I) &

   6295  6 003021   000000 236000 2                  LDQ     I
         6 003022   000076 402007                    MPY     62,DL
         6 003023   000013 220106                    LDX0    11,QL,PR0
         6 003024   002000 360003                    ANX0    1024,DU
         6 003025   003072 600000 6                  TZE     s:6311

     1412     6296    5                    '002000'O /* K_SLAVE */) ~= '0'B /*FALSE#*/
     1413     6297    5                  THEN
     1414     6298    6                  DO;

     1415     6299    6                     FOUND = '1'B /*TRUE#*/;

   6299  6 003026   400000 236003                    LDQ     -131072,DU
         6 003027   000010 756000 2                  STQ     FOUND

     1416     6300    6                     NP# = 1;

   6300  6 003030   001000 236003                    LDQ     512,DU
         6 003031   000311 756000 2                  STQ     NP#

     1417     6301    6                     MSG# = 388 /* TOMASTER_MSG# */;

   6301  6 003032   000604 220003                    LDX0    388,DU
         6 003033   000310 740000 2                  STX0    MSG#

     1418     6302    6                     BYTES_ = OC_PARAM$ -> OC$TERMSEND.SIZE;

   6302  6 003034   000000 100500                    MLR     fill='000'O
         6 003035   100003 000001                    ADSC9   3,,PR1                   cn=0,n=1
         6 003036   000111 000001 2                  ADSC9   BYTES_                   cn=0,n=1

     1419     6303    6                     CALL OCO$IWRITE (

   6303  6 003037   000000 236000 2                  LDQ     I
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:209  
         6 003040   000076 402007                    MPY     62,DL
         6 003041   000012 236106                    LDQ     10,QL,PR0
         6 003042   000022 772000                    QRL     18
         6 003043   400000 036007                    ADLQ    -131072,DL
         6 003044   000022 736000                    QLS     18
         6 003045   000022 772000                    QRL     18
         6 003046   000000 621006                    EAX1    0,QL
         6 003047   200612 741100                    STX1    @MCOUNT+2,,AUTO
         6 003050   000010 237000 7                  LDAQ    8
         6 003051   200622 757100                    STAQ    @MCOUNT+10,,AUTO
         6 003052   000007 236000 7                  LDQ     7
         6 003053   200621 756100                    STQ     @MCOUNT+9,,AUTO
         6 003054   000000 236000 xsym               LDQ     OC_PARAM$
         6 003055   000160 036000 7                  ADLQ    112
         6 003056   200620 756100                    STQ     @MCOUNT+8,,AUTO
         6 003057   000162 237000 7                  LDAQ    114
         6 003060   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 003061   000003 236000 7                  LDQ     3
         6 003062   200615 756100                    STQ     @MCOUNT+5,,AUTO
         6 003063   200612 633500                    EPPR3   @MCOUNT+2,,AUTO
         6 003064   200614 453500                    STP3    @MCOUNT+4,,AUTO
         6 003065   200614 630500                    EPPR0   @MCOUNT+4,,AUTO
         6 003066   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 003067   000000 701000 xent               TSX1    OCO$IWRITE
         6 003070   000000 011000                    NOP     0

     1420     6304    6                       BINBIT(OC_CONSOLE.CID(I)+BITBIN('400000'O),18),
     1421     6305    6                       MSG#,NP#,BYTES_,
     1422     6306    6                       OC_PARAM$->OC$TERMSEND.MESSAGE,
     1423     6307    6                       0,OCP_NON_STA,0);
     1424     6308    6                     RETURN;

   6308  6 003071   000000 702200 xent               TSX2  ! X66_ARET

     1425     6309    6                  END; /* DO IF FOUND                                            */
     1426     6310
     1427     6311    5               END; /* DO I = 0 TO MAX_CONS                                      */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:210  

   6311  6 003072   000000 235000 2                  LDA     I
         6 003073   000001 035007                    ADLA    1,DL
         6 003074   000000 755000 2                  STA     I
         6 003075   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         6 003076   000022 772000                    QRL     18
         6 003077   000000 116000 2                  CMPQ    I
         6 003100   003004 603000 6                  TRC     s:6290

     1428     6312
     1429     6313    4               IF ~FOUND

   6313  6 003101   000010 236000 2                  LDQ     FOUND
         6 003102   400000 376003                    ANQ     -131072,DU
         6 003103   400000 676003                    ERQ     -131072,DU
         6 003104   006562 600000 6                  TZE     IGNORE

     1430     6314    4               THEN
     1431     6315    4               CALL WRITE_ERR (21);

   6315  6 003105   000164 236000 7                  LDQ     116
         6 003106   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003107   006570 701000 6                  TSX1    WRITE_ERR
         6 003110   000000 011000                    NOP     0
         6 003111   006562 710000 6                  TRA     IGNORE

     1432     6316
     1433     6317        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:211  
     1434     6318
     1435     6319    4            CASE (16 /* KEY_XCONS# */);

     1436     6320
     1437     6321    4               I = 4;

   6321  6 003112   000004 236007                    LDQ     4,DL
         6 003113   000000 756000 2                  STQ     I

     1438     6322    4               CALL MY_XLATE (ADDR(OC_PARAM$->OC$COMM.DEVICE), I);

   6322  6 003114   000000 236000 xsym               LDQ     OC_PARAM$
         6 003115   000001 036003                    ADLQ    1,DU
         6 003116   200624 756100                    STQ     @MCOUNT+12,,AUTO
         6 003117   000165 236000 7                  LDQ     117
         6 003120   200610 756100                    STQ     @MPTR$+1,,AUTO
         6 003121   200624 630500                    EPPR0   @MCOUNT+12,,AUTO
         6 003122   200607 450500                    STP0    INSTANCE$+2,,AUTO
         6 003123   006606 701000 6                  TSX1    MY_XLATE
         6 003124   000000 011000                    NOP     0

     1439     6323
     1440     6324    4               IF OC_PARAM$ -> OC$COMM.TERM = ' '

   6324  6 003125   000000 470400 xsym               LDP0    OC_PARAM$
         6 003126   040000 106500                    CMPC    fill='040'O
         6 003127   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         6 003130   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003131   003140 601000 6                  TNZ     s:6329

     1441     6325    4               THEN
     1442     6326    4               OC_PARAM$ -> OC$COMM.TERM =

   6326  6 003132   200006 236100                    LDQ     INDEX_,,AUTO
         6 003133   000370 402007                    MPY     248,DL
         6 003134   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 003135   040100 100506                    MLR     fill='040'O
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:212  
         6 003136   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         6 003137   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

     1443     6327    4                 OC_CONSOLE.TERM_NAME (INDEX_);
     1444     6328
     1445     6329    4               IF OC_PARAM$ -> OC$COMM.AT_TERM = ' '

   6329  6 003140   040000 106500                    CMPC    fill='040'O
         6 003141   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         6 003142   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003143   003147 601000 6                  TNZ     s:6334

     1446     6330    4               THEN
     1447     6331    4               OC_PARAM$ -> OC$COMM.AT_TERM =

   6331  6 003144   040100 100500                    MLR     fill='040'O
         6 003145   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         6 003146   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

     1448     6332    4                 OC_PARAM$ -> OC$COMM.TERM;
     1449     6333
     1450     6334    4               FOUND = '0'B /*FALSE#*/;

   6334  6 003147   000010 450000 2                  STZ     FOUND

     1451     6335    5               DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   6335  6 003150   000001 235007                    LDA     1,DL
         6 003151   000000 755000 2                  STA     I
         6 003152   003243 710000 6                  TRA     s:6364+3

     1452     6336    5                  IF OC_CONSOLE.ACTIVE(I)

   6336  6 003153   000000 236000 2                  LDQ     I
         6 003154   000076 402007                    MPY     62,DL
         6 003155   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 003156   000017 236106                    LDQ     15,QL,PR0
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:213  
         6 003157   010000 316007                    CANQ    4096,DL
         6 003160   003240 600000 6                  TZE     s:6364
         6 003161   000000 236000 2                  LDQ     I
         6 003162   000076 402007                    MPY     62,DL
         6 003163   000013 220106                    LDX0    11,QL,PR0
         6 003164   002000 360003                    ANX0    1024,DU
         6 003165   003240 601000 6                  TNZ     s:6364
         6 003166   000000 236000 2                  LDQ     I
         6 003167   000370 402007                    MPY     248,DL
         6 003170   000000 471400 xsym               LDP1    OC_PARAM$
         6 003171   040100 106506                    CMPC    fill='040'O
         6 003172   000000 000004                    ADSC9   0,Q,PR0                  cn=0,n=4
         6 003173   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4
         6 003174   003240 601000 6                  TNZ     s:6364
         6 003175   040100 106506                    CMPC    fill='040'O
         6 003176   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         6 003177   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         6 003200   003240 601000 6                  TNZ     s:6364

     1453     6337    5                    AND
     1454     6338    5                    ((OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)
     1455     6339    5                    = '0'B /*FALSE#*/)
     1456     6340    5                    AND
     1457     6341    5                    OC_CONSOLE.STATIONR.FIRST_HALF(I) =
     1458     6342    5                    OC_PARAM$ -> OC$COMM.DEVICE
     1459     6343    5                    AND
     1460     6344    5                    (OC_CONSOLE.TERM_NAME(I) =
     1461     6345    5                    OC_PARAM$ ->
     1462     6346    5                    OC$COMM.AT_TERM)
     1463     6347    5                  THEN
     1464     6348    6                  DO;

     1465     6349    6                     FOUND = '1'B /*TRUE#*/;

   6349  6 003201   400000 236003                    LDQ     -131072,DU
         6 003202   000010 756000 2                  STQ     FOUND

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:214  
     1466     6350    6                     IF OC_CONSOLE.ATTR(I) & '200000'O /* M_SYS  */

   6350  6 003203   000000 236000 2                  LDQ     I
         6 003204   000076 402007                    MPY     62,DL
         6 003205   000013 220106                    LDX0    11,QL,PR0
         6 003206   200000 360003                    ANX0    65536,DU
         6 003207   003222 600000 6                  TZE     s:6358
         6 003210   200006 236100                    LDQ     INDEX_,,AUTO
         6 003211   000076 402007                    MPY     62,DL
         6 003212   000013 220106                    LDX0    11,QL,PR0
         6 003213   000004 360003                    ANX0    4,DU
         6 003214   003222 601000 6                  TNZ     s:6358

     1467     6351    6                       AND
     1468     6352    6                       (OC_CONSOLE.ATTR(INDEX_) & '000004'O /* K_IOMCON */)
     1469     6353    6                       = '0'B /*FALSE#*/
     1470     6354    6                     THEN
     1471     6355    6                     CALL WRITE_ERR(23);

   6355  6 003215   000167 236000 7                  LDQ     119
         6 003216   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003217   006570 701000 6                  TSX1    WRITE_ERR
         6 003220   000000 011000                    NOP     0
         6 003221   003234 710000 6                  TRA     s:6362

     1472     6356    6                     ELSE
     1473     6357    7                     DO;

     1474     6358    7                        STA.STATION# = OC_CONSOLE.STATION (I);

   6358  6 003222   000000 236000 2                  LDQ     I
         6 003223   000370 402007                    MPY     248,DL
         6 003224   040000 100506                    MLR     fill='040'O
         6 003225   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=8
         6 003226   000452 000010 2                  ADSC9   STA                      cn=0,n=8

     1475     6359    7                        CALL M$DEACTIVATE (DEACT)
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:215  

   6359  6 003227   000526 630400 2                  EPPR0   DEACT
         6 003230   500001 713400                    CLIMB   alt,+32769
         6 003231   401400 401760                    pmme    nvectors=4
         6 003232   003234 702000 6                  TSX2    s:6362
         6 003233   003234 710000 6                  TRA     s:6362

     1476     6360    8                        WHENALTRETURN DO; END;

     1477     6361    7                     END; /* DO IF FOUND                                         */

     1478     6362    6                     I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   6362  6 003234   000000 235000 xsym               LDA     OC_MAXCONSOLE
         6 003235   000022 771000                    ARL     18
         6 003236   000001 035007                    ADLA    1,DL
         6 003237   000000 755000 2                  STA     I

     1479     6363    6                  END; /* DO IF FOUND                                            */

     1480     6364    5               END; /* DO I                                                      */

   6364  6 003240   000000 235000 2                  LDA     I
         6 003241   000001 035007                    ADLA    1,DL
         6 003242   000000 755000 2                  STA     I
         6 003243   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         6 003244   000022 772000                    QRL     18
         6 003245   000000 116000 2                  CMPQ    I
         6 003246   003153 603000 6                  TRC     s:6336

     1481     6365    4               IF ~FOUND

   6365  6 003247   000010 236000 2                  LDQ     FOUND
         6 003250   400000 376003                    ANQ     -131072,DU
         6 003251   400000 676003                    ERQ     -131072,DU
         6 003252   006562 600000 6                  TZE     IGNORE

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:216  
     1482     6366    4               THEN
     1483     6367    4               CALL WRITE_ERR(26);

   6367  6 003253   000171 236000 7                  LDQ     121
         6 003254   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003255   006570 701000 6                  TSX1    WRITE_ERR
         6 003256   000000 011000                    NOP     0
         6 003257   006562 710000 6                  TRA     IGNORE

     1484     6368
     1485     6369        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:217  
     1486     6370    4            CASE (19 /* KEY_TELL# */);

     1487     6371
     1488     6372    4               I = 4;

   6372  6 003260   000004 236007                    LDQ     4,DL
         6 003261   000000 756000 2                  STQ     I

     1489     6373    4               CALL MY_XLATE (ADDR(OC_PARAM$->OC$COMM.DEVICE), I);

   6373  6 003262   000000 236000 xsym               LDQ     OC_PARAM$
         6 003263   000001 036003                    ADLQ    1,DU
         6 003264   200625 756100                    STQ     @MCOUNT+13,,AUTO
         6 003265   000165 236000 7                  LDQ     117
         6 003266   200610 756100                    STQ     @MPTR$+1,,AUTO
         6 003267   200625 630500                    EPPR0   @MCOUNT+13,,AUTO
         6 003270   200607 450500                    STP0    INSTANCE$+2,,AUTO
         6 003271   006606 701000 6                  TSX1    MY_XLATE
         6 003272   000000 011000                    NOP     0

     1490     6374    4               FOUND = '1'B /*TRUE#*/;

   6374  6 003273   400000 236003                    LDQ     -131072,DU
         6 003274   000010 756000 2                  STQ     FOUND

     1491     6375
     1492     6376    4               IF OC_PARAM$ -> OC$COMM.TERM = ' '

   6376  6 003275   000000 470400 xsym               LDP0    OC_PARAM$
         6 003276   040000 106500                    CMPC    fill='040'O
         6 003277   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         6 003300   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003301   003310 601000 6                  TNZ     s:6381

     1493     6377    4               THEN
     1494     6378    4               OC_PARAM$ -> OC$COMM.TERM =

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:218  
   6378  6 003302   200006 236100                    LDQ     INDEX_,,AUTO
         6 003303   000370 402007                    MPY     248,DL
         6 003304   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 003305   040100 100506                    MLR     fill='040'O
         6 003306   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         6 003307   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

     1495     6379    4                 OC_CONSOLE.TERM_NAME (INDEX_);
     1496     6380
     1497     6381    4               IF OC_PARAM$ -> OC$COMM.AT_TERM = ' '

   6381  6 003310   040000 106500                    CMPC    fill='040'O
         6 003311   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         6 003312   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003313   003317 601000 6                  TNZ     s:6386

     1498     6382    4               THEN
     1499     6383    4               OC_PARAM$ -> OC$COMM.AT_TERM =

   6383  6 003314   040100 100500                    MLR     fill='040'O
         6 003315   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         6 003316   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

     1500     6384    4                 OC_PARAM$ -> OC$COMM.TERM;
     1501     6385
     1502     6386    4               IF OC_PARAM$ -> OC$COMM.COUNT >

   6386  6 003317   000100 101500                    MRL     fill='000'O
         6 003320   000006 000001                    ADSC9   6,,PR0                   cn=0,n=1
         6 003321   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 003322   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 003323   000121 116007                    CMPQ    81,DL
         6 003324   003332 604000 6                  TMI     s:6392

     1503     6387    4                 SIZEC (TELL_WRITEB.TEXT)
     1504     6388    4               THEN
     1505     6389    4               CALL WRITE_ERR(25);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:219  

   6389  6 003325   000173 236000 7                  LDQ     123
         6 003326   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003327   006570 701000 6                  TSX1    WRITE_ERR
         6 003330   000000 011000                    NOP     0
         6 003331   003457 710000 6                  TRA     s:6428

     1506     6390    4               ELSE
     1507     6391    5               DO;

     1508     6392    5                  FOUND = '0'B /*FALSE#*/;

   6392  6 003332   000010 450000 2                  STZ     FOUND

     1509     6393    6                  DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   6393  6 003333   000001 235007                    LDA     1,DL
         6 003334   000000 755000 2                  STA     I
         6 003335   003453 710000 6                  TRA     s:6426+3

     1510     6394    6                     IF OC_CONSOLE.ACTIVE(I)

   6394  6 003336   000000 236000 2                  LDQ     I
         6 003337   000076 402007                    MPY     62,DL
         6 003340   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 003341   000017 236106                    LDQ     15,QL,PR0
         6 003342   010000 316007                    CANQ    4096,DL
         6 003343   003450 600000 6                  TZE     s:6426

     1511     6395    6                     THEN
     1512     6396    6                     IF OC_CONSOLE.STATIONR.FIRST_HALF(I) =

   6396  6 003344   000000 236000 2                  LDQ     I
         6 003345   000370 402007                    MPY     248,DL
         6 003346   000000 471400 xsym               LDP1    OC_PARAM$
         6 003347   040100 106506                    CMPC    fill='040'O
         6 003350   000000 000004                    ADSC9   0,Q,PR0                  cn=0,n=4
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:220  
         6 003351   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4
         6 003352   003450 601000 6                  TNZ     s:6426

     1513     6397    6                       OC_PARAM$ -> OC$COMM.DEVICE
     1514     6398    6                     THEN
     1515     6399    6                     IF OC_CONSOLE.TERM_NAME(I) =

   6399  6 003353   040100 106506                    CMPC    fill='040'O
         6 003354   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         6 003355   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         6 003356   003450 601000 6                  TNZ     s:6426

     1516     6400    6                       OC_PARAM$ ->
     1517     6401    6                       OC$COMM.AT_TERM
     1518     6402    6                     THEN
     1519     6403    6                     IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)

   6403  6 003357   000000 236000 2                  LDQ     I
         6 003360   000076 402007                    MPY     62,DL
         6 003361   000013 220106                    LDX0    11,QL,PR0
         6 003362   002000 360003                    ANX0    1024,DU
         6 003363   003450 601000 6                  TNZ     s:6426

     1520     6404    6                       ='0'B
     1521     6405    6                     THEN
     1522     6406    7                     DO;

     1523     6407    7                        FOUND = %YES#;

   6407  6 003364   400000 236003                    LDQ     -131072,DU
         6 003365   000010 756000 2                  STQ     FOUND

     1524     6408    7                        TELL_WRITEC.SIZE =

   6408  6 003366   000000 100500                    MLR     fill='000'O
         6 003367   100006 000001                    ADSC9   6,,PR1                   cn=0,n=1
         6 003370   000115 400001 2                  ADSC9   TELL_WRITEC              cn=2,n=1
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:221  

     1525     6409    7                          OC_PARAM$ ->
     1526     6410    7                          OC$COMM.COUNT;
     1527     6411    7                        TELL_WRITEB.TEXT =

   6411  6 003371   000100 101500                    MRL     fill='000'O
         6 003372   100006 000001                    ADSC9   6,,PR1                   cn=0,n=1
         6 003373   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 003374   200612 220100                    LDX0    @MCOUNT+2,,AUTO
         6 003375   040000 100540                    MLR     fill='040'O
         6 003376   100006 200010                    ADSC9   6,,PR1                   cn=1,n=*X0
         6 003377   000121 000120 2                  ADSC9   TELL_WRITEB+3            cn=0,n=80

     1528     6412    7                          OC_PARAM$ ->
     1529     6413    7                          OC$COMM.TEXT;
     1530     6414    7                        TELL_WRITEB.TERM =

   6414  6 003400   200006 236100                    LDQ     INDEX_,,AUTO
         6 003401   000370 402007                    MPY     248,DL
         6 003402   040000 100506                    MLR     fill='040'O
         6 003403   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         6 003404   000117 000010 2                  ADSC9   TELL_WRITEB+1            cn=0,n=8

     1531     6415    7                          OC_CONSOLE.TERM_NAME(INDEX_);
     1532     6416    7                        TELL_WRITEB.CONSOLE =

   6416  6 003405   200006 236100                    LDQ     INDEX_,,AUTO
         6 003406   000076 402007                    MPY     62,DL
         6 003407   000000 236106                    LDQ     0,QL,PR0
         6 003410   000116 756000 2                  STQ     TELL_WRITEB

     1533     6417    7                          OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1534     6418    7                        MSG# = 387 /* FROMTERM_MSG# */;

   6418  6 003411   000603 220003                    LDX0    387,DU
         6 003412   000310 740000 2                  STX0    MSG#

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:222  
     1535     6419    7                        NP# = 3;

   6419  6 003413   003000 236003                    LDQ     1536,DU
         6 003414   000311 756000 2                  STQ     NP#

     1536     6420    7                        CALL OCO$IWRITE (

   6420  6 003415   000000 236000 2                  LDQ     I
         6 003416   000076 402007                    MPY     62,DL
         6 003417   000012 236106                    LDQ     10,QL,PR0
         6 003420   000022 772000                    QRL     18
         6 003421   400000 036007                    ADLQ    -131072,DL
         6 003422   000022 736000                    QLS     18
         6 003423   000022 772000                    QRL     18
         6 003424   000000 621006                    EAX1    0,QL
         6 003425   200612 741100                    STX1    @MCOUNT+2,,AUTO
         6 003426   000010 237000 7                  LDAQ    8
         6 003427   200622 757100                    STAQ    @MCOUNT+10,,AUTO
         6 003430   000174 237000 7                  LDAQ    124
         6 003431   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 003432   000176 237000 7                  LDAQ    126
         6 003433   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 003434   000003 236000 7                  LDQ     3
         6 003435   200615 756100                    STQ     @MCOUNT+5,,AUTO
         6 003436   200612 633500                    EPPR3   @MCOUNT+2,,AUTO
         6 003437   200614 453500                    STP3    @MCOUNT+4,,AUTO
         6 003440   200614 630500                    EPPR0   @MCOUNT+4,,AUTO
         6 003441   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 003442   000000 701000 xent               TSX1    OCO$IWRITE
         6 003443   000000 011000                    NOP     0

     1537     6421    7                          BINBIT(OC_CONSOLE.CID(I)+BITBIN('400000'O),18),
     1538     6422    7                          MSG#, NP#, TELL_WRITEC, TELL_WRITEB,
     1539     6423    7                          0, OCP_NON_STA, 0);
     1540     6424    7                        I = OC_MAXCONSOLE + 1 /* NUM_CONSOLES# */;

   6424  6 003444   000000 235000 xsym               LDA     OC_MAXCONSOLE
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:223  
         6 003445   000022 771000                    ARL     18
         6 003446   000001 035007                    ADLA    1,DL
         6 003447   000000 755000 2                  STA     I

     1541     6425    7                     END; /* DO IF FOUND                                         */

     1542     6426    6                  END; /* DO I                                                   */

   6426  6 003450   000000 235000 2                  LDA     I
         6 003451   000001 035007                    ADLA    1,DL
         6 003452   000000 755000 2                  STA     I
         6 003453   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         6 003454   000022 772000                    QRL     18
         6 003455   000000 116000 2                  CMPQ    I
         6 003456   003336 603000 6                  TRC     s:6394

     1543     6427    5               END; /* DO IF SIZE OKAY                                           */

     1544     6428    4               IF ~FOUND

   6428  6 003457   000010 236000 2                  LDQ     FOUND
         6 003460   400000 376003                    ANQ     -131072,DU
         6 003461   400000 676003                    ERQ     -131072,DU
         6 003462   006562 600000 6                  TZE     IGNORE

     1545     6429    4               THEN
     1546     6430    4               CALL WRITE_ERR(26);

   6430  6 003463   000171 236000 7                  LDQ     121
         6 003464   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003465   006570 701000 6                  TSX1    WRITE_ERR
         6 003466   000000 011000                    NOP     0
         6 003467   006562 710000 6                  TRA     IGNORE

     1547     6431
     1548     6432        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:224  
     1549     6433
     1550     6434    4            CASE (22 /* KEY_MSG# */);

     1551     6435         /* Blind "TELL" to system consoles                                           */
     1552     6436
     1553     6437    4               IF OC_PARAM$ -> OC$COMM.COUNT >

   6437  6 003470   000000 470400 xsym               LDP0    OC_PARAM$
         6 003471   000100 101500                    MRL     fill='000'O
         6 003472   000006 000001                    ADSC9   6,,PR0                   cn=0,n=1
         6 003473   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 003474   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 003475   000121 116007                    CMPQ    81,DL
         6 003476   003504 604000 6                  TMI     s:6443

     1554     6438    4                 SIZEC (TELL_WRITEB.TEXT)
     1555     6439    4               THEN
     1556     6440    4               CALL WRITE_ERR(25);

   6440  6 003477   000173 236000 7                  LDQ     123
         6 003500   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003501   006570 701000 6                  TSX1    WRITE_ERR
         6 003502   000000 011000                    NOP     0
         6 003503   006562 710000 6                  TRA     IGNORE

     1557     6441    4               ELSE
     1558     6442    5               DO; /* Size of text is O.K.                                       */

     1559     6443    5                  FOUND = '0'B /*FALSE#*/;

   6443  6 003504   000010 450000 2                  STZ     FOUND

     1560     6444    5                  NP# = 3;

   6444  6 003505   003000 236003                    LDQ     1536,DU
         6 003506   000311 756000 2                  STQ     NP#

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:225  
     1561     6445    5                  MSG# = 387 /* FROMTERM_MSG# */;

   6445  6 003507   000603 221003                    LDX1    387,DU
         6 003510   000310 741000 2                  STX1    MSG#

     1562     6446    5                  TELL_WRITEC.SIZE = OC_PARAM$ -> OC$COMM.COUNT;

   6446  6 003511   000000 100500                    MLR     fill='000'O
         6 003512   000006 000001                    ADSC9   6,,PR0                   cn=0,n=1
         6 003513   000115 400001 2                  ADSC9   TELL_WRITEC              cn=2,n=1

     1563     6447    5                  TELL_WRITEB.TEXT = OC_PARAM$ -> OC$COMM.TEXT;

   6447  6 003514   000100 101500                    MRL     fill='000'O
         6 003515   000006 000001                    ADSC9   6,,PR0                   cn=0,n=1
         6 003516   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 003517   200612 222100                    LDX2    @MCOUNT+2,,AUTO
         6 003520   040000 100540                    MLR     fill='040'O
         6 003521   000006 200012                    ADSC9   6,,PR0                   cn=1,n=*X2
         6 003522   000121 000120 2                  ADSC9   TELL_WRITEB+3            cn=0,n=80

     1564     6448    5                  TELL_WRITEB.TERM = OC_CONSOLE.TERM_NAME(INDEX_);

   6448  6 003523   200006 236100                    LDQ     INDEX_,,AUTO
         6 003524   000370 402007                    MPY     248,DL
         6 003525   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 003526   040000 100506                    MLR     fill='040'O
         6 003527   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         6 003530   000117 000010 2                  ADSC9   TELL_WRITEB+1            cn=0,n=8

     1565     6449    5                  TELL_WRITEB.CONSOLE =

   6449  6 003531   200006 236100                    LDQ     INDEX_,,AUTO
         6 003532   000076 402007                    MPY     62,DL
         6 003533   100000 236106                    LDQ     0,QL,PR1
         6 003534   000116 756000 2                  STQ     TELL_WRITEB

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:226  
     1566     6450    5                    OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1567     6451    6                  DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   6451  6 003535   000001 235007                    LDA     1,DL
         6 003536   000000 755000 2                  STA     I
         6 003537   003615 710000 6                  TRA     s:6470+3

     1568     6452    6                     IF OC_CONSOLE.ACTIVE(I)

   6452  6 003540   000000 236000 2                  LDQ     I
         6 003541   000076 402007                    MPY     62,DL
         6 003542   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 003543   000017 236106                    LDQ     15,QL,PR0
         6 003544   010000 316007                    CANQ    4096,DL
         6 003545   003612 600000 6                  TZE     s:6470
         6 003546   000000 236000 2                  LDQ     I
         6 003547   000076 402007                    MPY     62,DL
         6 003550   000013 220106                    LDX0    11,QL,PR0
         6 003551   002000 360003                    ANX0    1024,DU
         6 003552   003612 601000 6                  TNZ     s:6470
         6 003553   200006 236100                    LDQ     INDEX_,,AUTO
         6 003554   000000 116000 2                  CMPQ    I
         6 003555   003612 600000 6                  TZE     s:6470
         6 003556   000000 236000 2                  LDQ     I
         6 003557   000076 402007                    MPY     62,DL
         6 003560   000013 220106                    LDX0    11,QL,PR0
         6 003561   200000 360003                    ANX0    65536,DU
         6 003562   003612 600000 6                  TZE     s:6470

     1569     6453    6                       AND
     1570     6454    6                       ((OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)
     1571     6455    6                       ='0'B)
     1572     6456    6                       AND
     1573     6457    6                       (INDEX_ ~= I)
     1574     6458    6                       AND
     1575     6459    6                       (OC_CONSOLE.ATTR(I) & '200000'O /* K_SYS  */)
     1576     6460    6                     THEN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:227  
     1577     6461    7                     DO;

     1578     6462    7                        CALL OCO$IWRITE (

   6462  6 003563   000012 236106                    LDQ     10,QL,PR0
         6 003564   000022 772000                    QRL     18
         6 003565   400000 036007                    ADLQ    -131072,DL
         6 003566   000022 736000                    QLS     18
         6 003567   000022 772000                    QRL     18
         6 003570   000000 620006                    EAX0    0,QL
         6 003571   200612 740100                    STX0    @MCOUNT+2,,AUTO
         6 003572   000010 237000 7                  LDAQ    8
         6 003573   200622 757100                    STAQ    @MCOUNT+10,,AUTO
         6 003574   000174 237000 7                  LDAQ    124
         6 003575   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 003576   000176 237000 7                  LDAQ    126
         6 003577   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 003600   000003 236000 7                  LDQ     3
         6 003601   200615 756100                    STQ     @MCOUNT+5,,AUTO
         6 003602   200612 631500                    EPPR1   @MCOUNT+2,,AUTO
         6 003603   200614 451500                    STP1    @MCOUNT+4,,AUTO
         6 003604   200614 630500                    EPPR0   @MCOUNT+4,,AUTO
         6 003605   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 003606   000000 701000 xent               TSX1    OCO$IWRITE
         6 003607   000000 011000                    NOP     0

     1579     6463    7                          BINBIT(OC_CONSOLE.CID(I)+
     1580     6464    7                          BITBIN('400000'O),18),
     1581     6465    7                          MSG#, NP#, TELL_WRITEC,
     1582     6466    7                          TELL_WRITEB, 0, OCP_NON_STA,
     1583     6467    7                          0);
     1584     6468    7                        FOUND = '1'B /*TRUE#*/;

   6468  6 003610   400000 236003                    LDQ     -131072,DU
         6 003611   000010 756000 2                  STQ     FOUND

     1585     6469    7                     END; /* DO IF CONS O.K.                                     */
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:228  

     1586     6470    6                  END; /* DO I                                                   */

   6470  6 003612   000000 235000 2                  LDA     I
         6 003613   000001 035007                    ADLA    1,DL
         6 003614   000000 755000 2                  STA     I
         6 003615   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         6 003616   000022 772000                    QRL     18
         6 003617   000000 116000 2                  CMPQ    I
         6 003620   003540 603000 6                  TRC     s:6452

     1587     6471
     1588     6472    5                  IF ~FOUND

   6472  6 003621   000010 236000 2                  LDQ     FOUND
         6 003622   400000 376003                    ANQ     -131072,DU
         6 003623   400000 676003                    ERQ     -131072,DU
         6 003624   006562 600000 6                  TZE     IGNORE

     1589     6473    5                  THEN
     1590     6474    5                  CALL WRITE_ERR (27);

   6474  6 003625   000201 236000 7                  LDQ     129
         6 003626   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003627   006570 701000 6                  TSX1    WRITE_ERR
         6 003630   000000 011000                    NOP     0

     1591     6475
     1592     6476    5               END; /* DO IF SIZE OKAY                                           */

   6476  6 003631   006562 710000 6                  TRA     IGNORE

     1593     6477
     1594     6478        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:229  
     1595     6479
     1596     6480    4            CASE (20 /* KEY_TELLALL# */);

     1597     6481
     1598     6482    4               FOUND = '0'B /*FALSE#*/;

   6482  6 003632   000010 450000 2                  STZ     FOUND

     1599     6483
     1600     6484    4               IF OC_PARAM$ -> OC$COMM.COUNT >

   6484  6 003633   000000 470400 xsym               LDP0    OC_PARAM$
         6 003634   000100 101500                    MRL     fill='000'O
         6 003635   000006 000001                    ADSC9   6,,PR0                   cn=0,n=1
         6 003636   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 003637   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 003640   000121 116007                    CMPQ    81,DL
         6 003641   003647 604000 6                  TMI     s:6490

     1601     6485    4                 SIZEC (TELL_WRITEB.TEXT)
     1602     6486    4               THEN
     1603     6487    4               CALL WRITE_ERR(25);

   6487  6 003642   000173 236000 7                  LDQ     123
         6 003643   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003644   006570 701000 6                  TSX1    WRITE_ERR
         6 003645   000000 011000                    NOP     0
         6 003646   006562 710000 6                  TRA     IGNORE

     1604     6488    4               ELSE
     1605     6489    5               DO;

     1606     6490    5                  NP# = 3;

   6490  6 003647   003000 236003                    LDQ     1536,DU
         6 003650   000311 756000 2                  STQ     NP#

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:230  
     1607     6491    5                  MSG# = 387 /* FROMTERM_MSG# */;

   6491  6 003651   000603 221003                    LDX1    387,DU
         6 003652   000310 741000 2                  STX1    MSG#

     1608     6492    5                  TELL_WRITEC.SIZE = OC_PARAM$ -> OC$COMM.COUNT;

   6492  6 003653   000000 100500                    MLR     fill='000'O
         6 003654   000006 000001                    ADSC9   6,,PR0                   cn=0,n=1
         6 003655   000115 400001 2                  ADSC9   TELL_WRITEC              cn=2,n=1

     1609     6493    5                  TELL_WRITEB.TEXT = OC_PARAM$ -> OC$COMM.TEXT;

   6493  6 003656   000100 101500                    MRL     fill='000'O
         6 003657   000006 000001                    ADSC9   6,,PR0                   cn=0,n=1
         6 003660   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 003661   200612 222100                    LDX2    @MCOUNT+2,,AUTO
         6 003662   040000 100540                    MLR     fill='040'O
         6 003663   000006 200012                    ADSC9   6,,PR0                   cn=1,n=*X2
         6 003664   000121 000120 2                  ADSC9   TELL_WRITEB+3            cn=0,n=80

     1610     6494    5                  TELL_WRITEB.TERM = OC_CONSOLE.TERM_NAME(INDEX_);

   6494  6 003665   200006 236100                    LDQ     INDEX_,,AUTO
         6 003666   000370 402007                    MPY     248,DL
         6 003667   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 003670   040000 100506                    MLR     fill='040'O
         6 003671   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         6 003672   000117 000010 2                  ADSC9   TELL_WRITEB+1            cn=0,n=8

     1611     6495    5                  TELL_WRITEB.CONSOLE =

   6495  6 003673   200006 236100                    LDQ     INDEX_,,AUTO
         6 003674   000076 402007                    MPY     62,DL
         6 003675   100000 236106                    LDQ     0,QL,PR1
         6 003676   000116 756000 2                  STQ     TELL_WRITEB

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:231  
     1612     6496    5                    OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1613     6497    6                  DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   6497  6 003677   000001 235007                    LDA     1,DL
         6 003700   000000 755000 2                  STA     I
         6 003701   003754 710000 6                  TRA     s:6514+3

     1614     6498    6                     IF OC_CONSOLE.ACTIVE(I)

   6498  6 003702   000000 236000 2                  LDQ     I
         6 003703   000076 402007                    MPY     62,DL
         6 003704   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 003705   000017 236106                    LDQ     15,QL,PR0
         6 003706   010000 316007                    CANQ    4096,DL
         6 003707   003751 600000 6                  TZE     s:6514

     1615     6499    6                     THEN
     1616     6500    6                     IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)

   6500  6 003710   000000 236000 2                  LDQ     I
         6 003711   000076 402007                    MPY     62,DL
         6 003712   000013 220106                    LDX0    11,QL,PR0
         6 003713   002000 360003                    ANX0    1024,DU
         6 003714   003751 601000 6                  TNZ     s:6514

     1617     6501    6                       ='0'B
     1618     6502    6                     THEN
     1619     6503    6                     IF INDEX_ ~= I

   6503  6 003715   200006 236100                    LDQ     INDEX_,,AUTO
         6 003716   000000 116000 2                  CMPQ    I
         6 003717   003751 600000 6                  TZE     s:6514

     1620     6504    6                     THEN
     1621     6505    7                     DO;

     1622     6506    7                        CALL OCO$IWRITE (
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:232  

   6506  6 003720   000000 236000 2                  LDQ     I
         6 003721   000076 402007                    MPY     62,DL
         6 003722   000012 236106                    LDQ     10,QL,PR0
         6 003723   000022 772000                    QRL     18
         6 003724   400000 036007                    ADLQ    -131072,DL
         6 003725   000022 736000                    QLS     18
         6 003726   000022 772000                    QRL     18
         6 003727   000000 620006                    EAX0    0,QL
         6 003730   200612 740100                    STX0    @MCOUNT+2,,AUTO
         6 003731   000010 237000 7                  LDAQ    8
         6 003732   200622 757100                    STAQ    @MCOUNT+10,,AUTO
         6 003733   000174 237000 7                  LDAQ    124
         6 003734   200620 757100                    STAQ    @MCOUNT+8,,AUTO
         6 003735   000176 237000 7                  LDAQ    126
         6 003736   200616 757100                    STAQ    @MCOUNT+6,,AUTO
         6 003737   000003 236000 7                  LDQ     3
         6 003740   200615 756100                    STQ     @MCOUNT+5,,AUTO
         6 003741   200612 631500                    EPPR1   @MCOUNT+2,,AUTO
         6 003742   200614 451500                    STP1    @MCOUNT+4,,AUTO
         6 003743   200614 630500                    EPPR0   @MCOUNT+4,,AUTO
         6 003744   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 003745   000000 701000 xent               TSX1    OCO$IWRITE
         6 003746   000000 011000                    NOP     0

     1623     6507    7                          BINBIT(OC_CONSOLE.CID(I)+
     1624     6508    7                          BITBIN('400000'O),18),
     1625     6509    7                          MSG#, NP#, TELL_WRITEC,
     1626     6510    7                          TELL_WRITEB, 0,
     1627     6511    7                          OCP_NON_STA, 0);
     1628     6512    7                        FOUND = '1'B /*TRUE#*/;

   6512  6 003747   400000 236003                    LDQ     -131072,DU
         6 003750   000010 756000 2                  STQ     FOUND

     1629     6513    7                     END; /* DO IF GOOD CONS                                     */

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:233  
     1630     6514    6                  END; /* DO I                                                   */

   6514  6 003751   000000 235000 2                  LDA     I
         6 003752   000001 035007                    ADLA    1,DL
         6 003753   000000 755000 2                  STA     I
         6 003754   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         6 003755   000022 772000                    QRL     18
         6 003756   000000 116000 2                  CMPQ    I
         6 003757   003702 603000 6                  TRC     s:6498

     1631     6515    5                  IF ~FOUND

   6515  6 003760   000010 236000 2                  LDQ     FOUND
         6 003761   400000 376003                    ANQ     -131072,DU
         6 003762   400000 676003                    ERQ     -131072,DU
         6 003763   006562 600000 6                  TZE     IGNORE

     1632     6516    5                  THEN
     1633     6517    5                  CALL WRITE_ERR(27);

   6517  6 003764   000201 236000 7                  LDQ     129
         6 003765   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 003766   006570 701000 6                  TSX1    WRITE_ERR
         6 003767   000000 011000                    NOP     0

     1634     6518    5               END; /* DO IF SIZE OKAY                                           */

   6518  6 003770   006562 710000 6                  TRA     IGNORE

     1635     6519
     1636     6520        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:234  
     1637     6521
     1638     6522    4            CASE (15 /* KEY_INFO# */);

     1639     6523
     1640     6524    4               CALL M$DISPLAY(GET_INFO);

   6524  6 003771   000546 630400 2                  EPPR0   GET_INFO
         6 003772   020007 713400                    CLIMB   8199
         6 003773   400000 401760                    pmme    nvectors=1

     1641     6525
     1642     6526    4               MSG# = 397 /* INFO_MSG# */;

   6526  6 003774   000615 220003                    LDX0    397,DU
         6 003775   000310 740000 2                  STX0    MSG#

     1643     6527    4               NP# = 2;

   6527  6 003776   002000 236003                    LDQ     1024,DU
         6 003777   000311 756000 2                  STQ     NP#

     1644     6528
     1645     6529    5               DO I = 0 TO 3;

   6529  6 004000   000000 450000 2                  STZ     I

     1646     6530
     1647     6531    6                  DO CASE (I);

   6531  6 004001   000000 235000 2                  LDA     I
         6 004002   000003 115007                    CMPA    3,DL
         6 004003   004005 602005 6                  TNC     s:6531+4,AL
         6 004004   004023 710000 6                  TRA     s:6542
         6 004005   004020 710000 6                  TRA     s:6539
         6 004006   004010 710000 6                  TRA     s:6535
         6 004007   004014 710000 6                  TRA     s:6537

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:235  
     1648     6532    6                  CASE (3);

     1649     6533    6                     ;
     1650     6534    6                  CASE (1);

     1651     6535    6                     INFO_WRITEB.INFO = INFO_ARRAY.ETMF;

   6535  6 004010   000000 100400                    MLR     fill='000'O
         6 004011   000551 000004 2                  ADSC9   INFO_ARRAY+1             cn=0,n=4
         6 004012   000113 200004 2                  ADSC9   INFO_WRITEB              cn=1,n=4
         6 004013   004023 710000 6                  TRA     s:6542

     1652     6536    6                  CASE(2);

     1653     6537    6                     INFO_WRITEB.INFO = INFO_ARRAY.RESP;

   6537  6 004014   000000 100400                    MLR     fill='000'O
         6 004015   000552 000004 2                  ADSC9   INFO_ARRAY+2             cn=0,n=4
         6 004016   000113 200004 2                  ADSC9   INFO_WRITEB              cn=1,n=4
         6 004017   004023 710000 6                  TRA     s:6542

     1654     6538    6                  CASE (0);

     1655     6539    6                     INFO_WRITEB.INFO = INFO_ARRAY.USERS;

   6539  6 004020   000000 100400                    MLR     fill='000'O
         6 004021   000550 000004 2                  ADSC9   INFO_ARRAY               cn=0,n=4
         6 004022   000113 200004 2                  ADSC9   INFO_WRITEB              cn=1,n=4

     1656     6540    6                  END; /* CASE (I)                                               */

     1657     6541
     1658     6542    5                  INFO_WRITEB.CODE = I;

   6542  6 004023   000000 236000 2                  LDQ     I
         6 004024   000033 736000                    QLS     27
         6 004025   000113 552040 2                  STBQ    INFO_WRITEB,'40'O
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:236  

     1659     6543
     1660     6544    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   6544  6 004026   000202 630400 7                  EPPR0   130
         6 004027   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 004030   000000 701000 xent               TSX1    OCO$IWRITE
         6 004031   000000 011000                    NOP     0

     1661     6545    5                    INFO_WRITEC, INFO_WRITEB, 0,
     1662     6546    5                    OCP_NON_STA, 0);
     1663     6547    5               END; /* DO I = 0 TO N                                             */

   6547  6 004032   000000 235000 2                  LDA     I
         6 004033   000001 035007                    ADLA    1,DL
         6 004034   000000 755000 2                  STA     I
         6 004035   000004 115007                    CMPA    4,DL
         6 004036   004001 602000 6                  TNC     s:6531
         6 004037   006562 710000 6                  TRA     IGNORE

     1664     6548
     1665     6549        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:237  
     1666     6550
     1667     6551    4            CASE (13 /* KEY_CONS# */); /* Handle request to display

     1668     6552         currently logged-on
     1669     6553         consoles                                                                     */
     1670     6554    4               NP# = 30;

   6554  6 004040   036000 236003                    LDQ     15360,DU
         6 004041   000311 756000 2                  STQ     NP#

     1671     6555    4               MSG# = 398 /* CONSOLE_MSG# */;

   6555  6 004042   000616 221003                    LDX1    398,DU
         6 004043   000310 741000 2                  STX1    MSG#

     1672     6556
     1673     6557    5               DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   6557  6 004044   000001 235007                    LDA     1,DL
         6 004045   000000 755000 2                  STA     I
         6 004046   004262 710000 6                  TRA     s:6614+3

     1674     6558
     1675     6559    5                  IF OC_CONSOLE.ACTIVE(I)

   6559  6 004047   000000 236000 2                  LDQ     I
         6 004050   000076 402007                    MPY     62,DL
         6 004051   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 004052   000017 236106                    LDQ     15,QL,PR0
         6 004053   010000 316007                    CANQ    4096,DL
         6 004054   004257 600000 6                  TZE     s:6614

     1676     6560    5                  THEN
     1677     6561    5                  IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)='0'B /*FALSE#*/

   6561  6 004055   000000 236000 2                  LDQ     I
         6 004056   000076 402007                    MPY     62,DL
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:238  
         6 004057   000013 220106                    LDX0    11,QL,PR0
         6 004060   002000 360003                    ANX0    1024,DU
         6 004061   004257 601000 6                  TNZ     s:6614

     1678     6562    5                  THEN
     1679     6563    6                  DO;

     1680     6564    6                     STATS_WRITEB.NAME =

   6564  6 004062   000000 236000 2                  LDQ     I
         6 004063   000370 402007                    MPY     248,DL
         6 004064   040000 100506                    MLR     fill='040'O
         6 004065   000000 000004                    ADSC9   0,Q,PR0                  cn=0,n=4
         6 004066   000235 600004 2                  ADSC9   STATS_WRITEB+9           cn=3,n=4

     1681     6565    6                       OC_CONSOLE.STATIONR.FIRST_HALF(I);
     1682     6566    6                     STATS_WRITEB.TERM =

   6566  6 004067   040000 100506                    MLR     fill='040'O
         6 004070   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         6 004071   000240 600010 2                  ADSC9   STATS_WRITEB+12          cn=3,n=8

     1683     6567    6                       OC_CONSOLE.TERM_NAME(I);
     1684     6568
     1685     6569    6                     STATS_WRITEB.LGN =

   6569  6 004072   040000 100506                    MLR     fill='040'O
         6 004073   000006 000010                    ADSC9   6,Q,PR0                  cn=0,n=8
         6 004074   000236 600010 2                  ADSC9   STATS_WRITEB+10          cn=3,n=8

     1686     6570    6                       OC_CONSOLE.LOGON(I);
     1687     6571
     1688     6572    6                     STATS_WRITEB.WSN = OC_CONSOLE.WSN(I);

   6572  6 004075   040000 100506                    MLR     fill='040'O
         6 004076   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         6 004077   000242 600010 2                  ADSC9   STATS_WRITEB+14          cn=3,n=8
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:239  

     1689     6573    6                     IF I = INDEX_

   6573  6 004100   000000 236000 2                  LDQ     I
         6 004101   200006 116100                    CMPQ    INDEX_,,AUTO
         6 004102   004106 601000 6                  TNZ     s:6577

     1690     6574    6                     THEN
     1691     6575    6                     STATS_WRITEB.SUB_MESS# = 1;

   6575  6 004103   001000 236003                    LDQ     512,DU
         6 004104   000224 552040 2                  STBQ    STATS_WRITEB,'40'O
         6 004105   004110 710000 6                  TRA     s:6579

     1692     6576    6                     ELSE
     1693     6577    6                     STATS_WRITEB.SUB_MESS# = 0;

   6577  6 004106   000000 236003                    LDQ     0,DU
         6 004107   000224 552040 2                  STBQ    STATS_WRITEB,'40'O

     1694     6578
     1695     6579    6                     STATS_WRITEB.MXPRIO = OC_CONSOLE.MXPRIO (I);

   6579  6 004110   000000 236000 2                  LDQ     I
         6 004111   000076 402007                    MPY     62,DL
         6 004112   000075 236106                    LDQ     61,QL,PR0
         6 004113   000022 772000                    QRL     18
         6 004114   000232 552010 2                  STBQ    STATS_WRITEB+6,'10'O

     1696     6580
     1697     6581    6                     STATS_WRITEB.I_SYS = OC_CONSOLE.ATTR_INPUT (I) & '200000'O
              6581                              /* M_SYS  */;

   6581  6 004115   000000 236000 2                  LDQ     I
         6 004116   000076 402007                    MPY     62,DL
         6 004117   000013 220106                    LDX0    11,QL,PR0
         6 004120   200000 360003                    ANX0    65536,DU
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:240  
         6 004121   000000 636010                    EAQ     0,X0
         6 004122   000033 772000                    QRL     27
         6 004123   000232 552004 2                  STBQ    STATS_WRITEB+6,'04'O

     1698     6582
     1699     6583    6                     STATS_WRITEB.I_DEV = OC_CONSOLE.ATTR_INPUT (I) & '100000'O
              6583                              /* M_DEVC  */;

   6583  6 004124   000000 236000 2                  LDQ     I
         6 004125   000076 402007                    MPY     62,DL
         6 004126   000013 220106                    LDX0    11,QL,PR0
         6 004127   100000 360003                    ANX0    32768,DU
         6 004130   000000 636010                    EAQ     0,X0
         6 004131   000233 552040 2                  STBQ    STATS_WRITEB+7,'40'O

     1700     6584
     1701     6585    6                     STATS_WRITEB.I_ADMN = OC_CONSOLE.ATTR_INPUT (I) & '040000'O
              6585                              /* M_ADMIN */;

   6585  6 004132   000000 236000 2                  LDQ     I
         6 004133   000076 402007                    MPY     62,DL
         6 004134   000013 220106                    LDX0    11,QL,PR0
         6 004135   040000 360003                    ANX0    16384,DU
         6 004136   000000 636010                    EAQ     0,X0
         6 004137   000011 772000                    QRL     9
         6 004140   000233 552020 2                  STBQ    STATS_WRITEB+7,'20'O

     1702     6586
     1703     6587    6                     STATS_WRITEB.I_DLTA = OC_CONSOLE.ATTR_INPUT (I) & '020000'O
              6587                              /* M_DLTA  */;

   6587  6 004141   000000 236000 2                  LDQ     I
         6 004142   000076 402007                    MPY     62,DL
         6 004143   000013 220106                    LDX0    11,QL,PR0
         6 004144   020000 360003                    ANX0    8192,DU
         6 004145   000000 636010                    EAQ     0,X0
         6 004146   000022 772000                    QRL     18
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:241  
         6 004147   000233 552010 2                  STBQ    STATS_WRITEB+7,'10'O

     1704     6588
     1705     6589    6                     STATS_WRITEB.I_LIB = OC_CONSOLE.ATTR_INPUT (I) & '010000'O
              6589                              /* M_LIBRN */;

   6589  6 004150   000000 236000 2                  LDQ     I
         6 004151   000076 402007                    MPY     62,DL
         6 004152   000013 220106                    LDX0    11,QL,PR0
         6 004153   010000 360003                    ANX0    4096,DU
         6 004154   000000 636010                    EAQ     0,X0
         6 004155   000033 772000                    QRL     27
         6 004156   000233 552004 2                  STBQ    STATS_WRITEB+7,'04'O

     1706     6590
     1707     6591    6                     STATS_WRITEB.I_COMM = OC_CONSOLE.ATTR_INPUT (I) & '004000'O
              6591                              /* M_COMM */;

   6591  6 004157   000000 236000 2                  LDQ     I
         6 004160   000076 402007                    MPY     62,DL
         6 004161   000013 220106                    LDX0    11,QL,PR0
         6 004162   004000 360003                    ANX0    2048,DU
         6 004163   000000 636010                    EAQ     0,X0
         6 004164   000234 552040 2                  STBQ    STATS_WRITEB+8,'40'O

     1708     6592
     1709     6593    6                     STATS_WRITEB.I_TP = OC_CONSOLE.ATTR_INPUT (I) & '001000'O
              6593                              /* M_TP */;

   6593  6 004165   000000 236000 2                  LDQ     I
         6 004166   000076 402007                    MPY     62,DL
         6 004167   000013 220106                    LDX0    11,QL,PR0
         6 004170   001000 360003                    ANX0    512,DU
         6 004171   000000 636010                    EAQ     0,X0
         6 004172   000033 772000                    QRL     27
         6 004173   000251 552004 2                  STBQ    STATS_WRITEB+21,'04'O

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:242  
     1710     6594
     1711     6595    6                     STATS_WRITEB.O_SYS = OC_CONSOLE.ATTR_OUTPUT (I) & '200000'O
              6595                              /* M_SYS  */;

   6595  6 004174   000000 236000 2                  LDQ     I
         6 004175   000076 402007                    MPY     62,DL
         6 004176   000014 220106                    LDX0    12,QL,PR0
         6 004177   200000 360003                    ANX0    65536,DU
         6 004200   000000 636010                    EAQ     0,X0
         6 004201   000011 772000                    QRL     9
         6 004202   000234 552020 2                  STBQ    STATS_WRITEB+8,'20'O

     1712     6596
     1713     6597    6                     STATS_WRITEB.O_DEV = OC_CONSOLE.ATTR_OUTPUT (I) & '100000'O
              6597                              /* M_DEVC  */;

   6597  6 004203   000000 236000 2                  LDQ     I
         6 004204   000076 402007                    MPY     62,DL
         6 004205   000014 220106                    LDX0    12,QL,PR0
         6 004206   100000 360003                    ANX0    32768,DU
         6 004207   000000 636010                    EAQ     0,X0
         6 004210   000022 772000                    QRL     18
         6 004211   000234 552010 2                  STBQ    STATS_WRITEB+8,'10'O

     1714     6598
     1715     6599    6                     STATS_WRITEB.O_ADMN = OC_CONSOLE.ATTR_OUTPUT (I) & '040000'O
              6599                              /* M_ADMIN */;

   6599  6 004212   000000 236000 2                  LDQ     I
         6 004213   000076 402007                    MPY     62,DL
         6 004214   000014 220106                    LDX0    12,QL,PR0
         6 004215   040000 360003                    ANX0    16384,DU
         6 004216   000000 636010                    EAQ     0,X0
         6 004217   000033 772000                    QRL     27
         6 004220   000234 552004 2                  STBQ    STATS_WRITEB+8,'04'O

     1716     6600
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:243  
     1717     6601    6                     STATS_WRITEB.O_DLTA = OC_CONSOLE.ATTR_OUTPUT (I) & '020000'O
              6601                              /* M_DLTA  */;

   6601  6 004221   000000 236000 2                  LDQ     I
         6 004222   000076 402007                    MPY     62,DL
         6 004223   000014 220106                    LDX0    12,QL,PR0
         6 004224   020000 360003                    ANX0    8192,DU
         6 004225   000000 636010                    EAQ     0,X0
         6 004226   000235 552040 2                  STBQ    STATS_WRITEB+9,'40'O

     1718     6602
     1719     6603    6                     STATS_WRITEB.O_LIB = OC_CONSOLE.ATTR_OUTPUT (I) & '010000'O
              6603                              /* M_LIBRN */;

   6603  6 004227   000000 236000 2                  LDQ     I
         6 004230   000076 402007                    MPY     62,DL
         6 004231   000014 220106                    LDX0    12,QL,PR0
         6 004232   010000 360003                    ANX0    4096,DU
         6 004233   000000 636010                    EAQ     0,X0
         6 004234   000011 772000                    QRL     9
         6 004235   000235 552020 2                  STBQ    STATS_WRITEB+9,'20'O

     1720     6604
     1721     6605    6                     STATS_WRITEB.O_COMM = OC_CONSOLE.ATTR_OUTPUT (I) & '004000'O
              6605                              /* M_COMM */;

   6605  6 004236   000000 236000 2                  LDQ     I
         6 004237   000076 402007                    MPY     62,DL
         6 004240   000014 220106                    LDX0    12,QL,PR0
         6 004241   004000 360003                    ANX0    2048,DU
         6 004242   000000 636010                    EAQ     0,X0
         6 004243   000022 772000                    QRL     18
         6 004244   000235 552010 2                  STBQ    STATS_WRITEB+9,'10'O

     1722     6606
     1723     6607    6                     STATS_WRITEB.O_TP = OC_CONSOLE.ATTR_OUTPUT (I) & '001000'O
              6607                              /* M_TP */;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:244  

   6607  6 004245   000000 236000 2                  LDQ     I
         6 004246   000076 402007                    MPY     62,DL
         6 004247   000014 220106                    LDX0    12,QL,PR0
         6 004250   001000 360003                    ANX0    512,DU
         6 004251   000000 636010                    EAQ     0,X0
         6 004252   000252 552040 2                  STBQ    STATS_WRITEB+22,'40'O

     1724     6608
     1725     6609    6                     CALL OCO$IWRITE(OC_CADDR, MSG#, NP#,

   6609  6 004253   000212 630400 7                  EPPR0   138
         6 004254   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 004255   000000 701000 xent               TSX1    OCO$IWRITE
         6 004256   000000 011000                    NOP     0

     1726     6610    6                       STATS_WRITEC, STATS_WRITEB, 0,
     1727     6611    6                       OCP_NON_STA, 0);
     1728     6612
     1729     6613    6                  END; /* DO IF FOUND                                            */

     1730     6614    5               END; /* DO I                                                      */

   6614  6 004257   000000 235000 2                  LDA     I
         6 004260   000001 035007                    ADLA    1,DL
         6 004261   000000 755000 2                  STA     I
         6 004262   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         6 004263   000022 772000                    QRL     18
         6 004264   000000 116000 2                  CMPQ    I
         6 004265   004047 603000 6                  TRC     s:6559
         6 004266   006562 710000 6                  TRA     IGNORE

     1731     6615
     1732     6616        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:245  
     1733     6617
     1734     6618    4            CASE (14 /* KEY_MAST# */);

     1735     6619         /* Handle request to display
     1736     6620              Master terminal names                                                   */
     1737     6621    4               FOUND = '0'B /*FALSE#*/;

   6621  6 004267   000010 450000 2                  STZ     FOUND

     1738     6622    4               NP# = 1;

   6622  6 004270   001000 236003                    LDQ     512,DU
         6 004271   000311 756000 2                  STQ     NP#

     1739     6623    4               MSG# = 399 /* MASTER_MSG# */;

   6623  6 004272   000617 221003                    LDX1    399,DU
         6 004273   000310 741000 2                  STX1    MSG#

     1740     6624
     1741     6625    5               DO I = 1 TO OC_MAXCONSOLE /* MAX_CONSOLES# */;

   6625  6 004274   000001 235007                    LDA     1,DL
         6 004275   000000 755000 2                  STA     I
         6 004276   004330 710000 6                  TRA     s:6640+3

     1742     6626
     1743     6627    5                  IF OC_CONSOLE.ACTIVE(I)

   6627  6 004277   000000 236000 2                  LDQ     I
         6 004300   000076 402007                    MPY     62,DL
         6 004301   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 004302   000017 236106                    LDQ     15,QL,PR0
         6 004303   010000 316007                    CANQ    4096,DL
         6 004304   004325 600000 6                  TZE     s:6640

     1744     6628    5                  THEN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:246  
     1745     6629    5                  IF (OC_CONSOLE.ATTR(I) & '002000'O /* K_SLAVE */)

   6629  6 004305   000000 236000 2                  LDQ     I
         6 004306   000076 402007                    MPY     62,DL
         6 004307   000013 220106                    LDX0    11,QL,PR0
         6 004310   002000 360003                    ANX0    1024,DU
         6 004311   004325 600000 6                  TZE     s:6640

     1746     6630    5                    ~= '0'B /*FALSE#*/
     1747     6631    5                  THEN
     1748     6632    6                  DO;

     1749     6633    6                     MSTR_WRITEB.TERM_NAME =

   6633  6 004312   000000 236000 2                  LDQ     I
         6 004313   000370 402007                    MPY     248,DL
         6 004314   040000 100506                    MLR     fill='040'O
         6 004315   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         6 004316   000306 000010 2                  ADSC9   MSTR_WRITEB              cn=0,n=8

     1750     6634    6                       OC_CONSOLE.TERM_NAME(I);
     1751     6635    6                     CALL OCO$IWRITE(OC_CADDR,MSG#, NP#,

   6635  6 004317   000222 630400 7                  EPPR0   146
         6 004320   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 004321   000000 701000 xent               TSX1    OCO$IWRITE
         6 004322   000000 011000                    NOP     0

     1752     6636    6                       MSTR_WRITEC, MSTR_WRITEB, 0,
     1753     6637    6                       OCP_NON_STA, 0);
     1754     6638    6                     FOUND = '1'B /*TRUE#*/;

   6638  6 004323   400000 236003                    LDQ     -131072,DU
         6 004324   000010 756000 2                  STQ     FOUND

     1755     6639    6                  END; /* DO IF FOUND                                            */

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:247  
     1756     6640    5               END; /* DO I                                                      */

   6640  6 004325   000000 235000 2                  LDA     I
         6 004326   000001 035007                    ADLA    1,DL
         6 004327   000000 755000 2                  STA     I
         6 004330   000000 236000 xsym               LDQ     OC_MAXCONSOLE
         6 004331   000022 772000                    QRL     18
         6 004332   000000 116000 2                  CMPQ    I
         6 004333   004277 603000 6                  TRC     s:6627

     1757     6641    4               IF ~FOUND

   6641  6 004334   000010 236000 2                  LDQ     FOUND
         6 004335   400000 376003                    ANQ     -131072,DU
         6 004336   400000 676003                    ERQ     -131072,DU
         6 004337   006562 600000 6                  TZE     IGNORE

     1758     6642    4               THEN
     1759     6643    4               CALL WRITE_ERR(24);

   6643  6 004340   000233 236000 7                  LDQ     155
         6 004341   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 004342   006570 701000 6                  TSX1    WRITE_ERR
         6 004343   000000 011000                    NOP     0
         6 004344   006562 710000 6                  TRA     IGNORE

     1760     6644
     1761     6645        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:248  
     1762     6646    4            CASE (24 /* KEY_HISTON# */);

     1763     6647         /* HISTORY LOGGING ON REQUEST                                                */
     1764     6648    4               CALL OCL$HON (OC_CADDR);

   6648  6 004345   000014 630400 7                  EPPR0   12
         6 004346   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004347   000000 701000 xent               TSX1    OCL$HON
         6 004350   000000 011000                    NOP     0
         6 004351   006562 710000 6                  TRA     IGNORE

     1765     6649
     1766     6650
     1767     6651    4            CASE (25 /* KEY_HISTOFF# */);

     1768     6652         /* HISTORY LOGGING OFF REQUEST                                               */
     1769     6653    4               CALL OCL$HOFF (OC_CADDR);

   6653  6 004352   000014 630400 7                  EPPR0   12
         6 004353   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004354   000000 701000 xent               TSX1    OCL$HOFF
         6 004355   000000 011000                    NOP     0
         6 004356   006562 710000 6                  TRA     IGNORE

     1770     6654
     1771     6655
     1772     6656    4            CASE (26 /* KEY_RELEASE# */);

     1773     6657         /* REQUEST TO RELEASE FILE AND START ANEW                                    */
     1774     6658    4               CALL OCL$RLS (OC_CADDR, OC_PARAM$ -> OC$MESSAGE.TEXT);

   6658  6 004357   000000 236000 xsym               LDQ     OC_PARAM$
         6 004360   000001 036003                    ADLQ    1,DU
         6 004361   000014 235000 7                  LDA     12
         6 004362   200612 757100                    STAQ    @MCOUNT+2,,AUTO
         6 004363   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 004364   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:249  
         6 004365   000000 701000 xent               TSX1    OCL$RLS
         6 004366   000000 011000                    NOP     0
         6 004367   006562 710000 6                  TRA     IGNORE

     1775     6659
     1776     6660        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:250  
     1777     6661
     1778     6662    4            CASE (27 /* KEY_XEQ# */);

     1779     6663         /* REQUEST FOR A READ FILE                                                   */
     1780     6664    4               CALL OCR$SREAD (INDEX_, OC_PARAM$ -> OC$MESSAGE.TEXT);

   6664  6 004370   000000 236000 xsym               LDQ     OC_PARAM$
         6 004371   000001 036003                    ADLQ    1,DU
         6 004372   200613 756100                    STQ     @MCOUNT+3,,AUTO
         6 004373   200006 630500                    EPPR0   INDEX_,,AUTO
         6 004374   200612 450500                    STP0    @MCOUNT+2,,AUTO
         6 004375   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 004376   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 004377   000000 701000 xent               TSX1    OCR$SREAD
         6 004400   000000 011000                    NOP     0
         6 004401   006562 710000 6                  TRA     IGNORE

     1781     6665
     1782     6666    4            CASE (28 /* KEY_CANXEQ# */);

     1783     6667    4               CALL OCR$CREAD(INDEX_);

   6667  6 004402   200006 630500                    EPPR0   INDEX_,,AUTO
         6 004403   200612 450500                    STP0    @MCOUNT+2,,AUTO
         6 004404   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 004405   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004406   000000 701000 xent               TSX1    OCR$CREAD
         6 004407   000000 011000                    NOP     0
         6 004410   006562 710000 6                  TRA     IGNORE

     1784     6668
     1785     6669    4            CASE (38 /* KEY_XEQAR# */);

     1786     6670    4               OC_DEF_ACCT = ':SYS    ';

   6670  6 004411   000064 237000 4                  LDAQ    GET_LADC_FLAG+20
         6 004412   000000 755000 xsym               STA     OC_DEF_ACCT
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:251  
         6 004413   000001 756000 xsym               STQ     OC_DEF_ACCT+1
         6 004414   006562 710000 6                  TRA     IGNORE

     1787     6671
     1788     6672    4            CASE (37 /* KEY_MYXEQR# */);

     1789     6673    4               OC_CONSOLE.ACCT(INDEX_) = '        ';

   6673  6 004415   200006 236100                    LDQ     INDEX_,,AUTO
         6 004416   000076 402007                    MPY     62,DL
         6 004417   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 004420   000000 621006                    EAX1    0,QL
         6 004421   000000 622006                    EAX2    0,QL
         6 004422   000054 237000 4                  LDAQ    GET_LADC_FLAG+12
         6 004423   000020 755111                    STA     16,X1,PR0
         6 004424   000021 756112                    STQ     17,X2,PR0
         6 004425   006562 710000 6                  TRA     IGNORE

     1790     6674
     1791     6675    4            CASE (29 /* KEY_XEQA# */);

     1792     6676    4               OC_DEF_ACCT = OC_PARAM$ -> OC$SETACCT.ACCT;

   6676  6 004426   000000 470400 xsym               LDP0    OC_PARAM$
         6 004427   040000 100500                    MLR     fill='040'O
         6 004430   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 004431   000000 000010 xsym               ADSC9   OC_DEF_ACCT              cn=0,n=8
         6 004432   006562 710000 6                  TRA     IGNORE

     1793     6677
     1794     6678    4            CASE (30 /* KEY_MYXEQ# */);

     1795     6679    4               OC_CONSOLE.ACCT(INDEX_) = OC_PARAM$ -> OC$SETACCT.ACCT;

   6679  6 004433   200006 236100                    LDQ     INDEX_,,AUTO
         6 004434   000076 402007                    MPY     62,DL
         6 004435   000002 736000                    QLS     2
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:252  
         6 004436   000000 470400 xsym               LDP0    OC_PARAM$
         6 004437   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 004440   040106 100500                    MLR     fill='040'O
         6 004441   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 004442   100020 000010                    ADSC9   16,Q,PR1                 cn=0,n=8
         6 004443   006562 710000 6                  TRA     IGNORE

     1796     6680        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:253  
     1797     6681    4            CASE (31 /* KEY_TURNLG# */);

     1798     6682    4               OC_ACCT_SAVE.ACTIVE = '1'B /*TRUE#*/;

   6682  6 004444   400000 236003                    LDQ     -131072,DU
         6 004445   000000 256000 xsym               ORSQ    OC_ACCT_SAVE

     1799     6683    4               IF OCS_SSIZE ~= 2 /* CHECK IF TIME WAS NOT SPECIFIED              */

   6683  6 004446   000000 235000 xsym               LDA     OCS_SSIZE
         6 004447   000002 115007                    CMPA    2,DL
         6 004450   004460 600000 6                  TZE     s:6691

     1800     6684    4               THEN
     1801     6685    5               DO;

     1802     6686    5                  OC_ACCT_SAVE.HOUR = 23 /* TURN_HOUR# */;

   6686  6 004451   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         6 004452   000234 376000 7                  ANQ     156
         6 004453   000027 276003                    ORQ     23,DU
         6 004454   000000 756000 xsym               STQ     OC_ACCT_SAVE

     1803     6687    5                  OC_ACCT_SAVE.MIN = 59 /* TURN_MIN# */;

   6687  6 004455   000073 221003                    LDX1    59,DU
         6 004456   000000 441000 xsym               SXL1    OC_ACCT_SAVE

     1804     6688    5               END;

   6688  6 004457   004467 710000 6                  TRA     s:6694

     1805     6689    4               ELSE
     1806     6690    5               DO;

     1807     6691    5                  OC_ACCT_SAVE.HOUR = OC_PARAM$ -> OC$AUTO.HOUR;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:254  
   6691  6 004460   000000 470400 xsym               LDP0    OC_PARAM$
         6 004461   003000 061500                    CSR     bolr='003'O
         6 004462   000001 000011                    BDSC    1,,PR0                   by=0,bit=0,n=9
         6 004463   000000 010021 xsym               BDSC    OC_ACCT_SAVE             by=0,bit=1,n=17

     1808     6692    5                  OC_ACCT_SAVE.MIN = OC_PARAM$ -> OC$AUTO.MIN;

   6692  6 004464   000000 101500                    MRL     fill='000'O
         6 004465   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1
         6 004466   000000 400002 xsym               ADSC9   OC_ACCT_SAVE             cn=2,n=2

     1809     6693    5               END;

     1810     6694    4               CALL OCL$STATUS(1 /* OCN_UPDAT_ACCT# */);

   6694  6 004467   000031 630400 7                  EPPR0   25
         6 004470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004471   000000 701000 xent               TSX1    OCL$STATUS
         6 004472   000000 011000                    NOP     0
         6 004473   006562 710000 6                  TRA     IGNORE

     1811     6695
     1812     6696    4            CASE (32 /* KEY_TURNHT# */);

     1813     6697    4               OC_HIST_SAVE.ACTIVE = '1'B /*TRUE#*/;

   6697  6 004474   400000 236003                    LDQ     -131072,DU
         6 004475   000000 256000 xsym               ORSQ    OC_HIST_SAVE

     1814     6698    4               IF OCS_SSIZE ~= 2 /* CHECK IF TIME WAS NOT SPECIFIED              */

   6698  6 004476   000000 235000 xsym               LDA     OCS_SSIZE
         6 004477   000002 115007                    CMPA    2,DL
         6 004500   004510 600000 6                  TZE     s:6706

     1815     6699    4               THEN
     1816     6700    5               DO;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:255  

     1817     6701    5                  OC_HIST_SAVE.HOUR = 23 /* TURN_HOUR# */;

   6701  6 004501   000000 236000 xsym               LDQ     OC_HIST_SAVE
         6 004502   000234 376000 7                  ANQ     156
         6 004503   000027 276003                    ORQ     23,DU
         6 004504   000000 756000 xsym               STQ     OC_HIST_SAVE

     1818     6702    5                  OC_HIST_SAVE.MIN = 59 /* TURN_MIN# */;

   6702  6 004505   000073 221003                    LDX1    59,DU
         6 004506   000000 441000 xsym               SXL1    OC_HIST_SAVE

     1819     6703    5               END;

   6703  6 004507   004517 710000 6                  TRA     s:6709

     1820     6704    4               ELSE
     1821     6705    5               DO;

     1822     6706    5                  OC_HIST_SAVE.HOUR = OC_PARAM$ -> OC$AUTO.HOUR;

   6706  6 004510   000000 470400 xsym               LDP0    OC_PARAM$
         6 004511   003000 061500                    CSR     bolr='003'O
         6 004512   000001 000011                    BDSC    1,,PR0                   by=0,bit=0,n=9
         6 004513   000000 010021 xsym               BDSC    OC_HIST_SAVE             by=0,bit=1,n=17

     1823     6707    5                  OC_HIST_SAVE.MIN = OC_PARAM$ -> OC$AUTO.MIN;

   6707  6 004514   000000 101500                    MRL     fill='000'O
         6 004515   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1
         6 004516   000000 400002 xsym               ADSC9   OC_HIST_SAVE             cn=2,n=2

     1824     6708    5               END;

     1825     6709    4               CALL OCL$STATUS(2 /* OCN_UPDAT_HIST# */);

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:256  
   6709  6 004517   000235 630400 7                  EPPR0   157
         6 004520   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004521   000000 701000 xent               TSX1    OCL$STATUS
         6 004522   000000 011000                    NOP     0
         6 004523   006562 710000 6                  TRA     IGNORE

     1826     6710
     1827     6711    4            CASE (33 /* KEY_TURNALL# */);

     1828     6712    4               OC_ACCT_SAVE.ACTIVE = '1'B /*TRUE#*/;

   6712  6 004524   400000 236003                    LDQ     -131072,DU
         6 004525   000000 256000 xsym               ORSQ    OC_ACCT_SAVE

     1829     6713    4               IF OCS_SSIZE ~= 2 /* CHECK IF TIME WAS NOT SPECIFIED              */

   6713  6 004526   000000 235000 xsym               LDA     OCS_SSIZE
         6 004527   000002 115007                    CMPA    2,DL
         6 004530   004545 600000 6                  TZE     s:6723

     1830     6714    4               THEN
     1831     6715    5               DO;

     1832     6716    5                  OC_HIST_SAVE.HOUR = 23 /* TURN_HOUR# */;

   6716  6 004531   000000 236000 xsym               LDQ     OC_HIST_SAVE
         6 004532   000234 376000 7                  ANQ     156
         6 004533   000027 276003                    ORQ     23,DU
         6 004534   000000 756000 xsym               STQ     OC_HIST_SAVE

     1833     6717    5                  OC_HIST_SAVE.MIN = 59 /* TURN_MIN# */;

   6717  6 004535   000073 221003                    LDX1    59,DU
         6 004536   000000 441000 xsym               SXL1    OC_HIST_SAVE

     1834     6718    5                  OC_ACCT_SAVE.HOUR = 23 /* TURN_HOUR# */;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:257  
   6718  6 004537   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         6 004540   000234 376000 7                  ANQ     156
         6 004541   000027 276003                    ORQ     23,DU
         6 004542   000000 756000 xsym               STQ     OC_ACCT_SAVE

     1835     6719    5                  OC_ACCT_SAVE.MIN = 59 /* TURN_MIN# */;

   6719  6 004543   000000 441000 xsym               SXL1    OC_ACCT_SAVE

     1836     6720    5               END;

   6720  6 004544   004562 710000 6                  TRA     s:6728

     1837     6721    4               ELSE
     1838     6722    5               DO;

     1839     6723    5                  OC_HIST_SAVE.HOUR = OC_PARAM$ -> OC$AUTO.HOUR;

   6723  6 004545   000000 470400 xsym               LDP0    OC_PARAM$
         6 004546   003000 061500                    CSR     bolr='003'O
         6 004547   000001 000011                    BDSC    1,,PR0                   by=0,bit=0,n=9
         6 004550   000000 010021 xsym               BDSC    OC_HIST_SAVE             by=0,bit=1,n=17

     1840     6724    5                  OC_HIST_SAVE.MIN = OC_PARAM$ -> OC$AUTO.MIN;

   6724  6 004551   000000 101500                    MRL     fill='000'O
         6 004552   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1
         6 004553   000000 400002 xsym               ADSC9   OC_HIST_SAVE             cn=2,n=2

     1841     6725    5                  OC_ACCT_SAVE.HOUR = OC_PARAM$ -> OC$AUTO.HOUR;

   6725  6 004554   003000 061500                    CSR     bolr='003'O
         6 004555   000001 000011                    BDSC    1,,PR0                   by=0,bit=0,n=9
         6 004556   000000 010021 xsym               BDSC    OC_ACCT_SAVE             by=0,bit=1,n=17

     1842     6726    5                  OC_ACCT_SAVE.MIN = OC_PARAM$ -> OC$AUTO.MIN;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:258  
   6726  6 004557   000000 101500                    MRL     fill='000'O
         6 004560   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1
         6 004561   000000 400002 xsym               ADSC9   OC_ACCT_SAVE             cn=2,n=2

     1843     6727    5               END;

     1844     6728    4               OC_HIST_SAVE.ACTIVE = '1'B /*TRUE#*/;

   6728  6 004562   400000 236003                    LDQ     -131072,DU
         6 004563   000000 256000 xsym               ORSQ    OC_HIST_SAVE

     1845     6729    4               CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */);

   6729  6 004564   000007 630400 7                  EPPR0   7
         6 004565   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004566   000000 701000 xent               TSX1    OCL$STATUS
         6 004567   000000 011000                    NOP     0
         6 004570   006562 710000 6                  TRA     IGNORE

     1846     6730
     1847     6731    4            CASE (34 /* KEY_DTURNLG# */);

     1848     6732    4               OC_ACCT_SAVE.ACTIVE = '0'B /*FALSE#*/;

   6732  6 004571   000031 236000 xsym               LDQ     B_VECTNIL+25
         6 004572   000000 356000 xsym               ANSQ    OC_ACCT_SAVE

     1849     6733    4               CALL OCL$STATUS(1 /* OCN_UPDAT_ACCT# */);

   6733  6 004573   000031 630400 7                  EPPR0   25
         6 004574   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004575   000000 701000 xent               TSX1    OCL$STATUS
         6 004576   000000 011000                    NOP     0
         6 004577   006562 710000 6                  TRA     IGNORE

     1850     6734
     1851     6735    4            CASE (35 /* KEY_DTURNHT# */);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:259  

     1852     6736    4               OC_HIST_SAVE.ACTIVE = '0'B /*FALSE#*/;

   6736  6 004600   000031 236000 xsym               LDQ     B_VECTNIL+25
         6 004601   000000 356000 xsym               ANSQ    OC_HIST_SAVE

     1853     6737    4               CALL OCL$STATUS(2 /* OCN_UPDAT_HIST# */);

   6737  6 004602   000235 630400 7                  EPPR0   157
         6 004603   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004604   000000 701000 xent               TSX1    OCL$STATUS
         6 004605   000000 011000                    NOP     0
         6 004606   006562 710000 6                  TRA     IGNORE

     1854     6738
     1855     6739    4            CASE (36 /* KEY_DTURNALL# */);

     1856     6740    4               OC_ACCT_SAVE.ACTIVE = '0'B /*FALSE#*/;

   6740  6 004607   000031 236000 xsym               LDQ     B_VECTNIL+25
         6 004610   000000 356000 xsym               ANSQ    OC_ACCT_SAVE

     1857     6741    4               OC_HIST_SAVE.ACTIVE = '0'B /*FALSE#*/;

   6741  6 004611   000000 356000 xsym               ANSQ    OC_HIST_SAVE

     1858     6742    4               CALL OCL$STATUS(0 /* OCN_UPDAT_BOTH# */);

   6742  6 004612   000007 630400 7                  EPPR0   7
         6 004613   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004614   000000 701000 xent               TSX1    OCL$STATUS
         6 004615   000000 011000                    NOP     0
         6 004616   006562 710000 6                  TRA     IGNORE

     1859     6743        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:260  
     1860     6744    4            CASE (39 /* KEY_NATLANG# */);

     1861     6745    4               OC_CONSOLE.NATLANG(INDEX_) = OC_PARAM$ -> OC$NAT.LANG;

   6745  6 004617   200006 236100                    LDQ     INDEX_,,AUTO
         6 004620   000076 402007                    MPY     62,DL
         6 004621   000002 736000                    QLS     2
         6 004622   000000 470400 xsym               LDP0    OC_PARAM$
         6 004623   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 004624   040106 100500                    MLR     fill='040'O
         6 004625   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         6 004626   100017 600001                    ADSC9   15,Q,PR1                 cn=3,n=1

     1862     6746    4               CALL WRITE_ERR(28);

   6746  6 004627   000237 236000 7                  LDQ     159
         6 004630   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 004631   006570 701000 6                  TSX1    WRITE_ERR
         6 004632   000000 011000                    NOP     0
         6 004633   006562 710000 6                  TRA     IGNORE

     1863     6747        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:261  
     1864     6748        /* THESE NEXT CASE HANDLE READ$ COMMAND */
     1865     6749    4            CASE (40 /* KEY_READ$# */);

     1866     6750    4               IF OCS_SSIZE ~= 0 AND

   6750  6 004634   000000 236000 xsym               LDQ     OCS_SSIZE
         6 004635   006562 600000 6                  TZE     IGNORE
         6 004636   200006 236100                    LDQ     INDEX_,,AUTO
         6 004637   000370 402007                    MPY     248,DL
         6 004640   000000 470400 xsym               LDP0    OC_PARAM$
         6 004641   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 004642   040106 106500                    CMPC    fill='040'O
         6 004643   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 004644   100006 000010                    ADSC9   6,Q,PR1                  cn=0,n=8
         6 004645   006562 600000 6                  TZE     IGNORE

     1867     6751    4                 OC_PARAM$ -> OC$READ$.LOGON ~= OC_CONSOLE.LOGON(INDEX_)
     1868     6752    4               THEN
     1869     6753    5               DO;

     1870     6754    5                  CALL WRITE_ERR(30);

   6754  6 004646   000241 236000 7                  LDQ     161
         6 004647   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 004650   006570 701000 6                  TSX1    WRITE_ERR
         6 004651   000000 011000                    NOP     0

     1871     6755    5                  CALL OCR$CREAD(INDEX_);

   6755  6 004652   200006 630500                    EPPR0   INDEX_,,AUTO
         6 004653   200612 450500                    STP0    @MCOUNT+2,,AUTO
         6 004654   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 004655   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004656   000000 701000 xent               TSX1    OCR$CREAD
         6 004657   000000 011000                    NOP     0

     1872     6756    5               END;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:262  

   6756  6 004660   006562 710000 6                  TRA     IGNORE

     1873     6757    4            CASE (41 /* KEY_READ$# */);

     1874     6758
     1875     6759    4               I = 4;

   6759  6 004661   000004 236007                    LDQ     4,DL
         6 004662   000000 756000 2                  STQ     I

     1876     6760    4               IF OC_PARAM$ -> OC$COMM.DEVICE = '    '

   6760  6 004663   000000 470400 xsym               LDP0    OC_PARAM$
         6 004664   040000 106500                    CMPC    fill='040'O
         6 004665   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         6 004666   000054 000004 4                  ADSC9   GET_LADC_FLAG+12         cn=0,n=4
         6 004667   004677 601000 6                  TNZ     s:6764

     1877     6761    4               THEN
     1878     6762    4               OC_PARAM$ -> OC$COMM.DEVICE = OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);

   6762  6 004670   200006 236100                    LDQ     INDEX_,,AUTO
         6 004671   000370 402007                    MPY     248,DL
         6 004672   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 004673   040100 100506                    MLR     fill='040'O
         6 004674   100000 000004                    ADSC9   0,Q,PR1                  cn=0,n=4
         6 004675   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         6 004676   004710 710000 6                  TRA     s:6766

     1879     6763    4               ELSE
     1880     6764    4               CALL MY_XLATE (ADDR(OC_PARAM$->OC$COMM.DEVICE), I);

   6764  6 004677   000000 236000 xsym               LDQ     OC_PARAM$
         6 004700   000001 036003                    ADLQ    1,DU
         6 004701   200626 756100                    STQ     @MCOUNT+14,,AUTO
         6 004702   000165 236000 7                  LDQ     117
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:263  
         6 004703   200610 756100                    STQ     @MPTR$+1,,AUTO
         6 004704   200626 631500                    EPPR1   @MCOUNT+14,,AUTO
         6 004705   200607 451500                    STP1    INSTANCE$+2,,AUTO
         6 004706   006606 701000 6                  TSX1    MY_XLATE
         6 004707   000000 011000                    NOP     0

     1881     6765
     1882     6766    4               IF OC_PARAM$ -> OC$COMM.TERM = ' '

   6766  6 004710   000000 470400 xsym               LDP0    OC_PARAM$
         6 004711   040000 106500                    CMPC    fill='040'O
         6 004712   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         6 004713   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004714   004723 601000 6                  TNZ     s:6771

     1883     6767    4               THEN
     1884     6768    4               OC_PARAM$ -> OC$COMM.TERM =

   6768  6 004715   200006 236100                    LDQ     INDEX_,,AUTO
         6 004716   000370 402007                    MPY     248,DL
         6 004717   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 004720   040100 100506                    MLR     fill='040'O
         6 004721   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         6 004722   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

     1885     6769    4                 OC_CONSOLE.TERM_NAME (INDEX_);
     1886     6770
     1887     6771    4               IF OC_PARAM$ -> OC$COMM.AT_TERM = ' '

   6771  6 004723   040000 106500                    CMPC    fill='040'O
         6 004724   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         6 004725   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004726   004732 601000 6                  TNZ     s:6776

     1888     6772    4               THEN
     1889     6773    4               OC_PARAM$ -> OC$COMM.AT_TERM =

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:264  
   6773  6 004727   040100 100500                    MLR     fill='040'O
         6 004730   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         6 004731   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

     1890     6774    4                 OC_PARAM$ -> OC$COMM.TERM;
     1891     6775
     1892     6776    4               IF

   6776  6 004732   200006 236100                    LDQ     INDEX_,,AUTO
         6 004733   000370 402007                    MPY     248,DL
         6 004734   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 004735   040100 106506                    CMPC    fill='040'O
         6 004736   100000 000004                    ADSC9   0,Q,PR1                  cn=0,n=4
         6 004737   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         6 004740   004745 601000 6                  TNZ     s:6785
         6 004741   040100 106506                    CMPC    fill='040'O
         6 004742   100002 000010                    ADSC9   2,Q,PR1                  cn=0,n=8
         6 004743   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         6 004744   006562 600000 6                  TZE     IGNORE

     1893     6777    4                 OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_) ~=
     1894     6778    4                 OC_PARAM$ -> OC$COMM.DEVICE
     1895     6779    4                 OR
     1896     6780    4                 (OC_CONSOLE.TERM_NAME(INDEX_) ~=
     1897     6781    4                 OC_PARAM$ ->
     1898     6782    4                 OC$COMM.AT_TERM)
     1899     6783    4               THEN
     1900     6784    5               DO;

     1901     6785    5                  CALL WRITE_ERR(30);

   6785  6 004745   000241 236000 7                  LDQ     161
         6 004746   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 004747   006570 701000 6                  TSX1    WRITE_ERR
         6 004750   000000 011000                    NOP     0

     1902     6786    5                  CALL OCR$CREAD(INDEX_);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:265  

   6786  6 004751   200006 630500                    EPPR0   INDEX_,,AUTO
         6 004752   200612 450500                    STP0    @MCOUNT+2,,AUTO
         6 004753   200612 630500                    EPPR0   @MCOUNT+2,,AUTO
         6 004754   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 004755   000000 701000 xent               TSX1    OCR$CREAD
         6 004756   000000 011000                    NOP     0

     1903     6787    5               END;

   6787  6 004757   006562 710000 6                  TRA     IGNORE

     1904     6788        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:266  
     1905     6789    4            CASE (42 /* KEY_STATUS# */);
              6789                     /* STATUS COMMAND                                */

     1906     6790
     1907     6791    4               STATS_WRITEB.NAME =

   6791  6 004760   200006 236100                    LDQ     INDEX_,,AUTO
         6 004761   000370 402007                    MPY     248,DL
         6 004762   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 004763   040000 100506                    MLR     fill='040'O
         6 004764   000000 000004                    ADSC9   0,Q,PR0                  cn=0,n=4
         6 004765   000235 600004 2                  ADSC9   STATS_WRITEB+9           cn=3,n=4

     1908     6792    4                 OC_CONSOLE.STATIONR.FIRST_HALF(INDEX_);
     1909     6793    4               STATS_WRITEB.TERM =

   6793  6 004766   040000 100506                    MLR     fill='040'O
         6 004767   000002 000010                    ADSC9   2,Q,PR0                  cn=0,n=8
         6 004770   000240 600010 2                  ADSC9   STATS_WRITEB+12          cn=3,n=8

     1910     6794    4                 OC_CONSOLE.TERM_NAME(INDEX_);
     1911     6795
     1912     6796    4               STATS_WRITEB.LGN =

   6796  6 004771   040000 100506                    MLR     fill='040'O
         6 004772   000006 000010                    ADSC9   6,Q,PR0                  cn=0,n=8
         6 004773   000236 600010 2                  ADSC9   STATS_WRITEB+10          cn=3,n=8

     1913     6797    4                 OC_CONSOLE.LOGON(INDEX_);
     1914     6798
     1915     6799    4               STATS_WRITEB.WSN = OC_CONSOLE.WSN(INDEX_);

   6799  6 004774   040000 100506                    MLR     fill='040'O
         6 004775   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         6 004776   000242 600010 2                  ADSC9   STATS_WRITEB+14          cn=3,n=8

     1916     6800
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:267  
     1917     6801    4               MSG# = 373 /* STAT_MSG# */;

   6801  6 004777   000565 221003                    LDX1    373,DU
         6 005000   000310 741000 2                  STX1    MSG#

     1918     6802    4               NP# = 32;

   6802  6 005001   040000 236003                    LDQ     16384,DU
         6 005002   000311 756000 2                  STQ     NP#

     1919     6803         /*                                                                           */
     1920     6804    4               STATS_WRITEB.GHOST_ACTIVE = BITBIN(OC_CONSOLE.GHST(INDEX_));

   6804  6 005003   200006 236100                    LDQ     INDEX_,,AUTO
         6 005004   000076 402007                    MPY     62,DL
         6 005005   000017 236106                    LDQ     15,QL,PR0
         6 005006   000021 772000                    QRL     17
         6 005007   000001 376007                    ANQ     1,DL
         6 005010   000022 736000                    QLS     18
         6 005011   000224 552020 2                  STBQ    STATS_WRITEB,'20'O

     1921     6805
     1922     6806    4               STATS_WRITEB.HIST = BITBIN(OC_LIST);

   6806  6 005012   000000 236000 xsym               LDQ     OC_LIST
         6 005013   000043 772000                    QRL     35
         6 005014   000011 736000                    QLS     9
         6 005015   000224 552010 2                  STBQ    STATS_WRITEB,'10'O

     1923     6807
     1924     6808    4               IF OC_ACCT_SAVE.ACTIVE

   6808  6 005016   000000 234000 xsym               SZN     OC_ACCT_SAVE
         6 005017   005027 605000 6                  TPL     s:6815

     1925     6809    4               THEN
     1926     6810    5               DO;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:268  

     1927     6811    5                  STATS_WRITEB.ACCT_HR = OC_ACCT_SAVE.HOUR;

   6811  6 005020   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         6 005021   000022 772000                    QRL     18
         6 005022   000224 552004 2                  STBQ    STATS_WRITEB,'04'O

     1928     6812    5                  STATS_WRITEB.ACCT_MIN = OC_ACCT_SAVE.MIN;

   6812  6 005023   000000 236000 xsym               LDQ     OC_ACCT_SAVE
         6 005024   000033 736000                    QLS     27
         6 005025   000225 552040 2                  STBQ    STATS_WRITEB+1,'40'O

     1929     6813    5               END;

   6813  6 005026   005031 710000 6                  TRA     s:6817

     1930     6814    4               ELSE
     1931     6815    4               STATS_WRITEB.ACCT_HR = 99;

   6815  6 005027   000143 236007                    LDQ     99,DL
         6 005030   000224 552004 2                  STBQ    STATS_WRITEB,'04'O

     1932     6816
     1933     6817    4               IF OC_HIST_SAVE.ACTIVE

   6817  6 005031   000000 234000 xsym               SZN     OC_HIST_SAVE
         6 005032   005040 605000 6                  TPL     s:6824

     1934     6818    4               THEN
     1935     6819    5               DO;

     1936     6820    5                  STATS_WRITEB.HIST_HR = OC_HIST_SAVE.HOUR;

   6820  6 005033   000000 236000 xsym               LDQ     OC_HIST_SAVE
         6 005034   000225 552020 2                  STBQ    STATS_WRITEB+1,'20'O

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:269  
     1937     6821    5                  STATS_WRITEB.HIST_MIN = OC_HIST_SAVE.MIN;

   6821  6 005035   000011 736000                    QLS     9
         6 005036   000225 552010 2                  STBQ    STATS_WRITEB+1,'10'O

     1938     6822    5               END;

   6822  6 005037   005042 710000 6                  TRA     s:6826

     1939     6823    4               ELSE
     1940     6824    4               STATS_WRITEB.HIST_HR = 99;

   6824  6 005040   000143 236003                    LDQ     99,DU
         6 005041   000225 552020 2                  STBQ    STATS_WRITEB+1,'20'O

     1941     6825
     1942     6826    4               STATS_WRITEB.UPPER = BITBIN(OC_CONSOLE.SHIFT(INDEX_));

   6826  6 005042   200006 236100                    LDQ     INDEX_,,AUTO
         6 005043   000076 402007                    MPY     62,DL
         6 005044   000017 236106                    LDQ     15,QL,PR0
         6 005045   000017 772000                    QRL     15
         6 005046   000001 376007                    ANQ     1,DL
         6 005047   000225 552004 2                  STBQ    STATS_WRITEB+1,'04'O

     1943     6827    4               STATS_WRITEB.TIME = BITBIN(OC_CONSOLE.DONT_TIME (INDEX_));

   6827  6 005050   200006 236100                    LDQ     INDEX_,,AUTO
         6 005051   000076 402007                    MPY     62,DL
         6 005052   000017 236106                    LDQ     15,QL,PR0
         6 005053   000013 772000                    QRL     11
         6 005054   000001 376007                    ANQ     1,DL
         6 005055   000033 736000                    QLS     27
         6 005056   000226 552040 2                  STBQ    STATS_WRITEB+2,'40'O

     1944     6828    4               STATS_WRITEB.NATLANG = OC_CONSOLE.NATLANG (INDEX_);

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:270  
   6828  6 005057   200006 236100                    LDQ     INDEX_,,AUTO
         6 005060   000076 402007                    MPY     62,DL
         6 005061   000017 236106                    LDQ     15,QL,PR0
         6 005062   000022 736000                    QLS     18
         6 005063   000226 552020 2                  STBQ    STATS_WRITEB+2,'20'O

     1945     6829    4               STATS_WRITEB.SYSRACCT = OC_DEF_ACCT;

   6829  6 005064   040000 100400                    MLR     fill='040'O
         6 005065   000000 000010 xsym               ADSC9   OC_DEF_ACCT              cn=0,n=8
         6 005066   000226 400010 2                  ADSC9   STATS_WRITEB+2           cn=2,n=8

     1946     6830    4               STATS_WRITEB.MYREADA = OC_CONSOLE.ACCT(INDEX_);

   6830  6 005067   200006 236100                    LDQ     INDEX_,,AUTO
         6 005070   000370 402007                    MPY     248,DL
         6 005071   040000 100506                    MLR     fill='040'O
         6 005072   000020 000010                    ADSC9   16,Q,PR0                 cn=0,n=8
         6 005073   000230 400010 2                  ADSC9   STATS_WRITEB+4           cn=2,n=8

     1947     6831
     1948     6832    4               IF STATS_WRITEB.MYREADA = '        '

   6832  6 005074   040000 106400                    CMPC    fill='040'O
         6 005075   000230 400010 2                  ADSC9   STATS_WRITEB+4           cn=2,n=8
         6 005076   000054 000010 4                  ADSC9   GET_LADC_FLAG+12         cn=0,n=8
         6 005077   005103 601000 6                  TNZ     s:6836

     1949     6833    4               THEN
     1950     6834    4               STATS_WRITEB.MYREADA = STATS_WRITEB.SYSRACCT;

   6834  6 005100   040000 100400                    MLR     fill='040'O
         6 005101   000226 400010 2                  ADSC9   STATS_WRITEB+2           cn=2,n=8
         6 005102   000230 400010 2                  ADSC9   STATS_WRITEB+4           cn=2,n=8

     1951     6835
     1952     6836    4               STATS_WRITEB.MXPRIO = OC_CONSOLE.MXPRIO (INDEX_);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:271  

   6836  6 005103   200006 236100                    LDQ     INDEX_,,AUTO
         6 005104   000076 402007                    MPY     62,DL
         6 005105   000075 236106                    LDQ     61,QL,PR0
         6 005106   000022 772000                    QRL     18
         6 005107   000232 552010 2                  STBQ    STATS_WRITEB+6,'10'O

     1953     6837
     1954     6838    4               STATS_WRITEB.I_SYS = OC_CONSOLE.ATTR_INPUT (INDEX_) & '200000'O
              6838                        /* M_SYS  */;

   6838  6 005110   200006 236100                    LDQ     INDEX_,,AUTO
         6 005111   000076 402007                    MPY     62,DL
         6 005112   000013 222106                    LDX2    11,QL,PR0
         6 005113   200000 362003                    ANX2    65536,DU
         6 005114   000000 636012                    EAQ     0,X2
         6 005115   000033 772000                    QRL     27
         6 005116   000232 552004 2                  STBQ    STATS_WRITEB+6,'04'O

     1955     6839
     1956     6840    4               STATS_WRITEB.I_DEV = OC_CONSOLE.ATTR_INPUT (INDEX_) & '100000'O
              6840                        /* M_DEVC  */;

   6840  6 005117   200006 236100                    LDQ     INDEX_,,AUTO
         6 005120   000076 402007                    MPY     62,DL
         6 005121   000013 222106                    LDX2    11,QL,PR0
         6 005122   100000 362003                    ANX2    32768,DU
         6 005123   000000 636012                    EAQ     0,X2
         6 005124   000233 552040 2                  STBQ    STATS_WRITEB+7,'40'O

     1957     6841
     1958     6842    4               STATS_WRITEB.I_ADMN = OC_CONSOLE.ATTR_INPUT (INDEX_) & '040000'O
              6842                        /* M_ADMIN */;

   6842  6 005125   200006 236100                    LDQ     INDEX_,,AUTO
         6 005126   000076 402007                    MPY     62,DL
         6 005127   000013 222106                    LDX2    11,QL,PR0
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:272  
         6 005130   040000 362003                    ANX2    16384,DU
         6 005131   000000 636012                    EAQ     0,X2
         6 005132   000011 772000                    QRL     9
         6 005133   000233 552020 2                  STBQ    STATS_WRITEB+7,'20'O

     1959     6843
     1960     6844    4               STATS_WRITEB.I_DLTA = OC_CONSOLE.ATTR_INPUT (INDEX_) & '020000'O
              6844                        /* M_DLTA  */;

   6844  6 005134   200006 236100                    LDQ     INDEX_,,AUTO
         6 005135   000076 402007                    MPY     62,DL
         6 005136   000013 222106                    LDX2    11,QL,PR0
         6 005137   020000 362003                    ANX2    8192,DU
         6 005140   000000 636012                    EAQ     0,X2
         6 005141   000022 772000                    QRL     18
         6 005142   000233 552010 2                  STBQ    STATS_WRITEB+7,'10'O

     1961     6845
     1962     6846    4               STATS_WRITEB.I_LIB = OC_CONSOLE.ATTR_INPUT (INDEX_) & '010000'O
              6846                        /* M_LIBRN */;

   6846  6 005143   200006 236100                    LDQ     INDEX_,,AUTO
         6 005144   000076 402007                    MPY     62,DL
         6 005145   000013 222106                    LDX2    11,QL,PR0
         6 005146   010000 362003                    ANX2    4096,DU
         6 005147   000000 636012                    EAQ     0,X2
         6 005150   000033 772000                    QRL     27
         6 005151   000233 552004 2                  STBQ    STATS_WRITEB+7,'04'O

     1963     6847
     1964     6848    4               STATS_WRITEB.I_COMM = OC_CONSOLE.ATTR_INPUT (INDEX_) & '004000'O
              6848                        /* M_COMM */;

   6848  6 005152   200006 236100                    LDQ     INDEX_,,AUTO
         6 005153   000076 402007                    MPY     62,DL
         6 005154   000013 222106                    LDX2    11,QL,PR0
         6 005155   004000 362003                    ANX2    2048,DU
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:273  
         6 005156   000000 636012                    EAQ     0,X2
         6 005157   000234 552040 2                  STBQ    STATS_WRITEB+8,'40'O

     1965     6849
     1966     6850    4               STATS_WRITEB.I_TP = OC_CONSOLE.ATTR_INPUT (INDEX_) & '001000'O
              6850                        /* M_TP */;

   6850  6 005160   200006 236100                    LDQ     INDEX_,,AUTO
         6 005161   000076 402007                    MPY     62,DL
         6 005162   000013 222106                    LDX2    11,QL,PR0
         6 005163   001000 362003                    ANX2    512,DU
         6 005164   000000 636012                    EAQ     0,X2
         6 005165   000033 772000                    QRL     27
         6 005166   000251 552004 2                  STBQ    STATS_WRITEB+21,'04'O

     1967     6851
     1968     6852    4               STATS_WRITEB.O_SYS = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '200000'O
              6852                        /* M_SYS  */;

   6852  6 005167   200006 236100                    LDQ     INDEX_,,AUTO
         6 005170   000076 402007                    MPY     62,DL
         6 005171   000014 222106                    LDX2    12,QL,PR0
         6 005172   200000 362003                    ANX2    65536,DU
         6 005173   000000 636012                    EAQ     0,X2
         6 005174   000011 772000                    QRL     9
         6 005175   000234 552020 2                  STBQ    STATS_WRITEB+8,'20'O

     1969     6853
     1970     6854    4               STATS_WRITEB.O_DEV = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '100000'O
              6854                        /* M_DEVC  */;

   6854  6 005176   200006 236100                    LDQ     INDEX_,,AUTO
         6 005177   000076 402007                    MPY     62,DL
         6 005200   000014 222106                    LDX2    12,QL,PR0
         6 005201   100000 362003                    ANX2    32768,DU
         6 005202   000000 636012                    EAQ     0,X2
         6 005203   000022 772000                    QRL     18
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:274  
         6 005204   000234 552010 2                  STBQ    STATS_WRITEB+8,'10'O

     1971     6855
     1972     6856    4               STATS_WRITEB.O_ADMN = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '040000'O
              6856                        /* M_ADMIN */;

   6856  6 005205   200006 236100                    LDQ     INDEX_,,AUTO
         6 005206   000076 402007                    MPY     62,DL
         6 005207   000014 222106                    LDX2    12,QL,PR0
         6 005210   040000 362003                    ANX2    16384,DU
         6 005211   000000 636012                    EAQ     0,X2
         6 005212   000033 772000                    QRL     27
         6 005213   000234 552004 2                  STBQ    STATS_WRITEB+8,'04'O

     1973     6857
     1974     6858    4               STATS_WRITEB.O_DLTA = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '020000'O
              6858                        /* M_DLTA  */;

   6858  6 005214   200006 236100                    LDQ     INDEX_,,AUTO
         6 005215   000076 402007                    MPY     62,DL
         6 005216   000014 222106                    LDX2    12,QL,PR0
         6 005217   020000 362003                    ANX2    8192,DU
         6 005220   000000 636012                    EAQ     0,X2
         6 005221   000235 552040 2                  STBQ    STATS_WRITEB+9,'40'O

     1975     6859
     1976     6860    4               STATS_WRITEB.O_LIB = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '010000'O
              6860                        /* M_LIBRN */;

   6860  6 005222   200006 236100                    LDQ     INDEX_,,AUTO
         6 005223   000076 402007                    MPY     62,DL
         6 005224   000014 222106                    LDX2    12,QL,PR0
         6 005225   010000 362003                    ANX2    4096,DU
         6 005226   000000 636012                    EAQ     0,X2
         6 005227   000011 772000                    QRL     9
         6 005230   000235 552020 2                  STBQ    STATS_WRITEB+9,'20'O

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:275  
     1977     6861
     1978     6862    4               STATS_WRITEB.O_COMM = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '004000'O
              6862                        /* M_COMM */;

   6862  6 005231   200006 236100                    LDQ     INDEX_,,AUTO
         6 005232   000076 402007                    MPY     62,DL
         6 005233   000014 222106                    LDX2    12,QL,PR0
         6 005234   004000 362003                    ANX2    2048,DU
         6 005235   000000 636012                    EAQ     0,X2
         6 005236   000022 772000                    QRL     18
         6 005237   000235 552010 2                  STBQ    STATS_WRITEB+9,'10'O

     1979     6863
     1980     6864    4               STATS_WRITEB.O_TP = OC_CONSOLE.ATTR_OUTPUT (INDEX_) & '001000'O
              6864                        /* M_TP */;

   6864  6 005240   200006 236100                    LDQ     INDEX_,,AUTO
         6 005241   000076 402007                    MPY     62,DL
         6 005242   000014 222106                    LDX2    12,QL,PR0
         6 005243   001000 362003                    ANX2    512,DU
         6 005244   000000 636012                    EAQ     0,X2
         6 005245   000252 552040 2                  STBQ    STATS_WRITEB+22,'40'O

     1981     6865
     1982     6866    4               STATS_WRITEB.PROF = OC_CONSOLE.PROFILE.TXT (INDEX_);

   6866  6 005246   200006 236100                    LDQ     INDEX_,,AUTO
         6 005247   000370 402007                    MPY     248,DL
         6 005250   040000 100506                    MLR     fill='040'O
         6 005251   000072 200013                    ADSC9   58,Q,PR0                 cn=1,n=11
         6 005252   000244 600013 2                  ADSC9   STATS_WRITEB+16          cn=3,n=11

     1983     6867
     1984     6868    4               STATS_WRITEB.LPWSN = OC_CONSOLE.LP_WSN (INDEX_);

   6868  6 005253   040000 100506                    MLR     fill='040'O
         6 005254   000010 000010                    ADSC9   8,Q,PR0                  cn=0,n=8
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:276  
         6 005255   000247 400010 2                  ADSC9   STATS_WRITEB+19          cn=2,n=8

     1985     6869
     1986     6870    4               STATS_WRITEB.SIZE = 0;

   6870  6 005256   000000 236003                    LDQ     0,DU
         6 005257   000251 552010 2                  STBQ    STATS_WRITEB+21,'10'O

     1987     6871    4               IF OC_CONSOLE.GHSTRD(INDEX_)

   6871  6 005260   200006 236100                    LDQ     INDEX_,,AUTO
         6 005261   000076 402007                    MPY     62,DL
         6 005262   000017 236106                    LDQ     15,QL,PR0
         6 005263   200000 316007                    CANQ    65536,DL
         6 005264   005323 600000 6                  TZE     s:6886

     1988     6872    4               THEN
     1989     6873    5               DO;

     1990     6874    6                  DO I = 0 TO 2;

   6874  6 005265   000000 450000 2                  STZ     I

     1991     6875    6                     IF ADDR(OC_CONSOLE.PROMPTS(INDEX_))->

   6875  6 005266   000000 236000 2                  LDQ     I
         6 005267   000042 402007                    MPY     34,DL
         6 005270   200612 756100                    STQ     @MCOUNT+2,,AUTO
         6 005271   200006 236100                    LDQ     INDEX_,,AUTO
         6 005272   000370 402007                    MPY     248,DL
         6 005273   200612 036100                    ADLQ    @MCOUNT+2,,AUTO
         6 005274   000011 402007                    MPY     9,DL
         6 005275   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 005276   000000 066506                    CMPB    filb='0'B
         6 005277   000022 000001                    BDSC    18,Q,PR0                 by=0,bit=0,n=1
         6 005300   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 005301   005316 600000 6                  TZE     s:6884
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:277  

     1992     6876    6                       PROMPT_TABLE.LAST_READ(I)
     1993     6877    6                     THEN
     1994     6878    7                     DO;

     1995     6879    7                        STATS_WRITEB.SIZE =

   6879  6 005302   000000 236000 2                  LDQ     I
         6 005303   000042 402007                    MPY     34,DL
         6 005304   200612 756100                    STQ     @MCOUNT+2,,AUTO
         6 005305   200006 236100                    LDQ     INDEX_,,AUTO
         6 005306   000370 402007                    MPY     248,DL
         6 005307   200612 036100                    ADLQ    @MCOUNT+2,,AUTO
         6 005310   000000 101506                    MRL     fill='000'O
         6 005311   000032 000002                    ADSC9   26,Q,PR0                 cn=0,n=2
         6 005312   000251 400001 2                  ADSC9   STATS_WRITEB+21          cn=2,n=1

     1996     6880    7                          ADDR(OC_CONSOLE.PROMPTS(INDEX_))->
     1997     6881    7                          PROMPT_TABLE.SIZER(I);
     1998     6882    7                        PFB = I + 1;

   6882  6 005313   000000 235000 2                  LDA     I
         6 005314   000001 035007                    ADLA    1,DL
         6 005315   000312 755000 2                  STA     PFB

     1999     6883    7                     END; /* IF FOUND                                            */

     2000     6884    6                  END; /* DO I                                                   */

   6884  6 005316   000000 235000 2                  LDA     I
         6 005317   000001 035007                    ADLA    1,DL
         6 005320   000000 755000 2                  STA     I
         6 005321   000003 115007                    CMPA    3,DL
         6 005322   005266 602000 6                  TNC     s:6875

     2001     6885    5               END; /* IF GHSTRD                                                 */

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:278  
     2002     6886    5               DO STATS_WRITEB.SUB_MESS# = 0 TO 5;

   6886  6 005323   000000 236003                    LDQ     0,DU
         6 005324   000224 552040 2                  STBQ    STATS_WRITEB,'40'O

     2003     6887
     2004     6888    5                  CALL OCO$IWRITE(OC_CADDR, MSG#, NP#,

   6888  6 005325   000242 630400 7                  EPPR0   162
         6 005326   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 005327   000000 701000 xent               TSX1    OCO$IWRITE
         6 005330   000000 011000                    NOP     0

     2005     6889    5                    STATS_WRITEC, STATS_WRITEB, 0,
     2006     6890    5                    OCP_NON_STA, PFB);
     2007     6891    5               END;

   6891  6 005331   000224 236000 2                  LDQ     STATS_WRITEB
         6 005332   001000 036003                    ADLQ    512,DU
         6 005333   000224 552040 2                  STBQ    STATS_WRITEB,'40'O
         6 005334   000224 236000 2                  LDQ     STATS_WRITEB
         6 005335   777000 376003                    ANQ     -512,DU
         6 005336   006000 116003                    CMPQ    3072,DU
         6 005337   005325 602000 6                  TNC     s:6888

     2008     6892    4               CALL M$MONINFO (GET_HEADY_STUFF)

   6892  6 005340   000560 630400 2                  EPPR0   GET_HEADY_STUFF
         6 005341   420023 713400                    CLIMB   alt,+8211
         6 005342   402400 401760                    pmme    nvectors=6
         6 005343   005430 702000 6                  TSX2    s:6923

     2009     6893    4               WHENRETURN
     2010     6894    5               DO;

     2011     6895    5                  NP# = 2;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:279  
   6895  6 005344   002000 236003                    LDQ     1024,DU
         6 005345   000311 756000 2                  STQ     NP#

     2012     6896    5                  MSG# = 365 /* HEADER_MSG#*/;

   6896  6 005346   000555 220003                    LDX0    365,DU
         6 005347   000310 740000 2                  STX0    MSG#

     2013     6897    5                  IF MYHEADER.CNT > 60 /* MSG_TOOBIG# */

   6897  6 005350   000574 236000 2                  LDQ     MYHEADER
         6 005351   777000 376003                    ANQ     -512,DU
         6 005352   075000 116003                    CMPQ    31232,DU
         6 005353   005411 602000 6                  TNC     s:6916

     2014     6898    5                  THEN
     2015     6899    6                  DO;

     2016     6900    6                     HDR_WRITEC.CNT=60 /* MSG_TOOBIG# */;

   6900  6 005354   000074 236003                    LDQ     60,DU
         6 005355   000264 552020 2                  STBQ    HDR_WRITEC,'20'O

     2017     6901    6                     HDR_WRITEB.FLAG=0;

   6901  6 005356   000000 236003                    LDQ     0,DU
         6 005357   000265 552040 2                  STBQ    HDR_WRITEB,'40'O

     2018     6902    6                     HDR_WRITEB.HEAD=SUBSTR(MYHEADER.HEADER#,0,60 /* MSG_TOOBIG# */);

   6902  6 005360   040000 100400                    MLR     fill='040'O
         6 005361   000574 200074 2                  ADSC9   MYHEADER                 cn=1,n=60
         6 005362   000265 200074 2                  ADSC9   HDR_WRITEB               cn=1,n=60

     2019     6903    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   6903  6 005363   000252 630400 7                  EPPR0   170
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:280  
         6 005364   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 005365   000000 701000 xent               TSX1    OCO$IWRITE
         6 005366   000000 011000                    NOP     0

     2020     6904    6                       HDR_WRITEC, HDR_WRITEB, 0,
     2021     6905    6                       OCP_NON_STA, 0);
     2022     6906    6                     HDR_WRITEC.CNT=MYHEADER.CNT-60 /* MSG_TOOBIG# */;

   6906  6 005367   000574 236000 2                  LDQ     MYHEADER
         6 005370   000033 772000                    QRL     27
         6 005371   000074 136007                    SBLQ    60,DL
         6 005372   000022 736000                    QLS     18
         6 005373   000264 552020 2                  STBQ    HDR_WRITEC,'20'O

     2023     6907    6                     HDR_WRITEB.FLAG=1;

   6907  6 005374   001000 236003                    LDQ     512,DU
         6 005375   000265 552040 2                  STBQ    HDR_WRITEB,'40'O

     2024     6908    6                     HDR_WRITEB.HEAD=SUBSTR(MYHEADER.HEADER#,60 /* MSG_TOOBIG# */,

   6908  6 005376   000574 236000 2                  LDQ     MYHEADER
         6 005377   000033 772000                    QRL     27
         6 005400   777704 620006                    EAX0    -60,QL
         6 005401   040000 100440                    MLR     fill='040'O
         6 005402   000613 200010 2                  ADSC9   MYHEADER+15              cn=1,n=*X0
         6 005403   000265 200074 2                  ADSC9   HDR_WRITEB               cn=1,n=60

     2025     6909    6                       MYHEADER.CNT-60 /* MSG_TOOBIG# */);
     2026     6910    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   6910  6 005404   000252 630400 7                  EPPR0   170
         6 005405   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 005406   000000 701000 xent               TSX1    OCO$IWRITE
         6 005407   000000 011000                    NOP     0

     2027     6911    6                       HDR_WRITEC, HDR_WRITEB, 0,
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:281  
     2028     6912    6                       OCP_NON_STA, 0);
     2029     6913    6                  END; /* DO IF MSG > REASONABLE LENGTH                          */

   6913  6 005410   005430 710000 6                  TRA     s:6923

     2030     6914    5                  ELSE
     2031     6915    6                  DO;

     2032     6916    6                     HDR_WRITEC.CNT = MYHEADER.CNT;

   6916  6 005411   000574 236000 2                  LDQ     MYHEADER
         6 005412   000011 772000                    QRL     9
         6 005413   000264 552020 2                  STBQ    HDR_WRITEC,'20'O

     2033     6917    6                     HDR_WRITEB.FLAG=0;

   6917  6 005414   000000 236003                    LDQ     0,DU
         6 005415   000265 552040 2                  STBQ    HDR_WRITEB,'40'O

     2034     6918    6                     HDR_WRITEB.HEAD=SUBSTR(MYHEADER.HEADER#,0,MYHEADER.CNT);

   6918  6 005416   000574 236000 2                  LDQ     MYHEADER
         6 005417   000033 772000                    QRL     27
         6 005420   000000 621006                    EAX1    0,QL
         6 005421   040000 100440                    MLR     fill='040'O
         6 005422   000574 200011 2                  ADSC9   MYHEADER                 cn=1,n=*X1
         6 005423   000265 200074 2                  ADSC9   HDR_WRITEB               cn=1,n=60

     2035     6919    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   6919  6 005424   000252 630400 7                  EPPR0   170
         6 005425   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 005426   000000 701000 xent               TSX1    OCO$IWRITE
         6 005427   000000 011000                    NOP     0

     2036     6920    6                       HDR_WRITEC, HDR_WRITEB, 0,
     2037     6921    6                       OCP_NON_STA, 0);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:282  
     2038     6922    6                  END; /* DO IF MSG < REASONABLE LENGTH                          */

     2039     6923    5               END; /* DO WHENRETURN                                             */

   6923  6 005430   006562 710000 6                  TRA     IGNORE

     2040     6924        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:283  
     2041     6925    4            CASE (45 /* KEY_PROFILE# */);
              6925                     /* PROFILE COMMAND                              */

     2042     6926    4               PROF_NAME.L# = OC_PARAM$ -> OC$PROFILE.P_COUNT;

   6926  6 005431   000000 470400 xsym               LDP0    OC_PARAM$
         6 005432   000000 100500                    MLR     fill='000'O
         6 005433   000001 000001                    ADSC9   1,,PR0                   cn=0,n=1
         6 005434   001046 000001 2                  ADSC9   PROF_NAME                cn=0,n=1

     2043     6927    4               PROF_NAME.NAME# =

   6927  6 005435   001046 236000 2                  LDQ     PROF_NAME
         6 005436   000033 772000                    QRL     27
         6 005437   000000 621006                    EAX1    0,QL
         6 005440   040000 100540                    MLR     fill='040'O
         6 005441   000001 200011                    ADSC9   1,,PR0                   cn=1,n=*X1
         6 005442   001046 200037 2                  ADSC9   PROF_NAME                cn=1,n=31

     2044     6928    4                 SUBSTR (OC_PARAM$->OC$PROFILE.P_NAME,
     2045     6929    4                 0,
     2046     6930    4                 PROF_NAME.L#);
     2047     6931    4               IF PROF_NAME = OC_CONSOLE.PROFILE (INDEX_)

   6931  6 005443   200006 236100                    LDQ     INDEX_,,AUTO
         6 005444   000370 402007                    MPY     248,DL
         6 005445   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 005446   000106 106400                    CMPC    fill='000'O
         6 005447   001046 000040 2                  ADSC9   PROF_NAME                cn=0,n=32
         6 005450   100072 000014                    ADSC9   58,Q,PR1                 cn=0,n=12
         6 005451   005457 601000 6                  TNZ     s:6938

     2048     6932    4               THEN
     2049     6933    5               DO;

     2050     6934    5                  CALL WRITE_ERR(31);

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:284  
   6934  6 005452   000263 236000 7                  LDQ     179
         6 005453   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 005454   006570 701000 6                  TSX1    WRITE_ERR
         6 005455   000000 011000                    NOP     0

     2051     6935    5                  RETURN;

   6935  6 005456   000000 702200 xent               TSX2  ! X66_ARET

     2052     6936    5               END;
     2053     6937
     2054     6938    4               IF OC_CONSOLE.LOGON (INDEX_) = ' '

   6938  6 005457   040000 106506                    CMPC    fill='040'O
         6 005460   100006 000010                    ADSC9   6,Q,PR1                  cn=0,n=8
         6 005461   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005462   005470 601000 6                  TNZ     s:6945

     2055     6939    4               THEN
     2056     6940    5               DO;

     2057     6941    5                  CALL WRITE_ERR(32);

   6941  6 005463   000265 236000 7                  LDQ     181
         6 005464   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 005465   006570 701000 6                  TSX1    WRITE_ERR
         6 005466   000000 011000                    NOP     0

     2058     6942    5                  RETURN;

   6942  6 005467   000000 702200 xent               TSX2  ! X66_ARET

     2059     6943    5               END;
     2060     6944
     2061     6945    4               NEW_PROF.BUF_ = VECTOR (PROF_BUFFER);

   6945  6 005470   000266 235000 7                  LDA     182
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:285  
         6 005471   200612 452500                    STP2    @MCOUNT+2,,AUTO
         6 005472   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 005473   000015 036003                    ADLQ    13,DU
         6 005474   001042 757000 2                  STAQ    NEW_PROF+6

     2062     6946    4               NEW_PROF.STATION_ =

   6946  6 005475   000267 235000 7                  LDA     183
         6 005476   200006 236100                    LDQ     INDEX_,,AUTO
         6 005477   200612 755100                    STA     @MCOUNT+2,,AUTO
         6 005500   000076 402003                    MPY     62,DU
         6 005501   000000 036000 xsym               ADLQ    OC_CONSOLE$
         6 005502   200612 235100                    LDA     @MCOUNT+2,,AUTO
         6 005503   001036 757000 2                  STAQ    NEW_PROF+2

     2063     6947    4                 VECTOR (OC_CONSOLE.STATION (INDEX_));
     2064     6948
     2065     6949    4               CALL M$PROFILE (NEW_PROF)

   6949  6 005504   001034 630400 2                  EPPR0   NEW_PROF
         6 005505   560014 713400                    CLIMB   alt,+57356
         6 005506   401400 401760                    pmme    nvectors=4
         6 005507   005517 702000 6                  TSX2    BAD_PROF

     2066     6950    4                 ALTRET (BAD_PROF);
     2067     6951
     2068     6952    4               OC_CONSOLE.PROFILE (INDEX_) = PROF_NAME;

   6952  6 005510   200006 236100                    LDQ     INDEX_,,AUTO
         6 005511   000370 402007                    MPY     248,DL
         6 005512   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 005513   000106 100400                    MLR     fill='000'O
         6 005514   001046 000014 2                  ADSC9   PROF_NAME                cn=0,n=12
         6 005515   000072 000014                    ADSC9   58,Q,PR0                 cn=0,n=12

     2069     6953
     2070     6954    5               DO WHILE ('0'B);
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:286  

   6954  6 005516   005547 710000 6                  TRA     s:6971

   6950  6 005517                       BAD_PROF     null
     2071     6955    5   BAD_PROF:      ;
     2072     6956    5                  MSG# = 374 /* PROFILE_MSG# */;

   6956  6 005517   000566 220003                    LDX0    374,DU
         6 005520   000310 740000 2                  STX0    MSG#

     2073     6957    5                  NP# = 2;

   6957  6 005521   002000 236003                    LDQ     1024,DU
         6 005522   000311 756000 2                  STQ     NP#

     2074     6958    5                  PROFMSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   6958  6 005523   000000 470400 xsym               LDP0    B$TCB$
         6 005524   000000 471500                    LDP1    0,,PR0
         6 005525   100102 236100                    LDQ     66,,PR1
         6 005526   000146 756000 2                  STQ     PROFMSGB

     2075     6959    5                  IF PROF_NAME.L# > 11

   6959  6 005527   001046 236000 2                  LDQ     PROF_NAME
         6 005530   777000 376003                    ANQ     -512,DU
         6 005531   014000 116003                    CMPQ    6144,DU
         6 005532   005536 603000 6                  TRC     s:6963
         6 005533   001046 236000 2                  LDQ     PROF_NAME
         6 005534   777000 316003                    CANQ    -512,DU
         6 005535   005541 601000 6                  TNZ     s:6965

     2076     6960    5                    OR
     2077     6961    5                    PROF_NAME.L# = 0
     2078     6962    5                  THEN
     2079     6963    5                  PROFMSGB.CODE = 0;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:287  
   6963  6 005536   000000 236003                    LDQ     0,DU
         6 005537   000147 552040 2                  STBQ    PROFMSGB+1,'40'O
         6 005540   005543 710000 6                  TRA     s:6967

     2080     6964    5                  ELSE
     2081     6965    5                  PROFMSGB.CODE = 1;

   6965  6 005541   001000 236003                    LDQ     512,DU
         6 005542   000147 552040 2                  STBQ    PROFMSGB+1,'40'O

     2082     6966
     2083     6967    5                  CALL OCO$IWRITE (OC_CADDR,MSG#,NP#,

   6967  6 005543   000270 630400 7                  EPPR0   184
         6 005544   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 005545   000000 701000 xent               TSX1    OCO$IWRITE
         6 005546   000000 011000                    NOP     0

     2084     6968    5                    PROFMSGC,PROFMSGB,0,' ',0);
     2085     6969    5               END;

     2086     6970
     2087     6971    4               RETURN;

   6971  6 005547   000000 702200 xent               TSX2  ! X66_ARET

     2088     6972        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:288  
     2089     6973
     2090     6974         /* Allow the operator to (attempt
     2091     6975              to) change his LPWSN for DOG
     2092     6976              displays                                                                */
     2093     6977    4            CASE (46 /* KEY_LPWSN# */);

     2094     6978
     2095     6979    4               IF ((OCN_ATTRS.INPUT_ & '200000'O /* M_SYS  */) ~= '0'B)

   6979  6 005550   000316 221000 2                  LDX1    OCN_ATTRS
         6 005551   200000 361003                    ANX1    65536,DU
         6 005552   005604 601000 6                  TNZ     LP_WSN_OK
         6 005553   000316 721000 2                  LXL1    OCN_ATTRS
         6 005554   200000 361003                    ANX1    65536,DU
         6 005555   005604 601000 6                  TNZ     LP_WSN_OK

     2096     6980    4                 OR
     2097     6981    4                 ((OCN_ATTRS.OUTPUT_ & '200000'O /* M_SYS  */) ~= '0'B)
     2098     6982    4               THEN
     2099     6983    4               GOTO LP_WSN_OK;
     2100     6984
     2101     6985
     2102     6986    4               CALL INDEX (I, '?', OC_CONSOLE.WSN(INDEX_));

   6986  6 005556   200006 236100                    LDQ     INDEX_,,AUTO
         6 005557   000370 402007                    MPY     248,DL
         6 005560   000000 470400 xsym               LDP0    OC_CONSOLE$
         6 005561   000000 124506                    SCM     mask='000'O
         6 005562   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         6 005563   000040 000001 7                  ADSC9   32                       cn=0,n=1
         6 005564   000000 000000 2                  ARG     I

     2103     6987    4               IF I = 8

   6987  6 005565   000000 235000 2                  LDA     I
         6 005566   000010 115007                    CMPA    8,DL
         6 005567   005577 600000 6                  TZE     s:6993
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:289  
         6 005570   000000 621005                    EAX1    0,AL
         6 005571   000000 471400 xsym               LDP1    OC_PARAM$
         6 005572   000000 722000 2                  LXL2    I
         6 005573   040140 106546                    CMPC    fill='040'O
         6 005574   000004 000011                    ADSC9   4,Q,PR0                  cn=0,n=*X1
         6 005575   100001 000012                    ADSC9   1,,PR1                   cn=0,n=*X2
         6 005576   005604 600000 6                  TZE     LP_WSN_OK

     2104     6988    4                 OR
     2105     6989    4                 (SUBSTR(OC_CONSOLE.WSN(INDEX_),0,I) ~=
     2106     6990    4                 SUBSTR(OC_PARAM$ -> OC$SETACCT.ACCT, 0, I))
     2107     6991    4               THEN
     2108     6992    5               DO;

     2109     6993    5                  CALL WRITE_ERR (33);

   6993  6 005577   000301 236000 7                  LDQ     193
         6 005600   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 005601   006570 701000 6                  TSX1    WRITE_ERR
         6 005602   000000 011000                    NOP     0

     2110     6994    5                  GOTO ENDLPWSN_CASE;

   6994  6 005603   005644 710000 6                  TRA     ENDLPWSN_CASE

   6987  6 005604                       LP_WSN_OK    null
     2111     6995    5               END; /* DO IF NOT_OKAY                                            */
     2112     6996
     2113     6997
     2114     6998    4   LP_WSN_OK:  ;
     2115     6999
     2116     7000    4               CALL INDEX (I,

   7000  6 005604   000000 470400 xsym               LDP0    OC_PARAM$
         6 005605   000000 124500                    SCM     mask='000'O
         6 005606   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 005607   000040 000001 7                  ADSC9   32                       cn=0,n=1
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:290  
         6 005610   000000 000000 2                  ARG     I

     2117     7001    4                 '?',
     2118     7002    4                 OC_PARAM$ -> OC$SETACCT.ACCT);
     2119     7003
     2120     7004    4               IF I ~= 8

   7004  6 005611   000000 235000 2                  LDA     I
         6 005612   000010 115007                    CMPA    8,DL
         6 005613   005621 600000 6                  TZE     s:7011

     2121     7005    4               THEN
     2122     7006    5               DO;

     2123     7007    5                  CALL WRITE_ERR (33);

   7007  6 005614   000301 236000 7                  LDQ     193
         6 005615   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 005616   006570 701000 6                  TSX1    WRITE_ERR
         6 005617   000000 011000                    NOP     0

     2124     7008    5                  GOTO ENDLPWSN_CASE;

   7008  6 005620   005644 710000 6                  TRA     ENDLPWSN_CASE

     2125     7009    5               END;
     2126     7010
     2127     7011    4               OC_CONSOLE.LP_WSN(INDEX_) =

   7011  6 005621   200006 236100                    LDQ     INDEX_,,AUTO
         6 005622   000076 402007                    MPY     62,DL
         6 005623   000002 736000                    QLS     2
         6 005624   000000 471400 xsym               LDP1    OC_CONSOLE$
         6 005625   040106 100500                    MLR     fill='040'O
         6 005626   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 005627   100010 000010                    ADSC9   8,Q,PR1                  cn=0,n=8

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:291  
     2128     7012    4                 OC_PARAM$ -> OC$SETACCT.ACCT;
     2129     7013    4               LPWSN_MSGB.LPWSN =

   7013  6 005630   000000 470400 xsym               LDP0    OC_PARAM$
         6 005631   040000 100500                    MLR     fill='040'O
         6 005632   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 005633   000201 000010 2                  ADSC9   LPWSN_MSGB               cn=0,n=8

     2130     7014    4                 OC_PARAM$ -> OC$SETACCT.ACCT;
     2131     7015
     2132     7016    4               MSG# = 376 /* LPWSN_MSG# */;

   7016  6 005634   000570 220003                    LDX0    376,DU
         6 005635   000310 740000 2                  STX0    MSG#

     2133     7017
     2134     7018    4               NP# = 1;

   7018  6 005636   001000 236003                    LDQ     512,DU
         6 005637   000311 756000 2                  STQ     NP#

     2135     7019
     2136     7020    4               CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7020  6 005640   000302 630400 7                  EPPR0   194
         6 005641   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 005642   000000 701000 xent               TSX1    OCO$IWRITE
         6 005643   000000 011000                    NOP     0

   7018  6 005644   006562 710000 6     ENDLPWSN_CA* TRA     IGNORE

     2137     7021    4                 LPWSN_MSGC, LPWSN_MSGB, 0, OCP_NON_STA, 0);
     2138     7022
     2139     7023
     2140     7024    4   ENDLPWSN_CASE: ;
     2141     7025
     2142     7026        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:292  
     2143     7027
     2144     7028
     2145     7029         /* Allow an operator at a SYSTEM
     2146     7030              console to set maximum platen
     2147     7031              width on IOM connected
     2148     7032              consoles                                                                */
     2149     7033    4            CASE (47 /* KEY_PWIDTH# */);

     2150     7034
     2151     7035    4               IF OC_PARAM$ -> OC$PWIDTH.PWIDTH > 132

   7035  6 005645   000000 470400 xsym               LDP0    OC_PARAM$
         6 005646   000100 100500                    MLR     fill='000'O
         6 005647   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         6 005650   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 005651   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 005652   000205 116007                    CMPQ    133,DL
         6 005653   005662 603000 6                  TRC     s:7040
         6 005654   000100 100500                    MLR     fill='000'O
         6 005655   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         6 005656   200613 000004                    ADSC9   @MCOUNT+3,,AUTO          cn=0,n=4
         6 005657   200613 236100                    LDQ     @MCOUNT+3,,AUTO
         6 005660   000110 116007                    CMPQ    72,DL
         6 005661   005667 603000 6                  TRC     s:7044

     2152     7036    4                 OR
     2153     7037    4                 OC_PARAM$ -> OC$PWIDTH.PWIDTH < 72
     2154     7038    4               THEN
     2155     7039    5               DO;

     2156     7040    5                  CALL WRITE_ERR (35);

   7040  6 005662   000313 236000 7                  LDQ     203
         6 005663   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 005664   006570 701000 6                  TSX1    WRITE_ERR
         6 005665   000000 011000                    NOP     0

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:293  
     2157     7041    5                  GOTO ENDPWIDTH_CASE;

   7041  6 005666   005705 710000 6                  TRA     ENDPWIDTH_CASE

     2158     7042    5               END;
     2159     7043
     2160     7044    4               OC_PLATEN_WIDTH = OC_PARAM$ -> OC$PWIDTH.PWIDTH;

   7044  6 005667   000000 100500                    MLR     fill='000'O
         6 005670   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         6 005671   000000 000004 xsym               ADSC9   OC_PLATEN_WIDTH          cn=0,n=4

     2161     7045
     2162     7046    4               PWIDTH_MSGB.PWIDTH = OC_PARAM$ -> OC$PWIDTH.PWIDTH;

   7046  6 005672   000000 100500                    MLR     fill='000'O
         6 005673   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         6 005674   000151 000004 2                  ADSC9   PWIDTH_MSGB              cn=0,n=4

     2163     7047
     2164     7048    4               NP# = 1;

   7048  6 005675   001000 236003                    LDQ     512,DU
         6 005676   000311 756000 2                  STQ     NP#

     2165     7049    4               MSG# = 375 /* PWIDTH_MSG# */;

   7049  6 005677   000567 221003                    LDX1    375,DU
         6 005700   000310 741000 2                  STX1    MSG#

     2166     7050
     2167     7051    4               CALL OCO$IWRITE ('200000'O /* M_SYS  */, MSG#, NP#,

   7051  6 005701   000315 630400 7                  EPPR0   205
         6 005702   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 005703   000000 701000 xent               TSX1    OCO$IWRITE
         6 005704   000000 011000                    NOP     0
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:294  

   7049  6 005705   006562 710000 6     ENDPWIDTH_C* TRA     IGNORE

     2168     7052    4                 PWIDTH_MSGC, PWIDTH_MSGB,
     2169     7053    4                 0, OCP_NON_STA, 0);
     2170     7054
     2171     7055    4   ENDPWIDTH_CASE: ;
     2172     7056
     2173     7057        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:295  
     2174     7058
     2175     7059
     2176     7060         /* If LADCFLG# is set (which
     2177     7061            means the installation is
     2178     7062            LADC) then ghost jobs may
     2179     7063            be invoked from the console.
     2180     7064                        */
     2181     7065
     2182     7066    4            CASE (48 /* KEY_GJOB# */);

     2183     7067
     2184     7068    4               CALL M$MONINFO (GET_LADC_FLAG)

   7068  6 005706   000040 630400 4                  EPPR0   GET_LADC_FLAG
         6 005707   420023 713400                    CLIMB   alt,+8211
         6 005710   402400 401760                    pmme    nvectors=6
         6 005711   005712 702000 6                  TSX2    KEEP_GOING1

     2185     7069    4                 ALTRET (KEEP_GOING1);

   7069  6 005712                       KEEP_GOING1  null
     2186     7070    4   KEEP_GOING1: ;
     2187     7071    4               IF GJOB.LADCFLG# ~= 0

   7071  6 005712   001155 235000 2                  LDA     GJOB+5
         6 005713   006016 600000 6                  TZE     s:7103

     2188     7072    4               THEN
     2189     7073    5               DO;

     2190     7074    5                  FPT_GJOB.ACCT_ = VECTOR(NIL);

   7074  6 005714   000326 237000 7                  LDAQ    214
         6 005715   001172 757000 2                  STAQ    FPT_GJOB+2

     2191     7075    5                  FPT_GJOB.PASS_ = VECTOR(NIL);

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:296  
   7075  6 005716   000326 237000 7                  LDAQ    214
         6 005717   001176 757000 2                  STAQ    FPT_GJOB+6

     2192     7076    5                  PTR$ = PINCRW (OC_PARAM$, 1);

   7076  6 005720   000000 236000 xsym               LDQ     OC_PARAM$
         6 005721   000001 036003                    ADLQ    1,DU
         6 005722   200010 756100                    STQ     PTR$,,AUTO

     2193     7077    5                  GJOB_NAME.L# = PTR$ -> TEXT.CNT;

   7077  6 005723   200010 470500                    LDP0    PTR$,,AUTO
         6 005724   000000 100500                    MLR     fill='000'O
         6 005725   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         6 005726   001206 000001 2                  ADSC9   GJOB_NAME                cn=0,n=1

     2194     7078    5                  GJOB_NAME.NAME# =

   7078  6 005727   000100 101500                    MRL     fill='000'O
         6 005730   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         6 005731   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 005732   200612 220100                    LDX0    @MCOUNT+2,,AUTO
         6 005733   000100 101500                    MRL     fill='000'O
         6 005734   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         6 005735   200613 000002                    ADSC9   @MCOUNT+3,,AUTO          cn=0,n=2
         6 005736   200613 221100                    LDX1    @MCOUNT+3,,AUTO
         6 005737   040000 100540                    MLR     fill='040'O
         6 005740   000000 200011                    ADSC9   0,,PR0                   cn=1,n=*X1
         6 005741   001206 200037 2                  ADSC9   GJOB_NAME                cn=1,n=31

     2195     7079    5                    SUBSTR (PTR$ -> TEXT.C, 0, PTR$ -> TEXT.CNT);
     2196     7080    5                  PTR$ = PINCRC (PTR$, (PTR$ -> TEXT.CNT + 1));

   7080  6 005742   000100 101500                    MRL     fill='000'O
         6 005743   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         6 005744   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 005745   200612 236100                    LDQ     @MCOUNT+2,,AUTO
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:297  
         6 005746   000020 736000                    QLS     16
         6 005747   200000 036007                    ADLQ    65536,DL
         6 005750   200010 036100                    ADLQ    PTR$,,AUTO
         6 005751   200010 756100                    STQ     PTR$,,AUTO

     2197     7081    5                  IF SUBSTR (PTR$ -> TEXT.C, 0, PTR$ -> TEXT.CNT) = ' '

   7081  6 005752   200010 470500                    LDP0    PTR$,,AUTO
         6 005753   000100 101500                    MRL     fill='000'O
         6 005754   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         6 005755   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 005756   200612 220100                    LDX0    @MCOUNT+2,,AUTO
         6 005757   000100 101500                    MRL     fill='000'O
         6 005760   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         6 005761   200613 000002                    ADSC9   @MCOUNT+3,,AUTO          cn=0,n=2
         6 005762   200613 221100                    LDX1    @MCOUNT+3,,AUTO
         6 005763   040000 106540                    CMPC    fill='040'O
         6 005764   000000 200011                    ADSC9   0,,PR0                   cn=1,n=*X1
         6 005765   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005766   005772 601000 6                  TNZ     s:7088

     2198     7082    5                  THEN
     2199     7083    6                  DO;

     2200     7084    6                     FPT_GJOB.CCBUF_ = VECTOR (NIL);

   7084  6 005767   000326 237000 7                  LDAQ    214
         6 005770   001200 757000 2                  STAQ    FPT_GJOB+8

     2201     7085    6                  END;

   7085  6 005771   006007 710000 6                  TRA     s:7095

     2202     7086    5                  ELSE
     2203     7087    6                  DO;

     2204     7088    6                     FPT_GJOB.CCBUF_ = VECTOR (SUBSTR
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:298  

   7088  6 005772   000100 101500                    MRL     fill='000'O
         6 005773   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         6 005774   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 005775   200612 220100                    LDX0    @MCOUNT+2,,AUTO
         6 005776   000100 101500                    MRL     fill='000'O
         6 005777   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         6 006000   200613 000002                    ADSC9   @MCOUNT+3,,AUTO          cn=0,n=2
         6 006001   200613 221100                    LDX1    @MCOUNT+3,,AUTO
         6 006002   000000 635011                    EAA     0,X1
         6 006003   000002 771000                    ARL     2
         6 006004   000140 135007                    SBLA    96,DL
         6 006005   200000 036007                    ADLQ    65536,DL
         6 006006   001200 757000 2                  STAQ    FPT_GJOB+8

     2205     7089    6                       (PTR$ -> TEXT.C, 0, PTR$ -> TEXT.CNT));
     2206     7090    6                  END;

     2207     7091
     2208     7092         /* Do not allow SLUG to
     2209     7093            log this ghost on                                                         */
     2210     7094
     2211     7095    5                  FPT_GJOB.V.SLEAZE# = '1'B;

   7095  6 006007   200000 236003                    LDQ     65536,DU
         6 006010   001204 256000 2                  ORSQ    FPT_GJOB+12

     2212     7096
     2213     7097    5                  CALL M$GJOB (FPT_GJOB)

   7097  6 006011   001170 630400 2                  EPPR0   FPT_GJOB
         6 006012   420022 713400                    CLIMB   alt,+8210
         6 006013   402400 401760                    pmme    nvectors=6
         6 006014   006023 702000 6                  TSX2    GJOB_TROUBLE

     2214     7098    5                    ALTRET (GJOB_TROUBLE);
     2215     7099
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:299  
     2216     7100    5               END;

   7100  6 006015   006022 710000 6                  TRA     s:7106

     2217     7101    4               ELSE
     2218     7102    5               DO;

     2219     7103    5                  CALL WRITE_ERR(36);

   7103  6 006016   000331 236000 7                  LDQ     217
         6 006017   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 006020   006570 701000 6                  TSX1    WRITE_ERR
         6 006021   000000 011000                    NOP     0

     2220     7104    5               END;

     2221     7105
     2222     7106    5               DO WHILE ('0'B);

   7106  6 006022   006562 710000 6                  TRA     IGNORE

     2223     7107    5   GJOB_TROUBLE:
     2224     7108    5                  MSG# = 377 /* GJOB_MSG# */;

   7108  6 006023   000571 220003       GJOB_TROUBLE LDX0    377,DU
         6 006024   000310 740000 2                  STX0    MSG#

     2225     7109    5                  NP# = 2;

   7109  6 006025   002000 236003                    LDQ     1024,DU
         6 006026   000311 756000 2                  STQ     NP#

     2226     7110    5                  GJOB_INT_MSGB.ERROR = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   7110  6 006027   000000 470400 xsym               LDP0    B$TCB$
         6 006030   000000 471500                    LDP1    0,,PR0
         6 006031   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:300  
         6 006032   000203 756000 2                  STQ     GJOB_INT_MSGB

     2227     7111    5                  GJOB_INT_MSGB.CODE = 0;

   7111  6 006033   000000 236003                    LDQ     0,DU
         6 006034   000204 552040 2                  STBQ    GJOB_INT_MSGB+1,'40'O

     2228     7112    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7112  6 006035   000332 630400 7                  EPPR0   218
         6 006036   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006037   000000 701000 xent               TSX1    OCO$IWRITE
         6 006040   000000 011000                    NOP     0

     2229     7113    5                    GJOB_INT_MSGC, GJOB_INT_MSGB, 0, ' ', 0);
     2230     7114    5               END;

   7114  6 006041   006562 710000 6                  TRA     IGNORE

     2231     7115        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:301  
     2232     7116
     2233     7117    4            CASE (49 /* KEY_ZAPPHASE# */);

     2234     7118
     2235     7119    4               MSG# = 379 /* ZAPPHASE_MSG# */;

   7119  6 006042   000573 221003                    LDX1    379,DU
         6 006043   000310 741000 2                  STX1    MSG#

     2236     7120    4               NP# = 3;

   7120  6 006044   003000 236003                    LDQ     1536,DU
         6 006045   000311 756000 2                  STQ     NP#

     2237     7121
     2238     7122    4               IF ~OC_ZIP

   7122  6 006046   000000 236000 xsym               LDQ     OC_ZIP
         6 006047   400000 376003                    ANQ     -131072,DU
         6 006050   400000 676003                    ERQ     -131072,DU
         6 006051   006061 600000 6                  TZE     s:7131

     2239     7123    4               THEN
     2240     7124    5               DO;

     2241     7125    5                  ZAP_PHASE_MSGB.PHASE = 0;

   7125  6 006052   000000 236003                    LDQ     0,DU
         6 006053   000212 552040 2                  STBQ    ZAP_PHASE_MSGB,'40'O

     2242     7126    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7126  6 006054   000342 630400 7                  EPPR0   226
         6 006055   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006056   000000 701000 xent               TSX1    OCO$IWRITE
         6 006057   000000 011000                    NOP     0

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:302  
     2243     7127    5                    ZAP_PHASE_MSGC, ZAP_PHASE_MSGB, 0, ' ', 0);
     2244     7128    5                  GOTO END_ZAPPHASE_CASE;

   7128  6 006060   006125 710000 6                  TRA     END_ZAPPHASE_CASE

     2245     7129    5               END;
     2246     7130
     2247     7131    4               ZAP_PHASE_MSGB.PHASE = OCD_ZAPPHASE;

   7131  6 006061   000000 236000 xsym               LDQ     OCD_ZAPPHASE
         6 006062   000212 552040 2                  STBQ    ZAP_PHASE_MSGB,'40'O

     2248     7132    4               ZAP_PHASE_MSGB.TIME = OCD_ZAPTIME;

   7132  6 006063   040000 100400                    MLR     fill='040'O
         6 006064   000000 000013 xsym               ADSC9   OCD_ZAPTIME              cn=0,n=11
         6 006065   000212 200013 2                  ADSC9   ZAP_PHASE_MSGB           cn=1,n=11

     2249     7133
     2250     7134    4               CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7134  6 006066   000342 630400 7                  EPPR0   226
         6 006067   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006070   000000 701000 xent               TSX1    OCO$IWRITE
         6 006071   000000 011000                    NOP     0

     2251     7135    4                 ZAP_PHASE_MSGC, ZAP_PHASE_MSGB, 0, ' ', 0);
     2252     7136
     2253     7137         /* If not waiting for MING
     2254     7138            ghosts, go to end of case                                                 */
     2255     7139
     2256     7140    4               IF OCD_ZAPPHASE ~= 4 /* OCD_MING# */

   7140  6 006072   000000 236000 xsym               LDQ     OCD_ZAPPHASE
         6 006073   777000 376003                    ANQ     -512,DU
         6 006074   004000 116003                    CMPQ    2048,DU
         6 006075   006125 601000 6                  TNZ     END_ZAPPHASE_CASE
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:303  

     2257     7141    4               THEN
     2258     7142    4               GOTO END_ZAPPHASE_CASE;
     2259     7143
     2260     7144    5               DO ZI = 0 TO 15/*JG_MING#    */;

   7144  6 006076   000001 450000 2                  STZ     ZI

     2261     7145    5                  IF ~OCD_GHOSTS.BACK (ZI)

   7145  6 006077   000001 236000 2                  LDQ     ZI
         6 006100   000003 402007                    MPY     3,DL
         6 006101   000000 236006 xsym               LDQ     OCD_GHOSTS,QL
         6 006102   000001 736000                    QLS     1
         6 006103   400000 376003                    ANQ     -131072,DU
         6 006104   400000 676003                    ERQ     -131072,DU
         6 006105   006120 600000 6                  TZE     s:7154
         6 006106   000001 235000 2                  LDA     ZI
         6 006107   000004 115007                    CMPA    4,DL
         6 006110   006120 603000 6                  TRC     s:7154

     2262     7146    5                    AND ZI <= 3
     2263     7147    5                  THEN
     2264     7148    6                  DO;

     2265     7149    6                     ZAP_PHASE_MSGB.PHASE = 6;

   7149  6 006111   006000 236003                    LDQ     3072,DU
         6 006112   000212 552040 2                  STBQ    ZAP_PHASE_MSGB,'40'O

     2266     7150    6                     ZAP_PHASE_MSGB.MING = ZI;

   7150  6 006113   000215 755000 2                  STA     ZAP_PHASE_MSGB+3

     2267     7151    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7151  6 006114   000342 630400 7                  EPPR0   226
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:304  
         6 006115   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006116   000000 701000 xent               TSX1    OCO$IWRITE
         6 006117   000000 011000                    NOP     0

     2268     7152    6                       ZAP_PHASE_MSGC, ZAP_PHASE_MSGB, 0, ' ', 0);
     2269     7153    6                  END;

     2270     7154    5               END;

   7154  6 006120   000001 235000 2                  LDA     ZI
         6 006121   000001 035007                    ADLA    1,DL
         6 006122   000001 755000 2                  STA     ZI
         6 006123   000020 115007                    CMPA    16,DL
         6 006124   006077 602000 6                  TNC     s:7145

   7152  6 006125   006562 710000 6     END_ZAPPHAS* TRA     IGNORE

     2271     7155
     2272     7156    4   END_ZAPPHASE_CASE:;
     2273     7157        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:305  
     2274     7158    4            CASE (50 /* KEY_STARTTP# */);

     2275     7159
     2276     7160    4               MSG# = 382 /* STARTTP_MSG# */;

   7160  6 006126   000576 221003                    LDX1    382,DU
         6 006127   000310 741000 2                  STX1    MSG#

     2277     7161    4               NP# = 3;

   7161  6 006130   003000 236003                    LDQ     1536,DU
         6 006131   000311 756000 2                  STQ     NP#

     2278     7162
     2279     7163    4               GJOB_ACCT.ACCT# = OC_PARAM$ -> OC$STARTTP.ACCT;

   7163  6 006132   000000 470400 xsym               LDP0    OC_PARAM$
         6 006133   040000 100500                    MLR     fill='040'O
         6 006134   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 006135   001216 000010 2                  ADSC9   GJOB_ACCT                cn=0,n=8

     2280     7164    4               FPT_GJOB.ACCT_ = VECTOR (GJOB_ACCT);

   7164  6 006136   000352 237000 7                  LDAQ    234
         6 006137   001172 757000 2                  STAQ    FPT_GJOB+2

     2281     7165
     2282     7166    4               GJOB_NAME.L# = OC_PARAM$ -> OC$STARTTP.I_CNT;

   7166  6 006140   000000 100500                    MLR     fill='000'O
         6 006141   000003 000001                    ADSC9   3,,PR0                   cn=0,n=1
         6 006142   001206 000001 2                  ADSC9   GJOB_NAME                cn=0,n=1

     2283     7167    4               GJOB_NAME.NAME# = OC_PARAM$ -> OC$STARTTP.INSTANCE;

   7167  6 006143   000100 101500                    MRL     fill='000'O
         6 006144   000003 000001                    ADSC9   3,,PR0                   cn=0,n=1
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:306  
         6 006145   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 006146   200612 222100                    LDX2    @MCOUNT+2,,AUTO
         6 006147   040000 100540                    MLR     fill='040'O
         6 006150   000003 200012                    ADSC9   3,,PR0                   cn=1,n=*X2
         6 006151   001206 200037 2                  ADSC9   GJOB_NAME                cn=1,n=31

     2284     7168    4               TP_MSGB.TPNAME = ' ';

   7168  6 006152   040000 100400                    MLR     fill='040'O
         6 006153   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 006154   000220 200010 2                  ADSC9   TP_MSGB+1                cn=1,n=8

     2285     7169    4               TP_MSGB.TPNAME = OC_PARAM$ -> OC$STARTTP.ACCT;

   7169  6 006155   040000 100500                    MLR     fill='040'O
         6 006156   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 006157   000220 200010 2                  ADSC9   TP_MSGB+1                cn=1,n=8

     2286     7170
     2287     7171    4               PTR$ = PINCRC (OC_PARAM$,

   7171  6 006160   000100 101500                    MRL     fill='000'O
         6 006161   000003 000001                    ADSC9   3,,PR0                   cn=0,n=1
         6 006162   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 006163   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 006164   000020 736000                    QLS     16
         6 006165   000160 036000 7                  ADLQ    112
         6 006166   000000 036000 xsym               ADLQ    OC_PARAM$
         6 006167   200010 756100                    STQ     PTR$,,AUTO

     2288     7172    4                 4
     2289     7173    4                 + LENGTHC (OC_PARAM$ -> OC$STARTTP.ACCT)
     2290     7174    4                 + LENGTHC (OC_PARAM$ -> OC$STARTTP.I_CNT)
     2291     7175    4                 + OC_PARAM$ -> OC$STARTTP.I_CNT);
     2292     7176
     2293     7177    4               IF PTR$ -> OC$TPPASS.PASS ~= ' '

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:307  
   7177  6 006170   200010 471500                    LDP1    PTR$,,AUTO
         6 006171   040000 106500                    CMPC    fill='040'O
         6 006172   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 006173   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 006174   006203 600000 6                  TZE     s:7185

     2294     7178    4               THEN
     2295     7179    5               DO;

     2296     7180    5                  GJOB_PASS.PASS# = PTR$ -> OC$TPPASS.PASS;

   7180  6 006175   040000 100500                    MLR     fill='040'O
         6 006176   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 006177   001220 000010 2                  ADSC9   GJOB_PASS                cn=0,n=8

     2297     7181    5                  FPT_GJOB.PASS_ = VECTOR (GJOB_PASS);

   7181  6 006200   000354 237000 7                  LDAQ    236
         6 006201   001176 757000 2                  STAQ    FPT_GJOB+6

     2298     7182    5               END;

   7182  6 006202   006205 710000 6                  TRA     s:7188

     2299     7183    4               ELSE
     2300     7184    5               DO;

     2301     7185    5                  FPT_GJOB.PASS_ = VECTOR (NIL);

   7185  6 006203   000326 237000 7                  LDAQ    214
         6 006204   001176 757000 2                  STAQ    FPT_GJOB+6

     2302     7186    5               END;

     2303     7187
     2304     7188    4               FPT_GJOB.CCBUF_ = VECTOR (NIL);

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:308  
   7188  6 006205   000326 237000 7                  LDAQ    214
         6 006206   001200 757000 2                  STAQ    FPT_GJOB+8

     2305     7189
     2306     7190         /* Allow SLUG to log the instance on                                         */
     2307     7191
     2308     7192    4               FPT_GJOB.V.SLEAZE# = '0'B;

   7192  6 006207   000356 236000 7                  LDQ     238
         6 006210   001204 356000 2                  ANSQ    FPT_GJOB+12

     2309     7193
     2310     7194    4               CALL M$GJOB (FPT_GJOB) ALTRET (NO_START);

   7194  6 006211   001170 630400 2                  EPPR0   FPT_GJOB
         6 006212   420022 713400                    CLIMB   alt,+8210
         6 006213   402400 401760                    pmme    nvectors=6
         6 006214   006224 702000 6                  TSX2    NO_START

     2311     7195
     2312     7196    4               TP_MSGB.CODE = 0;

   7196  6 006215   000000 236003                    LDQ     0,DU
         6 006216   000220 552040 2                  STBQ    TP_MSGB+1,'40'O

     2313     7197    4               CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7197  6 006217   000357 630400 7                  EPPR0   239
         6 006220   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006221   000000 701000 xent               TSX1    OCO$IWRITE
         6 006222   000000 011000                    NOP     0

     2314     7198    4                 TP_MSGC, TP_MSGB, 0, ' ', 0);
     2315     7199
     2316     7200    5               DO WHILE ('0'B);

   7200  6 006223   006236 710000 6                  TRA     END_STARTTP_CASE
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:309  

   7197  6 006224                       NO_START     null
     2317     7201    5   NO_START:      ;
     2318     7202    5                  TP_MSGB.ERROR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   7202  6 006224   000000 470400 xsym               LDP0    B$TCB$
         6 006225   000000 471500                    LDP1    0,,PR0
         6 006226   100102 236100                    LDQ     66,,PR1
         6 006227   000217 756000 2                  STQ     TP_MSGB

     2319     7203    5                  TP_MSGB.CODE = 1;

   7203  6 006230   001000 236003                    LDQ     512,DU
         6 006231   000220 552040 2                  STBQ    TP_MSGB+1,'40'O

     2320     7204    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7204  6 006232   000357 630400 7                  EPPR0   239
         6 006233   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006234   000000 701000 xent               TSX1    OCO$IWRITE
         6 006235   000000 011000                    NOP     0

     2321     7205    5                    TP_MSGC, TP_MSGB, 0, ' ', 0);
     2322     7206    5               END;

   7201  6 006236   006562 710000 6     END_STARTTP* TRA     IGNORE

     2323     7207
     2324     7208    4   END_STARTTP_CASE: ;
     2325     7209        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:310  
     2326     7210    4            CASE (51 /* KEY_TPSLASH# */,52 /* KEY_TPHEADER# */);

     2327     7211
     2328     7212    4               MSG# = 378 /* STATION_MSG# */;

   7212  6 006237   000572 221003                    LDX1    378,DU
         6 006240   000310 741000 2                  STX1    MSG#

     2329     7213    4               NP# = 2;

   7213  6 006241   002000 236003                    LDQ     1024,DU
         6 006242   000311 756000 2                  STQ     NP#

     2330     7214    4               STA_MSGB.CODE = 1;

   7214  6 006243   001000 236003                    LDQ     512,DU
         6 006244   000210 552040 2                  STBQ    STA_MSGB+2,'40'O

     2331     7215    4               STA_MSGB.STATION = OC_PARAM$ -> OC$TPSEND.TP_STA;

   7215  6 006245   000000 470400 xsym               LDP0    OC_PARAM$
         6 006246   040000 100500                    MLR     fill='040'O
         6 006247   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 006250   000206 000010 2                  ADSC9   STA_MSGB                 cn=0,n=8

     2332     7216
     2333     7217    5               DO I = 0 TO ((LENGTHC (JG_GHOSTS)) / 8);

   7217  6 006251   000000 450000 2                  STZ     I
         6 006252   006272 710000 6                  TRA     s:7225+3

     2334     7218    5                  IF OC_PARAM$ -> OC$TPSEND.TP_STA = JG_GHOSTS (I)

   7218  6 006253   000000 235000 2                  LDA     I
         6 006254   000003 735000                    ALS     3
         6 006255   000000 470400 xsym               LDP0    OC_PARAM$
         6 006256   040005 106500                    CMPC    fill='040'O
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:311  
         6 006257   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 006260   000372 000010 2                  ADSC9   JG_GHOSTS,A              cn=0,n=8
         6 006261   006267 601000 6                  TNZ     s:7225

     2335     7219    5                  THEN
     2336     7220    6                  DO;

     2337     7221    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7221  6 006262   000367 630400 7                  EPPR0   247
         6 006263   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006264   000000 701000 xent               TSX1    OCO$IWRITE
         6 006265   000000 011000                    NOP     0

     2338     7222    6                       STA_MSGC, STA_MSGB, 0, ' ', 0);
     2339     7223    6                     RETURN;

   7223  6 006266   000000 702200 xent               TSX2  ! X66_ARET

     2340     7224    6                  END;
     2341     7225    5               END;

   7225  6 006267   000000 236000 2                  LDQ     I
         6 006270   000001 036007                    ADLQ    1,DL
         6 006271   000000 756000 2                  STQ     I
         6 006272   000000 235000 2                  LDA     I
         6 006273   000031 115007                    CMPA    25,DL
         6 006274   006253 602000 6                  TNC     s:7218

     2342     7226
     2343     7227         /* Check other illegal TP stations, i.e..
     2344     7228            M$KEYINs, Console Ghosts, RHESUS,
     2345     7229            and MONKEY.                                                               */
     2346     7230
     2347     7231    4               IF SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_STA, 0, 2) = '**'

   7231  6 006275   040000 106500                    CMPC    fill='040'O
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:312  
         6 006276   000001 000002                    ADSC9   1,,PR0                   cn=0,n=2
         6 006277   000066 000002 4                  ADSC9   GET_LADC_FLAG+22         cn=0,n=2
         6 006300   006315 600000 6                  TZE     s:7240
         6 006301   040000 106500                    CMPC    fill='040'O
         6 006302   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         6 006303   000067 000004 4                  ADSC9   GET_LADC_FLAG+23         cn=0,n=4
         6 006304   006315 600000 6                  TZE     s:7240
         6 006305   040000 106500                    CMPC    fill='040'O
         6 006306   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
         6 006307   000070 000006 4                  ADSC9   GET_LADC_FLAG+24         cn=0,n=6
         6 006310   006315 600000 6                  TZE     s:7240
         6 006311   040000 106500                    CMPC    fill='040'O
         6 006312   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
         6 006313   000072 000006 4                  ADSC9   GET_LADC_FLAG+26         cn=0,n=6
         6 006314   006322 601000 6                  TNZ     s:7247

     2348     7232    4                 OR
     2349     7233    4                 SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_STA, 0, 4) = 'GHST'
     2350     7234    4                 OR
     2351     7235    4                 SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_STA, 0, 6) = 'RHESUS'
     2352     7236    4                 OR
     2353     7237    4                 SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_STA, 0, 6) = 'MONKEY'
     2354     7238    4               THEN
     2355     7239    5               DO;

     2356     7240    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7240  6 006315   000367 630400 7                  EPPR0   247
         6 006316   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006317   000000 701000 xent               TSX1    OCO$IWRITE
         6 006320   000000 011000                    NOP     0

     2357     7241    5                    STA_MSGC, STA_MSGB, 0, ' ', 0);
     2358     7242    5                  RETURN;

   7242  6 006321   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:313  
     2359     7243    5               END;
     2360     7244         /*   Check for '?'
     2361     7245              (Prohibited: cannot
     2362     7246              wildcard station name.)                                                 */
     2363     7247    4               CALL INDEX(I,'?',OC_PARAM$ -> OC$TPSEND.TP_STA)

   7247  6 006322   000000 124500                    SCM     mask='000'O
         6 006323   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 006324   000040 000001 7                  ADSC9   32                       cn=0,n=1
         6 006325   000000 000000 2                  ARG     I
         6 006326   006334 606400 6                  TTN     TP_SEND_IT

     2364     7248    4                 ALTRET (TP_SEND_IT);
     2365     7249         /* Not ALTRETing means '?'
     2366     7250           was found, so error.                                                       */
     2367     7251    4               CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7251  6 006327   000367 630400 7                  EPPR0   247
         6 006330   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006331   000000 701000 xent               TSX1    OCO$IWRITE
         6 006332   000000 011000                    NOP     0

     2368     7252    4                 STA_MSGC, STA_MSGB, 0, ' ', 0);
     2369     7253    4               RETURN;

   7253  6 006333   000000 702200 xent               TSX2  ! X66_ARET

     2370     7254    4   TP_SEND_IT:
     2371     7255
     2372     7256    5               IF OC_PARAM1.KEYIN# = 51 /* KEY_TPSLASH# */ THEN DO;

   7256  6 006334   000000 220000 xsym  TP_SEND_IT   LDX0    OC_PARAM
         6 006335   000063 100003                    CMPX0   51,DU
         6 006336   006411 601000 6                  TNZ     s:7284

     2373     7257         /* Send message                                                              */
     2374     7258
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:314  
     2375     7259    5                  CSCG_EVID.CADDR = OC_CADDR;

   7259  6 006337   000000 221000 xsym               LDX1    OC_CADDR
         6 006340   000317 741000 2                  STX1    CSCG_EVID

     2376     7260    5                  WR_STA.V.EVENT# = BITBIN (CSCG_EVID);

   7260  6 006341   000317 235000 2                  LDA     CSCG_EVID
         6 006342   000473 755000 2                  STA     WR_STA+9

     2377     7261    5                  STA.STATION# = OC_PARAM$ -> OC$TPSEND.TP_STA;

   7261  6 006343   000000 470400 xsym               LDP0    OC_PARAM$
         6 006344   040000 100500                    MLR     fill='040'O
         6 006345   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         6 006346   000452 000010 2                  ADSC9   STA                      cn=0,n=8

     2378     7262    5                  TP_INSTRUCTION.ATTR = OC_PARAM$ -> OC$TPSEND.ATTR;

   7262  6 006347   000000 100500                    MLR     fill='000'O
         6 006350   000000 400002                    ADSC9   0,,PR0                   cn=2,n=2
         6 006351   000017 400002 2                  ADSC9   TP_INSTRUCTION           cn=2,n=2

     2379     7263    5                  TP_INSTRUCTION.KEY_NUM = 2 /* KEY_TPSEND# */;

   7263  6 006352   000002 236003                    LDQ     2,DU
         6 006353   000017 552020 2                  STBQ    TP_INSTRUCTION,'20'O

     2380     7264    5                  TP_INSTRUCTION.LENGTH = OC_PARAM$ -> OC$TPSEND.TP_LEN;

   7264  6 006354   000000 100500                    MLR     fill='000'O
         6 006355   000003 000001                    ADSC9   3,,PR0                   cn=0,n=1
         6 006356   000020 000001 2                  ADSC9   TP_INSTRUCTION+1         cn=0,n=1

     2381     7265    5                  TP_INSTRUCTION.INSTRUCT

   7265  6 006357   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:315  
         6 006360   000003 000001                    ADSC9   3,,PR0                   cn=0,n=1
         6 006361   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 006362   200612 222100                    LDX2    @MCOUNT+2,,AUTO
         6 006363   040000 100500                    MLR     fill='040'O
         6 006364   000003 200136                    ADSC9   3,,PR0                   cn=1,n=94
         6 006365   000020 200137 2                  ADSC9   TP_INSTRUCTION+1         cn=1,n=95

     2382     7266    5                    = SUBSTR (OC_PARAM$ -> OC$TPSEND.TP_CMD, 0, 94);
     2383     7267
     2384     7268    5                  WR_STA.BUF_.BUF$ = ADDR (TP_INSTRUCTION);

   7268  6 006366   000377 236000 7                  LDQ     255
         6 006367   000467 756000 2                  STQ     WR_STA+5

     2385     7269    5                  WR_STA.BUF_.BOUND = (LENGTHC (TP_INSTRUCTION.ATTR) +

   7269  6 006370   000020 236000 2                  LDQ     TP_INSTRUCTION+1
         6 006371   000033 772000                    QRL     27
         6 006372   000005 036007                    ADLQ    5,DL
         6 006373   000020 736000                    QLS     16
         6 006374   000466 676000 2                  ERQ     WR_STA+4
         6 006375   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 006376   000466 656000 2                  ERSQ    WR_STA+4

     2386     7270    5                    LENGTHC (TP_INSTRUCTION.KEY_NUM) +
     2387     7271    5                    1 + /* Remaining portion of first word.                      */
     2388     7272    5                    LENGTHC (TP_INSTRUCTION.LENGTH) +
     2389     7273    5                    TP_INSTRUCTION.LENGTH);
     2390     7274    5                  CALL M$WRITE (WR_STA) ALTRET (TP_TROUBLE);

   7274  6 006377   000462 630400 2                  EPPR0   WR_STA
         6 006400   440001 713400                    CLIMB   alt,write
         6 006401   401400 401760                    pmme    nvectors=4
         6 006402   006406 702000 6                  TSX2    TP_TROUBLE

     2391     7275    5                  WR_STA.BUF_.BUF$ = ADDR (OC_PARAM);

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:316  
   7275  6 006403   000037 236000 7                  LDQ     31
         6 006404   000467 756000 2                  STQ     WR_STA+5

     2392     7276
     2393     7277    6                  DO WHILE ('0'B);

   7277  6 006405   006562 710000 6                  TRA     IGNORE

     2394     7278    6   TP_TROUBLE:
     2395     7279    6                     WR_STA.BUF_.BUF$ = ADDR (OC_PARAM);

   7279  6 006406   000037 236000 7     TP_TROUBLE   LDQ     31
         6 006407   000467 756000 2                  STQ     WR_STA+5

     2396     7280    6                     GOTO ARRGH;

   7280  6 006410   006546 710000 6                  TRA     ARRGH

     2397     7281    6                  END;

     2398     7282    5               END;
     2399     7283    5               ELSE DO ; /* must be a TPHEADER keyin                             */

     2400     7284    5                  FOUND = '0'B;

   7284  6 006411   000010 450000 2                  STZ     FOUND

     2401     7285    5                  CALL M$OPEN(OPEN_TP_CNTRL) ALTRET(SKIPIT);

   7285  6 006412   000634 630400 2                  EPPR0   OPEN_TP_CNTRL
         6 006413   450000 713400                    CLIMB   alt,open
         6 006414   410400 401760                    pmme    nvectors=18
         6 006415   006511 702000 6                  TSX2    SKIPIT

     2402     7286    5                  INSTANCE$=PINCRW(B$DS7$,SIZEW(PC$HDR));

   7286  6 006416   000000 236000 xsym               LDQ     B$DS7$
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:317  
         6 006417   000001 036003                    ADLQ    1,DU
         6 006420   200605 756100                    STQ     INSTANCE$,,AUTO

     2403     7287    6                  DO I = 1 TO PC$HDR.CURINSTANCES;

   7287  6 006421   000001 235007                    LDA     1,DL
         6 006422   000000 755000 2                  STA     I
         6 006423   006501 710000 6                  TRA     s:7301+3

     2404     7288    6                     IF (NOT PC$INSTANCE.FLAGS.DELETED) AND

   7288  6 006424   200605 470500                    LDP0    INSTANCE$,,AUTO
         6 006425   000003 236100                    LDQ     3,,PR0
         6 006426   200000 316003                    CANQ    65536,DU
         6 006427   006473 601000 6                  TNZ     s:7300
         6 006430   000000 471400 xsym               LDP1    OC_PARAM$
         6 006431   040100 106500                    CMPC    fill='040'O
         6 006432   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 006433   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         6 006434   006473 601000 6                  TNZ     s:7300

     2405     7289    6                       (PC$INSTANCE.INSTANCE_NAME =
     2406     7290    6                       OC_PARAM$ -> OC$TPSEND.TP_STA) THEN
     2407     7291    7                     DO;

     2408     7292    7                        J = MINIMUM (80,OC_PARAM$ -> OC$TPSEND.TP_LEN);

   7292  6 006435   000100 101500                    MRL     fill='000'O
         6 006436   100003 000001                    ADSC9   3,,PR1                   cn=0,n=1
         6 006437   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 006440   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 006441   000120 116007                    CMPQ    80,DL
         6 006442   006445 602000 6                  TNC     s:7292+8
         6 006443   006445 600000 6                  TZE     s:7292+8
         6 006444   000120 236007                    LDQ     80,DL
         6 006445   000002 756000 2                  STQ     J

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:318  
     2409     7293    7                        PC$INSTANCE.HDR.CNT = J ;

   7293  6 006446   000033 736000                    QLS     27
         6 006447   000004 552140                    STBQ    4,'40'O,PR0

     2410     7294    7                        PC$INSTANCE.HDR.MSG =

   7294  6 006450   000100 101500                    MRL     fill='000'O
         6 006451   100003 000001                    ADSC9   3,,PR1                   cn=0,n=1
         6 006452   200612 000002                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=2
         6 006453   200612 220100                    LDX0    @MCOUNT+2,,AUTO
         6 006454   040100 100540                    MLR     fill='040'O
         6 006455   100003 200010                    ADSC9   3,,PR1                   cn=1,n=*X0
         6 006456   000004 200120                    ADSC9   4,,PR0                   cn=1,n=80

     2411     7295    7                          OC_PARAM$ -> OC$TPSEND.TP_CMD ;
     2412     7296    7                        PC$INSTANCE.FLAGS.HEADER = ( J > 0) ;

   7296  6 006457   400000 220003                    LDX0    -131072,DU
         6 006460   000002 235000 2                  LDA     J
         6 006461   006463 605400 6                  TPNZ    s:7296+4
         6 006462   000000 220003                    LDX0    0,DU
         6 006463   000000 636010                    EAQ     0,X0
         6 006464   000002 772000                    QRL     2
         6 006465   000003 676100                    ERQ     3,,PR0
         6 006466   100000 376003                    ANQ     32768,DU
         6 006467   000003 656100                    ERSQ    3,,PR0

     2413     7297    7                        FOUND = '1'B;

   7297  6 006470   400000 236003                    LDQ     -131072,DU
         6 006471   000010 756000 2                  STQ     FOUND

     2414     7298    7                        GOTO DONE;

   7298  6 006472   006505 710000 6                  TRA     DONE

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:319  
     2415     7299    7                     END;
     2416     7300    6                     INSTANCE$ = PINCRW(INSTANCE$,SIZEW(PC$INSTANCE));

   7300  6 006473   200605 236100                    LDQ     INSTANCE$,,AUTO
         6 006474   000113 036003                    ADLQ    75,DU
         6 006475   200605 756100                    STQ     INSTANCE$,,AUTO

     2417     7301    6                  END;

   7301  6 006476   000000 235000 2                  LDA     I
         6 006477   000001 035007                    ADLA    1,DL
         6 006500   000000 755000 2                  STA     I
         6 006501   000000 470400 xsym               LDP0    B$DS7$
         6 006502   000000 236100                    LDQ     0,,PR0
         6 006503   000000 116000 2                  CMPQ    I
         6 006504   006424 603000 6                  TRC     s:7288

     2418     7302    5   DONE:          CALL M$CLOSE(CLOSE_TP_FILE) ALTRET(SKIPIT);

   7302  6 006505   000732 630400 2     DONE         EPPR0   CLOSE_TP_FILE
         6 006506   450001 713400                    CLIMB   alt,close
         6 006507   406000 401760                    pmme    nvectors=13
         6 006510   006511 702000 6                  TSX2    SKIPIT

     2419     7303
     2420     7304    5   SKIPIT:        IF NOT FOUND THEN

   7304  6 006511   000010 234000 2     SKIPIT       SZN     FOUND
         6 006512   006562 604000 6                  TMI     IGNORE

     2421     7305    6                  DO;

     2422     7306    6                     CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7306  6 006513   000367 630400 7                  EPPR0   247
         6 006514   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006515   000000 701000 xent               TSX1    OCO$IWRITE
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:320  
         6 006516   000000 011000                    NOP     0

     2423     7307    6                       STA_MSGC, STA_MSGB, 0, ' ', 0);
     2424     7308    6                     RETURN;

   7308  6 006517   000000 702200 xent               TSX2  ! X66_ARET

     2425     7309    6                  END;
     2426     7310    5               END;
     2427     7311        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:321  
     2428     7312    4            CASE (ELSE); /* CASE BUCKET                                          */

     2429     7313    4               CALL WRITE_ERR(99);

   7313  6 006520   000401 236000 7                  LDQ     257
         6 006521   200607 756100                    STQ     INSTANCE$+2,,AUTO
         6 006522   006570 701000 6                  TSX1    WRITE_ERR
         6 006523   000000 011000                    NOP     0

   7313  6 006524                       END_CASE     null
     2430     7314    4   END_CASE:   ;
     2431     7315    4            END; /* CASE (OC_PARAM1.KEYIN#)                                      */

     2432     7316    3         END; /* STA = 'KEYIN'                                                   */

   7316  6 006524   006562 710000 6                  TRA     IGNORE

     2433     7317    2         ELSE /* write parameters to correct station                             */
     2434     7318    3         DO;

   7314  6 006525                       WRITE_IT_OUT null
     2435     7319    3   WRITE_IT_OUT: ;
     2436     7320    3            IF ~OC_ZIP /* IF ZAP IS IN PROGRESS                                  */

   7320  6 006525   000000 236000 xsym               LDQ     OC_ZIP
         6 006526   400000 376003                    ANQ     -131072,DU
         6 006527   400000 676003                    ERQ     -131072,DU
         6 006530   006535 601000 6                  TNZ     s:7325
         6 006531   040000 106400                    CMPC    fill='040'O
         6 006532   000452 000010 2                  ADSC9   STA                      cn=0,n=8
         6 006533   000072 000006 4                  ADSC9   GET_LADC_FLAG+26         cn=0,n=6
         6 006534   006562 601000 6                  TNZ     IGNORE

     2437     7321    3              OR /* DONT SEND KEYINS TO                                          */
     2438     7322    3              STA.STATION# = 'MONKEY' /* ANYONE BUT MONKEY                       */
     2439     7323    3            THEN
     2440     7324    4            DO;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:322  

     2441     7325    4               CSCG_EVID.CADDR = OC_CADDR;

   7325  6 006535   000000 220000 xsym               LDX0    OC_CADDR
         6 006536   000317 740000 2                  STX0    CSCG_EVID

     2442     7326    4               WR_STA.V.EVENT# = BITBIN(CSCG_EVID);

   7326  6 006537   000317 235000 2                  LDA     CSCG_EVID
         6 006540   000473 755000 2                  STA     WR_STA+9

     2443     7327    4               CALL M$WRITE (WR_STA) ALTRET (ARRGH);

   7327  6 006541   000462 630400 2                  EPPR0   WR_STA
         6 006542   440001 713400                    CLIMB   alt,write
         6 006543   401400 401760                    pmme    nvectors=4
         6 006544   006546 702000 6                  TSX2    ARRGH

     2444     7328
     2445     7329    5               DO WHILE ('0'B /*FALSE#*/);

   7329  6 006545   006562 710000 6                  TRA     IGNORE

   7327  6 006546                       ARRGH        null
     2446     7330    5   ARRGH:         ;
     2447     7331    5                  MSG# = 378 /* STATION_MSG# */;

   7331  6 006546   000572 220003                    LDX0    378,DU
         6 006547   000310 740000 2                  STX0    MSG#

     2448     7332    5                  NP# = 2;

   7332  6 006550   002000 236003                    LDQ     1024,DU
         6 006551   000311 756000 2                  STQ     NP#

     2449     7333    5                  STA_MSGB.CODE = 0;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:323  
   7333  6 006552   000000 236003                    LDQ     0,DU
         6 006553   000210 552040 2                  STBQ    STA_MSGB+2,'40'O

     2450     7334    5                  STA_MSGB.STATION = STA.STATION#;

   7334  6 006554   000452 237000 2                  LDAQ    STA
         6 006555   000206 757000 2                  STAQ    STA_MSGB

     2451     7335    5                  CALL OCO$IWRITE (OC_CADDR, MSG#, NP#,

   7335  6 006556   000367 630400 7                  EPPR0   247
         6 006557   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006560   000000 701000 xent               TSX1    OCO$IWRITE
         6 006561   000000 011000                    NOP     0

     2452     7336    5                    STA_MSGC, STA_MSGB, 0, ' ', 0);
     2453     7337    5               END; /* DO WHILE (ALTRET)                                         */

     2454     7338    4            END; /* DO IF OKAY TO SEND IT                                        */

     2455     7339    3         END; /* DO IF STA ~= 'KEYIN'                                            */

   7335  6 006562                       IGNORE       null
     2456     7340
     2457     7341    2   IGNORE: ;
     2458     7342
     2459     7343    2      END; /* DO J = 0 TO NUM_STATIONS                                           */

   7343  6 006562   000002 054000 2                  AOS     J
         6 006563   000002 236000 2                  LDQ     J
         6 006564   000457 604000 6                  TMI     s:5663
         6 006565   000000 116000 xsym               CMPQ    OCS_NAMES
         6 006566   000457 602000 6                  TNC     s:5663

     2460     7344
     2461     7345    1      RETURN;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:324  
   7345  6 006567   000000 702200 xent               TSX2  ! X66_ARET

     2462     7346        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:325  
     2463     7347
     2464     7348        /*
     2465     7349             Internal routine WRITE_ERR
     2466     7350                                                */
     2467     7351    1   WRITE_ERR: PROC (OPTION_);

   7351  6 006570   200606 741300       WRITE_ERR    STX1  ! INSTANCE$+1,,AUTO

     2468     7352    2   DCL OPTION_ UBIN WORD;
     2469     7353
     2470     7354
     2471     7355    2      NP# = 1;

   7355  6 006571   001000 236003                    LDQ     512,DU
         6 006572   000311 756000 2                  STQ     NP#

     2472     7356    2      MSG# = 396 /* GENL_ERR_MSG# */;

   7356  6 006573   000614 220003                    LDX0    396,DU
         6 006574   000310 740000 2                  STX0    MSG#

     2473     7357    2      GHST_READC.COUNT_ = OPTION_;

   7357  6 006575   200607 470500                    LDP0    @OPTION_,,AUTO
         6 006576   000000 722100                    LXL2    0,,PR0
         6 006577   000061 742000 2                  STX2    GHST_READC

     2474     7358
     2475     7359    2      CALL OCO$IWRITE (OC_CADDR, MSG#, NP#, GHST_READB,

   7359  6 006600   000402 630400 7                  EPPR0   258
         6 006601   000026 631400 xsym               EPPR1   B_VECTNIL+22
         6 006602   000000 701000 xent               TSX1    OCO$IWRITE
         6 006603   000000 011000                    NOP     0

     2476     7360    2        GHST_READC, 0, OCP_NON_STA, 0);
     2477     7361    2      RETURN;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:326  

   7361  6 006604   200606 221300                    LDX1  ! INSTANCE$+1,,AUTO
         6 006605   000001 702211                    TSX2  ! 1,X1

     2478     7362    2   END WRITE_ERR;
     2479     7363
     2480     7364        %EJECT;
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:327  
     2481     7365        /*
     2482     7366             Internal routine MY_XLATE
     2483     7367                                                                          */
     2484     7368
     2485     7369    1   MY_XLATE: PROC (MPTR$, MCOUNT);

   7369  6 006606   200606 741300       MY_XLATE     STX1  ! INSTANCE$+1,,AUTO

     2486     7370
     2487     7371    2   DCL MPTR$ PTR;
     2488     7372    2   DCL MCOUNT SBIN;
     2489     7373
     2490     7374    2      TIX2 = -1;

   7374  6 006607   000001 335007                    LCA     1,DL
         6 006610   000313 755000 2                  STA     TIX2

     2491     7375
     2492     7376    3      DO TIX1 = 0 TO MCOUNT - 1;

   7376  6 006611   000314 450000 2                  STZ     TIX1
         6 006612   006654 710000 6                  TRA     s:7400+1

     2493     7377    3         TEMP2 = ASCBIN (SUBSTR (MPTR$ -> BIG_BUF,TIX1, 1));

   7377  6 006613   200607 470500                    LDP0    @MPTR$,,AUTO
         6 006614   000000 471500                    LDP1    0,,PR0
         6 006615   000314 235000 2                  LDA     TIX1
         6 006616   000100 101505                    MRL     fill='000'O
         6 006617   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         6 006620   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 006621   200612 236100                    LDQ     @MCOUNT+2,,AUTO
         6 006622   000315 756000 2                  STQ     TEMP2

     2494     7378    3         IF (TEMP2 ~= 127 /* CHAR_DEL# */)

   7378  6 006623   000177 116007                    CMPQ    127,DL
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:328  
         6 006624   006647 600000 6                  TZE     s:7396
         6 006625   000010 116007                    CMPQ    8,DL
         6 006626   006647 600000 6                  TZE     s:7396

     2495     7379    3           AND
     2496     7380    3           (TEMP2 ~=  8 /* CHAR_BS# */)
     2497     7381    3         THEN
     2498     7382    4         DO;

     2499     7383    4            TIX2 = TIX2 + 1;

   7383  6 006627   000313 054000 2                  AOS     TIX2

     2500     7384    4            IF (TEMP2 >= 97 /* CHAR_LC_A# */ )

   7384  6 006630   000141 116007                    CMPQ    97,DL
         6 006631   006636 602000 6                  TNC     s:7390
         6 006632   000173 116007                    CMPQ    123,DL
         6 006633   006636 603000 6                  TRC     s:7390

     2501     7385    4              AND
     2502     7386    4              (TEMP2 <= 122 /* CHAR_LC_Z# */ )
     2503     7387    4            THEN
     2504     7388    4            TEMP2 = TEMP2 -

   7388  6 006634   000040 136007                    SBLQ    32,DL
         6 006635   000315 756000 2                  STQ     TEMP2

     2505     7389    4              97 /* CHAR_LC_A# */ + 65 /* CHAR_UC_A */;
     2506     7390    4            CALL INSERT (MPTR$->BIG_BUF,

   7390  6 006636   000000 471500                    LDP1    0,,PR0
         6 006637   000033 736000                    QLS     27
         6 006640   000412 276000 7                  ORQ     266
         6 006641   200612 756100                    STQ     @MCOUNT+2,,AUTO
         6 006642   000313 235000 2                  LDA     TIX2
         6 006643   040105 100500                    MLR     fill='040'O
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:329  
         6 006644   200612 000004                    ADSC9   @MCOUNT+2,,AUTO          cn=0,n=4
         6 006645   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

     2507     7391    4              TIX2,1,BINASC(TEMP2));
     2508     7392    4         END; /* DO IF NOT DEL OR BS                                             */

   7392  6 006646   006653 710000 6                  TRA     s:7400

     2509     7393
     2510     7394    3         ELSE
     2511     7395    4         DO;

     2512     7396    4            IF TIX2 > -1

   7396  6 006647   000313 235000 2                  LDA     TIX2
         6 006650   006653 604000 6                  TMI     s:7400

     2513     7397    4            THEN
     2514     7398    4            TIX2 = TIX2 - 1;

   7398  6 006651   000001 336007                    LCQ     1,DL
         6 006652   000313 056000 2                  ASQ     TIX2

     2515     7399    4         END; /* DO IF DEL OR BS                                                 */

     2516     7400    3      END; /* DO TIX1 = 0 TO N-1                                                 */

   7400  6 006653   000314 054000 2                  AOS     TIX1
         6 006654   200610 470500                    LDP0    @MCOUNT,,AUTO
         6 006655   000314 236000 2                  LDQ     TIX1
         6 006656   000000 116100                    CMPQ    0,,PR0
         6 006657   006613 604000 6                  TMI     s:7377

     2517     7401    2      MCOUNT = TIX2 + 1;

   7401  6 006660   000313 235000 2                  LDA     TIX2
         6 006661   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:330  
         6 006662   000000 755100                    STA     0,,PR0

     2518     7402
     2519     7403    2      RETURN; /* FROM MY_XLATE                                                   */

   7403  6 006663   200606 221300                    LDX1  ! INSTANCE$+1,,AUTO
         6 006664   000001 702211                    TSX2  ! 1,X1
     2520     7404    2   END MY_XLATE;
     2521     7405
     2522     7406    1   END OCN$KEYIN;
     2523     7407        %EOD;

PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:331  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   OCD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OCS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   EL_SUBS_C.:E05TOU  is referenced.
   EL$TABLES.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OCD_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OCS_SUBS_C.:E05TOU  is referenced.
   OC$PEND.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCN$KEYIN.
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:332  

 **** Variables and constants ****

  ****  Section 002  Data  OCN$KEYIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   776-0-0/d STRC(144)   r     1 BREAK_GHOST              111-0-0/b UBIN(9)     r     1 BYTES_
    12-0-0/w BIT (18)    r     1 CADDR                    732-0-0/d STRC(1080)  r     1 CLOSE_TP_FILE
  1002-0-0/d STRC(144)   r     1 CONTROLY_GHOST           317-0-0/w STRC        r     1 CSCG_EVID
   526-0-0/d STRC(576)   r     1 DEACT                    320-0-0/w STRC(1512)  r     1 EL_OPERBUF
  1122-0-0/d STRC(216)   r     1 FDS_HELP_BUF              10-0-0/w BIT         r     1 FOUND
  1170-0-0/d STRC(504)   r     1 FPT_GJOB                1112-0-0/d STRC(216)   r     1 GDS_HELP_BUF
    51-0-0/c STRC(45)    r     1 GENKEYIN_MSGB             53-0-0/c STRC(18)    r     1 GENKEYIN_MSGC
   560-0-0/d STRC(432)   r     1 GET_HEADY_STUFF          546-0-0/d STRC(72)    r     1 GET_INFO
  1006-0-0/d STRC(432)   r     1 GET_SECS                  60-0-0/b STRC(9)     r     1 GHST_READB
    61-0-0/b STRC(18)    r     1 GHST_READC                 6-0-0/c STRC(72)    r     1 GHST_TEMPLAT
     6-0-0/c CHAR(8)     r     1 GHST_TEMPLATC           1150-0-0/d STRC(540)   r     1 GJOB
  1216-0-0/c STRC(72)    r     1 GJOB_ACCT                203-0-0/c STRC(45)    r     1 GJOB_INT_MSGB
   205-0-0/c STRC(18)    r     1 GJOB_INT_MSGC           1206-0-0/c STRC(288)   r     1 GJOB_NAME
  1220-0-0/c STRC(72)    r     1 GJOB_PASS                265-0-0/c STRC(549)   r     1 HDR_WRITEB
   264-0-0/c STRC(18)    r     1 HDR_WRITEC              1060-0-0/c STRC(72)    r     1 HELP_ACCT
     5-0-0/c BIT         r     1 HELP_FLAG                 13-0-0/w UBIN        r     1 HELP_INDEX
   152-0-0/c STRC(756)   r     1 HELP_MSGB                177-0-0/c STRC(27)    r     1 HELP_MSGC
  1056-0-0/c STRC(54)    r     1 HELP_NAME               1062-0-0/c STRC(72)    r     1 HELP_PASS
     0-0-0/w UBIN        r     1 I                        550-0-0/d STRC(252)   r     1 INFO_ARRAY
   113-0-0/b STRC(45)    r     1 INFO_WRITEB              112-0-0/b STRC(18)    r     1 INFO_WRITEC
     2-0-0/w SBIN        r     1 J
   372-0-0/d CHAR(8)     r     1 JG_GHOSTS(0:23)
  1130-0-0/c STRC(288)   r     1 KEY1                    1140-0-0/c STRC(288)   r     1 KEY2
   772-0-0/d STRC(144)   r     1 KILL_GHOST               201-0-0/c STRC(72)    r     1 LPWSN_MSGB
   200-0-0/c STRC(9)     r     1 LPWSN_MSGC                62-0-0/c STRC(792)   r     1 MASTER_WRITE
   110-0-0/b STRC(18)    r     1 MASTER_WRITEC            310-0-0/b UBIN(18)    r     1 MSG#
   306-0-0/c STRC(72)    r     1 MSTR_WRITEB              305-0-0/b STRC(9)     r     1 MSTR_WRITEC
   574-0-0/d STRC(1089)  r     1 MYHEADER                1034-0-0/d STRC(360)   r     1 NEW_PROF
     4-0-0/w PTR         r     1 NEXT$                     11-0-0/w BIT         r     1 NOT_FOUND
   311-0-0/b UBIN(9)     r     1 NP#                      316-0-0/w BIT         r     1 OCN_ATTR
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:333  
   316-0-0/w STRC        r     1 OCN_ATTRS               1064-0-0/d STRC(792)   r     1 OCN_HELP
   512-0-0/d STRC(432)   r     1 OOPS_WRITE               634-0-0/d STRC(2088)  r     1 OPEN_TP_CNTRL
     3-0-0/w UBIN        r     1 PASS_INDEX               312-0-0/w SBIN        r     1 PFB
   146-0-0/b STRC(45)    r     1 PROFMSGB                 145-0-0/b STRC(18)    r     1 PROFMSGC
  1046-0-0/c STRC(288)   r     1 PROF_NAME                151-0-0/c STRC        r     1 PWIDTH_MSGB
   150-0-0/c STRC(9)     r     1 PWIDTH_MSGC               54-0-0/b STRC(27)    r     1 REGULAR_READB
    55-0-0/c STRC(108)   r     1 REGULAR_READC            476-0-0/d STRC(432)   r     1 REPLY
   452-0-0/w STRC(288)   r     1 STA                      224-0-0/c STRC(801)   r     1 STATS_WRITEB
   253-0-0/b STRC(306)   r     1 STATS_WRITEC             206-0-0/c STRC(81)    r     1 STA_MSGB
   211-0-0/c STRC(18)    r     1 STA_MSGC                 770-0-0/c STRC(72)    r     1 SYSACCT
   116-0-0/c STRC(828)   r     1 TELL_WRITEB              115-0-0/b STRC(27)    r     1 TELL_WRITEC
   315-0-0/w UBIN        r     1 TEMP2                   1022-0-0/c CHAR(8)     r     1 TIME_BUF
   314-0-0/w SBIN        r     1 TIX1                     313-0-0/w SBIN        r     1 TIX2
   726-0-0/c STRC(99)    r     1 TP_CNTRL_D                17-0-0/c STRC(900)   r     1 TP_INSTRUCTION
   217-0-0/c STRC(117)   r     1 TP_MSGB                  223-0-0/c STRC(27)    r     1 TP_MSGC
  1120-0-0/d STRC(72)    r     1 VLP_HELP_RESULTS          15-0-0/w UBIN        r     1 WORD_
  1024-0-0/d STRC(288)   r     1 WR_ERSEND                462-0-0/d STRC(432)   r     1 WR_STA
   212-0-0/c STRC(144)   r     1 ZAP_PHASE_MSGB           216-0-0/c STRC(27)    r     1 ZAP_PHASE_MSGC
     1-0-0/w UBIN        r     1 ZI

  ****  Section 004 RoData OCN$KEYIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    20-0-0/d STRC(576)   r     1 END_O_FILE                40-0-0/d STRC(432)   r     1 GET_LADC_FLAG
     0-0-0/c CHAR(58)    r     1 OOPS_MSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KEYSIZE                   3-0-0/w PTR         r     1 @KEY_BUF
     5-0-0/w PTR         r     1 @KEY_STA                 610-0-0/w PTR         r     1 @MCOUNT
   607-0-0/w PTR         r     1 @MPTR$                   607-0-0/w PTR         r     1 @OPTION_
    12-0-0/w PTR         r     1 H1_PTR$                   13-0-0/w PTR         r     1 H2_PTR$
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:334  
    14-0-0/w PTR         r     1 H3_PTR$                    6-0-0/w UBIN        r     1 INDEX_
   605-0-0/w PTR         r     1 INSTANCE$                 *0-0-0/w UBIN        r     1 KEYSIZE
    *0-0-0/c ACHR        r     1 KEY_BUF                   *0-0-0/c CHAR(8)     r     1 KEY_STA
    *0-0-0/w SBIN        r     1 MCOUNT                    *0-0-0/w PTR         r     1 MPTR$
    *0-0-0/w UBIN        r     1 OPTION_
    15-0-0/c UBIN(9)     r     1 PROF_BUFFER(0:1500)
    10-0-0/w PTR         r     1 PTR$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS7$                     0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w STRC(108)   r     1 OCD_GHOSTS(0:8191)
     0-0-0/c UBIN(9)     r     1 OCD_ZAPPHASE               0-0-0/c CHAR(11)    r     1 OCD_ZAPTIME
     0-0-0/c STRC(1377)  r     1 OCD_ZAP_SAVE               0-0-0/c CHAR(8)     r     1 OCP_NON_STA
     0-0-0/w STRC        r     1 OCP_USED_HEAD              0-0-0/w PTR         r     1 OCP_USED_HEAD$
     0-0-0/w BIT         r     1 OCS_ATTR                   0-0-0/w UBIN        r     1 OCS_CINDEX
     0-0-0/w UBIN        r     1 OCS_ERRCODE                0-0-0/c STRC(747)   r     1 OCS_ERRMSGB
     0-0-0/b STRC        r     1 OCS_ERRMSGC                0-0-0/w UBIN        r     1 OCS_KSIZE
     0-0-0/w UBIN        r     1 OCS_NAMES                  0-0-0/w UBIN        r     1 OCS_SSIZE
     0-0-0/c CHAR(8)     r     1 OCS_STA(0:8191)            0-0-0/c CHAR(140)   r     1 OCS_STRUCTC
     0-0-0/b STRC(9)     r     1 OCS_STRUCTURE(0:139)
     0-0-0/w UBIN        r     1 OCS_VECTOR                 0-0-0/b STRC        r     1 OC_ACCT_SAVE
     0-0-0/w BIT (18)    r     1 OC_CADDR                   0-0-0/w PTR         r     1 OC_CONSOLE$
     0-0-0/c CHAR(8)     r     1 OC_DEF_ACCT                0-0-0/w BIT         r     1 OC_FIRST
     0-0-0/b STRC        r     1 OC_HIST_SAVE               0-0-0/w UBIN        r     1 OC_KEYIN#
     0-0-0/c CHAR(256)   r     1 OC_KEYINBUF                0-0-0/w PTR         r     1 OC_KEYINBUF$
     0-0-0/w BIT         r     1 OC_KEY_GOOD                0-0-0/w BIT         r     1 OC_LIST
     0-0-0/w UBIN(18)    r     1 OC_MAXCONSOLE              0-0-0/c STRC(1260)  r     1 OC_PARAM
     0-0-0/w PTR         r     1 OC_PARAM$                  0-0-0/c STRC(1260)  r     1 OC_PARAM1
     0-0-0/w SBIN        r     1 OC_PLATEN_WIDTH            0-0-0/w UBIN        r     1 OC_QHEAD
     0-0-0/w STRC(540)   r     1 OC_QUEUE(0:8191)           0-0-0/w BIT         r     1 OC_ZIP

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:335  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(5760)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c CHAR(140)   r     1 BIG_BUF
     0-0-0/c STRC(711)   r     1 HELP_OUTPUT(0:0)
     0-0-0N  NULL        r     1 M$CSCG                     0-0-0N  NULL        r     1 M$OCCG
     0-0-0N  NULL        r     1 M$TP                       0-0-0/c STRC(54)    r     1 OC$AUTO
     0-0-0/c ASTR(225)   r     1 OC$COMM                    0-0-0/c STRC(45)    r     1 OC$HELP1
     0-0-0/c STRC(1260)  r     1 OC$MESSAGE                 0-0-0/c STRC(180)   r     1 OC$MESSHD
     0-0-0/c STRC(45)    r     1 OC$NAT                     0-0-0/w ASTR(360)   r     1 OC$PEND
     0-0-0/c STRC(144)   r     1 OC$PROFILE                 0-0-0/c STRC(72)    r     1 OC$PWIDTH
     0-0-0/c STRC(180)   r     1 OC$READ$                   0-0-0/c STRC(108)   r     1 OC$SETACCT
     0-0-0/c ASTR(117)   r     1 OC$STARTTP                 0-0-0/c ASTR(117)   r     1 OC$TERMSEND
     0-0-0/c STRC(72)    r     1 OC$TPPASS                  0-0-0/c ASTR(117)   r     1 OC$TPSEND
     0-0-0/w STRC(2205)  r     1 OC_CONSOLE(0:0)
     0-0-0/w STRC        r     1 PC$HDR                     0-0-0/w STRC(2700)  r     1 PC$INSTANCE
     0-0-0/c STRC(306)   r     1 PROMPT_TABLE(0:2)
     0-0-0/c ASTR(9)     r     1 TEXT


   Procedure OCN$KEYIN requires 3509 words for executable code.
   Procedure OCN$KEYIN requires 408 words of local(AUTO) storage.
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:336  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:337  
          MINI XREF LISTING

ARRGH
      7327**LABEL    7280--GOTO     7327--CALLALT
B$ALT.CODE
      3134**DCL      3134--REDEF    3135--REDEF    3135--REDEF
B$ALT.ERR
      3135**DCL      6155>>ASSIGN   6196>>ASSIGN   6254>>ASSIGN   6958>>ASSIGN   7110>>ASSIGN   7202>>ASSIGN
B$ALT.ERR.ERR#
      3136**DCL      3136--REDEF
B$ALT.EVID
      3135**DCL      3135--REDEF    3135--REDEF
B$DS7$
      4196**DCL      3934--IMP-PTR  7286>>ASSIGN   7287>>DOINDEX
B$JIT.CPFLAGS1.SLEAZE
      3061**DCL      3061--REDEF
B$JIT.ERR.MID
      2968**DCL      2968--REDEF
B$JIT.LANG
      3103**DCL      6046>>ASSIGN
B$JIT$
      3127**DCL      2962--IMP-PTR  6046>>ASSIGN
B$TCB.ALT$
      3130**DCL      6155>>ASSIGN   6196>>ASSIGN   6254>>ASSIGN   6958>>ASSIGN   7110>>ASSIGN   7202>>ASSIGN
B$TCB$
      3128**DCL      6155>>ASSIGN   6196>>ASSIGN   6254>>ASSIGN   6958>>ASSIGN   7110>>ASSIGN   7202>>ASSIGN
BAD_PROF
      6950**LABEL    6949--CALLALT
BIG_BUF
      3211**DCL      5529>>DOWHILE  6244<<ASSIGN   7377>>ASSIGN   7390<<CALLBLT
BREAK_GHOST
      5005**DCL      5849<>CALL
BREAK_GHOST.V
      5005**DCL      5005--DCLINIT
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:338  
BREAK_GHOST.V.USER#
      5005**DCL      5848<<ASSIGN
BYTES_
      3246**DCL      6302<<ASSIGN   6303<>CALL
CADDR
        62**DCL      5684<<ASSIGN   5686>>IF       5712>>IF       5968<<ASSIGN   5971>>IF       5975>>IF
      5984>>IF
CLOSE_TP_FILE
      4159**DCL      7302<>CALL
CLOSE_TP_FILE.SN_
      4159**DCL      4159--REDEF
CLOSE_TP_FILE.UTL_
      4160**DCL      4160--REDEF
CLOSE_TP_FILE.V
      4164**DCL      4159--DCLINIT
CLOSE_TP_FILE.V.EXPIRE#
      4174**DCL      4174--REDEF
CLOSE_TP_FILE.V.TYPE#
      4172**DCL      4172--REDEF
CLOSE_TP_FILE.V.XTNSIZE#
      4169**DCL      4169--REDEF    4171--REDEF
CONTROLY_GHOST
      5021**DCL      5867<>CALL
CONTROLY_GHOST.V
      5021**DCL      5021--DCLINIT
CONTROLY_GHOST.V.USER#
      5021**DCL      5866<<ASSIGN
CSCG_EVID
      3461**DCL      7260>>ASSIGN   7326>>ASSIGN
CSCG_EVID.CADDR
      3462**DCL      7259<<ASSIGN   7325<<ASSIGN
DEACT
      3857**DCL      5771<>CALL     6359<>CALL
DEACT.V
      3858**DCL      3857--DCLINIT
DEACT.V.DVBYTE.REREAD#
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:339  
      3860**DCL      3860--REDEF
DONE
      7302**LABEL    7298--GOTO
DONE_HELPING
      6201**LABEL    6234--GOTO
EL_OPERBUF
      3467**DCL      5094--DCLINIT  5096--DCLINIT
EL_OPERBUF.ATTR
      3467**DCL      6242<<ASSIGN
EL_OPERBUF.MESSAGE
      3467**DCL      6243<<ASSIGN   6244--ASSIGN
EL_OPERBUF.STATION
      3467**DCL      6241<<ASSIGN
ENDLPWSN_CASE
      7018**LABEL    6994--GOTO     7008--GOTO
ENDPWIDTH_CASE
      7049**LABEL    7041--GOTO
END_O_FILE
      5040**DCL      5884<>CALL
END_O_FILE.V
      5041**DCL      5040--DCLINIT
END_O_FILE.V.DVBYTE.REREAD#
      5043**DCL      5043--REDEF
END_ZAPPHASE_CASE
      7152**LABEL    7128--GOTO     7142--GOTO
ERSEND1
      6251**LABEL    6247--CALLALT
FDS_HELP_BUF
      5284**DCL      6161<>CALL     6201<>CALL
FDS_HELP_BUF.V
      5284**DCL      5284--DCLINIT
FOUND
        60**DCL      5672<<ASSIGN   5673>>DOWHILE  5676<<ASSIGN   5680>>IF       5683<<ASSIGN   5691<<ASSIGN
      5697<<ASSIGN   5706<<ASSIGN   5714<<ASSIGN   5715>>IF       6288<<ASSIGN   6299<<ASSIGN   6313>>IF
      6334<<ASSIGN   6349<<ASSIGN   6365>>IF       6374<<ASSIGN   6392<<ASSIGN   6407<<ASSIGN   6428>>IF
      6443<<ASSIGN   6468<<ASSIGN   6472>>IF       6482<<ASSIGN   6512<<ASSIGN   6515>>IF       6621<<ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:340  
      6638<<ASSIGN   6641>>IF       7284<<ASSIGN   7297<<ASSIGN   7304>>IF
FPT_GJOB
      5404**DCL      7097<>CALL     7194<>CALL
FPT_GJOB.ACCT_
      5404**DCL      7074<<ASSIGN   7164<<ASSIGN
FPT_GJOB.CCBUF_
      5405**DCL      7084<<ASSIGN   7088<<ASSIGN   7188<<ASSIGN
FPT_GJOB.PASS_
      5405**DCL      7075<<ASSIGN   7181<<ASSIGN   7185<<ASSIGN
FPT_GJOB.V
      5406**DCL      5404--DCLINIT
FPT_GJOB.V.SLEAZE#
      5406**DCL      7095<<ASSIGN   7192<<ASSIGN
GDS_HELP_BUF
      5250**DCL      6134<>CALL     6175<>CALL     6214<>CALL
GDS_HELP_BUF.V
      5250**DCL      5250--DCLINIT
GENKEYIN_MSGB
      3213**DCL      6255<>CALL
GENKEYIN_MSGB.CODE
      3216**DCL      6253<<ASSIGN
GENKEYIN_MSGB.ERR
      3214**DCL      3215--REDEF
GENKEYIN_MSGB.ERROR
      3215**DCL      6254<<ASSIGN
GENKEYIN_MSGC
      3218**DCL      6255<>CALL
GET_HEADY_STUFF
      3912**DCL      6892<>CALL
GET_INFO
      3882**DCL      6524<>CALL
GET_LADC_FLAG
      5367**DCL      7068<>CALL
GET_SECS.V
      5071**DCL      5067--DCLINIT
GHST_READB
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:341  
      3232**DCL      5936<>CALL     7359<>CALL
GHST_READC
      3235**DCL      5936<>CALL     7359<>CALL
GHST_READC.COUNT_
      3236**DCL      5931<<ASSIGN   7357<<ASSIGN
GHST_TEMPLAT
        55**DCL        59--REDEF
GHST_TEMPLAT.CADDR
        58**DCL      5785<<ASSIGN   5881<<ASSIGN
GHST_TEMPLAT.SYSID
        57**DCL      5786<<ASSIGN   5882<<ASSIGN
GHST_TEMPLATC
        59**DCL      5787>>ASSIGN   5883>>ASSIGN
GJOB
      5384**DCL      5367--DCLINIT
GJOB.LADCFLG#
      5385**DCL      7071>>IF
GJOB_ACCT
      5449**DCL      7164--ASSIGN
GJOB_ACCT.ACCT#
      5449**DCL      7163<<ASSIGN
GJOB_INT_MSGB
      3298**DCL      7112<>CALL
GJOB_INT_MSGB.CODE
      3301**DCL      7111<<ASSIGN
GJOB_INT_MSGB.ERR
      3299**DCL      3300--REDEF
GJOB_INT_MSGB.ERROR
      3300**DCL      7110<<ASSIGN
GJOB_INT_MSGC
      3303**DCL      7112<>CALL
GJOB_NAME
      5436**DCL      5405--DCLINIT
GJOB_NAME.L#
      5436**DCL      7077<<ASSIGN   7166<<ASSIGN
GJOB_NAME.NAME#
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:342  
      5436**DCL      7078<<ASSIGN   7167<<ASSIGN
GJOB_PASS
      5462**DCL      7181--ASSIGN
GJOB_PASS.PASS#
      5462**DCL      7180<<ASSIGN
GJOB_TROUBLE
      7108**LABEL    7097--CALLALT
H1_PTR$
        51**DCL      6058<<ASSIGN   6059>>ASSIGN   6059>>ASSIGN   6072>>IF       6072>>IF
H2_PTR$
        52**DCL      6059<<ASSIGN   6060>>ASSIGN   6060>>ASSIGN   6065<<ASSIGN   6066>>ASSIGN   6066>>ASSIGN
      6083>>IF       6086>>ASSIGN   6087>>ASSIGN   6087>>ASSIGN
H3_PTR$
        53**DCL      6060<<ASSIGN   6066<<ASSIGN   6093>>IF       6096>>ASSIGN   6097>>ASSIGN   6097>>ASSIGN
HDR_WRITEB
      3411**DCL      6903<>CALL     6910<>CALL     6919<>CALL
HDR_WRITEB.FLAG
      3412**DCL      6901<<ASSIGN   6907<<ASSIGN   6917<<ASSIGN
HDR_WRITEB.HEAD
      3413**DCL      6902<<ASSIGN   6908<<ASSIGN   6918<<ASSIGN
HDR_WRITEC
      3407**DCL      6903<>CALL     6910<>CALL     6919<>CALL
HDR_WRITEC.CNT
      3409**DCL      6900<<ASSIGN   6906<<ASSIGN   6916<<ASSIGN
HELP_ACCT
      5191**DCL      5228--DCLINIT
HELP_FLAG
        54**DCL      6057<<ASSIGN   6064<<ASSIGN   6069>>IF
HELP_INDEX
        63**DCL      6148<<DOINDEX  6149>>ASSIGN   6188<<DOINDEX  6189>>ASSIGN   6228<<DOINDEX  6229>>ASSIGN
HELP_MSGB
      3281**DCL      6076<>CALL     6109<>CALL     6137<>CALL     6150<>CALL     6157<>CALL     6178<>CALL
      6190<>CALL     6198<>CALL     6217<>CALL     6230<>CALL
HELP_MSGB.CODE
      3285**DCL      6049<<ASSIGN   6075<<ASSIGN   6108<<ASSIGN   6136<<ASSIGN   6156<<ASSIGN   6169<<ASSIGN
      6177<<ASSIGN   6197<<ASSIGN   6208<<ASSIGN   6216<<ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:343  
HELP_MSGB.ERR
      3283**DCL      3284--REDEF
HELP_MSGB.ERROR
      3284**DCL      6155<<ASSIGN   6196<<ASSIGN
HELP_MSGB.HMSG
      3282**DCL      6149<<ASSIGN   6189<<ASSIGN   6229<<ASSIGN
HELP_MSGC
      3287**DCL      6076<>CALL     6109<>CALL     6137<>CALL     6150<>CALL     6157<>CALL     6178<>CALL
      6190<>CALL     6198<>CALL     6217<>CALL     6230<>CALL
HELP_NAME
      5176**DCL      5227--DCLINIT
HELP_OUTPUT.LINE
      3163**DCL      6149>>ASSIGN   6189>>ASSIGN   6229>>ASSIGN
HELP_PASS
      5206**DCL      5228--DCLINIT
I
        42**DCL      5702<<CALLBLT  5702>>CALLBLT  5703>>IF       5703>>IF       5926<<DOINDEX  5927>>IF
      5931>>ASSIGN   5936>>CALL     5962<<CALLBLT  5975>>IF       5975>>IF       6289<<DOINDEX  6290>>IF
      6292>>IF       6295>>IF       6303>>CALL     6321<<ASSIGN   6322<>CALL     6335<<DOINDEX  6336>>IF
      6336>>IF       6336>>IF       6336>>IF       6350>>IF       6358>>ASSIGN   6362<<ASSIGN   6372<<ASSIGN
      6373<>CALL     6393<<DOINDEX  6394>>IF       6396>>IF       6399>>IF       6403>>IF       6420>>CALL
      6424<<ASSIGN   6451<<DOINDEX  6452>>IF       6452>>IF       6452>>IF       6452>>IF       6462>>CALL
      6497<<DOINDEX  6498>>IF       6500>>IF       6503>>IF       6506>>CALL     6529<<DOINDEX  6531>>DOCASE
      6542>>ASSIGN   6557<<DOINDEX  6559>>IF       6561>>IF       6564>>ASSIGN   6566>>ASSIGN   6569>>ASSIGN
      6572>>ASSIGN   6573>>IF       6579>>ASSIGN   6581>>ASSIGN   6583>>ASSIGN   6585>>ASSIGN   6587>>ASSIGN
      6589>>ASSIGN   6591>>ASSIGN   6593>>ASSIGN   6595>>ASSIGN   6597>>ASSIGN   6599>>ASSIGN   6601>>ASSIGN
      6603>>ASSIGN   6605>>ASSIGN   6607>>ASSIGN   6625<<DOINDEX  6627>>IF       6629>>IF       6633>>ASSIGN
      6759<<ASSIGN   6764<>CALL     6874<<DOINDEX  6875>>IF       6879>>ASSIGN   6882>>ASSIGN   6986<<CALLBLT
      6987>>IF       6987>>IF       6987>>IF       7000<<CALLBLT  7004>>IF       7217<<DOINDEX  7218>>IF
      7247<<CALLBLT  7287<<DOINDEX
INDEX_
        45**DCL      5481<<ASSIGN   5482<>CALL     5483>>IF       5486>>IF       5491>>ASSIGN   5503>>ASSIGN
      5516>>IF       5518>>ASSIGN   5520>>ASSIGN   5522>>ASSIGN   5545>>IF       5563>>IF       5565<>CALL
      5601<>CALL     5606>>ASSIGN   5607>>ASSIGN   5616>>IF       5620>>ASSIGN   5626>>IF       5628<>CALL
      5632>>IF       5632>>IF       5641<>CALL     5644>>ASSIGN   5689>>IF       5694>>ASSIGN   5699>>IF
      5703>>IF       5752>>IF       5759>>IF       5762>>ASSIGN   5763>>ASSIGN   5764>>ASSIGN   5765>>ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:344  
      5769>>ASSIGN   5777>>IF       5777>>IF       5786>>ASSIGN   5788>>ASSIGN   5806>>IF       5809>>ASSIGN
      5833>>ASSIGN   5845>>IF       5848>>ASSIGN   5863>>IF       5866>>ASSIGN   5878>>IF       5882>>ASSIGN
      5896>>IF       5901>>ASSIGN   5909>>IF       5912>>ASSIGN   5923>>IF       5927>>IF       5931>>ASSIGN
      5962>>CALLBLT  5964>>IF       5968>>ASSIGN   5975>>IF       5975>>IF       5984>>IF       6040>>ASSIGN
      6045>>ASSIGN   6076>>CALL     6109>>CALL     6137>>CALL     6146>>IF       6148>>DOINDEX  6150>>CALL
      6157>>CALL     6170>>ASSIGN   6178>>CALL     6186>>IF       6188>>DOINDEX  6190>>CALL     6198>>CALL
      6209>>ASSIGN   6225>>IF       6228>>DOINDEX  6230>>CALL     6241>>ASSIGN   6242>>ASSIGN   6262>>IF
      6265>>ASSIGN   6273>>IF       6278>>ASSIGN   6326>>ASSIGN   6350>>IF       6378>>ASSIGN   6414>>ASSIGN
      6416>>ASSIGN   6448>>ASSIGN   6449>>ASSIGN   6452>>IF       6494>>ASSIGN   6495>>ASSIGN   6503>>IF
      6573>>IF       6664<>CALL     6667<>CALL     6673>>ASSIGN   6679>>ASSIGN   6745>>ASSIGN   6750>>IF
      6755<>CALL     6762>>ASSIGN   6768>>ASSIGN   6776>>IF       6776>>IF       6786<>CALL     6791>>ASSIGN
      6793>>ASSIGN   6796>>ASSIGN   6799>>ASSIGN   6804>>ASSIGN   6826>>ASSIGN   6827>>ASSIGN   6828>>ASSIGN
      6830>>ASSIGN   6836>>ASSIGN   6838>>ASSIGN   6840>>ASSIGN   6842>>ASSIGN   6844>>ASSIGN   6846>>ASSIGN
      6848>>ASSIGN   6850>>ASSIGN   6852>>ASSIGN   6854>>ASSIGN   6856>>ASSIGN   6858>>ASSIGN   6860>>ASSIGN
      6862>>ASSIGN   6864>>ASSIGN   6866>>ASSIGN   6868>>ASSIGN   6871>>IF       6875>>IF       6879>>ASSIGN
      6931>>IF       6938>>IF       6946>>ASSIGN   6952>>ASSIGN   6986>>CALLBLT  6987>>IF       7011>>ASSIGN
INFO_ARRAY
      3896**DCL      3882--DCLINIT
INFO_ARRAY.ETMF
      3896**DCL      6535>>ASSIGN
INFO_ARRAY.RESP
      3896**DCL      6537>>ASSIGN
INFO_ARRAY.USERS
      3896**DCL      6539>>ASSIGN
INFO_WRITEB
      3252**DCL      6544<>CALL
INFO_WRITEB.CODE
      3253**DCL      6542<<ASSIGN
INFO_WRITEB.INFO
      3254**DCL      6535<<ASSIGN   6537<<ASSIGN   6539<<ASSIGN
INFO_WRITEC
      3248**DCL      6544<>CALL
INSTANCE$
      4194**DCL      3938--IMP-PTR  7286<<ASSIGN   7288>>IF       7288>>IF       7293>>ASSIGN   7294>>ASSIGN
      7296>>ASSIGN   7300<<ASSIGN   7300>>ASSIGN
J
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:345  
        44**DCL      5661<<DOINDEX  5663>>ASSIGN   7292<<ASSIGN   7293>>ASSIGN   7296>>ASSIGN
JG_GHOSTS
      3488**DCL      7217--DOINDEX  7218>>IF
KEEP_GOING1
      7069**LABEL    7068--CALLALT
KEY1
      5320**DCL      5226--DCLINIT
KEY1.L#
      5320**DCL      6082<<ASSIGN   6086<<ASSIGN   6087>>ASSIGN   6126<<ASSIGN
KEY1.NAME#
      5320**DCL      6087<<ASSIGN
KEY2
      5350**DCL      5227--DCLINIT
KEY2.L#
      5350**DCL      6092<<ASSIGN   6096<<ASSIGN   6097>>ASSIGN   6127<<ASSIGN
KEY2.NAME#
      5350**DCL      6097<<ASSIGN
KEYSIZE
        23**DCL        19--PROC       21--IMP-SIZ  5476>>ASSIGN   5492>>ASSIGN   5583>>CALLBLT  5587>>CALLBLT
      5594>>CALLBLT  5601>>CALL
KEY_BUF
        21**DCL        19--PROC     5475--ASSIGN   5492>>ASSIGN   5583>>CALLBLT  5587>>CALLBLT  5594<<CALLBLT
      5601<>CALL
KEY_STA
        22**DCL        19--PROC     5477>>ASSIGN   5744>>ASSIGN
KILL_GHOST
      4989**DCL      5766<>CALL
KILL_GHOST.V
      4989**DCL      4989--DCLINIT
KILL_GHOST.V.USER#
      4989**DCL      5762<<ASSIGN
LPWSN_MSGB
      3295**DCL      7020<>CALL
LPWSN_MSGB.LPWSN
      3296**DCL      7013<<ASSIGN
LPWSN_MSGC
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:346  
      3292**DCL      7020<>CALL
LP_WSN_OK
      6987**LABEL    6983--GOTO
M$ACTIVATE
       104**DCL-ENT  5884--CALL
M$CLOSE
        84**DCL-ENT  7302--CALL
M$DEACTIVATE
       104**DCL-ENT  5771--CALL     6359--CALL
M$DISPLAY
       151**DCL-ENT  6524--CALL
M$FDS
       119**DCL-ENT  6161--CALL     6201--CALL
M$GDS
       119**DCL-ENT  6134--CALL     6175--CALL     6214--CALL
M$GJOB
       149**DCL-ENT  7097--CALL     7194--CALL
M$HELP
       147**DCL-ENT  6144--CALL     6185--CALL     6224--CALL
M$MONINFO
       152**DCL-ENT  6892--CALL     7068--CALL
M$OPEN
        84**DCL-ENT  7285--CALL
M$PROFILE
       112**DCL-ENT  6949--CALL
M$RUE
       150**DCL-ENT  5766--CALL     5849--CALL     5867--CALL
M$WRITE
        85**DCL-ENT  5508--CALL     5731--CALL     5802--CALL     7274--CALL     7327--CALL
M$WRSYSLOG
       133**DCL-ENT  6247--CALL
MASTER_WRITE
      3238**DCL      5498<>CALL
MASTER_WRITE.MESS
      3240**DCL      5492<<ASSIGN   5493--IF       5495--ASSIGN
MASTER_WRITE.TERM
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:347  
      3239**DCL      5491<<ASSIGN
MASTER_WRITEC
      3242**DCL      5498<>CALL
MASTER_WRITEC.SIZE
      3244**DCL      5495<<ASSIGN   5497<<ASSIGN
MCOUNT IN PROCEDURE MY_XLATE
      7372**DCL      7369--PROC     7376>>DOINDEX  7401<<ASSIGN
MPTR$ IN PROCEDURE MY_XLATE
      7371**DCL      7369--PROC     7377>>ASSIGN   7390>>CALLBLT
MSG#
      3421**DCL      5490<<ASSIGN   5498<>CALL     5558<<ASSIGN   5560<>CALL     5600<<ASSIGN   5601<>CALL
      5935<<ASSIGN   5936<>CALL     5945<<ASSIGN   6000<<ASSIGN   6009<<ASSIGN   6013<>CALL     6029<<ASSIGN
      6030<>CALL     6047<<ASSIGN   6076<>CALL     6109<>CALL     6137<>CALL     6150<>CALL     6157<>CALL
      6167<<ASSIGN   6178<>CALL     6190<>CALL     6198<>CALL     6206<<ASSIGN   6217<>CALL     6230<>CALL
      6251<<ASSIGN   6255<>CALL     6301<<ASSIGN   6303<>CALL     6418<<ASSIGN   6420<>CALL     6445<<ASSIGN
      6462<>CALL     6491<<ASSIGN   6506<>CALL     6526<<ASSIGN   6544<>CALL     6555<<ASSIGN   6609<>CALL
      6623<<ASSIGN   6635<>CALL     6801<<ASSIGN   6888<>CALL     6896<<ASSIGN   6903<>CALL     6910<>CALL
      6919<>CALL     6956<<ASSIGN   6967<>CALL     7016<<ASSIGN   7020<>CALL     7049<<ASSIGN   7051<>CALL
      7108<<ASSIGN   7112<>CALL     7119<<ASSIGN   7126<>CALL     7134<>CALL     7151<>CALL     7160<<ASSIGN
      7197<>CALL     7204<>CALL     7212<<ASSIGN   7221<>CALL     7240<>CALL     7251<>CALL     7306<>CALL
      7331<<ASSIGN   7335<>CALL     7356<<ASSIGN   7359<>CALL
MSTR_WRITEB
      3418**DCL      6635<>CALL
MSTR_WRITEB.TERM_NAME
      3419**DCL      6633<<ASSIGN
MSTR_WRITEC
      3415**DCL      6635<>CALL
MYHEADER
      3928**DCL      3914--DCLINIT
MYHEADER.CNT
      3928**DCL      6897>>IF       6906>>ASSIGN   6908>>ASSIGN   6916>>ASSIGN   6918>>ASSIGN
MYHEADER.HEADER#
      3928**DCL      6902>>ASSIGN   6908>>ASSIGN   6918>>ASSIGN
MY_XLATE
      7369**PROC     5547--CALL     6322--CALL     6373--CALL     6764--CALL
NEW_PROF
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:348  
      5115**DCL      6949<>CALL
NEW_PROF.BUF_
      5118**DCL      6945<<ASSIGN
NEW_PROF.STATION_
      5117**DCL      6946<<ASSIGN
NEW_PROF.V
      5120**DCL      5117--DCLINIT
NEXT$
        50**DCL      5671<<ASSIGN   5673>>DOWHILE  5674>>IF       5678<<ASSIGN   5678>>ASSIGN   5684>>ASSIGN
      5703>>IF       5730>>ASSIGN   5732<>CALL     5944<<ASSIGN   5948>>DOWHILE  5955>>IF       5968>>ASSIGN
      5975>>IF       5984>>IF       5997>>IF       6001>>ASSIGN   6002>>CALL     6002>>CALL     6002--CALL
      6011>>ASSIGN   6012>>ASSIGN   6013>>CALL     6020<<ASSIGN   6020>>ASSIGN
NOT_FOUND
        61**DCL      5922<<ASSIGN   5939<<ASSIGN   6017<<ASSIGN   6026>>IF
NO_BREAK
      5851**LABEL    5849--CALLALT
NO_CY
      5869**LABEL    5867--CALLALT
NO_EOF
      5886**LABEL    5884--CALLALT
NO_HELP
      6149**LABEL    6144--CALLALT
NO_MORE_HELP
      6196**LABEL    6185--CALLALT  6224--CALLALT  6227--GOTO
NO_OOPS_ALT
      5508**LABEL    5508--CALLALT
NO_START
      7197**LABEL    7194--CALLALT
NP#
      3422**DCL      5489<<ASSIGN   5498<>CALL     5559<<ASSIGN   5560<>CALL     5934<<ASSIGN   5936<>CALL
      5946<<ASSIGN   6013<>CALL     6048<<ASSIGN   6076<>CALL     6109<>CALL     6137<>CALL     6150<>CALL
      6157<>CALL     6168<<ASSIGN   6178<>CALL     6190<>CALL     6198<>CALL     6207<<ASSIGN   6217<>CALL
      6230<>CALL     6252<<ASSIGN   6255<>CALL     6300<<ASSIGN   6303<>CALL     6419<<ASSIGN   6420<>CALL
      6444<<ASSIGN   6462<>CALL     6490<<ASSIGN   6506<>CALL     6527<<ASSIGN   6544<>CALL     6554<<ASSIGN
      6609<>CALL     6622<<ASSIGN   6635<>CALL     6802<<ASSIGN   6888<>CALL     6895<<ASSIGN   6903<>CALL
      6910<>CALL     6919<>CALL     6957<<ASSIGN   6967<>CALL     7018<<ASSIGN   7020<>CALL     7048<<ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:349  
      7051<>CALL     7109<<ASSIGN   7112<>CALL     7120<<ASSIGN   7126<>CALL     7134<>CALL     7151<>CALL
      7161<<ASSIGN   7197<>CALL     7204<>CALL     7213<<ASSIGN   7221<>CALL     7240<>CALL     7251<>CALL
      7306<>CALL     7332<<ASSIGN   7335<>CALL     7355<<ASSIGN   7359<>CALL
OC$AUTO.HOUR
      3157**DCL      6691>>ASSIGN   6706>>ASSIGN   6723>>ASSIGN   6725>>ASSIGN
OC$AUTO.MIN
      3158**DCL      6692>>ASSIGN   6707>>ASSIGN   6724>>ASSIGN   6726>>ASSIGN
OC$COMM.AT_TERM
      3177**DCL      6329>>IF       6331<<ASSIGN   6336>>IF       6381>>IF       6383<<ASSIGN   6399>>IF
      6771>>IF       6773<<ASSIGN   6776>>IF
OC$COMM.COUNT
      3179**DCL      3180--IMP-SIZ  6386>>IF       6408>>ASSIGN   6411>>ASSIGN   6437>>IF       6446>>ASSIGN
      6447>>ASSIGN   6484>>IF       6492>>ASSIGN   6493>>ASSIGN
OC$COMM.DEVICE
      3176**DCL      6322--CALL     6336>>IF       6373--CALL     6396>>IF       6760>>IF       6762<<ASSIGN
      6764--CALL     6776>>IF
OC$COMM.TERM
      3178**DCL      6324>>IF       6326<<ASSIGN   6331>>ASSIGN   6376>>IF       6378<<ASSIGN   6383>>ASSIGN
      6766>>IF       6768<<ASSIGN   6773>>ASSIGN
OC$COMM.TEXT
      3180**DCL      6411>>ASSIGN   6447>>ASSIGN   6493>>ASSIGN
OC$HELP1.DASH
      3161**DCL      6050>>IF       6050>>IF       6050>>IF       6050>>IF       6050>>IF       6058--ASSIGN
      6065--ASSIGN   6102>>IF       6102>>IF       6102>>IF       6102>>IF       6114>>IF       6114>>IF
      6114>>IF       6114>>IF       6123>>IF
OC$MESSAGE
      3146**DCL      5834>>ASSIGN
OC$MESSAGE.CADDR
      3149**DCL      5654<<ASSIGN
OC$MESSAGE.KEYIN#
      3148**DCL      5653<<ASSIGN   5837<<ASSIGN
OC$MESSAGE.MK_VECT
      3147**DCL      5652<<ASSIGN
OC$MESSAGE.TEXT
      3150**DCL      5655<<ASSIGN   6244--ASSIGN   6244--ASSIGN   6658<>CALL     6664<>CALL
OC$MESSHD.FLAGS
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:350  
      3455**DCL      3456--REDEF
OC$MESSHD.MSG#
      3450**DCL      6002<>CALL
OC$MESSHD.MSGID
      3451**DCL      3452--REDEF
OC$MESSHD.WSN
      3458**DCL      3459--REDEF
OC$NAT.LANG
      3184**DCL      6745>>ASSIGN
OC$PEND.ACCN
       716**DCL      6012>>ASSIGN
OC$PEND.CADDR
       707**DCL      5684>>ASSIGN   5955>>IF       5968>>ASSIGN
OC$PEND.DEV.TWSN
       715**DCL      5984>>IF
OC$PEND.LINK$
       704**DCL      5678>>ASSIGN   6020>>ASSIGN
OC$PEND.MESSAGE
       717**DCL      6002<>CALL     6002--CALL
OC$PEND.SIZEB_MSG
       706**DCL       717--IMP-SIZ  5997>>IF       6001>>ASSIGN   6002>>CALL
OC$PEND.SIZER
       708**DCL      6011>>ASSIGN
OC$PEND.STATION
       711**DCL      5730>>ASSIGN
OC$PEND.SYSID
       710**DCL      5674>>IF       6013<>CALL
OC$PEND.WSN
       712**DCL       713--REDEF    5703>>IF       5975>>IF
OC$PROFILE.P_COUNT
      3188**DCL      6926>>ASSIGN
OC$PROFILE.P_NAME
      3189**DCL      6927>>ASSIGN
OC$PWIDTH.PWIDTH
      3193**DCL      7035>>IF       7035>>IF       7044>>ASSIGN   7046>>ASSIGN
OC$READ$.LOGON
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:351  
      3166**DCL      6750>>IF
OC$SETACCT.ACCT
      3154**DCL      6676>>ASSIGN   6679>>ASSIGN   6987>>IF       7000>>CALLBLT  7011>>ASSIGN   7013>>ASSIGN
OC$STARTTP.ACCT
      3197**DCL      7163>>ASSIGN   7169>>ASSIGN   7171--ASSIGN
OC$STARTTP.INSTANCE
      3199**DCL      7167>>ASSIGN
OC$STARTTP.I_CNT
      3198**DCL      3199--IMP-SIZ  7166>>ASSIGN   7167>>ASSIGN   7171--ASSIGN   7171>>ASSIGN
OC$TERMSEND.MESSAGE
      3172**DCL      6303<>CALL
OC$TERMSEND.SIZE
      3171**DCL      3172--IMP-SIZ  6302>>ASSIGN   6303>>CALL
OC$TERMSEND.TERM
      3170**DCL      6292>>IF
OC$TPPASS.PASS
      3202**DCL      7177>>IF       7180>>ASSIGN
OC$TPSEND.ATTR
      3206**DCL      7262>>ASSIGN
OC$TPSEND.TP_CMD
      3209**DCL      7265>>ASSIGN   7294>>ASSIGN
OC$TPSEND.TP_LEN
      3208**DCL      3209--IMP-SIZ  7264>>ASSIGN   7265>>ASSIGN   7292>>ASSIGN   7294>>ASSIGN
OC$TPSEND.TP_STA
      3207**DCL      7215>>ASSIGN   7218>>IF       7231>>IF       7231>>IF       7231>>IF       7231>>IF
      7247>>CALLBLT  7261>>ASSIGN   7288>>IF
OCD_GHOSTS.BACK
      2505**DCL      7145>>IF
OCD_ZAPPHASE
      2505**DCL      7131>>ASSIGN   7140>>IF
OCD_ZAPTIME
      2505**DCL      7132>>ASSIGN
OCD_ZAP_SAVE.CONS_STA
      2506**DCL      5833<<ASSIGN
OCD_ZAP_SAVE.CSCG_EVID.CADDR
      2507**DCL      5835<<ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:352  
OCD_ZAP_SAVE.MESSAGE
      2506**DCL      5834<<ASSIGN
OCL$HOFF
        33**DCL-ENT  6653--CALL
OCL$HON
        34**DCL-ENT  6648--CALL
OCL$LISTIT
        32**DCL-ENT  5601--CALL
OCL$RLS
        35**DCL-ENT  6658--CALL
OCL$STATUS
        25**DCL-ENT  6694--CALL     6709--CALL     6729--CALL     6733--CALL     6737--CALL     6742--CALL
OCN_ATTR
      3431**DCL      5622>>IF
OCN_ATTRS
      3428**DCL      3431--REDEF
OCN_ATTRS.INPUT_
      3429**DCL      5606<<ASSIGN   6979>>IF
OCN_ATTRS.OUTPUT_
      3430**DCL      5607<<ASSIGN   5618<<ASSIGN   5620<<ASSIGN   5694<<ASSIGN   5695>>IF       6979>>IF
OCN_HELP
      5226**DCL      6144<>CALL     6185<>CALL     6224<>CALL
OCN_HELP.BUF_
      5227**DCL      6142<<ASSIGN   6183<<ASSIGN   6222<<ASSIGN
OCN_HELP.RESULTS_
      5229**DCL      6045<<ASSIGN   6170<<ASSIGN   6209<<ASSIGN
OCN_HELP.V
      5230**DCL      5226--DCLINIT
OCN_HELP.V.ALL#
      5232**DCL      6042<<ASSIGN   6210<<ASSIGN
OCN_HELP.V.LANG#
      5231**DCL      6046<<ASSIGN
OCN_HELP.V.LIST#
      5232**DCL      6041<<ASSIGN   6120<<ASSIGN   6128<<ASSIGN
OCN_HELP.V.MORE#
      5233**DCL      6043<<ASSIGN   6171<<ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:353  
OCN_HELP.V.RANGE#
      5233**DCL      6044<<ASSIGN   6129<<ASSIGN
OCO$IWRITE
        30**DCL-ENT  5498--CALL     5560--CALL     5936--CALL     6013--CALL     6030--CALL     6076--CALL
      6109--CALL     6137--CALL     6150--CALL     6157--CALL     6178--CALL     6190--CALL     6198--CALL
      6217--CALL     6230--CALL     6255--CALL     6303--CALL     6420--CALL     6462--CALL     6506--CALL
      6544--CALL     6609--CALL     6635--CALL     6888--CALL     6903--CALL     6910--CALL     6919--CALL
      6967--CALL     7020--CALL     7051--CALL     7112--CALL     7126--CALL     7134--CALL     7151--CALL
      7197--CALL     7204--CALL     7221--CALL     7240--CALL     7251--CALL     7306--CALL     7335--CALL
      7359--CALL
OCP$FINDCX
        26**DCL-ENT  5482--CALL
OCP$PENDRMV
        28**DCL-ENT  5732--CALL
OCP_FREE_HEAD
      2310**DCL      2311--REDEF
OCP_MSGBUF_FREE.B
      2314**DCL      2314--REDEF
OCP_NON_STA
      2316**DCL      5498<>CALL     5560<>CALL     5601<>CALL     5936<>CALL     6002<>CALL     6013<>CALL
      6030<>CALL     6303<>CALL     6420<>CALL     6462<>CALL     6506<>CALL     6544<>CALL     6609<>CALL
      6635<>CALL     6888<>CALL     6903<>CALL     6910<>CALL     6919<>CALL     7020<>CALL     7051<>CALL
      7359<>CALL
OCP_USED_HEAD
      2311**DCL      2312--REDEF
OCP_USED_HEAD$
      2312**DCL      5671>>ASSIGN   5944>>ASSIGN
OCP_USED_TAIL
      2312**DCL      2312--REDEF
OCR$CREAD
        37**DCL-ENT  5565--CALL     5628--CALL     5641--CALL     6667--CALL     6755--CALL     6786--CALL
OCR$SREAD
        36**DCL-ENT  6664--CALL
OCS$SYNTAX
        29**DCL-ENT  5553--CALL
OCS_ATTR
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:354  
      2488**DCL      5622>>IF
OCS_CINDEX
      2489**DCL      5520<<ASSIGN
OCS_ERRCODE
      2489**DCL      5555>>IF
OCS_ERRMSGB
      2492**DCL      5560<>CALL
OCS_ERRMSGC
      2491**DCL      5560<>CALL
OCS_KSIZE
      2487**DCL      5476<<ASSIGN   5493>>IF       5497>>ASSIGN   5525>>IF       5529>>DOWHILE  5531<<ASSIGN
      5531>>ASSIGN   5533>>IF       5547<>CALL     5549>>IF       5591>>IF       5601<>CALL
OCS_LEXEMES.MAX
      2494**DCL      2494--REDEF
OCS_LEXEMES.MIN
      2494**DCL      2494--REDEF
OCS_NAMES
      2488**DCL      5661>>DOINDEX
OCS_SSIZE
      2487**DCL      5656>>ASSIGN   6683>>IF       6698>>IF       6713>>IF       6750>>IF
OCS_STA
      2488**DCL      5663>>ASSIGN
OCS_STRUCTC
      2487**DCL      5655>>ASSIGN
OCS_STRUCTURE
      2487**DCL      2487--REDEF
OCS_VECTOR
      2490**DCL      5652>>ASSIGN
OCW$WRITE
        31**DCL-ENT  6002--CALL
OC_ACCT_SAVE.ACTIVE
      2477**DCL      6682<<ASSIGN   6712<<ASSIGN   6732<<ASSIGN   6740<<ASSIGN   6808>>IF
OC_ACCT_SAVE.HOUR
      2477**DCL      6686<<ASSIGN   6691<<ASSIGN   6718<<ASSIGN   6725<<ASSIGN   6811>>ASSIGN
OC_ACCT_SAVE.MIN
      2477**DCL      6687<<ASSIGN   6692<<ASSIGN   6719<<ASSIGN   6726<<ASSIGN   6812>>ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:355  
OC_CADDR
      2471**DCL      5522<<ASSIGN   5560<>CALL     5654>>ASSIGN   5712>>IF       5785>>ASSIGN   5835>>ASSIGN
      5881>>ASSIGN   5936<>CALL     5955>>IF       6002<>CALL     6013<>CALL     6030<>CALL     6076<>CALL
      6109<>CALL     6137<>CALL     6150<>CALL     6157<>CALL     6178<>CALL     6190<>CALL     6198<>CALL
      6217<>CALL     6230<>CALL     6255<>CALL     6544<>CALL     6609<>CALL     6635<>CALL     6648<>CALL
      6653<>CALL     6658<>CALL     6888<>CALL     6903<>CALL     6910<>CALL     6919<>CALL     6967<>CALL
      7020<>CALL     7112<>CALL     7126<>CALL     7134<>CALL     7151<>CALL     7197<>CALL     7204<>CALL
      7221<>CALL     7240<>CALL     7251<>CALL     7259>>ASSIGN   7306<>CALL     7325>>ASSIGN   7335<>CALL
      7359<>CALL
OC_CONSOLE.ACCT
      2436**DCL      6673<<ASSIGN   6679<<ASSIGN   6830>>ASSIGN
OC_CONSOLE.ACTIVE
      2435**DCL      5516>>IF       5518<<ASSIGN   5769<<ASSIGN   6290>>IF       6336>>IF       6394>>IF
      6452>>IF       6498>>IF       6559>>IF       6627>>IF
OC_CONSOLE.ATTR
      2432**DCL      2432--REDEF    5486>>IF       5689>>IF       5694>>ASSIGN   5699>>IF       5964>>IF
      5968>>ASSIGN   6242>>ASSIGN   6295>>IF       6336>>IF       6350>>IF       6350>>IF       6403>>IF
      6452>>IF       6452>>IF       6500>>IF       6561>>IF       6629>>IF
OC_CONSOLE.ATTRO
      2433**DCL      2433--REDEF
OC_CONSOLE.ATTR_INPUT
      2432**DCL      5606>>ASSIGN   5975>>IF       6581>>ASSIGN   6583>>ASSIGN   6585>>ASSIGN   6587>>ASSIGN
      6589>>ASSIGN   6591>>ASSIGN   6593>>ASSIGN   6838>>ASSIGN   6840>>ASSIGN   6842>>ASSIGN   6844>>ASSIGN
      6846>>ASSIGN   6848>>ASSIGN   6850>>ASSIGN
OC_CONSOLE.ATTR_OUTPUT
      2433**DCL      5607>>ASSIGN   5620>>ASSIGN   6595>>ASSIGN   6597>>ASSIGN   6599>>ASSIGN   6601>>ASSIGN
      6603>>ASSIGN   6605>>ASSIGN   6607>>ASSIGN   6852>>ASSIGN   6854>>ASSIGN   6856>>ASSIGN   6858>>ASSIGN
      6860>>ASSIGN   6862>>ASSIGN   6864>>ASSIGN
OC_CONSOLE.CID
      2431**DCL      2432--REDEF    5522>>ASSIGN   6303>>CALL     6420>>CALL     6462>>CALL     6506>>CALL
OC_CONSOLE.DONT_TIME
      2436**DCL      6262>>IF       6265<<ASSIGN   6273>>IF       6278<<ASSIGN   6827>>ASSIGN
OC_CONSOLE.FIRST_READ
      2436**DCL      5632>>IF       5644<<ASSIGN
OC_CONSOLE.GHST
      2435**DCL      5759>>IF       5764<<ASSIGN   5806>>IF       5809<<ASSIGN   6804>>ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:356  
OC_CONSOLE.GHSTRD
      2435**DCL      5765<<ASSIGN   5777>>IF       5788<<ASSIGN   5923>>IF       6871>>IF
OC_CONSOLE.LOGON
      2431**DCL      6569>>ASSIGN   6750>>IF       6796>>ASSIGN   6938>>IF
OC_CONSOLE.LP_WSN
      2431**DCL      6868>>ASSIGN   7011<<ASSIGN
OC_CONSOLE.MXPRIO
      2469**DCL      6579>>ASSIGN   6836>>ASSIGN
OC_CONSOLE.NATLANG
      2436**DCL      6745<<ASSIGN   6828>>ASSIGN
OC_CONSOLE.PROFILE
      2469**DCL      6931>>IF       6952<<ASSIGN
OC_CONSOLE.PROFILE.TXT
      2469**DCL      6866>>ASSIGN
OC_CONSOLE.PROMPTS
      2436**DCL      5927--IF       5931--ASSIGN   6875--IF       6879--ASSIGN
OC_CONSOLE.SHIFT
      2435**DCL      5545>>IF       5896>>IF       5901<<ASSIGN   5909>>IF       5912<<ASSIGN   6826>>ASSIGN
OC_CONSOLE.STATION
      2430**DCL      2430--REDEF    5752>>IF       5833>>ASSIGN   6241>>ASSIGN   6358>>ASSIGN   6946--ASSIGN
OC_CONSOLE.STATIONR.FIRST_HALF
      2430**DCL      6336>>IF       6396>>IF       6416>>ASSIGN   6449>>ASSIGN   6495>>ASSIGN   6564>>ASSIGN
      6762>>ASSIGN   6776>>IF       6791>>ASSIGN
OC_CONSOLE.STATIONR.SECND_HALF
      2430**DCL      5984>>IF
OC_CONSOLE.SYSID
      2432**DCL      5762>>ASSIGN   5763<<ASSIGN   5777>>IF       5786>>ASSIGN   5845>>IF       5848>>ASSIGN
      5863>>IF       5866>>ASSIGN   5878>>IF       5882>>ASSIGN   6076<>CALL     6109<>CALL     6137<>CALL
      6150<>CALL     6157<>CALL     6178<>CALL     6190<>CALL     6198<>CALL     6230<>CALL
OC_CONSOLE.TERM_NAME
      2431**DCL      5491>>ASSIGN   6292>>IF       6326>>ASSIGN   6336>>IF       6378>>ASSIGN   6399>>IF
      6414>>ASSIGN   6448>>ASSIGN   6494>>ASSIGN   6566>>ASSIGN   6633>>ASSIGN   6768>>ASSIGN   6776>>IF
      6793>>ASSIGN
OC_CONSOLE.TRANSAC_LAST_MIN
      2435**DCL      5503<<ASSIGN
OC_CONSOLE.VLR_HELP
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:357  
      2453**DCL      6040<<ASSIGN   6045--ASSIGN   6170--ASSIGN   6209--ASSIGN
OC_CONSOLE.VLR_HELP.RECCNT
      2459**DCL      6146>>IF       6148>>DOINDEX  6186>>IF       6188>>DOINDEX  6225>>IF       6228>>DOINDEX
OC_CONSOLE.WSN
      2431**DCL      5702>>CALLBLT  5703>>IF       5962>>CALLBLT  5975>>IF       6572>>ASSIGN   6799>>ASSIGN
      6986>>CALLBLT  6987>>IF
OC_CONSOLE.X_DCBNUM
      2434**DCL      5563>>IF       5626>>IF       5632>>IF
OC_CONSOLE$
      2429**DCL      2430--IMP-PTR  5486>>IF       5491>>ASSIGN   5503>>ASSIGN   5516>>IF       5518>>ASSIGN
      5522>>ASSIGN   5545>>IF       5563>>IF       5606>>ASSIGN   5607>>ASSIGN   5620>>ASSIGN   5626>>IF
      5632>>IF       5632>>IF       5644>>ASSIGN   5689>>IF       5694>>ASSIGN   5699>>IF       5702>>CALLBLT
      5703>>IF       5752>>IF       5759>>IF       5762>>ASSIGN   5763>>ASSIGN   5764>>ASSIGN   5765>>ASSIGN
      5769>>ASSIGN   5777>>IF       5777>>IF       5786>>ASSIGN   5788>>ASSIGN   5806>>IF       5809>>ASSIGN
      5833>>ASSIGN   5845>>IF       5848>>ASSIGN   5863>>IF       5866>>ASSIGN   5878>>IF       5882>>ASSIGN
      5896>>IF       5901>>ASSIGN   5909>>IF       5912>>ASSIGN   5923>>IF       5927>>IF       5931>>ASSIGN
      5962>>CALLBLT  5964>>IF       5968>>ASSIGN   5975>>IF       5975>>IF       5984>>IF       6040>>ASSIGN
      6045>>ASSIGN   6076>>CALL     6109>>CALL     6137>>CALL     6146>>IF       6148>>DOINDEX  6150>>CALL
      6157>>CALL     6170>>ASSIGN   6178>>CALL     6186>>IF       6188>>DOINDEX  6190>>CALL     6198>>CALL
      6209>>ASSIGN   6225>>IF       6228>>DOINDEX  6230>>CALL     6241>>ASSIGN   6242>>ASSIGN   6262>>IF
      6265>>ASSIGN   6273>>IF       6278>>ASSIGN   6290>>IF       6292>>IF       6295>>IF       6303>>CALL
      6326>>ASSIGN   6336>>IF       6336>>IF       6336>>IF       6336>>IF       6350>>IF       6350>>IF
      6358>>ASSIGN   6378>>ASSIGN   6394>>IF       6396>>IF       6399>>IF       6403>>IF       6414>>ASSIGN
      6416>>ASSIGN   6420>>CALL     6448>>ASSIGN   6449>>ASSIGN   6452>>IF       6452>>IF       6452>>IF
      6462>>CALL     6494>>ASSIGN   6495>>ASSIGN   6498>>IF       6500>>IF       6506>>CALL     6559>>IF
      6561>>IF       6564>>ASSIGN   6566>>ASSIGN   6569>>ASSIGN   6572>>ASSIGN   6579>>ASSIGN   6581>>ASSIGN
      6583>>ASSIGN   6585>>ASSIGN   6587>>ASSIGN   6589>>ASSIGN   6591>>ASSIGN   6593>>ASSIGN   6595>>ASSIGN
      6597>>ASSIGN   6599>>ASSIGN   6601>>ASSIGN   6603>>ASSIGN   6605>>ASSIGN   6607>>ASSIGN   6627>>IF
      6629>>IF       6633>>ASSIGN   6673>>ASSIGN   6679>>ASSIGN   6745>>ASSIGN   6750>>IF       6762>>ASSIGN
      6768>>ASSIGN   6776>>IF       6776>>IF       6791>>ASSIGN   6793>>ASSIGN   6796>>ASSIGN   6799>>ASSIGN
      6804>>ASSIGN   6826>>ASSIGN   6827>>ASSIGN   6828>>ASSIGN   6830>>ASSIGN   6836>>ASSIGN   6838>>ASSIGN
      6840>>ASSIGN   6842>>ASSIGN   6844>>ASSIGN   6846>>ASSIGN   6848>>ASSIGN   6850>>ASSIGN   6852>>ASSIGN
      6854>>ASSIGN   6856>>ASSIGN   6858>>ASSIGN   6860>>ASSIGN   6862>>ASSIGN   6864>>ASSIGN   6866>>ASSIGN
      6868>>ASSIGN   6871>>IF       6875>>IF       6879>>ASSIGN   6931>>IF       6938>>IF       6946>>ASSIGN
      6952>>ASSIGN   6986>>CALLBLT  6987>>IF       7011>>ASSIGN
OC_DEF_ACCT
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:358  
      2476**DCL      6670<<ASSIGN   6676<<ASSIGN   6829>>ASSIGN
OC_DIR
      2472**DCL      2472--REDEF
OC_FIRST
      2471**DCL      5523<<ASSIGN
OC_HIST_SAVE.ACTIVE
      2476**DCL      6697<<ASSIGN   6728<<ASSIGN   6736<<ASSIGN   6741<<ASSIGN   6817>>IF
OC_HIST_SAVE.HOUR
      2476**DCL      6701<<ASSIGN   6706<<ASSIGN   6716<<ASSIGN   6723<<ASSIGN   6820>>ASSIGN
OC_HIST_SAVE.MIN
      2476**DCL      6702<<ASSIGN   6707<<ASSIGN   6717<<ASSIGN   6724<<ASSIGN   6821>>ASSIGN
OC_INTBIT
      2472**DCL      2473--REDEF
OC_INTMSG
      2349**DCL      2362--REDEF
OC_INTMSG.FLAGS
      2356**DCL      2357--REDEF
OC_INTMSG.MESS
      2362**DCL      2362--REDEF
OC_INTMSG.MSGID
      2352**DCL      2353--REDEF
OC_INTMSG.WSN
      2359**DCL      2360--REDEF
OC_KEYIN#
      2423**DCL      5569>>IF       5580>>IF       5636>>IF       5636>>IF       5653>>ASSIGN
OC_KEYINBUF
      2426**DCL      5563--IF       5626--IF       5632--IF
OC_KEYINBUF$
      2470**DCL      5475<<ASSIGN   5529>>DOWHILE  5547<>CALL     5563>>IF       5626>>IF       5632>>IF
OC_KEY_GOOD
      2474**DCL      5505>>IF
OC_LIST
      2475**DCL      5573>>IF       6806>>ASSIGN
OC_MASK
      2473**DCL      2473--REDEF
OC_MAXCONSOLE
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:359  
      2429**DCL      5481>>ASSIGN   5483>>IF       6289>>DOINDEX  6335>>DOINDEX  6362>>ASSIGN   6393>>DOINDEX
      6424>>ASSIGN   6451>>DOINDEX  6497>>DOINDEX  6557>>DOINDEX  6625>>DOINDEX
OC_MESSBUF
      2364**DCL      2379--REDEF    2393--REDEF
OC_MESSBUF.FLAGS
      2371**DCL      2372--REDEF
OC_MESSBUF.MESS
      2377**DCL      2377--REDEF
OC_MESSBUF.MSGID
      2367**DCL      2368--REDEF
OC_MESSBUF.WSN
      2374**DCL      2375--REDEF
OC_MESSBUF1.FLAGS
      2386**DCL      2387--REDEF
OC_MESSBUF1.LEN
      2392**DCL      2392--REDEF
OC_MESSBUF1.MSGID
      2382**DCL      2383--REDEF
OC_MESSBUF1.WSN
      2389**DCL      2390--REDEF
OC_MSGBUFFER
      2395**DCL      2410--REDEF
OC_MSGBUFFER.FLAGS
      2402**DCL      2403--REDEF
OC_MSGBUFFER.MESS
      2408**DCL      2408--REDEF
OC_MSGBUFFER.MSGID
      2398**DCL      2399--REDEF
OC_MSGBUFFER.WSN
      2405**DCL      2406--REDEF
OC_MSGBUFFER2.FLAGS
      2417**DCL      2418--REDEF
OC_MSGBUFFER2.MSGID
      2413**DCL      2414--REDEF
OC_MSGBUFFER2.WSN
      2420**DCL      2421--REDEF
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:360  
OC_PARAM
      2428**DCL      2428--REDEF    3757--DCLINIT  3758--DCLINIT  5651--ASSIGN   6244--ASSIGN   6244--ASSIGN
      7275--ASSIGN   7279--ASSIGN
OC_PARAM$
      2471**DCL      5834>>ASSIGN   5837>>ASSIGN   6050>>IF       6050>>IF       6050>>IF       6050>>IF
      6050>>IF       6058>>ASSIGN   6065>>ASSIGN   6102>>IF       6102>>IF       6102>>IF       6102>>IF
      6114>>IF       6114>>IF       6114>>IF       6114>>IF       6123>>IF       6292>>IF       6302>>ASSIGN
      6303>>CALL     6303>>CALL     6322>>CALL     6324>>IF       6326>>ASSIGN   6329>>IF       6331>>ASSIGN
      6331>>ASSIGN   6336>>IF       6336>>IF       6373>>CALL     6376>>IF       6378>>ASSIGN   6381>>IF
      6383>>ASSIGN   6383>>ASSIGN   6386>>IF       6396>>IF       6399>>IF       6408>>ASSIGN   6411>>ASSIGN
      6411>>ASSIGN   6437>>IF       6446>>ASSIGN   6447>>ASSIGN   6447>>ASSIGN   6484>>IF       6492>>ASSIGN
      6493>>ASSIGN   6493>>ASSIGN   6658>>CALL     6664>>CALL     6676>>ASSIGN   6679>>ASSIGN   6691>>ASSIGN
      6692>>ASSIGN   6706>>ASSIGN   6707>>ASSIGN   6723>>ASSIGN   6724>>ASSIGN   6725>>ASSIGN   6726>>ASSIGN
      6745>>ASSIGN   6750>>IF       6760>>IF       6762>>ASSIGN   6764>>CALL     6766>>IF       6768>>ASSIGN
      6771>>IF       6773>>ASSIGN   6773>>ASSIGN   6776>>IF       6776>>IF       6926>>ASSIGN   6927>>ASSIGN
      6987>>IF       7000>>CALLBLT  7011>>ASSIGN   7013>>ASSIGN   7035>>IF       7035>>IF       7044>>ASSIGN
      7046>>ASSIGN   7076>>ASSIGN   7163>>ASSIGN   7166>>ASSIGN   7167>>ASSIGN   7167>>ASSIGN   7169>>ASSIGN
      7171>>ASSIGN   7171>>ASSIGN   7171>>ASSIGN   7171>>ASSIGN   7215>>ASSIGN   7218>>IF       7231>>IF
      7231>>IF       7231>>IF       7231>>IF       7247>>CALLBLT  7261>>ASSIGN   7262>>ASSIGN   7264>>ASSIGN
      7265>>ASSIGN   7265>>ASSIGN   7288>>IF       7292>>ASSIGN   7294>>ASSIGN   7294>>ASSIGN
OC_PARAM1.COUNT
      2429**DCL      5718>>IF       5726>>ASSIGN   5790>>IF       5798>>ASSIGN
OC_PARAM1.KEYIN#
      2428**DCL      5667>>DOCASE   5810<<ASSIGN   7256>>IF
OC_PARAM1.READID
      2429**DCL      5674>>IF
OC_PARAM1.REPLY
      2429**DCL      5727--ASSIGN   5799--ASSIGN
OC_PLATEN_WIDTH
      2477**DCL      7044<<ASSIGN
OC_QHEAD
      2424**DCL      5472>>IF
OC_QUEUE.ERR.CODE
      2427**DCL      5472>>IF
OC_QUEUE.PARMC
      2427**DCL      2427--REDEF
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:361  
OC_ZIP
      2474**DCL      5820>>IF       7122>>IF       7320>>IF
OOPS_MSG
      3469**DCL      3828--DCLINIT  3829--DCLINIT
OOPS_WRITE
      3827**DCL      5508<>CALL
OOPS_WRITE.STATION_
      3829**DCL      3829--REDEF
OOPS_WRITE.V
      3830**DCL      3827--DCLINIT
OOPS_WRITE.V.DVBYTE.VFC#
      3836**DCL      3836--REDEF
OPEN_TP_CNTRL
      4062**DCL      7285<>CALL
OPEN_TP_CNTRL.ACSVEH_
      4064**DCL      4065--REDEF
OPEN_TP_CNTRL.ALTKEYS_
      4070**DCL      4071--REDEF    4071--REDEF
OPEN_TP_CNTRL.HDR_
      4069**DCL      4070--REDEF
OPEN_TP_CNTRL.TAB_
      4068**DCL      4069--REDEF
OPEN_TP_CNTRL.UHL_
      4062**DCL      4063--REDEF    4063--REDEF
OPEN_TP_CNTRL.V
      4071**DCL      4062--DCLINIT
OPEN_TP_CNTRL.V.FSN#
      4102**DCL      4102--REDEF    4102--REDEF
OPEN_TP_CNTRL.WSN_
      4068**DCL      4068--REDEF
OPTION_ IN PROCEDURE WRITE_ERR
      7352**DCL      7351--PROC     7357>>ASSIGN
PARSE_IT
      5531**LABEL    5527--GOTO     5535--GOTO
PASS_INDEX
        46**DCL      5583<<CALLBLT  5587<<CALLBLT  5587>>CALLBLT  5591>>IF       5594>>CALLBLT
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:362  
PC$HDR
      3934**DCL      7286--ASSIGN
PC$HDR.CURINSTANCES
      3935**DCL      7287>>DOINDEX
PC$INSTANCE
      3938**DCL      7300--ASSIGN
PC$INSTANCE.FLAGS.DELETED
      3943**DCL      7288>>IF
PC$INSTANCE.FLAGS.HEADER
      3944**DCL      7296<<ASSIGN
PC$INSTANCE.HDR.CNT
      3947**DCL      7293<<ASSIGN
PC$INSTANCE.HDR.MSG
      3948**DCL      7294<<ASSIGN
PC$INSTANCE.INSTANCE_NAME
      3939**DCL      7288>>IF
PFB
      3423**DCL      6882<<ASSIGN   6888<>CALL
PROFMSGB
      3270**DCL      6967<>CALL
PROFMSGB.CODE
      3273**DCL      6963<<ASSIGN   6965<<ASSIGN
PROFMSGB.ERR
      3271**DCL      3272--REDEF
PROFMSGB.ERROR
      3272**DCL      6958<<ASSIGN
PROFMSGC
      3266**DCL      6967<>CALL
PROF_BUFFER
      3433**DCL      6945--ASSIGN
PROF_NAME
      5148**DCL      5117--DCLINIT  6931>>IF       6952>>ASSIGN
PROF_NAME.L#
      5148**DCL      6926<<ASSIGN   6927>>ASSIGN   6959>>IF       6959>>IF
PROF_NAME.NAME#
      5148**DCL      6927<<ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:363  
PROMPT_TABLE.LAST_READ
      2469**DCL      5927>>IF       6875>>IF
PROMPT_TABLE.SIZER
      2470**DCL      5931>>ASSIGN   6879>>ASSIGN
PRO_CEED
      5984**LABEL    5957--GOTO     5966--GOTO     5973--GOTO     5982--GOTO     5989--GOTO
PTR$
        48**DCL      5651<<ASSIGN   5652>>ASSIGN   5653>>ASSIGN   5654>>ASSIGN   5655>>ASSIGN   7076<<ASSIGN
      7077>>ASSIGN   7078>>ASSIGN   7078>>ASSIGN   7078>>ASSIGN   7080<<ASSIGN   7080>>ASSIGN   7080>>ASSIGN
      7081>>IF       7081>>IF       7081>>IF       7088>>ASSIGN   7088>>ASSIGN   7088>>ASSIGN   7171<<ASSIGN
      7177>>IF       7180>>ASSIGN
PWIDTH_MSGB
      3278**DCL      7051<>CALL
PWIDTH_MSGB.PWIDTH
      3279**DCL      7046<<ASSIGN
PWIDTH_MSGC
      3275**DCL      7051<>CALL
REGULAR_READB
      3222**DCL      6013<>CALL
REGULAR_READC
      3227**DCL      6013<>CALL
REGULAR_READC.ACCT
      3230**DCL      6012<<ASSIGN
REGULAR_READC.SIZER
      3229**DCL      6011<<ASSIGN
REPLY
      3792**DCL      5731<>CALL     5802<>CALL
REPLY.BUF_.BOUND
      3792**DCL      5721<<ASSIGN   5726<<ASSIGN   5793<<ASSIGN   5798<<ASSIGN
REPLY.BUF_.BUF$
      3794**DCL      5722<<ASSIGN   5727<<ASSIGN   5794<<ASSIGN   5799<<ASSIGN
REPLY.STATION_
      3794**DCL      3794--REDEF
REPLY.V
      3795**DCL      3792--DCLINIT
REPLY.V.DVBYTE.VFC#
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:364  
      3801**DCL      3801--REDEF
SKIPIT
      7304**LABEL    7285--CALLALT  7302--CALLALT
STA
      3718**DCL      3758--DCLINIT  3794--DCLINIT  3829--DCLINIT  3857--DCLINIT  5040--DCLINIT
STA.MSGIDXT
      3728**DCL      3731--REDEF
STA.STATION#
      3722**DCL      5477<<ASSIGN   5482<>CALL     5663<<ASSIGN   5664>>IF       5730<<ASSIGN   5744<<ASSIGN
      5787<<ASSIGN   5811<<ASSIGN   5839<<ASSIGN   5883<<ASSIGN   6358<<ASSIGN   7261<<ASSIGN   7320>>IF
      7334>>ASSIGN
STATS_WRITEB
      3336**DCL      6609<>CALL     6888<>CALL
STATS_WRITEB.ACCT_HR
      3340**DCL      6811<<ASSIGN   6815<<ASSIGN
STATS_WRITEB.ACCT_MIN
      3341**DCL      6812<<ASSIGN
STATS_WRITEB.GHOST_ACTIVE
      3338**DCL      6804<<ASSIGN
STATS_WRITEB.HIST
      3339**DCL      6806<<ASSIGN
STATS_WRITEB.HIST_HR
      3342**DCL      6820<<ASSIGN   6824<<ASSIGN
STATS_WRITEB.HIST_MIN
      3343**DCL      6821<<ASSIGN
STATS_WRITEB.I_ADMN
      3352**DCL      6585<<ASSIGN   6842<<ASSIGN
STATS_WRITEB.I_COMM
      3355**DCL      6591<<ASSIGN   6848<<ASSIGN
STATS_WRITEB.I_DEV
      3351**DCL      6583<<ASSIGN   6840<<ASSIGN
STATS_WRITEB.I_DLTA
      3353**DCL      6587<<ASSIGN   6844<<ASSIGN
STATS_WRITEB.I_LIB
      3354**DCL      6589<<ASSIGN   6846<<ASSIGN
STATS_WRITEB.I_SYS
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:365  
      3350**DCL      6581<<ASSIGN   6838<<ASSIGN
STATS_WRITEB.I_TP
      3369**DCL      6593<<ASSIGN   6850<<ASSIGN
STATS_WRITEB.LGN
      3363**DCL      6569<<ASSIGN   6796<<ASSIGN
STATS_WRITEB.LPWSN
      3367**DCL      6868<<ASSIGN
STATS_WRITEB.MXPRIO
      3349**DCL      6579<<ASSIGN   6836<<ASSIGN
STATS_WRITEB.MYREADA
      3348**DCL      6830<<ASSIGN   6832>>IF       6834<<ASSIGN
STATS_WRITEB.NAME
      3362**DCL      6564<<ASSIGN   6791<<ASSIGN
STATS_WRITEB.NATLANG
      3346**DCL      6828<<ASSIGN
STATS_WRITEB.O_ADMN
      3358**DCL      6599<<ASSIGN   6856<<ASSIGN
STATS_WRITEB.O_COMM
      3361**DCL      6605<<ASSIGN   6862<<ASSIGN
STATS_WRITEB.O_DEV
      3357**DCL      6597<<ASSIGN   6854<<ASSIGN
STATS_WRITEB.O_DLTA
      3359**DCL      6601<<ASSIGN   6858<<ASSIGN
STATS_WRITEB.O_LIB
      3360**DCL      6603<<ASSIGN   6860<<ASSIGN
STATS_WRITEB.O_SYS
      3356**DCL      6595<<ASSIGN   6852<<ASSIGN
STATS_WRITEB.O_TP
      3370**DCL      6607<<ASSIGN   6864<<ASSIGN
STATS_WRITEB.PROF
      3366**DCL      6866<<ASSIGN
STATS_WRITEB.SIZE
      3368**DCL      6870<<ASSIGN   6879<<ASSIGN
STATS_WRITEB.SUB_MESS#
      3337**DCL      6575<<ASSIGN   6577<<ASSIGN   6886<<DOINDEX
STATS_WRITEB.SYSRACCT
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:366  
      3347**DCL      6829<<ASSIGN   6834>>ASSIGN
STATS_WRITEB.TERM
      3364**DCL      6566<<ASSIGN   6793<<ASSIGN
STATS_WRITEB.TIME
      3345**DCL      6827<<ASSIGN
STATS_WRITEB.UPPER
      3344**DCL      6826<<ASSIGN
STATS_WRITEB.WSN
      3365**DCL      6572<<ASSIGN   6799<<ASSIGN
STATS_WRITEC
      3371**DCL      6609<>CALL     6888<>CALL
STA_MSGB
      3307**DCL      7221<>CALL     7240<>CALL     7251<>CALL     7306<>CALL     7335<>CALL
STA_MSGB.CODE
      3309**DCL      7214<<ASSIGN   7333<<ASSIGN
STA_MSGB.STATION
      3308**DCL      7215<<ASSIGN   7334<<ASSIGN
STA_MSGC
      3311**DCL      7221<>CALL     7240<>CALL     7251<>CALL     7306<>CALL     7335<>CALL
SYSACCT
      4190**DCL      4067--DCLINIT
TELL_WRITEB
      3261**DCL      6420<>CALL     6462<>CALL     6506<>CALL
TELL_WRITEB.CONSOLE
      3262**DCL      6416<<ASSIGN   6449<<ASSIGN   6495<<ASSIGN
TELL_WRITEB.TERM
      3263**DCL      6414<<ASSIGN   6448<<ASSIGN   6494<<ASSIGN
TELL_WRITEB.TEXT
      3264**DCL      6386--IF       6411<<ASSIGN   6437--IF       6447<<ASSIGN   6484--IF       6493<<ASSIGN
TELL_WRITEC
      3256**DCL      6420<>CALL     6462<>CALL     6506<>CALL
TELL_WRITEC.SIZE
      3259**DCL      6408<<ASSIGN   6446<<ASSIGN   6492<<ASSIGN
TEMP2
      3427**DCL      7377<<ASSIGN   7378>>IF       7378>>IF       7384>>IF       7384>>IF       7388<<ASSIGN
      7388>>ASSIGN   7390>>CALLBLT
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:367  
TEXT.C
      3145**DCL      6072>>IF       6087>>ASSIGN   6097>>ASSIGN   6244>>ASSIGN   7078>>ASSIGN   7081>>IF
      7088--ASSIGN
TEXT.CNT
      3144**DCL      3145--IMP-SIZ  6059>>ASSIGN   6060>>ASSIGN   6066>>ASSIGN   6072>>IF       6083>>IF
      6086>>ASSIGN   6087>>ASSIGN   6093>>IF       6096>>ASSIGN   6097>>ASSIGN   6244>>ASSIGN   7077>>ASSIGN
      7078>>ASSIGN   7078>>ASSIGN   7080>>ASSIGN   7081>>IF       7081>>IF       7088>>ASSIGN   7088>>ASSIGN
TIME_BUF
      5076**DCL      5069--DCLINIT  5070--DCLINIT
TIX1
      3426**DCL      7376<<DOINDEX  7377>>ASSIGN
TIX2
      3425**DCL      7374<<ASSIGN   7383<<ASSIGN   7383>>ASSIGN   7390>>CALLBLT  7396>>IF       7398<<ASSIGN
      7398>>ASSIGN   7401>>ASSIGN
TP_CNTRL_D
      4132**DCL      4063--DCLINIT
TP_INSTRUCTION
        67**DCL      7268--ASSIGN
TP_INSTRUCTION.ATTR
        70**DCL      7262<<ASSIGN   7269--ASSIGN
TP_INSTRUCTION.INSTRUCT
        72**DCL      7265<<ASSIGN
TP_INSTRUCTION.KEY_NUM
        69**DCL      7263<<ASSIGN   7269--ASSIGN
TP_INSTRUCTION.LENGTH
        71**DCL      7264<<ASSIGN   7269--ASSIGN   7269>>ASSIGN
TP_MSGB
      3325**DCL      7197<>CALL     7204<>CALL
TP_MSGB.CODE
      3328**DCL      7196<<ASSIGN   7203<<ASSIGN
TP_MSGB.ERR
      3326**DCL      3327--REDEF
TP_MSGB.ERROR
      3327**DCL      7202<<ASSIGN
TP_MSGB.TPNAME
      3329**DCL      7168<<ASSIGN   7169<<ASSIGN
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:368  
TP_MSGC
      3331**DCL      7197<>CALL     7204<>CALL
TP_SEND_IT
      7256**LABEL    7247--CALLALT
TP_TROUBLE
      7279**LABEL    7274--CALLALT
VLP_HELP_RESULTS
      5267**DCL      5250--DCLINIT  5284--DCLINIT  6142>>ASSIGN   6183>>ASSIGN   6222>>ASSIGN
VLP_HELP_RESULTS.PTR$
      5269**DCL      6133<<ASSIGN   6149>>ASSIGN   6174<<ASSIGN   6189>>ASSIGN   6213<<ASSIGN   6229>>ASSIGN
VLP_HELP_RESULTS.W2
      5268**DCL      5269--REDEF
WORD_
        65**DCL      6001<<ASSIGN   6002<>CALL
WRITE_ERR
      7351**PROC     5625--CALL     5640--CALL     5735--CALL     5738--CALL     5781--CALL     5815--CALL
      5852--CALL     5856--CALL     5870--CALL     5874--CALL     5887--CALL     5891--CALL     5898--CALL
      5902--CALL     5913--CALL     5916--CALL     6266--CALL     6269--CALL     6275--CALL     6279--CALL
      6315--CALL     6355--CALL     6367--CALL     6389--CALL     6430--CALL     6440--CALL     6474--CALL
      6487--CALL     6517--CALL     6643--CALL     6746--CALL     6754--CALL     6785--CALL     6934--CALL
      6941--CALL     6993--CALL     7007--CALL     7040--CALL     7103--CALL     7313--CALL
WRITE_IT_OUT
      7314**LABEL    5812--GOTO     5841--GOTO
WR_ERSEND
      5094**DCL      6247<>CALL
WR_ERSEND.V
      5094**DCL      5094--DCLINIT
WR_STA
      3756**DCL      7274<>CALL     7327<>CALL
WR_STA.BUF_.BOUND
      3756**DCL      5656<<ASSIGN   7269<<ASSIGN
WR_STA.BUF_.BUF$
      3758**DCL      7268<<ASSIGN   7275<<ASSIGN   7279<<ASSIGN
WR_STA.STATION_
      3758**DCL      3758--REDEF
WR_STA.V
PL6.E3A0      #001=OCN$KEYIN File=OCN$KEYIN.:E05TSI                              WED 07/30/97 04:01 Page:369  
      3759**DCL      3756--DCLINIT
WR_STA.V.DVBYTE.VFC#
      3765**DCL      3765--REDEF
WR_STA.V.EVENT#
      3764**DCL      7260<<ASSIGN   7326<<ASSIGN
ZAP_PHASE_MSGB
      3315**DCL      7126<>CALL     7134<>CALL     7151<>CALL
ZAP_PHASE_MSGB.MING
      3318**DCL      7150<<ASSIGN
ZAP_PHASE_MSGB.PHASE
      3316**DCL      7125<<ASSIGN   7131<<ASSIGN   7149<<ASSIGN
ZAP_PHASE_MSGB.TIME
      3317**DCL      7132<<ASSIGN
ZAP_PHASE_MSGC
      3320**DCL      7126<>CALL     7134<>CALL     7151<>CALL
ZI
        43**DCL      7144<<DOINDEX  7145>>IF       7145>>IF       7150>>ASSIGN

PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:370  
     2524        1        /*M* OCN$SKEYIN KEYINs routine to setup and perform keyin from OCCG */
     2525        2        /*T***********************************************************/
     2526        3        /*T*                                                         */
     2527        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2528        5        /*T*                                                         */
     2529        6        /*T***********************************************************/
     2530        7        %SET LISTSUB='1'B;
     2531        8
     2532        9
     2533       10        /*
     2534       11          ###   ###  #   #   #    ###  #   # ##### #   #  ###  #   #
     2535       12         # # # #   # #   #  ###  #   # #  #  #     #   #   #   #   #
     2536       13         # # # #     ##  # # #   #     # #   #      # #    #   ##  #
     2537       14         #  ## #     # # #  ###   ###  ##    ####    #     #   # # #
     2538       15         #   # #     #  ##   # #     # # #   #       #     #   #  ##
     2539       16         #   # #   # #   #  ###  #   # #  #  #       #     #   #   #
     2540       17          ###   ###  #   #   #    ###  #   # #####   #    ###  #   #
     2541       18                                                                          */
     2542       19
     2543       20
     2544       21        OCN$SKEYIN: PROC;
     2545       22
     2546       23        %INCLUDE CP_6;
     2547      104
     2548      105    1   DCL NWIO$ PTR;
     2549      106    1   DCL I UBIN WORD;
     2550      107
     2551      108    1   DCL OCN$KEYIN ENTRY(3);
     2552      109    1   DCL OCP$OCCG ENTRY;
     2553      110
     2554      111        %INCLUDE OC_SUBS_C;
     2555      842        %INCLUDE OCI_SUBS_C;
     2556      940        %INCLUDE OCS_SUBS_C;
     2557     1157        %INCLUDE OC_DAT_R;
     2558     1318
     2559     1319        %B$NWIO (STCLASS="BASED(NWIO$)",PARONLY=1,NAME=NWIO);
     2560     1400
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:371  
     2561     1401        %EJECT;
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:372  
     2562     1402        /*
     2563     1403             Begin  O C N $ S K E Y I N   main
     2564     1404                                                                          */
     2565     1405
     2566     1406    1      NWIO$=ADDR(OC_QUEUE.PARMS(OC_QHEAD));
     2567     1407
     2568     1408    1      IF NWIO.CGPARM.MSGTYP#='*AUEV'
     2569     1409    1      THEN
     2570     1410    2      DO;
     2571     1411    2         CALL OCP$OCCG;
     2572     1412    2         RETURN;
     2573     1413    2      END;
     2574     1414
     2575     1415    1      CALL OCN$KEYIN(OC_KEYINBUF,NWIO.ARS,NWIO.CGPARM.STATION#);
     2576     1416
     2577     1417    1      RETURN;
     2578     1418    1   END OCN$SKEYIN;

PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:373  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCS_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCN$SKEYIN.

   Procedure OCN$SKEYIN requires 26 words for executable code.
   Procedure OCN$SKEYIN requires 10 words of local(AUTO) storage.

    No errors detected in file OCN$KEYIN.:E05TSI    .

PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:374  

 Object Unit name= OCN$SKEYIN                                 File name= OCN$KEYIN.:E05TOU
 UTS= JUL 30 '97 04:05:34.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      2      2  OCN$SKEYIN
    2   Proc  even  none    26     32  OCN$SKEYIN
    3  RoData even  none     2      2  OCN$SKEYIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  OCN$SKEYIN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 OCP$OCCG
         yes           Std       3 OCN$KEYIN
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:375  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OC_INTMSG                             OC_MESSBUF
     OC_MSGBUFFER                          OC_QHEAD                              OC_KEYINBUF
     OC_QUEUE                              OC_PARAM                              OC_CONSOLE$
     OC_DIR                                OC_INTBIT                             OC_MASK
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:376  


     2524        1        /*M* OCN$SKEYIN KEYINs routine to setup and perform keyin from OCCG */
     2525        2        /*T***********************************************************/
     2526        3        /*T*                                                         */
     2527        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2528        5        /*T*                                                         */
     2529        6        /*T***********************************************************/
     2530        7        %SET LISTSUB='1'B;
     2531        8
     2532        9
     2533       10        /*
     2534       11          ###   ###  #   #   #    ###  #   # ##### #   #  ###  #   #
     2535       12         # # # #   # #   #  ###  #   # #  #  #     #   #   #   #   #
     2536       13         # # # #     ##  # # #   #     # #   #      # #    #   ##  #
     2537       14         #  ## #     # # #  ###   ###  ##    ####    #     #   # # #
     2538       15         #   # #     #  ##   # #     # # #   #       #     #   #  ##
     2539       16         #   # #   # #   #  ###  #   # #  #  #       #     #   #   #
     2540       17          ###   ###  #   #   #    ###  #   # #####   #    ###  #   #
     2541       18                                                                          */
     2542       19
     2543       20
     2544       21        OCN$SKEYIN: PROC;

     21  2 000000   000000 700200 xent  OCN$SKEYIN   TSX0  ! X66_AUTO_0
         2 000001   000012 000000                    ZERO    10,0

     2545       22
     2546       23        %INCLUDE CP_6;
     2547      104
     2548      105    1   DCL NWIO$ PTR;
     2549      106    1   DCL I UBIN WORD;
     2550      107
     2551      108    1   DCL OCN$KEYIN ENTRY(3);
     2552      109    1   DCL OCP$OCCG ENTRY;
     2553      110
     2554      111        %INCLUDE OC_SUBS_C;
     2555      842        %INCLUDE OCI_SUBS_C;
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:377  
     2556      940        %INCLUDE OCS_SUBS_C;
     2557     1157        %INCLUDE OC_DAT_R;
     2558     1318
     2559     1319        %B$NWIO (STCLASS="BASED(NWIO$)",PARONLY=1,NAME=NWIO);
     2560     1400
     2561     1401        %EJECT;
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:378  
     2562     1402        /*
     2563     1403             Begin  O C N $ S K E Y I N   main
     2564     1404                                                                          */
     2565     1405
     2566     1406    1      NWIO$=ADDR(OC_QUEUE.PARMS(OC_QHEAD));

   1406  2 000002   000000 236000 xsym               LDQ     OC_QHEAD
         2 000003   000017 402003                    MPY     15,DU
         2 000004   000000 036000 3                  ADLQ    0
         2 000005   200003 756100                    STQ     NWIO$,,AUTO

     2567     1407
     2568     1408    1      IF NWIO.CGPARM.MSGTYP#='*AUEV'

   1408  2 000006   200003 470500                    LDP0    NWIO$,,AUTO
         2 000007   040000 106500                    CMPC    fill='040'O
         2 000010   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
         2 000011   000000 000005 1                  ADSC9   0                        cn=0,n=5
         2 000012   000017 601000 2                  TNZ     s:1415

     2569     1409    1      THEN
     2570     1410    2      DO;

     2571     1411    2         CALL OCP$OCCG;

   1411  2 000013   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000014   000000 701000 xent               TSX1    OCP$OCCG
         2 000015   000000 011000                    NOP     0

     2572     1412    2         RETURN;

   1412  2 000016   000000 702200 xent               TSX2  ! X66_ARET

     2573     1413    2      END;
     2574     1414
     2575     1415    1      CALL OCN$KEYIN(OC_KEYINBUF,NWIO.ARS,NWIO.CGPARM.STATION#);

PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:379  
   1415  2 000017   000004 036003                    ADLQ    4,DU
         2 000020   200010 756100                    STQ     NWIO$+5,,AUTO
         2 000021   200003 236100                    LDQ     NWIO$,,AUTO
         2 000022   000002 036003                    ADLQ    2,DU
         2 000023   000001 235000 3                  LDA     1
         2 000024   200006 757100                    STAQ    NWIO$+3,,AUTO
         2 000025   200006 630500                    EPPR0   NWIO$+3,,AUTO
         2 000026   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000027   000000 701000 xent               TSX1    OCN$KEYIN
         2 000030   000000 011000                    NOP     0

     2576     1416
     2577     1417    1      RETURN;

   1417  2 000031   000000 702200 xent               TSX2  ! X66_ARET
     2578     1418    1   END OCN$SKEYIN;

PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:380  
--  Include file information  --

   OC$MESSHD_C.:E05TOU  is referenced.
   OC_DAT_R.:E05TOU  cannot be made into a system file and is referenced.
   OCS_SUBS_C.:E05TOU  is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure OCN$SKEYIN.
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:381  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 NWIO$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 OC_CONSOLE$                0-0-0/c CHAR(256)   r     1 OC_KEYINBUF
     0-0-0/w UBIN        r     1 OC_QHEAD                   0-0-0/w STRC(540)   r     1 OC_QUEUE(0:8191)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(468)   r     1 NWIO


   Procedure OCN$SKEYIN requires 26 words for executable code.
   Procedure OCN$SKEYIN requires 10 words of local(AUTO) storage.

    No errors detected in file OCN$KEYIN.:E05TSI    .
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:382  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:383  
          MINI XREF LISTING

NWIO.ARS
      1325**DCL      1415<>CALL
NWIO.CGPARM.MSGIDXT
      1349**DCL      1352--REDEF
NWIO.CGPARM.MSGTYP#
      1343**DCL      1408>>IF
NWIO.CGPARM.STATION#
      1343**DCL      1415<>CALL
NWIO$
       105**DCL      1323--IMP-PTR  1406<<ASSIGN   1408>>IF       1415>>CALL     1415>>CALL
OCN$KEYIN
       108**DCL-ENT  1415--CALL
OCP$OCCG
       109**DCL-ENT  1411--CALL
OC_CONSOLE.ATTR
      1271**DCL      1271--REDEF
OC_CONSOLE.ATTRO
      1272**DCL      1272--REDEF
OC_CONSOLE.CID
      1270**DCL      1271--REDEF
OC_CONSOLE.STATION
      1269**DCL      1269--REDEF
OC_CONSOLE$
      1268**DCL      1269--IMP-PTR
OC_DIR
      1311**DCL      1311--REDEF
OC_INTBIT
      1311**DCL      1312--REDEF
OC_INTMSG
      1188**DCL      1201--REDEF
OC_INTMSG.FLAGS
      1195**DCL      1196--REDEF
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:384  
OC_INTMSG.MESS
      1201**DCL      1201--REDEF
OC_INTMSG.MSGID
      1191**DCL      1192--REDEF
OC_INTMSG.WSN
      1198**DCL      1199--REDEF
OC_KEYINBUF
      1265**DCL      1415<>CALL
OC_MASK
      1312**DCL      1312--REDEF
OC_MESSBUF
      1203**DCL      1218--REDEF    1232--REDEF
OC_MESSBUF.FLAGS
      1210**DCL      1211--REDEF
OC_MESSBUF.MESS
      1216**DCL      1216--REDEF
OC_MESSBUF.MSGID
      1206**DCL      1207--REDEF
OC_MESSBUF.WSN
      1213**DCL      1214--REDEF
OC_MESSBUF1.FLAGS
      1225**DCL      1226--REDEF
OC_MESSBUF1.LEN
      1231**DCL      1231--REDEF
OC_MESSBUF1.MSGID
      1221**DCL      1222--REDEF
OC_MESSBUF1.WSN
      1228**DCL      1229--REDEF
OC_MSGBUFFER
      1234**DCL      1249--REDEF
OC_MSGBUFFER.FLAGS
      1241**DCL      1242--REDEF
OC_MSGBUFFER.MESS
      1247**DCL      1247--REDEF
OC_MSGBUFFER.MSGID
      1237**DCL      1238--REDEF
PL6.E3A0      #002=OCN$SKEYIN File=OCN$KEYIN.:E05TSI                             WED 07/30/97 04:05 Page:385  
OC_MSGBUFFER.WSN
      1244**DCL      1245--REDEF
OC_MSGBUFFER2.FLAGS
      1256**DCL      1257--REDEF
OC_MSGBUFFER2.MSGID
      1252**DCL      1253--REDEF
OC_MSGBUFFER2.WSN
      1259**DCL      1260--REDEF
OC_PARAM
      1267**DCL      1267--REDEF
OC_QHEAD
      1263**DCL      1406>>ASSIGN
OC_QUEUE.PARMC
      1266**DCL      1266--REDEF
OC_QUEUE.PARMS
      1266**DCL      1406--ASSIGN
