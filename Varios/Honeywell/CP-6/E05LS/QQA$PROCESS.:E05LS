VERSION E05

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:1    
        1        1        /*M* QQA$PROCESS - Process events that the TPA has received */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$PROCESS
        9        9
       10       10             PURPOSE:     Process events that are on the event queue.
       11       11        */
       12       12        /*D* NAME:        QQA$PROCESS
       13       13
       14       14             CALL:        CALL QQA$PROCESS
       15       15
       16       16             INPUT:       TPA event queue
       17       17
       18       18             OUTPUT:      None
       19       19
       20       20             ENVIRONMENT: Parts of the code are inhibited.
       21       21
       22       22             DESCRIPTION: TPA events are stored as a linked list in the
       23       23                          global data pool.  The first queue item is
       24       24                          examined and the proper processing routine
       25       25                          will be called.  Each event has an internal
       26       26                          subroutine the prepare the environment needed
       27       27                          by the processing routines.  All processing
       28       28                          routines are of the form QQA$xxxx.
       29       29
       30       30                          When processing for an event is completed
       31       31                          from an event triggerd by no wait read completion
       32       32                          another no wait read will be issued from
       33       33                          the source who's event was just processed.
       34       34                          The event queue element will then be released
       35       35                          to the global data pool.
       36       36
       37       37                          Timer events are the only thing left to explain
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:2    
       38       38                          about this routine.  A timer runout condition
       39       39                          is needed every 60 seconds.  There is not facility
       40       40                          with the CP6 monitor services to do a M$STIMER
       41       41                          on the basis of time or day so, one must be
       42       42                          simulated.  QQ_GLOBAL.UETIME is the unexpired
       43       43                          time of the M$WAIT interval that we were asleep
       44       44                          for in QQA$TPA.  If this number is 0 then we
       45       45                          know it is time for a timer event.  Otherwise,
       46       46                          each time that we process an event from the queue
       47       47                          we check to see if 60 seconds have elapsed from
       48       48                          whenst we last did a timer event if so, then
       49       49                          we make a new one.  Before we exit this routine
       50       50                          we calculate the number of seconds to sleep
       51       51                          so that we will wake up 60 seconds from the
       52       52                          last timer event.
       53       53        */
       54       54        %EJECT;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:3    
       55       55        QQA$PROCESS:
       56       56                PROC;
       57       57
       58       58        %INCLUDE Q_PAGE_C;
       59       90        %SET LISTEXP = '1'B;
       60       91        %PAGE(ARG="Includes");

               108        /***************************************************************************
               109         *                                                                         *
               110         *                                  Includes                               *
               111         *                                                                         *
               112         ***************************************************************************/

       61      116        %INCLUDE CP_6;
       62      197        %INCLUDE QQ_MACROS_C;
       63      622        %INCLUDE QQ_DATA_R;
       64      868        %INCLUDE OC_SUBS_C;
       65     1599        %INCLUDE QQ_SUPER_C;
       66     1654        %INCLUDE QQ_SUBS_C;
       67     1846        %INCLUDE Q_ERRCODE_C;
       68     1869        %INCLUDE QQ_PERR_C;
       69     2030        %INCLUDE PC_MACRO_C;
       70     2056        %INCLUDE XUD_UTS_M;
       71     2138        %PAGE(ARG="Externally defined routines");

              2155    1   /***************************************************************************
              2156    1    *                                                                         *
              2157    1    *                        Externally defined routines                      *
              2158    1    *                                                                         *
              2159    1    ***************************************************************************/

       72     2163    1   DCL QQA$CGWARN ENTRY;
       73     2164    1   DCL QQA$CMD ENTRY;
       74     2165    1   DCL QQA$STA_CON ENTRY;
       75     2166    1   DCL QQA$STA_DIS ENTRY;
       76     2167    1   DCL QQA$DCB_CON ENTRY;
       77     2168    1   DCL QQA$DCB_DIS ENTRY;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:4    
       78     2169    1   DCL QQA$FPABT ENTRY(1);
       79     2170    1   DCL QQA$FPCHNG ENTRY;
       80     2171    1   DCL QQA$KEYIN ENTRY;
       81     2172    1   DCL QQA$FPRQ ENTRY(1);
       82     2173    1   DCL QQA$SCHEDULE ENTRY;
       83     2174    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       84     2175    1   DCL QQB$DISPLAY_HEADER ENTRY;
       85     2176    1   DCL QQC$RLS_BLK ENTRY(2);
       86     2177    1   DCL QQC$FINDSTA ENTRY(3);
       87     2178    1   DCL QQC$SNDMSG ENTRY(1);
       88     2179    1   DCL QQC$BLDMSG ENTRY(1);
       89     2180    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       90     2181    1   DCL QQC$CONVERT_XID ENTRY(4);
       91     2182    1   DCL QQC$SCREECH ENTRY;
       92     2183    1   DCL QQC$TERMINATE ENTRY;
       93     2184        %XUD$UTS_ENTRIES;
       94     2216        %PAGE(ARG="EQUs");

              2233    1   /***************************************************************************
              2234    1    *                                                                         *
              2235    1    *                                    EQUs                                 *
              2236    1    *                                                                         *
              2237    1    ***************************************************************************/

       95     2241        %EQU_CG;
       96     2289        %XUD_UTS_EQU;
       97     2300        %PAGE(ARG="Symrefs");

              2317    1   /***************************************************************************
              2318    1    *                                                                         *
              2319    1    *                                  Symrefs                                *
              2320    1    *                                                                         *
              2321    1    ***************************************************************************/

       98     2325    1   DCL B$TCB$ PTR SYMREF;
       99     2326        %PAGE(ARG="DCBs");

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:5    
              2343    1   /***************************************************************************
              2344    1    *                                                                         *
              2345    1    *                                    DCBs                                 *
              2346    1    *                                                                         *
              2347    1    ***************************************************************************/

      100     2351    1   DCL M$CG DCB;
      101     2352    1   DCL M$CSCG DCB;
      102     2353        %PAGE(ARG="Based");

              2370    1   /***************************************************************************
              2371    1    *                                                                         *
              2372    1    *                                   Based                                 *
              2373    1    *                                                                         *
              2374    1    ***************************************************************************/

      103     2378    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
      104     2379
      105     2380        %TP$STATION;
      106     2453        %TP$EVENT;
      107     2522        %PC$INSTANCE(STCLASS="BASED(QQ_GLOBAL.PC$INSTANCE$)");
      108     2572        %B$TCB;
      109     2575        %F$DCB;
      110     2632        %B$ALT;
      111     2640        %B$CGAURD(FPTN=B$CGAURD, STCLASS="BASED(QQ_GLOBAL.CMDBUF$)", LAST=", ");
      112     2659        %B$CGAUCI(LVL=2, LAST=", ");
      113     2681        %QQ$LOGON(LVL=2);
      114     2717        %MSGBLK(FPTN=MINI$MSGBLK, STCLASS="BASED(QQ_GLOBAL.CMDBUF$)");
      115     2807        %PAGE(ARG="Constants");

              2824    1   /***************************************************************************
              2825    1    *                                                                         *
              2826    1    *                                 Constants                               *
              2827    1    *                                                                         *
              2828    1    ***************************************************************************/

      116     2832    1   DCL COMMAND_XACTION CHAR(3) CONSTANT INIT ('003');
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:6    
      117     2833    1   DCL STATIONMAX_XACTION CHAR(3) CONSTANT INIT ('004');
      118     2834        %PAGE(ARG="Static");

              2851    1   /***************************************************************************
              2852    1    *                                                                         *
              2853    1    *                                   Static                                *
              2854    1    *                                                                         *
              2855    1    ***************************************************************************/

      119     2859    1   DCL UTS UBIN WORD STATIC;
      120     2860        %PAGE(ARG="Auto");

              2877    1   /***************************************************************************
              2878    1    *                                                                         *
              2879    1    *                                    Auto                                 *
              2880    1    *                                                                         *
              2881    1    ***************************************************************************/

      121     2885    1   DCL NEXT$ PTR;
      122     2886    1   DCL TAIL$ PTR;
      123     2887    1   DCL NEW$ PTR;
      124     2888    1   DCL P$ PTR;
      125     2889
      126     2890    1   DCL EVID UBIN WORD;
      127     2891    1   DCL ARS SBIN WORD;
      128     2892    1   DCL SIZE UBIN WORD;
      129     2893    1   DCL ELAPSED_SECS SBIN WORD;
      130     2894    1   DCL CHAR_STRING_SIZE UBIN WORD;
      131     2895    1   DCL STRT UBIN WORD;
      132     2896
      133     2897    1   DCL FOUND_FLAG BIT(1) ALIGNED;
      134     2898    1   DCL TIMER_EVENT_FLAG BIT(1) ALIGNED;
      135     2899
      136     2900        %MSGBLK;
      137     2990        %VLP_NAME(FPTN=TEXTC_XID, STCLASS=AUTO, LEN=36);
      138     3017        %VLP_NAME(FPTN=TEXTC_TYPE, STCLASS=AUTO, LEN=8);
      139     3044        %VLP_NAME(FPTN=TEXTC_ORIGIN, STCLASS=AUTO, LEN=8);
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:7    
      140     3071    1   DCL TEXT_NUM CHAR(3);
      141     3072        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:8    
              3089    1   /***************************************************************************
              3090    1    *                                                                         *
              3091    1    *                                Error codes                              *
              3092    1    *                                                                         *
              3093    1    ***************************************************************************/

      142     3097        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
      143     3104        %ERRCODE(NAME=CODE_WT, CODE#=%E$WT, FCG#=%FCG_QQ, MID#=%MID_A);
      144     3111        %ERRCODE(NAME=CODE_CGFILL,CODE#=%E$CGFILL,FCG#=%FCG_QQ, MID#=%MID_A);
      145     3118        %ERRCODE(NAME=CODE_DOSTAT,CODE#=%E$DOSTAT,FCG#=%FCG_QQ, MID#=%MID_A);
      146     3125        /*E*       ERROR: QQA-E$WT-C
      147     3126
      148     3127                 MESSAGE: TPA received a weird transaction and placed
      149     3128                          it in hold status.  ID = %U1
      150     3129                          TYPE = %U2 ORIGIN = %U3
      151     3130             DESCRIPTION: TPA only processes certain transactions.  If
      152     3131                          a weird transaction should somehow get into
      153     3132                          TPA it will just hold it.
      154     3133        */
      155     3134        /*E*       ERROR: QQA-E$CGFILL-C
      156     3135
      157     3136                 MESSAGE: The comgroup space is all filled, no write to it is
      158     3137                          possible. Use IXTNSIZE parameter of TPA LET command
      159     3138                          to increase the initial size of comgroup.
      160     3139             DESCRIPTION: When the comgroup space is all filled, writing to
      161     3140                          it again will suspend the TP instance. This error
      162     3141                          message lets the administrator know why the TP
      163     3142                          instance is suspended.
      164     3143        */
      165     3144        /*E*       ERROR: QQA-E$DOSTAT-C
      166     3145                 MESSAGE: ** TPAP Diagnostic Output Message **
      167     3146             DESCRIPTION: These are messages coming from application language
      168     3147                          libraries (such as COBOL) for which the TPA admini-
      169     3148                          strator put a SET command in TRADER:
      170     3149                          SET M$DO CG/instance,ILA,OLA=NO,OMSGTYP='*ERRMSG', etc
      171     3150        */
      172     3151        %PAGE(ARG="FPTs", PAGE=YES);
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:9    

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:10   
              3168    1   /***************************************************************************
              3169    1    *                                                                         *
              3170    1    *                                    FPTs                                 *
              3171    1    *                                                                         *
              3172    1    ***************************************************************************/

      173     3176        %FPT_READ(FPTN=FPT_READ_CG, DCB=M$CG, WAIT=NO, STATION=VLP_STATION, EVENT=1);
      174     3215
      175     3216        %FPT_READ(FPTN=FPT_READ_CSCG, DCB=M$CSCG, WAIT=NO, STATION=VLP_STATION, EVENT=2);
      176     3255
      177     3256        %FPT_WRITE(DCB=M$CG, STATION=VLP_STATION_WRITE, BUF=COMMAND_XACTION);
      178     3287        %FPT_WRITE(FPTN=FPT_WRITE_STATIONMAX, DCB=M$CG, STATION=VLP_STATION_WRITE,
      179     3288                         BUF=STATIONMAX_XACTION);
      180     3319
      181     3320        %FPT_UNLATCH(DCB=M$CG, INPUT=HOLD, OUTPUT=DELETE);
      182     3337
      183     3338        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
      184     3357        %PAGE(ARG="VLPs");

              3374    1   /***************************************************************************
              3375    1    *                                                                         *
              3376    1    *                                    VLPs                                 *
              3377    1    *                                                                         *
              3378    1    ***************************************************************************/

      185     3382        %VLP_STATION(LATCH=YES, DIRONLY=YES);
      186     3409        %VLP_STATION(FPTN=VLP_STATION_WRITE, LATCH=YES);
      187     3436        %PAGE(ARG="QQA$PROCESS", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:11   
              3453    1   /***************************************************************************
              3454    1    *                                                                         *
              3455    1    *                                QQA$PROCESS                              *
              3456    1    *                                                                         *
              3457    1    ***************************************************************************/

      188     3461    1           IF QQ_GLOBAL.UETIME = 0 THEN
      189     3462    2             DO;
      190     3463    2               CALL MAKE_TIMER_EVENT;
      191     3464    2               TIMER_EVENT_FLAG = '1'B;
      192     3465    2             END;
      193     3466    1           ELSE
      194     3467    2             DO;
      195     3468    2               TIMER_EVENT_FLAG = '0'B;
      196     3469    2               GOTO CHK_EVENT_Q;
      197     3470    2             END;
      198     3471
      199     3472
      200     3473    2           DO WHILE('1'B);
      201     3474
      202     3475    2             IF NOT TIMER_EVENT_FLAG THEN
      203     3476    3               DO;
      204     3477    3                 CALL M$TIME(FPT_TIME);
      205     3478
      206     3479    3                 CALL XUD$UTS_DIFF_SEC(ELAPSED_SECS, UTS, QQ_GLOBAL.STIMER_UTS);
      207     3480    3                 IF ELAPSED_SECS >= QQ_GLOBAL.SCHEDINT THEN
      208     3481    4                   DO;
      209     3482    4                     CALL MAKE_TIMER_EVENT;
      210     3483    4                     TIMER_EVENT_FLAG = '1'B;
      211     3484    4                   END;
      212     3485    3                 ELSE
      213     3486    4                   DO;
      214     3487    4                     QQ_GLOBAL.SLEEP_SECS = QQ_GLOBAL.SCHEDINT - ELAPSED_SECS;
      215     3488    4                   END;
      216     3489    3               END;
      217     3490
      218     3491    3             DO INHIBIT;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:12   
      219     3492
      220     3493    3   CHK_EVENT_Q:
      221     3494    3               NEXT$ = QQ_GLOBAL.EVENT$ -> TP$EVENT.FLINK$;
      222     3495    3               IF NEXT$ -> TP$EVENT.FLINK$ = ADDR(NIL) THEN
      223     3496    4                 DO;
      224     3497    4                   IF QQ_GLOBAL.TERMINATE AND
      225     3498    4                       QQ_GLOBAL.STATION_CNT = 0 AND
      226     3499    4                       QQ_GLOBAL.TPU_CNT = 0 AND
      227     3500    4                       QQ_GLOBAL.STRANGER_CNT = 0 THEN
      228     3501    5                     DO;
      229     3502    5                       CALL QQC$TERMINATE;
      230     3503    5                     END;
      231     3504
      232     3505    4                   RETURN;
      233     3506    4                 END;
      234     3507    3             END /* INHIBIT */;
      235     3508
      236     3509    2             QQ_GLOBAL.EVENT_CNT = QQ_GLOBAL.EVENT_CNT + 1;
      237     3510    2             EVID = NEXT$ -> TP$EVENT.EVID;
      238     3511    3             DO CASE(EVID);
      239     3512    3               CASE(1 /* CG_READ */);
      240     3513    3                 IF NEXT$ -> TP$EVENT.ERR ~= '0'B THEN
      241     3514    4                   DO;
      242     3515    4                     QQ_GLOBAL.ERR = NEXT$ -> TP$EVENT.ERR;
      243     3516    4                     CALL QQC$SCREECH;
      244     3517    4                   END;
      245     3518
      246     3519    4                 DO SELECT( NEXT$ -> TP$EVENT.VLP_STATION.MSGTYP#);
      247     3520    4                   SELECT( '*TPCMD');
      248     3521    4                   CALL CMD_EVENT;
      249     3522
      250     3523    4                   SELECT( '*FPRQ');
      251     3524    4                   CALL FP_EVENT;
      252     3525
      253     3526    4                   SELECT( '*IAMRDY');
      254     3527    4                   CALL RDY_EVENT;
      255     3528
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:13   
      256     3529    4                   SELECT( '*AUEV');
      257     3530    4                   CALL ADMIN_EVENT;
      258     3531
      259     3532    4                   SELECT( 'TOTPA');
      260     3533    4                   CALL MSG_EVENT;
      261     3534
      262     3535    4                   SELECT( '*FPABT');
      263     3536    4                   CALL ABT_EVENT;
      264     3537
      265     3538    4                   SELECT( '*ERRMSG');
      266     3539    4                   CALL ERRMSG_EVENT;
      267     3540
      268     3541    4                   SELECT( ELSE);
      269     3542    4                 CALL HOLD_XACTION;
      270     3543
      271     3544    4                 END;
      272     3545    3             VLP_STATION.CTL.LATCH# = '1'B;
      273     3546    3             FPT_READ_CG.BUF_.BOUND = 14 + 640 + 74 - 1;
      274     3547    3             FPT_READ_CG.BUF_.BUF$ = QQ_GLOBAL.CMDBUF$;
      275     3548    3             CALL M$READ(FPT_READ_CG) ALTRET(COM_ERR);
      276     3549
      277     3550    3               CASE(2 /* CSCG_READ */);
      278     3551    3                 IF NEXT$ -> TP$EVENT.ERR ~= '0'B THEN
      279     3552    4                   DO;
      280     3553    4                     QQ_GLOBAL.ERR = NEXT$ -> TP$EVENT.ERR;
      281     3554    4                     CALL QQC$SCREECH;
      282     3555    4                   END;
      283     3556
      284     3557    3                 CALL KEYIN_EVENT;
      285     3558
      286     3559    3                 VLP_STATION.CTL.LATCH# = '0'B;
      287     3560    3                 FPT_READ_CSCG.BUF_.BOUND = CSCG_MAXMC# - 1;
      288     3561    3                 FPT_READ_CSCG.BUF_.BUF$ = QQ_GLOBAL.KEYINBUF$;
      289     3562    3                 CALL M$READ(FPT_READ_CSCG) ALTRET(MON_ERR);
      290     3563
      291     3564    3               CASE(3 /* DEBUGCMD_READ */);
      292     3565    3                 CALL DEBUGCMD_EVENT;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:14   
      293     3566
      294     3567    3               CASE(4 /* TIMER_EVENT */);
      295     3568    3                 CALL TIMER_EVENT;
      296     3569    3             END /* CASE */;
      297     3570
      298     3571    3             DO INHIBIT;
      299     3572    3               QQ_GLOBAL.EVENT$ -> TP$EVENT.FLINK$ = NEXT$ -> TP$EVENT.FLINK$;
      300     3573    3               NEXT$ -> TP$EVENT.FLINK$ -> TP$EVENT.BLINK$ = QQ_GLOBAL.EVENT$;
      301     3574    3               QQ_GLOBAL.EVENT_DEPTH = QQ_GLOBAL.EVENT_DEPTH - 1;
      302     3575    3               CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, NEXT$);
      303     3576    3             END /* INHIBIT */;
      304     3577    2           END /* WHILE */;
      305     3578
      306     3579    1   COM_ERR:
      307     3580    1           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      308     3581    1           MSGBLK.ERRINFO.ERR(0) = CODE_CGFILL;
      309     3582    1           MSGBLK.FLAGS.DEST.MCT = '0'B;   /* Turn off print to CG flag          */
      310     3583    1           MSGBLK.FLAGS.DEST.DODCB = '1'B; /* Turn on print to DO flag           */
      311     3584    1           QQ_GLOBAL.ERROR_CNT = QQ_GLOBAL.ERROR_CNT - 1;
      312     3585    1           CALL QQC$BLDMSG(MSGBLK);
      313     3586    1   MON_ERR:
      314     3587    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      315     3588    1           CALL QQC$SCREECH;
      316     3589                %PAGE(ARG="CMD_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:15   
              3606    1   /***************************************************************************
              3607    1    *                                                                         *
              3608    1    *                                 CMD_EVENT                               *
              3609    1    *                                                                         *
              3610    1    ***************************************************************************/

      317     3614    1   CMD_EVENT:
      318     3615    1           PROC;
      319     3616
      320     3617    2           QQ_CMDBLK.TEXT$ = QQ_GLOBAL.CMDBUF$;
      321     3618
      322     3619    2           CHAR_STRING_SIZE = 1;
      323     3620    2           QQ_CMDBLK.ARS = NEXT$ -> TP$EVENT.ARS - 1;
      324     3621
      325     3622    3           DO WHILE (QQ_CMDBLK.ARS >= 0);
      326     3623    3             IF SUBSTR(QQ_CMDBLK.TEXT$ -> CHAR$STRING, QQ_CMDBLK.ARS, 1) ~= ' ' THEN
      327     3624    3               GOTO XIT_WHILE;
      328     3625    3             ELSE
      329     3626    3               QQ_CMDBLK.ARS = QQ_CMDBLK.ARS - 1;
      330     3627    3           END /* DO WHILE */;
      331     3628
      332     3629    2   XIT_WHILE:
      333     3630    2           QQ_CMDBLK.ARS = QQ_CMDBLK.ARS + 1;
      334     3631
      335     3632    2           QQ_CMDBLK.ORIGIN = 1 /* ORIGIN_STATION */;
      336     3633    2           CALL QQC$FINDSTA(NEXT$ -> TP$EVENT.VLP_STATION.STATION#,S$, FOUND_FLAG);
      337     3634
      338     3635    2           IF FOUND_FLAG THEN
      339     3636    3             DO;
      340     3637    3               QQ_CMDBLK.S$ = S$;
      341     3638    3               QQ_CMDBLK.MAJOR_ERR = TP$STATION.MAJOR_ERR;
      342     3639    3               QQ_CMDBLK.MINOR_ERR = TP$STATION.MINOR_ERR;
      343     3640    3               QQ_CMDBLK.MAJOR_ERR_USED = TP$STATION.FLAGS.MAJOR_ERR_USED;
      344     3641
      345     3642    3               CALL QQA$CMD;
      346     3643
      347     3644    3               IF QQ_CMDBLK.FLAGS.ERR THEN
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:16   
      348     3645    4                 DO;
      349     3646    4                   TP$STATION.MAJOR_ERR = QQ_CMDBLK.MAJOR_ERR;
      350     3647    4                   TP$STATION.MINOR_ERR = QQ_CMDBLK.MINOR_ERR;
      351     3648    4                   TP$STATION.FLAGS.MAJOR_ERR_USED = QQ_CMDBLK.MAJOR_ERR_USED;
      352     3649    4                 END;
      353     3650    3               ELSE
      354     3651    4                 DO;
      355     3652    4                   TP$STATION.MAJOR_ERR = '0'B;
      356     3653    4                   TP$STATION.MINOR_ERR = '0'B;
      357     3654    4                   TP$STATION.FLAGS.MAJOR_ERR_USED = '0'B;
      358     3655    4                 END;
      359     3656
      360     3657    3               IF ~TP$STATION.FLAGS.IS_QT$FORM THEN
      361     3658    4                 DO;
      362     3659    4                   VLP_STATION_WRITE.STATION# = TP$STATION.ID;
      363     3660    4                   CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      364     3661    4                 END;
      365     3662    3             END;
      366     3663
      367     3664    2           RETURN;
      368     3665
      369     3666    2   MON_ERR:
      370     3667    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      371     3668    2           MSGBLK.ERRINFO.ERR(0) = CODE_CGFILL;
      372     3669    2           MSGBLK.FLAGS.DEST.MCT = '0'B;   /* Turn off print to CG flag          */
      373     3670    2           MSGBLK.FLAGS.DEST.DODCB = '1'B; /* Turn on print to DO flag           */
      374     3671    2           QQ_GLOBAL.ERROR_CNT = QQ_GLOBAL.ERROR_CNT - 1;
      375     3672    2           CALL QQC$BLDMSG(MSGBLK);
      376     3673    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      377     3674    2           CALL QQC$SCREECH;
      378     3675    2   END CMD_EVENT;
      379     3676                %PAGE(ARG="ADMIN_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:17   
              3693    2   /***************************************************************************
              3694    2    *                                                                         *
              3695    2    *                                ADMIN_EVENT                              *
              3696    2    *                                                                         *
              3697    2    ***************************************************************************/

      380     3701    1   ADMIN_EVENT:
      381     3702    1           PROC;
      382     3703
      383     3704    3           DO CASE(B$CGAURD.EVENT);
      384     3705    3             CASE(0 /* CG_DOPN# */);
      385     3706    3               CALL QQA$DCB_CON;
      386     3707
      387     3708    3             CASE(1 /* CG_DCLS# */);
      388     3709    3               CALL QQA$DCB_DIS;
      389     3710
      390     3711    3             CASE(2 /* CG_TCON# */);
      391     3712    3               CALL QQA$STA_CON;
      392     3713
      393     3714    3             CASE(3 /* CG_TDSC# */);
      394     3715    3               CALL QQA$STA_DIS;
      395     3716
      396     3717    3             CASE(4 /* CG_TBRK# */);
      397     3718    3               ;                           /*  do nothing                        */
      398     3719
      399     3720    3             CASE(9 /* CG_WARN# */);
      400     3721    3               CALL QQA$CGWARN;
      401     3722
      402     3723    3             CASE(24/* CG_FPEXIT# */,25/* CG_FPABORT# */,26/* CG_FPLDTRC# */);
      403     3724    3               CALL QQA$FPCHNG;
      404     3725
      405     3726    3             CASE(ELSE);
      406     3727    3               CALL HOLD_XACTION;
      407     3728    3           END /* CASE */;
      408     3729    2           RETURN;
      409     3730    2   END ADMIN_EVENT;
      410     3731                %PAGE(ARG="FP_EVENT",PAGE=YES);
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:18   

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:19   
              3748    2   /***************************************************************************
              3749    2    *                                                                         *
              3750    2    *                                  FP_EVENT                               *
              3751    2    *                                                                         *
              3752    2    ***************************************************************************/

      411     3756    1   FP_EVENT:
      412     3757    1           PROC;
      413     3758
      414     3759    2           CALL QQA$FPRQ(NEXT$ -> TP$EVENT);
      415     3760    2           RETURN;
      416     3761    2   END FP_EVENT;
      417     3762                %PAGE(ARG="MSG_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:20   
              3779    2   /***************************************************************************
              3780    2    *                                                                         *
              3781    2    *                                 MSG_EVENT                               *
              3782    2    *                                                                         *
              3783    2    ***************************************************************************/

      418     3787    1   MSG_EVENT:
      419     3788    1           PROC;
      420     3789
      421     3790    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      422     3791    2           MSGBLK.CODECNT = 0;
      423     3792    2           MSGBLK.ID = MINI$MSGBLK.ID;
      424     3793    2           MSGBLK.ARS = MINI$MSGBLK.ARS;
      425     3794    2           MSGBLK.FLAGS = MINI$MSGBLK.FLAGS;
      426     3795    2           MSGBLK.TEXT$ = PINCRC(QQ_GLOBAL.CMDBUF$, 14 /* MINI_MSGBLK_SIZE */);
      427     3796    2           MSGBLK.FLAGS.INHIB_CSCG = '1'B;
      428     3797    2           CALL QQC$SNDMSG(MSGBLK);
      429     3798
      430     3799    2           IF QQ_GLOBAL.LOG THEN
      431     3800    3             DO;
      432     3801    3               MSGBLK.FLAGS.DEST.MCT = '0'B;
      433     3802    3               MSGBLK.FLAGS.DEST.CSCG = '1'B;
      434     3803    3               MSGBLK.TEXT$ = PINCRC(MSGBLK.TEXT$, MSGBLK.ARS);
      435     3804    3               ARS = DCBADDR(DCBNUM(M$CG)) -> F$DCB.ARS#;
      436     3805    3               MSGBLK.ARS = ARS - MSGBLK.ARS - 14;
      437     3806    3               CALL QQC$SNDMSG(MSGBLK);
      438     3807    3             END;
      439     3808
      440     3809    2           RETURN;
      441     3810    2   END MSG_EVENT;
      442     3811                %PAGE(ARG="KEYIN_EVENT",PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:21   
              3828    2   /***************************************************************************
              3829    2    *                                                                         *
              3830    2    *                                KEYIN_EVENT                              *
              3831    2    *                                                                         *
              3832    2    ***************************************************************************/

      443     3836    1   KEYIN_EVENT:
      444     3837    1           PROC;
      445     3838
      446     3839    2           CALL QQA$KEYIN;
      447     3840
      448     3841    2           RETURN;
      449     3842    2   END KEYIN_EVENT;
      450     3843                %PAGE(ARG="DEBUGCMD_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:22   
              3860    2   /***************************************************************************
              3861    2    *                                                                         *
              3862    2    *                               DEBUGCMD_EVENT                            *
              3863    2    *                                                                         *
              3864    2    ***************************************************************************/

      451     3868    1   DEBUGCMD_EVENT:
      452     3869    1           PROC;
      453     3870
      454     3871    2           QQ_CMDBLK.ORIGIN = 2 /* ORIGIN_INIT */;
      455     3872    2           QQ_CMDBLK.S$ = ADDR(QQ_TP$STATION_INIT);
      456     3873    2           QQ_CMDBLK.TEXT$ = QQ_GLOBAL.DEBUGCMD$;
      457     3874    2           QQ_CMDBLK.ARS = NEXT$ -> TP$EVENT.ARS;
      458     3875    2           CALL QQA$CMD;
      459     3876    2           RETURN;
      460     3877    2   END DEBUGCMD_EVENT;
      461     3878                %PAGE(ARG="MAKE_TIMER_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:23   
              3895    2   /***************************************************************************
              3896    2    *                                                                         *
              3897    2    *                              MAKE_TIMER_EVENT                           *
              3898    2    *                                                                         *
              3899    2    ***************************************************************************/

      462     3903    1   MAKE_TIMER_EVENT:
      463     3904    1           PROC;
      464     3905
      465     3906    3           DO INHIBIT;
      466     3907    3             CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, SIZEW(TP$EVENT), NEW$) ALTRET(NO_MEM);
      467     3908    3             TAIL$ = QQ_GLOBAL.EVENT$ -> TP$EVENT.BLINK$;
      468     3909    3             NEW$ -> TP$EVENT.FLINK$ = TAIL$;
      469     3910    3             NEW$ -> TP$EVENT.BLINK$ = TAIL$ -> TP$EVENT.BLINK$;
      470     3911    3             TAIL$ -> TP$EVENT.BLINK$ -> TP$EVENT.FLINK$ = NEW$;
      471     3912    3             TAIL$ -> TP$EVENT.BLINK$ = NEW$;
      472     3913    3             QQ_GLOBAL.EVENT_DEPTH = QQ_GLOBAL.EVENT_DEPTH + 1;
      473     3914    3             NEW$ -> TP$EVENT.EVID = 4 /* TIMER_EVENT */;
      474     3915    3           END /* INHIBIT */;
      475     3916
      476     3917    2           RETURN;
      477     3918
      478     3919    2   NO_MEM:
      479     3920    2           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;
      480     3921    2           CALL QQC$SCREECH;
      481     3922    2   END MAKE_TIMER_EVENT;
      482     3923                %PAGE(ARG="TIMER_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:24   
              3940    2   /***************************************************************************
              3941    2    *                                                                         *
              3942    2    *                                TIMER_EVENT                              *
              3943    2    *                                                                         *
              3944    2    ***************************************************************************/

      483     3948    1   TIMER_EVENT:
      484     3949    1           PROC;
      485     3950
      486     3951    2           CALL QQA$SCHEDULE;
      487     3952
      488     3953    2           TIMER_EVENT_FLAG = '0'B;
      489     3954
      490     3955    2           RETURN;
      491     3956
      492     3957    2   END TIMER_EVENT;
      493     3958                %PAGE(ARG="HOLD_XACTION", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:25   
              3975    2   /***************************************************************************
              3976    2    *                                                                         *
              3977    2    *                                HOLD_XACTION                             *
              3978    2    *                                                                         *
              3979    2    ***************************************************************************/

      494     3983    1   HOLD_XACTION:
      495     3984    1           PROC;
      496     3985
      497     3986    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      498     3987    2           MSGBLK.ERRINFO.ERR(0) = CODE_WT;
      499     3988    2           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_XID);
      500     3989    2           MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_TYPE);
      501     3990    2           MSGBLK.ERRINFO.FIELD3(0) = VECTOR(TEXTC_ORIGIN);
      502     3991
      503     3992    2           CALL QQC$CONVERT_XID(SIZE, ADDR(TEXTC_XID.NAME#),
      504     3993    2               NEXT$ -> TP$EVENT.VLP_STATION.MSGID#,
      505     3994    2               NEXT$ -> TP$EVENT.VLP_STATION.MSGIDXT);
      506     3995    2           TEXTC_XID.L# = SIZE;
      507     3996
      508     3997    2           TEXTC_TYPE.L# = 8;
      509     3998    2           TEXTC_TYPE.NAME# = NEXT$ -> TP$EVENT.VLP_STATION.MSGTYP#;
      510     3999
      511     4000    2           TEXTC_ORIGIN.L# = 8;
      512     4001    2           TEXTC_ORIGIN.NAME# = NEXT$ -> TP$EVENT.VLP_STATION.STATION#;
      513     4002
      514     4003    2           IF TEXTC_TYPE.NAME# = '*AUEV' THEN
      515     4004    3             DO;
      516     4005
      517     4006                                                /*  Get CG AU Event Code              */
      518     4007    3               CALL BINCHAR(TEXT_NUM, B$CGAURD.EVENT);
      519     4008    3               CALL CONCAT(TEXTC_XID.NAME#, SUBSTR(TEXTC_XID.NAME#,0,
      520     4009    3                   TEXTC_XID.L#), '  (', TEXT_NUM, ')');
      521     4010    3               TEXTC_XID.L# = TEXTC_XID.L# + 7;
      522     4011
      523     4012    3             END;
      524     4013
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:26   
      525     4014    2           CALL QQC$BLDMSG(MSGBLK);
      526     4015
      527     4016    2           CALL M$UNLATCH(FPT_UNLATCH) ALTRET(MON_ERR);
      528     4017
      529     4018    2           RETURN;
      530     4019
      531     4020    2   MON_ERR:
      532     4021    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      533     4022    2           CALL QQC$SCREECH;
      534     4023
      535     4024    2   END HOLD_XACTION;
      536     4025                %PAGE(ARG="RDY_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:27   
              4042    2   /***************************************************************************
              4043    2    *                                                                         *
              4044    2    *                                 RDY_EVENT                               *
              4045    2    *                                                                         *
              4046    2    ***************************************************************************/

      537     4050    1   RDY_EVENT:
      538     4051    1           PROC;
      539     4052
      540     4053    2           CALL QQC$FINDSTA(NEXT$ -> TP$EVENT.VLP_STATION.STATION#,S$, FOUND_FLAG);
      541     4054
      542     4055    2           IF NOT FOUND_FLAG THEN          /* stationmax exceeded                */
      543     4056    3             DO;
      544     4057
      545     4058    3               VLP_STATION_WRITE.STATION# =
      546     4059    3                   NEXT$ -> TP$EVENT.VLP_STATION.STATION#;
      547     4060    3               CALL M$WRITE(FPT_WRITE_STATIONMAX) ALTRET(MON_ERR);
      548     4061    3               RETURN;
      549     4062
      550     4063    3             END;
      551     4064
      552     4065                       /*  Put node, line, port, controller into TP station context   */
      553     4066    2           ARS = NEXT$ -> TP$EVENT.ARS;
      554     4067    2           CHAR_STRING_SIZE = 4;
      555     4068    2           STRT = 0;
      556     4069    2           P$ = QQ_GLOBAL.CMDBUF$;
      557     4070
      558     4071    2           IF ARS <= 16 THEN
      559     4072    3             DO;
      560     4073
      561     4074    4               DO WHILE (ARS > 0);
      562     4075
      563     4076    4                 IF P$ -> CHAR$STRING ~= ' ' THEN
      564     4077    5                   DO;
      565     4078
      566     4079    5                     CALL RZEROS (P$ -> CHAR$STRING, 4, SIZE);
      567     4080    5                     SUBSTR (TP$STATION.LINE_INFO, STRT, SIZE) = P$ -> CHAR$STRING;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:28   
      568     4081    5                   END;
      569     4082
      570     4083    4                 STRT = STRT + SIZE;
      571     4084    4                 P$ = PINCRC (P$, 4);
      572     4085    4                 ARS = ARS - 4;
      573     4086    4                 IF ARS > 0 THEN
      574     4087    5                   DO;
      575     4088    5                     SUBSTR (TP$STATION.LINE_INFO, STRT, 1) = '-';
      576     4089    5                     STRT = STRT + 1;
      577     4090    5                   END;
      578     4091    4               END;
      579     4092
      580     4093    3             END;
      581     4094
      582     4095    2           IF TP$STATION.FPLDTRC$ ~= ADDR(NIL) THEN
      583     4096    3             DO;
      584     4097    3               CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$,TP$STATION.FPLDTRC$);
      585     4098    3               TP$STATION.FPLDTRC$ = ADDR(NIL);
      586     4099    3             END;
      587     4100    2           IF PC$INSTANCE.FLAGS.HEADER THEN
      588     4101    3             DO;
      589     4102    3               QQ_CMDBLK.MAJOR_ERR = '0'B;
      590     4103    3               QQ_CMDBLK.MINOR_ERR = '0'B;
      591     4104    3               QQ_CMDBLK.MAJOR_ERR_USED = '0'B;
      592     4105    3               QQ_CMDBLK.TEXT$ = ADDR(NIL);
      593     4106    3               QQ_CMDBLK.S$ = S$;
      594     4107    3               QQ_CMDBLK.ORIGIN = 1 /* ORIGIN_STATION */;
      595     4108    3               QQ_CMDBLK.ARS = 0;
      596     4109    3               CALL QQB$DISPLAY_HEADER;
      597     4110
      598     4111    3             END;
      599     4112    2           IF TP$STATION.FIRST_CMD$ ~= ADDR(NIL) THEN
      600     4113    3             DO;
      601     4114    3               QQ_CMDBLK.MAJOR_ERR = '0'B;
      602     4115    3               QQ_CMDBLK.MINOR_ERR = '0'B;
      603     4116    3               QQ_CMDBLK.MAJOR_ERR_USED = '0'B;
      604     4117    3               QQ_CMDBLK.TEXT$ = TP$STATION.FIRST_CMD$;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:29   
      605     4118    3               QQ_CMDBLK.S$ = S$;
      606     4119    3               QQ_CMDBLK.ORIGIN = 1 /* ORIGIN_STATION */;
      607     4120    3               QQ_CMDBLK.ARS = 80;
      608     4121    3               CALL QQA$CMD;
      609     4122
      610     4123    3               CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, TP$STATION.FIRST_CMD$);
      611     4124    3               TP$STATION.FIRST_CMD$ = ADDR(NIL);
      612     4125    3             END;
      613     4126
      614     4127    2           IF ~TP$STATION.FLAGS.IS_QT$FORM THEN
      615     4128    3             DO;
      616     4129    3               VLP_STATION_WRITE.STATION# = TP$STATION.ID;
      617     4130    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);
      618     4131    3             END;
      619     4132
      620     4133    2           RETURN;
      621     4134
      622     4135    2   MON_ERR:
      623     4136    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      624     4137    2           CALL QQC$SCREECH;
      625     4138
      626     4139    2   END RDY_EVENT;
      627     4140                %PAGE(ARG="ABT_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:30   
              4157    2   /***************************************************************************
              4158    2    *                                                                         *
              4159    2    *                                 ABT_EVENT                               *
              4160    2    *                                                                         *
              4161    2    ***************************************************************************/

      628     4165    1   ABT_EVENT:
      629     4166    1           PROC;
      630     4167
      631     4168    2           CALL QQA$FPABT(NEXT$ -> TP$EVENT);
      632     4169
      633     4170    2           RETURN;
      634     4171
      635     4172    2   END ABT_EVENT;
      636     4173                %PAGE(ARG="ERRMSG_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:31   
              4190    2   /***************************************************************************
              4191    2    *                                                                         *
              4192    2    *                                ERRMSG_EVENT                             *
              4193    2    *                                                                         *
              4194    2    ***************************************************************************/

      637     4198    1   ERRMSG_EVENT:
      638     4199    1           PROC;
      639     4200
      640     4201    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      641     4202    2           MSGBLK.ERRINFO.ERR(0) = CODE_DOSTAT;
      642     4203    2           CALL QQC$BLDMSG(MSGBLK);
      643     4204
      644     4205    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      645     4206    2           MSGBLK.CODECNT = 0;
      646     4207    2           MSGBLK.ARS = DCBADDR(DCBNUM(M$CG)) -> F$DCB.ARS# - 1;
      647     4208    2           MSGBLK.TEXT$ = PINCRC(QQ_GLOBAL.CMDBUF$, 1);
      648     4209    2           CALL QQC$SNDMSG(MSGBLK);
      649     4210
      650     4211    2           RETURN;
      651     4212
      652     4213    2   END ERRMSG_EVENT;
      653     4214                %PAGE(ARG="RZEROS", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:32   
              4231    2   /***************************************************************************
              4232    2    *                                                                         *
              4233    2    *                                   RZEROS                                *
              4234    2    *                                                                         *
              4235    2    ***************************************************************************/

      654     4239    1   RZEROS: PROC(BUFF,BUFFSZE,NCHARS);
      655     4240    2   DCL BUFF CHAR(BUFFSZE);                 /*Buffer*/
      656     4241    2   DCL BUFFA(0:3) REDEF BUFF CHAR(1);
      657     4242    2   DCL I SBIN WORD;                        /*Index*/
      658     4243    2   DCL BUFFSZE SBIN WORD;                  /*Buffer size*/
      659     4244    2   DCL NCHARS SBIN WORD;                   /*Number of CHARS.*/
      660     4245    2           I=0;
      661     4246    3           DO WHILE (BUFFA(I)='0' AND I<BUFFSZE);
      662     4247    3             I=I+1;
      663     4248    3           END;
      664     4249    2           BUFF=SUBSTR(BUFF,I,BUFFSZE-I);
      665     4250        /*         **** Return only single zero if all zeros in buffer*/
      666     4251    2           IF I=BUFFSZE
      667     4252    2           THEN
      668     4253    2             BUFF='0';
      669     4254    2           IF ADDR(NCHARS) ~= ADDR(NIL)
      670     4255    2           THEN
      671     4256    2             CALL INDEX(NCHARS,' ',BUFF);  /*Return # chars*/
      672     4257    2           RETURN;
      673     4258    2   END RZEROS;
      674     4259    1   END QQA$PROCESS;

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:33   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_SUPER_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$PROCESS.

   Procedure QQA$PROCESS requires 911 words for executable code.
   Procedure QQA$PROCESS requires 68 words of local(AUTO) storage.

    No errors detected in file QQA$PROCESS.:E05TSI    .

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:34   

 Object Unit name= QQA$PROCESS                                File name= QQA$PROCESS.:E05TOU
 UTS= JUL 30 '97 05:24:59.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2   DCB   even  none     0      0  M$CSCG
    3  RoData even  UTS     21     25  QQA$PROCESS
    4   Data  even  none    92    134  QQA$PROCESS
    5   Proc  even  none   911   1617  QQA$PROCESS
    6  RoData even  none    21     25  QQA$PROCESS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        0  QQA$PROCESS
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:35   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 XUD$UTS_DIFF_SEC
         yes           Std       0 QQC$TERMINATE
         yes           Std       0 QQC$SCREECH
         yes           Std       1 QQC$BLDMSG
         yes           Std       2 QQC$RLS_BLK
         yes           Std       1 QQC$BLDMSG_ERRBLK
         yes           Std       3 QQC$FINDSTA
         yes           Std       0 QQA$CMD
         yes           Std       0 QQA$DCB_CON
         yes           Std       0 QQA$DCB_DIS
         yes           Std       0 QQA$STA_DIS
         yes           Std       0 QQA$FPCHNG
         yes           Std       0 QQA$CGWARN
         yes           Std       0 QQA$STA_CON
         yes           Std       1 QQA$FPRQ
         yes           Std       1 QQC$SNDMSG
         yes           Std       0 QQA$KEYIN
 yes     yes           Std       3 QQC$GET_BLK
         yes           Std       0 QQA$SCHEDULE
         yes           Std       4 QQC$CONVERT_XID
         yes           Std       0 QQB$DISPLAY_HEADER
         yes           Std       1 QQA$FPABT
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:36   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             QQ_GLOBAL
     QQ_TP$STATION_INIT                    B$TCB$                                M$CG
     M$CSCG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:37   


        1        1        /*M* QQA$PROCESS - Process events that the TPA has received */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$PROCESS
        9        9
       10       10             PURPOSE:     Process events that are on the event queue.
       11       11        */
       12       12        /*D* NAME:        QQA$PROCESS
       13       13
       14       14             CALL:        CALL QQA$PROCESS
       15       15
       16       16             INPUT:       TPA event queue
       17       17
       18       18             OUTPUT:      None
       19       19
       20       20             ENVIRONMENT: Parts of the code are inhibited.
       21       21
       22       22             DESCRIPTION: TPA events are stored as a linked list in the
       23       23                          global data pool.  The first queue item is
       24       24                          examined and the proper processing routine
       25       25                          will be called.  Each event has an internal
       26       26                          subroutine the prepare the environment needed
       27       27                          by the processing routines.  All processing
       28       28                          routines are of the form QQA$xxxx.
       29       29
       30       30                          When processing for an event is completed
       31       31                          from an event triggerd by no wait read completion
       32       32                          another no wait read will be issued from
       33       33                          the source who's event was just processed.
       34       34                          The event queue element will then be released
       35       35                          to the global data pool.
       36       36
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:38   
       37       37                          Timer events are the only thing left to explain
       38       38                          about this routine.  A timer runout condition
       39       39                          is needed every 60 seconds.  There is not facility
       40       40                          with the CP6 monitor services to do a M$STIMER
       41       41                          on the basis of time or day so, one must be
       42       42                          simulated.  QQ_GLOBAL.UETIME is the unexpired
       43       43                          time of the M$WAIT interval that we were asleep
       44       44                          for in QQA$TPA.  If this number is 0 then we
       45       45                          know it is time for a timer event.  Otherwise,
       46       46                          each time that we process an event from the queue
       47       47                          we check to see if 60 seconds have elapsed from
       48       48                          whenst we last did a timer event if so, then
       49       49                          we make a new one.  Before we exit this routine
       50       50                          we calculate the number of seconds to sleep
       51       51                          so that we will wake up 60 seconds from the
       52       52                          last timer event.
       53       53        */
       54       54        %EJECT;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:39   
       55       55        QQA$PROCESS:
       56       56                PROC;

     56  5 000000   000000 700200 xent  QQA$PROCESS  TSX0  ! X66_AUTO_0
         5 000001   000104 000000                    ZERO    68,0

       57       57
       58       58        %INCLUDE Q_PAGE_C;
       59       90        %SET LISTEXP = '1'B;
       60       91        %PAGE(ARG="Includes");

               108        /***************************************************************************
               109         *                                                                         *
               110         *                                  Includes                               *
               111         *                                                                         *
               112         ***************************************************************************/

       61      116        %INCLUDE CP_6;
       62      197        %INCLUDE QQ_MACROS_C;
       63      622        %INCLUDE QQ_DATA_R;
       64      868        %INCLUDE OC_SUBS_C;
       65     1599        %INCLUDE QQ_SUPER_C;
       66     1654        %INCLUDE QQ_SUBS_C;
       67     1846        %INCLUDE Q_ERRCODE_C;
       68     1869        %INCLUDE QQ_PERR_C;
       69     2030        %INCLUDE PC_MACRO_C;
       70     2056        %INCLUDE XUD_UTS_M;
       71     2138        %PAGE(ARG="Externally defined routines");

              2155    1   /***************************************************************************
              2156    1    *                                                                         *
              2157    1    *                        Externally defined routines                      *
              2158    1    *                                                                         *
              2159    1    ***************************************************************************/

       72     2163    1   DCL QQA$CGWARN ENTRY;
       73     2164    1   DCL QQA$CMD ENTRY;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:40   
       74     2165    1   DCL QQA$STA_CON ENTRY;
       75     2166    1   DCL QQA$STA_DIS ENTRY;
       76     2167    1   DCL QQA$DCB_CON ENTRY;
       77     2168    1   DCL QQA$DCB_DIS ENTRY;
       78     2169    1   DCL QQA$FPABT ENTRY(1);
       79     2170    1   DCL QQA$FPCHNG ENTRY;
       80     2171    1   DCL QQA$KEYIN ENTRY;
       81     2172    1   DCL QQA$FPRQ ENTRY(1);
       82     2173    1   DCL QQA$SCHEDULE ENTRY;
       83     2174    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       84     2175    1   DCL QQB$DISPLAY_HEADER ENTRY;
       85     2176    1   DCL QQC$RLS_BLK ENTRY(2);
       86     2177    1   DCL QQC$FINDSTA ENTRY(3);
       87     2178    1   DCL QQC$SNDMSG ENTRY(1);
       88     2179    1   DCL QQC$BLDMSG ENTRY(1);
       89     2180    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       90     2181    1   DCL QQC$CONVERT_XID ENTRY(4);
       91     2182    1   DCL QQC$SCREECH ENTRY;
       92     2183    1   DCL QQC$TERMINATE ENTRY;
       93     2184        %XUD$UTS_ENTRIES;
       94     2216        %PAGE(ARG="EQUs");

              2233    1   /***************************************************************************
              2234    1    *                                                                         *
              2235    1    *                                    EQUs                                 *
              2236    1    *                                                                         *
              2237    1    ***************************************************************************/

       95     2241        %EQU_CG;
       96     2289        %XUD_UTS_EQU;
       97     2300        %PAGE(ARG="Symrefs");

              2317    1   /***************************************************************************
              2318    1    *                                                                         *
              2319    1    *                                  Symrefs                                *
              2320    1    *                                                                         *
              2321    1    ***************************************************************************/
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:41   

       98     2325    1   DCL B$TCB$ PTR SYMREF;
       99     2326        %PAGE(ARG="DCBs");

              2343    1   /***************************************************************************
              2344    1    *                                                                         *
              2345    1    *                                    DCBs                                 *
              2346    1    *                                                                         *
              2347    1    ***************************************************************************/

      100     2351    1   DCL M$CG DCB;
      101     2352    1   DCL M$CSCG DCB;
      102     2353        %PAGE(ARG="Based");

              2370    1   /***************************************************************************
              2371    1    *                                                                         *
              2372    1    *                                   Based                                 *
              2373    1    *                                                                         *
              2374    1    ***************************************************************************/

      103     2378    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
      104     2379
      105     2380        %TP$STATION;
      106     2453        %TP$EVENT;
      107     2522        %PC$INSTANCE(STCLASS="BASED(QQ_GLOBAL.PC$INSTANCE$)");
      108     2572        %B$TCB;
      109     2575        %F$DCB;
      110     2632        %B$ALT;
      111     2640        %B$CGAURD(FPTN=B$CGAURD, STCLASS="BASED(QQ_GLOBAL.CMDBUF$)", LAST=", ");
      112     2659        %B$CGAUCI(LVL=2, LAST=", ");
      113     2681        %QQ$LOGON(LVL=2);
      114     2717        %MSGBLK(FPTN=MINI$MSGBLK, STCLASS="BASED(QQ_GLOBAL.CMDBUF$)");
      115     2807        %PAGE(ARG="Constants");

              2824    1   /***************************************************************************
              2825    1    *                                                                         *
              2826    1    *                                 Constants                               *
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:42   
              2827    1    *                                                                         *
              2828    1    ***************************************************************************/

      116     2832    1   DCL COMMAND_XACTION CHAR(3) CONSTANT INIT ('003');
      117     2833    1   DCL STATIONMAX_XACTION CHAR(3) CONSTANT INIT ('004');
      118     2834        %PAGE(ARG="Static");

              2851    1   /***************************************************************************
              2852    1    *                                                                         *
              2853    1    *                                   Static                                *
              2854    1    *                                                                         *
              2855    1    ***************************************************************************/

      119     2859    1   DCL UTS UBIN WORD STATIC;
      120     2860        %PAGE(ARG="Auto");

              2877    1   /***************************************************************************
              2878    1    *                                                                         *
              2879    1    *                                    Auto                                 *
              2880    1    *                                                                         *
              2881    1    ***************************************************************************/

      121     2885    1   DCL NEXT$ PTR;
      122     2886    1   DCL TAIL$ PTR;
      123     2887    1   DCL NEW$ PTR;
      124     2888    1   DCL P$ PTR;
      125     2889
      126     2890    1   DCL EVID UBIN WORD;
      127     2891    1   DCL ARS SBIN WORD;
      128     2892    1   DCL SIZE UBIN WORD;
      129     2893    1   DCL ELAPSED_SECS SBIN WORD;
      130     2894    1   DCL CHAR_STRING_SIZE UBIN WORD;
      131     2895    1   DCL STRT UBIN WORD;
      132     2896
      133     2897    1   DCL FOUND_FLAG BIT(1) ALIGNED;
      134     2898    1   DCL TIMER_EVENT_FLAG BIT(1) ALIGNED;
      135     2899
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:43   
      136     2900        %MSGBLK;
      137     2990        %VLP_NAME(FPTN=TEXTC_XID, STCLASS=AUTO, LEN=36);
      138     3017        %VLP_NAME(FPTN=TEXTC_TYPE, STCLASS=AUTO, LEN=8);
      139     3044        %VLP_NAME(FPTN=TEXTC_ORIGIN, STCLASS=AUTO, LEN=8);
      140     3071    1   DCL TEXT_NUM CHAR(3);
      141     3072        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:44   
              3089    1   /***************************************************************************
              3090    1    *                                                                         *
              3091    1    *                                Error codes                              *
              3092    1    *                                                                         *
              3093    1    ***************************************************************************/

      142     3097        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
      143     3104        %ERRCODE(NAME=CODE_WT, CODE#=%E$WT, FCG#=%FCG_QQ, MID#=%MID_A);
      144     3111        %ERRCODE(NAME=CODE_CGFILL,CODE#=%E$CGFILL,FCG#=%FCG_QQ, MID#=%MID_A);
      145     3118        %ERRCODE(NAME=CODE_DOSTAT,CODE#=%E$DOSTAT,FCG#=%FCG_QQ, MID#=%MID_A);
      146     3125        /*E*       ERROR: QQA-E$WT-C
      147     3126
      148     3127                 MESSAGE: TPA received a weird transaction and placed
      149     3128                          it in hold status.  ID = %U1
      150     3129                          TYPE = %U2 ORIGIN = %U3
      151     3130             DESCRIPTION: TPA only processes certain transactions.  If
      152     3131                          a weird transaction should somehow get into
      153     3132                          TPA it will just hold it.
      154     3133        */
      155     3134        /*E*       ERROR: QQA-E$CGFILL-C
      156     3135
      157     3136                 MESSAGE: The comgroup space is all filled, no write to it is
      158     3137                          possible. Use IXTNSIZE parameter of TPA LET command
      159     3138                          to increase the initial size of comgroup.
      160     3139             DESCRIPTION: When the comgroup space is all filled, writing to
      161     3140                          it again will suspend the TP instance. This error
      162     3141                          message lets the administrator know why the TP
      163     3142                          instance is suspended.
      164     3143        */
      165     3144        /*E*       ERROR: QQA-E$DOSTAT-C
      166     3145                 MESSAGE: ** TPAP Diagnostic Output Message **
      167     3146             DESCRIPTION: These are messages coming from application language
      168     3147                          libraries (such as COBOL) for which the TPA admini-
      169     3148                          strator put a SET command in TRADER:
      170     3149                          SET M$DO CG/instance,ILA,OLA=NO,OMSGTYP='*ERRMSG', etc
      171     3150        */
      172     3151        %PAGE(ARG="FPTs", PAGE=YES);
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:45   

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:46   
              3168    1   /***************************************************************************
              3169    1    *                                                                         *
              3170    1    *                                    FPTs                                 *
              3171    1    *                                                                         *
              3172    1    ***************************************************************************/

      173     3176        %FPT_READ(FPTN=FPT_READ_CG, DCB=M$CG, WAIT=NO, STATION=VLP_STATION, EVENT=1);
      174     3215
      175     3216        %FPT_READ(FPTN=FPT_READ_CSCG, DCB=M$CSCG, WAIT=NO, STATION=VLP_STATION, EVENT=2);
      176     3255
      177     3256        %FPT_WRITE(DCB=M$CG, STATION=VLP_STATION_WRITE, BUF=COMMAND_XACTION);
      178     3287        %FPT_WRITE(FPTN=FPT_WRITE_STATIONMAX, DCB=M$CG, STATION=VLP_STATION_WRITE,
      179     3288                         BUF=STATIONMAX_XACTION);
      180     3319
      181     3320        %FPT_UNLATCH(DCB=M$CG, INPUT=HOLD, OUTPUT=DELETE);
      182     3337
      183     3338        %FPT_TIME(SOURCE=CLOCK, TSTAMP=UTS);
      184     3357        %PAGE(ARG="VLPs");

              3374    1   /***************************************************************************
              3375    1    *                                                                         *
              3376    1    *                                    VLPs                                 *
              3377    1    *                                                                         *
              3378    1    ***************************************************************************/

      185     3382        %VLP_STATION(LATCH=YES, DIRONLY=YES);
      186     3409        %VLP_STATION(FPTN=VLP_STATION_WRITE, LATCH=YES);
      187     3436        %PAGE(ARG="QQA$PROCESS", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:47   
              3453    1   /***************************************************************************
              3454    1    *                                                                         *
              3455    1    *                                QQA$PROCESS                              *
              3456    1    *                                                                         *
              3457    1    ***************************************************************************/

      188     3461    1           IF QQ_GLOBAL.UETIME = 0 THEN

   3461  5 000002   000067 235000 xsym               LDA     QQ_GLOBAL+55
         5 000003   000011 601000 5                  TNZ     s:3468

      189     3462    2             DO;

      190     3463    2               CALL MAKE_TIMER_EVENT;

   3463  5 000004   000753 701000 5                  TSX1    MAKE_TIMER_EVENT
         5 000005   000000 011000                    NOP     0

      191     3464    2               TIMER_EVENT_FLAG = '1'B;

   3464  5 000006   400000 236003                    LDQ     -131072,DU
         5 000007   200017 756100                    STQ     TIMER_EVENT_FLAG,,AUTO

      192     3465    2             END;

   3465  5 000010   000013 710000 5                  TRA     s:3475

      193     3466    1           ELSE
      194     3467    2             DO;

      195     3468    2               TIMER_EVENT_FLAG = '0'B;

   3468  5 000011   200017 450100                    STZ     TIMER_EVENT_FLAG,,AUTO

      196     3469    2               GOTO CHK_EVENT_Q;

   3469  5 000012   000046 710000 5                  TRA     CHK_EVENT_Q
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:48   

      197     3470    2             END;
      198     3471
      199     3472
      200     3473    2           DO WHILE('1'B);

      201     3474
      202     3475    2             IF NOT TIMER_EVENT_FLAG THEN

   3475  5 000013   200017 234100                    SZN     TIMER_EVENT_FLAG,,AUTO
         5 000014   000046 604000 5                  TMI     CHK_EVENT_Q

      203     3476    3               DO;

      204     3477    3                 CALL M$TIME(FPT_TIME);

   3477  5 000015   000100 630400 4                  EPPR0   FPT_TIME
         5 000016   020004 713400                    CLIMB   8196
         5 000017   402000 401760                    pmme    nvectors=5

      205     3478
      206     3479    3                 CALL XUD$UTS_DIFF_SEC(ELAPSED_SECS, UTS, QQ_GLOBAL.STIMER_UTS);

   3479  5 000020   000000 236000 6                  LDQ     0
         5 000021   200100 756100                    STQ     I+4,,AUTO
         5 000022   000001 236000 6                  LDQ     1
         5 000023   200077 756100                    STQ     I+3,,AUTO
         5 000024   200013 630500                    EPPR0   ELAPSED_SECS,,AUTO
         5 000025   200076 450500                    STP0    I+2,,AUTO
         5 000026   200076 630500                    EPPR0   I+2,,AUTO
         5 000027   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000030   000000 701000 xent               TSX1    XUD$UTS_DIFF_SEC
         5 000031   000000 011000                    NOP     0

      207     3480    3                 IF ELAPSED_SECS >= QQ_GLOBAL.SCHEDINT THEN

   3480  5 000032   200013 236100                    LDQ     ELAPSED_SECS,,AUTO
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:49   
         5 000033   000043 604000 5                  TMI     s:3487
         5 000034   000031 116000 xsym               CMPQ    QQ_GLOBAL+25
         5 000035   000043 602000 5                  TNC     s:3487

      208     3481    4                   DO;

      209     3482    4                     CALL MAKE_TIMER_EVENT;

   3482  5 000036   000753 701000 5                  TSX1    MAKE_TIMER_EVENT
         5 000037   000000 011000                    NOP     0

      210     3483    4                     TIMER_EVENT_FLAG = '1'B;

   3483  5 000040   400000 236003                    LDQ     -131072,DU
         5 000041   200017 756100                    STQ     TIMER_EVENT_FLAG,,AUTO

      211     3484    4                   END;

   3484  5 000042   000046 710000 5                  TRA     CHK_EVENT_Q

      212     3485    3                 ELSE
      213     3486    4                   DO;

      214     3487    4                     QQ_GLOBAL.SLEEP_SECS = QQ_GLOBAL.SCHEDINT - ELAPSED_SECS;

   3487  5 000043   000031 236000 xsym               LDQ     QQ_GLOBAL+25
         5 000044   200013 136100                    SBLQ    ELAPSED_SECS,,AUTO
         5 000045   000047 756000 xsym               STQ     QQ_GLOBAL+39

      215     3488    4                   END;

      216     3489    3               END;

      217     3490
      218     3491    3             DO INHIBIT;

      219     3492
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:50   
      220     3493    3   CHK_EVENT_Q:
      221     3494    3               NEXT$ = QQ_GLOBAL.EVENT$ -> TP$EVENT.FLINK$;

   3494  5 000046   000051 470600 xsym  CHK_EVENT_Q  LDP0  ! QQ_GLOBAL+41
         5 000047   000001 236300                    LDQ   ! 1,,PR0
         5 000050   200004 756300                    STQ   ! NEXT$,,AUTO

      222     3495    3               IF NEXT$ -> TP$EVENT.FLINK$ = ADDR(NIL) THEN

   3495  5 000051   200004 471700                    LDP1  ! NEXT$,,AUTO
         5 000052   100001 236300                    LDQ   ! 1,,PR1
         5 000053   000001 116200 xsym               CMPQ  ! B_VECTNIL+1
         5 000054   000071 601200 5                  TNZ   ! s:3509

      223     3496    4                 DO;

      224     3497    4                   IF QQ_GLOBAL.TERMINATE AND

   3497  5 000055   000015 234200 xsym               SZN   ! QQ_GLOBAL+13
         5 000056   000070 605200 5                  TPL   ! s:3505
         5 000057   000032 235200 xsym               LDA   ! QQ_GLOBAL+26
         5 000060   000070 601200 5                  TNZ   ! s:3505
         5 000061   000036 235200 xsym               LDA   ! QQ_GLOBAL+30
         5 000062   000070 601200 5                  TNZ   ! s:3505
         5 000063   000043 235200 xsym               LDA   ! QQ_GLOBAL+35
         5 000064   000070 601200 5                  TNZ   ! s:3505

      225     3498    4                       QQ_GLOBAL.STATION_CNT = 0 AND
      226     3499    4                       QQ_GLOBAL.TPU_CNT = 0 AND
      227     3500    4                       QQ_GLOBAL.STRANGER_CNT = 0 THEN
      228     3501    5                     DO;

      229     3502    5                       CALL QQC$TERMINATE;

   3502  5 000065   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         5 000066   000000 701200 xent               TSX1  ! QQC$TERMINATE
         5 000067   000000 011200                    NOP   ! 0
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:51   

      230     3503    5                     END;

      231     3504
      232     3505    4                   RETURN;

   3505  5 000070   000000 702200 xent               TSX2  ! X66_ARET

      233     3506    4                 END;
      234     3507    3             END /* INHIBIT */;

      235     3508
      236     3509    2             QQ_GLOBAL.EVENT_CNT = QQ_GLOBAL.EVENT_CNT + 1;

   3509  5 000071   000042 235000 xsym               LDA     QQ_GLOBAL+34
         5 000072   000001 035007                    ADLA    1,DL
         5 000073   000042 755000 xsym               STA     QQ_GLOBAL+34

      237     3510    2             EVID = NEXT$ -> TP$EVENT.EVID;

   3510  5 000074   100003 235100                    LDA     3,,PR1
         5 000075   200010 755100                    STA     EVID,,AUTO

      238     3511    3             DO CASE(EVID);

   3511  5 000076   000005 115007                    CMPA    5,DL
         5 000077   000101 602005 5                  TNC     s:3511+3,AL
         5 000100   000260 710000 5                  TRA     s:3572
         5 000101   000260 710000 5                  TRA     s:3572
         5 000102   000106 710000 5                  TRA     s:3513
         5 000103   000225 710000 5                  TRA     s:3551
         5 000104   000253 710000 5                  TRA     s:3565
         5 000105   000256 710000 5                  TRA     s:3568

      239     3512    3               CASE(1 /* CG_READ */);

      240     3513    3                 IF NEXT$ -> TP$EVENT.ERR ~= '0'B THEN
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:52   

   3513  5 000106   100004 235100                    LDA     4,,PR1
         5 000107   000115 600000 5                  TZE     s:3519

      241     3514    4                   DO;

      242     3515    4                     QQ_GLOBAL.ERR = NEXT$ -> TP$EVENT.ERR;

   3515  5 000110   100004 236100                    LDQ     4,,PR1
         5 000111   000000 756000 xsym               STQ     QQ_GLOBAL

      243     3516    4                     CALL QQC$SCREECH;

   3516  5 000112   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000113   000000 701000 xent               TSX1    QQC$SCREECH
         5 000114   000000 011000                    NOP     0

      244     3517    4                   END;

      245     3518
      246     3519    4                 DO SELECT( NEXT$ -> TP$EVENT.VLP_STATION.MSGTYP#);

   3519  5 000115   200004 470500                    LDP0    NEXT$,,AUTO
         5 000116   040000 106500                    CMPC    fill='040'O
         5 000117   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000120   000006 000007 3                  ADSC9   CODE_DOSTAT+1            cn=0,n=7
         5 000121   000135 602000 5                  TNC     s:3519+16
         5 000122   000167 600000 5                  TZE     s:3527
         5 000123   040000 106500                    CMPC    fill='040'O
         5 000124   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000125   000010 000006 3                  ADSC9   CODE_DOSTAT+3            cn=0,n=6
         5 000126   000206 602000 5                  TNC     s:3542
         5 000127   000161 600000 5                  TZE     s:3521
         5 000130   040000 106500                    CMPC    fill='040'O
         5 000131   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000132   000012 000005 3                  ADSC9   CODE_DOSTAT+5            cn=0,n=5
         5 000133   000206 601000 5                  TNZ     s:3542
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:53   
         5 000134   000175 710000 5                  TRA     s:3533
         5 000135   040000 106500                    CMPC    fill='040'O
         5 000136   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000137   000014 000006 3                  ADSC9   CODE_DOSTAT+7            cn=0,n=6
         5 000140   000147 602000 5                  TNC     s:3519+26
         5 000141   000200 600000 5                  TZE     s:3536
         5 000142   040000 106500                    CMPC    fill='040'O
         5 000143   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000144   000016 000005 3                  ADSC9   CODE_DOSTAT+9            cn=0,n=5
         5 000145   000206 601000 5                  TNZ     s:3542
         5 000146   000164 710000 5                  TRA     s:3524
         5 000147   040000 106500                    CMPC    fill='040'O
         5 000150   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000151   000020 000005 3                  ADSC9   CODE_DOSTAT+11           cn=0,n=5
         5 000152   000206 602000 5                  TNC     s:3542
         5 000153   000172 600000 5                  TZE     s:3530
         5 000154   040000 106500                    CMPC    fill='040'O
         5 000155   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000156   000022 000007 3                  ADSC9   CODE_DOSTAT+13           cn=0,n=7
         5 000157   000206 601000 5                  TNZ     s:3542
         5 000160   000203 710000 5                  TRA     s:3539

      247     3520    4                   SELECT( '*TPCMD');

      248     3521    4                   CALL CMD_EVENT;

   3521  5 000161   000341 701000 5                  TSX1    CMD_EVENT
         5 000162   000000 011000                    NOP     0
         5 000163   000210 710000 5                  TRA     s:3545

      249     3522
      250     3523    4                   SELECT( '*FPRQ');

      251     3524    4                   CALL FP_EVENT;

   3524  5 000164   000623 701000 5                  TSX1    FP_EVENT
         5 000165   000000 011000                    NOP     0
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:54   
         5 000166   000210 710000 5                  TRA     s:3545

      252     3525
      253     3526    4                   SELECT( '*IAMRDY');

      254     3527    4                   CALL RDY_EVENT;

   3527  5 000167   001226 701000 5                  TSX1    RDY_EVENT
         5 000170   000000 011000                    NOP     0
         5 000171   000210 710000 5                  TRA     s:3545

      255     3528
      256     3529    4                   SELECT( '*AUEV');

      257     3530    4                   CALL ADMIN_EVENT;

   3530  5 000172   000526 701000 5                  TSX1    ADMIN_EVENT
         5 000173   000000 011000                    NOP     0
         5 000174   000210 710000 5                  TRA     s:3545

      258     3531
      259     3532    4                   SELECT( 'TOTPA');

      260     3533    4                   CALL MSG_EVENT;

   3533  5 000175   000632 701000 5                  TSX1    MSG_EVENT
         5 000176   000000 011000                    NOP     0
         5 000177   000210 710000 5                  TRA     s:3545

      261     3534
      262     3535    4                   SELECT( '*FPABT');

      263     3536    4                   CALL ABT_EVENT;

   3536  5 000200   001466 701000 5                  TSX1    ABT_EVENT
         5 000201   000000 011000                    NOP     0
         5 000202   000210 710000 5                  TRA     s:3545
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:55   

      264     3537
      265     3538    4                   SELECT( '*ERRMSG');

      266     3539    4                   CALL ERRMSG_EVENT;

   3539  5 000203   001475 701000 5                  TSX1    ERRMSG_EVENT
         5 000204   000000 011000                    NOP     0
         5 000205   000210 710000 5                  TRA     s:3545

      267     3540
      268     3541    4                   SELECT( ELSE);

      269     3542    4                 CALL HOLD_XACTION;

   3542  5 000206   001030 701000 5                  TSX1    HOLD_XACTION
         5 000207   000000 011000                    NOP     0

      270     3543
      271     3544    4                 END;

      272     3545    3             VLP_STATION.CTL.LATCH# = '1'B;

   3545  5 000210   200000 236003                    LDQ     65536,DU
         5 000211   000120 256000 4                  ORSQ    VLP_STATION+4

      273     3546    3             FPT_READ_CG.BUF_.BOUND = 14 + 640 + 74 - 1;

   3546  5 000212   000006 236000 4                  LDQ     FPT_READ_CG+4
         5 000213   177777 376007                    ANQ     65535,DL
         5 000214   000002 276000 6                  ORQ     2
         5 000215   000006 756000 4                  STQ     FPT_READ_CG+4

      274     3547    3             FPT_READ_CG.BUF_.BUF$ = QQ_GLOBAL.CMDBUF$;

   3547  5 000216   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         5 000217   000007 756000 4                  STQ     FPT_READ_CG+5
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:56   

      275     3548    3             CALL M$READ(FPT_READ_CG) ALTRET(COM_ERR);

   3548  5 000220   000002 630400 4                  EPPR0   FPT_READ_CG
         5 000221   440000 713400                    CLIMB   alt,read
         5 000222   401400 401760                    pmme    nvectors=4
         5 000223   000304 702000 5                  TSX2    COM_ERR
         5 000224   000260 710000 5                  TRA     s:3572

      276     3549
      277     3550    3               CASE(2 /* CSCG_READ */);

      278     3551    3                 IF NEXT$ -> TP$EVENT.ERR ~= '0'B THEN

   3551  5 000225   100004 235100                    LDA     4,,PR1
         5 000226   000234 600000 5                  TZE     s:3557

      279     3552    4                   DO;

      280     3553    4                     QQ_GLOBAL.ERR = NEXT$ -> TP$EVENT.ERR;

   3553  5 000227   100004 236100                    LDQ     4,,PR1
         5 000230   000000 756000 xsym               STQ     QQ_GLOBAL

      281     3554    4                     CALL QQC$SCREECH;

   3554  5 000231   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000232   000000 701000 xent               TSX1    QQC$SCREECH
         5 000233   000000 011000                    NOP     0

      282     3555    4                   END;

      283     3556
      284     3557    3                 CALL KEYIN_EVENT;

   3557  5 000234   000726 701000 5                  TSX1    KEYIN_EVENT
         5 000235   000000 011000                    NOP     0
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:57   

      285     3558
      286     3559    3                 VLP_STATION.CTL.LATCH# = '0'B;

   3559  5 000236   000003 236000 6                  LDQ     3
         5 000237   000120 356000 4                  ANSQ    VLP_STATION+4

      287     3560    3                 FPT_READ_CSCG.BUF_.BOUND = CSCG_MAXMC# - 1;

   3560  5 000240   000024 236000 4                  LDQ     FPT_READ_CSCG+4
         5 000241   177777 376007                    ANQ     65535,DL
         5 000242   000004 276000 6                  ORQ     4
         5 000243   000024 756000 4                  STQ     FPT_READ_CSCG+4

      288     3561    3                 FPT_READ_CSCG.BUF_.BUF$ = QQ_GLOBAL.KEYINBUF$;

   3561  5 000244   000053 236000 xsym               LDQ     QQ_GLOBAL+43
         5 000245   000025 756000 4                  STQ     FPT_READ_CSCG+5

      289     3562    3                 CALL M$READ(FPT_READ_CSCG) ALTRET(MON_ERR);

   3562  5 000246   000020 630400 4                  EPPR0   FPT_READ_CSCG
         5 000247   440000 713400                    CLIMB   alt,read
         5 000250   401400 401760                    pmme    nvectors=4
         5 000251   000331 702000 5                  TSX2    MON_ERR
         5 000252   000260 710000 5                  TRA     s:3572

      290     3563
      291     3564    3               CASE(3 /* DEBUGCMD_READ */);

      292     3565    3                 CALL DEBUGCMD_EVENT;

   3565  5 000253   000734 701000 5                  TSX1    DEBUGCMD_EVENT
         5 000254   000000 011000                    NOP     0
         5 000255   000260 710000 5                  TRA     s:3572

      293     3566
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:58   
      294     3567    3               CASE(4 /* TIMER_EVENT */);

      295     3568    3                 CALL TIMER_EVENT;

   3568  5 000256   001021 701000 5                  TSX1    TIMER_EVENT
         5 000257   000000 011000                    NOP     0

      296     3569    3             END /* CASE */;

      297     3570
      298     3571    3             DO INHIBIT;

      299     3572    3               QQ_GLOBAL.EVENT$ -> TP$EVENT.FLINK$ = NEXT$ -> TP$EVENT.FLINK$;

   3572  5 000260   200004 470700                    LDP0  ! NEXT$,,AUTO
         5 000261   000001 236300                    LDQ   ! 1,,PR0
         5 000262   000051 471600 xsym               LDP1  ! QQ_GLOBAL+41
         5 000263   100001 756300                    STQ   ! 1,,PR1

      300     3573    3               NEXT$ -> TP$EVENT.FLINK$ -> TP$EVENT.BLINK$ = QQ_GLOBAL.EVENT$;

   3573  5 000264   200004 470700                    LDP0  ! NEXT$,,AUTO
         5 000265   000001 471700                    LDP1  ! 1,,PR0
         5 000266   000051 236200 xsym               LDQ   ! QQ_GLOBAL+41
         5 000267   100000 756300                    STQ   ! 0,,PR1

      301     3574    3               QQ_GLOBAL.EVENT_DEPTH = QQ_GLOBAL.EVENT_DEPTH - 1;

   3574  5 000270   000056 235200 xsym               LDA   ! QQ_GLOBAL+46
         5 000271   000001 135207                    SBLA  ! 1,DL
         5 000272   000056 755200 xsym               STA   ! QQ_GLOBAL+46

      302     3575    3               CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, NEXT$);

   3575  5 000273   200004 630700                    EPPR0 ! NEXT$,,AUTO
         5 000274   200077 450700                    STP0  ! I+3,,AUTO
         5 000275   000005 236200 6                  LDQ   ! 5
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:59   
         5 000276   200076 756300                    STQ   ! I+2,,AUTO
         5 000277   200076 630700                    EPPR0 ! I+2,,AUTO
         5 000300   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
         5 000301   000000 701200 xent               TSX1  ! QQC$RLS_BLK
         5 000302   000000 011200                    NOP   ! 0

      303     3576    3             END /* INHIBIT */;

      304     3577    2           END /* WHILE */;

   3577  5 000303   000013 710000 5                  TRA     s:3475

      305     3578
      306     3579    1   COM_ERR:
      307     3580    1           CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3580  5 000304   200020 630500       COM_ERR      EPPR0   MSGBLK,,AUTO
         5 000305   200076 450500                    STP0    I+2,,AUTO
         5 000306   200076 630500                    EPPR0   I+2,,AUTO
         5 000307   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000310   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         5 000311   000000 011000                    NOP     0

      308     3581    1           MSGBLK.ERRINFO.ERR(0) = CODE_CGFILL;

   3581  5 000312   000004 236000 3                  LDQ     CODE_CGFILL
         5 000313   200026 756100                    STQ     MSGBLK+6,,AUTO

      309     3582    1           MSGBLK.FLAGS.DEST.MCT = '0'B;   /* Turn off print to CG flag          */

   3582  5 000314   000006 236000 6                  LDQ     6
         5 000315   200022 356100                    ANSQ    MSGBLK+2,,AUTO

      310     3583    1           MSGBLK.FLAGS.DEST.DODCB = '1'B; /* Turn on print to DO flag           */

   3583  5 000316   000010 236003                    LDQ     8,DU
         5 000317   200022 256100                    ORSQ    MSGBLK+2,,AUTO
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:60   

      311     3584    1           QQ_GLOBAL.ERROR_CNT = QQ_GLOBAL.ERROR_CNT - 1;

   3584  5 000320   000040 235000 xsym               LDA     QQ_GLOBAL+32
         5 000321   000001 135007                    SBLA    1,DL
         5 000322   000040 755000 xsym               STA     QQ_GLOBAL+32

      312     3585    1           CALL QQC$BLDMSG(MSGBLK);

   3585  5 000323   200020 630500                    EPPR0   MSGBLK,,AUTO
         5 000324   200076 450500                    STP0    I+2,,AUTO
         5 000325   200076 630500                    EPPR0   I+2,,AUTO
         5 000326   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000327   000000 701000 xent               TSX1    QQC$BLDMSG
         5 000330   000000 011000                    NOP     0

      313     3586    1   MON_ERR:
      314     3587    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   3587  5 000331   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         5 000332   000000 471500                    LDP1    0,,PR0
         5 000333   100102 236100                    LDQ     66,,PR1
         5 000334   000000 756000 xsym               STQ     QQ_GLOBAL

      315     3588    1           CALL QQC$SCREECH;

   3588  5 000335   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000336   000000 701000 xent               TSX1    QQC$SCREECH
         5 000337   000000 011000                    NOP     0
         5 000340   001616 710000 5                  TRA     s:4259

      316     3589                %PAGE(ARG="CMD_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:61   
              3606    1   /***************************************************************************
              3607    1    *                                                                         *
              3608    1    *                                 CMD_EVENT                               *
              3609    1    *                                                                         *
              3610    1    ***************************************************************************/

      317     3614    1   CMD_EVENT:

   3614  5 000341   200066 741300       CMD_EVENT    STX1  ! TEXT_NUM+1,,AUTO

      318     3615    1           PROC;
      319     3616
      320     3617    2           QQ_CMDBLK.TEXT$ = QQ_GLOBAL.CMDBUF$;

   3617  5 000342   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         5 000343   000003 756000 xsym               STQ     QQ_CMDBLK+3

      321     3618
      322     3619    2           CHAR_STRING_SIZE = 1;

   3619  5 000344   000001 235007                    LDA     1,DL
         5 000345   200014 755100                    STA     CHAR_STRING_SIZE,,AUTO

      323     3620    2           QQ_CMDBLK.ARS = NEXT$ -> TP$EVENT.ARS - 1;

   3620  5 000346   200004 470500                    LDP0    NEXT$,,AUTO
         5 000347   000007 720100                    LXL0    7,,PR0
         5 000350   777777 622010                    EAX2    -1,X0
         5 000351   000007 442000 xsym               SXL2    QQ_CMDBLK+7

      324     3621
      325     3622    3           DO WHILE (QQ_CMDBLK.ARS >= 0);

   3622  5 000352   000367 604000 5                  TMI     XIT_WHILE

      326     3623    3             IF SUBSTR(QQ_CMDBLK.TEXT$ -> CHAR$STRING, QQ_CMDBLK.ARS, 1) ~= ' ' THEN

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:62   
   3623  5 000353   000007 236000 xsym               LDQ     QQ_CMDBLK+7
         5 000354   000022 736000                    QLS     18
         5 000355   000022 732000                    QRS     18
         5 000356   000003 470400 xsym               LDP0    QQ_CMDBLK+3
         5 000357   040000 106506                    CMPC    fill='040'O
         5 000360   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         5 000361   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000362   000367 601000 5                  TNZ     XIT_WHILE

      327     3624    3               GOTO XIT_WHILE;
      328     3625    3             ELSE
      329     3626    3               QQ_CMDBLK.ARS = QQ_CMDBLK.ARS - 1;

   3626  5 000363   000007 720000 xsym               LXL0    QQ_CMDBLK+7
         5 000364   777777 621010                    EAX1    -1,X0
         5 000365   000007 441000 xsym               SXL1    QQ_CMDBLK+7

      330     3627    3           END /* DO WHILE */;

   3627  5 000366   000353 605000 5                  TPL     s:3623

      331     3628
      332     3629    2   XIT_WHILE:
      333     3630    2           QQ_CMDBLK.ARS = QQ_CMDBLK.ARS + 1;

   3630  5 000367   000007 720000 xsym  XIT_WHILE    LXL0    QQ_CMDBLK+7
         5 000370   000001 621010                    EAX1    1,X0
         5 000371   000007 441000 xsym               SXL1    QQ_CMDBLK+7

      334     3631
      335     3632    2           QQ_CMDBLK.ORIGIN = 1 /* ORIGIN_STATION */;

   3632  5 000372   000001 220003                    LDX0    1,DU
         5 000373   000007 740000 xsym               STX0    QQ_CMDBLK+7

      336     3633    2           CALL QQC$FINDSTA(NEXT$ -> TP$EVENT.VLP_STATION.STATION#,S$, FOUND_FLAG);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:63   
   3633  5 000374   200016 630500                    EPPR0   FOUND_FLAG,,AUTO
         5 000375   200100 450500                    STP0    I+4,,AUTO
         5 000376   200003 631500                    EPPR1   S$,,AUTO
         5 000377   200077 451500                    STP1    I+3,,AUTO
         5 000400   200004 236100                    LDQ     NEXT$,,AUTO
         5 000401   000011 036003                    ADLQ    9,DU
         5 000402   200076 756100                    STQ     I+2,,AUTO
         5 000403   200076 630500                    EPPR0   I+2,,AUTO
         5 000404   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000405   000000 701000 xent               TSX1    QQC$FINDSTA
         5 000406   000000 011000                    NOP     0

      337     3634
      338     3635    2           IF FOUND_FLAG THEN

   3635  5 000407   200016 234100                    SZN     FOUND_FLAG,,AUTO
         5 000410   000466 605000 5                  TPL     s:3664

      339     3636    3             DO;

      340     3637    3               QQ_CMDBLK.S$ = S$;

   3637  5 000411   200003 236100                    LDQ     S$,,AUTO
         5 000412   000004 756000 xsym               STQ     QQ_CMDBLK+4

      341     3638    3               QQ_CMDBLK.MAJOR_ERR = TP$STATION.MAJOR_ERR;

   3638  5 000413   200003 470500                    LDP0    S$,,AUTO
         5 000414   000020 236100                    LDQ     16,,PR0
         5 000415   000000 756000 xsym               STQ     QQ_CMDBLK

      342     3639    3               QQ_CMDBLK.MINOR_ERR = TP$STATION.MINOR_ERR;

   3639  5 000416   000021 236100                    LDQ     17,,PR0
         5 000417   000001 756000 xsym               STQ     QQ_CMDBLK+1

      343     3640    3               QQ_CMDBLK.MAJOR_ERR_USED = TP$STATION.FLAGS.MAJOR_ERR_USED;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:64   

   3640  5 000420   000022 236100                    LDQ     18,,PR0
         5 000421   000002 736000                    QLS     2
         5 000422   400000 376003                    ANQ     -131072,DU
         5 000423   000002 756000 xsym               STQ     QQ_CMDBLK+2

      344     3641
      345     3642    3               CALL QQA$CMD;

   3642  5 000424   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000425   000000 701000 xent               TSX1    QQA$CMD
         5 000426   000000 011000                    NOP     0

      346     3643
      347     3644    3               IF QQ_CMDBLK.FLAGS.ERR THEN

   3644  5 000427   000010 236000 xsym               LDQ     QQ_CMDBLK+8
         5 000430   400000 316007                    CANQ    -131072,DL
         5 000431   000445 600000 5                  TZE     s:3652

      348     3645    4                 DO;

      349     3646    4                   TP$STATION.MAJOR_ERR = QQ_CMDBLK.MAJOR_ERR;

   3646  5 000432   000000 236000 xsym               LDQ     QQ_CMDBLK
         5 000433   200003 470500                    LDP0    S$,,AUTO
         5 000434   000020 756100                    STQ     16,,PR0

      350     3647    4                   TP$STATION.MINOR_ERR = QQ_CMDBLK.MINOR_ERR;

   3647  5 000435   000001 236000 xsym               LDQ     QQ_CMDBLK+1
         5 000436   000021 756100                    STQ     17,,PR0

      351     3648    4                   TP$STATION.FLAGS.MAJOR_ERR_USED = QQ_CMDBLK.MAJOR_ERR_USED;

   3648  5 000437   000002 236000 xsym               LDQ     QQ_CMDBLK+2
         5 000440   000002 772000                    QRL     2
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:65   
         5 000441   000022 676100                    ERQ     18,,PR0
         5 000442   100000 376003                    ANQ     32768,DU
         5 000443   000022 656100                    ERSQ    18,,PR0

      352     3649    4                 END;

   3649  5 000444   000452 710000 5                  TRA     s:3657

      353     3650    3               ELSE
      354     3651    4                 DO;

      355     3652    4                   TP$STATION.MAJOR_ERR = '0'B;

   3652  5 000445   200003 470500                    LDP0    S$,,AUTO
         5 000446   000020 450100                    STZ     16,,PR0

      356     3653    4                   TP$STATION.MINOR_ERR = '0'B;

   3653  5 000447   000021 450100                    STZ     17,,PR0

      357     3654    4                   TP$STATION.FLAGS.MAJOR_ERR_USED = '0'B;

   3654  5 000450   000007 236000 6                  LDQ     7
         5 000451   000022 356100                    ANSQ    18,,PR0

      358     3655    4                 END;

      359     3656
      360     3657    3               IF ~TP$STATION.FLAGS.IS_QT$FORM THEN

   3657  5 000452   000022 236100                    LDQ     18,,PR0
         5 000453   000010 736000                    QLS     8
         5 000454   400000 376003                    ANQ     -131072,DU
         5 000455   400000 676003                    ERQ     -131072,DU
         5 000456   000466 600000 5                  TZE     s:3664

      361     3658    4                 DO;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:66   

      362     3659    4                   VLP_STATION_WRITE.STATION# = TP$STATION.ID;

   3659  5 000457   040000 100500                    MLR     fill='040'O
         5 000460   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000461   000124 000010 4                  ADSC9   VLP_STATION_WRITE        cn=0,n=8

      363     3660    4                   CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   3660  5 000462   000036 630400 4                  EPPR0   FPT_WRITE
         5 000463   440001 713400                    CLIMB   alt,write
         5 000464   401400 401760                    pmme    nvectors=4
         5 000465   000470 702000 5                  TSX2    MON_ERR

      364     3661    4                 END;

      365     3662    3             END;

      366     3663
      367     3664    2           RETURN;

   3664  5 000466   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 000467   000001 702211                    TSX2  ! 1,X1

      368     3665
      369     3666    2   MON_ERR:
      370     3667    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3667  5 000470   200020 630500       MON_ERR      EPPR0   MSGBLK,,AUTO
         5 000471   200076 450500                    STP0    I+2,,AUTO
         5 000472   200076 630500                    EPPR0   I+2,,AUTO
         5 000473   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000474   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         5 000475   000000 011000                    NOP     0

      371     3668    2           MSGBLK.ERRINFO.ERR(0) = CODE_CGFILL;

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:67   
   3668  5 000476   000004 236000 3                  LDQ     CODE_CGFILL
         5 000477   200026 756100                    STQ     MSGBLK+6,,AUTO

      372     3669    2           MSGBLK.FLAGS.DEST.MCT = '0'B;   /* Turn off print to CG flag          */

   3669  5 000500   000006 236000 6                  LDQ     6
         5 000501   200022 356100                    ANSQ    MSGBLK+2,,AUTO

      373     3670    2           MSGBLK.FLAGS.DEST.DODCB = '1'B; /* Turn on print to DO flag           */

   3670  5 000502   000010 236003                    LDQ     8,DU
         5 000503   200022 256100                    ORSQ    MSGBLK+2,,AUTO

      374     3671    2           QQ_GLOBAL.ERROR_CNT = QQ_GLOBAL.ERROR_CNT - 1;

   3671  5 000504   000040 235000 xsym               LDA     QQ_GLOBAL+32
         5 000505   000001 135007                    SBLA    1,DL
         5 000506   000040 755000 xsym               STA     QQ_GLOBAL+32

      375     3672    2           CALL QQC$BLDMSG(MSGBLK);

   3672  5 000507   200020 630500                    EPPR0   MSGBLK,,AUTO
         5 000510   200076 450500                    STP0    I+2,,AUTO
         5 000511   200076 630500                    EPPR0   I+2,,AUTO
         5 000512   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000513   000000 701000 xent               TSX1    QQC$BLDMSG
         5 000514   000000 011000                    NOP     0

      376     3673    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   3673  5 000515   000000 470400 xsym               LDP0    B$TCB$
         5 000516   000000 471500                    LDP1    0,,PR0
         5 000517   100102 236100                    LDQ     66,,PR1
         5 000520   000000 756000 xsym               STQ     QQ_GLOBAL

      377     3674    2           CALL QQC$SCREECH;

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:68   
   3674  5 000521   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000522   000000 701000 xent               TSX1    QQC$SCREECH
         5 000523   000000 011000                    NOP     0

      378     3675    2   END CMD_EVENT;

   3675  5 000524   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 000525   000001 702211                    TSX2  ! 1,X1

      379     3676                %PAGE(ARG="ADMIN_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:69   
              3693    2   /***************************************************************************
              3694    2    *                                                                         *
              3695    2    *                                ADMIN_EVENT                              *
              3696    2    *                                                                         *
              3697    2    ***************************************************************************/

      380     3701    1   ADMIN_EVENT:

   3701  5 000526   200066 741300       ADMIN_EVENT  STX1  ! TEXT_NUM+1,,AUTO

      381     3702    1           PROC;
      382     3703
      383     3704    3           DO CASE(B$CGAURD.EVENT);

   3704  5 000527   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         5 000530   000000 235100                    LDA     0,,PR0
         5 000531   000033 115007                    CMPA    27,DL
         5 000532   000534 602005 5                  TNC     s:3704+5,AL
         5 000533   000617 710000 5                  TRA     s:3727
         5 000534   000567 710000 5                  TRA     s:3706
         5 000535   000573 710000 5                  TRA     s:3709
         5 000536   000577 710000 5                  TRA     s:3712
         5 000537   000603 710000 5                  TRA     s:3715
         5 000540   000621 710000 5                  TRA     s:3729
         5 000541   000617 710000 5                  TRA     s:3727
         5 000542   000617 710000 5                  TRA     s:3727
         5 000543   000617 710000 5                  TRA     s:3727
         5 000544   000617 710000 5                  TRA     s:3727
         5 000545   000607 710000 5                  TRA     s:3721
         5 000546   000617 710000 5                  TRA     s:3727
         5 000547   000617 710000 5                  TRA     s:3727
         5 000550   000617 710000 5                  TRA     s:3727
         5 000551   000617 710000 5                  TRA     s:3727
         5 000552   000617 710000 5                  TRA     s:3727
         5 000553   000617 710000 5                  TRA     s:3727
         5 000554   000617 710000 5                  TRA     s:3727
         5 000555   000617 710000 5                  TRA     s:3727
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:70   
         5 000556   000617 710000 5                  TRA     s:3727
         5 000557   000617 710000 5                  TRA     s:3727
         5 000560   000617 710000 5                  TRA     s:3727
         5 000561   000617 710000 5                  TRA     s:3727
         5 000562   000617 710000 5                  TRA     s:3727
         5 000563   000617 710000 5                  TRA     s:3727
         5 000564   000613 710000 5                  TRA     s:3724
         5 000565   000613 710000 5                  TRA     s:3724
         5 000566   000613 710000 5                  TRA     s:3724

      384     3705    3             CASE(0 /* CG_DOPN# */);

      385     3706    3               CALL QQA$DCB_CON;

   3706  5 000567   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000570   000000 701000 xent               TSX1    QQA$DCB_CON
         5 000571   000000 011000                    NOP     0
         5 000572   000621 710000 5                  TRA     s:3729

      386     3707
      387     3708    3             CASE(1 /* CG_DCLS# */);

      388     3709    3               CALL QQA$DCB_DIS;

   3709  5 000573   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000574   000000 701000 xent               TSX1    QQA$DCB_DIS
         5 000575   000000 011000                    NOP     0
         5 000576   000621 710000 5                  TRA     s:3729

      389     3710
      390     3711    3             CASE(2 /* CG_TCON# */);

      391     3712    3               CALL QQA$STA_CON;

   3712  5 000577   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000600   000000 701000 xent               TSX1    QQA$STA_CON
         5 000601   000000 011000                    NOP     0
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:71   
         5 000602   000621 710000 5                  TRA     s:3729

      392     3713
      393     3714    3             CASE(3 /* CG_TDSC# */);

      394     3715    3               CALL QQA$STA_DIS;

   3715  5 000603   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000604   000000 701000 xent               TSX1    QQA$STA_DIS
         5 000605   000000 011000                    NOP     0
         5 000606   000621 710000 5                  TRA     s:3729

      395     3716
      396     3717    3             CASE(4 /* CG_TBRK# */);

      397     3718    3               ;                           /*  do nothing                        */
      398     3719
      399     3720    3             CASE(9 /* CG_WARN# */);

      400     3721    3               CALL QQA$CGWARN;

   3721  5 000607   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000610   000000 701000 xent               TSX1    QQA$CGWARN
         5 000611   000000 011000                    NOP     0
         5 000612   000621 710000 5                  TRA     s:3729

      401     3722
      402     3723    3             CASE(24/* CG_FPEXIT# */,25/* CG_FPABORT# */,26/* CG_FPLDTRC# */);

      403     3724    3               CALL QQA$FPCHNG;

   3724  5 000613   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000614   000000 701000 xent               TSX1    QQA$FPCHNG
         5 000615   000000 011000                    NOP     0
         5 000616   000621 710000 5                  TRA     s:3729

      404     3725
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:72   
      405     3726    3             CASE(ELSE);

      406     3727    3               CALL HOLD_XACTION;

   3727  5 000617   001030 701000 5                  TSX1    HOLD_XACTION
         5 000620   000000 011000                    NOP     0

      407     3728    3           END /* CASE */;

      408     3729    2           RETURN;

   3729  5 000621   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 000622   000001 702211                    TSX2  ! 1,X1

      409     3730    2   END ADMIN_EVENT;
      410     3731                %PAGE(ARG="FP_EVENT",PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:73   
              3748    2   /***************************************************************************
              3749    2    *                                                                         *
              3750    2    *                                  FP_EVENT                               *
              3751    2    *                                                                         *
              3752    2    ***************************************************************************/

      411     3756    1   FP_EVENT:

   3756  5 000623   200066 741300       FP_EVENT     STX1  ! TEXT_NUM+1,,AUTO

      412     3757    1           PROC;
      413     3758
      414     3759    2           CALL QQA$FPRQ(NEXT$ -> TP$EVENT);

   3759  5 000624   200004 630500                    EPPR0   NEXT$,,AUTO
         5 000625   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000626   000000 701000 xent               TSX1    QQA$FPRQ
         5 000627   000000 011000                    NOP     0

      415     3760    2           RETURN;

   3760  5 000630   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 000631   000001 702211                    TSX2  ! 1,X1

      416     3761    2   END FP_EVENT;
      417     3762                %PAGE(ARG="MSG_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:74   
              3779    2   /***************************************************************************
              3780    2    *                                                                         *
              3781    2    *                                 MSG_EVENT                               *
              3782    2    *                                                                         *
              3783    2    ***************************************************************************/

      418     3787    1   MSG_EVENT:

   3787  5 000632   200066 741300       MSG_EVENT    STX1  ! TEXT_NUM+1,,AUTO

      419     3788    1           PROC;
      420     3789
      421     3790    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3790  5 000633   200020 630500                    EPPR0   MSGBLK,,AUTO
         5 000634   200076 450500                    STP0    I+2,,AUTO
         5 000635   200076 630500                    EPPR0   I+2,,AUTO
         5 000636   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000637   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         5 000640   000000 011000                    NOP     0

      422     3791    2           MSGBLK.CODECNT = 0;

   3791  5 000641   000000 236003                    LDQ     0,DU
         5 000642   200023 552110                    STBQ    MSGBLK+3,'10'O,AUTO

      423     3792    2           MSGBLK.ID = MINI$MSGBLK.ID;

   3792  5 000643   000052 470400 xsym               LDP0    QQ_GLOBAL+42
         5 000644   040100 100500                    MLR     fill='040'O
         5 000645   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000646   200020 000010                    ADSC9   MSGBLK,,AUTO             cn=0,n=8

      424     3793    2           MSGBLK.ARS = MINI$MSGBLK.ARS;

   3793  5 000647   000003 220100                    LDX0    3,,PR0
         5 000650   200023 740100                    STX0    MSGBLK+3,,AUTO
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:75   

      425     3794    2           MSGBLK.FLAGS = MINI$MSGBLK.FLAGS;

   3794  5 000651   000002 236100                    LDQ     2,,PR0
         5 000652   200022 756100                    STQ     MSGBLK+2,,AUTO

      426     3795    2           MSGBLK.TEXT$ = PINCRC(QQ_GLOBAL.CMDBUF$, 14 /* MINI_MSGBLK_SIZE */);

   3795  5 000653   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         5 000654   000010 036000 6                  ADLQ    8
         5 000655   200025 756100                    STQ     MSGBLK+5,,AUTO

      427     3796    2           MSGBLK.FLAGS.INHIB_CSCG = '1'B;

   3796  5 000656   020000 236007                    LDQ     8192,DL
         5 000657   200022 256100                    ORSQ    MSGBLK+2,,AUTO

      428     3797    2           CALL QQC$SNDMSG(MSGBLK);

   3797  5 000660   200020 631500                    EPPR1   MSGBLK,,AUTO
         5 000661   200076 451500                    STP1    I+2,,AUTO
         5 000662   200076 630500                    EPPR0   I+2,,AUTO
         5 000663   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000664   000000 701000 xent               TSX1    QQC$SNDMSG
         5 000665   000000 011000                    NOP     0

      429     3798
      430     3799    2           IF QQ_GLOBAL.LOG THEN

   3799  5 000666   000005 234000 xsym               SZN     QQ_GLOBAL+5
         5 000667   000724 605000 5                  TPL     s:3809

      431     3800    3             DO;

      432     3801    3               MSGBLK.FLAGS.DEST.MCT = '0'B;

   3801  5 000670   000006 236000 6                  LDQ     6
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:76   
         5 000671   200022 356100                    ANSQ    MSGBLK+2,,AUTO

      433     3802    3               MSGBLK.FLAGS.DEST.CSCG = '1'B;

   3802  5 000672   000040 236003                    LDQ     32,DU
         5 000673   200022 256100                    ORSQ    MSGBLK+2,,AUTO

      434     3803    3               MSGBLK.TEXT$ = PINCRC(MSGBLK.TEXT$, MSGBLK.ARS);

   3803  5 000674   200023 236100                    LDQ     MSGBLK+3,,AUTO
         5 000675   777777 376003                    ANQ     -1,DU
         5 000676   000002 772000                    QRL     2
         5 000677   200025 036100                    ADLQ    MSGBLK+5,,AUTO
         5 000700   200025 756100                    STQ     MSGBLK+5,,AUTO

      435     3804    3               ARS = DCBADDR(DCBNUM(M$CG)) -> F$DCB.ARS#;

   3804  5 000701   000000 236007 xsym               LDQ     M$CG,DL
         5 000702   000011 470400 6                  LDP0    9
         5 000703   000000 471500                    LDP1    0,,PR0
         5 000704   100000 473506                    LDP3    0,QL,PR1
         5 000705   300000 235100                    LDA     0,,PR3
         5 000706   200011 755100                    STA     ARS,,AUTO

      436     3805    3               MSGBLK.ARS = ARS - MSGBLK.ARS - 14;

   3805  5 000707   200023 236100                    LDQ     MSGBLK+3,,AUTO
         5 000710   000022 772000                    QRL     18
         5 000711   200076 756100                    STQ     I+2,,AUTO
         5 000712   200011 236100                    LDQ     ARS,,AUTO
         5 000713   200076 136100                    SBLQ    I+2,,AUTO
         5 000714   777762 620006                    EAX0    -14,QL
         5 000715   200023 740100                    STX0    MSGBLK+3,,AUTO

      437     3806    3               CALL QQC$SNDMSG(MSGBLK);

   3806  5 000716   200020 633500                    EPPR3   MSGBLK,,AUTO
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:77   
         5 000717   200076 453500                    STP3    I+2,,AUTO
         5 000720   200076 630500                    EPPR0   I+2,,AUTO
         5 000721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000722   000000 701000 xent               TSX1    QQC$SNDMSG
         5 000723   000000 011000                    NOP     0

      438     3807    3             END;

      439     3808
      440     3809    2           RETURN;

   3809  5 000724   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 000725   000001 702211                    TSX2  ! 1,X1

      441     3810    2   END MSG_EVENT;
      442     3811                %PAGE(ARG="KEYIN_EVENT",PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:78   
              3828    2   /***************************************************************************
              3829    2    *                                                                         *
              3830    2    *                                KEYIN_EVENT                              *
              3831    2    *                                                                         *
              3832    2    ***************************************************************************/

      443     3836    1   KEYIN_EVENT:

   3836  5 000726   200066 741300       KEYIN_EVENT  STX1  ! TEXT_NUM+1,,AUTO

      444     3837    1           PROC;
      445     3838
      446     3839    2           CALL QQA$KEYIN;

   3839  5 000727   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000730   000000 701000 xent               TSX1    QQA$KEYIN
         5 000731   000000 011000                    NOP     0

      447     3840
      448     3841    2           RETURN;

   3841  5 000732   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 000733   000001 702211                    TSX2  ! 1,X1

      449     3842    2   END KEYIN_EVENT;
      450     3843                %PAGE(ARG="DEBUGCMD_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:79   
              3860    2   /***************************************************************************
              3861    2    *                                                                         *
              3862    2    *                               DEBUGCMD_EVENT                            *
              3863    2    *                                                                         *
              3864    2    ***************************************************************************/

      451     3868    1   DEBUGCMD_EVENT:

   3868  5 000734   200066 741300       DEBUGCMD_EV* STX1  ! TEXT_NUM+1,,AUTO

      452     3869    1           PROC;
      453     3870
      454     3871    2           QQ_CMDBLK.ORIGIN = 2 /* ORIGIN_INIT */;

   3871  5 000735   000002 220003                    LDX0    2,DU
         5 000736   000007 740000 xsym               STX0    QQ_CMDBLK+7

      455     3872    2           QQ_CMDBLK.S$ = ADDR(QQ_TP$STATION_INIT);

   3872  5 000737   000012 236000 6                  LDQ     10
         5 000740   000004 756000 xsym               STQ     QQ_CMDBLK+4

      456     3873    2           QQ_CMDBLK.TEXT$ = QQ_GLOBAL.DEBUGCMD$;

   3873  5 000741   000054 236000 xsym               LDQ     QQ_GLOBAL+44
         5 000742   000003 756000 xsym               STQ     QQ_CMDBLK+3

      457     3874    2           QQ_CMDBLK.ARS = NEXT$ -> TP$EVENT.ARS;

   3874  5 000743   200004 470500                    LDP0    NEXT$,,AUTO
         5 000744   000007 722100                    LXL2    7,,PR0
         5 000745   000007 442000 xsym               SXL2    QQ_CMDBLK+7

      458     3875    2           CALL QQA$CMD;

   3875  5 000746   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000747   000000 701000 xent               TSX1    QQA$CMD
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:80   
         5 000750   000000 011000                    NOP     0

      459     3876    2           RETURN;

   3876  5 000751   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 000752   000001 702211                    TSX2  ! 1,X1

      460     3877    2   END DEBUGCMD_EVENT;
      461     3878                %PAGE(ARG="MAKE_TIMER_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:81   
              3895    2   /***************************************************************************
              3896    2    *                                                                         *
              3897    2    *                              MAKE_TIMER_EVENT                           *
              3898    2    *                                                                         *
              3899    2    ***************************************************************************/

      462     3903    1   MAKE_TIMER_EVENT:

   3903  5 000753   200066 741300       MAKE_TIMER_* STX1  ! TEXT_NUM+1,,AUTO

      463     3904    1           PROC;
      464     3905
      465     3906    3           DO INHIBIT;

      466     3907    3             CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, SIZEW(TP$EVENT), NEW$) ALTRET(NO_MEM);

   3907  5 000754   200006 630700                    EPPR0 ! NEW$,,AUTO
         5 000755   200100 450700                    STP0  ! I+4,,AUTO
         5 000756   000014 237200 6                  LDAQ  ! 12
         5 000757   200076 757300                    STAQ  ! I+2,,AUTO
         5 000760   200076 630700                    EPPR0 ! I+2,,AUTO
         5 000761   000021 631600 xsym               EPPR1 ! B_VECTNIL+17
         5 000762   000000 701200 xent               TSX1  ! QQC$GET_BLK
         5 000763   001012 702200 5                  TSX2  ! NO_MEM

      467     3908    3             TAIL$ = QQ_GLOBAL.EVENT$ -> TP$EVENT.BLINK$;

   3908  5 000764   000051 470600 xsym               LDP0  ! QQ_GLOBAL+41
         5 000765   000000 236300                    LDQ   ! 0,,PR0
         5 000766   200005 756300                    STQ   ! TAIL$,,AUTO

      468     3909    3             NEW$ -> TP$EVENT.FLINK$ = TAIL$;

   3909  5 000767   200006 471700                    LDP1  ! NEW$,,AUTO
         5 000770   100001 756300                    STQ   ! 1,,PR1

      469     3910    3             NEW$ -> TP$EVENT.BLINK$ = TAIL$ -> TP$EVENT.BLINK$;
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:82   

   3910  5 000771   200005 470700                    LDP0  ! TAIL$,,AUTO
         5 000772   000000 236300                    LDQ   ! 0,,PR0
         5 000773   200006 471700                    LDP1  ! NEW$,,AUTO
         5 000774   100000 756300                    STQ   ! 0,,PR1

      470     3911    3             TAIL$ -> TP$EVENT.BLINK$ -> TP$EVENT.FLINK$ = NEW$;

   3911  5 000775   000000 471700                    LDP1  ! 0,,PR0
         5 000776   200006 236300                    LDQ   ! NEW$,,AUTO
         5 000777   100001 756300                    STQ   ! 1,,PR1

      471     3912    3             TAIL$ -> TP$EVENT.BLINK$ = NEW$;

   3912  5 001000   200006 236300                    LDQ   ! NEW$,,AUTO
         5 001001   000000 756300                    STQ   ! 0,,PR0

      472     3913    3             QQ_GLOBAL.EVENT_DEPTH = QQ_GLOBAL.EVENT_DEPTH + 1;

   3913  5 001002   000056 235200 xsym               LDA   ! QQ_GLOBAL+46
         5 001003   000001 035207                    ADLA  ! 1,DL
         5 001004   000056 755200 xsym               STA   ! QQ_GLOBAL+46

      473     3914    3             NEW$ -> TP$EVENT.EVID = 4 /* TIMER_EVENT */;

   3914  5 001005   000004 236207                    LDQ   ! 4,DL
         5 001006   200006 471700                    LDP1  ! NEW$,,AUTO
         5 001007   100003 756300                    STQ   ! 3,,PR1

      474     3915    3           END /* INHIBIT */;

      475     3916
      476     3917    2           RETURN;

   3917  5 001010   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 001011   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:83   
      477     3918
      478     3919    2   NO_MEM:
      479     3920    2           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;

   3920  5 001012   000002 236000 3     NO_MEM       LDQ     CODE_NO_POOLMEM
         5 001013   000000 756000 xsym               STQ     QQ_GLOBAL

      480     3921    2           CALL QQC$SCREECH;

   3921  5 001014   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 001015   000000 701000 xent               TSX1    QQC$SCREECH
         5 001016   000000 011000                    NOP     0

      481     3922    2   END MAKE_TIMER_EVENT;

   3922  5 001017   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 001020   000001 702211                    TSX2  ! 1,X1

      482     3923                %PAGE(ARG="TIMER_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:84   
              3940    2   /***************************************************************************
              3941    2    *                                                                         *
              3942    2    *                                TIMER_EVENT                              *
              3943    2    *                                                                         *
              3944    2    ***************************************************************************/

      483     3948    1   TIMER_EVENT:

   3948  5 001021   200066 741300       TIMER_EVENT  STX1  ! TEXT_NUM+1,,AUTO

      484     3949    1           PROC;
      485     3950
      486     3951    2           CALL QQA$SCHEDULE;

   3951  5 001022   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 001023   000000 701000 xent               TSX1    QQA$SCHEDULE
         5 001024   000000 011000                    NOP     0

      487     3952
      488     3953    2           TIMER_EVENT_FLAG = '0'B;

   3953  5 001025   200017 450100                    STZ     TIMER_EVENT_FLAG,,AUTO

      489     3954
      490     3955    2           RETURN;

   3955  5 001026   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 001027   000001 702211                    TSX2  ! 1,X1

      491     3956
      492     3957    2   END TIMER_EVENT;
      493     3958                %PAGE(ARG="HOLD_XACTION", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:85   
              3975    2   /***************************************************************************
              3976    2    *                                                                         *
              3977    2    *                                HOLD_XACTION                             *
              3978    2    *                                                                         *
              3979    2    ***************************************************************************/

      494     3983    1   HOLD_XACTION:

   3983  5 001030   200070 741300       HOLD_XACTION STX1  ! TEXT_NUM+3,,AUTO

      495     3984    1           PROC;
      496     3985
      497     3986    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3986  5 001031   200020 630500                    EPPR0   MSGBLK,,AUTO
         5 001032   200076 450500                    STP0    I+2,,AUTO
         5 001033   200076 630500                    EPPR0   I+2,,AUTO
         5 001034   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001035   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         5 001036   000000 011000                    NOP     0

      498     3987    2           MSGBLK.ERRINFO.ERR(0) = CODE_WT;

   3987  5 001037   000003 236000 3                  LDQ     CODE_WT
         5 001040   200026 756100                    STQ     MSGBLK+6,,AUTO

      499     3988    2           MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_XID);

   3988  5 001041   000016 235000 6                  LDA     14
         5 001042   200076 452500                    STP2    I+2,,AUTO
         5 001043   200076 236100                    LDQ     I+2,,AUTO
         5 001044   000045 036003                    ADLQ    37,DU
         5 001045   200100 757100                    STAQ    I+4,,AUTO
         5 001046   000100 100500                    MLR     fill='000'O
         5 001047   200100 000010                    ADSC9   I+4,,AUTO                cn=0,n=8
         5 001050   200027 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:86   
      500     3989    2           MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_TYPE);

   3989  5 001051   000017 235000 6                  LDA     15
         5 001052   200076 452500                    STP2    I+2,,AUTO
         5 001053   200076 236100                    LDQ     I+2,,AUTO
         5 001054   000057 036003                    ADLQ    47,DU
         5 001055   200100 757100                    STAQ    I+4,,AUTO
         5 001056   000100 100500                    MLR     fill='000'O
         5 001057   200100 000010                    ADSC9   I+4,,AUTO                cn=0,n=8
         5 001060   200031 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8

      501     3990    2           MSGBLK.ERRINFO.FIELD3(0) = VECTOR(TEXTC_ORIGIN);

   3990  5 001061   000017 235000 6                  LDA     15
         5 001062   200076 452500                    STP2    I+2,,AUTO
         5 001063   200076 236100                    LDQ     I+2,,AUTO
         5 001064   000062 036003                    ADLQ    50,DU
         5 001065   200100 757100                    STAQ    I+4,,AUTO
         5 001066   000100 100500                    MLR     fill='000'O
         5 001067   200100 000010                    ADSC9   I+4,,AUTO                cn=0,n=8
         5 001070   200033 200010                    ADSC9   MSGBLK+11,,AUTO          cn=1,n=8

      502     3991
      503     3992    2           CALL QQC$CONVERT_XID(SIZE, ADDR(TEXTC_XID.NAME#),

   3992  5 001071   200077 452500                    STP2    I+3,,AUTO
         5 001072   200077 236100                    LDQ     I+3,,AUTO
         5 001073   000020 036000 6                  ADLQ    16
         5 001074   200076 756100                    STQ     I+2,,AUTO
         5 001075   200004 236100                    LDQ     NEXT$,,AUTO
         5 001076   000017 036003                    ADLQ    15,DU
         5 001077   200103 756100                    STQ     I+7,,AUTO
         5 001100   200004 236100                    LDQ     NEXT$,,AUTO
         5 001101   000016 036003                    ADLQ    14,DU
         5 001102   200102 756100                    STQ     I+6,,AUTO
         5 001103   200076 630500                    EPPR0   I+2,,AUTO
         5 001104   200101 450500                    STP0    I+5,,AUTO
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:87   
         5 001105   200012 631500                    EPPR1   SIZE,,AUTO
         5 001106   200100 451500                    STP1    I+4,,AUTO
         5 001107   200100 630500                    EPPR0   I+4,,AUTO
         5 001110   000022 631400 xsym               EPPR1   B_VECTNIL+18
         5 001111   000000 701000 xent               TSX1    QQC$CONVERT_XID
         5 001112   000000 011000                    NOP     0

      504     3993    2               NEXT$ -> TP$EVENT.VLP_STATION.MSGID#,
      505     3994    2               NEXT$ -> TP$EVENT.VLP_STATION.MSGIDXT);
      506     3995    2           TEXTC_XID.L# = SIZE;

   3995  5 001113   200012 236100                    LDQ     SIZE,,AUTO
         5 001114   000033 736000                    QLS     27
         5 001115   200045 552140                    STBQ    TEXTC_XID,'40'O,AUTO

      507     3996
      508     3997    2           TEXTC_TYPE.L# = 8;

   3997  5 001116   010000 236003                    LDQ     4096,DU
         5 001117   200057 552140                    STBQ    TEXTC_TYPE,'40'O,AUTO

      509     3998    2           TEXTC_TYPE.NAME# = NEXT$ -> TP$EVENT.VLP_STATION.MSGTYP#;

   3998  5 001120   200004 470500                    LDP0    NEXT$,,AUTO
         5 001121   040100 100500                    MLR     fill='040'O
         5 001122   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 001123   200057 200010                    ADSC9   TEXTC_TYPE,,AUTO         cn=1,n=8

      510     3999
      511     4000    2           TEXTC_ORIGIN.L# = 8;

   4000  5 001124   200062 552140                    STBQ    TEXTC_ORIGIN,'40'O,AUTO

      512     4001    2           TEXTC_ORIGIN.NAME# = NEXT$ -> TP$EVENT.VLP_STATION.STATION#;

   4001  5 001125   040100 100500                    MLR     fill='040'O
         5 001126   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:88   
         5 001127   200062 200010                    ADSC9   TEXTC_ORIGIN,,AUTO       cn=1,n=8

      513     4002
      514     4003    2           IF TEXTC_TYPE.NAME# = '*AUEV' THEN

   4003  5 001130   040000 106500                    CMPC    fill='040'O
         5 001131   200057 200010                    ADSC9   TEXTC_TYPE,,AUTO         cn=1,n=8
         5 001132   000020 000005 3                  ADSC9   CODE_DOSTAT+11           cn=0,n=5
         5 001133   001201 601000 5                  TNZ     s:4014

      515     4004    3             DO;

      516     4005
      517     4006                                                /*  Get CG AU Event Code              */
      518     4007    3               CALL BINCHAR(TEXT_NUM, B$CGAURD.EVENT);

   4007  5 001134   000052 471400 xsym               LDP1    QQ_GLOBAL+42
         5 001135   100000 235100                    LDA     0,,PR1
         5 001136   000044 773000                    LRL     36
         5 001137   200076 757100                    STAQ    I+2,,AUTO
         5 001140   000100 301500                    BTD
         5 001141   200076 000010                    NDSC9   I+2,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         5 001142   200065 030003                    NDSC9   TEXT_NUM,,AUTO           cn=0,s=nosgn,sf=0,n=3

      519     4008    3               CALL CONCAT(TEXTC_XID.NAME#, SUBSTR(TEXTC_XID.NAME#,0,

   4008  5 001143   200045 236100                    LDQ     TEXTC_XID,,AUTO
         5 001144   000033 772000                    QRL     27
         5 001145   000000 620006                    EAX0    0,QL
         5 001146   040100 100540                    MLR     fill='040'O
         5 001147   200045 200010                    ADSC9   TEXTC_XID,,AUTO          cn=1,n=*X0
         5 001150   200045 200044                    ADSC9   TEXTC_XID,,AUTO          cn=1,n=36
         5 001151   000044 116007                    CMPQ    36,DL
         5 001152   001176 603000 5                  TRC     s:4010
         5 001153   777733 620006                    EAX0    -37,QL
         5 001154   777777 660003                    ERX0    -1,DU
         5 001155   040146 100400                    MLR     fill='040'O
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:89   
         5 001156   000024 000003 3                  ADSC9   CODE_DOSTAT+15           cn=0,n=3
         5 001157   200045 200010                    ADSC9   TEXTC_XID,Q,AUTO         cn=1,n=*X0
         5 001160   000041 116007                    CMPQ    33,DL
         5 001161   001176 603000 5                  TRC     s:4010
         5 001162   777736 620006                    EAX0    -34,QL
         5 001163   777777 660003                    ERX0    -1,DU
         5 001164   040146 100500                    MLR     fill='040'O
         5 001165   200065 000003                    ADSC9   TEXT_NUM,,AUTO           cn=0,n=3
         5 001166   200046 000010                    ADSC9   TEXTC_XID+1,Q,AUTO       cn=0,n=*X0
         5 001167   000036 116007                    CMPQ    30,DL
         5 001170   001176 603000 5                  TRC     s:4010
         5 001171   777741 620006                    EAX0    -31,QL
         5 001172   777777 660003                    ERX0    -1,DU
         5 001173   040146 100400                    MLR     fill='040'O
         5 001174   000021 000001 6                  ADSC9   17                       cn=0,n=1
         5 001175   200046 600010                    ADSC9   TEXTC_XID+1,Q,AUTO       cn=3,n=*X0

      520     4009    3                   TEXTC_XID.L#), '  (', TEXT_NUM, ')');
      521     4010    3               TEXTC_XID.L# = TEXTC_XID.L# + 7;

   4010  5 001176   200045 236100                    LDQ     TEXTC_XID,,AUTO
         5 001177   007000 036003                    ADLQ    3584,DU
         5 001200   200045 552140                    STBQ    TEXTC_XID,'40'O,AUTO

      522     4011
      523     4012    3             END;

      524     4013
      525     4014    2           CALL QQC$BLDMSG(MSGBLK);

   4014  5 001201   200020 630500                    EPPR0   MSGBLK,,AUTO
         5 001202   200076 450500                    STP0    I+2,,AUTO
         5 001203   200076 630500                    EPPR0   I+2,,AUTO
         5 001204   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001205   000000 701000 xent               TSX1    QQC$BLDMSG
         5 001206   000000 011000                    NOP     0

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:90   
      526     4015
      527     4016    2           CALL M$UNLATCH(FPT_UNLATCH) ALTRET(MON_ERR);

   4016  5 001207   000066 630400 4                  EPPR0   FPT_UNLATCH
         5 001210   500002 713400                    CLIMB   alt,+32770
         5 001211   401000 401760                    pmme    nvectors=3
         5 001212   001215 702000 5                  TSX2    MON_ERR

      528     4017
      529     4018    2           RETURN;

   4018  5 001213   200070 221300                    LDX1  ! TEXT_NUM+3,,AUTO
         5 001214   000001 702211                    TSX2  ! 1,X1

      530     4019
      531     4020    2   MON_ERR:
      532     4021    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   4021  5 001215   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         5 001216   000000 471500                    LDP1    0,,PR0
         5 001217   100102 236100                    LDQ     66,,PR1
         5 001220   000000 756000 xsym               STQ     QQ_GLOBAL

      533     4022    2           CALL QQC$SCREECH;

   4022  5 001221   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 001222   000000 701000 xent               TSX1    QQC$SCREECH
         5 001223   000000 011000                    NOP     0

      534     4023
      535     4024    2   END HOLD_XACTION;

   4024  5 001224   200070 221300                    LDX1  ! TEXT_NUM+3,,AUTO
         5 001225   000001 702211                    TSX2  ! 1,X1

      536     4025                %PAGE(ARG="RDY_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:91   
              4042    2   /***************************************************************************
              4043    2    *                                                                         *
              4044    2    *                                 RDY_EVENT                               *
              4045    2    *                                                                         *
              4046    2    ***************************************************************************/

      537     4050    1   RDY_EVENT:

   4050  5 001226   200066 741300       RDY_EVENT    STX1  ! TEXT_NUM+1,,AUTO

      538     4051    1           PROC;
      539     4052
      540     4053    2           CALL QQC$FINDSTA(NEXT$ -> TP$EVENT.VLP_STATION.STATION#,S$, FOUND_FLAG);

   4053  5 001227   200016 630500                    EPPR0   FOUND_FLAG,,AUTO
         5 001230   200100 450500                    STP0    I+4,,AUTO
         5 001231   200003 631500                    EPPR1   S$,,AUTO
         5 001232   200077 451500                    STP1    I+3,,AUTO
         5 001233   200004 236100                    LDQ     NEXT$,,AUTO
         5 001234   000011 036003                    ADLQ    9,DU
         5 001235   200076 756100                    STQ     I+2,,AUTO
         5 001236   200076 630500                    EPPR0   I+2,,AUTO
         5 001237   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001240   000000 701000 xent               TSX1    QQC$FINDSTA
         5 001241   000000 011000                    NOP     0

      541     4054
      542     4055    2           IF NOT FOUND_FLAG THEN          /* stationmax exceeded                */

   4055  5 001242   200016 234100                    SZN     FOUND_FLAG,,AUTO
         5 001243   001256 604000 5                  TMI     s:4066

      543     4056    3             DO;

      544     4057
      545     4058    3               VLP_STATION_WRITE.STATION# =

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:92   
   4058  5 001244   200004 470500                    LDP0    NEXT$,,AUTO
         5 001245   040000 100500                    MLR     fill='040'O
         5 001246   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         5 001247   000124 000010 4                  ADSC9   VLP_STATION_WRITE        cn=0,n=8

      546     4059    3                   NEXT$ -> TP$EVENT.VLP_STATION.STATION#;
      547     4060    3               CALL M$WRITE(FPT_WRITE_STATIONMAX) ALTRET(MON_ERR);

   4060  5 001250   000052 630400 4                  EPPR0   FPT_WRITE_STATIONMAX
         5 001251   440001 713400                    CLIMB   alt,write
         5 001252   401400 401760                    pmme    nvectors=4
         5 001253   001455 702000 5                  TSX2    MON_ERR

      548     4061    3               RETURN;

   4061  5 001254   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 001255   000001 702211                    TSX2  ! 1,X1

      549     4062
      550     4063    3             END;
      551     4064
      552     4065                       /*  Put node, line, port, controller into TP station context   */
      553     4066    2           ARS = NEXT$ -> TP$EVENT.ARS;

   4066  5 001256   200004 470500                    LDP0    NEXT$,,AUTO
         5 001257   000007 235100                    LDA     7,,PR0
         5 001260   200011 755100                    STA     ARS,,AUTO

      554     4067    2           CHAR_STRING_SIZE = 4;

   4067  5 001261   000004 236007                    LDQ     4,DL
         5 001262   200014 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      555     4068    2           STRT = 0;

   4068  5 001263   200015 450100                    STZ     STRT,,AUTO

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:93   
      556     4069    2           P$ = QQ_GLOBAL.CMDBUF$;

   4069  5 001264   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         5 001265   200007 756100                    STQ     P$,,AUTO

      557     4070
      558     4071    2           IF ARS <= 16 THEN

   4071  5 001266   000020 115007                    CMPA    16,DL
         5 001267   001342 605400 5                  TPNZ    s:4095

      559     4072    3             DO;

      560     4073
      561     4074    4               DO WHILE (ARS > 0);

   4074  5 001270   000000 115003                    CMPA    0,DU
         5 001271   001342 604400 5                  TMOZ    s:4095

      562     4075
      563     4076    4                 IF P$ -> CHAR$STRING ~= ' ' THEN

   4076  5 001272   200007 470500                    LDP0    P$,,AUTO
         5 001273   200014 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         5 001274   040000 106540                    CMPC    fill='040'O
         5 001275   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 001276   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001277   001320 600000 5                  TZE     s:4083

      564     4077    5                   DO;

      565     4078
      566     4079    5                     CALL RZEROS (P$ -> CHAR$STRING, 4, SIZE);

   4079  5 001300   200012 631500                    EPPR1   SIZE,,AUTO
         5 001301   200073 451500                    STP1    @BUFFSZE+1,,AUTO
         5 001302   000022 236000 6                  LDQ     18
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:94   
         5 001303   200072 756100                    STQ     @BUFF+1,,AUTO
         5 001304   200007 236100                    LDQ     P$,,AUTO
         5 001305   200071 756100                    STQ     TEXT_NUM+4,,AUTO
         5 001306   001546 701000 5                  TSX1    RZEROS
         5 001307   000000 011000                    NOP     0

      567     4080    5                     SUBSTR (TP$STATION.LINE_INFO, STRT, SIZE) = P$ -> CHAR$STRING;

   4080  5 001310   200007 470500                    LDP0    P$,,AUTO
         5 001311   200014 720100                    LXL0    CHAR_STRING_SIZE,,AUTO
         5 001312   200003 471500                    LDP1    S$,,AUTO
         5 001313   200012 721100                    LXL1    SIZE,,AUTO
         5 001314   200015 235100                    LDA     STRT,,AUTO
         5 001315   040145 100540                    MLR     fill='040'O
         5 001316   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 001317   100024 200011                    ADSC9   20,A,PR1                 cn=1,n=*X1

      568     4081    5                   END;

      569     4082
      570     4083    4                 STRT = STRT + SIZE;

   4083  5 001320   200015 236100                    LDQ     STRT,,AUTO
         5 001321   200012 036100                    ADLQ    SIZE,,AUTO
         5 001322   200015 756100                    STQ     STRT,,AUTO

      571     4084    4                 P$ = PINCRC (P$, 4);

   4084  5 001323   200007 236100                    LDQ     P$,,AUTO
         5 001324   000001 036003                    ADLQ    1,DU
         5 001325   200007 756100                    STQ     P$,,AUTO

      572     4085    4                 ARS = ARS - 4;

   4085  5 001326   000004 336007                    LCQ     4,DL
         5 001327   200011 056100                    ASQ     ARS,,AUTO

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:95   
      573     4086    4                 IF ARS > 0 THEN

   4086  5 001330   001340 604400 5                  TMOZ    s:4091

      574     4087    5                   DO;

      575     4088    5                     SUBSTR (TP$STATION.LINE_INFO, STRT, 1) = '-';

   4088  5 001331   200003 470500                    LDP0    S$,,AUTO
         5 001332   200015 235100                    LDA     STRT,,AUTO
         5 001333   040105 100400                    MLR     fill='040'O
         5 001334   000023 000001 6                  ADSC9   19                       cn=0,n=1
         5 001335   000024 200001                    ADSC9   20,A,PR0                 cn=1,n=1

      576     4089    5                     STRT = STRT + 1;

   4089  5 001336   000001 035007                    ADLA    1,DL
         5 001337   200015 755100                    STA     STRT,,AUTO

      577     4090    5                   END;

      578     4091    4               END;

   4091  5 001340   200011 235100                    LDA     ARS,,AUTO
         5 001341   001272 605400 5                  TPNZ    s:4076

      579     4092
      580     4093    3             END;

      581     4094
      582     4095    2           IF TP$STATION.FPLDTRC$ ~= ADDR(NIL) THEN

   4095  5 001342   200003 470500                    LDP0    S$,,AUTO
         5 001343   000017 236100                    LDQ     15,,PR0
         5 001344   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 001345   001361 600000 5                  TZE     s:4100

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:96   
      583     4096    3             DO;

      584     4097    3               CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$,TP$STATION.FPLDTRC$);

   4097  5 001346   200003 236100                    LDQ     S$,,AUTO
         5 001347   000017 036003                    ADLQ    15,DU
         5 001350   000005 235000 6                  LDA     5
         5 001351   200076 757100                    STAQ    I+2,,AUTO
         5 001352   200076 630500                    EPPR0   I+2,,AUTO
         5 001353   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001354   000000 701000 xent               TSX1    QQC$RLS_BLK
         5 001355   000000 011000                    NOP     0

      585     4098    3               TP$STATION.FPLDTRC$ = ADDR(NIL);

   4098  5 001356   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 001357   200003 470500                    LDP0    S$,,AUTO
         5 001360   000017 756100                    STQ     15,,PR0

      586     4099    3             END;

      587     4100    2           IF PC$INSTANCE.FLAGS.HEADER THEN

   4100  5 001361   000154 471400 xsym               LDP1    QQ_GLOBAL+108
         5 001362   100003 236100                    LDQ     3,,PR1
         5 001363   100000 316003                    CANQ    32768,DU
         5 001364   001403 600000 5                  TZE     s:4112

      588     4101    3             DO;

      589     4102    3               QQ_CMDBLK.MAJOR_ERR = '0'B;

   4102  5 001365   000000 450000 xsym               STZ     QQ_CMDBLK

      590     4103    3               QQ_CMDBLK.MINOR_ERR = '0'B;

   4103  5 001366   000001 450000 xsym               STZ     QQ_CMDBLK+1
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:97   

      591     4104    3               QQ_CMDBLK.MAJOR_ERR_USED = '0'B;

   4104  5 001367   000002 450000 xsym               STZ     QQ_CMDBLK+2

      592     4105    3               QQ_CMDBLK.TEXT$ = ADDR(NIL);

   4105  5 001370   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 001371   000003 756000 xsym               STQ     QQ_CMDBLK+3

      593     4106    3               QQ_CMDBLK.S$ = S$;

   4106  5 001372   200003 236100                    LDQ     S$,,AUTO
         5 001373   000004 756000 xsym               STQ     QQ_CMDBLK+4

      594     4107    3               QQ_CMDBLK.ORIGIN = 1 /* ORIGIN_STATION */;

   4107  5 001374   000001 220003                    LDX0    1,DU
         5 001375   000007 740000 xsym               STX0    QQ_CMDBLK+7

      595     4108    3               QQ_CMDBLK.ARS = 0;

   4108  5 001376   000000 221003                    LDX1    0,DU
         5 001377   000007 441000 xsym               SXL1    QQ_CMDBLK+7

      596     4109    3               CALL QQB$DISPLAY_HEADER;

   4109  5 001400   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 001401   000000 701000 xent               TSX1    QQB$DISPLAY_HEADER
         5 001402   000000 011000                    NOP     0

      597     4110
      598     4111    3             END;

      599     4112    2           IF TP$STATION.FIRST_CMD$ ~= ADDR(NIL) THEN

   4112  5 001403   200003 470500                    LDP0    S$,,AUTO
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:98   
         5 001404   000016 236100                    LDQ     14,,PR0
         5 001405   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 001406   001437 600000 5                  TZE     s:4127

      600     4113    3             DO;

      601     4114    3               QQ_CMDBLK.MAJOR_ERR = '0'B;

   4114  5 001407   000000 450000 xsym               STZ     QQ_CMDBLK

      602     4115    3               QQ_CMDBLK.MINOR_ERR = '0'B;

   4115  5 001410   000001 450000 xsym               STZ     QQ_CMDBLK+1

      603     4116    3               QQ_CMDBLK.MAJOR_ERR_USED = '0'B;

   4116  5 001411   000002 450000 xsym               STZ     QQ_CMDBLK+2

      604     4117    3               QQ_CMDBLK.TEXT$ = TP$STATION.FIRST_CMD$;

   4117  5 001412   000003 756000 xsym               STQ     QQ_CMDBLK+3

      605     4118    3               QQ_CMDBLK.S$ = S$;

   4118  5 001413   200003 236100                    LDQ     S$,,AUTO
         5 001414   000004 756000 xsym               STQ     QQ_CMDBLK+4

      606     4119    3               QQ_CMDBLK.ORIGIN = 1 /* ORIGIN_STATION */;

   4119  5 001415   000001 220003                    LDX0    1,DU
         5 001416   000007 740000 xsym               STX0    QQ_CMDBLK+7

      607     4120    3               QQ_CMDBLK.ARS = 80;

   4120  5 001417   000120 221003                    LDX1    80,DU
         5 001420   000007 441000 xsym               SXL1    QQ_CMDBLK+7

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:99   
      608     4121    3               CALL QQA$CMD;

   4121  5 001421   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 001422   000000 701000 xent               TSX1    QQA$CMD
         5 001423   000000 011000                    NOP     0

      609     4122
      610     4123    3               CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, TP$STATION.FIRST_CMD$);

   4123  5 001424   200003 236100                    LDQ     S$,,AUTO
         5 001425   000016 036003                    ADLQ    14,DU
         5 001426   000005 235000 6                  LDA     5
         5 001427   200076 757100                    STAQ    I+2,,AUTO
         5 001430   200076 630500                    EPPR0   I+2,,AUTO
         5 001431   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001432   000000 701000 xent               TSX1    QQC$RLS_BLK
         5 001433   000000 011000                    NOP     0

      611     4124    3               TP$STATION.FIRST_CMD$ = ADDR(NIL);

   4124  5 001434   000001 236000 xsym               LDQ     B_VECTNIL+1
         5 001435   200003 470500                    LDP0    S$,,AUTO
         5 001436   000016 756100                    STQ     14,,PR0

      612     4125    3             END;

      613     4126
      614     4127    2           IF ~TP$STATION.FLAGS.IS_QT$FORM THEN

   4127  5 001437   000022 236100                    LDQ     18,,PR0
         5 001440   000010 736000                    QLS     8
         5 001441   400000 376003                    ANQ     -131072,DU
         5 001442   400000 676003                    ERQ     -131072,DU
         5 001443   001453 600000 5                  TZE     s:4133

      615     4128    3             DO;

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:100  
      616     4129    3               VLP_STATION_WRITE.STATION# = TP$STATION.ID;

   4129  5 001444   040000 100500                    MLR     fill='040'O
         5 001445   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 001446   000124 000010 4                  ADSC9   VLP_STATION_WRITE        cn=0,n=8

      617     4130    3               CALL M$WRITE(FPT_WRITE) ALTRET(MON_ERR);

   4130  5 001447   000036 630400 4                  EPPR0   FPT_WRITE
         5 001450   440001 713400                    CLIMB   alt,write
         5 001451   401400 401760                    pmme    nvectors=4
         5 001452   001455 702000 5                  TSX2    MON_ERR

      618     4131    3             END;

      619     4132
      620     4133    2           RETURN;

   4133  5 001453   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 001454   000001 702211                    TSX2  ! 1,X1

      621     4134
      622     4135    2   MON_ERR:
      623     4136    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   4136  5 001455   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         5 001456   000000 471500                    LDP1    0,,PR0
         5 001457   100102 236100                    LDQ     66,,PR1
         5 001460   000000 756000 xsym               STQ     QQ_GLOBAL

      624     4137    2           CALL QQC$SCREECH;

   4137  5 001461   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 001462   000000 701000 xent               TSX1    QQC$SCREECH
         5 001463   000000 011000                    NOP     0

      625     4138
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:101  
      626     4139    2   END RDY_EVENT;

   4139  5 001464   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 001465   000001 702211                    TSX2  ! 1,X1

      627     4140                %PAGE(ARG="ABT_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:102  
              4157    2   /***************************************************************************
              4158    2    *                                                                         *
              4159    2    *                                 ABT_EVENT                               *
              4160    2    *                                                                         *
              4161    2    ***************************************************************************/

      628     4165    1   ABT_EVENT:

   4165  5 001466   200066 741300       ABT_EVENT    STX1  ! TEXT_NUM+1,,AUTO

      629     4166    1           PROC;
      630     4167
      631     4168    2           CALL QQA$FPABT(NEXT$ -> TP$EVENT);

   4168  5 001467   200004 630500                    EPPR0   NEXT$,,AUTO
         5 001470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001471   000000 701000 xent               TSX1    QQA$FPABT
         5 001472   000000 011000                    NOP     0

      632     4169
      633     4170    2           RETURN;

   4170  5 001473   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 001474   000001 702211                    TSX2  ! 1,X1

      634     4171
      635     4172    2   END ABT_EVENT;
      636     4173                %PAGE(ARG="ERRMSG_EVENT", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:103  
              4190    2   /***************************************************************************
              4191    2    *                                                                         *
              4192    2    *                                ERRMSG_EVENT                             *
              4193    2    *                                                                         *
              4194    2    ***************************************************************************/

      637     4198    1   ERRMSG_EVENT:

   4198  5 001475   200066 741300       ERRMSG_EVENT STX1  ! TEXT_NUM+1,,AUTO

      638     4199    1           PROC;
      639     4200
      640     4201    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   4201  5 001476   200020 630500                    EPPR0   MSGBLK,,AUTO
         5 001477   200076 450500                    STP0    I+2,,AUTO
         5 001500   200076 630500                    EPPR0   I+2,,AUTO
         5 001501   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001502   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         5 001503   000000 011000                    NOP     0

      641     4202    2           MSGBLK.ERRINFO.ERR(0) = CODE_DOSTAT;

   4202  5 001504   000005 236000 3                  LDQ     CODE_DOSTAT
         5 001505   200026 756100                    STQ     MSGBLK+6,,AUTO

      642     4203    2           CALL QQC$BLDMSG(MSGBLK);

   4203  5 001506   200020 630500                    EPPR0   MSGBLK,,AUTO
         5 001507   200076 450500                    STP0    I+2,,AUTO
         5 001510   200076 630500                    EPPR0   I+2,,AUTO
         5 001511   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001512   000000 701000 xent               TSX1    QQC$BLDMSG
         5 001513   000000 011000                    NOP     0

      643     4204
      644     4205    2           CALL QQC$BLDMSG_ERRBLK(MSGBLK);
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:104  

   4205  5 001514   200020 630500                    EPPR0   MSGBLK,,AUTO
         5 001515   200076 450500                    STP0    I+2,,AUTO
         5 001516   200076 630500                    EPPR0   I+2,,AUTO
         5 001517   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001520   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         5 001521   000000 011000                    NOP     0

      645     4206    2           MSGBLK.CODECNT = 0;

   4206  5 001522   000000 236003                    LDQ     0,DU
         5 001523   200023 552110                    STBQ    MSGBLK+3,'10'O,AUTO

      646     4207    2           MSGBLK.ARS = DCBADDR(DCBNUM(M$CG)) -> F$DCB.ARS# - 1;

   4207  5 001524   000000 236007 xsym               LDQ     M$CG,DL
         5 001525   000011 470400 6                  LDP0    9
         5 001526   000000 471500                    LDP1    0,,PR0
         5 001527   100000 473506                    LDP3    0,QL,PR1
         5 001530   300000 720100                    LXL0    0,,PR3
         5 001531   777777 621010                    EAX1    -1,X0
         5 001532   200023 741100                    STX1    MSGBLK+3,,AUTO

      647     4208    2           MSGBLK.TEXT$ = PINCRC(QQ_GLOBAL.CMDBUF$, 1);

   4208  5 001533   000052 236000 xsym               LDQ     QQ_GLOBAL+42
         5 001534   200000 036007                    ADLQ    65536,DL
         5 001535   200025 756100                    STQ     MSGBLK+5,,AUTO

      648     4209    2           CALL QQC$SNDMSG(MSGBLK);

   4209  5 001536   200020 633500                    EPPR3   MSGBLK,,AUTO
         5 001537   200076 453500                    STP3    I+2,,AUTO
         5 001540   200076 630500                    EPPR0   I+2,,AUTO
         5 001541   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001542   000000 701000 xent               TSX1    QQC$SNDMSG
         5 001543   000000 011000                    NOP     0
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:105  

      649     4210
      650     4211    2           RETURN;

   4211  5 001544   200066 221300                    LDX1  ! TEXT_NUM+1,,AUTO
         5 001545   000001 702211                    TSX2  ! 1,X1

      651     4212
      652     4213    2   END ERRMSG_EVENT;
      653     4214                %PAGE(ARG="RZEROS", PAGE=YES);

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:106  
              4231    2   /***************************************************************************
              4232    2    *                                                                         *
              4233    2    *                                   RZEROS                                *
              4234    2    *                                                                         *
              4235    2    ***************************************************************************/

      654     4239    1   RZEROS: PROC(BUFF,BUFFSZE,NCHARS);

   4239  5 001546   200070 741300       RZEROS       STX1  ! TEXT_NUM+3,,AUTO

      655     4240    2   DCL BUFF CHAR(BUFFSZE);                 /*Buffer*/
      656     4241    2   DCL BUFFA(0:3) REDEF BUFF CHAR(1);
      657     4242    2   DCL I SBIN WORD;                        /*Index*/
      658     4243    2   DCL BUFFSZE SBIN WORD;                  /*Buffer size*/
      659     4244    2   DCL NCHARS SBIN WORD;                   /*Number of CHARS.*/
      660     4245    2           I=0;

   4245  5 001547   200074 450100                    STZ     I,,AUTO

      661     4246    3           DO WHILE (BUFFA(I)='0' AND I<BUFFSZE);

   4246  5 001550   001552 710000 5                  TRA     s:4248

      662     4247    3             I=I+1;

   4247  5 001551   200074 054100                    AOS     I,,AUTO

      663     4248    3           END;

   4248  5 001552   200071 470500                    LDP0    @BUFF,,AUTO
         5 001553   200074 235100                    LDA     I,,AUTO
         5 001554   040000 106505                    CMPC    fill='040'O
         5 001555   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         5 001556   000024 000001 6                  ADSC9   20                       cn=0,n=1
         5 001557   001564 601000 5                  TNZ     s:4249
         5 001560   200072 471500                    LDP1    @BUFFSZE,,AUTO
         5 001561   200074 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:107  
         5 001562   100000 116100                    CMPQ    0,,PR1
         5 001563   001551 604000 5                  TMI     s:4247

      664     4249    2           BUFF=SUBSTR(BUFF,I,BUFFSZE-I);

   4249  5 001564   200072 471500                    LDP1    @BUFFSZE,,AUTO
         5 001565   100000 720100                    LXL0    0,,PR1
         5 001566   100000 236100                    LDQ     0,,PR1
         5 001567   200074 136100                    SBLQ    I,,AUTO
         5 001570   000000 621006                    EAX1    0,QL
         5 001571   040140 100545                    MLR     fill='040'O
         5 001572   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
         5 001573   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      665     4250        /*         **** Return only single zero if all zeros in buffer*/
      666     4251    2           IF I=BUFFSZE

   4251  5 001574   200074 236100                    LDQ     I,,AUTO
         5 001575   100000 116100                    CMPQ    0,,PR1
         5 001576   001603 601000 5                  TNZ     s:4254

      667     4252    2           THEN
      668     4253    2             BUFF='0';

   4253  5 001577   100000 720100                    LXL0    0,,PR1
         5 001600   040140 100400                    MLR     fill='040'O
         5 001601   000024 000001 6                  ADSC9   20                       cn=0,n=1
         5 001602   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      669     4254    2           IF ADDR(NCHARS) ~= ADDR(NIL)

   4254  5 001603   200073 236100                    LDQ     @NCHARS,,AUTO
         5 001604   000001 116000 xsym               CMPQ    B_VECTNIL+1
         5 001605   001614 600000 5                  TZE     s:4257

      670     4255    2           THEN
      671     4256    2             CALL INDEX(NCHARS,' ',BUFF);  /*Return # chars*/
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:108  

   4256  5 001606   100000 720100                    LXL0    0,,PR1
         5 001607   200073 473500                    LDP3    @NCHARS,,AUTO
         5 001610   000000 124540                    SCM     mask='000'O
         5 001611   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         5 001612   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 001613   300000 000100                    ARG     0,,PR3

      672     4257    2           RETURN;

   4257  5 001614   200070 221300                    LDX1  ! TEXT_NUM+3,,AUTO
         5 001615   000001 702211                    TSX2  ! 1,X1

      673     4258    2   END RZEROS;
      674     4259    1   END QQA$PROCESS;

   4259  5 001616   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:109  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_SUPER_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$PROCESS.
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:110  

 **** Variables and constants ****

  ****  Section 003 RoData QQA$PROCESS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/b STRC        r     1 CODE_CGFILL                5-0-0/b STRC        r     1 CODE_DOSTAT
     2-0-0/b STRC        r     1 CODE_NO_POOLMEM            3-0-0/b STRC        r     1 CODE_WT
     0-0-0/c CHAR(3)     r     1 COMMAND_XACTION            1-0-0/c CHAR(3)     r     1 STATIONMAX_XACTION

  ****  Section 004  Data  QQA$PROCESS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d STRC(504)   r     1 FPT_READ_CG               20-0-0/d STRC(504)   r     1 FPT_READ_CSCG
   100-0-0/d STRC(432)   r     1 FPT_TIME                  66-0-0/d STRC(360)   r     1 FPT_UNLATCH
    36-0-0/d STRC(432)   r     1 FPT_WRITE                 52-0-0/d STRC(432)   r     1 FPT_WRITE_STATIONMAX
     0-0-0/w UBIN        r     1 UTS                      114-0-0/w STRC(288)   r     1 VLP_STATION
   124-0-0/w STRC(288)   r     1 VLP_STATION_WRITE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    71-0-0/w PTR         r     1 @BUFF                     72-0-0/w PTR         r     1 @BUFFSZE
    73-0-0/w PTR         r     1 @NCHARS                   11-0-0/w SBIN        r     1 ARS
    *0-0-0/c ACHR        r     1 BUFF                      *0-0-0/c CHAR        r     1 BUFFA(0:3)
    *0-0-0/w SBIN        r     1 BUFFSZE                   14-0-0/w UBIN        r     1 CHAR_STRING_SIZE
    13-0-0/w SBIN        r     1 ELAPSED_SECS              10-0-0/w UBIN        r     1 EVID
    16-0-0/w BIT         r     1 FOUND_FLAG                74-0-0/w SBIN        r     1 I
    20-0-0/w STRC(738)   r     1 MSGBLK                    *0-0-0/w SBIN        r     1 NCHARS
     6-0-0/w PTR         r     1 NEW$                       4-0-0/w PTR         r     1 NEXT$
     7-0-0/w PTR         r     1 P$                         3-0-0/w PTR         r     1 S$
    12-0-0/w UBIN        r     1 SIZE                      15-0-0/w UBIN        r     1 STRT
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:111  
     5-0-0/w PTR         r     1 TAIL$                     62-0-0/c STRC(81)    r     1 TEXTC_ORIGIN
    57-0-0/c STRC(81)    r     1 TEXTC_TYPE                45-0-0/c STRC(333)   r     1 TEXTC_XID
    65-0-0/c CHAR(3)     r     1 TEXT_NUM                  17-0-0/w BIT         r     1 TIMER_EVENT_FLAG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(315)   r     1 QQ_CMDBLK
     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL                  0-0-0/w STRC(909)   r     1 QQ_TP$STATION_INIT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(1548)  r     1 B$CGAURD
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 CHAR$STRING
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$CG
     0-0-0N  NULL        r     1 M$CSCG                     0-0-0/w STRC(738)   r     1 MINI$MSGBLK
     0-0-0/w STRC(2700)  r     1 PC$INSTANCE                0-0-0/w STRC(612)   r     1 TP$EVENT
     0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQA$PROCESS requires 911 words for executable code.
   Procedure QQA$PROCESS requires 68 words of local(AUTO) storage.

    No errors detected in file QQA$PROCESS.:E05TSI    .
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:112  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:113  
          MINI XREF LISTING

ABT_EVENT
      4166**PROC     3536--CALL
ADMIN_EVENT
      3702**PROC     3530--CALL
ARS
      2891**DCL      3804<<ASSIGN   3805>>ASSIGN   4066<<ASSIGN   4071>>IF       4074>>DOWHILE  4085<<ASSIGN
      4085>>ASSIGN   4086>>IF
B$ALT.CODE
      2634**DCL      2634--REDEF    2635--REDEF    2635--REDEF
B$ALT.ERR
      2635**DCL      3587>>ASSIGN   3673>>ASSIGN   4021>>ASSIGN   4136>>ASSIGN
B$ALT.ERR.ERR#
      2636**DCL      2636--REDEF
B$ALT.EVID
      2635**DCL      2635--REDEF    2635--REDEF
B$CGAURD.B$CGAUCI.ATTR
      2678**DCL      2678--REDEF
B$CGAURD.EVENT
      2656**DCL      3704>>DOCASE   4007>>CALLBLT
B$CGAURD.STATION
      2656**DCL      2656--REDEF
B$TCB.ALT$
      2573**DCL      3587>>ASSIGN   3673>>ASSIGN   4021>>ASSIGN   4136>>ASSIGN
B$TCB$
      2325**DCL      3587>>ASSIGN   3673>>ASSIGN   4021>>ASSIGN   4136>>ASSIGN
BUFF IN PROCEDURE RZEROS
      4240**DCL      4239--PROC     4241--REDEF    4249<<ASSIGN   4249>>ASSIGN   4253<<ASSIGN   4256>>CALLBLT
BUFFA IN PROCEDURE RZEROS
      4241**DCL      4246>>DOWHILE
BUFFSZE IN PROCEDURE RZEROS
      4243**DCL      4239--PROC     4240--IMP-SIZ  4246>>DOWHILE  4249>>ASSIGN   4249>>ASSIGN   4249>>ASSIGN
      4251>>IF       4253>>ASSIGN   4256>>CALLBLT
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:114  
CHAR$STRING
      2378**DCL      3623>>IF       4076>>IF       4079<>CALL     4080>>ASSIGN
CHAR_STRING_SIZE
      2894**DCL      2378--IMP-SIZ  3619<<ASSIGN   3623>>IF       4067<<ASSIGN   4076>>IF       4079>>CALL
      4080>>ASSIGN
CHK_EVENT_Q
      3494**LABEL    3469--GOTO
CMD_EVENT
      3615**PROC     3521--CALL
CODE_CGFILL
      3112**DCL      3581>>ASSIGN   3668>>ASSIGN
CODE_DOSTAT
      3119**DCL      4202>>ASSIGN
CODE_NO_POOLMEM
      3098**DCL      3920>>ASSIGN
CODE_WT
      3105**DCL      3987>>ASSIGN
COMMAND_XACTION
      2832**DCL      3274--DCLINIT  3275--DCLINIT
COM_ERR
      3580**LABEL    3548--CALLALT
DEBUGCMD_EVENT
      3869**PROC     3565--CALL
ELAPSED_SECS
      2893**DCL      3479<>CALL     3480>>IF       3487>>ASSIGN
ERRMSG_EVENT
      4199**PROC     3539--CALL
EVID
      2890**DCL      3510<<ASSIGN   3511>>DOCASE
F$DCB.ACTPOS
      2608**DCL      2608--REDEF
F$DCB.ARS#
      2582**DCL      2582--REDEF    3804>>ASSIGN   4207>>ASSIGN
F$DCB.ATTR
      2601**DCL      2602--REDEF
F$DCB.BORROW
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:115  
      2616**DCL      2616--REDEF    2616--REDEF    2616--REDEF
F$DCB.DCBNAME.L
      2630**DCL      2630--IMP-SIZ
F$DCB.EOMCHAR#
      2586**DCL      2586--REDEF
F$DCB.FLDID
      2611**DCL      2611--REDEF
F$DCB.FORM$
      2605**DCL      2605--REDEF
F$DCB.FSECT
      2621**DCL      2621--REDEF
F$DCB.FSN#
      2598**DCL      2598--REDEF    2598--REDEF    2599--REDEF
F$DCB.HEADER$
      2604**DCL      2604--REDEF
F$DCB.IXTNSIZE#
      2602**DCL      2602--REDEF
F$DCB.LASTSTA$
      2591**DCL      2591--REDEF
F$DCB.LVL
      2617**DCL      2617--REDEF
F$DCB.NAME#.C
      2592**DCL      2592--REDEF
F$DCB.NOEOF
      2614**DCL      2614--REDEF
F$DCB.NRECS#
      2603**DCL      2603--REDEF
F$DCB.NRECX
      2622**DCL      2622--REDEF
F$DCB.OHDR
      2614**DCL      2614--REDEF
F$DCB.ORG#
      2597**DCL      2597--REDEF
F$DCB.PRECNO
      2620**DCL      2620--REDEF
F$DCB.RCSZ
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:116  
      2626**DCL      2626--REDEF
F$DCB.RES#
      2593**DCL      2593--REDEF
F$DCB.SETX
      2605**DCL      2605--REDEF
F$DCB.TAB$
      2605**DCL      2605--REDEF
F$DCB.TDA
      2619**DCL      2620--REDEF
F$DCB.WSN#
      2593**DCL      2593--REDEF
FOUND_FLAG
      2897**DCL      3633<>CALL     3635>>IF       4053<>CALL     4055>>IF
FPT_READ_CG
      3193**DCL      3548<>CALL
FPT_READ_CG.BUF_.BOUND
      3195**DCL      3546<<ASSIGN
FPT_READ_CG.BUF_.BUF$
      3196**DCL      3547<<ASSIGN
FPT_READ_CG.STATION_
      3196**DCL      3197--REDEF
FPT_READ_CG.V
      3197**DCL      3193--DCLINIT
FPT_READ_CG.V.DVBYTE.REREAD#
      3208**DCL      3208--REDEF
FPT_READ_CG.V.INDX#
      3206**DCL      3206--REDEF
FPT_READ_CSCG
      3233**DCL      3562<>CALL
FPT_READ_CSCG.BUF_.BOUND
      3235**DCL      3560<<ASSIGN
FPT_READ_CSCG.BUF_.BUF$
      3236**DCL      3561<<ASSIGN
FPT_READ_CSCG.STATION_
      3236**DCL      3237--REDEF
FPT_READ_CSCG.V
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:117  
      3237**DCL      3233--DCLINIT
FPT_READ_CSCG.V.DVBYTE.REREAD#
      3248**DCL      3248--REDEF
FPT_READ_CSCG.V.INDX#
      3246**DCL      3246--REDEF
FPT_TIME
      3349**DCL      3477<>CALL
FPT_TIME.V
      3353**DCL      3349--DCLINIT
FPT_UNLATCH
      3331**DCL      4016<>CALL
FPT_UNLATCH.V
      3331**DCL      3331--DCLINIT
FPT_WRITE
      3273**DCL      3660<>CALL     4130<>CALL
FPT_WRITE.STATION_
      3275**DCL      3275--REDEF
FPT_WRITE.V
      3276**DCL      3273--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      3282**DCL      3282--REDEF
FPT_WRITE_STATIONMAX
      3305**DCL      4060<>CALL
FPT_WRITE_STATIONMAX.STATION_
      3307**DCL      3307--REDEF
FPT_WRITE_STATIONMAX.V
      3308**DCL      3305--DCLINIT
FPT_WRITE_STATIONMAX.V.DVBYTE.VFC#
      3314**DCL      3314--REDEF
FP_EVENT
      3757**PROC     3524--CALL
HOLD_XACTION
      3984**PROC     3542--CALL     3727--CALL
I IN PROCEDURE RZEROS
      4242**DCL      4245<<ASSIGN   4246>>DOWHILE  4246>>DOWHILE  4247<<ASSIGN   4247>>ASSIGN   4249>>ASSIGN
      4249>>ASSIGN   4251>>IF
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:118  
KEYIN_EVENT
      3837**PROC     3557--CALL
M$CG
      2351**DCL      3804--ASSIGN   4207--ASSIGN
M$READ
       126**DCL-ENT  3548--CALL     3562--CALL
M$TIME
       192**DCL-ENT  3477--CALL
M$UNLATCH
       145**DCL-ENT  4016--CALL
M$WRITE
       126**DCL-ENT  3660--CALL     4060--CALL     4130--CALL
MAKE_TIMER_EVENT
      3904**PROC     3463--CALL     3482--CALL
MINI$MSGBLK.ARS
      2785**DCL      3793>>ASSIGN
MINI$MSGBLK.FLAGS
      2721**DCL      3794>>ASSIGN
MINI$MSGBLK.ID
      2719**DCL      3792>>ASSIGN
MON_ERR
      3587**LABEL    3562--CALLALT
MON_ERR IN PROCEDURE CMD_EVENT
      3667**LABEL    3660--CALLALT
MON_ERR IN PROCEDURE HOLD_XACTION
      4021**LABEL    4016--CALLALT
MON_ERR IN PROCEDURE RDY_EVENT
      4136**LABEL    4060--CALLALT  4130--CALLALT
MSGBLK
      2901**DCL      3580<>CALL     3585<>CALL     3667<>CALL     3672<>CALL     3790<>CALL     3797<>CALL
      3806<>CALL     3986<>CALL     4014<>CALL     4201<>CALL     4203<>CALL     4205<>CALL     4209<>CALL
MSGBLK.ARS
      2968**DCL      3793<<ASSIGN   3803>>ASSIGN   3805<<ASSIGN   3805>>ASSIGN   4207<<ASSIGN
MSGBLK.CODECNT
      2970**DCL      3791<<ASSIGN   4206<<ASSIGN
MSGBLK.ERRINFO.ERR
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:119  
      2979**DCL      3581<<ASSIGN   3668<<ASSIGN   3987<<ASSIGN   4202<<ASSIGN
MSGBLK.ERRINFO.FIELD1
      2983**DCL      3988<<ASSIGN
MSGBLK.ERRINFO.FIELD2
      2985**DCL      3989<<ASSIGN
MSGBLK.ERRINFO.FIELD3
      2987**DCL      3990<<ASSIGN
MSGBLK.FLAGS
      2904**DCL      3794<<ASSIGN
MSGBLK.FLAGS.DEST.CSCG
      2945**DCL      3802<<ASSIGN
MSGBLK.FLAGS.DEST.DODCB
      2949**DCL      3583<<ASSIGN   3670<<ASSIGN
MSGBLK.FLAGS.DEST.MCT
      2947**DCL      3582<<ASSIGN   3669<<ASSIGN   3801<<ASSIGN
MSGBLK.FLAGS.INHIB_CSCG
      2965**DCL      3796<<ASSIGN
MSGBLK.ID
      2902**DCL      3792<<ASSIGN
MSGBLK.TEXT$
      2975**DCL      3795<<ASSIGN   3803<<ASSIGN   3803>>ASSIGN   4208<<ASSIGN
MSG_EVENT
      3788**PROC     3533--CALL
NCHARS IN PROCEDURE RZEROS
      4244**DCL      4239--PROC     4254--IF       4256<<CALLBLT
NEW$
      2887**DCL      3907<>CALL     3909>>ASSIGN   3910>>ASSIGN   3911>>ASSIGN   3912>>ASSIGN   3914>>ASSIGN
NEXT$
      2885**DCL      3494<<ASSIGN   3495>>IF       3510>>ASSIGN   3513>>IF       3515>>ASSIGN   3519>>DOSELCT
      3551>>IF       3553>>ASSIGN   3572>>ASSIGN   3573>>ASSIGN   3575<>CALL     3620>>ASSIGN   3633>>CALL
      3759>>CALL     3874>>ASSIGN   3992>>CALL     3992>>CALL     3998>>ASSIGN   4001>>ASSIGN   4053>>CALL
      4058>>ASSIGN   4066>>ASSIGN   4168>>CALL
NO_MEM IN PROCEDURE MAKE_TIMER_EVENT
      3920**LABEL    3907--CALLALT
P$
      2888**DCL      4069<<ASSIGN   4076>>IF       4079>>CALL     4080>>ASSIGN   4084<<ASSIGN   4084>>ASSIGN
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:120  
PC$INSTANCE.FLAGS.HEADER
      2529**DCL      4100>>IF
QQA$CGWARN
      2163**DCL-ENT  3721--CALL
QQA$CMD
      2164**DCL-ENT  3642--CALL     3875--CALL     4121--CALL
QQA$DCB_CON
      2167**DCL-ENT  3706--CALL
QQA$DCB_DIS
      2168**DCL-ENT  3709--CALL
QQA$FPABT
      2169**DCL-ENT  4168--CALL
QQA$FPCHNG
      2170**DCL-ENT  3724--CALL
QQA$FPRQ
      2172**DCL-ENT  3759--CALL
QQA$KEYIN
      2171**DCL-ENT  3839--CALL
QQA$SCHEDULE
      2173**DCL-ENT  3951--CALL
QQA$STA_CON
      2165**DCL-ENT  3712--CALL
QQA$STA_DIS
      2166**DCL-ENT  3715--CALL
QQB$DISPLAY_HEADER
      2175**DCL-ENT  4109--CALL
QQC$BLDMSG
      2179**DCL-ENT  3585--CALL     3672--CALL     4014--CALL     4203--CALL
QQC$BLDMSG_ERRBLK
      2180**DCL-ENT  3580--CALL     3667--CALL     3790--CALL     3986--CALL     4201--CALL     4205--CALL
QQC$CONVERT_XID
      2181**DCL-ENT  3992--CALL
QQC$FINDSTA
      2177**DCL-ENT  3633--CALL     4053--CALL
QQC$GET_BLK
      2174**DCL-ENT  3907--CALL
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:121  
QQC$RLS_BLK
      2176**DCL-ENT  3575--CALL     4097--CALL     4123--CALL
QQC$SCREECH
      2182**DCL-ENT  3516--CALL     3554--CALL     3588--CALL     3674--CALL     3921--CALL     4022--CALL
      4137--CALL
QQC$SNDMSG
      2178**DCL-ENT  3797--CALL     3806--CALL     4209--CALL
QQC$TERMINATE
      2183**DCL-ENT  3502--CALL
QQ_CMDBLK.ARS
       631**DCL      3620<<ASSIGN   3622>>DOWHILE  3623>>IF       3626<<ASSIGN   3626>>ASSIGN   3630<<ASSIGN
      3630>>ASSIGN   3874<<ASSIGN   4108<<ASSIGN   4120<<ASSIGN
QQ_CMDBLK.FLAGS.ERR
       632**DCL      3644>>IF
QQ_CMDBLK.MAJOR_ERR
       630**DCL      3638<<ASSIGN   3646>>ASSIGN   4102<<ASSIGN   4114<<ASSIGN
QQ_CMDBLK.MAJOR_ERR_USED
       631**DCL      3640<<ASSIGN   3648>>ASSIGN   4104<<ASSIGN   4116<<ASSIGN
QQ_CMDBLK.MINOR_ERR
       631**DCL      3639<<ASSIGN   3647>>ASSIGN   4103<<ASSIGN   4115<<ASSIGN
QQ_CMDBLK.ORIGIN
       631**DCL      3632<<ASSIGN   3871<<ASSIGN   4107<<ASSIGN   4119<<ASSIGN
QQ_CMDBLK.S$
       631**DCL      3637<<ASSIGN   3872<<ASSIGN   4106<<ASSIGN   4118<<ASSIGN
QQ_CMDBLK.TEXT$
       631**DCL      3617<<ASSIGN   3623>>IF       3873<<ASSIGN   4105<<ASSIGN   4117<<ASSIGN
QQ_GLOBAL.CMDBUF$
       639**DCL      2652--IMP-PTR  2718--IMP-PTR  3547>>ASSIGN   3617>>ASSIGN   3704>>DOCASE   3792>>ASSIGN
      3793>>ASSIGN   3794>>ASSIGN   3795>>ASSIGN   4007>>CALLBLT  4069>>ASSIGN   4208>>ASSIGN
QQ_GLOBAL.DEBUGCMD$
       640**DCL      3873>>ASSIGN
QQ_GLOBAL.DS1$_BITS
       642**DCL       642--REDEF
QQ_GLOBAL.DS2$_BITS
       642**DCL       643--REDEF
QQ_GLOBAL.DS3$_BITS
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:122  
       643**DCL       643--REDEF
QQ_GLOBAL.DS4$_BITS
       643**DCL       644--REDEF
QQ_GLOBAL.ERR
       632**DCL      3515<<ASSIGN   3553<<ASSIGN   3587<<ASSIGN   3673<<ASSIGN   3920<<ASSIGN   4021<<ASSIGN
      4136<<ASSIGN
QQ_GLOBAL.ERROR_CNT
       638**DCL      3584<<ASSIGN   3584>>ASSIGN   3671<<ASSIGN   3671>>ASSIGN
QQ_GLOBAL.EVENT$
       639**DCL      3494>>ASSIGN   3572>>ASSIGN   3573>>ASSIGN   3908>>ASSIGN
QQ_GLOBAL.EVENT_CNT
       638**DCL      3509<<ASSIGN   3509>>ASSIGN
QQ_GLOBAL.EVENT_DEPTH
       640**DCL      3574<<ASSIGN   3574>>ASSIGN   3913<<ASSIGN   3913>>ASSIGN
QQ_GLOBAL.KEYINBUF$
       640**DCL      3561>>ASSIGN
QQ_GLOBAL.LOG
       633**DCL      3799>>IF
QQ_GLOBAL.PC$INSTANCE$
       644**DCL      2523--IMP-PTR  4100>>IF
QQ_GLOBAL.POOL$
       643**DCL      3575<>CALL     3907<>CALL     4097<>CALL     4123<>CALL
QQ_GLOBAL.SCHEDINT
       637**DCL      3480>>IF       3487>>ASSIGN
QQ_GLOBAL.SLEEP_SECS
       639**DCL      3487<<ASSIGN
QQ_GLOBAL.STATION_CNT
       637**DCL      3497>>IF
QQ_GLOBAL.STIMER_UTS
       639**DCL      3479<>CALL
QQ_GLOBAL.STRANGER_CNT
       638**DCL      3497>>IF
QQ_GLOBAL.TERMINATE
       635**DCL      3497>>IF
QQ_GLOBAL.TPU_CNT
       637**DCL      3497>>IF
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:123  
QQ_GLOBAL.UETIME
       641**DCL      3461>>IF
QQ_TP$STATION_INIT
       735**DCL      3872--ASSIGN
RDY_EVENT
      4051**PROC     3527--CALL
RZEROS
      4239**PROC     4079--CALL
S$
      2392**DCL      2394--IMP-PTR  3633<>CALL     3637>>ASSIGN   3638>>ASSIGN   3639>>ASSIGN   3640>>ASSIGN
      3646>>ASSIGN   3647>>ASSIGN   3648>>ASSIGN   3652>>ASSIGN   3653>>ASSIGN   3654>>ASSIGN   3657>>IF
      3659>>ASSIGN   4053<>CALL     4080>>ASSIGN   4088>>ASSIGN   4095>>IF       4097>>CALL     4098>>ASSIGN
      4106>>ASSIGN   4112>>IF       4117>>ASSIGN   4118>>ASSIGN   4123>>CALL     4124>>ASSIGN   4127>>IF
      4129>>ASSIGN
SIZE
      2892**DCL      3992<>CALL     3995>>ASSIGN   4079<>CALL     4080>>ASSIGN   4083>>ASSIGN
STATIONMAX_XACTION
      2833**DCL      3306--DCLINIT  3307--DCLINIT
STRT
      2895**DCL      4068<<ASSIGN   4080>>ASSIGN   4083<<ASSIGN   4083>>ASSIGN   4088>>ASSIGN   4089<<ASSIGN
      4089>>ASSIGN
TAIL$
      2886**DCL      3908<<ASSIGN   3909>>ASSIGN   3910>>ASSIGN   3911>>ASSIGN   3912>>ASSIGN
TEXTC_ORIGIN
      3069**DCL      3990--ASSIGN
TEXTC_ORIGIN.L#
      3069**DCL      4000<<ASSIGN
TEXTC_ORIGIN.NAME#
      3069**DCL      4001<<ASSIGN
TEXTC_TYPE
      3042**DCL      3989--ASSIGN
TEXTC_TYPE.L#
      3042**DCL      3997<<ASSIGN
TEXTC_TYPE.NAME#
      3042**DCL      3998<<ASSIGN   4003>>IF
TEXTC_XID
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:124  
      3015**DCL      3988--ASSIGN
TEXTC_XID.L#
      3015**DCL      3995<<ASSIGN   4008>>CALLBLT  4010<<ASSIGN   4010>>ASSIGN
TEXTC_XID.NAME#
      3015**DCL      3992--CALL     4008<<CALLBLT  4008>>CALLBLT
TEXT_NUM
      3071**DCL      4007<<CALLBLT  4008>>CALLBLT
TIMER_EVENT
      3949**PROC     3568--CALL
TIMER_EVENT_FLAG
      2898**DCL      3464<<ASSIGN   3468<<ASSIGN   3475>>IF       3483<<ASSIGN   3953<<ASSIGN
TP$EVENT
      2454**DCL      3759<>CALL     3907--CALL     4168<>CALL
TP$EVENT.ARS
      2471**DCL      3620>>ASSIGN   3874>>ASSIGN   4066>>ASSIGN
TP$EVENT.BLINK$
      2455**DCL      3573<<ASSIGN   3908>>ASSIGN   3910<<ASSIGN   3910>>ASSIGN   3911>>ASSIGN   3912<<ASSIGN
TP$EVENT.ERR
      2463**DCL      3513>>IF       3515>>ASSIGN   3551>>IF       3553>>ASSIGN
TP$EVENT.EVID
      2461**DCL      3510>>ASSIGN   3914<<ASSIGN
TP$EVENT.FLINK$
      2457**DCL      3494>>ASSIGN   3495>>IF       3572<<ASSIGN   3572>>ASSIGN   3573>>ASSIGN   3909<<ASSIGN
      3911<<ASSIGN
TP$EVENT.VLP_STATION.MSGID#
      2515**DCL      3992<>CALL
TP$EVENT.VLP_STATION.MSGIDXT
      2515**DCL      2518--REDEF    3992<>CALL
TP$EVENT.VLP_STATION.MSGTYP#
      2509**DCL      3519>>DOSELCT  3998>>ASSIGN
TP$EVENT.VLP_STATION.STATION#
      2509**DCL      3633<>CALL     4001>>ASSIGN   4053<>CALL     4058>>ASSIGN
TP$STATION.FIRST_CMD$
      2412**DCL      4112>>IF       4117>>ASSIGN   4123<>CALL     4124<<ASSIGN
TP$STATION.FLAGS.IS_QT$FORM
      2438**DCL      3657>>IF       4127>>IF
PL6.E3A0      #001=QQA$PROCESS File=QQA$PROCESS.:E05TSI                          WED 07/30/97 05:24 Page:125  
TP$STATION.FLAGS.MAJOR_ERR_USED
      2426**DCL      3640>>ASSIGN   3648<<ASSIGN   3654<<ASSIGN
TP$STATION.FPLDTRC$
      2414**DCL      4095>>IF       4097<>CALL     4098<<ASSIGN
TP$STATION.ID
      2395**DCL      3659>>ASSIGN   4129>>ASSIGN
TP$STATION.LINE_INFO
      2450**DCL      4080<<ASSIGN   4088<<ASSIGN
TP$STATION.MAJOR_ERR
      2416**DCL      3638>>ASSIGN   3646<<ASSIGN   3652<<ASSIGN
TP$STATION.MINOR_ERR
      2418**DCL      3639>>ASSIGN   3647<<ASSIGN   3653<<ASSIGN
UTS
      2859**DCL      3353--DCLINIT  3479<>CALL
VLP_STATION
      3394**DCL      3196--DCLINIT  3236--DCLINIT
VLP_STATION.CTL.LATCH#
      3399**DCL      3545<<ASSIGN   3559<<ASSIGN
VLP_STATION.MSGIDXT
      3404**DCL      3407--REDEF
VLP_STATION_WRITE
      3421**DCL      3275--DCLINIT  3307--DCLINIT
VLP_STATION_WRITE.MSGIDXT
      3431**DCL      3434--REDEF
VLP_STATION_WRITE.STATION#
      3425**DCL      3659<<ASSIGN   4058<<ASSIGN   4129<<ASSIGN
XIT_WHILE IN PROCEDURE CMD_EVENT
      3630**LABEL    3624--GOTO
XUD$UTS_DIFF_SEC
      2191**DCL-ENT  3479--CALL
