VERSION E05

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:1    
        1        1        /*M* DAD$VSCHECK - Virtual segment and PPUT checker             */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*T*/
        8        8        /*X* PLM=8,IND=2,THI=2,ENU=2,CSU=2,DTI=4,DCI=4,ECU=4, AND */
        9        9        /*P*  NAME:         DAD$VSCHECK
       10       10              PURPOSE:      This module contains the routines used to implement
       11       11                            the virtual segment and PPUT commands.
       12       12              DESCRIPTION:  This module contains two external routines for dump
       13       13                            a virtual segment's page table and dumping various
       14       14                            PPUT displays.  The commands for these routines are:
       15       15                              VSCHECK segnum using userid
       16       16                              PPUT
       17       17        */
       18       18        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:2    
       19       19        DAD$VSCHECK: PROC (TOP) MATERIALIZE($PR2 IN PR2$);
       20       20        /* Includes */
       21       21        %INCLUDE B$JIT;
       22      624        %INCLUDE B$MAP;
       23      723        %INCLUDE B$ROSEG;
       24      786        %INCLUDE B_STRINGS_C;
       25      915        %INCLUDE B_SEGIDS_C;
       26     1454        %INCLUDE CP_6;
       27     7013        %INCLUDE CP_6_SUBS;
       28     7553        %INCLUDE DA_ANLZ_R;
       29     7566        %INCLUDE DA_MAP_R;
       30     7596        %INCLUDE DA_TEXTC_C;
       31     7627        %INCLUDE DA_SYMBOLS_R;
       32     7640        %INCLUDE DA_PERR_C;
       33     7704        %INCLUDE DA_FORMAT_C;
       34     7946        %INCLUDE DA_CMD_C;
       35     8295        %INCLUDE M_INFO_C;
       36     8435        %INCLUDE MM$SYSGEN;
       37     8460        %INCLUDE XU_MACRO_C;
       38    11566
       39    11567        /* Entries      */
       40    11568    1   DCL DAA$NXTUSR ENTRY(1) ALTRET;
       41    11569    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       42    11570    1   DCL DAD$FREXT ENTRY(1);
       43    11571    1   DCL DAD$FRREL ENTRY;
       44    11572    1   DCL DAF$ADDHDR ENTRY(1) ;
       45    11573    1   DCL DAF$INIT ENTRY(1) ALTRET;
       46    11574    1   DCL DAF$WRITE EPTR SYMREF;
       47    11575    1   DCL DAM$MAP ENTRY(5) ALTRET;
       48    11576    1   DCL DAM$USECPU ENTRY(1) ALTRET;
       49    11577    1   DCL DAS$SDSRCHPTR ENTRY(2) ALTRET;
       50    11578        /* Parameters */
       51    11579
       52    11580        /* Symref */
       53    11581    1   DCL B$IS$ PTR SYMREF;
       54    11582    1   DCL B$JIT$ PTR SYMREF;
       55    11583    1   DCL B$PPUT$ PTR SYMREF;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:3    
       56    11584    1   DCL B$MPT$ PTR SYMREF;
       57    11585    1   DCL   B$ROS$ PTR SYMREF;
       58    11586    1   DCL B$SEGTBL$ PTR SYMREF;
       59    11587    1   DCL B$MONHJIT$ PTR SYMREF;
       60    11588    1   DCL B$VPT$ SYMREF PTR;
       61    11589        %PARSE$OUT (NAME=TOP,STCLASS=" ");
       62    11634
       63    11635        /* EQUs  */
       64    11636        %EQU MAXP=65536;
       65    11637        %EQU UNKNOWN='####';
       66    11638        /* Based   */
       67    11639
       68    11640        %F$DCB;
       69    11697        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED");
       70    11742    1   DCL 1 AUTOFRAME BASED(PR2$),
       71    11743    1         2 RETADR UBIN HALF HALIGNED,
       72    11744    1         2 PREV_FRAME UBIN HALF HALIGNED,
       73    11745    1         2 FRAME_EXT UBIN HALF HALIGNED,
       74    11746    1         2 LANG_IDENT UBIN HALF HALIGNED,
       75    11747    1         2 NEXT_FRAME UBIN HALF HALIGNED,
       76    11748    1         2 ENT_LOC UBIN HALF HALIGNED;
       77    11749    1   DCL B$WORD SBIN BASED;
       78    11750    1   DCL B$DWORDS(0:0) BIT(72) DALIGNED BASED;
       79    11751    1   DCL DCBTAB$(0:0) PTR BASED ALIGNED;
       80    11752    1   DCL 1 MM$PPUT(0:0) BASED ALIGNED,
       81    11753    1         2 SUSPECT BIT(1) UNAL,            /* PAGE SUSPECTED OF BEING BAD        */
       82    11754    1         2 BAD BIT(1) UNAL,                /* PAGE IS BAD & REMOVED FROM USE     */
       83    11755    1         2 IN_TEST BIT(1) UNAL,            /* BAD PAGE WHICH IS BEING TESTED     */
       84    11756    1         2 FREE BIT(1) UNAL,               /* THIS IS A FREE PAGE                */
       85    11757    1         2 USER BIT(1) UNAL,               /* PAGE BELONGS TO USER               */
       86    11758    1         2 IO BIT(1) UNAL,                 /* PAGE BELONGS TO IO                 */
       87    11759    1         2 PRC BIT(1) UNAL,                /* PAGE BELONGS TO PROCESSOR          */
       88    11760    1         2 STOLEN BIT(1) UNAL,
       89    11761    1         2 COMM BIT(1) UNAL,
       90    11762    1         2 USER# UBIN(9) CALIGNED,
       91    11763    1         2 PNUM REDEF USER# UBIN(9) CALIGNED,
       92    11764    1         2 PPNO UBIN(18) HALIGNED;    /* PHYSICAL PAGE NUMBER OF NXT IN CHAIN    */
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:4    
       93    11765    1   DCL 1 M$PPUT BASED ALIGNED,
       94    11766    1         2 WRD(0:0) UBIN(36);
       95    11767    1   DCL 1 MM$VCB BASED(VCB$),               /* Must match VLP_VIRTUAL             */
       96    11768    1         2 INITIALIZE BIT(1) UNAL,         /* Page should be initilized          */
       97    11769    1         2 NOFILE BIT(1) UNAL,             /* No file specified                  */
       98    11770    1         2 WRITE BIT(1) UNAL,              /* User has write access              */
       99    11771    1         2 CREATE BIT(1) UNAL,             /* File is being created              */
      100    11772    1         2 T,                              /* Similar to the T field in WSPTD    */
      101    11773    1           3 FRAGMENTED BIT(1) UNAL,       /* Fragemented page table             */
      102    11774    1           3 SECTION BIT(1) UNAL,          /* Section page table used            */
      103    11775    1         2 * BIT(3) UNAL,
      104    11776    1         2 WSQ UBIN(9) CALIGNED,           /* WSQ for this area                  */
      105    11777    1         2 DCB# UBIN(9) CALIGNED,
      106    11778    1         2 SEGNUM UBIN(9) CALIGNED,        /* SEGNUM for this area               */
      107    11779    1         2 INITVALUE UBIN WORD ALIGNED,    /* Initialization value               */
      108    11780    1         2 MAXVP# UBIN ALIGNED,            /* Maximum legal virtual page         */
      109    11781    1         2 PPMAX UBIN HALF HALIGNED,       /* Physical pages maximum             */
      110    11782    1         2 PPMIN UBIN HALF HALIGNED,       /* Physical pages minimum             */
      111    11783    1         2 PTR$ PTR ALIGNED,               /* Pointer to virtual area            */
      112    11784    1         2 WSPTD ALIGNED,                  /* WSPTD value for the LVA            */
      113    11785    1           3 BLKNO UBIN HALF UNAL,         /* Mod 64 or 1024 address of PT       */
      114    11786    1           3 Q BIT (2),                    /* WSQ access control                 */
      115    11787    1           3 P BIT (1),                    /* Page Table Present                 */
      116    11788    1           3 T BIT (2),                    /* Type of PT (0 = dense, 2 = frag    */
      117    11789    1           3 * BIT (1),
      118    11790    1           3 NBLKS UBIN (12) UNAL,         /* Number of 64 word blocks           */
      119    11791    1         2 HEAD SBIN ALIGNED,              /* Head of page chain                 */
      120    11792    1         2 TAIL SBIN ALIGNED,              /* Tail of page chain                 */
      121    11793    1         2 MAXVP_WRITTEN UBIN,             /* Maximun VP written                 */
      122    11794    1         2 PPC UBIN HALF HALIGNED,         /* Physical pages current             */
      123    11795    1         2 NPGTSECT UBIN HALF HALIGNED,    /* Pg# used for the section           */
      124    11796    1         2 NPGTPGS UBIN,                   /* Number of pages needed for PT      */
      125    11797    1         2 UPGT# UBIN HALF UNAL,           /* Page tables in use (section)       */
      126    11798    1         2 * UBIN HALF UNAL;               /* Spare                              */
      127    11799    1   DCL USE_TABLE(0:1) CHAR(4) BASED(USE$);
      128    11800
      129    11801        /* Auto  */
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:5    
      130    11802
      131    11803    1   DCL CHAIN_HEAD SBIN WORD;
      132    11804    1   DCL CHAIN_TAIL SBIN WORD;
      133    11805    1   DCL COUNT UBIN WORD;
      134    11806    1   DCL CUR_VPNO SBIN WORD;
      135    11807    1   DCL DATAWRD(0:5) UBIN WORD;
      136    11808    1   DCL DWORD BIT(72) DALIGNED;
      137    11809    1   DCL DESC REDEF DWORD DSCR;
      138    11810    1   DCL DCB$ PTR;
      139    11811    1   DCL DCBPTR$ PTR;
      140    11812    1   DCL I SBIN WORD;
      141    11813    1   DCL INWCFS CHAR(6) ;
      142    11814    1   DCL J UBIN WORD;
      143    11815    1   DCL JIT$ PTR STATIC;
      144    11816    1   DCL K UBIN WORD;
      145    11817    1   DCL NUM UBIN;
      146    11818    1   DCL NXT_VPNO SBIN WORD;
      147    11819    1   DCL PCORE UBIN;
      148    11820    1   DCL PCOUNT SBIN WORD;
      149    11821    1   DCL PMAX SBIN WORD;
      150    11822    1   DCL PMIN SBIN WORD;
      151    11823    1   DCL PPNO SBIN WORD;
      152    11824    1   DCL   PR2$ PTR;
      153    11825    1   DCL 1 PR2_STRUC REDEF PR2$,
      154    11826    1         2 WORD_OFFSET UBIN HALF UNAL,
      155    11827    1         2 * UBIN HALF UNAL;
      156    11828    1   DCL PTBPGS SBIN WORD;
      157    11829    1   DCL PTBSECT SBIN WORD;
      158    11830    1   DCL PTB(0:511) UBIN BYTE CALIGNED;
      159    11831    1   DCL ROS$ PTR STATIC;
      160    11832    1   DCL RUNNING BIT(1) ALIGNED;
      161    11833    1   DCL SEGP$ PTR;
      162    11834    1   DCL   TEMP SBIN WORD;
      163    11835    1   DCL   USE$ PTR;
      164    11836    1   DCL   USER SBIN WORD;
      165    11837    1   DCL UTB(0:511) UBIN HALF HALIGNED;
      166    11838    1   DCL  UPGS SBIN WORD;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:6    
      167    11839    1   DCL   VPMAX SBIN WORD;
      168    11840    1   DCL   VPMAX_WRITTEN SBIN WORD;
      169    11841    1   DCL VPNO SBIN WORD;
      170    11842    1   DCL VPT$ PTR;
      171    11843    1   DCL VSG# SBIN WORD;
      172    11844    1   DCL VSG_DCB# SBIN WORD;
      173    11845    1   DCL V_ VECTOR;
      174    11846    1   DCL VCB$ PTR;
      175    11847    1   DCL   WSQ# SBIN WORD;
      176    11848    1   DCL 1 SEGPT (0:0) ALIGNED BASED (SEGP$),
      177    11849    1         2 RPN UBIN(18) UNAL,
      178    11850    1         2 * BIT (18) UNAL;
      179    11851        /* Constants */
      180    11852    1   DCL COUNT_ERR CHAR(0) CONSTANT INIT(
      181    11853    1   ' PAGE COUNT ERROR - (M$VCB.PCOUNT = %6D, ACTUAL PCOUNT = %6D)');
      182    11854    1   DCL TAIL_ERR CHAR(0) CONSTANT INIT(
      183    11855    1   'CHAIN ERROR - (MM$VCB.TAIL = %6D, ACTUAL TAIL = %6D)');
      184    11856    1   DCL   END_VP SBIN WORD CONSTANT INIT(BITBIN('777777'O));
      185    11857        %REPORT (TITLE='VIRTUAL SEGMENT SUMMARY',NAME=VSRPRT,TRUNC=YES,
      186    11858                 HEADER=NO);
      187    11924        %HEADER (LAST=NO,NAME=VSHDR,TEXT=
      188    11925        '  WSQ  DCB  SEGNUM  PPCOUNT   PPMIN   PPMAX  INWCFS  PGTPGS  PGTSECT    UPGT');
      189    11967        %HEADER (TEXT=
      190    11968        '  ---  ---  ------  -------  ------  ------  ------  ------  -------  ------');
      191    12010    1   DCL VSSFMT1 CONSTANT CHAR(0) INIT(
      192    12011    1   '  %3+D  %3+D  %6+D  %7+D  %6+D  %6+D  %6A  %6+D  %7+D  %6+D');
      193    12012        %HEADER (LAST=NO,NAME=VSRPT1,TEXT=
      194    12013        '    MAXVP      MAXVP-WRIT  CHAIN HEAD  CHAIN TAIL');
      195    12055        %HEADER(TEXT=
      196    12056        '  ----------  -----------  ----------  ----------');
      197    12098    1   DCL   VSSFMT2 CHAR(0) CONSTANT INIT(
      198    12099    1   '  %10+D  %11+D  %10+D  %10+D');
      199    12100        %REPORT (TITLE='VIRTUAL SEGMENT PAGE CHAIN',NAME=VSPCRPT,TRUNC=YES,
      200    12101                 HEADER=YES);
      201    12167        %HEADER (LAST=NO,TEXT=
      202    12168        ' VPAGE  PHYS. PAGE    VPAGE  PHYS. PAGE    VPAGE  PHYS. PAGE');
      203    12210        %HEADER (TEXT=
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:7    
      204    12211        '------ ------------  ------ ------------  ------ ------------');
      205    12253    1   DCL    VSSFMT3 CHAR(0) CONSTANT INIT(
      206    12254    1   '%6D %12ZO  %6D %12ZO  %6D %12ZO');
      207    12255        %REPORT (TITLE='PPUT MISCELLANEOUS INFORMATION',NAME=PMRPRT,TRUNC=YES,HEADER=YES);
      208    12321        %HEADER(TEXT=' ');
      209    12363        %REPORT (TITLE='  ',NAME=PSRPRT,TRUNC=YES,HEADER=YES);
      210    12429        %HEADER(TEXT='SUMMARY INFORMATION');
      211    12471        %REPORT (TITLE=' ',NAME=PPRPRT,TRUNC=YES,HEADER=YES);
      212    12537        %HEADER(LAST=NO,TEXT='PROCESSORS');
      213    12579        %HEADER(LAST=NO,TEXT=
      214    12580        '           0      1      2      3      4      5      6      7      8      9');
      215    12622        %HEADER(TEXT=
      216    12623        '        ----   ----   ----   ----   ----   ----   ----   ----   ----   ----');
      217    12665        %REPORT (TITLE=' ',NAME=PURPRT,TRUNC=YES,HEADER=YES);
      218    12731        %HEADER(LAST=NO,TEXT='USERS');
      219    12773        %HEADER(LAST=NO,TEXT=
      220    12774        '           0      1      2      3      4      5      6      7      8      9');
      221    12816        %HEADER(TEXT=
      222    12817        '        ----   ----   ----   ----   ----   ----   ----   ----   ----   ----');
      223    12859        %REPORT (TITLE=' ',NAME=PUSRPRT,TRUNC=YES,HEADER=YES);
      224    12925        %HEADER(LAST=NO,TEXT='PHYSICAL PAGE USAGE');
      225    12967        %HEADER(LAST=NO,TEXT=
      226    12968        '            0      1      2      3      4      5      6      7');
      227    13010        %HEADER(TEXT=
      228    13011        '------   ----   ----   ----   ----   ----   ----   ----   ----');
      229    13053    1   DCL 1 CPUPT(0:5) CONSTANT,
      230    13054    1         2 * BIT(24) UNAL INIT('0'B*0),
      231    13055    1         2 * BIT(12) UNAL INIT(%MASTERPTSID, %SLV1PTSID, %SLV2PTSID, %SLV3PTSID, %
             13055                  SLV4PTSID, %SLV5PTSID);
      232    13056
      233    13057    1   DCL CPUPT$(0:5) REDEF CPUPT PTR;
      234    13058
      235    13059
      236    13060
      237    13061    1   DCL CPUNAME(0:5) CHAR(4) CONSTANT INIT('Mstr','Slv1','Slv2','Slv3','Slv4','Slv5');
      238    13062
      239    13063    1   DCL 1 SUMFMT CONSTANT,
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:8    
      240    13064    1         2 * CHAR(0) INIT('Free Pages%20-%6D (%6D)'),
      241    13065    1         2 * CHAR(0) INIT('%/I/O Cache%20-%6D'),
      242    13066    1         2 * CHAR(0) INIT('%/Diag%20-%6D'),
      243    13067    1         2 * CHAR(0) INIT('%/User Pages%20-%6D'),
      244    13068    1         2 * CHAR(0) INIT('%/Shared Proc%20-%6D'),
      245    13069    1         2 * CHAR(0) INIT('%/SDS%20-%6D'),
      246    13070    1         2 * CHAR(0) INIT('%/Stolen%20-%6D'),
      247    13071    1         2 * CHAR(0) INIT('%/Comm%20-%6D'),
      248    13072    1         2 * CHAR(0) INIT('%/PPUT%20-%6D'),
      249    13073    1         2 * CHAR(0) INIT('%/Monitor DS%20-%6D'),
      250    13074    1         2 * CHAR(0) INIT('%/TIGR%20-%6D'),
      251    13075    1         2 * CHAR(0) INIT('%/Firmware%20-%6D'),
      252    13076    1         2 * CHAR(0) INIT('%/Monitor%20-%6D'),
      253    13077    1         2 * CHAR(0) INIT('%/Monitor Context%20-%6D'),
      254    13078    1         2 * CHAR(0) INIT('%/Low Real%20-%6D'),
      255    13079    1         2 * CHAR(0) INIT('%/Lost%20-%6D'),
      256    13080    1         2 * CHAR(0) INIT('%/%/Total%20-%6D'),
      257    13081    1         2 * CHAR(0) INIT('%/%/Pcore%20-%6D');
      258    13082
      259    13083    1   DCL PUFMT CHAR(0) CONSTANT INIT('%5D%10(%7D%)');
      260    13084
      261    13085    1   DCL PPUTFMT CHAR(0) CONSTANT INIT('%6ZO   %8(%4A   %)');
      262    13086    1   DCL PERRFMT CHAR(0) CONSTANT INIT(
      263    13087    1   ' ERROR IN PPUT, # FOUND = %6D ERROR AT = %6D');
      264    13088    1   DCL PGOODFMT CHAR(0) CONSTANT INIT(
      265    13089    1   ' HEAD = %6D   TAIL = %6D    COUNT = %7D');
      266    13090
      267    13091    1   DCL NO_OVRLYS CHAR(0) CONSTANT INIT ('*** Monitor overlays not in dump');
      268    13092    1   DCL FNFFMT CHAR(0) CONSTANT INIT('*** Free page %6ZO marked as ''%4A''');
      269    13093        /* Static */
      270    13094    1   DCL FREE# UBIN STATIC INIT(0);
      271    13095    1   DCL FREE_CH# UBIN STATIC INIT(0);
      272    13096    1   DCL IO# UBIN STATIC INIT(0);
      273    13097    1   DCL DIAG# UBIN STATIC INIT(0);
      274    13098    1   DCL U# UBIN STATIC INIT(0);
      275    13099    1   DCL P# UBIN STATIC INIT(0);
      276    13100    1   DCL SDS# UBIN STATIC INIT(0);
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:9    
      277    13101    1   DCL STOLE# UBIN STATIC INIT(0);
      278    13102    1   DCL COMM# UBIN STATIC INIT(0);
      279    13103    1   DCL PPUT# UBIN STATIC INIT(0);
      280    13104    1   DCL 1 PPUT_FLAG STATIC,
      281    13105    1         2 SUMMARY BIT(1) UNAL INIT('0'B),
      282    13106    1         2 PROCESSOR BIT(1) UNAL INIT('0'B),
      283    13107    1         2 USER BIT(1) UNAL INIT('0'B),
      284    13108    1         2 USAGE BIT(1) UNAL INIT('0'B),
      285    13109    1         2 MISC BIT(1) UNAL INIT('0'B),
      286    13110    1         2 * BIT(4) UNAL INIT('0'B);
      287    13111    1   DCL MONDS# UBIN STATIC INIT(0);
      288    13112    1   DCL TIGR# UBIN STATIC INIT(0);
      289    13113    1   DCL FIRM# UBIN STATIC INIT(0);
      290    13114    1   DCL MON# UBIN STATIC INIT(0);
      291    13115    1   DCL MONCXT# UBIN STATIC INIT(0);
      292    13116    1   DCL LOW# UBIN STATIC INIT(0);
      293    13117    1   DCL LOST# UBIN STATIC INIT(0);
      294    13118    1   DCL OUT$ PTR STATIC;
      295    13119    1   DCL MPT$ PTR STATIC;
      296    13120    1   DCL PPUT$ PTR STATIC;
      297    13121    1   DCL SEGTBL$ PTR STATIC;
      298    13122    1   DCL 1 SEGTBL ALIGNED BASED (SEGTBL$),
      299    13123    1         2 * UBIN,
      300    13124    1         2 NODES (0:0) ALIGNED,
      301    13125    1           3 WOFF UBIN(16) HALIGNED,
      302    13126    1           3 WSIZ UBIN(16) HALIGNED;
      303    13127
      304    13128
      305    13129        %TEXTC (NAME=NAME_PCORE,TEXT='MM_PCORE');
      306    13153        %TEXTC (NAME=NAME_FPPH,TEXT='MM_FPPH');
      307    13177        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:10   
      308    13178    1           CALL SETUP;
      309    13179    2           CALL DAM$MAP(B$PPUT$,PPUT$,0,%MONWSR) WHENALTRETURN DO;
      310    13180    2                 RETURN;
      311    13181    2               END;
      312    13182    2           CALL DAM$MAP(B$VPT$,VPT$,-DA_CUN,%MONWSR) WHENALTRETURN DO;
      313    13183    2                 RETURN;
      314    13184    2               END;
      315    13185    1           CALL DIPGCHAIN;
      316    13186    1           RETURN;
      317    13187        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:11   
      318    13188    1   DAD$VCB: ENTRY(TOP);
      319    13189    1           CALL SETUP;
      320    13190    1           WSQ# = MM$VCB.WSQ;
      321    13191    1           INWCFS = ' ';
      322    13192    1           IF MM$VCB.INITIALIZE THEN
      323    13193    1             SUBSTR(INWCFS,0,1) = '|';
      324    13194    1           IF MM$VCB.NOFILE THEN
      325    13195    1             SUBSTR(INWCFS,1,1) = '|';
      326    13196    1           IF MM$VCB.WRITE THEN
      327    13197    1             SUBSTR(INWCFS,2,1) = '|';
      328    13198    1           IF MM$VCB.CREATE THEN
      329    13199    1             SUBSTR(INWCFS,3,1) = '|';
      330    13200    1           IF MM$VCB.T.FRAGMENTED THEN
      331    13201    1             SUBSTR(INWCFS,4,1) = '|';
      332    13202    1           IF MM$VCB.T.SECTION THEN
      333    13203    1             SUBSTR(INWCFS,5,1) = '|';
      334    13204    1           PTBPGS = MM$VCB.NPGTPGS;
      335    13205    1           PTBSECT = MM$VCB.NPGTSECT;
      336    13206    1           UPGS = MM$VCB.UPGT#;
      337    13207    1           PCOUNT = MM$VCB.PPC;
      338    13208    1           PMAX = MM$VCB.PPMAX;
      339    13209    1           PMIN = MM$VCB.PPMIN;
      340    13210    1           CALL DAF$INIT(VSRPRT);
      341    13211    1           CALL DAF$ADDHDR(VSHDR);
      342    13212    1           CALL DAF$WRITE(VECTOR(VSSFMT1),VECTOR(WSQ#),VECTOR(VSG_DCB#),
      343    13213    1             VECTOR(VSG#),VECTOR(PCOUNT),VECTOR(PMIN),VECTOR(PMAX),
      344    13214    1             VECTOR(VSG#),VECTOR(PCOUNT),VECTOR(PMIN),VECTOR(PMAX),
      345    13215    1             VECTOR(INWCFS),VECTOR(PTBPGS),VECTOR(PTBSECT),VECTOR(UPGS));
      346    13216    1           VPMAX = MM$VCB.MAXVP#;
      347    13217    1           VPMAX_WRITTEN = MM$VCB.MAXVP_WRITTEN;
      348    13218    1           CHAIN_HEAD= MM$VCB.HEAD;
      349    13219    1           CHAIN_TAIL= MM$VCB.TAIL;
      350    13220    1           CALL DAF$ADDHDR(VSRPT1);
      351    13221    1           CALL DAF$WRITE(VECTOR(VSSFMT2),VECTOR(VPMAX),VECTOR(VPMAX_WRITTEN),
      352    13222    1             VECTOR(CHAIN_HEAD),VECTOR(CHAIN_TAIL));
      353    13223    1           CALL DAF$ADDHDR;
      354    13224    1           RETURN;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:12   
      355    13225        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:13   
      356    13226    1   DIPGCHAIN: PROC;
      357    13227    2           VPT$ = PINCRW(VPT$,16*1024*(VSG#-1));
      358    13228    2           DATAWRD = '0'B;
      359    13229    2           CALL DAF$INIT(VSPCRPT);
      360    13230    2           PCOUNT = 0;
      361    13231    2           NXT_VPNO = MM$VCB.HEAD;
      362    13232    2           VPNO = MM$VCB.HEAD;
      363    13233    2   SEARCH_CHAIN:
      364    13234    3           DO WHILE (NXT_VPNO ~= END_VP);
      365    13235    4             CALL GET_ENTRY(NXT_VPNO,VPNO,PPNO,DATAWRD(0),DATAWRD(1)) WHENALTRETURN DO;
      366    13236    4                   CALL DAF$WRITE(VECTOR(VSSFMT3),VECTOR(DATAWRD(0)),VECTOR(DATAWRD(1))
             13236                            );
      367    13237    4                   EXIT SEARCH_CHAIN;
      368    13238    4                 END;
      369    13239    4             CALL GET_ENTRY(NXT_VPNO,VPNO,PPNO,DATAWRD(2),DATAWRD(3)) WHENALTRETURN DO;
      370    13240    4                   CALL DAF$WRITE(VECTOR(VSSFMT3),VECTOR(DATAWRD(0)),VECTOR(DATAWRD(1))
             13240                            ,
      371    13241    4                     VECTOR(DATAWRD(2)),VECTOR(DATAWRD(3)));
      372    13242    4                   EXIT SEARCH_CHAIN;
      373    13243    4                 END;
      374    13244    3             CALL GET_ENTRY(NXT_VPNO,VPNO,PPNO,DATAWRD(4),DATAWRD(5));
      375    13245    3             CALL DAF$WRITE(VECTOR(VSSFMT3),VECTOR(DATAWRD(0)),VECTOR(DATAWRD(1)),
      376    13246    3               VECTOR(DATAWRD(2)),VECTOR(DATAWRD(3)),VECTOR(DATAWRD(4)),VECTOR(DATAWRD(
             13246                        5)));
      377    13247    3           END;
      378    13248    3           IF PCOUNT ~= MM$VCB.PPC THEN DO;
      379    13249    3                 NUM = MM$VCB.PPC;
      380    13250    3                 CALL DAF$WRITE(VECTOR(COUNT_ERR),VECTOR(NUM),VECTOR(PCOUNT));
      381    13251    3               END;
      382    13252    3           IF MM$VCB.TAIL ~= VPNO THEN DO;
      383    13253    3                 NUM = MM$VCB.TAIL;
      384    13254    3                 CALL DAF$WRITE(VECTOR(TAIL_ERR),VECTOR(NUM),VECTOR(VPNO));
      385    13255    3               END;
      386    13256    2   END DIPGCHAIN;
      387    13257        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:14   
      388    13258    1   GET_ENTRY: PROC(C,V,P,D1,D2) ALTRET;
      389    13259    2   DCL C SBIN WORD;
      390    13260    2   DCL D1 UBIN WORD;
      391    13261    2   DCL D2 UBIN WORD;
      392    13262    2   DCL P SBIN WORD;
      393    13263    2   DCL V SBIN WORD;
      394    13264
      395    13265    2           PCOUNT = PCOUNT + 1;
      396    13266    2           V = C;
      397    13267    2           IF C = MM$VCB.HEAD THEN
      398    13268    2             D1 = C;
      399    13269    2             ELSE
      400    13270    2             D1 = PPUT$->MM$PPUT.PPNO(P);
      401    13271    2           P = VPT$->B$MAP.RPN(V);
      402    13272    2           D2 = VPT$->B$PAGE.WRD(V);
      403    13273    2           C = PPUT$->MM$PPUT.PPNO(P);
      404    13274    2           IF C = END_VP THEN ALTRETURN;
      405    13275    2   END GET_ENTRY;
      406    13276        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:15   
      407    13277    1   DAD$CHECK_PPUT:ENTRY;
      408    13278    1           V_ = VECTOR(NIL);
      409    13279    1           VBASE(V_) = B$IS$;
      410    13280    1           VBOUND(V_) = 4*5096;
      411    13281    1           CALL DAS$SDSRCHPTR(NAME_FPPH,OUT$) ALTRET(ALT);
      412    13282    1           CALL DAM$MAP(OUT$,OUT$,0,%MONWSR,V_) ALTRET(ALT);
      413    13283    1           CALL DAM$MAP(B$PPUT$,PPUT$,0,%MONWSR) ALTRET(ALT);
      414    13284    1           CHAIN_HEAD =OUT$->B$WORD;
      415    13285    1           CHAIN_TAIL = PINCRW(OUT$,1)->B$WORD;
      416    13286    1           COUNT  = PINCRW(OUT$,2)->B$WORD;
      417    13287    1           CALL DAF$WRITE(VECTOR(PGOODFMT),VECTOR(CHAIN_HEAD),
      418    13288    1             VECTOR(CHAIN_TAIL),VECTOR(COUNT));
      419    13289    1           I = CHAIN_HEAD;
      420    13290    1           J = 0;
      421    13291    2           DO WHILE (PPUT$->MM$PPUT.PPNO (I) ~= 0);
      422    13292    2             J = J + 1;
      423    13293    2             I = PPUT$->MM$PPUT.PPNO(I);
      424    13294    2           END;
      425    13295    1           IF J ~= COUNT-1 THEN
      426    13296    1             CALL DAF$WRITE(VECTOR(PERRFMT),VECTOR(J),VECTOR(I));
      427    13297    1           RETURN;
      428    13298        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:16   
      429    13299    1   DAD$PPUT:ENTRY(TOP);
      430    13300        /*
      431    13301        **
      432    13302        **      Initialize some stuff.
      433    13303        */
      434    13304    1           PPUT_FLAG = '0'B;
      435    13305    1           UTB = '0'B;
      436    13306    1           PTB = '0'B;
      437    13307    1           V_ = VECTOR(NIL);
      438    13308    1           VBASE(V_) = B$IS$;
      439    13309    1           VBOUND(V_) = 5*4096;
      440    13310    2           IF TOP.NSUBLKS ~= 0 THEN DO;
      441    13311    3                 DO I = 0 TO TOP.NSUBLKS-1;
      442    13312    4                   DO CASE(TOP.SUBLK$(I)->OUT$BLK.CODE);
      443    13313    4                     CASE(1);
      444    13314    4                       PPUT_FLAG.SUMMARY = '1'B;
      445    13315    4                     CASE(2);
      446    13316    4                       PPUT_FLAG.PROCESSOR = '1'B;
      447    13317    4                     CASE(3);
      448    13318    4                       PPUT_FLAG.USER = '1'B;
      449    13319    4                     CASE(4);
      450    13320    4                       PPUT_FLAG.USAGE = '1'B;
      451    13321    4                   END;
      452    13322    3                 END;
      453    13323    2               END;
      454    13324    1             ELSE
      455    13325    1             PPUT_FLAG = '740'O;
      456    13326        /*
      457    13327        **
      458    13328        **      Run through PPUT looking at the flags.
      459    13329        */
      460    13330    1           CALL DAS$SDSRCHPTR(NAME_PCORE,OUT$) ALTRET (ALT);
      461    13331    1           CALL DAM$MAP (OUT$,OUT$,0,%MONWSR,V_) ALTRET (ALT);
      462    13332    1           PCORE = OUT$->B$WORD;
      463    13333    1           IF PCORE > %MAXP THEN CALL M$XXX;
      464    13334    1           USE$ = PINCRW(PR2$,AUTOFRAME.NEXT_FRAME - PR2_STRUC.WORD_OFFSET -1);
      465    13335    1           CALL DAD$FREXT(PCORE);
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:17   
      466    13336
      467    13337    1           CALL DAM$MAP(B$PPUT$,PPUT$,0,%MONWSR) ALTRET (ALT);
      468    13338
      469    13339    2           DO PPNO = 0 TO PCORE;
      470    13340    2             NUM = PPUT$->MM$PPUT.USER# (PPNO);
      471    13341    2             USE_TABLE(PPNO) = %UNKNOWN;
      472    13342    2             IF PPUT$->MM$PPUT.FREE(PPNO)
      473    13343    3               THEN DO;
      474    13344    3                   USE_TABLE(PPNO) = 'FREE';
      475    13345    3                   FREE# = FREE# + 1;
      476    13346    3                 END;
      477    13347    2               ELSE
      478    13348    2               IF PPUT$->MM$PPUT.IO(PPNO)
      479    13349    3                 THEN DO;
      480    13350    3                     USE_TABLE(PPNO) = 'I/O';
      481    13351    3                     IO# = IO# + 1;
      482    13352    3                   END;
      483    13353    2                 ELSE
      484    13354    2                 IF PPUT$->MM$PPUT.SUSPECT(PPNO)
      485    13355    3                   THEN DO;
      486    13356    3                       USE_TABLE(PPNO) = 'Susp';
      487    13357    3                       DIAG# = DIAG# + 1;
      488    13358    3                     END;
      489    13359    2                   ELSE
      490    13360    2                   IF PPUT$->MM$PPUT.BAD(PPNO)
      491    13361    3                     THEN DO;
      492    13362    3                         USE_TABLE(PPNO) = 'Bad';
      493    13363    3                         DIAG# = DIAG# + 1;
      494    13364    3                       END;
      495    13365    2                     ELSE
      496    13366    2                     IF PPUT$->MM$PPUT.IN_TEST(PPNO)
      497    13367    3                       THEN DO;
      498    13368    3                           USE_TABLE(PPNO) = 'Test';
      499    13369    3                           DIAG# = DIAG# + 1;
      500    13370    3                         END;
      501    13371    2                       ELSE
      502    13372    2                       IF PPUT$->MM$PPUT.USER(PPNO) AND NUM ~= 0
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:18   
      503    13373    3                         THEN DO;
      504    13374    3                             USE_TABLE(PPNO) = 'U';
      505    13375    3                             U# = U# + 1;
      506    13376    3                             UTB (NUM) = UTB (NUM) + 1;
      507    13377    3                             CALL BINCHAR(SUBSTR(USE_TABLE(PPNO),1,3),NUM);
      508    13378    3                             IF SUBSTR(USE_TABLE(PPNO),1,1)='0'
      509    13379    4                               THEN DO;
      510    13380    4                                   SUBSTR(USE_TABLE(PPNO),1,1)=' ';
      511    13381    4                                   IF SUBSTR(USE_TABLE(PPNO),2,1)='0'
      512    13382    4                                     THEN SUBSTR(USE_TABLE(PPNO),2,1)=' ';
      513    13383    4                                 END;
      514    13384    3                           END;
      515    13385    2                         ELSE
      516    13386    2                         IF PPUT$->MM$PPUT.PRC(PPNO)
      517    13387    3                           THEN DO;
      518    13388    3                               USE_TABLE(PPNO) = 'P';
      519    13389    3                               P# = P# + 1;
      520    13390    3                               PTB (NUM) = PTB (NUM) + 1;
      521    13391    3                               CALL BINCHAR(SUBSTR(USE_TABLE(PPNO),1,3),NUM);
      522    13392    3                               IF SUBSTR(USE_TABLE(PPNO),1,1)='0'
      523    13393    4                                 THEN DO;
      524    13394    4                                     SUBSTR(USE_TABLE(PPNO),1,1)=' ';
      525    13395    4                                     IF SUBSTR(USE_TABLE(PPNO),2,1)='0'
      526    13396    4                                       THEN SUBSTR(USE_TABLE(PPNO),2,1)=' ';
      527    13397    4                                   END;
      528    13398    3                             END;
      529    13399    2                           ELSE
      530    13400    2                           IF PPUT$->MM$PPUT.STOLEN(PPNO)
      531    13401    3                             THEN DO;
      532    13402    3                                 USE_TABLE(PPNO) = 'Stol';
      533    13403    3                                 STOLE# = STOLE# + 1;
      534    13404    3                               END;
      535    13405    2                             ELSE
      536    13406    2                             IF PPUT$->MM$PPUT.COMM(PPNO)
      537    13407    3                               THEN DO;
      538    13408    3                                   USE_TABLE(PPNO) = 'Comm';
      539    13409    3                                   COMM# = COMM# + 1;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:19   
      540    13410    3                                 END;
      541    13411    2                               ELSE
      542    13412    2                               IF PPUT$->MM$PPUT.USER#(PPNO) ~= 0
      543    13413    3                                 THEN DO;
      544    13414    3                                     USE_TABLE(PPNO) = 'SDS';
      545    13415    3                                     SDS# = SDS# + 1;
      546    13416    3                                   END;
      547    13417    2           END;
      548    13418        /*
      549    13419        **
      550    13420        **      Run the free chain to see if there are any problems.
      551    13421        **      Note: On a running system FREE# will not equal FREE_CH#, but
      552    13422        **            they should be close.
      553    13423        */
      554    13424    1           CALL DAS$SDSRCHPTR (NAME_FPPH,OUT$) ALTRET (ALT);
      555    13425    1           CALL DAM$MAP (OUT$,OUT$,0,%MONWSR,V_) ALTRET (ALT);
      556    13426    1           I = OUT$->B$WORD;
      557    13427    2           DO WHILE (I~=0);
      558    13428    3             IF USE_TABLE(I) ~= 'FREE' THEN DO;
      559    13429    4                   IF ~PPUT_FLAG.MISC THEN DO;
      560    13430    4                         CALL DAF$INIT(PMRPRT);
      561    13431    4                         PPUT_FLAG.MISC = '1'B;
      562    13432    4                       END;
      563    13433    3                   CALL DAF$WRITE( VECTOR(FNFFMT), VECTOR(I), VECTOR(USE_TABLE(I)));
      564    13434    3                 END;
      565    13435    2             USE_TABLE(I) = 'Free';
      566    13436    2             FREE_CH# = FREE_CH# + 1;
      567    13437    2             J = I;
      568    13438    2             I = PPUT$->MM$PPUT.PPNO(I);
      569    13439    2           END;
      570    13440        /*
      571    13441        **
      572    13442        **      Mark monitor overlay pages as such
      573    13443        */
      574    13444    1           CALL DAM$MAP(B$SEGTBL$,SEGTBL$,0,%MONWSR)
      575    13445    2             WHENRETURN DO;
      576    13446    3                 DO J = 0 TO 3;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:20   
      577    13447    3                   SEGP$ = PINCRW (SEGTBL$ , SEGTBL.NODES.WOFF (J));
      578    13448    3                   I = SEGTBL.NODES.WSIZ (J) - 1;
      579    13449    4                   DO UNTIL (I < 0);
      580    13450    4                     IF SEGPT.RPN(I)~=%FPMC
      581    13451    5                       THEN DO;
      582    13452    5                           USE_TABLE (SEGPT.RPN(I)) = 'Oly';
      583    13453    5                           CALL BINCHAR(SUBSTR(USE_TABLE(SEGPT.RPN(I)),3,1),J+1);
      584    13454    5                           MON# = MON# + 1;
      585    13455    5                         END;
      586    13456    4                     I = I - 1;
      587    13457    4                   END;
      588    13458    3                 END;
      589    13459    2               END;
      590    13460    2             WHENALTRETURN DO;
      591    13461    3                 IF ~PPUT_FLAG.MISC THEN DO;
      592    13462    3                       CALL DAF$INIT(PMRPRT);
      593    13463    3                       PPUT_FLAG.MISC = '1'B;
      594    13464    3                     END;
      595    13465    2                 CALL DAF$WRITE(VECTOR(NO_OVRLYS));
      596    13466    2               END;
      597    13467        /*
      598    13468        **
      599    13469        **      Go through the monitor map and mark stuff from it.
      600    13470        */
      601    13471    1           CALL DAM$MAP (B$MPT$, MPT$, 0, %MONWSR) ALTRET (ALT);
      602    13472    2           DO I = 0 TO 1023;
      603    13473    2             PPNO = MPT$->B$MAP.RPN(I);
      604    13474    2             IF PPNO~=%FPMC THEN IF USE_TABLE(PPNO) = %UNKNOWN
      605    13475    3                 THEN DO;
      606    13476    3                     IF %MOUSELO<=I AND I<=%MOUSEHI
      607    13477    4                       THEN DO;
      608    13478    4                           USE_TABLE(PPNO) ='MoUsE';
      609    13479    4                         END;
      610    13480    3                       ELSE
      611    13481    3                       IF %CFULO<=I AND I<=%CFUHI
      612    13482    4                         THEN DO;
      613    13483    4                             USE_TABLE(PPNO) = 'CFU';
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:21   
      614    13484    4                             MONDS# = MONDS# + 1;
      615    13485    4                           END;
      616    13486    3                         ELSE
      617    13487    3                         IF %ASAVELO<=I AND I<=%ASAVEHI
      618    13488    4                           THEN DO;
      619    13489    4                               USE_TABLE(PPNO)='Asave';
      620    13490    4                               MONDS# = MONDS# + 1;
      621    13491    4                             END;
      622    13492    3                           ELSE
      623    13493    3                           IF %ENQLO<=I AND I<=%ENQHI
      624    13494    4                             THEN DO;
      625    13495    4                                 USE_TABLE(PPNO)='ENQ';
      626    13496    4                                 MONDS# = MONDS# + 1;
      627    13497    4                               END;
      628    13498    3                             ELSE
      629    13499    3                             IF %LDCTLO<=I AND I<=%LDCTHI
      630    13500    4                               THEN DO;
      631    13501    4                                   USE_TABLE(PPNO)='LDCT';
      632    13502    4                                   MONDS# = MONDS# + 1;
      633    13503    4                                 END;
      634    13504    3                               ELSE
      635    13505    3                               IF %TIGRLO<=I AND I<=%TIGRHI
      636    13506    4                                 THEN DO;
      637    13507    4                                     USE_TABLE(PPNO)='TIGR';
      638    13508    4                                     TIGR# = TIGR# + 1;
      639    13509    4                                   END;
      640    13510    3                                 ELSE
      641    13511    3                                 IF %FIRMWREPG<=I AND I<=%FIRMWREHI
      642    13512    4                                   THEN DO;
      643    13513    4                                       USE_TABLE(PPNO)='Firm';
      644    13514    4                                       FIRM# = FIRM# + 1;
      645    13515    4                                     END;
      646    13516    3                                   ELSE
      647    13517    3                                   IF %MASTERPTPG<=I AND I<=%SLV7HJITPG
      648    13518    4                                     THEN DO;
      649    13519    4                                       END;
      650    13520    3                                     ELSE
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:22   
      651    13521    3                                     IF %ISEGLO<I AND I<=%ISEGHI
             13521                                              /* PAGE 0 SHOULD BE CXT */
      652    13522    4                                       THEN DO;
      653    13523    4                                           USE_TABLE(PPNO) = 'MON';
      654    13524    4                                           MON# = MON# + 1;
      655    13525    4                                         END;
      656    13526    3                                       ELSE
      657    13527    3                                       IF %REALLO<=I AND I<=%REALHI
      658    13528    4                                         THEN DO;
      659    13529    4                                             USE_TABLE(PPNO) = 'Real';
      660    13530    4                                             LOW# = LOW# + 1;
      661    13531    4                                           END;
      662    13532    3                                         ELSE
      663    13533    3                                         IF %SEGTBL=I
             13533                                                  /* ONLY ONE PAGE FOR OVERLAY TABLE */
      664    13534    4                                           THEN DO;
      665    13535    4                                               USE_TABLE(PPNO) = 'OlyT';
      666    13536    4                                               MON# = MON# + 1;
      667    13537    4                                             END;
      668    13538    4                                           ELSE DO;
      669    13539    4                                             END;
      670    13540    3                   END;
      671    13541    2           END;
      672    13542        /*
      673    13543        **
      674    13544        **      Cycle through cpus to get context. (cpu specific)
      675    13545        */
      676    13546    2           DO J = 0 TO 5;                  /* CYCLE THROUGH THE CPUS             */
      677    13547    2             CALL DAM$USECPU (J);
      678    13548    2             IF RUNNING
      679    13549    2               THEN
      680    13550    2               CALL DAM$MAP (CPUPT$(J),MPT$,0,%MONWSR) ALTRET (NEXT);
      681    13551    2               ELSE
      682    13552    2               CALL DAM$MAP(B$MPT$,MPT$,0,%MONWSR) ALTRET (NEXT);
      683    13553    3             DO I = 0 TO 1023;
      684    13554    3               PPNO = MPT$->B$MAP.RPN(I);
      685    13555    3               IF PPNO~=%FPMC THEN IF USE_TABLE(PPNO) = %UNKNOWN AND (%MASTERPTPG>I OR
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:23   
             13555                        I>%SLV7HJITPG) AND (%WINDOWLO>I OR I>%WINDOWHI)
      686    13556    4                   THEN DO;
      687    13557    4                       USE_TABLE(PPNO) = CPUNAME(J);
      688    13558    4                       IF %CGPGTBLLO<=I AND I<=%PGTBLHI THEN USE_TABLE(PPNO)='CGPT';
      689    13559    4                       MONCXT# = MONCXT# + 1;
      690    13560    4                     END;
      691    13561    3             END;
      692    13562    2   NEXT:   END;
      693    13563        /*
      694    13564        **
      695    13565        **      Mark pages used as for PPUT.
      696    13566        */
      697    13567    1           CALL DAM$USECPU(0);
      698    13568    1           CALL DAM$MAP (B$MONHJIT$, OUT$, 0, %MONWSR) ALTRET (ALT);
      699    13569    1           DWORD = OUT$->B$DWORDS(BITBIN(%PPUTSID&'1777'O));
      700    13570    1           J = DBASE(DESC)/4096;
      701    13571    1           K = J + DBOUND(DESC)/4096;
      702    13572    2           DO I = J TO K;
      703    13573    2             IF USE_TABLE(I) ~= %UNKNOWN THEN CALL M$XXX;
      704    13574    2             USE_TABLE(I) = 'PPUT';
      705    13575    2             PPUT# = PPUT# + 1;
      706    13576    2           END;
      707    13577        /*
      708    13578        **
      709    13579        **      See how many are "lost", and total up counts.
      710    13580        */
      711    13581    2           DO I = 0 TO PCORE;
      712    13582    2             IF USE_TABLE(I) = %UNKNOWN THEN LOST# = LOST# + 1;
      713    13583    2           END;
      714    13584
      715    13585    1           I=FREE#+IO#+DIAG#+U#+P#+STOLE#+COMM#+PPUT#+MONDS#+TIGR#+FIRM#+MON#+MONCXT#+
             13585                    SDS#+LOW#+LOST#;
      716    13586    1           J=PCORE+1;
      717    13587        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:24   
      718    13588        /*
      719    13589        **
      720    13590        **      Write summary.
      721    13591        */
      722    13592    1           IF ~PPUT_FLAG.SUMMARY THEN
      723    13593    1             GOTO DO_PROCESSOR;
      724    13594    1           CALL DAF$INIT(PSRPRT);
      725    13595    1           CALL DAF$WRITE(VECTOR(SUMFMT),
      726    13596    1             VECTOR(FREE#), VECTOR(FREE_CH#),
      727    13597    1             VECTOR(IO#),
      728    13598    1             VECTOR(DIAG#),
      729    13599    1             VECTOR(U#),
      730    13600    1             VECTOR(P#),
      731    13601    1             VECTOR(SDS#),
      732    13602    1             VECTOR(STOLE#),
      733    13603    1             VECTOR(COMM#),
      734    13604    1             VECTOR(PPUT#),
      735    13605    1             VECTOR(MONDS#),
      736    13606    1             VECTOR(TIGR#),
      737    13607    1             VECTOR(FIRM#),
      738    13608    1             VECTOR(MON#),
      739    13609    1             VECTOR(MONCXT#),
      740    13610    1             VECTOR(LOW#),
      741    13611    1             VECTOR(LOST#),
      742    13612    1             VECTOR(I),
      743    13613    1             VECTOR(J));
      744    13614        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:25   
      745    13615        /*
      746    13616        **
      747    13617        **      Write processor/user counts.
      748    13618        */
      749    13619    1   DO_PROCESSOR:
      750    13620    1           IF ~PPUT_FLAG.PROCESSOR THEN
      751    13621    1             GOTO DO_USER;
      752    13622    1           CALL DAF$INIT(PPRPRT);
      753    13623    2           DO I = 0 TO 509 BY 10;
      754    13624    2             K=0;
      755    13625    3             DO J = 0 TO 9;
      756    13626    3               K = K + PTB (I + J);
      757    13627    3             END;
      758    13628    2             IF K > 0
      759    13629    2               THEN
      760    13630    2               CALL DAF$WRITE(VECTOR (PUFMT) , VECTOR (I),
      761    13631    2                 VECTOR (PTB(I+0)),
      762    13632    2                 VECTOR (PTB(I+1)),
      763    13633    2                 VECTOR (PTB(I+2)),
      764    13634    2                 VECTOR (PTB(I+3)),
      765    13635    2                 VECTOR (PTB(I+4)),
      766    13636    2                 VECTOR (PTB(I+5)),
      767    13637    2                 VECTOR (PTB(I+6)),
      768    13638    2                 VECTOR (PTB(I+7)),
      769    13639    2                 VECTOR (PTB(I+8)),
      770    13640    2                 VECTOR (PTB(I+9)));
      771    13641    2           END;
      772    13642
      773    13643    1   DO_USER:
      774    13644    1           IF ~PPUT_FLAG.USER THEN
      775    13645    1             GOTO DO_USAGE;
      776    13646    1           CALL DAF$INIT(PURPRT);
      777    13647    2           DO I = 0 TO 509 BY 10;
      778    13648    2             K=0;
      779    13649    3             DO J = 0 TO 9;
      780    13650    3               K = K + UTB (I + J);
      781    13651    3             END;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:26   
      782    13652    2             IF K > 0
      783    13653    2               THEN
      784    13654    2               CALL DAF$WRITE(VECTOR (PUFMT) , VECTOR (I),
      785    13655    2                 VECTOR (UTB(I+0)),
      786    13656    2                 VECTOR (UTB(I+1)),
      787    13657    2                 VECTOR (UTB(I+2)),
      788    13658    2                 VECTOR (UTB(I+3)),
      789    13659    2                 VECTOR (UTB(I+4)),
      790    13660    2                 VECTOR (UTB(I+5)),
      791    13661    2                 VECTOR (UTB(I+6)),
      792    13662    2                 VECTOR (UTB(I+7)),
      793    13663    2                 VECTOR (UTB(I+8)),
      794    13664    2                 VECTOR (UTB(I+9)));
      795    13665    2           END;
      796    13666        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:27   
      797    13667        /*
      798    13668        **
      799    13669        **      Format PPUT itself.
      800    13670        */
      801    13671    1   DO_USAGE:
      802    13672    1           IF ~PPUT_FLAG.USAGE THEN
      803    13673    1             RETURN;
      804    13674    1           CALL DAF$INIT(PUSRPRT);
      805    13675    2           DO J = 0 TO PCORE BY 8;
      806    13676    2             CALL DAF$WRITE(VECTOR(PPUTFMT),VECTOR(J),
      807    13677    2               VECTOR(USE_TABLE(J)),
      808    13678    2               VECTOR(USE_TABLE(J+1)),
      809    13679    2               VECTOR(USE_TABLE(J+2)),
      810    13680    2               VECTOR(USE_TABLE(J+3)),
      811    13681    2               VECTOR(USE_TABLE(J+4)),
      812    13682    2               VECTOR(USE_TABLE(J+5)),
      813    13683    2               VECTOR(USE_TABLE(J+6)),
      814    13684    2               VECTOR(USE_TABLE(J+7)));
      815    13685    2           END;
      816    13686        /*
      817    13687        **
      818    13688        **      Done.
      819    13689        */
      820    13690    1           CALL DAD$FRREL;
      821    13691    1           RETURN;
      822    13692
      823    13693    1   ALT:    CALL M$ERR;
      824    13694        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:28   
      825    13695    1   SETUP:  PROC ALTRET;
      826    13696    2           CALL DAA$VALUE(TOP.SUBLK$(0)->OUT$BLK,VSG#);
      827    13697    2           CALL DAA$VALUE(TOP.SUBLK$(1)->OUT$BLK,USER,TEMP);
      828    13698    2           IF TEMP ~= 8 THEN
      829    13699    2             DA_CUN = -USER;
      830    13700    2             ELSE
      831    13701    2             DA_CUN = USER;
      832    13702    3           CALL DAM$MAP(B$ROS$,ROS$,-DA_CUN,%USERWSR) WHENALTRETURN DO;
      833    13703    3                 ALTRETURN;
      834    13704    3               END;
      835    13705    3           CALL DAM$MAP(ROS$->B$ROSEG.DCBPTR$,DCBPTR$,-DA_CUN,%USERWSR) WHENALTRETURN
             13705                    DO;
      836    13706    3                 ALTRETURN;
      837    13707    3               END;
      838    13708    3           CALL DAM$MAP(B$JIT$,JIT$,-DA_CUN,%USERWSR) WHENALTRETURN DO;
      839    13709    3               END;
      840    13710    2           VSG_DCB# = JIT$->B$JIT.VIRTUAL.DCB#(VSG#-1);
      841    13711    3           CALL DAM$MAP(DCBPTR$->DCBTAB$(VSG_DCB#),DCB$,-DA_CUN,%USERWSR) WHENALTRETURN
             13711                    DO;
      842    13712    3                 ALTRETURN;
      843    13713    3               END;
      844    13714    3           CALL DAM$MAP(DCB$->F$DCB.SETSTA$,VCB$,-DA_CUN,%USERWSR) WHENALTRETURN DO;
      845    13715    3                 ALTRETURN;
      846    13716    3               END;
      847    13717    2   END SETUP;
      848    13718    1   END DAD$VSCHECK;

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:29   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   DA_PERR_C.:E05TOU  is referenced.
   DA_SYMBOLS_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_TEXTC_C.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DAD$VSCHECK.

   Procedure DAD$VSCHECK requires 2081 words for executable code.
   Procedure DAD$VSCHECK requires 542 words of local(AUTO) storage.

    No errors detected in file DAD$VSCHECK.:E05TSI    .

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:30   

 Object Unit name= DAD$VSCHECK                                File name= DAD$VSCHECK.:E05TOU
 UTS= JUL 29 '97 12:48:47.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   400    620  DAD$VSCHECK
    2  RoData even  UTS    218    332  DAD$VSCHECK
    3   Proc  even  none  2081   4041  DAD$VSCHECK
    4  RoData even  none   154    232  DAD$VSCHECK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  DAD$VSCHECK
     3     36                  yes      Std        1  DAD$VCB
     3   1115                  yes      Std        0  DAD$CHECK_PPUT
     3   1302                  yes      Std        1  DAD$PPUT
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:31   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       5 DAM$MAP
         yes           Std       1 DAF$ADDHDR
 yes     yes           Std       2 DAS$SDSRCHPTR
         yes           Std       0 DAD$FRREL
         yes           Std       1 DAD$FREXT
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std       1 DAM$USECPU
 yes     yes           Std       3 DAA$VALUE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  DA_CUN                                DAF$WRITE
     B$IS$                                 B$JIT$                                B$PPUT$
     B$MPT$                                B$ROS$                                B$SEGTBL$
     B$MONHJIT$                            B$VPT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:32   


        1        1        /*M* DAD$VSCHECK - Virtual segment and PPUT checker             */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*T*/
        8        8        /*X* PLM=8,IND=2,THI=2,ENU=2,CSU=2,DTI=4,DCI=4,ECU=4, AND */
        9        9        /*P*  NAME:         DAD$VSCHECK
       10       10              PURPOSE:      This module contains the routines used to implement
       11       11                            the virtual segment and PPUT commands.
       12       12              DESCRIPTION:  This module contains two external routines for dump
       13       13                            a virtual segment's page table and dumping various
       14       14                            PPUT displays.  The commands for these routines are:
       15       15                              VSCHECK segnum using userid
       16       16                              PPUT
       17       17        */
       18       18        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:33   
       19       19        DAD$VSCHECK: PROC (TOP) MATERIALIZE($PR2 IN PR2$);

     19  3 000000   000000 700200 xent  DAD$VSCHECK  TSX0  ! X66_AUTO_1
         3 000001   001036 000001                    ZERO    542,1
         3 000002   200036 452700                    STP2  ! PR2$,,AUTO

       20       20        /* Includes */
       21       21        %INCLUDE B$JIT;
       22      624        %INCLUDE B$MAP;
       23      723        %INCLUDE B$ROSEG;
       24      786        %INCLUDE B_STRINGS_C;
       25      915        %INCLUDE B_SEGIDS_C;
       26     1454        %INCLUDE CP_6;
       27     7013        %INCLUDE CP_6_SUBS;
       28     7553        %INCLUDE DA_ANLZ_R;
       29     7566        %INCLUDE DA_MAP_R;
       30     7596        %INCLUDE DA_TEXTC_C;
       31     7627        %INCLUDE DA_SYMBOLS_R;
       32     7640        %INCLUDE DA_PERR_C;
       33     7704        %INCLUDE DA_FORMAT_C;
       34     7946        %INCLUDE DA_CMD_C;
       35     8295        %INCLUDE M_INFO_C;
       36     8435        %INCLUDE MM$SYSGEN;
       37     8460        %INCLUDE XU_MACRO_C;
       38    11566
       39    11567        /* Entries      */
       40    11568    1   DCL DAA$NXTUSR ENTRY(1) ALTRET;
       41    11569    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       42    11570    1   DCL DAD$FREXT ENTRY(1);
       43    11571    1   DCL DAD$FRREL ENTRY;
       44    11572    1   DCL DAF$ADDHDR ENTRY(1) ;
       45    11573    1   DCL DAF$INIT ENTRY(1) ALTRET;
       46    11574    1   DCL DAF$WRITE EPTR SYMREF;
       47    11575    1   DCL DAM$MAP ENTRY(5) ALTRET;
       48    11576    1   DCL DAM$USECPU ENTRY(1) ALTRET;
       49    11577    1   DCL DAS$SDSRCHPTR ENTRY(2) ALTRET;
       50    11578        /* Parameters */
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:34   
       51    11579
       52    11580        /* Symref */
       53    11581    1   DCL B$IS$ PTR SYMREF;
       54    11582    1   DCL B$JIT$ PTR SYMREF;
       55    11583    1   DCL B$PPUT$ PTR SYMREF;
       56    11584    1   DCL B$MPT$ PTR SYMREF;
       57    11585    1   DCL   B$ROS$ PTR SYMREF;
       58    11586    1   DCL B$SEGTBL$ PTR SYMREF;
       59    11587    1   DCL B$MONHJIT$ PTR SYMREF;
       60    11588    1   DCL B$VPT$ SYMREF PTR;
       61    11589        %PARSE$OUT (NAME=TOP,STCLASS=" ");
       62    11634
       63    11635        /* EQUs  */
       64    11636        %EQU MAXP=65536;
       65    11637        %EQU UNKNOWN='####';
       66    11638        /* Based   */
       67    11639
       68    11640        %F$DCB;
       69    11697        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED");
       70    11742    1   DCL 1 AUTOFRAME BASED(PR2$),
       71    11743    1         2 RETADR UBIN HALF HALIGNED,
       72    11744    1         2 PREV_FRAME UBIN HALF HALIGNED,
       73    11745    1         2 FRAME_EXT UBIN HALF HALIGNED,
       74    11746    1         2 LANG_IDENT UBIN HALF HALIGNED,
       75    11747    1         2 NEXT_FRAME UBIN HALF HALIGNED,
       76    11748    1         2 ENT_LOC UBIN HALF HALIGNED;
       77    11749    1   DCL B$WORD SBIN BASED;
       78    11750    1   DCL B$DWORDS(0:0) BIT(72) DALIGNED BASED;
       79    11751    1   DCL DCBTAB$(0:0) PTR BASED ALIGNED;
       80    11752    1   DCL 1 MM$PPUT(0:0) BASED ALIGNED,
       81    11753    1         2 SUSPECT BIT(1) UNAL,            /* PAGE SUSPECTED OF BEING BAD        */
       82    11754    1         2 BAD BIT(1) UNAL,                /* PAGE IS BAD & REMOVED FROM USE     */
       83    11755    1         2 IN_TEST BIT(1) UNAL,            /* BAD PAGE WHICH IS BEING TESTED     */
       84    11756    1         2 FREE BIT(1) UNAL,               /* THIS IS A FREE PAGE                */
       85    11757    1         2 USER BIT(1) UNAL,               /* PAGE BELONGS TO USER               */
       86    11758    1         2 IO BIT(1) UNAL,                 /* PAGE BELONGS TO IO                 */
       87    11759    1         2 PRC BIT(1) UNAL,                /* PAGE BELONGS TO PROCESSOR          */
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:35   
       88    11760    1         2 STOLEN BIT(1) UNAL,
       89    11761    1         2 COMM BIT(1) UNAL,
       90    11762    1         2 USER# UBIN(9) CALIGNED,
       91    11763    1         2 PNUM REDEF USER# UBIN(9) CALIGNED,
       92    11764    1         2 PPNO UBIN(18) HALIGNED;    /* PHYSICAL PAGE NUMBER OF NXT IN CHAIN    */
       93    11765    1   DCL 1 M$PPUT BASED ALIGNED,
       94    11766    1         2 WRD(0:0) UBIN(36);
       95    11767    1   DCL 1 MM$VCB BASED(VCB$),               /* Must match VLP_VIRTUAL             */
       96    11768    1         2 INITIALIZE BIT(1) UNAL,         /* Page should be initilized          */
       97    11769    1         2 NOFILE BIT(1) UNAL,             /* No file specified                  */
       98    11770    1         2 WRITE BIT(1) UNAL,              /* User has write access              */
       99    11771    1         2 CREATE BIT(1) UNAL,             /* File is being created              */
      100    11772    1         2 T,                              /* Similar to the T field in WSPTD    */
      101    11773    1           3 FRAGMENTED BIT(1) UNAL,       /* Fragemented page table             */
      102    11774    1           3 SECTION BIT(1) UNAL,          /* Section page table used            */
      103    11775    1         2 * BIT(3) UNAL,
      104    11776    1         2 WSQ UBIN(9) CALIGNED,           /* WSQ for this area                  */
      105    11777    1         2 DCB# UBIN(9) CALIGNED,
      106    11778    1         2 SEGNUM UBIN(9) CALIGNED,        /* SEGNUM for this area               */
      107    11779    1         2 INITVALUE UBIN WORD ALIGNED,    /* Initialization value               */
      108    11780    1         2 MAXVP# UBIN ALIGNED,            /* Maximum legal virtual page         */
      109    11781    1         2 PPMAX UBIN HALF HALIGNED,       /* Physical pages maximum             */
      110    11782    1         2 PPMIN UBIN HALF HALIGNED,       /* Physical pages minimum             */
      111    11783    1         2 PTR$ PTR ALIGNED,               /* Pointer to virtual area            */
      112    11784    1         2 WSPTD ALIGNED,                  /* WSPTD value for the LVA            */
      113    11785    1           3 BLKNO UBIN HALF UNAL,         /* Mod 64 or 1024 address of PT       */
      114    11786    1           3 Q BIT (2),                    /* WSQ access control                 */
      115    11787    1           3 P BIT (1),                    /* Page Table Present                 */
      116    11788    1           3 T BIT (2),                    /* Type of PT (0 = dense, 2 = frag    */
      117    11789    1           3 * BIT (1),
      118    11790    1           3 NBLKS UBIN (12) UNAL,         /* Number of 64 word blocks           */
      119    11791    1         2 HEAD SBIN ALIGNED,              /* Head of page chain                 */
      120    11792    1         2 TAIL SBIN ALIGNED,              /* Tail of page chain                 */
      121    11793    1         2 MAXVP_WRITTEN UBIN,             /* Maximun VP written                 */
      122    11794    1         2 PPC UBIN HALF HALIGNED,         /* Physical pages current             */
      123    11795    1         2 NPGTSECT UBIN HALF HALIGNED,    /* Pg# used for the section           */
      124    11796    1         2 NPGTPGS UBIN,                   /* Number of pages needed for PT      */
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:36   
      125    11797    1         2 UPGT# UBIN HALF UNAL,           /* Page tables in use (section)       */
      126    11798    1         2 * UBIN HALF UNAL;               /* Spare                              */
      127    11799    1   DCL USE_TABLE(0:1) CHAR(4) BASED(USE$);
      128    11800
      129    11801        /* Auto  */
      130    11802
      131    11803    1   DCL CHAIN_HEAD SBIN WORD;
      132    11804    1   DCL CHAIN_TAIL SBIN WORD;
      133    11805    1   DCL COUNT UBIN WORD;
      134    11806    1   DCL CUR_VPNO SBIN WORD;
      135    11807    1   DCL DATAWRD(0:5) UBIN WORD;
      136    11808    1   DCL DWORD BIT(72) DALIGNED;
      137    11809    1   DCL DESC REDEF DWORD DSCR;
      138    11810    1   DCL DCB$ PTR;
      139    11811    1   DCL DCBPTR$ PTR;
      140    11812    1   DCL I SBIN WORD;
      141    11813    1   DCL INWCFS CHAR(6) ;
      142    11814    1   DCL J UBIN WORD;
      143    11815    1   DCL JIT$ PTR STATIC;
      144    11816    1   DCL K UBIN WORD;
      145    11817    1   DCL NUM UBIN;
      146    11818    1   DCL NXT_VPNO SBIN WORD;
      147    11819    1   DCL PCORE UBIN;
      148    11820    1   DCL PCOUNT SBIN WORD;
      149    11821    1   DCL PMAX SBIN WORD;
      150    11822    1   DCL PMIN SBIN WORD;
      151    11823    1   DCL PPNO SBIN WORD;
      152    11824    1   DCL   PR2$ PTR;
      153    11825    1   DCL 1 PR2_STRUC REDEF PR2$,
      154    11826    1         2 WORD_OFFSET UBIN HALF UNAL,
      155    11827    1         2 * UBIN HALF UNAL;
      156    11828    1   DCL PTBPGS SBIN WORD;
      157    11829    1   DCL PTBSECT SBIN WORD;
      158    11830    1   DCL PTB(0:511) UBIN BYTE CALIGNED;
      159    11831    1   DCL ROS$ PTR STATIC;
      160    11832    1   DCL RUNNING BIT(1) ALIGNED;
      161    11833    1   DCL SEGP$ PTR;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:37   
      162    11834    1   DCL   TEMP SBIN WORD;
      163    11835    1   DCL   USE$ PTR;
      164    11836    1   DCL   USER SBIN WORD;
      165    11837    1   DCL UTB(0:511) UBIN HALF HALIGNED;
      166    11838    1   DCL  UPGS SBIN WORD;
      167    11839    1   DCL   VPMAX SBIN WORD;
      168    11840    1   DCL   VPMAX_WRITTEN SBIN WORD;
      169    11841    1   DCL VPNO SBIN WORD;
      170    11842    1   DCL VPT$ PTR;
      171    11843    1   DCL VSG# SBIN WORD;
      172    11844    1   DCL VSG_DCB# SBIN WORD;
      173    11845    1   DCL V_ VECTOR;
      174    11846    1   DCL VCB$ PTR;
      175    11847    1   DCL   WSQ# SBIN WORD;
      176    11848    1   DCL 1 SEGPT (0:0) ALIGNED BASED (SEGP$),
      177    11849    1         2 RPN UBIN(18) UNAL,
      178    11850    1         2 * BIT (18) UNAL;
      179    11851        /* Constants */
      180    11852    1   DCL COUNT_ERR CHAR(0) CONSTANT INIT(
      181    11853    1   ' PAGE COUNT ERROR - (M$VCB.PCOUNT = %6D, ACTUAL PCOUNT = %6D)');
      182    11854    1   DCL TAIL_ERR CHAR(0) CONSTANT INIT(
      183    11855    1   'CHAIN ERROR - (MM$VCB.TAIL = %6D, ACTUAL TAIL = %6D)');
      184    11856    1   DCL   END_VP SBIN WORD CONSTANT INIT(BITBIN('777777'O));
      185    11857        %REPORT (TITLE='VIRTUAL SEGMENT SUMMARY',NAME=VSRPRT,TRUNC=YES,
      186    11858                 HEADER=NO);
      187    11924        %HEADER (LAST=NO,NAME=VSHDR,TEXT=
      188    11925        '  WSQ  DCB  SEGNUM  PPCOUNT   PPMIN   PPMAX  INWCFS  PGTPGS  PGTSECT    UPGT');
      189    11967        %HEADER (TEXT=
      190    11968        '  ---  ---  ------  -------  ------  ------  ------  ------  -------  ------');
      191    12010    1   DCL VSSFMT1 CONSTANT CHAR(0) INIT(
      192    12011    1   '  %3+D  %3+D  %6+D  %7+D  %6+D  %6+D  %6A  %6+D  %7+D  %6+D');
      193    12012        %HEADER (LAST=NO,NAME=VSRPT1,TEXT=
      194    12013        '    MAXVP      MAXVP-WRIT  CHAIN HEAD  CHAIN TAIL');
      195    12055        %HEADER(TEXT=
      196    12056        '  ----------  -----------  ----------  ----------');
      197    12098    1   DCL   VSSFMT2 CHAR(0) CONSTANT INIT(
      198    12099    1   '  %10+D  %11+D  %10+D  %10+D');
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:38   
      199    12100        %REPORT (TITLE='VIRTUAL SEGMENT PAGE CHAIN',NAME=VSPCRPT,TRUNC=YES,
      200    12101                 HEADER=YES);
      201    12167        %HEADER (LAST=NO,TEXT=
      202    12168        ' VPAGE  PHYS. PAGE    VPAGE  PHYS. PAGE    VPAGE  PHYS. PAGE');
      203    12210        %HEADER (TEXT=
      204    12211        '------ ------------  ------ ------------  ------ ------------');
      205    12253    1   DCL    VSSFMT3 CHAR(0) CONSTANT INIT(
      206    12254    1   '%6D %12ZO  %6D %12ZO  %6D %12ZO');
      207    12255        %REPORT (TITLE='PPUT MISCELLANEOUS INFORMATION',NAME=PMRPRT,TRUNC=YES,HEADER=YES);
      208    12321        %HEADER(TEXT=' ');
      209    12363        %REPORT (TITLE='  ',NAME=PSRPRT,TRUNC=YES,HEADER=YES);
      210    12429        %HEADER(TEXT='SUMMARY INFORMATION');
      211    12471        %REPORT (TITLE=' ',NAME=PPRPRT,TRUNC=YES,HEADER=YES);
      212    12537        %HEADER(LAST=NO,TEXT='PROCESSORS');
      213    12579        %HEADER(LAST=NO,TEXT=
      214    12580        '           0      1      2      3      4      5      6      7      8      9');
      215    12622        %HEADER(TEXT=
      216    12623        '        ----   ----   ----   ----   ----   ----   ----   ----   ----   ----');
      217    12665        %REPORT (TITLE=' ',NAME=PURPRT,TRUNC=YES,HEADER=YES);
      218    12731        %HEADER(LAST=NO,TEXT='USERS');
      219    12773        %HEADER(LAST=NO,TEXT=
      220    12774        '           0      1      2      3      4      5      6      7      8      9');
      221    12816        %HEADER(TEXT=
      222    12817        '        ----   ----   ----   ----   ----   ----   ----   ----   ----   ----');
      223    12859        %REPORT (TITLE=' ',NAME=PUSRPRT,TRUNC=YES,HEADER=YES);
      224    12925        %HEADER(LAST=NO,TEXT='PHYSICAL PAGE USAGE');
      225    12967        %HEADER(LAST=NO,TEXT=
      226    12968        '            0      1      2      3      4      5      6      7');
      227    13010        %HEADER(TEXT=
      228    13011        '------   ----   ----   ----   ----   ----   ----   ----   ----');
      229    13053    1   DCL 1 CPUPT(0:5) CONSTANT,
      230    13054    1         2 * BIT(24) UNAL INIT('0'B*0),
      231    13055    1         2 * BIT(12) UNAL INIT(%MASTERPTSID, %SLV1PTSID, %SLV2PTSID, %SLV3PTSID, %
             13055                  SLV4PTSID, %SLV5PTSID);
      232    13056
      233    13057    1   DCL CPUPT$(0:5) REDEF CPUPT PTR;
      234    13058
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:39   
      235    13059
      236    13060
      237    13061    1   DCL CPUNAME(0:5) CHAR(4) CONSTANT INIT('Mstr','Slv1','Slv2','Slv3','Slv4','Slv5');
      238    13062
      239    13063    1   DCL 1 SUMFMT CONSTANT,
      240    13064    1         2 * CHAR(0) INIT('Free Pages%20-%6D (%6D)'),
      241    13065    1         2 * CHAR(0) INIT('%/I/O Cache%20-%6D'),
      242    13066    1         2 * CHAR(0) INIT('%/Diag%20-%6D'),
      243    13067    1         2 * CHAR(0) INIT('%/User Pages%20-%6D'),
      244    13068    1         2 * CHAR(0) INIT('%/Shared Proc%20-%6D'),
      245    13069    1         2 * CHAR(0) INIT('%/SDS%20-%6D'),
      246    13070    1         2 * CHAR(0) INIT('%/Stolen%20-%6D'),
      247    13071    1         2 * CHAR(0) INIT('%/Comm%20-%6D'),
      248    13072    1         2 * CHAR(0) INIT('%/PPUT%20-%6D'),
      249    13073    1         2 * CHAR(0) INIT('%/Monitor DS%20-%6D'),
      250    13074    1         2 * CHAR(0) INIT('%/TIGR%20-%6D'),
      251    13075    1         2 * CHAR(0) INIT('%/Firmware%20-%6D'),
      252    13076    1         2 * CHAR(0) INIT('%/Monitor%20-%6D'),
      253    13077    1         2 * CHAR(0) INIT('%/Monitor Context%20-%6D'),
      254    13078    1         2 * CHAR(0) INIT('%/Low Real%20-%6D'),
      255    13079    1         2 * CHAR(0) INIT('%/Lost%20-%6D'),
      256    13080    1         2 * CHAR(0) INIT('%/%/Total%20-%6D'),
      257    13081    1         2 * CHAR(0) INIT('%/%/Pcore%20-%6D');
      258    13082
      259    13083    1   DCL PUFMT CHAR(0) CONSTANT INIT('%5D%10(%7D%)');
      260    13084
      261    13085    1   DCL PPUTFMT CHAR(0) CONSTANT INIT('%6ZO   %8(%4A   %)');
      262    13086    1   DCL PERRFMT CHAR(0) CONSTANT INIT(
      263    13087    1   ' ERROR IN PPUT, # FOUND = %6D ERROR AT = %6D');
      264    13088    1   DCL PGOODFMT CHAR(0) CONSTANT INIT(
      265    13089    1   ' HEAD = %6D   TAIL = %6D    COUNT = %7D');
      266    13090
      267    13091    1   DCL NO_OVRLYS CHAR(0) CONSTANT INIT ('*** Monitor overlays not in dump');
      268    13092    1   DCL FNFFMT CHAR(0) CONSTANT INIT('*** Free page %6ZO marked as ''%4A''');
      269    13093        /* Static */
      270    13094    1   DCL FREE# UBIN STATIC INIT(0);
      271    13095    1   DCL FREE_CH# UBIN STATIC INIT(0);
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:40   
      272    13096    1   DCL IO# UBIN STATIC INIT(0);
      273    13097    1   DCL DIAG# UBIN STATIC INIT(0);
      274    13098    1   DCL U# UBIN STATIC INIT(0);
      275    13099    1   DCL P# UBIN STATIC INIT(0);
      276    13100    1   DCL SDS# UBIN STATIC INIT(0);
      277    13101    1   DCL STOLE# UBIN STATIC INIT(0);
      278    13102    1   DCL COMM# UBIN STATIC INIT(0);
      279    13103    1   DCL PPUT# UBIN STATIC INIT(0);
      280    13104    1   DCL 1 PPUT_FLAG STATIC,
      281    13105    1         2 SUMMARY BIT(1) UNAL INIT('0'B),
      282    13106    1         2 PROCESSOR BIT(1) UNAL INIT('0'B),
      283    13107    1         2 USER BIT(1) UNAL INIT('0'B),
      284    13108    1         2 USAGE BIT(1) UNAL INIT('0'B),
      285    13109    1         2 MISC BIT(1) UNAL INIT('0'B),
      286    13110    1         2 * BIT(4) UNAL INIT('0'B);
      287    13111    1   DCL MONDS# UBIN STATIC INIT(0);
      288    13112    1   DCL TIGR# UBIN STATIC INIT(0);
      289    13113    1   DCL FIRM# UBIN STATIC INIT(0);
      290    13114    1   DCL MON# UBIN STATIC INIT(0);
      291    13115    1   DCL MONCXT# UBIN STATIC INIT(0);
      292    13116    1   DCL LOW# UBIN STATIC INIT(0);
      293    13117    1   DCL LOST# UBIN STATIC INIT(0);
      294    13118    1   DCL OUT$ PTR STATIC;
      295    13119    1   DCL MPT$ PTR STATIC;
      296    13120    1   DCL PPUT$ PTR STATIC;
      297    13121    1   DCL SEGTBL$ PTR STATIC;
      298    13122    1   DCL 1 SEGTBL ALIGNED BASED (SEGTBL$),
      299    13123    1         2 * UBIN,
      300    13124    1         2 NODES (0:0) ALIGNED,
      301    13125    1           3 WOFF UBIN(16) HALIGNED,
      302    13126    1           3 WSIZ UBIN(16) HALIGNED;
      303    13127
      304    13128
      305    13129        %TEXTC (NAME=NAME_PCORE,TEXT='MM_PCORE');
      306    13153        %TEXTC (NAME=NAME_FPPH,TEXT='MM_FPPH');
      307    13177        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:41   
      308    13178    1           CALL SETUP;

  13178  3 000003   003652 701000 3                  TSX1    SETUP
         3 000004   000000 011000                    NOP     0

      309    13179    2           CALL DAM$MAP(B$PPUT$,PPUT$,0,%MONWSR) WHENALTRETURN DO;

  13179  3 000005   000000 630400 4                  EPPR0   0
         3 000006   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000007   000000 701000 xent               TSX1    DAM$MAP
         3 000010   000012 702000 3                  TSX2    s:13180
         3 000011   000013 710000 3                  TRA     s:13182

      310    13180    2                 RETURN;

  13180  3 000012   000000 702200 xent               TSX2  ! X66_ARET

      311    13181    2               END;
      312    13182    2           CALL DAM$MAP(B$VPT$,VPT$,-DA_CUN,%MONWSR) WHENALTRETURN DO;

  13182  3 000013   000000 335000 xsym               LCA     DA_CUN
         3 000014   200672 755100                    STA     @D2+1,,AUTO
         3 000015   000002 236000 4                  LDQ     2
         3 000016   200677 756100                    STQ     @D2+6,,AUTO
         3 000017   200672 630500                    EPPR0   @D2+1,,AUTO
         3 000020   200676 450500                    STP0    @D2+5,,AUTO
         3 000021   200652 631500                    EPPR1   VPT$,,AUTO
         3 000022   200675 451500                    STP1    @D2+4,,AUTO
         3 000023   000004 236000 4                  LDQ     4
         3 000024   200674 756100                    STQ     @D2+3,,AUTO
         3 000025   200674 630500                    EPPR0   @D2+3,,AUTO
         3 000026   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000027   000000 701000 xent               TSX1    DAM$MAP
         3 000030   000032 702000 3                  TSX2    s:13183
         3 000031   000033 710000 3                  TRA     s:13185

      313    13183    2                 RETURN;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:42   

  13183  3 000032   000000 702200 xent               TSX2  ! X66_ARET

      314    13184    2               END;
      315    13185    1           CALL DIPGCHAIN;

  13185  3 000033   000442 701000 3                  TSX1    DIPGCHAIN
         3 000034   000000 011000                    NOP     0

      316    13186    1           RETURN;

  13186  3 000035   000000 702200 xent               TSX2  ! X66_ARET

      317    13187        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:43   
      318    13188    1   DAD$VCB: ENTRY(TOP);

  13188  3 000036   000000 700200 xent  DAD$VCB      TSX0  ! X66_AUTO_1
         3 000037   001036 000001                    ZERO    542,1
         3 000040   200036 452700                    STP2  ! PR2$,,AUTO

      319    13189    1           CALL SETUP;

  13189  3 000041   003652 701000 3                  TSX1    SETUP
         3 000042   000000 011000                    NOP     0

      320    13190    1           WSQ# = MM$VCB.WSQ;

  13190  3 000043   200660 470500                    LDP0    VCB$,,AUTO
         3 000044   000000 236100                    LDQ     0,,PR0
         3 000045   000022 772000                    QRL     18
         3 000046   000777 376007                    ANQ     511,DL
         3 000047   200661 756100                    STQ     WSQ#,,AUTO

      321    13191    1           INWCFS = ' ';

  13191  3 000050   040100 100400                    MLR     fill='040'O
         3 000051   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000052   200023 000006                    ADSC9   INWCFS,,AUTO             cn=0,n=6

      322    13192    1           IF MM$VCB.INITIALIZE THEN

  13192  3 000053   000000 234100                    SZN     0,,PR0
         3 000054   000057 605000 3                  TPL     s:13194

      323    13193    1             SUBSTR(INWCFS,0,1) = '|';

  13193  3 000055   174000 236003                    LDQ     63488,DU
         3 000056   200023 552140                    STBQ    INWCFS,'40'O,AUTO

      324    13194    1           IF MM$VCB.NOFILE THEN

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:44   
  13194  3 000057   000000 236100                    LDQ     0,,PR0
         3 000060   200000 316003                    CANQ    65536,DU
         3 000061   000064 600000 3                  TZE     s:13196

      325    13195    1             SUBSTR(INWCFS,1,1) = '|';

  13195  3 000062   000174 236003                    LDQ     124,DU
         3 000063   200023 552120                    STBQ    INWCFS,'20'O,AUTO

      326    13196    1           IF MM$VCB.WRITE THEN

  13196  3 000064   000000 236100                    LDQ     0,,PR0
         3 000065   100000 316003                    CANQ    32768,DU
         3 000066   000071 600000 3                  TZE     s:13198

      327    13197    1             SUBSTR(INWCFS,2,1) = '|';

  13197  3 000067   174000 236007                    LDQ     63488,DL
         3 000070   200023 552110                    STBQ    INWCFS,'10'O,AUTO

      328    13198    1           IF MM$VCB.CREATE THEN

  13198  3 000071   000000 236100                    LDQ     0,,PR0
         3 000072   040000 316003                    CANQ    16384,DU
         3 000073   000076 600000 3                  TZE     s:13200

      329    13199    1             SUBSTR(INWCFS,3,1) = '|';

  13199  3 000074   000174 236007                    LDQ     124,DL
         3 000075   200023 552104                    STBQ    INWCFS,'04'O,AUTO

      330    13200    1           IF MM$VCB.T.FRAGMENTED THEN

  13200  3 000076   000000 236100                    LDQ     0,,PR0
         3 000077   020000 316003                    CANQ    8192,DU
         3 000100   000103 600000 3                  TZE     s:13202

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:45   
      331    13201    1             SUBSTR(INWCFS,4,1) = '|';

  13201  3 000101   174000 236003                    LDQ     63488,DU
         3 000102   200024 552140                    STBQ    INWCFS+1,'40'O,AUTO

      332    13202    1           IF MM$VCB.T.SECTION THEN

  13202  3 000103   000000 236100                    LDQ     0,,PR0
         3 000104   010000 316003                    CANQ    4096,DU
         3 000105   000110 600000 3                  TZE     s:13204

      333    13203    1             SUBSTR(INWCFS,5,1) = '|';

  13203  3 000106   000174 236003                    LDQ     124,DU
         3 000107   200024 552120                    STBQ    INWCFS+1,'20'O,AUTO

      334    13204    1           PTBPGS = MM$VCB.NPGTPGS;

  13204  3 000110   000012 235100                    LDA     10,,PR0
         3 000111   200037 755100                    STA     PTBPGS,,AUTO

      335    13205    1           PTBSECT = MM$VCB.NPGTSECT;

  13205  3 000112   000011 236100                    LDQ     9,,PR0
         3 000113   777777 376007                    ANQ     -1,DL
         3 000114   200040 756100                    STQ     PTBSECT,,AUTO

      336    13206    1           UPGS = MM$VCB.UPGT#;

  13206  3 000115   000013 236100                    LDQ     11,,PR0
         3 000116   000022 772000                    QRL     18
         3 000117   200646 756100                    STQ     UPGS,,AUTO

      337    13207    1           PCOUNT = MM$VCB.PPC;

  13207  3 000120   000011 236100                    LDQ     9,,PR0
         3 000121   000022 772000                    QRL     18
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:46   
         3 000122   200032 756100                    STQ     PCOUNT,,AUTO

      338    13208    1           PMAX = MM$VCB.PPMAX;

  13208  3 000123   000003 236100                    LDQ     3,,PR0
         3 000124   000022 772000                    QRL     18
         3 000125   200033 756100                    STQ     PMAX,,AUTO

      339    13209    1           PMIN = MM$VCB.PPMIN;

  13209  3 000126   000003 236100                    LDQ     3,,PR0
         3 000127   777777 376007                    ANQ     -1,DL
         3 000130   200034 756100                    STQ     PMIN,,AUTO

      340    13210    1           CALL DAF$INIT(VSRPRT);

  13210  3 000131   000005 630400 4                  EPPR0   5
         3 000132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000133   000000 701000 xent               TSX1    DAF$INIT
         3 000134   000000 011000                    NOP     0

      341    13211    1           CALL DAF$ADDHDR(VSHDR);

  13211  3 000135   000006 630400 4                  EPPR0   6
         3 000136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000137   000000 701000 xent               TSX1    DAF$ADDHDR
         3 000140   000000 011000                    NOP     0

      342    13212    1           CALL DAF$WRITE(VECTOR(VSSFMT1),VECTOR(WSQ#),VECTOR(VSG_DCB#),
      343    13213    1             VECTOR(VSG#),VECTOR(PCOUNT),VECTOR(PMIN),VECTOR(PMAX),
      344    13214    1             VECTOR(VSG#),VECTOR(PCOUNT),VECTOR(PMIN),VECTOR(PMAX),

  13214  3 000141   777640 235007                    LDA     -96,DL
         3 000142   200672 452500                    STP2    @D2+1,,AUTO
         3 000143   200672 236100                    LDQ     @D2+1,,AUTO
         3 000144   000661 036003                    ADLQ    433,DU
         3 000145   200674 757100                    STAQ    @D2+3,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:47   
         3 000146   777640 235007                    LDA     -96,DL
         3 000147   200676 452500                    STP2    @D2+5,,AUTO
         3 000150   200676 236100                    LDQ     @D2+5,,AUTO
         3 000151   000654 036003                    ADLQ    428,DU
         3 000152   200700 757100                    STAQ    @D2+7,,AUTO
         3 000153   777640 235007                    LDA     -96,DL
         3 000154   200702 452500                    STP2    @D2+9,,AUTO
         3 000155   200702 236100                    LDQ     @D2+9,,AUTO
         3 000156   000653 036003                    ADLQ    427,DU
         3 000157   200704 757100                    STAQ    @D2+11,,AUTO
         3 000160   777640 235007                    LDA     -96,DL
         3 000161   200706 452500                    STP2    @D2+13,,AUTO
         3 000162   200706 236100                    LDQ     @D2+13,,AUTO
         3 000163   000032 036003                    ADLQ    26,DU
         3 000164   200710 757100                    STAQ    @D2+15,,AUTO
         3 000165   777640 235007                    LDA     -96,DL
         3 000166   200712 452500                    STP2    @D2+17,,AUTO
         3 000167   200712 236100                    LDQ     @D2+17,,AUTO
         3 000170   000034 036003                    ADLQ    28,DU
         3 000171   200714 757100                    STAQ    @D2+19,,AUTO
         3 000172   777640 235007                    LDA     -96,DL
         3 000173   200716 452500                    STP2    @D2+21,,AUTO
         3 000174   200716 236100                    LDQ     @D2+21,,AUTO
         3 000175   000033 036003                    ADLQ    27,DU
         3 000176   200720 757100                    STAQ    @D2+23,,AUTO
         3 000177   777640 235007                    LDA     -96,DL
         3 000200   200722 452500                    STP2    @D2+25,,AUTO
         3 000201   200722 236100                    LDQ     @D2+25,,AUTO
         3 000202   000653 036003                    ADLQ    427,DU
         3 000203   200724 757100                    STAQ    @D2+27,,AUTO
         3 000204   777640 235007                    LDA     -96,DL
         3 000205   200726 452500                    STP2    @D2+29,,AUTO
         3 000206   200726 236100                    LDQ     @D2+29,,AUTO
         3 000207   000032 036003                    ADLQ    26,DU
         3 000210   200730 757100                    STAQ    @D2+31,,AUTO
         3 000211   777640 235007                    LDA     -96,DL
         3 000212   200732 452500                    STP2    @D2+33,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:48   
         3 000213   200732 236100                    LDQ     @D2+33,,AUTO
         3 000214   000034 036003                    ADLQ    28,DU
         3 000215   200734 757100                    STAQ    @D2+35,,AUTO
         3 000216   777640 235007                    LDA     -96,DL
         3 000217   200736 452500                    STP2    @D2+37,,AUTO
         3 000220   200736 236100                    LDQ     @D2+37,,AUTO
         3 000221   000033 036003                    ADLQ    27,DU
         3 000222   200740 757100                    STAQ    @D2+39,,AUTO
         3 000223   000012 235000 4                  LDA     10
         3 000224   200742 452500                    STP2    @D2+41,,AUTO
         3 000225   200742 236100                    LDQ     @D2+41,,AUTO
         3 000226   000023 036003                    ADLQ    19,DU
         3 000227   200744 757100                    STAQ    @D2+43,,AUTO
         3 000230   777640 235007                    LDA     -96,DL
         3 000231   200746 452500                    STP2    @D2+45,,AUTO
         3 000232   200746 236100                    LDQ     @D2+45,,AUTO
         3 000233   000037 036003                    ADLQ    31,DU
         3 000234   200750 757100                    STAQ    @D2+47,,AUTO
         3 000235   777640 235007                    LDA     -96,DL
         3 000236   200752 452500                    STP2    @D2+49,,AUTO
         3 000237   200752 236100                    LDQ     @D2+49,,AUTO
         3 000240   000040 036003                    ADLQ    32,DU
         3 000241   200754 757100                    STAQ    @D2+51,,AUTO
         3 000242   777640 235007                    LDA     -96,DL
         3 000243   200756 452500                    STP2    @D2+53,,AUTO
         3 000244   200756 236100                    LDQ     @D2+53,,AUTO
         3 000245   000646 036003                    ADLQ    422,DU
         3 000246   200762 757100                    STAQ    @D2+57,,AUTO
         3 000247   200674 237100                    LDAQ    @D2+3,,AUTO
         3 000250   200760 757100                    STAQ    @D2+55,,AUTO
         3 000251   200700 237100                    LDAQ    @D2+7,,AUTO
         3 000252   200764 757100                    STAQ    @D2+59,,AUTO
         3 000253   200704 237100                    LDAQ    @D2+11,,AUTO
         3 000254   200766 757100                    STAQ    @D2+61,,AUTO
         3 000255   200710 237100                    LDAQ    @D2+15,,AUTO
         3 000256   200770 757100                    STAQ    @D2+63,,AUTO
         3 000257   200714 237100                    LDAQ    @D2+19,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:49   
         3 000260   200772 757100                    STAQ    @D2+65,,AUTO
         3 000261   200720 237100                    LDAQ    @D2+23,,AUTO
         3 000262   200774 757100                    STAQ    @D2+67,,AUTO
         3 000263   200724 237100                    LDAQ    @D2+27,,AUTO
         3 000264   200776 757100                    STAQ    @D2+69,,AUTO
         3 000265   200730 237100                    LDAQ    @D2+31,,AUTO
         3 000266   201000 757100                    STAQ    @D2+71,,AUTO
         3 000267   200734 237100                    LDAQ    @D2+35,,AUTO
         3 000270   201002 757100                    STAQ    @D2+73,,AUTO
         3 000271   200740 237100                    LDAQ    @D2+39,,AUTO
         3 000272   201004 757100                    STAQ    @D2+75,,AUTO
         3 000273   200744 237100                    LDAQ    @D2+43,,AUTO
         3 000274   201006 757100                    STAQ    @D2+77,,AUTO
         3 000275   200750 237100                    LDAQ    @D2+47,,AUTO
         3 000276   201010 757100                    STAQ    @D2+79,,AUTO
         3 000277   200754 237100                    LDAQ    @D2+51,,AUTO
         3 000300   201012 757100                    STAQ    @D2+81,,AUTO
         3 000301   200762 237100                    LDAQ    @D2+57,,AUTO
         3 000302   201014 757100                    STAQ    @D2+83,,AUTO
         3 000303   201014 630500                    EPPR0   @D2+83,,AUTO
         3 000304   201034 450500                    STP0    @D2+99,,AUTO
         3 000305   201012 631500                    EPPR1   @D2+81,,AUTO
         3 000306   201033 451500                    STP1    @D2+98,,AUTO
         3 000307   201010 633500                    EPPR3   @D2+79,,AUTO
         3 000310   201032 453500                    STP3    @D2+97,,AUTO
         3 000311   201006 634500                    EPPR4   @D2+77,,AUTO
         3 000312   201031 454500                    STP4    @D2+96,,AUTO
         3 000313   201004 635500                    EPPR5   @D2+75,,AUTO
         3 000314   201030 455500                    STP5    @D2+95,,AUTO
         3 000315   201002 636500                    EPPR6   @D2+73,,AUTO
         3 000316   201027 456500                    STP6    @D2+94,,AUTO
         3 000317   201000 637500                    EPPR7   @D2+71,,AUTO
         3 000320   201026 457500                    STP7    @D2+93,,AUTO
         3 000321   200776 630500                    EPPR0   @D2+69,,AUTO
         3 000322   201025 450500                    STP0    @D2+92,,AUTO
         3 000323   200774 630500                    EPPR0   @D2+67,,AUTO
         3 000324   201024 450500                    STP0    @D2+91,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:50   
         3 000325   200772 630500                    EPPR0   @D2+65,,AUTO
         3 000326   201023 450500                    STP0    @D2+90,,AUTO
         3 000327   200770 630500                    EPPR0   @D2+63,,AUTO
         3 000330   201022 450500                    STP0    @D2+89,,AUTO
         3 000331   200766 630500                    EPPR0   @D2+61,,AUTO
         3 000332   201021 450500                    STP0    @D2+88,,AUTO
         3 000333   200764 630500                    EPPR0   @D2+59,,AUTO
         3 000334   201020 450500                    STP0    @D2+87,,AUTO
         3 000335   200760 630500                    EPPR0   @D2+55,,AUTO
         3 000336   201017 450500                    STP0    @D2+86,,AUTO
         3 000337   000014 236000 4                  LDQ     12
         3 000340   201016 756100                    STQ     @D2+85,,AUTO
         3 000341   201016 630500                    EPPR0   @D2+85,,AUTO
         3 000342   000000 220000 xsym               LDX0    DAF$WRITE
         3 000343   000013 631400 4                  EPPR1   11
         3 000344   000000 701010                    TSX1    0,X0
         3 000345   000000 011000                    NOP     0

      345    13215    1             VECTOR(INWCFS),VECTOR(PTBPGS),VECTOR(PTBSECT),VECTOR(UPGS));
      346    13216    1           VPMAX = MM$VCB.MAXVP#;

  13216  3 000346   200660 470500                    LDP0    VCB$,,AUTO
         3 000347   000002 235100                    LDA     2,,PR0
         3 000350   200647 755100                    STA     VPMAX,,AUTO

      347    13217    1           VPMAX_WRITTEN = MM$VCB.MAXVP_WRITTEN;

  13217  3 000351   000010 235100                    LDA     8,,PR0
         3 000352   200650 755100                    STA     VPMAX_WRITTEN,,AUTO

      348    13218    1           CHAIN_HEAD= MM$VCB.HEAD;

  13218  3 000353   000006 235100                    LDA     6,,PR0
         3 000354   200004 755100                    STA     CHAIN_HEAD,,AUTO

      349    13219    1           CHAIN_TAIL= MM$VCB.TAIL;

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:51   
  13219  3 000355   000007 235100                    LDA     7,,PR0
         3 000356   200005 755100                    STA     CHAIN_TAIL,,AUTO

      350    13220    1           CALL DAF$ADDHDR(VSRPT1);

  13220  3 000357   000015 630400 4                  EPPR0   13
         3 000360   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000361   000000 701000 xent               TSX1    DAF$ADDHDR
         3 000362   000000 011000                    NOP     0

      351    13221    1           CALL DAF$WRITE(VECTOR(VSSFMT2),VECTOR(VPMAX),VECTOR(VPMAX_WRITTEN),

  13221  3 000363   777640 235007                    LDA     -96,DL
         3 000364   200672 452500                    STP2    @D2+1,,AUTO
         3 000365   200672 236100                    LDQ     @D2+1,,AUTO
         3 000366   000647 036003                    ADLQ    423,DU
         3 000367   200674 757100                    STAQ    @D2+3,,AUTO
         3 000370   777640 235007                    LDA     -96,DL
         3 000371   200676 452500                    STP2    @D2+5,,AUTO
         3 000372   200676 236100                    LDQ     @D2+5,,AUTO
         3 000373   000650 036003                    ADLQ    424,DU
         3 000374   200700 757100                    STAQ    @D2+7,,AUTO
         3 000375   777640 235007                    LDA     -96,DL
         3 000376   200702 452500                    STP2    @D2+9,,AUTO
         3 000377   200702 236100                    LDQ     @D2+9,,AUTO
         3 000400   000004 036003                    ADLQ    4,DU
         3 000401   200704 757100                    STAQ    @D2+11,,AUTO
         3 000402   777640 235007                    LDA     -96,DL
         3 000403   200706 452500                    STP2    @D2+13,,AUTO
         3 000404   200706 236100                    LDQ     @D2+13,,AUTO
         3 000405   000005 036003                    ADLQ    5,DU
         3 000406   200712 757100                    STAQ    @D2+17,,AUTO
         3 000407   200674 237100                    LDAQ    @D2+3,,AUTO
         3 000410   200710 757100                    STAQ    @D2+15,,AUTO
         3 000411   200700 237100                    LDAQ    @D2+7,,AUTO
         3 000412   200714 757100                    STAQ    @D2+19,,AUTO
         3 000413   200704 237100                    LDAQ    @D2+11,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:52   
         3 000414   200716 757100                    STAQ    @D2+21,,AUTO
         3 000415   200712 237100                    LDAQ    @D2+17,,AUTO
         3 000416   200720 757100                    STAQ    @D2+23,,AUTO
         3 000417   200720 630500                    EPPR0   @D2+23,,AUTO
         3 000420   200726 450500                    STP0    @D2+29,,AUTO
         3 000421   200716 631500                    EPPR1   @D2+21,,AUTO
         3 000422   200725 451500                    STP1    @D2+28,,AUTO
         3 000423   200714 633500                    EPPR3   @D2+19,,AUTO
         3 000424   200724 453500                    STP3    @D2+27,,AUTO
         3 000425   200710 634500                    EPPR4   @D2+15,,AUTO
         3 000426   200723 454500                    STP4    @D2+26,,AUTO
         3 000427   000020 236000 4                  LDQ     16
         3 000430   200722 756100                    STQ     @D2+25,,AUTO
         3 000431   200722 630500                    EPPR0   @D2+25,,AUTO
         3 000432   000000 220000 xsym               LDX0    DAF$WRITE
         3 000433   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000434   000000 701010                    TSX1    0,X0
         3 000435   000000 011000                    NOP     0

      352    13222    1             VECTOR(CHAIN_HEAD),VECTOR(CHAIN_TAIL));
      353    13223    1           CALL DAF$ADDHDR;

  13223  3 000436   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000437   000000 701000 xent               TSX1    DAF$ADDHDR
         3 000440   000000 011000                    NOP     0

      354    13224    1           RETURN;

  13224  3 000441   000000 702200 xent               TSX2  ! X66_ARET

      355    13225        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:53   
      356    13226    1   DIPGCHAIN: PROC;

  13226  3 000442   200662 741300       DIPGCHAIN    STX1  ! WSQ#+1,,AUTO

      357    13227    2           VPT$ = PINCRW(VPT$,16*1024*(VSG#-1));

  13227  3 000443   200653 236100                    LDQ     VSG#,,AUTO
         3 000444   000040 736000                    QLS     32
         3 000445   040000 136003                    SBLQ    16384,DU
         3 000446   200652 036100                    ADLQ    VPT$,,AUTO
         3 000447   200652 756100                    STQ     VPT$,,AUTO

      358    13228    2           DATAWRD = '0'B;

  13228  3 000450   000100 100400                    MLR     fill='000'O
         3 000451   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000452   200010 000030                    ADSC9   DATAWRD,,AUTO            cn=0,n=24

      359    13229    2           CALL DAF$INIT(VSPCRPT);

  13229  3 000453   000021 630400 4                  EPPR0   17
         3 000454   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000455   000000 701000 xent               TSX1    DAF$INIT
         3 000456   000000 011000                    NOP     0

      360    13230    2           PCOUNT = 0;

  13230  3 000457   200032 450100                    STZ     PCOUNT,,AUTO

      361    13231    2           NXT_VPNO = MM$VCB.HEAD;

  13231  3 000460   200660 470500                    LDP0    VCB$,,AUTO
         3 000461   000006 235100                    LDA     6,,PR0
         3 000462   200030 755100                    STA     NXT_VPNO,,AUTO

      362    13232    2           VPNO = MM$VCB.HEAD;

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:54   
  13232  3 000463   000006 235100                    LDA     6,,PR0
         3 000464   200651 755100                    STA     VPNO,,AUTO

      363    13233    2   SEARCH_CHAIN:
      364    13234    3           DO WHILE (NXT_VPNO ~= END_VP);

  13234  3 000465   200030 236100       SEARCH_CHAIN LDQ     NXT_VPNO,,AUTO
         3 000466   000035 116000 2                  CMPQ    END_VP
         3 000467   000744 600000 3                  TZE     s:13248

      365    13235    4            CALL GET_ENTRY(NXT_VPNO,VPNO,PPNO,DATAWRD(0),DATAWRD(1)) WHENALTRETURN DO;

  13235  3 000470   200011 630500                    EPPR0   DATAWRD+1,,AUTO
         3 000471   200671 450500                    STP0    @D1+1,,AUTO
         3 000472   200010 631500                    EPPR1   DATAWRD,,AUTO
         3 000473   200670 451500                    STP1    @P+1,,AUTO
         3 000474   200035 633500                    EPPR3   PPNO,,AUTO
         3 000475   200667 453500                    STP3    @V+1,,AUTO
         3 000476   200651 634500                    EPPR4   VPNO,,AUTO
         3 000477   200666 454500                    STP4    @C+1,,AUTO
         3 000500   200030 635500                    EPPR5   NXT_VPNO,,AUTO
         3 000501   200665 455500                    STP5    WSQ#+4,,AUTO
         3 000502   001043 701000 3                  TSX1    GET_ENTRY
         3 000503   000505 702000 3                  TSX2    s:13236
         3 000504   000537 710000 3                  TRA     s:13239

      366    13236    4                  CALL DAF$WRITE(VECTOR(VSSFMT3),VECTOR(DATAWRD(0)),VECTOR(DATAWRD(1))
             13236                            );

  13236  3 000505   777640 235007                    LDA     -96,DL
         3 000506   200672 452500                    STP2    @D2+1,,AUTO
         3 000507   200672 236100                    LDQ     @D2+1,,AUTO
         3 000510   000010 036003                    ADLQ    8,DU
         3 000511   200674 757100                    STAQ    @D2+3,,AUTO
         3 000512   777640 235007                    LDA     -96,DL
         3 000513   200676 452500                    STP2    @D2+5,,AUTO
         3 000514   200676 236100                    LDQ     @D2+5,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:55   
         3 000515   000011 036003                    ADLQ    9,DU
         3 000516   200702 757100                    STAQ    @D2+9,,AUTO
         3 000517   200674 237100                    LDAQ    @D2+3,,AUTO
         3 000520   200700 757100                    STAQ    @D2+7,,AUTO
         3 000521   200702 237100                    LDAQ    @D2+9,,AUTO
         3 000522   200704 757100                    STAQ    @D2+11,,AUTO
         3 000523   200704 630500                    EPPR0   @D2+11,,AUTO
         3 000524   200710 450500                    STP0    @D2+15,,AUTO
         3 000525   200700 631500                    EPPR1   @D2+7,,AUTO
         3 000526   200707 451500                    STP1    @D2+14,,AUTO
         3 000527   000024 236000 4                  LDQ     20
         3 000530   200706 756100                    STQ     @D2+13,,AUTO
         3 000531   200706 630500                    EPPR0   @D2+13,,AUTO
         3 000532   000000 220000 xsym               LDX0    DAF$WRITE
         3 000533   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000534   000000 701010                    TSX1    0,X0
         3 000535   000000 011000                    NOP     0

      367    13237    4                   EXIT SEARCH_CHAIN;

  13237  3 000536   000744 710000 3                  TRA     s:13248

      368    13238    4                 END;
      369    13239    4            CALL GET_ENTRY(NXT_VPNO,VPNO,PPNO,DATAWRD(2),DATAWRD(3)) WHENALTRETURN DO;

  13239  3 000537   200013 630500                    EPPR0   DATAWRD+3,,AUTO
         3 000540   200671 450500                    STP0    @D1+1,,AUTO
         3 000541   200012 631500                    EPPR1   DATAWRD+2,,AUTO
         3 000542   200670 451500                    STP1    @P+1,,AUTO
         3 000543   200035 633500                    EPPR3   PPNO,,AUTO
         3 000544   200667 453500                    STP3    @V+1,,AUTO
         3 000545   200651 634500                    EPPR4   VPNO,,AUTO
         3 000546   200666 454500                    STP4    @C+1,,AUTO
         3 000547   200030 635500                    EPPR5   NXT_VPNO,,AUTO
         3 000550   200665 455500                    STP5    WSQ#+4,,AUTO
         3 000551   001043 701000 3                  TSX1    GET_ENTRY
         3 000552   000554 702000 3                  TSX2    s:13240
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:56   
         3 000553   000630 710000 3                  TRA     s:13244

      370    13240    4                  CALL DAF$WRITE(VECTOR(VSSFMT3),VECTOR(DATAWRD(0)),VECTOR(DATAWRD(1))
             13240                            ,

  13240  3 000554   777640 235007                    LDA     -96,DL
         3 000555   200672 452500                    STP2    @D2+1,,AUTO
         3 000556   200672 236100                    LDQ     @D2+1,,AUTO
         3 000557   000010 036003                    ADLQ    8,DU
         3 000560   200674 757100                    STAQ    @D2+3,,AUTO
         3 000561   777640 235007                    LDA     -96,DL
         3 000562   200676 452500                    STP2    @D2+5,,AUTO
         3 000563   200676 236100                    LDQ     @D2+5,,AUTO
         3 000564   000011 036003                    ADLQ    9,DU
         3 000565   200700 757100                    STAQ    @D2+7,,AUTO
         3 000566   777640 235007                    LDA     -96,DL
         3 000567   200702 452500                    STP2    @D2+9,,AUTO
         3 000570   200702 236100                    LDQ     @D2+9,,AUTO
         3 000571   000012 036003                    ADLQ    10,DU
         3 000572   200704 757100                    STAQ    @D2+11,,AUTO
         3 000573   777640 235007                    LDA     -96,DL
         3 000574   200706 452500                    STP2    @D2+13,,AUTO
         3 000575   200706 236100                    LDQ     @D2+13,,AUTO
         3 000576   000013 036003                    ADLQ    11,DU
         3 000577   200712 757100                    STAQ    @D2+17,,AUTO
         3 000600   200674 237100                    LDAQ    @D2+3,,AUTO
         3 000601   200710 757100                    STAQ    @D2+15,,AUTO
         3 000602   200700 237100                    LDAQ    @D2+7,,AUTO
         3 000603   200714 757100                    STAQ    @D2+19,,AUTO
         3 000604   200704 237100                    LDAQ    @D2+11,,AUTO
         3 000605   200716 757100                    STAQ    @D2+21,,AUTO
         3 000606   200712 237100                    LDAQ    @D2+17,,AUTO
         3 000607   200720 757100                    STAQ    @D2+23,,AUTO
         3 000610   200720 630500                    EPPR0   @D2+23,,AUTO
         3 000611   200726 450500                    STP0    @D2+29,,AUTO
         3 000612   200716 631500                    EPPR1   @D2+21,,AUTO
         3 000613   200725 451500                    STP1    @D2+28,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:57   
         3 000614   200714 633500                    EPPR3   @D2+19,,AUTO
         3 000615   200724 453500                    STP3    @D2+27,,AUTO
         3 000616   200710 634500                    EPPR4   @D2+15,,AUTO
         3 000617   200723 454500                    STP4    @D2+26,,AUTO
         3 000620   000024 236000 4                  LDQ     20
         3 000621   200722 756100                    STQ     @D2+25,,AUTO
         3 000622   200722 630500                    EPPR0   @D2+25,,AUTO
         3 000623   000000 220000 xsym               LDX0    DAF$WRITE
         3 000624   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000625   000000 701010                    TSX1    0,X0
         3 000626   000000 011000                    NOP     0

      371    13241    4                     VECTOR(DATAWRD(2)),VECTOR(DATAWRD(3)));
      372    13242    4                   EXIT SEARCH_CHAIN;

  13242  3 000627   000744 710000 3                  TRA     s:13248

      373    13243    4                 END;
      374    13244    3             CALL GET_ENTRY(NXT_VPNO,VPNO,PPNO,DATAWRD(4),DATAWRD(5));

  13244  3 000630   200015 630500                    EPPR0   DATAWRD+5,,AUTO
         3 000631   200671 450500                    STP0    @D1+1,,AUTO
         3 000632   200014 631500                    EPPR1   DATAWRD+4,,AUTO
         3 000633   200670 451500                    STP1    @P+1,,AUTO
         3 000634   200035 633500                    EPPR3   PPNO,,AUTO
         3 000635   200667 453500                    STP3    @V+1,,AUTO
         3 000636   200651 634500                    EPPR4   VPNO,,AUTO
         3 000637   200666 454500                    STP4    @C+1,,AUTO
         3 000640   200030 635500                    EPPR5   NXT_VPNO,,AUTO
         3 000641   200665 455500                    STP5    WSQ#+4,,AUTO
         3 000642   001043 701000 3                  TSX1    GET_ENTRY
         3 000643   000000 011000                    NOP     0

      375    13245    3             CALL DAF$WRITE(VECTOR(VSSFMT3),VECTOR(DATAWRD(0)),VECTOR(DATAWRD(1)),
      376    13246    3              VECTOR(DATAWRD(2)),VECTOR(DATAWRD(3)),VECTOR(DATAWRD(4)),VECTOR(DATAWRD(
             13246                        5)));

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:58   
  13246  3 000644   777640 235007                    LDA     -96,DL
         3 000645   200672 452500                    STP2    @D2+1,,AUTO
         3 000646   200672 236100                    LDQ     @D2+1,,AUTO
         3 000647   000010 036003                    ADLQ    8,DU
         3 000650   200674 757100                    STAQ    @D2+3,,AUTO
         3 000651   777640 235007                    LDA     -96,DL
         3 000652   200676 452500                    STP2    @D2+5,,AUTO
         3 000653   200676 236100                    LDQ     @D2+5,,AUTO
         3 000654   000011 036003                    ADLQ    9,DU
         3 000655   200700 757100                    STAQ    @D2+7,,AUTO
         3 000656   777640 235007                    LDA     -96,DL
         3 000657   200702 452500                    STP2    @D2+9,,AUTO
         3 000660   200702 236100                    LDQ     @D2+9,,AUTO
         3 000661   000012 036003                    ADLQ    10,DU
         3 000662   200704 757100                    STAQ    @D2+11,,AUTO
         3 000663   777640 235007                    LDA     -96,DL
         3 000664   200706 452500                    STP2    @D2+13,,AUTO
         3 000665   200706 236100                    LDQ     @D2+13,,AUTO
         3 000666   000013 036003                    ADLQ    11,DU
         3 000667   200710 757100                    STAQ    @D2+15,,AUTO
         3 000670   777640 235007                    LDA     -96,DL
         3 000671   200712 452500                    STP2    @D2+17,,AUTO
         3 000672   200712 236100                    LDQ     @D2+17,,AUTO
         3 000673   000014 036003                    ADLQ    12,DU
         3 000674   200714 757100                    STAQ    @D2+19,,AUTO
         3 000675   777640 235007                    LDA     -96,DL
         3 000676   200716 452500                    STP2    @D2+21,,AUTO
         3 000677   200716 236100                    LDQ     @D2+21,,AUTO
         3 000700   000015 036003                    ADLQ    13,DU
         3 000701   200722 757100                    STAQ    @D2+25,,AUTO
         3 000702   200674 237100                    LDAQ    @D2+3,,AUTO
         3 000703   200720 757100                    STAQ    @D2+23,,AUTO
         3 000704   200700 237100                    LDAQ    @D2+7,,AUTO
         3 000705   200724 757100                    STAQ    @D2+27,,AUTO
         3 000706   200704 237100                    LDAQ    @D2+11,,AUTO
         3 000707   200726 757100                    STAQ    @D2+29,,AUTO
         3 000710   200710 237100                    LDAQ    @D2+15,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:59   
         3 000711   200730 757100                    STAQ    @D2+31,,AUTO
         3 000712   200714 237100                    LDAQ    @D2+19,,AUTO
         3 000713   200732 757100                    STAQ    @D2+33,,AUTO
         3 000714   200722 237100                    LDAQ    @D2+25,,AUTO
         3 000715   200734 757100                    STAQ    @D2+35,,AUTO
         3 000716   200734 630500                    EPPR0   @D2+35,,AUTO
         3 000717   200744 450500                    STP0    @D2+43,,AUTO
         3 000720   200732 631500                    EPPR1   @D2+33,,AUTO
         3 000721   200743 451500                    STP1    @D2+42,,AUTO
         3 000722   200730 633500                    EPPR3   @D2+31,,AUTO
         3 000723   200742 453500                    STP3    @D2+41,,AUTO
         3 000724   200726 634500                    EPPR4   @D2+29,,AUTO
         3 000725   200741 454500                    STP4    @D2+40,,AUTO
         3 000726   200724 635500                    EPPR5   @D2+27,,AUTO
         3 000727   200740 455500                    STP5    @D2+39,,AUTO
         3 000730   200720 636500                    EPPR6   @D2+23,,AUTO
         3 000731   200737 456500                    STP6    @D2+38,,AUTO
         3 000732   000024 236000 4                  LDQ     20
         3 000733   200736 756100                    STQ     @D2+37,,AUTO
         3 000734   200736 630500                    EPPR0   @D2+37,,AUTO
         3 000735   000000 220000 xsym               LDX0    DAF$WRITE
         3 000736   000025 631400 xsym               EPPR1   B_VECTNIL+21
         3 000737   000000 701010                    TSX1    0,X0
         3 000740   000000 011000                    NOP     0

      377    13247    3           END;

  13247  3 000741   200030 236100                    LDQ     NXT_VPNO,,AUTO
         3 000742   000035 116000 2                  CMPQ    END_VP
         3 000743   000470 601000 3                  TNZ     s:13235

      378    13248    3           IF PCOUNT ~= MM$VCB.PPC THEN DO;

  13248  3 000744   200660 470500                    LDP0    VCB$,,AUTO
         3 000745   000011 236100                    LDQ     9,,PR0
         3 000746   000022 772000                    QRL     18
         3 000747   200032 116100                    CMPQ    PCOUNT,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:60   
         3 000750   001003 600000 3                  TZE     s:13252

      379    13249    3                 NUM = MM$VCB.PPC;

  13249  3 000751   200027 756100                    STQ     NUM,,AUTO

      380    13250    3                 CALL DAF$WRITE(VECTOR(COUNT_ERR),VECTOR(NUM),VECTOR(PCOUNT));

  13250  3 000752   777640 235007                    LDA     -96,DL
         3 000753   200672 452500                    STP2    @D2+1,,AUTO
         3 000754   200672 236100                    LDQ     @D2+1,,AUTO
         3 000755   000027 036003                    ADLQ    23,DU
         3 000756   200674 757100                    STAQ    @D2+3,,AUTO
         3 000757   777640 235007                    LDA     -96,DL
         3 000760   200676 452500                    STP2    @D2+5,,AUTO
         3 000761   200676 236100                    LDQ     @D2+5,,AUTO
         3 000762   000032 036003                    ADLQ    26,DU
         3 000763   200702 757100                    STAQ    @D2+9,,AUTO
         3 000764   200674 237100                    LDAQ    @D2+3,,AUTO
         3 000765   200700 757100                    STAQ    @D2+7,,AUTO
         3 000766   200702 237100                    LDAQ    @D2+9,,AUTO
         3 000767   200704 757100                    STAQ    @D2+11,,AUTO
         3 000770   200704 631500                    EPPR1   @D2+11,,AUTO
         3 000771   200710 451500                    STP1    @D2+15,,AUTO
         3 000772   200700 633500                    EPPR3   @D2+7,,AUTO
         3 000773   200707 453500                    STP3    @D2+14,,AUTO
         3 000774   000030 236000 4                  LDQ     24
         3 000775   200706 756100                    STQ     @D2+13,,AUTO
         3 000776   200706 630500                    EPPR0   @D2+13,,AUTO
         3 000777   000000 220000 xsym               LDX0    DAF$WRITE
         3 001000   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001001   000000 701010                    TSX1    0,X0
         3 001002   000000 011000                    NOP     0

      381    13251    3               END;

      382    13252    3           IF MM$VCB.TAIL ~= VPNO THEN DO;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:61   

  13252  3 001003   200660 470500                    LDP0    VCB$,,AUTO
         3 001004   000007 236100                    LDQ     7,,PR0
         3 001005   200651 116100                    CMPQ    VPNO,,AUTO
         3 001006   001041 600000 3                  TZE     s:13256

      383    13253    3                 NUM = MM$VCB.TAIL;

  13253  3 001007   200027 756100                    STQ     NUM,,AUTO

      384    13254    3                 CALL DAF$WRITE(VECTOR(TAIL_ERR),VECTOR(NUM),VECTOR(VPNO));

  13254  3 001010   777640 235007                    LDA     -96,DL
         3 001011   200672 452500                    STP2    @D2+1,,AUTO
         3 001012   200672 236100                    LDQ     @D2+1,,AUTO
         3 001013   000027 036003                    ADLQ    23,DU
         3 001014   200674 757100                    STAQ    @D2+3,,AUTO
         3 001015   777640 235007                    LDA     -96,DL
         3 001016   200676 452500                    STP2    @D2+5,,AUTO
         3 001017   200676 236100                    LDQ     @D2+5,,AUTO
         3 001020   000651 036003                    ADLQ    425,DU
         3 001021   200702 757100                    STAQ    @D2+9,,AUTO
         3 001022   200674 237100                    LDAQ    @D2+3,,AUTO
         3 001023   200700 757100                    STAQ    @D2+7,,AUTO
         3 001024   200702 237100                    LDAQ    @D2+9,,AUTO
         3 001025   200704 757100                    STAQ    @D2+11,,AUTO
         3 001026   200704 631500                    EPPR1   @D2+11,,AUTO
         3 001027   200710 451500                    STP1    @D2+15,,AUTO
         3 001030   200700 633500                    EPPR3   @D2+7,,AUTO
         3 001031   200707 453500                    STP3    @D2+14,,AUTO
         3 001032   000034 236000 4                  LDQ     28
         3 001033   200706 756100                    STQ     @D2+13,,AUTO
         3 001034   200706 630500                    EPPR0   @D2+13,,AUTO
         3 001035   000000 220000 xsym               LDX0    DAF$WRITE
         3 001036   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001037   000000 701010                    TSX1    0,X0
         3 001040   000000 011000                    NOP     0
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:62   

      385    13255    3               END;

      386    13256    2   END DIPGCHAIN;

  13256  3 001041   200662 221300                    LDX1  ! WSQ#+1,,AUTO
         3 001042   000001 702211                    TSX2  ! 1,X1

      387    13257        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:63   
      388    13258    1   GET_ENTRY: PROC(C,V,P,D1,D2) ALTRET;

  13258  3 001043   200664 741300       GET_ENTRY    STX1  ! WSQ#+3,,AUTO

      389    13259    2   DCL C SBIN WORD;
      390    13260    2   DCL D1 UBIN WORD;
      391    13261    2   DCL D2 UBIN WORD;
      392    13262    2   DCL P SBIN WORD;
      393    13263    2   DCL V SBIN WORD;
      394    13264
      395    13265    2           PCOUNT = PCOUNT + 1;

  13265  3 001044   200032 054100                    AOS     PCOUNT,,AUTO

      396    13266    2           V = C;

  13266  3 001045   200665 470500                    LDP0    @C,,AUTO
         3 001046   200666 471500                    LDP1    @V,,AUTO
         3 001047   000000 235100                    LDA     0,,PR0
         3 001050   100000 755100                    STA     0,,PR1

      397    13267    2           IF C = MM$VCB.HEAD THEN

  13267  3 001051   200660 473500                    LDP3    VCB$,,AUTO
         3 001052   000000 236100                    LDQ     0,,PR0
         3 001053   300006 116100                    CMPQ    6,,PR3
         3 001054   001060 601000 3                  TNZ     s:13270

      398    13268    2             D1 = C;

  13268  3 001055   200670 474500                    LDP4    @D1,,AUTO
         3 001056   400000 756100                    STQ     0,,PR4
         3 001057   001067 710000 3                  TRA     s:13271

      399    13269    2             ELSE
      400    13270    2             D1 = PPUT$->MM$PPUT.PPNO(P);

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:64   
  13270  3 001060   200667 474500                    LDP4    @P,,AUTO
         3 001061   400000 235100                    LDA     0,,PR4
         3 001062   000611 475400 1                  LDP5    PPUT$
         3 001063   500000 236105                    LDQ     0,AL,PR5
         3 001064   777777 376007                    ANQ     -1,DL
         3 001065   200670 476500                    LDP6    @D1,,AUTO
         3 001066   600000 756100                    STQ     0,,PR6

      401    13271    2           P = VPT$->B$MAP.RPN(V);

  13271  3 001067   100000 720100                    LXL0    0,,PR1
         3 001070   200652 473500                    LDP3    VPT$,,AUTO
         3 001071   300000 236110                    LDQ     0,X0,PR3
         3 001072   000022 772000                    QRL     18
         3 001073   200667 474500                    LDP4    @P,,AUTO
         3 001074   400000 756100                    STQ     0,,PR4

      402    13272    2           D2 = VPT$->B$PAGE.WRD(V);

  13272  3 001075   100000 720100                    LXL0    0,,PR1
         3 001076   200652 473500                    LDP3    VPT$,,AUTO
         3 001077   200671 475500                    LDP5    @D2,,AUTO
         3 001100   300000 235110                    LDA     0,X0,PR3
         3 001101   500000 755100                    STA     0,,PR5

      403    13273    2           C = PPUT$->MM$PPUT.PPNO(P);

  13273  3 001102   400000 235100                    LDA     0,,PR4
         3 001103   000611 473400 1                  LDP3    PPUT$
         3 001104   300000 236105                    LDQ     0,AL,PR3
         3 001105   777777 376007                    ANQ     -1,DL
         3 001106   000000 756100                    STQ     0,,PR0

      404    13274    2           IF C = END_VP THEN ALTRETURN;

  13274  3 001107   000035 116000 2                  CMPQ    END_VP
         3 001110   001113 601000 3                  TNZ     s:13275
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:65   

  13274  3 001111   200664 221300                    LDX1  ! WSQ#+3,,AUTO
         3 001112   000000 702211                    TSX2  ! 0,X1

      405    13275    2   END GET_ENTRY;

  13275  3 001113   200664 221300                    LDX1  ! WSQ#+3,,AUTO
         3 001114   000001 702211                    TSX2  ! 1,X1

      406    13276        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:66   
      407    13277    1   DAD$CHECK_PPUT:ENTRY;

  13277  3 001115   000000 700200 xent  DAD$CHECK_P* TSX0  ! X66_AUTO_1
         3 001116   001036 000001                    ZERO    542,1
         3 001117   200036 452700                    STP2  ! PR2$,,AUTO

      408    13278    1           V_ = VECTOR(NIL);

  13278  3 001120   000036 237000 4                  LDAQ    30
         3 001121   200656 757100                    STAQ    V_,,AUTO

      409    13279    1           VBASE(V_) = B$IS$;

  13279  3 001122   000000 236000 xsym               LDQ     B$IS$
         3 001123   200657 756100                    STQ     V_+1,,AUTO

      410    13280    1           VBOUND(V_) = 4*5096;

  13280  3 001124   200656 236100                    LDQ     V_,,AUTO
         3 001125   177777 376007                    ANQ     65535,DL
         3 001126   011750 276003                    ORQ     5096,DU
         3 001127   200656 756100                    STQ     V_,,AUTO

      411    13281    1           CALL DAS$SDSRCHPTR(NAME_FPPH,OUT$) ALTRET(ALT);

  13281  3 001130   000040 630400 4                  EPPR0   32
         3 001131   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001132   000000 701000 xent               TSX1    DAS$SDSRCHPTR
         3 001133   003647 702000 3                  TSX2    ALT

      412    13282    1           CALL DAM$MAP(OUT$,OUT$,0,%MONWSR,V_) ALTRET(ALT);

  13282  3 001134   200656 630500                    EPPR0   V_,,AUTO
         3 001135   200676 450500                    STP0    @D2+5,,AUTO
         3 001136   000002 237000 4                  LDAQ    2
         3 001137   200674 757100                    STAQ    @D2+3,,AUTO
         3 001140   000042 237000 4                  LDAQ    34
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:67   
         3 001141   200672 757100                    STAQ    @D2+1,,AUTO
         3 001142   200672 630500                    EPPR0   @D2+1,,AUTO
         3 001143   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 001144   000000 701000 xent               TSX1    DAM$MAP
         3 001145   003647 702000 3                  TSX2    ALT

      413    13283    1           CALL DAM$MAP(B$PPUT$,PPUT$,0,%MONWSR) ALTRET(ALT);

  13283  3 001146   000000 630400 4                  EPPR0   0
         3 001147   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001150   000000 701000 xent               TSX1    DAM$MAP
         3 001151   003647 702000 3                  TSX2    ALT

      414    13284    1           CHAIN_HEAD =OUT$->B$WORD;

  13284  3 001152   000607 470400 1                  LDP0    OUT$
         3 001153   000000 235100                    LDA     0,,PR0
         3 001154   200004 755100                    STA     CHAIN_HEAD,,AUTO

      415    13285    1           CHAIN_TAIL = PINCRW(OUT$,1)->B$WORD;

  13285  3 001155   000001 235100                    LDA     1,,PR0
         3 001156   200005 755100                    STA     CHAIN_TAIL,,AUTO

      416    13286    1           COUNT  = PINCRW(OUT$,2)->B$WORD;

  13286  3 001157   000002 235100                    LDA     2,,PR0
         3 001160   200006 755100                    STA     COUNT,,AUTO

      417    13287    1           CALL DAF$WRITE(VECTOR(PGOODFMT),VECTOR(CHAIN_HEAD),

  13287  3 001161   777640 235007                    LDA     -96,DL
         3 001162   200672 452500                    STP2    @D2+1,,AUTO
         3 001163   200672 236100                    LDQ     @D2+1,,AUTO
         3 001164   000004 036003                    ADLQ    4,DU
         3 001165   200674 757100                    STAQ    @D2+3,,AUTO
         3 001166   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:68   
         3 001167   200676 452500                    STP2    @D2+5,,AUTO
         3 001170   200676 236100                    LDQ     @D2+5,,AUTO
         3 001171   000005 036003                    ADLQ    5,DU
         3 001172   200700 757100                    STAQ    @D2+7,,AUTO
         3 001173   777640 235007                    LDA     -96,DL
         3 001174   200702 452500                    STP2    @D2+9,,AUTO
         3 001175   200702 236100                    LDQ     @D2+9,,AUTO
         3 001176   000006 036003                    ADLQ    6,DU
         3 001177   200706 757100                    STAQ    @D2+13,,AUTO
         3 001200   200674 237100                    LDAQ    @D2+3,,AUTO
         3 001201   200704 757100                    STAQ    @D2+11,,AUTO
         3 001202   200700 237100                    LDAQ    @D2+7,,AUTO
         3 001203   200710 757100                    STAQ    @D2+15,,AUTO
         3 001204   200706 237100                    LDAQ    @D2+13,,AUTO
         3 001205   200712 757100                    STAQ    @D2+17,,AUTO
         3 001206   200712 631500                    EPPR1   @D2+17,,AUTO
         3 001207   200717 451500                    STP1    @D2+22,,AUTO
         3 001210   200710 633500                    EPPR3   @D2+15,,AUTO
         3 001211   200716 453500                    STP3    @D2+21,,AUTO
         3 001212   200704 634500                    EPPR4   @D2+11,,AUTO
         3 001213   200715 454500                    STP4    @D2+20,,AUTO
         3 001214   000046 236000 4                  LDQ     38
         3 001215   200714 756100                    STQ     @D2+19,,AUTO
         3 001216   200714 630500                    EPPR0   @D2+19,,AUTO
         3 001217   000000 220000 xsym               LDX0    DAF$WRITE
         3 001220   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001221   000000 701010                    TSX1    0,X0
         3 001222   000000 011000                    NOP     0

      418    13288    1             VECTOR(CHAIN_TAIL),VECTOR(COUNT));
      419    13289    1           I = CHAIN_HEAD;

  13289  3 001223   200004 235100                    LDA     CHAIN_HEAD,,AUTO
         3 001224   200022 755100                    STA     I,,AUTO

      420    13290    1           J = 0;

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:69   
  13290  3 001225   200025 450100                    STZ     J,,AUTO

      421    13291    2           DO WHILE (PPUT$->MM$PPUT.PPNO (I) ~= 0);

  13291  3 001226   000611 470400 1                  LDP0    PPUT$
         3 001227   000000 720105                    LXL0    0,AL,PR0
         3 001230   001243 600000 3                  TZE     s:13295

      422    13292    2             J = J + 1;

  13292  3 001231   200025 235100                    LDA     J,,AUTO
         3 001232   000001 035007                    ADLA    1,DL
         3 001233   200025 755100                    STA     J,,AUTO

      423    13293    2             I = PPUT$->MM$PPUT.PPNO(I);

  13293  3 001234   000611 470400 1                  LDP0    PPUT$
         3 001235   200022 720100                    LXL0    I,,AUTO
         3 001236   000000 236110                    LDQ     0,X0,PR0
         3 001237   777777 376007                    ANQ     -1,DL
         3 001240   200022 756100                    STQ     I,,AUTO

      424    13294    2           END;

  13294  3 001241   000000 720106                    LXL0    0,QL,PR0
         3 001242   001231 601000 3                  TNZ     s:13292

      425    13295    1           IF J ~= COUNT-1 THEN

  13295  3 001243   200006 236100                    LDQ     COUNT,,AUTO
         3 001244   000001 136007                    SBLQ    1,DL
         3 001245   001250 604000 3                  TMI     s:13296
         3 001246   200025 116100                    CMPQ    J,,AUTO
         3 001247   001301 600000 3                  TZE     s:13297

      426    13296    1             CALL DAF$WRITE(VECTOR(PERRFMT),VECTOR(J),VECTOR(I));

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:70   
  13296  3 001250   777640 235007                    LDA     -96,DL
         3 001251   200672 452500                    STP2    @D2+1,,AUTO
         3 001252   200672 236100                    LDQ     @D2+1,,AUTO
         3 001253   000025 036003                    ADLQ    21,DU
         3 001254   200674 757100                    STAQ    @D2+3,,AUTO
         3 001255   777640 235007                    LDA     -96,DL
         3 001256   200676 452500                    STP2    @D2+5,,AUTO
         3 001257   200676 236100                    LDQ     @D2+5,,AUTO
         3 001260   000022 036003                    ADLQ    18,DU
         3 001261   200702 757100                    STAQ    @D2+9,,AUTO
         3 001262   200674 237100                    LDAQ    @D2+3,,AUTO
         3 001263   200700 757100                    STAQ    @D2+7,,AUTO
         3 001264   200702 237100                    LDAQ    @D2+9,,AUTO
         3 001265   200704 757100                    STAQ    @D2+11,,AUTO
         3 001266   200704 631500                    EPPR1   @D2+11,,AUTO
         3 001267   200710 451500                    STP1    @D2+15,,AUTO
         3 001270   200700 633500                    EPPR3   @D2+7,,AUTO
         3 001271   200707 453500                    STP3    @D2+14,,AUTO
         3 001272   000052 236000 4                  LDQ     42
         3 001273   200706 756100                    STQ     @D2+13,,AUTO
         3 001274   200706 630500                    EPPR0   @D2+13,,AUTO
         3 001275   000000 220000 xsym               LDX0    DAF$WRITE
         3 001276   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001277   000000 701010                    TSX1    0,X0
         3 001300   000000 011000                    NOP     0

      427    13297    1           RETURN;

  13297  3 001301   000000 702200 xent               TSX2  ! X66_ARET

      428    13298        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:71   
      429    13299    1   DAD$PPUT:ENTRY(TOP);

  13299  3 001302   000000 700200 xent  DAD$PPUT     TSX0  ! X66_AUTO_1
         3 001303   001036 000001                    ZERO    542,1
         3 001304   200036 452700                    STP2  ! PR2$,,AUTO

      430    13300        /*
      431    13301        **
      432    13302        **      Initialize some stuff.
      433    13303        */
      434    13304    1           PPUT_FLAG = '0'B;

  13304  3 001305   000577 450000 1                  STZ     PPUT_FLAG

      435    13305    1           UTB = '0'B;

  13305  3 001306   000100 100400                    MLR     fill='000'O
         3 001307   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 001310   200246 002000                    ADSC9   UTB,,AUTO                cn=0,n=1024

      436    13306    1           PTB = '0'B;

  13306  3 001311   000100 100400                    MLR     fill='000'O
         3 001312   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 001313   200041 001000                    ADSC9   PTB,,AUTO                cn=0,n=512

      437    13307    1           V_ = VECTOR(NIL);

  13307  3 001314   000036 237000 4                  LDAQ    30
         3 001315   200656 757100                    STAQ    V_,,AUTO

      438    13308    1           VBASE(V_) = B$IS$;

  13308  3 001316   000000 236000 xsym               LDQ     B$IS$
         3 001317   200657 756100                    STQ     V_+1,,AUTO

      439    13309    1           VBOUND(V_) = 5*4096;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:72   

  13309  3 001320   200656 236100                    LDQ     V_,,AUTO
         3 001321   177777 376007                    ANQ     65535,DL
         3 001322   012000 276003                    ORQ     5120,DU
         3 001323   200656 756100                    STQ     V_,,AUTO

      440    13310    2           IF TOP.NSUBLKS ~= 0 THEN DO;

  13310  3 001324   200003 470500                    LDP0    @TOP,,AUTO
         3 001325   000001 220100                    LDX0    1,,PR0
         3 001326   001366 600000 3                  TZE     s:13325

      441    13311    3                 DO I = 0 TO TOP.NSUBLKS-1;

  13311  3 001327   200022 450100                    STZ     I,,AUTO
         3 001330   001361 710000 3                  TRA     s:13322+1

      442    13312    4                   DO CASE(TOP.SUBLK$(I)->OUT$BLK.CODE);

  13312  3 001331   200003 470500                    LDP0    @TOP,,AUTO
         3 001332   200022 720100                    LXL0    I,,AUTO
         3 001333   000003 471510                    LDP1    3,X0,PR0
         3 001334   100000 721100                    LXL1    0,,PR1
         3 001335   000005 101003                    CMPX1   5,DU
         3 001336   001340 602011 3                  TNC     s:13312+7,X1
         3 001337   001360 710000 3                  TRA     s:13322
         3 001340   001360 710000 3                  TRA     s:13322
         3 001341   001345 710000 3                  TRA     s:13314
         3 001342   001350 710000 3                  TRA     s:13316
         3 001343   001353 710000 3                  TRA     s:13318
         3 001344   001356 710000 3                  TRA     s:13320

      443    13313    4                     CASE(1);

      444    13314    4                       PPUT_FLAG.SUMMARY = '1'B;

  13314  3 001345   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:73   
         3 001346   000577 256000 1                  ORSQ    PPUT_FLAG
         3 001347   001360 710000 3                  TRA     s:13322

      445    13315    4                     CASE(2);

      446    13316    4                       PPUT_FLAG.PROCESSOR = '1'B;

  13316  3 001350   200000 236003                    LDQ     65536,DU
         3 001351   000577 256000 1                  ORSQ    PPUT_FLAG
         3 001352   001360 710000 3                  TRA     s:13322

      447    13317    4                     CASE(3);

      448    13318    4                       PPUT_FLAG.USER = '1'B;

  13318  3 001353   100000 236003                    LDQ     32768,DU
         3 001354   000577 256000 1                  ORSQ    PPUT_FLAG
         3 001355   001360 710000 3                  TRA     s:13322

      449    13319    4                     CASE(4);

      450    13320    4                       PPUT_FLAG.USAGE = '1'B;

  13320  3 001356   040000 236003                    LDQ     16384,DU
         3 001357   000577 256000 1                  ORSQ    PPUT_FLAG

      451    13321    4                   END;

      452    13322    3                 END;

  13322  3 001360   200022 054100                    AOS     I,,AUTO
         3 001361   000001 236100                    LDQ     1,,PR0
         3 001362   000022 772000                    QRL     18
         3 001363   200022 116100                    CMPQ    I,,AUTO
         3 001364   001331 605400 3                  TPNZ    s:13312

      453    13323    2               END;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:74   

  13323  3 001365   001370 710000 3                  TRA     s:13330

      454    13324    1             ELSE
      455    13325    1             PPUT_FLAG = '740'O;

  13325  3 001366   740000 236003                    LDQ     -16384,DU
         3 001367   000577 756000 1                  STQ     PPUT_FLAG

      456    13326        /*
      457    13327        **
      458    13328        **      Run through PPUT looking at the flags.
      459    13329        */
      460    13330    1           CALL DAS$SDSRCHPTR(NAME_PCORE,OUT$) ALTRET (ALT);

  13330  3 001370   000053 630400 4                  EPPR0   43
         3 001371   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001372   000000 701000 xent               TSX1    DAS$SDSRCHPTR
         3 001373   003647 702000 3                  TSX2    ALT

      461    13331    1           CALL DAM$MAP (OUT$,OUT$,0,%MONWSR,V_) ALTRET (ALT);

  13331  3 001374   200656 630500                    EPPR0   V_,,AUTO
         3 001375   200676 450500                    STP0    @D2+5,,AUTO
         3 001376   000002 237000 4                  LDAQ    2
         3 001377   200674 757100                    STAQ    @D2+3,,AUTO
         3 001400   000042 237000 4                  LDAQ    34
         3 001401   200672 757100                    STAQ    @D2+1,,AUTO
         3 001402   200672 630500                    EPPR0   @D2+1,,AUTO
         3 001403   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 001404   000000 701000 xent               TSX1    DAM$MAP
         3 001405   003647 702000 3                  TSX2    ALT

      462    13332    1           PCORE = OUT$->B$WORD;

  13332  3 001406   000607 470400 1                  LDP0    OUT$
         3 001407   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:75   
         3 001410   200031 755100                    STA     PCORE,,AUTO

      463    13333    1           IF PCORE > %MAXP THEN CALL M$XXX;

  13333  3 001411   200001 115007                    CMPA    65537,DL
         3 001412   001415 602000 3                  TNC     s:13334

  13333  3 001413   000003 713400                    CLIMB   3
         3 001414   000000 401760                    pmme    nvectors=0

      464    13334    1           USE$ = PINCRW(PR2$,AUTOFRAME.NEXT_FRAME - PR2_STRUC.WORD_OFFSET -1);

  13334  3 001415   200036 235100                    LDA     PR2$,,AUTO
         3 001416   000022 771000                    ARL     18
         3 001417   200672 755100                    STA     @D2+1,,AUTO
         3 001420   200036 470500                    LDP0    PR2$,,AUTO
         3 001421   000100 101500                    MRL     fill='000'O
         3 001422   000002 000002                    ADSC9   2,,PR0                   cn=0,n=2
         3 001423   200673 000004                    ADSC9   @D2+2,,AUTO              cn=0,n=4
         3 001424   200673 236100                    LDQ     @D2+2,,AUTO
         3 001425   200672 136100                    SBLQ    @D2+1,,AUTO
         3 001426   000022 736000                    QLS     18
         3 001427   000001 136003                    SBLQ    1,DU
         3 001430   200036 036100                    ADLQ    PR2$,,AUTO
         3 001431   200244 756100                    STQ     USE$,,AUTO

      465    13335    1           CALL DAD$FREXT(PCORE);

  13335  3 001432   200031 631500                    EPPR1   PCORE,,AUTO
         3 001433   200672 451500                    STP1    @D2+1,,AUTO
         3 001434   200672 630500                    EPPR0   @D2+1,,AUTO
         3 001435   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001436   000000 701000 xent               TSX1    DAD$FREXT
         3 001437   000000 011000                    NOP     0

      466    13336
      467    13337    1           CALL DAM$MAP(B$PPUT$,PPUT$,0,%MONWSR) ALTRET (ALT);
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:76   

  13337  3 001440   000000 630400 4                  EPPR0   0
         3 001441   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001442   000000 701000 xent               TSX1    DAM$MAP
         3 001443   003647 702000 3                  TSX2    ALT

      468    13338
      469    13339    2           DO PPNO = 0 TO PCORE;

  13339  3 001444   200035 450100                    STZ     PPNO,,AUTO
         3 001445   001765 710000 3                  TRA     s:13417+1

      470    13340    2             NUM = PPUT$->MM$PPUT.USER# (PPNO);

  13340  3 001446   000611 470400 1                  LDP0    PPUT$
         3 001447   200035 720100                    LXL0    PPNO,,AUTO
         3 001450   000000 236110                    LDQ     0,X0,PR0
         3 001451   000022 772000                    QRL     18
         3 001452   000777 376007                    ANQ     511,DL
         3 001453   200027 756100                    STQ     NUM,,AUTO

      471    13341    2             USE_TABLE(PPNO) = %UNKNOWN;

  13341  3 001454   200035 235100                    LDA     PPNO,,AUTO
         3 001455   000002 735000                    ALS     2
         3 001456   200244 471500                    LDP1    USE$,,AUTO
         3 001457   040105 100400                    MLR     fill='040'O
         3 001460   000301 000004 2                  ADSC9   FNFFMT+9                 cn=0,n=4
         3 001461   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      472    13342    2             IF PPUT$->MM$PPUT.FREE(PPNO)

  13342  3 001462   000611 470400 1                  LDP0    PPUT$
         3 001463   200035 720100                    LXL0    PPNO,,AUTO
         3 001464   000000 236110                    LDQ     0,X0,PR0
         3 001465   040000 316003                    CANQ    16384,DU
         3 001466   001500 600000 3                  TZE     s:13348
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:77   

      473    13343    3               THEN DO;

      474    13344    3                   USE_TABLE(PPNO) = 'FREE';

  13344  3 001467   200035 235100                    LDA     PPNO,,AUTO
         3 001470   000002 735000                    ALS     2
         3 001471   040105 100400                    MLR     fill='040'O
         3 001472   000302 000004 2                  ADSC9   FNFFMT+10                cn=0,n=4
         3 001473   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      475    13345    3                   FREE# = FREE# + 1;

  13345  3 001474   000565 235000 1                  LDA     FREE#
         3 001475   000001 035007                    ADLA    1,DL
         3 001476   000565 755000 1                  STA     FREE#

      476    13346    3                 END;

  13346  3 001477   001764 710000 3                  TRA     s:13417

      477    13347    2               ELSE
      478    13348    2               IF PPUT$->MM$PPUT.IO(PPNO)

  13348  3 001500   010000 316003                    CANQ    4096,DU
         3 001501   001513 600000 3                  TZE     s:13354

      479    13349    3                 THEN DO;

      480    13350    3                     USE_TABLE(PPNO) = 'I/O';

  13350  3 001502   200035 235100                    LDA     PPNO,,AUTO
         3 001503   000002 735000                    ALS     2
         3 001504   040105 100400                    MLR     fill='040'O
         3 001505   000303 000003 2                  ADSC9   FNFFMT+11                cn=0,n=3
         3 001506   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:78   
      481    13351    3                     IO# = IO# + 1;

  13351  3 001507   000567 235000 1                  LDA     IO#
         3 001510   000001 035007                    ADLA    1,DL
         3 001511   000567 755000 1                  STA     IO#

      482    13352    3                   END;

  13352  3 001512   001764 710000 3                  TRA     s:13417

      483    13353    2                 ELSE
      484    13354    2                 IF PPUT$->MM$PPUT.SUSPECT(PPNO)

  13354  3 001513   000000 234110                    SZN     0,X0,PR0
         3 001514   001526 605000 3                  TPL     s:13360

      485    13355    3                   THEN DO;

      486    13356    3                       USE_TABLE(PPNO) = 'Susp';

  13356  3 001515   200035 235100                    LDA     PPNO,,AUTO
         3 001516   000002 735000                    ALS     2
         3 001517   040105 100400                    MLR     fill='040'O
         3 001520   000304 000004 2                  ADSC9   FNFFMT+12                cn=0,n=4
         3 001521   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      487    13357    3                       DIAG# = DIAG# + 1;

  13357  3 001522   000570 235000 1                  LDA     DIAG#
         3 001523   000001 035007                    ADLA    1,DL
         3 001524   000570 755000 1                  STA     DIAG#

      488    13358    3                     END;

  13358  3 001525   001764 710000 3                  TRA     s:13417

      489    13359    2                   ELSE
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:79   
      490    13360    2                   IF PPUT$->MM$PPUT.BAD(PPNO)

  13360  3 001526   200000 316003                    CANQ    65536,DU
         3 001527   001541 600000 3                  TZE     s:13366

      491    13361    3                     THEN DO;

      492    13362    3                         USE_TABLE(PPNO) = 'Bad';

  13362  3 001530   200035 235100                    LDA     PPNO,,AUTO
         3 001531   000002 735000                    ALS     2
         3 001532   040105 100400                    MLR     fill='040'O
         3 001533   000305 000003 2                  ADSC9   FNFFMT+13                cn=0,n=3
         3 001534   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      493    13363    3                         DIAG# = DIAG# + 1;

  13363  3 001535   000570 235000 1                  LDA     DIAG#
         3 001536   000001 035007                    ADLA    1,DL
         3 001537   000570 755000 1                  STA     DIAG#

      494    13364    3                       END;

  13364  3 001540   001764 710000 3                  TRA     s:13417

      495    13365    2                     ELSE
      496    13366    2                     IF PPUT$->MM$PPUT.IN_TEST(PPNO)

  13366  3 001541   100000 316003                    CANQ    32768,DU
         3 001542   001554 600000 3                  TZE     s:13372

      497    13367    3                       THEN DO;

      498    13368    3                           USE_TABLE(PPNO) = 'Test';

  13368  3 001543   200035 235100                    LDA     PPNO,,AUTO
         3 001544   000002 735000                    ALS     2
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:80   
         3 001545   040105 100400                    MLR     fill='040'O
         3 001546   000306 000004 2                  ADSC9   FNFFMT+14                cn=0,n=4
         3 001547   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      499    13369    3                           DIAG# = DIAG# + 1;

  13369  3 001550   000570 235000 1                  LDA     DIAG#
         3 001551   000001 035007                    ADLA    1,DL
         3 001552   000570 755000 1                  STA     DIAG#

      500    13370    3                         END;

  13370  3 001553   001764 710000 3                  TRA     s:13417

      501    13371    2                       ELSE
      502    13372    2                       IF PPUT$->MM$PPUT.USER(PPNO) AND NUM ~= 0

  13372  3 001554   020000 316003                    CANQ    8192,DU
         3 001555   001642 600000 3                  TZE     s:13386
         3 001556   200027 235100                    LDA     NUM,,AUTO
         3 001557   001642 600000 3                  TZE     s:13386

      503    13373    3                         THEN DO;

      504    13374    3                             USE_TABLE(PPNO) = 'U';

  13374  3 001560   200035 235100                    LDA     PPNO,,AUTO
         3 001561   000002 735000                    ALS     2
         3 001562   040105 100400                    MLR     fill='040'O
         3 001563   000055 000001 4                  ADSC9   45                       cn=0,n=1
         3 001564   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      505    13375    3                             U# = U# + 1;

  13375  3 001565   000571 235000 1                  LDA     U#
         3 001566   000001 035007                    ADLA    1,DL
         3 001567   000571 755000 1                  STA     U#
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:81   

      506    13376    3                             UTB (NUM) = UTB (NUM) + 1;

  13376  3 001570   200027 236100                    LDQ     NUM,,AUTO
         3 001571   000001 736000                    QLS     1
         3 001572   000100 101506                    MRL     fill='000'O
         3 001573   200246 000002                    ADSC9   UTB,Q,AUTO               cn=0,n=2
         3 001574   200673 000004                    ADSC9   @D2+2,,AUTO              cn=0,n=4
         3 001575   200673 236100                    LDQ     @D2+2,,AUTO
         3 001576   000001 036007                    ADLQ    1,DL
         3 001577   200672 756100                    STQ     @D2+1,,AUTO
         3 001600   200027 235100                    LDA     NUM,,AUTO
         3 001601   000001 735000                    ALS     1
         3 001602   000105 101500                    MRL     fill='000'O
         3 001603   200672 000004                    ADSC9   @D2+1,,AUTO              cn=0,n=4
         3 001604   200246 000002                    ADSC9   UTB,A,AUTO               cn=0,n=2

      507    13377    3                             CALL BINCHAR(SUBSTR(USE_TABLE(PPNO),1,3),NUM);

  13377  3 001605   200035 235100                    LDA     PPNO,,AUTO
         3 001606   000002 735000                    ALS     2
         3 001607   200027 236100                    LDQ     NUM,,AUTO
         3 001610   200672 755100                    STA     @D2+1,,AUTO
         3 001611   000000 235003                    LDA     0,DU
         3 001612   200674 757100                    STAQ    @D2+3,,AUTO
         3 001613   200672 235100                    LDA     @D2+1,,AUTO
         3 001614   000105 301500                    BTD
         3 001615   200674 000010                    NDSC9   @D2+3,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         3 001616   100000 230003                    NDSC9   0,A,PR1                  cn=1,s=nosgn,sf=0,n=3

      508    13378    3                             IF SUBSTR(USE_TABLE(PPNO),1,1)='0'

  13378  3 001617   200035 235100                    LDA     PPNO,,AUTO
         3 001620   000002 735000                    ALS     2
         3 001621   040000 106505                    CMPC    fill='040'O
         3 001622   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1
         3 001623   000056 000001 4                  ADSC9   46                       cn=0,n=1
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:82   
         3 001624   001764 601000 3                  TNZ     s:13417

      509    13379    4                               THEN DO;

      510    13380    4                                   SUBSTR(USE_TABLE(PPNO),1,1)=' ';

  13380  3 001625   040105 100400                    MLR     fill='040'O
         3 001626   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001627   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1

      511    13381    4                                   IF SUBSTR(USE_TABLE(PPNO),2,1)='0'

  13381  3 001630   200035 235100                    LDA     PPNO,,AUTO
         3 001631   000002 735000                    ALS     2
         3 001632   040000 106505                    CMPC    fill='040'O
         3 001633   100000 400001                    ADSC9   0,A,PR1                  cn=2,n=1
         3 001634   000056 000001 4                  ADSC9   46                       cn=0,n=1
         3 001635   001764 601000 3                  TNZ     s:13417

      512    13382    4                                     THEN SUBSTR(USE_TABLE(PPNO),2,1)=' ';

  13382  3 001636   040105 100400                    MLR     fill='040'O
         3 001637   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001640   100000 400001                    ADSC9   0,A,PR1                  cn=2,n=1

      513    13383    4                                 END;

      514    13384    3                           END;

  13384  3 001641   001764 710000 3                  TRA     s:13417

      515    13385    2                         ELSE
      516    13386    2                         IF PPUT$->MM$PPUT.PRC(PPNO)

  13386  3 001642   004000 316003                    CANQ    2048,DU
         3 001643   001724 600000 3                  TZE     s:13400

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:83   
      517    13387    3                           THEN DO;

      518    13388    3                               USE_TABLE(PPNO) = 'P';

  13388  3 001644   200035 235100                    LDA     PPNO,,AUTO
         3 001645   000002 735000                    ALS     2
         3 001646   040105 100400                    MLR     fill='040'O
         3 001647   000057 000001 4                  ADSC9   47                       cn=0,n=1
         3 001650   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      519    13389    3                               P# = P# + 1;

  13389  3 001651   000572 235000 1                  LDA     P#
         3 001652   000001 035007                    ADLA    1,DL
         3 001653   000572 755000 1                  STA     P#

      520    13390    3                               PTB (NUM) = PTB (NUM) + 1;

  13390  3 001654   200027 236100                    LDQ     NUM,,AUTO
         3 001655   000100 101506                    MRL     fill='000'O
         3 001656   200041 000001                    ADSC9   PTB,Q,AUTO               cn=0,n=1
         3 001657   200673 000004                    ADSC9   @D2+2,,AUTO              cn=0,n=4
         3 001660   200673 236100                    LDQ     @D2+2,,AUTO
         3 001661   000001 036007                    ADLQ    1,DL
         3 001662   200672 756100                    STQ     @D2+1,,AUTO
         3 001663   200027 235100                    LDA     NUM,,AUTO
         3 001664   000105 101500                    MRL     fill='000'O
         3 001665   200672 000004                    ADSC9   @D2+1,,AUTO              cn=0,n=4
         3 001666   200041 000001                    ADSC9   PTB,A,AUTO               cn=0,n=1

      521    13391    3                               CALL BINCHAR(SUBSTR(USE_TABLE(PPNO),1,3),NUM);

  13391  3 001667   200035 235100                    LDA     PPNO,,AUTO
         3 001670   000002 735000                    ALS     2
         3 001671   200027 236100                    LDQ     NUM,,AUTO
         3 001672   200672 755100                    STA     @D2+1,,AUTO
         3 001673   000000 235003                    LDA     0,DU
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:84   
         3 001674   200674 757100                    STAQ    @D2+3,,AUTO
         3 001675   200672 235100                    LDA     @D2+1,,AUTO
         3 001676   000105 301500                    BTD
         3 001677   200674 000010                    NDSC9   @D2+3,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         3 001700   100000 230003                    NDSC9   0,A,PR1                  cn=1,s=nosgn,sf=0,n=3

      522    13392    3                               IF SUBSTR(USE_TABLE(PPNO),1,1)='0'

  13392  3 001701   200035 235100                    LDA     PPNO,,AUTO
         3 001702   000002 735000                    ALS     2
         3 001703   040000 106505                    CMPC    fill='040'O
         3 001704   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1
         3 001705   000056 000001 4                  ADSC9   46                       cn=0,n=1
         3 001706   001764 601000 3                  TNZ     s:13417

      523    13393    4                                 THEN DO;

      524    13394    4                                     SUBSTR(USE_TABLE(PPNO),1,1)=' ';

  13394  3 001707   040105 100400                    MLR     fill='040'O
         3 001710   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001711   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1

      525    13395    4                                     IF SUBSTR(USE_TABLE(PPNO),2,1)='0'

  13395  3 001712   200035 235100                    LDA     PPNO,,AUTO
         3 001713   000002 735000                    ALS     2
         3 001714   040000 106505                    CMPC    fill='040'O
         3 001715   100000 400001                    ADSC9   0,A,PR1                  cn=2,n=1
         3 001716   000056 000001 4                  ADSC9   46                       cn=0,n=1
         3 001717   001764 601000 3                  TNZ     s:13417

      526    13396    4                                       THEN SUBSTR(USE_TABLE(PPNO),2,1)=' ';

  13396  3 001720   040105 100400                    MLR     fill='040'O
         3 001721   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001722   100000 400001                    ADSC9   0,A,PR1                  cn=2,n=1
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:85   

      527    13397    4                                   END;

      528    13398    3                             END;

  13398  3 001723   001764 710000 3                  TRA     s:13417

      529    13399    2                           ELSE
      530    13400    2                           IF PPUT$->MM$PPUT.STOLEN(PPNO)

  13400  3 001724   002000 316003                    CANQ    1024,DU
         3 001725   001737 600000 3                  TZE     s:13406

      531    13401    3                             THEN DO;

      532    13402    3                                 USE_TABLE(PPNO) = 'Stol';

  13402  3 001726   200035 235100                    LDA     PPNO,,AUTO
         3 001727   000002 735000                    ALS     2
         3 001730   040105 100400                    MLR     fill='040'O
         3 001731   000307 000004 2                  ADSC9   FNFFMT+15                cn=0,n=4
         3 001732   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      533    13403    3                                 STOLE# = STOLE# + 1;

  13403  3 001733   000574 235000 1                  LDA     STOLE#
         3 001734   000001 035007                    ADLA    1,DL
         3 001735   000574 755000 1                  STA     STOLE#

      534    13404    3                               END;

  13404  3 001736   001764 710000 3                  TRA     s:13417

      535    13405    2                             ELSE
      536    13406    2                             IF PPUT$->MM$PPUT.COMM(PPNO)

  13406  3 001737   000000 430110                    FSZN    0,X0,PR0
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:86   
         3 001740   001752 605000 3                  TPL     s:13412

      537    13407    3                               THEN DO;

      538    13408    3                                   USE_TABLE(PPNO) = 'Comm';

  13408  3 001741   200035 235100                    LDA     PPNO,,AUTO
         3 001742   000002 735000                    ALS     2
         3 001743   040105 100400                    MLR     fill='040'O
         3 001744   000310 000004 2                  ADSC9   FNFFMT+16                cn=0,n=4
         3 001745   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      539    13409    3                                   COMM# = COMM# + 1;

  13409  3 001746   000575 235000 1                  LDA     COMM#
         3 001747   000001 035007                    ADLA    1,DL
         3 001750   000575 755000 1                  STA     COMM#

      540    13410    3                                 END;

  13410  3 001751   001764 710000 3                  TRA     s:13417

      541    13411    2                               ELSE
      542    13412    2                               IF PPUT$->MM$PPUT.USER#(PPNO) ~= 0

  13412  3 001752   000777 316003                    CANQ    511,DU
         3 001753   001764 600000 3                  TZE     s:13417

      543    13413    3                                 THEN DO;

      544    13414    3                                     USE_TABLE(PPNO) = 'SDS';

  13414  3 001754   200035 235100                    LDA     PPNO,,AUTO
         3 001755   000002 735000                    ALS     2
         3 001756   040105 100400                    MLR     fill='040'O
         3 001757   000311 000003 2                  ADSC9   FNFFMT+17                cn=0,n=3
         3 001760   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:87   

      545    13415    3                                     SDS# = SDS# + 1;

  13415  3 001761   000573 235000 1                  LDA     SDS#
         3 001762   000001 035007                    ADLA    1,DL
         3 001763   000573 755000 1                  STA     SDS#

      546    13416    3                                   END;

      547    13417    2           END;

  13417  3 001764   200035 054100                    AOS     PPNO,,AUTO
         3 001765   200031 236100                    LDQ     PCORE,,AUTO
         3 001766   001446 604000 3                  TMI     s:13340
         3 001767   200035 116100                    CMPQ    PPNO,,AUTO
         3 001770   001446 605000 3                  TPL     s:13340

      548    13418        /*
      549    13419        **
      550    13420        **      Run the free chain to see if there are any problems.
      551    13421        **      Note: On a running system FREE# will not equal FREE_CH#, but
      552    13422        **            they should be close.
      553    13423        */
      554    13424    1           CALL DAS$SDSRCHPTR (NAME_FPPH,OUT$) ALTRET (ALT);

  13424  3 001771   000040 630400 4                  EPPR0   32
         3 001772   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001773   000000 701000 xent               TSX1    DAS$SDSRCHPTR
         3 001774   003647 702000 3                  TSX2    ALT

      555    13425    1           CALL DAM$MAP (OUT$,OUT$,0,%MONWSR,V_) ALTRET (ALT);

  13425  3 001775   200656 630500                    EPPR0   V_,,AUTO
         3 001776   200676 450500                    STP0    @D2+5,,AUTO
         3 001777   000002 237000 4                  LDAQ    2
         3 002000   200674 757100                    STAQ    @D2+3,,AUTO
         3 002001   000042 237000 4                  LDAQ    34
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:88   
         3 002002   200672 757100                    STAQ    @D2+1,,AUTO
         3 002003   200672 630500                    EPPR0   @D2+1,,AUTO
         3 002004   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 002005   000000 701000 xent               TSX1    DAM$MAP
         3 002006   003647 702000 3                  TSX2    ALT

      556    13426    1           I = OUT$->B$WORD;

  13426  3 002007   000607 470400 1                  LDP0    OUT$
         3 002010   000000 235100                    LDA     0,,PR0
         3 002011   200022 755100                    STA     I,,AUTO

      557    13427    2           DO WHILE (I~=0);

  13427  3 002012   002106 600000 3                  TZE     s:13444

      558    13428    3             IF USE_TABLE(I) ~= 'FREE' THEN DO;

  13428  3 002013   200022 235100                    LDA     I,,AUTO
         3 002014   000002 735000                    ALS     2
         3 002015   200244 470500                    LDP0    USE$,,AUTO
         3 002016   040000 106505                    CMPC    fill='040'O
         3 002017   000000 000004                    ADSC9   0,A,PR0                  cn=0,n=4
         3 002020   000302 000004 2                  ADSC9   FNFFMT+10                cn=0,n=4
         3 002021   002066 600000 3                  TZE     s:13435

      559    13429    4                   IF ~PPUT_FLAG.MISC THEN DO;

  13429  3 002022   000577 236000 1                  LDQ     PPUT_FLAG
         3 002023   000004 736000                    QLS     4
         3 002024   400000 376003                    ANQ     -131072,DU
         3 002025   400000 676003                    ERQ     -131072,DU
         3 002026   002035 600000 3                  TZE     s:13433

      560    13430    4                         CALL DAF$INIT(PMRPRT);

  13430  3 002027   000060 630400 4                  EPPR0   48
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:89   
         3 002030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002031   000000 701000 xent               TSX1    DAF$INIT
         3 002032   000000 011000                    NOP     0

      561    13431    4                         PPUT_FLAG.MISC = '1'B;

  13431  3 002033   020000 236003                    LDQ     8192,DU
         3 002034   000577 256000 1                  ORSQ    PPUT_FLAG

      562    13432    4                       END;

      563    13433    3                   CALL DAF$WRITE( VECTOR(FNFFMT), VECTOR(I), VECTOR(USE_TABLE(I)));

  13433  3 002035   777640 235007                    LDA     -96,DL
         3 002036   200672 452500                    STP2    @D2+1,,AUTO
         3 002037   200672 236100                    LDQ     @D2+1,,AUTO
         3 002040   000022 036003                    ADLQ    18,DU
         3 002041   200674 757100                    STAQ    @D2+3,,AUTO
         3 002042   777640 235007                    LDA     -96,DL
         3 002043   200022 236100                    LDQ     I,,AUTO
         3 002044   000022 736000                    QLS     18
         3 002045   200244 036100                    ADLQ    USE$,,AUTO
         3 002046   200700 757100                    STAQ    @D2+7,,AUTO
         3 002047   200674 237100                    LDAQ    @D2+3,,AUTO
         3 002050   200676 757100                    STAQ    @D2+5,,AUTO
         3 002051   200700 237100                    LDAQ    @D2+7,,AUTO
         3 002052   200702 757100                    STAQ    @D2+9,,AUTO
         3 002053   200702 630500                    EPPR0   @D2+9,,AUTO
         3 002054   200706 450500                    STP0    @D2+13,,AUTO
         3 002055   200676 631500                    EPPR1   @D2+5,,AUTO
         3 002056   200705 451500                    STP1    @D2+12,,AUTO
         3 002057   000064 236000 4                  LDQ     52
         3 002060   200704 756100                    STQ     @D2+11,,AUTO
         3 002061   200704 630500                    EPPR0   @D2+11,,AUTO
         3 002062   000000 220000 xsym               LDX0    DAF$WRITE
         3 002063   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 002064   000000 701010                    TSX1    0,X0
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:90   
         3 002065   000000 011000                    NOP     0

      564    13434    3                 END;

      565    13435    2             USE_TABLE(I) = 'Free';

  13435  3 002066   200022 235100                    LDA     I,,AUTO
         3 002067   000002 735000                    ALS     2
         3 002070   200244 470500                    LDP0    USE$,,AUTO
         3 002071   040105 100400                    MLR     fill='040'O
         3 002072   000312 000004 2                  ADSC9   FNFFMT+18                cn=0,n=4
         3 002073   000000 000004                    ADSC9   0,A,PR0                  cn=0,n=4

      566    13436    2             FREE_CH# = FREE_CH# + 1;

  13436  3 002074   000566 235000 1                  LDA     FREE_CH#
         3 002075   000001 035007                    ADLA    1,DL
         3 002076   000566 755000 1                  STA     FREE_CH#

      567    13437    2             J = I;

  13437  3 002077   200022 236100                    LDQ     I,,AUTO
         3 002100   200025 756100                    STQ     J,,AUTO

      568    13438    2             I = PPUT$->MM$PPUT.PPNO(I);

  13438  3 002101   000611 471400 1                  LDP1    PPUT$
         3 002102   100000 236106                    LDQ     0,QL,PR1
         3 002103   777777 376007                    ANQ     -1,DL
         3 002104   200022 756100                    STQ     I,,AUTO

      569    13439    2           END;

  13439  3 002105   002013 601000 3                  TNZ     s:13428

      570    13440        /*
      571    13441        **
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:91   
      572    13442        **      Mark monitor overlay pages as such
      573    13443        */
      574    13444    1           CALL DAM$MAP(B$SEGTBL$,SEGTBL$,0,%MONWSR)

  13444  3 002106   000065 630400 4                  EPPR0   53
         3 002107   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 002110   000000 701000 xent               TSX1    DAM$MAP
         3 002111   002174 702000 3                  TSX2    s:13461

      575    13445    2             WHENRETURN DO;

      576    13446    3                 DO J = 0 TO 3;

  13446  3 002112   200025 450100                    STZ     J,,AUTO

      577    13447    3                   SEGP$ = PINCRW (SEGTBL$ , SEGTBL.NODES.WOFF (J));

  13447  3 002113   000612 470400 1                  LDP0    SEGTBL$
         3 002114   200025 720100                    LXL0    J,,AUTO
         3 002115   000001 236110                    LDQ     1,X0,PR0
         3 002116   000024 772000                    QRL     20
         3 002117   000022 736000                    QLS     18
         3 002120   000612 036000 1                  ADLQ    SEGTBL$
         3 002121   200242 756100                    STQ     SEGP$,,AUTO

      578    13448    3                   I = SEGTBL.NODES.WSIZ (J) - 1;

  13448  3 002122   000001 236110                    LDQ     1,X0,PR0
         3 002123   000002 772000                    QRL     2
         3 002124   177777 376007                    ANQ     65535,DL
         3 002125   000001 136007                    SBLQ    1,DL
         3 002126   200022 756100                    STQ     I,,AUTO

      579    13449    4                   DO UNTIL (I < 0);

      580    13450    4                     IF SEGPT.RPN(I)~=%FPMC

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:92   
  13450  3 002127   200242 470500                    LDP0    SEGP$,,AUTO
         3 002130   200022 720100                    LXL0    I,,AUTO
         3 002131   000000 221110                    LDX1    0,X0,PR0
         3 002132   777777 101003                    CMPX1   -1,DU
         3 002133   002163 600000 3                  TZE     s:13456

      581    13451    5                       THEN DO;

      582    13452    5                           USE_TABLE (SEGPT.RPN(I)) = 'Oly';

  13452  3 002134   000000 236110                    LDQ     0,X0,PR0
         3 002135   000022 772000                    QRL     18
         3 002136   000002 736000                    QLS     2
         3 002137   200244 471500                    LDP1    USE$,,AUTO
         3 002140   040106 100400                    MLR     fill='040'O
         3 002141   000313 000003 2                  ADSC9   FNFFMT+19                cn=0,n=3
         3 002142   100000 000004                    ADSC9   0,Q,PR1                  cn=0,n=4

      583    13453    5                           CALL BINCHAR(SUBSTR(USE_TABLE(SEGPT.RPN(I)),3,1),J+1);

  13453  3 002143   200022 720100                    LXL0    I,,AUTO
         3 002144   000000 236110                    LDQ     0,X0,PR0
         3 002145   000022 772000                    QRL     18
         3 002146   000002 736000                    QLS     2
         3 002147   200025 235100                    LDA     J,,AUTO
         3 002150   000001 035007                    ADLA    1,DL
         3 002151   200672 756100                    STQ     @D2+1,,AUTO
         3 002152   000044 773000                    LRL     36
         3 002153   200674 757100                    STAQ    @D2+3,,AUTO
         3 002154   200672 235100                    LDA     @D2+1,,AUTO
         3 002155   000105 301500                    BTD
         3 002156   200674 000010                    NDSC9   @D2+3,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         3 002157   100000 630001                    NDSC9   0,A,PR1                  cn=3,s=nosgn,sf=0,n=1

      584    13454    5                           MON# = MON# + 1;

  13454  3 002160   000603 235000 1                  LDA     MON#
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:93   
         3 002161   000001 035007                    ADLA    1,DL
         3 002162   000603 755000 1                  STA     MON#

      585    13455    5                         END;

      586    13456    4                     I = I - 1;

  13456  3 002163   000001 336007                    LCQ     1,DL
         3 002164   200022 056100                    ASQ     I,,AUTO

      587    13457    4                   END;

  13457  3 002165   002127 605000 3                  TPL     s:13450

      588    13458    3                 END;

  13458  3 002166   200025 235100                    LDA     J,,AUTO
         3 002167   000001 035007                    ADLA    1,DL
         3 002170   200025 755100                    STA     J,,AUTO
         3 002171   000004 115007                    CMPA    4,DL
         3 002172   002113 602000 3                  TNC     s:13447

      589    13459    2               END;

  13459  3 002173   002214 710000 3                  TRA     s:13471

      590    13460    2             WHENALTRETURN DO;

      591    13461    3                 IF ~PPUT_FLAG.MISC THEN DO;

  13461  3 002174   000577 236000 1                  LDQ     PPUT_FLAG
         3 002175   000004 736000                    QLS     4
         3 002176   400000 376003                    ANQ     -131072,DU
         3 002177   400000 676003                    ERQ     -131072,DU
         3 002200   002207 600000 3                  TZE     s:13465

      592    13462    3                       CALL DAF$INIT(PMRPRT);
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:94   

  13462  3 002201   000060 630400 4                  EPPR0   48
         3 002202   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002203   000000 701000 xent               TSX1    DAF$INIT
         3 002204   000000 011000                    NOP     0

      593    13463    3                       PPUT_FLAG.MISC = '1'B;

  13463  3 002205   020000 236003                    LDQ     8192,DU
         3 002206   000577 256000 1                  ORSQ    PPUT_FLAG

      594    13464    3                     END;

      595    13465    2                 CALL DAF$WRITE(VECTOR(NO_OVRLYS));

  13465  3 002207   000074 630400 4                  EPPR0   60
         3 002210   000000 220000 xsym               LDX0    DAF$WRITE
         3 002211   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002212   000000 701010                    TSX1    0,X0
         3 002213   000000 011000                    NOP     0

      596    13466    2               END;

      597    13467        /*
      598    13468        **
      599    13469        **      Go through the monitor map and mark stuff from it.
      600    13470        */
      601    13471    1           CALL DAM$MAP (B$MPT$, MPT$, 0, %MONWSR) ALTRET (ALT);

  13471  3 002214   000075 630400 4                  EPPR0   61
         3 002215   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 002216   000000 701000 xent               TSX1    DAM$MAP
         3 002217   003647 702000 3                  TSX2    ALT

      602    13472    2           DO I = 0 TO 1023;

  13472  3 002220   200022 450100                    STZ     I,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:95   

      603    13473    2             PPNO = MPT$->B$MAP.RPN(I);

  13473  3 002221   000610 470400 1                  LDP0    MPT$
         3 002222   200022 720100                    LXL0    I,,AUTO
         3 002223   000000 236110                    LDQ     0,X0,PR0
         3 002224   000022 772000                    QRL     18
         3 002225   200035 756100                    STQ     PPNO,,AUTO

      604    13474    2             IF PPNO~=%FPMC THEN IF USE_TABLE(PPNO) = %UNKNOWN

  13474  3 002226   777777 116007                    CMPQ    -1,DL
         3 002227   002442 600000 3                  TZE     s:13541

  13474  3 002230   200035 235100                    LDA     PPNO,,AUTO
         3 002231   000002 735000                    ALS     2
         3 002232   200244 471500                    LDP1    USE$,,AUTO
         3 002233   040000 106505                    CMPC    fill='040'O
         3 002234   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4
         3 002235   000301 000004 2                  ADSC9   FNFFMT+9                 cn=0,n=4
         3 002236   002442 601000 3                  TNZ     s:13541

      605    13475    3                 THEN DO;

      606    13476    3                     IF %MOUSELO<=I AND I<=%MOUSEHI

  13476  3 002237   200022 235100                    LDA     I,,AUTO
         3 002240   000540 115007                    CMPA    352,DL
         3 002241   002252 604000 3                  TMI     s:13481
         3 002242   000547 115007                    CMPA    359,DL
         3 002243   002252 605400 3                  TPNZ    s:13481

      607    13477    4                       THEN DO;

      608    13478    4                           USE_TABLE(PPNO) ='MoUsE';

  13478  3 002244   200035 235100                    LDA     PPNO,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:96   
         3 002245   000002 735000                    ALS     2
         3 002246   040105 100400                    MLR     fill='040'O
         3 002247   000314 000004 2                  ADSC9   FNFFMT+20                cn=0,n=4
         3 002250   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      609    13479    4                         END;

  13479  3 002251   002442 710000 3                  TRA     s:13541

      610    13480    3                       ELSE
      611    13481    3                       IF %CFULO<=I AND I<=%CFUHI

  13481  3 002252   001130 115007                    CMPA    600,DL
         3 002253   002267 604000 3                  TMI     s:13487
         3 002254   001211 115007                    CMPA    649,DL
         3 002255   002267 605400 3                  TPNZ    s:13487

      612    13482    4                         THEN DO;

      613    13483    4                             USE_TABLE(PPNO) = 'CFU';

  13483  3 002256   200035 235100                    LDA     PPNO,,AUTO
         3 002257   000002 735000                    ALS     2
         3 002260   040105 100400                    MLR     fill='040'O
         3 002261   000316 000003 2                  ADSC9   FNFFMT+22                cn=0,n=3
         3 002262   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      614    13484    4                             MONDS# = MONDS# + 1;

  13484  3 002263   000600 235000 1                  LDA     MONDS#
         3 002264   000001 035007                    ADLA    1,DL
         3 002265   000600 755000 1                  STA     MONDS#

      615    13485    4                           END;

  13485  3 002266   002442 710000 3                  TRA     s:13541

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:97   
      616    13486    3                         ELSE
      617    13487    3                         IF %ASAVELO<=I AND I<=%ASAVEHI

  13487  3 002267   001212 115007                    CMPA    650,DL
         3 002270   002304 604000 3                  TMI     s:13493
         3 002271   001235 115007                    CMPA    669,DL
         3 002272   002304 605400 3                  TPNZ    s:13493

      618    13488    4                           THEN DO;

      619    13489    4                               USE_TABLE(PPNO)='Asave';

  13489  3 002273   200035 235100                    LDA     PPNO,,AUTO
         3 002274   000002 735000                    ALS     2
         3 002275   040105 100400                    MLR     fill='040'O
         3 002276   000317 000004 2                  ADSC9   FNFFMT+23                cn=0,n=4
         3 002277   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      620    13490    4                               MONDS# = MONDS# + 1;

  13490  3 002300   000600 235000 1                  LDA     MONDS#
         3 002301   000001 035007                    ADLA    1,DL
         3 002302   000600 755000 1                  STA     MONDS#

      621    13491    4                             END;

  13491  3 002303   002442 710000 3                  TRA     s:13541

      622    13492    3                           ELSE
      623    13493    3                           IF %ENQLO<=I AND I<=%ENQHI

  13493  3 002304   001236 115007                    CMPA    670,DL
         3 002305   002321 604000 3                  TMI     s:13499
         3 002306   001265 115007                    CMPA    693,DL
         3 002307   002321 605400 3                  TPNZ    s:13499

      624    13494    4                             THEN DO;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:98   

      625    13495    4                                 USE_TABLE(PPNO)='ENQ';

  13495  3 002310   200035 235100                    LDA     PPNO,,AUTO
         3 002311   000002 735000                    ALS     2
         3 002312   040105 100400                    MLR     fill='040'O
         3 002313   000321 000003 2                  ADSC9   FNFFMT+25                cn=0,n=3
         3 002314   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      626    13496    4                                 MONDS# = MONDS# + 1;

  13496  3 002315   000600 235000 1                  LDA     MONDS#
         3 002316   000001 035007                    ADLA    1,DL
         3 002317   000600 755000 1                  STA     MONDS#

      627    13497    4                               END;

  13497  3 002320   002442 710000 3                  TRA     s:13541

      628    13498    3                             ELSE
      629    13499    3                             IF %LDCTLO<=I AND I<=%LDCTHI

  13499  3 002321   001650 115007                    CMPA    936,DL
         3 002322   002336 604000 3                  TMI     s:13505
         3 002323   001777 115007                    CMPA    1023,DL
         3 002324   002336 605400 3                  TPNZ    s:13505

      630    13500    4                               THEN DO;

      631    13501    4                                   USE_TABLE(PPNO)='LDCT';

  13501  3 002325   200035 235100                    LDA     PPNO,,AUTO
         3 002326   000002 735000                    ALS     2
         3 002327   040105 100400                    MLR     fill='040'O
         3 002330   000322 000004 2                  ADSC9   FNFFMT+26                cn=0,n=4
         3 002331   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:99   
      632    13502    4                                   MONDS# = MONDS# + 1;

  13502  3 002332   000600 235000 1                  LDA     MONDS#
         3 002333   000001 035007                    ADLA    1,DL
         3 002334   000600 755000 1                  STA     MONDS#

      633    13503    4                                 END;

  13503  3 002335   002442 710000 3                  TRA     s:13541

      634    13504    3                               ELSE
      635    13505    3                               IF %TIGRLO<=I AND I<=%TIGRHI

  13505  3 002336   000610 115007                    CMPA    392,DL
         3 002337   002353 604000 3                  TMI     s:13511
         3 002340   001007 115007                    CMPA    519,DL
         3 002341   002353 605400 3                  TPNZ    s:13511

      636    13506    4                                 THEN DO;

      637    13507    4                                     USE_TABLE(PPNO)='TIGR';

  13507  3 002342   200035 235100                    LDA     PPNO,,AUTO
         3 002343   000002 735000                    ALS     2
         3 002344   040105 100400                    MLR     fill='040'O
         3 002345   000323 000004 2                  ADSC9   FNFFMT+27                cn=0,n=4
         3 002346   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      638    13508    4                                     TIGR# = TIGR# + 1;

  13508  3 002347   000601 235000 1                  LDA     TIGR#
         3 002350   000001 035007                    ADLA    1,DL
         3 002351   000601 755000 1                  STA     TIGR#

      639    13509    4                                   END;

  13509  3 002352   002442 710000 3                  TRA     s:13541
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:100  

      640    13510    3                                 ELSE
      641    13511    3                                 IF %FIRMWREPG<=I AND I<=%FIRMWREHI

  13511  3 002353   001010 115007                    CMPA    520,DL
         3 002354   002370 604000 3                  TMI     s:13517
         3 002355   001047 115007                    CMPA    551,DL
         3 002356   002370 605400 3                  TPNZ    s:13517

      642    13512    4                                   THEN DO;

      643    13513    4                                       USE_TABLE(PPNO)='Firm';

  13513  3 002357   200035 235100                    LDA     PPNO,,AUTO
         3 002360   000002 735000                    ALS     2
         3 002361   040105 100400                    MLR     fill='040'O
         3 002362   000324 000004 2                  ADSC9   FNFFMT+28                cn=0,n=4
         3 002363   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      644    13514    4                                       FIRM# = FIRM# + 1;

  13514  3 002364   000602 235000 1                  LDA     FIRM#
         3 002365   000001 035007                    ADLA    1,DL
         3 002366   000602 755000 1                  STA     FIRM#

      645    13515    4                                     END;

  13515  3 002367   002442 710000 3                  TRA     s:13541

      646    13516    3                                   ELSE
      647    13517    3                                   IF %MASTERPTPG<=I AND I<=%SLV7HJITPG

  13517  3 002370   000550 115007                    CMPA    360,DL
         3 002371   002375 604000 3                  TMI     s:13521
         3 002372   000567 115007                    CMPA    375,DL
         3 002373   002375 605400 3                  TPNZ    s:13521

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:101  
      648    13518    4                                     THEN DO;

      649    13519    4                                       END;

  13519  3 002374   002442 710000 3                  TRA     s:13541

      650    13520    3                                     ELSE
      651    13521    3                                     IF %ISEGLO<I AND I<=%ISEGHI
             13521                                              /* PAGE 0 SHOULD BE CXT */

  13521  3 002375   000100 115007                    CMPA    64,DL
         3 002376   002412 604400 3                  TMOZ    s:13527
         3 002377   000477 115007                    CMPA    319,DL
         3 002400   002412 605400 3                  TPNZ    s:13527

      652    13522    4                                       THEN DO;

      653    13523    4                                           USE_TABLE(PPNO) = 'MON';

  13523  3 002401   200035 235100                    LDA     PPNO,,AUTO
         3 002402   000002 735000                    ALS     2
         3 002403   040105 100400                    MLR     fill='040'O
         3 002404   000325 000003 2                  ADSC9   FNFFMT+29                cn=0,n=3
         3 002405   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      654    13524    4                                           MON# = MON# + 1;

  13524  3 002406   000603 235000 1                  LDA     MON#
         3 002407   000001 035007                    ADLA    1,DL
         3 002410   000603 755000 1                  STA     MON#

      655    13525    4                                         END;

  13525  3 002411   002442 710000 3                  TRA     s:13541

      656    13526    3                                       ELSE
      657    13527    3                                       IF %REALLO<=I AND I<=%REALHI
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:102  

  13527  3 002412   000500 115007                    CMPA    320,DL
         3 002413   002427 604000 3                  TMI     s:13533
         3 002414   000507 115007                    CMPA    327,DL
         3 002415   002427 605400 3                  TPNZ    s:13533

      658    13528    4                                         THEN DO;

      659    13529    4                                             USE_TABLE(PPNO) = 'Real';

  13529  3 002416   200035 235100                    LDA     PPNO,,AUTO
         3 002417   000002 735000                    ALS     2
         3 002420   040105 100400                    MLR     fill='040'O
         3 002421   000326 000004 2                  ADSC9   FNFFMT+30                cn=0,n=4
         3 002422   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      660    13530    4                                             LOW# = LOW# + 1;

  13530  3 002423   000605 235000 1                  LDA     LOW#
         3 002424   000001 035007                    ADLA    1,DL
         3 002425   000605 755000 1                  STA     LOW#

      661    13531    4                                           END;

  13531  3 002426   002442 710000 3                  TRA     s:13541

      662    13532    3                                         ELSE
      663    13533    3                                         IF %SEGTBL=I
             13533                                                  /* ONLY ONE PAGE FOR OVERLAY TABLE */

  13533  3 002427   000077 115007                    CMPA    63,DL
         3 002430   002442 601000 3                  TNZ     s:13541

      664    13534    4                                           THEN DO;

      665    13535    4                                               USE_TABLE(PPNO) = 'OlyT';

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:103  
  13535  3 002431   200035 235100                    LDA     PPNO,,AUTO
         3 002432   000002 735000                    ALS     2
         3 002433   040105 100400                    MLR     fill='040'O
         3 002434   000327 000004 2                  ADSC9   FNFFMT+31                cn=0,n=4
         3 002435   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4

      666    13536    4                                               MON# = MON# + 1;

  13536  3 002436   000603 235000 1                  LDA     MON#
         3 002437   000001 035007                    ADLA    1,DL
         3 002440   000603 755000 1                  STA     MON#

      667    13537    4                                             END;

  13537  3 002441   002442 710000 3                  TRA     s:13541

      668    13538    4                                           ELSE DO;

      669    13539    4                                             END;

      670    13540    3                   END;

      671    13541    2           END;

  13541  3 002442   200022 054100                    AOS     I,,AUTO
         3 002443   200022 235100                    LDA     I,,AUTO
         3 002444   001777 115007                    CMPA    1023,DL
         3 002445   002221 604400 3                  TMOZ    s:13473

      672    13542        /*
      673    13543        **
      674    13544        **      Cycle through cpus to get context. (cpu specific)
      675    13545        */
      676    13546    2           DO J = 0 TO 5;                  /* CYCLE THROUGH THE CPUS             */

  13546  3 002446   200025 450100                    STZ     J,,AUTO

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:104  
      677    13547    2             CALL DAM$USECPU (J);

  13547  3 002447   200025 630500                    EPPR0   J,,AUTO
         3 002450   200672 450500                    STP0    @D2+1,,AUTO
         3 002451   200672 630500                    EPPR0   @D2+1,,AUTO
         3 002452   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002453   000000 701000 xent               TSX1    DAM$USECPU
         3 002454   000000 011000                    NOP     0

      678    13548    2             IF RUNNING

  13548  3 002455   200241 234100                    SZN     RUNNING,,AUTO
         3 002456   002473 605000 3                  TPL     s:13552

      679    13549    2               THEN
      680    13550    2               CALL DAM$MAP (CPUPT$(J),MPT$,0,%MONWSR) ALTRET (NEXT);

  13550  3 002457   000002 237000 4                  LDAQ    2
         3 002460   200674 757100                    STAQ    @D2+3,,AUTO
         3 002461   000076 236000 4                  LDQ     62
         3 002462   200673 756100                    STQ     @D2+2,,AUTO
         3 002463   200025 720100                    LXL0    J,,AUTO
         3 002464   000074 630410 2                  EPPR0   CPUPT,X0
         3 002465   200672 450500                    STP0    @D2+1,,AUTO
         3 002466   200672 630500                    EPPR0   @D2+1,,AUTO
         3 002467   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 002470   000000 701000 xent               TSX1    DAM$MAP
         3 002471   002555 702000 3                  TSX2    NEXT
         3 002472   002477 710000 3                  TRA     s:13553

      681    13551    2               ELSE
      682    13552    2               CALL DAM$MAP(B$MPT$,MPT$,0,%MONWSR) ALTRET (NEXT);

  13552  3 002473   000075 630400 4                  EPPR0   61
         3 002474   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 002475   000000 701000 xent               TSX1    DAM$MAP
         3 002476   002555 702000 3                  TSX2    NEXT
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:105  

      683    13553    3             DO I = 0 TO 1023;

  13553  3 002477   200022 450100                    STZ     I,,AUTO

      684    13554    3               PPNO = MPT$->B$MAP.RPN(I);

  13554  3 002500   000610 470400 1                  LDP0    MPT$
         3 002501   200022 720100                    LXL0    I,,AUTO
         3 002502   000000 236110                    LDQ     0,X0,PR0
         3 002503   000022 772000                    QRL     18
         3 002504   200035 756100                    STQ     PPNO,,AUTO

      685    13555    3               IF PPNO~=%FPMC THEN IF USE_TABLE(PPNO) = %UNKNOWN AND (%MASTERPTPG>I OR
             13555                        I>%SLV7HJITPG) AND (%WINDOWLO>I OR I>%WINDOWHI)

  13555  3 002505   777777 116007                    CMPQ    -1,DL
         3 002506   002551 600000 3                  TZE     s:13561

  13555  3 002507   200035 235100                    LDA     PPNO,,AUTO
         3 002510   000002 735000                    ALS     2
         3 002511   200244 471500                    LDP1    USE$,,AUTO
         3 002512   040000 106505                    CMPC    fill='040'O
         3 002513   100000 000004                    ADSC9   0,A,PR1                  cn=0,n=4
         3 002514   000301 000004 2                  ADSC9   FNFFMT+9                 cn=0,n=4
         3 002515   002551 601000 3                  TNZ     s:13561
         3 002516   200022 235100                    LDA     I,,AUTO
         3 002517   000550 115007                    CMPA    360,DL
         3 002520   002523 604000 3                  TMI     s:13555+14
         3 002521   000567 115007                    CMPA    375,DL
         3 002522   002551 604400 3                  TMOZ    s:13561
         3 002523   000063 115007                    CMPA    51,DL
         3 002524   002527 604000 3                  TMI     s:13557
         3 002525   000074 115007                    CMPA    60,DL
         3 002526   002551 604400 3                  TMOZ    s:13561

      686    13556    4                   THEN DO;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:106  

      687    13557    4                       USE_TABLE(PPNO) = CPUNAME(J);

  13557  3 002527   200025 235100                    LDA     J,,AUTO
         3 002530   000002 735000                    ALS     2
         3 002531   000002 736000                    QLS     2
         3 002532   040106 100405                    MLR     fill='040'O
         3 002533   000102 000004 2                  ADSC9   CPUNAME,A                cn=0,n=4
         3 002534   100000 000004                    ADSC9   0,Q,PR1                  cn=0,n=4

      688    13558    4                       IF %CGPGTBLLO<=I AND I<=%PGTBLHI THEN USE_TABLE(PPNO)='CGPT';

  13558  3 002535   200022 235100                    LDA     I,,AUTO
         3 002536   002546 604400 3                  TMOZ    s:13559
         3 002537   000012 115007                    CMPA    10,DL
         3 002540   002546 605400 3                  TPNZ    s:13559

  13558  3 002541   200035 236100                    LDQ     PPNO,,AUTO
         3 002542   000002 736000                    QLS     2
         3 002543   040106 100400                    MLR     fill='040'O
         3 002544   000330 000004 2                  ADSC9   FNFFMT+32                cn=0,n=4
         3 002545   100000 000004                    ADSC9   0,Q,PR1                  cn=0,n=4

      689    13559    4                       MONCXT# = MONCXT# + 1;

  13559  3 002546   000604 235000 1                  LDA     MONCXT#
         3 002547   000001 035007                    ADLA    1,DL
         3 002550   000604 755000 1                  STA     MONCXT#

      690    13560    4                     END;

      691    13561    3             END;

  13561  3 002551   200022 054100                    AOS     I,,AUTO
         3 002552   200022 235100                    LDA     I,,AUTO
         3 002553   001777 115007                    CMPA    1023,DL
         3 002554   002500 604400 3                  TMOZ    s:13554
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:107  

      692    13562    2   NEXT:   END;

  13562  3 002555   200025 235100       NEXT         LDA     J,,AUTO
         3 002556   000001 035007                    ADLA    1,DL
         3 002557   200025 755100                    STA     J,,AUTO
         3 002560   000006 115007                    CMPA    6,DL
         3 002561   002447 602000 3                  TNC     s:13547

      693    13563        /*
      694    13564        **
      695    13565        **      Mark pages used as for PPUT.
      696    13566        */
      697    13567    1           CALL DAM$USECPU(0);

  13567  3 002562   000002 630400 4                  EPPR0   2
         3 002563   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002564   000000 701000 xent               TSX1    DAM$USECPU
         3 002565   000000 011000                    NOP     0

      698    13568    1           CALL DAM$MAP (B$MONHJIT$, OUT$, 0, %MONWSR) ALTRET (ALT);

  13568  3 002566   000101 630400 4                  EPPR0   65
         3 002567   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 002570   000000 701000 xent               TSX1    DAM$MAP
         3 002571   003647 702000 3                  TSX2    ALT

      699    13569    1           DWORD = OUT$->B$DWORDS(BITBIN(%PPUTSID&'1777'O));

  13569  3 002572   000607 470400 1                  LDP0    OUT$
         3 002573   000234 237100                    LDAQ    156,,PR0
         3 002574   200016 757100                    STAQ    DWORD,,AUTO

      700    13570    1           J = DBASE(DESC)/4096;

  13570  3 002575   200017 236100                    LDQ     DWORD+1,,AUTO
         3 002576   000014 772000                    QRL     12
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:108  
         3 002577   200025 756100                    STQ     J,,AUTO

      701    13571    1           K = J + DBOUND(DESC)/4096;

  13571  3 002600   200016 236100                    LDQ     DWORD,,AUTO
         3 002601   000020 772000                    QRL     16
         3 002602   000014 772000                    QRL     12
         3 002603   200025 036100                    ADLQ    J,,AUTO
         3 002604   200026 756100                    STQ     K,,AUTO

      702    13572    2           DO I = J TO K;

  13572  3 002605   200025 235100                    LDA     J,,AUTO
         3 002606   200022 755100                    STA     I,,AUTO
         3 002607   002633 710000 3                  TRA     s:13576+1

      703    13573    2             IF USE_TABLE(I) ~= %UNKNOWN THEN CALL M$XXX;

  13573  3 002610   200022 235100                    LDA     I,,AUTO
         3 002611   000002 735000                    ALS     2
         3 002612   200244 470500                    LDP0    USE$,,AUTO
         3 002613   040000 106505                    CMPC    fill='040'O
         3 002614   000000 000004                    ADSC9   0,A,PR0                  cn=0,n=4
         3 002615   000301 000004 2                  ADSC9   FNFFMT+9                 cn=0,n=4
         3 002616   002621 600000 3                  TZE     s:13574

  13573  3 002617   000003 713400                    CLIMB   3
         3 002620   000000 401760                    pmme    nvectors=0

      704    13574    2             USE_TABLE(I) = 'PPUT';

  13574  3 002621   200022 235100                    LDA     I,,AUTO
         3 002622   000002 735000                    ALS     2
         3 002623   200244 470500                    LDP0    USE$,,AUTO
         3 002624   040105 100400                    MLR     fill='040'O
         3 002625   000331 000004 2                  ADSC9   FNFFMT+33                cn=0,n=4
         3 002626   000000 000004                    ADSC9   0,A,PR0                  cn=0,n=4
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:109  

      705    13575    2             PPUT# = PPUT# + 1;

  13575  3 002627   000576 235000 1                  LDA     PPUT#
         3 002630   000001 035007                    ADLA    1,DL
         3 002631   000576 755000 1                  STA     PPUT#

      706    13576    2           END;

  13576  3 002632   200022 054100                    AOS     I,,AUTO
         3 002633   200026 236100                    LDQ     K,,AUTO
         3 002634   002610 604000 3                  TMI     s:13573
         3 002635   200022 116100                    CMPQ    I,,AUTO
         3 002636   002610 605000 3                  TPL     s:13573

      707    13577        /*
      708    13578        **
      709    13579        **      See how many are "lost", and total up counts.
      710    13580        */
      711    13581    2           DO I = 0 TO PCORE;

  13581  3 002637   200022 450100                    STZ     I,,AUTO
         3 002640   002654 710000 3                  TRA     s:13583+1

      712    13582    2             IF USE_TABLE(I) = %UNKNOWN THEN LOST# = LOST# + 1;

  13582  3 002641   200022 235100                    LDA     I,,AUTO
         3 002642   000002 735000                    ALS     2
         3 002643   200244 470500                    LDP0    USE$,,AUTO
         3 002644   040000 106505                    CMPC    fill='040'O
         3 002645   000000 000004                    ADSC9   0,A,PR0                  cn=0,n=4
         3 002646   000301 000004 2                  ADSC9   FNFFMT+9                 cn=0,n=4
         3 002647   002653 601000 3                  TNZ     s:13583

  13582  3 002650   000606 236000 1                  LDQ     LOST#
         3 002651   000001 036007                    ADLQ    1,DL
         3 002652   000606 756000 1                  STQ     LOST#
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:110  

      713    13583    2           END;

  13583  3 002653   200022 054100                    AOS     I,,AUTO
         3 002654   200031 236100                    LDQ     PCORE,,AUTO
         3 002655   002641 604000 3                  TMI     s:13582
         3 002656   200022 116100                    CMPQ    I,,AUTO
         3 002657   002641 605000 3                  TPL     s:13582

      714    13584
      715    13585    1           I=FREE#+IO#+DIAG#+U#+P#+STOLE#+COMM#+PPUT#+MONDS#+TIGR#+FIRM#+MON#+MONCXT#+
             13585                    SDS#+LOW#+LOST#;

  13585  3 002660   000565 236000 1                  LDQ     FREE#
         3 002661   000567 036000 1                  ADLQ    IO#
         3 002662   000570 036000 1                  ADLQ    DIAG#
         3 002663   000571 036000 1                  ADLQ    U#
         3 002664   000572 036000 1                  ADLQ    P#
         3 002665   000574 036000 1                  ADLQ    STOLE#
         3 002666   000575 036000 1                  ADLQ    COMM#
         3 002667   000576 036000 1                  ADLQ    PPUT#
         3 002670   000600 036000 1                  ADLQ    MONDS#
         3 002671   000601 036000 1                  ADLQ    TIGR#
         3 002672   000602 036000 1                  ADLQ    FIRM#
         3 002673   000603 036000 1                  ADLQ    MON#
         3 002674   000604 036000 1                  ADLQ    MONCXT#
         3 002675   000573 036000 1                  ADLQ    SDS#
         3 002676   000605 036000 1                  ADLQ    LOW#
         3 002677   000606 036000 1                  ADLQ    LOST#
         3 002700   200022 756100                    STQ     I,,AUTO

      716    13586    1           J=PCORE+1;

  13586  3 002701   200031 235100                    LDA     PCORE,,AUTO
         3 002702   000001 035007                    ADLA    1,DL
         3 002703   200025 755100                    STA     J,,AUTO

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:111  
      717    13587        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:112  
      718    13588        /*
      719    13589        **
      720    13590        **      Write summary.
      721    13591        */
      722    13592    1           IF ~PPUT_FLAG.SUMMARY THEN

  13592  3 002704   000577 236000 1                  LDQ     PPUT_FLAG
         3 002705   400000 376003                    ANQ     -131072,DU
         3 002706   400000 676003                    ERQ     -131072,DU
         3 002707   002765 601000 3                  TNZ     DO_PROCESSOR

      723    13593    1             GOTO DO_PROCESSOR;
      724    13594    1           CALL DAF$INIT(PSRPRT);

  13594  3 002710   000105 630400 4                  EPPR0   69
         3 002711   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002712   000000 701000 xent               TSX1    DAF$INIT
         3 002713   000000 011000                    NOP     0

      725    13595    1           CALL DAF$WRITE(VECTOR(SUMFMT),
      726    13596    1             VECTOR(FREE#), VECTOR(FREE_CH#),
      727    13597    1             VECTOR(IO#),
      728    13598    1             VECTOR(DIAG#),
      729    13599    1             VECTOR(U#),
      730    13600    1             VECTOR(P#),
      731    13601    1             VECTOR(SDS#),
      732    13602    1             VECTOR(STOLE#),
      733    13603    1             VECTOR(COMM#),
      734    13604    1             VECTOR(PPUT#),
      735    13605    1             VECTOR(MONDS#),
      736    13606    1             VECTOR(TIGR#),
      737    13607    1             VECTOR(FIRM#),
      738    13608    1             VECTOR(MON#),
      739    13609    1             VECTOR(MONCXT#),
      740    13610    1             VECTOR(LOW#),
      741    13611    1             VECTOR(LOST#),
      742    13612    1             VECTOR(I),
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:113  
      743    13613    1             VECTOR(J));

  13613  3 002714   777640 235007                    LDA     -96,DL
         3 002715   200672 452500                    STP2    @D2+1,,AUTO
         3 002716   200672 236100                    LDQ     @D2+1,,AUTO
         3 002717   000022 036003                    ADLQ    18,DU
         3 002720   200674 757100                    STAQ    @D2+3,,AUTO
         3 002721   777640 235007                    LDA     -96,DL
         3 002722   200676 452500                    STP2    @D2+5,,AUTO
         3 002723   200676 236100                    LDQ     @D2+5,,AUTO
         3 002724   000025 036003                    ADLQ    21,DU
         3 002725   200702 757100                    STAQ    @D2+9,,AUTO
         3 002726   200674 237100                    LDAQ    @D2+3,,AUTO
         3 002727   200700 757100                    STAQ    @D2+7,,AUTO
         3 002730   200702 237100                    LDAQ    @D2+9,,AUTO
         3 002731   200704 757100                    STAQ    @D2+11,,AUTO
         3 002732   200704 630500                    EPPR0   @D2+11,,AUTO
         3 002733   200731 450500                    STP0    @D2+32,,AUTO
         3 002734   200700 631500                    EPPR1   @D2+7,,AUTO
         3 002735   200730 451500                    STP1    @D2+31,,AUTO
         3 002736   000154 237000 4                  LDAQ    108
         3 002737   200726 757100                    STAQ    @D2+29,,AUTO
         3 002740   000156 237000 4                  LDAQ    110
         3 002741   200724 757100                    STAQ    @D2+27,,AUTO
         3 002742   000160 237000 4                  LDAQ    112
         3 002743   200722 757100                    STAQ    @D2+25,,AUTO
         3 002744   000162 237000 4                  LDAQ    114
         3 002745   200720 757100                    STAQ    @D2+23,,AUTO
         3 002746   000164 237000 4                  LDAQ    116
         3 002747   200716 757100                    STAQ    @D2+21,,AUTO
         3 002750   000166 237000 4                  LDAQ    118
         3 002751   200714 757100                    STAQ    @D2+19,,AUTO
         3 002752   000170 237000 4                  LDAQ    120
         3 002753   200712 757100                    STAQ    @D2+17,,AUTO
         3 002754   000172 237000 4                  LDAQ    122
         3 002755   200710 757100                    STAQ    @D2+15,,AUTO
         3 002756   000174 237000 4                  LDAQ    124
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:114  
         3 002757   200706 757100                    STAQ    @D2+13,,AUTO
         3 002760   200706 630500                    EPPR0   @D2+13,,AUTO
         3 002761   000000 220000 xsym               LDX0    DAF$WRITE
         3 002762   000152 631400 4                  EPPR1   106
         3 002763   000000 701010                    TSX1    0,X0
         3 002764   000000 011000                    NOP     0

      744    13614        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:115  
      745    13615        /*
      746    13616        **
      747    13617        **      Write processor/user counts.
      748    13618        */
      749    13619    1   DO_PROCESSOR:
      750    13620    1           IF ~PPUT_FLAG.PROCESSOR THEN

  13620  3 002765   000577 236000 1     DO_PROCESSOR LDQ     PPUT_FLAG
         3 002766   000001 736000                    QLS     1
         3 002767   400000 376003                    ANQ     -131072,DU
         3 002770   400000 676003                    ERQ     -131072,DU
         3 002771   003223 601000 3                  TNZ     DO_USER

      751    13621    1             GOTO DO_USER;
      752    13622    1           CALL DAF$INIT(PPRPRT);

  13622  3 002772   000153 630400 4                  EPPR0   107
         3 002773   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002774   000000 701000 xent               TSX1    DAF$INIT
         3 002775   000000 011000                    NOP     0

      753    13623    2           DO I = 0 TO 509 BY 10;

  13623  3 002776   200022 450100                    STZ     I,,AUTO

      754    13624    2             K=0;

  13624  3 002777   200026 450100                    STZ     K,,AUTO

      755    13625    3             DO J = 0 TO 9;

  13625  3 003000   200025 450100                    STZ     J,,AUTO

      756    13626    3               K = K + PTB (I + J);

  13626  3 003001   200022 236100                    LDQ     I,,AUTO
         3 003002   200025 036100                    ADLQ    J,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:116  
         3 003003   000100 101506                    MRL     fill='000'O
         3 003004   200041 000001                    ADSC9   PTB,Q,AUTO               cn=0,n=1
         3 003005   200672 000004                    ADSC9   @D2+1,,AUTO              cn=0,n=4
         3 003006   200672 236100                    LDQ     @D2+1,,AUTO
         3 003007   200026 036100                    ADLQ    K,,AUTO
         3 003010   200026 756100                    STQ     K,,AUTO

      757    13627    3             END;

  13627  3 003011   200025 235100                    LDA     J,,AUTO
         3 003012   000001 035007                    ADLA    1,DL
         3 003013   200025 755100                    STA     J,,AUTO
         3 003014   000012 115007                    CMPA    10,DL
         3 003015   003001 602000 3                  TNC     s:13626

      758    13628    2             IF K > 0

  13628  3 003016   000000 116003                    CMPQ    0,DU
         3 003017   003216 600000 3                  TZE     s:13641

      759    13629    2               THEN
      760    13630    2               CALL DAF$WRITE(VECTOR (PUFMT) , VECTOR (I),
      761    13631    2                 VECTOR (PTB(I+0)),
      762    13632    2                 VECTOR (PTB(I+1)),
      763    13633    2                 VECTOR (PTB(I+2)),
      764    13634    2                 VECTOR (PTB(I+3)),
      765    13635    2                 VECTOR (PTB(I+4)),
      766    13636    2                 VECTOR (PTB(I+5)),
      767    13637    2                 VECTOR (PTB(I+6)),
      768    13638    2                 VECTOR (PTB(I+7)),
      769    13639    2                 VECTOR (PTB(I+8)),
      770    13640    2                 VECTOR (PTB(I+9)));

  13640  3 003020   777640 235007                    LDA     -96,DL
         3 003021   200672 452500                    STP2    @D2+1,,AUTO
         3 003022   200672 236100                    LDQ     @D2+1,,AUTO
         3 003023   000022 036003                    ADLQ    18,DU
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:117  
         3 003024   200674 757100                    STAQ    @D2+3,,AUTO
         3 003025   177640 235007                    LDA     65440,DL
         3 003026   200676 452500                    STP2    @D2+5,,AUTO
         3 003027   200022 236100                    LDQ     I,,AUTO
         3 003030   000020 736000                    QLS     16
         3 003031   000041 036003                    ADLQ    33,DU
         3 003032   200676 036100                    ADLQ    @D2+5,,AUTO
         3 003033   200700 757100                    STAQ    @D2+7,,AUTO
         3 003034   177640 235007                    LDA     65440,DL
         3 003035   200702 452500                    STP2    @D2+9,,AUTO
         3 003036   200022 236100                    LDQ     I,,AUTO
         3 003037   000020 736000                    QLS     16
         3 003040   000200 036000 4                  ADLQ    128
         3 003041   200702 036100                    ADLQ    @D2+9,,AUTO
         3 003042   200704 757100                    STAQ    @D2+11,,AUTO
         3 003043   177640 235007                    LDA     65440,DL
         3 003044   200706 452500                    STP2    @D2+13,,AUTO
         3 003045   200022 236100                    LDQ     I,,AUTO
         3 003046   000020 736000                    QLS     16
         3 003047   000201 036000 4                  ADLQ    129
         3 003050   200706 036100                    ADLQ    @D2+13,,AUTO
         3 003051   200710 757100                    STAQ    @D2+15,,AUTO
         3 003052   177640 235007                    LDA     65440,DL
         3 003053   200712 452500                    STP2    @D2+17,,AUTO
         3 003054   200022 236100                    LDQ     I,,AUTO
         3 003055   000020 736000                    QLS     16
         3 003056   000202 036000 4                  ADLQ    130
         3 003057   200712 036100                    ADLQ    @D2+17,,AUTO
         3 003060   200714 757100                    STAQ    @D2+19,,AUTO
         3 003061   177640 235007                    LDA     65440,DL
         3 003062   200716 452500                    STP2    @D2+21,,AUTO
         3 003063   200022 236100                    LDQ     I,,AUTO
         3 003064   000020 736000                    QLS     16
         3 003065   000042 036003                    ADLQ    34,DU
         3 003066   200716 036100                    ADLQ    @D2+21,,AUTO
         3 003067   200720 757100                    STAQ    @D2+23,,AUTO
         3 003070   177640 235007                    LDA     65440,DL
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:118  
         3 003071   200722 452500                    STP2    @D2+25,,AUTO
         3 003072   200022 236100                    LDQ     I,,AUTO
         3 003073   000020 736000                    QLS     16
         3 003074   000203 036000 4                  ADLQ    131
         3 003075   200722 036100                    ADLQ    @D2+25,,AUTO
         3 003076   200724 757100                    STAQ    @D2+27,,AUTO
         3 003077   177640 235007                    LDA     65440,DL
         3 003100   200726 452500                    STP2    @D2+29,,AUTO
         3 003101   200022 236100                    LDQ     I,,AUTO
         3 003102   000020 736000                    QLS     16
         3 003103   000204 036000 4                  ADLQ    132
         3 003104   200726 036100                    ADLQ    @D2+29,,AUTO
         3 003105   200730 757100                    STAQ    @D2+31,,AUTO
         3 003106   177640 235007                    LDA     65440,DL
         3 003107   200732 452500                    STP2    @D2+33,,AUTO
         3 003110   200022 236100                    LDQ     I,,AUTO
         3 003111   000020 736000                    QLS     16
         3 003112   000205 036000 4                  ADLQ    133
         3 003113   200732 036100                    ADLQ    @D2+33,,AUTO
         3 003114   200734 757100                    STAQ    @D2+35,,AUTO
         3 003115   177640 235007                    LDA     65440,DL
         3 003116   200736 452500                    STP2    @D2+37,,AUTO
         3 003117   200022 236100                    LDQ     I,,AUTO
         3 003120   000020 736000                    QLS     16
         3 003121   000043 036003                    ADLQ    35,DU
         3 003122   200736 036100                    ADLQ    @D2+37,,AUTO
         3 003123   200740 757100                    STAQ    @D2+39,,AUTO
         3 003124   177640 235007                    LDA     65440,DL
         3 003125   200742 452500                    STP2    @D2+41,,AUTO
         3 003126   200022 236100                    LDQ     I,,AUTO
         3 003127   000020 736000                    QLS     16
         3 003130   000206 036000 4                  ADLQ    134
         3 003131   200742 036100                    ADLQ    @D2+41,,AUTO
         3 003132   200746 757100                    STAQ    @D2+45,,AUTO
         3 003133   200674 237100                    LDAQ    @D2+3,,AUTO
         3 003134   200744 757100                    STAQ    @D2+43,,AUTO
         3 003135   200700 237100                    LDAQ    @D2+7,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:119  
         3 003136   200750 757100                    STAQ    @D2+47,,AUTO
         3 003137   200704 237100                    LDAQ    @D2+11,,AUTO
         3 003140   200752 757100                    STAQ    @D2+49,,AUTO
         3 003141   200710 237100                    LDAQ    @D2+15,,AUTO
         3 003142   200754 757100                    STAQ    @D2+51,,AUTO
         3 003143   200714 237100                    LDAQ    @D2+19,,AUTO
         3 003144   200756 757100                    STAQ    @D2+53,,AUTO
         3 003145   200720 237100                    LDAQ    @D2+23,,AUTO
         3 003146   200760 757100                    STAQ    @D2+55,,AUTO
         3 003147   200724 237100                    LDAQ    @D2+27,,AUTO
         3 003150   200762 757100                    STAQ    @D2+57,,AUTO
         3 003151   200730 237100                    LDAQ    @D2+31,,AUTO
         3 003152   200764 757100                    STAQ    @D2+59,,AUTO
         3 003153   200734 237100                    LDAQ    @D2+35,,AUTO
         3 003154   200766 757100                    STAQ    @D2+61,,AUTO
         3 003155   200740 237100                    LDAQ    @D2+39,,AUTO
         3 003156   200770 757100                    STAQ    @D2+63,,AUTO
         3 003157   200746 237100                    LDAQ    @D2+45,,AUTO
         3 003160   200772 757100                    STAQ    @D2+65,,AUTO
         3 003161   200772 630500                    EPPR0   @D2+65,,AUTO
         3 003162   201007 450500                    STP0    @D2+78,,AUTO
         3 003163   200770 631500                    EPPR1   @D2+63,,AUTO
         3 003164   201006 451500                    STP1    @D2+77,,AUTO
         3 003165   200766 633500                    EPPR3   @D2+61,,AUTO
         3 003166   201005 453500                    STP3    @D2+76,,AUTO
         3 003167   200764 634500                    EPPR4   @D2+59,,AUTO
         3 003170   201004 454500                    STP4    @D2+75,,AUTO
         3 003171   200762 635500                    EPPR5   @D2+57,,AUTO
         3 003172   201003 455500                    STP5    @D2+74,,AUTO
         3 003173   200760 636500                    EPPR6   @D2+55,,AUTO
         3 003174   201002 456500                    STP6    @D2+73,,AUTO
         3 003175   200756 637500                    EPPR7   @D2+53,,AUTO
         3 003176   201001 457500                    STP7    @D2+72,,AUTO
         3 003177   200754 630500                    EPPR0   @D2+51,,AUTO
         3 003200   201000 450500                    STP0    @D2+71,,AUTO
         3 003201   200752 630500                    EPPR0   @D2+49,,AUTO
         3 003202   200777 450500                    STP0    @D2+70,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:120  
         3 003203   200750 630500                    EPPR0   @D2+47,,AUTO
         3 003204   200776 450500                    STP0    @D2+69,,AUTO
         3 003205   200744 630500                    EPPR0   @D2+43,,AUTO
         3 003206   200775 450500                    STP0    @D2+68,,AUTO
         3 003207   000210 236000 4                  LDQ     136
         3 003210   200774 756100                    STQ     @D2+67,,AUTO
         3 003211   200774 630500                    EPPR0   @D2+67,,AUTO
         3 003212   000000 220000 xsym               LDX0    DAF$WRITE
         3 003213   000207 631400 4                  EPPR1   135
         3 003214   000000 701010                    TSX1    0,X0
         3 003215   000000 011000                    NOP     0

      771    13641    2           END;

  13641  3 003216   000012 236007                    LDQ     10,DL
         3 003217   200022 056100                    ASQ     I,,AUTO
         3 003220   200022 235100                    LDA     I,,AUTO
         3 003221   000775 115007                    CMPA    509,DL
         3 003222   002777 604400 3                  TMOZ    s:13624

      772    13642
      773    13643    1   DO_USER:
      774    13644    1           IF ~PPUT_FLAG.USER THEN

  13644  3 003223   000577 236000 1     DO_USER      LDQ     PPUT_FLAG
         3 003224   000002 736000                    QLS     2
         3 003225   400000 376003                    ANQ     -131072,DU
         3 003226   400000 676003                    ERQ     -131072,DU
         3 003227   003462 601000 3                  TNZ     DO_USAGE

      775    13645    1             GOTO DO_USAGE;
      776    13646    1           CALL DAF$INIT(PURPRT);

  13646  3 003230   000211 630400 4                  EPPR0   137
         3 003231   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003232   000000 701000 xent               TSX1    DAF$INIT
         3 003233   000000 011000                    NOP     0
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:121  

      777    13647    2           DO I = 0 TO 509 BY 10;

  13647  3 003234   200022 450100                    STZ     I,,AUTO

      778    13648    2             K=0;

  13648  3 003235   200026 450100                    STZ     K,,AUTO

      779    13649    3             DO J = 0 TO 9;

  13649  3 003236   200025 450100                    STZ     J,,AUTO

      780    13650    3               K = K + UTB (I + J);

  13650  3 003237   200022 236100                    LDQ     I,,AUTO
         3 003240   200025 036100                    ADLQ    J,,AUTO
         3 003241   000001 736000                    QLS     1
         3 003242   000100 101506                    MRL     fill='000'O
         3 003243   200246 000002                    ADSC9   UTB,Q,AUTO               cn=0,n=2
         3 003244   200672 000004                    ADSC9   @D2+1,,AUTO              cn=0,n=4
         3 003245   200672 236100                    LDQ     @D2+1,,AUTO
         3 003246   200026 036100                    ADLQ    K,,AUTO
         3 003247   200026 756100                    STQ     K,,AUTO

      781    13651    3             END;

  13651  3 003250   200025 235100                    LDA     J,,AUTO
         3 003251   000001 035007                    ADLA    1,DL
         3 003252   200025 755100                    STA     J,,AUTO
         3 003253   000012 115007                    CMPA    10,DL
         3 003254   003237 602000 3                  TNC     s:13650

      782    13652    2             IF K > 0

  13652  3 003255   000000 116003                    CMPQ    0,DU
         3 003256   003455 600000 3                  TZE     s:13665
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:122  

      783    13653    2               THEN
      784    13654    2               CALL DAF$WRITE(VECTOR (PUFMT) , VECTOR (I),
      785    13655    2                 VECTOR (UTB(I+0)),
      786    13656    2                 VECTOR (UTB(I+1)),
      787    13657    2                 VECTOR (UTB(I+2)),
      788    13658    2                 VECTOR (UTB(I+3)),
      789    13659    2                 VECTOR (UTB(I+4)),
      790    13660    2                 VECTOR (UTB(I+5)),
      791    13661    2                 VECTOR (UTB(I+6)),
      792    13662    2                 VECTOR (UTB(I+7)),
      793    13663    2                 VECTOR (UTB(I+8)),
      794    13664    2                 VECTOR (UTB(I+9)));

  13664  3 003257   777640 235007                    LDA     -96,DL
         3 003260   200672 452500                    STP2    @D2+1,,AUTO
         3 003261   200672 236100                    LDQ     @D2+1,,AUTO
         3 003262   000022 036003                    ADLQ    18,DU
         3 003263   200674 757100                    STAQ    @D2+3,,AUTO
         3 003264   377640 235007                    LDA     130976,DL
         3 003265   200676 452500                    STP2    @D2+5,,AUTO
         3 003266   200022 236100                    LDQ     I,,AUTO
         3 003267   000021 736000                    QLS     17
         3 003270   000246 036003                    ADLQ    166,DU
         3 003271   200676 036100                    ADLQ    @D2+5,,AUTO
         3 003272   200700 757100                    STAQ    @D2+7,,AUTO
         3 003273   377640 235007                    LDA     130976,DL
         3 003274   200702 452500                    STP2    @D2+9,,AUTO
         3 003275   200022 236100                    LDQ     I,,AUTO
         3 003276   000021 736000                    QLS     17
         3 003277   000212 036000 4                  ADLQ    138
         3 003300   200702 036100                    ADLQ    @D2+9,,AUTO
         3 003301   200704 757100                    STAQ    @D2+11,,AUTO
         3 003302   377640 235007                    LDA     130976,DL
         3 003303   200706 452500                    STP2    @D2+13,,AUTO
         3 003304   200022 236100                    LDQ     I,,AUTO
         3 003305   000021 736000                    QLS     17
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:123  
         3 003306   000247 036003                    ADLQ    167,DU
         3 003307   200706 036100                    ADLQ    @D2+13,,AUTO
         3 003310   200710 757100                    STAQ    @D2+15,,AUTO
         3 003311   377640 235007                    LDA     130976,DL
         3 003312   200712 452500                    STP2    @D2+17,,AUTO
         3 003313   200022 236100                    LDQ     I,,AUTO
         3 003314   000021 736000                    QLS     17
         3 003315   000213 036000 4                  ADLQ    139
         3 003316   200712 036100                    ADLQ    @D2+17,,AUTO
         3 003317   200714 757100                    STAQ    @D2+19,,AUTO
         3 003320   377640 235007                    LDA     130976,DL
         3 003321   200716 452500                    STP2    @D2+21,,AUTO
         3 003322   200022 236100                    LDQ     I,,AUTO
         3 003323   000021 736000                    QLS     17
         3 003324   000250 036003                    ADLQ    168,DU
         3 003325   200716 036100                    ADLQ    @D2+21,,AUTO
         3 003326   200720 757100                    STAQ    @D2+23,,AUTO
         3 003327   377640 235007                    LDA     130976,DL
         3 003330   200722 452500                    STP2    @D2+25,,AUTO
         3 003331   200022 236100                    LDQ     I,,AUTO
         3 003332   000021 736000                    QLS     17
         3 003333   000214 036000 4                  ADLQ    140
         3 003334   200722 036100                    ADLQ    @D2+25,,AUTO
         3 003335   200724 757100                    STAQ    @D2+27,,AUTO
         3 003336   377640 235007                    LDA     130976,DL
         3 003337   200726 452500                    STP2    @D2+29,,AUTO
         3 003340   200022 236100                    LDQ     I,,AUTO
         3 003341   000021 736000                    QLS     17
         3 003342   000251 036003                    ADLQ    169,DU
         3 003343   200726 036100                    ADLQ    @D2+29,,AUTO
         3 003344   200730 757100                    STAQ    @D2+31,,AUTO
         3 003345   377640 235007                    LDA     130976,DL
         3 003346   200732 452500                    STP2    @D2+33,,AUTO
         3 003347   200022 236100                    LDQ     I,,AUTO
         3 003350   000021 736000                    QLS     17
         3 003351   000215 036000 4                  ADLQ    141
         3 003352   200732 036100                    ADLQ    @D2+33,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:124  
         3 003353   200734 757100                    STAQ    @D2+35,,AUTO
         3 003354   377640 235007                    LDA     130976,DL
         3 003355   200736 452500                    STP2    @D2+37,,AUTO
         3 003356   200022 236100                    LDQ     I,,AUTO
         3 003357   000021 736000                    QLS     17
         3 003360   000252 036003                    ADLQ    170,DU
         3 003361   200736 036100                    ADLQ    @D2+37,,AUTO
         3 003362   200740 757100                    STAQ    @D2+39,,AUTO
         3 003363   377640 235007                    LDA     130976,DL
         3 003364   200742 452500                    STP2    @D2+41,,AUTO
         3 003365   200022 236100                    LDQ     I,,AUTO
         3 003366   000021 736000                    QLS     17
         3 003367   000216 036000 4                  ADLQ    142
         3 003370   200742 036100                    ADLQ    @D2+41,,AUTO
         3 003371   200746 757100                    STAQ    @D2+45,,AUTO
         3 003372   200674 237100                    LDAQ    @D2+3,,AUTO
         3 003373   200744 757100                    STAQ    @D2+43,,AUTO
         3 003374   200700 237100                    LDAQ    @D2+7,,AUTO
         3 003375   200750 757100                    STAQ    @D2+47,,AUTO
         3 003376   200704 237100                    LDAQ    @D2+11,,AUTO
         3 003377   200752 757100                    STAQ    @D2+49,,AUTO
         3 003400   200710 237100                    LDAQ    @D2+15,,AUTO
         3 003401   200754 757100                    STAQ    @D2+51,,AUTO
         3 003402   200714 237100                    LDAQ    @D2+19,,AUTO
         3 003403   200756 757100                    STAQ    @D2+53,,AUTO
         3 003404   200720 237100                    LDAQ    @D2+23,,AUTO
         3 003405   200760 757100                    STAQ    @D2+55,,AUTO
         3 003406   200724 237100                    LDAQ    @D2+27,,AUTO
         3 003407   200762 757100                    STAQ    @D2+57,,AUTO
         3 003410   200730 237100                    LDAQ    @D2+31,,AUTO
         3 003411   200764 757100                    STAQ    @D2+59,,AUTO
         3 003412   200734 237100                    LDAQ    @D2+35,,AUTO
         3 003413   200766 757100                    STAQ    @D2+61,,AUTO
         3 003414   200740 237100                    LDAQ    @D2+39,,AUTO
         3 003415   200770 757100                    STAQ    @D2+63,,AUTO
         3 003416   200746 237100                    LDAQ    @D2+45,,AUTO
         3 003417   200772 757100                    STAQ    @D2+65,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:125  
         3 003420   200772 630500                    EPPR0   @D2+65,,AUTO
         3 003421   201007 450500                    STP0    @D2+78,,AUTO
         3 003422   200770 631500                    EPPR1   @D2+63,,AUTO
         3 003423   201006 451500                    STP1    @D2+77,,AUTO
         3 003424   200766 633500                    EPPR3   @D2+61,,AUTO
         3 003425   201005 453500                    STP3    @D2+76,,AUTO
         3 003426   200764 634500                    EPPR4   @D2+59,,AUTO
         3 003427   201004 454500                    STP4    @D2+75,,AUTO
         3 003430   200762 635500                    EPPR5   @D2+57,,AUTO
         3 003431   201003 455500                    STP5    @D2+74,,AUTO
         3 003432   200760 636500                    EPPR6   @D2+55,,AUTO
         3 003433   201002 456500                    STP6    @D2+73,,AUTO
         3 003434   200756 637500                    EPPR7   @D2+53,,AUTO
         3 003435   201001 457500                    STP7    @D2+72,,AUTO
         3 003436   200754 630500                    EPPR0   @D2+51,,AUTO
         3 003437   201000 450500                    STP0    @D2+71,,AUTO
         3 003440   200752 630500                    EPPR0   @D2+49,,AUTO
         3 003441   200777 450500                    STP0    @D2+70,,AUTO
         3 003442   200750 630500                    EPPR0   @D2+47,,AUTO
         3 003443   200776 450500                    STP0    @D2+69,,AUTO
         3 003444   200744 630500                    EPPR0   @D2+43,,AUTO
         3 003445   200775 450500                    STP0    @D2+68,,AUTO
         3 003446   000210 236000 4                  LDQ     136
         3 003447   200774 756100                    STQ     @D2+67,,AUTO
         3 003450   200774 630500                    EPPR0   @D2+67,,AUTO
         3 003451   000000 220000 xsym               LDX0    DAF$WRITE
         3 003452   000207 631400 4                  EPPR1   135
         3 003453   000000 701010                    TSX1    0,X0
         3 003454   000000 011000                    NOP     0

      795    13665    2           END;

  13665  3 003455   000012 236007                    LDQ     10,DL
         3 003456   200022 056100                    ASQ     I,,AUTO
         3 003457   200022 235100                    LDA     I,,AUTO
         3 003460   000775 115007                    CMPA    509,DL
         3 003461   003235 604400 3                  TMOZ    s:13648
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:126  

      796    13666        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:127  
      797    13667        /*
      798    13668        **
      799    13669        **      Format PPUT itself.
      800    13670        */
      801    13671    1   DO_USAGE:
      802    13672    1           IF ~PPUT_FLAG.USAGE THEN

  13672  3 003462   000577 236000 1     DO_USAGE     LDQ     PPUT_FLAG
         3 003463   000003 736000                    QLS     3
         3 003464   400000 376003                    ANQ     -131072,DU
         3 003465   400000 676003                    ERQ     -131072,DU
         3 003466   003470 600000 3                  TZE     s:13674

      803    13673    1             RETURN;

  13673  3 003467   000000 702200 xent               TSX2  ! X66_ARET

      804    13674    1           CALL DAF$INIT(PUSRPRT);

  13674  3 003470   000217 630400 4                  EPPR0   143
         3 003471   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 003472   000000 701000 xent               TSX1    DAF$INIT
         3 003473   000000 011000                    NOP     0

      805    13675    2           DO J = 0 TO PCORE BY 8;

  13675  3 003474   200025 450100                    STZ     J,,AUTO
         3 003475   003640 710000 3                  TRA     s:13685+3

      806    13676    2             CALL DAF$WRITE(VECTOR(PPUTFMT),VECTOR(J),
      807    13677    2               VECTOR(USE_TABLE(J)),
      808    13678    2               VECTOR(USE_TABLE(J+1)),
      809    13679    2               VECTOR(USE_TABLE(J+2)),
      810    13680    2               VECTOR(USE_TABLE(J+3)),
      811    13681    2               VECTOR(USE_TABLE(J+4)),

  13681  3 003476   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:128  
         3 003477   200672 452500                    STP2    @D2+1,,AUTO
         3 003500   200672 236100                    LDQ     @D2+1,,AUTO
         3 003501   000025 036003                    ADLQ    21,DU
         3 003502   200674 757100                    STAQ    @D2+3,,AUTO
         3 003503   777640 235007                    LDA     -96,DL
         3 003504   200025 236100                    LDQ     J,,AUTO
         3 003505   000022 736000                    QLS     18
         3 003506   200244 036100                    ADLQ    USE$,,AUTO
         3 003507   200676 757100                    STAQ    @D2+5,,AUTO
         3 003510   777640 235007                    LDA     -96,DL
         3 003511   200025 236100                    LDQ     J,,AUTO
         3 003512   000022 736000                    QLS     18
         3 003513   000001 036003                    ADLQ    1,DU
         3 003514   200244 036100                    ADLQ    USE$,,AUTO
         3 003515   200700 757100                    STAQ    @D2+7,,AUTO
         3 003516   777640 235007                    LDA     -96,DL
         3 003517   200025 236100                    LDQ     J,,AUTO
         3 003520   000022 736000                    QLS     18
         3 003521   000002 036003                    ADLQ    2,DU
         3 003522   200244 036100                    ADLQ    USE$,,AUTO
         3 003523   200702 757100                    STAQ    @D2+9,,AUTO
         3 003524   777640 235007                    LDA     -96,DL
         3 003525   200025 236100                    LDQ     J,,AUTO
         3 003526   000022 736000                    QLS     18
         3 003527   000003 036003                    ADLQ    3,DU
         3 003530   200244 036100                    ADLQ    USE$,,AUTO
         3 003531   200704 757100                    STAQ    @D2+11,,AUTO
         3 003532   777640 235007                    LDA     -96,DL
         3 003533   200025 236100                    LDQ     J,,AUTO
         3 003534   000022 736000                    QLS     18
         3 003535   000004 036003                    ADLQ    4,DU
         3 003536   200244 036100                    ADLQ    USE$,,AUTO
         3 003537   200706 757100                    STAQ    @D2+13,,AUTO
         3 003540   777640 235007                    LDA     -96,DL
         3 003541   200025 236100                    LDQ     J,,AUTO
         3 003542   000022 736000                    QLS     18
         3 003543   000005 036003                    ADLQ    5,DU
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:129  
         3 003544   200244 036100                    ADLQ    USE$,,AUTO
         3 003545   200710 757100                    STAQ    @D2+15,,AUTO
         3 003546   777640 235007                    LDA     -96,DL
         3 003547   200025 236100                    LDQ     J,,AUTO
         3 003550   000022 736000                    QLS     18
         3 003551   000006 036003                    ADLQ    6,DU
         3 003552   200244 036100                    ADLQ    USE$,,AUTO
         3 003553   200712 757100                    STAQ    @D2+17,,AUTO
         3 003554   777640 235007                    LDA     -96,DL
         3 003555   200025 236100                    LDQ     J,,AUTO
         3 003556   000022 736000                    QLS     18
         3 003557   000007 036003                    ADLQ    7,DU
         3 003560   200244 036100                    ADLQ    USE$,,AUTO
         3 003561   200716 757100                    STAQ    @D2+21,,AUTO
         3 003562   200674 237100                    LDAQ    @D2+3,,AUTO
         3 003563   200714 757100                    STAQ    @D2+19,,AUTO
         3 003564   200676 237100                    LDAQ    @D2+5,,AUTO
         3 003565   200720 757100                    STAQ    @D2+23,,AUTO
         3 003566   200700 237100                    LDAQ    @D2+7,,AUTO
         3 003567   200722 757100                    STAQ    @D2+25,,AUTO
         3 003570   200702 237100                    LDAQ    @D2+9,,AUTO
         3 003571   200724 757100                    STAQ    @D2+27,,AUTO
         3 003572   200704 237100                    LDAQ    @D2+11,,AUTO
         3 003573   200726 757100                    STAQ    @D2+29,,AUTO
         3 003574   200706 237100                    LDAQ    @D2+13,,AUTO
         3 003575   200730 757100                    STAQ    @D2+31,,AUTO
         3 003576   200710 237100                    LDAQ    @D2+15,,AUTO
         3 003577   200732 757100                    STAQ    @D2+33,,AUTO
         3 003600   200712 237100                    LDAQ    @D2+17,,AUTO
         3 003601   200734 757100                    STAQ    @D2+35,,AUTO
         3 003602   200716 237100                    LDAQ    @D2+21,,AUTO
         3 003603   200736 757100                    STAQ    @D2+37,,AUTO
         3 003604   200736 630500                    EPPR0   @D2+37,,AUTO
         3 003605   200751 450500                    STP0    @D2+48,,AUTO
         3 003606   200734 631500                    EPPR1   @D2+35,,AUTO
         3 003607   200750 451500                    STP1    @D2+47,,AUTO
         3 003610   200732 633500                    EPPR3   @D2+33,,AUTO
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:130  
         3 003611   200747 453500                    STP3    @D2+46,,AUTO
         3 003612   200730 634500                    EPPR4   @D2+31,,AUTO
         3 003613   200746 454500                    STP4    @D2+45,,AUTO
         3 003614   200726 635500                    EPPR5   @D2+29,,AUTO
         3 003615   200745 455500                    STP5    @D2+44,,AUTO
         3 003616   200724 636500                    EPPR6   @D2+27,,AUTO
         3 003617   200744 456500                    STP6    @D2+43,,AUTO
         3 003620   200722 637500                    EPPR7   @D2+25,,AUTO
         3 003621   200743 457500                    STP7    @D2+42,,AUTO
         3 003622   200720 630500                    EPPR0   @D2+23,,AUTO
         3 003623   200742 450500                    STP0    @D2+41,,AUTO
         3 003624   200714 630500                    EPPR0   @D2+19,,AUTO
         3 003625   200741 450500                    STP0    @D2+40,,AUTO
         3 003626   000223 236000 4                  LDQ     147
         3 003627   200740 756100                    STQ     @D2+39,,AUTO
         3 003630   200740 630500                    EPPR0   @D2+39,,AUTO
         3 003631   000000 220000 xsym               LDX0    DAF$WRITE
         3 003632   000222 631400 4                  EPPR1   146
         3 003633   000000 701010                    TSX1    0,X0
         3 003634   000000 011000                    NOP     0

      812    13682    2               VECTOR(USE_TABLE(J+5)),
      813    13683    2               VECTOR(USE_TABLE(J+6)),
      814    13684    2               VECTOR(USE_TABLE(J+7)));
      815    13685    2           END;

  13685  3 003635   200025 235100                    LDA     J,,AUTO
         3 003636   000010 035007                    ADLA    8,DL
         3 003637   200025 755100                    STA     J,,AUTO
         3 003640   200031 236100                    LDQ     PCORE,,AUTO
         3 003641   200025 116100                    CMPQ    J,,AUTO
         3 003642   003476 603000 3                  TRC     s:13681

      816    13686        /*
      817    13687        **
      818    13688        **      Done.
      819    13689        */
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:131  
      820    13690    1           CALL DAD$FRREL;

  13690  3 003643   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 003644   000000 701000 xent               TSX1    DAD$FRREL
         3 003645   000000 011000                    NOP     0

      821    13691    1           RETURN;

  13691  3 003646   000000 702200 xent               TSX2  ! X66_ARET

      822    13692
      823    13693    1   ALT:    CALL M$ERR;

  13693  3 003647   000002 713400       ALT          CLIMB   err
         3 003650   000000 401760                    pmme    nvectors=0
         3 003651   004040 710000 3                  TRA     s:13718

      824    13694        %EJECT;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:132  
      825    13695    1   SETUP:  PROC ALTRET;

  13695  3 003652   200662 741300       SETUP        STX1  ! WSQ#+1,,AUTO

      826    13696    2           CALL DAA$VALUE(TOP.SUBLK$(0)->OUT$BLK,VSG#);

  13696  3 003653   200003 470500                    LDP0    @TOP,,AUTO
         3 003654   000003 471500                    LDP1    3,,PR0
         3 003655   200653 633500                    EPPR3   VSG#,,AUTO
         3 003656   200673 453500                    STP3    @D2+2,,AUTO
         3 003657   200672 451500                    STP1    @D2+1,,AUTO
         3 003660   200672 630500                    EPPR0   @D2+1,,AUTO
         3 003661   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 003662   000000 701000 xent               TSX1    DAA$VALUE
         3 003663   000000 011000                    NOP     0

      827    13697    2           CALL DAA$VALUE(TOP.SUBLK$(1)->OUT$BLK,USER,TEMP);

  13697  3 003664   200003 470500                    LDP0    @TOP,,AUTO
         3 003665   000004 471500                    LDP1    4,,PR0
         3 003666   200243 633500                    EPPR3   TEMP,,AUTO
         3 003667   200674 453500                    STP3    @D2+3,,AUTO
         3 003670   200245 634500                    EPPR4   USER,,AUTO
         3 003671   200673 454500                    STP4    @D2+2,,AUTO
         3 003672   200672 451500                    STP1    @D2+1,,AUTO
         3 003673   200672 630500                    EPPR0   @D2+1,,AUTO
         3 003674   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 003675   000000 701000 xent               TSX1    DAA$VALUE
         3 003676   000000 011000                    NOP     0

      828    13698    2           IF TEMP ~= 8 THEN

  13698  3 003677   200243 235100                    LDA     TEMP,,AUTO
         3 003700   000010 115007                    CMPA    8,DL
         3 003701   003705 600000 3                  TZE     s:13701

      829    13699    2             DA_CUN = -USER;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:133  

  13699  3 003702   200245 336100                    LCQ     USER,,AUTO
         3 003703   000000 756000 xsym               STQ     DA_CUN
         3 003704   003707 710000 3                  TRA     s:13702

      830    13700    2             ELSE
      831    13701    2             DA_CUN = USER;

  13701  3 003705   200245 236100                    LDQ     USER,,AUTO
         3 003706   000000 756000 xsym               STQ     DA_CUN

      832    13702    3           CALL DAM$MAP(B$ROS$,ROS$,-DA_CUN,%USERWSR) WHENALTRETURN DO;

  13702  3 003707   000000 335000 xsym               LCA     DA_CUN
         3 003710   200672 755100                    STA     @D2+1,,AUTO
         3 003711   000224 236000 4                  LDQ     148
         3 003712   200677 756100                    STQ     @D2+6,,AUTO
         3 003713   200672 630500                    EPPR0   @D2+1,,AUTO
         3 003714   200676 450500                    STP0    @D2+5,,AUTO
         3 003715   000226 237000 4                  LDAQ    150
         3 003716   200674 757100                    STAQ    @D2+3,,AUTO
         3 003717   200674 630500                    EPPR0   @D2+3,,AUTO
         3 003720   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 003721   000000 701000 xent               TSX1    DAM$MAP
         3 003722   003724 702000 3                  TSX2    s:13703
         3 003723   003726 710000 3                  TRA     s:13705

      833    13703    3                 ALTRETURN;

  13703  3 003724   200662 221300                    LDX1  ! WSQ#+1,,AUTO
         3 003725   000000 702211                    TSX2  ! 0,X1

      834    13704    3               END;
      835    13705    3           CALL DAM$MAP(ROS$->B$ROSEG.DCBPTR$,DCBPTR$,-DA_CUN,%USERWSR) WHENALTRETURN
             13705                    DO;

  13705  3 003726   000000 335000 xsym               LCA     DA_CUN
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:134  
         3 003727   200672 755100                    STA     @D2+1,,AUTO
         3 003730   000224 236000 4                  LDQ     148
         3 003731   200677 756100                    STQ     @D2+6,,AUTO
         3 003732   200672 630500                    EPPR0   @D2+1,,AUTO
         3 003733   200676 450500                    STP0    @D2+5,,AUTO
         3 003734   200021 631500                    EPPR1   DCBPTR$,,AUTO
         3 003735   200675 451500                    STP1    @D2+4,,AUTO
         3 003736   000001 236000 1                  LDQ     ROS$
         3 003737   200674 756100                    STQ     @D2+3,,AUTO
         3 003740   200674 630500                    EPPR0   @D2+3,,AUTO
         3 003741   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 003742   000000 701000 xent               TSX1    DAM$MAP
         3 003743   003745 702000 3                  TSX2    s:13706
         3 003744   003747 710000 3                  TRA     s:13708

      836    13706    3                 ALTRETURN;

  13706  3 003745   200662 221300                    LDX1  ! WSQ#+1,,AUTO
         3 003746   000000 702211                    TSX2  ! 0,X1

      837    13707    3               END;
      838    13708    3           CALL DAM$MAP(B$JIT$,JIT$,-DA_CUN,%USERWSR) WHENALTRETURN DO;

  13708  3 003747   000000 335000 xsym               LCA     DA_CUN
         3 003750   200672 755100                    STA     @D2+1,,AUTO
         3 003751   000224 236000 4                  LDQ     148
         3 003752   200677 756100                    STQ     @D2+6,,AUTO
         3 003753   200672 630500                    EPPR0   @D2+1,,AUTO
         3 003754   200676 450500                    STP0    @D2+5,,AUTO
         3 003755   000230 237000 4                  LDAQ    152
         3 003756   200674 757100                    STAQ    @D2+3,,AUTO
         3 003757   200674 630500                    EPPR0   @D2+3,,AUTO
         3 003760   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 003761   000000 701000 xent               TSX1    DAM$MAP
         3 003762   003764 702000 3                  TSX2    s:13710
         3 003763   003764 710000 3                  TRA     s:13710

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:135  
      839    13709    3               END;

      840    13710    2           VSG_DCB# = JIT$->B$JIT.VIRTUAL.DCB#(VSG#-1);

  13710  3 003764   000000 470400 1                  LDP0    JIT$
         3 003765   200653 235100                    LDA     VSG#,,AUTO
         3 003766   000100 101505                    MRL     fill='000'O
         3 003767   000216 600001                    ADSC9   142,A,PR0                cn=3,n=1
         3 003770   200654 000004                    ADSC9   VSG_DCB#,,AUTO           cn=0,n=4

      841    13711    3          CALL DAM$MAP(DCBPTR$->DCBTAB$(VSG_DCB#),DCB$,-DA_CUN,%USERWSR) WHENALTRETURN
             13711                    DO;

  13711  3 003771   000000 336000 xsym               LCQ     DA_CUN
         3 003772   200672 756100                    STQ     @D2+1,,AUTO
         3 003773   000224 236000 4                  LDQ     148
         3 003774   200677 756100                    STQ     @D2+6,,AUTO
         3 003775   200672 631500                    EPPR1   @D2+1,,AUTO
         3 003776   200676 451500                    STP1    @D2+5,,AUTO
         3 003777   200020 633500                    EPPR3   DCB$,,AUTO
         3 004000   200675 453500                    STP3    @D2+4,,AUTO
         3 004001   200654 236100                    LDQ     VSG_DCB#,,AUTO
         3 004002   000022 736000                    QLS     18
         3 004003   200021 036100                    ADLQ    DCBPTR$,,AUTO
         3 004004   200674 756100                    STQ     @D2+3,,AUTO
         3 004005   200674 630500                    EPPR0   @D2+3,,AUTO
         3 004006   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 004007   000000 701000 xent               TSX1    DAM$MAP
         3 004010   004012 702000 3                  TSX2    s:13712
         3 004011   004014 710000 3                  TRA     s:13714

      842    13712    3                 ALTRETURN;

  13712  3 004012   200662 221300                    LDX1  ! WSQ#+1,,AUTO
         3 004013   000000 702211                    TSX2  ! 0,X1

      843    13713    3               END;
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:136  
      844    13714    3           CALL DAM$MAP(DCB$->F$DCB.SETSTA$,VCB$,-DA_CUN,%USERWSR) WHENALTRETURN DO;

  13714  3 004014   000000 335000 xsym               LCA     DA_CUN
         3 004015   200672 755100                    STA     @D2+1,,AUTO
         3 004016   000224 236000 4                  LDQ     148
         3 004017   200677 756100                    STQ     @D2+6,,AUTO
         3 004020   200672 630500                    EPPR0   @D2+1,,AUTO
         3 004021   200676 450500                    STP0    @D2+5,,AUTO
         3 004022   200660 631500                    EPPR1   VCB$,,AUTO
         3 004023   200675 451500                    STP1    @D2+4,,AUTO
         3 004024   200020 236100                    LDQ     DCB$,,AUTO
         3 004025   000006 036003                    ADLQ    6,DU
         3 004026   200674 756100                    STQ     @D2+3,,AUTO
         3 004027   200674 630500                    EPPR0   @D2+3,,AUTO
         3 004030   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 004031   000000 701000 xent               TSX1    DAM$MAP
         3 004032   004034 702000 3                  TSX2    s:13715
         3 004033   004036 710000 3                  TRA     s:13717

      845    13715    3                 ALTRETURN;

  13715  3 004034   200662 221300                    LDX1  ! WSQ#+1,,AUTO
         3 004035   000000 702211                    TSX2  ! 0,X1

      846    13716    3               END;
      847    13717    2   END SETUP;

  13717  3 004036   200662 221300                    LDX1  ! WSQ#+1,,AUTO
         3 004037   000001 702211                    TSX2  ! 1,X1

      848    13718    1   END DAD$VSCHECK;

  13718  3 004040   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:137  
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   MM$SYSGEN.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   DA_PERR_C.:E05TOU  is referenced.
   DA_SYMBOLS_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_TEXTC_C.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$MAP.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DAD$VSCHECK.
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:138  

 **** Variables and constants ****

  ****  Section 001  Data  DAD$VSCHECK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   575-0-0/w UBIN        r     1 COMM#                    570-0-0/w UBIN        r     1 DIAG#
   602-0-0/w UBIN        r     1 FIRM#                    565-0-0/w UBIN        r     1 FREE#
   566-0-0/w UBIN        r     1 FREE_CH#                 567-0-0/w UBIN        r     1 IO#
     0-0-0/w PTR         r     1 JIT$                     606-0-0/w UBIN        r     1 LOST#
   605-0-0/w UBIN        r     1 LOW#                     603-0-0/w UBIN        r     1 MON#
   604-0-0/w UBIN        r     1 MONCXT#                  600-0-0/w UBIN        r     1 MONDS#
   610-0-0/w PTR         r     1 MPT$                     616-0-0/w STRC(72)    r     1 NAME_FPPH
   613-0-0/w STRC(81)    r     1 NAME_PCORE               607-0-0/w PTR         r     1 OUT$
   572-0-0/w UBIN        r     1 P#                       231-0-0/w STRC(288)   r     1 PMRPRT
   251-0-0/w STRC(144)   r     1 PMRPRTHD00               241-0-0/c STRC(279)   r     1 PMRPRTTX00
   255-0-0/c STRC(18)    r     1 PMRPRTTX01               300-0-0/w STRC(288)   r     1 PPRPRT
   311-0-0/w STRC(144)   r     1 PPRPRTHD00               320-0-0/w STRC(144)   r     1 PPRPRTHD01
   347-0-0/w STRC(144)   r     1 PPRPRTHD02               310-0-0/c STRC(18)    r     1 PPRPRTTX00
   315-0-0/c STRC(99)    r     1 PPRPRTTX01               324-0-0/c STRC(684)   r     1 PPRPRTTX02
   353-0-0/c STRC(684)   r     1 PPRPRTTX03               576-0-0/w UBIN        r     1 PPUT#
   611-0-0/w PTR         r     1 PPUT$                    577-0-0/b STRC(9)     r     1 PPUT_FLAG
   256-0-0/w STRC(288)   r     1 PSRPRT                   267-0-0/w STRC(144)   r     1 PSRPRTHD00
   266-0-0/c STRC(27)    r     1 PSRPRTTX00               273-0-0/c STRC(180)   r     1 PSRPRTTX01
   376-0-0/w STRC(288)   r     1 PURPRT                   407-0-0/w STRC(144)   r     1 PURPRTHD00
   415-0-0/w STRC(144)   r     1 PURPRTHD01               444-0-0/w STRC(144)   r     1 PURPRTHD02
   406-0-0/c STRC(18)    r     1 PURPRTTX00               413-0-0/c STRC(54)    r     1 PURPRTTX01
   421-0-0/c STRC(684)   r     1 PURPRTTX02               450-0-0/c STRC(684)   r     1 PURPRTTX03
   473-0-0/w STRC(288)   r     1 PUSRPRT                  504-0-0/w STRC(144)   r     1 PUSRPRTHD00
   515-0-0/w STRC(144)   r     1 PUSRPRTHD01              541-0-0/w STRC(144)   r     1 PUSRPRTHD02
   503-0-0/c STRC(18)    r     1 PUSRPRTTX00              510-0-0/c STRC(180)   r     1 PUSRPRTTX01
   521-0-0/c STRC(567)   r     1 PUSRPRTTX02              545-0-0/c STRC(567)   r     1 PUSRPRTTX03
     1-0-0/w PTR         r     1 ROS$                     573-0-0/w UBIN        r     1 SDS#
   612-0-0/w PTR         r     1 SEGTBL$                  574-0-0/w UBIN        r     1 STOLE#
   601-0-0/w UBIN        r     1 TIGR#                    571-0-0/w UBIN        r     1 U#
    20-0-0/w STRC(144)   r     1 VSHDR                    142-0-0/w STRC(288)   r     1 VSPCRPT
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:139  
   161-0-0/w STRC(144)   r     1 VSPCRPTHD00              205-0-0/w STRC(144)   r     1 VSPCRPTHD01
   152-0-0/c STRC(243)   r     1 VSPCRPTTX00              165-0-0/c STRC(549)   r     1 VSPCRPTTX01
   211-0-0/c STRC(558)   r     1 VSPCRPTTX02                2-0-0/w STRC(288)   r     1 VSRPRT
    50-0-0/w STRC(144)   r     1 VSRPRTHD01               121-0-0/w STRC(144)   r     1 VSRPRTHD03
    12-0-0/c STRC(216)   r     1 VSRPRTTX00                24-0-0/c STRC(693)   r     1 VSRPRTTX01
    54-0-0/c STRC(693)   r     1 VSRPRTTX02               104-0-0/c STRC(450)   r     1 VSRPRTTX03
   125-0-0/c STRC(450)   r     1 VSRPRTTX04               100-0-0/w STRC(144)   r     1 VSRPT1

  ****  Section 002 RoData DAD$VSCHECK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(61)    r     1 COUNT_ERR
   102-0-0/c CHAR(4)     r     1 CPUNAME(0:5)
    74-0-0/b STRC        r     1 CPUPT(0:5)                74-0-0/w PTR         r     1 CPUPT$(0:5)
    35-0-0/w SBIN        r     1 END_VP                   270-0-0/c CHAR(34)    r     1 FNFFMT
   260-0-0/c CHAR(32)    r     1 NO_OVRLYS                233-0-0/c CHAR(44)    r     1 PERRFMT
   246-0-0/c CHAR(39)    r     1 PGOODFMT                 226-0-0/c CHAR(18)    r     1 PPUTFMT
   223-0-0/c CHAR(12)    r     1 PUFMT                    110-0-0/c STRC(2673)  r     1 SUMFMT
    20-0-0/c CHAR(52)    r     1 TAIL_ERR                  36-0-0/c CHAR(59)    r     1 VSSFMT1
    55-0-0/c CHAR(28)    r     1 VSSFMT2                   64-0-0/c CHAR(31)    r     1 VSSFMT3

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   665-0-0/w PTR         r     1 @C                       670-0-0/w PTR         r     1 @D1
   671-0-0/w PTR         r     1 @D2                      667-0-0/w PTR         r     1 @P
     3-0-0/w PTR         r     1 @TOP                     666-0-0/w PTR         r     1 @V
    *0-0-0/w SBIN        r     1 C                          4-0-0/w SBIN        r     1 CHAIN_HEAD
     5-0-0/w SBIN        r     1 CHAIN_TAIL                 6-0-0/w UBIN        r     1 COUNT
    *0-0-0/w UBIN        r     1 D1                        *0-0-0/w UBIN        r     1 D2
    10-0-0/w UBIN        r     1 DATAWRD(0:5)
    20-0-0/w PTR         r     1 DCB$                      21-0-0/w PTR         r     1 DCBPTR$
    16-0-0/d DSCR        r     1 DESC                      16-0-0/d BIT (72)    r     1 DWORD
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:140  
    22-0-0/w SBIN        r     1 I                         23-0-0/c CHAR(6)     r     1 INWCFS
    25-0-0/w UBIN        r     1 J                         26-0-0/w UBIN        r     1 K
    27-0-0/w UBIN        r     1 NUM                       30-0-0/w SBIN        r     1 NXT_VPNO
    *0-0-0/w SBIN        r     1 P                         31-0-0/w UBIN        r     1 PCORE
    32-0-0/w SBIN        r     1 PCOUNT                    33-0-0/w SBIN        r     1 PMAX
    34-0-0/w SBIN        r     1 PMIN                      35-0-0/w SBIN        r     1 PPNO
    36-0-0/w PTR         r     1 PR2$                      36-0-0/w STRC        r     1 PR2_STRUC
    41-0-0/c UBIN(9)     r     1 PTB(0:511)                37-0-0/w SBIN        r     1 PTBPGS
    40-0-0/w SBIN        r     1 PTBSECT                  241-0-0/w BIT         r     1 RUNNING
   242-0-0/w PTR         r     1 SEGP$                    243-0-0/w SBIN        r     1 TEMP
    *0-0-0/w STRC(144)   r     1 TOP                      646-0-0/w SBIN        r     1 UPGS
   244-0-0/w PTR         r     1 USE$                     245-0-0/w SBIN        r     1 USER
   246-0-0/h UBIN(18)    r     1 UTB(0:511)                *0-0-0/w SBIN        r     1 V
   660-0-0/w PTR         r     1 VCB$                     647-0-0/w SBIN        r     1 VPMAX
   650-0-0/w SBIN        r     1 VPMAX_WRITTEN            651-0-0/w SBIN        r     1 VPNO
   652-0-0/w PTR         r     1 VPT$                     653-0-0/w SBIN        r     1 VSG#
   654-0-0/w SBIN        r     1 VSG_DCB#                 656-0-0/d VECT        r     1 V_
   661-0-0/w SBIN        r     1 WSQ#

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$IS$                      0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w PTR         r     1 B$MONHJIT$                 0-0-0/w PTR         r     1 B$MPT$
     0-0-0/w PTR         r     1 B$PPUT$                    0-0-0/w PTR         r     1 B$ROS$
     0-0-0/w PTR         r     1 B$SEGTBL$                  0-0-0/w PTR         r     1 B$VPT$
     0-0-0/w EPTR        r     1 DAF$WRITE                  0-0-0/w SBIN        r     1 DA_CUN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/h STRC(108)   r     1 AUTOFRAME
     0-0-0/d BIT (72)    r     1 B$DWORDS(0:0)
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:141  
     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC        r     1 B$MAP(0:1023)
     0-0-0/w STRC(36864) r     1 B$PAGE                     0-0-0/d STRC(3024)  r     1 B$ROSEG
     0-0-0/w SBIN        r     1 B$WORD
     0-0-0/w PTR         r     1 DCBTAB$(0:0)
     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC        r     1 MM$PPUT(0:0)
     0-0-0/w STRC(432)   r     1 MM$VCB                     0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w STRC        r     1 SEGPT(0:0)                 0-0-0/w STRC(72)    r     1 SEGTBL
     0-0-0/c CHAR(4)     r     1 USE_TABLE(0:1)


   Procedure DAD$VSCHECK requires 2081 words for executable code.
   Procedure DAD$VSCHECK requires 542 words of local(AUTO) storage.

    No errors detected in file DAD$VSCHECK.:E05TSI    .
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:142  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:143  
          MINI XREF LISTING

ALT
     13693**LABEL   13281--CALLALT 13282--CALLALT 13283--CALLALT 13330--CALLALT 13331--CALLALT 13337--CALLALT
     13424--CALLALT 13425--CALLALT 13471--CALLALT 13568--CALLALT
AUTOFRAME.NEXT_FRAME
     11747**DCL     13334>>ASSIGN
B$DWORDS
     11750**DCL     13569>>ASSIGN
B$IS$
     11581**DCL     13279>>ASSIGN  13308>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       442**DCL       442--REDEF
B$JIT.ERR.MID
       349**DCL       349--REDEF
B$JIT.JRESPEAK
       510**DCL       511--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       619**DCL       619--REDEF     620--REDEF
B$JIT.PNR
       523**DCL       523--REDEF
B$JIT.TSLINE
       617**DCL       618--REDEF
B$JIT.VIRTUAL.DCB#
       513**DCL     13710>>ASSIGN
B$JIT$
     11582**DCL       343--IMP-PTR 13708<>CALL
B$MAP.RPN
       666**DCL     13271>>ASSIGN  13473>>ASSIGN  13554>>ASSIGN
B$MAP.SCTRL
       667**DCL       668--REDEF
B$MONHJIT$
     11587**DCL     13568<>CALL
B$MPT$
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:144  
     11584**DCL     13471<>CALL    13552<>CALL
B$PAGE.WRD
       717**DCL     13272>>ASSIGN
B$PPUT$
     11583**DCL     13179<>CALL    13283<>CALL    13337<>CALL
B$ROS$
     11585**DCL     13702<>CALL
B$ROSEG.DCBPTR$
       734**DCL     13705<>CALL
B$SEGTBL$
     11586**DCL     13444<>CALL
B$VPT$
     11588**DCL     13182<>CALL
B$WORD
     11749**DCL     13284>>ASSIGN  13285>>ASSIGN  13286>>ASSIGN  13332>>ASSIGN  13426>>ASSIGN
C IN PROCEDURE GET_ENTRY
     13259**DCL     13258--PROC    13266>>ASSIGN  13267>>IF      13268>>ASSIGN  13273<<ASSIGN  13274>>IF
CHAIN_HEAD
     11803**DCL     13218<<ASSIGN  13221--CALL    13284<<ASSIGN  13287--CALL    13289>>ASSIGN
CHAIN_TAIL
     11804**DCL     13219<<ASSIGN  13221--CALL    13285<<ASSIGN  13287--CALL
COMM#
     13102**DCL     13409<<ASSIGN  13409>>ASSIGN  13585>>ASSIGN  13613--CALL
COUNT
     11805**DCL     13286<<ASSIGN  13287--CALL    13295>>IF
COUNT_ERR
     11852**DCL     13250--CALL
CPUNAME
     13061**DCL     13557>>ASSIGN
CPUPT
     13053**DCL     13057--REDEF
CPUPT$
     13057**DCL     13550<>CALL
D1 IN PROCEDURE GET_ENTRY
     13260**DCL     13258--PROC    13268<<ASSIGN  13270<<ASSIGN
D2 IN PROCEDURE GET_ENTRY
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:145  
     13261**DCL     13258--PROC    13272<<ASSIGN
DAA$VALUE
     11569**DCL-ENT 13696--CALL    13697--CALL
DAD$FREXT
     11570**DCL-ENT 13335--CALL
DAD$FRREL
     11571**DCL-ENT 13690--CALL
DAF$ADDHDR
     11572**DCL-ENT 13211--CALL    13220--CALL    13223--CALL
DAF$INIT
     11573**DCL-ENT 13210--CALL    13229--CALL    13430--CALL    13462--CALL    13594--CALL    13622--CALL
     13646--CALL    13674--CALL
DAF$WRITE
     11574**DCL     13214>>CALL    13221>>CALL    13236>>CALL    13240>>CALL    13246>>CALL    13250>>CALL
     13254>>CALL    13287>>CALL    13296>>CALL    13433>>CALL    13465>>CALL    13613>>CALL    13640>>CALL
     13664>>CALL    13681>>CALL
DAM$MAP
     11575**DCL-ENT 13179--CALL    13182--CALL    13282--CALL    13283--CALL    13331--CALL    13337--CALL
     13425--CALL    13444--CALL    13471--CALL    13550--CALL    13552--CALL    13568--CALL    13702--CALL
     13705--CALL    13708--CALL    13711--CALL    13714--CALL
DAM$USECPU
     11576**DCL-ENT 13547--CALL    13567--CALL
DAS$SDSRCHPTR
     11577**DCL-ENT 13281--CALL    13330--CALL    13424--CALL
DATAWRD
     11807**DCL     13228<<ASSIGN  13235<>CALL    13235<>CALL    13236--CALL    13236--CALL    13239<>CALL
     13239<>CALL    13240--CALL    13240--CALL    13240--CALL    13240--CALL    13244<>CALL    13244<>CALL
     13246--CALL    13246--CALL    13246--CALL    13246--CALL    13246--CALL    13246--CALL
DA_CUN
      7561**DCL     13182<>CALL    13699<<ASSIGN  13701<<ASSIGN  13702<>CALL    13705<>CALL    13708<>CALL
     13711<>CALL    13714<>CALL
DA_MAPSEG.P
      7591**DCL      7592--REDEF
DA_SDASN.DESC.TYPE0
      7576**DCL      7576--REDEF
DA_SYMSEG.P
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:146  
      7635**DCL      7636--REDEF
DA_TIGRSEG.P
      7592**DCL      7593--REDEF
DCB$
     11810**DCL     13711<>CALL    13714>>CALL
DCBPTR$
     11811**DCL     13705<>CALL    13711>>CALL
DCBTAB$
     11751**DCL     13711<>CALL
DESC
     11809**DCL     13570>>ASSIGN  13571>>ASSIGN
DIAG#
     13097**DCL     13357<<ASSIGN  13357>>ASSIGN  13363<<ASSIGN  13363>>ASSIGN  13369<<ASSIGN  13369>>ASSIGN
     13585>>ASSIGN  13613--CALL
DIPGCHAIN
     13226**PROC    13185--CALL
DO_PROCESSOR
     13620**LABEL   13593--GOTO
DO_USAGE
     13672**LABEL   13645--GOTO
DO_USER
     13644**LABEL   13621--GOTO
DWORD
     11808**DCL     11809--REDEF   13569<<ASSIGN
END_VP
     11856**DCL     13234>>DOWHILE 13274>>IF
F$DCB.ACTPOS
     11673**DCL     11673--REDEF
F$DCB.ARS#
     11647**DCL     11647--REDEF
F$DCB.ATTR
     11666**DCL     11667--REDEF
F$DCB.BORROW
     11681**DCL     11681--REDEF   11681--REDEF   11681--REDEF
F$DCB.DCBNAME.L
     11695**DCL     11695--IMP-SIZ
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:147  
F$DCB.EOMCHAR#
     11651**DCL     11651--REDEF
F$DCB.FLDID
     11676**DCL     11676--REDEF
F$DCB.FORM$
     11670**DCL     11670--REDEF
F$DCB.FSECT
     11686**DCL     11686--REDEF
F$DCB.FSN#
     11663**DCL     11663--REDEF   11663--REDEF   11664--REDEF
F$DCB.HEADER$
     11669**DCL     11669--REDEF
F$DCB.IXTNSIZE#
     11667**DCL     11667--REDEF
F$DCB.LASTSTA$
     11656**DCL     11656--REDEF
F$DCB.LVL
     11682**DCL     11682--REDEF
F$DCB.NAME#.C
     11657**DCL     11657--REDEF
F$DCB.NOEOF
     11679**DCL     11679--REDEF
F$DCB.NRECS#
     11668**DCL     11668--REDEF
F$DCB.NRECX
     11687**DCL     11687--REDEF
F$DCB.OHDR
     11679**DCL     11679--REDEF
F$DCB.ORG#
     11662**DCL     11662--REDEF
F$DCB.PRECNO
     11685**DCL     11685--REDEF
F$DCB.RCSZ
     11691**DCL     11691--REDEF
F$DCB.RES#
     11658**DCL     11658--REDEF
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:148  
F$DCB.SETSTA$
     11656**DCL     13714<>CALL
F$DCB.SETX
     11670**DCL     11670--REDEF
F$DCB.TAB$
     11670**DCL     11670--REDEF
F$DCB.TDA
     11684**DCL     11685--REDEF
F$DCB.WSN#
     11658**DCL     11658--REDEF
FIRM#
     13113**DCL     13514<<ASSIGN  13514>>ASSIGN  13585>>ASSIGN  13613--CALL
FNFFMT
     13092**DCL     13433--CALL
FREE#
     13094**DCL     13345<<ASSIGN  13345>>ASSIGN  13585>>ASSIGN  13613--CALL
FREE_CH#
     13095**DCL     13436<<ASSIGN  13436>>ASSIGN  13613--CALL
GET_ENTRY
     13258**PROC    13235--CALL    13239--CALL    13244--CALL
I
     11812**DCL     13289<<ASSIGN  13291>>DOWHILE 13293<<ASSIGN  13293>>ASSIGN  13296--CALL    13311<<DOINDEX
     13312>>DOCASE  13426<<ASSIGN  13427>>DOWHILE 13428>>IF      13433--CALL    13433>>CALL    13435>>ASSIGN
     13437>>ASSIGN  13438<<ASSIGN  13438>>ASSIGN  13448<<ASSIGN  13449>>DOUNTIL 13450>>IF      13452>>ASSIGN
     13453>>CALLBLT 13456<<ASSIGN  13456>>ASSIGN  13472<<DOINDEX 13473>>ASSIGN  13476>>IF      13476>>IF
     13481>>IF      13481>>IF      13487>>IF      13487>>IF      13493>>IF      13493>>IF      13499>>IF
     13499>>IF      13505>>IF      13505>>IF      13511>>IF      13511>>IF      13517>>IF      13517>>IF
     13521>>IF      13521>>IF      13527>>IF      13527>>IF      13533>>IF      13553<<DOINDEX 13554>>ASSIGN
     13555>>IF      13555>>IF      13555>>IF      13555>>IF      13558>>IF      13558>>IF      13572<<DOINDEX
     13573>>IF      13574>>ASSIGN  13581<<DOINDEX 13582>>IF      13585<<ASSIGN  13613--CALL    13623<<DOINDEX
     13626>>ASSIGN  13640--CALL    13640>>CALL    13640>>CALL    13640>>CALL    13640>>CALL    13640>>CALL
     13640>>CALL    13640>>CALL    13640>>CALL    13640>>CALL    13640>>CALL    13647<<DOINDEX 13650>>ASSIGN
     13664--CALL    13664>>CALL    13664>>CALL    13664>>CALL    13664>>CALL    13664>>CALL    13664>>CALL
     13664>>CALL    13664>>CALL    13664>>CALL    13664>>CALL
INWCFS
     11813**DCL     13191<<ASSIGN  13193<<ASSIGN  13195<<ASSIGN  13197<<ASSIGN  13199<<ASSIGN  13201<<ASSIGN
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:149  
     13203<<ASSIGN  13214--CALL
IO#
     13096**DCL     13351<<ASSIGN  13351>>ASSIGN  13585>>ASSIGN  13613--CALL
J
     11814**DCL     13290<<ASSIGN  13292<<ASSIGN  13292>>ASSIGN  13295>>IF      13296--CALL    13437<<ASSIGN
     13446<<DOINDEX 13447>>ASSIGN  13448>>ASSIGN  13453>>CALLBLT 13546<<DOINDEX 13547<>CALL    13550>>CALL
     13557>>ASSIGN  13570<<ASSIGN  13571>>ASSIGN  13572>>DOINDEX 13586<<ASSIGN  13613--CALL    13625<<DOINDEX
     13626>>ASSIGN  13649<<DOINDEX 13650>>ASSIGN  13675<<DOINDEX 13681--CALL    13681>>CALL    13681>>CALL
     13681>>CALL    13681>>CALL    13681>>CALL    13681>>CALL    13681>>CALL    13681>>CALL
JIT$
     11815**DCL     13708<>CALL    13710>>ASSIGN
K
     11816**DCL     13571<<ASSIGN  13572>>DOINDEX 13624<<ASSIGN  13626<<ASSIGN  13626>>ASSIGN  13628>>IF
     13648<<ASSIGN  13650<<ASSIGN  13650>>ASSIGN  13652>>IF
LOST#
     13117**DCL     13582<<ASSIGN  13582>>ASSIGN  13585>>ASSIGN  13613--CALL
LOW#
     13116**DCL     13530<<ASSIGN  13530>>ASSIGN  13585>>ASSIGN  13613--CALL
M$ERR
      6953**DCL-ENT 13693--CALL
M$XXX
      6953**DCL-ENT 13333--CALL    13573--CALL
MM$PPUT.BAD
     11754**DCL     13360>>IF
MM$PPUT.COMM
     11761**DCL     13406>>IF
MM$PPUT.FREE
     11756**DCL     13342>>IF
MM$PPUT.IN_TEST
     11755**DCL     13366>>IF
MM$PPUT.IO
     11758**DCL     13348>>IF
MM$PPUT.PPNO
     11764**DCL     13270>>ASSIGN  13273>>ASSIGN  13291>>DOWHILE 13293>>ASSIGN  13438>>ASSIGN
MM$PPUT.PRC
     11759**DCL     13386>>IF
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:150  
MM$PPUT.STOLEN
     11760**DCL     13400>>IF
MM$PPUT.SUSPECT
     11753**DCL     13354>>IF
MM$PPUT.USER
     11757**DCL     13372>>IF
MM$PPUT.USER#
     11762**DCL     11763--REDEF   13340>>ASSIGN  13412>>IF
MM$VCB.CREATE
     11771**DCL     13198>>IF
MM$VCB.HEAD
     11791**DCL     13218>>ASSIGN  13231>>ASSIGN  13232>>ASSIGN  13267>>IF
MM$VCB.INITIALIZE
     11768**DCL     13192>>IF
MM$VCB.MAXVP#
     11780**DCL     13216>>ASSIGN
MM$VCB.MAXVP_WRITTEN
     11793**DCL     13217>>ASSIGN
MM$VCB.NOFILE
     11769**DCL     13194>>IF
MM$VCB.NPGTPGS
     11796**DCL     13204>>ASSIGN
MM$VCB.NPGTSECT
     11795**DCL     13205>>ASSIGN
MM$VCB.PPC
     11794**DCL     13207>>ASSIGN  13248>>IF      13249>>ASSIGN
MM$VCB.PPMAX
     11781**DCL     13208>>ASSIGN
MM$VCB.PPMIN
     11782**DCL     13209>>ASSIGN
MM$VCB.T.FRAGMENTED
     11773**DCL     13200>>IF
MM$VCB.T.SECTION
     11774**DCL     13202>>IF
MM$VCB.TAIL
     11792**DCL     13219>>ASSIGN  13252>>IF      13253>>ASSIGN
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:151  
MM$VCB.UPGT#
     11797**DCL     13206>>ASSIGN
MM$VCB.WRITE
     11770**DCL     13196>>IF
MM$VCB.WSQ
     11776**DCL     13190>>ASSIGN
MON#
     13114**DCL     13454<<ASSIGN  13454>>ASSIGN  13524<<ASSIGN  13524>>ASSIGN  13536<<ASSIGN  13536>>ASSIGN
     13585>>ASSIGN  13613--CALL
MONCXT#
     13115**DCL     13559<<ASSIGN  13559>>ASSIGN  13585>>ASSIGN  13613--CALL
MONDS#
     13111**DCL     13484<<ASSIGN  13484>>ASSIGN  13490<<ASSIGN  13490>>ASSIGN  13496<<ASSIGN  13496>>ASSIGN
     13502<<ASSIGN  13502>>ASSIGN  13585>>ASSIGN  13613--CALL
MPT$
     13119**DCL     13471<>CALL    13473>>ASSIGN  13550<>CALL    13552<>CALL    13554>>ASSIGN
NAME_FPPH
     13173**DCL     13281<>CALL    13424<>CALL
NAME_PCORE
     13149**DCL     13330<>CALL
NEXT
     13562**LABEL   13550--CALLALT 13552--CALLALT
NO_OVRLYS
     13091**DCL     13465--CALL
NUM
     11817**DCL     13249<<ASSIGN  13250--CALL    13253<<ASSIGN  13254--CALL    13340<<ASSIGN  13372>>IF
     13376>>ASSIGN  13376>>ASSIGN  13377>>CALLBLT 13390>>ASSIGN  13390>>ASSIGN  13391>>CALLBLT
NXT_VPNO
     11818**DCL     13231<<ASSIGN  13234>>DOWHILE 13235<>CALL    13239<>CALL    13244<>CALL
OUT$
     13118**DCL     13281<>CALL    13282<>CALL    13282<>CALL    13284>>ASSIGN  13285>>ASSIGN  13286>>ASSIGN
     13330<>CALL    13331<>CALL    13331<>CALL    13332>>ASSIGN  13424<>CALL    13425<>CALL    13425<>CALL
     13426>>ASSIGN  13568<>CALL    13569>>ASSIGN
OUT$BLK
     11703**DCL     13696<>CALL    13697<>CALL
OUT$BLK.CODE
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:152  
     11711**DCL     13312>>DOCASE
P IN PROCEDURE GET_ENTRY
     13262**DCL     13258--PROC    13270>>ASSIGN  13271<<ASSIGN  13273>>ASSIGN
P#
     13099**DCL     13389<<ASSIGN  13389>>ASSIGN  13585>>ASSIGN  13613--CALL
PCORE
     11819**DCL     13332<<ASSIGN  13333>>IF      13335<>CALL    13339>>DOINDEX 13581>>DOINDEX 13586>>ASSIGN
     13675>>DOINDEX
PCOUNT
     11820**DCL     13207<<ASSIGN  13214--CALL    13214--CALL    13230<<ASSIGN  13248>>IF      13250--CALL
     13265<<ASSIGN  13265>>ASSIGN
PERRFMT
     13086**DCL     13296--CALL
PGOODFMT
     13088**DCL     13287--CALL
PMAX
     11821**DCL     13208<<ASSIGN  13214--CALL    13214--CALL
PMIN
     11822**DCL     13209<<ASSIGN  13214--CALL    13214--CALL
PMRPRT
     12272**DCL     13430<>CALL    13462<>CALL
PMRPRTHD00
     12338**DCL     12307--DCLINIT
PMRPRTTX00
     12315**DCL     12302--DCLINIT
PMRPRTTX01
     12356**DCL     12346--DCLINIT
PPNO
     11823**DCL     13235<>CALL    13239<>CALL    13244<>CALL    13339<<DOINDEX 13340>>ASSIGN  13341>>ASSIGN
     13342>>IF      13344>>ASSIGN  13348>>IF      13350>>ASSIGN  13354>>IF      13356>>ASSIGN  13360>>IF
     13362>>ASSIGN  13366>>IF      13368>>ASSIGN  13372>>IF      13374>>ASSIGN  13377>>CALLBLT 13378>>IF
     13380>>ASSIGN  13381>>IF      13382>>ASSIGN  13386>>IF      13388>>ASSIGN  13391>>CALLBLT 13392>>IF
     13394>>ASSIGN  13395>>IF      13396>>ASSIGN  13400>>IF      13402>>ASSIGN  13406>>IF      13408>>ASSIGN
     13412>>IF      13414>>ASSIGN  13473<<ASSIGN  13474>>IF      13474>>IF      13478>>ASSIGN  13483>>ASSIGN
     13489>>ASSIGN  13495>>ASSIGN  13501>>ASSIGN  13507>>ASSIGN  13513>>ASSIGN  13523>>ASSIGN  13529>>ASSIGN
     13535>>ASSIGN  13554<<ASSIGN  13555>>IF      13555>>IF      13557>>ASSIGN  13558>>ASSIGN
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:153  
PPRPRT
     12488**DCL     13622<>CALL
PPRPRTHD00
     12554**DCL     12523--DCLINIT
PPRPRTHD01
     12597**DCL     12569--DCLINIT
PPRPRTHD02
     12640**DCL     12612--DCLINIT
PPRPRTTX00
     12531**DCL     12518--DCLINIT
PPRPRTTX01
     12572**DCL     12562--DCLINIT
PPRPRTTX02
     12615**DCL     12605--DCLINIT
PPRPRTTX03
     12658**DCL     12648--DCLINIT
PPUT#
     13103**DCL     13575<<ASSIGN  13575>>ASSIGN  13585>>ASSIGN  13613--CALL
PPUT$
     13120**DCL     13179<>CALL    13270>>ASSIGN  13273>>ASSIGN  13283<>CALL    13291>>DOWHILE 13293>>ASSIGN
     13337<>CALL    13340>>ASSIGN  13342>>IF      13348>>IF      13354>>IF      13360>>IF      13366>>IF
     13372>>IF      13386>>IF      13400>>IF      13406>>IF      13412>>IF      13438>>ASSIGN
PPUTFMT
     13085**DCL     13681--CALL
PPUT_FLAG
     13104**DCL     13304<<ASSIGN  13325<<ASSIGN
PPUT_FLAG.MISC
     13109**DCL     13429>>IF      13431<<ASSIGN  13461>>IF      13463<<ASSIGN
PPUT_FLAG.PROCESSOR
     13106**DCL     13316<<ASSIGN  13620>>IF
PPUT_FLAG.SUMMARY
     13105**DCL     13314<<ASSIGN  13592>>IF
PPUT_FLAG.USAGE
     13108**DCL     13320<<ASSIGN  13672>>IF
PPUT_FLAG.USER
     13107**DCL     13318<<ASSIGN  13644>>IF
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:154  
PR2$
     11824**DCL        19--MATRLIZ 11742--IMP-PTR 11825--REDEF   13334>>ASSIGN  13334>>ASSIGN
PR2_STRUC.WORD_OFFSET
     11826**DCL     13334>>ASSIGN
PSRPRT
     12380**DCL     13594<>CALL
PSRPRTHD00
     12446**DCL     12415--DCLINIT
PSRPRTTX00
     12423**DCL     12410--DCLINIT
PSRPRTTX01
     12464**DCL     12454--DCLINIT
PTB
     11830**DCL     13306<<ASSIGN  13390<<ASSIGN  13390>>ASSIGN  13626>>ASSIGN  13640--CALL    13640--CALL
     13640--CALL    13640--CALL    13640--CALL    13640--CALL    13640--CALL    13640--CALL    13640--CALL
     13640--CALL
PTBPGS
     11828**DCL     13204<<ASSIGN  13214--CALL
PTBSECT
     11829**DCL     13205<<ASSIGN  13214--CALL
PUFMT
     13083**DCL     13640--CALL    13664--CALL
PURPRT
     12682**DCL     13646<>CALL
PURPRTHD00
     12748**DCL     12717--DCLINIT
PURPRTHD01
     12791**DCL     12763--DCLINIT
PURPRTHD02
     12834**DCL     12806--DCLINIT
PURPRTTX00
     12725**DCL     12712--DCLINIT
PURPRTTX01
     12766**DCL     12756--DCLINIT
PURPRTTX02
     12809**DCL     12799--DCLINIT
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:155  
PURPRTTX03
     12852**DCL     12842--DCLINIT
PUSRPRT
     12876**DCL     13674<>CALL
PUSRPRTHD00
     12942**DCL     12911--DCLINIT
PUSRPRTHD01
     12985**DCL     12957--DCLINIT
PUSRPRTHD02
     13028**DCL     13000--DCLINIT
PUSRPRTTX00
     12919**DCL     12906--DCLINIT
PUSRPRTTX01
     12960**DCL     12950--DCLINIT
PUSRPRTTX02
     13003**DCL     12993--DCLINIT
PUSRPRTTX03
     13046**DCL     13036--DCLINIT
ROS$
     11831**DCL     13702<>CALL    13705>>CALL
RUNNING
     11832**DCL     13548>>IF
SDS#
     13100**DCL     13415<<ASSIGN  13415>>ASSIGN  13585>>ASSIGN  13613--CALL
SEARCH_CHAIN IN PROCEDURE DIPGCHAIN
     13234**LABEL   13237--EXIT    13242--EXIT
SEGP$
     11833**DCL     11848--IMP-PTR 13447<<ASSIGN  13450>>IF      13452>>ASSIGN  13453>>CALLBLT
SEGPT.RPN
     11849**DCL     13450>>IF      13452>>ASSIGN  13453>>CALLBLT
SEGTBL.NODES.WOFF
     13125**DCL     13447>>ASSIGN
SEGTBL.NODES.WSIZ
     13126**DCL     13448>>ASSIGN
SEGTBL$
     13121**DCL     13122--IMP-PTR 13444<>CALL    13447>>ASSIGN  13447>>ASSIGN  13448>>ASSIGN
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:156  
SETUP
     13695**PROC    13178--CALL    13189--CALL
STOLE#
     13101**DCL     13403<<ASSIGN  13403>>ASSIGN  13585>>ASSIGN  13613--CALL
SUMFMT
     13063**DCL     13613--CALL
TAIL_ERR
     11854**DCL     13254--CALL
TEMP
     11834**DCL     13697<>CALL    13698>>IF
TIGR#
     13112**DCL     13508<<ASSIGN  13508>>ASSIGN  13585>>ASSIGN  13613--CALL
TOP
     11595**DCL        19--PROC    13188--ENTRY   13299--ENTRY
TOP.NSUBLKS
     11607**DCL     13310>>IF      13311>>DOINDEX
TOP.SUBLK$
     11628**DCL     13312>>DOCASE  13696>>CALL    13697>>CALL
U#
     13098**DCL     13375<<ASSIGN  13375>>ASSIGN  13585>>ASSIGN  13613--CALL
UPGS
     11838**DCL     13206<<ASSIGN  13214--CALL
USE$
     11835**DCL     11799--IMP-PTR 13334<<ASSIGN  13341>>ASSIGN  13344>>ASSIGN  13350>>ASSIGN  13356>>ASSIGN
     13362>>ASSIGN  13368>>ASSIGN  13374>>ASSIGN  13377>>CALLBLT 13378>>IF      13380>>ASSIGN  13381>>IF
     13382>>ASSIGN  13388>>ASSIGN  13391>>CALLBLT 13392>>IF      13394>>ASSIGN  13395>>IF      13396>>ASSIGN
     13402>>ASSIGN  13408>>ASSIGN  13414>>ASSIGN  13428>>IF      13433>>CALL    13435>>ASSIGN  13452>>ASSIGN
     13453>>CALLBLT 13474>>IF      13478>>ASSIGN  13483>>ASSIGN  13489>>ASSIGN  13495>>ASSIGN  13501>>ASSIGN
     13507>>ASSIGN  13513>>ASSIGN  13523>>ASSIGN  13529>>ASSIGN  13535>>ASSIGN  13555>>IF      13557>>ASSIGN
     13558>>ASSIGN  13573>>IF      13574>>ASSIGN  13582>>IF      13681>>CALL    13681>>CALL    13681>>CALL
     13681>>CALL    13681>>CALL    13681>>CALL    13681>>CALL    13681>>CALL
USER
     11836**DCL     13697<>CALL    13699>>ASSIGN  13701>>ASSIGN
USE_TABLE
     11799**DCL     13341<<ASSIGN  13344<<ASSIGN  13350<<ASSIGN  13356<<ASSIGN  13362<<ASSIGN  13368<<ASSIGN
     13374<<ASSIGN  13377<<CALLBLT 13378>>IF      13380<<ASSIGN  13381>>IF      13382<<ASSIGN  13388<<ASSIGN
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:157  
     13391<<CALLBLT 13392>>IF      13394<<ASSIGN  13395>>IF      13396<<ASSIGN  13402<<ASSIGN  13408<<ASSIGN
     13414<<ASSIGN  13428>>IF      13433--CALL    13435<<ASSIGN  13452<<ASSIGN  13453<<CALLBLT 13474>>IF
     13478<<ASSIGN  13483<<ASSIGN  13489<<ASSIGN  13495<<ASSIGN  13501<<ASSIGN  13507<<ASSIGN  13513<<ASSIGN
     13523<<ASSIGN  13529<<ASSIGN  13535<<ASSIGN  13555>>IF      13557<<ASSIGN  13558<<ASSIGN  13573>>IF
     13574<<ASSIGN  13582>>IF      13681--CALL    13681--CALL    13681--CALL    13681--CALL    13681--CALL
     13681--CALL    13681--CALL    13681--CALL
UTB
     11837**DCL     13305<<ASSIGN  13376<<ASSIGN  13376>>ASSIGN  13650>>ASSIGN  13664--CALL    13664--CALL
     13664--CALL    13664--CALL    13664--CALL    13664--CALL    13664--CALL    13664--CALL    13664--CALL
     13664--CALL
V IN PROCEDURE GET_ENTRY
     13263**DCL     13258--PROC    13266<<ASSIGN  13271>>ASSIGN  13272>>ASSIGN
VCB$
     11846**DCL     11767--IMP-PTR 13190>>ASSIGN  13192>>IF      13194>>IF      13196>>IF      13198>>IF
     13200>>IF      13202>>IF      13204>>ASSIGN  13205>>ASSIGN  13206>>ASSIGN  13207>>ASSIGN  13208>>ASSIGN
     13209>>ASSIGN  13216>>ASSIGN  13217>>ASSIGN  13218>>ASSIGN  13219>>ASSIGN  13231>>ASSIGN  13232>>ASSIGN
     13248>>IF      13249>>ASSIGN  13252>>IF      13253>>ASSIGN  13267>>IF      13714<>CALL
VPMAX
     11839**DCL     13216<<ASSIGN  13221--CALL
VPMAX_WRITTEN
     11840**DCL     13217<<ASSIGN  13221--CALL
VPNO
     11841**DCL     13232<<ASSIGN  13235<>CALL    13239<>CALL    13244<>CALL    13252>>IF      13254--CALL
VPT$
     11842**DCL     13182<>CALL    13227<<ASSIGN  13227>>ASSIGN  13271>>ASSIGN  13272>>ASSIGN
VSG#
     11843**DCL     13214--CALL    13214--CALL    13227>>ASSIGN  13696<>CALL    13710>>ASSIGN
VSG_DCB#
     11844**DCL     13214--CALL    13710<<ASSIGN  13711>>CALL
VSHDR
     11944**DCL     13211<>CALL
VSPCRPT
     12118**DCL     13229<>CALL
VSPCRPTHD00
     12185**DCL     12153--DCLINIT
VSPCRPTHD01
PL6.E3A0      #001=DAD$VSCHECK File=DAD$VSCHECK.:E05TSI                          TUE 07/29/97 12:48 Page:158  
     12228**DCL     12200--DCLINIT
VSPCRPTTX00
     12161**DCL     12148--DCLINIT
VSPCRPTTX01
     12203**DCL     12193--DCLINIT
VSPCRPTTX02
     12246**DCL     12236--DCLINIT
VSRPRT
     11875**DCL     13210<>CALL
VSRPRTHD01
     11985**DCL     11957--DCLINIT
VSRPRTHD03
     12073**DCL     12045--DCLINIT
VSRPRTTX00
     11918**DCL     11905--DCLINIT
VSRPRTTX01
     11960**DCL     11950--DCLINIT
VSRPRTTX02
     12003**DCL     11993--DCLINIT
VSRPRTTX03
     12048**DCL     12038--DCLINIT
VSRPRTTX04
     12091**DCL     12081--DCLINIT
VSRPT1
     12032**DCL     13220<>CALL
VSSFMT1
     12010**DCL     13214--CALL
VSSFMT2
     12098**DCL     13221--CALL
VSSFMT3
     12253**DCL     13236--CALL    13240--CALL    13246--CALL
V_
     11845**DCL     13278<<ASSIGN  13279<<ASSIGN  13280<<ASSIGN  13282<>CALL    13307<<ASSIGN  13308<<ASSIGN
     13309<<ASSIGN  13331<>CALL    13425<>CALL
WSQ#
     11847**DCL     13190<<ASSIGN  13214--CALL
