VERSION E05

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:1    
        1        1        /*M* XUG$COMMON - COMMON COMMAND READING AND ERROR REPORTING ROUTINES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
        8        8        XUG$COMMON: PROC (GETCMD, XUG_INIT) ALTRET;
        9        9        /**/
       10       10    1   DCL 1 VECBASE BASED,                    /* USED AS REDEF OF NODES */
       11       11    1         2 BOUND UBIN(20) UNAL,
       12       12    1         2 FLAGS BIT(16),
       13       13    1         2 P$ PTR;
       14       14    1   DCL PR$ PTR;
       15       15    1   DCL 1 PROMPT$C CALIGNED BASED(PR$),
       16       16    1         2 C CHAR(PSIZ);
       17       17    1   DCL PSIZ SBIN;
       18       18        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:2    
       19       19    1   DCL X$PARSE ENTRY(1) ALTRET;
       20       20    1   DCL XUG$BLANK_PASSWORD_COMMON ENTRY(2) ALTRET ;
       21       21    1   DCL XUG$ERRMSG_COMMON ENTRY(1) ALTRET;
       22       22    1   DCL XUG$READCMD_COMMON ENTRY(3) ALTRET;
       23       23    1   DCL XUG$CORRES_COMMON ENTRY(2) ALTRET;
       24       24    1   DCL XUG$PU ENTRY(1) ALTRET ;
       25       25    1   DCL XUG$SETLAST ENTRY(1) ALTRET;
       26       26    1   DCL XUG$ECHOLAST_COMMON ENTRY(1) ALTRET;
       27       27    1   DCL XUG$DISABLE_COMMON ENTRY(1) ;
       28       28    1   DCL XUG$CLRENABLE_COMMON ENTRY(1) ;
       29       29    1   DCL XUG$GETDCB_COMMON ENTRY(2) ALTRET;
       30       30    1   DCL XUG$BUILTIN_COMMON ENTRY (1) ALTRET;
       31       31    1   DCL XUG$PRE_PROCESSOR ENTRY (2);
       32       32    1   DCL XUG$PP_CMDVARS ENTRY (2);
       33       33    1   DCL XUG$OPENOUT_INTERNAL ENTRY(2);
       34       34        /**/
       35       35        %INCLUDE B$JIT;
       36      638        %INCLUDE B$TABLES_C;
       37      746        %INCLUDE NK_VFC_C;
       38      820        %INCLUDE XU_MACRO_C;
       39     3926        %INCLUDE XUH_MACRO_C ;
       40     4010        %INCLUDE XT_MACRO_M;
       41     4336        %INCLUDE XU_PERR_C;
       42     4527        %INCLUDE XU_SUBS_C ;
       43     4619        %INCLUDE XU_DATA_R;
       44     4630        %B$XL_UPPER (NAME=TRANSTBL);
       45     4634        %P_PCB (STCLASS="BASED(P_PCB$)");
       46     4833        %P_PCB (STCLASS=CONSTANT,NAME=P_PCB_C);
       47     5032        %P$NODE (STCLASS=BASED);
       48     5126        %P$LIT (STCLASS=BASED, LEN="P$LIT.COUNT");
       49     5179        %PARSE$OUT (NAME=P$B, STCLASS=BASED) ;
       50     5224        %INCLUDE CP_6;
       51    10783        %INCLUDE CP_6_SUBS;
       52    11323        %INCLUDE B_SEGIDS_C ;
       53    11862        %F$DCB;
       54    11919        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
       55    11920        DCL 1 NAME STCLASS,
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:3    
       56    11921              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
       57    11922              2 C CHAR(0) INIT(T#);
       58    11923        %MEND;
       59    11924        %TEXTC (NAME=M$SI,T#='M$SI');
       60    11929        %TEXTC (NAME=M$LO,T#='M$LO');
       61    11934        %SET GDSSIZ = 1024;
       62    11935        %FPT_GDS (FPTN=FPT_GDS_C, SEGSIZE=%GDSSIZ, STCLASS=CONSTANT);
       63    11951        %FPT_GDS (FPTN=FPT_GDS, STCLASS=AUTO);
       64    11967    1   DCL USER_GDSVEC VECTOR ;
       65    11968        %FPT_WRITE (WAIT=YES,STCLASS=CONSTANT,FPTN=FPT_WRITE_C);
       66    11999        %FPT_WRITE (STCLASS=AUTO);
       67    12030        %FPT_PROMPT (STCLASS=CONSTANT,FPTN=FPT_PROMPT_C);
       68    12058        %FPT_PROMPT (STCLASS=AUTO);
       69    12086        %FPT_OPEN (FPTN=FPT_OPEN_C, STCLASS=CONSTANT);
       70    12195        %FPT_OPEN (FPTN=FPT_OPEN, STCLASS=AUTO);
       71    12304        %FPT_SINPUT (FPTN=FPT_SINPUT_C, STCLASS=CONSTANT, POSITION=YES) ;
       72    12341        %FPT_SINPUT (FPTN=FPT_SINPUT, STCLASS=AUTO) ;
       73    12378        %FPT_MERC (FPTN=FPT_MERC, STCLASS=AUTO);
       74    12391        %FPT_MERC (FPTN=FPT_MERC_C, STCLASS=CONSTANT);
       75    12404        %VLP_ERRCODE (FPTN=XUG#SMALLWORK, STCLASS=CONSTANT,
       76    12405                      FCG=XU, MID=G, ERR#=%E$XUG#SMALLWORK, SEV=2) ;
       77    12450        %VLP_ERRCODE (FPTN=XUG#NOTCONTIGAREA, STCLASS="CONSTANT SYMDEF",
       78    12451                      FCG=XU, MID=G, ERR#=%E$XUG#NOTCONTIGAREA, SEV=2) ;
       79    12496        %VLP_ERRCODE (FPTN=XUG#AREANOTRTSZ, STCLASS="CONSTANT SYMDEF",
       80    12497                      FCG=XU, MID=G, ERR#=%E$XUG#AREANOTRTSZ, SEV=2) ;
       81    12542        %VLP_ERRCODE (FPTN=XUG#CANTEXPAND, STCLASS="CONSTANT SYMDEF",
       82    12543                      FCG=XU, MID=G, ERR#=%E$XUG#CANTEXPAND, SEV=2) ;
       83    12588        %VLP_ERRCODE (FPTN=XUG#PLERRMSG, STCLASS=CONSTANT,
       84    12589                      FCG=XU, MID=G, ERR#=%E$XUG#PLERRMSG, SEV=0) ;
       85    12634        %VLP_ERRCODE (FPTN=XUG#INCOR_PTD_XPND, STCLASS=CONSTANT,
       86    12635                      FCG=XU, MID=G, ERR#=%E$XUG#INCOR_PTD_XPND, SEV=0);
       87    12680        %VLP_ERRCODE (FPTN=XUG#INCOR_HERE_XPND, STCLASS=CONSTANT,
       88    12681                      FCG=XU, MID=G, ERR#=%E$XUG#INCOR_HERE_XPND, SEV=0) ;
       89    12726        %VLP_ERRCODE (FPTN=XUG#INCOR_HERE, STCLASS=CONSTANT,
       90    12727                      FCG=XU, MID=G, ERR#=%E$XUG#INCOR_HERE, SEV=0);
       91    12772        %VLP_ERRCODE (FPTN=XUG#NWALIGNED, STCLASS=CONSTANT,
       92    12773                      FCG=XU, MID=G, ERR#=%E$XUG#NWALIGNED, SEV=0) ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:4    
       93    12818        %VLP_ERRCODE (FPTN=XUG#LEGAL_INPUT_HERE, STCLASS=CONSTANT,
       94    12819                      FCG=XU, MID=G, ERR#=%E$XUG#LEGAL_INPUT_HERE, SEV=0);
       95    12864        %VLP_ERRCODE (FPTN=XUG#LEGAL_INPUT_QM, STCLASS=CONSTANT,
       96    12865                      FCG=XU, MID=G, ERR#=%E$XUG#LEGAL_INPUT_QM, SEV=0);
       97    12910        %VLP_ERRCODE (FPTN=XUG#SINGLE_LEGAL, STCLASS=CONSTANT,
       98    12911                      FCG=XU, MID=G, ERR#=%E$XUG#SINGLE_LEGAL, SEV=0);
       99    12956        %VLP_ERRCODE (FPTN=XUG#MULTI_LEGAL, STCLASS=CONSTANT,
      100    12957                      FCG=XU, MID=G, ERR#=%E$XUG#MULTI_LEGAL, SEV=0);
      101    13002        %VLP_ERRCODE (FPTN=XUG#SINGLE_CHOICE, STCLASS=CONSTANT,
      102    13003                      FCG=XU, MID=G, ERR#=%E$XUG#SINGLE_CHOICE, SEV=0);
      103    13048        %VLP_ERRCODE (FPTN=XUG#MULTI_CHOICE, STCLASS=CONSTANT,
      104    13049                      FCG=XU, MID=G, ERR#=%E$XUG#MULTI_CHOICE, SEV=0);
      105    13094        %VLP_ERRCODE (FPTN=XUG#NO_OTHER_CHOICE, STCLASS=CONSTANT,
      106    13095                      FCG=XU, MID=G, ERR#=%E$XUG#NO_OTHER_CHOICE, SEV=0);
      107    13140        %VLP_ERRCODE (FPTN=XUG#NO_MATCH, STCLASS=CONSTANT,
      108    13141                      FCG=XU, MID=G, ERR#=%E$XUG#NO_MATCH, SEV=0);
      109    13186        %VLP_ERRCODE (FPTN=XUG#FOLLOWED_BY, STCLASS=CONSTANT,
      110    13187                      FCG=XU, MID=G, ERR#=%E$XUG#FOLLOWED_BY, SEV=0);
      111    13232        %VLP_ERRCODE (FPTN=XUG#NULLROOT, STCLASS=CONSTANT,
      112    13233                      FCG=XU, MID=G, ERR#=%E$NULLROOT, SEV=0);
      113    13278        %VLP_ERRCODE (FPTN=XUG#PRE_C00, STCLASS=CONSTANT,
      114    13279                      FCG=XU, MID=G, ERR#=%E$PCB_PRE_C00, SEV=0);
      115    13324        %VLP_ERRCODE (FPTN=XUG#LINETOOLONG, STCLASS=CONSTANT,
      116    13325                      FCG=XU, MID=G, ERR#=%E$XUG#LINETOOLONG, SEV=0);
      117    13370        %VLP_ERRCODE (FPTN=TEMP_ERR, STCLASS=AUTO) ;
      118    13415    1   DCL XUG_NODES UBIN WORD SYMREF ;
      119    13416    1   DCL XUG_BUILTIN_N UBIN WORD SYMREF ;
      120    13417    1   DCL XUP$DMPCORRECTED ENTRY (1) OPTIONAL;
      121    13418    1   DCL XUS$CORRECT_SPELLING ENTRY (5) ALTRET;
      122    13419    1   DCL X66_REL_AUTO ENTRY;
      123    13420        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:5    
      124    13421        %XUG_PARAMS ;
      125    13865        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
      126    14203        %XUG_INIT (NAME=XUG_INIT, STCLASS=PARAM) ;
      127    14616        %XUG_INIT (NAME = XUG_INIT_C,STCLASS="CONSTANT SYMDEF",ADAPT=NIL);
      128    15029        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
      129    15442        %XUG_RLT (NAME=RLT) ;
      130    15449        %XUH_PARAM (NAME=XUH_PARAM_C, STCLASS=CONSTANT) ;
      131    15510        %XT_PARAM (NAME=XT_PARAM, STCLASS="BASED(XT$)");
      132    15823        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:6    
      133    15824    1   DCL XUG$ PTR ;
      134    15825    1   DCL XT$ PTR;
      135    15826    1   DCL XT_ VECTOR;
      136    15827    1   DCL P_PCB$ PTR ;
      137    15828    1   DCL ROOT$ PTR ;
      138    15829    1   DCL NODES$ PTR ;
      139    15830    1   DCL DUMMY$ PTR ;
      140    15831    1   DCL TEXT$ PTR ;
      141    15832    1   DCL TO$ PTR ;
      142    15833    1   DCL 1 SEG$ PTR ;
      143    15834    1   DCL 1 RSEG REDEF SEG$,
      144    15835    1         2 OFFSET UBIN(24) UNAL,
      145    15836    1         2 SID BIT(12) UNAL ;
      146    15837    1   DCL GDSVEC VECTOR ;
      147    15838    1   DCL XUG_OWNS_MEMORY BIT(1) ;
      148    15839    1   DCL STATIC_SZ SBIN WORD ;
      149    15840    1   DCL WORK_SZ SBIN WORD ;
      150    15841    1   DCL RLT_SZ SBIN ;
      151    15842    1   DCL WOFF SBIN ;
      152    15843    1   DCL WBUFSZ SBIN ;
      153    15844    1   DCL ARS SBIN;
      154    15845    1   DCL PROMPT_FLG BIT(1) ALIGNED;
      155    15846    1   DCL ERRPTR_FLG BIT(1) ;
      156    15847    1   DCL TWOCHARS CHAR(2);
      157    15848    1   DCL I SBIN;
      158    15849    1   DCL J SBIN;
      159    15850    1   DCL EPOS SBIN;
      160    15851    1   DCL TPOS SBIN;
      161    15852    1   DCL CSIZE SBIN;
      162    15853    1   DCL TCSIZE SBIN ;
      163    15854    1   DCL POFF SBIN WORD ;
      164    15855    1   DCL CHUNK_SIZE SBIN;
      165    15856    1   DCL OFFSET SBIN;
      166    15857    1   DCL OUTPUT_COUNT SBIN;
      167    15858    1   DCL OUTPUT_WIDTH SBIN;
      168    15859    1   DCL PROMPT_BUF CHAR(94) ;
      169    15860    1   DCL FIRST SBIN ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:7    
      170    15861    1   DCL LAST SBIN ;
      171    15862    1   DCL SAVE_PROMPT_ VECTOR;
      172    15863    1   DCL SAVE_RPROMPT_ VECTOR;
      173    15864    1   DCL SAVE_PROMPT_VFC BIT(1);
      174    15865    1   DCL SAVE_ERR BIT(36) ;
      175    15866    1   DCL SAVE_DCB UBIN WORD ;
      176    15867    1   DCL SAVE_F1 VECTOR;
      177    15868    1   DCL SAVE_F2 VECTOR;
      178    15869    1   DCL 1 FIELD1 ALIGNED,
      179    15870    1         2 CNT UBIN BYTE CALIGNED,
      180    15871    1         2 TXT CHAR(20) CALIGNED ;
      181    15872    1   DCL 1 FIELD2 ALIGNED,
      182    15873    1         2 CNT UBIN BYTE CALIGNED,
      183    15874    1         2 TXT CHAR(20) CALIGNED ;
      184    15875        /*
      185    15876        */
      186    15877    1   DCL CHARBASE CHAR(CSIZE) BASED;
      187    15878    1   DCL CHARARRAY(0:0) CHAR(1) BASED;
      188    15879    1   DCL UBIN$BUF9 UBIN(9) UNAL BASED ;
      189    15880    1   DCL P$ PTR BASED;
      190    15881    1   DCL INBUF CHAR(1024) BASED;
      191    15882    1   DCL 1 VEC$BUF BASED (SEG$) CHAR(CNT) ;
      192    15883    1   DCL OFF$ PTR ;
      193    15884    1   DCL DIFF SBIN ;
      194    15885    1   DCL CNT SBIN WORD ;
      195    15886    1   DCL OUTDCB# UBIN WORD ;
      196    15887    1   DCL B$JIT$ PTR SYMREF READONLY;
      197    15888    1   DCL B$TCB$ PTR SYMREF READONLY;
      198    15889        %B$TCB (STCLASS="BASED(B$TCB$)") ;
      199    15892        %B$ALT;
      200    15900        %EQU XUG_DFLT_WKSZ = 200 ;
      201    15901        %EQU EXPND_PARSEWK = 800 ;
      202    15902
      203    15903        /* Generate CONV(5) entries to force :LIB loading of parse
      204    15904           nodes and the like when necessary.  Bury these DCLs inside a
      205    15905           dummy PROC so that they don't conflict with SYMREFs referencing
      206    15906           the same names.
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:8    
      207    15907        */
      208    15908
      209    15909    1   GENERATE_CONV_5_ENTREFS: PROC;
      210    15910
      211    15911    2   DCL XU_OUTPUT_OPTIONS ENTRY CONV (5);
      212    15912    2   DCL XUG_BUILTIN_N ENTRY CONV (5);
      213    15913
      214    15914    2   END GENERATE_CONV_5_ENTREFS;
      215    15915
      216    15916        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:9    
      217    15917    1   XUG$INIT_COMMON: ENTRY (GETCMD, XUG_INIT) ALTRET;
      218    15918
      219    15919    1       IF GETCMD.WORK$ = ADDR (NIL)
      220    15920    2       THEN DO;
      221    15921    2           IF VBASE(XUG_INIT.WORK_) ~= ADDR(NIL)
      222    15922    3           THEN DO;
      223    15923    3               IF VBOUND(XUG_INIT.WORK_) < (500 * 4 - 1)
      224    15924    3               THEN
      225    15925    4               DO ;
      226    15926    4                   GETCMD.ERR# = XUG#SMALLWORK ;
      227    15927    4                   ALTRETURN ;
      228    15928    4               END ; /* Then Do */
      229    15929    3               OFF$ = PALIGNW(VBASE(XUG_INIT.WORK_)) ;
      230    15930    3               DIFF = POFFC(OFF$, VBASE(XUG_INIT.WORK_)) ;
      231    15931    3               IF DIFF ~= 0
      232    15932    3               THEN
      233    15933    4               DO ;
      234    15934    4                   GETCMD.ERR# = XUG#NWALIGNED ;
      235    15935    4                   ALTRETURN ;
      236    15936    4               END ; /* Then Do */
      237    15937    3               GDSVEC = XUG_INIT.WORK_;
      238    15938    3               XUG_OWNS_MEMORY = %NO#;
      239    15939    3           END;
      240    15940    3           ELSE DO;
      241    15941    3               FPT_GDS = FPT_GDS_C ;
      242    15942    3               FPT_GDS.V_ = VECTOR(FPT_GDS.V) ;
      243    15943    3               FPT_GDS.RESULTS_ = VECTOR(GDSVEC) ;
      244    15944    3               GDSVEC = VECTOR(NIL) ;
      245    15945    3               RSEG = '0'B ;
      246    15946    4               DO CASE (XUG_INIT.WSEG#) ;
      247    15947
      248    15948    4               CASE(0) ;               /* Next available */
      249    15949    4                   RSEG.SID = %NULLSID ;
      250    15950
      251    15951    4               CASE(3) ;
      252    15952    4                   RSEG.SID = %DS3SID ;
      253    15953
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:10   
      254    15954    4               CASE(4) ;
      255    15955    4                   RSEG.SID = %DS4SID ;
      256    15956
      257    15957    4               CASE(5) ;
      258    15958    4                   RSEG.SID = %DS5SID ;
      259    15959
      260    15960    4               CASE(6) ;
      261    15961    4                   RSEG.SID = %DS6SID ;
      262    15962
      263    15963    4               CASE(7) ;
      264    15964    4                   RSEG.SID = %DS7SID ;
      265    15965
      266    15966    4               CASE(8) ;
      267    15967    4                   RSEG.SID = %DS8SID ;
      268    15968
      269    15969    4               CASE(ELSE) ;
      270    15970    4                   RSEG.SID = %NULLSID ;
      271    15971
      272    15972    4               END ;                   /* Do Case */
      273    15973    3               VBASE(GDSVEC) = SEG$ ;
      274    15974    3               CALL M$GDS (FPT_GDS)
      275    15975    4               WHENALTRETURN DO;
      276    15976    4                   TEMP_ERR = B$TCB.ALT$ -> B$ALT.ERR;
      277    15977    4                   TEMP_ERR.SEV = 4;
      278    15978    4                   FPT_MERC = FPT_MERC_C;
      279    15979    4                   FPT_MERC.JERR_ = VECTOR (TEMP_ERR);
      280    15980    4                   CALL M$MERC (FPT_MERC) ALTRET (MERC_PROBLEM);
      281    15981    4   MERC_PROBLEM:   CALL M$ERR;
      282    15982    4               END;
      283    15983    3               XUG_OWNS_MEMORY = %YES#;
      284    15984    3           END;
      285    15985    2           XUG$ = VBASE(GDSVEC) ;
      286    15986    2           GETCMD.WORK$ = XUG$ ;
      287    15987    2           XUG = '0'B;
      288    15988    2           XUG.GDSVEC = GDSVEC ;
      289    15989    2           XUG.XUG_OWNS_MEMORY = XUG_OWNS_MEMORY ;
      290    15990    2           STATIC_SZ = SIZEC(P_PCB) + SIZEC(XUG) + SIZEC(XT_PARAM);
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:11   
      291    15991    2           IF MOD(STATIC_SZ, 8) ~= 0
      292    15992    2           THEN STATIC_SZ = STATIC_SZ + (8 - MOD(STATIC_SZ, 8)) ;
      293    15993    2           RLT_SZ = (XUG_INIT.INIT_NRECS# * SIZEC(RLT(0))) ;
      294    15994    2           IF MOD(RLT_SZ, 8) ~= 0
      295    15995    2           THEN RLT_SZ = RLT_SZ + (8 - MOD(RLT_SZ, 8)) ;
      296    15996    2   SETUP_WORK:
      297    15997    2           WORK_SZ = VBOUND(GDSVEC) - STATIC_SZ - RLT_SZ ;
      298    15998    2           IF WORK_SZ <= XUG_INIT.CMDSZ# + %XUG_DFLT_WKSZ
      299    15999    2           THEN
      300    16000    2               IF XUG_OWNS_MEMORY
      301    16001    3               THEN DO ;
      302    16002    3                   CALL M$GDS (FPT_GDS) ALTRET (MALT) ;
      303    16003    3                   GOTO SETUP_WORK ;
      304    16004    3               END ;                  /* Then Do */
      305    16005    3               ELSE DO ;
      306    16006    3                   GETCMD.ERR# = XUG#SMALLWORK ;
      307    16007    3                   ALTRETURN ;
      308    16008    3               END ;                  /* Else Do */
      309    16009        /*E*  ERROR:    XUG-E$XUG#SMALLWORK
      310    16010              MESSAGE0: Work area too small for XUG$INIT to initialize.  Unable
      311    16011                        to continue.
      312    16012        */
      313    16013        /*E*  ERROR:    XUG-E$XUG#NWALIGNED
      314    16014              MESSAGE0: Work area is not WORD ALIGNED and XUG$INIT can not continue.
      315    16015                        Initialization aborted.
      316    16016        */
      317    16017    2           SEG$ = PINCRC(XUG$, STATIC_SZ) ;
      318    16018    2           CNT = WORK_SZ / 2 ;
      319    16019    2           XUG.PARSEVEC = VECTOR(VEC$BUF) ;
      320    16020    2           SEG$ = PINCRC(SEG$, CNT) ;
      321    16021    2           OFF$ = PALIGNW(SEG$) ;
      322    16022    2           DIFF = POFFC(OFF$, SEG$) ;
      323    16023    2           XUG.RLTVEC = VECTOR(OFF$ -> RLT(0)) ;
      324    16024    2           VBOUND(XUG.RLTVEC) = RLT_SZ - 1 ;
      325    16025    2           CNT = CNT - DIFF ;
      326    16026    2           WORK_SZ = CNT ;
      327    16027    2           XUG.RLTCNT = XUG_INIT.INIT_NRECS# ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:12   
      328    16028    2           XUG.NLINES = 0 ;
      329    16029    2           CNT = WORK_SZ - 4 ;
      330    16030    2           SEG$ = PINCRC(VBASE(XUG.RLTVEC), RLT_SZ + 4) ;
      331    16031    2           OFF$ = PALIGNW(SEG$) ;
      332    16032    2           DIFF = POFFC(OFF$, SEG$) ;
      333    16033    2           CNT = CNT - DIFF ;
      334    16034    2           CNT = CNT - MOD(CNT, 8) ;
      335    16035    2           XUG.BUFVEC = VECTOR (VEC$BUF) ;
      336    16036    2       END;
      337    16037    1       XUG$ = GETCMD.WORK$ ;
      338    16038    1       VBASE(XUG.RLTVEC) -> RLT = '0'B ;
      339    16039    1       XUG.POFF = 1;
      340    16040    1       XUG.PROMPT_VFC = %NO#;
      341    16041    1       XUG.PROMPT = '*';
      342    16042    1       XUG.REQ_PROMPT = XUG_INIT.REQ_PROMPT# ;
      343    16043    1       XUG.SYNTAX = XUG_INIT.SYNTAX#;
      344    16044    1       XUG.PREPROCESS = XUG_INIT.PREPROCESS#;
      345    16045    1       XUG.ABORT = XUG_INIT.ABORT$;
      346    16046    1       XUG.CONTINUE = XUG_INIT.CONTINUE$;
      347    16047    1       XUG.BRKMSG = XUG_INIT.BRKMSG$;
      348    16048    1       XUG.PREPROCESSOR$$ = XUG_INIT.PREPROCESSOR$$;
      349    16049    1       XUG.SPHANDLE = XUG_INIT.SPHANDLE$ ;
      350    16050    1       XUG.PRE_EXEC = XUG_INIT.PRE_EXEC$$ ;
      351    16051    1       XUG.POST_EXEC = XUG_INIT.POST_EXEC$$ ;
      352    16052    1       XUG.MOREMEM = XUG_INIT.MOREMEM$$ ;
      353    16053    1       XUG.XUH_PARAM = XUH_PARAM_C ;
      354    16054    1       XUG.XUH_PARAM.PROCACCT_ = XUG_INIT.PROCACCT_ ;
      355    16055    1       XUG.XUH_PARAM.PROCNAME_ = XUG_INIT.PROCNAME_ ;
      356    16056    1       XUG.ERRDCB = DCBNUM(NIL);
      357    16057    1       XUG.PPCB$ = XUG_INIT.PPCB$;
      358    16058    1       XUG.PP_PROCNAME_ = XUG_INIT.PP_PROCNAME_ ;
      359    16059    1       XUG.PP_DCB = XUG_INIT.PP_DCB#;
      360    16060    1       XUG.ADDL_RLTCNT = XUG_INIT.ADDL_NRECS# ;
      361    16061    1       XUG.CMDSZ = XUG_INIT.CMDSZ# ;
      362    16062    1       XUG.COMMANDS = XUG_INIT.COMMANDS# ;
      363    16063    1       XUG.INHIBITS = XUG_INIT.INHIBITS;
      364    16064    1       XUG.NO_DOWNGRADE = XUG_INIT.NO_DOWNGRADE#;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:13   
      365    16065    1       XUG.DONT_REREAD_CCBUF = XUG_INIT.DONT_REREAD_CCBUF#;
      366    16066    1       XUG.DONT_STRIP_PROMPT = XUG_INIT.DONT_STRIP_PROMPT#;
      367    16067    1       XUG.GOODCMD = XUG_INIT.GOODCMD# ;
      368    16068    1       IF ENTADDR(XUS$CORRECT_SPELLING) ~= ENTADDR(NIL)
      369    16069    1       THEN
      370    16070    1           XUG.SPELLING = XUG_INIT.SPELLING#;
      371    16071    1       IF XUG_INIT.PCB$ = ADDR(NIL)
      372    16072    2       THEN DO;
      373    16073    2           P_PCB$ = PINCRW(XUG$, SIZEW(XUG));
      374    16074    2           P_PCB = P_PCB_C;
      375    16075    2           XUG.P_PCB$ = P_PCB$ ;
      376    16076    2       END;
      377    16077    1       ELSE
      378    16078    1           XUG.P_PCB$ = XUG_INIT.PCB$;
      379    16079    1       XUG.ADAPT$$ = XUG_INIT.ADAPT$$;
      380    16080    1       SEG$ = GETCMD.XT_PARAM$;
      381    16081    1       IF RSEG = '0'B
      382    16082    1       THEN
      383    16083    1           GETCMD.XT_PARAM$ = ADDR(NIL);
      384    16084    1       GETCMD.PCB$ = XUG.P_PCB$;
      385    16085    1       GETCMD.ECHO = XUG_INIT.ECHO#;
      386    16086    1       GETCMD.PASS = XUG_INIT.PASS#;
      387    16087    1       GETCMD.ALWAYS_SET_PROMPT# = XUG_INIT.ALWAYS_SET_PROMPT#;
      388    16088    1       GETCMD.PP_ROOT$ = XUG_INIT.PP_ROOT$;
      389    16089    1       XUG_INIT.PARAMS$ = XUG$;
      390    16090    1       XUG.FILENAME.C = 0 ;
      391    16091    1       XUG.FILENAME.TX = ' ' ;
      392    16092    1       XUG.FILEACCT = ' ' ;
      393    16093    1       XUG.FILEPASS = ' ' ;
      394    16094    1       XUG.F1SAVE = VECTOR(NIL);
      395    16095    1       XUG.F2SAVE = VECTOR(NIL);
      396    16096    1       XUG.F3SAVE = VECTOR(NIL);
      397    16097    1       RETURN;
      398    16098        /**/
      399    16099        %EJECT ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:14   
      400    16100    1   XUG$MOREMEM: ENTRY(GETCMD) ALTRET;
      401    16101    1       XUG$ = GETCMD.WORK$ ;
      402    16102    1       IF XUG.XUG_OWNS_MEMORY
      403    16103    2       THEN DO ;
      404    16104    2           FPT_GDS = FPT_GDS_C ;
      405    16105    2           FPT_GDS.V_ = VECTOR(FPT_GDS.V) ;
      406    16106    2           FPT_GDS.RESULTS_ = VECTOR(XUG.GDSVEC) ;
      407    16107    2           CALL M$GDS (FPT_GDS) ALTRET (CANT_EXPAND_SEGMENT);
      408    16108    2       END ;                        /* Then Do */
      409    16109    1       ELSE
      410    16110    1           IF XUG.MOREMEM = ENTADDR(NIL)
      411    16111    2           THEN DO;
      412    16112    2               GETCMD.ERR# = XUG#CANTEXPAND;
      413    16113        /*E*  ERROR:   XUG-E$XUG#CANTEXPAND
      414    16114              MESSAGE: Can't expand the GETCMD work area.
      415    16115              MESSAGE1: GETCMD cannot expand its work area;  the work area was provided
      416    16116                       by the program that calls GETCMD, and the program did not
      417    16117                       supply a routine that can expand the work area.
      418    16118        */
      419    16119    2               GOTO CANT_EXPAND_SEGMENT;
      420    16120    2           END;
      421    16121    2           ELSE DO;
      422    16122    2               CALL XUG.MOREMEM(%GDSSIZ,USER_GDSVEC,TEMP_ERR) WHENALTRETURN
      423    16123    3               DO ;
      424    16124    3                   GETCMD.ERR# = TEMP_ERR ;
      425    16125    3                   GOTO CANT_EXPAND_SEGMENT ;
      426    16126    3               END ;                  /* Whenaltreturn */
      427    16127    2               DUMMY$ = PINCRC(VBASE(XUG.GDSVEC), VBOUND(XUG.GDSVEC)+1) ;
      428    16128    2               IF DUMMY$ ~= VBASE(USER_GDSVEC)
      429    16129    2               THEN
      430    16130    3               DO ;
      431    16131    3                   GETCMD.ERR# = XUG#NOTCONTIGAREA ;
      432    16132    3                   GETCMD.PCB$->P_PCB.HI_CHAR = 0 ;
      433    16133    3                   GOTO CANT_EXPAND_SEGMENT ;
      434    16134    3               END ;                  /* Then Do */
      435    16135        /*E*   ERROR:   XUG-E$XUG#NOTCONTIGAREA
      436    16136               MESSAGE: Not a contiguous work area.
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:15   
      437    16137               MESSAGE1: The data expansion received from the user program is
      438    16138                          not contiguous with the present work area.
      439    16139        */
      440    16140    2               IF VBOUND(USER_GDSVEC)+1 ~= %GDSSIZ*4
      441    16141    2               THEN
      442    16142    3               DO ;
      443    16143    3                   GETCMD.ERR# = XUG#AREANOTRTSZ ;
      444    16144    3                   GOTO CANT_EXPAND_SEGMENT ;
      445    16145    3               END ;                  /* Then Do */
      446    16146        /*E*   ERROR:   XUG-E$XUG#AREANOTRTSZ
      447    16147               MESSAGE: Data area not the right size.
      448    16148               MESSAGE1: The data expansion received from the user program is
      449    16149                          not the amount that XUG$GETCMD requested.
      450    16150        */
      451    16151    2               VBOUND(XUG.GDSVEC) = VBOUND(XUG.GDSVEC) + %GDSSIZ*4 ;
      452    16152    2           END ;                     /* Then Do */
      453    16153        /*
      454    16154           If memory has been allocated for ADAPT at the top of the segment, move
      455    16155           its data up to the new top of the segment.
      456    16156        */
      457    16157    1       XT$ = GETCMD.XT_PARAM$;
      458    16158    1       IF XT$ ~= ADDR(NIL)
      459    16159    1         AND XT_PARAM.WS$ ~= ADDR(NIL)
      460    16160    2       THEN DO;
      461    16161    2           XT_ = XUG.BUFVEC;
      462    16162    2           VBASE(XT_) = XT_PARAM.WS$;
      463    16163    2           VBOUND(XT_) = XT_PARAM.WS_SIZE * 4 - 1;
      464    16164    2           CALL MOVER (XT_, %GDSSIZ, 0);
      465    16165    2           XT_PARAM.WS$ = VBASE(XT_);
      466    16166    2       END;
      467    16167        /*
      468    16168           Expand the RLT.
      469    16169        */
      470    16170    1       RLT_SZ = (XUG.ADDL_RLTCNT * SIZEC(RLT(0))) ;
      471    16171    1       IF MOD(RLT_SZ,8) ~= 0
      472    16172    1       THEN RLT_SZ = RLT_SZ + (8 - MOD(RLT_SZ, 8)) ;
      473    16173        /*
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:16   
      474    16174           Move the input buffer upwards, and adjust the read vector also.
      475    16175        */
      476    16176    1       WOFF = RLT_SZ / 4 + %EXPND_PARSEWK/4 ;
      477    16177    1       WBUFSZ = %GDSSIZ - WOFF ;
      478    16178    1       CALL MOVER (XUG.BUFVEC, WOFF, WBUFSZ) ;
      479    16179    1       VBASE(XUG.READVEC) = PINCRW(VBASE(XUG.READVEC),WOFF) ;
      480    16180    1       VBOUND(XUG.READVEC) = VBOUND(XUG.READVEC) + (WBUFSZ * 4) ;
      481    16181    1       VBASE(XUG.LAST) = PINCRW(VBASE(XUG.LAST), WOFF) ;
      482    16182        /*
      483    16183           Move the RLT upwards.  Expand the parse area to fill the new area at
      484    16184           the base of the non-static portion of the segment (no need to move data).
      485    16185        */
      486    16186    1       WOFF = %EXPND_PARSEWK/4 ;
      487    16187    1       WBUFSZ = RLT_SZ / 4 ;
      488    16188    1       CALL MOVER(XUG.RLTVEC, WOFF, WBUFSZ) ;
      489    16189    1       XUG.RLTCNT = XUG.RLTCNT + XUG.ADDL_RLTCNT ;
      490    16190    1       VBOUND(XUG.PARSEVEC) = VBOUND(XUG.PARSEVEC) + %EXPND_PARSEWK ;
      491    16191
      492    16192    1       RETURN ;
      493    16193
      494    16194    1   CANT_EXPAND_SEGMENT:
      495    16195
      496    16196    1       ALTRETURN;
      497    16197
      498    16198        %EJECT ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:17   
      499    16199    1   XUG$GETCMD_COMMON: ENTRY (GETCMD) ALTRET;
      500    16200    1       IF GETCMD.WORK$ = ADDR(NIL)
      501    16201    2       THEN DO;
      502    16202    2           XUG_INIT_A = XUG_INIT_C ;
      503    16203    2           CALL XUG$INIT_COMMON(GETCMD, XUG_INIT_A)
      504    16204    3           WHENALTRETURN DO;
      505    16205    3               ALTRETURN;
      506    16206    3           END;
      507    16207    2       END ; /* Then Do */
      508    16208    1       XUG$ = GETCMD.WORK$ ;
      509    16209    1       P_PCB$ = XUG.P_PCB$ ;
      510    16210    1       IF GETCMD.NODES$ ~= ADDR(NIL)
      511    16211    1       THEN
      512    16212    1           IF GETCMD.NODES$ -> P$NODE.TYPE = 0
      513    16213    2           THEN DO;
      514    16214    2               GETCMD.ERR# = XUG#PRE_C00;
      515    16215        /*E*     ERROR:   XUG-E$PCB_PRE_C00
      516    16216                 MESSAGE: Parse control block is pre-C00;  cannot parse.
      517    16217                 MESSAGE1: The parse nodes passed to XUG$GETCMD or XUR$GETCMD appear
      518    16218                          to be of pre-C00 vintage.  The format of X$PARSE nodes
      519    16219                          (produced by PARTRGE) was changed substantially for the
      520    16220                          C00 version of CP-6, and pre-C00 nodes/PCBs/PARSE$BLKs
      521    16221                          (etc.) are not compatible with this parser.  Your program
      522    16222                          must be updated if you wish to run it on a D00 (or later)
      523    16223                          version of CP-6.  This will require:
      524    16224
      525    16225                          1) Recompiling all PL-6 routines that use any of the parser's
      526    16226                             data structures;
      527    16227
      528    16228                          2) Re-PARTRGEing all of the program's parse nodes;  and
      529    16229
      530    16230                          3) Re-LINKing the run unit.
      531    16231
      532    16232                          Please see the "CP-6 C00 System Release Bulletin", or the
      533    16233                          Host Library Services manual (CE71) for the necessary
      534    16234                          information and procedures.
      535    16235        */
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:18   
      536    16236    2               ALTRETURN;
      537    16237    2           END;
      538    16238    1       XUG.USER$ = P_PCB.USER$ ;
      539    16239    1       P_PCB.USER$ = ADDR(GETCMD) ;
      540    16240    1       SAVE_PROMPT_ = GETCMD.PROMPT_;
      541    16241    1       SAVE_RPROMPT_ = GETCMD.RPROMPT_;
      542    16242    1       SAVE_PROMPT_VFC = GETCMD.PROMPT_VFC#;
      543    16243    1       REMEMBER PARSEALT IN XUG.REM_PARSE;
      544    16244
      545    16245    1   GETCMD:
      546    16246    1       GETCMD.PROMPT_ = SAVE_PROMPT_;
      547    16247    1       GETCMD.RPROMPT_ = SAVE_RPROMPT_;
      548    16248    1       GETCMD.PROMPT_VFC# = SAVE_PROMPT_VFC;
      549    16249    1       XUG.NLINES=0;
      550    16250    2       IF GETCMD.INDCB#=DCBNUM(NIL) THEN DO;
      551    16251    2           CALL XUG$GETDCB_COMMON(M$SI,GETCMD.INDCB#) ALTRET(MALT);
      552    16252    2       END;
      553    16253    2       IF GETCMD.OUTDCB#=DCBNUM(NIL) THEN DO;
      554    16254    2           CALL XUG$GETDCB_COMMON(M$LO,GETCMD.OUTDCB#) ALTRET(MALT);
      555    16255    2       END;
      556    16256    1       GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;
      557    16257    1       P_PCB.OUTDCB# = GETCMD.OUTDCB# ;
      558    16258    1       XUG.DCBS = '0'B;
      559    16259    1       XUG.DCBS.NUM(0)=GETCMD.INDCB#;
      560    16260    1       XUG.DCBS.NUM(1)=GETCMD.OUTDCB#;
      561    16261    1       XUG.DCBS.ERRPTR_CPOS(0) = -1 ;
      562    16262    1       XUG.NDCBS=0;
      563    16263    1       CALL XUG$SETPROMPT (GETCMD) ALTRET(MALT) ;
      564    16264    1       IF GETCMD.SFROUTINE$=ENTADDR(NIL) THEN XUG.SFROUTINE=ENTADDR(NIL);
      565    16265    1       ELSE XUG.SFROUTINE=GETCMD.SFROUTINE$ ;
      566    16266    1       XUG.READVEC=XUG.BUFVEC;
      567    16267    1       XUG.CPOS=0;
      568    16268    1       XUG.CCBUF_OFFC = 0 ;
      569    16269    1       XUG.PP_ERR = '0'B;
      570    16270    1       XUG.FIRST_ERROR = %NO#;
      571    16271    1       GETCMD.EOMCHAR# = %EOM_EOR#;
      572    16272    1       GETCMD.CONTINUED# = %NO# ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:19   
      573    16273    1       GETCMD.RCVD_PROMPT# = %NO# ;
      574    16274    1       GETCMD.ERR# = '0'B ;
      575    16275    1       IF XUG.SYNERR
      576    16276    1       THEN
      577    16277    1           TWOCHARS=SUBSTR(VBASE(XUG.BUFVEC)->INBUF,0,2);
      578    16278    1       IF GETCMD.TEXT_=VECTOR(NIL) THEN
      579    16279    2           IF XUG.GOTCMD THEN DO;
      580    16280    2               XUG.GOTCMD='0'B;
      581    16281    2               ARS = XUG.BRKARS;
      582    16282    2               GETCMD.EOMCHAR# = XUG.GOTCMD_EOMCHAR;
      583    16283    2               XUG.BRKARS = 0;
      584    16284    2               IF (NOT GETCMD.SKIP_PREPROCESS#) AND XUG.PREPROCESS
      585    16285    3               THEN DO;
      586    16286    3                   IF XUG.PREPROCESSOR$$ ~= ENTADDR(NIL)
      587    16287    4                   THEN DO;
      588    16288    4                       CALL XUG$PRE_PROCESSOR (GETCMD,ARS);
      589    16289    4                       CALL X66_REL_AUTO;
      590    16290    4                   END;
      591    16291    3                   ELSE
      592    16292    3                       CALL XUG$PP_CMDVARS (GETCMD,ARS);
      593    16293    3               END;
      594    16294    2               ELSE
      595    16295    2                   GETCMD.SKIP_PREPROCESS# = '0'B ;
      596    16296    2               VBOUND(XUG.READVEC) = ARS - 1;
      597    16297    2               CALL XUG$SETLAST(GETCMD);
      598    16298    2               GETCMD.TREAD# = %YES# ;
      599    16299    2               IF NOT (DCBADDR(GETCMD.OUTDCB#)-> F$DCB.DDEV.UCOUT# OR
      600    16300    2                 DCBADDR(DCBNUM(M$UC)) -> F$DCB.DVBYTE.TRANS#)
      601    16301    2               THEN
      602    16302    2                   CALL XUG$ECHOLAST_COMMON (GETCMD);
      603    16303    2               XUG.DCBS.NUM(0)=DCBNUM(M$UC);
      604    16304    2           END;
      605    16305    2           ELSE DO;
      606    16306    2               CALL XUG$DISABLE_COMMON(GETCMD);
      607    16307    2               CALL XUG$READCMD_COMMON(GETCMD,XUG.READVEC,ARS) ALTRET(RDALT1);
      608    16308    3               DO WHILE XUG.SYNERR;
      609    16309    4                   IF ARS=1 AND SUBSTR(VBASE(XUG.BUFVEC)->INBUF,0,1)='?' THEN DO;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:20   
      610    16310    4   SHOW_ALTRN:
      611    16311    4                       IF XUG.PRE_EXEC ~= ENTADDR(NIL)
      612    16312    4                       THEN
      613    16313    4                           CALL XUG.PRE_EXEC (GETCMD, %XUG_CMD_Q1);
      614    16314    4                       CALL INSERT(VBASE(XUG.BUFVEC)->INBUF,0,2,TWOCHARS);
      615    16315    4                       IF XUG.DOCMD_SYNERR
      616    16316    4                       THEN
      617    16317    4                           GOTO NORMAL_PARSE ;
      618    16318    4                       IF XUG.NEED_ECHO AND GETCMD.TEXT_ = VECTOR(NIL)
      619    16319    5                       THEN DO;
      620    16320    5                           XUG.NLINES = 1 ;
      621    16321    5                           VBASE(XUG.RLTVEC)->RLT(1) = 1 ;
      622    16322    5                           SUBSTR(VBASE(XUG.BUFVEC)->INBUF,0,1) = '?' ;
      623    16323    5                           CALL XUG$ECHO_COMMON(GETCMD) ;
      624    16324    5                           SUBSTR(VBASE(XUG.BUFVEC)->INBUF,0,1) = SUBSTR(TWOCHARS,0,1)
             16324                                    ;
      625    16325    5                       END;
      626    16326    4   ALT_OUT:            P_PCB.NXT = '1'B;
      627    16327    4                       IF GETCMD.SYNERR_NODES$ ~= ADDR(NIL)
      628    16328    4                       THEN
      629    16329    4                           P_PCB.ROOT$ = GETCMD.SYNERR_NODES$;
      630    16330    4                       P_PCB.USER$ = ADDR(GETCMD) ;
      631    16331    4                       IF XUG.SPELLING AND NOT XUG.SPELLING_TRIED
      632    16332    4                       THEN
      633    16333    4                           CALL SPELLING_CHECKER (%NO#) ALTRET (READ_ANOTHER);
      634    16334    4                       XUG.SYNERR = %NO#;
      635    16335    4                       GETCMD.ERR_CODE = XUG#LEGAL_INPUT_HERE;
      636    16336    4                       CALL XUG$ERRMSG_COMMON (GETCMD);
      637    16337        /*E*  ERROR:   XUG-E$XUG#LEGAL_INPUT_HERE
      638    16338              MESSAGE0:Legal input at the point of error could be any of the following:
      639    16339        */
      640    16340    4                       CALL REPORT_ALTERNATIVES;
      641    16341    4   READ_ANOTHER:       IF XUG.POST_EXEC ~= ENTADDR(NIL)
      642    16342    4                       THEN
      643    16343    4                           CALL XUG.POST_EXEC (GETCMD, %XUG_CMD_Q1);
      644    16344    4                       P_PCB.USER$ = XUG.USER$ ;
      645    16345    4                       P_PCB.NXT='0'B;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:21   
      646    16346    4                       IF GETCMD.TEXT_ = VECTOR(NIL)
      647    16347    5                       THEN DO;
      648    16348    5                           GETCMD.CONTINUED# = %NO#;
      649    16349    5                           GETCMD.RCVD_PROMPT# = %NO#;
      650    16350    5                           CALL XUG$READCMD_COMMON(GETCMD,XUG.READVEC,ARS)
      651    16351    5                             ALTRET(RDALT1);
      652    16352    5                       END;
      653    16353    5                       ELSE DO;
      654    16354    5                           IF GETCMD.ERR# = '0'B
      655    16355    6                           THEN DO;
      656    16356    6                               GETCMD.OUT$ = ADDR(NIL) ;
      657    16357    6                               GOTO GETCMD_RET ;
      658    16358    6                           END;
      659    16359    5                           GOTO GETCMD_ALT1 ;
      660    16360    5                       END;
      661    16361    4                   END;
      662    16362    3                   ELSE
      663    16363    3                       XUG.SYNERR = %NO#;
      664    16364    3               END;
      665    16365    2               CALL XUG$CLRENABLE_COMMON(GETCMD) ;
      666    16366    2           END;
      667    16367    2       ELSE DO;
      668    16368    2           J = 0;
      669    16369    2           IF VBASE(GETCMD.TEXT_) = ADDR(NIL) /* eg, VECTOR(ERASE) */
      670    16370    3           THEN DO;
      671    16371    3               CSIZE = 0;
      672    16372    3               TEXT$ = ADDR(XUG.BUF);
      673    16373    3           END;
      674    16374    3           ELSE DO;
      675    16375    3               CSIZE=VBOUND(GETCMD.TEXT_)+1 ;
      676    16376    3               IF CSIZE > XUG.CMDSZ
      677    16377    4               THEN DO;
      678    16378    4                   GETCMD.ERR# = XUG#LINETOOLONG;
      679    16379    4                   GOTO GETCMD_ALT;
      680    16380    4               END;
      681    16381        /*E* ERROR: XUG-E$XUG#LINETOOLONG
      682    16382             MESSAGE: Command line is too long.
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:22   
      683    16383        */
      684    16384    3               SEG$ = VBASE( GETCMD.TEXT_ );
      685    16385    3               IF RSEG.SID = %JITSID
      686    16386    3                 AND SEG$ > ADDR( B$JIT.CCBUF )
      687    16387    3                 AND SEG$ < PINCRC( ADDR( B$JIT.CCBUF ), SIZEC( B$JIT.CCBUF ))
      688    16388    4               THEN DO;
      689    16389    4                   XUG.CCBUF_OFFC = POFFC( SEG$ , ADDR( B$JIT.CCBUF ));
      690    16390    4                   XUG.CCBUF_REST = B$JIT.CCARS - XUG.CCBUF_OFFC -
      691    16391    4                     VBOUND( GETCMD.TEXT_ ) - 1 ;
      692    16392    4               END;
      693    16393    3               IF (NOT GETCMD.SKIP_PREPROCESS#) AND XUG.PREPROCESS
      694    16394    4               THEN DO;
      695    16395    4                   XUG.BUF = VBASE(GETCMD.TEXT_)->CHARBASE ;
      696    16396    4                   IF XUG.PREPROCESSOR$$ ~= ENTADDR(NIL)
      697    16397    5                   THEN DO;
      698    16398    5                       CALL XUG$PRE_PROCESSOR (GETCMD, CSIZE) ;
      699    16399    5                       CALL X66_REL_AUTO;
      700    16400    5                   END;
      701    16401    4                   ELSE
      702    16402    4                       CALL XUG$PP_CMDVARS (GETCMD, CSIZE) ;
      703    16403    4                   TEXT$ = ADDR(XUG.BUF);
      704    16404    4               END ;
      705    16405    4               ELSE DO;
      706    16406    4   DONT_PRE_PROC:
      707    16407    4                   GETCMD.SKIP_PREPROCESS# = '0'B ;
      708    16408    4                   TEXT$ = VBASE(GETCMD.TEXT_);
      709    16409    4               END;
      710    16410    3           END ;
      711    16411    2           IF CSIZE>=XUG.POFF AND
      712    16412    2             SUBSTR(TEXT$->CHARBASE,0,XUG.POFF) =
      713    16413    2             SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),XUG.POFF)
      714    16414    2             AND NOT XUG.DONT_STRIP_PROMPT
      715    16415    3           THEN DO ;
      716    16416    3               J = XUG.POFF ;
      717    16417    3               GETCMD.RCVD_PROMPT# = '1'B ;
      718    16418    3           END;
      719    16419    2           VBOUND(XUG.READVEC)=MAXIMUM(CSIZE-J,1)-1;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:23   
      720    16420    2           VBASE(XUG.READVEC)->CHARBASE = SUBSTR(TEXT$->CHARBASE,J);
      721    16421    2           CALL XUG$SETLAST(GETCMD);
      722    16422    2           ARS = CSIZE - J;
      723    16423    2           IF GETCMD.NODES$ = ADDR(NIL)
      724    16424    3           THEN DO;
      725    16425    3               GETCMD.OUT$ = ADDR(NIL);
      726    16426    3               P_PCB.NCHARS = ARS;
      727    16427    3               GOTO GETCMD_RET;
      728    16428    3           END;
      729    16429    2           IF XUG.SYNERR AND ARS=1 AND SUBSTR(VBASE(XUG.READVEC)->INBUF,0,1)='?'
      730    16430    2           THEN
      731    16431    2               GOTO SHOW_ALTRN ;
      732    16432    2           XUG.SYNERR = %NO# ;
      733    16433    2       END;
      734    16434    1       XUG.PREV_CPOS = 0 ;
      735    16435    1       VBASE(XUG.RLTVEC)->RLT(0) = 0 ;
      736    16436    1       XUG.NLINES=1;
      737    16437    1       VBASE(XUG.RLTVEC)->RLT(1)=ARS;
      738    16438    1       IF XUG.PP_ERR
      739    16439    2       THEN DO;
      740    16440    2           GETCMD.ERR# = XUG.PP_ERR;
      741    16441    2           P_PCB.NCHARS = ARS ;
      742    16442    2           IF XUG.GOODCMD
      743    16443    2           THEN
      744    16444    2               GOTO ERRHAND;
      745    16445    2           ELSE
      746    16446    2               GOTO GETCMD_ALT;
      747    16447    2       END;
      748    16448    1   REPARSE:
      749    16449    1       P_PCB.TEXT$=VBASE(XUG.BUFVEC) ;
      750    16450    1       IF GETCMD.NODES$ = ADDR(NIL)
      751    16451    2       THEN DO;
      752    16452    2           GETCMD.OUT$ = ADDR(NIL);
      753    16453    2           GETCMD.ERR# = XUG#NULLROOT;
      754    16454        /*E*  ERROR:   XUG-E$NULLROOT
      755    16455              MESSAGE: Null syntax tree passed to XUG$GETCMD (or a similar routine).
      756    16456        */
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:24   
      757    16457    2           GOTO GETCMD_ALT;
      758    16458    2       END;
      759    16459    1       IF XUG.COMMANDS
      760    16460    2       THEN DO;
      761    16461    2           NODES$ = ADDR(XUG_NODES) ;
      762    16462    2           ROOT$ = ADDR(XUG.ROOT_NODE) ;
      763    16463    2           DUMMY$ = ADDR(XUG.DUMMY_NODE) ;
      764    16464    2           ROOT$->P$NODE = NODES$->P$NODE ;
      765    16465    2           XUG.ROOT_NODE.USER_NODE$ = DUMMY$ ;
      766    16466    2           XUG.ROOT_NODE.GETCMD_NODE$ = NODES$->P$NODE.SUBNDS$(1) ;
      767    16467    2           DUMMY$->P$NODE = NODES$->P$NODE.SUBNDS$(0)->P$NODE ;
      768    16468    2           XUG.DUMMY_NODE.SUBND$ = GETCMD.NODES$ ;
      769    16469    2       END ; /* Then Do */
      770    16470    1       ELSE
      771    16471    1           ROOT$ = GETCMD.NODES$ ;
      772    16472    1       P_PCB.ROOT$=ROOT$ ;
      773    16473    1       P_PCB.WORK$ = VBASE(XUG.PARSEVEC) ;
      774    16474    1       P_PCB.VERSION_CODE = 1;
      775    16475    1       P_PCB.WKSZ = (VBOUND(XUG.PARSEVEC)+1)/4 ;
      776    16476    1       P_PCB.NCHARS = ARS;
      777    16477    1       P_PCB.U$$ = ENTADDR(XUG$PU);
      778    16478    1       P_PCB.DYNMEM = '1'B ;
      779    16479    1       P_PCB.NXT = '0'B;
      780    16480    1       XUG.SPELLING_TRIED = %NO#;
      781    16481    1       XUG.QM_AFTER_SYNERR = '0'B;
      782    16482    1   NORMAL_PARSE:
      783    16483    1       CALL FETCH_HELP_TOPIC;
      784    16484    1       P_PCB.USER$ = ADDR(GETCMD);
      785    16485    1       XUG.PARSING_FREE_CMDS = %NO#;
      786    16486    1       CALL X$PARSE(P_PCB) ALTRET(PARSEALT);
      787    16487    1       IF GETCMD.PASS = %BLANK_PASS# OR (GETCMD.PASS = %MODE_PASS# AND
      788    16488    1         NOT (GETCMD.TREAD# OR DCBADDR(GETCMD.OUTDCB#)
      789    16489    1         ->F$DCB.DDEV.UCOUT#))
      790    16490    1       THEN
      791    16491    1           CALL XUG$BLANK_PASSWORD_COMMON (GETCMD, P_PCB.OUT$->P$B)
      792    16492    1             ALTRET(MALT) ;
      793    16493    1       IF XUG.NEED_ECHO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:25   
      794    16494    2       THEN DO;
      795    16495    2           CALL XUG$ECHO_COMMON(GETCMD) ALTRET(MALT) ;
      796    16496    2           XUG.NEED_ECHO = '0'B ;
      797    16497    2       END ;                        /* Then Do */
      798    16498    1       GETCMD.BUF$ = VBASE(XUG.BUFVEC);
      799    16499    1       GETCMD.RLT$ = VBASE(XUG.RLTVEC);
      800    16500    1       GETCMD.NLINES = XUG.NLINES ;
      801    16501    1       IF XUG.COMMANDS
      802    16502    2       THEN DO;
      803    16503    2           J = P_PCB.OUT$->P$B.CODE ;
      804    16504    2           IF P_PCB.OUT$->P$B.NSUBLKS=0
      805    16505    3           THEN DO;
      806    16506    3               P_PCB.OUT$ -> P$B.CODE = 0;
      807    16507    3               P_PCB.OUT$ -> P$B.TEMP = %YES#;
      808    16508    3               P_PCB.OUT$ -> P$B.NDTYPE = 0;
      809    16509    3           END;
      810    16510    2           ELSE IF P_PCB.OUT$->P$B.NSUBLKS = 1 THEN
      811    16511    2                   P_PCB.OUT$ = P_PCB.OUT$ -> P$B.SUBLK$(0) ;
      812    16512    2           GETCMD.OUT$ = P_PCB.OUT$ ;
      813    16513    2           IF J = %XUG_USER_NODES
      814    16514    2           THEN
      815    16515    2               GOTO GETCMD_RET ;
      816    16516    2       END ; /* Then Do */
      817    16517    2       ELSE DO;
      818    16518    2           GETCMD.OUT$ = P_PCB.OUT$ ;
      819    16519    2   GETCMD_RET:
      820    16520    2           P_PCB.USER$ = XUG.USER$ ;
      821    16521    2           RETURN ;
      822    16522    2       END ; /* Else Do */
      823    16523    1       CALL XUG$BUILTIN_COMMON(GETCMD) ALTRET (ERRHAND);
      824    16524    1       IF GETCMD.TEXT_ ~= VECTOR(NIL)
      825    16525    2       THEN DO;
      826    16526    2           GETCMD.OUT$ = ADDR(NIL);
      827    16527    2           GOTO GETCMD_RET;
      828    16528    2       END;
      829    16529    1       GOTO GETCMD ;
      830    16530
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:26   
      831    16531    1   MALT: GETCMD.ERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      832    16532    1       GETCMD.ERRDCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;
      833    16533    1       P_PCB.USER$ = XUG.USER$ ;
      834    16534    1       ALTRETURN;
      835    16535    1   PARSEALT:;
      836    16536    1       IF XUG.NEED_ECHO
      837    16537    1       THEN
      838    16538    2       DO ;
      839    16539    2           CALL XUG$ECHO_COMMON(GETCMD) ;
      840    16540    2           XUG.NEED_ECHO = '0'B ;
      841    16541    2       END ;                        /* Then Do */
      842    16542    1       GETCMD.BUF$ = VBASE(XUG.BUFVEC);
      843    16543    1       GETCMD.RLT$ = VBASE(XUG.RLTVEC);
      844    16544    1       GETCMD.NLINES = XUG.NLINES ;
      845    16545    1       P_PCB.USER$ = XUG.USER$ ;
      846    16546    1       ARS = P_PCB.NCHARS;
      847    16547    2       IF XUG.SYNTAX THEN DO;
      848    16548    3           IF NOT P_PCB.ERROR.MON AND P_PCB.ERROR.CODE=%E$SYNERR THEN DO;
      849    16549    3               I = P_PCB.HI_CHAR ;
      850    16550    3               J = I;
      851    16551    3               IF I > 0 AND I = ARS
      852    16552    3                 AND SUBSTR (VBASE(XUG.BUFVEC) -> INBUF, I-1, 1) = '?'
      853    16553    4               THEN DO;
      854    16554    4                   I = I - 1;
      855    16555    4                   P_PCB.HI_CHAR = I;
      856    16556    4               END;
      857    16557    3               XUG.SYNERR = %YES# ;
      858    16558    3               XUG.POINTED_TO_SYNERR = %NO# ;
      859    16559    3               GETCMD.SYNERR_NODES$ = P_PCB.ROOT$;
      860    16560    3               IF ARS > 0 AND I < ARS AND
      861    16561    3                 ((XUG.SPELLING AND NOT XUG.SPELLING_TRIED) OR
      862    16562    3                 SUBSTR(VBASE(XUG.BUFVEC) -> INBUF, I, 1) = '?')
      863    16563    4               THEN GIVE_ALTERNATIVES: DO;
      864    16564    4                   P_PCB.USER$ = ADDR(GETCMD) ;
      865    16565    4                   P_PCB.NXT = '1'B;
      866    16566    4                   IF XUG.SPELLING AND NOT XUG.SPELLING_TRIED
      867    16567    4                   THEN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:27   
      868    16568    4                       CALL SPELLING_CHECKER (%YES#)
      869    16569    5                       WHENALTRETURN DO;
      870    16570    5                           P_PCB.HI_CHAR = J;
      871    16571    5                           GOTO RESTORE_USER$;
      872    16572    5                       END;
      873    16573    4                   IF SUBSTR(VBASE(XUG.BUFVEC) -> INBUF, I, 1) ~= '?'
      874    16574    5                   THEN DO;
      875    16575    5                       P_PCB.HI_CHAR = J;
      876    16576    5                       EXIT GIVE_ALTERNATIVES;
      877    16577    5                   END;
      878    16578    4                   XUG.SYNERR = '0'B;
      879    16579    4                   IF B$JIT.PRFLAGS.EXPOUND
      880    16580    5                   THEN DO;
      881    16581    5                       GETCMD.ERR_CODE = XUG#LEGAL_INPUT_QM;
      882    16582    5                       CALL XUG$ERRMSG_COMMON (GETCMD);
      883    16583    5                   END;
      884    16584        /*E*  ERROR:   XUG-E$XUG#LEGAL_INPUT_QM
      885    16585              MESSAGE0:Legal input at this point could be any of the following:
      886    16586        */
      887    16587    4                   CALL REPORT_ALTERNATIVES;
      888    16588    4                   P_PCB.HI_CHAR = J;
      889    16589    4   RESTORE_USER$:  P_PCB.USER$ = XUG.USER$ ;
      890    16590    4                   P_PCB.NXT='0'B;
      891    16591    4                   XUG.QM_AFTER_SYNERR = '1'B;
      892    16592    4                   IF GETCMD.TEXT_ = VECTOR(NIL)
      893    16593    4                   THEN
      894    16594    4                       GOTO GETCMD;   /* Bletch! */
      895    16595    4               END GIVE_ALTERNATIVES;
      896    16596    3               P_PCB.ERROR.MID='07'O;
      897    16597    3           END;
      898    16598        /*E*    ERROR:   XUG-E$SYNERR
      899    16599                MESSAGE: Your command was not processed because it contains something
      900    16600                         unexpected (a mis-spelled word, incorrect punctuation, or some
      901    16601                         other input which does not match this program's requirements).
      902    16602                         You may obtain a brief description of the expected input by
      903    16603                         entering as much of the command as you are sure of, followed
      904    16604                         by a single "?".
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:28   
      905    16605                                                                           */
      906    16606    2       END;
      907    16607    1       GETCMD.ERR#=P_PCB.ERROR;
      908    16608
      909    16609    1       IF XUG.GOODCMD AND NOT P_PCB.ERROR.MON
      910    16610    2       THEN DO;
      911    16611    2   ERRHAND:
      912    16612    2           GETCMD.ERR_CODE = GETCMD.ERR# ;
      913    16613    2           GETCMD.F1_ = VECTOR(NIL) ;
      914    16614    2           GETCMD.F2_ = VECTOR(NIL) ;
      915    16615    2           GETCMD.F3_ = VECTOR(NIL) ;
      916    16616    2           IF B$JIT.PRFLAGS.POINT OR XUG.NLINES > 1
      917    16617    2           THEN
      918    16618    2               CALL XUG$ECHOIF_COMMON(GETCMD) ;
      919    16619    2           CALL XUG$ERRPTR_COMMON(GETCMD) ALTRET(GETCMD_ALT1) ;
      920    16620    2           CALL XUG$ERRMSG_COMMON (GETCMD);
      921    16621    2           IF GETCMD.TEXT_ = VECTOR(NIL)
      922    16622    2           THEN
      923    16623    2               IF B$JIT.MODE = %M_INT# AND B$JIT.NEXTCC = %CC_FROMUC#
      924    16624    2               THEN
      925    16625    2                   GOTO GETCMD ;
      926    16626    2               ELSE ;
      927    16627    2           ELSE
      928    16628    2               IF B$JIT.PRFLAGS.EXPOUND AND GETCMD.TREAD# AND NOT XUG.QM_AFTER_SYNERR
      929    16629    2               THEN
      930    16630    2                   GOTO ALT_OUT;
      931    16631    2       END ;                        /* Then Do */
      932    16632    1       GOTO GETCMD_ALT1 ;
      933    16633    1   GETCMD_ALT:
      934    16634    1       XUG.DIVERT_TO_HELP = %NO# ;
      935    16635    1   GETCMD_ALT1:
      936    16636    1       P_PCB.USER$ = XUG.USER$;
      937    16637    1       ALTRETURN;
      938    16638    1   RDALT1:
      939    16639    1       GETCMD.ERR#=BINBIT(ARS,36);
      940    16640    1       XUG.DIVERT_TO_HELP = %NO# ;
      941    16641    1       P_PCB.USER$ = XUG.USER$ ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:29   
      942    16642    1       CALL XUG$CLRENABLE_COMMON(GETCMD) ;
      943    16643    1       ALTRETURN;
      944    16644        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:30   
      945    16645    1   XUG$GETMORE_COMMON: ENTRY(GETCMD) ALTRET;
      946    16646        /**/
      947    16647    1       XUG$ = GETCMD.WORK$ ;
      948    16648    1       GETCMD.CONTINUED# = %YES# ;
      949    16649    1       P_PCB$ = XUG.P_PCB$ ;
      950    16650    1       VBASE(XUG.READVEC)=PINCRC(VBASE(XUG.BUFVEC),XUG.CPOS+1);
      951    16651    1       VBOUND(XUG.READVEC)=VBOUND(XUG.BUFVEC)-XUG.CPOS-1;
      952    16652    1       VBASE(XUG.RLTVEC)->RLT(XUG.NLINES)=XUG.CPOS - XUG.PREV_CPOS ;
      953    16653    1       IF XUG.PREV_CPOS = 0
      954    16654    1       THEN
      955    16655    1           VBASE(XUG.RLTVEC)->RLT(XUG.NLINES) = VBASE(XUG.RLTVEC)->
      956    16656    1             RLT(XUG.NLINES) + 1 ;
      957    16657    1       XUG.PREV_CPOS = XUG.CPOS ;
      958    16658    1       CALL XUG$READCMD_COMMON(GETCMD,XUG.READVEC,ARS) ALTRET(RDALT2);
      959    16659    1       IF XUG.NLINES >= XUG.RLTCNT
      960    16660    2       THEN CALL XUG$MOREMEM(GETCMD) WHENALTRETURN DO;
      961    16661    2               P_PCB.ERROR = GETCMD.ERR#;
      962    16662    2               UNWIND TO XUG.REM_PARSE;
      963    16663    2           END;
      964    16664    1       XUG.NLINES = XUG.NLINES + 1;
      965    16665    1       VBASE(XUG.RLTVEC)->RLT(XUG.NLINES)=ARS;
      966    16666    1       P_PCB.NCHARS = XUG.CPOS + ARS + 1 ;
      967    16667    1       IF XUG.PP_ERR = '0'B
      968    16668    1       THEN
      969    16669    1           RETURN;
      970    16670    1       P_PCB.ERROR = XUG.PP_ERR;
      971    16671    1       UNWIND TO XUG.REM_PARSE;
      972    16672    1   RDALT2: P_PCB.ERROR=BINBIT(ARS,36);
      973    16673    1       UNWIND TO XUG.REM_PARSE;
      974    16674        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:31   
      975    16675    1   XUG$ERRPTR_COMMON: ENTRY(GETCMD) ALTRET;
      976    16676        /**/
      977    16677    1       XUG$ = GETCMD.WORK$ ;
      978    16678    1       P_PCB$ = XUG.P_PCB$ ;
      979    16679    1       IF GETCMD.DCB_PARAM# = DCBNUM( NIL )
      980    16680    1       THEN
      981    16681    1           GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;
      982    16682    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)
      983    16683    1       THEN
      984    16684    1           OUTDCB# = GETCMD.DCB_PARAM# ;
      985    16685    1       ELSE
      986    16686    1           CALL XUG$GETDCB_COMMON(M$LO,OUTDCB#) ALTRET(MALT) ;
      987    16687    1       GETCMD.DCB_PARAM# = OUTDCB# ;
      988    16688    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, OUTDCB#);
      989    16689    1       FPT_WRITE = FPT_WRITE_C;
      990    16690    1       FPT_WRITE.V_ = VECTOR(FPT_WRITE.V);
      991    16691    1       FPT_WRITE.BUF_ = VECTOR(XUG.BUF);
      992    16692    1       FPT_WRITE.V.DCB# = OUTDCB# ;
      993    16693    1       FPT_WRITE.V.DVBYTE.VFC# = %YES#;
      994    16694    1       IF GETCMD.USE_EPOS#
      995    16695    1       THEN
      996    16696    1           EPOS=GETCMD.EPOS# ;
      997    16697    1       ELSE
      998    16698    1           EPOS = P_PCB.HI_CHAR;
      999    16699    1       EPOS = MINIMUM (P_PCB.NCHARS, EPOS);
     1000    16700    2   SETFLG: DO I = 0 TO XUG.NDCBS;
     1001    16701    2           CALL XUG$CORRES_COMMON (OUTDCB#, BINBIT(XUG.DCBS.NUM(I),36))
     1002    16702    3           WHENALTRETURN DO;
     1003    16703    3               IF XUG.DCBS.ERRPTR_CPOS(I) = EPOS
     1004    16704    3               THEN
     1005    16705    3                   RETURN;
     1006    16706    3               XUG.DCBS.ERRPTR_CPOS(I) = EPOS;
     1007    16707    3               EXIT SETFLG;
     1008    16708    3           END;
     1009    16709    2       END SETFLG;
     1010    16710    1       IF XUG.QM_AFTER_SYNERR
     1011    16711    1       THEN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:32   
     1012    16712    1           GOTO DO_SINPUT;
     1013    16713    1       IF B$JIT.PRFLAGS.POINT
     1014    16714    1       THEN
     1015    16715    2   POINT_TO_ERROR: DO;
     1016    16716    2           IF EPOS >= XUG.CPOS
     1017    16717    2             AND XUG.POFF + EPOS - XUG.CPOS < LENGTHC(XUG.BUFA) - 1
     1018    16718    2             AND (XUG.POFF = 0 OR NOT GETCMD.PROMPT_VFC# OR
     1019    16719    2             SUBSTR(XUG.PROMPT, 0, 1) ~= '@')
     1020    16720    3           THEN DO;
     1021    16721    3               TPOS=XUG.POFF+EPOS+XUG.CCBUF_OFFC-XUG.CPOS+1;
     1022    16722    3               IF GETCMD.RCVD_PROMPT# AND GETCMD.TREAD#
     1023    16723    3               THEN
     1024    16724    3                   TPOS = TPOS + XUG.POFF;
     1025    16725    3           END;
     1026    16726    3           ELSE DO;
     1027    16727    4               IF EPOS>15 THEN DO;
     1028    16728    4                   XUG.BUF=%CONCAT(VFC_TRANSITION0,'...');
     1029    16729    4                   CSIZE=30;
     1030    16730    4                   ADDR(XUG.BUFA(4))->CHARBASE=PINCRC(VBASE(XUG.BUFVEC),EPOS-15)->
             16730                            CHARBASE;
     1031    16731    4                   TPOS=19;
     1032    16732    5                   IF EPOS+15<P_PCB.NCHARS THEN DO;
     1033    16733    5                       CSIZE=3;
     1034    16734    5                       ADDR(XUG.BUFA(34))->CHARBASE='...';
     1035    16735    5                       I=36;
     1036    16736    5                   END;
     1037    16737    5                   ELSE DO;
     1038    16738    5                       I=18+P_PCB.NCHARS-EPOS;
     1039    16739    5                   END;
     1040    16740    4               END;
     1041    16741    4               ELSE DO;
     1042    16742    4                   TPOS=EPOS+1;
     1043    16743    4                   CSIZE=30;
     1044    16744    4                   CALL CONCAT (XUG.BUF, %VFC_TRANSITION0, VBASE(XUG.BUFVEC)->CHARBASE)
             16744                            ;
     1045    16745    5                   IF EPOS+15>P_PCB.NCHARS THEN DO;
     1046    16746    5                       I=P_PCB.NCHARS;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:33   
     1047    16747    5                   END;
     1048    16748    5                   ELSE DO;
     1049    16749    5                       CSIZE=3;
     1050    16750    5                       ADDR(XUG.BUFA(EPOS+16)) -> CHARBASE = '...';
     1051    16751    5                       I=EPOS + 18;
     1052    16752    5                   END;
     1053    16753    4               END;
     1054    16754    3               FPT_WRITE.BUF_.BOUND=I;
     1055    16755    4               CALL M$WRITE(FPT_WRITE) WHENALTRETURN DO ;
     1056    16756    4               END ;
     1057    16757    3           END;
     1058    16758    2           XUG.BUF=%VFC_TRANSITION1;
     1059    16759    2           XUG.BUFA(TPOS)='^';
     1060    16760    2           XUG.CPOS=P_PCB.NCHARS;
     1061    16761    2           FPT_WRITE.BUF_.BOUND = TPOS;
     1062    16762    3           CALL M$WRITE(FPT_WRITE) WHENALTRETURN DO ;
     1063    16763    3           END ;
     1064    16764    2       END ;                        /* Then Do */
     1065    16765    1       IF NOT B$JIT.PRFLAGS.POINT
     1066    16766    1         OR (GETCMD.TREAD# AND XUG.SYNERR AND B$JIT.PRFLAGS.EXPOUND)
     1067    16767    2       THEN DO;
     1068    16768    2           SAVE_ERR = GETCMD.ERR_CODE ;
     1069    16769    2           SAVE_DCB = GETCMD.DCB_PARAM# ;
     1070    16770    2           SAVE_F1 = GETCMD.F1_;
     1071    16771    2           SAVE_F2 = GETCMD.F2_;
     1072    16772    2           XUG.CPOS=P_PCB.NCHARS;
     1073    16773    2           IF EPOS<16 OR XUG.CPOS<20
     1074    16774    3           THEN DO;
     1075    16775    3               CNT = 0 ;
     1076    16776    3               FIRST = 0 ;
     1077    16777    3               LAST = EPOS ;
     1078    16778    3           END ;                     /* Then Do */
     1079    16779    3           ELSE DO;
     1080    16780    3               CNT = 10 ;
     1081    16781    3               FIRST = EPOS-10 ;
     1082    16782    3               CALL SCAN_RECORD (-1, FIRST, LAST) ;
     1083    16783    3           END ;                     /* Else Do */
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:34   
     1084    16784    2           CSIZE = XUG.CPOS ;
     1085    16785    2           FIELD1.TXT = SUBSTR(VBASE(XUG.BUFVEC)->CHARBASE, FIRST,
     1086    16786    2             LAST - FIRST+CNT) ;
     1087    16787    2           FIELD1.CNT = LAST - FIRST + CNT ;
     1088    16788    2           GETCMD.F1_ = VECTOR(FIELD1) ;
     1089    16789    2           IF XUG.CPOS < 20 OR EPOS + 16 > XUG.CPOS
     1090    16790    3           THEN DO;
     1091    16791    3               FIRST = EPOS ;
     1092    16792    3               LAST = XUG.CPOS ;
     1093    16793    3           END ;                     /* Then Do */
     1094    16794    3           ELSE DO;
     1095    16795    3               FIRST = EPOS ;
     1096    16796    3               CALL SCAN_RECORD (1, FIRST+10, LAST) ;
     1097    16797    3           END ;                     /* Else Do */
     1098    16798    2           FIELD2.TXT = SUBSTR(VBASE(XUG.BUFVEC)->CHARBASE, FIRST,
     1099    16799    2             LAST - FIRST) ;
     1100    16800    2           FIELD2.CNT = LAST - FIRST ;
     1101    16801    2           GETCMD.F2_ = VECTOR(FIELD2) ;
     1102    16802    2           GETCMD.DCB_PARAM# = OUTDCB# ;
     1103    16803    2           IF XUG.SYNERR
     1104    16804    2           THEN
     1105    16805    2               IF B$JIT.PRFLAGS.POINT
     1106    16806    2               THEN
     1107    16807    2                   GETCMD.ERR_CODE = XUG#INCOR_PTD_XPND;
     1108    16808    2               ELSE
     1109    16809    2                   IF B$JIT.PRFLAGS.EXPOUND AND GETCMD.TREAD# AND NOT XUG.GOODCMD
     1110    16810    2                   THEN
     1111    16811    2                       GETCMD.ERR_CODE = XUG#INCOR_HERE_XPND;
     1112    16812    2                   ELSE
     1113    16813    2                       GETCMD.ERR_CODE = XUG#INCOR_HERE;
     1114    16814    2           ELSE
     1115    16815    2               GETCMD.ERR_CODE = XUG#PLERRMSG ;
     1116    16816    2           CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(EAT_IT) ;
     1117    16817    2   EAT_IT:
     1118    16818    2           GETCMD.ERR_CODE = SAVE_ERR ;
     1119    16819    2           GETCMD.DCB_PARAM# = SAVE_DCB ;
     1120    16820    2           GETCMD.F1_ = SAVE_F1 ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:35   
     1121    16821    2           GETCMD.F2_ = SAVE_F2 ;
     1122    16822        /*E*  ERROR:    XUG-E$XUG#PLERRMSG
     1123    16823              MESSAGE0: Error at <?>: '%%U1%<?>%%U2%'
     1124    16824        */
     1125    16825        /*E*  ERROR:    XUG-E$XUG#INCOR_HERE
     1126    16826              MESSAGE0: Incorrect input at <?>: '%%U1%<?>%%U2%'.
     1127    16827        */
     1128    16828        /*E*  ERROR:    XUG-E$XUG#INCOR_HERE_XPND
     1129    16829              MESSAGE0: Incorrect input at <?>: '%%U1%<?>%%U2%'.
     1130    16830                        Type a "?" for details.
     1131    16831        */
     1132    16832        /*E*  ERROR:    XUG-E$XUG#INCOR_PTD_XPND
     1133    16833              MESSAGE0: Incorrect input at the "^".  Type a "?" for details.
     1134    16834        */
     1135    16835    2       END ;                        /* Else Do */
     1136    16836    1   DO_SINPUT:
     1137    16837    1       XUG.POINTED_TO_SYNERR = XUG.SYNERR | XUG.QM_AFTER_SYNERR;
     1138    16838    1   XUG$SINPUT: ENTRY (GETCMD) ALTRET;
     1139    16839    1       XUG$ = GETCMD.WORK$ ;
     1140    16840    1       CSIZE = XUG.CPOS ;
     1141    16841    1       IF GETCMD.TREAD# AND NOT GETCMD.CONTINUED# AND CSIZE < 255
     1142    16842    1         AND CSIZE >= MAXIMUM (B$JIT.SINPUTSZ, 3)
     1143    16843    1         AND (B$JIT.PRFLAGS.POSITION OR (XUG.CCBUF_OFFC>0 AND XUG.DONT_REREAD_CCBUF))
     1144    16844    2       THEN DO;
     1145    16845    2           FPT_SINPUT = FPT_SINPUT_C ;
     1146    16846    2           FPT_SINPUT.V_ = VECTOR(FPT_SINPUT.V) ;
     1147    16847    2           FPT_SINPUT.V.DCB# = GETCMD.INDCB# ;
     1148    16848    2           XUG.BUF = ' ' ;
     1149    16849    2           POFF = 0 ;
     1150    16850    2           IF GETCMD.RCVD_PROMPT#
     1151    16851    2           THEN
     1152    16852    2               POFF = XUG.POFF ;
     1153    16853    2           TO$ = ADDR(XUG.BUF) ;
     1154    16854    2           IF B$JIT.PRFLAGS.POSITION
     1155    16855    3           THEN DO;
     1156    16856    3               TCSIZE = 0 ;
     1157    16857    3               IF NOT XUG.DONT_REREAD_CCBUF
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:36   
     1158    16858    3               THEN
     1159    16859    3                   TCSIZE = XUG.CCBUF_OFFC ;
     1160    16860    3               TO$ -> UBIN$BUF9 = EPOS + POFF + TCSIZE + 1 ;
     1161    16861    3           END;
     1162    16862    2           ELSE
     1163    16863    2               TO$ -> UBIN$BUF9 = 0 ;
     1164    16864    2           TO$ = PINCRC(TO$, 1) ;
     1165    16865    2           IF GETCMD.RCVD_PROMPT#
     1166    16866    3           THEN DO;
     1167    16867    3               TCSIZE = CSIZE ;
     1168    16868    3               CSIZE = POFF ;
     1169    16869    3               TO$ -> CHARBASE = SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),POFF) ;
     1170    16870    3               TO$ = PINCRC(TO$, POFF) ;
     1171    16871    3               CSIZE = TCSIZE ;
     1172    16872    3           END;
     1173    16873    2           TCSIZE = 0 ;
     1174    16874    2           IF XUG.CCBUF_OFFC > 0 AND NOT XUG.DONT_REREAD_CCBUF
     1175    16875    3           THEN DO;
     1176    16876    3               SUBSTR( TO$ -> CHARBASE , 0 , XUG.CCBUF_OFFC ) = B$JIT.CCBUF ;
     1177    16877    3               TO$ = PINCRC( TO$ , XUG.CCBUF_OFFC );
     1178    16878    3               TCSIZE = XUG.CCBUF_OFFC ;
     1179    16879    3           END;
     1180    16880    2           TO$ -> CHARBASE = VBASE( XUG.BUFVEC )-> CHARBASE ;
     1181    16881    2           IF XUG.CCBUF_REST > 0 AND NOT XUG.DONT_REREAD_CCBUF
     1182    16882    3           THEN DO;
     1183    16883    3               SUBSTR( PINCRC( TO$ , CSIZE )-> CHARBASE , 0 , XUG.CCBUF_REST ) =
     1184    16884    3                 SUBSTR( B$JIT.CCBUF , B$JIT.CCARS - XUG.CCBUF_REST );
     1185    16885    3               TCSIZE = TCSIZE + XUG.CCBUF_REST ;
     1186    16886    3           END;
     1187    16887    2           FPT_SINPUT.BUF_ = VECTOR(XUG.BUF) ;
     1188    16888    2           FPT_SINPUT.BUF_.BOUND = CSIZE + TCSIZE + POFF ;
     1189    16889    2           CALL M$SINPUT(FPT_SINPUT) ALTRET(SINPUT_ERR) ;
     1190    16890    2   SINPUT_ERR:
     1191    16891    2       END ;                        /* Then Do */
     1192    16892    1       RETURN;
     1193    16893        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:37   
     1194    16894    1   XUG$ECHOIF_COMMON: ENTRY(GETCMD) ALTRET;
     1195    16895    1       XUG$ = GETCMD.WORK$ ;
     1196    16896    1       IF GETCMD.DCB_PARAM# = DCBNUM( NIL )
     1197    16897    1       THEN
     1198    16898    1           GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;
     1199    16899    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)
     1200    16900    1       THEN
     1201    16901    1           OUTDCB# = GETCMD.DCB_PARAM# ;
     1202    16902    1       ELSE
     1203    16903    1           CALL XUG$GETDCB_COMMON(M$LO,OUTDCB#) ALTRET(MALT) ;
     1204    16904    1       IF DCBADDR(XUG.DCBS.NUM(0))->F$DCB.DDEV.XEQ# THEN I=1;
     1205    16905    1       ELSE I=0;
     1206    16906    2       DO I=I TO XUG.NDCBS;
     1207    16907    2           CALL XUG$CORRES_COMMON(OUTDCB#,BINBIT(XUG.DCBS.NUM(I),36))
     1208    16908    2             ALTRET(NO_ECHO);
     1209    16909    2       END;
     1210    16910    1       GOTO MAYBE_ECHO ;
     1211    16911    1   XUG$ECHO_COMMON: ENTRY(GETCMD) ALTRET;
     1212    16912    1       XUG$ = GETCMD.WORK$ ;
     1213    16913    1       IF GETCMD.DCB_PARAM# = DCBNUM( NIL )
     1214    16914    1       THEN
     1215    16915    1           GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;
     1216    16916    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)
     1217    16917    1       THEN
     1218    16918    1           OUTDCB# = GETCMD.DCB_PARAM# ;
     1219    16919    1       ELSE
     1220    16920    1           CALL XUG$GETDCB_COMMON(M$LO,OUTDCB#) ALTRET(MALT) ;
     1221    16921    1   MAYBE_ECHO: ;
     1222    16922    1       GETCMD.DCB_PARAM# = OUTDCB# ;
     1223    16923    1       IF DCBADDR(GETCMD.INDCB#) -> F$DCB.DVBYTE.TRANS#
     1224    16924    1       THEN
     1225    16925    1           GOTO NO_ECHO ;
     1226    16926    1       IF XUG.NDCBS < 9 THEN
     1227    16927    1           XUG.NDCBS=XUG.NDCBS+1;
     1228    16928    1       XUG.DCBS.NUM(XUG.NDCBS)=OUTDCB# ;
     1229    16929    1       XUG.DCBS.ERRPTR_CPOS(XUG.NDCBS) = -1;
     1230    16930    1       CNT = 0 ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:38   
     1231    16931    2       DO J=1 TO XUG.NLINES-1 ;
     1232    16932    2           CNT = CNT + VBASE(XUG.RLTVEC) ->RLT(J) ;
     1233    16933    2       END ;                        /* Do J */
     1234    16934    1       XUG.CPOS = CNT ;
     1235    16935    1       FPT_WRITE = FPT_WRITE_C;
     1236    16936    1       FPT_WRITE.V_ = VECTOR(FPT_WRITE.V);
     1237    16937    1       FPT_WRITE.V.DCB#=OUTDCB# ;
     1238    16938    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, OUTDCB#);
     1239    16939    1       IF GETCMD.RPROMPT_~=VECTOR(NIL) AND
     1240    16940    1         GETCMD.RPROMPT_~=VECTOR(ERASE)
     1241    16941    2       THEN DO;
     1242    16942    2           POFF = VBOUND(GETCMD.RPROMPT_)+1 ;
     1243    16943    2           CSIZE = POFF ;
     1244    16944    2           PROMPT_BUF = VBASE(GETCMD.RPROMPT_) -> CHARBASE ;
     1245    16945    2           FPT_WRITE.V.DVBYTE.VFC# = XUG.PROMPT_VFC ;
     1246    16946    2       END ;
     1247    16947    2       ELSE DO;
     1248    16948    2           POFF = XUG.POFF;
     1249    16949    2           PROMPT_BUF = SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),POFF);
     1250    16950    2       END;
     1251    16951    1       CNT = 0 ;
     1252    16952    1       OUTPUT_WIDTH = DCBADDR(OUTDCB#) -> F$DCB.WIDTH#;
     1253    16953    1       IF OUTPUT_WIDTH = 0
     1254    16954    1       THEN
     1255    16955    1           OUTPUT_WIDTH = 511;
     1256    16956    2       DO I=1 TO XUG.NLINES;
     1257    16957    2           OUTPUT_COUNT = POFF+VBASE(XUG.RLTVEC)->RLT(I);
     1258    16958    2           CALL CONCAT(XUG.BUF,SUBSTR(PROMPT_BUF,0,POFF),
     1259    16959    2             SUBSTR(VBASE(XUG.BUFVEC)->INBUF,CNT, OUTPUT_COUNT-POFF)) ;
     1260    16960    3           DO WHILE (OUTPUT_COUNT > 1);
     1261    16961    3               IF SUBSTR (XUG.BUF, OUTPUT_COUNT - 1, 1) ~= ' '
     1262    16962    3               THEN
     1263    16963    3                   EXIT;
     1264    16964    3               OUTPUT_COUNT = OUTPUT_COUNT - 1;
     1265    16965    3           END;
     1266    16966    2           IF I~=XUG.NLINES THEN
     1267    16967    3           DO ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:39   
     1268    16968    3               SUBSTR(XUG.BUF, OUTPUT_COUNT, 1) = ';';
     1269    16969    3               OUTPUT_COUNT = OUTPUT_COUNT + 1;
     1270    16970    3           END ; /* Then Do */
     1271    16971    2           OFFSET = 0;
     1272    16972    3           DO WHILE (OFFSET < OUTPUT_COUNT);
     1273    16973    3               CHUNK_SIZE = MINIMUM (OUTPUT_COUNT - OFFSET, OUTPUT_WIDTH);
     1274    16974    3               IF XUG.PROMPT_VFC AND OFFSET > 0
     1275    16975    4               THEN DO;
     1276    16976    4                   CHUNK_SIZE = CHUNK_SIZE + 1;
     1277    16977    4                   OFFSET = OFFSET - 1;
     1278    16978    4                   SUBSTR( XUG.BUF, OFFSET, 1 ) = SUBSTR( XUG.BUF, 0, 1 );
     1279    16979    4               END;
     1280    16980    3               FPT_WRITE.BUF_ = VECTOR (SUBSTR(XUG.BUF, OFFSET, CHUNK_SIZE));
     1281    16981    4               CALL M$WRITE(FPT_WRITE) WHENALTRETURN DO ;
     1282    16982    4               END ;
     1283    16983    3               OFFSET = OFFSET + CHUNK_SIZE;
     1284    16984    3           END;
     1285    16985    2           CNT = CNT + VBASE(XUG.RLTVEC)->RLT(I) ;
     1286    16986    2       END;
     1287    16987    1       RETURN;
     1288    16988    1   NO_ECHO:
     1289    16989    1       CNT = 0 ;
     1290    16990    2       DO J=1 TO XUG.NLINES-1 ;
     1291    16991    2           CNT = CNT + VBASE(XUG.RLTVEC) ->RLT(J) ;
     1292    16992    2       END ;                        /* Do J */
     1293    16993    1       XUG.CPOS = CNT ;
     1294    16994    1       RETURN;
     1295    16995
     1296    16996        %EJECT ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:40   
     1297    16997    1   XUG$SETPROMPT: ENTRY (GETCMD) ALTRET ;
     1298    16998
     1299    16999    1       XUG$ = GETCMD.WORK$ ;
     1300    17000    1       FPT_PROMPT = FPT_PROMPT_C;
     1301    17001    1       FPT_PROMPT.V_ = VECTOR(FPT_PROMPT.V);
     1302    17002    1       IF GETCMD.INDCB# ~= 0
     1303    17003    2       THEN DO;
     1304    17004    2           J = GETCMD.INDCB#;
     1305    17005    2           FPT_PROMPT.V.DCB# = J;
     1306    17006    2       END;
     1307    17007    1       ELSE
     1308    17008    1           J = DCBNUM(M$UC);
     1309    17009    1       PROMPT_FLG = ( GETCMD.ALWAYS_SET_PROMPT# | XUG.DEFER_SETTING_PROMPT );
     1310    17010    1       XUG.DEFER_SETTING_PROMPT = %NO# ;
     1311    17011    2       IF GETCMD.PROMPT_=VECTOR(NIL) THEN DO;
     1312    17012    2           IF XUG.POFF > 0 THEN PROMPT_FLG='1'B ;
     1313    17013    2           XUG.POFF=0;
     1314    17014    2           XUG.PROMPT_VFC=%NO#;
     1315    17015    2           XUG.PROMPT=' ';
     1316    17016    2           FPT_PROMPT.PROMPT_=GETCMD.PROMPT_ ;
     1317    17017    2       END;
     1318    17018    2       ELSE IF GETCMD.PROMPT_=VECTOR(ERASE) THEN DO;
     1319    17019    2               XUG.POFF=0;
     1320    17020    2               XUG.PROMPT_VFC=%NO#;
     1321    17021    2               XUG.PROMPT=' ';
     1322    17022    2           END ; /* Then Do */
     1323    17023    2           ELSE DO;
     1324    17024    2               PSIZ=VBOUND(GETCMD.PROMPT_) + 1 ;
     1325    17025    2               I = BITBIN(GETCMD.PROMPT_VFC#) ;
     1326    17026    2               FPT_PROMPT.V.DVBYTE#.VFC# = GETCMD.PROMPT_VFC# ;
     1327    17027    2               FPT_PROMPT.PROMPT_ = GETCMD.PROMPT_ ;
     1328    17028    2               POFF = PSIZ - I ;
     1329    17029    2               IF XUG.POFF~=POFF OR XUG.PROMPT_VFC~=GETCMD.PROMPT_VFC# OR
     1330    17030    2                 XUG.PROMPT~=VBASE(GETCMD.PROMPT_)->PROMPT$C.C THEN
     1331    17031    2                   PROMPT_FLG='1'B;
     1332    17032    2               XUG.POFF=POFF;
     1333    17033    2               XUG.PROMPT = VBASE(GETCMD.PROMPT_)->PROMPT$C.C ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:41   
     1334    17034    2               XUG.PROMPT_VFC = GETCMD.PROMPT_VFC# ;
     1335    17035    2           END;
     1336    17036    1       IF PROMPT_FLG
     1337    17037    2       THEN DO;
     1338    17038    2           IF GETCMD.TEXT_ ~= VECTOR(NIL)
     1339    17039    2             AND NOT GETCMD.ALWAYS_SET_PROMPT#
     1340    17040    2           THEN
     1341    17041    2               XUG.DEFER_SETTING_PROMPT = %YES# ;
     1342    17042    3           ELSE DO;
     1343    17043    3               IF NOT DCBADDR(J) -> F$DCB.FCD#
     1344    17044    4               THEN DO;
     1345    17045    4                   FPT_OPEN = FPT_OPEN_C;
     1346    17046    4                   FPT_OPEN.V_ = VECTOR (FPT_OPEN.V);
     1347    17047    4                   FPT_OPEN.V.DCB# = J;
     1348    17048    5                   CALL M$OPEN (FPT_OPEN) WHENALTRETURN DO; END;
     1349    17049    4               END;
     1350    17050    3               CALL M$PROMPT(FPT_PROMPT)
     1351    17051    4               WHENALTRETURN DO;
     1352    17052    4                   XUG.DEFER_SETTING_PROMPT = %YES# ;
     1353    17053    4               END;
     1354    17054    3           END;
     1355    17055    2       END;
     1356    17056
     1357    17057    1       RETURN ;
     1358    17058        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:42   
     1359    17059    1   MOVER: PROC (VEC, OFFSET, SIZ) ;
     1360    17060
     1361    17061    2   DCL J SBIN ;
     1362    17062    2   DCL VEC VECTOR ;
     1363    17063    2   DCL OFFSET UBIN ;
     1364    17064    2   DCL SIZ UBIN ;
     1365    17065    2   DCL WDS(0:0) BIT(72) DALIGNED BASED ;
     1366    17066    2   DCL TO$ PTR ;
     1367    17067    2   DCL FROM$ PTR ;
     1368    17068
     1369    17069    2       FROM$ = VBASE(VEC) ;
     1370    17070    2       J = VBOUND(VEC) / 8 ;
     1371    17071    2       TO$ = PINCRW(FROM$, OFFSET) ;
     1372    17072    3       DO WHILE (J > 0) ;
     1373    17073    3           J = J - 1 ;
     1374    17074    3           TO$ -> WDS(J) = FROM$ -> WDS(J) ;
     1375    17075    3       END ;
     1376    17076    2       VBASE(VEC) = TO$ ;
     1377    17077    2       VBOUND(VEC) = VBOUND(VEC) + SIZ*4 ;
     1378    17078
     1379    17079    2       RETURN ;
     1380    17080    2   END   MOVER ;
     1381    17081        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:43   
     1382    17082    1   REPORT_ALTERNATIVES: PROC;
     1383    17083
     1384    17084    2   DCL ONECHAR CHAR (1) BASED;
     1385    17085    2   DCL SAVED_HI_CHAR SBIN WORD;
     1386    17086    2   DCL SAVED_HINODE$ PTR;
     1387    17087    2   DCL SAVED_WK_USED SBIN WORD;
     1388    17088
     1389    17089    2       SAVED_HI_CHAR = P_PCB.HI_CHAR;
     1390    17090    2       SAVED_HINODE$ = P_PCB.HINODE$;
     1391    17091    2       SAVED_WK_USED = P_PCB.WK_USED;
     1392    17092
     1393    17093    2       XUG.PARSING_FREE_CMDS = %NO#;
     1394    17094    2       CALL X$PARSE (P_PCB);
     1395    17095
     1396    17096    2       IF NOT P_PCB.BLANKONLY
     1397    17097    2         OR P_PCB.HI_CHAR ~= P_PCB.NCHARS
     1398    17098    2       THEN
     1399    17099    2           RETURN;
     1400    17100
     1401    17101    2       PINCRC (P_PCB.TEXT$, P_PCB.NCHARS) -> ONECHAR = ' ';
     1402    17102    2       P_PCB.NCHARS = P_PCB.NCHARS + 1;
     1403    17103    2       P_PCB.NXT = %NO#;
     1404    17104    2       XUG.PARSING_FREE_CMDS = %NO#;
     1405    17105
     1406    17106    2       CALL X$PARSE (P_PCB)
     1407    17107    3       WHENALTRETURN DO;
     1408    17108
     1409    17109    3           IF P_PCB.ERROR.CODE = %E$SYNERR
     1410    17110    4           THEN DO;
     1411    17111
     1412    17112    4               GETCMD.ERR_CODE = XUG#FOLLOWED_BY;
     1413    17113    4               CALL XUG$ERRMSG_COMMON (GETCMD);
     1414    17114
     1415    17115        /*E*  ERROR:   XUG-E$XUG#FOLLOWED_BY
     1416    17116              MESSAGE:followed by:
     1417    17117        */
     1418    17118
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:44   
     1419    17119    4               XUG.PARSING_FREE_CMDS = %NO#;
     1420    17120    4               P_PCB.NXT = %YES#;
     1421    17121    4               CALL X$PARSE (P_PCB);
     1422    17122
     1423    17123    4           END;
     1424    17124
     1425    17125    3       END;
     1426    17126
     1427    17127    2       P_PCB.HI_CHAR = SAVED_HI_CHAR;
     1428    17128    2       P_PCB.HINODE$ = SAVED_HINODE$;
     1429    17129    2       P_PCB.NCHARS = P_PCB.NCHARS - 1;
     1430    17130    2       P_PCB.WK_USED = SAVED_WK_USED;
     1431    17131
     1432    17132    2       RETURN;
     1433    17133
     1434    17134    2   END REPORT_ALTERNATIVES;
     1435    17135
     1436    17136        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:45   
     1437    17137    1   FETCH_HELP_TOPIC: PROC;
     1438    17138
     1439    17139    2   DCL LOW_CHAR SBIN WORD;
     1440    17140    2   DCL HIGH_CHAR SBIN WORD;
     1441    17141    2   DCL LENGTH SBIN WORD;
     1442    17142    2   DCL NCHARS SBIN WORD;
     1443    17143    2   DCL STRING$ PTR;
     1444    17144    2   DCL STRING CHAR (NCHARS) BASED (STRING$);
     1445    17145    2   DCL TSTRING CHAR (5);
     1446    17146    2   DCL BANG_OK BIT(1);
     1447    17147    2   DCL DO_OK BIT(1);
     1448    17148    2   DCL DO_CMD BIT(1);
     1449    17149
     1450    17150    2       BANG_OK = %NO#;
     1451    17151    2       DO_CMD = %NO#;
     1452    17152    2       DO_OK = ( XUG.COMMANDS & ~ XUG.INHIBITS.DO# );
     1453    17153    2       IF DO_OK
     1454    17154    3       THEN DO;
     1455    17155    3           CALL INDEX(LENGTH,'!',SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),XUG.POFF))
     1456    17156    4           WHENALTRETURN DO;
     1457    17157    4               BANG_OK = %YES#;
     1458    17158    4           END;
     1459    17159    3       END;
     1460    17160
     1461    17161    2       NCHARS = P_PCB.NCHARS;
     1462    17162
     1463    17163    2       STRING$ = P_PCB.TEXT$;
     1464    17164    2       LOW_CHAR = -1;
     1465    17165
     1466    17166    2   FIND_START_CHAR: ;
     1467    17167    3       DO UNTIL SYMTTBL.PL6SYM(ASCBIN(SUBSTR(STRING, LOW_CHAR, 1)));
     1468    17168
     1469    17169    3           LOW_CHAR = LOW_CHAR + 1;
     1470    17170
     1471    17171    3           IF LOW_CHAR = NCHARS
     1472    17172    3           THEN
     1473    17173    3               RETURN;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:46   
     1474    17174
     1475    17175    3           IF BANG_OK AND SUBSTR(STRING,LOW_CHAR,1) = '!'
     1476    17176    3           THEN
     1477    17177    3               DO_CMD = %YES#;
     1478    17178
     1479    17179    3       END;
     1480    17180
     1481    17181    2       HIGH_CHAR = LOW_CHAR;
     1482    17182
     1483    17183    3       DO WHILE SYMTTBL.PL6SYM(ASCBIN(SUBSTR(STRING, HIGH_CHAR, 1)));
     1484    17184
     1485    17185    3           HIGH_CHAR = HIGH_CHAR + 1;
     1486    17186
     1487    17187    3           IF HIGH_CHAR = NCHARS
     1488    17188    3           THEN
     1489    17189    3               EXIT;
     1490    17190
     1491    17191    3       END;
     1492    17192
     1493    17193    2       LENGTH = HIGH_CHAR - LOW_CHAR;
     1494    17194
     1495    17195    2       IF LENGTH = 0
     1496    17196    2       THEN
     1497    17197    2           RETURN;
     1498    17198
     1499    17199    2       CALL XLATE (TSTRING, TRANSTBL, SUBSTR (STRING, LOW_CHAR, LENGTH));
     1500    17200
     1501    17201    2       IF TSTRING = 'HELP'
     1502    17202    2       THEN
     1503    17203    2           RETURN;
     1504    17204
     1505    17205    2       IF DO_OK AND NOT DO_CMD AND TSTRING = 'DO'
     1506    17206    3       THEN DO;
     1507    17207    3           DO_CMD = %YES# ;
     1508    17208    3           LOW_CHAR = HIGH_CHAR - 1;
     1509    17209    3           GOTO FIND_START_CHAR;
     1510    17210    3       END;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:47   
     1511    17211
     1512    17212    2       IF NOT DO_CMD
     1513    17213    3       THEN DO;
     1514    17214    3           XUG.HELP_TOPIC.COUNT = LENGTH;
     1515    17215    3           XUG.HELP_TOPIC.TEXT = SUBSTR (STRING, LOW_CHAR, LENGTH);
     1516    17216    3       END;
     1517    17217    3       ELSE DO;
     1518    17218    3           XUG.HELP_TOPIC.COUNT = LENGTH + 7;
     1519    17219    3           CALL CONCAT(XUG.HELP_TOPIC.TEXT, '(IBEX) ',
     1520    17220    3             SUBSTR (STRING, LOW_CHAR, LENGTH));
     1521    17221    3       END;
     1522    17222    2       XUG.DIVERT_TO_HELP = %YES#;
     1523    17223
     1524    17224    2       RETURN;
     1525    17225
     1526    17226    2   END FETCH_HELP_TOPIC;
     1527    17227        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:48   
     1528    17228    1   SCAN_RECORD: PROC (INCR, LOW, HIGH) ;
     1529    17229
     1530    17230    2   DCL INCR SBIN WORD ;
     1531    17231    2   DCL LOW SBIN WORD ;
     1532    17232    2   DCL HIGH SBIN WORD ;
     1533    17233
     1534    17234    2   DCL I SBIN WORD ;
     1535    17235    2   DCL LAST SBIN WORD ;
     1536    17236    2   DCL CHARVAL UBIN WORD ;
     1537    17237    2   DCL CURCHAR$ PTR ;
     1538    17238    2   DCL CUR$CHAR CHAR(1) BASED(CURCHAR$) ;
     1539    17239
     1540    17240    2       CURCHAR$ = VBASE(XUG.BUFVEC) ;
     1541    17241    2       CURCHAR$ = PINCRC(CURCHAR$, LOW) ;
     1542    17242    2       LAST = LOW ;
     1543    17243
     1544    17244    3   SCAN: DO I=0 TO 5 ;
     1545    17245    3           CHARVAL = ASCBIN(CUR$CHAR) ;
     1546    17246    3           IF CHARVAL <= ASCBIN(' ') OR CHARVAL > 127
     1547    17247    3           THEN
     1548    17248    3               EXIT SCAN ;
     1549    17249    3           IF SYMTTBL.GENERIC_DSTRING(CHARVAL) AND NOT SYMTTBL.FID(CHARVAL)
     1550    17250    3           THEN
     1551    17251    3               EXIT SCAN ;
     1552    17252    3           LAST = LAST + INCR ;
     1553    17253    3           CURCHAR$ = PINCRC(CURCHAR$, INCR) ;
     1554    17254    3       END SCAN ;
     1555    17255
     1556    17256    2       IF INCR > 0
     1557    17257    2       THEN                            /* Right motion */
     1558    17258    2           HIGH = LAST ;
     1559    17259    2       ELSE                            /* Left motion */
     1560    17260    3       DO ;
     1561    17261    3           HIGH = LOW ;
     1562    17262    3           LOW = LAST ;
     1563    17263    3       END ;                        /* Else Do */
     1564    17264
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:49   
     1565    17265    2       RETURN ;
     1566    17266    2   END     SCAN_RECORD ;
     1567    17267        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:50   
     1568    17268    1   SPELLING_CHECKER: PROC (QM_REQUIRED) ALTRET;
     1569    17269
     1570    17270        /*I*  NAME:    SPELLING_CHECKER
     1571    17271              DESCRIPTION: This routine drives spelling-error detection for keywords
     1572    17272                       in commands.  It is called with a single flag, which (if true)
     1573    17273                       indicates that the first non-alphabetic character at or to the
     1574    17274                       right of the point of error must be a "?" (this is used to
     1575    17275                       request partial-prefix-known displays, such as the IBEX
     1576    17276                       command "!TERMINAL P?" to determine all options which begin
     1577    17277                       with the letter P.  SPELLING_CHECKER contains the special
     1578    17278                       interfaces to X$PARSE and XUS$CORRECT.  Its RETURN/ALTRETURN
     1579    17279                       behavior is inverted from the normal style - it ALTRETURNS if
     1580    17280                       it is able to suggest one or more alternative/completed
     1581    17281                       spellings of a keyword, and RETURNs if it cannot.
     1582    17282        */
     1583    17283
     1584    17284    2   DCL QM_REQUIRED BIT (1) ALIGNED PARAM ;
     1585    17285
     1586    17286    2   DCL BADCHAR SBIN WORD;
     1587    17287    2   DCL FIRSTCHAR SBIN WORD;
     1588    17288    2   DCL FIRST_LEGAL$ PTR;
     1589    17289    2   DCL KEYWORDS$ PTR;
     1590    17290    2   DCL KEYWORDS_FOUND SBIN WORD;
     1591    17291    2   DCL LASTCHAR SBIN WORD;
     1592    17292    2   DCL LEGAL_BITS (0:0) BIT (1) BASED UNAL;
     1593    17293    2   DCL LEN SBIN WORD;
     1594    17294    2   DCL NCHARS SBIN WORD;
     1595    17295    2   DCL QM_HIT BIT (1);
     1596    17296    2   DCL SAVED_HI_CHAR SBIN WORD;
     1597    17297    2   DCL SAVED_HINODE$ PTR;
     1598    17298    2   DCL SAVED_WK_USED SBIN WORD;
     1599    17299    2   DCL STRING$ PTR;
     1600    17300    2   DCL STRING CHAR (NCHARS) BASED (STRING$);
     1601    17301
     1602    17302    2   DCL 1 TEXTC,
     1603    17303    2         2 COUNT UBIN BYTE CALIGNED,
     1604    17304    2         2 TEXT CHAR (63);
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:51   
     1605    17305
     1606    17306    2   DCL 1 LEGAL_TEXTC,
     1607    17307    2         2 COUNT UBIN BYTE CALIGNED,
     1608    17308    2         2 TEXT CHAR (63);
     1609    17309
     1610    17310    2   DCL 1 BASED_TEXTC BASED ALIGNED,
     1611    17311    2         2 COUNT UBIN BYTE CALIGNED,
     1612    17312    2         2 TEXT CHAR (63);
     1613    17313
     1614    17314        %P$KEYWORDS (STCLASS="BASED(KEYWORDS$)");
     1615    17332
     1616    17333    2       XUG.SPELLING_TRIED = %YES#;
     1617    17334    2       BADCHAR = P_PCB.HI_CHAR;
     1618    17335    2       NCHARS = P_PCB.NCHARS;
     1619    17336    2       STRING$ = VBASE (XUG.BUFVEC);
     1620    17337
     1621    17338    2       IF BADCHAR >= NCHARS
     1622    17339    2       THEN
     1623    17340    2           RETURN;
     1624    17341
     1625    17342    2       IF SUBSTR (STRING, BADCHAR, 1) ~= '?'
     1626    17343    2         AND NOT SYMTTBL.ALPHA (ASCBIN(SUBSTR(STRING, BADCHAR, 1)))
     1627    17344    2       THEN
     1628    17345    2           RETURN;
     1629    17346
     1630    17347    2       FIRSTCHAR = BADCHAR;
     1631    17348
     1632    17349    3       DO WHILE FIRSTCHAR > 0;
     1633    17350
     1634    17351    3           IF NOT SYMTTBL.ALPHA (ASCBIN(SUBSTR(STRING, FIRSTCHAR - 1, 1)))
     1635    17352    3           THEN
     1636    17353    3               EXIT;
     1637    17354
     1638    17355    3           FIRSTCHAR = FIRSTCHAR - 1;
     1639    17356
     1640    17357    3       END;
     1641    17358
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:52   
     1642    17359    2       LASTCHAR = FIRSTCHAR;
     1643    17360
     1644    17361    3       DO WHILE LASTCHAR < NCHARS - 1;
     1645    17362
     1646    17363    3           IF NOT SYMTTBL.ALPHA (ASCBIN(SUBSTR(STRING, LASTCHAR + 1, 1)))
     1647    17364    3           THEN
     1648    17365    3               EXIT;
     1649    17366
     1650    17367    3           LASTCHAR = LASTCHAR + 1;
     1651    17368
     1652    17369    3       END;
     1653    17370
     1654    17371    2       LEN = LASTCHAR - FIRSTCHAR + 1;
     1655    17372
     1656    17373    2       IF LEN <= 0
     1657    17374    2       THEN
     1658    17375    2           RETURN;
     1659    17376
     1660    17377    2       QM_HIT = %NO#;
     1661    17378
     1662    17379    2       IF LASTCHAR < NCHARS - 1
     1663    17380    2       THEN
     1664    17381    2           IF SUBSTR (STRING, LASTCHAR + 1, 1) = '?'
     1665    17382    2           THEN
     1666    17383    2               QM_HIT = %YES#;
     1667    17384
     1668    17385    2       TEXTC.COUNT = LEN;
     1669    17386    2       CALL XLATE (TEXTC.TEXT, TRANSTBL, SUBSTR (STRING, FIRSTCHAR, LEN));
     1670    17387
     1671    17388    2       IF QM_REQUIRED AND NOT QM_HIT
     1672    17389    3       THEN DO;
     1673    17390    3           XUG.SPELLING_TRIED = %NO#;
     1674    17391    3           RETURN;
     1675    17392    3       END;
     1676    17393
     1677    17394    2       SAVED_HI_CHAR = P_PCB.HI_CHAR;
     1678    17395    2       SAVED_WK_USED = P_PCB.WK_USED;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:53   
     1679    17396    2       SAVED_HINODE$ = P_PCB.HINODE$;
     1680    17397
     1681    17398    2       P_PCB.HI_CHAR = FIRSTCHAR;
     1682    17399    2       P_PCB.KEYWORDS = %YES#;
     1683    17400    2       P_PCB.ERROR = '0'B;
     1684    17401    2       P_PCB.NXT_SZONLY = %YES#;
     1685    17402    2       XUG.PARSING_FREE_CMDS = %NO#;
     1686    17403
     1687    17404    2       CALL X$PARSE (P_PCB);
     1688    17405    2       P_PCB.NXT_SZONLY = %NO#;
     1689    17406    2       CALL X$PARSE (P_PCB);
     1690    17407
     1691    17408    2       P_PCB.KEYWORDS = %NO#;
     1692    17409
     1693    17410    2       IF P_PCB.ERROR.MON OR P_PCB.ERROR.CODE ~= %E$SYNERR
     1694    17411    2       THEN
     1695    17412    2           GOTO CORRECTION_FAILED;
     1696    17413
     1697    17414    2       KEYWORDS$ = P_PCB.OUT$;
     1698    17415
     1699    17416    2       KEYWORDS_FOUND = P$KEYWORDS.KEYWORD_COUNT;
     1700    17417
     1701    17418    2       IF KEYWORDS_FOUND = 0
     1702    17419    2       THEN
     1703    17420    2           GOTO CORRECTION_FAILED;
     1704    17421
     1705    17422    2       CALL XUS$CORRECT_SPELLING (P$KEYWORDS.KEYWORD_COUNT, P$KEYWORDS.KEYWORDS$,
     1706    17423    2         TEXTC, %YES#, P$KEYWORDS.LEGAL$ -> LEGAL_BITS);
     1707    17424
     1708    17425    2       FIRST_LEGAL$ = ADDR(NIL);
     1709    17426
     1710    17427    3       DO I = 0 TO KEYWORDS_FOUND - 1;
     1711    17428
     1712    17429    3           IF LEN <= 2 AND NOT P$KEYWORDS.LEGAL$ -> LEGAL_BITS(I) AND
     1713    17430    3             TEXTC.TEXT = SUBSTR(P$KEYWORDS.KEYWORDS$(I) -> BASED_TEXTC.TEXT, 0, LEN)
     1714    17431    4           THEN DO;
     1715    17432
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:54   
     1716    17433    4               P$KEYWORDS.LEGAL$ -> LEGAL_BITS(I) = %YES#;
     1717    17434    4               P$KEYWORDS.KEYWORD_COUNT = P$KEYWORDS.KEYWORD_COUNT + 1;
     1718    17435
     1719    17436    4           END;
     1720    17437
     1721    17438    3           IF P$KEYWORDS.LEGAL$ -> LEGAL_BITS(I)
     1722    17439    3             AND FIRST_LEGAL$ = ADDR(NIL)
     1723    17440    3           THEN
     1724    17441    3               FIRST_LEGAL$ = P$KEYWORDS.KEYWORDS$(I);
     1725    17442
     1726    17443    3       END;
     1727    17444
     1728    17445    2       GETCMD.F1_ = VECTOR (TEXTC);
     1729    17446
     1730    17447    2       IF FIRST_LEGAL$ = ADDR(NIL)
     1731    17448    2       THEN
     1732    17449    2           GETCMD.F2_ = VECTOR(NIL);
     1733    17450
     1734    17451    3       ELSE DO;
     1735    17452
     1736    17453        /*N* KLUGE - similar to the one in XUP$DMPNXT.  Beware - if the format of
     1737    17454             P$LIT ever changes, this may explode messily.
     1738    17455        */
     1739    17456
     1740    17457    3           FIRST_LEGAL$ = PINCRW(FIRST_LEGAL$, -1);
     1741    17458
     1742    17459    3           IF FIRST_LEGAL$ -> P$LIT.ABREV = 0
     1743    17460    4           THEN DO;
     1744    17461
     1745    17462    4               LEGAL_TEXTC.COUNT = FIRST_LEGAL$ -> P$LIT.COUNT;
     1746    17463    4               LEGAL_TEXTC.TEXT = FIRST_LEGAL$ -> P$LIT.TEXT;
     1747    17464
     1748    17465    4           END;
     1749    17466
     1750    17467    4           ELSE DO;
     1751    17468
     1752    17469    4               LEGAL_TEXTC.COUNT = FIRST_LEGAL$ -> P$LIT.COUNT + 1;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:55   
     1753    17470    4               LEGAL_TEXTC.TEXT = FIRST_LEGAL$ -> P$LIT.TEXT;
     1754    17471
     1755    17472    4               SUBSTR (LEGAL_TEXTC.TEXT, FIRST_LEGAL$ -> P$LIT.ABREV) = '/';
     1756    17473    4               SUBSTR (LEGAL_TEXTC.TEXT, FIRST_LEGAL$ -> P$LIT.ABREV + 1) =
     1757    17474    4                 SUBSTR (FIRST_LEGAL$ -> P$LIT.TEXT, FIRST_LEGAL$ -> P$LIT.ABREV);
     1758    17475
     1759    17476    4           END;
     1760    17477
     1761    17478    3           GETCMD.F2_ = VECTOR (LEGAL_TEXTC);
     1762    17479
     1763    17480    3       END;
     1764    17481
     1765    17482    2       IF P$KEYWORDS.KEYWORD_COUNT = 0
     1766    17483    2       THEN
     1767    17484    2           GETCMD.ERR_CODE = XUG#NO_MATCH;
     1768    17485    2       ELSE
     1769    17486    2           IF QM_HIT
     1770    17487    2           THEN
     1771    17488    2               IF P$KEYWORDS.KEYWORD_COUNT = 1
     1772    17489    2               THEN
     1773    17490    2                   IF TEXTC.TEXT = FIRST_LEGAL$ -> P$LIT.TEXT
     1774    17491    2                   THEN
     1775    17492    2                       GETCMD.ERR_CODE = XUG#NO_OTHER_CHOICE;
     1776    17493    2                   ELSE
     1777    17494    2                       GETCMD.ERR_CODE = XUG#SINGLE_CHOICE;
     1778    17495    2               ELSE
     1779    17496    2                   GETCMD.ERR_CODE = XUG#MULTI_CHOICE;
     1780    17497    2           ELSE
     1781    17498    2               IF P$KEYWORDS.KEYWORD_COUNT = 1
     1782    17499    2               THEN
     1783    17500    2                   GETCMD.ERR_CODE = XUG#SINGLE_LEGAL;
     1784    17501    2               ELSE
     1785    17502    2                   GETCMD.ERR_CODE = XUG#MULTI_LEGAL;
     1786    17503
     1787    17504        /*E*  ERROR:   XUG-E$XUG#MULTI_LEGAL
     1788    17505              MESSAGE:"%U1" is not legal here.  You might have meant one of:
     1789    17506        */
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:56   
     1790    17507        /*E*  ERROR:   XUG-E$XUG#SINGLE_LEGAL
     1791    17508              MESSAGE:"%U1" is not legal here.  You might have meant "%U2", instead.
     1792    17509        */
     1793    17510        /*E*  ERROR:   XUG-E$XUG#MULTI_CHOICE
     1794    17511              MESSAGE:Legal words which resemble "%U1" include:
     1795    17512        */
     1796    17513        /*E*  ERROR:   XUG-E$XUG#SINGLE_CHOICE
     1797    17514              MESSAGE:The only legal word which resembles "%U1" is "%U2".
     1798    17515        */
     1799    17516        /*E*  ERROR:   XUG-E$XUG#NO_OTHER_CHOICE
     1800    17517              MESSAGE:"%U1" is legal here;  no other legal word resembles it.
     1801    17518        */
     1802    17519        /*E*  ERROR:   XUG-E$XUG#NO_MATCH
     1803    17520              MESSAGE:"%U1" does not resemble any word which is legal here.
     1804    17521        */
     1805    17522
     1806    17523    2       CALL XUG$ERRMSG_COMMON (GETCMD);
     1807    17524
     1808    17525    2       IF P$KEYWORDS.KEYWORD_COUNT > 1
     1809    17526    3       THEN DO;
     1810    17527
     1811    17528    3           P$KEYWORDS.KEYWORD_COUNT = KEYWORDS_FOUND;
     1812    17529
     1813    17530    3           CALL XUP$DMPCORRECTED (P_PCB);
     1814    17531
     1815    17532    3       END;
     1816    17533
     1817    17534    2       P_PCB.HI_CHAR = SAVED_HI_CHAR;
     1818    17535    2       P_PCB.WK_USED = SAVED_WK_USED;
     1819    17536    2       P_PCB.HINODE$ = SAVED_HINODE$;
     1820    17537
     1821    17538    2       IF P$KEYWORDS.KEYWORD_COUNT = 0
     1822    17539    2         AND NOT QM_HIT
     1823    17540    2       THEN
     1824    17541    2           RETURN;
     1825    17542    2       ELSE
     1826    17543    2           ALTRETURN;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:57   
     1827    17544
     1828    17545    2   CORRECTION_FAILED:
     1829    17546
     1830    17547    2       P_PCB.HI_CHAR = SAVED_HI_CHAR;
     1831    17548    2       P_PCB.WK_USED = SAVED_WK_USED;
     1832    17549    2       P_PCB.HINODE$ = SAVED_HINODE$;
     1833    17550
     1834    17551    2       RETURN;
     1835    17552
     1836    17553    2   END SPELLING_CHECKER;
     1837    17554        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:58   
     1838    17555    1   END XUG$COMMON;
     1839    17556        %EOD;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:59   
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XT_MACRO_M.:TOOLE04  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$COMMON.

   Procedure XUG$COMMON requires 3442 words for executable code.
   Procedure XUG$COMMON requires 288 words of local(AUTO) storage.

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:60   

 Object Unit name= XUG$COMMON                                 File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:17:45.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    236    354  XUG$COMMON
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none  3442   6562  XUG$COMMON
    3  RoData even  none    48     60  XUG$COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  XUG$COMMON
     2      6          yes     yes      Std        2  XUG$INIT_COMMON
     2    666          yes     yes      Std        1  XUG$MOREMEM
     2   1160          yes     yes      Std        1  XUG$GETCMD_COMMON
     2   3117          yes     yes      Std        1  XUG$GETMORE_COMMON
     2   3266          yes     yes      Std        1  XUG$ERRPTR_COMMON
     2   4136          yes     yes      Std        1  XUG$SINPUT
     2   4405          yes     yes      Std        1  XUG$ECHOIF_COMMON
     2   4472          yes     yes      Std        1  XUG$ECHO_COMMON
     2   5071          yes     yes      Std        1  XUG$SETPROMPT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0    163  XUG#NOTCONTIGAREA                  0    164  XUG#AREANOTRTSZ
    0    165  XUG#CANTEXPAND                     0    210  XUG_INIT_C
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:61   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
         yes           Std       2 XUG$PRE_PROCESSOR
 yes     yes           Std       1 XUG$ECHOLAST_COMMON
         yes           Std       1 XUG$DISABLE_COMMON
 yes     yes           Std       1 XUG$PU
 yes     yes           Std       2 XUG$BLANK_PASSWORD_COMMON
 yes     yes           Std       1 XUG$BUILTIN_COMMON
         yes          ~proc      0 XU_DATA_D
 yes     yes           Std       1 XUG$SETLAST
 yes     yes           Std       1 XUG$ERRMSG_COMMON
         yes           Std       1 XUG$CLRENABLE_COMMON
 yes     yes           Std       3 XUG$READCMD_COMMON
 yes     yes           Std       2 XUG$CORRES_COMMON
 yes     yes           Std       5 XUS$CORRECT_SPELLING
 yes     yes           Std       2 XUG$GETDCB_COMMON
         yes           Std       0 X66_REL_AUTO
         yes           Std       2 XUG$PP_CMDVARS
 yes     yes           Std       1 X$PARSE
         yes           Std       2 XUG$OPENOUT_INTERNAL
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes          ~proc      0 XUG_BUILTIN_N
         yes    yes    Std       1 XUP$DMPCORRECTED
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
                       nStd      0 X66_AUNWIND
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:62   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    XUP_SYMTBL                       r    B$XL_UPPER$                           M$UC
     XUG_NODES                        r    B$JIT$                           r    B$TCB$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:63   


        1        1        /*M* XUG$COMMON - COMMON COMMAND READING AND ERROR REPORTING ROUTINES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
        8        8        XUG$COMMON: PROC (GETCMD, XUG_INIT) ALTRET;

      8  2 000000   000000 700200 xent  XUG$COMMON   TSX0  ! X66_AUTO_2
         2 000001   000440 000002                    ZERO    288,2
         2 000002   000005 710000 2                  TRA     s:15914+1

        9        9        /**/
       10       10    1   DCL 1 VECBASE BASED,                    /* USED AS REDEF OF NODES */
       11       11    1         2 BOUND UBIN(20) UNAL,
       12       12    1         2 FLAGS BIT(16),
       13       13    1         2 P$ PTR;
       14       14    1   DCL PR$ PTR;
       15       15    1   DCL 1 PROMPT$C CALIGNED BASED(PR$),
       16       16    1         2 C CHAR(PSIZ);
       17       17    1   DCL PSIZ SBIN;
       18       18        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:64   
       19       19    1   DCL X$PARSE ENTRY(1) ALTRET;
       20       20    1   DCL XUG$BLANK_PASSWORD_COMMON ENTRY(2) ALTRET ;
       21       21    1   DCL XUG$ERRMSG_COMMON ENTRY(1) ALTRET;
       22       22    1   DCL XUG$READCMD_COMMON ENTRY(3) ALTRET;
       23       23    1   DCL XUG$CORRES_COMMON ENTRY(2) ALTRET;
       24       24    1   DCL XUG$PU ENTRY(1) ALTRET ;
       25       25    1   DCL XUG$SETLAST ENTRY(1) ALTRET;
       26       26    1   DCL XUG$ECHOLAST_COMMON ENTRY(1) ALTRET;
       27       27    1   DCL XUG$DISABLE_COMMON ENTRY(1) ;
       28       28    1   DCL XUG$CLRENABLE_COMMON ENTRY(1) ;
       29       29    1   DCL XUG$GETDCB_COMMON ENTRY(2) ALTRET;
       30       30    1   DCL XUG$BUILTIN_COMMON ENTRY (1) ALTRET;
       31       31    1   DCL XUG$PRE_PROCESSOR ENTRY (2);
       32       32    1   DCL XUG$PP_CMDVARS ENTRY (2);
       33       33    1   DCL XUG$OPENOUT_INTERNAL ENTRY(2);
       34       34        /**/
       35       35        %INCLUDE B$JIT;
       36      638        %INCLUDE B$TABLES_C;
       37      746        %INCLUDE NK_VFC_C;
       38      820        %INCLUDE XU_MACRO_C;
       39     3926        %INCLUDE XUH_MACRO_C ;
       40     4010        %INCLUDE XT_MACRO_M;
       41     4336        %INCLUDE XU_PERR_C;
       42     4527        %INCLUDE XU_SUBS_C ;
       43     4619        %INCLUDE XU_DATA_R;
       44     4630        %B$XL_UPPER (NAME=TRANSTBL);
       45     4634        %P_PCB (STCLASS="BASED(P_PCB$)");
       46     4833        %P_PCB (STCLASS=CONSTANT,NAME=P_PCB_C);
       47     5032        %P$NODE (STCLASS=BASED);
       48     5126        %P$LIT (STCLASS=BASED, LEN="P$LIT.COUNT");
       49     5179        %PARSE$OUT (NAME=P$B, STCLASS=BASED) ;
       50     5224        %INCLUDE CP_6;
       51    10783        %INCLUDE CP_6_SUBS;
       52    11323        %INCLUDE B_SEGIDS_C ;
       53    11862        %F$DCB;
       54    11919        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
       55    11920        DCL 1 NAME STCLASS,
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:65   
       56    11921              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
       57    11922              2 C CHAR(0) INIT(T#);
       58    11923        %MEND;
       59    11924        %TEXTC (NAME=M$SI,T#='M$SI');
       60    11929        %TEXTC (NAME=M$LO,T#='M$LO');
       61    11934        %SET GDSSIZ = 1024;
       62    11935        %FPT_GDS (FPTN=FPT_GDS_C, SEGSIZE=%GDSSIZ, STCLASS=CONSTANT);
       63    11951        %FPT_GDS (FPTN=FPT_GDS, STCLASS=AUTO);
       64    11967    1   DCL USER_GDSVEC VECTOR ;
       65    11968        %FPT_WRITE (WAIT=YES,STCLASS=CONSTANT,FPTN=FPT_WRITE_C);
       66    11999        %FPT_WRITE (STCLASS=AUTO);
       67    12030        %FPT_PROMPT (STCLASS=CONSTANT,FPTN=FPT_PROMPT_C);
       68    12058        %FPT_PROMPT (STCLASS=AUTO);
       69    12086        %FPT_OPEN (FPTN=FPT_OPEN_C, STCLASS=CONSTANT);
       70    12195        %FPT_OPEN (FPTN=FPT_OPEN, STCLASS=AUTO);
       71    12304        %FPT_SINPUT (FPTN=FPT_SINPUT_C, STCLASS=CONSTANT, POSITION=YES) ;
       72    12341        %FPT_SINPUT (FPTN=FPT_SINPUT, STCLASS=AUTO) ;
       73    12378        %FPT_MERC (FPTN=FPT_MERC, STCLASS=AUTO);
       74    12391        %FPT_MERC (FPTN=FPT_MERC_C, STCLASS=CONSTANT);
       75    12404        %VLP_ERRCODE (FPTN=XUG#SMALLWORK, STCLASS=CONSTANT,
       76    12405                      FCG=XU, MID=G, ERR#=%E$XUG#SMALLWORK, SEV=2) ;
       77    12450        %VLP_ERRCODE (FPTN=XUG#NOTCONTIGAREA, STCLASS="CONSTANT SYMDEF",
       78    12451                      FCG=XU, MID=G, ERR#=%E$XUG#NOTCONTIGAREA, SEV=2) ;
       79    12496        %VLP_ERRCODE (FPTN=XUG#AREANOTRTSZ, STCLASS="CONSTANT SYMDEF",
       80    12497                      FCG=XU, MID=G, ERR#=%E$XUG#AREANOTRTSZ, SEV=2) ;
       81    12542        %VLP_ERRCODE (FPTN=XUG#CANTEXPAND, STCLASS="CONSTANT SYMDEF",
       82    12543                      FCG=XU, MID=G, ERR#=%E$XUG#CANTEXPAND, SEV=2) ;
       83    12588        %VLP_ERRCODE (FPTN=XUG#PLERRMSG, STCLASS=CONSTANT,
       84    12589                      FCG=XU, MID=G, ERR#=%E$XUG#PLERRMSG, SEV=0) ;
       85    12634        %VLP_ERRCODE (FPTN=XUG#INCOR_PTD_XPND, STCLASS=CONSTANT,
       86    12635                      FCG=XU, MID=G, ERR#=%E$XUG#INCOR_PTD_XPND, SEV=0);
       87    12680        %VLP_ERRCODE (FPTN=XUG#INCOR_HERE_XPND, STCLASS=CONSTANT,
       88    12681                      FCG=XU, MID=G, ERR#=%E$XUG#INCOR_HERE_XPND, SEV=0) ;
       89    12726        %VLP_ERRCODE (FPTN=XUG#INCOR_HERE, STCLASS=CONSTANT,
       90    12727                      FCG=XU, MID=G, ERR#=%E$XUG#INCOR_HERE, SEV=0);
       91    12772        %VLP_ERRCODE (FPTN=XUG#NWALIGNED, STCLASS=CONSTANT,
       92    12773                      FCG=XU, MID=G, ERR#=%E$XUG#NWALIGNED, SEV=0) ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:66   
       93    12818        %VLP_ERRCODE (FPTN=XUG#LEGAL_INPUT_HERE, STCLASS=CONSTANT,
       94    12819                      FCG=XU, MID=G, ERR#=%E$XUG#LEGAL_INPUT_HERE, SEV=0);
       95    12864        %VLP_ERRCODE (FPTN=XUG#LEGAL_INPUT_QM, STCLASS=CONSTANT,
       96    12865                      FCG=XU, MID=G, ERR#=%E$XUG#LEGAL_INPUT_QM, SEV=0);
       97    12910        %VLP_ERRCODE (FPTN=XUG#SINGLE_LEGAL, STCLASS=CONSTANT,
       98    12911                      FCG=XU, MID=G, ERR#=%E$XUG#SINGLE_LEGAL, SEV=0);
       99    12956        %VLP_ERRCODE (FPTN=XUG#MULTI_LEGAL, STCLASS=CONSTANT,
      100    12957                      FCG=XU, MID=G, ERR#=%E$XUG#MULTI_LEGAL, SEV=0);
      101    13002        %VLP_ERRCODE (FPTN=XUG#SINGLE_CHOICE, STCLASS=CONSTANT,
      102    13003                      FCG=XU, MID=G, ERR#=%E$XUG#SINGLE_CHOICE, SEV=0);
      103    13048        %VLP_ERRCODE (FPTN=XUG#MULTI_CHOICE, STCLASS=CONSTANT,
      104    13049                      FCG=XU, MID=G, ERR#=%E$XUG#MULTI_CHOICE, SEV=0);
      105    13094        %VLP_ERRCODE (FPTN=XUG#NO_OTHER_CHOICE, STCLASS=CONSTANT,
      106    13095                      FCG=XU, MID=G, ERR#=%E$XUG#NO_OTHER_CHOICE, SEV=0);
      107    13140        %VLP_ERRCODE (FPTN=XUG#NO_MATCH, STCLASS=CONSTANT,
      108    13141                      FCG=XU, MID=G, ERR#=%E$XUG#NO_MATCH, SEV=0);
      109    13186        %VLP_ERRCODE (FPTN=XUG#FOLLOWED_BY, STCLASS=CONSTANT,
      110    13187                      FCG=XU, MID=G, ERR#=%E$XUG#FOLLOWED_BY, SEV=0);
      111    13232        %VLP_ERRCODE (FPTN=XUG#NULLROOT, STCLASS=CONSTANT,
      112    13233                      FCG=XU, MID=G, ERR#=%E$NULLROOT, SEV=0);
      113    13278        %VLP_ERRCODE (FPTN=XUG#PRE_C00, STCLASS=CONSTANT,
      114    13279                      FCG=XU, MID=G, ERR#=%E$PCB_PRE_C00, SEV=0);
      115    13324        %VLP_ERRCODE (FPTN=XUG#LINETOOLONG, STCLASS=CONSTANT,
      116    13325                      FCG=XU, MID=G, ERR#=%E$XUG#LINETOOLONG, SEV=0);
      117    13370        %VLP_ERRCODE (FPTN=TEMP_ERR, STCLASS=AUTO) ;
      118    13415    1   DCL XUG_NODES UBIN WORD SYMREF ;
      119    13416    1   DCL XUG_BUILTIN_N UBIN WORD SYMREF ;
      120    13417    1   DCL XUP$DMPCORRECTED ENTRY (1) OPTIONAL;
      121    13418    1   DCL XUS$CORRECT_SPELLING ENTRY (5) ALTRET;
      122    13419    1   DCL X66_REL_AUTO ENTRY;
      123    13420        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:67   
      124    13421        %XUG_PARAMS ;
      125    13865        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
      126    14203        %XUG_INIT (NAME=XUG_INIT, STCLASS=PARAM) ;
      127    14616        %XUG_INIT (NAME = XUG_INIT_C,STCLASS="CONSTANT SYMDEF",ADAPT=NIL);
      128    15029        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
      129    15442        %XUG_RLT (NAME=RLT) ;
      130    15449        %XUH_PARAM (NAME=XUH_PARAM_C, STCLASS=CONSTANT) ;
      131    15510        %XT_PARAM (NAME=XT_PARAM, STCLASS="BASED(XT$)");
      132    15823        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:68   
      133    15824    1   DCL XUG$ PTR ;
      134    15825    1   DCL XT$ PTR;
      135    15826    1   DCL XT_ VECTOR;
      136    15827    1   DCL P_PCB$ PTR ;
      137    15828    1   DCL ROOT$ PTR ;
      138    15829    1   DCL NODES$ PTR ;
      139    15830    1   DCL DUMMY$ PTR ;
      140    15831    1   DCL TEXT$ PTR ;
      141    15832    1   DCL TO$ PTR ;
      142    15833    1   DCL 1 SEG$ PTR ;
      143    15834    1   DCL 1 RSEG REDEF SEG$,
      144    15835    1         2 OFFSET UBIN(24) UNAL,
      145    15836    1         2 SID BIT(12) UNAL ;
      146    15837    1   DCL GDSVEC VECTOR ;
      147    15838    1   DCL XUG_OWNS_MEMORY BIT(1) ;
      148    15839    1   DCL STATIC_SZ SBIN WORD ;
      149    15840    1   DCL WORK_SZ SBIN WORD ;
      150    15841    1   DCL RLT_SZ SBIN ;
      151    15842    1   DCL WOFF SBIN ;
      152    15843    1   DCL WBUFSZ SBIN ;
      153    15844    1   DCL ARS SBIN;
      154    15845    1   DCL PROMPT_FLG BIT(1) ALIGNED;
      155    15846    1   DCL ERRPTR_FLG BIT(1) ;
      156    15847    1   DCL TWOCHARS CHAR(2);
      157    15848    1   DCL I SBIN;
      158    15849    1   DCL J SBIN;
      159    15850    1   DCL EPOS SBIN;
      160    15851    1   DCL TPOS SBIN;
      161    15852    1   DCL CSIZE SBIN;
      162    15853    1   DCL TCSIZE SBIN ;
      163    15854    1   DCL POFF SBIN WORD ;
      164    15855    1   DCL CHUNK_SIZE SBIN;
      165    15856    1   DCL OFFSET SBIN;
      166    15857    1   DCL OUTPUT_COUNT SBIN;
      167    15858    1   DCL OUTPUT_WIDTH SBIN;
      168    15859    1   DCL PROMPT_BUF CHAR(94) ;
      169    15860    1   DCL FIRST SBIN ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:69   
      170    15861    1   DCL LAST SBIN ;
      171    15862    1   DCL SAVE_PROMPT_ VECTOR;
      172    15863    1   DCL SAVE_RPROMPT_ VECTOR;
      173    15864    1   DCL SAVE_PROMPT_VFC BIT(1);
      174    15865    1   DCL SAVE_ERR BIT(36) ;
      175    15866    1   DCL SAVE_DCB UBIN WORD ;
      176    15867    1   DCL SAVE_F1 VECTOR;
      177    15868    1   DCL SAVE_F2 VECTOR;
      178    15869    1   DCL 1 FIELD1 ALIGNED,
      179    15870    1         2 CNT UBIN BYTE CALIGNED,
      180    15871    1         2 TXT CHAR(20) CALIGNED ;
      181    15872    1   DCL 1 FIELD2 ALIGNED,
      182    15873    1         2 CNT UBIN BYTE CALIGNED,
      183    15874    1         2 TXT CHAR(20) CALIGNED ;
      184    15875        /*
      185    15876        */
      186    15877    1   DCL CHARBASE CHAR(CSIZE) BASED;
      187    15878    1   DCL CHARARRAY(0:0) CHAR(1) BASED;
      188    15879    1   DCL UBIN$BUF9 UBIN(9) UNAL BASED ;
      189    15880    1   DCL P$ PTR BASED;
      190    15881    1   DCL INBUF CHAR(1024) BASED;
      191    15882    1   DCL 1 VEC$BUF BASED (SEG$) CHAR(CNT) ;
      192    15883    1   DCL OFF$ PTR ;
      193    15884    1   DCL DIFF SBIN ;
      194    15885    1   DCL CNT SBIN WORD ;
      195    15886    1   DCL OUTDCB# UBIN WORD ;
      196    15887    1   DCL B$JIT$ PTR SYMREF READONLY;
      197    15888    1   DCL B$TCB$ PTR SYMREF READONLY;
      198    15889        %B$TCB (STCLASS="BASED(B$TCB$)") ;
      199    15892        %B$ALT;
      200    15900        %EQU XUG_DFLT_WKSZ = 200 ;
      201    15901        %EQU EXPND_PARSEWK = 800 ;
      202    15902
      203    15903        /* Generate CONV(5) entries to force :LIB loading of parse
      204    15904           nodes and the like when necessary.  Bury these DCLs inside a
      205    15905           dummy PROC so that they don't conflict with SYMREFs referencing
      206    15906           the same names.
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:70   
      207    15907        */
      208    15908
      209    15909    1   GENERATE_CONV_5_ENTREFS: PROC;

  15909  2 000003   200352 741300       GENERATE_CO* STX1  ! OUTDCB#+1,,AUTO

      210    15910
      211    15911    2   DCL XU_OUTPUT_OPTIONS ENTRY CONV (5);
      212    15912    2   DCL XUG_BUILTIN_N ENTRY CONV (5);
      213    15913
      214    15914    2   END GENERATE_CONV_5_ENTREFS;

  15914  2 000004   000001 702211                    TSX2  ! 1,X1
         2 000005   000010 710000 2                  TRA     s:15919

      215    15915
      216    15916        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:71   
      217    15917    1   XUG$INIT_COMMON: ENTRY (GETCMD, XUG_INIT) ALTRET;

  15917  2 000006   000000 700200 xent  XUG$INIT_CO* TSX0  ! X66_AUTO_2
         2 000007   000440 000002                    ZERO    288,2

      218    15918
      219    15919    1       IF GETCMD.WORK$ = ADDR (NIL)

  15919  2 000010   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000011   000004 236100                    LDQ     4,,PR0
         2 000012   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000013   000415 601000 2                  TNZ     s:16037

      220    15920    2       THEN DO;

      221    15921    2           IF VBASE(XUG_INIT.WORK_) ~= ADDR(NIL)

  15921  2 000014   200004 471500                    LDP1    @XUG_INIT,,AUTO
         2 000015   100016 236100                    LDQ     14,,PR1
         2 000016   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000017   000053 600000 2                  TZE     s:15941

      222    15922    3           THEN DO;

      223    15923    3               IF VBOUND(XUG_INIT.WORK_) < (500 * 4 - 1)

  15923  2 000020   100015 236100                    LDQ     13,,PR1
         2 000021   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000022   000000 116000 3                  CMPQ    0
         2 000023   000027 603000 2                  TRC     s:15929

      224    15924    3               THEN
      225    15925    4               DO ;

      226    15926    4                   GETCMD.ERR# = XUG#SMALLWORK ;

  15926  2 000024   000162 236000 0                  LDQ     XUG#SMALLWORK
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:72   
         2 000025   000001 756100                    STQ     1,,PR0

      227    15927    4                   ALTRETURN ;

  15927  2 000026   000000 702200 xent               TSX2  ! X66_AALT

      228    15928    4               END ; /* Then Do */
      229    15929    3               OFF$ = PALIGNW(VBASE(XUG_INIT.WORK_)) ;

  15929  2 000027   100016 236100                    LDQ     14,,PR1
         2 000030   770000 036007                    ADLQ    -4096,DL
         2 000031   000001 376000 3                  ANQ     1
         2 000032   200346 756100                    STQ     OFF$,,AUTO

      230    15930    3               DIFF = POFFC(OFF$, VBASE(XUG_INIT.WORK_)) ;

  15930  2 000033   100016 236100                    LDQ     14,,PR1
         2 000034   000020 772000                    QRL     16
         2 000035   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 000036   200346 236100                    LDQ     OFF$,,AUTO
         2 000037   000020 772000                    QRL     16
         2 000040   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 000041   200347 756100                    STQ     DIFF,,AUTO

      231    15931    3               IF DIFF ~= 0

  15931  2 000042   000046 600000 2                  TZE     s:15937

      232    15932    3               THEN
      233    15933    4               DO ;

      234    15934    4                   GETCMD.ERR# = XUG#NWALIGNED ;

  15934  2 000043   000172 236000 0                  LDQ     XUG#NWALIGNED
         2 000044   000001 756100                    STQ     1,,PR0

      235    15935    4                   ALTRETURN ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:73   

  15935  2 000045   000000 702200 xent               TSX2  ! X66_AALT

      236    15936    4               END ; /* Then Do */
      237    15937    3               GDSVEC = XUG_INIT.WORK_;

  15937  2 000046   000100 100500                    MLR     fill='000'O
         2 000047   100015 000010                    ADSC9   13,,PR1                  cn=0,n=8
         2 000050   200234 000010                    ADSC9   GDSVEC,,AUTO             cn=0,n=8

      238    15938    3               XUG_OWNS_MEMORY = %NO#;

  15938  2 000051   200236 450100                    STZ     XUG_OWNS_MEMORY,,AUTO

      239    15939    3           END;

  15939  2 000052   000175 710000 2                  TRA     s:15985

      240    15940    3           ELSE DO;

      241    15941    3               FPT_GDS = FPT_GDS_C ;

  15941  2 000053   000100 100400                    MLR     fill='000'O
         2 000054   000022 000030 0                  ADSC9   FPT_GDS_C                cn=0,n=24
         2 000055   200010 000030                    ADSC9   FPT_GDS,,AUTO            cn=0,n=24

      242    15942    3               FPT_GDS.V_ = VECTOR(FPT_GDS.V) ;

  15942  2 000056   000002 235000 3                  LDA     2
         2 000057   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 000060   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 000061   000014 036003                    ADLQ    12,DU
         2 000062   200010 757100                    STAQ    FPT_GDS,,AUTO

      243    15943    3               FPT_GDS.RESULTS_ = VECTOR(GDSVEC) ;

  15943  2 000063   000002 235000 3                  LDA     2
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:74   
         2 000064   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 000065   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 000066   000234 036003                    ADLQ    156,DU
         2 000067   200012 757100                    STAQ    FPT_GDS+2,,AUTO

      244    15944    3               GDSVEC = VECTOR(NIL) ;

  15944  2 000070   000004 237000 3                  LDAQ    4
         2 000071   200234 757100                    STAQ    GDSVEC,,AUTO

      245    15945    3               RSEG = '0'B ;

  15945  2 000072   200232 450100                    STZ     SEG$,,AUTO

      246    15946    4               DO CASE (XUG_INIT.WSEG#) ;

  15946  2 000073   100025 720100                    LXL0    21,,PR1
         2 000074   000777 360003                    ANX0    511,DU
         2 000075   000011 100003                    CMPX0   9,DU
         2 000076   000100 602010 2                  TNC     s:15946+5,X0
         2 000077   000136 710000 2                  TRA     s:15970
         2 000100   000111 710000 2                  TRA     s:15949
         2 000101   000136 710000 2                  TRA     s:15970
         2 000102   000136 710000 2                  TRA     s:15970
         2 000103   000114 710000 2                  TRA     s:15952
         2 000104   000117 710000 2                  TRA     s:15955
         2 000105   000122 710000 2                  TRA     s:15958
         2 000106   000125 710000 2                  TRA     s:15961
         2 000107   000130 710000 2                  TRA     s:15964
         2 000110   000133 710000 2                  TRA     s:15967

      247    15947
      248    15948    4               CASE(0) ;               /* Next available */

      249    15949    4                   RSEG.SID = %NULLSID ;

  15949  2 000111   006014 236007                    LDQ     3084,DL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:75   
         2 000112   200232 752103                    STCQ    SEG$,'03'O,AUTO
         2 000113   000140 710000 2                  TRA     s:15973

      250    15950
      251    15951    4               CASE(3) ;

      252    15952    4                   RSEG.SID = %DS3SID ;

  15952  2 000114   006006 236007                    LDQ     3078,DL
         2 000115   200232 752103                    STCQ    SEG$,'03'O,AUTO
         2 000116   000140 710000 2                  TRA     s:15973

      253    15953
      254    15954    4               CASE(4) ;

      255    15955    4                   RSEG.SID = %DS4SID ;

  15955  2 000117   006007 236007                    LDQ     3079,DL
         2 000120   200232 752103                    STCQ    SEG$,'03'O,AUTO
         2 000121   000140 710000 2                  TRA     s:15973

      256    15956
      257    15957    4               CASE(5) ;

      258    15958    4                   RSEG.SID = %DS5SID ;

  15958  2 000122   006010 236007                    LDQ     3080,DL
         2 000123   200232 752103                    STCQ    SEG$,'03'O,AUTO
         2 000124   000140 710000 2                  TRA     s:15973

      259    15959
      260    15960    4               CASE(6) ;

      261    15961    4                   RSEG.SID = %DS6SID ;

  15961  2 000125   006011 236007                    LDQ     3081,DL
         2 000126   200232 752103                    STCQ    SEG$,'03'O,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:76   
         2 000127   000140 710000 2                  TRA     s:15973

      262    15962
      263    15963    4               CASE(7) ;

      264    15964    4                   RSEG.SID = %DS7SID ;

  15964  2 000130   006012 236007                    LDQ     3082,DL
         2 000131   200232 752103                    STCQ    SEG$,'03'O,AUTO
         2 000132   000140 710000 2                  TRA     s:15973

      265    15965
      266    15966    4               CASE(8) ;

      267    15967    4                   RSEG.SID = %DS8SID ;

  15967  2 000133   006013 236007                    LDQ     3083,DL
         2 000134   200232 752103                    STCQ    SEG$,'03'O,AUTO
         2 000135   000140 710000 2                  TRA     s:15973

      268    15968
      269    15969    4               CASE(ELSE) ;

      270    15970    4                   RSEG.SID = %NULLSID ;

  15970  2 000136   006014 236007                    LDQ     3084,DL
         2 000137   200232 752103                    STCQ    SEG$,'03'O,AUTO

      271    15971
      272    15972    4               END ;                   /* Do Case */

      273    15973    3               VBASE(GDSVEC) = SEG$ ;

  15973  2 000140   200232 236100                    LDQ     SEG$,,AUTO
         2 000141   200235 756100                    STQ     GDSVEC+1,,AUTO

      274    15974    3               CALL M$GDS (FPT_GDS)
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:77   

  15974  2 000142   200010 630500                    EPPR0   FPT_GDS,,AUTO
         2 000143   430001 713400                    CLIMB   alt,gds
         2 000144   400400 401760                    pmme    nvectors=2
         2 000145   000147 702000 2                  TSX2    s:15976
         2 000146   000173 710000 2                  TRA     s:15983

      275    15975    4               WHENALTRETURN DO;

      276    15976    4                   TEMP_ERR = B$TCB.ALT$ -> B$ALT.ERR;

  15976  2 000147   000000 470400 xsym               LDP0    B$TCB$
         2 000150   000000 471500                    LDP1    0,,PR0
         2 000151   100102 236100                    LDQ     66,,PR1
         2 000152   200152 756100                    STQ     TEMP_ERR,,AUTO

      277    15977    4                   TEMP_ERR.SEV = 4;

  15977  2 000153   000003 376000 3                  ANQ     3
         2 000154   000004 276007                    ORQ     4,DL
         2 000155   200152 756100                    STQ     TEMP_ERR,,AUTO

      278    15978    4                   FPT_MERC = FPT_MERC_C;

  15978  2 000156   000160 237000 0                  LDAQ    FPT_MERC_C
         2 000157   200150 757100                    STAQ    FPT_MERC,,AUTO

      279    15979    4                   FPT_MERC.JERR_ = VECTOR (TEMP_ERR);

  15979  2 000160   777640 235007                    LDA     -96,DL
         2 000161   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 000162   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 000163   000152 036003                    ADLQ    106,DU
         2 000164   200150 757100                    STAQ    FPT_MERC,,AUTO

      280    15980    4                   CALL M$MERC (FPT_MERC) ALTRET (MERC_PROBLEM);

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:78   
  15980  2 000165   200150 630500                    EPPR0   FPT_MERC,,AUTO
         2 000166   410007 713400                    CLIMB   alt,+4103
         2 000167   400000 401760                    pmme    nvectors=1
         2 000170   000171 702000 2                  TSX2    MERC_PROBLEM

      281    15981    4   MERC_PROBLEM:   CALL M$ERR;

  15981  2 000171   000002 713400       MERC_PROBLEM CLIMB   err
         2 000172   000000 401760                    pmme    nvectors=0

      282    15982    4               END;

      283    15983    3               XUG_OWNS_MEMORY = %YES#;

  15983  2 000173   400000 236003                    LDQ     -131072,DU
         2 000174   200236 756100                    STQ     XUG_OWNS_MEMORY,,AUTO

      284    15984    3           END;

      285    15985    2           XUG$ = VBASE(GDSVEC) ;

  15985  2 000175   200235 236100                    LDQ     GDSVEC+1,,AUTO
         2 000176   200220 756100                    STQ     XUG$,,AUTO

      286    15986    2           GETCMD.WORK$ = XUG$ ;

  15986  2 000177   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000200   000004 756100                    STQ     4,,PR0

      287    15987    2           XUG = '0'B;

  15987  2 000201   200220 471500                    LDP1    XUG$,,AUTO
         2 000202   000100 100400                    MLR     fill='000'O
         2 000203   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000204   100000 002054                    ADSC9   0,,PR1                   cn=0,n=1068

      288    15988    2           XUG.GDSVEC = GDSVEC ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:79   

  15988  2 000205   200234 237100                    LDAQ    GDSVEC,,AUTO
         2 000206   100006 757100                    STAQ    6,,PR1

      289    15989    2           XUG.XUG_OWNS_MEMORY = XUG_OWNS_MEMORY ;

  15989  2 000207   200236 236100                    LDQ     XUG_OWNS_MEMORY,,AUTO
         2 000210   000012 772000                    QRL     10
         2 000211   100071 676100                    ERQ     57,,PR1
         2 000212   000200 376003                    ANQ     128,DU
         2 000213   100071 656100                    ERSQ    57,,PR1

      290    15990    2           STATIC_SZ = SIZEC(P_PCB) + SIZEC(XUG) + SIZEC(XT_PARAM);

  15990  2 000214   002350 236007                    LDQ     1256,DL
         2 000215   200237 756100                    STQ     STATIC_SZ,,AUTO

      291    15991    2           IF MOD(STATIC_SZ, 8) ~= 0

  15991  2 000216   000010 506007                    DIV     8,DL
         2 000217   000044 733000                    LRS     36
         2 000220   000000 116003                    CMPQ    0,DU
         2 000221   000231 600000 2                  TZE     s:15993

      292    15992    2           THEN STATIC_SZ = STATIC_SZ + (8 - MOD(STATIC_SZ, 8)) ;

  15992  2 000222   200237 236100                    LDQ     STATIC_SZ,,AUTO
         2 000223   000010 506007                    DIV     8,DL
         2 000224   200432 755100                    STA     LEGAL_TEXTC+17,,AUTO
         2 000225   200237 236100                    LDQ     STATIC_SZ,,AUTO
         2 000226   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 000227   000010 036007                    ADLQ    8,DL
         2 000230   200237 756100                    STQ     STATIC_SZ,,AUTO

      293    15993    2           RLT_SZ = (XUG_INIT.INIT_NRECS# * SIZEC(RLT(0))) ;

  15993  2 000231   200004 473500                    LDP3    @XUG_INIT,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:80   
         2 000232   300024 236100                    LDQ     20,,PR3
         2 000233   777777 376007                    ANQ     -1,DL
         2 000234   200241 756100                    STQ     RLT_SZ,,AUTO

      294    15994    2           IF MOD(RLT_SZ, 8) ~= 0

  15994  2 000235   000010 506007                    DIV     8,DL
         2 000236   000044 733000                    LRS     36
         2 000237   000000 116003                    CMPQ    0,DU
         2 000240   000250 600000 2                  TZE     SETUP_WORK

      295    15995    2           THEN RLT_SZ = RLT_SZ + (8 - MOD(RLT_SZ, 8)) ;

  15995  2 000241   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 000242   000010 506007                    DIV     8,DL
         2 000243   200432 755100                    STA     LEGAL_TEXTC+17,,AUTO
         2 000244   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 000245   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 000246   000010 036007                    ADLQ    8,DL
         2 000247   200241 756100                    STQ     RLT_SZ,,AUTO

      296    15996    2   SETUP_WORK:
      297    15997    2           WORK_SZ = VBOUND(GDSVEC) - STATIC_SZ - RLT_SZ ;

  15997  2 000250   200234 236100       SETUP_WORK   LDQ     GDSVEC,,AUTO
         2 000251   000020 772000                    QRL     16
         2 000252   200237 136100                    SBLQ    STATIC_SZ,,AUTO
         2 000253   200241 136100                    SBLQ    RLT_SZ,,AUTO
         2 000254   200240 756100                    STQ     WORK_SZ,,AUTO

      298    15998    2           IF WORK_SZ <= XUG_INIT.CMDSZ# + %XUG_DFLT_WKSZ

  15998  2 000255   200004 470500                    LDP0    @XUG_INIT,,AUTO
         2 000256   000023 236100                    LDQ     19,,PR0
         2 000257   000310 036007                    ADLQ    200,DL
         2 000260   000263 604000 2                  TMI     s:16000
         2 000261   200240 116100                    CMPQ    WORK_SZ,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:81   
         2 000262   000276 604000 2                  TMI     s:16017

      299    15999    2           THEN
      300    16000    2               IF XUG_OWNS_MEMORY

  16000  2 000263   200236 234100                    SZN     XUG_OWNS_MEMORY,,AUTO
         2 000264   000272 605000 2                  TPL     s:16006

      301    16001    3               THEN DO ;

      302    16002    3                   CALL M$GDS (FPT_GDS) ALTRET (MALT) ;

  16002  2 000265   200010 630500                    EPPR0   FPT_GDS,,AUTO
         2 000266   430001 713400                    CLIMB   alt,gds
         2 000267   400400 401760                    pmme    nvectors=2
         2 000270   002543 702000 2                  TSX2    MALT

      303    16003    3                   GOTO SETUP_WORK ;

  16003  2 000271   000250 710000 2                  TRA     SETUP_WORK

      304    16004    3               END ;                  /* Then Do */
      305    16005    3               ELSE DO ;

      306    16006    3                   GETCMD.ERR# = XUG#SMALLWORK ;

  16006  2 000272   000162 236000 0                  LDQ     XUG#SMALLWORK
         2 000273   200003 471500                    LDP1    @GETCMD,,AUTO
         2 000274   100001 756100                    STQ     1,,PR1

      307    16007    3                   ALTRETURN ;

  16007  2 000275   000000 702200 xent               TSX2  ! X66_AALT

      308    16008    3               END ;                  /* Else Do */
      309    16009        /*E*  ERROR:    XUG-E$XUG#SMALLWORK
      310    16010              MESSAGE0: Work area too small for XUG$INIT to initialize.  Unable
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:82   
      311    16011                        to continue.
      312    16012        */
      313    16013        /*E*  ERROR:    XUG-E$XUG#NWALIGNED
      314    16014              MESSAGE0: Work area is not WORD ALIGNED and XUG$INIT can not continue.
      315    16015                        Initialization aborted.
      316    16016        */
      317    16017    2           SEG$ = PINCRC(XUG$, STATIC_SZ) ;

  16017  2 000276   200237 236100                    LDQ     STATIC_SZ,,AUTO
         2 000277   000020 736000                    QLS     16
         2 000300   200220 036100                    ADLQ    XUG$,,AUTO
         2 000301   200232 756100                    STQ     SEG$,,AUTO

      318    16018    2           CNT = WORK_SZ / 2 ;

  16018  2 000302   200240 236100                    LDQ     WORK_SZ,,AUTO
         2 000303   000002 506007                    DIV     2,DL
         2 000304   200350 756100                    STQ     CNT,,AUTO

      319    16019    2           XUG.PARSEVEC = VECTOR(VEC$BUF) ;

  16019  2 000305   200350 235100                    LDA     CNT,,AUTO
         2 000306   000020 735000                    ALS     16
         2 000307   000140 135007                    SBLA    96,DL
         2 000310   200232 236100                    LDQ     SEG$,,AUTO
         2 000311   200220 471500                    LDP1    XUG$,,AUTO
         2 000312   100010 757100                    STAQ    8,,PR1

      320    16020    2           SEG$ = PINCRC(SEG$, CNT) ;

  16020  2 000313   200350 236100                    LDQ     CNT,,AUTO
         2 000314   000020 736000                    QLS     16
         2 000315   200232 036100                    ADLQ    SEG$,,AUTO
         2 000316   200232 756100                    STQ     SEG$,,AUTO

      321    16021    2           OFF$ = PALIGNW(SEG$) ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:83   
  16021  2 000317   770000 036007                    ADLQ    -4096,DL
         2 000320   000001 376000 3                  ANQ     1
         2 000321   200346 756100                    STQ     OFF$,,AUTO

      322    16022    2           DIFF = POFFC(OFF$, SEG$) ;

  16022  2 000322   200232 236100                    LDQ     SEG$,,AUTO
         2 000323   000020 772000                    QRL     16
         2 000324   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 000325   200346 236100                    LDQ     OFF$,,AUTO
         2 000326   000020 772000                    QRL     16
         2 000327   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 000330   200347 756100                    STQ     DIFF,,AUTO

      323    16023    2           XUG.RLTVEC = VECTOR(OFF$ -> RLT(0)) ;

  16023  2 000331   177640 235007                    LDA     65440,DL
         2 000332   200346 236100                    LDQ     OFF$,,AUTO
         2 000333   100012 757100                    STAQ    10,,PR1

      324    16024    2           VBOUND(XUG.RLTVEC) = RLT_SZ - 1 ;

  16024  2 000334   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 000335   000001 136007                    SBLQ    1,DL
         2 000336   000020 736000                    QLS     16
         2 000337   100012 676100                    ERQ     10,,PR1
         2 000340   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000341   100012 656100                    ERSQ    10,,PR1

      325    16025    2           CNT = CNT - DIFF ;

  16025  2 000342   200350 236100                    LDQ     CNT,,AUTO
         2 000343   200347 136100                    SBLQ    DIFF,,AUTO
         2 000344   200350 756100                    STQ     CNT,,AUTO

      326    16026    2           WORK_SZ = CNT ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:84   
  16026  2 000345   200240 756100                    STQ     WORK_SZ,,AUTO

      327    16027    2           XUG.RLTCNT = XUG_INIT.INIT_NRECS# ;

  16027  2 000346   000024 236100                    LDQ     20,,PR0
         2 000347   777777 376007                    ANQ     -1,DL
         2 000350   100107 756100                    STQ     71,,PR1

      328    16028    2           XUG.NLINES = 0 ;

  16028  2 000351   100106 450100                    STZ     70,,PR1

      329    16029    2           CNT = WORK_SZ - 4 ;

  16029  2 000352   200240 235100                    LDA     WORK_SZ,,AUTO
         2 000353   000004 135007                    SBLA    4,DL
         2 000354   200350 755100                    STA     CNT,,AUTO

      330    16030    2           SEG$ = PINCRC(VBASE(XUG.RLTVEC), RLT_SZ + 4) ;

  16030  2 000355   100013 473500                    LDP3    11,,PR1
         2 000356   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 000357   000011 402007                    MPY     9,DL
         2 000360   000000 116003                    CMPQ    0,DU
         2 000361   000363 605000 2                  TPL     s:16030+6
         2 000362   000044 036003                    ADLQ    36,DU
         2 000363   300001 503506                    ABD     1,QL,PR3
         2 000364   200232 453500                    STP3    SEG$,,AUTO

      331    16031    2           OFF$ = PALIGNW(SEG$) ;

  16031  2 000365   200232 236100                    LDQ     SEG$,,AUTO
         2 000366   770000 036007                    ADLQ    -4096,DL
         2 000367   000001 376000 3                  ANQ     1
         2 000370   200346 756100                    STQ     OFF$,,AUTO

      332    16032    2           DIFF = POFFC(OFF$, SEG$) ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:85   

  16032  2 000371   200232 236100                    LDQ     SEG$,,AUTO
         2 000372   000020 772000                    QRL     16
         2 000373   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 000374   200346 236100                    LDQ     OFF$,,AUTO
         2 000375   000020 772000                    QRL     16
         2 000376   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 000377   200347 756100                    STQ     DIFF,,AUTO

      333    16033    2           CNT = CNT - DIFF ;

  16033  2 000400   200350 236100                    LDQ     CNT,,AUTO
         2 000401   200347 136100                    SBLQ    DIFF,,AUTO
         2 000402   200350 756100                    STQ     CNT,,AUTO

      334    16034    2           CNT = CNT - MOD(CNT, 8) ;

  16034  2 000403   000010 506007                    DIV     8,DL
         2 000404   200432 755100                    STA     LEGAL_TEXTC+17,,AUTO
         2 000405   200350 236100                    LDQ     CNT,,AUTO
         2 000406   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 000407   200350 756100                    STQ     CNT,,AUTO

      335    16035    2           XUG.BUFVEC = VECTOR (VEC$BUF) ;

  16035  2 000410   200350 235100                    LDA     CNT,,AUTO
         2 000411   000020 735000                    ALS     16
         2 000412   000140 135007                    SBLA    96,DL
         2 000413   200232 236100                    LDQ     SEG$,,AUTO
         2 000414   100000 757100                    STAQ    0,,PR1

      336    16036    2       END;

      337    16037    1       XUG$ = GETCMD.WORK$ ;

  16037  2 000415   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000416   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:86   
         2 000417   200220 756100                    STQ     XUG$,,AUTO

      338    16038    1       VBASE(XUG.RLTVEC) -> RLT = '0'B ;

  16038  2 000420   200220 471500                    LDP1    XUG$,,AUTO
         2 000421   100013 473500                    LDP3    11,,PR1
         2 000422   000100 100400                    MLR     fill='000'O
         2 000423   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000424   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      339    16039    1       XUG.POFF = 1;

  16039  2 000425   000001 235007                    LDA     1,DL
         2 000426   100036 755100                    STA     30,,PR1

      340    16040    1       XUG.PROMPT_VFC = %NO#;

  16040  2 000427   000006 236000 3                  LDQ     6
         2 000430   100071 356100                    ANSQ    57,,PR1

      341    16041    1       XUG.PROMPT = '*';

  16041  2 000431   040100 100400                    MLR     fill='040'O
         2 000432   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 000433   100037 000136                    ADSC9   31,,PR1                  cn=0,n=94

      342    16042    1       XUG.REQ_PROMPT = XUG_INIT.REQ_PROMPT# ;

  16042  2 000434   200004 473500                    LDP3    @XUG_INIT,,AUTO
         2 000435   300026 236100                    LDQ     22,,PR3
         2 000436   000006 772000                    QRL     6
         2 000437   100071 676100                    ERQ     57,,PR1
         2 000440   001000 376003                    ANQ     512,DU
         2 000441   100071 656100                    ERSQ    57,,PR1

      343    16043    1       XUG.SYNTAX = XUG_INIT.SYNTAX#;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:87   
  16043  2 000442   300026 236100                    LDQ     22,,PR3
         2 000443   000002 772000                    QRL     2
         2 000444   100071 676100                    ERQ     57,,PR1
         2 000445   010000 376003                    ANQ     4096,DU
         2 000446   100071 656100                    ERSQ    57,,PR1

      344    16044    1       XUG.PREPROCESS = XUG_INIT.PREPROCESS#;

  16044  2 000447   300026 236100                    LDQ     22,,PR3
         2 000450   000006 772000                    QRL     6
         2 000451   100071 676100                    ERQ     57,,PR1
         2 000452   002000 376003                    ANQ     1024,DU
         2 000453   100071 656100                    ERSQ    57,,PR1

      345    16045    1       XUG.ABORT = XUG_INIT.ABORT$;

  16045  2 000454   300000 236100                    LDQ     0,,PR3
         2 000455   100020 756100                    STQ     16,,PR1

      346    16046    1       XUG.CONTINUE = XUG_INIT.CONTINUE$;

  16046  2 000456   300001 236100                    LDQ     1,,PR3
         2 000457   100021 756100                    STQ     17,,PR1

      347    16047    1       XUG.BRKMSG = XUG_INIT.BRKMSG$;

  16047  2 000460   300002 236100                    LDQ     2,,PR3
         2 000461   100022 756100                    STQ     18,,PR1

      348    16048    1       XUG.PREPROCESSOR$$ = XUG_INIT.PREPROCESSOR$$;

  16048  2 000462   300007 236100                    LDQ     7,,PR3
         2 000463   100023 756100                    STQ     19,,PR1

      349    16049    1       XUG.SPHANDLE = XUG_INIT.SPHANDLE$ ;

  16049  2 000464   300003 236100                    LDQ     3,,PR3
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:88   
         2 000465   100025 756100                    STQ     21,,PR1

      350    16050    1       XUG.PRE_EXEC = XUG_INIT.PRE_EXEC$$ ;

  16050  2 000466   300004 236100                    LDQ     4,,PR3
         2 000467   100026 756100                    STQ     22,,PR1

      351    16051    1       XUG.POST_EXEC = XUG_INIT.POST_EXEC$$ ;

  16051  2 000470   300005 236100                    LDQ     5,,PR3
         2 000471   100027 756100                    STQ     23,,PR1

      352    16052    1       XUG.MOREMEM = XUG_INIT.MOREMEM$$ ;

  16052  2 000472   300006 236100                    LDQ     6,,PR3
         2 000473   100030 756100                    STQ     24,,PR1

      353    16053    1       XUG.XUH_PARAM = XUH_PARAM_C ;

  16053  2 000474   000100 100400                    MLR     fill='000'O
         2 000475   000254 000344 0                  ADSC9   XUH_PARAM_C              cn=0,n=228
         2 000476   100154 000344                    ADSC9   108,,PR1                 cn=0,n=228

      354    16054    1       XUG.XUH_PARAM.PROCACCT_ = XUG_INIT.PROCACCT_ ;

  16054  2 000477   300012 237100                    LDAQ    10,,PR3
         2 000500   100156 757100                    STAQ    110,,PR1

      355    16055    1       XUG.XUH_PARAM.PROCNAME_ = XUG_INIT.PROCNAME_ ;

  16055  2 000501   300010 237100                    LDAQ    8,,PR3
         2 000502   100154 757100                    STAQ    108,,PR1

      356    16056    1       XUG.ERRDCB = DCBNUM(NIL);

  16056  2 000503   100070 450100                    STZ     56,,PR1

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:89   
      357    16057    1       XUG.PPCB$ = XUG_INIT.PPCB$;

  16057  2 000504   300020 236100                    LDQ     16,,PR3
         2 000505   100073 756100                    STQ     59,,PR1

      358    16058    1       XUG.PP_PROCNAME_ = XUG_INIT.PP_PROCNAME_ ;

  16058  2 000506   000100 100500                    MLR     fill='000'O
         2 000507   300021 000010                    ADSC9   17,,PR3                  cn=0,n=8
         2 000510   100074 000010                    ADSC9   60,,PR1                  cn=0,n=8

      359    16059    1       XUG.PP_DCB = XUG_INIT.PP_DCB#;

  16059  2 000511   300025 236100                    LDQ     21,,PR3
         2 000512   000022 736000                    QLS     18
         2 000513   000033 732000                    QRS     27
         2 000514   100077 756100                    STQ     63,,PR1

      360    16060    1       XUG.ADDL_RLTCNT = XUG_INIT.ADDL_NRECS# ;

  16060  2 000515   300024 236100                    LDQ     20,,PR3
         2 000516   000022 772000                    QRL     18
         2 000517   100110 756100                    STQ     72,,PR1

      361    16061    1       XUG.CMDSZ = XUG_INIT.CMDSZ# ;

  16061  2 000520   300023 235100                    LDA     19,,PR3
         2 000521   100111 755100                    STA     73,,PR1

      362    16062    1       XUG.COMMANDS = XUG_INIT.COMMANDS# ;

  16062  2 000522   300026 236100                    LDQ     22,,PR3
         2 000523   000004 772000                    QRL     4
         2 000524   100071 676100                    ERQ     57,,PR1
         2 000525   020000 376003                    ANQ     8192,DU
         2 000526   100071 656100                    ERSQ    57,,PR1

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:90   
      363    16063    1       XUG.INHIBITS = XUG_INIT.INHIBITS;

  16063  2 000527   300040 236100                    LDQ     32,,PR3
         2 000530   000026 772000                    QRL     22
         2 000531   100071 676100                    ERQ     57,,PR1
         2 000532   037770 376007                    ANQ     16376,DL
         2 000533   100071 656100                    ERSQ    57,,PR1

      364    16064    1       XUG.NO_DOWNGRADE = XUG_INIT.NO_DOWNGRADE#;

  16064  2 000534   300026 236100                    LDQ     22,,PR3
         2 000535   000032 772000                    QRL     26
         2 000536   100071 676100                    ERQ     57,,PR1
         2 000537   000004 376007                    ANQ     4,DL
         2 000540   100071 656100                    ERSQ    57,,PR1

      365    16065    1       XUG.DONT_REREAD_CCBUF = XUG_INIT.DONT_REREAD_CCBUF#;

  16065  2 000541   300026 236100                    LDQ     22,,PR3
         2 000542   000014 772000                    QRL     12
         2 000543   100266 676100                    ERQ     182,,PR1
         2 000544   100000 376007                    ANQ     32768,DL
         2 000545   100266 656100                    ERSQ    182,,PR1

      366    16066    1       XUG.DONT_STRIP_PROMPT = XUG_INIT.DONT_STRIP_PROMPT#;

  16066  2 000546   300026 236100                    LDQ     22,,PR3
         2 000547   000014 772000                    QRL     12
         2 000550   100266 676100                    ERQ     182,,PR1
         2 000551   040000 376007                    ANQ     16384,DL
         2 000552   100266 656100                    ERSQ    182,,PR1

      367    16067    1       XUG.GOODCMD = XUG_INIT.GOODCMD# ;

  16067  2 000553   300026 236100                    LDQ     22,,PR3
         2 000554   000012 772000                    QRL     10
         2 000555   100071 676100                    ERQ     57,,PR1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:91   
         2 000556   000010 376003                    ANQ     8,DU
         2 000557   100071 656100                    ERSQ    57,,PR1

      368    16068    1       IF ENTADDR(XUS$CORRECT_SPELLING) ~= ENTADDR(NIL)

  16068  2 000560   000000 636000 xent               EAQ     XUS$CORRECT_SPELLING
         2 000561   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 000562   000570 600000 2                  TZE     s:16071

      369    16069    1       THEN
      370    16070    1           XUG.SPELLING = XUG_INIT.SPELLING#;

  16070  2 000563   300026 236100                    LDQ     22,,PR3
         2 000564   000013 772000                    QRL     11
         2 000565   100071 676100                    ERQ     57,,PR1
         2 000566   000002 376003                    ANQ     2,DU
         2 000567   100071 656100                    ERSQ    57,,PR1

      371    16071    1       IF XUG_INIT.PCB$ = ADDR(NIL)

  16071  2 000570   300017 236100                    LDQ     15,,PR3
         2 000571   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000572   000604 601000 2                  TNZ     s:16078

      372    16072    2       THEN DO;

      373    16073    2           P_PCB$ = PINCRW(XUG$, SIZEW(XUG));

  16073  2 000573   200220 236100                    LDQ     XUG$,,AUTO
         2 000574   000414 036003                    ADLQ    268,DU
         2 000575   200224 756100                    STQ     P_PCB$,,AUTO

      374    16074    2           P_PCB = P_PCB_C;

  16074  2 000576   200224 474500                    LDP4    P_PCB$,,AUTO
         2 000577   000100 100400                    MLR     fill='000'O
         2 000600   000000 000070 0                  ADSC9   P_PCB_C                  cn=0,n=56
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:92   
         2 000601   400000 000070                    ADSC9   0,,PR4                   cn=0,n=56

      375    16075    2           XUG.P_PCB$ = P_PCB$ ;

  16075  2 000602   100072 756100                    STQ     58,,PR1

      376    16076    2       END;

  16076  2 000603   000605 710000 2                  TRA     s:16079

      377    16077    1       ELSE
      378    16078    1           XUG.P_PCB$ = XUG_INIT.PCB$;

  16078  2 000604   100072 756100                    STQ     58,,PR1

      379    16079    1       XUG.ADAPT$$ = XUG_INIT.ADAPT$$;

  16079  2 000605   300027 236100                    LDQ     23,,PR3
         2 000606   100270 756100                    STQ     184,,PR1

      380    16080    1       SEG$ = GETCMD.XT_PARAM$;

  16080  2 000607   000036 236100                    LDQ     30,,PR0
         2 000610   200232 756100                    STQ     SEG$,,AUTO

      381    16081    1       IF RSEG = '0'B

  16081  2 000611   200232 235100                    LDA     SEG$,,AUTO
         2 000612   000615 601000 2                  TNZ     s:16084

      382    16082    1       THEN
      383    16083    1           GETCMD.XT_PARAM$ = ADDR(NIL);

  16083  2 000613   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000614   000036 756100                    STQ     30,,PR0

      384    16084    1       GETCMD.PCB$ = XUG.P_PCB$;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:93   

  16084  2 000615   100072 236100                    LDQ     58,,PR1
         2 000616   000003 756100                    STQ     3,,PR0

      385    16085    1       GETCMD.ECHO = XUG_INIT.ECHO#;

  16085  2 000617   300025 236100                    LDQ     21,,PR3
         2 000620   000002 772000                    QRL     2
         2 000621   000007 676100                    ERQ     7,,PR0
         2 000622   000600 376003                    ANQ     384,DU
         2 000623   000007 656100                    ERSQ    7,,PR0

      386    16086    1       GETCMD.PASS = XUG_INIT.PASS#;

  16086  2 000624   300025 236100                    LDQ     21,,PR3
         2 000625   000005 736000                    QLS     5
         2 000626   000007 676100                    ERQ     7,,PR0
         2 000627   000140 376003                    ANQ     96,DU
         2 000630   000007 656100                    ERSQ    7,,PR0

      387    16087    1       GETCMD.ALWAYS_SET_PROMPT# = XUG_INIT.ALWAYS_SET_PROMPT#;

  16087  2 000631   300026 236100                    LDQ     22,,PR3
         2 000632   000001 772000                    QRL     1
         2 000633   000006 676100                    ERQ     6,,PR0
         2 000634   002000 376003                    ANQ     1024,DU
         2 000635   000006 656100                    ERSQ    6,,PR0

      388    16088    1       GETCMD.PP_ROOT$ = XUG_INIT.PP_ROOT$;

  16088  2 000636   300034 236100                    LDQ     28,,PR3
         2 000637   000045 756100                    STQ     37,,PR0

      389    16089    1       XUG_INIT.PARAMS$ = XUG$;

  16089  2 000640   200220 236100                    LDQ     XUG$,,AUTO
         2 000641   300014 756100                    STQ     12,,PR3
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:94   

      390    16090    1       XUG.FILENAME.C = 0 ;

  16090  2 000642   000000 236003                    LDQ     0,DU
         2 000643   100137 552140                    STBQ    95,'40'O,PR1

      391    16091    1       XUG.FILENAME.TX = ' ' ;

  16091  2 000644   040100 100400                    MLR     fill='040'O
         2 000645   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000646   100137 200037                    ADSC9   95,,PR1                  cn=1,n=31

      392    16092    1       XUG.FILEACCT = ' ' ;

  16092  2 000647   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000650   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000651   100147 755100                    STA     103,,PR1
         2 000652   100150 756100                    STQ     104,,PR1

      393    16093    1       XUG.FILEPASS = ' ' ;

  16093  2 000653   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000654   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000655   100151 755100                    STA     105,,PR1
         2 000656   100152 756100                    STQ     106,,PR1

      394    16094    1       XUG.F1SAVE = VECTOR(NIL);

  16094  2 000657   000004 237000 3                  LDAQ    4
         2 000660   100272 757100                    STAQ    186,,PR1

      395    16095    1       XUG.F2SAVE = VECTOR(NIL);

  16095  2 000661   000004 237000 3                  LDAQ    4
         2 000662   100274 757100                    STAQ    188,,PR1

      396    16096    1       XUG.F3SAVE = VECTOR(NIL);
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:95   

  16096  2 000663   000004 237000 3                  LDAQ    4
         2 000664   100276 757100                    STAQ    190,,PR1

      397    16097    1       RETURN;

  16097  2 000665   000000 702200 xent               TSX2  ! X66_ARET

      398    16098        /**/
      399    16099        %EJECT ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:96   
      400    16100    1   XUG$MOREMEM: ENTRY(GETCMD) ALTRET;

  16100  2 000666   000000 700200 xent  XUG$MOREMEM  TSX0  ! X66_AUTO_2
         2 000667   000440 000002                    ZERO    288,2

      401    16101    1       XUG$ = GETCMD.WORK$ ;

  16101  2 000670   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000671   000004 236100                    LDQ     4,,PR0
         2 000672   200220 756100                    STQ     XUG$,,AUTO

      402    16102    1       IF XUG.XUG_OWNS_MEMORY

  16102  2 000673   200220 471500                    LDP1    XUG$,,AUTO
         2 000674   100071 236100                    LDQ     57,,PR1
         2 000675   000200 316003                    CANQ    128,DU
         2 000676   000720 600000 2                  TZE     s:16110

      403    16103    2       THEN DO ;

      404    16104    2           FPT_GDS = FPT_GDS_C ;

  16104  2 000677   000100 100400                    MLR     fill='000'O
         2 000700   000022 000030 0                  ADSC9   FPT_GDS_C                cn=0,n=24
         2 000701   200010 000030                    ADSC9   FPT_GDS,,AUTO            cn=0,n=24

      405    16105    2           FPT_GDS.V_ = VECTOR(FPT_GDS.V) ;

  16105  2 000702   000002 235000 3                  LDA     2
         2 000703   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 000704   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 000705   000014 036003                    ADLQ    12,DU
         2 000706   200010 757100                    STAQ    FPT_GDS,,AUTO

      406    16106    2           FPT_GDS.RESULTS_ = VECTOR(XUG.GDSVEC) ;

  16106  2 000707   000002 235000 3                  LDA     2
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:97   
         2 000710   200220 236100                    LDQ     XUG$,,AUTO
         2 000711   000006 036003                    ADLQ    6,DU
         2 000712   200012 757100                    STAQ    FPT_GDS+2,,AUTO

      407    16107    2           CALL M$GDS (FPT_GDS) ALTRET (CANT_EXPAND_SEGMENT);

  16107  2 000713   200010 630500                    EPPR0   FPT_GDS,,AUTO
         2 000714   430001 713400                    CLIMB   alt,gds
         2 000715   400400 401760                    pmme    nvectors=2
         2 000716   001157 702000 2                  TSX2    CANT_EXPAND_SEGMENT

      408    16108    2       END ;                        /* Then Do */

  16108  2 000717   001006 710000 2                  TRA     s:16157

      409    16109    1       ELSE
      410    16110    1           IF XUG.MOREMEM = ENTADDR(NIL)

  16110  2 000720   100030 236100                    LDQ     24,,PR1
         2 000721   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 000722   000726 601000 2                  TNZ     s:16122

      411    16111    2           THEN DO;

      412    16112    2               GETCMD.ERR# = XUG#CANTEXPAND;

  16112  2 000723   000165 236000 0                  LDQ     XUG#CANTEXPAND
         2 000724   000001 756100                    STQ     1,,PR0

      413    16113        /*E*  ERROR:   XUG-E$XUG#CANTEXPAND
      414    16114              MESSAGE: Can't expand the GETCMD work area.
      415    16115              MESSAGE1: GETCMD cannot expand its work area;  the work area was provided
      416    16116                       by the program that calls GETCMD, and the program did not
      417    16117                       supply a routine that can expand the work area.
      418    16118        */
      419    16119    2               GOTO CANT_EXPAND_SEGMENT;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:98   
  16119  2 000725   001157 710000 2                  TRA     CANT_EXPAND_SEGMENT

      420    16120    2           END;
      421    16121    2           ELSE DO;

      422    16122    2               CALL XUG.MOREMEM(%GDSSIZ,USER_GDSVEC,TEMP_ERR) WHENALTRETURN

  16122  2 000726   200152 633500                    EPPR3   TEMP_ERR,,AUTO
         2 000727   200434 453500                    STP3    LEGAL_TEXTC+19,,AUTO
         2 000730   200016 634500                    EPPR4   USER_GDSVEC,,AUTO
         2 000731   200433 454500                    STP4    LEGAL_TEXTC+18,,AUTO
         2 000732   000011 236000 3                  LDQ     9
         2 000733   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 000734   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 000735   100030 220100                    LDX0    24,,PR1
         2 000736   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000737   000000 701010                    TSX1    0,X0
         2 000740   000742 702000 2                  TSX2    s:16124
         2 000741   000746 710000 2                  TRA     s:16127

      423    16123    3               DO ;

      424    16124    3                   GETCMD.ERR# = TEMP_ERR ;

  16124  2 000742   200152 236100                    LDQ     TEMP_ERR,,AUTO
         2 000743   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000744   000001 756100                    STQ     1,,PR0

      425    16125    3                   GOTO CANT_EXPAND_SEGMENT ;

  16125  2 000745   001157 710000 2                  TRA     CANT_EXPAND_SEGMENT

      426    16126    3               END ;                  /* Whenaltreturn */
      427    16127    2               DUMMY$ = PINCRC(VBASE(XUG.GDSVEC), VBOUND(XUG.GDSVEC)+1) ;

  16127  2 000746   200220 470500                    LDP0    XUG$,,AUTO
         2 000747   000006 236100                    LDQ     6,,PR0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:99   
         2 000750   000020 772000                    QRL     16
         2 000751   000007 471500                    LDP1    7,,PR0
         2 000752   000011 402007                    MPY     9,DL
         2 000753   000011 036007                    ADLQ    9,DL
         2 000754   100000 503506                    ABD     0,QL,PR1
         2 000755   200227 451500                    STP1    DUMMY$,,AUTO

      428    16128    2               IF DUMMY$ ~= VBASE(USER_GDSVEC)

  16128  2 000756   200227 236100                    LDQ     DUMMY$,,AUTO
         2 000757   200017 116100                    CMPQ    USER_GDSVEC+1,,AUTO
         2 000760   000767 600000 2                  TZE     s:16140

      429    16129    2               THEN
      430    16130    3               DO ;

      431    16131    3                   GETCMD.ERR# = XUG#NOTCONTIGAREA ;

  16131  2 000761   000163 236000 0                  LDQ     XUG#NOTCONTIGAREA
         2 000762   200003 473500                    LDP3    @GETCMD,,AUTO
         2 000763   300001 756100                    STQ     1,,PR3

      432    16132    3                   GETCMD.PCB$->P_PCB.HI_CHAR = 0 ;

  16132  2 000764   300003 474500                    LDP4    3,,PR3
         2 000765   400012 450100                    STZ     10,,PR4

      433    16133    3                   GOTO CANT_EXPAND_SEGMENT ;

  16133  2 000766   001157 710000 2                  TRA     CANT_EXPAND_SEGMENT

      434    16134    3               END ;                  /* Then Do */
      435    16135        /*E*   ERROR:   XUG-E$XUG#NOTCONTIGAREA
      436    16136               MESSAGE: Not a contiguous work area.
      437    16137               MESSAGE1: The data expansion received from the user program is
      438    16138                          not contiguous with the present work area.
      439    16139        */
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:100  
      440    16140    2               IF VBOUND(USER_GDSVEC)+1 ~= %GDSSIZ*4

  16140  2 000767   200016 236100                    LDQ     USER_GDSVEC,,AUTO
         2 000770   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000771   000012 116000 3                  CMPQ    10
         2 000772   000777 600000 2                  TZE     s:16151

      441    16141    2               THEN
      442    16142    3               DO ;

      443    16143    3                   GETCMD.ERR# = XUG#AREANOTRTSZ ;

  16143  2 000773   000164 236000 0                  LDQ     XUG#AREANOTRTSZ
         2 000774   200003 473500                    LDP3    @GETCMD,,AUTO
         2 000775   300001 756100                    STQ     1,,PR3

      444    16144    3                   GOTO CANT_EXPAND_SEGMENT ;

  16144  2 000776   001157 710000 2                  TRA     CANT_EXPAND_SEGMENT

      445    16145    3               END ;                  /* Then Do */
      446    16146        /*E*   ERROR:   XUG-E$XUG#AREANOTRTSZ
      447    16147               MESSAGE: Data area not the right size.
      448    16148               MESSAGE1: The data expansion received from the user program is
      449    16149                          not the amount that XUG$GETCMD requested.
      450    16150        */
      451    16151    2               VBOUND(XUG.GDSVEC) = VBOUND(XUG.GDSVEC) + %GDSSIZ*4 ;

  16151  2 000777   000006 236100                    LDQ     6,,PR0
         2 001000   000020 772000                    QRL     16
         2 001001   010000 036007                    ADLQ    4096,DL
         2 001002   000020 736000                    QLS     16
         2 001003   000006 676100                    ERQ     6,,PR0
         2 001004   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001005   000006 656100                    ERSQ    6,,PR0

      452    16152    2           END ;                     /* Then Do */
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:101  

      453    16153        /*
      454    16154           If memory has been allocated for ADAPT at the top of the segment, move
      455    16155           its data up to the new top of the segment.
      456    16156        */
      457    16157    1       XT$ = GETCMD.XT_PARAM$;

  16157  2 001006   200003 470500                    LDP0    @GETCMD,,AUTO
         2 001007   000036 236100                    LDQ     30,,PR0
         2 001010   200221 756100                    STQ     XT$,,AUTO

      458    16158    1       IF XT$ ~= ADDR(NIL)

  16158  2 001011   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001012   001044 600000 2                  TZE     s:16170
         2 001013   200221 471500                    LDP1    XT$,,AUTO
         2 001014   100000 236100                    LDQ     0,,PR1
         2 001015   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001016   001044 600000 2                  TZE     s:16170

      459    16159    1         AND XT_PARAM.WS$ ~= ADDR(NIL)
      460    16160    2       THEN DO;

      461    16161    2           XT_ = XUG.BUFVEC;

  16161  2 001017   200220 473500                    LDP3    XUG$,,AUTO
         2 001020   300000 237100                    LDAQ    0,,PR3
         2 001021   200222 757100                    STAQ    XT_,,AUTO

      462    16162    2           VBASE(XT_) = XT_PARAM.WS$;

  16162  2 001022   100000 236100                    LDQ     0,,PR1
         2 001023   200223 756100                    STQ     XT_+1,,AUTO

      463    16163    2           VBOUND(XT_) = XT_PARAM.WS_SIZE * 4 - 1;

  16163  2 001024   100002 236100                    LDQ     2,,PR1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:102  
         2 001025   000002 736000                    QLS     2
         2 001026   000001 136007                    SBLQ    1,DL
         2 001027   000020 736000                    QLS     16
         2 001030   200222 676100                    ERQ     XT_,,AUTO
         2 001031   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001032   200222 656100                    ERSQ    XT_,,AUTO

      464    16164    2           CALL MOVER (XT_, %GDSSIZ, 0);

  16164  2 001033   000014 237000 3                  LDAQ    12
         2 001034   200354 757100                    STAQ    @QM_REQUIRED+1,,AUTO
         2 001035   200222 634500                    EPPR4   XT_,,AUTO
         2 001036   200353 454500                    STP4    OUTDCB#+2,,AUTO
         2 001037   005315 701000 2                  TSX1    MOVER
         2 001040   000000 011000                    NOP     0

      465    16165    2           XT_PARAM.WS$ = VBASE(XT_);

  16165  2 001041   200223 236100                    LDQ     XT_+1,,AUTO
         2 001042   200221 470500                    LDP0    XT$,,AUTO
         2 001043   000000 756100                    STQ     0,,PR0

      466    16166    2       END;

      467    16167        /*
      468    16168           Expand the RLT.
      469    16169        */
      470    16170    1       RLT_SZ = (XUG.ADDL_RLTCNT * SIZEC(RLT(0))) ;

  16170  2 001044   200220 470500                    LDP0    XUG$,,AUTO
         2 001045   000110 235100                    LDA     72,,PR0
         2 001046   200241 755100                    STA     RLT_SZ,,AUTO

      471    16171    1       IF MOD(RLT_SZ,8) ~= 0

  16171  2 001047   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 001050   000010 506007                    DIV     8,DL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:103  
         2 001051   000044 733000                    LRS     36
         2 001052   000000 116003                    CMPQ    0,DU
         2 001053   001063 600000 2                  TZE     s:16176

      472    16172    1       THEN RLT_SZ = RLT_SZ + (8 - MOD(RLT_SZ, 8)) ;

  16172  2 001054   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 001055   000010 506007                    DIV     8,DL
         2 001056   200432 755100                    STA     LEGAL_TEXTC+17,,AUTO
         2 001057   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 001060   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 001061   000010 036007                    ADLQ    8,DL
         2 001062   200241 756100                    STQ     RLT_SZ,,AUTO

      473    16173        /*
      474    16174           Move the input buffer upwards, and adjust the read vector also.
      475    16175        */
      476    16176    1       WOFF = RLT_SZ / 4 + %EXPND_PARSEWK/4 ;

  16176  2 001063   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 001064   000004 506007                    DIV     4,DL
         2 001065   000310 036007                    ADLQ    200,DL
         2 001066   200242 756100                    STQ     WOFF,,AUTO

      477    16177    1       WBUFSZ = %GDSSIZ - WOFF ;

  16177  2 001067   002000 235007                    LDA     1024,DL
         2 001070   200242 135100                    SBLA    WOFF,,AUTO
         2 001071   200243 755100                    STA     WBUFSZ,,AUTO

      478    16178    1       CALL MOVER (XUG.BUFVEC, WOFF, WBUFSZ) ;

  16178  2 001072   200243 631500                    EPPR1   WBUFSZ,,AUTO
         2 001073   200355 451500                    STP1    BADCHAR+1,,AUTO
         2 001074   200242 633500                    EPPR3   WOFF,,AUTO
         2 001075   200354 453500                    STP3    @QM_REQUIRED+1,,AUTO
         2 001076   200220 236100                    LDQ     XUG$,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:104  
         2 001077   200353 756100                    STQ     OUTDCB#+2,,AUTO
         2 001100   005315 701000 2                  TSX1    MOVER
         2 001101   000000 011000                    NOP     0

      479    16179    1       VBASE(XUG.READVEC) = PINCRW(VBASE(XUG.READVEC),WOFF) ;

  16179  2 001102   200220 470500                    LDP0    XUG$,,AUTO
         2 001103   000003 471500                    LDP1    3,,PR0
         2 001104   200242 720100                    LXL0    WOFF,,AUTO
         2 001105   100000 633510                    EPPR3   0,X0,PR1
         2 001106   000003 453500                    STP3    3,,PR0

      480    16180    1       VBOUND(XUG.READVEC) = VBOUND(XUG.READVEC) + (WBUFSZ * 4) ;

  16180  2 001107   000002 236100                    LDQ     2,,PR0
         2 001110   000020 772000                    QRL     16
         2 001111   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 001112   200243 236100                    LDQ     WBUFSZ,,AUTO
         2 001113   000002 736000                    QLS     2
         2 001114   200432 036100                    ADLQ    LEGAL_TEXTC+17,,AUTO
         2 001115   000020 736000                    QLS     16
         2 001116   000002 676100                    ERQ     2,,PR0
         2 001117   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001120   000002 656100                    ERSQ    2,,PR0

      481    16181    1       VBASE(XUG.LAST) = PINCRW(VBASE(XUG.LAST), WOFF) ;

  16181  2 001121   000005 471500                    LDP1    5,,PR0
         2 001122   200242 720100                    LXL0    WOFF,,AUTO
         2 001123   100000 633510                    EPPR3   0,X0,PR1
         2 001124   000005 453500                    STP3    5,,PR0

      482    16182        /*
      483    16183           Move the RLT upwards.  Expand the parse area to fill the new area at
      484    16184           the base of the non-static portion of the segment (no need to move data).
      485    16185        */
      486    16186    1       WOFF = %EXPND_PARSEWK/4 ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:105  

  16186  2 001125   000310 235007                    LDA     200,DL
         2 001126   200242 755100                    STA     WOFF,,AUTO

      487    16187    1       WBUFSZ = RLT_SZ / 4 ;

  16187  2 001127   200241 236100                    LDQ     RLT_SZ,,AUTO
         2 001130   000004 506007                    DIV     4,DL
         2 001131   200243 756100                    STQ     WBUFSZ,,AUTO

      488    16188    1       CALL MOVER(XUG.RLTVEC, WOFF, WBUFSZ) ;

  16188  2 001132   200243 631500                    EPPR1   WBUFSZ,,AUTO
         2 001133   200355 451500                    STP1    BADCHAR+1,,AUTO
         2 001134   200242 633500                    EPPR3   WOFF,,AUTO
         2 001135   200354 453500                    STP3    @QM_REQUIRED+1,,AUTO
         2 001136   200220 236100                    LDQ     XUG$,,AUTO
         2 001137   000012 036003                    ADLQ    10,DU
         2 001140   200353 756100                    STQ     OUTDCB#+2,,AUTO
         2 001141   005315 701000 2                  TSX1    MOVER
         2 001142   000000 011000                    NOP     0

      489    16189    1       XUG.RLTCNT = XUG.RLTCNT + XUG.ADDL_RLTCNT ;

  16189  2 001143   200220 470500                    LDP0    XUG$,,AUTO
         2 001144   000107 236100                    LDQ     71,,PR0
         2 001145   000110 036100                    ADLQ    72,,PR0
         2 001146   000107 756100                    STQ     71,,PR0

      490    16190    1       VBOUND(XUG.PARSEVEC) = VBOUND(XUG.PARSEVEC) + %EXPND_PARSEWK ;

  16190  2 001147   000010 236100                    LDQ     8,,PR0
         2 001150   000020 772000                    QRL     16
         2 001151   001440 036007                    ADLQ    800,DL
         2 001152   000020 736000                    QLS     16
         2 001153   000010 676100                    ERQ     8,,PR0
         2 001154   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:106  
         2 001155   000010 656100                    ERSQ    8,,PR0

      491    16191
      492    16192    1       RETURN ;

  16192  2 001156   000000 702200 xent               TSX2  ! X66_ARET

      493    16193
      494    16194    1   CANT_EXPAND_SEGMENT:
      495    16195
      496    16196    1       ALTRETURN;

  16196  2 001157   000000 702200 xent  CANT_EXPAND* TSX2  ! X66_AALT

      497    16197
      498    16198        %EJECT ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:107  
      499    16199    1   XUG$GETCMD_COMMON: ENTRY (GETCMD) ALTRET;

  16199  2 001160   000000 700200 xent  XUG$GETCMD_* TSX0  ! X66_AUTO_2
         2 001161   000440 000002                    ZERO    288,2

      500    16200    1       IF GETCMD.WORK$ = ADDR(NIL)

  16200  2 001162   200003 470500                    LDP0    @GETCMD,,AUTO
         2 001163   000004 236100                    LDQ     4,,PR0
         2 001164   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001165   001203 601000 2                  TNZ     s:16208

      501    16201    2       THEN DO;

      502    16202    2           XUG_INIT_A = XUG_INIT_C ;

  16202  2 001166   000100 100400                    MLR     fill='000'O
         2 001167   000210 000220 0                  ADSC9   XUG_INIT_C               cn=0,n=144
         2 001170   200154 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

      503    16203    2           CALL XUG$INIT_COMMON(GETCMD, XUG_INIT_A)

  16203  2 001171   200154 631500                    EPPR1   XUG_INIT_A,,AUTO
         2 001172   200433 451500                    STP1    LEGAL_TEXTC+18,,AUTO
         2 001173   200003 236100                    LDQ     @GETCMD,,AUTO
         2 001174   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 001175   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001176   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001177   000006 701000 2                  TSX1    s:15917
         2 001200   001202 702000 2                  TSX2    s:16205
         2 001201   001203 710000 2                  TRA     s:16208

      504    16204    3           WHENALTRETURN DO;

      505    16205    3               ALTRETURN;

  16205  2 001202   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:108  

      506    16206    3           END;
      507    16207    2       END ; /* Then Do */

      508    16208    1       XUG$ = GETCMD.WORK$ ;

  16208  2 001203   200003 470500                    LDP0    @GETCMD,,AUTO
         2 001204   000004 236100                    LDQ     4,,PR0
         2 001205   200220 756100                    STQ     XUG$,,AUTO

      509    16209    1       P_PCB$ = XUG.P_PCB$ ;

  16209  2 001206   200220 471500                    LDP1    XUG$,,AUTO
         2 001207   100072 236100                    LDQ     58,,PR1
         2 001210   200224 756100                    STQ     P_PCB$,,AUTO

      510    16210    1       IF GETCMD.NODES$ ~= ADDR(NIL)

  16210  2 001211   000000 236100                    LDQ     0,,PR0
         2 001212   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001213   001223 600000 2                  TZE     s:16238

      511    16211    1       THEN
      512    16212    1           IF GETCMD.NODES$ -> P$NODE.TYPE = 0

  16212  2 001214   000000 473500                    LDP3    0,,PR0
         2 001215   300000 236100                    LDQ     0,,PR3
         2 001216   700000 316003                    CANQ    -32768,DU
         2 001217   001223 601000 2                  TNZ     s:16238

      513    16213    2           THEN DO;

      514    16214    2               GETCMD.ERR# = XUG#PRE_C00;

  16214  2 001220   000205 236000 0                  LDQ     XUG#PRE_C00
         2 001221   000001 756100                    STQ     1,,PR0

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:109  
      515    16215        /*E*     ERROR:   XUG-E$PCB_PRE_C00
      516    16216                 MESSAGE: Parse control block is pre-C00;  cannot parse.
      517    16217                 MESSAGE1: The parse nodes passed to XUG$GETCMD or XUR$GETCMD appear
      518    16218                          to be of pre-C00 vintage.  The format of X$PARSE nodes
      519    16219                          (produced by PARTRGE) was changed substantially for the
      520    16220                          C00 version of CP-6, and pre-C00 nodes/PCBs/PARSE$BLKs
      521    16221                          (etc.) are not compatible with this parser.  Your program
      522    16222                          must be updated if you wish to run it on a D00 (or later)
      523    16223                          version of CP-6.  This will require:
      524    16224
      525    16225                          1) Recompiling all PL-6 routines that use any of the parser's
      526    16226                             data structures;
      527    16227
      528    16228                          2) Re-PARTRGEing all of the program's parse nodes;  and
      529    16229
      530    16230                          3) Re-LINKing the run unit.
      531    16231
      532    16232                          Please see the "CP-6 C00 System Release Bulletin", or the
      533    16233                          Host Library Services manual (CE71) for the necessary
      534    16234                          information and procedures.
      535    16235        */
      536    16236    2               ALTRETURN;

  16236  2 001222   000000 702200 xent               TSX2  ! X66_AALT

      537    16237    2           END;
      538    16238    1       XUG.USER$ = P_PCB.USER$ ;

  16238  2 001223   200224 473500                    LDP3    P_PCB$,,AUTO
         2 001224   300014 236100                    LDQ     12,,PR3
         2 001225   100076 756100                    STQ     62,,PR1

      539    16239    1       P_PCB.USER$ = ADDR(GETCMD) ;

  16239  2 001226   200003 236100                    LDQ     @GETCMD,,AUTO
         2 001227   300014 756100                    STQ     12,,PR3

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:110  
      540    16240    1       SAVE_PROMPT_ = GETCMD.PROMPT_;

  16240  2 001230   000100 100500                    MLR     fill='000'O
         2 001231   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         2 001232   200316 000010                    ADSC9   SAVE_PROMPT_,,AUTO       cn=0,n=8

      541    16241    1       SAVE_RPROMPT_ = GETCMD.RPROMPT_;

  16241  2 001233   000100 100500                    MLR     fill='000'O
         2 001234   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         2 001235   200320 000010                    ADSC9   SAVE_RPROMPT_,,AUTO      cn=0,n=8

      542    16242    1       SAVE_PROMPT_VFC = GETCMD.PROMPT_VFC#;

  16242  2 001236   000006 236100                    LDQ     6,,PR0
         2 001237   000005 736000                    QLS     5
         2 001240   400000 376003                    ANQ     -131072,DU
         2 001241   200322 756100                    STQ     SAVE_PROMPT_VFC,,AUTO

      543    16243    1       REMEMBER PARSEALT IN XUG.REM_PARSE;

  16243  2 001242   002560 635000 2                  EAA     PARSEALT
         2 001243   100014 452500                    STP2    12,,PR1
         2 001244   100015 755100                    STA     13,,PR1

      544    16244
      545    16245    1   GETCMD:
      546    16246    1       GETCMD.PROMPT_ = SAVE_PROMPT_;

  16246  2 001245   200003 470500       GETCMD       LDP0    @GETCMD,,AUTO
         2 001246   200316 237100                    LDAQ    SAVE_PROMPT_,,AUTO
         2 001247   000025 755100                    STA     21,,PR0
         2 001250   000026 756100                    STQ     22,,PR0

      547    16247    1       GETCMD.RPROMPT_ = SAVE_RPROMPT_;

  16247  2 001251   200320 237100                    LDAQ    SAVE_RPROMPT_,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:111  
         2 001252   000027 755100                    STA     23,,PR0
         2 001253   000030 756100                    STQ     24,,PR0

      548    16248    1       GETCMD.PROMPT_VFC# = SAVE_PROMPT_VFC;

  16248  2 001254   200322 236100                    LDQ     SAVE_PROMPT_VFC,,AUTO
         2 001255   000005 772000                    QRL     5
         2 001256   000006 676100                    ERQ     6,,PR0
         2 001257   010000 376003                    ANQ     4096,DU
         2 001260   000006 656100                    ERSQ    6,,PR0

      549    16249    1       XUG.NLINES=0;

  16249  2 001261   200220 471500                    LDP1    XUG$,,AUTO
         2 001262   100106 450100                    STZ     70,,PR1

      550    16250    2       IF GETCMD.INDCB#=DCBNUM(NIL) THEN DO;

  16250  2 001263   000012 235100                    LDA     10,,PR0
         2 001264   001275 601000 2                  TNZ     s:16253

      551    16251    2           CALL XUG$GETDCB_COMMON(M$SI,GETCMD.INDCB#) ALTRET(MALT);

  16251  2 001265   200003 236100                    LDQ     @GETCMD,,AUTO
         2 001266   000012 036003                    ADLQ    10,DU
         2 001267   000013 235000 3                  LDA     11
         2 001270   200432 757100                    STAQ    LEGAL_TEXTC+17,,AUTO
         2 001271   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001272   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001273   000000 701000 xent               TSX1    XUG$GETDCB_COMMON
         2 001274   002543 702000 2                  TSX2    MALT

      552    16252    2       END;

      553    16253    2       IF GETCMD.OUTDCB#=DCBNUM(NIL) THEN DO;

  16253  2 001275   200003 470500                    LDP0    @GETCMD,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:112  
         2 001276   000013 235100                    LDA     11,,PR0
         2 001277   001310 601000 2                  TNZ     s:16256

      554    16254    2           CALL XUG$GETDCB_COMMON(M$LO,GETCMD.OUTDCB#) ALTRET(MALT);

  16254  2 001300   200003 236100                    LDQ     @GETCMD,,AUTO
         2 001301   000013 036003                    ADLQ    11,DU
         2 001302   000016 235000 3                  LDA     14
         2 001303   200432 757100                    STAQ    LEGAL_TEXTC+17,,AUTO
         2 001304   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001305   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001306   000000 701000 xent               TSX1    XUG$GETDCB_COMMON
         2 001307   002543 702000 2                  TSX2    MALT

      555    16255    2       END;

      556    16256    1       GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;

  16256  2 001310   200003 470500                    LDP0    @GETCMD,,AUTO
         2 001311   000013 235100                    LDA     11,,PR0
         2 001312   000014 755100                    STA     12,,PR0

      557    16257    1       P_PCB.OUTDCB# = GETCMD.OUTDCB# ;

  16257  2 001313   200224 471500                    LDP1    P_PCB$,,AUTO
         2 001314   000013 236100                    LDQ     11,,PR0
         2 001315   100010 676100                    ERQ     8,,PR1
         2 001316   037777 376007                    ANQ     16383,DL
         2 001317   100010 656100                    ERSQ    8,,PR1

      558    16258    1       XUG.DCBS = '0'B;

  16258  2 001320   200220 473500                    LDP3    XUG$,,AUTO
         2 001321   000100 100400                    MLR     fill='000'O
         2 001322   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 001323   300113 000120                    ADSC9   75,,PR3                  cn=0,n=80

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:113  
      559    16259    1       XUG.DCBS.NUM(0)=GETCMD.INDCB#;

  16259  2 001324   000012 720100                    LXL0    10,,PR0
         2 001325   300113 740100                    STX0    75,,PR3

      560    16260    1       XUG.DCBS.NUM(1)=GETCMD.OUTDCB#;

  16260  2 001326   000013 721100                    LXL1    11,,PR0
         2 001327   300115 741100                    STX1    77,,PR3

      561    16261    1       XUG.DCBS.ERRPTR_CPOS(0) = -1 ;

  16261  2 001330   777777 222003                    LDX2    -1,DU
         2 001331   300113 442100                    SXL2    75,,PR3

      562    16262    1       XUG.NDCBS=0;

  16262  2 001332   300112 450100                    STZ     74,,PR3

      563    16263    1       CALL XUG$SETPROMPT (GETCMD) ALTRET(MALT) ;

  16263  2 001333   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 001334   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001335   005071 701000 2                  TSX1    s:16997
         2 001336   002543 702000 2                  TSX2    MALT

      564    16264    1       IF GETCMD.SFROUTINE$=ENTADDR(NIL) THEN XUG.SFROUTINE=ENTADDR(NIL);

  16264  2 001337   200003 470500                    LDP0    @GETCMD,,AUTO
         2 001340   000033 236100                    LDQ     27,,PR0
         2 001341   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 001342   001347 601000 2                  TNZ     s:16265

  16264  2 001343   000002 236000 xsym               LDQ     B_VECTNIL+2
         2 001344   200220 471500                    LDP1    XUG$,,AUTO
         2 001345   100024 756100                    STQ     20,,PR1
         2 001346   001351 710000 2                  TRA     s:16266
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:114  

      565    16265    1       ELSE XUG.SFROUTINE=GETCMD.SFROUTINE$ ;

  16265  2 001347   200220 471500                    LDP1    XUG$,,AUTO
         2 001350   100024 756100                    STQ     20,,PR1

      566    16266    1       XUG.READVEC=XUG.BUFVEC;

  16266  2 001351   100000 237100                    LDAQ    0,,PR1
         2 001352   100002 757100                    STAQ    2,,PR1

      567    16267    1       XUG.CPOS=0;

  16267  2 001353   100104 450100                    STZ     68,,PR1

      568    16268    1       XUG.CCBUF_OFFC = 0 ;

  16268  2 001354   000000 220003                    LDX0    0,DU
         2 001355   100267 740100                    STX0    183,,PR1

      569    16269    1       XUG.PP_ERR = '0'B;

  16269  2 001356   100100 450100                    STZ     64,,PR1

      570    16270    1       XUG.FIRST_ERROR = %NO#;

  16270  2 001357   000017 236000 3                  LDQ     15
         2 001360   100071 356100                    ANSQ    57,,PR1

      571    16271    1       GETCMD.EOMCHAR# = %EOM_EOR#;

  16271  2 001361   501000 236007                    LDQ     -97792,DL
         2 001362   000007 552110                    STBQ    7,'10'O,PR0

      572    16272    1       GETCMD.CONTINUED# = %NO# ;

  16272  2 001363   000020 236000 3                  LDQ     16
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:115  
         2 001364   000006 356100                    ANSQ    6,,PR0

      573    16273    1       GETCMD.RCVD_PROMPT# = %NO# ;

  16273  2 001365   000021 236000 3                  LDQ     17
         2 001366   000006 356100                    ANSQ    6,,PR0

      574    16274    1       GETCMD.ERR# = '0'B ;

  16274  2 001367   000001 450100                    STZ     1,,PR0

      575    16275    1       IF XUG.SYNERR

  16275  2 001370   100071 236100                    LDQ     57,,PR1
         2 001371   004000 316003                    CANQ    2048,DU
         2 001372   001377 600000 2                  TZE     s:16278

      576    16276    1       THEN
      577    16277    1           TWOCHARS=SUBSTR(VBASE(XUG.BUFVEC)->INBUF,0,2);

  16277  2 001373   100001 473500                    LDP3    1,,PR1
         2 001374   040100 100500                    MLR     fill='040'O
         2 001375   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2
         2 001376   200247 000002                    ADSC9   TWOCHARS,,AUTO           cn=0,n=2

      578    16278    1       IF GETCMD.TEXT_=VECTOR(NIL) THEN

  16278  2 001377   000034 237100                    LDAQ    28,,PR0
         2 001400   000004 117000 3                  CMPAQ   4
         2 001401   001761 601000 2                  TNZ     s:16368

      579    16279    2           IF XUG.GOTCMD THEN DO;

  16279  2 001402   100071 236100                    LDQ     57,,PR1
         2 001403   100000 316003                    CANQ    32768,DU
         2 001404   001520 600000 2                  TZE     s:16306

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:116  
      580    16280    2               XUG.GOTCMD='0'B;

  16280  2 001405   000020 236000 3                  LDQ     16
         2 001406   100071 356100                    ANSQ    57,,PR1

      581    16281    2               ARS = XUG.BRKARS;

  16281  2 001407   100101 235100                    LDA     65,,PR1
         2 001410   200244 755100                    STA     ARS,,AUTO

      582    16282    2               GETCMD.EOMCHAR# = XUG.GOTCMD_EOMCHAR;

  16282  2 001411   100266 236100                    LDQ     182,,PR1
         2 001412   000022 772000                    QRL     18
         2 001413   000007 552110                    STBQ    7,'10'O,PR0

      583    16283    2               XUG.BRKARS = 0;

  16283  2 001414   100101 450100                    STZ     65,,PR1

      584    16284    2               IF (NOT GETCMD.SKIP_PREPROCESS#) AND XUG.PREPROCESS

  16284  2 001415   000006 236100                    LDQ     6,,PR0
         2 001416   004000 316003                    CANQ    2048,DU
         2 001417   001453 601000 2                  TNZ     s:16295
         2 001420   100071 236100                    LDQ     57,,PR1
         2 001421   002000 316003                    CANQ    1024,DU
         2 001422   001453 600000 2                  TZE     s:16295

      585    16285    3               THEN DO;

      586    16286    3                   IF XUG.PREPROCESSOR$$ ~= ENTADDR(NIL)

  16286  2 001423   100023 236100                    LDQ     19,,PR1
         2 001424   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 001425   001442 600000 2                  TZE     s:16292

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:117  
      587    16287    4                   THEN DO;

      588    16288    4                       CALL XUG$PRE_PROCESSOR (GETCMD,ARS);

  16288  2 001426   200244 633500                    EPPR3   ARS,,AUTO
         2 001427   200433 453500                    STP3    LEGAL_TEXTC+18,,AUTO
         2 001430   200003 236100                    LDQ     @GETCMD,,AUTO
         2 001431   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 001432   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001433   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001434   000000 701000 xent               TSX1    XUG$PRE_PROCESSOR
         2 001435   000000 011000                    NOP     0

      589    16289    4                       CALL X66_REL_AUTO;

  16289  2 001436   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001437   000000 701000 xent               TSX1    X66_REL_AUTO
         2 001440   000000 011000                    NOP     0

      590    16290    4                   END;

  16290  2 001441   001455 710000 2                  TRA     s:16296

      591    16291    3                   ELSE
      592    16292    3                       CALL XUG$PP_CMDVARS (GETCMD,ARS);

  16292  2 001442   200244 633500                    EPPR3   ARS,,AUTO
         2 001443   200433 453500                    STP3    LEGAL_TEXTC+18,,AUTO
         2 001444   200003 236100                    LDQ     @GETCMD,,AUTO
         2 001445   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 001446   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001447   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001450   000000 701000 xent               TSX1    XUG$PP_CMDVARS
         2 001451   000000 011000                    NOP     0

      593    16293    3               END;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:118  
  16293  2 001452   001455 710000 2                  TRA     s:16296

      594    16294    2               ELSE
      595    16295    2                   GETCMD.SKIP_PREPROCESS# = '0'B ;

  16295  2 001453   000022 236000 3                  LDQ     18
         2 001454   000006 356100                    ANSQ    6,,PR0

      596    16296    2               VBOUND(XUG.READVEC) = ARS - 1;

  16296  2 001455   200220 470500                    LDP0    XUG$,,AUTO
         2 001456   200244 236100                    LDQ     ARS,,AUTO
         2 001457   000001 136007                    SBLQ    1,DL
         2 001460   000020 736000                    QLS     16
         2 001461   000002 676100                    ERQ     2,,PR0
         2 001462   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001463   000002 656100                    ERSQ    2,,PR0

      597    16297    2               CALL XUG$SETLAST(GETCMD);

  16297  2 001464   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 001465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001466   000000 701000 xent               TSX1    XUG$SETLAST
         2 001467   000000 011000                    NOP     0

      598    16298    2               GETCMD.TREAD# = %YES# ;

  16298  2 001470   200003 470500                    LDP0    @GETCMD,,AUTO
         2 001471   200000 236003                    LDQ     65536,DU
         2 001472   000006 256100                    ORSQ    6,,PR0

      599    16299    2               IF NOT (DCBADDR(GETCMD.OUTDCB#)-> F$DCB.DDEV.UCOUT# OR

  16299  2 001473   000023 471400 3                  LDP1    19
         2 001474   100000 473500                    LDP3    0,,PR1
         2 001475   000013 720100                    LXL0    11,,PR0
         2 001476   300000 474510                    LDP4    0,X0,PR3
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:119  
         2 001477   400004 236100                    LDQ     4,,PR4
         2 001500   020000 316007                    CANQ    8192,DL
         2 001501   001513 601000 2                  TNZ     s:16303
         2 001502   000000 236007 xsym               LDQ     M$UC,DL
         2 001503   300000 475506                    LDP5    0,QL,PR3
         2 001504   500003 236100                    LDQ     3,,PR5
         2 001505   020000 316003                    CANQ    8192,DU
         2 001506   001513 601000 2                  TNZ     s:16303

      600    16300    2                 DCBADDR(DCBNUM(M$UC)) -> F$DCB.DVBYTE.TRANS#)
      601    16301    2               THEN
      602    16302    2                   CALL XUG$ECHOLAST_COMMON (GETCMD);

  16302  2 001507   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 001510   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001511   000000 701000 xent               TSX1    XUG$ECHOLAST_COMMON
         2 001512   000000 011000                    NOP     0

      603    16303    2               XUG.DCBS.NUM(0)=DCBNUM(M$UC);

  16303  2 001513   000000 236007 xsym               LDQ     M$UC,DL
         2 001514   000000 620006                    EAX0    0,QL
         2 001515   200220 470500                    LDP0    XUG$,,AUTO
         2 001516   000113 740100                    STX0    75,,PR0

      604    16304    2           END;

  16304  2 001517   002237 710000 2                  TRA     s:16434

      605    16305    2           ELSE DO;

      606    16306    2               CALL XUG$DISABLE_COMMON(GETCMD);

  16306  2 001520   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 001521   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001522   000000 701000 xent               TSX1    XUG$DISABLE_COMMON
         2 001523   000000 011000                    NOP     0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:120  

      607    16307    2               CALL XUG$READCMD_COMMON(GETCMD,XUG.READVEC,ARS) ALTRET(RDALT1);

  16307  2 001524   200244 630500                    EPPR0   ARS,,AUTO
         2 001525   200434 450500                    STP0    LEGAL_TEXTC+19,,AUTO
         2 001526   200220 236100                    LDQ     XUG$,,AUTO
         2 001527   000002 036003                    ADLQ    2,DU
         2 001530   200003 235100                    LDA     @GETCMD,,AUTO
         2 001531   200432 757100                    STAQ    LEGAL_TEXTC+17,,AUTO
         2 001532   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001533   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001534   000000 701000 xent               TSX1    XUG$READCMD_COMMON
         2 001535   003101 702000 2                  TSX2    RDALT1

      608    16308    3               DO WHILE XUG.SYNERR;

  16308  2 001536   200220 470500                    LDP0    XUG$,,AUTO
         2 001537   000071 236100                    LDQ     57,,PR0
         2 001540   004000 316003                    CANQ    2048,DU
         2 001541   001754 600000 2                  TZE     s:16365

      609    16309    4                   IF ARS=1 AND SUBSTR(VBASE(XUG.BUFVEC)->INBUF,0,1)='?' THEN DO;

  16309  2 001542   200244 235100                    LDA     ARS,,AUTO
         2 001543   000001 115007                    CMPA    1,DL
         2 001544   001745 601000 2                  TNZ     s:16363
         2 001545   200220 470500                    LDP0    XUG$,,AUTO
         2 001546   000001 471500                    LDP1    1,,PR0
         2 001547   040000 106500                    CMPC    fill='040'O
         2 001550   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 001551   000024 000001 3                  ADSC9   20                       cn=0,n=1
         2 001552   001745 601000 2                  TNZ     s:16363

      610    16310    4   SHOW_ALTRN:
      611    16311    4                       IF XUG.PRE_EXEC ~= ENTADDR(NIL)

  16311  2 001553   200220 470500       SHOW_ALTRN   LDP0    XUG$,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:121  
         2 001554   000026 236100                    LDQ     22,,PR0
         2 001555   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 001556   001570 600000 2                  TZE     s:16314

      612    16312    4                       THEN
      613    16313    4                           CALL XUG.PRE_EXEC (GETCMD, %XUG_CMD_Q1);

  16313  2 001557   000025 236000 3                  LDQ     21
         2 001560   200003 235100                    LDA     @GETCMD,,AUTO
         2 001561   200432 757100                    STAQ    LEGAL_TEXTC+17,,AUTO
         2 001562   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001563   200220 471500                    LDP1    XUG$,,AUTO
         2 001564   100026 220100                    LDX0    22,,PR1
         2 001565   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001566   000000 701010                    TSX1    0,X0
         2 001567   000000 011000                    NOP     0

      614    16314    4                       CALL INSERT(VBASE(XUG.BUFVEC)->INBUF,0,2,TWOCHARS);

  16314  2 001570   200220 470500                    LDP0    XUG$,,AUTO
         2 001571   000001 471500                    LDP1    1,,PR0
         2 001572   040100 100500                    MLR     fill='040'O
         2 001573   200247 000002                    ADSC9   TWOCHARS,,AUTO           cn=0,n=2
         2 001574   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      615    16315    4                       IF XUG.DOCMD_SYNERR

  16315  2 001575   000071 236100                    LDQ     57,,PR0
         2 001576   000100 316003                    CANQ    64,DU
         2 001577   002372 601000 2                  TNZ     NORMAL_PARSE

      616    16316    4                       THEN
      617    16317    4                           GOTO NORMAL_PARSE ;
      618    16318    4                       IF XUG.NEED_ECHO AND GETCMD.TEXT_ = VECTOR(NIL)

  16318  2 001600   000020 316003                    CANQ    16,DU
         2 001601   001631 600000 2                  TZE     ALT_OUT
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:122  
         2 001602   200003 471500                    LDP1    @GETCMD,,AUTO
         2 001603   100034 237100                    LDAQ    28,,PR1
         2 001604   000004 117000 3                  CMPAQ   4
         2 001605   001631 601000 2                  TNZ     ALT_OUT

      619    16319    5                       THEN DO;

      620    16320    5                           XUG.NLINES = 1 ;

  16320  2 001606   000001 235007                    LDA     1,DL
         2 001607   000106 755100                    STA     70,,PR0

      621    16321    5                           VBASE(XUG.RLTVEC)->RLT(1) = 1 ;

  16321  2 001610   000013 473500                    LDP3    11,,PR0
         2 001611   000100 101400                    MRL     fill='000'O
         2 001612   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         2 001613   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1

      622    16322    5                           SUBSTR(VBASE(XUG.BUFVEC)->INBUF,0,1) = '?' ;

  16322  2 001614   000001 473500                    LDP3    1,,PR0
         2 001615   040100 100400                    MLR     fill='040'O
         2 001616   000024 000001 3                  ADSC9   20                       cn=0,n=1
         2 001617   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      623    16323    5                           CALL XUG$ECHO_COMMON(GETCMD) ;

  16323  2 001620   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 001621   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001622   004472 701000 2                  TSX1    s:16911
         2 001623   000000 011000                    NOP     0

      624    16324    5                           SUBSTR(VBASE(XUG.BUFVEC)->INBUF,0,1) = SUBSTR(TWOCHARS,0,1)
             16324                                    ;

  16324  2 001624   200220 470500                    LDP0    XUG$,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:123  
         2 001625   000001 471500                    LDP1    1,,PR0
         2 001626   040100 100500                    MLR     fill='040'O
         2 001627   200247 000001                    ADSC9   TWOCHARS,,AUTO           cn=0,n=1
         2 001630   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      625    16325    5                       END;

      626    16326    4   ALT_OUT:            P_PCB.NXT = '1'B;

  16326  2 001631   200224 470500       ALT_OUT      LDP0    P_PCB$,,AUTO
         2 001632   040000 236007                    LDQ     16384,DL
         2 001633   000005 256100                    ORSQ    5,,PR0

      627    16327    4                       IF GETCMD.SYNERR_NODES$ ~= ADDR(NIL)

  16327  2 001634   200003 471500                    LDP1    @GETCMD,,AUTO
         2 001635   100042 236100                    LDQ     34,,PR1
         2 001636   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001637   001641 600000 2                  TZE     s:16330

      628    16328    4                       THEN
      629    16329    4                           P_PCB.ROOT$ = GETCMD.SYNERR_NODES$;

  16329  2 001640   000001 756100                    STQ     1,,PR0

      630    16330    4                       P_PCB.USER$ = ADDR(GETCMD) ;

  16330  2 001641   200003 236100                    LDQ     @GETCMD,,AUTO
         2 001642   000014 756100                    STQ     12,,PR0

      631    16331    4                       IF XUG.SPELLING AND NOT XUG.SPELLING_TRIED

  16331  2 001643   200220 473500                    LDP3    XUG$,,AUTO
         2 001644   300071 236100                    LDQ     57,,PR3
         2 001645   000002 316003                    CANQ    2,DU
         2 001646   001655 600000 2                  TZE     s:16334
         2 001647   000001 316003                    CANQ    1,DU
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:124  
         2 001650   001655 601000 2                  TNZ     s:16334

      632    16332    4                       THEN
      633    16333    4                           CALL SPELLING_CHECKER (%NO#) ALTRET (READ_ANOTHER);

  16333  2 001651   000015 236000 3                  LDQ     13
         2 001652   200353 756100                    STQ     OUTDCB#+2,,AUTO
         2 001653   006010 701000 2                  TSX1    SPELLING_CHECKER
         2 001654   001671 702000 2                  TSX2    READ_ANOTHER

      634    16334    4                       XUG.SYNERR = %NO#;

  16334  2 001655   200220 470500                    LDP0    XUG$,,AUTO
         2 001656   000022 236000 3                  LDQ     18
         2 001657   000071 356100                    ANSQ    57,,PR0

      635    16335    4                       GETCMD.ERR_CODE = XUG#LEGAL_INPUT_HERE;

  16335  2 001660   000173 236000 0                  LDQ     XUG#LEGAL_INPUT_HERE
         2 001661   200003 471500                    LDP1    @GETCMD,,AUTO
         2 001662   100010 756100                    STQ     8,,PR1

      636    16336    4                       CALL XUG$ERRMSG_COMMON (GETCMD);

  16336  2 001663   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 001664   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001665   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 001666   000000 011000                    NOP     0

      637    16337        /*E*  ERROR:   XUG-E$XUG#LEGAL_INPUT_HERE
      638    16338              MESSAGE0:Legal input at the point of error could be any of the following:
      639    16339        */
      640    16340    4                       CALL REPORT_ALTERNATIVES;

  16340  2 001667   005367 701000 2                  TSX1    REPORT_ALTERNATIVES
         2 001670   000000 011000                    NOP     0

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:125  
      641    16341    4   READ_ANOTHER:       IF XUG.POST_EXEC ~= ENTADDR(NIL)

  16341  2 001671   200220 470500       READ_ANOTHER LDP0    XUG$,,AUTO
         2 001672   000027 236100                    LDQ     23,,PR0
         2 001673   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 001674   001706 600000 2                  TZE     s:16344

      642    16342    4                       THEN
      643    16343    4                           CALL XUG.POST_EXEC (GETCMD, %XUG_CMD_Q1);

  16343  2 001675   000025 236000 3                  LDQ     21
         2 001676   200003 235100                    LDA     @GETCMD,,AUTO
         2 001677   200432 757100                    STAQ    LEGAL_TEXTC+17,,AUTO
         2 001700   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001701   200220 471500                    LDP1    XUG$,,AUTO
         2 001702   100027 220100                    LDX0    23,,PR1
         2 001703   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001704   000000 701010                    TSX1    0,X0
         2 001705   000000 011000                    NOP     0

      644    16344    4                       P_PCB.USER$ = XUG.USER$ ;

  16344  2 001706   200220 470500                    LDP0    XUG$,,AUTO
         2 001707   000076 236100                    LDQ     62,,PR0
         2 001710   200224 471500                    LDP1    P_PCB$,,AUTO
         2 001711   100014 756100                    STQ     12,,PR1

      645    16345    4                       P_PCB.NXT='0'B;

  16345  2 001712   000026 236000 3                  LDQ     22
         2 001713   100005 356100                    ANSQ    5,,PR1

      646    16346    4                       IF GETCMD.TEXT_ = VECTOR(NIL)

  16346  2 001714   200003 473500                    LDP3    @GETCMD,,AUTO
         2 001715   300034 237100                    LDAQ    28,,PR3
         2 001716   000004 117000 3                  CMPAQ   4
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:126  
         2 001717   001737 601000 2                  TNZ     s:16354

      647    16347    5                       THEN DO;

      648    16348    5                           GETCMD.CONTINUED# = %NO#;

  16348  2 001720   000020 236000 3                  LDQ     16
         2 001721   300006 356100                    ANSQ    6,,PR3

      649    16349    5                           GETCMD.RCVD_PROMPT# = %NO#;

  16349  2 001722   000021 236000 3                  LDQ     17
         2 001723   300006 356100                    ANSQ    6,,PR3

      650    16350    5                           CALL XUG$READCMD_COMMON(GETCMD,XUG.READVEC,ARS)

  16350  2 001724   200244 634500                    EPPR4   ARS,,AUTO
         2 001725   200434 454500                    STP4    LEGAL_TEXTC+19,,AUTO
         2 001726   200220 236100                    LDQ     XUG$,,AUTO
         2 001727   000002 036003                    ADLQ    2,DU
         2 001730   200003 235100                    LDA     @GETCMD,,AUTO
         2 001731   200432 757100                    STAQ    LEGAL_TEXTC+17,,AUTO
         2 001732   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 001733   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001734   000000 701000 xent               TSX1    XUG$READCMD_COMMON
         2 001735   003101 702000 2                  TSX2    RDALT1

      651    16351    5                             ALTRET(RDALT1);
      652    16352    5                       END;

  16352  2 001736   001750 710000 2                  TRA     s:16364

      653    16353    5                       ELSE DO;

      654    16354    5                           IF GETCMD.ERR# = '0'B

  16354  2 001737   300001 235100                    LDA     1,,PR3
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:127  
         2 001740   001744 601000 2                  TNZ     s:16359

      655    16355    6                           THEN DO;

      656    16356    6                               GETCMD.OUT$ = ADDR(NIL) ;

  16356  2 001741   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001742   300001 756100                    STQ     1,,PR3

      657    16357    6                               GOTO GETCMD_RET ;

  16357  2 001743   002522 710000 2                  TRA     GETCMD_RET

      658    16358    6                           END;
      659    16359    5                           GOTO GETCMD_ALT1 ;

  16359  2 001744   003074 710000 2                  TRA     GETCMD_ALT1

      660    16360    5                       END;
      661    16361    4                   END;
      662    16362    3                   ELSE
      663    16363    3                       XUG.SYNERR = %NO#;

  16363  2 001745   200220 470500                    LDP0    XUG$,,AUTO
         2 001746   000022 236000 3                  LDQ     18
         2 001747   000071 356100                    ANSQ    57,,PR0

      664    16364    3               END;

  16364  2 001750   200220 470500                    LDP0    XUG$,,AUTO
         2 001751   000071 236100                    LDQ     57,,PR0
         2 001752   004000 316003                    CANQ    2048,DU
         2 001753   001542 601000 2                  TNZ     s:16309

      665    16365    2               CALL XUG$CLRENABLE_COMMON(GETCMD) ;

  16365  2 001754   200003 630500                    EPPR0   @GETCMD,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:128  
         2 001755   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001756   000000 701000 xent               TSX1    XUG$CLRENABLE_COMMON
         2 001757   000000 011000                    NOP     0

      666    16366    2           END;

  16366  2 001760   002237 710000 2                  TRA     s:16434

      667    16367    2       ELSE DO;

      668    16368    2           J = 0;

  16368  2 001761   200251 450100                    STZ     J,,AUTO

      669    16369    2           IF VBASE(GETCMD.TEXT_) = ADDR(NIL) /* eg, VECTOR(ERASE) */

  16369  2 001762   000035 236100                    LDQ     29,,PR0
         2 001763   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 001764   001772 601000 2                  TNZ     s:16375

      670    16370    3           THEN DO;

      671    16371    3               CSIZE = 0;

  16371  2 001765   200254 450100                    STZ     CSIZE,,AUTO

      672    16372    3               TEXT$ = ADDR(XUG.BUF);

  16372  2 001766   200220 236100                    LDQ     XUG$,,AUTO
         2 001767   000300 036003                    ADLQ    192,DU
         2 001770   200230 756100                    STQ     TEXT$,,AUTO

      673    16373    3           END;

  16373  2 001771   002126 710000 2                  TRA     s:16411

      674    16374    3           ELSE DO;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:129  

      675    16375    3               CSIZE=VBOUND(GETCMD.TEXT_)+1 ;

  16375  2 001772   000034 236100                    LDQ     28,,PR0
         2 001773   000020 772000                    QRL     16
         2 001774   000001 036007                    ADLQ    1,DL
         2 001775   200254 756100                    STQ     CSIZE,,AUTO

      676    16376    3               IF CSIZE > XUG.CMDSZ

  16376  2 001776   002005 604000 2                  TMI     s:16384
         2 001777   100111 116100                    CMPQ    73,,PR1
         2 002000   002005 602000 2                  TNC     s:16384
         2 002001   002005 600000 2                  TZE     s:16384

      677    16377    4               THEN DO;

      678    16378    4                   GETCMD.ERR# = XUG#LINETOOLONG;

  16378  2 002002   000206 236000 0                  LDQ     XUG#LINETOOLONG
         2 002003   000001 756100                    STQ     1,,PR0

      679    16379    4                   GOTO GETCMD_ALT;

  16379  2 002004   003071 710000 2                  TRA     GETCMD_ALT

      680    16380    4               END;
      681    16381        /*E* ERROR: XUG-E$XUG#LINETOOLONG
      682    16382             MESSAGE: Command line is too long.
      683    16383        */
      684    16384    3               SEG$ = VBASE( GETCMD.TEXT_ );

  16384  2 002005   000035 236100                    LDQ     29,,PR0
         2 002006   200232 756100                    STQ     SEG$,,AUTO

      685    16385    3               IF RSEG.SID = %JITSID

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:130  
  16385  2 002007   200232 236100                    LDQ     SEG$,,AUTO
         2 002010   007777 376007                    ANQ     4095,DL
         2 002011   006001 116007                    CMPQ    3073,DL
         2 002012   002054 601000 2                  TNZ     s:16393
         2 002013   000000 236000 xsym               LDQ     B$JIT$
         2 002014   000033 036003                    ADLQ    27,DU
         2 002015   200232 116100                    CMPQ    SEG$,,AUTO
         2 002016   002054 603000 2                  TRC     s:16393
         2 002017   000000 236000 xsym               LDQ     B$JIT$
         2 002020   000133 036003                    ADLQ    91,DU
         2 002021   200232 116100                    CMPQ    SEG$,,AUTO
         2 002022   002054 602000 2                  TNC     s:16393
         2 002023   002054 600000 2                  TZE     s:16393

      686    16386    3                 AND SEG$ > ADDR( B$JIT.CCBUF )
      687    16387    3                 AND SEG$ < PINCRC( ADDR( B$JIT.CCBUF ), SIZEC( B$JIT.CCBUF ))
      688    16388    4               THEN DO;

      689    16389    4                   XUG.CCBUF_OFFC = POFFC( SEG$ , ADDR( B$JIT.CCBUF ));

  16389  2 002024   000000 236000 xsym               LDQ     B$JIT$
         2 002025   000033 036003                    ADLQ    27,DU
         2 002026   000020 772000                    QRL     16
         2 002027   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 002030   200232 236100                    LDQ     SEG$,,AUTO
         2 002031   000020 772000                    QRL     16
         2 002032   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 002033   000000 621006                    EAX1    0,QL
         2 002034   100267 741100                    STX1    183,,PR1

      690    16390    4                   XUG.CCBUF_REST = B$JIT.CCARS - XUG.CCBUF_OFFC -

  16390  2 002035   100267 236100                    LDQ     183,,PR1
         2 002036   000022 732000                    QRS     18
         2 002037   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 002040   000000 473400 xsym               LDP3    B$JIT$
         2 002041   300032 236100                    LDQ     26,,PR3
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:131  
         2 002042   000022 732000                    QRS     18
         2 002043   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 002044   200433 756100                    STQ     LEGAL_TEXTC+18,,AUTO
         2 002045   000034 236100                    LDQ     28,,PR0
         2 002046   000020 772000                    QRL     16
         2 002047   200434 756100                    STQ     LEGAL_TEXTC+19,,AUTO
         2 002050   200433 236100                    LDQ     LEGAL_TEXTC+18,,AUTO
         2 002051   200434 136100                    SBLQ    LEGAL_TEXTC+19,,AUTO
         2 002052   777777 621006                    EAX1    -1,QL
         2 002053   100267 441100                    SXL1    183,,PR1

      691    16391    4                     VBOUND( GETCMD.TEXT_ ) - 1 ;
      692    16392    4               END;

      693    16393    3               IF (NOT GETCMD.SKIP_PREPROCESS#) AND XUG.PREPROCESS

  16393  2 002054   000006 236100                    LDQ     6,,PR0
         2 002055   004000 316003                    CANQ    2048,DU
         2 002056   002122 601000 2                  TNZ     DONT_PRE_PROC
         2 002057   100071 236100                    LDQ     57,,PR1
         2 002060   002000 316003                    CANQ    1024,DU
         2 002061   002122 600000 2                  TZE     DONT_PRE_PROC

      694    16394    4               THEN DO;

      695    16395    4                   XUG.BUF = VBASE(GETCMD.TEXT_)->CHARBASE ;

  16395  2 002062   000035 473500                    LDP3    29,,PR0
         2 002063   200254 721100                    LXL1    CSIZE,,AUTO
         2 002064   040100 100540                    MLR     fill='040'O
         2 002065   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         2 002066   100300 000454                    ADSC9   192,,PR1                 cn=0,n=300

      696    16396    4                   IF XUG.PREPROCESSOR$$ ~= ENTADDR(NIL)

  16396  2 002067   100023 236100                    LDQ     19,,PR1
         2 002070   000002 116000 xsym               CMPQ    B_VECTNIL+2
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:132  
         2 002071   002106 600000 2                  TZE     s:16402

      697    16397    5                   THEN DO;

      698    16398    5                       CALL XUG$PRE_PROCESSOR (GETCMD, CSIZE) ;

  16398  2 002072   200254 633500                    EPPR3   CSIZE,,AUTO
         2 002073   200433 453500                    STP3    LEGAL_TEXTC+18,,AUTO
         2 002074   200003 236100                    LDQ     @GETCMD,,AUTO
         2 002075   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 002076   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 002077   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002100   000000 701000 xent               TSX1    XUG$PRE_PROCESSOR
         2 002101   000000 011000                    NOP     0

      699    16399    5                       CALL X66_REL_AUTO;

  16399  2 002102   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002103   000000 701000 xent               TSX1    X66_REL_AUTO
         2 002104   000000 011000                    NOP     0

      700    16400    5                   END;

  16400  2 002105   002116 710000 2                  TRA     s:16403

      701    16401    4                   ELSE
      702    16402    4                       CALL XUG$PP_CMDVARS (GETCMD, CSIZE) ;

  16402  2 002106   200254 633500                    EPPR3   CSIZE,,AUTO
         2 002107   200433 453500                    STP3    LEGAL_TEXTC+18,,AUTO
         2 002110   200003 236100                    LDQ     @GETCMD,,AUTO
         2 002111   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 002112   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 002113   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002114   000000 701000 xent               TSX1    XUG$PP_CMDVARS
         2 002115   000000 011000                    NOP     0

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:133  
      703    16403    4                   TEXT$ = ADDR(XUG.BUF);

  16403  2 002116   200220 236100                    LDQ     XUG$,,AUTO
         2 002117   000300 036003                    ADLQ    192,DU
         2 002120   200230 756100                    STQ     TEXT$,,AUTO

      704    16404    4               END ;

  16404  2 002121   002126 710000 2                  TRA     s:16411

      705    16405    4               ELSE DO;

      706    16406    4   DONT_PRE_PROC:
      707    16407    4                   GETCMD.SKIP_PREPROCESS# = '0'B ;

  16407  2 002122   000022 236000 3     DONT_PRE_PR* LDQ     18
         2 002123   000006 356100                    ANSQ    6,,PR0

      708    16408    4                   TEXT$ = VBASE(GETCMD.TEXT_);

  16408  2 002124   000035 236100                    LDQ     29,,PR0
         2 002125   200230 756100                    STQ     TEXT$,,AUTO

      709    16409    4               END;

      710    16410    3           END ;

      711    16411    2           IF CSIZE>=XUG.POFF AND

  16411  2 002126   200220 470500                    LDP0    XUG$,,AUTO
         2 002127   200254 236100                    LDQ     CSIZE,,AUTO
         2 002130   000036 116100                    CMPQ    30,,PR0
         2 002131   002154 604000 2                  TMI     s:16419
         2 002132   000036 720100                    LXL0    30,,PR0
         2 002133   000071 236100                    LDQ     57,,PR0
         2 002134   000024 772000                    QRL     20
         2 002135   000001 376007                    ANQ     1,DL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:134  
         2 002136   000036 721100                    LXL1    30,,PR0
         2 002137   200230 471500                    LDP1    TEXT$,,AUTO
         2 002140   040146 106540                    CMPC    fill='040'O
         2 002141   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 002142   000037 000011                    ADSC9   31,Q,PR0                 cn=0,n=*X1
         2 002143   002154 601000 2                  TNZ     s:16419
         2 002144   000266 236100                    LDQ     182,,PR0
         2 002145   040000 316007                    CANQ    16384,DL
         2 002146   002154 601000 2                  TNZ     s:16419

      712    16412    2             SUBSTR(TEXT$->CHARBASE,0,XUG.POFF) =
      713    16413    2             SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),XUG.POFF)
      714    16414    2             AND NOT XUG.DONT_STRIP_PROMPT
      715    16415    3           THEN DO ;

      716    16416    3               J = XUG.POFF ;

  16416  2 002147   000036 235100                    LDA     30,,PR0
         2 002150   200251 755100                    STA     J,,AUTO

      717    16417    3               GETCMD.RCVD_PROMPT# = '1'B ;

  16417  2 002151   200003 473500                    LDP3    @GETCMD,,AUTO
         2 002152   020000 236003                    LDQ     8192,DU
         2 002153   300006 256100                    ORSQ    6,,PR3

      718    16418    3           END;

      719    16419    2           VBOUND(XUG.READVEC)=MAXIMUM(CSIZE-J,1)-1;

  16419  2 002154   200254 236100                    LDQ     CSIZE,,AUTO
         2 002155   200251 136100                    SBLQ    J,,AUTO
         2 002156   000001 116007                    CMPQ    1,DL
         2 002157   002161 605000 2                  TPL     s:16419+5
         2 002160   000001 236007                    LDQ     1,DL
         2 002161   000001 136007                    SBLQ    1,DL
         2 002162   000020 736000                    QLS     16
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:135  
         2 002163   000002 676100                    ERQ     2,,PR0
         2 002164   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 002165   000002 656100                    ERSQ    2,,PR0

      720    16420    2           VBASE(XUG.READVEC)->CHARBASE = SUBSTR(TEXT$->CHARBASE,J);

  16420  2 002166   000003 471500                    LDP1    3,,PR0
         2 002167   200254 236100                    LDQ     CSIZE,,AUTO
         2 002170   200251 136100                    SBLQ    J,,AUTO
         2 002171   200230 473500                    LDP3    TEXT$,,AUTO
         2 002172   000000 620006                    EAX0    0,QL
         2 002173   200251 235100                    LDA     J,,AUTO
         2 002174   200254 721100                    LXL1    CSIZE,,AUTO
         2 002175   040140 100545                    MLR     fill='040'O
         2 002176   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=*X0
         2 002177   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      721    16421    2           CALL XUG$SETLAST(GETCMD);

  16421  2 002200   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 002201   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002202   000000 701000 xent               TSX1    XUG$SETLAST
         2 002203   000000 011000                    NOP     0

      722    16422    2           ARS = CSIZE - J;

  16422  2 002204   200254 236100                    LDQ     CSIZE,,AUTO
         2 002205   200251 136100                    SBLQ    J,,AUTO
         2 002206   200244 756100                    STQ     ARS,,AUTO

      723    16423    2           IF GETCMD.NODES$ = ADDR(NIL)

  16423  2 002207   200003 470500                    LDP0    @GETCMD,,AUTO
         2 002210   000000 236100                    LDQ     0,,PR0
         2 002211   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002212   002221 601000 2                  TNZ     s:16429

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:136  
      724    16424    3           THEN DO;

      725    16425    3               GETCMD.OUT$ = ADDR(NIL);

  16425  2 002213   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002214   000001 756100                    STQ     1,,PR0

      726    16426    3               P_PCB.NCHARS = ARS;

  16426  2 002215   200244 235100                    LDA     ARS,,AUTO
         2 002216   200224 471500                    LDP1    P_PCB$,,AUTO
         2 002217   100011 755100                    STA     9,,PR1

      727    16427    3               GOTO GETCMD_RET;

  16427  2 002220   002522 710000 2                  TRA     GETCMD_RET

      728    16428    3           END;
      729    16429    2           IF XUG.SYNERR AND ARS=1 AND SUBSTR(VBASE(XUG.READVEC)->INBUF,0,1)='?'

  16429  2 002221   200220 471500                    LDP1    XUG$,,AUTO
         2 002222   100071 236100                    LDQ     57,,PR1
         2 002223   004000 316003                    CANQ    2048,DU
         2 002224   002235 600000 2                  TZE     s:16432
         2 002225   200244 235100                    LDA     ARS,,AUTO
         2 002226   000001 115007                    CMPA    1,DL
         2 002227   002235 601000 2                  TNZ     s:16432
         2 002230   100003 473500                    LDP3    3,,PR1
         2 002231   040000 106500                    CMPC    fill='040'O
         2 002232   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 002233   000024 000001 3                  ADSC9   20                       cn=0,n=1
         2 002234   001553 600000 2                  TZE     SHOW_ALTRN

      730    16430    2           THEN
      731    16431    2               GOTO SHOW_ALTRN ;
      732    16432    2           XUG.SYNERR = %NO# ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:137  
  16432  2 002235   000022 236000 3                  LDQ     18
         2 002236   100071 356100                    ANSQ    57,,PR1

      733    16433    2       END;

      734    16434    1       XUG.PREV_CPOS = 0 ;

  16434  2 002237   200220 470500                    LDP0    XUG$,,AUTO
         2 002240   000105 450100                    STZ     69,,PR0

      735    16435    1       VBASE(XUG.RLTVEC)->RLT(0) = 0 ;

  16435  2 002241   000013 471500                    LDP1    11,,PR0
         2 002242   000100 101400                    MRL     fill='000'O
         2 002243   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         2 002244   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      736    16436    1       XUG.NLINES=1;

  16436  2 002245   000001 235007                    LDA     1,DL
         2 002246   000106 755100                    STA     70,,PR0

      737    16437    1       VBASE(XUG.RLTVEC)->RLT(1)=ARS;

  16437  2 002247   000013 471500                    LDP1    11,,PR0
         2 002250   000100 101500                    MRL     fill='000'O
         2 002251   200244 000004                    ADSC9   ARS,,AUTO                cn=0,n=4
         2 002252   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1

      738    16438    1       IF XUG.PP_ERR

  16438  2 002253   000100 235100                    LDA     64,,PR0
         2 002254   002267 600000 2                  TZE     REPARSE

      739    16439    2       THEN DO;

      740    16440    2           GETCMD.ERR# = XUG.PP_ERR;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:138  

  16440  2 002255   000100 236100                    LDQ     64,,PR0
         2 002256   200003 471500                    LDP1    @GETCMD,,AUTO
         2 002257   100001 756100                    STQ     1,,PR1

      741    16441    2           P_PCB.NCHARS = ARS ;

  16441  2 002260   200244 235100                    LDA     ARS,,AUTO
         2 002261   200224 473500                    LDP3    P_PCB$,,AUTO
         2 002262   300011 755100                    STA     9,,PR3

      742    16442    2           IF XUG.GOODCMD

  16442  2 002263   000071 236100                    LDQ     57,,PR0
         2 002264   000010 316003                    CANQ    8,DU
         2 002265   002777 601000 2                  TNZ     ERRHAND

      743    16443    2           THEN
      744    16444    2               GOTO ERRHAND;
      745    16445    2           ELSE
      746    16446    2               GOTO GETCMD_ALT;

  16446  2 002266   003071 710000 2                  TRA     GETCMD_ALT

      747    16447    2       END;
      748    16448    1   REPARSE:
      749    16449    1       P_PCB.TEXT$=VBASE(XUG.BUFVEC) ;

  16449  2 002267   000001 236100       REPARSE      LDQ     1,,PR0
         2 002270   200224 471500                    LDP1    P_PCB$,,AUTO
         2 002271   100000 756100                    STQ     0,,PR1

      750    16450    1       IF GETCMD.NODES$ = ADDR(NIL)

  16450  2 002272   200003 473500                    LDP3    @GETCMD,,AUTO
         2 002273   300000 236100                    LDQ     0,,PR3
         2 002274   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:139  
         2 002275   002303 601000 2                  TNZ     s:16459

      751    16451    2       THEN DO;

      752    16452    2           GETCMD.OUT$ = ADDR(NIL);

  16452  2 002276   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002277   300001 756100                    STQ     1,,PR3

      753    16453    2           GETCMD.ERR# = XUG#NULLROOT;

  16453  2 002300   000204 236000 0                  LDQ     XUG#NULLROOT
         2 002301   300001 756100                    STQ     1,,PR3

      754    16454        /*E*  ERROR:   XUG-E$NULLROOT
      755    16455              MESSAGE: Null syntax tree passed to XUG$GETCMD (or a similar routine).
      756    16456        */
      757    16457    2           GOTO GETCMD_ALT;

  16457  2 002302   003071 710000 2                  TRA     GETCMD_ALT

      758    16458    2       END;
      759    16459    1       IF XUG.COMMANDS

  16459  2 002303   000071 236100                    LDQ     57,,PR0
         2 002304   020000 316003                    CANQ    8192,DU
         2 002305   002336 600000 2                  TZE     s:16471

      760    16460    2       THEN DO;

      761    16461    2           NODES$ = ADDR(XUG_NODES) ;

  16461  2 002306   000027 236000 3                  LDQ     23
         2 002307   200226 756100                    STQ     NODES$,,AUTO

      762    16462    2           ROOT$ = ADDR(XUG.ROOT_NODE) ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:140  
  16462  2 002310   200220 236100                    LDQ     XUG$,,AUTO
         2 002311   000031 036003                    ADLQ    25,DU
         2 002312   200225 756100                    STQ     ROOT$,,AUTO

      763    16463    2           DUMMY$ = ADDR(XUG.DUMMY_NODE) ;

  16463  2 002313   200220 236100                    LDQ     XUG$,,AUTO
         2 002314   000034 036003                    ADLQ    28,DU
         2 002315   200227 756100                    STQ     DUMMY$,,AUTO

      764    16464    2           ROOT$->P$NODE = NODES$->P$NODE ;

  16464  2 002316   200226 474500                    LDP4    NODES$,,AUTO
         2 002317   200225 475500                    LDP5    ROOT$,,AUTO
         2 002320   000100 100500                    MLR     fill='000'O
         2 002321   400000 000010                    ADSC9   0,,PR4                   cn=0,n=8
         2 002322   500000 000010                    ADSC9   0,,PR5                   cn=0,n=8

      765    16465    2           XUG.ROOT_NODE.USER_NODE$ = DUMMY$ ;

  16465  2 002323   000032 756100                    STQ     26,,PR0

      766    16466    2           XUG.ROOT_NODE.GETCMD_NODE$ = NODES$->P$NODE.SUBNDS$(1) ;

  16466  2 002324   400002 236100                    LDQ     2,,PR4
         2 002325   000033 756100                    STQ     27,,PR0

      767    16467    2           DUMMY$->P$NODE = NODES$->P$NODE.SUBNDS$(0)->P$NODE ;

  16467  2 002326   400001 476500                    LDP6    1,,PR4
         2 002327   200227 477500                    LDP7    DUMMY$,,AUTO
         2 002330   000100 100500                    MLR     fill='000'O
         2 002331   600000 000010                    ADSC9   0,,PR6                   cn=0,n=8
         2 002332   700000 000010                    ADSC9   0,,PR7                   cn=0,n=8

      768    16468    2           XUG.DUMMY_NODE.SUBND$ = GETCMD.NODES$ ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:141  
  16468  2 002333   300000 236100                    LDQ     0,,PR3
         2 002334   000035 756100                    STQ     29,,PR0

      769    16469    2       END ; /* Then Do */

  16469  2 002335   002340 710000 2                  TRA     s:16472

      770    16470    1       ELSE
      771    16471    1           ROOT$ = GETCMD.NODES$ ;

  16471  2 002336   300000 236100                    LDQ     0,,PR3
         2 002337   200225 756100                    STQ     ROOT$,,AUTO

      772    16472    1       P_PCB.ROOT$=ROOT$ ;

  16472  2 002340   200225 236100                    LDQ     ROOT$,,AUTO
         2 002341   100001 756100                    STQ     1,,PR1

      773    16473    1       P_PCB.WORK$ = VBASE(XUG.PARSEVEC) ;

  16473  2 002342   000011 236100                    LDQ     9,,PR0
         2 002343   100002 756100                    STQ     2,,PR1

      774    16474    1       P_PCB.VERSION_CODE = 1;

  16474  2 002344   100010 236100                    LDQ     8,,PR1
         2 002345   000030 376000 3                  ANQ     24
         2 002346   040000 276007                    ORQ     16384,DL
         2 002347   100010 756100                    STQ     8,,PR1

      775    16475    1       P_PCB.WKSZ = (VBOUND(XUG.PARSEVEC)+1)/4 ;

  16475  2 002350   000010 236100                    LDQ     8,,PR0
         2 002351   000020 772000                    QRL     16
         2 002352   000001 036007                    ADLQ    1,DL
         2 002353   000002 772000                    QRL     2
         2 002354   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:142  
         2 002355   100005 740100                    STX0    5,,PR1

      776    16476    1       P_PCB.NCHARS = ARS;

  16476  2 002356   200244 235100                    LDA     ARS,,AUTO
         2 002357   100011 755100                    STA     9,,PR1

      777    16477    1       P_PCB.U$$ = ENTADDR(XUG$PU);

  16477  2 002360   000000 636000 xent               EAQ     XUG$PU
         2 002361   100004 756100                    STQ     4,,PR1

      778    16478    1       P_PCB.DYNMEM = '1'B ;

  16478  2 002362   020000 236007                    LDQ     8192,DL
         2 002363   100005 256100                    ORSQ    5,,PR1

      779    16479    1       P_PCB.NXT = '0'B;

  16479  2 002364   000026 236000 3                  LDQ     22
         2 002365   100005 356100                    ANSQ    5,,PR1

      780    16480    1       XUG.SPELLING_TRIED = %NO#;

  16480  2 002366   000031 236000 3                  LDQ     25
         2 002367   000071 356100                    ANSQ    57,,PR0

      781    16481    1       XUG.QM_AFTER_SYNERR = '0'B;

  16481  2 002370   000032 236000 3                  LDQ     26
         2 002371   000071 356100                    ANSQ    57,,PR0

      782    16482    1   NORMAL_PARSE:
      783    16483    1       CALL FETCH_HELP_TOPIC;

  16483  2 002372   005504 701000 2     NORMAL_PARSE TSX1    FETCH_HELP_TOPIC
         2 002373   000000 011000                    NOP     0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:143  

      784    16484    1       P_PCB.USER$ = ADDR(GETCMD);

  16484  2 002374   200003 236100                    LDQ     @GETCMD,,AUTO
         2 002375   200224 470500                    LDP0    P_PCB$,,AUTO
         2 002376   000014 756100                    STQ     12,,PR0

      785    16485    1       XUG.PARSING_FREE_CMDS = %NO#;

  16485  2 002377   200220 471500                    LDP1    XUG$,,AUTO
         2 002400   000033 236000 3                  LDQ     27
         2 002401   100266 356100                    ANSQ    182,,PR1

      786    16486    1       CALL X$PARSE(P_PCB) ALTRET(PARSEALT);

  16486  2 002402   200224 630500                    EPPR0   P_PCB$,,AUTO
         2 002403   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002404   000000 701000 xent               TSX1    X$PARSE
         2 002405   002560 702000 2                  TSX2    PARSEALT

      787    16487    1       IF GETCMD.PASS = %BLANK_PASS# OR (GETCMD.PASS = %MODE_PASS# AND

  16487  2 002406   200003 470500                    LDP0    @GETCMD,,AUTO
         2 002407   000007 236100                    LDQ     7,,PR0
         2 002410   000140 376003                    ANQ     96,DU
         2 002411   000040 116003                    CMPQ    32,DU
         2 002412   002427 600000 2                  TZE     s:16491
         2 002413   000100 116003                    CMPQ    64,DU
         2 002414   002440 601000 2                  TNZ     s:16493
         2 002415   000006 236100                    LDQ     6,,PR0
         2 002416   200000 316003                    CANQ    65536,DU
         2 002417   002440 601000 2                  TNZ     s:16493
         2 002420   000023 471400 3                  LDP1    19
         2 002421   100000 473500                    LDP3    0,,PR1
         2 002422   000013 720100                    LXL0    11,,PR0
         2 002423   300000 474510                    LDP4    0,X0,PR3
         2 002424   400004 236100                    LDQ     4,,PR4
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:144  
         2 002425   020000 316007                    CANQ    8192,DL
         2 002426   002440 601000 2                  TNZ     s:16493

      788    16488    1         NOT (GETCMD.TREAD# OR DCBADDR(GETCMD.OUTDCB#)
      789    16489    1         ->F$DCB.DDEV.UCOUT#))
      790    16490    1       THEN
      791    16491    1           CALL XUG$BLANK_PASSWORD_COMMON (GETCMD, P_PCB.OUT$->P$B)

  16491  2 002427   200224 471500                    LDP1    P_PCB$,,AUTO
         2 002430   100003 473500                    LDP3    3,,PR1
         2 002431   200433 453500                    STP3    LEGAL_TEXTC+18,,AUTO
         2 002432   200003 236100                    LDQ     @GETCMD,,AUTO
         2 002433   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 002434   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 002435   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002436   000000 701000 xent               TSX1    XUG$BLANK_PASSWORD_COMMON
         2 002437   002543 702000 2                  TSX2    MALT

      792    16492    1             ALTRET(MALT) ;
      793    16493    1       IF XUG.NEED_ECHO

  16493  2 002440   200220 470500                    LDP0    XUG$,,AUTO
         2 002441   000071 236100                    LDQ     57,,PR0
         2 002442   000020 316003                    CANQ    16,DU
         2 002443   002453 600000 2                  TZE     s:16498

      794    16494    2       THEN DO;

      795    16495    2           CALL XUG$ECHO_COMMON(GETCMD) ALTRET(MALT) ;

  16495  2 002444   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 002445   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002446   004472 701000 2                  TSX1    s:16911
         2 002447   002543 702000 2                  TSX2    MALT

      796    16496    2           XUG.NEED_ECHO = '0'B ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:145  
  16496  2 002450   200220 470500                    LDP0    XUG$,,AUTO
         2 002451   000034 236000 3                  LDQ     28
         2 002452   000071 356100                    ANSQ    57,,PR0

      797    16497    2       END ;                        /* Then Do */

      798    16498    1       GETCMD.BUF$ = VBASE(XUG.BUFVEC);

  16498  2 002453   000001 236100                    LDQ     1,,PR0
         2 002454   200003 471500                    LDP1    @GETCMD,,AUTO
         2 002455   100040 756100                    STQ     32,,PR1

      799    16499    1       GETCMD.RLT$ = VBASE(XUG.RLTVEC);

  16499  2 002456   000013 236100                    LDQ     11,,PR0
         2 002457   100041 756100                    STQ     33,,PR1

      800    16500    1       GETCMD.NLINES = XUG.NLINES ;

  16500  2 002460   000106 720100                    LXL0    70,,PR0
         2 002461   100046 740100                    STX0    38,,PR1

      801    16501    1       IF XUG.COMMANDS

  16501  2 002462   000071 236100                    LDQ     57,,PR0
         2 002463   020000 316003                    CANQ    8192,DU
         2 002464   002517 600000 2                  TZE     s:16518

      802    16502    2       THEN DO;

      803    16503    2           J = P_PCB.OUT$->P$B.CODE ;

  16503  2 002465   200224 473500                    LDP3    P_PCB$,,AUTO
         2 002466   300003 474500                    LDP4    3,,PR3
         2 002467   400000 236100                    LDQ     0,,PR4
         2 002470   777777 376007                    ANQ     -1,DL
         2 002471   200251 756100                    STQ     J,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:146  

      804    16504    2           IF P_PCB.OUT$->P$B.NSUBLKS=0

  16504  2 002472   400001 221100                    LDX1    1,,PR4
         2 002473   002505 601000 2                  TNZ     s:16510

      805    16505    3           THEN DO;

      806    16506    3               P_PCB.OUT$ -> P$B.CODE = 0;

  16506  2 002474   000000 222003                    LDX2    0,DU
         2 002475   400000 442100                    SXL2    0,,PR4

      807    16507    3               P_PCB.OUT$ -> P$B.TEMP = %YES#;

  16507  2 002476   300003 474500                    LDP4    3,,PR3
         2 002477   400000 236003                    LDQ     -131072,DU
         2 002500   400000 256100                    ORSQ    0,,PR4

      808    16508    3               P_PCB.OUT$ -> P$B.NDTYPE = 0;

  16508  2 002501   300003 474500                    LDP4    3,,PR3
         2 002502   000000 236003                    LDQ     0,DU
         2 002503   400000 752110                    STCQ    0,'10'O,PR4

      809    16509    3           END;

  16509  2 002504   002511 710000 2                  TRA     s:16512

      810    16510    2           ELSE IF P_PCB.OUT$->P$B.NSUBLKS = 1 THEN

  16510  2 002505   000001 101003                    CMPX1   1,DU
         2 002506   002511 601000 2                  TNZ     s:16512

      811    16511    2                   P_PCB.OUT$ = P_PCB.OUT$ -> P$B.SUBLK$(0) ;

  16511  2 002507   400003 236100                    LDQ     3,,PR4
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:147  
         2 002510   300003 756100                    STQ     3,,PR3

      812    16512    2           GETCMD.OUT$ = P_PCB.OUT$ ;

  16512  2 002511   300003 236100                    LDQ     3,,PR3
         2 002512   100001 756100                    STQ     1,,PR1

      813    16513    2           IF J = %XUG_USER_NODES

  16513  2 002513   200251 235100                    LDA     J,,AUTO
         2 002514   000001 115007                    CMPA    1,DL
         2 002515   002522 600000 2                  TZE     GETCMD_RET

      814    16514    2           THEN
      815    16515    2               GOTO GETCMD_RET ;
      816    16516    2       END ; /* Then Do */

  16516  2 002516   002527 710000 2                  TRA     s:16523

      817    16517    2       ELSE DO;

      818    16518    2           GETCMD.OUT$ = P_PCB.OUT$ ;

  16518  2 002517   200224 473500                    LDP3    P_PCB$,,AUTO
         2 002520   300003 236100                    LDQ     3,,PR3
         2 002521   100001 756100                    STQ     1,,PR1

      819    16519    2   GETCMD_RET:
      820    16520    2           P_PCB.USER$ = XUG.USER$ ;

  16520  2 002522   200220 470500       GETCMD_RET   LDP0    XUG$,,AUTO
         2 002523   000076 236100                    LDQ     62,,PR0
         2 002524   200224 471500                    LDP1    P_PCB$,,AUTO
         2 002525   100014 756100                    STQ     12,,PR1

      821    16521    2           RETURN ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:148  
  16521  2 002526   000000 702200 xent               TSX2  ! X66_ARET

      822    16522    2       END ; /* Else Do */
      823    16523    1       CALL XUG$BUILTIN_COMMON(GETCMD) ALTRET (ERRHAND);

  16523  2 002527   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 002530   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002531   000000 701000 xent               TSX1    XUG$BUILTIN_COMMON
         2 002532   002777 702000 2                  TSX2    ERRHAND

      824    16524    1       IF GETCMD.TEXT_ ~= VECTOR(NIL)

  16524  2 002533   200003 470500                    LDP0    @GETCMD,,AUTO
         2 002534   000034 237100                    LDAQ    28,,PR0
         2 002535   000004 117000 3                  CMPAQ   4
         2 002536   002542 600000 2                  TZE     s:16529

      825    16525    2       THEN DO;

      826    16526    2           GETCMD.OUT$ = ADDR(NIL);

  16526  2 002537   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 002540   000001 756100                    STQ     1,,PR0

      827    16527    2           GOTO GETCMD_RET;

  16527  2 002541   002522 710000 2                  TRA     GETCMD_RET

      828    16528    2       END;
      829    16529    1       GOTO GETCMD ;

  16529  2 002542   001245 710000 2                  TRA     GETCMD

      830    16530
      831    16531    1   MALT: GETCMD.ERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  16531  2 002543   000000 470400 xsym  MALT         LDP0    B$TCB$
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:149  
         2 002544   000000 471500                    LDP1    0,,PR0
         2 002545   100102 236100                    LDQ     66,,PR1
         2 002546   200003 473500                    LDP3    @GETCMD,,AUTO
         2 002547   300001 756100                    STQ     1,,PR3

      832    16532    1       GETCMD.ERRDCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;

  16532  2 002550   000000 471500                    LDP1    0,,PR0
         2 002551   100101 235100                    LDA     65,,PR1
         2 002552   300011 755100                    STA     9,,PR3

      833    16533    1       P_PCB.USER$ = XUG.USER$ ;

  16533  2 002553   200220 471500                    LDP1    XUG$,,AUTO
         2 002554   100076 236100                    LDQ     62,,PR1
         2 002555   200224 474500                    LDP4    P_PCB$,,AUTO
         2 002556   400014 756100                    STQ     12,,PR4

      834    16534    1       ALTRETURN;

  16534  2 002557   000000 702200 xent               TSX2  ! X66_AALT

  16533  2 002560                       PARSEALT     null
      835    16535    1   PARSEALT:;
      836    16536    1       IF XUG.NEED_ECHO

  16536  2 002560   200220 470500                    LDP0    XUG$,,AUTO
         2 002561   000071 236100                    LDQ     57,,PR0
         2 002562   000020 316003                    CANQ    16,DU
         2 002563   002573 600000 2                  TZE     s:16542

      837    16537    1       THEN
      838    16538    2       DO ;

      839    16539    2           CALL XUG$ECHO_COMMON(GETCMD) ;

  16539  2 002564   200003 630500                    EPPR0   @GETCMD,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:150  
         2 002565   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002566   004472 701000 2                  TSX1    s:16911
         2 002567   000000 011000                    NOP     0

      840    16540    2           XUG.NEED_ECHO = '0'B ;

  16540  2 002570   200220 470500                    LDP0    XUG$,,AUTO
         2 002571   000034 236000 3                  LDQ     28
         2 002572   000071 356100                    ANSQ    57,,PR0

      841    16541    2       END ;                        /* Then Do */

      842    16542    1       GETCMD.BUF$ = VBASE(XUG.BUFVEC);

  16542  2 002573   000001 236100                    LDQ     1,,PR0
         2 002574   200003 471500                    LDP1    @GETCMD,,AUTO
         2 002575   100040 756100                    STQ     32,,PR1

      843    16543    1       GETCMD.RLT$ = VBASE(XUG.RLTVEC);

  16543  2 002576   000013 236100                    LDQ     11,,PR0
         2 002577   100041 756100                    STQ     33,,PR1

      844    16544    1       GETCMD.NLINES = XUG.NLINES ;

  16544  2 002600   000106 720100                    LXL0    70,,PR0
         2 002601   100046 740100                    STX0    38,,PR1

      845    16545    1       P_PCB.USER$ = XUG.USER$ ;

  16545  2 002602   000076 236100                    LDQ     62,,PR0
         2 002603   200224 473500                    LDP3    P_PCB$,,AUTO
         2 002604   300014 756100                    STQ     12,,PR3

      846    16546    1       ARS = P_PCB.NCHARS;

  16546  2 002605   300011 235100                    LDA     9,,PR3
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:151  
         2 002606   200244 755100                    STA     ARS,,AUTO

      847    16547    2       IF XUG.SYNTAX THEN DO;

  16547  2 002607   000071 236100                    LDQ     57,,PR0
         2 002610   010000 316003                    CANQ    4096,DU
         2 002611   002764 600000 2                  TZE     s:16607

      848    16548    3           IF NOT P_PCB.ERROR.MON AND P_PCB.ERROR.CODE=%E$SYNERR THEN DO;

  16548  2 002612   300006 236100                    LDQ     6,,PR3
         2 002613   400000 316007                    CANQ    -131072,DL
         2 002614   002764 601000 2                  TNZ     s:16607
         2 002615   300006 236100                    LDQ     6,,PR3
         2 002616   377770 376007                    ANQ     131064,DL
         2 002617   000010 116007                    CMPQ    8,DL
         2 002620   002764 601000 2                  TNZ     s:16607

      849    16549    3               I = P_PCB.HI_CHAR ;

  16549  2 002621   300012 235100                    LDA     10,,PR3
         2 002622   200250 755100                    STA     I,,AUTO

      850    16550    3               J = I;

  16550  2 002623   200251 755100                    STA     J,,AUTO

      851    16551    3               IF I > 0 AND I = ARS

  16551  2 002624   002641 604400 2                  TMOZ    s:16557
         2 002625   200250 236100                    LDQ     I,,AUTO
         2 002626   200244 116100                    CMPQ    ARS,,AUTO
         2 002627   002641 601000 2                  TNZ     s:16557
         2 002630   000001 474500                    LDP4    1,,PR0
         2 002631   040000 106506                    CMPC    fill='040'O
         2 002632   477777 600001                    ADSC9   -1,Q,PR4                 cn=3,n=1
         2 002633   000024 000001 3                  ADSC9   20                       cn=0,n=1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:152  
         2 002634   002641 601000 2                  TNZ     s:16557

      852    16552    3                 AND SUBSTR (VBASE(XUG.BUFVEC) -> INBUF, I-1, 1) = '?'
      853    16553    4               THEN DO;

      854    16554    4                   I = I - 1;

  16554  2 002635   000001 336007                    LCQ     1,DL
         2 002636   200250 056100                    ASQ     I,,AUTO

      855    16555    4                   P_PCB.HI_CHAR = I;

  16555  2 002637   200250 235100                    LDA     I,,AUTO
         2 002640   300012 755100                    STA     10,,PR3

      856    16556    4               END;

      857    16557    3               XUG.SYNERR = %YES# ;

  16557  2 002641   004000 236003                    LDQ     2048,DU
         2 002642   000071 256100                    ORSQ    57,,PR0

      858    16558    3               XUG.POINTED_TO_SYNERR = %NO# ;

  16558  2 002643   000035 236000 3                  LDQ     29
         2 002644   000071 356100                    ANSQ    57,,PR0

      859    16559    3               GETCMD.SYNERR_NODES$ = P_PCB.ROOT$;

  16559  2 002645   300001 236100                    LDQ     1,,PR3
         2 002646   100042 756100                    STQ     34,,PR1

      860    16560    3               IF ARS > 0 AND I < ARS AND

  16560  2 002647   200244 235100                    LDA     ARS,,AUTO
         2 002650   002761 604400 2                  TMOZ    s:16596
         2 002651   200250 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:153  
         2 002652   200244 116100                    CMPQ    ARS,,AUTO
         2 002653   002761 605000 2                  TPL     s:16596
         2 002654   000071 236100                    LDQ     57,,PR0
         2 002655   000002 316003                    CANQ    2,DU
         2 002656   002661 600000 2                  TZE     s:16560+10
         2 002657   000001 316003                    CANQ    1,DU
         2 002660   002667 600000 2                  TZE     GIVE_ALTERNATIVES
         2 002661   000001 474500                    LDP4    1,,PR0
         2 002662   200250 235100                    LDA     I,,AUTO
         2 002663   040000 106505                    CMPC    fill='040'O
         2 002664   400000 000001                    ADSC9   0,A,PR4                  cn=0,n=1
         2 002665   000024 000001 3                  ADSC9   20                       cn=0,n=1
         2 002666   002761 601000 2                  TNZ     s:16596

      861    16561    3                 ((XUG.SPELLING AND NOT XUG.SPELLING_TRIED) OR
      862    16562    3                 SUBSTR(VBASE(XUG.BUFVEC) -> INBUF, I, 1) = '?')
      863    16563    4               THEN GIVE_ALTERNATIVES: DO;

  16563  2 002667                       GIVE_ALTERN* null
      864    16564    4                   P_PCB.USER$ = ADDR(GETCMD) ;

  16564  2 002667   200003 236100                    LDQ     @GETCMD,,AUTO
         2 002670   300014 756100                    STQ     12,,PR3

      865    16565    4                   P_PCB.NXT = '1'B;

  16565  2 002671   040000 236007                    LDQ     16384,DL
         2 002672   300005 256100                    ORSQ    5,,PR3

      866    16566    4                   IF XUG.SPELLING AND NOT XUG.SPELLING_TRIED

  16566  2 002673   000071 236100                    LDQ     57,,PR0
         2 002674   000002 316003                    CANQ    2,DU
         2 002675   002711 600000 2                  TZE     s:16573
         2 002676   000001 316003                    CANQ    1,DU
         2 002677   002711 601000 2                  TNZ     s:16573

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:154  
      867    16567    4                   THEN
      868    16568    4                       CALL SPELLING_CHECKER (%YES#)

  16568  2 002700   000036 236000 3                  LDQ     30
         2 002701   200353 756100                    STQ     OUTDCB#+2,,AUTO
         2 002702   006010 701000 2                  TSX1    SPELLING_CHECKER
         2 002703   002705 702000 2                  TSX2    s:16570
         2 002704   002711 710000 2                  TRA     s:16573

      869    16569    5                       WHENALTRETURN DO;

      870    16570    5                           P_PCB.HI_CHAR = J;

  16570  2 002705   200251 235100                    LDA     J,,AUTO
         2 002706   200224 470500                    LDP0    P_PCB$,,AUTO
         2 002707   000012 755100                    STA     10,,PR0

      871    16571    5                           GOTO RESTORE_USER$;

  16571  2 002710   002746 710000 2                  TRA     RESTORE_USER$

      872    16572    5                       END;
      873    16573    4                   IF SUBSTR(VBASE(XUG.BUFVEC) -> INBUF, I, 1) ~= '?'

  16573  2 002711   200220 470500                    LDP0    XUG$,,AUTO
         2 002712   000001 471500                    LDP1    1,,PR0
         2 002713   200250 235100                    LDA     I,,AUTO
         2 002714   040000 106505                    CMPC    fill='040'O
         2 002715   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 002716   000024 000001 3                  ADSC9   20                       cn=0,n=1
         2 002717   002724 600000 2                  TZE     s:16578

      874    16574    5                   THEN DO;

      875    16575    5                       P_PCB.HI_CHAR = J;

  16575  2 002720   200251 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:155  
         2 002721   200224 473500                    LDP3    P_PCB$,,AUTO
         2 002722   300012 756100                    STQ     10,,PR3

      876    16576    5                       EXIT GIVE_ALTERNATIVES;

  16576  2 002723   002761 710000 2                  TRA     s:16596

      877    16577    5                   END;
      878    16578    4                   XUG.SYNERR = '0'B;

  16578  2 002724   000022 236000 3                  LDQ     18
         2 002725   000071 356100                    ANSQ    57,,PR0

      879    16579    4                   IF B$JIT.PRFLAGS.EXPOUND

  16579  2 002726   000000 473400 xsym               LDP3    B$JIT$
         2 002727   300030 236100                    LDQ     24,,PR3
         2 002730   000100 316003                    CANQ    64,DU
         2 002731   002741 600000 2                  TZE     s:16587

      880    16580    5                   THEN DO;

      881    16581    5                       GETCMD.ERR_CODE = XUG#LEGAL_INPUT_QM;

  16581  2 002732   000174 236000 0                  LDQ     XUG#LEGAL_INPUT_QM
         2 002733   200003 474500                    LDP4    @GETCMD,,AUTO
         2 002734   400010 756100                    STQ     8,,PR4

      882    16582    5                       CALL XUG$ERRMSG_COMMON (GETCMD);

  16582  2 002735   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 002736   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002737   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 002740   000000 011000                    NOP     0

      883    16583    5                   END;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:156  
      884    16584        /*E*  ERROR:   XUG-E$XUG#LEGAL_INPUT_QM
      885    16585              MESSAGE0:Legal input at this point could be any of the following:
      886    16586        */
      887    16587    4                   CALL REPORT_ALTERNATIVES;

  16587  2 002741   005367 701000 2                  TSX1    REPORT_ALTERNATIVES
         2 002742   000000 011000                    NOP     0

      888    16588    4                   P_PCB.HI_CHAR = J;

  16588  2 002743   200251 235100                    LDA     J,,AUTO
         2 002744   200224 470500                    LDP0    P_PCB$,,AUTO
         2 002745   000012 755100                    STA     10,,PR0

      889    16589    4   RESTORE_USER$:  P_PCB.USER$ = XUG.USER$ ;

  16589  2 002746   200220 471500       RESTORE_USE* LDP1    XUG$,,AUTO
         2 002747   100076 236100                    LDQ     62,,PR1
         2 002750   000014 756100                    STQ     12,,PR0

      890    16590    4                   P_PCB.NXT='0'B;

  16590  2 002751   000026 236000 3                  LDQ     22
         2 002752   000005 356100                    ANSQ    5,,PR0

      891    16591    4                   XUG.QM_AFTER_SYNERR = '1'B;

  16591  2 002753   100000 236007                    LDQ     32768,DL
         2 002754   100071 256100                    ORSQ    57,,PR1

      892    16592    4                   IF GETCMD.TEXT_ = VECTOR(NIL)

  16592  2 002755   200003 473500                    LDP3    @GETCMD,,AUTO
         2 002756   300034 237100                    LDAQ    28,,PR3
         2 002757   000004 117000 3                  CMPAQ   4
         2 002760   001245 600000 2                  TZE     GETCMD

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:157  
      893    16593    4                   THEN
      894    16594    4                       GOTO GETCMD;   /* Bletch! */
      895    16595    4               END GIVE_ALTERNATIVES;

      896    16596    3               P_PCB.ERROR.MID='07'O;

  16596  2 002761   200224 470500                    LDP0    P_PCB$,,AUTO
         2 002762   000007 236003                    LDQ     7,DU
         2 002763   000006 752110                    STCQ    6,'10'O,PR0

      897    16597    3           END;

      898    16598        /*E*    ERROR:   XUG-E$SYNERR
      899    16599                MESSAGE: Your command was not processed because it contains something
      900    16600                         unexpected (a mis-spelled word, incorrect punctuation, or some
      901    16601                         other input which does not match this program's requirements).
      902    16602                         You may obtain a brief description of the expected input by
      903    16603                         entering as much of the command as you are sure of, followed
      904    16604                         by a single "?".
      905    16605                                                                           */
      906    16606    2       END;

      907    16607    1       GETCMD.ERR#=P_PCB.ERROR;

  16607  2 002764   200224 470500                    LDP0    P_PCB$,,AUTO
         2 002765   000006 236100                    LDQ     6,,PR0
         2 002766   200003 471500                    LDP1    @GETCMD,,AUTO
         2 002767   100001 756100                    STQ     1,,PR1

      908    16608
      909    16609    1       IF XUG.GOODCMD AND NOT P_PCB.ERROR.MON

  16609  2 002770   200220 473500                    LDP3    XUG$,,AUTO
         2 002771   300071 236100                    LDQ     57,,PR3
         2 002772   000010 316003                    CANQ    8,DU
         2 002773   003070 600000 2                  TZE     s:16632
         2 002774   000006 236100                    LDQ     6,,PR0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:158  
         2 002775   400000 316007                    CANQ    -131072,DL
         2 002776   003070 601000 2                  TNZ     s:16632

      910    16610    2       THEN DO;

      911    16611    2   ERRHAND:
      912    16612    2           GETCMD.ERR_CODE = GETCMD.ERR# ;

  16612  2 002777   200003 470500       ERRHAND      LDP0    @GETCMD,,AUTO
         2 003000   000001 236100                    LDQ     1,,PR0
         2 003001   000010 756100                    STQ     8,,PR0

      913    16613    2           GETCMD.F1_ = VECTOR(NIL) ;

  16613  2 003002   000004 237000 3                  LDAQ    4
         2 003003   000017 755100                    STA     15,,PR0
         2 003004   000020 756100                    STQ     16,,PR0

      914    16614    2           GETCMD.F2_ = VECTOR(NIL) ;

  16614  2 003005   000004 237000 3                  LDAQ    4
         2 003006   000021 755100                    STA     17,,PR0
         2 003007   000022 756100                    STQ     18,,PR0

      915    16615    2           GETCMD.F3_ = VECTOR(NIL) ;

  16615  2 003010   000004 237000 3                  LDAQ    4
         2 003011   000023 755100                    STA     19,,PR0
         2 003012   000024 756100                    STQ     20,,PR0

      916    16616    2           IF B$JIT.PRFLAGS.POINT OR XUG.NLINES > 1

  16616  2 003013   000000 471400 xsym               LDP1    B$JIT$
         2 003014   100030 236100                    LDQ     24,,PR1
         2 003015   000200 316003                    CANQ    128,DU
         2 003016   003023 601000 2                  TNZ     s:16618
         2 003017   200220 473500                    LDP3    XUG$,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:159  
         2 003020   300106 235100                    LDA     70,,PR3
         2 003021   000001 115007                    CMPA    1,DL
         2 003022   003027 604400 2                  TMOZ    s:16619

      917    16617    2           THEN
      918    16618    2               CALL XUG$ECHOIF_COMMON(GETCMD) ;

  16618  2 003023   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 003024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003025   004405 701000 2                  TSX1    s:16894
         2 003026   000000 011000                    NOP     0

      919    16619    2           CALL XUG$ERRPTR_COMMON(GETCMD) ALTRET(GETCMD_ALT1) ;

  16619  2 003027   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 003030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003031   003266 701000 2                  TSX1    s:16675
         2 003032   003074 702000 2                  TSX2    GETCMD_ALT1

      920    16620    2           CALL XUG$ERRMSG_COMMON (GETCMD);

  16620  2 003033   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 003034   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003035   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 003036   000000 011000                    NOP     0

      921    16621    2           IF GETCMD.TEXT_ = VECTOR(NIL)

  16621  2 003037   200003 470500                    LDP0    @GETCMD,,AUTO
         2 003040   000034 237100                    LDAQ    28,,PR0
         2 003041   000004 117000 3                  CMPAQ   4
         2 003042   003055 601000 2                  TNZ     s:16628

      922    16622    2           THEN
      923    16623    2               IF B$JIT.MODE = %M_INT# AND B$JIT.NEXTCC = %CC_FROMUC#

  16623  2 003043   000000 471400 xsym               LDP1    B$JIT$
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:160  
         2 003044   100000 236100                    LDQ     0,,PR1
         2 003045   740000 376003                    ANQ     -16384,DU
         2 003046   140000 116003                    CMPQ    49152,DU
         2 003047   003054 601000 2                  TNZ     s:16623+9
         2 003050   100151 236100                    LDQ     105,,PR1
         2 003051   000777 376003                    ANQ     511,DU
         2 003052   000003 116003                    CMPQ    3,DU
         2 003053   001245 600000 2                  TZE     GETCMD
         2 003054   003070 710000 2                  TRA     s:16632

      924    16624    2               THEN
      925    16625    2                   GOTO GETCMD ;
      926    16626    2               ELSE ;
      927    16627    2           ELSE
      928    16628    2               IF B$JIT.PRFLAGS.EXPOUND AND GETCMD.TREAD# AND NOT XUG.QM_AFTER_SYNERR

  16628  2 003055   000000 471400 xsym               LDP1    B$JIT$
         2 003056   100030 236100                    LDQ     24,,PR1
         2 003057   000100 316003                    CANQ    64,DU
         2 003060   003070 600000 2                  TZE     s:16632
         2 003061   000006 236100                    LDQ     6,,PR0
         2 003062   200000 316003                    CANQ    65536,DU
         2 003063   003070 600000 2                  TZE     s:16632
         2 003064   200220 473500                    LDP3    XUG$,,AUTO
         2 003065   300071 236100                    LDQ     57,,PR3
         2 003066   100000 316007                    CANQ    32768,DL
         2 003067   001631 600000 2                  TZE     ALT_OUT

      929    16629    2               THEN
      930    16630    2                   GOTO ALT_OUT;
      931    16631    2       END ;                        /* Then Do */

      932    16632    1       GOTO GETCMD_ALT1 ;

  16632  2 003070   003074 710000 2                  TRA     GETCMD_ALT1

      933    16633    1   GETCMD_ALT:
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:161  
      934    16634    1       XUG.DIVERT_TO_HELP = %NO# ;

  16634  2 003071   200220 470500       GETCMD_ALT   LDP0    XUG$,,AUTO
         2 003072   000033 236000 3                  LDQ     27
         2 003073   000071 356100                    ANSQ    57,,PR0

      935    16635    1   GETCMD_ALT1:
      936    16636    1       P_PCB.USER$ = XUG.USER$;

  16636  2 003074   200220 470500       GETCMD_ALT1  LDP0    XUG$,,AUTO
         2 003075   000076 236100                    LDQ     62,,PR0
         2 003076   200224 471500                    LDP1    P_PCB$,,AUTO
         2 003077   100014 756100                    STQ     12,,PR1

      937    16637    1       ALTRETURN;

  16637  2 003100   000000 702200 xent               TSX2  ! X66_AALT

      938    16638    1   RDALT1:
      939    16639    1       GETCMD.ERR#=BINBIT(ARS,36);

  16639  2 003101   200244 236100       RDALT1       LDQ     ARS,,AUTO
         2 003102   200003 470500                    LDP0    @GETCMD,,AUTO
         2 003103   000001 756100                    STQ     1,,PR0

      940    16640    1       XUG.DIVERT_TO_HELP = %NO# ;

  16640  2 003104   200220 471500                    LDP1    XUG$,,AUTO
         2 003105   000033 236000 3                  LDQ     27
         2 003106   100071 356100                    ANSQ    57,,PR1

      941    16641    1       P_PCB.USER$ = XUG.USER$ ;

  16641  2 003107   100076 236100                    LDQ     62,,PR1
         2 003110   200224 473500                    LDP3    P_PCB$,,AUTO
         2 003111   300014 756100                    STQ     12,,PR3

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:162  
      942    16642    1       CALL XUG$CLRENABLE_COMMON(GETCMD) ;

  16642  2 003112   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 003113   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003114   000000 701000 xent               TSX1    XUG$CLRENABLE_COMMON
         2 003115   000000 011000                    NOP     0

      943    16643    1       ALTRETURN;

  16643  2 003116   000000 702200 xent               TSX2  ! X66_AALT

      944    16644        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:163  
      945    16645    1   XUG$GETMORE_COMMON: ENTRY(GETCMD) ALTRET;

  16645  2 003117   000000 700200 xent  XUG$GETMORE* TSX0  ! X66_AUTO_2
         2 003120   000440 000002                    ZERO    288,2

      946    16646        /**/
      947    16647    1       XUG$ = GETCMD.WORK$ ;

  16647  2 003121   200003 470500                    LDP0    @GETCMD,,AUTO
         2 003122   000004 236100                    LDQ     4,,PR0
         2 003123   200220 756100                    STQ     XUG$,,AUTO

      948    16648    1       GETCMD.CONTINUED# = %YES# ;

  16648  2 003124   100000 236003                    LDQ     32768,DU
         2 003125   000006 256100                    ORSQ    6,,PR0

      949    16649    1       P_PCB$ = XUG.P_PCB$ ;

  16649  2 003126   200220 471500                    LDP1    XUG$,,AUTO
         2 003127   100072 236100                    LDQ     58,,PR1
         2 003130   200224 756100                    STQ     P_PCB$,,AUTO

      950    16650    1       VBASE(XUG.READVEC)=PINCRC(VBASE(XUG.BUFVEC),XUG.CPOS+1);

  16650  2 003131   100104 236100                    LDQ     68,,PR1
         2 003132   100001 473500                    LDP3    1,,PR1
         2 003133   000011 402007                    MPY     9,DL
         2 003134   000011 036007                    ADLQ    9,DL
         2 003135   003137 605000 2                  TPL     s:16650+6
         2 003136   000044 036003                    ADLQ    36,DU
         2 003137   300000 503506                    ABD     0,QL,PR3
         2 003140   100003 453500                    STP3    3,,PR1

      951    16651    1       VBOUND(XUG.READVEC)=VBOUND(XUG.BUFVEC)-XUG.CPOS-1;

  16651  2 003141   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:164  
         2 003142   000020 772000                    QRL     16
         2 003143   100104 136100                    SBLQ    68,,PR1
         2 003144   000001 136007                    SBLQ    1,DL
         2 003145   000020 736000                    QLS     16
         2 003146   100002 676100                    ERQ     2,,PR1
         2 003147   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003150   100002 656100                    ERSQ    2,,PR1

      952    16652    1       VBASE(XUG.RLTVEC)->RLT(XUG.NLINES)=XUG.CPOS - XUG.PREV_CPOS ;

  16652  2 003151   100013 474500                    LDP4    11,,PR1
         2 003152   100106 235100                    LDA     70,,PR1
         2 003153   100104 236100                    LDQ     68,,PR1
         2 003154   100105 136100                    SBLQ    69,,PR1
         2 003155   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 003156   000105 101500                    MRL     fill='000'O
         2 003157   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 003160   400000 000001                    ADSC9   0,A,PR4                  cn=0,n=1

      953    16653    1       IF XUG.PREV_CPOS = 0

  16653  2 003161   100105 235100                    LDA     69,,PR1
         2 003162   003176 601000 2                  TNZ     s:16657

      954    16654    1       THEN
      955    16655    1           VBASE(XUG.RLTVEC)->RLT(XUG.NLINES) = VBASE(XUG.RLTVEC)->

  16655  2 003163   100013 473500                    LDP3    11,,PR1
         2 003164   100106 235100                    LDA     70,,PR1
         2 003165   000100 101505                    MRL     fill='000'O
         2 003166   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1
         2 003167   200433 000004                    ADSC9   LEGAL_TEXTC+18,,AUTO     cn=0,n=4
         2 003170   200433 236100                    LDQ     LEGAL_TEXTC+18,,AUTO
         2 003171   000001 036007                    ADLQ    1,DL
         2 003172   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 003173   000105 101500                    MRL     fill='000'O
         2 003174   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:165  
         2 003175   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1

      956    16656    1             RLT(XUG.NLINES) + 1 ;
      957    16657    1       XUG.PREV_CPOS = XUG.CPOS ;

  16657  2 003176   100104 235100                    LDA     68,,PR1
         2 003177   100105 755100                    STA     69,,PR1

      958    16658    1       CALL XUG$READCMD_COMMON(GETCMD,XUG.READVEC,ARS) ALTRET(RDALT2);

  16658  2 003200   200244 633500                    EPPR3   ARS,,AUTO
         2 003201   200434 453500                    STP3    LEGAL_TEXTC+19,,AUTO
         2 003202   200220 236100                    LDQ     XUG$,,AUTO
         2 003203   000002 036003                    ADLQ    2,DU
         2 003204   200003 235100                    LDA     @GETCMD,,AUTO
         2 003205   200432 757100                    STAQ    LEGAL_TEXTC+17,,AUTO
         2 003206   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 003207   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 003210   000000 701000 xent               TSX1    XUG$READCMD_COMMON
         2 003211   003257 702000 2                  TSX2    RDALT2

      959    16659    1       IF XUG.NLINES >= XUG.RLTCNT

  16659  2 003212   200220 470500                    LDP0    XUG$,,AUTO
         2 003213   000106 236100                    LDQ     70,,PR0
         2 003214   000107 116100                    CMPQ    71,,PR0
         2 003215   003233 604000 2                  TMI     s:16664

      960    16660    2       THEN CALL XUG$MOREMEM(GETCMD) WHENALTRETURN DO;

  16660  2 003216   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 003217   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 003220   000666 701000 2                  TSX1    s:16100
         2 003221   003223 702000 2                  TSX2    s:16661
         2 003222   003233 710000 2                  TRA     s:16664

      961    16661    2               P_PCB.ERROR = GETCMD.ERR#;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:166  

  16661  2 003223   200003 470500                    LDP0    @GETCMD,,AUTO
         2 003224   000001 236100                    LDQ     1,,PR0
         2 003225   200224 471500                    LDP1    P_PCB$,,AUTO
         2 003226   100006 756100                    STQ     6,,PR1

      962    16662    2               UNWIND TO XUG.REM_PARSE;

  16662  2 003227   200220 473700                    LDP3  ! XUG$,,AUTO
         2 003230   300014 237300                    LDAQ  ! 12,,PR3
         2 003231   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 003232   000000 000200                    ZERO    0,128

      963    16663    2           END;
      964    16664    1       XUG.NLINES = XUG.NLINES + 1;

  16664  2 003233   200220 470500                    LDP0    XUG$,,AUTO
         2 003234   000106 054100                    AOS     70,,PR0

      965    16665    1       VBASE(XUG.RLTVEC)->RLT(XUG.NLINES)=ARS;

  16665  2 003235   000013 471500                    LDP1    11,,PR0
         2 003236   000106 235100                    LDA     70,,PR0
         2 003237   000105 101500                    MRL     fill='000'O
         2 003240   200244 000004                    ADSC9   ARS,,AUTO                cn=0,n=4
         2 003241   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1

      966    16666    1       P_PCB.NCHARS = XUG.CPOS + ARS + 1 ;

  16666  2 003242   000104 236100                    LDQ     68,,PR0
         2 003243   200244 036100                    ADLQ    ARS,,AUTO
         2 003244   000001 036007                    ADLQ    1,DL
         2 003245   200224 471500                    LDP1    P_PCB$,,AUTO
         2 003246   100011 756100                    STQ     9,,PR1

      967    16667    1       IF XUG.PP_ERR = '0'B

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:167  
  16667  2 003247   000100 235100                    LDA     64,,PR0
         2 003250   003252 601000 2                  TNZ     s:16670

      968    16668    1       THEN
      969    16669    1           RETURN;

  16669  2 003251   000000 702200 xent               TSX2  ! X66_ARET

      970    16670    1       P_PCB.ERROR = XUG.PP_ERR;

  16670  2 003252   000100 236100                    LDQ     64,,PR0
         2 003253   100006 756100                    STQ     6,,PR1

      971    16671    1       UNWIND TO XUG.REM_PARSE;

  16671  2 003254   000014 237300                    LDAQ  ! 12,,PR0
         2 003255   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 003256   000000 000200                    ZERO    0,128

      972    16672    1   RDALT2: P_PCB.ERROR=BINBIT(ARS,36);

  16672  2 003257   200244 236100       RDALT2       LDQ     ARS,,AUTO
         2 003260   200224 470500                    LDP0    P_PCB$,,AUTO
         2 003261   000006 756100                    STQ     6,,PR0

      973    16673    1       UNWIND TO XUG.REM_PARSE;

  16673  2 003262   200220 471700                    LDP1  ! XUG$,,AUTO
         2 003263   100014 237300                    LDAQ  ! 12,,PR1
         2 003264   000000 700200 xent               TSX0  ! X66_AUNWIND
         2 003265   000000 000200                    ZERO    0,128

      974    16674        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:168  
      975    16675    1   XUG$ERRPTR_COMMON: ENTRY(GETCMD) ALTRET;

  16675  2 003266   000000 700200 xent  XUG$ERRPTR_* TSX0  ! X66_AUTO_2
         2 003267   000440 000002                    ZERO    288,2

      976    16676        /**/
      977    16677    1       XUG$ = GETCMD.WORK$ ;

  16677  2 003270   200003 470500                    LDP0    @GETCMD,,AUTO
         2 003271   000004 236100                    LDQ     4,,PR0
         2 003272   200220 756100                    STQ     XUG$,,AUTO

      978    16678    1       P_PCB$ = XUG.P_PCB$ ;

  16678  2 003273   200220 471500                    LDP1    XUG$,,AUTO
         2 003274   100072 236100                    LDQ     58,,PR1
         2 003275   200224 756100                    STQ     P_PCB$,,AUTO

      979    16679    1       IF GETCMD.DCB_PARAM# = DCBNUM( NIL )

  16679  2 003276   000014 235100                    LDA     12,,PR0
         2 003277   003302 601000 2                  TNZ     s:16682

      980    16680    1       THEN
      981    16681    1           GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;

  16681  2 003300   000013 235100                    LDA     11,,PR0
         2 003301   000014 755100                    STA     12,,PR0

      982    16682    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)

  16682  2 003302   003305 600000 2                  TZE     s:16686

      983    16683    1       THEN
      984    16684    1           OUTDCB# = GETCMD.DCB_PARAM# ;

  16684  2 003303   200351 755100                    STA     OUTDCB#,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:169  
         2 003304   003315 710000 2                  TRA     s:16687

      985    16685    1       ELSE
      986    16686    1           CALL XUG$GETDCB_COMMON(M$LO,OUTDCB#) ALTRET(MALT) ;

  16686  2 003305   200351 633500                    EPPR3   OUTDCB#,,AUTO
         2 003306   200433 453500                    STP3    LEGAL_TEXTC+18,,AUTO
         2 003307   000016 236000 3                  LDQ     14
         2 003310   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 003311   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 003312   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003313   000000 701000 xent               TSX1    XUG$GETDCB_COMMON
         2 003314   002543 702000 2                  TSX2    MALT

      987    16687    1       GETCMD.DCB_PARAM# = OUTDCB# ;

  16687  2 003315   200351 235100                    LDA     OUTDCB#,,AUTO
         2 003316   200003 470500                    LDP0    @GETCMD,,AUTO
         2 003317   000014 755100                    STA     12,,PR0

      988    16688    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, OUTDCB#);

  16688  2 003320   200351 631500                    EPPR1   OUTDCB#,,AUTO
         2 003321   200433 451500                    STP1    LEGAL_TEXTC+18,,AUTO
         2 003322   200003 236100                    LDQ     @GETCMD,,AUTO
         2 003323   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 003324   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 003325   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003326   000000 701000 xent               TSX1    XUG$OPENOUT_INTERNAL
         2 003327   000000 011000                    NOP     0

      989    16689    1       FPT_WRITE = FPT_WRITE_C;

  16689  2 003330   000100 100400                    MLR     fill='000'O
         2 003331   000030 000060 0                  ADSC9   FPT_WRITE_C              cn=0,n=48
         2 003332   200020 000060                    ADSC9   FPT_WRITE,,AUTO          cn=0,n=48

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:170  
      990    16690    1       FPT_WRITE.V_ = VECTOR(FPT_WRITE.V);

  16690  2 003333   000037 235000 3                  LDA     31
         2 003334   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 003335   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 003336   000030 036003                    ADLQ    24,DU
         2 003337   200020 757100                    STAQ    FPT_WRITE,,AUTO

      991    16691    1       FPT_WRITE.BUF_ = VECTOR(XUG.BUF);

  16691  2 003340   000040 235000 3                  LDA     32
         2 003341   200220 236100                    LDQ     XUG$,,AUTO
         2 003342   000300 036003                    ADLQ    192,DU
         2 003343   200024 757100                    STAQ    FPT_WRITE+4,,AUTO

      992    16692    1       FPT_WRITE.V.DCB# = OUTDCB# ;

  16692  2 003344   200351 720100                    LXL0    OUTDCB#,,AUTO
         2 003345   200030 740100                    STX0    FPT_WRITE+8,,AUTO

      993    16693    1       FPT_WRITE.V.DVBYTE.VFC# = %YES#;

  16693  2 003346   100000 236003                    LDQ     32768,DU
         2 003347   200033 256100                    ORSQ    FPT_WRITE+11,,AUTO

      994    16694    1       IF GETCMD.USE_EPOS#

  16694  2 003350   200003 470500                    LDP0    @GETCMD,,AUTO
         2 003351   000006 234100                    SZN     6,,PR0
         2 003352   003357 605000 2                  TPL     s:16698

      995    16695    1       THEN
      996    16696    1           EPOS=GETCMD.EPOS# ;

  16696  2 003353   000006 236100                    LDQ     6,,PR0
         2 003354   777777 376007                    ANQ     -1,DL
         2 003355   200252 756100                    STQ     EPOS,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:171  
         2 003356   003362 710000 2                  TRA     s:16699

      997    16697    1       ELSE
      998    16698    1           EPOS = P_PCB.HI_CHAR;

  16698  2 003357   200224 471500                    LDP1    P_PCB$,,AUTO
         2 003360   100012 235100                    LDA     10,,PR1
         2 003361   200252 755100                    STA     EPOS,,AUTO

      999    16699    1       EPOS = MINIMUM (P_PCB.NCHARS, EPOS);

  16699  2 003362   200252 236100                    LDQ     EPOS,,AUTO
         2 003363   200224 471500                    LDP1    P_PCB$,,AUTO
         2 003364   003371 604000 2                  TMI     s:16699+7
         2 003365   100011 116100                    CMPQ    9,,PR1
         2 003366   003371 602000 2                  TNC     s:16699+7
         2 003367   003371 600000 2                  TZE     s:16699+7
         2 003370   100011 236100                    LDQ     9,,PR1
         2 003371   200252 756100                    STQ     EPOS,,AUTO

     1000    16700    2   SETFLG: DO I = 0 TO XUG.NDCBS;

  16700  2 003372   200250 450100       SETFLG       STZ     I,,AUTO
         2 003373   003430 710000 2                  TRA     s:16709+1

     1001    16701    2           CALL XUG$CORRES_COMMON (OUTDCB#, BINBIT(XUG.DCBS.NUM(I),36))

  16701  2 003374   200250 235100                    LDA     I,,AUTO
         2 003375   000001 735000                    ALS     1
         2 003376   200220 470500                    LDP0    XUG$,,AUTO
         2 003377   000113 236105                    LDQ     75,AL,PR0
         2 003400   000022 772000                    QRL     18
         2 003401   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 003402   200432 631500                    EPPR1   LEGAL_TEXTC+17,,AUTO
         2 003403   200435 451500                    STP1    LEGAL_TEXTC+20,,AUTO
         2 003404   200351 633500                    EPPR3   OUTDCB#,,AUTO
         2 003405   200434 453500                    STP3    LEGAL_TEXTC+19,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:172  
         2 003406   200434 630500                    EPPR0   LEGAL_TEXTC+19,,AUTO
         2 003407   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003410   000000 701000 xent               TSX1    XUG$CORRES_COMMON
         2 003411   003413 702000 2                  TSX2    s:16703
         2 003412   003427 710000 2                  TRA     s:16709

     1002    16702    3           WHENALTRETURN DO;

     1003    16703    3               IF XUG.DCBS.ERRPTR_CPOS(I) = EPOS

  16703  2 003413   200250 235100                    LDA     I,,AUTO
         2 003414   000001 735000                    ALS     1
         2 003415   200220 470500                    LDP0    XUG$,,AUTO
         2 003416   000113 236105                    LDQ     75,AL,PR0
         2 003417   000022 736000                    QLS     18
         2 003420   000022 732000                    QRS     18
         2 003421   200252 116100                    CMPQ    EPOS,,AUTO
         2 003422   003424 601000 2                  TNZ     s:16706

     1004    16704    3               THEN
     1005    16705    3                   RETURN;

  16705  2 003423   000000 702200 xent               TSX2  ! X66_ARET

     1006    16706    3               XUG.DCBS.ERRPTR_CPOS(I) = EPOS;

  16706  2 003424   200252 720100                    LXL0    EPOS,,AUTO
         2 003425   000113 440105                    SXL0    75,AL,PR0

     1007    16707    3               EXIT SETFLG;

  16707  2 003426   003434 710000 2                  TRA     s:16710

     1008    16708    3           END;
     1009    16709    2       END SETFLG;

  16709  2 003427   200250 054100                    AOS     I,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:173  
         2 003430   200220 470500                    LDP0    XUG$,,AUTO
         2 003431   200250 236100                    LDQ     I,,AUTO
         2 003432   000112 116100                    CMPQ    74,,PR0
         2 003433   003374 604400 2                  TMOZ    s:16701

     1010    16710    1       IF XUG.QM_AFTER_SYNERR

  16710  2 003434   000071 236100                    LDQ     57,,PR0
         2 003435   100000 316007                    CANQ    32768,DL
         2 003436   004120 601000 2                  TNZ     DO_SINPUT

     1011    16711    1       THEN
     1012    16712    1           GOTO DO_SINPUT;
     1013    16713    1       IF B$JIT.PRFLAGS.POINT

  16713  2 003437   000000 471400 xsym               LDP1    B$JIT$
         2 003440   100030 236100                    LDQ     24,,PR1
         2 003441   000200 316003                    CANQ    128,DU
         2 003442   003653 600000 2                  TZE     s:16765

     1014    16714    1       THEN
     1015    16715    2   POINT_TO_ERROR: DO;

  16715  2 003443                       POINT_TO_ER* null
     1016    16716    2           IF EPOS >= XUG.CPOS

  16716  2 003443   200252 236100                    LDQ     EPOS,,AUTO
         2 003444   000104 116100                    CMPQ    68,,PR0
         2 003445   003511 604000 2                  TMI     s:16727
         2 003446   000036 036100                    ADLQ    30,,PR0
         2 003447   000104 136100                    SBLQ    68,,PR0
         2 003450   000453 116007                    CMPQ    299,DL
         2 003451   003511 605000 2                  TPL     s:16727
         2 003452   000036 235100                    LDA     30,,PR0
         2 003453   003464 600000 2                  TZE     s:16721
         2 003454   200003 473500                    LDP3    @GETCMD,,AUTO
         2 003455   300006 236100                    LDQ     6,,PR3
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:174  
         2 003456   010000 316003                    CANQ    4096,DU
         2 003457   003464 600000 2                  TZE     s:16721
         2 003460   000037 236100                    LDQ     31,,PR0
         2 003461   777000 376003                    ANQ     -512,DU
         2 003462   100000 116003                    CMPQ    32768,DU
         2 003463   003511 600000 2                  TZE     s:16727

     1017    16717    2             AND XUG.POFF + EPOS - XUG.CPOS < LENGTHC(XUG.BUFA) - 1
     1018    16718    2             AND (XUG.POFF = 0 OR NOT GETCMD.PROMPT_VFC# OR
     1019    16719    2             SUBSTR(XUG.PROMPT, 0, 1) ~= '@')
     1020    16720    3           THEN DO;

     1021    16721    3               TPOS=XUG.POFF+EPOS+XUG.CCBUF_OFFC-XUG.CPOS+1;

  16721  2 003464   000036 236100                    LDQ     30,,PR0
         2 003465   200252 036100                    ADLQ    EPOS,,AUTO
         2 003466   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 003467   000267 236100                    LDQ     183,,PR0
         2 003470   000022 732000                    QRS     18
         2 003471   200433 756100                    STQ     LEGAL_TEXTC+18,,AUTO
         2 003472   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 003473   200433 036100                    ADLQ    LEGAL_TEXTC+18,,AUTO
         2 003474   000104 136100                    SBLQ    68,,PR0
         2 003475   000001 036007                    ADLQ    1,DL
         2 003476   200253 756100                    STQ     TPOS,,AUTO

     1022    16722    3               IF GETCMD.RCVD_PROMPT# AND GETCMD.TREAD#

  16722  2 003477   200003 473500                    LDP3    @GETCMD,,AUTO
         2 003500   300006 236100                    LDQ     6,,PR3
         2 003501   020000 316003                    CANQ    8192,DU
         2 003502   003626 600000 2                  TZE     s:16758
         2 003503   200000 316003                    CANQ    65536,DU
         2 003504   003626 600000 2                  TZE     s:16758

     1023    16723    3               THEN
     1024    16724    3                   TPOS = TPOS + XUG.POFF;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:175  

  16724  2 003505   200253 236100                    LDQ     TPOS,,AUTO
         2 003506   000036 036100                    ADLQ    30,,PR0
         2 003507   200253 756100                    STQ     TPOS,,AUTO

     1025    16725    3           END;

  16725  2 003510   003626 710000 2                  TRA     s:16758

     1026    16726    3           ELSE DO;

     1027    16727    4               IF EPOS>15 THEN DO;

  16727  2 003511   200252 235100                    LDA     EPOS,,AUTO
         2 003512   000017 115007                    CMPA    15,DL
         2 003513   003555 604400 2                  TMOZ    s:16742

     1028    16728    4                   XUG.BUF=%CONCAT(VFC_TRANSITION0,'...');

  16728  2 003514   040100 100400                    MLR     fill='040'O
         2 003515   000346 000004 0                  ADSC9   XUH_PARAM_C+58           cn=0,n=4
         2 003516   000300 000454                    ADSC9   192,,PR0                 cn=0,n=300

     1029    16729    4                   CSIZE=30;

  16729  2 003517   000036 236007                    LDQ     30,DL
         2 003520   200254 756100                    STQ     CSIZE,,AUTO

     1030    16730    4                   ADDR(XUG.BUFA(4))->CHARBASE=PINCRC(VBASE(XUG.BUFVEC),EPOS-15)->
             16730                            CHARBASE;

  16730  2 003521   000001 473500                    LDP3    1,,PR0
         2 003522   000000 620006                    EAX0    0,QL
         2 003523   200254 721100                    LXL1    CSIZE,,AUTO
         2 003524   040140 100545                    MLR     fill='040'O
         2 003525   377774 200010                    ADSC9   -4,A,PR3                 cn=1,n=*X0
         2 003526   000301 000011                    ADSC9   193,,PR0                 cn=0,n=*X1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:176  

     1031    16731    4                   TPOS=19;

  16731  2 003527   000023 236007                    LDQ     19,DL
         2 003530   200253 756100                    STQ     TPOS,,AUTO

     1032    16732    5                   IF EPOS+15<P_PCB.NCHARS THEN DO;

  16732  2 003531   200224 474500                    LDP4    P_PCB$,,AUTO
         2 003532   200252 236100                    LDQ     EPOS,,AUTO
         2 003533   000017 036007                    ADLQ    15,DL
         2 003534   003537 604000 2                  TMI     s:16733
         2 003535   400011 116100                    CMPQ    9,,PR4
         2 003536   003550 603000 2                  TRC     s:16738

     1033    16733    5                       CSIZE=3;

  16733  2 003537   000003 235007                    LDA     3,DL
         2 003540   200254 755100                    STA     CSIZE,,AUTO

     1034    16734    5                       ADDR(XUG.BUFA(34))->CHARBASE='...';

  16734  2 003541   000000 620005                    EAX0    0,AL
         2 003542   040140 100400                    MLR     fill='040'O
         2 003543   000347 000003 0                  ADSC9   XUH_PARAM_C+59           cn=0,n=3
         2 003544   000310 400010                    ADSC9   200,,PR0                 cn=2,n=*X0

     1035    16735    5                       I=36;

  16735  2 003545   000044 235007                    LDA     36,DL
         2 003546   200250 755100                    STA     I,,AUTO

     1036    16736    5                   END;

  16736  2 003547   003614 710000 2                  TRA     s:16754

     1037    16737    5                   ELSE DO;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:177  

     1038    16738    5                       I=18+P_PCB.NCHARS-EPOS;

  16738  2 003550   400011 236100                    LDQ     9,,PR4
         2 003551   200252 136100                    SBLQ    EPOS,,AUTO
         2 003552   000022 036007                    ADLQ    18,DL
         2 003553   200250 756100                    STQ     I,,AUTO

     1039    16739    5                   END;

     1040    16740    4               END;

  16740  2 003554   003614 710000 2                  TRA     s:16754

     1041    16741    4               ELSE DO;

     1042    16742    4                   TPOS=EPOS+1;

  16742  2 003555   000001 035007                    ADLA    1,DL
         2 003556   200253 755100                    STA     TPOS,,AUTO

     1043    16743    4                   CSIZE=30;

  16743  2 003557   000036 236007                    LDQ     30,DL
         2 003560   200254 756100                    STQ     CSIZE,,AUTO

     1044    16744    4                  CALL CONCAT (XUG.BUF, %VFC_TRANSITION0, VBASE(XUG.BUFVEC)->CHARBASE)
             16744                            ;

  16744  2 003561   000001 473500                    LDP3    1,,PR0
         2 003562   036000 236003                    LDQ     15360,DU
         2 003563   000300 552140                    STBQ    192,'40'O,PR0
         2 003564   200254 720100                    LXL0    CSIZE,,AUTO
         2 003565   040100 100540                    MLR     fill='040'O
         2 003566   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 003567   000300 200453                    ADSC9   192,,PR0                 cn=1,n=299

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:178  
     1045    16745    5                   IF EPOS+15>P_PCB.NCHARS THEN DO;

  16745  2 003570   200224 470500                    LDP0    P_PCB$,,AUTO
         2 003571   200252 236100                    LDQ     EPOS,,AUTO
         2 003572   000017 036007                    ADLQ    15,DL
         2 003573   003602 604000 2                  TMI     s:16749
         2 003574   000011 116100                    CMPQ    9,,PR0
         2 003575   003602 602000 2                  TNC     s:16749
         2 003576   003602 600000 2                  TZE     s:16749

     1046    16746    5                       I=P_PCB.NCHARS;

  16746  2 003577   000011 235100                    LDA     9,,PR0
         2 003600   200250 755100                    STA     I,,AUTO

     1047    16747    5                   END;

  16747  2 003601   003614 710000 2                  TRA     s:16754

     1048    16748    5                   ELSE DO;

     1049    16749    5                       CSIZE=3;

  16749  2 003602   000003 235007                    LDA     3,DL
         2 003603   200254 755100                    STA     CSIZE,,AUTO

     1050    16750    5                       ADDR(XUG.BUFA(EPOS+16)) -> CHARBASE = '...';

  16750  2 003604   200220 471500                    LDP1    XUG$,,AUTO
         2 003605   000000 620005                    EAX0    0,AL
         2 003606   200252 235100                    LDA     EPOS,,AUTO
         2 003607   040145 100400                    MLR     fill='040'O
         2 003610   000347 000003 0                  ADSC9   XUH_PARAM_C+59           cn=0,n=3
         2 003611   100304 000010                    ADSC9   196,A,PR1                cn=0,n=*X0

     1051    16751    5                       I=EPOS + 18;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:179  
  16751  2 003612   000022 035007                    ADLA    18,DL
         2 003613   200250 755100                    STA     I,,AUTO

     1052    16752    5                   END;

     1053    16753    4               END;

     1054    16754    3               FPT_WRITE.BUF_.BOUND=I;

  16754  2 003614   200250 236100                    LDQ     I,,AUTO
         2 003615   000020 736000                    QLS     16
         2 003616   200024 676100                    ERQ     FPT_WRITE+4,,AUTO
         2 003617   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003620   200024 656100                    ERSQ    FPT_WRITE+4,,AUTO

     1055    16755    4               CALL M$WRITE(FPT_WRITE) WHENALTRETURN DO ;

  16755  2 003621   200020 630500                    EPPR0   FPT_WRITE,,AUTO
         2 003622   440001 713400                    CLIMB   alt,write
         2 003623   401400 401760                    pmme    nvectors=4
         2 003624   003626 702000 2                  TSX2    s:16758
         2 003625   003626 710000 2                  TRA     s:16758

     1056    16756    4               END ;

     1057    16757    3           END;

     1058    16758    2           XUG.BUF=%VFC_TRANSITION1;

  16758  2 003626   200220 470500                    LDP0    XUG$,,AUTO
         2 003627   040100 100400                    MLR     fill='040'O
         2 003630   000041 000001 3                  ADSC9   33                       cn=0,n=1
         2 003631   000300 000454                    ADSC9   192,,PR0                 cn=0,n=300

     1059    16759    2           XUG.BUFA(TPOS)='^';

  16759  2 003632   200253 235100                    LDA     TPOS,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:180  
         2 003633   040105 100400                    MLR     fill='040'O
         2 003634   000042 000001 3                  ADSC9   34                       cn=0,n=1
         2 003635   000300 000001                    ADSC9   192,A,PR0                cn=0,n=1

     1060    16760    2           XUG.CPOS=P_PCB.NCHARS;

  16760  2 003636   200224 471500                    LDP1    P_PCB$,,AUTO
         2 003637   100011 235100                    LDA     9,,PR1
         2 003640   000104 755100                    STA     68,,PR0

     1061    16761    2           FPT_WRITE.BUF_.BOUND = TPOS;

  16761  2 003641   200253 236100                    LDQ     TPOS,,AUTO
         2 003642   000020 736000                    QLS     16
         2 003643   200024 676100                    ERQ     FPT_WRITE+4,,AUTO
         2 003644   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 003645   200024 656100                    ERSQ    FPT_WRITE+4,,AUTO

     1062    16762    3           CALL M$WRITE(FPT_WRITE) WHENALTRETURN DO ;

  16762  2 003646   200020 630500                    EPPR0   FPT_WRITE,,AUTO
         2 003647   440001 713400                    CLIMB   alt,write
         2 003650   401400 401760                    pmme    nvectors=4
         2 003651   003653 702000 2                  TSX2    s:16765
         2 003652   003653 710000 2                  TRA     s:16765

     1063    16763    3           END ;

     1064    16764    2       END ;                        /* Then Do */

     1065    16765    1       IF NOT B$JIT.PRFLAGS.POINT

  16765  2 003653   000000 470400 xsym               LDP0    B$JIT$
         2 003654   000030 236100                    LDQ     24,,PR0
         2 003655   000200 316003                    CANQ    128,DU
         2 003656   003672 600000 2                  TZE     s:16768
         2 003657   200003 471500                    LDP1    @GETCMD,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:181  
         2 003660   100006 236100                    LDQ     6,,PR1
         2 003661   200000 316003                    CANQ    65536,DU
         2 003662   004120 600000 2                  TZE     DO_SINPUT
         2 003663   200220 473500                    LDP3    XUG$,,AUTO
         2 003664   300071 236100                    LDQ     57,,PR3
         2 003665   004000 316003                    CANQ    2048,DU
         2 003666   004120 600000 2                  TZE     DO_SINPUT
         2 003667   000030 236100                    LDQ     24,,PR0
         2 003670   000100 316003                    CANQ    64,DU
         2 003671   004120 600000 2                  TZE     DO_SINPUT

     1066    16766    1         OR (GETCMD.TREAD# AND XUG.SYNERR AND B$JIT.PRFLAGS.EXPOUND)
     1067    16767    2       THEN DO;

     1068    16768    2           SAVE_ERR = GETCMD.ERR_CODE ;

  16768  2 003672   200003 471500                    LDP1    @GETCMD,,AUTO
         2 003673   100010 236100                    LDQ     8,,PR1
         2 003674   200323 756100                    STQ     SAVE_ERR,,AUTO

     1069    16769    2           SAVE_DCB = GETCMD.DCB_PARAM# ;

  16769  2 003675   100014 235100                    LDA     12,,PR1
         2 003676   200324 755100                    STA     SAVE_DCB,,AUTO

     1070    16770    2           SAVE_F1 = GETCMD.F1_;

  16770  2 003677   000100 100500                    MLR     fill='000'O
         2 003700   100017 000010                    ADSC9   15,,PR1                  cn=0,n=8
         2 003701   200326 000010                    ADSC9   SAVE_F1,,AUTO            cn=0,n=8

     1071    16771    2           SAVE_F2 = GETCMD.F2_;

  16771  2 003702   000100 100500                    MLR     fill='000'O
         2 003703   100021 000010                    ADSC9   17,,PR1                  cn=0,n=8
         2 003704   200330 000010                    ADSC9   SAVE_F2,,AUTO            cn=0,n=8

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:182  
     1072    16772    2           XUG.CPOS=P_PCB.NCHARS;

  16772  2 003705   200224 473500                    LDP3    P_PCB$,,AUTO
         2 003706   300011 235100                    LDA     9,,PR3
         2 003707   200220 474500                    LDP4    XUG$,,AUTO
         2 003710   400104 755100                    STA     68,,PR4

     1073    16773    2           IF EPOS<16 OR XUG.CPOS<20

  16773  2 003711   200252 235100                    LDA     EPOS,,AUTO
         2 003712   000020 115007                    CMPA    16,DL
         2 003713   003717 604000 2                  TMI     s:16775
         2 003714   400104 235100                    LDA     68,,PR4
         2 003715   000024 115007                    CMPA    20,DL
         2 003716   003724 605000 2                  TPL     s:16780

     1074    16774    3           THEN DO;

     1075    16775    3               CNT = 0 ;

  16775  2 003717   200350 450100                    STZ     CNT,,AUTO

     1076    16776    3               FIRST = 0 ;

  16776  2 003720   200313 450100                    STZ     FIRST,,AUTO

     1077    16777    3               LAST = EPOS ;

  16777  2 003721   200252 235100                    LDA     EPOS,,AUTO
         2 003722   200314 755100                    STA     LAST,,AUTO

     1078    16778    3           END ;                     /* Then Do */

  16778  2 003723   003741 710000 2                  TRA     s:16784

     1079    16779    3           ELSE DO;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:183  
     1080    16780    3               CNT = 10 ;

  16780  2 003724   000012 235007                    LDA     10,DL
         2 003725   200350 755100                    STA     CNT,,AUTO

     1081    16781    3               FIRST = EPOS-10 ;

  16781  2 003726   200252 235100                    LDA     EPOS,,AUTO
         2 003727   000012 135007                    SBLA    10,DL
         2 003730   200313 755100                    STA     FIRST,,AUTO

     1082    16782    3               CALL SCAN_RECORD (-1, FIRST, LAST) ;

  16782  2 003731   200314 635500                    EPPR5   LAST,,AUTO
         2 003732   200355 455500                    STP5    BADCHAR+1,,AUTO
         2 003733   200313 636500                    EPPR6   FIRST,,AUTO
         2 003734   200354 456500                    STP6    @QM_REQUIRED+1,,AUTO
         2 003735   000043 236000 3                  LDQ     35
         2 003736   200353 756100                    STQ     OUTDCB#+2,,AUTO
         2 003737   005721 701000 2                  TSX1    SCAN_RECORD
         2 003740   000000 011000                    NOP     0

     1083    16783    3           END ;                     /* Else Do */

     1084    16784    2           CSIZE = XUG.CPOS ;

  16784  2 003741   200220 470500                    LDP0    XUG$,,AUTO
         2 003742   000104 235100                    LDA     68,,PR0
         2 003743   200254 755100                    STA     CSIZE,,AUTO

     1085    16785    2           FIELD1.TXT = SUBSTR(VBASE(XUG.BUFVEC)->CHARBASE, FIRST,

  16785  2 003744   000001 471500                    LDP1    1,,PR0
         2 003745   200314 236100                    LDQ     LAST,,AUTO
         2 003746   200313 136100                    SBLQ    FIRST,,AUTO
         2 003747   200350 036100                    ADLQ    CNT,,AUTO
         2 003750   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:184  
         2 003751   200313 236100                    LDQ     FIRST,,AUTO
         2 003752   040100 100546                    MLR     fill='040'O
         2 003753   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=*X0
         2 003754   200332 200024                    ADSC9   FIELD1,,AUTO             cn=1,n=20

     1086    16786    2             LAST - FIRST+CNT) ;
     1087    16787    2           FIELD1.CNT = LAST - FIRST + CNT ;

  16787  2 003755   200314 236100                    LDQ     LAST,,AUTO
         2 003756   200313 136100                    SBLQ    FIRST,,AUTO
         2 003757   200350 036100                    ADLQ    CNT,,AUTO
         2 003760   000033 736000                    QLS     27
         2 003761   200332 552140                    STBQ    FIELD1,'40'O,AUTO

     1088    16788    2           GETCMD.F1_ = VECTOR(FIELD1) ;

  16788  2 003762   000044 235000 3                  LDA     36
         2 003763   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 003764   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 003765   000332 036003                    ADLQ    218,DU
         2 003766   200003 471500                    LDP1    @GETCMD,,AUTO
         2 003767   100017 755100                    STA     15,,PR1
         2 003770   100020 756100                    STQ     16,,PR1

     1089    16789    2           IF XUG.CPOS < 20 OR EPOS + 16 > XUG.CPOS

  16789  2 003771   000104 235100                    LDA     68,,PR0
         2 003772   000024 115007                    CMPA    20,DL
         2 003773   004000 604000 2                  TMI     s:16791
         2 003774   200252 236100                    LDQ     EPOS,,AUTO
         2 003775   000020 036007                    ADLQ    16,DL
         2 003776   000104 116100                    CMPQ    68,,PR0
         2 003777   004005 604400 2                  TMOZ    s:16795

     1090    16790    3           THEN DO;

     1091    16791    3               FIRST = EPOS ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:185  

  16791  2 004000   200252 236100                    LDQ     EPOS,,AUTO
         2 004001   200313 756100                    STQ     FIRST,,AUTO

     1092    16792    3               LAST = XUG.CPOS ;

  16792  2 004002   000104 235100                    LDA     68,,PR0
         2 004003   200314 755100                    STA     LAST,,AUTO

     1093    16793    3           END ;                     /* Then Do */

  16793  2 004004   004021 710000 2                  TRA     s:16798

     1094    16794    3           ELSE DO;

     1095    16795    3               FIRST = EPOS ;

  16795  2 004005   200252 235100                    LDA     EPOS,,AUTO
         2 004006   200313 755100                    STA     FIRST,,AUTO

     1096    16796    3               CALL SCAN_RECORD (1, FIRST+10, LAST) ;

  16796  2 004007   000012 035007                    ADLA    10,DL
         2 004010   200437 755100                    STA     LEGAL_TEXTC+22,,AUTO
         2 004011   200314 633500                    EPPR3   LAST,,AUTO
         2 004012   200355 453500                    STP3    BADCHAR+1,,AUTO
         2 004013   200437 634500                    EPPR4   LEGAL_TEXTC+22,,AUTO
         2 004014   200354 454500                    STP4    @QM_REQUIRED+1,,AUTO
         2 004015   000045 236000 3                  LDQ     37
         2 004016   200353 756100                    STQ     OUTDCB#+2,,AUTO
         2 004017   005721 701000 2                  TSX1    SCAN_RECORD
         2 004020   000000 011000                    NOP     0

     1097    16797    3           END ;                     /* Else Do */

     1098    16798    2           FIELD2.TXT = SUBSTR(VBASE(XUG.BUFVEC)->CHARBASE, FIRST,

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:186  
  16798  2 004021   200220 470500                    LDP0    XUG$,,AUTO
         2 004022   000001 471500                    LDP1    1,,PR0
         2 004023   200314 236100                    LDQ     LAST,,AUTO
         2 004024   200313 136100                    SBLQ    FIRST,,AUTO
         2 004025   000000 620006                    EAX0    0,QL
         2 004026   200313 235100                    LDA     FIRST,,AUTO
         2 004027   040100 100545                    MLR     fill='040'O
         2 004030   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=*X0
         2 004031   200340 200024                    ADSC9   FIELD2,,AUTO             cn=1,n=20

     1099    16799    2             LAST - FIRST) ;
     1100    16800    2           FIELD2.CNT = LAST - FIRST ;

  16800  2 004032   200314 236100                    LDQ     LAST,,AUTO
         2 004033   200313 136100                    SBLQ    FIRST,,AUTO
         2 004034   000033 736000                    QLS     27
         2 004035   200340 552140                    STBQ    FIELD2,'40'O,AUTO

     1101    16801    2           GETCMD.F2_ = VECTOR(FIELD2) ;

  16801  2 004036   000044 235000 3                  LDA     36
         2 004037   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 004040   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 004041   000340 036003                    ADLQ    224,DU
         2 004042   200003 471500                    LDP1    @GETCMD,,AUTO
         2 004043   100021 755100                    STA     17,,PR1
         2 004044   100022 756100                    STQ     18,,PR1

     1102    16802    2           GETCMD.DCB_PARAM# = OUTDCB# ;

  16802  2 004045   200351 235100                    LDA     OUTDCB#,,AUTO
         2 004046   100014 755100                    STA     12,,PR1

     1103    16803    2           IF XUG.SYNERR

  16803  2 004047   000071 236100                    LDQ     57,,PR0
         2 004050   004000 316003                    CANQ    2048,DU
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:187  
         2 004051   004077 600000 2                  TZE     s:16815

     1104    16804    2           THEN
     1105    16805    2               IF B$JIT.PRFLAGS.POINT

  16805  2 004052   000000 473400 xsym               LDP3    B$JIT$
         2 004053   300030 236100                    LDQ     24,,PR3
         2 004054   000200 316003                    CANQ    128,DU
         2 004055   004061 600000 2                  TZE     s:16809

     1106    16806    2               THEN
     1107    16807    2                   GETCMD.ERR_CODE = XUG#INCOR_PTD_XPND;

  16807  2 004056   000167 236000 0                  LDQ     XUG#INCOR_PTD_XPND
         2 004057   100010 756100                    STQ     8,,PR1
         2 004060   004101 710000 2                  TRA     s:16816

     1108    16808    2               ELSE
     1109    16809    2                   IF B$JIT.PRFLAGS.EXPOUND AND GETCMD.TREAD# AND NOT XUG.GOODCMD

  16809  2 004061   000100 316003                    CANQ    64,DU
         2 004062   004074 600000 2                  TZE     s:16813
         2 004063   100006 236100                    LDQ     6,,PR1
         2 004064   200000 316003                    CANQ    65536,DU
         2 004065   004074 600000 2                  TZE     s:16813
         2 004066   000071 236100                    LDQ     57,,PR0
         2 004067   000010 316003                    CANQ    8,DU
         2 004070   004074 601000 2                  TNZ     s:16813

     1110    16810    2                   THEN
     1111    16811    2                       GETCMD.ERR_CODE = XUG#INCOR_HERE_XPND;

  16811  2 004071   000170 236000 0                  LDQ     XUG#INCOR_HERE_XPND
         2 004072   100010 756100                    STQ     8,,PR1
         2 004073   004101 710000 2                  TRA     s:16816

     1112    16812    2                   ELSE
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:188  
     1113    16813    2                       GETCMD.ERR_CODE = XUG#INCOR_HERE;

  16813  2 004074   000171 236000 0                  LDQ     XUG#INCOR_HERE
         2 004075   100010 756100                    STQ     8,,PR1
         2 004076   004101 710000 2                  TRA     s:16816

     1114    16814    2           ELSE
     1115    16815    2               GETCMD.ERR_CODE = XUG#PLERRMSG ;

  16815  2 004077   000166 236000 0                  LDQ     XUG#PLERRMSG
         2 004100   100010 756100                    STQ     8,,PR1

     1116    16816    2           CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(EAT_IT) ;

  16816  2 004101   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 004102   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 004103   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 004104   004105 702000 2                  TSX2    EAT_IT

     1117    16817    2   EAT_IT:
     1118    16818    2           GETCMD.ERR_CODE = SAVE_ERR ;

  16818  2 004105   200323 236100       EAT_IT       LDQ     SAVE_ERR,,AUTO
         2 004106   200003 470500                    LDP0    @GETCMD,,AUTO
         2 004107   000010 756100                    STQ     8,,PR0

     1119    16819    2           GETCMD.DCB_PARAM# = SAVE_DCB ;

  16819  2 004110   200324 235100                    LDA     SAVE_DCB,,AUTO
         2 004111   000014 755100                    STA     12,,PR0

     1120    16820    2           GETCMD.F1_ = SAVE_F1 ;

  16820  2 004112   200326 237100                    LDAQ    SAVE_F1,,AUTO
         2 004113   000017 755100                    STA     15,,PR0
         2 004114   000020 756100                    STQ     16,,PR0

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:189  
     1121    16821    2           GETCMD.F2_ = SAVE_F2 ;

  16821  2 004115   200330 237100                    LDAQ    SAVE_F2,,AUTO
         2 004116   000021 755100                    STA     17,,PR0
         2 004117   000022 756100                    STQ     18,,PR0

     1122    16822        /*E*  ERROR:    XUG-E$XUG#PLERRMSG
     1123    16823              MESSAGE0: Error at <?>: '%%U1%<?>%%U2%'
     1124    16824        */
     1125    16825        /*E*  ERROR:    XUG-E$XUG#INCOR_HERE
     1126    16826              MESSAGE0: Incorrect input at <?>: '%%U1%<?>%%U2%'.
     1127    16827        */
     1128    16828        /*E*  ERROR:    XUG-E$XUG#INCOR_HERE_XPND
     1129    16829              MESSAGE0: Incorrect input at <?>: '%%U1%<?>%%U2%'.
     1130    16830                        Type a "?" for details.
     1131    16831        */
     1132    16832        /*E*  ERROR:    XUG-E$XUG#INCOR_PTD_XPND
     1133    16833              MESSAGE0: Incorrect input at the "^".  Type a "?" for details.
     1134    16834        */
     1135    16835    2       END ;                        /* Else Do */

     1136    16836    1   DO_SINPUT:
     1137    16837    1       XUG.POINTED_TO_SYNERR = XUG.SYNERR | XUG.QM_AFTER_SYNERR;

  16837  2 004120   200220 470500       DO_SINPUT    LDP0    XUG$,,AUTO
         2 004121   000071 236100                    LDQ     57,,PR0
         2 004122   000024 736000                    QLS     20
         2 004123   400000 376003                    ANQ     -131072,DU
         2 004124   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 004125   000071 236100                    LDQ     57,,PR0
         2 004126   000006 736000                    QLS     6
         2 004127   400000 376003                    ANQ     -131072,DU
         2 004130   200432 276100                    ORQ     LEGAL_TEXTC+17,,AUTO
         2 004131   000023 772000                    QRL     19
         2 004132   000071 676100                    ERQ     57,,PR0
         2 004133   200000 376007                    ANQ     65536,DL
         2 004134   000071 656100                    ERSQ    57,,PR0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:190  
         2 004135   004140 710000 2                  TRA     s:16839

     1138    16838    1   XUG$SINPUT: ENTRY (GETCMD) ALTRET;

  16838  2 004136   000000 700200 xent  XUG$SINPUT   TSX0  ! X66_AUTO_2
         2 004137   000440 000002                    ZERO    288,2

     1139    16839    1       XUG$ = GETCMD.WORK$ ;

  16839  2 004140   200003 470500                    LDP0    @GETCMD,,AUTO
         2 004141   000004 236100                    LDQ     4,,PR0
         2 004142   200220 756100                    STQ     XUG$,,AUTO

     1140    16840    1       CSIZE = XUG.CPOS ;

  16840  2 004143   200220 471500                    LDP1    XUG$,,AUTO
         2 004144   100104 235100                    LDA     68,,PR1
         2 004145   200254 755100                    STA     CSIZE,,AUTO

     1141    16841    1       IF GETCMD.TREAD# AND NOT GETCMD.CONTINUED# AND CSIZE < 255

  16841  2 004146   000006 236100                    LDQ     6,,PR0
         2 004147   200000 316003                    CANQ    65536,DU
         2 004150   004404 600000 2                  TZE     SINPUT_ERR
         2 004151   100000 316003                    CANQ    32768,DU
         2 004152   004404 601000 2                  TNZ     SINPUT_ERR
         2 004153   000377 115007                    CMPA    255,DL
         2 004154   004404 605000 2                  TPL     SINPUT_ERR
         2 004155   000000 473400 xsym               LDP3    B$JIT$
         2 004156   300156 236100                    LDQ     110,,PR3
         2 004157   000033 772000                    QRL     27
         2 004160   000003 116007                    CMPQ    3,DL
         2 004161   004163 603000 2                  TRC     s:16841+13
         2 004162   000003 236007                    LDQ     3,DL
         2 004163   000000 116003                    CMPQ    0,DU
         2 004164   004404 604000 2                  TMI     SINPUT_ERR
         2 004165   200254 116100                    CMPQ    CSIZE,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:191  
         2 004166   004404 605400 2                  TPNZ    SINPUT_ERR
         2 004167   300030 236100                    LDQ     24,,PR3
         2 004170   000040 316003                    CANQ    32,DU
         2 004171   004177 601000 2                  TNZ     s:16845
         2 004172   100267 220100                    LDX0    183,,PR1
         2 004173   004404 604400 2                  TMOZ    SINPUT_ERR
         2 004174   100266 236100                    LDQ     182,,PR1
         2 004175   100000 316007                    CANQ    32768,DL
         2 004176   004404 600000 2                  TZE     SINPUT_ERR

     1142    16842    1         AND CSIZE >= MAXIMUM (B$JIT.SINPUTSZ, 3)
     1143    16843    1         AND (B$JIT.PRFLAGS.POSITION OR (XUG.CCBUF_OFFC>0 AND XUG.DONT_REREAD_CCBUF))
     1144    16844    2       THEN DO;

     1145    16845    2           FPT_SINPUT = FPT_SINPUT_C ;

  16845  2 004177   000100 100400                    MLR     fill='000'O
         2 004200   000150 000040 0                  ADSC9   FPT_SINPUT_C             cn=0,n=32
         2 004201   200140 000040                    ADSC9   FPT_SINPUT,,AUTO         cn=0,n=32

     1146    16846    2           FPT_SINPUT.V_ = VECTOR(FPT_SINPUT.V) ;

  16846  2 004202   000002 235000 3                  LDA     2
         2 004203   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 004204   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 004205   000146 036003                    ADLQ    102,DU
         2 004206   200140 757100                    STAQ    FPT_SINPUT,,AUTO

     1147    16847    2           FPT_SINPUT.V.DCB# = GETCMD.INDCB# ;

  16847  2 004207   000012 720100                    LXL0    10,,PR0
         2 004210   200146 740100                    STX0    FPT_SINPUT+6,,AUTO

     1148    16848    2           XUG.BUF = ' ' ;

  16848  2 004211   040100 100400                    MLR     fill='040'O
         2 004212   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:192  
         2 004213   100300 000454                    ADSC9   192,,PR1                 cn=0,n=300

     1149    16849    2           POFF = 0 ;

  16849  2 004214   200256 450100                    STZ     POFF,,AUTO

     1150    16850    2           IF GETCMD.RCVD_PROMPT#

  16850  2 004215   000006 236100                    LDQ     6,,PR0
         2 004216   020000 316003                    CANQ    8192,DU
         2 004217   004222 600000 2                  TZE     s:16853

     1151    16851    2           THEN
     1152    16852    2               POFF = XUG.POFF ;

  16852  2 004220   100036 235100                    LDA     30,,PR1
         2 004221   200256 755100                    STA     POFF,,AUTO

     1153    16853    2           TO$ = ADDR(XUG.BUF) ;

  16853  2 004222   200220 236100                    LDQ     XUG$,,AUTO
         2 004223   000300 036003                    ADLQ    192,DU
         2 004224   200231 756100                    STQ     TO$,,AUTO

     1154    16854    2           IF B$JIT.PRFLAGS.POSITION

  16854  2 004225   300030 236100                    LDQ     24,,PR3
         2 004226   000040 316003                    CANQ    32,DU
         2 004227   004251 600000 2                  TZE     s:16863

     1155    16855    3           THEN DO;

     1156    16856    3               TCSIZE = 0 ;

  16856  2 004230   200255 450100                    STZ     TCSIZE,,AUTO

     1157    16857    3               IF NOT XUG.DONT_REREAD_CCBUF
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:193  

  16857  2 004231   100266 236100                    LDQ     182,,PR1
         2 004232   100000 316007                    CANQ    32768,DL
         2 004233   004237 601000 2                  TNZ     s:16860

     1158    16858    3               THEN
     1159    16859    3                   TCSIZE = XUG.CCBUF_OFFC ;

  16859  2 004234   100267 236100                    LDQ     183,,PR1
         2 004235   000022 732000                    QRS     18
         2 004236   200255 756100                    STQ     TCSIZE,,AUTO

     1160    16860    3               TO$ -> UBIN$BUF9 = EPOS + POFF + TCSIZE + 1 ;

  16860  2 004237   200252 236100                    LDQ     EPOS,,AUTO
         2 004240   200256 036100                    ADLQ    POFF,,AUTO
         2 004241   200255 036100                    ADLQ    TCSIZE,,AUTO
         2 004242   000001 036007                    ADLQ    1,DL
         2 004243   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 004244   200231 474500                    LDP4    TO$,,AUTO
         2 004245   003100 061500                    CSR     bolr='003'O
         2 004246   200432 000044                    BDSC    LEGAL_TEXTC+17,,AUTO     by=0,bit=0,n=36
         2 004247   400000 000011                    BDSC    0,,PR4                   by=0,bit=0,n=9

     1161    16861    3           END;

  16861  2 004250   004255 710000 2                  TRA     s:16864

     1162    16862    2           ELSE
     1163    16863    2               TO$ -> UBIN$BUF9 = 0 ;

  16863  2 004251   200231 474500                    LDP4    TO$,,AUTO
         2 004252   003100 061400                    CSR     bolr='003'O
         2 004253   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         2 004254   400000 000011                    BDSC    0,,PR4                   by=0,bit=0,n=9

     1164    16864    2           TO$ = PINCRC(TO$, 1) ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:194  

  16864  2 004255   200231 236100                    LDQ     TO$,,AUTO
         2 004256   200000 036007                    ADLQ    65536,DL
         2 004257   200231 756100                    STQ     TO$,,AUTO

     1165    16865    2           IF GETCMD.RCVD_PROMPT#

  16865  2 004260   000006 236100                    LDQ     6,,PR0
         2 004261   020000 316003                    CANQ    8192,DU
         2 004262   004306 600000 2                  TZE     s:16873

     1166    16866    3           THEN DO;

     1167    16867    3               TCSIZE = CSIZE ;

  16867  2 004263   200254 235100                    LDA     CSIZE,,AUTO
         2 004264   200255 755100                    STA     TCSIZE,,AUTO

     1168    16868    3               CSIZE = POFF ;

  16868  2 004265   200256 235100                    LDA     POFF,,AUTO
         2 004266   200254 755100                    STA     CSIZE,,AUTO

     1169    16869    3               TO$ -> CHARBASE = SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),POFF) ;

  16869  2 004267   100071 236100                    LDQ     57,,PR1
         2 004270   000024 772000                    QRL     20
         2 004271   000001 376007                    ANQ     1,DL
         2 004272   000000 620005                    EAX0    0,AL
         2 004273   200231 474500                    LDP4    TO$,,AUTO
         2 004274   200254 721100                    LXL1    CSIZE,,AUTO
         2 004275   040140 100546                    MLR     fill='040'O
         2 004276   100037 000010                    ADSC9   31,Q,PR1                 cn=0,n=*X0
         2 004277   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1

     1170    16870    3               TO$ = PINCRC(TO$, POFF) ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:195  
  16870  2 004300   200256 236100                    LDQ     POFF,,AUTO
         2 004301   000020 736000                    QLS     16
         2 004302   200231 036100                    ADLQ    TO$,,AUTO
         2 004303   200231 756100                    STQ     TO$,,AUTO

     1171    16871    3               CSIZE = TCSIZE ;

  16871  2 004304   200255 235100                    LDA     TCSIZE,,AUTO
         2 004305   200254 755100                    STA     CSIZE,,AUTO

     1172    16872    3           END;

     1173    16873    2           TCSIZE = 0 ;

  16873  2 004306   200255 450100                    STZ     TCSIZE,,AUTO

     1174    16874    2           IF XUG.CCBUF_OFFC > 0 AND NOT XUG.DONT_REREAD_CCBUF

  16874  2 004307   100267 220100                    LDX0    183,,PR1
         2 004310   004330 604400 2                  TMOZ    s:16880
         2 004311   100266 236100                    LDQ     182,,PR1
         2 004312   100000 316007                    CANQ    32768,DL
         2 004313   004330 601000 2                  TNZ     s:16880

     1175    16875    3           THEN DO;

     1176    16876    3               SUBSTR( TO$ -> CHARBASE , 0 , XUG.CCBUF_OFFC ) = B$JIT.CCBUF ;

  16876  2 004314   200231 474500                    LDP4    TO$,,AUTO
         2 004315   040140 100500                    MLR     fill='040'O
         2 004316   300033 000400                    ADSC9   27,,PR3                  cn=0,n=256
         2 004317   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

     1177    16877    3               TO$ = PINCRC( TO$ , XUG.CCBUF_OFFC );

  16877  2 004320   100267 236100                    LDQ     183,,PR1
         2 004321   000022 732000                    QRS     18
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:196  
         2 004322   000020 736000                    QLS     16
         2 004323   200231 036100                    ADLQ    TO$,,AUTO
         2 004324   200231 756100                    STQ     TO$,,AUTO

     1178    16878    3               TCSIZE = XUG.CCBUF_OFFC ;

  16878  2 004325   100267 236100                    LDQ     183,,PR1
         2 004326   000022 732000                    QRS     18
         2 004327   200255 756100                    STQ     TCSIZE,,AUTO

     1179    16879    3           END;

     1180    16880    2           TO$ -> CHARBASE = VBASE( XUG.BUFVEC )-> CHARBASE ;

  16880  2 004330   100001 474500                    LDP4    1,,PR1
         2 004331   200254 720100                    LXL0    CSIZE,,AUTO
         2 004332   200231 475500                    LDP5    TO$,,AUTO
         2 004333   040140 100540                    MLR     fill='040'O
         2 004334   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
         2 004335   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0

     1181    16881    2           IF XUG.CCBUF_REST > 0 AND NOT XUG.DONT_REREAD_CCBUF

  16881  2 004336   100267 720100                    LXL0    183,,PR1
         2 004337   004365 604400 2                  TMOZ    s:16887
         2 004340   100266 236100                    LDQ     182,,PR1
         2 004341   100000 316007                    CANQ    32768,DL
         2 004342   004365 601000 2                  TNZ     s:16887

     1182    16882    3           THEN DO;

     1183    16883    3               SUBSTR( PINCRC( TO$ , CSIZE )-> CHARBASE , 0 , XUG.CCBUF_REST ) =

  16883  2 004343   100267 236100                    LDQ     183,,PR1
         2 004344   000022 736000                    QLS     18
         2 004345   000022 732000                    QRS     18
         2 004346   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:197  
         2 004347   300032 236100                    LDQ     26,,PR3
         2 004350   000022 732000                    QRS     18
         2 004351   200432 136100                    SBLQ    LEGAL_TEXTC+17,,AUTO
         2 004352   777377 621006                    EAX1    -257,QL
         2 004353   777777 661003                    ERX1    -1,DU
         2 004354   200254 235100                    LDA     CSIZE,,AUTO
         2 004355   040145 100546                    MLR     fill='040'O
         2 004356   300033 000011                    ADSC9   27,Q,PR3                 cn=0,n=*X1
         2 004357   500000 000010                    ADSC9   0,A,PR5                  cn=0,n=*X0

     1184    16884    3                 SUBSTR( B$JIT.CCBUF , B$JIT.CCARS - XUG.CCBUF_REST );
     1185    16885    3               TCSIZE = TCSIZE + XUG.CCBUF_REST ;

  16885  2 004360   100267 236100                    LDQ     183,,PR1
         2 004361   000022 736000                    QLS     18
         2 004362   000022 732000                    QRS     18
         2 004363   200255 036100                    ADLQ    TCSIZE,,AUTO
         2 004364   200255 756100                    STQ     TCSIZE,,AUTO

     1186    16886    3           END;

     1187    16887    2           FPT_SINPUT.BUF_ = VECTOR(XUG.BUF) ;

  16887  2 004365   000040 235000 3                  LDA     32
         2 004366   200220 236100                    LDQ     XUG$,,AUTO
         2 004367   000300 036003                    ADLQ    192,DU
         2 004370   200144 757100                    STAQ    FPT_SINPUT+4,,AUTO

     1188    16888    2           FPT_SINPUT.BUF_.BOUND = CSIZE + TCSIZE + POFF ;

  16888  2 004371   200254 236100                    LDQ     CSIZE,,AUTO
         2 004372   200255 036100                    ADLQ    TCSIZE,,AUTO
         2 004373   200256 036100                    ADLQ    POFF,,AUTO
         2 004374   000020 736000                    QLS     16
         2 004375   200144 676100                    ERQ     FPT_SINPUT+4,,AUTO
         2 004376   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 004377   200144 656100                    ERSQ    FPT_SINPUT+4,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:198  

     1189    16889    2           CALL M$SINPUT(FPT_SINPUT) ALTRET(SINPUT_ERR) ;

  16889  2 004400   200140 630500                    EPPR0   FPT_SINPUT,,AUTO
         2 004401   560013 713400                    CLIMB   alt,+57355
         2 004402   401000 401760                    pmme    nvectors=3
         2 004403   004404 702000 2                  TSX2    SINPUT_ERR

     1190    16890    2   SINPUT_ERR:
     1191    16891    2       END ;                        /* Then Do */

  16891  2 004404                       SINPUT_ERR   null
     1192    16892    1       RETURN;

  16892  2 004404   000000 702200 xent               TSX2  ! X66_ARET

     1193    16893        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:199  
     1194    16894    1   XUG$ECHOIF_COMMON: ENTRY(GETCMD) ALTRET;

  16894  2 004405   000000 700200 xent  XUG$ECHOIF_* TSX0  ! X66_AUTO_2
         2 004406   000440 000002                    ZERO    288,2

     1195    16895    1       XUG$ = GETCMD.WORK$ ;

  16895  2 004407   200003 470500                    LDP0    @GETCMD,,AUTO
         2 004410   000004 236100                    LDQ     4,,PR0
         2 004411   200220 756100                    STQ     XUG$,,AUTO

     1196    16896    1       IF GETCMD.DCB_PARAM# = DCBNUM( NIL )

  16896  2 004412   000014 235100                    LDA     12,,PR0
         2 004413   004416 601000 2                  TNZ     s:16899

     1197    16897    1       THEN
     1198    16898    1           GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;

  16898  2 004414   000013 235100                    LDA     11,,PR0
         2 004415   000014 755100                    STA     12,,PR0

     1199    16899    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)

  16899  2 004416   004421 600000 2                  TZE     s:16903

     1200    16900    1       THEN
     1201    16901    1           OUTDCB# = GETCMD.DCB_PARAM# ;

  16901  2 004417   200351 755100                    STA     OUTDCB#,,AUTO
         2 004420   004431 710000 2                  TRA     s:16904

     1202    16902    1       ELSE
     1203    16903    1           CALL XUG$GETDCB_COMMON(M$LO,OUTDCB#) ALTRET(MALT) ;

  16903  2 004421   200351 631500                    EPPR1   OUTDCB#,,AUTO
         2 004422   200433 451500                    STP1    LEGAL_TEXTC+18,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:200  
         2 004423   000016 236000 3                  LDQ     14
         2 004424   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 004425   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 004426   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004427   000000 701000 xent               TSX1    XUG$GETDCB_COMMON
         2 004430   002543 702000 2                  TSX2    MALT

     1204    16904    1       IF DCBADDR(XUG.DCBS.NUM(0))->F$DCB.DDEV.XEQ# THEN I=1;

  16904  2 004431   000023 470400 3                  LDP0    19
         2 004432   000000 471500                    LDP1    0,,PR0
         2 004433   200220 473500                    LDP3    XUG$,,AUTO
         2 004434   300113 220100                    LDX0    75,,PR3
         2 004435   100000 474510                    LDP4    0,X0,PR1
         2 004436   400004 236100                    LDQ     4,,PR4
         2 004437   040000 316007                    CANQ    16384,DL
         2 004440   004444 600000 2                  TZE     s:16905

  16904  2 004441   000001 235007                    LDA     1,DL
         2 004442   200250 755100                    STA     I,,AUTO
         2 004443   004445 710000 2                  TRA     s:16906

     1205    16905    1       ELSE I=0;

  16905  2 004444   200250 450100                    STZ     I,,AUTO

     1206    16906    2       DO I=I TO XUG.NDCBS;

  16906  2 004445   004465 710000 2                  TRA     s:16909+1

     1207    16907    2           CALL XUG$CORRES_COMMON(OUTDCB#,BINBIT(XUG.DCBS.NUM(I),36))

  16907  2 004446   200250 235100                    LDA     I,,AUTO
         2 004447   000001 735000                    ALS     1
         2 004450   200220 470500                    LDP0    XUG$,,AUTO
         2 004451   000113 236105                    LDQ     75,AL,PR0
         2 004452   000022 772000                    QRL     18
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:201  
         2 004453   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 004454   200432 631500                    EPPR1   LEGAL_TEXTC+17,,AUTO
         2 004455   200435 451500                    STP1    LEGAL_TEXTC+20,,AUTO
         2 004456   200351 633500                    EPPR3   OUTDCB#,,AUTO
         2 004457   200434 453500                    STP3    LEGAL_TEXTC+19,,AUTO
         2 004460   200434 630500                    EPPR0   LEGAL_TEXTC+19,,AUTO
         2 004461   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004462   000000 701000 xent               TSX1    XUG$CORRES_COMMON
         2 004463   005044 702000 2                  TSX2    NO_ECHO

     1208    16908    2             ALTRET(NO_ECHO);
     1209    16909    2       END;

  16909  2 004464   200250 054100                    AOS     I,,AUTO
         2 004465   200220 470500                    LDP0    XUG$,,AUTO
         2 004466   200250 236100                    LDQ     I,,AUTO
         2 004467   000112 116100                    CMPQ    74,,PR0
         2 004470   004446 604400 2                  TMOZ    s:16907

     1210    16910    1       GOTO MAYBE_ECHO ;

  16910  2 004471   004516 710000 2                  TRA     MAYBE_ECHO

     1211    16911    1   XUG$ECHO_COMMON: ENTRY(GETCMD) ALTRET;

  16911  2 004472   000000 700200 xent  XUG$ECHO_CO* TSX0  ! X66_AUTO_2
         2 004473   000440 000002                    ZERO    288,2

     1212    16912    1       XUG$ = GETCMD.WORK$ ;

  16912  2 004474   200003 470500                    LDP0    @GETCMD,,AUTO
         2 004475   000004 236100                    LDQ     4,,PR0
         2 004476   200220 756100                    STQ     XUG$,,AUTO

     1213    16913    1       IF GETCMD.DCB_PARAM# = DCBNUM( NIL )

  16913  2 004477   000014 235100                    LDA     12,,PR0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:202  
         2 004500   004503 601000 2                  TNZ     s:16916

     1214    16914    1       THEN
     1215    16915    1           GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;

  16915  2 004501   000013 235100                    LDA     11,,PR0
         2 004502   000014 755100                    STA     12,,PR0

     1216    16916    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)

  16916  2 004503   004506 600000 2                  TZE     s:16920

     1217    16917    1       THEN
     1218    16918    1           OUTDCB# = GETCMD.DCB_PARAM# ;

  16918  2 004504   200351 755100                    STA     OUTDCB#,,AUTO
         2 004505   004516 710000 2                  TRA     MAYBE_ECHO

     1219    16919    1       ELSE
     1220    16920    1           CALL XUG$GETDCB_COMMON(M$LO,OUTDCB#) ALTRET(MALT) ;

  16920  2 004506   200351 631500                    EPPR1   OUTDCB#,,AUTO
         2 004507   200433 451500                    STP1    LEGAL_TEXTC+18,,AUTO
         2 004510   000016 236000 3                  LDQ     14
         2 004511   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 004512   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 004513   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004514   000000 701000 xent               TSX1    XUG$GETDCB_COMMON
         2 004515   002543 702000 2                  TSX2    MALT

  16916  2 004516                       MAYBE_ECHO   null
     1221    16921    1   MAYBE_ECHO: ;
     1222    16922    1       GETCMD.DCB_PARAM# = OUTDCB# ;

  16922  2 004516   200351 235100                    LDA     OUTDCB#,,AUTO
         2 004517   200003 470500                    LDP0    @GETCMD,,AUTO
         2 004520   000014 755100                    STA     12,,PR0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:203  

     1223    16923    1       IF DCBADDR(GETCMD.INDCB#) -> F$DCB.DVBYTE.TRANS#

  16923  2 004521   000023 471400 3                  LDP1    19
         2 004522   100000 473500                    LDP3    0,,PR1
         2 004523   000012 720100                    LXL0    10,,PR0
         2 004524   300000 474510                    LDP4    0,X0,PR3
         2 004525   400003 236100                    LDQ     3,,PR4
         2 004526   020000 316003                    CANQ    8192,DU
         2 004527   005044 601000 2                  TNZ     NO_ECHO

     1224    16924    1       THEN
     1225    16925    1           GOTO NO_ECHO ;
     1226    16926    1       IF XUG.NDCBS < 9 THEN

  16926  2 004530   200220 475500                    LDP5    XUG$,,AUTO
         2 004531   500112 235100                    LDA     74,,PR5
         2 004532   000011 115007                    CMPA    9,DL
         2 004533   004535 605000 2                  TPL     s:16928

     1227    16927    1           XUG.NDCBS=XUG.NDCBS+1;

  16927  2 004534   500112 054100                    AOS     74,,PR5

     1228    16928    1       XUG.DCBS.NUM(XUG.NDCBS)=OUTDCB# ;

  16928  2 004535   500112 235100                    LDA     74,,PR5
         2 004536   000001 735000                    ALS     1
         2 004537   200351 720100                    LXL0    OUTDCB#,,AUTO
         2 004540   500113 740105                    STX0    75,AL,PR5

     1229    16929    1       XUG.DCBS.ERRPTR_CPOS(XUG.NDCBS) = -1;

  16929  2 004541   500112 235100                    LDA     74,,PR5
         2 004542   000001 735000                    ALS     1
         2 004543   777777 220003                    LDX0    -1,DU
         2 004544   500113 440105                    SXL0    75,AL,PR5
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:204  

     1230    16930    1       CNT = 0 ;

  16930  2 004545   200350 450100                    STZ     CNT,,AUTO

     1231    16931    2       DO J=1 TO XUG.NLINES-1 ;

  16931  2 004546   000001 235007                    LDA     1,DL
         2 004547   200251 755100                    STA     J,,AUTO
         2 004550   004563 710000 2                  TRA     s:16933+1

     1232    16932    2           CNT = CNT + VBASE(XUG.RLTVEC) ->RLT(J) ;

  16932  2 004551   200220 470500                    LDP0    XUG$,,AUTO
         2 004552   000013 471500                    LDP1    11,,PR0
         2 004553   200251 235100                    LDA     J,,AUTO
         2 004554   000100 101505                    MRL     fill='000'O
         2 004555   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 004556   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 004557   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 004560   200350 036100                    ADLQ    CNT,,AUTO
         2 004561   200350 756100                    STQ     CNT,,AUTO

     1233    16933    2       END ;                        /* Do J */

  16933  2 004562   200251 054100                    AOS     J,,AUTO
         2 004563   200220 470500                    LDP0    XUG$,,AUTO
         2 004564   200251 236100                    LDQ     J,,AUTO
         2 004565   000106 116100                    CMPQ    70,,PR0
         2 004566   004551 604000 2                  TMI     s:16932

     1234    16934    1       XUG.CPOS = CNT ;

  16934  2 004567   200350 235100                    LDA     CNT,,AUTO
         2 004570   000104 755100                    STA     68,,PR0

     1235    16935    1       FPT_WRITE = FPT_WRITE_C;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:205  

  16935  2 004571   000100 100400                    MLR     fill='000'O
         2 004572   000030 000060 0                  ADSC9   FPT_WRITE_C              cn=0,n=48
         2 004573   200020 000060                    ADSC9   FPT_WRITE,,AUTO          cn=0,n=48

     1236    16936    1       FPT_WRITE.V_ = VECTOR(FPT_WRITE.V);

  16936  2 004574   000037 235000 3                  LDA     31
         2 004575   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 004576   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 004577   000030 036003                    ADLQ    24,DU
         2 004600   200020 757100                    STAQ    FPT_WRITE,,AUTO

     1237    16937    1       FPT_WRITE.V.DCB#=OUTDCB# ;

  16937  2 004601   200351 720100                    LXL0    OUTDCB#,,AUTO
         2 004602   200030 740100                    STX0    FPT_WRITE+8,,AUTO

     1238    16938    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, OUTDCB#);

  16938  2 004603   200351 631500                    EPPR1   OUTDCB#,,AUTO
         2 004604   200433 451500                    STP1    LEGAL_TEXTC+18,,AUTO
         2 004605   200003 236100                    LDQ     @GETCMD,,AUTO
         2 004606   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 004607   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 004610   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 004611   000000 701000 xent               TSX1    XUG$OPENOUT_INTERNAL
         2 004612   000000 011000                    NOP     0

     1239    16939    1       IF GETCMD.RPROMPT_~=VECTOR(NIL) AND

  16939  2 004613   200003 470500                    LDP0    @GETCMD,,AUTO
         2 004614   000000 106500                    CMPC    fill='000'O
         2 004615   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         2 004616   000004 000010 3                  ADSC9   4                        cn=0,n=8
         2 004617   004645 600000 2                  TZE     s:16948
         2 004620   000000 106500                    CMPC    fill='000'O
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:206  
         2 004621   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         2 004622   000046 000010 3                  ADSC9   38                       cn=0,n=8
         2 004623   004645 600000 2                  TZE     s:16948

     1240    16940    1         GETCMD.RPROMPT_~=VECTOR(ERASE)
     1241    16941    2       THEN DO;

     1242    16942    2           POFF = VBOUND(GETCMD.RPROMPT_)+1 ;

  16942  2 004624   000027 236100                    LDQ     23,,PR0
         2 004625   000020 772000                    QRL     16
         2 004626   000001 036007                    ADLQ    1,DL
         2 004627   200256 756100                    STQ     POFF,,AUTO

     1243    16943    2           CSIZE = POFF ;

  16943  2 004630   200254 756100                    STQ     CSIZE,,AUTO

     1244    16944    2           PROMPT_BUF = VBASE(GETCMD.RPROMPT_) -> CHARBASE ;

  16944  2 004631   000030 471500                    LDP1    24,,PR0
         2 004632   000000 620006                    EAX0    0,QL
         2 004633   040100 100540                    MLR     fill='040'O
         2 004634   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         2 004635   200263 000136                    ADSC9   PROMPT_BUF,,AUTO         cn=0,n=94

     1245    16945    2           FPT_WRITE.V.DVBYTE.VFC# = XUG.PROMPT_VFC ;

  16945  2 004636   200220 473500                    LDP3    XUG$,,AUTO
         2 004637   300071 236100                    LDQ     57,,PR3
         2 004640   000015 736000                    QLS     13
         2 004641   200033 676100                    ERQ     FPT_WRITE+11,,AUTO
         2 004642   100000 376003                    ANQ     32768,DU
         2 004643   200033 656100                    ERSQ    FPT_WRITE+11,,AUTO

     1246    16946    2       END ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:207  
  16946  2 004644   004657 710000 2                  TRA     s:16951

     1247    16947    2       ELSE DO;

     1248    16948    2           POFF = XUG.POFF;

  16948  2 004645   200220 471500                    LDP1    XUG$,,AUTO
         2 004646   100036 235100                    LDA     30,,PR1
         2 004647   200256 755100                    STA     POFF,,AUTO

     1249    16949    2           PROMPT_BUF = SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),POFF);

  16949  2 004650   100071 236100                    LDQ     57,,PR1
         2 004651   000024 772000                    QRL     20
         2 004652   000001 376007                    ANQ     1,DL
         2 004653   000000 620005                    EAX0    0,AL
         2 004654   040100 100546                    MLR     fill='040'O
         2 004655   100037 000010                    ADSC9   31,Q,PR1                 cn=0,n=*X0
         2 004656   200263 000136                    ADSC9   PROMPT_BUF,,AUTO         cn=0,n=94

     1250    16950    2       END;

     1251    16951    1       CNT = 0 ;

  16951  2 004657   200350 450100                    STZ     CNT,,AUTO

     1252    16952    1       OUTPUT_WIDTH = DCBADDR(OUTDCB#) -> F$DCB.WIDTH#;

  16952  2 004660   000023 471400 3                  LDP1    19
         2 004661   100000 473500                    LDP3    0,,PR1
         2 004662   200351 720100                    LXL0    OUTDCB#,,AUTO
         2 004663   300000 474510                    LDP4    0,X0,PR3
         2 004664   400004 236100                    LDQ     4,,PR4
         2 004665   000777 376007                    ANQ     511,DL
         2 004666   200262 756100                    STQ     OUTPUT_WIDTH,,AUTO

     1253    16953    1       IF OUTPUT_WIDTH = 0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:208  

  16953  2 004667   004672 601000 2                  TNZ     s:16956

     1254    16954    1       THEN
     1255    16955    1           OUTPUT_WIDTH = 511;

  16955  2 004670   000777 235007                    LDA     511,DL
         2 004671   200262 755100                    STA     OUTPUT_WIDTH,,AUTO

     1256    16956    2       DO I=1 TO XUG.NLINES;

  16956  2 004672   000001 235007                    LDA     1,DL
         2 004673   200250 755100                    STA     I,,AUTO
         2 004674   005037 710000 2                  TRA     s:16986+1

     1257    16957    2           OUTPUT_COUNT = POFF+VBASE(XUG.RLTVEC)->RLT(I);

  16957  2 004675   200220 470500                    LDP0    XUG$,,AUTO
         2 004676   000013 471500                    LDP1    11,,PR0
         2 004677   200250 235100                    LDA     I,,AUTO
         2 004700   000100 101505                    MRL     fill='000'O
         2 004701   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 004702   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 004703   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 004704   200256 036100                    ADLQ    POFF,,AUTO
         2 004705   200261 756100                    STQ     OUTPUT_COUNT,,AUTO

     1258    16958    2           CALL CONCAT(XUG.BUF,SUBSTR(PROMPT_BUF,0,POFF),

  16958  2 004706   000001 471500                    LDP1    1,,PR0
         2 004707   200256 136100                    SBLQ    POFF,,AUTO
         2 004710   200256 720100                    LXL0    POFF,,AUTO
         2 004711   040100 100540                    MLR     fill='040'O
         2 004712   200263 000010                    ADSC9   PROMPT_BUF,,AUTO         cn=0,n=*X0
         2 004713   000300 000454                    ADSC9   192,,PR0                 cn=0,n=300
         2 004714   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 004715   200256 236100                    LDQ     POFF,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:209  
         2 004716   000454 116007                    CMPQ    300,DL
         2 004717   004727 605000 2                  TPL     s:16960
         2 004720   777323 621006                    EAX1    -301,QL
         2 004721   777777 661003                    ERX1    -1,DU
         2 004722   200432 722100                    LXL2    LEGAL_TEXTC+17,,AUTO
         2 004723   200350 235100                    LDA     CNT,,AUTO
         2 004724   040146 100545                    MLR     fill='040'O
         2 004725   100000 000012                    ADSC9   0,A,PR1                  cn=0,n=*X2
         2 004726   000300 000011                    ADSC9   192,Q,PR0                cn=0,n=*X1

     1259    16959    2             SUBSTR(VBASE(XUG.BUFVEC)->INBUF,CNT, OUTPUT_COUNT-POFF)) ;
     1260    16960    3           DO WHILE (OUTPUT_COUNT > 1);

  16960  2 004727   200261 235100                    LDA     OUTPUT_COUNT,,AUTO
         2 004730   000001 115007                    CMPA    1,DL
         2 004731   004745 604400 2                  TMOZ    s:16966

     1261    16961    3               IF SUBSTR (XUG.BUF, OUTPUT_COUNT - 1, 1) ~= ' '

  16961  2 004732   200220 470500                    LDP0    XUG$,,AUTO
         2 004733   200261 235100                    LDA     OUTPUT_COUNT,,AUTO
         2 004734   040000 106505                    CMPC    fill='040'O
         2 004735   000277 600001                    ADSC9   191,A,PR0                cn=3,n=1
         2 004736   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 004737   004745 601000 2                  TNZ     s:16966

     1262    16962    3               THEN
     1263    16963    3                   EXIT;
     1264    16964    3               OUTPUT_COUNT = OUTPUT_COUNT - 1;

  16964  2 004740   000001 336007                    LCQ     1,DL
         2 004741   200261 056100                    ASQ     OUTPUT_COUNT,,AUTO

     1265    16965    3           END;

  16965  2 004742   200261 235100                    LDA     OUTPUT_COUNT,,AUTO
         2 004743   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:210  
         2 004744   004732 605400 2                  TPNZ    s:16961

     1266    16966    2           IF I~=XUG.NLINES THEN

  16966  2 004745   200250 236100                    LDQ     I,,AUTO
         2 004746   000106 116100                    CMPQ    70,,PR0
         2 004747   004754 600000 2                  TZE     s:16971

     1267    16967    3           DO ;

     1268    16968    3               SUBSTR(XUG.BUF, OUTPUT_COUNT, 1) = ';';

  16968  2 004750   040105 100400                    MLR     fill='040'O
         2 004751   000050 000001 3                  ADSC9   40                       cn=0,n=1
         2 004752   000300 000001                    ADSC9   192,A,PR0                cn=0,n=1

     1269    16969    3               OUTPUT_COUNT = OUTPUT_COUNT + 1;

  16969  2 004753   200261 054100                    AOS     OUTPUT_COUNT,,AUTO

     1270    16970    3           END ; /* Then Do */

     1271    16971    2           OFFSET = 0;

  16971  2 004754   200260 450100                    STZ     OFFSET,,AUTO

     1272    16972    3           DO WHILE (OFFSET < OUTPUT_COUNT);

  16972  2 004755   200260 236100                    LDQ     OFFSET,,AUTO
         2 004756   200261 116100                    CMPQ    OUTPUT_COUNT,,AUTO
         2 004757   005025 605000 2                  TPL     s:16985

     1273    16973    3               CHUNK_SIZE = MINIMUM (OUTPUT_COUNT - OFFSET, OUTPUT_WIDTH);

  16973  2 004760   200261 236100                    LDQ     OUTPUT_COUNT,,AUTO
         2 004761   200260 136100                    SBLQ    OFFSET,,AUTO
         2 004762   200262 116100                    CMPQ    OUTPUT_WIDTH,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:211  
         2 004763   004765 604400 2                  TMOZ    s:16973+5
         2 004764   200262 236100                    LDQ     OUTPUT_WIDTH,,AUTO
         2 004765   200257 756100                    STQ     CHUNK_SIZE,,AUTO

     1274    16974    3               IF XUG.PROMPT_VFC AND OFFSET > 0

  16974  2 004766   200220 470500                    LDP0    XUG$,,AUTO
         2 004767   000071 236100                    LDQ     57,,PR0
         2 004770   000004 316003                    CANQ    4,DU
         2 004771   005003 600000 2                  TZE     s:16980
         2 004772   200260 235100                    LDA     OFFSET,,AUTO
         2 004773   005003 604400 2                  TMOZ    s:16980

     1275    16975    4               THEN DO;

     1276    16976    4                   CHUNK_SIZE = CHUNK_SIZE + 1;

  16976  2 004774   200257 054100                    AOS     CHUNK_SIZE,,AUTO

     1277    16977    4                   OFFSET = OFFSET - 1;

  16977  2 004775   000001 336007                    LCQ     1,DL
         2 004776   200260 056100                    ASQ     OFFSET,,AUTO

     1278    16978    4                   SUBSTR( XUG.BUF, OFFSET, 1 ) = SUBSTR( XUG.BUF, 0, 1 );

  16978  2 004777   200260 235100                    LDA     OFFSET,,AUTO
         2 005000   040105 100500                    MLR     fill='040'O
         2 005001   000300 000001                    ADSC9   192,,PR0                 cn=0,n=1
         2 005002   000300 000001                    ADSC9   192,A,PR0                cn=0,n=1

     1279    16979    4               END;

     1280    16980    3               FPT_WRITE.BUF_ = VECTOR (SUBSTR(XUG.BUF, OFFSET, CHUNK_SIZE));

  16980  2 005003   200257 235100                    LDA     CHUNK_SIZE,,AUTO
         2 005004   000020 735000                    ALS     16
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:212  
         2 005005   000140 135007                    SBLA    96,DL
         2 005006   200260 236100                    LDQ     OFFSET,,AUTO
         2 005007   000020 736000                    QLS     16
         2 005010   000300 036003                    ADLQ    192,DU
         2 005011   200220 036100                    ADLQ    XUG$,,AUTO
         2 005012   200024 757100                    STAQ    FPT_WRITE+4,,AUTO

     1281    16981    4               CALL M$WRITE(FPT_WRITE) WHENALTRETURN DO ;

  16981  2 005013   200020 630500                    EPPR0   FPT_WRITE,,AUTO
         2 005014   440001 713400                    CLIMB   alt,write
         2 005015   401400 401760                    pmme    nvectors=4
         2 005016   005020 702000 2                  TSX2    s:16983
         2 005017   005020 710000 2                  TRA     s:16983

     1282    16982    4               END ;

     1283    16983    3               OFFSET = OFFSET + CHUNK_SIZE;

  16983  2 005020   200260 236100                    LDQ     OFFSET,,AUTO
         2 005021   200257 036100                    ADLQ    CHUNK_SIZE,,AUTO
         2 005022   200260 756100                    STQ     OFFSET,,AUTO

     1284    16984    3           END;

  16984  2 005023   200261 116100                    CMPQ    OUTPUT_COUNT,,AUTO
         2 005024   004760 604000 2                  TMI     s:16973

     1285    16985    2           CNT = CNT + VBASE(XUG.RLTVEC)->RLT(I) ;

  16985  2 005025   200220 470500                    LDP0    XUG$,,AUTO
         2 005026   000013 471500                    LDP1    11,,PR0
         2 005027   200250 235100                    LDA     I,,AUTO
         2 005030   000100 101505                    MRL     fill='000'O
         2 005031   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 005032   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 005033   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:213  
         2 005034   200350 036100                    ADLQ    CNT,,AUTO
         2 005035   200350 756100                    STQ     CNT,,AUTO

     1286    16986    2       END;

  16986  2 005036   200250 054100                    AOS     I,,AUTO
         2 005037   200220 470500                    LDP0    XUG$,,AUTO
         2 005040   200250 236100                    LDQ     I,,AUTO
         2 005041   000106 116100                    CMPQ    70,,PR0
         2 005042   004675 604400 2                  TMOZ    s:16957

     1287    16987    1       RETURN;

  16987  2 005043   000000 702200 xent               TSX2  ! X66_ARET

     1288    16988    1   NO_ECHO:
     1289    16989    1       CNT = 0 ;

  16989  2 005044   200350 450100       NO_ECHO      STZ     CNT,,AUTO

     1290    16990    2       DO J=1 TO XUG.NLINES-1 ;

  16990  2 005045   000001 235007                    LDA     1,DL
         2 005046   200251 755100                    STA     J,,AUTO
         2 005047   005062 710000 2                  TRA     s:16992+1

     1291    16991    2           CNT = CNT + VBASE(XUG.RLTVEC) ->RLT(J) ;

  16991  2 005050   200220 470500                    LDP0    XUG$,,AUTO
         2 005051   000013 471500                    LDP1    11,,PR0
         2 005052   200251 235100                    LDA     J,,AUTO
         2 005053   000100 101505                    MRL     fill='000'O
         2 005054   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
         2 005055   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 005056   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 005057   200350 036100                    ADLQ    CNT,,AUTO
         2 005060   200350 756100                    STQ     CNT,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:214  

     1292    16992    2       END ;                        /* Do J */

  16992  2 005061   200251 054100                    AOS     J,,AUTO
         2 005062   200220 470500                    LDP0    XUG$,,AUTO
         2 005063   200251 236100                    LDQ     J,,AUTO
         2 005064   000106 116100                    CMPQ    70,,PR0
         2 005065   005050 604000 2                  TMI     s:16991

     1293    16993    1       XUG.CPOS = CNT ;

  16993  2 005066   200350 235100                    LDA     CNT,,AUTO
         2 005067   000104 755100                    STA     68,,PR0

     1294    16994    1       RETURN;

  16994  2 005070   000000 702200 xent               TSX2  ! X66_ARET

     1295    16995
     1296    16996        %EJECT ;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:215  
     1297    16997    1   XUG$SETPROMPT: ENTRY (GETCMD) ALTRET ;

  16997  2 005071   000000 700200 xent  XUG$SETPROM* TSX0  ! X66_AUTO_2
         2 005072   000440 000002                    ZERO    288,2

     1298    16998
     1299    16999    1       XUG$ = GETCMD.WORK$ ;

  16999  2 005073   200003 470500                    LDP0    @GETCMD,,AUTO
         2 005074   000004 236100                    LDQ     4,,PR0
         2 005075   200220 756100                    STQ     XUG$,,AUTO

     1300    17000    1       FPT_PROMPT = FPT_PROMPT_C;

  17000  2 005076   000100 100400                    MLR     fill='000'O
         2 005077   000044 000050 0                  ADSC9   FPT_PROMPT_C             cn=0,n=40
         2 005100   200034 000050                    ADSC9   FPT_PROMPT,,AUTO         cn=0,n=40

     1301    17001    1       FPT_PROMPT.V_ = VECTOR(FPT_PROMPT.V);

  17001  2 005101   000037 235000 3                  LDA     31
         2 005102   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 005103   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 005104   000042 036003                    ADLQ    34,DU
         2 005105   200034 757100                    STAQ    FPT_PROMPT,,AUTO

     1302    17002    1       IF GETCMD.INDCB# ~= 0

  17002  2 005106   000012 235100                    LDA     10,,PR0
         2 005107   005114 600000 2                  TZE     s:17008

     1303    17003    2       THEN DO;

     1304    17004    2           J = GETCMD.INDCB#;

  17004  2 005110   200251 755100                    STA     J,,AUTO

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:216  
     1305    17005    2           FPT_PROMPT.V.DCB# = J;

  17005  2 005111   000000 620005                    EAX0    0,AL
         2 005112   200042 740100                    STX0    FPT_PROMPT+6,,AUTO

     1306    17006    2       END;

  17006  2 005113   005116 710000 2                  TRA     s:17009

     1307    17007    1       ELSE
     1308    17008    1           J = DCBNUM(M$UC);

  17008  2 005114   000000 236007 xsym               LDQ     M$UC,DL
         2 005115   200251 756100                    STQ     J,,AUTO

     1309    17009    1       PROMPT_FLG = ( GETCMD.ALWAYS_SET_PROMPT# | XUG.DEFER_SETTING_PROMPT );

  17009  2 005116   200220 471500                    LDP1    XUG$,,AUTO
         2 005117   100266 236100                    LDQ     182,,PR1
         2 005120   000023 736000                    QLS     19
         2 005121   400000 376003                    ANQ     -131072,DU
         2 005122   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 005123   000006 236100                    LDQ     6,,PR0
         2 005124   000007 736000                    QLS     7
         2 005125   400000 376003                    ANQ     -131072,DU
         2 005126   200432 276100                    ORQ     LEGAL_TEXTC+17,,AUTO
         2 005127   200245 756100                    STQ     PROMPT_FLG,,AUTO

     1310    17010    1       XUG.DEFER_SETTING_PROMPT = %NO# ;

  17010  2 005130   000035 236000 3                  LDQ     29
         2 005131   100266 356100                    ANSQ    182,,PR1

     1311    17011    2       IF GETCMD.PROMPT_=VECTOR(NIL) THEN DO;

  17011  2 005132   000000 106500                    CMPC    fill='000'O
         2 005133   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:217  
         2 005134   000004 000010 3                  ADSC9   4                        cn=0,n=8
         2 005135   005154 601000 2                  TNZ     s:17018

     1312    17012    2           IF XUG.POFF > 0 THEN PROMPT_FLG='1'B ;

  17012  2 005136   100036 235100                    LDA     30,,PR1
         2 005137   005142 604400 2                  TMOZ    s:17013

  17012  2 005140   400000 236003                    LDQ     -131072,DU
         2 005141   200245 756100                    STQ     PROMPT_FLG,,AUTO

     1313    17013    2           XUG.POFF=0;

  17013  2 005142   100036 450100                    STZ     30,,PR1

     1314    17014    2           XUG.PROMPT_VFC=%NO#;

  17014  2 005143   000006 236000 3                  LDQ     6
         2 005144   100071 356100                    ANSQ    57,,PR1

     1315    17015    2           XUG.PROMPT=' ';

  17015  2 005145   040100 100400                    MLR     fill='040'O
         2 005146   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005147   100037 000136                    ADSC9   31,,PR1                  cn=0,n=94

     1316    17016    2           FPT_PROMPT.PROMPT_=GETCMD.PROMPT_ ;

  17016  2 005150   000100 100500                    MLR     fill='000'O
         2 005151   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         2 005152   200040 000010                    ADSC9   FPT_PROMPT+4,,AUTO       cn=0,n=8

     1317    17017    2       END;

  17017  2 005153   005244 710000 2                  TRA     s:17036

     1318    17018    2       ELSE IF GETCMD.PROMPT_=VECTOR(ERASE) THEN DO;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:218  

  17018  2 005154   000000 106500                    CMPC    fill='000'O
         2 005155   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         2 005156   000046 000010 3                  ADSC9   38                       cn=0,n=8
         2 005157   005167 601000 2                  TNZ     s:17024

     1319    17019    2               XUG.POFF=0;

  17019  2 005160   100036 450100                    STZ     30,,PR1

     1320    17020    2               XUG.PROMPT_VFC=%NO#;

  17020  2 005161   000006 236000 3                  LDQ     6
         2 005162   100071 356100                    ANSQ    57,,PR1

     1321    17021    2               XUG.PROMPT=' ';

  17021  2 005163   040100 100400                    MLR     fill='040'O
         2 005164   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005165   100037 000136                    ADSC9   31,,PR1                  cn=0,n=94

     1322    17022    2           END ; /* Then Do */

  17022  2 005166   005244 710000 2                  TRA     s:17036

     1323    17023    2           ELSE DO;

     1324    17024    2               PSIZ=VBOUND(GETCMD.PROMPT_) + 1 ;

  17024  2 005167   000025 236100                    LDQ     21,,PR0
         2 005170   000020 772000                    QRL     16
         2 005171   000001 036007                    ADLQ    1,DL
         2 005172   200006 756100                    STQ     PSIZ,,AUTO

     1325    17025    2               I = BITBIN(GETCMD.PROMPT_VFC#) ;

  17025  2 005173   000006 236100                    LDQ     6,,PR0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:219  
         2 005174   000036 772000                    QRL     30
         2 005175   000001 376007                    ANQ     1,DL
         2 005176   200250 756100                    STQ     I,,AUTO

     1326    17026    2               FPT_PROMPT.V.DVBYTE#.VFC# = GETCMD.PROMPT_VFC# ;

  17026  2 005177   000006 236100                    LDQ     6,,PR0
         2 005200   000003 736000                    QLS     3
         2 005201   200044 676100                    ERQ     FPT_PROMPT+8,,AUTO
         2 005202   100000 376003                    ANQ     32768,DU
         2 005203   200044 656100                    ERSQ    FPT_PROMPT+8,,AUTO

     1327    17027    2               FPT_PROMPT.PROMPT_ = GETCMD.PROMPT_ ;

  17027  2 005204   000100 100500                    MLR     fill='000'O
         2 005205   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         2 005206   200040 000010                    ADSC9   FPT_PROMPT+4,,AUTO       cn=0,n=8

     1328    17028    2               POFF = PSIZ - I ;

  17028  2 005207   200006 236100                    LDQ     PSIZ,,AUTO
         2 005210   200250 136100                    SBLQ    I,,AUTO
         2 005211   200256 756100                    STQ     POFF,,AUTO

     1329    17029    2               IF XUG.POFF~=POFF OR XUG.PROMPT_VFC~=GETCMD.PROMPT_VFC# OR

  17029  2 005212   100036 116100                    CMPQ    30,,PR1
         2 005213   005226 601000 2                  TNZ     s:17031
         2 005214   000100 066500                    CMPB    filb='0'B
         2 005215   100071 260001                    BDSC    57,,PR1                  by=1,bit=6,n=1
         2 005216   000006 050001                    BDSC    6,,PR0                   by=0,bit=5,n=1
         2 005217   005226 601000 2                  TNZ     s:17031
         2 005220   000026 473500                    LDP3    22,,PR0
         2 005221   200006 720100                    LXL0    PSIZ,,AUTO
         2 005222   040140 106500                    CMPC    fill='040'O
         2 005223   100037 000136                    ADSC9   31,,PR1                  cn=0,n=94
         2 005224   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:220  
         2 005225   005230 600000 2                  TZE     s:17032

     1330    17030    2                 XUG.PROMPT~=VBASE(GETCMD.PROMPT_)->PROMPT$C.C THEN
     1331    17031    2                   PROMPT_FLG='1'B;

  17031  2 005226   400000 236003                    LDQ     -131072,DU
         2 005227   200245 756100                    STQ     PROMPT_FLG,,AUTO

     1332    17032    2               XUG.POFF=POFF;

  17032  2 005230   200256 235100                    LDA     POFF,,AUTO
         2 005231   100036 755100                    STA     30,,PR1

     1333    17033    2               XUG.PROMPT = VBASE(GETCMD.PROMPT_)->PROMPT$C.C ;

  17033  2 005232   000026 473500                    LDP3    22,,PR0
         2 005233   200006 720100                    LXL0    PSIZ,,AUTO
         2 005234   040100 100540                    MLR     fill='040'O
         2 005235   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 005236   100037 000136                    ADSC9   31,,PR1                  cn=0,n=94

     1334    17034    2               XUG.PROMPT_VFC = GETCMD.PROMPT_VFC# ;

  17034  2 005237   000006 236100                    LDQ     6,,PR0
         2 005240   000012 772000                    QRL     10
         2 005241   100071 676100                    ERQ     57,,PR1
         2 005242   000004 376003                    ANQ     4,DU
         2 005243   100071 656100                    ERSQ    57,,PR1

     1335    17035    2           END;

     1336    17036    1       IF PROMPT_FLG

  17036  2 005244   200245 234100                    SZN     PROMPT_FLG,,AUTO
         2 005245   005314 605000 2                  TPL     s:17057

     1337    17037    2       THEN DO;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:221  

     1338    17038    2           IF GETCMD.TEXT_ ~= VECTOR(NIL)

  17038  2 005246   000034 237100                    LDAQ    28,,PR0
         2 005247   000004 117000 3                  CMPAQ   4
         2 005250   005257 600000 2                  TZE     s:17043
         2 005251   000006 236100                    LDQ     6,,PR0
         2 005252   002000 316003                    CANQ    1024,DU
         2 005253   005257 601000 2                  TNZ     s:17043

     1339    17039    2             AND NOT GETCMD.ALWAYS_SET_PROMPT#
     1340    17040    2           THEN
     1341    17041    2               XUG.DEFER_SETTING_PROMPT = %YES# ;

  17041  2 005254   200000 236007                    LDQ     65536,DL
         2 005255   100266 256100                    ORSQ    182,,PR1
         2 005256   005314 710000 2                  TRA     s:17057

     1342    17042    3           ELSE DO;

     1343    17043    3               IF NOT DCBADDR(J) -> F$DCB.FCD#

  17043  2 005257   000023 473400 3                  LDP3    19
         2 005260   300000 474500                    LDP4    0,,PR3
         2 005261   200251 720100                    LXL0    J,,AUTO
         2 005262   400000 475510                    LDP5    0,X0,PR4
         2 005263   500031 236100                    LDQ     25,,PR5
         2 005264   020000 316007                    CANQ    8192,DL
         2 005265   005304 601000 2                  TNZ     s:17050

     1344    17044    4               THEN DO;

     1345    17045    4                   FPT_OPEN = FPT_OPEN_C;

  17045  2 005266   000100 100400                    MLR     fill='000'O
         2 005267   000056 000350 0                  ADSC9   FPT_OPEN_C               cn=0,n=232
         2 005270   200046 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:222  

     1346    17046    4                   FPT_OPEN.V_ = VECTOR (FPT_OPEN.V);

  17046  2 005271   000051 235000 3                  LDA     41
         2 005272   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 005273   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 005274   000112 036003                    ADLQ    74,DU
         2 005275   200046 757100                    STAQ    FPT_OPEN,,AUTO

     1347    17047    4                   FPT_OPEN.V.DCB# = J;

  17047  2 005276   200112 740100                    STX0    FPT_OPEN+36,,AUTO

     1348    17048    5                   CALL M$OPEN (FPT_OPEN) WHENALTRETURN DO; END;

  17048  2 005277   200046 630500                    EPPR0   FPT_OPEN,,AUTO
         2 005300   450000 713400                    CLIMB   alt,open
         2 005301   410400 401760                    pmme    nvectors=18
         2 005302   005304 702000 2                  TSX2    s:17050
         2 005303   005304 710000 2                  TRA     s:17050

     1349    17049    4               END;

     1350    17050    3               CALL M$PROMPT(FPT_PROMPT)

  17050  2 005304   200034 630500                    EPPR0   FPT_PROMPT,,AUTO
         2 005305   560002 713400                    CLIMB   alt,+57346
         2 005306   401000 401760                    pmme    nvectors=3
         2 005307   005311 702000 2                  TSX2    s:17052
         2 005310   005314 710000 2                  TRA     s:17057

     1351    17051    4               WHENALTRETURN DO;

     1352    17052    4                   XUG.DEFER_SETTING_PROMPT = %YES# ;

  17052  2 005311   200220 470500                    LDP0    XUG$,,AUTO
         2 005312   200000 236007                    LDQ     65536,DL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:223  
         2 005313   000266 256100                    ORSQ    182,,PR0

     1353    17053    4               END;

     1354    17054    3           END;

     1355    17055    2       END;

     1356    17056
     1357    17057    1       RETURN ;

  17057  2 005314   000000 702200 xent               TSX2  ! X66_ARET

     1358    17058        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:224  
     1359    17059    1   MOVER: PROC (VEC, OFFSET, SIZ) ;

  17059  2 005315   200352 741300       MOVER        STX1  ! OUTDCB#+1,,AUTO

     1360    17060
     1361    17061    2   DCL J SBIN ;
     1362    17062    2   DCL VEC VECTOR ;
     1363    17063    2   DCL OFFSET UBIN ;
     1364    17064    2   DCL SIZ UBIN ;
     1365    17065    2   DCL WDS(0:0) BIT(72) DALIGNED BASED ;
     1366    17066    2   DCL TO$ PTR ;
     1367    17067    2   DCL FROM$ PTR ;
     1368    17068
     1369    17069    2       FROM$ = VBASE(VEC) ;

  17069  2 005316   200353 470500                    LDP0    @VEC,,AUTO
         2 005317   000001 236100                    LDQ     1,,PR0
         2 005320   200360 756100                    STQ     FROM$,,AUTO

     1370    17070    2       J = VBOUND(VEC) / 8 ;

  17070  2 005321   000000 236100                    LDQ     0,,PR0
         2 005322   000020 772000                    QRL     16
         2 005323   000003 772000                    QRL     3
         2 005324   200356 756100                    STQ     J,,AUTO

     1371    17071    2       TO$ = PINCRW(FROM$, OFFSET) ;

  17071  2 005325   200354 471500                    LDP1    @OFFSET,,AUTO
         2 005326   100000 720100                    LXL0    0,,PR1
         2 005327   000000 636010                    EAQ     0,X0
         2 005330   200360 036100                    ADLQ    FROM$,,AUTO
         2 005331   200357 756100                    STQ     TO$,,AUTO

     1372    17072    3       DO WHILE (J > 0) ;

  17072  2 005332   200356 235100                    LDA     J,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:225  
         2 005333   005347 604400 2                  TMOZ    s:17076

     1373    17073    3           J = J - 1 ;

  17073  2 005334   000001 336007                    LCQ     1,DL
         2 005335   200356 056100                    ASQ     J,,AUTO

     1374    17074    3           TO$ -> WDS(J) = FROM$ -> WDS(J) ;

  17074  2 005336   200356 235100                    LDA     J,,AUTO
         2 005337   000001 735000                    ALS     1
         2 005340   200360 470500                    LDP0    FROM$,,AUTO
         2 005341   000000 620005                    EAX0    0,AL
         2 005342   000000 237105                    LDAQ    0,AL,PR0
         2 005343   200357 471500                    LDP1    TO$,,AUTO
         2 005344   100000 757110                    STAQ    0,X0,PR1

     1375    17075    3       END ;

  17075  2 005345   200356 235100                    LDA     J,,AUTO
         2 005346   005334 605400 2                  TPNZ    s:17073

     1376    17076    2       VBASE(VEC) = TO$ ;

  17076  2 005347   200357 236100                    LDQ     TO$,,AUTO
         2 005350   200353 470500                    LDP0    @VEC,,AUTO
         2 005351   000001 756100                    STQ     1,,PR0

     1377    17077    2       VBOUND(VEC) = VBOUND(VEC) + SIZ*4 ;

  17077  2 005352   000000 236100                    LDQ     0,,PR0
         2 005353   000020 772000                    QRL     16
         2 005354   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 005355   200355 471500                    LDP1    @SIZ,,AUTO
         2 005356   100000 236100                    LDQ     0,,PR1
         2 005357   000002 736000                    QLS     2
         2 005360   200432 036100                    ADLQ    LEGAL_TEXTC+17,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:226  
         2 005361   000020 736000                    QLS     16
         2 005362   000000 676100                    ERQ     0,,PR0
         2 005363   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 005364   000000 656100                    ERSQ    0,,PR0

     1378    17078
     1379    17079    2       RETURN ;

  17079  2 005365   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 005366   000001 702211                    TSX2  ! 1,X1

     1380    17080    2   END   MOVER ;
     1381    17081        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:227  
     1382    17082    1   REPORT_ALTERNATIVES: PROC;

  17082  2 005367   200352 741300       REPORT_ALTE* STX1  ! OUTDCB#+1,,AUTO

     1383    17083
     1384    17084    2   DCL ONECHAR CHAR (1) BASED;
     1385    17085    2   DCL SAVED_HI_CHAR SBIN WORD;
     1386    17086    2   DCL SAVED_HINODE$ PTR;
     1387    17087    2   DCL SAVED_WK_USED SBIN WORD;
     1388    17088
     1389    17089    2       SAVED_HI_CHAR = P_PCB.HI_CHAR;

  17089  2 005370   200224 470500                    LDP0    P_PCB$,,AUTO
         2 005371   000012 235100                    LDA     10,,PR0
         2 005372   200353 755100                    STA     SAVED_HI_CHAR,,AUTO

     1390    17090    2       SAVED_HINODE$ = P_PCB.HINODE$;

  17090  2 005373   000013 236100                    LDQ     11,,PR0
         2 005374   200354 756100                    STQ     SAVED_HINODE$,,AUTO

     1391    17091    2       SAVED_WK_USED = P_PCB.WK_USED;

  17091  2 005375   000010 236100                    LDQ     8,,PR0
         2 005376   000022 772000                    QRL     18
         2 005377   200355 756100                    STQ     SAVED_WK_USED,,AUTO

     1392    17092
     1393    17093    2       XUG.PARSING_FREE_CMDS = %NO#;

  17093  2 005400   200220 471500                    LDP1    XUG$,,AUTO
         2 005401   000033 236000 3                  LDQ     27
         2 005402   100266 356100                    ANSQ    182,,PR1

     1394    17094    2       CALL X$PARSE (P_PCB);

  17094  2 005403   200224 630500                    EPPR0   P_PCB$,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:228  
         2 005404   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005405   000000 701000 xent               TSX1    X$PARSE
         2 005406   000000 011000                    NOP     0

     1395    17095
     1396    17096    2       IF NOT P_PCB.BLANKONLY

  17096  2 005407   200224 470500                    LDP0    P_PCB$,,AUTO
         2 005410   000005 236100                    LDQ     5,,PR0
         2 005411   004000 316007                    CANQ    2048,DL
         2 005412   005416 600000 2                  TZE     s:17099
         2 005413   000012 236100                    LDQ     10,,PR0
         2 005414   000011 116100                    CMPQ    9,,PR0
         2 005415   005420 600000 2                  TZE     s:17101

     1397    17097    2         OR P_PCB.HI_CHAR ~= P_PCB.NCHARS
     1398    17098    2       THEN
     1399    17099    2           RETURN;

  17099  2 005416   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 005417   000001 702211                    TSX2  ! 1,X1

     1400    17100
     1401    17101    2       PINCRC (P_PCB.TEXT$, P_PCB.NCHARS) -> ONECHAR = ' ';

  17101  2 005420   000011 236100                    LDQ     9,,PR0
         2 005421   000000 471500                    LDP1    0,,PR0
         2 005422   040106 100400                    MLR     fill='040'O
         2 005423   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 005424   100000 000001                    ADSC9   0,Q,PR1                  cn=0,n=1

     1402    17102    2       P_PCB.NCHARS = P_PCB.NCHARS + 1;

  17102  2 005425   000011 235100                    LDA     9,,PR0
         2 005426   000001 035007                    ADLA    1,DL
         2 005427   000011 755100                    STA     9,,PR0

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:229  
     1403    17103    2       P_PCB.NXT = %NO#;

  17103  2 005430   000026 236000 3                  LDQ     22
         2 005431   000005 356100                    ANSQ    5,,PR0

     1404    17104    2       XUG.PARSING_FREE_CMDS = %NO#;

  17104  2 005432   200220 471500                    LDP1    XUG$,,AUTO
         2 005433   000033 236000 3                  LDQ     27
         2 005434   100266 356100                    ANSQ    182,,PR1

     1405    17105
     1406    17106    2       CALL X$PARSE (P_PCB)

  17106  2 005435   200224 630500                    EPPR0   P_PCB$,,AUTO
         2 005436   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005437   000000 701000 xent               TSX1    X$PARSE
         2 005440   005442 702000 2                  TSX2    s:17109
         2 005441   005470 710000 2                  TRA     s:17127

     1407    17107    3       WHENALTRETURN DO;

     1408    17108
     1409    17109    3           IF P_PCB.ERROR.CODE = %E$SYNERR

  17109  2 005442   200224 470500                    LDP0    P_PCB$,,AUTO
         2 005443   000006 236100                    LDQ     6,,PR0
         2 005444   377770 376007                    ANQ     131064,DL
         2 005445   000010 116007                    CMPQ    8,DL
         2 005446   005470 601000 2                  TNZ     s:17127

     1410    17110    4           THEN DO;

     1411    17111
     1412    17112    4               GETCMD.ERR_CODE = XUG#FOLLOWED_BY;

  17112  2 005447   000203 236000 0                  LDQ     XUG#FOLLOWED_BY
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:230  
         2 005450   200003 471500                    LDP1    @GETCMD,,AUTO
         2 005451   100010 756100                    STQ     8,,PR1

     1413    17113    4               CALL XUG$ERRMSG_COMMON (GETCMD);

  17113  2 005452   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 005453   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005454   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 005455   000000 011000                    NOP     0

     1414    17114
     1415    17115        /*E*  ERROR:   XUG-E$XUG#FOLLOWED_BY
     1416    17116              MESSAGE:followed by:
     1417    17117        */
     1418    17118
     1419    17119    4               XUG.PARSING_FREE_CMDS = %NO#;

  17119  2 005456   200220 470500                    LDP0    XUG$,,AUTO
         2 005457   000033 236000 3                  LDQ     27
         2 005460   000266 356100                    ANSQ    182,,PR0

     1420    17120    4               P_PCB.NXT = %YES#;

  17120  2 005461   200224 471500                    LDP1    P_PCB$,,AUTO
         2 005462   040000 236007                    LDQ     16384,DL
         2 005463   100005 256100                    ORSQ    5,,PR1

     1421    17121    4               CALL X$PARSE (P_PCB);

  17121  2 005464   200224 630500                    EPPR0   P_PCB$,,AUTO
         2 005465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 005466   000000 701000 xent               TSX1    X$PARSE
         2 005467   000000 011000                    NOP     0

     1422    17122
     1423    17123    4           END;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:231  
     1424    17124
     1425    17125    3       END;

     1426    17126
     1427    17127    2       P_PCB.HI_CHAR = SAVED_HI_CHAR;

  17127  2 005470   200353 235100                    LDA     SAVED_HI_CHAR,,AUTO
         2 005471   200224 470500                    LDP0    P_PCB$,,AUTO
         2 005472   000012 755100                    STA     10,,PR0

     1428    17128    2       P_PCB.HINODE$ = SAVED_HINODE$;

  17128  2 005473   200354 236100                    LDQ     SAVED_HINODE$,,AUTO
         2 005474   000013 756100                    STQ     11,,PR0

     1429    17129    2       P_PCB.NCHARS = P_PCB.NCHARS - 1;

  17129  2 005475   000011 235100                    LDA     9,,PR0
         2 005476   000001 135007                    SBLA    1,DL
         2 005477   000011 755100                    STA     9,,PR0

     1430    17130    2       P_PCB.WK_USED = SAVED_WK_USED;

  17130  2 005500   200355 720100                    LXL0    SAVED_WK_USED,,AUTO
         2 005501   000010 740100                    STX0    8,,PR0

     1431    17131
     1432    17132    2       RETURN;

  17132  2 005502   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 005503   000001 702211                    TSX2  ! 1,X1

     1433    17133
     1434    17134    2   END REPORT_ALTERNATIVES;
     1435    17135
     1436    17136        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:232  
     1437    17137    1   FETCH_HELP_TOPIC: PROC;

  17137  2 005504   200352 741300       FETCH_HELP_* STX1  ! OUTDCB#+1,,AUTO

     1438    17138
     1439    17139    2   DCL LOW_CHAR SBIN WORD;
     1440    17140    2   DCL HIGH_CHAR SBIN WORD;
     1441    17141    2   DCL LENGTH SBIN WORD;
     1442    17142    2   DCL NCHARS SBIN WORD;
     1443    17143    2   DCL STRING$ PTR;
     1444    17144    2   DCL STRING CHAR (NCHARS) BASED (STRING$);
     1445    17145    2   DCL TSTRING CHAR (5);
     1446    17146    2   DCL BANG_OK BIT(1);
     1447    17147    2   DCL DO_OK BIT(1);
     1448    17148    2   DCL DO_CMD BIT(1);
     1449    17149
     1450    17150    2       BANG_OK = %NO#;

  17150  2 005505   200362 450100                    STZ     BANG_OK,,AUTO

     1451    17151    2       DO_CMD = %NO#;

  17151  2 005506   200364 450100                    STZ     DO_CMD,,AUTO

     1452    17152    2       DO_OK = ( XUG.COMMANDS & ~ XUG.INHIBITS.DO# );

  17152  2 005507   200220 470500                    LDP0    XUG$,,AUTO
         2 005510   000071 236100                    LDQ     57,,PR0
         2 005511   000030 736000                    QLS     24
         2 005512   400000 376003                    ANQ     -131072,DU
         2 005513   400000 676003                    ERQ     -131072,DU
         2 005514   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 005515   000071 236100                    LDQ     57,,PR0
         2 005516   000004 736000                    QLS     4
         2 005517   400000 376003                    ANQ     -131072,DU
         2 005520   200432 376100                    ANQ     LEGAL_TEXTC+17,,AUTO
         2 005521   200363 756100                    STQ     DO_OK,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:233  

     1453    17153    2       IF DO_OK

  17153  2 005522   200363 234100                    SZN     DO_OK,,AUTO
         2 005523   005540 605000 2                  TPL     s:17161

     1454    17154    3       THEN DO;

     1455    17155    3           CALL INDEX(LENGTH,'!',SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),XUG.POFF))

  17155  2 005524   000071 236100                    LDQ     57,,PR0
         2 005525   000024 772000                    QRL     20
         2 005526   000001 376007                    ANQ     1,DL
         2 005527   000036 720100                    LXL0    30,,PR0
         2 005530   000000 124546                    SCM     mask='000'O
         2 005531   000037 000010                    ADSC9   31,Q,PR0                 cn=0,n=*X0
         2 005532   000052 000001 3                  ADSC9   42                       cn=0,n=1
         2 005533   200355 000100                    ARG     LENGTH,,AUTO
         2 005534   005536 606400 2                  TTN     s:17157
         2 005535   005540 710000 2                  TRA     s:17161

     1456    17156    4           WHENALTRETURN DO;

     1457    17157    4               BANG_OK = %YES#;

  17157  2 005536   400000 236003                    LDQ     -131072,DU
         2 005537   200362 756100                    STQ     BANG_OK,,AUTO

     1458    17158    4           END;

     1459    17159    3       END;

     1460    17160
     1461    17161    2       NCHARS = P_PCB.NCHARS;

  17161  2 005540   200224 470500                    LDP0    P_PCB$,,AUTO
         2 005541   000011 235100                    LDA     9,,PR0
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:234  
         2 005542   200356 755100                    STA     NCHARS,,AUTO

     1462    17162
     1463    17163    2       STRING$ = P_PCB.TEXT$;

  17163  2 005543   000000 236100                    LDQ     0,,PR0
         2 005544   200357 756100                    STQ     STRING$,,AUTO

     1464    17164    2       LOW_CHAR = -1;

  17164  2 005545   000001 335007                    LCA     1,DL
         2 005546   200353 755100                    STA     LOW_CHAR,,AUTO

  17164  2 005547                       FIND_START_* null
     1465    17165
     1466    17166    2   FIND_START_CHAR: ;
     1467    17167    3       DO UNTIL SYMTTBL.PL6SYM(ASCBIN(SUBSTR(STRING, LOW_CHAR, 1)));

     1468    17168
     1469    17169    3           LOW_CHAR = LOW_CHAR + 1;

  17169  2 005547   200353 054100                    AOS     LOW_CHAR,,AUTO

     1470    17170
     1471    17171    3           IF LOW_CHAR = NCHARS

  17171  2 005550   200353 236100                    LDQ     LOW_CHAR,,AUTO
         2 005551   200356 116100                    CMPQ    NCHARS,,AUTO
         2 005552   005555 601000 2                  TNZ     s:17175

     1472    17172    3           THEN
     1473    17173    3               RETURN;

  17173  2 005553   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 005554   000001 702211                    TSX2  ! 1,X1

     1474    17174
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:235  
     1475    17175    3           IF BANG_OK AND SUBSTR(STRING,LOW_CHAR,1) = '!'

  17175  2 005555   200362 234100                    SZN     BANG_OK,,AUTO
         2 005556   005566 605000 2                  TPL     s:17179
         2 005557   200357 470500                    LDP0    STRING$,,AUTO
         2 005560   040000 106506                    CMPC    fill='040'O
         2 005561   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         2 005562   000052 000001 3                  ADSC9   42                       cn=0,n=1
         2 005563   005566 601000 2                  TNZ     s:17179

     1476    17176    3           THEN
     1477    17177    3               DO_CMD = %YES#;

  17177  2 005564   400000 236003                    LDQ     -131072,DU
         2 005565   200364 756100                    STQ     DO_CMD,,AUTO

     1478    17178
     1479    17179    3       END;

  17179  2 005566   200357 470500                    LDP0    STRING$,,AUTO
         2 005567   200353 235100                    LDA     LOW_CHAR,,AUTO
         2 005570   000100 101505                    MRL     fill='000'O
         2 005571   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 005572   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 005573   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 005574   000000 236006 xsym               LDQ     XUP_SYMTBL,QL
         2 005575   004000 316003                    CANQ    2048,DU
         2 005576   005547 600000 2                  TZE     FIND_START_CHAR

     1480    17180
     1481    17181    2       HIGH_CHAR = LOW_CHAR;

  17181  2 005577   200354 755100                    STA     HIGH_CHAR,,AUTO

     1482    17182
     1483    17183    3       DO WHILE SYMTTBL.PL6SYM(ASCBIN(SUBSTR(STRING, HIGH_CHAR, 1)));

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:236  
  17183  2 005600   000100 101505                    MRL     fill='000'O
         2 005601   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1
         2 005602   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 005603   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 005604   000000 236006 xsym               LDQ     XUP_SYMTBL,QL
         2 005605   004000 316003                    CANQ    2048,DU
         2 005606   005623 600000 2                  TZE     s:17193

     1484    17184
     1485    17185    3           HIGH_CHAR = HIGH_CHAR + 1;

  17185  2 005607   200354 054100                    AOS     HIGH_CHAR,,AUTO

     1486    17186
     1487    17187    3           IF HIGH_CHAR = NCHARS

  17187  2 005610   200354 236100                    LDQ     HIGH_CHAR,,AUTO
         2 005611   200356 116100                    CMPQ    NCHARS,,AUTO
         2 005612   005623 600000 2                  TZE     s:17193

     1488    17188    3           THEN
     1489    17189    3               EXIT;
     1490    17190
     1491    17191    3       END;

  17191  2 005613   200357 470500                    LDP0    STRING$,,AUTO
         2 005614   000100 101506                    MRL     fill='000'O
         2 005615   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1
         2 005616   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 005617   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 005620   000000 236006 xsym               LDQ     XUP_SYMTBL,QL
         2 005621   004000 316003                    CANQ    2048,DU
         2 005622   005607 601000 2                  TNZ     s:17185

     1492    17192
     1493    17193    2       LENGTH = HIGH_CHAR - LOW_CHAR;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:237  
  17193  2 005623   200354 236100                    LDQ     HIGH_CHAR,,AUTO
         2 005624   200353 136100                    SBLQ    LOW_CHAR,,AUTO
         2 005625   200355 756100                    STQ     LENGTH,,AUTO

     1494    17194
     1495    17195    2       IF LENGTH = 0

  17195  2 005626   005631 601000 2                  TNZ     s:17199

     1496    17196    2       THEN
     1497    17197    2           RETURN;

  17197  2 005627   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 005630   000001 702211                    TSX2  ! 1,X1

     1498    17198
     1499    17199    2       CALL XLATE (TSTRING, TRANSTBL, SUBSTR (STRING, LOW_CHAR, LENGTH));

  17199  2 005631   200357 470500                    LDP0    STRING$,,AUTO
         2 005632   000000 620006                    EAX0    0,QL
         2 005633   200353 235100                    LDA     LOW_CHAR,,AUTO
         2 005634   000000 471400 xsym               LDP1    B$XL_UPPER$
         2 005635   040100 160545                    MVT     fill='040'O
         2 005636   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         2 005637   200360 000005                    ADSC9   TSTRING,,AUTO            cn=0,n=5
         2 005640   100000 000100                    ARG     0,,PR1

     1500    17200
     1501    17201    2       IF TSTRING = 'HELP'

  17201  2 005641   040000 106500                    CMPC    fill='040'O
         2 005642   200360 000005                    ADSC9   TSTRING,,AUTO            cn=0,n=5
         2 005643   000350 000004 0                  ADSC9   XUH_PARAM_C+60           cn=0,n=4
         2 005644   005647 601000 2                  TNZ     s:17205

     1502    17202    2       THEN
     1503    17203    2           RETURN;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:238  

  17203  2 005645   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 005646   000001 702211                    TSX2  ! 1,X1

     1504    17204
     1505    17205    2       IF DO_OK AND NOT DO_CMD AND TSTRING = 'DO'

  17205  2 005647   200363 234100                    SZN     DO_OK,,AUTO
         2 005650   005665 605000 2                  TPL     s:17212
         2 005651   200364 234100                    SZN     DO_CMD,,AUTO
         2 005652   005665 604000 2                  TMI     s:17212
         2 005653   040000 106500                    CMPC    fill='040'O
         2 005654   200360 000005                    ADSC9   TSTRING,,AUTO            cn=0,n=5
         2 005655   000351 000002 0                  ADSC9   XUH_PARAM_C+61           cn=0,n=2
         2 005656   005665 601000 2                  TNZ     s:17212

     1506    17206    3       THEN DO;

     1507    17207    3           DO_CMD = %YES# ;

  17207  2 005657   400000 236003                    LDQ     -131072,DU
         2 005660   200364 756100                    STQ     DO_CMD,,AUTO

     1508    17208    3           LOW_CHAR = HIGH_CHAR - 1;

  17208  2 005661   200354 235100                    LDA     HIGH_CHAR,,AUTO
         2 005662   000001 135007                    SBLA    1,DL
         2 005663   200353 755100                    STA     LOW_CHAR,,AUTO

     1509    17209    3           GOTO FIND_START_CHAR;

  17209  2 005664   005547 710000 2                  TRA     FIND_START_CHAR

     1510    17210    3       END;
     1511    17211
     1512    17212    2       IF NOT DO_CMD

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:239  
  17212  2 005665   200364 234100                    SZN     DO_CMD,,AUTO
         2 005666   005700 604000 2                  TMI     s:17218

     1513    17213    3       THEN DO;

     1514    17214    3           XUG.HELP_TOPIC.COUNT = LENGTH;

  17214  2 005667   200220 473500                    LDP3    XUG$,,AUTO
         2 005670   200355 236100                    LDQ     LENGTH,,AUTO
         2 005671   000033 736000                    QLS     27
         2 005672   300246 552140                    STBQ    166,'40'O,PR3

     1515    17215    3           XUG.HELP_TOPIC.TEXT = SUBSTR (STRING, LOW_CHAR, LENGTH);

  17215  2 005673   200355 720100                    LXL0    LENGTH,,AUTO
         2 005674   040100 100545                    MLR     fill='040'O
         2 005675   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         2 005676   300246 200077                    ADSC9   166,,PR3                 cn=1,n=63

     1516    17216    3       END;

  17216  2 005677   005714 710000 2                  TRA     s:17222

     1517    17217    3       ELSE DO;

     1518    17218    3           XUG.HELP_TOPIC.COUNT = LENGTH + 7;

  17218  2 005700   200220 473500                    LDP3    XUG$,,AUTO
         2 005701   200355 236100                    LDQ     LENGTH,,AUTO
         2 005702   000007 036007                    ADLQ    7,DL
         2 005703   000033 736000                    QLS     27
         2 005704   300246 552140                    STBQ    166,'40'O,PR3

     1519    17219    3           CALL CONCAT(XUG.HELP_TOPIC.TEXT, '(IBEX) ',

  17219  2 005705   040100 100400                    MLR     fill='040'O
         2 005706   000352 000007 0                  ADSC9   XUH_PARAM_C+62           cn=0,n=7
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:240  
         2 005707   300246 200007                    ADSC9   166,,PR3                 cn=1,n=7
         2 005710   200355 720100                    LXL0    LENGTH,,AUTO
         2 005711   040100 100545                    MLR     fill='040'O
         2 005712   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         2 005713   300250 000070                    ADSC9   168,,PR3                 cn=0,n=56

     1520    17220    3             SUBSTR (STRING, LOW_CHAR, LENGTH));
     1521    17221    3       END;

     1522    17222    2       XUG.DIVERT_TO_HELP = %YES#;

  17222  2 005714   200220 470500                    LDP0    XUG$,,AUTO
         2 005715   400000 236007                    LDQ     -131072,DL
         2 005716   000071 256100                    ORSQ    57,,PR0

     1523    17223
     1524    17224    2       RETURN;

  17224  2 005717   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 005720   000001 702211                    TSX2  ! 1,X1

     1525    17225
     1526    17226    2   END FETCH_HELP_TOPIC;
     1527    17227        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:241  
     1528    17228    1   SCAN_RECORD: PROC (INCR, LOW, HIGH) ;

  17228  2 005721   200352 741300       SCAN_RECORD  STX1  ! OUTDCB#+1,,AUTO

     1529    17229
     1530    17230    2   DCL INCR SBIN WORD ;
     1531    17231    2   DCL LOW SBIN WORD ;
     1532    17232    2   DCL HIGH SBIN WORD ;
     1533    17233
     1534    17234    2   DCL I SBIN WORD ;
     1535    17235    2   DCL LAST SBIN WORD ;
     1536    17236    2   DCL CHARVAL UBIN WORD ;
     1537    17237    2   DCL CURCHAR$ PTR ;
     1538    17238    2   DCL CUR$CHAR CHAR(1) BASED(CURCHAR$) ;
     1539    17239
     1540    17240    2       CURCHAR$ = VBASE(XUG.BUFVEC) ;

  17240  2 005722   200220 470500                    LDP0    XUG$,,AUTO
         2 005723   000001 236100                    LDQ     1,,PR0
         2 005724   200361 756100                    STQ     CURCHAR$,,AUTO

     1541    17241    2       CURCHAR$ = PINCRC(CURCHAR$, LOW) ;

  17241  2 005725   200354 471500                    LDP1    @LOW,,AUTO
         2 005726   100000 236100                    LDQ     0,,PR1
         2 005727   000020 736000                    QLS     16
         2 005730   200361 036100                    ADLQ    CURCHAR$,,AUTO
         2 005731   200361 756100                    STQ     CURCHAR$,,AUTO

     1542    17242    2       LAST = LOW ;

  17242  2 005732   100000 235100                    LDA     0,,PR1
         2 005733   200357 755100                    STA     LAST,,AUTO

     1543    17243
     1544    17244    3   SCAN: DO I=0 TO 5 ;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:242  
  17244  2 005734   200356 450100       SCAN         STZ     I,,AUTO

     1545    17245    3           CHARVAL = ASCBIN(CUR$CHAR) ;

  17245  2 005735   200361 470500                    LDP0    CURCHAR$,,AUTO
         2 005736   000100 101500                    MRL     fill='000'O
         2 005737   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 005740   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 005741   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 005742   200360 756100                    STQ     CHARVAL,,AUTO

     1546    17246    3           IF CHARVAL <= ASCBIN(' ') OR CHARVAL > 127

  17246  2 005743   000041 116007                    CMPQ    33,DL
         2 005744   005771 602000 2                  TNC     s:17256
         2 005745   000200 116007                    CMPQ    128,DL
         2 005746   005771 603000 2                  TRC     s:17256

     1547    17247    3           THEN
     1548    17248    3               EXIT SCAN ;
     1549    17249    3           IF SYMTTBL.GENERIC_DSTRING(CHARVAL) AND NOT SYMTTBL.FID(CHARVAL)

  17249  2 005747   000000 236006 xsym               LDQ     XUP_SYMTBL,QL
         2 005750   000200 316003                    CANQ    128,DU
         2 005751   005755 600000 2                  TZE     s:17252
         2 005752   200360 720100                    LXL0    CHARVAL,,AUTO
         2 005753   000000 234010 xsym               SZN     XUP_SYMTBL,X0
         2 005754   005771 605000 2                  TPL     s:17256

     1550    17250    3           THEN
     1551    17251    3               EXIT SCAN ;
     1552    17252    3           LAST = LAST + INCR ;

  17252  2 005755   200353 471500                    LDP1    @INCR,,AUTO
         2 005756   200357 236100                    LDQ     LAST,,AUTO
         2 005757   100000 036100                    ADLQ    0,,PR1
         2 005760   200357 756100                    STQ     LAST,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:243  

     1553    17253    3           CURCHAR$ = PINCRC(CURCHAR$, INCR) ;

  17253  2 005761   100000 236100                    LDQ     0,,PR1
         2 005762   000020 736000                    QLS     16
         2 005763   200361 036100                    ADLQ    CURCHAR$,,AUTO
         2 005764   200361 756100                    STQ     CURCHAR$,,AUTO

     1554    17254    3       END SCAN ;

  17254  2 005765   200356 054100                    AOS     I,,AUTO
         2 005766   200356 235100                    LDA     I,,AUTO
         2 005767   000005 115007                    CMPA    5,DL
         2 005770   005735 604400 2                  TMOZ    s:17245

     1555    17255
     1556    17256    2       IF INCR > 0

  17256  2 005771   200353 470500                    LDP0    @INCR,,AUTO
         2 005772   000000 235100                    LDA     0,,PR0
         2 005773   006000 604400 2                  TMOZ    s:17261

     1557    17257    2       THEN                            /* Right motion */
     1558    17258    2           HIGH = LAST ;

  17258  2 005774   200355 471500                    LDP1    @HIGH,,AUTO
         2 005775   200357 236100                    LDQ     LAST,,AUTO
         2 005776   100000 756100                    STQ     0,,PR1
         2 005777   006006 710000 2                  TRA     s:17265

     1559    17259    2       ELSE                            /* Left motion */
     1560    17260    3       DO ;

     1561    17261    3           HIGH = LOW ;

  17261  2 006000   200354 471500                    LDP1    @LOW,,AUTO
         2 006001   200355 473500                    LDP3    @HIGH,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:244  
         2 006002   100000 235100                    LDA     0,,PR1
         2 006003   300000 755100                    STA     0,,PR3

     1562    17262    3           LOW = LAST ;

  17262  2 006004   200357 236100                    LDQ     LAST,,AUTO
         2 006005   100000 756100                    STQ     0,,PR1

     1563    17263    3       END ;                        /* Else Do */

     1564    17264
     1565    17265    2       RETURN ;

  17265  2 006006   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 006007   000001 702211                    TSX2  ! 1,X1

     1566    17266    2   END     SCAN_RECORD ;
     1567    17267        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:245  
     1568    17268    1   SPELLING_CHECKER: PROC (QM_REQUIRED) ALTRET;

  17268  2 006010   200352 741300       SPELLING_CH* STX1  ! OUTDCB#+1,,AUTO

     1569    17269
     1570    17270        /*I*  NAME:    SPELLING_CHECKER
     1571    17271              DESCRIPTION: This routine drives spelling-error detection for keywords
     1572    17272                       in commands.  It is called with a single flag, which (if true)
     1573    17273                       indicates that the first non-alphabetic character at or to the
     1574    17274                       right of the point of error must be a "?" (this is used to
     1575    17275                       request partial-prefix-known displays, such as the IBEX
     1576    17276                       command "!TERMINAL P?" to determine all options which begin
     1577    17277                       with the letter P.  SPELLING_CHECKER contains the special
     1578    17278                       interfaces to X$PARSE and XUS$CORRECT.  Its RETURN/ALTRETURN
     1579    17279                       behavior is inverted from the normal style - it ALTRETURNS if
     1580    17280                       it is able to suggest one or more alternative/completed
     1581    17281                       spellings of a keyword, and RETURNs if it cannot.
     1582    17282        */
     1583    17283
     1584    17284    2   DCL QM_REQUIRED BIT (1) ALIGNED PARAM ;
     1585    17285
     1586    17286    2   DCL BADCHAR SBIN WORD;
     1587    17287    2   DCL FIRSTCHAR SBIN WORD;
     1588    17288    2   DCL FIRST_LEGAL$ PTR;
     1589    17289    2   DCL KEYWORDS$ PTR;
     1590    17290    2   DCL KEYWORDS_FOUND SBIN WORD;
     1591    17291    2   DCL LASTCHAR SBIN WORD;
     1592    17292    2   DCL LEGAL_BITS (0:0) BIT (1) BASED UNAL;
     1593    17293    2   DCL LEN SBIN WORD;
     1594    17294    2   DCL NCHARS SBIN WORD;
     1595    17295    2   DCL QM_HIT BIT (1);
     1596    17296    2   DCL SAVED_HI_CHAR SBIN WORD;
     1597    17297    2   DCL SAVED_HINODE$ PTR;
     1598    17298    2   DCL SAVED_WK_USED SBIN WORD;
     1599    17299    2   DCL STRING$ PTR;
     1600    17300    2   DCL STRING CHAR (NCHARS) BASED (STRING$);
     1601    17301
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:246  
     1602    17302    2   DCL 1 TEXTC,
     1603    17303    2         2 COUNT UBIN BYTE CALIGNED,
     1604    17304    2         2 TEXT CHAR (63);
     1605    17305
     1606    17306    2   DCL 1 LEGAL_TEXTC,
     1607    17307    2         2 COUNT UBIN BYTE CALIGNED,
     1608    17308    2         2 TEXT CHAR (63);
     1609    17309
     1610    17310    2   DCL 1 BASED_TEXTC BASED ALIGNED,
     1611    17311    2         2 COUNT UBIN BYTE CALIGNED,
     1612    17312    2         2 TEXT CHAR (63);
     1613    17313
     1614    17314        %P$KEYWORDS (STCLASS="BASED(KEYWORDS$)");
     1615    17332
     1616    17333    2       XUG.SPELLING_TRIED = %YES#;

  17333  2 006011   200220 470500                    LDP0    XUG$,,AUTO
         2 006012   000001 236003                    LDQ     1,DU
         2 006013   000071 256100                    ORSQ    57,,PR0

     1617    17334    2       BADCHAR = P_PCB.HI_CHAR;

  17334  2 006014   200224 471500                    LDP1    P_PCB$,,AUTO
         2 006015   100012 235100                    LDA     10,,PR1
         2 006016   200354 755100                    STA     BADCHAR,,AUTO

     1618    17335    2       NCHARS = P_PCB.NCHARS;

  17335  2 006017   100011 235100                    LDA     9,,PR1
         2 006020   200363 755100                    STA     NCHARS,,AUTO

     1619    17336    2       STRING$ = VBASE (XUG.BUFVEC);

  17336  2 006021   000001 236100                    LDQ     1,,PR0
         2 006022   200370 756100                    STQ     STRING$,,AUTO

     1620    17337
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:247  
     1621    17338    2       IF BADCHAR >= NCHARS

  17338  2 006023   200354 236100                    LDQ     BADCHAR,,AUTO
         2 006024   200363 116100                    CMPQ    NCHARS,,AUTO
         2 006025   006030 604000 2                  TMI     s:17342

     1622    17339    2       THEN
     1623    17340    2           RETURN;

  17340  2 006026   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 006027   000001 702211                    TSX2  ! 1,X1

     1624    17341
     1625    17342    2       IF SUBSTR (STRING, BADCHAR, 1) ~= '?'

  17342  2 006030   200370 473500                    LDP3    STRING$,,AUTO
         2 006031   040000 106506                    CMPC    fill='040'O
         2 006032   300000 000001                    ADSC9   0,Q,PR3                  cn=0,n=1
         2 006033   000024 000001 3                  ADSC9   20                       cn=0,n=1
         2 006034   006046 600000 2                  TZE     s:17347
         2 006035   000100 101506                    MRL     fill='000'O
         2 006036   300000 000001                    ADSC9   0,Q,PR3                  cn=0,n=1
         2 006037   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 006040   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 006041   000000 236006 xsym               LDQ     XUP_SYMTBL,QL
         2 006042   040000 316003                    CANQ    16384,DU
         2 006043   006046 601000 2                  TNZ     s:17347

     1626    17343    2         AND NOT SYMTTBL.ALPHA (ASCBIN(SUBSTR(STRING, BADCHAR, 1)))
     1627    17344    2       THEN
     1628    17345    2           RETURN;

  17345  2 006044   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 006045   000001 702211                    TSX2  ! 1,X1

     1629    17346
     1630    17347    2       FIRSTCHAR = BADCHAR;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:248  

  17347  2 006046   200354 236100                    LDQ     BADCHAR,,AUTO
         2 006047   200355 756100                    STQ     FIRSTCHAR,,AUTO

     1631    17348
     1632    17349    3       DO WHILE FIRSTCHAR > 0;

  17349  2 006050   006065 604400 2                  TMOZ    s:17359

     1633    17350
     1634    17351    3           IF NOT SYMTTBL.ALPHA (ASCBIN(SUBSTR(STRING, FIRSTCHAR - 1, 1)))

  17351  2 006051   200370 470500                    LDP0    STRING$,,AUTO
         2 006052   200355 235100                    LDA     FIRSTCHAR,,AUTO
         2 006053   000100 101505                    MRL     fill='000'O
         2 006054   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         2 006055   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 006056   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 006057   000000 236006 xsym               LDQ     XUP_SYMTBL,QL
         2 006060   040000 316003                    CANQ    16384,DU
         2 006061   006065 600000 2                  TZE     s:17359

     1635    17352    3           THEN
     1636    17353    3               EXIT;
     1637    17354
     1638    17355    3           FIRSTCHAR = FIRSTCHAR - 1;

  17355  2 006062   000001 336007                    LCQ     1,DL
         2 006063   200355 056100                    ASQ     FIRSTCHAR,,AUTO

     1639    17356
     1640    17357    3       END;

  17357  2 006064   006051 605400 2                  TPNZ    s:17351

     1641    17358
     1642    17359    2       LASTCHAR = FIRSTCHAR;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:249  

  17359  2 006065   200355 235100                    LDA     FIRSTCHAR,,AUTO
         2 006066   200361 755100                    STA     LASTCHAR,,AUTO

     1643    17360
     1644    17361    3       DO WHILE LASTCHAR < NCHARS - 1;

  17361  2 006067   006102 710000 2                  TRA     s:17369

     1645    17362
     1646    17363    3           IF NOT SYMTTBL.ALPHA (ASCBIN(SUBSTR(STRING, LASTCHAR + 1, 1)))

  17363  2 006070   200370 470500                    LDP0    STRING$,,AUTO
         2 006071   200361 235100                    LDA     LASTCHAR,,AUTO
         2 006072   000100 101505                    MRL     fill='000'O
         2 006073   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         2 006074   200432 000004                    ADSC9   LEGAL_TEXTC+17,,AUTO     cn=0,n=4
         2 006075   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 006076   000000 236006 xsym               LDQ     XUP_SYMTBL,QL
         2 006077   040000 316003                    CANQ    16384,DU
         2 006100   006106 600000 2                  TZE     s:17371

     1647    17364    3           THEN
     1648    17365    3               EXIT;
     1649    17366
     1650    17367    3           LASTCHAR = LASTCHAR + 1;

  17367  2 006101   200361 054100                    AOS     LASTCHAR,,AUTO

     1651    17368
     1652    17369    3       END;

  17369  2 006102   200363 236100                    LDQ     NCHARS,,AUTO
         2 006103   000001 136007                    SBLQ    1,DL
         2 006104   200361 116100                    CMPQ    LASTCHAR,,AUTO
         2 006105   006070 605400 2                  TPNZ    s:17363

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:250  
     1653    17370
     1654    17371    2       LEN = LASTCHAR - FIRSTCHAR + 1;

  17371  2 006106   200361 236100                    LDQ     LASTCHAR,,AUTO
         2 006107   200355 136100                    SBLQ    FIRSTCHAR,,AUTO
         2 006110   000001 036007                    ADLQ    1,DL
         2 006111   200362 756100                    STQ     LEN,,AUTO

     1655    17372
     1656    17373    2       IF LEN <= 0

  17373  2 006112   006115 605400 2                  TPNZ    s:17377

     1657    17374    2       THEN
     1658    17375    2           RETURN;

  17375  2 006113   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 006114   000001 702211                    TSX2  ! 1,X1

     1659    17376
     1660    17377    2       QM_HIT = %NO#;

  17377  2 006115   200364 450100                    STZ     QM_HIT,,AUTO

     1661    17378
     1662    17379    2       IF LASTCHAR < NCHARS - 1

  17379  2 006116   200363 236100                    LDQ     NCHARS,,AUTO
         2 006117   000001 136007                    SBLQ    1,DL
         2 006120   200361 116100                    CMPQ    LASTCHAR,,AUTO
         2 006121   006132 604400 2                  TMOZ    s:17385

     1663    17380    2       THEN
     1664    17381    2           IF SUBSTR (STRING, LASTCHAR + 1, 1) = '?'

  17381  2 006122   200370 470500                    LDP0    STRING$,,AUTO
         2 006123   200361 235100                    LDA     LASTCHAR,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:251  
         2 006124   040000 106505                    CMPC    fill='040'O
         2 006125   000000 200001                    ADSC9   0,A,PR0                  cn=1,n=1
         2 006126   000024 000001 3                  ADSC9   20                       cn=0,n=1
         2 006127   006132 601000 2                  TNZ     s:17385

     1665    17382    2           THEN
     1666    17383    2               QM_HIT = %YES#;

  17383  2 006130   400000 236003                    LDQ     -131072,DU
         2 006131   200364 756100                    STQ     QM_HIT,,AUTO

     1667    17384
     1668    17385    2       TEXTC.COUNT = LEN;

  17385  2 006132   200362 236100                    LDQ     LEN,,AUTO
         2 006133   000033 736000                    QLS     27
         2 006134   200371 552140                    STBQ    TEXTC,'40'O,AUTO

     1669    17386    2       CALL XLATE (TEXTC.TEXT, TRANSTBL, SUBSTR (STRING, FIRSTCHAR, LEN));

  17386  2 006135   200370 470500                    LDP0    STRING$,,AUTO
         2 006136   200362 720100                    LXL0    LEN,,AUTO
         2 006137   200355 235100                    LDA     FIRSTCHAR,,AUTO
         2 006140   000000 471400 xsym               LDP1    B$XL_UPPER$
         2 006141   040100 160545                    MVT     fill='040'O
         2 006142   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         2 006143   200371 200077                    ADSC9   TEXTC,,AUTO              cn=1,n=63
         2 006144   100000 000100                    ARG     0,,PR1

     1670    17387
     1671    17388    2       IF QM_REQUIRED AND NOT QM_HIT

  17388  2 006145   200353 473500                    LDP3    @QM_REQUIRED,,AUTO
         2 006146   300000 234100                    SZN     0,,PR3
         2 006147   006157 605000 2                  TPL     s:17394
         2 006150   200364 234100                    SZN     QM_HIT,,AUTO
         2 006151   006157 604000 2                  TMI     s:17394
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:252  

     1672    17389    3       THEN DO;

     1673    17390    3           XUG.SPELLING_TRIED = %NO#;

  17390  2 006152   200220 474500                    LDP4    XUG$,,AUTO
         2 006153   000031 236000 3                  LDQ     25
         2 006154   400071 356100                    ANSQ    57,,PR4

     1674    17391    3           RETURN;

  17391  2 006155   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 006156   000001 702211                    TSX2  ! 1,X1

     1675    17392    3       END;
     1676    17393
     1677    17394    2       SAVED_HI_CHAR = P_PCB.HI_CHAR;

  17394  2 006157   200224 474500                    LDP4    P_PCB$,,AUTO
         2 006160   400012 235100                    LDA     10,,PR4
         2 006161   200365 755100                    STA     SAVED_HI_CHAR,,AUTO

     1678    17395    2       SAVED_WK_USED = P_PCB.WK_USED;

  17395  2 006162   400010 236100                    LDQ     8,,PR4
         2 006163   000022 772000                    QRL     18
         2 006164   200367 756100                    STQ     SAVED_WK_USED,,AUTO

     1679    17396    2       SAVED_HINODE$ = P_PCB.HINODE$;

  17396  2 006165   400013 236100                    LDQ     11,,PR4
         2 006166   200366 756100                    STQ     SAVED_HINODE$,,AUTO

     1680    17397
     1681    17398    2       P_PCB.HI_CHAR = FIRSTCHAR;

  17398  2 006167   200355 235100                    LDA     FIRSTCHAR,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:253  
         2 006170   400012 755100                    STA     10,,PR4

     1682    17399    2       P_PCB.KEYWORDS = %YES#;

  17399  2 006171   010000 236007                    LDQ     4096,DL
         2 006172   400005 256100                    ORSQ    5,,PR4

     1683    17400    2       P_PCB.ERROR = '0'B;

  17400  2 006173   400006 450100                    STZ     6,,PR4

     1684    17401    2       P_PCB.NXT_SZONLY = %YES#;

  17401  2 006174   002000 236007                    LDQ     1024,DL
         2 006175   400005 256100                    ORSQ    5,,PR4

     1685    17402    2       XUG.PARSING_FREE_CMDS = %NO#;

  17402  2 006176   200220 475500                    LDP5    XUG$,,AUTO
         2 006177   000033 236000 3                  LDQ     27
         2 006200   500266 356100                    ANSQ    182,,PR5

     1686    17403
     1687    17404    2       CALL X$PARSE (P_PCB);

  17404  2 006201   200224 630500                    EPPR0   P_PCB$,,AUTO
         2 006202   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006203   000000 701000 xent               TSX1    X$PARSE
         2 006204   000000 011000                    NOP     0

     1688    17405    2       P_PCB.NXT_SZONLY = %NO#;

  17405  2 006205   200224 470500                    LDP0    P_PCB$,,AUTO
         2 006206   000053 236000 3                  LDQ     43
         2 006207   000005 356100                    ANSQ    5,,PR0

     1689    17406    2       CALL X$PARSE (P_PCB);
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:254  

  17406  2 006210   200224 630500                    EPPR0   P_PCB$,,AUTO
         2 006211   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006212   000000 701000 xent               TSX1    X$PARSE
         2 006213   000000 011000                    NOP     0

     1690    17407
     1691    17408    2       P_PCB.KEYWORDS = %NO#;

  17408  2 006214   200224 470500                    LDP0    P_PCB$,,AUTO
         2 006215   000054 236000 3                  LDQ     44
         2 006216   000005 356100                    ANSQ    5,,PR0

     1692    17409
     1693    17410    2       IF P_PCB.ERROR.MON OR P_PCB.ERROR.CODE ~= %E$SYNERR

  17410  2 006217   000006 236100                    LDQ     6,,PR0
         2 006220   400000 316007                    CANQ    -131072,DL
         2 006221   006552 601000 2                  TNZ     CORRECTION_FAILED
         2 006222   000006 236100                    LDQ     6,,PR0
         2 006223   377770 376007                    ANQ     131064,DL
         2 006224   000010 116007                    CMPQ    8,DL
         2 006225   006552 601000 2                  TNZ     CORRECTION_FAILED

     1694    17411    2       THEN
     1695    17412    2           GOTO CORRECTION_FAILED;
     1696    17413
     1697    17414    2       KEYWORDS$ = P_PCB.OUT$;

  17414  2 006226   000003 236100                    LDQ     3,,PR0
         2 006227   200357 756100                    STQ     KEYWORDS$,,AUTO

     1698    17415
     1699    17416    2       KEYWORDS_FOUND = P$KEYWORDS.KEYWORD_COUNT;

  17416  2 006230   200357 471500                    LDP1    KEYWORDS$,,AUTO
         2 006231   100000 235100                    LDA     0,,PR1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:255  
         2 006232   200360 755100                    STA     KEYWORDS_FOUND,,AUTO

     1700    17417
     1701    17418    2       IF KEYWORDS_FOUND = 0

  17418  2 006233   006552 600000 2                  TZE     CORRECTION_FAILED

     1702    17419    2       THEN
     1703    17420    2           GOTO CORRECTION_FAILED;
     1704    17421
     1705    17422    2       CALL XUS$CORRECT_SPELLING (P$KEYWORDS.KEYWORD_COUNT, P$KEYWORDS.KEYWORDS$,

  17422  2 006234   100001 473500                    LDP3    1,,PR1
         2 006235   200436 453500                    STP3    LEGAL_TEXTC+21,,AUTO
         2 006236   000036 236000 3                  LDQ     30
         2 006237   200435 756100                    STQ     LEGAL_TEXTC+20,,AUTO
         2 006240   200371 634500                    EPPR4   TEXTC,,AUTO
         2 006241   200434 454500                    STP4    LEGAL_TEXTC+19,,AUTO
         2 006242   200357 236100                    LDQ     KEYWORDS$,,AUTO
         2 006243   000002 036003                    ADLQ    2,DU
         2 006244   200357 235100                    LDA     KEYWORDS$,,AUTO
         2 006245   200432 757100                    STAQ    LEGAL_TEXTC+17,,AUTO
         2 006246   200432 630500                    EPPR0   LEGAL_TEXTC+17,,AUTO
         2 006247   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 006250   000000 701000 xent               TSX1    XUS$CORRECT_SPELLING
         2 006251   000000 011000                    NOP     0

     1706    17423    2         TEXTC, %YES#, P$KEYWORDS.LEGAL$ -> LEGAL_BITS);
     1707    17424
     1708    17425    2       FIRST_LEGAL$ = ADDR(NIL);

  17425  2 006252   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 006253   200356 756100                    STQ     FIRST_LEGAL$,,AUTO

     1709    17426
     1710    17427    3       DO I = 0 TO KEYWORDS_FOUND - 1;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:256  
  17427  2 006254   200250 450100                    STZ     I,,AUTO
         2 006255   006330 710000 2                  TRA     s:17443+1

     1711    17428
     1712    17429    3           IF LEN <= 2 AND NOT P$KEYWORDS.LEGAL$ -> LEGAL_BITS(I) AND

  17429  2 006256   200362 235100                    LDA     LEN,,AUTO
         2 006257   000002 115007                    CMPA    2,DL
         2 006260   006310 605400 2                  TPNZ    s:17438
         2 006261   200357 470500                    LDP0    KEYWORDS$,,AUTO
         2 006262   000001 471500                    LDP1    1,,PR0
         2 006263   200250 236100                    LDQ     I,,AUTO
         2 006264   006266 605000 2                  TPL     s:17429+8
         2 006265   000044 036003                    ADLQ    36,DU
         2 006266   000000 066506                    CMPB    filb='0'B
         2 006267   100000 000001                    BDSC    0,Q,PR1                  by=0,bit=0,n=1
         2 006270   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 006271   006310 601000 2                  TNZ     s:17438
         2 006272   200250 720100                    LXL0    I,,AUTO
         2 006273   000002 473510                    LDP3    2,X0,PR0
         2 006274   000000 621005                    EAX1    0,AL
         2 006275   040140 106500                    CMPC    fill='040'O
         2 006276   200371 200077                    ADSC9   TEXTC,,AUTO              cn=1,n=63
         2 006277   300000 200011                    ADSC9   0,,PR3                   cn=1,n=*X1
         2 006300   006310 601000 2                  TNZ     s:17438

     1713    17430    3             TEXTC.TEXT = SUBSTR(P$KEYWORDS.KEYWORDS$(I) -> BASED_TEXTC.TEXT, 0, LEN)
     1714    17431    4           THEN DO;

     1715    17432
     1716    17433    4               P$KEYWORDS.LEGAL$ -> LEGAL_BITS(I) = %YES#;

  17433  2 006301   200250 235100                    LDA     I,,AUTO
         2 006302   006304 605000 2                  TPL     s:17433+3
         2 006303   000044 035003                    ADLA    36,DU
         2 006304   003105 060400                    CSL     bolr='003'O
         2 006305   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:257  
         2 006306   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

     1717    17434    4               P$KEYWORDS.KEYWORD_COUNT = P$KEYWORDS.KEYWORD_COUNT + 1;

  17434  2 006307   000000 054100                    AOS     0,,PR0

     1718    17435
     1719    17436    4           END;

     1720    17437
     1721    17438    3           IF P$KEYWORDS.LEGAL$ -> LEGAL_BITS(I)

  17438  2 006310   200357 470500                    LDP0    KEYWORDS$,,AUTO
         2 006311   000001 471500                    LDP1    1,,PR0
         2 006312   200250 235100                    LDA     I,,AUTO
         2 006313   006315 605000 2                  TPL     s:17438+5
         2 006314   000044 035003                    ADLA    36,DU
         2 006315   000000 066505                    CMPB    filb='0'B
         2 006316   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1
         2 006317   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 006320   006327 600000 2                  TZE     s:17443
         2 006321   200356 236100                    LDQ     FIRST_LEGAL$,,AUTO
         2 006322   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006323   006327 601000 2                  TNZ     s:17443

     1722    17439    3             AND FIRST_LEGAL$ = ADDR(NIL)
     1723    17440    3           THEN
     1724    17441    3               FIRST_LEGAL$ = P$KEYWORDS.KEYWORDS$(I);

  17441  2 006324   200250 720100                    LXL0    I,,AUTO
         2 006325   000002 236110                    LDQ     2,X0,PR0
         2 006326   200356 756100                    STQ     FIRST_LEGAL$,,AUTO

     1725    17442
     1726    17443    3       END;

  17443  2 006327   200250 054100                    AOS     I,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:258  
         2 006330   200250 236100                    LDQ     I,,AUTO
         2 006331   200360 116100                    CMPQ    KEYWORDS_FOUND,,AUTO
         2 006332   006256 604000 2                  TMI     s:17429

     1727    17444
     1728    17445    2       GETCMD.F1_ = VECTOR (TEXTC);

  17445  2 006333   000055 235000 3                  LDA     45
         2 006334   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 006335   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 006336   000371 036003                    ADLQ    249,DU
         2 006337   200003 470500                    LDP0    @GETCMD,,AUTO
         2 006340   000017 755100                    STA     15,,PR0
         2 006341   000020 756100                    STQ     16,,PR0

     1729    17446
     1730    17447    2       IF FIRST_LEGAL$ = ADDR(NIL)

  17447  2 006342   200356 236100                    LDQ     FIRST_LEGAL$,,AUTO
         2 006343   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 006344   006351 601000 2                  TNZ     s:17457

     1731    17448    2       THEN
     1732    17449    2           GETCMD.F2_ = VECTOR(NIL);

  17449  2 006345   000004 237000 3                  LDAQ    4
         2 006346   000021 755100                    STA     17,,PR0
         2 006347   000022 756100                    STQ     18,,PR0
         2 006350   006452 710000 2                  TRA     s:17482

     1733    17450
     1734    17451    3       ELSE DO;

     1735    17452
     1736    17453        /*N* KLUGE - similar to the one in XUP$DMPNXT.  Beware - if the format of
     1737    17454             P$LIT ever changes, this may explode messily.
     1738    17455        */
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:259  
     1739    17456
     1740    17457    3           FIRST_LEGAL$ = PINCRW(FIRST_LEGAL$, -1);

  17457  2 006351   777777 036003                    ADLQ    -1,DU
         2 006352   200356 756100                    STQ     FIRST_LEGAL$,,AUTO

     1741    17458
     1742    17459    3           IF FIRST_LEGAL$ -> P$LIT.ABREV = 0

  17459  2 006353   200356 471500                    LDP1    FIRST_LEGAL$,,AUTO
         2 006354   100000 236100                    LDQ     0,,PR1
         2 006355   000056 316000 3                  CANQ    46
         2 006356   006370 601000 2                  TNZ     s:17469

     1743    17460    4           THEN DO;

     1744    17461
     1745    17462    4               LEGAL_TEXTC.COUNT = FIRST_LEGAL$ -> P$LIT.COUNT;

  17462  2 006357   100001 236100                    LDQ     1,,PR1
         2 006360   200411 552140                    STBQ    LEGAL_TEXTC,'40'O,AUTO

     1746    17463    4               LEGAL_TEXTC.TEXT = FIRST_LEGAL$ -> P$LIT.TEXT;

  17463  2 006361   100001 236100                    LDQ     1,,PR1
         2 006362   000033 772000                    QRL     27
         2 006363   000000 620006                    EAX0    0,QL
         2 006364   040100 100540                    MLR     fill='040'O
         2 006365   100001 200010                    ADSC9   1,,PR1                   cn=1,n=*X0
         2 006366   200411 200077                    ADSC9   LEGAL_TEXTC,,AUTO        cn=1,n=63

     1747    17464
     1748    17465    4           END;

  17465  2 006367   006444 710000 2                  TRA     s:17478

     1749    17466
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:260  
     1750    17467    4           ELSE DO;

     1751    17468
     1752    17469    4               LEGAL_TEXTC.COUNT = FIRST_LEGAL$ -> P$LIT.COUNT + 1;

  17469  2 006370   100001 236100                    LDQ     1,,PR1
         2 006371   000033 772000                    QRL     27
         2 006372   000001 036007                    ADLQ    1,DL
         2 006373   000033 736000                    QLS     27
         2 006374   200411 552140                    STBQ    LEGAL_TEXTC,'40'O,AUTO

     1753    17470    4               LEGAL_TEXTC.TEXT = FIRST_LEGAL$ -> P$LIT.TEXT;

  17470  2 006375   100001 236100                    LDQ     1,,PR1
         2 006376   000033 772000                    QRL     27
         2 006377   000000 620006                    EAX0    0,QL
         2 006400   040100 100540                    MLR     fill='040'O
         2 006401   100001 200010                    ADSC9   1,,PR1                   cn=1,n=*X0
         2 006402   200411 200077                    ADSC9   LEGAL_TEXTC,,AUTO        cn=1,n=63

     1754    17471
     1755    17472    4               SUBSTR (LEGAL_TEXTC.TEXT, FIRST_LEGAL$ -> P$LIT.ABREV) = '/';

  17472  2 006403   100000 236100                    LDQ     0,,PR1
         2 006404   000020 772000                    QRL     16
         2 006405   000377 376007                    ANQ     255,DL
         2 006406   777700 620006                    EAX0    -64,QL
         2 006407   777777 660003                    ERX0    -1,DU
         2 006410   040146 100400                    MLR     fill='040'O
         2 006411   000057 000001 3                  ADSC9   47                       cn=0,n=1
         2 006412   200411 200010                    ADSC9   LEGAL_TEXTC,Q,AUTO       cn=1,n=*X0

     1756    17473    4               SUBSTR (LEGAL_TEXTC.TEXT, FIRST_LEGAL$ -> P$LIT.ABREV + 1) =

  17473  2 006413   100000 236100                    LDQ     0,,PR1
         2 006414   000020 772000                    QRL     16
         2 006415   000377 376007                    ANQ     255,DL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:261  
         2 006416   777701 620006                    EAX0    -63,QL
         2 006417   777777 660003                    ERX0    -1,DU
         2 006420   200432 756100                    STQ     LEGAL_TEXTC+17,,AUTO
         2 006421   100001 236100                    LDQ     1,,PR1
         2 006422   000033 772000                    QRL     27
         2 006423   000000 621006                    EAX1    0,QL
         2 006424   100000 236100                    LDQ     0,,PR1
         2 006425   000020 772000                    QRL     16
         2 006426   000377 376007                    ANQ     255,DL
         2 006427   200433 756100                    STQ     LEGAL_TEXTC+18,,AUTO
         2 006430   000000 636011                    EAQ     0,X1
         2 006431   000022 772000                    QRL     18
         2 006432   200433 136100                    SBLQ    LEGAL_TEXTC+18,,AUTO
         2 006433   200434 756100                    STQ     LEGAL_TEXTC+19,,AUTO
         2 006434   100000 236100                    LDQ     0,,PR1
         2 006435   000020 772000                    QRL     16
         2 006436   000377 376007                    ANQ     255,DL
         2 006437   200434 721100                    LXL1    LEGAL_TEXTC+19,,AUTO
         2 006440   200432 235100                    LDA     LEGAL_TEXTC+17,,AUTO
         2 006441   040145 100546                    MLR     fill='040'O
         2 006442   100001 200011                    ADSC9   1,Q,PR1                  cn=1,n=*X1
         2 006443   200411 400010                    ADSC9   LEGAL_TEXTC,A,AUTO       cn=2,n=*X0

     1757    17474    4                 SUBSTR (FIRST_LEGAL$ -> P$LIT.TEXT, FIRST_LEGAL$ -> P$LIT.ABREV);
     1758    17475
     1759    17476    4           END;

     1760    17477
     1761    17478    3           GETCMD.F2_ = VECTOR (LEGAL_TEXTC);

  17478  2 006444   000055 235000 3                  LDA     45
         2 006445   200432 452500                    STP2    LEGAL_TEXTC+17,,AUTO
         2 006446   200432 236100                    LDQ     LEGAL_TEXTC+17,,AUTO
         2 006447   000411 036003                    ADLQ    265,DU
         2 006450   000021 755100                    STA     17,,PR0
         2 006451   000022 756100                    STQ     18,,PR0

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:262  
     1762    17479
     1763    17480    3       END;

     1764    17481
     1765    17482    2       IF P$KEYWORDS.KEYWORD_COUNT = 0

  17482  2 006452   200357 471500                    LDP1    KEYWORDS$,,AUTO
         2 006453   100000 235100                    LDA     0,,PR1
         2 006454   006460 601000 2                  TNZ     s:17486

     1766    17483    2       THEN
     1767    17484    2           GETCMD.ERR_CODE = XUG#NO_MATCH;

  17484  2 006455   000202 236000 0                  LDQ     XUG#NO_MATCH
         2 006456   000010 756100                    STQ     8,,PR0
         2 006457   006514 710000 2                  TRA     s:17523

     1768    17485    2       ELSE
     1769    17486    2           IF QM_HIT

  17486  2 006460   200364 234100                    SZN     QM_HIT,,AUTO
         2 006461   006505 605000 2                  TPL     s:17498

     1770    17487    2           THEN
     1771    17488    2               IF P$KEYWORDS.KEYWORD_COUNT = 1

  17488  2 006462   000001 115007                    CMPA    1,DL
         2 006463   006502 601000 2                  TNZ     s:17496

     1772    17489    2               THEN
     1773    17490    2                   IF TEXTC.TEXT = FIRST_LEGAL$ -> P$LIT.TEXT

  17490  2 006464   200356 473500                    LDP3    FIRST_LEGAL$,,AUTO
         2 006465   300001 236100                    LDQ     1,,PR3
         2 006466   000033 772000                    QRL     27
         2 006467   000000 620006                    EAX0    0,QL
         2 006470   040140 106500                    CMPC    fill='040'O
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:263  
         2 006471   200371 200077                    ADSC9   TEXTC,,AUTO              cn=1,n=63
         2 006472   300001 200010                    ADSC9   1,,PR3                   cn=1,n=*X0
         2 006473   006477 601000 2                  TNZ     s:17494

     1774    17491    2                   THEN
     1775    17492    2                       GETCMD.ERR_CODE = XUG#NO_OTHER_CHOICE;

  17492  2 006474   000201 236000 0                  LDQ     XUG#NO_OTHER_CHOICE
         2 006475   000010 756100                    STQ     8,,PR0
         2 006476   006514 710000 2                  TRA     s:17523

     1776    17493    2                   ELSE
     1777    17494    2                       GETCMD.ERR_CODE = XUG#SINGLE_CHOICE;

  17494  2 006477   000177 236000 0                  LDQ     XUG#SINGLE_CHOICE
         2 006500   000010 756100                    STQ     8,,PR0
         2 006501   006514 710000 2                  TRA     s:17523

     1778    17495    2               ELSE
     1779    17496    2                   GETCMD.ERR_CODE = XUG#MULTI_CHOICE;

  17496  2 006502   000200 236000 0                  LDQ     XUG#MULTI_CHOICE
         2 006503   000010 756100                    STQ     8,,PR0
         2 006504   006514 710000 2                  TRA     s:17523

     1780    17497    2           ELSE
     1781    17498    2               IF P$KEYWORDS.KEYWORD_COUNT = 1

  17498  2 006505   000001 115007                    CMPA    1,DL
         2 006506   006512 601000 2                  TNZ     s:17502

     1782    17499    2               THEN
     1783    17500    2                   GETCMD.ERR_CODE = XUG#SINGLE_LEGAL;

  17500  2 006507   000175 236000 0                  LDQ     XUG#SINGLE_LEGAL
         2 006510   000010 756100                    STQ     8,,PR0
         2 006511   006514 710000 2                  TRA     s:17523
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:264  

     1784    17501    2               ELSE
     1785    17502    2                   GETCMD.ERR_CODE = XUG#MULTI_LEGAL;

  17502  2 006512   000176 236000 0                  LDQ     XUG#MULTI_LEGAL
         2 006513   000010 756100                    STQ     8,,PR0

     1786    17503
     1787    17504        /*E*  ERROR:   XUG-E$XUG#MULTI_LEGAL
     1788    17505              MESSAGE:"%U1" is not legal here.  You might have meant one of:
     1789    17506        */
     1790    17507        /*E*  ERROR:   XUG-E$XUG#SINGLE_LEGAL
     1791    17508              MESSAGE:"%U1" is not legal here.  You might have meant "%U2", instead.
     1792    17509        */
     1793    17510        /*E*  ERROR:   XUG-E$XUG#MULTI_CHOICE
     1794    17511              MESSAGE:Legal words which resemble "%U1" include:
     1795    17512        */
     1796    17513        /*E*  ERROR:   XUG-E$XUG#SINGLE_CHOICE
     1797    17514              MESSAGE:The only legal word which resembles "%U1" is "%U2".
     1798    17515        */
     1799    17516        /*E*  ERROR:   XUG-E$XUG#NO_OTHER_CHOICE
     1800    17517              MESSAGE:"%U1" is legal here;  no other legal word resembles it.
     1801    17518        */
     1802    17519        /*E*  ERROR:   XUG-E$XUG#NO_MATCH
     1803    17520              MESSAGE:"%U1" does not resemble any word which is legal here.
     1804    17521        */
     1805    17522
     1806    17523    2       CALL XUG$ERRMSG_COMMON (GETCMD);

  17523  2 006514   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 006515   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006516   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 006517   000000 011000                    NOP     0

     1807    17524
     1808    17525    2       IF P$KEYWORDS.KEYWORD_COUNT > 1

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:265  
  17525  2 006520   200357 470500                    LDP0    KEYWORDS$,,AUTO
         2 006521   000000 235100                    LDA     0,,PR0
         2 006522   000001 115007                    CMPA    1,DL
         2 006523   006532 604400 2                  TMOZ    s:17534

     1809    17526    3       THEN DO;

     1810    17527
     1811    17528    3           P$KEYWORDS.KEYWORD_COUNT = KEYWORDS_FOUND;

  17528  2 006524   200360 236100                    LDQ     KEYWORDS_FOUND,,AUTO
         2 006525   000000 756100                    STQ     0,,PR0

     1812    17529
     1813    17530    3           CALL XUP$DMPCORRECTED (P_PCB);

  17530  2 006526   200224 630500                    EPPR0   P_PCB$,,AUTO
         2 006527   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 006530   000000 701000 xent               TSX1    XUP$DMPCORRECTED
         2 006531   000000 011000                    NOP     0

     1814    17531
     1815    17532    3       END;

     1816    17533
     1817    17534    2       P_PCB.HI_CHAR = SAVED_HI_CHAR;

  17534  2 006532   200365 235100                    LDA     SAVED_HI_CHAR,,AUTO
         2 006533   200224 470500                    LDP0    P_PCB$,,AUTO
         2 006534   000012 755100                    STA     10,,PR0

     1818    17535    2       P_PCB.WK_USED = SAVED_WK_USED;

  17535  2 006535   200367 720100                    LXL0    SAVED_WK_USED,,AUTO
         2 006536   000010 740100                    STX0    8,,PR0

     1819    17536    2       P_PCB.HINODE$ = SAVED_HINODE$;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:266  

  17536  2 006537   200366 236100                    LDQ     SAVED_HINODE$,,AUTO
         2 006540   000013 756100                    STQ     11,,PR0

     1820    17537
     1821    17538    2       IF P$KEYWORDS.KEYWORD_COUNT = 0

  17538  2 006541   200357 471500                    LDP1    KEYWORDS$,,AUTO
         2 006542   100000 235100                    LDA     0,,PR1
         2 006543   006550 601000 2                  TNZ     s:17543
         2 006544   200364 234100                    SZN     QM_HIT,,AUTO
         2 006545   006550 604000 2                  TMI     s:17543

     1822    17539    2         AND NOT QM_HIT
     1823    17540    2       THEN
     1824    17541    2           RETURN;

  17541  2 006546   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 006547   000001 702211                    TSX2  ! 1,X1

     1825    17542    2       ELSE
     1826    17543    2           ALTRETURN;

  17543  2 006550   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 006551   000000 702211                    TSX2  ! 0,X1

     1827    17544
     1828    17545    2   CORRECTION_FAILED:
     1829    17546
     1830    17547    2       P_PCB.HI_CHAR = SAVED_HI_CHAR;

  17547  2 006552   200365 235100       CORRECTION_* LDA     SAVED_HI_CHAR,,AUTO
         2 006553   000012 755100                    STA     10,,PR0

     1831    17548    2       P_PCB.WK_USED = SAVED_WK_USED;

  17548  2 006554   200367 720100                    LXL0    SAVED_WK_USED,,AUTO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:267  
         2 006555   000010 740100                    STX0    8,,PR0

     1832    17549    2       P_PCB.HINODE$ = SAVED_HINODE$;

  17549  2 006556   200366 236100                    LDQ     SAVED_HINODE$,,AUTO
         2 006557   000013 756100                    STQ     11,,PR0

     1833    17550
     1834    17551    2       RETURN;

  17551  2 006560   200352 221300                    LDX1  ! OUTDCB#+1,,AUTO
         2 006561   000001 702211                    TSX2  ! 1,X1
     1835    17552
     1836    17553    2   END SPELLING_CHECKER;
     1837    17554        %EJECT;
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:268  
     1838    17555    1   END XUG$COMMON;
     1839    17556        %EOD;

PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:269  
--  Include file information  --

   B_SEGIDS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XT_MACRO_M.:TOOLE04  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$COMMON.
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:270  

 **** Variables and constants ****

  ****  Section 000 RoData XUG$COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/d STRC(216)   r     1 FPT_GDS_C                160-0-0/d STRC(72)    r     1 FPT_MERC_C
    56-0-0/d STRC(2088)  r     1 FPT_OPEN_C                44-0-0/d STRC(360)   r     1 FPT_PROMPT_C
   150-0-0/d STRC(288)   r     1 FPT_SINPUT_C              30-0-0/d STRC(432)   r     1 FPT_WRITE_C
    20-0-0/c STRC(45)    r     1 M$LO                      16-0-0/c STRC(45)    r     1 M$SI
     0-0-0/w STRC(504)   r     1 P_PCB_C                  164-0-0/w STRC        r     1 XUG#AREANOTRTSZ
   165-0-0/w STRC        r     1 XUG#CANTEXPAND           203-0-0/w STRC        r     1 XUG#FOLLOWED_BY
   171-0-0/w STRC        r     1 XUG#INCOR_HERE           170-0-0/w STRC        r     1 XUG#INCOR_HERE_XPND
   167-0-0/w STRC        r     1 XUG#INCOR_PTD_XPND       173-0-0/w STRC        r     1 XUG#LEGAL_INPUT_HERE
   174-0-0/w STRC        r     1 XUG#LEGAL_INPUT_QM       206-0-0/w STRC        r     1 XUG#LINETOOLONG
   200-0-0/w STRC        r     1 XUG#MULTI_CHOICE         176-0-0/w STRC        r     1 XUG#MULTI_LEGAL
   163-0-0/w STRC        r     1 XUG#NOTCONTIGAREA        202-0-0/w STRC        r     1 XUG#NO_MATCH
   201-0-0/w STRC        r     1 XUG#NO_OTHER_CHOICE      204-0-0/w STRC        r     1 XUG#NULLROOT
   172-0-0/w STRC        r     1 XUG#NWALIGNED            166-0-0/w STRC        r     1 XUG#PLERRMSG
   205-0-0/w STRC        r     1 XUG#PRE_C00              177-0-0/w STRC        r     1 XUG#SINGLE_CHOICE
   175-0-0/w STRC        r     1 XUG#SINGLE_LEGAL         162-0-0/w STRC        r     1 XUG#SMALLWORK
   210-0-0/d STRC(1296)  r     1 XUG_INIT_C               254-0-0/d STRC(2052)  r     1 XUH_PARAM_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GETCMD                  355-0-0/w PTR         r     1 @HIGH
   353-0-0/w PTR         r     1 @INCR                    354-0-0/w PTR         r     1 @LOW
   354-0-0/w PTR         r     1 @OFFSET                  353-0-0/w PTR         r     1 @QM_REQUIRED
   355-0-0/w PTR         r     1 @SIZ                     353-0-0/w PTR         r     1 @VEC
     4-0-0/w PTR         r     1 @XUG_INIT                244-0-0/w SBIN        r     1 ARS
   354-0-0/w SBIN        r     1 BADCHAR                  362-0-0/b BIT         r     1 BANG_OK
   360-0-0/w UBIN        r     1 CHARVAL                  257-0-0/w SBIN        r     1 CHUNK_SIZE
   350-0-0/w SBIN        r     1 CNT                      254-0-0/w SBIN        r     1 CSIZE
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:271  
   361-0-0/w PTR         r     1 CURCHAR$                 347-0-0/w SBIN        r     1 DIFF
   364-0-0/b BIT         r     1 DO_CMD                   363-0-0/b BIT         r     1 DO_OK
   227-0-0/w PTR         r     1 DUMMY$                   252-0-0/w SBIN        r     1 EPOS
   332-0-0/w STRC(189)   r     1 FIELD1                   340-0-0/w STRC(189)   r     1 FIELD2
   313-0-0/w SBIN        r     1 FIRST                    355-0-0/w SBIN        r     1 FIRSTCHAR
   356-0-0/w PTR         r     1 FIRST_LEGAL$              10-0-0/d STRC(216)   r     1 FPT_GDS
   150-0-0/d STRC(72)    r     1 FPT_MERC                  46-0-0/d STRC(2088)  r     1 FPT_OPEN
    34-0-0/d STRC(360)   r     1 FPT_PROMPT               140-0-0/d STRC(288)   r     1 FPT_SINPUT
    20-0-0/d STRC(432)   r     1 FPT_WRITE                360-0-0/w PTR         r     1 FROM$
   234-0-0/d VECT        r     1 GDSVEC                    *0-0-0/d STRC(1512)  r     1 GETCMD
    *0-0-0/w SBIN        r     1 HIGH                     354-0-0/w SBIN        r     1 HIGH_CHAR
   250-0-0/w SBIN        r     1 I                        356-0-0/w SBIN        r     1 I
    *0-0-0/w SBIN        r     1 INCR                     251-0-0/w SBIN        r     1 J
   356-0-0/w SBIN        r     1 J                        357-0-0/w PTR         r     1 KEYWORDS$
   360-0-0/w SBIN        r     1 KEYWORDS_FOUND           314-0-0/w SBIN        r     1 LAST
   357-0-0/w SBIN        r     1 LAST                     361-0-0/w SBIN        r     1 LASTCHAR
   411-0-0/c STRC(576)   r     1 LEGAL_TEXTC              362-0-0/w SBIN        r     1 LEN
   355-0-0/w SBIN        r     1 LENGTH                    *0-0-0/w SBIN        r     1 LOW
   353-0-0/w SBIN        r     1 LOW_CHAR                 356-0-0/w SBIN        r     1 NCHARS
   363-0-0/w SBIN        r     1 NCHARS                   226-0-0/w PTR         r     1 NODES$
   346-0-0/w PTR         r     1 OFF$                     260-0-0/w SBIN        r     1 OFFSET
    *0-0-0/w UBIN        r     1 OFFSET                   351-0-0/w UBIN        r     1 OUTDCB#
   261-0-0/w SBIN        r     1 OUTPUT_COUNT             262-0-0/w SBIN        r     1 OUTPUT_WIDTH
   256-0-0/w SBIN        r     1 POFF                       5-0-0/w PTR         r     1 PR$
   263-0-0/c CHAR(94)    r     1 PROMPT_BUF               245-0-0/w BIT         r     1 PROMPT_FLG
     6-0-0/w SBIN        r     1 PSIZ                     224-0-0/w PTR         r     1 P_PCB$
   364-0-0/b BIT         r     1 QM_HIT                    *0-0-0/w BIT         r     1 QM_REQUIRED
   241-0-0/w SBIN        r     1 RLT_SZ                   225-0-0/w PTR         r     1 ROOT$
   232-0-0/w STRC        r     1 RSEG                     354-0-0/w PTR         r     1 SAVED_HINODE$
   366-0-0/w PTR         r     1 SAVED_HINODE$            353-0-0/w SBIN        r     1 SAVED_HI_CHAR
   365-0-0/w SBIN        r     1 SAVED_HI_CHAR            355-0-0/w SBIN        r     1 SAVED_WK_USED
   367-0-0/w SBIN        r     1 SAVED_WK_USED            324-0-0/w UBIN        r     1 SAVE_DCB
   323-0-0/b BIT         r     1 SAVE_ERR                 326-0-0/d VECT        r     1 SAVE_F1
   330-0-0/d VECT        r     1 SAVE_F2                  316-0-0/d VECT        r     1 SAVE_PROMPT_
   322-0-0/b BIT         r     1 SAVE_PROMPT_VFC          320-0-0/d VECT        r     1 SAVE_RPROMPT_
   232-0-0/w PTR         r     1 SEG$                      *0-0-0/w UBIN        r     1 SIZ
   237-0-0/w SBIN        r     1 STATIC_SZ                357-0-0/w PTR         r     1 STRING$
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:272  
   370-0-0/w PTR         r     1 STRING$                  255-0-0/w SBIN        r     1 TCSIZE
   152-0-0/w STRC        r     1 TEMP_ERR                 230-0-0/w PTR         r     1 TEXT$
   371-0-0/c STRC(576)   r     1 TEXTC                    231-0-0/w PTR         r     1 TO$
   357-0-0/w PTR         r     1 TO$                      253-0-0/w SBIN        r     1 TPOS
   360-0-0/c CHAR(5)     r     1 TSTRING                  247-0-0/c CHAR(2)     r     1 TWOCHARS
    16-0-0/d VECT        r     1 USER_GDSVEC               *0-0-0/d VECT        r     1 VEC
   243-0-0/w SBIN        r     1 WBUFSZ                   242-0-0/w SBIN        r     1 WOFF
   240-0-0/w SBIN        r     1 WORK_SZ                  221-0-0/w PTR         r     1 XT$
   222-0-0/d VECT        r     1 XT_                      220-0-0/w PTR         r     1 XUG$
    *0-0-0/d STRC(1296)  r     1 XUG_INIT                 154-0-0/d STRC(1296)  r     1 XUG_INIT_A
   236-0-0/b BIT         r     1 XUG_OWNS_MEMORY

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w PTR         r     1 B$XL_UPPER$                0-0-0/b STRC        r     1 SYMTTBL(0:127)
     0-0-0/w UBIN        r     1 XUG_NODES
     0-0-0/b BIT         r     1 XUP_SYMTBL(0:127)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(576)   r     1 BASED_TEXTC
     0-0-0/c ACHR        r     1 CHARBASE                   0-0-0/c CHAR        r     1 CUR$CHAR
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/c CHAR(1024)  r     1 INBUF
     0-0-0/b BIT         r     1 LEGAL_BITS(0:0)
     0-0-0N  NULL        r     1 M$UC                       0-0-0/c CHAR        r     1 ONECHAR
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w STRC(108)   r     1 P$KEYWORDS
     0-0-0/w ASTR(45)    r     1 P$LIT                      0-0-0/w STRC(72)    r     1 P$NODE
     0-0-0/c ASTR(0)     r     1 PROMPT$C                   0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/c UBIN(9)     r     1 RLT(0:0)                   0-0-0/c ACHR        r     1 STRING
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:273  
     0-0-0/c ACHR        r     1 STRING                     0-0-0/d STRC(4608)  r     1 TRANSTBL
     0-0-0/b UBIN(9)     r     1 UBIN$BUF9                  0-0-0/c ACHR        r     1 VEC$BUF
     0-0-0/d BIT (72)    r     1 WDS(0:0)                   0-0-0/w STRC(1152)  r     1 XT_PARAM
     0-0-0/d STRC(9612)  r     1 XUG


   Procedure XUG$COMMON requires 3442 words for executable code.
   Procedure XUG$COMMON requires 288 words of local(AUTO) storage.
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:274  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:275  
          MINI XREF LISTING

ALT_OUT
     16326**LABEL   16630--GOTO
ARS
     15844**DCL     16281<<ASSIGN  16288<>CALL    16292<>CALL    16296>>ASSIGN  16307<>CALL    16309>>IF
     16350<>CALL    16422<<ASSIGN  16426>>ASSIGN  16429>>IF      16437>>ASSIGN  16441>>ASSIGN  16476>>ASSIGN
     16546<<ASSIGN  16551>>IF      16560>>IF      16560>>IF      16639>>ASSIGN  16658<>CALL    16665>>ASSIGN
     16666>>ASSIGN  16672>>ASSIGN
B$ALT.CODE
     15894**DCL     15894--REDEF   15895--REDEF   15895--REDEF
B$ALT.DCB#
     15895**DCL     16532>>ASSIGN
B$ALT.ERR
     15895**DCL     15976>>ASSIGN  16531>>ASSIGN
B$ALT.ERR.ERR#
     15896**DCL     15896--REDEF
B$ALT.EVID
     15895**DCL     15895--REDEF   15895--REDEF
B$JIT.CCARS
       450**DCL     16390>>ASSIGN  16883>>ASSIGN
B$JIT.CCBUF
       450**DCL     16385--IF      16385--IF      16385--IF      16389--ASSIGN  16876>>ASSIGN  16883>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       456**DCL       456--REDEF
B$JIT.ERR.MID
       363**DCL       363--REDEF
B$JIT.JRESPEAK
       524**DCL       525--REDEF
B$JIT.MODE
       357**DCL     16623>>IF
B$JIT.NEXTCC
       504**DCL     16623>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:276  
       633**DCL       633--REDEF     634--REDEF
B$JIT.PNR
       537**DCL       537--REDEF
B$JIT.PRFLAGS.EXPOUND
       447**DCL     16579>>IF      16628>>IF      16765>>IF      16809>>IF
B$JIT.PRFLAGS.POINT
       447**DCL     16616>>IF      16713>>IF      16765>>IF      16805>>IF
B$JIT.PRFLAGS.POSITION
       447**DCL     16841>>IF      16854>>IF
B$JIT.SINPUTSZ
       511**DCL     16841>>IF
B$JIT.TSLINE
       631**DCL       632--REDEF
B$JIT$
     15887**DCL       357--IMP-PTR 16385>>IF      16385>>IF      16389>>ASSIGN  16390>>ASSIGN  16579>>IF
     16616>>IF      16623>>IF      16623>>IF      16628>>IF      16713>>IF      16765>>IF      16765>>IF
     16805>>IF      16809>>IF      16841>>IF      16841>>IF      16854>>IF      16876>>ASSIGN  16883>>ASSIGN
     16883>>ASSIGN
B$TCB.ALT$
     15890**DCL     15976>>ASSIGN  16531>>ASSIGN  16532>>ASSIGN
B$TCB$
     15888**DCL     15890--IMP-PTR 15976>>ASSIGN  16531>>ASSIGN  16532>>ASSIGN
B$XL_UPPER$
      4631**DCL      4632--IMP-PTR 17199>>CALLBLT 17386>>CALLBLT
BADCHAR IN PROCEDURE SPELLING_CHECKER
     17286**DCL     17334<<ASSIGN  17338>>IF      17342>>IF      17342>>IF      17347>>ASSIGN
BANG_OK IN PROCEDURE FETCH_HELP_TOPIC
     17146**DCL     17150<<ASSIGN  17157<<ASSIGN  17175>>IF
BASED_TEXTC.TEXT IN PROCEDURE SPELLING_CHECKER
     17312**DCL     17429>>IF
CANT_EXPAND_SEGMENT
     16196**LABEL   16107--CALLALT 16119--GOTO    16125--GOTO    16133--GOTO    16144--GOTO
CHARBASE
     15877**DCL     16395>>ASSIGN  16411>>IF      16420<<ASSIGN  16420>>ASSIGN  16730<<ASSIGN  16730>>ASSIGN
     16734<<ASSIGN  16744>>CALLBLT 16750<<ASSIGN  16785>>ASSIGN  16798>>ASSIGN  16869<<ASSIGN  16876<<ASSIGN
     16880<<ASSIGN  16880>>ASSIGN  16883<<ASSIGN  16944>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:277  
CHARVAL IN PROCEDURE SCAN_RECORD
     17236**DCL     17245<<ASSIGN  17246>>IF      17246>>IF      17249>>IF      17249>>IF
CHUNK_SIZE
     15855**DCL     16973<<ASSIGN  16976<<ASSIGN  16976>>ASSIGN  16980>>ASSIGN  16983>>ASSIGN
CNT
     15885**DCL     15882--IMP-SIZ 16018<<ASSIGN  16019>>ASSIGN  16020>>ASSIGN  16025<<ASSIGN  16025>>ASSIGN
     16026>>ASSIGN  16029<<ASSIGN  16033<<ASSIGN  16033>>ASSIGN  16034<<ASSIGN  16034>>ASSIGN  16034>>ASSIGN
     16035>>ASSIGN  16775<<ASSIGN  16780<<ASSIGN  16785>>ASSIGN  16787>>ASSIGN  16930<<ASSIGN  16932<<ASSIGN
     16932>>ASSIGN  16934>>ASSIGN  16951<<ASSIGN  16958>>CALLBLT 16985<<ASSIGN  16985>>ASSIGN  16989<<ASSIGN
     16991<<ASSIGN  16991>>ASSIGN  16993>>ASSIGN
CORRECTION_FAILED IN PROCEDURE SPELLING_CHECKER
     17547**LABEL   17412--GOTO    17420--GOTO
CSIZE
     15852**DCL     15877--IMP-SIZ 16371<<ASSIGN  16375<<ASSIGN  16376>>IF      16395>>ASSIGN  16398<>CALL
     16402<>CALL    16411>>IF      16411>>IF      16419>>ASSIGN  16420>>ASSIGN  16420>>ASSIGN  16422>>ASSIGN
     16729<<ASSIGN  16730>>ASSIGN  16730>>ASSIGN  16733<<ASSIGN  16734>>ASSIGN  16743<<ASSIGN  16744>>CALLBLT
     16749<<ASSIGN  16750>>ASSIGN  16784<<ASSIGN  16785>>ASSIGN  16798>>ASSIGN  16840<<ASSIGN  16841>>IF
     16841>>IF      16867>>ASSIGN  16868<<ASSIGN  16869>>ASSIGN  16871<<ASSIGN  16876>>ASSIGN  16880>>ASSIGN
     16880>>ASSIGN  16883>>ASSIGN  16883>>ASSIGN  16888>>ASSIGN  16943<<ASSIGN  16944>>ASSIGN
CUR$CHAR IN PROCEDURE SCAN_RECORD
     17238**DCL     17245>>ASSIGN
CURCHAR$ IN PROCEDURE SCAN_RECORD
     17237**DCL     17238--IMP-PTR 17240<<ASSIGN  17241<<ASSIGN  17241>>ASSIGN  17245>>ASSIGN  17253<<ASSIGN
     17253>>ASSIGN
DIFF
     15884**DCL     15930<<ASSIGN  15931>>IF      16022<<ASSIGN  16025>>ASSIGN  16032<<ASSIGN  16033>>ASSIGN
DO_CMD IN PROCEDURE FETCH_HELP_TOPIC
     17148**DCL     17151<<ASSIGN  17177<<ASSIGN  17205>>IF      17207<<ASSIGN  17212>>IF
DO_OK IN PROCEDURE FETCH_HELP_TOPIC
     17147**DCL     17152<<ASSIGN  17153>>IF      17205>>IF
DO_SINPUT
     16837**LABEL   16712--GOTO
DUMMY$
     15830**DCL     16127<<ASSIGN  16128>>IF      16463<<ASSIGN  16465>>ASSIGN  16467>>ASSIGN
EAT_IT
     16818**LABEL   16816--CALLALT
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:278  
EPOS
     15850**DCL     16696<<ASSIGN  16698<<ASSIGN  16699<<ASSIGN  16699>>ASSIGN  16703>>IF      16706>>ASSIGN
     16716>>IF      16716>>IF      16721>>ASSIGN  16727>>IF      16730>>ASSIGN  16732>>IF      16738>>ASSIGN
     16742>>ASSIGN  16745>>IF      16750>>ASSIGN  16751>>ASSIGN  16773>>IF      16777>>ASSIGN  16781>>ASSIGN
     16789>>IF      16791>>ASSIGN  16795>>ASSIGN  16860>>ASSIGN
ERRHAND
     16612**LABEL   16444--GOTO    16523--CALLALT
F$DCB.ACTPOS
     11895**DCL     11895--REDEF
F$DCB.ARS#
     11869**DCL     11869--REDEF
F$DCB.ATTR
     11888**DCL     11889--REDEF
F$DCB.BORROW
     11903**DCL     11903--REDEF   11903--REDEF   11903--REDEF
F$DCB.DCBNAME.L
     11917**DCL     11917--IMP-SIZ
F$DCB.DDEV.UCOUT#
     11876**DCL     16299>>IF      16487>>IF
F$DCB.DDEV.XEQ#
     11876**DCL     16904>>IF
F$DCB.DVBYTE.TRANS#
     11872**DCL     16299>>IF      16923>>IF
F$DCB.EOMCHAR#
     11873**DCL     11873--REDEF
F$DCB.FCD#
     11882**DCL     17043>>IF
F$DCB.FLDID
     11898**DCL     11898--REDEF
F$DCB.FORM$
     11892**DCL     11892--REDEF
F$DCB.FSECT
     11908**DCL     11908--REDEF
F$DCB.FSN#
     11885**DCL     11885--REDEF   11885--REDEF   11886--REDEF
F$DCB.HEADER$
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:279  
     11891**DCL     11891--REDEF
F$DCB.IXTNSIZE#
     11889**DCL     11889--REDEF
F$DCB.LASTSTA$
     11878**DCL     11878--REDEF
F$DCB.LVL
     11904**DCL     11904--REDEF
F$DCB.NAME#.C
     11879**DCL     11879--REDEF
F$DCB.NOEOF
     11901**DCL     11901--REDEF
F$DCB.NRECS#
     11890**DCL     11890--REDEF
F$DCB.NRECX
     11909**DCL     11909--REDEF
F$DCB.OHDR
     11901**DCL     11901--REDEF
F$DCB.ORG#
     11884**DCL     11884--REDEF
F$DCB.PRECNO
     11907**DCL     11907--REDEF
F$DCB.RCSZ
     11913**DCL     11913--REDEF
F$DCB.RES#
     11880**DCL     11880--REDEF
F$DCB.SETX
     11892**DCL     11892--REDEF
F$DCB.TAB$
     11892**DCL     11892--REDEF
F$DCB.TDA
     11906**DCL     11907--REDEF
F$DCB.WIDTH#
     11876**DCL     16952>>ASSIGN
F$DCB.WSN#
     11880**DCL     11880--REDEF
FETCH_HELP_TOPIC
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:280  
     17137**PROC    16483--CALL
FIELD1
     15869**DCL     16788--ASSIGN
FIELD1.CNT
     15870**DCL     16787<<ASSIGN
FIELD1.TXT
     15871**DCL     16785<<ASSIGN
FIELD2
     15872**DCL     16801--ASSIGN
FIELD2.CNT
     15873**DCL     16800<<ASSIGN
FIELD2.TXT
     15874**DCL     16798<<ASSIGN
FIND_START_CHAR IN PROCEDURE FETCH_HELP_TOPIC
     17164**LABEL   17209--GOTO
FIRST
     15860**DCL     16776<<ASSIGN  16781<<ASSIGN  16782<>CALL    16785>>ASSIGN  16785>>ASSIGN  16787>>ASSIGN
     16791<<ASSIGN  16795<<ASSIGN  16796>>CALL    16798>>ASSIGN  16798>>ASSIGN  16800>>ASSIGN
FIRSTCHAR IN PROCEDURE SPELLING_CHECKER
     17287**DCL     17347<<ASSIGN  17349>>DOWHILE 17351>>IF      17355<<ASSIGN  17355>>ASSIGN  17359>>ASSIGN
     17371>>ASSIGN  17386>>CALLBLT 17398>>ASSIGN
FIRST_LEGAL$ IN PROCEDURE SPELLING_CHECKER
     17288**DCL     17425<<ASSIGN  17438>>IF      17441<<ASSIGN  17447>>IF      17457<<ASSIGN  17457>>ASSIGN
     17459>>IF      17462>>ASSIGN  17463>>ASSIGN  17463>>ASSIGN  17469>>ASSIGN  17470>>ASSIGN  17470>>ASSIGN
     17472>>ASSIGN  17473>>ASSIGN  17473>>ASSIGN  17473>>ASSIGN  17473>>ASSIGN  17490>>IF      17490>>IF
FPT_GDS
     11962**DCL     15941<<ASSIGN  15974<>CALL    16002<>CALL    16104<<ASSIGN  16107<>CALL
FPT_GDS.RESULTS_
     11962**DCL     15943<<ASSIGN  16106<<ASSIGN
FPT_GDS.V
     11962**DCL     15942--ASSIGN  16105--ASSIGN
FPT_GDS.V_
     11962**DCL     15942<<ASSIGN  16105<<ASSIGN
FPT_GDS_C
     11946**DCL     15941>>ASSIGN  16104>>ASSIGN
FPT_GDS_C.V
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:281  
     11946**DCL     11946--DCLINIT
FPT_MERC
     12389**DCL     15978<<ASSIGN  15980<>CALL
FPT_MERC.JERR_
     12389**DCL     15979<<ASSIGN
FPT_MERC_C
     12402**DCL     15978>>ASSIGN
FPT_OPEN
     12260**DCL     17045<<ASSIGN  17048<>CALL
FPT_OPEN.ACSVEH_
     12262**DCL     12263--REDEF
FPT_OPEN.ALTKEYS_
     12268**DCL     12269--REDEF   12269--REDEF
FPT_OPEN.HDR_
     12267**DCL     12268--REDEF
FPT_OPEN.TAB_
     12266**DCL     12267--REDEF
FPT_OPEN.UHL_
     12260**DCL     12261--REDEF   12261--REDEF
FPT_OPEN.V
     12269**DCL     17046--ASSIGN
FPT_OPEN.V.DCB#
     12269**DCL     17047<<ASSIGN
FPT_OPEN.V.FSN#
     12300**DCL     12300--REDEF   12300--REDEF
FPT_OPEN.V_
     12260**DCL     17046<<ASSIGN
FPT_OPEN.WSN_
     12266**DCL     12266--REDEF
FPT_OPEN_C
     12151**DCL     17045>>ASSIGN
FPT_OPEN_C.ACSVEH_
     12153**DCL     12154--REDEF
FPT_OPEN_C.ALTKEYS_
     12159**DCL     12160--REDEF   12160--REDEF
FPT_OPEN_C.HDR_
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:282  
     12158**DCL     12159--REDEF
FPT_OPEN_C.TAB_
     12157**DCL     12158--REDEF
FPT_OPEN_C.UHL_
     12151**DCL     12152--REDEF   12152--REDEF
FPT_OPEN_C.V
     12160**DCL     12151--DCLINIT
FPT_OPEN_C.V.FSN#
     12191**DCL     12191--REDEF   12191--REDEF
FPT_OPEN_C.WSN_
     12157**DCL     12157--REDEF
FPT_PROMPT
     12074**DCL     17000<<ASSIGN  17050<>CALL
FPT_PROMPT.PROMPT_
     12080**DCL     17016<<ASSIGN  17027<<ASSIGN
FPT_PROMPT.V
     12082**DCL     17001--ASSIGN
FPT_PROMPT.V.DCB#
     12082**DCL     17005<<ASSIGN
FPT_PROMPT.V.DVBYTE#.VFC#
     12083**DCL     17026<<ASSIGN
FPT_PROMPT.V_
     12076**DCL     17001<<ASSIGN
FPT_PROMPT_C
     12046**DCL     17000>>ASSIGN
FPT_PROMPT_C.V
     12054**DCL     12048--DCLINIT
FPT_SINPUT
     12357**DCL     16845<<ASSIGN  16889<>CALL
FPT_SINPUT.BUF_
     12364**DCL     16887<<ASSIGN
FPT_SINPUT.BUF_.BOUND
     12364**DCL     16888<<ASSIGN
FPT_SINPUT.V
     12369**DCL     16846--ASSIGN
FPT_SINPUT.V.DCB#
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:283  
     12369**DCL     16847<<ASSIGN
FPT_SINPUT.V_
     12359**DCL     16846<<ASSIGN
FPT_SINPUT_C
     12320**DCL     16845>>ASSIGN
FPT_SINPUT_C.V
     12332**DCL     12322--DCLINIT
FPT_WRITE
     12016**DCL     16689<<ASSIGN  16755<>CALL    16762<>CALL    16935<<ASSIGN  16981<>CALL
FPT_WRITE.BUF_
     12016**DCL     16691<<ASSIGN  16980<<ASSIGN
FPT_WRITE.BUF_.BOUND
     12016**DCL     16754<<ASSIGN  16761<<ASSIGN
FPT_WRITE.STATION_
     12018**DCL     12018--REDEF
FPT_WRITE.V
     12019**DCL     16690--ASSIGN  16936--ASSIGN
FPT_WRITE.V.DCB#
     12019**DCL     16692<<ASSIGN  16937<<ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
     12025**DCL     12025--REDEF   16693<<ASSIGN  16945<<ASSIGN
FPT_WRITE.V_
     12016**DCL     16690<<ASSIGN  16936<<ASSIGN
FPT_WRITE_C
     11985**DCL     16689>>ASSIGN  16935>>ASSIGN
FPT_WRITE_C.STATION_
     11987**DCL     11987--REDEF
FPT_WRITE_C.V
     11988**DCL     11985--DCLINIT
FPT_WRITE_C.V.DVBYTE.VFC#
     11994**DCL     11994--REDEF
FROM$ IN PROCEDURE MOVER
     17067**DCL     17069<<ASSIGN  17071>>ASSIGN  17074>>ASSIGN
GDSVEC
     15837**DCL     15937<<ASSIGN  15943--ASSIGN  15944<<ASSIGN  15973<<ASSIGN  15985>>ASSIGN  15988>>ASSIGN
     15997>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:284  
GETCMD
     16246**LABEL       8--PROC    15917--ENTRY   16100--ENTRY   16199--ENTRY   16203<>CALL    16239--ASSIGN
     16263<>CALL    16288<>CALL    16292<>CALL    16297<>CALL    16302<>CALL    16306<>CALL    16307<>CALL
     16313<>CALL    16323<>CALL    16330--ASSIGN  16336<>CALL    16343<>CALL    16350<>CALL    16365<>CALL
     16398<>CALL    16402<>CALL    16421<>CALL    16484--ASSIGN  16491<>CALL    16495<>CALL    16523<>CALL
     16529--GOTO    16539<>CALL    16564--ASSIGN  16582<>CALL    16594--GOTO    16618<>CALL    16619<>CALL
     16620<>CALL    16625--GOTO    16642<>CALL    16645--ENTRY   16658<>CALL    16660<>CALL    16675--ENTRY
     16688<>CALL    16816<>CALL    16838--ENTRY   16894--ENTRY   16911--ENTRY   16938<>CALL    16997--ENTRY
     17113<>CALL    17523<>CALL
GETCMD.ALWAYS_SET_PROMPT#
     13966**DCL     16087<<ASSIGN  17009>>ASSIGN  17038>>IF
GETCMD.BUF$
     14155**DCL     16498<<ASSIGN  16542<<ASSIGN
GETCMD.CONTINUED#
     13938**DCL     16272<<ASSIGN  16348<<ASSIGN  16648<<ASSIGN  16841>>IF
GETCMD.DCB_PARAM#
     14058**DCL     16256<<ASSIGN  16679>>IF      16681<<ASSIGN  16682>>IF      16684>>ASSIGN  16687<<ASSIGN
     16769>>ASSIGN  16802<<ASSIGN  16819<<ASSIGN  16896>>IF      16898<<ASSIGN  16899>>IF      16901>>ASSIGN
     16913>>IF      16915<<ASSIGN  16916>>IF      16918>>ASSIGN  16922<<ASSIGN
GETCMD.ECHO
     13998**DCL     16085<<ASSIGN
GETCMD.EOMCHAR#
     14018**DCL     16271<<ASSIGN  16282<<ASSIGN
GETCMD.EPOS#
     13988**DCL     16696>>ASSIGN
GETCMD.ERR#
     13889**DCL     15926<<ASSIGN  15934<<ASSIGN  16006<<ASSIGN  16112<<ASSIGN  16124<<ASSIGN  16131<<ASSIGN
     16143<<ASSIGN  16214<<ASSIGN  16274<<ASSIGN  16354>>IF      16378<<ASSIGN  16440<<ASSIGN  16453<<ASSIGN
     16531<<ASSIGN  16607<<ASSIGN  16612>>ASSIGN  16639<<ASSIGN  16661>>ASSIGN
GETCMD.ERRDCB#
     14037**DCL     16532<<ASSIGN
GETCMD.ERR_CODE
     14026**DCL     16335<<ASSIGN  16581<<ASSIGN  16612<<ASSIGN  16768>>ASSIGN  16807<<ASSIGN  16811<<ASSIGN
     16813<<ASSIGN  16815<<ASSIGN  16818<<ASSIGN  17112<<ASSIGN  17484<<ASSIGN  17492<<ASSIGN  17494<<ASSIGN
     17496<<ASSIGN  17500<<ASSIGN  17502<<ASSIGN
GETCMD.F1_
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:285  
     14075**DCL     16613<<ASSIGN  16770>>ASSIGN  16788<<ASSIGN  16820<<ASSIGN  17445<<ASSIGN
GETCMD.F2_
     14079**DCL     16614<<ASSIGN  16771>>ASSIGN  16801<<ASSIGN  16821<<ASSIGN  17449<<ASSIGN  17478<<ASSIGN
GETCMD.F3_
     14083**DCL     16615<<ASSIGN
GETCMD.INDCB#
     14049**DCL     16250>>IF      16251<>CALL    16259>>ASSIGN  16847>>ASSIGN  16923--IF      17002>>IF
     17004>>ASSIGN
GETCMD.NLINES
     14194**DCL     16500<<ASSIGN  16544<<ASSIGN
GETCMD.NODES$
     13879**DCL     16210>>IF      16212>>IF      16423>>IF      16450>>IF      16468>>ASSIGN  16471>>ASSIGN
GETCMD.OUT$
     13883**DCL     13889--REDEF   16356<<ASSIGN  16425<<ASSIGN  16452<<ASSIGN  16512<<ASSIGN  16518<<ASSIGN
     16526<<ASSIGN
GETCMD.OUTDCB#
     14054**DCL     16253>>IF      16254<>CALL    16256>>ASSIGN  16257>>ASSIGN  16260>>ASSIGN  16299--IF
     16487--IF      16681>>ASSIGN  16898>>ASSIGN  16915>>ASSIGN
GETCMD.PASS
     14008**DCL     16086<<ASSIGN  16487>>IF      16487>>IF
GETCMD.PCB$
     13903**DCL     16084<<ASSIGN  16132>>ASSIGN
GETCMD.PP_ROOT$
     14183**DCL     16088<<ASSIGN
GETCMD.PROMPT_
     14087**DCL     16240>>ASSIGN  16246<<ASSIGN  17011>>IF      17016>>ASSIGN  17018>>IF      17024>>ASSIGN
     17027>>ASSIGN  17029>>IF      17033>>ASSIGN
GETCMD.PROMPT_VFC#
     13953**DCL     16242>>ASSIGN  16248<<ASSIGN  16716>>IF      17025>>ASSIGN  17026>>ASSIGN  17029>>IF
     17034>>ASSIGN
GETCMD.RCVD_PROMPT#
     13948**DCL     16273<<ASSIGN  16349<<ASSIGN  16417<<ASSIGN  16722>>IF      16850>>IF      16865>>IF
GETCMD.RLT$
     14160**DCL     16499<<ASSIGN  16543<<ASSIGN
GETCMD.RPROMPT_
     14091**DCL     16241>>ASSIGN  16247<<ASSIGN  16939>>IF      16939>>IF      16942>>ASSIGN  16944>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:286  
GETCMD.SFROUTINE$
     14128**DCL     16264>>IF      16265>>ASSIGN
GETCMD.SKIP_PREPROCESS#
     13959**DCL     16284>>IF      16295<<ASSIGN  16393>>IF      16407<<ASSIGN
GETCMD.SYNERR_NODES$
     14167**DCL     16327>>IF      16329>>ASSIGN  16559<<ASSIGN
GETCMD.TEXT_
     14141**DCL     16278>>IF      16318>>IF      16346>>IF      16369>>IF      16375>>ASSIGN  16384>>ASSIGN
     16390>>ASSIGN  16395>>ASSIGN  16408>>ASSIGN  16524>>IF      16592>>IF      16621>>IF      17038>>IF
GETCMD.TREAD#
     13927**DCL     16298<<ASSIGN  16487>>IF      16628>>IF      16722>>IF      16765>>IF      16809>>IF
     16841>>IF
GETCMD.USE_EPOS#
     13921**DCL     16694>>IF
GETCMD.WORK$
     13911**DCL     15919>>IF      15986<<ASSIGN  16037>>ASSIGN  16101>>ASSIGN  16200>>IF      16208>>ASSIGN
     16647>>ASSIGN  16677>>ASSIGN  16839>>ASSIGN  16895>>ASSIGN  16912>>ASSIGN  16999>>ASSIGN
GETCMD.XT_PARAM$
     14147**DCL     16080>>ASSIGN  16083<<ASSIGN  16157>>ASSIGN
GETCMD_ALT
     16634**LABEL   16379--GOTO    16446--GOTO    16457--GOTO
GETCMD_ALT1
     16636**LABEL   16359--GOTO    16619--CALLALT 16632--GOTO
GETCMD_RET
     16520**LABEL   16357--GOTO    16427--GOTO    16515--GOTO    16527--GOTO
GIVE_ALTERNATIVES
     16563**LABEL   16576--EXIT
HIGH IN PROCEDURE SCAN_RECORD
     17232**DCL     17228--PROC    17258<<ASSIGN  17261<<ASSIGN
HIGH_CHAR IN PROCEDURE FETCH_HELP_TOPIC
     17140**DCL     17181<<ASSIGN  17183>>DOWHILE 17185<<ASSIGN  17185>>ASSIGN  17187>>IF      17193>>ASSIGN
     17208>>ASSIGN
I
     15848**DCL     16549<<ASSIGN  16550>>ASSIGN  16551>>IF      16551>>IF      16551>>IF      16554<<ASSIGN
     16554>>ASSIGN  16555>>ASSIGN  16560>>IF      16560>>IF      16573>>IF      16700<<DOINDEX 16701>>CALL
     16703>>IF      16706>>ASSIGN  16735<<ASSIGN  16738<<ASSIGN  16746<<ASSIGN  16751<<ASSIGN  16754>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:287  
     16904<<ASSIGN  16905<<ASSIGN  16906<<DOINDEX 16906>>DOINDEX 16907>>CALL    16956<<DOINDEX 16957>>ASSIGN
     16966>>IF      16985>>ASSIGN  17025<<ASSIGN  17028>>ASSIGN  17427<<DOINDEX 17429>>IF      17429>>IF
     17433>>ASSIGN  17438>>IF      17441>>ASSIGN
I IN PROCEDURE SCAN_RECORD
     17234**DCL     17244<<DOINDEX
INBUF
     15881**DCL     16277>>ASSIGN  16309>>IF      16314<<CALLBLT 16322<<ASSIGN  16324<<ASSIGN  16429>>IF
     16551>>IF      16560>>IF      16573>>IF      16958>>CALLBLT
INCR IN PROCEDURE SCAN_RECORD
     17230**DCL     17228--PROC    17252>>ASSIGN  17253>>ASSIGN  17256>>IF
J
     15849**DCL     16368<<ASSIGN  16416<<ASSIGN  16419>>ASSIGN  16420>>ASSIGN  16422>>ASSIGN  16503<<ASSIGN
     16513>>IF      16550<<ASSIGN  16570>>ASSIGN  16575>>ASSIGN  16588>>ASSIGN  16931<<DOINDEX 16932>>ASSIGN
     16990<<DOINDEX 16991>>ASSIGN  17004<<ASSIGN  17005>>ASSIGN  17008<<ASSIGN  17043--IF      17047>>ASSIGN
J IN PROCEDURE MOVER
     17061**DCL     17070<<ASSIGN  17072>>DOWHILE 17073<<ASSIGN  17073>>ASSIGN  17074>>ASSIGN  17074>>ASSIGN
KEYWORDS$ IN PROCEDURE SPELLING_CHECKER
     17289**DCL     17315--IMP-PTR 17414<<ASSIGN  17416>>ASSIGN  17422>>CALL    17422>>CALL    17422>>CALL
     17429>>IF      17429>>IF      17433>>ASSIGN  17434>>ASSIGN  17434>>ASSIGN  17438>>IF      17441>>ASSIGN
     17482>>IF      17488>>IF      17498>>IF      17525>>IF      17528>>ASSIGN  17538>>IF
KEYWORDS_FOUND IN PROCEDURE SPELLING_CHECKER
     17290**DCL     17416<<ASSIGN  17418>>IF      17427>>DOINDEX 17528>>ASSIGN
LAST
     15861**DCL     16777<<ASSIGN  16782<>CALL    16785>>ASSIGN  16787>>ASSIGN  16792<<ASSIGN  16796<>CALL
     16798>>ASSIGN  16800>>ASSIGN
LAST IN PROCEDURE SCAN_RECORD
     17235**DCL     17242<<ASSIGN  17252<<ASSIGN  17252>>ASSIGN  17258>>ASSIGN  17262>>ASSIGN
LASTCHAR IN PROCEDURE SPELLING_CHECKER
     17291**DCL     17359<<ASSIGN  17361>>DOWHILE 17363>>IF      17367<<ASSIGN  17367>>ASSIGN  17371>>ASSIGN
     17379>>IF      17381>>IF
LEGAL_BITS IN PROCEDURE SPELLING_CHECKER
     17292**DCL     17422<>CALL    17429>>IF      17433<<ASSIGN  17438>>IF
LEGAL_TEXTC IN PROCEDURE SPELLING_CHECKER
     17306**DCL     17478--ASSIGN
LEGAL_TEXTC.COUNT IN PROCEDURE SPELLING_CHECKER
     17307**DCL     17462<<ASSIGN  17469<<ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:288  
LEGAL_TEXTC.TEXT IN PROCEDURE SPELLING_CHECKER
     17308**DCL     17463<<ASSIGN  17470<<ASSIGN  17472<<ASSIGN  17473<<ASSIGN
LEN IN PROCEDURE SPELLING_CHECKER
     17293**DCL     17371<<ASSIGN  17373>>IF      17385>>ASSIGN  17386>>CALLBLT 17429>>IF      17429>>IF
LENGTH IN PROCEDURE FETCH_HELP_TOPIC
     17141**DCL     17155<<CALLBLT 17193<<ASSIGN  17195>>IF      17199>>CALLBLT 17214>>ASSIGN  17215>>ASSIGN
     17218>>ASSIGN  17219>>CALLBLT
LOW IN PROCEDURE SCAN_RECORD
     17231**DCL     17228--PROC    17241>>ASSIGN  17242>>ASSIGN  17261>>ASSIGN  17262<<ASSIGN
LOW_CHAR IN PROCEDURE FETCH_HELP_TOPIC
     17139**DCL     17164<<ASSIGN  17167>>DOUNTIL 17169<<ASSIGN  17169>>ASSIGN  17171>>IF      17175>>IF
     17181>>ASSIGN  17193>>ASSIGN  17199>>CALLBLT 17208<<ASSIGN  17215>>ASSIGN  17219>>CALLBLT
M$ERR
     10723**DCL-ENT 15981--CALL
M$GDS
     10746**DCL-ENT 15974--CALL    16002--CALL    16107--CALL
M$LO
     11930**DCL     16254<>CALL    16686<>CALL    16903<>CALL    16920<>CALL
M$MERC
     10767**DCL-ENT 15980--CALL
M$OPEN
     10711**DCL-ENT 17048--CALL
M$PROMPT
     10735**DCL-ENT 17050--CALL
M$SI
     11925**DCL     16251<>CALL
M$SINPUT
     10738**DCL-ENT 16889--CALL
M$UC
     10735**DCL     16299--IF      16303>>ASSIGN  17008>>ASSIGN
M$WRITE
     10712**DCL-ENT 16755--CALL    16762--CALL    16981--CALL
MALT
     16531**LABEL   16002--CALLALT 16251--CALLALT 16254--CALLALT 16263--CALLALT 16491--CALLALT 16495--CALLALT
     16686--CALLALT 16903--CALLALT 16920--CALLALT
MAYBE_ECHO
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:289  
     16916**LABEL   16910--GOTO
MERC_PROBLEM
     15981**LABEL   15980--CALLALT
MOVER
     17059**PROC    16164--CALL    16178--CALL    16188--CALL
NCHARS IN PROCEDURE FETCH_HELP_TOPIC
     17142**DCL     17144--IMP-SIZ 17161<<ASSIGN  17167>>DOUNTIL 17171>>IF      17175>>IF      17183>>DOWHILE
     17187>>IF      17199>>CALLBLT 17215>>ASSIGN  17219>>CALLBLT
NCHARS IN PROCEDURE SPELLING_CHECKER
     17294**DCL     17300--IMP-SIZ 17335<<ASSIGN  17338>>IF      17342>>IF      17342>>IF      17351>>IF
     17361>>DOWHILE 17363>>IF      17379>>IF      17381>>IF      17386>>CALLBLT
NODES$
     15829**DCL     16461<<ASSIGN  16464>>ASSIGN  16466>>ASSIGN  16467>>ASSIGN
NORMAL_PARSE
     16483**LABEL   16317--GOTO
NO_ECHO
     16989**LABEL   16907--CALLALT 16925--GOTO
OFF$
     15883**DCL     15929<<ASSIGN  15930>>ASSIGN  16021<<ASSIGN  16022>>ASSIGN  16023>>ASSIGN  16031<<ASSIGN
     16032>>ASSIGN
OFFSET
     15856**DCL     16971<<ASSIGN  16972>>DOWHILE 16973>>ASSIGN  16974>>IF      16977<<ASSIGN  16977>>ASSIGN
     16978>>ASSIGN  16980>>ASSIGN  16983<<ASSIGN  16983>>ASSIGN
OFFSET IN PROCEDURE MOVER
     17063**DCL     17059--PROC    17071>>ASSIGN
ONECHAR IN PROCEDURE REPORT_ALTERNATIVES
     17084**DCL     17101<<ASSIGN
OUTDCB#
     15886**DCL     16684<<ASSIGN  16686<>CALL    16687>>ASSIGN  16688<>CALL    16692>>ASSIGN  16701<>CALL
     16802>>ASSIGN  16901<<ASSIGN  16903<>CALL    16907<>CALL    16918<<ASSIGN  16920<>CALL    16922>>ASSIGN
     16928>>ASSIGN  16937>>ASSIGN  16938<>CALL    16952--ASSIGN
OUTPUT_COUNT
     15857**DCL     16957<<ASSIGN  16958>>CALLBLT 16960>>DOWHILE 16961>>IF      16964<<ASSIGN  16964>>ASSIGN
     16968>>ASSIGN  16969<<ASSIGN  16969>>ASSIGN  16972>>DOWHILE 16973>>ASSIGN
OUTPUT_WIDTH
     15858**DCL     16952<<ASSIGN  16953>>IF      16955<<ASSIGN  16973>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:290  
P$B
      5185**DCL     16491<>CALL
P$B.CODE
      5193**DCL     16503>>ASSIGN  16506<<ASSIGN
P$B.NDTYPE
      5188**DCL     16508<<ASSIGN
P$B.NSUBLKS
      5197**DCL     16504>>IF      16510>>IF
P$B.SUBLK$
      5218**DCL     16511>>ASSIGN
P$B.TEMP
      5186**DCL     16507<<ASSIGN
P$KEYWORDS.KEYWORDS$ IN PROCEDURE SPELLING_CHECKER
     17326**DCL     17422<>CALL    17429>>IF      17441>>ASSIGN
P$KEYWORDS.KEYWORD_COUNT IN PROCEDURE SPELLING_CHECKER
     17320**DCL     17416>>ASSIGN  17422<>CALL    17434<<ASSIGN  17434>>ASSIGN  17482>>IF      17488>>IF
     17498>>IF      17525>>IF      17528<<ASSIGN  17538>>IF
P$KEYWORDS.LEGAL$ IN PROCEDURE SPELLING_CHECKER
     17323**DCL     17422>>CALL    17429>>IF      17433>>ASSIGN  17438>>IF
P$LIT.ABREV
      5160**DCL     17459>>IF      17472>>ASSIGN  17473>>ASSIGN  17473>>ASSIGN
P$LIT.COUNT
      5167**DCL      5170--IMP-SIZ 17462>>ASSIGN  17463>>ASSIGN  17469>>ASSIGN  17470>>ASSIGN  17473>>ASSIGN
     17490>>IF
P$LIT.TEXT
      5170**DCL     17463>>ASSIGN  17470>>ASSIGN  17473>>ASSIGN  17490>>IF
P$NODE
      5050**DCL     16464<<ASSIGN  16464>>ASSIGN  16467<<ASSIGN  16467>>ASSIGN
P$NODE.SUBNDS$
      5116**DCL     16466>>ASSIGN  16467>>ASSIGN
P$NODE.TYPE
      5054**DCL     16212>>IF
PARSEALT
     16533**LABEL   16243--REMEMBR 16486--CALLALT
POFF
     15854**DCL     16849<<ASSIGN  16852<<ASSIGN  16860>>ASSIGN  16868>>ASSIGN  16869>>ASSIGN  16870>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:291  
     16888>>ASSIGN  16942<<ASSIGN  16943>>ASSIGN  16948<<ASSIGN  16949>>ASSIGN  16957>>ASSIGN  16958>>CALLBLT
     16958>>CALLBLT 17028<<ASSIGN  17029>>IF      17032>>ASSIGN
PR$
        14**DCL        15--IMP-PTR
PROMPT$C.C
        16**DCL     17029>>IF      17033>>ASSIGN
PROMPT_BUF
     15859**DCL     16944<<ASSIGN  16949<<ASSIGN  16958>>CALLBLT
PROMPT_FLG
     15845**DCL     17009<<ASSIGN  17012<<ASSIGN  17031<<ASSIGN  17036>>IF
PSIZ
        17**DCL        16--IMP-SIZ 17024<<ASSIGN  17028>>ASSIGN  17029>>IF      17033>>ASSIGN
P_PCB
      4652**DCL     15990--ASSIGN  16074<<ASSIGN  16486<>CALL    17094<>CALL    17106<>CALL    17121<>CALL
     17404<>CALL    17406<>CALL    17530<>CALL
P_PCB.BLANKONLY
      4739**DCL     17096>>IF
P_PCB.DYNMEM
      4719**DCL     16478<<ASSIGN
P_PCB.ERROR
      4756**DCL     16607>>ASSIGN  16661<<ASSIGN  16670<<ASSIGN  16672<<ASSIGN  17400<<ASSIGN
P_PCB.ERROR.CODE
      4764**DCL     16548>>IF      17109>>IF      17410>>IF
P_PCB.ERROR.MID
      4762**DCL     16596<<ASSIGN
P_PCB.ERROR.MON
      4763**DCL     16548>>IF      16609>>IF      17410>>IF
P_PCB.HINODE$
      4810**DCL     17090>>ASSIGN  17128<<ASSIGN  17396>>ASSIGN  17536<<ASSIGN  17549<<ASSIGN
P_PCB.HI_CHAR
      4803**DCL     16132<<ASSIGN  16549>>ASSIGN  16555<<ASSIGN  16570<<ASSIGN  16575<<ASSIGN  16588<<ASSIGN
     16698>>ASSIGN  17089>>ASSIGN  17096>>IF      17127<<ASSIGN  17334>>ASSIGN  17394>>ASSIGN  17398<<ASSIGN
     17534<<ASSIGN  17547<<ASSIGN
P_PCB.KEYWORDS
      4724**DCL     17399<<ASSIGN  17408<<ASSIGN
P_PCB.NCHARS
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:292  
      4799**DCL     16426<<ASSIGN  16441<<ASSIGN  16476<<ASSIGN  16546>>ASSIGN  16666<<ASSIGN  16699>>ASSIGN
     16732>>IF      16738>>ASSIGN  16745>>IF      16746>>ASSIGN  16760>>ASSIGN  16772>>ASSIGN  17096>>IF
     17101>>ASSIGN  17102<<ASSIGN  17102>>ASSIGN  17129<<ASSIGN  17129>>ASSIGN  17161>>ASSIGN  17335>>ASSIGN
P_PCB.NXT
      4702**DCL     16326<<ASSIGN  16345<<ASSIGN  16479<<ASSIGN  16565<<ASSIGN  16590<<ASSIGN  17103<<ASSIGN
     17120<<ASSIGN
P_PCB.NXT_SZONLY
      4747**DCL     17401<<ASSIGN  17405<<ASSIGN
P_PCB.OUT$
      4665**DCL     16491>>CALL    16503>>ASSIGN  16504>>IF      16506>>ASSIGN  16507>>ASSIGN  16508>>ASSIGN
     16510>>IF      16511<<ASSIGN  16511>>ASSIGN  16512>>ASSIGN  16518>>ASSIGN  17414>>ASSIGN
P_PCB.OUTDCB#
      4794**DCL     16257<<ASSIGN
P_PCB.ROOT$
      4657**DCL     16329<<ASSIGN  16472<<ASSIGN  16559>>ASSIGN
P_PCB.TEXT$
      4653**DCL     16449<<ASSIGN  17101>>ASSIGN  17163>>ASSIGN
P_PCB.U$$
      4670**DCL     16477<<ASSIGN
P_PCB.USER$
      4819**DCL     16238>>ASSIGN  16239<<ASSIGN  16330<<ASSIGN  16344<<ASSIGN  16484<<ASSIGN  16520<<ASSIGN
     16533<<ASSIGN  16545<<ASSIGN  16564<<ASSIGN  16589<<ASSIGN  16636<<ASSIGN  16641<<ASSIGN
P_PCB.VERSION_CODE
      4789**DCL     16474<<ASSIGN
P_PCB.WKSZ
      4682**DCL     16475<<ASSIGN
P_PCB.WK_USED
      4785**DCL     17091>>ASSIGN  17130<<ASSIGN  17395>>ASSIGN  17535<<ASSIGN  17548<<ASSIGN
P_PCB.WORK$
      4661**DCL     16473<<ASSIGN
P_PCB$
     15827**DCL      4652--IMP-PTR 16073<<ASSIGN  16074>>ASSIGN  16075>>ASSIGN  16209<<ASSIGN  16238>>ASSIGN
     16239>>ASSIGN  16257>>ASSIGN  16326>>ASSIGN  16329>>ASSIGN  16330>>ASSIGN  16344>>ASSIGN  16345>>ASSIGN
     16426>>ASSIGN  16441>>ASSIGN  16449>>ASSIGN  16472>>ASSIGN  16473>>ASSIGN  16474>>ASSIGN  16475>>ASSIGN
     16476>>ASSIGN  16477>>ASSIGN  16478>>ASSIGN  16479>>ASSIGN  16484>>ASSIGN  16486>>CALL    16491>>CALL
     16503>>ASSIGN  16504>>IF      16506>>ASSIGN  16507>>ASSIGN  16508>>ASSIGN  16510>>IF      16511>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:293  
     16511>>ASSIGN  16512>>ASSIGN  16518>>ASSIGN  16520>>ASSIGN  16533>>ASSIGN  16545>>ASSIGN  16546>>ASSIGN
     16548>>IF      16548>>IF      16549>>ASSIGN  16555>>ASSIGN  16559>>ASSIGN  16564>>ASSIGN  16565>>ASSIGN
     16570>>ASSIGN  16575>>ASSIGN  16588>>ASSIGN  16589>>ASSIGN  16590>>ASSIGN  16596>>ASSIGN  16607>>ASSIGN
     16609>>IF      16636>>ASSIGN  16641>>ASSIGN  16649<<ASSIGN  16661>>ASSIGN  16666>>ASSIGN  16670>>ASSIGN
     16672>>ASSIGN  16678<<ASSIGN  16698>>ASSIGN  16699>>ASSIGN  16732>>IF      16738>>ASSIGN  16745>>IF
     16746>>ASSIGN  16760>>ASSIGN  16772>>ASSIGN  17089>>ASSIGN  17090>>ASSIGN  17091>>ASSIGN  17094>>CALL
     17096>>IF      17096>>IF      17096>>IF      17101>>ASSIGN  17101>>ASSIGN  17102>>ASSIGN  17102>>ASSIGN
     17103>>ASSIGN  17106>>CALL    17109>>IF      17120>>ASSIGN  17121>>CALL    17127>>ASSIGN  17128>>ASSIGN
     17129>>ASSIGN  17129>>ASSIGN  17130>>ASSIGN  17161>>ASSIGN  17163>>ASSIGN  17334>>ASSIGN  17335>>ASSIGN
     17394>>ASSIGN  17395>>ASSIGN  17396>>ASSIGN  17398>>ASSIGN  17399>>ASSIGN  17400>>ASSIGN  17401>>ASSIGN
     17404>>CALL    17405>>ASSIGN  17406>>CALL    17408>>ASSIGN  17410>>IF      17410>>IF      17414>>ASSIGN
     17530>>CALL    17534>>ASSIGN  17535>>ASSIGN  17536>>ASSIGN  17547>>ASSIGN  17548>>ASSIGN  17549>>ASSIGN
P_PCB_C
      4851**DCL     16074>>ASSIGN
QM_HIT IN PROCEDURE SPELLING_CHECKER
     17295**DCL     17377<<ASSIGN  17383<<ASSIGN  17388>>IF      17486>>IF      17538>>IF
QM_REQUIRED IN PROCEDURE SPELLING_CHECKER
     17284**DCL     17268--PROC    17388>>IF
RDALT1
     16639**LABEL   16307--CALLALT 16350--CALLALT
RDALT2
     16672**LABEL   16658--CALLALT
READ_ANOTHER
     16341**LABEL   16333--CALLALT
REPORT_ALTERNATIVES
     17082**PROC    16340--CALL    16587--CALL
RESTORE_USER$
     16589**LABEL   16571--GOTO
RLT
     15445**DCL     15993--ASSIGN  16023--ASSIGN  16038<<ASSIGN  16170--ASSIGN  16321<<ASSIGN  16435<<ASSIGN
     16437<<ASSIGN  16652<<ASSIGN  16655<<ASSIGN  16655>>ASSIGN  16665<<ASSIGN  16932>>ASSIGN  16957>>ASSIGN
     16985>>ASSIGN  16991>>ASSIGN
RLT_SZ
     15841**DCL     15993<<ASSIGN  15994>>IF      15995<<ASSIGN  15995>>ASSIGN  15995>>ASSIGN  15997>>ASSIGN
     16024>>ASSIGN  16030>>ASSIGN  16170<<ASSIGN  16171>>IF      16172<<ASSIGN  16172>>ASSIGN  16172>>ASSIGN
     16176>>ASSIGN  16187>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:294  
ROOT$
     15828**DCL     16462<<ASSIGN  16464>>ASSIGN  16471<<ASSIGN  16472>>ASSIGN
RSEG
     15834**DCL     15945<<ASSIGN  16081>>IF
RSEG.SID
     15836**DCL     15949<<ASSIGN  15952<<ASSIGN  15955<<ASSIGN  15958<<ASSIGN  15961<<ASSIGN  15964<<ASSIGN
     15967<<ASSIGN  15970<<ASSIGN  16385>>IF
SAVED_HINODE$ IN PROCEDURE REPORT_ALTERNATIVES
     17086**DCL     17090<<ASSIGN  17128>>ASSIGN
SAVED_HINODE$ IN PROCEDURE SPELLING_CHECKER
     17297**DCL     17396<<ASSIGN  17536>>ASSIGN  17549>>ASSIGN
SAVED_HI_CHAR IN PROCEDURE REPORT_ALTERNATIVES
     17085**DCL     17089<<ASSIGN  17127>>ASSIGN
SAVED_HI_CHAR IN PROCEDURE SPELLING_CHECKER
     17296**DCL     17394<<ASSIGN  17534>>ASSIGN  17547>>ASSIGN
SAVED_WK_USED IN PROCEDURE REPORT_ALTERNATIVES
     17087**DCL     17091<<ASSIGN  17130>>ASSIGN
SAVED_WK_USED IN PROCEDURE SPELLING_CHECKER
     17298**DCL     17395<<ASSIGN  17535>>ASSIGN  17548>>ASSIGN
SAVE_DCB
     15866**DCL     16769<<ASSIGN  16819>>ASSIGN
SAVE_ERR
     15865**DCL     16768<<ASSIGN  16818>>ASSIGN
SAVE_F1
     15867**DCL     16770<<ASSIGN  16820>>ASSIGN
SAVE_F2
     15868**DCL     16771<<ASSIGN  16821>>ASSIGN
SAVE_PROMPT_
     15862**DCL     16240<<ASSIGN  16246>>ASSIGN
SAVE_PROMPT_VFC
     15864**DCL     16242<<ASSIGN  16248>>ASSIGN
SAVE_RPROMPT_
     15863**DCL     16241<<ASSIGN  16247>>ASSIGN
SCAN IN PROCEDURE SCAN_RECORD
     17244**LABEL   17248--EXIT    17251--EXIT
SCAN_RECORD
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:295  
     17228**PROC    16782--CALL    16796--CALL
SEG$
     15833**DCL     15834--REDEF   15882--IMP-PTR 15973>>ASSIGN  16017<<ASSIGN  16019>>ASSIGN  16020<<ASSIGN
     16020>>ASSIGN  16021>>ASSIGN  16022>>ASSIGN  16030<<ASSIGN  16031>>ASSIGN  16032>>ASSIGN  16035>>ASSIGN
     16080<<ASSIGN  16384<<ASSIGN  16385>>IF      16385>>IF      16389>>ASSIGN
SETFLG
     16700**LABEL   16707--EXIT
SETUP_WORK
     15997**LABEL   16003--GOTO
SHOW_ALTRN
     16311**LABEL   16431--GOTO
SINPUT_ERR
     16891**LABEL   16889--CALLALT
SIZ IN PROCEDURE MOVER
     17064**DCL     17059--PROC    17077>>ASSIGN
SPELLING_CHECKER
     17268**PROC    16333--CALL    16568--CALL
STATIC_SZ
     15839**DCL     15990<<ASSIGN  15991>>IF      15992<<ASSIGN  15992>>ASSIGN  15992>>ASSIGN  15997>>ASSIGN
     16017>>ASSIGN
STRING IN PROCEDURE FETCH_HELP_TOPIC
     17144**DCL     17167>>DOUNTIL 17175>>IF      17183>>DOWHILE 17199>>CALLBLT 17215>>ASSIGN  17219>>CALLBLT
STRING IN PROCEDURE SPELLING_CHECKER
     17300**DCL     17342>>IF      17342>>IF      17351>>IF      17363>>IF      17381>>IF      17386>>CALLBLT
STRING$ IN PROCEDURE FETCH_HELP_TOPIC
     17143**DCL     17144--IMP-PTR 17163<<ASSIGN  17167>>DOUNTIL 17175>>IF      17183>>DOWHILE 17199>>CALLBLT
     17215>>ASSIGN  17219>>CALLBLT
STRING$ IN PROCEDURE SPELLING_CHECKER
     17299**DCL     17300--IMP-PTR 17336<<ASSIGN  17342>>IF      17342>>IF      17351>>IF      17363>>IF
     17381>>IF      17386>>CALLBLT
SYMTTBL.ALPHA
      4628**DCL     17342>>IF      17351>>IF      17363>>IF
SYMTTBL.FID
      4627**DCL     17249>>IF
SYMTTBL.GENERIC_DSTRING
      4628**DCL     17249>>IF
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:296  
SYMTTBL.PL6SYM
      4628**DCL     17167>>DOUNTIL 17183>>DOWHILE
TCSIZE
     15853**DCL     16856<<ASSIGN  16859<<ASSIGN  16860>>ASSIGN  16867<<ASSIGN  16871>>ASSIGN  16873<<ASSIGN
     16878<<ASSIGN  16885<<ASSIGN  16885>>ASSIGN  16888>>ASSIGN
TEMP_ERR
     13382**DCL     15976<<ASSIGN  15979--ASSIGN  16122<>CALL    16124>>ASSIGN
TEMP_ERR.SEV
     13412**DCL     15977<<ASSIGN
TEXT$
     15831**DCL     16372<<ASSIGN  16403<<ASSIGN  16408<<ASSIGN  16411>>IF      16420>>ASSIGN
TEXTC IN PROCEDURE SPELLING_CHECKER
     17302**DCL     17422<>CALL    17445--ASSIGN
TEXTC.COUNT IN PROCEDURE SPELLING_CHECKER
     17303**DCL     17385<<ASSIGN
TEXTC.TEXT IN PROCEDURE SPELLING_CHECKER
     17304**DCL     17386<<CALLBLT 17429>>IF      17490>>IF
TO$
     15832**DCL     16853<<ASSIGN  16860>>ASSIGN  16863>>ASSIGN  16864<<ASSIGN  16864>>ASSIGN  16869>>ASSIGN
     16870<<ASSIGN  16870>>ASSIGN  16876>>ASSIGN  16877<<ASSIGN  16877>>ASSIGN  16880>>ASSIGN  16883>>ASSIGN
TO$ IN PROCEDURE MOVER
     17066**DCL     17071<<ASSIGN  17074>>ASSIGN  17076>>ASSIGN
TPOS
     15851**DCL     16721<<ASSIGN  16724<<ASSIGN  16724>>ASSIGN  16731<<ASSIGN  16742<<ASSIGN  16759>>ASSIGN
     16761>>ASSIGN
TRANSTBL
      4632**DCL     17199>>CALLBLT 17386>>CALLBLT
TSTRING IN PROCEDURE FETCH_HELP_TOPIC
     17145**DCL     17199<<CALLBLT 17201>>IF      17205>>IF
TWOCHARS
     15847**DCL     16277<<ASSIGN  16314>>CALLBLT 16324>>ASSIGN
UBIN$BUF9
     15879**DCL     16860<<ASSIGN  16863<<ASSIGN
USER_GDSVEC
     11967**DCL     16122<>CALL    16128>>IF      16140>>IF
VEC IN PROCEDURE MOVER
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:297  
     17062**DCL     17059--PROC    17069>>ASSIGN  17070>>ASSIGN  17076<<ASSIGN  17077<<ASSIGN  17077>>ASSIGN
VEC$BUF
     15882**DCL     16019--ASSIGN  16035--ASSIGN
WBUFSZ
     15843**DCL     16177<<ASSIGN  16178<>CALL    16180>>ASSIGN  16187<<ASSIGN  16188<>CALL
WDS IN PROCEDURE MOVER
     17065**DCL     17074<<ASSIGN  17074>>ASSIGN
WOFF
     15842**DCL     16176<<ASSIGN  16177>>ASSIGN  16178<>CALL    16179>>ASSIGN  16181>>ASSIGN  16186<<ASSIGN
     16188<>CALL
WORK_SZ
     15840**DCL     15997<<ASSIGN  15998>>IF      16018>>ASSIGN  16026<<ASSIGN  16029>>ASSIGN
X$PARSE
        19**DCL-ENT 16486--CALL    17094--CALL    17106--CALL    17121--CALL    17404--CALL    17406--CALL
X66_REL_AUTO
     13419**DCL-ENT 16289--CALL    16399--CALL
XT$
     15825**DCL     15523--IMP-PTR 16157<<ASSIGN  16158>>IF      16158>>IF      16162>>ASSIGN  16163>>ASSIGN
     16165>>ASSIGN
XT_
     15826**DCL     16161<<ASSIGN  16162<<ASSIGN  16163<<ASSIGN  16164<>CALL    16165>>ASSIGN
XT_PARAM
     15523**DCL     15990--ASSIGN
XT_PARAM.WS$
     15524**DCL     16158>>IF      16162>>ASSIGN  16165<<ASSIGN
XT_PARAM.WS_SIZE
     15558**DCL     16163>>ASSIGN
XUG
     13424**DCL     15987<<ASSIGN  15990--ASSIGN  16073--ASSIGN
XUG.ABORT
     13452**DCL     16045<<ASSIGN
XUG.ADAPT$$
     13847**DCL     16079<<ASSIGN
XUG.ADDL_RLTCNT
     13707**DCL     16060<<ASSIGN  16170>>ASSIGN  16189>>ASSIGN
XUG.BRKARS
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:298  
     13682**DCL     16281>>ASSIGN  16283<<ASSIGN
XUG.BRKMSG
     13459**DCL     16047<<ASSIGN
XUG.BUF
     13860**DCL     13863--REDEF   16372--ASSIGN  16395<<ASSIGN  16403--ASSIGN  16691--ASSIGN  16728<<ASSIGN
     16744<<CALLBLT 16758<<ASSIGN  16848<<ASSIGN  16853--ASSIGN  16887--ASSIGN  16958<<CALLBLT 16961>>IF
     16968<<ASSIGN  16978<<ASSIGN  16978>>ASSIGN  16980--ASSIGN
XUG.BUFA
     13863**DCL     16716--IF      16730--ASSIGN  16734--ASSIGN  16750--ASSIGN  16759<<ASSIGN
XUG.BUFVEC
     13425**DCL     16035<<ASSIGN  16161>>ASSIGN  16178<>CALL    16266>>ASSIGN  16277>>ASSIGN  16309>>IF
     16314>>CALLBLT 16322>>ASSIGN  16324>>ASSIGN  16449>>ASSIGN  16498>>ASSIGN  16542>>ASSIGN  16551>>IF
     16560>>IF      16573>>IF      16650>>ASSIGN  16651>>ASSIGN  16730>>ASSIGN  16744>>CALLBLT 16785>>ASSIGN
     16798>>ASSIGN  16880>>ASSIGN  16958>>CALLBLT 17240>>ASSIGN  17336>>ASSIGN
XUG.CCBUF_OFFC
     13838**DCL     16268<<ASSIGN  16389<<ASSIGN  16390>>ASSIGN  16721>>ASSIGN  16841>>IF      16859>>ASSIGN
     16874>>IF      16876>>ASSIGN  16877>>ASSIGN  16878>>ASSIGN
XUG.CCBUF_REST
     13843**DCL     16390<<ASSIGN  16881>>IF      16883>>ASSIGN  16883>>ASSIGN  16885>>ASSIGN
XUG.CMDSZ
     13711**DCL     16061<<ASSIGN  16376>>IF
XUG.COMMANDS
     13536**DCL     16062<<ASSIGN  16459>>IF      16501>>IF      17152>>ASSIGN
XUG.CONTINUE
     13455**DCL     16046<<ASSIGN
XUG.CPOS
     13692**DCL     16267<<ASSIGN  16650>>ASSIGN  16651>>ASSIGN  16652>>ASSIGN  16657>>ASSIGN  16666>>ASSIGN
     16716>>IF      16716>>IF      16721>>ASSIGN  16760<<ASSIGN  16772<<ASSIGN  16773>>IF      16784>>ASSIGN
     16789>>IF      16789>>IF      16792>>ASSIGN  16840>>ASSIGN  16934<<ASSIGN  16993<<ASSIGN
XUG.DCBS
     13717**DCL     16258<<ASSIGN
XUG.DCBS.ERRPTR_CPOS
     13719**DCL     16261<<ASSIGN  16703>>IF      16706<<ASSIGN  16929<<ASSIGN
XUG.DCBS.NUM
     13718**DCL     16259<<ASSIGN  16260<<ASSIGN  16303<<ASSIGN  16701>>CALL    16904--IF      16907>>CALL
     16928<<ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:299  
XUG.DEFER_SETTING_PROMPT
     13820**DCL     17009>>ASSIGN  17010<<ASSIGN  17041<<ASSIGN  17052<<ASSIGN
XUG.DIVERT_TO_HELP
     13598**DCL     16634<<ASSIGN  16640<<ASSIGN  17222<<ASSIGN
XUG.DOCMD_SYNERR
     13565**DCL     16315>>IF
XUG.DONT_REREAD_CCBUF
     13827**DCL     16065<<ASSIGN  16841>>IF      16857>>IF      16874>>IF      16881>>IF
XUG.DONT_STRIP_PROMPT
     13832**DCL     16066<<ASSIGN  16411>>IF
XUG.DUMMY_NODE
     13496**DCL     16463--ASSIGN
XUG.DUMMY_NODE.SUBND$
     13498**DCL     16468<<ASSIGN
XUG.ERRDCB
     13520**DCL     16056<<ASSIGN
XUG.F1SAVE
     13851**DCL     16094<<ASSIGN
XUG.F2SAVE
     13854**DCL     16095<<ASSIGN
XUG.F3SAVE
     13857**DCL     16096<<ASSIGN
XUG.FILEACCT
     13729**DCL     16092<<ASSIGN
XUG.FILENAME.C
     13725**DCL     16090<<ASSIGN
XUG.FILENAME.TX
     13726**DCL     16091<<ASSIGN
XUG.FILEPASS
     13732**DCL     16093<<ASSIGN
XUG.FIRST_ERROR
     13646**DCL     16270<<ASSIGN
XUG.GDSVEC
     13435**DCL     15988<<ASSIGN  16106--ASSIGN  16127>>ASSIGN  16127>>ASSIGN  16151<<ASSIGN  16151>>ASSIGN
XUG.GOODCMD
     13577**DCL     16067<<ASSIGN  16442>>IF      16609>>IF      16809>>IF
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:300  
XUG.GOTCMD
     13529**DCL     16279>>IF      16280<<ASSIGN
XUG.GOTCMD_EOMCHAR
     13807**DCL     16282>>ASSIGN
XUG.HELP_TOPIC.COUNT
     13805**DCL     17214<<ASSIGN  17218<<ASSIGN
XUG.HELP_TOPIC.TEXT
     13806**DCL     17215<<ASSIGN  17219<<CALLBLT
XUG.INHIBITS
     13626**DCL     16063<<ASSIGN
XUG.INHIBITS.DO#
     13632**DCL     17152>>ASSIGN
XUG.LAST
     13432**DCL     16181<<ASSIGN  16181>>ASSIGN
XUG.MOREMEM
     13481**DCL     16052<<ASSIGN  16110>>IF      16122>>CALL
XUG.NDCBS
     13714**DCL     16262<<ASSIGN  16700>>DOINDEX 16906>>DOINDEX 16926>>IF      16927<<ASSIGN  16927>>ASSIGN
     16928>>ASSIGN  16929>>ASSIGN
XUG.NEED_ECHO
     13573**DCL     16318>>IF      16493>>IF      16496<<ASSIGN  16536>>IF      16540<<ASSIGN
XUG.NLINES
     13699**DCL     16028<<ASSIGN  16249<<ASSIGN  16320<<ASSIGN  16436<<ASSIGN  16500>>ASSIGN  16544>>ASSIGN
     16616>>IF      16652>>ASSIGN  16655>>ASSIGN  16655>>ASSIGN  16659>>IF      16664<<ASSIGN  16664>>ASSIGN
     16665>>ASSIGN  16931>>DOINDEX 16956>>DOINDEX 16966>>IF      16990>>DOINDEX
XUG.NO_DOWNGRADE
     13641**DCL     16064<<ASSIGN
XUG.PARSEVEC
     13438**DCL     16019<<ASSIGN  16190<<ASSIGN  16190>>ASSIGN  16473>>ASSIGN  16475>>ASSIGN
XUG.PARSING_FREE_CMDS
     13815**DCL     16485<<ASSIGN  17093<<ASSIGN  17104<<ASSIGN  17119<<ASSIGN  17402<<ASSIGN
XUG.POFF
     13506**DCL     16039<<ASSIGN  16411>>IF      16411>>IF      16411>>IF      16416>>ASSIGN  16716>>IF
     16716>>IF      16721>>ASSIGN  16724>>ASSIGN  16852>>ASSIGN  16948>>ASSIGN  17012>>IF      17013<<ASSIGN
     17019<<ASSIGN  17029>>IF      17032<<ASSIGN  17155>>CALLBLT
XUG.POINTED_TO_SYNERR
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:301  
     13605**DCL     16558<<ASSIGN  16837<<ASSIGN
XUG.POST_EXEC
     13477**DCL     16051<<ASSIGN  16341>>IF      16343>>CALL
XUG.PPCB$
     13658**DCL     16057<<ASSIGN
XUG.PP_DCB
     13670**DCL     16059<<ASSIGN
XUG.PP_ERR
     13674**DCL     16269<<ASSIGN  16438>>IF      16440>>ASSIGN  16667>>IF      16670>>ASSIGN
XUG.PP_PROCNAME_
     13661**DCL     16058<<ASSIGN
XUG.PREPROCESS
     13549**DCL     16044<<ASSIGN  16284>>IF      16393>>IF
XUG.PREPROCESSOR$$
     13462**DCL     16048<<ASSIGN  16286>>IF      16396>>IF
XUG.PREV_CPOS
     13695**DCL     16434<<ASSIGN  16652>>ASSIGN  16653>>IF      16657<<ASSIGN
XUG.PRE_EXEC
     13473**DCL     16050<<ASSIGN  16311>>IF      16313>>CALL
XUG.PROMPT
     13509**DCL     16041<<ASSIGN  16411>>IF      16716>>IF      16869>>ASSIGN  16949>>ASSIGN  17015<<ASSIGN
     17021<<ASSIGN  17029>>IF      17033<<ASSIGN  17155>>CALLBLT
XUG.PROMPT_VFC
     13583**DCL     16040<<ASSIGN  16411>>IF      16869>>ASSIGN  16945>>ASSIGN  16949>>ASSIGN  16974>>IF
     17014<<ASSIGN  17020<<ASSIGN  17029>>IF      17034<<ASSIGN  17155>>CALLBLT
XUG.P_PCB$
     13655**DCL     16075<<ASSIGN  16078<<ASSIGN  16084>>ASSIGN  16209>>ASSIGN  16649>>ASSIGN  16678>>ASSIGN
XUG.QM_AFTER_SYNERR
     13612**DCL     16481<<ASSIGN  16591<<ASSIGN  16628>>IF      16710>>IF      16837>>ASSIGN
XUG.READVEC
     13428**DCL     16179<<ASSIGN  16179>>ASSIGN  16180<<ASSIGN  16180>>ASSIGN  16266<<ASSIGN  16296<<ASSIGN
     16307<>CALL    16350<>CALL    16419<<ASSIGN  16420>>ASSIGN  16429>>IF      16650<<ASSIGN  16651<<ASSIGN
     16658<>CALL
XUG.REM_PARSE
     13448**DCL     16243<<REMEMBR 16662>>UNWIND  16671>>UNWIND  16673>>UNWIND
XUG.REQ_PROMPT
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:302  
     13553**DCL     16042<<ASSIGN
XUG.RLTCNT
     13703**DCL     16027<<ASSIGN  16189<<ASSIGN  16189>>ASSIGN  16659>>IF
XUG.RLTVEC
     13442**DCL     16023<<ASSIGN  16024<<ASSIGN  16030>>ASSIGN  16038>>ASSIGN  16188<>CALL    16321>>ASSIGN
     16435>>ASSIGN  16437>>ASSIGN  16499>>ASSIGN  16543>>ASSIGN  16652>>ASSIGN  16655>>ASSIGN  16655>>ASSIGN
     16665>>ASSIGN  16932>>ASSIGN  16957>>ASSIGN  16985>>ASSIGN  16991>>ASSIGN
XUG.ROOT_NODE
     13486**DCL     16462--ASSIGN
XUG.ROOT_NODE.GETCMD_NODE$
     13489**DCL     16466<<ASSIGN
XUG.ROOT_NODE.USER_NODE$
     13488**DCL     16465<<ASSIGN
XUG.SFROUTINE
     13465**DCL     16264<<ASSIGN  16265<<ASSIGN
XUG.SPELLING
     13589**DCL     16070<<ASSIGN  16331>>IF      16560>>IF      16566>>IF
XUG.SPELLING_TRIED
     13593**DCL     16331>>IF      16480<<ASSIGN  16560>>IF      16566>>IF      17333<<ASSIGN  17390<<ASSIGN
XUG.SPHANDLE
     13468**DCL     16049<<ASSIGN
XUG.SYNERR
     13545**DCL     16275>>IF      16308>>DOWHILE 16334<<ASSIGN  16363<<ASSIGN  16429>>IF      16432<<ASSIGN
     16557<<ASSIGN  16578<<ASSIGN  16765>>IF      16803>>IF      16837>>ASSIGN
XUG.SYNTAX
     13540**DCL     16043<<ASSIGN  16547>>IF
XUG.USER$
     13665**DCL     16238<<ASSIGN  16344>>ASSIGN  16520>>ASSIGN  16533>>ASSIGN  16545>>ASSIGN  16589>>ASSIGN
     16636>>ASSIGN  16641>>ASSIGN
XUG.XUG_OWNS_MEMORY
     13561**DCL     15989<<ASSIGN  16102>>IF
XUG.XUH_PARAM
     13757**DCL     16053<<ASSIGN
XUG.XUH_PARAM.PROCACCT_
     13760**DCL     16054<<ASSIGN
XUG.XUH_PARAM.PROCNAME_
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:303  
     13759**DCL     16055<<ASSIGN
XUG#AREANOTRTSZ
     12509**DCL     16143>>ASSIGN
XUG#CANTEXPAND
     12555**DCL     16112>>ASSIGN
XUG#FOLLOWED_BY
     13199**DCL     17112>>ASSIGN
XUG#INCOR_HERE
     12739**DCL     16813>>ASSIGN
XUG#INCOR_HERE_XPND
     12693**DCL     16811>>ASSIGN
XUG#INCOR_PTD_XPND
     12647**DCL     16807>>ASSIGN
XUG#LEGAL_INPUT_HERE
     12831**DCL     16335>>ASSIGN
XUG#LEGAL_INPUT_QM
     12877**DCL     16581>>ASSIGN
XUG#LINETOOLONG
     13337**DCL     16378>>ASSIGN
XUG#MULTI_CHOICE
     13061**DCL     17496>>ASSIGN
XUG#MULTI_LEGAL
     12969**DCL     17502>>ASSIGN
XUG#NOTCONTIGAREA
     12463**DCL     16131>>ASSIGN
XUG#NO_MATCH
     13153**DCL     17484>>ASSIGN
XUG#NO_OTHER_CHOICE
     13107**DCL     17492>>ASSIGN
XUG#NULLROOT
     13245**DCL     16453>>ASSIGN
XUG#NWALIGNED
     12785**DCL     15934>>ASSIGN
XUG#PLERRMSG
     12601**DCL     16815>>ASSIGN
XUG#PRE_C00
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:304  
     13291**DCL     16214>>ASSIGN
XUG#SINGLE_CHOICE
     13015**DCL     17494>>ASSIGN
XUG#SINGLE_LEGAL
     12923**DCL     17500>>ASSIGN
XUG#SMALLWORK
     12417**DCL     15926>>ASSIGN  16006>>ASSIGN
XUG$
     15824**DCL     13424--IMP-PTR 15985<<ASSIGN  15986>>ASSIGN  15987>>ASSIGN  15988>>ASSIGN  15989>>ASSIGN
     16017>>ASSIGN  16019>>ASSIGN  16023>>ASSIGN  16024>>ASSIGN  16027>>ASSIGN  16028>>ASSIGN  16030>>ASSIGN
     16035>>ASSIGN  16037<<ASSIGN  16038>>ASSIGN  16039>>ASSIGN  16040>>ASSIGN  16041>>ASSIGN  16042>>ASSIGN
     16043>>ASSIGN  16044>>ASSIGN  16045>>ASSIGN  16046>>ASSIGN  16047>>ASSIGN  16048>>ASSIGN  16049>>ASSIGN
     16050>>ASSIGN  16051>>ASSIGN  16052>>ASSIGN  16053>>ASSIGN  16054>>ASSIGN  16055>>ASSIGN  16056>>ASSIGN
     16057>>ASSIGN  16058>>ASSIGN  16059>>ASSIGN  16060>>ASSIGN  16061>>ASSIGN  16062>>ASSIGN  16063>>ASSIGN
     16064>>ASSIGN  16065>>ASSIGN  16066>>ASSIGN  16067>>ASSIGN  16070>>ASSIGN  16073>>ASSIGN  16075>>ASSIGN
     16078>>ASSIGN  16079>>ASSIGN  16084>>ASSIGN  16089>>ASSIGN  16090>>ASSIGN  16091>>ASSIGN  16092>>ASSIGN
     16093>>ASSIGN  16094>>ASSIGN  16095>>ASSIGN  16096>>ASSIGN  16101<<ASSIGN  16102>>IF      16106>>ASSIGN
     16110>>IF      16122>>CALL    16127>>ASSIGN  16127>>ASSIGN  16151>>ASSIGN  16151>>ASSIGN  16161>>ASSIGN
     16170>>ASSIGN  16178>>CALL    16179>>ASSIGN  16179>>ASSIGN  16180>>ASSIGN  16180>>ASSIGN  16181>>ASSIGN
     16181>>ASSIGN  16188>>CALL    16189>>ASSIGN  16189>>ASSIGN  16189>>ASSIGN  16190>>ASSIGN  16190>>ASSIGN
     16208<<ASSIGN  16209>>ASSIGN  16238>>ASSIGN  16243>>REMEMBR 16249>>ASSIGN  16258>>ASSIGN  16259>>ASSIGN
     16260>>ASSIGN  16261>>ASSIGN  16262>>ASSIGN  16264>>ASSIGN  16265>>ASSIGN  16266>>ASSIGN  16266>>ASSIGN
     16267>>ASSIGN  16268>>ASSIGN  16269>>ASSIGN  16270>>ASSIGN  16275>>IF      16277>>ASSIGN  16279>>IF
     16280>>ASSIGN  16281>>ASSIGN  16282>>ASSIGN  16283>>ASSIGN  16284>>IF      16286>>IF      16296>>ASSIGN
     16303>>ASSIGN  16307>>CALL    16308>>DOWHILE 16309>>IF      16311>>IF      16313>>CALL    16314>>CALLBLT
     16315>>IF      16318>>IF      16320>>ASSIGN  16321>>ASSIGN  16322>>ASSIGN  16324>>ASSIGN  16331>>IF
     16331>>IF      16334>>ASSIGN  16341>>IF      16343>>CALL    16344>>ASSIGN  16350>>CALL    16363>>ASSIGN
     16372>>ASSIGN  16376>>IF      16389>>ASSIGN  16390>>ASSIGN  16390>>ASSIGN  16393>>IF      16395>>ASSIGN
     16396>>IF      16403>>ASSIGN  16411>>IF      16411>>IF      16411>>IF      16411>>IF      16411>>IF
     16411>>IF      16416>>ASSIGN  16419>>ASSIGN  16420>>ASSIGN  16429>>IF      16429>>IF      16432>>ASSIGN
     16434>>ASSIGN  16435>>ASSIGN  16436>>ASSIGN  16437>>ASSIGN  16438>>IF      16440>>ASSIGN  16442>>IF
     16449>>ASSIGN  16459>>IF      16462>>ASSIGN  16463>>ASSIGN  16465>>ASSIGN  16466>>ASSIGN  16468>>ASSIGN
     16473>>ASSIGN  16475>>ASSIGN  16480>>ASSIGN  16481>>ASSIGN  16485>>ASSIGN  16493>>IF      16496>>ASSIGN
     16498>>ASSIGN  16499>>ASSIGN  16500>>ASSIGN  16501>>IF      16520>>ASSIGN  16533>>ASSIGN  16536>>IF
     16540>>ASSIGN  16542>>ASSIGN  16543>>ASSIGN  16544>>ASSIGN  16545>>ASSIGN  16547>>IF      16551>>IF
     16557>>ASSIGN  16558>>ASSIGN  16560>>IF      16560>>IF      16560>>IF      16566>>IF      16566>>IF
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:305  
     16573>>IF      16578>>ASSIGN  16589>>ASSIGN  16591>>ASSIGN  16609>>IF      16616>>IF      16628>>IF
     16634>>ASSIGN  16636>>ASSIGN  16640>>ASSIGN  16641>>ASSIGN  16647<<ASSIGN  16649>>ASSIGN  16650>>ASSIGN
     16650>>ASSIGN  16650>>ASSIGN  16651>>ASSIGN  16651>>ASSIGN  16651>>ASSIGN  16652>>ASSIGN  16652>>ASSIGN
     16652>>ASSIGN  16652>>ASSIGN  16653>>IF      16655>>ASSIGN  16655>>ASSIGN  16655>>ASSIGN  16655>>ASSIGN
     16657>>ASSIGN  16657>>ASSIGN  16658>>CALL    16659>>IF      16659>>IF      16662>>UNWIND  16664>>ASSIGN
     16664>>ASSIGN  16665>>ASSIGN  16665>>ASSIGN  16666>>ASSIGN  16667>>IF      16670>>ASSIGN  16671>>UNWIND
     16673>>UNWIND  16677<<ASSIGN  16678>>ASSIGN  16691>>ASSIGN  16700>>DOINDEX 16701>>CALL    16703>>IF
     16706>>ASSIGN  16710>>IF      16716>>IF      16716>>IF      16716>>IF      16716>>IF      16716>>IF
     16721>>ASSIGN  16721>>ASSIGN  16721>>ASSIGN  16724>>ASSIGN  16728>>ASSIGN  16730>>ASSIGN  16730>>ASSIGN
     16734>>ASSIGN  16744>>CALLBLT 16744>>CALLBLT 16750>>ASSIGN  16758>>ASSIGN  16759>>ASSIGN  16760>>ASSIGN
     16765>>IF      16772>>ASSIGN  16773>>IF      16784>>ASSIGN  16785>>ASSIGN  16789>>IF      16789>>IF
     16792>>ASSIGN  16798>>ASSIGN  16803>>IF      16809>>IF      16837>>ASSIGN  16837>>ASSIGN  16837>>ASSIGN
     16839<<ASSIGN  16840>>ASSIGN  16841>>IF      16841>>IF      16848>>ASSIGN  16852>>ASSIGN  16853>>ASSIGN
     16857>>IF      16859>>ASSIGN  16869>>ASSIGN  16869>>ASSIGN  16874>>IF      16874>>IF      16876>>ASSIGN
     16877>>ASSIGN  16878>>ASSIGN  16880>>ASSIGN  16881>>IF      16881>>IF      16883>>ASSIGN  16883>>ASSIGN
     16885>>ASSIGN  16887>>ASSIGN  16895<<ASSIGN  16904>>IF      16906>>DOINDEX 16907>>CALL    16912<<ASSIGN
     16926>>IF      16927>>ASSIGN  16927>>ASSIGN  16928>>ASSIGN  16928>>ASSIGN  16929>>ASSIGN  16929>>ASSIGN
     16931>>DOINDEX 16932>>ASSIGN  16934>>ASSIGN  16945>>ASSIGN  16948>>ASSIGN  16949>>ASSIGN  16949>>ASSIGN
     16956>>DOINDEX 16957>>ASSIGN  16958>>CALLBLT 16958>>CALLBLT 16961>>IF      16966>>IF      16968>>ASSIGN
     16974>>IF      16978>>ASSIGN  16978>>ASSIGN  16980>>ASSIGN  16985>>ASSIGN  16990>>DOINDEX 16991>>ASSIGN
     16993>>ASSIGN  16999<<ASSIGN  17009>>ASSIGN  17010>>ASSIGN  17012>>IF      17013>>ASSIGN  17014>>ASSIGN
     17015>>ASSIGN  17019>>ASSIGN  17020>>ASSIGN  17021>>ASSIGN  17029>>IF      17029>>IF      17029>>IF
     17032>>ASSIGN  17033>>ASSIGN  17034>>ASSIGN  17041>>ASSIGN  17052>>ASSIGN  17093>>ASSIGN  17104>>ASSIGN
     17119>>ASSIGN  17152>>ASSIGN  17152>>ASSIGN  17155>>CALLBLT 17155>>CALLBLT 17155>>CALLBLT 17214>>ASSIGN
     17215>>ASSIGN  17218>>ASSIGN  17219>>CALLBLT 17222>>ASSIGN  17240>>ASSIGN  17333>>ASSIGN  17336>>ASSIGN
     17390>>ASSIGN  17402>>ASSIGN
XUG$BLANK_PASSWORD_COMMON
        20**DCL-ENT 16491--CALL
XUG$BUILTIN_COMMON
        30**DCL-ENT 16523--CALL
XUG$CLRENABLE_COMMON
        28**DCL-ENT 16365--CALL    16642--CALL
XUG$CORRES_COMMON
        23**DCL-ENT 16701--CALL    16907--CALL
XUG$DISABLE_COMMON
        27**DCL-ENT 16306--CALL
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:306  
XUG$ECHOIF_COMMON
     16894**ENTRY   16618--CALL
XUG$ECHOLAST_COMMON
        26**DCL-ENT 16302--CALL
XUG$ECHO_COMMON
     16911**ENTRY   16323--CALL    16495--CALL    16539--CALL
XUG$ERRMSG_COMMON
        21**DCL-ENT 16336--CALL    16582--CALL    16620--CALL    16816--CALL    17113--CALL    17523--CALL
XUG$ERRPTR_COMMON
     16675**ENTRY   16619--CALL
XUG$GETDCB_COMMON
        29**DCL-ENT 16251--CALL    16254--CALL    16686--CALL    16903--CALL    16920--CALL
XUG$INIT_COMMON
     15917**ENTRY   16203--CALL
XUG$MOREMEM
     16100**ENTRY   16660--CALL
XUG$OPENOUT_INTERNAL
        33**DCL-ENT 16688--CALL    16938--CALL
XUG$PP_CMDVARS
        32**DCL-ENT 16292--CALL    16402--CALL
XUG$PRE_PROCESSOR
        31**DCL-ENT 16288--CALL    16398--CALL
XUG$PU
        24**DCL-ENT 16477--ASSIGN
XUG$READCMD_COMMON
        22**DCL-ENT 16307--CALL    16350--CALL    16658--CALL
XUG$SETLAST
        25**DCL-ENT 16297--CALL    16421--CALL
XUG$SETPROMPT
     16997**ENTRY   16263--CALL
XUG_INIT
     14225**DCL         8--PROC    15917--ENTRY
XUG_INIT.ABORT$
     14226**DCL     16045>>ASSIGN
XUG_INIT.ADAPT$$
     14536**DCL     16079>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:307  
XUG_INIT.ADDL_NRECS#
     14382**DCL     16060>>ASSIGN
XUG_INIT.ALWAYS_SET_PROMPT#
     14504**DCL     16087>>ASSIGN
XUG_INIT.BRKMSG$
     14241**DCL     16047>>ASSIGN
XUG_INIT.CMDSZ#
     14376**DCL     15998>>IF      16061>>ASSIGN
XUG_INIT.COMMANDS#
     14433**DCL     16062>>ASSIGN
XUG_INIT.CONTINUE$
     14234**DCL     16046>>ASSIGN
XUG_INIT.DONT_REREAD_CCBUF#
     14519**DCL     16065>>ASSIGN
XUG_INIT.DONT_STRIP_PROMPT#
     14527**DCL     16066>>ASSIGN
XUG_INIT.ECHO#
     14396**DCL     16085>>ASSIGN
XUG_INIT.GOODCMD#
     14487**DCL     16067>>ASSIGN
XUG_INIT.INHIBITS
     14557**DCL     16063>>ASSIGN
XUG_INIT.INIT_NRECS#
     14389**DCL     15993>>ASSIGN  16027>>ASSIGN
XUG_INIT.MOREMEM$$
     14299**DCL     16052>>ASSIGN
XUG_INIT.NO_DOWNGRADE#
     14510**DCL     16064>>ASSIGN
XUG_INIT.PARAMS$
     14341**DCL     16089<<ASSIGN
XUG_INIT.PASS#
     14406**DCL     16086>>ASSIGN
XUG_INIT.PCB$
     14358**DCL     16071>>IF      16078>>ASSIGN
XUG_INIT.POST_EXEC$$
     14281**DCL     16051>>ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:308  
XUG_INIT.PPCB$
     14365**DCL     16057>>ASSIGN
XUG_INIT.PP_DCB#
     14414**DCL     16059>>ASSIGN
XUG_INIT.PP_PROCNAME_
     14370**DCL     16058>>ASSIGN
XUG_INIT.PP_ROOT$
     14549**DCL     16088>>ASSIGN
XUG_INIT.PREPROCESS#
     14468**DCL     16044>>ASSIGN
XUG_INIT.PREPROCESSOR$$
     14321**DCL     16048>>ASSIGN
XUG_INIT.PRE_EXEC$$
     14263**DCL     16050>>ASSIGN
XUG_INIT.PROCACCT_
     14335**DCL     16054>>ASSIGN
XUG_INIT.PROCNAME_
     14330**DCL     16055>>ASSIGN
XUG_INIT.REQ_PROMPT#
     14475**DCL     16042>>ASSIGN
XUG_INIT.SPELLING#
     14499**DCL     16070>>ASSIGN
XUG_INIT.SPHANDLE$
     14248**DCL     16049>>ASSIGN
XUG_INIT.SYNTAX#
     14482**DCL     16043>>ASSIGN
XUG_INIT.WORK_
     14345**DCL     15921>>IF      15923>>IF      15929>>ASSIGN  15930>>ASSIGN  15937>>ASSIGN
XUG_INIT.WSEG#
     14423**DCL     15946>>DOCASE
XUG_INIT_A
     15051**DCL     16202<<ASSIGN  16203<>CALL
XUG_INIT_C
     14638**DCL     16202>>ASSIGN
XUG_NODES
     13415**DCL     16461--ASSIGN
PL6.E3A0      #001=XUG$COMMON File=XUG$COMMON.:E05TSI                            WED 07/30/97 09:17 Page:309  
XUG_OWNS_MEMORY
     15838**DCL     15938<<ASSIGN  15983<<ASSIGN  15989>>ASSIGN  16000>>IF
XUH_PARAM_C
     15469**DCL     16053>>ASSIGN
XUP$DMPCORRECTED
     13417**DCL-ENT 17530--CALL
XUP_SYMTBL
      4627**DCL      4627--REDEF
XUS$CORRECT_SPELLING
     13418**DCL-ENT 16068--IF      17422--CALL

PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:310  
     1840        1        /*T***********************************************************/
     1841        2        /*T*                                                         */
     1842        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1843        4        /*T*                                                         */
     1844        5        /*T***********************************************************/
     1845        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     1846        7        XUG$ADAPTMEM: PROC (XT_PARAM) ALTRET;
     1847        8        /*D*  NAME: XUG$ADAPTMEM
     1848        9              DESCRIPTION: Called from within ADAPT to request expansion of
     1849       10                    ADAPT's workspace, which lives at the high end of the GETCMD
     1850       11                    data area.
     1851       12        */
     1852       13
     1853       14        %INCLUDE CP_6;
     1854     5573        %INCLUDE XU_MACRO_C;
     1855     8679        %INCLUDE XUH_MACRO_C;
     1856     8763        %INCLUDE XT_MACRO_M;
     1857     9089
     1858     9090        %XT_PARAM (NAME=XT_PARAM, STCLASS=PARAM);
     1859     9403
     1860     9404        %B$TCB (STCLASS="BASED(B$TCB$)");
     1861     9407        %B$ALT;
     1862     9415        %FPT_GDS (FPTN=FPT_GDS, STCLASS=AUTO);
     1863     9431        %FPT_GDS (FPTN=FPT_GDS_C, STCLASS=CONSTANT);
     1864     9447        %XUG_PARAMS;
     1865     9891
     1866     9892    1   DCL B$TCB$ PTR SYMREF READONLY;
     1867     9893
     1868     9894    1   DCL XUG$ PTR;
     1869     9895    1   DCL DUMMY$ PTR;
     1870     9896    1   DCL TEMP SBIN;
     1871     9897    1   DCL TEMP_ERR BIT (36);
     1872     9898    1   DCL TOP$ PTR;
     1873     9899    1   DCL USER_GDSVEC VECTOR;
     1874     9900
     1875     9901        %VLP_ERRCODE (FPTN=XUG#CANTEXPAND, STCLASS=SYMREF);
     1876     9946        %VLP_ERRCODE (FPTN=XUG#NOTCONTIGAREA, STCLASS=SYMREF);
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:311  
     1877     9991        %VLP_ERRCODE (FPTN=XUG#AREANOTRTSZ, STCLASS=SYMREF);
     1878    10036
     1879    10037    1       XUG$ = XT_PARAM.XUG$;
     1880    10038    1       TOP$ = PINCRW(VBASE(XUG.GDSVEC), (VBOUND(XUG.GDSVEC)+3)/4);
     1881    10039
     1882    10040    1       IF XUG.XUG_OWNS_MEMORY
     1883    10041    2       THEN DO ;
     1884    10042    2           FPT_GDS = FPT_GDS_C ;
     1885    10043    2           FPT_GDS.V_ = VECTOR(FPT_GDS.V) ;
     1886    10044    2           FPT_GDS.RESULTS_ = VECTOR(XUG.GDSVEC);
     1887    10045    2           IF XT_PARAM.WS_NEEDED > 0
     1888    10046    3           THEN DO;
     1889    10047    3               FPT_GDS.V.SEGSIZE# = XT_PARAM.WS_NEEDED;
     1890    10048    3               CALL M$GDS (FPT_GDS) ALTRET(GDS_ALT);
     1891    10049    3           END;
     1892    10050    3           ELSE DO;
     1893    10051    3               FPT_GDS.V.SEGSIZE# = - XT_PARAM.WS_NEEDED;
     1894    10052    3               CALL M$FDS (FPT_GDS) ALTRET(GDS_ALT);
     1895    10053    3           END;
     1896    10054    2           IF XT_PARAM.WS$ = ADDR(NIL)
     1897    10055    2           THEN
     1898    10056    2               XT_PARAM.WS$ = TOP$;
     1899    10057    2           XT_PARAM.WS_SIZE = XT_PARAM.WS_SIZE + XT_PARAM.WS_NEEDED;
     1900    10058    2           RETURN;
     1901    10059    2       END;
     1902    10060
     1903    10061    1       IF XUG.MOREMEM = ENTADDR(NIL)
     1904    10062    2       THEN DO;
     1905    10063    2           XT_PARAM.ERR = XUG#CANTEXPAND;
     1906    10064    2           ALTRETURN;
     1907    10065    2       END;
     1908    10066
     1909    10067    1       TEMP = XT_PARAM.WS_NEEDED;
     1910    10068
     1911    10069    1       CALL XUG.MOREMEM(TEMP, USER_GDSVEC, TEMP_ERR)
     1912    10070    2       WHENALTRETURN DO ;
     1913    10071    2           XT_PARAM.ERR = TEMP_ERR ;
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:312  
     1914    10072    2           ALTRETURN;
     1915    10073    2       END;
     1916    10074
     1917    10075    1       IF XT_PARAM.WS_NEEDED <= 0
     1918    10076    2       THEN DO;
     1919    10077    2           VBOUND(XUG.GDSVEC) = VBOUND(XUG.GDSVEC) + ( XT_PARAM.WS_NEEDED * 4 );
     1920    10078    2           XT_PARAM.WS_SIZE = XT_PARAM.WS_SIZE + XT_PARAM.WS_NEEDED ;
     1921    10079    2           RETURN ;
     1922    10080    2       END;
     1923    10081
     1924    10082    1       IF TOP$ ~= VBASE(USER_GDSVEC)
     1925    10083    2       THEN DO;
     1926    10084    2           XT_PARAM.ERR = XUG#NOTCONTIGAREA ;
     1927    10085    2           ALTRETURN;
     1928    10086    2       END;
     1929    10087
     1930    10088    1       IF VBOUND(USER_GDSVEC)+1 < XT_PARAM.WS_NEEDED * 4
     1931    10089    2       THEN DO;
     1932    10090    2           XT_PARAM.ERR = XUG#AREANOTRTSZ ;
     1933    10091    2           ALTRETURN;
     1934    10092    2       END;
     1935    10093
     1936    10094    1       VBOUND(XUG.GDSVEC) = VBOUND(XUG.GDSVEC) + VBOUND(USER_GDSVEC) + 1;
     1937    10095    1       XT_PARAM.WS_SIZE = XT_PARAM.WS_SIZE + VBOUND(USER_GDSVEC)/4 + 1;
     1938    10096
     1939    10097    1       IF XT_PARAM.WS$ = ADDR(NIL)
     1940    10098    1       THEN
     1941    10099    1           XT_PARAM.WS$ = TOP$;
     1942    10100
     1943    10101    1       RETURN;
     1944    10102
     1945    10103    1   GDS_ALT: ;
     1946    10104    1       IF XT_PARAM.ERR = '0'B
     1947    10105    1       THEN
     1948    10106    1           XT_PARAM.ERR = B$TCB.ALT$ -> B$ALT.ERR ;
     1949    10107    1       ALTRETURN ;
     1950    10108
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:313  
     1951    10109    1   END XUG$ADAPTMEM;
     1952    10110        %EOD;

PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:314  
--  Include file information  --

   XT_MACRO_M.:TOOLE04  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$ADAPTMEM.

   Procedure XUG$ADAPTMEM requires 146 words for executable code.
   Procedure XUG$ADAPTMEM requires 22 words of local(AUTO) storage.

PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:315  

 Object Unit name= XUG$ADAPTMEM                               File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:20:21.48 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      6      6  XUG$ADAPTMEM
    2   Proc  even  none   146    222  XUG$ADAPTMEM
    3  RoData even  none     1      1  XUG$ADAPTMEM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  XUG$ADAPTMEM

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    B$TCB$                                XUG#CANTEXPAND
     XUG#NOTCONTIGAREA                     XUG#AREANOTRTSZ                       B_VECTNIL
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:316  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:317  


     1840        1        /*T***********************************************************/
     1841        2        /*T*                                                         */
     1842        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1843        4        /*T*                                                         */
     1844        5        /*T***********************************************************/
     1845        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     1846        7        XUG$ADAPTMEM: PROC (XT_PARAM) ALTRET;

      7  2 000000   000000 700200 xent  XUG$ADAPTMEM TSX0  ! X66_AUTO_1
         2 000001   000026 000001                    ZERO    22,1

     1847        8        /*D*  NAME: XUG$ADAPTMEM
     1848        9              DESCRIPTION: Called from within ADAPT to request expansion of
     1849       10                    ADAPT's workspace, which lives at the high end of the GETCMD
     1850       11                    data area.
     1851       12        */
     1852       13
     1853       14        %INCLUDE CP_6;
     1854     5573        %INCLUDE XU_MACRO_C;
     1855     8679        %INCLUDE XUH_MACRO_C;
     1856     8763        %INCLUDE XT_MACRO_M;
     1857     9089
     1858     9090        %XT_PARAM (NAME=XT_PARAM, STCLASS=PARAM);
     1859     9403
     1860     9404        %B$TCB (STCLASS="BASED(B$TCB$)");
     1861     9407        %B$ALT;
     1862     9415        %FPT_GDS (FPTN=FPT_GDS, STCLASS=AUTO);
     1863     9431        %FPT_GDS (FPTN=FPT_GDS_C, STCLASS=CONSTANT);
     1864     9447        %XUG_PARAMS;
     1865     9891
     1866     9892    1   DCL B$TCB$ PTR SYMREF READONLY;
     1867     9893
     1868     9894    1   DCL XUG$ PTR;
     1869     9895    1   DCL DUMMY$ PTR;
     1870     9896    1   DCL TEMP SBIN;
     1871     9897    1   DCL TEMP_ERR BIT (36);
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:318  
     1872     9898    1   DCL TOP$ PTR;
     1873     9899    1   DCL USER_GDSVEC VECTOR;
     1874     9900
     1875     9901        %VLP_ERRCODE (FPTN=XUG#CANTEXPAND, STCLASS=SYMREF);
     1876     9946        %VLP_ERRCODE (FPTN=XUG#NOTCONTIGAREA, STCLASS=SYMREF);
     1877     9991        %VLP_ERRCODE (FPTN=XUG#AREANOTRTSZ, STCLASS=SYMREF);
     1878    10036
     1879    10037    1       XUG$ = XT_PARAM.XUG$;

  10037  2 000002   200003 470500                    LDP0    @XT_PARAM,,AUTO
         2 000003   000015 236100                    LDQ     13,,PR0
         2 000004   200012 756100                    STQ     XUG$,,AUTO

     1880    10038    1       TOP$ = PINCRW(VBASE(XUG.GDSVEC), (VBOUND(XUG.GDSVEC)+3)/4);

  10038  2 000005   200012 471500                    LDP1    XUG$,,AUTO
         2 000006   100006 236100                    LDQ     6,,PR1
         2 000007   000020 772000                    QRL     16
         2 000010   000003 036007                    ADLQ    3,DL
         2 000011   000002 772000                    QRL     2
         2 000012   100007 473500                    LDP3    7,,PR1
         2 000013   300000 634506                    EPPR4   0,QL,PR3
         2 000014   200016 454500                    STP4    TOP$,,AUTO

     1881    10039
     1882    10040    1       IF XUG.XUG_OWNS_MEMORY

  10040  2 000015   100071 236100                    LDQ     57,,PR1
         2 000016   000200 316003                    CANQ    128,DU
         2 000017   000067 600000 2                  TZE     s:10061

     1883    10041    2       THEN DO ;

     1884    10042    2           FPT_GDS = FPT_GDS_C ;

  10042  2 000020   000100 100400                    MLR     fill='000'O
         2 000021   000000 000030 1                  ADSC9   FPT_GDS_C                cn=0,n=24
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:319  
         2 000022   200004 000030                    ADSC9   FPT_GDS,,AUTO            cn=0,n=24

     1885    10043    2           FPT_GDS.V_ = VECTOR(FPT_GDS.V) ;

  10043  2 000023   000000 235000 3                  LDA     0
         2 000024   200022 452500                    STP2    USER_GDSVEC+2,,AUTO
         2 000025   200022 236100                    LDQ     USER_GDSVEC+2,,AUTO
         2 000026   000010 036003                    ADLQ    8,DU
         2 000027   200004 757100                    STAQ    FPT_GDS,,AUTO

     1886    10044    2           FPT_GDS.RESULTS_ = VECTOR(XUG.GDSVEC);

  10044  2 000030   000000 235000 3                  LDA     0
         2 000031   200012 236100                    LDQ     XUG$,,AUTO
         2 000032   000006 036003                    ADLQ    6,DU
         2 000033   200006 757100                    STAQ    FPT_GDS+2,,AUTO

     1887    10045    2           IF XT_PARAM.WS_NEEDED > 0

  10045  2 000034   000021 235100                    LDA     17,,PR0
         2 000035   000045 604400 2                  TMOZ    s:10051

     1888    10046    3           THEN DO;

     1889    10047    3               FPT_GDS.V.SEGSIZE# = XT_PARAM.WS_NEEDED;

  10047  2 000036   000021 720100                    LXL0    17,,PR0
         2 000037   200010 440100                    SXL0    FPT_GDS+4,,AUTO

     1890    10048    3               CALL M$GDS (FPT_GDS) ALTRET(GDS_ALT);

  10048  2 000040   200004 630500                    EPPR0   FPT_GDS,,AUTO
         2 000041   430001 713400                    CLIMB   alt,gds
         2 000042   400400 401760                    pmme    nvectors=2
         2 000043   000212 702000 2                  TSX2    GDS_ALT

     1891    10049    3           END;
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:320  

  10049  2 000044   000055 710000 2                  TRA     s:10054

     1892    10050    3           ELSE DO;

     1893    10051    3               FPT_GDS.V.SEGSIZE# = - XT_PARAM.WS_NEEDED;

  10051  2 000045   000021 720100                    LXL0    17,,PR0
         2 000046   777777 620010                    EAX0    -1,X0
         2 000047   777777 660003                    ERX0    -1,DU
         2 000050   200010 440100                    SXL0    FPT_GDS+4,,AUTO

     1894    10052    3               CALL M$FDS (FPT_GDS) ALTRET(GDS_ALT);

  10052  2 000051   200004 630500                    EPPR0   FPT_GDS,,AUTO
         2 000052   430002 713400                    CLIMB   alt,fds
         2 000053   400400 401760                    pmme    nvectors=2
         2 000054   000212 702000 2                  TSX2    GDS_ALT

     1895    10053    3           END;

     1896    10054    2           IF XT_PARAM.WS$ = ADDR(NIL)

  10054  2 000055   200003 470500                    LDP0    @XT_PARAM,,AUTO
         2 000056   000000 236100                    LDQ     0,,PR0
         2 000057   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000060   000063 601000 2                  TNZ     s:10057

     1897    10055    2           THEN
     1898    10056    2               XT_PARAM.WS$ = TOP$;

  10056  2 000061   200016 236100                    LDQ     TOP$,,AUTO
         2 000062   000000 756100                    STQ     0,,PR0

     1899    10057    2           XT_PARAM.WS_SIZE = XT_PARAM.WS_SIZE + XT_PARAM.WS_NEEDED;

  10057  2 000063   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:321  
         2 000064   000021 036100                    ADLQ    17,,PR0
         2 000065   000002 756100                    STQ     2,,PR0

     1900    10058    2           RETURN;

  10058  2 000066   000000 702200 xent               TSX2  ! X66_ARET

     1901    10059    2       END;
     1902    10060
     1903    10061    1       IF XUG.MOREMEM = ENTADDR(NIL)

  10061  2 000067   100030 236100                    LDQ     24,,PR1
         2 000070   000002 116000 xsym               CMPQ    B_VECTNIL+2
         2 000071   000075 601000 2                  TNZ     s:10067

     1904    10062    2       THEN DO;

     1905    10063    2           XT_PARAM.ERR = XUG#CANTEXPAND;

  10063  2 000072   000000 236000 xsym               LDQ     XUG#CANTEXPAND
         2 000073   000001 756100                    STQ     1,,PR0

     1906    10064    2           ALTRETURN;

  10064  2 000074   000000 702200 xent               TSX2  ! X66_AALT

     1907    10065    2       END;
     1908    10066
     1909    10067    1       TEMP = XT_PARAM.WS_NEEDED;

  10067  2 000075   000021 235100                    LDA     17,,PR0
         2 000076   200014 755100                    STA     TEMP,,AUTO

     1910    10068
     1911    10069    1       CALL XUG.MOREMEM(TEMP, USER_GDSVEC, TEMP_ERR)

  10069  2 000077   200015 633500                    EPPR3   TEMP_ERR,,AUTO
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:322  
         2 000100   200024 453500                    STP3    USER_GDSVEC+4,,AUTO
         2 000101   200020 635500                    EPPR5   USER_GDSVEC,,AUTO
         2 000102   200023 455500                    STP5    USER_GDSVEC+3,,AUTO
         2 000103   200014 636500                    EPPR6   TEMP,,AUTO
         2 000104   200022 456500                    STP6    USER_GDSVEC+2,,AUTO
         2 000105   200022 630500                    EPPR0   USER_GDSVEC+2,,AUTO
         2 000106   100030 220100                    LDX0    24,,PR1
         2 000107   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000110   000000 701010                    TSX1    0,X0
         2 000111   000113 702000 2                  TSX2    s:10071
         2 000112   000117 710000 2                  TRA     s:10075

     1912    10070    2       WHENALTRETURN DO ;

     1913    10071    2           XT_PARAM.ERR = TEMP_ERR ;

  10071  2 000113   200015 236100                    LDQ     TEMP_ERR,,AUTO
         2 000114   200003 470500                    LDP0    @XT_PARAM,,AUTO
         2 000115   000001 756100                    STQ     1,,PR0

     1914    10072    2           ALTRETURN;

  10072  2 000116   000000 702200 xent               TSX2  ! X66_AALT

     1915    10073    2       END;
     1916    10074
     1917    10075    1       IF XT_PARAM.WS_NEEDED <= 0

  10075  2 000117   200003 470500                    LDP0    @XT_PARAM,,AUTO
         2 000120   000021 235100                    LDA     17,,PR0
         2 000121   000141 605400 2                  TPNZ    s:10082

     1918    10076    2       THEN DO;

     1919    10077    2           VBOUND(XUG.GDSVEC) = VBOUND(XUG.GDSVEC) + ( XT_PARAM.WS_NEEDED * 4 );

  10077  2 000122   200012 471500                    LDP1    XUG$,,AUTO
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:323  
         2 000123   100006 236100                    LDQ     6,,PR1
         2 000124   000020 772000                    QRL     16
         2 000125   200022 756100                    STQ     USER_GDSVEC+2,,AUTO
         2 000126   000021 236100                    LDQ     17,,PR0
         2 000127   000002 736000                    QLS     2
         2 000130   200022 036100                    ADLQ    USER_GDSVEC+2,,AUTO
         2 000131   000020 736000                    QLS     16
         2 000132   100006 676100                    ERQ     6,,PR1
         2 000133   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000134   100006 656100                    ERSQ    6,,PR1

     1920    10078    2           XT_PARAM.WS_SIZE = XT_PARAM.WS_SIZE + XT_PARAM.WS_NEEDED ;

  10078  2 000135   000002 236100                    LDQ     2,,PR0
         2 000136   000021 036100                    ADLQ    17,,PR0
         2 000137   000002 756100                    STQ     2,,PR0

     1921    10079    2           RETURN ;

  10079  2 000140   000000 702200 xent               TSX2  ! X66_ARET

     1922    10080    2       END;
     1923    10081
     1924    10082    1       IF TOP$ ~= VBASE(USER_GDSVEC)

  10082  2 000141   200016 236100                    LDQ     TOP$,,AUTO
         2 000142   200021 116100                    CMPQ    USER_GDSVEC+1,,AUTO
         2 000143   000147 600000 2                  TZE     s:10088

     1925    10083    2       THEN DO;

     1926    10084    2           XT_PARAM.ERR = XUG#NOTCONTIGAREA ;

  10084  2 000144   000000 236000 xsym               LDQ     XUG#NOTCONTIGAREA
         2 000145   000001 756100                    STQ     1,,PR0

     1927    10085    2           ALTRETURN;
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:324  

  10085  2 000146   000000 702200 xent               TSX2  ! X66_AALT

     1928    10086    2       END;
     1929    10087
     1930    10088    1       IF VBOUND(USER_GDSVEC)+1 < XT_PARAM.WS_NEEDED * 4

  10088  2 000147   000021 235100                    LDA     17,,PR0
         2 000150   000002 735000                    ALS     2
         2 000151   200022 755100                    STA     USER_GDSVEC+2,,AUTO
         2 000152   200020 236100                    LDQ     USER_GDSVEC,,AUTO
         2 000153   000020 772000                    QRL     16
         2 000154   000001 036007                    ADLQ    1,DL
         2 000155   200022 116100                    CMPQ    USER_GDSVEC+2,,AUTO
         2 000156   000162 605000 2                  TPL     s:10094

     1931    10089    2       THEN DO;

     1932    10090    2           XT_PARAM.ERR = XUG#AREANOTRTSZ ;

  10090  2 000157   000000 236000 xsym               LDQ     XUG#AREANOTRTSZ
         2 000160   000001 756100                    STQ     1,,PR0

     1933    10091    2           ALTRETURN;

  10091  2 000161   000000 702200 xent               TSX2  ! X66_AALT

     1934    10092    2       END;
     1935    10093
     1936    10094    1       VBOUND(XUG.GDSVEC) = VBOUND(XUG.GDSVEC) + VBOUND(USER_GDSVEC) + 1;

  10094  2 000162   200020 236100                    LDQ     USER_GDSVEC,,AUTO
         2 000163   000020 772000                    QRL     16
         2 000164   200022 756100                    STQ     USER_GDSVEC+2,,AUTO
         2 000165   200012 471500                    LDP1    XUG$,,AUTO
         2 000166   100006 236100                    LDQ     6,,PR1
         2 000167   000020 772000                    QRL     16
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:325  
         2 000170   200022 036100                    ADLQ    USER_GDSVEC+2,,AUTO
         2 000171   000001 036007                    ADLQ    1,DL
         2 000172   000020 736000                    QLS     16
         2 000173   100006 676100                    ERQ     6,,PR1
         2 000174   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000175   100006 656100                    ERSQ    6,,PR1

     1937    10095    1       XT_PARAM.WS_SIZE = XT_PARAM.WS_SIZE + VBOUND(USER_GDSVEC)/4 + 1;

  10095  2 000176   200020 236100                    LDQ     USER_GDSVEC,,AUTO
         2 000177   000020 772000                    QRL     16
         2 000200   000002 772000                    QRL     2
         2 000201   000002 036100                    ADLQ    2,,PR0
         2 000202   000001 036007                    ADLQ    1,DL
         2 000203   000002 756100                    STQ     2,,PR0

     1938    10096
     1939    10097    1       IF XT_PARAM.WS$ = ADDR(NIL)

  10097  2 000204   000000 236100                    LDQ     0,,PR0
         2 000205   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000206   000211 601000 2                  TNZ     s:10101

     1940    10098    1       THEN
     1941    10099    1           XT_PARAM.WS$ = TOP$;

  10099  2 000207   200016 236100                    LDQ     TOP$,,AUTO
         2 000210   000000 756100                    STQ     0,,PR0

     1942    10100
     1943    10101    1       RETURN;

  10101  2 000211   000000 702200 xent               TSX2  ! X66_ARET

  10097  2 000212                       GDS_ALT      null
     1944    10102
     1945    10103    1   GDS_ALT: ;
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:326  
     1946    10104    1       IF XT_PARAM.ERR = '0'B

  10104  2 000212   200003 470500                    LDP0    @XT_PARAM,,AUTO
         2 000213   000001 235100                    LDA     1,,PR0
         2 000214   000221 601000 2                  TNZ     s:10107

     1947    10105    1       THEN
     1948    10106    1           XT_PARAM.ERR = B$TCB.ALT$ -> B$ALT.ERR ;

  10106  2 000215   000000 471400 xsym               LDP1    B$TCB$
         2 000216   100000 473500                    LDP3    0,,PR1
         2 000217   300102 236100                    LDQ     66,,PR3
         2 000220   000001 756100                    STQ     1,,PR0

     1949    10107    1       ALTRETURN ;

  10107  2 000221   000000 702200 xent               TSX2  ! X66_AALT
     1950    10108
     1951    10109    1   END XUG$ADAPTMEM;
     1952    10110        %EOD;

PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:327  
--  Include file information  --

   XT_MACRO_M.:TOOLE04  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$ADAPTMEM.
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:328  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$ADAPTMEM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(216)   r     1 FPT_GDS_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @XT_PARAM                  4-0-0/d STRC(216)   r     1 FPT_GDS
    14-0-0/w SBIN        r     1 TEMP                      15-0-0/b BIT         r     1 TEMP_ERR
    16-0-0/w PTR         r     1 TOP$                      20-0-0/d VECT        r     1 USER_GDSVEC
    *0-0-0/w STRC(1152)  r     1 XT_PARAM                  12-0-0/w PTR         r     1 XUG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC        r     1 XUG#AREANOTRTSZ
     0-0-0/w STRC        r     1 XUG#CANTEXPAND             0-0-0/w STRC        r     1 XUG#NOTCONTIGAREA

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d STRC(9612)  r     1 XUG

PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:329  

   Procedure XUG$ADAPTMEM requires 146 words for executable code.
   Procedure XUG$ADAPTMEM requires 22 words of local(AUTO) storage.
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:330  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:331  
          MINI XREF LISTING

B$ALT.CODE
      9409**DCL      9409--REDEF    9410--REDEF    9410--REDEF
B$ALT.ERR
      9410**DCL     10106>>ASSIGN
B$ALT.ERR.ERR#
      9411**DCL      9411--REDEF
B$ALT.EVID
      9410**DCL      9410--REDEF    9410--REDEF
B$TCB.ALT$
      9405**DCL     10106>>ASSIGN
B$TCB$
      9892**DCL      9405--IMP-PTR 10106>>ASSIGN
FPT_GDS
      9426**DCL     10042<<ASSIGN  10048<>CALL    10052<>CALL
FPT_GDS.RESULTS_
      9426**DCL     10044<<ASSIGN
FPT_GDS.V
      9426**DCL     10043--ASSIGN
FPT_GDS.V.SEGSIZE#
      9429**DCL     10047<<ASSIGN  10051<<ASSIGN
FPT_GDS.V_
      9426**DCL     10043<<ASSIGN
FPT_GDS_C
      9442**DCL     10042>>ASSIGN
FPT_GDS_C.V
      9442**DCL      9442--DCLINIT
GDS_ALT
     10097**LABEL   10048--CALLALT 10052--CALLALT
M$FDS
      5536**DCL-ENT 10052--CALL
M$GDS
      5536**DCL-ENT 10048--CALL
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:332  
TEMP
      9896**DCL     10067<<ASSIGN  10069<>CALL
TEMP_ERR
      9897**DCL     10069<>CALL    10071>>ASSIGN
TOP$
      9898**DCL     10038<<ASSIGN  10056>>ASSIGN  10082>>IF      10099>>ASSIGN
USER_GDSVEC
      9899**DCL     10069<>CALL    10082>>IF      10088>>IF      10094>>ASSIGN  10095>>ASSIGN
XT_PARAM
      9103**DCL         7--PROC
XT_PARAM.ERR
      9127**DCL     10063<<ASSIGN  10071<<ASSIGN  10084<<ASSIGN  10090<<ASSIGN  10104>>IF      10106<<ASSIGN
XT_PARAM.WS$
      9104**DCL     10054>>IF      10056<<ASSIGN  10097>>IF      10099<<ASSIGN
XT_PARAM.WS_NEEDED
      9313**DCL     10045>>IF      10047>>ASSIGN  10051>>ASSIGN  10057>>ASSIGN  10067>>ASSIGN  10075>>IF
     10077>>ASSIGN  10078>>ASSIGN  10088>>IF
XT_PARAM.WS_SIZE
      9138**DCL     10057<<ASSIGN  10057>>ASSIGN  10078<<ASSIGN  10078>>ASSIGN  10095<<ASSIGN  10095>>ASSIGN
XT_PARAM.XUG$
      9263**DCL     10037>>ASSIGN
XUG.BUF
      9886**DCL      9889--REDEF
XUG.GDSVEC
      9461**DCL     10038>>ASSIGN  10038>>ASSIGN  10044--ASSIGN  10077<<ASSIGN  10077>>ASSIGN  10094<<ASSIGN
     10094>>ASSIGN
XUG.MOREMEM
      9507**DCL     10061>>IF      10069>>CALL
XUG.XUG_OWNS_MEMORY
      9587**DCL     10040>>IF
XUG#AREANOTRTSZ
     10003**DCL     10090>>ASSIGN
XUG#CANTEXPAND
      9913**DCL     10063>>ASSIGN
XUG#NOTCONTIGAREA
      9958**DCL     10084>>ASSIGN
PL6.E3A0      #002=XUG$ADAPTMEM File=XUG$COMMON.:E05TSI                          WED 07/30/97 09:20 Page:333  
XUG$
      9894**DCL      9450--IMP-PTR 10037<<ASSIGN  10038>>ASSIGN  10038>>ASSIGN  10040>>IF      10044>>ASSIGN
     10061>>IF      10069>>CALL    10077>>ASSIGN  10077>>ASSIGN  10094>>ASSIGN  10094>>ASSIGN

PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:334  
     1953        1        /*T***********************************************************/
     1954        2        /*T*                                                         */
     1955        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1956        4        /*T*                                                         */
     1957        5        /*T***********************************************************/
     1958        6        XUG$PU: PROC(PARSE_PARAM) ALTRET ;
     1959        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     1960        8        %INCLUDE XU_MACRO_C;
     1961     3114        %INCLUDE XUH_MACRO_C ;
     1962     3198        %INCLUDE CP_6_SUBS;
     1963     3738        %PARSE$PARAM (NAME=PARSE_PARAM);
     1964     3819        %P_PCB (STCLASS=BASED) ;
     1965     4018        %INCLUDE XU_SUBS_C;
     1966     4110    1   DCL XUG$GETMORE_COMMON ENTRY(1) ALTRET;
     1967     4111    1   DCL XUG$MOREMEM ENTRY(1) ALTRET;
     1968     4112    1   DCL XUG$SETPROMPT ENTRY(1) ALTRET ;
     1969     4113        /*
     1970     4114        */
     1971     4115    1   DCL XUG$ PTR;
     1972     4116    1   DCL GETCMD$ PTR ;
     1973     4117        %EQU EXPND_PARSEWK = 800 ;
     1974     4118
     1975     4119    1   DCL CHR$ PTR ;
     1976     4120    1   DCL CHR CHAR( 1 ) BASED( CHR$ );
     1977     4121
     1978     4122        %XUG_PARAMS;
     1979     4566        %XUG_GETCMD (NAME=GET$CMD, STCLASS="BASED(GETCMD$)") ;
     1980     4904    1   DCL XUG_BUILTIN_N BIT (36) SYMREF READONLY;
     1981     4905        /**/
     1982     4906    1       GETCMD$ = PARSE_PARAM.USER$ ;
     1983     4907    1       XUG$ = GET$CMD.WORK$ ;
     1984     4908    2       DO CASE (PARSE_PARAM.TYPE);
     1985     4909    2       CASE (%INPUT#);
     1986     4910    2           IF NOT GET$CMD.CONTINUE_OK#
     1987     4911    2           THEN
     1988     4912    3           DO ;
     1989     4913    3               GET$CMD.CONTINUED# = '1'B ;
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:335  
     1990     4914    3               RETURN ;
     1991     4915    3           END ;                     /* Then Do */
     1992     4916    2           IF XUG.SPHANDLE ~= ENTADDR(NIL)
     1993     4917    2           THEN
     1994     4918    3           DO ;
     1995     4919    3               PARSE_PARAM.USER$ = XUG.USER$ ;
     1996     4920    3               CALL XUG.SPHANDLE(GET$CMD,PARSE_PARAM) ;
     1997     4921    3               CALL XUG$SETPROMPT(GET$CMD) ;
     1998     4922    3           END ;                     /* Then Do */
     1999     4923    2           XUG.CPOS = PARSE_PARAM.CHARPOS ;
     2000     4924    2           CALL XUG$GETMORE_COMMON (GET$CMD) ;
     2001     4925    2       CASE (%SPACE#);
     2002     4926    2           CALL XUG$MOREMEM(GET$CMD) WHENALTRETURN
     2003     4927    3           DO ;
     2004     4928    3               ALTRETURN ;
     2005     4929    3           END ;                  /* Whenaltreturn Do */
     2006     4930    2           PARSE_PARAM.WKSZ = PARSE_PARAM.WKSZ + %EXPND_PARSEWK/4 ;
     2007     4931    2           PARSE_PARAM.PCB$->P_PCB.TEXT$ = VBASE(XUG.BUFVEC) ;
     2008     4932    2       CASE (%SUCC#, %FAIL#);
     2009     4933    2           IF XUG.PARSING_FREE_CMDS
     2010     4934    3           THEN DO;
     2011     4935    3               IF PARSE_PARAM.CODE = %XUG_HELP_KWD
     2012     4936    3                 AND PARSE_PARAM.CHARPOS < PARSE_PARAM.PCB$->P_PCB.NCHARS
     2013     4937    4               THEN DO;
     2014     4938    4                   CHR$ = PINCRC(PARSE_PARAM.PCB$->P_PCB.TEXT$,PARSE_PARAM.CHARPOS);
     2015     4939    4                   IF CHR ~= ' ' AND CHR ~= '('
     2016     4940    4                   THEN
     2017     4941    4                       PARSE_PARAM.REJECT = %YES# ;
     2018     4942    4               END;
     2019     4943    3           END;
     2020     4944    2           ELSE IF XUG.SFROUTINE~=ENTADDR(NIL)
     2021     4945    3               THEN DO;
     2022     4946    3                   PARSE_PARAM.USER$ = XUG.USER$ ;
     2023     4947    3                   CALL XUG.SFROUTINE(PARSE_PARAM);
     2024     4948    3               END ;
     2025     4949    2       CASE (%PRE#);
     2026     4950    2           IF PARSE_PARAM.NODE$ = ADDR(XUG_BUILTIN_N)
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:336  
     2027     4951    2           THEN
     2028     4952    2               XUG.PARSING_FREE_CMDS = %YES#;
     2029     4953    2           ELSE
     2030     4954    2               IF XUG.PARSING_FREE_CMDS
     2031     4955    3               THEN DO;
     2032     4956    4                   DO CASE (PARSE_PARAM.CODE);
     2033     4957    4                   CASE (%XUG_CMD_DIR);
     2034     4958    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.DIRECTORY#;
     2035     4959    4                   CASE (%XUG_CMD_DO);
     2036     4960    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.DO#;
     2037     4961    4                   CASE (%XUG_CMD_END);
     2038     4962    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.END#;
     2039     4963    4                   CASE (%XUG_CMD_ERASE);
     2040     4964    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.ERASE#;
     2041     4965    4                   CASE (%XUG_CMD_HELP);
     2042     4966    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.HELP#;
     2043     4967    4                   CASE (%XUG_CMD_NULL);
     2044     4968    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.NULL#;
     2045     4969    4                   CASE (%XUG_CMD_OUTPUT);
     2046     4970    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.OUTPUT#;
     2047     4971    4                   CASE (%XUG_CMD_PRINT);
     2048     4972    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.PRINT#;
     2049     4973    4                   CASE (%XUG_CMD_Q1,%XUG_CMD_Q2);
     2050     4974    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.QMARK#;
     2051     4975    4                   CASE (%XUG_CMD_TIME);
     2052     4976    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.DATE#;
     2053     4977    4                   CASE (%XUG_CMD_ENTER);
     2054     4978    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.ENTER# |
     2055     4979    4                         ( XUG.ADAPT$$ = ENTADDR(NIL) );
     2056     4980    4                   END;
     2057     4981    3               END;
     2058     4982    2               ELSE
     2059     4983    2                   IF XUG.SFROUTINE ~= ENTADDR(NIL)
     2060     4984    3                   THEN DO;
     2061     4985    3                       PARSE_PARAM.USER$ = XUG.USER$;
     2062     4986    3                       CALL XUG.SFROUTINE (PARSE_PARAM);
     2063     4987    3                   END;
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:337  
     2064     4988    2       END;
     2065     4989    1       RETURN;
     2066     4990    1   END XUG$PU;
     2067     4991        %EOD;

PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:338  
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$PU.

   Procedure XUG$PU requires 222 words for executable code.
   Procedure XUG$PU requires 10 words of local(AUTO) storage.

PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:339  

 Object Unit name= XUG$PU                                     File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:21:01.96 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   222    336  XUG$PU
    1  RoData even  none     2      2  XUG$PU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        1  XUG$PU

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XUG$SETPROMPT
 yes     yes           Std       1 XUG$GETMORE_COMMON
 yes     yes           Std       1 XUG$MOREMEM
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    XUG_BUILTIN_N                         B_VECTNIL
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:340  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:341  


     1953        1        /*T***********************************************************/
     1954        2        /*T*                                                         */
     1955        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1956        4        /*T*                                                         */
     1957        5        /*T***********************************************************/
     1958        6        XUG$PU: PROC(PARSE_PARAM) ALTRET ;

      6  0 000000   000000 700200 xent  XUG$PU       TSX0  ! X66_AUTO_1
         0 000001   000012 000001                    ZERO    10,1

     1959        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     1960        8        %INCLUDE XU_MACRO_C;
     1961     3114        %INCLUDE XUH_MACRO_C ;
     1962     3198        %INCLUDE CP_6_SUBS;
     1963     3738        %PARSE$PARAM (NAME=PARSE_PARAM);
     1964     3819        %P_PCB (STCLASS=BASED) ;
     1965     4018        %INCLUDE XU_SUBS_C;
     1966     4110    1   DCL XUG$GETMORE_COMMON ENTRY(1) ALTRET;
     1967     4111    1   DCL XUG$MOREMEM ENTRY(1) ALTRET;
     1968     4112    1   DCL XUG$SETPROMPT ENTRY(1) ALTRET ;
     1969     4113        /*
     1970     4114        */
     1971     4115    1   DCL XUG$ PTR;
     1972     4116    1   DCL GETCMD$ PTR ;
     1973     4117        %EQU EXPND_PARSEWK = 800 ;
     1974     4118
     1975     4119    1   DCL CHR$ PTR ;
     1976     4120    1   DCL CHR CHAR( 1 ) BASED( CHR$ );
     1977     4121
     1978     4122        %XUG_PARAMS;
     1979     4566        %XUG_GETCMD (NAME=GET$CMD, STCLASS="BASED(GETCMD$)") ;
     1980     4904    1   DCL XUG_BUILTIN_N BIT (36) SYMREF READONLY;
     1981     4905        /**/
     1982     4906    1       GETCMD$ = PARSE_PARAM.USER$ ;

   4906  0 000002   200003 470500                    LDP0    @PARSE_PARAM,,AUTO
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:342  
         0 000003   000006 236100                    LDQ     6,,PR0
         0 000004   200005 756100                    STQ     GETCMD$,,AUTO

     1983     4907    1       XUG$ = GET$CMD.WORK$ ;

   4907  0 000005   200005 471500                    LDP1    GETCMD$,,AUTO
         0 000006   100004 236100                    LDQ     4,,PR1
         0 000007   200004 756100                    STQ     XUG$,,AUTO

     1984     4908    2       DO CASE (PARSE_PARAM.TYPE);

   4908  0 000010   000000 236100                    LDQ     0,,PR0
         0 000011   000033 772000                    QRL     27
         0 000012   000006 116007                    CMPQ    6,DL
         0 000013   000015 602006 0                  TNC     s:4908+5,QL
         0 000014   000335 710000 0                  TRA     s:4989
         0 000015   000335 710000 0                  TRA     s:4989
         0 000016   000150 710000 0                  TRA     s:4950
         0 000017   000103 710000 0                  TRA     s:4933
         0 000020   000103 710000 0                  TRA     s:4933
         0 000021   000023 710000 0                  TRA     s:4910
         0 000022   000064 710000 0                  TRA     s:4926

     1985     4909    2       CASE (%INPUT#);

     1986     4910    2           IF NOT GET$CMD.CONTINUE_OK#

   4910  0 000023   100006 236100                    LDQ     6,,PR1
         0 000024   040000 316003                    CANQ    16384,DU
         0 000025   000031 601000 0                  TNZ     s:4916

     1987     4911    2           THEN
     1988     4912    3           DO ;

     1989     4913    3               GET$CMD.CONTINUED# = '1'B ;

   4913  0 000026   100000 236003                    LDQ     32768,DU
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:343  
         0 000027   100006 256100                    ORSQ    6,,PR1

     1990     4914    3               RETURN ;

   4914  0 000030   000000 702200 xent               TSX2  ! X66_ARET

     1991     4915    3           END ;                     /* Then Do */
     1992     4916    2           IF XUG.SPHANDLE ~= ENTADDR(NIL)

   4916  0 000031   200004 473500                    LDP3    XUG$,,AUTO
         0 000032   300025 236100                    LDQ     21,,PR3
         0 000033   000002 116000 xsym               CMPQ    B_VECTNIL+2
         0 000034   000053 600000 0                  TZE     s:4923

     1993     4917    2           THEN
     1994     4918    3           DO ;

     1995     4919    3               PARSE_PARAM.USER$ = XUG.USER$ ;

   4919  0 000035   300076 236100                    LDQ     62,,PR3
         0 000036   000006 756100                    STQ     6,,PR0

     1996     4920    3               CALL XUG.SPHANDLE(GET$CMD,PARSE_PARAM) ;

   4920  0 000037   200003 236100                    LDQ     @PARSE_PARAM,,AUTO
         0 000040   200005 235100                    LDA     GETCMD$,,AUTO
         0 000041   200010 757100                    STAQ    CHR$+2,,AUTO
         0 000042   200010 630500                    EPPR0   CHR$+2,,AUTO
         0 000043   300025 220100                    LDX0    21,,PR3
         0 000044   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000045   000000 701010                    TSX1    0,X0
         0 000046   000000 011000                    NOP     0

     1997     4921    3               CALL XUG$SETPROMPT(GET$CMD) ;

   4921  0 000047   200005 630500                    EPPR0   GETCMD$,,AUTO
         0 000050   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:344  
         0 000051   000000 701000 xent               TSX1    XUG$SETPROMPT
         0 000052   000000 011000                    NOP     0

     1998     4922    3           END ;                     /* Then Do */

     1999     4923    2           XUG.CPOS = PARSE_PARAM.CHARPOS ;

   4923  0 000053   200003 470500                    LDP0    @PARSE_PARAM,,AUTO
         0 000054   000004 235100                    LDA     4,,PR0
         0 000055   200004 471500                    LDP1    XUG$,,AUTO
         0 000056   100104 755100                    STA     68,,PR1

     2000     4924    2           CALL XUG$GETMORE_COMMON (GET$CMD) ;

   4924  0 000057   200005 630500                    EPPR0   GETCMD$,,AUTO
         0 000060   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000061   000000 701000 xent               TSX1    XUG$GETMORE_COMMON
         0 000062   000000 011000                    NOP     0
         0 000063   000335 710000 0                  TRA     s:4989

     2001     4925    2       CASE (%SPACE#);

     2002     4926    2           CALL XUG$MOREMEM(GET$CMD) WHENALTRETURN

   4926  0 000064   200005 630500                    EPPR0   GETCMD$,,AUTO
         0 000065   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000066   000000 701000 xent               TSX1    XUG$MOREMEM
         0 000067   000071 702000 0                  TSX2    s:4928
         0 000070   000072 710000 0                  TRA     s:4930

     2003     4927    3           DO ;

     2004     4928    3               ALTRETURN ;

   4928  0 000071   000000 702200 xent               TSX2  ! X66_AALT

     2005     4929    3           END ;                  /* Whenaltreturn Do */
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:345  
     2006     4930    2           PARSE_PARAM.WKSZ = PARSE_PARAM.WKSZ + %EXPND_PARSEWK/4 ;

   4930  0 000072   200003 470500                    LDP0    @PARSE_PARAM,,AUTO
         0 000073   000007 220100                    LDX0    7,,PR0
         0 000074   000310 621010                    EAX1    200,X0
         0 000075   000007 741100                    STX1    7,,PR0

     2007     4931    2           PARSE_PARAM.PCB$->P_PCB.TEXT$ = VBASE(XUG.BUFVEC) ;

   4931  0 000076   000005 471500                    LDP1    5,,PR0
         0 000077   200004 473500                    LDP3    XUG$,,AUTO
         0 000100   300001 236100                    LDQ     1,,PR3
         0 000101   100000 756100                    STQ     0,,PR1
         0 000102   000335 710000 0                  TRA     s:4989

     2008     4932    2       CASE (%SUCC#, %FAIL#);

     2009     4933    2           IF XUG.PARSING_FREE_CMDS

   4933  0 000103   200004 473500                    LDP3    XUG$,,AUTO
         0 000104   300266 236100                    LDQ     182,,PR3
         0 000105   400000 316007                    CANQ    -131072,DL
         0 000106   000135 600000 0                  TZE     s:4944

     2010     4934    3           THEN DO;

     2011     4935    3               IF PARSE_PARAM.CODE = %XUG_HELP_KWD

   4935  0 000107   000000 720100                    LXL0    0,,PR0
         0 000110   000020 100003                    CMPX0   16,DU
         0 000111   000335 601000 0                  TNZ     s:4989
         0 000112   000005 474500                    LDP4    5,,PR0
         0 000113   000004 236100                    LDQ     4,,PR0
         0 000114   400011 116100                    CMPQ    9,,PR4
         0 000115   000335 603000 0                  TRC     s:4989

     2012     4936    3                 AND PARSE_PARAM.CHARPOS < PARSE_PARAM.PCB$->P_PCB.NCHARS
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:346  
     2013     4937    4               THEN DO;

     2014     4938    4                   CHR$ = PINCRC(PARSE_PARAM.PCB$->P_PCB.TEXT$,PARSE_PARAM.CHARPOS);

   4938  0 000116   400000 475500                    LDP5    0,,PR4
         0 000117   000011 402007                    MPY     9,DL
         0 000120   500000 503506                    ABD     0,QL,PR5
         0 000121   200006 455500                    STP5    CHR$,,AUTO

     2015     4939    4                   IF CHR ~= ' ' AND CHR ~= '('

   4939  0 000122   040000 106500                    CMPC    fill='040'O
         0 000123   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         0 000124   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         0 000125   000335 600000 0                  TZE     s:4989
         0 000126   040000 106500                    CMPC    fill='040'O
         0 000127   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         0 000130   000000 000001 1                  ADSC9   0                        cn=0,n=1
         0 000131   000335 600000 0                  TZE     s:4989

     2016     4940    4                   THEN
     2017     4941    4                       PARSE_PARAM.REJECT = %YES# ;

   4941  0 000132   000200 236003                    LDQ     128,DU
         0 000133   000000 256100                    ORSQ    0,,PR0

     2018     4942    4               END;

     2019     4943    3           END;

   4943  0 000134   000335 710000 0                  TRA     s:4989

     2020     4944    2           ELSE IF XUG.SFROUTINE~=ENTADDR(NIL)

   4944  0 000135   300024 236100                    LDQ     20,,PR3
         0 000136   000002 116000 xsym               CMPQ    B_VECTNIL+2
         0 000137   000335 600000 0                  TZE     s:4989
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:347  

     2021     4945    3               THEN DO;

     2022     4946    3                   PARSE_PARAM.USER$ = XUG.USER$ ;

   4946  0 000140   300076 236100                    LDQ     62,,PR3
         0 000141   000006 756100                    STQ     6,,PR0

     2023     4947    3                   CALL XUG.SFROUTINE(PARSE_PARAM);

   4947  0 000142   200003 630500                    EPPR0   @PARSE_PARAM,,AUTO
         0 000143   300024 220100                    LDX0    20,,PR3
         0 000144   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000145   000000 701010                    TSX1    0,X0
         0 000146   000000 011000                    NOP     0

     2024     4948    3               END ;

   4948  0 000147   000335 710000 0                  TRA     s:4989

     2025     4949    2       CASE (%PRE#);

     2026     4950    2           IF PARSE_PARAM.NODE$ = ADDR(XUG_BUILTIN_N)

   4950  0 000150   000001 236000 1                  LDQ     1
         0 000151   000001 116100                    CMPQ    1,,PR0
         0 000152   000157 601000 0                  TNZ     s:4954

     2027     4951    2           THEN
     2028     4952    2               XUG.PARSING_FREE_CMDS = %YES#;

   4952  0 000153   200004 473500                    LDP3    XUG$,,AUTO
         0 000154   400000 236007                    LDQ     -131072,DL
         0 000155   300266 256100                    ORSQ    182,,PR3
         0 000156   000335 710000 0                  TRA     s:4989

     2029     4953    2           ELSE
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:348  
     2030     4954    2               IF XUG.PARSING_FREE_CMDS

   4954  0 000157   200004 473500                    LDP3    XUG$,,AUTO
         0 000160   300266 236100                    LDQ     182,,PR3
         0 000161   400000 316007                    CANQ    -131072,DL
         0 000162   000323 600000 0                  TZE     s:4983

     2031     4955    3               THEN DO;

     2032     4956    4                   DO CASE (PARSE_PARAM.CODE);

   4956  0 000163   000000 720100                    LXL0    0,,PR0
         0 000164   000020 100003                    CMPX0   16,DU
         0 000165   000167 602010 0                  TNC     s:4956+4,X0
         0 000166   000335 710000 0                  TRA     s:4989
         0 000167   000322 710000 0                  TRA     s:4981
         0 000170   000207 710000 0                  TRA     s:4958
         0 000171   000215 710000 0                  TRA     s:4960
         0 000172   000223 710000 0                  TRA     s:4962
         0 000173   000231 710000 0                  TRA     s:4964
         0 000174   000237 710000 0                  TRA     s:4966
         0 000175   000245 710000 0                  TRA     s:4968
         0 000176   000261 710000 0                  TRA     s:4972
         0 000177   000267 710000 0                  TRA     s:4974
         0 000200   000267 710000 0                  TRA     s:4974
         0 000201   000275 710000 0                  TRA     s:4976
         0 000202   000322 710000 0                  TRA     s:4981
         0 000203   000322 710000 0                  TRA     s:4981
         0 000204   000322 710000 0                  TRA     s:4981
         0 000205   000253 710000 0                  TRA     s:4970
         0 000206   000303 710000 0                  TRA     s:4978

     2033     4957    4                   CASE (%XUG_CMD_DIR);

     2034     4958    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.DIRECTORY#;

   4958  0 000207   300071 236100                    LDQ     57,,PR3
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:349  
         0 000210   000015 736000                    QLS     13
         0 000211   000000 676100                    ERQ     0,,PR0
         0 000212   000200 376003                    ANQ     128,DU
         0 000213   000000 656100                    ERSQ    0,,PR0
         0 000214   000335 710000 0                  TRA     s:4989

     2035     4959    4                   CASE (%XUG_CMD_DO);

     2036     4960    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.DO#;

   4960  0 000215   300071 236100                    LDQ     57,,PR3
         0 000216   000016 736000                    QLS     14
         0 000217   000000 676100                    ERQ     0,,PR0
         0 000220   000200 376003                    ANQ     128,DU
         0 000221   000000 656100                    ERSQ    0,,PR0
         0 000222   000335 710000 0                  TRA     s:4989

     2037     4961    4                   CASE (%XUG_CMD_END);

     2038     4962    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.END#;

   4962  0 000223   300071 236100                    LDQ     57,,PR3
         0 000224   000017 736000                    QLS     15
         0 000225   000000 676100                    ERQ     0,,PR0
         0 000226   000200 376003                    ANQ     128,DU
         0 000227   000000 656100                    ERSQ    0,,PR0
         0 000230   000335 710000 0                  TRA     s:4989

     2039     4963    4                   CASE (%XUG_CMD_ERASE);

     2040     4964    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.ERASE#;

   4964  0 000231   300071 236100                    LDQ     57,,PR3
         0 000232   000020 736000                    QLS     16
         0 000233   000000 676100                    ERQ     0,,PR0
         0 000234   000200 376003                    ANQ     128,DU
         0 000235   000000 656100                    ERSQ    0,,PR0
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:350  
         0 000236   000335 710000 0                  TRA     s:4989

     2041     4965    4                   CASE (%XUG_CMD_HELP);

     2042     4966    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.HELP#;

   4966  0 000237   300071 236100                    LDQ     57,,PR3
         0 000240   000021 736000                    QLS     17
         0 000241   000000 676100                    ERQ     0,,PR0
         0 000242   000200 376003                    ANQ     128,DU
         0 000243   000000 656100                    ERSQ    0,,PR0
         0 000244   000335 710000 0                  TRA     s:4989

     2043     4967    4                   CASE (%XUG_CMD_NULL);

     2044     4968    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.NULL#;

   4968  0 000245   300071 236100                    LDQ     57,,PR3
         0 000246   000022 736000                    QLS     18
         0 000247   000000 676100                    ERQ     0,,PR0
         0 000250   000200 376003                    ANQ     128,DU
         0 000251   000000 656100                    ERSQ    0,,PR0
         0 000252   000335 710000 0                  TRA     s:4989

     2045     4969    4                   CASE (%XUG_CMD_OUTPUT);

     2046     4970    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.OUTPUT#;

   4970  0 000253   300071 236100                    LDQ     57,,PR3
         0 000254   000023 736000                    QLS     19
         0 000255   000000 676100                    ERQ     0,,PR0
         0 000256   000200 376003                    ANQ     128,DU
         0 000257   000000 656100                    ERSQ    0,,PR0
         0 000260   000335 710000 0                  TRA     s:4989

     2047     4971    4                   CASE (%XUG_CMD_PRINT);

PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:351  
     2048     4972    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.PRINT#;

   4972  0 000261   300071 236100                    LDQ     57,,PR3
         0 000262   000024 736000                    QLS     20
         0 000263   000000 676100                    ERQ     0,,PR0
         0 000264   000200 376003                    ANQ     128,DU
         0 000265   000000 656100                    ERSQ    0,,PR0
         0 000266   000335 710000 0                  TRA     s:4989

     2049     4973    4                   CASE (%XUG_CMD_Q1,%XUG_CMD_Q2);

     2050     4974    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.QMARK#;

   4974  0 000267   300071 236100                    LDQ     57,,PR3
         0 000270   000025 736000                    QLS     21
         0 000271   000000 676100                    ERQ     0,,PR0
         0 000272   000200 376003                    ANQ     128,DU
         0 000273   000000 656100                    ERSQ    0,,PR0
         0 000274   000335 710000 0                  TRA     s:4989

     2051     4975    4                   CASE (%XUG_CMD_TIME);

     2052     4976    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.DATE#;

   4976  0 000275   300071 236100                    LDQ     57,,PR3
         0 000276   000014 736000                    QLS     12
         0 000277   000000 676100                    ERQ     0,,PR0
         0 000300   000200 376003                    ANQ     128,DU
         0 000301   000000 656100                    ERSQ    0,,PR0
         0 000302   000335 710000 0                  TRA     s:4989

     2053     4977    4                   CASE (%XUG_CMD_ENTER);

     2054     4978    4                       PARSE_PARAM.REJECT = XUG.INHIBITS.ENTER# |

   4978  0 000303   400000 221003                    LDX1    -131072,DU
         0 000304   300270 236100                    LDQ     184,,PR3
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:352  
         0 000305   000002 116000 xsym               CMPQ    B_VECTNIL+2
         0 000306   000310 600000 0                  TZE     s:4978+5
         0 000307   000000 221003                    LDX1    0,DU
         0 000310   300071 236100                    LDQ     57,,PR3
         0 000311   000040 736000                    QLS     32
         0 000312   400000 376003                    ANQ     -131072,DU
         0 000313   200010 756100                    STQ     CHR$+2,,AUTO
         0 000314   000000 636011                    EAQ     0,X1
         0 000315   200010 276100                    ORQ     CHR$+2,,AUTO
         0 000316   000012 772000                    QRL     10
         0 000317   000000 676100                    ERQ     0,,PR0
         0 000320   000200 376003                    ANQ     128,DU
         0 000321   000000 656100                    ERSQ    0,,PR0

     2055     4979    4                         ( XUG.ADAPT$$ = ENTADDR(NIL) );
     2056     4980    4                   END;

     2057     4981    3               END;

   4981  0 000322   000335 710000 0                  TRA     s:4989

     2058     4982    2               ELSE
     2059     4983    2                   IF XUG.SFROUTINE ~= ENTADDR(NIL)

   4983  0 000323   300024 236100                    LDQ     20,,PR3
         0 000324   000002 116000 xsym               CMPQ    B_VECTNIL+2
         0 000325   000335 600000 0                  TZE     s:4989

     2060     4984    3                   THEN DO;

     2061     4985    3                       PARSE_PARAM.USER$ = XUG.USER$;

   4985  0 000326   300076 236100                    LDQ     62,,PR3
         0 000327   000006 756100                    STQ     6,,PR0

     2062     4986    3                       CALL XUG.SFROUTINE (PARSE_PARAM);

PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:353  
   4986  0 000330   200003 630500                    EPPR0   @PARSE_PARAM,,AUTO
         0 000331   300024 220100                    LDX0    20,,PR3
         0 000332   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000333   000000 701010                    TSX1    0,X0
         0 000334   000000 011000                    NOP     0

     2063     4987    3                   END;

     2064     4988    2       END;

     2065     4989    1       RETURN;

   4989  0 000335   000000 702200 xent               TSX2  ! X66_ARET
     2066     4990    1   END XUG$PU;
     2067     4991        %EOD;

PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:354  
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$PU.
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:355  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARSE_PARAM               6-0-0/w PTR         r     1 CHR$
     5-0-0/w PTR         r     1 GETCMD$                   *0-0-0/w STRC(270)   r     1 PARSE_PARAM
     4-0-0/w PTR         r     1 XUG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 XUG_BUILTIN_N

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 CHR                        0-0-0/d STRC(1512)  r     1 GET$CMD
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/d STRC(9612)  r     1 XUG


   Procedure XUG$PU requires 222 words for executable code.
   Procedure XUG$PU requires 10 words of local(AUTO) storage.
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:356  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:357  
          MINI XREF LISTING

CHR
      4120**DCL      4939>>IF       4939>>IF
CHR$
      4119**DCL      4120--IMP-PTR  4938<<ASSIGN   4939>>IF       4939>>IF
GET$CMD
      4579**DCL      4920<>CALL     4921<>CALL     4924<>CALL     4926<>CALL
GET$CMD.CONTINUED#
      4639**DCL      4913<<ASSIGN
GET$CMD.CONTINUE_OK#
      4643**DCL      4910>>IF
GET$CMD.OUT$
      4584**DCL      4590--REDEF
GET$CMD.WORK$
      4612**DCL      4907>>ASSIGN
GETCMD$
      4116**DCL      4579--IMP-PTR  4906<<ASSIGN   4907>>ASSIGN   4910>>IF       4913>>ASSIGN   4920>>CALL
      4921>>CALL     4924>>CALL     4926>>CALL
PARSE_PARAM
      3757**DCL         6--PROC     4920<>CALL     4947<>CALL     4986<>CALL
PARSE_PARAM.CHARPOS
      3795**DCL      4923>>ASSIGN   4935>>IF       4938>>ASSIGN
PARSE_PARAM.CODE
      3778**DCL      4935>>IF       4956>>DOCASE
PARSE_PARAM.NODE$
      3783**DCL      4950>>IF
PARSE_PARAM.PCB$
      3801**DCL      4931>>ASSIGN   4935>>IF       4938>>ASSIGN
PARSE_PARAM.REJECT
      3769**DCL      4941<<ASSIGN   4958<<ASSIGN   4960<<ASSIGN   4962<<ASSIGN   4964<<ASSIGN   4966<<ASSIGN
      4968<<ASSIGN   4970<<ASSIGN   4972<<ASSIGN   4974<<ASSIGN   4976<<ASSIGN   4978<<ASSIGN
PARSE_PARAM.TYPE
      3758**DCL      4908>>DOCASE
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:358  
PARSE_PARAM.USER$
      3805**DCL      4906>>ASSIGN   4919<<ASSIGN   4946<<ASSIGN   4985<<ASSIGN
PARSE_PARAM.WKSZ
      3810**DCL      4930<<ASSIGN   4930>>ASSIGN
P_PCB.NCHARS
      3984**DCL      4935>>IF
P_PCB.TEXT$
      3838**DCL      4931<<ASSIGN   4938>>ASSIGN
XUG.ADAPT$$
      4548**DCL      4978>>ASSIGN
XUG.BUF
      4561**DCL      4564--REDEF
XUG.BUFVEC
      4126**DCL      4931>>ASSIGN
XUG.CPOS
      4393**DCL      4923<<ASSIGN
XUG.INHIBITS.DATE#
      4328**DCL      4976>>ASSIGN
XUG.INHIBITS.DIRECTORY#
      4332**DCL      4958>>ASSIGN
XUG.INHIBITS.DO#
      4333**DCL      4960>>ASSIGN
XUG.INHIBITS.END#
      4334**DCL      4962>>ASSIGN
XUG.INHIBITS.ENTER#
      4341**DCL      4978>>ASSIGN
XUG.INHIBITS.ERASE#
      4335**DCL      4964>>ASSIGN
XUG.INHIBITS.HELP#
      4336**DCL      4966>>ASSIGN
XUG.INHIBITS.NULL#
      4337**DCL      4968>>ASSIGN
XUG.INHIBITS.OUTPUT#
      4338**DCL      4970>>ASSIGN
XUG.INHIBITS.PRINT#
      4339**DCL      4972>>ASSIGN
PL6.E3A0      #003=XUG$PU File=XUG$COMMON.:E05TSI                                WED 07/30/97 09:21 Page:359  
XUG.INHIBITS.QMARK#
      4340**DCL      4974>>ASSIGN
XUG.PARSING_FREE_CMDS
      4516**DCL      4933>>IF       4952<<ASSIGN   4954>>IF
XUG.SFROUTINE
      4166**DCL      4944>>IF       4947>>CALL     4983>>IF       4986>>CALL
XUG.SPHANDLE
      4169**DCL      4916>>IF       4920>>CALL
XUG.USER$
      4366**DCL      4919>>ASSIGN   4946>>ASSIGN   4985>>ASSIGN
XUG$
      4115**DCL      4125--IMP-PTR  4907<<ASSIGN   4916>>IF       4919>>ASSIGN   4920>>CALL     4923>>ASSIGN
      4931>>ASSIGN   4933>>IF       4944>>IF       4946>>ASSIGN   4947>>CALL     4952>>ASSIGN   4954>>IF
      4958>>ASSIGN   4960>>ASSIGN   4962>>ASSIGN   4964>>ASSIGN   4966>>ASSIGN   4968>>ASSIGN   4970>>ASSIGN
      4972>>ASSIGN   4974>>ASSIGN   4976>>ASSIGN   4978>>ASSIGN   4978>>ASSIGN   4983>>IF       4985>>ASSIGN
      4986>>CALL
XUG$GETMORE_COMMON
      4110**DCL-ENT  4924--CALL
XUG$MOREMEM
      4111**DCL-ENT  4926--CALL
XUG$SETPROMPT
      4112**DCL-ENT  4921--CALL
XUG_BUILTIN_N
      4904**DCL      4950--IF

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:360  
     2068        1        /*T***********************************************************/
     2069        2        /*T*                                                         */
     2070        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2071        4        /*T*                                                         */
     2072        5        /*T***********************************************************/
     2073        6        /* ROUTINE TO READ COMMAND LINE AND ECHO IF APPROPRIATE */
     2074        7        XUG$READCMD_COMMON: PROC(GETCMD,CMDBUF,ARS) ALTRET;
     2075        8        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2076        9    1   DCL CMDBUF VECTOR PARAM ;
     2077       10    1   DCL 1 CHARPOS REDEF CMDBUF,
     2078       11    1         2 N UBIN WORD,
     2079       12    1         2 * UBIN WORD ;
     2080       13    1   DCL ARS SBIN;
     2081       14    1   DCL 1 ERR REDEF ARS,
     2082       15    1         2 FCG BIT(18),
     2083       16    1         2 MON BIT(1),
     2084       17    1         2 CODE UBIN(14) UNAL,
     2085       18    1         2 SEV UBIN(3) UNAL;
     2086       19    1   DCL BUFFER CHAR(ARS) BASED(CMDBUF$);
     2087       20    1   DCL CMDBUF$ PTR ;
     2088       21        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:361  
     2089       22    1   DCL XUG$ PTR;
     2090       23
     2091       24        %INCLUDE XU_MACRO_C;
     2092     3130        %INCLUDE XUH_MACRO_C ;
     2093     3214        %INCLUDE XU_SUBS_C;
     2094     3306        %INCLUDE XU_PERR_C ;
     2095     3497        %INCLUDE XT_MACRO_M;
     2096     3823        %INCLUDE XT_PERR_E ;
     2097     3884        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     2098     4222        %XUG_PARAMS;
     2099     4666        %XUG_INIT (NAME=XUG_INIT_C, STCLASS=SYMREF);
     2100     5079        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
     2101     5492        %XT_PARAM (NAME=XT_PARAM, STCLASS="BASED(XT$)");
     2102     5805        %XT_PARAM (NAME=XT_PARAM_C, STCLASS=CONSTANT,GETMEM=XUG$ADAPTMEM);
     2103     6118        %P_PCB(STCLASS=BASED);
     2104     6317    1   DCL XUG$ADAPTMEM ENTRY(1) ALTRET;
     2105     6318    1   DCL XUG$OPENOUT_INTERNAL ENTRY(2);
     2106     6319    1   DCL CHARBASE CHAR(300) BASED;
     2107     6320    1   DCL OFFSET SBIN;
     2108     6321    1   DCL 1 T_ERR,
     2109     6322    1         2 FCG BIT(18),
     2110     6323    1         2 MON BIT(1),
     2111     6324    1         2 CODE UBIN(14) UNAL,
     2112     6325    1         2 SEV UBIN(3) UNAL;
     2113     6326        /**/
     2114     6327        %INCLUDE CP_6;
     2115    11886        %INCLUDE CP_6_SUBS;
     2116    12426        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
     2117    12427        DCL 1 NAME STCLASS,
     2118    12428              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
     2119    12429              2 C CHAR(0) INIT(T#);
     2120    12430        %MEND;
     2121    12431        %TEXTC (NAME=M$LO,T#='M$LO');
     2122    12436    1   DCL DCB$ PTR ;
     2123    12437    1   DCL DCB$NUM UBIN WORD BASED(DCB$) ;
     2124    12438    1   DCL M$DO DCB;
     2125    12439    1   DCL XUG_IN$ PTR;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:362  
     2126    12440    1   DCL M$DO$ PTR;
     2127    12441    1   DCL PRE_PROCESSOR_ERROR BIT (1) AUTO;
     2128    12442    1   DCL PPCB$ PTR AUTO;
     2129    12443    1   DCL POFF SBIN WORD ;
     2130    12444    1   DCL PROMPT_BUF CHAR(94) ;
     2131    12445    1   DCL READR_EXISTS BIT (1);
     2132    12446    1   DCL CSIZE SBIN ;
     2133    12447    1   DCL VCHARBASE CHAR(CSIZE) BASED ;
     2134    12448    1   DCL XT$ PTR;
     2135    12449
     2136    12450    1   DCL XUG$PRE_PROCESSOR ENTRY (2);
     2137    12451    1   DCL XUG$PP_CMDVARS ENTRY (2);
     2138    12452    1   DCL XUG$MOREMEM ENTRY(1) ALTRET;
     2139    12453    1   DCL XUG$INIT_COMMON ENTRY (2) ALTRET;
     2140    12454    1   DCL XUG$GETDCB_COMMON ENTRY(2) ALTRET;
     2141    12455        %F$DCB;
     2142    12512        %FPT_READ (WAIT=YES,STCLASS=CONSTANT,FPTN=FPT_READ_C);
     2143    12551        %FPT_READ (STCLASS=AUTO);
     2144    12590        %FPT_WRITE (WAIT=YES,STCLASS=CONSTANT,FPTN=FPT_WRITE_C);
     2145    12621        %FPT_WRITE (STCLASS=AUTO);
     2146    12652        %FPT_CORRES (STCLASS=CONSTANT,FPTN=FPT_CORRES_C);
     2147    12666        %FPT_CORRES (STCLASS=AUTO);
     2148    12680        %FPT_OPEN (STCLASS=CONSTANT,FPTN=FPT_OPEN_C);
     2149    12789        %FPT_OPEN (STCLASS=AUTO);
     2150    12898        %VLP_ERRCODE (FPTN=XUG#NO_PROMPT, STCLASS=CONSTANT,
     2151    12899                      FCG=XU, MID=G, ERR#=%E$XUG#NO_PROMPT, SEV=0) ;
     2152    12944        %VLP_ERRCODE (FPTN=XT#EOD, STCLASS=CONSTANT,
     2153    12945                      FCG=XT, ERR#=%E$XT#EOD);
     2154    12990        %VLP_ERRCODE (FPTN=XT#CANT_ADAPT, STCLASS=CONSTANT,
     2155    12991                      FCG=XT, ERR#=%E$XT#CANT_ADAPT);
     2156    13036        %B$TCB;
     2157    13039        %B$ALT;
     2158    13047    1   DCL B$TCB$ PTR SYMREF;
     2159    13048    1   DCL B$JIT$ PTR SYMREF;
     2160    13049        %INCLUDE B$JIT;
     2161    13652        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:363  
     2162    13653    1       XUG$ = GETCMD.WORK$ ;
     2163    13654    1       CMDBUF$ = VBASE(CMDBUF) ;
     2164    13655    1       XUG_IN$ = DCBADDR(GETCMD.INDCB#);
     2165    13656    1       GETCMD.EOMCHAR# = %EOM_EOR#;
     2166    13657    1       READR_EXISTS = '0'B;
     2167    13658    1       XUG.PP_ERR = '0'B;
     2168    13659    1       XUG.BUF = ' ';
     2169    13660    1       IF XUG.ADAPT$$ ~= ENTADDR(NIL)
     2170    13661    1         AND GETCMD.XT_PARAM$ = ADDR(NIL)
     2171    13662    2       THEN DO;
     2172    13663    2           XT$ = PINCRW(XUG$, SIZEW(XUG) + SIZEW(P_PCB));
     2173    13664    2           XT_PARAM = XT_PARAM_C;
     2174    13665    2           XT_PARAM.XUG$ = XUG$ ;
     2175    13666    2           XT_PARAM.USER$ = ADDR(GETCMD);
     2176    13667    2           XT_PARAM.INDCB = GETCMD.INDCB#;
     2177    13668    2           XT_PARAM.OUTDCB = GETCMD.OUTDCB#;
     2178    13669    2           GETCMD.XT_PARAM$ = XT$;
     2179    13670    2           CALL XUG.ADAPT$$ (XT_PARAM, %XT#RESTART)
     2180    13671    3           WHENALTRETURN DO;
     2181    13672    3               XUG.ADAPT$$ = ENTADDR(NIL);
     2182    13673    3               GETCMD.XT_PARAM$ = ADDR(NIL);
     2183    13674    3               IF XT_PARAM.ERR ~= XT#CANT_ADAPT
     2184    13675    4               THEN DO;
     2185    13676    4                   GETCMD.ERR# = XT_PARAM.ERR;
     2186    13677    4                   ALTRETURN;
     2187    13678    4               END;
     2188    13679    3           END;
     2189    13680    2       END;
     2190    13681    1       XT$ = GETCMD.XT_PARAM$;
     2191    13682    1       IF XUG.ADAPT$$ ~= ENTADDR(NIL)
     2192    13683    1         AND XT_PARAM.ADAPTING
     2193    13684    1         AND XT_PARAM.INDCB = GETCMD.INDCB#  /* ie, if not secondary READ file */
     2194    13685    2       THEN DO;
     2195    13686    2           XT_PARAM.BUF.PT$ = ADDR(XUG.BUF);
     2196    13687    2           XT_PARAM.BUF.LEN = LENGTHC(XUG.BUF);
     2197    13688    2           XT_PARAM.PROMPT.PT$ = ADDR(XUG.PROMPT);
     2198    13689    2           XT_PARAM.PROMPT.LEN = XUG.POFF + BITBIN(XUG.PROMPT_VFC);
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:364  
     2199    13690    2           XT_PARAM.PROMPT_VFC = XUG.PROMPT_VFC;
     2200    13691    2           OFFSET = 0;
     2201    13692    2           GETCMD.EOMCHAR# = %EOM_EOR#;
     2202    13693    2           GETCMD.TREAD# = %YES#;
     2203    13694    2           CALL XUG.ADAPT$$ (XT_PARAM, %XT#READ)
     2204    13695    3           WHENALTRETURN DO;
     2205    13696    3               IF XT_PARAM.ERR = XT#EOD
     2206    13697    3               THEN
     2207    13698    3                   GOTO NORMAL_READ ;
     2208    13699    3               ERR = XT_PARAM.ERR;
     2209    13700    3               ALTRETURN;
     2210    13701    3           END;
     2211    13702    2           ARS = XT_PARAM.ARS;
     2212    13703    2       END;
     2213    13704    2       ELSE DO;
     2214    13705    2   NORMAL_READ: ;
     2215    13706    2           IF GETCMD.READR$$ = ENTADDR(NIL)
     2216    13707    3           THEN DO;
     2217    13708    3               FPT_READ = FPT_READ_C;
     2218    13709    3               FPT_READ.V_ = VECTOR (FPT_READ.V);
     2219    13710    3               FPT_READ.V.DCB#=GETCMD.INDCB#;
     2220    13711    3               FPT_READ.BUF_=VECTOR(XUG.BUF);
     2221    13712    3               CALL M$READ(FPT_READ) ALTRET(BAD_READ);
     2222    13713    3               OFFSET = BITBIN (XUG_IN$ -> F$DCB.DVBYTE.VFC#);
     2223    13714    3               ARS=XUG_IN$->F$DCB.ARS# - OFFSET;
     2224    13715    3               GETCMD.EOMCHAR# = XUG_IN$ -> F$DCB.EOMCHAR#;
     2225    13716    3               IF (NOT XUG_IN$->F$DCB.DDEV.IC#) OR
     2226    13717    3                 (XUG_IN$ -> F$DCB.DDEV.XEQ#)
     2227    13718    3               THEN
     2228    13719    3                   GETCMD.TREAD# = '0'B ;
     2229    13720    3               ELSE
     2230    13721    3                   GETCMD.TREAD# = '1'B ;
     2231    13722    3           END;
     2232    13723    3           ELSE DO;
     2233    13724    3               T_ERR = '0'B ;
     2234    13725    3               READR_EXISTS = '1'B;
     2235    13726                                                /* GETCMD.READR$$ routine must
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:365  
     2236    13727                                                    maintain GETCMD.TREAD#           */
     2237    13728    3               CALL GETCMD.READR$$ (VECTOR(XUG.BUF), ARS, GETCMD.READR$$, T_ERR,
     2238    13729    3                 GETCMD.EOMCHAR#)
     2239    13730    4               WHENALTRETURN DO ;
     2240    13731    4                   ERR = T_ERR ;
     2241    13732    4                   GOTO READ_ALT ;
     2242    13733    4               END ;                  /* Whenaltreturn Do */
     2243    13734    3               OFFSET = 0 ;
     2244    13735    3               XUG.POFF = 0 ;
     2245    13736    3               XUG.PROMPT = ' ' ;
     2246    13737    3               XUG.PROMPT_VFC = %NO# ;
     2247    13738    3           END;
     2248    13739    2       END;
     2249    13740    1       IF (NOT GETCMD.SKIP_PREPROCESS#) AND XUG.PREPROCESS
     2250    13741    2       THEN DO;
     2251    13742    2           IF XUG.PREPROCESSOR$$ ~= ENTADDR(NIL)
     2252    13743    2           THEN
     2253    13744    2               CALL XUG$PRE_PROCESSOR (GETCMD,ARS);
     2254    13745    2           ELSE
     2255    13746    2               CALL XUG$PP_CMDVARS (GETCMD,ARS);
     2256    13747    2       END;
     2257    13748    1       ELSE
     2258    13749    1           GETCMD.SKIP_PREPROCESS# = '0'B ;
     2259    13750    1       IF NOT READR_EXISTS
     2260    13751    1         AND NOT XUG.DONT_STRIP_PROMPT
     2261    13752    1         AND ARS>=XUG.POFF
     2262    13753    1         AND SUBSTR(XUG.BUF,OFFSET,XUG.POFF) =
     2263    13754    1         SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),XUG.POFF)
     2264    13755    2       THEN DO;
     2265    13756    2           GETCMD.RCVD_PROMPT# = '1'B ;
     2266    13757    2           OFFSET = OFFSET + XUG.POFF ;
     2267    13758               /* just in case there was a pre-processor error already ... */
     2268    13759    2           XUG.P_PCB$->P_PCB.HI_CHAR = XUG.P_PCB$->P_PCB.HI_CHAR - XUG.POFF;
     2269    13760    2           ARS = ARS - XUG.POFF ;
     2270    13761    2       END ; /* Then Do */
     2271    13762    1       VBASE(XUG.LAST) = VBASE(CMDBUF) ;
     2272    13763    1       IF ARS = 0
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:366  
     2273    13764    1       THEN
     2274    13765    2       DO ;
     2275    13766    2           VBOUND(XUG.LAST)=ARS ;
     2276    13767    2           CSIZE = 1 ;
     2277    13768    2           VBASE(XUG.LAST) -> VCHARBASE = ' ' ;
     2278    13769    2       END ; /* Then Do */
     2279    13770    1       ELSE
     2280    13771    1           VBOUND(XUG.LAST)=ARS-1;
     2281    13772    1       IF ARS + 1 > VBOUND(CMDBUF)            /* leave 1 extra space for a blank */
     2282    13773    2       THEN DO;
     2283    13774    2           CALL XUG$MOREMEM(GETCMD) ALTRET(READ_ALT) ;
     2284    13775    2       END;
     2285    13776    1       BUFFER = SUBSTR (XUG.BUF , OFFSET , ARS);
     2286    13777    1       CALL MOVE_CMD;
     2287    13778    1       IF XUG.REQ_PROMPT AND NOT GETCMD.RCVD_PROMPT#
     2288    13779    1       THEN
     2289    13780    2       DO ;
     2290    13781    2           GETCMD.ERR# = XUG#NO_PROMPT;
     2291    13782    2           GOTO READ_ALT ;
     2292    13783    2       END ;                        /* Then Do */
     2293    13784        /*E*  ERROR:  XUG-E$XUG#NO_PROMPT
     2294    13785              MESSAGE0: No prompt received.
     2295    13786              MESSAGE1: No prompt received when one was required.
     2296    13787        */
     2297    13788    1       IF READR_EXISTS AND GETCMD.TREAD#
     2298    13789    1       THEN
     2299    13790    1           RETURN ;
     2300    13791    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, GETCMD.OUTDCB#);
     2301    13792    1       IF (GETCMD.TREAD# AND DCBADDR(GETCMD.OUTDCB#)->F$DCB.DDEV.UCOUT#)
     2302    13793    1         OR DCBADDR(GETCMD.INDCB#)->F$DCB.DVBYTE.TRANS#
     2303    13794    1         OR (GETCMD.ECHO = %NEVER_ECHO#)
     2304    13795    1         OR (GETCMD.ECHO = %HONOR_FLAG# AND NOT (B$JIT.CPFLAGS1 & %CP_ECHO#))
     2305    13796    1       THEN
     2306    13797    1           RETURN;
     2307    13798    1       IF GETCMD.PASS ~= %LEAVE_PASS#
     2308    13799    1       THEN
     2309    13800    2       DO ;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:367  
     2310    13801    2           XUG.NEED_ECHO = '1'B ;
     2311    13802    2           RETURN ;
     2312    13803    2       END ;                        /* Then Do */
     2313    13804    1       FPT_WRITE.V.DCB#=GETCMD.OUTDCB#;
     2314    13805    1       CALL WRITE_CMD_WRAPPED;
     2315    13806    1       XUG.NDCBS=1;
     2316    13807    1       XUG.DCBS.ERRPTR_CPOS(1) = -1;
     2317    13808    1       RETURN;
     2318    13809        /**/
     2319    13810    1   BAD_READ:;
     2320    13811    1       ERR=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     2321    13812    1   READ_ALT:
     2322    13813    1       ALTRETURN;
     2323    13814        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:368  
     2324    13815    1   XUG$CORRES_COMMON: ENTRY(GETCMD,CMDBUF) ALTRET;
     2325    13816    1       DCB$ = ADDR(GETCMD) ;
     2326    13817    1       CALL OPEN (DCB$NUM);
     2327    13818    1       CALL OPEN (CHARPOS.N);
     2328    13819    1       FPT_CORRES = FPT_CORRES_C;
     2329    13820    1       FPT_CORRES.V_ = VECTOR (FPT_CORRES.V);
     2330    13821    1       FPT_CORRES.V.DCB1#=DCB$NUM ;
     2331    13822    1       FPT_CORRES.V.DCB2#=CHARPOS.N ;
     2332    13823    1       CALL M$CORRES(FPT_CORRES) ALTRET(CORRES);
     2333    13824    1       RETURN;
     2334    13825    1   CORRES: ALTRETURN;
     2335    13826        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:369  
     2336    13827    1   XUG$ECHOLAST_COMMON: ENTRY(GETCMD) ALTRET;
     2337    13828    1       XUG$ = GETCMD.WORK$ ;
     2338    13829    1       CALL MOVE_CMD;
     2339    13830    1       IF GETCMD.DCB_PARAM# = DCBNUM( NIL )
     2340    13831    1       THEN
     2341    13832    1           GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;
     2342    13833    1       IF GETCMD.DCB_PARAM# = DCBNUM(NIL)
     2343    13834    1       THEN
     2344    13835    1           CALL XUG$GETDCB_COMMON(M$LO,GETCMD.DCB_PARAM#) WHENALTRETURN
     2345    13836    2           DO ;
     2346    13837    2               GETCMD.ERR# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;
     2347    13838    2               GOTO CORRES ;
     2348    13839    2           END ;                     /* Whenaltreturn Do */
     2349    13840    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, GETCMD.DCB_PARAM#);
     2350    13841    1       FPT_WRITE.V.DCB#=GETCMD.DCB_PARAM# ;
     2351    13842    1       CALL WRITE_CMD_WRAPPED;
     2352    13843    1       RETURN;
     2353    13844        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:370  
     2354    13845    1   XUG$SETLAST: ENTRY(GETCMD) ALTRET;
     2355    13846    1       IF GETCMD.WORK$ = ADDR(NIL)
     2356    13847    1       THEN
     2357    13848    2       DO ;
     2358    13849    2           XUG_INIT_A = XUG_INIT_C ;
     2359    13850    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) ALTRET (BAD_READ);
     2360    13851    2       END ; /* Then Do */
     2361    13852    1       XUG$ = GETCMD.WORK$ ;
     2362    13853    1       XUG.LAST=XUG.READVEC ;
     2363    13854    1       RETURN;
     2364    13855        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:371  
     2365    13856    1   MOVE_CMD: PROC;
     2366    13857    2       FPT_WRITE = FPT_WRITE_C;
     2367    13858    2       FPT_WRITE.V_ = VECTOR (FPT_WRITE.V);
     2368    13859    2       IF GETCMD.RPROMPT_~=VECTOR(NIL) AND
     2369    13860    2         GETCMD.RPROMPT_~=VECTOR(ERASE)
     2370    13861    3       THEN DO;
     2371    13862    3           POFF = VBOUND(GETCMD.RPROMPT_)+1 ;
     2372    13863    3           CSIZE = POFF ;
     2373    13864    3           PROMPT_BUF = VBASE(GETCMD.RPROMPT_) -> VCHARBASE ;
     2374    13865    3           FPT_WRITE.V.DVBYTE.VFC# = XUG.PROMPT_VFC ;
     2375    13866    3       END ;
     2376    13867    3       ELSE DO;
     2377    13868    3           POFF = XUG.POFF;
     2378    13869    3           PROMPT_BUF = SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),POFF);
     2379    13870    3       END;
     2380    13871    2       SUBSTR (XUG.BUF , 0 , POFF) = PROMPT_BUF;
     2381    13872    2       SUBSTR (XUG.BUF , POFF , VBOUND(XUG.LAST) + 1) = VBASE(XUG.LAST) -> CHARBASE;
     2382    13873    2       FPT_WRITE = FPT_WRITE_C;
     2383    13874    2       FPT_WRITE.V_ = VECTOR (FPT_WRITE.V);
     2384    13875    2       FPT_WRITE.BUF_=VECTOR(XUG.BUF);
     2385    13876    2       FPT_WRITE.BUF_.BOUND=POFF+VBOUND(XUG.LAST);
     2386    13877    2       RETURN;
     2387    13878    2   END MOVE_CMD;
     2388    13879        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:372  
     2389    13880    1   WRITE_CMD_WRAPPED: PROC;
     2390    13881    2   DCL CHUNK_SIZE SBIN;
     2391    13882    2   DCL OFFSET SBIN;
     2392    13883    2   DCL OUTPUT_COUNT SBIN;
     2393    13884    2   DCL OUTPUT_STRING CHAR (OUTPUT_COUNT) BASED (FPT_WRITE.BUF_.BUF$);
     2394    13885    2   DCL OUTPUT_WIDTH SBIN;
     2395    13886    2       OUTPUT_WIDTH = DCBADDR(FPT_WRITE.V.DCB#) -> F$DCB.WIDTH#;
     2396    13887    2       IF OUTPUT_WIDTH = 0
     2397    13888    2       THEN
     2398    13889    2           OUTPUT_WIDTH = 511;
     2399    13890    2       OUTPUT_COUNT = FPT_WRITE.BUF_.BOUND + 1;
     2400    13891    3       DO WHILE (OUTPUT_COUNT > 1);
     2401    13892    3           IF SUBSTR (OUTPUT_STRING, OUTPUT_COUNT - 1, 1) ~= ' '
     2402    13893    3           THEN
     2403    13894    3               EXIT;
     2404    13895    3           OUTPUT_COUNT = OUTPUT_COUNT - 1;
     2405    13896    3       END;
     2406    13897    2       OFFSET = 0;
     2407    13898    3       DO WHILE (OFFSET < OUTPUT_COUNT);
     2408    13899    3           CHUNK_SIZE = MINIMUM(OUTPUT_COUNT - OFFSET, OUTPUT_WIDTH);
     2409    13900    3           IF XUG.PROMPT_VFC AND OFFSET > 0
     2410    13901    4           THEN DO;
     2411    13902    4               CHUNK_SIZE = CHUNK_SIZE + 1;
     2412    13903    4               OFFSET = OFFSET - 1;
     2413    13904    4               SUBSTR( XUG.BUF, OFFSET, 1 ) = SUBSTR( XUG.BUF, 0, 1 );
     2414    13905    4           END;
     2415    13906    3           FPT_WRITE.BUF_.BOUND = CHUNK_SIZE - 1;
     2416    13907    4           CALL M$WRITE(FPT_WRITE) WHENALTRETURN DO ;
     2417    13908    4           END ;
     2418    13909    3           OFFSET = OFFSET + CHUNK_SIZE;
     2419    13910    3           FPT_WRITE.BUF_.BUF$ = PINCRC(FPT_WRITE.BUF_.BUF$, CHUNK_SIZE);
     2420    13911    3       END;
     2421    13912    2       RETURN;
     2422    13913    2   END WRITE_CMD_WRAPPED;
     2423    13914        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:373  
     2424    13915    1   OPEN: PROC(DCBNO);
     2425    13916    2   DCL DCBNO UBIN;
     2426    13917    2       IF DCBNO = DCBNUM(NIL)
     2427    13918    2       THEN
     2428    13919    2           RETURN;
     2429    13920    2       IF NOT DCBADDR(DCBNO) -> F$DCB.FCD#
     2430    13921    3       THEN DO;
     2431    13922    3           FPT_OPEN = FPT_OPEN_C;
     2432    13923    3           FPT_OPEN.V_ = VECTOR (FPT_OPEN.V);
     2433    13924    3           FPT_OPEN.V.DCB# = DCBNO;
     2434    13925    3           CALL M$OPEN (FPT_OPEN) ALTRET (IGNORE_ERROR_ON_OPEN);
     2435    13926    3   IGNORE_ERROR_ON_OPEN: ;
     2436    13927    3       END;
     2437    13928    2   END OPEN;
     2438    13929
     2439    13930    1   END XUG$READCMD_COMMON ;
     2440    13931        %EOD;

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:374  
--  Include file information  --

   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XT_PERR_E.:TOOLE04  is referenced.
   XT_MACRO_M.:TOOLE04  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$READCMD_COMMON.

   Procedure XUG$READCMD_COMMON requires 670 words for executable code.
   Procedure XUG$READCMD_COMMON requires 182 words of local(AUTO) storage.

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:375  

 Object Unit name= XUG$READCMD_COMMON                         File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:21:40.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    125    175  XUG$READCMD_COMMON
    1   DCB   even  none     0      0  M$UC
    2   DCB   even  none     0      0  M$DO
    3   Proc  even  none   670   1236  XUG$READCMD_COMMON
    4  RoData even  none    17     21  XUG$READCMD_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        3  XUG$READCMD_COMMON
     3    610          yes     yes      Std        2  XUG$CORRES_COMMON
     3    647          yes     yes      Std        1  XUG$ECHOLAST_COMMON
     3    721          yes     yes      Std        1  XUG$SETLAST
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:376  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XUG$ADAPTMEM
         yes           Std       2 XUG$PRE_PROCESSOR
         yes           Std       2 XUG$PP_CMDVARS
 yes     yes           Std       1 XUG$MOREMEM
         yes           Std       2 XUG$OPENOUT_INTERNAL
 yes     yes           Std       2 XUG$GETDCB_COMMON
 yes     yes           Std       2 XUG$INIT_COMMON
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     XUG_INIT_C                            M$UC                                  M$DO
     B$TCB$                                B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:377  


     2068        1        /*T***********************************************************/
     2069        2        /*T*                                                         */
     2070        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2071        4        /*T*                                                         */
     2072        5        /*T***********************************************************/
     2073        6        /* ROUTINE TO READ COMMAND LINE AND ECHO IF APPROPRIATE */
     2074        7        XUG$READCMD_COMMON: PROC(GETCMD,CMDBUF,ARS) ALTRET;

      7  3 000000   000000 700200 xent  XUG$READCMD* TSX0  ! X66_AUTO_3
         3 000001   000266 000003                    ZERO    182,3

     2075        8        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2076        9    1   DCL CMDBUF VECTOR PARAM ;
     2077       10    1   DCL 1 CHARPOS REDEF CMDBUF,
     2078       11    1         2 N UBIN WORD,
     2079       12    1         2 * UBIN WORD ;
     2080       13    1   DCL ARS SBIN;
     2081       14    1   DCL 1 ERR REDEF ARS,
     2082       15    1         2 FCG BIT(18),
     2083       16    1         2 MON BIT(1),
     2084       17    1         2 CODE UBIN(14) UNAL,
     2085       18    1         2 SEV UBIN(3) UNAL;
     2086       19    1   DCL BUFFER CHAR(ARS) BASED(CMDBUF$);
     2087       20    1   DCL CMDBUF$ PTR ;
     2088       21        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:378  
     2089       22    1   DCL XUG$ PTR;
     2090       23
     2091       24        %INCLUDE XU_MACRO_C;
     2092     3130        %INCLUDE XUH_MACRO_C ;
     2093     3214        %INCLUDE XU_SUBS_C;
     2094     3306        %INCLUDE XU_PERR_C ;
     2095     3497        %INCLUDE XT_MACRO_M;
     2096     3823        %INCLUDE XT_PERR_E ;
     2097     3884        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     2098     4222        %XUG_PARAMS;
     2099     4666        %XUG_INIT (NAME=XUG_INIT_C, STCLASS=SYMREF);
     2100     5079        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
     2101     5492        %XT_PARAM (NAME=XT_PARAM, STCLASS="BASED(XT$)");
     2102     5805        %XT_PARAM (NAME=XT_PARAM_C, STCLASS=CONSTANT,GETMEM=XUG$ADAPTMEM);
     2103     6118        %P_PCB(STCLASS=BASED);
     2104     6317    1   DCL XUG$ADAPTMEM ENTRY(1) ALTRET;
     2105     6318    1   DCL XUG$OPENOUT_INTERNAL ENTRY(2);
     2106     6319    1   DCL CHARBASE CHAR(300) BASED;
     2107     6320    1   DCL OFFSET SBIN;
     2108     6321    1   DCL 1 T_ERR,
     2109     6322    1         2 FCG BIT(18),
     2110     6323    1         2 MON BIT(1),
     2111     6324    1         2 CODE UBIN(14) UNAL,
     2112     6325    1         2 SEV UBIN(3) UNAL;
     2113     6326        /**/
     2114     6327        %INCLUDE CP_6;
     2115    11886        %INCLUDE CP_6_SUBS;
     2116    12426        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
     2117    12427        DCL 1 NAME STCLASS,
     2118    12428              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
     2119    12429              2 C CHAR(0) INIT(T#);
     2120    12430        %MEND;
     2121    12431        %TEXTC (NAME=M$LO,T#='M$LO');
     2122    12436    1   DCL DCB$ PTR ;
     2123    12437    1   DCL DCB$NUM UBIN WORD BASED(DCB$) ;
     2124    12438    1   DCL M$DO DCB;
     2125    12439    1   DCL XUG_IN$ PTR;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:379  
     2126    12440    1   DCL M$DO$ PTR;
     2127    12441    1   DCL PRE_PROCESSOR_ERROR BIT (1) AUTO;
     2128    12442    1   DCL PPCB$ PTR AUTO;
     2129    12443    1   DCL POFF SBIN WORD ;
     2130    12444    1   DCL PROMPT_BUF CHAR(94) ;
     2131    12445    1   DCL READR_EXISTS BIT (1);
     2132    12446    1   DCL CSIZE SBIN ;
     2133    12447    1   DCL VCHARBASE CHAR(CSIZE) BASED ;
     2134    12448    1   DCL XT$ PTR;
     2135    12449
     2136    12450    1   DCL XUG$PRE_PROCESSOR ENTRY (2);
     2137    12451    1   DCL XUG$PP_CMDVARS ENTRY (2);
     2138    12452    1   DCL XUG$MOREMEM ENTRY(1) ALTRET;
     2139    12453    1   DCL XUG$INIT_COMMON ENTRY (2) ALTRET;
     2140    12454    1   DCL XUG$GETDCB_COMMON ENTRY(2) ALTRET;
     2141    12455        %F$DCB;
     2142    12512        %FPT_READ (WAIT=YES,STCLASS=CONSTANT,FPTN=FPT_READ_C);
     2143    12551        %FPT_READ (STCLASS=AUTO);
     2144    12590        %FPT_WRITE (WAIT=YES,STCLASS=CONSTANT,FPTN=FPT_WRITE_C);
     2145    12621        %FPT_WRITE (STCLASS=AUTO);
     2146    12652        %FPT_CORRES (STCLASS=CONSTANT,FPTN=FPT_CORRES_C);
     2147    12666        %FPT_CORRES (STCLASS=AUTO);
     2148    12680        %FPT_OPEN (STCLASS=CONSTANT,FPTN=FPT_OPEN_C);
     2149    12789        %FPT_OPEN (STCLASS=AUTO);
     2150    12898        %VLP_ERRCODE (FPTN=XUG#NO_PROMPT, STCLASS=CONSTANT,
     2151    12899                      FCG=XU, MID=G, ERR#=%E$XUG#NO_PROMPT, SEV=0) ;
     2152    12944        %VLP_ERRCODE (FPTN=XT#EOD, STCLASS=CONSTANT,
     2153    12945                      FCG=XT, ERR#=%E$XT#EOD);
     2154    12990        %VLP_ERRCODE (FPTN=XT#CANT_ADAPT, STCLASS=CONSTANT,
     2155    12991                      FCG=XT, ERR#=%E$XT#CANT_ADAPT);
     2156    13036        %B$TCB;
     2157    13039        %B$ALT;
     2158    13047    1   DCL B$TCB$ PTR SYMREF;
     2159    13048    1   DCL B$JIT$ PTR SYMREF;
     2160    13049        %INCLUDE B$JIT;
     2161    13652        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:380  
     2162    13653    1       XUG$ = GETCMD.WORK$ ;

  13653  3 000002   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000003   000004 236100                    LDQ     4,,PR0
         3 000004   200007 756100                    STQ     XUG$,,AUTO

     2163    13654    1       CMDBUF$ = VBASE(CMDBUF) ;

  13654  3 000005   200004 471500                    LDP1    @CMDBUF,,AUTO
         3 000006   100001 236100                    LDQ     1,,PR1
         3 000007   200006 756100                    STQ     CMDBUF$,,AUTO

     2164    13655    1       XUG_IN$ = DCBADDR(GETCMD.INDCB#);

  13655  3 000010   000000 473400 4                  LDP3    0
         3 000011   300000 474500                    LDP4    0,,PR3
         3 000012   000012 720100                    LXL0    10,,PR0
         3 000013   400000 236110                    LDQ     0,X0,PR4
         3 000014   200057 756100                    STQ     XUG_IN$,,AUTO

     2165    13656    1       GETCMD.EOMCHAR# = %EOM_EOR#;

  13656  3 000015   501000 236007                    LDQ     -97792,DL
         3 000016   000007 552110                    STBQ    7,'10'O,PR0

     2166    13657    1       READR_EXISTS = '0'B;

  13657  3 000017   200114 450100                    STZ     READR_EXISTS,,AUTO

     2167    13658    1       XUG.PP_ERR = '0'B;

  13658  3 000020   200007 475500                    LDP5    XUG$,,AUTO
         3 000021   500100 450100                    STZ     64,,PR5

     2168    13659    1       XUG.BUF = ' ';

  13659  3 000022   040100 100400                    MLR     fill='040'O
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:381  
         3 000023   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000024   500300 000454                    ADSC9   192,,PR5                 cn=0,n=300

     2169    13660    1       IF XUG.ADAPT$$ ~= ENTADDR(NIL)

  13660  3 000025   500270 236100                    LDQ     184,,PR5
         3 000026   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 000027   000101 600000 3                  TZE     s:13681
         3 000030   000036 236100                    LDQ     30,,PR0
         3 000031   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000032   000101 601000 3                  TNZ     s:13681

     2170    13661    1         AND GETCMD.XT_PARAM$ = ADDR(NIL)
     2171    13662    2       THEN DO;

     2172    13663    2           XT$ = PINCRW(XUG$, SIZEW(XUG) + SIZEW(P_PCB));

  13663  3 000033   200007 236100                    LDQ     XUG$,,AUTO
         3 000034   000432 036003                    ADLQ    282,DU
         3 000035   200116 756100                    STQ     XT$,,AUTO

     2173    13664    2           XT_PARAM = XT_PARAM_C;

  13664  3 000036   200116 476500                    LDP6    XT$,,AUTO
         3 000037   000100 100400                    MLR     fill='000'O
         3 000040   000000 000200 0                  ADSC9   XT_PARAM_C               cn=0,n=128
         3 000041   600000 000200                    ADSC9   0,,PR6                   cn=0,n=128

     2174    13665    2           XT_PARAM.XUG$ = XUG$ ;

  13665  3 000042   200007 236100                    LDQ     XUG$,,AUTO
         3 000043   600015 756100                    STQ     13,,PR6

     2175    13666    2           XT_PARAM.USER$ = ADDR(GETCMD);

  13666  3 000044   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000045   600022 756100                    STQ     18,,PR6
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:382  

     2176    13667    2           XT_PARAM.INDCB = GETCMD.INDCB#;

  13667  3 000046   000012 235100                    LDA     10,,PR0
         3 000047   600004 755100                    STA     4,,PR6

     2177    13668    2           XT_PARAM.OUTDCB = GETCMD.OUTDCB#;

  13668  3 000050   000013 235100                    LDA     11,,PR0
         3 000051   600003 755100                    STA     3,,PR6

     2178    13669    2           GETCMD.XT_PARAM$ = XT$;

  13669  3 000052   200116 236100                    LDQ     XT$,,AUTO
         3 000053   000036 756100                    STQ     30,,PR0

     2179    13670    2           CALL XUG.ADAPT$$ (XT_PARAM, %XT#RESTART)

  13670  3 000054   000001 236000 4                  LDQ     1
         3 000055   200116 235100                    LDA     XT$,,AUTO
         3 000056   200256 757100                    STAQ    OUTPUT_WIDTH+2,,AUTO
         3 000057   200256 630500                    EPPR0   OUTPUT_WIDTH+2,,AUTO
         3 000060   500270 220100                    LDX0    184,,PR5
         3 000061   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000062   000000 701010                    TSX1    0,X0
         3 000063   000065 702000 3                  TSX2    s:13672
         3 000064   000101 710000 3                  TRA     s:13681

     2180    13671    3           WHENALTRETURN DO;

     2181    13672    3               XUG.ADAPT$$ = ENTADDR(NIL);

  13672  3 000065   000002 236000 xsym               LDQ     B_VECTNIL+2
         3 000066   200007 470500                    LDP0    XUG$,,AUTO
         3 000067   000270 756100                    STQ     184,,PR0

     2182    13673    3               GETCMD.XT_PARAM$ = ADDR(NIL);
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:383  

  13673  3 000070   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000071   200003 471500                    LDP1    @GETCMD,,AUTO
         3 000072   100036 756100                    STQ     30,,PR1

     2183    13674    3               IF XT_PARAM.ERR ~= XT#CANT_ADAPT

  13674  3 000073   200116 473500                    LDP3    XT$,,AUTO
         3 000074   300001 236100                    LDQ     1,,PR3
         3 000075   000174 116000 0                  CMPQ    XT#CANT_ADAPT
         3 000076   000101 600000 3                  TZE     s:13681

     2184    13675    4               THEN DO;

     2185    13676    4                   GETCMD.ERR# = XT_PARAM.ERR;

  13676  3 000077   100001 756100                    STQ     1,,PR1

     2186    13677    4                   ALTRETURN;

  13677  3 000100   000000 702200 xent               TSX2  ! X66_AALT

     2187    13678    4               END;
     2188    13679    3           END;
     2189    13680    2       END;

     2190    13681    1       XT$ = GETCMD.XT_PARAM$;

  13681  3 000101   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000102   000036 236100                    LDQ     30,,PR0
         3 000103   200116 756100                    STQ     XT$,,AUTO

     2191    13682    1       IF XUG.ADAPT$$ ~= ENTADDR(NIL)

  13682  3 000104   200007 471500                    LDP1    XUG$,,AUTO
         3 000105   100270 236100                    LDQ     184,,PR1
         3 000106   000002 116000 xsym               CMPQ    B_VECTNIL+2
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:384  
         3 000107   000172 600000 3                  TZE     NORMAL_READ
         3 000110   200116 473500                    LDP3    XT$,,AUTO
         3 000111   300014 234100                    SZN     12,,PR3
         3 000112   000172 605000 3                  TPL     NORMAL_READ
         3 000113   300004 236100                    LDQ     4,,PR3
         3 000114   000172 604000 3                  TMI     NORMAL_READ
         3 000115   000012 116100                    CMPQ    10,,PR0
         3 000116   000172 601000 3                  TNZ     NORMAL_READ

     2192    13683    1         AND XT_PARAM.ADAPTING
     2193    13684    1         AND XT_PARAM.INDCB = GETCMD.INDCB#  /* ie, if not secondary READ file */
     2194    13685    2       THEN DO;

     2195    13686    2           XT_PARAM.BUF.PT$ = ADDR(XUG.BUF);

  13686  3 000117   200007 236100                    LDQ     XUG$,,AUTO
         3 000120   000300 036003                    ADLQ    192,DU
         3 000121   300005 756100                    STQ     5,,PR3

     2196    13687    2           XT_PARAM.BUF.LEN = LENGTHC(XUG.BUF);

  13687  3 000122   000454 235007                    LDA     300,DL
         3 000123   300006 755100                    STA     6,,PR3

     2197    13688    2           XT_PARAM.PROMPT.PT$ = ADDR(XUG.PROMPT);

  13688  3 000124   200007 236100                    LDQ     XUG$,,AUTO
         3 000125   000037 036003                    ADLQ    31,DU
         3 000126   300025 756100                    STQ     21,,PR3

     2198    13689    2           XT_PARAM.PROMPT.LEN = XUG.POFF + BITBIN(XUG.PROMPT_VFC);

  13689  3 000127   100071 236100                    LDQ     57,,PR1
         3 000130   000024 772000                    QRL     20
         3 000131   000001 376007                    ANQ     1,DL
         3 000132   100036 036100                    ADLQ    30,,PR1
         3 000133   300026 756100                    STQ     22,,PR3
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:385  

     2199    13690    2           XT_PARAM.PROMPT_VFC = XUG.PROMPT_VFC;

  13690  3 000134   100071 236100                    LDQ     57,,PR1
         3 000135   000017 736000                    QLS     15
         3 000136   400000 376003                    ANQ     -131072,DU
         3 000137   300027 756100                    STQ     23,,PR3

     2200    13691    2           OFFSET = 0;

  13691  3 000140   200054 450100                    STZ     OFFSET,,AUTO

     2201    13692    2           GETCMD.EOMCHAR# = %EOM_EOR#;

  13692  3 000141   501000 236007                    LDQ     -97792,DL
         3 000142   000007 552110                    STBQ    7,'10'O,PR0

     2202    13693    2           GETCMD.TREAD# = %YES#;

  13693  3 000143   200000 236003                    LDQ     65536,DU
         3 000144   000006 256100                    ORSQ    6,,PR0

     2203    13694    2           CALL XUG.ADAPT$$ (XT_PARAM, %XT#READ)

  13694  3 000145   000002 236000 4                  LDQ     2
         3 000146   200116 235100                    LDA     XT$,,AUTO
         3 000147   200256 757100                    STAQ    OUTPUT_WIDTH+2,,AUTO
         3 000150   200256 630500                    EPPR0   OUTPUT_WIDTH+2,,AUTO
         3 000151   100270 220100                    LDX0    184,,PR1
         3 000152   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000153   000000 701010                    TSX1    0,X0
         3 000154   000156 702000 3                  TSX2    s:13696
         3 000155   000165 710000 3                  TRA     s:13702

     2204    13695    3           WHENALTRETURN DO;

     2205    13696    3               IF XT_PARAM.ERR = XT#EOD
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:386  

  13696  3 000156   200116 470500                    LDP0    XT$,,AUTO
         3 000157   000001 236100                    LDQ     1,,PR0
         3 000160   000173 116000 0                  CMPQ    XT#EOD
         3 000161   000172 600000 3                  TZE     NORMAL_READ

     2206    13697    3               THEN
     2207    13698    3                   GOTO NORMAL_READ ;
     2208    13699    3               ERR = XT_PARAM.ERR;

  13699  3 000162   200005 471500                    LDP1    @ARS,,AUTO
         3 000163   100000 756100                    STQ     0,,PR1

     2209    13700    3               ALTRETURN;

  13700  3 000164   000000 702200 xent               TSX2  ! X66_AALT

     2210    13701    3           END;
     2211    13702    2           ARS = XT_PARAM.ARS;

  13702  3 000165   200116 470500                    LDP0    XT$,,AUTO
         3 000166   000007 235100                    LDA     7,,PR0
         3 000167   200005 471500                    LDP1    @ARS,,AUTO
         3 000170   100000 755100                    STA     0,,PR1

     2212    13703    2       END;

  13703  3 000171   000316 710000 3                  TRA     s:13740

     2213    13704    2       ELSE DO;

  13702  3 000172                       NORMAL_READ  null
     2214    13705    2   NORMAL_READ: ;
     2215    13706    2           IF GETCMD.READR$$ = ENTADDR(NIL)

  13706  3 000172   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000173   000032 236100                    LDQ     26,,PR0
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:387  
         3 000174   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 000175   000250 601000 3                  TNZ     s:13724

     2216    13707    3           THEN DO;

     2217    13708    3               FPT_READ = FPT_READ_C;

  13708  3 000176   000100 100400                    MLR     fill='000'O
         3 000177   000042 000070 0                  ADSC9   FPT_READ_C               cn=0,n=56
         3 000200   200120 000070                    ADSC9   FPT_READ,,AUTO           cn=0,n=56

     2218    13709    3               FPT_READ.V_ = VECTOR (FPT_READ.V);

  13709  3 000201   000003 235000 4                  LDA     3
         3 000202   200256 452500                    STP2    OUTPUT_WIDTH+2,,AUTO
         3 000203   200256 236100                    LDQ     OUTPUT_WIDTH+2,,AUTO
         3 000204   000130 036003                    ADLQ    88,DU
         3 000205   200120 757100                    STAQ    FPT_READ,,AUTO

     2219    13710    3               FPT_READ.V.DCB#=GETCMD.INDCB#;

  13710  3 000206   000012 720100                    LXL0    10,,PR0
         3 000207   200130 740100                    STX0    FPT_READ+8,,AUTO

     2220    13711    3               FPT_READ.BUF_=VECTOR(XUG.BUF);

  13711  3 000210   000004 235000 4                  LDA     4
         3 000211   200007 236100                    LDQ     XUG$,,AUTO
         3 000212   000300 036003                    ADLQ    192,DU
         3 000213   200124 757100                    STAQ    FPT_READ+4,,AUTO

     2221    13712    3               CALL M$READ(FPT_READ) ALTRET(BAD_READ);

  13712  3 000214   200120 630500                    EPPR0   FPT_READ,,AUTO
         3 000215   440000 713400                    CLIMB   alt,read
         3 000216   401400 401760                    pmme    nvectors=4
         3 000217   000602 702000 3                  TSX2    BAD_READ
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:388  

     2222    13713    3               OFFSET = BITBIN (XUG_IN$ -> F$DCB.DVBYTE.VFC#);

  13713  3 000220   200057 470500                    LDP0    XUG_IN$,,AUTO
         3 000221   000003 236100                    LDQ     3,,PR0
         3 000222   000041 772000                    QRL     33
         3 000223   000001 376007                    ANQ     1,DL
         3 000224   200054 756100                    STQ     OFFSET,,AUTO

     2223    13714    3               ARS=XUG_IN$->F$DCB.ARS# - OFFSET;

  13714  3 000225   000000 236100                    LDQ     0,,PR0
         3 000226   200054 136100                    SBLQ    OFFSET,,AUTO
         3 000227   200005 471500                    LDP1    @ARS,,AUTO
         3 000230   100000 756100                    STQ     0,,PR1

     2224    13715    3               GETCMD.EOMCHAR# = XUG_IN$ -> F$DCB.EOMCHAR#;

  13715  3 000231   200003 473500                    LDP3    @GETCMD,,AUTO
         3 000232   000003 236100                    LDQ     3,,PR0
         3 000233   000011 736000                    QLS     9
         3 000234   300007 552110                    STBQ    7,'10'O,PR3

     2225    13716    3               IF (NOT XUG_IN$->F$DCB.DDEV.IC#) OR

  13716  3 000235   000004 236100                    LDQ     4,,PR0
         3 000236   100000 316007                    CANQ    32768,DL
         3 000237   000242 600000 3                  TZE     s:13719
         3 000240   040000 316007                    CANQ    16384,DL
         3 000241   000245 600000 3                  TZE     s:13721

     2226    13717    3                 (XUG_IN$ -> F$DCB.DDEV.XEQ#)
     2227    13718    3               THEN
     2228    13719    3                   GETCMD.TREAD# = '0'B ;

  13719  3 000242   000005 236000 4                  LDQ     5
         3 000243   300006 356100                    ANSQ    6,,PR3
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:389  
         3 000244   000316 710000 3                  TRA     s:13740

     2229    13720    3               ELSE
     2230    13721    3                   GETCMD.TREAD# = '1'B ;

  13721  3 000245   200000 236003                    LDQ     65536,DU
         3 000246   300006 256100                    ORSQ    6,,PR3

     2231    13722    3           END;

  13722  3 000247   000316 710000 3                  TRA     s:13740

     2232    13723    3           ELSE DO;

     2233    13724    3               T_ERR = '0'B ;

  13724  3 000250   200055 450100                    STZ     T_ERR,,AUTO

     2234    13725    3               READR_EXISTS = '1'B;

  13725  3 000251   400000 236003                    LDQ     -131072,DU
         3 000252   200114 756100                    STQ     READR_EXISTS,,AUTO

     2235    13726                                                /* GETCMD.READR$$ routine must
     2236    13727                                                    maintain GETCMD.TREAD#           */
     2237    13728    3               CALL GETCMD.READR$$ (VECTOR(XUG.BUF), ARS, GETCMD.READR$$, T_ERR,

  13728  3 000253   000004 235000 4                  LDA     4
         3 000254   200007 236100                    LDQ     XUG$,,AUTO
         3 000255   000300 036003                    ADLQ    192,DU
         3 000256   200256 757100                    STAQ    OUTPUT_WIDTH+2,,AUTO
         3 000257   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000260   000006 036000 4                  ADLQ    6
         3 000261   200264 756100                    STQ     OUTPUT_WIDTH+8,,AUTO
         3 000262   200055 631500                    EPPR1   T_ERR,,AUTO
         3 000263   200263 451500                    STP1    OUTPUT_WIDTH+7,,AUTO
         3 000264   200003 236100                    LDQ     @GETCMD,,AUTO
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:390  
         3 000265   000032 036003                    ADLQ    26,DU
         3 000266   200262 756100                    STQ     OUTPUT_WIDTH+6,,AUTO
         3 000267   200005 236100                    LDQ     @ARS,,AUTO
         3 000270   200261 756100                    STQ     OUTPUT_WIDTH+5,,AUTO
         3 000271   200256 633500                    EPPR3   OUTPUT_WIDTH+2,,AUTO
         3 000272   200260 453500                    STP3    OUTPUT_WIDTH+4,,AUTO
         3 000273   200260 630500                    EPPR0   OUTPUT_WIDTH+4,,AUTO
         3 000274   200003 474500                    LDP4    @GETCMD,,AUTO
         3 000275   400032 220100                    LDX0    26,,PR4
         3 000276   000023 631400 xsym               EPPR1   B_VECTNIL+19
         3 000277   000000 701010                    TSX1    0,X0
         3 000300   000302 702000 3                  TSX2    s:13731
         3 000301   000306 710000 3                  TRA     s:13734

     2238    13729    3                 GETCMD.EOMCHAR#)
     2239    13730    4               WHENALTRETURN DO ;

     2240    13731    4                   ERR = T_ERR ;

  13731  3 000302   200055 236100                    LDQ     T_ERR,,AUTO
         3 000303   200005 470500                    LDP0    @ARS,,AUTO
         3 000304   000000 756100                    STQ     0,,PR0

     2241    13732    4                   GOTO READ_ALT ;

  13732  3 000305   000607 710000 3                  TRA     READ_ALT

     2242    13733    4               END ;                  /* Whenaltreturn Do */
     2243    13734    3               OFFSET = 0 ;

  13734  3 000306   200054 450100                    STZ     OFFSET,,AUTO

     2244    13735    3               XUG.POFF = 0 ;

  13735  3 000307   200007 470500                    LDP0    XUG$,,AUTO
         3 000310   000036 450100                    STZ     30,,PR0

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:391  
     2245    13736    3               XUG.PROMPT = ' ' ;

  13736  3 000311   040100 100400                    MLR     fill='040'O
         3 000312   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000313   000037 000136                    ADSC9   31,,PR0                  cn=0,n=94

     2246    13737    3               XUG.PROMPT_VFC = %NO# ;

  13737  3 000314   000007 236000 4                  LDQ     7
         3 000315   000071 356100                    ANSQ    57,,PR0

     2247    13738    3           END;

     2248    13739    2       END;

     2249    13740    1       IF (NOT GETCMD.SKIP_PREPROCESS#) AND XUG.PREPROCESS

  13740  3 000316   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000317   000006 236100                    LDQ     6,,PR0
         3 000320   004000 316003                    CANQ    2048,DU
         3 000321   000351 601000 3                  TNZ     s:13749
         3 000322   200007 471500                    LDP1    XUG$,,AUTO
         3 000323   100071 236100                    LDQ     57,,PR1
         3 000324   002000 316003                    CANQ    1024,DU
         3 000325   000351 600000 3                  TZE     s:13749

     2250    13741    2       THEN DO;

     2251    13742    2           IF XUG.PREPROCESSOR$$ ~= ENTADDR(NIL)

  13742  3 000326   100023 236100                    LDQ     19,,PR1
         3 000327   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 000330   000341 600000 3                  TZE     s:13746

     2252    13743    2           THEN
     2253    13744    2               CALL XUG$PRE_PROCESSOR (GETCMD,ARS);

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:392  
  13744  3 000331   200005 236100                    LDQ     @ARS,,AUTO
         3 000332   200003 235100                    LDA     @GETCMD,,AUTO
         3 000333   200256 757100                    STAQ    OUTPUT_WIDTH+2,,AUTO
         3 000334   200256 630500                    EPPR0   OUTPUT_WIDTH+2,,AUTO
         3 000335   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000336   000000 701000 xent               TSX1    XUG$PRE_PROCESSOR
         3 000337   000000 011000                    NOP     0
         3 000340   000353 710000 3                  TRA     s:13750

     2254    13745    2           ELSE
     2255    13746    2               CALL XUG$PP_CMDVARS (GETCMD,ARS);

  13746  3 000341   200005 236100                    LDQ     @ARS,,AUTO
         3 000342   200003 235100                    LDA     @GETCMD,,AUTO
         3 000343   200256 757100                    STAQ    OUTPUT_WIDTH+2,,AUTO
         3 000344   200256 630500                    EPPR0   OUTPUT_WIDTH+2,,AUTO
         3 000345   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000346   000000 701000 xent               TSX1    XUG$PP_CMDVARS
         3 000347   000000 011000                    NOP     0

     2256    13747    2       END;

  13747  3 000350   000353 710000 3                  TRA     s:13750

     2257    13748    1       ELSE
     2258    13749    1           GETCMD.SKIP_PREPROCESS# = '0'B ;

  13749  3 000351   000010 236000 4                  LDQ     8
         3 000352   000006 356100                    ANSQ    6,,PR0

     2259    13750    1       IF NOT READR_EXISTS

  13750  3 000353   200114 234100                    SZN     READR_EXISTS,,AUTO
         3 000354   000414 604000 3                  TMI     s:13762
         3 000355   200007 470500                    LDP0    XUG$,,AUTO
         3 000356   000266 236100                    LDQ     182,,PR0
         3 000357   040000 316007                    CANQ    16384,DL
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:393  
         3 000360   000414 601000 3                  TNZ     s:13762
         3 000361   200005 471500                    LDP1    @ARS,,AUTO
         3 000362   100000 236100                    LDQ     0,,PR1
         3 000363   000036 116100                    CMPQ    30,,PR0
         3 000364   000414 604000 3                  TMI     s:13762
         3 000365   000036 720100                    LXL0    30,,PR0
         3 000366   000071 236100                    LDQ     57,,PR0
         3 000367   000024 772000                    QRL     20
         3 000370   000001 376007                    ANQ     1,DL
         3 000371   000036 721100                    LXL1    30,,PR0
         3 000372   200054 235100                    LDA     OFFSET,,AUTO
         3 000373   040146 106545                    CMPC    fill='040'O
         3 000374   000300 000010                    ADSC9   192,A,PR0                cn=0,n=*X0
         3 000375   000037 000011                    ADSC9   31,Q,PR0                 cn=0,n=*X1
         3 000376   000414 601000 3                  TNZ     s:13762

     2260    13751    1         AND NOT XUG.DONT_STRIP_PROMPT
     2261    13752    1         AND ARS>=XUG.POFF
     2262    13753    1         AND SUBSTR(XUG.BUF,OFFSET,XUG.POFF) =
     2263    13754    1         SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),XUG.POFF)
     2264    13755    2       THEN DO;

     2265    13756    2           GETCMD.RCVD_PROMPT# = '1'B ;

  13756  3 000377   200003 473500                    LDP3    @GETCMD,,AUTO
         3 000400   020000 236003                    LDQ     8192,DU
         3 000401   300006 256100                    ORSQ    6,,PR3

     2266    13757    2           OFFSET = OFFSET + XUG.POFF ;

  13757  3 000402   200054 236100                    LDQ     OFFSET,,AUTO
         3 000403   000036 036100                    ADLQ    30,,PR0
         3 000404   200054 756100                    STQ     OFFSET,,AUTO

     2267    13758               /* just in case there was a pre-processor error already ... */
     2268    13759    2           XUG.P_PCB$->P_PCB.HI_CHAR = XUG.P_PCB$->P_PCB.HI_CHAR - XUG.POFF;

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:394  
  13759  3 000405   000072 474500                    LDP4    58,,PR0
         3 000406   400012 236100                    LDQ     10,,PR4
         3 000407   000036 136100                    SBLQ    30,,PR0
         3 000410   400012 756100                    STQ     10,,PR4

     2269    13760    2           ARS = ARS - XUG.POFF ;

  13760  3 000411   100000 236100                    LDQ     0,,PR1
         3 000412   000036 136100                    SBLQ    30,,PR0
         3 000413   100000 756100                    STQ     0,,PR1

     2270    13761    2       END ; /* Then Do */

     2271    13762    1       VBASE(XUG.LAST) = VBASE(CMDBUF) ;

  13762  3 000414   200004 470500                    LDP0    @CMDBUF,,AUTO
         3 000415   000001 236100                    LDQ     1,,PR0
         3 000416   200007 471500                    LDP1    XUG$,,AUTO
         3 000417   100005 756100                    STQ     5,,PR1

     2272    13763    1       IF ARS = 0

  13763  3 000420   200005 473500                    LDP3    @ARS,,AUTO
         3 000421   300000 235100                    LDA     0,,PR3
         3 000422   000440 601000 3                  TNZ     s:13771

     2273    13764    1       THEN
     2274    13765    2       DO ;

     2275    13766    2           VBOUND(XUG.LAST)=ARS ;

  13766  3 000423   300000 236100                    LDQ     0,,PR3
         3 000424   000020 736000                    QLS     16
         3 000425   100004 676100                    ERQ     4,,PR1
         3 000426   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000427   100004 656100                    ERSQ    4,,PR1

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:395  
     2276    13767    2           CSIZE = 1 ;

  13767  3 000430   000001 235007                    LDA     1,DL
         3 000431   200115 755100                    STA     CSIZE,,AUTO

     2277    13768    2           VBASE(XUG.LAST) -> VCHARBASE = ' ' ;

  13768  3 000432   100005 474500                    LDP4    5,,PR1
         3 000433   000000 620005                    EAX0    0,AL
         3 000434   040140 100400                    MLR     fill='040'O
         3 000435   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000436   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

     2278    13769    2       END ; /* Then Do */

  13769  3 000437   000446 710000 3                  TRA     s:13772

     2279    13770    1       ELSE
     2280    13771    1           VBOUND(XUG.LAST)=ARS-1;

  13771  3 000440   300000 236100                    LDQ     0,,PR3
         3 000441   000001 136007                    SBLQ    1,DL
         3 000442   000020 736000                    QLS     16
         3 000443   100004 676100                    ERQ     4,,PR1
         3 000444   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000445   100004 656100                    ERSQ    4,,PR1

     2281    13772    1       IF ARS + 1 > VBOUND(CMDBUF)            /* leave 1 extra space for a blank */

  13772  3 000446   000000 236100                    LDQ     0,,PR0
         3 000447   000020 772000                    QRL     16
         3 000450   300000 116100                    CMPQ    0,,PR3
         3 000451   000456 605400 3                  TPNZ    s:13776

     2282    13773    2       THEN DO;

     2283    13774    2           CALL XUG$MOREMEM(GETCMD) ALTRET(READ_ALT) ;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:396  

  13774  3 000452   200003 630500                    EPPR0   @GETCMD,,AUTO
         3 000453   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000454   000000 701000 xent               TSX1    XUG$MOREMEM
         3 000455   000607 702000 3                  TSX2    READ_ALT

     2284    13775    2       END;

     2285    13776    1       BUFFER = SUBSTR (XUG.BUF , OFFSET , ARS);

  13776  3 000456   200005 470500                    LDP0    @ARS,,AUTO
         3 000457   000000 720100                    LXL0    0,,PR0
         3 000460   200256 740100                    STX0    OUTPUT_WIDTH+2,,AUTO
         3 000461   200007 471500                    LDP1    XUG$,,AUTO
         3 000462   200054 235100                    LDA     OFFSET,,AUTO
         3 000463   200006 473500                    LDP3    CMDBUF$,,AUTO
         3 000464   200256 221100                    LDX1    OUTPUT_WIDTH+2,,AUTO
         3 000465   040140 100545                    MLR     fill='040'O
         3 000466   100300 000010                    ADSC9   192,A,PR1                cn=0,n=*X0
         3 000467   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1

     2286    13777    1       CALL MOVE_CMD;

  13777  3 000470   000751 701000 3                  TSX1    MOVE_CMD
         3 000471   000000 011000                    NOP     0

     2287    13778    1       IF XUG.REQ_PROMPT AND NOT GETCMD.RCVD_PROMPT#

  13778  3 000472   200007 470500                    LDP0    XUG$,,AUTO
         3 000473   000071 430100                    FSZN    57,,PR0
         3 000474   000504 605000 3                  TPL     s:13788
         3 000475   200003 471500                    LDP1    @GETCMD,,AUTO
         3 000476   100006 236100                    LDQ     6,,PR1
         3 000477   020000 316003                    CANQ    8192,DU
         3 000500   000504 601000 3                  TNZ     s:13788

     2288    13779    1       THEN
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:397  
     2289    13780    2       DO ;

     2290    13781    2           GETCMD.ERR# = XUG#NO_PROMPT;

  13781  3 000501   000172 236000 0                  LDQ     XUG#NO_PROMPT
         3 000502   100001 756100                    STQ     1,,PR1

     2291    13782    2           GOTO READ_ALT ;

  13782  3 000503   000607 710000 3                  TRA     READ_ALT

     2292    13783    2       END ;                        /* Then Do */
     2293    13784        /*E*  ERROR:  XUG-E$XUG#NO_PROMPT
     2294    13785              MESSAGE0: No prompt received.
     2295    13786              MESSAGE1: No prompt received when one was required.
     2296    13787        */
     2297    13788    1       IF READR_EXISTS AND GETCMD.TREAD#

  13788  3 000504   200114 234100                    SZN     READR_EXISTS,,AUTO
         3 000505   000513 605000 3                  TPL     s:13791
         3 000506   200003 471500                    LDP1    @GETCMD,,AUTO
         3 000507   100006 236100                    LDQ     6,,PR1
         3 000510   200000 316003                    CANQ    65536,DU
         3 000511   000513 600000 3                  TZE     s:13791

     2298    13789    1       THEN
     2299    13790    1           RETURN ;

  13790  3 000512   000000 702200 xent               TSX2  ! X66_ARET

     2300    13791    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, GETCMD.OUTDCB#);

  13791  3 000513   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000514   000013 036003                    ADLQ    11,DU
         3 000515   200003 235100                    LDA     @GETCMD,,AUTO
         3 000516   200256 757100                    STAQ    OUTPUT_WIDTH+2,,AUTO
         3 000517   200256 630500                    EPPR0   OUTPUT_WIDTH+2,,AUTO
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:398  
         3 000520   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000521   000000 701000 xent               TSX1    XUG$OPENOUT_INTERNAL
         3 000522   000000 011000                    NOP     0

     2301    13792    1       IF (GETCMD.TREAD# AND DCBADDR(GETCMD.OUTDCB#)->F$DCB.DDEV.UCOUT#)

  13792  3 000523   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000524   000006 236100                    LDQ     6,,PR0
         3 000525   200000 316003                    CANQ    65536,DU
         3 000526   000536 600000 3                  TZE     s:13792+11
         3 000527   000000 471400 4                  LDP1    0
         3 000530   100000 473500                    LDP3    0,,PR1
         3 000531   000013 720100                    LXL0    11,,PR0
         3 000532   300000 474510                    LDP4    0,X0,PR3
         3 000533   400004 236100                    LDQ     4,,PR4
         3 000534   020000 316007                    CANQ    8192,DL
         3 000535   000560 601000 3                  TNZ     s:13797
         3 000536   000000 471400 4                  LDP1    0
         3 000537   100000 473500                    LDP3    0,,PR1
         3 000540   000012 720100                    LXL0    10,,PR0
         3 000541   300000 474510                    LDP4    0,X0,PR3
         3 000542   400003 236100                    LDQ     3,,PR4
         3 000543   020000 316003                    CANQ    8192,DU
         3 000544   000560 601000 3                  TNZ     s:13797
         3 000545   000007 236100                    LDQ     7,,PR0
         3 000546   000600 376003                    ANQ     384,DU
         3 000547   000400 116003                    CMPQ    256,DU
         3 000550   000560 600000 3                  TZE     s:13797
         3 000551   000007 236100                    LDQ     7,,PR0
         3 000552   000600 316003                    CANQ    384,DU
         3 000553   000561 601000 3                  TNZ     s:13798
         3 000554   000000 475400 xsym               LDP5    B$JIT$
         3 000555   500143 236100                    LDQ     99,,PR5
         3 000556   000012 376000 xsym               ANQ     B_VECTNIL+10
         3 000557   000561 601000 3                  TNZ     s:13798

     2302    13793    1         OR DCBADDR(GETCMD.INDCB#)->F$DCB.DVBYTE.TRANS#
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:399  
     2303    13794    1         OR (GETCMD.ECHO = %NEVER_ECHO#)
     2304    13795    1         OR (GETCMD.ECHO = %HONOR_FLAG# AND NOT (B$JIT.CPFLAGS1 & %CP_ECHO#))
     2305    13796    1       THEN
     2306    13797    1           RETURN;

  13797  3 000560   000000 702200 xent               TSX2  ! X66_ARET

     2307    13798    1       IF GETCMD.PASS ~= %LEAVE_PASS#

  13798  3 000561   000007 236100                    LDQ     7,,PR0
         3 000562   000140 316003                    CANQ    96,DU
         3 000563   000570 600000 3                  TZE     s:13804

     2308    13799    1       THEN
     2309    13800    2       DO ;

     2310    13801    2           XUG.NEED_ECHO = '1'B ;

  13801  3 000564   200007 475500                    LDP5    XUG$,,AUTO
         3 000565   000020 236003                    LDQ     16,DU
         3 000566   500071 256100                    ORSQ    57,,PR5

     2311    13802    2           RETURN ;

  13802  3 000567   000000 702200 xent               TSX2  ! X66_ARET

     2312    13803    2       END ;                        /* Then Do */
     2313    13804    1       FPT_WRITE.V.DCB#=GETCMD.OUTDCB#;

  13804  3 000570   000013 721100                    LXL1    11,,PR0
         3 000571   200146 741100                    STX1    FPT_WRITE+8,,AUTO

     2314    13805    1       CALL WRITE_CMD_WRAPPED;

  13805  3 000572   001070 701000 3                  TSX1    WRITE_CMD_WRAPPED
         3 000573   000000 011000                    NOP     0

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:400  
     2315    13806    1       XUG.NDCBS=1;

  13806  3 000574   000001 235007                    LDA     1,DL
         3 000575   200007 470500                    LDP0    XUG$,,AUTO
         3 000576   000112 755100                    STA     74,,PR0

     2316    13807    1       XUG.DCBS.ERRPTR_CPOS(1) = -1;

  13807  3 000577   777777 220003                    LDX0    -1,DU
         3 000600   000115 440100                    SXL0    77,,PR0

     2317    13808    1       RETURN;

  13808  3 000601   000000 702200 xent               TSX2  ! X66_ARET

  13807  3 000602                       BAD_READ     null
     2318    13809        /**/
     2319    13810    1   BAD_READ:;
     2320    13811    1       ERR=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  13811  3 000602   000000 470400 xsym               LDP0    B$TCB$
         3 000603   000000 471500                    LDP1    0,,PR0
         3 000604   100102 236100                    LDQ     66,,PR1
         3 000605   200005 473500                    LDP3    @ARS,,AUTO
         3 000606   300000 756100                    STQ     0,,PR3

     2321    13812    1   READ_ALT:
     2322    13813    1       ALTRETURN;

  13813  3 000607   000000 702200 xent  READ_ALT     TSX2  ! X66_AALT

     2323    13814        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:401  
     2324    13815    1   XUG$CORRES_COMMON: ENTRY(GETCMD,CMDBUF) ALTRET;

  13815  3 000610   000000 700200 xent  XUG$CORRES_* TSX0  ! X66_AUTO_3
         3 000611   000266 000003                    ZERO    182,3

     2325    13816    1       DCB$ = ADDR(GETCMD) ;

  13816  3 000612   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000613   200056 756100                    STQ     DCB$,,AUTO

     2326    13817    1       CALL OPEN (DCB$NUM);

  13817  3 000614   200251 756100                    STQ     FPT_OPEN+59,,AUTO
         3 000615   001202 701000 3                  TSX1    OPEN
         3 000616   000000 011000                    NOP     0

     2327    13818    1       CALL OPEN (CHARPOS.N);

  13818  3 000617   200004 236100                    LDQ     @CMDBUF,,AUTO
         3 000620   200251 756100                    STQ     FPT_OPEN+59,,AUTO
         3 000621   001202 701000 3                  TSX1    OPEN
         3 000622   000000 011000                    NOP     0

     2328    13819    1       FPT_CORRES = FPT_CORRES_C;

  13819  3 000623   000100 100400                    MLR     fill='000'O
         3 000624   000074 000020 0                  ADSC9   FPT_CORRES_C             cn=0,n=16
         3 000625   200152 000020                    ADSC9   FPT_CORRES,,AUTO         cn=0,n=16

     2329    13820    1       FPT_CORRES.V_ = VECTOR (FPT_CORRES.V);

  13820  3 000626   000011 235000 4                  LDA     9
         3 000627   200256 452500                    STP2    OUTPUT_WIDTH+2,,AUTO
         3 000630   200256 236100                    LDQ     OUTPUT_WIDTH+2,,AUTO
         3 000631   000154 036003                    ADLQ    108,DU
         3 000632   200152 757100                    STAQ    FPT_CORRES,,AUTO

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:402  
     2330    13821    1       FPT_CORRES.V.DCB1#=DCB$NUM ;

  13821  3 000633   200056 470500                    LDP0    DCB$,,AUTO
         3 000634   000000 720100                    LXL0    0,,PR0
         3 000635   200154 740100                    STX0    FPT_CORRES+2,,AUTO

     2331    13822    1       FPT_CORRES.V.DCB2#=CHARPOS.N ;

  13822  3 000636   200004 471500                    LDP1    @CMDBUF,,AUTO
         3 000637   100000 721100                    LXL1    0,,PR1
         3 000640   200154 441100                    SXL1    FPT_CORRES+2,,AUTO

     2332    13823    1       CALL M$CORRES(FPT_CORRES) ALTRET(CORRES);

  13823  3 000641   200152 630500                    EPPR0   FPT_CORRES,,AUTO
         3 000642   460000 713400                    CLIMB   alt,+24576
         3 000643   400000 401760                    pmme    nvectors=1
         3 000644   000646 702000 3                  TSX2    CORRES

     2333    13824    1       RETURN;

  13824  3 000645   000000 702200 xent               TSX2  ! X66_ARET

     2334    13825    1   CORRES: ALTRETURN;

  13825  3 000646   000000 702200 xent  CORRES       TSX2  ! X66_AALT

     2335    13826        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:403  
     2336    13827    1   XUG$ECHOLAST_COMMON: ENTRY(GETCMD) ALTRET;

  13827  3 000647   000000 700200 xent  XUG$ECHOLAS* TSX0  ! X66_AUTO_3
         3 000650   000266 000003                    ZERO    182,3

     2337    13828    1       XUG$ = GETCMD.WORK$ ;

  13828  3 000651   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000652   000004 236100                    LDQ     4,,PR0
         3 000653   200007 756100                    STQ     XUG$,,AUTO

     2338    13829    1       CALL MOVE_CMD;

  13829  3 000654   000751 701000 3                  TSX1    MOVE_CMD
         3 000655   000000 011000                    NOP     0

     2339    13830    1       IF GETCMD.DCB_PARAM# = DCBNUM( NIL )

  13830  3 000656   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000657   000014 235100                    LDA     12,,PR0
         3 000660   000663 601000 3                  TNZ     s:13833

     2340    13831    1       THEN
     2341    13832    1           GETCMD.DCB_PARAM# = GETCMD.OUTDCB# ;

  13832  3 000661   000013 235100                    LDA     11,,PR0
         3 000662   000014 755100                    STA     12,,PR0

     2342    13833    1       IF GETCMD.DCB_PARAM# = DCBNUM(NIL)

  13833  3 000663   000703 601000 3                  TNZ     s:13840

     2343    13834    1       THEN
     2344    13835    1           CALL XUG$GETDCB_COMMON(M$LO,GETCMD.DCB_PARAM#) WHENALTRETURN

  13835  3 000664   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000665   000014 036003                    ADLQ    12,DU
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:404  
         3 000666   000012 235000 4                  LDA     10
         3 000667   200256 757100                    STAQ    OUTPUT_WIDTH+2,,AUTO
         3 000670   200256 630500                    EPPR0   OUTPUT_WIDTH+2,,AUTO
         3 000671   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000672   000000 701000 xent               TSX1    XUG$GETDCB_COMMON
         3 000673   000675 702000 3                  TSX2    s:13837
         3 000674   000703 710000 3                  TRA     s:13840

     2345    13836    2           DO ;

     2346    13837    2               GETCMD.ERR# = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR ;

  13837  3 000675   000000 470400 xsym               LDP0    B$TCB$
         3 000676   000000 471500                    LDP1    0,,PR0
         3 000677   100102 236100                    LDQ     66,,PR1
         3 000700   200003 473500                    LDP3    @GETCMD,,AUTO
         3 000701   300001 756100                    STQ     1,,PR3

     2347    13838    2               GOTO CORRES ;

  13838  3 000702   000646 710000 3                  TRA     CORRES

     2348    13839    2           END ;                     /* Whenaltreturn Do */
     2349    13840    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, GETCMD.DCB_PARAM#);

  13840  3 000703   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000704   000014 036003                    ADLQ    12,DU
         3 000705   200003 235100                    LDA     @GETCMD,,AUTO
         3 000706   200256 757100                    STAQ    OUTPUT_WIDTH+2,,AUTO
         3 000707   200256 630500                    EPPR0   OUTPUT_WIDTH+2,,AUTO
         3 000710   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000711   000000 701000 xent               TSX1    XUG$OPENOUT_INTERNAL
         3 000712   000000 011000                    NOP     0

     2350    13841    1       FPT_WRITE.V.DCB#=GETCMD.DCB_PARAM# ;

  13841  3 000713   200003 470500                    LDP0    @GETCMD,,AUTO
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:405  
         3 000714   000014 720100                    LXL0    12,,PR0
         3 000715   200146 740100                    STX0    FPT_WRITE+8,,AUTO

     2351    13842    1       CALL WRITE_CMD_WRAPPED;

  13842  3 000716   001070 701000 3                  TSX1    WRITE_CMD_WRAPPED
         3 000717   000000 011000                    NOP     0

     2352    13843    1       RETURN;

  13843  3 000720   000000 702200 xent               TSX2  ! X66_ARET

     2353    13844        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:406  
     2354    13845    1   XUG$SETLAST: ENTRY(GETCMD) ALTRET;

  13845  3 000721   000000 700200 xent  XUG$SETLAST  TSX0  ! X66_AUTO_3
         3 000722   000266 000003                    ZERO    182,3

     2355    13846    1       IF GETCMD.WORK$ = ADDR(NIL)

  13846  3 000723   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000724   000004 236100                    LDQ     4,,PR0
         3 000725   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000726   000742 601000 3                  TNZ     s:13852

     2356    13847    1       THEN
     2357    13848    2       DO ;

     2358    13849    2           XUG_INIT_A = XUG_INIT_C ;

  13849  3 000727   000100 100400                    MLR     fill='000'O
         3 000730   000000 000220 xsym               ADSC9   XUG_INIT_C               cn=0,n=144
         3 000731   200010 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

     2359    13850    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) ALTRET (BAD_READ);

  13850  3 000732   200010 631500                    EPPR1   XUG_INIT_A,,AUTO
         3 000733   200257 451500                    STP1    OUTPUT_WIDTH+3,,AUTO
         3 000734   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000735   200256 756100                    STQ     OUTPUT_WIDTH+2,,AUTO
         3 000736   200256 630500                    EPPR0   OUTPUT_WIDTH+2,,AUTO
         3 000737   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000740   000000 701000 xent               TSX1    XUG$INIT_COMMON
         3 000741   000602 702000 3                  TSX2    BAD_READ

     2360    13851    2       END ; /* Then Do */

     2361    13852    1       XUG$ = GETCMD.WORK$ ;

  13852  3 000742   200003 470500                    LDP0    @GETCMD,,AUTO
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:407  
         3 000743   000004 236100                    LDQ     4,,PR0
         3 000744   200007 756100                    STQ     XUG$,,AUTO

     2362    13853    1       XUG.LAST=XUG.READVEC ;

  13853  3 000745   200007 471500                    LDP1    XUG$,,AUTO
         3 000746   100002 237100                    LDAQ    2,,PR1
         3 000747   100004 757100                    STAQ    4,,PR1

     2363    13854    1       RETURN;

  13854  3 000750   000000 702200 xent               TSX2  ! X66_ARET

     2364    13855        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:408  
     2365    13856    1   MOVE_CMD: PROC;

  13856  3 000751   200250 741300       MOVE_CMD     STX1  ! FPT_OPEN+58,,AUTO

     2366    13857    2       FPT_WRITE = FPT_WRITE_C;

  13857  3 000752   000100 100400                    MLR     fill='000'O
         3 000753   000060 000060 0                  ADSC9   FPT_WRITE_C              cn=0,n=48
         3 000754   200136 000060                    ADSC9   FPT_WRITE,,AUTO          cn=0,n=48

     2367    13858    2       FPT_WRITE.V_ = VECTOR (FPT_WRITE.V);

  13858  3 000755   000013 235000 4                  LDA     11
         3 000756   200256 452500                    STP2    OUTPUT_WIDTH+2,,AUTO
         3 000757   200256 236100                    LDQ     OUTPUT_WIDTH+2,,AUTO
         3 000760   000146 036003                    ADLQ    102,DU
         3 000761   200136 757100                    STAQ    FPT_WRITE,,AUTO

     2368    13859    2       IF GETCMD.RPROMPT_~=VECTOR(NIL) AND

  13859  3 000762   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000763   000000 106500                    CMPC    fill='000'O
         3 000764   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         3 000765   000014 000010 4                  ADSC9   12                       cn=0,n=8
         3 000766   001014 600000 3                  TZE     s:13868
         3 000767   000000 106500                    CMPC    fill='000'O
         3 000770   000027 000010                    ADSC9   23,,PR0                  cn=0,n=8
         3 000771   000016 000010 4                  ADSC9   14                       cn=0,n=8
         3 000772   001014 600000 3                  TZE     s:13868

     2369    13860    2         GETCMD.RPROMPT_~=VECTOR(ERASE)
     2370    13861    3       THEN DO;

     2371    13862    3           POFF = VBOUND(GETCMD.RPROMPT_)+1 ;

  13862  3 000773   000027 236100                    LDQ     23,,PR0
         3 000774   000020 772000                    QRL     16
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:409  
         3 000775   000001 036007                    ADLQ    1,DL
         3 000776   200063 756100                    STQ     POFF,,AUTO

     2372    13863    3           CSIZE = POFF ;

  13863  3 000777   200115 756100                    STQ     CSIZE,,AUTO

     2373    13864    3           PROMPT_BUF = VBASE(GETCMD.RPROMPT_) -> VCHARBASE ;

  13864  3 001000   000030 471500                    LDP1    24,,PR0
         3 001001   000000 620006                    EAX0    0,QL
         3 001002   040100 100540                    MLR     fill='040'O
         3 001003   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         3 001004   200064 000136                    ADSC9   PROMPT_BUF,,AUTO         cn=0,n=94

     2374    13865    3           FPT_WRITE.V.DVBYTE.VFC# = XUG.PROMPT_VFC ;

  13865  3 001005   200007 473500                    LDP3    XUG$,,AUTO
         3 001006   300071 236100                    LDQ     57,,PR3
         3 001007   000015 736000                    QLS     13
         3 001010   200151 676100                    ERQ     FPT_WRITE+11,,AUTO
         3 001011   100000 376003                    ANQ     32768,DU
         3 001012   200151 656100                    ERSQ    FPT_WRITE+11,,AUTO

     2375    13866    3       END ;

  13866  3 001013   001026 710000 3                  TRA     s:13871

     2376    13867    3       ELSE DO;

     2377    13868    3           POFF = XUG.POFF;

  13868  3 001014   200007 471500                    LDP1    XUG$,,AUTO
         3 001015   100036 235100                    LDA     30,,PR1
         3 001016   200063 755100                    STA     POFF,,AUTO

     2378    13869    3           PROMPT_BUF = SUBSTR(XUG.PROMPT,BITBIN(XUG.PROMPT_VFC),POFF);
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:410  

  13869  3 001017   100071 236100                    LDQ     57,,PR1
         3 001020   000024 772000                    QRL     20
         3 001021   000001 376007                    ANQ     1,DL
         3 001022   000000 620005                    EAX0    0,AL
         3 001023   040100 100546                    MLR     fill='040'O
         3 001024   100037 000010                    ADSC9   31,Q,PR1                 cn=0,n=*X0
         3 001025   200064 000136                    ADSC9   PROMPT_BUF,,AUTO         cn=0,n=94

     2379    13870    3       END;

     2380    13871    2       SUBSTR (XUG.BUF , 0 , POFF) = PROMPT_BUF;

  13871  3 001026   200007 471500                    LDP1    XUG$,,AUTO
         3 001027   200063 720100                    LXL0    POFF,,AUTO
         3 001030   040140 100500                    MLR     fill='040'O
         3 001031   200064 000136                    ADSC9   PROMPT_BUF,,AUTO         cn=0,n=94
         3 001032   100300 000010                    ADSC9   192,,PR1                 cn=0,n=*X0

     2381    13872    2       SUBSTR (XUG.BUF , POFF , VBOUND(XUG.LAST) + 1) = VBASE(XUG.LAST) -> CHARBASE;

  13872  3 001033   100004 236100                    LDQ     4,,PR1
         3 001034   000020 772000                    QRL     16
         3 001035   000001 622006                    EAX2    1,QL
         3 001036   100005 473500                    LDP3    5,,PR1
         3 001037   200063 235100                    LDA     POFF,,AUTO
         3 001040   040145 100500                    MLR     fill='040'O
         3 001041   300000 000454                    ADSC9   0,,PR3                   cn=0,n=300
         3 001042   100300 000012                    ADSC9   192,A,PR1                cn=0,n=*X2

     2382    13873    2       FPT_WRITE = FPT_WRITE_C;

  13873  3 001043   000100 100400                    MLR     fill='000'O
         3 001044   000060 000060 0                  ADSC9   FPT_WRITE_C              cn=0,n=48
         3 001045   200136 000060                    ADSC9   FPT_WRITE,,AUTO          cn=0,n=48

     2383    13874    2       FPT_WRITE.V_ = VECTOR (FPT_WRITE.V);
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:411  

  13874  3 001046   000013 235000 4                  LDA     11
         3 001047   200256 452500                    STP2    OUTPUT_WIDTH+2,,AUTO
         3 001050   200256 236100                    LDQ     OUTPUT_WIDTH+2,,AUTO
         3 001051   000146 036003                    ADLQ    102,DU
         3 001052   200136 757100                    STAQ    FPT_WRITE,,AUTO

     2384    13875    2       FPT_WRITE.BUF_=VECTOR(XUG.BUF);

  13875  3 001053   000004 235000 4                  LDA     4
         3 001054   200007 236100                    LDQ     XUG$,,AUTO
         3 001055   000300 036003                    ADLQ    192,DU
         3 001056   200142 757100                    STAQ    FPT_WRITE+4,,AUTO

     2385    13876    2       FPT_WRITE.BUF_.BOUND=POFF+VBOUND(XUG.LAST);

  13876  3 001057   100004 236100                    LDQ     4,,PR1
         3 001060   000020 772000                    QRL     16
         3 001061   200063 036100                    ADLQ    POFF,,AUTO
         3 001062   000020 736000                    QLS     16
         3 001063   200142 676100                    ERQ     FPT_WRITE+4,,AUTO
         3 001064   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 001065   200142 656100                    ERSQ    FPT_WRITE+4,,AUTO

     2386    13877    2       RETURN;

  13877  3 001066   200250 221300                    LDX1  ! FPT_OPEN+58,,AUTO
         3 001067   000001 702211                    TSX2  ! 1,X1

     2387    13878    2   END MOVE_CMD;
     2388    13879        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:412  
     2389    13880    1   WRITE_CMD_WRAPPED: PROC;

  13880  3 001070   200250 741300       WRITE_CMD_W* STX1  ! FPT_OPEN+58,,AUTO

     2390    13881    2   DCL CHUNK_SIZE SBIN;
     2391    13882    2   DCL OFFSET SBIN;
     2392    13883    2   DCL OUTPUT_COUNT SBIN;
     2393    13884    2   DCL OUTPUT_STRING CHAR (OUTPUT_COUNT) BASED (FPT_WRITE.BUF_.BUF$);
     2394    13885    2   DCL OUTPUT_WIDTH SBIN;
     2395    13886    2       OUTPUT_WIDTH = DCBADDR(FPT_WRITE.V.DCB#) -> F$DCB.WIDTH#;

  13886  3 001071   000000 470400 4                  LDP0    0
         3 001072   000000 471500                    LDP1    0,,PR0
         3 001073   200146 220100                    LDX0    FPT_WRITE+8,,AUTO
         3 001074   100000 473510                    LDP3    0,X0,PR1
         3 001075   300004 236100                    LDQ     4,,PR3
         3 001076   000777 376007                    ANQ     511,DL
         3 001077   200254 756100                    STQ     OUTPUT_WIDTH,,AUTO

     2396    13887    2       IF OUTPUT_WIDTH = 0

  13887  3 001100   001103 601000 3                  TNZ     s:13890

     2397    13888    2       THEN
     2398    13889    2           OUTPUT_WIDTH = 511;

  13889  3 001101   000777 235007                    LDA     511,DL
         3 001102   200254 755100                    STA     OUTPUT_WIDTH,,AUTO

     2399    13890    2       OUTPUT_COUNT = FPT_WRITE.BUF_.BOUND + 1;

  13890  3 001103   200142 236100                    LDQ     FPT_WRITE+4,,AUTO
         3 001104   000020 772000                    QRL     16
         3 001105   000001 036007                    ADLQ    1,DL
         3 001106   200253 756100                    STQ     OUTPUT_COUNT,,AUTO

     2400    13891    3       DO WHILE (OUTPUT_COUNT > 1);
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:413  

  13891  3 001107   000001 116007                    CMPQ    1,DL
         3 001110   001124 604400 3                  TMOZ    s:13897

     2401    13892    3           IF SUBSTR (OUTPUT_STRING, OUTPUT_COUNT - 1, 1) ~= ' '

  13892  3 001111   200143 470500                    LDP0    FPT_WRITE+5,,AUTO
         3 001112   200253 235100                    LDA     OUTPUT_COUNT,,AUTO
         3 001113   040000 106505                    CMPC    fill='040'O
         3 001114   077777 600001                    ADSC9   -1,A,PR0                 cn=3,n=1
         3 001115   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001116   001124 601000 3                  TNZ     s:13897

     2402    13893    3           THEN
     2403    13894    3               EXIT;
     2404    13895    3           OUTPUT_COUNT = OUTPUT_COUNT - 1;

  13895  3 001117   000001 336007                    LCQ     1,DL
         3 001120   200253 056100                    ASQ     OUTPUT_COUNT,,AUTO

     2405    13896    3       END;

  13896  3 001121   200253 235100                    LDA     OUTPUT_COUNT,,AUTO
         3 001122   000001 115007                    CMPA    1,DL
         3 001123   001111 605400 3                  TPNZ    s:13892

     2406    13897    2       OFFSET = 0;

  13897  3 001124   200252 450100                    STZ     OFFSET,,AUTO

     2407    13898    3       DO WHILE (OFFSET < OUTPUT_COUNT);

  13898  3 001125   200252 236100                    LDQ     OFFSET,,AUTO
         3 001126   200253 116100                    CMPQ    OUTPUT_COUNT,,AUTO
         3 001127   001200 605000 3                  TPL     s:13912

     2408    13899    3           CHUNK_SIZE = MINIMUM(OUTPUT_COUNT - OFFSET, OUTPUT_WIDTH);
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:414  

  13899  3 001130   200253 236100                    LDQ     OUTPUT_COUNT,,AUTO
         3 001131   200252 136100                    SBLQ    OFFSET,,AUTO
         3 001132   200254 116100                    CMPQ    OUTPUT_WIDTH,,AUTO
         3 001133   001135 604400 3                  TMOZ    s:13899+5
         3 001134   200254 236100                    LDQ     OUTPUT_WIDTH,,AUTO
         3 001135   200251 756100                    STQ     CHUNK_SIZE,,AUTO

     2409    13900    3           IF XUG.PROMPT_VFC AND OFFSET > 0

  13900  3 001136   200007 470500                    LDP0    XUG$,,AUTO
         3 001137   000071 236100                    LDQ     57,,PR0
         3 001140   000004 316003                    CANQ    4,DU
         3 001141   001153 600000 3                  TZE     s:13906
         3 001142   200252 235100                    LDA     OFFSET,,AUTO
         3 001143   001153 604400 3                  TMOZ    s:13906

     2410    13901    4           THEN DO;

     2411    13902    4               CHUNK_SIZE = CHUNK_SIZE + 1;

  13902  3 001144   200251 054100                    AOS     CHUNK_SIZE,,AUTO

     2412    13903    4               OFFSET = OFFSET - 1;

  13903  3 001145   000001 336007                    LCQ     1,DL
         3 001146   200252 056100                    ASQ     OFFSET,,AUTO

     2413    13904    4               SUBSTR( XUG.BUF, OFFSET, 1 ) = SUBSTR( XUG.BUF, 0, 1 );

  13904  3 001147   200252 235100                    LDA     OFFSET,,AUTO
         3 001150   040105 100500                    MLR     fill='040'O
         3 001151   000300 000001                    ADSC9   192,,PR0                 cn=0,n=1
         3 001152   000300 000001                    ADSC9   192,A,PR0                cn=0,n=1

     2414    13905    4           END;

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:415  
     2415    13906    3           FPT_WRITE.BUF_.BOUND = CHUNK_SIZE - 1;

  13906  3 001153   200251 236100                    LDQ     CHUNK_SIZE,,AUTO
         3 001154   000001 136007                    SBLQ    1,DL
         3 001155   000020 736000                    QLS     16
         3 001156   200142 676100                    ERQ     FPT_WRITE+4,,AUTO
         3 001157   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 001160   200142 656100                    ERSQ    FPT_WRITE+4,,AUTO

     2416    13907    4           CALL M$WRITE(FPT_WRITE) WHENALTRETURN DO ;

  13907  3 001161   200136 630500                    EPPR0   FPT_WRITE,,AUTO
         3 001162   440001 713400                    CLIMB   alt,write
         3 001163   401400 401760                    pmme    nvectors=4
         3 001164   001166 702000 3                  TSX2    s:13909
         3 001165   001166 710000 3                  TRA     s:13909

     2417    13908    4           END ;

     2418    13909    3           OFFSET = OFFSET + CHUNK_SIZE;

  13909  3 001166   200252 236100                    LDQ     OFFSET,,AUTO
         3 001167   200251 036100                    ADLQ    CHUNK_SIZE,,AUTO
         3 001170   200252 756100                    STQ     OFFSET,,AUTO

     2419    13910    3           FPT_WRITE.BUF_.BUF$ = PINCRC(FPT_WRITE.BUF_.BUF$, CHUNK_SIZE);

  13910  3 001171   200251 236100                    LDQ     CHUNK_SIZE,,AUTO
         3 001172   000020 736000                    QLS     16
         3 001173   200143 036100                    ADLQ    FPT_WRITE+5,,AUTO
         3 001174   200143 756100                    STQ     FPT_WRITE+5,,AUTO

     2420    13911    3       END;

  13911  3 001175   200252 236100                    LDQ     OFFSET,,AUTO
         3 001176   200253 116100                    CMPQ    OUTPUT_COUNT,,AUTO
         3 001177   001130 604000 3                  TMI     s:13899
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:416  

     2421    13912    2       RETURN;

  13912  3 001200   200250 221300                    LDX1  ! FPT_OPEN+58,,AUTO
         3 001201   000001 702211                    TSX2  ! 1,X1

     2422    13913    2   END WRITE_CMD_WRAPPED;
     2423    13914        %EJECT;
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:417  
     2424    13915    1   OPEN: PROC(DCBNO);

  13915  3 001202   200250 741300       OPEN         STX1  ! FPT_OPEN+58,,AUTO

     2425    13916    2   DCL DCBNO UBIN;
     2426    13917    2       IF DCBNO = DCBNUM(NIL)

  13917  3 001203   200251 470500                    LDP0    @DCBNO,,AUTO
         3 001204   000000 235100                    LDA     0,,PR0
         3 001205   001207 601000 3                  TNZ     s:13920

     2427    13918    2       THEN
     2428    13919    2           RETURN;

  13919  3 001206   000001 702211                    TSX2  ! 1,X1

     2429    13920    2       IF NOT DCBADDR(DCBNO) -> F$DCB.FCD#

  13920  3 001207   000000 471400 4                  LDP1    0
         3 001210   100000 473500                    LDP3    0,,PR1
         3 001211   000000 720100                    LXL0    0,,PR0
         3 001212   300000 474510                    LDP4    0,X0,PR3
         3 001213   400031 236100                    LDQ     25,,PR4
         3 001214   020000 316007                    CANQ    8192,DL
         3 001215   001234 601000 3                  TNZ     IGNORE_ERROR_ON_OPEN

     2430    13921    3       THEN DO;

     2431    13922    3           FPT_OPEN = FPT_OPEN_C;

  13922  3 001216   000100 100400                    MLR     fill='000'O
         3 001217   000100 000350 0                  ADSC9   FPT_OPEN_C               cn=0,n=232
         3 001220   200156 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

     2432    13923    3           FPT_OPEN.V_ = VECTOR (FPT_OPEN.V);

  13923  3 001221   000020 235000 4                  LDA     16
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:418  
         3 001222   200256 452500                    STP2    OUTPUT_WIDTH+2,,AUTO
         3 001223   200256 236100                    LDQ     OUTPUT_WIDTH+2,,AUTO
         3 001224   000222 036003                    ADLQ    146,DU
         3 001225   200156 757100                    STAQ    FPT_OPEN,,AUTO

     2433    13924    3           FPT_OPEN.V.DCB# = DCBNO;

  13924  3 001226   000000 720100                    LXL0    0,,PR0
         3 001227   200222 740100                    STX0    FPT_OPEN+36,,AUTO

     2434    13925    3           CALL M$OPEN (FPT_OPEN) ALTRET (IGNORE_ERROR_ON_OPEN);

  13925  3 001230   200156 630500                    EPPR0   FPT_OPEN,,AUTO
         3 001231   450000 713400                    CLIMB   alt,open
         3 001232   410400 401760                    pmme    nvectors=18
         3 001233   001234 702000 3                  TSX2    IGNORE_ERROR_ON_OPEN

  13924  3 001234                       IGNORE_ERRO* null
     2435    13926    3   IGNORE_ERROR_ON_OPEN: ;
     2436    13927    3       END;

     2437    13928    2   END OPEN;

  13928  3 001234   200250 221300                    LDX1  ! FPT_OPEN+58,,AUTO
         3 001235   000001 702211                    TSX2  ! 1,X1
     2438    13929
     2439    13930    1   END XUG$READCMD_COMMON ;
     2440    13931        %EOD;

PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:419  
--  Include file information  --

   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XT_PERR_E.:TOOLE04  is referenced.
   XT_MACRO_M.:TOOLE04  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$READCMD_COMMON.
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:420  

 **** Variables and constants ****

  ****  Section 000 RoData XUG$READCMD_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    74-0-0/d STRC(144)   r     1 FPT_CORRES_C             100-0-0/d STRC(2088)  r     1 FPT_OPEN_C
    42-0-0/d STRC(504)   r     1 FPT_READ_C                60-0-0/d STRC(432)   r     1 FPT_WRITE_C
    40-0-0/c STRC(45)    r     1 M$LO                     174-0-0/w STRC        r     1 XT#CANT_ADAPT
   173-0-0/w STRC        r     1 XT#EOD                     0-0-0/w STRC(1152)  r     1 XT_PARAM_C
   172-0-0/w STRC        r     1 XUG#NO_PROMPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @ARS                       4-0-0/w PTR         r     1 @CMDBUF
   251-0-0/w PTR         r     1 @DCBNO                     3-0-0/w PTR         r     1 @GETCMD
    *0-0-0/w SBIN        r     1 ARS                       *0-0-0/d STRC(72)    r     1 CHARPOS
   251-0-0/w SBIN        r     1 CHUNK_SIZE                *0-0-0/d VECT        r     1 CMDBUF
     6-0-0/w PTR         r     1 CMDBUF$                  115-0-0/w SBIN        r     1 CSIZE
    56-0-0/w PTR         r     1 DCB$                      *0-0-0/w UBIN        r     1 DCBNO
    *0-0-0/w STRC        r     1 ERR                      152-0-0/d STRC(144)   r     1 FPT_CORRES
   156-0-0/d STRC(2088)  r     1 FPT_OPEN                 120-0-0/d STRC(504)   r     1 FPT_READ
   136-0-0/d STRC(432)   r     1 FPT_WRITE                 *0-0-0/d STRC(1512)  r     1 GETCMD
    54-0-0/w SBIN        r     1 OFFSET                   252-0-0/w SBIN        r     1 OFFSET
   253-0-0/w SBIN        r     1 OUTPUT_COUNT             254-0-0/w SBIN        r     1 OUTPUT_WIDTH
    63-0-0/w SBIN        r     1 POFF                      64-0-0/c CHAR(94)    r     1 PROMPT_BUF
   114-0-0/b BIT         r     1 READR_EXISTS              55-0-0/b STRC        r     1 T_ERR
   116-0-0/w PTR         r     1 XT$                        7-0-0/w PTR         r     1 XUG$
    57-0-0/w PTR         r     1 XUG_IN$                   10-0-0/d STRC(1296)  r     1 XUG_INIT_A

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:421  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d STRC(1296)  r     1 XUG_INIT_C

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 BUFFER
     0-0-0/c CHAR(300)   r     1 CHARBASE                   0-0-0/w UBIN        r     1 DCB$NUM
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/c ACHR        r     1 OUTPUT_STRING
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c ACHR        r     1 VCHARBASE
     0-0-0/w STRC(1152)  r     1 XT_PARAM                   0-0-0/d STRC(9612)  r     1 XUG


   Procedure XUG$READCMD_COMMON requires 670 words for executable code.
   Procedure XUG$READCMD_COMMON requires 182 words of local(AUTO) storage.
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:422  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:423  
          MINI XREF LISTING

ARS
        13**DCL         7--PROC       14--REDEF      19--IMP-SIZ 13702<<ASSIGN  13714<<ASSIGN  13728<>CALL
     13744<>CALL    13746<>CALL    13750>>IF      13760<<ASSIGN  13760>>ASSIGN  13763>>IF      13766>>ASSIGN
     13771>>ASSIGN  13772>>IF      13776>>ASSIGN  13776>>ASSIGN
B$ALT.CODE
     13041**DCL     13041--REDEF   13042--REDEF   13042--REDEF
B$ALT.ERR
     13042**DCL     13811>>ASSIGN  13837>>ASSIGN
B$ALT.ERR.ERR#
     13043**DCL     13043--REDEF
B$ALT.EVID
     13042**DCL     13042--REDEF   13042--REDEF
B$JIT.CPFLAGS1
     13465**DCL     13792>>IF
B$JIT.CPFLAGS1.SLEAZE
     13470**DCL     13470--REDEF
B$JIT.ERR.MID
     13377**DCL     13377--REDEF
B$JIT.JRESPEAK
     13538**DCL     13539--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
     13647**DCL     13647--REDEF   13648--REDEF
B$JIT.PNR
     13551**DCL     13551--REDEF
B$JIT.TSLINE
     13645**DCL     13646--REDEF
B$JIT$
     13048**DCL     13371--IMP-PTR 13792>>IF
B$TCB.ALT$
     13037**DCL     13811>>ASSIGN  13837>>ASSIGN
B$TCB$
     13047**DCL     13811>>ASSIGN  13837>>ASSIGN
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:424  
BAD_READ
     13807**LABEL   13712--CALLALT 13850--CALLALT
BUFFER
        19**DCL     13776<<ASSIGN
CHARBASE
      6319**DCL     13872>>ASSIGN
CHARPOS.N
        11**DCL     13818<>CALL    13822>>ASSIGN
CHUNK_SIZE IN PROCEDURE WRITE_CMD_WRAPPED
     13881**DCL     13899<<ASSIGN  13902<<ASSIGN  13902>>ASSIGN  13906>>ASSIGN  13909>>ASSIGN  13910>>ASSIGN
CMDBUF
         9**DCL         7--PROC       10--REDEF   13654>>ASSIGN  13762>>ASSIGN  13772>>IF      13815--ENTRY
CMDBUF$
        20**DCL        19--IMP-PTR 13654<<ASSIGN  13776>>ASSIGN
CORRES
     13825**LABEL   13823--CALLALT 13838--GOTO
CSIZE
     12446**DCL     12447--IMP-SIZ 13767<<ASSIGN  13768>>ASSIGN  13863<<ASSIGN  13864>>ASSIGN
DCB$
     12436**DCL     12437--IMP-PTR 13816<<ASSIGN  13817>>CALL    13821>>ASSIGN
DCB$NUM
     12437**DCL     13817<>CALL    13821>>ASSIGN
DCBNO IN PROCEDURE OPEN
     13916**DCL     13915--PROC    13917>>IF      13920--IF      13924>>ASSIGN
ERR
        14**DCL     13699<<ASSIGN  13731<<ASSIGN  13811<<ASSIGN
F$DCB.ACTPOS
     12488**DCL     12488--REDEF
F$DCB.ARS#
     12462**DCL     12462--REDEF   13714>>ASSIGN
F$DCB.ATTR
     12481**DCL     12482--REDEF
F$DCB.BORROW
     12496**DCL     12496--REDEF   12496--REDEF   12496--REDEF
F$DCB.DCBNAME.L
     12510**DCL     12510--IMP-SIZ
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:425  
F$DCB.DDEV.IC#
     12468**DCL     13716>>IF
F$DCB.DDEV.UCOUT#
     12469**DCL     13792>>IF
F$DCB.DDEV.XEQ#
     12469**DCL     13716>>IF
F$DCB.DVBYTE.TRANS#
     12465**DCL     13792>>IF
F$DCB.DVBYTE.VFC#
     12465**DCL     13713>>ASSIGN
F$DCB.EOMCHAR#
     12466**DCL     12466--REDEF   13715>>ASSIGN
F$DCB.FCD#
     12475**DCL     13920>>IF
F$DCB.FLDID
     12491**DCL     12491--REDEF
F$DCB.FORM$
     12485**DCL     12485--REDEF
F$DCB.FSECT
     12501**DCL     12501--REDEF
F$DCB.FSN#
     12478**DCL     12478--REDEF   12478--REDEF   12479--REDEF
F$DCB.HEADER$
     12484**DCL     12484--REDEF
F$DCB.IXTNSIZE#
     12482**DCL     12482--REDEF
F$DCB.LASTSTA$
     12471**DCL     12471--REDEF
F$DCB.LVL
     12497**DCL     12497--REDEF
F$DCB.NAME#.C
     12472**DCL     12472--REDEF
F$DCB.NOEOF
     12494**DCL     12494--REDEF
F$DCB.NRECS#
     12483**DCL     12483--REDEF
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:426  
F$DCB.NRECX
     12502**DCL     12502--REDEF
F$DCB.OHDR
     12494**DCL     12494--REDEF
F$DCB.ORG#
     12477**DCL     12477--REDEF
F$DCB.PRECNO
     12500**DCL     12500--REDEF
F$DCB.RCSZ
     12506**DCL     12506--REDEF
F$DCB.RES#
     12473**DCL     12473--REDEF
F$DCB.SETX
     12485**DCL     12485--REDEF
F$DCB.TAB$
     12485**DCL     12485--REDEF
F$DCB.TDA
     12499**DCL     12500--REDEF
F$DCB.WIDTH#
     12469**DCL     13886>>ASSIGN
F$DCB.WSN#
     12473**DCL     12473--REDEF
FPT_CORRES
     12677**DCL     13819<<ASSIGN  13823<>CALL
FPT_CORRES.V
     12677**DCL     13820--ASSIGN
FPT_CORRES.V.DCB1#
     12677**DCL     13821<<ASSIGN
FPT_CORRES.V.DCB2#
     12678**DCL     13822<<ASSIGN
FPT_CORRES.V_
     12677**DCL     13820<<ASSIGN
FPT_CORRES_C
     12663**DCL     13819>>ASSIGN
FPT_CORRES_C.V
     12663**DCL     12663--DCLINIT
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:427  
FPT_OPEN
     12854**DCL     13922<<ASSIGN  13925<>CALL
FPT_OPEN.ACSVEH_
     12856**DCL     12857--REDEF
FPT_OPEN.ALTKEYS_
     12862**DCL     12863--REDEF   12863--REDEF
FPT_OPEN.HDR_
     12861**DCL     12862--REDEF
FPT_OPEN.TAB_
     12860**DCL     12861--REDEF
FPT_OPEN.UHL_
     12854**DCL     12855--REDEF   12855--REDEF
FPT_OPEN.V
     12863**DCL     13923--ASSIGN
FPT_OPEN.V.DCB#
     12863**DCL     13924<<ASSIGN
FPT_OPEN.V.FSN#
     12894**DCL     12894--REDEF   12894--REDEF
FPT_OPEN.V_
     12854**DCL     13923<<ASSIGN
FPT_OPEN.WSN_
     12860**DCL     12860--REDEF
FPT_OPEN_C
     12745**DCL     13922>>ASSIGN
FPT_OPEN_C.ACSVEH_
     12747**DCL     12748--REDEF
FPT_OPEN_C.ALTKEYS_
     12753**DCL     12754--REDEF   12754--REDEF
FPT_OPEN_C.HDR_
     12752**DCL     12753--REDEF
FPT_OPEN_C.TAB_
     12751**DCL     12752--REDEF
FPT_OPEN_C.UHL_
     12745**DCL     12746--REDEF   12746--REDEF
FPT_OPEN_C.V
     12754**DCL     12745--DCLINIT
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:428  
FPT_OPEN_C.V.FSN#
     12785**DCL     12785--REDEF   12785--REDEF
FPT_OPEN_C.WSN_
     12751**DCL     12751--REDEF
FPT_READ
     12568**DCL     13708<<ASSIGN  13712<>CALL
FPT_READ.BUF_
     12570**DCL     13711<<ASSIGN
FPT_READ.STATION_
     12571**DCL     12572--REDEF
FPT_READ.V
     12572**DCL     13709--ASSIGN
FPT_READ.V.DCB#
     12572**DCL     13710<<ASSIGN
FPT_READ.V.DVBYTE.REREAD#
     12583**DCL     12583--REDEF
FPT_READ.V.INDX#
     12581**DCL     12581--REDEF
FPT_READ.V_
     12568**DCL     13709<<ASSIGN
FPT_READ_C
     12529**DCL     13708>>ASSIGN
FPT_READ_C.STATION_
     12532**DCL     12533--REDEF
FPT_READ_C.V
     12533**DCL     12529--DCLINIT
FPT_READ_C.V.DVBYTE.REREAD#
     12544**DCL     12544--REDEF
FPT_READ_C.V.INDX#
     12542**DCL     12542--REDEF
FPT_WRITE
     12638**DCL     13857<<ASSIGN  13873<<ASSIGN  13907<>CALL
FPT_WRITE.BUF_
     12638**DCL     13875<<ASSIGN
FPT_WRITE.BUF_.BOUND
     12638**DCL     13876<<ASSIGN  13890>>ASSIGN  13906<<ASSIGN
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:429  
FPT_WRITE.BUF_.BUF$
     12640**DCL     13884--IMP-PTR 13892>>IF      13910<<ASSIGN  13910>>ASSIGN
FPT_WRITE.STATION_
     12640**DCL     12640--REDEF
FPT_WRITE.V
     12641**DCL     13858--ASSIGN  13874--ASSIGN
FPT_WRITE.V.DCB#
     12641**DCL     13804<<ASSIGN  13841<<ASSIGN  13886--ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
     12647**DCL     12647--REDEF   13865<<ASSIGN
FPT_WRITE.V_
     12638**DCL     13858<<ASSIGN  13874<<ASSIGN
FPT_WRITE_C
     12607**DCL     13857>>ASSIGN  13873>>ASSIGN
FPT_WRITE_C.STATION_
     12609**DCL     12609--REDEF
FPT_WRITE_C.V
     12610**DCL     12607--DCLINIT
FPT_WRITE_C.V.DVBYTE.VFC#
     12616**DCL     12616--REDEF
GETCMD
      3897**DCL         7--PROC    13666--ASSIGN  13744<>CALL    13746<>CALL    13774<>CALL    13791<>CALL
     13815--ENTRY   13816--ASSIGN  13827--ENTRY   13840<>CALL    13845--ENTRY   13850<>CALL
GETCMD.DCB_PARAM#
      4077**DCL     13830>>IF      13832<<ASSIGN  13833>>IF      13835<>CALL    13840<>CALL    13841>>ASSIGN
GETCMD.ECHO
      4017**DCL     13792>>IF      13792>>IF
GETCMD.EOMCHAR#
      4037**DCL     13656<<ASSIGN  13692<<ASSIGN  13715<<ASSIGN  13728<>CALL
GETCMD.ERR#
      3908**DCL     13676<<ASSIGN  13781<<ASSIGN  13837<<ASSIGN
GETCMD.INDCB#
      4068**DCL     13655--ASSIGN  13667>>ASSIGN  13682>>IF      13710>>ASSIGN  13792--IF
GETCMD.OUT$
      3902**DCL      3908--REDEF
GETCMD.OUTDCB#
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:430  
      4073**DCL     13668>>ASSIGN  13791<>CALL    13792--IF      13804>>ASSIGN  13832>>ASSIGN
GETCMD.PASS
      4027**DCL     13798>>IF
GETCMD.RCVD_PROMPT#
      3967**DCL     13756<<ASSIGN  13778>>IF
GETCMD.READR$$
      4120**DCL     13706>>IF      13728>>CALL    13728<>CALL
GETCMD.RPROMPT_
      4110**DCL     13859>>IF      13859>>IF      13862>>ASSIGN  13864>>ASSIGN
GETCMD.SKIP_PREPROCESS#
      3978**DCL     13740>>IF      13749<<ASSIGN
GETCMD.TREAD#
      3946**DCL     13693<<ASSIGN  13719<<ASSIGN  13721<<ASSIGN  13788>>IF      13792>>IF
GETCMD.WORK$
      3930**DCL     13653>>ASSIGN  13828>>ASSIGN  13846>>IF      13852>>ASSIGN
GETCMD.XT_PARAM$
      4166**DCL     13660>>IF      13669<<ASSIGN  13673<<ASSIGN  13681>>ASSIGN
IGNORE_ERROR_ON_OPEN IN PROCEDURE OPEN
     13924**LABEL   13925--CALLALT
M$CORRES
     11819**DCL-ENT 13823--CALL
M$LO
     12432**DCL     13835<>CALL
M$OPEN
     11814**DCL-ENT 13925--CALL
M$READ
     11815**DCL-ENT 13712--CALL
M$WRITE
     11815**DCL-ENT 13907--CALL
MOVE_CMD
     13856**PROC    13777--CALL    13829--CALL
NORMAL_READ
     13702**LABEL   13698--GOTO
OFFSET
      6320**DCL     13691<<ASSIGN  13713<<ASSIGN  13714>>ASSIGN  13734<<ASSIGN  13750>>IF      13757<<ASSIGN
     13757>>ASSIGN  13776>>ASSIGN
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:431  
OFFSET IN PROCEDURE WRITE_CMD_WRAPPED
     13882**DCL     13897<<ASSIGN  13898>>DOWHILE 13899>>ASSIGN  13900>>IF      13903<<ASSIGN  13903>>ASSIGN
     13904>>ASSIGN  13909<<ASSIGN  13909>>ASSIGN
OPEN
     13915**PROC    13817--CALL    13818--CALL
OUTPUT_COUNT IN PROCEDURE WRITE_CMD_WRAPPED
     13883**DCL     13884--IMP-SIZ 13890<<ASSIGN  13891>>DOWHILE 13892>>IF      13892>>IF      13895<<ASSIGN
     13895>>ASSIGN  13898>>DOWHILE 13899>>ASSIGN
OUTPUT_STRING IN PROCEDURE WRITE_CMD_WRAPPED
     13884**DCL     13892>>IF
OUTPUT_WIDTH IN PROCEDURE WRITE_CMD_WRAPPED
     13885**DCL     13886<<ASSIGN  13887>>IF      13889<<ASSIGN  13899>>ASSIGN
POFF
     12443**DCL     13862<<ASSIGN  13863>>ASSIGN  13868<<ASSIGN  13869>>ASSIGN  13871>>ASSIGN  13872>>ASSIGN
     13876>>ASSIGN
PROMPT_BUF
     12444**DCL     13864<<ASSIGN  13869<<ASSIGN  13871>>ASSIGN
P_PCB
      6136**DCL     13663--ASSIGN
P_PCB.HI_CHAR
      6287**DCL     13759<<ASSIGN  13759>>ASSIGN
READR_EXISTS
     12445**DCL     13657<<ASSIGN  13725<<ASSIGN  13750>>IF      13788>>IF
READ_ALT
     13813**LABEL   13732--GOTO    13774--CALLALT 13782--GOTO
T_ERR
      6321**DCL     13724<<ASSIGN  13728<>CALL    13731>>ASSIGN
VCHARBASE
     12447**DCL     13768<<ASSIGN  13864>>ASSIGN
WRITE_CMD_WRAPPED
     13880**PROC    13805--CALL    13842--CALL
XT#CANT_ADAPT
     13003**DCL     13674>>IF
XT#EOD
     12957**DCL     13696>>IF
XT$
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:432  
     12448**DCL      5505--IMP-PTR 13663<<ASSIGN  13664>>ASSIGN  13665>>ASSIGN  13666>>ASSIGN  13667>>ASSIGN
     13668>>ASSIGN  13669>>ASSIGN  13670>>CALL    13674>>IF      13676>>ASSIGN  13681<<ASSIGN  13682>>IF
     13682>>IF      13686>>ASSIGN  13687>>ASSIGN  13688>>ASSIGN  13689>>ASSIGN  13690>>ASSIGN  13694>>CALL
     13696>>IF      13699>>ASSIGN  13702>>ASSIGN
XT_PARAM
      5505**DCL     13664<<ASSIGN  13670<>CALL    13694<>CALL
XT_PARAM.ADAPTING
      5659**DCL     13682>>IF
XT_PARAM.ARS
      5589**DCL     13702>>ASSIGN
XT_PARAM.BUF.LEN
      5580**DCL     13687<<ASSIGN
XT_PARAM.BUF.PT$
      5579**DCL     13686<<ASSIGN
XT_PARAM.ERR
      5529**DCL     13674>>IF      13676>>ASSIGN  13696>>IF      13699>>ASSIGN
XT_PARAM.INDCB
      5553**DCL     13667<<ASSIGN  13682>>IF
XT_PARAM.OUTDCB
      5546**DCL     13668<<ASSIGN
XT_PARAM.PROMPT.LEN
      5768**DCL     13689<<ASSIGN
XT_PARAM.PROMPT.PT$
      5767**DCL     13688<<ASSIGN
XT_PARAM.PROMPT_VFC
      5779**DCL     13690<<ASSIGN
XT_PARAM.USER$
      5722**DCL     13666<<ASSIGN
XT_PARAM.XUG$
      5665**DCL     13665<<ASSIGN
XT_PARAM_C
      5818**DCL     13664>>ASSIGN
XUG
      4225**DCL     13663--ASSIGN
XUG.ADAPT$$
      4648**DCL     13660>>IF      13670>>CALL    13672<<ASSIGN  13682>>IF      13694>>CALL
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:433  
XUG.BUF
      4661**DCL      4664--REDEF   13659<<ASSIGN  13686--ASSIGN  13687--ASSIGN  13711--ASSIGN  13728--CALL
     13750>>IF      13776>>ASSIGN  13871<<ASSIGN  13872<<ASSIGN  13875--ASSIGN  13904<<ASSIGN  13904>>ASSIGN
XUG.DCBS.ERRPTR_CPOS
      4520**DCL     13807<<ASSIGN
XUG.DONT_STRIP_PROMPT
      4633**DCL     13750>>IF
XUG.LAST
      4233**DCL     13762<<ASSIGN  13766<<ASSIGN  13768>>ASSIGN  13771<<ASSIGN  13853<<ASSIGN  13872>>ASSIGN
     13872>>ASSIGN  13876>>ASSIGN
XUG.NDCBS
      4515**DCL     13806<<ASSIGN
XUG.NEED_ECHO
      4374**DCL     13801<<ASSIGN
XUG.POFF
      4307**DCL     13689>>ASSIGN  13735<<ASSIGN  13750>>IF      13750>>IF      13750>>IF      13757>>ASSIGN
     13759>>ASSIGN  13760>>ASSIGN  13868>>ASSIGN
XUG.PP_ERR
      4475**DCL     13658<<ASSIGN
XUG.PREPROCESS
      4350**DCL     13740>>IF
XUG.PREPROCESSOR$$
      4263**DCL     13742>>IF
XUG.PROMPT
      4310**DCL     13688--ASSIGN  13736<<ASSIGN  13750>>IF      13869>>ASSIGN
XUG.PROMPT_VFC
      4384**DCL     13689>>ASSIGN  13690>>ASSIGN  13737<<ASSIGN  13750>>IF      13865>>ASSIGN  13869>>ASSIGN
     13900>>IF
XUG.P_PCB$
      4456**DCL     13759>>ASSIGN  13759>>ASSIGN
XUG.READVEC
      4229**DCL     13853>>ASSIGN
XUG.REQ_PROMPT
      4354**DCL     13778>>IF
XUG#NO_PROMPT
     12911**DCL     13781>>ASSIGN
PL6.E3A0      #004=XUG$READCMD_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:21 Page:434  
XUG$
        22**DCL      4225--IMP-PTR 13653<<ASSIGN  13658>>ASSIGN  13659>>ASSIGN  13660>>IF      13663>>ASSIGN
     13665>>ASSIGN  13670>>CALL    13672>>ASSIGN  13682>>IF      13686>>ASSIGN  13688>>ASSIGN  13689>>ASSIGN
     13689>>ASSIGN  13690>>ASSIGN  13694>>CALL    13711>>ASSIGN  13728>>CALL    13735>>ASSIGN  13736>>ASSIGN
     13737>>ASSIGN  13740>>IF      13742>>IF      13750>>IF      13750>>IF      13750>>IF      13750>>IF
     13750>>IF      13750>>IF      13750>>IF      13757>>ASSIGN  13759>>ASSIGN  13759>>ASSIGN  13759>>ASSIGN
     13760>>ASSIGN  13762>>ASSIGN  13766>>ASSIGN  13768>>ASSIGN  13771>>ASSIGN  13776>>ASSIGN  13778>>IF
     13801>>ASSIGN  13806>>ASSIGN  13807>>ASSIGN  13828<<ASSIGN  13852<<ASSIGN  13853>>ASSIGN  13853>>ASSIGN
     13865>>ASSIGN  13868>>ASSIGN  13869>>ASSIGN  13869>>ASSIGN  13871>>ASSIGN  13872>>ASSIGN  13872>>ASSIGN
     13872>>ASSIGN  13875>>ASSIGN  13876>>ASSIGN  13900>>IF      13904>>ASSIGN  13904>>ASSIGN
XUG$ADAPTMEM
      6317**DCL-ENT  6012--DCLINIT
XUG$GETDCB_COMMON
     12454**DCL-ENT 13835--CALL
XUG$INIT_COMMON
     12453**DCL-ENT 13850--CALL
XUG$MOREMEM
     12452**DCL-ENT 13774--CALL
XUG$OPENOUT_INTERNAL
      6318**DCL-ENT 13791--CALL    13840--CALL
XUG$PP_CMDVARS
     12451**DCL-ENT 13746--CALL
XUG$PRE_PROCESSOR
     12450**DCL-ENT 13744--CALL
XUG_IN$
     12439**DCL     13655<<ASSIGN  13713>>ASSIGN  13714>>ASSIGN  13715>>ASSIGN  13716>>IF      13716>>IF
XUG_INIT_A
      5101**DCL     13849<<ASSIGN  13850<>CALL
XUG_INIT_C
      4688**DCL     13849>>ASSIGN

PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:435  
     2441        1        /*T***********************************************************/
     2442        2        /*T*                                                         */
     2443        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2444        4        /*T*                                                         */
     2445        5        /*T***********************************************************/
     2446        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2447        7        XUG$OPENOUT_INTERNAL: PROC (GETCMD,DCB#);
     2448        8        /*D*  NAME: XUG$OPENOUT_INTERNAL
     2449        9              DESCRIPTION: Called within XUG before writing to a DCB.  If the
     2450       10                    DCB is closed, it calls XUG$OPENOUT_COMMON to open it and make
     2451       11                    sure it has an organization that allows unkeyed writes.
     2452       12        */
     2453       13
     2454       14        %INCLUDE CP_6;
     2455     5573        %INCLUDE XU_MACRO_C;
     2456     8679
     2457     8680        %XUG_GETCMD (NAME=GETCMD,STCLASS=PARAM);
     2458     9018    1   DCL DCB# UBIN PARAM;
     2459     9019
     2460     9020        %F$DCB;
     2461     9077        %FPT_OPEN (FPTN=FPT_OPEN_C, STCLASS=CONSTANT);
     2462     9186        %FPT_OPEN (FPTN=FPT_OPEN, STCLASS=AUTO);
     2463     9295
     2464     9296    1   DCL XUG$OPENOUT_COMMON ENTRY(1) ALTRET;
     2465     9297    1   DCL XUG$ERRMSG_COMMON ENTRY(1) ALTRET;
     2466     9298        /**/
     2467     9299
     2468     9300    1       IF DCB# ~= DCBNUM(NIL)
     2469     9301    1       THEN IF NOT DCBADDR(DCB#) -> F$DCB.FCD#
     2470     9302    2           THEN DO;
     2471     9303    2               FPT_OPEN = FPT_OPEN_C;
     2472     9304    2               FPT_OPEN.V_ = VECTOR (FPT_OPEN.V);
     2473     9305    2               FPT_OPEN.V.DCB# = GETCMD.DCB_PARAM#;
     2474     9306    2               GETCMD.DCB_PARAM# = DCB#;
     2475     9307    2               GETCMD.FPT$ = ADDR(FPT_OPEN);
     2476     9308    2               GETCMD.UTIL$ = ADDR(NIL);
     2477     9309    2               CALL XUG$OPENOUT_COMMON (GETCMD)
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:436  
     2478     9310    3               WHENALTRETURN DO;
     2479     9311    3                   GETCMD.ERR_CODE = GETCMD.ERR#;
     2480     9312    3                   GETCMD.ERRDCB# = DCB#;
     2481     9313    3                   CALL XUG$ERRMSG_COMMON (GETCMD);
     2482     9314    3               END/*WHENALT*/;
     2483     9315    2               GETCMD.DCB_PARAM# = FPT_OPEN.V.DCB#;
     2484     9316    2           END;
     2485     9317    1       RETURN;
     2486     9318
     2487     9319    1   END XUG$OPENOUT_INTERNAL;
     2488     9320        %EOD;

PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:437  
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$OPENOUT_INTERNAL.

   Procedure XUG$OPENOUT_INTERNAL requires 49 words for executable code.
   Procedure XUG$OPENOUT_INTERNAL requires 66 words of local(AUTO) storage.

PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:438  

 Object Unit name= XUG$OPENOUT_INTERNAL                       File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:22:52.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     58     72  XUG$OPENOUT_INTERNAL
    2   Proc  even  none    49     61  XUG$OPENOUT_INTERNAL
    3  RoData even  none     2      2  XUG$OPENOUT_INTERNAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  XUG$OPENOUT_INTERNAL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XUG$OPENOUT_COMMON
 yes     yes           Std       1 XUG$ERRMSG_COMMON
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VECTNIL
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:439  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:440  


     2441        1        /*T***********************************************************/
     2442        2        /*T*                                                         */
     2443        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2444        4        /*T*                                                         */
     2445        5        /*T***********************************************************/
     2446        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2447        7        XUG$OPENOUT_INTERNAL: PROC (GETCMD,DCB#);

      7  2 000000   000000 700200 xent  XUG$OPENOUT* TSX0  ! X66_AUTO_2
         2 000001   000102 000002                    ZERO    66,2

     2448        8        /*D*  NAME: XUG$OPENOUT_INTERNAL
     2449        9              DESCRIPTION: Called within XUG before writing to a DCB.  If the
     2450       10                    DCB is closed, it calls XUG$OPENOUT_COMMON to open it and make
     2451       11                    sure it has an organization that allows unkeyed writes.
     2452       12        */
     2453       13
     2454       14        %INCLUDE CP_6;
     2455     5573        %INCLUDE XU_MACRO_C;
     2456     8679
     2457     8680        %XUG_GETCMD (NAME=GETCMD,STCLASS=PARAM);
     2458     9018    1   DCL DCB# UBIN PARAM;
     2459     9019
     2460     9020        %F$DCB;
     2461     9077        %FPT_OPEN (FPTN=FPT_OPEN_C, STCLASS=CONSTANT);
     2462     9186        %FPT_OPEN (FPTN=FPT_OPEN, STCLASS=AUTO);
     2463     9295
     2464     9296    1   DCL XUG$OPENOUT_COMMON ENTRY(1) ALTRET;
     2465     9297    1   DCL XUG$ERRMSG_COMMON ENTRY(1) ALTRET;
     2466     9298        /**/
     2467     9299
     2468     9300    1       IF DCB# ~= DCBNUM(NIL)

   9300  2 000002   200004 470500                    LDP0    @DCB#,,AUTO
         2 000003   000000 235100                    LDA     0,,PR0
         2 000004   000060 600000 2                  TZE     s:9317
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:441  

     2469     9301    1       THEN IF NOT DCBADDR(DCB#) -> F$DCB.FCD#

   9301  2 000005   000000 471400 3                  LDP1    0
         2 000006   100000 473500                    LDP3    0,,PR1
         2 000007   000000 720100                    LXL0    0,,PR0
         2 000010   300000 474510                    LDP4    0,X0,PR3
         2 000011   400031 236100                    LDQ     25,,PR4
         2 000012   020000 316007                    CANQ    8192,DL
         2 000013   000060 601000 2                  TNZ     s:9317

     2470     9302    2           THEN DO;

     2471     9303    2               FPT_OPEN = FPT_OPEN_C;

   9303  2 000014   000100 100400                    MLR     fill='000'O
         2 000015   000000 000350 1                  ADSC9   FPT_OPEN_C               cn=0,n=232
         2 000016   200006 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

     2472     9304    2               FPT_OPEN.V_ = VECTOR (FPT_OPEN.V);

   9304  2 000017   000001 235000 3                  LDA     1
         2 000020   200100 452500                    STP2    FPT_OPEN+58,,AUTO
         2 000021   200100 236100                    LDQ     FPT_OPEN+58,,AUTO
         2 000022   000052 036003                    ADLQ    42,DU
         2 000023   200006 757100                    STAQ    FPT_OPEN,,AUTO

     2473     9305    2               FPT_OPEN.V.DCB# = GETCMD.DCB_PARAM#;

   9305  2 000024   200003 474500                    LDP4    @GETCMD,,AUTO
         2 000025   400014 720100                    LXL0    12,,PR4
         2 000026   200052 740100                    STX0    FPT_OPEN+36,,AUTO

     2474     9306    2               GETCMD.DCB_PARAM# = DCB#;

   9306  2 000027   000000 235100                    LDA     0,,PR0
         2 000030   400014 755100                    STA     12,,PR4
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:442  

     2475     9307    2               GETCMD.FPT$ = ADDR(FPT_OPEN);

   9307  2 000031   200006 635500                    EPPR5   FPT_OPEN,,AUTO
         2 000032   400043 455500                    STP5    35,,PR4

     2476     9308    2               GETCMD.UTIL$ = ADDR(NIL);

   9308  2 000033   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000034   400044 756100                    STQ     36,,PR4

     2477     9309    2               CALL XUG$OPENOUT_COMMON (GETCMD)

   9309  2 000035   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000037   000000 701000 xent               TSX1    XUG$OPENOUT_COMMON
         2 000040   000042 702000 2                  TSX2    s:9311
         2 000041   000054 710000 2                  TRA     s:9315

     2478     9310    3               WHENALTRETURN DO;

     2479     9311    3                   GETCMD.ERR_CODE = GETCMD.ERR#;

   9311  2 000042   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000043   000001 236100                    LDQ     1,,PR0
         2 000044   000010 756100                    STQ     8,,PR0

     2480     9312    3                   GETCMD.ERRDCB# = DCB#;

   9312  2 000045   200004 471500                    LDP1    @DCB#,,AUTO
         2 000046   100000 235100                    LDA     0,,PR1
         2 000047   000011 755100                    STA     9,,PR0

     2481     9313    3                   CALL XUG$ERRMSG_COMMON (GETCMD);

   9313  2 000050   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000051   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:443  
         2 000052   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 000053   000000 011000                    NOP     0

     2482     9314    3               END/*WHENALT*/;

     2483     9315    2               GETCMD.DCB_PARAM# = FPT_OPEN.V.DCB#;

   9315  2 000054   200052 235100                    LDA     FPT_OPEN+36,,AUTO
         2 000055   000022 771000                    ARL     18
         2 000056   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000057   000014 755100                    STA     12,,PR0

     2484     9316    2           END;

     2485     9317    1       RETURN;

   9317  2 000060   000000 702200 xent               TSX2  ! X66_ARET
     2486     9318
     2487     9319    1   END XUG$OPENOUT_INTERNAL;
     2488     9320        %EOD;

PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:444  
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$OPENOUT_INTERNAL.
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:445  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$OPENOUT_INTERNAL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2088)  r     1 FPT_OPEN_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DCB#                      3-0-0/w PTR         r     1 @GETCMD
    *0-0-0/w UBIN        r     1 DCB#                       6-0-0/d STRC(2088)  r     1 FPT_OPEN
    *0-0-0/d STRC(1512)  r     1 GETCMD

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure XUG$OPENOUT_INTERNAL requires 49 words for executable code.
   Procedure XUG$OPENOUT_INTERNAL requires 66 words of local(AUTO) storage.
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:446  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:447  
          MINI XREF LISTING

DCB#
      9018**DCL         7--PROC     9300>>IF       9301--IF       9306>>ASSIGN   9312>>ASSIGN
F$DCB.ACTPOS
      9053**DCL      9053--REDEF
F$DCB.ARS#
      9027**DCL      9027--REDEF
F$DCB.ATTR
      9046**DCL      9047--REDEF
F$DCB.BORROW
      9061**DCL      9061--REDEF    9061--REDEF    9061--REDEF
F$DCB.DCBNAME.L
      9075**DCL      9075--IMP-SIZ
F$DCB.EOMCHAR#
      9031**DCL      9031--REDEF
F$DCB.FCD#
      9040**DCL      9301>>IF
F$DCB.FLDID
      9056**DCL      9056--REDEF
F$DCB.FORM$
      9050**DCL      9050--REDEF
F$DCB.FSECT
      9066**DCL      9066--REDEF
F$DCB.FSN#
      9043**DCL      9043--REDEF    9043--REDEF    9044--REDEF
F$DCB.HEADER$
      9049**DCL      9049--REDEF
F$DCB.IXTNSIZE#
      9047**DCL      9047--REDEF
F$DCB.LASTSTA$
      9036**DCL      9036--REDEF
F$DCB.LVL
      9062**DCL      9062--REDEF
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:448  
F$DCB.NAME#.C
      9037**DCL      9037--REDEF
F$DCB.NOEOF
      9059**DCL      9059--REDEF
F$DCB.NRECS#
      9048**DCL      9048--REDEF
F$DCB.NRECX
      9067**DCL      9067--REDEF
F$DCB.OHDR
      9059**DCL      9059--REDEF
F$DCB.ORG#
      9042**DCL      9042--REDEF
F$DCB.PRECNO
      9065**DCL      9065--REDEF
F$DCB.RCSZ
      9071**DCL      9071--REDEF
F$DCB.RES#
      9038**DCL      9038--REDEF
F$DCB.SETX
      9050**DCL      9050--REDEF
F$DCB.TAB$
      9050**DCL      9050--REDEF
F$DCB.TDA
      9064**DCL      9065--REDEF
F$DCB.WSN#
      9038**DCL      9038--REDEF
FPT_OPEN
      9251**DCL      9303<<ASSIGN   9307--ASSIGN
FPT_OPEN.ACSVEH_
      9253**DCL      9254--REDEF
FPT_OPEN.ALTKEYS_
      9259**DCL      9260--REDEF    9260--REDEF
FPT_OPEN.HDR_
      9258**DCL      9259--REDEF
FPT_OPEN.TAB_
      9257**DCL      9258--REDEF
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:449  
FPT_OPEN.UHL_
      9251**DCL      9252--REDEF    9252--REDEF
FPT_OPEN.V
      9260**DCL      9304--ASSIGN
FPT_OPEN.V.DCB#
      9260**DCL      9305<<ASSIGN   9315>>ASSIGN
FPT_OPEN.V.FSN#
      9291**DCL      9291--REDEF    9291--REDEF
FPT_OPEN.V_
      9251**DCL      9304<<ASSIGN
FPT_OPEN.WSN_
      9257**DCL      9257--REDEF
FPT_OPEN_C
      9142**DCL      9303>>ASSIGN
FPT_OPEN_C.ACSVEH_
      9144**DCL      9145--REDEF
FPT_OPEN_C.ALTKEYS_
      9150**DCL      9151--REDEF    9151--REDEF
FPT_OPEN_C.HDR_
      9149**DCL      9150--REDEF
FPT_OPEN_C.TAB_
      9148**DCL      9149--REDEF
FPT_OPEN_C.UHL_
      9142**DCL      9143--REDEF    9143--REDEF
FPT_OPEN_C.V
      9151**DCL      9142--DCLINIT
FPT_OPEN_C.V.FSN#
      9182**DCL      9182--REDEF    9182--REDEF
FPT_OPEN_C.WSN_
      9148**DCL      9148--REDEF
GETCMD
      8693**DCL         7--PROC     9309<>CALL     9313<>CALL
GETCMD.DCB_PARAM#
      8873**DCL      9305>>ASSIGN   9306<<ASSIGN   9315<<ASSIGN
GETCMD.ERR#
      8704**DCL      9311>>ASSIGN
PL6.E3A0      #005=XUG$OPENOUT_INTERNAL File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:22 Page:450  
GETCMD.ERRDCB#
      8852**DCL      9312<<ASSIGN
GETCMD.ERR_CODE
      8841**DCL      9311<<ASSIGN
GETCMD.FPT$
      8990**DCL      9307<<ASSIGN
GETCMD.OUT$
      8698**DCL      8704--REDEF
GETCMD.UTIL$
      8994**DCL      9308<<ASSIGN
XUG$ERRMSG_COMMON
      9297**DCL-ENT  9313--CALL
XUG$OPENOUT_COMMON
      9296**DCL-ENT  9309--CALL

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:451  
     2489        1        /*T***********************************************************/
     2490        2        /*T*                                                         */
     2491        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2492        4        /*T*                                                         */
     2493        5        /*T***********************************************************/
     2494        6        XUG$PRE_PROCESSOR: PROC (GETCMD,ARS) ;
     2495        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2496        8
     2497        9    1   DCL ARS SBIN;
     2498       10
     2499       11    1   DCL XUG$ PTR ;
     2500       12        %INCLUDE CP_6;
     2501     5571        %INCLUDE CP_6_SUBS;
     2502     6111        %INCLUDE XU_MACRO_C;
     2503     9217        %INCLUDE XUH_MACRO_C ;
     2504     9301        %INCLUDE XU_SUBS_C;
     2505     9393        %INCLUDE XUE_MACRO_C;
     2506    10137        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     2507    10475        %XUG_PARAMS;
     2508    10919        %XUE_PPCB  (NAME=CONSTANT_PPCB, STCLASS=CONSTANT, ROOT=XUE_PREEXP);
     2509    11186        %XUE_PPCB  (NAME=AUTO_PPCB, STCLASS=AUTO);
     2510    11453        %XUE_PPCB  (NAME=BASED_PPCB, STCLASS="BASED(PPCB$)");
     2511    11720        %P_PCB  (NAME=P_PCB, STCLASS="BASED(P_PCB$)") ;
     2512    11919        %FPT_GETDCB (FPTN=GET_WORK_DCB_C, STCLASS=CONSTANT, DCBNAME=WORK_DCB_NAME);
     2513    11934        %FPT_GETDCB (FPTN=GET_WORK_DCB, STCLASS=AUTO);
     2514    11949        %FPT_RELDCB (FPTN=RELEASE_WORK_DCB_C, STCLASS=CONSTANT);
     2515    11963        %FPT_GETDCB (FPTN=RELEASE_WORK_DCB, STCLASS=AUTO);
     2516    11978        %VLP_NAME (FPTN=WORK_DCB_NAME, STCLASS=CONSTANT,
     2517    11979                   NAME='GETCMD''s work DCB');
     2518    12006    1   DCL XUE_PREEXP UBIN SYMREF READONLY;
     2519    12007    1   DCL XUE_EXP ENTRY CONV (5);            /* Force UNSAT load of main XUE nodes */
     2520    12008    1   DCL XUE_FUNCTIONS ENTRY CONV (5);       /* Force UNSAT load of aux XUE nodes */
     2521    12009    1   DCL PPCB$ PTR AUTO;
     2522    12010    1   DCL P_PCB$ PTR AUTO ;
     2523    12011    1   DCL SCRATCH UBIN;
     2524    12012    1   DCL TEMP_BUFFER CHAR (300) AUTO;
     2525    12013    1   DCL WORK_DCB_ALLOCATED BIT (1);
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:452  
     2526    12014    1   DCL PP_WORK (0:2047) UBIN WORD AUTO;
     2527    12015
     2528    12016    1       XUG$ = GETCMD.WORK$ ;
     2529    12017    1       CALL INDEX (SCRATCH, '%', XUG.BUF)
     2530    12018    2       WHENALTRETURN DO;
     2531    12019
     2532    12020    2           RETURN;
     2533    12021
     2534    12022    2       END;
     2535    12023
     2536    12024    1       P_PCB$ = XUG.P_PCB$ ;
     2537    12025    1       WORK_DCB_ALLOCATED = %NO#;
     2538    12026    1       IF XUG.PPCB$ = ADDR(NIL)
     2539    12027    2       THEN DO;
     2540    12028
     2541    12029    2           PPCB$ = ADDR(AUTO_PPCB);
     2542    12030    2           AUTO_PPCB = CONSTANT_PPCB;
     2543    12031    2           AUTO_PPCB.ECB.WORK$ = ADDR(PP_WORK);
     2544    12032    2           AUTO_PPCB.ECB.WKSZ# = SIZEW(PP_WORK);
     2545    12033    2           AUTO_PPCB.ECB.PROCNAME_ = XUG.PP_PROCNAME_ ;
     2546    12034    2           AUTO_PPCB.ECB.FUN$$ = GETCMD.PP_FUN$$ ;
     2547    12035
     2548    12036    2           IF GETCMD.PP_ROOT$ ~= ADDR(NIL)
     2549    12037    2           THEN
     2550    12038    2               AUTO_PPCB.ROOT$ = GETCMD.PP_ROOT$;
     2551    12039
     2552    12040    2           IF XUG.PP_DCB = DCBNUM(NIL)
     2553    12041    3           THEN DO;
     2554    12042
     2555    12043    3               GET_WORK_DCB = GET_WORK_DCB_C;
     2556    12044    3               GET_WORK_DCB.V_ = VECTOR (GET_WORK_DCB.V);
     2557    12045    3               GET_WORK_DCB.DCBNUM_ = VECTOR (SCRATCH);
     2558    12046
     2559    12047    3               CALL M$GETDCB (GET_WORK_DCB)
     2560    12048    4               WHENRETURN DO;
     2561    12049
     2562    12050    4                   AUTO_PPCB.ECB.WORK_DCB# = SCRATCH;
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:453  
     2563    12051    4                   WORK_DCB_ALLOCATED = %YES#;
     2564    12052
     2565    12053    4               END;
     2566    12054
     2567    12055    3           END;
     2568    12056
     2569    12057    2           ELSE
     2570    12058    2               AUTO_PPCB.ECB.WORK_DCB# = XUG.PP_DCB;
     2571    12059
     2572    12060    2       END;
     2573    12061
     2574    12062    1       ELSE
     2575    12063    1           PPCB$ = XUG.PPCB$;
     2576    12064
     2577    12065    1       BASED_PPCB.INBUF$ = ADDR(XUG.BUF);
     2578    12066    1       BASED_PPCB.OUTBUF$ = ADDR(XUG.BUF);
     2579    12067    1       BASED_PPCB.ICHARS# = ARS;
     2580    12068    1       BASED_PPCB.OCHARS# = MINIMUM (XUG.CMDSZ, LENGTHC(XUG.BUF));
     2581    12069
     2582    12070    1       TEMP_BUFFER = XUG.BUF;
     2583    12071
     2584    12072    1       CALL XUG.PREPROCESSOR$$ (BASED_PPCB)
     2585    12073    2       WHENRETURN DO;
     2586    12074
     2587    12075    2           ARS = BASED_PPCB.RCHARS#;
     2588    12076
     2589    12077    2       END;
     2590    12078
     2591    12079    2       WHENALTRETURN DO;
     2592    12080
     2593    12081    2           XUG.BUF = TEMP_BUFFER;
     2594    12082    2           XUG.PP_ERR = BASED_PPCB.ECB.ERR;
     2595    12083
     2596    12084    2           P_PCB.HI_CHAR = XUG.CPOS + BASED_PPCB.ECB.ERR_POS#;
     2597    12085
     2598    12086    2       END;
     2599    12087
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:454  
     2600    12088    1       IF WORK_DCB_ALLOCATED
     2601    12089    2       THEN DO;
     2602    12090
     2603    12091    2           RELEASE_WORK_DCB = RELEASE_WORK_DCB_C;
     2604    12092    2           RELEASE_WORK_DCB.V_ = VECTOR (RELEASE_WORK_DCB.V);
     2605    12093    2           RELEASE_WORK_DCB.V.DCB# = SCRATCH;
     2606    12094
     2607    12095    2           CALL M$RELDCB (RELEASE_WORK_DCB)
     2608    12096    3           WHENALTRETURN DO; END;            /* Ignore error when releasing DCB */
     2609    12097
     2610    12098    2       END;
     2611    12099
     2612    12100    1       RETURN;
     2613    12101
     2614    12102    1   END XUG$PRE_PROCESSOR;
     2615    12103        %EOD;

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:455  
--  Include file information  --

   XUE_MACRO_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$PRE_PROCESSOR.

   Procedure XUG$PRE_PROCESSOR requires 121 words for executable code.
   Procedure XUG$PRE_PROCESSOR requires 2186 words of local(AUTO) storage.

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:456  

 Object Unit name= XUG$PRE_PROCESSOR                          File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:23:24.16 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     51     63  XUG$PRE_PROCESSOR
    2   Proc  even  none   121    171  XUG$PRE_PROCESSOR
    3  RoData even  none     2      2  XUG$PRE_PROCESSOR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  XUG$PRE_PROCESSOR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XUE_EXP
         yes          ~proc      0 XUE_FUNCTIONS
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    XUE_PREEXP                            B_VECTNIL
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:457  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:458  


     2489        1        /*T***********************************************************/
     2490        2        /*T*                                                         */
     2491        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2492        4        /*T*                                                         */
     2493        5        /*T***********************************************************/
     2494        6        XUG$PRE_PROCESSOR: PROC (GETCMD,ARS) ;

      6  2 000000   000000 700200 xent  XUG$PRE_PRO* TSX0  ! X66_AUTO_2
         2 000001   004212 000002                    ZERO    2186,2

     2495        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2496        8
     2497        9    1   DCL ARS SBIN;
     2498       10
     2499       11    1   DCL XUG$ PTR ;
     2500       12        %INCLUDE CP_6;
     2501     5571        %INCLUDE CP_6_SUBS;
     2502     6111        %INCLUDE XU_MACRO_C;
     2503     9217        %INCLUDE XUH_MACRO_C ;
     2504     9301        %INCLUDE XU_SUBS_C;
     2505     9393        %INCLUDE XUE_MACRO_C;
     2506    10137        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     2507    10475        %XUG_PARAMS;
     2508    10919        %XUE_PPCB  (NAME=CONSTANT_PPCB, STCLASS=CONSTANT, ROOT=XUE_PREEXP);
     2509    11186        %XUE_PPCB  (NAME=AUTO_PPCB, STCLASS=AUTO);
     2510    11453        %XUE_PPCB  (NAME=BASED_PPCB, STCLASS="BASED(PPCB$)");
     2511    11720        %P_PCB  (NAME=P_PCB, STCLASS="BASED(P_PCB$)") ;
     2512    11919        %FPT_GETDCB (FPTN=GET_WORK_DCB_C, STCLASS=CONSTANT, DCBNAME=WORK_DCB_NAME);
     2513    11934        %FPT_GETDCB (FPTN=GET_WORK_DCB, STCLASS=AUTO);
     2514    11949        %FPT_RELDCB (FPTN=RELEASE_WORK_DCB_C, STCLASS=CONSTANT);
     2515    11963        %FPT_GETDCB (FPTN=RELEASE_WORK_DCB, STCLASS=AUTO);
     2516    11978        %VLP_NAME (FPTN=WORK_DCB_NAME, STCLASS=CONSTANT,
     2517    11979                   NAME='GETCMD''s work DCB');
     2518    12006    1   DCL XUE_PREEXP UBIN SYMREF READONLY;
     2519    12007    1   DCL XUE_EXP ENTRY CONV (5);            /* Force UNSAT load of main XUE nodes */
     2520    12008    1   DCL XUE_FUNCTIONS ENTRY CONV (5);       /* Force UNSAT load of aux XUE nodes */
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:459  
     2521    12009    1   DCL PPCB$ PTR AUTO;
     2522    12010    1   DCL P_PCB$ PTR AUTO ;
     2523    12011    1   DCL SCRATCH UBIN;
     2524    12012    1   DCL TEMP_BUFFER CHAR (300) AUTO;
     2525    12013    1   DCL WORK_DCB_ALLOCATED BIT (1);
     2526    12014    1   DCL PP_WORK (0:2047) UBIN WORD AUTO;
     2527    12015
     2528    12016    1       XUG$ = GETCMD.WORK$ ;

  12016  2 000002   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000003   000004 236100                    LDQ     4,,PR0
         2 000004   200005 756100                    STQ     XUG$,,AUTO

     2529    12017    1       CALL INDEX (SCRATCH, '%', XUG.BUF)

  12017  2 000005   200005 471500                    LDP1    XUG$,,AUTO
         2 000006   000000 124500                    SCM     mask='000'O
         2 000007   100300 000454                    ADSC9   192,,PR1                 cn=0,n=300
         2 000010   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000011   200072 000100                    ARG     SCRATCH,,AUTO
         2 000012   000014 606400 2                  TTN     s:12020
         2 000013   000015 710000 2                  TRA     s:12024

     2530    12018    2       WHENALTRETURN DO;

     2531    12019
     2532    12020    2           RETURN;

  12020  2 000014   000000 702200 xent               TSX2  ! X66_ARET

     2533    12021
     2534    12022    2       END;
     2535    12023
     2536    12024    1       P_PCB$ = XUG.P_PCB$ ;

  12024  2 000015   100072 236100                    LDQ     58,,PR1
         2 000016   200071 756100                    STQ     P_PCB$,,AUTO
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:460  

     2537    12025    1       WORK_DCB_ALLOCATED = %NO#;

  12025  2 000017   200206 450100                    STZ     WORK_DCB_ALLOCATED,,AUTO

     2538    12026    1       IF XUG.PPCB$ = ADDR(NIL)

  12026  2 000020   100073 236100                    LDQ     59,,PR1
         2 000021   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000022   000076 601000 2                  TNZ     s:12063

     2539    12027    2       THEN DO;

     2540    12028
     2541    12029    2           PPCB$ = ADDR(AUTO_PPCB);

  12029  2 000023   200006 633500                    EPPR3   AUTO_PPCB,,AUTO
         2 000024   200070 453500                    STP3    PPCB$,,AUTO

     2542    12030    2           AUTO_PPCB = CONSTANT_PPCB;

  12030  2 000025   000100 100400                    MLR     fill='000'O
         2 000026   000000 000210 1                  ADSC9   CONSTANT_PPCB            cn=0,n=136
         2 000027   200006 000210                    ADSC9   AUTO_PPCB,,AUTO          cn=0,n=136

     2543    12031    2           AUTO_PPCB.ECB.WORK$ = ADDR(PP_WORK);

  12031  2 000030   200207 634500                    EPPR4   PP_WORK,,AUTO
         2 000031   200015 454500                    STP4    AUTO_PPCB+7,,AUTO

     2544    12032    2           AUTO_PPCB.ECB.WKSZ# = SIZEW(PP_WORK);

  12032  2 000032   004000 235007                    LDA     2048,DL
         2 000033   200016 755100                    STA     AUTO_PPCB+8,,AUTO

     2545    12033    2           AUTO_PPCB.ECB.PROCNAME_ = XUG.PP_PROCNAME_ ;

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:461  
  12033  2 000034   100074 237100                    LDAQ    60,,PR1
         2 000035   200026 757100                    STAQ    AUTO_PPCB+16,,AUTO

     2546    12034    2           AUTO_PPCB.ECB.FUN$$ = GETCMD.PP_FUN$$ ;

  12034  2 000036   000031 236100                    LDQ     25,,PR0
         2 000037   200021 756100                    STQ     AUTO_PPCB+11,,AUTO

     2547    12035
     2548    12036    2           IF GETCMD.PP_ROOT$ ~= ADDR(NIL)

  12036  2 000040   000045 236100                    LDQ     37,,PR0
         2 000041   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000042   000044 600000 2                  TZE     s:12040

     2549    12037    2           THEN
     2550    12038    2               AUTO_PPCB.ROOT$ = GETCMD.PP_ROOT$;

  12038  2 000043   200013 756100                    STQ     AUTO_PPCB+5,,AUTO

     2551    12039
     2552    12040    2           IF XUG.PP_DCB = DCBNUM(NIL)

  12040  2 000044   100077 235100                    LDA     63,,PR1
         2 000045   000074 601000 2                  TNZ     s:12058

     2553    12041    3           THEN DO;

     2554    12042
     2555    12043    3               GET_WORK_DCB = GET_WORK_DCB_C;

  12043  2 000046   000100 100400                    MLR     fill='000'O
         2 000047   000042 000040 1                  ADSC9   GET_WORK_DCB_C           cn=0,n=32
         2 000050   200050 000040                    ADSC9   GET_WORK_DCB,,AUTO       cn=0,n=32

     2556    12044    3               GET_WORK_DCB.V_ = VECTOR (GET_WORK_DCB.V);

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:462  
  12044  2 000051   000001 235000 3                  LDA     1
         2 000052   204210 452500                    STP2    PP_WORK+2049,,AUTO
         2 000053   204210 236100                    LDQ     PP_WORK+2049,,AUTO
         2 000054   000056 036003                    ADLQ    46,DU
         2 000055   200050 757100                    STAQ    GET_WORK_DCB,,AUTO

     2557    12045    3               GET_WORK_DCB.DCBNUM_ = VECTOR (SCRATCH);

  12045  2 000056   777640 235007                    LDA     -96,DL
         2 000057   204210 452500                    STP2    PP_WORK+2049,,AUTO
         2 000060   204210 236100                    LDQ     PP_WORK+2049,,AUTO
         2 000061   000072 036003                    ADLQ    58,DU
         2 000062   200054 757100                    STAQ    GET_WORK_DCB+4,,AUTO

     2558    12046
     2559    12047    3               CALL M$GETDCB (GET_WORK_DCB)

  12047  2 000063   200050 630500                    EPPR0   GET_WORK_DCB,,AUTO
         2 000064   460002 713400                    CLIMB   alt,+24578
         2 000065   401000 401760                    pmme    nvectors=3
         2 000066   000073 702000 2                  TSX2    s:12055

     2560    12048    4               WHENRETURN DO;

     2561    12049
     2562    12050    4                   AUTO_PPCB.ECB.WORK_DCB# = SCRATCH;

  12050  2 000067   200072 235100                    LDA     SCRATCH,,AUTO
         2 000070   200017 755100                    STA     AUTO_PPCB+9,,AUTO

     2563    12051    4                   WORK_DCB_ALLOCATED = %YES#;

  12051  2 000071   400000 236003                    LDQ     -131072,DU
         2 000072   200206 756100                    STQ     WORK_DCB_ALLOCATED,,AUTO

     2564    12052
     2565    12053    4               END;
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:463  

     2566    12054
     2567    12055    3           END;

  12055  2 000073   000077 710000 2                  TRA     s:12065

     2568    12056
     2569    12057    2           ELSE
     2570    12058    2               AUTO_PPCB.ECB.WORK_DCB# = XUG.PP_DCB;

  12058  2 000074   200017 755100                    STA     AUTO_PPCB+9,,AUTO

     2571    12059
     2572    12060    2       END;

  12060  2 000075   000077 710000 2                  TRA     s:12065

     2573    12061
     2574    12062    1       ELSE
     2575    12063    1           PPCB$ = XUG.PPCB$;

  12063  2 000076   200070 756100                    STQ     PPCB$,,AUTO

     2576    12064
     2577    12065    1       BASED_PPCB.INBUF$ = ADDR(XUG.BUF);

  12065  2 000077   200005 236100                    LDQ     XUG$,,AUTO
         2 000100   000300 036003                    ADLQ    192,DU
         2 000101   200070 470500                    LDP0    PPCB$,,AUTO
         2 000102   000000 756100                    STQ     0,,PR0

     2578    12066    1       BASED_PPCB.OUTBUF$ = ADDR(XUG.BUF);

  12066  2 000103   000002 756100                    STQ     2,,PR0

     2579    12067    1       BASED_PPCB.ICHARS# = ARS;

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:464  
  12067  2 000104   200004 471500                    LDP1    @ARS,,AUTO
         2 000105   100000 235100                    LDA     0,,PR1
         2 000106   000001 755100                    STA     1,,PR0

     2580    12068    1       BASED_PPCB.OCHARS# = MINIMUM (XUG.CMDSZ, LENGTHC(XUG.BUF));

  12068  2 000107   000454 236007                    LDQ     300,DL
         2 000110   200005 473500                    LDP3    XUG$,,AUTO
         2 000111   300111 116100                    CMPQ    73,,PR3
         2 000112   000115 602000 2                  TNC     s:12068+6
         2 000113   000115 600000 2                  TZE     s:12068+6
         2 000114   300111 236100                    LDQ     73,,PR3
         2 000115   000003 756100                    STQ     3,,PR0

     2581    12069
     2582    12070    1       TEMP_BUFFER = XUG.BUF;

  12070  2 000116   040100 100500                    MLR     fill='040'O
         2 000117   300300 000454                    ADSC9   192,,PR3                 cn=0,n=300
         2 000120   200073 000454                    ADSC9   TEMP_BUFFER,,AUTO        cn=0,n=300

     2583    12071
     2584    12072    1       CALL XUG.PREPROCESSOR$$ (BASED_PPCB)

  12072  2 000121   200070 630500                    EPPR0   PPCB$,,AUTO
         2 000122   300023 220100                    LDX0    19,,PR3
         2 000123   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000124   000000 701010                    TSX1    0,X0
         2 000125   000133 702000 2                  TSX2    s:12081

     2585    12073    2       WHENRETURN DO;

     2586    12074
     2587    12075    2           ARS = BASED_PPCB.RCHARS#;

  12075  2 000126   200070 470500                    LDP0    PPCB$,,AUTO
         2 000127   000004 235100                    LDA     4,,PR0
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:465  
         2 000130   200004 471500                    LDP1    @ARS,,AUTO
         2 000131   100000 755100                    STA     0,,PR1

     2588    12076
     2589    12077    2       END;

  12077  2 000132   000147 710000 2                  TRA     s:12088

     2590    12078
     2591    12079    2       WHENALTRETURN DO;

     2592    12080
     2593    12081    2           XUG.BUF = TEMP_BUFFER;

  12081  2 000133   200005 470500                    LDP0    XUG$,,AUTO
         2 000134   040100 100500                    MLR     fill='040'O
         2 000135   200073 000454                    ADSC9   TEMP_BUFFER,,AUTO        cn=0,n=300
         2 000136   000300 000454                    ADSC9   192,,PR0                 cn=0,n=300

     2594    12082    2           XUG.PP_ERR = BASED_PPCB.ECB.ERR;

  12082  2 000137   200070 471500                    LDP1    PPCB$,,AUTO
         2 000140   100017 236100                    LDQ     15,,PR1
         2 000141   000100 756100                    STQ     64,,PR0

     2595    12083
     2596    12084    2           P_PCB.HI_CHAR = XUG.CPOS + BASED_PPCB.ECB.ERR_POS#;

  12084  2 000142   100016 236100                    LDQ     14,,PR1
         2 000143   000022 772000                    QRL     18
         2 000144   000104 036100                    ADLQ    68,,PR0
         2 000145   200071 473500                    LDP3    P_PCB$,,AUTO
         2 000146   300012 756100                    STQ     10,,PR3

     2597    12085
     2598    12086    2       END;

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:466  
     2599    12087
     2600    12088    1       IF WORK_DCB_ALLOCATED

  12088  2 000147   200206 234100                    SZN     WORK_DCB_ALLOCATED,,AUTO
         2 000150   000170 605000 2                  TPL     s:12100

     2601    12089    2       THEN DO;

     2602    12090
     2603    12091    2           RELEASE_WORK_DCB = RELEASE_WORK_DCB_C;

  12091  2 000151   000100 100400                    MLR     fill='000'O
         2 000152   000052 000020 1                  ADSC9   RELEASE_WORK_DCB_C       cn=0,n=16
         2 000153   200060 000040                    ADSC9   RELEASE_WORK_DCB,,AUTO   cn=0,n=32

     2604    12092    2           RELEASE_WORK_DCB.V_ = VECTOR (RELEASE_WORK_DCB.V);

  12092  2 000154   000001 235000 3                  LDA     1
         2 000155   204210 452500                    STP2    PP_WORK+2049,,AUTO
         2 000156   204210 236100                    LDQ     PP_WORK+2049,,AUTO
         2 000157   000066 036003                    ADLQ    54,DU
         2 000160   200060 757100                    STAQ    RELEASE_WORK_DCB,,AUTO

     2605    12093    2           RELEASE_WORK_DCB.V.DCB# = SCRATCH;

  12093  2 000161   200072 720100                    LXL0    SCRATCH,,AUTO
         2 000162   200066 740100                    STX0    RELEASE_WORK_DCB+6,,AUTO

     2606    12094
     2607    12095    2           CALL M$RELDCB (RELEASE_WORK_DCB)

  12095  2 000163   200060 630500                    EPPR0   RELEASE_WORK_DCB,,AUTO
         2 000164   460003 713400                    CLIMB   alt,+24579
         2 000165   400000 401760                    pmme    nvectors=1
         2 000166   000170 702000 2                  TSX2    s:12100
         2 000167   000170 710000 2                  TRA     s:12100

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:467  
     2608    12096    3           WHENALTRETURN DO; END;            /* Ignore error when releasing DCB */

     2609    12097
     2610    12098    2       END;

     2611    12099
     2612    12100    1       RETURN;

  12100  2 000170   000000 702200 xent               TSX2  ! X66_ARET
     2613    12101
     2614    12102    1   END XUG$PRE_PROCESSOR;
     2615    12103        %EOD;

PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:468  
--  Include file information  --

   XUE_MACRO_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$PRE_PROCESSOR.
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:469  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$PRE_PROCESSOR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1224)  r     1 CONSTANT_PPCB             42-0-0/d STRC(288)   r     1 GET_WORK_DCB_C
    52-0-0/d STRC(144)   r     1 RELEASE_WORK_DCB_C        56-0-0/c STRC(162)   r     1 WORK_DCB_NAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ARS                       3-0-0/w PTR         r     1 @GETCMD
    *0-0-0/w SBIN        r     1 ARS                        6-0-0/d STRC(1224)  r     1 AUTO_PPCB
    *0-0-0/d STRC(1512)  r     1 GETCMD                    50-0-0/d STRC(288)   r     1 GET_WORK_DCB
    70-0-0/w PTR         r     1 PPCB$                    207-0-0/w UBIN        r     1 PP_WORK(0:2047)
    71-0-0/w PTR         r     1 P_PCB$                    60-0-0/d STRC(288)   r     1 RELEASE_WORK_DCB
    72-0-0/w UBIN        r     1 SCRATCH                   73-0-0/c CHAR(300)   r     1 TEMP_BUFFER
   206-0-0/b BIT         r     1 WORK_DCB_ALLOCATED         5-0-0/w PTR         r     1 XUG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 XUE_PREEXP

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1224)  r     1 BASED_PPCB                 0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/d STRC(9612)  r     1 XUG
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:470  


   Procedure XUG$PRE_PROCESSOR requires 121 words for executable code.
   Procedure XUG$PRE_PROCESSOR requires 2186 words of local(AUTO) storage.
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:471  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:472  
          MINI XREF LISTING

ARS
         9**DCL         6--PROC    12067>>ASSIGN  12075<<ASSIGN
AUTO_PPCB
     11201**DCL     12029--ASSIGN  12030<<ASSIGN
AUTO_PPCB.ECB.FUN$$
     11303**DCL     12034<<ASSIGN
AUTO_PPCB.ECB.PROCNAME_
     11363**DCL     12033<<ASSIGN
AUTO_PPCB.ECB.WKSZ#
     11279**DCL     12032<<ASSIGN
AUTO_PPCB.ECB.WORK$
     11274**DCL     12031<<ASSIGN
AUTO_PPCB.ECB.WORK_DCB#
     11286**DCL     12050<<ASSIGN  12058<<ASSIGN
AUTO_PPCB.ROOT$
     11238**DCL     12038<<ASSIGN
BASED_PPCB
     11468**DCL     12072<>CALL
BASED_PPCB.ECB.ERR
     11615**DCL     12082>>ASSIGN
BASED_PPCB.ECB.ERR_POS#
     11598**DCL     12084>>ASSIGN
BASED_PPCB.ICHARS#
     11477**DCL     12067<<ASSIGN
BASED_PPCB.INBUF$
     11472**DCL     12065<<ASSIGN
BASED_PPCB.OCHARS#
     11491**DCL     12068<<ASSIGN
BASED_PPCB.OUTBUF$
     11484**DCL     12066<<ASSIGN
BASED_PPCB.RCHARS#
     11498**DCL     12075>>ASSIGN
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:473  
CONSTANT_PPCB
     10934**DCL     12030>>ASSIGN
GETCMD
     10150**DCL         6--PROC
GETCMD.OUT$
     10155**DCL     10161--REDEF
GETCMD.PP_FUN$$
     10368**DCL     12034>>ASSIGN
GETCMD.PP_ROOT$
     10455**DCL     12036>>IF      12038>>ASSIGN
GETCMD.WORK$
     10183**DCL     12016>>ASSIGN
GET_WORK_DCB
     11945**DCL     12043<<ASSIGN  12047<>CALL
GET_WORK_DCB.DCBNUM_
     11945**DCL     12045<<ASSIGN
GET_WORK_DCB.V
     11946**DCL     12044--ASSIGN
GET_WORK_DCB.V_
     11945**DCL     12044<<ASSIGN
GET_WORK_DCB_C
     11930**DCL     12043>>ASSIGN
GET_WORK_DCB_C.V
     11931**DCL     11930--DCLINIT
M$GETDCB
      5505**DCL-ENT 12047--CALL
M$RELDCB
      5505**DCL-ENT 12095--CALL
PPCB$
     12009**DCL     11468--IMP-PTR 12029<<ASSIGN  12063<<ASSIGN  12065>>ASSIGN  12066>>ASSIGN  12067>>ASSIGN
     12068>>ASSIGN  12072>>CALL    12075>>ASSIGN  12082>>ASSIGN  12084>>ASSIGN
PP_WORK
     12014**DCL     12031--ASSIGN  12032--ASSIGN
P_PCB.HI_CHAR
     11889**DCL     12084<<ASSIGN
P_PCB$
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:474  
     12010**DCL     11738--IMP-PTR 12024<<ASSIGN  12084>>ASSIGN
RELEASE_WORK_DCB
     11974**DCL     12091<<ASSIGN  12095<>CALL
RELEASE_WORK_DCB.V
     11975**DCL     12092--ASSIGN
RELEASE_WORK_DCB.V.DCB#
     11975**DCL     12093<<ASSIGN
RELEASE_WORK_DCB.V_
     11974**DCL     12092<<ASSIGN
RELEASE_WORK_DCB_C
     11960**DCL     12091>>ASSIGN
RELEASE_WORK_DCB_C.V
     11960**DCL     11960--DCLINIT
SCRATCH
     12011**DCL     12017<<CALLBLT 12045--ASSIGN  12050>>ASSIGN  12093>>ASSIGN
TEMP_BUFFER
     12012**DCL     12070<<ASSIGN  12081>>ASSIGN
WORK_DCB_ALLOCATED
     12013**DCL     12025<<ASSIGN  12051<<ASSIGN  12088>>IF
WORK_DCB_NAME
     12004**DCL     11930--DCLINIT
XUE_PREEXP
     12006**DCL     10971--DCLINIT
XUG.BUF
     10914**DCL     10917--REDEF   12017>>CALLBLT 12065--ASSIGN  12066--ASSIGN  12068--ASSIGN  12070>>ASSIGN
     12081<<ASSIGN
XUG.CMDSZ
     10765**DCL     12068>>ASSIGN
XUG.CPOS
     10746**DCL     12084>>ASSIGN
XUG.PPCB$
     10712**DCL     12026>>IF      12063>>ASSIGN
XUG.PP_DCB
     10724**DCL     12040>>IF      12058>>ASSIGN
XUG.PP_ERR
     10728**DCL     12082<<ASSIGN
PL6.E3A0      #006=XUG$PRE_PROCESSOR File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:23 Page:475  
XUG.PP_PROCNAME_
     10715**DCL     12033>>ASSIGN
XUG.PREPROCESSOR$$
     10516**DCL     12072>>CALL
XUG.P_PCB$
     10709**DCL     12024>>ASSIGN
XUG$
        11**DCL     10478--IMP-PTR 12016<<ASSIGN  12017>>CALLBLT 12024>>ASSIGN  12026>>IF      12033>>ASSIGN
     12040>>IF      12058>>ASSIGN  12063>>ASSIGN  12065>>ASSIGN  12066>>ASSIGN  12068>>ASSIGN  12070>>ASSIGN
     12072>>CALL    12081>>ASSIGN  12082>>ASSIGN  12084>>ASSIGN

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:476  
     2616        1        /*T***********************************************************/
     2617        2        /*T*                                                         */
     2618        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2619        4        /*T*                                                         */
     2620        5        /*T***********************************************************/
     2621        6        XUG$PP_CMDVARS: PROC( GETCMD , ARS );
     2622        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2623        8
     2624        9    1   DCL ARS SBIN;
     2625       10
     2626       11    1   DCL XUG$ PTR ;
     2627       12        %INCLUDE CP_6;
     2628     5571        %INCLUDE CP_6_SUBS;
     2629     6111        %INCLUDE XU_MACRO_C;
     2630     9217        %INCLUDE XU_PERR_C;
     2631     9408        %INCLUDE XU_DATA_R;
     2632     9419        %INCLUDE XUH_MACRO_C;
     2633     9503        %XUG_GETCMD( NAME= GETCMD , STCLASS=PARAM );
     2634     9841        %XUG_PARAMS;
     2635    10285        %P_PCB( NAME= P$PCB , STCLASS=BASED );
     2636    10484        %FPT_CMDVAR( STCLASS=AUTO );
     2637    10501        %FPT_CMDVAR( FPTN= FPT_CMDVAR_C , STCLASS=CONSTANT, FUN=FETCH );
     2638    10518        %VLP_ERRCODE( FPTN=XUG#PP_TRUNC, STCLASS=CONSTANT, FCG=XU, MID=G,
     2639    10519                      ERR#=%E$XUG#PP_TRUNC );
     2640    10564    1   DCL 1 TVAL ,
     2641    10565    1         2 LEN UBIN BYTE CALIGNED ,
     2642    10566    1         2 TXT CHAR( 300 );
     2643    10567    1   DCL 1 TNAM ,
     2644    10568    1         2 LEN UBIN BYTE CALIGNED ,
     2645    10569    1         2 TXT CHAR( 31 );
     2646    10570    1   DCL TBUF CHAR( 300 );
     2647    10571    1   DCL PPOS SBIN ;
     2648    10572    1   DCL START SBIN ;
     2649    10573    1   DCL NLEN SBIN ;
     2650    10574    1   DCL VLEN SBIN ;
     2651    10575    1   DCL XLEN SBIN ;
     2652    10576        %EJECT;
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:477  
     2653    10577    1       XUG$ = GETCMD.WORK$ ;
     2654    10578    1       CALL INDEX( PPOS , '%' , SUBSTR( XUG.BUF , 0 , ARS ))
     2655    10579    2       WHENALTRETURN DO;
     2656    10580    2           RETURN ;
     2657    10581    2       END/*WHENALT*/;
     2658    10582
     2659    10583    1       FPT_CMDVAR = FPT_CMDVAR_C ;
     2660    10584    1       FPT_CMDVAR.V_ = VECTOR( FPT_CMDVAR.V );
     2661    10585    1       FPT_CMDVAR.VALUE_ = VECTOR( TVAL );
     2662    10586    1       FPT_CMDVAR.NAME_ = VECTOR( TNAM );
     2663    10587
     2664    10588    2       DO WHILE PPOS < ARS ;
     2665    10589    2           START = PPOS + 1 ;
     2666    10590    2           NLEN = 0 ;
     2667    10591    3           DO WHILE START + NLEN < ARS ;
     2668    10592    3               IF SYMTTBL.PL6SYM( ASCBIN( XUG.BUFA( START + NLEN ))) = %NO#
     2669    10593    3               THEN
     2670    10594    3                   EXIT ;
     2671    10595    3               NLEN = NLEN + 1 ;
     2672    10596    3           END/*WHILE*/;
     2673    10597    2           IF NLEN > 0 AND NLEN < 32
     2674    10598    3           THEN DO;
     2675    10599    3               IF PPOS > 0
     2676    10600    3                 AND XUG.BUFA( PPOS - 1 ) = '%'
     2677    10601    4               THEN DO;
     2678    10602    4                   SUBSTR( XUG.BUF , PPOS , ARS - START ) =
     2679    10603    4                     SUBSTR( XUG.BUF , START , ARS - START );
     2680    10604    4                   ARS = ARS - 1 ;
     2681    10605    4                   PPOS = PPOS + NLEN ;
     2682    10606    4               END/*IF*/;
     2683    10607    4               ELSE DO;
     2684    10608    4                   TNAM.LEN = NLEN ;
     2685    10609    4                   TNAM.TXT = SUBSTR( XUG.BUF , START , NLEN );
     2686    10610    4                   CALL M$CMDVAR( FPT_CMDVAR )
     2687    10611    5                   WHENRETURN DO;
     2688    10612    5                       XLEN = ARS - PPOS - NLEN - 1 ;
     2689    10613    5                       IF XLEN > 0
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:478  
     2690    10614    5                       THEN
     2691    10615    5                           SUBSTR( TBUF , 0 , XLEN ) =
     2692    10616    5                             SUBSTR( XUG.BUF , ARS - XLEN , XLEN );
     2693    10617    5                       VLEN = TVAL.LEN ;
     2694    10618    5                       IF VLEN > 0
     2695    10619    5                       THEN
     2696    10620    5                           CALL INSERT( XUG.BUF , PPOS , VLEN , TVAL.TXT );
     2697    10621    5                       ARS = ARS + VLEN - NLEN - 1 ;
     2698    10622    5                       IF ARS > XUG.CMDSZ
     2699    10623    6                       THEN DO;
     2700    10624    6                           ARS = XUG.CMDSZ ;
     2701    10625    6                           XUG.PP_ERR = XUG#PP_TRUNC ;
     2702    10626    6                           XUG.P_PCB$ -> P$PCB.HI_CHAR = ARS ;
     2703    10627    6                           RETURN ;
     2704    10628    6                       END/*IF*/;
     2705    10629        /*E*    ERROR: XUG-E$XUG#PP_TRUNC-0
     2706    10630               MESSAGE: The result of command variable substitution was longer than allowed.
     2707    10631                         Truncation occurred.
     2708    10632        */
     2709    10633    5                       PPOS = PPOS + VLEN ;
     2710    10634    5                       IF XLEN > 0
     2711    10635    5                       THEN
     2712    10636    5                           SUBSTR( XUG.BUF , PPOS , XLEN ) =
     2713    10637    5                             SUBSTR( TBUF , 0 , XLEN );
     2714    10638    5                   END/*WHEN*/;
     2715    10639    5                   WHENALTRETURN DO;
     2716    10640    5                       PPOS = START + NLEN ;
     2717    10641    5                   END/*WHENALT*/;
     2718    10642    4               END/*ELSE*/;
     2719    10643    3           END/*IF*/;
     2720    10644    2           ELSE
     2721    10645    2               PPOS = START + NLEN ;
     2722    10646    2           CALL INDEX( PPOS , '%' , SUBSTR( XUG.BUF , 0 , ARS ), PPOS );
     2723    10647    2       END/*WHILE*/;
     2724    10648    1       RETURN ;
     2725    10649
     2726    10650    1   END XUG$PP_CMDVARS ;
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:479  
     2727    10651        %EOD;

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:480  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$PP_CMDVARS.

   Procedure XUG$PP_CMDVARS requires 179 words for executable code.
   Procedure XUG$PP_CMDVARS requires 186 words of local(AUTO) storage.

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:481  

 Object Unit name= XUG$PP_CMDVARS                             File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:23:57.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     15     17  XUG$PP_CMDVARS
    2   Proc  even  none   179    263  XUG$PP_CMDVARS
    3  RoData even  none     4      4  XUG$PP_CMDVARS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  XUG$PP_CMDVARS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_DATA_D
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    XUP_SYMTBL
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:482  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:483  


     2616        1        /*T***********************************************************/
     2617        2        /*T*                                                         */
     2618        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2619        4        /*T*                                                         */
     2620        5        /*T***********************************************************/
     2621        6        XUG$PP_CMDVARS: PROC( GETCMD , ARS );

      6  2 000000   000000 700200 xent  XUG$PP_CMDV* TSX0  ! X66_AUTO_2
         2 000001   000272 000002                    ZERO    186,2

     2622        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2623        8
     2624        9    1   DCL ARS SBIN;
     2625       10
     2626       11    1   DCL XUG$ PTR ;
     2627       12        %INCLUDE CP_6;
     2628     5571        %INCLUDE CP_6_SUBS;
     2629     6111        %INCLUDE XU_MACRO_C;
     2630     9217        %INCLUDE XU_PERR_C;
     2631     9408        %INCLUDE XU_DATA_R;
     2632     9419        %INCLUDE XUH_MACRO_C;
     2633     9503        %XUG_GETCMD( NAME= GETCMD , STCLASS=PARAM );
     2634     9841        %XUG_PARAMS;
     2635    10285        %P_PCB( NAME= P$PCB , STCLASS=BASED );
     2636    10484        %FPT_CMDVAR( STCLASS=AUTO );
     2637    10501        %FPT_CMDVAR( FPTN= FPT_CMDVAR_C , STCLASS=CONSTANT, FUN=FETCH );
     2638    10518        %VLP_ERRCODE( FPTN=XUG#PP_TRUNC, STCLASS=CONSTANT, FCG=XU, MID=G,
     2639    10519                      ERR#=%E$XUG#PP_TRUNC );
     2640    10564    1   DCL 1 TVAL ,
     2641    10565    1         2 LEN UBIN BYTE CALIGNED ,
     2642    10566    1         2 TXT CHAR( 300 );
     2643    10567    1   DCL 1 TNAM ,
     2644    10568    1         2 LEN UBIN BYTE CALIGNED ,
     2645    10569    1         2 TXT CHAR( 31 );
     2646    10570    1   DCL TBUF CHAR( 300 );
     2647    10571    1   DCL PPOS SBIN ;
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:484  
     2648    10572    1   DCL START SBIN ;
     2649    10573    1   DCL NLEN SBIN ;
     2650    10574    1   DCL VLEN SBIN ;
     2651    10575    1   DCL XLEN SBIN ;
     2652    10576        %EJECT;
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:485  
     2653    10577    1       XUG$ = GETCMD.WORK$ ;

  10577  2 000002   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000003   000004 236100                    LDQ     4,,PR0
         2 000004   200005 756100                    STQ     XUG$,,AUTO

     2654    10578    1       CALL INDEX( PPOS , '%' , SUBSTR( XUG.BUF , 0 , ARS ))

  10578  2 000005   200004 471500                    LDP1    @ARS,,AUTO
         2 000006   100000 720100                    LXL0    0,,PR1
         2 000007   200005 473500                    LDP3    XUG$,,AUTO
         2 000010   000000 124540                    SCM     mask='000'O
         2 000011   300300 000010                    ADSC9   192,,PR3                 cn=0,n=*X0
         2 000012   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000013   200263 000100                    ARG     PPOS,,AUTO
         2 000014   000016 606400 2                  TTN     s:10580
         2 000015   000017 710000 2                  TRA     s:10583

     2655    10579    2       WHENALTRETURN DO;

     2656    10580    2           RETURN ;

  10580  2 000016   000000 702200 xent               TSX2  ! X66_ARET

     2657    10581    2       END/*WHENALT*/;
     2658    10582
     2659    10583    1       FPT_CMDVAR = FPT_CMDVAR_C ;

  10583  2 000017   000100 100400                    MLR     fill='000'O
         2 000020   000000 000070 1                  ADSC9   FPT_CMDVAR_C             cn=0,n=56
         2 000021   200006 000070                    ADSC9   FPT_CMDVAR,,AUTO         cn=0,n=56

     2660    10584    1       FPT_CMDVAR.V_ = VECTOR( FPT_CMDVAR.V );

  10584  2 000022   000001 235000 3                  LDA     1
         2 000023   200270 452500                    STP2    XLEN+1,,AUTO
         2 000024   200270 236100                    LDQ     XLEN+1,,AUTO
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:486  
         2 000025   000022 036003                    ADLQ    18,DU
         2 000026   200006 757100                    STAQ    FPT_CMDVAR,,AUTO

     2661    10585    1       FPT_CMDVAR.VALUE_ = VECTOR( TVAL );

  10585  2 000027   000002 235000 3                  LDA     2
         2 000030   200270 452500                    STP2    XLEN+1,,AUTO
         2 000031   200270 236100                    LDQ     XLEN+1,,AUTO
         2 000032   000024 036003                    ADLQ    20,DU
         2 000033   200012 757100                    STAQ    FPT_CMDVAR+4,,AUTO

     2662    10586    1       FPT_CMDVAR.NAME_ = VECTOR( TNAM );

  10586  2 000034   000003 235000 3                  LDA     3
         2 000035   200270 452500                    STP2    XLEN+1,,AUTO
         2 000036   200270 236100                    LDQ     XLEN+1,,AUTO
         2 000037   000140 036003                    ADLQ    96,DU
         2 000040   200010 757100                    STAQ    FPT_CMDVAR+2,,AUTO

     2663    10587
     2664    10588    2       DO WHILE PPOS < ARS ;

  10588  2 000041   200263 236100                    LDQ     PPOS,,AUTO
         2 000042   100000 116100                    CMPQ    0,,PR1
         2 000043   000262 605000 2                  TPL     s:10648

     2665    10589    2           START = PPOS + 1 ;

  10589  2 000044   200263 235100                    LDA     PPOS,,AUTO
         2 000045   000001 035007                    ADLA    1,DL
         2 000046   200264 755100                    STA     START,,AUTO

     2666    10590    2           NLEN = 0 ;

  10590  2 000047   200265 450100                    STZ     NLEN,,AUTO

     2667    10591    3           DO WHILE START + NLEN < ARS ;
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:487  

  10591  2 000050   000064 710000 2                  TRA     s:10596

     2668    10592    3               IF SYMTTBL.PL6SYM( ASCBIN( XUG.BUFA( START + NLEN ))) = %NO#

  10592  2 000051   200264 236100                    LDQ     START,,AUTO
         2 000052   200265 036100                    ADLQ    NLEN,,AUTO
         2 000053   200005 470500                    LDP0    XUG$,,AUTO
         2 000054   000100 101506                    MRL     fill='000'O
         2 000055   000300 000001                    ADSC9   192,Q,PR0                cn=0,n=1
         2 000056   200270 000004                    ADSC9   XLEN+1,,AUTO             cn=0,n=4
         2 000057   200270 236100                    LDQ     XLEN+1,,AUTO
         2 000060   000000 236006 xsym               LDQ     XUP_SYMTBL,QL
         2 000061   004000 316003                    CANQ    2048,DU
         2 000062   000071 600000 2                  TZE     s:10597

     2669    10593    3               THEN
     2670    10594    3                   EXIT ;
     2671    10595    3               NLEN = NLEN + 1 ;

  10595  2 000063   200265 054100                    AOS     NLEN,,AUTO

     2672    10596    3           END/*WHILE*/;

  10596  2 000064   200264 236100                    LDQ     START,,AUTO
         2 000065   200265 036100                    ADLQ    NLEN,,AUTO
         2 000066   200004 470500                    LDP0    @ARS,,AUTO
         2 000067   000000 116100                    CMPQ    0,,PR0
         2 000070   000051 604000 2                  TMI     s:10592

     2673    10597    2           IF NLEN > 0 AND NLEN < 32

  10597  2 000071   200265 235100                    LDA     NLEN,,AUTO
         2 000072   000235 604400 2                  TMOZ    s:10645
         2 000073   000040 115007                    CMPA    32,DL
         2 000074   000235 605000 2                  TPL     s:10645

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:488  
     2674    10598    3           THEN DO;

     2675    10599    3               IF PPOS > 0

  10599  2 000075   200263 236100                    LDQ     PPOS,,AUTO
         2 000076   000127 604400 2                  TMOZ    s:10608
         2 000077   200005 470500                    LDP0    XUG$,,AUTO
         2 000100   040000 106506                    CMPC    fill='040'O
         2 000101   000277 600001                    ADSC9   191,Q,PR0                cn=3,n=1
         2 000102   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000103   000127 601000 2                  TNZ     s:10608

     2676    10600    3                 AND XUG.BUFA( PPOS - 1 ) = '%'
     2677    10601    4               THEN DO;

     2678    10602    4                   SUBSTR( XUG.BUF , PPOS , ARS - START ) =

  10602  2 000104   200004 471500                    LDP1    @ARS,,AUTO
         2 000105   100000 236100                    LDQ     0,,PR1
         2 000106   200264 136100                    SBLQ    START,,AUTO
         2 000107   200270 756100                    STQ     XLEN+1,,AUTO
         2 000110   100000 236100                    LDQ     0,,PR1
         2 000111   200264 136100                    SBLQ    START,,AUTO
         2 000112   000000 620006                    EAX0    0,QL
         2 000113   200264 236100                    LDQ     START,,AUTO
         2 000114   200270 721100                    LXL1    XLEN+1,,AUTO
         2 000115   200263 235100                    LDA     PPOS,,AUTO
         2 000116   040145 100546                    MLR     fill='040'O
         2 000117   000300 000010                    ADSC9   192,Q,PR0                cn=0,n=*X0
         2 000120   000300 000011                    ADSC9   192,A,PR0                cn=0,n=*X1

     2679    10603    4                     SUBSTR( XUG.BUF , START , ARS - START );
     2680    10604    4                   ARS = ARS - 1 ;

  10604  2 000121   000001 336007                    LCQ     1,DL
         2 000122   100000 056100                    ASQ     0,,PR1

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:489  
     2681    10605    4                   PPOS = PPOS + NLEN ;

  10605  2 000123   200263 236100                    LDQ     PPOS,,AUTO
         2 000124   200265 036100                    ADLQ    NLEN,,AUTO
         2 000125   200263 756100                    STQ     PPOS,,AUTO

     2682    10606    4               END/*IF*/;

  10606  2 000126   000240 710000 2                  TRA     s:10646

     2683    10607    4               ELSE DO;

     2684    10608    4                   TNAM.LEN = NLEN ;

  10608  2 000127   200265 236100                    LDQ     NLEN,,AUTO
         2 000130   000033 736000                    QLS     27
         2 000131   200140 552140                    STBQ    TNAM,'40'O,AUTO

     2685    10609    4                   TNAM.TXT = SUBSTR( XUG.BUF , START , NLEN );

  10609  2 000132   200005 470500                    LDP0    XUG$,,AUTO
         2 000133   000000 620005                    EAX0    0,AL
         2 000134   200264 235100                    LDA     START,,AUTO
         2 000135   040100 100545                    MLR     fill='040'O
         2 000136   000300 000010                    ADSC9   192,A,PR0                cn=0,n=*X0
         2 000137   200140 200037                    ADSC9   TNAM,,AUTO               cn=1,n=31

     2686    10610    4                   CALL M$CMDVAR( FPT_CMDVAR )

  10610  2 000140   200006 630500                    EPPR0   FPT_CMDVAR,,AUTO
         2 000141   420025 713400                    CLIMB   alt,+8213
         2 000142   402400 401760                    pmme    nvectors=6
         2 000143   000231 702000 2                  TSX2    s:10640

     2687    10611    5                   WHENRETURN DO;

     2688    10612    5                       XLEN = ARS - PPOS - NLEN - 1 ;
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:490  

  10612  2 000144   200004 470500                    LDP0    @ARS,,AUTO
         2 000145   000000 236100                    LDQ     0,,PR0
         2 000146   200263 136100                    SBLQ    PPOS,,AUTO
         2 000147   200265 136100                    SBLQ    NLEN,,AUTO
         2 000150   000001 136007                    SBLQ    1,DL
         2 000151   200267 756100                    STQ     XLEN,,AUTO

     2689    10613    5                       IF XLEN > 0

  10613  2 000152   000162 604400 2                  TMOZ    s:10617

     2690    10614    5                       THEN
     2691    10615    5                           SUBSTR( TBUF , 0 , XLEN ) =

  10615  2 000153   000000 236100                    LDQ     0,,PR0
         2 000154   200267 136100                    SBLQ    XLEN,,AUTO
         2 000155   200005 471500                    LDP1    XUG$,,AUTO
         2 000156   200267 720100                    LXL0    XLEN,,AUTO
         2 000157   040140 100546                    MLR     fill='040'O
         2 000160   100300 000010                    ADSC9   192,Q,PR1                cn=0,n=*X0
         2 000161   200150 000010                    ADSC9   TBUF,,AUTO               cn=0,n=*X0

     2692    10616    5                             SUBSTR( XUG.BUF , ARS - XLEN , XLEN );
     2693    10617    5                       VLEN = TVAL.LEN ;

  10617  2 000162   200024 236100                    LDQ     TVAL,,AUTO
         2 000163   000033 772000                    QRL     27
         2 000164   200266 756100                    STQ     VLEN,,AUTO

     2694    10618    5                       IF VLEN > 0

  10618  2 000165   000174 604400 2                  TMOZ    s:10621

     2695    10619    5                       THEN
     2696    10620    5                           CALL INSERT( XUG.BUF , PPOS , VLEN , TVAL.TXT );

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:491  
  10620  2 000166   200005 471500                    LDP1    XUG$,,AUTO
         2 000167   000000 620006                    EAX0    0,QL
         2 000170   200263 235100                    LDA     PPOS,,AUTO
         2 000171   040145 100500                    MLR     fill='040'O
         2 000172   200024 200454                    ADSC9   TVAL,,AUTO               cn=1,n=300
         2 000173   100300 000010                    ADSC9   192,A,PR1                cn=0,n=*X0

     2697    10621    5                       ARS = ARS + VLEN - NLEN - 1 ;

  10621  2 000174   000000 236100                    LDQ     0,,PR0
         2 000175   200266 036100                    ADLQ    VLEN,,AUTO
         2 000176   200265 136100                    SBLQ    NLEN,,AUTO
         2 000177   000001 136007                    SBLQ    1,DL
         2 000200   000000 756100                    STQ     0,,PR0

     2698    10622    5                       IF ARS > XUG.CMDSZ

  10622  2 000201   200005 471500                    LDP1    XUG$,,AUTO
         2 000202   000216 604000 2                  TMI     s:10633
         2 000203   100111 116100                    CMPQ    73,,PR1
         2 000204   000216 602000 2                  TNC     s:10633
         2 000205   000216 600000 2                  TZE     s:10633

     2699    10623    6                       THEN DO;

     2700    10624    6                           ARS = XUG.CMDSZ ;

  10624  2 000206   100111 235100                    LDA     73,,PR1
         2 000207   000000 755100                    STA     0,,PR0

     2701    10625    6                           XUG.PP_ERR = XUG#PP_TRUNC ;

  10625  2 000210   000016 236000 1                  LDQ     XUG#PP_TRUNC
         2 000211   100100 756100                    STQ     64,,PR1

     2702    10626    6                           XUG.P_PCB$ -> P$PCB.HI_CHAR = ARS ;

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:492  
  10626  2 000212   100072 473500                    LDP3    58,,PR1
         2 000213   000000 235100                    LDA     0,,PR0
         2 000214   300012 755100                    STA     10,,PR3

     2703    10627    6                           RETURN ;

  10627  2 000215   000000 702200 xent               TSX2  ! X66_ARET

     2704    10628    6                       END/*IF*/;
     2705    10629        /*E*    ERROR: XUG-E$XUG#PP_TRUNC-0
     2706    10630              MESSAGE: The result of command variable substitution was longer than allowed.
     2707    10631                         Truncation occurred.
     2708    10632        */
     2709    10633    5                       PPOS = PPOS + VLEN ;

  10633  2 000216   200263 236100                    LDQ     PPOS,,AUTO
         2 000217   200266 036100                    ADLQ    VLEN,,AUTO
         2 000220   200263 756100                    STQ     PPOS,,AUTO

     2710    10634    5                       IF XLEN > 0

  10634  2 000221   200267 235100                    LDA     XLEN,,AUTO
         2 000222   000230 604400 2                  TMOZ    s:10638

     2711    10635    5                       THEN
     2712    10636    5                           SUBSTR( XUG.BUF , PPOS , XLEN ) =

  10636  2 000223   000000 620005                    EAX0    0,AL
         2 000224   200267 721100                    LXL1    XLEN,,AUTO
         2 000225   040146 100540                    MLR     fill='040'O
         2 000226   200150 000010                    ADSC9   TBUF,,AUTO               cn=0,n=*X0
         2 000227   100300 000011                    ADSC9   192,Q,PR1                cn=0,n=*X1

     2713    10637    5                             SUBSTR( TBUF , 0 , XLEN );
     2714    10638    5                   END/*WHEN*/;

  10638  2 000230   000234 710000 2                  TRA     s:10643
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:493  

     2715    10639    5                   WHENALTRETURN DO;

     2716    10640    5                       PPOS = START + NLEN ;

  10640  2 000231   200264 236100                    LDQ     START,,AUTO
         2 000232   200265 036100                    ADLQ    NLEN,,AUTO
         2 000233   200263 756100                    STQ     PPOS,,AUTO

     2717    10641    5                   END/*WHENALT*/;

     2718    10642    4               END/*ELSE*/;

     2719    10643    3           END/*IF*/;

  10643  2 000234   000240 710000 2                  TRA     s:10646

     2720    10644    2           ELSE
     2721    10645    2               PPOS = START + NLEN ;

  10645  2 000235   200264 236100                    LDQ     START,,AUTO
         2 000236   200265 036100                    ADLQ    NLEN,,AUTO
         2 000237   200263 756100                    STQ     PPOS,,AUTO

     2722    10646    2           CALL INDEX( PPOS , '%' , SUBSTR( XUG.BUF , 0 , ARS ), PPOS );

  10646  2 000240   200004 470500                    LDP0    @ARS,,AUTO
         2 000241   000000 720100                    LXL0    0,,PR0
         2 000242   000000 636010                    EAQ     0,X0
         2 000243   000022 772000                    QRL     18
         2 000244   200263 136100                    SBLQ    PPOS,,AUTO
         2 000245   200270 756100                    STQ     XLEN+1,,AUTO
         2 000246   200263 236100                    LDQ     PPOS,,AUTO
         2 000247   200005 471500                    LDP1    XUG$,,AUTO
         2 000250   200270 720100                    LXL0    XLEN+1,,AUTO
         2 000251   200263 235100                    LDA     PPOS,,AUTO
         2 000252   000000 124545                    SCM     mask='000'O
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:494  
         2 000253   100300 000010                    ADSC9   192,A,PR1                cn=0,n=*X0
         2 000254   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000255   200263 000100                    ARG     PPOS,,AUTO
         2 000256   200263 056100                    ASQ     PPOS,,AUTO

     2723    10647    2       END/*WHILE*/;

  10647  2 000257   200263 236100                    LDQ     PPOS,,AUTO
         2 000260   000000 116100                    CMPQ    0,,PR0
         2 000261   000044 604000 2                  TMI     s:10589

     2724    10648    1       RETURN ;

  10648  2 000262   000000 702200 xent               TSX2  ! X66_ARET
     2725    10649
     2726    10650    1   END XUG$PP_CMDVARS ;
     2727    10651        %EOD;

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:495  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$PP_CMDVARS.
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:496  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$PP_CMDVARS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(504)   r     1 FPT_CMDVAR_C              16-0-0/w STRC        r     1 XUG#PP_TRUNC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ARS                       3-0-0/w PTR         r     1 @GETCMD
    *0-0-0/w SBIN        r     1 ARS                        6-0-0/d STRC(504)   r     1 FPT_CMDVAR
    *0-0-0/d STRC(1512)  r     1 GETCMD                   265-0-0/w SBIN        r     1 NLEN
   263-0-0/w SBIN        r     1 PPOS                     264-0-0/w SBIN        r     1 START
   150-0-0/c CHAR(300)   r     1 TBUF                     140-0-0/c STRC(288)   r     1 TNAM
    24-0-0/c STRC(2709)  r     1 TVAL                     266-0-0/w SBIN        r     1 VLEN
   267-0-0/w SBIN        r     1 XLEN                       5-0-0/w PTR         r     1 XUG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 SYMTTBL(0:127)
     0-0-0/b BIT         r     1 XUP_SYMTBL(0:127)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(504)   r     1 P$PCB                      0-0-0/d STRC(9612)  r     1 XUG

PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:497  

   Procedure XUG$PP_CMDVARS requires 179 words for executable code.
   Procedure XUG$PP_CMDVARS requires 186 words of local(AUTO) storage.
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:498  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:499  
          MINI XREF LISTING

ARS
         9**DCL         6--PROC    10578>>CALLBLT 10588>>DOWHILE 10591>>DOWHILE 10602>>ASSIGN  10602>>ASSIGN
     10604<<ASSIGN  10604>>ASSIGN  10612>>ASSIGN  10615>>ASSIGN  10621<<ASSIGN  10621>>ASSIGN  10622>>IF
     10624<<ASSIGN  10626>>ASSIGN  10646>>CALLBLT
FPT_CMDVAR
     10495**DCL     10583<<ASSIGN  10610<>CALL
FPT_CMDVAR.NAME_
     10495**DCL     10586<<ASSIGN
FPT_CMDVAR.V
     10497**DCL     10584--ASSIGN
FPT_CMDVAR.VALUE_
     10495**DCL     10585<<ASSIGN
FPT_CMDVAR.V_
     10495**DCL     10584<<ASSIGN
FPT_CMDVAR_C
     10512**DCL     10583>>ASSIGN
FPT_CMDVAR_C.V
     10514**DCL     10512--DCLINIT
GETCMD
      9516**DCL         6--PROC
GETCMD.OUT$
      9521**DCL      9527--REDEF
GETCMD.WORK$
      9549**DCL     10577>>ASSIGN
M$CMDVAR
      5568**DCL-ENT 10610--CALL
NLEN
     10573**DCL     10590<<ASSIGN  10591>>DOWHILE 10592>>IF      10595<<ASSIGN  10595>>ASSIGN  10597>>IF
     10597>>IF      10605>>ASSIGN  10608>>ASSIGN  10609>>ASSIGN  10612>>ASSIGN  10621>>ASSIGN  10640>>ASSIGN
     10645>>ASSIGN
P$PCB.HI_CHAR
     10454**DCL     10626<<ASSIGN
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:500  
PPOS
     10571**DCL     10578<<CALLBLT 10588>>DOWHILE 10589>>ASSIGN  10599>>IF      10599>>IF      10602>>ASSIGN
     10605<<ASSIGN  10605>>ASSIGN  10612>>ASSIGN  10620>>CALLBLT 10633<<ASSIGN  10633>>ASSIGN  10636>>ASSIGN
     10640<<ASSIGN  10645<<ASSIGN  10646<<CALLBLT 10646>>CALLBLT
START
     10572**DCL     10589<<ASSIGN  10591>>DOWHILE 10592>>IF      10602>>ASSIGN  10602>>ASSIGN  10602>>ASSIGN
     10609>>ASSIGN  10640>>ASSIGN  10645>>ASSIGN
SYMTTBL.PL6SYM
      9417**DCL     10592>>IF
TBUF
     10570**DCL     10615<<ASSIGN  10636>>ASSIGN
TNAM
     10567**DCL     10586--ASSIGN
TNAM.LEN
     10568**DCL     10608<<ASSIGN
TNAM.TXT
     10569**DCL     10609<<ASSIGN
TVAL
     10564**DCL     10585--ASSIGN
TVAL.LEN
     10565**DCL     10617>>ASSIGN
TVAL.TXT
     10566**DCL     10620>>CALLBLT
VLEN
     10574**DCL     10617<<ASSIGN  10618>>IF      10620>>CALLBLT 10621>>ASSIGN  10633>>ASSIGN
XLEN
     10575**DCL     10612<<ASSIGN  10613>>IF      10615>>ASSIGN  10615>>ASSIGN  10615>>ASSIGN  10634>>IF
     10636>>ASSIGN  10636>>ASSIGN
XUG.BUF
     10280**DCL     10283--REDEF   10578>>CALLBLT 10602<<ASSIGN  10602>>ASSIGN  10609>>ASSIGN  10615>>ASSIGN
     10620<<CALLBLT 10636<<ASSIGN  10646>>CALLBLT
XUG.BUFA
     10283**DCL     10592>>IF      10599>>IF
XUG.CMDSZ
     10131**DCL     10622>>IF      10624>>ASSIGN
XUG.PP_ERR
PL6.E3A0      #007=XUG$PP_CMDVARS File=XUG$COMMON.:E05TSI                        WED 07/30/97 09:23 Page:501  
     10094**DCL     10625<<ASSIGN
XUG.P_PCB$
     10075**DCL     10626>>ASSIGN
XUG#PP_TRUNC
     10531**DCL     10625>>ASSIGN
XUG$
        11**DCL      9844--IMP-PTR 10577<<ASSIGN  10578>>CALLBLT 10592>>IF      10599>>IF      10602>>ASSIGN
     10602>>ASSIGN  10609>>ASSIGN  10615>>ASSIGN  10620>>CALLBLT 10622>>IF      10624>>ASSIGN  10625>>ASSIGN
     10626>>ASSIGN  10636>>ASSIGN  10646>>CALLBLT
XUP_SYMTBL
      9416**DCL      9416--REDEF

PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:502  
     2728        1        /*T***********************************************************/
     2729        2        /*T*                                                         */
     2730        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2731        4        /*T*                                                         */
     2732        5        /*T***********************************************************/
     2733        6        XUG$BREAK_COMMON: PROC (XUG_WORK$) ;
     2734        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2735        8        %INCLUDE CP_6;
     2736     5567        /**/
     2737     5568        %FPT_TRMPRG (RSTBRK=YES,STCLASS=CONSTANT);
     2738     5597    1   DCL XUG$BRKSUB ENTRY(1) ;
     2739     5598        /**/
     2740     5599        %INCLUDE XU_MACRO_C;
     2741     8705        %INCLUDE XUH_MACRO_C ;
     2742     8789    1   DCL XUG_WORK$ PTR PARAM ;
     2743     8790        /**/
     2744     8791    1   DCL XUG$ PTR ;
     2745     8792
     2746     8793        %XUG_PARAMS;
     2747     9237        %EJECT;
PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:503  
     2748     9238    2       DO INHIBIT;
     2749     9239    2           XUG$ = XUG_WORK$ ;
     2750     9240    2           XUG.BIP=XUG.BIP+1;
     2751     9241    2           XUG.BREAK='1'B;
     2752     9242    3           CALL M$TRMPRG(FPT_TRMPRG) WHENALTRETURN DO ;
     2753     9243    3           END ;
     2754     9244    2           IF XUG.BIP>1 THEN RETURN;
     2755     9245    2           CALL XUG$BRKSUB (XUG_WORK$) ;
     2756     9246    2           IF XUG.CONTINUE~=ENTADDR(NIL) THEN CALL XUG.CONTINUE;
     2757     9247    2           RETURN;
     2758     9248    2       END;
     2759     9249    1   END XUG$BREAK_COMMON;
     2760     9250        %EOD;

PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:504  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$BREAK_COMMON.

   Procedure XUG$BREAK_COMMON requires 33 words for executable code.
   Procedure XUG$BREAK_COMMON requires 6 words of local(AUTO) storage.

PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:505  

 Object Unit name= XUG$BREAK_COMMON                           File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:24:30.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      8     10  XUG$BREAK_COMMON
    2   Proc  even  none    33     41  XUG$BREAK_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  XUG$BREAK_COMMON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 XUG$BRKSUB
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VECTNIL
PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:506  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:507  


     2728        1        /*T***********************************************************/
     2729        2        /*T*                                                         */
     2730        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2731        4        /*T*                                                         */
     2732        5        /*T***********************************************************/
     2733        6        XUG$BREAK_COMMON: PROC (XUG_WORK$) ;

      6  2 000000   000000 700200 xent  XUG$BREAK_C* TSX0  ! X66_AUTO_1
         2 000001   000006 000001                    ZERO    6,1

     2734        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2735        8        %INCLUDE CP_6;
     2736     5567        /**/
     2737     5568        %FPT_TRMPRG (RSTBRK=YES,STCLASS=CONSTANT);
     2738     5597    1   DCL XUG$BRKSUB ENTRY(1) ;
     2739     5598        /**/
     2740     5599        %INCLUDE XU_MACRO_C;
     2741     8705        %INCLUDE XUH_MACRO_C ;
     2742     8789    1   DCL XUG_WORK$ PTR PARAM ;
     2743     8790        /**/
     2744     8791    1   DCL XUG$ PTR ;
     2745     8792
     2746     8793        %XUG_PARAMS;
     2747     9237        %EJECT;
PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:508  
     2748     9238    2       DO INHIBIT;

     2749     9239    2           XUG$ = XUG_WORK$ ;

   9239  2 000002   200003 470700                    LDP0  ! @XUG_WORK$,,AUTO
         2 000003   000000 236300                    LDQ   ! 0,,PR0
         2 000004   200004 756300                    STQ   ! XUG$,,AUTO

     2750     9240    2           XUG.BIP=XUG.BIP+1;

   9240  2 000005   200004 471700                    LDP1  ! XUG$,,AUTO
         2 000006   100102 054300                    AOS   ! 66,,PR1

     2751     9241    2           XUG.BREAK='1'B;

   9241  2 000007   040000 236203                    LDQ   ! 16384,DU
         2 000010   100071 256300                    ORSQ  ! 57,,PR1

     2752     9242    3           CALL M$TRMPRG(FPT_TRMPRG) WHENALTRETURN DO ;

   9242  2 000011   000000 630600 1                  EPPR0 ! FPT_TRMPRG
         2 000012   560004 713600                    CLIMB ! alt,+57348
         2 000013   400400 401760                    pmme    nvectors=2
         2 000014   000016 702200 2                  TSX2  ! s:9244
         2 000015   000016 710200 2                  TRA   ! s:9244

     2753     9243    3           END ;

     2754     9244    2           IF XUG.BIP>1 THEN RETURN;

   9244  2 000016   200004 470700                    LDP0  ! XUG$,,AUTO
         2 000017   000102 235300                    LDA   ! 66,,PR0
         2 000020   000001 115207                    CMPA  ! 1,DL
         2 000021   000023 604600 2                  TMOZ  ! s:9245

   9244  2 000022   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:509  
     2755     9245    2           CALL XUG$BRKSUB (XUG_WORK$) ;

   9245  2 000023   200003 630700                    EPPR0 ! @XUG_WORK$,,AUTO
         2 000024   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         2 000025   000000 701200 xent               TSX1  ! XUG$BRKSUB
         2 000026   000000 011200                    NOP   ! 0

     2756     9246    2           IF XUG.CONTINUE~=ENTADDR(NIL) THEN CALL XUG.CONTINUE;

   9246  2 000027   200004 470700                    LDP0  ! XUG$,,AUTO
         2 000030   000021 236300                    LDQ   ! 17,,PR0
         2 000031   000002 116200 xsym               CMPQ  ! B_VECTNIL+2
         2 000032   000037 600200 2                  TZE   ! s:9247

   9246  2 000033   000021 220300                    LDX0  ! 17,,PR0
         2 000034   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         2 000035   000000 701210                    TSX1  ! 0,X0
         2 000036   000000 011200                    NOP   ! 0

     2757     9247    2           RETURN;

   9247  2 000037   000000 702200 xent               TSX2  ! X66_ARET

     2758     9248    2       END;

     2759     9249    1   END XUG$BREAK_COMMON;

   9249  2 000040   000000 702200 xent               TSX2  ! X66_ARET
     2760     9250        %EOD;

PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:510  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$BREAK_COMMON.
PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:511  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$BREAK_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)   r     1 FPT_TRMPRG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @XUG_WORK$                 4-0-0/w PTR         r     1 XUG$
    *0-0-0/w PTR         r     1 XUG_WORK$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$UC                       0-0-0/d STRC(9612)  r     1 XUG


   Procedure XUG$BREAK_COMMON requires 33 words for executable code.
   Procedure XUG$BREAK_COMMON requires 6 words of local(AUTO) storage.
PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:512  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=XUG$BREAK_COMMON File=XUG$COMMON.:E05TSI                      WED 07/30/97 09:24 Page:513  
          MINI XREF LISTING

FPT_TRMPRG
      5584**DCL      9242<>CALL
FPT_TRMPRG.V
      5591**DCL      5586--DCLINIT
FPT_TRMPRG.V.CTLFLG.RSTBRK#
      5592**DCL      5593--REDEF
M$TRMPRG
      5520**DCL-ENT  9242--CALL
XUG.BIP
      9057**DCL      9240<<ASSIGN   9240>>ASSIGN   9244>>IF
XUG.BREAK
      8905**DCL      9241<<ASSIGN
XUG.BUF
      9232**DCL      9235--REDEF
XUG.CONTINUE
      8827**DCL      9246>>IF       9246>>CALL
XUG$
      8791**DCL      8796--IMP-PTR  9239<<ASSIGN   9240>>ASSIGN   9240>>ASSIGN   9241>>ASSIGN   9244>>IF
      9246>>IF       9246>>CALL
XUG$BRKSUB
      5597**DCL-ENT  9245--CALL
XUG_WORK$
      8789**DCL         6--PROC     9239>>ASSIGN   9245<>CALL

PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:514  
     2761        1        /*T***********************************************************/
     2762        2        /*T*                                                         */
     2763        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2764        4        /*T*                                                         */
     2765        5        /*T***********************************************************/
     2766        6        XUG$DISABLE_COMMON: PROC (GETCMD) ;
     2767        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2768        8    1   DCL FLG UBIN;
     2769        9        /**/
     2770       10        %INCLUDE CP_6;
     2771     5569        %INCLUDE CP_6_SUBS;
     2772     6109        /**/
     2773     6110        %FPT_WRITE (BUF=BRKMSG,DCB=M$UC,VFC=YES,STCLASS=CONSTANT);
     2774     6141        %FPT_READ (DCB=M$UC,STCLASS=CONSTANT,FPTN=FPT_READ_C);
     2775     6180        %FPT_READ (STCLASS=AUTO);
     2776     6219        %F$DCB;
     2777     6276    1   DCL 1 BRKMSG CONSTANT,
     2778     6277    1         2 * CHAR(1) INIT(%BITASC('037'O)),
     2779     6278    1         2 * CHAR(0) INIT('Break!  C to continue.');
     2780     6279        /**/
     2781     6280    1   DCL SAVECHAR CHAR(1);
     2782     6281    1   DCL CHARBASE CHAR(1) BASED;
     2783     6282        /**/
     2784     6283    1   DCL XUG$ PTR;
     2785     6284
     2786     6285        %INCLUDE XU_MACRO_C;
     2787     9391        %INCLUDE XUH_MACRO_C ;
     2788     9475    1   DCL XUG_BUILTIN_N ENTRY CONV(5) ; /* This is to satisfy the LINKer. */
     2789     9476        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     2790     9814        %XUG_PARAMS;
     2791    10258        %XUG_INIT (NAME=XUG_INIT_C, STCLASS=SYMREF);
     2792    10671        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
     2793    11084    1   DCL XUG$INIT_COMMON ENTRY (2) ALTRET;
     2794    11085    1   DCL P$ PTR ;
     2795    11086    1   DCL XUG$WORK$ PTR BASED(P$) ;
     2796    11087        %EJECT;
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:515  
     2797    11088    1       IF GETCMD.WORK$ = ADDR(NIL)
     2798    11089    1       THEN
     2799    11090    2       DO ;
     2800    11091    2           XUG_INIT_A = XUG_INIT_C ;
     2801    11092    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) WHENALTRETURN
     2802    11093    3           DO ;
     2803    11094    3           END ; /* Whenaltreturn Do */
     2804    11095    2       END ; /* Then Do */
     2805    11096    1       XUG$ = GETCMD.WORK$ ;
     2806    11097    2       DO INHIBIT;
     2807    11098    2           XUG.DISLVL=XUG.DISLVL+1;
     2808    11099    2           IF XUG.DISLVL=1 THEN XUG.BIP=1;
     2809    11100    2       END;
     2810    11101    1       RETURN;
     2811    11102    1   XUG$CLRENABLE_COMMON: ENTRY (GETCMD) ;
     2812    11103    1       IF GETCMD.WORK$ = ADDR(NIL)
     2813    11104    1       THEN
     2814    11105    2       DO ;
     2815    11106    2           XUG_INIT_A = XUG_INIT_C ;
     2816    11107    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) WHENALTRETURN
     2817    11108    3           DO ;
     2818    11109    3           END ; /* Whenaltreturn Do */
     2819    11110    2       END ; /* Then Do */
     2820    11111    1       XUG$ = GETCMD.WORK$ ;
     2821    11112    1       XUG.BREAK='0'B;
     2822    11113    1   XUG$ENABLE_COMMON: ENTRY (GETCMD);
     2823    11114    1       IF GETCMD.WORK$ = ADDR(NIL)
     2824    11115    1       THEN
     2825    11116    2       DO ;
     2826    11117    2           XUG_INIT_A = XUG_INIT_C ;
     2827    11118    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) WHENALTRETURN
     2828    11119    3           DO ;
     2829    11120    3           END ; /* Whenaltreturn Do */
     2830    11121    2       END ; /* Then Do */
     2831    11122    1       XUG$ = GETCMD.WORK$ ;
     2832    11123    2       DO INHIBIT;
     2833    11124    2           IF XUG.DISLVL=0 THEN RETURN;
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:516  
     2834    11125    2           XUG.DISLVL=XUG.DISLVL-1;
     2835    11126    2           IF NOT XUG.DISLVL=0 THEN RETURN;
     2836    11127    2           XUG.BIP = 0;
     2837    11128    2           FLG = 0;
     2838    11129    2           IF XUG.BREAK
     2839    11130    2           THEN
     2840    11131    2               CALL BRKSUB ;
     2841    11132    2           RETURN;
     2842    11133    2       END;
     2843    11134        /**/
     2844    11135    1   XUG$SIMULATE_BREAK_COMMON: ENTRY (GETCMD);
     2845    11136    1       IF GETCMD.WORK$ = ADDR(NIL)
     2846    11137    2       THEN DO;
     2847    11138    2           XUG_INIT_A = XUG_INIT_C;
     2848    11139    3           CALL XUG$INIT_COMMON (GETCMD, XUG_INIT_A) WHENALTRETURN DO; END;
     2849    11140    2       END;
     2850    11141    1       XUG$ = GETCMD.WORK$;
     2851    11142    2       DO INHIBIT;
     2852    11143    2           XUG.BIP = XUG.BIP + 1;
     2853    11144    2           IF XUG.BIP > 1
     2854    11145    2           THEN
     2855    11146    2               RETURN;
     2856    11147    2           FLG = 0;
     2857    11148    2           CALL BRKSUB;
     2858    11149    2       END;
     2859    11150    1       RETURN;
     2860    11151    1   XUG$BRKSUB: ENTRY (GETCMD) ;
     2861    11152    1       P$ = ADDR(GETCMD) ;
     2862    11153    1       XUG$ = XUG$WORK$ ;
     2863    11154    1       FLG = 1;
     2864    11155    1       CALL BRKSUB;
     2865    11156    1       RETURN;
     2866    11157    1   BRKSUB: PROC;
     2867    11158    3       DO INHIBIT;
     2868    11159    3           XUG.BREAK='0'B;
     2869    11160    3           IF XUG.BRKMSG ~= ENTADDR(NIL) THEN
     2870    11161    3               CALL XUG.BRKMSG ALTRET (STDMSG);
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:517  
     2871    11162    3           ELSE
     2872    11163    4   STDMSG:     CALL M$WRITE (FPT_WRITE) WHENALTRETURN DO ;
     2873    11164    4               END ;
     2874    11165    3           FPT_READ = FPT_READ_C;
     2875    11166    3           FPT_READ.BUF_=XUG.BUFVEC;
     2876    11167    3           SAVECHAR=VBASE(XUG.BUFVEC)->CHARBASE;
     2877    11168    3           CALL M$READ (FPT_READ)
     2878    11169    4           WHENRETURN DO;
     2879    11170    4               XUG.BRKARS = DCBADDR(DCBNUM(M$UC)) -> F$DCB.ARS#;
     2880    11171    4               XUG.GOTCMD_EOMCHAR = DCBADDR(DCBNUM(M$UC)) -> F$DCB.EOMCHAR#;
     2881    11172    4           END;
     2882    11173    4           WHENALTRETURN DO;
     2883    11174    4               XUG.BRKARS = 0;
     2884    11175    4               XUG.GOTCMD_EOMCHAR = %EOM_EOR#;
     2885    11176    4           END;
     2886    11177    3           XUG.BIP=0;
     2887    11178    3           XUG.BREAK='0'B;
     2888    11179    4           IF XUG.BRKARS=1 AND (VBASE(XUG.BUFVEC)->CHARBASE='C' OR VBASE(XUG.BUFVEC)->
             11179                    CHARBASE='c') THEN DO INHIBIT;
     2889    11180    4               VBASE(XUG.BUFVEC)->CHARBASE=SAVECHAR;
     2890    11181    4               RETURN;
     2891    11182    4           END;
     2892    11183    3           IF FLG ~= 0
     2893    11184    3           THEN
     2894    11185    4               CALL M$CLRSTK WHENALTRETURN DO ;
     2895    11186    4               END ;
     2896    11187    3           IF XUG.BRKARS>0 THEN XUG.GOTCMD='1'B;
     2897    11188    3           CALL XUG.ABORT;
     2898    11189    3           RETURN;                    /* SHOULD NEVER GET HERE */
     2899    11190    3       END;
     2900    11191    2   END BRKSUB;
     2901    11192    1   END XUG$DISABLE_COMMON;
     2902    11193        %EOD;

PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:518  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$DISABLE_COMMON.

   Procedure XUG$DISABLE_COMMON requires 222 words for executable code.
   Procedure XUG$DISABLE_COMMON requires 64 words of local(AUTO) storage.

PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:519  

 Object Unit name= XUG$DISABLE_COMMON                         File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:24:56.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     32     40  XUG$DISABLE_COMMON
    2   Proc  even  none   222    336  XUG$DISABLE_COMMON
    3  RoData even  none     4      4  XUG$DISABLE_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  XUG$DISABLE_COMMON
     2     35                  yes      Std        1  XUG$CLRENABLE_COMMON
     2     66                  yes      Std        1  XUG$ENABLE_COMMON
     2    134                  yes      Std        1  XUG$SIMULATE_BREAK_COMMON
     2    173                  yes      Std        1  XUG$BRKSUB

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XUG_BUILTIN_N
 yes     yes           Std       2 XUG$INIT_COMMON
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:520  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  XUG_INIT_C                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:521  


     2761        1        /*T***********************************************************/
     2762        2        /*T*                                                         */
     2763        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2764        4        /*T*                                                         */
     2765        5        /*T***********************************************************/
     2766        6        XUG$DISABLE_COMMON: PROC (GETCMD) ;

      6  2 000000   000000 700200 xent  XUG$DISABLE* TSX0  ! X66_AUTO_1
         2 000001   000100 000001                    ZERO    64,1

     2767        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2768        8    1   DCL FLG UBIN;
     2769        9        /**/
     2770       10        %INCLUDE CP_6;
     2771     5569        %INCLUDE CP_6_SUBS;
     2772     6109        /**/
     2773     6110        %FPT_WRITE (BUF=BRKMSG,DCB=M$UC,VFC=YES,STCLASS=CONSTANT);
     2774     6141        %FPT_READ (DCB=M$UC,STCLASS=CONSTANT,FPTN=FPT_READ_C);
     2775     6180        %FPT_READ (STCLASS=AUTO);
     2776     6219        %F$DCB;
     2777     6276    1   DCL 1 BRKMSG CONSTANT,
     2778     6277    1         2 * CHAR(1) INIT(%BITASC('037'O)),
     2779     6278    1         2 * CHAR(0) INIT('Break!  C to continue.');
     2780     6279        /**/
     2781     6280    1   DCL SAVECHAR CHAR(1);
     2782     6281    1   DCL CHARBASE CHAR(1) BASED;
     2783     6282        /**/
     2784     6283    1   DCL XUG$ PTR;
     2785     6284
     2786     6285        %INCLUDE XU_MACRO_C;
     2787     9391        %INCLUDE XUH_MACRO_C ;
     2788     9475    1   DCL XUG_BUILTIN_N ENTRY CONV(5) ; /* This is to satisfy the LINKer. */
     2789     9476        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     2790     9814        %XUG_PARAMS;
     2791    10258        %XUG_INIT (NAME=XUG_INIT_C, STCLASS=SYMREF);
     2792    10671        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:522  
     2793    11084    1   DCL XUG$INIT_COMMON ENTRY (2) ALTRET;
     2794    11085    1   DCL P$ PTR ;
     2795    11086    1   DCL XUG$WORK$ PTR BASED(P$) ;
     2796    11087        %EJECT;
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:523  
     2797    11088    1       IF GETCMD.WORK$ = ADDR(NIL)

  11088  2 000002   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000003   000004 236100                    LDQ     4,,PR0
         2 000004   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000005   000022 601000 2                  TNZ     s:11096

     2798    11089    1       THEN
     2799    11090    2       DO ;

     2800    11091    2           XUG_INIT_A = XUG_INIT_C ;

  11091  2 000006   000100 100400                    MLR     fill='000'O
         2 000007   000000 000220 xsym               ADSC9   XUG_INIT_C               cn=0,n=144
         2 000010   200026 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

     2801    11092    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) WHENALTRETURN

  11092  2 000011   200026 631500                    EPPR1   XUG_INIT_A,,AUTO
         2 000012   200077 451500                    STP1    P$+5,,AUTO
         2 000013   200003 236100                    LDQ     @GETCMD,,AUTO
         2 000014   200076 756100                    STQ     P$+4,,AUTO
         2 000015   200076 630500                    EPPR0   P$+4,,AUTO
         2 000016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000017   000000 701000 xent               TSX1    XUG$INIT_COMMON
         2 000020   000022 702000 2                  TSX2    s:11096
         2 000021   000022 710000 2                  TRA     s:11096

     2802    11093    3           DO ;

     2803    11094    3           END ; /* Whenaltreturn Do */

     2804    11095    2       END ; /* Then Do */

     2805    11096    1       XUG$ = GETCMD.WORK$ ;

  11096  2 000022   200003 470500                    LDP0    @GETCMD,,AUTO
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:524  
         2 000023   000004 236100                    LDQ     4,,PR0
         2 000024   200025 756100                    STQ     XUG$,,AUTO

     2806    11097    2       DO INHIBIT;

     2807    11098    2           XUG.DISLVL=XUG.DISLVL+1;

  11098  2 000025   200025 471700                    LDP1  ! XUG$,,AUTO
         2 000026   100103 054300                    AOS   ! 67,,PR1

     2808    11099    2           IF XUG.DISLVL=1 THEN XUG.BIP=1;

  11099  2 000027   100103 235300                    LDA   ! 67,,PR1
         2 000030   000001 115207                    CMPA  ! 1,DL
         2 000031   000034 601200 2                  TNZ   ! s:11101

  11099  2 000032   000001 235207                    LDA   ! 1,DL
         2 000033   100102 755300                    STA   ! 66,,PR1

     2809    11100    2       END;

     2810    11101    1       RETURN;

  11101  2 000034   000000 702200 xent               TSX2  ! X66_ARET

     2811    11102    1   XUG$CLRENABLE_COMMON: ENTRY (GETCMD) ;

  11102  2 000035   000000 700200 xent  XUG$CLRENAB* TSX0  ! X66_AUTO_1
         2 000036   000100 000001                    ZERO    64,1

     2812    11103    1       IF GETCMD.WORK$ = ADDR(NIL)

  11103  2 000037   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000040   000004 236100                    LDQ     4,,PR0
         2 000041   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000042   000057 601000 2                  TNZ     s:11111

PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:525  
     2813    11104    1       THEN
     2814    11105    2       DO ;

     2815    11106    2           XUG_INIT_A = XUG_INIT_C ;

  11106  2 000043   000100 100400                    MLR     fill='000'O
         2 000044   000000 000220 xsym               ADSC9   XUG_INIT_C               cn=0,n=144
         2 000045   200026 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

     2816    11107    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) WHENALTRETURN

  11107  2 000046   200026 631500                    EPPR1   XUG_INIT_A,,AUTO
         2 000047   200077 451500                    STP1    P$+5,,AUTO
         2 000050   200003 236100                    LDQ     @GETCMD,,AUTO
         2 000051   200076 756100                    STQ     P$+4,,AUTO
         2 000052   200076 630500                    EPPR0   P$+4,,AUTO
         2 000053   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000054   000000 701000 xent               TSX1    XUG$INIT_COMMON
         2 000055   000057 702000 2                  TSX2    s:11111
         2 000056   000057 710000 2                  TRA     s:11111

     2817    11108    3           DO ;

     2818    11109    3           END ; /* Whenaltreturn Do */

     2819    11110    2       END ; /* Then Do */

     2820    11111    1       XUG$ = GETCMD.WORK$ ;

  11111  2 000057   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000060   000004 236100                    LDQ     4,,PR0
         2 000061   200025 756100                    STQ     XUG$,,AUTO

     2821    11112    1       XUG.BREAK='0'B;

  11112  2 000062   200025 471500                    LDP1    XUG$,,AUTO
         2 000063   000000 236000 3                  LDQ     0
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:526  
         2 000064   100071 356100                    ANSQ    57,,PR1
         2 000065   000070 710000 2                  TRA     s:11114

     2822    11113    1   XUG$ENABLE_COMMON: ENTRY (GETCMD);

  11113  2 000066   000000 700200 xent  XUG$ENABLE_* TSX0  ! X66_AUTO_1
         2 000067   000100 000001                    ZERO    64,1

     2823    11114    1       IF GETCMD.WORK$ = ADDR(NIL)

  11114  2 000070   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000071   000004 236100                    LDQ     4,,PR0
         2 000072   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000073   000110 601000 2                  TNZ     s:11122

     2824    11115    1       THEN
     2825    11116    2       DO ;

     2826    11117    2           XUG_INIT_A = XUG_INIT_C ;

  11117  2 000074   000100 100400                    MLR     fill='000'O
         2 000075   000000 000220 xsym               ADSC9   XUG_INIT_C               cn=0,n=144
         2 000076   200026 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

     2827    11118    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) WHENALTRETURN

  11118  2 000077   200026 631500                    EPPR1   XUG_INIT_A,,AUTO
         2 000100   200077 451500                    STP1    P$+5,,AUTO
         2 000101   200003 236100                    LDQ     @GETCMD,,AUTO
         2 000102   200076 756100                    STQ     P$+4,,AUTO
         2 000103   200076 630500                    EPPR0   P$+4,,AUTO
         2 000104   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000105   000000 701000 xent               TSX1    XUG$INIT_COMMON
         2 000106   000110 702000 2                  TSX2    s:11122
         2 000107   000110 710000 2                  TRA     s:11122

     2828    11119    3           DO ;
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:527  

     2829    11120    3           END ; /* Whenaltreturn Do */

     2830    11121    2       END ; /* Then Do */

     2831    11122    1       XUG$ = GETCMD.WORK$ ;

  11122  2 000110   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000111   000004 236100                    LDQ     4,,PR0
         2 000112   200025 756100                    STQ     XUG$,,AUTO

     2832    11123    2       DO INHIBIT;

     2833    11124    2           IF XUG.DISLVL=0 THEN RETURN;

  11124  2 000113   200025 471700                    LDP1  ! XUG$,,AUTO
         2 000114   100103 235300                    LDA   ! 67,,PR1
         2 000115   000117 601200 2                  TNZ   ! s:11125

  11124  2 000116   000000 702200 xent               TSX2  ! X66_ARET

     2834    11125    2           XUG.DISLVL=XUG.DISLVL-1;

  11125  2 000117   000001 336207                    LCQ   ! 1,DL
         2 000120   100103 056300                    ASQ   ! 67,,PR1

     2835    11126    2           IF NOT XUG.DISLVL=0 THEN RETURN;

  11126  2 000121   000123 600200 2                  TZE   ! s:11127

  11126  2 000122   000000 702200 xent               TSX2  ! X66_ARET

     2836    11127    2           XUG.BIP = 0;

  11127  2 000123   100102 450300                    STZ   ! 66,,PR1

     2837    11128    2           FLG = 0;
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:528  

  11128  2 000124   200004 450300                    STZ   ! FLG,,AUTO

     2838    11129    2           IF XUG.BREAK

  11129  2 000125   100071 236300                    LDQ   ! 57,,PR1
         2 000126   040000 316203                    CANQ  ! 16384,DU
         2 000127   000132 600200 2                  TZE   ! s:11132

     2839    11130    2           THEN
     2840    11131    2               CALL BRKSUB ;

  11131  2 000130   000207 701200 2                  TSX1  ! BRKSUB
         2 000131   000000 011200                    NOP   ! 0

     2841    11132    2           RETURN;

  11132  2 000132   000000 702200 xent               TSX2  ! X66_ARET

     2842    11133    2       END;

  11133  2 000133   000136 710000 2                  TRA     s:11136

     2843    11134        /**/
     2844    11135    1   XUG$SIMULATE_BREAK_COMMON: ENTRY (GETCMD);

  11135  2 000134   000000 700200 xent  XUG$SIMULAT* TSX0  ! X66_AUTO_1
         2 000135   000100 000001                    ZERO    64,1

     2845    11136    1       IF GETCMD.WORK$ = ADDR(NIL)

  11136  2 000136   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000137   000004 236100                    LDQ     4,,PR0
         2 000140   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000141   000156 601000 2                  TNZ     s:11141

     2846    11137    2       THEN DO;
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:529  

     2847    11138    2           XUG_INIT_A = XUG_INIT_C;

  11138  2 000142   000100 100400                    MLR     fill='000'O
         2 000143   000000 000220 xsym               ADSC9   XUG_INIT_C               cn=0,n=144
         2 000144   200026 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

     2848    11139    3           CALL XUG$INIT_COMMON (GETCMD, XUG_INIT_A) WHENALTRETURN DO; END;

  11139  2 000145   200026 631500                    EPPR1   XUG_INIT_A,,AUTO
         2 000146   200077 451500                    STP1    P$+5,,AUTO
         2 000147   200003 236100                    LDQ     @GETCMD,,AUTO
         2 000150   200076 756100                    STQ     P$+4,,AUTO
         2 000151   200076 630500                    EPPR0   P$+4,,AUTO
         2 000152   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000153   000000 701000 xent               TSX1    XUG$INIT_COMMON
         2 000154   000156 702000 2                  TSX2    s:11141
         2 000155   000156 710000 2                  TRA     s:11141

     2849    11140    2       END;

     2850    11141    1       XUG$ = GETCMD.WORK$;

  11141  2 000156   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000157   000004 236100                    LDQ     4,,PR0
         2 000160   200025 756100                    STQ     XUG$,,AUTO

     2851    11142    2       DO INHIBIT;

     2852    11143    2           XUG.BIP = XUG.BIP + 1;

  11143  2 000161   200025 471700                    LDP1  ! XUG$,,AUTO
         2 000162   100102 054300                    AOS   ! 66,,PR1

     2853    11144    2           IF XUG.BIP > 1

  11144  2 000163   100102 235300                    LDA   ! 66,,PR1
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:530  
         2 000164   000001 115207                    CMPA  ! 1,DL
         2 000165   000167 604600 2                  TMOZ  ! s:11147

     2854    11145    2           THEN
     2855    11146    2               RETURN;

  11146  2 000166   000000 702200 xent               TSX2  ! X66_ARET

     2856    11147    2           FLG = 0;

  11147  2 000167   200004 450300                    STZ   ! FLG,,AUTO

     2857    11148    2           CALL BRKSUB;

  11148  2 000170   000207 701200 2                  TSX1  ! BRKSUB
         2 000171   000000 011200                    NOP   ! 0

     2858    11149    2       END;

     2859    11150    1       RETURN;

  11150  2 000172   000000 702200 xent               TSX2  ! X66_ARET

     2860    11151    1   XUG$BRKSUB: ENTRY (GETCMD) ;

  11151  2 000173   000000 700200 xent  XUG$BRKSUB   TSX0  ! X66_AUTO_1
         2 000174   000100 000001                    ZERO    64,1

     2861    11152    1       P$ = ADDR(GETCMD) ;

  11152  2 000175   200003 236100                    LDQ     @GETCMD,,AUTO
         2 000176   200072 756100                    STQ     P$,,AUTO

     2862    11153    1       XUG$ = XUG$WORK$ ;

  11153  2 000177   200072 470500                    LDP0    P$,,AUTO
         2 000200   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:531  
         2 000201   200025 756100                    STQ     XUG$,,AUTO

     2863    11154    1       FLG = 1;

  11154  2 000202   000001 235007                    LDA     1,DL
         2 000203   200004 755100                    STA     FLG,,AUTO

     2864    11155    1       CALL BRKSUB;

  11155  2 000204   000207 701000 2                  TSX1    BRKSUB
         2 000205   000000 011000                    NOP     0

     2865    11156    1       RETURN;

  11156  2 000206   000000 702200 xent               TSX2  ! X66_ARET

     2866    11157    1   BRKSUB: PROC;

  11157  2 000207   200074 741300       BRKSUB       STX1  ! P$+2,,AUTO

     2867    11158    3       DO INHIBIT;

     2868    11159    3           XUG.BREAK='0'B;

  11159  2 000210   200025 470700                    LDP0  ! XUG$,,AUTO
         2 000211   000000 236200 3                  LDQ   ! 0
         2 000212   000071 356300                    ANSQ  ! 57,,PR0

     2869    11160    3           IF XUG.BRKMSG ~= ENTADDR(NIL) THEN

  11160  2 000213   000022 236300                    LDQ   ! 18,,PR0
         2 000214   000002 116200 xsym               CMPQ  ! B_VECTNIL+2
         2 000215   000223 600200 2                  TZE   ! STDMSG

     2870    11161    3               CALL XUG.BRKMSG ALTRET (STDMSG);

  11161  2 000216   000022 220300                    LDX0  ! 18,,PR0
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:532  
         2 000217   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         2 000220   000000 701210                    TSX1  ! 0,X0
         2 000221   000223 702200 2                  TSX2  ! STDMSG
         2 000222   000230 710200 2                  TRA   ! s:11165

     2871    11162    3           ELSE
     2872    11163    4   STDMSG:     CALL M$WRITE (FPT_WRITE) WHENALTRETURN DO ;

  11163  2 000223   000000 630600 1     STDMSG       EPPR0 ! FPT_WRITE
         2 000224   440001 713600                    CLIMB ! alt,write
         2 000225   401400 401760                    pmme    nvectors=4
         2 000226   000230 702200 2                  TSX2  ! s:11165
         2 000227   000230 710200 2                  TRA   ! s:11165

     2873    11164    4               END ;

     2874    11165    3           FPT_READ = FPT_READ_C;

  11165  2 000230   000100 100600                    MLR   ! fill='000'O
         2 000231   000014 000070 1                  ADSC9   FPT_READ_C               cn=0,n=56
         2 000232   200006 000070                    ADSC9   FPT_READ,,AUTO           cn=0,n=56

     2875    11166    3           FPT_READ.BUF_=XUG.BUFVEC;

  11166  2 000233   200025 470700                    LDP0  ! XUG$,,AUTO
         2 000234   000000 237300                    LDAQ  ! 0,,PR0
         2 000235   200012 757300                    STAQ  ! FPT_READ+4,,AUTO

     2876    11167    3           SAVECHAR=VBASE(XUG.BUFVEC)->CHARBASE;

  11167  2 000236   000001 471700                    LDP1  ! 1,,PR0
         2 000237   040100 100700                    MLR   ! fill='040'O
         2 000240   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 000241   200024 000001                    ADSC9   SAVECHAR,,AUTO           cn=0,n=1

     2877    11168    3           CALL M$READ (FPT_READ)

PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:533  
  11168  2 000242   200006 630700                    EPPR0 ! FPT_READ,,AUTO
         2 000243   440000 713600                    CLIMB ! alt,read
         2 000244   401400 401760                    pmme    nvectors=4
         2 000245   000263 702200 2                  TSX2  ! s:11174

     2878    11169    4           WHENRETURN DO;

     2879    11170    4               XUG.BRKARS = DCBADDR(DCBNUM(M$UC)) -> F$DCB.ARS#;

  11170  2 000246   000000 236207 xsym               LDQ   ! M$UC,DL
         2 000247   000001 470600 3                  LDP0  ! 1
         2 000250   000000 471700                    LDP1  ! 0,,PR0
         2 000251   100000 473706                    LDP3  ! 0,QL,PR1
         2 000252   200025 474700                    LDP4  ! XUG$,,AUTO
         2 000253   300000 235300                    LDA   ! 0,,PR3
         2 000254   400101 755300                    STA   ! 65,,PR4

     2880    11171    4               XUG.GOTCMD_EOMCHAR = DCBADDR(DCBNUM(M$UC)) -> F$DCB.EOMCHAR#;

  11171  2 000255   000000 236207 xsym               LDQ   ! M$UC,DL
         2 000256   100000 473706                    LDP3  ! 0,QL,PR1
         2 000257   300003 236300                    LDQ   ! 3,,PR3
         2 000260   000033 736200                    QLS   ! 27
         2 000261   400266 552340                    STBQ  ! 182,'40'O,PR4

     2881    11172    4           END;

  11172  2 000262   000267 710200 2                  TRA   ! s:11177

     2882    11173    4           WHENALTRETURN DO;

     2883    11174    4               XUG.BRKARS = 0;

  11174  2 000263   200025 470700                    LDP0  ! XUG$,,AUTO
         2 000264   000101 450300                    STZ   ! 65,,PR0

     2884    11175    4               XUG.GOTCMD_EOMCHAR = %EOM_EOR#;
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:534  

  11175  2 000265   501000 236203                    LDQ   ! -97792,DU
         2 000266   000266 552340                    STBQ  ! 182,'40'O,PR0

     2885    11176    4           END;

     2886    11177    3           XUG.BIP=0;

  11177  2 000267   200025 470700                    LDP0  ! XUG$,,AUTO
         2 000270   000102 450300                    STZ   ! 66,,PR0

     2887    11178    3           XUG.BREAK='0'B;

  11178  2 000271   000000 236200 3                  LDQ   ! 0
         2 000272   000071 356300                    ANSQ  ! 57,,PR0

     2888    11179    4           IF XUG.BRKARS=1 AND (VBASE(XUG.BUFVEC)->CHARBASE='C' OR VBASE(XUG.BUFVEC)->
             11179                    CHARBASE='c') THEN DO INHIBIT;

  11179  2 000273   000101 235300                    LDA   ! 65,,PR0
         2 000274   000001 115207                    CMPA  ! 1,DL
         2 000275   000314 601200 2                  TNZ   ! s:11183
         2 000276   000001 471700                    LDP1  ! 1,,PR0
         2 000277   040000 106700                    CMPC  ! fill='040'O
         2 000300   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 000301   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000302   000307 600200 2                  TZE   ! s:11180
         2 000303   040000 106700                    CMPC  ! fill='040'O
         2 000304   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 000305   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 000306   000314 601200 2                  TNZ   ! s:11183

     2889    11180    4               VBASE(XUG.BUFVEC)->CHARBASE=SAVECHAR;

  11180  2 000307   040100 100700                    MLR   ! fill='040'O
         2 000310   200024 000001                    ADSC9   SAVECHAR,,AUTO           cn=0,n=1
         2 000311   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:535  

     2890    11181    4               RETURN;

  11181  2 000312   200074 221300                    LDX1  ! P$+2,,AUTO
         2 000313   000001 702211                    TSX2  ! 1,X1

     2891    11182    4           END;

     2892    11183    3           IF FLG ~= 0

  11183  2 000314   200004 235300                    LDA   ! FLG,,AUTO
         2 000315   000322 600200 2                  TZE   ! s:11187

     2893    11184    3           THEN
     2894    11185    4               CALL M$CLRSTK WHENALTRETURN DO ;

  11185  2 000316   410013 713600                    CLIMB ! alt,+4107
         2 000317   000000 401760                    pmme    nvectors=0
         2 000320   000322 702200 2                  TSX2  ! s:11187
         2 000321   000322 710200 2                  TRA   ! s:11187

     2895    11186    4               END ;

     2896    11187    3           IF XUG.BRKARS>0 THEN XUG.GOTCMD='1'B;

  11187  2 000322   200025 470700                    LDP0  ! XUG$,,AUTO
         2 000323   000101 235300                    LDA   ! 65,,PR0
         2 000324   000327 604600 2                  TMOZ  ! s:11188

  11187  2 000325   100000 236203                    LDQ   ! 32768,DU
         2 000326   000071 256300                    ORSQ  ! 57,,PR0

     2897    11188    3           CALL XUG.ABORT;

  11188  2 000327   000020 220300                    LDX0  ! 16,,PR0
         2 000330   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         2 000331   000000 701210                    TSX1  ! 0,X0
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:536  
         2 000332   000000 011200                    NOP   ! 0

     2898    11189    3           RETURN;                    /* SHOULD NEVER GET HERE */

  11189  2 000333   200074 221300                    LDX1  ! P$+2,,AUTO
         2 000334   000001 702211                    TSX2  ! 1,X1

     2899    11190    3       END;

     2900    11191    2   END BRKSUB;

  11191  2 000335   000001 702211                    TSX2  ! 1,X1
     2901    11192    1   END XUG$DISABLE_COMMON;
     2902    11193        %EOD;

PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:537  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$DISABLE_COMMON.
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:538  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$DISABLE_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    32-0-0/c STRC(207)   r     1 BRKMSG                    14-0-0/d STRC(504)   r     1 FPT_READ_C
     0-0-0/d STRC(432)   r     1 FPT_WRITE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GETCMD                    4-0-0/w UBIN        r     1 FLG
     6-0-0/d STRC(504)   r     1 FPT_READ                  *0-0-0/d STRC(1512)  r     1 GETCMD
    72-0-0/w PTR         r     1 P$                        24-0-0/c CHAR        r     1 SAVECHAR
    25-0-0/w PTR         r     1 XUG$                      26-0-0/d STRC(1296)  r     1 XUG_INIT_A

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1296)  r     1 XUG_INIT_C

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 CHARBASE                   0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$UC                       0-0-0/d STRC(9612)  r     1 XUG
     0-0-0/w PTR         r     1 XUG$WORK$

PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:539  

   Procedure XUG$DISABLE_COMMON requires 222 words for executable code.
   Procedure XUG$DISABLE_COMMON requires 64 words of local(AUTO) storage.
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:540  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:541  
          MINI XREF LISTING

BRKMSG
      6276**DCL      6128--DCLINIT  6129--DCLINIT
BRKSUB
     11157**PROC    11131--CALL    11148--CALL    11155--CALL
CHARBASE
      6281**DCL     11167>>ASSIGN  11179>>IF      11179>>IF      11180<<ASSIGN
F$DCB.ACTPOS
      6252**DCL      6252--REDEF
F$DCB.ARS#
      6226**DCL      6226--REDEF   11170>>ASSIGN
F$DCB.ATTR
      6245**DCL      6246--REDEF
F$DCB.BORROW
      6260**DCL      6260--REDEF    6260--REDEF    6260--REDEF
F$DCB.DCBNAME.L
      6274**DCL      6274--IMP-SIZ
F$DCB.EOMCHAR#
      6230**DCL      6230--REDEF   11171>>ASSIGN
F$DCB.FLDID
      6255**DCL      6255--REDEF
F$DCB.FORM$
      6249**DCL      6249--REDEF
F$DCB.FSECT
      6265**DCL      6265--REDEF
F$DCB.FSN#
      6242**DCL      6242--REDEF    6242--REDEF    6243--REDEF
F$DCB.HEADER$
      6248**DCL      6248--REDEF
F$DCB.IXTNSIZE#
      6246**DCL      6246--REDEF
F$DCB.LASTSTA$
      6235**DCL      6235--REDEF
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:542  
F$DCB.LVL
      6261**DCL      6261--REDEF
F$DCB.NAME#.C
      6236**DCL      6236--REDEF
F$DCB.NOEOF
      6258**DCL      6258--REDEF
F$DCB.NRECS#
      6247**DCL      6247--REDEF
F$DCB.NRECX
      6266**DCL      6266--REDEF
F$DCB.OHDR
      6258**DCL      6258--REDEF
F$DCB.ORG#
      6241**DCL      6241--REDEF
F$DCB.PRECNO
      6264**DCL      6264--REDEF
F$DCB.RCSZ
      6270**DCL      6270--REDEF
F$DCB.RES#
      6237**DCL      6237--REDEF
F$DCB.SETX
      6249**DCL      6249--REDEF
F$DCB.TAB$
      6249**DCL      6249--REDEF
F$DCB.TDA
      6263**DCL      6264--REDEF
F$DCB.WSN#
      6237**DCL      6237--REDEF
FLG
         8**DCL     11128<<ASSIGN  11147<<ASSIGN  11154<<ASSIGN  11183>>IF
FPT_READ
      6197**DCL     11165<<ASSIGN  11168<>CALL
FPT_READ.BUF_
      6199**DCL     11166<<ASSIGN
FPT_READ.STATION_
      6200**DCL      6201--REDEF
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:543  
FPT_READ.V.DVBYTE.REREAD#
      6212**DCL      6212--REDEF
FPT_READ.V.INDX#
      6210**DCL      6210--REDEF
FPT_READ_C
      6158**DCL     11165>>ASSIGN
FPT_READ_C.STATION_
      6161**DCL      6162--REDEF
FPT_READ_C.V
      6162**DCL      6158--DCLINIT
FPT_READ_C.V.DVBYTE.REREAD#
      6173**DCL      6173--REDEF
FPT_READ_C.V.INDX#
      6171**DCL      6171--REDEF
FPT_WRITE
      6127**DCL     11163<>CALL
FPT_WRITE.STATION_
      6129**DCL      6129--REDEF
FPT_WRITE.V
      6130**DCL      6127--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      6136**DCL      6136--REDEF
GETCMD
      9489**DCL         6--PROC    11092<>CALL    11102--ENTRY   11107<>CALL    11113--ENTRY   11118<>CALL
     11135--ENTRY   11139<>CALL    11151--ENTRY   11152--ASSIGN
GETCMD.OUT$
      9494**DCL      9500--REDEF
GETCMD.WORK$
      9522**DCL     11088>>IF      11096>>ASSIGN  11103>>IF      11111>>ASSIGN  11114>>IF      11122>>ASSIGN
     11136>>IF      11141>>ASSIGN
M$CLRSTK
      5555**DCL-ENT 11185--CALL
M$READ
      5498**DCL-ENT 11168--CALL
M$UC
      5521**DCL     11170--ASSIGN  11171--ASSIGN
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:544  
M$WRITE
      5498**DCL-ENT 11163--CALL
P$
     11085**DCL     11086--IMP-PTR 11152<<ASSIGN  11153>>ASSIGN
SAVECHAR
      6280**DCL     11167<<ASSIGN  11180>>ASSIGN
STDMSG IN PROCEDURE BRKSUB
     11163**LABEL   11161--CALLALT
XUG.ABORT
      9845**DCL     11188>>CALL
XUG.BIP
     10078**DCL     11099<<ASSIGN  11127<<ASSIGN  11143<<ASSIGN  11143>>ASSIGN  11144>>IF      11177<<ASSIGN
XUG.BREAK
      9926**DCL     11112<<ASSIGN  11129>>IF      11159<<ASSIGN  11178<<ASSIGN
XUG.BRKARS
     10075**DCL     11170<<ASSIGN  11174<<ASSIGN  11179>>IF      11187>>IF
XUG.BRKMSG
      9852**DCL     11160>>IF      11161>>CALL
XUG.BUF
     10253**DCL     10256--REDEF
XUG.BUFVEC
      9818**DCL     11166>>ASSIGN  11167>>ASSIGN  11179>>IF      11179>>IF      11180>>ASSIGN
XUG.DISLVL
     10081**DCL     11098<<ASSIGN  11098>>ASSIGN  11099>>IF      11124>>IF      11125<<ASSIGN  11125>>ASSIGN
     11126>>IF
XUG.GOTCMD
      9922**DCL     11187<<ASSIGN
XUG.GOTCMD_EOMCHAR
     10200**DCL     11171<<ASSIGN  11175<<ASSIGN
XUG$
      6283**DCL      9817--IMP-PTR 11096<<ASSIGN  11098>>ASSIGN  11098>>ASSIGN  11099>>IF      11099>>ASSIGN
     11111<<ASSIGN  11112>>ASSIGN  11122<<ASSIGN  11124>>IF      11125>>ASSIGN  11125>>ASSIGN  11126>>IF
     11127>>ASSIGN  11129>>IF      11141<<ASSIGN  11143>>ASSIGN  11143>>ASSIGN  11144>>IF      11153<<ASSIGN
     11159>>ASSIGN  11160>>IF      11161>>CALL    11166>>ASSIGN  11167>>ASSIGN  11170>>ASSIGN  11171>>ASSIGN
     11174>>ASSIGN  11175>>ASSIGN  11177>>ASSIGN  11178>>ASSIGN  11179>>IF      11179>>IF      11179>>IF
     11180>>ASSIGN  11187>>IF      11187>>ASSIGN  11188>>CALL
PL6.E3A0      #009=XUG$DISABLE_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:24 Page:545  
XUG$INIT_COMMON
     11084**DCL-ENT 11092--CALL    11107--CALL    11118--CALL    11139--CALL
XUG$WORK$
     11086**DCL     11153>>ASSIGN
XUG_INIT_A
     10693**DCL     11091<<ASSIGN  11092<>CALL    11106<<ASSIGN  11107<>CALL    11117<<ASSIGN  11118<>CALL
     11138<<ASSIGN  11139<>CALL
XUG_INIT_C
     10280**DCL     11091>>ASSIGN  11106>>ASSIGN  11117>>ASSIGN  11138>>ASSIGN

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:546  
     2903        1        /*T***********************************************************/
     2904        2        /*T*                                                         */
     2905        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2906        4        /*T*                                                         */
     2907        5        /*T***********************************************************/
     2908        6        /* XUG$ERRMSG_COMMON - ERROR MESSAGE HANDLING ROUTINES FOR DEF */
     2909        7        /**/
     2910        8        XUG$ERRMSG_COMMON: PROC (GETCMD) ALTRET;
     2911        9        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2912       10        %INCLUDE XU_MACRO_C ;
     2913     3116        %INCLUDE XU_PERR_C;
     2914     3307        %INCLUDE XUH_MACRO_C ;
     2915     3391        %INCLUDE XT_MACRO_M;
     2916     3717        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     2917     4055    1   DCL FID$ PTR;                           /* FOR XUG$SETERRMSG */
     2918     4056    1   DCL 1 FID BASED(FID$),
     2919     4057    1         2 L UBIN BYTE UNAL,
     2920     4058    1         2 C CHAR(FID.L);
     2921     4059        /**/
     2922     4060    1   DCL XUG$CORRES_COMMON ENTRY(2) ALTRET;
     2923     4061    1   DCL XUG$FINDDCB_COMMON ENTRY(2) ALTRET;
     2924     4062    1   DCL XUG$INIT_COMMON ENTRY(2) ALTRET;
     2925     4063    1   DCL XUG$OPENOUT_INTERNAL ENTRY(2);
     2926     4064        /**/
     2927     4065    1   DCL M$DO DCB;
     2928     4066    1   DCL M$LO# SBIN;
     2929     4067        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
     2930     4068        DCL 1 NAME STCLASS,
     2931     4069              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
     2932     4070              2 C CHAR(0) INIT(T#);
     2933     4071        %MEND;
     2934     4072        %TEXTC (NAME=M$LO,T#='M$LO');
     2935     4077        %INCLUDE CP_6;
     2936     9636        %INCLUDE CP_6_SUBS;
     2937    10176    1   DCL ERRBUF CHAR(120) ;
     2938    10177        %FPT_ERRMSG (OUTDCB1=M$DO,SUBMESS=YES,INCLCODE=NO,
     2939    10178                     FLAGLEV=0,DCB=NIL,STCLASS=CONSTANT,FPTN=FPT_ERRMSG_C);
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:547  
     2940    10205        %FPT_ERRMSG (STCLASS=AUTO);
     2941    10232        %VLP_ERRCODE  (FPTN=TEMP_ERRCODE, STCLASS=AUTO);
     2942    10277        %VLP_ERRCODE  (FPTN=BASED_ERRCODE, STCLASS=BASED);
     2943    10322        %VLP_ERRCODE  (FPTN=XUG_SYNERR, STCLASS=CONSTANT,
     2944    10323                       FCG=XU, MID=G, ERR#=%E$SYNERR, SEV=0);
     2945    10368        %VLP_ERRCODE  (FPTN=XUR_SYNERR, STCLASS=CONSTANT,
     2946    10369                       FCG=XU, MID=R, ERR#=%E$SYNERR, SEV=0);
     2947    10414        %VLR_ERRMSG (FPTN=XUG_ERRMSG,STCLASS=AUTO);
     2948    10436        %FPT_FID (FPTN=FPT_FID_C, STCLASS=CONSTANT) ;
     2949    10459        %FPT_FID (STCLASS=AUTO);
     2950    10482        %VLR_FID (STCLASS=AUTO);
     2951    10501        /*
     2952    10502        */
     2953    10503    1   DCL XUG$ PTR ;
     2954    10504    1   DCL DOWNGRADE_INHIBIT BIT (1);
     2955    10505    1   DCL DCB# UBIN;
     2956    10506
     2957    10507        %XUG_PARAMS;
     2958    10951        %XUG_INIT (NAME=XUG_INIT_C, STCLASS=SYMREF);
     2959    11364        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
     2960    11777        %XT_PARAM (NAME= XT$PARAM , STCLASS=BASED);
     2961    12090        %EJECT;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:548  
     2962    12091    1       IF GETCMD.WORK$ = ADDR(NIL)
     2963    12092    2       THEN DO;
     2964    12093    2           XUG_INIT_A = XUG_INIT_C ;
     2965    12094    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) ALTRET(ALT) ;
     2966    12095    2       END ; /* Then Do */
     2967    12096    1       XUG$ = GETCMD.WORK$ ;
     2968    12097    1       XUG.HELP='0'B;
     2969    12098    1       DOWNGRADE_INHIBIT = %NO#;
     2970    12099    1       FPT_ERRMSG = FPT_ERRMSG_C;
     2971    12100    1       FPT_ERRMSG.V_ = VECTOR (FPT_ERRMSG.V);
     2972    12101    1       FPT_ERRMSG.RESULTS_ = VECTOR (XUG_ERRMSG);
     2973    12102    1       FPT_ERRMSG.BUF_ = VECTOR (ERRBUF);
     2974    12103    1       FPT_ERRMSG.CODE_ = VECTOR (XUG.ERRSAVE);
     2975    12104    1       IF NOT ( XUG.FILENAME.C = 0 )
     2976    12105    2       THEN DO;
     2977    12106    2           FPT_ERRMSG.FILEACCT_ = VECTOR (XUG.FILEACCT);
     2978    12107    2           FPT_ERRMSG.FILENAME_ = VECTOR (XUG.FILENAME);
     2979    12108    2           FPT_ERRMSG.FILEPASS_ = VECTOR (XUG.FILEPASS);
     2980    12109    2       END;
     2981    12110    1       FPT_ERRMSG.FIELD1_ = GETCMD.F1_;
     2982    12111    1       FPT_ERRMSG.FIELD2_ = GETCMD.F2_;
     2983    12112    1       FPT_ERRMSG.FIELD3_ = GETCMD.F3_;
     2984    12113    1       IF GETCMD.ERR_CODE = '0'B
     2985    12114    2       THEN DO;
     2986    12115    2           IF XUG.NO_INCREMENT
     2987    12116    2           THEN
     2988    12117    2               XUG.NO_INCREMENT = %NO#;
     2989    12118    3           ELSE DO;
     2990    12119    3               IF XUG.ERRSAVE.SEV = 7
     2991    12120    3               THEN
     2992    12121    3                   ALTRETURN;
     2993    12122    3               XUG.ERRSAVE.SEV = XUG.ERRSAVE.SEV + 1;
     2994    12123    3           END;
     2995    12124    2           FPT_ERRMSG.V.SUBMESS#='0'B;
     2996    12125    2           FPT_ERRMSG.FIELD1_ = XUG.F1SAVE;
     2997    12126    2           FPT_ERRMSG.FIELD2_ = XUG.F2SAVE;
     2998    12127    2           FPT_ERRMSG.FIELD3_ = XUG.F3SAVE;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:549  
     2999    12128    2       END;
     3000    12129    2       ELSE DO;
     3001    12130    2           IF GETCMD.INFOMSG#
     3002    12131    2             OR (XUG.NO_DOWNGRADE
     3003    12132    2             AND XUG.FIRST_ERROR
     3004    12133    2             AND XUG.LAST_FLAGLEV > GETCMD.FLGLEV#)
     3005    12134    3           THEN DO;
     3006    12135    3               DOWNGRADE_INHIBIT = %YES#;
     3007    12136    3               TEMP_ERRCODE = GETCMD.ERR_CODE;
     3008    12137    3               TEMP_ERRCODE.SEV = 0;
     3009    12138    3               FPT_ERRMSG.CODE_ = VECTOR (TEMP_ERRCODE);
     3010    12139    3           END;
     3011    12140    3           ELSE DO;
     3012    12141    3               XUG.ERRSAVE=GETCMD.ERR_CODE;
     3013    12142    3               XUG.ERRSAVE.SEV=0;
     3014    12143    3               XUG.LAST_FLAGLEV = GETCMD.FLGLEV#;
     3015    12144    3               XUG.FIRST_ERROR = %YES#;
     3016    12145    3               XUG.F1SAVE = GETCMD.F1_ ;
     3017    12146    3               XUG.F2SAVE = GETCMD.F2_ ;
     3018    12147    3               XUG.F3SAVE = GETCMD.F3_ ;
     3019    12148    3               IF GETCMD.XT_PARAM$ ~= ADDR(NIL)
     3020    12149    3               THEN
     3021    12150    3                   GETCMD.XT_PARAM$ -> XT$PARAM.ERR = XUG.ERRSAVE ;
     3022    12151    3           END;
     3023    12152    2           XUG.NO_INCREMENT = %NO#;
     3024    12153    2           FPT_ERRMSG.V.SUBMESS#='1'B;
     3025    12154    2           XUG.ERRDCB = DCBNUM(NIL);
     3026    12155    2       END;
     3027    12156    1       GETCMD.INFOMSG# = %NO# ;
     3028    12157    1       IF GETCMD.ERRDCB# ~= DCBNUM(NIL)
     3029    12158    1       THEN
     3030    12159    1           XUG.ERRDCB = GETCMD.ERRDCB# ;
     3031    12160    1       FPT_ERRMSG.V.DCB# = XUG.ERRDCB ;
     3032    12161    1       IF GETCMD.DCB_PARAM#=DCBNUM(NIL) AND GETCMD.DCB2_PARAM#=DCBNUM(NIL)
     3033    12162    2       THEN DO ;
     3034    12163    2           IF GETCMD.OUTDCB#~=DCBNUM(NIL)
     3035    12164    2           THEN
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:550  
     3036    12165    2               FPT_ERRMSG.V.OUTDCB2#=GETCMD.OUTDCB#;
     3037    12166    3           ELSE DO;
     3038    12167    3               CALL XUG$FINDDCB_COMMON(M$LO,M$LO#) ALTRET(NO_LO);
     3039    12168    3               FPT_ERRMSG.V.OUTDCB2#=M$LO#;
     3040    12169    3           END;
     3041    12170    2   NO_LO: END;
     3042    12171    1       IF GETCMD.DCB_PARAM#~=DCBNUM(NIL) AND GETCMD.DCB2_PARAM#~=DCBNUM(NIL)
     3043    12172    2       THEN DO ;
     3044    12173    2           FPT_ERRMSG.V.OUTDCB1#=GETCMD.DCB_PARAM# ;
     3045    12174    2           FPT_ERRMSG.V.OUTDCB2# = GETCMD.DCB2_PARAM# ;
     3046    12175    2       END ;
     3047    12176    1       ELSE
     3048    12177    1           IF GETCMD.DCB_PARAM#~=DCBNUM(NIL)
     3049    12178    1           THEN
     3050    12179    1               FPT_ERRMSG.V.OUTDCB1#=GETCMD.DCB_PARAM# ;
     3051    12180    1           ELSE
     3052    12181    1               IF GETCMD.DCB2_PARAM#~=DCBNUM(NIL)
     3053    12182    1               THEN
     3054    12183    1                   FPT_ERRMSG.V.OUTDCB2#=GETCMD.DCB2_PARAM# ;
     3055    12184    1       DCB# = FPT_ERRMSG.V.OUTDCB1#;
     3056    12185    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, DCB#);
     3057    12186    1       DCB# = FPT_ERRMSG.V.OUTDCB2#;
     3058    12187    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, DCB#);
     3059    12188    1       IF GETCMD.ERRMSG_VFC# ~= ' '
     3060    12189    1       THEN
     3061    12190    1           FPT_ERRMSG.V.VFC# = GETCMD.ERRMSG_VFC# ;
     3062    12191    1       FPT_ERRMSG.V.FLAGLEV# = GETCMD.FLGLEV# ;
     3063    12192    1       IF NOT XUG.POINTED_TO_SYNERR
     3064    12193    1         OR (VBASE(BITVECT(FPT_ERRMSG.CODE_))->BASED_ERRCODE ~= XUG_SYNERR
     3065    12194    1         AND VBASE(BITVECT(FPT_ERRMSG.CODE_))->BASED_ERRCODE ~= XUR_SYNERR)
     3066    12195    2       THEN DO;
     3067    12196    2           CALL M$ERRMSG(FPT_ERRMSG) ALTRET(ALT);
     3068    12197    2           IF FPT_ERRMSG.V.SUBMESS# AND NOT DOWNGRADE_INHIBIT
     3069    12198    2           THEN
     3070    12199    2               XUG.ERRSAVE = XUG_ERRMSG.CODEUSED;
     3071    12200    2       END;
     3072    12201    1       RETURN;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:551  
     3073    12202        %EJECT;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:552  
     3074    12203    1   XUG$SETERRMSG_COMMON: ENTRY(GETCMD) ALTRET;
     3075    12204    1       IF GETCMD.WORK$ = ADDR (NIL)
     3076    12205    2       THEN DO;
     3077    12206    2           XUG_INIT_A = XUG_INIT_C ;
     3078    12207    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) ALTRET(ALT) ;
     3079    12208    2       END ; /* Then Do */
     3080    12209    1       XUG$ = GETCMD.WORK$ ;
     3081    12210    1       DOWNGRADE_INHIBIT = %NO#;
     3082    12211    1       IF GETCMD.ERR_CODE ~= '0'B
     3083    12212    2       THEN DO;
     3084    12213    2           XUG.ERRSAVE = GETCMD.ERR_CODE;
     3085    12214    2           XUG.NO_INCREMENT = %YES#;
     3086    12215    2           XUG.HELP = '0'B;
     3087    12216    2           IF GETCMD.XT_PARAM$ ~= ADDR(NIL)
     3088    12217    2           THEN
     3089    12218    2               GETCMD.XT_PARAM$ -> XT$PARAM.ERR = XUG.ERRSAVE ;
     3090    12219    2       END;
     3091    12220    1       FID$=GETCMD.ERRMFID$ ;
     3092    12221    2       IF FID$=ADDR(NIL) THEN DO;
     3093    12222    2           XUG.FILENAME.C = 0;
     3094    12223    2       END;
     3095    12224    2       ELSE DO;
     3096    12225    2           FPT_FID = FPT_FID_C;
     3097    12226    2           FPT_FID.ASN_ = VECTOR (VLR_FID);
     3098    12227    2           FPT_FID.RES_ = FPT_FID.ASN_;
     3099    12228    2           FPT_FID.RESULTS_ = FPT_FID.ASN_;
     3100    12229    2           FPT_FID.TEXTFID_ = VECTOR (FID.C);
     3101    12230    2           FPT_FID.ACCT_ = VECTOR (XUG.FILEACCT);
     3102    12231    2           FPT_FID.NAME_ = VECTOR (XUG.FILENAME);
     3103    12232    2           FPT_FID.PASS_ = VECTOR (XUG.FILEPASS);
     3104    12233    2           CALL M$FID (FPT_FID) ALTRET (ALT);
     3105    12234    2       END;
     3106    12235    1       RETURN;
     3107    12236    1   ALT:
     3108    12237    1       IF NOT DOWNGRADE_INHIBIT
     3109    12238    1       THEN
     3110    12239    1           XUG.ERRSAVE = '0'B;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:553  
     3111    12240    1       ALTRETURN;
     3112    12241    1   END XUG$ERRMSG_COMMON ;
     3113    12242        %EOD;

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:554  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XT_MACRO_M.:TOOLE04  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$ERRMSG_COMMON.

   Procedure XUG$ERRMSG_COMMON requires 341 words for executable code.
   Procedure XUG$ERRMSG_COMMON requires 144 words of local(AUTO) storage.

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:555  

 Object Unit name= XUG$ERRMSG_COMMON                          File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:25:39.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$DO
    1  RoData even  UTS     54     66  XUG$ERRMSG_COMMON
    2   DCB   even  none     0      0  M$UC
    3   Proc  even  none   341    525  XUG$ERRMSG_COMMON
    4  RoData even  none    10     12  XUG$ERRMSG_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  XUG$ERRMSG_COMMON
     3    374          yes     yes      Std        1  XUG$SETERRMSG_COMMON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XUG$INIT_COMMON
 yes     yes           Std       2 XUG$FINDDCB_COMMON
         yes           Std       2 XUG$OPENOUT_INTERNAL
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:556  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$DO                                  M$UC                                  XUG_INIT_C
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:557  


     2903        1        /*T***********************************************************/
     2904        2        /*T*                                                         */
     2905        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2906        4        /*T*                                                         */
     2907        5        /*T***********************************************************/
     2908        6        /* XUG$ERRMSG_COMMON - ERROR MESSAGE HANDLING ROUTINES FOR DEF */
     2909        7        /**/
     2910        8        XUG$ERRMSG_COMMON: PROC (GETCMD) ALTRET;

      8  3 000000   000000 700200 xent  XUG$ERRMSG_* TSX0  ! X66_AUTO_1
         3 000001   000220 000001                    ZERO    144,1

     2911        9        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     2912       10        %INCLUDE XU_MACRO_C ;
     2913     3116        %INCLUDE XU_PERR_C;
     2914     3307        %INCLUDE XUH_MACRO_C ;
     2915     3391        %INCLUDE XT_MACRO_M;
     2916     3717        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     2917     4055    1   DCL FID$ PTR;                           /* FOR XUG$SETERRMSG */
     2918     4056    1   DCL 1 FID BASED(FID$),
     2919     4057    1         2 L UBIN BYTE UNAL,
     2920     4058    1         2 C CHAR(FID.L);
     2921     4059        /**/
     2922     4060    1   DCL XUG$CORRES_COMMON ENTRY(2) ALTRET;
     2923     4061    1   DCL XUG$FINDDCB_COMMON ENTRY(2) ALTRET;
     2924     4062    1   DCL XUG$INIT_COMMON ENTRY(2) ALTRET;
     2925     4063    1   DCL XUG$OPENOUT_INTERNAL ENTRY(2);
     2926     4064        /**/
     2927     4065    1   DCL M$DO DCB;
     2928     4066    1   DCL M$LO# SBIN;
     2929     4067        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
     2930     4068        DCL 1 NAME STCLASS,
     2931     4069              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
     2932     4070              2 C CHAR(0) INIT(T#);
     2933     4071        %MEND;
     2934     4072        %TEXTC (NAME=M$LO,T#='M$LO');
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:558  
     2935     4077        %INCLUDE CP_6;
     2936     9636        %INCLUDE CP_6_SUBS;
     2937    10176    1   DCL ERRBUF CHAR(120) ;
     2938    10177        %FPT_ERRMSG (OUTDCB1=M$DO,SUBMESS=YES,INCLCODE=NO,
     2939    10178                     FLAGLEV=0,DCB=NIL,STCLASS=CONSTANT,FPTN=FPT_ERRMSG_C);
     2940    10205        %FPT_ERRMSG (STCLASS=AUTO);
     2941    10232        %VLP_ERRCODE  (FPTN=TEMP_ERRCODE, STCLASS=AUTO);
     2942    10277        %VLP_ERRCODE  (FPTN=BASED_ERRCODE, STCLASS=BASED);
     2943    10322        %VLP_ERRCODE  (FPTN=XUG_SYNERR, STCLASS=CONSTANT,
     2944    10323                       FCG=XU, MID=G, ERR#=%E$SYNERR, SEV=0);
     2945    10368        %VLP_ERRCODE  (FPTN=XUR_SYNERR, STCLASS=CONSTANT,
     2946    10369                       FCG=XU, MID=R, ERR#=%E$SYNERR, SEV=0);
     2947    10414        %VLR_ERRMSG (FPTN=XUG_ERRMSG,STCLASS=AUTO);
     2948    10436        %FPT_FID (FPTN=FPT_FID_C, STCLASS=CONSTANT) ;
     2949    10459        %FPT_FID (STCLASS=AUTO);
     2950    10482        %VLR_FID (STCLASS=AUTO);
     2951    10501        /*
     2952    10502        */
     2953    10503    1   DCL XUG$ PTR ;
     2954    10504    1   DCL DOWNGRADE_INHIBIT BIT (1);
     2955    10505    1   DCL DCB# UBIN;
     2956    10506
     2957    10507        %XUG_PARAMS;
     2958    10951        %XUG_INIT (NAME=XUG_INIT_C, STCLASS=SYMREF);
     2959    11364        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
     2960    11777        %XT_PARAM (NAME= XT$PARAM , STCLASS=BASED);
     2961    12090        %EJECT;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:559  
     2962    12091    1       IF GETCMD.WORK$ = ADDR(NIL)

  12091  3 000002   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000003   000004 236100                    LDQ     4,,PR0
         3 000004   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000005   000021 601000 3                  TNZ     s:12096

     2963    12092    2       THEN DO;

     2964    12093    2           XUG_INIT_A = XUG_INIT_C ;

  12093  3 000006   000100 100400                    MLR     fill='000'O
         3 000007   000000 000220 xsym               ADSC9   XUG_INIT_C               cn=0,n=144
         3 000010   200152 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

     2965    12094    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) ALTRET(ALT) ;

  12094  3 000011   200152 631500                    EPPR1   XUG_INIT_A,,AUTO
         3 000012   200217 451500                    STP1    XUG_INIT_A+37,,AUTO
         3 000013   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000014   200216 756100                    STQ     XUG_INIT_A+36,,AUTO
         3 000015   200216 630500                    EPPR0   XUG_INIT_A+36,,AUTO
         3 000016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000017   000000 701000 xent               TSX1    XUG$INIT_COMMON
         3 000020   000520 702000 3                  TSX2    ALT

     2966    12095    2       END ; /* Then Do */

     2967    12096    1       XUG$ = GETCMD.WORK$ ;

  12096  3 000021   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000022   000004 236100                    LDQ     4,,PR0
         3 000023   200146 756100                    STQ     XUG$,,AUTO

     2968    12097    1       XUG.HELP='0'B;

  12097  3 000024   200146 471500                    LDP1    XUG$,,AUTO
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:560  
         3 000025   000000 236000 4                  LDQ     0
         3 000026   100071 356100                    ANSQ    57,,PR1

     2969    12098    1       DOWNGRADE_INHIBIT = %NO#;

  12098  3 000027   200147 450100                    STZ     DOWNGRADE_INHIBIT,,AUTO

     2970    12099    1       FPT_ERRMSG = FPT_ERRMSG_C;

  12099  3 000030   000100 100400                    MLR     fill='000'O
         3 000031   000002 000150 1                  ADSC9   FPT_ERRMSG_C             cn=0,n=104
         3 000032   200044 000150                    ADSC9   FPT_ERRMSG,,AUTO         cn=0,n=104

     2971    12100    1       FPT_ERRMSG.V_ = VECTOR (FPT_ERRMSG.V);

  12100  3 000033   000001 235000 4                  LDA     1
         3 000034   200216 452500                    STP2    XUG_INIT_A+36,,AUTO
         3 000035   200216 236100                    LDQ     XUG_INIT_A+36,,AUTO
         3 000036   000072 036003                    ADLQ    58,DU
         3 000037   200044 757100                    STAQ    FPT_ERRMSG,,AUTO

     2972    12101    1       FPT_ERRMSG.RESULTS_ = VECTOR (XUG_ERRMSG);

  12101  3 000040   000001 235000 4                  LDA     1
         3 000041   200216 452500                    STP2    XUG_INIT_A+36,,AUTO
         3 000042   200216 236100                    LDQ     XUG_INIT_A+36,,AUTO
         3 000043   000100 036003                    ADLQ    64,DU
         3 000044   200066 757100                    STAQ    FPT_ERRMSG+18,,AUTO

     2973    12102    1       FPT_ERRMSG.BUF_ = VECTOR (ERRBUF);

  12102  3 000045   000002 235000 4                  LDA     2
         3 000046   200216 452500                    STP2    XUG_INIT_A+36,,AUTO
         3 000047   200216 236100                    LDQ     XUG_INIT_A+36,,AUTO
         3 000050   000006 036003                    ADLQ    6,DU
         3 000051   200050 757100                    STAQ    FPT_ERRMSG+4,,AUTO

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:561  
     2974    12103    1       FPT_ERRMSG.CODE_ = VECTOR (XUG.ERRSAVE);

  12103  3 000052   777640 235007                    LDA     -96,DL
         3 000053   200146 236100                    LDQ     XUG$,,AUTO
         3 000054   000067 036003                    ADLQ    55,DU
         3 000055   200046 757100                    STAQ    FPT_ERRMSG+2,,AUTO

     2975    12104    1       IF NOT ( XUG.FILENAME.C = 0 )

  12104  3 000056   100137 236100                    LDQ     95,,PR1
         3 000057   777000 316003                    CANQ    -512,DU
         3 000060   000075 600000 3                  TZE     s:12110

     2976    12105    2       THEN DO;

     2977    12106    2           FPT_ERRMSG.FILEACCT_ = VECTOR (XUG.FILEACCT);

  12106  3 000061   000003 235000 4                  LDA     3
         3 000062   200146 236100                    LDQ     XUG$,,AUTO
         3 000063   000147 036003                    ADLQ    103,DU
         3 000064   200054 757100                    STAQ    FPT_ERRMSG+8,,AUTO

     2978    12107    2           FPT_ERRMSG.FILENAME_ = VECTOR (XUG.FILENAME);

  12107  3 000065   000004 235000 4                  LDA     4
         3 000066   200146 236100                    LDQ     XUG$,,AUTO
         3 000067   000137 036003                    ADLQ    95,DU
         3 000070   200052 757100                    STAQ    FPT_ERRMSG+6,,AUTO

     2979    12108    2           FPT_ERRMSG.FILEPASS_ = VECTOR (XUG.FILEPASS);

  12108  3 000071   000003 235000 4                  LDA     3
         3 000072   200146 236100                    LDQ     XUG$,,AUTO
         3 000073   000151 036003                    ADLQ    105,DU
         3 000074   200056 757100                    STAQ    FPT_ERRMSG+10,,AUTO

     2980    12109    2       END;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:562  

     2981    12110    1       FPT_ERRMSG.FIELD1_ = GETCMD.F1_;

  12110  3 000075   000100 100500                    MLR     fill='000'O
         3 000076   000017 000010                    ADSC9   15,,PR0                  cn=0,n=8
         3 000077   200060 000010                    ADSC9   FPT_ERRMSG+12,,AUTO      cn=0,n=8

     2982    12111    1       FPT_ERRMSG.FIELD2_ = GETCMD.F2_;

  12111  3 000100   000100 100500                    MLR     fill='000'O
         3 000101   000021 000010                    ADSC9   17,,PR0                  cn=0,n=8
         3 000102   200062 000010                    ADSC9   FPT_ERRMSG+14,,AUTO      cn=0,n=8

     2983    12112    1       FPT_ERRMSG.FIELD3_ = GETCMD.F3_;

  12112  3 000103   000100 100500                    MLR     fill='000'O
         3 000104   000023 000010                    ADSC9   19,,PR0                  cn=0,n=8
         3 000105   200064 000010                    ADSC9   FPT_ERRMSG+16,,AUTO      cn=0,n=8

     2984    12113    1       IF GETCMD.ERR_CODE = '0'B

  12113  3 000106   000010 235100                    LDA     8,,PR0
         3 000107   000140 601000 3                  TNZ     s:12130

     2985    12114    2       THEN DO;

     2986    12115    2           IF XUG.NO_INCREMENT

  12115  3 000110   100071 236100                    LDQ     57,,PR1
         3 000111   000001 316007                    CANQ    1,DL
         3 000112   000116 600000 3                  TZE     s:12119

     2987    12116    2           THEN
     2988    12117    2               XUG.NO_INCREMENT = %NO#;

  12117  3 000113   000005 236000 4                  LDQ     5
         3 000114   100071 356100                    ANSQ    57,,PR1
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:563  
         3 000115   000127 710000 3                  TRA     s:12124

     2989    12118    3           ELSE DO;

     2990    12119    3               IF XUG.ERRSAVE.SEV = 7

  12119  3 000116   100067 236100                    LDQ     55,,PR1
         3 000117   000007 376007                    ANQ     7,DL
         3 000120   000007 116007                    CMPQ    7,DL
         3 000121   000123 601000 3                  TNZ     s:12122

     2991    12120    3               THEN
     2992    12121    3                   ALTRETURN;

  12121  3 000122   000000 702200 xent               TSX2  ! X66_AALT

     2993    12122    3               XUG.ERRSAVE.SEV = XUG.ERRSAVE.SEV + 1;

  12122  3 000123   000001 036007                    ADLQ    1,DL
         3 000124   100067 676100                    ERQ     55,,PR1
         3 000125   000007 376007                    ANQ     7,DL
         3 000126   100067 656100                    ERSQ    55,,PR1

     2994    12123    3           END;

     2995    12124    2           FPT_ERRMSG.V.SUBMESS#='0'B;

  12124  3 000127   000006 236000 4                  LDQ     6
         3 000130   200074 356100                    ANSQ    FPT_ERRMSG+24,,AUTO

     2996    12125    2           FPT_ERRMSG.FIELD1_ = XUG.F1SAVE;

  12125  3 000131   100272 237100                    LDAQ    186,,PR1
         3 000132   200060 757100                    STAQ    FPT_ERRMSG+12,,AUTO

     2997    12126    2           FPT_ERRMSG.FIELD2_ = XUG.F2SAVE;

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:564  
  12126  3 000133   100274 237100                    LDAQ    188,,PR1
         3 000134   200062 757100                    STAQ    FPT_ERRMSG+14,,AUTO

     2998    12127    2           FPT_ERRMSG.FIELD3_ = XUG.F3SAVE;

  12127  3 000135   100276 237100                    LDAQ    190,,PR1
         3 000136   200064 757100                    STAQ    FPT_ERRMSG+16,,AUTO

     2999    12128    2       END;

  12128  3 000137   000230 710000 3                  TRA     s:12156

     3000    12129    2       ELSE DO;

     3001    12130    2           IF GETCMD.INFOMSG#

  12130  3 000140   000006 430100                    FSZN    6,,PR0
         3 000141   000160 604000 3                  TMI     s:12135
         3 000142   100071 236100                    LDQ     57,,PR1
         3 000143   000004 316007                    CANQ    4,DL
         3 000144   000174 600000 3                  TZE     s:12141
         3 000145   000002 316007                    CANQ    2,DL
         3 000146   000174 600000 3                  TZE     s:12141
         3 000147   100266 236100                    LDQ     182,,PR1
         3 000150   000022 772000                    QRL     18
         3 000151   000777 376007                    ANQ     511,DL
         3 000152   200216 756100                    STQ     XUG_INIT_A+36,,AUTO
         3 000153   000006 236100                    LDQ     6,,PR0
         3 000154   000022 772000                    QRL     18
         3 000155   000777 376007                    ANQ     511,DL
         3 000156   200216 116100                    CMPQ    XUG_INIT_A+36,,AUTO
         3 000157   000174 605000 3                  TPL     s:12141

     3002    12131    2             OR (XUG.NO_DOWNGRADE
     3003    12132    2             AND XUG.FIRST_ERROR
     3004    12133    2             AND XUG.LAST_FLAGLEV > GETCMD.FLGLEV#)
     3005    12134    3           THEN DO;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:565  

     3006    12135    3               DOWNGRADE_INHIBIT = %YES#;

  12135  3 000160   400000 236003                    LDQ     -131072,DU
         3 000161   200147 756100                    STQ     DOWNGRADE_INHIBIT,,AUTO

     3007    12136    3               TEMP_ERRCODE = GETCMD.ERR_CODE;

  12136  3 000162   000010 236100                    LDQ     8,,PR0
         3 000163   200076 756100                    STQ     TEMP_ERRCODE,,AUTO

     3008    12137    3               TEMP_ERRCODE.SEV = 0;

  12137  3 000164   000007 236000 4                  LDQ     7
         3 000165   200076 356100                    ANSQ    TEMP_ERRCODE,,AUTO

     3009    12138    3               FPT_ERRMSG.CODE_ = VECTOR (TEMP_ERRCODE);

  12138  3 000166   777640 235007                    LDA     -96,DL
         3 000167   200216 452500                    STP2    XUG_INIT_A+36,,AUTO
         3 000170   200216 236100                    LDQ     XUG_INIT_A+36,,AUTO
         3 000171   000076 036003                    ADLQ    62,DU
         3 000172   200046 757100                    STAQ    FPT_ERRMSG+2,,AUTO

     3010    12139    3           END;

  12139  3 000173   000223 710000 3                  TRA     s:12152

     3011    12140    3           ELSE DO;

     3012    12141    3               XUG.ERRSAVE=GETCMD.ERR_CODE;

  12141  3 000174   000010 236100                    LDQ     8,,PR0
         3 000175   100067 756100                    STQ     55,,PR1

     3013    12142    3               XUG.ERRSAVE.SEV=0;

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:566  
  12142  3 000176   000007 236000 4                  LDQ     7
         3 000177   100067 356100                    ANSQ    55,,PR1

     3014    12143    3               XUG.LAST_FLAGLEV = GETCMD.FLGLEV#;

  12143  3 000200   000006 236100                    LDQ     6,,PR0
         3 000201   100266 552120                    STBQ    182,'20'O,PR1

     3015    12144    3               XUG.FIRST_ERROR = %YES#;

  12144  3 000202   000002 236007                    LDQ     2,DL
         3 000203   100071 256100                    ORSQ    57,,PR1

     3016    12145    3               XUG.F1SAVE = GETCMD.F1_ ;

  12145  3 000204   000100 100500                    MLR     fill='000'O
         3 000205   000017 000010                    ADSC9   15,,PR0                  cn=0,n=8
         3 000206   100272 000010                    ADSC9   186,,PR1                 cn=0,n=8

     3017    12146    3               XUG.F2SAVE = GETCMD.F2_ ;

  12146  3 000207   000100 100500                    MLR     fill='000'O
         3 000210   000021 000010                    ADSC9   17,,PR0                  cn=0,n=8
         3 000211   100274 000010                    ADSC9   188,,PR1                 cn=0,n=8

     3018    12147    3               XUG.F3SAVE = GETCMD.F3_ ;

  12147  3 000212   000100 100500                    MLR     fill='000'O
         3 000213   000023 000010                    ADSC9   19,,PR0                  cn=0,n=8
         3 000214   100276 000010                    ADSC9   190,,PR1                 cn=0,n=8

     3019    12148    3               IF GETCMD.XT_PARAM$ ~= ADDR(NIL)

  12148  3 000215   000036 236100                    LDQ     30,,PR0
         3 000216   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000217   000223 600000 3                  TZE     s:12152

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:567  
     3020    12149    3               THEN
     3021    12150    3                   GETCMD.XT_PARAM$ -> XT$PARAM.ERR = XUG.ERRSAVE ;

  12150  3 000220   000036 473500                    LDP3    30,,PR0
         3 000221   100067 236100                    LDQ     55,,PR1
         3 000222   300001 756100                    STQ     1,,PR3

     3022    12151    3           END;

     3023    12152    2           XUG.NO_INCREMENT = %NO#;

  12152  3 000223   000005 236000 4                  LDQ     5
         3 000224   100071 356100                    ANSQ    57,,PR1

     3024    12153    2           FPT_ERRMSG.V.SUBMESS#='1'B;

  12153  3 000225   001000 236003                    LDQ     512,DU
         3 000226   200074 256100                    ORSQ    FPT_ERRMSG+24,,AUTO

     3025    12154    2           XUG.ERRDCB = DCBNUM(NIL);

  12154  3 000227   100070 450100                    STZ     56,,PR1

     3026    12155    2       END;

     3027    12156    1       GETCMD.INFOMSG# = %NO# ;

  12156  3 000230   000006 236000 4                  LDQ     6
         3 000231   000006 356100                    ANSQ    6,,PR0

     3028    12157    1       IF GETCMD.ERRDCB# ~= DCBNUM(NIL)

  12157  3 000232   000011 235100                    LDA     9,,PR0
         3 000233   000235 600000 3                  TZE     s:12160

     3029    12158    1       THEN
     3030    12159    1           XUG.ERRDCB = GETCMD.ERRDCB# ;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:568  

  12159  3 000234   100070 755100                    STA     56,,PR1

     3031    12160    1       FPT_ERRMSG.V.DCB# = XUG.ERRDCB ;

  12160  3 000235   100070 720100                    LXL0    56,,PR1
         3 000236   200072 740100                    STX0    FPT_ERRMSG+22,,AUTO

     3032    12161    1       IF GETCMD.DCB_PARAM#=DCBNUM(NIL) AND GETCMD.DCB2_PARAM#=DCBNUM(NIL)

  12161  3 000237   000014 235100                    LDA     12,,PR0
         3 000240   000262 601000 3                  TNZ     NO_LO
         3 000241   000015 235100                    LDA     13,,PR0
         3 000242   000262 601000 3                  TNZ     NO_LO

     3033    12162    2       THEN DO ;

     3034    12163    2           IF GETCMD.OUTDCB#~=DCBNUM(NIL)

  12163  3 000243   000013 235100                    LDA     11,,PR0
         3 000244   000250 600000 3                  TZE     s:12167

     3035    12164    2           THEN
     3036    12165    2               FPT_ERRMSG.V.OUTDCB2#=GETCMD.OUTDCB#;

  12165  3 000245   000013 721100                    LXL1    11,,PR0
         3 000246   200073 741100                    STX1    FPT_ERRMSG+23,,AUTO
         3 000247   000262 710000 3                  TRA     NO_LO

     3037    12166    3           ELSE DO;

     3038    12167    3               CALL XUG$FINDDCB_COMMON(M$LO,M$LO#) ALTRET(NO_LO);

  12167  3 000250   200005 633500                    EPPR3   M$LO#,,AUTO
         3 000251   200217 453500                    STP3    XUG_INIT_A+37,,AUTO
         3 000252   000010 236000 4                  LDQ     8
         3 000253   200216 756100                    STQ     XUG_INIT_A+36,,AUTO
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:569  
         3 000254   200216 630500                    EPPR0   XUG_INIT_A+36,,AUTO
         3 000255   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000256   000000 701000 xent               TSX1    XUG$FINDDCB_COMMON
         3 000257   000262 702000 3                  TSX2    NO_LO

     3039    12168    3               FPT_ERRMSG.V.OUTDCB2#=M$LO#;

  12168  3 000260   200005 720100                    LXL0    M$LO#,,AUTO
         3 000261   200073 740100                    STX0    FPT_ERRMSG+23,,AUTO

     3040    12169    3           END;

     3041    12170    2   NO_LO: END;

  12170  3 000262                       NO_LO        null
     3042    12171    1       IF GETCMD.DCB_PARAM#~=DCBNUM(NIL) AND GETCMD.DCB2_PARAM#~=DCBNUM(NIL)

  12171  3 000262   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000263   000014 235100                    LDA     12,,PR0
         3 000264   000274 600000 3                  TZE     s:12177
         3 000265   000015 235100                    LDA     13,,PR0
         3 000266   000274 600000 3                  TZE     s:12177

     3043    12172    2       THEN DO ;

     3044    12173    2           FPT_ERRMSG.V.OUTDCB1#=GETCMD.DCB_PARAM# ;

  12173  3 000267   000014 720100                    LXL0    12,,PR0
         3 000270   200072 440100                    SXL0    FPT_ERRMSG+22,,AUTO

     3045    12174    2           FPT_ERRMSG.V.OUTDCB2# = GETCMD.DCB2_PARAM# ;

  12174  3 000271   000015 721100                    LXL1    13,,PR0
         3 000272   200073 741100                    STX1    FPT_ERRMSG+23,,AUTO

     3046    12175    2       END ;

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:570  
  12175  3 000273   000305 710000 3                  TRA     s:12184

     3047    12176    1       ELSE
     3048    12177    1           IF GETCMD.DCB_PARAM#~=DCBNUM(NIL)

  12177  3 000274   000014 235100                    LDA     12,,PR0
         3 000275   000301 600000 3                  TZE     s:12181

     3049    12178    1           THEN
     3050    12179    1               FPT_ERRMSG.V.OUTDCB1#=GETCMD.DCB_PARAM# ;

  12179  3 000276   000014 720100                    LXL0    12,,PR0
         3 000277   200072 440100                    SXL0    FPT_ERRMSG+22,,AUTO
         3 000300   000305 710000 3                  TRA     s:12184

     3051    12180    1           ELSE
     3052    12181    1               IF GETCMD.DCB2_PARAM#~=DCBNUM(NIL)

  12181  3 000301   000015 235100                    LDA     13,,PR0
         3 000302   000305 600000 3                  TZE     s:12184

     3053    12182    1               THEN
     3054    12183    1                   FPT_ERRMSG.V.OUTDCB2#=GETCMD.DCB2_PARAM# ;

  12183  3 000303   000015 720100                    LXL0    13,,PR0
         3 000304   200073 740100                    STX0    FPT_ERRMSG+23,,AUTO

     3055    12184    1       DCB# = FPT_ERRMSG.V.OUTDCB1#;

  12184  3 000305   200072 236100                    LDQ     FPT_ERRMSG+22,,AUTO
         3 000306   777777 376007                    ANQ     -1,DL
         3 000307   200150 756100                    STQ     DCB#,,AUTO

     3056    12185    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, DCB#);

  12185  3 000310   200150 631500                    EPPR1   DCB#,,AUTO
         3 000311   200217 451500                    STP1    XUG_INIT_A+37,,AUTO
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:571  
         3 000312   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000313   200216 756100                    STQ     XUG_INIT_A+36,,AUTO
         3 000314   200216 630500                    EPPR0   XUG_INIT_A+36,,AUTO
         3 000315   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000316   000000 701000 xent               TSX1    XUG$OPENOUT_INTERNAL
         3 000317   000000 011000                    NOP     0

     3057    12186    1       DCB# = FPT_ERRMSG.V.OUTDCB2#;

  12186  3 000320   200073 235100                    LDA     FPT_ERRMSG+23,,AUTO
         3 000321   000022 771000                    ARL     18
         3 000322   200150 755100                    STA     DCB#,,AUTO

     3058    12187    1       CALL XUG$OPENOUT_INTERNAL (GETCMD, DCB#);

  12187  3 000323   200150 630500                    EPPR0   DCB#,,AUTO
         3 000324   200217 450500                    STP0    XUG_INIT_A+37,,AUTO
         3 000325   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000326   200216 756100                    STQ     XUG_INIT_A+36,,AUTO
         3 000327   200216 630500                    EPPR0   XUG_INIT_A+36,,AUTO
         3 000330   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000331   000000 701000 xent               TSX1    XUG$OPENOUT_INTERNAL
         3 000332   000000 011000                    NOP     0

     3059    12188    1       IF GETCMD.ERRMSG_VFC# ~= ' '

  12188  3 000333   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000334   000007 236100                    LDQ     7,,PR0
         3 000335   777000 376003                    ANQ     -512,DU
         3 000336   040000 116003                    CMPQ    16384,DU
         3 000337   000343 600000 3                  TZE     s:12191

     3060    12189    1       THEN
     3061    12190    1           FPT_ERRMSG.V.VFC# = GETCMD.ERRMSG_VFC# ;

  12190  3 000340   000007 236100                    LDQ     7,,PR0
         3 000341   000033 772000                    QRL     27
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:572  
         3 000342   200073 552104                    STBQ    FPT_ERRMSG+23,'04'O,AUTO

     3062    12191    1       FPT_ERRMSG.V.FLAGLEV# = GETCMD.FLGLEV# ;

  12191  3 000343   000006 236100                    LDQ     6,,PR0
         3 000344   000011 772000                    QRL     9
         3 000345   200073 552110                    STBQ    FPT_ERRMSG+23,'10'O,AUTO

     3063    12192    1       IF NOT XUG.POINTED_TO_SYNERR

  12192  3 000346   200146 471500                    LDP1    XUG$,,AUTO
         3 000347   100071 236100                    LDQ     57,,PR1
         3 000350   200000 316007                    CANQ    65536,DL
         3 000351   000360 600000 3                  TZE     s:12196
         3 000352   200047 473500                    LDP3    FPT_ERRMSG+3,,AUTO
         3 000353   300000 236100                    LDQ     0,,PR3
         3 000354   000034 116000 1                  CMPQ    XUG_SYNERR
         3 000355   000373 600000 3                  TZE     s:12201
         3 000356   000035 116000 1                  CMPQ    XUR_SYNERR
         3 000357   000373 600000 3                  TZE     s:12201

     3064    12193    1         OR (VBASE(BITVECT(FPT_ERRMSG.CODE_))->BASED_ERRCODE ~= XUG_SYNERR
     3065    12194    1         AND VBASE(BITVECT(FPT_ERRMSG.CODE_))->BASED_ERRCODE ~= XUR_SYNERR)
     3066    12195    2       THEN DO;

     3067    12196    2           CALL M$ERRMSG(FPT_ERRMSG) ALTRET(ALT);

  12196  3 000360   200044 630500                    EPPR0   FPT_ERRMSG,,AUTO
         3 000361   420000 713400                    CLIMB   alt,+8192
         3 000362   405000 401760                    pmme    nvectors=11
         3 000363   000520 702000 3                  TSX2    ALT

     3068    12197    2           IF FPT_ERRMSG.V.SUBMESS# AND NOT DOWNGRADE_INHIBIT

  12197  3 000364   200074 430100                    FSZN    FPT_ERRMSG+24,,AUTO
         3 000365   000373 605000 3                  TPL     s:12201
         3 000366   200147 234100                    SZN     DOWNGRADE_INHIBIT,,AUTO
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:573  
         3 000367   000373 604000 3                  TMI     s:12201

     3069    12198    2           THEN
     3070    12199    2               XUG.ERRSAVE = XUG_ERRMSG.CODEUSED;

  12199  3 000370   200103 236100                    LDQ     XUG_ERRMSG+3,,AUTO
         3 000371   200146 470500                    LDP0    XUG$,,AUTO
         3 000372   000067 756100                    STQ     55,,PR0

     3071    12200    2       END;

     3072    12201    1       RETURN;

  12201  3 000373   000000 702200 xent               TSX2  ! X66_ARET

     3073    12202        %EJECT;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:574  
     3074    12203    1   XUG$SETERRMSG_COMMON: ENTRY(GETCMD) ALTRET;

  12203  3 000374   000000 700200 xent  XUG$SETERRM* TSX0  ! X66_AUTO_1
         3 000375   000220 000001                    ZERO    144,1

     3075    12204    1       IF GETCMD.WORK$ = ADDR (NIL)

  12204  3 000376   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000377   000004 236100                    LDQ     4,,PR0
         3 000400   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000401   000415 601000 3                  TNZ     s:12209

     3076    12205    2       THEN DO;

     3077    12206    2           XUG_INIT_A = XUG_INIT_C ;

  12206  3 000402   000100 100400                    MLR     fill='000'O
         3 000403   000000 000220 xsym               ADSC9   XUG_INIT_C               cn=0,n=144
         3 000404   200152 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

     3078    12207    2           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) ALTRET(ALT) ;

  12207  3 000405   200152 631500                    EPPR1   XUG_INIT_A,,AUTO
         3 000406   200217 451500                    STP1    XUG_INIT_A+37,,AUTO
         3 000407   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000410   200216 756100                    STQ     XUG_INIT_A+36,,AUTO
         3 000411   200216 630500                    EPPR0   XUG_INIT_A+36,,AUTO
         3 000412   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000413   000000 701000 xent               TSX1    XUG$INIT_COMMON
         3 000414   000520 702000 3                  TSX2    ALT

     3079    12208    2       END ; /* Then Do */

     3080    12209    1       XUG$ = GETCMD.WORK$ ;

  12209  3 000415   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000416   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:575  
         3 000417   200146 756100                    STQ     XUG$,,AUTO

     3081    12210    1       DOWNGRADE_INHIBIT = %NO#;

  12210  3 000420   200147 450100                    STZ     DOWNGRADE_INHIBIT,,AUTO

     3082    12211    1       IF GETCMD.ERR_CODE ~= '0'B

  12211  3 000421   000010 235100                    LDA     8,,PR0
         3 000422   000440 600000 3                  TZE     s:12220

     3083    12212    2       THEN DO;

     3084    12213    2           XUG.ERRSAVE = GETCMD.ERR_CODE;

  12213  3 000423   000010 236100                    LDQ     8,,PR0
         3 000424   200146 471500                    LDP1    XUG$,,AUTO
         3 000425   100067 756100                    STQ     55,,PR1

     3085    12214    2           XUG.NO_INCREMENT = %YES#;

  12214  3 000426   000001 236007                    LDQ     1,DL
         3 000427   100071 256100                    ORSQ    57,,PR1

     3086    12215    2           XUG.HELP = '0'B;

  12215  3 000430   000000 236000 4                  LDQ     0
         3 000431   100071 356100                    ANSQ    57,,PR1

     3087    12216    2           IF GETCMD.XT_PARAM$ ~= ADDR(NIL)

  12216  3 000432   000036 236100                    LDQ     30,,PR0
         3 000433   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000434   000440 600000 3                  TZE     s:12220

     3088    12217    2           THEN
     3089    12218    2               GETCMD.XT_PARAM$ -> XT$PARAM.ERR = XUG.ERRSAVE ;
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:576  

  12218  3 000435   000036 473500                    LDP3    30,,PR0
         3 000436   100067 236100                    LDQ     55,,PR1
         3 000437   300001 756100                    STQ     1,,PR3

     3090    12219    2       END;

     3091    12220    1       FID$=GETCMD.ERRMFID$ ;

  12220  3 000440   000002 236100                    LDQ     2,,PR0
         3 000441   200004 756100                    STQ     FID$,,AUTO

     3092    12221    2       IF FID$=ADDR(NIL) THEN DO;

  12221  3 000442   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000443   000450 601000 3                  TNZ     s:12225

     3093    12222    2           XUG.FILENAME.C = 0;

  12222  3 000444   200146 471500                    LDP1    XUG$,,AUTO
         3 000445   000000 236003                    LDQ     0,DU
         3 000446   100137 552140                    STBQ    95,'40'O,PR1

     3094    12223    2       END;

  12223  3 000447   000517 710000 3                  TRA     s:12235

     3095    12224    2       ELSE DO;

     3096    12225    2           FPT_FID = FPT_FID_C;

  12225  3 000450   000100 100400                    MLR     fill='000'O
         3 000451   000036 000140 1                  ADSC9   FPT_FID_C                cn=0,n=96
         3 000452   200104 000140                    ADSC9   FPT_FID,,AUTO            cn=0,n=96

     3097    12226    2           FPT_FID.ASN_ = VECTOR (VLR_FID);

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:577  
  12226  3 000453   000011 235000 4                  LDA     9
         3 000454   200216 452500                    STP2    XUG_INIT_A+36,,AUTO
         3 000455   200216 236100                    LDQ     XUG_INIT_A+36,,AUTO
         3 000456   000134 036003                    ADLQ    92,DU
         3 000457   200122 757100                    STAQ    FPT_FID+14,,AUTO

     3098    12227    2           FPT_FID.RES_ = FPT_FID.ASN_;

  12227  3 000460   200122 237100                    LDAQ    FPT_FID+14,,AUTO
         3 000461   200124 757100                    STAQ    FPT_FID+16,,AUTO

     3099    12228    2           FPT_FID.RESULTS_ = FPT_FID.ASN_;

  12228  3 000462   200122 237100                    LDAQ    FPT_FID+14,,AUTO
         3 000463   200126 757100                    STAQ    FPT_FID+18,,AUTO

     3100    12229    2           FPT_FID.TEXTFID_ = VECTOR (FID.C);

  12229  3 000464   200004 471500                    LDP1    FID$,,AUTO
         3 000465   000100 101500                    MRL     fill='000'O
         3 000466   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         3 000467   200216 000002                    ADSC9   XUG_INIT_A+36,,AUTO      cn=0,n=2
         3 000470   200216 220100                    LDX0    XUG_INIT_A+36,,AUTO
         3 000471   000000 635010                    EAA     0,X0
         3 000472   000002 771000                    ARL     2
         3 000473   000140 135007                    SBLA    96,DL
         3 000474   200004 236100                    LDQ     FID$,,AUTO
         3 000475   200000 036007                    ADLQ    65536,DL
         3 000476   200106 757100                    STAQ    FPT_FID+2,,AUTO

     3101    12230    2           FPT_FID.ACCT_ = VECTOR (XUG.FILEACCT);

  12230  3 000477   000003 235000 4                  LDA     3
         3 000500   200146 236100                    LDQ     XUG$,,AUTO
         3 000501   000147 036003                    ADLQ    103,DU
         3 000502   200112 757100                    STAQ    FPT_FID+6,,AUTO

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:578  
     3102    12231    2           FPT_FID.NAME_ = VECTOR (XUG.FILENAME);

  12231  3 000503   000004 235000 4                  LDA     4
         3 000504   200146 236100                    LDQ     XUG$,,AUTO
         3 000505   000137 036003                    ADLQ    95,DU
         3 000506   200110 757100                    STAQ    FPT_FID+4,,AUTO

     3103    12232    2           FPT_FID.PASS_ = VECTOR (XUG.FILEPASS);

  12232  3 000507   000003 235000 4                  LDA     3
         3 000510   200146 236100                    LDQ     XUG$,,AUTO
         3 000511   000151 036003                    ADLQ    105,DU
         3 000512   200114 757100                    STAQ    FPT_FID+8,,AUTO

     3104    12233    2           CALL M$FID (FPT_FID) ALTRET (ALT);

  12233  3 000513   200104 630500                    EPPR0   FPT_FID,,AUTO
         3 000514   420001 713400                    CLIMB   alt,+8193
         3 000515   404400 401760                    pmme    nvectors=10
         3 000516   000520 702000 3                  TSX2    ALT

     3105    12234    2       END;

     3106    12235    1       RETURN;

  12235  3 000517   000000 702200 xent               TSX2  ! X66_ARET

     3107    12236    1   ALT:
     3108    12237    1       IF NOT DOWNGRADE_INHIBIT

  12237  3 000520   200147 234100       ALT          SZN     DOWNGRADE_INHIBIT,,AUTO
         3 000521   000524 604000 3                  TMI     s:12240

     3109    12238    1       THEN
     3110    12239    1           XUG.ERRSAVE = '0'B;

  12239  3 000522   200146 470500                    LDP0    XUG$,,AUTO
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:579  
         3 000523   000067 450100                    STZ     55,,PR0

     3111    12240    1       ALTRETURN;

  12240  3 000524   000000 702200 xent               TSX2  ! X66_AALT
     3112    12241    1   END XUG$ERRMSG_COMMON ;
     3113    12242        %EOD;

PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:580  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XT_MACRO_M.:TOOLE04  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$ERRMSG_COMMON.
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:581  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$ERRMSG_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d STRC(936)   r     1 FPT_ERRMSG_C              36-0-0/d STRC(864)   r     1 FPT_FID_C
     0-0-0/c STRC(45)    r     1 M$LO                      34-0-0/w STRC        r     1 XUG_SYNERR
    35-0-0/w STRC        r     1 XUR_SYNERR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GETCMD                  150-0-0/w UBIN        r     1 DCB#
   147-0-0/b BIT         r     1 DOWNGRADE_INHIBIT          6-0-0/c CHAR(120)   r     1 ERRBUF
     4-0-0/w PTR         r     1 FID$                      44-0-0/d STRC(936)   r     1 FPT_ERRMSG
   104-0-0/d STRC(864)   r     1 FPT_FID                   *0-0-0/d STRC(1512)  r     1 GETCMD
     5-0-0/w SBIN        r     1 M$LO#                     76-0-0/w STRC        r     1 TEMP_ERRCODE
   134-0-0/d STRC(324)   r     1 VLR_FID                  146-0-0/w PTR         r     1 XUG$
   100-0-0/d STRC(144)   r     1 XUG_ERRMSG               152-0-0/d STRC(1296)  r     1 XUG_INIT_A

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1296)  r     1 XUG_INIT_C

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 BASED_ERRCODE              0-0-0/c ASTR(9)     r     1 FID
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:582  
     0-0-0N  NULL        r     1 M$DO                       0-0-0/w STRC(1152)  r     1 XT$PARAM
     0-0-0/d STRC(9612)  r     1 XUG


   Procedure XUG$ERRMSG_COMMON requires 341 words for executable code.
   Procedure XUG$ERRMSG_COMMON requires 144 words of local(AUTO) storage.
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:583  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:584  
          MINI XREF LISTING

ALT
     12237**LABEL   12094--CALLALT 12196--CALLALT 12207--CALLALT 12233--CALLALT
BASED_ERRCODE
     10289**DCL     12192>>IF      12192>>IF
DCB#
     10505**DCL     12184<<ASSIGN  12185<>CALL    12186<<ASSIGN  12187<>CALL
DOWNGRADE_INHIBIT
     10504**DCL     12098<<ASSIGN  12135<<ASSIGN  12197>>IF      12210<<ASSIGN  12237>>IF
ERRBUF
     10176**DCL     12102--ASSIGN
FID.C
      4058**DCL     12229--ASSIGN
FID.L
      4057**DCL      4058--IMP-SIZ 12229>>ASSIGN
FID$
      4055**DCL      4056--IMP-PTR 12220<<ASSIGN  12221>>IF      12229>>ASSIGN  12229>>ASSIGN
FPT_ERRMSG
     10216**DCL     12099<<ASSIGN  12196<>CALL
FPT_ERRMSG.BUF_
     10216**DCL     12102<<ASSIGN
FPT_ERRMSG.CODE_
     10216**DCL     12103<<ASSIGN  12138<<ASSIGN  12192>>IF      12192>>IF
FPT_ERRMSG.FIELD1_
     10218**DCL     12110<<ASSIGN  12125<<ASSIGN
FPT_ERRMSG.FIELD2_
     10219**DCL     12111<<ASSIGN  12126<<ASSIGN
FPT_ERRMSG.FIELD3_
     10219**DCL     12112<<ASSIGN  12127<<ASSIGN
FPT_ERRMSG.FILEACCT_
     10217**DCL     12106<<ASSIGN
FPT_ERRMSG.FILENAME_
     10217**DCL     12107<<ASSIGN
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:585  
FPT_ERRMSG.FILEPASS_
     10218**DCL     12108<<ASSIGN
FPT_ERRMSG.RESULTS_
     10219**DCL     12101<<ASSIGN
FPT_ERRMSG.V
     10220**DCL     12100--ASSIGN
FPT_ERRMSG.V.DCB#
     10220**DCL     12160<<ASSIGN
FPT_ERRMSG.V.FLAGLEV#
     10222**DCL     12191<<ASSIGN
FPT_ERRMSG.V.OUTDCB1#
     10221**DCL     12173<<ASSIGN  12179<<ASSIGN  12184>>ASSIGN
FPT_ERRMSG.V.OUTDCB2#
     10221**DCL     12165<<ASSIGN  12168<<ASSIGN  12174<<ASSIGN  12183<<ASSIGN  12186>>ASSIGN
FPT_ERRMSG.V.SUBMESS#
     10226**DCL     12124<<ASSIGN  12153<<ASSIGN  12197>>IF
FPT_ERRMSG.V.VFC#
     10222**DCL     12190<<ASSIGN
FPT_ERRMSG.V_
     10216**DCL     12100<<ASSIGN
FPT_ERRMSG_C
     10189**DCL     12099>>ASSIGN
FPT_ERRMSG_C.V
     10193**DCL     10189--DCLINIT
FPT_FID
     10470**DCL     12225<<ASSIGN  12233<>CALL
FPT_FID.ACCT_
     10471**DCL     12230<<ASSIGN
FPT_FID.ASN_
     10473**DCL     12226<<ASSIGN  12227>>ASSIGN  12228>>ASSIGN
FPT_FID.NAME_
     10471**DCL     12231<<ASSIGN
FPT_FID.PASS_
     10471**DCL     12232<<ASSIGN
FPT_FID.RESULTS_
     10473**DCL     12228<<ASSIGN
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:586  
FPT_FID.RES_
     10473**DCL     12227<<ASSIGN
FPT_FID.TEXTFID_
     10470**DCL     12229<<ASSIGN
FPT_FID_C
     10447**DCL     12225>>ASSIGN
FPT_FID_C.V
     10451**DCL     10447--DCLINIT
GETCMD
      3730**DCL         8--PROC    12094<>CALL    12185<>CALL    12187<>CALL    12203--ENTRY   12207<>CALL
GETCMD.DCB2_PARAM#
      3915**DCL     12161>>IF      12171>>IF      12174>>ASSIGN  12181>>IF      12183>>ASSIGN
GETCMD.DCB_PARAM#
      3910**DCL     12161>>IF      12171>>IF      12173>>ASSIGN  12177>>IF      12179>>ASSIGN
GETCMD.ERRDCB#
      3889**DCL     12157>>IF      12159>>ASSIGN
GETCMD.ERRMFID$
      3749**DCL     12220>>ASSIGN
GETCMD.ERRMSG_VFC#
      3845**DCL     12188>>IF      12190>>ASSIGN
GETCMD.ERR_CODE
      3878**DCL     12113>>IF      12136>>ASSIGN  12141>>ASSIGN  12211>>IF      12213>>ASSIGN
GETCMD.F1_
      3927**DCL     12110>>ASSIGN  12145>>ASSIGN
GETCMD.F2_
      3931**DCL     12111>>ASSIGN  12146>>ASSIGN
GETCMD.F3_
      3935**DCL     12112>>ASSIGN  12147>>ASSIGN
GETCMD.FLGLEV#
      3835**DCL     12130>>IF      12143>>ASSIGN  12191>>ASSIGN
GETCMD.INFOMSG#
      3826**DCL     12130>>IF      12156<<ASSIGN
GETCMD.OUT$
      3735**DCL      3741--REDEF
GETCMD.OUTDCB#
      3906**DCL     12163>>IF      12165>>ASSIGN
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:587  
GETCMD.WORK$
      3763**DCL     12091>>IF      12096>>ASSIGN  12204>>IF      12209>>ASSIGN
GETCMD.XT_PARAM$
      3999**DCL     12148>>IF      12150>>ASSIGN  12216>>IF      12218>>ASSIGN
M$ERRMSG
      9627**DCL-ENT 12196--CALL
M$FID
      9627**DCL-ENT 12233--CALL
M$LO
      4073**DCL     12167<>CALL
M$LO#
      4066**DCL     12167<>CALL    12168>>ASSIGN
NO_LO
     12170**LABEL   12167--CALLALT
TEMP_ERRCODE
     10244**DCL     12136<<ASSIGN  12138--ASSIGN
TEMP_ERRCODE.SEV
     10274**DCL     12137<<ASSIGN
VLR_FID
     10493**DCL     12226--ASSIGN
XT$PARAM.ERR
     11814**DCL     12150<<ASSIGN  12218<<ASSIGN
XUG.BUF
     10946**DCL     10949--REDEF
XUG.ERRDCB
     10606**DCL     12154<<ASSIGN  12159<<ASSIGN  12160>>ASSIGN
XUG.ERRSAVE
     10599**DCL     12103--ASSIGN  12141<<ASSIGN  12150>>ASSIGN  12199<<ASSIGN  12213<<ASSIGN  12218>>ASSIGN
     12239<<ASSIGN
XUG.ERRSAVE.SEV
     10603**DCL     12119>>IF      12122<<ASSIGN  12122>>ASSIGN  12142<<ASSIGN
XUG.F1SAVE
     10937**DCL     12125>>ASSIGN  12145<<ASSIGN
XUG.F2SAVE
     10940**DCL     12126>>ASSIGN  12146<<ASSIGN
XUG.F3SAVE
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:588  
     10943**DCL     12127>>ASSIGN  12147<<ASSIGN
XUG.FILEACCT
     10815**DCL     12106--ASSIGN  12230--ASSIGN
XUG.FILENAME
     10810**DCL     12107--ASSIGN  12231--ASSIGN
XUG.FILENAME.C
     10811**DCL     12104>>IF      12222<<ASSIGN
XUG.FILEPASS
     10818**DCL     12108--ASSIGN  12232--ASSIGN
XUG.FIRST_ERROR
     10732**DCL     12130>>IF      12144<<ASSIGN
XUG.HELP
     10609**DCL     12097<<ASSIGN  12215<<ASSIGN
XUG.LAST_FLAGLEV
     10897**DCL     12130>>IF      12143<<ASSIGN
XUG.NO_DOWNGRADE
     10727**DCL     12130>>IF
XUG.NO_INCREMENT
     10736**DCL     12115>>IF      12117<<ASSIGN  12152<<ASSIGN  12214<<ASSIGN
XUG.POINTED_TO_SYNERR
     10691**DCL     12192>>IF
XUG$
     10503**DCL     10510--IMP-PTR 12096<<ASSIGN  12097>>ASSIGN  12103>>ASSIGN  12104>>IF      12106>>ASSIGN
     12107>>ASSIGN  12108>>ASSIGN  12115>>IF      12117>>ASSIGN  12119>>IF      12122>>ASSIGN  12122>>ASSIGN
     12125>>ASSIGN  12126>>ASSIGN  12127>>ASSIGN  12130>>IF      12130>>IF      12130>>IF      12141>>ASSIGN
     12142>>ASSIGN  12143>>ASSIGN  12144>>ASSIGN  12145>>ASSIGN  12146>>ASSIGN  12147>>ASSIGN  12150>>ASSIGN
     12152>>ASSIGN  12154>>ASSIGN  12159>>ASSIGN  12160>>ASSIGN  12192>>IF      12199>>ASSIGN  12209<<ASSIGN
     12213>>ASSIGN  12214>>ASSIGN  12215>>ASSIGN  12218>>ASSIGN  12222>>ASSIGN  12230>>ASSIGN  12231>>ASSIGN
     12232>>ASSIGN  12239>>ASSIGN
XUG$FINDDCB_COMMON
      4061**DCL-ENT 12167--CALL
XUG$INIT_COMMON
      4062**DCL-ENT 12094--CALL    12207--CALL
XUG$OPENOUT_INTERNAL
      4063**DCL-ENT 12185--CALL    12187--CALL
XUG_ERRMSG
PL6.E3A0      #010=XUG$ERRMSG_COMMON File=XUG$COMMON.:E05TSI                     WED 07/30/97 09:25 Page:589  
     10425**DCL     12101--ASSIGN
XUG_ERRMSG.CODEUSED
     10433**DCL     12199>>ASSIGN
XUG_INIT_A
     11386**DCL     12093<<ASSIGN  12094<>CALL    12206<<ASSIGN  12207<>CALL
XUG_INIT_C
     10973**DCL     12093>>ASSIGN  12206>>ASSIGN
XUG_SYNERR
     10335**DCL     12192>>IF
XUR_SYNERR
     10381**DCL     12192>>IF

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:590  
     3114        1        /*T***********************************************************/
     3115        2        /*T*                                                         */
     3116        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3117        4        /*T*                                                         */
     3118        5        /*T***********************************************************/
     3119        6        XUG$HELP_COMMON: PROC(GETCMD) ALTRET;
     3120        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3121        8        %INCLUDE B$JIT;
     3122      611        %INCLUDE CP_6;
     3123     6170        %INCLUDE CP_6_SUBS;
     3124     6710        %INCLUDE XU_MACRO_C;
     3125     9816        %INCLUDE XU_PERR_C;
     3126    10007        %INCLUDE XUH_MACRO_C;
     3127    10091
     3128    10092        %XUG_GETCMD (NAME=GETCMD, STCLASS="") ;
     3129    10430        %XUH_PARAM (NAME=XUH$PARAM,STCLASS=BASED);
     3130    10491        %XUG_PARAMS;
     3131    10935        %XUG_INIT (NAME=XUG_INIT_C, STCLASS=SYMREF);
     3132    11348        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
     3133    11761
     3134    11762        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
     3135    11763        DCL 1 NAME STCLASS,
     3136    11764              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
     3137    11765              2 C CHAR(0) INIT(T#);
     3138    11766        %MEND;
     3139    11767
     3140    11768        %TEXTC( NAME=M$LO , T#='M$LO' );
     3141    11773        %TEXTC( NAME=M$DO , T#='M$DO' );
     3142    11778    1   DCL DCB# UBIN ;
     3143    11779
     3144    11780    1   DCL XUG$ PTR;
     3145    11781
     3146    11782        %VLP_ERRCODE (  FPTN=XUG#GIVING_HELP, STCLASS=CONSTANT,
     3147    11783                        FCG=XU, MID=G, ERR#=%E$XUG#GIVING_HELP, SEV=0);
     3148    11828
     3149    11829        %TEXTC (NAME=DEFAULT, T#='default');
     3150    11834
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:591  
     3151    11835    1   DCL AUTO_HELP BIT (1);
     3152    11836    1   DCL B$JIT$ PTR SYMREF READONLY;
     3153    11837    1   DCL XUG$CLRENABLE_COMMON ENTRY(1) ;
     3154    11838    1   DCL XUG$DISABLE_COMMON ENTRY(1) ;
     3155    11839    1   DCL XUG$ERRMSG_COMMON ENTRY(1) ALTRET;
     3156    11840    1   DCL XUG$INIT_COMMON ENTRY (2) ALTRET;
     3157    11841    1   DCL XUG$FINDDCB_COMMON ENTRY (2) ALTRET;
     3158    11842    1   DCL XUG$OPENOUT_INTERNAL ENTRY(2);
     3159    11843    1   DCL X$HELP ENTRY(1) ALTRET;
     3160    11844        %EJECT;
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:592  
     3161    11845    1       CALL SETUP ALTRET(ALT);
     3162    11846    1       AUTO_HELP = %NO#;
     3163    11847    1   CALL_HELP_UTILITY:
     3164    11848    1       XUG.HELP='1'B;
     3165    11849    1       CALL XUG$DISABLE_COMMON (GETCMD) ;
     3166    11850    1       CALL X$HELP(GETCMD.XUH$->XUH$PARAM) ALTRET(HELPALT);
     3167    11851    1       CALL XUG$CLRENABLE_COMMON(GETCMD) ;
     3168    11852    1       RETURN;
     3169    11853        /**/
     3170    11854    1   HELPALT:
     3171    11855    1       CALL XUG$CLRENABLE_COMMON(GETCMD) ;
     3172    11856    1       GETCMD.ERR_CODE = GETCMD.XUH$ -> XUH$PARAM.ERR ;
     3173    11857    1       GETCMD.ERRDCB# = GETCMD.XUH$ -> XUH$PARAM.ERR_DCB# ;
     3174    11858    1       CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(ALT) ;
     3175    11859    1       IF NOT GETCMD.XUH$->XUH$PARAM.ERR.MON AND
     3176    11860    1         (GETCMD.XUH$->XUH$PARAM.ERR.ERR#=%E$BDTOPIC OR
     3177    11861    1         GETCMD.XUH$->XUH$PARAM.ERR.ERR#=%E$NNATIVE)
     3178    11862    2       THEN DO;
     3179    11863    2           XUG.HELP='11'B;
     3180    11864    2       END;
     3181    11865    1       IF AUTO_HELP
     3182    11866    1       THEN
     3183    11867    1           RETURN;
     3184    11868    1   ALT: ALTRETURN;
     3185    11869        %EJECT;
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:593  
     3186    11870    1   XUG$MOREMSG_COMMON: ENTRY(GETCMD) ALTRET;
     3187    11871    1       CALL SETUP ALTRET(ALT);
     3188    11872    2       IF XUG.HELP THEN DO;
     3189    11873    2           IF XUG.HELP.TOPICS THEN
     3190    11874    2               GETCMD.XUH$->XUH$PARAM.TOPICS#='1'B;
     3191    11875    2           ELSE
     3192    11876    2               GETCMD.XUH$->XUH$PARAM.MORE#='1'B;
     3193    11877    2           CALL XUG$DISABLE_COMMON (GETCMD) ;
     3194    11878    2           CALL X$HELP (GETCMD.XUH$->XUH$PARAM) ALTRET (ALT_WITH_CLEAR);
     3195    11879    2           CALL XUG$CLRENABLE_COMMON(GETCMD) ;
     3196    11880    2       END;
     3197    11881    2       ELSE DO;
     3198    11882    2           GETCMD.ERR_CODE = '0'B ;
     3199    11883    2           CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(DIVERT_TO_HELP);
     3200    11884    2       END;
     3201    11885    1       RETURN;
     3202    11886        /**/
     3203    11887    1   XUG$ALLMSG_COMMON: ENTRY(GETCMD) ALTRET;
     3204    11888    1       CALL SETUP ALTRET(ALT);
     3205    11889    2       IF XUG.HELP THEN DO;
     3206    11890    2           IF XUG.HELP.TOPICS THEN
     3207    11891    2               GETCMD.XUH$->XUH$PARAM.TOPICS#='1'B;
     3208    11892    2           ELSE
     3209    11893    2               GETCMD.XUH$->XUH$PARAM.ALL#='1'B;
     3210    11894    2           CALL XUG$DISABLE_COMMON (GETCMD) ;
     3211    11895    2           CALL X$HELP (GETCMD.XUH$->XUH$PARAM) ALTRET (ALT_WITH_CLEAR);
     3212    11896    2           CALL XUG$CLRENABLE_COMMON(GETCMD) ;
     3213    11897    2       END;
     3214    11898    2       ELSE DO;
     3215    11899    2           GETCMD.ERR_CODE = '0'B ;
     3216    11900    2           CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(DIVERT_TO_HELP);
     3217    11901    3           DO WHILE('1'B);
     3218    11902    3               CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(DONE);
     3219    11903    3           END;
     3220    11904    2   DONE: END;
     3221    11905    1       RETURN;
     3222    11906        /**/
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:594  
     3223    11907    1   DIVERT_TO_HELP:
     3224    11908    1       IF XUG.DIVERT_TO_HELP AND NOT XUG.HELP
     3225    11909    2       THEN DO;
     3226    11910    2           XUG.DIVERT_TO_HELP = %NO#;
     3227    11911    2           AUTO_HELP = %YES#;
     3228    11912    2           GETCMD.ERR_CODE = XUG#GIVING_HELP;
     3229    11913        /*E*  ERROR:   XUG-E$XUG#GIVING_HELP
     3230    11914              MESSAGE:Searching for HELP information: the %U1 topic.
     3231    11915
     3232    11916        */
     3233    11917    2           IF XUG.HELP_TOPIC.COUNT = 0
     3234    11918    2           THEN
     3235    11919    2               GETCMD.F1_ = VECTOR (DEFAULT);
     3236    11920    2           ELSE
     3237    11921    2               GETCMD.F1_ = VECTOR (XUG.HELP_TOPIC);
     3238    11922    2           CALL XUG$ERRMSG_COMMON (GETCMD);
     3239    11923    2           GETCMD.XUH$ -> XUH$PARAM.HELP$ = ADDR (XUG.HELP_TOPIC);
     3240    11924    2           GOTO CALL_HELP_UTILITY;
     3241    11925    2       END;
     3242    11926
     3243    11927    1   ALT_WITH_CLEAR: CALL XUG$CLRENABLE_COMMON(GETCMD) ;
     3244    11928    1       ALTRETURN;
     3245    11929        %EJECT;
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:595  
     3246    11930    1   SETUP: PROC ALTRET ;
     3247    11931    2       IF GETCMD.WORK$ = ADDR(NIL)
     3248    11932    3       THEN DO;
     3249    11933    3           XUG_INIT_A = XUG_INIT_C ;
     3250    11934    3           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) ALTRET(ALT) ;
     3251    11935    3       END;
     3252    11936    2       XUG$ = GETCMD.WORK$ ;
     3253    11937    2       IF GETCMD.XUH$ = ADDR(NIL)
     3254    11938    2       THEN
     3255    11939    2           GETCMD.XUH$ = ADDR(XUG.XUH_PARAM);
     3256    11940    2       IF XUG.XUH_PARAM.OUTDCB1# = DCBNUM(NIL)
     3257    11941    2         AND XUG.XUH_PARAM.OUTDCB2# = DCBNUM(NIL)
     3258    11942    3       THEN DO;
     3259    11943    3           IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)
     3260    11944    3           THEN
     3261    11945    3               XUG.XUH_PARAM.OUTDCB1# = GETCMD.DCB_PARAM# ;
     3262    11946    4           ELSE DO;
     3263    11947    4               IF GETCMD.OUTDCB# ~= DCBNUM(NIL)
     3264    11948    4               THEN
     3265    11949    4                   XUG.XUH_PARAM.OUTDCB1# = GETCMD.OUTDCB# ;
     3266    11950    5               ELSE DO;
     3267    11951    5                   CALL XUG$FINDDCB_COMMON (M$LO, DCB#)
     3268    11952    6                   WHENRETURN DO;
     3269    11953    6                       XUG.XUH_PARAM.OUTDCB1# = DCB# ;
     3270    11954    6                   END;
     3271    11955    6                   WHENALTRETURN DO;
     3272    11956    6                       CALL XUG$FINDDCB_COMMON (M$DO, DCB#)
     3273    11957    7                       WHENRETURN DO;
     3274    11958    7                           XUG.XUH_PARAM.OUTDCB1# = DCB# ;
     3275    11959    7                       END;
     3276    11960    6                   END;
     3277    11961    5               END;
     3278    11962    4           END;
     3279    11963    3       END;
     3280    11964    2       DCB# = XUG.XUH_PARAM.OUTDCB1#;
     3281    11965    2       CALL XUG$OPENOUT_INTERNAL (GETCMD, DCB#);
     3282    11966    2       DCB# = XUG.XUH_PARAM.OUTDCB2#;
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:596  
     3283    11967    2       CALL XUG$OPENOUT_INTERNAL (GETCMD, DCB#);
     3284    11968    2       RETURN ;
     3285    11969    2   ALT:ALTRETURN ;
     3286    11970    2   END SETUP ;
     3287    11971    1   END XUG$HELP_COMMON ;
     3288    11972        %EOD;

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:597  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$HELP_COMMON.

   Procedure XUG$HELP_COMMON requires 278 words for executable code.
   Procedure XUG$HELP_COMMON requires 48 words of local(AUTO) storage.

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:598  

 Object Unit name= XUG$HELP_COMMON                            File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:26:24.20 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      7      7  XUG$HELP_COMMON
    2   Proc  even  none   278    426  XUG$HELP_COMMON
    3  RoData even  none     7      7  XUG$HELP_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  XUG$HELP_COMMON
     2     72          yes     yes      Std        1  XUG$MOREMSG_COMMON
     2    144          yes     yes      Std        1  XUG$ALLMSG_COMMON
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:599  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 XUG$DISABLE_COMMON
 yes     yes           Std       1 X$HELP
         yes           Std       1 XUG$CLRENABLE_COMMON
 yes     yes           Std       1 XUG$ERRMSG_COMMON
 yes     yes           Std       2 XUG$INIT_COMMON
 yes     yes           Std       2 XUG$FINDDCB_COMMON
         yes           Std       2 XUG$OPENOUT_INTERNAL
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  XUG_INIT_C                       r    B$JIT$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:600  


     3114        1        /*T***********************************************************/
     3115        2        /*T*                                                         */
     3116        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3117        4        /*T*                                                         */
     3118        5        /*T***********************************************************/
     3119        6        XUG$HELP_COMMON: PROC(GETCMD) ALTRET;

      6  2 000000   000000 700200 xent  XUG$HELP_CO* TSX0  ! X66_AUTO_1
         2 000001   000060 000001                    ZERO    48,1

     3120        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3121        8        %INCLUDE B$JIT;
     3122      611        %INCLUDE CP_6;
     3123     6170        %INCLUDE CP_6_SUBS;
     3124     6710        %INCLUDE XU_MACRO_C;
     3125     9816        %INCLUDE XU_PERR_C;
     3126    10007        %INCLUDE XUH_MACRO_C;
     3127    10091
     3128    10092        %XUG_GETCMD (NAME=GETCMD, STCLASS="") ;
     3129    10430        %XUH_PARAM (NAME=XUH$PARAM,STCLASS=BASED);
     3130    10491        %XUG_PARAMS;
     3131    10935        %XUG_INIT (NAME=XUG_INIT_C, STCLASS=SYMREF);
     3132    11348        %XUG_INIT (NAME = XUG_INIT_A,STCLASS=AUTO);
     3133    11761
     3134    11762        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
     3135    11763        DCL 1 NAME STCLASS,
     3136    11764              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
     3137    11765              2 C CHAR(0) INIT(T#);
     3138    11766        %MEND;
     3139    11767
     3140    11768        %TEXTC( NAME=M$LO , T#='M$LO' );
     3141    11773        %TEXTC( NAME=M$DO , T#='M$DO' );
     3142    11778    1   DCL DCB# UBIN ;
     3143    11779
     3144    11780    1   DCL XUG$ PTR;
     3145    11781
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:601  
     3146    11782        %VLP_ERRCODE (  FPTN=XUG#GIVING_HELP, STCLASS=CONSTANT,
     3147    11783                        FCG=XU, MID=G, ERR#=%E$XUG#GIVING_HELP, SEV=0);
     3148    11828
     3149    11829        %TEXTC (NAME=DEFAULT, T#='default');
     3150    11834
     3151    11835    1   DCL AUTO_HELP BIT (1);
     3152    11836    1   DCL B$JIT$ PTR SYMREF READONLY;
     3153    11837    1   DCL XUG$CLRENABLE_COMMON ENTRY(1) ;
     3154    11838    1   DCL XUG$DISABLE_COMMON ENTRY(1) ;
     3155    11839    1   DCL XUG$ERRMSG_COMMON ENTRY(1) ALTRET;
     3156    11840    1   DCL XUG$INIT_COMMON ENTRY (2) ALTRET;
     3157    11841    1   DCL XUG$FINDDCB_COMMON ENTRY (2) ALTRET;
     3158    11842    1   DCL XUG$OPENOUT_INTERNAL ENTRY(2);
     3159    11843    1   DCL X$HELP ENTRY(1) ALTRET;
     3160    11844        %EJECT;
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:602  
     3161    11845    1       CALL SETUP ALTRET(ALT);

  11845  2 000002   000273 701000 2                  TSX1    SETUP
         2 000003   000071 702000 2                  TSX2    ALT

     3162    11846    1       AUTO_HELP = %NO#;

  11846  2 000004   200052 450100                    STZ     AUTO_HELP,,AUTO

     3163    11847    1   CALL_HELP_UTILITY:
     3164    11848    1       XUG.HELP='1'B;

  11848  2 000005   200051 470500       CALL_HELP_U* LDP0    XUG$,,AUTO
         2 000006   000071 236100                    LDQ     57,,PR0
         2 000007   000000 376000 3                  ANQ     0
         2 000010   400000 276003                    ORQ     -131072,DU
         2 000011   000071 756100                    STQ     57,,PR0

     3165    11849    1       CALL XUG$DISABLE_COMMON (GETCMD) ;

  11849  2 000012   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000013   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000014   000000 701000 xent               TSX1    XUG$DISABLE_COMMON
         2 000015   000000 011000                    NOP     0

     3166    11850    1       CALL X$HELP(GETCMD.XUH$->XUH$PARAM) ALTRET(HELPALT);

  11850  2 000016   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000017   000005 471500                    LDP1    5,,PR0
         2 000020   200056 451500                    STP1    AUTO_HELP+4,,AUTO
         2 000021   200056 630500                    EPPR0   AUTO_HELP+4,,AUTO
         2 000022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000023   000000 701000 xent               TSX1    X$HELP
         2 000024   000032 702000 2                  TSX2    HELPALT

     3167    11851    1       CALL XUG$CLRENABLE_COMMON(GETCMD) ;

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:603  
  11851  2 000025   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000026   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000027   000000 701000 xent               TSX1    XUG$CLRENABLE_COMMON
         2 000030   000000 011000                    NOP     0

     3168    11852    1       RETURN;

  11852  2 000031   000000 702200 xent               TSX2  ! X66_ARET

     3169    11853        /**/
     3170    11854    1   HELPALT:
     3171    11855    1       CALL XUG$CLRENABLE_COMMON(GETCMD) ;

  11855  2 000032   200003 630500       HELPALT      EPPR0   @GETCMD,,AUTO
         2 000033   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000034   000000 701000 xent               TSX1    XUG$CLRENABLE_COMMON
         2 000035   000000 011000                    NOP     0

     3172    11856    1       GETCMD.ERR_CODE = GETCMD.XUH$ -> XUH$PARAM.ERR ;

  11856  2 000036   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000037   000005 471500                    LDP1    5,,PR0
         2 000040   100013 236100                    LDQ     11,,PR1
         2 000041   000010 756100                    STQ     8,,PR0

     3173    11857    1       GETCMD.ERRDCB# = GETCMD.XUH$ -> XUH$PARAM.ERR_DCB# ;

  11857  2 000042   100014 235100                    LDA     12,,PR1
         2 000043   000011 755100                    STA     9,,PR0

     3174    11858    1       CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(ALT) ;

  11858  2 000044   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000045   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000046   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 000047   000071 702000 2                  TSX2    ALT

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:604  
     3175    11859    1       IF NOT GETCMD.XUH$->XUH$PARAM.ERR.MON AND

  11859  2 000050   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000051   000005 471500                    LDP1    5,,PR0
         2 000052   100013 236100                    LDQ     11,,PR1
         2 000053   400000 316007                    CANQ    -131072,DL
         2 000054   000066 601000 2                  TNZ     s:11865
         2 000055   100013 236100                    LDQ     11,,PR1
         2 000056   377770 376007                    ANQ     131064,DL
         2 000057   004550 116007                    CMPQ    2408,DL
         2 000060   000063 600000 2                  TZE     s:11863
         2 000061   004560 116007                    CMPQ    2416,DL
         2 000062   000066 601000 2                  TNZ     s:11865

     3176    11860    1         (GETCMD.XUH$->XUH$PARAM.ERR.ERR#=%E$BDTOPIC OR
     3177    11861    1         GETCMD.XUH$->XUH$PARAM.ERR.ERR#=%E$NNATIVE)
     3178    11862    2       THEN DO;

     3179    11863    2           XUG.HELP='11'B;

  11863  2 000063   200051 473500                    LDP3    XUG$,,AUTO
         2 000064   600000 236003                    LDQ     -65536,DU
         2 000065   300071 256100                    ORSQ    57,,PR3

     3180    11864    2       END;

     3181    11865    1       IF AUTO_HELP

  11865  2 000066   200052 234100                    SZN     AUTO_HELP,,AUTO
         2 000067   000071 605000 2                  TPL     ALT

     3182    11866    1       THEN
     3183    11867    1           RETURN;

  11867  2 000070   000000 702200 xent               TSX2  ! X66_ARET

     3184    11868    1   ALT: ALTRETURN;
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:605  

  11868  2 000071   000000 702200 xent  ALT          TSX2  ! X66_AALT

     3185    11869        %EJECT;
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:606  
     3186    11870    1   XUG$MOREMSG_COMMON: ENTRY(GETCMD) ALTRET;

  11870  2 000072   000000 700200 xent  XUG$MOREMSG* TSX0  ! X66_AUTO_1
         2 000073   000060 000001                    ZERO    48,1

     3187    11871    1       CALL SETUP ALTRET(ALT);

  11871  2 000074   000273 701000 2                  TSX1    SETUP
         2 000075   000071 702000 2                  TSX2    ALT

     3188    11872    2       IF XUG.HELP THEN DO;

  11872  2 000076   200051 470500                    LDP0    XUG$,,AUTO
         2 000077   000071 236100                    LDQ     57,,PR0
         2 000100   600000 316003                    CANQ    -65536,DU
         2 000101   000135 600000 2                  TZE     s:11882

     3189    11873    2           IF XUG.HELP.TOPICS THEN

  11873  2 000102   200000 316003                    CANQ    65536,DU
         2 000103   000111 600000 2                  TZE     s:11876

     3190    11874    2               GETCMD.XUH$->XUH$PARAM.TOPICS#='1'B;

  11874  2 000104   200003 471500                    LDP1    @GETCMD,,AUTO
         2 000105   100005 473500                    LDP3    5,,PR1
         2 000106   000100 236003                    LDQ     64,DU
         2 000107   300012 256100                    ORSQ    10,,PR3
         2 000110   000115 710000 2                  TRA     s:11877

     3191    11875    2           ELSE
     3192    11876    2               GETCMD.XUH$->XUH$PARAM.MORE#='1'B;

  11876  2 000111   200003 471500                    LDP1    @GETCMD,,AUTO
         2 000112   100005 473500                    LDP3    5,,PR1
         2 000113   000200 236003                    LDQ     128,DU
         2 000114   300012 256100                    ORSQ    10,,PR3
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:607  

     3193    11877    2           CALL XUG$DISABLE_COMMON (GETCMD) ;

  11877  2 000115   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000116   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000117   000000 701000 xent               TSX1    XUG$DISABLE_COMMON
         2 000120   000000 011000                    NOP     0

     3194    11878    2           CALL X$HELP (GETCMD.XUH$->XUH$PARAM) ALTRET (ALT_WITH_CLEAR);

  11878  2 000121   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000122   000005 471500                    LDP1    5,,PR0
         2 000123   200056 451500                    STP1    AUTO_HELP+4,,AUTO
         2 000124   200056 630500                    EPPR0   AUTO_HELP+4,,AUTO
         2 000125   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000126   000000 701000 xent               TSX1    X$HELP
         2 000127   000266 702000 2                  TSX2    ALT_WITH_CLEAR

     3195    11879    2           CALL XUG$CLRENABLE_COMMON(GETCMD) ;

  11879  2 000130   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000132   000000 701000 xent               TSX1    XUG$CLRENABLE_COMMON
         2 000133   000000 011000                    NOP     0

     3196    11880    2       END;

  11880  2 000134   000143 710000 2                  TRA     s:11885

     3197    11881    2       ELSE DO;

     3198    11882    2           GETCMD.ERR_CODE = '0'B ;

  11882  2 000135   200003 471500                    LDP1    @GETCMD,,AUTO
         2 000136   100010 450100                    STZ     8,,PR1

     3199    11883    2           CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(DIVERT_TO_HELP);
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:608  

  11883  2 000137   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000140   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000141   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 000142   000223 702000 2                  TSX2    DIVERT_TO_HELP

     3200    11884    2       END;

     3201    11885    1       RETURN;

  11885  2 000143   000000 702200 xent               TSX2  ! X66_ARET

     3202    11886        /**/
     3203    11887    1   XUG$ALLMSG_COMMON: ENTRY(GETCMD) ALTRET;

  11887  2 000144   000000 700200 xent  XUG$ALLMSG_* TSX0  ! X66_AUTO_1
         2 000145   000060 000001                    ZERO    48,1

     3204    11888    1       CALL SETUP ALTRET(ALT);

  11888  2 000146   000273 701000 2                  TSX1    SETUP
         2 000147   000071 702000 2                  TSX2    ALT

     3205    11889    2       IF XUG.HELP THEN DO;

  11889  2 000150   200051 470500                    LDP0    XUG$,,AUTO
         2 000151   000071 236100                    LDQ     57,,PR0
         2 000152   600000 316003                    CANQ    -65536,DU
         2 000153   000207 600000 2                  TZE     s:11899

     3206    11890    2           IF XUG.HELP.TOPICS THEN

  11890  2 000154   200000 316003                    CANQ    65536,DU
         2 000155   000163 600000 2                  TZE     s:11893

     3207    11891    2               GETCMD.XUH$->XUH$PARAM.TOPICS#='1'B;

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:609  
  11891  2 000156   200003 471500                    LDP1    @GETCMD,,AUTO
         2 000157   100005 473500                    LDP3    5,,PR1
         2 000160   000100 236003                    LDQ     64,DU
         2 000161   300012 256100                    ORSQ    10,,PR3
         2 000162   000167 710000 2                  TRA     s:11894

     3208    11892    2           ELSE
     3209    11893    2               GETCMD.XUH$->XUH$PARAM.ALL#='1'B;

  11893  2 000163   200003 471500                    LDP1    @GETCMD,,AUTO
         2 000164   100005 473500                    LDP3    5,,PR1
         2 000165   000400 236003                    LDQ     256,DU
         2 000166   300012 256100                    ORSQ    10,,PR3

     3210    11894    2           CALL XUG$DISABLE_COMMON (GETCMD) ;

  11894  2 000167   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000170   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000171   000000 701000 xent               TSX1    XUG$DISABLE_COMMON
         2 000172   000000 011000                    NOP     0

     3211    11895    2           CALL X$HELP (GETCMD.XUH$->XUH$PARAM) ALTRET (ALT_WITH_CLEAR);

  11895  2 000173   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000174   000005 471500                    LDP1    5,,PR0
         2 000175   200056 451500                    STP1    AUTO_HELP+4,,AUTO
         2 000176   200056 630500                    EPPR0   AUTO_HELP+4,,AUTO
         2 000177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000200   000000 701000 xent               TSX1    X$HELP
         2 000201   000266 702000 2                  TSX2    ALT_WITH_CLEAR

     3212    11896    2           CALL XUG$CLRENABLE_COMMON(GETCMD) ;

  11896  2 000202   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000203   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000204   000000 701000 xent               TSX1    XUG$CLRENABLE_COMMON
         2 000205   000000 011000                    NOP     0
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:610  

     3213    11897    2       END;

  11897  2 000206   000222 710000 2                  TRA     s:11905

     3214    11898    2       ELSE DO;

     3215    11899    2           GETCMD.ERR_CODE = '0'B ;

  11899  2 000207   200003 471500                    LDP1    @GETCMD,,AUTO
         2 000210   100010 450100                    STZ     8,,PR1

     3216    11900    2           CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(DIVERT_TO_HELP);

  11900  2 000211   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000212   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000213   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 000214   000223 702000 2                  TSX2    DIVERT_TO_HELP

     3217    11901    3           DO WHILE('1'B);

     3218    11902    3               CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(DONE);

  11902  2 000215   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000216   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000217   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 000220   000222 702000 2                  TSX2    s:11905

     3219    11903    3           END;

  11903  2 000221   000215 710000 2                  TRA     s:11902

     3220    11904    2   DONE: END;
     3221    11905    1       RETURN;

  11905  2 000222   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:611  
     3222    11906        /**/
     3223    11907    1   DIVERT_TO_HELP:
     3224    11908    1       IF XUG.DIVERT_TO_HELP AND NOT XUG.HELP

  11908  2 000223   200051 470500       DIVERT_TO_H* LDP0    XUG$,,AUTO
         2 000224   000071 236100                    LDQ     57,,PR0
         2 000225   400000 316007                    CANQ    -131072,DL
         2 000226   000266 600000 2                  TZE     ALT_WITH_CLEAR
         2 000227   600000 316003                    CANQ    -65536,DU
         2 000230   000266 601000 2                  TNZ     ALT_WITH_CLEAR

     3225    11909    2       THEN DO;

     3226    11910    2           XUG.DIVERT_TO_HELP = %NO#;

  11910  2 000231   000001 236000 3                  LDQ     1
         2 000232   000071 356100                    ANSQ    57,,PR0

     3227    11911    2           AUTO_HELP = %YES#;

  11911  2 000233   400000 236003                    LDQ     -131072,DU
         2 000234   200052 756100                    STQ     AUTO_HELP,,AUTO

     3228    11912    2           GETCMD.ERR_CODE = XUG#GIVING_HELP;

  11912  2 000235   000004 236000 1                  LDQ     XUG#GIVING_HELP
         2 000236   200003 471500                    LDP1    @GETCMD,,AUTO
         2 000237   100010 756100                    STQ     8,,PR1

     3229    11913        /*E*  ERROR:   XUG-E$XUG#GIVING_HELP
     3230    11914              MESSAGE:Searching for HELP information: the %U1 topic.
     3231    11915
     3232    11916        */
     3233    11917    2           IF XUG.HELP_TOPIC.COUNT = 0

  11917  2 000240   000246 236100                    LDQ     166,,PR0
         2 000241   777000 316003                    CANQ    -512,DU
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:612  
         2 000242   000247 601000 2                  TNZ     s:11921

     3234    11918    2           THEN
     3235    11919    2               GETCMD.F1_ = VECTOR (DEFAULT);

  11919  2 000243   000002 237000 3                  LDAQ    2
         2 000244   100017 755100                    STA     15,,PR1
         2 000245   100020 756100                    STQ     16,,PR1
         2 000246   000254 710000 2                  TRA     s:11922

     3236    11920    2           ELSE
     3237    11921    2               GETCMD.F1_ = VECTOR (XUG.HELP_TOPIC);

  11921  2 000247   000004 235000 3                  LDA     4
         2 000250   200051 236100                    LDQ     XUG$,,AUTO
         2 000251   000246 036003                    ADLQ    166,DU
         2 000252   100017 755100                    STA     15,,PR1
         2 000253   100020 756100                    STQ     16,,PR1

     3238    11922    2           CALL XUG$ERRMSG_COMMON (GETCMD);

  11922  2 000254   200003 630500                    EPPR0   @GETCMD,,AUTO
         2 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000256   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         2 000257   000000 011000                    NOP     0

     3239    11923    2           GETCMD.XUH$ -> XUH$PARAM.HELP$ = ADDR (XUG.HELP_TOPIC);

  11923  2 000260   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000261   000005 471500                    LDP1    5,,PR0
         2 000262   200051 236100                    LDQ     XUG$,,AUTO
         2 000263   000246 036003                    ADLQ    166,DU
         2 000264   100011 756100                    STQ     9,,PR1

     3240    11924    2           GOTO CALL_HELP_UTILITY;

  11924  2 000265   000005 710000 2                  TRA     CALL_HELP_UTILITY
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:613  

     3241    11925    2       END;
     3242    11926
     3243    11927    1   ALT_WITH_CLEAR: CALL XUG$CLRENABLE_COMMON(GETCMD) ;

  11927  2 000266   200003 630500       ALT_WITH_CL* EPPR0   @GETCMD,,AUTO
         2 000267   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000270   000000 701000 xent               TSX1    XUG$CLRENABLE_COMMON
         2 000271   000000 011000                    NOP     0

     3244    11928    1       ALTRETURN;

  11928  2 000272   000000 702200 xent               TSX2  ! X66_AALT

     3245    11929        %EJECT;
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:614  
     3246    11930    1   SETUP: PROC ALTRET ;

  11930  2 000273   200054 741300       SETUP        STX1  ! AUTO_HELP+2,,AUTO

     3247    11931    2       IF GETCMD.WORK$ = ADDR(NIL)

  11931  2 000274   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000275   000004 236100                    LDQ     4,,PR0
         2 000276   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000277   000313 601000 2                  TNZ     s:11936

     3248    11932    3       THEN DO;

     3249    11933    3           XUG_INIT_A = XUG_INIT_C ;

  11933  2 000300   000100 100400                    MLR     fill='000'O
         2 000301   000000 000220 xsym               ADSC9   XUG_INIT_C               cn=0,n=144
         2 000302   200004 000220                    ADSC9   XUG_INIT_A,,AUTO         cn=0,n=144

     3250    11934    3           CALL XUG$INIT_COMMON (GETCMD,XUG_INIT_A) ALTRET(ALT) ;

  11934  2 000303   200004 631500                    EPPR1   XUG_INIT_A,,AUTO
         2 000304   200057 451500                    STP1    AUTO_HELP+5,,AUTO
         2 000305   200003 236100                    LDQ     @GETCMD,,AUTO
         2 000306   200056 756100                    STQ     AUTO_HELP+4,,AUTO
         2 000307   200056 630500                    EPPR0   AUTO_HELP+4,,AUTO
         2 000310   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000311   000000 701000 xent               TSX1    XUG$INIT_COMMON
         2 000312   000424 702000 2                  TSX2    ALT

     3251    11935    3       END;

     3252    11936    2       XUG$ = GETCMD.WORK$ ;

  11936  2 000313   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000314   000004 236100                    LDQ     4,,PR0
         2 000315   200051 756100                    STQ     XUG$,,AUTO
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:615  

     3253    11937    2       IF GETCMD.XUH$ = ADDR(NIL)

  11937  2 000316   000005 236100                    LDQ     5,,PR0
         2 000317   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000320   000324 601000 2                  TNZ     s:11940

     3254    11938    2       THEN
     3255    11939    2           GETCMD.XUH$ = ADDR(XUG.XUH_PARAM);

  11939  2 000321   200051 236100                    LDQ     XUG$,,AUTO
         2 000322   000154 036003                    ADLQ    108,DU
         2 000323   000005 756100                    STQ     5,,PR0

     3256    11940    2       IF XUG.XUH_PARAM.OUTDCB1# = DCBNUM(NIL)

  11940  2 000324   200051 471500                    LDP1    XUG$,,AUTO
         2 000325   100164 220100                    LDX0    116,,PR1
         2 000326   000372 601000 2                  TNZ     s:11964
         2 000327   100164 721100                    LXL1    116,,PR1
         2 000330   000372 601000 2                  TNZ     s:11964

     3257    11941    2         AND XUG.XUH_PARAM.OUTDCB2# = DCBNUM(NIL)
     3258    11942    3       THEN DO;

     3259    11943    3           IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)

  11943  2 000331   000014 235100                    LDA     12,,PR0
         2 000332   000336 600000 2                  TZE     s:11947

     3260    11944    3           THEN
     3261    11945    3               XUG.XUH_PARAM.OUTDCB1# = GETCMD.DCB_PARAM# ;

  11945  2 000333   000014 722100                    LXL2    12,,PR0
         2 000334   100164 742100                    STX2    116,,PR1
         2 000335   000372 710000 2                  TRA     s:11964

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:616  
     3262    11946    4           ELSE DO;

     3263    11947    4               IF GETCMD.OUTDCB# ~= DCBNUM(NIL)

  11947  2 000336   000013 235100                    LDA     11,,PR0
         2 000337   000343 600000 2                  TZE     s:11951

     3264    11948    4               THEN
     3265    11949    4                   XUG.XUH_PARAM.OUTDCB1# = GETCMD.OUTDCB# ;

  11949  2 000340   000013 722100                    LXL2    11,,PR0
         2 000341   100164 742100                    STX2    116,,PR1
         2 000342   000372 710000 2                  TRA     s:11964

     3266    11950    5               ELSE DO;

     3267    11951    5                   CALL XUG$FINDDCB_COMMON (M$LO, DCB#)

  11951  2 000343   200050 633500                    EPPR3   DCB#,,AUTO
         2 000344   200057 453500                    STP3    AUTO_HELP+5,,AUTO
         2 000345   000005 236000 3                  LDQ     5
         2 000346   200056 756100                    STQ     AUTO_HELP+4,,AUTO
         2 000347   200056 630500                    EPPR0   AUTO_HELP+4,,AUTO
         2 000350   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000351   000000 701000 xent               TSX1    XUG$FINDDCB_COMMON
         2 000352   000357 702000 2                  TSX2    s:11956

     3268    11952    6                   WHENRETURN DO;

     3269    11953    6                       XUG.XUH_PARAM.OUTDCB1# = DCB# ;

  11953  2 000353   200050 720100                    LXL0    DCB#,,AUTO
         2 000354   200051 470500                    LDP0    XUG$,,AUTO
         2 000355   000164 740100                    STX0    116,,PR0

     3270    11954    6                   END;

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:617  
  11954  2 000356   000372 710000 2                  TRA     s:11964

     3271    11955    6                   WHENALTRETURN DO;

     3272    11956    6                       CALL XUG$FINDDCB_COMMON (M$DO, DCB#)

  11956  2 000357   200050 630500                    EPPR0   DCB#,,AUTO
         2 000360   200057 450500                    STP0    AUTO_HELP+5,,AUTO
         2 000361   000006 236000 3                  LDQ     6
         2 000362   200056 756100                    STQ     AUTO_HELP+4,,AUTO
         2 000363   200056 630500                    EPPR0   AUTO_HELP+4,,AUTO
         2 000364   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000365   000000 701000 xent               TSX1    XUG$FINDDCB_COMMON
         2 000366   000372 702000 2                  TSX2    s:11964

     3273    11957    7                       WHENRETURN DO;

     3274    11958    7                           XUG.XUH_PARAM.OUTDCB1# = DCB# ;

  11958  2 000367   200050 720100                    LXL0    DCB#,,AUTO
         2 000370   200051 470500                    LDP0    XUG$,,AUTO
         2 000371   000164 740100                    STX0    116,,PR0

     3275    11959    7                       END;

     3276    11960    6                   END;

     3277    11961    5               END;

     3278    11962    4           END;

     3279    11963    3       END;

     3280    11964    2       DCB# = XUG.XUH_PARAM.OUTDCB1#;

  11964  2 000372   200051 470500                    LDP0    XUG$,,AUTO
         2 000373   000164 236100                    LDQ     116,,PR0
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:618  
         2 000374   000022 772000                    QRL     18
         2 000375   200050 756100                    STQ     DCB#,,AUTO

     3281    11965    2       CALL XUG$OPENOUT_INTERNAL (GETCMD, DCB#);

  11965  2 000376   200050 631500                    EPPR1   DCB#,,AUTO
         2 000377   200057 451500                    STP1    AUTO_HELP+5,,AUTO
         2 000400   200003 236100                    LDQ     @GETCMD,,AUTO
         2 000401   200056 756100                    STQ     AUTO_HELP+4,,AUTO
         2 000402   200056 630500                    EPPR0   AUTO_HELP+4,,AUTO
         2 000403   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000404   000000 701000 xent               TSX1    XUG$OPENOUT_INTERNAL
         2 000405   000000 011000                    NOP     0

     3282    11966    2       DCB# = XUG.XUH_PARAM.OUTDCB2#;

  11966  2 000406   200051 470500                    LDP0    XUG$,,AUTO
         2 000407   000164 236100                    LDQ     116,,PR0
         2 000410   777777 376007                    ANQ     -1,DL
         2 000411   200050 756100                    STQ     DCB#,,AUTO

     3283    11967    2       CALL XUG$OPENOUT_INTERNAL (GETCMD, DCB#);

  11967  2 000412   200050 631500                    EPPR1   DCB#,,AUTO
         2 000413   200057 451500                    STP1    AUTO_HELP+5,,AUTO
         2 000414   200003 236100                    LDQ     @GETCMD,,AUTO
         2 000415   200056 756100                    STQ     AUTO_HELP+4,,AUTO
         2 000416   200056 630500                    EPPR0   AUTO_HELP+4,,AUTO
         2 000417   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000420   000000 701000 xent               TSX1    XUG$OPENOUT_INTERNAL
         2 000421   000000 011000                    NOP     0

     3284    11968    2       RETURN ;

  11968  2 000422   200054 221300                    LDX1  ! AUTO_HELP+2,,AUTO
         2 000423   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:619  
     3285    11969    2   ALT:ALTRETURN ;

  11969  2 000424   200054 221300       ALT          LDX1  ! AUTO_HELP+2,,AUTO
         2 000425   000000 702211                    TSX2  ! 0,X1
     3286    11970    2   END SETUP ;
     3287    11971    1   END XUG$HELP_COMMON ;
     3288    11972        %EOD;

PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:620  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$HELP_COMMON.
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:621  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$HELP_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/c STRC(72)    r     1 DEFAULT                    2-0-0/c STRC(45)    r     1 M$DO
     0-0-0/c STRC(45)    r     1 M$LO                       4-0-0/w STRC        r     1 XUG#GIVING_HELP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GETCMD                   52-0-0/b BIT         r     1 AUTO_HELP
    50-0-0/w UBIN        r     1 DCB#                      *0-0-0/d STRC(1512)  r     1 GETCMD
    51-0-0/w PTR         r     1 XUG$                       4-0-0/d STRC(1296)  r     1 XUG_INIT_A

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/d STRC(1296)  r     1 XUG_INIT_C

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(9612)  r     1 XUG                        0-0-0/d STRC(2052)  r     1 XUH$PARAM


   Procedure XUG$HELP_COMMON requires 278 words for executable code.
   Procedure XUG$HELP_COMMON requires 48 words of local(AUTO) storage.
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:622  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:623  
          MINI XREF LISTING

ALT
     11868**LABEL   11845--CALLALT 11858--CALLALT 11871--CALLALT 11888--CALLALT
ALT IN PROCEDURE SETUP
     11969**LABEL   11934--CALLALT
ALT_WITH_CLEAR
     11927**LABEL   11878--CALLALT 11895--CALLALT
AUTO_HELP
     11835**DCL     11846<<ASSIGN  11865>>IF      11911<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
       429**DCL       429--REDEF
B$JIT.ERR.MID
       336**DCL       336--REDEF
B$JIT.JRESPEAK
       497**DCL       498--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
       606**DCL       606--REDEF     607--REDEF
B$JIT.PNR
       510**DCL       510--REDEF
B$JIT.TSLINE
       604**DCL       605--REDEF
B$JIT$
     11836**DCL       330--IMP-PTR
CALL_HELP_UTILITY
     11848**LABEL   11924--GOTO
DCB#
     11778**DCL     11951<>CALL    11953>>ASSIGN  11956<>CALL    11958>>ASSIGN  11964<<ASSIGN  11965<>CALL
     11966<<ASSIGN  11967<>CALL
DEFAULT
     11830**DCL     11919--ASSIGN
DIVERT_TO_HELP
     11908**LABEL   11883--CALLALT 11900--CALLALT
DONE
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:624  
     11904**LABEL   11902--CALLALT
GETCMD
     10105**DCL         6--PROC    11849<>CALL    11851<>CALL    11855<>CALL    11858<>CALL    11870--ENTRY
     11877<>CALL    11879<>CALL    11883<>CALL    11887--ENTRY   11894<>CALL    11896<>CALL    11900<>CALL
     11902<>CALL    11922<>CALL    11927<>CALL    11934<>CALL    11965<>CALL    11967<>CALL
GETCMD.DCB_PARAM#
     10285**DCL     11943>>IF      11945>>ASSIGN
GETCMD.ERRDCB#
     10264**DCL     11857<<ASSIGN
GETCMD.ERR_CODE
     10253**DCL     11856<<ASSIGN  11882<<ASSIGN  11899<<ASSIGN  11912<<ASSIGN
GETCMD.F1_
     10302**DCL     11919<<ASSIGN  11921<<ASSIGN
GETCMD.OUT$
     10110**DCL     10116--REDEF
GETCMD.OUTDCB#
     10281**DCL     11947>>IF      11949>>ASSIGN
GETCMD.WORK$
     10138**DCL     11931>>IF      11936>>ASSIGN
GETCMD.XUH$
     10143**DCL     11850>>CALL    11856>>ASSIGN  11857>>ASSIGN  11859>>IF      11859>>IF      11859>>IF
     11874>>ASSIGN  11876>>ASSIGN  11878>>CALL    11891>>ASSIGN  11893>>ASSIGN  11895>>CALL    11923>>ASSIGN
     11937>>IF      11939<<ASSIGN
HELPALT
     11855**LABEL   11850--CALLALT
M$DO
     11774**DCL     11956<>CALL
M$LO
     11769**DCL     11951<>CALL
SETUP
     11930**PROC    11845--CALL    11871--CALL    11888--CALL
X$HELP
     11843**DCL-ENT 11850--CALL    11878--CALL    11895--CALL
XUG.BUF
     10930**DCL     10933--REDEF
XUG.DIVERT_TO_HELP
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:625  
     10668**DCL     11908>>IF      11910<<ASSIGN
XUG.HELP
     10593**DCL     11848<<ASSIGN  11863<<ASSIGN  11872>>IF      11889>>IF      11908>>IF
XUG.HELP.TOPICS
     10595**DCL     11873>>IF      11890>>IF
XUG.HELP_TOPIC
     10868**DCL     11921--ASSIGN  11923--ASSIGN
XUG.HELP_TOPIC.COUNT
     10875**DCL     11917>>IF
XUG.XUH_PARAM
     10827**DCL     11939--ASSIGN
XUG.XUH_PARAM.OUTDCB1#
     10833**DCL     11940>>IF      11945<<ASSIGN  11949<<ASSIGN  11953<<ASSIGN  11958<<ASSIGN  11964>>ASSIGN
XUG.XUH_PARAM.OUTDCB2#
     10834**DCL     11940>>IF      11966>>ASSIGN
XUG#GIVING_HELP
     11795**DCL     11912>>ASSIGN
XUG$
     11780**DCL     10494--IMP-PTR 11848>>ASSIGN  11863>>ASSIGN  11872>>IF      11873>>IF      11889>>IF
     11890>>IF      11908>>IF      11908>>IF      11910>>ASSIGN  11917>>IF      11921>>ASSIGN  11923>>ASSIGN
     11936<<ASSIGN  11939>>ASSIGN  11940>>IF      11940>>IF      11945>>ASSIGN  11949>>ASSIGN  11953>>ASSIGN
     11958>>ASSIGN  11964>>ASSIGN  11966>>ASSIGN
XUG$CLRENABLE_COMMON
     11837**DCL-ENT 11851--CALL    11855--CALL    11879--CALL    11896--CALL    11927--CALL
XUG$DISABLE_COMMON
     11838**DCL-ENT 11849--CALL    11877--CALL    11894--CALL
XUG$ERRMSG_COMMON
     11839**DCL-ENT 11858--CALL    11883--CALL    11900--CALL    11902--CALL    11922--CALL
XUG$FINDDCB_COMMON
     11841**DCL-ENT 11951--CALL    11956--CALL
XUG$INIT_COMMON
     11840**DCL-ENT 11934--CALL
XUG$OPENOUT_INTERNAL
     11842**DCL-ENT 11965--CALL    11967--CALL
XUG_INIT_A
     11370**DCL     11933<<ASSIGN  11934<>CALL
PL6.E3A0      #011=XUG$HELP_COMMON File=XUG$COMMON.:E05TSI                       WED 07/30/97 09:26 Page:626  
XUG_INIT_C
     10957**DCL     11933>>ASSIGN
XUH$PARAM
     10450**DCL     11850<>CALL    11878<>CALL    11895<>CALL
XUH$PARAM.ALL#
     10462**DCL     11893<<ASSIGN
XUH$PARAM.ERR
     10467**DCL     11856>>ASSIGN
XUH$PARAM.ERR.ERR#
     10471**DCL     11859>>IF      11859>>IF
XUH$PARAM.ERR.MON
     10470**DCL     11859>>IF
XUH$PARAM.ERR_DCB#
     10473**DCL     11857>>ASSIGN
XUH$PARAM.HELP$
     10460**DCL     11923<<ASSIGN
XUH$PARAM.MORE#
     10463**DCL     11876<<ASSIGN
XUH$PARAM.TOPICS#
     10464**DCL     11874<<ASSIGN  11891<<ASSIGN

PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:627  
     3289        1        /*T***********************************************************/
     3290        2        /*T*                                                         */
     3291        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3292        4        /*T*                                                         */
     3293        5        /*T***********************************************************/
     3294        6        XUG$FINDDCB_COMMON: PROC(DCBNAME,DCB#) ALTRET;
     3295        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3296        8    1   DCL 1 DCBNAME,
     3297        9    1         2 L UBIN BYTE UNAL,
     3298       10    1         2 C CHAR(DCBNAME.L);
     3299       11    1   DCL DCB# SBIN;
     3300       12        /**/
     3301       13        %INCLUDE CP_6;
     3302     5572        %INCLUDE B$ROSEG;
     3303     5635    1   DCL B$ROS$ PTR SYMREF;
     3304     5636        %F$DCB;
     3305     5693        /**/
     3306     5694        %FPT_GETDCB (MERGE=YES,STCLASS=CONSTANT,FPTN=FPT_GETDCB_C);
     3307     5709        %FPT_GETDCB (STCLASS=AUTO);
     3308     5724    1   DCL I SBIN;
     3309     5725    1   DCL GET BIT(1) ALIGNED;
     3310     5726        %EJECT;
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:628  
     3311     5727    1       GET='0'B;
     3312     5728    1       GOTO FIND;
     3313     5729    1   XUG$GETDCB_COMMON: ENTRY(DCBNAME,DCB#) ALTRET;
     3314     5730    1       GET='1'B;
     3315     5731    1   FIND:
     3316     5732    2       DO I=1 TO B$ROS$->B$ROSEG.NUMDCBS;
     3317     5733    3           IF DCBADDR(I)~=ADDR(NIL) THEN DO;
     3318     5734    4               IF DCBADDR(I)->F$DCB.DCBNAME.N=DCBNAME.C THEN DO;
     3319     5735    4                   DCB#=I;
     3320     5736    4                   RETURN;
     3321     5737    4               END;
     3322     5738    3           END;
     3323     5739    2       END;
     3324     5740    1       IF NOT GET THEN ALTRETURN;
     3325     5741    1       FPT_GETDCB = FPT_GETDCB_C;
     3326     5742    1       FPT_GETDCB.DCBNAME_=VECTOR(DCBNAME);
     3327     5743    1       FPT_GETDCB.DCBNUM_=VECTOR(DCB#);
     3328     5744    1       CALL M$GETDCB(FPT_GETDCB) ALTRET(ALT);
     3329     5745    1       RETURN;
     3330     5746    1   ALT: ALTRETURN;
     3331     5747    1   END XUG$FINDDCB_COMMON;
     3332     5748        %EOD;

PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:629  
--  Include file information  --

   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$FINDDCB_COMMON.

   Procedure XUG$FINDDCB_COMMON requires 67 words for executable code.
   Procedure XUG$FINDDCB_COMMON requires 18 words of local(AUTO) storage.

PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:630  

 Object Unit name= XUG$FINDDCB_COMMON                         File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:27:05.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      8     10  XUG$FINDDCB_COMMON
    2   Proc  even  none    67    103  XUG$FINDDCB_COMMON
    3  RoData even  none     1      1  XUG$FINDDCB_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  XUG$FINDDCB_COMMON
     2      4          yes     yes      Std        2  XUG$GETDCB_COMMON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$ROS$                                B_VECTNIL
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:631  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:632  


     3289        1        /*T***********************************************************/
     3290        2        /*T*                                                         */
     3291        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3292        4        /*T*                                                         */
     3293        5        /*T***********************************************************/
     3294        6        XUG$FINDDCB_COMMON: PROC(DCBNAME,DCB#) ALTRET;

      6  2 000000   000000 700200 xent  XUG$FINDDCB* TSX0  ! X66_AUTO_2
         2 000001   000022 000002                    ZERO    18,2

     3295        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3296        8    1   DCL 1 DCBNAME,
     3297        9    1         2 L UBIN BYTE UNAL,
     3298       10    1         2 C CHAR(DCBNAME.L);
     3299       11    1   DCL DCB# SBIN;
     3300       12        /**/
     3301       13        %INCLUDE CP_6;
     3302     5572        %INCLUDE B$ROSEG;
     3303     5635    1   DCL B$ROS$ PTR SYMREF;
     3304     5636        %F$DCB;
     3305     5693        /**/
     3306     5694        %FPT_GETDCB (MERGE=YES,STCLASS=CONSTANT,FPTN=FPT_GETDCB_C);
     3307     5709        %FPT_GETDCB (STCLASS=AUTO);
     3308     5724    1   DCL I SBIN;
     3309     5725    1   DCL GET BIT(1) ALIGNED;
     3310     5726        %EJECT;
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:633  
     3311     5727    1       GET='0'B;

   5727  2 000002   200017 450100                    STZ     GET,,AUTO

     3312     5728    1       GOTO FIND;

   5728  2 000003   000010 710000 2                  TRA     FIND

     3313     5729    1   XUG$GETDCB_COMMON: ENTRY(DCBNAME,DCB#) ALTRET;

   5729  2 000004   000000 700200 xent  XUG$GETDCB_* TSX0  ! X66_AUTO_2
         2 000005   000022 000002                    ZERO    18,2

     3314     5730    1       GET='1'B;

   5730  2 000006   400000 236003                    LDQ     -131072,DU
         2 000007   200017 756100                    STQ     GET,,AUTO

     3315     5731    1   FIND:
     3316     5732    2       DO I=1 TO B$ROS$->B$ROSEG.NUMDCBS;

   5732  2 000010   000001 235007       FIND         LDA     1,DL
         2 000011   200016 755100                    STA     I,,AUTO
         2 000012   000044 710000 2                  TRA     s:5739+1

     3317     5733    3           IF DCBADDR(I)~=ADDR(NIL) THEN DO;

   5733  2 000013   000000 470400 3                  LDP0    0
         2 000014   000000 471500                    LDP1    0,,PR0
         2 000015   200016 720100                    LXL0    I,,AUTO
         2 000016   100000 236110                    LDQ     0,X0,PR1
         2 000017   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000020   000043 600000 2                  TZE     s:5739

     3318     5734    4               IF DCBADDR(I)->F$DCB.DCBNAME.N=DCBNAME.C THEN DO;

   5734  2 000021   100000 473510                    LDP3    0,X0,PR1
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:634  
         2 000022   300140 236100                    LDQ     96,,PR3
         2 000023   000033 772000                    QRL     27
         2 000024   000037 376007                    ANQ     31,DL
         2 000025   200003 474500                    LDP4    @DCBNAME,,AUTO
         2 000026   000100 101500                    MRL     fill='000'O
         2 000027   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         2 000030   200020 000002                    ADSC9   GET+1,,AUTO              cn=0,n=2
         2 000031   200020 221100                    LDX1    GET+1,,AUTO
         2 000032   000000 622006                    EAX2    0,QL
         2 000033   040140 106540                    CMPC    fill='040'O
         2 000034   300140 200012                    ADSC9   96,,PR3                  cn=1,n=*X2
         2 000035   400000 200011                    ADSC9   0,,PR4                   cn=1,n=*X1
         2 000036   000043 601000 2                  TNZ     s:5739

     3319     5735    4                   DCB#=I;

   5735  2 000037   200004 475500                    LDP5    @DCB#,,AUTO
         2 000040   200016 235100                    LDA     I,,AUTO
         2 000041   500000 755100                    STA     0,,PR5

     3320     5736    4                   RETURN;

   5736  2 000042   000000 702200 xent               TSX2  ! X66_ARET

     3321     5737    4               END;
     3322     5738    3           END;
     3323     5739    2       END;

   5739  2 000043   200016 054100                    AOS     I,,AUTO
         2 000044   000000 470400 xsym               LDP0    B$ROS$
         2 000045   000002 236100                    LDQ     2,,PR0
         2 000046   000022 772000                    QRL     18
         2 000047   200016 116100                    CMPQ    I,,AUTO
         2 000050   000013 605000 2                  TPL     s:5733

     3324     5740    1       IF NOT GET THEN ALTRETURN;

PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:635  
   5740  2 000051   200017 234100                    SZN     GET,,AUTO
         2 000052   000054 604000 2                  TMI     s:5741

   5740  2 000053   000000 702200 xent               TSX2  ! X66_AALT

     3325     5741    1       FPT_GETDCB = FPT_GETDCB_C;

   5741  2 000054   000100 100400                    MLR     fill='000'O
         2 000055   000000 000040 1                  ADSC9   FPT_GETDCB_C             cn=0,n=32
         2 000056   200006 000040                    ADSC9   FPT_GETDCB,,AUTO         cn=0,n=32

     3326     5742    1       FPT_GETDCB.DCBNAME_=VECTOR(DCBNAME);

   5742  2 000057   200003 471500                    LDP1    @DCBNAME,,AUTO
         2 000060   000100 101500                    MRL     fill='000'O
         2 000061   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 000062   200020 000002                    ADSC9   GET+1,,AUTO              cn=0,n=2
         2 000063   200020 220100                    LDX0    GET+1,,AUTO
         2 000064   000001 621010                    EAX1    1,X0
         2 000065   000000 635011                    EAA     0,X1
         2 000066   000002 771000                    ARL     2
         2 000067   000140 135007                    SBLA    96,DL
         2 000070   200003 236100                    LDQ     @DCBNAME,,AUTO
         2 000071   200010 757100                    STAQ    FPT_GETDCB+2,,AUTO

     3327     5743    1       FPT_GETDCB.DCBNUM_=VECTOR(DCB#);

   5743  2 000072   777640 235007                    LDA     -96,DL
         2 000073   200004 236100                    LDQ     @DCB#,,AUTO
         2 000074   200012 757100                    STAQ    FPT_GETDCB+4,,AUTO

     3328     5744    1       CALL M$GETDCB(FPT_GETDCB) ALTRET(ALT);

   5744  2 000075   200006 630500                    EPPR0   FPT_GETDCB,,AUTO
         2 000076   460002 713400                    CLIMB   alt,+24578
         2 000077   401000 401760                    pmme    nvectors=3
         2 000100   000102 702000 2                  TSX2    ALT
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:636  

     3329     5745    1       RETURN;

   5745  2 000101   000000 702200 xent               TSX2  ! X66_ARET

     3330     5746    1   ALT: ALTRETURN;

   5746  2 000102   000000 702200 xent  ALT          TSX2  ! X66_AALT
     3331     5747    1   END XUG$FINDDCB_COMMON;
     3332     5748        %EOD;

PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:637  
--  Include file information  --

   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$FINDDCB_COMMON.
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:638  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$FINDDCB_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)   r     1 FPT_GETDCB_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DCB#                      3-0-0/w PTR         r     1 @DCBNAME
    *0-0-0/w SBIN        r     1 DCB#                      *0-0-0/c ASTR(9)     r     1 DCBNAME
     6-0-0/d STRC(288)   r     1 FPT_GETDCB                17-0-0/w BIT         r     1 GET
    16-0-0/w SBIN        r     1 I

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$ROS$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(3024)  r     1 B$ROSEG                    0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure XUG$FINDDCB_COMMON requires 67 words for executable code.
   Procedure XUG$FINDDCB_COMMON requires 18 words of local(AUTO) storage.
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:639  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:640  
          MINI XREF LISTING

ALT
      5746**LABEL    5744--CALLALT
B$ROS$
      5635**DCL      5732>>DOINDEX
B$ROSEG.NUMDCBS
      5585**DCL      5732>>DOINDEX
DCB#
        11**DCL         6--PROC     5729--ENTRY    5735<<ASSIGN   5743--ASSIGN
DCBNAME
         8**DCL         6--PROC     5729--ENTRY    5742--ASSIGN
DCBNAME.C
        10**DCL      5734>>IF
DCBNAME.L
         9**DCL        10--IMP-SIZ  5734>>IF       5742>>ASSIGN
F$DCB.ACTPOS
      5669**DCL      5669--REDEF
F$DCB.ARS#
      5643**DCL      5643--REDEF
F$DCB.ATTR
      5662**DCL      5663--REDEF
F$DCB.BORROW
      5677**DCL      5677--REDEF    5677--REDEF    5677--REDEF
F$DCB.DCBNAME.L
      5691**DCL      5691--IMP-SIZ  5734>>IF
F$DCB.DCBNAME.N
      5691**DCL      5734>>IF
F$DCB.EOMCHAR#
      5647**DCL      5647--REDEF
F$DCB.FLDID
      5672**DCL      5672--REDEF
F$DCB.FORM$
      5666**DCL      5666--REDEF
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:641  
F$DCB.FSECT
      5682**DCL      5682--REDEF
F$DCB.FSN#
      5659**DCL      5659--REDEF    5659--REDEF    5660--REDEF
F$DCB.HEADER$
      5665**DCL      5665--REDEF
F$DCB.IXTNSIZE#
      5663**DCL      5663--REDEF
F$DCB.LASTSTA$
      5652**DCL      5652--REDEF
F$DCB.LVL
      5678**DCL      5678--REDEF
F$DCB.NAME#.C
      5653**DCL      5653--REDEF
F$DCB.NOEOF
      5675**DCL      5675--REDEF
F$DCB.NRECS#
      5664**DCL      5664--REDEF
F$DCB.NRECX
      5683**DCL      5683--REDEF
F$DCB.OHDR
      5675**DCL      5675--REDEF
F$DCB.ORG#
      5658**DCL      5658--REDEF
F$DCB.PRECNO
      5681**DCL      5681--REDEF
F$DCB.RCSZ
      5687**DCL      5687--REDEF
F$DCB.RES#
      5654**DCL      5654--REDEF
F$DCB.SETX
      5666**DCL      5666--REDEF
F$DCB.TAB$
      5666**DCL      5666--REDEF
F$DCB.TDA
      5680**DCL      5681--REDEF
PL6.E3A0      #012=XUG$FINDDCB_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:27 Page:642  
F$DCB.WSN#
      5654**DCL      5654--REDEF
FIND
      5732**LABEL    5728--GOTO
FPT_GETDCB
      5720**DCL      5741<<ASSIGN   5744<>CALL
FPT_GETDCB.DCBNAME_
      5720**DCL      5742<<ASSIGN
FPT_GETDCB.DCBNUM_
      5720**DCL      5743<<ASSIGN
FPT_GETDCB_C
      5705**DCL      5741>>ASSIGN
FPT_GETDCB_C.V
      5706**DCL      5705--DCLINIT
GET
      5725**DCL      5727<<ASSIGN   5730<<ASSIGN   5740>>IF
I
      5724**DCL      5732<<DOINDEX  5733--IF       5734--IF       5734--IF       5735>>ASSIGN
M$GETDCB
      5506**DCL-ENT  5744--CALL

PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:643  
     3333        1        /*T***********************************************************/
     3334        2        /*T*                                                         */
     3335        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3336        4        /*T*                                                         */
     3337        5        /*T***********************************************************/
     3338        6        XUG$CLOSE_DCBS_COMMON: PROC(GETCMD) ;
     3339        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3340        8        %INCLUDE CP_6;
     3341     5567        %INCLUDE CP_6_SUBS;
     3342     6107        %FPT_CLOSE (DISP=SAVE,STCLASS=CONSTANT,FPTN=FPT_CLOSE_C);
     3343     6149        %INCLUDE XU_MACRO_C ;
     3344     9255        /**/
     3345     9256        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     3346     9594
     3347     9595        %FPT_CLOSE (STCLASS=AUTO);
     3348     9637        %INCLUDE B$ROSEG;
     3349     9700    1   DCL B$ROS$ PTR SYMREF;
     3350     9701        %F$DCB;
     3351     9758    1   DCL CLOSEALL BIT(1) ;
     3352     9759        /**/
     3353     9760        /* BEGIN PROCEDURE */
     3354     9761        /**/
     3355     9762    1       FPT_CLOSE = FPT_CLOSE_C;
     3356     9763    1       FPT_CLOSE.V_ = VECTOR (FPT_CLOSE.V);
     3357     9764    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)
     3358     9765    1       THEN
     3359     9766    2       DO ;
     3360     9767    2           FPT_CLOSE.V.DCB# = GETCMD.DCB_PARAM# ;
     3361     9768    2           CLOSEALL = '0'B ;
     3362     9769    2           GOTO DO_CLOSE ;
     3363     9770    2       END ;                        /* Then Do */
     3364     9771    1       ELSE
     3365     9772    1           CLOSEALL = '1'B ;
     3366     9773
     3367     9774    2       DO FPT_CLOSE.V.DCB#=%M$1STDCB# TO B$ROS$->B$ROSEG.NUMDCBS;
     3368     9775    2   DO_CLOSE:
     3369     9776    2           IF DCBADDR(FPT_CLOSE.V.DCB#)~=ADDR(NIL) THEN
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:644  
     3370     9777    3               IF DCBADDR(FPT_CLOSE.V.DCB#)->F$DCB.FCD# THEN DO;
     3371     9778    3                   IF GETCMD.DISP# ~= 0
     3372     9779    3                   THEN
     3373     9780    3                       FPT_CLOSE.V.DISP# = GETCMD.DISP#;
     3374     9781    3                   ELSE
     3375     9782    3                       IF DCBADDR(FPT_CLOSE.V.DCB#) -> F$DCB.ORG# = %FPRG#
     3376     9783    3                       THEN
     3377     9784    3                           FPT_CLOSE.V.DISP# = %RELEASE#;
     3378     9785    3                       ELSE
     3379     9786    3                           FPT_CLOSE.V.DISP# = %SAVE#;
     3380     9787    3                   CALL M$CLOSE(FPT_CLOSE) ALTRET(NXT_DCB);
     3381     9788    3               END;
     3382     9789    2           IF CLOSEALL = '0'B
     3383     9790    2           THEN
     3384     9791    2               GOTO DONE ;
     3385     9792    2   NXT_DCB: END;
     3386     9793    1   DONE:
     3387     9794    1       RETURN;
     3388     9795    1   END XUG$CLOSE_DCBS_COMMON;
     3389     9796        %EOD;

PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:645  
--  Include file information  --

   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$CLOSE_DCBS_COMMON.

   Procedure XUG$CLOSE_DCBS_COMMON requires 61 words for executable code.
   Procedure XUG$CLOSE_DCBS_COMMON requires 38 words of local(AUTO) storage.

PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:646  

 Object Unit name= XUG$CLOSE_DCBS_COMMON                      File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:27:26.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     30     36  XUG$CLOSE_DCBS_COMMON
    2   Proc  even  none    61     75  XUG$CLOSE_DCBS_COMMON
    3  RoData even  none     2      2  XUG$CLOSE_DCBS_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  XUG$CLOSE_DCBS_COMMON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$ROS$                                B_VECTNIL
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:647  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:648  


     3333        1        /*T***********************************************************/
     3334        2        /*T*                                                         */
     3335        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3336        4        /*T*                                                         */
     3337        5        /*T***********************************************************/
     3338        6        XUG$CLOSE_DCBS_COMMON: PROC(GETCMD) ;

      6  2 000000   000000 700200 xent  XUG$CLOSE_D* TSX0  ! X66_AUTO_1
         2 000001   000046 000001                    ZERO    38,1

     3339        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3340        8        %INCLUDE CP_6;
     3341     5567        %INCLUDE CP_6_SUBS;
     3342     6107        %FPT_CLOSE (DISP=SAVE,STCLASS=CONSTANT,FPTN=FPT_CLOSE_C);
     3343     6149        %INCLUDE XU_MACRO_C ;
     3344     9255        /**/
     3345     9256        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     3346     9594
     3347     9595        %FPT_CLOSE (STCLASS=AUTO);
     3348     9637        %INCLUDE B$ROSEG;
     3349     9700    1   DCL B$ROS$ PTR SYMREF;
     3350     9701        %F$DCB;
     3351     9758    1   DCL CLOSEALL BIT(1) ;
     3352     9759        /**/
     3353     9760        /* BEGIN PROCEDURE */
     3354     9761        /**/
     3355     9762    1       FPT_CLOSE = FPT_CLOSE_C;

   9762  2 000002   000100 100400                    MLR     fill='000'O
         2 000003   000000 000170 1                  ADSC9   FPT_CLOSE_C              cn=0,n=120
         2 000004   200004 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

     3356     9763    1       FPT_CLOSE.V_ = VECTOR (FPT_CLOSE.V);

   9763  2 000005   000000 235000 3                  LDA     0
         2 000006   200044 452500                    STP2    CLOSEALL+2,,AUTO
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:649  
         2 000007   200044 236100                    LDQ     CLOSEALL+2,,AUTO
         2 000010   000036 036003                    ADLQ    30,DU
         2 000011   200004 757100                    STAQ    FPT_CLOSE,,AUTO

     3357     9764    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)

   9764  2 000012   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000013   000014 235100                    LDA     12,,PR0
         2 000014   000021 600000 2                  TZE     s:9772

     3358     9765    1       THEN
     3359     9766    2       DO ;

     3360     9767    2           FPT_CLOSE.V.DCB# = GETCMD.DCB_PARAM# ;

   9767  2 000015   000014 720100                    LXL0    12,,PR0
         2 000016   200036 740100                    STX0    FPT_CLOSE+26,,AUTO

     3361     9768    2           CLOSEALL = '0'B ;

   9768  2 000017   200042 450100                    STZ     CLOSEALL,,AUTO

     3362     9769    2           GOTO DO_CLOSE ;

   9769  2 000020   000026 710000 2                  TRA     DO_CLOSE

     3363     9770    2       END ;                        /* Then Do */
     3364     9771    1       ELSE
     3365     9772    1           CLOSEALL = '1'B ;

   9772  2 000021   400000 236003                    LDQ     -131072,DU
         2 000022   200042 756100                    STQ     CLOSEALL,,AUTO

     3366     9773
     3367     9774    2       DO FPT_CLOSE.V.DCB#=%M$1STDCB# TO B$ROS$->B$ROSEG.NUMDCBS;

   9774  2 000023   000012 220003                    LDX0    10,DU
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:650  
         2 000024   200036 740100                    STX0    FPT_CLOSE+26,,AUTO
         2 000025   000070 710000 2                  TRA     NXT_DCB+3

     3368     9775    2   DO_CLOSE:
     3369     9776    2           IF DCBADDR(FPT_CLOSE.V.DCB#)~=ADDR(NIL) THEN

   9776  2 000026   000001 470400 3     DO_CLOSE     LDP0    1
         2 000027   000000 471500                    LDP1    0,,PR0
         2 000030   200036 220100                    LDX0    FPT_CLOSE+26,,AUTO
         2 000031   100000 236110                    LDQ     0,X0,PR1
         2 000032   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000033   000063 600000 2                  TZE     s:9789

     3370     9777    3               IF DCBADDR(FPT_CLOSE.V.DCB#)->F$DCB.FCD# THEN DO;

   9777  2 000034   100000 473510                    LDP3    0,X0,PR1
         2 000035   300031 236100                    LDQ     25,,PR3
         2 000036   020000 316007                    CANQ    8192,DL
         2 000037   000063 600000 2                  TZE     s:9789

     3371     9778    3                   IF GETCMD.DISP# ~= 0

   9778  2 000040   200003 474500                    LDP4    @GETCMD,,AUTO
         2 000041   400016 235100                    LDA     14,,PR4
         2 000042   000046 600000 2                  TZE     s:9782

     3372     9779    3                   THEN
     3373     9780    3                       FPT_CLOSE.V.DISP# = GETCMD.DISP#;

   9780  2 000043   400016 236100                    LDQ     14,,PR4
         2 000044   200036 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO
         2 000045   000057 710000 2                  TRA     s:9787

     3374     9781    3                   ELSE
     3375     9782    3                       IF DCBADDR(FPT_CLOSE.V.DCB#) -> F$DCB.ORG# = %FPRG#

   9782  2 000046   300032 236100                    LDQ     26,,PR3
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:651  
         2 000047   777000 376003                    ANQ     -512,DU
         2 000050   012000 116003                    CMPQ    5120,DU
         2 000051   000055 601000 2                  TNZ     s:9786

     3376     9783    3                       THEN
     3377     9784    3                           FPT_CLOSE.V.DISP# = %RELEASE#;

   9784  2 000052   000001 236007                    LDQ     1,DL
         2 000053   200036 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO
         2 000054   000057 710000 2                  TRA     s:9787

     3378     9785    3                       ELSE
     3379     9786    3                           FPT_CLOSE.V.DISP# = %SAVE#;

   9786  2 000055   000002 236007                    LDQ     2,DL
         2 000056   200036 552104                    STBQ    FPT_CLOSE+26,'04'O,AUTO

     3380     9787    3                   CALL M$CLOSE(FPT_CLOSE) ALTRET(NXT_DCB);

   9787  2 000057   200004 630500                    EPPR0   FPT_CLOSE,,AUTO
         2 000060   450001 713400                    CLIMB   alt,close
         2 000061   406000 401760                    pmme    nvectors=13
         2 000062   000065 702000 2                  TSX2    NXT_DCB

     3381     9788    3               END;

     3382     9789    2           IF CLOSEALL = '0'B

   9789  2 000063   200042 234100                    SZN     CLOSEALL,,AUTO
         2 000064   000074 605000 2                  TPL     DONE

     3383     9790    2           THEN
     3384     9791    2               GOTO DONE ;
     3385     9792    2   NXT_DCB: END;

   9792  2 000065   200036 220100       NXT_DCB      LDX0    FPT_CLOSE+26,,AUTO
         2 000066   000001 621010                    EAX1    1,X0
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:652  
         2 000067   200036 741100                    STX1    FPT_CLOSE+26,,AUTO
         2 000070   000000 470400 xsym               LDP0    B$ROS$
         2 000071   000002 220100                    LDX0    2,,PR0
         2 000072   200036 100100                    CMPX0   FPT_CLOSE+26,,AUTO
         2 000073   000026 603000 2                  TRC     DO_CLOSE

     3386     9793    1   DONE:
     3387     9794    1       RETURN;

   9794  2 000074   000000 702200 xent  DONE         TSX2  ! X66_ARET
     3388     9795    1   END XUG$CLOSE_DCBS_COMMON;
     3389     9796        %EOD;

PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:653  
--  Include file information  --

   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$CLOSE_DCBS_COMMON.
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:654  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$CLOSE_DCBS_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(1080)  r     1 FPT_CLOSE_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GETCMD                   42-0-0/b BIT         r     1 CLOSEALL
     4-0-0/d STRC(1080)  r     1 FPT_CLOSE                 *0-0-0/d STRC(1512)  r     1 GETCMD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$ROS$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(3024)  r     1 B$ROSEG                    0-0-0/d ASTR(3528)  r     1 F$DCB


   Procedure XUG$CLOSE_DCBS_COMMON requires 61 words for executable code.
   Procedure XUG$CLOSE_DCBS_COMMON requires 38 words of local(AUTO) storage.
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:655  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:656  
          MINI XREF LISTING

B$ROS$
      9700**DCL      9774>>DOINDEX
B$ROSEG.NUMDCBS
      9650**DCL      9774>>DOINDEX
CLOSEALL
      9758**DCL      9768<<ASSIGN   9772<<ASSIGN   9789>>IF
DONE
      9794**LABEL    9791--GOTO
DO_CLOSE
      9776**LABEL    9769--GOTO
F$DCB.ACTPOS
      9734**DCL      9734--REDEF
F$DCB.ARS#
      9708**DCL      9708--REDEF
F$DCB.ATTR
      9727**DCL      9728--REDEF
F$DCB.BORROW
      9742**DCL      9742--REDEF    9742--REDEF    9742--REDEF
F$DCB.DCBNAME.L
      9756**DCL      9756--IMP-SIZ
F$DCB.EOMCHAR#
      9712**DCL      9712--REDEF
F$DCB.FCD#
      9721**DCL      9777>>IF
F$DCB.FLDID
      9737**DCL      9737--REDEF
F$DCB.FORM$
      9731**DCL      9731--REDEF
F$DCB.FSECT
      9747**DCL      9747--REDEF
F$DCB.FSN#
      9724**DCL      9724--REDEF    9724--REDEF    9725--REDEF
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:657  
F$DCB.HEADER$
      9730**DCL      9730--REDEF
F$DCB.IXTNSIZE#
      9728**DCL      9728--REDEF
F$DCB.LASTSTA$
      9717**DCL      9717--REDEF
F$DCB.LVL
      9743**DCL      9743--REDEF
F$DCB.NAME#.C
      9718**DCL      9718--REDEF
F$DCB.NOEOF
      9740**DCL      9740--REDEF
F$DCB.NRECS#
      9729**DCL      9729--REDEF
F$DCB.NRECX
      9748**DCL      9748--REDEF
F$DCB.OHDR
      9740**DCL      9740--REDEF
F$DCB.ORG#
      9723**DCL      9723--REDEF    9782>>IF
F$DCB.PRECNO
      9746**DCL      9746--REDEF
F$DCB.RCSZ
      9752**DCL      9752--REDEF
F$DCB.RES#
      9719**DCL      9719--REDEF
F$DCB.SETX
      9731**DCL      9731--REDEF
F$DCB.TAB$
      9731**DCL      9731--REDEF
F$DCB.TDA
      9745**DCL      9746--REDEF
F$DCB.WSN#
      9719**DCL      9719--REDEF
FPT_CLOSE
      9618**DCL      9762<<ASSIGN   9787<>CALL
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:658  
FPT_CLOSE.SN_
      9618**DCL      9618--REDEF
FPT_CLOSE.UTL_
      9619**DCL      9619--REDEF
FPT_CLOSE.V
      9623**DCL      9763--ASSIGN
FPT_CLOSE.V.DCB#
      9624**DCL      9767<<ASSIGN   9774<<DOINDEX  9776--IF       9777--IF       9782--IF
FPT_CLOSE.V.DISP#
      9627**DCL      9780<<ASSIGN   9784<<ASSIGN   9786<<ASSIGN
FPT_CLOSE.V.EXPIRE#
      9633**DCL      9633--REDEF
FPT_CLOSE.V.TYPE#
      9631**DCL      9631--REDEF
FPT_CLOSE.V.XTNSIZE#
      9628**DCL      9628--REDEF    9630--REDEF
FPT_CLOSE.V_
      9618**DCL      9763<<ASSIGN
FPT_CLOSE_C
      6130**DCL      9762>>ASSIGN
FPT_CLOSE_C.SN_
      6130**DCL      6130--REDEF
FPT_CLOSE_C.UTL_
      6131**DCL      6131--REDEF
FPT_CLOSE_C.V
      6135**DCL      6130--DCLINIT
FPT_CLOSE_C.V.EXPIRE#
      6145**DCL      6145--REDEF
FPT_CLOSE_C.V.TYPE#
      6143**DCL      6143--REDEF
FPT_CLOSE_C.V.XTNSIZE#
      6140**DCL      6140--REDEF    6142--REDEF
GETCMD
      9269**DCL         6--PROC
GETCMD.DCB_PARAM#
      9449**DCL      9764>>IF       9767>>ASSIGN
PL6.E3A0      #013=XUG$CLOSE_DCBS_COMMON File=XUG$COMMON.:E05TSI                 WED 07/30/97 09:27 Page:659  
GETCMD.DISP#
      9460**DCL      9778>>IF       9780>>ASSIGN
GETCMD.OUT$
      9274**DCL      9280--REDEF
M$CLOSE
      5495**DCL-ENT  9787--CALL
NXT_DCB
      9792**LABEL    9787--CALLALT

PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:660  
     3390        1        /*T***********************************************************/
     3391        2        /*T*                                                         */
     3392        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3393        4        /*T*                                                         */
     3394        5        /*T***********************************************************/
     3395        6        /*P*  NAME:       XUG$ERRCNVRT_COMMON
     3396        7              PURPOSE:    Convert LCP-6 error code to CP-6 equivalent
     3397        8        */
     3398        9
     3399       10        XUG$ERRCNVRT_COMMON: PROC (LCP6_ERR, CP6_ERR);
     3400       11        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3401       12
     3402       13    1   DCL 1 LCP6_ERR ALIGNED,
     3403       14    1         2 F1,
     3404       15    1           3 * BIT (1),
     3405       16    1           3 PART1 BIT (5),
     3406       17    1         2 F2,
     3407       18    1           3 PART1 BIT (3),
     3408       19    1           3 * BIT (1),
     3409       20    1           3 PART2 BIT (2),
     3410       21    1         2 MID BIT (5),
     3411       22    1         2 M BIT (1),
     3412       23    1         2 * BIT (1),
     3413       24    1         2 ERR#,
     3414       25    1           3 PART1 BIT (8),
     3415       26    1           3 * BIT (1),
     3416       27    1           3 PART2 BIT (5),
     3417       28    1         2 SEV BIT (3);
     3418       29
     3419       30    1   DCL 1 CP6_ERR ALIGNED,
     3420       31    1         2 F1,
     3421       32    1           3 * BIT (1),
     3422       33    1           3 PART1 BIT (5),
     3423       34    1         2 F2,
     3424       35    1           3 * BIT (1),
     3425       36    1           3 PART1 BIT (3),
     3426       37    1           3 PART2 BIT (2),
PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:661  
     3427       38    1         2 MID,
     3428       39    1           3 * BIT (1),
     3429       40    1           3 PART1 BIT (5),
     3430       41    1         2 M BIT (1),
     3431       42    1         2 ERR#,
     3432       43    1           3 * BIT (1),
     3433       44    1           3 PART1 BIT (8),
     3434       45    1           3 PART2 BIT (5),
     3435       46    1         2 SEV BIT (3);
     3436       47
     3437       48    1       CP6_ERR = '0'B;
     3438       49
     3439       50    1       CP6_ERR.F1.PART1 = LCP6_ERR.F1.PART1;
     3440       51    1       CP6_ERR.F2.PART1 = LCP6_ERR.F2.PART1;
     3441       52    1       CP6_ERR.F2.PART2 = LCP6_ERR.F2.PART2;
     3442       53    1       CP6_ERR.MID.PART1 = LCP6_ERR.MID;
     3443       54    1       CP6_ERR.M    = LCP6_ERR.M;
     3444       55    1       CP6_ERR.ERR#.PART1 = LCP6_ERR.ERR#.PART1;
     3445       56    1       CP6_ERR.ERR#.PART2 = LCP6_ERR.ERR#.PART2;
     3446       57    1       CP6_ERR.SEV  = LCP6_ERR.SEV;
     3447       58
     3448       59    1       RETURN;
     3449       60
     3450       61    1   END XUG$ERRCNVRT_COMMON;
     3451       62        %EOD;

PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:662  
      No diagnostics issued in procedure XUG$ERRCNVRT_COMMON.

   Procedure XUG$ERRCNVRT_COMMON requires 42 words for executable code.
   Procedure XUG$ERRCNVRT_COMMON requires 6 words of local(AUTO) storage.

PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:663  

 Object Unit name= XUG$ERRCNVRT_COMMON                        File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:27:57.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    42     52  XUG$ERRCNVRT_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  XUG$ERRCNVRT_COMMON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:664  


     3390        1        /*T***********************************************************/
     3391        2        /*T*                                                         */
     3392        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3393        4        /*T*                                                         */
     3394        5        /*T***********************************************************/
     3395        6        /*P*  NAME:       XUG$ERRCNVRT_COMMON
     3396        7              PURPOSE:    Convert LCP-6 error code to CP-6 equivalent
     3397        8        */
     3398        9
     3399       10        XUG$ERRCNVRT_COMMON: PROC (LCP6_ERR, CP6_ERR);

     10  0 000000   000000 700200 xent  XUG$ERRCNVR* TSX0  ! X66_AUTO_2
         0 000001   000006 000002                    ZERO    6,2

     3400       11        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3401       12
     3402       13    1   DCL 1 LCP6_ERR ALIGNED,
     3403       14    1         2 F1,
     3404       15    1           3 * BIT (1),
     3405       16    1           3 PART1 BIT (5),
     3406       17    1         2 F2,
     3407       18    1           3 PART1 BIT (3),
     3408       19    1           3 * BIT (1),
     3409       20    1           3 PART2 BIT (2),
     3410       21    1         2 MID BIT (5),
     3411       22    1         2 M BIT (1),
     3412       23    1         2 * BIT (1),
     3413       24    1         2 ERR#,
     3414       25    1           3 PART1 BIT (8),
     3415       26    1           3 * BIT (1),
     3416       27    1           3 PART2 BIT (5),
     3417       28    1         2 SEV BIT (3);
     3418       29
     3419       30    1   DCL 1 CP6_ERR ALIGNED,
     3420       31    1         2 F1,
     3421       32    1           3 * BIT (1),
PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:665  
     3422       33    1           3 PART1 BIT (5),
     3423       34    1         2 F2,
     3424       35    1           3 * BIT (1),
     3425       36    1           3 PART1 BIT (3),
     3426       37    1           3 PART2 BIT (2),
     3427       38    1         2 MID,
     3428       39    1           3 * BIT (1),
     3429       40    1           3 PART1 BIT (5),
     3430       41    1         2 M BIT (1),
     3431       42    1         2 ERR#,
     3432       43    1           3 * BIT (1),
     3433       44    1           3 PART1 BIT (8),
     3434       45    1           3 PART2 BIT (5),
     3435       46    1         2 SEV BIT (3);
     3436       47
     3437       48    1       CP6_ERR = '0'B;

     48  0 000002   200004 470500                    LDP0    @CP6_ERR,,AUTO
         0 000003   000000 450100                    STZ     0,,PR0

     3438       49
     3439       50    1       CP6_ERR.F1.PART1 = LCP6_ERR.F1.PART1;

     50  0 000004   200003 471500                    LDP1    @LCP6_ERR,,AUTO
         0 000005   100000 236100                    LDQ     0,,PR1
         0 000006   000000 676100                    ERQ     0,,PR0
         0 000007   370000 376003                    ANQ     126976,DU
         0 000010   000000 656100                    ERSQ    0,,PR0

     3440       51    1       CP6_ERR.F2.PART1 = LCP6_ERR.F2.PART1;

     51  0 000011   100000 236100                    LDQ     0,,PR1
         0 000012   000001 772000                    QRL     1
         0 000013   000000 676100                    ERQ     0,,PR0
         0 000014   003400 376003                    ANQ     1792,DU
         0 000015   000000 656100                    ERSQ    0,,PR0

PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:666  
     3441       52    1       CP6_ERR.F2.PART2 = LCP6_ERR.F2.PART2;

     52  0 000016   100000 236100                    LDQ     0,,PR1
         0 000017   000000 676100                    ERQ     0,,PR0
         0 000020   000300 376003                    ANQ     192,DU
         0 000021   000000 656100                    ERSQ    0,,PR0

     3442       53    1       CP6_ERR.MID.PART1 = LCP6_ERR.MID;

     53  0 000022   100000 236100                    LDQ     0,,PR1
         0 000023   000001 772000                    QRL     1
         0 000024   000000 676100                    ERQ     0,,PR0
         0 000025   000037 376003                    ANQ     31,DU
         0 000026   000000 656100                    ERSQ    0,,PR0

     3443       54    1       CP6_ERR.M    = LCP6_ERR.M;

     54  0 000027   100000 236100                    LDQ     0,,PR1
         0 000030   000001 772000                    QRL     1
         0 000031   000000 676100                    ERQ     0,,PR0
         0 000032   400000 376007                    ANQ     -131072,DL
         0 000033   000000 656100                    ERSQ    0,,PR0

     3444       55    1       CP6_ERR.ERR#.PART1 = LCP6_ERR.ERR#.PART1;

     55  0 000034   100000 236100                    LDQ     0,,PR1
         0 000035   000001 772000                    QRL     1
         0 000036   000000 676100                    ERQ     0,,PR0
         0 000037   177400 376007                    ANQ     65280,DL
         0 000040   000000 656100                    ERSQ    0,,PR0

     3445       56    1       CP6_ERR.ERR#.PART2 = LCP6_ERR.ERR#.PART2;

     56  0 000041   100000 236100                    LDQ     0,,PR1
         0 000042   000000 676100                    ERQ     0,,PR0
         0 000043   000370 376007                    ANQ     248,DL
         0 000044   000000 656100                    ERSQ    0,,PR0
PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:667  

     3446       57    1       CP6_ERR.SEV  = LCP6_ERR.SEV;

     57  0 000045   100000 236100                    LDQ     0,,PR1
         0 000046   000000 676100                    ERQ     0,,PR0
         0 000047   000007 376007                    ANQ     7,DL
         0 000050   000000 656100                    ERSQ    0,,PR0

     3447       58
     3448       59    1       RETURN;

     59  0 000051   000000 702200 xent               TSX2  ! X66_ARET
     3449       60
     3450       61    1   END XUG$ERRCNVRT_COMMON;
     3451       62        %EOD;

PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:668  
      No diagnostics issued in procedure XUG$ERRCNVRT_COMMON.
PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:669  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CP6_ERR                   3-0-0/w PTR         r     1 @LCP6_ERR
    *0-0-0/w STRC        r     1 CP6_ERR                   *0-0-0/w STRC        r     1 LCP6_ERR


   Procedure XUG$ERRCNVRT_COMMON requires 42 words for executable code.
   Procedure XUG$ERRCNVRT_COMMON requires 6 words of local(AUTO) storage.
PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:670  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:671  
          MINI XREF LISTING

CP6_ERR
        30**DCL        10--PROC       48<<ASSIGN
CP6_ERR.ERR#.PART1
        44**DCL        55<<ASSIGN
CP6_ERR.ERR#.PART2
        45**DCL        56<<ASSIGN
CP6_ERR.F1.PART1
        33**DCL        50<<ASSIGN
CP6_ERR.F2.PART1
        36**DCL        51<<ASSIGN
CP6_ERR.F2.PART2
        37**DCL        52<<ASSIGN
CP6_ERR.M
        41**DCL        54<<ASSIGN
CP6_ERR.MID.PART1
        40**DCL        53<<ASSIGN
CP6_ERR.SEV
        46**DCL        57<<ASSIGN
LCP6_ERR
        13**DCL        10--PROC
LCP6_ERR.ERR#.PART1
        25**DCL        55>>ASSIGN
LCP6_ERR.ERR#.PART2
        27**DCL        56>>ASSIGN
LCP6_ERR.F1.PART1
        16**DCL        50>>ASSIGN
LCP6_ERR.F2.PART1
        18**DCL        51>>ASSIGN
LCP6_ERR.F2.PART2
        20**DCL        52>>ASSIGN
LCP6_ERR.M
        22**DCL        54>>ASSIGN
PL6.E3A0      #014=XUG$ERRCNVRT_COMMON File=XUG$COMMON.:E05TSI                   WED 07/30/97 09:27 Page:672  
LCP6_ERR.MID
        21**DCL        53>>ASSIGN
LCP6_ERR.SEV
        28**DCL        57>>ASSIGN

PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:673  
     3452        1        /*T***********************************************************/
     3453        2        /*T*                                                         */
     3454        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3455        4        /*T*                                                         */
     3456        5        /*T***********************************************************/
     3457        6        /*P*  NAME:       XUG$ERRTOLCP6_COMMON
     3458        7              PURPOSE:    Convert CP-6 error code to LCP-6 equivalent
     3459        8        */
     3460        9
     3461       10        XUG$ERRTOLCP6_COMMON: PROC (LCP6_ERR, CP6_ERR);
     3462       11        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3463       12
     3464       13    1   DCL 1 LCP6_ERR ALIGNED,
     3465       14    1         2 F1,
     3466       15    1           3 * BIT (1),
     3467       16    1           3 PART1 BIT (5),
     3468       17    1         2 F2,
     3469       18    1           3 PART1 BIT (3),
     3470       19    1           3 * BIT (1),
     3471       20    1           3 PART2 BIT (2),
     3472       21    1         2 MID BIT (5),
     3473       22    1         2 M BIT (1),
     3474       23    1         2 * BIT (1),
     3475       24    1         2 ERR#,
     3476       25    1           3 PART1 BIT (8),
     3477       26    1           3 * BIT (1),
     3478       27    1           3 PART2 BIT (5),
     3479       28    1         2 SEV BIT (3);
     3480       29
     3481       30    1   DCL 1 CP6_ERR ALIGNED,
     3482       31    1         2 F1,
     3483       32    1           3 * BIT (1),
     3484       33    1           3 PART1 BIT (5),
     3485       34    1         2 F2,
     3486       35    1           3 * BIT (1),
     3487       36    1           3 PART1 BIT (3),
     3488       37    1           3 PART2 BIT (2),
PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:674  
     3489       38    1         2 MID,
     3490       39    1           3 * BIT (1),
     3491       40    1           3 PART1 BIT (5),
     3492       41    1         2 M BIT (1),
     3493       42    1         2 ERR#,
     3494       43    1           3 * BIT (1),
     3495       44    1           3 PART1 BIT (8),
     3496       45    1           3 PART2 BIT (5),
     3497       46    1         2 SEV BIT (3);
     3498       47
     3499       48    1       LCP6_ERR = '0'B;
     3500       49
     3501       50    1       LCP6_ERR.F1.PART1 = CP6_ERR.F1.PART1;
     3502       51    1       LCP6_ERR.F2.PART1 = CP6_ERR.F2.PART1;
     3503       52    1       LCP6_ERR.F2.PART2 = CP6_ERR.F2.PART2;
     3504       53    1       LCP6_ERR.MID  = CP6_ERR.MID.PART1;
     3505       54    1       LCP6_ERR.M    = CP6_ERR.M;
     3506       55    1       LCP6_ERR.ERR#.PART1 = CP6_ERR.ERR#.PART1;
     3507       56    1       LCP6_ERR.ERR#.PART2 = CP6_ERR.ERR#.PART2;
     3508       57    1       LCP6_ERR.SEV  = CP6_ERR.SEV;
     3509       58
     3510       59    1       RETURN;
     3511       60
     3512       61    1   END XUG$ERRTOLCP6_COMMON;
     3513       62        %EOD;

PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:675  
      No diagnostics issued in procedure XUG$ERRTOLCP6_COMMON.

   Procedure XUG$ERRTOLCP6_COMMON requires 42 words for executable code.
   Procedure XUG$ERRTOLCP6_COMMON requires 6 words of local(AUTO) storage.

PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:676  

 Object Unit name= XUG$ERRTOLCP6_COMMON                       File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:28:00.60 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    42     52  XUG$ERRTOLCP6_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  XUG$ERRTOLCP6_COMMON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:677  


     3452        1        /*T***********************************************************/
     3453        2        /*T*                                                         */
     3454        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3455        4        /*T*                                                         */
     3456        5        /*T***********************************************************/
     3457        6        /*P*  NAME:       XUG$ERRTOLCP6_COMMON
     3458        7              PURPOSE:    Convert CP-6 error code to LCP-6 equivalent
     3459        8        */
     3460        9
     3461       10        XUG$ERRTOLCP6_COMMON: PROC (LCP6_ERR, CP6_ERR);

     10  0 000000   000000 700200 xent  XUG$ERRTOLC* TSX0  ! X66_AUTO_2
         0 000001   000006 000002                    ZERO    6,2

     3462       11        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3463       12
     3464       13    1   DCL 1 LCP6_ERR ALIGNED,
     3465       14    1         2 F1,
     3466       15    1           3 * BIT (1),
     3467       16    1           3 PART1 BIT (5),
     3468       17    1         2 F2,
     3469       18    1           3 PART1 BIT (3),
     3470       19    1           3 * BIT (1),
     3471       20    1           3 PART2 BIT (2),
     3472       21    1         2 MID BIT (5),
     3473       22    1         2 M BIT (1),
     3474       23    1         2 * BIT (1),
     3475       24    1         2 ERR#,
     3476       25    1           3 PART1 BIT (8),
     3477       26    1           3 * BIT (1),
     3478       27    1           3 PART2 BIT (5),
     3479       28    1         2 SEV BIT (3);
     3480       29
     3481       30    1   DCL 1 CP6_ERR ALIGNED,
     3482       31    1         2 F1,
     3483       32    1           3 * BIT (1),
PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:678  
     3484       33    1           3 PART1 BIT (5),
     3485       34    1         2 F2,
     3486       35    1           3 * BIT (1),
     3487       36    1           3 PART1 BIT (3),
     3488       37    1           3 PART2 BIT (2),
     3489       38    1         2 MID,
     3490       39    1           3 * BIT (1),
     3491       40    1           3 PART1 BIT (5),
     3492       41    1         2 M BIT (1),
     3493       42    1         2 ERR#,
     3494       43    1           3 * BIT (1),
     3495       44    1           3 PART1 BIT (8),
     3496       45    1           3 PART2 BIT (5),
     3497       46    1         2 SEV BIT (3);
     3498       47
     3499       48    1       LCP6_ERR = '0'B;

     48  0 000002   200003 470500                    LDP0    @LCP6_ERR,,AUTO
         0 000003   000000 450100                    STZ     0,,PR0

     3500       49
     3501       50    1       LCP6_ERR.F1.PART1 = CP6_ERR.F1.PART1;

     50  0 000004   200004 471500                    LDP1    @CP6_ERR,,AUTO
         0 000005   100000 236100                    LDQ     0,,PR1
         0 000006   000000 676100                    ERQ     0,,PR0
         0 000007   370000 376003                    ANQ     126976,DU
         0 000010   000000 656100                    ERSQ    0,,PR0

     3502       51    1       LCP6_ERR.F2.PART1 = CP6_ERR.F2.PART1;

     51  0 000011   100000 236100                    LDQ     0,,PR1
         0 000012   000001 736000                    QLS     1
         0 000013   000000 676100                    ERQ     0,,PR0
         0 000014   007000 376003                    ANQ     3584,DU
         0 000015   000000 656100                    ERSQ    0,,PR0

PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:679  
     3503       52    1       LCP6_ERR.F2.PART2 = CP6_ERR.F2.PART2;

     52  0 000016   100000 236100                    LDQ     0,,PR1
         0 000017   000000 676100                    ERQ     0,,PR0
         0 000020   000300 376003                    ANQ     192,DU
         0 000021   000000 656100                    ERSQ    0,,PR0

     3504       53    1       LCP6_ERR.MID  = CP6_ERR.MID.PART1;

     53  0 000022   100000 236100                    LDQ     0,,PR1
         0 000023   000001 736000                    QLS     1
         0 000024   000000 676100                    ERQ     0,,PR0
         0 000025   000076 376003                    ANQ     62,DU
         0 000026   000000 656100                    ERSQ    0,,PR0

     3505       54    1       LCP6_ERR.M    = CP6_ERR.M;

     54  0 000027   100000 236100                    LDQ     0,,PR1
         0 000030   000001 736000                    QLS     1
         0 000031   000000 676100                    ERQ     0,,PR0
         0 000032   000001 376003                    ANQ     1,DU
         0 000033   000000 656100                    ERSQ    0,,PR0

     3506       55    1       LCP6_ERR.ERR#.PART1 = CP6_ERR.ERR#.PART1;

     55  0 000034   100000 236100                    LDQ     0,,PR1
         0 000035   000001 736000                    QLS     1
         0 000036   000000 676100                    ERQ     0,,PR0
         0 000037   377000 376007                    ANQ     130560,DL
         0 000040   000000 656100                    ERSQ    0,,PR0

     3507       56    1       LCP6_ERR.ERR#.PART2 = CP6_ERR.ERR#.PART2;

     56  0 000041   100000 236100                    LDQ     0,,PR1
         0 000042   000000 676100                    ERQ     0,,PR0
         0 000043   000370 376007                    ANQ     248,DL
         0 000044   000000 656100                    ERSQ    0,,PR0
PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:680  

     3508       57    1       LCP6_ERR.SEV  = CP6_ERR.SEV;

     57  0 000045   100000 236100                    LDQ     0,,PR1
         0 000046   000000 676100                    ERQ     0,,PR0
         0 000047   000007 376007                    ANQ     7,DL
         0 000050   000000 656100                    ERSQ    0,,PR0

     3509       58
     3510       59    1       RETURN;

     59  0 000051   000000 702200 xent               TSX2  ! X66_ARET
     3511       60
     3512       61    1   END XUG$ERRTOLCP6_COMMON;
     3513       62        %EOD;

PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:681  
      No diagnostics issued in procedure XUG$ERRTOLCP6_COMMON.
PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:682  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CP6_ERR                   3-0-0/w PTR         r     1 @LCP6_ERR
    *0-0-0/w STRC        r     1 CP6_ERR                   *0-0-0/w STRC        r     1 LCP6_ERR


   Procedure XUG$ERRTOLCP6_COMMON requires 42 words for executable code.
   Procedure XUG$ERRTOLCP6_COMMON requires 6 words of local(AUTO) storage.
PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:683  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:684  
          MINI XREF LISTING

CP6_ERR
        30**DCL        10--PROC
CP6_ERR.ERR#.PART1
        44**DCL        55>>ASSIGN
CP6_ERR.ERR#.PART2
        45**DCL        56>>ASSIGN
CP6_ERR.F1.PART1
        33**DCL        50>>ASSIGN
CP6_ERR.F2.PART1
        36**DCL        51>>ASSIGN
CP6_ERR.F2.PART2
        37**DCL        52>>ASSIGN
CP6_ERR.M
        41**DCL        54>>ASSIGN
CP6_ERR.MID.PART1
        40**DCL        53>>ASSIGN
CP6_ERR.SEV
        46**DCL        57>>ASSIGN
LCP6_ERR
        13**DCL        10--PROC       48<<ASSIGN
LCP6_ERR.ERR#.PART1
        25**DCL        55<<ASSIGN
LCP6_ERR.ERR#.PART2
        27**DCL        56<<ASSIGN
LCP6_ERR.F1.PART1
        16**DCL        50<<ASSIGN
LCP6_ERR.F2.PART1
        18**DCL        51<<ASSIGN
LCP6_ERR.F2.PART2
        20**DCL        52<<ASSIGN
LCP6_ERR.M
        22**DCL        54<<ASSIGN
PL6.E3A0      #015=XUG$ERRTOLCP6_COMMON File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:28 Page:685  
LCP6_ERR.MID
        21**DCL        53<<ASSIGN
LCP6_ERR.SEV
        28**DCL        57<<ASSIGN

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:686  
     3514        1        /*T***********************************************************/
     3515        2        /*T*                                                         */
     3516        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3517        4        /*T*                                                         */
     3518        5        /*T***********************************************************/
     3519        6        /* XUG$BUILTIN_COMMON   Routine to handle the BUILTIN commands.              */
     3520        7        XUG$BUILTIN_COMMON: PROC(GETCMD) ALTRET;
     3521        8        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3522        9
     3523       10    1   DCL 1 ERR AUTO,
     3524       11    1         2 FCG BIT(12),
     3525       12    1         2 MID BIT(6),
     3526       13    1         2 MON BIT(1),
     3527       14    1         2 CODE UBIN(14) UNAL,
     3528       15    1         2 SEV UBIN(3) UNAL;
     3529       16
     3530       17        %INCLUDE XU_MACRO_C ;
     3531     3123        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     3532     3461        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:687  
     3533     3462        %INCLUDE XU_SUBS_C ;
     3534     3554        %INCLUDE XU_PERR_C ;
     3535     3745        %INCLUDE XUH_MACRO_C ;
     3536     3829        %INCLUDE XT_MACRO_M;
     3537     4155        %INCLUDE XT_PERR_E ;
     3538     4216        %INCLUDE CP_6 ;
     3539     9775        %INCLUDE CP_6_SUBS ;
     3540    10315        %INCLUDE B$JIT ;
     3541    10918
     3542    10919    1   DCL XUG$MOREMSG_COMMON ENTRY(1) ALTRET ;
     3543    10920    1   DCL XUG$ALLMSG_COMMON ENTRY(1) ALTRET ;
     3544    10921    1   DCL XUG$HELP_COMMON ENTRY(1) ALTRET ;
     3545    10922    1   DCL XUG$ERRMSG_COMMON ENTRY(1) ALTRET ;
     3546    10923    1   DCL XUG$FINDDCB_COMMON ENTRY(2) ALTRET ;
     3547    10924    1   DCL XUG$OPENOUT_COMMON ENTRY (1) ALTRET;
     3548    10925    1   DCL XUG$SINPUT ENTRY(1) ALTRET;
     3549    10926    1   DCL XUG$ADAPTMEM ENTRY(1) ALTRET;
     3550    10927
     3551    10928    1   DCL XUG$ PTR ;
     3552    10929    1   DCL M$LM DCB ;
     3553    10930        %XUG_PARAMS ;
     3554    11374        %XT_PARAM (NAME=XT_PARAM, STCLASS="BASED(XT$)");
     3555    11687        %XT_PARAM (NAME=XT_PARAM_C, STCLASS=CONSTANT,GETMEM=XUG$ADAPTMEM);
     3556    12000    1   DCL B$TCB$ PTR SYMREF ;
     3557    12001    1   DCL B$JIT$ PTR SYMREF ;
     3558    12002        %P_PCB (NAME=P$PCB, STCLASS=BASED) ;
     3559    12201        %PARSE$OUT (NAME=P$B) ;
     3560    12246        %PARSE$SYM (NAME=P$S) ;
     3561    12284        %B$TCB (STCLASS="BASED(B$TCB$)") ;
     3562    12287        %B$EXCFR ;
     3563    12305        %B$ALT ;
     3564    12313        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:688  
     3565    12314        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
     3566    12315        DCL 1 NAME STCLASS,
     3567    12316              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
     3568    12317              2 C CHAR(0) INIT(T#);
     3569    12318        %MEND;
     3570    12319    1   DCL 1 NULL_HELP_TOPIC CONSTANT,
     3571    12320    1         2 LEN UBIN BYTE CALIGNED INIT (0);
     3572    12321    1   DCL CODE SBIN WORD ;
     3573    12322    1   DCL ASN UBIN (9) ;                      /* Fid assignment type */
     3574    12323    1   DCL OUTBUFF CHAR(80) ;
     3575    12324    1   DCL TBUFF CHAR(8) ;
     3576    12325    1   DCL TEMPBUFF CHAR(56) ;
     3577    12326    1   DCL BLK$ PTR ;
     3578    12327    1   DCL XT$ PTR;
     3579    12328    1   DCL CNT SBIN WORD ;
     3580    12329    1   DCL TSTOR SBIN WORD ;
     3581    12330    1   DCL M$LO# UBIN ;
     3582    12331        %TEXTC (NAME=M$LO, T#='M$LO') ;
     3583    12336        %FPT_EXIT (FPTN=FPT_EXIT_C, STCLASS=CONSTANT) ;
     3584    12351        %FPT_EXIT (FPTN=FPT_EXIT, STCLASS=AUTO) ;
     3585    12366        %FPT_YC (FPTN=FPT_YC_C, STCLASS=CONSTANT, NOERR=YES, LINK=YES) ;
     3586    12383        %FPT_YC (FPTN=FPT_YC, STCLASS=AUTO) ;
     3587    12400        %VLR_YC (FPTN=VLR_YC, STCLASS=AUTO) ;
     3588    12407        %FPT_WRITE (  FPTN = FPT_WRITE_C, WAIT=YES, STCLASS=CONSTANT) ;
     3589    12438        %FPT_WRITE (STCLASS=AUTO) ;
     3590    12469        %FPT_SETFMA(FPTN=FPT_SETFMA, STCLASS=AUTO) ;
     3591    12482        %FPT_SETFMA (FPTN=FPT_SETFMA_C, STCLASS=CONSTANT) ;
     3592    12495        %FPT_FID (FPTN=FPT_FID, STCLASS=AUTO) ;
     3593    12518        %FPT_FID (FPTN=FPT_FID_C, STCLASS=CONSTANT) ;
     3594    12541        %FPT_LDEV (FPTN=FPT_LDEV_C, STCLASS=CONSTANT) ;
     3595    12566        %FPT_LDEV (FPTN=FPT_LDEV, STCLASS=AUTO) ;
     3596    12591        %FPT_TIME (FPTN=FPT_TIME_C, STCLASS=CONSTANT) ;
     3597    12610        %FPT_TIME (FPTN=FPT_TIME, STCLASS=AUTO) ;
     3598    12629        %XUH_PARAM (NAME=XUH$PARAM, STCLASS="BASED(GETCMD.XUH$)") ;
     3599    12690        %VLP_NAME (FPTN=VLP_NAME, LEN=31, STCLASS=AUTO) ;
     3600    12717        %VLP_ACCT (FPTN=VLP_ACCT, STCLASS=AUTO) ;
     3601    12730        %VLP_SN (FPTN=VLP_SN, N=50, STCLASS=AUTO) ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:689  
     3602    12743        %VLR_FID (FPTN=FID_RESULTS, STCLASS=AUTO) ;
     3603    12762        %VLP_ERRCODE (  FPTN=XUG#BDIRFID, STCLASS=CONSTANT,
     3604    12763                        FCG=XU, MID=G, ERR#=%E$XUG#BDIRFID, SEV=0) ;
     3605    12808        %VLP_ERRCODE (  FPTN=XUG#DOCMD2BIG, STCLASS=CONSTANT,
     3606    12809                        FCG=XU, MID=G, ERR#=%E$XUG#DOCMD2BIG, SEV=0) ;
     3607    12854        %VLP_ERRCODE (  FPTN=XUG#BIG4CHAR, STCLASS=CONSTANT,
     3608    12855                        FCG=XU, MID=G, ERR#=%E$XUG#BIG4CHAR, SEV=0) ;
     3609    12900        %VLP_ERRCODE (  FPTN=XUG#NO_MORE, STCLASS=CONSTANT,
     3610    12901                        FCG=XU, MID=G, ERR#=%E$XUG#NO_MORE, SEV=0) ;
     3611    12946        %VLP_ERRCODE (  FPTN=XUG#NO_ADAPT, STCLASS=CONSTANT,
     3612    12947                        FCG=XU, MID=G, ERR#=%E$XUG#NO_ADAPT, SEV=0);
     3613    12992        %VLP_ERRCODE (  FPTN=XT#CANT_ADAPT, STCLASS=CONSTANT,
     3614    12993                        FCG=XT, ERR#=%E$XT#CANT_ADAPT, SEV=0);
     3615    13038
     3616    13039        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:690  
     3617    13040    1       XUG$ = GETCMD.WORK$ ;
     3618    13041    1       BLK$ = GETCMD.PCB$ -> P$PCB.OUT$ ;
     3619    13042    1       CODE = BLK$->P$B.CODE ;
     3620    13043    1       IF XUG.PRE_EXEC ~= ENTADDR(NIL)
     3621    13044    1       THEN
     3622    13045    1           CALL XUG.PRE_EXEC (GETCMD, CODE) ALTRET(BUILTIN_ERR) ;
     3623    13046
     3624    13047    2       DO CASE(CODE) ;
     3625    13048
     3626    13049    2       CASE(%XUG_CMD_DIR) ;
     3627    13050    2           CALL DIRECTORY_CMD ALTRET(BUILTIN_ERR) ;
     3628    13051
     3629    13052    2       CASE(%XUG_CMD_DO) ;
     3630    13053    2           CALL DO_CMD ALTRET(ALTRET_FROM_BUILTIN) ;
     3631    13054    2           RETURN;
     3632    13055
     3633    13056    2       CASE(%XUG_CMD_END) ;
     3634    13057    2           CALL END_CMD ;
     3635    13058
     3636    13059    2       CASE(%XUG_CMD_ERASE) ;
     3637    13060    2           CALL ERASE_CMD ALTRET(BUILTIN_ERR) ;
     3638    13061
     3639    13062    2       CASE(%XUG_CMD_NULL) ;
     3640    13063
     3641    13064    2       CASE(%XUG_CMD_HELP, %XUG_CMD_Q1, %XUG_CMD_Q2) ;
     3642    13065    2           CALL HELP_CMD ALTRET(BUILTIN_ERR) ;
     3643    13066
     3644    13067    2       CASE (%XUG_CMD_OUTPUT) ;
     3645    13068    2           CALL OUTPUT_CMD ALTRET (BUILTIN_ERR);
     3646    13069
     3647    13070    2       CASE(%XUG_CMD_PRINT) ;
     3648    13071    2           CALL PRINT_CMD ALTRET(BUILTIN_ERR) ;
     3649    13072
     3650    13073    2       CASE(%XUG_CMD_TIME) ;
     3651    13074    2           CALL TIME_DATE_CMD ALTRET(BUILTIN_ERR) ;
     3652    13075
     3653    13076    2       CASE(%XUG_CMD_ENTER);
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:691  
     3654    13077    2           CALL ENTER_CMD ALTRET (ALTRET_FROM_BUILTIN);
     3655    13078    2           RETURN;
     3656    13079
     3657    13080    2       END ;                       /* Do Case */
     3658    13081
     3659    13082    1       IF XUG.POST_EXEC ~= ENTADDR(NIL)
     3660    13083    1       THEN
     3661    13084    1           CALL XUG.POST_EXEC (GETCMD, CODE) ALTRET(ALTRET_FROM_BUILTIN) ;
     3662    13085
     3663    13086    1       RETURN ;
     3664    13087
     3665    13088    1   BUILTIN_ERR:
     3666    13089
     3667    13090    1       IF XUG.POST_EXEC ~= ENTADDR(NIL)
     3668    13091    1       THEN
     3669    13092    1           CALL XUG.POST_EXEC (GETCMD, CODE);
     3670    13093
     3671    13094    1   ALTRET_FROM_BUILTIN:
     3672    13095
     3673    13096    1       ALTRETURN ;
     3674    13097
     3675    13098        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:692  
     3676    13099    1   DIRECTORY_CMD: PROC ALTRET ;
     3677    13100        /**/
     3678    13101        /*
     3679    13102              ***** No options after command indicates directory info. is to be
     3680    13103                    displayed.
     3681    13104        */
     3682    13105    2       IF BLK$->P$B.NSUBLKS=0
     3683    13106    2       THEN
     3684    13107    3       DO ;
     3685    13108    3           OUTBUFF = '  Directory: ' ;
     3686    13109    3           CNT = 13 ;
     3687    13110    3           CALL INDEX(TSTOR,' ',B$JIT.FPSN) ;
     3688    13111    3           IF TSTOR>0
     3689    13112    3           THEN
     3690    13113    4           DO ;
     3691    13114    4               CALL INSERT(OUTBUFF, CNT, 3+TSTOR, 'DP#', B$JIT.FPSN) ;
     3692    13115    4               CNT = CNT + 3 + TSTOR ;
     3693    13116    4           END ;                     /* Then Do */
     3694    13117        /*
     3695    13118          *****  Insert the account.
     3696    13119        */
     3697    13120    3           CALL CONCAT(TEMPBUFF, '.', B$JIT.FACCN,' ') ;
     3698    13121    3           CALL INDEX(TSTOR,' ',TEMPBUFF) ;
     3699    13122    3           CALL INSERT(OUTBUFF, CNT, ,SUBSTR(TEMPBUFF,0,TSTOR)) ;
     3700    13123    3           CNT = CNT + TSTOR ;
     3701    13124    3           CALL OUTPUT_MESSAGE(CNT) ALTRET(DIR_ERR) ;
     3702    13125    3           RETURN ;
     3703    13126    3       END ;                        /* Then Do */
     3704    13127        /*
     3705    13128           *****  Set or Reset directory information in JIT.
     3706    13129        */
     3707    13130    2       FPT_SETFMA = FPT_SETFMA_C ;
     3708    13131    3       DO CASE(BLK$->P$B.SUBLK$(0)->P$B.CODE) ;
     3709    13132
     3710    13133    3       CASE(%XUG_CMD_DIR_RESET) ;
     3711    13134        /*
     3712    13135          *****   NOTE: No code required since default fpt is what is required.
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:693  
     3713    13136        */
     3714    13137    3       CASE(%XUG_CMD_DIR_FID) ;
     3715    13138    3           FPT_FID = FPT_FID_C ;
     3716    13139    3           FPT_FID.V_ = VECTOR(FPT_FID.V) ;
     3717    13140    3           FPT_FID.TEXTFID_=VECTOR(BLK$->P$B.SUBLK$(0)->
     3718    13141    3             P$S.TEXT) ;
     3719    13142    3           FPT_FID.NAME_ = VECTOR(VLP_NAME) ;
     3720    13143    3           FPT_FID.ACCT_ = VECTOR(VLP_ACCT) ;
     3721    13144    3           FPT_FID.PASS_ = VECTOR(VLP_ACCT) ;
     3722    13145    3           FPT_FID.SN_ = VECTOR(VLP_SN) ;
     3723    13146    3           FPT_FID.WSN_ = VECTOR(VLP_ACCT) ;
     3724    13147    3           FPT_FID.ASN_ = VECTOR(ASN) ;
     3725    13148    3           FPT_FID.RES_ = VECTOR(TBUFF) ;
     3726    13149    3           FPT_FID.RESULTS_ = VECTOR(FID_RESULTS) ;
     3727    13150    3           CALL M$FID(FPT_FID) ALTRET(DIR_ERR) ;
     3728    13151        /*
     3729    13152          *****   Make sure the FID was legal.
     3730    13153        */
     3731    13154    3           IF FID_RESULTS.ACCT = %NO# OR VLP_ACCT.ACCT# = ' ' OR ASN ~= %FILE#
     3732    13155    3           THEN
     3733    13156    3               GOTO FID_ERR ;
     3734    13157    3           IF FID_RESULTS.NAME = %YES# OR FID_RESULTS.PASS = %YES# OR
     3735    13158    3             FID_RESULTS.WSN = %YES#
     3736    13159    3           THEN
     3737    13160    3               GOTO FID_ERR ;
     3738    13161    3           IF VLP_SN.NUM# > 1
     3739    13162    3           THEN
     3740    13163    3               GOTO FID_ERR ;
     3741    13164        /*
     3742    13165          *****   Determine if DP#NN.ACCT or .ACCT spec'd
     3743    13166        */
     3744    13167    3           FPT_SETFMA.ACCT_ = VECTOR(VLP_ACCT) ;
     3745    13168    3           IF FID_RESULTS.SN
     3746    13169    3           THEN                         /* Sn specified as well */
     3747    13170    3               FPT_SETFMA.PSN_ = VECTOR(VLP_SN.SN#) ;
     3748    13171    3       END ;                          /* Do Case */
     3749    13172    2       CALL M$SETFMA (FPT_SETFMA) ALTRET(DIR_ERR) ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:694  
     3750    13173    2       RETURN ;
     3751    13174    2   DIR_ERR:
     3752    13175    2       GETCMD.ERR# = B$TCB.ALT$ ->B$EXCFR.ERR ;
     3753    13176    2       ALTRETURN ;
     3754    13177    2   FID_ERR:
     3755    13178    2       GETCMD.ERR# = XUG#BDIRFID ;
     3756    13179    2       GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(0)->P$B.CPOS ;
     3757    13180    2       ALTRETURN ;
     3758    13181        /*E*  ERROR:  XUG-E$XUG#BDIRFID
     3759    13182              MESSAGE0: FID may only consist of DP#SN.ACCOUNT or .ACCOUNT.
     3760    13183        */
     3761    13184
     3762    13185    2   END     DIRECTORY_CMD ;
     3763    13186        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:695  
     3764    13187    1   END_CMD: PROC ;
     3765    13188
     3766    13189    2       FPT_EXIT = FPT_EXIT_C ;
     3767    13190    2       FPT_EXIT.V_ = VECTOR(FPT_EXIT.V) ;
     3768    13191    2       CALL M$EXIT (FPT_EXIT) ;
     3769    13192
     3770    13193    2   END     END_CMD ;
     3771    13194        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:696  
     3772    13195    1   ENTER_CMD: PROC ALTRET;
     3773    13196
     3774    13197    2   DCL I SBIN;
     3775    13198
     3776    13199    2       IF GETCMD.XT_PARAM$ = ADDR(NIL)
     3777    13200    3       THEN DO;
     3778    13201    3           XT$ = PINCRW(XUG$, SIZEW(XUG) + SIZEW(P$PCB));
     3779    13202    3           XT_PARAM = XT_PARAM_C;
     3780    13203    3           XT_PARAM.XUG$ = XUG$ ;
     3781    13204    3           XT_PARAM.USER$ = ADDR(GETCMD);
     3782    13205    3           GETCMD.XT_PARAM$ = XT$;
     3783    13206    3           XT_PARAM.INDCB = GETCMD.INDCB# ;
     3784    13207    3           XT_PARAM.OUTDCB = GETCMD.OUTDCB# ;
     3785    13208
     3786    13209    3           CALL XUG.ADAPT$$ (XT_PARAM, %XT#RESTART)
     3787    13210    4           WHENALTRETURN DO;
     3788    13211    4               XUG.ADAPT$$ = ENTADDR(NIL);
     3789    13212    4               GETCMD.XT_PARAM$ = ADDR(NIL);
     3790    13213    4               IF XT_PARAM.ERR = XT#CANT_ADAPT
     3791    13214    4               THEN GETCMD.ERR# = XUG#NO_ADAPT ;
     3792    13215    4               ELSE GETCMD.ERR# = XT_PARAM.ERR ;
     3793    13216    4               ALTRETURN;
     3794    13217    4           END;
     3795    13218    3       END;
     3796    13219        /*E*  ERROR:   XUG-E$XUG#NO_ADAPT-0
     3797    13220              MESSAGE: The ADAPT dialog manager is not available.
     3798    13221              MESSAGE1: The ENTER command cannot be used because the Alternate Shared
     3799    13222                        Library (ADAPT_ASL) for the dialog manager is not installed.
     3800    13223        */
     3801    13224
     3802    13225    2       XT$ = GETCMD.XT_PARAM$;
     3803    13226    2       XT_PARAM.SCRIPT.PT$ = ADDR(NIL);
     3804    13227    2       XT_PARAM.FRAME.PT$ = ADDR(NIL);
     3805    13228    2       XT_PARAM.IBUF.PT$ = ADDR(NIL);
     3806    13229    2       XT_PARAM.SCRIPT.LEN = 0 ;
     3807    13230    2       XT_PARAM.FRAME.LEN = 0 ;
     3808    13231    2       XT_PARAM.IBUF.LEN = 0 ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:697  
     3809    13232
     3810    13233    3       DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;
     3811    13234
     3812    13235    4           DO CASE (BLK$ -> P$B.SUBLK$(I) -> P$B.CODE);
     3813    13236
     3814    13237    4           CASE (%XUG_SCRIPTFID);
     3815    13238    4               XT_PARAM.SCRIPT.PT$ = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXTC$;
     3816    13239    4           CASE (%XUG_FRAMENAME);
     3817    13240    4               XT_PARAM.FRAME.PT$ = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXTC$;
     3818    13241    4           CASE (%XUG_TEXT);
     3819    13242    4               IF BLK$-> P$B.SUBLK$(I)-> P$S.COUNT > 0
     3820    13243    4               THEN
     3821    13244    4                   XT_PARAM.IBUF.PT$ = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXTC$;
     3822    13245
     3823    13246    4           END;
     3824    13247
     3825    13248    3       END;
     3826    13249
     3827    13250    2       CALL XUG.ADAPT$$ (XT_PARAM, %XT#ENTER)
     3828    13251    3       WHENRETURN DO;
     3829    13252    3           RETURN;
     3830    13253    3       END;
     3831    13254    3       WHENALTRETURN DO;
     3832    13255    3           GETCMD.ERR# = XT_PARAM.ERR;
     3833    13256    3           ALTRETURN;
     3834    13257    3       END;
     3835    13258
     3836    13259    2   END ENTER_CMD;
     3837    13260
     3838    13261        %EJECT;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:698  
     3839    13262    1   DO_CMD: PROC ALTRET ;
     3840    13263
     3841    13264    2   DCL POST_EXEC EPTR;
     3842    13265
     3843    13266    2       POST_EXEC = XUG.POST_EXEC;
     3844    13267    2       IF BLK$->P$B.SUBLK$(0)->P$S.COUNT = 0
     3845    13268    2       THEN
     3846    13269    2           RETURN ;
     3847    13270    2       IF BLK$->P$B.SUBLK$(0)->P$S.COUNT > 256
     3848    13271    2       THEN
     3849    13272    3       DO ;
     3850    13273    3           GETCMD.ERR# = XUG#DOCMD2BIG ;
     3851    13274    3           GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(0)->P$S.CPOS+256 ;
     3852    13275    3           ALTRETURN;
     3853    13276    3       END ;                        /* Then Do */
     3854    13277        /*E*  ERROR:  XUG-E$XUG#DOCMD2BIG
     3855    13278              MESSAGE0: DO command too big.
     3856    13279              MESSAGE1: The DO command can be at most 256 characters long.
     3857    13280        */
     3858    13281    2       FPT_YC = FPT_YC_C ;
     3859    13282    2       FPT_YC.V_ = VECTOR(FPT_YC.V) ;
     3860    13283    2       FPT_YC.CMD_ = VECTOR(BLK$->P$B.SUBLK$(0)->P$S.TEXT) ;
     3861    13284    2       FPT_YC.REPLY_ = VECTOR(VLR_YC) ;
     3862    13285    2       FPT_YC.V.LINK# = %YES# ;
     3863    13286    2       IF XUG.DOCMD_SYNERR
     3864    13287    2       THEN
     3865    13288    2           FPT_YC.V.REPARSE# = %YES# ;
     3866    13289    2       ELSE
     3867    13290    2           FPT_YC.V.REPARSE# = %NO# ;
     3868    13291    2       XUG.DOCMD_SYNERR = %NO# ;
     3869    13292    2       CALL M$YC (FPT_YC) ALTRET(M$YC_ERR) ;
     3870    13293        /*
     3871    13294            Special handling of POST_EXEC routine is needed after linking to
     3872    13295            another program, because memory allocation by that program
     3873    13296            (notably COMMON) will require argument stack descriptors
     3874    13297            to be reloaded by programs that use them (notably APL).
     3875    13298        */
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:699  
     3876    13299    2       IF POST_EXEC ~= ENTADDR(NIL)
     3877    13300    2       THEN
     3878    13301    2           CALL POST_EXEC (GETCMD,CODE) ALTRET(ALT);
     3879    13302    2       RETURN;
     3880    13303    2   M$YC_ERR:
     3881    13304    2       ERR = B$TCB.ALT$ -> B$EXCFR.ERR ;
     3882    13305    2       IF POST_EXEC ~= ENTADDR(NIL)
     3883    13306    2       THEN
     3884    13307    2           CALL POST_EXEC (GETCMD,CODE);
     3885    13308    2       IF B$JIT.CPFLAGS1 & %CP_EXIT#
             13308                /* callee M$EXIT/M$ERR/M$XXX with CODE=something */
     3886    13309    3       THEN DO;
     3887    13310    3           XUG.ERRSAVE = ERR;
     3888    13311    3           XUG.ERRDCB = DCBNUM(NIL);
     3889    13312    3           XUG.NO_INCREMENT = %YES#;
     3890    13313    3           XUG.FIRST_ERROR = %YES#;
     3891    13314    3           XUG.LAST_FLAGLEV = 0;
     3892    13315    3           RETURN;
     3893    13316    3       END;
     3894    13317    2       GETCMD.PCB$->P$PCB.HI_CHAR = VLR_YC.CPOS + BLK$->P$B.SUBLK$(0) ->
     3895    13318    2         P$S.CPOS ;
     3896    13319    2       IF NOT ERR.MON AND ERR.CODE=%E$SYNERR
     3897    13320    2       THEN
     3898    13321    3       DO ;
     3899    13322    3           CALL XUG$SINPUT (GETCMD);
     3900    13323    3           XUG.SYNERR=%YES# ;
     3901    13324    3           XUG.DOCMD_SYNERR=%YES# ;
     3902    13325    3           ERR.MID='07'O;
     3903    13326    3       END ;                        /* Then Do */
     3904    13327    2       GETCMD.ERR# = ERR;
     3905    13328    2   ALT: ALTRETURN;
     3906    13329
     3907    13330    2   END     DO_CMD ;
     3908    13331        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:700  
     3909    13332    1   ERASE_CMD: PROC ALTRET ;
     3910    13333        /**/
     3911    13334    2   DCL I UBIN WORD ;
     3912    13335        /**/
     3913    13336    2       FPT_LDEV = FPT_LDEV_C ;
     3914    13337    2       FPT_LDEV.V_ = VECTOR(FPT_LDEV.V);
     3915    13338    2       FPT_LDEV.V.DELETE# = %YES#;
     3916    13339    2       IF BLK$->P$B.NSUBLKS = 0
     3917    13340    2       THEN
     3918    13341    3       DO;
     3919    13342    3           FPT_LDEV.V.STREAMNAME# = 'ALL';
     3920    13343    3           CALL M$LDEV(FPT_LDEV) ALTRET(ERASE_ERR);
     3921    13344    3           RETURN;
     3922    13345    3       END;
     3923    13346    2       I = 0;
     3924    13347    3       DO WHILE(I < BLK$->P$B.NSUBLKS);
     3925    13348    3           IF BLK$ -> P$B.SUBLK$(I)->P$S.COUNT > 4
     3926    13349    3           THEN
     3927    13350    4           DO ;
     3928    13351    4               GETCMD.ERR# = XUG#BIG4CHAR ;
     3929    13352    4               GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(I)->P$S.CPOS+4 ;
     3930    13353    4               ALTRETURN;
     3931    13354    4           END ;                     /* Then Do */
     3932    13355        /*E*  ERROR:  XUG-E$XUG#BIG4CHAR
     3933    13356              MESSAGE0: Only four or less characters allowed.
     3934    13357        */
     3935    13358    3           FPT_LDEV.V.STREAMNAME# = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXT;
     3936    13359    3           CALL M$LDEV(FPT_LDEV) ALTRET(ERASE_ERR);
     3937    13360    3           I = I + 1;
     3938    13361    3       END;
     3939    13362    2       RETURN;
     3940    13363    2   ERASE_ERR:
     3941    13364    2       GETCMD.ERR# = B$TCB.ALT$->B$EXCFR.ERR ;
     3942    13365    2       GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(I)->P$S.CPOS ;
     3943    13366    2   ERASE_ALT:
     3944    13367    2       ALTRETURN;
     3945    13368    2   END     ERASE_CMD ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:701  
     3946    13369        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:702  
     3947    13370    1   HELP_CMD: PROC ALTRET ;
     3948    13371
     3949    13372    2       IF GETCMD.XUH$ = ADDR(NIL)
     3950    13373    2       THEN
     3951    13374    2           GETCMD.XUH$ = ADDR(XUG.XUH_PARAM);
     3952    13375
     3953    13376    3       DO CASE(CODE) ;
     3954    13377
     3955    13378    3       CASE(%XUG_CMD_Q1);
     3956    13379    3           CALL XUG$MOREMSG_COMMON(GETCMD) ALTRET(GIVE_ERR_MSG) ;
     3957    13380
     3958    13381    3       CASE(%XUG_CMD_Q2);
     3959    13382    3           CALL XUG$ALLMSG_COMMON(GETCMD) ALTRET(GIVE_ERR_MSG) ;
     3960    13383
     3961    13384    3       CASE(%XUG_CMD_HELP);
     3962    13385    3           IF BLK$ -> P$B.NSUBLKS = 0
     3963    13386    3           THEN
     3964    13387    3               XUH$PARAM.HELP$ = ADDR(NULL_HELP_TOPIC);
     3965    13388    3           ELSE
     3966    13389    3               XUH$PARAM.HELP$=BLK$->P$B.SUBLK$(0)->P$S.TEXTC$;
     3967    13390    3           CALL XUG$HELP_COMMON(GETCMD) ALTRET(NORMAL_RETURN) ;
     3968    13391    3       END ;                          /* Do Case */
     3969    13392    2   NORMAL_RETURN:
     3970    13393    2       RETURN ;
     3971    13394
     3972    13395    2   GIVE_ERR_MSG:
     3973    13396    2       GETCMD.ERR_CODE = XUG#NO_MORE ;
     3974    13397        /*E*   ERROR:   XUG-E$XUG#NO_MORE
     3975    13398               MESSAGE: No messages available.
     3976    13399               MESSAGE1: Th Th Th That's all fffolks!
     3977    13400                                                                          */
     3978    13401    2       GETCMD.ERRDCB# = B$TCB.ALT$->B$EXCFR.DCB# ;
     3979    13402    2       GETCMD.F1_ = VECTOR(NIL) ;
     3980    13403    2       GETCMD.F2_ = VECTOR(NIL) ;
     3981    13404    2       GETCMD.F3_ = VECTOR(NIL) ;
     3982    13405    2       GETCMD.FLGLEV# = 0 ;
     3983    13406    2       CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(HELP_ERR) ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:703  
     3984    13407    2       RETURN ;
     3985    13408    2   HELP_ERR:
     3986    13409    2       GETCMD.ERR# = B$TCB.ALT$->B$EXCFR.ERR ;
     3987    13410    2       GETCMD.PCB$->P$PCB.HI_CHAR = 0 ;
     3988    13411    2       ALTRETURN ;
     3989    13412    2   END     HELP_CMD ;
     3990    13413        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:704  
     3991    13414    1   OUTPUT_CMD: PROC ALTRET;
     3992    13415
     3993    13416    2       GETCMD.UTIL$ = BLK$;
     3994    13417    2       GETCMD.FPT$ = ADDR(NIL);
     3995    13418    2       TSTOR = GETCMD.DCB_PARAM#;
     3996    13419    2       GETCMD.DCB_PARAM# = GETCMD.OUTDCB#;
     3997    13420
     3998    13421    2       CALL XUG$OPENOUT_COMMON (GETCMD)
     3999    13422    3       WHENALTRETURN DO;
     4000    13423    3           GETCMD.DCB_PARAM# = TSTOR;
     4001    13424    3           ALTRETURN;
     4002    13425    3       END;
     4003    13426
     4004    13427    2       GETCMD.DCB_PARAM# = TSTOR;
     4005    13428    2       RETURN;
     4006    13429
     4007    13430    2   END OUTPUT_CMD;
     4008    13431        %EJECT;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:705  
     4009    13432    1   PRINT_CMD: PROC ALTRET ;
     4010    13433        /**/
     4011    13434    2   DCL I UBIN WORD ;
     4012    13435        /**/
     4013    13436    2       FPT_LDEV = FPT_LDEV_C ;
     4014    13437    2       FPT_LDEV.V_ = VECTOR(FPT_LDEV.V);
     4015    13438    2       IF BLK$->P$B.NSUBLKS = 0
     4016    13439    2       THEN
     4017    13440    3       DO;
     4018    13441    3           FPT_LDEV.V.STREAMNAME# = 'ALL';
     4019    13442    3           CALL M$LDEV(FPT_LDEV) ALTRET(PRINT_ERR) ;
     4020    13443    3           RETURN;
     4021    13444    3       END;
     4022    13445    2       I = 0;
     4023    13446    3       DO WHILE(I < BLK$->P$B.NSUBLKS);
     4024    13447    3           IF BLK$ -> P$B.SUBLK$(I)->P$S.COUNT > 4
     4025    13448    3           THEN
     4026    13449    4           DO ;
     4027    13450    4               GETCMD.ERR# = XUG#BIG4CHAR ;
     4028    13451    4               GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(I)->P$S.CPOS+4 ;
     4029    13452    4               ALTRETURN;
     4030    13453    4           END ;                     /* Then Do */
     4031    13454    3           FPT_LDEV.V.STREAMNAME# = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXT;
     4032    13455    3           CALL M$LDEV(FPT_LDEV) ALTRET(PRINT_ERR);
     4033    13456    3           I = I + 1;
     4034    13457    3       END;
     4035    13458    2       RETURN;
     4036    13459    2   PRINT_ERR:
     4037    13460    2       GETCMD.ERR# = B$TCB.ALT$->B$EXCFR.ERR ;
     4038    13461    2       GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(I)->P$S.CPOS ;
     4039    13462    2       ALTRETURN;
     4040    13463    2   END     PRINT_CMD ;
     4041    13464        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:706  
     4042    13465    1   TIME_DATE_CMD: PROC ALTRET ;
     4043    13466
     4044    13467    2   DCL 1 TMDATE,
     4045    13468    2         2 * CHAR(2),
     4046    13469    2         2 DATE CHAR(10),
     4047    13470    2         2 * CHAR(2),
     4048    13471    2         2 TIME,
     4049    13472    2           3 HR CHAR(3),
     4050    13473    2           3 MIN CHAR(2),
     4051    13474    2           3 SEC CHAR(3),
     4052    13475    2           3 MSEC CHAR(3),
     4053    13476    2         2 DAY CHAR(3) ;
     4054    13477    2   DCL TMDATEBUFF REDEF TMDATE CHAR(28);
     4055    13478
     4056    13479    2       TMDATEBUFF=' ';                /*Blank out buffer*/
     4057    13480    2       FPT_TIME = FPT_TIME_C;
     4058    13481    2       FPT_TIME.V_ = VECTOR(FPT_TIME.V);
     4059    13482    2       FPT_TIME.DAY_=VECTOR(TMDATE.DAY) ;
     4060    13483    2       FPT_TIME.DATE_=VECTOR(TMDATE.DATE);
     4061    13484    2       FPT_TIME.TIME_=VECTOR(TMDATE.TIME);
     4062    13485    2       CALL M$TIME(FPT_TIME) ALTRET(TIME_ERR) ;
     4063    13486    2       CNT = 19 ;
     4064    13487    2       OUTBUFF=SUBSTR(TMDATEBUFF,0,CNT) ;
     4065    13488    2       CALL OUTPUT_MESSAGE (CNT) ALTRET(TIME_ERR) ;
     4066    13489    2       RETURN ;
     4067    13490    2   TIME_ERR: ;
     4068    13491    2       GETCMD.ERR# = B$TCB.ALT$ -> B$EXCFR.ERR ;
     4069    13492    2       ALTRETURN ;
     4070    13493    2   END     TIME_DATE_CMD ;
     4071    13494        %EJECT;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:707  
     4072    13495    1   OUTPUT_MESSAGE: PROC (BOUND) ALTRET ;
     4073    13496
     4074    13497    2   DCL BOUND SBIN WORD ;
     4075    13498
     4076    13499    2       FPT_WRITE = FPT_WRITE_C ;
     4077    13500    2       FPT_WRITE.V_ = VECTOR(FPT_WRITE.V) ;
     4078    13501    2       FPT_WRITE.BUF_ = VECTOR(OUTBUFF) ;
     4079    13502    2       FPT_WRITE.BUF_.BOUND = BOUND - 1 ;
     4080    13503
     4081    13504    2       IF GETCMD.OUTDCB# ~= 0
     4082    13505    2       THEN
     4083    13506    2           M$LO# = GETCMD.OUTDCB# ;
     4084    13507    2       ELSE
     4085    13508    2           CALL XUG$FINDDCB_COMMON (M$LO, M$LO#) ALTRET(OUTPUT_ERR) ;
     4086    13509    2       FPT_WRITE.V.DCB# = M$LO# ;
     4087    13510    2       CALL M$WRITE (FPT_WRITE) ALTRET(OUTPUT_ERR) ;
     4088    13511    2       RETURN ;
     4089    13512
     4090    13513    2   OUTPUT_ERR:
     4091    13514    2       ALTRETURN ;
     4092    13515    2   END     OUTPUT_MESSAGE ;
     4093    13516    1   END   XUG$BUILTIN_COMMON ;
     4094    13517        %EOD;

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:708  
--  Include file information  --

   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XT_PERR_E.:TOOLE04  is referenced.
   XT_MACRO_M.:TOOLE04  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$BUILTIN_COMMON.

   Procedure XUG$BUILTIN_COMMON requires 908 words for executable code.
   Procedure XUG$BUILTIN_COMMON requires 246 words of local(AUTO) storage.

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:709  

 Object Unit name= XUG$BUILTIN_COMMON                         File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:28:03.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LM
    2  RoData even  UTS    135    207  XUG$BUILTIN_COMMON
    3   Proc  even  none   908   1614  XUG$BUILTIN_COMMON
    4  RoData even  none    25     31  XUG$BUILTIN_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  XUG$BUILTIN_COMMON
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:710  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XUG$ADAPTMEM
 yes     yes           Std       1 XUG$SINPUT
 yes     yes           Std       1 XUG$MOREMSG_COMMON
 yes     yes           Std       1 XUG$HELP_COMMON
 yes     yes           Std       1 XUG$ERRMSG_COMMON
 yes     yes           Std       1 XUG$ALLMSG_COMMON
 yes     yes           Std       1 XUG$OPENOUT_COMMON
 yes     yes           Std       2 XUG$FINDDCB_COMMON
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$LM                                  B$TCB$
     B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:711  


     3514        1        /*T***********************************************************/
     3515        2        /*T*                                                         */
     3516        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3517        4        /*T*                                                         */
     3518        5        /*T***********************************************************/
     3519        6        /* XUG$BUILTIN_COMMON   Routine to handle the BUILTIN commands.              */
     3520        7        XUG$BUILTIN_COMMON: PROC(GETCMD) ALTRET;

      7  3 000000   000000 700200 xent  XUG$BUILTIN* TSX0  ! X66_AUTO_1
         3 000001   000366 000001                    ZERO    246,1

     3521        8        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     3522        9
     3523       10    1   DCL 1 ERR AUTO,
     3524       11    1         2 FCG BIT(12),
     3525       12    1         2 MID BIT(6),
     3526       13    1         2 MON BIT(1),
     3527       14    1         2 CODE UBIN(14) UNAL,
     3528       15    1         2 SEV UBIN(3) UNAL;
     3529       16
     3530       17        %INCLUDE XU_MACRO_C ;
     3531     3123        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     3532     3461        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:712  
     3533     3462        %INCLUDE XU_SUBS_C ;
     3534     3554        %INCLUDE XU_PERR_C ;
     3535     3745        %INCLUDE XUH_MACRO_C ;
     3536     3829        %INCLUDE XT_MACRO_M;
     3537     4155        %INCLUDE XT_PERR_E ;
     3538     4216        %INCLUDE CP_6 ;
     3539     9775        %INCLUDE CP_6_SUBS ;
     3540    10315        %INCLUDE B$JIT ;
     3541    10918
     3542    10919    1   DCL XUG$MOREMSG_COMMON ENTRY(1) ALTRET ;
     3543    10920    1   DCL XUG$ALLMSG_COMMON ENTRY(1) ALTRET ;
     3544    10921    1   DCL XUG$HELP_COMMON ENTRY(1) ALTRET ;
     3545    10922    1   DCL XUG$ERRMSG_COMMON ENTRY(1) ALTRET ;
     3546    10923    1   DCL XUG$FINDDCB_COMMON ENTRY(2) ALTRET ;
     3547    10924    1   DCL XUG$OPENOUT_COMMON ENTRY (1) ALTRET;
     3548    10925    1   DCL XUG$SINPUT ENTRY(1) ALTRET;
     3549    10926    1   DCL XUG$ADAPTMEM ENTRY(1) ALTRET;
     3550    10927
     3551    10928    1   DCL XUG$ PTR ;
     3552    10929    1   DCL M$LM DCB ;
     3553    10930        %XUG_PARAMS ;
     3554    11374        %XT_PARAM (NAME=XT_PARAM, STCLASS="BASED(XT$)");
     3555    11687        %XT_PARAM (NAME=XT_PARAM_C, STCLASS=CONSTANT,GETMEM=XUG$ADAPTMEM);
     3556    12000    1   DCL B$TCB$ PTR SYMREF ;
     3557    12001    1   DCL B$JIT$ PTR SYMREF ;
     3558    12002        %P_PCB (NAME=P$PCB, STCLASS=BASED) ;
     3559    12201        %PARSE$OUT (NAME=P$B) ;
     3560    12246        %PARSE$SYM (NAME=P$S) ;
     3561    12284        %B$TCB (STCLASS="BASED(B$TCB$)") ;
     3562    12287        %B$EXCFR ;
     3563    12305        %B$ALT ;
     3564    12313        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:713  
     3565    12314        %MACRO TEXTC (NAME=NAME,T#='',STCLASS=CONSTANT);
     3566    12315        DCL 1 NAME STCLASS,
     3567    12316              2 L UBIN BYTE UNAL INIT(SIZEC(T#)),
     3568    12317              2 C CHAR(0) INIT(T#);
     3569    12318        %MEND;
     3570    12319    1   DCL 1 NULL_HELP_TOPIC CONSTANT,
     3571    12320    1         2 LEN UBIN BYTE CALIGNED INIT (0);
     3572    12321    1   DCL CODE SBIN WORD ;
     3573    12322    1   DCL ASN UBIN (9) ;                      /* Fid assignment type */
     3574    12323    1   DCL OUTBUFF CHAR(80) ;
     3575    12324    1   DCL TBUFF CHAR(8) ;
     3576    12325    1   DCL TEMPBUFF CHAR(56) ;
     3577    12326    1   DCL BLK$ PTR ;
     3578    12327    1   DCL XT$ PTR;
     3579    12328    1   DCL CNT SBIN WORD ;
     3580    12329    1   DCL TSTOR SBIN WORD ;
     3581    12330    1   DCL M$LO# UBIN ;
     3582    12331        %TEXTC (NAME=M$LO, T#='M$LO') ;
     3583    12336        %FPT_EXIT (FPTN=FPT_EXIT_C, STCLASS=CONSTANT) ;
     3584    12351        %FPT_EXIT (FPTN=FPT_EXIT, STCLASS=AUTO) ;
     3585    12366        %FPT_YC (FPTN=FPT_YC_C, STCLASS=CONSTANT, NOERR=YES, LINK=YES) ;
     3586    12383        %FPT_YC (FPTN=FPT_YC, STCLASS=AUTO) ;
     3587    12400        %VLR_YC (FPTN=VLR_YC, STCLASS=AUTO) ;
     3588    12407        %FPT_WRITE (  FPTN = FPT_WRITE_C, WAIT=YES, STCLASS=CONSTANT) ;
     3589    12438        %FPT_WRITE (STCLASS=AUTO) ;
     3590    12469        %FPT_SETFMA(FPTN=FPT_SETFMA, STCLASS=AUTO) ;
     3591    12482        %FPT_SETFMA (FPTN=FPT_SETFMA_C, STCLASS=CONSTANT) ;
     3592    12495        %FPT_FID (FPTN=FPT_FID, STCLASS=AUTO) ;
     3593    12518        %FPT_FID (FPTN=FPT_FID_C, STCLASS=CONSTANT) ;
     3594    12541        %FPT_LDEV (FPTN=FPT_LDEV_C, STCLASS=CONSTANT) ;
     3595    12566        %FPT_LDEV (FPTN=FPT_LDEV, STCLASS=AUTO) ;
     3596    12591        %FPT_TIME (FPTN=FPT_TIME_C, STCLASS=CONSTANT) ;
     3597    12610        %FPT_TIME (FPTN=FPT_TIME, STCLASS=AUTO) ;
     3598    12629        %XUH_PARAM (NAME=XUH$PARAM, STCLASS="BASED(GETCMD.XUH$)") ;
     3599    12690        %VLP_NAME (FPTN=VLP_NAME, LEN=31, STCLASS=AUTO) ;
     3600    12717        %VLP_ACCT (FPTN=VLP_ACCT, STCLASS=AUTO) ;
     3601    12730        %VLP_SN (FPTN=VLP_SN, N=50, STCLASS=AUTO) ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:714  
     3602    12743        %VLR_FID (FPTN=FID_RESULTS, STCLASS=AUTO) ;
     3603    12762        %VLP_ERRCODE (  FPTN=XUG#BDIRFID, STCLASS=CONSTANT,
     3604    12763                        FCG=XU, MID=G, ERR#=%E$XUG#BDIRFID, SEV=0) ;
     3605    12808        %VLP_ERRCODE (  FPTN=XUG#DOCMD2BIG, STCLASS=CONSTANT,
     3606    12809                        FCG=XU, MID=G, ERR#=%E$XUG#DOCMD2BIG, SEV=0) ;
     3607    12854        %VLP_ERRCODE (  FPTN=XUG#BIG4CHAR, STCLASS=CONSTANT,
     3608    12855                        FCG=XU, MID=G, ERR#=%E$XUG#BIG4CHAR, SEV=0) ;
     3609    12900        %VLP_ERRCODE (  FPTN=XUG#NO_MORE, STCLASS=CONSTANT,
     3610    12901                        FCG=XU, MID=G, ERR#=%E$XUG#NO_MORE, SEV=0) ;
     3611    12946        %VLP_ERRCODE (  FPTN=XUG#NO_ADAPT, STCLASS=CONSTANT,
     3612    12947                        FCG=XU, MID=G, ERR#=%E$XUG#NO_ADAPT, SEV=0);
     3613    12992        %VLP_ERRCODE (  FPTN=XT#CANT_ADAPT, STCLASS=CONSTANT,
     3614    12993                        FCG=XT, ERR#=%E$XT#CANT_ADAPT, SEV=0);
     3615    13038
     3616    13039        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:715  
     3617    13040    1       XUG$ = GETCMD.WORK$ ;

  13040  3 000002   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000003   000004 236100                    LDQ     4,,PR0
         3 000004   200005 756100                    STQ     XUG$,,AUTO

     3618    13041    1       BLK$ = GETCMD.PCB$ -> P$PCB.OUT$ ;

  13041  3 000005   000003 471500                    LDP1    3,,PR0
         3 000006   100003 236100                    LDQ     3,,PR1
         3 000007   200054 756100                    STQ     BLK$,,AUTO

     3619    13042    1       CODE = BLK$->P$B.CODE ;

  13042  3 000010   200054 473500                    LDP3    BLK$,,AUTO
         3 000011   300000 236100                    LDQ     0,,PR3
         3 000012   777777 376007                    ANQ     -1,DL
         3 000013   200006 756100                    STQ     CODE,,AUTO

     3620    13043    1       IF XUG.PRE_EXEC ~= ENTADDR(NIL)

  13043  3 000014   200005 471500                    LDP1    XUG$,,AUTO
         3 000015   100026 236100                    LDQ     22,,PR1
         3 000016   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 000017   000031 600000 3                  TZE     s:13047

     3621    13044    1       THEN
     3622    13045    1           CALL XUG.PRE_EXEC (GETCMD, CODE) ALTRET(BUILTIN_ERR) ;

  13045  3 000020   200006 634500                    EPPR4   CODE,,AUTO
         3 000021   200365 454500                    STP4    @BOUND+2,,AUTO
         3 000022   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000023   200364 756100                    STQ     @BOUND+1,,AUTO
         3 000024   200364 630500                    EPPR0   @BOUND+1,,AUTO
         3 000025   100026 220100                    LDX0    22,,PR1
         3 000026   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000027   000000 701010                    TSX1    0,X0
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:716  
         3 000030   000127 702000 3                  TSX2    BUILTIN_ERR

     3623    13046
     3624    13047    2       DO CASE(CODE) ;

  13047  3 000031   200006 235100                    LDA     CODE,,AUTO
         3 000032   000020 115007                    CMPA    16,DL
         3 000033   000035 602005 3                  TNC     s:13047+4,AL
         3 000034   000110 710000 3                  TRA     s:13082
         3 000035   000110 710000 3                  TRA     s:13082
         3 000036   000055 710000 3                  TRA     s:13050
         3 000037   000060 710000 3                  TRA     s:13053
         3 000040   000063 710000 3                  TRA     s:13057
         3 000041   000066 710000 3                  TRA     s:13060
         3 000042   000071 710000 3                  TRA     s:13065
         3 000043   000110 710000 3                  TRA     s:13082
         3 000044   000077 710000 3                  TRA     s:13071
         3 000045   000071 710000 3                  TRA     s:13065
         3 000046   000071 710000 3                  TRA     s:13065
         3 000047   000102 710000 3                  TRA     s:13074
         3 000050   000110 710000 3                  TRA     s:13082
         3 000051   000110 710000 3                  TRA     s:13082
         3 000052   000110 710000 3                  TRA     s:13082
         3 000053   000074 710000 3                  TRA     s:13068
         3 000054   000105 710000 3                  TRA     s:13077

     3625    13048
     3626    13049    2       CASE(%XUG_CMD_DIR) ;

     3627    13050    2           CALL DIRECTORY_CMD ALTRET(BUILTIN_ERR) ;

  13050  3 000055   000146 701000 3                  TSX1    DIRECTORY_CMD
         3 000056   000127 702000 3                  TSX2    BUILTIN_ERR
         3 000057   000110 710000 3                  TRA     s:13082

     3628    13051
     3629    13052    2       CASE(%XUG_CMD_DO) ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:717  

     3630    13053    2           CALL DO_CMD ALTRET(ALTRET_FROM_BUILTIN) ;

  13053  3 000060   000635 701000 3                  TSX1    DO_CMD
         3 000061   000145 702000 3                  TSX2    ALTRET_FROM_BUILTIN

     3631    13054    2           RETURN;

  13054  3 000062   000000 702200 xent               TSX2  ! X66_ARET

     3632    13055
     3633    13056    2       CASE(%XUG_CMD_END) ;

     3634    13057    2           CALL END_CMD ;

  13057  3 000063   000442 701000 3                  TSX1    END_CMD
         3 000064   000000 011000                    NOP     0
         3 000065   000110 710000 3                  TRA     s:13082

     3635    13058
     3636    13059    2       CASE(%XUG_CMD_ERASE) ;

     3637    13060    2           CALL ERASE_CMD ALTRET(BUILTIN_ERR) ;

  13060  3 000066   001047 701000 3                  TSX1    ERASE_CMD
         3 000067   000127 702000 3                  TSX2    BUILTIN_ERR
         3 000070   000110 710000 3                  TRA     s:13082

     3638    13061
     3639    13062    2       CASE(%XUG_CMD_NULL) ;

     3640    13063
     3641    13064    2       CASE(%XUG_CMD_HELP, %XUG_CMD_Q1, %XUG_CMD_Q2) ;

     3642    13065    2           CALL HELP_CMD ALTRET(BUILTIN_ERR) ;

  13065  3 000071   001170 701000 3                  TSX1    HELP_CMD
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:718  
         3 000072   000127 702000 3                  TSX2    BUILTIN_ERR
         3 000073   000110 710000 3                  TRA     s:13082

     3643    13066
     3644    13067    2       CASE (%XUG_CMD_OUTPUT) ;

     3645    13068    2           CALL OUTPUT_CMD ALTRET (BUILTIN_ERR);

  13068  3 000074   001306 701000 3                  TSX1    OUTPUT_CMD
         3 000075   000127 702000 3                  TSX2    BUILTIN_ERR
         3 000076   000110 710000 3                  TRA     s:13082

     3646    13069
     3647    13070    2       CASE(%XUG_CMD_PRINT) ;

     3648    13071    2           CALL PRINT_CMD ALTRET(BUILTIN_ERR) ;

  13071  3 000077   001337 701000 3                  TSX1    PRINT_CMD
         3 000100   000127 702000 3                  TSX2    BUILTIN_ERR
         3 000101   000110 710000 3                  TRA     s:13082

     3649    13072
     3650    13073    2       CASE(%XUG_CMD_TIME) ;

     3651    13074    2           CALL TIME_DATE_CMD ALTRET(BUILTIN_ERR) ;

  13074  3 000102   001456 701000 3                  TSX1    TIME_DATE_CMD
         3 000103   000127 702000 3                  TSX2    BUILTIN_ERR
         3 000104   000110 710000 3                  TRA     s:13082

     3652    13075
     3653    13076    2       CASE(%XUG_CMD_ENTER);

     3654    13077    2           CALL ENTER_CMD ALTRET (ALTRET_FROM_BUILTIN);

  13077  3 000105   000460 701000 3                  TSX1    ENTER_CMD
         3 000106   000145 702000 3                  TSX2    ALTRET_FROM_BUILTIN
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:719  

     3655    13078    2           RETURN;

  13078  3 000107   000000 702200 xent               TSX2  ! X66_ARET

     3656    13079
     3657    13080    2       END ;                       /* Do Case */

     3658    13081
     3659    13082    1       IF XUG.POST_EXEC ~= ENTADDR(NIL)

  13082  3 000110   200005 470500                    LDP0    XUG$,,AUTO
         3 000111   000027 236100                    LDQ     23,,PR0
         3 000112   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 000113   000126 600000 3                  TZE     s:13086

     3660    13083    1       THEN
     3661    13084    1           CALL XUG.POST_EXEC (GETCMD, CODE) ALTRET(ALTRET_FROM_BUILTIN) ;

  13084  3 000114   200006 631500                    EPPR1   CODE,,AUTO
         3 000115   200365 451500                    STP1    @BOUND+2,,AUTO
         3 000116   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000117   200364 756100                    STQ     @BOUND+1,,AUTO
         3 000120   200364 630500                    EPPR0   @BOUND+1,,AUTO
         3 000121   200005 473500                    LDP3    XUG$,,AUTO
         3 000122   300027 220100                    LDX0    23,,PR3
         3 000123   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000124   000000 701010                    TSX1    0,X0
         3 000125   000145 702000 3                  TSX2    ALTRET_FROM_BUILTIN

     3662    13085
     3663    13086    1       RETURN ;

  13086  3 000126   000000 702200 xent               TSX2  ! X66_ARET

     3664    13087
     3665    13088    1   BUILTIN_ERR:
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:720  
     3666    13089
     3667    13090    1       IF XUG.POST_EXEC ~= ENTADDR(NIL)

  13090  3 000127   200005 470500       BUILTIN_ERR  LDP0    XUG$,,AUTO
         3 000130   000027 236100                    LDQ     23,,PR0
         3 000131   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 000132   000145 600000 3                  TZE     ALTRET_FROM_BUILTIN

     3668    13091    1       THEN
     3669    13092    1           CALL XUG.POST_EXEC (GETCMD, CODE);

  13092  3 000133   200006 631500                    EPPR1   CODE,,AUTO
         3 000134   200365 451500                    STP1    @BOUND+2,,AUTO
         3 000135   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000136   200364 756100                    STQ     @BOUND+1,,AUTO
         3 000137   200364 630500                    EPPR0   @BOUND+1,,AUTO
         3 000140   200005 473500                    LDP3    XUG$,,AUTO
         3 000141   300027 220100                    LDX0    23,,PR3
         3 000142   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000143   000000 701010                    TSX1    0,X0
         3 000144   000000 011000                    NOP     0

     3670    13093
     3671    13094    1   ALTRET_FROM_BUILTIN:
     3672    13095
     3673    13096    1       ALTRETURN ;

  13096  3 000145   000000 702200 xent  ALTRET_FROM* TSX2  ! X66_AALT

     3674    13097
     3675    13098        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:721  
     3676    13099    1   DIRECTORY_CMD: PROC ALTRET ;

  13099  3 000146   200352 741300       DIRECTORY_C* STX1  ! FID_RESULTS+10,,AUTO

     3677    13100        /**/
     3678    13101        /*
     3679    13102              ***** No options after command indicates directory info. is to be
     3680    13103                    displayed.
     3681    13104        */
     3682    13105    2       IF BLK$->P$B.NSUBLKS=0

  13105  3 000147   200054 470500                    LDP0    BLK$,,AUTO
         3 000150   000001 220100                    LDX0    1,,PR0
         3 000151   000242 601000 3                  TNZ     s:13130

     3683    13106    2       THEN
     3684    13107    3       DO ;

     3685    13108    3           OUTBUFF = '  Directory: ' ;

  13108  3 000152   040100 100400                    MLR     fill='040'O
         3 000153   000200 000015 2                  ADSC9   XT#CANT_ADAPT+1          cn=0,n=13
         3 000154   200010 000120                    ADSC9   OUTBUFF,,AUTO            cn=0,n=80

     3686    13109    3           CNT = 13 ;

  13109  3 000155   000015 235007                    LDA     13,DL
         3 000156   200056 755100                    STA     CNT,,AUTO

     3687    13110    3           CALL INDEX(TSTOR,' ',B$JIT.FPSN) ;

  13110  3 000157   000000 471400 xsym               LDP1    B$JIT$
         3 000160   000000 124500                    SCM     mask='000'O
         3 000161   100021 000006                    ADSC9   17,,PR1                  cn=0,n=6
         3 000162   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000163   200057 000100                    ARG     TSTOR,,AUTO

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:722  
     3688    13111    3           IF TSTOR>0

  13111  3 000164   200057 236100                    LDQ     TSTOR,,AUTO
         3 000165   000205 604400 3                  TMOZ    s:13120

     3689    13112    3           THEN
     3690    13113    4           DO ;

     3691    13114    4               CALL INSERT(OUTBUFF, CNT, 3+TSTOR, 'DP#', B$JIT.FPSN) ;

  13114  3 000166   000003 620006                    EAX0    3,QL
         3 000167   040145 100400                    MLR     fill='040'O
         3 000170   000204 000003 2                  ADSC9   XT#CANT_ADAPT+5          cn=0,n=3
         3 000171   200010 000010                    ADSC9   OUTBUFF,A,AUTO           cn=0,n=*X0
         3 000172   000000 116003                    CMPQ    0,DU
         3 000173   000201 604400 3                  TMOZ    s:13115
         3 000174   000000 621006                    EAX1    0,QL
         3 000175   200056 236100                    LDQ     CNT,,AUTO
         3 000176   040146 100500                    MLR     fill='040'O
         3 000177   100021 000006                    ADSC9   17,,PR1                  cn=0,n=6
         3 000200   200010 600011                    ADSC9   OUTBUFF,Q,AUTO           cn=3,n=*X1

     3692    13115    4               CNT = CNT + 3 + TSTOR ;

  13115  3 000201   200056 236100                    LDQ     CNT,,AUTO
         3 000202   200057 036100                    ADLQ    TSTOR,,AUTO
         3 000203   000003 036007                    ADLQ    3,DL
         3 000204   200056 756100                    STQ     CNT,,AUTO

     3693    13116    4           END ;                     /* Then Do */

     3694    13117        /*
     3695    13118          *****  Insert the account.
     3696    13119        */
     3697    13120    3           CALL CONCAT(TEMPBUFF, '.', B$JIT.FACCN,' ') ;

  13120  3 000205   056000 236003                    LDQ     23552,DU
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:723  
         3 000206   200036 756100                    STQ     TEMPBUFF,,AUTO
         3 000207   040100 100500                    MLR     fill='040'O
         3 000210   100006 000010                    ADSC9   6,,PR1                   cn=0,n=8
         3 000211   200036 200010                    ADSC9   TEMPBUFF,,AUTO           cn=1,n=8
         3 000212   040100 100400                    MLR     fill='040'O
         3 000213   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000214   200040 200057                    ADSC9   TEMPBUFF+2,,AUTO         cn=1,n=47

     3698    13121    3           CALL INDEX(TSTOR,' ',TEMPBUFF) ;

  13121  3 000215   000000 124500                    SCM     mask='000'O
         3 000216   200036 000070                    ADSC9   TEMPBUFF,,AUTO           cn=0,n=56
         3 000217   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000220   200057 000100                    ARG     TSTOR,,AUTO

     3699    13122    3           CALL INSERT(OUTBUFF, CNT, ,SUBSTR(TEMPBUFF,0,TSTOR)) ;

  13122  3 000221   200056 720100                    LXL0    CNT,,AUTO
         3 000222   777657 620010                    EAX0    -81,X0
         3 000223   777777 660003                    ERX0    -1,DU
         3 000224   200057 721100                    LXL1    TSTOR,,AUTO
         3 000225   200056 235100                    LDA     CNT,,AUTO
         3 000226   040145 100540                    MLR     fill='040'O
         3 000227   200036 000011                    ADSC9   TEMPBUFF,,AUTO           cn=0,n=*X1
         3 000230   200010 000010                    ADSC9   OUTBUFF,A,AUTO           cn=0,n=*X0

     3700    13123    3           CNT = CNT + TSTOR ;

  13123  3 000231   200056 236100                    LDQ     CNT,,AUTO
         3 000232   200057 036100                    ADLQ    TSTOR,,AUTO
         3 000233   200056 756100                    STQ     CNT,,AUTO

     3701    13124    3           CALL OUTPUT_MESSAGE(CNT) ALTRET(DIR_ERR) ;

  13124  3 000234   200056 630500                    EPPR0   CNT,,AUTO
         3 000235   200363 450500                    STP0    TMDATE+8,,AUTO
         3 000236   001540 701000 3                  TSX1    OUTPUT_MESSAGE
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:724  
         3 000237   000421 702000 3                  TSX2    DIR_ERR

     3702    13125    3           RETURN ;

  13125  3 000240   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000241   000001 702211                    TSX2  ! 1,X1

     3703    13126    3       END ;                        /* Then Do */
     3704    13127        /*
     3705    13128           *****  Set or Reset directory information in JIT.
     3706    13129        */
     3707    13130    2       FPT_SETFMA = FPT_SETFMA_C ;

  13130  3 000242   000100 100400                    MLR     fill='000'O
         3 000243   000076 000020 2                  ADSC9   FPT_SETFMA_C             cn=0,n=16
         3 000244   200116 000020                    ADSC9   FPT_SETFMA,,AUTO         cn=0,n=16

     3708    13131    3       DO CASE(BLK$->P$B.SUBLK$(0)->P$B.CODE) ;

  13131  3 000245   000003 471500                    LDP1    3,,PR0
         3 000246   100000 236100                    LDQ     0,,PR1
         3 000247   777777 376007                    ANQ     -1,DL
         3 000250   000014 136007                    SBLQ    12,DL
         3 000251   000001 116007                    CMPQ    1,DL
         3 000252   000254 602006 3                  TNC     s:13131+7,QL
         3 000253   000413 710000 3                  TRA     s:13172
         3 000254   000255 710000 3                  TRA     s:13138

     3709    13132
     3710    13133    3       CASE(%XUG_CMD_DIR_RESET) ;

     3711    13134        /*
     3712    13135          *****   NOTE: No code required since default fpt is what is required.
     3713    13136        */
     3714    13137    3       CASE(%XUG_CMD_DIR_FID) ;

     3715    13138    3           FPT_FID = FPT_FID_C ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:725  

  13138  3 000255   000100 100400                    MLR     fill='000'O
         3 000256   000102 000140 2                  ADSC9   FPT_FID_C                cn=0,n=96
         3 000257   200122 000140                    ADSC9   FPT_FID,,AUTO            cn=0,n=96

     3716    13139    3           FPT_FID.V_ = VECTOR(FPT_FID.V) ;

  13139  3 000260   000000 235000 4                  LDA     0
         3 000261   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000262   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000263   000146 036003                    ADLQ    102,DU
         3 000264   200122 757100                    STAQ    FPT_FID,,AUTO

     3717    13140    3           FPT_FID.TEXTFID_=VECTOR(BLK$->P$B.SUBLK$(0)->

  13140  3 000265   000003 471500                    LDP1    3,,PR0
         3 000266   100004 236100                    LDQ     4,,PR1
         3 000267   000033 772000                    QRL     27
         3 000270   000064 737000                    LLS     52
         3 000271   000140 135007                    SBLA    96,DL
         3 000272   200364 451500                    STP1    @BOUND+1,,AUTO
         3 000273   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000274   000001 036000 4                  ADLQ    1
         3 000275   200124 757100                    STAQ    FPT_FID+2,,AUTO

     3718    13141    3             P$S.TEXT) ;
     3719    13142    3           FPT_FID.NAME_ = VECTOR(VLP_NAME) ;

  13142  3 000276   000002 235000 4                  LDA     2
         3 000277   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000300   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000301   000212 036003                    ADLQ    138,DU
         3 000302   200126 757100                    STAQ    FPT_FID+4,,AUTO

     3720    13143    3           FPT_FID.ACCT_ = VECTOR(VLP_ACCT) ;

  13143  3 000303   000003 235000 4                  LDA     3
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:726  
         3 000304   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000305   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000306   000222 036003                    ADLQ    146,DU
         3 000307   200130 757100                    STAQ    FPT_FID+6,,AUTO

     3721    13144    3           FPT_FID.PASS_ = VECTOR(VLP_ACCT) ;

  13144  3 000310   000003 235000 4                  LDA     3
         3 000311   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000312   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000313   000222 036003                    ADLQ    146,DU
         3 000314   200132 757100                    STAQ    FPT_FID+8,,AUTO

     3722    13145    3           FPT_FID.SN_ = VECTOR(VLP_SN) ;

  13145  3 000315   000004 235000 4                  LDA     4
         3 000316   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000317   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000320   000224 036003                    ADLQ    148,DU
         3 000321   200134 757100                    STAQ    FPT_FID+10,,AUTO

     3723    13146    3           FPT_FID.WSN_ = VECTOR(VLP_ACCT) ;

  13146  3 000322   000003 235000 4                  LDA     3
         3 000323   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000324   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000325   000222 036003                    ADLQ    146,DU
         3 000326   200136 757100                    STAQ    FPT_FID+12,,AUTO

     3724    13147    3           FPT_FID.ASN_ = VECTOR(ASN) ;

  13147  3 000327   777640 235007                    LDA     -96,DL
         3 000330   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000331   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000332   000007 036003                    ADLQ    7,DU
         3 000333   200140 757100                    STAQ    FPT_FID+14,,AUTO

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:727  
     3725    13148    3           FPT_FID.RES_ = VECTOR(TBUFF) ;

  13148  3 000334   000003 235000 4                  LDA     3
         3 000335   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000336   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000337   000034 036003                    ADLQ    28,DU
         3 000340   200142 757100                    STAQ    FPT_FID+16,,AUTO

     3726    13149    3           FPT_FID.RESULTS_ = VECTOR(FID_RESULTS) ;

  13149  3 000341   000005 235000 4                  LDA     5
         3 000342   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000343   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000344   000340 036003                    ADLQ    224,DU
         3 000345   200144 757100                    STAQ    FPT_FID+18,,AUTO

     3727    13150    3           CALL M$FID(FPT_FID) ALTRET(DIR_ERR) ;

  13150  3 000346   200122 630500                    EPPR0   FPT_FID,,AUTO
         3 000347   420001 713400                    CLIMB   alt,+8193
         3 000350   404400 401760                    pmme    nvectors=10
         3 000351   000421 702000 3                  TSX2    DIR_ERR

     3728    13151        /*
     3729    13152          *****   Make sure the FID was legal.
     3730    13153        */
     3731    13154    3           IF FID_RESULTS.ACCT = %NO# OR VLP_ACCT.ACCT# = ' ' OR ASN ~= %FILE#

  13154  3 000352   200340 236100                    LDQ     FID_RESULTS,,AUTO
         3 000353   200000 316003                    CANQ    65536,DU
         3 000354   000430 600000 3                  TZE     FID_ERR
         3 000355   200222 237100                    LDAQ    VLP_ACCT,,AUTO
         3 000356   000006 117000 4                  CMPAQ   6
         3 000357   000430 600000 3                  TZE     FID_ERR
         3 000360   200007 236100                    LDQ     ASN,,AUTO
         3 000361   777000 376003                    ANQ     -512,DU
         3 000362   001000 116003                    CMPQ    512,DU
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:728  
         3 000363   000430 601000 3                  TNZ     FID_ERR

     3732    13155    3           THEN
     3733    13156    3               GOTO FID_ERR ;
     3734    13157    3           IF FID_RESULTS.NAME = %YES# OR FID_RESULTS.PASS = %YES# OR

  13157  3 000364   200340 234100                    SZN     FID_RESULTS,,AUTO
         3 000365   000430 604000 3                  TMI     FID_ERR
         3 000366   200340 236100                    LDQ     FID_RESULTS,,AUTO
         3 000367   100000 316003                    CANQ    32768,DU
         3 000370   000430 601000 3                  TNZ     FID_ERR
         3 000371   020000 316003                    CANQ    8192,DU
         3 000372   000430 601000 3                  TNZ     FID_ERR

     3735    13158    3             FID_RESULTS.WSN = %YES#
     3736    13159    3           THEN
     3737    13160    3               GOTO FID_ERR ;
     3738    13161    3           IF VLP_SN.NUM# > 1

  13161  3 000373   200224 235100                    LDA     VLP_SN,,AUTO
         3 000374   000001 115007                    CMPA    1,DL
         3 000375   000430 605400 3                  TPNZ    FID_ERR

     3739    13162    3           THEN
     3740    13163    3               GOTO FID_ERR ;
     3741    13164        /*
     3742    13165          *****   Determine if DP#NN.ACCT or .ACCT spec'd
     3743    13166        */
     3744    13167    3           FPT_SETFMA.ACCT_ = VECTOR(VLP_ACCT) ;

  13167  3 000376   000003 235000 4                  LDA     3
         3 000377   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000400   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000401   000222 036003                    ADLQ    146,DU
         3 000402   200116 757100                    STAQ    FPT_SETFMA,,AUTO

     3745    13168    3           IF FID_RESULTS.SN
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:729  

  13168  3 000403   200340 236100                    LDQ     FID_RESULTS,,AUTO
         3 000404   040000 316003                    CANQ    16384,DU
         3 000405   000413 600000 3                  TZE     s:13172

     3746    13169    3           THEN                         /* Sn specified as well */
     3747    13170    3               FPT_SETFMA.PSN_ = VECTOR(VLP_SN.SN#) ;

  13170  3 000406   000010 235000 4                  LDA     8
         3 000407   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000410   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000411   000225 036003                    ADLQ    149,DU
         3 000412   200120 757100                    STAQ    FPT_SETFMA+2,,AUTO

     3748    13171    3       END ;                          /* Do Case */

     3749    13172    2       CALL M$SETFMA (FPT_SETFMA) ALTRET(DIR_ERR) ;

  13172  3 000413   200116 630500                    EPPR0   FPT_SETFMA,,AUTO
         3 000414   460001 713400                    CLIMB   alt,+24577
         3 000415   400400 401760                    pmme    nvectors=2
         3 000416   000421 702000 3                  TSX2    DIR_ERR

     3750    13173    2       RETURN ;

  13173  3 000417   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000420   000001 702211                    TSX2  ! 1,X1

     3751    13174    2   DIR_ERR:
     3752    13175    2       GETCMD.ERR# = B$TCB.ALT$ ->B$EXCFR.ERR ;

  13175  3 000421   000000 470400 xsym  DIR_ERR      LDP0    B$TCB$
         3 000422   000000 471500                    LDP1    0,,PR0
         3 000423   100102 236100                    LDQ     66,,PR1
         3 000424   200003 473500                    LDP3    @GETCMD,,AUTO
         3 000425   300001 756100                    STQ     1,,PR3

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:730  
     3753    13176    2       ALTRETURN ;

  13176  3 000426   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000427   000000 702211                    TSX2  ! 0,X1

     3754    13177    2   FID_ERR:
     3755    13178    2       GETCMD.ERR# = XUG#BDIRFID ;

  13178  3 000430   000172 236000 2     FID_ERR      LDQ     XUG#BDIRFID
         3 000431   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000432   000001 756100                    STQ     1,,PR0

     3756    13179    2       GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(0)->P$B.CPOS ;

  13179  3 000433   000003 471500                    LDP1    3,,PR0
         3 000434   200054 473500                    LDP3    BLK$,,AUTO
         3 000435   300003 474500                    LDP4    3,,PR3
         3 000436   400002 235100                    LDA     2,,PR4
         3 000437   100012 755100                    STA     10,,PR1

     3757    13180    2       ALTRETURN ;

  13180  3 000440   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000441   000000 702211                    TSX2  ! 0,X1

     3758    13181        /*E*  ERROR:  XUG-E$XUG#BDIRFID
     3759    13182              MESSAGE0: FID may only consist of DP#SN.ACCOUNT or .ACCOUNT.
     3760    13183        */
     3761    13184
     3762    13185    2   END     DIRECTORY_CMD ;
     3763    13186        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:731  
     3764    13187    1   END_CMD: PROC ;

  13187  3 000442   200352 741300       END_CMD      STX1  ! FID_RESULTS+10,,AUTO

     3765    13188
     3766    13189    2       FPT_EXIT = FPT_EXIT_C ;

  13189  3 000443   000100 100400                    MLR     fill='000'O
         3 000444   000044 000030 2                  ADSC9   FPT_EXIT_C               cn=0,n=24
         3 000445   200062 000030                    ADSC9   FPT_EXIT,,AUTO           cn=0,n=24

     3767    13190    2       FPT_EXIT.V_ = VECTOR(FPT_EXIT.V) ;

  13190  3 000446   000003 235000 4                  LDA     3
         3 000447   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000450   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000451   000066 036003                    ADLQ    54,DU
         3 000452   200062 757100                    STAQ    FPT_EXIT,,AUTO

     3768    13191    2       CALL M$EXIT (FPT_EXIT) ;

  13191  3 000453   200062 630500                    EPPR0   FPT_EXIT,,AUTO
         3 000454   000001 713400                    CLIMB   exit
         3 000455   400400 401760                    pmme    nvectors=2

     3769    13192
     3770    13193    2   END     END_CMD ;

  13193  3 000456   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000457   000001 702211                    TSX2  ! 1,X1

     3771    13194        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:732  
     3772    13195    1   ENTER_CMD: PROC ALTRET;

  13195  3 000460   200352 741300       ENTER_CMD    STX1  ! FID_RESULTS+10,,AUTO

     3773    13196
     3774    13197    2   DCL I SBIN;
     3775    13198
     3776    13199    2       IF GETCMD.XT_PARAM$ = ADDR(NIL)

  13199  3 000461   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000462   000036 236100                    LDQ     30,,PR0
         3 000463   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000464   000540 601000 3                  TNZ     s:13225

     3777    13200    3       THEN DO;

     3778    13201    3           XT$ = PINCRW(XUG$, SIZEW(XUG) + SIZEW(P$PCB));

  13201  3 000465   200005 236100                    LDQ     XUG$,,AUTO
         3 000466   000432 036003                    ADLQ    282,DU
         3 000467   200055 756100                    STQ     XT$,,AUTO

     3779    13202    3           XT_PARAM = XT_PARAM_C;

  13202  3 000470   200055 471500                    LDP1    XT$,,AUTO
         3 000471   000100 100400                    MLR     fill='000'O
         3 000472   000000 000200 2                  ADSC9   XT_PARAM_C               cn=0,n=128
         3 000473   100000 000200                    ADSC9   0,,PR1                   cn=0,n=128

     3780    13203    3           XT_PARAM.XUG$ = XUG$ ;

  13203  3 000474   200005 236100                    LDQ     XUG$,,AUTO
         3 000475   100015 756100                    STQ     13,,PR1

     3781    13204    3           XT_PARAM.USER$ = ADDR(GETCMD);

  13204  3 000476   200003 236100                    LDQ     @GETCMD,,AUTO
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:733  
         3 000477   100022 756100                    STQ     18,,PR1

     3782    13205    3           GETCMD.XT_PARAM$ = XT$;

  13205  3 000500   200055 236100                    LDQ     XT$,,AUTO
         3 000501   000036 756100                    STQ     30,,PR0

     3783    13206    3           XT_PARAM.INDCB = GETCMD.INDCB# ;

  13206  3 000502   000012 235100                    LDA     10,,PR0
         3 000503   100004 755100                    STA     4,,PR1

     3784    13207    3           XT_PARAM.OUTDCB = GETCMD.OUTDCB# ;

  13207  3 000504   000013 235100                    LDA     11,,PR0
         3 000505   100003 755100                    STA     3,,PR1

     3785    13208
     3786    13209    3           CALL XUG.ADAPT$$ (XT_PARAM, %XT#RESTART)

  13209  3 000506   000011 236000 4                  LDQ     9
         3 000507   200055 235100                    LDA     XT$,,AUTO
         3 000510   200364 757100                    STAQ    @BOUND+1,,AUTO
         3 000511   200364 630500                    EPPR0   @BOUND+1,,AUTO
         3 000512   200005 473500                    LDP3    XUG$,,AUTO
         3 000513   300270 220100                    LDX0    184,,PR3
         3 000514   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000515   000000 701010                    TSX1    0,X0
         3 000516   000520 702000 3                  TSX2    s:13211
         3 000517   000540 710000 3                  TRA     s:13225

     3787    13210    4           WHENALTRETURN DO;

     3788    13211    4               XUG.ADAPT$$ = ENTADDR(NIL);

  13211  3 000520   000002 236000 xsym               LDQ     B_VECTNIL+2
         3 000521   200005 470500                    LDP0    XUG$,,AUTO
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:734  
         3 000522   000270 756100                    STQ     184,,PR0

     3789    13212    4               GETCMD.XT_PARAM$ = ADDR(NIL);

  13212  3 000523   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000524   200003 471500                    LDP1    @GETCMD,,AUTO
         3 000525   100036 756100                    STQ     30,,PR1

     3790    13213    4               IF XT_PARAM.ERR = XT#CANT_ADAPT

  13213  3 000526   200055 473500                    LDP3    XT$,,AUTO
         3 000527   300001 236100                    LDQ     1,,PR3
         3 000530   000177 116000 2                  CMPQ    XT#CANT_ADAPT
         3 000531   000535 601000 3                  TNZ     s:13215

     3791    13214    4               THEN GETCMD.ERR# = XUG#NO_ADAPT ;

  13214  3 000532   000176 236000 2                  LDQ     XUG#NO_ADAPT
         3 000533   100001 756100                    STQ     1,,PR1
         3 000534   000536 710000 3                  TRA     s:13216

     3792    13215    4               ELSE GETCMD.ERR# = XT_PARAM.ERR ;

  13215  3 000535   100001 756100                    STQ     1,,PR1

     3793    13216    4               ALTRETURN;

  13216  3 000536   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000537   000000 702211                    TSX2  ! 0,X1

     3794    13217    4           END;
     3795    13218    3       END;

     3796    13219        /*E*  ERROR:   XUG-E$XUG#NO_ADAPT-0
     3797    13220              MESSAGE: The ADAPT dialog manager is not available.
     3798    13221              MESSAGE1: The ENTER command cannot be used because the Alternate Shared
     3799    13222                        Library (ADAPT_ASL) for the dialog manager is not installed.
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:735  
     3800    13223        */
     3801    13224
     3802    13225    2       XT$ = GETCMD.XT_PARAM$;

  13225  3 000540   200003 470500                    LDP0    @GETCMD,,AUTO
         3 000541   000036 236100                    LDQ     30,,PR0
         3 000542   200055 756100                    STQ     XT$,,AUTO

     3803    13226    2       XT_PARAM.SCRIPT.PT$ = ADDR(NIL);

  13226  3 000543   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000544   200055 471500                    LDP1    XT$,,AUTO
         3 000545   100010 756100                    STQ     8,,PR1

     3804    13227    2       XT_PARAM.FRAME.PT$ = ADDR(NIL);

  13227  3 000546   100012 756100                    STQ     10,,PR1

     3805    13228    2       XT_PARAM.IBUF.PT$ = ADDR(NIL);

  13228  3 000547   100016 756100                    STQ     14,,PR1

     3806    13229    2       XT_PARAM.SCRIPT.LEN = 0 ;

  13229  3 000550   100011 450100                    STZ     9,,PR1

     3807    13230    2       XT_PARAM.FRAME.LEN = 0 ;

  13230  3 000551   100013 450100                    STZ     11,,PR1

     3808    13231    2       XT_PARAM.IBUF.LEN = 0 ;

  13231  3 000552   100017 450100                    STZ     15,,PR1

     3809    13232
     3810    13233    3       DO I = 0 TO BLK$ -> P$B.NSUBLKS - 1;

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:736  
  13233  3 000553   200353 450100                    STZ     I,,AUTO
         3 000554   000607 710000 3                  TRA     s:13248+1

     3811    13234
     3812    13235    4           DO CASE (BLK$ -> P$B.SUBLK$(I) -> P$B.CODE);

  13235  3 000555   200054 470500                    LDP0    BLK$,,AUTO
         3 000556   200353 720100                    LXL0    I,,AUTO
         3 000557   000003 471510                    LDP1    3,X0,PR0
         3 000560   100000 721100                    LXL1    0,,PR1
         3 000561   000004 101003                    CMPX1   4,DU
         3 000562   000564 602011 3                  TNC     s:13235+7,X1
         3 000563   000606 710000 3                  TRA     s:13248
         3 000564   000606 710000 3                  TRA     s:13248
         3 000565   000570 710000 3                  TRA     s:13238
         3 000566   000574 710000 3                  TRA     s:13240
         3 000567   000600 710000 3                  TRA     s:13242

     3813    13236
     3814    13237    4           CASE (%XUG_SCRIPTFID);

     3815    13238    4               XT_PARAM.SCRIPT.PT$ = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXTC$;

  13238  3 000570   100003 236100                    LDQ     3,,PR1
         3 000571   200055 473500                    LDP3    XT$,,AUTO
         3 000572   300010 756100                    STQ     8,,PR3
         3 000573   000606 710000 3                  TRA     s:13248

     3816    13239    4           CASE (%XUG_FRAMENAME);

     3817    13240    4               XT_PARAM.FRAME.PT$ = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXTC$;

  13240  3 000574   100003 236100                    LDQ     3,,PR1
         3 000575   200055 473500                    LDP3    XT$,,AUTO
         3 000576   300012 756100                    STQ     10,,PR3
         3 000577   000606 710000 3                  TRA     s:13248

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:737  
     3818    13241    4           CASE (%XUG_TEXT);

     3819    13242    4               IF BLK$-> P$B.SUBLK$(I)-> P$S.COUNT > 0

  13242  3 000600   100004 236100                    LDQ     4,,PR1
         3 000601   777000 316003                    CANQ    -512,DU
         3 000602   000606 600000 3                  TZE     s:13248

     3820    13243    4               THEN
     3821    13244    4                   XT_PARAM.IBUF.PT$ = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXTC$;

  13244  3 000603   100003 236100                    LDQ     3,,PR1
         3 000604   200055 473500                    LDP3    XT$,,AUTO
         3 000605   300016 756100                    STQ     14,,PR3

     3822    13245
     3823    13246    4           END;

     3824    13247
     3825    13248    3       END;

  13248  3 000606   200353 054100                    AOS     I,,AUTO
         3 000607   200054 470500                    LDP0    BLK$,,AUTO
         3 000610   000001 236100                    LDQ     1,,PR0
         3 000611   000022 772000                    QRL     18
         3 000612   200353 116100                    CMPQ    I,,AUTO
         3 000613   000555 605400 3                  TPNZ    s:13235

     3826    13249
     3827    13250    2       CALL XUG.ADAPT$$ (XT_PARAM, %XT#ENTER)

  13250  3 000614   000012 236000 4                  LDQ     10
         3 000615   200055 235100                    LDA     XT$,,AUTO
         3 000616   200364 757100                    STAQ    @BOUND+1,,AUTO
         3 000617   200364 630500                    EPPR0   @BOUND+1,,AUTO
         3 000620   200005 471500                    LDP1    XUG$,,AUTO
         3 000621   100270 220100                    LDX0    184,,PR1
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:738  
         3 000622   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000623   000000 701010                    TSX1    0,X0
         3 000624   000627 702000 3                  TSX2    s:13255

     3828    13251    3       WHENRETURN DO;

     3829    13252    3           RETURN;

  13252  3 000625   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000626   000001 702211                    TSX2  ! 1,X1

     3830    13253    3       END;
     3831    13254    3       WHENALTRETURN DO;

     3832    13255    3           GETCMD.ERR# = XT_PARAM.ERR;

  13255  3 000627   200055 470500                    LDP0    XT$,,AUTO
         3 000630   000001 236100                    LDQ     1,,PR0
         3 000631   200003 471500                    LDP1    @GETCMD,,AUTO
         3 000632   100001 756100                    STQ     1,,PR1

     3833    13256    3           ALTRETURN;

  13256  3 000633   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000634   000000 702211                    TSX2  ! 0,X1

     3834    13257    3       END;
     3835    13258
     3836    13259    2   END ENTER_CMD;
     3837    13260
     3838    13261        %EJECT;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:739  
     3839    13262    1   DO_CMD: PROC ALTRET ;

  13262  3 000635   200352 741300       DO_CMD       STX1  ! FID_RESULTS+10,,AUTO

     3840    13263
     3841    13264    2   DCL POST_EXEC EPTR;
     3842    13265
     3843    13266    2       POST_EXEC = XUG.POST_EXEC;

  13266  3 000636   200005 470500                    LDP0    XUG$,,AUTO
         3 000637   000027 236100                    LDQ     23,,PR0
         3 000640   200353 756100                    STQ     POST_EXEC,,AUTO

     3844    13267    2       IF BLK$->P$B.SUBLK$(0)->P$S.COUNT = 0

  13267  3 000641   200054 471500                    LDP1    BLK$,,AUTO
         3 000642   100003 473500                    LDP3    3,,PR1
         3 000643   300004 236100                    LDQ     4,,PR3
         3 000644   777000 316003                    CANQ    -512,DU
         3 000645   000647 601000 3                  TNZ     s:13270

     3845    13268    2       THEN
     3846    13269    2           RETURN ;

  13269  3 000646   000001 702211                    TSX2  ! 1,X1

     3847    13270    2       IF BLK$->P$B.SUBLK$(0)->P$S.COUNT > 256

  13270  3 000647   300004 236100                    LDQ     4,,PR3
         3 000650   777000 376003                    ANQ     -512,DU
         3 000651   401000 116003                    CMPQ    -130560,DU
         3 000652   000665 602000 3                  TNC     s:13281

     3848    13271    2       THEN
     3849    13272    3       DO ;

     3850    13273    3           GETCMD.ERR# = XUG#DOCMD2BIG ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:740  

  13273  3 000653   000173 236000 2                  LDQ     XUG#DOCMD2BIG
         3 000654   200003 474500                    LDP4    @GETCMD,,AUTO
         3 000655   400001 756100                    STQ     1,,PR4

     3851    13274    3           GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(0)->P$S.CPOS+256 ;

  13274  3 000656   400003 473500                    LDP3    3,,PR4
         3 000657   100003 475500                    LDP5    3,,PR1
         3 000660   500002 235100                    LDA     2,,PR5
         3 000661   000400 035007                    ADLA    256,DL
         3 000662   300012 755100                    STA     10,,PR3

     3852    13275    3           ALTRETURN;

  13275  3 000663   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000664   000000 702211                    TSX2  ! 0,X1

     3853    13276    3       END ;                        /* Then Do */
     3854    13277        /*E*  ERROR:  XUG-E$XUG#DOCMD2BIG
     3855    13278              MESSAGE0: DO command too big.
     3856    13279              MESSAGE1: The DO command can be at most 256 characters long.
     3857    13280        */
     3858    13281    2       FPT_YC = FPT_YC_C ;

  13281  3 000665   000100 100400                    MLR     fill='000'O
         3 000666   000052 000040 2                  ADSC9   FPT_YC_C                 cn=0,n=32
         3 000667   200070 000040                    ADSC9   FPT_YC,,AUTO             cn=0,n=32

     3859    13282    2       FPT_YC.V_ = VECTOR(FPT_YC.V) ;

  13282  3 000670   000003 235000 4                  LDA     3
         3 000671   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000672   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000673   000076 036003                    ADLQ    62,DU
         3 000674   200072 757100                    STAQ    FPT_YC+2,,AUTO

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:741  
     3860    13283    2       FPT_YC.CMD_ = VECTOR(BLK$->P$B.SUBLK$(0)->P$S.TEXT) ;

  13283  3 000675   100003 473500                    LDP3    3,,PR1
         3 000676   300004 236100                    LDQ     4,,PR3
         3 000677   000033 772000                    QRL     27
         3 000700   000064 737000                    LLS     52
         3 000701   000140 135007                    SBLA    96,DL
         3 000702   200364 453500                    STP3    @BOUND+1,,AUTO
         3 000703   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000704   000001 036000 4                  ADLQ    1
         3 000705   200070 757100                    STAQ    FPT_YC,,AUTO

     3861    13284    2       FPT_YC.REPLY_ = VECTOR(VLR_YC) ;

  13284  3 000706   000003 235000 4                  LDA     3
         3 000707   200364 452500                    STP2    @BOUND+1,,AUTO
         3 000710   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 000711   000100 036003                    ADLQ    64,DU
         3 000712   200074 757100                    STAQ    FPT_YC+4,,AUTO

     3862    13285    2       FPT_YC.V.LINK# = %YES# ;

  13285  3 000713   100000 236003                    LDQ     32768,DU
         3 000714   200076 256100                    ORSQ    FPT_YC+6,,AUTO

     3863    13286    2       IF XUG.DOCMD_SYNERR

  13286  3 000715   000071 236100                    LDQ     57,,PR0
         3 000716   000100 316003                    CANQ    64,DU
         3 000717   000723 600000 3                  TZE     s:13290

     3864    13287    2       THEN
     3865    13288    2           FPT_YC.V.REPARSE# = %YES# ;

  13288  3 000720   040000 236003                    LDQ     16384,DU
         3 000721   200076 256100                    ORSQ    FPT_YC+6,,AUTO
         3 000722   000725 710000 3                  TRA     s:13291
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:742  

     3866    13289    2       ELSE
     3867    13290    2           FPT_YC.V.REPARSE# = %NO# ;

  13290  3 000723   000013 236000 4                  LDQ     11
         3 000724   200076 356100                    ANSQ    FPT_YC+6,,AUTO

     3868    13291    2       XUG.DOCMD_SYNERR = %NO# ;

  13291  3 000725   000014 236000 4                  LDQ     12
         3 000726   000071 356100                    ANSQ    57,,PR0

     3869    13292    2       CALL M$YC (FPT_YC) ALTRET(M$YC_ERR) ;

  13292  3 000727   200070 630500                    EPPR0   FPT_YC,,AUTO
         3 000730   400011 713400                    CLIMB   alt,+9
         3 000731   401000 401760                    pmme    nvectors=3
         3 000732   000751 702000 3                  TSX2    M$YC_ERR

     3870    13293        /*
     3871    13294            Special handling of POST_EXEC routine is needed after linking to
     3872    13295            another program, because memory allocation by that program
     3873    13296            (notably COMMON) will require argument stack descriptors
     3874    13297            to be reloaded by programs that use them (notably APL).
     3875    13298        */
     3876    13299    2       IF POST_EXEC ~= ENTADDR(NIL)

  13299  3 000733   200353 236100                    LDQ     POST_EXEC,,AUTO
         3 000734   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 000735   000747 600000 3                  TZE     s:13302

     3877    13300    2       THEN
     3878    13301    2           CALL POST_EXEC (GETCMD,CODE) ALTRET(ALT);

  13301  3 000736   200006 630500                    EPPR0   CODE,,AUTO
         3 000737   200365 450500                    STP0    @BOUND+2,,AUTO
         3 000740   200003 236100                    LDQ     @GETCMD,,AUTO
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:743  
         3 000741   200364 756100                    STQ     @BOUND+1,,AUTO
         3 000742   200364 630500                    EPPR0   @BOUND+1,,AUTO
         3 000743   200353 220100                    LDX0    POST_EXEC,,AUTO
         3 000744   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000745   000000 701010                    TSX1    0,X0
         3 000746   001045 702000 3                  TSX2    ALT

     3879    13302    2       RETURN;

  13302  3 000747   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 000750   000001 702211                    TSX2  ! 1,X1

     3880    13303    2   M$YC_ERR:
     3881    13304    2       ERR = B$TCB.ALT$ -> B$EXCFR.ERR ;

  13304  3 000751   000000 470400 xsym  M$YC_ERR     LDP0    B$TCB$
         3 000752   000000 471500                    LDP1    0,,PR0
         3 000753   100102 236100                    LDQ     66,,PR1
         3 000754   200004 756100                    STQ     ERR,,AUTO

     3882    13305    2       IF POST_EXEC ~= ENTADDR(NIL)

  13305  3 000755   200353 236100                    LDQ     POST_EXEC,,AUTO
         3 000756   000002 116000 xsym               CMPQ    B_VECTNIL+2
         3 000757   000771 600000 3                  TZE     s:13308

     3883    13306    2       THEN
     3884    13307    2           CALL POST_EXEC (GETCMD,CODE);

  13307  3 000760   200006 633500                    EPPR3   CODE,,AUTO
         3 000761   200365 453500                    STP3    @BOUND+2,,AUTO
         3 000762   200003 236100                    LDQ     @GETCMD,,AUTO
         3 000763   200364 756100                    STQ     @BOUND+1,,AUTO
         3 000764   200364 630500                    EPPR0   @BOUND+1,,AUTO
         3 000765   200353 220100                    LDX0    POST_EXEC,,AUTO
         3 000766   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000767   000000 701010                    TSX1    0,X0
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:744  
         3 000770   000000 011000                    NOP     0

     3885    13308    2       IF B$JIT.CPFLAGS1 & %CP_EXIT#
             13308                /* callee M$EXIT/M$ERR/M$XXX with CODE=something */

  13308  3 000771   000000 470400 xsym               LDP0    B$JIT$
         3 000772   000143 236100                    LDQ     99,,PR0
         3 000773   000205 376000 2                  ANQ     XT#CANT_ADAPT+6
         3 000774   001011 600000 3                  TZE     s:13317

     3886    13309    3       THEN DO;

     3887    13310    3           XUG.ERRSAVE = ERR;

  13310  3 000775   200004 236100                    LDQ     ERR,,AUTO
         3 000776   200005 471500                    LDP1    XUG$,,AUTO
         3 000777   100067 756100                    STQ     55,,PR1

     3888    13311    3           XUG.ERRDCB = DCBNUM(NIL);

  13311  3 001000   100070 450100                    STZ     56,,PR1

     3889    13312    3           XUG.NO_INCREMENT = %YES#;

  13312  3 001001   000001 236007                    LDQ     1,DL
         3 001002   100071 256100                    ORSQ    57,,PR1

     3890    13313    3           XUG.FIRST_ERROR = %YES#;

  13313  3 001003   000002 236007                    LDQ     2,DL
         3 001004   100071 256100                    ORSQ    57,,PR1

     3891    13314    3           XUG.LAST_FLAGLEV = 0;

  13314  3 001005   000000 236003                    LDQ     0,DU
         3 001006   100266 552120                    STBQ    182,'20'O,PR1

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:745  
     3892    13315    3           RETURN;

  13315  3 001007   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001010   000001 702211                    TSX2  ! 1,X1

     3893    13316    3       END;
     3894    13317    2       GETCMD.PCB$->P$PCB.HI_CHAR = VLR_YC.CPOS + BLK$->P$B.SUBLK$(0) ->

  13317  3 001011   200003 471500                    LDP1    @GETCMD,,AUTO
         3 001012   100003 473500                    LDP3    3,,PR1
         3 001013   200054 474500                    LDP4    BLK$,,AUTO
         3 001014   400003 475500                    LDP5    3,,PR4
         3 001015   200100 236100                    LDQ     VLR_YC,,AUTO
         3 001016   500002 036100                    ADLQ    2,,PR5
         3 001017   300012 756100                    STQ     10,,PR3

     3895    13318    2         P$S.CPOS ;
     3896    13319    2       IF NOT ERR.MON AND ERR.CODE=%E$SYNERR

  13319  3 001020   200004 236100                    LDQ     ERR,,AUTO
         3 001021   400000 316007                    CANQ    -131072,DL
         3 001022   001042 601000 3                  TNZ     s:13327
         3 001023   200004 236100                    LDQ     ERR,,AUTO
         3 001024   377770 376007                    ANQ     131064,DL
         3 001025   000010 116007                    CMPQ    8,DL
         3 001026   001042 601000 3                  TNZ     s:13327

     3897    13320    2       THEN
     3898    13321    3       DO ;

     3899    13322    3           CALL XUG$SINPUT (GETCMD);

  13322  3 001027   200003 630500                    EPPR0   @GETCMD,,AUTO
         3 001030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001031   000000 701000 xent               TSX1    XUG$SINPUT
         3 001032   000000 011000                    NOP     0

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:746  
     3900    13323    3           XUG.SYNERR=%YES# ;

  13323  3 001033   200005 470500                    LDP0    XUG$,,AUTO
         3 001034   004000 236003                    LDQ     2048,DU
         3 001035   000071 256100                    ORSQ    57,,PR0

     3901    13324    3           XUG.DOCMD_SYNERR=%YES# ;

  13324  3 001036   000100 236003                    LDQ     64,DU
         3 001037   000071 256100                    ORSQ    57,,PR0

     3902    13325    3           ERR.MID='07'O;

  13325  3 001040   000007 236003                    LDQ     7,DU
         3 001041   200004 752110                    STCQ    ERR,'10'O,AUTO

     3903    13326    3       END ;                        /* Then Do */

     3904    13327    2       GETCMD.ERR# = ERR;

  13327  3 001042   200004 236100                    LDQ     ERR,,AUTO
         3 001043   200003 470500                    LDP0    @GETCMD,,AUTO
         3 001044   000001 756100                    STQ     1,,PR0

     3905    13328    2   ALT: ALTRETURN;

  13328  3 001045   200352 221300       ALT          LDX1  ! FID_RESULTS+10,,AUTO
         3 001046   000000 702211                    TSX2  ! 0,X1

     3906    13329
     3907    13330    2   END     DO_CMD ;
     3908    13331        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:747  
     3909    13332    1   ERASE_CMD: PROC ALTRET ;

  13332  3 001047   200352 741300       ERASE_CMD    STX1  ! FID_RESULTS+10,,AUTO

     3910    13333        /**/
     3911    13334    2   DCL I UBIN WORD ;
     3912    13335        /**/
     3913    13336    2       FPT_LDEV = FPT_LDEV_C ;

  13336  3 001050   000100 100400                    MLR     fill='000'O
         3 001051   000132 000120 2                  ADSC9   FPT_LDEV_C               cn=0,n=80
         3 001052   200152 000120                    ADSC9   FPT_LDEV,,AUTO           cn=0,n=80

     3914    13337    2       FPT_LDEV.V_ = VECTOR(FPT_LDEV.V);

  13337  3 001053   000015 235000 4                  LDA     13
         3 001054   200364 452500                    STP2    @BOUND+1,,AUTO
         3 001055   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 001056   000170 036003                    ADLQ    120,DU
         3 001057   200152 757100                    STAQ    FPT_LDEV,,AUTO

     3915    13338    2       FPT_LDEV.V.DELETE# = %YES#;

  13338  3 001060   040000 236003                    LDQ     16384,DU
         3 001061   200171 256100                    ORSQ    FPT_LDEV+15,,AUTO

     3916    13339    2       IF BLK$->P$B.NSUBLKS = 0

  13339  3 001062   200054 470500                    LDP0    BLK$,,AUTO
         3 001063   000001 220100                    LDX0    1,,PR0
         3 001064   001077 601000 3                  TNZ     s:13346

     3917    13340    2       THEN
     3918    13341    3       DO;

     3919    13342    3           FPT_LDEV.V.STREAMNAME# = 'ALL';

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:748  
  13342  3 001065   000206 236000 2                  LDQ     XT#CANT_ADAPT+7
         3 001066   000016 376000 4                  ANQ     14
         3 001067   000040 276007                    ORQ     32,DL
         3 001070   200170 756100                    STQ     FPT_LDEV+14,,AUTO

     3920    13343    3           CALL M$LDEV(FPT_LDEV) ALTRET(ERASE_ERR);

  13343  3 001071   200152 630500                    EPPR0   FPT_LDEV,,AUTO
         3 001072   460004 713400                    CLIMB   alt,+24580
         3 001073   403000 401760                    pmme    nvectors=7
         3 001074   001153 702000 3                  TSX2    ERASE_ERR

     3921    13344    3           RETURN;

  13344  3 001075   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001076   000001 702211                    TSX2  ! 1,X1

     3922    13345    3       END;
     3923    13346    2       I = 0;

  13346  3 001077   200353 450100                    STZ     I,,AUTO

     3924    13347    3       DO WHILE(I < BLK$->P$B.NSUBLKS);

  13347  3 001100   000001 236100                    LDQ     1,,PR0
         3 001101   000022 772000                    QRL     18
         3 001102   200353 116100                    CMPQ    I,,AUTO
         3 001103   001151 602000 3                  TNC     s:13362
         3 001104   001151 600000 3                  TZE     s:13362

     3925    13348    3           IF BLK$ -> P$B.SUBLK$(I)->P$S.COUNT > 4

  13348  3 001105   200054 470500                    LDP0    BLK$,,AUTO
         3 001106   200353 720100                    LXL0    I,,AUTO
         3 001107   000003 471510                    LDP1    3,X0,PR0
         3 001110   100004 236100                    LDQ     4,,PR1
         3 001111   777000 376003                    ANQ     -512,DU
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:749  
         3 001112   005000 116003                    CMPQ    2560,DU
         3 001113   001126 602000 3                  TNC     s:13358

     3926    13349    3           THEN
     3927    13350    4           DO ;

     3928    13351    4               GETCMD.ERR# = XUG#BIG4CHAR ;

  13351  3 001114   000174 236000 2                  LDQ     XUG#BIG4CHAR
         3 001115   200003 473500                    LDP3    @GETCMD,,AUTO
         3 001116   300001 756100                    STQ     1,,PR3

     3929    13352    4               GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(I)->P$S.CPOS+4 ;

  13352  3 001117   300003 471500                    LDP1    3,,PR3
         3 001120   000003 474510                    LDP4    3,X0,PR0
         3 001121   400002 235100                    LDA     2,,PR4
         3 001122   000004 035007                    ADLA    4,DL
         3 001123   100012 755100                    STA     10,,PR1

     3930    13353    4               ALTRETURN;

  13353  3 001124   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001125   000000 702211                    TSX2  ! 0,X1

     3931    13354    4           END ;                     /* Then Do */
     3932    13355        /*E*  ERROR:  XUG-E$XUG#BIG4CHAR
     3933    13356              MESSAGE0: Only four or less characters allowed.
     3934    13357        */
     3935    13358    3           FPT_LDEV.V.STREAMNAME# = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXT;

  13358  3 001126   100004 236100                    LDQ     4,,PR1
         3 001127   000033 772000                    QRL     27
         3 001130   000000 621006                    EAX1    0,QL
         3 001131   040100 100540                    MLR     fill='040'O
         3 001132   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         3 001133   200170 000004                    ADSC9   FPT_LDEV+14,,AUTO        cn=0,n=4
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:750  

     3936    13359    3           CALL M$LDEV(FPT_LDEV) ALTRET(ERASE_ERR);

  13359  3 001134   200152 630500                    EPPR0   FPT_LDEV,,AUTO
         3 001135   460004 713400                    CLIMB   alt,+24580
         3 001136   403000 401760                    pmme    nvectors=7
         3 001137   001153 702000 3                  TSX2    ERASE_ERR

     3937    13360    3           I = I + 1;

  13360  3 001140   200353 235100                    LDA     I,,AUTO
         3 001141   000001 035007                    ADLA    1,DL
         3 001142   200353 755100                    STA     I,,AUTO

     3938    13361    3       END;

  13361  3 001143   200054 470500                    LDP0    BLK$,,AUTO
         3 001144   000001 236100                    LDQ     1,,PR0
         3 001145   000022 772000                    QRL     18
         3 001146   200353 116100                    CMPQ    I,,AUTO
         3 001147   001151 600000 3                  TZE     s:13362
         3 001150   001105 603000 3                  TRC     s:13348

     3939    13362    2       RETURN;

  13362  3 001151   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001152   000001 702211                    TSX2  ! 1,X1

     3940    13363    2   ERASE_ERR:
     3941    13364    2       GETCMD.ERR# = B$TCB.ALT$->B$EXCFR.ERR ;

  13364  3 001153   000000 470400 xsym  ERASE_ERR    LDP0    B$TCB$
         3 001154   000000 471500                    LDP1    0,,PR0
         3 001155   100102 236100                    LDQ     66,,PR1
         3 001156   200003 473500                    LDP3    @GETCMD,,AUTO
         3 001157   300001 756100                    STQ     1,,PR3

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:751  
     3942    13365    2       GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(I)->P$S.CPOS ;

  13365  3 001160   300003 471500                    LDP1    3,,PR3
         3 001161   200054 474500                    LDP4    BLK$,,AUTO
         3 001162   200353 720100                    LXL0    I,,AUTO
         3 001163   400003 475510                    LDP5    3,X0,PR4
         3 001164   500002 235100                    LDA     2,,PR5
         3 001165   100012 755100                    STA     10,,PR1

     3943    13366    2   ERASE_ALT:
     3944    13367    2       ALTRETURN;

  13367  3 001166   200352 221300       ERASE_ALT    LDX1  ! FID_RESULTS+10,,AUTO
         3 001167   000000 702211                    TSX2  ! 0,X1

     3945    13368    2   END     ERASE_CMD ;
     3946    13369        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:752  
     3947    13370    1   HELP_CMD: PROC ALTRET ;

  13370  3 001170   200352 741300       HELP_CMD     STX1  ! FID_RESULTS+10,,AUTO

     3948    13371
     3949    13372    2       IF GETCMD.XUH$ = ADDR(NIL)

  13372  3 001171   200003 470500                    LDP0    @GETCMD,,AUTO
         3 001172   000005 236100                    LDQ     5,,PR0
         3 001173   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 001174   001200 601000 3                  TNZ     s:13376

     3950    13373    2       THEN
     3951    13374    2           GETCMD.XUH$ = ADDR(XUG.XUH_PARAM);

  13374  3 001175   200005 236100                    LDQ     XUG$,,AUTO
         3 001176   000154 036003                    ADLQ    108,DU
         3 001177   000005 756100                    STQ     5,,PR0

     3952    13375
     3953    13376    3       DO CASE(CODE) ;

  13376  3 001200   200006 235100                    LDA     CODE,,AUTO
         3 001201   000005 135007                    SBLA    5,DL
         3 001202   000005 115007                    CMPA    5,DL
         3 001203   001205 602005 3                  TNC     s:13376+5,AL
         3 001204   001243 710000 3                  TRA     NORMAL_RETURN
         3 001205   001224 710000 3                  TRA     s:13385
         3 001206   001243 710000 3                  TRA     NORMAL_RETURN
         3 001207   001243 710000 3                  TRA     NORMAL_RETURN
         3 001210   001212 710000 3                  TRA     s:13379
         3 001211   001217 710000 3                  TRA     s:13382

     3954    13377
     3955    13378    3       CASE(%XUG_CMD_Q1);

     3956    13379    3           CALL XUG$MOREMSG_COMMON(GETCMD) ALTRET(GIVE_ERR_MSG) ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:753  

  13379  3 001212   200003 630500                    EPPR0   @GETCMD,,AUTO
         3 001213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001214   000000 701000 xent               TSX1    XUG$MOREMSG_COMMON
         3 001215   001245 702000 3                  TSX2    GIVE_ERR_MSG
         3 001216   001243 710000 3                  TRA     NORMAL_RETURN

     3957    13380
     3958    13381    3       CASE(%XUG_CMD_Q2);

     3959    13382    3           CALL XUG$ALLMSG_COMMON(GETCMD) ALTRET(GIVE_ERR_MSG) ;

  13382  3 001217   200003 630500                    EPPR0   @GETCMD,,AUTO
         3 001220   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001221   000000 701000 xent               TSX1    XUG$ALLMSG_COMMON
         3 001222   001245 702000 3                  TSX2    GIVE_ERR_MSG
         3 001223   001243 710000 3                  TRA     NORMAL_RETURN

     3960    13383
     3961    13384    3       CASE(%XUG_CMD_HELP);

     3962    13385    3           IF BLK$ -> P$B.NSUBLKS = 0

  13385  3 001224   200054 471500                    LDP1    BLK$,,AUTO
         3 001225   100001 220100                    LDX0    1,,PR1
         3 001226   001233 601000 3                  TNZ     s:13389

     3963    13386    3           THEN
     3964    13387    3               XUH$PARAM.HELP$ = ADDR(NULL_HELP_TOPIC);

  13387  3 001227   000005 473500                    LDP3    5,,PR0
         3 001230   000017 236000 4                  LDQ     15
         3 001231   300011 756100                    STQ     9,,PR3
         3 001232   001237 710000 3                  TRA     s:13390

     3965    13388    3           ELSE
     3966    13389    3               XUH$PARAM.HELP$=BLK$->P$B.SUBLK$(0)->P$S.TEXTC$;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:754  

  13389  3 001233   000005 473500                    LDP3    5,,PR0
         3 001234   100003 474500                    LDP4    3,,PR1
         3 001235   400003 236100                    LDQ     3,,PR4
         3 001236   300011 756100                    STQ     9,,PR3

     3967    13390    3           CALL XUG$HELP_COMMON(GETCMD) ALTRET(NORMAL_RETURN) ;

  13390  3 001237   200003 630500                    EPPR0   @GETCMD,,AUTO
         3 001240   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001241   000000 701000 xent               TSX1    XUG$HELP_COMMON
         3 001242   001243 702000 3                  TSX2    NORMAL_RETURN

     3968    13391    3       END ;                          /* Do Case */

     3969    13392    2   NORMAL_RETURN:
     3970    13393    2       RETURN ;

  13393  3 001243   200352 221300       NORMAL_RETU* LDX1  ! FID_RESULTS+10,,AUTO
         3 001244   000001 702211                    TSX2  ! 1,X1

     3971    13394
     3972    13395    2   GIVE_ERR_MSG:
     3973    13396    2       GETCMD.ERR_CODE = XUG#NO_MORE ;

  13396  3 001245   000175 236000 2     GIVE_ERR_MSG LDQ     XUG#NO_MORE
         3 001246   200003 470500                    LDP0    @GETCMD,,AUTO
         3 001247   000010 756100                    STQ     8,,PR0

     3974    13397        /*E*   ERROR:   XUG-E$XUG#NO_MORE
     3975    13398               MESSAGE: No messages available.
     3976    13399               MESSAGE1: Th Th Th That's all fffolks!
     3977    13400                                                                          */
     3978    13401    2       GETCMD.ERRDCB# = B$TCB.ALT$->B$EXCFR.DCB# ;

  13401  3 001250   000000 471400 xsym               LDP1    B$TCB$
         3 001251   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:755  
         3 001252   300101 235100                    LDA     65,,PR3
         3 001253   000011 755100                    STA     9,,PR0

     3979    13402    2       GETCMD.F1_ = VECTOR(NIL) ;

  13402  3 001254   000020 237000 4                  LDAQ    16
         3 001255   000017 755100                    STA     15,,PR0
         3 001256   000020 756100                    STQ     16,,PR0

     3980    13403    2       GETCMD.F2_ = VECTOR(NIL) ;

  13403  3 001257   000020 237000 4                  LDAQ    16
         3 001260   000021 755100                    STA     17,,PR0
         3 001261   000022 756100                    STQ     18,,PR0

     3981    13404    2       GETCMD.F3_ = VECTOR(NIL) ;

  13404  3 001262   000020 237000 4                  LDAQ    16
         3 001263   000023 755100                    STA     19,,PR0
         3 001264   000024 756100                    STQ     20,,PR0

     3982    13405    2       GETCMD.FLGLEV# = 0 ;

  13405  3 001265   000000 236003                    LDQ     0,DU
         3 001266   000006 552120                    STBQ    6,'20'O,PR0

     3983    13406    2       CALL XUG$ERRMSG_COMMON(GETCMD) ALTRET(HELP_ERR) ;

  13406  3 001267   200003 630500                    EPPR0   @GETCMD,,AUTO
         3 001270   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001271   000000 701000 xent               TSX1    XUG$ERRMSG_COMMON
         3 001272   001275 702000 3                  TSX2    HELP_ERR

     3984    13407    2       RETURN ;

  13407  3 001273   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001274   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:756  

     3985    13408    2   HELP_ERR:
     3986    13409    2       GETCMD.ERR# = B$TCB.ALT$->B$EXCFR.ERR ;

  13409  3 001275   000000 470400 xsym  HELP_ERR     LDP0    B$TCB$
         3 001276   000000 471500                    LDP1    0,,PR0
         3 001277   100102 236100                    LDQ     66,,PR1
         3 001300   200003 473500                    LDP3    @GETCMD,,AUTO
         3 001301   300001 756100                    STQ     1,,PR3

     3987    13410    2       GETCMD.PCB$->P$PCB.HI_CHAR = 0 ;

  13410  3 001302   300003 471500                    LDP1    3,,PR3
         3 001303   100012 450100                    STZ     10,,PR1

     3988    13411    2       ALTRETURN ;

  13411  3 001304   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001305   000000 702211                    TSX2  ! 0,X1

     3989    13412    2   END     HELP_CMD ;
     3990    13413        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:757  
     3991    13414    1   OUTPUT_CMD: PROC ALTRET;

  13414  3 001306   200352 741300       OUTPUT_CMD   STX1  ! FID_RESULTS+10,,AUTO

     3992    13415
     3993    13416    2       GETCMD.UTIL$ = BLK$;

  13416  3 001307   200054 236100                    LDQ     BLK$,,AUTO
         3 001310   200003 470500                    LDP0    @GETCMD,,AUTO
         3 001311   000044 756100                    STQ     36,,PR0

     3994    13417    2       GETCMD.FPT$ = ADDR(NIL);

  13417  3 001312   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 001313   000043 756100                    STQ     35,,PR0

     3995    13418    2       TSTOR = GETCMD.DCB_PARAM#;

  13418  3 001314   000014 235100                    LDA     12,,PR0
         3 001315   200057 755100                    STA     TSTOR,,AUTO

     3996    13419    2       GETCMD.DCB_PARAM# = GETCMD.OUTDCB#;

  13419  3 001316   000013 235100                    LDA     11,,PR0
         3 001317   000014 755100                    STA     12,,PR0

     3997    13420
     3998    13421    2       CALL XUG$OPENOUT_COMMON (GETCMD)

  13421  3 001320   200003 630500                    EPPR0   @GETCMD,,AUTO
         3 001321   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001322   000000 701000 xent               TSX1    XUG$OPENOUT_COMMON
         3 001323   001325 702000 3                  TSX2    s:13423
         3 001324   001332 710000 3                  TRA     s:13427

     3999    13422    3       WHENALTRETURN DO;

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:758  
     4000    13423    3           GETCMD.DCB_PARAM# = TSTOR;

  13423  3 001325   200003 470500                    LDP0    @GETCMD,,AUTO
         3 001326   200057 235100                    LDA     TSTOR,,AUTO
         3 001327   000014 755100                    STA     12,,PR0

     4001    13424    3           ALTRETURN;

  13424  3 001330   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001331   000000 702211                    TSX2  ! 0,X1

     4002    13425    3       END;
     4003    13426
     4004    13427    2       GETCMD.DCB_PARAM# = TSTOR;

  13427  3 001332   200003 470500                    LDP0    @GETCMD,,AUTO
         3 001333   200057 235100                    LDA     TSTOR,,AUTO
         3 001334   000014 755100                    STA     12,,PR0

     4005    13428    2       RETURN;

  13428  3 001335   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001336   000001 702211                    TSX2  ! 1,X1

     4006    13429
     4007    13430    2   END OUTPUT_CMD;
     4008    13431        %EJECT;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:759  
     4009    13432    1   PRINT_CMD: PROC ALTRET ;

  13432  3 001337   200352 741300       PRINT_CMD    STX1  ! FID_RESULTS+10,,AUTO

     4010    13433        /**/
     4011    13434    2   DCL I UBIN WORD ;
     4012    13435        /**/
     4013    13436    2       FPT_LDEV = FPT_LDEV_C ;

  13436  3 001340   000100 100400                    MLR     fill='000'O
         3 001341   000132 000120 2                  ADSC9   FPT_LDEV_C               cn=0,n=80
         3 001342   200152 000120                    ADSC9   FPT_LDEV,,AUTO           cn=0,n=80

     4014    13437    2       FPT_LDEV.V_ = VECTOR(FPT_LDEV.V);

  13437  3 001343   000015 235000 4                  LDA     13
         3 001344   200364 452500                    STP2    @BOUND+1,,AUTO
         3 001345   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 001346   000170 036003                    ADLQ    120,DU
         3 001347   200152 757100                    STAQ    FPT_LDEV,,AUTO

     4015    13438    2       IF BLK$->P$B.NSUBLKS = 0

  13438  3 001350   200054 470500                    LDP0    BLK$,,AUTO
         3 001351   000001 220100                    LDX0    1,,PR0
         3 001352   001365 601000 3                  TNZ     s:13445

     4016    13439    2       THEN
     4017    13440    3       DO;

     4018    13441    3           FPT_LDEV.V.STREAMNAME# = 'ALL';

  13441  3 001353   000206 236000 2                  LDQ     XT#CANT_ADAPT+7
         3 001354   000016 376000 4                  ANQ     14
         3 001355   000040 276007                    ORQ     32,DL
         3 001356   200170 756100                    STQ     FPT_LDEV+14,,AUTO

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:760  
     4019    13442    3           CALL M$LDEV(FPT_LDEV) ALTRET(PRINT_ERR) ;

  13442  3 001357   200152 630500                    EPPR0   FPT_LDEV,,AUTO
         3 001360   460004 713400                    CLIMB   alt,+24580
         3 001361   403000 401760                    pmme    nvectors=7
         3 001362   001441 702000 3                  TSX2    PRINT_ERR

     4020    13443    3           RETURN;

  13443  3 001363   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001364   000001 702211                    TSX2  ! 1,X1

     4021    13444    3       END;
     4022    13445    2       I = 0;

  13445  3 001365   200353 450100                    STZ     I,,AUTO

     4023    13446    3       DO WHILE(I < BLK$->P$B.NSUBLKS);

  13446  3 001366   000001 236100                    LDQ     1,,PR0
         3 001367   000022 772000                    QRL     18
         3 001370   200353 116100                    CMPQ    I,,AUTO
         3 001371   001437 602000 3                  TNC     s:13458
         3 001372   001437 600000 3                  TZE     s:13458

     4024    13447    3           IF BLK$ -> P$B.SUBLK$(I)->P$S.COUNT > 4

  13447  3 001373   200054 470500                    LDP0    BLK$,,AUTO
         3 001374   200353 720100                    LXL0    I,,AUTO
         3 001375   000003 471510                    LDP1    3,X0,PR0
         3 001376   100004 236100                    LDQ     4,,PR1
         3 001377   777000 376003                    ANQ     -512,DU
         3 001400   005000 116003                    CMPQ    2560,DU
         3 001401   001414 602000 3                  TNC     s:13454

     4025    13448    3           THEN
     4026    13449    4           DO ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:761  

     4027    13450    4               GETCMD.ERR# = XUG#BIG4CHAR ;

  13450  3 001402   000174 236000 2                  LDQ     XUG#BIG4CHAR
         3 001403   200003 473500                    LDP3    @GETCMD,,AUTO
         3 001404   300001 756100                    STQ     1,,PR3

     4028    13451    4               GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(I)->P$S.CPOS+4 ;

  13451  3 001405   300003 471500                    LDP1    3,,PR3
         3 001406   000003 474510                    LDP4    3,X0,PR0
         3 001407   400002 235100                    LDA     2,,PR4
         3 001410   000004 035007                    ADLA    4,DL
         3 001411   100012 755100                    STA     10,,PR1

     4029    13452    4               ALTRETURN;

  13452  3 001412   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001413   000000 702211                    TSX2  ! 0,X1

     4030    13453    4           END ;                     /* Then Do */
     4031    13454    3           FPT_LDEV.V.STREAMNAME# = BLK$ -> P$B.SUBLK$(I) -> P$S.TEXT;

  13454  3 001414   100004 236100                    LDQ     4,,PR1
         3 001415   000033 772000                    QRL     27
         3 001416   000000 621006                    EAX1    0,QL
         3 001417   040100 100540                    MLR     fill='040'O
         3 001420   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         3 001421   200170 000004                    ADSC9   FPT_LDEV+14,,AUTO        cn=0,n=4

     4032    13455    3           CALL M$LDEV(FPT_LDEV) ALTRET(PRINT_ERR);

  13455  3 001422   200152 630500                    EPPR0   FPT_LDEV,,AUTO
         3 001423   460004 713400                    CLIMB   alt,+24580
         3 001424   403000 401760                    pmme    nvectors=7
         3 001425   001441 702000 3                  TSX2    PRINT_ERR

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:762  
     4033    13456    3           I = I + 1;

  13456  3 001426   200353 235100                    LDA     I,,AUTO
         3 001427   000001 035007                    ADLA    1,DL
         3 001430   200353 755100                    STA     I,,AUTO

     4034    13457    3       END;

  13457  3 001431   200054 470500                    LDP0    BLK$,,AUTO
         3 001432   000001 236100                    LDQ     1,,PR0
         3 001433   000022 772000                    QRL     18
         3 001434   200353 116100                    CMPQ    I,,AUTO
         3 001435   001437 600000 3                  TZE     s:13458
         3 001436   001373 603000 3                  TRC     s:13447

     4035    13458    2       RETURN;

  13458  3 001437   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001440   000001 702211                    TSX2  ! 1,X1

     4036    13459    2   PRINT_ERR:
     4037    13460    2       GETCMD.ERR# = B$TCB.ALT$->B$EXCFR.ERR ;

  13460  3 001441   000000 470400 xsym  PRINT_ERR    LDP0    B$TCB$
         3 001442   000000 471500                    LDP1    0,,PR0
         3 001443   100102 236100                    LDQ     66,,PR1
         3 001444   200003 473500                    LDP3    @GETCMD,,AUTO
         3 001445   300001 756100                    STQ     1,,PR3

     4038    13461    2       GETCMD.PCB$->P$PCB.HI_CHAR = BLK$->P$B.SUBLK$(I)->P$S.CPOS ;

  13461  3 001446   300003 471500                    LDP1    3,,PR3
         3 001447   200054 474500                    LDP4    BLK$,,AUTO
         3 001450   200353 720100                    LXL0    I,,AUTO
         3 001451   400003 475510                    LDP5    3,X0,PR4
         3 001452   500002 235100                    LDA     2,,PR5
         3 001453   100012 755100                    STA     10,,PR1
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:763  

     4039    13462    2       ALTRETURN;

  13462  3 001454   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001455   000000 702211                    TSX2  ! 0,X1

     4040    13463    2   END     PRINT_CMD ;
     4041    13464        %EJECT ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:764  
     4042    13465    1   TIME_DATE_CMD: PROC ALTRET ;

  13465  3 001456   200352 741300       TIME_DATE_C* STX1  ! FID_RESULTS+10,,AUTO

     4043    13466
     4044    13467    2   DCL 1 TMDATE,
     4045    13468    2         2 * CHAR(2),
     4046    13469    2         2 DATE CHAR(10),
     4047    13470    2         2 * CHAR(2),
     4048    13471    2         2 TIME,
     4049    13472    2           3 HR CHAR(3),
     4050    13473    2           3 MIN CHAR(2),
     4051    13474    2           3 SEC CHAR(3),
     4052    13475    2           3 MSEC CHAR(3),
     4053    13476    2         2 DAY CHAR(3) ;
     4054    13477    2   DCL TMDATEBUFF REDEF TMDATE CHAR(28);
     4055    13478
     4056    13479    2       TMDATEBUFF=' ';                /*Blank out buffer*/

  13479  3 001457   040100 100400                    MLR     fill='040'O
         3 001460   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001461   200353 000034                    ADSC9   TMDATE,,AUTO             cn=0,n=28

     4057    13480    2       FPT_TIME = FPT_TIME_C;

  13480  3 001462   000100 100400                    MLR     fill='000'O
         3 001463   000156 000060 2                  ADSC9   FPT_TIME_C               cn=0,n=48
         3 001464   200176 000060                    ADSC9   FPT_TIME,,AUTO           cn=0,n=48

     4058    13481    2       FPT_TIME.V_ = VECTOR(FPT_TIME.V);

  13481  3 001465   000003 235000 4                  LDA     3
         3 001466   200364 452500                    STP2    @BOUND+1,,AUTO
         3 001467   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 001470   000210 036003                    ADLQ    136,DU
         3 001471   200176 757100                    STAQ    FPT_TIME,,AUTO

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:765  
     4059    13482    2       FPT_TIME.DAY_=VECTOR(TMDATE.DAY) ;

  13482  3 001472   577640 235007                    LDA     -65632,DL
         3 001473   200364 452500                    STP2    @BOUND+1,,AUTO
         3 001474   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 001475   000022 036000 4                  ADLQ    18
         3 001476   200204 757100                    STAQ    FPT_TIME+6,,AUTO

     4060    13483    2       FPT_TIME.DATE_=VECTOR(TMDATE.DATE);

  13483  3 001477   000023 235000 4                  LDA     19
         3 001500   200364 452500                    STP2    @BOUND+1,,AUTO
         3 001501   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 001502   000024 036000 4                  ADLQ    20
         3 001503   200200 757100                    STAQ    FPT_TIME+2,,AUTO

     4061    13484    2       FPT_TIME.TIME_=VECTOR(TMDATE.TIME);

  13484  3 001504   000025 235000 4                  LDA     21
         3 001505   200364 452500                    STP2    @BOUND+1,,AUTO
         3 001506   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 001507   000026 036000 4                  ADLQ    22
         3 001510   200202 757100                    STAQ    FPT_TIME+4,,AUTO

     4062    13485    2       CALL M$TIME(FPT_TIME) ALTRET(TIME_ERR) ;

  13485  3 001511   200176 630500                    EPPR0   FPT_TIME,,AUTO
         3 001512   420004 713400                    CLIMB   alt,+8196
         3 001513   402000 401760                    pmme    nvectors=5
         3 001514   001531 702000 3                  TSX2    TIME_ERR

     4063    13486    2       CNT = 19 ;

  13486  3 001515   000023 235007                    LDA     19,DL
         3 001516   200056 755100                    STA     CNT,,AUTO

     4064    13487    2       OUTBUFF=SUBSTR(TMDATEBUFF,0,CNT) ;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:766  

  13487  3 001517   000000 620005                    EAX0    0,AL
         3 001520   040100 100540                    MLR     fill='040'O
         3 001521   200353 000010                    ADSC9   TMDATE,,AUTO             cn=0,n=*X0
         3 001522   200010 000120                    ADSC9   OUTBUFF,,AUTO            cn=0,n=80

     4065    13488    2       CALL OUTPUT_MESSAGE (CNT) ALTRET(TIME_ERR) ;

  13488  3 001523   200056 630500                    EPPR0   CNT,,AUTO
         3 001524   200363 450500                    STP0    TMDATE+8,,AUTO
         3 001525   001540 701000 3                  TSX1    OUTPUT_MESSAGE
         3 001526   001531 702000 3                  TSX2    TIME_ERR

     4066    13489    2       RETURN ;

  13489  3 001527   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001530   000001 702211                    TSX2  ! 1,X1

  13487  3 001531                       TIME_ERR     null
     4067    13490    2   TIME_ERR: ;
     4068    13491    2       GETCMD.ERR# = B$TCB.ALT$ -> B$EXCFR.ERR ;

  13491  3 001531   000000 470400 xsym               LDP0    B$TCB$
         3 001532   000000 471500                    LDP1    0,,PR0
         3 001533   100102 236100                    LDQ     66,,PR1
         3 001534   200003 473500                    LDP3    @GETCMD,,AUTO
         3 001535   300001 756100                    STQ     1,,PR3

     4069    13492    2       ALTRETURN ;

  13492  3 001536   200352 221300                    LDX1  ! FID_RESULTS+10,,AUTO
         3 001537   000000 702211                    TSX2  ! 0,X1

     4070    13493    2   END     TIME_DATE_CMD ;
     4071    13494        %EJECT;
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:767  
     4072    13495    1   OUTPUT_MESSAGE: PROC (BOUND) ALTRET ;

  13495  3 001540   200362 741300       OUTPUT_MESS* STX1  ! TMDATE+7,,AUTO

     4073    13496
     4074    13497    2   DCL BOUND SBIN WORD ;
     4075    13498
     4076    13499    2       FPT_WRITE = FPT_WRITE_C ;

  13499  3 001541   000100 100400                    MLR     fill='000'O
         3 001542   000062 000060 2                  ADSC9   FPT_WRITE_C              cn=0,n=48
         3 001543   200102 000060                    ADSC9   FPT_WRITE,,AUTO          cn=0,n=48

     4077    13500    2       FPT_WRITE.V_ = VECTOR(FPT_WRITE.V) ;

  13500  3 001544   000000 235000 4                  LDA     0
         3 001545   200364 452500                    STP2    @BOUND+1,,AUTO
         3 001546   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 001547   000112 036003                    ADLQ    74,DU
         3 001550   200102 757100                    STAQ    FPT_WRITE,,AUTO

     4078    13501    2       FPT_WRITE.BUF_ = VECTOR(OUTBUFF) ;

  13501  3 001551   000027 235000 4                  LDA     23
         3 001552   200364 452500                    STP2    @BOUND+1,,AUTO
         3 001553   200364 236100                    LDQ     @BOUND+1,,AUTO
         3 001554   000010 036003                    ADLQ    8,DU
         3 001555   200106 757100                    STAQ    FPT_WRITE+4,,AUTO

     4079    13502    2       FPT_WRITE.BUF_.BOUND = BOUND - 1 ;

  13502  3 001556   200363 470500                    LDP0    @BOUND,,AUTO
         3 001557   000000 236100                    LDQ     0,,PR0
         3 001560   000001 136007                    SBLQ    1,DL
         3 001561   000020 736000                    QLS     16
         3 001562   200106 676100                    ERQ     FPT_WRITE+4,,AUTO
         3 001563   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:768  
         3 001564   200106 656100                    ERSQ    FPT_WRITE+4,,AUTO

     4080    13503
     4081    13504    2       IF GETCMD.OUTDCB# ~= 0

  13504  3 001565   200003 471500                    LDP1    @GETCMD,,AUTO
         3 001566   100013 235100                    LDA     11,,PR1
         3 001567   001572 600000 3                  TZE     s:13508

     4082    13505    2       THEN
     4083    13506    2           M$LO# = GETCMD.OUTDCB# ;

  13506  3 001570   200060 755100                    STA     M$LO#,,AUTO
         3 001571   001602 710000 3                  TRA     s:13509

     4084    13507    2       ELSE
     4085    13508    2           CALL XUG$FINDDCB_COMMON (M$LO, M$LO#) ALTRET(OUTPUT_ERR) ;

  13508  3 001572   200060 633500                    EPPR3   M$LO#,,AUTO
         3 001573   200365 453500                    STP3    @BOUND+2,,AUTO
         3 001574   000030 236000 4                  LDQ     24
         3 001575   200364 756100                    STQ     @BOUND+1,,AUTO
         3 001576   200364 630500                    EPPR0   @BOUND+1,,AUTO
         3 001577   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001600   000000 701000 xent               TSX1    XUG$FINDDCB_COMMON
         3 001601   001612 702000 3                  TSX2    OUTPUT_ERR

     4086    13509    2       FPT_WRITE.V.DCB# = M$LO# ;

  13509  3 001602   200060 720100                    LXL0    M$LO#,,AUTO
         3 001603   200112 740100                    STX0    FPT_WRITE+8,,AUTO

     4087    13510    2       CALL M$WRITE (FPT_WRITE) ALTRET(OUTPUT_ERR) ;

  13510  3 001604   200102 630500                    EPPR0   FPT_WRITE,,AUTO
         3 001605   440001 713400                    CLIMB   alt,write
         3 001606   401400 401760                    pmme    nvectors=4
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:769  
         3 001607   001612 702000 3                  TSX2    OUTPUT_ERR

     4088    13511    2       RETURN ;

  13511  3 001610   200362 221300                    LDX1  ! TMDATE+7,,AUTO
         3 001611   000001 702211                    TSX2  ! 1,X1

     4089    13512
     4090    13513    2   OUTPUT_ERR:
     4091    13514    2       ALTRETURN ;

  13514  3 001612   200362 221300       OUTPUT_ERR   LDX1  ! TMDATE+7,,AUTO
         3 001613   000000 702211                    TSX2  ! 0,X1
     4092    13515    2   END     OUTPUT_MESSAGE ;
     4093    13516    1   END   XUG$BUILTIN_COMMON ;
     4094    13517        %EOD;

PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:770  
--  Include file information  --

   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XT_PERR_E.:TOOLE04  is referenced.
   XT_MACRO_M.:TOOLE04  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   XU_PERR_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$BUILTIN_COMMON.
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:771  

 **** Variables and constants ****

  ****  Section 002 RoData XUG$BUILTIN_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    44-0-0/d STRC(216)   r     1 FPT_EXIT_C               102-0-0/d STRC(864)   r     1 FPT_FID_C
   132-0-0/d STRC(720)   r     1 FPT_LDEV_C                76-0-0/d STRC(144)   r     1 FPT_SETFMA_C
   156-0-0/d STRC(432)   r     1 FPT_TIME_C                62-0-0/d STRC(432)   r     1 FPT_WRITE_C
    52-0-0/d STRC(288)   r     1 FPT_YC_C                  41-0-0/c STRC(45)    r     1 M$LO
    40-0-0/c STRC(9)     r     1 NULL_HELP_TOPIC          177-0-0/w STRC        r     1 XT#CANT_ADAPT
     0-0-0/w STRC(1152)  r     1 XT_PARAM_C               172-0-0/w STRC        r     1 XUG#BDIRFID
   174-0-0/w STRC        r     1 XUG#BIG4CHAR             173-0-0/w STRC        r     1 XUG#DOCMD2BIG
   176-0-0/w STRC        r     1 XUG#NO_ADAPT             175-0-0/w STRC        r     1 XUG#NO_MORE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   363-0-0/w PTR         r     1 @BOUND                     3-0-0/w PTR         r     1 @GETCMD
     7-0-0/w UBIN(9)     r     1 ASN                       54-0-0/w PTR         r     1 BLK$
    *0-0-0/w SBIN        r     1 BOUND                     56-0-0/w SBIN        r     1 CNT
     6-0-0/w SBIN        r     1 CODE                       4-0-0/b STRC        r     1 ERR
   340-0-0/d STRC(324)   r     1 FID_RESULTS               62-0-0/d STRC(216)   r     1 FPT_EXIT
   122-0-0/d STRC(864)   r     1 FPT_FID                  152-0-0/d STRC(720)   r     1 FPT_LDEV
   116-0-0/d STRC(144)   r     1 FPT_SETFMA               176-0-0/d STRC(432)   r     1 FPT_TIME
   102-0-0/d STRC(432)   r     1 FPT_WRITE                 70-0-0/d STRC(288)   r     1 FPT_YC
    *0-0-0/d STRC(1512)  r     1 GETCMD                   353-0-0/w SBIN        r     1 I
   353-0-0/w UBIN        r     1 I                        353-0-0/w UBIN        r     1 I
    60-0-0/w UBIN        r     1 M$LO#                     10-0-0/c CHAR(80)    r     1 OUTBUFF
   353-0-0/w EPTR        r     1 POST_EXEC                 34-0-0/c CHAR(8)     r     1 TBUFF
    36-0-0/c CHAR(56)    r     1 TEMPBUFF                 353-0-0/c STRC(252)   r     1 TMDATE
   353-0-0/c CHAR(28)    r     1 TMDATEBUFF                57-0-0/w SBIN        r     1 TSTOR
   222-0-0/c STRC(72)    r     1 VLP_ACCT                 212-0-0/c STRC(288)   r     1 VLP_NAME
   224-0-0/d STRC(2736)  r     1 VLP_SN                   100-0-0/d STRC(72)    r     1 VLR_YC
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:772  
    55-0-0/w PTR         r     1 XT$                        5-0-0/w PTR         r     1 XUG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$EXCFR                    0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w STRC(504)   r     1 P$PCB                      0-0-0/w ASTR(153)   r     1 P$S
     0-0-0/w STRC(1152)  r     1 XT_PARAM                   0-0-0/d STRC(9612)  r     1 XUG
     0-0-0/d STRC(2052)  r     1 XUH$PARAM


   Procedure XUG$BUILTIN_COMMON requires 908 words for executable code.
   Procedure XUG$BUILTIN_COMMON requires 246 words of local(AUTO) storage.
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:773  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:774  
          MINI XREF LISTING

ALT IN PROCEDURE DO_CMD
     13328**LABEL   13301--CALLALT
ALTRET_FROM_BUILTIN
     13096**LABEL   13053--CALLALT 13077--CALLALT 13084--CALLALT
ASN
     12322**DCL     13147--ASSIGN  13154>>IF
B$ALT.CODE
     12307**DCL     12307--REDEF   12308--REDEF   12308--REDEF
B$ALT.ERR.ERR#
     12309**DCL     12309--REDEF
B$ALT.EVID
     12308**DCL     12308--REDEF   12308--REDEF
B$EXCFR.ASL
     12288**DCL     12288--REDEF
B$EXCFR.DCB#
     12301**DCL     13401>>ASSIGN
B$EXCFR.ERR
     12302**DCL     13175>>ASSIGN  13304>>ASSIGN  13364>>ASSIGN  13409>>ASSIGN  13460>>ASSIGN  13491>>ASSIGN
B$EXCFR.ERR.ERR#
     12302**DCL     12302--REDEF
B$EXCFR.EVID
     12301**DCL     12301--REDEF   12302--REDEF
B$EXCFR.IR
     12289**DCL     12289--REDEF
B$EXCFR.PREVSZ
     12288**DCL     12288--REDEF
B$EXCFR.SUBC
     12300**DCL     12300--REDEF   12301--REDEF   12301--REDEF
B$JIT.CPFLAGS1
     10731**DCL     13308>>IF
B$JIT.CPFLAGS1.SLEAZE
     10736**DCL     10736--REDEF
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:775  
B$JIT.ERR.MID
     10643**DCL     10643--REDEF
B$JIT.FACCN
     10642**DCL     13120>>CALLBLT
B$JIT.FPSN
     10723**DCL     13110>>CALLBLT 13114>>CALLBLT
B$JIT.JRESPEAK
     10804**DCL     10805--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
     10913**DCL     10913--REDEF   10914--REDEF
B$JIT.PNR
     10817**DCL     10817--REDEF
B$JIT.TSLINE
     10911**DCL     10912--REDEF
B$JIT$
     12001**DCL     10637--IMP-PTR 13110>>CALLBLT 13114>>CALLBLT 13120>>CALLBLT 13308>>IF
B$TCB.ALT$
     12285**DCL     13175>>ASSIGN  13304>>ASSIGN  13364>>ASSIGN  13401>>ASSIGN  13409>>ASSIGN  13460>>ASSIGN
     13491>>ASSIGN
B$TCB$
     12000**DCL     12285--IMP-PTR 13175>>ASSIGN  13304>>ASSIGN  13364>>ASSIGN  13401>>ASSIGN  13409>>ASSIGN
     13460>>ASSIGN  13491>>ASSIGN
BLK$
     12326**DCL     12207--IMP-PTR 12253--IMP-PTR 13041<<ASSIGN  13042>>ASSIGN  13105>>IF      13131>>DOCASE
     13140>>ASSIGN  13140>>ASSIGN  13179>>ASSIGN  13233>>DOINDEX 13235>>DOCASE  13238>>ASSIGN  13240>>ASSIGN
     13242>>IF      13244>>ASSIGN  13267>>IF      13270>>IF      13274>>ASSIGN  13283>>ASSIGN  13283>>ASSIGN
     13317>>ASSIGN  13339>>IF      13347>>DOWHILE 13348>>IF      13352>>ASSIGN  13358>>ASSIGN  13358>>ASSIGN
     13365>>ASSIGN  13385>>IF      13389>>ASSIGN  13416>>ASSIGN  13438>>IF      13446>>DOWHILE 13447>>IF
     13451>>ASSIGN  13454>>ASSIGN  13454>>ASSIGN  13461>>ASSIGN
BOUND IN PROCEDURE OUTPUT_MESSAGE
     13497**DCL     13495--PROC    13502>>ASSIGN
BUILTIN_ERR
     13090**LABEL   13045--CALLALT 13050--CALLALT 13060--CALLALT 13065--CALLALT 13068--CALLALT 13071--CALLALT
     13074--CALLALT
CNT
     12328**DCL     13109<<ASSIGN  13114>>CALLBLT 13115<<ASSIGN  13115>>ASSIGN  13122>>CALLBLT 13123<<ASSIGN
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:776  
     13123>>ASSIGN  13124<>CALL    13486<<ASSIGN  13487>>ASSIGN  13488<>CALL
CODE
     12321**DCL     13042<<ASSIGN  13045<>CALL    13047>>DOCASE  13084<>CALL    13092<>CALL    13301<>CALL
     13307<>CALL    13376>>DOCASE
DIRECTORY_CMD
     13099**PROC    13050--CALL
DIR_ERR IN PROCEDURE DIRECTORY_CMD
     13175**LABEL   13124--CALLALT 13150--CALLALT 13172--CALLALT
DO_CMD
     13262**PROC    13053--CALL
END_CMD
     13187**PROC    13057--CALL
ENTER_CMD
     13195**PROC    13077--CALL
ERASE_CMD
     13332**PROC    13060--CALL
ERASE_ERR IN PROCEDURE ERASE_CMD
     13364**LABEL   13343--CALLALT 13359--CALLALT
ERR
        10**DCL     13304<<ASSIGN  13310>>ASSIGN  13327>>ASSIGN
ERR.CODE
        14**DCL     13319>>IF
ERR.MID
        12**DCL     13325<<ASSIGN
ERR.MON
        13**DCL     13319>>IF
FID_ERR IN PROCEDURE DIRECTORY_CMD
     13178**LABEL   13156--GOTO    13160--GOTO    13163--GOTO
FID_RESULTS
     12754**DCL     13149--ASSIGN
FID_RESULTS.ACCT
     12754**DCL     13154>>IF
FID_RESULTS.NAME
     12754**DCL     13157>>IF
FID_RESULTS.PASS
     12754**DCL     13157>>IF
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:777  
FID_RESULTS.SN
     12754**DCL     13168>>IF
FID_RESULTS.WSN
     12754**DCL     13157>>IF
FPT_EXIT
     12362**DCL     13189<<ASSIGN  13191<>CALL
FPT_EXIT.V
     12362**DCL     13190--ASSIGN
FPT_EXIT.V.STEPCC#
     12363**DCL     12363--REDEF
FPT_EXIT.V_
     12362**DCL     13190<<ASSIGN
FPT_EXIT_C
     12347**DCL     13189>>ASSIGN
FPT_EXIT_C.V
     12347**DCL     12347--DCLINIT
FPT_EXIT_C.V.STEPCC#
     12348**DCL     12348--REDEF
FPT_FID
     12506**DCL     13138<<ASSIGN  13150<>CALL
FPT_FID.ACCT_
     12507**DCL     13143<<ASSIGN
FPT_FID.ASN_
     12509**DCL     13147<<ASSIGN
FPT_FID.NAME_
     12507**DCL     13142<<ASSIGN
FPT_FID.PASS_
     12507**DCL     13144<<ASSIGN
FPT_FID.RESULTS_
     12509**DCL     13149<<ASSIGN
FPT_FID.RES_
     12509**DCL     13148<<ASSIGN
FPT_FID.SN_
     12508**DCL     13145<<ASSIGN
FPT_FID.TEXTFID_
     12506**DCL     13140<<ASSIGN
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:778  
FPT_FID.V
     12510**DCL     13139--ASSIGN
FPT_FID.V_
     12506**DCL     13139<<ASSIGN
FPT_FID.WSN_
     12508**DCL     13146<<ASSIGN
FPT_FID_C
     12529**DCL     13138>>ASSIGN
FPT_FID_C.V
     12533**DCL     12529--DCLINIT
FPT_LDEV
     12578**DCL     13336<<ASSIGN  13343<>CALL    13359<>CALL    13436<<ASSIGN  13442<>CALL    13455<>CALL
FPT_LDEV.V
     12580**DCL     13337--ASSIGN  13437--ASSIGN
FPT_LDEV.V.DELETE#
     12582**DCL     13338<<ASSIGN
FPT_LDEV.V.STREAMNAME#
     12581**DCL     13342<<ASSIGN  13358<<ASSIGN  13441<<ASSIGN  13454<<ASSIGN
FPT_LDEV.V_
     12578**DCL     13337<<ASSIGN  13437<<ASSIGN
FPT_LDEV_C
     12553**DCL     13336>>ASSIGN  13436>>ASSIGN
FPT_LDEV_C.V
     12555**DCL     12553--DCLINIT
FPT_SETFMA
     12480**DCL     13130<<ASSIGN  13172<>CALL
FPT_SETFMA.ACCT_
     12480**DCL     13167<<ASSIGN
FPT_SETFMA.PSN_
     12480**DCL     13170<<ASSIGN
FPT_SETFMA_C
     12493**DCL     13130>>ASSIGN
FPT_TIME
     12621**DCL     13480<<ASSIGN  13485<>CALL
FPT_TIME.DATE_
     12621**DCL     13483<<ASSIGN
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:779  
FPT_TIME.DAY_
     12624**DCL     13482<<ASSIGN
FPT_TIME.TIME_
     12623**DCL     13484<<ASSIGN
FPT_TIME.V
     12625**DCL     13481--ASSIGN
FPT_TIME.V_
     12621**DCL     13481<<ASSIGN
FPT_TIME_C
     12602**DCL     13480>>ASSIGN
FPT_TIME_C.V
     12606**DCL     12602--DCLINIT
FPT_WRITE
     12455**DCL     13499<<ASSIGN  13510<>CALL
FPT_WRITE.BUF_
     12455**DCL     13501<<ASSIGN
FPT_WRITE.BUF_.BOUND
     12455**DCL     13502<<ASSIGN
FPT_WRITE.STATION_
     12457**DCL     12457--REDEF
FPT_WRITE.V
     12458**DCL     13500--ASSIGN
FPT_WRITE.V.DCB#
     12458**DCL     13509<<ASSIGN
FPT_WRITE.V.DVBYTE.VFC#
     12464**DCL     12464--REDEF
FPT_WRITE.V_
     12455**DCL     13500<<ASSIGN
FPT_WRITE_C
     12424**DCL     13499>>ASSIGN
FPT_WRITE_C.STATION_
     12426**DCL     12426--REDEF
FPT_WRITE_C.V
     12427**DCL     12424--DCLINIT
FPT_WRITE_C.V.DVBYTE.VFC#
     12433**DCL     12433--REDEF
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:780  
FPT_YC
     12396**DCL     13281<<ASSIGN  13292<>CALL
FPT_YC.CMD_
     12396**DCL     13283<<ASSIGN
FPT_YC.REPLY_
     12396**DCL     13284<<ASSIGN
FPT_YC.V
     12397**DCL     13282--ASSIGN
FPT_YC.V.LINK#
     12397**DCL     13285<<ASSIGN
FPT_YC.V.REPARSE#
     12398**DCL     13288<<ASSIGN  13290<<ASSIGN
FPT_YC.V_
     12396**DCL     13282<<ASSIGN
FPT_YC_C
     12379**DCL     13281>>ASSIGN
FPT_YC_C.V
     12380**DCL     12379--DCLINIT
GETCMD
      3136**DCL         7--PROC    13045<>CALL    13084<>CALL    13092<>CALL    13204--ASSIGN  13301<>CALL
     13307<>CALL    13322<>CALL    13379<>CALL    13382<>CALL    13390<>CALL    13406<>CALL    13421<>CALL
GETCMD.DCB_PARAM#
      3316**DCL     13418>>ASSIGN  13419<<ASSIGN  13423<<ASSIGN  13427<<ASSIGN
GETCMD.ERR#
      3147**DCL     13175<<ASSIGN  13178<<ASSIGN  13214<<ASSIGN  13215<<ASSIGN  13255<<ASSIGN  13273<<ASSIGN
     13327<<ASSIGN  13351<<ASSIGN  13364<<ASSIGN  13409<<ASSIGN  13450<<ASSIGN  13460<<ASSIGN  13491<<ASSIGN
GETCMD.ERRDCB#
      3295**DCL     13401<<ASSIGN
GETCMD.ERR_CODE
      3284**DCL     13396<<ASSIGN
GETCMD.F1_
      3333**DCL     13402<<ASSIGN
GETCMD.F2_
      3337**DCL     13403<<ASSIGN
GETCMD.F3_
      3341**DCL     13404<<ASSIGN
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:781  
GETCMD.FLGLEV#
      3241**DCL     13405<<ASSIGN
GETCMD.FPT$
      3433**DCL     13417<<ASSIGN
GETCMD.INDCB#
      3307**DCL     13206>>ASSIGN
GETCMD.OUT$
      3141**DCL      3147--REDEF
GETCMD.OUTDCB#
      3312**DCL     13207>>ASSIGN  13419>>ASSIGN  13504>>IF      13506>>ASSIGN
GETCMD.PCB$
      3161**DCL     13041>>ASSIGN  13179>>ASSIGN  13274>>ASSIGN  13317>>ASSIGN  13352>>ASSIGN  13365>>ASSIGN
     13410>>ASSIGN  13451>>ASSIGN  13461>>ASSIGN
GETCMD.UTIL$
      3437**DCL     13416<<ASSIGN
GETCMD.WORK$
      3169**DCL     13040>>ASSIGN
GETCMD.XT_PARAM$
      3405**DCL     13199>>IF      13205<<ASSIGN  13212<<ASSIGN  13225>>ASSIGN
GETCMD.XUH$
      3174**DCL     12649--IMP-PTR 13372>>IF      13374<<ASSIGN  13387>>ASSIGN  13389>>ASSIGN
GIVE_ERR_MSG IN PROCEDURE HELP_CMD
     13396**LABEL   13379--CALLALT 13382--CALLALT
HELP_CMD
     13370**PROC    13065--CALL
HELP_ERR IN PROCEDURE HELP_CMD
     13409**LABEL   13406--CALLALT
I IN PROCEDURE ENTER_CMD
     13197**DCL     13233<<DOINDEX 13235>>DOCASE  13238>>ASSIGN  13240>>ASSIGN  13242>>IF      13244>>ASSIGN
I IN PROCEDURE ERASE_CMD
     13334**DCL     13346<<ASSIGN  13347>>DOWHILE 13348>>IF      13352>>ASSIGN  13358>>ASSIGN  13358>>ASSIGN
     13360<<ASSIGN  13360>>ASSIGN  13365>>ASSIGN
I IN PROCEDURE PRINT_CMD
     13434**DCL     13445<<ASSIGN  13446>>DOWHILE 13447>>IF      13451>>ASSIGN  13454>>ASSIGN  13454>>ASSIGN
     13456<<ASSIGN  13456>>ASSIGN  13461>>ASSIGN
M$EXIT
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:782  
      9715**DCL-ENT 13191--CALL
M$FID
      9766**DCL-ENT 13150--CALL
M$LDEV
      9703**DCL-ENT 13343--CALL    13359--CALL    13442--CALL    13455--CALL
M$LO
     12332**DCL     13508<>CALL
M$LO#
     12330**DCL     13506<<ASSIGN  13508<>CALL    13509>>ASSIGN
M$SETFMA
      9703**DCL-ENT 13172--CALL
M$TIME
      9770**DCL-ENT 13485--CALL
M$WRITE
      9704**DCL-ENT 13510--CALL
M$YC
      9717**DCL-ENT 13292--CALL
M$YC_ERR IN PROCEDURE DO_CMD
     13304**LABEL   13292--CALLALT
NORMAL_RETURN IN PROCEDURE HELP_CMD
     13393**LABEL   13390--CALLALT
NULL_HELP_TOPIC
     12319**DCL     13387--ASSIGN
OUTBUFF
     12323**DCL     13108<<ASSIGN  13114<<CALLBLT 13122<<CALLBLT 13487<<ASSIGN  13501--ASSIGN
OUTPUT_CMD
     13414**PROC    13068--CALL
OUTPUT_ERR IN PROCEDURE OUTPUT_MESSAGE
     13514**LABEL   13508--CALLALT 13510--CALLALT
OUTPUT_MESSAGE
     13495**PROC    13124--CALL    13488--CALL
P$B.CODE
     12215**DCL     13042>>ASSIGN  13131>>DOCASE  13235>>DOCASE
P$B.CPOS
     12233**DCL     13179>>ASSIGN
P$B.NSUBLKS
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:783  
     12219**DCL     13105>>IF      13233>>DOINDEX 13339>>IF      13347>>DOWHILE 13385>>IF      13438>>IF
     13446>>DOWHILE
P$B.SUBLK$
     12240**DCL     13131>>DOCASE  13140>>ASSIGN  13140>>ASSIGN  13179>>ASSIGN  13235>>DOCASE  13238>>ASSIGN
     13240>>ASSIGN  13242>>IF      13244>>ASSIGN  13267>>IF      13270>>IF      13274>>ASSIGN  13283>>ASSIGN
     13283>>ASSIGN  13317>>ASSIGN  13348>>IF      13352>>ASSIGN  13358>>ASSIGN  13358>>ASSIGN  13365>>ASSIGN
     13389>>ASSIGN  13447>>IF      13451>>ASSIGN  13454>>ASSIGN  13454>>ASSIGN  13461>>ASSIGN
P$PCB
     12020**DCL     13201--ASSIGN
P$PCB.HI_CHAR
     12171**DCL     13179<<ASSIGN  13274<<ASSIGN  13317<<ASSIGN  13352<<ASSIGN  13365<<ASSIGN  13410<<ASSIGN
     13451<<ASSIGN  13461<<ASSIGN
P$PCB.OUT$
     12033**DCL     13041>>ASSIGN
P$S.COUNT
     12276**DCL     12279--IMP-SIZ 13140>>ASSIGN  13242>>IF      13267>>IF      13270>>IF      13283>>ASSIGN
     13348>>IF      13358>>ASSIGN  13447>>IF      13454>>ASSIGN
P$S.CPOS
     12268**DCL     13274>>ASSIGN  13317>>ASSIGN  13352>>ASSIGN  13365>>ASSIGN  13451>>ASSIGN  13461>>ASSIGN
P$S.TEXT
     12279**DCL     13140--ASSIGN  13283--ASSIGN  13358>>ASSIGN  13454>>ASSIGN
P$S.TEXTC$
     12271**DCL     13238>>ASSIGN  13240>>ASSIGN  13244>>ASSIGN  13389>>ASSIGN
POST_EXEC IN PROCEDURE DO_CMD
     13264**DCL     13266<<ASSIGN  13299>>IF      13301>>CALL    13305>>IF      13307>>CALL
PRINT_CMD
     13432**PROC    13071--CALL
PRINT_ERR IN PROCEDURE PRINT_CMD
     13460**LABEL   13442--CALLALT 13455--CALLALT
TBUFF
     12324**DCL     13148--ASSIGN
TEMPBUFF
     12325**DCL     13120<<CALLBLT 13121>>CALLBLT 13122>>CALLBLT
TIME_DATE_CMD
     13465**PROC    13074--CALL
TIME_ERR IN PROCEDURE TIME_DATE_CMD
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:784  
     13487**LABEL   13485--CALLALT 13488--CALLALT
TMDATE IN PROCEDURE TIME_DATE_CMD
     13467**DCL     13477--REDEF
TMDATE.DATE IN PROCEDURE TIME_DATE_CMD
     13469**DCL     13483--ASSIGN
TMDATE.DAY IN PROCEDURE TIME_DATE_CMD
     13476**DCL     13482--ASSIGN
TMDATE.TIME IN PROCEDURE TIME_DATE_CMD
     13471**DCL     13484--ASSIGN
TMDATEBUFF IN PROCEDURE TIME_DATE_CMD
     13477**DCL     13479<<ASSIGN  13487>>ASSIGN
TSTOR
     12329**DCL     13110<<CALLBLT 13111>>IF      13114>>CALLBLT 13115>>ASSIGN  13121<<CALLBLT 13122>>CALLBLT
     13123>>ASSIGN  13418<<ASSIGN  13423>>ASSIGN  13427>>ASSIGN
VLP_ACCT
     12728**DCL     13143--ASSIGN  13144--ASSIGN  13146--ASSIGN  13167--ASSIGN
VLP_ACCT.ACCT#
     12728**DCL     13154>>IF
VLP_NAME
     12715**DCL     13142--ASSIGN
VLP_SN
     12741**DCL     13145--ASSIGN
VLP_SN.NUM#
     12741**DCL     13161>>IF
VLP_SN.SN#
     12741**DCL     13170--ASSIGN
VLR_YC
     12405**DCL     13284--ASSIGN
VLR_YC.CPOS
     12405**DCL     13317>>ASSIGN
XT#CANT_ADAPT
     13005**DCL     13213>>IF
XT$
     12327**DCL     11387--IMP-PTR 13201<<ASSIGN  13202>>ASSIGN  13203>>ASSIGN  13204>>ASSIGN  13205>>ASSIGN
     13206>>ASSIGN  13207>>ASSIGN  13209>>CALL    13213>>IF      13215>>ASSIGN  13225<<ASSIGN  13226>>ASSIGN
     13227>>ASSIGN  13228>>ASSIGN  13229>>ASSIGN  13230>>ASSIGN  13231>>ASSIGN  13238>>ASSIGN  13240>>ASSIGN
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:785  
     13244>>ASSIGN  13250>>CALL    13255>>ASSIGN
XT_PARAM
     11387**DCL     13202<<ASSIGN  13209<>CALL    13250<>CALL
XT_PARAM.ERR
     11411**DCL     13213>>IF      13215>>ASSIGN  13255>>ASSIGN
XT_PARAM.FRAME.LEN
     11529**DCL     13230<<ASSIGN
XT_PARAM.FRAME.PT$
     11528**DCL     13227<<ASSIGN  13240<<ASSIGN
XT_PARAM.IBUF.LEN
     11571**DCL     13231<<ASSIGN
XT_PARAM.IBUF.PT$
     11570**DCL     13228<<ASSIGN  13244<<ASSIGN
XT_PARAM.INDCB
     11435**DCL     13206<<ASSIGN
XT_PARAM.OUTDCB
     11428**DCL     13207<<ASSIGN
XT_PARAM.SCRIPT.LEN
     11497**DCL     13229<<ASSIGN
XT_PARAM.SCRIPT.PT$
     11496**DCL     13226<<ASSIGN  13238<<ASSIGN
XT_PARAM.USER$
     11604**DCL     13204<<ASSIGN
XT_PARAM.XUG$
     11547**DCL     13203<<ASSIGN
XT_PARAM_C
     11700**DCL     13202>>ASSIGN
XUG
     10933**DCL     13201--ASSIGN
XUG.ADAPT$$
     11356**DCL     13209>>CALL    13211<<ASSIGN  13250>>CALL
XUG.BUF
     11369**DCL     11372--REDEF
XUG.DOCMD_SYNERR
     11074**DCL     13286>>IF      13291<<ASSIGN  13324<<ASSIGN
XUG.ERRDCB
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:786  
     11029**DCL     13311<<ASSIGN
XUG.ERRSAVE
     11022**DCL     13310<<ASSIGN
XUG.FIRST_ERROR
     11155**DCL     13313<<ASSIGN
XUG.LAST_FLAGLEV
     11320**DCL     13314<<ASSIGN
XUG.NO_INCREMENT
     11159**DCL     13312<<ASSIGN
XUG.POST_EXEC
     10986**DCL     13082>>IF      13084>>CALL    13090>>IF      13092>>CALL    13266>>ASSIGN
XUG.PRE_EXEC
     10982**DCL     13043>>IF      13045>>CALL
XUG.SYNERR
     11054**DCL     13323<<ASSIGN
XUG.XUH_PARAM
     11266**DCL     13374--ASSIGN
XUG#BDIRFID
     12775**DCL     13178>>ASSIGN
XUG#BIG4CHAR
     12867**DCL     13351>>ASSIGN  13450>>ASSIGN
XUG#DOCMD2BIG
     12821**DCL     13273>>ASSIGN
XUG#NO_ADAPT
     12959**DCL     13214>>ASSIGN
XUG#NO_MORE
     12913**DCL     13396>>ASSIGN
XUG$
     10928**DCL     10933--IMP-PTR 13040<<ASSIGN  13043>>IF      13045>>CALL    13082>>IF      13084>>CALL
     13090>>IF      13092>>CALL    13201>>ASSIGN  13203>>ASSIGN  13209>>CALL    13211>>ASSIGN  13250>>CALL
     13266>>ASSIGN  13286>>IF      13291>>ASSIGN  13310>>ASSIGN  13311>>ASSIGN  13312>>ASSIGN  13313>>ASSIGN
     13314>>ASSIGN  13323>>ASSIGN  13324>>ASSIGN  13374>>ASSIGN
XUG$ADAPTMEM
     10926**DCL-ENT 11894--DCLINIT
XUG$ALLMSG_COMMON
     10920**DCL-ENT 13382--CALL
PL6.E3A0      #016=XUG$BUILTIN_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:28 Page:787  
XUG$ERRMSG_COMMON
     10922**DCL-ENT 13406--CALL
XUG$FINDDCB_COMMON
     10923**DCL-ENT 13508--CALL
XUG$HELP_COMMON
     10921**DCL-ENT 13390--CALL
XUG$MOREMSG_COMMON
     10919**DCL-ENT 13379--CALL
XUG$OPENOUT_COMMON
     10924**DCL-ENT 13421--CALL
XUG$SINPUT
     10925**DCL-ENT 13322--CALL
XUH$PARAM.HELP$
     12659**DCL     13387<<ASSIGN  13389<<ASSIGN

PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:788  
     4095        1        /*T***********************************************************/
     4096        2        /*T*                                                         */
     4097        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     4098        4        /*T*                                                         */
     4099        5        /*T***********************************************************/
     4100        6        /* XUG$BLANK_PASSWORD_COMMON   Routine to LOCATE and BLANK the PASSWORDs.    */
     4101        7        XUG$BLANK_PASSWORD_COMMON: PROC(GETCMD_PARAM, P_B) ALTRET ;
     4102        8        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     4103        9        %INCLUDE XU_MACRO_C ;
     4104     3115    1   DCL GETCMD_PARAM UBIN WORD ;
     4105     3116        %PARSE$OUT (NAME=P_B, STCLASS=PARAM) ;
     4106     3161
     4107     3162        %INCLUDE XU_SUBS_C ;
     4108     3254        %PARSE$OUT (NAME=P$B, STCLASS=BASED) ;
     4109     3299    1   DCL I UBIN ;
     4110     3300
     4111     3301    1   DCL XUG$PASSWORD_BLANKER ENTRY(2) ALTRET ;
     4112     3302
     4113     3303    2       DO CASE(P_B.NDTYPE) ;
     4114     3304
     4115     3305    2       CASE( %ALTERN#,
     4116     3306    2         %KONCAT#,
     4117     3307    2         %LIST#,
     4118     3308    2         %RALTERN#) ;
     4119     3309    3           DO I=0 TO P_B.NSUBLKS-1 ;
     4120     3310    3               CALL XUG$BLANK_PASSWORD_COMMON(GETCMD_PARAM,
     4121     3311    3                 P_B.SUBLK$(I)->P$B) ALTRET(BP_ALT) ;
     4122     3312    3           END ;                     /* Do I */
     4123     3313
     4124     3314    2       CASE( %FID#) ;
     4125     3315    2           CALL XUG$PASSWORD_BLANKER(GETCMD_PARAM, P_B) ALTRET(BP_ALT) ;
     4126     3316
     4127     3317    2       END ;                          /* Do Case */
     4128     3318
     4129     3319    1       RETURN ;
     4130     3320
     4131     3321    1   BP_ALT:
PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:789  
     4132     3322    1       ALTRETURN ;
     4133     3323    1   END     XUG$BLANK_PASSWORD_COMMON ;
     4134     3324        %EOD;

PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:790  
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$BLANK_PASSWORD_COMMON.

   Procedure XUG$BLANK_PASSWORD_COMMON requires 59 words for executable code.
   Procedure XUG$BLANK_PASSWORD_COMMON requires 8 words of local(AUTO) storage.

PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:791  

 Object Unit name= XUG$BLANK_PASSWORD_COMMON                  File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:29:13.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    59     73  XUG$BLANK_PASSWORD_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        2  XUG$BLANK_PASSWORD_COMMON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XUG$PASSWORD_BLANKER
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:792  


     4095        1        /*T***********************************************************/
     4096        2        /*T*                                                         */
     4097        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     4098        4        /*T*                                                         */
     4099        5        /*T***********************************************************/
     4100        6        /* XUG$BLANK_PASSWORD_COMMON   Routine to LOCATE and BLANK the PASSWORDs.    */
     4101        7        XUG$BLANK_PASSWORD_COMMON: PROC(GETCMD_PARAM, P_B) ALTRET ;

      7  0 000000   000000 700200 xent  XUG$BLANK_P* TSX0  ! X66_AUTO_2
         0 000001   000010 000002                    ZERO    8,2

     4102        8        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     4103        9        %INCLUDE XU_MACRO_C ;
     4104     3115    1   DCL GETCMD_PARAM UBIN WORD ;
     4105     3116        %PARSE$OUT (NAME=P_B, STCLASS=PARAM) ;
     4106     3161
     4107     3162        %INCLUDE XU_SUBS_C ;
     4108     3254        %PARSE$OUT (NAME=P$B, STCLASS=BASED) ;
     4109     3299    1   DCL I UBIN ;
     4110     3300
     4111     3301    1   DCL XUG$PASSWORD_BLANKER ENTRY(2) ALTRET ;
     4112     3302
     4113     3303    2       DO CASE(P_B.NDTYPE) ;

   3303  0 000002   200004 470500                    LDP0    @P_B,,AUTO
         0 000003   000000 220100                    LDX0    0,,PR0
         0 000004   000077 360003                    ANX0    63,DU
         0 000005   000027 100003                    CMPX0   23,DU
         0 000006   000010 602010 0                  TNC     s:3303+6,X0
         0 000007   000071 710000 0                  TRA     s:3319
         0 000010   000071 710000 0                  TRA     s:3319
         0 000011   000037 710000 0                  TRA     s:3309
         0 000012   000037 710000 0                  TRA     s:3309
         0 000013   000037 710000 0                  TRA     s:3309
         0 000014   000071 710000 0                  TRA     s:3319
         0 000015   000071 710000 0                  TRA     s:3319
PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:793  
         0 000016   000071 710000 0                  TRA     s:3319
         0 000017   000071 710000 0                  TRA     s:3319
         0 000020   000037 710000 0                  TRA     s:3309
         0 000021   000071 710000 0                  TRA     s:3319
         0 000022   000071 710000 0                  TRA     s:3319
         0 000023   000071 710000 0                  TRA     s:3319
         0 000024   000071 710000 0                  TRA     s:3319
         0 000025   000071 710000 0                  TRA     s:3319
         0 000026   000071 710000 0                  TRA     s:3319
         0 000027   000071 710000 0                  TRA     s:3319
         0 000030   000071 710000 0                  TRA     s:3319
         0 000031   000071 710000 0                  TRA     s:3319
         0 000032   000071 710000 0                  TRA     s:3319
         0 000033   000071 710000 0                  TRA     s:3319
         0 000034   000071 710000 0                  TRA     s:3319
         0 000035   000071 710000 0                  TRA     s:3319
         0 000036   000065 710000 0                  TRA     s:3315

     4114     3304
     4115     3305    2       CASE( %ALTERN#,

     4116     3306    2         %KONCAT#,
     4117     3307    2         %LIST#,
     4118     3308    2         %RALTERN#) ;
     4119     3309    3           DO I=0 TO P_B.NSUBLKS-1 ;

   3309  0 000037   200005 450100                    STZ     I,,AUTO
         0 000040   000056 710000 0                  TRA     s:3312+3

     4120     3310    3               CALL XUG$BLANK_PASSWORD_COMMON(GETCMD_PARAM,

   3310  0 000041   200004 470500                    LDP0    @P_B,,AUTO
         0 000042   200005 720100                    LXL0    I,,AUTO
         0 000043   000003 471510                    LDP1    3,X0,PR0
         0 000044   200007 451500                    STP1    I+2,,AUTO
         0 000045   200003 236100                    LDQ     @GETCMD_PARAM,,AUTO
         0 000046   200006 756100                    STQ     I+1,,AUTO
PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:794  
         0 000047   200006 630500                    EPPR0   I+1,,AUTO
         0 000050   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000051   000000 701000 0                  TSX1    s:7
         0 000052   000072 702000 0                  TSX2    BP_ALT

     4121     3311    3                 P_B.SUBLK$(I)->P$B) ALTRET(BP_ALT) ;
     4122     3312    3           END ;                     /* Do I */

   3312  0 000053   200005 235100                    LDA     I,,AUTO
         0 000054   000001 035007                    ADLA    1,DL
         0 000055   200005 755100                    STA     I,,AUTO
         0 000056   200004 470500                    LDP0    @P_B,,AUTO
         0 000057   000001 236100                    LDQ     1,,PR0
         0 000060   000022 772000                    QRL     18
         0 000061   200005 116100                    CMPQ    I,,AUTO
         0 000062   000064 600000 0                  TZE     s:3312+9
         0 000063   000041 603000 0                  TRC     s:3310
         0 000064   000071 710000 0                  TRA     s:3319

     4123     3313
     4124     3314    2       CASE( %FID#) ;

     4125     3315    2           CALL XUG$PASSWORD_BLANKER(GETCMD_PARAM, P_B) ALTRET(BP_ALT) ;

   3315  0 000065   200003 630500                    EPPR0   @GETCMD_PARAM,,AUTO
         0 000066   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000067   000000 701000 xent               TSX1    XUG$PASSWORD_BLANKER
         0 000070   000072 702000 0                  TSX2    BP_ALT

     4126     3316
     4127     3317    2       END ;                          /* Do Case */

     4128     3318
     4129     3319    1       RETURN ;

   3319  0 000071   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:795  
     4130     3320
     4131     3321    1   BP_ALT:
     4132     3322    1       ALTRETURN ;

   3322  0 000072   000000 702200 xent  BP_ALT       TSX2  ! X66_AALT
     4133     3323    1   END     XUG$BLANK_PASSWORD_COMMON ;
     4134     3324        %EOD;

PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:796  
--  Include file information  --

   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$BLANK_PASSWORD_COMMON.
PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:797  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GETCMD_PARAM              4-0-0/w PTR         r     1 @P_B
    *0-0-0/w UBIN        r     1 GETCMD_PARAM               5-0-0/w UBIN        r     1 I
    *0-0-0/w STRC(144)   r     1 P_B

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 P$B


   Procedure XUG$BLANK_PASSWORD_COMMON requires 59 words for executable code.
   Procedure XUG$BLANK_PASSWORD_COMMON requires 8 words of local(AUTO) storage.
PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:798  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #017=XUG$BLANK_PASSWORD_COMMON File=XUG$COMMON.:E05TSI             WED 07/30/97 09:29 Page:799  
          MINI XREF LISTING

BP_ALT
      3322**LABEL    3310--CALLALT  3315--CALLALT
GETCMD_PARAM
      3115**DCL         7--PROC     3310<>CALL     3315<>CALL
I
      3299**DCL      3309<<DOINDEX  3310>>CALL
P$B
      3260**DCL      3310<>CALL
P_B
      3122**DCL         7--PROC     3315<>CALL
P_B.NDTYPE
      3125**DCL      3303>>DOCASE
P_B.NSUBLKS
      3134**DCL      3309>>DOINDEX
P_B.SUBLK$
      3155**DCL      3310>>CALL
XUG$BLANK_PASSWORD_COMMON
         7**PROC     3310--CALL
XUG$PASSWORD_BLANKER
      3301**DCL-ENT  3315--CALL

PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:800  
     4135        1        /*T***********************************************************/
     4136        2        /*T*                                                         */
     4137        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     4138        4        /*T*                                                         */
     4139        5        /*T***********************************************************/
     4140        6        /* XUG$PASSWORD_BLANKER   Routine to do the actual BLANKing of PASSWORDs.    */
     4141        7        XUG$PASSWORD_BLANKER: PROC(GETCMD,P_S) ALTRET ;
     4142        8        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     4143        9        %INCLUDE XU_MACRO_C ;
     4144     3115        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     4145     3453        %PARSE$SYM (NAME=P_S, STCLASS=PARAM) ;
     4146     3491
     4147     3492        %INCLUDE CP_6 ;
     4148     9051        %INCLUDE XUH_MACRO_C ;
     4149     9135
     4150     9136    1   DCL I UBIN ;
     4151     9137    1   DCL XUG$ PTR ;
     4152     9138        %XUG_PARAMS ;
     4153     9582    1   DCL B$TCB$ PTR SYMREF ;
     4154     9583        %B$TCB(STCLASS="BASED(B$TCB$)") ;
     4155     9586        %B$ALT(STCLASS=BASED) ;
     4156     9594        %FPT_FID (FPTN=FPT_FID_C, STCLASS=CONSTANT) ;
     4157     9617        %FPT_FID (FPTN=FPT_FID, STCLASS=AUTO) ;
     4158     9640        %VLP_NAME (FPTN=VLP_NAME, STCLASS=AUTO) ;
     4159     9667        %VLP_ACCT (FPTN=VLP_ACCT, STCLASS=AUTO) ;
     4160     9680        %VLP_SN (FPTN=VLP_SN, N=50, STCLASS=AUTO) ;
     4161     9693        %VLR_FID (FPTN=FID_RESULTS, STCLASS=AUTO) ;
     4162     9712    1   DCL ASN UBIN(9) ;                       /* Fid assignment type */
     4163     9713    1   DCL TBUFF CHAR(8) ;
     4164     9714    1   DCL VARY$ PTR ;
     4165     9715    1   DCL VSIZE UBIN ;
     4166     9716    1   DCL VARY$STR CHAR(VSIZE) BASED(VARY$) ;
     4167     9717
     4168     9718    1       FPT_FID = FPT_FID_C ;
     4169     9719    1       FPT_FID.V_ = VECTOR(FPT_FID.V) ;
     4170     9720    1       FPT_FID.TEXTFID_=VECTOR(P_S.TEXT) ;
     4171     9721    1       FPT_FID.NAME_ = VECTOR(VLP_NAME) ;
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:801  
     4172     9722    1       FPT_FID.ACCT_ = VECTOR(VLP_ACCT) ;
     4173     9723    1       FPT_FID.PASS_ = VECTOR(VLP_ACCT) ;
     4174     9724    1       FPT_FID.SN_ = VECTOR(VLP_SN) ;
     4175     9725    1       FPT_FID.WSN_ = VECTOR(VLP_ACCT) ;
     4176     9726    1       FPT_FID.ASN_ = VECTOR(ASN) ;
     4177     9727    1       FPT_FID.RES_ = VECTOR(TBUFF) ;
     4178     9728    1       FPT_FID.RESULTS_ = VECTOR(FID_RESULTS) ;
     4179     9729    1       CALL M$FID(FPT_FID) ALTRET(BLANK_ALT) ;
     4180     9730
     4181     9731    1       IF FID_RESULTS.PASS
     4182     9732    1       THEN
     4183     9733    2       DO ;
     4184     9734    2           XUG$ = GETCMD.WORK$ ;
     4185     9735    2           VARY$ = PINCRC(VBASE(XUG.BUFVEC), P_S.CPOS) ;
     4186     9736    2           VARY$ = PINCRC(VARY$, FID_RESULTS.SINDEX.PASS-1) ;
     4187     9737    2           VSIZE = FID_RESULTS.CLENGTH.PASS+1 ;
     4188     9738    2           VARY$STR = ' ' ;
     4189     9739    2       END ;                        /* Then Do */
     4190     9740
     4191     9741    1   BLANK_ALT:
     4192     9742
     4193     9743    1       RETURN;
     4194     9744
     4195     9745    1   END     XUG$PASSWORD_BLANKER ;
     4196     9746        %EOD;

PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:802  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$PASSWORD_BLANKER.

   Procedure XUG$PASSWORD_BLANKER requires 93 words for executable code.
   Procedure XUG$PASSWORD_BLANKER requires 136 words of local(AUTO) storage.

PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:803  

 Object Unit name= XUG$PASSWORD_BLANKER                       File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:29:22.16 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     24     30  XUG$PASSWORD_BLANKER
    2   Proc  even  none    93    135  XUG$PASSWORD_BLANKER
    3  RoData even  none     6      6  XUG$PASSWORD_BLANKER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  XUG$PASSWORD_BLANKER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                B_VECTNIL
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:804  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:805  


     4135        1        /*T***********************************************************/
     4136        2        /*T*                                                         */
     4137        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     4138        4        /*T*                                                         */
     4139        5        /*T***********************************************************/
     4140        6        /* XUG$PASSWORD_BLANKER   Routine to do the actual BLANKing of PASSWORDs.    */
     4141        7        XUG$PASSWORD_BLANKER: PROC(GETCMD,P_S) ALTRET ;

      7  2 000000   000000 700200 xent  XUG$PASSWOR* TSX0  ! X66_AUTO_2
         2 000001   000210 000002                    ZERO    136,2

     4142        8        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     4143        9        %INCLUDE XU_MACRO_C ;
     4144     3115        %XUG_GETCMD (NAME=GETCMD, STCLASS=PARAM) ;
     4145     3453        %PARSE$SYM (NAME=P_S, STCLASS=PARAM) ;
     4146     3491
     4147     3492        %INCLUDE CP_6 ;
     4148     9051        %INCLUDE XUH_MACRO_C ;
     4149     9135
     4150     9136    1   DCL I UBIN ;
     4151     9137    1   DCL XUG$ PTR ;
     4152     9138        %XUG_PARAMS ;
     4153     9582    1   DCL B$TCB$ PTR SYMREF ;
     4154     9583        %B$TCB(STCLASS="BASED(B$TCB$)") ;
     4155     9586        %B$ALT(STCLASS=BASED) ;
     4156     9594        %FPT_FID (FPTN=FPT_FID_C, STCLASS=CONSTANT) ;
     4157     9617        %FPT_FID (FPTN=FPT_FID, STCLASS=AUTO) ;
     4158     9640        %VLP_NAME (FPTN=VLP_NAME, STCLASS=AUTO) ;
     4159     9667        %VLP_ACCT (FPTN=VLP_ACCT, STCLASS=AUTO) ;
     4160     9680        %VLP_SN (FPTN=VLP_SN, N=50, STCLASS=AUTO) ;
     4161     9693        %VLR_FID (FPTN=FID_RESULTS, STCLASS=AUTO) ;
     4162     9712    1   DCL ASN UBIN(9) ;                       /* Fid assignment type */
     4163     9713    1   DCL TBUFF CHAR(8) ;
     4164     9714    1   DCL VARY$ PTR ;
     4165     9715    1   DCL VSIZE UBIN ;
     4166     9716    1   DCL VARY$STR CHAR(VSIZE) BASED(VARY$) ;
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:806  
     4167     9717
     4168     9718    1       FPT_FID = FPT_FID_C ;

   9718  2 000002   000100 100400                    MLR     fill='000'O
         2 000003   000000 000140 1                  ADSC9   FPT_FID_C                cn=0,n=96
         2 000004   200010 000140                    ADSC9   FPT_FID,,AUTO            cn=0,n=96

     4169     9719    1       FPT_FID.V_ = VECTOR(FPT_FID.V) ;

   9719  2 000005   000000 235000 3                  LDA     0
         2 000006   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000007   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000010   000034 036003                    ADLQ    28,DU
         2 000011   200010 757100                    STAQ    FPT_FID,,AUTO

     4170     9720    1       FPT_FID.TEXTFID_=VECTOR(P_S.TEXT) ;

   9720  2 000012   200004 470500                    LDP0    @P_S,,AUTO
         2 000013   000004 236100                    LDQ     4,,PR0
         2 000014   000033 772000                    QRL     27
         2 000015   000064 737000                    LLS     52
         2 000016   000140 135007                    SBLA    96,DL
         2 000017   200004 236100                    LDQ     @P_S,,AUTO
         2 000020   000001 036000 3                  ADLQ    1
         2 000021   200012 757100                    STAQ    FPT_FID+2,,AUTO

     4171     9721    1       FPT_FID.NAME_ = VECTOR(VLP_NAME) ;

   9721  2 000022   000002 235000 3                  LDA     2
         2 000023   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000024   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000025   000040 036003                    ADLQ    32,DU
         2 000026   200014 757100                    STAQ    FPT_FID+4,,AUTO

     4172     9722    1       FPT_FID.ACCT_ = VECTOR(VLP_ACCT) ;

   9722  2 000027   000003 235000 3                  LDA     3
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:807  
         2 000030   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000031   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000032   000050 036003                    ADLQ    40,DU
         2 000033   200016 757100                    STAQ    FPT_FID+6,,AUTO

     4173     9723    1       FPT_FID.PASS_ = VECTOR(VLP_ACCT) ;

   9723  2 000034   000003 235000 3                  LDA     3
         2 000035   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000036   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000037   000050 036003                    ADLQ    40,DU
         2 000040   200020 757100                    STAQ    FPT_FID+8,,AUTO

     4174     9724    1       FPT_FID.SN_ = VECTOR(VLP_SN) ;

   9724  2 000041   000004 235000 3                  LDA     4
         2 000042   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000043   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000044   000052 036003                    ADLQ    42,DU
         2 000045   200022 757100                    STAQ    FPT_FID+10,,AUTO

     4175     9725    1       FPT_FID.WSN_ = VECTOR(VLP_ACCT) ;

   9725  2 000046   000003 235000 3                  LDA     3
         2 000047   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000050   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000051   000050 036003                    ADLQ    40,DU
         2 000052   200024 757100                    STAQ    FPT_FID+12,,AUTO

     4176     9726    1       FPT_FID.ASN_ = VECTOR(ASN) ;

   9726  2 000053   777640 235007                    LDA     -96,DL
         2 000054   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000055   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000056   000200 036003                    ADLQ    128,DU
         2 000057   200026 757100                    STAQ    FPT_FID+14,,AUTO

PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:808  
     4177     9727    1       FPT_FID.RES_ = VECTOR(TBUFF) ;

   9727  2 000060   000003 235000 3                  LDA     3
         2 000061   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000062   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000063   000201 036003                    ADLQ    129,DU
         2 000064   200030 757100                    STAQ    FPT_FID+16,,AUTO

     4178     9728    1       FPT_FID.RESULTS_ = VECTOR(FID_RESULTS) ;

   9728  2 000065   000005 235000 3                  LDA     5
         2 000066   200206 452500                    STP2    VSIZE+2,,AUTO
         2 000067   200206 236100                    LDQ     VSIZE+2,,AUTO
         2 000070   000166 036003                    ADLQ    118,DU
         2 000071   200032 757100                    STAQ    FPT_FID+18,,AUTO

     4179     9729    1       CALL M$FID(FPT_FID) ALTRET(BLANK_ALT) ;

   9729  2 000072   200010 630500                    EPPR0   FPT_FID,,AUTO
         2 000073   420001 713400                    CLIMB   alt,+8193
         2 000074   404400 401760                    pmme    nvectors=10
         2 000075   000134 702000 2                  TSX2    BLANK_ALT

     4180     9730
     4181     9731    1       IF FID_RESULTS.PASS

   9731  2 000076   200166 236100                    LDQ     FID_RESULTS,,AUTO
         2 000077   100000 316003                    CANQ    32768,DU
         2 000100   000134 600000 2                  TZE     BLANK_ALT

     4182     9732    1       THEN
     4183     9733    2       DO ;

     4184     9734    2           XUG$ = GETCMD.WORK$ ;

   9734  2 000101   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000102   000004 236100                    LDQ     4,,PR0
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:809  
         2 000103   200006 756100                    STQ     XUG$,,AUTO

     4185     9735    2           VARY$ = PINCRC(VBASE(XUG.BUFVEC), P_S.CPOS) ;

   9735  2 000104   200004 471500                    LDP1    @P_S,,AUTO
         2 000105   100002 236100                    LDQ     2,,PR1
         2 000106   200006 473500                    LDP3    XUG$,,AUTO
         2 000107   300001 474500                    LDP4    1,,PR3
         2 000110   000011 402007                    MPY     9,DL
         2 000111   400000 503506                    ABD     0,QL,PR4
         2 000112   200203 454500                    STP4    VARY$,,AUTO

     4186     9736    2           VARY$ = PINCRC(VARY$, FID_RESULTS.SINDEX.PASS-1) ;

   9736  2 000113   200171 236100                    LDQ     FID_RESULTS+3,,AUTO
         2 000114   000022 772000                    QRL     18
         2 000115   000777 376007                    ANQ     511,DL
         2 000116   000020 736000                    QLS     16
         2 000117   200000 136007                    SBLQ    65536,DL
         2 000120   200203 036100                    ADLQ    VARY$,,AUTO
         2 000121   200203 756100                    STQ     VARY$,,AUTO

     4187     9737    2           VSIZE = FID_RESULTS.CLENGTH.PASS+1 ;

   9737  2 000122   200173 236100                    LDQ     FID_RESULTS+5,,AUTO
         2 000123   000011 772000                    QRL     9
         2 000124   000777 376007                    ANQ     511,DL
         2 000125   000001 036007                    ADLQ    1,DL
         2 000126   200204 756100                    STQ     VSIZE,,AUTO

     4188     9738    2           VARY$STR = ' ' ;

   9738  2 000127   200203 474500                    LDP4    VARY$,,AUTO
         2 000130   000000 620006                    EAX0    0,QL
         2 000131   040140 100400                    MLR     fill='040'O
         2 000132   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000133   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:810  

     4189     9739    2       END ;                        /* Then Do */

     4190     9740
     4191     9741    1   BLANK_ALT:
     4192     9742
     4193     9743    1       RETURN;

   9743  2 000134   000000 702200 xent  BLANK_ALT    TSX2  ! X66_ARET
     4194     9744
     4195     9745    1   END     XUG$PASSWORD_BLANKER ;
     4196     9746        %EOD;

PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:811  
--  Include file information  --

   XUH_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure XUG$PASSWORD_BLANKER.
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:812  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$PASSWORD_BLANKER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(864)   r     1 FPT_FID_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GETCMD                    4-0-0/w PTR         r     1 @P_S
   200-0-0/w UBIN(9)     r     1 ASN                      166-0-0/d STRC(324)   r     1 FID_RESULTS
    10-0-0/d STRC(864)   r     1 FPT_FID                   *0-0-0/d STRC(1512)  r     1 GETCMD
    *0-0-0/w ASTR(153)   r     1 P_S                      201-0-0/c CHAR(8)     r     1 TBUFF
   203-0-0/w PTR         r     1 VARY$                     50-0-0/c STRC(72)    r     1 VLP_ACCT
    40-0-0/c STRC(288)   r     1 VLP_NAME                  52-0-0/d STRC(2736)  r     1 VLP_SN
   204-0-0/w UBIN        r     1 VSIZE                      6-0-0/w PTR         r     1 XUG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 VARY$STR                   0-0-0/d STRC(9612)  r     1 XUG

PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:813  

   Procedure XUG$PASSWORD_BLANKER requires 93 words for executable code.
   Procedure XUG$PASSWORD_BLANKER requires 136 words of local(AUTO) storage.
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:814  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:815  
          MINI XREF LISTING

ASN
      9712**DCL      9726--ASSIGN
B$ALT.CODE
      9588**DCL      9588--REDEF    9589--REDEF    9589--REDEF
B$ALT.ERR.ERR#
      9590**DCL      9590--REDEF
B$ALT.EVID
      9589**DCL      9589--REDEF    9589--REDEF
B$TCB$
      9582**DCL      9584--IMP-PTR
BLANK_ALT
      9743**LABEL    9729--CALLALT
FID_RESULTS
      9704**DCL      9728--ASSIGN
FID_RESULTS.CLENGTH.PASS
      9709**DCL      9737>>ASSIGN
FID_RESULTS.PASS
      9704**DCL      9731>>IF
FID_RESULTS.SINDEX.PASS
      9707**DCL      9736>>ASSIGN
FPT_FID
      9628**DCL      9718<<ASSIGN   9729<>CALL
FPT_FID.ACCT_
      9629**DCL      9722<<ASSIGN
FPT_FID.ASN_
      9631**DCL      9726<<ASSIGN
FPT_FID.NAME_
      9629**DCL      9721<<ASSIGN
FPT_FID.PASS_
      9629**DCL      9723<<ASSIGN
FPT_FID.RESULTS_
      9631**DCL      9728<<ASSIGN
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:816  
FPT_FID.RES_
      9631**DCL      9727<<ASSIGN
FPT_FID.SN_
      9630**DCL      9724<<ASSIGN
FPT_FID.TEXTFID_
      9628**DCL      9720<<ASSIGN
FPT_FID.V
      9632**DCL      9719--ASSIGN
FPT_FID.V_
      9628**DCL      9719<<ASSIGN
FPT_FID.WSN_
      9630**DCL      9725<<ASSIGN
FPT_FID_C
      9605**DCL      9718>>ASSIGN
FPT_FID_C.V
      9609**DCL      9605--DCLINIT
GETCMD
      3128**DCL         7--PROC
GETCMD.OUT$
      3133**DCL      3139--REDEF
GETCMD.WORK$
      3161**DCL      9734>>ASSIGN
M$FID
      9042**DCL-ENT  9729--CALL
P_S
      3460**DCL         7--PROC
P_S.COUNT
      3483**DCL      3486--IMP-SIZ  9720>>ASSIGN
P_S.CPOS
      3475**DCL      9735>>ASSIGN
P_S.TEXT
      3486**DCL      9720--ASSIGN
TBUFF
      9713**DCL      9727--ASSIGN
VARY$
      9714**DCL      9716--IMP-PTR  9735<<ASSIGN   9736<<ASSIGN   9736>>ASSIGN   9738>>ASSIGN
PL6.E3A0      #018=XUG$PASSWORD_BLANKER File=XUG$COMMON.:E05TSI                  WED 07/30/97 09:29 Page:817  
VARY$STR
      9716**DCL      9738<<ASSIGN
VLP_ACCT
      9678**DCL      9722--ASSIGN   9723--ASSIGN   9725--ASSIGN
VLP_NAME
      9665**DCL      9721--ASSIGN
VLP_SN
      9691**DCL      9724--ASSIGN
VSIZE
      9715**DCL      9716--IMP-SIZ  9737<<ASSIGN   9738>>ASSIGN
XUG.BUF
      9577**DCL      9580--REDEF
XUG.BUFVEC
      9142**DCL      9735>>ASSIGN
XUG$
      9137**DCL      9141--IMP-PTR  9734<<ASSIGN   9735>>ASSIGN

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:818  
     4197        1        /*T***********************************************************/
     4198        2        /*T*                                                         */
     4199        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     4200        4        /*T*                                                         */
     4201        5        /*T***********************************************************/
     4202        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     4203        7        XUG$OPENOUT_COMMON:PROC( GETCMD) ALTRET;
     4204        8        /*F*
     4205        9             NAME: XUG$OPENOUT_COMMON
     4206       10              DESCRIPTION: Common code for the (ON|TO|OVER|INTO) FID clause in
     4207       11                  commands.  Opens the requested DCB as specified by the user.
     4208       12
     4209       13             CALL:   CALL XUG$OPENOUT_COMMON( GETCMD) ALTRET(ERR);
     4210       14
     4211       15                  In case of an error, the dcb is left closed and the error is
     4212       16                  described by the ALTRET frame in the TCB.
     4213       17                  It is the responsibility of the calling program to re-open the
     4214       18                  DCB after an error, if required.
     4215       19                  Each of the parameters is optional.  All of the parameters
     4216       20                  are never modified.
     4217       21             INPUT:
     4218       22             GETCMD.DCB_PARAM# - The number of the DCB to be opened.  Overrides the DCB
     4219       23                  in the FPT_OPEN when both are passed.
     4220       24
     4221       25             GETCMD.UTIL$ - Pointer to the output block returned by X$PARSE,
     4222       26                  for the XUG$OPENOUT_SPEC or XUG$OPENOUT_OPT parse nodes.
     4223       27                  If omitted, the values in FPT_OPEN will be used.
     4224       28
     4225       29             GETCMD.FPT$ - A pointer to a FPT for M$OPEN.  FPT_OPEN.V.DCB# must be set
     4226       30                  to the number of the DCB to be opened, unless GETCMD.DCB_PARAM# is
     4227       31                  set.  The remaining M$OPEN parameters should be set to the desired
     4228       32                  values.  If omitted, the following default values, typical for
     4229       33                  the OUTPUT command, will be used:
     4230       34
     4231       35                       %FPT_OPEN (DCB=M$LO,
     4232       36                        SCRUB=YES,
     4233       37                        ORG=UR,
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:819  
     4234       38                        ACS=SEQUEN,
     4235       39                        ASN=DEVICE,
     4236       40                        RES='ME',
     4237       41                        FUN=CREATE,
     4238       42                        EXIST=ERROR);
     4239       43
     4240       44                 Other parameters (SETDCB, REASSIGN)  may be of interest
     4241       45                 for other purposes.
     4242       46        */
     4243       47
     4244       48        %INCLUDE CP_6;
     4245     5607        %INCLUDE CP_6_SUBS;
     4246     6147        %INCLUDE XU_MACRO_C; /* XUR MACROs */
     4247     9253        %INCLUDE XU_SUBS_C; /* Parse node EQUs */
     4248     9345        %INCLUDE XU_PERR_C;
     4249     9536
     4250     9537        %XUG_GETCMD (NAME=GETCMD, STCLASS="");
     4251     9875        %PARSE$OUT (STCLASS="BASED(GETCMD.UTIL$)");
     4252     9920        %FPT_OPEN (STCLASS="BASED(GETCMD.FPT$)");
     4253    10029
     4254    10030    1   DCL M$LO# UBIN WORD;
     4255    10031    1   DCL BLK$ PTR;
     4256    10032    1   DCL OPT$ PTR;
     4257    10033    1   DCL TEMP UBIN;
     4258    10034    1   DCL SUBLK UBIN;
     4259    10035    1   DCL SECOND_TRY_FLAG BIT (1);
     4260    10036
     4261    10037    1   DCL 1 M$LO CONSTANT,
     4262    10038    1         2 L UBIN BYTE CALIGNED INIT (4),
     4263    10039    1         2 C CHAR (4) INIT ('M$LO');
     4264    10040
     4265    10041        %FPT_OPEN (FPTN=DEFAULT_OPEN,
     4266    10042         STCLASS=CONSTANT,
     4267    10043         SCRUB=YES,
     4268    10044         ORG=UR,
     4269    10045         ACS=SEQUEN,
     4270    10046         ASN=DEVICE,
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:820  
     4271    10047         RES='ME',
     4272    10048         FUN=CREATE,
     4273    10049         EXIST=ERROR);
     4274    10158
     4275    10159        %F$DCB;
     4276    10216        %PARSE$OUT (NAME=O$BLK,
     4277    10217         STCLASS="BASED(BLK$)");
     4278    10262        %PARSE$SYM (NAME=O$SYM,
     4279    10263         STCLASS=BASED);
     4280    10301
     4281    10302        %FPT_FID(STCLASS=CONSTANT);
     4282    10325        %FPT_CLOSE(DISP=SAVE,
     4283    10326         STCLASS=CONSTANT);
     4284    10368
     4285    10369        %FPT_FID(FPTN=Y$FID,
     4286    10370         STCLASS=AUTO);
     4287    10393        %FPT_CLOSE(FPTN=Y$CLOSE,
     4288    10394         STCLASS=AUTO);
     4289    10436        %FPT_OPEN (FPTN=Y$OPEN,
     4290    10437         STCLASS=AUTO);
     4291    10546        %VLP_NAME(FPTN=Y$NAME,
     4292    10547         STCLASS=AUTO);
     4293    10574        %VLP_ACCT(FPTN=Y$ACCT,
     4294    10575         STCLASS=AUTO);
     4295    10588        %VLP_PASS(FPTN=Y$PASS,
     4296    10589         STCLASS=AUTO);
     4297    10602        %VLP_SN(FPTN=Y$SN,
     4298    10603         STCLASS=AUTO);
     4299    10616        %VLP_WSN(FPTN=Y$WSN,
     4300    10617         STCLASS=AUTO);
     4301    10630        %VLP_FORM(FPTN=Y$FORM,
     4302    10631          STCLASS=AUTO);
     4303    10644
     4304    10645        %VLP_ERRCODE (FPTN=XUG#BAD_OUTPUT_ORG, STCLASS=CONSTANT,
     4305    10646                      FCG=XU, MID=G, ERR#=%E$XUG#BAD_OUTPUT_ORG, SEV=0);
     4306    10691        %VLP_ERRCODE (FPTN=XUG#NO_M$LO_DCB, STCLASS=CONSTANT,
     4307    10692                      FCG=XU, MID=G, ERR#=%E$XUG#NO_M$LO_DCB, SEV=0);
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:821  
     4308    10737
     4309    10738    1   DCL XUG$FINDDCB_COMMON ENTRY (2) ALTRET;
     4310    10739
     4311    10740    1   DCL B$TCB$ PTR SYMREF READONLY;
     4312    10741        %B$TCB;
     4313    10744        %B$ALT;
     4314    10752
     4315    10753    1       SECOND_TRY_FLAG = %NO#;
     4316    10754
     4317    10755    1   SETUP_FPT:
     4318    10756
     4319    10757    1       IF GETCMD.FPT$ = ADDR(NIL) OR SECOND_TRY_FLAG
     4320    10758    2       THEN DO;
     4321    10759
     4322    10760    2           Y$OPEN = DEFAULT_OPEN;
     4323    10761    2           IF GETCMD.DCB_PARAM# = DCBNUM(NIL)
     4324    10762    3           THEN DO;
     4325    10763
     4326    10764    3               CALL XUG$FINDDCB_COMMON (M$LO, M$LO#)
     4327    10765    4               WHENALTRETURN DO;
     4328    10766
     4329    10767    4                   GETCMD.ERRDCB# = DCBNUM(NIL);
     4330    10768    4                   GETCMD.ERR# = XUG#NO_M$LO_DCB;
     4331    10769
     4332    10770        /*E*  ERROR: XUG-E$XUG#NO_M$LO_DCB
     4333    10771              MESSAGE: The M$LO DCB does not exist.
     4334    10772        */
     4335    10773
     4336    10774    4                   ALTRETURN;
     4337    10775
     4338    10776    4               END;
     4339    10777
     4340    10778    3               Y$OPEN.V.DCB# = M$LO#;
     4341    10779
     4342    10780    3           END;
     4343    10781
     4344    10782    2       END;
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:822  
     4345    10783
     4346    10784    1       ELSE Y$OPEN = FPT_OPEN;
     4347    10785    1       Y$OPEN.V_ = VECTOR(Y$OPEN.V);
     4348    10786
     4349    10787    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)
     4350    10788    1       THEN Y$OPEN.V.DCB# = GETCMD.DCB_PARAM#;
     4351    10789
     4352    10790    1       IF GETCMD.UTIL$ ~= ADDR(NIL) AND NOT SECOND_TRY_FLAG    /* out$blk passed */
     4353    10791    2       THEN DO;
     4354    10792    2           OPT$ = OUT$BLK.SUBLK$(0); /* pointer to fid */
     4355    10793    2           IF OUT$BLK.NSUBLKS > 1
     4356    10794    2             AND (OUT$BLK.SUBLK$(OUT$BLK.NSUBLKS-1)->O$BLK.CODE ~= %XUG_OUTOPTS
     4357    10795    2             OR OUT$BLK.NSUBLKS > 2)
     4358    10796    3           THEN DO; /* preposition present */
     4359    10797    3               OPT$ = OUT$BLK.SUBLK$(1);
     4360    10798    4               DO CASE(OUT$BLK.SUBLK$(0)->O$BLK.CODE);
     4361    10799    4               CASE(%XUG_CREATE);
     4362    10800    4                   Y$OPEN.V.FUN# = %CREATE#;
     4363    10801    4                   Y$OPEN.V.EXIST# = %ERROR#;
     4364    10802    4               CASE(%XUG_REPLACE);
     4365    10803    4                   Y$OPEN.V.FUN# = %CREATE#;
     4366    10804    4                   Y$OPEN.V.EXIST# = %NEWFILE#;
     4367    10805    4               CASE(%XUG_EXTEND);
     4368    10806    4                   Y$OPEN.V.FUN# = %CREATE#;
     4369    10807    4                   Y$OPEN.V.EXIST# = %OLDFILE#;
     4370    10808    4               END /* CASE */;
     4371    10809    3           END /* IF preposition */;
     4372    10810
     4373    10811    3           IF OUT$BLK.NSUBLKS > 0 THEN DO; /* FID present */
     4374    10812    3               Y$FID = FPT_FID;
     4375    10813    3               Y$FID.V_ = VECTOR(Y$FID.V);
     4376    10814    3               Y$FID.ACCT_ = VECTOR(Y$ACCT);
     4377    10815    3               Y$FID.NAME_ = VECTOR(Y$NAME);
     4378    10816    3               Y$FID.PASS_ = VECTOR(Y$PASS);
     4379    10817    3               Y$FID.SN_ = VECTOR(Y$SN);
     4380    10818    3               Y$FID.WSN_ = VECTOR(Y$WSN);
     4381    10819    3               Y$FID.ASN_ = VECTOR(Y$OPEN.V.ASN#);
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:823  
     4382    10820    3               Y$FID.RES_ = VECTOR(Y$OPEN.V.RES#);
     4383    10821
     4384    10822    3               Y$FID.TEXTFID_ = VECTOR (OPT$->O$SYM.TEXT);
     4385    10823    3               CALL M$FID(Y$FID) ALTRET(XUG$OPENOUT_X);
     4386    10824
     4387    10825    3               Y$OPEN.ACCT_ = VECTOR(Y$ACCT);
     4388    10826    3               Y$OPEN.NAME_ = VECTOR(Y$NAME);
     4389    10827    3               Y$OPEN.PASS_ = VECTOR(Y$PASS);
     4390    10828    3               Y$OPEN.SN_ = VECTOR(Y$SN);
     4391    10829    3               Y$OPEN.WSN_ = VECTOR(Y$WSN);
     4392    10830
     4393    10831    3               IF OUT$BLK.SUBLK$(OUT$BLK.NSUBLKS-1)->O$BLK.CODE = %XUG_OUTOPTS
     4394    10832    4               THEN DO; /* options present */
     4395    10833    4                   OPT$ = OUT$BLK.SUBLK$(OUT$BLK.NSUBLKS-1);
     4396    10834    5                   DO SUBLK = 0 TO OPT$->O$BLK.NSUBLKS-1;
     4397    10835    5                       BLK$ = OPT$->O$BLK.SUBLK$(SUBLK);
     4398    10836    6                       DO CASE (O$BLK.CODE);
     4399    10837    6                       CASE(%XUG_ORG_CONSEC);
     4400    10838    6                           Y$OPEN.V.ORG# = %CONSEC#;
     4401    10839    6                       CASE(%XUG_ORG_UR);
     4402    10840    6                           Y$OPEN.V.ORG# = %UR#;
     4403    10841    6                       CASE(%XUG_FORM);
     4404    10842    6                           Y$OPEN.FORM_ = VECTOR (Y$FORM);
     4405    10843    6                           Y$FORM.FORM# = O$BLK.SUBLK$(0)->O$SYM.TEXT;
     4406    10844    6                       CASE(%XUG_IXTNSIZE);
     4407    10845    6                           CALL CHARBIN (TEMP, O$BLK.SUBLK$(0)->O$SYM.TEXT);
     4408    10846    6                           Y$OPEN.V.IXTNSIZE# = TEMP;
     4409    10847    6                       CASE(%XUG_XTNSIZE);
     4410    10848    6                           CALL CHARBIN (TEMP, O$BLK.SUBLK$(0)->O$SYM.TEXT);
     4411    10849    6                           Y$OPEN.V.XTNSIZE# = TEMP;
     4412    10850    6                       END/*CASE*/;
     4413    10851    5                   END; /* DO options */
     4414    10852    4               END /* IF options */;
     4415    10853    3           END /* IF fid */;
     4416    10854    2       END /* out$blk */;
     4417    10855
     4418    10856    1       IF DCBADDR(Y$OPEN.V.DCB#) ~= ADDR(NIL)
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:824  
     4419    10857    2       THEN IF DCBADDR(Y$OPEN.V.DCB#)->F$DCB.FCD# THEN DO; /* already open */
     4420    10858    2               Y$CLOSE = FPT_CLOSE;
     4421    10859    2               Y$CLOSE.V_ = VECTOR(Y$CLOSE.V);
     4422    10860    2               Y$CLOSE.V.DCB# = Y$OPEN.V.DCB#;
     4423    10861    2               CALL M$CLOSE(Y$CLOSE)
     4424    10862    3               WHENALTRETURN DO;
     4425    10863    3                   GETCMD.ERRDCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;
     4426    10864    3                   GETCMD.ERR# = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     4427    10865    3                   ALTRETURN;
     4428    10866    3               END;
     4429    10867    2           END;
     4430    10868
     4431    10869    1       CALL M$OPEN(Y$OPEN)
     4432    10870    2       WHENALTRETURN DO;
     4433    10871    2   XUG$OPENOUT_X:
     4434    10872    2           IF SECOND_TRY_FLAG
     4435    10873    2           THEN
     4436    10874    2               ALTRETURN;
     4437    10875
     4438    10876    2           GETCMD.ERRDCB# = DCBNUM(NIL);
     4439    10877    2           GETCMD.ERR# = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     4440    10878    2           SECOND_TRY_FLAG = %YES#;
     4441    10879
     4442    10880    2           GOTO SETUP_FPT;
     4443    10881
     4444    10882    2       END;
     4445    10883
     4446    10884    1       IF DCBADDR(Y$OPEN.V.DCB#) -> F$DCB.ORG# ~= Y$OPEN.V.ORG#
     4447    10885    1       THEN
     4448    10886    2       DO CASE (DCBADDR(Y$OPEN.V.DCB#) -> F$DCB.ORG#);
     4449    10887
     4450    10888    2       CASE (%KEYED#, %RANDOM#, %RELATIVE#, %INDEXED#, %IREL#, %SE#);
     4451    10889
     4452    10890    2           GETCMD.ERR# = XUG#BAD_OUTPUT_ORG;
     4453    10891    2           GETCMD.ERRDCB# = DCBNUM(NIL);
     4454    10892
     4455    10893        /*E*  ERROR:   XUG-E$XUG#BAD_OUTPUT_ORG
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:825  
     4456    10894              MESSAGE: File already exists, and is keyed.  Output redirected to ME.
     4457    10895              MESSAGE1: You tried to direct output to a file which (1) already exists,
     4458    10896                       and (2) is of a "direct-access" organization - that is, each
     4459    10897                       record in the file must be identified by a unique key.  Output
     4460    10898                       may be directed only to files or devices which do not require
     4461    10899                       record keys.
     4462    10900        */
     4463    10901
     4464    10902    2           SECOND_TRY_FLAG = %YES#;
     4465    10903
     4466    10904    2           GOTO SETUP_FPT;
     4467    10905
     4468    10906    2       END;
     4469    10907
     4470    10908    1       IF SECOND_TRY_FLAG
     4471    10909    1       THEN
     4472    10910    1           ALTRETURN;
     4473    10911    1       ELSE
     4474    10912    1           RETURN;
     4475    10913
     4476    10914    1   END /* XUG$OPENOUT_COMMON */;

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:826  
--  Include file information  --

   XU_PERR_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$OPENOUT_COMMON.

   Procedure XUG$OPENOUT_COMMON requires 351 words for executable code.
   Procedure XUG$OPENOUT_COMMON requires 144 words of local(AUTO) storage.

    No errors detected in file XUG$COMMON.:E05TSI    .

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:827  

 Object Unit name= XUG$OPENOUT_COMMON                         File name= XUG$COMMON.:E05TOU
 UTS= JUL 30 '97 09:29:49.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    116    164  XUG$OPENOUT_COMMON
    2   Proc  even  none   351    537  XUG$OPENOUT_COMMON
    3  RoData even  none    10     12  XUG$OPENOUT_COMMON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  XUG$OPENOUT_COMMON

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XUG$FINDDCB_COMMON
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    B$TCB$                                B_VECTNIL
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:828  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:829  


     4197        1        /*T***********************************************************/
     4198        2        /*T*                                                         */
     4199        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     4200        4        /*T*                                                         */
     4201        5        /*T***********************************************************/
     4202        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,MCI,DCI=4 */
     4203        7        XUG$OPENOUT_COMMON:PROC( GETCMD) ALTRET;

      7  2 000000   000000 700200 xent  XUG$OPENOUT* TSX0  ! X66_AUTO_1
         2 000001   000220 000001                    ZERO    144,1

     4204        8        /*F*
     4205        9             NAME: XUG$OPENOUT_COMMON
     4206       10              DESCRIPTION: Common code for the (ON|TO|OVER|INTO) FID clause in
     4207       11                  commands.  Opens the requested DCB as specified by the user.
     4208       12
     4209       13             CALL:   CALL XUG$OPENOUT_COMMON( GETCMD) ALTRET(ERR);
     4210       14
     4211       15                  In case of an error, the dcb is left closed and the error is
     4212       16                  described by the ALTRET frame in the TCB.
     4213       17                  It is the responsibility of the calling program to re-open the
     4214       18                  DCB after an error, if required.
     4215       19                  Each of the parameters is optional.  All of the parameters
     4216       20                  are never modified.
     4217       21             INPUT:
     4218       22             GETCMD.DCB_PARAM# - The number of the DCB to be opened.  Overrides the DCB
     4219       23                  in the FPT_OPEN when both are passed.
     4220       24
     4221       25             GETCMD.UTIL$ - Pointer to the output block returned by X$PARSE,
     4222       26                  for the XUG$OPENOUT_SPEC or XUG$OPENOUT_OPT parse nodes.
     4223       27                  If omitted, the values in FPT_OPEN will be used.
     4224       28
     4225       29             GETCMD.FPT$ - A pointer to a FPT for M$OPEN.  FPT_OPEN.V.DCB# must be set
     4226       30                  to the number of the DCB to be opened, unless GETCMD.DCB_PARAM# is
     4227       31                  set.  The remaining M$OPEN parameters should be set to the desired
     4228       32                  values.  If omitted, the following default values, typical for
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:830  
     4229       33                  the OUTPUT command, will be used:
     4230       34
     4231       35                       %FPT_OPEN (DCB=M$LO,
     4232       36                        SCRUB=YES,
     4233       37                        ORG=UR,
     4234       38                        ACS=SEQUEN,
     4235       39                        ASN=DEVICE,
     4236       40                        RES='ME',
     4237       41                        FUN=CREATE,
     4238       42                        EXIST=ERROR);
     4239       43
     4240       44                 Other parameters (SETDCB, REASSIGN)  may be of interest
     4241       45                 for other purposes.
     4242       46        */
     4243       47
     4244       48        %INCLUDE CP_6;
     4245     5607        %INCLUDE CP_6_SUBS;
     4246     6147        %INCLUDE XU_MACRO_C; /* XUR MACROs */
     4247     9253        %INCLUDE XU_SUBS_C; /* Parse node EQUs */
     4248     9345        %INCLUDE XU_PERR_C;
     4249     9536
     4250     9537        %XUG_GETCMD (NAME=GETCMD, STCLASS="");
     4251     9875        %PARSE$OUT (STCLASS="BASED(GETCMD.UTIL$)");
     4252     9920        %FPT_OPEN (STCLASS="BASED(GETCMD.FPT$)");
     4253    10029
     4254    10030    1   DCL M$LO# UBIN WORD;
     4255    10031    1   DCL BLK$ PTR;
     4256    10032    1   DCL OPT$ PTR;
     4257    10033    1   DCL TEMP UBIN;
     4258    10034    1   DCL SUBLK UBIN;
     4259    10035    1   DCL SECOND_TRY_FLAG BIT (1);
     4260    10036
     4261    10037    1   DCL 1 M$LO CONSTANT,
     4262    10038    1         2 L UBIN BYTE CALIGNED INIT (4),
     4263    10039    1         2 C CHAR (4) INIT ('M$LO');
     4264    10040
     4265    10041        %FPT_OPEN (FPTN=DEFAULT_OPEN,
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:831  
     4266    10042         STCLASS=CONSTANT,
     4267    10043         SCRUB=YES,
     4268    10044         ORG=UR,
     4269    10045         ACS=SEQUEN,
     4270    10046         ASN=DEVICE,
     4271    10047         RES='ME',
     4272    10048         FUN=CREATE,
     4273    10049         EXIST=ERROR);
     4274    10158
     4275    10159        %F$DCB;
     4276    10216        %PARSE$OUT (NAME=O$BLK,
     4277    10217         STCLASS="BASED(BLK$)");
     4278    10262        %PARSE$SYM (NAME=O$SYM,
     4279    10263         STCLASS=BASED);
     4280    10301
     4281    10302        %FPT_FID(STCLASS=CONSTANT);
     4282    10325        %FPT_CLOSE(DISP=SAVE,
     4283    10326         STCLASS=CONSTANT);
     4284    10368
     4285    10369        %FPT_FID(FPTN=Y$FID,
     4286    10370         STCLASS=AUTO);
     4287    10393        %FPT_CLOSE(FPTN=Y$CLOSE,
     4288    10394         STCLASS=AUTO);
     4289    10436        %FPT_OPEN (FPTN=Y$OPEN,
     4290    10437         STCLASS=AUTO);
     4291    10546        %VLP_NAME(FPTN=Y$NAME,
     4292    10547         STCLASS=AUTO);
     4293    10574        %VLP_ACCT(FPTN=Y$ACCT,
     4294    10575         STCLASS=AUTO);
     4295    10588        %VLP_PASS(FPTN=Y$PASS,
     4296    10589         STCLASS=AUTO);
     4297    10602        %VLP_SN(FPTN=Y$SN,
     4298    10603         STCLASS=AUTO);
     4299    10616        %VLP_WSN(FPTN=Y$WSN,
     4300    10617         STCLASS=AUTO);
     4301    10630        %VLP_FORM(FPTN=Y$FORM,
     4302    10631          STCLASS=AUTO);
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:832  
     4303    10644
     4304    10645        %VLP_ERRCODE (FPTN=XUG#BAD_OUTPUT_ORG, STCLASS=CONSTANT,
     4305    10646                      FCG=XU, MID=G, ERR#=%E$XUG#BAD_OUTPUT_ORG, SEV=0);
     4306    10691        %VLP_ERRCODE (FPTN=XUG#NO_M$LO_DCB, STCLASS=CONSTANT,
     4307    10692                      FCG=XU, MID=G, ERR#=%E$XUG#NO_M$LO_DCB, SEV=0);
     4308    10737
     4309    10738    1   DCL XUG$FINDDCB_COMMON ENTRY (2) ALTRET;
     4310    10739
     4311    10740    1   DCL B$TCB$ PTR SYMREF READONLY;
     4312    10741        %B$TCB;
     4313    10744        %B$ALT;
     4314    10752
     4315    10753    1       SECOND_TRY_FLAG = %NO#;

  10753  2 000002   200011 450100                    STZ     SECOND_TRY_FLAG,,AUTO

     4316    10754
     4317    10755    1   SETUP_FPT:
     4318    10756
     4319    10757    1       IF GETCMD.FPT$ = ADDR(NIL) OR SECOND_TRY_FLAG

  10757  2 000003   200003 470500       SETUP_FPT    LDP0    @GETCMD,,AUTO
         2 000004   000043 236100                    LDQ     35,,PR0
         2 000005   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000006   000011 600000 2                  TZE     s:10760
         2 000007   200011 234100                    SZN     SECOND_TRY_FLAG,,AUTO
         2 000010   000037 605000 2                  TPL     s:10784

     4320    10758    2       THEN DO;

     4321    10759
     4322    10760    2           Y$OPEN = DEFAULT_OPEN;

  10760  2 000011   000100 100400                    MLR     fill='000'O
         2 000012   000002 000350 1                  ADSC9   DEFAULT_OPEN             cn=0,n=232
         2 000013   200100 000350                    ADSC9   Y$OPEN,,AUTO             cn=0,n=232

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:833  
     4323    10761    2           IF GETCMD.DCB_PARAM# = DCBNUM(NIL)

  10761  2 000014   000014 235100                    LDA     12,,PR0
         2 000015   000043 601000 2                  TNZ     s:10785

     4324    10762    3           THEN DO;

     4325    10763
     4326    10764    3               CALL XUG$FINDDCB_COMMON (M$LO, M$LO#)

  10764  2 000016   200004 631500                    EPPR1   M$LO#,,AUTO
         2 000017   200217 451500                    STP1    Y$FORM+3,,AUTO
         2 000020   000000 236000 3                  LDQ     0
         2 000021   200216 756100                    STQ     Y$FORM+2,,AUTO
         2 000022   200216 630500                    EPPR0   Y$FORM+2,,AUTO
         2 000023   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000024   000000 701000 xent               TSX1    XUG$FINDDCB_COMMON
         2 000025   000027 702000 2                  TSX2    s:10767
         2 000026   000034 710000 2                  TRA     s:10778

     4327    10765    4               WHENALTRETURN DO;

     4328    10766
     4329    10767    4                   GETCMD.ERRDCB# = DCBNUM(NIL);

  10767  2 000027   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000030   000011 450100                    STZ     9,,PR0

     4330    10768    4                   GETCMD.ERR# = XUG#NO_M$LO_DCB;

  10768  2 000031   000163 236000 1                  LDQ     XUG#NO_M$LO_DCB
         2 000032   000001 756100                    STQ     1,,PR0

     4331    10769
     4332    10770        /*E*  ERROR: XUG-E$XUG#NO_M$LO_DCB
     4333    10771              MESSAGE: The M$LO DCB does not exist.
     4334    10772        */
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:834  
     4335    10773
     4336    10774    4                   ALTRETURN;

  10774  2 000033   000000 702200 xent               TSX2  ! X66_AALT

     4337    10775
     4338    10776    4               END;
     4339    10777
     4340    10778    3               Y$OPEN.V.DCB# = M$LO#;

  10778  2 000034   200004 720100                    LXL0    M$LO#,,AUTO
         2 000035   200144 740100                    STX0    Y$OPEN+36,,AUTO

     4341    10779
     4342    10780    3           END;

     4343    10781
     4344    10782    2       END;

  10782  2 000036   000043 710000 2                  TRA     s:10785

     4345    10783
     4346    10784    1       ELSE Y$OPEN = FPT_OPEN;

  10784  2 000037   000043 471500                    LDP1    35,,PR0
         2 000040   000100 100500                    MLR     fill='000'O
         2 000041   100000 000350                    ADSC9   0,,PR1                   cn=0,n=232
         2 000042   200100 000350                    ADSC9   Y$OPEN,,AUTO             cn=0,n=232

     4347    10785    1       Y$OPEN.V_ = VECTOR(Y$OPEN.V);

  10785  2 000043   000001 235000 3                  LDA     1
         2 000044   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000045   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000046   000144 036003                    ADLQ    100,DU
         2 000047   200100 757100                    STAQ    Y$OPEN,,AUTO

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:835  
     4348    10786
     4349    10787    1       IF GETCMD.DCB_PARAM# ~= DCBNUM(NIL)

  10787  2 000050   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000051   000014 235100                    LDA     12,,PR0
         2 000052   000055 600000 2                  TZE     s:10790

     4350    10788    1       THEN Y$OPEN.V.DCB# = GETCMD.DCB_PARAM#;

  10788  2 000053   000014 720100                    LXL0    12,,PR0
         2 000054   200144 740100                    STX0    Y$OPEN+36,,AUTO

     4351    10789
     4352    10790    1       IF GETCMD.UTIL$ ~= ADDR(NIL) AND NOT SECOND_TRY_FLAG    /* out$blk passed */

  10790  2 000055   000044 236100                    LDQ     36,,PR0
         2 000056   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000057   000373 600000 2                  TZE     s:10856
         2 000060   200011 234100                    SZN     SECOND_TRY_FLAG,,AUTO
         2 000061   000373 604000 2                  TMI     s:10856

     4353    10791    2       THEN DO;

     4354    10792    2           OPT$ = OUT$BLK.SUBLK$(0); /* pointer to fid */

  10792  2 000062   000044 471500                    LDP1    36,,PR0
         2 000063   100003 236100                    LDQ     3,,PR1
         2 000064   200006 756100                    STQ     OPT$,,AUTO

     4355    10793    2           IF OUT$BLK.NSUBLKS > 1

  10793  2 000065   100001 220100                    LDX0    1,,PR1
         2 000066   000002 100003                    CMPX0   2,DU
         2 000067   000133 602000 2                  TNC     s:10811
         2 000070   100002 473510                    LDP3    2,X0,PR1
         2 000071   300000 721100                    LXL1    0,,PR3
         2 000072   000004 101003                    CMPX1   4,DU
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:836  
         2 000073   000076 601000 2                  TNZ     s:10797
         2 000074   000003 100003                    CMPX0   3,DU
         2 000075   000133 602000 2                  TNC     s:10811

     4356    10794    2             AND (OUT$BLK.SUBLK$(OUT$BLK.NSUBLKS-1)->O$BLK.CODE ~= %XUG_OUTOPTS
     4357    10795    2             OR OUT$BLK.NSUBLKS > 2)
     4358    10796    3           THEN DO; /* preposition present */

     4359    10797    3               OPT$ = OUT$BLK.SUBLK$(1);

  10797  2 000076   100004 236100                    LDQ     4,,PR1
         2 000077   200006 756100                    STQ     OPT$,,AUTO

     4360    10798    4               DO CASE(OUT$BLK.SUBLK$(0)->O$BLK.CODE);

  10798  2 000100   100003 474500                    LDP4    3,,PR1
         2 000101   400000 722100                    LXL2    0,,PR4
         2 000102   000004 102003                    CMPX2   4,DU
         2 000103   000105 602012 2                  TNC     s:10798+5,X2
         2 000104   000133 710000 2                  TRA     s:10811
         2 000105   000133 710000 2                  TRA     s:10811
         2 000106   000111 710000 2                  TRA     s:10800
         2 000107   000120 710000 2                  TRA     s:10803
         2 000110   000125 710000 2                  TRA     s:10806

     4361    10799    4               CASE(%XUG_CREATE);

     4362    10800    4                   Y$OPEN.V.FUN# = %CREATE#;

  10800  2 000111   003000 236007                    LDQ     1536,DL
         2 000112   200145 552110                    STBQ    Y$OPEN+37,'10'O,AUTO

     4363    10801    4                   Y$OPEN.V.EXIST# = %ERROR#;

  10801  2 000113   200144 236100                    LDQ     Y$OPEN+36,,AUTO
         2 000114   000002 376000 3                  ANQ     2
         2 000115   000200 276007                    ORQ     128,DL
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:837  
         2 000116   200144 756100                    STQ     Y$OPEN+36,,AUTO
         2 000117   000133 710000 2                  TRA     s:10811

     4364    10802    4               CASE(%XUG_REPLACE);

     4365    10803    4                   Y$OPEN.V.FUN# = %CREATE#;

  10803  2 000120   003000 236007                    LDQ     1536,DL
         2 000121   200145 552110                    STBQ    Y$OPEN+37,'10'O,AUTO

     4366    10804    4                   Y$OPEN.V.EXIST# = %NEWFILE#;

  10804  2 000122   000600 236007                    LDQ     384,DL
         2 000123   200144 256100                    ORSQ    Y$OPEN+36,,AUTO
         2 000124   000133 710000 2                  TRA     s:10811

     4367    10805    4               CASE(%XUG_EXTEND);

     4368    10806    4                   Y$OPEN.V.FUN# = %CREATE#;

  10806  2 000125   003000 236007                    LDQ     1536,DL
         2 000126   200145 552110                    STBQ    Y$OPEN+37,'10'O,AUTO

     4369    10807    4                   Y$OPEN.V.EXIST# = %OLDFILE#;

  10807  2 000127   200144 236100                    LDQ     Y$OPEN+36,,AUTO
         2 000130   000002 376000 3                  ANQ     2
         2 000131   000400 276007                    ORQ     256,DL
         2 000132   200144 756100                    STQ     Y$OPEN+36,,AUTO

     4370    10808    4               END /* CASE */;

     4371    10809    3           END /* IF preposition */;

     4372    10810
     4373    10811    3           IF OUT$BLK.NSUBLKS > 0 THEN DO; /* FID present */

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:838  
  10811  2 000133   000044 471500                    LDP1    36,,PR0
         2 000134   100001 220100                    LDX0    1,,PR1
         2 000135   000373 600000 2                  TZE     s:10856

     4374    10812    3               Y$FID = FPT_FID;

  10812  2 000136   000100 100400                    MLR     fill='000'O
         2 000137   000074 000140 1                  ADSC9   FPT_FID                  cn=0,n=96
         2 000140   200012 000140                    ADSC9   Y$FID,,AUTO              cn=0,n=96

     4375    10813    3               Y$FID.V_ = VECTOR(Y$FID.V);

  10813  2 000141   000003 235000 3                  LDA     3
         2 000142   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000143   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000144   000036 036003                    ADLQ    30,DU
         2 000145   200012 757100                    STAQ    Y$FID,,AUTO

     4376    10814    3               Y$FID.ACCT_ = VECTOR(Y$ACCT);

  10814  2 000146   000004 235000 3                  LDA     4
         2 000147   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000150   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000151   000202 036003                    ADLQ    130,DU
         2 000152   200020 757100                    STAQ    Y$FID+6,,AUTO

     4377    10815    3               Y$FID.NAME_ = VECTOR(Y$NAME);

  10815  2 000153   000005 235000 3                  LDA     5
         2 000154   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000155   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000156   000172 036003                    ADLQ    122,DU
         2 000157   200016 757100                    STAQ    Y$FID+4,,AUTO

     4378    10816    3               Y$FID.PASS_ = VECTOR(Y$PASS);

  10816  2 000160   000004 235000 3                  LDA     4
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:839  
         2 000161   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000162   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000163   000204 036003                    ADLQ    132,DU
         2 000164   200022 757100                    STAQ    Y$FID+8,,AUTO

     4379    10817    3               Y$FID.SN_ = VECTOR(Y$SN);

  10817  2 000165   000003 235000 3                  LDA     3
         2 000166   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000167   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000170   000206 036003                    ADLQ    134,DU
         2 000171   200024 757100                    STAQ    Y$FID+10,,AUTO

     4380    10818    3               Y$FID.WSN_ = VECTOR(Y$WSN);

  10818  2 000172   000004 235000 3                  LDA     4
         2 000173   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000174   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000175   000212 036003                    ADLQ    138,DU
         2 000176   200026 757100                    STAQ    Y$FID+12,,AUTO

     4381    10819    3               Y$FID.ASN_ = VECTOR(Y$OPEN.V.ASN#);

  10819  2 000177   177640 235007                    LDA     65440,DL
         2 000200   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000201   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000202   000006 036000 3                  ADLQ    6
         2 000203   200030 757100                    STAQ    Y$FID+14,,AUTO

     4382    10820    3               Y$FID.RES_ = VECTOR(Y$OPEN.V.RES#);

  10820  2 000204   777640 235007                    LDA     -96,DL
         2 000205   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000206   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000207   000150 036003                    ADLQ    104,DU
         2 000210   200032 757100                    STAQ    Y$FID+16,,AUTO

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:840  
     4383    10821
     4384    10822    3               Y$FID.TEXTFID_ = VECTOR (OPT$->O$SYM.TEXT);

  10822  2 000211   200006 471500                    LDP1    OPT$,,AUTO
         2 000212   100004 236100                    LDQ     4,,PR1
         2 000213   000033 772000                    QRL     27
         2 000214   000064 737000                    LLS     52
         2 000215   000140 135007                    SBLA    96,DL
         2 000216   200006 236100                    LDQ     OPT$,,AUTO
         2 000217   000007 036000 3                  ADLQ    7
         2 000220   200014 757100                    STAQ    Y$FID+2,,AUTO

     4385    10823    3               CALL M$FID(Y$FID) ALTRET(XUG$OPENOUT_X);

  10823  2 000221   200012 630500                    EPPR0   Y$FID,,AUTO
         2 000222   420001 713400                    CLIMB   alt,+8193
         2 000223   404400 401760                    pmme    nvectors=10
         2 000224   000441 702000 2                  TSX2    XUG$OPENOUT_X

     4386    10824
     4387    10825    3               Y$OPEN.ACCT_ = VECTOR(Y$ACCT);

  10825  2 000225   000004 235000 3                  LDA     4
         2 000226   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000227   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000230   000202 036003                    ADLQ    130,DU
         2 000231   200124 757100                    STAQ    Y$OPEN+20,,AUTO

     4388    10826    3               Y$OPEN.NAME_ = VECTOR(Y$NAME);

  10826  2 000232   000005 235000 3                  LDA     5
         2 000233   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000234   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000235   000172 036003                    ADLQ    122,DU
         2 000236   200106 757100                    STAQ    Y$OPEN+6,,AUTO

     4389    10827    3               Y$OPEN.PASS_ = VECTOR(Y$PASS);
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:841  

  10827  2 000237   000004 235000 3                  LDA     4
         2 000240   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000241   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000242   000204 036003                    ADLQ    132,DU
         2 000243   200110 757100                    STAQ    Y$OPEN+8,,AUTO

     4390    10828    3               Y$OPEN.SN_ = VECTOR(Y$SN);

  10828  2 000244   000003 235000 3                  LDA     3
         2 000245   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000246   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000247   000206 036003                    ADLQ    134,DU
         2 000250   200102 757100                    STAQ    Y$OPEN+2,,AUTO

     4391    10829    3               Y$OPEN.WSN_ = VECTOR(Y$WSN);

  10829  2 000251   000004 235000 3                  LDA     4
         2 000252   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000253   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000254   000212 036003                    ADLQ    138,DU
         2 000255   200132 757100                    STAQ    Y$OPEN+26,,AUTO

     4392    10830
     4393    10831    3               IF OUT$BLK.SUBLK$(OUT$BLK.NSUBLKS-1)->O$BLK.CODE = %XUG_OUTOPTS

  10831  2 000256   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000257   000044 471500                    LDP1    36,,PR0
         2 000260   100001 220100                    LDX0    1,,PR1
         2 000261   100002 473510                    LDP3    2,X0,PR1
         2 000262   300000 721100                    LXL1    0,,PR3
         2 000263   000004 101003                    CMPX1   4,DU
         2 000264   000373 601000 2                  TNZ     s:10856

     4394    10832    4               THEN DO; /* options present */

     4395    10833    4                   OPT$ = OUT$BLK.SUBLK$(OUT$BLK.NSUBLKS-1);
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:842  

  10833  2 000265   100002 236110                    LDQ     2,X0,PR1
         2 000266   200006 756100                    STQ     OPT$,,AUTO

     4396    10834    5                   DO SUBLK = 0 TO OPT$->O$BLK.NSUBLKS-1;

  10834  2 000267   200010 450100                    STZ     SUBLK,,AUTO
         2 000270   000365 710000 2                  TRA     s:10851+3

     4397    10835    5                       BLK$ = OPT$->O$BLK.SUBLK$(SUBLK);

  10835  2 000271   200006 470500                    LDP0    OPT$,,AUTO
         2 000272   200010 720100                    LXL0    SUBLK,,AUTO
         2 000273   000003 236110                    LDQ     3,X0,PR0
         2 000274   200005 756100                    STQ     BLK$,,AUTO

     4398    10836    6                       DO CASE (O$BLK.CODE);

  10836  2 000275   200005 471500                    LDP1    BLK$,,AUTO
         2 000276   100000 236100                    LDQ     0,,PR1
         2 000277   777777 376007                    ANQ     -1,DL
         2 000300   000005 136007                    SBLQ    5,DL
         2 000301   000005 116007                    CMPQ    5,DL
         2 000302   000304 602006 2                  TNC     s:10836+7,QL
         2 000303   000362 710000 2                  TRA     s:10851
         2 000304   000311 710000 2                  TRA     s:10838
         2 000305   000314 710000 2                  TRA     s:10840
         2 000306   000317 710000 2                  TRA     s:10842
         2 000307   000334 710000 2                  TRA     s:10845
         2 000310   000347 710000 2                  TRA     s:10848

     4399    10837    6                       CASE(%XUG_ORG_CONSEC);

     4400    10838    6                           Y$OPEN.V.ORG# = %CONSEC#;

  10838  2 000311   001000 236007                    LDQ     512,DL
         2 000312   200146 552110                    STBQ    Y$OPEN+38,'10'O,AUTO
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:843  
         2 000313   000362 710000 2                  TRA     s:10851

     4401    10839    6                       CASE(%XUG_ORG_UR);

     4402    10840    6                           Y$OPEN.V.ORG# = %UR#;

  10840  2 000314   004000 236007                    LDQ     2048,DL
         2 000315   200146 552110                    STBQ    Y$OPEN+38,'10'O,AUTO
         2 000316   000362 710000 2                  TRA     s:10851

     4403    10841    6                       CASE(%XUG_FORM);

     4404    10842    6                           Y$OPEN.FORM_ = VECTOR (Y$FORM);

  10842  2 000317   000010 235000 3                  LDA     8
         2 000320   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000321   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000322   000214 036003                    ADLQ    140,DU
         2 000323   200140 757100                    STAQ    Y$OPEN+32,,AUTO

     4405    10843    6                           Y$FORM.FORM# = O$BLK.SUBLK$(0)->O$SYM.TEXT;

  10843  2 000324   100003 473500                    LDP3    3,,PR1
         2 000325   300004 236100                    LDQ     4,,PR3
         2 000326   000033 772000                    QRL     27
         2 000327   000000 621006                    EAX1    0,QL
         2 000330   040100 100540                    MLR     fill='040'O
         2 000331   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         2 000332   200214 000006                    ADSC9   Y$FORM,,AUTO             cn=0,n=6
         2 000333   000362 710000 2                  TRA     s:10851

     4406    10844    6                       CASE(%XUG_IXTNSIZE);

     4407    10845    6                           CALL CHARBIN (TEMP, O$BLK.SUBLK$(0)->O$SYM.TEXT);

  10845  2 000334   100003 473500                    LDP3    3,,PR1
         2 000335   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:844  
         2 000336   000033 772000                    QRL     27
         2 000337   000000 621006                    EAX1    0,QL
         2 000340   000100 305540                    DTB
         2 000341   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         2 000342   200216 000010                    NDSC9   Y$FORM+2,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         2 000343   200217 235100                    LDA     Y$FORM+3,,AUTO
         2 000344   200007 755100                    STA     TEMP,,AUTO

     4408    10846    6                           Y$OPEN.V.IXTNSIZE# = TEMP;

  10846  2 000345   200155 755100                    STA     Y$OPEN+45,,AUTO
         2 000346   000362 710000 2                  TRA     s:10851

     4409    10847    6                       CASE(%XUG_XTNSIZE);

     4410    10848    6                           CALL CHARBIN (TEMP, O$BLK.SUBLK$(0)->O$SYM.TEXT);

  10848  2 000347   100003 473500                    LDP3    3,,PR1
         2 000350   300004 236100                    LDQ     4,,PR3
         2 000351   000033 772000                    QRL     27
         2 000352   000000 621006                    EAX1    0,QL
         2 000353   000100 305540                    DTB
         2 000354   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         2 000355   200216 000010                    NDSC9   Y$FORM+2,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         2 000356   200217 235100                    LDA     Y$FORM+3,,AUTO
         2 000357   200007 755100                    STA     TEMP,,AUTO

     4411    10849    6                           Y$OPEN.V.XTNSIZE# = TEMP;

  10849  2 000360   000000 621005                    EAX1    0,AL
         2 000361   200154 441100                    SXL1    Y$OPEN+44,,AUTO

     4412    10850    6                       END/*CASE*/;

     4413    10851    5                   END; /* DO options */

  10851  2 000362   200010 235100                    LDA     SUBLK,,AUTO
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:845  
         2 000363   000001 035007                    ADLA    1,DL
         2 000364   200010 755100                    STA     SUBLK,,AUTO
         2 000365   200006 470500                    LDP0    OPT$,,AUTO
         2 000366   000001 236100                    LDQ     1,,PR0
         2 000367   000022 772000                    QRL     18
         2 000370   200010 116100                    CMPQ    SUBLK,,AUTO
         2 000371   000373 600000 2                  TZE     s:10856
         2 000372   000271 603000 2                  TRC     s:10835

     4414    10852    4               END /* IF options */;

     4415    10853    3           END /* IF fid */;

     4416    10854    2       END /* out$blk */;

     4417    10855
     4418    10856    1       IF DCBADDR(Y$OPEN.V.DCB#) ~= ADDR(NIL)

  10856  2 000373   000011 470400 3                  LDP0    9
         2 000374   000000 471500                    LDP1    0,,PR0
         2 000375   200144 220100                    LDX0    Y$OPEN+36,,AUTO
         2 000376   100000 236110                    LDQ     0,X0,PR1
         2 000377   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000400   000434 600000 2                  TZE     s:10869

     4419    10857    2       THEN IF DCBADDR(Y$OPEN.V.DCB#)->F$DCB.FCD# THEN DO; /* already open */

  10857  2 000401   100000 473510                    LDP3    0,X0,PR1
         2 000402   300031 236100                    LDQ     25,,PR3
         2 000403   020000 316007                    CANQ    8192,DL
         2 000404   000434 600000 2                  TZE     s:10869

     4420    10858    2               Y$CLOSE = FPT_CLOSE;

  10858  2 000405   000100 100400                    MLR     fill='000'O
         2 000406   000124 000170 1                  ADSC9   FPT_CLOSE                cn=0,n=120
         2 000407   200042 000170                    ADSC9   Y$CLOSE,,AUTO            cn=0,n=120
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:846  

     4421    10859    2               Y$CLOSE.V_ = VECTOR(Y$CLOSE.V);

  10859  2 000410   000003 235000 3                  LDA     3
         2 000411   200216 452500                    STP2    Y$FORM+2,,AUTO
         2 000412   200216 236100                    LDQ     Y$FORM+2,,AUTO
         2 000413   000074 036003                    ADLQ    60,DU
         2 000414   200042 757100                    STAQ    Y$CLOSE,,AUTO

     4422    10860    2               Y$CLOSE.V.DCB# = Y$OPEN.V.DCB#;

  10860  2 000415   200074 740100                    STX0    Y$CLOSE+26,,AUTO

     4423    10861    2               CALL M$CLOSE(Y$CLOSE)

  10861  2 000416   200042 630500                    EPPR0   Y$CLOSE,,AUTO
         2 000417   450001 713400                    CLIMB   alt,close
         2 000420   406000 401760                    pmme    nvectors=13
         2 000421   000423 702000 2                  TSX2    s:10863
         2 000422   000434 710000 2                  TRA     s:10869

     4424    10862    3               WHENALTRETURN DO;

     4425    10863    3                   GETCMD.ERRDCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;

  10863  2 000423   000000 470400 xsym               LDP0    B$TCB$
         2 000424   000000 471500                    LDP1    0,,PR0
         2 000425   100101 235100                    LDA     65,,PR1
         2 000426   200003 473500                    LDP3    @GETCMD,,AUTO
         2 000427   300011 755100                    STA     9,,PR3

     4426    10864    3                   GETCMD.ERR# = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  10864  2 000430   000000 471500                    LDP1    0,,PR0
         2 000431   100102 236100                    LDQ     66,,PR1
         2 000432   300001 756100                    STQ     1,,PR3

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:847  
     4427    10865    3                   ALTRETURN;

  10865  2 000433   000000 702200 xent               TSX2  ! X66_AALT

     4428    10866    3               END;
     4429    10867    2           END;

     4430    10868
     4431    10869    1       CALL M$OPEN(Y$OPEN)

  10869  2 000434   200100 630500                    EPPR0   Y$OPEN,,AUTO
         2 000435   450000 713400                    CLIMB   alt,open
         2 000436   410400 401760                    pmme    nvectors=18
         2 000437   000441 702000 2                  TSX2    XUG$OPENOUT_X
         2 000440   000455 710000 2                  TRA     s:10884

     4432    10870    2       WHENALTRETURN DO;

     4433    10871    2   XUG$OPENOUT_X:
     4434    10872    2           IF SECOND_TRY_FLAG

  10872  2 000441   200011 234100       XUG$OPENOUT* SZN     SECOND_TRY_FLAG,,AUTO
         2 000442   000444 605000 2                  TPL     s:10876

     4435    10873    2           THEN
     4436    10874    2               ALTRETURN;

  10874  2 000443   000000 702200 xent               TSX2  ! X66_AALT

     4437    10875
     4438    10876    2           GETCMD.ERRDCB# = DCBNUM(NIL);

  10876  2 000444   200003 470500                    LDP0    @GETCMD,,AUTO
         2 000445   000011 450100                    STZ     9,,PR0

     4439    10877    2           GETCMD.ERR# = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:848  
  10877  2 000446   000000 471400 xsym               LDP1    B$TCB$
         2 000447   100000 473500                    LDP3    0,,PR1
         2 000450   300102 236100                    LDQ     66,,PR3
         2 000451   000001 756100                    STQ     1,,PR0

     4440    10878    2           SECOND_TRY_FLAG = %YES#;

  10878  2 000452   400000 236003                    LDQ     -131072,DU
         2 000453   200011 756100                    STQ     SECOND_TRY_FLAG,,AUTO

     4441    10879
     4442    10880    2           GOTO SETUP_FPT;

  10880  2 000454   000003 710000 2                  TRA     SETUP_FPT

     4443    10881
     4444    10882    2       END;
     4445    10883
     4446    10884    1       IF DCBADDR(Y$OPEN.V.DCB#) -> F$DCB.ORG# ~= Y$OPEN.V.ORG#

  10884  2 000455   000011 470400 3                  LDP0    9
         2 000456   000000 471500                    LDP1    0,,PR0
         2 000457   200144 220100                    LDX0    Y$OPEN+36,,AUTO
         2 000460   100000 473510                    LDP3    0,X0,PR1
         2 000461   200146 236100                    LDQ     Y$OPEN+38,,AUTO
         2 000462   000011 772000                    QRL     9
         2 000463   000777 376007                    ANQ     511,DL
         2 000464   200216 756100                    STQ     Y$FORM+2,,AUTO
         2 000465   300032 236100                    LDQ     26,,PR3
         2 000466   000033 772000                    QRL     27
         2 000467   200216 116100                    CMPQ    Y$FORM+2,,AUTO
         2 000470   000533 600000 2                  TZE     s:10908

     4447    10885    1       THEN
     4448    10886    2       DO CASE (DCBADDR(Y$OPEN.V.DCB#) -> F$DCB.ORG#);

  10886  2 000471   000030 116007                    CMPQ    24,DL
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:849  
         2 000472   000474 602006 2                  TNC     s:10886+3,QL
         2 000473   000533 710000 2                  TRA     s:10908
         2 000474   000533 710000 2                  TRA     s:10908
         2 000475   000533 710000 2                  TRA     s:10908
         2 000476   000524 710000 2                  TRA     s:10890
         2 000477   000524 710000 2                  TRA     s:10890
         2 000500   000533 710000 2                  TRA     s:10908
         2 000501   000524 710000 2                  TRA     s:10890
         2 000502   000524 710000 2                  TRA     s:10890
         2 000503   000533 710000 2                  TRA     s:10908
         2 000504   000533 710000 2                  TRA     s:10908
         2 000505   000533 710000 2                  TRA     s:10908
         2 000506   000533 710000 2                  TRA     s:10908
         2 000507   000533 710000 2                  TRA     s:10908
         2 000510   000533 710000 2                  TRA     s:10908
         2 000511   000524 710000 2                  TRA     s:10890
         2 000512   000533 710000 2                  TRA     s:10908
         2 000513   000533 710000 2                  TRA     s:10908
         2 000514   000533 710000 2                  TRA     s:10908
         2 000515   000533 710000 2                  TRA     s:10908
         2 000516   000533 710000 2                  TRA     s:10908
         2 000517   000533 710000 2                  TRA     s:10908
         2 000520   000533 710000 2                  TRA     s:10908
         2 000521   000533 710000 2                  TRA     s:10908
         2 000522   000533 710000 2                  TRA     s:10908
         2 000523   000524 710000 2                  TRA     s:10890

     4449    10887
     4450    10888    2       CASE (%KEYED#, %RANDOM#, %RELATIVE#, %INDEXED#, %IREL#, %SE#);

     4451    10889
     4452    10890    2           GETCMD.ERR# = XUG#BAD_OUTPUT_ORG;

  10890  2 000524   000162 236000 1                  LDQ     XUG#BAD_OUTPUT_ORG
         2 000525   200003 474500                    LDP4    @GETCMD,,AUTO
         2 000526   400001 756100                    STQ     1,,PR4

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:850  
     4453    10891    2           GETCMD.ERRDCB# = DCBNUM(NIL);

  10891  2 000527   400011 450100                    STZ     9,,PR4

     4454    10892
     4455    10893        /*E*  ERROR:   XUG-E$XUG#BAD_OUTPUT_ORG
     4456    10894              MESSAGE: File already exists, and is keyed.  Output redirected to ME.
     4457    10895              MESSAGE1: You tried to direct output to a file which (1) already exists,
     4458    10896                       and (2) is of a "direct-access" organization - that is, each
     4459    10897                       record in the file must be identified by a unique key.  Output
     4460    10898                       may be directed only to files or devices which do not require
     4461    10899                       record keys.
     4462    10900        */
     4463    10901
     4464    10902    2           SECOND_TRY_FLAG = %YES#;

  10902  2 000530   400000 236003                    LDQ     -131072,DU
         2 000531   200011 756100                    STQ     SECOND_TRY_FLAG,,AUTO

     4465    10903
     4466    10904    2           GOTO SETUP_FPT;

  10904  2 000532   000003 710000 2                  TRA     SETUP_FPT

     4467    10905
     4468    10906    2       END;

     4469    10907
     4470    10908    1       IF SECOND_TRY_FLAG

  10908  2 000533   200011 234100                    SZN     SECOND_TRY_FLAG,,AUTO
         2 000534   000536 605000 2                  TPL     s:10912

     4471    10909    1       THEN
     4472    10910    1           ALTRETURN;

  10910  2 000535   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:851  

     4473    10911    1       ELSE
     4474    10912    1           RETURN;

  10912  2 000536   000000 702200 xent               TSX2  ! X66_ARET
     4475    10913
     4476    10914    1   END /* XUG$OPENOUT_COMMON */;

PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:852  
--  Include file information  --

   XU_PERR_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure XUG$OPENOUT_COMMON.
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:853  

 **** Variables and constants ****

  ****  Section 001 RoData XUG$OPENOUT_COMMON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/d STRC(2088)  r     1 DEFAULT_OPEN             124-0-0/d STRC(1080)  r     1 FPT_CLOSE
    74-0-0/d STRC(864)   r     1 FPT_FID                    0-0-0/c STRC(45)    r     1 M$LO
   162-0-0/w STRC        r     1 XUG#BAD_OUTPUT_ORG       163-0-0/w STRC        r     1 XUG#NO_M$LO_DCB

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @GETCMD                    5-0-0/w PTR         r     1 BLK$
    *0-0-0/d STRC(1512)  r     1 GETCMD                     4-0-0/w UBIN        r     1 M$LO#
     6-0-0/w PTR         r     1 OPT$                      11-0-0/b BIT         r     1 SECOND_TRY_FLAG
    10-0-0/w UBIN        r     1 SUBLK                      7-0-0/w UBIN        r     1 TEMP
   202-0-0/c STRC(72)    r     1 Y$ACCT                    42-0-0/d STRC(1080)  r     1 Y$CLOSE
    12-0-0/d STRC(864)   r     1 Y$FID                    214-0-0/c STRC(54)    r     1 Y$FORM
   172-0-0/c STRC(288)   r     1 Y$NAME                   100-0-0/d STRC(2088)  r     1 Y$OPEN
   204-0-0/c STRC(72)    r     1 Y$PASS                   206-0-0/d STRC(90)    r     1 Y$SN
   212-0-0/c STRC(72)    r     1 Y$WSN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:854  

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(2088)  r     1 FPT_OPEN
     0-0-0/w STRC(144)   r     1 O$BLK                      0-0-0/w ASTR(153)   r     1 O$SYM
     0-0-0/w STRC(144)   r     1 OUT$BLK


   Procedure XUG$OPENOUT_COMMON requires 351 words for executable code.
   Procedure XUG$OPENOUT_COMMON requires 144 words of local(AUTO) storage.

    No errors detected in file XUG$COMMON.:E05TSI    .
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:855  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:856  
          MINI XREF LISTING

B$ALT.CODE
     10746**DCL     10746--REDEF   10747--REDEF   10747--REDEF
B$ALT.DCB#
     10747**DCL     10863>>ASSIGN
B$ALT.ERR
     10747**DCL     10864>>ASSIGN  10877>>ASSIGN
B$ALT.ERR.ERR#
     10748**DCL     10748--REDEF
B$ALT.EVID
     10747**DCL     10747--REDEF   10747--REDEF
B$TCB.ALT$
     10742**DCL     10863>>ASSIGN  10864>>ASSIGN  10877>>ASSIGN
B$TCB$
     10740**DCL     10863>>ASSIGN  10864>>ASSIGN  10877>>ASSIGN
BLK$
     10031**DCL     10223--IMP-PTR 10835<<ASSIGN  10836>>DOCASE  10843>>ASSIGN  10843>>ASSIGN  10845>>CALLBLT
     10845>>CALLBLT 10848>>CALLBLT 10848>>CALLBLT
DEFAULT_OPEN
     10114**DCL     10760>>ASSIGN
DEFAULT_OPEN.ACSVEH_
     10116**DCL     10117--REDEF
DEFAULT_OPEN.ALTKEYS_
     10122**DCL     10123--REDEF   10123--REDEF
DEFAULT_OPEN.HDR_
     10121**DCL     10122--REDEF
DEFAULT_OPEN.TAB_
     10120**DCL     10121--REDEF
DEFAULT_OPEN.UHL_
     10114**DCL     10115--REDEF   10115--REDEF
DEFAULT_OPEN.V
     10123**DCL     10114--DCLINIT
DEFAULT_OPEN.V.FSN#
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:857  
     10154**DCL     10154--REDEF   10154--REDEF
DEFAULT_OPEN.WSN_
     10120**DCL     10120--REDEF
F$DCB.ACTPOS
     10192**DCL     10192--REDEF
F$DCB.ARS#
     10166**DCL     10166--REDEF
F$DCB.ATTR
     10185**DCL     10186--REDEF
F$DCB.BORROW
     10200**DCL     10200--REDEF   10200--REDEF   10200--REDEF
F$DCB.DCBNAME.L
     10214**DCL     10214--IMP-SIZ
F$DCB.EOMCHAR#
     10170**DCL     10170--REDEF
F$DCB.FCD#
     10179**DCL     10857>>IF
F$DCB.FLDID
     10195**DCL     10195--REDEF
F$DCB.FORM$
     10189**DCL     10189--REDEF
F$DCB.FSECT
     10205**DCL     10205--REDEF
F$DCB.FSN#
     10182**DCL     10182--REDEF   10182--REDEF   10183--REDEF
F$DCB.HEADER$
     10188**DCL     10188--REDEF
F$DCB.IXTNSIZE#
     10186**DCL     10186--REDEF
F$DCB.LASTSTA$
     10175**DCL     10175--REDEF
F$DCB.LVL
     10201**DCL     10201--REDEF
F$DCB.NAME#.C
     10176**DCL     10176--REDEF
F$DCB.NOEOF
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:858  
     10198**DCL     10198--REDEF
F$DCB.NRECS#
     10187**DCL     10187--REDEF
F$DCB.NRECX
     10206**DCL     10206--REDEF
F$DCB.OHDR
     10198**DCL     10198--REDEF
F$DCB.ORG#
     10181**DCL     10181--REDEF   10884>>IF      10886>>DOCASE
F$DCB.PRECNO
     10204**DCL     10204--REDEF
F$DCB.RCSZ
     10210**DCL     10210--REDEF
F$DCB.RES#
     10177**DCL     10177--REDEF
F$DCB.SETX
     10189**DCL     10189--REDEF
F$DCB.TAB$
     10189**DCL     10189--REDEF
F$DCB.TDA
     10203**DCL     10204--REDEF
F$DCB.WSN#
     10177**DCL     10177--REDEF
FPT_CLOSE
     10349**DCL     10858>>ASSIGN
FPT_CLOSE.SN_
     10349**DCL     10349--REDEF
FPT_CLOSE.UTL_
     10350**DCL     10350--REDEF
FPT_CLOSE.V
     10354**DCL     10349--DCLINIT
FPT_CLOSE.V.EXPIRE#
     10364**DCL     10364--REDEF
FPT_CLOSE.V.TYPE#
     10362**DCL     10362--REDEF
FPT_CLOSE.V.XTNSIZE#
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:859  
     10359**DCL     10359--REDEF   10361--REDEF
FPT_FID
     10313**DCL     10812>>ASSIGN
FPT_FID.V
     10317**DCL     10313--DCLINIT
FPT_OPEN
      9985**DCL     10784>>ASSIGN
FPT_OPEN.ACSVEH_
      9987**DCL      9988--REDEF
FPT_OPEN.ALTKEYS_
      9993**DCL      9994--REDEF    9994--REDEF
FPT_OPEN.HDR_
      9992**DCL      9993--REDEF
FPT_OPEN.TAB_
      9991**DCL      9992--REDEF
FPT_OPEN.UHL_
      9985**DCL      9986--REDEF    9986--REDEF
FPT_OPEN.V.FSN#
     10025**DCL     10025--REDEF   10025--REDEF
FPT_OPEN.WSN_
      9991**DCL      9991--REDEF
GETCMD
      9550**DCL         7--PROC
GETCMD.DCB_PARAM#
      9730**DCL     10761>>IF      10787>>IF      10788>>ASSIGN
GETCMD.ERR#
      9561**DCL     10768<<ASSIGN  10864<<ASSIGN  10877<<ASSIGN  10890<<ASSIGN
GETCMD.ERRDCB#
      9709**DCL     10767<<ASSIGN  10863<<ASSIGN  10876<<ASSIGN  10891<<ASSIGN
GETCMD.FPT$
      9847**DCL      9985--IMP-PTR 10757>>IF      10784>>ASSIGN
GETCMD.OUT$
      9555**DCL      9561--REDEF
GETCMD.UTIL$
      9851**DCL      9881--IMP-PTR 10790>>IF      10792>>ASSIGN  10793>>IF      10793>>IF      10793>>IF
     10793>>IF      10797>>ASSIGN  10798>>DOCASE  10811>>IF      10831>>IF      10831>>IF      10833>>ASSIGN
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:860  
     10833>>ASSIGN
M$CLOSE
      5535**DCL-ENT 10861--CALL
M$FID
      5598**DCL-ENT 10823--CALL
M$LO
     10037**DCL     10764<>CALL
M$LO#
     10030**DCL     10764<>CALL    10778>>ASSIGN
M$OPEN
      5535**DCL-ENT 10869--CALL
O$BLK.CODE
     10231**DCL     10793>>IF      10798>>DOCASE  10831>>IF      10836>>DOCASE
O$BLK.NSUBLKS
     10235**DCL     10834>>DOINDEX
O$BLK.SUBLK$
     10256**DCL     10835>>ASSIGN  10843>>ASSIGN  10843>>ASSIGN  10845>>CALLBLT 10845>>CALLBLT 10848>>CALLBLT
     10848>>CALLBLT
O$SYM.COUNT
     10293**DCL     10296--IMP-SIZ 10822>>ASSIGN  10843>>ASSIGN  10845>>CALLBLT 10848>>CALLBLT
O$SYM.TEXT
     10296**DCL     10822--ASSIGN  10843>>ASSIGN  10845>>CALLBLT 10848>>CALLBLT
OPT$
     10032**DCL     10792<<ASSIGN  10797<<ASSIGN  10822>>ASSIGN  10822>>ASSIGN  10833<<ASSIGN  10834>>DOINDEX
     10835>>ASSIGN
OUT$BLK.NSUBLKS
      9893**DCL     10793>>IF      10793>>IF      10793>>IF      10811>>IF      10831>>IF      10833>>ASSIGN
OUT$BLK.SUBLK$
      9914**DCL     10792>>ASSIGN  10793>>IF      10797>>ASSIGN  10798>>DOCASE  10831>>IF      10833>>ASSIGN
SECOND_TRY_FLAG
     10035**DCL     10753<<ASSIGN  10757>>IF      10790>>IF      10872>>IF      10878<<ASSIGN  10902<<ASSIGN
     10908>>IF
SETUP_FPT
     10757**LABEL   10880--GOTO    10904--GOTO
SUBLK
     10034**DCL     10834<<DOINDEX 10835>>ASSIGN
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:861  
TEMP
     10033**DCL     10845<<CALLBLT 10846>>ASSIGN  10848<<CALLBLT 10849>>ASSIGN
XUG#BAD_OUTPUT_ORG
     10658**DCL     10890>>ASSIGN
XUG#NO_M$LO_DCB
     10704**DCL     10768>>ASSIGN
XUG$FINDDCB_COMMON
     10738**DCL-ENT 10764--CALL
XUG$OPENOUT_X
     10872**LABEL   10823--CALLALT
Y$ACCT
     10586**DCL     10814--ASSIGN  10825--ASSIGN
Y$CLOSE
     10417**DCL     10858<<ASSIGN  10861<>CALL
Y$CLOSE.SN_
     10417**DCL     10417--REDEF
Y$CLOSE.UTL_
     10418**DCL     10418--REDEF
Y$CLOSE.V
     10422**DCL     10859--ASSIGN
Y$CLOSE.V.DCB#
     10423**DCL     10860<<ASSIGN
Y$CLOSE.V.EXPIRE#
     10432**DCL     10432--REDEF
Y$CLOSE.V.TYPE#
     10430**DCL     10430--REDEF
Y$CLOSE.V.XTNSIZE#
     10427**DCL     10427--REDEF   10429--REDEF
Y$CLOSE.V_
     10417**DCL     10859<<ASSIGN
Y$FID
     10381**DCL     10812<<ASSIGN  10823<>CALL
Y$FID.ACCT_
     10382**DCL     10814<<ASSIGN
Y$FID.ASN_
     10384**DCL     10819<<ASSIGN
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:862  
Y$FID.NAME_
     10382**DCL     10815<<ASSIGN
Y$FID.PASS_
     10382**DCL     10816<<ASSIGN
Y$FID.RES_
     10384**DCL     10820<<ASSIGN
Y$FID.SN_
     10383**DCL     10817<<ASSIGN
Y$FID.TEXTFID_
     10381**DCL     10822<<ASSIGN
Y$FID.V
     10385**DCL     10813--ASSIGN
Y$FID.V_
     10381**DCL     10813<<ASSIGN
Y$FID.WSN_
     10383**DCL     10818<<ASSIGN
Y$FORM
     10642**DCL     10842--ASSIGN
Y$FORM.FORM#
     10642**DCL     10843<<ASSIGN
Y$NAME
     10572**DCL     10815--ASSIGN  10826--ASSIGN
Y$OPEN
     10502**DCL     10760<<ASSIGN  10784<<ASSIGN  10869<>CALL
Y$OPEN.ACCT_
     10506**DCL     10825<<ASSIGN
Y$OPEN.ACSVEH_
     10504**DCL     10505--REDEF
Y$OPEN.ALTKEYS_
     10510**DCL     10511--REDEF   10511--REDEF
Y$OPEN.FORM_
     10510**DCL     10842<<ASSIGN
Y$OPEN.HDR_
     10509**DCL     10510--REDEF
Y$OPEN.NAME_
     10503**DCL     10826<<ASSIGN
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:863  
Y$OPEN.PASS_
     10504**DCL     10827<<ASSIGN
Y$OPEN.SN_
     10502**DCL     10828<<ASSIGN
Y$OPEN.TAB_
     10508**DCL     10509--REDEF
Y$OPEN.UHL_
     10502**DCL     10503--REDEF   10503--REDEF
Y$OPEN.V
     10511**DCL     10785--ASSIGN
Y$OPEN.V.ASN#
     10521**DCL     10819--ASSIGN
Y$OPEN.V.DCB#
     10511**DCL     10778<<ASSIGN  10788<<ASSIGN  10856--IF      10857--IF      10860>>ASSIGN  10884--IF
     10886--DOCASE
Y$OPEN.V.EXIST#
     10515**DCL     10801<<ASSIGN  10804<<ASSIGN  10807<<ASSIGN
Y$OPEN.V.FSN#
     10542**DCL     10542--REDEF   10542--REDEF
Y$OPEN.V.FUN#
     10521**DCL     10800<<ASSIGN  10803<<ASSIGN  10806<<ASSIGN
Y$OPEN.V.IXTNSIZE#
     10530**DCL     10846<<ASSIGN
Y$OPEN.V.ORG#
     10522**DCL     10838<<ASSIGN  10840<<ASSIGN  10884>>IF
Y$OPEN.V.RES#
     10526**DCL     10820--ASSIGN
Y$OPEN.V.XTNSIZE#
     10530**DCL     10849<<ASSIGN
Y$OPEN.V_
     10502**DCL     10785<<ASSIGN
Y$OPEN.WSN_
     10508**DCL     10508--REDEF   10829<<ASSIGN
Y$PASS
     10600**DCL     10816--ASSIGN  10827--ASSIGN
Y$SN
PL6.E3A0      #019=XUG$OPENOUT_COMMON File=XUG$COMMON.:E05TSI                    WED 07/30/97 09:29 Page:864  
     10614**DCL     10817--ASSIGN  10828--ASSIGN
Y$WSN
     10628**DCL     10818--ASSIGN  10829--ASSIGN
